<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="1001">Ljung–Box test</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Ljung–Box test</h1>
<hr/>

<p>The <strong>Ljung–Box test</strong> (named for <a href="Greta_M._Ljung" title="wikilink">Greta M. Ljung</a> and <a href="George_E._P._Box" title="wikilink">George E. P. Box</a>) is a type of <a href="statistical_test" title="wikilink">statistical test</a> of whether any of a group of <a href="autocorrelation" title="wikilink">autocorrelations</a> of a <a href="time_series" title="wikilink">time series</a> are different from zero. Instead of testing <a class="uri" href="randomness" title="wikilink">randomness</a> at each distinct lag, it tests the "overall" randomness based on a number of lags, and is therefore a <a href="portmanteau_test" title="wikilink">portmanteau test</a>.</p>

<p>This test is sometimes known as the <strong>Ljung–Box Q test</strong>, and it is closely connected to the <strong>Box–Pierce test</strong> (which is named after <a href="George_E._P._Box" title="wikilink">George E. P. Box</a> and David A. Pierce). In fact, the Ljung–Box test statistic was described explicitly in the paper that led to the use of the Box-Pierce statistic,<a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a><a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a> and from which that statistic takes its name. The Box-Pierce test statistic is a simplified version of the Ljung–Box statistic for which subsequent simulation studies have shown poor performance.</p>

<p>The Ljung–Box test is widely applied in <a class="uri" href="econometrics" title="wikilink">econometrics</a> and other applications of <a href="time_series_analysis" title="wikilink">time series analysis</a>.</p>
<h2 id="formal-definition">Formal definition</h2>

<p>The Ljung–Box test can be defined as follows.</p>
<dl>
<dd><strong>H<sub>0</sub>:</strong> The data are independently distributed (i.e. the correlations in the population from which the sample is taken are 0, so that any observed correlations in the data result from randomness of the sampling process).
</dd>
<dd><strong>H<sub>a</sub>:</strong> The data are not independently distributed; they exhibit serial correlation.
</dd>
</dl>

<p>The test statistic is:<a class="footnoteRef" href="#fn3" id="fnref3"><sup>3</sup></a></p>

<p>

<math display="block" id="Ljung–Box_test:0">
 <semantics>
  <mrow>
   <mi>Q</mi>
   <mo>=</mo>
   <mrow>
    <mi>n</mi>
    <mrow>
     <mo>(</mo>
     <mrow>
      <mi>n</mi>
      <mo>+</mo>
      <mn>2</mn>
     </mrow>
     <mo>)</mo>
    </mrow>
    <mrow>
     <munderover>
      <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
      <mrow>
       <mi>k</mi>
       <mo>=</mo>
       <mn>1</mn>
      </mrow>
      <mi>h</mi>
     </munderover>
     <mfrac>
      <msubsup>
       <mover accent="true">
        <mi>ρ</mi>
        <mo stretchy="false">^</mo>
       </mover>
       <mi>k</mi>
       <mn>2</mn>
      </msubsup>
      <mrow>
       <mi>n</mi>
       <mo>-</mo>
       <mi>k</mi>
      </mrow>
     </mfrac>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>Q</ci>
    <apply>
     <times></times>
     <ci>n</ci>
     <apply>
      <plus></plus>
      <ci>n</ci>
      <cn type="integer">2</cn>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <apply>
         <eq></eq>
         <ci>k</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <ci>h</ci>
      </apply>
      <apply>
       <divide></divide>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <ci>normal-^</ci>
          <ci>ρ</ci>
         </apply>
         <cn type="integer">2</cn>
        </apply>
        <ci>k</ci>
       </apply>
       <apply>
        <minus></minus>
        <ci>n</ci>
        <ci>k</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Q=n\left(n+2\right)\sum_{k=1}^{h}\frac{\hat{\rho}^{2}_{k}}{n-k}
  </annotation>
 </semantics>
</math>

 where <em>n</em> is the sample size, 

<math display="inline" id="Ljung–Box_test:1">
 <semantics>
  <msub>
   <mover accent="true">
    <mi>ρ</mi>
    <mo stretchy="false">^</mo>
   </mover>
   <mi>k</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <apply>
     <ci>normal-^</ci>
     <ci>ρ</ci>
    </apply>
    <ci>k</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \hat{\rho}_{k}
  </annotation>
 </semantics>
</math>

 is the sample autocorrelation at lag <em>k</em>, and <em>h</em> is the number of lags being tested. Under 

<math display="inline" id="Ljung–Box_test:2">
 <semantics>
  <msub>
   <mi>H</mi>
   <mn>0</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>H</ci>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   H_{0}
  </annotation>
 </semantics>
</math>

 the statistic Q follows a 

<math display="inline" id="Ljung–Box_test:3">
 <semantics>
  <msubsup>
   <mi>χ</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>h</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mn>2</mn>
  </msubsup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>χ</ci>
     <cn type="integer">2</cn>
    </apply>
    <ci>h</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \chi^{2}_{(h)}
  </annotation>
 </semantics>
</math>

. For <a href="significance_level" title="wikilink">significance level</a> α, the <a href="critical_region" title="wikilink">critical region</a> for rejection of the hypothesis of randomness is</p>

<p>

<math display="block" id="Ljung–Box_test:4">
 <semantics>
  <mrow>
   <mi>Q</mi>
   <mo>></mo>
   <msubsup>
    <mi>χ</mi>
    <mrow>
     <mrow>
      <mn>1</mn>
      <mo>-</mo>
      <mi>α</mi>
     </mrow>
     <mo>,</mo>
     <mi>h</mi>
    </mrow>
    <mn>2</mn>
   </msubsup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <gt></gt>
    <ci>Q</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>χ</ci>
      <list>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
        <ci>α</ci>
       </apply>
       <ci>h</ci>
      </list>
     </apply>
     <cn type="integer">2</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Q>\chi_{1-\alpha,h}^{2}
  </annotation>
 </semantics>
</math>

</p>

<p>where 

<math display="inline" id="Ljung–Box_test:5">
 <semantics>
  <msubsup>
   <mi>χ</mi>
   <mrow>
    <mrow>
     <mn>1</mn>
     <mo>-</mo>
     <mi>α</mi>
    </mrow>
    <mo>,</mo>
    <mi>h</mi>
   </mrow>
   <mn>2</mn>
  </msubsup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>χ</ci>
     <list>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
       <ci>α</ci>
      </apply>
      <ci>h</ci>
     </list>
    </apply>
    <cn type="integer">2</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \chi_{1-\alpha,h}^{2}
  </annotation>
 </semantics>
</math>

 is the α-<a class="uri" href="quantile" title="wikilink">quantile</a> of the <a href="chi-squared_distribution" title="wikilink">chi-squared distribution</a> with <em>h</em> degrees of freedom.</p>

<p>The Ljung–Box test is commonly used in <a href="autoregressive_integrated_moving_average" title="wikilink">autoregressive integrated moving average</a> (ARIMA) modeling. Note that it is applied to the <a href="errors_and_residuals_in_statistics" title="wikilink">residuals</a> of a fitted ARIMA model, not the original series, and in such applications the hypothesis actually being tested is that the residuals from the ARIMA model have no autocorrelation. When testing the residuals of an estimated ARIMA model, the degrees of freedom need to be adjusted to reflect the parameter estimation. For example, for an ARIMA(p,0,q) model, the degrees of freedom should be set to 

<math display="inline" id="Ljung–Box_test:6">
 <semantics>
  <mrow>
   <mi>h</mi>
   <mo>-</mo>
   <mi>p</mi>
   <mo>-</mo>
   <mi>q</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <minus></minus>
    <ci>h</ci>
    <ci>p</ci>
    <ci>q</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   h-p-q
  </annotation>
 </semantics>
</math>

.<a class="footnoteRef" href="#fn4" id="fnref4"><sup>4</sup></a></p>
<h2 id="box-pierce-test">Box-Pierce test</h2>

<p>The Box-Pierce test uses the test statistic, in the notation outlined above, given by<a class="footnoteRef" href="#fn5" id="fnref5"><sup>5</sup></a></p>

<p>

<math display="block" id="Ljung–Box_test:7">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>Q</mi>
     <mtext>BP</mtext>
    </msub>
    <mo>=</mo>
    <mrow>
     <mi>n</mi>
     <mrow>
      <munderover>
       <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
       <mrow>
        <mi>k</mi>
        <mo>=</mo>
        <mn>1</mn>
       </mrow>
       <mi>h</mi>
      </munderover>
      <msubsup>
       <mover accent="true">
        <mi>ρ</mi>
        <mo stretchy="false">^</mo>
       </mover>
       <mi>k</mi>
       <mn>2</mn>
      </msubsup>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>Q</ci>
     <mtext>BP</mtext>
    </apply>
    <apply>
     <times></times>
     <ci>n</ci>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <apply>
         <eq></eq>
         <ci>k</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <ci>h</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <ci>normal-^</ci>
         <ci>ρ</ci>
        </apply>
        <cn type="integer">2</cn>
       </apply>
       <ci>k</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Q_{\text{BP}}=n\sum_{k=1}^{h}\hat{\rho}^{2}_{k},
  </annotation>
 </semantics>
</math>

 and it uses the same critical region as defined above.</p>

<p>Simulation studies have shown that the Ljung–Box statistic is better for all sample sizes including small ones.</p>
<h2 id="see-also">See also</h2>
<ul>
<li><a class="uri" href="Q-statistic" title="wikilink">Q-statistic</a></li>
<li><a href="Wald–Wolfowitz_runs_test" title="wikilink">Wald–Wolfowitz runs test</a></li>
</ul>
<h2 id="references">References</h2>
<h2 id="further-reading">Further reading</h2>
<ul>
<li></li>
<li></li>
<li></li>
</ul>
<h2 id="external-links">External links</h2>
<ul>
<li><a href="http://www.answers.com/topic/box-pierce-statistic">Box–Pierce test</a> on <a class="uri" href="answers.com" title="wikilink">answers.com</a></li>
</ul>

<p><a class="uri" href="de:Box-Ljung-Test" title="wikilink">de:Box-Ljung-Test</a>"</p>

<p><a href="Category:Statistical_tests" title="wikilink">Category:Statistical tests</a> <a href="Category:Time_series_analysis" title="wikilink">Category:Time series analysis</a> <a href="Category:Time_domain_analysis" title="wikilink">Category:Time domain analysis</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1"></li>
<li id="fn2"></li>
<li id="fn3"></li>
<li id="fn4"><a href="#fnref4">↩</a></li>
<li id="fn5"></li>
</ol>
</section>
</body>
</html>

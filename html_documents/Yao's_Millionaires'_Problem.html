<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="1477">Yao's Millionaires' Problem</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Yao's Millionaires' Problem</h1>
<hr/>

<p><strong>Yao's Millionaires' problem</strong> is a secure multiparty communication problem which was introduced by <a href="Andrew_Yao" title="wikilink">Andrew Yao</a>, a prominent computer scientist and computational theorist. The problem discusses two millionaires, Alice and Bob, who are interested in knowing which of them is richer without revealing their actual wealth.</p>

<p>This problem is analogous to a more general problem where there are two numbers 

<math display="inline" id="Yao's_Millionaires'_Problem:0">
 <semantics>
  <mi>a</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>a</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Yao's_Millionaires'_Problem:1">
 <semantics>
  <mi>b</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>b</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   b
  </annotation>
 </semantics>
</math>

 and the goal is to solve the inequality 

<math display="inline" id="Yao's_Millionaires'_Problem:2">
 <semantics>
  <mrow>
   <mi>a</mi>
   <mo>≥</mo>
   <mi>b</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <geq></geq>
    <ci>a</ci>
    <ci>b</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a\geq b
  </annotation>
 </semantics>
</math>

 without revealing the actual values of 

<math display="inline" id="Yao's_Millionaires'_Problem:3">
 <semantics>
  <mi>a</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>a</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Yao's_Millionaires'_Problem:4">
 <semantics>
  <mi>b</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>b</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   b
  </annotation>
 </semantics>
</math>

.</p>

<p>The Millionaires' Problem is an example of <a href="Secure_multi-party_computation" title="wikilink">Secure multi-party computation</a>, which is an important problem in <a class="uri" href="cryptography" title="wikilink">cryptography</a> and the solution of which is used in <a class="uri" href="e-commerce" title="wikilink">e-commerce</a> and <a href="data_mining" title="wikilink">data mining</a>. Commercial applications sometimes have to compare numbers which are confidential and whose security is important.</p>

<p>Many solutions have been introduced for the problem, among which the first solution, presented by Yao himself,<a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a> was exponential in time and space. This article presents and explains one possible solution.<a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a></p>
<h2 id="protocol-and-proof">Protocol and proof</h2>
<h3 id="the-protocol">The protocol</h3>

<p>We will make use of a variant of <a href="oblivious_transfer" title="wikilink">oblivious transfer</a>, called 1-2 oblivious transfer, in our <a href="Cryptographic_protocol" title="wikilink">protocol</a>. In that transfer one <a class="uri" href="bit" title="wikilink">bit</a> is transferred in the following way: a sender has two bits 

<math display="inline" id="Yao's_Millionaires'_Problem:5">
 <semantics>
  <msub>
   <mi>S</mi>
   <mn>0</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>S</ci>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   S_{0}
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Yao's_Millionaires'_Problem:6">
 <semantics>
  <msub>
   <mi>S</mi>
   <mn>1</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>S</ci>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   S_{1}
  </annotation>
 </semantics>
</math>

. The receiver chooses 

<math display="inline" id="Yao's_Millionaires'_Problem:7">
 <semantics>
  <mrow>
   <mi>i</mi>
   <mo>∈</mo>
   <mrow>
    <mo stretchy="false">{</mo>
    <mn>0</mn>
    <mo>,</mo>
    <mn>1</mn>
    <mo stretchy="false">}</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <in></in>
    <ci>i</ci>
    <set>
     <cn type="integer">0</cn>
     <cn type="integer">1</cn>
    </set>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   i\in\{0,1\}
  </annotation>
 </semantics>
</math>

 and the sender sends 

<math display="inline" id="Yao's_Millionaires'_Problem:8">
 <semantics>
  <msub>
   <mi>S</mi>
   <mi>i</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>S</ci>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   S_{i}
  </annotation>
 </semantics>
</math>

 with the oblivious transfer protocol such that</p>
<ol>
<li>the receiver doesn't get any information about 

<math display="inline" id="Yao's_Millionaires'_Problem:9">
 <semantics>
  <msub>
   <mi>S</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mrow>
     <mn>1</mn>
     <mo>-</mo>
     <mi>i</mi>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>S</ci>
    <apply>
     <minus></minus>
     <cn type="integer">1</cn>
     <ci>i</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   S_{(1-i)}
  </annotation>
 </semantics>
</math>

,</li>
<li>the value of 

<math display="inline" id="Yao's_Millionaires'_Problem:10">
 <semantics>
  <mi>i</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>i</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   i
  </annotation>
 </semantics>
</math>

 is not exposed to the sender.</li>
</ol>

<p>Now we will begin with the protocol description. We will indicate Alice's number as 

<math display="inline" id="Yao's_Millionaires'_Problem:11">
 <semantics>
  <mi>a</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>a</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a
  </annotation>
 </semantics>
</math>

 and Bob's number as 

<math display="inline" id="Yao's_Millionaires'_Problem:12">
 <semantics>
  <mi>b</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>b</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   b
  </annotation>
 </semantics>
</math>

 and assume that the length of their binary representation is less than 

<math display="inline" id="Yao's_Millionaires'_Problem:13">
 <semantics>
  <mi>d</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>d</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   d
  </annotation>
 </semantics>
</math>

 for some 

<math display="inline" id="Yao's_Millionaires'_Problem:14">
 <semantics>
  <mrow>
   <mi>d</mi>
   <mo>∈</mo>
   <mi>N</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <in></in>
    <ci>d</ci>
    <ci>N</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   d\in N
  </annotation>
 </semantics>
</math>

. The steps of the protocol are as follows.</p>
<ol>
<li>Alice creates a matrix 

<math display="inline" id="Yao's_Millionaires'_Problem:15">
 <semantics>
  <mi>K</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>K</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   K
  </annotation>
 </semantics>
</math>

 of size 

<math display="inline" id="Yao's_Millionaires'_Problem:16">
 <semantics>
  <mrow>
   <mi>d</mi>
   <mo>×</mo>
   <mn>2</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>d</ci>
    <cn type="integer">2</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   d\times 2
  </annotation>
 </semantics>
</math>

 of 

<math display="inline" id="Yao's_Millionaires'_Problem:17">
 <semantics>
  <mi>k</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>k</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   k
  </annotation>
 </semantics>
</math>

-bit numbers, where 

<math display="inline" id="Yao's_Millionaires'_Problem:18">
 <semantics>
  <mi>k</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>k</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   k
  </annotation>
 </semantics>
</math>

 is the length of the key in the oblivious transfer protocol. In addition, she chooses two random numbers 

<math display="inline" id="Yao's_Millionaires'_Problem:19">
 <semantics>
  <mi>u</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>u</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   u
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Yao's_Millionaires'_Problem:20">
 <semantics>
  <mi>v</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>v</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   v
  </annotation>
 </semantics>
</math>

 where 

<math display="inline" id="Yao's_Millionaires'_Problem:21">
 <semantics>
  <mrow>
   <mn>0</mn>
   <mo>≤</mo>
   <mi>u</mi>
   <mo><</mo>
   <mrow>
    <mn>2</mn>
    <mi>k</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <leq></leq>
     <cn type="integer">0</cn>
     <ci>u</ci>
    </apply>
    <apply>
     <lt></lt>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <cn type="integer">2</cn>
      <ci>k</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   0\leq u<2k
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Yao's_Millionaires'_Problem:22">
 <semantics>
  <mrow>
   <mi>v</mi>
   <mo>≤</mo>
   <mi>k</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <leq></leq>
    <ci>v</ci>
    <ci>k</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   v\leq k
  </annotation>
 </semantics>
</math>

.</li>
<li>

<math display="inline" id="Yao's_Millionaires'_Problem:23">
 <semantics>
  <msub>
   <mi>K</mi>
   <mrow>
    <mi>i</mi>
    <mi>j</mi>
    <mi>l</mi>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>K</ci>
    <apply>
     <times></times>
     <ci>i</ci>
     <ci>j</ci>
     <ci>l</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   K_{ijl}
  </annotation>
 </semantics>
</math>

 will be the 

<math display="inline" id="Yao's_Millionaires'_Problem:24">
 <semantics>
  <mi>l</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>l</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   l
  </annotation>
 </semantics>
</math>

-th bit of the number which appears in cell 

<math display="inline" id="Yao's_Millionaires'_Problem:25">
 <semantics>
  <msub>
   <mi>K</mi>
   <mrow>
    <mi>i</mi>
    <mi>j</mi>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>K</ci>
    <apply>
     <times></times>
     <ci>i</ci>
     <ci>j</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   K_{ij}
  </annotation>
 </semantics>
</math>

 (where 

<math display="inline" id="Yao's_Millionaires'_Problem:26">
 <semantics>
  <mrow>
   <mi>l</mi>
   <mo>=</mo>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>l</ci>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   l=0
  </annotation>
 </semantics>
</math>

 indicates the <a href="least_significant_bit" title="wikilink">least significant bit</a>). In addition, we denote 

<math display="inline" id="Yao's_Millionaires'_Problem:27">
 <semantics>
  <msub>
   <mi>a</mi>
   <mi>i</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>a</ci>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a_{i}
  </annotation>
 </semantics>
</math>

 as the 

<math display="inline" id="Yao's_Millionaires'_Problem:28">
 <semantics>
  <mi>i</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>i</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   i
  </annotation>
 </semantics>
</math>

-th bit of Alice's number 

<math display="inline" id="Yao's_Millionaires'_Problem:29">
 <semantics>
  <mi>a</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>a</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a
  </annotation>
 </semantics>
</math>

. For every 

<math display="inline" id="Yao's_Millionaires'_Problem:30">
 <semantics>
  <mi>i</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>i</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   i
  </annotation>
 </semantics>
</math>

, 

<math display="inline" id="Yao's_Millionaires'_Problem:31">
 <semantics>
  <mrow>
   <mn>1</mn>
   <mo>≤</mo>
   <mi>i</mi>
   <mo>≤</mo>
   <mi>d</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <leq></leq>
     <cn type="integer">1</cn>
     <ci>i</ci>
    </apply>
    <apply>
     <leq></leq>
     <share href="#.cmml">
     </share>
     <ci>d</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   1\leq i\leq d
  </annotation>
 </semantics>
</math>

 Alice does the following actions.
<ol>
<li>For every bit 

<math display="inline" id="Yao's_Millionaires'_Problem:32">
 <semantics>
  <mrow>
   <mi>j</mi>
   <mo>≥</mo>
   <mi>v</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <geq></geq>
    <ci>j</ci>
    <ci>v</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   j\geq v
  </annotation>
 </semantics>
</math>

 she sets 

<math display="inline" id="Yao's_Millionaires'_Problem:33">
 <semantics>
  <msub>
   <mi>K</mi>
   <mrow>
    <mi>i</mi>
    <mn>1</mn>
    <mi>j</mi>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>K</ci>
    <apply>
     <times></times>
     <ci>i</ci>
     <cn type="integer">1</cn>
     <ci>j</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   K_{i1j}
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Yao's_Millionaires'_Problem:34">
 <semantics>
  <msub>
   <mi>K</mi>
   <mrow>
    <mi>i</mi>
    <mn>2</mn>
    <mi>j</mi>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>K</ci>
    <apply>
     <times></times>
     <ci>i</ci>
     <cn type="integer">2</cn>
     <ci>j</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   K_{i2j}
  </annotation>
 </semantics>
</math>

 to random bits.</li>
<li>If 

<math display="inline" id="Yao's_Millionaires'_Problem:35">
 <semantics>
  <mrow>
   <msub>
    <mi>a</mi>
    <mi>i</mi>
   </msub>
   <mo>=</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>a</ci>
     <ci>i</ci>
    </apply>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a_{i}=1
  </annotation>
 </semantics>
</math>

 let 

<math display="inline" id="Yao's_Millionaires'_Problem:36">
 <semantics>
  <mrow>
   <mi>l</mi>
   <mo>=</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>l</ci>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   l=1
  </annotation>
 </semantics>
</math>

 otherwise let 

<math display="inline" id="Yao's_Millionaires'_Problem:37">
 <semantics>
  <mrow>
   <mi>l</mi>
   <mo>=</mo>
   <mn>2</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>l</ci>
    <cn type="integer">2</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   l=2
  </annotation>
 </semantics>
</math>

 and for every 

<math display="inline" id="Yao's_Millionaires'_Problem:38">
 <semantics>
  <mrow>
   <mrow>
    <mi>j</mi>
    <mo>,</mo>
    <mn>0</mn>
   </mrow>
   <mo>≤</mo>
   <mi>j</mi>
   <mo>≤</mo>
   <mrow>
    <mrow>
     <mn>2</mn>
     <mo>⋅</mo>
     <mi>i</mi>
    </mrow>
    <mo>-</mo>
    <mn>1</mn>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <leq></leq>
     <list>
      <ci>j</ci>
      <cn type="integer">0</cn>
     </list>
     <ci>j</ci>
    </apply>
    <apply>
     <leq></leq>
     <share href="#.cmml">
     </share>
     <apply>
      <minus></minus>
      <apply>
       <ci>normal-⋅</ci>
       <cn type="integer">2</cn>
       <ci>i</ci>
      </apply>
      <cn type="integer">1</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   j,0\leq j\leq 2\cdot i-1
  </annotation>
 </semantics>
</math>

 set 

<math display="inline" id="Yao's_Millionaires'_Problem:39">
 <semantics>
  <msub>
   <mi>K</mi>
   <mrow>
    <mi>i</mi>
    <mi>l</mi>
    <mi>j</mi>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>K</ci>
    <apply>
     <times></times>
     <ci>i</ci>
     <ci>l</ci>
     <ci>j</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   K_{ilj}
  </annotation>
 </semantics>
</math>

 to a random bit.</li>
<li>For 

<math display="inline" id="Yao's_Millionaires'_Problem:40">
 <semantics>
  <mrow>
   <mi>m</mi>
   <mo>=</mo>
   <mrow>
    <mn>2</mn>
    <mo>⋅</mo>
    <mi>i</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>m</ci>
    <apply>
     <ci>normal-⋅</ci>
     <cn type="integer">2</cn>
     <ci>i</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   m=2\cdot i
  </annotation>
 </semantics>
</math>

 set 

<math display="inline" id="Yao's_Millionaires'_Problem:41">
 <semantics>
  <mrow>
   <msub>
    <mi>K</mi>
    <mrow>
     <mi>i</mi>
     <mi>l</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mi>m</mi>
       <mo>+</mo>
       <mn>1</mn>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </msub>
   <mo>=</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>K</ci>
     <apply>
      <times></times>
      <ci>i</ci>
      <ci>l</ci>
      <apply>
       <plus></plus>
       <ci>m</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
    </apply>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   K_{il(m+1)}=1
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Yao's_Millionaires'_Problem:42">
 <semantics>
  <msub>
   <mi>K</mi>
   <mrow>
    <mi>i</mi>
    <mi>l</mi>
    <mi>m</mi>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>K</ci>
    <apply>
     <times></times>
     <ci>i</ci>
     <ci>l</ci>
     <ci>m</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   K_{ilm}
  </annotation>
 </semantics>
</math>

 to 

<math display="inline" id="Yao's_Millionaires'_Problem:43">
 <semantics>
  <msub>
   <mi>a</mi>
   <mi>i</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>a</ci>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a_{i}
  </annotation>
 </semantics>
</math>

.</li>
<li>For every 

<math display="inline" id="Yao's_Millionaires'_Problem:44">
 <semantics>
  <mrow>
   <mrow>
    <mi>i</mi>
    <mo>,</mo>
    <mn>1</mn>
   </mrow>
   <mo>≤</mo>
   <mi>i</mi>
   <mo><</mo>
   <mi>d</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <leq></leq>
     <list>
      <ci>i</ci>
      <cn type="integer">1</cn>
     </list>
     <ci>i</ci>
    </apply>
    <apply>
     <lt></lt>
     <share href="#.cmml">
     </share>
     <ci>d</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   i,1\leq i<d
  </annotation>
 </semantics>
</math>

, 

<math display="inline" id="Yao's_Millionaires'_Problem:45">
 <semantics>
  <msub>
   <mi>S</mi>
   <mi>i</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>S</ci>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   S_{i}
  </annotation>
 </semantics>
</math>

 will be a random 

<math display="inline" id="Yao's_Millionaires'_Problem:46">
 <semantics>
  <mi>k</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>k</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   k
  </annotation>
 </semantics>
</math>

-bit number and 

<math display="inline" id="Yao's_Millionaires'_Problem:47">
 <semantics>
  <msub>
   <mi>S</mi>
   <mi>d</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>S</ci>
    <ci>d</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   S_{d}
  </annotation>
 </semantics>
</math>

 will be another number of 

<math display="inline" id="Yao's_Millionaires'_Problem:48">
 <semantics>
  <mi>k</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>k</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   k
  </annotation>
 </semantics>
</math>

 bits where all bits except the last two are random and the last two are calculated as 

<math display="inline" id="Yao's_Millionaires'_Problem:49">
 <semantics>
  <mrow>
   <msub>
    <mi>S</mi>
    <mrow>
     <mi>d</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mi>k</mi>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </msub>
   <mo>=</mo>
   <mrow>
    <mn>1</mn>
    <mo>⊕</mo>
    <mrow>
     <msubsup>
      <mo largeop="true" mathsize="160%" stretchy="false" symmetric="true">⊕</mo>
      <mrow>
       <mi>j</mi>
       <mo>=</mo>
       <mn>1</mn>
      </mrow>
      <mrow>
       <mi>d</mi>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
     </msubsup>
     <msub>
      <mi>S</mi>
      <mrow>
       <mi>j</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mi>k</mi>
         <mo>-</mo>
         <mn>1</mn>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
     </msub>
    </mrow>
    <mo>⊕</mo>
    <mrow>
     <msubsup>
      <mo largeop="true" mathsize="160%" stretchy="false" symmetric="true">⊕</mo>
      <mrow>
       <mi>j</mi>
       <mo>=</mo>
       <mn>1</mn>
      </mrow>
      <mi>d</mi>
     </msubsup>
     <msub>
      <mi>K</mi>
      <mrow>
       <mi>j</mi>
       <mn>1</mn>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mi>k</mi>
         <mo>-</mo>
         <mn>1</mn>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
     </msub>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>S</ci>
     <apply>
      <times></times>
      <ci>d</ci>
      <apply>
       <minus></minus>
       <ci>k</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
    </apply>
    <apply>
     <csymbol cd="latexml">direct-sum</csymbol>
     <cn type="integer">1</cn>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <csymbol cd="latexml">direct-sum</csymbol>
        <apply>
         <eq></eq>
         <ci>j</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <apply>
        <minus></minus>
        <ci>d</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>S</ci>
       <apply>
        <times></times>
        <ci>j</ci>
        <apply>
         <minus></minus>
         <ci>k</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <csymbol cd="latexml">direct-sum</csymbol>
        <apply>
         <eq></eq>
         <ci>j</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <ci>d</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>K</ci>
       <apply>
        <times></times>
        <ci>j</ci>
        <cn type="integer">1</cn>
        <apply>
         <minus></minus>
         <ci>k</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   S_{d(k-1)}=1\oplus\bigoplus_{j=1}^{d-1}S_{j(k-1)}\oplus\bigoplus_{j=1}^{d}K_{j%
1(k-1)}
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Yao's_Millionaires'_Problem:50">
 <semantics>
  <mrow>
   <msub>
    <mi>S</mi>
    <mrow>
     <mi>d</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mi>k</mi>
       <mo>-</mo>
       <mn>2</mn>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </msub>
   <mo>=</mo>
   <mrow>
    <mn>1</mn>
    <mo>⊕</mo>
    <mrow>
     <msubsup>
      <mo largeop="true" mathsize="160%" stretchy="false" symmetric="true">⊕</mo>
      <mrow>
       <mi>j</mi>
       <mo>=</mo>
       <mn>1</mn>
      </mrow>
      <mrow>
       <mi>d</mi>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
     </msubsup>
     <msub>
      <mi>S</mi>
      <mrow>
       <mi>j</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mi>k</mi>
         <mo>-</mo>
         <mn>2</mn>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
     </msub>
    </mrow>
    <mo>⊕</mo>
    <mrow>
     <msubsup>
      <mo largeop="true" mathsize="160%" stretchy="false" symmetric="true">⊕</mo>
      <mrow>
       <mi>j</mi>
       <mo>=</mo>
       <mn>1</mn>
      </mrow>
      <mi>d</mi>
     </msubsup>
     <msub>
      <mi>K</mi>
      <mrow>
       <mi>j</mi>
       <mn>1</mn>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mi>k</mi>
         <mo>-</mo>
         <mn>2</mn>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
     </msub>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>S</ci>
     <apply>
      <times></times>
      <ci>d</ci>
      <apply>
       <minus></minus>
       <ci>k</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
    <apply>
     <csymbol cd="latexml">direct-sum</csymbol>
     <cn type="integer">1</cn>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <csymbol cd="latexml">direct-sum</csymbol>
        <apply>
         <eq></eq>
         <ci>j</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <apply>
        <minus></minus>
        <ci>d</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>S</ci>
       <apply>
        <times></times>
        <ci>j</ci>
        <apply>
         <minus></minus>
         <ci>k</ci>
         <cn type="integer">2</cn>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <csymbol cd="latexml">direct-sum</csymbol>
        <apply>
         <eq></eq>
         <ci>j</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <ci>d</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>K</ci>
       <apply>
        <times></times>
        <ci>j</ci>
        <cn type="integer">1</cn>
        <apply>
         <minus></minus>
         <ci>k</ci>
         <cn type="integer">2</cn>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   S_{d(k-2)}=1\oplus\bigoplus_{j=1}^{d-1}S_{j(k-2)}\oplus\bigoplus_{j=1}^{d}K_{j%
1(k-2)}
  </annotation>
 </semantics>
</math>

, where 

<math display="inline" id="Yao's_Millionaires'_Problem:51">
 <semantics>
  <mo largeop="true" mathsize="160%" stretchy="false" symmetric="true">⊕</mo>
  <annotation-xml encoding="MathML-Content">
   <csymbol cd="latexml">direct-sum</csymbol>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \bigoplus
  </annotation>
 </semantics>
</math>

 is the <a href="bitwise_operation" title="wikilink">bitwise</a> <a class="uri" href="XOR" title="wikilink">XOR</a> operation.</li>
<li>For 

<math display="inline" id="Yao's_Millionaires'_Problem:52">
 <semantics>
  <mrow>
   <mi>l</mi>
   <mo>=</mo>
   <mrow>
    <mn>1</mn>
    <mo>,</mo>
    <mn>2</mn>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>l</ci>
    <list>
     <cn type="integer">1</cn>
     <cn type="integer">2</cn>
    </list>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   l=1,2
  </annotation>
 </semantics>
</math>

 set 

<math display="inline" id="Yao's_Millionaires'_Problem:53">
 <semantics>
  <mrow>
   <msubsup>
    <mi>K</mi>
    <mrow>
     <mi>i</mi>
     <mi>j</mi>
    </mrow>
    <mo>′</mo>
   </msubsup>
   <mo>=</mo>
   <mrow>
    <mi>r</mi>
    <mi>o</mi>
    <mi>t</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <msub>
       <mi>K</mi>
       <mrow>
        <mi>i</mi>
        <mi>l</mi>
       </mrow>
      </msub>
      <mo>⊕</mo>
      <msub>
       <mi>S</mi>
       <mi>i</mi>
      </msub>
     </mrow>
     <mo>,</mo>
     <mi>u</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>K</ci>
      <ci>normal-′</ci>
     </apply>
     <apply>
      <times></times>
      <ci>i</ci>
      <ci>j</ci>
     </apply>
    </apply>
    <apply>
     <times></times>
     <ci>r</ci>
     <ci>o</ci>
     <ci>t</ci>
     <interval closure="open">
      <apply>
       <csymbol cd="latexml">direct-sum</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>K</ci>
        <apply>
         <times></times>
         <ci>i</ci>
         <ci>l</ci>
        </apply>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>S</ci>
        <ci>i</ci>
       </apply>
      </apply>
      <ci>u</ci>
     </interval>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   K^{\prime}_{ij}=rot(K_{il}\oplus S_{i},u)
  </annotation>
 </semantics>
</math>

. Where 

<math display="inline" id="Yao's_Millionaires'_Problem:54">
 <semantics>
  <mrow>
   <mi>r</mi>
   <mi>o</mi>
   <mi>t</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>x</mi>
    <mo>,</mo>
    <mi>t</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>r</ci>
    <ci>o</ci>
    <ci>t</ci>
    <interval closure="open">
     <ci>x</ci>
     <ci>t</ci>
    </interval>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   rot(x,t)
  </annotation>
 </semantics>
</math>

 indicates the <a href="bitwise_rotation" title="wikilink">bitwise rotation</a> of 

<math display="inline" id="Yao's_Millionaires'_Problem:55">
 <semantics>
  <mi>x</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>x</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x
  </annotation>
 </semantics>
</math>

 to the left by 

<math display="inline" id="Yao's_Millionaires'_Problem:56">
 <semantics>
  <mi>t</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>t</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   t
  </annotation>
 </semantics>
</math>

 bits.</li>
</ol></li>
<li>For every 

<math display="inline" id="Yao's_Millionaires'_Problem:57">
 <semantics>
  <mi>i</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>i</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   i
  </annotation>
 </semantics>
</math>

, 

<math display="inline" id="Yao's_Millionaires'_Problem:58">
 <semantics>
  <mrow>
   <mn>0</mn>
   <mo>≤</mo>
   <mi>i</mi>
   <mo>≤</mo>
   <mi>d</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <leq></leq>
     <cn type="integer">0</cn>
     <ci>i</ci>
    </apply>
    <apply>
     <leq></leq>
     <share href="#.cmml">
     </share>
     <ci>d</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   0\leq i\leq d
  </annotation>
 </semantics>
</math>

 Bob transfers 

<math display="inline" id="Yao's_Millionaires'_Problem:59">
 <semantics>
  <msubsup>
   <mi>K</mi>
   <mrow>
    <mi>i</mi>
    <mi>l</mi>
   </mrow>
   <mo>′</mo>
  </msubsup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>K</ci>
     <ci>normal-′</ci>
    </apply>
    <apply>
     <times></times>
     <ci>i</ci>
     <ci>l</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   K^{\prime}_{il}
  </annotation>
 </semantics>
</math>

 with the oblivious transfer protocol where 

<math display="inline" id="Yao's_Millionaires'_Problem:60">
 <semantics>
  <mrow>
   <mi>l</mi>
   <mo>=</mo>
   <mrow>
    <msub>
     <mi>b</mi>
     <mi>i</mi>
    </msub>
    <mo>+</mo>
    <mn>1</mn>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>l</ci>
    <apply>
     <plus></plus>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>b</ci>
      <ci>i</ci>
     </apply>
     <cn type="integer">1</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   l=b_{i}+1
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Yao's_Millionaires'_Problem:61">
 <semantics>
  <msub>
   <mi>b</mi>
   <mi>i</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>b</ci>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   b_{i}
  </annotation>
 </semantics>
</math>

 is the 

<math display="inline" id="Yao's_Millionaires'_Problem:62">
 <semantics>
  <mi>i</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>i</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   i
  </annotation>
 </semantics>
</math>

-th bit of 

<math display="inline" id="Yao's_Millionaires'_Problem:63">
 <semantics>
  <mi>b</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>b</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   b
  </annotation>
 </semantics>
</math>

.</li>
<li>Alice sends to Bob 

<math display="inline" id="Yao's_Millionaires'_Problem:64">
 <semantics>
  <mrow>
   <mi>N</mi>
   <mo>=</mo>
   <mrow>
    <mi>r</mi>
    <mi>o</mi>
    <mi>l</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <msubsup>
       <mo largeop="true" mathsize="160%" stretchy="false" symmetric="true">⊕</mo>
       <mrow>
        <mi>j</mi>
        <mo>=</mo>
        <mn>1</mn>
       </mrow>
       <mi>d</mi>
      </msubsup>
      <msub>
       <mi>S</mi>
       <mi>j</mi>
      </msub>
     </mrow>
     <mo>,</mo>
     <mi>u</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>N</ci>
    <apply>
     <times></times>
     <ci>r</ci>
     <ci>o</ci>
     <ci>l</ci>
     <interval closure="open">
      <apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <csymbol cd="latexml">direct-sum</csymbol>
         <apply>
          <eq></eq>
          <ci>j</ci>
          <cn type="integer">1</cn>
         </apply>
        </apply>
        <ci>d</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>S</ci>
        <ci>j</ci>
       </apply>
      </apply>
      <ci>u</ci>
     </interval>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   N=rol(\bigoplus_{j=1}^{d}S_{j},u)
  </annotation>
 </semantics>
</math>

.</li>
<li>Bob calculates the bitwise XOR of all the numbers he got in step 3 and 

<math display="inline" id="Yao's_Millionaires'_Problem:65">
 <semantics>
  <mi>N</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>N</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   N
  </annotation>
 </semantics>
</math>

 from step 4. Bob scans the result from left to right until he finds a large sequence of zero bits. Let 

<math display="inline" id="Yao's_Millionaires'_Problem:66">
 <semantics>
  <mi>c</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>c</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   c
  </annotation>
 </semantics>
</math>

 be the bit to the right of that sequence (

<math display="inline" id="Yao's_Millionaires'_Problem:67">
 <semantics>
  <mi>c</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>c</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   c
  </annotation>
 </semantics>
</math>

 is non zero). If the bit to the right of 

<math display="inline" id="Yao's_Millionaires'_Problem:68">
 <semantics>
  <mi>c</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>c</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   c
  </annotation>
 </semantics>
</math>

 equals 1 then 

<math display="inline" id="Yao's_Millionaires'_Problem:69">
 <semantics>
  <mrow>
   <mi>a</mi>
   <mo>≥</mo>
   <mi>b</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <geq></geq>
    <ci>a</ci>
    <ci>b</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a\geq b
  </annotation>
 </semantics>
</math>

. otherwise 

<math display="inline" id="Yao's_Millionaires'_Problem:70">
 <semantics>
  <mrow>
   <mi>a</mi>
   <mo><</mo>
   <mi>b</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <lt></lt>
    <ci>a</ci>
    <ci>b</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a<b
  </annotation>
 </semantics>
</math>

.</li>
</ol>
<h3 id="proof">Proof</h3>
<h4 id="correctness">Correctness</h4>

<p>Bob calculates the final result from 

<math display="inline" id="Yao's_Millionaires'_Problem:71">
 <semantics>
  <mrow>
   <mrow>
    <mi>N</mi>
    <mo>⊕</mo>
    <mrow>
     <msubsup>
      <mo largeop="true" mathsize="160%" stretchy="false" symmetric="true">⊕</mo>
      <mrow>
       <mi>i</mi>
       <mo>=</mo>
       <mn>1</mn>
      </mrow>
      <mi>d</mi>
     </msubsup>
     <msubsup>
      <mi>K</mi>
      <mrow>
       <mi>i</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <msub>
          <mi>b</mi>
          <mi>i</mi>
         </msub>
         <mo>+</mo>
         <mn>1</mn>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
      <mo>′</mo>
     </msubsup>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mi>r</mi>
    <mi>o</mi>
    <mi>l</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <msubsup>
       <mo largeop="true" mathsize="160%" stretchy="false" symmetric="true">⊕</mo>
       <mrow>
        <mi>i</mi>
        <mo>=</mo>
        <mn>1</mn>
       </mrow>
       <mi>d</mi>
      </msubsup>
      <msub>
       <mi>K</mi>
       <mrow>
        <mi>i</mi>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <msub>
           <mi>b</mi>
           <mi>i</mi>
          </msub>
          <mo>+</mo>
          <mn>1</mn>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
      </msub>
     </mrow>
     <mo>,</mo>
     <mi>u</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="latexml">direct-sum</csymbol>
     <ci>N</ci>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <csymbol cd="latexml">direct-sum</csymbol>
        <apply>
         <eq></eq>
         <ci>i</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <ci>d</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>K</ci>
        <ci>normal-′</ci>
       </apply>
       <apply>
        <times></times>
        <ci>i</ci>
        <apply>
         <plus></plus>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>b</ci>
          <ci>i</ci>
         </apply>
         <cn type="integer">1</cn>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <times></times>
     <ci>r</ci>
     <ci>o</ci>
     <ci>l</ci>
     <interval closure="open">
      <apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <csymbol cd="latexml">direct-sum</csymbol>
         <apply>
          <eq></eq>
          <ci>i</ci>
          <cn type="integer">1</cn>
         </apply>
        </apply>
        <ci>d</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>K</ci>
        <apply>
         <times></times>
         <ci>i</ci>
         <apply>
          <plus></plus>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>b</ci>
           <ci>i</ci>
          </apply>
          <cn type="integer">1</cn>
         </apply>
        </apply>
       </apply>
      </apply>
      <ci>u</ci>
     </interval>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   N\oplus\bigoplus_{i=1}^{d}K^{\prime}_{i(b_{i}+1)}=rol(\bigoplus_{i=1}^{d}K_{i(%
b_{i}+1)},u)
  </annotation>
 </semantics>
</math>

 and the result depends on 

<math display="inline" id="Yao's_Millionaires'_Problem:72">
 <semantics>
  <mrow>
   <mi>c</mi>
   <mo>=</mo>
   <mrow>
    <msubsup>
     <mo largeop="true" mathsize="160%" stretchy="false" symmetric="true">⊕</mo>
     <mrow>
      <mi>i</mi>
      <mo>=</mo>
      <mn>1</mn>
     </mrow>
     <mi>d</mi>
    </msubsup>
    <msub>
     <mi>K</mi>
     <mrow>
      <mi>i</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <msub>
         <mi>b</mi>
         <mi>i</mi>
        </msub>
        <mo>+</mo>
        <mn>1</mn>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </msub>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>c</ci>
    <apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <csymbol cd="latexml">direct-sum</csymbol>
       <apply>
        <eq></eq>
        <ci>i</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <ci>d</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>K</ci>
      <apply>
       <times></times>
       <ci>i</ci>
       <apply>
        <plus></plus>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>b</ci>
         <ci>i</ci>
        </apply>
        <cn type="integer">1</cn>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   c=\bigoplus_{i=1}^{d}K_{i(b_{i}+1)}
  </annotation>
 </semantics>
</math>

. K and therefore c as well, can be split into 3 parts. The left part doesn't affect the result. The right part has all the important information and in the middle there is a sequence of zeros what separate those two parts. The length of each partition of c is linked to the security scheme.</p>

<p>For every i, only one of 

<math display="inline" id="Yao's_Millionaires'_Problem:73">
 <semantics>
  <mrow>
   <msub>
    <mi>K</mi>
    <mrow>
     <mi>i</mi>
     <mn>1</mn>
    </mrow>
   </msub>
   <mo>,</mo>
   <msub>
    <mi>K</mi>
    <mrow>
     <mi>i</mi>
     <mn>2</mn>
    </mrow>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <list>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>K</ci>
     <apply>
      <times></times>
      <ci>i</ci>
      <cn type="integer">1</cn>
     </apply>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>K</ci>
     <apply>
      <times></times>
      <ci>i</ci>
      <cn type="integer">2</cn>
     </apply>
    </apply>
   </list>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   K_{i1},K_{i2}
  </annotation>
 </semantics>
</math>

 has non zero right part and it is 

<math display="inline" id="Yao's_Millionaires'_Problem:74">
 <semantics>
  <msub>
   <mi>K</mi>
   <mrow>
    <mi>i</mi>
    <mn>1</mn>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>K</ci>
    <apply>
     <times></times>
     <ci>i</ci>
     <cn type="integer">1</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   K_{i1}
  </annotation>
 </semantics>
</math>

 if 

<math display="inline" id="Yao's_Millionaires'_Problem:75">
 <semantics>
  <mrow>
   <msub>
    <mi>a</mi>
    <mi>i</mi>
   </msub>
   <mo>=</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>a</ci>
     <ci>i</ci>
    </apply>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a_{i}=1
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Yao's_Millionaires'_Problem:76">
 <semantics>
  <msub>
   <mi>K</mi>
   <mrow>
    <mi>i</mi>
    <mn>2</mn>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>K</ci>
    <apply>
     <times></times>
     <ci>i</ci>
     <cn type="integer">2</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   K_{i2}
  </annotation>
 </semantics>
</math>

 otherwise. In addition, if 

<math display="inline" id="Yao's_Millionaires'_Problem:77">
 <semantics>
  <mrow>
   <mi>i</mi>
   <mo>></mo>
   <mi>j</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <gt></gt>
    <ci>i</ci>
    <ci>j</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   i>j
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Yao's_Millionaires'_Problem:78">
 <semantics>
  <msub>
   <mi>K</mi>
   <mrow>
    <mi>i</mi>
    <mi>l</mi>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>K</ci>
    <apply>
     <times></times>
     <ci>i</ci>
     <ci>l</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   K_{il}
  </annotation>
 </semantics>
</math>

 has a non zero right part then 

<math display="inline" id="Yao's_Millionaires'_Problem:79">
 <semantics>
  <mrow>
   <msub>
    <mi>K</mi>
    <mrow>
     <mi>i</mi>
     <mi>l</mi>
    </mrow>
   </msub>
   <mo>⊕</mo>
   <msub>
    <mi>K</mi>
    <mrow>
     <mi>j</mi>
     <mi>l</mi>
    </mrow>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">direct-sum</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>K</ci>
     <apply>
      <times></times>
      <ci>i</ci>
      <ci>l</ci>
     </apply>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>K</ci>
     <apply>
      <times></times>
      <ci>j</ci>
      <ci>l</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   K_{il}\oplus K_{jl}
  </annotation>
 </semantics>
</math>

 has also a non zero right part and the two leftmost bits of this right part will be the same as the one of 

<math display="inline" id="Yao's_Millionaires'_Problem:80">
 <semantics>
  <msub>
   <mi>A</mi>
   <mrow>
    <mi>i</mi>
    <mi>l</mi>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>A</ci>
    <apply>
     <times></times>
     <ci>i</ci>
     <ci>l</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A_{il}
  </annotation>
 </semantics>
</math>

. As a result, the right part of c is a function of the entries Bob transferred correspond to the unique bits in a and b and the only bits in the right part in c which are not random are the two leftmost, Exactly the bits which determines the result of 

<math display="inline" id="Yao's_Millionaires'_Problem:81">
 <semantics>
  <mrow>
   <msub>
    <mi>a</mi>
    <mi>i</mi>
   </msub>
   <mo>></mo>
   <msub>
    <mi>b</mi>
    <mi>i</mi>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <gt></gt>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>a</ci>
     <ci>i</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>b</ci>
     <ci>i</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a_{i}>b_{i}
  </annotation>
 </semantics>
</math>

 where i is the highest order bit in which a and b differ. In the end, if 

<math display="inline" id="Yao's_Millionaires'_Problem:82">
 <semantics>
  <mrow>
   <msub>
    <mi>a</mi>
    <mi>i</mi>
   </msub>
   <mo>></mo>
   <msub>
    <mi>b</mi>
    <mi>i</mi>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <gt></gt>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>a</ci>
     <ci>i</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>b</ci>
     <ci>i</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a_{i}>b_{i}
  </annotation>
 </semantics>
</math>

 then those two leftmost bits will be 11 and Bob will answer that 

<math display="inline" id="Yao's_Millionaires'_Problem:83">
 <semantics>
  <mrow>
   <mi>a</mi>
   <mo>≥</mo>
   <mi>b</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <geq></geq>
    <ci>a</ci>
    <ci>b</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a\geq b
  </annotation>
 </semantics>
</math>

. If the bits are 10 then 

<math display="inline" id="Yao's_Millionaires'_Problem:84">
 <semantics>
  <mrow>
   <msub>
    <mi>a</mi>
    <mi>i</mi>
   </msub>
   <mo><</mo>
   <msub>
    <mi>b</mi>
    <mi>i</mi>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <lt></lt>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>a</ci>
     <ci>i</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>b</ci>
     <ci>i</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a_{i}<b_{i}
  </annotation>
 </semantics>
</math>

 and he will answer a<b. #="" 11="" 3="" <math="" =="The" a="b" alice="" alice,="" and="" be="" because="" bits="" bob="" c="" case="" from="" gets="" if="" in="" indicate="" information="" is="" it="" leftmost="" no="" numbers="" oblivious="" part="" result.="Security" right="" secure="" secure.="" sends="" sent="" the="" then="" there="" this="" through="" to="" transfer="" two="" which="" will="">rol(K_{i(1+b_i)} \oplus S_i ,u)</b.></p>

<p>for every 

<math display="inline" id="Yao's_Millionaires'_Problem:85">
 <semantics>
  <mi>i</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>i</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   i
  </annotation>
 </semantics>
</math>

 Bob receives one such number and 

<math display="inline" id="Yao's_Millionaires'_Problem:86">
 <semantics>
  <msub>
   <mi>S</mi>
   <mi>i</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>S</ci>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   S_{i}
  </annotation>
 </semantics>
</math>

 is random so no secure information is transformed,</p>
<ol>
<li>N, This is an XOR of random numbers and therefore reveals no information. The relevant information is revealed only after calculating c and,</li>
<li>c, The same goes for c. The left part of c is random and the right part is random as well except from the two leftmost bits. Deducing any information from those bits requires guessing some other values and the chance of guessing them correct is very low.</li>
</ol>
<h3 id="complexity">Complexity</h3>

<p>The <a class="uri" href="complexity" title="wikilink">complexity</a> of the <a href="Cryptographic_protocol" title="wikilink">protocol</a> is 

<math display="inline" id="Yao's_Millionaires'_Problem:87">
 <semantics>
  <mrow>
   <mi>O</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msup>
     <mi>d</mi>
     <mn>2</mn>
    </msup>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>O</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>d</ci>
     <cn type="integer">2</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   O(d^{2})
  </annotation>
 </semantics>
</math>

. Alice constructs d length number for each bit of a and Bob calculates XOR d times of d length numbers. The complexity of those operations is 

<math display="inline" id="Yao's_Millionaires'_Problem:88">
 <semantics>
  <mrow>
   <mi>O</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msup>
     <mi>d</mi>
     <mn>2</mn>
    </msup>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>O</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>d</ci>
     <cn type="integer">2</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   O(d^{2})
  </annotation>
 </semantics>
</math>

. The communication part takes also 

<math display="inline" id="Yao's_Millionaires'_Problem:89">
 <semantics>
  <mrow>
   <mi>O</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msup>
     <mi>d</mi>
     <mn>2</mn>
    </msup>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>O</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>d</ci>
     <cn type="integer">2</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   O(d^{2})
  </annotation>
 </semantics>
</math>

. Therefore the complexity of the protocol is 

<math display="inline" id="Yao's_Millionaires'_Problem:90">
 <semantics>
  <mrow>
   <mrow>
    <mi>O</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <msup>
      <mi>d</mi>
      <mn>2</mn>
     </msup>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>O</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>d</ci>
     <cn type="integer">2</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   O(d^{2}).
  </annotation>
 </semantics>
</math>

</p>
<h2 id="see-also">See also</h2>
<ul>
<li><a class="uri" href="Cryptography" title="wikilink">Cryptography</a></li>
<li><a href="Secure_multi-party_computation" title="wikilink">Secure multi-party computation</a></li>
<li><a href="RSA_(algorithm)" title="wikilink">RSA</a></li>
<li><a href="Socialist_millionaire" title="wikilink">Socialist millionaire</a>, a variant in which the millionaires wish to determine whether their fortunes are equal.</li>
</ul>
<h2 id="notes">Notes</h2>

<p>"</p>

<p><a href="Category:Cryptographic_protocols" title="wikilink">Category:Cryptographic protocols</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1"><a href="#fnref1">↩</a></li>
<li id="fn2"><a href="#fnref2">↩</a></li>
</ol>
</section>
</body>
</html>

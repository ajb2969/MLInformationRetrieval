<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="878">Categorical distribution</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Categorical distribution</h1>
<hr/>

<p>([x=i]) = p_i (1-p_i)<br/>


<math display="inline" id="Categorical_distribution:0">
 <semantics>
  <mrow>
   <mi>Cov</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mrow>
     <mo stretchy="false">[</mo>
     <mi>x</mi>
     <mo>=</mo>
     <mi>i</mi>
     <mo stretchy="false">]</mo>
    </mrow>
    <mo>,</mo>
    <mrow>
     <mo stretchy="false">[</mo>
     <mi>x</mi>
     <mo>=</mo>
     <mi>j</mi>
     <mo stretchy="false">]</mo>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>=</mo>
   <mo>-</mo>
   <msub>
    <mi>p</mi>
    <mi>i</mi>
   </msub>
   <mpadded width="+6.6pt">
    <msub>
     <mi>p</mi>
     <mi>j</mi>
    </msub>
   </mpadded>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>i</mi>
    <mo>≠</mo>
    <mi>j</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">Cov</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <ci>normal-[</ci>
      <csymbol cd="unknown">x</csymbol>
      <eq></eq>
      <csymbol cd="unknown">i</csymbol>
      <ci>normal-]</ci>
     </cerror>
     <ci>normal-,</ci>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <ci>normal-[</ci>
      <csymbol cd="unknown">x</csymbol>
      <eq></eq>
      <csymbol cd="unknown">j</csymbol>
      <ci>normal-]</ci>
     </cerror>
     <ci>normal-)</ci>
    </cerror>
    <eq></eq>
    <minus></minus>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>p</ci>
     <ci>i</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>p</ci>
     <ci>j</ci>
    </apply>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">i</csymbol>
     <neq></neq>
     <csymbol cd="unknown">j</csymbol>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \textstyle{\mathrm{Cov}}([x=i],[x=j])=-p_{i}p_{j}~{}~{}(i\neq j)
  </annotation>
 </semantics>
</math>

|</p>

<p><code> skewness   =|</code><br/>
<code> kurtosis   =|</code><br/>
<code> entropy    =|</code><br/>
<code> mgf        =</code>

<math display="inline" id="Categorical_distribution:1">
 <semantics>
  <mrow>
   <msubsup>
    <mo largeop="true" symmetric="true">∑</mo>
    <mrow>
     <mi>i</mi>
     <mo>=</mo>
     <mn>1</mn>
    </mrow>
    <mi>k</mi>
   </msubsup>
   <mrow>
    <msub>
     <mi>p</mi>
     <mi>i</mi>
    </msub>
    <msup>
     <mi>e</mi>
     <msub>
      <mi>t</mi>
      <mi>i</mi>
     </msub>
    </msup>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <sum></sum>
      <apply>
       <eq></eq>
       <ci>i</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <ci>k</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>p</ci>
      <ci>i</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>e</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>t</ci>
       <ci>i</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \sum_{i=1}^{k}p_{i}e^{t_{i}}
  </annotation>
 </semantics>
</math>

<code>|</code><br/>
<code> char       =</code>

<math display="inline" id="Categorical_distribution:2">
 <semantics>
  <mrow>
   <msubsup>
    <mo largeop="true" symmetric="true">∑</mo>
    <mrow>
     <mi>j</mi>
     <mo>=</mo>
     <mn>1</mn>
    </mrow>
    <mi>k</mi>
   </msubsup>
   <mrow>
    <msub>
     <mi>p</mi>
     <mi>j</mi>
    </msub>
    <msup>
     <mi>e</mi>
     <mrow>
      <mi>i</mi>
      <msub>
       <mi>t</mi>
       <mi>j</mi>
      </msub>
     </mrow>
    </msup>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <sum></sum>
      <apply>
       <eq></eq>
       <ci>j</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <ci>k</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>p</ci>
      <ci>j</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>e</ci>
      <apply>
       <times></times>
       <ci>i</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>t</ci>
        <ci>j</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \sum_{j=1}^{k}p_{j}e^{it_{j}}
  </annotation>
 </semantics>
</math>

<code> where </code>

<math display="inline" id="Categorical_distribution:3">
 <semantics>
  <mrow>
   <msup>
    <mi>i</mi>
    <mn>2</mn>
   </msup>
   <mo>=</mo>
   <mrow>
    <mo>-</mo>
    <mn>1</mn>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>i</ci>
     <cn type="integer">2</cn>
    </apply>
    <apply>
     <minus></minus>
     <cn type="integer">1</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   i^{2}=-1
  </annotation>
 </semantics>
</math>

<code>|</code><br/>
<code> pgf = </code>

<math display="inline" id="Categorical_distribution:4">
 <semantics>
  <mrow>
   <mrow>
    <msubsup>
     <mo largeop="true" symmetric="true">∑</mo>
     <mrow>
      <mi>i</mi>
      <mo>=</mo>
      <mn>1</mn>
     </mrow>
     <mi>k</mi>
    </msubsup>
    <mrow>
     <msub>
      <mi>p</mi>
      <mi>i</mi>
     </msub>
     <msub>
      <mi>z</mi>
      <mi>i</mi>
     </msub>
     <mtext>for</mtext>
     <mrow>
      <mo stretchy="false">(</mo>
      <msub>
       <mi>z</mi>
       <mn>1</mn>
      </msub>
      <mo>,</mo>
      <mi mathvariant="normal">…</mi>
      <mo>,</mo>
      <msub>
       <mi>z</mi>
       <mi>k</mi>
      </msub>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>∈</mo>
   <msup>
    <mi>ℂ</mi>
    <mi>k</mi>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <in></in>
    <apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <apply>
        <eq></eq>
        <ci>i</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <ci>k</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>p</ci>
       <ci>i</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>z</ci>
       <ci>i</ci>
      </apply>
      <mtext>for</mtext>
      <vector>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>z</ci>
        <cn type="integer">1</cn>
       </apply>
       <ci>normal-…</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>z</ci>
        <ci>k</ci>
       </apply>
      </vector>
     </apply>
    </apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>ℂ</ci>
     <ci>k</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \sum_{i=1}^{k}p_{i}z_{i}\text{ for }(z_{1},\ldots,z_{k})\in\mathbb{C}^{k}
  </annotation>
 </semantics>
</math>

<code>|</code><br/>
<code> conjugate  =</code><a href="Dirichlet_distribution" title="wikilink"><code>Dirichlet</code></a>

<math display="block" id="Categorical_distribution:5">
 <semantics>
  <mrow>
   <mi>Dir</mi>
   <mrow>
    <mo>(</mo>
    <mi>𝜶</mi>
    <mo>+</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mo stretchy="false">[</mo>
      <mi>x</mi>
      <mo>=</mo>
      <mi>i</mi>
      <mo stretchy="false">]</mo>
     </mrow>
     <mo>,</mo>
     <mi mathvariant="normal">…</mi>
     <mo>,</mo>
     <mrow>
      <mo stretchy="false">[</mo>
      <mi>x</mi>
      <mo>=</mo>
      <mi>k</mi>
      <mo stretchy="false">]</mo>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
    <mo>)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">Dir</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">α</csymbol>
     <plus></plus>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <ci>normal-(</ci>
      <cerror>
       <csymbol cd="ambiguous">fragments</csymbol>
       <ci>normal-[</ci>
       <csymbol cd="unknown">x</csymbol>
       <eq></eq>
       <csymbol cd="unknown">i</csymbol>
       <ci>normal-]</ci>
      </cerror>
      <ci>normal-,</ci>
      <ci>normal-…</ci>
      <ci>normal-,</ci>
      <cerror>
       <csymbol cd="ambiguous">fragments</csymbol>
       <ci>normal-[</ci>
       <csymbol cd="unknown">x</csymbol>
       <eq></eq>
       <csymbol cd="unknown">k</csymbol>
       <ci>normal-]</ci>
      </cerror>
      <ci>normal-)</ci>
     </cerror>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathrm{Dir}\left(\boldsymbol{\alpha}+([x=i],\dots,[x=k])\right)
  </annotation>
 </semantics>
</math>

<code>|</code></p>

<p>}}</p>

<p>In <a href="probability_theory" title="wikilink">probability theory</a> and <a class="uri" href="statistics" title="wikilink">statistics</a>, a <strong>categorical distribution</strong> (also called a "generalized Bernoulli distribution", "multinoulli distribution" <a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a> or, less precisely, a "<a href="discrete_distribution" title="wikilink">discrete distribution</a>") is a <a href="probability_distribution" title="wikilink">probability distribution</a> that describes the possible results of a random event that can take on one of <em>K</em> possible outcomes, with the probability of each outcome separately specified. There is not necessarily an underlying ordering of these outcomes, but numerical labels are often attached for convenience in describing the distribution, (e.g. 1 to <em>K</em>). Note that the <em>K</em>-dimensional categorical distribution is the most general distribution over a <em>K</em>-way event; any other discrete distribution over a size-<em>K</em> <a href="sample_space" title="wikilink">sample space</a> is a special case. The parameters specifying the probabilities of each possible outcome are constrained only by the fact that each must be in the range 0 to 1, and all must sum to 1.</p>

<p>The categorical distribution is the generalization of the <a href="Bernoulli_distribution" title="wikilink">Bernoulli distribution</a> for a categorical random variable, i.e. for a discrete variable with more than two possible outcomes.</p>
<h2 id="terminology">Terminology</h2>

<p>Occasionally, the categorical distribution is termed the "discrete distribution". However, this properly refers not to one particular family of distributions but to a <a href="discrete_distribution" title="wikilink">general class of distributions</a>.</p>

<p>Note that, in some fields, such as <a href="machine_learning" title="wikilink">machine learning</a> and <a href="natural_language_processing" title="wikilink">natural language processing</a>, the categorical and <a href="multinomial_distribution" title="wikilink">multinomial distributions</a> are conflated, and it is common to speak of a "multinomial distribution" when a categorical distribution is actually meant.<a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a> This imprecise usage stems from the fact that it is sometimes convenient to express the outcome of a categorical distribution as a "1-of-K" vector (a vector with one element containing a 1 and all other elements containing a 0) rather than as an integer in the range 1 to <em>K</em>; in this form, a categorical distribution is equivalent to a multinomial distribution for a single observation (see below).</p>

<p>However, conflating the categorical and multinomial distributions can lead to problems. For example, in a <a href="Dirichlet-multinomial_distribution" title="wikilink">Dirichlet-multinomial distribution</a>, which arises commonly in natural language processing models (although not usually with this name) as a result of <a href="collapsed_Gibbs_sampling" title="wikilink">collapsed Gibbs sampling</a> where <a href="Dirichlet_distribution" title="wikilink">Dirichlet distributions</a> are collapsed out of a <a href="Hierarchical_Bayesian_model" title="wikilink">Hierarchical Bayesian model</a>, it is very important to distinguish categorical from multinomial. The <a href="joint_distribution" title="wikilink">joint distribution</a> of the same variables with the same Dirichlet-multinomial distribution has two different forms depending on whether it is characterized as a distribution whose domain is over individual categorical nodes or over multinomial-style counts of nodes in each particular category (similar to the distinction between a set of <a href="Bernoulli_distribution" title="wikilink">Bernoulli-distributed</a> nodes and a single <a href="binomial_distribution" title="wikilink">binomial-distributed</a> node). Both forms have very similar-looking <a href="probability_mass_function" title="wikilink">probability mass functions</a> (PMF's), which both make reference to multinomial-style counts of nodes in a category. However, the multinomial-style PMF has an extra factor, a <a href="multinomial_coefficient" title="wikilink">multinomial coefficient</a>, that is a constant equal to 1 in the categorical-style PMF. Confusing the two can easily lead to incorrect results in settings where this extra factor is not constant with respect to the distributions of interest. The factor is frequently constant in the complete conditionals used in Gibbs sampling and the optimal distributions in variational methods.</p>
<h2 id="introduction">Introduction</h2>

<p>A <strong>categorical distribution</strong> is a discrete probability distribution whose <a href="sample_space" title="wikilink">sample space</a> is the set of <em>k</em> individually identified items. It is the generalization of the <a href="Bernoulli_distribution" title="wikilink">Bernoulli distribution</a> for a categorical random variable.</p>

<p>In one formulation of the distribution, the <a href="sample_space" title="wikilink">sample space</a> is taken to be a finite sequence of integers. The exact integers used as labels are unimportant; they might be {0, 1, ..., <em>k</em>-1} or {1, 2, ..., <em>k</em>} or any other arbitrary set of values. In the following descriptions, we use {1, 2, ..., <em>k</em>} for convenience, although this disagrees with the convention for the <a href="Bernoulli_distribution" title="wikilink">Bernoulli distribution</a>, which uses {0, 1}. In this case, the <a href="probability_mass_function" title="wikilink">probability mass function</a> <em>f</em> is:</p>

<p>

<math display="block" id="Categorical_distribution:6">
 <semantics>
  <mrow>
   <mi>f</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>x</mi>
    <mo>=</mo>
    <mi>i</mi>
    <mo stretchy="false">|</mo>
    <mi>𝒑</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>=</mo>
   <msub>
    <mi>p</mi>
    <mi>i</mi>
   </msub>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">f</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">x</csymbol>
     <eq></eq>
     <csymbol cd="unknown">i</csymbol>
     <ci>normal-|</ci>
     <csymbol cd="unknown">p</csymbol>
     <ci>normal-)</ci>
    </cerror>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>p</ci>
     <ci>i</ci>
    </apply>
    <ci>normal-,</ci>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f(x=i|\boldsymbol{p})=p_{i},
  </annotation>
 </semantics>
</math>

</p>

<p>where 

<math display="inline" id="Categorical_distribution:7">
 <semantics>
  <mrow>
   <mi>𝒑</mi>
   <mo>=</mo>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>p</mi>
     <mn>1</mn>
    </msub>
    <mo>,</mo>
    <mi mathvariant="normal">…</mi>
    <mo>,</mo>
    <msub>
     <mi>p</mi>
     <mi>k</mi>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>𝒑</ci>
    <vector>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>p</ci>
      <cn type="integer">1</cn>
     </apply>
     <ci>normal-…</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>p</ci>
      <ci>k</ci>
     </apply>
    </vector>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \boldsymbol{p}=(p_{1},...,p_{k})
  </annotation>
 </semantics>
</math>

, 

<math display="inline" id="Categorical_distribution:8">
 <semantics>
  <msub>
   <mi>p</mi>
   <mi>i</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>p</ci>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p_{i}
  </annotation>
 </semantics>
</math>

 represents the probability of seeing element <em>i</em> and 

<math display="inline" id="Categorical_distribution:9">
 <semantics>
  <mrow>
   <mrow>
    <msubsup>
     <mo largeop="true" symmetric="true">∑</mo>
     <mrow>
      <mi>i</mi>
      <mo>=</mo>
      <mn>1</mn>
     </mrow>
     <mi>k</mi>
    </msubsup>
    <msub>
     <mi>p</mi>
     <mi>i</mi>
    </msub>
   </mrow>
   <mo>=</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <apply>
        <eq></eq>
        <ci>i</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <ci>k</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>p</ci>
      <ci>i</ci>
     </apply>
    </apply>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \textstyle{\sum_{i=1}^{k}p_{i}=1}
  </annotation>
 </semantics>
</math>

.</p>

<p>Another formulation that appears more complex but facilitates mathematical manipulations is as follows, using the <a href="Iverson_bracket" title="wikilink">Iverson bracket</a>:<a class="footnoteRef" href="#fn3" id="fnref3"><sup>3</sup></a></p>

<p>

<math display="block" id="Categorical_distribution:10">
 <semantics>
  <mrow>
   <mi>f</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>x</mi>
    <mo stretchy="false">|</mo>
    <mi>𝒑</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>=</mo>
   <munderover>
    <mo largeop="true" movablelimits="false" symmetric="true">∏</mo>
    <mrow>
     <mi>i</mi>
     <mo>=</mo>
     <mn>1</mn>
    </mrow>
    <mi>k</mi>
   </munderover>
   <msubsup>
    <mi>p</mi>
    <mi>i</mi>
    <mrow>
     <mo stretchy="false">[</mo>
     <mi>x</mi>
     <mo>=</mo>
     <mi>i</mi>
     <mo stretchy="false">]</mo>
    </mrow>
   </msubsup>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">f</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">x</csymbol>
     <ci>normal-|</ci>
     <csymbol cd="unknown">p</csymbol>
     <ci>normal-)</ci>
    </cerror>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <csymbol cd="latexml">product</csymbol>
      <apply>
       <eq></eq>
       <ci>i</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <ci>k</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>p</ci>
      <ci>i</ci>
     </apply>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <ci>normal-[</ci>
      <csymbol cd="unknown">x</csymbol>
      <eq></eq>
      <csymbol cd="unknown">i</csymbol>
      <ci>normal-]</ci>
     </cerror>
    </apply>
    <ci>normal-,</ci>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f(x|\boldsymbol{p})=\prod_{i=1}^{k}p_{i}^{[x=i]},
  </annotation>
 </semantics>
</math>

</p>

<p>where 

<math display="inline" id="Categorical_distribution:11">
 <semantics>
  <mrow>
   <mo stretchy="false">[</mo>
   <mrow>
    <mi>x</mi>
    <mo>=</mo>
    <mi>i</mi>
   </mrow>
   <mo stretchy="false">]</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">delimited-[]</csymbol>
    <apply>
     <eq></eq>
     <ci>x</ci>
     <ci>i</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   [x=i]
  </annotation>
 </semantics>
</math>

 evaluates to 1 if 

<math display="inline" id="Categorical_distribution:12">
 <semantics>
  <mrow>
   <mi>x</mi>
   <mo>=</mo>
   <mi>i</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>x</ci>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x=i
  </annotation>
 </semantics>
</math>

, 0 otherwise. There are various advantages of this formulation, e.g.:</p>
<ul>
<li>It is easier to write out the <a href="likelihood_function" title="wikilink">likelihood function</a> of a set of <a href="independent_identically_distributed" title="wikilink">independent identically distributed</a> categorical variables.</li>
<li>It connects the categorical distribution with the related <a href="multinomial_distribution" title="wikilink">multinomial distribution</a>.</li>
<li>It shows why the <a href="Dirichlet_distribution" title="wikilink">Dirichlet distribution</a> is the <a href="conjugate_prior" title="wikilink">conjugate prior</a> of the categorical distribution, and allows the <a href="posterior_distribution" title="wikilink">posterior distribution</a> of the parameters to be calculated.</li>
</ul>

<p>Yet another formulation makes explicit the connection between the categorical and <a href="multinomial_distribution" title="wikilink">multinomial distributions</a> by treating the categorical distribution as a special case of the multinomial distribution in which the parameter <em>n</em> of the multinomial distribution (the number of sampled items) is fixed at 1. In this formulation, the sample space can be considered to be the set of 1-of-K encoded<a class="footnoteRef" href="#fn4" id="fnref4"><sup>4</sup></a> random vectors <strong>x</strong> of dimension <em>k</em> having the property that exactly one element has the value 1 and the others have the value 0. The particular element having the value 1 indicates which category has been chosen. The <a href="probability_mass_function" title="wikilink">probability mass function</a> <em>f</em> in this formulation is:</p>

<p>

<math display="block" id="Categorical_distribution:13">
 <semantics>
  <mrow>
   <mi>f</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>𝐱</mi>
    <mo stretchy="false">|</mo>
    <mi>𝒑</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>=</mo>
   <munderover>
    <mo largeop="true" movablelimits="false" symmetric="true">∏</mo>
    <mrow>
     <mi>i</mi>
     <mo>=</mo>
     <mn>1</mn>
    </mrow>
    <mi>k</mi>
   </munderover>
   <msubsup>
    <mi>p</mi>
    <mi>i</mi>
    <msub>
     <mi>x</mi>
     <mi>i</mi>
    </msub>
   </msubsup>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">f</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">x</csymbol>
     <ci>normal-|</ci>
     <csymbol cd="unknown">p</csymbol>
     <ci>normal-)</ci>
    </cerror>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <csymbol cd="latexml">product</csymbol>
      <apply>
       <eq></eq>
       <ci>i</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <ci>k</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>p</ci>
      <ci>i</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <ci>i</ci>
     </apply>
    </apply>
    <ci>normal-,</ci>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f(\mathbf{x}|\boldsymbol{p})=\prod_{i=1}^{k}p_{i}^{x_{i}},
  </annotation>
 </semantics>
</math>

</p>

<p>where 

<math display="inline" id="Categorical_distribution:14">
 <semantics>
  <msub>
   <mi>p</mi>
   <mi>i</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>p</ci>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p_{i}
  </annotation>
 </semantics>
</math>

 represents the probability of seeing element <em>i</em> and 

<math display="inline" id="Categorical_distribution:15">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mo largeop="true" symmetric="true">∑</mo>
     <mi>i</mi>
    </msub>
    <msub>
     <mi>p</mi>
     <mi>i</mi>
    </msub>
   </mrow>
   <mo>=</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <sum></sum>
      <ci>i</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>p</ci>
      <ci>i</ci>
     </apply>
    </apply>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \textstyle{\sum_{i}p_{i}=1}
  </annotation>
 </semantics>
</math>

. This is the formulation adopted by Bishop.<a class="footnoteRef" href="#fn5" id="fnref5"><sup>5</sup></a><a class="footnoteRef" href="#fn6" id="fnref6"><sup>6</sup></a></p>
<h2 id="properties">Properties</h2>
<figure><b>(Figure)</b>
<figcaption>The possible probabilities for the categorical distribution with 

<math display="inline" id="Categorical_distribution:16">
 <semantics>
  <mrow>
   <mi>k</mi>
   <mo>=</mo>
   <mn>3</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>k</ci>
    <cn type="integer">3</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   k=3
  </annotation>
 </semantics>
</math>

 are the 2-simplex 

<math display="inline" id="Categorical_distribution:17">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>p</mi>
     <mn>1</mn>
    </msub>
    <mo>+</mo>
    <msub>
     <mi>p</mi>
     <mn>2</mn>
    </msub>
    <mo>+</mo>
    <msub>
     <mi>p</mi>
     <mn>3</mn>
    </msub>
   </mrow>
   <mo>=</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <plus></plus>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>p</ci>
      <cn type="integer">1</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>p</ci>
      <cn type="integer">2</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>p</ci>
      <cn type="integer">3</cn>
     </apply>
    </apply>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p_{1}+p_{2}+p_{3}=1
  </annotation>
 </semantics>
</math>

, embedded in 3-space.</figcaption>
</figure>
<ul>
<li>The distribution is completely given by the probabilities associated with each number <em>i</em>

<math display="block" id="Categorical_distribution:18">
 <semantics>
  <mrow>
   <msub>
    <mi>p</mi>
    <mi>i</mi>
   </msub>
   <mo>=</mo>
   <mi>P</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>X</mi>
    <mo>=</mo>
    <mi>i</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>p</ci>
     <ci>i</ci>
    </apply>
    <eq></eq>
    <csymbol cd="unknown">P</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">X</csymbol>
     <eq></eq>
     <csymbol cd="unknown">i</csymbol>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p_{i}=P(X=i)
  </annotation>
 </semantics>
</math>

, <em>i</em> = 1,...,<em>k</em>, where 

<math display="inline" id="Categorical_distribution:19">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mo largeop="true" symmetric="true">∑</mo>
     <mi>i</mi>
    </msub>
    <msub>
     <mi>p</mi>
     <mi>i</mi>
    </msub>
   </mrow>
   <mo>=</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <sum></sum>
      <ci>i</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>p</ci>
      <ci>i</ci>
     </apply>
    </apply>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \textstyle{\sum_{i}p_{i}=1}
  </annotation>
 </semantics>
</math>

. The possible probabilities are exactly the <a href="standard_simplex" title="wikilink">standard 

<math display="inline" id="Categorical_distribution:20">
 <semantics>
  <mrow>
   <mo stretchy="false">(</mo>
   <mrow>
    <mi>k</mi>
    <mo>-</mo>
    <mn>1</mn>
   </mrow>
   <mo stretchy="false">)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <minus></minus>
    <ci>k</ci>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (k-1)
  </annotation>
 </semantics>
</math>

-dimensional simplex</a>; for <em>k</em> = 2 this reduces to the possible probabilities of the Bernoulli distribution being the 1-simplex, 

<math display="inline" id="Categorical_distribution:21">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <msub>
      <mi>p</mi>
      <mn>1</mn>
     </msub>
     <mo>+</mo>
     <msub>
      <mi>p</mi>
      <mn>2</mn>
     </msub>
    </mrow>
    <mo>=</mo>
    <mn>1</mn>
   </mrow>
   <mo>,</mo>
   <mrow>
    <mrow>
     <mn>0</mn>
     <mo>≤</mo>
     <msub>
      <mi>p</mi>
      <mn>1</mn>
     </msub>
    </mrow>
    <mo>,</mo>
    <mrow>
     <msub>
      <mi>p</mi>
      <mn>2</mn>
     </msub>
     <mo>≤</mo>
     <mn>1.</mn>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <eq></eq>
     <apply>
      <plus></plus>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>p</ci>
       <cn type="integer">1</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>p</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
     <cn type="integer">1</cn>
    </apply>
    <apply>
     <csymbol cd="ambiguous">formulae-sequence</csymbol>
     <apply>
      <leq></leq>
      <cn type="integer">0</cn>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>p</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <apply>
      <leq></leq>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>p</ci>
       <cn type="integer">2</cn>
      </apply>
      <cn type="float">1.</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p_{1}+p_{2}=1,0\leq p_{1},p_{2}\leq 1.
  </annotation>
 </semantics>
</math>

</li>
</ul>
<ul>
<li>The distribution is a special case of a "multivariate Bernoulli distribution"<a class="footnoteRef" href="#fn7" id="fnref7"><sup>7</sup></a> in which exactly one of the <em>k</em> 0-1 variables takes the value one.</li>
</ul>
<ul>
<li>

<math display="inline" id="Categorical_distribution:22">
 <semantics>
  <mrow>
   <mrow>
    <mi>𝔼</mi>
    <mrow>
     <mo>[</mo>
     <mi>𝐱</mi>
     <mo>]</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mi>𝒑</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>𝔼</ci>
     <apply>
      <csymbol cd="latexml">delimited-[]</csymbol>
      <ci>𝐱</ci>
     </apply>
    </apply>
    <ci>𝒑</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbb{E}\left[\mathbf{x}\right]=\boldsymbol{p}
  </annotation>
 </semantics>
</math>

</li>
</ul>
<ul>
<li>Let 

<math display="inline" id="Categorical_distribution:23">
 <semantics>
  <mi>𝑿</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>𝑿</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \boldsymbol{X}
  </annotation>
 </semantics>
</math>

 be the realisation from a categorical distribution. Define the random vector <em>Y</em> as composed of the elements:</li>
</ul>
<dl>
<dd><dl>
<dd>

<math display="inline" id="Categorical_distribution:24">
 <semantics>
  <mrow>
   <msub>
    <mi>Y</mi>
    <mi>i</mi>
   </msub>
   <mo>=</mo>
   <mi>I</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>𝑿</mi>
    <mo>=</mo>
    <mi>i</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>Y</ci>
     <ci>i</ci>
    </apply>
    <eq></eq>
    <csymbol cd="unknown">I</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">X</csymbol>
     <eq></eq>
     <csymbol cd="unknown">i</csymbol>
     <ci>normal-)</ci>
    </cerror>
    <ci>normal-,</ci>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Y_{i}=I(\boldsymbol{X}=i),
  </annotation>
 </semantics>
</math>


</dd>
</dl>
</dd>
<dd>where <em>I</em> is the <a href="indicator_function" title="wikilink">indicator function</a>. Then <em>Y</em> has a distribution which is a special case of the multinomial distribution with parameter 

<math display="inline" id="Categorical_distribution:25">
 <semantics>
  <mrow>
   <mi>n</mi>
   <mo>=</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>n</ci>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n=1
  </annotation>
 </semantics>
</math>

. The sum of 

<math display="inline" id="Categorical_distribution:26">
 <semantics>
  <mi>n</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>n</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n
  </annotation>
 </semantics>
</math>

 independent and identically distributed such random variables <em>Y</em> constructed from a categorical distribution with parameter 

<math display="inline" id="Categorical_distribution:27">
 <semantics>
  <mi>𝒑</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>𝒑</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \boldsymbol{p}
  </annotation>
 </semantics>
</math>

 is <a href="multinomial_distribution" title="wikilink">multinomially distributed</a> with parameters 

<math display="inline" id="Categorical_distribution:28">
 <semantics>
  <mi>n</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>n</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Categorical_distribution:29">
 <semantics>
  <mrow>
   <mi>𝒑</mi>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <ci>𝒑</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \boldsymbol{p}.
  </annotation>
 </semantics>
</math>


</dd>
</dl>
<ul>
<li>The <a href="conjugate_prior" title="wikilink">conjugate prior</a> distribution of a categorical distribution is a <a href="Dirichlet_distribution" title="wikilink">Dirichlet distribution</a>.<a class="footnoteRef" href="#fn8" id="fnref8"><sup>8</sup></a> See the <a href="#With_a_conjugate_prior" title="wikilink">section below</a> for more discussion.</li>
</ul>
<ul>
<li>The <a href="sufficient_statistic" title="wikilink">sufficient statistic</a> from <em>n</em> independent observations is the set of counts (or, equivalently, proportion) of observations in each category, where the total number of trials (=<em>n</em>) is fixed.</li>
</ul>
<ul>
<li>The indicator function of an observation having a value <em>i</em>, equivalent to the <a href="Iverson_bracket" title="wikilink">Iverson bracket</a> function 

<math display="inline" id="Categorical_distribution:30">
 <semantics>
  <mrow>
   <mo stretchy="false">[</mo>
   <mrow>
    <mi>x</mi>
    <mo>=</mo>
    <mi>i</mi>
   </mrow>
   <mo stretchy="false">]</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">delimited-[]</csymbol>
    <apply>
     <eq></eq>
     <ci>x</ci>
     <ci>i</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   [x=i]
  </annotation>
 </semantics>
</math>

 or the <a href="Kronecker_delta" title="wikilink">Kronecker delta</a> function 

<math display="inline" id="Categorical_distribution:31">
 <semantics>
  <mrow>
   <msub>
    <mi>δ</mi>
    <mrow>
     <mi>x</mi>
     <mi>i</mi>
    </mrow>
   </msub>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>δ</ci>
    <apply>
     <times></times>
     <ci>x</ci>
     <ci>i</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \delta_{xi},
  </annotation>
 </semantics>
</math>

 is <a href="Bernoulli_distribution" title="wikilink">Bernoulli distributed</a> with parameter 

<math display="inline" id="Categorical_distribution:32">
 <semantics>
  <mrow>
   <msub>
    <mi>p</mi>
    <mi>i</mi>
   </msub>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>p</ci>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p_{i}.
  </annotation>
 </semantics>
</math>

</li>
</ul>
<h2 id="with-a-conjugate-prior">With a conjugate prior</h2>

<p>In <a href="Bayesian_statistics" title="wikilink">Bayesian statistics</a>, the <a href="Dirichlet_distribution" title="wikilink">Dirichlet distribution</a> is the <a href="conjugate_prior" title="wikilink">conjugate prior</a> distribution of the categorical distribution (and also the <a href="multinomial_distribution" title="wikilink">multinomial distribution</a>). This means that in a model consisting of a data point having a categorical distribution with unknown parameter vector <strong>p</strong>, and (in standard Bayesian style) we choose to treat this parameter as a <a href="random_variable" title="wikilink">random variable</a> and give it a <a href="prior_distribution" title="wikilink">prior distribution</a> defined using a <a href="Dirichlet_distribution" title="wikilink">Dirichlet distribution</a>, then the <a href="posterior_distribution" title="wikilink">posterior distribution</a> of the parameter, after incorporating the knowledge gained from the observed data, is also a Dirichlet. Intuitively, in such a case, starting from what we know about the parameter prior to observing the data point, we then can update our knowledge based on the data point and end up with a new distribution of the same form as the old one. This means that we can successively update our knowledge of a parameter by incorporating new observations one at a time, without running into mathematical difficulties.</p>

<p>Formally, this can be expressed as follows. Given a model</p>

<p>

<math display="block" id="Categorical_distribution:33">
 <semantics>
  <mtable displaystyle="true">
   <mtr>
    <mtd columnalign="left">
     <mi>𝜶</mi>
    </mtd>
    <mtd columnalign="center">
     <mo>=</mo>
    </mtd>
    <mtd columnalign="left">
     <mrow>
      <mo stretchy="false">(</mo>
      <msub>
       <mi>α</mi>
       <mn>1</mn>
      </msub>
      <mo>,</mo>
      <mi mathvariant="normal">…</mi>
      <mo>,</mo>
      <msub>
       <mi>α</mi>
       <mi>K</mi>
      </msub>
      <mo stretchy="false">)</mo>
     </mrow>
    </mtd>
    <mtd columnalign="center">
     <mo>=</mo>
    </mtd>
    <mtd columnalign="left">
     <mtext>concentration hyperparameter</mtext>
    </mtd>
   </mtr>
   <mtr>
    <mtd columnalign="left">
     <mrow>
      <mi>𝐩</mi>
      <mo>∣</mo>
      <mi>𝜶</mi>
     </mrow>
    </mtd>
    <mtd columnalign="center">
     <mo>=</mo>
    </mtd>
    <mtd columnalign="left">
     <mrow>
      <mo stretchy="false">(</mo>
      <msub>
       <mi>p</mi>
       <mn>1</mn>
      </msub>
      <mo>,</mo>
      <mi mathvariant="normal">…</mi>
      <mo>,</mo>
      <msub>
       <mi>p</mi>
       <mi>K</mi>
      </msub>
      <mo stretchy="false">)</mo>
     </mrow>
    </mtd>
    <mtd columnalign="center">
     <mo>∼</mo>
    </mtd>
    <mtd columnalign="left">
     <mrow>
      <mo>Dir</mo>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>K</mi>
       <mo>,</mo>
       <mi>𝜶</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mtd>
   </mtr>
   <mtr>
    <mtd columnalign="left">
     <mrow>
      <mi>𝕏</mi>
      <mo>∣</mo>
      <mi>𝐩</mi>
     </mrow>
    </mtd>
    <mtd columnalign="center">
     <mo>=</mo>
    </mtd>
    <mtd columnalign="left">
     <mrow>
      <mo stretchy="false">(</mo>
      <msub>
       <mi>x</mi>
       <mn>1</mn>
      </msub>
      <mo>,</mo>
      <mi mathvariant="normal">…</mi>
      <mo>,</mo>
      <msub>
       <mi>x</mi>
       <mi>K</mi>
      </msub>
      <mo stretchy="false">)</mo>
     </mrow>
    </mtd>
    <mtd columnalign="center">
     <mo>∼</mo>
    </mtd>
    <mtd columnalign="left">
     <mrow>
      <mo>Cat</mo>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>K</mi>
       <mo>,</mo>
       <mi>𝐩</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mtd>
   </mtr>
  </mtable>
  <annotation-xml encoding="MathML-Content">
   <matrix>
    <matrixrow>
     <ci>𝜶</ci>
     <eq></eq>
     <vector>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>α</ci>
       <cn type="integer">1</cn>
      </apply>
      <ci>normal-…</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>α</ci>
       <ci>K</ci>
      </apply>
     </vector>
     <eq></eq>
     <mtext>concentration hyperparameter</mtext>
    </matrixrow>
    <matrixrow>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <csymbol cd="unknown">p</csymbol>
      <ci>normal-∣</ci>
      <csymbol cd="unknown">α</csymbol>
     </cerror>
     <eq></eq>
     <vector>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>p</ci>
       <cn type="integer">1</cn>
      </apply>
      <ci>normal-…</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>p</ci>
       <ci>K</ci>
      </apply>
     </vector>
     <csymbol cd="latexml">similar-to</csymbol>
     <apply>
      <ci>Dir</ci>
      <ci>K</ci>
      <ci>𝜶</ci>
     </apply>
    </matrixrow>
    <matrixrow>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <csymbol cd="unknown">X</csymbol>
      <ci>normal-∣</ci>
      <csymbol cd="unknown">p</csymbol>
     </cerror>
     <eq></eq>
     <vector>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <cn type="integer">1</cn>
      </apply>
      <ci>normal-…</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <ci>K</ci>
      </apply>
     </vector>
     <csymbol cd="latexml">similar-to</csymbol>
     <apply>
      <ci>Cat</ci>
      <ci>K</ci>
      <ci>𝐩</ci>
     </apply>
    </matrixrow>
   </matrix>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \begin{array}[]{lclcl}\boldsymbol{\alpha}&=&(\alpha_{1},\ldots,\alpha_{K})&=&%
\text{concentration hyperparameter}\\
\mathbf{p}\mid\boldsymbol{\alpha}&=&(p_{1},\ldots,p_{K})&\sim&\operatorname{%
Dir}(K,\boldsymbol{\alpha})\\
\mathbb{X}\mid\mathbf{p}&=&(x_{1},\ldots,x_{K})&\sim&\operatorname{Cat}(K,%
\mathbf{p})\end{array}
  </annotation>
 </semantics>
</math>

</p>

<p>then the following holds:<a class="footnoteRef" href="#fn9" id="fnref9"><sup>9</sup></a></p>

<p>

<math display="block" id="Categorical_distribution:34">
 <semantics>
  <mtable displaystyle="true">
   <mtr>
    <mtd columnalign="left">
     <mi>𝐜</mi>
    </mtd>
    <mtd columnalign="center">
     <mo>=</mo>
    </mtd>
    <mtd columnalign="left">
     <mrow>
      <mo stretchy="false">(</mo>
      <msub>
       <mi>c</mi>
       <mn>1</mn>
      </msub>
      <mo>,</mo>
      <mi mathvariant="normal">…</mi>
      <mo>,</mo>
      <msub>
       <mi>c</mi>
       <mi>K</mi>
      </msub>
      <mo stretchy="false">)</mo>
     </mrow>
    </mtd>
    <mtd columnalign="center">
     <mo>=</mo>
    </mtd>
    <mtd columnalign="left">
     <mrow>
      <mtext>number of occurrences of category</mtext>
      <mi>i</mi>
      <mo>=</mo>
      <munderover>
       <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
       <mrow>
        <mi>j</mi>
        <mo>=</mo>
        <mn>1</mn>
       </mrow>
       <mi>N</mi>
      </munderover>
      <mrow>
       <mo stretchy="false">[</mo>
       <msub>
        <mi>x</mi>
        <mi>j</mi>
       </msub>
       <mo>=</mo>
       <mi>i</mi>
       <mo stretchy="false">]</mo>
      </mrow>
     </mrow>
    </mtd>
   </mtr>
   <mtr>
    <mtd columnalign="left">
     <mrow>
      <mi>𝐩</mi>
      <mo>∣</mo>
      <mi>𝕏</mi>
      <mo>,</mo>
      <mi>𝜶</mi>
     </mrow>
    </mtd>
    <mtd columnalign="center">
     <mo>∼</mo>
    </mtd>
    <mtd columnalign="left">
     <mrow>
      <mo>Dir</mo>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>K</mi>
       <mo>,</mo>
       <mrow>
        <mi>𝐜</mi>
        <mo>+</mo>
        <mi>𝜶</mi>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mtd>
    <mtd columnalign="center">
     <mo>=</mo>
    </mtd>
    <mtd columnalign="left">
     <mrow>
      <mo>Dir</mo>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>K</mi>
       <mo>,</mo>
       <mrow>
        <msub>
         <mi>c</mi>
         <mn>1</mn>
        </msub>
        <mo>+</mo>
        <msub>
         <mi>α</mi>
         <mn>1</mn>
        </msub>
       </mrow>
       <mo>,</mo>
       <mi mathvariant="normal">…</mi>
       <mo>,</mo>
       <mrow>
        <msub>
         <mi>c</mi>
         <mi>K</mi>
        </msub>
        <mo>+</mo>
        <msub>
         <mi>α</mi>
         <mi>K</mi>
        </msub>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mtd>
   </mtr>
  </mtable>
  <annotation-xml encoding="MathML-Content">
   <matrix>
    <matrixrow>
     <ci>𝐜</ci>
     <eq></eq>
     <vector>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>c</ci>
       <cn type="integer">1</cn>
      </apply>
      <ci>normal-…</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>c</ci>
       <ci>K</ci>
      </apply>
     </vector>
     <eq></eq>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <mtext>number of occurrences of category</mtext>
      <csymbol cd="unknown">i</csymbol>
      <eq></eq>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <apply>
         <eq></eq>
         <ci>j</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <ci>N</ci>
      </apply>
      <cerror>
       <csymbol cd="ambiguous">fragments</csymbol>
       <ci>normal-[</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <ci>j</ci>
       </apply>
       <eq></eq>
       <csymbol cd="unknown">i</csymbol>
       <ci>normal-]</ci>
      </cerror>
     </cerror>
    </matrixrow>
    <matrixrow>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <csymbol cd="unknown">p</csymbol>
      <ci>normal-∣</ci>
      <csymbol cd="unknown">X</csymbol>
      <ci>normal-,</ci>
      <csymbol cd="unknown">α</csymbol>
     </cerror>
     <csymbol cd="latexml">similar-to</csymbol>
     <apply>
      <ci>Dir</ci>
      <ci>K</ci>
      <apply>
       <plus></plus>
       <ci>𝐜</ci>
       <ci>𝜶</ci>
      </apply>
     </apply>
     <eq></eq>
     <apply>
      <ci>Dir</ci>
      <ci>K</ci>
      <apply>
       <plus></plus>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>c</ci>
        <cn type="integer">1</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>α</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <ci>normal-…</ci>
      <apply>
       <plus></plus>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>c</ci>
        <ci>K</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>α</ci>
        <ci>K</ci>
       </apply>
      </apply>
     </apply>
    </matrixrow>
   </matrix>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \begin{array}[]{lclcl}\mathbf{c}&=&(c_{1},\ldots,c_{K})&=&\text{number of %
occurrences of category }i=\sum_{j=1}^{N}[x_{j}=i]\\
\mathbf{p}\mid\mathbb{X},\boldsymbol{\alpha}&\sim&\operatorname{Dir}(K,\mathbf%
{c}+\boldsymbol{\alpha})&=&\operatorname{Dir}(K,c_{1}+\alpha_{1},\ldots,c_{K}+%
\alpha_{K})\end{array}
  </annotation>
 </semantics>
</math>

</p>

<p>This relationship is used in <a href="Bayesian_statistics" title="wikilink">Bayesian statistics</a> to estimate the underlying parameter <strong>p</strong> of a categorical distribution given a collection of <em>N</em> samples. Intuitively, we can view the <a class="uri" href="hyperprior" title="wikilink">hyperprior</a> vector <strong>α</strong> as <a href="pseudocount" title="wikilink">pseudocounts</a>, i.e. as representing the number of observations in each category that we have already seen. Then we simply add in the counts for all the new observations (the vector <strong>c</strong>) in order to derive the posterior distribution.</p>

<p>Further intuition comes from the <a href="expected_value" title="wikilink">expected value</a> of the posterior distribution (see the article on the <a href="Dirichlet_distribution" title="wikilink">Dirichlet distribution</a>):</p>

<p>

<math display="block" id="Categorical_distribution:35">
 <semantics>
  <mrow>
   <mi>𝔼</mi>
   <mrow>
    <mo stretchy="false">[</mo>
    <msub>
     <mi>p</mi>
     <mi>i</mi>
    </msub>
    <mo>∣</mo>
    <mi>𝕏</mi>
    <mo>,</mo>
    <mi>𝜶</mi>
    <mo stretchy="false">]</mo>
   </mrow>
   <mo>=</mo>
   <mfrac>
    <mrow>
     <msub>
      <mi>c</mi>
      <mi>i</mi>
     </msub>
     <mo>+</mo>
     <msub>
      <mi>α</mi>
      <mi>i</mi>
     </msub>
    </mrow>
    <mrow>
     <mi>N</mi>
     <mo>+</mo>
     <mrow>
      <msub>
       <mo largeop="true" symmetric="true">∑</mo>
       <mi>k</mi>
      </msub>
      <msub>
       <mi>α</mi>
       <mi>k</mi>
      </msub>
     </mrow>
    </mrow>
   </mfrac>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">E</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-[</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>p</ci>
      <ci>i</ci>
     </apply>
     <ci>normal-∣</ci>
     <csymbol cd="unknown">X</csymbol>
     <ci>normal-,</ci>
     <csymbol cd="unknown">α</csymbol>
     <ci>normal-]</ci>
    </cerror>
    <eq></eq>
    <apply>
     <divide></divide>
     <apply>
      <plus></plus>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>c</ci>
       <ci>i</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>α</ci>
       <ci>i</ci>
      </apply>
     </apply>
     <apply>
      <plus></plus>
      <ci>N</ci>
      <apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <ci>k</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>α</ci>
        <ci>k</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbb{E}[p_{i}\mid\mathbb{X},\boldsymbol{\alpha}]=\frac{c_{i}+\alpha_{i}}{N+%
\sum_{k}\alpha_{k}}
  </annotation>
 </semantics>
</math>

</p>

<p>This says that the expected probability of seeing a category <em>i</em> among the various discrete distributions generated by the posterior distribution is simply equal to the proportion of occurrences of that category actually seen in the data, including the pseudocounts in the prior distribution. This makes a great deal of intuitive sense: If, for example, there are three possible categories, and we saw category 1 in our observed data 40% of the time, we would expect on average to see category 1 40% of the time in the posterior distribution as well.</p>

<p>(Note that this intuition is ignoring the effect of the prior distribution. Furthermore, it's important to keep in mind that the posterior is a <em>distribution over distributions</em>. Remember that the posterior distribution in general tells us what we know about the parameter in question, and in this case the parameter itself is a discrete probability distribution, i.e. the actual categorical distribution that generated our data. For example, if we saw the 3 categories in the ratio 40:5:55 in our observed data, then ignoring the effect of the prior distribution, we would expect the true parameter — i.e. the true, underlying distribution that generated our observed data — to have the average value of (0.40,0.05,0.55), which is indeed what the posterior tells us. However, the true distribution might actually be (0.35,0.07,0.58) or (0.42,0.04,0.54) or various other nearby possibilities. The amount of uncertainty involved here is specified by the variance of the posterior, which is controlled by the total number of observations – the more data we observe, the less our uncertainty about the true parameter.)</p>

<p>(Technically, the prior parameter 

<math display="inline" id="Categorical_distribution:36">
 <semantics>
  <msub>
   <mi>α</mi>
   <mi>i</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>α</ci>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \alpha_{i}
  </annotation>
 </semantics>
</math>

 should actually be seen as representing 

<math display="inline" id="Categorical_distribution:37">
 <semantics>
  <mrow>
   <msub>
    <mi>α</mi>
    <mi>i</mi>
   </msub>
   <mo>-</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <minus></minus>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>α</ci>
     <ci>i</ci>
    </apply>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \alpha_{i}-1
  </annotation>
 </semantics>
</math>

 prior observations of category 

<math display="inline" id="Categorical_distribution:38">
 <semantics>
  <mi>i</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>i</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   i
  </annotation>
 </semantics>
</math>

. Then, the updated posterior parameter 

<math display="inline" id="Categorical_distribution:39">
 <semantics>
  <mrow>
   <msub>
    <mi>c</mi>
    <mi>i</mi>
   </msub>
   <mo>+</mo>
   <msub>
    <mi>α</mi>
    <mi>i</mi>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <plus></plus>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>c</ci>
     <ci>i</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>α</ci>
     <ci>i</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   c_{i}+\alpha_{i}
  </annotation>
 </semantics>
</math>

 represents 

<math display="inline" id="Categorical_distribution:40">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>c</mi>
     <mi>i</mi>
    </msub>
    <mo>+</mo>
    <msub>
     <mi>α</mi>
     <mi>i</mi>
    </msub>
   </mrow>
   <mo>-</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <minus></minus>
    <apply>
     <plus></plus>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>c</ci>
      <ci>i</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>α</ci>
      <ci>i</ci>
     </apply>
    </apply>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   c_{i}+\alpha_{i}-1
  </annotation>
 </semantics>
</math>

 posterior observations. This reflects the fact that a Dirichlet distribution with 

<math display="inline" id="Categorical_distribution:41">
 <semantics>
  <mrow>
   <mi>𝜶</mi>
   <mo>=</mo>
   <mrow>
    <mo stretchy="false">(</mo>
    <mn>1</mn>
    <mo>,</mo>
    <mn>1</mn>
    <mo>,</mo>
    <mi mathvariant="normal">…</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>𝜶</ci>
    <vector>
     <cn type="integer">1</cn>
     <cn type="integer">1</cn>
     <ci>normal-…</ci>
    </vector>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \boldsymbol{\alpha}=(1,1,\ldots)
  </annotation>
 </semantics>
</math>

 has a completely flat shape — essentially, a <a href="uniform_distribution_(continuous)" title="wikilink">uniform distribution</a> over the <a class="uri" href="simplex" title="wikilink">simplex</a> of possible values of <strong>p</strong>. Logically, a flat distribution of this sort represents total ignorance, corresponding to no observations of any sort. However, the mathematical updating of the posterior works fine if we ignore the 

<math display="inline" id="Categorical_distribution:42">
 <semantics>
  <mrow>
   <mi mathvariant="normal">…</mi>
   <mo>-</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <minus></minus>
    <ci>normal-…</ci>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \dots-1
  </annotation>
 </semantics>
</math>

 term and simply think of the <strong>α</strong> vector as directly representing a set of pseudocounts. Furthermore, doing this avoids the issue of interpreting 

<math display="inline" id="Categorical_distribution:43">
 <semantics>
  <msub>
   <mi>α</mi>
   <mi>i</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>α</ci>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \alpha_{i}
  </annotation>
 </semantics>
</math>

 values less than 1.)</p>
<h3 id="map-estimation">MAP Estimation</h3>

<p>The maximum-a-posteriori estimate of the parameter <strong>p</strong> in the above model is simply the <a href="Dirichlet_distribution#Mode" title="wikilink">mode of the posterior Dirichlet distribution</a>, i.e.,<a class="footnoteRef" href="#fn10" id="fnref10"><sup>10</sup></a></p>

<p>

<math display="block" id="Categorical_distribution:44">
 <semantics>
  <mrow>
   <mi>arg</mi>
   <munder>
    <mi>max</mi>
    <mi>𝐩</mi>
   </munder>
   <mi>p</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>𝐩</mi>
    <mo stretchy="false">|</mo>
    <mi>𝕏</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>=</mo>
   <mfrac>
    <mrow>
     <mrow>
      <msub>
       <mi>α</mi>
       <mi>i</mi>
      </msub>
      <mo>+</mo>
      <msub>
       <mi>c</mi>
       <mi>i</mi>
      </msub>
     </mrow>
     <mo>-</mo>
     <mn>1</mn>
    </mrow>
    <mrow>
     <msub>
      <mo largeop="true" symmetric="true">∑</mo>
      <mi>i</mi>
     </msub>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mrow>
        <msub>
         <mi>α</mi>
         <mi>i</mi>
        </msub>
        <mo>+</mo>
        <msub>
         <mi>c</mi>
         <mi>i</mi>
        </msub>
       </mrow>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mfrac>
   <mo rspace="22.5pt">,</mo>
   <mo>∀</mo>
   <mpadded width="+2.8pt">
    <mi>i</mi>
   </mpadded>
   <msub>
    <mi>α</mi>
    <mi>i</mi>
   </msub>
   <mo>+</mo>
   <msub>
    <mi>c</mi>
    <mi>i</mi>
   </msub>
   <mo>></mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <arg></arg>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <max></max>
     <ci>𝐩</ci>
    </apply>
    <csymbol cd="unknown">p</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">p</csymbol>
     <ci>normal-|</ci>
     <csymbol cd="unknown">X</csymbol>
     <ci>normal-)</ci>
    </cerror>
    <eq></eq>
    <apply>
     <divide></divide>
     <apply>
      <minus></minus>
      <apply>
       <plus></plus>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>α</ci>
        <ci>i</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>c</ci>
        <ci>i</ci>
       </apply>
      </apply>
      <cn type="integer">1</cn>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <ci>i</ci>
      </apply>
      <apply>
       <minus></minus>
       <apply>
        <plus></plus>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>α</ci>
         <ci>i</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>c</ci>
         <ci>i</ci>
        </apply>
       </apply>
       <cn type="integer">1</cn>
      </apply>
     </apply>
    </apply>
    <ci>normal-,</ci>
    <csymbol cd="latexml">for-all</csymbol>
    <csymbol cd="unknown">i</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>α</ci>
     <ci>i</ci>
    </apply>
    <plus></plus>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>c</ci>
     <ci>i</ci>
    </apply>
    <gt></gt>
    <cn type="integer">1</cn>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \arg\max_{\mathbf{p}}p(\mathbf{p}|\mathbb{X})=\frac{\alpha_{i}+c_{i}-1}{\sum_{%
i}(\alpha_{i}+c_{i}-1)},\qquad\forall i\;\alpha_{i}+c_{i}>1
  </annotation>
 </semantics>
</math>

 In many practical applications, the only way to guarantee the condition that 

<math display="inline" id="Categorical_distribution:45">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mo>∀</mo>
     <mrow>
      <mpadded width="+2.8pt">
       <mi>i</mi>
      </mpadded>
      <msub>
       <mi>α</mi>
       <mi>i</mi>
      </msub>
     </mrow>
    </mrow>
    <mo>+</mo>
    <msub>
     <mi>c</mi>
     <mi>i</mi>
    </msub>
   </mrow>
   <mo>></mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <gt></gt>
    <apply>
     <plus></plus>
     <apply>
      <csymbol cd="latexml">for-all</csymbol>
      <apply>
       <times></times>
       <ci>i</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>α</ci>
        <ci>i</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>c</ci>
      <ci>i</ci>
     </apply>
    </apply>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \forall i\;\alpha_{i}+c_{i}>1
  </annotation>
 </semantics>
</math>

 is to set 

<math display="inline" id="Categorical_distribution:46">
 <semantics>
  <mrow>
   <msub>
    <mi>α</mi>
    <mi>i</mi>
   </msub>
   <mo>></mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <gt></gt>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>α</ci>
     <ci>i</ci>
    </apply>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \alpha_{i}>1
  </annotation>
 </semantics>
</math>

 for all <em>i</em>.</p>
<h3 id="marginal-likelihood">Marginal likelihood</h3>

<p>In the above model, the <a href="marginal_likelihood" title="wikilink">marginal likelihood</a> of the observations (i.e. the <a href="joint_distribution" title="wikilink">joint distribution</a> of the observations, with the prior parameter <a href="marginal_distribution" title="wikilink">marginalized out</a>) is a <a href="Dirichlet-multinomial_distribution" title="wikilink">Dirichlet-multinomial distribution</a>:<a class="footnoteRef" href="#fn11" id="fnref11"><sup>11</sup></a></p>

<p>

<math display="inline" id="Categorical_distribution:47">
 <semantics>
  <mrow>
   <mi>p</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>𝕏</mi>
    <mo>∣</mo>
    <mi>𝜶</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">p</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">X</csymbol>
     <ci>normal-∣</ci>
     <csymbol cd="unknown">α</csymbol>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle p(\mathbb{X}\mid\boldsymbol{\alpha})
  </annotation>
 </semantics>
</math>


</p>

<p>This distribution plays an important role in <a href="hierarchical_Bayesian_model" title="wikilink">hierarchical Bayesian models</a>, because when doing <a href="statistical_inference" title="wikilink">inference</a> over such models using methods such as <a href="Gibbs_sampling" title="wikilink">Gibbs sampling</a> or <a href="variational_Bayes" title="wikilink">variational Bayes</a>, Dirichlet prior distributions are often marginalized out. See the <a href="Dirichlet-multinomial_distribution" title="wikilink">article on this distribution</a> for more details.</p>
<h3 id="posterior-predictive-distribution">Posterior predictive distribution</h3>

<p>The <a href="posterior_predictive_distribution" title="wikilink">posterior predictive distribution</a> of a new observation in the above model is the distribution that a new observation 

<math display="inline" id="Categorical_distribution:48">
 <semantics>
  <mover accent="true">
   <mi>x</mi>
   <mo stretchy="false">~</mo>
  </mover>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-~</ci>
    <ci>x</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \tilde{x}
  </annotation>
 </semantics>
</math>

 would take given the set 

<math display="inline" id="Categorical_distribution:49">
 <semantics>
  <mi>𝕏</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>𝕏</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbb{X}
  </annotation>
 </semantics>
</math>

 of <em>N</em> categorical observations. As shown in the <a href="Dirichlet-multinomial_distribution" title="wikilink">Dirichlet-multinomial distribution</a> article, it has a very simple form:<a class="footnoteRef" href="#fn12" id="fnref12"><sup>12</sup></a></p>

<p>

<math display="inline" id="Categorical_distribution:50">
 <semantics>
  <mrow>
   <mi>p</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mover accent="true">
     <mi>x</mi>
     <mo stretchy="false">~</mo>
    </mover>
    <mo>=</mo>
    <mi>i</mi>
    <mo>∣</mo>
    <mi>𝕏</mi>
    <mo>,</mo>
    <mi>𝜶</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">p</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <ci>normal-~</ci>
      <ci>x</ci>
     </apply>
     <eq></eq>
     <csymbol cd="unknown">i</csymbol>
     <ci>normal-∣</ci>
     <csymbol cd="unknown">X</csymbol>
     <ci>normal-,</ci>
     <csymbol cd="unknown">α</csymbol>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle p(\tilde{x}=i\mid\mathbb{X},\boldsymbol{\alpha})
  </annotation>
 </semantics>
</math>


</p>

<p>Note the various relationships among this formula and the previous ones:</p>
<ul>
<li>The posterior predictive probability of seeing a particular category is the same as the relative proportion of previous observations in that category (including the pseudo-observations of the prior). This makes logical sense — intuitively, we would expect to see a particular category according to the frequency already observed of that category.</li>
<li>The posterior predictive probability is the same as the <a href="expected_value" title="wikilink">expected value</a> of the posterior distribution. This is explained more below.</li>
<li>As a result, this formula can be expressed as simply "the posterior predictive probability of seeing a category is proportional to the total observed count of that category", or as "the <em>expected count</em> of a category is the same as the total observed count of the category", where "observed count" is taken to include the pseudo-observations of the prior.</li>
</ul>

<p>The reason for the equivalence between posterior predictive probability and the expected value of the posterior distribution of <strong>p</strong> is evident once we re-examine the above formula. As explained in the <a href="posterior_predictive_distribution" title="wikilink">posterior predictive distribution</a> article, the formula for the posterior predictive probability has the form of an expected value taken with respect to the posterior distribution:</p>

<p>

<math display="inline" id="Categorical_distribution:51">
 <semantics>
  <mrow>
   <mi>p</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mover accent="true">
     <mi>x</mi>
     <mo stretchy="false">~</mo>
    </mover>
    <mo>=</mo>
    <mi>i</mi>
    <mo>∣</mo>
    <mi>𝕏</mi>
    <mo>,</mo>
    <mi>𝜶</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">p</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <ci>normal-~</ci>
      <ci>x</ci>
     </apply>
     <eq></eq>
     <csymbol cd="unknown">i</csymbol>
     <ci>normal-∣</ci>
     <csymbol cd="unknown">X</csymbol>
     <ci>normal-,</ci>
     <csymbol cd="unknown">α</csymbol>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle p(\tilde{x}=i\mid\mathbb{X},\boldsymbol{\alpha})
  </annotation>
 </semantics>
</math>


</p>

<p>The crucial line above is the third. The second follows directly from the definition of expected value. The third line is particular to the categorical distribution, and follows from the fact that, in the categorical distribution specifically, the expected value of seeing a particular value <em>i</em> is directly specified by the associated parameter <em>p<sub>i</sub></em>. The fourth line is simply a rewriting of the third in a different notation, using the notation farther up for an expectation taken with respect to the posterior distribution of the parameters.</p>

<p>Note also what happens in a scenario in which we observe data points one by one and each time consider their predictive probability before observing the data point and updating the posterior. For any given data point, the probability of that point assuming a given category depends on the number of data points already in that category. If a category has a high frequency of occurrence, then new data points are more likely to join that category — further enriching the same category. This type of scenario is often termed a <a href="preferential_attachment" title="wikilink">preferential attachment</a> (or "rich get richer") model. This models many real-world processes, and in such cases the choices made by the first few data points have an outsize influence on the rest of the data points.</p>
<h3 id="posterior-conditional-distribution">Posterior conditional distribution</h3>

<p>In <a href="Gibbs_sampling" title="wikilink">Gibbs sampling</a>, we typically need to draw from <a href="conditional_distribution" title="wikilink">conditional distributions</a> in multi-variable <a href="Bayes_network" title="wikilink">Bayes networks</a> where each variable is conditioned on all the others. In networks that include categorical variables with <a href="Dirichlet_distribution" title="wikilink">Dirichlet</a> priors (e.g. <a href="mixture_model" title="wikilink">mixture models</a> and models including mixture components), the Dirichlet distributions are often "collapsed out" (<a href="marginal_distribution" title="wikilink">marginalized out</a>) of the network, which introduces dependencies among the various categorical nodes dependent on a given prior (specifically, their <a href="joint_distribution" title="wikilink">joint distribution</a> is a <a href="Dirichlet-multinomial_distribution" title="wikilink">Dirichlet-multinomial distribution</a>). One of the reasons for doing this is that in such a case, the distribution of one categorical node given the others is exactly the <a href="posterior_predictive_distribution" title="wikilink">posterior predictive distribution</a> of the remaining nodes.</p>

<p>That is, for a set of nodes 

<math display="inline" id="Categorical_distribution:52">
 <semantics>
  <mi>𝕏</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>𝕏</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbb{X}
  </annotation>
 </semantics>
</math>

, if we denote the node in question as 

<math display="inline" id="Categorical_distribution:53">
 <semantics>
  <msub>
   <mi>x</mi>
   <mi>n</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>x</ci>
    <ci>n</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x_{n}
  </annotation>
 </semantics>
</math>

 and the remainder as 

<math display="inline" id="Categorical_distribution:54">
 <semantics>
  <msup>
   <mi>𝕏</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mrow>
     <mo>-</mo>
     <mi>n</mi>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>𝕏</ci>
    <apply>
     <minus></minus>
     <ci>n</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbb{X}^{(-n)}
  </annotation>
 </semantics>
</math>

, then</p>

<p>

<math display="inline" id="Categorical_distribution:55">
 <semantics>
  <mrow>
   <mi>p</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>x</mi>
     <mi>n</mi>
    </msub>
    <mo>=</mo>
    <mi>i</mi>
    <mo>∣</mo>
    <msup>
     <mi>𝕏</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mo>-</mo>
       <mi>n</mi>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </msup>
    <mo>,</mo>
    <mi>𝜶</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">p</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <ci>n</ci>
     </apply>
     <eq></eq>
     <csymbol cd="unknown">i</csymbol>
     <ci>normal-∣</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>𝕏</ci>
      <apply>
       <minus></minus>
       <ci>n</ci>
      </apply>
     </apply>
     <ci>normal-,</ci>
     <csymbol cd="unknown">α</csymbol>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle p(x_{n}=i\mid\mathbb{X}^{(-n)},\boldsymbol{\alpha})
  </annotation>
 </semantics>
</math>


</p>

<p>where 

<math display="inline" id="Categorical_distribution:56">
 <semantics>
  <msubsup>
   <mi>c</mi>
   <mi>i</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mrow>
     <mo>-</mo>
     <mi>n</mi>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
  </msubsup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>c</ci>
     <ci>i</ci>
    </apply>
    <apply>
     <minus></minus>
     <ci>n</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   c_{i}^{(-n)}
  </annotation>
 </semantics>
</math>

 is the number of nodes having category <em>i</em> among the nodes other than node <em>n</em>.</p>
<h2 id="sampling">Sampling</h2>

<p>The most common way to sample from a categorical distribution uses a type of <a href="inverse_transform_sampling" title="wikilink">inverse transform sampling</a>:</p>

<p>Assume we are given a distribution expressed as "proportional to" some expression, with unknown <a href="normalizing_constant" title="wikilink">normalizing constant</a>. Then, before taking any samples, we prepare some values as follows:</p>
<ol>
<li>Compute the unnormalized value of the distribution for each category.</li>
<li>Sum them up and divide each value by this sum, in order to <a href="normalizing_constant" title="wikilink">normalize</a> them.</li>
<li>Impose some sort of order on the categories (e.g. by an index that runs from 1 to <em>k</em>, where <em>k</em> is the number of categories).</li>
<li>Convert the values to a <a href="cumulative_distribution_function" title="wikilink">cumulative distribution function</a> (CDF) by replacing each value with the sum of all of the previous values. This can be done in time <em>O(k)</em>. The resulting value for the first category will be 0.</li>
</ol>

<p>Then, each time it is necessary to sample a value:</p>
<ol>
<li>Pick a <a href="uniform_distribution_(continuous)" title="wikilink">uniformly distributed</a> number between 0 and 1.</li>
<li>Locate the greatest number in the CDF whose value is less than or equal to the number just chosen. This can be done in time <em>O(log(k))</em>, by <a href="binary_search" title="wikilink">binary search</a>.</li>
<li>Return the category corresponding to this CDF value.</li>
</ol>

<p>If it is necessary to draw many values from the same categorical distribution, the following approach is more efficient. It draws n samples in O(n) time (assuming an O(1) approximation is used to draw values from the binomial distribution<a class="footnoteRef" href="#fn13" id="fnref13"><sup>13</sup></a>).</p>
<pre><code>function draw_categorical(n) // where n is the number of samples to draw from the categorical distribution
  r = 1
  s = 0
  for i from 1 to k // where k is the number of categories
    v = draw from a binomial(n, p[i] / r) distribution // where p[i] is the probability of category i
    for j from 1 to v
      z[s++] = i // where z is an array in which the results are stored
    n = n - v
    r = r - p[i]
  shuffle (randomly re-order) the elements in z
  return z</code></pre>
<h3 id="sampling-via-the-gumbel-distribution">Sampling via the Gumbel distribution</h3>

<p>In <a href="machine_learning" title="wikilink">machine learning</a> it is typical to parametrize the categorical distribution, 

<math display="inline" id="Categorical_distribution:57">
 <semantics>
  <mrow>
   <msub>
    <mi>p</mi>
    <mn>1</mn>
   </msub>
   <mo>,</mo>
   <mi mathvariant="normal">…</mi>
   <mo>,</mo>
   <msub>
    <mi>p</mi>
    <mi>k</mi>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <list>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>p</ci>
     <cn type="integer">1</cn>
    </apply>
    <ci>normal-…</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>p</ci>
     <ci>k</ci>
    </apply>
   </list>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p_{1},\ldots,p_{k}
  </annotation>
 </semantics>
</math>

 via an unconstrained representation in 

<math display="inline" id="Categorical_distribution:58">
 <semantics>
  <msup>
   <mi>ℝ</mi>
   <mi>k</mi>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>ℝ</ci>
    <ci>k</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbb{R}^{k}
  </annotation>
 </semantics>
</math>

, whose components are given by:</p>

<p>

<math display="block" id="Categorical_distribution:59">
 <semantics>
  <mrow>
   <msub>
    <mi>γ</mi>
    <mi>i</mi>
   </msub>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mi>log</mi>
     <msub>
      <mi>p</mi>
      <mi>i</mi>
     </msub>
    </mrow>
    <mo>+</mo>
    <mi>α</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>γ</ci>
     <ci>i</ci>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <log></log>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>p</ci>
       <ci>i</ci>
      </apply>
     </apply>
     <ci>α</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \gamma_{i}=\log p_{i}+\alpha
  </annotation>
 </semantics>
</math>

 where 

<math display="inline" id="Categorical_distribution:60">
 <semantics>
  <mi>α</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>α</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \alpha
  </annotation>
 </semantics>
</math>

 is any real constant. Given this representation, 

<math display="inline" id="Categorical_distribution:61">
 <semantics>
  <mrow>
   <msub>
    <mi>p</mi>
    <mn>1</mn>
   </msub>
   <mo>,</mo>
   <mi mathvariant="normal">…</mi>
   <mo>,</mo>
   <msub>
    <mi>p</mi>
    <mi>k</mi>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <list>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>p</ci>
     <cn type="integer">1</cn>
    </apply>
    <ci>normal-…</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>p</ci>
     <ci>k</ci>
    </apply>
   </list>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p_{1},\ldots,p_{k}
  </annotation>
 </semantics>
</math>

 can be recovered using the <a href="softmax_function" title="wikilink">softmax function</a>, which can then be sampled using the techniques described above. There is however a more direct sampling method that uses samples from the <a href="Gumbel_distribution" title="wikilink">Gumbel distribution</a>.<a class="footnoteRef" href="#fn14" id="fnref14"><sup>14</sup></a> Let 

<math display="inline" id="Categorical_distribution:62">
 <semantics>
  <mrow>
   <msub>
    <mi>g</mi>
    <mn>1</mn>
   </msub>
   <mo>,</mo>
   <mi mathvariant="normal">…</mi>
   <mo>,</mo>
   <msub>
    <mi>g</mi>
    <mi>k</mi>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <list>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>g</ci>
     <cn type="integer">1</cn>
    </apply>
    <ci>normal-…</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>g</ci>
     <ci>k</ci>
    </apply>
   </list>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   g_{1},\ldots,g_{k}
  </annotation>
 </semantics>
</math>

 be <em>k</em> independent draws from the standard Gumbel distribution, then</p>

<p>

<math display="block" id="Categorical_distribution:63">
 <semantics>
  <mrow>
   <mi>c</mi>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mi>arg</mi>
     <mrow>
      <munder>
       <mi>max</mi>
       <mi>i</mi>
      </munder>
      <msub>
       <mi>γ</mi>
       <mi>i</mi>
      </msub>
     </mrow>
    </mrow>
    <mo>+</mo>
    <msub>
     <mi>g</mi>
     <mi>i</mi>
    </msub>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>c</ci>
    <apply>
     <plus></plus>
     <apply>
      <arg></arg>
      <apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <max></max>
        <ci>i</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>γ</ci>
        <ci>i</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>g</ci>
      <ci>i</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   c=\arg\max_{i}\gamma_{i}+g_{i}
  </annotation>
 </semantics>
</math>

 will be a sample from the desired categorical distribution. (If 

<math display="inline" id="Categorical_distribution:64">
 <semantics>
  <msub>
   <mi>u</mi>
   <mi>i</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>u</ci>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   u_{i}
  </annotation>
 </semantics>
</math>


 is a sample from the standard <a href="uniform_distribution_(continuous)" title="wikilink">uniform distribution</a>, then 

<math display="inline" id="Categorical_distribution:65">
 <semantics>
  <mrow>
   <msub>
    <mi>g</mi>
    <mi>i</mi>
   </msub>
   <mo>=</mo>
   <mrow>
    <mo>-</mo>
    <mrow>
     <mi>log</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mo>-</mo>
       <mrow>
        <mi>log</mi>
        <msub>
         <mi>u</mi>
         <mi>i</mi>
        </msub>
       </mrow>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>g</ci>
     <ci>i</ci>
    </apply>
    <apply>
     <minus></minus>
     <apply>
      <log></log>
      <apply>
       <minus></minus>
       <apply>
        <log></log>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>u</ci>
         <ci>i</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   g_{i}=-\log(-\log u_{i})
  </annotation>
 </semantics>
</math>

 is a sample from the standard Gumbel distribution.)</p>
<h2 id="see-also">See also</h2>
<ul>
<li><a href="Categorical_data" title="wikilink">Categorical data</a></li>
<li><a href="Categorical_variable" title="wikilink">Categorical variable</a></li>
</ul>
<h3 id="related-distributions">Related distributions</h3>
<ul>
<li><a href="Dirichlet_distribution" title="wikilink">Dirichlet distribution</a></li>
<li><a href="Multinomial_distribution" title="wikilink">Multinomial distribution</a></li>
<li><a href="Bernoulli_distribution" title="wikilink">Bernoulli distribution</a></li>
<li><a href="Dirichlet-multinomial_distribution" title="wikilink">Dirichlet-multinomial distribution</a></li>
</ul>
<h2 id="notes">Notes</h2>
<references group="nb">
</references>
<h2 id="references">References</h2>

<p>"</p>

<p><a href="Category:Categorical_data" title="wikilink">Category:Categorical data</a> <a href="Category:Discrete_distributions" title="wikilink">Category:Discrete distributions</a> <a href="Category:Exponential_family_distributions" title="wikilink">Category:Exponential family distributions</a> <a href="Category:Probability_distributions" title="wikilink">Category:Probability distributions</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1">Murphy, K. P. (2012). <em>Machine learning: a probabilistic perspective</em>, p. 35. MIT press. ISBN 0262018020.<a href="#fnref1">↩</a></li>
<li id="fn2">Minka, T. (2003) <a href="http://research.microsoft.com/en-us/um/people/minka/papers/multinomial.html">Bayesian inference, entropy and the multinomial distribution</a>. Technical report Microsoft Research.<a href="#fnref2">↩</a></li>
<li id="fn3">Minka, T. (2003), op. cit. Minka uses the <a href="Kronecker_delta" title="wikilink">Kronecker delta</a> function, similar to but less general than the <a href="Iverson_bracket" title="wikilink">Iverson bracket</a>.<a href="#fnref3">↩</a></li>
<li id="fn4"></li>
<li id="fn5">Bishop, C. (2006) <em>Pattern Recognition and Machine Learning</em>, Springer. ISBN 0-387-31073-8<a href="#fnref5">↩</a></li>
<li id="fn6">However, Bishop does not explicitly use the term categorical distribution.<a href="#fnref6">↩</a></li>
<li id="fn7">Johnson, N.L., Kotz, S., Balakrishnan, N. (1997) <em>Discrete Multivariate Distributions</em>, Wiley. ISBN 0-471-12844-9 (p.105)<a href="#fnref7">↩</a></li>
<li id="fn8"></li>
<li id="fn9"></li>
<li id="fn10"></li>
<li id="fn11"></li>
<li id="fn12"></li>
<li id="fn13">Agresti, A., An Introduction to Categorical Data Analysis, Wiley-Interscience, 2007, ISBN 978-0-471-22618-5, pp. 25<a href="#fnref13">↩</a></li>
<li id="fn14"><a href="#fnref14">↩</a></li>
</ol>
</section>
</body>
</html>

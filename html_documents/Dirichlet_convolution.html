<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="732">Dirichlet convolution</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Dirichlet convolution</h1>
<hr/>

<p>In <a class="uri" href="mathematics" title="wikilink">mathematics</a>, the <strong>Dirichlet convolution</strong> is a <a href="binary_operation" title="wikilink">binary operation</a> defined for <a href="arithmetic_function" title="wikilink">arithmetic functions</a>; it is important in <a href="number_theory" title="wikilink">number theory</a>. It was developed by <a href="Peter_Gustav_Lejeune_Dirichlet" title="wikilink">Peter Gustav Lejeune Dirichlet</a>, a German mathematician.</p>
<h2 id="definition">Definition</h2>

<p>If <em>f</em> and <em>g</em> are two arithmetic functions (i.e. functions from the positive <a href="integer" title="wikilink">integers</a> to the <a href="complex_number" title="wikilink">complex numbers</a>), one defines a new arithmetic function , the <em>Dirichlet convolution</em> of <em>f</em> and <em>g</em>, by</p>

<p>

<math display="inline" id="Dirichlet_convolution:0">
 <semantics>
  <mrow>
   <mrow>
    <mo stretchy="false">(</mo>
    <mrow>
     <mi>f</mi>
     <mo>*</mo>
     <mi>g</mi>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>n</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <times></times>
     <ci>f</ci>
     <ci>g</ci>
    </apply>
    <ci>n</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle(f*g)(n)
  </annotation>
 </semantics>
</math>


</p>

<p>where the sum extends over all positive <a href="divisor" title="wikilink">divisors</a> <em>d</em> of <em>n</em>, or equivalently over all distinct pairs  of positive integers whose product is <em>n</em>.</p>
<h2 id="properties">Properties</h2>

<p>The set of arithmetic functions forms a <a href="commutative_ring" title="wikilink">commutative ring</a>, the <strong></strong>, under <a href="pointwise_addition" title="wikilink">pointwise addition</a> (i.e.  is defined by ) and Dirichlet convolution. The multiplicative identity is the <a href="unit_function" title="wikilink">unit function</a> <em>ε</em> defined by  if  and  if . The <a href="unit_(ring_theory)" title="wikilink">units</a> (i.e. invertible elements) of this ring are the arithmetic functions <em>f</em> with .</p>

<p>Specifically, Dirichlet convolution is<a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a> <a href="associativity" title="wikilink">associative</a>,</p>
<dl>
<dd>(<em>f</em> ∗ <em>g</em>) ∗ <em>h</em> = <em>f</em> ∗ (<em>g</em> ∗ <em>h</em>),
</dd>
</dl>

<p><a href="distributivity" title="wikilink">distributes</a> over addition</p>
<dl>
<dd><em>f</em> ∗ (<em>g</em> + <em>h</em>) = <em>f</em> ∗ <em>g</em> + <em>f</em> ∗ <em>h</em> = (<em>g</em> + <em>h</em>) ∗ <em>f</em>,
</dd>
</dl>

<p>is <a href="commutativity" title="wikilink">commutative</a>,</p>
<dl>
<dd><em>f</em> ∗ <em>g</em> = <em>g</em> ∗ <em>f</em>,
</dd>
</dl>

<p>and has an identity element,</p>
<dl>
<dd><em>f</em> ∗ <em>ε</em> = <em>ε</em> ∗ <em>f</em> = <em>f</em>.
</dd>
</dl>

<p>Furthermore, for each <em>f</em> for which  there exists a <em>g</em> such that , called the <strong></strong> of <em>f</em>.</p>

<p>The Dirichlet convolution of two <a href="multiplicative_function" title="wikilink">multiplicative functions</a> is again multiplicative, and every multiplicative function has a Dirichlet inverse that is also multiplicative. The article on multiplicative functions lists several convolution relations among important multiplicative functions.</p>

<p>Given a <a href="completely_multiplicative_function" title="wikilink">completely multiplicative function</a> <em>f</em>, then , where juxtaposition represents pointwise multiplication.<a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a> The convolution of two completely multiplicative functions is <em>a fortiori</em> multiplicative, but not necessarily completely multiplicative.</p>
<h2 id="examples">Examples</h2>

<p>In these formulas</p>
<dl>
<dd><em>ε</em> is the multiplicative identity. (I.e. , all other values 0.)
</dd>
<dd>1 is the constant function whose value is 1 for all <em>n</em>. (I.e. .) Keep in mind that 1 is not the identity.
</dd>
<dd>1<sub><em>C</em></sub>, where 

<math display="inline" id="Dirichlet_convolution:1">
 <semantics>
  <mrow>
   <mi>C</mi>
   <mo>⊂</mo>
   <mi>ℤ</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <subset></subset>
    <ci>C</ci>
    <ci>ℤ</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \scriptstyle C\subset\mathbb{Z}
  </annotation>
 </semantics>
</math>

 is a set is the <a href="indicator_function" title="wikilink">indicator function</a>. (I.e. <mtpl></mtpl> if , 0 otherwise.)
</dd>
<dd>Id is the identity function whose value is <em>n</em>. (I.e. .)
</dd>
<dd>Id<sub><em>k</em></sub> is the <em>k</em>th power function. (I.e. <mtpl></mtpl>.)
</dd>
</dl>
<dl>
<dd>The other functions are defined in the article <a href="arithmetical_function" title="wikilink">arithmetical function</a>.
</dd>
</dl>
<ul>
<li>1 ∗ μ = <em>ε</em>   (the Dirichlet inverse of the constant function 1 is the <a href="Möbius_function" title="wikilink">Möbius function</a>.) This implies</li>
<li><em>g</em> = <em>f</em> ∗ 1 if and only if    (the <a href="Möbius_inversion_formula" title="wikilink">Möbius inversion formula</a>).</li>
<li><em>λ</em> ∗ 

<math display="inline" id="Dirichlet_convolution:2">
 <semantics>
  <mrow>
   <mo stretchy="false">|</mo>
   <mi>μ</mi>
   <mo stretchy="false">|</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <abs></abs>
    <ci>μ</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   |μ|
  </annotation>
 </semantics>
</math>

 = <em>ε</em>   where <em>λ</em> is <a href="Liouville's_function" title="wikilink">Liouville's function</a>.</li>
<li><em>λ</em> ∗ 1 = 1<sub>Sq</sub>   where Sq = {1, 4, 9, ...} is the set of squares</li>
<li>Id<sub><em>k</em></sub> ∗ (Id<sub><em>k</em></sub> <em>μ</em>) = <em>ε</em></li>
<li><em>σ</em><sub><em>k</em></sub> = Id<sub><em>k</em></sub> ∗ 1   definition of the <a href="divisor_function" title="wikilink">divisor function</a> <em>σ</em><sub><em>k</em></sub></li>
<li><em>σ</em> = Id ∗ 1   definition of the function <mtpl></mtpl></li>
<li><em>d</em> = 1 ∗ 1   definition of the function <mtpl></mtpl></li>
<li>Id<sub><em>k</em></sub> = <em>σ</em><sub><em>k</em></sub> ∗ <em>μ</em>   Möbius inversion of the formulas for <em>σ</em><sub><em>k</em></sub>, <em>σ</em>, and <em>d</em>.</li>
<li>Id = <em>σ</em> ∗ <em>μ</em></li>
<li>1 = <em>d</em> ∗ <em>μ</em></li>
<li><em>d</em><sup>3</sup> ∗ 1 = (<em>d</em> ∗ 1)<sup>2</sup></li>
<li><em>φ</em> ∗ 1 = Id   This formula is proved in the article <a href="Euler's_totient_function#Divisor_sum" title="wikilink">Euler's totient function</a>.</li>
<li>J<sub><em>k</em></sub> ∗ 1 = Id<sub><em>k</em></sub>   The <a href="Jordan's_totient_function" title="wikilink">Jordan's totient function</a>.</li>
<li>(Id<sub><em>s</em></sub>J<sub><em>r</em></sub>) ∗ J<sub><em>s</em></sub> = J<sub><em>s</em> + <em>r</em></sub></li>
<li><em>σ</em> = <em>φ</em> ∗ <em>d</em>   Proof: convolve 1 to both sides of .</li>
<li>Λ ∗ 1 = log   where Λ is <a href="von_Mangoldt_function" title="wikilink">von Mangoldt function</a>.</li>
</ul>
<h2 id="dirichlet-inverse">Dirichlet inverse</h2>

<p>Given an arithmetic function <em>f</em> its Dirichlet inverse <mtpl></mtpl> may be calculated recursively (i.e. the value of <em>g</em>(<em>n</em>) is in terms of <em>g</em>(<em>m</em>) for ) from the definition of Dirichlet inverse.</p>

<p>For :</p>
<dl>
<dd>(<em>f</em> ∗ <em>g</em>) (1) = <em>f</em>(1) <em>g</em>(1) = <em>ε</em>(1) = 1, so
</dd>
</dl>
<dl>
<dd><em>g</em>(1) = 1/<em>f</em>(1). This implies that <em>f</em> does not have a Dirichlet inverse if .
</dd>
</dl>

<p>For </p>
<dl>
<dd>(<em>f</em> ∗ <em>g</em>) (2) = <em>f</em>(1) <em>g</em>(2) + <em>f</em>(2) <em>g</em>(1) = <em>ε</em>(2) = 0,
</dd>
<dd><em>g</em>(2) = −1/<em>f</em>(1) (<em>f</em>(2) <em>g</em>(1)),
</dd>
</dl>

<p>For </p>
<dl>
<dd>(<em>f</em> ∗ <em>g</em>) (3) = <em>f</em>(1) <em>g</em>(3) + <em>f</em>(3) <em>g</em>(1) = <em>ε</em>(3) = 0,
</dd>
<dd><em>g</em>(3) = −1/<em>f</em>(1) (<em>f</em>(3) <em>g</em>(1)),
</dd>
</dl>

<p>For </p>
<dl>
<dd>(<em>f</em> ∗ <em>g</em>) (4) = <em>f</em>(1) <em>g</em>(4) + <em>f</em>(2) <em>g</em>(2) + <em>f</em>(4) <em>g</em>(1) = <em>ε</em>(4) = 0,
</dd>
<dd><em>g</em>(4) = −1/<em>f</em>(1) (<em>f</em>(4) <em>g</em>(1) + <em>f</em>(2) <em>g</em>(2)),
</dd>
</dl>

<p>and in general for ,</p>

<p>

<math display="block" id="Dirichlet_convolution:3">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>g</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>n</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mfrac>
      <mrow>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
      <mrow>
       <mi>f</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mn>1</mn>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
     </mfrac>
     <mrow>
      <munder>
       <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
       <mover>
        <mrow>
         <mi>d</mi>
         <mo movablelimits="false"><</mo>
         <mi>n</mi>
        </mrow>
        <mrow>
         <mpadded width="+1.7pt">
          <mi>d</mi>
         </mpadded>
         <mo rspace="4.2pt">∣</mo>
         <mi>n</mi>
        </mrow>
       </mover>
      </munder>
      <mrow>
       <mi>f</mi>
       <mrow>
        <mo>(</mo>
        <mfrac>
         <mi>n</mi>
         <mi>d</mi>
        </mfrac>
        <mo>)</mo>
       </mrow>
       <mi>g</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>d</mi>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>g</ci>
     <ci>n</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <divide></divide>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
      </apply>
      <apply>
       <times></times>
       <ci>f</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <lt></lt>
         <ci>d</ci>
         <ci>n</ci>
        </apply>
        <cerror>
         <csymbol cd="ambiguous">fragments</csymbol>
         <csymbol cd="unknown">d</csymbol>
         <ci>normal-∣</ci>
         <csymbol cd="unknown">n</csymbol>
        </cerror>
       </apply>
      </apply>
      <apply>
       <times></times>
       <ci>f</ci>
       <apply>
        <divide></divide>
        <ci>n</ci>
        <ci>d</ci>
       </apply>
       <ci>g</ci>
       <ci>d</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   g(n)=\frac{-1}{f(1)}\sum_{\stackrel{d\,\mid\,n}{d<n}}f\left(\frac{n}{d}\right)%
g(d).
  </annotation>
 </semantics>
</math>

</p>

<p>Since the only division is by <em>f</em>(1) this shows that <em>f</em> has a Dirichlet inverse if and only if .</p>

<p>Here is a useful table of Dirichlet inverses of common arithmetic functions:</p>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">
<p>Arithmetic function</p></th>
<th style="text-align: left;">
<p>Dirichlet inverse</p></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">
<p>Constant function equal to 1</p></td>
<td style="text-align: left;">
<p><a href="Möbius_function" title="wikilink">Möbius function</a> <em>μ</em></p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>

<math display="inline" id="Dirichlet_convolution:4">
 <semantics>
  <msup>
   <mi>n</mi>
   <mi>α</mi>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>n</ci>
    <ci>α</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n^{\alpha}
  </annotation>
 </semantics>
</math>

</p></td>
<td style="text-align: left;">
<p>

<math display="inline" id="Dirichlet_convolution:5">
 <semantics>
  <mrow>
   <mi>μ</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>n</mi>
    <mo rspace="4.2pt" stretchy="false">)</mo>
   </mrow>
   <msup>
    <mi>n</mi>
    <mi>α</mi>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>μ</ci>
    <ci>n</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>n</ci>
     <ci>α</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mu(n)\,n^{\alpha}
  </annotation>
 </semantics>
</math>

</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p><a href="Liouville's_function" title="wikilink">Liouville's function</a> <em>λ</em></p></td>
<td style="text-align: left;">
<p>Absolute value of Möbius function 

<math display="inline" id="Dirichlet_convolution:6">
 <semantics>
  <mrow>
   <mo stretchy="false">|</mo>
   <mi>μ</mi>
   <mo stretchy="false">|</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <abs></abs>
    <ci>μ</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   |μ|
  </annotation>
 </semantics>
</math>

</p></td>
</tr>
</tbody>
</table>
<h2 id="dirichlet-series">Dirichlet series</h2>

<p>If <em>f</em> is an arithmetic function, one defines its <a href="Dirichlet_series" title="wikilink">Dirichlet series</a> <a href="generating_function" title="wikilink">generating function</a> by</p>

<p>

<math display="block" id="Dirichlet_convolution:7">
 <semantics>
  <mrow>
   <mrow>
    <mi>D</mi>
    <mi>G</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>f</mi>
     <mo>;</mo>
     <mi>s</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <munderover>
     <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
     <mrow>
      <mi>n</mi>
      <mo>=</mo>
      <mn>1</mn>
     </mrow>
     <mi mathvariant="normal">∞</mi>
    </munderover>
    <mfrac>
     <mrow>
      <mi>f</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>n</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <msup>
      <mi>n</mi>
      <mi>s</mi>
     </msup>
    </mfrac>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>D</ci>
     <ci>G</ci>
     <list>
      <ci>f</ci>
      <ci>s</ci>
     </list>
    </apply>
    <apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <apply>
        <eq></eq>
        <ci>n</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <infinity></infinity>
     </apply>
     <apply>
      <divide></divide>
      <apply>
       <times></times>
       <ci>f</ci>
       <ci>n</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>n</ci>
       <ci>s</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   DG(f;s)=\sum_{n=1}^{\infty}\frac{f(n)}{n^{s}}
  </annotation>
 </semantics>
</math>

</p>

<p>for those <a href="complex_number" title="wikilink">complex</a> arguments <em>s</em> for which the series converges (if there are any). The multiplication of Dirichlet series is compatible with Dirichlet convolution in the following sense:</p>

<p>

<math display="block" id="Dirichlet_convolution:8">
 <semantics>
  <mrow>
   <mrow>
    <mi>D</mi>
    <mi>G</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>f</mi>
     <mo>;</mo>
     <mi>s</mi>
     <mo stretchy="false">)</mo>
    </mrow>
    <mi>D</mi>
    <mi>G</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>g</mi>
     <mo>;</mo>
     <mi>s</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mi>D</mi>
    <mi>G</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>f</mi>
      <mo>*</mo>
      <mi>g</mi>
     </mrow>
     <mo>;</mo>
     <mi>s</mi>
     <mo rspace="4.2pt" stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>D</ci>
     <ci>G</ci>
     <list>
      <ci>f</ci>
      <ci>s</ci>
     </list>
     <ci>D</ci>
     <ci>G</ci>
     <list>
      <ci>g</ci>
      <ci>s</ci>
     </list>
    </apply>
    <apply>
     <times></times>
     <ci>D</ci>
     <ci>G</ci>
     <list>
      <apply>
       <times></times>
       <ci>f</ci>
       <ci>g</ci>
      </apply>
      <ci>s</ci>
     </list>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   DG(f;s)DG(g;s)=DG(f*g;s)\,
  </annotation>
 </semantics>
</math>

</p>

<p>for all <em>s</em> for which both series of the left hand side converge, one of them at least converging absolutely (note that simple convergence of both series of the left hand side DOES NOT imply convergence of the right hand side!). This is akin to the <a href="convolution_theorem" title="wikilink">convolution theorem</a> if one thinks of Dirichlet series as a <a href="Fourier_transform" title="wikilink">Fourier transform</a>.</p>
<h2 id="related-concepts">Related Concepts</h2>

<p>The restriction of the divisors in the convolution to <a href="Unitary_divisor" title="wikilink">unitary</a>, <a href="Bi-unitary_divisor" title="wikilink">bi-unitary</a> or infinitary divisors defines similar commutative operations which share many features with the Dirichlet convolution (existence of a Möbius inversion, persistence of multiplicativity, definitions of totients, Euler-type product formulas over associated primes, etc.).</p>
<h2 id="references">References</h2>
<ul>
<li></li>
<li></li>
<li></li>
</ul>
<ul>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
</ul>
<h2 id="external-links">External links</h2>
<ul>
<li></li>
</ul>

<p><a href="de:Zahlentheoretische_Funktion#Faltung" title="wikilink">de:Zahlentheoretische Funktion#Faltung</a>"</p>

<p><a href="Category:Arithmetic_functions" title="wikilink">Category:Arithmetic functions</a> <a href="Category:Bilinear_operators" title="wikilink">Category:Bilinear operators</a> <a href="Category:Binary_operations" title="wikilink">Category:Binary operations</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1">Proofs of all these facts are in Chan, ch. 2<a href="#fnref1">↩</a></li>
<li id="fn2">A proof is in the article <a href="Completely_multiplicative_function#Proof_of_pseudo-associative_property" title="wikilink">Completely multiplicative function#Proof of pseudo-associative property</a>.<a href="#fnref2">↩</a></li>
</ol>
</section>
</body>
</html>

<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="226">Confidence and prediction bands</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Confidence and prediction bands</h1>
<hr/>

<p>A <strong>confidence band</strong> is used in <a href="statistics" title="wikilink">statistical analysis</a> to represent the uncertainty in an estimate of a curve or function based on limited or noisy data. Similarly, a <strong>prediction band</strong> is used to represent the uncertainty about the value of a new data-point on the curve, but subject to noise. Confidence and prediction bands are often used as part of the graphical presentation of results of a <a href="regression_analysis" title="wikilink">regression analysis</a>.</p>

<p>Confidence bands are closely related to <a href="confidence_intervals" title="wikilink">confidence intervals</a>, which represent the uncertainty in an estimate of a single numerical value. "As confidence intervals, by construction, only refer to a single point, they are narrower (at this point) than a confidence band which is supposed to hold simultaneously at many points."<a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a></p>
<h2 id="pointwise-and-simultaneous-confidence-bands">Pointwise and simultaneous confidence bands</h2>

<p>Suppose our aim is to estimate a function <em>f(x)</em>. For example, <em>f(x)</em> might be the proportion of people of a particular age <em>x</em> who support a given candidate in an election. If <em>x</em> is measured at the precision of a single year, we can construct a separate 95% confidence interval for each age. Each of these confidence intervals covers the corresponding true value <em>f(x)</em> with probability 0.95. Taken together, these confidence intervals constitute a <em>95% pointwise confidence band</em> for <em>f(x)</em>.</p>

<p>In mathematical terms, a pointwise confidence band 

<math display="inline" id="Confidence_and_prediction_bands:0">
 <semantics>
  <mrow>
   <mrow>
    <mover accent="true">
     <mi>f</mi>
     <mo stretchy="false">^</mo>
    </mover>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>x</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>±</mo>
   <mrow>
    <mi>w</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>x</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">plus-or-minus</csymbol>
    <apply>
     <times></times>
     <apply>
      <ci>normal-^</ci>
      <ci>f</ci>
     </apply>
     <ci>x</ci>
    </apply>
    <apply>
     <times></times>
     <ci>w</ci>
     <ci>x</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \hat{f}(x)\pm w(x)
  </annotation>
 </semantics>
</math>

 with coverage probability 1−α satisfies the following condition separately for each value of <em>x</em>:</p>

<p>

<math display="block" id="Confidence_and_prediction_bands:1">
 <semantics>
  <mrow>
   <mi>Pr</mi>
   <mrow>
    <mo maxsize="160%" minsize="160%">(</mo>
    <mover accent="true">
     <mi>f</mi>
     <mo stretchy="false">^</mo>
    </mover>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>x</mi>
     <mo stretchy="false">)</mo>
    </mrow>
    <mo>-</mo>
    <mi>w</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>x</mi>
     <mo stretchy="false">)</mo>
    </mrow>
    <mo>≤</mo>
    <mi>f</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>x</mi>
     <mo stretchy="false">)</mo>
    </mrow>
    <mo>≤</mo>
    <mover accent="true">
     <mi>f</mi>
     <mo stretchy="false">^</mo>
    </mover>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>x</mi>
     <mo stretchy="false">)</mo>
    </mrow>
    <mo>+</mo>
    <mi>w</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>x</mi>
     <mo stretchy="false">)</mo>
    </mrow>
    <mo maxsize="160%" minsize="160%">)</mo>
   </mrow>
   <mo>=</mo>
   <mn>1</mn>
   <mo>-</mo>
   <mi>α</mi>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">Pr</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <ci>normal-^</ci>
      <ci>f</ci>
     </apply>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <ci>normal-(</ci>
      <csymbol cd="unknown">x</csymbol>
      <ci>normal-)</ci>
     </cerror>
     <minus></minus>
     <csymbol cd="unknown">w</csymbol>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <ci>normal-(</ci>
      <csymbol cd="unknown">x</csymbol>
      <ci>normal-)</ci>
     </cerror>
     <leq></leq>
     <csymbol cd="unknown">f</csymbol>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <ci>normal-(</ci>
      <csymbol cd="unknown">x</csymbol>
      <ci>normal-)</ci>
     </cerror>
     <leq></leq>
     <apply>
      <ci>normal-^</ci>
      <ci>f</ci>
     </apply>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <ci>normal-(</ci>
      <csymbol cd="unknown">x</csymbol>
      <ci>normal-)</ci>
     </cerror>
     <plus></plus>
     <csymbol cd="unknown">w</csymbol>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <ci>normal-(</ci>
      <csymbol cd="unknown">x</csymbol>
      <ci>normal-)</ci>
     </cerror>
     <ci>normal-)</ci>
    </cerror>
    <eq></eq>
    <cn type="integer">1</cn>
    <minus></minus>
    <csymbol cd="unknown">α</csymbol>
    <ci>normal-,</ci>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   {\rm Pr}\Big(\hat{f}(x)-w(x)\leq f(x)\leq\hat{f}(x)+w(x)\Big)=1-\alpha,
  </annotation>
 </semantics>
</math>

</p>

<p>where 

<math display="inline" id="Confidence_and_prediction_bands:2">
 <semantics>
  <mrow>
   <mover accent="true">
    <mi>f</mi>
    <mo stretchy="false">^</mo>
   </mover>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>x</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <ci>normal-^</ci>
     <ci>f</ci>
    </apply>
    <ci>x</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \hat{f}(x)
  </annotation>
 </semantics>
</math>

 is the point estimate of <em>f</em>(<em>x</em>).</p>

<p>The <em>simultaneous coverage probability</em> of a collection of confidence intervals is the probability that all of them cover their corresponding true values simultaneously. In the example above, the simultaneous coverage probability is the probability that the intervals for x=18,19,... all cover their true values (assuming that 18 is the youngest age at which a person can vote). If each interval individually has coverage probability 0.95, the simultaneous coverage probability is generally less than 0.95. A <em>95% simultaneous confidence band</em> is a collection of confidence intervals for all values <em>x</em> in the domain of <em>f(x)</em> that is constructed to have simultaneous coverage probability 0.95.</p>

<p>In mathematical terms, a simultaneous confidence band 

<math display="inline" id="Confidence_and_prediction_bands:3">
 <semantics>
  <mrow>
   <mrow>
    <mover accent="true">
     <mi>f</mi>
     <mo stretchy="false">^</mo>
    </mover>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>x</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>±</mo>
   <mrow>
    <mi>w</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>x</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">plus-or-minus</csymbol>
    <apply>
     <times></times>
     <apply>
      <ci>normal-^</ci>
      <ci>f</ci>
     </apply>
     <ci>x</ci>
    </apply>
    <apply>
     <times></times>
     <ci>w</ci>
     <ci>x</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \hat{f}(x)\pm w(x)
  </annotation>
 </semantics>
</math>


 with coverage probability 1−α satisfies the following condition:</p>

<p>

<math display="block" id="Confidence_and_prediction_bands:4">
 <semantics>
  <mrow>
   <mi>Pr</mi>
   <mrow>
    <mo maxsize="160%" minsize="160%">(</mo>
    <mover accent="true">
     <mi>f</mi>
     <mo stretchy="false">^</mo>
    </mover>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>x</mi>
     <mo stretchy="false">)</mo>
    </mrow>
    <mo>-</mo>
    <mi>w</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>x</mi>
     <mo stretchy="false">)</mo>
    </mrow>
    <mo>≤</mo>
    <mi>f</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>x</mi>
     <mo stretchy="false">)</mo>
    </mrow>
    <mo>≤</mo>
    <mover accent="true">
     <mi>f</mi>
     <mo stretchy="false">^</mo>
    </mover>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>x</mi>
     <mo stretchy="false">)</mo>
    </mrow>
    <mo>+</mo>
    <mi>w</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>x</mi>
     <mo stretchy="false">)</mo>
    </mrow>
    <mtext>for all</mtext>
    <mi>x</mi>
    <mo maxsize="160%" minsize="160%">)</mo>
   </mrow>
   <mo>=</mo>
   <mn>1</mn>
   <mo>-</mo>
   <mi>α</mi>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">Pr</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <ci>normal-^</ci>
      <ci>f</ci>
     </apply>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <ci>normal-(</ci>
      <csymbol cd="unknown">x</csymbol>
      <ci>normal-)</ci>
     </cerror>
     <minus></minus>
     <csymbol cd="unknown">w</csymbol>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <ci>normal-(</ci>
      <csymbol cd="unknown">x</csymbol>
      <ci>normal-)</ci>
     </cerror>
     <leq></leq>
     <csymbol cd="unknown">f</csymbol>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <ci>normal-(</ci>
      <csymbol cd="unknown">x</csymbol>
      <ci>normal-)</ci>
     </cerror>
     <leq></leq>
     <apply>
      <ci>normal-^</ci>
      <ci>f</ci>
     </apply>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <ci>normal-(</ci>
      <csymbol cd="unknown">x</csymbol>
      <ci>normal-)</ci>
     </cerror>
     <plus></plus>
     <csymbol cd="unknown">w</csymbol>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <ci>normal-(</ci>
      <csymbol cd="unknown">x</csymbol>
      <ci>normal-)</ci>
     </cerror>
     <ci></ci>
     <mtext>for all</mtext>
     <csymbol cd="unknown">x</csymbol>
     <ci>normal-)</ci>
    </cerror>
    <eq></eq>
    <cn type="integer">1</cn>
    <minus></minus>
    <csymbol cd="unknown">α</csymbol>
    <ci>normal-.</ci>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   {\rm Pr}\Big(\hat{f}(x)-w(x)\leq f(x)\leq\hat{f}(x)+w(x)\;\;\;\;\text{ for all%
 }x\Big)=1-\alpha.
  </annotation>
 </semantics>
</math>

</p>

<p>In nearly all cases, a simultaneous confidence band will be wider than a pointwise confidence band with the same coverage probability.</p>
<figure><b>(Figure)</b>
<figcaption>Confidence bands for simulated data depicting the proportion of voters supporting a given candidate in election, as a function of the voters' ages. Pointwise 95% confidence bands, and simultaneous 95% confidence bands constructed using the <a href="Bonferroni_method" title="wikilink">Bonferroni method</a> are shown.</figcaption>
</figure>
<h2 id="confidence-bands-in-regression-analysis">Confidence bands in regression analysis</h2>

<p>Confidence bands commonly arise in <a href="regression_analysis" title="wikilink">regression analysis</a>.<a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a> In the case of a simple regression involving a single independent variable, results can be presented in the form of a plot showing the estimated regression line along with either point-wise or simultaneous confidence bands. Commonly used methods for constructing simultaneous confidence bands in regression are the <a href="Bonferroni_method" title="wikilink">Bonferroni</a> and <a href="Scheffé's_method" title="wikilink">Scheffé</a> methods; see <a href="Familywise_error_rate#Controlling_procedures" title="wikilink">Familywise error rate controlling procedures</a> for more.</p>
<figure><b>(Figure)</b>
<figcaption>Confidence bands for a simple linear regression analysis using simulated data. Pointwise 95% confidence bands, and simultaneous 95% confidence bands constructed using <a href="Scheffé's_method" title="wikilink">Scheffé's method</a> are shown.</figcaption>
</figure>
<h2 id="other-applications-of-confidence-bands">Other applications of confidence bands</h2>

<p>Confidence bands arise whenever a statistical analysis focuses on estimating a function.</p>

<p>For example, confidence bands can be constructed around estimates of the <a href="empirical_distribution_function" title="wikilink">empirical distribution function</a>. Simple theory allows the construction of point-wise confidence intervals, but it is also possible to construct a simultaneous confidence band for the cumulative distribution function as a whole by inverting the <a href="Kolmogorov-Smirnov_test#Setting_confidence_limits_for_the_shape_of_a_distribution_function" title="wikilink">Kolmogorov-Smirnov test</a>, or by using non-parametric likelihood methods .<a class="footnoteRef" href="#fn3" id="fnref3"><sup>3</sup></a></p>

<p>Confidence bands have also been devised for estimates of <a href="probability_density_function" title="wikilink">density functions</a>, <a href="spectral_density" title="wikilink">spectral density</a> functions<a class="footnoteRef" href="#fn4" id="fnref4"><sup>4</sup></a> , <a class="uri" href="quantile" title="wikilink">quantile</a> functions, <a href="smoothing" title="wikilink">scatterplot smooths</a>, <a href="survival_function" title="wikilink">survival functions</a>, and <a href="characteristic_function_(probability_theory)" title="wikilink">characteristic functions</a>.</p>
<h2 id="prediction-bands">Prediction bands</h2>

<p>Prediction bands are related to <a href="prediction_interval" title="wikilink">prediction intervals</a> in the same way that confidence bands are related to confidence intervals. Prediction bands commonly arise in regression analysis. The goal of a prediction band is to cover with a prescribed probability the values of one or more future observations from the same population from which a given data set was sampled. Just as prediction intervals are wider than confidence intervals, prediction bands will be wider than confidence bands.</p>

<p>In mathematical terms, a prediction band 

<math display="inline" id="Confidence_and_prediction_bands:5">
 <semantics>
  <mrow>
   <mrow>
    <mover accent="true">
     <mi>f</mi>
     <mo stretchy="false">^</mo>
    </mover>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>x</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>±</mo>
   <mrow>
    <mi>w</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>x</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">plus-or-minus</csymbol>
    <apply>
     <times></times>
     <apply>
      <ci>normal-^</ci>
      <ci>f</ci>
     </apply>
     <ci>x</ci>
    </apply>
    <apply>
     <times></times>
     <ci>w</ci>
     <ci>x</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \hat{f}(x)\pm w(x)
  </annotation>
 </semantics>
</math>

 with coverage probability 1−α satisfies the following condition for each value of <em>x</em>:</p>

<p>

<math display="block" id="Confidence_and_prediction_bands:6">
 <semantics>
  <mrow>
   <mi>Pr</mi>
   <mrow>
    <mo maxsize="160%" minsize="160%">(</mo>
    <mover accent="true">
     <mi>f</mi>
     <mo stretchy="false">^</mo>
    </mover>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>x</mi>
     <mo stretchy="false">)</mo>
    </mrow>
    <mo>-</mo>
    <mi>w</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>x</mi>
     <mo stretchy="false">)</mo>
    </mrow>
    <mo>≤</mo>
    <msup>
     <mi>y</mi>
     <mo>*</mo>
    </msup>
    <mo>≤</mo>
    <mover accent="true">
     <mi>f</mi>
     <mo stretchy="false">^</mo>
    </mover>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>x</mi>
     <mo stretchy="false">)</mo>
    </mrow>
    <mo>+</mo>
    <mi>w</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>x</mi>
     <mo stretchy="false">)</mo>
    </mrow>
    <mo maxsize="160%" minsize="160%">)</mo>
   </mrow>
   <mo>=</mo>
   <mn>1</mn>
   <mo>-</mo>
   <mi>α</mi>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">Pr</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <ci>normal-^</ci>
      <ci>f</ci>
     </apply>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <ci>normal-(</ci>
      <csymbol cd="unknown">x</csymbol>
      <ci>normal-)</ci>
     </cerror>
     <minus></minus>
     <csymbol cd="unknown">w</csymbol>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <ci>normal-(</ci>
      <csymbol cd="unknown">x</csymbol>
      <ci>normal-)</ci>
     </cerror>
     <leq></leq>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>y</ci>
      <times></times>
     </apply>
     <leq></leq>
     <apply>
      <ci>normal-^</ci>
      <ci>f</ci>
     </apply>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <ci>normal-(</ci>
      <csymbol cd="unknown">x</csymbol>
      <ci>normal-)</ci>
     </cerror>
     <plus></plus>
     <csymbol cd="unknown">w</csymbol>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <ci>normal-(</ci>
      <csymbol cd="unknown">x</csymbol>
      <ci>normal-)</ci>
     </cerror>
     <ci>normal-)</ci>
    </cerror>
    <eq></eq>
    <cn type="integer">1</cn>
    <minus></minus>
    <csymbol cd="unknown">α</csymbol>
    <ci>normal-,</ci>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   {\rm Pr}\Big(\hat{f}(x)-w(x)\leq y^{*}\leq\hat{f}(x)+w(x)\Big)=1-\alpha,
  </annotation>
 </semantics>
</math>

</p>

<p>where <em>y</em><sup>*</sup> is an observation taken from the data-generating process at the given point <em>x</em> that is independent of the data used to construct the point estimate 

<math display="inline" id="Confidence_and_prediction_bands:7">
 <semantics>
  <mrow>
   <mover accent="true">
    <mi>f</mi>
    <mo stretchy="false">^</mo>
   </mover>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>x</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <ci>normal-^</ci>
     <ci>f</ci>
    </apply>
    <ci>x</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \hat{f}(x)
  </annotation>
 </semantics>
</math>

 and the confidence interval <em>w(x)</em>. This is a pointwise prediction interval. It would be possible to construct a simultaneous interval for a finite number of independent observations using, for example, the Bonferroni method to widen the interval by an appropriate amount.</p>
<h2 id="references">References</h2>

<p>"</p>

<p><a href="Category:Statistical_inference" title="wikilink">Category:Statistical inference</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1">p.65 in W. Härdle, M. Müller, S. Sperlich, A. Werwatz (2004), Nonparametric and Semiparametric Models, Springer, ISBN 3540207228 <a href="http://sfb649.wiwi.hu-berlin.de/fedc_homepage/xplore/ebooks/html/spm/spmhtmlnode17.html">1</a>,[<a class="uri" href="http://books.google.com/books?id=qPCmAOS-CoMC&amp;lpg">http://books.google.com/books?id=qPCmAOS-CoMC&amp;lpg;</a>;=PA65&amp;vq;=As%20confidence%20intervals%2C%20by%20construction%2C%20only%20refer%20to%20a%20single%20point%2C%20they%20are%20narrower%20(at%20this%20point)%20than%20a%20confidence%20band%20which%20is%20supposed%20to%20hold%20simultaneously%20at%20many%20points&amp;pg;=PA65#v=snippet&amp;q;=As%20confidence%20intervals,%20by%20construction,%20only%20refer%20to%20a%20single%20point,%20they%20are%20narrower%20(at%20this%20point)%20than%20a%20confidence%20band%20which%20is%20supposed%20to%20hold%20simultaneously%20at%20many%20points&amp;f;=false]<a href="#fnref1">↩</a></li>
<li id="fn2"><a href="#fnref2">↩</a></li>
<li id="fn3"><a href="#fnref3">↩</a></li>
<li id="fn4"><a href="#fnref4">↩</a></li>
</ol>
</section>
</body>
</html>

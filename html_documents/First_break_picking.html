<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="1962">First break picking</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>First break picking</h1>
<hr/>

<p>'''First-break picking ''' detecting or picking the onset arrivals of refracted signals from all the signals received by receiver arrays and produced by a particular source signal generation. It is also called first arrival picking or first break detection. First-break picking can be done automatically, manually or as a combination of both. With the development of computer science and the size of seismic surveys, automatic picking is often preferred.<a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a></p>
<h2 id="significance">Significance</h2>

<p><strong>First-break picks</strong> associated with the <a class="uri" href="refracted" title="wikilink">refracted</a> arrival times are used in an <a href="Inversion_(geology)" title="wikilink">inversion scheme</a> to study the near-surface low-<a class="uri" href="velocity" title="wikilink">velocity</a> zone and subsequent determination of static corrections. Static correction is a correction applied to geophysical data, especially seismic data, to compensate for the effect of near-surface irregularities, differences in the elevation of shots and <a href="geophone" title="wikilink">geophones</a>, or any application to correct the positions of source and receivers.</p>
<h2 id="history-of-first-break-picking">History of First Break Picking</h2>

<p>Gelchinsky and Shtivelman<a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a>(1983) used <a class="uri" href="correlation" title="wikilink">correlation</a> properties of signals and applied a statistical criterion for the estimation of first arrivals time.</p>

<p>Coppens<a class="footnoteRef" href="#fn3" id="fnref3"><sup>3</sup></a>(1985) calculated the ratio of energy of <a class="uri" href="seismogram" title="wikilink">seismogram</a> of the two windows and used that to differentiate in signal and noise.</p>

<p>Michael D. McCormark <em>et al.</em><a class="footnoteRef" href="#fn4" id="fnref4"><sup>4</sup></a>(1993) introduced a <a class="uri" href="backpropagation" title="wikilink">backpropagation</a> neural network (BNN) method. The <a href="Neural_network" title="wikilink">Neural network</a> which edits <a class="uri" href="seismic" title="wikilink">seismic</a> data or pick first breaks was trained by users, who were just selecting and presenting to the network examples of trace edits or refraction picks. The network then changes internal weights iteratively until it can reproduce the examples accurately provided by the users.</p>

<p>Fabio Boschetti <em>et al.</em><a class="footnoteRef" href="#fn5" id="fnref5"><sup>5</sup></a>(1996) introduce a <a class="uri" href="fractal" title="wikilink">fractal</a>-based <a class="uri" href="algorithm" title="wikilink">algorithm</a> which detects the presence of a signal by analyzing the variation in fractal dimension along the trace. This method works when signal-to-noise ratio is small, but it is considerably slow.</p>

<p>A direct correlation method was introduced by Joseph <em>et al.</em><a class="footnoteRef" href="#fn6" id="fnref6"><sup>6</sup></a>(1999) which was developed for use in highly time-resolved, low-noise signals acquired in the laboratory. In this method, the greatest value of Pearson's correlation coefficient between segments of observed <a href="waveform" title="wikilink">waveforms</a> near the <a href="pulse_onset" title="wikilink">pulse onset</a> and at an appropriate reference serves as the time determination criterion.</p>

<p>Zuolin Chen, <em>et al.</em><a class="footnoteRef" href="#fn7" id="fnref7"><sup>7</sup></a>(2005) introduced a multi-window algorithm to detect the first break. In this method, three moving windows were used and the averages of absolute amplitudes in each window need to be calculated, then ratios based on the averages of the windows provide standards to differentiate signals from unwanted noise.</p>

<p>Wong <em>et al.</em><a class="footnoteRef" href="#fn8" id="fnref8"><sup>8</sup></a>(2009) introduced STA/LTA ratio method. This method is similar as Coppens’<a class="footnoteRef" href="#fn9" id="fnref9"><sup>9</sup></a> algorithm. The difference is to do the ratio of two averages of energy between a short-term window and a long-term window, which is denoted as STA/LTA (short-term average/long-term average), instead of calculating the ratio of energy of seismogram of the two windows in Coppens’ algorithm.</p>
<h2 id="methods-of-automatic-first-break-picking">Methods of Automatic First Break Picking</h2>
<h3 id="stalta-ratio-method">STA/LTA ratio Method<a class="footnoteRef" href="#fn10" id="fnref10"><sup>10</sup></a></h3>

<p>This method is similar as Coppens’ (1985) algorithm. The difference is to do the ratio of two averages of energy between a short-term window and a long-term window, which is denoted as STA/LTA (short-term average/long-term average), instead of calculating the ratio of energy of seismogram of the two windows in Coppens’ algorithm. The numerical <a class="uri" href="derivative" title="wikilink">derivative</a> of the ratio can be defined as,</p>

<p>

<math display="inline" id="First_break_picking:0">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>d</mi>
     <mi>i</mi>
    </msub>
    <mo>=</mo>
    <mrow>
     <msub>
      <mi>r</mi>
      <mrow>
       <mi>i</mi>
       <mo>+</mo>
       <mn>1</mn>
      </mrow>
     </msub>
     <mo>-</mo>
     <msub>
      <mi>r</mi>
      <mi>i</mi>
     </msub>
    </mrow>
   </mrow>
   <mo>,</mo>
   <mrow>
    <mi>i</mi>
    <mo>=</mo>
    <mrow>
     <mn>1</mn>
     <mo>,</mo>
     <mn>2</mn>
     <mo>,</mo>
     <mrow>
      <mi mathvariant="normal">…</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mi>n</mi>
        <mo>-</mo>
        <mn>1</mn>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>d</ci>
      <ci>i</ci>
     </apply>
     <apply>
      <minus></minus>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>r</ci>
       <apply>
        <plus></plus>
        <ci>i</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>r</ci>
       <ci>i</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <ci>i</ci>
     <list>
      <cn type="integer">1</cn>
      <cn type="integer">2</cn>
      <apply>
       <times></times>
       <ci>normal-…</ci>
       <apply>
        <minus></minus>
        <ci>n</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
     </list>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle d_{i}=r_{i+1}-r_{i},i=1,2,...(n-1)
  </annotation>
 </semantics>
</math>


 where <em>r<sub>i+1</sub></em> is the STA/LTA ratio at time index <em>i+1</em>, and <em>r<sub>i</sub></em> is the STA/LTA ratio at time index <em>i</em>. For noise-free seismograms, the maximum value of the numerical derivative of the STA/LTA ratio is close to the time of the first arrival.</p>

<p>Wong et al. (2009) modified the algorithm of the energy ratio method, where they named the method as modified energy ratio. In this method, they define the energy ratio as,</p>

<p>

<math display="inline" id="First_break_picking:1">
 <semantics>
  <mrow>
   <mrow>
    <mi>e</mi>
    <mi>r</mi>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mstyle displaystyle="true">
     <munderover>
      <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
      <mrow>
       <mi>j</mi>
       <mo>=</mo>
       <mrow>
        <mi>i</mi>
        <mo>-</mo>
        <mrow>
         <mi>n</mi>
         <mi>e</mi>
        </mrow>
       </mrow>
      </mrow>
      <mi>i</mi>
     </munderover>
    </mstyle>
    <mrow>
     <msubsup>
      <mi>x</mi>
      <mi>j</mi>
      <mn>2</mn>
     </msubsup>
     <mo>/</mo>
     <mrow>
      <mstyle displaystyle="true">
       <munderover>
        <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
        <mrow>
         <mi>j</mi>
         <mo>=</mo>
         <mi>i</mi>
        </mrow>
        <mrow>
         <mi>i</mi>
         <mo>+</mo>
         <mrow>
          <mi>n</mi>
          <mi>e</mi>
         </mrow>
        </mrow>
       </munderover>
      </mstyle>
      <msubsup>
       <mi>x</mi>
       <mi>j</mi>
       <mn>2</mn>
      </msubsup>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>e</ci>
     <ci>r</ci>
    </apply>
    <apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <apply>
        <eq></eq>
        <ci>j</ci>
        <apply>
         <minus></minus>
         <ci>i</ci>
         <apply>
          <times></times>
          <ci>n</ci>
          <ci>e</ci>
         </apply>
        </apply>
       </apply>
      </apply>
      <ci>i</ci>
     </apply>
     <apply>
      <divide></divide>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>x</ci>
        <cn type="integer">2</cn>
       </apply>
       <ci>j</ci>
      </apply>
      <apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <sum></sum>
         <apply>
          <eq></eq>
          <ci>j</ci>
          <ci>i</ci>
         </apply>
        </apply>
        <apply>
         <plus></plus>
         <ci>i</ci>
         <apply>
          <times></times>
          <ci>n</ci>
          <ci>e</ci>
         </apply>
        </apply>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>x</ci>
         <cn type="integer">2</cn>
        </apply>
        <ci>j</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle er=\sum_{j=i-ne}^{i}x^{2}_{j}/\sum_{j=i}^{i+ne}x^{2}_{j}
  </annotation>
 </semantics>
</math>


 where <em>x<sub>i</sub></em> is the times series representing a seismogram with the time index <em>i=1, 2 … N.</em> and the number of points in an energy window is <em>ne</em>. Then, the modified energy ratio is defined as</p>

<p>

<math display="inline" id="First_break_picking:2">
 <semantics>
  <mrow>
   <mrow>
    <mi>e</mi>
    <mi>r</mi>
    <msub>
     <mn>3</mn>
     <mi>i</mi>
    </msub>
   </mrow>
   <mo>=</mo>
   <msup>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>a</mi>
      <mi>b</mi>
      <mi>s</mi>
      <msup>
       <mrow>
        <mo stretchy="false">(</mo>
        <msub>
         <mi>x</mi>
         <mi>i</mi>
        </msub>
        <mo stretchy="false">)</mo>
       </mrow>
       <mo>*</mo>
      </msup>
      <mi>e</mi>
      <mi>r</mi>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
    <mn>3</mn>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>e</ci>
     <ci>r</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <cn type="integer">3</cn>
      <ci>i</ci>
     </apply>
    </apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <times></times>
      <ci>a</ci>
      <ci>b</ci>
      <ci>s</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <ci>i</ci>
       </apply>
       <times></times>
      </apply>
      <ci>e</ci>
      <ci>r</ci>
     </apply>
     <cn type="integer">3</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle er3_{i}=(abs(x_{i})^{*}er)^{3}
  </annotation>
 </semantics>
</math>


 The peak of the modified energy ratio <em>er3i</em> is very closed to the time of first arrivals on noise-free seismograms.</p>
<h3 id="multi-window-method">Multi-Window Method<a class="footnoteRef" href="#fn11" id="fnref11"><sup>11</sup></a></h3>

<p>This method needs to calculate the averages of absolute <a href="amplitude" title="wikilink">amplitudes</a> from a seismic trace by using three moving time windows before and after each time point (sample).</p>

<p>When the instantaneous absolute amplitude exceeds an automatically adjusted threshold, ratios based on the averages of the windows over previous time samples provide standards to differentiate signals from unwanted noise.</p>

<p>The multi-window automatic P phase picker operates in the time-domain. It includes procedures to define: time windows, standards, corresponding thresholds and <a class="uri" href="waveform" title="wikilink">waveform</a> correction.</p>

<p>1. The averages of absolute amplitudes within BTA (Before Term Average), ATA (After Term Average) and DTA (Delayed Term Average) windows are respectively defined as follows:</p>

<p>

<math display="inline" id="First_break_picking:3">
 <semantics>
  <mrow>
   <mover accent="true">
    <mrow>
     <mi>B</mi>
     <mi>T</mi>
     <mi>A</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>t</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>¯</mo>
   </mover>
   <mo>=</mo>
   <mrow>
    <mstyle displaystyle="true">
     <munderover>
      <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
      <mrow>
       <mi>i</mi>
       <mo>=</mo>
       <mi>i</mi>
      </mrow>
      <mi>m</mi>
     </munderover>
    </mstyle>
    <mstyle displaystyle="true">
     <mfrac>
      <mrow>
       <mo stretchy="false">|</mo>
       <mrow>
        <mi>u</mi>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <mi>t</mi>
          <mo>-</mo>
          <mi>i</mi>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
       <mo stretchy="false">|</mo>
      </mrow>
      <mi>m</mi>
     </mfrac>
    </mstyle>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <ci>normal-¯</ci>
     <apply>
      <times></times>
      <ci>B</ci>
      <ci>T</ci>
      <ci>A</ci>
      <ci>t</ci>
     </apply>
    </apply>
    <apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <apply>
        <eq></eq>
        <ci>i</ci>
        <ci>i</ci>
       </apply>
      </apply>
      <ci>m</ci>
     </apply>
     <apply>
      <divide></divide>
      <apply>
       <abs></abs>
       <apply>
        <times></times>
        <ci>u</ci>
        <apply>
         <minus></minus>
         <ci>t</ci>
         <ci>i</ci>
        </apply>
       </apply>
      </apply>
      <ci>m</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle\overline{BTA(t)}=\sum_{i=i}^{m}\frac{|u(t-i)|}{m}
  </annotation>
 </semantics>
</math>


 Standards <em>R<sub>2</sub>(t)</em> and <em>R<sub>3</sub>(t)</em> are used for the discrimination of high-amplitude short-duration and long-duration noise.</p>

<p>2.Thresholds is defined as</p>

<p>

<math display="inline" id="First_break_picking:4">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>H</mi>
     <mn>1</mn>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>t</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <msub>
      <mi>E</mi>
      <mi>m</mi>
     </msub>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mi>t</mi>
       <mo>-</mo>
       <mi>p</mi>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>+</mo>
    <mrow>
     <mi>α</mi>
     <msub>
      <mi>E</mi>
      <mrow>
       <mi>s</mi>
       <mi>d</mi>
      </mrow>
     </msub>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mi>t</mi>
       <mo>-</mo>
       <mi>p</mi>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>H</ci>
      <cn type="integer">1</cn>
     </apply>
     <ci>t</ci>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>E</ci>
       <ci>m</ci>
      </apply>
      <apply>
       <minus></minus>
       <ci>t</ci>
       <ci>p</ci>
      </apply>
     </apply>
     <apply>
      <times></times>
      <ci>α</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>E</ci>
       <apply>
        <times></times>
        <ci>s</ci>
        <ci>d</ci>
       </apply>
      </apply>
      <apply>
       <minus></minus>
       <ci>t</ci>
       <ci>p</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle H_{1}(t)=E_{m}(t-p)+\alpha E_{sd}(t-p)
  </annotation>
 </semantics>
</math>


 where <em>E<sub>m</sub></em> is mean and <em>E<sub>sd</sub></em> is <a href="standard_deviation" title="wikilink">standard deviation</a>; <em>p</em> is the number of shifted samples; <em>α</em> is the coefficient to adjust the height of the first threshold and is taken to be 3. From this equation it is obvious that <em>H<sub>1</sub>(t)</em> is automatically adjusted with the variance of the background noise.</p>

<p>3. <em>H<sub>1</sub>(t)</em> is defined larger than most pre-existing noise levels, and the instantaneous absolute amplitude at the trigger time point is higher than <em>H<sub>1</sub>(t)</em>,according to the configuration of the first arrival of an event the real onset time must be earlier than the trigger time point. A waveform correction should be used to compensate this belated onset time. For an impulsive first arrival, the height of the absolute amplitude and the representative <a class="uri" href="gradient" title="wikilink">gradient</a> at the trigger point can be used to accomplish the correction.</p>
<h2 id="available-code">Available Code</h2>

<p>Potash SU is a package including <a href="Seismic_Unix" title="wikilink">Seismic Unix</a> style codes developed by Balazs Nemeth, it provides a <a class="uri" href="subroutine" title="wikilink">subroutine</a> called simple window-based first break picker, the figure shows the seismic images before and after the application of subroutine. </p>
<h2 id="future-trend-of-the-topic">Future Trend of the Topic</h2>

<p>Methods of Picking: automatic first-break picking has played an important role in seismic data processing, and directly influences the quality of seismic sections. Because of the increase of <a href="seismic_survey" title="wikilink">seismic survey</a> size, more efficient and fast first break picking methods are needed, with parallel methods being preferred.</p>

<p>Application of First Break detection: Traditionally the <a class="uri" href="geophysicist" title="wikilink">geophysicist</a> uses first breaks for static correction. First break signal can also be used as observation data for history matching.</p>
<h2 id="notes">Notes</h2>

<p>"</p>

<p><a class="uri" href="Category:Acoustics" title="wikilink">Category:Acoustics</a> <a class="uri" href="Category:Seismology" title="wikilink">Category:Seismology</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1"></li>
<li id="fn2"></li>
<li id="fn3"></li>
<li id="fn4"></li>
<li id="fn5"></li>
<li id="fn6"></li>
<li id="fn7"></li>
<li id="fn8"></li>
<li id="fn9"></li>
<li id="fn10"></li>
<li id="fn11"></li>
</ol>
</section>
</body>
</html>

<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="1467">Beta-binomial distribution</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Beta-binomial distribution</h1>
<hr/>

<p>\!|</p>

<p><code> | kurtosis   = See text|</code><br/>
<code> | entropy    =|</code><br/>
<code> | mgf        =</code>

<math display="inline" id="Beta-binomial_distribution:0">
 <semantics>
  <mrow>
   <mmultiscripts>
    <mi>F</mi>
    <mn>1</mn>
    <none></none>
    <mprescripts></mprescripts>
    <mn>2</mn>
    <none></none>
   </mmultiscripts>
   <mrow>
    <mo stretchy="false">(</mo>
    <mrow>
     <mo>-</mo>
     <mi>n</mi>
    </mrow>
    <mo>,</mo>
    <mi>α</mi>
    <mo>;</mo>
    <mrow>
     <mi>α</mi>
     <mo>+</mo>
     <mi>β</mi>
    </mrow>
    <mo>;</mo>
    <mrow>
     <mn>1</mn>
     <mo>-</mo>
     <msup>
      <mi>e</mi>
      <mi>t</mi>
     </msup>
    </mrow>
    <mo rspace="0.8pt" stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>F</ci>
      <cn type="integer">1</cn>
     </apply>
     <cn type="integer">2</cn>
    </apply>
    <vector>
     <apply>
      <minus></minus>
      <ci>n</ci>
     </apply>
     <ci>α</ci>
     <apply>
      <plus></plus>
      <ci>α</ci>
      <ci>β</ci>
     </apply>
     <apply>
      <minus></minus>
      <cn type="integer">1</cn>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>e</ci>
       <ci>t</ci>
      </apply>
     </apply>
    </vector>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   {}_{2}F_{1}(-n,\alpha;\alpha+\beta;1-e^{t})\!
  </annotation>
 </semantics>
</math>

<code> </code><br/>
<code> </code>

<math display="inline" id="Beta-binomial_distribution:1">
 <semantics>
  <mrow>
   <mrow>
    <mtext>for</mtext>
    <mi>t</mi>
   </mrow>
   <mo><</mo>
   <mrow>
    <msub>
     <mi>log</mi>
     <mi>e</mi>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <mn>2</mn>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <lt></lt>
    <apply>
     <times></times>
     <mtext>for</mtext>
     <ci>t</ci>
    </apply>
    <apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <log></log>
      <ci>e</ci>
     </apply>
     <cn type="integer">2</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \text{for }t<\log_{e}(2)
  </annotation>
 </semantics>
</math>

<code>|</code><br/>
<code> | char       =</code>

<math display="inline" id="Beta-binomial_distribution:2">
 <semantics>
  <mrow>
   <mmultiscripts>
    <mi>F</mi>
    <mn>1</mn>
    <none></none>
    <mprescripts></mprescripts>
    <mn>2</mn>
    <none></none>
   </mmultiscripts>
   <mrow>
    <mo stretchy="false">(</mo>
    <mrow>
     <mo>-</mo>
     <mi>n</mi>
    </mrow>
    <mo>,</mo>
    <mi>α</mi>
    <mo>;</mo>
    <mrow>
     <mi>α</mi>
     <mo>+</mo>
     <mi>β</mi>
    </mrow>
    <mo>;</mo>
    <mrow>
     <mn>1</mn>
     <mo>-</mo>
     <msup>
      <mi>e</mi>
      <mrow>
       <mi>i</mi>
       <mi>t</mi>
      </mrow>
     </msup>
    </mrow>
    <mo rspace="0.8pt" stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>F</ci>
      <cn type="integer">1</cn>
     </apply>
     <cn type="integer">2</cn>
    </apply>
    <vector>
     <apply>
      <minus></minus>
      <ci>n</ci>
     </apply>
     <ci>α</ci>
     <apply>
      <plus></plus>
      <ci>α</ci>
      <ci>β</ci>
     </apply>
     <apply>
      <minus></minus>
      <cn type="integer">1</cn>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>e</ci>
       <apply>
        <times></times>
        <ci>i</ci>
        <ci>t</ci>
       </apply>
      </apply>
     </apply>
    </vector>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   {}_{2}F_{1}(-n,\alpha;\alpha+\beta;1-e^{it})\!
  </annotation>
 </semantics>
</math>

<code> </code><br/>


<math display="inline" id="Beta-binomial_distribution:3">
 <semantics>
  <mrow>
   <mrow>
    <mtext>for</mtext>
    <mrow>
     <mo stretchy="false">|</mo>
     <mi>t</mi>
     <mo stretchy="false">|</mo>
    </mrow>
   </mrow>
   <mo><</mo>
   <mrow>
    <msub>
     <mi>log</mi>
     <mi>e</mi>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <mn>2</mn>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <lt></lt>
    <apply>
     <times></times>
     <mtext>for</mtext>
     <apply>
      <abs></abs>
      <ci>t</ci>
     </apply>
    </apply>
    <apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <log></log>
      <ci>e</ci>
     </apply>
     <cn type="integer">2</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \text{for }|t|<\log_{e}(2)
  </annotation>
 </semantics>
</math>

<code>|</code></p>

<p><code>  }}</code></p>

<p>In <a href="probability_theory" title="wikilink">probability theory</a> and <a class="uri" href="statistics" title="wikilink">statistics</a>, the <strong>beta-binomial distribution</strong> is a family of discrete <a href="probability_distribution" title="wikilink">probability distributions</a> on a finite support of non-negative integers arising when the probability of success in each of a fixed or known number of <a href="Bernoulli_trial" title="wikilink">Bernoulli trials</a> is either unknown or random. The beta-binomial distribution is the <a href="binomial_distribution" title="wikilink">binomial distribution</a> in which the probability of success at each trial is not fixed but random and follows the <a href="beta_distribution" title="wikilink">beta distribution</a>. It is frequently used in <a href="Bayesian_statistics" title="wikilink">Bayesian statistics</a>, <a href="empirical_Bayes_methods" title="wikilink">empirical Bayes methods</a> and <a href="classical_statistics" title="wikilink">classical statistics</a> as an <a href="overdispersion" title="wikilink">overdispersed</a> binomial distribution.</p>

<p>It reduces to the <a href="Bernoulli_distribution" title="wikilink">Bernoulli distribution</a> as a special case when <em>n</em> = 1. For <em>α</em> = <em>β</em> = 1, it is the <a href="discrete_uniform_distribution" title="wikilink">discrete uniform distribution</a> from 0 to <em>n</em>. It also approximates the <a href="binomial_distribution" title="wikilink">binomial distribution</a> arbitrarily well for large <em>α</em> and <em>β</em>. The beta-binomial is a one-dimensional version of the <a href="Dirichlet-multinomial_distribution" title="wikilink">Dirichlet-multinomial distribution</a>, as the binomial and beta distributions are special cases of the <a href="multinomial_distribution" title="wikilink">multinomial</a> and <a href="Dirichlet_distribution" title="wikilink">Dirichlet distributions</a>, respectively.</p>
<h2 id="motivation-and-derivation">Motivation and derivation</h2>
<h3 id="beta-binomial-distribution-as-a-compound-distribution">Beta-binomial distribution as a compound distribution</h3>

<p>The <a href="Beta_distribution" title="wikilink">Beta distribution</a> is a <a href="conjugate_prior" title="wikilink">conjugate distribution</a> of the <a href="binomial_distribution" title="wikilink">binomial distribution</a>. This fact leads to an analytically tractable <a href="compound_distribution" title="wikilink">compound distribution</a> where one can think of the 

<math display="inline" id="Beta-binomial_distribution:4">
 <semantics>
  <mi>p</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>p</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p
  </annotation>
 </semantics>
</math>

 parameter in the binomial distribution as being randomly drawn from a beta distribution. Namely, if</p>

<p>

<math display="inline" id="Beta-binomial_distribution:5">
 <semantics>
  <mi>X</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>X</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle X
  </annotation>
 </semantics>
</math>


</p>

<p>where Bin(n,p) stands for the <a href="binomial_distribution" title="wikilink">binomial distribution</a>, and where <em>p</em> is a <a href="random_variable" title="wikilink">random variable</a> with a <a href="beta_distribution" title="wikilink">beta distribution</a>.</p>

<p>

<math display="inline" id="Beta-binomial_distribution:6">
 <semantics>
  <mrow>
   <mi>π</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>p</mi>
    <mo stretchy="false">|</mo>
    <mi>α</mi>
    <mo>,</mo>
    <mi>β</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">π</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">p</csymbol>
     <ci>normal-|</ci>
     <csymbol cd="unknown">α</csymbol>
     <ci>normal-,</ci>
     <csymbol cd="unknown">β</csymbol>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle\pi(p|\alpha,\beta)
  </annotation>
 </semantics>
</math>


 then the compound distribution is given by</p>

<p>

<math display="inline" id="Beta-binomial_distribution:7">
 <semantics>
  <mrow>
   <mi>f</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>k</mi>
    <mo stretchy="false">|</mo>
    <mi>n</mi>
    <mo>,</mo>
    <mi>α</mi>
    <mo>,</mo>
    <mi>β</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">f</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">k</csymbol>
     <ci>normal-|</ci>
     <csymbol cd="unknown">n</csymbol>
     <ci>normal-,</ci>
     <csymbol cd="unknown">α</csymbol>
     <ci>normal-,</ci>
     <csymbol cd="unknown">β</csymbol>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle f(k|n,\alpha,\beta)
  </annotation>
 </semantics>
</math>


 Using the properties of the <a href="beta_function" title="wikilink">beta function</a>, this can alternatively be written</p>

<p>

<math display="block" id="Beta-binomial_distribution:8">
 <semantics>
  <mrow>
   <mi>f</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>k</mi>
    <mo stretchy="false">|</mo>
    <mi>n</mi>
    <mo>,</mo>
    <mi>α</mi>
    <mo>,</mo>
    <mi>β</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>=</mo>
   <mfrac>
    <mrow>
     <mi mathvariant="normal">Γ</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mi>n</mi>
       <mo>+</mo>
       <mn>1</mn>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mrow>
     <mi mathvariant="normal">Γ</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mi>k</mi>
       <mo>+</mo>
       <mn>1</mn>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <mi mathvariant="normal">Γ</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mrow>
        <mi>n</mi>
        <mo>-</mo>
        <mi>k</mi>
       </mrow>
       <mo>+</mo>
       <mn>1</mn>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mfrac>
   <mfrac>
    <mrow>
     <mi mathvariant="normal">Γ</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mi>k</mi>
       <mo>+</mo>
       <mi>α</mi>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <mi mathvariant="normal">Γ</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mrow>
        <mi>n</mi>
        <mo>-</mo>
        <mi>k</mi>
       </mrow>
       <mo>+</mo>
       <mi>β</mi>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mrow>
     <mi mathvariant="normal">Γ</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mi>n</mi>
       <mo>+</mo>
       <mi>α</mi>
       <mo>+</mo>
       <mi>β</mi>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mfrac>
   <mfrac>
    <mrow>
     <mi mathvariant="normal">Γ</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mi>α</mi>
       <mo>+</mo>
       <mi>β</mi>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mrow>
     <mi mathvariant="normal">Γ</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>α</mi>
      <mo stretchy="false">)</mo>
     </mrow>
     <mi mathvariant="normal">Γ</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>β</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mfrac>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">f</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">k</csymbol>
     <ci>normal-|</ci>
     <csymbol cd="unknown">n</csymbol>
     <ci>normal-,</ci>
     <csymbol cd="unknown">α</csymbol>
     <ci>normal-,</ci>
     <csymbol cd="unknown">β</csymbol>
     <ci>normal-)</ci>
    </cerror>
    <eq></eq>
    <apply>
     <divide></divide>
     <apply>
      <times></times>
      <ci>normal-Γ</ci>
      <apply>
       <plus></plus>
       <ci>n</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <apply>
      <times></times>
      <ci>normal-Γ</ci>
      <apply>
       <plus></plus>
       <ci>k</ci>
       <cn type="integer">1</cn>
      </apply>
      <ci>normal-Γ</ci>
      <apply>
       <plus></plus>
       <apply>
        <minus></minus>
        <ci>n</ci>
        <ci>k</ci>
       </apply>
       <cn type="integer">1</cn>
      </apply>
     </apply>
    </apply>
    <apply>
     <divide></divide>
     <apply>
      <times></times>
      <ci>normal-Γ</ci>
      <apply>
       <plus></plus>
       <ci>k</ci>
       <ci>α</ci>
      </apply>
      <ci>normal-Γ</ci>
      <apply>
       <plus></plus>
       <apply>
        <minus></minus>
        <ci>n</ci>
        <ci>k</ci>
       </apply>
       <ci>β</ci>
      </apply>
     </apply>
     <apply>
      <times></times>
      <ci>normal-Γ</ci>
      <apply>
       <plus></plus>
       <ci>n</ci>
       <ci>α</ci>
       <ci>β</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <divide></divide>
     <apply>
      <times></times>
      <ci>normal-Γ</ci>
      <apply>
       <plus></plus>
       <ci>α</ci>
       <ci>β</ci>
      </apply>
     </apply>
     <apply>
      <times></times>
      <ci>normal-Γ</ci>
      <ci>α</ci>
      <ci>normal-Γ</ci>
      <ci>β</ci>
     </apply>
    </apply>
    <ci>normal-.</ci>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f(k|n,\alpha,\beta)=\frac{\Gamma(n+1)}{\Gamma(k+1)\Gamma(n-k+1)}\frac{\Gamma(k%
+\alpha)\Gamma(n-k+\beta)}{\Gamma(n+\alpha+\beta)}\frac{\Gamma(\alpha+\beta)}{%
\Gamma(\alpha)\Gamma(\beta)}.
  </annotation>
 </semantics>
</math>

 It is within this context that the beta-binomial distribution appears often in Bayesian statistics: the beta-binomial is the <a href="posterior_predictive_distribution" title="wikilink">posterior predictive distribution</a> of a binomial random variable with a <a href="beta_distribution" title="wikilink">beta distribution</a> <a href="prior_probability" title="wikilink">prior</a> on the success probability.</p>
<h3 id="beta-binomial-as-an-urn-model">Beta-binomial as an urn model</h3>

<p>The beta-binomial distribution can also be motivated via an <a href="urn_model" title="wikilink">urn model</a> for positive <a class="uri" href="integer" title="wikilink">integer</a> values of α and β, known as the <a href="Polya_urn_model" title="wikilink">Polya urn model</a>. Specifically, imagine an urn containing α red balls and β black balls, where random draws are made. If a red ball is observed, then two red balls are returned to the urn. Likewise, if a black ball is drawn, then two black balls are returned to the urn. If this is repeated n times, then the probability of observing k red balls follows a beta-binomial distribution with parameters n,α and β.</p>

<p>Note that if the random draws are with simple replacement (no balls over and above the observed ball are added to the urn), then the distribution follows a binomial distribution and if the random draws are made without replacement, the distribution follows a <a href="hypergeometric_distribution" title="wikilink">hypergeometric distribution</a>.</p>
<h2 id="moments-and-properties">Moments and properties</h2>

<p>The first three raw <a href="moment_(mathematics)" title="wikilink">moments</a> are</p>
<dl>
<dd><dl>
<dd><math>
</math></dd>
</dl>
</dd>
</dl>

<p><code>\begin{align} </code><br/>
<code>  \mu_1 &amp; =\frac{n\alpha}{\alpha+\beta} \\[8pt]</code><br/>
<code>  \mu_2 &amp; =\frac{n\alpha[n(1+\alpha)+\beta]}{(\alpha+\beta)(1+\alpha+\beta)}\\[8pt]</code><br/>
<code>  \mu_3 &amp; =\frac{n\alpha[n^{2}(1+\alpha)(2+\alpha)+3n(1+\alpha)\beta+\beta(\beta-\alpha)]}{(\alpha+\beta)(1+\alpha+\beta)(2+\alpha+\beta)}</code><br/>
<code>\end{align}</code></p>

<p></p>

<p>and the <a class="uri" href="kurtosis" title="wikilink">kurtosis</a> is</p>
<dl>
<dd><dl>
<dd><math>
</math></dd>
</dl>
</dd>
</dl>

<p><code>  \beta_2 = \frac{(\alpha + \beta)^2 (1+\alpha+\beta)}{n \alpha \beta( \alpha + \beta + 2)(\alpha + \beta + 3)(\alpha + \beta + n) } \left[ (\alpha + \beta)(\alpha + \beta - 1 + 6n) + 3 \alpha\beta(n - 2) + 6n^2 -\frac{3\alpha\beta n(6-n)}{\alpha + \beta} - \frac{18\alpha\beta n^{2}}{(\alpha+\beta)^2} \right].</code></p>

<p></p>

<p>Letting 

<math display="inline" id="Beta-binomial_distribution:9">
 <semantics>
  <mrow>
   <mi>π</mi>
   <mo>=</mo>
   <mpadded width="-1.7pt">
    <mfrac>
     <mi>α</mi>
     <mrow>
      <mi>α</mi>
      <mo>+</mo>
      <mi>β</mi>
     </mrow>
    </mfrac>
   </mpadded>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>π</ci>
    <apply>
     <divide></divide>
     <ci>α</ci>
     <apply>
      <plus></plus>
      <ci>α</ci>
      <ci>β</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \pi=\frac{\alpha}{\alpha+\beta}\!
  </annotation>
 </semantics>
</math>

 we note, suggestively, that the mean can be written as</p>
<dl>
<dd><dl>
<dd><math>
</math></dd>
</dl>
</dd>
</dl>

<p>\mu = \frac{n\alpha}{\alpha+\beta}=n\pi \!</p>

<p>and the variance as</p>
<dl>
<dd><dl>
<dd><math>
</math></dd>
</dl>
</dd>
</dl>

<p>\sigma^2 = \frac{n\alpha\beta(\alpha+\beta+n)}{(\alpha+\beta)^2(\alpha+\beta+1)}</p>

<p><code>= n\pi(1-\pi) \frac{\alpha + \beta + n}{\alpha + \beta + 1} = n\pi(1-\pi)[1+(n-1)\rho]</code></p>

<p>\!</p>

<p>where 

<math display="inline" id="Beta-binomial_distribution:10">
 <semantics>
  <mrow>
   <mi>ρ</mi>
   <mo>=</mo>
   <mpadded width="-1.7pt">
    <mfrac>
     <mn>1</mn>
     <mrow>
      <mi>α</mi>
      <mo>+</mo>
      <mi>β</mi>
      <mo>+</mo>
      <mn>1</mn>
     </mrow>
    </mfrac>
   </mpadded>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>ρ</ci>
    <apply>
     <divide></divide>
     <cn type="integer">1</cn>
     <apply>
      <plus></plus>
      <ci>α</ci>
      <ci>β</ci>
      <cn type="integer">1</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \rho=\tfrac{1}{\alpha+\beta+1}\!
  </annotation>
 </semantics>
</math>

 is the pairwise correlation between the <em>n</em> Bernoulli draws and is called the over-dispersion parameter.</p>

<p><a href="Recurrence_relation" title="wikilink">Recurrence relation</a></p>

<p>

<math display="inline" id="Beta-binomial_distribution:11">
 <semantics>
  <mrow>
   <mo>{</mo>
   <mrow>
    <mrow>
     <mrow>
      <mrow>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mi>α</mi>
         <mo>+</mo>
         <mi>k</mi>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mi>n</mi>
         <mo>-</mo>
         <mi>k</mi>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
       <mi>p</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>k</mi>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
      <mo>-</mo>
      <mrow>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mi>k</mi>
         <mo>+</mo>
         <mn>1</mn>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
       <mi>p</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mi>k</mi>
         <mo>+</mo>
         <mn>1</mn>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mrow>
          <mrow>
           <mi>β</mi>
           <mo>-</mo>
           <mi>k</mi>
          </mrow>
          <mo>+</mo>
          <mi>n</mi>
         </mrow>
         <mo>-</mo>
         <mn>1</mn>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
     </mrow>
     <mo>=</mo>
     <mn>0</mn>
    </mrow>
    <mo>,</mo>
    <mrow>
     <mrow>
      <mi>p</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mn>0</mn>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo>=</mo>
     <mfrac>
      <msub>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>β</mi>
        <mo stretchy="false">)</mo>
       </mrow>
       <mi>n</mi>
      </msub>
      <msub>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mi>α</mi>
         <mo>+</mo>
         <mi>β</mi>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
       <mi>n</mi>
      </msub>
     </mfrac>
    </mrow>
   </mrow>
   <mo>}</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <set>
    <apply>
     <csymbol cd="ambiguous">formulae-sequence</csymbol>
     <apply>
      <eq></eq>
      <apply>
       <minus></minus>
       <apply>
        <times></times>
        <apply>
         <plus></plus>
         <ci>α</ci>
         <ci>k</ci>
        </apply>
        <apply>
         <minus></minus>
         <ci>n</ci>
         <ci>k</ci>
        </apply>
        <ci>p</ci>
        <ci>k</ci>
       </apply>
       <apply>
        <times></times>
        <apply>
         <plus></plus>
         <ci>k</ci>
         <cn type="integer">1</cn>
        </apply>
        <ci>p</ci>
        <apply>
         <plus></plus>
         <ci>k</ci>
         <cn type="integer">1</cn>
        </apply>
        <apply>
         <minus></minus>
         <apply>
          <plus></plus>
          <apply>
           <minus></minus>
           <ci>β</ci>
           <ci>k</ci>
          </apply>
          <ci>n</ci>
         </apply>
         <cn type="integer">1</cn>
        </apply>
       </apply>
      </apply>
      <cn type="integer">0</cn>
     </apply>
     <apply>
      <eq></eq>
      <apply>
       <times></times>
       <ci>p</ci>
       <cn type="integer">0</cn>
      </apply>
      <apply>
       <divide></divide>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>β</ci>
        <ci>n</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <apply>
         <plus></plus>
         <ci>α</ci>
         <ci>β</ci>
        </apply>
        <ci>n</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </set>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \left\{(\alpha+k)(n-k)p(k)-(k+1)p(k+1)(\beta-k+n-1)=0,p(0)=\frac{(\beta)_{n}}{%
(\alpha+\beta)_{n}}\right\}
  </annotation>
 </semantics>
</math>

</p>
<h2 id="point-estimates">Point estimates</h2>
<h3 id="method-of-moments">Method of moments</h3>

<p>The <a href="Method_of_moments_(statistics)" title="wikilink">method of moments</a> estimates can be gained by noting the first and second moments of the beta-binomial namely</p>
<dl>
<dd><dl>
<dd><math>
</math></dd>
</dl>
</dd>
</dl>

<p><code>\begin{align} </code><br/>
<code>  \mu_1 &amp; =\frac{n\alpha}{\alpha+\beta} \\</code><br/>
<code> \mu_2 &amp; =\frac{n\alpha[n(1+\alpha)+\beta]}{(\alpha+\beta)(1+\alpha+\beta)}</code><br/>
<code>\end{align}</code></p>

<p></p>

<p>and setting these raw moments equal to the first and second raw <a href="sample_moments" title="wikilink">sample moments</a> respectively</p>
<dl>
<dd><dl>
<dd><math>
</math></dd>
</dl>
</dd>
</dl>

<p><code>\begin{align}</code><br/>
<code>  \hat{\mu}_1 &amp; = m_1 \\</code><br/>
<code> \hat{\mu}_2 &amp; =m_2</code><br/>
<code>\end{align}</code></p>

<p> and solving for <em>α</em> and <em>β</em> we get</p>
<dl>
<dd><dl>
<dd><math>
</math></dd>
</dl>
</dd>
</dl>

<p><code>\begin{align} </code><br/>
<code>  \hat{\alpha} &amp; =\frac{nm_1-m_2}{n(\frac{m_2}{m_1}-m_1-1)+m_1} \\</code><br/>
<code>  \hat{\beta} &amp; =\frac{(n-m_1)(n-\frac{m_2}{m_1})}{n(\frac{m_2}{m_1}-m_1 - 1)+m_1}.</code><br/>
<code>\end{align}</code></p>

<p> Note that these estimates can be non-sensically negative which is evidence that the data is either undispersed or underdispersed relative to the binomial distribution. In this case, the binomial distribution and the <a href="hypergeometric_distribution" title="wikilink">hypergeometric distribution</a> are alternative candidates respectively.</p>
<h3 id="maximum-likelihood-estimation">Maximum likelihood estimation</h3>

<p>While closed-form <a href="Maximum_likelihood" title="wikilink">maximum likelihood estimates</a> are impractical, given that the pdf consists of common functions (gamma function and/or Beta functions), they can be easily found via direct numerical optimization. Maximum likelihood estimates from empirical data can be computed using general methods for fitting multinomial Pólya distributions, methods for which are described in <a href="#Minka2003" title="wikilink">(Minka 2003).</a> The <a href="R_(programming_language)" title="wikilink">R</a> package VGAM through the function vglm, via maximum likelihood, facilitates the fitting of <a href="generalized_linear_model" title="wikilink">glm</a> type models with responses distributed according to the beta-binomial distribution. Note also that there is no requirement that n is fixed throughout the observations.</p>
<h3 id="example">Example</h3>

<p>The following data gives the number of male children among the first 12 children of family size 13 in 6115 families taken from hospital records in 19th century <a class="uri" href="Saxony" title="wikilink">Saxony</a> (Sokal and Rohlf, p. 59 from Lindsey). The 13th child is ignored to assuage the effect of families non-randomly stopping when a desired gender is reached.</p>
<table>
<tbody>
<tr class="odd">
<td style="text-align: left;">
<p><strong>Males</strong></p></td>
<td style="text-align: left;">
<p>0</p></td>
<td style="text-align: left;">
<p>1</p></td>
<td style="text-align: left;">
<p>2</p></td>
<td style="text-align: left;">
<p>3</p></td>
<td style="text-align: left;">
<p>4</p></td>
<td style="text-align: left;">
<p>5</p></td>
<td style="text-align: left;">
<p>6</p></td>
<td style="text-align: left;">
<p>7</p></td>
<td style="text-align: left;">
<p>8</p></td>
<td style="text-align: left;">
<p>9</p></td>
<td style="text-align: left;">
<p>10</p></td>
<td style="text-align: left;">
<p>11</p></td>
<td style="text-align: left;">
<p>12</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p><strong>Families</strong></p></td>
<td style="text-align: left;">
<p>3</p></td>
<td style="text-align: left;">
<p>24</p></td>
<td style="text-align: left;">
<p>104</p></td>
<td style="text-align: left;">
<p>286</p></td>
<td style="text-align: left;">
<p>670</p></td>
<td style="text-align: left;">
<p>1033</p></td>
<td style="text-align: left;">
<p>1343</p></td>
<td style="text-align: left;">
<p>1112</p></td>
<td style="text-align: left;">
<p>829</p></td>
<td style="text-align: left;">
<p>478</p></td>
<td style="text-align: left;">
<p>181</p></td>
<td style="text-align: left;">
<p>45</p></td>
<td style="text-align: left;">
<p>7</p></td>
</tr>
</tbody>
</table>

<p>We note the first two sample moments are</p>
<dl>
<dd><dl>
<dd><math>
</math></dd>
</dl>
</dd>
</dl>

<p><code>\begin{align} </code><br/>
<code>  m_1 &amp; = 6.23\\</code><br/>
<code>  m_2 &amp; = 42.31 \\</code><br/>
<code>    n &amp; = 12</code><br/>
<code>\end{align}</code></p>

<p> and therefore the method of moments estimates are</p>
<dl>
<dd><dl>
<dd><math>
</math></dd>
</dl>
</dd>
</dl>

<p><code>\begin{align} </code><br/>
<code>  \hat{\alpha} &amp; = 34.1350\\</code><br/>
<code>  \hat{\beta} &amp; = 31.6085.</code><br/>
<code>\end{align}</code></p>

<p></p>

<p>The <a href="maximum_likelihood" title="wikilink">maximum likelihood</a> estimates can be found numerically</p>
<dl>
<dd><dl>
<dd><math>
</math></dd>
</dl>
</dd>
</dl>

<p><code>\begin{align} </code><br/>
<code>  \hat\alpha_\mathrm{mle} &amp; = 34.09558\\</code><br/>
<code>  \hat\beta_\mathrm{mle} &amp; = 31.5715</code><br/>
<code>\end{align}</code></p>

<p> and the maximized log-likelihood is</p>
<dl>
<dd><dl>
<dd><math>
</math></dd>
</dl>
</dd>
</dl>

<p><code>  \log \mathcal{L} = -12492.9</code></p>

<p></p>

<p>from which we find the <a href="Akaike_information_criterion" title="wikilink">AIC</a></p>
<dl>
<dd><dl>
<dd><math>
</math></dd>
</dl>
</dd>
</dl>

<p><code>  \mathit{AIC}=24989.74.</code></p>

<p></p>

<p>The AIC for the competing binomial model is AIC = 25070.34 and thus we see that the beta-binomial model provides a superior fit to the data i.e. there is evidence for overdispersion. <a href="Trivers–Willard_hypothesis" title="wikilink">Trivers and Willard</a> posit a theoretical justification for heterogeneity (also known as "<a class="uri" href="burstiness" title="wikilink">burstiness</a>") in gender-proneness among families (i.e. overdispersion).</p>

<p>The superior fit is evident especially among the tails</p>
<table>
<tbody>
<tr class="odd">
<td style="text-align: left;">
<p><strong>Males</strong></p></td>
<td style="text-align: left;">
<p>0</p></td>
<td style="text-align: left;">
<p>1</p></td>
<td style="text-align: left;">
<p>2</p></td>
<td style="text-align: left;">
<p>3</p></td>
<td style="text-align: left;">
<p>4</p></td>
<td style="text-align: left;">
<p>5</p></td>
<td style="text-align: left;">
<p>6</p></td>
<td style="text-align: left;">
<p>7</p></td>
<td style="text-align: left;">
<p>8</p></td>
<td style="text-align: left;">
<p>9</p></td>
<td style="text-align: left;">
<p>10</p></td>
<td style="text-align: left;">
<p>11</p></td>
<td style="text-align: left;">
<p>12</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p><strong>Observed Families</strong></p></td>
<td style="text-align: left;">
<p>3</p></td>
<td style="text-align: left;">
<p>24</p></td>
<td style="text-align: left;">
<p>104</p></td>
<td style="text-align: left;">
<p>286</p></td>
<td style="text-align: left;">
<p>670</p></td>
<td style="text-align: left;">
<p>1033</p></td>
<td style="text-align: left;">
<p>1343</p></td>
<td style="text-align: left;">
<p>1112</p></td>
<td style="text-align: left;">
<p>829</p></td>
<td style="text-align: left;">
<p>478</p></td>
<td style="text-align: left;">
<p>181</p></td>
<td style="text-align: left;">
<p>45</p></td>
<td style="text-align: left;">
<p>7</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p><strong>Predicted (Beta-Binomial)</strong></p></td>
<td style="text-align: left;">
<p>2.3</p></td>
<td style="text-align: left;">
<p>22.6</p></td>
<td style="text-align: left;">
<p>104.8</p></td>
<td style="text-align: left;">
<p>310.9</p></td>
<td style="text-align: left;">
<p>655.7</p></td>
<td style="text-align: left;">
<p>1036.2</p></td>
<td style="text-align: left;">
<p>1257.9</p></td>
<td style="text-align: left;">
<p>1182.1</p></td>
<td style="text-align: left;">
<p>853.6</p></td>
<td style="text-align: left;">
<p>461.9</p></td>
<td style="text-align: left;">
<p>177.9</p></td>
<td style="text-align: left;">
<p>43.8</p></td>
<td style="text-align: left;">
<p>5.2</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p><strong>Predicted (Binomial <em>p</em> = 0.519215)</strong></p></td>
<td style="text-align: left;">
<p>0.9</p></td>
<td style="text-align: left;">
<p>12.1</p></td>
<td style="text-align: left;">
<p>71.8</p></td>
<td style="text-align: left;">
<p>258.5</p></td>
<td style="text-align: left;">
<p>628.1</p></td>
<td style="text-align: left;">
<p>1085.2</p></td>
<td style="text-align: left;">
<p>1367.3</p></td>
<td style="text-align: left;">
<p>1265.6</p></td>
<td style="text-align: left;">
<p>854.2</p></td>
<td style="text-align: left;">
<p>410.0</p></td>
<td style="text-align: left;">
<p>132.8</p></td>
<td style="text-align: left;">
<p>26.1</p></td>
<td style="text-align: left;">
<p>2.3</p></td>
</tr>
</tbody>
</table>
<h2 id="further-bayesian-considerations">Further Bayesian considerations</h2>

<p>It is convenient to reparameterize the distributions so that the expected mean of the prior is a single parameter: Let</p>

<p>

<math display="inline" id="Beta-binomial_distribution:12">
 <semantics>
  <mrow>
   <mi>π</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>θ</mi>
    <mo stretchy="false">|</mo>
    <mi>μ</mi>
    <mo>,</mo>
    <mi>M</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">π</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">θ</csymbol>
     <ci>normal-|</ci>
     <csymbol cd="unknown">μ</csymbol>
     <ci>normal-,</ci>
     <csymbol cd="unknown">M</csymbol>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle\pi(\theta|\mu,M)
  </annotation>
 </semantics>
</math>


</p>

<p>where</p>
<dl>
<dd><dl>
<dd><math>
</math></dd>
</dl>
</dd>
</dl>

<p><code>\begin{align}</code><br/>
<code>  \mu &amp;= \frac{\alpha}{\alpha+\beta}  \\</code><br/>
<code>    M &amp;= \alpha+\beta</code><br/>
<code>\end{align}</code><br/>
</p>

<p>so that</p>
<dl>
<dd><dl>
<dd><math>
</math></dd>
</dl>
</dd>
</dl>

<p><code>\begin{align}</code><br/>
<code> \operatorname{E}(\theta|\mu,M)   &amp; = \mu \\ </code><br/>
<code> \operatorname{Var}(\theta|\mu,M) &amp; = \frac{\mu(1-\mu)}{M+1}.</code><br/>
<code>\end{align}</code></p>

<p></p>

<p>The <a href="posterior_distribution" title="wikilink">posterior distribution</a> ρ(θ|k) is also a beta distribution:</p>

<p>

<math display="inline" id="Beta-binomial_distribution:13">
 <semantics>
  <mrow>
   <mi>ρ</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>θ</mi>
    <mo stretchy="false">|</mo>
    <mi>k</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">ρ</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">θ</csymbol>
     <ci>normal-|</ci>
     <csymbol cd="unknown">k</csymbol>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle\rho(\theta|k)
  </annotation>
 </semantics>
</math>


</p>

<p>And</p>

<p>

<math display="block" id="Beta-binomial_distribution:14">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mo>E</mo>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>θ</mi>
      <mo stretchy="false">|</mo>
      <mi>k</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mfrac>
     <mrow>
      <mi>k</mi>
      <mo>+</mo>
      <mrow>
       <mi>M</mi>
       <mi>μ</mi>
      </mrow>
     </mrow>
     <mrow>
      <mi>n</mi>
      <mo>+</mo>
      <mi>M</mi>
     </mrow>
    </mfrac>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <ci>normal-E</ci>
     <ci>θ</ci>
     <ci>k</ci>
    </apply>
    <apply>
     <divide></divide>
     <apply>
      <plus></plus>
      <ci>k</ci>
      <apply>
       <times></times>
       <ci>M</ci>
       <ci>μ</ci>
      </apply>
     </apply>
     <apply>
      <plus></plus>
      <ci>n</ci>
      <ci>M</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \operatorname{E}(\theta|k)=\frac{k+M\mu}{n+M}.
  </annotation>
 </semantics>
</math>

</p>

<p>while the marginal distribution <em>m</em>(<em>k</em>|μ, <em>M</em>) is given by</p>

<p>

<math display="inline" id="Beta-binomial_distribution:15">
 <semantics>
  <mrow>
   <mi>m</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>k</mi>
    <mo stretchy="false">|</mo>
    <mi>μ</mi>
    <mo>,</mo>
    <mi>M</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">m</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">k</csymbol>
     <ci>normal-|</ci>
     <csymbol cd="unknown">μ</csymbol>
     <ci>normal-,</ci>
     <csymbol cd="unknown">M</csymbol>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle m(k|\mu,M)
  </annotation>
 </semantics>
</math>


</p>

<p>Because the marginal is a complex, non-linear function of Gamma and Digamma functions, it is quite difficult to obtain a marginal maximum likelihood estimate (MMLE) for the mean and variance. Instead, we use the method of iterated expectations to find the <a href="expected_value" title="wikilink">expected value</a> of the marginal moments.</p>

<p>Let us write our model as a two-stage compound sampling model. Let <em>k<sub>i</sub></em> be the number of success out of <em>n<sub>i</sub></em> trials for event <em>i</em>:</p>
<dl>
<dd><dl>
<dd><math>
</math></dd>
</dl>
</dd>
</dl>

<p><code>\begin{align} </code><br/>
<code>  k_i &amp; \sim \operatorname{Bin}(n_i, \theta_i) \\</code><br/>
<code>        \theta_i &amp; \sim \operatorname{Beta}(\mu,M),\ \mathrm{i.i.d.}</code><br/>
<code>\end{align}</code></p>

<p></p>

<p>We can find iterated moment estimates for the mean and variance using the moments for the distributions in the two-stage model:</p>
<dl>
<dd><dl>
<dd>

<math display="inline" id="Beta-binomial_distribution:16">
 <semantics>
  <mrow>
   <mrow>
    <mo>E</mo>
    <mrow>
     <mo>(</mo>
     <mfrac>
      <mi>k</mi>
      <mi>n</mi>
     </mfrac>
     <mo>)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mo>E</mo>
    <mrow>
     <mo>[</mo>
     <mrow>
      <mo>E</mo>
      <mrow>
       <mo>(</mo>
       <mfrac>
        <mi>k</mi>
        <mi>n</mi>
       </mfrac>
       <mo>|</mo>
       <mi>θ</mi>
       <mo>)</mo>
      </mrow>
     </mrow>
     <mo>]</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mo>E</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>θ</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mi>μ</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <ci>normal-E</ci>
      <apply>
       <divide></divide>
       <ci>k</ci>
       <ci>n</ci>
      </apply>
     </apply>
     <apply>
      <ci>normal-E</ci>
      <apply>
       <ci>normal-E</ci>
       <apply>
        <divide></divide>
        <ci>k</ci>
        <ci>n</ci>
       </apply>
       <ci>θ</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <ci>normal-E</ci>
      <ci>θ</ci>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <ci>μ</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \operatorname{E}\left(\frac{k}{n}\right)=\operatorname{E}\left[\operatorname{E%
}\left(\left.\frac{k}{n}\right|\theta\right)\right]=\operatorname{E}(\theta)=\mu
  </annotation>
 </semantics>
</math>


</dd>
</dl>
</dd>
</dl>
<dl>
<dd><dl>
<dd><math>
</math></dd>
</dl>
</dd>
</dl>

<p><code>\begin{align} </code><br/>
<code>  \operatorname{var}\left(\frac{k}{n}\right) &amp; = </code><br/>
<code>   \operatorname{E}\left[\operatorname{var}\left(\left.\frac{k}{n}\right|\theta\right)\right] + </code><br/>
<code>   \operatorname{var}\left[\operatorname{E}\left(\left.\frac{k}{n}\right|\theta\right)\right] \\</code><br/>
<code>                                             &amp; = </code><br/>
<code>  \operatorname{E}\left[\left(\left.\frac{1}{n}\right)\theta(1-\theta)\right|\mu,M\right] + </code><br/>
<code>   \operatorname{var}\left(\theta|\mu,M\right) \\</code><br/>
<code>                                             &amp; = </code><br/>
<code>  \frac{1}{n}\left(\mu(1-\mu)\right) + \frac{n-1}{n}\frac{(\mu(1-\mu))}{M+1} \\</code><br/>
<code>                                             &amp; = </code><br/>
<code>  \frac{\mu(1-\mu)}{n}\left(1+\frac{n-1}{M+1}\right).</code><br/>
<code>\end{align}</code></p>

<p></p>

<p>(Here we have used the <a href="law_of_total_expectation" title="wikilink">law of total expectation</a> and the <a href="law_of_total_variance" title="wikilink">law of total variance</a>.)</p>

<p>We want point estimates for 

<math display="inline" id="Beta-binomial_distribution:17">
 <semantics>
  <mi>μ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>μ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mu
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Beta-binomial_distribution:18">
 <semantics>
  <mi>M</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>M</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   M
  </annotation>
 </semantics>
</math>

. The estimated mean 

<math display="inline" id="Beta-binomial_distribution:19">
 <semantics>
  <mover accent="true">
   <mi>μ</mi>
   <mo stretchy="false">^</mo>
  </mover>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-^</ci>
    <ci>μ</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \hat{\mu}
  </annotation>
 </semantics>
</math>

 is calculated from the sample</p>
<dl>
<dd><dl>
<dd>

<math display="inline" id="Beta-binomial_distribution:20">
 <semantics>
  <mrow>
   <mrow>
    <mover accent="true">
     <mi>μ</mi>
     <mo stretchy="false">^</mo>
    </mover>
    <mo>=</mo>
    <mfrac>
     <mrow>
      <mstyle displaystyle="false">
       <msubsup>
        <mo largeop="true" symmetric="true">∑</mo>
        <mrow>
         <mi>i</mi>
         <mo>=</mo>
         <mn>1</mn>
        </mrow>
        <mi>N</mi>
       </msubsup>
      </mstyle>
      <msub>
       <mi>k</mi>
       <mi>i</mi>
      </msub>
     </mrow>
     <mrow>
      <mstyle displaystyle="false">
       <msubsup>
        <mo largeop="true" symmetric="true">∑</mo>
        <mrow>
         <mi>i</mi>
         <mo>=</mo>
         <mn>1</mn>
        </mrow>
        <mi>N</mi>
       </msubsup>
      </mstyle>
      <msub>
       <mi>n</mi>
       <mi>i</mi>
      </msub>
     </mrow>
    </mfrac>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <ci>normal-^</ci>
     <ci>μ</ci>
    </apply>
    <apply>
     <divide></divide>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <apply>
         <eq></eq>
         <ci>i</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <ci>N</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>k</ci>
       <ci>i</ci>
      </apply>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <apply>
         <eq></eq>
         <ci>i</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <ci>N</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>n</ci>
       <ci>i</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \hat{\mu}=\frac{\sum_{i=1}^{N}k_{i}}{\sum_{i=1}^{N}n_{i}}.
  </annotation>
 </semantics>
</math>


</dd>
</dl>
</dd>
</dl>

<p>The estimate of the hyperparameter <em>M</em> is obtained using the moment estimates for the variance of the two-stage model:</p>
<dl>
<dd><dl>
<dd><math>
</math></dd>
</dl>
</dd>
</dl>

<p><code>  s^2 = \frac{1}{N} \sum_{i=1}^N \operatorname{var}\left(\frac{k_{i}}{n_{i}} \right) </code><br/>
<code>        = \frac{1}{N} \sum_{i=1}^N \frac{\hat{\mu}(1-\hat{\mu})}{n_i}</code><br/>
<code>            \left[1+\frac{n_i-1}{\widehat{M}+1}\right]</code></p>

<p></p>

<p>Solving:</p>
<dl>
<dd><dl>
<dd>

<math display="inline" id="Beta-binomial_distribution:21">
 <semantics>
  <mrow>
   <mrow>
    <mover accent="true">
     <mi>M</mi>
     <mo>^</mo>
    </mover>
    <mo>=</mo>
    <mfrac>
     <mrow>
      <mrow>
       <mover accent="true">
        <mi>μ</mi>
        <mo stretchy="false">^</mo>
       </mover>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mn>1</mn>
         <mo>-</mo>
         <mover accent="true">
          <mi>μ</mi>
          <mo stretchy="false">^</mo>
         </mover>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
      <mo>-</mo>
      <msup>
       <mi>s</mi>
       <mn>2</mn>
      </msup>
     </mrow>
     <mrow>
      <msup>
       <mi>s</mi>
       <mn>2</mn>
      </msup>
      <mo>-</mo>
      <mrow>
       <mfrac>
        <mrow>
         <mover accent="true">
          <mi>μ</mi>
          <mo stretchy="false">^</mo>
         </mover>
         <mrow>
          <mo stretchy="false">(</mo>
          <mrow>
           <mn>1</mn>
           <mo>-</mo>
           <mover accent="true">
            <mi>μ</mi>
            <mo stretchy="false">^</mo>
           </mover>
          </mrow>
          <mo stretchy="false">)</mo>
         </mrow>
        </mrow>
        <mi>N</mi>
       </mfrac>
       <mrow>
        <mstyle displaystyle="false">
         <msubsup>
          <mo largeop="true" symmetric="true">∑</mo>
          <mrow>
           <mi>i</mi>
           <mo>=</mo>
           <mn>1</mn>
          </mrow>
          <mi>N</mi>
         </msubsup>
        </mstyle>
        <mrow>
         <mn>1</mn>
         <mo>/</mo>
         <msub>
          <mi>n</mi>
          <mi>i</mi>
         </msub>
        </mrow>
       </mrow>
      </mrow>
     </mrow>
    </mfrac>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <ci>normal-^</ci>
     <ci>M</ci>
    </apply>
    <apply>
     <divide></divide>
     <apply>
      <minus></minus>
      <apply>
       <times></times>
       <apply>
        <ci>normal-^</ci>
        <ci>μ</ci>
       </apply>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
        <apply>
         <ci>normal-^</ci>
         <ci>μ</ci>
        </apply>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>s</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
     <apply>
      <minus></minus>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>s</ci>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <times></times>
       <apply>
        <divide></divide>
        <apply>
         <times></times>
         <apply>
          <ci>normal-^</ci>
          <ci>μ</ci>
         </apply>
         <apply>
          <minus></minus>
          <cn type="integer">1</cn>
          <apply>
           <ci>normal-^</ci>
           <ci>μ</ci>
          </apply>
         </apply>
        </apply>
        <ci>N</ci>
       </apply>
       <apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <sum></sum>
          <apply>
           <eq></eq>
           <ci>i</ci>
           <cn type="integer">1</cn>
          </apply>
         </apply>
         <ci>N</ci>
        </apply>
        <apply>
         <divide></divide>
         <cn type="integer">1</cn>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>n</ci>
          <ci>i</ci>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \widehat{M}=\frac{\hat{\mu}(1-\hat{\mu})-s^{2}}{s^{2}-\frac{\hat{\mu}(1-\hat{%
\mu})}{N}\sum_{i=1}^{N}1/n_{i}},
  </annotation>
 </semantics>
</math>


</dd>
</dl>
</dd>
</dl>

<p>where</p>
<dl>
<dd><dl>
<dd><math>s^2 = \frac{N \sum_{i=1}^N n_i (\hat{\theta_i} - \hat{\mu})^2 }
</math></dd>
</dl>
</dd>
</dl>

<p><code>                 {(N-1)\sum_{i=1}^N n_i }.</code></p>

<p>Since we now have parameter point estimates, 

<math display="inline" id="Beta-binomial_distribution:22">
 <semantics>
  <mover accent="true">
   <mi>μ</mi>
   <mo stretchy="false">^</mo>
  </mover>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-^</ci>
    <ci>μ</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \hat{\mu}
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Beta-binomial_distribution:23">
 <semantics>
  <mover accent="true">
   <mi>M</mi>
   <mo>^</mo>
  </mover>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-^</ci>
    <ci>M</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \widehat{M}
  </annotation>
 </semantics>
</math>

, for the underlying distribution, we would like to find a point estimate 

<math display="inline" id="Beta-binomial_distribution:24">
 <semantics>
  <msub>
   <mover accent="true">
    <mi>θ</mi>
    <mo stretchy="false">~</mo>
   </mover>
   <mi>i</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <apply>
     <ci>normal-~</ci>
     <ci>θ</ci>
    </apply>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \tilde{\theta}_{i}
  </annotation>
 </semantics>
</math>

 for the probability of success for event <em>i</em>. This is the weighted average of the event estimate 

<math display="inline" id="Beta-binomial_distribution:25">
 <semantics>
  <mrow>
   <mover accent="true">
    <msub>
     <mi>θ</mi>
     <mi>i</mi>
    </msub>
    <mo stretchy="false">^</mo>
   </mover>
   <mo>=</mo>
   <mrow>
    <msub>
     <mi>k</mi>
     <mi>i</mi>
    </msub>
    <mo>/</mo>
    <msub>
     <mi>n</mi>
     <mi>i</mi>
    </msub>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <ci>normal-^</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>θ</ci>
      <ci>i</ci>
     </apply>
    </apply>
    <apply>
     <divide></divide>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>k</ci>
      <ci>i</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>n</ci>
      <ci>i</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \hat{\theta_{i}}=k_{i}/n_{i}
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Beta-binomial_distribution:26">
 <semantics>
  <mover accent="true">
   <mi>μ</mi>
   <mo stretchy="false">^</mo>
  </mover>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-^</ci>
    <ci>μ</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \hat{\mu}
  </annotation>
 </semantics>
</math>

. Given our point estimates for the prior, we may now plug in these values to find a point estimate for the posterior</p>
<dl>
<dd><dl>
<dd>

<math display="inline" id="Beta-binomial_distribution:27">
 <semantics>
  <mrow>
   <mover accent="true">
    <msub>
     <mi>θ</mi>
     <mi>i</mi>
    </msub>
    <mo stretchy="false">~</mo>
   </mover>
   <mo>=</mo>
   <mi>E</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>θ</mi>
    <mo stretchy="false">|</mo>
    <msub>
     <mi>k</mi>
     <mi>i</mi>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>=</mo>
   <mfrac>
    <mrow>
     <msub>
      <mi>k</mi>
      <mi>i</mi>
     </msub>
     <mo>+</mo>
     <mrow>
      <mover accent="true">
       <mi>M</mi>
       <mo>^</mo>
      </mover>
      <mover accent="true">
       <mi>μ</mi>
       <mo stretchy="false">^</mo>
      </mover>
     </mrow>
    </mrow>
    <mrow>
     <msub>
      <mi>n</mi>
      <mi>i</mi>
     </msub>
     <mo>+</mo>
     <mover accent="true">
      <mi>M</mi>
      <mo>^</mo>
     </mover>
    </mrow>
   </mfrac>
   <mo>=</mo>
   <mfrac>
    <mover accent="true">
     <mi>M</mi>
     <mo>^</mo>
    </mover>
    <mrow>
     <msub>
      <mi>n</mi>
      <mi>i</mi>
     </msub>
     <mo>+</mo>
     <mover accent="true">
      <mi>M</mi>
      <mo>^</mo>
     </mover>
    </mrow>
   </mfrac>
   <mover accent="true">
    <mi>μ</mi>
    <mo stretchy="false">^</mo>
   </mover>
   <mo>+</mo>
   <mfrac>
    <msub>
     <mi>n</mi>
     <mi>i</mi>
    </msub>
    <mrow>
     <msub>
      <mi>n</mi>
      <mi>i</mi>
     </msub>
     <mo>+</mo>
     <mover accent="true">
      <mi>M</mi>
      <mo>^</mo>
     </mover>
    </mrow>
   </mfrac>
   <mfrac>
    <msub>
     <mi>k</mi>
     <mi>i</mi>
    </msub>
    <msub>
     <mi>n</mi>
     <mi>i</mi>
    </msub>
   </mfrac>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <apply>
     <ci>normal-~</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>θ</ci>
      <ci>i</ci>
     </apply>
    </apply>
    <eq></eq>
    <csymbol cd="unknown">E</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">θ</csymbol>
     <ci>normal-|</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>k</ci>
      <ci>i</ci>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <eq></eq>
    <apply>
     <divide></divide>
     <apply>
      <plus></plus>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>k</ci>
       <ci>i</ci>
      </apply>
      <apply>
       <times></times>
       <apply>
        <ci>normal-^</ci>
        <ci>M</ci>
       </apply>
       <apply>
        <ci>normal-^</ci>
        <ci>μ</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <plus></plus>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>n</ci>
       <ci>i</ci>
      </apply>
      <apply>
       <ci>normal-^</ci>
       <ci>M</ci>
      </apply>
     </apply>
    </apply>
    <eq></eq>
    <apply>
     <divide></divide>
     <apply>
      <ci>normal-^</ci>
      <ci>M</ci>
     </apply>
     <apply>
      <plus></plus>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>n</ci>
       <ci>i</ci>
      </apply>
      <apply>
       <ci>normal-^</ci>
       <ci>M</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <ci>normal-^</ci>
     <ci>μ</ci>
    </apply>
    <plus></plus>
    <apply>
     <divide></divide>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>n</ci>
      <ci>i</ci>
     </apply>
     <apply>
      <plus></plus>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>n</ci>
       <ci>i</ci>
      </apply>
      <apply>
       <ci>normal-^</ci>
       <ci>M</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <divide></divide>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>k</ci>
      <ci>i</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>n</ci>
      <ci>i</ci>
     </apply>
    </apply>
    <ci>normal-.</ci>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \tilde{\theta_{i}}=E(\theta|k_{i})=\frac{k_{i}+\widehat{M}\hat{\mu}}{n_{i}+%
\widehat{M}}=\frac{\widehat{M}}{n_{i}+\widehat{M}}\hat{\mu}+\frac{n_{i}}{n_{i}%
+\widehat{M}}\frac{k_{i}}{n_{i}}.
  </annotation>
 </semantics>
</math>


</dd>
</dl>
</dd>
</dl>
<h2 id="shrinkage-factors">Shrinkage factors</h2>

<p>We may write the posterior estimate as a weighted average:</p>
<dl>
<dd><dl>
<dd>

<math display="inline" id="Beta-binomial_distribution:28">
 <semantics>
  <mrow>
   <msub>
    <mover accent="true">
     <mi>θ</mi>
     <mo stretchy="false">~</mo>
    </mover>
    <mi>i</mi>
   </msub>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mpadded width="+1.7pt">
      <msub>
       <mover accent="true">
        <mi>B</mi>
        <mo stretchy="false">^</mo>
       </mover>
       <mi>i</mi>
      </msub>
     </mpadded>
     <mover accent="true">
      <mi>μ</mi>
      <mo stretchy="false">^</mo>
     </mover>
    </mrow>
    <mo>+</mo>
    <mrow>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mn>1</mn>
       <mo>-</mo>
       <msub>
        <mover accent="true">
         <mi>B</mi>
         <mo stretchy="false">^</mo>
        </mover>
        <mi>i</mi>
       </msub>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <msub>
      <mover accent="true">
       <mi>θ</mi>
       <mo stretchy="false">^</mo>
      </mover>
      <mi>i</mi>
     </msub>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <ci>normal-~</ci>
      <ci>θ</ci>
     </apply>
     <ci>i</ci>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <apply>
        <ci>normal-^</ci>
        <ci>B</ci>
       </apply>
       <ci>i</ci>
      </apply>
      <apply>
       <ci>normal-^</ci>
       <ci>μ</ci>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <apply>
         <ci>normal-^</ci>
         <ci>B</ci>
        </apply>
        <ci>i</ci>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <apply>
        <ci>normal-^</ci>
        <ci>θ</ci>
       </apply>
       <ci>i</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \tilde{\theta}_{i}=\hat{B}_{i}\,\hat{\mu}+(1-\hat{B}_{i})\hat{\theta}_{i}
  </annotation>
 </semantics>
</math>


</dd>
</dl>
</dd>
</dl>

<p>where 

<math display="inline" id="Beta-binomial_distribution:29">
 <semantics>
  <msub>
   <mover accent="true">
    <mi>B</mi>
    <mo stretchy="false">^</mo>
   </mover>
   <mi>i</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <apply>
     <ci>normal-^</ci>
     <ci>B</ci>
    </apply>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \hat{B}_{i}
  </annotation>
 </semantics>
</math>

 is called the <em>shrinkage factor</em>.</p>
<dl>
<dd><dl>
<dd>

<math display="inline" id="Beta-binomial_distribution:30">
 <semantics>
  <mrow>
   <mover accent="true">
    <msub>
     <mi>B</mi>
     <mi>i</mi>
    </msub>
    <mo stretchy="false">^</mo>
   </mover>
   <mo>=</mo>
   <mfrac>
    <mover accent="true">
     <mi>M</mi>
     <mo stretchy="false">^</mo>
    </mover>
    <mrow>
     <mover accent="true">
      <mi>M</mi>
      <mo stretchy="false">^</mo>
     </mover>
     <mo>+</mo>
     <msub>
      <mi>n</mi>
      <mi>i</mi>
     </msub>
    </mrow>
   </mfrac>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <ci>normal-^</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>B</ci>
      <ci>i</ci>
     </apply>
    </apply>
    <apply>
     <divide></divide>
     <apply>
      <ci>normal-^</ci>
      <ci>M</ci>
     </apply>
     <apply>
      <plus></plus>
      <apply>
       <ci>normal-^</ci>
       <ci>M</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>n</ci>
       <ci>i</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \hat{B_{i}}=\frac{\hat{M}}{\hat{M}+n_{i}}
  </annotation>
 </semantics>
</math>


</dd>
</dl>
</dd>
</dl>
<h2 id="related-distributions">Related distributions</h2>
<ul>
<li>

<math display="inline" id="Beta-binomial_distribution:31">
 <semantics>
  <mrow>
   <mrow>
    <mi>B</mi>
    <mi>B</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mn>1</mn>
     <mo>,</mo>
     <mn>1</mn>
     <mo>,</mo>
     <mi>n</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>∼</mo>
   <mrow>
    <mi>U</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mn>0</mn>
     <mo>,</mo>
     <mi>n</mi>
     <mo rspace="4.2pt" stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">similar-to</csymbol>
    <apply>
     <times></times>
     <ci>B</ci>
     <ci>B</ci>
     <vector>
      <cn type="integer">1</cn>
      <cn type="integer">1</cn>
      <ci>n</ci>
     </vector>
    </apply>
    <apply>
     <times></times>
     <ci>U</ci>
     <interval closure="open">
      <cn type="integer">0</cn>
      <ci>n</ci>
     </interval>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   BB(1,1,n)\sim U(0,n)\,
  </annotation>
 </semantics>
</math>

 where 

<math display="inline" id="Beta-binomial_distribution:32">
 <semantics>
  <mrow>
   <mi>U</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>a</mi>
    <mo>,</mo>
    <mi>b</mi>
    <mo rspace="4.2pt" stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>U</ci>
    <interval closure="open">
     <ci>a</ci>
     <ci>b</ci>
    </interval>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   U(a,b)\,
  </annotation>
 </semantics>
</math>

 is the <a href="Uniform_distribution_(discrete)" title="wikilink">discrete uniform distribution</a>.</li>
</ul>
<h2 id="see-also">See also</h2>
<ul>
<li><a href="Dirichlet-multinomial_distribution" title="wikilink">Dirichlet-multinomial distribution</a></li>
</ul>
<h2 id="references">References</h2>
<ul>
<li>

<p>Minka, Thomas P. (2003). <a href="http://research.microsoft.com/~minka/papers/dirichlet/">Estimating a Dirichlet distribution</a>. Microsoft Technical Report.</p></li>
</ul>
<h2 id="external-links">External links</h2>
<ul>
<li><a href="http://it.stlawu.edu/~msch/biometrics/papers.htm">Using the Beta-binomial distribution to assess performance of a biometric identification device</a></li>
<li><a href="http://research.microsoft.com/~minka/software/fastfit/">Fastfit</a> contains Matlab code for fitting Beta-Binomial distributions (in the form of two-dimensional Pólya distributions) to data.</li>
<li>Interactive graphic: <a href="http://www.math.wm.edu/~leemis/chart/UDR/UDR.html">Univariate Distribution Relationships</a></li>
<li><a href="http://www.inside-r.org/packages/cran/VGAM/docs/Betabinom">Beta-Binomial distribution package for R</a></li>
</ul>

<p>"</p>

<p><a href="Category:Conjugate_prior_distributions" title="wikilink">Category:Conjugate prior distributions</a> <a href="Category:Discrete_distributions" title="wikilink">Category:Discrete distributions</a> <a href="Category:Probability_distributions" title="wikilink">Category:Probability distributions</a></p>
</body>
</html>

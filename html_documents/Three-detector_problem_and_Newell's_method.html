<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="1947">Three-detector problem and Newell's method</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Three-detector problem and Newell's method</h1>
<hr/>

<p>The <strong>Three-detector problem</strong><a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a> is a problem in traffic flow theory. Given is a homogeneous freeway and the vehicle counts at two detector stations. We seek the vehicle counts at some intermediate location. The method can be applied to incident detection and diagnosis by comparing the observed and predicted data, so a realistic solution to this problem is important. Newell G.F.<a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a><a class="footnoteRef" href="#fn3" id="fnref3"><sup>3</sup></a><a class="footnoteRef" href="#fn4" id="fnref4"><sup>4</sup></a> proposed a simple method to solve this problem. In <strong>Newell's method</strong>, one gets the cumulative count curve (N-curve) of any intermediate location just by shifting the N-curves of the upstream and downstream detectors. <strong>Newell's method</strong> was developed before the variational theory of traffic flow was proposed to deal systematically with vehicle counts.<a class="footnoteRef" href="#fn5" id="fnref5"><sup>5</sup></a><a class="footnoteRef" href="#fn6" id="fnref6"><sup>6</sup></a><a class="footnoteRef" href="#fn7" id="fnref7"><sup>7</sup></a> This article shows how <strong>Newell's method</strong> fits in the context of variational theory.</p>
<h2 id="a-special-case-to-demonstrate-newells-method">A special case to demonstrate Newell's method</h2>

<p><strong>Assumption.</strong> In this special case, we use the Triangular Fundamental Diagram (TFD) with three parameters: free flow speed 

<math display="inline" id="Three-detector_problem_and_Newell's_method:0">
 <semantics>
  <msub>
   <mi>v</mi>
   <mi>f</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>v</ci>
    <ci>f</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   v_{f}
  </annotation>
 </semantics>
</math>

, wave velocity -w and maximum density 

<math display="inline" id="Three-detector_problem_and_Newell's_method:1">
 <semantics>
  <msub>
   <mi>k</mi>
   <mi>j</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>k</ci>
    <ci>j</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   k_{j}
  </annotation>
 </semantics>
</math>

 (see Figure 1). Additionally, we will consider a long study period where traffic past upstream detector (U) is unrestricted and traffic past downstream detector (D) is restricted so that waves from both boundaries point into the (t,x) solution space (see Figure 2).</p>

<p>The goal of three-detector problem is calculating the vehicle at a generic point (P) on the "world line" of detector M (See Figure 2). <strong>Upstream.</strong> <em>Since</em> the upstream state is uncongested, there must be a characteristic with slope 

<math display="inline" id="Three-detector_problem_and_Newell's_method:2">
 <semantics>
  <msub>
   <mi>v</mi>
   <mi>f</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>v</ci>
    <ci>f</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   v_{f}
  </annotation>
 </semantics>
</math>

 that reaches P from the upstream detector. Such a wave must be emitted 

<math display="inline" id="Three-detector_problem_and_Newell's_method:3">
 <semantics>
  <mrow>
   <msub>
    <mi>τ</mi>
    <mn>1</mn>
   </msub>
   <mo>=</mo>
   <mrow>
    <msub>
     <mi>L</mi>
     <mi>U</mi>
    </msub>
    <mo>/</mo>
    <msub>
     <mi>v</mi>
     <mi>f</mi>
    </msub>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>τ</ci>
     <cn type="integer">1</cn>
    </apply>
    <apply>
     <divide></divide>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>L</ci>
      <ci>U</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>v</ci>
      <ci>f</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \tau_{1}=L_{U}/v_{f}
  </annotation>
 </semantics>
</math>

 times unit earlier, at point P' on the figure. <em>Since</em> the vehicle number does not change along this characteristic, we see that the vehicle number at the M-detector calculated from conditions upstream is the same as that observed at the upstream detector 

<math display="inline" id="Three-detector_problem_and_Newell's_method:4">
 <semantics>
  <msub>
   <mi>τ</mi>
   <mn>1</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>τ</ci>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \tau_{1}
  </annotation>
 </semantics>
</math>

 time units earlier. <em>Since</em> 

<math display="inline" id="Three-detector_problem_and_Newell's_method:5">
 <semantics>
  <msub>
   <mi>τ</mi>
   <mn>1</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>τ</ci>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \tau_{1}
  </annotation>
 </semantics>
</math>

 is independent of the traffic state (it is a constant), <em>this result is equivalent to</em> shifting the smoothed N-curve of the upstream detector (curve U of Figure 3) to the right by an amount 

<math display="inline" id="Three-detector_problem_and_Newell's_method:6">
 <semantics>
  <msub>
   <mi>τ</mi>
   <mn>1</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>τ</ci>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \tau_{1}
  </annotation>
 </semantics>
</math>

.</p>

<p><strong>Downstream.</strong> Likewise, <em>since</em> the state over the downstream detector is queued, there will be a wave reaching P from a location 

<math display="inline" id="Three-detector_problem_and_Newell's_method:7">
 <semantics>
  <msub>
   <mi>P</mi>
   <mn>2</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>P</ci>
    <cn type="integer">2</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   P_{2}
  </annotation>
 </semantics>
</math>

 with wave velocity 

<math display="inline" id="Three-detector_problem_and_Newell's_method:8">
 <semantics>
  <mrow>
   <mrow>
    <mo>-</mo>
    <mi>w</mi>
   </mrow>
   <mo><</mo>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <lt></lt>
    <apply>
     <minus></minus>
     <ci>w</ci>
    </apply>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   -w<0
  </annotation>
 </semantics>
</math>

. The <em>change</em> in vehicular label along this characteristic can be obtained from the moving observer construction of Figure 4, for an observer moving with the wave. In our particular case, the slanted line corresponding to the observer is parallel to the congested part of TFD. This means that the observer flow is independent of the traffic state and takes on the value

<math display="block" id="Three-detector_problem_and_Newell's_method:9">
 <semantics>
  <mrow>
   <msub>
    <mi>k</mi>
    <mi>j</mi>
   </msub>
   <mrow>
    <mo stretchy="false">(</mo>
    <mrow>
     <mo>-</mo>
     <mi>w</mi>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>k</ci>
     <ci>j</ci>
    </apply>
    <apply>
     <minus></minus>
     <ci>w</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   k_{j}(-w)
  </annotation>
 </semantics>
</math>

. Therefore, in the <em>time</em> that it takes for the wave to reach the middle location, 

<math display="inline" id="Three-detector_problem_and_Newell's_method:10">
 <semantics>
  <mrow>
   <msub>
    <mi>τ</mi>
    <mn>2</mn>
   </msub>
   <mo>=</mo>
   <mrow>
    <msub>
     <mi>L</mi>
     <mi>D</mi>
    </msub>
    <mo>/</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mo>-</mo>
      <mi>w</mi>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>τ</ci>
     <cn type="integer">2</cn>
    </apply>
    <apply>
     <divide></divide>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>L</ci>
      <ci>D</ci>
     </apply>
     <apply>
      <minus></minus>
      <ci>w</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \tau_{2}=L_{D}/(-w)
  </annotation>
 </semantics>
</math>

, the change in <em>count</em> is 

<math display="inline" id="Three-detector_problem_and_Newell's_method:11">
 <semantics>
  <mrow>
   <mi>δ</mi>
   <mo>=</mo>
   <mrow>
    <msub>
     <mi>k</mi>
     <mi>j</mi>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mo>-</mo>
      <mi>w</mi>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
    <msub>
     <mi>τ</mi>
     <mn>2</mn>
    </msub>
   </mrow>
   <mo>=</mo>
   <mrow>
    <msub>
     <mi>k</mi>
     <mi>j</mi>
    </msub>
    <msub>
     <mi>L</mi>
     <mi>D</mi>
    </msub>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <ci>δ</ci>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>k</ci>
       <ci>j</ci>
      </apply>
      <apply>
       <minus></minus>
       <ci>w</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>τ</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>k</ci>
       <ci>j</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>L</ci>
       <ci>D</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \delta=k_{j}(-w)\tau_{2}=k_{j}L_{D}
  </annotation>
 </semantics>
</math>

; i.e., the change in count equals the number of vehicles that fit between M and D at jam density. <em>This result is equivalent to</em> shifting the D-curve to the right 

<math display="inline" id="Three-detector_problem_and_Newell's_method:12">
 <semantics>
  <msub>
   <mi>τ</mi>
   <mn>2</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>τ</ci>
    <cn type="integer">2</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \tau_{2}
  </annotation>
 </semantics>
</math>

 units and up 

<math display="inline" id="Three-detector_problem_and_Newell's_method:13">
 <semantics>
  <mi>δ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>δ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \delta
  </annotation>
 </semantics>
</math>

 units.</p>

<p><strong>Actual count at M.</strong> In view of the Newell-Luke Minimum Principle, we see that the actual count at M should be the lower envelope of the U'- and D'-curves. This is the dark curves, M(t). The <em>intersections</em> of the U'- and D'- curves denote the shock's passages over the detector; i.e., the times when transitions between queued and unqueued states take place as the queue advances and recedes over the middle detector. The <em>area</em> between the U'- and M-curves is the delay experienced upstream of location M, <em>trip times</em> are the horizontal separation between curves U(t), M(t) and D(t), <em>accumulation</em> is given by vertical separations, etc.</p>

<p><strong>Mathematical expression.</strong> In terms of the function N(t,x) and the detector location (

<math display="inline" id="Three-detector_problem_and_Newell's_method:14">
 <semantics>
  <msub>
   <mi>x</mi>
   <mi>u</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>x</ci>
    <ci>u</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x_{u}
  </annotation>
 </semantics>
</math>

, 

<math display="inline" id="Three-detector_problem_and_Newell's_method:15">
 <semantics>
  <msub>
   <mi>x</mi>
   <mi>m</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>x</ci>
    <ci>m</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x_{m}
  </annotation>
 </semantics>
</math>

, 

<math display="inline" id="Three-detector_problem_and_Newell's_method:16">
 <semantics>
  <msub>
   <mi>x</mi>
   <mi>d</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>x</ci>
    <ci>d</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x_{d}
  </annotation>
 </semantics>
</math>

) as follows:</p>

<p>

<math display="block" id="Three-detector_problem_and_Newell's_method:17">
 <semantics>
  <mrow>
   <mrow>
    <mi>N</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>t</mi>
     <mo>,</mo>
     <msub>
      <mi>x</mi>
      <mi>m</mi>
     </msub>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mi>min</mi>
     <mrow>
      <mo rspace="7.5pt" stretchy="false">{</mo>
      <mrow>
       <mi>N</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mi>t</mi>
         <mo>-</mo>
         <mrow>
          <msub>
           <mi>L</mi>
           <mi>U</mi>
          </msub>
          <mo>/</mo>
          <msub>
           <mi>v</mi>
           <mi>f</mi>
          </msub>
         </mrow>
        </mrow>
        <mo>,</mo>
        <msub>
         <mi>x</mi>
         <mi>u</mi>
        </msub>
        <mo rspace="7.5pt" stretchy="false">)</mo>
       </mrow>
      </mrow>
      <mo rspace="7.5pt">,</mo>
      <mrow>
       <mrow>
        <mi>N</mi>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <mi>t</mi>
          <mo>+</mo>
          <mrow>
           <msub>
            <mi>L</mi>
            <mi>D</mi>
           </msub>
           <mo>/</mo>
           <mi>w</mi>
          </mrow>
         </mrow>
         <mo>,</mo>
         <msub>
          <mi>x</mi>
          <mi>d</mi>
         </msub>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
       <mo>+</mo>
       <mrow>
        <msub>
         <mi>k</mi>
         <mi>j</mi>
        </msub>
        <mpadded width="+5pt">
         <msub>
          <mi>L</mi>
          <mi>D</mi>
         </msub>
        </mpadded>
       </mrow>
      </mrow>
      <mo stretchy="false">}</mo>
     </mrow>
    </mrow>
    <mrow>
     <mo stretchy="false">(</mo>
     <mn>1</mn>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>N</ci>
     <interval closure="open">
      <ci>t</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <ci>m</ci>
      </apply>
     </interval>
    </apply>
    <list>
     <apply>
      <min></min>
      <apply>
       <times></times>
       <ci>N</ci>
       <interval closure="open">
        <apply>
         <minus></minus>
         <ci>t</ci>
         <apply>
          <divide></divide>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>L</ci>
           <ci>U</ci>
          </apply>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>v</ci>
           <ci>f</ci>
          </apply>
         </apply>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>x</ci>
         <ci>u</ci>
        </apply>
       </interval>
      </apply>
      <apply>
       <plus></plus>
       <apply>
        <times></times>
        <ci>N</ci>
        <interval closure="open">
         <apply>
          <plus></plus>
          <ci>t</ci>
          <apply>
           <divide></divide>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <ci>L</ci>
            <ci>D</ci>
           </apply>
           <ci>w</ci>
          </apply>
         </apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>x</ci>
          <ci>d</ci>
         </apply>
        </interval>
       </apply>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>k</ci>
         <ci>j</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>L</ci>
         <ci>D</ci>
        </apply>
       </apply>
      </apply>
     </apply>
     <cn type="integer">1</cn>
    </list>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   N(t,x_{m})=\min\{\ N(t-L_{U}/v_{f},x_{u})\ ,\ N(t+L_{D}/w,x_{d})+k_{j}L_{D}\ %
\}\qquad(1)
  </annotation>
 </semantics>
</math>

 where 

<math display="inline" id="Three-detector_problem_and_Newell's_method:18">
 <semantics>
  <mrow>
   <msub>
    <mi>L</mi>
    <mi>U</mi>
   </msub>
   <mo>=</mo>
   <mrow>
    <msub>
     <mi>x</mi>
     <mi>m</mi>
    </msub>
    <mo>-</mo>
    <msub>
     <mi>x</mi>
     <mi>u</mi>
    </msub>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>L</ci>
     <ci>U</ci>
    </apply>
    <apply>
     <minus></minus>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <ci>m</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <ci>u</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   L_{U}=x_{m}-x_{u}
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Three-detector_problem_and_Newell's_method:19">
 <semantics>
  <mrow>
   <msub>
    <mi>L</mi>
    <mi>D</mi>
   </msub>
   <mo>=</mo>
   <mrow>
    <msub>
     <mi>x</mi>
     <mi>d</mi>
    </msub>
    <mo>-</mo>
    <msub>
     <mi>x</mi>
     <mi>m</mi>
    </msub>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>L</ci>
     <ci>D</ci>
    </apply>
    <apply>
     <minus></minus>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <ci>d</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <ci>m</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   L_{D}=x_{d}-x_{m}
  </annotation>
 </semantics>
</math>

.</p>
<h2 id="basic-principles-of-variational-theory-vt">Basic principles of variational theory (VT)</h2>

<p><strong>Goal.</strong> Suppose we <em>know</em> the number of vehicles (N) along a boundary in a time-space region and we are <em>looking for</em> the number of vehicles at a generic point P (denoted as 

<math display="inline" id="Three-detector_problem_and_Newell's_method:20">
 <semantics>
  <msub>
   <mi>N</mi>
   <mi>p</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>N</ci>
    <ci>p</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   N_{p}
  </annotation>
 </semantics>
</math>

) beyond that boundary in the direction of increasing time(see Figure 5).<a class="footnoteRef" href="#fn8" id="fnref8"><sup>8</sup></a></p>

<p>Suppose, again, that an observer starts moving from the boundary to point P along path L. We know the vehicle number the observer sees, 

<math display="inline" id="Three-detector_problem_and_Newell's_method:21">
 <semantics>
  <msub>
   <mi>N</mi>
   <mi>L</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>N</ci>
    <ci>L</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   N_{L}
  </annotation>
 </semantics>
</math>

. We then break the path of the observer into small sections (such as the one show between A and B) and note that we also know the maximum number of vehicles that can pass the observer along that small section is, 

<math display="inline" id="Three-detector_problem_and_Newell's_method:22">
 <semantics>
  <msub>
   <mi>C</mi>
   <mrow>
    <mi>A</mi>
    <mi>B</mi>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>C</ci>
    <apply>
     <times></times>
     <ci>A</ci>
     <ci>B</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   C_{AB}
  </annotation>
 </semantics>
</math>

. The relative capacity formula tells us that it is

<math display="block" id="Three-detector_problem_and_Newell's_method:23">
 <semantics>
  <mrow>
   <msub>
    <mi>C</mi>
    <mrow>
     <mi>A</mi>
     <mi>B</mi>
    </mrow>
   </msub>
   <mo>=</mo>
   <mrow>
    <mi>r</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <msup>
      <mi>v</mi>
      <mn>0</mn>
     </msup>
     <mo stretchy="false">)</mo>
    </mrow>
    <mi mathvariant="normal">Δ</mi>
    <mi>t</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>C</ci>
     <apply>
      <times></times>
      <ci>A</ci>
      <ci>B</ci>
     </apply>
    </apply>
    <apply>
     <times></times>
     <ci>r</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>v</ci>
      <cn type="integer">0</cn>
     </apply>
     <ci>normal-Δ</ci>
     <ci>t</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   C_{AB}=r(v^{0})\Delta{t}
  </annotation>
 </semantics>
</math>

. For TFD and using 

<math display="inline" id="Three-detector_problem_and_Newell's_method:24">
 <semantics>
  <msub>
   <mi>v</mi>
   <mrow>
    <mi>A</mi>
    <mi>B</mi>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>v</ci>
    <apply>
     <times></times>
     <ci>A</ci>
     <ci>B</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   v_{AB}
  </annotation>
 </semantics>
</math>

 for the slope of segment AB, 

<math display="inline" id="Three-detector_problem_and_Newell's_method:25">
 <semantics>
  <msub>
   <mi>C</mi>
   <mrow>
    <mi>A</mi>
    <mi>B</mi>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>C</ci>
    <apply>
     <times></times>
     <ci>A</ci>
     <ci>B</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   C_{AB}
  </annotation>
 </semantics>
</math>

 can be written as:</p>

<p>

<math display="block" id="Three-detector_problem_and_Newell's_method:26">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>C</mi>
     <mrow>
      <mi>A</mi>
      <mi>B</mi>
     </mrow>
    </msub>
    <mo>=</mo>
    <mrow>
     <mi>r</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <msub>
       <mi>v</mi>
       <mrow>
        <mi>A</mi>
        <mi>B</mi>
       </mrow>
      </msub>
      <mo stretchy="false">)</mo>
     </mrow>
     <mi mathvariant="normal">Δ</mi>
     <mi>t</mi>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mrow>
      <msub>
       <mi>q</mi>
       <mn>0</mn>
      </msub>
      <mi mathvariant="normal">Δ</mi>
      <mi>t</mi>
     </mrow>
     <mo>-</mo>
     <mrow>
      <msub>
       <mi>k</mi>
       <mn>0</mn>
      </msub>
      <mi mathvariant="normal">Δ</mi>
      <mi>x</mi>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mrow>
      <msub>
       <mi>q</mi>
       <mn>0</mn>
      </msub>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <msub>
         <mi>t</mi>
         <mi>B</mi>
        </msub>
        <mo>-</mo>
        <msub>
         <mi>t</mi>
         <mi>A</mi>
        </msub>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo>-</mo>
     <mrow>
      <msub>
       <mi>k</mi>
       <mn>0</mn>
      </msub>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <msub>
         <mi>x</mi>
         <mi>B</mi>
        </msub>
        <mo>-</mo>
        <msub>
         <mi>x</mi>
         <mi>A</mi>
        </msub>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>;</mo>
   <mrow>
    <mrow>
     <mi>f</mi>
     <mi>o</mi>
     <mpadded width="+5pt">
      <mi>r</mi>
     </mpadded>
     <msub>
      <mi>v</mi>
      <mrow>
       <mi>A</mi>
       <mi>B</mi>
      </mrow>
     </msub>
    </mrow>
    <mo>∈</mo>
    <mrow>
     <mrow>
      <mo stretchy="false">[</mo>
      <mrow>
       <mo>-</mo>
       <mi>w</mi>
      </mrow>
      <mo>,</mo>
      <msub>
       <mi>v</mi>
       <mi>f</mi>
      </msub>
      <mo stretchy="false">]</mo>
     </mrow>
     <mrow>
      <mo stretchy="false">(</mo>
      <mn>2</mn>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <and></and>
     <apply>
      <eq></eq>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>C</ci>
       <apply>
        <times></times>
        <ci>A</ci>
        <ci>B</ci>
       </apply>
      </apply>
      <apply>
       <times></times>
       <ci>r</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>v</ci>
        <apply>
         <times></times>
         <ci>A</ci>
         <ci>B</ci>
        </apply>
       </apply>
       <ci>normal-Δ</ci>
       <ci>t</ci>
      </apply>
     </apply>
     <apply>
      <eq></eq>
      <share href="#.cmml">
      </share>
      <apply>
       <minus></minus>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>q</ci>
         <cn type="integer">0</cn>
        </apply>
        <ci>normal-Δ</ci>
        <ci>t</ci>
       </apply>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>k</ci>
         <cn type="integer">0</cn>
        </apply>
        <ci>normal-Δ</ci>
        <ci>x</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <eq></eq>
      <share href="#.cmml">
      </share>
      <apply>
       <minus></minus>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>q</ci>
         <cn type="integer">0</cn>
        </apply>
        <apply>
         <minus></minus>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>t</ci>
          <ci>B</ci>
         </apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>t</ci>
          <ci>A</ci>
         </apply>
        </apply>
       </apply>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>k</ci>
         <cn type="integer">0</cn>
        </apply>
        <apply>
         <minus></minus>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>x</ci>
          <ci>B</ci>
         </apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>x</ci>
          <ci>A</ci>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <in></in>
     <apply>
      <times></times>
      <ci>f</ci>
      <ci>o</ci>
      <ci>r</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>v</ci>
       <apply>
        <times></times>
        <ci>A</ci>
        <ci>B</ci>
       </apply>
      </apply>
     </apply>
     <list>
      <interval closure="closed">
       <apply>
        <minus></minus>
        <ci>w</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>v</ci>
        <ci>f</ci>
       </apply>
      </interval>
      <cn type="integer">2</cn>
     </list>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   C_{AB}=r(v_{AB})\Delta{t}=q_{0}\Delta{t}-k_{0}\Delta{x}=q_{0}(t_{B}-t_{A})-k_{%
0}(x_{B}-x_{A});for\ v_{AB}\in[-w,v_{f}]\qquad(2)
  </annotation>
 </semantics>
</math>

 So, if we now add the vehicle number on the boundary to the sum of all 

<math display="inline" id="Three-detector_problem_and_Newell's_method:27">
 <semantics>
  <msub>
   <mi>C</mi>
   <mrow>
    <mi>A</mi>
    <mi>B</mi>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>C</ci>
    <apply>
     <times></times>
     <ci>A</ci>
     <ci>B</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   C_{AB}
  </annotation>
 </semantics>
</math>

 along path L we get an upper bound for 

<math display="inline" id="Three-detector_problem_and_Newell's_method:28">
 <semantics>
  <msub>
   <mi>N</mi>
   <mi>p</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>N</ci>
    <ci>p</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   N_{p}
  </annotation>
 </semantics>
</math>

. This upper bound applies to any observer that moves with speeds in the range 

<math display="inline" id="Three-detector_problem_and_Newell's_method:29">
 <semantics>
  <mrow>
   <mo stretchy="false">[</mo>
   <mrow>
    <mo>-</mo>
    <mi>w</mi>
   </mrow>
   <mo>,</mo>
   <msub>
    <mi>v</mi>
    <mi>f</mi>
   </msub>
   <mo stretchy="false">]</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <interval closure="closed">
    <apply>
     <minus></minus>
     <ci>w</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>v</ci>
     <ci>f</ci>
    </apply>
   </interval>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   [-w,v_{f}]
  </annotation>
 </semantics>
</math>

. Thus we can write:</p>

<p>

<math display="block" id="Three-detector_problem_and_Newell's_method:30">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>N</mi>
     <mi>P</mi>
    </msub>
    <mo>≤</mo>
    <mrow>
     <msub>
      <mi>N</mi>
      <mi>L</mi>
     </msub>
     <mo>+</mo>
     <mrow>
      <munder>
       <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
       <mi>L</mi>
      </munder>
      <mrow>
       <mo stretchy="false">(</mo>
       <msub>
        <mi>C</mi>
        <mrow>
         <mi>A</mi>
         <mi>B</mi>
        </mrow>
       </msub>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo rspace="7.5pt">,</mo>
   <mrow>
    <msub>
     <mi>v</mi>
     <mrow>
      <mi>A</mi>
      <mi>B</mi>
     </mrow>
    </msub>
    <mo>∈</mo>
    <mrow>
     <mrow>
      <mo stretchy="false">[</mo>
      <mrow>
       <mo>-</mo>
       <mi>w</mi>
      </mrow>
      <mo>,</mo>
      <msub>
       <mi>v</mi>
       <mi>f</mi>
      </msub>
      <mo stretchy="false">]</mo>
     </mrow>
     <mrow>
      <mo stretchy="false">(</mo>
      <mn>3</mn>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <leq></leq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>N</ci>
      <ci>P</ci>
     </apply>
     <apply>
      <plus></plus>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>N</ci>
       <ci>L</ci>
      </apply>
      <apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <ci>L</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>C</ci>
        <apply>
         <times></times>
         <ci>A</ci>
         <ci>B</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <in></in>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>v</ci>
      <apply>
       <times></times>
       <ci>A</ci>
       <ci>B</ci>
      </apply>
     </apply>
     <list>
      <interval closure="closed">
       <apply>
        <minus></minus>
        <ci>w</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>v</ci>
        <ci>f</ci>
       </apply>
      </interval>
      <cn type="integer">3</cn>
     </list>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   N_{P}\leq N_{L}+\sum_{L}(C_{AB}),\ v_{AB}\in[-w,v_{f}]\qquad(3)
  </annotation>
 </semantics>
</math>

 Equations (1) and (2) are based on the relative capacity constraint which itself follows from the conservation law.</p>

<p><strong>Maximum principle.</strong> It states that 

<math display="inline" id="Three-detector_problem_and_Newell's_method:31">
 <semantics>
  <msub>
   <mi>N</mi>
   <mi>P</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>N</ci>
    <ci>P</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   N_{P}
  </annotation>
 </semantics>
</math>

 is the largest possible value, subject to the capacity constraints. Thus the VT recipe is:</p>

<p>

<math display="block" id="Three-detector_problem_and_Newell's_method:32">
 <semantics>
  <mrow>
   <msub>
    <mi>N</mi>
    <mi>P</mi>
   </msub>
   <mo>=</mo>
   <mrow>
    <mrow>
     <munder>
      <mi>min</mi>
      <mi>L</mi>
     </munder>
     <mrow>
      <mo stretchy="false">{</mo>
      <mrow>
       <msub>
        <mi>N</mi>
        <mi>L</mi>
       </msub>
       <mo>+</mo>
       <mrow>
        <munder>
         <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
         <mi>L</mi>
        </munder>
        <mrow>
         <mo stretchy="false">(</mo>
         <msub>
          <mi>C</mi>
          <mrow>
           <mi>A</mi>
           <mi>B</mi>
          </mrow>
         </msub>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
      </mrow>
      <mo stretchy="false">}</mo>
     </mrow>
    </mrow>
    <mrow>
     <mo stretchy="false">(</mo>
     <mn>4</mn>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>N</ci>
     <ci>P</ci>
    </apply>
    <list>
     <apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <min></min>
       <ci>L</ci>
      </apply>
      <apply>
       <plus></plus>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>N</ci>
        <ci>L</ci>
       </apply>
       <apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <sum></sum>
         <ci>L</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>C</ci>
         <apply>
          <times></times>
          <ci>A</ci>
          <ci>B</ci>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
     <cn type="integer">4</cn>
    </list>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   N_{P}=\min_{L}\{N_{L}+\sum_{L}(C_{AB})\}\qquad(4)
  </annotation>
 </semantics>
</math>

 Equation (4) is a shortest path(i.e., calculus of variations) problem with 

<math display="inline" id="Three-detector_problem_and_Newell's_method:33">
 <semantics>
  <mrow>
   <msub>
    <mi>C</mi>
    <mrow>
     <mi>A</mi>
     <mi>B</mi>
    </mrow>
   </msub>
   <mo>=</mo>
   <mrow>
    <mi>r</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <msub>
      <mi>v</mi>
      <mrow>
       <mi>A</mi>
       <mi>B</mi>
      </mrow>
     </msub>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>C</ci>
     <apply>
      <times></times>
      <ci>A</ci>
      <ci>B</ci>
     </apply>
    </apply>
    <apply>
     <times></times>
     <ci>r</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>v</ci>
      <apply>
       <times></times>
       <ci>A</ci>
       <ci>B</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   C_{AB}=r(v_{AB})
  </annotation>
 </semantics>
</math>

 as the cost function. It turns out that it produces the same solution as Kinematic wave theory.</p>
<h2 id="generalized-solution">Generalized solution</h2>

<p><code> </code><strong><code>Three</code> <code>steps:</code></strong><br/>
<code> 1. Find the minimum upstream count, </code>

<math display="inline" id="Three-detector_problem_and_Newell's_method:34">
 <semantics>
  <msub>
   <mi>N</mi>
   <mi>U</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>N</ci>
    <ci>U</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   N_{U}
  </annotation>
 </semantics>
</math>

<br/>
<code> 2. Find the minimum downstream count, </code>

<math display="inline" id="Three-detector_problem_and_Newell's_method:35">
 <semantics>
  <msub>
   <mi>N</mi>
   <mi>D</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>N</ci>
    <ci>D</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   N_{D}
  </annotation>
 </semantics>
</math>

<br/>
<code> 3. Choose the lower of the two, </code>

<math display="inline" id="Three-detector_problem_and_Newell's_method:36">
 <semantics>
  <mrow>
   <msub>
    <mi>N</mi>
    <mi>P</mi>
   </msub>
   <mo>=</mo>
   <mrow>
    <mi>min</mi>
    <mrow>
     <mo stretchy="false">{</mo>
     <mpadded width="+5pt">
      <msub>
       <mi>N</mi>
       <mi>U</mi>
      </msub>
     </mpadded>
     <mo rspace="7.5pt">,</mo>
     <msub>
      <mi>N</mi>
      <mi>D</mi>
     </msub>
     <mo stretchy="false">}</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>N</ci>
     <ci>P</ci>
    </apply>
    <apply>
     <min></min>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>N</ci>
      <ci>U</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>N</ci>
      <ci>D</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   N_{P}=\min\{N_{U}\ ,\ N_{D}\}
  </annotation>
 </semantics>
</math>

</p>
<h3 id="step-1">Step 1</h3>

<p>All possible observer straight lines between the upstream boundary and point P have to constructed with observer speeds smaller than free flow speed:</p>

<p>

<math display="block" id="Three-detector_problem_and_Newell's_method:37">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>C</mi>
     <mrow>
      <mi>Q</mi>
      <mi>P</mi>
     </mrow>
    </msub>
    <mo>=</mo>
    <mrow>
     <mrow>
      <msub>
       <mi>q</mi>
       <mn>0</mn>
      </msub>
      <mi mathvariant="normal">Δ</mi>
      <mi>t</mi>
     </mrow>
     <mo>-</mo>
     <mrow>
      <msub>
       <mi>k</mi>
       <mn>0</mn>
      </msub>
      <mi mathvariant="normal">Δ</mi>
      <mi>x</mi>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mrow>
      <msub>
       <mi>q</mi>
       <mn>0</mn>
      </msub>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <msub>
         <mi>t</mi>
         <mi>P</mi>
        </msub>
        <mo>-</mo>
        <msub>
         <mi>t</mi>
         <mi>Q</mi>
        </msub>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo>-</mo>
     <mrow>
      <msub>
       <mi>k</mi>
       <mn>0</mn>
      </msub>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <msub>
         <mi>x</mi>
         <mi>P</mi>
        </msub>
        <mo>-</mo>
        <msub>
         <mi>x</mi>
         <mi>Q</mi>
        </msub>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mrow>
    <mo stretchy="false">(</mo>
    <mn>5</mn>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <and></and>
     <apply>
      <eq></eq>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>C</ci>
       <apply>
        <times></times>
        <ci>Q</ci>
        <ci>P</ci>
       </apply>
      </apply>
      <apply>
       <minus></minus>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>q</ci>
         <cn type="integer">0</cn>
        </apply>
        <ci>normal-Δ</ci>
        <ci>t</ci>
       </apply>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>k</ci>
         <cn type="integer">0</cn>
        </apply>
        <ci>normal-Δ</ci>
        <ci>x</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <eq></eq>
      <share href="#.cmml">
      </share>
      <apply>
       <minus></minus>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>q</ci>
         <cn type="integer">0</cn>
        </apply>
        <apply>
         <minus></minus>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>t</ci>
          <ci>P</ci>
         </apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>t</ci>
          <ci>Q</ci>
         </apply>
        </apply>
       </apply>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>k</ci>
         <cn type="integer">0</cn>
        </apply>
        <apply>
         <minus></minus>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>x</ci>
          <ci>P</ci>
         </apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>x</ci>
          <ci>Q</ci>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
    <cn type="integer">5</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   C_{QP}=q_{0}\Delta{t}-k_{0}\Delta{x}=q_{0}(t_{P}-t_{Q})-k_{0}(x_{P}-x_{Q})%
\qquad(5)
  </annotation>
 </semantics>
</math>

 where 

<math display="inline" id="Three-detector_problem_and_Newell's_method:38">
 <semantics>
  <mrow>
   <mrow>
    <mi mathvariant="normal">Δ</mi>
    <mi>t</mi>
   </mrow>
   <mo>=</mo>
   <mrow>
    <msub>
     <mi>t</mi>
     <mi>P</mi>
    </msub>
    <mo>-</mo>
    <msub>
     <mi>t</mi>
     <mi>Q</mi>
    </msub>
   </mrow>
   <mo>=</mo>
   <mfrac>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <msub>
       <mi>x</mi>
       <mi>M</mi>
      </msub>
      <mo>-</mo>
      <msub>
       <mi>x</mi>
       <mi>U</mi>
      </msub>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
    <msub>
     <mi>v</mi>
     <mrow>
      <mi>Q</mi>
      <mi>P</mi>
     </mrow>
    </msub>
   </mfrac>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <times></times>
      <ci>normal-Δ</ci>
      <ci>t</ci>
     </apply>
     <apply>
      <minus></minus>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>t</ci>
       <ci>P</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>t</ci>
       <ci>Q</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <divide></divide>
      <apply>
       <minus></minus>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <ci>M</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <ci>U</ci>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>v</ci>
       <apply>
        <times></times>
        <ci>Q</ci>
        <ci>P</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Delta{t}=t_{P}-t_{Q}=\frac{(x_{M}-x_{U})}{v_{QP}}
  </annotation>
 </semantics>
</math>

 for 

<math display="inline" id="Three-detector_problem_and_Newell's_method:39">
 <semantics>
  <mrow>
   <msub>
    <mi>v</mi>
    <mrow>
     <mi>Q</mi>
     <mi>P</mi>
    </mrow>
   </msub>
   <mo>∈</mo>
   <mrow>
    <mo stretchy="false">[</mo>
    <mn>0</mn>
    <mo>,</mo>
    <msub>
     <mi>v</mi>
     <mi>f</mi>
    </msub>
    <mo stretchy="false">]</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <in></in>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>v</ci>
     <apply>
      <times></times>
      <ci>Q</ci>
      <ci>P</ci>
     </apply>
    </apply>
    <interval closure="closed">
     <cn type="integer">0</cn>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>v</ci>
      <ci>f</ci>
     </apply>
    </interval>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   v_{QP}\in[0,v_{f}]
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Three-detector_problem_and_Newell's_method:40">
 <semantics>
  <mrow>
   <mrow>
    <mi mathvariant="normal">Δ</mi>
    <mi>x</mi>
   </mrow>
   <mo>=</mo>
   <mrow>
    <msub>
     <mi>x</mi>
     <mi>M</mi>
    </msub>
    <mo>-</mo>
    <msub>
     <mi>x</mi>
     <mi>U</mi>
    </msub>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>normal-Δ</ci>
     <ci>x</ci>
    </apply>
    <apply>
     <minus></minus>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <ci>M</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <ci>U</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Delta{x}=x_{M}-x_{U}
  </annotation>
 </semantics>
</math>

</p>

<p>Thus we need to minimize 

<math display="inline" id="Three-detector_problem_and_Newell's_method:41">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>N</mi>
     <mi>Q</mi>
    </msub>
    <mo>+</mo>
    <mrow>
     <msub>
      <mi>q</mi>
      <mn>0</mn>
     </msub>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <msub>
        <mi>t</mi>
        <mi>P</mi>
       </msub>
       <mo>-</mo>
       <msub>
        <mi>t</mi>
        <mi>Q</mi>
       </msub>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>-</mo>
   <mrow>
    <msub>
     <mi>k</mi>
     <mn>0</mn>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <msub>
       <mi>x</mi>
       <mi>M</mi>
      </msub>
      <mo>-</mo>
      <msub>
       <mi>x</mi>
       <mi>U</mi>
      </msub>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <minus></minus>
    <apply>
     <plus></plus>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>N</ci>
      <ci>Q</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>q</ci>
       <cn type="integer">0</cn>
      </apply>
      <apply>
       <minus></minus>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>t</ci>
        <ci>P</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>t</ci>
        <ci>Q</ci>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>k</ci>
      <cn type="integer">0</cn>
     </apply>
     <apply>
      <minus></minus>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <ci>M</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <ci>U</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   {N_{Q}+q_{0}(t_{P}-t_{Q})-k_{0}(x_{M}-x_{U})}
  </annotation>
 </semantics>
</math>

; i.e.,</p>

<p>

<math display="block" id="Three-detector_problem_and_Newell's_method:42">
 <semantics>
  <mrow>
   <msub>
    <mi>N</mi>
    <mi>U</mi>
   </msub>
   <mo>=</mo>
   <mrow>
    <mrow>
     <munder>
      <mi>min</mi>
      <msub>
       <mi>t</mi>
       <mi>Q</mi>
      </msub>
     </munder>
     <mrow>
      <mo stretchy="false">{</mo>
      <mrow>
       <mrow>
        <msub>
         <mi>N</mi>
         <mi>Q</mi>
        </msub>
        <mo>+</mo>
        <mrow>
         <msub>
          <mi>q</mi>
          <mn>0</mn>
         </msub>
         <mrow>
          <mo stretchy="false">(</mo>
          <mrow>
           <msub>
            <mi>t</mi>
            <mi>P</mi>
           </msub>
           <mo>-</mo>
           <msub>
            <mi>t</mi>
            <mi>Q</mi>
           </msub>
          </mrow>
          <mo stretchy="false">)</mo>
         </mrow>
        </mrow>
       </mrow>
       <mo>-</mo>
       <mrow>
        <msub>
         <mi>k</mi>
         <mn>0</mn>
        </msub>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <msub>
           <mi>x</mi>
           <mi>M</mi>
          </msub>
          <mo>-</mo>
          <msub>
           <mi>x</mi>
           <mi>U</mi>
          </msub>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
      </mrow>
      <mo stretchy="false">}</mo>
     </mrow>
    </mrow>
    <mrow>
     <mo stretchy="false">(</mo>
     <mn>6</mn>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>N</ci>
     <ci>U</ci>
    </apply>
    <list>
     <apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <min></min>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>t</ci>
        <ci>Q</ci>
       </apply>
      </apply>
      <apply>
       <minus></minus>
       <apply>
        <plus></plus>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>N</ci>
         <ci>Q</ci>
        </apply>
        <apply>
         <times></times>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>q</ci>
          <cn type="integer">0</cn>
         </apply>
         <apply>
          <minus></minus>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>t</ci>
           <ci>P</ci>
          </apply>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>t</ci>
           <ci>Q</ci>
          </apply>
         </apply>
        </apply>
       </apply>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>k</ci>
         <cn type="integer">0</cn>
        </apply>
        <apply>
         <minus></minus>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>x</ci>
          <ci>M</ci>
         </apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>x</ci>
          <ci>U</ci>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
     <cn type="integer">6</cn>
    </list>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   N_{U}=\min_{t_{Q}}\{N_{Q}+q_{0}(t_{P}-t_{Q})-k_{0}(x_{M}-x_{U})\}\qquad(6)
  </annotation>
 </semantics>
</math>

 Since 

<math display="inline" id="Three-detector_problem_and_Newell's_method:43">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mrow>
      <mi>d</mi>
      <msub>
       <mi>N</mi>
       <mi>Q</mi>
      </msub>
     </mrow>
     <mo>/</mo>
     <mi>d</mi>
    </mrow>
    <mi>t</mi>
   </mrow>
   <mo>≤</mo>
   <msub>
    <mi>q</mi>
    <mn>0</mn>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <leq></leq>
    <apply>
     <times></times>
     <apply>
      <divide></divide>
      <apply>
       <times></times>
       <ci>d</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>N</ci>
        <ci>Q</ci>
       </apply>
      </apply>
      <ci>d</ci>
     </apply>
     <ci>t</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>q</ci>
     <cn type="integer">0</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   dN_{Q}/dt\leq q_{0}
  </annotation>
 </semantics>
</math>

, we see that the objective function is non-increasing and therefore 

<math display="inline" id="Three-detector_problem_and_Newell's_method:44">
 <semantics>
  <mrow>
   <msubsup>
    <mi>t</mi>
    <mi>Q</mi>
    <mo>*</mo>
   </msubsup>
   <mo>=</mo>
   <msub>
    <mi>t</mi>
    <msub>
     <mi>P</mi>
     <mn>1</mn>
    </msub>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>t</ci>
      <ci>Q</ci>
     </apply>
     <times></times>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>t</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>P</ci>
      <cn type="integer">1</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   t_{Q}^{*}=t_{P_{1}}
  </annotation>
 </semantics>
</math>

. So Q should be placed at 

<math display="inline" id="Three-detector_problem_and_Newell's_method:45">
 <semantics>
  <msub>
   <mi>P</mi>
   <mn>1</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>P</ci>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   P_{1}
  </annotation>
 </semantics>
</math>

 and we have:</p>

<p>

<math display="block" id="Three-detector_problem_and_Newell's_method:46">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>C</mi>
     <mrow>
      <mi>Q</mi>
      <mi>P</mi>
     </mrow>
    </msub>
    <mo>=</mo>
    <msub>
     <mi>C</mi>
     <mrow>
      <msub>
       <mi>P</mi>
       <mn>1</mn>
      </msub>
      <mi>P</mi>
     </mrow>
    </msub>
    <mo>=</mo>
    <mrow>
     <mrow>
      <msub>
       <mi>q</mi>
       <mn>0</mn>
      </msub>
      <mrow>
       <mo>(</mo>
       <mfrac>
        <mrow>
         <msub>
          <mi>x</mi>
          <mi>M</mi>
         </msub>
         <mo>-</mo>
         <msub>
          <mi>x</mi>
          <mi>U</mi>
         </msub>
        </mrow>
        <msub>
         <mi>v</mi>
         <mi>f</mi>
        </msub>
       </mfrac>
       <mo>)</mo>
      </mrow>
     </mrow>
     <mo>-</mo>
     <mrow>
      <msub>
       <mi>k</mi>
       <mn>0</mn>
      </msub>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <msub>
         <mi>x</mi>
         <mi>M</mi>
        </msub>
        <mo>-</mo>
        <msub>
         <mi>x</mi>
         <mi>U</mi>
        </msub>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mn>0</mn>
   </mrow>
   <mrow>
    <mo stretchy="false">(</mo>
    <mn>7</mn>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <and></and>
     <apply>
      <eq></eq>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>C</ci>
       <apply>
        <times></times>
        <ci>Q</ci>
        <ci>P</ci>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>C</ci>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>P</ci>
         <cn type="integer">1</cn>
        </apply>
        <ci>P</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <eq></eq>
      <share href="#.cmml">
      </share>
      <apply>
       <minus></minus>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>q</ci>
         <cn type="integer">0</cn>
        </apply>
        <apply>
         <divide></divide>
         <apply>
          <minus></minus>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>x</ci>
           <ci>M</ci>
          </apply>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>x</ci>
           <ci>U</ci>
          </apply>
         </apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>v</ci>
          <ci>f</ci>
         </apply>
        </apply>
       </apply>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>k</ci>
         <cn type="integer">0</cn>
        </apply>
        <apply>
         <minus></minus>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>x</ci>
          <ci>M</ci>
         </apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>x</ci>
          <ci>U</ci>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <eq></eq>
      <share href="#.cmml">
      </share>
      <cn type="integer">0</cn>
     </apply>
    </apply>
    <cn type="integer">7</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   C_{QP}=C_{P_{1}P}=q_{0}\left(\frac{x_{M}-x_{U}}{v_{f}}\right)-k_{0}(x_{M}-x_{U%
})=0\qquad(7)
  </annotation>
 </semantics>
</math>

 Thus, 

<math display="inline" id="Three-detector_problem_and_Newell's_method:47">
 <semantics>
  <mrow>
   <msub>
    <mi>N</mi>
    <mi>U</mi>
   </msub>
   <mo>=</mo>
   <msub>
    <mi>N</mi>
    <msub>
     <mi>P</mi>
     <mn>1</mn>
    </msub>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>N</ci>
     <ci>U</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>N</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>P</ci>
      <cn type="integer">1</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   N_{U}=N_{P_{1}}
  </annotation>
 </semantics>
</math>

</p>
<h3 id="step-2">Step 2</h3>

<p>We have

<math display="block" id="Three-detector_problem_and_Newell's_method:48">
 <semantics>
  <mrow>
   <msub>
    <mi>N</mi>
    <mi>D</mi>
   </msub>
   <mo>=</mo>
   <mrow>
    <munder>
     <mi>min</mi>
     <msup>
      <mi>Q</mi>
      <msup>
       <mi></mi>
       <mo>′</mo>
      </msup>
     </msup>
    </munder>
    <mrow>
     <mo stretchy="false">{</mo>
     <mrow>
      <msub>
       <mi>N</mi>
       <msup>
        <mi>Q</mi>
        <msup>
         <mi></mi>
         <mo>′</mo>
        </msup>
       </msup>
      </msub>
      <mo>+</mo>
      <msub>
       <mi>C</mi>
       <mrow>
        <msup>
         <mi>Q</mi>
         <msup>
          <mi></mi>
          <mo>′</mo>
         </msup>
        </msup>
        <mi>P</mi>
       </mrow>
      </msub>
     </mrow>
     <mo stretchy="false">}</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <munder>
     <mi>min</mi>
     <msup>
      <mi>Q</mi>
      <msup>
       <mi></mi>
       <mo>′</mo>
      </msup>
     </msup>
    </munder>
    <mrow>
     <mo stretchy="false">{</mo>
     <mrow>
      <mrow>
       <msub>
        <mi>N</mi>
        <msup>
         <mi>Q</mi>
         <msup>
          <mi></mi>
          <mo>′</mo>
         </msup>
        </msup>
       </msub>
       <mo>+</mo>
       <mrow>
        <msub>
         <mi>q</mi>
         <mn>0</mn>
        </msub>
        <mi mathvariant="normal">Δ</mi>
        <mi>t</mi>
       </mrow>
      </mrow>
      <mo>-</mo>
      <mrow>
       <msub>
        <mi>k</mi>
        <mn>0</mn>
       </msub>
       <mi mathvariant="normal">Δ</mi>
       <mi>x</mi>
      </mrow>
     </mrow>
     <mo stretchy="false">}</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>N</ci>
      <ci>D</ci>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <min></min>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>Q</ci>
        <apply>
         <ci>normal-′</ci>
        </apply>
       </apply>
      </apply>
      <apply>
       <plus></plus>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>N</ci>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>Q</ci>
         <apply>
          <ci>normal-′</ci>
         </apply>
        </apply>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>C</ci>
        <apply>
         <times></times>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>Q</ci>
          <apply>
           <ci>normal-′</ci>
          </apply>
         </apply>
         <ci>P</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <min></min>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>Q</ci>
        <apply>
         <ci>normal-′</ci>
        </apply>
       </apply>
      </apply>
      <apply>
       <minus></minus>
       <apply>
        <plus></plus>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>N</ci>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>Q</ci>
          <apply>
           <ci>normal-′</ci>
          </apply>
         </apply>
        </apply>
        <apply>
         <times></times>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>q</ci>
          <cn type="integer">0</cn>
         </apply>
         <ci>normal-Δ</ci>
         <ci>t</ci>
        </apply>
       </apply>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>k</ci>
         <cn type="integer">0</cn>
        </apply>
        <ci>normal-Δ</ci>
        <ci>x</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   N_{D}=\min_{Q^{^{\prime}}}\{N_{Q^{^{\prime}}}+C_{Q^{^{\prime}}P}\}=\min_{Q^{^{%
\prime}}}\{N_{Q^{^{\prime}}}+q_{0}\Delta{t}-k_{0}\Delta{x}\}
  </annotation>
 </semantics>
</math>

 So repeat the same steps we find that 

<math display="inline" id="Three-detector_problem_and_Newell's_method:49">
 <semantics>
  <msub>
   <mi>N</mi>
   <mi>D</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>N</ci>
    <ci>D</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   N_{D}
  </annotation>
 </semantics>
</math>

 is minimized when 

<math display="inline" id="Three-detector_problem_and_Newell's_method:50">
 <semantics>
  <mrow>
   <msup>
    <mi>Q</mi>
    <msup>
     <mi></mi>
     <mo>′</mo>
    </msup>
   </msup>
   <mo>=</mo>
   <msub>
    <mi>P</mi>
    <mn>2</mn>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>Q</ci>
     <apply>
      <ci>normal-′</ci>
     </apply>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>P</ci>
     <cn type="integer">2</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Q^{^{\prime}}=P_{2}
  </annotation>
 </semantics>
</math>

. And at point 

<math display="inline" id="Three-detector_problem_and_Newell's_method:51">
 <semantics>
  <msub>
   <mi>P</mi>
   <mn>2</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>P</ci>
    <cn type="integer">2</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   P_{2}
  </annotation>
 </semantics>
</math>

 we get:</p>

<p>

<math display="block" id="Three-detector_problem_and_Newell's_method:52">
 <semantics>
  <mrow>
   <msub>
    <mi>N</mi>
    <mi>D</mi>
   </msub>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mrow>
      <msub>
       <mi>N</mi>
       <msub>
        <mi>P</mi>
        <mn>2</mn>
       </msub>
      </msub>
      <mo>+</mo>
      <mrow>
       <msub>
        <mi>q</mi>
        <mn>0</mn>
       </msub>
       <mrow>
        <mo stretchy="false">(</mo>
        <mfrac>
         <mrow>
          <msub>
           <mi>x</mi>
           <mi>D</mi>
          </msub>
          <mo>-</mo>
          <msub>
           <mi>x</mi>
           <mi>M</mi>
          </msub>
         </mrow>
         <mi>w</mi>
        </mfrac>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
     </mrow>
     <mo>-</mo>
     <mrow>
      <msub>
       <mi>k</mi>
       <mn>0</mn>
      </msub>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <msub>
         <mi>x</mi>
         <mi>D</mi>
        </msub>
        <mo>-</mo>
        <msub>
         <mi>x</mi>
         <mi>M</mi>
        </msub>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mrow>
    <mrow>
     <mo stretchy="false">(</mo>
     <mn>8</mn>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>N</ci>
     <ci>D</ci>
    </apply>
    <list>
     <apply>
      <minus></minus>
      <apply>
       <plus></plus>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>N</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>P</ci>
         <cn type="integer">2</cn>
        </apply>
       </apply>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>q</ci>
         <cn type="integer">0</cn>
        </apply>
        <apply>
         <divide></divide>
         <apply>
          <minus></minus>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>x</ci>
           <ci>D</ci>
          </apply>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>x</ci>
           <ci>M</ci>
          </apply>
         </apply>
         <ci>w</ci>
        </apply>
       </apply>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>k</ci>
        <cn type="integer">0</cn>
       </apply>
       <apply>
        <minus></minus>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>x</ci>
         <ci>D</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>x</ci>
         <ci>M</ci>
        </apply>
       </apply>
      </apply>
     </apply>
     <cn type="integer">8</cn>
    </list>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   N_{D}=N_{P_{2}}+q_{0}(\frac{x_{D}-x_{M}}{w})-k_{0}(x_{D}-x_{M})\qquad(8)
  </annotation>
 </semantics>
</math>

 Since the FD is triangular, 

<math display="inline" id="Three-detector_problem_and_Newell's_method:53">
 <semantics>
  <mrow>
   <mrow>
    <mfrac>
     <msub>
      <mi>q</mi>
      <mn>0</mn>
     </msub>
     <mi>w</mi>
    </mfrac>
    <mo>+</mo>
    <msub>
     <mi>k</mi>
     <mn>0</mn>
    </msub>
   </mrow>
   <mo>=</mo>
   <msub>
    <mi>k</mi>
    <mi>j</mi>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <plus></plus>
     <apply>
      <divide></divide>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>q</ci>
       <cn type="integer">0</cn>
      </apply>
      <ci>w</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>k</ci>
      <cn type="integer">0</cn>
     </apply>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>k</ci>
     <ci>j</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \frac{q_{0}}{w}+k_{0}=k_{j}
  </annotation>
 </semantics>
</math>

. Therefore (8) reduces to:</p>

<p>

<math display="block" id="Three-detector_problem_and_Newell's_method:54">
 <semantics>
  <mrow>
   <msub>
    <mi>N</mi>
    <mi>D</mi>
   </msub>
   <mo>=</mo>
   <mrow>
    <mrow>
     <msub>
      <mi>N</mi>
      <msub>
       <mi>P</mi>
       <mn>2</mn>
      </msub>
     </msub>
     <mo>+</mo>
     <mrow>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <msub>
         <mi>x</mi>
         <mi>D</mi>
        </msub>
        <mo>-</mo>
        <msub>
         <mi>x</mi>
         <mi>M</mi>
        </msub>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
      <msub>
       <mi>k</mi>
       <mi>j</mi>
      </msub>
     </mrow>
    </mrow>
    <mrow>
     <mo stretchy="false">(</mo>
     <mn>9</mn>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>N</ci>
     <ci>D</ci>
    </apply>
    <list>
     <apply>
      <plus></plus>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>N</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>P</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
      <apply>
       <times></times>
       <apply>
        <minus></minus>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>x</ci>
         <ci>D</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>x</ci>
         <ci>M</ci>
        </apply>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>k</ci>
        <ci>j</ci>
       </apply>
      </apply>
     </apply>
     <cn type="integer">9</cn>
    </list>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   N_{D}=N_{P_{2}}+(x_{D}-x_{M})k_{j}\qquad(9)
  </annotation>
 </semantics>
</math>

</p>
<h3 id="step-3">Step 3</h3>

<p>To get the solution we now choose the lower of 

<math display="inline" id="Three-detector_problem_and_Newell's_method:55">
 <semantics>
  <msub>
   <mi>N</mi>
   <mi>U</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>N</ci>
    <ci>U</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   N_{U}
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Three-detector_problem_and_Newell's_method:56">
 <semantics>
  <msub>
   <mi>N</mi>
   <mi>D</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>N</ci>
    <ci>D</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   N_{D}
  </annotation>
 </semantics>
</math>

.</p>

<p>

<math display="block" id="Three-detector_problem_and_Newell's_method:57">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>N</mi>
     <mi>P</mi>
    </msub>
    <mo>=</mo>
    <mrow>
     <mi>min</mi>
     <mrow>
      <mo stretchy="false">{</mo>
      <mpadded width="+5pt">
       <msub>
        <mi>N</mi>
        <mi>U</mi>
       </msub>
      </mpadded>
      <mo rspace="7.5pt">,</mo>
      <msub>
       <mi>N</mi>
       <mi>D</mi>
      </msub>
      <mo stretchy="false">}</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mi>min</mi>
     <mrow>
      <mo stretchy="false">{</mo>
      <mpadded width="+5pt">
       <msub>
        <mi>N</mi>
        <msub>
         <mi>P</mi>
         <mn>1</mn>
        </msub>
       </msub>
      </mpadded>
      <mo rspace="7.5pt">,</mo>
      <mrow>
       <msub>
        <mi>N</mi>
        <msub>
         <mi>P</mi>
         <mn>2</mn>
        </msub>
       </msub>
       <mo>+</mo>
       <mrow>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <msub>
           <mi>x</mi>
           <mi>D</mi>
          </msub>
          <mo>-</mo>
          <msub>
           <mi>x</mi>
           <mi>M</mi>
          </msub>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
        <msub>
         <mi>k</mi>
         <mi>j</mi>
        </msub>
       </mrow>
      </mrow>
      <mo stretchy="false">}</mo>
     </mrow>
    </mrow>
   </mrow>
   <mrow>
    <mo stretchy="false">(</mo>
    <mn>10</mn>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <and></and>
     <apply>
      <eq></eq>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>N</ci>
       <ci>P</ci>
      </apply>
      <apply>
       <min></min>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>N</ci>
        <ci>U</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>N</ci>
        <ci>D</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <eq></eq>
      <share href="#.cmml">
      </share>
      <apply>
       <min></min>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>N</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>P</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <apply>
        <plus></plus>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>N</ci>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>P</ci>
          <cn type="integer">2</cn>
         </apply>
        </apply>
        <apply>
         <times></times>
         <apply>
          <minus></minus>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>x</ci>
           <ci>D</ci>
          </apply>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>x</ci>
           <ci>M</ci>
          </apply>
         </apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>k</ci>
          <ci>j</ci>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
    <cn type="integer">10</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   N_{P}=\min\{N_{U}\ ,\ N_{D}\}=\min\{N_{P_{1}}\ ,\ N_{P_{2}}+(x_{D}-x_{M})k_{j}%
\}\qquad(10)
  </annotation>
 </semantics>
</math>

</p>

<p><em>This is Newell's the recipe for the 3-detector problem.</em></p>
<h2 id="see-also">See also</h2>
<ul>
<li><a href="Fundamental_diagram_of_traffic_flow" title="wikilink">Fundamental diagram of traffic flow</a></li>
<li><a href="Kerner’s_breakdown_minimization_principle" title="wikilink">Kerner’s breakdown minimization principle</a></li>
<li><a href="Microscopic_traffic_flow_model" title="wikilink">Microscopic traffic flow model</a></li>
<li><a class="uri" href="Microsimulation" title="wikilink">Microsimulation</a></li>
<li><a href="Newell's_Car_Following_Model" title="wikilink">Newell's Car Following Model</a></li>
<li><a href="Road_traffic_control" title="wikilink">Road traffic control</a></li>
<li><a href="Rule_184" title="wikilink">Rule 184</a></li>
<li><a href="Three-phase_traffic_theory" title="wikilink">Three-phase traffic theory</a></li>
<li><a href="Traffic_bottleneck" title="wikilink">Traffic bottleneck</a></li>
<li><a href="Traffic_congestion:_Reconstruction_with_Kerner’s_three-phase_theory" title="wikilink">Traffic congestion: Reconstruction with Kerner’s three-phase theory</a></li>
<li><a href="Traffic_counter" title="wikilink">Traffic counter</a></li>
<li><a href="Traffic_flow" title="wikilink">Traffic flow</a></li>
<li><a href="Traffic_wave" title="wikilink">Traffic wave</a></li>
</ul>
<h2 id="references">References</h2>

<p>"</p>

<p><a href="Category:Road_transport" title="wikilink">Category:Road transport</a> <a href="Category:Road_traffic_management" title="wikilink">Category:Road traffic management</a> <a href="Category:Transportation_engineering" title="wikilink">Category:Transportation engineering</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1">Daganzo, Carlos. 1997. Fundamentals of transportation and traffic operations. Oxford: Pergamon.<a href="#fnref1">↩</a></li>
<li id="fn2">Newell, G. F. 1993. "A simplified theory of kinematic waves in highway traffic. Part I, General theory". Transportation Research. Part B, Methodological. 27B (4).<a href="#fnref2">↩</a></li>
<li id="fn3">Newell, G. F. 1993. "A simplified theory of kinematic waves in highway traffic. Part II. Queuing at freeway bottlenecks". Transportation Research. Part B, Methodological. 27B (4).<a href="#fnref3">↩</a></li>
<li id="fn4">Newell, G. F. 1993. "A simplified theory of kinematic waves in highway traffic. Part III. Multi-destination flows". Transportation Research. Part B, Methodological. 27B (4).<a href="#fnref4">↩</a></li>
<li id="fn5">Daganzo, Carlos F. 2005. "A variational formulation of kinematic waves: solution methods". Transportation Research. Part B, Methodological. 39B (10).<a href="#fnref5">↩</a></li>
<li id="fn6">Daganzo, Carlos F. 2005. "A variational formulation of kinematic waves: basic theory and complex boundary conditions". Transportation Research. Part B, Methodological. 39B (2).<a href="#fnref6">↩</a></li>
<li id="fn7">Daganzo, Carlos F. 2006. "On the variational theory of traffic flow: well-posedness, duality and applications". Networks and Heterogeneous Media. 1 (4).<a href="#fnref7">↩</a></li>
<li id="fn8">Daganzo, Carlos F. Lecture notes: Operation of transportation facilities. Compiled by Offer Grembek<a href="#fnref8">↩</a></li>
</ol>
</section>
</body>
</html>

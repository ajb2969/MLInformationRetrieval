<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="987">Kirchhoff's diffraction formula</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Kirchhoff's diffraction formula</h1>
<hr/>

<p><strong><a href="Gustav_Kirchhoff" title="wikilink">Kirchhoff</a>'s diffraction formula</strong><a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a><a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a> (also <strong>Fresnel–Kirchhoff diffraction formula</strong>) can be used to model the <a href="Wave_propagation" title="wikilink">propagation</a> of light in a wide range of configurations, either <a href="Analytical_expression" title="wikilink">analytically</a> or using <a href="numerical_analysis" title="wikilink">numerical modelling</a>. It gives an expression for the wave disturbance when a <a class="uri" href="monochromatic" title="wikilink">monochromatic</a> <a href="Wave_equation#Spherical_waves" title="wikilink">spherical wave</a> passes through an opening in an <a href="Opacity_(optics)" title="wikilink">opaque</a> screen. The equation is derived by making several approximations to the <a href="Kirchhoff_integral_theorem" title="wikilink">Kirchhoff integral theorem</a> which uses <a href="Green's_theorem" title="wikilink">Green's theorem</a> to derive the solution to the homogeneous <a href="wave_equation" title="wikilink">wave equation</a>.</p>
<h2 id="derivation-of-kirchhoffs-diffraction-formula">Derivation of Kirchhoff's diffraction formula</h2>

<p><a href="Kirchhoff_integral_theorem" title="wikilink">Kirchhoff's integral theorem</a>, sometimes referred to as the Fresnel–Kirchhoff integral theorem,<a class="footnoteRef" href="#fn3" id="fnref3"><sup>3</sup></a> uses <a href="Green's_theorem" title="wikilink">Green's theorem</a> to derive the solution to the homogeneous <a href="wave_equation" title="wikilink">wave equation</a> at an arbitrary point <strong>P</strong> in terms of the values of the solution of the wave equation and its first order derivative at all points on an arbitrary surface which encloses <strong>P</strong>.</p>

<p>The solution provided by the integral theorem for a <a class="uri" href="monochromatic" title="wikilink">monochromatic</a> source is:</p>

<p>

<math display="block" id="Kirchhoff's_diffraction_formula:0">
 <semantics>
  <mrow>
   <mrow>
    <mi>U</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>P</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mo>-</mo>
    <mrow>
     <mfrac>
      <mn>1</mn>
      <mrow>
       <mn>4</mn>
       <mi>π</mi>
      </mrow>
     </mfrac>
     <mrow>
      <msub>
       <mo largeop="true" symmetric="true">∫</mo>
       <mi>S</mi>
      </msub>
      <mrow>
       <mrow>
        <mo>[</mo>
        <mrow>
         <mrow>
          <mi>U</mi>
          <mfrac>
           <mo>∂</mo>
           <mrow>
            <mo>∂</mo>
            <mi>n</mi>
           </mrow>
          </mfrac>
          <mrow>
           <mo>(</mo>
           <mfrac>
            <msup>
             <mi>e</mi>
             <mrow>
              <mi>i</mi>
              <mi>k</mi>
              <mi>s</mi>
             </mrow>
            </msup>
            <mi>s</mi>
           </mfrac>
           <mo>)</mo>
          </mrow>
         </mrow>
         <mo>-</mo>
         <mrow>
          <mfrac>
           <msup>
            <mi>e</mi>
            <mrow>
             <mi>i</mi>
             <mi>k</mi>
             <mi>s</mi>
            </mrow>
           </msup>
           <mi>s</mi>
          </mfrac>
          <mfrac>
           <mrow>
            <mo>∂</mo>
            <mi>U</mi>
           </mrow>
           <mrow>
            <mo>∂</mo>
            <mi>n</mi>
           </mrow>
          </mfrac>
         </mrow>
        </mrow>
        <mo>]</mo>
       </mrow>
       <mi>d</mi>
       <mi>S</mi>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>U</ci>
     <ci>P</ci>
    </apply>
    <apply>
     <minus></minus>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <apply>
        <times></times>
        <cn type="integer">4</cn>
        <ci>π</ci>
       </apply>
      </apply>
      <apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <int></int>
        <ci>S</ci>
       </apply>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="latexml">delimited-[]</csymbol>
         <apply>
          <minus></minus>
          <apply>
           <times></times>
           <ci>U</ci>
           <apply>
            <divide></divide>
            <partialdiff></partialdiff>
            <apply>
             <partialdiff></partialdiff>
             <ci>n</ci>
            </apply>
           </apply>
           <apply>
            <divide></divide>
            <apply>
             <csymbol cd="ambiguous">superscript</csymbol>
             <ci>e</ci>
             <apply>
              <times></times>
              <ci>i</ci>
              <ci>k</ci>
              <ci>s</ci>
             </apply>
            </apply>
            <ci>s</ci>
           </apply>
          </apply>
          <apply>
           <times></times>
           <apply>
            <divide></divide>
            <apply>
             <csymbol cd="ambiguous">superscript</csymbol>
             <ci>e</ci>
             <apply>
              <times></times>
              <ci>i</ci>
              <ci>k</ci>
              <ci>s</ci>
             </apply>
            </apply>
            <ci>s</ci>
           </apply>
           <apply>
            <divide></divide>
            <apply>
             <partialdiff></partialdiff>
             <ci>U</ci>
            </apply>
            <apply>
             <partialdiff></partialdiff>
             <ci>n</ci>
            </apply>
           </apply>
          </apply>
         </apply>
        </apply>
        <ci>d</ci>
        <ci>S</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   U(P)=-\frac{1}{4\pi}\int_{S}\left[U\frac{\partial}{\partial n}\left(\frac{e^{%
iks}}{s}\right)-\frac{e^{iks}}{s}\frac{\partial U}{\partial n}\right]dS
  </annotation>
 </semantics>
</math>

</p>

<p>where <em>U</em> is the <a href="complex_amplitude" title="wikilink">complex amplitude</a> of the disturbance at the surface, <em>k</em> is the <a class="uri" href="wavenumber" title="wikilink">wavenumber</a> and <em>s</em> is the distance from <strong>P</strong> to the surface.</p>

<p>The assumptions made are:</p>
<ul>
<li><em>U</em> and ∂<em>U</em>/∂<em>n</em> are discontinuous at the boundaries of the aperture</li>
<li>the distance to the point source and <em>s</em> are much greater than λ</li>
</ul>
<h3 id="point-source">Point source</h3>

<p> Consider a monochromatic point source at <strong>P<sub>0</sub></strong> which illuminates an aperture in a screen. The energy of the wave emitted by a point source falls off as the inverse square of the distance travelled, so the amplitude falls off as the inverse of the distance. The complex amplitude of the disturbance at a distance <em>r</em> is given by</p>

<p>

<math display="block" id="Kirchhoff's_diffraction_formula:1">
 <semantics>
  <mrow>
   <mrow>
    <mi>U</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>r</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mfrac>
    <mrow>
     <mi>a</mi>
     <msup>
      <mi>e</mi>
      <mrow>
       <mi>i</mi>
       <mi>k</mi>
       <mi>r</mi>
      </mrow>
     </msup>
    </mrow>
    <mi>r</mi>
   </mfrac>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>U</ci>
     <ci>r</ci>
    </apply>
    <apply>
     <divide></divide>
     <apply>
      <times></times>
      <ci>a</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>e</ci>
       <apply>
        <times></times>
        <ci>i</ci>
        <ci>k</ci>
        <ci>r</ci>
       </apply>
      </apply>
     </apply>
     <ci>r</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   U(r)=\frac{ae^{ikr}}{r}
  </annotation>
 </semantics>
</math>

</p>

<p>where <em>a</em> represents the <a href="magnitude_(mathematics)#Complex_numbers" title="wikilink">magnitude</a> of the disturbance at the point source.</p>

<p>The disturbance at a point <strong>P</strong> can be found by applying the integral theorem to the closed surface which is formed by the intersection of a sphere of radius <strong>R</strong> with the screen. The integration is performed over the areas <em>A</em><sub>1</sub>, <em>A</em><sub>2</sub> and <em>A</em><sub>3</sub> giving</p>

<p>

<math display="block" id="Kirchhoff's_diffraction_formula:2">
 <semantics>
  <mrow>
   <mrow>
    <mi>U</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>P</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mfrac>
     <mn>1</mn>
     <mrow>
      <mn>4</mn>
      <mi>π</mi>
     </mrow>
    </mfrac>
    <mrow>
     <mo>[</mo>
     <mrow>
      <msub>
       <mo largeop="true" symmetric="true">∫</mo>
       <msub>
        <mi>A</mi>
        <mn>1</mn>
       </msub>
      </msub>
      <mo>+</mo>
      <msub>
       <mo largeop="true" symmetric="true">∫</mo>
       <msub>
        <mi>A</mi>
        <mn>2</mn>
       </msub>
      </msub>
      <mo>+</mo>
      <mrow>
       <msub>
        <mo largeop="true" symmetric="true">∫</mo>
        <msub>
         <mi>A</mi>
         <mn>3</mn>
        </msub>
       </msub>
       <mrow>
        <mo>(</mo>
        <mrow>
         <mrow>
          <mi>U</mi>
          <mfrac>
           <mo>∂</mo>
           <mrow>
            <mo>∂</mo>
            <mi>n</mi>
           </mrow>
          </mfrac>
          <mrow>
           <mo>(</mo>
           <mfrac>
            <msup>
             <mi>e</mi>
             <mrow>
              <mi>i</mi>
              <mi>k</mi>
              <mi>s</mi>
             </mrow>
            </msup>
            <mi>s</mi>
           </mfrac>
           <mo>)</mo>
          </mrow>
         </mrow>
         <mo>-</mo>
         <mrow>
          <mfrac>
           <msup>
            <mi>e</mi>
            <mrow>
             <mi>i</mi>
             <mi>k</mi>
             <mi>s</mi>
            </mrow>
           </msup>
           <mi>s</mi>
          </mfrac>
          <mfrac>
           <mrow>
            <mo>∂</mo>
            <mi>U</mi>
           </mrow>
           <mrow>
            <mo>∂</mo>
            <mi>n</mi>
           </mrow>
          </mfrac>
         </mrow>
        </mrow>
        <mo>)</mo>
       </mrow>
      </mrow>
     </mrow>
     <mo>]</mo>
    </mrow>
    <mi>d</mi>
    <mi>S</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>U</ci>
     <ci>P</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <divide></divide>
      <cn type="integer">1</cn>
      <apply>
       <times></times>
       <cn type="integer">4</cn>
       <ci>π</ci>
      </apply>
     </apply>
     <apply>
      <csymbol cd="latexml">delimited-[]</csymbol>
      <apply>
       <plus></plus>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <int></int>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>A</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <int></int>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>A</ci>
         <cn type="integer">2</cn>
        </apply>
       </apply>
       <apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <int></int>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>A</ci>
          <cn type="integer">3</cn>
         </apply>
        </apply>
        <apply>
         <minus></minus>
         <apply>
          <times></times>
          <ci>U</ci>
          <apply>
           <divide></divide>
           <partialdiff></partialdiff>
           <apply>
            <partialdiff></partialdiff>
            <ci>n</ci>
           </apply>
          </apply>
          <apply>
           <divide></divide>
           <apply>
            <csymbol cd="ambiguous">superscript</csymbol>
            <ci>e</ci>
            <apply>
             <times></times>
             <ci>i</ci>
             <ci>k</ci>
             <ci>s</ci>
            </apply>
           </apply>
           <ci>s</ci>
          </apply>
         </apply>
         <apply>
          <times></times>
          <apply>
           <divide></divide>
           <apply>
            <csymbol cd="ambiguous">superscript</csymbol>
            <ci>e</ci>
            <apply>
             <times></times>
             <ci>i</ci>
             <ci>k</ci>
             <ci>s</ci>
            </apply>
           </apply>
           <ci>s</ci>
          </apply>
          <apply>
           <divide></divide>
           <apply>
            <partialdiff></partialdiff>
            <ci>U</ci>
           </apply>
           <apply>
            <partialdiff></partialdiff>
            <ci>n</ci>
           </apply>
          </apply>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
     <ci>d</ci>
     <ci>S</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   U(P)=\frac{1}{4\pi}\left[\int_{A_{1}}+\int_{A_{2}}+\int_{A_{3}}\left(U\frac{%
\partial}{\partial n}\left(\frac{e^{iks}}{s}\right)-\frac{e^{iks}}{s}\frac{%
\partial U}{\partial n}\right)\right]dS
  </annotation>
 </semantics>
</math>

</p>

<p>To solve the equation, it is assumed that the values of <em>U</em> and <em>∂U/∂n</em> in the area A<sub>1</sub> are the same as when the screen is not present, giving:</p>

<p>

<math display="block" id="Kirchhoff's_diffraction_formula:3">
 <semantics>
  <mrow>
   <msub>
    <mi>U</mi>
    <msub>
     <mi>A</mi>
     <mn>1</mn>
    </msub>
   </msub>
   <mo>=</mo>
   <mfrac>
    <mrow>
     <mi>a</mi>
     <msup>
      <mi>e</mi>
      <mrow>
       <mi>i</mi>
       <mi>k</mi>
       <mi>r</mi>
      </mrow>
     </msup>
    </mrow>
    <mi>r</mi>
   </mfrac>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>U</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>A</ci>
      <cn type="integer">1</cn>
     </apply>
    </apply>
    <apply>
     <divide></divide>
     <apply>
      <times></times>
      <ci>a</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>e</ci>
       <apply>
        <times></times>
        <ci>i</ci>
        <ci>k</ci>
        <ci>r</ci>
       </apply>
      </apply>
     </apply>
     <ci>r</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   U_{A_{1}}=\frac{ae^{ikr}}{r}
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Kirchhoff's_diffraction_formula:4">
 <semantics>
  <mrow>
   <mfrac>
    <mrow>
     <mo>∂</mo>
     <msub>
      <mi>U</mi>
      <msub>
       <mi>A</mi>
       <mn>1</mn>
      </msub>
     </msub>
    </mrow>
    <mrow>
     <mo>∂</mo>
     <mi>n</mi>
    </mrow>
   </mfrac>
   <mo>=</mo>
   <mrow>
    <mfrac>
     <mrow>
      <mi>a</mi>
      <msup>
       <mi>e</mi>
       <mrow>
        <mi>i</mi>
        <mi>k</mi>
        <mi>r</mi>
       </mrow>
      </msup>
     </mrow>
     <mi>r</mi>
    </mfrac>
    <mrow>
     <mo>[</mo>
     <mrow>
      <mrow>
       <mi>i</mi>
       <mi>k</mi>
      </mrow>
      <mo>-</mo>
      <mfrac>
       <mn>1</mn>
       <mi>r</mi>
      </mfrac>
     </mrow>
     <mo>]</mo>
    </mrow>
    <mrow>
     <mi>cos</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>n</mi>
      <mo>,</mo>
      <mi>r</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <divide></divide>
     <apply>
      <partialdiff></partialdiff>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>U</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>A</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
     </apply>
     <apply>
      <partialdiff></partialdiff>
      <ci>n</ci>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <divide></divide>
      <apply>
       <times></times>
       <ci>a</ci>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>e</ci>
        <apply>
         <times></times>
         <ci>i</ci>
         <ci>k</ci>
         <ci>r</ci>
        </apply>
       </apply>
      </apply>
      <ci>r</ci>
     </apply>
     <apply>
      <csymbol cd="latexml">delimited-[]</csymbol>
      <apply>
       <minus></minus>
       <apply>
        <times></times>
        <ci>i</ci>
        <ci>k</ci>
       </apply>
       <apply>
        <divide></divide>
        <cn type="integer">1</cn>
        <ci>r</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <cos></cos>
      <ci>n</ci>
      <ci>r</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \frac{\partial U_{A_{1}}}{\partial n}=\frac{ae^{ikr}}{r}\left[ik-\frac{1}{r}%
\right]\cos{(n,r)}
  </annotation>
 </semantics>
</math>

</p>

<p>at <strong>Q</strong>, <em>r</em> is the length <strong>P<sub>0</sub>Q</strong>, and (<em>n,r</em>) is the angle between <strong>P<sub>0</sub>Q</strong> and the normal to the aperture.</p>

<p>Kirchhoff assumes that the values of <em>U</em> and <em>∂U/∂n</em> in <em>A</em><sub>2</sub> are zero. This implies that <em>U</em> and ∂<em>U</em>/∂<em>n</em> are discontinuous at the edge of the aperture. This is not the case, and this is one of the approximations used in deriving the equation. These assumptions are sometimes referred to as Kirchhoff's boundary conditions.</p>

<p>The contribution from <em>A</em><sub>3</sub> to the integral is also assumed to be zero. This can be justified by making the assumption that the source starts to radiate at a particular time, and then by making <em>R</em> large enough, so that when the disturbance at <strong>P</strong> is being considered, no contributions from <em>A</em><sub>3</sub> will have arrived there.<a class="footnoteRef" href="#fn4" id="fnref4"><sup>4</sup></a> Such a wave is no longer <a class="uri" href="monochromatic" title="wikilink">monochromatic</a>, since a monochromatic wave must exist at all times, but that assumption is not necessary, and a more formal argument avoiding its use has been derived.<a class="footnoteRef" href="#fn5" id="fnref5"><sup>5</sup></a></p>

<p>We have</p>

<p>

<math display="block" id="Kirchhoff's_diffraction_formula:5">
 <semantics>
  <mrow>
   <mrow>
    <mfrac>
     <mo>∂</mo>
     <mrow>
      <mo>∂</mo>
      <mi>n</mi>
     </mrow>
    </mfrac>
    <mrow>
     <mo>(</mo>
     <mfrac>
      <msup>
       <mi>e</mi>
       <mrow>
        <mi>i</mi>
        <mi>k</mi>
        <mi>s</mi>
       </mrow>
      </msup>
      <mi>s</mi>
     </mfrac>
     <mo>)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mfrac>
     <msup>
      <mi>e</mi>
      <mrow>
       <mi>i</mi>
       <mi>k</mi>
       <mi>s</mi>
      </mrow>
     </msup>
     <mi>s</mi>
    </mfrac>
    <mrow>
     <mo>[</mo>
     <mrow>
      <mrow>
       <mi>i</mi>
       <mi>k</mi>
      </mrow>
      <mo>-</mo>
      <mfrac>
       <mn>1</mn>
       <mi>s</mi>
      </mfrac>
     </mrow>
     <mo>]</mo>
    </mrow>
    <mrow>
     <mi>cos</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>n</mi>
      <mo>,</mo>
      <mi>s</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <divide></divide>
      <partialdiff></partialdiff>
      <apply>
       <partialdiff></partialdiff>
       <ci>n</ci>
      </apply>
     </apply>
     <apply>
      <divide></divide>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>e</ci>
       <apply>
        <times></times>
        <ci>i</ci>
        <ci>k</ci>
        <ci>s</ci>
       </apply>
      </apply>
      <ci>s</ci>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <divide></divide>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>e</ci>
       <apply>
        <times></times>
        <ci>i</ci>
        <ci>k</ci>
        <ci>s</ci>
       </apply>
      </apply>
      <ci>s</ci>
     </apply>
     <apply>
      <csymbol cd="latexml">delimited-[]</csymbol>
      <apply>
       <minus></minus>
       <apply>
        <times></times>
        <ci>i</ci>
        <ci>k</ci>
       </apply>
       <apply>
        <divide></divide>
        <cn type="integer">1</cn>
        <ci>s</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <cos></cos>
      <ci>n</ci>
      <ci>s</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \frac{\partial}{\partial n}\left(\frac{e^{iks}}{s}\right)=\frac{e^{iks}}{s}%
\left[ik-\frac{1}{s}\right]\cos{(n,s)}
  </annotation>
 </semantics>
</math>

</p>

<p>where (<em>n,s</em>) is the angle between the normal to the aperture and <strong>PQ</strong>.</p>

<p>Finally, the terms 1/<em>r</em> and 1/<em>s</em> are assumed to be negligible compared with <em>k</em>, since ''r '' and'' s'' are generally much greater than 2π/<em>k</em> which is equal to the <a class="uri" href="wavelength" title="wikilink">wavelength</a>. Thus, the integral above, which represents the complex amplitude at <strong>P</strong>, becomes:</p>

<p>

<math display="block" id="Kirchhoff's_diffraction_formula:6">
 <semantics>
  <mrow>
   <mrow>
    <mi>U</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>P</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mo>-</mo>
    <mrow>
     <mfrac>
      <mrow>
       <mi>i</mi>
       <mi>a</mi>
      </mrow>
      <mrow>
       <mn>2</mn>
       <mi>λ</mi>
      </mrow>
     </mfrac>
     <mrow>
      <msub>
       <mo largeop="true" symmetric="true">∫</mo>
       <mi>S</mi>
      </msub>
      <mrow>
       <mfrac>
        <msup>
         <mi>e</mi>
         <mrow>
          <mi>i</mi>
          <mi>k</mi>
          <mrow>
           <mo stretchy="false">(</mo>
           <mrow>
            <mi>r</mi>
            <mo>+</mo>
            <mi>s</mi>
           </mrow>
           <mo stretchy="false">)</mo>
          </mrow>
         </mrow>
        </msup>
        <mrow>
         <mi>r</mi>
         <mi>s</mi>
        </mrow>
       </mfrac>
       <mrow>
        <mo stretchy="false">[</mo>
        <mrow>
         <mrow>
          <mi>cos</mi>
          <mrow>
           <mo stretchy="false">(</mo>
           <mi>n</mi>
           <mo>,</mo>
           <mi>r</mi>
           <mo stretchy="false">)</mo>
          </mrow>
         </mrow>
         <mo>-</mo>
         <mrow>
          <mi>cos</mi>
          <mrow>
           <mo stretchy="false">(</mo>
           <mi>n</mi>
           <mo>,</mo>
           <mi>s</mi>
           <mo stretchy="false">)</mo>
          </mrow>
         </mrow>
        </mrow>
        <mo stretchy="false">]</mo>
       </mrow>
       <mi>d</mi>
       <mi>S</mi>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>U</ci>
     <ci>P</ci>
    </apply>
    <apply>
     <minus></minus>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <apply>
        <times></times>
        <ci>i</ci>
        <ci>a</ci>
       </apply>
       <apply>
        <times></times>
        <cn type="integer">2</cn>
        <ci>λ</ci>
       </apply>
      </apply>
      <apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <int></int>
        <ci>S</ci>
       </apply>
       <apply>
        <times></times>
        <apply>
         <divide></divide>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>e</ci>
          <apply>
           <times></times>
           <ci>i</ci>
           <ci>k</ci>
           <apply>
            <plus></plus>
            <ci>r</ci>
            <ci>s</ci>
           </apply>
          </apply>
         </apply>
         <apply>
          <times></times>
          <ci>r</ci>
          <ci>s</ci>
         </apply>
        </apply>
        <apply>
         <csymbol cd="latexml">delimited-[]</csymbol>
         <apply>
          <minus></minus>
          <apply>
           <cos></cos>
           <ci>n</ci>
           <ci>r</ci>
          </apply>
          <apply>
           <cos></cos>
           <ci>n</ci>
           <ci>s</ci>
          </apply>
         </apply>
        </apply>
        <ci>d</ci>
        <ci>S</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   U(P)=-\frac{ia}{2\lambda}\int_{S}{\frac{e^{ik(r+s)}}{rs}[\cos(n,r)-\cos(n,s)]}dS
  </annotation>
 </semantics>
</math>

</p>

<p>This is the Kirchhoff or Fresnel–Kirchhoff diffraction formula.</p>
<figure><b>(Figure)</b>
<figcaption>Geometric arrangement used to express Kirchhoff's formula in a form similar to Huygens–Fresnel</figcaption>
</figure>
<h4 id="equivalence-to-huygensfresnel-equation">Equivalence to Huygens–Fresnel equation</h4>

<p>The <a href="Huygens–Fresnel_principle" title="wikilink">Huygens–Fresnel principle</a> can be derived by integrating over a different closed surface. The area <em>A</em><sub>1</sub> above is replaced by a wavefront from <em>P</em><sub>0</sub> which almost fills the aperture, and a portion of a cone with a vertex at <em>P</em><sub>0</sub> which is labelled <em>A</em><sub>4</sub> in the diagram. If the radius of curvature of the wave is large enough, the contribution from <em>A</em><sub>4</sub> can be neglected. We also have</p>

<p>

<math display="block" id="Kirchhoff's_diffraction_formula:7">
 <semantics>
  <mrow>
   <mi>χ</mi>
   <mo>=</mo>
   <mrow>
    <mi>π</mi>
    <mo>-</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <msub>
      <mi>r</mi>
      <mn>0</mn>
     </msub>
     <mo>,</mo>
     <mi>s</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>χ</ci>
    <apply>
     <minus></minus>
     <ci>π</ci>
     <interval closure="open">
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>r</ci>
       <cn type="integer">0</cn>
      </apply>
      <ci>s</ci>
     </interval>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \chi=\pi-(r_{0},s)
  </annotation>
 </semantics>
</math>

</p>

<p>where χ is as defined in <a href="Huygens–Fresnel_principle" title="wikilink">Huygens–Fresnel principle</a> and cos(<em>n, r</em>) = 1. The complex amplitude of the wavefront at <em>r</em><sub>0</sub> is given by:</p>

<p>

<math display="block" id="Kirchhoff's_diffraction_formula:8">
 <semantics>
  <mrow>
   <mrow>
    <mi>U</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <msub>
      <mi>r</mi>
      <mn>0</mn>
     </msub>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mfrac>
    <mrow>
     <mi>a</mi>
     <msup>
      <mi>e</mi>
      <mrow>
       <mi>i</mi>
       <mi>k</mi>
       <msub>
        <mi>r</mi>
        <mn>0</mn>
       </msub>
      </mrow>
     </msup>
    </mrow>
    <msub>
     <mi>r</mi>
     <mn>0</mn>
    </msub>
   </mfrac>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>U</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>r</ci>
      <cn type="integer">0</cn>
     </apply>
    </apply>
    <apply>
     <divide></divide>
     <apply>
      <times></times>
      <ci>a</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>e</ci>
       <apply>
        <times></times>
        <ci>i</ci>
        <ci>k</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>r</ci>
         <cn type="integer">0</cn>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>r</ci>
      <cn type="integer">0</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   U(r_{0})=\frac{ae^{ikr_{0}}}{r_{0}}
  </annotation>
 </semantics>
</math>

</p>

<p>The diffraction formula becomes;</p>

<p>

<math display="block" id="Kirchhoff's_diffraction_formula:9">
 <semantics>
  <mrow>
   <mrow>
    <mi>U</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>P</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mo>-</mo>
    <mrow>
     <mfrac>
      <mi>i</mi>
      <mrow>
       <mn>2</mn>
       <mi>λ</mi>
      </mrow>
     </mfrac>
     <mfrac>
      <mrow>
       <mi>a</mi>
       <msup>
        <mi>e</mi>
        <mrow>
         <mi>i</mi>
         <mi>k</mi>
         <msub>
          <mi>r</mi>
          <mn>0</mn>
         </msub>
        </mrow>
       </msup>
      </mrow>
      <msub>
       <mi>r</mi>
       <mn>0</mn>
      </msub>
     </mfrac>
     <mrow>
      <msub>
       <mo largeop="true" symmetric="true">∫</mo>
       <mi>S</mi>
      </msub>
      <mrow>
       <mfrac>
        <msup>
         <mi>e</mi>
         <mrow>
          <mi>i</mi>
          <mi>k</mi>
          <mi>s</mi>
         </mrow>
        </msup>
        <mi>s</mi>
       </mfrac>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mn>1</mn>
         <mo>+</mo>
         <mrow>
          <mi>cos</mi>
          <mi>χ</mi>
         </mrow>
        </mrow>
        <mo rspace="4.2pt" stretchy="false">)</mo>
       </mrow>
       <mi>d</mi>
       <mi>S</mi>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>U</ci>
     <ci>P</ci>
    </apply>
    <apply>
     <minus></minus>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <ci>i</ci>
       <apply>
        <times></times>
        <cn type="integer">2</cn>
        <ci>λ</ci>
       </apply>
      </apply>
      <apply>
       <divide></divide>
       <apply>
        <times></times>
        <ci>a</ci>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>e</ci>
         <apply>
          <times></times>
          <ci>i</ci>
          <ci>k</ci>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>r</ci>
           <cn type="integer">0</cn>
          </apply>
         </apply>
        </apply>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>r</ci>
        <cn type="integer">0</cn>
       </apply>
      </apply>
      <apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <int></int>
        <ci>S</ci>
       </apply>
       <apply>
        <times></times>
        <apply>
         <divide></divide>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>e</ci>
          <apply>
           <times></times>
           <ci>i</ci>
           <ci>k</ci>
           <ci>s</ci>
          </apply>
         </apply>
         <ci>s</ci>
        </apply>
        <apply>
         <plus></plus>
         <cn type="integer">1</cn>
         <apply>
          <cos></cos>
          <ci>χ</ci>
         </apply>
        </apply>
        <ci>d</ci>
        <ci>S</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   U(P)=-\frac{i}{2\lambda}\frac{ae^{ikr_{0}}}{r_{0}}\int_{S}\frac{e^{iks}}{s}(1+%
\cos\chi)\,dS
  </annotation>
 </semantics>
</math>

</p>

<p>This is the Kirchhoff's diffraction formula which contains parameters which had to be arbitrarily assigned in the derivation of the <a href="Huygens–Fresnel_principle" title="wikilink">Huygens–Fresnel</a> equation.</p>
<h3 id="extended-source">Extended source</h3>

<p>Assume that the aperture is illuminated by an extended source wave.<a class="footnoteRef" href="#fn6" id="fnref6"><sup>6</sup></a> The complex amplitude at the aperture is given by <em>U</em><sub>0</sub>(<em>r</em>)</p>

<p>It is assumed, as before, that the values of <em>U</em> and <em>∂U/∂n</em> in the area <em>A</em><sub>1</sub> are the same as when the screen is not present, that the values of <em>U</em> and ∂<em>U</em>/<em>∂n</em> in <em>A</em><sub>2</sub> are zero (Kirchhoff's boundary conditions) and that the contribution from <em>A</em><sub>3</sub> to the integral are also zero. It is also assumed that 1/<em>s</em> is negligible compared with <em>k</em>. We then have</p>

<p>{s} \left[ ik U_0(r) \cos(n,s) + \frac {\partial U_0(r)}{\partial n} \right] dS  |cellpadding |border |border colour = #50C878 |background colour = #ECFCF4}}</p>

<p>This is the most general form of the Kirchhoff diffraction formula. To solve this equation for an extended source, an additional integration would be required to sum the contributions made by the individual points in the source. If, however, we assume that the light from the source at each point in the aperture has a well-defined direction, which is the case if the distance between the source and the aperture is significantly greater than the wavelength, then we can write</p>

<p>

<math display="block" id="Kirchhoff's_diffraction_formula:10">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>U</mi>
     <mn>0</mn>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>r</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>≈</mo>
   <mrow>
    <mi>a</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>r</mi>
     <mo stretchy="false">)</mo>
    </mrow>
    <msup>
     <mi>e</mi>
     <mrow>
      <mo>-</mo>
      <mrow>
       <mi>i</mi>
       <mi>k</mi>
       <mi>r</mi>
      </mrow>
     </mrow>
    </msup>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <approx></approx>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>U</ci>
      <cn type="integer">0</cn>
     </apply>
     <ci>r</ci>
    </apply>
    <apply>
     <times></times>
     <ci>a</ci>
     <ci>r</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>e</ci>
      <apply>
       <minus></minus>
       <apply>
        <times></times>
        <ci>i</ci>
        <ci>k</ci>
        <ci>r</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   U_{0}(r)\approx a(r)e^{-ikr}
  </annotation>
 </semantics>
</math>

</p>

<p>where <em>a</em>(<em>r</em>) is the magnitude of the disturbance at the point <em>r</em> in the aperture. We then have:</p>

<p>

<math display="block" id="Kirchhoff's_diffraction_formula:11">
 <semantics>
  <mrow>
   <mfrac>
    <mrow>
     <mrow>
      <mo>∂</mo>
      <msub>
       <mi>U</mi>
       <mn>0</mn>
      </msub>
     </mrow>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>r</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mrow>
     <mo>∂</mo>
     <mi>n</mi>
    </mrow>
   </mfrac>
   <mo>=</mo>
   <mrow>
    <mo>-</mo>
    <mrow>
     <mi>i</mi>
     <mi>k</mi>
     <mi>a</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>r</mi>
      <mo stretchy="false">)</mo>
     </mrow>
     <mrow>
      <mi>cos</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>n</mi>
       <mo>,</mo>
       <mi>r</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <divide></divide>
     <apply>
      <times></times>
      <apply>
       <partialdiff></partialdiff>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>U</ci>
        <cn type="integer">0</cn>
       </apply>
      </apply>
      <ci>r</ci>
     </apply>
     <apply>
      <partialdiff></partialdiff>
      <ci>n</ci>
     </apply>
    </apply>
    <apply>
     <minus></minus>
     <apply>
      <times></times>
      <ci>i</ci>
      <ci>k</ci>
      <ci>a</ci>
      <ci>r</ci>
      <apply>
       <cos></cos>
       <ci>n</ci>
       <ci>r</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \frac{\partial{U_{0}(r)}}{\partial n}=-ika(r)\cos{(n,r)}
  </annotation>
 </semantics>
</math>

</p>

<p>We then have:</p>

<p>

<math display="block" id="Kirchhoff's_diffraction_formula:12">
 <semantics>
  <mrow>
   <mrow>
    <mi>U</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>P</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mo>-</mo>
    <mrow>
     <mfrac>
      <mi>i</mi>
      <mrow>
       <mn>2</mn>
       <mi>λ</mi>
      </mrow>
     </mfrac>
     <mrow>
      <msub>
       <mo largeop="true" symmetric="true">∫</mo>
       <mi>S</mi>
      </msub>
      <mrow>
       <mi>a</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>r</mi>
        <mo stretchy="false">)</mo>
       </mrow>
       <mfrac>
        <msup>
         <mi>e</mi>
         <mrow>
          <mi>i</mi>
          <mi>k</mi>
          <mi>s</mi>
         </mrow>
        </msup>
        <mi>s</mi>
       </mfrac>
       <mrow>
        <mo stretchy="false">[</mo>
        <mrow>
         <mrow>
          <mi>cos</mi>
          <mrow>
           <mo stretchy="false">(</mo>
           <mi>n</mi>
           <mo>,</mo>
           <mi>r</mi>
           <mo stretchy="false">)</mo>
          </mrow>
         </mrow>
         <mo>-</mo>
         <mrow>
          <mi>cos</mi>
          <mrow>
           <mo stretchy="false">(</mo>
           <mi>n</mi>
           <mo>,</mo>
           <mi>s</mi>
           <mo stretchy="false">)</mo>
          </mrow>
         </mrow>
        </mrow>
        <mo stretchy="false">]</mo>
       </mrow>
       <mi>d</mi>
       <mi>S</mi>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>U</ci>
     <ci>P</ci>
    </apply>
    <apply>
     <minus></minus>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <ci>i</ci>
       <apply>
        <times></times>
        <cn type="integer">2</cn>
        <ci>λ</ci>
       </apply>
      </apply>
      <apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <int></int>
        <ci>S</ci>
       </apply>
       <apply>
        <times></times>
        <ci>a</ci>
        <ci>r</ci>
        <apply>
         <divide></divide>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>e</ci>
          <apply>
           <times></times>
           <ci>i</ci>
           <ci>k</ci>
           <ci>s</ci>
          </apply>
         </apply>
         <ci>s</ci>
        </apply>
        <apply>
         <csymbol cd="latexml">delimited-[]</csymbol>
         <apply>
          <minus></minus>
          <apply>
           <cos></cos>
           <ci>n</ci>
           <ci>r</ci>
          </apply>
          <apply>
           <cos></cos>
           <ci>n</ci>
           <ci>s</ci>
          </apply>
         </apply>
        </apply>
        <ci>d</ci>
        <ci>S</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   U(P)=-\frac{i}{2\lambda}\int_{S}{a(r)\frac{e^{iks}}{s}[\cos(n,r)-\cos(n,s)]}dS
  </annotation>
 </semantics>
</math>

</p>
<h2 id="fraunhofer-and-fresnel-diffraction-equations">Fraunhofer and Fresnel diffraction equations</h2>

<p>In spite of the various approximations which were made in arriving at the formula, it is adequate to describe the majority of problems in instrumental optics. This is mainly because the wavelength of light is much smaller than the dimensions of any obstacles encountered. Analytical solutions are not possible for most configurations, but the <a href="Fresnel_diffraction" title="wikilink">Fresnel diffraction</a> equation and <a href="Fraunhofer_diffraction" title="wikilink">Fraunhofer diffraction</a> equation, which are approximations of Kirchhoff's formula for the <a href="near_and_far_field#Near_field" title="wikilink">near field</a> and <a href="near_and_far_field#Far_field" title="wikilink">far field</a>, can be applied to a very wide range of optical systems. One of the important assumptions made in arriving at the Kirchhoff diffraction formula is that <em>r,s</em> are significantly greater than λ. A further approximation can be made which significantly simplifies the equation further: this is that the distances <strong>P<sub>0</sub>Q</strong> and <strong>QP</strong> are much greater than the dimensions of the aperture. This allows one to make two further approximations:</p>
<ul>
<li>cos(<em>n, r</em>) − cos(<em>n, s</em>) is replaced with 2cos β where β is the angle between <strong>P<sub>0</sub>P</strong> and the normal to the aperture. The factor 1/<em>rs</em> is replaced with 1/''r's' '' where ''r', s' '' are the distances from <strong>P<sub>0</sub></strong> and <strong>P</strong> to the origin, which is located in the aperture. The complex amplitude then becomes:</li>
</ul>

<p>

<math display="block" id="Kirchhoff's_diffraction_formula:13">
 <semantics>
  <mrow>
   <mrow>
    <mi>U</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>P</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mo>-</mo>
    <mrow>
     <mfrac>
      <mrow>
       <mi>i</mi>
       <mi>a</mi>
       <mrow>
        <mi>cos</mi>
        <mi>β</mi>
       </mrow>
      </mrow>
      <mrow>
       <mi>λ</mi>
       <msup>
        <mi>r</mi>
        <mo>′</mo>
       </msup>
       <msup>
        <mi>s</mi>
        <mo>′</mo>
       </msup>
      </mrow>
     </mfrac>
     <mrow>
      <msub>
       <mo largeop="true" symmetric="true">∫</mo>
       <mi>S</mi>
      </msub>
      <mrow>
       <msup>
        <mi>e</mi>
        <mrow>
         <mi>i</mi>
         <mi>k</mi>
         <mrow>
          <mo stretchy="false">(</mo>
          <mrow>
           <mi>r</mi>
           <mo>+</mo>
           <mi>s</mi>
          </mrow>
          <mo stretchy="false">)</mo>
         </mrow>
        </mrow>
       </msup>
       <mi>d</mi>
       <mi>s</mi>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>U</ci>
     <ci>P</ci>
    </apply>
    <apply>
     <minus></minus>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <apply>
        <times></times>
        <ci>i</ci>
        <ci>a</ci>
        <apply>
         <cos></cos>
         <ci>β</ci>
        </apply>
       </apply>
       <apply>
        <times></times>
        <ci>λ</ci>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>r</ci>
         <ci>normal-′</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>s</ci>
         <ci>normal-′</ci>
        </apply>
       </apply>
      </apply>
      <apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <int></int>
        <ci>S</ci>
       </apply>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>e</ci>
         <apply>
          <times></times>
          <ci>i</ci>
          <ci>k</ci>
          <apply>
           <plus></plus>
           <ci>r</ci>
           <ci>s</ci>
          </apply>
         </apply>
        </apply>
        <ci>d</ci>
        <ci>s</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   U(P)=-\frac{ia\cos\beta}{\lambda r^{\prime}s^{\prime}}\int_{S}e^{ik(r+s)}ds
  </annotation>
 </semantics>
</math>

</p>
<ul>
<li>assume that the aperture lies in the <em>xy</em> plane, and the co-ordinates of <strong>P<sub>0</sub></strong>, <strong>P</strong> and <strong>Q</strong> (a general point in the aperture) are (<em>x<sub>0</sub>,y<sub>0</sub>,z<sub>0</sub></em>), (<em>x</em>,<em>y</em>,<em>z</em>) and (''x' <em>,</em>y' <em>,</em>0'') respectively. We then have:</li>
</ul>

<p>

<math display="block" id="Kirchhoff's_diffraction_formula:14">
 <semantics>
  <mrow>
   <msup>
    <mpadded lspace="3.3pt" width="+3.3pt">
     <mi>r</mi>
    </mpadded>
    <mn>2</mn>
   </msup>
   <mo>=</mo>
   <mrow>
    <msup>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <msub>
        <mi>x</mi>
        <mn>0</mn>
       </msub>
       <mo>-</mo>
       <msup>
        <mi>x</mi>
        <mo>′</mo>
       </msup>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <mn>2</mn>
    </msup>
    <mo>+</mo>
    <msup>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <msub>
        <mi>y</mi>
        <mn>0</mn>
       </msub>
       <mo>-</mo>
       <msup>
        <mi>y</mi>
        <mo>′</mo>
       </msup>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <mn>2</mn>
    </msup>
    <mo>+</mo>
    <msubsup>
     <mi>z</mi>
     <mn>0</mn>
     <mn>2</mn>
    </msubsup>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>r</ci>
     <cn type="integer">2</cn>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <minus></minus>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <cn type="integer">0</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>x</ci>
        <ci>normal-′</ci>
       </apply>
      </apply>
      <cn type="integer">2</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <minus></minus>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>y</ci>
        <cn type="integer">0</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>y</ci>
        <ci>normal-′</ci>
       </apply>
      </apply>
      <cn type="integer">2</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>z</ci>
       <cn type="integer">0</cn>
      </apply>
      <cn type="integer">2</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   ~{}r^{2}={(x_{0}-x^{\prime})^{2}+(y_{0}-y^{\prime})^{2}+z_{0}^{2}}
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Kirchhoff's_diffraction_formula:15">
 <semantics>
  <mrow>
   <msup>
    <mpadded lspace="3.3pt" width="+3.3pt">
     <mi>s</mi>
    </mpadded>
    <mn>2</mn>
   </msup>
   <mo>=</mo>
   <mrow>
    <msup>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mi>x</mi>
       <mo>-</mo>
       <msup>
        <mi>x</mi>
        <mo>′</mo>
       </msup>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <mn>2</mn>
    </msup>
    <mo>+</mo>
    <msup>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mi>y</mi>
       <mo>-</mo>
       <msup>
        <mi>y</mi>
        <mo>′</mo>
       </msup>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <mn>2</mn>
    </msup>
    <mo>+</mo>
    <msup>
     <mi>z</mi>
     <mn>2</mn>
    </msup>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>s</ci>
     <cn type="integer">2</cn>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <minus></minus>
       <ci>x</ci>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>x</ci>
        <ci>normal-′</ci>
       </apply>
      </apply>
      <cn type="integer">2</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <minus></minus>
       <ci>y</ci>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>y</ci>
        <ci>normal-′</ci>
       </apply>
      </apply>
      <cn type="integer">2</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>z</ci>
      <cn type="integer">2</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   ~{}s^{2}={(x-x^{\prime})^{2}+(y-y^{\prime})^{2}+z^{2}}
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Kirchhoff's_diffraction_formula:16">
 <semantics>
  <mrow>
   <msup>
    <mpadded lspace="3.3pt" width="+3.3pt">
     <mi>r</mi>
    </mpadded>
    <mrow>
     <mi mathvariant="normal">′</mi>
     <mn>2</mn>
    </mrow>
   </msup>
   <mo>=</mo>
   <mrow>
    <msubsup>
     <mi>x</mi>
     <mn>0</mn>
     <mn>2</mn>
    </msubsup>
    <mo>+</mo>
    <msubsup>
     <mi>y</mi>
     <mn>0</mn>
     <mn>2</mn>
    </msubsup>
    <mo>+</mo>
    <msubsup>
     <mi>z</mi>
     <mn>0</mn>
     <mn>2</mn>
    </msubsup>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>r</ci>
     <list>
      <ci>normal-′</ci>
      <cn type="integer">2</cn>
     </list>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <cn type="integer">0</cn>
      </apply>
      <cn type="integer">2</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>y</ci>
       <cn type="integer">0</cn>
      </apply>
      <cn type="integer">2</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>z</ci>
       <cn type="integer">0</cn>
      </apply>
      <cn type="integer">2</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   ~{}r^{\prime 2}=x_{0}^{2}+y_{0}^{2}+z_{0}^{2}
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Kirchhoff's_diffraction_formula:17">
 <semantics>
  <mrow>
   <msup>
    <mpadded lspace="3.3pt" width="+3.3pt">
     <mi>s</mi>
    </mpadded>
    <mrow>
     <mi mathvariant="normal">′</mi>
     <mn>2</mn>
    </mrow>
   </msup>
   <mo>=</mo>
   <mrow>
    <msup>
     <mi>x</mi>
     <mn>2</mn>
    </msup>
    <mo>+</mo>
    <msup>
     <mi>y</mi>
     <mn>2</mn>
    </msup>
    <mo>+</mo>
    <msup>
     <mi>z</mi>
     <mn>2</mn>
    </msup>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>s</ci>
     <list>
      <ci>normal-′</ci>
      <cn type="integer">2</cn>
     </list>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>x</ci>
      <cn type="integer">2</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>y</ci>
      <cn type="integer">2</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>z</ci>
      <cn type="integer">2</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   ~{}s^{\prime 2}=x^{2}+y^{2}+z^{2}
  </annotation>
 </semantics>
</math>

</p>

<p>We can express <em>r</em> and <em>s</em> as follows:</p>

<p>

<math display="block" id="Kirchhoff's_diffraction_formula:18">
 <semantics>
  <mrow>
   <mi>r</mi>
   <mo>=</mo>
   <mrow>
    <msup>
     <mi>r</mi>
     <mo>′</mo>
    </msup>
    <msup>
     <mrow>
      <mo>[</mo>
      <mrow>
       <mrow>
        <mn>1</mn>
        <mo>-</mo>
        <mfrac>
         <mrow>
          <mn>2</mn>
          <mrow>
           <mo stretchy="false">(</mo>
           <mrow>
            <mrow>
             <msub>
              <mi>x</mi>
              <mn>0</mn>
             </msub>
             <msup>
              <mi>x</mi>
              <mo>′</mo>
             </msup>
            </mrow>
            <mo>+</mo>
            <mrow>
             <msub>
              <mi>y</mi>
              <mn>0</mn>
             </msub>
             <msup>
              <mi>y</mi>
              <mo>′</mo>
             </msup>
            </mrow>
           </mrow>
           <mo stretchy="false">)</mo>
          </mrow>
         </mrow>
         <msup>
          <mi>r</mi>
          <mrow>
           <mi mathvariant="normal">′</mi>
           <mn>2</mn>
          </mrow>
         </msup>
        </mfrac>
       </mrow>
       <mo>+</mo>
       <mfrac>
        <mrow>
         <msup>
          <mi>x</mi>
          <mrow>
           <mi mathvariant="normal">′</mi>
           <mn>2</mn>
          </mrow>
         </msup>
         <mo>+</mo>
         <msup>
          <mi>y</mi>
          <mrow>
           <mi mathvariant="normal">′</mi>
           <mn>2</mn>
          </mrow>
         </msup>
        </mrow>
        <msup>
         <mi>r</mi>
         <mrow>
          <mi mathvariant="normal">′</mi>
          <mn>2</mn>
         </mrow>
        </msup>
       </mfrac>
      </mrow>
      <mo>]</mo>
     </mrow>
     <mrow>
      <mn>1</mn>
      <mo>/</mo>
      <mn>2</mn>
     </mrow>
    </msup>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>r</ci>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>r</ci>
      <ci>normal-′</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="latexml">delimited-[]</csymbol>
       <apply>
        <plus></plus>
        <apply>
         <minus></minus>
         <cn type="integer">1</cn>
         <apply>
          <divide></divide>
          <apply>
           <times></times>
           <cn type="integer">2</cn>
           <apply>
            <plus></plus>
            <apply>
             <times></times>
             <apply>
              <csymbol cd="ambiguous">subscript</csymbol>
              <ci>x</ci>
              <cn type="integer">0</cn>
             </apply>
             <apply>
              <csymbol cd="ambiguous">superscript</csymbol>
              <ci>x</ci>
              <ci>normal-′</ci>
             </apply>
            </apply>
            <apply>
             <times></times>
             <apply>
              <csymbol cd="ambiguous">subscript</csymbol>
              <ci>y</ci>
              <cn type="integer">0</cn>
             </apply>
             <apply>
              <csymbol cd="ambiguous">superscript</csymbol>
              <ci>y</ci>
              <ci>normal-′</ci>
             </apply>
            </apply>
           </apply>
          </apply>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <ci>r</ci>
           <list>
            <ci>normal-′</ci>
            <cn type="integer">2</cn>
           </list>
          </apply>
         </apply>
        </apply>
        <apply>
         <divide></divide>
         <apply>
          <plus></plus>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <ci>x</ci>
           <list>
            <ci>normal-′</ci>
            <cn type="integer">2</cn>
           </list>
          </apply>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <ci>y</ci>
           <list>
            <ci>normal-′</ci>
            <cn type="integer">2</cn>
           </list>
          </apply>
         </apply>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>r</ci>
          <list>
           <ci>normal-′</ci>
           <cn type="integer">2</cn>
          </list>
         </apply>
        </apply>
       </apply>
      </apply>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   r=r^{\prime}\left[{1-\frac{2(x_{0}x^{\prime}+y_{0}y^{\prime})}{r^{\prime 2}}+%
\frac{x^{\prime 2}+y^{\prime 2}}{r^{\prime 2}}}\right]^{1/2}
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Kirchhoff's_diffraction_formula:19">
 <semantics>
  <mrow>
   <mi>s</mi>
   <mo>=</mo>
   <mrow>
    <msup>
     <mi>s</mi>
     <mo>′</mo>
    </msup>
    <msup>
     <mrow>
      <mo>[</mo>
      <mrow>
       <mrow>
        <mn>1</mn>
        <mo>-</mo>
        <mfrac>
         <mrow>
          <mn>2</mn>
          <mrow>
           <mo stretchy="false">(</mo>
           <mrow>
            <mrow>
             <mi>x</mi>
             <msup>
              <mi>x</mi>
              <mo>′</mo>
             </msup>
            </mrow>
            <mo>+</mo>
            <mrow>
             <mi>y</mi>
             <msup>
              <mi>y</mi>
              <mo>′</mo>
             </msup>
            </mrow>
           </mrow>
           <mo stretchy="false">)</mo>
          </mrow>
         </mrow>
         <msup>
          <mi>s</mi>
          <mrow>
           <mi mathvariant="normal">′</mi>
           <mn>2</mn>
          </mrow>
         </msup>
        </mfrac>
       </mrow>
       <mo>+</mo>
       <mfrac>
        <mrow>
         <msup>
          <mi>x</mi>
          <mrow>
           <mi mathvariant="normal">′</mi>
           <mn>2</mn>
          </mrow>
         </msup>
         <mo>+</mo>
         <msup>
          <mi>y</mi>
          <mrow>
           <mi mathvariant="normal">′</mi>
           <mn>2</mn>
          </mrow>
         </msup>
        </mrow>
        <msup>
         <mi>s</mi>
         <mrow>
          <mi mathvariant="normal">′</mi>
          <mn>2</mn>
         </mrow>
        </msup>
       </mfrac>
      </mrow>
      <mo>]</mo>
     </mrow>
     <mrow>
      <mn>1</mn>
      <mo>/</mo>
      <mn>2</mn>
     </mrow>
    </msup>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>s</ci>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>s</ci>
      <ci>normal-′</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="latexml">delimited-[]</csymbol>
       <apply>
        <plus></plus>
        <apply>
         <minus></minus>
         <cn type="integer">1</cn>
         <apply>
          <divide></divide>
          <apply>
           <times></times>
           <cn type="integer">2</cn>
           <apply>
            <plus></plus>
            <apply>
             <times></times>
             <ci>x</ci>
             <apply>
              <csymbol cd="ambiguous">superscript</csymbol>
              <ci>x</ci>
              <ci>normal-′</ci>
             </apply>
            </apply>
            <apply>
             <times></times>
             <ci>y</ci>
             <apply>
              <csymbol cd="ambiguous">superscript</csymbol>
              <ci>y</ci>
              <ci>normal-′</ci>
             </apply>
            </apply>
           </apply>
          </apply>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <ci>s</ci>
           <list>
            <ci>normal-′</ci>
            <cn type="integer">2</cn>
           </list>
          </apply>
         </apply>
        </apply>
        <apply>
         <divide></divide>
         <apply>
          <plus></plus>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <ci>x</ci>
           <list>
            <ci>normal-′</ci>
            <cn type="integer">2</cn>
           </list>
          </apply>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <ci>y</ci>
           <list>
            <ci>normal-′</ci>
            <cn type="integer">2</cn>
           </list>
          </apply>
         </apply>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>s</ci>
          <list>
           <ci>normal-′</ci>
           <cn type="integer">2</cn>
          </list>
         </apply>
        </apply>
       </apply>
      </apply>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   s=s^{\prime}\left[{1-\frac{2(xx^{\prime}+yy^{\prime})}{s^{\prime 2}}+\frac{x^{%
\prime 2}+y^{\prime 2}}{s^{\prime 2}}}\right]^{1/2}
  </annotation>
 </semantics>
</math>

</p>

<p>These can be expanded as power series:</p>

<p>

<math display="block" id="Kirchhoff's_diffraction_formula:20">
 <semantics>
  <mrow>
   <mi>r</mi>
   <mo>=</mo>
   <mrow>
    <msup>
     <mi>r</mi>
     <mo>′</mo>
    </msup>
    <mrow>
     <mo>[</mo>
     <mrow>
      <mrow>
       <mn>1</mn>
       <mo>-</mo>
       <mrow>
        <mfrac>
         <mn>1</mn>
         <mrow>
          <mn>2</mn>
          <msup>
           <mi>r</mi>
           <mrow>
            <mi mathvariant="normal">′</mi>
            <mn>2</mn>
           </mrow>
          </msup>
         </mrow>
        </mfrac>
        <mrow>
         <mo stretchy="false">[</mo>
         <mrow>
          <mrow>
           <mn>2</mn>
           <mrow>
            <mo stretchy="false">(</mo>
            <mrow>
             <mrow>
              <msub>
               <mi>x</mi>
               <mn>0</mn>
              </msub>
              <msup>
               <mi>x</mi>
               <mo>′</mo>
              </msup>
             </mrow>
             <mo>+</mo>
             <mrow>
              <msub>
               <mi>y</mi>
               <mn>0</mn>
              </msub>
              <msup>
               <mi>y</mi>
               <mo>′</mo>
              </msup>
             </mrow>
            </mrow>
            <mo stretchy="false">)</mo>
           </mrow>
          </mrow>
          <mo>+</mo>
          <mrow>
           <mo stretchy="false">(</mo>
           <mrow>
            <msup>
             <mi>x</mi>
             <mrow>
              <mi mathvariant="normal">′</mi>
              <mn>2</mn>
             </mrow>
            </msup>
            <mo>+</mo>
            <msup>
             <mi>y</mi>
             <mrow>
              <mi mathvariant="normal">′</mi>
              <mn>2</mn>
             </mrow>
            </msup>
           </mrow>
           <mo stretchy="false">)</mo>
          </mrow>
         </mrow>
         <mo stretchy="false">]</mo>
        </mrow>
       </mrow>
      </mrow>
      <mo>+</mo>
      <mrow>
       <mfrac>
        <mn>1</mn>
        <mrow>
         <mn>2</mn>
         <msup>
          <mi>r</mi>
          <mrow>
           <mi mathvariant="normal">′</mi>
           <mn>2</mn>
          </mrow>
         </msup>
        </mrow>
       </mfrac>
       <msup>
        <mrow>
         <mo stretchy="false">[</mo>
         <mrow>
          <mrow>
           <mn>2</mn>
           <mrow>
            <mo stretchy="false">(</mo>
            <mrow>
             <mrow>
              <msub>
               <mi>x</mi>
               <mn>0</mn>
              </msub>
              <msup>
               <mi>x</mi>
               <mo>′</mo>
              </msup>
             </mrow>
             <mo>+</mo>
             <mrow>
              <msub>
               <mi>y</mi>
               <mn>0</mn>
              </msub>
              <msup>
               <mi>y</mi>
               <mo>′</mo>
              </msup>
             </mrow>
            </mrow>
            <mo stretchy="false">)</mo>
           </mrow>
          </mrow>
          <mo>+</mo>
          <mrow>
           <mo stretchy="false">(</mo>
           <mrow>
            <msup>
             <mi>x</mi>
             <mrow>
              <mi mathvariant="normal">′</mi>
              <mn>2</mn>
             </mrow>
            </msup>
            <mo>+</mo>
            <msup>
             <mi>y</mi>
             <mrow>
              <mi mathvariant="normal">′</mi>
              <mn>2</mn>
             </mrow>
            </msup>
           </mrow>
           <mo stretchy="false">)</mo>
          </mrow>
         </mrow>
         <mo stretchy="false">]</mo>
        </mrow>
        <mn>2</mn>
       </msup>
      </mrow>
      <mo>+</mo>
      <mi mathvariant="normal">⋯</mi>
     </mrow>
     <mo>]</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>r</ci>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>r</ci>
      <ci>normal-′</ci>
     </apply>
     <apply>
      <csymbol cd="latexml">delimited-[]</csymbol>
      <apply>
       <plus></plus>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
        <apply>
         <times></times>
         <apply>
          <divide></divide>
          <cn type="integer">1</cn>
          <apply>
           <times></times>
           <cn type="integer">2</cn>
           <apply>
            <csymbol cd="ambiguous">superscript</csymbol>
            <ci>r</ci>
            <list>
             <ci>normal-′</ci>
             <cn type="integer">2</cn>
            </list>
           </apply>
          </apply>
         </apply>
         <apply>
          <csymbol cd="latexml">delimited-[]</csymbol>
          <apply>
           <plus></plus>
           <apply>
            <times></times>
            <cn type="integer">2</cn>
            <apply>
             <plus></plus>
             <apply>
              <times></times>
              <apply>
               <csymbol cd="ambiguous">subscript</csymbol>
               <ci>x</ci>
               <cn type="integer">0</cn>
              </apply>
              <apply>
               <csymbol cd="ambiguous">superscript</csymbol>
               <ci>x</ci>
               <ci>normal-′</ci>
              </apply>
             </apply>
             <apply>
              <times></times>
              <apply>
               <csymbol cd="ambiguous">subscript</csymbol>
               <ci>y</ci>
               <cn type="integer">0</cn>
              </apply>
              <apply>
               <csymbol cd="ambiguous">superscript</csymbol>
               <ci>y</ci>
               <ci>normal-′</ci>
              </apply>
             </apply>
            </apply>
           </apply>
           <apply>
            <plus></plus>
            <apply>
             <csymbol cd="ambiguous">superscript</csymbol>
             <ci>x</ci>
             <list>
              <ci>normal-′</ci>
              <cn type="integer">2</cn>
             </list>
            </apply>
            <apply>
             <csymbol cd="ambiguous">superscript</csymbol>
             <ci>y</ci>
             <list>
              <ci>normal-′</ci>
              <cn type="integer">2</cn>
             </list>
            </apply>
           </apply>
          </apply>
         </apply>
        </apply>
       </apply>
       <apply>
        <times></times>
        <apply>
         <divide></divide>
         <cn type="integer">1</cn>
         <apply>
          <times></times>
          <cn type="integer">2</cn>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <ci>r</ci>
           <list>
            <ci>normal-′</ci>
            <cn type="integer">2</cn>
           </list>
          </apply>
         </apply>
        </apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <csymbol cd="latexml">delimited-[]</csymbol>
          <apply>
           <plus></plus>
           <apply>
            <times></times>
            <cn type="integer">2</cn>
            <apply>
             <plus></plus>
             <apply>
              <times></times>
              <apply>
               <csymbol cd="ambiguous">subscript</csymbol>
               <ci>x</ci>
               <cn type="integer">0</cn>
              </apply>
              <apply>
               <csymbol cd="ambiguous">superscript</csymbol>
               <ci>x</ci>
               <ci>normal-′</ci>
              </apply>
             </apply>
             <apply>
              <times></times>
              <apply>
               <csymbol cd="ambiguous">subscript</csymbol>
               <ci>y</ci>
               <cn type="integer">0</cn>
              </apply>
              <apply>
               <csymbol cd="ambiguous">superscript</csymbol>
               <ci>y</ci>
               <ci>normal-′</ci>
              </apply>
             </apply>
            </apply>
           </apply>
           <apply>
            <plus></plus>
            <apply>
             <csymbol cd="ambiguous">superscript</csymbol>
             <ci>x</ci>
             <list>
              <ci>normal-′</ci>
              <cn type="integer">2</cn>
             </list>
            </apply>
            <apply>
             <csymbol cd="ambiguous">superscript</csymbol>
             <ci>y</ci>
             <list>
              <ci>normal-′</ci>
              <cn type="integer">2</cn>
             </list>
            </apply>
           </apply>
          </apply>
         </apply>
         <cn type="integer">2</cn>
        </apply>
       </apply>
       <ci>normal-⋯</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   r=r^{\prime}\left[{1-\frac{1}{2r^{\prime 2}}[2(x_{0}x^{\prime}+y_{0}y^{\prime}%
)+(x^{\prime 2}+y^{\prime 2})]+\frac{1}{2r^{\prime 2}}[2(x_{0}x^{\prime}+y_{0}%
y^{\prime})+(x^{\prime 2}+y^{\prime 2})]^{2}+\cdots}\right]
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Kirchhoff's_diffraction_formula:21">
 <semantics>
  <mrow>
   <mi>s</mi>
   <mo>=</mo>
   <mrow>
    <msup>
     <mi>s</mi>
     <mo>′</mo>
    </msup>
    <mrow>
     <mo>[</mo>
     <mrow>
      <mrow>
       <mn>1</mn>
       <mo>-</mo>
       <mrow>
        <mfrac>
         <mn>1</mn>
         <mrow>
          <mn>2</mn>
          <msup>
           <mi>s</mi>
           <mrow>
            <mi mathvariant="normal">′</mi>
            <mn>2</mn>
           </mrow>
          </msup>
         </mrow>
        </mfrac>
        <mrow>
         <mo stretchy="false">[</mo>
         <mrow>
          <mrow>
           <mn>2</mn>
           <mrow>
            <mo stretchy="false">(</mo>
            <mrow>
             <mrow>
              <mi>x</mi>
              <msup>
               <mi>x</mi>
               <mo>′</mo>
              </msup>
             </mrow>
             <mo>+</mo>
             <mrow>
              <mi>y</mi>
              <msup>
               <mi>y</mi>
               <mo>′</mo>
              </msup>
             </mrow>
            </mrow>
            <mo stretchy="false">)</mo>
           </mrow>
          </mrow>
          <mo>+</mo>
          <mrow>
           <mo stretchy="false">(</mo>
           <mrow>
            <msup>
             <mi>x</mi>
             <mrow>
              <mi mathvariant="normal">′</mi>
              <mn>2</mn>
             </mrow>
            </msup>
            <mo>+</mo>
            <msup>
             <mi>y</mi>
             <mrow>
              <mi mathvariant="normal">′</mi>
              <mn>2</mn>
             </mrow>
            </msup>
           </mrow>
           <mo stretchy="false">)</mo>
          </mrow>
         </mrow>
         <mo stretchy="false">]</mo>
        </mrow>
       </mrow>
      </mrow>
      <mo>+</mo>
      <mrow>
       <mfrac>
        <mn>1</mn>
        <mrow>
         <mn>2</mn>
         <msup>
          <mi>s</mi>
          <mrow>
           <mi mathvariant="normal">′</mi>
           <mn>2</mn>
          </mrow>
         </msup>
        </mrow>
       </mfrac>
       <msup>
        <mrow>
         <mo stretchy="false">[</mo>
         <mrow>
          <mrow>
           <mn>2</mn>
           <mrow>
            <mo stretchy="false">(</mo>
            <mrow>
             <mrow>
              <mi>x</mi>
              <msup>
               <mi>x</mi>
               <mo>′</mo>
              </msup>
             </mrow>
             <mo>+</mo>
             <mrow>
              <mi>y</mi>
              <msup>
               <mi>y</mi>
               <mo>′</mo>
              </msup>
             </mrow>
            </mrow>
            <mo stretchy="false">)</mo>
           </mrow>
          </mrow>
          <mo>+</mo>
          <mrow>
           <mo stretchy="false">(</mo>
           <mrow>
            <msup>
             <mi>x</mi>
             <mrow>
              <mi mathvariant="normal">′</mi>
              <mn>2</mn>
             </mrow>
            </msup>
            <mo>+</mo>
            <msup>
             <mi>y</mi>
             <mrow>
              <mi mathvariant="normal">′</mi>
              <mn>2</mn>
             </mrow>
            </msup>
           </mrow>
           <mo stretchy="false">)</mo>
          </mrow>
         </mrow>
         <mo stretchy="false">]</mo>
        </mrow>
        <mn>2</mn>
       </msup>
      </mrow>
      <mo>+</mo>
      <mi mathvariant="normal">⋯</mi>
     </mrow>
     <mo>]</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>s</ci>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>s</ci>
      <ci>normal-′</ci>
     </apply>
     <apply>
      <csymbol cd="latexml">delimited-[]</csymbol>
      <apply>
       <plus></plus>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
        <apply>
         <times></times>
         <apply>
          <divide></divide>
          <cn type="integer">1</cn>
          <apply>
           <times></times>
           <cn type="integer">2</cn>
           <apply>
            <csymbol cd="ambiguous">superscript</csymbol>
            <ci>s</ci>
            <list>
             <ci>normal-′</ci>
             <cn type="integer">2</cn>
            </list>
           </apply>
          </apply>
         </apply>
         <apply>
          <csymbol cd="latexml">delimited-[]</csymbol>
          <apply>
           <plus></plus>
           <apply>
            <times></times>
            <cn type="integer">2</cn>
            <apply>
             <plus></plus>
             <apply>
              <times></times>
              <ci>x</ci>
              <apply>
               <csymbol cd="ambiguous">superscript</csymbol>
               <ci>x</ci>
               <ci>normal-′</ci>
              </apply>
             </apply>
             <apply>
              <times></times>
              <ci>y</ci>
              <apply>
               <csymbol cd="ambiguous">superscript</csymbol>
               <ci>y</ci>
               <ci>normal-′</ci>
              </apply>
             </apply>
            </apply>
           </apply>
           <apply>
            <plus></plus>
            <apply>
             <csymbol cd="ambiguous">superscript</csymbol>
             <ci>x</ci>
             <list>
              <ci>normal-′</ci>
              <cn type="integer">2</cn>
             </list>
            </apply>
            <apply>
             <csymbol cd="ambiguous">superscript</csymbol>
             <ci>y</ci>
             <list>
              <ci>normal-′</ci>
              <cn type="integer">2</cn>
             </list>
            </apply>
           </apply>
          </apply>
         </apply>
        </apply>
       </apply>
       <apply>
        <times></times>
        <apply>
         <divide></divide>
         <cn type="integer">1</cn>
         <apply>
          <times></times>
          <cn type="integer">2</cn>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <ci>s</ci>
           <list>
            <ci>normal-′</ci>
            <cn type="integer">2</cn>
           </list>
          </apply>
         </apply>
        </apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <csymbol cd="latexml">delimited-[]</csymbol>
          <apply>
           <plus></plus>
           <apply>
            <times></times>
            <cn type="integer">2</cn>
            <apply>
             <plus></plus>
             <apply>
              <times></times>
              <ci>x</ci>
              <apply>
               <csymbol cd="ambiguous">superscript</csymbol>
               <ci>x</ci>
               <ci>normal-′</ci>
              </apply>
             </apply>
             <apply>
              <times></times>
              <ci>y</ci>
              <apply>
               <csymbol cd="ambiguous">superscript</csymbol>
               <ci>y</ci>
               <ci>normal-′</ci>
              </apply>
             </apply>
            </apply>
           </apply>
           <apply>
            <plus></plus>
            <apply>
             <csymbol cd="ambiguous">superscript</csymbol>
             <ci>x</ci>
             <list>
              <ci>normal-′</ci>
              <cn type="integer">2</cn>
             </list>
            </apply>
            <apply>
             <csymbol cd="ambiguous">superscript</csymbol>
             <ci>y</ci>
             <list>
              <ci>normal-′</ci>
              <cn type="integer">2</cn>
             </list>
            </apply>
           </apply>
          </apply>
         </apply>
         <cn type="integer">2</cn>
        </apply>
       </apply>
       <ci>normal-⋯</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   s=s^{\prime}\left[{1-\frac{1}{2s^{\prime 2}}[2(xx^{\prime}+yy^{\prime})+(x^{%
\prime 2}+y^{\prime 2})]+\frac{1}{2s^{\prime 2}}[2(xx^{\prime}+yy^{\prime})+(x%
^{\prime 2}+y^{\prime 2})]^{2}+\cdots}\right]
  </annotation>
 </semantics>
</math>

</p>

<p>The complex amplitude at <strong>P</strong> can now be expressed as:</p>

<p>

<math display="block" id="Kirchhoff's_diffraction_formula:22">
 <semantics>
  <mrow>
   <mrow>
    <mi>U</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>P</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mo>-</mo>
    <mrow>
     <mfrac>
      <mrow>
       <mi>i</mi>
       <mrow>
        <mi>cos</mi>
        <mi>β</mi>
       </mrow>
      </mrow>
      <mi>λ</mi>
     </mfrac>
     <mfrac>
      <mrow>
       <mi>a</mi>
       <msup>
        <mi>e</mi>
        <mrow>
         <mi>i</mi>
         <mi>k</mi>
         <mrow>
          <mo stretchy="false">(</mo>
          <mrow>
           <msup>
            <mi>r</mi>
            <mo>′</mo>
           </msup>
           <mo>+</mo>
           <msup>
            <mi>s</mi>
            <mo>′</mo>
           </msup>
          </mrow>
          <mo stretchy="false">)</mo>
         </mrow>
        </mrow>
       </msup>
      </mrow>
      <mrow>
       <msup>
        <mi>r</mi>
        <mo>′</mo>
       </msup>
       <msup>
        <mi>s</mi>
        <mo>′</mo>
       </msup>
      </mrow>
     </mfrac>
     <mrow>
      <msub>
       <mo largeop="true" symmetric="true">∫</mo>
       <mi>S</mi>
      </msub>
      <mrow>
       <msup>
        <mi>e</mi>
        <mrow>
         <mi>i</mi>
         <mi>k</mi>
         <mi>f</mi>
         <mrow>
          <mo stretchy="false">(</mo>
          <msup>
           <mi>x</mi>
           <mo>′</mo>
          </msup>
          <mo>,</mo>
          <msup>
           <mi>y</mi>
           <mo>′</mo>
          </msup>
          <mo stretchy="false">)</mo>
         </mrow>
        </mrow>
       </msup>
       <mi>d</mi>
       <msup>
        <mi>x</mi>
        <mo>′</mo>
       </msup>
       <mi>d</mi>
       <msup>
        <mi>y</mi>
        <mo>′</mo>
       </msup>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>U</ci>
     <ci>P</ci>
    </apply>
    <apply>
     <minus></minus>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <apply>
        <times></times>
        <ci>i</ci>
        <apply>
         <cos></cos>
         <ci>β</ci>
        </apply>
       </apply>
       <ci>λ</ci>
      </apply>
      <apply>
       <divide></divide>
       <apply>
        <times></times>
        <ci>a</ci>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>e</ci>
         <apply>
          <times></times>
          <ci>i</ci>
          <ci>k</ci>
          <apply>
           <plus></plus>
           <apply>
            <csymbol cd="ambiguous">superscript</csymbol>
            <ci>r</ci>
            <ci>normal-′</ci>
           </apply>
           <apply>
            <csymbol cd="ambiguous">superscript</csymbol>
            <ci>s</ci>
            <ci>normal-′</ci>
           </apply>
          </apply>
         </apply>
        </apply>
       </apply>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>r</ci>
         <ci>normal-′</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>s</ci>
         <ci>normal-′</ci>
        </apply>
       </apply>
      </apply>
      <apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <int></int>
        <ci>S</ci>
       </apply>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>e</ci>
         <apply>
          <times></times>
          <ci>i</ci>
          <ci>k</ci>
          <ci>f</ci>
          <interval closure="open">
           <apply>
            <csymbol cd="ambiguous">superscript</csymbol>
            <ci>x</ci>
            <ci>normal-′</ci>
           </apply>
           <apply>
            <csymbol cd="ambiguous">superscript</csymbol>
            <ci>y</ci>
            <ci>normal-′</ci>
           </apply>
          </interval>
         </apply>
        </apply>
        <ci>d</ci>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>x</ci>
         <ci>normal-′</ci>
        </apply>
        <ci>d</ci>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>y</ci>
         <ci>normal-′</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   U(P)=-\frac{i\cos\beta}{\lambda}\frac{ae^{ik(r^{\prime}+s^{\prime})}}{r^{%
\prime}s^{\prime}}\int_{S}e^{ikf(x^{\prime},y^{\prime})}dx^{\prime}dy^{\prime}
  </annotation>
 </semantics>
</math>

</p>

<p>where <em>f(x',y')</em> includes all the terms in the expressions above for <em>s</em> and <em>r</em> apart from the first term in each expression and can be written in the form:</p>

<p>

<math display="block" id="Kirchhoff's_diffraction_formula:23">
 <semantics>
  <mrow>
   <mrow>
    <mpadded lspace="3.3pt" width="+3.3pt">
     <mi>f</mi>
    </mpadded>
    <mrow>
     <mo stretchy="false">(</mo>
     <msup>
      <mi>x</mi>
      <mo>′</mo>
     </msup>
     <mo>,</mo>
     <msup>
      <mi>y</mi>
      <mo>′</mo>
     </msup>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <msub>
      <mi>c</mi>
      <mn>1</mn>
     </msub>
     <msup>
      <mi>x</mi>
      <mo>′</mo>
     </msup>
    </mrow>
    <mo>+</mo>
    <mrow>
     <msub>
      <mi>c</mi>
      <mn>2</mn>
     </msub>
     <msup>
      <mi>y</mi>
      <mo>′</mo>
     </msup>
    </mrow>
    <mo>+</mo>
    <mrow>
     <msub>
      <mi>c</mi>
      <mn>3</mn>
     </msub>
     <msup>
      <mi>x</mi>
      <mrow>
       <mi mathvariant="normal">′</mi>
       <mn>2</mn>
      </mrow>
     </msup>
    </mrow>
    <mo>+</mo>
    <mrow>
     <msub>
      <mi>c</mi>
      <mn>4</mn>
     </msub>
     <msup>
      <mi>y</mi>
      <mrow>
       <mi mathvariant="normal">′</mi>
       <mn>2</mn>
      </mrow>
     </msup>
    </mrow>
    <mo>+</mo>
    <mrow>
     <msub>
      <mi>c</mi>
      <mn>5</mn>
     </msub>
     <msup>
      <mi>x</mi>
      <mo>′</mo>
     </msup>
     <msup>
      <mi>y</mi>
      <mo>′</mo>
     </msup>
     <mi mathvariant="normal">⋯</mi>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>f</ci>
     <interval closure="open">
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>x</ci>
       <ci>normal-′</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>y</ci>
       <ci>normal-′</ci>
      </apply>
     </interval>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>c</ci>
       <cn type="integer">1</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>x</ci>
       <ci>normal-′</ci>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>c</ci>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>y</ci>
       <ci>normal-′</ci>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>c</ci>
       <cn type="integer">3</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>x</ci>
       <list>
        <ci>normal-′</ci>
        <cn type="integer">2</cn>
       </list>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>c</ci>
       <cn type="integer">4</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>y</ci>
       <list>
        <ci>normal-′</ci>
        <cn type="integer">2</cn>
       </list>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>c</ci>
       <cn type="integer">5</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>x</ci>
       <ci>normal-′</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>y</ci>
       <ci>normal-′</ci>
      </apply>
      <ci>normal-⋯</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   ~{}f(x^{\prime},y^{\prime})=c_{1}x^{\prime}+c_{2}y^{\prime}+c_{3}x^{\prime 2}+%
c_{4}y^{\prime 2}+c_{5}x^{\prime}y^{\prime}\cdots
  </annotation>
 </semantics>
</math>

</p>

<p>where the <em>c</em> are constants.</p>
<h3 id="fraunhofer-diffraction">Fraunhofer diffraction</h3>

<p>If all the terms in <em>f</em>(<em>x', y</em>') can be neglected except for the terms in <em>x</em>' and <em>y</em>', we have the <a href="Fraunhofer_diffraction" title="wikilink">Fraunhofer diffraction</a> equation. If the direction cosines of <strong>P<sub>0</sub>Q</strong> and <strong>PQ</strong> are</p>

<p>

<math display="block" id="Kirchhoff's_diffraction_formula:24">
 <semantics>
  <mtable displaystyle="true">
   <mtr>
    <mtd columnalign="right">
     <msub>
      <mi>l</mi>
      <mn>0</mn>
     </msub>
    </mtd>
    <mtd columnalign="center">
     <mo>=</mo>
    </mtd>
    <mtd columnalign="left">
     <mrow>
      <mo>-</mo>
      <mrow>
       <msub>
        <mi>x</mi>
        <mn>0</mn>
       </msub>
       <mo>/</mo>
       <msup>
        <mi>r</mi>
        <mo>′</mo>
       </msup>
      </mrow>
     </mrow>
    </mtd>
   </mtr>
   <mtr>
    <mtd columnalign="right">
     <msub>
      <mi>m</mi>
      <mn>0</mn>
     </msub>
    </mtd>
    <mtd columnalign="center">
     <mo>=</mo>
    </mtd>
    <mtd columnalign="left">
     <mrow>
      <mo>-</mo>
      <mrow>
       <msub>
        <mi>y</mi>
        <mn>0</mn>
       </msub>
       <mo>/</mo>
       <msup>
        <mi>r</mi>
        <mo>′</mo>
       </msup>
      </mrow>
     </mrow>
    </mtd>
   </mtr>
   <mtr>
    <mtd columnalign="right">
     <mi>l</mi>
    </mtd>
    <mtd columnalign="center">
     <mo>=</mo>
    </mtd>
    <mtd columnalign="left">
     <mrow>
      <mi>x</mi>
      <mo>/</mo>
      <msup>
       <mi>s</mi>
       <mo>′</mo>
      </msup>
     </mrow>
    </mtd>
   </mtr>
   <mtr>
    <mtd columnalign="right">
     <mi>m</mi>
    </mtd>
    <mtd columnalign="center">
     <mo>=</mo>
    </mtd>
    <mtd columnalign="left">
     <mrow>
      <mi>y</mi>
      <mo>/</mo>
      <msup>
       <mi>s</mi>
       <mo>′</mo>
      </msup>
     </mrow>
    </mtd>
   </mtr>
  </mtable>
  <annotation-xml encoding="MathML-Content">
   <matrix>
    <matrixrow>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>l</ci>
      <cn type="integer">0</cn>
     </apply>
     <eq></eq>
     <apply>
      <minus></minus>
      <apply>
       <divide></divide>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <cn type="integer">0</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>r</ci>
        <ci>normal-′</ci>
       </apply>
      </apply>
     </apply>
    </matrixrow>
    <matrixrow>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>m</ci>
      <cn type="integer">0</cn>
     </apply>
     <eq></eq>
     <apply>
      <minus></minus>
      <apply>
       <divide></divide>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>y</ci>
        <cn type="integer">0</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>r</ci>
        <ci>normal-′</ci>
       </apply>
      </apply>
     </apply>
    </matrixrow>
    <matrixrow>
     <ci>l</ci>
     <eq></eq>
     <apply>
      <divide></divide>
      <ci>x</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>s</ci>
       <ci>normal-′</ci>
      </apply>
     </apply>
    </matrixrow>
    <matrixrow>
     <ci>m</ci>
     <eq></eq>
     <apply>
      <divide></divide>
      <ci>y</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>s</ci>
       <ci>normal-′</ci>
      </apply>
     </apply>
    </matrixrow>
   </matrix>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \begin{array}[]{rcl}l_{0}&=&-{x_{0}}/{r^{\prime}}\\
m_{0}&=&-{y_{0}}/{r^{\prime}}\\
l&=&{x}/{s^{\prime}}\\
m&=&{y}/{s^{\prime}}\end{array}
  </annotation>
 </semantics>
</math>

</p>

<p>the Fraunhofer diffraction equation is then</p>

<p>

<math display="block" id="Kirchhoff's_diffraction_formula:25">
 <semantics>
  <mrow>
   <mrow>
    <mi>U</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>P</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mi>C</mi>
    <mrow>
     <msub>
      <mo largeop="true" symmetric="true">∫</mo>
      <mi>S</mi>
     </msub>
     <mrow>
      <msup>
       <mi>e</mi>
       <mrow>
        <mi>i</mi>
        <mi>k</mi>
        <mrow>
         <mo stretchy="false">[</mo>
         <mrow>
          <mrow>
           <mrow>
            <mo stretchy="false">(</mo>
            <mrow>
             <msub>
              <mi>l</mi>
              <mn>0</mn>
             </msub>
             <mo>-</mo>
             <mi>l</mi>
            </mrow>
            <mo stretchy="false">)</mo>
           </mrow>
           <msup>
            <mi>x</mi>
            <mo>′</mo>
           </msup>
          </mrow>
          <mo>+</mo>
          <mrow>
           <mrow>
            <mo stretchy="false">(</mo>
            <mrow>
             <mi>m</mi>
             <mo>-</mo>
             <msub>
              <mi>m</mi>
              <mn>0</mn>
             </msub>
            </mrow>
            <mo stretchy="false">)</mo>
           </mrow>
           <msup>
            <mi>y</mi>
            <mo>′</mo>
           </msup>
          </mrow>
         </mrow>
         <mo stretchy="false">]</mo>
        </mrow>
       </mrow>
      </msup>
      <mi>d</mi>
      <msup>
       <mi>x</mi>
       <mo>′</mo>
      </msup>
      <mi>d</mi>
      <msup>
       <mi>y</mi>
       <mo>′</mo>
      </msup>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>U</ci>
     <ci>P</ci>
    </apply>
    <apply>
     <times></times>
     <ci>C</ci>
     <apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <int></int>
       <ci>S</ci>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>e</ci>
        <apply>
         <times></times>
         <ci>i</ci>
         <ci>k</ci>
         <apply>
          <csymbol cd="latexml">delimited-[]</csymbol>
          <apply>
           <plus></plus>
           <apply>
            <times></times>
            <apply>
             <minus></minus>
             <apply>
              <csymbol cd="ambiguous">subscript</csymbol>
              <ci>l</ci>
              <cn type="integer">0</cn>
             </apply>
             <ci>l</ci>
            </apply>
            <apply>
             <csymbol cd="ambiguous">superscript</csymbol>
             <ci>x</ci>
             <ci>normal-′</ci>
            </apply>
           </apply>
           <apply>
            <times></times>
            <apply>
             <minus></minus>
             <ci>m</ci>
             <apply>
              <csymbol cd="ambiguous">subscript</csymbol>
              <ci>m</ci>
              <cn type="integer">0</cn>
             </apply>
            </apply>
            <apply>
             <csymbol cd="ambiguous">superscript</csymbol>
             <ci>y</ci>
             <ci>normal-′</ci>
            </apply>
           </apply>
          </apply>
         </apply>
        </apply>
       </apply>
       <ci>d</ci>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>x</ci>
        <ci>normal-′</ci>
       </apply>
       <ci>d</ci>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>y</ci>
        <ci>normal-′</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   U(P)=C\int_{S}e^{ik[(l_{0}-l)x^{\prime}+(m-m_{0})y^{\prime}]}dx^{\prime}dy^{\prime}
  </annotation>
 </semantics>
</math>

</p>

<p>where <em>C</em> is a constant. This can also be written in the form:</p>

<p>

<math display="block" id="Kirchhoff's_diffraction_formula:26">
 <semantics>
  <mrow>
   <mrow>
    <mi>U</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>P</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mi>C</mi>
    <mrow>
     <msub>
      <mo largeop="true" symmetric="true">∫</mo>
      <mi>S</mi>
     </msub>
     <mrow>
      <msup>
       <mi>e</mi>
       <mrow>
        <mrow>
         <mi>i</mi>
         <mrow>
          <mo stretchy="false">(</mo>
          <mrow>
           <msub>
            <mi>𝐤</mi>
            <mn>𝟎</mn>
           </msub>
           <mo>-</mo>
           <mi>𝐤</mi>
          </mrow>
          <mo stretchy="false">)</mo>
         </mrow>
        </mrow>
        <mo>⋅</mo>
        <msup>
         <mi>𝐫</mi>
         <mo>′</mo>
        </msup>
       </mrow>
      </msup>
      <mi>d</mi>
      <msup>
       <mi>r</mi>
       <mo>′</mo>
      </msup>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>U</ci>
     <ci>P</ci>
    </apply>
    <apply>
     <times></times>
     <ci>C</ci>
     <apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <int></int>
       <ci>S</ci>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>e</ci>
        <apply>
         <ci>normal-⋅</ci>
         <apply>
          <times></times>
          <ci>i</ci>
          <apply>
           <minus></minus>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <ci>𝐤</ci>
            <cn type="integer">0</cn>
           </apply>
           <ci>𝐤</ci>
          </apply>
         </apply>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>𝐫</ci>
          <ci>normal-′</ci>
         </apply>
        </apply>
       </apply>
       <ci>d</ci>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>r</ci>
        <ci>normal-′</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   U(P)=C\int_{S}e^{i(\mathbf{k_{0}}-\mathbf{k})\cdot\mathbf{r^{\prime}}}dr^{\prime}
  </annotation>
 </semantics>
</math>

</p>

<p>where <strong>k<sub>0</sub></strong> and <strong>k</strong> are the <a href="wave_vector" title="wikilink">wave vectors</a> of the waves travelling from <strong>P<sub>0</sub></strong> to the aperture and from the aperture to <strong>P</strong> respectively, and '''r' ''' is a point in the aperture.</p>

<p>If the point source is replaced by an extended source whose complex amplitude at the aperture is given by <em>U<sub>0</sub></em>('''r' ''') then the <a href="Fraunhofer_diffraction" title="wikilink">Fraunhofer diffraction</a> equation is:</p>

<p>

<math display="block" id="Kirchhoff's_diffraction_formula:27">
 <semantics>
  <mrow>
   <mrow>
    <mi>U</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>P</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>∝</mo>
   <mrow>
    <msub>
     <mo largeop="true" symmetric="true">∫</mo>
     <mi>S</mi>
    </msub>
    <mrow>
     <msub>
      <mi>a</mi>
      <mn>0</mn>
     </msub>
     <mrow>
      <mo stretchy="false">(</mo>
      <msup>
       <mi>𝐫</mi>
       <mo>′</mo>
      </msup>
      <mo stretchy="false">)</mo>
     </mrow>
     <msup>
      <mi>e</mi>
      <mrow>
       <mrow>
        <mi>i</mi>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <msub>
           <mi>𝐤</mi>
           <mn>𝟎</mn>
          </msub>
          <mo>-</mo>
          <mi>𝐤</mi>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
       <mo>⋅</mo>
       <msup>
        <mi>𝐫</mi>
        <mo>′</mo>
       </msup>
      </mrow>
     </msup>
     <mi>d</mi>
     <msup>
      <mi>r</mi>
      <mo>′</mo>
     </msup>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">proportional-to</csymbol>
    <apply>
     <times></times>
     <ci>U</ci>
     <ci>P</ci>
    </apply>
    <apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <int></int>
      <ci>S</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>a</ci>
       <cn type="integer">0</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>𝐫</ci>
       <ci>normal-′</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>e</ci>
       <apply>
        <ci>normal-⋅</ci>
        <apply>
         <times></times>
         <ci>i</ci>
         <apply>
          <minus></minus>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>𝐤</ci>
           <cn type="integer">0</cn>
          </apply>
          <ci>𝐤</ci>
         </apply>
        </apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>𝐫</ci>
         <ci>normal-′</ci>
        </apply>
       </apply>
      </apply>
      <ci>d</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>r</ci>
       <ci>normal-′</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   U(P)\propto{\int_{S}a_{0}(\mathbf{r^{\prime}})e^{i\mathbf{(k_{0}-k)}\cdot%
\mathbf{r^{\prime}}}dr^{\prime}}
  </annotation>
 </semantics>
</math>

</p>

<p>where <em>a</em><sub>0</sub>(<strong>r</strong>') is, as before, the magnitude of the disturbance at the aperture.</p>

<p>In addition to the approximations made in deriving the Kirchhoff equation, it is assumed that</p>
<ul>
<li><em>r, s</em> are significantly greater than the size of the aperture</li>
</ul>
<ul>
<li>Second and higher order terms in the expression <em>f</em>(<em>x', y</em>') can be neglected</li>
</ul>
<h3 id="fresnel-diffraction">Fresnel diffraction</h3>

<p>When the quadratic terms cannot be neglected but all higher order terms can, the equation becomes the <a href="Fresnel_diffraction" title="wikilink">Fresnel diffraction</a> equation. The approximations for the Kirchhoff equation are used, additional assumptions are</p>
<ul>
<li><em>r, s</em> are significantly greater than the size of the aperture</li>
<li>Third and higher order terms in the expression <em>f</em>(<em>x', y</em>') can be neglected</li>
</ul>
<h2 id="references">References</h2>
<h2 id="further-reading">Further reading</h2>
<ul>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
</ul>

<p>"</p>

<p><a class="uri" href="Category:Waves" title="wikilink">Category:Waves</a> <a class="uri" href="Category:Optics" title="wikilink">Category:Optics</a> <a class="uri" href="Category:Diffraction" title="wikilink">Category:Diffraction</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1"><a href="#fnref1">↩</a></li>
<li id="fn2"><a href="#fnref2">↩</a></li>
<li id="fn3"><a href="#fnref3">↩</a></li>
<li id="fn4"></li>
<li id="fn5">M. Born, <em>Optik: ein Lehrbuch der elektromagnetischen Lichttheorie</em>. Berlin, Springer, 1933, reprinted 1965, p. 149<a href="#fnref5">↩</a></li>
<li id="fn6">MV Klein &amp; TE Furtak, 1986, <em>Optics</em>; 2nd ed. John Wiley &amp; Sons, New York ISBN 0-471-87297-0.<a href="#fnref6">↩</a></li>
</ol>
</section>
</body>
</html>

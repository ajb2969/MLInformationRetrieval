<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="394">Air mass (astronomy)</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Air mass (astronomy)</h1>
<hr/>

<p>In <a class="uri" href="astronomy" title="wikilink">astronomy</a>, <strong>air mass</strong> (or <strong>airmass</strong>) is the optical path length through <a href="Earth's_atmosphere" title="wikilink">Earth’s atmosphere</a> for <a class="uri" href="light" title="wikilink">light</a> from a <a href="celestial_source" title="wikilink">celestial source</a>. As it passes through the atmosphere, light is attenuated by <a class="uri" href="scattering" title="wikilink">scattering</a> and <a href="absorption_(electromagnetic_radiation)" title="wikilink">absorption</a>; the more atmosphere through which it passes, the greater the <a class="uri" href="attenuation" title="wikilink">attenuation</a>. Consequently, celestial bodies at the horizon appear less bright than when at the zenith. The attenuation, known as <a href="extinction_(astronomy)#Atmospheric_extinction" title="wikilink">atmospheric extinction</a>, is described quantitatively by the <a href="Beer–Lambert_law" title="wikilink">Beer–Lambert–Bouguer law</a>.</p>

<p>“Air mass” normally indicates <em>relative air mass</em>, the path length relative to that at the <a class="uri" href="zenith" title="wikilink">zenith</a> at <a href="sea_level" title="wikilink">sea level</a> so, by definition, the sea-level air mass at the zenith is 1. Air mass increases as the angle between the source and the zenith increases, reaching a value of approximately 38 at the horizon. Air mass can be less than one at an elevation greater than sea level; however, most <a href="closed-form_expression" title="wikilink">closed-form expressions</a> for air mass do not include the effects of elevation, so adjustment must usually be accomplished by other means.</p>

<p>In some fields, such as <a href="solar_energy" title="wikilink">solar energy</a> and <a class="uri" href="photovoltaics" title="wikilink">photovoltaics</a>, air mass is indicated by the acronym AM; additionally, the value of the air mass is often given by appending its value to AM, so that AM1 indicates an air mass of 1, AM2 indicates an air mass of 2, and so on. The region above Earth’s atmosphere, where there is no atmospheric attenuation of <a href="solar_radiation" title="wikilink">solar radiation</a>, is considered to have “<a href="Air_mass_coefficient#Cases" title="wikilink">air mass zero</a>” (AM0).</p>

<p>Tables of air mass have been published by numerous authors, including <a href="#CITEREFBemporad1904" title="wikilink">Bemporad (1904)</a>, <a href="#CITEREFAllen1976" title="wikilink">Allen (1976)</a>,<a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a> and <a href="#CITEREFKastenYoung1989" title="wikilink">Kasten and Young (1989)</a>.</p>
<h2 id="calculating-air-mass">Calculating air mass</h2>
<figure><b>(Figure)</b>
<figcaption>Plots of air mass using various formulas.</figcaption>
</figure>
<h3 id="zenith-angle-and-altitude">Zenith angle and altitude</h3>

<p>The angle of a celestial body with the zenith is the <em><a href="zenith_angle" title="wikilink">zenith angle</a></em> (in astronomy, commonly referred to as the <em><a href="zenith_distance" title="wikilink">zenith distance</a></em>). A body’s angular position can also be given in terms of <em><a href="altitude_(astronomy)" title="wikilink">altitude</a></em>, the angle above the geometric horizon; the altitude 

<math display="inline" id="Air_mass_(astronomy):0">
 <semantics>
  <mi>h</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>h</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   h
  </annotation>
 </semantics>
</math>

 and the zenith angle 

<math display="inline" id="Air_mass_(astronomy):1">
 <semantics>
  <mi>z</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>z</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   z
  </annotation>
 </semantics>
</math>

 are thus related by</p>

<p>

<math display="block" id="Air_mass_(astronomy):2">
 <semantics>
  <mrow>
   <mrow>
    <mi>h</mi>
    <mo>=</mo>
    <mrow>
     <msup>
      <mn>90</mn>
      <mo>∘</mo>
     </msup>
     <mo>-</mo>
     <mpadded width="+1.7pt">
      <mi>z</mi>
     </mpadded>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>h</ci>
    <apply>
     <minus></minus>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <cn type="integer">90</cn>
      <compose></compose>
     </apply>
     <ci>z</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   h=90^{\circ}-z\,.
  </annotation>
 </semantics>
</math>

</p>
<h3 id="atmospheric-refraction">Atmospheric Refraction</h3>

<p><a href="Atmospheric_refraction" title="wikilink">Atmospheric refraction</a> causes light to follow an approximately circular path that is slightly longer than the geometric path, and the air mass must take into account the longer path (<a href="#CITEREFYoung1994" title="wikilink">Young 1994</a>). Additionally, refraction causes a celestial body to appear higher above the horizon than it actually is; at the horizon, the difference between the true zenith angle and the apparent zenith angle is approximately 34 minutes of arc. Most air mass formulas are based on the apparent zenith angle, but some are based on the true zenith angle, so it is important to ensure that the correct value is used, especially near the horizon.<a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a></p>
<h3 id="plane-parallel-atmosphere">Plane-parallel atmosphere</h3>

<p>When the zenith angle is small to moderate, a good approximation is given by assuming a homogeneous plane-parallel atmosphere (i.e., one in which density is constant and Earth’s curvature is ignored). The air mass 

<math display="inline" id="Air_mass_(astronomy):3">
 <semantics>
  <mi>X</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>X</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   X
  </annotation>
 </semantics>
</math>

 then is simply the <a href="trigonometric_functions" title="wikilink">secant</a> of the zenith angle 

<math display="inline" id="Air_mass_(astronomy):4">
 <semantics>
  <mi>z</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>z</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   z
  </annotation>
 </semantics>
</math>

:</p>

<p>

<math display="block" id="Air_mass_(astronomy):5">
 <semantics>
  <mrow>
   <mrow>
    <mi>X</mi>
    <mo>=</mo>
    <mrow>
     <mpadded width="+1.7pt">
      <mi>sec</mi>
     </mpadded>
     <mpadded width="+1.7pt">
      <mi>z</mi>
     </mpadded>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>X</ci>
    <apply>
     <sec></sec>
     <ci>z</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   X=\sec\,z\,.
  </annotation>
 </semantics>
</math>

</p>

<p>At a zenith angle of 60°, the air mass is approximately 2. The Earth is not flat, however, and, depending on accuracy requirements, this formula is usable for zenith angles up to about 60° to 75°. At greater zenith angles, the accuracy degrades rapidly, with 

<math display="inline" id="Air_mass_(astronomy):6">
 <semantics>
  <mrow>
   <mi>X</mi>
   <mo>=</mo>
   <mrow>
    <mpadded width="+1.7pt">
     <mi>sec</mi>
    </mpadded>
    <mi>z</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>X</ci>
    <apply>
     <sec></sec>
     <ci>z</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   X=\sec\,z
  </annotation>
 </semantics>
</math>

 becoming infinite at the horizon; the horizon air mass in the more-realistic spherical atmosphere is usually less than 40.</p>
<h3 id="interpolative-formulas">Interpolative formulas</h3>

<p>Many formulas have been developed to fit tabular values of air mass; one by <a href="#CITEREFYoungIrvine1967" title="wikilink">Young and Irvine (1967)</a> included a simple corrective term:</p>

<p>

<math display="block" id="Air_mass_(astronomy):7">
 <semantics>
  <mrow>
   <mrow>
    <mi>X</mi>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mpadded width="+1.7pt">
       <mi>sec</mi>
      </mpadded>
      <mpadded width="+1.7pt">
       <msub>
        <mi>z</mi>
        <mi mathvariant="normal">t</mi>
       </msub>
      </mpadded>
     </mrow>
     <mrow>
      <mo>[</mo>
      <mrow>
       <mn>1</mn>
       <mo>-</mo>
       <mrow>
        <mpadded width="+1.7pt">
         <mn>0.0012</mn>
        </mpadded>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <mrow>
           <msup>
            <mi>sec</mi>
            <mn>2</mn>
           </msup>
           <msub>
            <mi>z</mi>
            <mi mathvariant="normal">t</mi>
           </msub>
          </mrow>
          <mo>-</mo>
          <mn>1</mn>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
      </mrow>
      <mo rspace="4.2pt">]</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>X</ci>
    <apply>
     <times></times>
     <apply>
      <sec></sec>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>z</ci>
       <ci>normal-t</ci>
      </apply>
     </apply>
     <apply>
      <csymbol cd="latexml">delimited-[]</csymbol>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
       <apply>
        <times></times>
        <cn type="float">0.0012</cn>
        <apply>
         <minus></minus>
         <apply>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <sec></sec>
           <cn type="integer">2</cn>
          </apply>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>z</ci>
           <ci>normal-t</ci>
          </apply>
         </apply>
         <cn type="integer">1</cn>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   X=\sec\,z_{\mathrm{t}}\,\left[1-0.0012\,(\sec^{2}z_{\mathrm{t}}-1)\right]\,,
  </annotation>
 </semantics>
</math>

</p>

<p>where 

<math display="inline" id="Air_mass_(astronomy):8">
 <semantics>
  <msub>
   <mi>z</mi>
   <mi mathvariant="normal">t</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>z</ci>
    <ci>normal-t</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   z_{\mathrm{t}}
  </annotation>
 </semantics>
</math>

 is the true zenith angle. This gives usable results up to approximately 80°, but the accuracy degrades rapidly at greater zenith angles. The calculated air mass reaches a maximum of 11.13 at 86.6°, becomes zero at 88°, and approaches negative infinity at the horizon. The plot of this formula on the accompanying graph includes a correction for atmospheric refraction so that the calculated air mass is for apparent rather than true zenith angle.</p>

<p><a href="#CITEREFHardie1962" title="wikilink">Hardie (1962)</a> introduced a polynomial in 

<math display="inline" id="Air_mass_(astronomy):9">
 <semantics>
  <mrow>
   <mrow>
    <mpadded width="+1.7pt">
     <mi>sec</mi>
    </mpadded>
    <mi>z</mi>
   </mrow>
   <mo>-</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <minus></minus>
    <apply>
     <sec></sec>
     <ci>z</ci>
    </apply>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \sec\,z-1
  </annotation>
 </semantics>
</math>

:</p>

<p>

<math display="block" id="Air_mass_(astronomy):10">
 <semantics>
  <mrow>
   <mrow>
    <mi>X</mi>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mpadded width="+1.7pt">
       <mi>sec</mi>
      </mpadded>
      <mpadded width="+1.7pt">
       <mi>z</mi>
      </mpadded>
     </mrow>
     <mo>-</mo>
     <mrow>
      <mpadded width="+1.7pt">
       <mn>0.0018167</mn>
      </mpadded>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mrow>
         <mpadded width="+1.7pt">
          <mi>sec</mi>
         </mpadded>
         <mpadded width="+1.7pt">
          <mi>z</mi>
         </mpadded>
        </mrow>
        <mo>-</mo>
        <mn>1</mn>
       </mrow>
       <mo rspace="4.2pt" stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo>-</mo>
     <mrow>
      <mpadded width="+1.7pt">
       <mn>0.002875</mn>
      </mpadded>
      <mpadded width="+1.7pt">
       <msup>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <mrow>
           <mpadded width="+1.7pt">
            <mi>sec</mi>
           </mpadded>
           <mpadded width="+1.7pt">
            <mi>z</mi>
           </mpadded>
          </mrow>
          <mo>-</mo>
          <mn>1</mn>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
        <mn>2</mn>
       </msup>
      </mpadded>
     </mrow>
     <mo>-</mo>
     <mrow>
      <mpadded width="+1.7pt">
       <mn>0.0008083</mn>
      </mpadded>
      <mpadded width="+1.7pt">
       <msup>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <mrow>
           <mpadded width="+1.7pt">
            <mi>sec</mi>
           </mpadded>
           <mpadded width="+1.7pt">
            <mi>z</mi>
           </mpadded>
          </mrow>
          <mo>-</mo>
          <mn>1</mn>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
        <mn>3</mn>
       </msup>
      </mpadded>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>X</ci>
    <apply>
     <minus></minus>
     <apply>
      <sec></sec>
      <ci>z</ci>
     </apply>
     <apply>
      <times></times>
      <cn type="float">0.0018167</cn>
      <apply>
       <minus></minus>
       <apply>
        <sec></sec>
        <ci>z</ci>
       </apply>
       <cn type="float">1</cn>
      </apply>
     </apply>
     <apply>
      <times></times>
      <cn type="float">0.002875</cn>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <minus></minus>
        <apply>
         <sec></sec>
         <ci>z</ci>
        </apply>
        <cn type="float">1</cn>
       </apply>
       <cn type="integer">2</cn>
      </apply>
     </apply>
     <apply>
      <times></times>
      <cn type="float">0.0008083</cn>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <minus></minus>
        <apply>
         <sec></sec>
         <ci>z</ci>
        </apply>
        <cn type="float">1</cn>
       </apply>
       <cn type="integer">3</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   X=\sec\,z\,-\,0.0018167\,(\sec\,z\,-\,1)\,-\,0.002875\,(\sec\,z\,-\,1)^{2}\,-%
\,0.0008083\,(\sec\,z\,-\,1)^{3}\,,
  </annotation>
 </semantics>
</math>

</p>

<p>which gives usable results for zenith angles of up to perhaps 85°. As with the previous formula, the calculated air mass reaches a maximum, and then approaches negative infinity at the horizon.</p>

<p><a href="#CITEREFRozenberg1966" title="wikilink">Rozenberg (1966)</a> suggested</p>

<p>

<math display="block" id="Air_mass_(astronomy):11">
 <semantics>
  <mrow>
   <mrow>
    <mi>X</mi>
    <mo>=</mo>
    <mpadded width="+1.7pt">
     <msup>
      <mrow>
       <mo>(</mo>
       <mrow>
        <mrow>
         <mpadded width="+1.7pt">
          <mi>cos</mi>
         </mpadded>
         <mi>z</mi>
        </mrow>
        <mo>+</mo>
        <mrow>
         <mn>0.025</mn>
         <msup>
          <mi>e</mi>
          <mrow>
           <mo>-</mo>
           <mrow>
            <mn>11</mn>
            <mrow>
             <mpadded width="+1.7pt">
              <mi>cos</mi>
             </mpadded>
             <mi>z</mi>
            </mrow>
           </mrow>
          </mrow>
         </msup>
        </mrow>
       </mrow>
       <mo>)</mo>
      </mrow>
      <mrow>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
     </msup>
    </mpadded>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>X</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <plus></plus>
      <apply>
       <cos></cos>
       <ci>z</ci>
      </apply>
      <apply>
       <times></times>
       <cn type="float">0.025</cn>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>e</ci>
        <apply>
         <minus></minus>
         <apply>
          <times></times>
          <cn type="integer">11</cn>
          <apply>
           <cos></cos>
           <ci>z</ci>
          </apply>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <minus></minus>
      <cn type="integer">1</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   X=\left(\cos\,z+0.025e^{-11\cos\,z}\right)^{-1}\,,
  </annotation>
 </semantics>
</math>

</p>

<p>which gives reasonable results for high zenith angles, with a horizon air mass of 40.</p>

<p><a href="#CITEREFKastenYoung1989" title="wikilink">Kasten and Young (1989)</a> developed<ref> The Kasten and Young formula was originally given in terms of <em>altitude</em> 

<math display="inline" id="Air_mass_(astronomy):12">
 <semantics>
  <mi>γ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>γ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \gamma
  </annotation>
 </semantics>
</math>

 as</ref></p>

<p>

<math display="block" id="Air_mass_(astronomy):13">
 <semantics>
  <mrow>
   <mrow>
    <mi>X</mi>
    <mo>=</mo>
    <mpadded width="+2.8pt">
     <mfrac>
      <mn>1</mn>
      <mrow>
       <mrow>
        <mpadded width="+1.7pt">
         <mi>sin</mi>
        </mpadded>
        <mi>γ</mi>
       </mrow>
       <mo>+</mo>
       <mrow>
        <mpadded width="+1.7pt">
         <mn>0.50572</mn>
        </mpadded>
        <msup>
         <mrow>
          <mo stretchy="false">(</mo>
          <mrow>
           <mi>γ</mi>
           <mo>+</mo>
           <msup>
            <mn>6.07995</mn>
            <mo>∘</mo>
           </msup>
          </mrow>
          <mo stretchy="false">)</mo>
         </mrow>
         <mrow>
          <mo>-</mo>
          <mn>1.6364</mn>
         </mrow>
        </msup>
       </mrow>
      </mrow>
     </mfrac>
    </mpadded>
   </mrow>
   <mo>;</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>X</ci>
    <apply>
     <divide></divide>
     <cn type="integer">1</cn>
     <apply>
      <plus></plus>
      <apply>
       <sin></sin>
       <ci>γ</ci>
      </apply>
      <apply>
       <times></times>
       <cn type="float">0.50572</cn>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <plus></plus>
         <ci>γ</ci>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <cn type="float">6.07995</cn>
          <compose></compose>
         </apply>
        </apply>
        <apply>
         <minus></minus>
         <cn type="float">1.6364</cn>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   X=\frac{1}{\sin\,\gamma+0.50572\,(\gamma+6.07995^{\circ})^{-1.6364}}\;;
  </annotation>
 </semantics>
</math>

 in this article, it is given in terms of zenith angle for consistency with the other formulas. </p>

<p>

<math display="block" id="Air_mass_(astronomy):14">
 <semantics>
  <mrow>
   <mrow>
    <mi>X</mi>
    <mo>=</mo>
    <mpadded width="+1.7pt">
     <mfrac>
      <mn>1</mn>
      <mrow>
       <mrow>
        <mpadded width="+1.7pt">
         <mi>cos</mi>
        </mpadded>
        <mi>z</mi>
       </mrow>
       <mo>+</mo>
       <mrow>
        <mpadded width="+1.7pt">
         <mn>0.50572</mn>
        </mpadded>
        <msup>
         <mrow>
          <mo stretchy="false">(</mo>
          <mrow>
           <mrow>
            <msup>
             <mn>6.07995</mn>
             <mo>∘</mo>
            </msup>
            <mo>+</mo>
            <mn>90</mn>
           </mrow>
           <mo>-</mo>
           <mi>z</mi>
          </mrow>
          <mo stretchy="false">)</mo>
         </mrow>
         <mrow>
          <mo>-</mo>
          <mn>1.6364</mn>
         </mrow>
        </msup>
       </mrow>
      </mrow>
     </mfrac>
    </mpadded>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>X</ci>
    <apply>
     <divide></divide>
     <cn type="integer">1</cn>
     <apply>
      <plus></plus>
      <apply>
       <cos></cos>
       <ci>z</ci>
      </apply>
      <apply>
       <times></times>
       <cn type="float">0.50572</cn>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <minus></minus>
         <apply>
          <plus></plus>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <cn type="float">6.07995</cn>
           <compose></compose>
          </apply>
          <cn type="integer">90</cn>
         </apply>
         <ci>z</ci>
        </apply>
        <apply>
         <minus></minus>
         <cn type="float">1.6364</cn>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   X=\frac{1}{\cos\,z+0.50572\,(6.07995^{\circ}+90-z)^{-1.6364}}\,,
  </annotation>
 </semantics>
</math>

</p>

<p>which gives reasonable results for zenith angles of up to 90°, with an air mass of approximately 38 at the horizon. Here the second 

<math display="inline" id="Air_mass_(astronomy):15">
 <semantics>
  <mi>z</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>z</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   z
  </annotation>
 </semantics>
</math>

 term is in <em>degrees</em>.</p>

<p><a href="#CITEREFYoung1994" title="wikilink">Young (1994)</a> developed</p>

<p>

<math display="block" id="Air_mass_(astronomy):16">
 <semantics>
  <mrow>
   <mrow>
    <mi>X</mi>
    <mo>=</mo>
    <mpadded width="+1.7pt">
     <mfrac>
      <mrow>
       <mrow>
        <mpadded width="+1.7pt">
         <mn>1.002432</mn>
        </mpadded>
        <mrow>
         <msup>
          <mi>cos</mi>
          <mn>2</mn>
         </msup>
         <msub>
          <mi>z</mi>
          <mi mathvariant="normal">t</mi>
         </msub>
        </mrow>
       </mrow>
       <mo>+</mo>
       <mrow>
        <mpadded width="+1.7pt">
         <mn>0.148386</mn>
        </mpadded>
        <mrow>
         <mpadded width="+1.7pt">
          <mi>cos</mi>
         </mpadded>
         <msub>
          <mi>z</mi>
          <mi mathvariant="normal">t</mi>
         </msub>
        </mrow>
       </mrow>
       <mo>+</mo>
       <mn>0.0096467</mn>
      </mrow>
      <mrow>
       <mrow>
        <msup>
         <mi>cos</mi>
         <mn>3</mn>
        </msup>
        <msub>
         <mi>z</mi>
         <mi mathvariant="normal">t</mi>
        </msub>
       </mrow>
       <mo>+</mo>
       <mrow>
        <mpadded width="+1.7pt">
         <mn>0.149864</mn>
        </mpadded>
        <mrow>
         <msup>
          <mi>cos</mi>
          <mn>2</mn>
         </msup>
         <msub>
          <mi>z</mi>
          <mi mathvariant="normal">t</mi>
         </msub>
        </mrow>
       </mrow>
       <mo>+</mo>
       <mrow>
        <mpadded width="+1.7pt">
         <mn>0.0102963</mn>
        </mpadded>
        <mrow>
         <mpadded width="+1.7pt">
          <mi>cos</mi>
         </mpadded>
         <msub>
          <mi>z</mi>
          <mi mathvariant="normal">t</mi>
         </msub>
        </mrow>
       </mrow>
       <mo>+</mo>
       <mn>0.000303978</mn>
      </mrow>
     </mfrac>
    </mpadded>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>X</ci>
    <apply>
     <divide></divide>
     <apply>
      <plus></plus>
      <apply>
       <times></times>
       <cn type="float">1.002432</cn>
       <apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <cos></cos>
         <cn type="integer">2</cn>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>z</ci>
         <ci>normal-t</ci>
        </apply>
       </apply>
      </apply>
      <apply>
       <times></times>
       <cn type="float">0.148386</cn>
       <apply>
        <cos></cos>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>z</ci>
         <ci>normal-t</ci>
        </apply>
       </apply>
      </apply>
      <cn type="float">0.0096467</cn>
     </apply>
     <apply>
      <plus></plus>
      <apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <cos></cos>
        <cn type="integer">3</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>z</ci>
        <ci>normal-t</ci>
       </apply>
      </apply>
      <apply>
       <times></times>
       <cn type="float">0.149864</cn>
       <apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <cos></cos>
         <cn type="integer">2</cn>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>z</ci>
         <ci>normal-t</ci>
        </apply>
       </apply>
      </apply>
      <apply>
       <times></times>
       <cn type="float">0.0102963</cn>
       <apply>
        <cos></cos>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>z</ci>
         <ci>normal-t</ci>
        </apply>
       </apply>
      </apply>
      <cn type="float">0.000303978</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   X=\frac{1.002432\,\cos^{2}z_{\mathrm{t}}+0.148386\,\cos\,z_{\mathrm{t}}+0.0096%
467}{\cos^{3}z_{\mathrm{t}}+0.149864\,\cos^{2}z_{\mathrm{t}}+0.0102963\,\cos\,%
z_{\mathrm{t}}+0.000303978}\,,
  </annotation>
 </semantics>
</math>

</p>

<p>in terms of the true zenith angle 

<math display="inline" id="Air_mass_(astronomy):17">
 <semantics>
  <msub>
   <mi>z</mi>
   <mi mathvariant="normal">t</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>z</ci>
    <ci>normal-t</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   z_{\mathrm{t}}
  </annotation>
 </semantics>
</math>

, for which he claimed a maximum error (at the horizon) of 0.0037 air mass.</p>

<p><a href="#CITEREFPickering2002" title="wikilink">Pickering (2002)</a> developed</p>

<p>

<math display="block" id="Air_mass_(astronomy):18">
 <semantics>
  <mrow>
   <mrow>
    <mi>X</mi>
    <mo>=</mo>
    <mpadded width="+1.7pt">
     <mfrac>
      <mn>1</mn>
      <mrow>
       <mi>sin</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mi>h</mi>
         <mo>+</mo>
         <mrow>
          <mn>244</mn>
          <mo>/</mo>
          <mrow>
           <mo stretchy="false">(</mo>
           <mrow>
            <mn>165</mn>
            <mo>+</mo>
            <mrow>
             <mn>47</mn>
             <msup>
              <mi>h</mi>
              <mn>1.1</mn>
             </msup>
            </mrow>
           </mrow>
           <mo stretchy="false">)</mo>
          </mrow>
         </mrow>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
     </mfrac>
    </mpadded>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>X</ci>
    <apply>
     <divide></divide>
     <cn type="integer">1</cn>
     <apply>
      <sin></sin>
      <apply>
       <plus></plus>
       <ci>h</ci>
       <apply>
        <divide></divide>
        <cn type="integer">244</cn>
        <apply>
         <plus></plus>
         <cn type="integer">165</cn>
         <apply>
          <times></times>
          <cn type="integer">47</cn>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <ci>h</ci>
           <cn type="float">1.1</cn>
          </apply>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   X=\frac{1}{\sin(h+{244}/(165+47h^{1.1}))}\,,
  </annotation>
 </semantics>
</math>

</p>

<p>where 

<math display="inline" id="Air_mass_(astronomy):19">
 <semantics>
  <mi>h</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>h</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   h
  </annotation>
 </semantics>
</math>

 is apparent altitude 

<math display="inline" id="Air_mass_(astronomy):20">
 <semantics>
  <mrow>
   <mo stretchy="false">(</mo>
   <mrow>
    <msup>
     <mn>90</mn>
     <mo>∘</mo>
    </msup>
    <mo>-</mo>
    <mi>z</mi>
   </mrow>
   <mo stretchy="false">)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <minus></minus>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <cn type="integer">90</cn>
     <compose></compose>
    </apply>
    <ci>z</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (90^{\circ}-z)
  </annotation>
 </semantics>
</math>

 in degrees. Pickering claimed his equation to have a tenth the error of <a href="#CITEREFSchaefer1998" title="wikilink">Schaefer (1998)</a> near the horizon.<a class="footnoteRef" href="#fn3" id="fnref3"><sup>3</sup></a></p>
<h3 id="atmospheric-models">Atmospheric models</h3>

<p>Interpolative formulas attempt to provide a good fit to tabular values of air mass using minimal computational overhead. The tabular values, however, must be determined from measurements or atmospheric models that derive from geometrical and physical considerations of Earth and its atmosphere.</p>
<h4 id="nonrefracting-radially-symmetrical-atmosphere">Nonrefracting radially symmetrical atmosphere</h4>

<p> If refraction is ignored, it can be shown from simple geometrical considerations (<a href="#CITEREFSchoenberg1929" title="wikilink">Schoenberg 1929</a>, 173) that the path 

<math display="inline" id="Air_mass_(astronomy):21">
 <semantics>
  <mi>s</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>s</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   s
  </annotation>
 </semantics>
</math>

 of a light ray at zenith angle 

<math display="inline" id="Air_mass_(astronomy):22">
 <semantics>
  <mi>z</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>z</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   z
  </annotation>
 </semantics>
</math>

 through a radially symmetrical atmosphere of height 

<math display="inline" id="Air_mass_(astronomy):23">
 <semantics>
  <msub>
   <mi>y</mi>
   <mi>atm</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>y</ci>
    <ci>atm</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   y_{\mathrm{atm}}
  </annotation>
 </semantics>
</math>

 is given by</p>

<p>

<math display="block" id="Air_mass_(astronomy):24">
 <semantics>
  <mrow>
   <mrow>
    <mi>s</mi>
    <mo>=</mo>
    <mrow>
     <msqrt>
      <mrow>
       <mrow>
        <msubsup>
         <mi>R</mi>
         <mi mathvariant="normal">E</mi>
         <mn>2</mn>
        </msubsup>
        <mrow>
         <msup>
          <mi>cos</mi>
          <mn>2</mn>
         </msup>
         <mi>z</mi>
        </mrow>
       </mrow>
       <mo>+</mo>
       <mrow>
        <mn>2</mn>
        <msub>
         <mi>R</mi>
         <mi mathvariant="normal">E</mi>
        </msub>
        <msub>
         <mi>y</mi>
         <mi>atm</mi>
        </msub>
       </mrow>
       <mo>+</mo>
       <msubsup>
        <mi>y</mi>
        <mi>atm</mi>
        <mn>2</mn>
       </msubsup>
      </mrow>
     </msqrt>
     <mo>-</mo>
     <mrow>
      <msub>
       <mi>R</mi>
       <mi mathvariant="normal">E</mi>
      </msub>
      <mrow>
       <mpadded width="+1.7pt">
        <mi>cos</mi>
       </mpadded>
       <mpadded width="+1.7pt">
        <mi>z</mi>
       </mpadded>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>s</ci>
    <apply>
     <minus></minus>
     <apply>
      <root></root>
      <apply>
       <plus></plus>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>R</ci>
          <ci>normal-E</ci>
         </apply>
         <cn type="integer">2</cn>
        </apply>
        <apply>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <cos></cos>
          <cn type="integer">2</cn>
         </apply>
         <ci>z</ci>
        </apply>
       </apply>
       <apply>
        <times></times>
        <cn type="integer">2</cn>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>R</ci>
         <ci>normal-E</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>y</ci>
         <ci>atm</ci>
        </apply>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>y</ci>
         <ci>atm</ci>
        </apply>
        <cn type="integer">2</cn>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>R</ci>
       <ci>normal-E</ci>
      </apply>
      <apply>
       <cos></cos>
       <ci>z</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   s=\sqrt{R_{\mathrm{E}}^{2}\cos^{2}z+2R_{\mathrm{E}}y_{\mathrm{atm}}+y_{\mathrm%
{atm}}^{2}}-R_{\mathrm{E}}\cos\,z\,,
  </annotation>
 </semantics>
</math>

</p>

<p>or alternatively,</p>

<p>

<math display="block" id="Air_mass_(astronomy):25">
 <semantics>
  <mrow>
   <mrow>
    <mi>s</mi>
    <mo>=</mo>
    <mrow>
     <msqrt>
      <mrow>
       <msup>
        <mrow>
         <mo>(</mo>
         <mrow>
          <msub>
           <mi>R</mi>
           <mi mathvariant="normal">E</mi>
          </msub>
          <mo>+</mo>
          <msub>
           <mi>y</mi>
           <mi>atm</mi>
          </msub>
         </mrow>
         <mo>)</mo>
        </mrow>
        <mn>2</mn>
       </msup>
       <mo>-</mo>
       <mrow>
        <msubsup>
         <mi>R</mi>
         <mi mathvariant="normal">E</mi>
         <mn>2</mn>
        </msubsup>
        <mrow>
         <msup>
          <mi>sin</mi>
          <mn>2</mn>
         </msup>
         <mi>z</mi>
        </mrow>
       </mrow>
      </mrow>
     </msqrt>
     <mo>-</mo>
     <mrow>
      <msub>
       <mi>R</mi>
       <mi mathvariant="normal">E</mi>
      </msub>
      <mrow>
       <mpadded width="+1.7pt">
        <mi>cos</mi>
       </mpadded>
       <mpadded width="+1.7pt">
        <mi>z</mi>
       </mpadded>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>s</ci>
    <apply>
     <minus></minus>
     <apply>
      <root></root>
      <apply>
       <minus></minus>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <plus></plus>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>R</ci>
          <ci>normal-E</ci>
         </apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>y</ci>
          <ci>atm</ci>
         </apply>
        </apply>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>R</ci>
          <ci>normal-E</ci>
         </apply>
         <cn type="integer">2</cn>
        </apply>
        <apply>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <sin></sin>
          <cn type="integer">2</cn>
         </apply>
         <ci>z</ci>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>R</ci>
       <ci>normal-E</ci>
      </apply>
      <apply>
       <cos></cos>
       <ci>z</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   s=\sqrt{\left(R_{\mathrm{E}}+y_{\mathrm{atm}}\right)^{2}-R_{\mathrm{E}}^{2}%
\sin^{2}z}-R_{\mathrm{E}}\cos\,z\,,
  </annotation>
 </semantics>
</math>

</p>

<p>where 

<math display="inline" id="Air_mass_(astronomy):26">
 <semantics>
  <msub>
   <mi>R</mi>
   <mi mathvariant="normal">E</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>R</ci>
    <ci>normal-E</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   R_{\mathrm{E}}
  </annotation>
 </semantics>
</math>

 is the radius of the Earth.</p>
<h4 id="homogeneous-atmosphere">Homogeneous atmosphere</h4>

<p>If the atmosphere is <a href="Homogeneity_(physics)" title="wikilink">homogeneous</a> (i.e., <a class="uri" href="density" title="wikilink">density</a> is constant), the path at zenith is simply the atmospheric height 

<math display="inline" id="Air_mass_(astronomy):27">
 <semantics>
  <msub>
   <mi>y</mi>
   <mi>atm</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>y</ci>
    <ci>atm</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   y_{\mathrm{atm}}
  </annotation>
 </semantics>
</math>

, and the relative air mass is</p>

<p>

<math display="block" id="Air_mass_(astronomy):28">
 <semantics>
  <mrow>
   <mrow>
    <mi>X</mi>
    <mo>=</mo>
    <mfrac>
     <mi>s</mi>
     <msub>
      <mi>y</mi>
      <mi>atm</mi>
     </msub>
    </mfrac>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mfrac>
       <msub>
        <mi>R</mi>
        <mi mathvariant="normal">E</mi>
       </msub>
       <msub>
        <mi>y</mi>
        <mi>atm</mi>
       </msub>
      </mfrac>
      <msqrt>
       <mrow>
        <mrow>
         <msup>
          <mi>cos</mi>
          <mn>2</mn>
         </msup>
         <mi>z</mi>
        </mrow>
        <mo>+</mo>
        <mrow>
         <mn>2</mn>
         <mfrac>
          <msub>
           <mi>y</mi>
           <mi>atm</mi>
          </msub>
          <msub>
           <mi>R</mi>
           <mi mathvariant="normal">E</mi>
          </msub>
         </mfrac>
        </mrow>
        <mo>+</mo>
        <msup>
         <mrow>
          <mo>(</mo>
          <mfrac>
           <msub>
            <mi>y</mi>
            <mi>atm</mi>
           </msub>
           <msub>
            <mi>R</mi>
            <mi mathvariant="normal">E</mi>
           </msub>
          </mfrac>
          <mo>)</mo>
         </mrow>
         <mn>2</mn>
        </msup>
       </mrow>
      </msqrt>
     </mrow>
     <mo>-</mo>
     <mrow>
      <mfrac>
       <msub>
        <mi>R</mi>
        <mi mathvariant="normal">E</mi>
       </msub>
       <msub>
        <mi>y</mi>
        <mi>atm</mi>
       </msub>
      </mfrac>
      <mrow>
       <mpadded width="+1.7pt">
        <mi>cos</mi>
       </mpadded>
       <mpadded width="+1.7pt">
        <mi>z</mi>
       </mpadded>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <ci>X</ci>
     <apply>
      <divide></divide>
      <ci>s</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>y</ci>
       <ci>atm</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <minus></minus>
      <apply>
       <times></times>
       <apply>
        <divide></divide>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>R</ci>
         <ci>normal-E</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>y</ci>
         <ci>atm</ci>
        </apply>
       </apply>
       <apply>
        <root></root>
        <apply>
         <plus></plus>
         <apply>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <cos></cos>
           <cn type="integer">2</cn>
          </apply>
          <ci>z</ci>
         </apply>
         <apply>
          <times></times>
          <cn type="integer">2</cn>
          <apply>
           <divide></divide>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <ci>y</ci>
            <ci>atm</ci>
           </apply>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <ci>R</ci>
            <ci>normal-E</ci>
           </apply>
          </apply>
         </apply>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <apply>
           <divide></divide>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <ci>y</ci>
            <ci>atm</ci>
           </apply>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <ci>R</ci>
            <ci>normal-E</ci>
           </apply>
          </apply>
          <cn type="integer">2</cn>
         </apply>
        </apply>
       </apply>
      </apply>
      <apply>
       <times></times>
       <apply>
        <divide></divide>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>R</ci>
         <ci>normal-E</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>y</ci>
         <ci>atm</ci>
        </apply>
       </apply>
       <apply>
        <cos></cos>
        <ci>z</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   X=\frac{s}{y_{\mathrm{atm}}}=\frac{R_{\mathrm{E}}}{y_{\mathrm{atm}}}\sqrt{\cos%
^{2}z+2\frac{y_{\mathrm{atm}}}{R_{\mathrm{E}}}+\left(\frac{y_{\mathrm{atm}}}{R%
_{\mathrm{E}}}\right)^{2}}-\frac{R_{\mathrm{E}}}{y_{\mathrm{atm}}}\cos\,z\,.
  </annotation>
 </semantics>
</math>

</p>

<p>If density is constant, <a class="uri" href="hydrostatic" title="wikilink">hydrostatic</a> considerations give the atmospheric height as</p>

<p>

<math display="block" id="Air_mass_(astronomy):29">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>y</mi>
     <mi>atm</mi>
    </msub>
    <mo>=</mo>
    <mpadded width="+1.7pt">
     <mfrac>
      <mrow>
       <mi>k</mi>
       <msub>
        <mi>T</mi>
        <mn>0</mn>
       </msub>
      </mrow>
      <mrow>
       <mi>m</mi>
       <mi>g</mi>
      </mrow>
     </mfrac>
    </mpadded>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>y</ci>
     <ci>atm</ci>
    </apply>
    <apply>
     <divide></divide>
     <apply>
      <times></times>
      <ci>k</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>T</ci>
       <cn type="integer">0</cn>
      </apply>
     </apply>
     <apply>
      <times></times>
      <ci>m</ci>
      <ci>g</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   y_{\mathrm{atm}}=\frac{kT_{0}}{mg}\,,
  </annotation>
 </semantics>
</math>

</p>

<p>where 

<math display="inline" id="Air_mass_(astronomy):30">
 <semantics>
  <mi>k</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>k</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   k
  </annotation>
 </semantics>
</math>

 is <a href="Boltzmann's_constant" title="wikilink">Boltzmann’s constant</a>, 

<math display="inline" id="Air_mass_(astronomy):31">
 <semantics>
  <msub>
   <mi>T</mi>
   <mn>0</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>T</ci>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   T_{0}
  </annotation>
 </semantics>
</math>

 is the sea-level temperature, 

<math display="inline" id="Air_mass_(astronomy):32">
 <semantics>
  <mi>m</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>m</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   m
  </annotation>
 </semantics>
</math>


 is the molecular mass of air, and 

<math display="inline" id="Air_mass_(astronomy):33">
 <semantics>
  <mi>g</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>g</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   g
  </annotation>
 </semantics>
</math>

 is the acceleration due to gravity. Although this is the same as the pressure <a href="scale_height" title="wikilink">scale height</a> of an <a href="isothermal_atmosphere" title="wikilink">isothermal atmosphere</a>, the implication is slightly different. In an isothermal atmosphere, 37% of the atmosphere is above the pressure scale height; in a homogeneous atmosphere, there is no atmosphere above the atmospheric height.</p>

<p>Taking 

<math display="inline" id="Air_mass_(astronomy):34">
 <semantics>
  <msub>
   <mi>T</mi>
   <mn>0</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>T</ci>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   T_{0}
  </annotation>
 </semantics>
</math>

 = 288.15 K, 

<math display="inline" id="Air_mass_(astronomy):35">
 <semantics>
  <mi>m</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>m</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   m
  </annotation>
 </semantics>
</math>

 = 28.9644×1.6605×10<sup>−27</sup> kg, and 

<math display="inline" id="Air_mass_(astronomy):36">
 <semantics>
  <mi>g</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>g</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   g
  </annotation>
 </semantics>
</math>

 = 9.80665 m/s<sup>2</sup> gives 

<math display="inline" id="Air_mass_(astronomy):37">
 <semantics>
  <msub>
   <mi>y</mi>
   <mi>atm</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>y</ci>
    <ci>atm</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   y_{\mathrm{atm}}
  </annotation>
 </semantics>
</math>


 ≈ 8435 m. Using Earth’s mean radius of 6371 km, the sea-level air mass at the horizon is</p>

<p>

<math display="block" id="Air_mass_(astronomy):38">
 <semantics>
  <mrow>
   <msub>
    <mi>X</mi>
    <mi>horiz</mi>
   </msub>
   <mo>=</mo>
   <msqrt>
    <mrow>
     <mn>1</mn>
     <mo>+</mo>
     <mrow>
      <mn>2</mn>
      <mfrac>
       <msub>
        <mi>R</mi>
        <mi mathvariant="normal">E</mi>
       </msub>
       <msub>
        <mi>y</mi>
        <mi>atm</mi>
       </msub>
      </mfrac>
     </mrow>
    </mrow>
   </msqrt>
   <mo>≈</mo>
   <mn>38.87 .</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>X</ci>
      <ci>horiz</ci>
     </apply>
     <apply>
      <root></root>
      <apply>
       <plus></plus>
       <cn type="integer">1</cn>
       <apply>
        <times></times>
        <cn type="integer">2</cn>
        <apply>
         <divide></divide>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>R</ci>
          <ci>normal-E</ci>
         </apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>y</ci>
          <ci>atm</ci>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <approx></approx>
     <share href="#.cmml">
     </share>
     <cn type="float">38.87 .</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   X_{\mathrm{horiz}}=\sqrt{1+2\frac{R_{\mathrm{E}}}{y_{\mathrm{atm}}}}\approx 38%
.87\,.
  </annotation>
 </semantics>
</math>

</p>

<p>The homogeneous spherical model slightly underestimates the rate of increase in air mass near the horizon; a reasonable overall fit to values determined from more rigorous models can be had by setting the air mass to match a value at a zenith angle less than 90°. The air mass equation can be rearranged to give</p>

<p>

<math display="block" id="Air_mass_(astronomy):39">
 <semantics>
  <mrow>
   <mrow>
    <mfrac>
     <msub>
      <mi>R</mi>
      <mi mathvariant="normal">E</mi>
     </msub>
     <msub>
      <mi>y</mi>
      <mi>atm</mi>
     </msub>
    </mfrac>
    <mo>=</mo>
    <mpadded width="+1.7pt">
     <mfrac>
      <mrow>
       <msup>
        <mi>X</mi>
        <mn>2</mn>
       </msup>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
      <mrow>
       <mn>2</mn>
       <mrow>
        <mo>(</mo>
        <mrow>
         <mn>1</mn>
         <mo>-</mo>
         <mrow>
          <mi>X</mi>
          <mrow>
           <mi>cos</mi>
           <mi>z</mi>
          </mrow>
         </mrow>
        </mrow>
        <mo>)</mo>
       </mrow>
      </mrow>
     </mfrac>
    </mpadded>
   </mrow>
   <mo>;</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <divide></divide>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>R</ci>
      <ci>normal-E</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <ci>atm</ci>
     </apply>
    </apply>
    <apply>
     <divide></divide>
     <apply>
      <minus></minus>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>X</ci>
       <cn type="integer">2</cn>
      </apply>
      <cn type="integer">1</cn>
     </apply>
     <apply>
      <times></times>
      <cn type="integer">2</cn>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
       <apply>
        <times></times>
        <ci>X</ci>
        <apply>
         <cos></cos>
         <ci>z</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \frac{R_{\mathrm{E}}}{y_{\mathrm{atm}}}=\frac{X^{2}-1}{2\left(1-X\cos z\right)%
}\,;
  </annotation>
 </semantics>
</math>

</p>

<p>matching Bemporad’s value of 19.787 at 

<math display="inline" id="Air_mass_(astronomy):40">
 <semantics>
  <mi>z</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>z</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   z
  </annotation>
 </semantics>
</math>

 = 88° gives 

<math display="inline" id="Air_mass_(astronomy):41">
 <semantics>
  <mrow>
   <msub>
    <mi>R</mi>
    <mi mathvariant="normal">E</mi>
   </msub>
   <mo>/</mo>
   <msub>
    <mi>y</mi>
    <mi>atm</mi>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <divide></divide>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>R</ci>
     <ci>normal-E</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>y</ci>
     <ci>atm</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   R_{\mathrm{E}}/y_{\mathrm{atm}}
  </annotation>
 </semantics>
</math>

 ≈ 631.01 and 

<math display="inline" id="Air_mass_(astronomy):42">
 <semantics>
  <msub>
   <mi>X</mi>
   <mi>horiz</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>X</ci>
    <ci>horiz</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   X_{\mathrm{horiz}}
  </annotation>
 </semantics>
</math>

 ≈ 35.54. With the same value for 

<math display="inline" id="Air_mass_(astronomy):43">
 <semantics>
  <msub>
   <mi>R</mi>
   <mi mathvariant="normal">E</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>R</ci>
    <ci>normal-E</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   R_{\mathrm{E}}
  </annotation>
 </semantics>
</math>

 as above, 

<math display="inline" id="Air_mass_(astronomy):44">
 <semantics>
  <msub>
   <mi>y</mi>
   <mi>atm</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>y</ci>
    <ci>atm</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   y_{\mathrm{atm}}
  </annotation>
 </semantics>
</math>

 ≈ 10,096 m.</p>

<p>While a homogeneous atmosphere isn’t a physically realistic model, the approximation is reasonable as long as the scale height of the atmosphere is small compared to the radius of the planet. The model is usable (i.e., it does not diverge or go to zero) at all zenith angles, including those greater than 90° (<em>see</em> <a href="#Homogeneous_spherical_atmosphere_with_elevated_observer" title="wikilink">Homogeneous spherical atmosphere with elevated observer</a> <em>below</em>). The model requires comparatively little computational overhead, and if high accuracy is not required, it gives reasonable results.<a class="footnoteRef" href="#fn4" id="fnref4"><sup>4</sup></a> However, for zenith angles less than 90°, a better fit to accepted values of air mass can be had with several of the interpolative formulas.</p>
<h4 id="variable-density-atmosphere">Variable-density atmosphere</h4>

<p>In a real atmosphere, density decreases with elevation above <a href="mean_sea_level" title="wikilink">mean sea level</a>. The <em>absolute air mass</em> 

<math display="inline" id="Air_mass_(astronomy):45">
 <semantics>
  <mi>σ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>σ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \sigma
  </annotation>
 </semantics>
</math>

 then is</p>

<p>

<math display="block" id="Air_mass_(astronomy):46">
 <semantics>
  <mrow>
   <mrow>
    <mi>σ</mi>
    <mo>=</mo>
    <mrow>
     <mo largeop="true" symmetric="true">∫</mo>
     <mrow>
      <mpadded width="+1.7pt">
       <mi>ρ</mi>
      </mpadded>
      <mi mathvariant="normal">d</mi>
      <mpadded width="+1.7pt">
       <mi>s</mi>
      </mpadded>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>σ</ci>
    <apply>
     <int></int>
     <apply>
      <times></times>
      <ci>ρ</ci>
      <ci>normal-d</ci>
      <ci>s</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \sigma=\int\rho\,\mathrm{d}s\,.
  </annotation>
 </semantics>
</math>

</p>

<p>For the geometrical light path discussed above, this becomes, for a sea-level observer,</p>

<p>

<math display="block" id="Air_mass_(astronomy):47">
 <semantics>
  <mrow>
   <mrow>
    <mi>σ</mi>
    <mo>=</mo>
    <mrow>
     <msubsup>
      <mo largeop="true" symmetric="true">∫</mo>
      <mn>0</mn>
      <msub>
       <mi>y</mi>
       <mi>atm</mi>
      </msub>
     </msubsup>
     <mpadded width="+1.7pt">
      <mfrac>
       <mrow>
        <mpadded width="+1.7pt">
         <mi>ρ</mi>
        </mpadded>
        <mrow>
         <mo>(</mo>
         <mrow>
          <msub>
           <mi>R</mi>
           <mi mathvariant="normal">E</mi>
          </msub>
          <mo>+</mo>
          <mi>y</mi>
         </mrow>
         <mo>)</mo>
        </mrow>
        <mi mathvariant="normal">d</mi>
        <mi>y</mi>
       </mrow>
       <msqrt>
        <mrow>
         <mrow>
          <msubsup>
           <mi>R</mi>
           <mi mathvariant="normal">E</mi>
           <mn>2</mn>
          </msubsup>
          <mrow>
           <msup>
            <mi>cos</mi>
            <mn>2</mn>
           </msup>
           <mi>z</mi>
          </mrow>
         </mrow>
         <mo>+</mo>
         <mrow>
          <mn>2</mn>
          <msub>
           <mi>R</mi>
           <mi mathvariant="normal">E</mi>
          </msub>
          <mi>y</mi>
         </mrow>
         <mo>+</mo>
         <msup>
          <mi>y</mi>
          <mn>2</mn>
         </msup>
        </mrow>
       </msqrt>
      </mfrac>
     </mpadded>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>σ</ci>
    <apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <int></int>
       <cn type="integer">0</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>y</ci>
       <ci>atm</ci>
      </apply>
     </apply>
     <apply>
      <divide></divide>
      <apply>
       <times></times>
       <ci>ρ</ci>
       <apply>
        <plus></plus>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>R</ci>
         <ci>normal-E</ci>
        </apply>
        <ci>y</ci>
       </apply>
       <ci>normal-d</ci>
       <ci>y</ci>
      </apply>
      <apply>
       <root></root>
       <apply>
        <plus></plus>
        <apply>
         <times></times>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>R</ci>
           <ci>normal-E</ci>
          </apply>
          <cn type="integer">2</cn>
         </apply>
         <apply>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <cos></cos>
           <cn type="integer">2</cn>
          </apply>
          <ci>z</ci>
         </apply>
        </apply>
        <apply>
         <times></times>
         <cn type="integer">2</cn>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>R</ci>
          <ci>normal-E</ci>
         </apply>
         <ci>y</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>y</ci>
         <cn type="integer">2</cn>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \sigma=\int_{0}^{y_{\mathrm{atm}}}\frac{\rho\,\left(R_{\mathrm{E}}+y\right)%
\mathrm{d}y}{\sqrt{R_{\mathrm{E}}^{2}\cos^{2}z+2R_{\mathrm{E}}y+y^{2}}}\,.
  </annotation>
 </semantics>
</math>

</p>

<p>The relative air mass then is</p>

<p>

<math display="block" id="Air_mass_(astronomy):48">
 <semantics>
  <mrow>
   <mrow>
    <mi>X</mi>
    <mo>=</mo>
    <mpadded width="+1.7pt">
     <mfrac>
      <mi>σ</mi>
      <msub>
       <mi>σ</mi>
       <mi>zen</mi>
      </msub>
     </mfrac>
    </mpadded>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>X</ci>
    <apply>
     <divide></divide>
     <ci>σ</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>σ</ci>
      <ci>zen</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   X=\frac{\sigma}{\sigma_{\mathrm{zen}}}\,.
  </annotation>
 </semantics>
</math>

</p>

<p>The absolute air mass at zenith 

<math display="inline" id="Air_mass_(astronomy):49">
 <semantics>
  <msub>
   <mi>σ</mi>
   <mi>zen</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>σ</ci>
    <ci>zen</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \sigma_{\mathrm{zen}}
  </annotation>
 </semantics>
</math>

 is also known as the <em><a href="column_density" title="wikilink">column density</a></em>.</p>
<h4 id="isothermal-atmosphere">Isothermal atmosphere</h4>

<p>Several basic models for density variation with elevation are commonly used. The simplest, an <a href="isothermal_atmosphere" title="wikilink">isothermal atmosphere</a>, gives</p>

<p>

<math display="block" id="Air_mass_(astronomy):50">
 <semantics>
  <mrow>
   <mrow>
    <mi>ρ</mi>
    <mo>=</mo>
    <mrow>
     <msub>
      <mi>ρ</mi>
      <mn>0</mn>
     </msub>
     <mpadded width="+1.7pt">
      <msup>
       <mi>e</mi>
       <mrow>
        <mo>-</mo>
        <mrow>
         <mi>y</mi>
         <mo>/</mo>
         <mi>H</mi>
        </mrow>
       </mrow>
      </msup>
     </mpadded>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>ρ</ci>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>ρ</ci>
      <cn type="integer">0</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>e</ci>
      <apply>
       <minus></minus>
       <apply>
        <divide></divide>
        <ci>y</ci>
        <ci>H</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \rho=\rho_{0}e^{-y/H}\,,
  </annotation>
 </semantics>
</math>

</p>

<p>where 

<math display="inline" id="Air_mass_(astronomy):51">
 <semantics>
  <msub>
   <mi>ρ</mi>
   <mn>0</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>ρ</ci>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \rho_{0}
  </annotation>
 </semantics>
</math>

 is the sea-level density and 

<math display="inline" id="Air_mass_(astronomy):52">
 <semantics>
  <mi>H</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>H</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   H
  </annotation>
 </semantics>
</math>

 is the pressure <a href="scale_height" title="wikilink">scale height</a>. When the limits of integration are zero and infinity, and some high-order terms are dropped, this model yields (<a href="#CITEREFYoung1974" title="wikilink">Young 1974</a>, 147),</p>

<p>

<math display="block" id="Air_mass_(astronomy):53">
 <semantics>
  <mrow>
   <mrow>
    <mi>X</mi>
    <mo>≈</mo>
    <mrow>
     <msqrt>
      <mfrac>
       <mrow>
        <mi>π</mi>
        <mi>R</mi>
       </mrow>
       <mrow>
        <mn>2</mn>
        <mi>H</mi>
       </mrow>
      </mfrac>
     </msqrt>
     <mrow>
      <mi>exp</mi>
      <mrow>
       <mo>(</mo>
       <mfrac>
        <mrow>
         <mi>R</mi>
         <mrow>
          <msup>
           <mi>cos</mi>
           <mn>2</mn>
          </msup>
          <mi>z</mi>
         </mrow>
        </mrow>
        <mrow>
         <mn>2</mn>
         <mi>H</mi>
        </mrow>
       </mfrac>
       <mo rspace="4.2pt">)</mo>
      </mrow>
     </mrow>
     <mi>erfc</mi>
     <mrow>
      <mo>(</mo>
      <msqrt>
       <mfrac>
        <mrow>
         <mi>R</mi>
         <mrow>
          <msup>
           <mi>cos</mi>
           <mn>2</mn>
          </msup>
          <mi>z</mi>
         </mrow>
        </mrow>
        <mrow>
         <mn>2</mn>
         <mi>H</mi>
        </mrow>
       </mfrac>
      </msqrt>
      <mo rspace="4.2pt">)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <approx></approx>
    <ci>X</ci>
    <apply>
     <times></times>
     <apply>
      <root></root>
      <apply>
       <divide></divide>
       <apply>
        <times></times>
        <ci>π</ci>
        <ci>R</ci>
       </apply>
       <apply>
        <times></times>
        <cn type="integer">2</cn>
        <ci>H</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <exp></exp>
      <apply>
       <divide></divide>
       <apply>
        <times></times>
        <ci>R</ci>
        <apply>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <cos></cos>
          <cn type="integer">2</cn>
         </apply>
         <ci>z</ci>
        </apply>
       </apply>
       <apply>
        <times></times>
        <cn type="integer">2</cn>
        <ci>H</ci>
       </apply>
      </apply>
     </apply>
     <ci>erfc</ci>
     <apply>
      <root></root>
      <apply>
       <divide></divide>
       <apply>
        <times></times>
        <ci>R</ci>
        <apply>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <cos></cos>
          <cn type="integer">2</cn>
         </apply>
         <ci>z</ci>
        </apply>
       </apply>
       <apply>
        <times></times>
        <cn type="integer">2</cn>
        <ci>H</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   X\approx\sqrt{\frac{\pi R}{2H}}\exp{\left(\frac{R\cos^{2}z}{2H}\right)}\,%
\mathrm{erfc}\left(\sqrt{\frac{R\cos^{2}z}{2H}}\right)\,.
  </annotation>
 </semantics>
</math>

</p>

<p>An approximate correction for refraction can be made by taking (<a href="#CITEREFYoung1974" title="wikilink">Young 1974</a>, 147)</p>

<p>

<math display="block" id="Air_mass_(astronomy):54">
 <semantics>
  <mrow>
   <mrow>
    <mi>R</mi>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mn>7</mn>
      <mo>/</mo>
      <mpadded width="+1.7pt">
       <mn>6</mn>
      </mpadded>
     </mrow>
     <mpadded width="+1.7pt">
      <msub>
       <mi>R</mi>
       <mi mathvariant="normal">E</mi>
      </msub>
     </mpadded>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>R</ci>
    <apply>
     <times></times>
     <apply>
      <divide></divide>
      <cn type="integer">7</cn>
      <cn type="integer">6</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>R</ci>
      <ci>normal-E</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   R=7/6\,R_{\mathrm{E}}\,,
  </annotation>
 </semantics>
</math>

</p>

<p>where 

<math display="inline" id="Air_mass_(astronomy):55">
 <semantics>
  <msub>
   <mi>R</mi>
   <mi mathvariant="normal">E</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>R</ci>
    <ci>normal-E</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   R_{\mathrm{E}}
  </annotation>
 </semantics>
</math>

 is the physical radius of the Earth. At the horizon, the approximate equation becomes</p>

<p>

<math display="block" id="Air_mass_(astronomy):56">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>X</mi>
     <mi>horiz</mi>
    </msub>
    <mo>≈</mo>
    <mpadded width="+1.7pt">
     <msqrt>
      <mfrac>
       <mrow>
        <mi>π</mi>
        <mi>R</mi>
       </mrow>
       <mrow>
        <mn>2</mn>
        <mi>H</mi>
       </mrow>
      </mfrac>
     </msqrt>
    </mpadded>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <approx></approx>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>X</ci>
     <ci>horiz</ci>
    </apply>
    <apply>
     <root></root>
     <apply>
      <divide></divide>
      <apply>
       <times></times>
       <ci>π</ci>
       <ci>R</ci>
      </apply>
      <apply>
       <times></times>
       <cn type="integer">2</cn>
       <ci>H</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   X_{\mathrm{horiz}}\approx\sqrt{\frac{\pi R}{2H}}\,.
  </annotation>
 </semantics>
</math>

</p>

<p>Using a scale height of 8435 m, Earth’s mean radius of 6371 km, and including the correction for refraction,</p>

<p>

<math display="block" id="Air_mass_(astronomy):57">
 <semantics>
  <mrow>
   <msub>
    <mi>X</mi>
    <mi>horiz</mi>
   </msub>
   <mo>≈</mo>
   <mn>37.20 .</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <approx></approx>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>X</ci>
     <ci>horiz</ci>
    </apply>
    <cn type="float">37.20 .</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   X_{\mathrm{horiz}}\approx 37.20\,.
  </annotation>
 </semantics>
</math>

</p>
<h4 id="polytropic-atmosphere">Polytropic atmosphere</h4>

<p>The assumption of constant temperature is simplistic; a more realistic model is the <a class="uri" href="polytropic" title="wikilink">polytropic</a> atmosphere, for which</p>

<p>

<math display="block" id="Air_mass_(astronomy):58">
 <semantics>
  <mrow>
   <mrow>
    <mi>T</mi>
    <mo>=</mo>
    <mrow>
     <msub>
      <mi>T</mi>
      <mn>0</mn>
     </msub>
     <mo>-</mo>
     <mrow>
      <mi>α</mi>
      <mpadded width="+1.7pt">
       <mi>y</mi>
      </mpadded>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>T</ci>
    <apply>
     <minus></minus>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>T</ci>
      <cn type="integer">0</cn>
     </apply>
     <apply>
      <times></times>
      <ci>α</ci>
      <ci>y</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   T=T_{0}-\alpha y\,,
  </annotation>
 </semantics>
</math>

</p>

<p>where 

<math display="inline" id="Air_mass_(astronomy):59">
 <semantics>
  <msub>
   <mi>T</mi>
   <mn>0</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>T</ci>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   T_{0}
  </annotation>
 </semantics>
</math>

 is the sea-level temperature and 

<math display="inline" id="Air_mass_(astronomy):60">
 <semantics>
  <mi>α</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>α</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \alpha
  </annotation>
 </semantics>
</math>

 is the temperature <a href="lapse_rate" title="wikilink">lapse rate</a>. The density as a function of elevation is</p>

<p>

<math display="block" id="Air_mass_(astronomy):61">
 <semantics>
  <mrow>
   <mrow>
    <mi>ρ</mi>
    <mo>=</mo>
    <mrow>
     <msub>
      <mi>ρ</mi>
      <mn>0</mn>
     </msub>
     <mpadded width="+1.7pt">
      <msup>
       <mrow>
        <mo>(</mo>
        <mrow>
         <mn>1</mn>
         <mo>-</mo>
         <mrow>
          <msub>
           <mfrac>
            <mi>α</mi>
            <mi>T</mi>
           </mfrac>
           <mn>0</mn>
          </msub>
          <mi>y</mi>
         </mrow>
        </mrow>
        <mo>)</mo>
       </mrow>
       <mrow>
        <mn>1</mn>
        <mo>/</mo>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <mi>κ</mi>
          <mo>-</mo>
          <mn>1</mn>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
      </msup>
     </mpadded>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>ρ</ci>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>ρ</ci>
      <cn type="integer">0</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <apply>
          <divide></divide>
          <ci>α</ci>
          <ci>T</ci>
         </apply>
         <cn type="integer">0</cn>
        </apply>
        <ci>y</ci>
       </apply>
      </apply>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <apply>
        <minus></minus>
        <ci>κ</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \rho=\rho_{0}\left(1-\frac{\alpha}{T}_{0}y\right)^{1/(\kappa-1)}\,,
  </annotation>
 </semantics>
</math>

</p>

<p>where 

<math display="inline" id="Air_mass_(astronomy):62">
 <semantics>
  <mi>κ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>κ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \kappa
  </annotation>
 </semantics>
</math>

 is the polytropic exponent (or polytropic index). The air mass integral for the polytropic model does not lend itself to a <a href="closed-form_expression" title="wikilink">closed-form solution</a> except at the zenith, so the integration usually is performed numerically.</p>
<h4 id="compound-atmosphere">Compound atmosphere</h4>

<p><a href="Earth's_atmosphere" title="wikilink">Earth’s atmosphere</a> consists of multiple layers with different temperature and density characteristics; common <a href="atmospheric_models" title="wikilink">atmospheric models</a> include the <a href="International_Standard_Atmosphere" title="wikilink">International Standard Atmosphere</a> and the <a href="US_Standard_Atmosphere" title="wikilink">US Standard Atmosphere</a>. A good approximation for many purposes is a polytropic <a class="uri" href="troposphere" title="wikilink">troposphere</a> of 11 km height with a lapse rate of 6.5 K/km and an isothermal <a class="uri" href="stratosphere" title="wikilink">stratosphere</a> of infinite height (<a href="#CITEREFGarfinkel1967" title="wikilink">Garfinkel 1967</a>), which corresponds very closely to the first two layers of the International Standard Atmosphere. More layers can be used if greater accuracy is required.<a class="footnoteRef" href="#fn5" id="fnref5"><sup>5</sup></a></p>
<h4 id="refracting-radially-symmetrical-atmosphere">Refracting radially symmetrical atmosphere</h4>

<p>When atmospheric refraction is considered, the absolute air mass integral becomes<a class="footnoteRef" href="#fn6" id="fnref6"><sup>6</sup></a></p>

<p>

<math display="block" id="Air_mass_(astronomy):63">
 <semantics>
  <mrow>
   <mrow>
    <mi>σ</mi>
    <mo>=</mo>
    <mrow>
     <msubsup>
      <mo largeop="true" symmetric="true">∫</mo>
      <msub>
       <mi>r</mi>
       <mi>obs</mi>
      </msub>
      <msub>
       <mi>r</mi>
       <mi>atm</mi>
      </msub>
     </msubsup>
     <mpadded width="+1.7pt">
      <mfrac>
       <mrow>
        <mpadded width="+1.7pt">
         <mi>ρ</mi>
        </mpadded>
        <mi mathvariant="normal">d</mi>
        <mi>r</mi>
       </mrow>
       <msqrt>
        <mrow>
         <mn>1</mn>
         <mo>-</mo>
         <mrow>
          <msup>
           <mrow>
            <mo>(</mo>
            <mrow>
             <mfrac>
              <msub>
               <mi>n</mi>
               <mi>obs</mi>
              </msub>
              <mi>n</mi>
             </mfrac>
             <mfrac>
              <msub>
               <mi>r</mi>
               <mi>obs</mi>
              </msub>
              <mi>r</mi>
             </mfrac>
            </mrow>
            <mo>)</mo>
           </mrow>
           <mn>2</mn>
          </msup>
          <mrow>
           <msup>
            <mi>sin</mi>
            <mn>2</mn>
           </msup>
           <mi>z</mi>
          </mrow>
         </mrow>
        </mrow>
       </msqrt>
      </mfrac>
     </mpadded>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>σ</ci>
    <apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <int></int>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>r</ci>
        <ci>obs</ci>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>r</ci>
       <ci>atm</ci>
      </apply>
     </apply>
     <apply>
      <divide></divide>
      <apply>
       <times></times>
       <ci>ρ</ci>
       <ci>normal-d</ci>
       <ci>r</ci>
      </apply>
      <apply>
       <root></root>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
        <apply>
         <times></times>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <apply>
           <times></times>
           <apply>
            <divide></divide>
            <apply>
             <csymbol cd="ambiguous">subscript</csymbol>
             <ci>n</ci>
             <ci>obs</ci>
            </apply>
            <ci>n</ci>
           </apply>
           <apply>
            <divide></divide>
            <apply>
             <csymbol cd="ambiguous">subscript</csymbol>
             <ci>r</ci>
             <ci>obs</ci>
            </apply>
            <ci>r</ci>
           </apply>
          </apply>
          <cn type="integer">2</cn>
         </apply>
         <apply>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <sin></sin>
           <cn type="integer">2</cn>
          </apply>
          <ci>z</ci>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \sigma=\int_{r_{\mathrm{obs}}}^{r_{\mathrm{atm}}}\frac{\rho\,\mathrm{d}r}{%
\sqrt{1-\left(\frac{n_{\mathrm{obs}}}{n}\frac{r_{\mathrm{obs}}}{r}\right)^{2}%
\sin^{2}z}}\,,
  </annotation>
 </semantics>
</math>

</p>

<p>where 

<math display="inline" id="Air_mass_(astronomy):64">
 <semantics>
  <msub>
   <mi>n</mi>
   <mi>obs</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>n</ci>
    <ci>obs</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n_{\mathrm{obs}}
  </annotation>
 </semantics>
</math>

 is the index of refraction of air at the observer’s elevation 

<math display="inline" id="Air_mass_(astronomy):65">
 <semantics>
  <msub>
   <mi>y</mi>
   <mi>obs</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>y</ci>
    <ci>obs</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   y_{\mathrm{obs}}
  </annotation>
 </semantics>
</math>

 above sea level, 

<math display="inline" id="Air_mass_(astronomy):66">
 <semantics>
  <mi>n</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>n</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n
  </annotation>
 </semantics>
</math>

 is the index of refraction at elevation 

<math display="inline" id="Air_mass_(astronomy):67">
 <semantics>
  <mi>y</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>y</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   y
  </annotation>
 </semantics>
</math>

 above sea level, 

<math display="inline" id="Air_mass_(astronomy):68">
 <semantics>
  <mrow>
   <msub>
    <mi>r</mi>
    <mi>obs</mi>
   </msub>
   <mo>=</mo>
   <mrow>
    <msub>
     <mi>R</mi>
     <mi mathvariant="normal">E</mi>
    </msub>
    <mo>+</mo>
    <msub>
     <mi>y</mi>
     <mi>obs</mi>
    </msub>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>r</ci>
     <ci>obs</ci>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>R</ci>
      <ci>normal-E</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <ci>obs</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   r_{\mathrm{obs}}=R_{\mathrm{E}}+y_{\mathrm{obs}}
  </annotation>
 </semantics>
</math>

, 

<math display="inline" id="Air_mass_(astronomy):69">
 <semantics>
  <mrow>
   <mi>r</mi>
   <mo>=</mo>
   <mrow>
    <msub>
     <mi>R</mi>
     <mi mathvariant="normal">E</mi>
    </msub>
    <mo>+</mo>
    <mi>y</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>r</ci>
    <apply>
     <plus></plus>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>R</ci>
      <ci>normal-E</ci>
     </apply>
     <ci>y</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   r=R_{\mathrm{E}}+y
  </annotation>
 </semantics>
</math>

 is the distance from the center of the Earth to a point at elevation 

<math display="inline" id="Air_mass_(astronomy):70">
 <semantics>
  <mi>y</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>y</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   y
  </annotation>
 </semantics>
</math>

, and 

<math display="inline" id="Air_mass_(astronomy):71">
 <semantics>
  <mrow>
   <msub>
    <mi>r</mi>
    <mi>atm</mi>
   </msub>
   <mo>=</mo>
   <mrow>
    <msub>
     <mi>R</mi>
     <mi mathvariant="normal">E</mi>
    </msub>
    <mo>+</mo>
    <msub>
     <mi>y</mi>
     <mi>atm</mi>
    </msub>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>r</ci>
     <ci>atm</ci>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>R</ci>
      <ci>normal-E</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <ci>atm</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   r_{\mathrm{atm}}=R_{\mathrm{E}}+y_{\mathrm{atm}}
  </annotation>
 </semantics>
</math>

 is distance to the upper limit of the atmosphere at elevation 

<math display="inline" id="Air_mass_(astronomy):72">
 <semantics>
  <msub>
   <mi>y</mi>
   <mi>atm</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>y</ci>
    <ci>atm</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   y_{\mathrm{atm}}
  </annotation>
 </semantics>
</math>

. The index of refraction in terms of density is usually given to sufficient accuracy (<a href="#CITEREFGarfinkel1967" title="wikilink">Garfinkel 1967</a>) by the <a href="Gladstone–Dale_relation" title="wikilink">Gladstone–Dale relation</a></p>

<p>

<math display="block" id="Air_mass_(astronomy):73">
 <semantics>
  <mrow>
   <mrow>
    <mfrac>
     <mrow>
      <mi>n</mi>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
     <mrow>
      <msub>
       <mi>n</mi>
       <mi>obs</mi>
      </msub>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </mfrac>
    <mo>=</mo>
    <mpadded width="+1.7pt">
     <mfrac>
      <mi>ρ</mi>
      <msub>
       <mi>ρ</mi>
       <mi>obs</mi>
      </msub>
     </mfrac>
    </mpadded>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <divide></divide>
     <apply>
      <minus></minus>
      <ci>n</ci>
      <cn type="integer">1</cn>
     </apply>
     <apply>
      <minus></minus>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>n</ci>
       <ci>obs</ci>
      </apply>
      <cn type="integer">1</cn>
     </apply>
    </apply>
    <apply>
     <divide></divide>
     <ci>ρ</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>ρ</ci>
      <ci>obs</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \frac{n-1}{n_{\mathrm{obs}}-1}=\frac{\rho}{\rho_{\mathrm{obs}}}\,.
  </annotation>
 </semantics>
</math>

</p>

<p>Rearrangement and substitution into the absolute air mass integral gives</p>

<p>

<math display="block" id="Air_mass_(astronomy):74">
 <semantics>
  <mrow>
   <mrow>
    <mi>σ</mi>
    <mo>=</mo>
    <mrow>
     <msubsup>
      <mo largeop="true" symmetric="true">∫</mo>
      <msub>
       <mi>r</mi>
       <mi>obs</mi>
      </msub>
      <msub>
       <mi>r</mi>
       <mi>atm</mi>
      </msub>
     </msubsup>
     <mpadded width="+1.7pt">
      <mfrac>
       <mrow>
        <mpadded width="+1.7pt">
         <mi>ρ</mi>
        </mpadded>
        <mi mathvariant="normal">d</mi>
        <mi>r</mi>
       </mrow>
       <msqrt>
        <mrow>
         <mn>1</mn>
         <mo>-</mo>
         <mrow>
          <msup>
           <mrow>
            <mo>(</mo>
            <mfrac>
             <msub>
              <mi>n</mi>
              <mi>obs</mi>
             </msub>
             <mrow>
              <mn>1</mn>
              <mo>+</mo>
              <mrow>
               <mrow>
                <mrow>
                 <mo stretchy="false">(</mo>
                 <mrow>
                  <msub>
                   <mi>n</mi>
                   <mi>obs</mi>
                  </msub>
                  <mo>-</mo>
                  <mn>1</mn>
                 </mrow>
                 <mo stretchy="false">)</mo>
                </mrow>
                <mi>ρ</mi>
               </mrow>
               <mo>/</mo>
               <msub>
                <mi>ρ</mi>
                <mi>obs</mi>
               </msub>
              </mrow>
             </mrow>
            </mfrac>
            <mo>)</mo>
           </mrow>
           <mn>2</mn>
          </msup>
          <msup>
           <mrow>
            <mo>(</mo>
            <mfrac>
             <msub>
              <mi>r</mi>
              <mi>obs</mi>
             </msub>
             <mi>r</mi>
            </mfrac>
            <mo>)</mo>
           </mrow>
           <mn>2</mn>
          </msup>
          <mrow>
           <msup>
            <mi>sin</mi>
            <mn>2</mn>
           </msup>
           <mi>z</mi>
          </mrow>
         </mrow>
        </mrow>
       </msqrt>
      </mfrac>
     </mpadded>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>σ</ci>
    <apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <int></int>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>r</ci>
        <ci>obs</ci>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>r</ci>
       <ci>atm</ci>
      </apply>
     </apply>
     <apply>
      <divide></divide>
      <apply>
       <times></times>
       <ci>ρ</ci>
       <ci>normal-d</ci>
       <ci>r</ci>
      </apply>
      <apply>
       <root></root>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
        <apply>
         <times></times>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <apply>
           <divide></divide>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <ci>n</ci>
            <ci>obs</ci>
           </apply>
           <apply>
            <plus></plus>
            <cn type="integer">1</cn>
            <apply>
             <divide></divide>
             <apply>
              <times></times>
              <apply>
               <minus></minus>
               <apply>
                <csymbol cd="ambiguous">subscript</csymbol>
                <ci>n</ci>
                <ci>obs</ci>
               </apply>
               <cn type="integer">1</cn>
              </apply>
              <ci>ρ</ci>
             </apply>
             <apply>
              <csymbol cd="ambiguous">subscript</csymbol>
              <ci>ρ</ci>
              <ci>obs</ci>
             </apply>
            </apply>
           </apply>
          </apply>
          <cn type="integer">2</cn>
         </apply>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <apply>
           <divide></divide>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <ci>r</ci>
            <ci>obs</ci>
           </apply>
           <ci>r</ci>
          </apply>
          <cn type="integer">2</cn>
         </apply>
         <apply>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <sin></sin>
           <cn type="integer">2</cn>
          </apply>
          <ci>z</ci>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \sigma=\int_{r_{\mathrm{obs}}}^{r_{\mathrm{atm}}}\frac{\rho\,\mathrm{d}r}{%
\sqrt{1-\left(\frac{n_{\mathrm{obs}}}{1+(n_{\mathrm{obs}}-1)\rho/\rho_{\mathrm%
{obs}}}\right)^{2}\left(\frac{r_{\mathrm{obs}}}{r}\right)^{2}\sin^{2}z}}\,.
  </annotation>
 </semantics>
</math>

</p>

<p>The quantity 

<math display="inline" id="Air_mass_(astronomy):75">
 <semantics>
  <mrow>
   <msub>
    <mi>n</mi>
    <mi>obs</mi>
   </msub>
   <mo>-</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <minus></minus>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>n</ci>
     <ci>obs</ci>
    </apply>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n_{\mathrm{obs}}-1
  </annotation>
 </semantics>
</math>

 is quite small; expanding the first term in parentheses, rearranging several times, and ignoring terms in 

<math display="inline" id="Air_mass_(astronomy):76">
 <semantics>
  <msup>
   <mrow>
    <mo stretchy="false">(</mo>
    <mrow>
     <msub>
      <mi>n</mi>
      <mi>obs</mi>
     </msub>
     <mo>-</mo>
     <mn>1</mn>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
   <mn>2</mn>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <apply>
     <minus></minus>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>n</ci>
      <ci>obs</ci>
     </apply>
     <cn type="integer">1</cn>
    </apply>
    <cn type="integer">2</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (n_{\mathrm{obs}}-1)^{2}
  </annotation>
 </semantics>
</math>

 after each rearrangement, gives (<a href="#CITEREFKastenYoung1989" title="wikilink">Kasten and Young 1989</a>)</p>

<p>

<math display="block" id="Air_mass_(astronomy):77">
 <semantics>
  <mrow>
   <mrow>
    <mi>σ</mi>
    <mo>=</mo>
    <mrow>
     <msubsup>
      <mo largeop="true" symmetric="true">∫</mo>
      <msub>
       <mi>r</mi>
       <mi>obs</mi>
      </msub>
      <msub>
       <mi>r</mi>
       <mi>atm</mi>
      </msub>
     </msubsup>
     <mpadded width="+1.7pt">
      <mfrac>
       <mrow>
        <mpadded width="+1.7pt">
         <mi>ρ</mi>
        </mpadded>
        <mi mathvariant="normal">d</mi>
        <mi>r</mi>
       </mrow>
       <msqrt>
        <mrow>
         <mn>1</mn>
         <mo>-</mo>
         <mrow>
          <mrow>
           <mo>[</mo>
           <mrow>
            <mn>1</mn>
            <mo>+</mo>
            <mrow>
             <mn>2</mn>
             <mrow>
              <mo stretchy="false">(</mo>
              <mrow>
               <msub>
                <mi>n</mi>
                <mi>obs</mi>
               </msub>
               <mo>-</mo>
               <mn>1</mn>
              </mrow>
              <mo stretchy="false">)</mo>
             </mrow>
             <mrow>
              <mo stretchy="false">(</mo>
              <mrow>
               <mn>1</mn>
               <mo>-</mo>
               <mfrac>
                <mi>ρ</mi>
                <msub>
                 <mi>ρ</mi>
                 <mi>obs</mi>
                </msub>
               </mfrac>
              </mrow>
              <mo stretchy="false">)</mo>
             </mrow>
            </mrow>
           </mrow>
           <mo>]</mo>
          </mrow>
          <msup>
           <mrow>
            <mo>(</mo>
            <mfrac>
             <msub>
              <mi>r</mi>
              <mi>obs</mi>
             </msub>
             <mi>r</mi>
            </mfrac>
            <mo>)</mo>
           </mrow>
           <mn>2</mn>
          </msup>
          <mrow>
           <msup>
            <mi>sin</mi>
            <mn>2</mn>
           </msup>
           <mi>z</mi>
          </mrow>
         </mrow>
        </mrow>
       </msqrt>
      </mfrac>
     </mpadded>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>σ</ci>
    <apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <int></int>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>r</ci>
        <ci>obs</ci>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>r</ci>
       <ci>atm</ci>
      </apply>
     </apply>
     <apply>
      <divide></divide>
      <apply>
       <times></times>
       <ci>ρ</ci>
       <ci>normal-d</ci>
       <ci>r</ci>
      </apply>
      <apply>
       <root></root>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
        <apply>
         <times></times>
         <apply>
          <csymbol cd="latexml">delimited-[]</csymbol>
          <apply>
           <plus></plus>
           <cn type="integer">1</cn>
           <apply>
            <times></times>
            <cn type="integer">2</cn>
            <apply>
             <minus></minus>
             <apply>
              <csymbol cd="ambiguous">subscript</csymbol>
              <ci>n</ci>
              <ci>obs</ci>
             </apply>
             <cn type="integer">1</cn>
            </apply>
            <apply>
             <minus></minus>
             <cn type="integer">1</cn>
             <apply>
              <divide></divide>
              <ci>ρ</ci>
              <apply>
               <csymbol cd="ambiguous">subscript</csymbol>
               <ci>ρ</ci>
               <ci>obs</ci>
              </apply>
             </apply>
            </apply>
           </apply>
          </apply>
         </apply>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <apply>
           <divide></divide>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <ci>r</ci>
            <ci>obs</ci>
           </apply>
           <ci>r</ci>
          </apply>
          <cn type="integer">2</cn>
         </apply>
         <apply>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <sin></sin>
           <cn type="integer">2</cn>
          </apply>
          <ci>z</ci>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \sigma=\int_{r_{\mathrm{obs}}}^{r_{\mathrm{atm}}}\frac{\rho\,\mathrm{d}r}{%
\sqrt{1-\left[1+2(n_{\mathrm{obs}}-1)(1-\frac{\rho}{\rho_{\mathrm{obs}}})%
\right]\left(\frac{r_{\mathrm{obs}}}{r}\right)^{2}\sin^{2}z}}\,.
  </annotation>
 </semantics>
</math>

</p>
<h4 id="homogeneous-spherical-atmosphere-with-elevated-observer">Homogeneous spherical atmosphere with elevated observer</h4>

<p> In the figure at right, an observer at O is at an elevation 

<math display="inline" id="Air_mass_(astronomy):78">
 <semantics>
  <msub>
   <mi>y</mi>
   <mi>obs</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>y</ci>
    <ci>obs</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   y_{\mathrm{obs}}
  </annotation>
 </semantics>
</math>

 above sea level in a uniform radially symmetrical atmosphere of height 

<math display="inline" id="Air_mass_(astronomy):79">
 <semantics>
  <msub>
   <mi>y</mi>
   <mi>atm</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>y</ci>
    <ci>atm</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   y_{\mathrm{atm}}
  </annotation>
 </semantics>
</math>

. The path length of a light ray at zenith angle 

<math display="inline" id="Air_mass_(astronomy):80">
 <semantics>
  <mi>z</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>z</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   z
  </annotation>
 </semantics>
</math>


 is 

<math display="inline" id="Air_mass_(astronomy):81">
 <semantics>
  <mi>s</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>s</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   s
  </annotation>
 </semantics>
</math>

; 

<math display="inline" id="Air_mass_(astronomy):82">
 <semantics>
  <msub>
   <mi>R</mi>
   <mi mathvariant="normal">E</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>R</ci>
    <ci>normal-E</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   R_{\mathrm{E}}
  </annotation>
 </semantics>
</math>

 is the radius of the Earth. Applying the <a href="law_of_cosines" title="wikilink">law of cosines</a> to triangle OAC,</p>

<p>

<math display="inline" id="Air_mass_(astronomy):83">
 <semantics>
  <msup>
   <mrow>
    <mo>(</mo>
    <mrow>
     <msub>
      <mi>R</mi>
      <mi>E</mi>
     </msub>
     <mo>+</mo>
     <msub>
      <mi>y</mi>
      <mrow>
       <mi>a</mi>
       <mi>t</mi>
       <mi>m</mi>
      </mrow>
     </msub>
    </mrow>
    <mo>)</mo>
   </mrow>
   <mn>2</mn>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <apply>
     <plus></plus>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>R</ci>
      <ci>E</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <apply>
       <times></times>
       <ci>a</ci>
       <ci>t</ci>
       <ci>m</ci>
      </apply>
     </apply>
    </apply>
    <cn type="integer">2</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle\left(R_{E}+y_{atm}\right)^{2}
  </annotation>
 </semantics>
</math>


</p>

<p>expanding the left- and right-hand sides, eliminating the common terms, and rearranging gives</p>

<p>

<math display="block" id="Air_mass_(astronomy):84">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mrow>
      <msup>
       <mi>s</mi>
       <mn>2</mn>
      </msup>
      <mo>+</mo>
      <mrow>
       <mn>2</mn>
       <mrow>
        <mo>(</mo>
        <mrow>
         <msub>
          <mi>R</mi>
          <mtext>E</mtext>
         </msub>
         <mo>+</mo>
         <msub>
          <mi>y</mi>
          <mtext>obs</mtext>
         </msub>
        </mrow>
        <mo>)</mo>
       </mrow>
       <mi>s</mi>
       <mrow>
        <mi>cos</mi>
        <mi>z</mi>
       </mrow>
      </mrow>
     </mrow>
     <mo>-</mo>
     <mrow>
      <mn>2</mn>
      <msub>
       <mi>R</mi>
       <mtext>E</mtext>
      </msub>
      <msub>
       <mi>y</mi>
       <mtext>atm</mtext>
      </msub>
     </mrow>
     <mo>-</mo>
     <msubsup>
      <mi>y</mi>
      <mtext>atm</mtext>
      <mn>2</mn>
     </msubsup>
    </mrow>
    <mo>+</mo>
    <mrow>
     <mn>2</mn>
     <msub>
      <mi>R</mi>
      <mtext>E</mtext>
     </msub>
     <msub>
      <mi>y</mi>
      <mtext>obs</mtext>
     </msub>
    </mrow>
    <mo>+</mo>
    <msubsup>
     <mi>y</mi>
     <mtext>obs</mtext>
     <mn>2</mn>
    </msubsup>
   </mrow>
   <mo>=</mo>
   <mn>0 .</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <plus></plus>
     <apply>
      <minus></minus>
      <apply>
       <plus></plus>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>s</ci>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <times></times>
        <cn type="integer">2</cn>
        <apply>
         <plus></plus>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>R</ci>
          <mtext>E</mtext>
         </apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>y</ci>
          <mtext>obs</mtext>
         </apply>
        </apply>
        <ci>s</ci>
        <apply>
         <cos></cos>
         <ci>z</ci>
        </apply>
       </apply>
      </apply>
      <apply>
       <times></times>
       <cn type="integer">2</cn>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>R</ci>
        <mtext>E</mtext>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>y</ci>
        <mtext>atm</mtext>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>y</ci>
        <mtext>atm</mtext>
       </apply>
       <cn type="integer">2</cn>
      </apply>
     </apply>
     <apply>
      <times></times>
      <cn type="integer">2</cn>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>R</ci>
       <mtext>E</mtext>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>y</ci>
       <mtext>obs</mtext>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>y</ci>
       <mtext>obs</mtext>
      </apply>
      <cn type="integer">2</cn>
     </apply>
    </apply>
    <cn type="float">0 .</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   {{s}^{2}}+2\left({{R}_{\text{E}}}+{{y}_{\text{obs}}}\right)s\cos z-2{{R}_{%
\text{E}}}{{y}_{\text{atm}}}-y_{\text{atm}}^{2}+2{{R}_{\text{E}}}{{y}_{\text{%
obs}}}+y_{\text{obs}}^{2}=0\,.
  </annotation>
 </semantics>
</math>

</p>

<p>Solving the quadratic for the path length <em>s</em>, factoring, and rearranging,</p>

<p>

<math display="block" id="Air_mass_(astronomy):85">
 <semantics>
  <mrow>
   <mrow>
    <mi>s</mi>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mo>±</mo>
      <msqrt>
       <mrow>
        <mrow>
         <mrow>
          <msup>
           <mrow>
            <mo>(</mo>
            <mrow>
             <msub>
              <mi>R</mi>
              <mtext>E</mtext>
             </msub>
             <mo>+</mo>
             <msub>
              <mi>y</mi>
              <mtext>obs</mtext>
             </msub>
            </mrow>
            <mo>)</mo>
           </mrow>
           <mn>2</mn>
          </msup>
          <mrow>
           <msup>
            <mi>cos</mi>
            <mn>2</mn>
           </msup>
           <mi>z</mi>
          </mrow>
         </mrow>
         <mo>+</mo>
         <mrow>
          <mn>2</mn>
          <msub>
           <mi>R</mi>
           <mtext>E</mtext>
          </msub>
          <mrow>
           <mo>(</mo>
           <mrow>
            <msub>
             <mi>y</mi>
             <mtext>atm</mtext>
            </msub>
            <mo>-</mo>
            <msub>
             <mi>y</mi>
             <mtext>obs</mtext>
            </msub>
           </mrow>
           <mo>)</mo>
          </mrow>
         </mrow>
         <mo>+</mo>
         <msubsup>
          <mi>y</mi>
          <mtext>atm</mtext>
          <mn>2</mn>
         </msubsup>
        </mrow>
        <mo>-</mo>
        <msubsup>
         <mi>y</mi>
         <mtext>obs</mtext>
         <mn>2</mn>
        </msubsup>
       </mrow>
      </msqrt>
     </mrow>
     <mo>-</mo>
     <mrow>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <msub>
         <mi>R</mi>
         <mtext>E</mtext>
        </msub>
        <mo>+</mo>
        <msub>
         <mi>y</mi>
         <mtext>obs</mtext>
        </msub>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
      <mrow>
       <mi>cos</mi>
       <mpadded width="+1.7pt">
        <mi>z</mi>
       </mpadded>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>s</ci>
    <apply>
     <minus></minus>
     <apply>
      <csymbol cd="latexml">plus-or-minus</csymbol>
      <apply>
       <root></root>
       <apply>
        <minus></minus>
        <apply>
         <plus></plus>
         <apply>
          <times></times>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <apply>
            <plus></plus>
            <apply>
             <csymbol cd="ambiguous">subscript</csymbol>
             <ci>R</ci>
             <mtext>E</mtext>
            </apply>
            <apply>
             <csymbol cd="ambiguous">subscript</csymbol>
             <ci>y</ci>
             <mtext>obs</mtext>
            </apply>
           </apply>
           <cn type="integer">2</cn>
          </apply>
          <apply>
           <apply>
            <csymbol cd="ambiguous">superscript</csymbol>
            <cos></cos>
            <cn type="integer">2</cn>
           </apply>
           <ci>z</ci>
          </apply>
         </apply>
         <apply>
          <times></times>
          <cn type="integer">2</cn>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>R</ci>
           <mtext>E</mtext>
          </apply>
          <apply>
           <minus></minus>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <ci>y</ci>
            <mtext>atm</mtext>
           </apply>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <ci>y</ci>
            <mtext>obs</mtext>
           </apply>
          </apply>
         </apply>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>y</ci>
           <mtext>atm</mtext>
          </apply>
          <cn type="integer">2</cn>
         </apply>
        </apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>y</ci>
          <mtext>obs</mtext>
         </apply>
         <cn type="integer">2</cn>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <plus></plus>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>R</ci>
        <mtext>E</mtext>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>y</ci>
        <mtext>obs</mtext>
       </apply>
      </apply>
      <apply>
       <cos></cos>
       <ci>z</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   s=\pm\sqrt{{{\left({{R}_{\text{E}}}+{{y}_{\text{obs}}}\right)}^{2}}{{\cos}^{2}%
}z+2{{R}_{\text{E}}}\left({{y}_{\text{atm }}}-{{y}_{\text{obs}}}\right)+y_{%
\text{atm}}^{2}-y_{\text{obs}}^{2}}-({{R}_{\text{E}}}+{{y}_{\text{obs}}})\cos z\,.
  </annotation>
 </semantics>
</math>

</p>

<p>The negative sign of the radical gives a negative result, which is not physically meaningful. Using the positive sign, dividing by 

<math display="inline" id="Air_mass_(astronomy):86">
 <semantics>
  <msub>
   <mi>y</mi>
   <mi>atm</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>y</ci>
    <ci>atm</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   y_{\mathrm{atm}}
  </annotation>
 </semantics>
</math>

, and cancelling common terms and rearranging gives the relative air mass:</p>

<p>

<math display="block" id="Air_mass_(astronomy):87">
 <semantics>
  <mrow>
   <mrow>
    <mi>X</mi>
    <mo>=</mo>
    <mrow>
     <msqrt>
      <mrow>
       <mrow>
        <mrow>
         <mrow>
          <msup>
           <mrow>
            <mo>(</mo>
            <mfrac>
             <mrow>
              <msub>
               <mi>R</mi>
               <mtext>E</mtext>
              </msub>
              <mo>+</mo>
              <msub>
               <mi>y</mi>
               <mtext>obs</mtext>
              </msub>
             </mrow>
             <msub>
              <mi>y</mi>
              <mtext>atm</mtext>
             </msub>
            </mfrac>
            <mo>)</mo>
           </mrow>
           <mn>2</mn>
          </msup>
          <mrow>
           <msup>
            <mi>cos</mi>
            <mn>2</mn>
           </msup>
           <mi>z</mi>
          </mrow>
         </mrow>
         <mo>+</mo>
         <mrow>
          <mfrac>
           <mrow>
            <mn>2</mn>
            <msub>
             <mi>R</mi>
             <mtext>E</mtext>
            </msub>
           </mrow>
           <msubsup>
            <mi>y</mi>
            <mtext>atm</mtext>
            <mn>2</mn>
           </msubsup>
          </mfrac>
          <mrow>
           <mo>(</mo>
           <mrow>
            <msub>
             <mi>y</mi>
             <mtext>atm</mtext>
            </msub>
            <mo>-</mo>
            <msub>
             <mi>y</mi>
             <mtext>obs</mtext>
            </msub>
           </mrow>
           <mo>)</mo>
          </mrow>
         </mrow>
        </mrow>
        <mo>-</mo>
        <msup>
         <mrow>
          <mo>(</mo>
          <mfrac>
           <msub>
            <mi>y</mi>
            <mtext>obs</mtext>
           </msub>
           <msub>
            <mi>y</mi>
            <mtext>atm</mtext>
           </msub>
          </mfrac>
          <mo>)</mo>
         </mrow>
         <mn>2</mn>
        </msup>
       </mrow>
       <mo>+</mo>
       <mn>1</mn>
      </mrow>
     </msqrt>
     <mo>-</mo>
     <mrow>
      <mfrac>
       <mrow>
        <msub>
         <mi>R</mi>
         <mtext>E</mtext>
        </msub>
        <mo>+</mo>
        <msub>
         <mi>y</mi>
         <mtext>obs</mtext>
        </msub>
       </mrow>
       <msub>
        <mi>y</mi>
        <mtext>atm</mtext>
       </msub>
      </mfrac>
      <mrow>
       <mi>cos</mi>
       <mpadded width="+1.7pt">
        <mi>z</mi>
       </mpadded>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>X</ci>
    <apply>
     <minus></minus>
     <apply>
      <root></root>
      <apply>
       <plus></plus>
       <apply>
        <minus></minus>
        <apply>
         <plus></plus>
         <apply>
          <times></times>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <apply>
            <divide></divide>
            <apply>
             <plus></plus>
             <apply>
              <csymbol cd="ambiguous">subscript</csymbol>
              <ci>R</ci>
              <mtext>E</mtext>
             </apply>
             <apply>
              <csymbol cd="ambiguous">subscript</csymbol>
              <ci>y</ci>
              <mtext>obs</mtext>
             </apply>
            </apply>
            <apply>
             <csymbol cd="ambiguous">subscript</csymbol>
             <ci>y</ci>
             <mtext>atm</mtext>
            </apply>
           </apply>
           <cn type="integer">2</cn>
          </apply>
          <apply>
           <apply>
            <csymbol cd="ambiguous">superscript</csymbol>
            <cos></cos>
            <cn type="integer">2</cn>
           </apply>
           <ci>z</ci>
          </apply>
         </apply>
         <apply>
          <times></times>
          <apply>
           <divide></divide>
           <apply>
            <times></times>
            <cn type="integer">2</cn>
            <apply>
             <csymbol cd="ambiguous">subscript</csymbol>
             <ci>R</ci>
             <mtext>E</mtext>
            </apply>
           </apply>
           <apply>
            <csymbol cd="ambiguous">superscript</csymbol>
            <apply>
             <csymbol cd="ambiguous">subscript</csymbol>
             <ci>y</ci>
             <mtext>atm</mtext>
            </apply>
            <cn type="integer">2</cn>
           </apply>
          </apply>
          <apply>
           <minus></minus>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <ci>y</ci>
            <mtext>atm</mtext>
           </apply>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <ci>y</ci>
            <mtext>obs</mtext>
           </apply>
          </apply>
         </apply>
        </apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <divide></divide>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>y</ci>
           <mtext>obs</mtext>
          </apply>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>y</ci>
           <mtext>atm</mtext>
          </apply>
         </apply>
         <cn type="integer">2</cn>
        </apply>
       </apply>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <apply>
        <plus></plus>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>R</ci>
         <mtext>E</mtext>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>y</ci>
         <mtext>obs</mtext>
        </apply>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>y</ci>
        <mtext>atm</mtext>
       </apply>
      </apply>
      <apply>
       <cos></cos>
       <ci>z</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   X=\sqrt{{{\left(\frac{{{R}_{\text{E}}}+{{y}_{\text{obs}}}}{{{y}_{\text{atm}}}}%
\right)}^{2}}{{\cos}^{2}}z+\frac{2{{R}_{\text{E}}}}{y_{\text{atm}}^{2}}\left({%
{y}_{\text{atm}}}-{{y}_{\text{obs}}}\right)-{{\left(\frac{{{y}_{\text{obs}}}}{%
{{y}_{\text{atm}}}}\right)}^{2}}+1}-\frac{{{R}_{\text{E}}}+{{y}_{\text{obs}}}}%
{{{y}_{\text{atm}}}}\cos z\,.
  </annotation>
 </semantics>
</math>

</p>

<p>With the substitutions 

<math display="inline" id="Air_mass_(astronomy):88">
 <semantics>
  <mrow>
   <mover accent="true">
    <mi>r</mi>
    <mo stretchy="false">^</mo>
   </mover>
   <mo>=</mo>
   <mrow>
    <msub>
     <mi>R</mi>
     <mi mathvariant="normal">E</mi>
    </msub>
    <mo>/</mo>
    <msub>
     <mi>y</mi>
     <mi>atm</mi>
    </msub>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <ci>normal-^</ci>
     <ci>r</ci>
    </apply>
    <apply>
     <divide></divide>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>R</ci>
      <ci>normal-E</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <ci>atm</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \hat{r}=R_{\mathrm{E}}/y_{\mathrm{atm}}
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Air_mass_(astronomy):89">
 <semantics>
  <mrow>
   <mover accent="true">
    <mi>y</mi>
    <mo stretchy="false">^</mo>
   </mover>
   <mo>=</mo>
   <mrow>
    <msub>
     <mi>y</mi>
     <mi>obs</mi>
    </msub>
    <mo>/</mo>
    <msub>
     <mi>y</mi>
     <mi>atm</mi>
    </msub>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <ci>normal-^</ci>
     <ci>y</ci>
    </apply>
    <apply>
     <divide></divide>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <ci>obs</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <ci>atm</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \hat{y}=y_{\mathrm{obs}}/y_{\mathrm{atm}}
  </annotation>
 </semantics>
</math>

, this can be given as</p>

<p>

<math display="block" id="Air_mass_(astronomy):90">
 <semantics>
  <mrow>
   <mrow>
    <mi>X</mi>
    <mo>=</mo>
    <mrow>
     <mpadded width="+2.8pt">
      <msqrt>
       <mrow>
        <mrow>
         <mrow>
          <mrow>
           <msup>
            <mrow>
             <mo stretchy="false">(</mo>
             <mrow>
              <mover accent="true">
               <mi>r</mi>
               <mo stretchy="false">^</mo>
              </mover>
              <mo>+</mo>
              <mover accent="true">
               <mi>y</mi>
               <mo stretchy="false">^</mo>
              </mover>
             </mrow>
             <mo stretchy="false">)</mo>
            </mrow>
            <mn>2</mn>
           </msup>
           <mrow>
            <msup>
             <mi>cos</mi>
             <mn>2</mn>
            </msup>
            <mi>z</mi>
           </mrow>
          </mrow>
          <mo>+</mo>
          <mrow>
           <mn>2</mn>
           <mover accent="true">
            <mi>r</mi>
            <mo stretchy="false">^</mo>
           </mover>
           <mrow>
            <mo stretchy="false">(</mo>
            <mrow>
             <mn>1</mn>
             <mo>-</mo>
             <mover accent="true">
              <mi>y</mi>
              <mo stretchy="false">^</mo>
             </mover>
            </mrow>
            <mo stretchy="false">)</mo>
           </mrow>
          </mrow>
         </mrow>
         <mo>-</mo>
         <msup>
          <mover accent="true">
           <mi>y</mi>
           <mo stretchy="false">^</mo>
          </mover>
          <mn>2</mn>
         </msup>
        </mrow>
        <mo>+</mo>
        <mn>1</mn>
       </mrow>
      </msqrt>
     </mpadded>
     <mo rspace="5.3pt">-</mo>
     <mrow>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mover accent="true">
         <mi>r</mi>
         <mo stretchy="false">^</mo>
        </mover>
        <mo>+</mo>
        <mover accent="true">
         <mi>y</mi>
         <mo stretchy="false">^</mo>
        </mover>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
      <mrow>
       <mi>cos</mi>
       <mpadded width="+1.7pt">
        <mi>z</mi>
       </mpadded>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>X</ci>
    <apply>
     <minus></minus>
     <apply>
      <root></root>
      <apply>
       <plus></plus>
       <apply>
        <minus></minus>
        <apply>
         <plus></plus>
         <apply>
          <times></times>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <apply>
            <plus></plus>
            <apply>
             <ci>normal-^</ci>
             <ci>r</ci>
            </apply>
            <apply>
             <ci>normal-^</ci>
             <ci>y</ci>
            </apply>
           </apply>
           <cn type="integer">2</cn>
          </apply>
          <apply>
           <apply>
            <csymbol cd="ambiguous">superscript</csymbol>
            <cos></cos>
            <cn type="integer">2</cn>
           </apply>
           <ci>z</ci>
          </apply>
         </apply>
         <apply>
          <times></times>
          <cn type="integer">2</cn>
          <apply>
           <ci>normal-^</ci>
           <ci>r</ci>
          </apply>
          <apply>
           <minus></minus>
           <cn type="integer">1</cn>
           <apply>
            <ci>normal-^</ci>
            <ci>y</ci>
           </apply>
          </apply>
         </apply>
        </apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <ci>normal-^</ci>
          <ci>y</ci>
         </apply>
         <cn type="integer">2</cn>
        </apply>
       </apply>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <plus></plus>
       <apply>
        <ci>normal-^</ci>
        <ci>r</ci>
       </apply>
       <apply>
        <ci>normal-^</ci>
        <ci>y</ci>
       </apply>
      </apply>
      <apply>
       <cos></cos>
       <ci>z</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   X=\sqrt{{{(\hat{r}+\hat{y})}^{2}}{{\cos}^{2}}z+2\hat{r}(1-\hat{y})-\hat{y}^{2}%
+1}\;-\;(\hat{r}+\hat{y})\cos z\,.
  </annotation>
 </semantics>
</math>

</p>

<p>When the observer’s elevation is zero, the air mass equation simplifies to</p>

<p>

<math display="block" id="Air_mass_(astronomy):91">
 <semantics>
  <mrow>
   <mrow>
    <mi>X</mi>
    <mo>=</mo>
    <mrow>
     <msqrt>
      <mrow>
       <mrow>
        <msup>
         <mrow>
          <mo>(</mo>
          <mfrac>
           <msub>
            <mi>R</mi>
            <mtext>E</mtext>
           </msub>
           <msub>
            <mi>y</mi>
            <mtext>atm</mtext>
           </msub>
          </mfrac>
          <mo>)</mo>
         </mrow>
         <mn>2</mn>
        </msup>
        <mrow>
         <msup>
          <mi>cos</mi>
          <mn>2</mn>
         </msup>
         <mi>z</mi>
        </mrow>
       </mrow>
       <mo>+</mo>
       <mfrac>
        <mrow>
         <mn>2</mn>
         <msub>
          <mi>R</mi>
          <mtext>E</mtext>
         </msub>
        </mrow>
        <msub>
         <mi>y</mi>
         <mtext>atm</mtext>
        </msub>
       </mfrac>
       <mo>+</mo>
       <mn>1</mn>
      </mrow>
     </msqrt>
     <mo>-</mo>
     <mrow>
      <mfrac>
       <msub>
        <mi>R</mi>
        <mtext>E</mtext>
       </msub>
       <msub>
        <mi>y</mi>
        <mtext>atm</mtext>
       </msub>
      </mfrac>
      <mrow>
       <mi>cos</mi>
       <mpadded width="+1.7pt">
        <mi>z</mi>
       </mpadded>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>X</ci>
    <apply>
     <minus></minus>
     <apply>
      <root></root>
      <apply>
       <plus></plus>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <divide></divide>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>R</ci>
           <mtext>E</mtext>
          </apply>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>y</ci>
           <mtext>atm</mtext>
          </apply>
         </apply>
         <cn type="integer">2</cn>
        </apply>
        <apply>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <cos></cos>
          <cn type="integer">2</cn>
         </apply>
         <ci>z</ci>
        </apply>
       </apply>
       <apply>
        <divide></divide>
        <apply>
         <times></times>
         <cn type="integer">2</cn>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>R</ci>
          <mtext>E</mtext>
         </apply>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>y</ci>
         <mtext>atm</mtext>
        </apply>
       </apply>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>R</ci>
        <mtext>E</mtext>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>y</ci>
        <mtext>atm</mtext>
       </apply>
      </apply>
      <apply>
       <cos></cos>
       <ci>z</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   X=\sqrt{{{\left(\frac{{{R}_{\text{E}}}}{{{y}_{\text{atm}}}}\right)}^{2}}{{\cos%
}^{2}}z+\frac{2{{R}_{\text{E}}}}{{{y}_{\text{atm}}}}+1}-\frac{{{R}_{\text{E}}}%
}{{{y}_{\text{atm}}}}\cos z\,.
  </annotation>
 </semantics>
</math>

<br/>
<strong>Maximum zenith angle</strong><br/>
 When the observer is at an elevation greater than that of the horizon, the zenith angle can be greater than 90°. The maximum possible zenith angle occurs when the ray is tangent to Earth’s surface; from triangle OCG in the figure at right,</p>

<p>

<math display="block" id="Air_mass_(astronomy):92">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>cos</mi>
     <mi>γ</mi>
    </mrow>
    <mo>=</mo>
    <mpadded width="+1.7pt">
     <mfrac>
      <mrow>
       <mrow>
        <msub>
         <mi>R</mi>
         <mtext>E</mtext>
        </msub>
        <mo>+</mo>
        <msub>
         <mi>y</mi>
         <mtext>obs</mtext>
        </msub>
       </mrow>
       <mo>-</mo>
       <mi>h</mi>
      </mrow>
      <mrow>
       <msub>
        <mi>R</mi>
        <mtext>E</mtext>
       </msub>
       <mo>+</mo>
       <msub>
        <mi>y</mi>
        <mtext>obs</mtext>
       </msub>
      </mrow>
     </mfrac>
    </mpadded>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <cos></cos>
     <ci>γ</ci>
    </apply>
    <apply>
     <divide></divide>
     <apply>
      <minus></minus>
      <apply>
       <plus></plus>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>R</ci>
        <mtext>E</mtext>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>y</ci>
        <mtext>obs</mtext>
       </apply>
      </apply>
      <ci>h</ci>
     </apply>
     <apply>
      <plus></plus>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>R</ci>
       <mtext>E</mtext>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>y</ci>
       <mtext>obs</mtext>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \cos\gamma=\frac{{{R}_{\text{E}}}+{{y}_{\text{obs}}}-h}{{{R}_{\text{E}}}+{{y}_%
{\text{obs}}}}\,,
  </annotation>
 </semantics>
</math>

</p>

<p>where 

<math display="inline" id="Air_mass_(astronomy):93">
 <semantics>
  <mi>h</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>h</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   h
  </annotation>
 </semantics>
</math>

 is the observer’s height above the horizon. The geometrical dip of the horizon 

<math display="inline" id="Air_mass_(astronomy):94">
 <semantics>
  <mi>γ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>γ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \gamma
  </annotation>
 </semantics>
</math>

 is related to 

<math display="inline" id="Air_mass_(astronomy):95">
 <semantics>
  <msub>
   <mi>z</mi>
   <mi>max</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>z</ci>
    <ci>max</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   z_{\mathrm{max}}
  </annotation>
 </semantics>
</math>

 by</p>

<p>

<math display="block" id="Air_mass_(astronomy):96">
 <semantics>
  <mrow>
   <mi>γ</mi>
   <mo>=</mo>
   <msub>
    <mi>z</mi>
    <mtext>max</mtext>
   </msub>
   <mo>-</mo>
   <mn>90</mn>
   <mmultiscripts>
    <mo>,</mo>
    <mprescripts></mprescripts>
    <none></none>
    <mo>∘</mo>
   </mmultiscripts>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">γ</csymbol>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>z</ci>
     <mtext>max</mtext>
    </apply>
    <minus></minus>
    <cn type="integer">90</cn>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>normal-,</ci>
     <compose></compose>
    </apply>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \gamma={{z}_{\text{max}}}-90{}^{\circ}\,,
  </annotation>
 </semantics>
</math>

</p>

<p>so that</p>

<p>

<math display="block" id="Air_mass_(astronomy):97">
 <semantics>
  <mrow>
   <mi>cos</mi>
   <mi>γ</mi>
   <mo>=</mo>
   <mi>cos</mi>
   <mrow>
    <mo>(</mo>
    <msub>
     <mi>z</mi>
     <mtext>max</mtext>
    </msub>
    <mo>-</mo>
    <mn>90</mn>
    <mmultiscripts>
     <mo>)</mo>
     <mprescripts></mprescripts>
     <none></none>
     <mo>∘</mo>
    </mmultiscripts>
   </mrow>
   <mo>=</mo>
   <mi>sin</mi>
   <mpadded width="+1.7pt">
    <msub>
     <mi>z</mi>
     <mtext>max</mtext>
    </msub>
   </mpadded>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <cos></cos>
    <csymbol cd="unknown">γ</csymbol>
    <eq></eq>
    <cos></cos>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>z</ci>
      <mtext>max</mtext>
     </apply>
     <minus></minus>
     <cn type="integer">90</cn>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>normal-)</ci>
      <compose></compose>
     </apply>
    </cerror>
    <eq></eq>
    <sin></sin>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>z</ci>
     <mtext>max</mtext>
    </apply>
    <ci>normal-.</ci>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \cos\gamma=\cos\left({{z}_{\text{max}}}-90{}^{\circ}\right)=\sin{{z}_{\text{%
max}}}\,.
  </annotation>
 </semantics>
</math>

</p>

<p>Then</p>

<p>

<math display="block" id="Air_mass_(astronomy):98">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>sin</mi>
     <msub>
      <mi>z</mi>
      <mtext>max</mtext>
     </msub>
    </mrow>
    <mo>=</mo>
    <mpadded width="+1.7pt">
     <mfrac>
      <mrow>
       <mrow>
        <msub>
         <mi>R</mi>
         <mtext>E</mtext>
        </msub>
        <mo>+</mo>
        <msub>
         <mi>y</mi>
         <mtext>obs</mtext>
        </msub>
       </mrow>
       <mo>-</mo>
       <mi>h</mi>
      </mrow>
      <mrow>
       <msub>
        <mi>R</mi>
        <mtext>E</mtext>
       </msub>
       <mo>+</mo>
       <msub>
        <mi>y</mi>
        <mtext>obs</mtext>
       </msub>
      </mrow>
     </mfrac>
    </mpadded>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <sin></sin>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>z</ci>
      <mtext>max</mtext>
     </apply>
    </apply>
    <apply>
     <divide></divide>
     <apply>
      <minus></minus>
      <apply>
       <plus></plus>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>R</ci>
        <mtext>E</mtext>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>y</ci>
        <mtext>obs</mtext>
       </apply>
      </apply>
      <ci>h</ci>
     </apply>
     <apply>
      <plus></plus>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>R</ci>
       <mtext>E</mtext>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>y</ci>
       <mtext>obs</mtext>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \sin{{z}_{\text{max}}}=\frac{{{R}_{\text{E}}}+{{y}_{\text{obs}}}-h}{{{R}_{%
\text{E}}}+{{y}_{\text{obs}}}}\,.
  </annotation>
 </semantics>
</math>

</p>

<p>For a non-negative height 

<math display="inline" id="Air_mass_(astronomy):99">
 <semantics>
  <mi>h</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>h</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   h
  </annotation>
 </semantics>
</math>

, the angle 

<math display="inline" id="Air_mass_(astronomy):100">
 <semantics>
  <msub>
   <mi>z</mi>
   <mi>max</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>z</ci>
    <ci>max</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   z_{\mathrm{max}}
  </annotation>
 </semantics>
</math>

 is always ≥ 90°; however, the inverse sine functions provided by most calculators and programming languages return values in the range ±90°. The value can be placed in the proper quadrant by</p>

<p>

<math display="block" id="Air_mass_(astronomy):101">
 <semantics>
  <mrow>
   <msub>
    <mi>z</mi>
    <mtext>max</mtext>
   </msub>
   <mo>=</mo>
   <mn>180</mn>
   <mmultiscripts>
    <mo>-</mo>
    <mprescripts></mprescripts>
    <none></none>
    <mo>∘</mo>
   </mmultiscripts>
   <msup>
    <mi>sin</mi>
    <mrow>
     <mo>-</mo>
     <mn>1</mn>
    </mrow>
   </msup>
   <mpadded width="+1.7pt">
    <mfrac>
     <mrow>
      <mrow>
       <msub>
        <mi>R</mi>
        <mtext>E</mtext>
       </msub>
       <mo>+</mo>
       <msub>
        <mi>y</mi>
        <mtext>obs</mtext>
       </msub>
      </mrow>
      <mo>-</mo>
      <mi>h</mi>
     </mrow>
     <mrow>
      <msub>
       <mi>R</mi>
       <mtext>E</mtext>
      </msub>
      <mo>+</mo>
      <msub>
       <mi>y</mi>
       <mtext>obs</mtext>
      </msub>
     </mrow>
    </mfrac>
   </mpadded>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>z</ci>
     <mtext>max</mtext>
    </apply>
    <eq></eq>
    <cn type="integer">180</cn>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <minus></minus>
     <compose></compose>
    </apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <sin></sin>
     <apply>
      <minus></minus>
      <cn type="integer">1</cn>
     </apply>
    </apply>
    <apply>
     <divide></divide>
     <apply>
      <minus></minus>
      <apply>
       <plus></plus>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>R</ci>
        <mtext>E</mtext>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>y</ci>
        <mtext>obs</mtext>
       </apply>
      </apply>
      <ci>h</ci>
     </apply>
     <apply>
      <plus></plus>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>R</ci>
       <mtext>E</mtext>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>y</ci>
       <mtext>obs</mtext>
      </apply>
     </apply>
    </apply>
    <ci>normal-.</ci>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   {{z}_{\text{max}}}=180{}^{\circ}-{{\sin}^{-1}}\frac{{{R}_{\text{E}}}+{{y}_{%
\text{obs}}}-h}{{{R}_{\text{E}}}+{{y}_{\text{obs}}}}\,.
  </annotation>
 </semantics>
</math>

</p>

<p>If the horizon is at sea level, 

<math display="inline" id="Air_mass_(astronomy):102">
 <semantics>
  <mrow>
   <msub>
    <mi>y</mi>
    <mi>obs</mi>
   </msub>
   <mo>=</mo>
   <mi>h</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>y</ci>
     <ci>obs</ci>
    </apply>
    <ci>h</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   y_{\mathrm{obs}}=h
  </annotation>
 </semantics>
</math>

, and this simplifies to</p>

<p>

<math display="block" id="Air_mass_(astronomy):103">
 <semantics>
  <mrow>
   <msub>
    <mi>z</mi>
    <mtext>max</mtext>
   </msub>
   <mo>=</mo>
   <mn>180</mn>
   <mmultiscripts>
    <mo>-</mo>
    <mprescripts></mprescripts>
    <none></none>
    <mo>∘</mo>
   </mmultiscripts>
   <msup>
    <mi>sin</mi>
    <mrow>
     <mo>-</mo>
     <mn>1</mn>
    </mrow>
   </msup>
   <mpadded width="+1.7pt">
    <mfrac>
     <msub>
      <mi>R</mi>
      <mtext>E</mtext>
     </msub>
     <mrow>
      <msub>
       <mi>R</mi>
       <mtext>E</mtext>
      </msub>
      <mo>+</mo>
      <mi>h</mi>
     </mrow>
    </mfrac>
   </mpadded>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>z</ci>
     <mtext>max</mtext>
    </apply>
    <eq></eq>
    <cn type="integer">180</cn>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <minus></minus>
     <compose></compose>
    </apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <sin></sin>
     <apply>
      <minus></minus>
      <cn type="integer">1</cn>
     </apply>
    </apply>
    <apply>
     <divide></divide>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>R</ci>
      <mtext>E</mtext>
     </apply>
     <apply>
      <plus></plus>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>R</ci>
       <mtext>E</mtext>
      </apply>
      <ci>h</ci>
     </apply>
    </apply>
    <ci>normal-.</ci>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   {{z}_{\text{max}}}=180{}^{\circ}-{{\sin}^{-1}}\frac{{{R}_{\text{E}}}}{{{R}_{%
\text{E}}}+h}\,.
  </annotation>
 </semantics>
</math>

</p>
<h3 id="nonuniform-distribution-of-attenuating-species">Nonuniform distribution of attenuating species</h3>

<p>Atmospheric models that derive from hydrostatic considerations assume an atmosphere of constant composition and a single mechanism of extinction, which isn’t quite correct. There are three main sources of attenuation (<a href="#CITEREFHayesLatham1975" title="wikilink">Hayes and Latham 1975</a>): <a href="Rayleigh_scattering" title="wikilink">Rayleigh scattering</a> by air molecules, <a href="Mie_scattering" title="wikilink">Mie scattering</a> by <a href="Particulate" title="wikilink">aerosols</a>, and molecular absorption (primarily by <a class="uri" href="ozone" title="wikilink">ozone</a>). The relative contribution of each source varies with elevation above sea level, and the concentrations of aerosols and ozone cannot be derived simply from hydrostatic considerations.</p>

<p>Rigorously, when the <a href="refractive_index#Dispersion_and_absorption" title="wikilink">extinction coefficient</a> depends on elevation, it must be determined as part of the air mass integral, as described by <a href="#CITEREFThomasonHermanReagan1983" title="wikilink">Thomason, Herman, and Reagan (1983)</a>. A compromise approach often is possible, however. Methods for separately calculating the extinction from each species using <a href="closed-form_expression" title="wikilink">closed-form expressions</a> are described in <a href="#CITEREFSchaefer1993" title="wikilink">Schaefer (1993)</a> and <a href="#CITEREFSchaefer1998" title="wikilink">Schaefer (1998)</a>. The latter reference includes <a href="source_code" title="wikilink">source code</a> for a <a class="uri" href="BASIC" title="wikilink">BASIC</a> program to perform the calculations. Reasonably accurate calculation of extinction can sometimes be done by using one of the simple air mass formulas and separately determining extinction coefficients for each of the attenuating species (<a href="#CITEREFGreen1992" title="wikilink">Green 1992</a>, <a href="#CITEREFPickering2002" title="wikilink">Pickering 2002</a>).</p>
<h2 id="air-mass-and-astronomy">Air mass and astronomy</h2>
<figure><b>(Figure)</b>
<figcaption>Atmospheric transmittance across the <a href="electromagnetic_spectrum" title="wikilink">electromagnetic spectrum</a>.</figcaption>
</figure>

<p>In <a href="optical_astronomy" title="wikilink">optical astronomy</a> the air mass provides an indication of the deterioration of the observed image, not only as regards direct effects of spectral absorption, scattering and reduced brightness, but also an aggregation of visual aberrations, e.g. resulting from atmospheric turbulence, collectively referred to as the quality of the <em><a href="Astronomical_seeing" title="wikilink">seeing</a></em>.<a class="footnoteRef" href="#fn7" id="fnref7"><sup>7</sup></a> On bigger telescopes, such as the <a href="William_Herschel_Telescope" title="wikilink">WHT</a> (<a href="#CITEREFWynneWorsick1988" title="wikilink">Wynne and Warsick 1988</a>) and <a href="Very_Large_Telescope" title="wikilink">VLT</a> (<a href="#CITEREFAvilaRupprechtBeckers1997" title="wikilink">Avila, Rupprecht, and Becker 1997</a>), the atmospheric dispersion can be so severe that it affects the pointing of the telescope to the target. In such cases an atmospheric dispersion compensator is used, which usually consists of two The <a href="Greenwood_frequency" title="wikilink">Greenwood frequency</a> and <a href="Fried_parameter" title="wikilink">Fried parameter</a>, both relevant for <a href="adaptive_optics" title="wikilink">adaptive optics</a> depend on the air mass above them (or more specifically, on the <a href="zenith_angle" title="wikilink">zenith angle</a>).</p>

<p>In <a href="radio_astronomy" title="wikilink">radio astronomy</a> the air mass (which influences the optical path length) is not relevant. The lower layers of the atmosphere, modeled by the air mass, do not significantly impede radio waves, which are of much lower frequency than optical waves. Instead, some radio waves are affected by the <a class="uri" href="ionosphere" title="wikilink">ionosphere</a> in the upper atmosphere. Newer <a href="aperture_synthesis" title="wikilink">aperture synthesis</a> radio telescopes are especially affected by this as they “see” a much larger portion of the sky and thus the ionosphere. In fact, <a class="uri" href="LOFAR" title="wikilink">LOFAR</a> needs to explicitly calibrate for these distorting effects (<a href="#CITEREFVanDerTolVanDerVeen2007" title="wikilink">van der Tol and van der Veen 2007</a>; <a href="#CITEREFDeVosGunstNijboer2009" title="wikilink">de Vos, Gunst, and Nijboer 2009</a>), but on the other hand can also study the ionosphere by instead measuring these distortions (<a href="#CITEREFThide2007" title="wikilink">Thidé 2007</a>).</p>
<h2 id="air-mass-and-solar-energy">Air mass and solar energy</h2>
<figure><b>(Figure)</b>
<figcaption>Solar irradiance spectrum above atmosphere and at surface</figcaption>
</figure>

<p>Atmospheric attenuation of solar radiation is not the same for all wavelengths; consequently, passage through the atmosphere not only reduces intensity but also alters the <a href="Sunlight#Composition_and_power" title="wikilink">spectral irradiance</a>. <a href="Photovoltaic_module" title="wikilink">Photovoltaic modules</a> are commonly rated using spectral irradiance for an air mass of 1.5 (AM1.5); tables of these standard spectra are given in <a href="#CITEREFASTM_G173" title="wikilink">ASTM G 173-03</a>. The extraterrestrial spectral irradiance (i.e., that for AM0) is given in <a href="#CITEREFASTM_E490" title="wikilink">ASTM E 490-00a</a>.<a class="footnoteRef" href="#fn8" id="fnref8"><sup>8</sup></a></p>

<p>For many solar energy applications when high accuracy near the horizon is not required, air mass is commonly determined using the simple secant formula described in the section <a href="#Plane-parallel_atmosphere" title="wikilink">Plane-parallel atmosphere</a>.</p>
<h2 id="notes">Notes</h2>
<references>
</references>
<h2 id="see-also">See also</h2>
<ul>
<li><a href="Air_mass_(solar_energy)" title="wikilink">Air mass (solar energy)</a></li>
<li><a href="Extinction_(astronomy)#Atmospheric_extinction" title="wikilink">Atmospheric extinction</a></li>
<li><a href="Beer–Lambert_law" title="wikilink">Beer–Lambert–Bouguer law</a></li>
<li><a href="Diffuse_sky_radiation" title="wikilink">Diffuse sky radiation</a></li>
<li><a href="refractive_index#Dispersion_and_absorption" title="wikilink">Extinction coefficient</a></li>
<li><a class="uri" href="Illuminance" title="wikilink">Illuminance</a></li>
<li><a href="International_Standard_Atmosphere" title="wikilink">International Standard Atmosphere</a></li>
<li><a class="uri" href="Irradiance" title="wikilink">Irradiance</a></li>
<li><a href="Law_of_atmospheres" title="wikilink">Law of atmospheres</a></li>
<li><a href="Light_diffusion" title="wikilink">Light diffusion</a></li>
<li><a href="Mie_scattering" title="wikilink">Mie scattering</a></li>
<li><a href="Photovoltaic_module" title="wikilink">Photovoltaic module</a></li>
<li><a href="Rayleigh_scattering" title="wikilink">Rayleigh scattering</a></li>
<li><a href="Solar_irradiation" title="wikilink">Solar irradiation</a></li>
</ul>
<h2 id="references">References</h2>
<ul>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
</ul>
<h2 id="external-links">External links</h2>
<ul>
<li>Reed Meyer’s <a href="http://reed.gigacorp.net/vitdownld.html#airmass">downloadable airmass calculator, written in C</a> (notes in the source code describe the theory in detail)</li>
<li><a href="http://adswww.harvard.edu/index.html">NASA Astrophysics Data System</a> A source for electronic copies of some of the references.</li>
</ul>

<p>"</p>

<p><a href="Category:Astronomical_imaging" title="wikilink">Category:Astronomical imaging</a> <a href="Category:Observational_astronomy" title="wikilink">Category:Observational astronomy</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1">Allen’s air mass table was an abbreviated compilation of values from earlier sources, primarily <a href="#CITEREFBemporad1904" title="wikilink">Bemporad (1904)</a>.<a href="#fnref1">↩</a></li>
<li id="fn2">At very high zenith angles, air mass is strongly dependent on local atmospheric conditions, including temperature, pressure, and especially the temperature gradient near the ground. In addition low-altitude extinction is strongly affected by the aerosol concentration and its vertical distribution. Many authors have cautioned that accurate calculation of air mass near the horizon is all but impossible.<a href="#fnref2">↩</a></li>
<li id="fn3"><a href="#CITEREFPickering2002" title="wikilink">Pickering (2002)</a> uses <a href="#CITEREFGarfinkel1967" title="wikilink">Garfinkel (1967)</a> as the reference for accuracy.<a href="#fnref3">↩</a></li>
<li id="fn4">Although acknowledging that an isothermal or polytropic atmosphere would have been more realistic, <a href="#CITEREFJaniczekDeYoung1987" title="wikilink">Janiczek and DeYoung (1987)</a> used the homogeneous spherical model in calculating illumination from the Sun and Moon, with the implication that the slightly reduced accuracy was more than offset by the considerable reduction in computational overhead.<a href="#fnref4">↩</a></li>
<li id="fn5">The notes for Reed Meyer’s <a href="http://reed.gigacorp.net/vitdownld.html#airmass">air mass calculator</a> describe an atmospheric model using eight layers and using polynomials rather than simple linear relations for temperature lapse rates.<a href="#fnref5">↩</a></li>
<li id="fn6">See <a href="#CITEREFThomasonHermanReagan1983" title="wikilink">Thomason, Herman, and Reagan (1983)</a> for a derivation of the integral for a refracting atmosphere.<a href="#fnref6">↩</a></li>
<li id="fn7"><a href="http://www.astro.uni-bonn.de/~mischa/obstips/airmass.html">Observing tips: air mass and differential refraction</a> retrieved 15 May 2011.<a href="#fnref7">↩</a></li>
<li id="fn8">ASTM E 490-00a was reapproved without change in 2006.<a href="#fnref8">↩</a></li>
</ol>
</section>
</body>
</html>

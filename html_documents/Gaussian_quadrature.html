<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title offset="1619">Gaussian quadrature</title>
   <script type="text/javascript"
      src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js">
    </script>
</head>
<body>
<h1>Gaussian quadrature</h1>
<hr/>
<p>In <a href="numerical_analysis" title="wikilink">numerical analysis</a>, a <strong>quadrature rule</strong> is an approximation of the <a href="integral" title="wikilink">definite integral</a> of a <a href="function_(mathematics)" title="wikilink">function</a>, usually stated as a <a href="weighted_sum" title="wikilink">weighted sum</a> of function values at specified points within the domain of integration. (See <a href="numerical_integration" title="wikilink">numerical integration</a> for more on <a href="quadrature_(mathematics)" title="wikilink">quadrature</a> rules.) An <em>n</em>-point <strong>Gaussian quadrature rule</strong>, named after <a href="Carl_Friedrich_Gauss" title="wikilink">Carl Friedrich Gauss</a>, is a quadrature rule constructed to yield an exact result for <a href="polynomial" title="wikilink">polynomials</a> of degree <span class="LaTeX">$2 n − 1$</span> or less by a suitable choice of the points <mtpl></mtpl> and weights <mtpl></mtpl> for <span class="LaTeX">$i = 1, ..., n$</span>. The domain of integration for such a rule is conventionally taken as [−1, 1], so the rule is stated as</p>
<p><span class="LaTeX">$$\int_{-1}^1 f(x)\,dx = \sum_{i=1}^n w_i f(x_i).$$</span></p>
<p>Gaussian quadrature as above will only produce accurate results if the function <em>f</em>(<em>x</em>) is well approximated by a polynomial function within the range <span class="LaTeX">$−1, 1 1$</span>. The method is not, for example, suitable for functions with <a href="singularity_(math)" title="wikilink">singularities</a>. However, if the integrated function can be written as <span class="LaTeX">$f(x) = \omega(x) g(x)\,$</span>, where <span class="LaTeX">$g ( x )$</span> is approximately polynomial and <span class="LaTeX">$ω ( x )$</span> is known, then alternative weights <span class="LaTeX">$w_i'$</span> and points <span class="LaTeX">$x_i'$</span> that depend on the weighting function <span class="LaTeX">$ω ( x )$</span> may give better results, where</p>
<p><span class="LaTeX">$$\int_{-1}^1 f(x)\,dx = \int_{-1}^1 \omega(x) g(x)\,dx \approx \sum_{i=1}^n w_i' g(x_i').$$</span></p>
<p>Common weighting functions include <span class="LaTeX">$\omega(x)=1/\sqrt{1-x^2}\,$</span> (<a href="Chebyshev–Gauss_quadrature" title="wikilink">Chebyshev–Gauss</a>) and <span class="LaTeX">$\omega(x)=e^{-x^2}$</span> (<a href="Gauss–Hermite_quadrature" title="wikilink">Gauss–Hermite</a>).</p>
<p>It can be shown (see Press, et al., or Stoer and Bulirsch) that the evaluation points <mtpl></mtpl> are just the <a href="Root_of_a_function" title="wikilink">roots</a> of a polynomial belonging to a class of <a href="orthogonal_polynomials" title="wikilink">orthogonal polynomials</a>.</p>
<h2 id="gausslegendre-quadrature">Gauss–Legendre quadrature</h2>
<figure><b>(Figure)</b>
<figcaption>Graphs of Legendre polynomials (up to <em>n</em> = 5)</figcaption>
</figure>
<p>For the simplest integration problem stated above, i.e. with <span class="LaTeX">$\omega(x)=1$</span>, the associated polynomials are <a href="Legendre_polynomials" title="wikilink">Legendre polynomials</a>, <em>P</em><sub><em>n</em></sub>(<em>x</em>), and the method is usually known as Gauss–Legendre quadrature. With the <span class="LaTeX">$n$</span>-th polynomial normalized to give <em>P</em><sub><em>n</em></sub>(1) = 1, the <span class="LaTeX">$i$</span>-th Gauss node, <mtpl></mtpl>, is the <span class="LaTeX">$i$</span>-th root of <mtpl></mtpl>; its weight is given by </p>
<p><span class="LaTeX">$$w_i = \frac{2}{\left( 1-x_i^2 \right) [P'_n(x_i)]^2}.$$</span></p>
<p>Some low-order rules for solving the integration problem are listed below.</p>
<table>
<thead>
<tr class="header">
<th style="text-align: left;"><p>Number of points, <em>n</em></p></th>
<th style="text-align: left;"><p>Points, <mtpl></mtpl></p></th>
<th style="text-align: left;"><p>Weights, <mtpl></mtpl></p></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><p>1</p></td>
<td style="text-align: left;"><p>0</p></td>
<td style="text-align: left;"><p>2</p></td>
</tr>
<tr class="even">
<td style="text-align: left;"><p>2</p></td>
<td style="text-align: left;"><p><span class="LaTeX">$\pm \sqrt{\tfrac{1}{3}}$</span></p></td>
<td style="text-align: left;"><p>1</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><p>3</p></td>
<td style="text-align: left;"><p>0</p></td>
<td style="text-align: left;"><p><span class="LaTeX">$\tfrac{8}{9}$</span></p></td>
</tr>
<tr class="even">
<td style="text-align: left;"><p><span class="LaTeX">$\pm\sqrt{\tfrac{3}{5}}$</span></p></td>
<td style="text-align: left;"><p><span class="LaTeX">$\tfrac{5}{9}$</span></p></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><p>4</p></td>
<td style="text-align: left;"><p><span class="LaTeX">$\pm\sqrt{\tfrac{3}{7} - \tfrac{2}{7}\sqrt{\tfrac{6}{5}}}$</span></p></td>
<td style="text-align: left;"><p><span class="LaTeX">$\tfrac{18+\sqrt{30}}{36}$</span></p></td>
</tr>
<tr class="even">
<td style="text-align: left;"><p><span class="LaTeX">$\pm\sqrt{\tfrac{3}{7} + \tfrac{2}{7}\sqrt{\tfrac{6}{5}}}$</span></p></td>
<td style="text-align: left;"><p><span class="LaTeX">$\tfrac{18-\sqrt{30}}{36}$</span></p></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><p>5</p></td>
<td style="text-align: left;"><p>0</p></td>
<td style="text-align: left;"><p><span class="LaTeX">$\tfrac{128}{225}$</span></p></td>
</tr>
<tr class="even">
<td style="text-align: left;"><p><span class="LaTeX">$\pm\tfrac13\sqrt{5-2\sqrt{\tfrac{10}{7}}}$</span></p></td>
<td style="text-align: left;"><p><span class="LaTeX">$\tfrac{322+13\sqrt{70}}{900}$</span></p></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><p><span class="LaTeX">$\pm\tfrac13\sqrt{5+2\sqrt{\tfrac{10}{7}}}$</span></p></td>
<td style="text-align: left;"><p><span class="LaTeX">$\tfrac{322-13\sqrt{70}}{900}$</span></p></td>
</tr>
</tbody>
</table>
<h2 id="change-of-interval">Change of interval</h2>
<p>An integral over <span class="LaTeX">$a a , b$</span> must be changed into an integral over <span class="LaTeX">$−1, 1 1$</span> before applying the Gaussian quadrature rule. This change of interval can be done in the following way:</p>
<p><span class="LaTeX">$$\int_a^b f(x)\,dx = \frac{b-a}{2} \int_{-1}^1 f\left(\frac{b-a}{2}x + \frac{a+b}{2}\right)\,dx.$$</span></p>
<p>Applying the Gaussian quadrature rule then results in the following approximation:</p>
<p><span class="LaTeX">$$\int_a^b f(x)\,dx = \frac{b-a}{2} \sum_{i=1}^n w_i f\left(\frac{b-a}{2}x_i + \frac{a+b}{2}\right).$$</span></p>
<h2 id="other-forms">Other forms</h2>
<p>The integration problem can be expressed in a slightly more general way by introducing a positive <a href="weight_function" title="wikilink">weight function</a> ω into the integrand, and allowing an interval other than <span class="LaTeX">$−1, 1 1$</span>. That is, the problem is to calculate</p>
<p><span class="LaTeX">$$\int_a^b \omega(x)\,f(x)\,dx$$</span></p>
<p>for some choices of <em>a</em>, <em>b</em>, and ω. For <em>a</em> = −1, <em>b</em> = 1, and ω(<em>x</em>) = 1, the problem is the same as that considered above. Other choices lead to other integration rules. Some of these are tabulated below. Equation numbers are given for <a href="Abramowitz_and_Stegun" title="wikilink">Abramowitz and Stegun</a> (A & S).</p>
<table>
<thead>
<tr class="header">
<th style="text-align: left;"><p>Interval</p></th>
<th style="text-align: left;"><p><span class="LaTeX">$ω ( x )$</span></p></th>
<th style="text-align: left;"><p>Orthogonal polynomials</p></th>
<th style="text-align: left;"><p>A & S</p></th>
<th style="text-align: left;"><p>For more information, see ...</p></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><p>[−1, 1]</p></td>
<td style="text-align: left;"><p><span class="LaTeX">$1$</span></p></td>
<td style="text-align: left;"><p><a href="Legendre_polynomials" title="wikilink">Legendre polynomials</a></p></td>
<td style="text-align: left;"><p>25.4.29</p></td>
<td style="text-align: left;"><p>See <a href="#Gauss–Legendre_quadrature" title="wikilink">Gauss–Legendre quadrature</a> above</p></td>
</tr>
<tr class="even">
<td style="text-align: left;"><p>(−1, 1)</p></td>
<td style="text-align: left;"><p><span class="LaTeX">$(1-x)^\alpha (1+x)^\beta,\quad \alpha, \beta >-1$</span></p></td>
<td style="text-align: left;"><p><a href="Jacobi_polynomials" title="wikilink">Jacobi polynomials</a></p></td>
<td style="text-align: left;"><p>25.4.33 (<span class="LaTeX">$β = 0$</span>)</p></td>
<td style="text-align: left;"><p><a href="Gauss–Jacobi_quadrature" title="wikilink">Gauss–Jacobi quadrature</a></p></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><p>(−1, 1)</p></td>
<td style="text-align: left;"><p><span class="LaTeX">$\frac{1}{\sqrt{1 - x^2}}$</span></p></td>
<td style="text-align: left;"><p><a href="Chebyshev_polynomials" title="wikilink">Chebyshev polynomials</a> (first kind)</p></td>
<td style="text-align: left;"><p>25.4.38</p></td>
<td style="text-align: left;"><p><a href="Chebyshev–Gauss_quadrature" title="wikilink">Chebyshev–Gauss quadrature</a></p></td>
</tr>
<tr class="even">
<td style="text-align: left;"><p>[−1, 1]</p></td>
<td style="text-align: left;"><p><span class="LaTeX">$\sqrt{1 - x^2}$</span></p></td>
<td style="text-align: left;"><p>Chebyshev polynomials (second kind)</p></td>
<td style="text-align: left;"><p>25.4.40</p></td>
<td style="text-align: left;"><p><a href="Chebyshev–Gauss_quadrature" title="wikilink">Chebyshev–Gauss quadrature</a></p></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><p>[0, ∞)</p></td>
<td style="text-align: left;"><p><span class="LaTeX">$e^{-x}\,$</span></p></td>
<td style="text-align: left;"><p><a href="Laguerre_polynomials" title="wikilink">Laguerre polynomials</a></p></td>
<td style="text-align: left;"><p>25.4.45</p></td>
<td style="text-align: left;"><p><a href="Gauss–Laguerre_quadrature" title="wikilink">Gauss–Laguerre quadrature</a></p></td>
</tr>
<tr class="even">
<td style="text-align: left;"><p>[0, ∞)</p></td>
<td style="text-align: left;"><p><span class="LaTeX">$x^\alpha e^{-x},\quad \alpha>-1$</span></p></td>
<td style="text-align: left;"><p>Generalized <a href="Laguerre_polynomials" title="wikilink">Laguerre polynomials</a></p></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"><p><a href="Gauss–Laguerre_quadrature" title="wikilink">Gauss–Laguerre quadrature</a></p></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><p>(−∞, ∞)</p></td>
<td style="text-align: left;"><p><span class="LaTeX">$e^{-x^2}$</span></p></td>
<td style="text-align: left;"><p><a href="Hermite_polynomials" title="wikilink">Hermite polynomials</a></p></td>
<td style="text-align: left;"><p>25.4.46</p></td>
<td style="text-align: left;"><p><a href="Gauss–Hermite_quadrature" title="wikilink">Gauss–Hermite quadrature</a></p></td>
</tr>
</tbody>
</table>
<h3 id="fundamental-theorem">Fundamental theorem</h3>
<p>Let <mtpl></mtpl> be a nontrivial polynomial of degree <em>n</em> such that</p>
<p><span class="LaTeX">$$\int_a^b \omega(x) \, x^k p_n(x) \, dx = 0, \quad \text{for all }k=0,1,\ldots,n-1.$$</span></p>
<p>If we pick the <em>n</em> nodes <mtpl></mtpl> to be the zeros of <mtpl></mtpl>, then there exist <em>n</em> weights <mtpl></mtpl> which make the Gauss-quadrature computed integral exact for all polynomials <span class="LaTeX">$h ( x )$</span> of degree 2<em>n</em> − 1 or less. Furthermore, all these nodes <mtpl></mtpl> will lie in the open interval (<em>a</em>, <em>b</em>) .</p>
<p>The polynomial <mtpl></mtpl> is said to be an orthogonal polynomial of degree <em>n</em> associated to the weight function <span class="LaTeX">$ω ( x )$</span>. It is unique up to a constant normalization factor. The idea underlying the proof is that, because of its sufficiently low degree, <span class="LaTeX">$h ( x )$</span> can be divided by <span class="LaTeX">$p_n(x)$</span> to produce a quotient <span class="LaTeX">$q ( x )$</span> of degree strictly lower than <em>n</em>, and a remainder <span class="LaTeX">$r ( x )$</span> of still lower degree, so that both will be orthogonal to <span class="LaTeX">$p_n(x)$</span>, by the defining property of <span class="LaTeX">$p_n(x)$</span>. Thus</p>
<p><span class="LaTeX">$$\int_a^b \omega(x)\,h(x)\,dx = \int_a^b \omega(x)\,r(x)\,dx.$$</span></p>
<p>Because of the choice of nodes <em>x</em><sub><em>i</em></sub>, the corresponding relation</p>
<p><span class="LaTeX">$$\sum_{i=1}^n w_i h(x_i) = \sum_{i=1}^n w_i r(x_i)$$</span></p>
<p>holds also. The exactness of the computed integral for <span class="LaTeX">$h(x)$</span> then follows from corresponding exactness for polynomials of degree only <em>n</em> or less (as is <span class="LaTeX">$r(x)$</span>).</p>
<h4 id="general-formula-for-the-weights">General formula for the weights</h4>
<p>The weights can be expressed as</p>
<p><span class="LaTeX">$$w_{i} = \frac{a_{n}}{a_{n-1}}\frac{\int_{a}^{b}\omega(x)p_{n-1}(x)^{2}dx}{p'_{n}(x_{i})p_{n-1}(x_{i})}$$</span> (1)</p>
<p>where <span class="LaTeX">$a_{k}$</span> is the coefficient of <span class="LaTeX">$x^{k}$</span> in <span class="LaTeX">$p_{k}(x)$</span>. To prove this, note that using <a href="Lagrange_interpolation" title="wikilink">Lagrange interpolation</a> one can express <span class="LaTeX">$r ( x )$</span> in terms of <span class="LaTeX">$r(x_{i})$</span> as</p>
<p><span class="LaTeX">$$r(x) = \sum_{i=1}^{n}r(x_{i})\prod_{\begin{smallmatrix}1\leq j\leq n\\j\neq i\end{smallmatrix}}\frac{x-x_{j}}{x_{i}-x_{j}}$$</span></p>
<p>because <span class="LaTeX">$r ( x )$</span> has degree less than <span class="LaTeX">$n$</span> and is thus fixed by the values it attains at <span class="LaTeX">$n$</span> different points. Multiplying both sides by <span class="LaTeX">$ω ( x )$</span> and integrating from <span class="LaTeX">$a$</span> to <span class="LaTeX">$b$</span> yields</p>
<p><span class="LaTeX">$$\int_{a}^{b}\omega(x)r(x)dx= \sum_{i=1}^{n}r(x_{i})\int_{a}^{b}\omega(x)\prod_{\begin{smallmatrix}1\leq j\leq n\\j\neq i\end{smallmatrix}}\frac{x-x_{j}}{x_{i}-x_{j}}dx$$</span></p>
<p>The weights <mtpl></mtpl> are thus given by</p>
<p><span class="LaTeX">$$w_{i} = \int_{a}^{b}\omega(x)\prod_{\begin{smallmatrix}1\leq j\leq n\\j\neq i\end{smallmatrix}}\frac{x-x_{j}}{x_{i}-x_{j}}dx$$</span></p>
<p>This integral expression for <span class="LaTeX">$w_{i}$</span> can be expressed in terms of the orthogonal polynomials <span class="LaTeX">$p_{n}(x)$</span> and <span class="LaTeX">$p_{n+1}(x)$</span> as follows.</p>
<p>We can write</p>
<p><span class="LaTeX">$$\prod_{\begin{smallmatrix}1\leq j\leq n\\j\neq i\end{smallmatrix}}\left(x-x_{j}\right) = \frac{\prod_{1\leq j\leq n} \left(x - x_{j}\right)}{x-x_{i}} = \frac{p_{n}(x)}{a_{n}\left(x-x_{i}\right)}$$</span></p>
<p>where <span class="LaTeX">$a_{n}$</span> is the coefficient of <span class="LaTeX">$x^n$</span> in <span class="LaTeX">$p_{n}(x)$</span>. Taking the limit of x to <span class="LaTeX">$x_{i}$</span> yields using L'Hôpital's rule</p>
<p><span class="LaTeX">$$\prod_{\begin{smallmatrix}1\leq j\leq n\\j\neq i\end{smallmatrix}}\left(x_{i}-x_{j}\right) = \frac{p'_{n}(x_{i})}{a_{n}}$$</span></p>
<p>We can thus write the integral expression for the weights as</p>
<p><span class="LaTeX">$$w_{i} = \frac{1}{p'_{n}(x_{i})}\int_{a}^{b}\omega(x)\frac{p_{n}(x)}{x-x_{i}}dx$$</span> ---------(2)</p>
<p>In the integrand, writing</p>
<p><span class="LaTeX">$$\frac{1}{x-x_i} = \frac{1-\left(\frac{x}{x_i}\right)^{k}}{x-x_i} + \left(\frac{x}{x_i}\right)^{k} \frac{1}{x-x_i}$$</span></p>
<p>yields</p>
<p><span class="LaTeX">$$\int_a^b\omega(x)\frac{x^kp_n(x)}{x-x_i}dx= x_i^k\int_{a}^{b}\omega(x)\frac{p_n(x)}{x-x_i}dx$$</span></p>
<p>provided <span class="LaTeX">$k\leq n$</span>, because</p>
<p><span class="LaTeX">$$\frac{1-\left(\frac{x}{x_{i}}\right)^{k}}{x-x_{i}}$$</span></p>
<p>is a polynomial of degree k-1 which is then orthogonal to <span class="LaTeX">$p_{n}(x)$</span>. So, if <span class="LaTeX">$q ( x )$</span> is a polynomial of at most nth degree we have</p>
<p><span class="LaTeX">$$\int_{a}^{b}\omega(x)\frac{p_{n}(x)}{x-x_{i}}dx=\frac{1}{q(x_{i})}\int_{a}^{b}\omega(x)\frac{q(x)p_{n}(x)}{x-x_{i}}dx$$</span></p>
<p>We can evaluate the integral on the right hand side for <span class="LaTeX">$q(x) = p_{n-1}(x)$</span> as follows. Because <span class="LaTeX">$\frac{p_{n}(x)}{x-x_{i}}$</span> is a polynomial of degree n-1, we have</p>
<p><span class="LaTeX">$$\frac{p_{n}(x)}{x-x_{i}} = a_{n}x^{n-1} + s(x)$$</span></p>
<p>where <span class="LaTeX">$s ( x )$</span> is a polynomial of degree <span class="LaTeX">$n-2$</span>. Since <span class="LaTeX">$s ( x )$</span> is orthogonal to <span class="LaTeX">$p_{n-1}(x)$</span> we have</p>
<p><span class="LaTeX">$$\int_{a}^{b}\omega(x)\frac{p_{n}(x)}{x-x_{i}}dx=\frac{a_{n}}{p_{n-1}(x_{i})}\int_{a}^{b}\omega(x)p_{n-1}(x)x^{n-1}dx$$</span></p>
<p>We can then write</p>
<p><span class="LaTeX">$$x^{n-1} = \left(x^{n-1} - \frac{p_{n-1}(x)}{a_{n-1}}\right) + \frac{p_{n-1}(x)}{a_{n-1}}$$</span></p>
<p>The term in the brackets is a polynomial of degree <span class="LaTeX">$n-2$</span>, which is therefore orthogonal to <span class="LaTeX">$p_{n-1}(x)$</span>. The integral can thus be written as</p>
<p><span class="LaTeX">$$\int_{a}^{b}\omega(x)\frac{p_{n}(x)}{x-x_{i}}dx=\frac{a_{n}}{a_{n-1}p_{n-1}(x_{i})}\int_{a}^{b}\omega(x)p_{n-1}(x)^{2}dx$$</span></p>
<p>According to Eq. (2), the weights are obtained by dividing this by <span class="LaTeX">$p'_{n}(x_{i})$</span> and that yields the expression in Eq. (1).</p>
<h4 id="proof-that-the-weights-are-positive">Proof that the weights are positive</h4>
<p>Consider the following polynomial of degree 2n-2</p>
<p><span class="LaTeX">$$f(x) = \prod_{\begin{smallmatrix}1\leq j\leq n\\j\neq i\end{smallmatrix}}(x-x_{j})^{2}$$</span></p>
<p>where as above the <mtpl></mtpl> are the roots of the polynomial <span class="LaTeX">$p_{n}(x)$</span>. Since the degree of f(x) is less than 2n-1, the Gaussian quadrature formula involving the weights and nodes obtained from <span class="LaTeX">$p_{n}(x)$</span> applies. Since <span class="LaTeX">$f(x_{j})=0$</span> for j not equal to i, we have</p>
<p><span class="LaTeX">$$\int_{a}^{b}\omega(x)f(x)dx=\sum_{j=1}^{N}w_{j}f(x_{j}) = w_{i} f(x_{i}).$$</span></p>
<p>Since both <span class="LaTeX">$\omega(x)$</span> and f(x) are non-negative functions, it follows that <span class="LaTeX">$w_{i}>0$</span>.</p>
<h3 id="computation-of-gaussian-quadrature-rules">Computation of Gaussian quadrature rules</h3>
<p>For computing the nodes <mtpl></mtpl> and weights <mtpl></mtpl> of Gaussian quadrature rules, the fundamental tool is the three-term <a href="recurrence_relation" title="wikilink">recurrence relation</a> satisfied by the set of orthogonal polynomials associated to the corresponding weight function. For <span class="LaTeX">$n$</span> points, these nodes and weights can be computed in <em>O</em>(<em>n</em><sup>2</sup>) operations by an algorithm derived by Gautschi (1968).</p>
<h4 id="gautschis-theorem">Gautschi's theorem</h4>
<p>Gautschi's theorem (Gautschi, 1968) states that orthogonal polynomials <span class="LaTeX">$p_r$</span> with <span class="LaTeX">$(p_r,p_s)=0$</span> for <span class="LaTeX">$r\ne s$</span> for a scalar product <span class="LaTeX">$( , )$</span> to be specified later, degree<span class="LaTeX">$(p_r)=r$</span> and leading coefficient one (i.e. <a href="monic_polynomial" title="wikilink">monic</a> orthogonal polynomials) satisfy the recurrence relation</p>
<p><span class="LaTeX">$$p_{r+1}(x)=(x-a_{r,r})p_r(x)-a_{r,r-1}p_{r-1}(x)\ldots-a_{r,0}p_0(x)$$</span></p>
<p>for <span class="LaTeX">$r=0,1,\ldots,n-1$</span> where <span class="LaTeX">$n$</span> is the maximal degree which can be taken to be infinity, and where <span class="LaTeX">$a_{r,s}=(xp_r,p_s)/(p_s,p_s)$</span>. First of all, it is obvious that the polynomials defined by the recurrence relation starting with <span class="LaTeX">$p_0(x)=1$</span> have leading coefficient one and correct degree. Given the starting point by <span class="LaTeX">$p_0$</span>, the orthogonality of <span class="LaTeX">$p_r$</span> can be shown by induction. For <span class="LaTeX">$r=s=0$</span> one has</p>
<p><span class="LaTeX">$$(p_1,p_0)=((x-a_{0,0}p_0,p_0)=(xp_0,p_0)-a_{0,0}(p_0,p_0)=(xp_0,p_0)-(xp_0,p_0)=0.$$</span></p>
<p>Now if <span class="LaTeX">$p_0,p_1,\ldots,p_r$</span> are orthogonal, then also <span class="LaTeX">$p_{r+1}$</span>, because in</p>
<p><span class="LaTeX">$$(p_{r+1},p_s)=(xp_r,p_s)-a_{r,r}(p_r,p_s)-a_{r,r-1}(p_{r-1},p_s)\ldots-a_{r,0}(p_0,p_s)$$</span></p>
<p>all scalar products vanish except for the first one and the one where <span class="LaTeX">$p_s$</span> meets the same orthogonal polynomial. Therefore,</p>
<p><span class="LaTeX">$$(p_{r+1},p_s)=(xp_r,p_s)-a_{r,s}(p_s,p_s)=(xp_r,p_s)-(xp_r,p_s)=0.$$</span></p>
<p>However, if the scalar product satisfies <span class="LaTeX">$(xf,g)=(f,xg)$</span> (which is the case for Gaussian quadrature), the recurrence relation reduces to a three-term recurrence relation: For <span class="LaTeX">$s\le r-1, xp_s$</span> is a polynomial of degree less or equal to <span class="LaTeX">$r − 1$</span>. On the other hand, <span class="LaTeX">$p_r$</span> is orthogonal to every polynomial of degree less or equal to <span class="LaTeX">$r − 1$</span>. Therefore, one has <span class="LaTeX">$(xp_r,p_s)=(p_r,xp_s)=0$</span> and <span class="LaTeX">$a_{r,s}=0$</span> for <span class="LaTeX">$s . The recurrence relation then simplifies to</span></p>
<p><span class="LaTeX">$$p_{r+1}(x)=(x-a_{r,r})p_r(x)-a_{r,r-1}p_{r-1}(x)$$</span></p>
<p>or</p>
<p><span class="LaTeX">$$p_{r+1}(x)=(x-a_r)p_r(x)-b_rp_{r-1}(x)$$</span></p>
<p>(with the convention <span class="LaTeX">$p_{-1}(x)\equiv 0$</span>) where</p>
<p><span class="LaTeX">$$a_r:=\frac{(xp_r,p_r)}{(p_r,p_r)},\qquad b_r:=\frac{(xp_r,p_{r-1})}{(p_{r-1},p_{r-1})}=\frac{(p_r,p_r)}{(p_{r-1},p_{r-1})}$$</span></p>
<p>(the last because of <span class="LaTeX">$(xp_r,p_{r-1})=(p_r,xp_{r-1})=(p_r,p_r)$</span>, since <span class="LaTeX">$xp_{r-1}$</span> differs from <span class="LaTeX">$p_r$</span> by a degree less than <span class="LaTeX">$r$</span>).</p>
<h4 id="the-golub-welsch-algorithm">The Golub-Welsch algorithm</h4>
<p>The three-term recurrence relation can be written in the matrix form <span class="LaTeX">$J\tilde{P}=x\tilde{P}-p_n(x)\times\mathbf{e}_n$</span> where <span class="LaTeX">$\tilde{P}=[p_0(x),p_1(x),...,p_{n-1}(x)]^{T}$</span>, <span class="LaTeX">$\mathbf{e}_n$</span> is the <span class="LaTeX">$n$</span>th standard basis vector, i.e. <span class="LaTeX">$\mathbf{e}_n=[0,...,0,1]^{T}$</span>, and <span class="LaTeX">$J$</span> is the so-called Jacobi matrix:</p>
<p><span class="LaTeX">$$\mathbf{J}=\begin{pmatrix}
a_0      & 1       & 0      & \ldots  & \ldots  & \ldots\\
b_1      & a_1     & 1      & 0       & \ldots  & \ldots \\
0        & b_2     & a_2    & 1       & 0       & \ldots \\
0   & \ldots  & \ldots & \ldots  & \ldots  & 0 \\
\ldots   & \ldots  & 0 & b_{n-2}  & a_{n-2}  & 1 \\
\ldots   & \ldots  & \ldots & 0  & b_{n-1}  & a_{n-1}
\end{pmatrix}$$</span></p>
<p>The zeros <span class="LaTeX">$x_j$</span> of the polynomials up to degree <span class="LaTeX">$n$</span> which are used as nodes for the Gaussian quadrature can be found by computing the eigenvalues of this <a href="tridiagonal_matrix" title="wikilink">tridiagonal matrix</a>. This procedure is known as <em>Golub–Welsch algorithm</em>.</p>
<p>For computing the weights and nodes, it is preferable to consider the symmetric tridiagonal matrix <span class="LaTeX">$\mathcal{J}$</span> with elements</p>
<p><span class="LaTeX">$$\begin{align}
\mathcal{J}_{i,i} &=J_{i,i}=a_{i-1} && i=1,\ldots,n \\ 
\mathcal{J}_{i-1,i}=\mathcal{J}_{i,i-1} &=\sqrt{J_{i,i-1}J_{i-1,i}}=\sqrt{b_{i-1}} && i=2,\ldots,n.
\end{align}$$</span> <span class="LaTeX">$\mathbf{ J } $</span> and <span class="LaTeX">$\mathcal{J}$</span> are <a href="similar_matrices" title="wikilink">similar matrices</a> and therefore have the same eigenvalues (the nodes). The weights can be computed from the corresponding eigenvectors: If <span class="LaTeX">$\phi^{(j)}$</span> is a normalized eigenvector (i.e., an eigenvector with euclidean norm equal to one) associated to the eigenvalue <mtpl></mtpl>, the corresponding weight can be computed from the first component of this eigenvector, namely:</p>
<p><span class="LaTeX">$$w_j=\mu_0 \left(\phi_1^{(j)}\right)^2$$</span></p>
<p>where <span class="LaTeX">$\mu_0$</span> is the integral of the weight function</p>
<p><span class="LaTeX">$$\mu_0=\int_a^b \omega(x) dx.$$</span></p>
<p>See, for instance,  for further details.</p>
<h3 id="error-estimates">Error estimates</h3>
<p>The error of a Gaussian quadrature rule can be stated as follows . For an integrand which has <span class="LaTeX">$2 n$</span> continuous derivatives,</p>
<p><span class="LaTeX">$$\int_a^b \omega(x)\,f(x)\,dx - \sum_{i=1}^n w_i\,f(x_i) = \frac{f^{(2n)}(\xi)}{(2n)!} \, (p_n,p_n)$$</span></p>
<p>for some <span class="LaTeX">$ξ$</span> in <span class="LaTeX">$( a , b )$</span>, where <mtpl></mtpl> is the monic (i.e. the leading coefficient is 1) orthogonal polynomial of degree <span class="LaTeX">$n$</span> and where</p>
<p><span class="LaTeX">$$(f,g) = \int_a^b \omega(x) f(x) g(x) \, dx.$$</span></p>
<p>In the important special case of <span class="LaTeX">$ω ( x ) = 1$</span>, we have the error estimate </p>
<p><span class="LaTeX">$$\frac{(b-a)^{2n+1} (n!)^4}{(2n+1)[(2n)!]^3} f^{(2n)} (\xi) , \qquad a < \xi < b.$$</span></p>
<p>Stoer and Bulirsch remark that this error estimate is inconvenient in practice, since it may be difficult to estimate the order 2<em>n</em> derivative, and furthermore the actual error may be much less than a bound established by the derivative. Another approach is to use two Gaussian quadrature rules of different orders, and to estimate the error as the difference between the two results. For this purpose, Gauss–Kronrod quadrature rules can be useful.</p>
<p>An important consequence of the above equation is that Gaussian quadrature of order <span class="LaTeX">$n$</span> is accurate for all polynomials up to degree <span class="LaTeX">$2 n − 1$</span>.</p>
<h3 id="gausskronrod-rules">Gauss–Kronrod rules</h3>
<p>If the interval <span class="LaTeX">$a a , b$</span> is subdivided, the Gauss evaluation points of the new subintervals never coincide with the previous evaluation points (except at zero for odd numbers), and thus the integrand must be evaluated at every point. <em>Gauss–Kronrod rules</em> are extensions of Gauss quadrature rules generated by adding <span class="LaTeX">$n + 1$</span> points to an <span class="LaTeX">$n$</span>-point rule in such a way that the resulting rule is of order <span class="LaTeX">$3 n + 1$</span>. This allows for computing higher-order estimates while re-using the function values of a lower-order estimate. The difference between a Gauss quadrature rule and its Kronrod extension are often used as an estimate of the approximation error.</p>
<h3 id="gausslobatto-rules">Gauss–Lobatto rules</h3>
<p>Also known as <strong>Lobatto quadrature</strong> , named after Dutch mathematician <a href="Rehuel_Lobatto" title="wikilink">Rehuel Lobatto</a>. It is similar to Gaussian quadrature with the following differences:</p>
<ol>
<li>The integration points include the end points of the integration interval.</li>
<li>It is accurate for polynomials up to degree 2<em>n</em>–3, where <em>n</em> is the number of integration points .</li>
</ol>
<p>Lobatto quadrature of function <em>f</em>(<em>x</em>) on interval <span class="LaTeX">$−1, 1 1$</span>:</p>
<p><span class="LaTeX">$$\int_{-1}^1 {f(x) \, dx} = \frac {2} {n(n-1)}[f(1) + f(-1)] + \sum_{i = 2} ^{n-1} {w_i f(x_i)} + R_n.$$</span></p>
<p>Abscissas: <mtpl></mtpl> is the <span class="LaTeX">$(i-1)$</span>st zero of <span class="LaTeX">$P'_{n-1}(x)$</span>.</p>
<p>Weights:</p>
<p><span class="LaTeX">$$w_i = \frac{2}{n(n-1)[P_{n-1}(x_i)]^2}, \qquad x_i \ne \pm 1.$$</span></p>
<p>Remainder:</p>
<p><span class="LaTeX">$$R_n = \frac{- n (n-1)^3 2^{2n-1} [(n-2)!]^4}{(2n-1) [(2n-2)!]^3} f^{(2n-2)}(\xi), \qquad -1 < \xi < 1.$$</span></p>
<p>Some of the weights are:</p>
<table>
<thead>
<tr class="header">
<th style="text-align: left;"><p>Number of points, <em>n</em></p></th>
<th style="text-align: left;"><p>Points, <mtpl></mtpl></p></th>
<th style="text-align: left;"><p>Weights, <mtpl></mtpl></p></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><p><span class="LaTeX">$3$</span></p></td>
<td style="text-align: left;"><p><span class="LaTeX">$0$</span></p></td>
<td style="text-align: left;"><p><span class="LaTeX">$\frac{4}{3}$</span></p></td>
</tr>
<tr class="even">
<td style="text-align: left;"><p><span class="LaTeX">$\pm 1$</span></p></td>
<td style="text-align: left;"><p><span class="LaTeX">$\frac{1}{3}$</span></p></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><p><span class="LaTeX">$4$</span></p></td>
<td style="text-align: left;"><p><span class="LaTeX">$\pm \sqrt{\frac {1}{5}}$</span></p></td>
<td style="text-align: left;"><p><span class="LaTeX">$\frac{5}{6}$</span></p></td>
</tr>
<tr class="even">
<td style="text-align: left;"><p><span class="LaTeX">$\pm 1$</span></p></td>
<td style="text-align: left;"><p><span class="LaTeX">$\frac{1}{6}$</span></p></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><p><span class="LaTeX">$5$</span></p></td>
<td style="text-align: left;"><p><span class="LaTeX">$0$</span></p></td>
<td style="text-align: left;"><p><span class="LaTeX">$\frac{32}{45}$</span></p></td>
</tr>
<tr class="even">
<td style="text-align: left;"><p><span class="LaTeX">$\pm\sqrt{\frac {3} {7}}$</span></p></td>
<td style="text-align: left;"><p><span class="LaTeX">$\frac{49}{90}$</span></p></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><p><span class="LaTeX">$\pm 1$</span></p></td>
<td style="text-align: left;"><p><span class="LaTeX">$\frac{1}{10}$</span></p></td>
</tr>
</tbody>
</table>
<h2 id="see-also">See also</h2>
<ul>
<li><a href="Euler–Maclaurin_formula" title="wikilink">Euler–Maclaurin formula</a></li>
<li><a href="Clenshaw–Curtis_quadrature" title="wikilink">Clenshaw–Curtis quadrature</a></li>
</ul>
<h2 id="references">References</h2>
<ul>
<li></li>
<li><mtpl></mtpl></li>
<li></li>
<li></li>
<li></li>
<li></li>
<li><mtpl></mtpl></li>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
<li>
<p>.</p></li>
<li></li>
<li></li>
<li></li>
<li></li>
</ul>
<h2 id="external-links">External links</h2>
<ul>
<li></li>
<li><a href="http://www.alglib.net/integral/gq/">ALGLIB</a> contains a collection of algorithms for numerical integration (in C# / C++ / Delphi / Visual Basic / etc.)</li>
<li><a href="http://www.gnu.org/software/gsl/">GNU Scientific Library</a> — includes <a href="C_(programming_language)" title="wikilink">C</a> version of <a class="uri" href="QUADPACK" title="wikilink">QUADPACK</a> algorithms (see also <a href="GNU_Scientific_Library" title="wikilink">GNU Scientific Library</a>)</li>
<li><a href="http://ans.hsh.no/home/skk/Publications/Lobatto/PRIMUS_KHATTRI.pdf">From Lobatto Quadrature to the Euler constant e</a></li>
<li><a href="http://numericalmethods.eng.usf.edu/topics/gauss_quadrature.html">Gaussian Quadrature Rule of Integration – Notes, PPT, Matlab, Mathematica, Maple, Mathcad</a> at <em>Holistic Numerical Methods Institute</em></li>
<li></li>
<li><a href="http://demonstrations.wolfram.com/GaussianQuadrature/">Gaussian Quadrature</a> by Chris Maes and Anton Antonov, <a href="Wolfram_Demonstrations_Project" title="wikilink">Wolfram Demonstrations Project</a>.</li>
<li><a href="http://pomax.github.io/bezierinfo/legendre-gauss.html">Tabulated weights and abscissae with Mathematica source code</a>, high precision (16 and 256 decimal places) Legendre-Gaussian quadrature weights and abscissas, for <em>n</em>=2 through <em>n</em>=64, with Mathematica source code.</li>
<li><a href="http://people.sc.fsu.edu/~jburkardt/math_src/arbitrary_weight_rule/arbitrary_weight_rule.html">Mathematica source code distributed under the GNU LGPL</a> for abscissas and weights generation for arbitrary weighting functions W(x), integration domains and precisions.</li>
</ul>
<p>"</p>
<p><a href="Category:Numerical_integration_(quadrature)" title="wikilink">Category:Numerical integration (quadrature)</a></p>
</body>
</html>

<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="35">Trajectory (fluid mechanics)</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Trajectory (fluid mechanics)</h1>
<hr/>

<p>In <a href="fluid_mechanics" title="wikilink">fluid mechanics</a>, <a class="uri" href="meteorology" title="wikilink">meteorology</a> and <a class="uri" href="oceanography" title="wikilink">oceanography</a>, a <strong>trajectory</strong> traces the motion of a single point, often called a <a href="fluid_parcel" title="wikilink">parcel</a>, in the flow.</p>

<p>Trajectories are useful for tracking atmospheric contaminants, such as smoke plumes, and as constituents to <a href="Lagrangian_coordinates" title="wikilink">Lagrangian</a> simulations, such as <a href="contour_advection" title="wikilink">contour advection</a> or <a href="semi-Lagrangian_scheme" title="wikilink">semi-Lagrangian schemes</a>.</p>

<p>Suppose we have a time-varying flow field, 

<math display="inline" id="Trajectory_(fluid_mechanics):0">
 <semantics>
  <mrow>
   <mover accent="true">
    <mi>v</mi>
    <mo stretchy="false">→</mo>
   </mover>
   <mrow>
    <mo stretchy="false">(</mo>
    <mover accent="true">
     <mi>x</mi>
     <mo stretchy="false">→</mo>
    </mover>
    <mo rspace="5.8pt">,</mo>
    <mi>t</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <ci>normal-→</ci>
     <ci>v</ci>
    </apply>
    <interval closure="open">
     <apply>
      <ci>normal-→</ci>
      <ci>x</ci>
     </apply>
     <ci>t</ci>
    </interval>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \vec{v}(\vec{x},~{}t)
  </annotation>
 </semantics>
</math>

. The motion of a fluid parcel, or trajectory, is given by the following system of <a href="ordinary_differential_equations" title="wikilink">ordinary differential equations</a>:</p>

<p>

<math display="block" id="Trajectory_(fluid_mechanics):1">
 <semantics>
  <mrow>
   <mfrac>
    <mrow>
     <mi>d</mi>
     <mover accent="true">
      <mi>x</mi>
      <mo stretchy="false">→</mo>
     </mover>
    </mrow>
    <mrow>
     <mi>d</mi>
     <mi>t</mi>
    </mrow>
   </mfrac>
   <mo>=</mo>
   <mrow>
    <mover accent="true">
     <mi>v</mi>
     <mo stretchy="false">→</mo>
    </mover>
    <mrow>
     <mo stretchy="false">(</mo>
     <mover accent="true">
      <mi>x</mi>
      <mo stretchy="false">→</mo>
     </mover>
     <mo rspace="5.8pt">,</mo>
     <mi>t</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <divide></divide>
     <apply>
      <times></times>
      <ci>d</ci>
      <apply>
       <ci>normal-→</ci>
       <ci>x</ci>
      </apply>
     </apply>
     <apply>
      <times></times>
      <ci>d</ci>
      <ci>t</ci>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <ci>normal-→</ci>
      <ci>v</ci>
     </apply>
     <interval closure="open">
      <apply>
       <ci>normal-→</ci>
       <ci>x</ci>
      </apply>
      <ci>t</ci>
     </interval>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \frac{d\vec{x}}{dt}=\vec{v}(\vec{x},~{}t)
  </annotation>
 </semantics>
</math>

</p>

<p>While the equation looks simple, there are at least three concerns when attempting to solve it <a class="uri" href="numerically" title="wikilink">numerically</a>. The first is the <a href="numerical_ordinary_differential_equations" title="wikilink">integration scheme</a>. This is typically a <a class="uri" href="Runge-Kutta" title="wikilink">Runge-Kutta</a>,<a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a> although others can be useful as well, such as a <a href="leapfrog_integration" title="wikilink">leapfrog</a>. The second is the method of determining the velocity vector, 

<math display="inline" id="Trajectory_(fluid_mechanics):2">
 <semantics>
  <mover accent="true">
   <mi>v</mi>
   <mo stretchy="false">→</mo>
  </mover>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-→</ci>
    <ci>v</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \vec{v}
  </annotation>
 </semantics>
</math>

 at a given position, 

<math display="inline" id="Trajectory_(fluid_mechanics):3">
 <semantics>
  <mover accent="true">
   <mi>x</mi>
   <mo stretchy="false">→</mo>
  </mover>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-→</ci>
    <ci>x</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \vec{x}
  </annotation>
 </semantics>
</math>


, and time, <em>t</em>. Normally, it is not known at all positions and times, therefore some method of <a class="uri" href="interpolation" title="wikilink">interpolation</a> is required. If the velocities are gridded in space and time, then <a href="bilinear_interpolation" title="wikilink">bilinear</a>, <a href="trilinear_interpolation" title="wikilink">trilinear</a> or higher-dimensional linear interpolation is appropriate. <a href="Bicubic_interpolation" title="wikilink">Bicubic</a>, <a href="Tricubic_interpolation" title="wikilink">tricubic</a>, etc., interpolation is used as well, but is probably not worth the extra <a href="overhead_(computing)" title="wikilink">computational overhead</a>.</p>

<p>Velocity fields can be determined by measurement, e.g. from <a href="weather_balloons" title="wikilink">weather balloons</a>, from numerical models or especially from a combination of the two, e.g. <a href="data_assimilation" title="wikilink">assimilation models</a>.</p>

<p>The final concern is metric corrections. These are necessary for geophysical fluid flows on a spherical Earth. The differential equations for tracing a two-dimensional, atmospheric trajectory in longitude-latitude coordinates are as follows:</p>

<p>

<math display="block" id="Trajectory_(fluid_mechanics):4">
 <semantics>
  <mrow>
   <mfrac>
    <mrow>
     <mi>d</mi>
     <mi>θ</mi>
    </mrow>
    <mrow>
     <mi>d</mi>
     <mi>t</mi>
    </mrow>
   </mfrac>
   <mo>=</mo>
   <mfrac>
    <mi>u</mi>
    <mrow>
     <mi>r</mi>
     <mrow>
      <mi>cos</mi>
      <mi>ϕ</mi>
     </mrow>
    </mrow>
   </mfrac>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <divide></divide>
     <apply>
      <times></times>
      <ci>d</ci>
      <ci>θ</ci>
     </apply>
     <apply>
      <times></times>
      <ci>d</ci>
      <ci>t</ci>
     </apply>
    </apply>
    <apply>
     <divide></divide>
     <ci>u</ci>
     <apply>
      <times></times>
      <ci>r</ci>
      <apply>
       <cos></cos>
       <ci>ϕ</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \frac{d\theta}{dt}=\frac{u}{r\cos\phi}
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Trajectory_(fluid_mechanics):5">
 <semantics>
  <mrow>
   <mfrac>
    <mrow>
     <mi>d</mi>
     <mi>ϕ</mi>
    </mrow>
    <mrow>
     <mi>d</mi>
     <mi>t</mi>
    </mrow>
   </mfrac>
   <mo>=</mo>
   <mfrac>
    <mi>v</mi>
    <mi>r</mi>
   </mfrac>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <divide></divide>
     <apply>
      <times></times>
      <ci>d</ci>
      <ci>ϕ</ci>
     </apply>
     <apply>
      <times></times>
      <ci>d</ci>
      <ci>t</ci>
     </apply>
    </apply>
    <apply>
     <divide></divide>
     <ci>v</ci>
     <ci>r</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \frac{d\phi}{dt}=\frac{v}{r}
  </annotation>
 </semantics>
</math>

</p>

<p>where, 

<math display="inline" id="Trajectory_(fluid_mechanics):6">
 <semantics>
  <mi>θ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>θ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \theta
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Trajectory_(fluid_mechanics):7">
 <semantics>
  <mi>ϕ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>ϕ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \phi
  </annotation>
 </semantics>
</math>

 are, respectively, the longitude and latitude in <a href="radian" title="wikilink">radians</a>, <em>r</em> is the <a href="radius_of_the_Earth" title="wikilink">radius of the Earth</a>, <em>u</em> is the zonal wind and <em>v</em> is the meridional wind.</p>

<p>One problem with this formulation is the polar singularity: notice how the denominator in the first equation goes to zero when the latitude is 90 degrees—plus or minus. One means of overcoming this is to use a locally <a href="Cartesian_coordinate" title="wikilink">Cartesian coordinate</a> system close to the poles. Another is to perform the integration on a pair of <a href="Azimuthal_equidistant_projection" title="wikilink">Azimuthal equidistant projections</a>—one for the N. Hemisphere and one for the S. Hemisphere.<a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a></p>

<p>Trajectories can be validated by <a class="uri" href="balloons" title="wikilink">balloons</a> in the <a class="uri" href="atmosphere" title="wikilink">atmosphere</a> and <a class="uri" href="buoys" title="wikilink">buoys</a> in the <a class="uri" href="ocean" title="wikilink">ocean</a>.</p>
<h2 id="external-links">External links</h2>
<ul>
<li><a href="http://ctraj.sourceforge.net">ctraj</a>: A trajectory integrator written in C++.</li>
</ul>
<h2 id="references">References</h2>

<p>"</p>

<p><a href="Category:Fluid_dynamics" title="wikilink">Category:Fluid dynamics</a> <a href="Category:Continuum_mechanics" title="wikilink">Category:Continuum mechanics</a> <a href="Category:Basic_meteorological_concepts_and_phenomena" title="wikilink">Category:Basic meteorological concepts and phenomena</a> <a href="Category:Numerical_analysis" title="wikilink">Category:Numerical analysis</a> <a href="Category:Numerical_climate_and_weather_models" title="wikilink">Category:Numerical climate and weather models</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1"><a href="#fnref1">↩</a></li>
<li id="fn2"><a href="#fnref2">↩</a></li>
</ol>
</section>
</body>
</html>

<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="1732">Spiral array model</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Spiral array model</h1>
<hr/>

<p>In <a href="music_theory" title="wikilink">music theory</a>, the <strong>spiral array model</strong> is an extended type of <a href="pitch_space" title="wikilink">pitch space</a>. It represents human perceptions of <a href="pitch_(music)" title="wikilink">pitch</a>, <a href="chord_(music)" title="wikilink">chord</a> and <a href="key_(music)" title="wikilink">key</a> in the same <a href="space" title="wikilink">geometric space</a>, as a mathematical model involving concentric <a href="helix" title="wikilink">helixes</a> (an "array of <a href="spiral" title="wikilink">spirals</a>"). It was proposed in 2000 by Prof. Elaine Chew in her MIT doctoral thesis <em>Toward a Mathematical Model of <a class="uri" href="Tonality" title="wikilink">Tonality</a></em>. Further research by Chew and others have produced modifications of the spiral array model, and, applied it to various problems in music theory and practice, such as key finding and pitch spelling.</p>

<p>The spiral array model can be viewed as an extension of the <a class="uri" href="tonnetz" title="wikilink">tonnetz</a>, which maps pitches into a two-dimensional lattice structure. Just like the tonnetz, the spiral array models higher order structures such as chords and keys in the same space as the low level structure: pitches. This allows the spiral array model to produce geometric interpretations of relationships between low and high level structures. For example, you can measure the geometric distance between a particular pitch and a particular key (both represented as points). Like the tonnetz, when applied to <a href="equal_temperament" title="wikilink">equal temperament</a>, the spiral array model folds into a torus as octaves overlap.</p>
<h2 id="structure-of-the-spiral-array">Structure of the spiral array</h2>

<p>The model covering basic pitch, major chords, minor chords, major keys and minor keys comprises five concentric helixes. Starting with a formulation of the pitch spiral, inner spirals are generated by a <a href="convex_combination" title="wikilink">convex combination</a> of points on outer spirals. For example, the pitches C, E, and G are represented as points by the cartesian coordinates C(x,y,z), E(x,y,z) and G(x,y,z). The convex combination formed by the points CEG is a triangle, and represents the "center of effect" of the three pitches. This convex combination represents the triad, or chord, CEG (the C major chord) in the spiral array model. The geometric center (or other point chosen by a weighting of the constituent points, as seen in the equations below) of the C major chord (formed by CEG) can be called the "center" of the C major chord, and assigned a point CM(x,y,z). Similarly, keys may be constructed by the centers of effect of their I, IV, and V chords.</p>
<ol>
<li>The outer helix represents pitches classes. Neighboring pitch classes are a music interval of a perfect fifth, and spatially a quarter rotation, apart. The order of the pitch classes can be determined by the <a href="circle_of_fifths" title="wikilink">circle of fifths</a>. For example, C would be followed by G, which would be followed D, etc. As a result of this structure, and one of the important properties leading to its selection, vertical neighbors are a music interval of a major third apart. Thus, a pitch class's nearest neighbors and itself form perfect fifth and major third intervals.</li>
<li>By taking every consecutive triad along the helix, and projecting their centers of effect, a second helix is formed inside the pitch helix, representing the major chords.</li>
<li>Similarly, by taking the proper minor triads and projecting their centers of effect, a third helix is formed, representing the minor chords.</li>
<li>The major key helix is formed by projections of the I, IV, and V chords from points on the major chord</li>
<li>The minor key helix is formed by similar projects of minor chords.</li>
</ol>
<h2 id="equations">Equations</h2>

<p>The <strong>pitch spiral P</strong>, is represented in parametric form by:</p>

<p>

<math display="inline" id="Spiral_array_model:0">
 <semantics>
  <mrow>
   <mrow>
    <mi>P</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>k</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mo>[</mo>
    <mtable>
     <mtr>
      <mtd columnalign="center">
       <msub>
        <mi>x</mi>
        <mi>k</mi>
       </msub>
      </mtd>
     </mtr>
     <mtr>
      <mtd columnalign="center">
       <msub>
        <mi>y</mi>
        <mi>k</mi>
       </msub>
      </mtd>
     </mtr>
     <mtr>
      <mtd columnalign="center">
       <msub>
        <mi>z</mi>
        <mi>k</mi>
       </msub>
      </mtd>
     </mtr>
    </mtable>
    <mo>]</mo>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mo>[</mo>
    <mtable>
     <mtr>
      <mtd columnalign="center">
       <mrow>
        <mi>r</mi>
        <mi>s</mi>
        <mi>i</mi>
        <mi>n</mi>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <mrow>
           <mi>k</mi>
           <mo>⋅</mo>
           <mi>π</mi>
          </mrow>
          <mo>/</mo>
          <mn>2</mn>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
      </mtd>
     </mtr>
     <mtr>
      <mtd columnalign="center">
       <mrow>
        <mi>r</mi>
        <mi>c</mi>
        <mi>o</mi>
        <mi>s</mi>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <mrow>
           <mi>k</mi>
           <mo>⋅</mo>
           <mi>π</mi>
          </mrow>
          <mo>/</mo>
          <mn>2</mn>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
      </mtd>
     </mtr>
     <mtr>
      <mtd columnalign="center">
       <mrow>
        <mi>k</mi>
        <mi>h</mi>
       </mrow>
      </mtd>
     </mtr>
    </mtable>
    <mo>]</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <times></times>
      <ci>P</ci>
      <ci>k</ci>
     </apply>
     <matrix>
      <matrixrow>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <ci>k</ci>
       </apply>
      </matrixrow>
      <matrixrow>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>y</ci>
        <ci>k</ci>
       </apply>
      </matrixrow>
      <matrixrow>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>z</ci>
        <ci>k</ci>
       </apply>
      </matrixrow>
     </matrix>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <matrix>
      <matrixrow>
       <apply>
        <times></times>
        <ci>r</ci>
        <ci>s</ci>
        <ci>i</ci>
        <ci>n</ci>
        <apply>
         <divide></divide>
         <apply>
          <ci>normal-⋅</ci>
          <ci>k</ci>
          <ci>π</ci>
         </apply>
         <cn type="integer">2</cn>
        </apply>
       </apply>
      </matrixrow>
      <matrixrow>
       <apply>
        <times></times>
        <ci>r</ci>
        <ci>c</ci>
        <ci>o</ci>
        <ci>s</ci>
        <apply>
         <divide></divide>
         <apply>
          <ci>normal-⋅</ci>
          <ci>k</ci>
          <ci>π</ci>
         </apply>
         <cn type="integer">2</cn>
        </apply>
       </apply>
      </matrixrow>
      <matrixrow>
       <apply>
        <times></times>
        <ci>k</ci>
        <ci>h</ci>
       </apply>
      </matrixrow>
     </matrix>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   P(k)=\begin{bmatrix}\par
 x_{k}\\
y_{k}\\
z_{k}\\
\end{bmatrix}=\begin{bmatrix}\par
 rsin(k\cdot\pi/2)\\
rcos(k\cdot\pi/2)\\
kh\end{bmatrix}
  </annotation>
 </semantics>
</math>

</p>

<p>Where k is an integer representing a semitone, r is the radius of the spiral, and h is the "rise" of the spiral</p>

<p>The <strong>major chord C<sub>M</sub></strong> is represented by:</p>

<p>

<math display="inline" id="Spiral_array_model:1">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>C</mi>
     <mi>M</mi>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>k</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mrow>
      <msub>
       <mi>w</mi>
       <mn>1</mn>
      </msub>
      <mo>⋅</mo>
      <mi>P</mi>
     </mrow>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>k</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>+</mo>
    <mrow>
     <mrow>
      <msub>
       <mi>w</mi>
       <mn>2</mn>
      </msub>
      <mo>⋅</mo>
      <mi>P</mi>
     </mrow>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mi>k</mi>
       <mo>+</mo>
       <mn>1</mn>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>+</mo>
    <mrow>
     <mrow>
      <msub>
       <mi>w</mi>
       <mn>3</mn>
      </msub>
      <mo>⋅</mo>
      <mi>P</mi>
     </mrow>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mi>k</mi>
       <mo>+</mo>
       <mn>4</mn>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>C</ci>
      <ci>M</ci>
     </apply>
     <ci>k</ci>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <apply>
       <ci>normal-⋅</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>w</ci>
        <cn type="integer">1</cn>
       </apply>
       <ci>P</ci>
      </apply>
      <ci>k</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <ci>normal-⋅</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>w</ci>
        <cn type="integer">2</cn>
       </apply>
       <ci>P</ci>
      </apply>
      <apply>
       <plus></plus>
       <ci>k</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <ci>normal-⋅</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>w</ci>
        <cn type="integer">3</cn>
       </apply>
       <ci>P</ci>
      </apply>
      <apply>
       <plus></plus>
       <ci>k</ci>
       <cn type="integer">4</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   C_{M}(k)=w_{1}\cdot P(k)+w_{2}\cdot P(k+1)+w_{3}\cdot P(k+4)
  </annotation>
 </semantics>
</math>

</p>

<p>where 

<math display="inline" id="Spiral_array_model:2">
 <semantics>
  <mrow>
   <msub>
    <mi>w</mi>
    <mn>1</mn>
   </msub>
   <mo>≥</mo>
   <msub>
    <mi>w</mi>
    <mn>2</mn>
   </msub>
   <mo>≥</mo>
   <msub>
    <mi>w</mi>
    <mn>3</mn>
   </msub>
   <mo>></mo>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <geq></geq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>w</ci>
      <cn type="integer">1</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>w</ci>
      <cn type="integer">2</cn>
     </apply>
    </apply>
    <apply>
     <geq></geq>
     <share href="#.cmml">
     </share>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>w</ci>
      <cn type="integer">3</cn>
     </apply>
    </apply>
    <apply>
     <gt></gt>
     <share href="#.cmml">
     </share>
     <cn type="integer">0</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   w_{1}\geq w_{2}\geq w_{3}>0
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Spiral_array_model:3">
 <semantics>
  <mrow>
   <mrow>
    <msubsup>
     <mo largeop="true" symmetric="true">∑</mo>
     <mrow>
      <mi>i</mi>
      <mo>=</mo>
      <mn>1</mn>
     </mrow>
     <mn>3</mn>
    </msubsup>
    <msub>
     <mi>w</mi>
     <mi>i</mi>
    </msub>
   </mrow>
   <mo>=</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <apply>
        <eq></eq>
        <ci>i</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <cn type="integer">3</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>w</ci>
      <ci>i</ci>
     </apply>
    </apply>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \sum_{i=1}^{3}w_{i}=1
  </annotation>
 </semantics>
</math>

</p>

<p>The weights "w" effect how close the center of effect are to the fundamental, major third, and perfect fifth of the chord. By changing the relative values of these weights, the spiral array model effects how "close" the resulting chord is to the three constituent pitches. Generally in western music, the fundamental is given the greatest weight in identifying the chord (w1), followed by the fifth (w2), followed by the third (w3).</p>

<p>The <strong>minor chord C<sub>m</sub></strong> is represented by:</p>

<p>

<math display="inline" id="Spiral_array_model:4">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>C</mi>
     <mi>m</mi>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>k</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mrow>
      <msub>
       <mi>u</mi>
       <mn>1</mn>
      </msub>
      <mo>⋅</mo>
      <mi>P</mi>
     </mrow>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>k</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>+</mo>
    <mrow>
     <mrow>
      <msub>
       <mi>u</mi>
       <mn>2</mn>
      </msub>
      <mo>⋅</mo>
      <mi>P</mi>
     </mrow>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mi>k</mi>
       <mo>+</mo>
       <mn>1</mn>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>+</mo>
    <mrow>
     <mrow>
      <msub>
       <mi>u</mi>
       <mn>3</mn>
      </msub>
      <mo>⋅</mo>
      <mi>P</mi>
     </mrow>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mi>k</mi>
       <mo>-</mo>
       <mn>3</mn>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>C</ci>
      <ci>m</ci>
     </apply>
     <ci>k</ci>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <apply>
       <ci>normal-⋅</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>u</ci>
        <cn type="integer">1</cn>
       </apply>
       <ci>P</ci>
      </apply>
      <ci>k</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <ci>normal-⋅</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>u</ci>
        <cn type="integer">2</cn>
       </apply>
       <ci>P</ci>
      </apply>
      <apply>
       <plus></plus>
       <ci>k</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <ci>normal-⋅</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>u</ci>
        <cn type="integer">3</cn>
       </apply>
       <ci>P</ci>
      </apply>
      <apply>
       <minus></minus>
       <ci>k</ci>
       <cn type="integer">3</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   C_{m}(k)=u_{1}\cdot P(k)+u_{2}\cdot P(k+1)+u_{3}\cdot P(k-3)
  </annotation>
 </semantics>
</math>

</p>

<p>where 

<math display="inline" id="Spiral_array_model:5">
 <semantics>
  <mrow>
   <msub>
    <mi>u</mi>
    <mn>1</mn>
   </msub>
   <mo>≥</mo>
   <msub>
    <mi>u</mi>
    <mn>2</mn>
   </msub>
   <mo>≥</mo>
   <msub>
    <mi>u</mi>
    <mn>3</mn>
   </msub>
   <mo>></mo>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <geq></geq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>u</ci>
      <cn type="integer">1</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>u</ci>
      <cn type="integer">2</cn>
     </apply>
    </apply>
    <apply>
     <geq></geq>
     <share href="#.cmml">
     </share>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>u</ci>
      <cn type="integer">3</cn>
     </apply>
    </apply>
    <apply>
     <gt></gt>
     <share href="#.cmml">
     </share>
     <cn type="integer">0</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   u_{1}\geq u_{2}\geq u_{3}>0
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Spiral_array_model:6">
 <semantics>
  <mrow>
   <mrow>
    <msubsup>
     <mo largeop="true" symmetric="true">∑</mo>
     <mrow>
      <mi>i</mi>
      <mo>=</mo>
      <mn>1</mn>
     </mrow>
     <mn>3</mn>
    </msubsup>
    <msub>
     <mi>u</mi>
     <mi>i</mi>
    </msub>
   </mrow>
   <mo>=</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <apply>
        <eq></eq>
        <ci>i</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <cn type="integer">3</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>u</ci>
      <ci>i</ci>
     </apply>
    </apply>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \sum_{i=1}^{3}u_{i}=1
  </annotation>
 </semantics>
</math>

</p>

<p>The weights "u" function similarly to the major chord.</p>

<p>The <strong>major key T<sub>M</sub></strong> is represented by:</p>

<p>

<math display="inline" id="Spiral_array_model:7">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>T</mi>
     <mi>M</mi>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>k</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mrow>
      <msub>
       <mi>W</mi>
       <mn>1</mn>
      </msub>
      <mo>⋅</mo>
      <mi>P</mi>
     </mrow>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>k</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>+</mo>
    <mrow>
     <mrow>
      <msub>
       <mi>W</mi>
       <mn>2</mn>
      </msub>
      <mo>⋅</mo>
      <mi>P</mi>
     </mrow>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mi>k</mi>
       <mo>+</mo>
       <mn>1</mn>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>+</mo>
    <mrow>
     <mrow>
      <msub>
       <mi>W</mi>
       <mn>3</mn>
      </msub>
      <mo>⋅</mo>
      <mi>P</mi>
     </mrow>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mi>k</mi>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>T</ci>
      <ci>M</ci>
     </apply>
     <ci>k</ci>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <apply>
       <ci>normal-⋅</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>W</ci>
        <cn type="integer">1</cn>
       </apply>
       <ci>P</ci>
      </apply>
      <ci>k</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <ci>normal-⋅</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>W</ci>
        <cn type="integer">2</cn>
       </apply>
       <ci>P</ci>
      </apply>
      <apply>
       <plus></plus>
       <ci>k</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <ci>normal-⋅</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>W</ci>
        <cn type="integer">3</cn>
       </apply>
       <ci>P</ci>
      </apply>
      <apply>
       <minus></minus>
       <ci>k</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   T_{M}(k)=W_{1}\cdot P(k)+W_{2}\cdot P(k+1)+W_{3}\cdot P(k-1)
  </annotation>
 </semantics>
</math>

</p>

<p>where 

<math display="inline" id="Spiral_array_model:8">
 <semantics>
  <mrow>
   <msub>
    <mi>W</mi>
    <mn>1</mn>
   </msub>
   <mo>≥</mo>
   <msub>
    <mi>W</mi>
    <mn>2</mn>
   </msub>
   <mo>≥</mo>
   <msub>
    <mi>W</mi>
    <mn>3</mn>
   </msub>
   <mo>></mo>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <geq></geq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>W</ci>
      <cn type="integer">1</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>W</ci>
      <cn type="integer">2</cn>
     </apply>
    </apply>
    <apply>
     <geq></geq>
     <share href="#.cmml">
     </share>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>W</ci>
      <cn type="integer">3</cn>
     </apply>
    </apply>
    <apply>
     <gt></gt>
     <share href="#.cmml">
     </share>
     <cn type="integer">0</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   W_{1}\geq W_{2}\geq W_{3}>0
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Spiral_array_model:9">
 <semantics>
  <mrow>
   <mrow>
    <msubsup>
     <mo largeop="true" symmetric="true">∑</mo>
     <mrow>
      <mi>i</mi>
      <mo>=</mo>
      <mn>1</mn>
     </mrow>
     <mn>3</mn>
    </msubsup>
    <msub>
     <mi>W</mi>
     <mi>i</mi>
    </msub>
   </mrow>
   <mo>=</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <apply>
        <eq></eq>
        <ci>i</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <cn type="integer">3</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>W</ci>
      <ci>i</ci>
     </apply>
    </apply>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \sum_{i=1}^{3}W_{i}=1
  </annotation>
 </semantics>
</math>

</p>

<p>Similar to the weights controlling how close constituent pitches are to the center of effect of the chord they produce, the weights "W" control the relative effect of the I, IV, and V chord in determining how close they are to the resultant key.</p>

<p>The <strong>minor key T<sub>m</sub></strong> is represented by:</p>

<p>

<math display="inline" id="Spiral_array_model:10">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>T</mi>
     <mi>m</mi>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>k</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mrow>
      <msub>
       <mi>V</mi>
       <mn>1</mn>
      </msub>
      <mo>⋅</mo>
      <msub>
       <mi>C</mi>
       <mi>M</mi>
      </msub>
     </mrow>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>k</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>+</mo>
    <mrow>
     <msub>
      <mi>V</mi>
      <mn>2</mn>
     </msub>
     <mo>⋅</mo>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mrow>
        <mrow>
         <mi>α</mi>
         <mo>⋅</mo>
         <msub>
          <mi>C</mi>
          <mi>M</mi>
         </msub>
        </mrow>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <mi>k</mi>
          <mo>+</mo>
          <mn>1</mn>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
       <mo>+</mo>
       <mrow>
        <mrow>
         <mrow>
          <mo stretchy="false">(</mo>
          <mrow>
           <mn>1</mn>
           <mo>-</mo>
           <mi>α</mi>
          </mrow>
          <mo stretchy="false">)</mo>
         </mrow>
         <mo>⋅</mo>
         <msub>
          <mi>C</mi>
          <mi>m</mi>
         </msub>
        </mrow>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <mi>k</mi>
          <mo>+</mo>
          <mn>1</mn>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>+</mo>
    <mrow>
     <msub>
      <mi>V</mi>
      <mn>3</mn>
     </msub>
     <mo>⋅</mo>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mrow>
        <mrow>
         <mi>β</mi>
         <mo>*</mo>
         <msub>
          <mi>C</mi>
          <mi>m</mi>
         </msub>
        </mrow>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <mi>k</mi>
          <mo>-</mo>
          <mn>1</mn>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
       <mo>+</mo>
       <mrow>
        <mrow>
         <mrow>
          <mo stretchy="false">(</mo>
          <mrow>
           <mn>1</mn>
           <mo>-</mo>
           <mi>β</mi>
          </mrow>
          <mo stretchy="false">)</mo>
         </mrow>
         <mo>⋅</mo>
         <msub>
          <mi>C</mi>
          <mi>M</mi>
         </msub>
        </mrow>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <mi>k</mi>
          <mo>-</mo>
          <mn>1</mn>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>T</ci>
      <ci>m</ci>
     </apply>
     <ci>k</ci>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <apply>
       <ci>normal-⋅</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>V</ci>
        <cn type="integer">1</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>C</ci>
        <ci>M</ci>
       </apply>
      </apply>
      <ci>k</ci>
     </apply>
     <apply>
      <ci>normal-⋅</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>V</ci>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <plus></plus>
       <apply>
        <times></times>
        <apply>
         <ci>normal-⋅</ci>
         <ci>α</ci>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>C</ci>
          <ci>M</ci>
         </apply>
        </apply>
        <apply>
         <plus></plus>
         <ci>k</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <apply>
        <times></times>
        <apply>
         <ci>normal-⋅</ci>
         <apply>
          <minus></minus>
          <cn type="integer">1</cn>
          <ci>α</ci>
         </apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>C</ci>
          <ci>m</ci>
         </apply>
        </apply>
        <apply>
         <plus></plus>
         <ci>k</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <ci>normal-⋅</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>V</ci>
       <cn type="integer">3</cn>
      </apply>
      <apply>
       <plus></plus>
       <apply>
        <times></times>
        <apply>
         <times></times>
         <ci>β</ci>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>C</ci>
          <ci>m</ci>
         </apply>
        </apply>
        <apply>
         <minus></minus>
         <ci>k</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <apply>
        <times></times>
        <apply>
         <ci>normal-⋅</ci>
         <apply>
          <minus></minus>
          <cn type="integer">1</cn>
          <ci>β</ci>
         </apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>C</ci>
          <ci>M</ci>
         </apply>
        </apply>
        <apply>
         <minus></minus>
         <ci>k</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   T_{m}(k)=V_{1}\cdot C_{M}(k)+V_{2}\cdot(\alpha\cdot C_{M}(k+1)+(1-\alpha)\cdot
C%
_{m}(k+1))+V_{3}\cdot(\beta*C_{m}(k-1)+(1-\beta)\cdot C_{M}(k-1))
  </annotation>
 </semantics>
</math>

</p>

<p>where 

<math display="inline" id="Spiral_array_model:11">
 <semantics>
  <mrow>
   <msub>
    <mi>V</mi>
    <mn>1</mn>
   </msub>
   <mo>≥</mo>
   <msub>
    <mi>V</mi>
    <mn>2</mn>
   </msub>
   <mo>≥</mo>
   <msub>
    <mi>V</mi>
    <mn>3</mn>
   </msub>
   <mo>></mo>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <geq></geq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>V</ci>
      <cn type="integer">1</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>V</ci>
      <cn type="integer">2</cn>
     </apply>
    </apply>
    <apply>
     <geq></geq>
     <share href="#.cmml">
     </share>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>V</ci>
      <cn type="integer">3</cn>
     </apply>
    </apply>
    <apply>
     <gt></gt>
     <share href="#.cmml">
     </share>
     <cn type="integer">0</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   V_{1}\geq V_{2}\geq V_{3}>0
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Spiral_array_model:12">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>V</mi>
     <mn>1</mn>
    </msub>
    <mo>+</mo>
    <msub>
     <mi>V</mi>
     <mn>2</mn>
    </msub>
    <mo>+</mo>
    <msub>
     <mi>V</mi>
     <mn>3</mn>
    </msub>
   </mrow>
   <mo>=</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <plus></plus>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>V</ci>
      <cn type="integer">1</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>V</ci>
      <cn type="integer">2</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>V</ci>
      <cn type="integer">3</cn>
     </apply>
    </apply>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   V_{1}+V_{2}+V_{3}=1
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Spiral_array_model:13">
 <semantics>
  <mrow>
   <mn>0</mn>
   <mo>≥</mo>
   <mi>α</mi>
   <mo>≥</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <geq></geq>
     <cn type="integer">0</cn>
     <ci>α</ci>
    </apply>
    <apply>
     <geq></geq>
     <share href="#.cmml">
     </share>
     <cn type="integer">1</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   0\geq\alpha\geq 1
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Spiral_array_model:14">
 <semantics>
  <mrow>
   <mi>β</mi>
   <mo>≥</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <geq></geq>
    <ci>β</ci>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \beta\geq 1
  </annotation>
 </semantics>
</math>

.</p>
<h2 id="references">References</h2>
<ul>
<li>Chuan, C.-H., Chew, E. (2005). Applying the Spiral Array Key-finding Algorithm to Polyphonic Audio. In Proceedings of the 9th INFORMS Computing Society Conference (invited sessions on Music, Computation and AI), Annapolis, MD, Jan 5-7, 2005.</li>
<li>Chew, Elaine (2002). <a href="http://www-rcf.usc.edu/~echew/papers/ICMAI2/ec-icmai.pdf">The Spiral Array: An Algorithm for Determining Key Boundaries</a></li>
<li>Chew, Elaine (2000). Towards a Mathematical Model of Tonality. Ph.D. dissertation. Operations Research Center, MIT. Cambridge, MA.</li>
</ul>

<p>"</p>

<p><a href="Category:Pitch_space" title="wikilink">Category:Pitch space</a></p>
</body>
</html>

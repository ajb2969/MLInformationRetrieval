<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="496">Forward–backward algorithm</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Forward–backward algorithm</h1>
<style>
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
<style>
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
  </style>
</body></html>
<body>
<hr/>

<p>The <strong>forward–backward algorithm</strong> is an <a class="uri" href="inference" title="wikilink">inference</a> <a class="uri" href="algorithm" title="wikilink">algorithm</a> for <a href="hidden_Markov_models" title="wikilink">hidden Markov models</a> which computes the <a href="posterior_probability" title="wikilink">posterior</a> <a href="marginal_probability" title="wikilink">marginals</a> of all hidden state variables given a sequence of observations/emissions 

<math display="inline" id="Forward–backward_algorithm:0">
 <semantics>
  <mrow>
   <msub>
    <mi>o</mi>
    <mrow>
     <mn>1</mn>
     <mo>:</mo>
     <mi>t</mi>
    </mrow>
   </msub>
   <mo>:=</mo>
   <mrow>
    <msub>
     <mi>o</mi>
     <mn>1</mn>
    </msub>
    <mo>,</mo>
    <mi mathvariant="normal">…</mi>
    <mo>,</mo>
    <msub>
     <mi>o</mi>
     <mi>t</mi>
    </msub>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">assign</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>o</ci>
     <apply>
      <ci>normal-:</ci>
      <cn type="integer">1</cn>
      <ci>t</ci>
     </apply>
    </apply>
    <list>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>o</ci>
      <cn type="integer">1</cn>
     </apply>
     <ci>normal-…</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>o</ci>
      <ci>t</ci>
     </apply>
    </list>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   o_{1:t}:=o_{1},\dots,o_{t}
  </annotation>
 </semantics>
</math>

, i.e. it computes, for all hidden state variables 

<math display="inline" id="Forward–backward_algorithm:1">
 <semantics>
  <mrow>
   <msub>
    <mi>X</mi>
    <mi>k</mi>
   </msub>
   <mo>∈</mo>
   <mrow>
    <mo stretchy="false">{</mo>
    <msub>
     <mi>X</mi>
     <mn>1</mn>
    </msub>
    <mo>,</mo>
    <mi mathvariant="normal">…</mi>
    <mo>,</mo>
    <msub>
     <mi>X</mi>
     <mi>t</mi>
    </msub>
    <mo stretchy="false">}</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <in></in>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>X</ci>
     <ci>k</ci>
    </apply>
    <set>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>X</ci>
      <cn type="integer">1</cn>
     </apply>
     <ci>normal-…</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>X</ci>
      <ci>t</ci>
     </apply>
    </set>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   X_{k}\in\{X_{1},\dots,X_{t}\}
  </annotation>
 </semantics>
</math>

, the distribution 

<math display="inline" id="Forward–backward_algorithm:2">
 <semantics>
  <mrow>
   <mi>P</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mpadded width="+5pt">
     <msub>
      <mi>X</mi>
      <mi>k</mi>
     </msub>
    </mpadded>
    <mo rspace="7.5pt" stretchy="false">|</mo>
    <msub>
     <mi>o</mi>
     <mrow>
      <mn>1</mn>
      <mo>:</mo>
      <mi>t</mi>
     </mrow>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">P</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>X</ci>
      <ci>k</ci>
     </apply>
     <ci>normal-|</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>o</ci>
      <apply>
       <ci>normal-:</ci>
       <cn type="integer">1</cn>
       <ci>t</ci>
      </apply>
     </apply>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   P(X_{k}\ |\ o_{1:t})
  </annotation>
 </semantics>
</math>

. This inference task is usually called <em>smoothing</em>. The algorithm makes use of the principle of <a href="dynamic_programming" title="wikilink">dynamic programming</a> to compute efficiently the values that are required to obtain the posterior marginal distributions in two passes. The first pass goes forward in time while the second goes backward in time; hence the name <em>forward–backward algorithm</em>.</p>

<p>The term <em>forward–backward algorithm</em> is also used to refer to any algorithm belonging to the general class of algorithms that operate on sequence models in a forward–backward manner. In this sense, the descriptions in the remainder of this article refer but to one specific instance of this class.</p>
<h2 id="overview">Overview</h2>

<p>In the first pass, the forward–backward algorithm computes a set of forward probabilities which provide, for all 

<math display="inline" id="Forward–backward_algorithm:3">
 <semantics>
  <mrow>
   <mi>k</mi>
   <mo>∈</mo>
   <mrow>
    <mo stretchy="false">{</mo>
    <mn>1</mn>
    <mo>,</mo>
    <mi mathvariant="normal">…</mi>
    <mo>,</mo>
    <mi>t</mi>
    <mo stretchy="false">}</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <in></in>
    <ci>k</ci>
    <set>
     <cn type="integer">1</cn>
     <ci>normal-…</ci>
     <ci>t</ci>
    </set>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   k\in\{1,\dots,t\}
  </annotation>
 </semantics>
</math>

, the probability of ending up in any particular state given the first 

<math display="inline" id="Forward–backward_algorithm:4">
 <semantics>
  <mi>k</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>k</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   k
  </annotation>
 </semantics>
</math>

 observations in the sequence, i.e. 

<math display="inline" id="Forward–backward_algorithm:5">
 <semantics>
  <mrow>
   <mi>P</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mpadded width="+5pt">
     <msub>
      <mi>X</mi>
      <mi>k</mi>
     </msub>
    </mpadded>
    <mo rspace="7.5pt" stretchy="false">|</mo>
    <msub>
     <mi>o</mi>
     <mrow>
      <mn>1</mn>
      <mo>:</mo>
      <mi>k</mi>
     </mrow>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">P</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>X</ci>
      <ci>k</ci>
     </apply>
     <ci>normal-|</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>o</ci>
      <apply>
       <ci>normal-:</ci>
       <cn type="integer">1</cn>
       <ci>k</ci>
      </apply>
     </apply>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   P(X_{k}\ |\ o_{1:k})
  </annotation>
 </semantics>
</math>

. In the second pass, the algorithm computes a set of backward probabilities which provide the probability of observing the remaining observations given any starting point 

<math display="inline" id="Forward–backward_algorithm:6">
 <semantics>
  <mi>k</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>k</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   k
  </annotation>
 </semantics>
</math>

, i.e. 

<math display="inline" id="Forward–backward_algorithm:7">
 <semantics>
  <mrow>
   <mi>P</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mpadded width="+5pt">
     <msub>
      <mi>o</mi>
      <mrow>
       <mrow>
        <mi>k</mi>
        <mo>+</mo>
        <mn>1</mn>
       </mrow>
       <mo>:</mo>
       <mi>t</mi>
      </mrow>
     </msub>
    </mpadded>
    <mo rspace="7.5pt" stretchy="false">|</mo>
    <msub>
     <mi>X</mi>
     <mi>k</mi>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">P</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>o</ci>
      <apply>
       <ci>normal-:</ci>
       <apply>
        <plus></plus>
        <ci>k</ci>
        <cn type="integer">1</cn>
       </apply>
       <ci>t</ci>
      </apply>
     </apply>
     <ci>normal-|</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>X</ci>
      <ci>k</ci>
     </apply>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   P(o_{k+1:t}\ |\ X_{k})
  </annotation>
 </semantics>
</math>

. These two sets of probability distributions can then be combined to obtain the distribution over states at any specific point in time given the entire observation sequence:</p>

<p>

<math display="block" id="Forward–backward_algorithm:8">
 <semantics>
  <mrow>
   <mi>P</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mpadded width="+5pt">
     <msub>
      <mi>X</mi>
      <mi>k</mi>
     </msub>
    </mpadded>
    <mo rspace="7.5pt" stretchy="false">|</mo>
    <msub>
     <mi>o</mi>
     <mrow>
      <mn>1</mn>
      <mo>:</mo>
      <mi>t</mi>
     </mrow>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>=</mo>
   <mi>P</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mpadded width="+5pt">
     <msub>
      <mi>X</mi>
      <mi>k</mi>
     </msub>
    </mpadded>
    <mo rspace="7.5pt" stretchy="false">|</mo>
    <msub>
     <mi>o</mi>
     <mrow>
      <mn>1</mn>
      <mo>:</mo>
      <mi>k</mi>
     </mrow>
    </msub>
    <mo>,</mo>
    <msub>
     <mi>o</mi>
     <mrow>
      <mrow>
       <mi>k</mi>
       <mo>+</mo>
       <mn>1</mn>
      </mrow>
      <mo>:</mo>
      <mi>t</mi>
     </mrow>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>∝</mo>
   <mi>P</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mpadded width="+5pt">
     <msub>
      <mi>o</mi>
      <mrow>
       <mrow>
        <mi>k</mi>
        <mo>+</mo>
        <mn>1</mn>
       </mrow>
       <mo>:</mo>
       <mi>t</mi>
      </mrow>
     </msub>
    </mpadded>
    <mo rspace="7.5pt" stretchy="false">|</mo>
    <msub>
     <mi>X</mi>
     <mi>k</mi>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
   <mi>P</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mpadded width="+5pt">
     <msub>
      <mi>X</mi>
      <mi>k</mi>
     </msub>
    </mpadded>
    <mo rspace="7.5pt" stretchy="false">|</mo>
    <msub>
     <mi>o</mi>
     <mrow>
      <mn>1</mn>
      <mo>:</mo>
      <mi>k</mi>
     </mrow>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">P</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>X</ci>
      <ci>k</ci>
     </apply>
     <ci>normal-|</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>o</ci>
      <apply>
       <ci>normal-:</ci>
       <cn type="integer">1</cn>
       <ci>t</ci>
      </apply>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <eq></eq>
    <csymbol cd="unknown">P</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>X</ci>
      <ci>k</ci>
     </apply>
     <ci>normal-|</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>o</ci>
      <apply>
       <ci>normal-:</ci>
       <cn type="integer">1</cn>
       <ci>k</ci>
      </apply>
     </apply>
     <ci>normal-,</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>o</ci>
      <apply>
       <ci>normal-:</ci>
       <apply>
        <plus></plus>
        <ci>k</ci>
        <cn type="integer">1</cn>
       </apply>
       <ci>t</ci>
      </apply>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <csymbol cd="latexml">proportional-to</csymbol>
    <csymbol cd="unknown">P</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>o</ci>
      <apply>
       <ci>normal-:</ci>
       <apply>
        <plus></plus>
        <ci>k</ci>
        <cn type="integer">1</cn>
       </apply>
       <ci>t</ci>
      </apply>
     </apply>
     <ci>normal-|</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>X</ci>
      <ci>k</ci>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <csymbol cd="unknown">P</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>X</ci>
      <ci>k</ci>
     </apply>
     <ci>normal-|</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>o</ci>
      <apply>
       <ci>normal-:</ci>
       <cn type="integer">1</cn>
       <ci>k</ci>
      </apply>
     </apply>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   P(X_{k}\ |\ o_{1:t})=P(X_{k}\ |\ o_{1:k},o_{k+1:t})\propto P(o_{k+1:t}\ |\ X_{%
k})P(X_{k}\ |\ o_{1:k})
  </annotation>
 </semantics>
</math>

</p>

<p>The last step follows from an application of the <a href="Bayes'_rule" title="wikilink">Bayes' rule</a> and the <a href="conditional_independence" title="wikilink">conditional independence</a> of 

<math display="inline" id="Forward–backward_algorithm:9">
 <semantics>
  <msub>
   <mi>o</mi>
   <mrow>
    <mrow>
     <mi>k</mi>
     <mo>+</mo>
     <mn>1</mn>
    </mrow>
    <mo>:</mo>
    <mi>t</mi>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>o</ci>
    <apply>
     <ci>normal-:</ci>
     <apply>
      <plus></plus>
      <ci>k</ci>
      <cn type="integer">1</cn>
     </apply>
     <ci>t</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   o_{k+1:t}
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Forward–backward_algorithm:10">
 <semantics>
  <msub>
   <mi>o</mi>
   <mrow>
    <mn>1</mn>
    <mo>:</mo>
    <mi>k</mi>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>o</ci>
    <apply>
     <ci>normal-:</ci>
     <cn type="integer">1</cn>
     <ci>k</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   o_{1:k}
  </annotation>
 </semantics>
</math>

 given 

<math display="inline" id="Forward–backward_algorithm:11">
 <semantics>
  <msub>
   <mi>X</mi>
   <mi>k</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>X</ci>
    <ci>k</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   X_{k}
  </annotation>
 </semantics>
</math>

.</p>

<p>As outlined above, the algorithm involves three steps:</p>
<ol>
<li>computing forward probabilities</li>
<li>computing backward probabilities</li>
<li>computing smoothed values.</li>
</ol>

<p>The forward and backward steps may also be called "forward message pass" and "backward message pass" - these terms are due to the <em>message-passing</em> used in general <a href="belief_propagation" title="wikilink">belief propagation</a> approaches. At each single observation in the sequence, probabilities to be used for calculations at the next observation are computed. The smoothing step can be calculated simultaneously during the backward pass. This step allows the algorithm to take into account any past observations of output for computing more accurate results.</p>

<p>The forward–backward algorithm can be used to find the most likely state for any point in time. It cannot, however, be used to find the most likely sequence of states (see <a href="Viterbi_algorithm" title="wikilink">Viterbi algorithm</a>).</p>
<h2 id="forward-probabilities">Forward probabilities</h2>

<p>The following description will use matrices of probability values rather than probability distributions, although in general the forward-backward algorithm can be applied to continuous as well as discrete probability models.</p>

<p>We transform the probability distributions related to a given <a href="hidden_Markov_model" title="wikilink">hidden Markov model</a> into matrix notation as follows. The transition probabilities 

<math display="inline" id="Forward–backward_algorithm:12">
 <semantics>
  <mrow>
   <mi>𝐏</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>X</mi>
     <mi>t</mi>
    </msub>
    <mo>∣</mo>
    <msub>
     <mi>X</mi>
     <mrow>
      <mi>t</mi>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">P</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>X</ci>
      <ci>t</ci>
     </apply>
     <ci>normal-∣</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>X</ci>
      <apply>
       <minus></minus>
       <ci>t</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{P}(X_{t}\mid X_{t-1})
  </annotation>
 </semantics>
</math>

 of a given random variable 

<math display="inline" id="Forward–backward_algorithm:13">
 <semantics>
  <msub>
   <mi>X</mi>
   <mi>t</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>X</ci>
    <ci>t</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   X_{t}
  </annotation>
 </semantics>
</math>

 representing all possible states in the hidden Markov model will be represented by the matrix 

<math display="inline" id="Forward–backward_algorithm:14">
 <semantics>
  <mi>𝐓</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>𝐓</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{T}
  </annotation>
 </semantics>
</math>

 where the row index, i, will represent the start state and the column index, j, represents the target state. The example below represents a system where the probability of staying in the same state after each step is 70% and the probability of transitioning to the other state is 30%. The transition matrix is then:</p>

<p>

<math display="block" id="Forward–backward_algorithm:15">
 <semantics>
  <mrow>
   <mi>𝐓</mi>
   <mo>=</mo>
   <mrow>
    <mo>(</mo>
    <mtable displaystyle="true">
     <mtr>
      <mtd columnalign="center">
       <mn>0.7</mn>
      </mtd>
      <mtd columnalign="center">
       <mn>0.3</mn>
      </mtd>
     </mtr>
     <mtr>
      <mtd columnalign="center">
       <mn>0.3</mn>
      </mtd>
      <mtd columnalign="center">
       <mn>0.7</mn>
      </mtd>
     </mtr>
    </mtable>
    <mo>)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>𝐓</ci>
    <matrix>
     <matrixrow>
      <cn type="float">0.7</cn>
      <cn type="float">0.3</cn>
     </matrixrow>
     <matrixrow>
      <cn type="float">0.3</cn>
      <cn type="float">0.7</cn>
     </matrixrow>
    </matrix>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{T}=\begin{pmatrix}0.7&0.3\\
0.3&0.7\end{pmatrix}
  </annotation>
 </semantics>
</math>

</p>

<p>In a typical Markov model we would multiply a state vector by this matrix to obtain the probabilities for the subsequent state. In a hidden Markov model the state is unknown, and we instead observe events associated with the possible states. An event matrix of the form:</p>

<p>

<math display="block" id="Forward–backward_algorithm:16">
 <semantics>
  <mrow>
   <mi>𝐁</mi>
   <mo>=</mo>
   <mrow>
    <mo>(</mo>
    <mtable displaystyle="true">
     <mtr>
      <mtd columnalign="center">
       <mn>0.9</mn>
      </mtd>
      <mtd columnalign="center">
       <mn>0.1</mn>
      </mtd>
     </mtr>
     <mtr>
      <mtd columnalign="center">
       <mn>0.2</mn>
      </mtd>
      <mtd columnalign="center">
       <mn>0.8</mn>
      </mtd>
     </mtr>
    </mtable>
    <mo>)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>𝐁</ci>
    <matrix>
     <matrixrow>
      <cn type="float">0.9</cn>
      <cn type="float">0.1</cn>
     </matrixrow>
     <matrixrow>
      <cn type="float">0.2</cn>
      <cn type="float">0.8</cn>
     </matrixrow>
    </matrix>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{B}=\begin{pmatrix}0.9&0.1\\
0.2&0.8\end{pmatrix}
  </annotation>
 </semantics>
</math>

</p>

<p>provides the probabilities for observing events given a particular state. In the above example, event 1 will be observed 90% of the time if we are in state 1 while event 2 has a 10% probability of occurring in this state. In contrast, event 1 will only be observed 20% of the time if we are in state 2 and event 2 has an 80% chance of occurring. Given a state vector (

<math display="inline" id="Forward–backward_algorithm:17">
 <semantics>
  <mi>π</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>π</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{\pi}
  </annotation>
 </semantics>
</math>

), the probability of observing event j is then:</p>

<p>

<math display="block" id="Forward–backward_algorithm:18">
 <semantics>
  <mrow>
   <mi>𝐏</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>O</mi>
    <mo>=</mo>
    <mi>j</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>=</mo>
   <munder>
    <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
    <mi>i</mi>
   </munder>
   <msub>
    <mi>π</mi>
    <mi>i</mi>
   </msub>
   <msub>
    <mi>b</mi>
    <mrow>
     <mi>i</mi>
     <mo>,</mo>
     <mi>j</mi>
    </mrow>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">P</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">O</csymbol>
     <eq></eq>
     <csymbol cd="unknown">j</csymbol>
     <ci>normal-)</ci>
    </cerror>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <sum></sum>
     <ci>i</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>π</ci>
     <ci>i</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>b</ci>
     <list>
      <ci>i</ci>
      <ci>j</ci>
     </list>
    </apply>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{P}(O=j)=\sum_{i}\pi_{i}b_{i,j}
  </annotation>
 </semantics>
</math>

</p>

<p>This can be represented in matrix form by multiplying the state vector (

<math display="inline" id="Forward–backward_algorithm:19">
 <semantics>
  <mi>π</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>π</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{\pi}
  </annotation>
 </semantics>
</math>

) by an observation matrix (

<math display="inline" id="Forward–backward_algorithm:20">
 <semantics>
  <mrow>
   <msub>
    <mi>𝐎</mi>
    <mi>𝐣</mi>
   </msub>
   <mo>=</mo>
   <mrow>
    <mi>diag</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <msub>
      <mi>b</mi>
      <mrow>
       <mo>*</mo>
       <mo>,</mo>
       <msub>
        <mi>o</mi>
        <mi>j</mi>
       </msub>
      </mrow>
     </msub>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>𝐎</ci>
     <ci>𝐣</ci>
    </apply>
    <apply>
     <times></times>
     <ci>diag</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>b</ci>
      <list>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>o</ci>
        <ci>j</ci>
       </apply>
      </list>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{O_{j}}=\mathrm{diag}(b_{*,o_{j}})
  </annotation>
 </semantics>
</math>

) containing only diagonal entries. Each entry is the probability of the observed event given each state. Continuing the above example, an observation of event 1 would be:</p>

<p>

<math display="block" id="Forward–backward_algorithm:21">
 <semantics>
  <mrow>
   <msub>
    <mi>𝐎</mi>
    <mn>𝟏</mn>
   </msub>
   <mo>=</mo>
   <mrow>
    <mo>(</mo>
    <mtable displaystyle="true">
     <mtr>
      <mtd columnalign="center">
       <mn>0.9</mn>
      </mtd>
      <mtd columnalign="center">
       <mn>0.0</mn>
      </mtd>
     </mtr>
     <mtr>
      <mtd columnalign="center">
       <mn>0.0</mn>
      </mtd>
      <mtd columnalign="center">
       <mn>0.2</mn>
      </mtd>
     </mtr>
    </mtable>
    <mo>)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>𝐎</ci>
     <cn type="integer">1</cn>
    </apply>
    <matrix>
     <matrixrow>
      <cn type="float">0.9</cn>
      <cn type="float">0.0</cn>
     </matrixrow>
     <matrixrow>
      <cn type="float">0.0</cn>
      <cn type="float">0.2</cn>
     </matrixrow>
    </matrix>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{O_{1}}=\begin{pmatrix}0.9&0.0\\
0.0&0.2\end{pmatrix}
  </annotation>
 </semantics>
</math>

</p>

<p>This allows us to calculate the probabilities associated with transitioning to a new state and observing the given event as:</p>

<p>

<math display="block" id="Forward–backward_algorithm:22">
 <semantics>
  <mrow>
   <msub>
    <mi>𝐟</mi>
    <mrow>
     <mn>𝟎</mn>
     <mo>:</mo>
     <mn>𝟏</mn>
    </mrow>
   </msub>
   <mo>=</mo>
   <mrow>
    <mi>π</mi>
    <msub>
     <mi>𝐎</mi>
     <mn>𝟏</mn>
    </msub>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>𝐟</ci>
     <apply>
      <ci>normal-:</ci>
      <cn type="integer">0</cn>
      <cn type="integer">1</cn>
     </apply>
    </apply>
    <apply>
     <times></times>
     <ci>π</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>𝐎</ci>
      <cn type="integer">1</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{f_{0:1}}=\mathbf{\pi}\mathbf{O_{1}}
  </annotation>
 </semantics>
</math>

</p>

<p>The probability vector that results contains entries indicating the probability of transitioning to each state and observing the given event. This process can be carried forward with additional observations using:</p>

<p>

<math display="block" id="Forward–backward_algorithm:23">
 <semantics>
  <mrow>
   <msub>
    <mi>𝐟</mi>
    <mrow>
     <mn>𝟎</mn>
     <mo>:</mo>
     <mi>𝐭</mi>
    </mrow>
   </msub>
   <mo>=</mo>
   <mrow>
    <msub>
     <mi>𝐟</mi>
     <mrow>
      <mn>𝟎</mn>
      <mo>:</mo>
      <mrow>
       <mi>𝐭</mi>
       <mo>-</mo>
       <mn>𝟏</mn>
      </mrow>
     </mrow>
    </msub>
    <msub>
     <mi>𝐓𝐎</mi>
     <mi>𝐭</mi>
    </msub>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>𝐟</ci>
     <apply>
      <ci>normal-:</ci>
      <cn type="integer">0</cn>
      <ci>𝐭</ci>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>𝐟</ci>
      <apply>
       <ci>normal-:</ci>
       <cn type="integer">0</cn>
       <apply>
        <minus></minus>
        <ci>𝐭</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>𝐓𝐎</ci>
      <ci>𝐭</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{f_{0:t}}=\mathbf{f_{0:t-1}}\mathbf{T}\mathbf{O_{t}}
  </annotation>
 </semantics>
</math>

</p>

<p>This value is the forward probability vector. The i'th entry of this vector provides:</p>

<p>

<math display="block" id="Forward–backward_algorithm:24">
 <semantics>
  <mrow>
   <msub>
    <mi>𝐟</mi>
    <mrow>
     <mn>𝟎</mn>
     <mo>:</mo>
     <mi>𝐭</mi>
    </mrow>
   </msub>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>i</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>=</mo>
   <mi>𝐏</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>o</mi>
     <mn>1</mn>
    </msub>
    <mo>,</mo>
    <msub>
     <mi>o</mi>
     <mn>2</mn>
    </msub>
    <mo>,</mo>
    <mi mathvariant="normal">…</mi>
    <mo>,</mo>
    <msub>
     <mi>o</mi>
     <mi>t</mi>
    </msub>
    <mo>,</mo>
    <msub>
     <mi>X</mi>
     <mi>t</mi>
    </msub>
    <mo>=</mo>
    <msub>
     <mi>x</mi>
     <mi>i</mi>
    </msub>
    <mo stretchy="false">|</mo>
    <mi>π</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>𝐟</ci>
     <apply>
      <ci>normal-:</ci>
      <cn type="integer">0</cn>
      <ci>𝐭</ci>
     </apply>
    </apply>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">i</csymbol>
     <ci>normal-)</ci>
    </cerror>
    <eq></eq>
    <csymbol cd="unknown">P</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>o</ci>
      <cn type="integer">1</cn>
     </apply>
     <ci>normal-,</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>o</ci>
      <cn type="integer">2</cn>
     </apply>
     <ci>normal-,</ci>
     <ci>normal-…</ci>
     <ci>normal-,</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>o</ci>
      <ci>t</ci>
     </apply>
     <ci>normal-,</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>X</ci>
      <ci>t</ci>
     </apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <ci>i</ci>
     </apply>
     <ci>normal-|</ci>
     <csymbol cd="unknown">π</csymbol>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{f_{0:t}}(i)=\mathbf{P}(o_{1},o_{2},\dots,o_{t},X_{t}=x_{i}|\mathbf{\pi})
  </annotation>
 </semantics>
</math>

</p>

<p>Typically, we will normalize the probability vector at each step so that its entries sum to 1. A scaling factor is thus introduced at each step such that:</p>

<p>

<math display="block" id="Forward–backward_algorithm:25">
 <semantics>
  <mrow>
   <msub>
    <mover accent="true">
     <mi>𝐟</mi>
     <mo stretchy="false">^</mo>
    </mover>
    <mrow>
     <mn>𝟎</mn>
     <mo>:</mo>
     <mi>𝐭</mi>
    </mrow>
   </msub>
   <mo>=</mo>
   <mrow>
    <mpadded width="+5pt">
     <msubsup>
      <mi>c</mi>
      <mi>t</mi>
      <mrow>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
     </msubsup>
    </mpadded>
    <msub>
     <mover accent="true">
      <mi>𝐟</mi>
      <mo stretchy="false">^</mo>
     </mover>
     <mrow>
      <mn>𝟎</mn>
      <mo>:</mo>
      <mrow>
       <mi>𝐭</mi>
       <mo>-</mo>
       <mn>𝟏</mn>
      </mrow>
     </mrow>
    </msub>
    <msub>
     <mi>𝐓𝐎</mi>
     <mi>𝐭</mi>
    </msub>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <ci>normal-^</ci>
      <ci>𝐟</ci>
     </apply>
     <apply>
      <ci>normal-:</ci>
      <cn type="integer">0</cn>
      <ci>𝐭</ci>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>c</ci>
       <ci>t</ci>
      </apply>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <ci>normal-^</ci>
       <ci>𝐟</ci>
      </apply>
      <apply>
       <ci>normal-:</ci>
       <cn type="integer">0</cn>
       <apply>
        <minus></minus>
        <ci>𝐭</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>𝐓𝐎</ci>
      <ci>𝐭</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{\hat{f}_{0:t}}=c_{t}^{-1}\ \mathbf{\hat{f}_{0:t-1}}\mathbf{T}\mathbf{O%
_{t}}
  </annotation>
 </semantics>
</math>

</p>

<p>where 

<math display="inline" id="Forward–backward_algorithm:26">
 <semantics>
  <msub>
   <mover accent="true">
    <mi>𝐟</mi>
    <mo stretchy="false">^</mo>
   </mover>
   <mrow>
    <mn>𝟎</mn>
    <mo>:</mo>
    <mrow>
     <mi>𝐭</mi>
     <mo>-</mo>
     <mn>𝟏</mn>
    </mrow>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <apply>
     <ci>normal-^</ci>
     <ci>𝐟</ci>
    </apply>
    <apply>
     <ci>normal-:</ci>
     <cn type="integer">0</cn>
     <apply>
      <minus></minus>
      <ci>𝐭</ci>
      <cn type="integer">1</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{\hat{f}_{0:t-1}}
  </annotation>
 </semantics>
</math>

 represents the scaled vector from the previous step and 

<math display="inline" id="Forward–backward_algorithm:27">
 <semantics>
  <msub>
   <mi>c</mi>
   <mi>t</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>c</ci>
    <ci>t</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   c_{t}
  </annotation>
 </semantics>
</math>

 represents the scaling factor that causes the resulting vector's entries to sum to 1. The product of the scaling factors is the total probability for observing the given events irrespective of the final states:</p>

<p>

<math display="block" id="Forward–backward_algorithm:28">
 <semantics>
  <mrow>
   <mi>𝐏</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>o</mi>
     <mn>1</mn>
    </msub>
    <mo>,</mo>
    <msub>
     <mi>o</mi>
     <mn>2</mn>
    </msub>
    <mo>,</mo>
    <mi mathvariant="normal">…</mi>
    <mo>,</mo>
    <msub>
     <mi>o</mi>
     <mi>t</mi>
    </msub>
    <mo stretchy="false">|</mo>
    <mi>π</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>=</mo>
   <munderover>
    <mo largeop="true" movablelimits="false" symmetric="true">∏</mo>
    <mrow>
     <mi>s</mi>
     <mo>=</mo>
     <mn>1</mn>
    </mrow>
    <mi>t</mi>
   </munderover>
   <msub>
    <mi>c</mi>
    <mi>s</mi>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">P</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>o</ci>
      <cn type="integer">1</cn>
     </apply>
     <ci>normal-,</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>o</ci>
      <cn type="integer">2</cn>
     </apply>
     <ci>normal-,</ci>
     <ci>normal-…</ci>
     <ci>normal-,</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>o</ci>
      <ci>t</ci>
     </apply>
     <ci>normal-|</ci>
     <csymbol cd="unknown">π</csymbol>
     <ci>normal-)</ci>
    </cerror>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <csymbol cd="latexml">product</csymbol>
      <apply>
       <eq></eq>
       <ci>s</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <ci>t</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>c</ci>
     <ci>s</ci>
    </apply>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{P}(o_{1},o_{2},\dots,o_{t}|\mathbf{\pi})=\prod_{s=1}^{t}c_{s}
  </annotation>
 </semantics>
</math>

</p>

<p>This allows us to interpret the scaled probability vector as:</p>

<p>

<math display="block" id="Forward–backward_algorithm:29">
 <semantics>
  <mrow>
   <msub>
    <mover accent="true">
     <mi>𝐟</mi>
     <mo stretchy="false">^</mo>
    </mover>
    <mrow>
     <mn>𝟎</mn>
     <mo>:</mo>
     <mi>𝐭</mi>
    </mrow>
   </msub>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>i</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>=</mo>
   <mfrac>
    <mrow>
     <msub>
      <mi>𝐟</mi>
      <mrow>
       <mn>𝟎</mn>
       <mo>:</mo>
       <mi>𝐭</mi>
      </mrow>
     </msub>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>i</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mrow>
     <msubsup>
      <mo largeop="true" symmetric="true">∏</mo>
      <mrow>
       <mi>s</mi>
       <mo>=</mo>
       <mn>1</mn>
      </mrow>
      <mi>t</mi>
     </msubsup>
     <msub>
      <mi>c</mi>
      <mi>s</mi>
     </msub>
    </mrow>
   </mfrac>
   <mo>=</mo>
   <mfrac>
    <mrow>
     <mi>𝐏</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <msub>
       <mi>o</mi>
       <mn>1</mn>
      </msub>
      <mo>,</mo>
      <msub>
       <mi>o</mi>
       <mn>2</mn>
      </msub>
      <mo>,</mo>
      <mi mathvariant="normal">…</mi>
      <mo>,</mo>
      <msub>
       <mi>o</mi>
       <mi>t</mi>
      </msub>
      <mo>,</mo>
      <msub>
       <mi>X</mi>
       <mi>t</mi>
      </msub>
      <mo>=</mo>
      <msub>
       <mi>x</mi>
       <mi>i</mi>
      </msub>
      <mo stretchy="false">|</mo>
      <mi>π</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mrow>
     <mi>𝐏</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <msub>
       <mi>o</mi>
       <mn>1</mn>
      </msub>
      <mo>,</mo>
      <msub>
       <mi>o</mi>
       <mn>2</mn>
      </msub>
      <mo>,</mo>
      <mi mathvariant="normal">…</mi>
      <mo>,</mo>
      <msub>
       <mi>o</mi>
       <mi>t</mi>
      </msub>
      <mo stretchy="false">|</mo>
      <mi>π</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mfrac>
   <mo>=</mo>
   <mi>𝐏</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>X</mi>
     <mi>t</mi>
    </msub>
    <mo>=</mo>
    <msub>
     <mi>x</mi>
     <mi>i</mi>
    </msub>
    <mo stretchy="false">|</mo>
    <msub>
     <mi>o</mi>
     <mn>1</mn>
    </msub>
    <mo>,</mo>
    <msub>
     <mi>o</mi>
     <mn>2</mn>
    </msub>
    <mo>,</mo>
    <mi mathvariant="normal">…</mi>
    <mo>,</mo>
    <msub>
     <mi>o</mi>
     <mi>t</mi>
    </msub>
    <mo>,</mo>
    <mi>π</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <ci>normal-^</ci>
      <ci>𝐟</ci>
     </apply>
     <apply>
      <ci>normal-:</ci>
      <cn type="integer">0</cn>
      <ci>𝐭</ci>
     </apply>
    </apply>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">i</csymbol>
     <ci>normal-)</ci>
    </cerror>
    <eq></eq>
    <apply>
     <divide></divide>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>𝐟</ci>
       <apply>
        <ci>normal-:</ci>
        <cn type="integer">0</cn>
        <ci>𝐭</ci>
       </apply>
      </apply>
      <ci>i</ci>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <csymbol cd="latexml">product</csymbol>
        <apply>
         <eq></eq>
         <ci>s</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <ci>t</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>c</ci>
       <ci>s</ci>
      </apply>
     </apply>
    </apply>
    <eq></eq>
    <apply>
     <divide></divide>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <csymbol cd="unknown">P</csymbol>
      <cerror>
       <csymbol cd="ambiguous">fragments</csymbol>
       <ci>normal-(</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>o</ci>
        <cn type="integer">1</cn>
       </apply>
       <ci>normal-,</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>o</ci>
        <cn type="integer">2</cn>
       </apply>
       <ci>normal-,</ci>
       <ci>normal-…</ci>
       <ci>normal-,</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>o</ci>
        <ci>t</ci>
       </apply>
       <ci>normal-,</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>X</ci>
        <ci>t</ci>
       </apply>
       <eq></eq>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <ci>i</ci>
       </apply>
       <ci>normal-|</ci>
       <csymbol cd="unknown">π</csymbol>
       <ci>normal-)</ci>
      </cerror>
     </cerror>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <csymbol cd="unknown">P</csymbol>
      <cerror>
       <csymbol cd="ambiguous">fragments</csymbol>
       <ci>normal-(</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>o</ci>
        <cn type="integer">1</cn>
       </apply>
       <ci>normal-,</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>o</ci>
        <cn type="integer">2</cn>
       </apply>
       <ci>normal-,</ci>
       <ci>normal-…</ci>
       <ci>normal-,</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>o</ci>
        <ci>t</ci>
       </apply>
       <ci>normal-|</ci>
       <csymbol cd="unknown">π</csymbol>
       <ci>normal-)</ci>
      </cerror>
     </cerror>
    </apply>
    <eq></eq>
    <csymbol cd="unknown">P</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>X</ci>
      <ci>t</ci>
     </apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <ci>i</ci>
     </apply>
     <ci>normal-|</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>o</ci>
      <cn type="integer">1</cn>
     </apply>
     <ci>normal-,</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>o</ci>
      <cn type="integer">2</cn>
     </apply>
     <ci>normal-,</ci>
     <ci>normal-…</ci>
     <ci>normal-,</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>o</ci>
      <ci>t</ci>
     </apply>
     <ci>normal-,</ci>
     <csymbol cd="unknown">π</csymbol>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{\hat{f}_{0:t}}(i)=\frac{\mathbf{f_{0:t}}(i)}{\prod_{s=1}^{t}c_{s}}=%
\frac{\mathbf{P}(o_{1},o_{2},\dots,o_{t},X_{t}=x_{i}|\mathbf{\pi})}{\mathbf{P}%
(o_{1},o_{2},\dots,o_{t}|\mathbf{\pi})}=\mathbf{P}(X_{t}=x_{i}|o_{1},o_{2},%
\dots,o_{t},\mathbf{\pi})
  </annotation>
 </semantics>
</math>

</p>

<p>We thus find that the product of the scaling factors provides us with the total probability for observing the given sequence up to time t and that the scaled probability vector provides us with the probability of being in each state at this time.</p>
<h2 id="backward-probabilities">Backward probabilities</h2>

<p>A similar procedure can be constructed to find backward probabilities. These intend to provide the probabilities:</p>

<p>

<math display="block" id="Forward–backward_algorithm:30">
 <semantics>
  <mrow>
   <msub>
    <mi>𝐛</mi>
    <mrow>
     <mi>𝐭</mi>
     <mo>:</mo>
     <mi>𝐓</mi>
    </mrow>
   </msub>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>i</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>=</mo>
   <mi>𝐏</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>o</mi>
     <mrow>
      <mi>t</mi>
      <mo>+</mo>
      <mn>1</mn>
     </mrow>
    </msub>
    <mo>,</mo>
    <msub>
     <mi>o</mi>
     <mrow>
      <mi>t</mi>
      <mo>+</mo>
      <mn>2</mn>
     </mrow>
    </msub>
    <mo>,</mo>
    <mi mathvariant="normal">…</mi>
    <mo>,</mo>
    <msub>
     <mi>o</mi>
     <mi>T</mi>
    </msub>
    <mo stretchy="false">|</mo>
    <msub>
     <mi>X</mi>
     <mi>t</mi>
    </msub>
    <mo>=</mo>
    <msub>
     <mi>x</mi>
     <mi>i</mi>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>𝐛</ci>
     <apply>
      <ci>normal-:</ci>
      <ci>𝐭</ci>
      <ci>𝐓</ci>
     </apply>
    </apply>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">i</csymbol>
     <ci>normal-)</ci>
    </cerror>
    <eq></eq>
    <csymbol cd="unknown">P</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>o</ci>
      <apply>
       <plus></plus>
       <ci>t</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <ci>normal-,</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>o</ci>
      <apply>
       <plus></plus>
       <ci>t</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
     <ci>normal-,</ci>
     <ci>normal-…</ci>
     <ci>normal-,</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>o</ci>
      <ci>T</ci>
     </apply>
     <ci>normal-|</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>X</ci>
      <ci>t</ci>
     </apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <ci>i</ci>
     </apply>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{b_{t:T}}(i)=\mathbf{P}(o_{t+1},o_{t+2},\dots,o_{T}|X_{t}=x_{i})
  </annotation>
 </semantics>
</math>

</p>

<p>That is, we now want to assume that we start in a particular state (

<math display="inline" id="Forward–backward_algorithm:31">
 <semantics>
  <mrow>
   <msub>
    <mi>X</mi>
    <mi>t</mi>
   </msub>
   <mo>=</mo>
   <msub>
    <mi>x</mi>
    <mi>i</mi>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>X</ci>
     <ci>t</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>x</ci>
     <ci>i</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   X_{t}=x_{i}
  </annotation>
 </semantics>
</math>

), and we are now interested in the probability of observing all future events from this state. Since the initial state is assumed as given (i.e. the prior probability of this state = 100%), we begin with:</p>

<p>

<math display="block" id="Forward–backward_algorithm:32">
 <semantics>
  <mrow>
   <msub>
    <mi>𝐛</mi>
    <mrow>
     <mi>𝐓</mi>
     <mo>:</mo>
     <mi>𝐓</mi>
    </mrow>
   </msub>
   <mo>=</mo>
   <msup>
    <mrow>
     <mo stretchy="false">[</mo>
     <mrow>
      <mpadded width="+5pt">
       <mn>1 1 1</mn>
      </mpadded>
      <mi mathvariant="normal">…</mi>
     </mrow>
     <mo stretchy="false">]</mo>
    </mrow>
    <mi>T</mi>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>𝐛</ci>
     <apply>
      <ci>normal-:</ci>
      <ci>𝐓</ci>
      <ci>𝐓</ci>
     </apply>
    </apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="latexml">delimited-[]</csymbol>
      <apply>
       <times></times>
       <cn type="float">1 1 1</cn>
       <ci>normal-…</ci>
      </apply>
     </apply>
     <ci>T</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{b_{T:T}}=[1\ 1\ 1\ \dots]^{T}
  </annotation>
 </semantics>
</math>

</p>

<p>Notice that we are now using a column vector while the forward probabilities used row vectors. We can then work backwards using:</p>

<p>

<math display="block" id="Forward–backward_algorithm:33">
 <semantics>
  <mrow>
   <msub>
    <mi>𝐛</mi>
    <mrow>
     <mrow>
      <mi>𝐭</mi>
      <mo>-</mo>
      <mn>𝟏</mn>
     </mrow>
     <mo>:</mo>
     <mi>𝐓</mi>
    </mrow>
   </msub>
   <mo>=</mo>
   <mrow>
    <msub>
     <mi>𝐓𝐎</mi>
     <mi>𝐭</mi>
    </msub>
    <msub>
     <mi>𝐛</mi>
     <mrow>
      <mi>𝐭</mi>
      <mo>:</mo>
      <mi>𝐓</mi>
     </mrow>
    </msub>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>𝐛</ci>
     <apply>
      <ci>normal-:</ci>
      <apply>
       <minus></minus>
       <ci>𝐭</ci>
       <cn type="integer">1</cn>
      </apply>
      <ci>𝐓</ci>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>𝐓𝐎</ci>
      <ci>𝐭</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>𝐛</ci>
      <apply>
       <ci>normal-:</ci>
       <ci>𝐭</ci>
       <ci>𝐓</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{b_{t-1:T}}=\mathbf{T}\mathbf{O_{t}}\mathbf{b_{t:T}}
  </annotation>
 </semantics>
</math>

</p>

<p>While we could normalize this vector as well so that its entries sum to one, this is not usually done. Noting that each entry contains the probability of the future event sequence given a particular initial state, normalizing this vector would be equivalent to applying Bayes' theorem to find the likelihood of each initial state given the future events (assuming uniform priors for the final state vector). However, it is more common to scale this vector using the same 

<math display="inline" id="Forward–backward_algorithm:34">
 <semantics>
  <msub>
   <mi>c</mi>
   <mi>t</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>c</ci>
    <ci>t</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   c_{t}
  </annotation>
 </semantics>
</math>

 constants used in the forward probability calculations. 

<math display="inline" id="Forward–backward_algorithm:35">
 <semantics>
  <msub>
   <mi>𝐛</mi>
   <mrow>
    <mi>𝐓</mi>
    <mo>:</mo>
    <mi>𝐓</mi>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>𝐛</ci>
    <apply>
     <ci>normal-:</ci>
     <ci>𝐓</ci>
     <ci>𝐓</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{b_{T:T}}
  </annotation>
 </semantics>
</math>

 is not scaled, but subsequent operations use:</p>

<p>

<math display="block" id="Forward–backward_algorithm:36">
 <semantics>
  <mrow>
   <msub>
    <mover accent="true">
     <mi>𝐛</mi>
     <mo stretchy="false">^</mo>
    </mover>
    <mrow>
     <mrow>
      <mi>𝐭</mi>
      <mo>-</mo>
      <mn>𝟏</mn>
     </mrow>
     <mo>:</mo>
     <mi>𝐓</mi>
    </mrow>
   </msub>
   <mo>=</mo>
   <mrow>
    <msubsup>
     <mi>c</mi>
     <mi>t</mi>
     <mrow>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </msubsup>
    <msub>
     <mi>𝐓𝐎</mi>
     <mi>𝐭</mi>
    </msub>
    <msub>
     <mover accent="true">
      <mi>𝐛</mi>
      <mo stretchy="false">^</mo>
     </mover>
     <mrow>
      <mi>𝐭</mi>
      <mo>:</mo>
      <mi>𝐓</mi>
     </mrow>
    </msub>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <ci>normal-^</ci>
      <ci>𝐛</ci>
     </apply>
     <apply>
      <ci>normal-:</ci>
      <apply>
       <minus></minus>
       <ci>𝐭</ci>
       <cn type="integer">1</cn>
      </apply>
      <ci>𝐓</ci>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>c</ci>
       <ci>t</ci>
      </apply>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>𝐓𝐎</ci>
      <ci>𝐭</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <ci>normal-^</ci>
       <ci>𝐛</ci>
      </apply>
      <apply>
       <ci>normal-:</ci>
       <ci>𝐭</ci>
       <ci>𝐓</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{\hat{b}_{t-1:T}}=c_{t}^{-1}\mathbf{T}\mathbf{O_{t}}\mathbf{\hat{b}_{t:%
T}}
  </annotation>
 </semantics>
</math>

</p>

<p>where 

<math display="inline" id="Forward–backward_algorithm:37">
 <semantics>
  <msub>
   <mover accent="true">
    <mi>𝐛</mi>
    <mo stretchy="false">^</mo>
   </mover>
   <mrow>
    <mi>𝐭</mi>
    <mo>:</mo>
    <mi>𝐓</mi>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <apply>
     <ci>normal-^</ci>
     <ci>𝐛</ci>
    </apply>
    <apply>
     <ci>normal-:</ci>
     <ci>𝐭</ci>
     <ci>𝐓</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{\hat{b}_{t:T}}
  </annotation>
 </semantics>
</math>

 represents the previous, scaled vector. This result is that the scaled probability vector is related to the backward probabilities by:</p>

<p>

<math display="block" id="Forward–backward_algorithm:38">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mover accent="true">
      <mi>𝐛</mi>
      <mo stretchy="false">^</mo>
     </mover>
     <mrow>
      <mi>𝐭</mi>
      <mo>:</mo>
      <mi>𝐓</mi>
     </mrow>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>i</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mfrac>
    <mrow>
     <msub>
      <mi>𝐛</mi>
      <mrow>
       <mi>𝐭</mi>
       <mo>:</mo>
       <mi>𝐓</mi>
      </mrow>
     </msub>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>i</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mrow>
     <msubsup>
      <mo largeop="true" symmetric="true">∏</mo>
      <mrow>
       <mi>s</mi>
       <mo>=</mo>
       <mrow>
        <mi>t</mi>
        <mo>+</mo>
        <mn>1</mn>
       </mrow>
      </mrow>
      <mi>T</mi>
     </msubsup>
     <msub>
      <mi>c</mi>
      <mi>s</mi>
     </msub>
    </mrow>
   </mfrac>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <ci>normal-^</ci>
       <ci>𝐛</ci>
      </apply>
      <apply>
       <ci>normal-:</ci>
       <ci>𝐭</ci>
       <ci>𝐓</ci>
      </apply>
     </apply>
     <ci>i</ci>
    </apply>
    <apply>
     <divide></divide>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>𝐛</ci>
       <apply>
        <ci>normal-:</ci>
        <ci>𝐭</ci>
        <ci>𝐓</ci>
       </apply>
      </apply>
      <ci>i</ci>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <csymbol cd="latexml">product</csymbol>
        <apply>
         <eq></eq>
         <ci>s</ci>
         <apply>
          <plus></plus>
          <ci>t</ci>
          <cn type="integer">1</cn>
         </apply>
        </apply>
       </apply>
       <ci>T</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>c</ci>
       <ci>s</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{\hat{b}_{t:T}}(i)=\frac{\mathbf{b_{t:T}}(i)}{\prod_{s=t+1}^{T}c_{s}}
  </annotation>
 </semantics>
</math>

</p>

<p>This is useful because it allows us to find the total probability of being in each state at a given time, t, by multiplying these values:</p>

<p>

<math display="block" id="Forward–backward_algorithm:39">
 <semantics>
  <mrow>
   <msub>
    <mi>γ</mi>
    <mi>𝐭</mi>
   </msub>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>i</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>=</mo>
   <mi>𝐏</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>X</mi>
     <mi>t</mi>
    </msub>
    <mo>=</mo>
    <msub>
     <mi>x</mi>
     <mi>i</mi>
    </msub>
    <mo stretchy="false">|</mo>
    <msub>
     <mi>o</mi>
     <mn>1</mn>
    </msub>
    <mo>,</mo>
    <msub>
     <mi>o</mi>
     <mn>2</mn>
    </msub>
    <mo>,</mo>
    <mi mathvariant="normal">…</mi>
    <mo>,</mo>
    <msub>
     <mi>o</mi>
     <mi>T</mi>
    </msub>
    <mo>,</mo>
    <mi>π</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>=</mo>
   <mfrac>
    <mrow>
     <mi>𝐏</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <msub>
       <mi>o</mi>
       <mn>1</mn>
      </msub>
      <mo>,</mo>
      <msub>
       <mi>o</mi>
       <mn>2</mn>
      </msub>
      <mo>,</mo>
      <mi mathvariant="normal">…</mi>
      <mo>,</mo>
      <msub>
       <mi>o</mi>
       <mi>T</mi>
      </msub>
      <mo>,</mo>
      <msub>
       <mi>X</mi>
       <mi>t</mi>
      </msub>
      <mo>=</mo>
      <msub>
       <mi>x</mi>
       <mi>i</mi>
      </msub>
      <mo stretchy="false">|</mo>
      <mi>π</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mrow>
     <mi>𝐏</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <msub>
       <mi>o</mi>
       <mn>1</mn>
      </msub>
      <mo>,</mo>
      <msub>
       <mi>o</mi>
       <mn>2</mn>
      </msub>
      <mo>,</mo>
      <mi mathvariant="normal">…</mi>
      <mo>,</mo>
      <msub>
       <mi>o</mi>
       <mi>T</mi>
      </msub>
      <mo stretchy="false">|</mo>
      <mi>π</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mfrac>
   <mo>=</mo>
   <mfrac>
    <mrow>
     <mrow>
      <mrow>
       <msub>
        <mi>𝐟</mi>
        <mrow>
         <mn>𝟎</mn>
         <mo>:</mo>
         <mi>𝐭</mi>
        </mrow>
       </msub>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>i</mi>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
      <mo>⋅</mo>
      <msub>
       <mi>𝐛</mi>
       <mrow>
        <mi>𝐭</mi>
        <mo>:</mo>
        <mi>𝐓</mi>
       </mrow>
      </msub>
     </mrow>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>i</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mrow>
     <msubsup>
      <mo largeop="true" symmetric="true">∏</mo>
      <mrow>
       <mi>s</mi>
       <mo>=</mo>
       <mn>1</mn>
      </mrow>
      <mi>T</mi>
     </msubsup>
     <msub>
      <mi>c</mi>
      <mi>s</mi>
     </msub>
    </mrow>
   </mfrac>
   <mo>=</mo>
   <msub>
    <mover accent="true">
     <mi>𝐟</mi>
     <mo stretchy="false">^</mo>
    </mover>
    <mrow>
     <mn>𝟎</mn>
     <mo>:</mo>
     <mi>𝐭</mi>
    </mrow>
   </msub>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>i</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>⋅</mo>
   <msub>
    <mover accent="true">
     <mi>𝐛</mi>
     <mo stretchy="false">^</mo>
    </mover>
    <mrow>
     <mi>𝐭</mi>
     <mo>:</mo>
     <mi>𝐓</mi>
    </mrow>
   </msub>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>i</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>γ</ci>
     <ci>𝐭</ci>
    </apply>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">i</csymbol>
     <ci>normal-)</ci>
    </cerror>
    <eq></eq>
    <csymbol cd="unknown">P</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>X</ci>
      <ci>t</ci>
     </apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <ci>i</ci>
     </apply>
     <ci>normal-|</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>o</ci>
      <cn type="integer">1</cn>
     </apply>
     <ci>normal-,</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>o</ci>
      <cn type="integer">2</cn>
     </apply>
     <ci>normal-,</ci>
     <ci>normal-…</ci>
     <ci>normal-,</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>o</ci>
      <ci>T</ci>
     </apply>
     <ci>normal-,</ci>
     <csymbol cd="unknown">π</csymbol>
     <ci>normal-)</ci>
    </cerror>
    <eq></eq>
    <apply>
     <divide></divide>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <csymbol cd="unknown">P</csymbol>
      <cerror>
       <csymbol cd="ambiguous">fragments</csymbol>
       <ci>normal-(</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>o</ci>
        <cn type="integer">1</cn>
       </apply>
       <ci>normal-,</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>o</ci>
        <cn type="integer">2</cn>
       </apply>
       <ci>normal-,</ci>
       <ci>normal-…</ci>
       <ci>normal-,</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>o</ci>
        <ci>T</ci>
       </apply>
       <ci>normal-,</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>X</ci>
        <ci>t</ci>
       </apply>
       <eq></eq>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <ci>i</ci>
       </apply>
       <ci>normal-|</ci>
       <csymbol cd="unknown">π</csymbol>
       <ci>normal-)</ci>
      </cerror>
     </cerror>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <csymbol cd="unknown">P</csymbol>
      <cerror>
       <csymbol cd="ambiguous">fragments</csymbol>
       <ci>normal-(</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>o</ci>
        <cn type="integer">1</cn>
       </apply>
       <ci>normal-,</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>o</ci>
        <cn type="integer">2</cn>
       </apply>
       <ci>normal-,</ci>
       <ci>normal-…</ci>
       <ci>normal-,</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>o</ci>
        <ci>T</ci>
       </apply>
       <ci>normal-|</ci>
       <csymbol cd="unknown">π</csymbol>
       <ci>normal-)</ci>
      </cerror>
     </cerror>
    </apply>
    <eq></eq>
    <apply>
     <divide></divide>
     <apply>
      <times></times>
      <apply>
       <ci>normal-⋅</ci>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>𝐟</ci>
         <apply>
          <ci>normal-:</ci>
          <cn type="integer">0</cn>
          <ci>𝐭</ci>
         </apply>
        </apply>
        <ci>i</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>𝐛</ci>
        <apply>
         <ci>normal-:</ci>
         <ci>𝐭</ci>
         <ci>𝐓</ci>
        </apply>
       </apply>
      </apply>
      <ci>i</ci>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <csymbol cd="latexml">product</csymbol>
        <apply>
         <eq></eq>
         <ci>s</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <ci>T</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>c</ci>
       <ci>s</ci>
      </apply>
     </apply>
    </apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <ci>normal-^</ci>
      <ci>𝐟</ci>
     </apply>
     <apply>
      <ci>normal-:</ci>
      <cn type="integer">0</cn>
      <ci>𝐭</ci>
     </apply>
    </apply>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">i</csymbol>
     <ci>normal-)</ci>
    </cerror>
    <ci>normal-⋅</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <ci>normal-^</ci>
      <ci>𝐛</ci>
     </apply>
     <apply>
      <ci>normal-:</ci>
      <ci>𝐭</ci>
      <ci>𝐓</ci>
     </apply>
    </apply>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">i</csymbol>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{\gamma_{t}}(i)=\mathbf{P}(X_{t}=x_{i}|o_{1},o_{2},\dots,o_{T},\mathbf{%
\pi})=\frac{\mathbf{P}(o_{1},o_{2},\dots,o_{T},X_{t}=x_{i}|\mathbf{\pi})}{%
\mathbf{P}(o_{1},o_{2},\dots,o_{T}|\mathbf{\pi})}=\frac{\mathbf{f_{0:t}}(i)%
\cdot\mathbf{b_{t:T}}(i)}{\prod_{s=1}^{T}c_{s}}=\mathbf{\hat{f}_{0:t}}(i)\cdot%
\mathbf{\hat{b}_{t:T}}(i)
  </annotation>
 </semantics>
</math>

</p>

<p>To understand this, we note that 

<math display="inline" id="Forward–backward_algorithm:40">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <msub>
      <mi>𝐟</mi>
      <mrow>
       <mn>𝟎</mn>
       <mo>:</mo>
       <mi>𝐭</mi>
      </mrow>
     </msub>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>i</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>⋅</mo>
    <msub>
     <mi>𝐛</mi>
     <mrow>
      <mi>𝐭</mi>
      <mo>:</mo>
      <mi>𝐓</mi>
     </mrow>
    </msub>
   </mrow>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>i</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <ci>normal-⋅</ci>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>𝐟</ci>
       <apply>
        <ci>normal-:</ci>
        <cn type="integer">0</cn>
        <ci>𝐭</ci>
       </apply>
      </apply>
      <ci>i</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>𝐛</ci>
      <apply>
       <ci>normal-:</ci>
       <ci>𝐭</ci>
       <ci>𝐓</ci>
      </apply>
     </apply>
    </apply>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{f_{0:t}}(i)\cdot\mathbf{b_{t:T}}(i)
  </annotation>
 </semantics>
</math>

 provides the probability for observing the given events in a way that passes through state 

<math display="inline" id="Forward–backward_algorithm:41">
 <semantics>
  <msub>
   <mi>x</mi>
   <mi>i</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>x</ci>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x_{i}
  </annotation>
 </semantics>
</math>

 at time t. This probability includes the forward probabilities covering all events up to time t as well as the backward probabilities which include all future events. This is the numerator we are looking for in our equation, and we divide by the total probability of the observation sequence to normalize this value and extract only the probability that 

<math display="inline" id="Forward–backward_algorithm:42">
 <semantics>
  <mrow>
   <msub>
    <mi>X</mi>
    <mi>t</mi>
   </msub>
   <mo>=</mo>
   <msub>
    <mi>x</mi>
    <mi>i</mi>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>X</ci>
     <ci>t</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>x</ci>
     <ci>i</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   X_{t}=x_{i}
  </annotation>
 </semantics>
</math>

. These values are sometimes called the "smoothed values" as they combine the forward and backward probabilities to compute a final probability.</p>

<p>The values 

<math display="inline" id="Forward–backward_algorithm:43">
 <semantics>
  <mrow>
   <msub>
    <mi>γ</mi>
    <mi>𝐭</mi>
   </msub>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>i</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>γ</ci>
     <ci>𝐭</ci>
    </apply>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{\gamma_{t}}(i)
  </annotation>
 </semantics>
</math>

 thus provide the probability of being in each state at time t. As such, they are useful for determining the most probable state at any time. It should be noted, however, that the term "most probable state" is somewhat ambiguous. While the most probable state is the most likely to be correct at a given point, the sequence of individually probable states is not likely to be the most probable sequence. This is because the probabilities for each point are calculated independently of each other. They do not take into account the transition probabilities between states, and it is thus possible to get states at two moments (t and t+1) that are both most probable at those time points but which have very little probability of occurring together, i.e. 

<math display="inline" id="Forward–backward_algorithm:44">
 <semantics>
  <mrow>
   <mi>𝐏</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>X</mi>
     <mi>t</mi>
    </msub>
    <mo>=</mo>
    <msub>
     <mi>x</mi>
     <mi>i</mi>
    </msub>
    <mo>,</mo>
    <msub>
     <mi>X</mi>
     <mrow>
      <mi>t</mi>
      <mo>+</mo>
      <mn>1</mn>
     </mrow>
    </msub>
    <mo>=</mo>
    <msub>
     <mi>x</mi>
     <mi>j</mi>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>≠</mo>
   <mi>𝐏</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>X</mi>
     <mi>t</mi>
    </msub>
    <mo>=</mo>
    <msub>
     <mi>x</mi>
     <mi>i</mi>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
   <mi>𝐏</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>X</mi>
     <mrow>
      <mi>t</mi>
      <mo>+</mo>
      <mn>1</mn>
     </mrow>
    </msub>
    <mo>=</mo>
    <msub>
     <mi>x</mi>
     <mi>j</mi>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">P</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>X</ci>
      <ci>t</ci>
     </apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <ci>i</ci>
     </apply>
     <ci>normal-,</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>X</ci>
      <apply>
       <plus></plus>
       <ci>t</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <ci>j</ci>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <neq></neq>
    <csymbol cd="unknown">P</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>X</ci>
      <ci>t</ci>
     </apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <ci>i</ci>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <csymbol cd="unknown">P</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>X</ci>
      <apply>
       <plus></plus>
       <ci>t</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <ci>j</ci>
     </apply>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{P}(X_{t}=x_{i},X_{t+1}=x_{j})\neq\mathbf{P}(X_{t}=x_{i})\mathbf{P}(X_{%
t+1}=x_{j})
  </annotation>
 </semantics>
</math>

. The most probable sequence of states that produced an observation sequence can be found using the <a href="Viterbi_algorithm" title="wikilink">Viterbi algorithm</a>.</p>
<h2 id="example">Example</h2>

<p>This example takes as its basis the umbrella world in <a href="#RussellNorvig10" title="wikilink">Russell &amp; Norvig 2010 Chapter 15 pp. 566</a> in which we would like to infer the weather given observation of a man either carrying or not carrying an umbrella. We assume two possible states for the weather: state 1 = rain, state 2 = no rain. We assume that the weather has a 70% chance of staying the same each day and a 30% chance of changing. The transition probabilities are then:</p>

<p>

<math display="block" id="Forward–backward_algorithm:45">
 <semantics>
  <mrow>
   <mi>𝐓</mi>
   <mo>=</mo>
   <mrow>
    <mo>(</mo>
    <mtable displaystyle="true">
     <mtr>
      <mtd columnalign="center">
       <mn>0.7</mn>
      </mtd>
      <mtd columnalign="center">
       <mn>0.3</mn>
      </mtd>
     </mtr>
     <mtr>
      <mtd columnalign="center">
       <mn>0.3</mn>
      </mtd>
      <mtd columnalign="center">
       <mn>0.7</mn>
      </mtd>
     </mtr>
    </mtable>
    <mo>)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>𝐓</ci>
    <matrix>
     <matrixrow>
      <cn type="float">0.7</cn>
      <cn type="float">0.3</cn>
     </matrixrow>
     <matrixrow>
      <cn type="float">0.3</cn>
      <cn type="float">0.7</cn>
     </matrixrow>
    </matrix>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{T}=\begin{pmatrix}0.7&0.3\\
0.3&0.7\end{pmatrix}
  </annotation>
 </semantics>
</math>

</p>

<p>We also assume each state generates 2 events: event 1 = umbrella, event 2 = no umbrella. The conditional probabilities for these occurring in each state are given by the probability matrix:</p>

<p>

<math display="block" id="Forward–backward_algorithm:46">
 <semantics>
  <mrow>
   <mi>𝐁</mi>
   <mo>=</mo>
   <mrow>
    <mo>(</mo>
    <mtable displaystyle="true">
     <mtr>
      <mtd columnalign="center">
       <mn>0.9</mn>
      </mtd>
      <mtd columnalign="center">
       <mn>0.1</mn>
      </mtd>
     </mtr>
     <mtr>
      <mtd columnalign="center">
       <mn>0.2</mn>
      </mtd>
      <mtd columnalign="center">
       <mn>0.8</mn>
      </mtd>
     </mtr>
    </mtable>
    <mo>)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>𝐁</ci>
    <matrix>
     <matrixrow>
      <cn type="float">0.9</cn>
      <cn type="float">0.1</cn>
     </matrixrow>
     <matrixrow>
      <cn type="float">0.2</cn>
      <cn type="float">0.8</cn>
     </matrixrow>
    </matrix>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{B}=\begin{pmatrix}0.9&0.1\\
0.2&0.8\end{pmatrix}
  </annotation>
 </semantics>
</math>

</p>

<p>We then observe the following sequence of events: {umbrella, umbrella, no umbrella, umbrella, umbrella} which we will represent in our calculations as:</p>

<p>

<math display="block" id="Forward–backward_algorithm:47">
 <semantics>
  <mrow>
   <msub>
    <mi>𝐎</mi>
    <mn>𝟏</mn>
   </msub>
   <mo>=</mo>
   <mrow>
    <mpadded width="+6.6pt">
     <mrow>
      <mo>(</mo>
      <mtable displaystyle="true">
       <mtr>
        <mtd columnalign="center">
         <mn>0.9</mn>
        </mtd>
        <mtd columnalign="center">
         <mn>0.0</mn>
        </mtd>
       </mtr>
       <mtr>
        <mtd columnalign="center">
         <mn>0.0</mn>
        </mtd>
        <mtd columnalign="center">
         <mn>0.2</mn>
        </mtd>
       </mtr>
      </mtable>
      <mo>)</mo>
     </mrow>
    </mpadded>
    <msub>
     <mi>𝐎</mi>
     <mn>𝟐</mn>
    </msub>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mpadded width="+6.6pt">
     <mrow>
      <mo>(</mo>
      <mtable displaystyle="true">
       <mtr>
        <mtd columnalign="center">
         <mn>0.9</mn>
        </mtd>
        <mtd columnalign="center">
         <mn>0.0</mn>
        </mtd>
       </mtr>
       <mtr>
        <mtd columnalign="center">
         <mn>0.0</mn>
        </mtd>
        <mtd columnalign="center">
         <mn>0.2</mn>
        </mtd>
       </mtr>
      </mtable>
      <mo>)</mo>
     </mrow>
    </mpadded>
    <msub>
     <mi>𝐎</mi>
     <mn>𝟑</mn>
    </msub>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mpadded width="+6.6pt">
     <mrow>
      <mo>(</mo>
      <mtable displaystyle="true">
       <mtr>
        <mtd columnalign="center">
         <mn>0.1</mn>
        </mtd>
        <mtd columnalign="center">
         <mn>0.0</mn>
        </mtd>
       </mtr>
       <mtr>
        <mtd columnalign="center">
         <mn>0.0</mn>
        </mtd>
        <mtd columnalign="center">
         <mn>0.8</mn>
        </mtd>
       </mtr>
      </mtable>
      <mo>)</mo>
     </mrow>
    </mpadded>
    <msub>
     <mi>𝐎</mi>
     <mn>𝟒</mn>
    </msub>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mpadded width="+6.6pt">
     <mrow>
      <mo>(</mo>
      <mtable displaystyle="true">
       <mtr>
        <mtd columnalign="center">
         <mn>0.9</mn>
        </mtd>
        <mtd columnalign="center">
         <mn>0.0</mn>
        </mtd>
       </mtr>
       <mtr>
        <mtd columnalign="center">
         <mn>0.0</mn>
        </mtd>
        <mtd columnalign="center">
         <mn>0.2</mn>
        </mtd>
       </mtr>
      </mtable>
      <mo>)</mo>
     </mrow>
    </mpadded>
    <msub>
     <mi>𝐎</mi>
     <mn>𝟓</mn>
    </msub>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mo>(</mo>
    <mtable displaystyle="true">
     <mtr>
      <mtd columnalign="center">
       <mn>0.9</mn>
      </mtd>
      <mtd columnalign="center">
       <mn>0.0</mn>
      </mtd>
     </mtr>
     <mtr>
      <mtd columnalign="center">
       <mn>0.0</mn>
      </mtd>
      <mtd columnalign="center">
       <mn>0.2</mn>
      </mtd>
     </mtr>
    </mtable>
    <mo>)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>𝐎</ci>
      <cn type="integer">1</cn>
     </apply>
     <apply>
      <times></times>
      <matrix>
       <matrixrow>
        <cn type="float">0.9</cn>
        <cn type="float">0.0</cn>
       </matrixrow>
       <matrixrow>
        <cn type="float">0.0</cn>
        <cn type="float">0.2</cn>
       </matrixrow>
      </matrix>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>𝐎</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <matrix>
       <matrixrow>
        <cn type="float">0.9</cn>
        <cn type="float">0.0</cn>
       </matrixrow>
       <matrixrow>
        <cn type="float">0.0</cn>
        <cn type="float">0.2</cn>
       </matrixrow>
      </matrix>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>𝐎</ci>
       <cn type="integer">3</cn>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <matrix>
       <matrixrow>
        <cn type="float">0.1</cn>
        <cn type="float">0.0</cn>
       </matrixrow>
       <matrixrow>
        <cn type="float">0.0</cn>
        <cn type="float">0.8</cn>
       </matrixrow>
      </matrix>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>𝐎</ci>
       <cn type="integer">4</cn>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <matrix>
       <matrixrow>
        <cn type="float">0.9</cn>
        <cn type="float">0.0</cn>
       </matrixrow>
       <matrixrow>
        <cn type="float">0.0</cn>
        <cn type="float">0.2</cn>
       </matrixrow>
      </matrix>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>𝐎</ci>
       <cn type="integer">5</cn>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <matrix>
      <matrixrow>
       <cn type="float">0.9</cn>
       <cn type="float">0.0</cn>
      </matrixrow>
      <matrixrow>
       <cn type="float">0.0</cn>
       <cn type="float">0.2</cn>
      </matrixrow>
     </matrix>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{O_{1}}=\begin{pmatrix}0.9&0.0\\
0.0&0.2\end{pmatrix}~{}~{}\mathbf{O_{2}}=\begin{pmatrix}0.9&0.0\\
0.0&0.2\end{pmatrix}~{}~{}\mathbf{O_{3}}=\begin{pmatrix}0.1&0.0\\
0.0&0.8\end{pmatrix}~{}~{}\mathbf{O_{4}}=\begin{pmatrix}0.9&0.0\\
0.0&0.2\end{pmatrix}~{}~{}\mathbf{O_{5}}=\begin{pmatrix}0.9&0.0\\
0.0&0.2\end{pmatrix}
  </annotation>
 </semantics>
</math>

</p>

<p>Note that 

<math display="inline" id="Forward–backward_algorithm:48">
 <semantics>
  <msub>
   <mi>𝐎</mi>
   <mn>𝟑</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>𝐎</ci>
    <cn type="integer">3</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{O_{3}}
  </annotation>
 </semantics>
</math>


 differs from the others because of the "no umbrella" observation.</p>

<p>In computing the forward probabilities we begin with:</p>

<p>

<math display="block" id="Forward–backward_algorithm:49">
 <semantics>
  <mrow>
   <msub>
    <mi>𝐟</mi>
    <mrow>
     <mn>𝟎</mn>
     <mo>:</mo>
     <mn>𝟎</mn>
    </mrow>
   </msub>
   <mo>=</mo>
   <mrow>
    <mo>(</mo>
    <mtable displaystyle="true">
     <mtr>
      <mtd columnalign="center">
       <mn>0.5</mn>
      </mtd>
      <mtd columnalign="center">
       <mn>0.5</mn>
      </mtd>
     </mtr>
    </mtable>
    <mo>)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>𝐟</ci>
     <apply>
      <ci>normal-:</ci>
      <cn type="integer">0</cn>
      <cn type="integer">0</cn>
     </apply>
    </apply>
    <matrix>
     <matrixrow>
      <cn type="float">0.5</cn>
      <cn type="float">0.5</cn>
     </matrixrow>
    </matrix>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{f_{0:0}}=\begin{pmatrix}0.5&0.5\end{pmatrix}
  </annotation>
 </semantics>
</math>

</p>

<p>which is our prior state vector indicating that we don't know which state the weather is in before our observations. While a state vector should be given as a row vector, we will use the transpose of the matrix so that the calculations below are easier to read. Our calculations are then written in the form:</p>

<p>

<math display="block" id="Forward–backward_algorithm:50">
 <semantics>
  <mrow>
   <msup>
    <mrow>
     <mo stretchy="false">(</mo>
     <msub>
      <mover accent="true">
       <mi>𝐟</mi>
       <mo stretchy="false">^</mo>
      </mover>
      <mrow>
       <mn>𝟎</mn>
       <mo>:</mo>
       <mi>𝐭</mi>
      </mrow>
     </msub>
     <mo stretchy="false">)</mo>
    </mrow>
    <mi>T</mi>
   </msup>
   <mo>=</mo>
   <mrow>
    <msup>
     <mi>c</mi>
     <mrow>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </msup>
    <msub>
     <mi>𝐎</mi>
     <mi>𝐭</mi>
    </msub>
    <msup>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>𝐓</mi>
      <mo stretchy="false">)</mo>
     </mrow>
     <mi>T</mi>
    </msup>
    <msup>
     <mrow>
      <mo stretchy="false">(</mo>
      <msub>
       <mover accent="true">
        <mi>𝐟</mi>
        <mo stretchy="false">^</mo>
       </mover>
       <mrow>
        <mn>𝟎</mn>
        <mo>:</mo>
        <mrow>
         <mi>𝐭</mi>
         <mo>-</mo>
         <mn>𝟏</mn>
        </mrow>
       </mrow>
      </msub>
      <mo stretchy="false">)</mo>
     </mrow>
     <mi>T</mi>
    </msup>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <ci>normal-^</ci>
       <ci>𝐟</ci>
      </apply>
      <apply>
       <ci>normal-:</ci>
       <cn type="integer">0</cn>
       <ci>𝐭</ci>
      </apply>
     </apply>
     <ci>T</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>c</ci>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>𝐎</ci>
      <ci>𝐭</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>𝐓</ci>
      <ci>T</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <apply>
        <ci>normal-^</ci>
        <ci>𝐟</ci>
       </apply>
       <apply>
        <ci>normal-:</ci>
        <cn type="integer">0</cn>
        <apply>
         <minus></minus>
         <ci>𝐭</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
      </apply>
      <ci>T</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (\mathbf{\hat{f}_{0:t}})^{T}=c^{-1}\mathbf{O_{t}}(\mathbf{T})^{T}(\mathbf{\hat%
{f}_{0:t-1}})^{T}
  </annotation>
 </semantics>
</math>

</p>

<p>instead of:</p>

<p>

<math display="block" id="Forward–backward_algorithm:51">
 <semantics>
  <mrow>
   <msub>
    <mover accent="true">
     <mi>𝐟</mi>
     <mo stretchy="false">^</mo>
    </mover>
    <mrow>
     <mn>𝟎</mn>
     <mo>:</mo>
     <mi>𝐭</mi>
    </mrow>
   </msub>
   <mo>=</mo>
   <mrow>
    <msup>
     <mi>c</mi>
     <mrow>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </msup>
    <msub>
     <mover accent="true">
      <mi>𝐟</mi>
      <mo stretchy="false">^</mo>
     </mover>
     <mrow>
      <mn>𝟎</mn>
      <mo>:</mo>
      <mrow>
       <mi>𝐭</mi>
       <mo>-</mo>
       <mn>𝟏</mn>
      </mrow>
     </mrow>
    </msub>
    <msub>
     <mi>𝐓𝐎</mi>
     <mi>𝐭</mi>
    </msub>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <ci>normal-^</ci>
      <ci>𝐟</ci>
     </apply>
     <apply>
      <ci>normal-:</ci>
      <cn type="integer">0</cn>
      <ci>𝐭</ci>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>c</ci>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <ci>normal-^</ci>
       <ci>𝐟</ci>
      </apply>
      <apply>
       <ci>normal-:</ci>
       <cn type="integer">0</cn>
       <apply>
        <minus></minus>
        <ci>𝐭</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>𝐓𝐎</ci>
      <ci>𝐭</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{\hat{f}_{0:t}}=c^{-1}\mathbf{\hat{f}_{0:t-1}}\mathbf{T}\mathbf{O_{t}}
  </annotation>
 </semantics>
</math>

</p>

<p>Notice that the transformation matrix is also transposed, but in our example the transpose is equal to the original matrix. Performing these calculations and normalizing the results provides:</p>

<p>

<math display="block" id="Forward–backward_algorithm:52">
 <semantics>
  <mrow>
   <msup>
    <mrow>
     <mo stretchy="false">(</mo>
     <msub>
      <mover accent="true">
       <mi>𝐟</mi>
       <mo stretchy="false">^</mo>
      </mover>
      <mrow>
       <mn>𝟎</mn>
       <mo>:</mo>
       <mn>𝟏</mn>
      </mrow>
     </msub>
     <mo stretchy="false">)</mo>
    </mrow>
    <mi>T</mi>
   </msup>
   <mo>=</mo>
   <mrow>
    <msubsup>
     <mi>c</mi>
     <mn>1</mn>
     <mrow>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </msubsup>
    <mrow>
     <mo>(</mo>
     <mtable displaystyle="true">
      <mtr>
       <mtd columnalign="center">
        <mn>0.9</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>0.0</mn>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mn>0.0</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>0.2</mn>
       </mtd>
      </mtr>
     </mtable>
     <mo>)</mo>
    </mrow>
    <mrow>
     <mo>(</mo>
     <mtable displaystyle="true">
      <mtr>
       <mtd columnalign="center">
        <mn>0.7</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>0.3</mn>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mn>0.3</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>0.7</mn>
       </mtd>
      </mtr>
     </mtable>
     <mo>)</mo>
    </mrow>
    <mrow>
     <mo>(</mo>
     <mtable displaystyle="true">
      <mtr>
       <mtd columnalign="center">
        <mn>0.5000</mn>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mn>0.5000</mn>
       </mtd>
      </mtr>
     </mtable>
     <mo>)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <msubsup>
     <mi>c</mi>
     <mn>1</mn>
     <mrow>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </msubsup>
    <mrow>
     <mo>(</mo>
     <mtable displaystyle="true">
      <mtr>
       <mtd columnalign="center">
        <mn>0.4500</mn>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mn>0.1000</mn>
       </mtd>
      </mtr>
     </mtable>
     <mo>)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mo>(</mo>
    <mtable displaystyle="true">
     <mtr>
      <mtd columnalign="center">
       <mn>0.8182</mn>
      </mtd>
     </mtr>
     <mtr>
      <mtd columnalign="center">
       <mn>0.1818</mn>
      </mtd>
     </mtr>
    </mtable>
    <mo>)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <apply>
        <ci>normal-^</ci>
        <ci>𝐟</ci>
       </apply>
       <apply>
        <ci>normal-:</ci>
        <cn type="integer">0</cn>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <ci>T</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>c</ci>
        <cn type="integer">1</cn>
       </apply>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <matrix>
       <matrixrow>
        <cn type="float">0.9</cn>
        <cn type="float">0.0</cn>
       </matrixrow>
       <matrixrow>
        <cn type="float">0.0</cn>
        <cn type="float">0.2</cn>
       </matrixrow>
      </matrix>
      <matrix>
       <matrixrow>
        <cn type="float">0.7</cn>
        <cn type="float">0.3</cn>
       </matrixrow>
       <matrixrow>
        <cn type="float">0.3</cn>
        <cn type="float">0.7</cn>
       </matrixrow>
      </matrix>
      <matrix>
       <matrixrow>
        <cn type="float">0.5000</cn>
       </matrixrow>
       <matrixrow>
        <cn type="float">0.5000</cn>
       </matrixrow>
      </matrix>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>c</ci>
        <cn type="integer">1</cn>
       </apply>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <matrix>
       <matrixrow>
        <cn type="float">0.4500</cn>
       </matrixrow>
       <matrixrow>
        <cn type="float">0.1000</cn>
       </matrixrow>
      </matrix>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <matrix>
      <matrixrow>
       <cn type="float">0.8182</cn>
      </matrixrow>
      <matrixrow>
       <cn type="float">0.1818</cn>
      </matrixrow>
     </matrix>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (\mathbf{\hat{f}_{0:1}})^{T}=c_{1}^{-1}\begin{pmatrix}0.9&0.0\\
0.0&0.2\end{pmatrix}\begin{pmatrix}0.7&0.3\\
0.3&0.7\end{pmatrix}\begin{pmatrix}0.5000\\
0.5000\end{pmatrix}=c_{1}^{-1}\begin{pmatrix}0.4500\\
0.1000\end{pmatrix}=\begin{pmatrix}0.8182\\
0.1818\end{pmatrix}
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Forward–backward_algorithm:53">
 <semantics>
  <mrow>
   <msup>
    <mrow>
     <mo stretchy="false">(</mo>
     <msub>
      <mover accent="true">
       <mi>𝐟</mi>
       <mo stretchy="false">^</mo>
      </mover>
      <mrow>
       <mn>𝟎</mn>
       <mo>:</mo>
       <mn>𝟐</mn>
      </mrow>
     </msub>
     <mo stretchy="false">)</mo>
    </mrow>
    <mi>T</mi>
   </msup>
   <mo>=</mo>
   <mrow>
    <msubsup>
     <mi>c</mi>
     <mn>2</mn>
     <mrow>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </msubsup>
    <mrow>
     <mo>(</mo>
     <mtable displaystyle="true">
      <mtr>
       <mtd columnalign="center">
        <mn>0.9</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>0.0</mn>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mn>0.0</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>0.2</mn>
       </mtd>
      </mtr>
     </mtable>
     <mo>)</mo>
    </mrow>
    <mrow>
     <mo>(</mo>
     <mtable displaystyle="true">
      <mtr>
       <mtd columnalign="center">
        <mn>0.7</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>0.3</mn>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mn>0.3</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>0.7</mn>
       </mtd>
      </mtr>
     </mtable>
     <mo>)</mo>
    </mrow>
    <mrow>
     <mo>(</mo>
     <mtable displaystyle="true">
      <mtr>
       <mtd columnalign="center">
        <mn>0.8182</mn>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mn>0.1818</mn>
       </mtd>
      </mtr>
     </mtable>
     <mo>)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <msubsup>
     <mi>c</mi>
     <mn>2</mn>
     <mrow>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </msubsup>
    <mrow>
     <mo>(</mo>
     <mtable displaystyle="true">
      <mtr>
       <mtd columnalign="center">
        <mn>0.5645</mn>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mn>0.0745</mn>
       </mtd>
      </mtr>
     </mtable>
     <mo>)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mo>(</mo>
    <mtable displaystyle="true">
     <mtr>
      <mtd columnalign="center">
       <mn>0.8834</mn>
      </mtd>
     </mtr>
     <mtr>
      <mtd columnalign="center">
       <mn>0.1166</mn>
      </mtd>
     </mtr>
    </mtable>
    <mo>)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <apply>
        <ci>normal-^</ci>
        <ci>𝐟</ci>
       </apply>
       <apply>
        <ci>normal-:</ci>
        <cn type="integer">0</cn>
        <cn type="integer">2</cn>
       </apply>
      </apply>
      <ci>T</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>c</ci>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <matrix>
       <matrixrow>
        <cn type="float">0.9</cn>
        <cn type="float">0.0</cn>
       </matrixrow>
       <matrixrow>
        <cn type="float">0.0</cn>
        <cn type="float">0.2</cn>
       </matrixrow>
      </matrix>
      <matrix>
       <matrixrow>
        <cn type="float">0.7</cn>
        <cn type="float">0.3</cn>
       </matrixrow>
       <matrixrow>
        <cn type="float">0.3</cn>
        <cn type="float">0.7</cn>
       </matrixrow>
      </matrix>
      <matrix>
       <matrixrow>
        <cn type="float">0.8182</cn>
       </matrixrow>
       <matrixrow>
        <cn type="float">0.1818</cn>
       </matrixrow>
      </matrix>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>c</ci>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <matrix>
       <matrixrow>
        <cn type="float">0.5645</cn>
       </matrixrow>
       <matrixrow>
        <cn type="float">0.0745</cn>
       </matrixrow>
      </matrix>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <matrix>
      <matrixrow>
       <cn type="float">0.8834</cn>
      </matrixrow>
      <matrixrow>
       <cn type="float">0.1166</cn>
      </matrixrow>
     </matrix>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (\mathbf{\hat{f}_{0:2}})^{T}=c_{2}^{-1}\begin{pmatrix}0.9&0.0\\
0.0&0.2\end{pmatrix}\begin{pmatrix}0.7&0.3\\
0.3&0.7\end{pmatrix}\begin{pmatrix}0.8182\\
0.1818\end{pmatrix}=c_{2}^{-1}\begin{pmatrix}0.5645\\
0.0745\end{pmatrix}=\begin{pmatrix}0.8834\\
0.1166\end{pmatrix}
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Forward–backward_algorithm:54">
 <semantics>
  <mrow>
   <msup>
    <mrow>
     <mo stretchy="false">(</mo>
     <msub>
      <mover accent="true">
       <mi>𝐟</mi>
       <mo stretchy="false">^</mo>
      </mover>
      <mrow>
       <mn>𝟎</mn>
       <mo>:</mo>
       <mn>𝟑</mn>
      </mrow>
     </msub>
     <mo stretchy="false">)</mo>
    </mrow>
    <mi>T</mi>
   </msup>
   <mo>=</mo>
   <mrow>
    <msubsup>
     <mi>c</mi>
     <mn>3</mn>
     <mrow>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </msubsup>
    <mrow>
     <mo>(</mo>
     <mtable displaystyle="true">
      <mtr>
       <mtd columnalign="center">
        <mn>0.1</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>0.0</mn>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mn>0.0</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>0.8</mn>
       </mtd>
      </mtr>
     </mtable>
     <mo>)</mo>
    </mrow>
    <mrow>
     <mo>(</mo>
     <mtable displaystyle="true">
      <mtr>
       <mtd columnalign="center">
        <mn>0.7</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>0.3</mn>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mn>0.3</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>0.7</mn>
       </mtd>
      </mtr>
     </mtable>
     <mo>)</mo>
    </mrow>
    <mrow>
     <mo>(</mo>
     <mtable displaystyle="true">
      <mtr>
       <mtd columnalign="center">
        <mn>0.8834</mn>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mn>0.1166</mn>
       </mtd>
      </mtr>
     </mtable>
     <mo>)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <msubsup>
     <mi>c</mi>
     <mn>3</mn>
     <mrow>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </msubsup>
    <mrow>
     <mo>(</mo>
     <mtable displaystyle="true">
      <mtr>
       <mtd columnalign="center">
        <mn>0.0653</mn>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mn>0.2772</mn>
       </mtd>
      </mtr>
     </mtable>
     <mo>)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mo>(</mo>
    <mtable displaystyle="true">
     <mtr>
      <mtd columnalign="center">
       <mn>0.1907</mn>
      </mtd>
     </mtr>
     <mtr>
      <mtd columnalign="center">
       <mn>0.8093</mn>
      </mtd>
     </mtr>
    </mtable>
    <mo>)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <apply>
        <ci>normal-^</ci>
        <ci>𝐟</ci>
       </apply>
       <apply>
        <ci>normal-:</ci>
        <cn type="integer">0</cn>
        <cn type="integer">3</cn>
       </apply>
      </apply>
      <ci>T</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>c</ci>
        <cn type="integer">3</cn>
       </apply>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <matrix>
       <matrixrow>
        <cn type="float">0.1</cn>
        <cn type="float">0.0</cn>
       </matrixrow>
       <matrixrow>
        <cn type="float">0.0</cn>
        <cn type="float">0.8</cn>
       </matrixrow>
      </matrix>
      <matrix>
       <matrixrow>
        <cn type="float">0.7</cn>
        <cn type="float">0.3</cn>
       </matrixrow>
       <matrixrow>
        <cn type="float">0.3</cn>
        <cn type="float">0.7</cn>
       </matrixrow>
      </matrix>
      <matrix>
       <matrixrow>
        <cn type="float">0.8834</cn>
       </matrixrow>
       <matrixrow>
        <cn type="float">0.1166</cn>
       </matrixrow>
      </matrix>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>c</ci>
        <cn type="integer">3</cn>
       </apply>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <matrix>
       <matrixrow>
        <cn type="float">0.0653</cn>
       </matrixrow>
       <matrixrow>
        <cn type="float">0.2772</cn>
       </matrixrow>
      </matrix>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <matrix>
      <matrixrow>
       <cn type="float">0.1907</cn>
      </matrixrow>
      <matrixrow>
       <cn type="float">0.8093</cn>
      </matrixrow>
     </matrix>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (\mathbf{\hat{f}_{0:3}})^{T}=c_{3}^{-1}\begin{pmatrix}0.1&0.0\\
0.0&0.8\end{pmatrix}\begin{pmatrix}0.7&0.3\\
0.3&0.7\end{pmatrix}\begin{pmatrix}0.8834\\
0.1166\end{pmatrix}=c_{3}^{-1}\begin{pmatrix}0.0653\\
0.2772\end{pmatrix}=\begin{pmatrix}0.1907\\
0.8093\end{pmatrix}
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Forward–backward_algorithm:55">
 <semantics>
  <mrow>
   <msup>
    <mrow>
     <mo stretchy="false">(</mo>
     <msub>
      <mover accent="true">
       <mi>𝐟</mi>
       <mo stretchy="false">^</mo>
      </mover>
      <mrow>
       <mn>𝟎</mn>
       <mo>:</mo>
       <mn>𝟒</mn>
      </mrow>
     </msub>
     <mo stretchy="false">)</mo>
    </mrow>
    <mi>T</mi>
   </msup>
   <mo>=</mo>
   <mrow>
    <msubsup>
     <mi>c</mi>
     <mn>4</mn>
     <mrow>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </msubsup>
    <mrow>
     <mo>(</mo>
     <mtable displaystyle="true">
      <mtr>
       <mtd columnalign="center">
        <mn>0.9</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>0.0</mn>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mn>0.0</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>0.2</mn>
       </mtd>
      </mtr>
     </mtable>
     <mo>)</mo>
    </mrow>
    <mrow>
     <mo>(</mo>
     <mtable displaystyle="true">
      <mtr>
       <mtd columnalign="center">
        <mn>0.7</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>0.3</mn>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mn>0.3</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>0.7</mn>
       </mtd>
      </mtr>
     </mtable>
     <mo>)</mo>
    </mrow>
    <mrow>
     <mo>(</mo>
     <mtable displaystyle="true">
      <mtr>
       <mtd columnalign="center">
        <mn>0.1907</mn>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mn>0.8093</mn>
       </mtd>
      </mtr>
     </mtable>
     <mo>)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <msubsup>
     <mi>c</mi>
     <mn>4</mn>
     <mrow>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </msubsup>
    <mrow>
     <mo>(</mo>
     <mtable displaystyle="true">
      <mtr>
       <mtd columnalign="center">
        <mn>0.3386</mn>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mn>0.1247</mn>
       </mtd>
      </mtr>
     </mtable>
     <mo>)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mo>(</mo>
    <mtable displaystyle="true">
     <mtr>
      <mtd columnalign="center">
       <mn>0.7308</mn>
      </mtd>
     </mtr>
     <mtr>
      <mtd columnalign="center">
       <mn>0.2692</mn>
      </mtd>
     </mtr>
    </mtable>
    <mo>)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <apply>
        <ci>normal-^</ci>
        <ci>𝐟</ci>
       </apply>
       <apply>
        <ci>normal-:</ci>
        <cn type="integer">0</cn>
        <cn type="integer">4</cn>
       </apply>
      </apply>
      <ci>T</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>c</ci>
        <cn type="integer">4</cn>
       </apply>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <matrix>
       <matrixrow>
        <cn type="float">0.9</cn>
        <cn type="float">0.0</cn>
       </matrixrow>
       <matrixrow>
        <cn type="float">0.0</cn>
        <cn type="float">0.2</cn>
       </matrixrow>
      </matrix>
      <matrix>
       <matrixrow>
        <cn type="float">0.7</cn>
        <cn type="float">0.3</cn>
       </matrixrow>
       <matrixrow>
        <cn type="float">0.3</cn>
        <cn type="float">0.7</cn>
       </matrixrow>
      </matrix>
      <matrix>
       <matrixrow>
        <cn type="float">0.1907</cn>
       </matrixrow>
       <matrixrow>
        <cn type="float">0.8093</cn>
       </matrixrow>
      </matrix>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>c</ci>
        <cn type="integer">4</cn>
       </apply>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <matrix>
       <matrixrow>
        <cn type="float">0.3386</cn>
       </matrixrow>
       <matrixrow>
        <cn type="float">0.1247</cn>
       </matrixrow>
      </matrix>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <matrix>
      <matrixrow>
       <cn type="float">0.7308</cn>
      </matrixrow>
      <matrixrow>
       <cn type="float">0.2692</cn>
      </matrixrow>
     </matrix>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (\mathbf{\hat{f}_{0:4}})^{T}=c_{4}^{-1}\begin{pmatrix}0.9&0.0\\
0.0&0.2\end{pmatrix}\begin{pmatrix}0.7&0.3\\
0.3&0.7\end{pmatrix}\begin{pmatrix}0.1907\\
0.8093\end{pmatrix}=c_{4}^{-1}\begin{pmatrix}0.3386\\
0.1247\end{pmatrix}=\begin{pmatrix}0.7308\\
0.2692\end{pmatrix}
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Forward–backward_algorithm:56">
 <semantics>
  <mrow>
   <msup>
    <mrow>
     <mo stretchy="false">(</mo>
     <msub>
      <mover accent="true">
       <mi>𝐟</mi>
       <mo stretchy="false">^</mo>
      </mover>
      <mrow>
       <mn>𝟎</mn>
       <mo>:</mo>
       <mn>𝟓</mn>
      </mrow>
     </msub>
     <mo stretchy="false">)</mo>
    </mrow>
    <mi>T</mi>
   </msup>
   <mo>=</mo>
   <mrow>
    <msubsup>
     <mi>c</mi>
     <mn>5</mn>
     <mrow>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </msubsup>
    <mrow>
     <mo>(</mo>
     <mtable displaystyle="true">
      <mtr>
       <mtd columnalign="center">
        <mn>0.9</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>0.0</mn>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mn>0.0</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>0.2</mn>
       </mtd>
      </mtr>
     </mtable>
     <mo>)</mo>
    </mrow>
    <mrow>
     <mo>(</mo>
     <mtable displaystyle="true">
      <mtr>
       <mtd columnalign="center">
        <mn>0.7</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>0.3</mn>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mn>0.3</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>0.7</mn>
       </mtd>
      </mtr>
     </mtable>
     <mo>)</mo>
    </mrow>
    <mrow>
     <mo>(</mo>
     <mtable displaystyle="true">
      <mtr>
       <mtd columnalign="center">
        <mn>0.7308</mn>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mn>0.2692</mn>
       </mtd>
      </mtr>
     </mtable>
     <mo>)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <msubsup>
     <mi>c</mi>
     <mn>5</mn>
     <mrow>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </msubsup>
    <mrow>
     <mo>(</mo>
     <mtable displaystyle="true">
      <mtr>
       <mtd columnalign="center">
        <mn>0.5331</mn>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mn>0.0815</mn>
       </mtd>
      </mtr>
     </mtable>
     <mo>)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mo>(</mo>
    <mtable displaystyle="true">
     <mtr>
      <mtd columnalign="center">
       <mn>0.8673</mn>
      </mtd>
     </mtr>
     <mtr>
      <mtd columnalign="center">
       <mn>0.1327</mn>
      </mtd>
     </mtr>
    </mtable>
    <mo>)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <apply>
        <ci>normal-^</ci>
        <ci>𝐟</ci>
       </apply>
       <apply>
        <ci>normal-:</ci>
        <cn type="integer">0</cn>
        <cn type="integer">5</cn>
       </apply>
      </apply>
      <ci>T</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>c</ci>
        <cn type="integer">5</cn>
       </apply>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <matrix>
       <matrixrow>
        <cn type="float">0.9</cn>
        <cn type="float">0.0</cn>
       </matrixrow>
       <matrixrow>
        <cn type="float">0.0</cn>
        <cn type="float">0.2</cn>
       </matrixrow>
      </matrix>
      <matrix>
       <matrixrow>
        <cn type="float">0.7</cn>
        <cn type="float">0.3</cn>
       </matrixrow>
       <matrixrow>
        <cn type="float">0.3</cn>
        <cn type="float">0.7</cn>
       </matrixrow>
      </matrix>
      <matrix>
       <matrixrow>
        <cn type="float">0.7308</cn>
       </matrixrow>
       <matrixrow>
        <cn type="float">0.2692</cn>
       </matrixrow>
      </matrix>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>c</ci>
        <cn type="integer">5</cn>
       </apply>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <matrix>
       <matrixrow>
        <cn type="float">0.5331</cn>
       </matrixrow>
       <matrixrow>
        <cn type="float">0.0815</cn>
       </matrixrow>
      </matrix>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <matrix>
      <matrixrow>
       <cn type="float">0.8673</cn>
      </matrixrow>
      <matrixrow>
       <cn type="float">0.1327</cn>
      </matrixrow>
     </matrix>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (\mathbf{\hat{f}_{0:5}})^{T}=c_{5}^{-1}\begin{pmatrix}0.9&0.0\\
0.0&0.2\end{pmatrix}\begin{pmatrix}0.7&0.3\\
0.3&0.7\end{pmatrix}\begin{pmatrix}0.7308\\
0.2692\end{pmatrix}=c_{5}^{-1}\begin{pmatrix}0.5331\\
0.0815\end{pmatrix}=\begin{pmatrix}0.8673\\
0.1327\end{pmatrix}
  </annotation>
 </semantics>
</math>

</p>

<p>For the backward probabilities we start with:</p>

<p>

<math display="block" id="Forward–backward_algorithm:57">
 <semantics>
  <mrow>
   <msub>
    <mi>𝐛</mi>
    <mrow>
     <mn>𝟓</mn>
     <mo>:</mo>
     <mn>𝟓</mn>
    </mrow>
   </msub>
   <mo>=</mo>
   <mrow>
    <mo>(</mo>
    <mtable displaystyle="true">
     <mtr>
      <mtd columnalign="center">
       <mn>1.0</mn>
      </mtd>
     </mtr>
     <mtr>
      <mtd columnalign="center">
       <mn>1.0</mn>
      </mtd>
     </mtr>
    </mtable>
    <mo>)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>𝐛</ci>
     <apply>
      <ci>normal-:</ci>
      <cn type="integer">5</cn>
      <cn type="integer">5</cn>
     </apply>
    </apply>
    <matrix>
     <matrixrow>
      <cn type="float">1.0</cn>
     </matrixrow>
     <matrixrow>
      <cn type="float">1.0</cn>
     </matrixrow>
    </matrix>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{b_{5:5}}=\begin{pmatrix}1.0\\
1.0\end{pmatrix}
  </annotation>
 </semantics>
</math>

</p>

<p>We are then able to compute (using the observations in reverse order and normalizing with different constants):</p>

<p>

<math display="block" id="Forward–backward_algorithm:58">
 <semantics>
  <mrow>
   <msub>
    <mover accent="true">
     <mi>𝐛</mi>
     <mo stretchy="false">^</mo>
    </mover>
    <mrow>
     <mn>𝟒</mn>
     <mo>:</mo>
     <mn>𝟓</mn>
    </mrow>
   </msub>
   <mo>=</mo>
   <mrow>
    <mi>α</mi>
    <mrow>
     <mo>(</mo>
     <mtable displaystyle="true">
      <mtr>
       <mtd columnalign="center">
        <mn>0.7</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>0.3</mn>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mn>0.3</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>0.7</mn>
       </mtd>
      </mtr>
     </mtable>
     <mo>)</mo>
    </mrow>
    <mrow>
     <mo>(</mo>
     <mtable displaystyle="true">
      <mtr>
       <mtd columnalign="center">
        <mn>0.9</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>0.0</mn>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mn>0.0</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>0.2</mn>
       </mtd>
      </mtr>
     </mtable>
     <mo>)</mo>
    </mrow>
    <mrow>
     <mo>(</mo>
     <mtable displaystyle="true">
      <mtr>
       <mtd columnalign="center">
        <mn>1.0000</mn>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mn>1.0000</mn>
       </mtd>
      </mtr>
     </mtable>
     <mo>)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mi>α</mi>
    <mrow>
     <mo>(</mo>
     <mtable displaystyle="true">
      <mtr>
       <mtd columnalign="center">
        <mn>0.6900</mn>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mn>0.4100</mn>
       </mtd>
      </mtr>
     </mtable>
     <mo>)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mo>(</mo>
    <mtable displaystyle="true">
     <mtr>
      <mtd columnalign="center">
       <mn>0.6273</mn>
      </mtd>
     </mtr>
     <mtr>
      <mtd columnalign="center">
       <mn>0.3727</mn>
      </mtd>
     </mtr>
    </mtable>
    <mo>)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <ci>normal-^</ci>
       <ci>𝐛</ci>
      </apply>
      <apply>
       <ci>normal-:</ci>
       <cn type="integer">4</cn>
       <cn type="integer">5</cn>
      </apply>
     </apply>
     <apply>
      <times></times>
      <ci>α</ci>
      <matrix>
       <matrixrow>
        <cn type="float">0.7</cn>
        <cn type="float">0.3</cn>
       </matrixrow>
       <matrixrow>
        <cn type="float">0.3</cn>
        <cn type="float">0.7</cn>
       </matrixrow>
      </matrix>
      <matrix>
       <matrixrow>
        <cn type="float">0.9</cn>
        <cn type="float">0.0</cn>
       </matrixrow>
       <matrixrow>
        <cn type="float">0.0</cn>
        <cn type="float">0.2</cn>
       </matrixrow>
      </matrix>
      <matrix>
       <matrixrow>
        <cn type="float">1.0000</cn>
       </matrixrow>
       <matrixrow>
        <cn type="float">1.0000</cn>
       </matrixrow>
      </matrix>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <ci>α</ci>
      <matrix>
       <matrixrow>
        <cn type="float">0.6900</cn>
       </matrixrow>
       <matrixrow>
        <cn type="float">0.4100</cn>
       </matrixrow>
      </matrix>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <matrix>
      <matrixrow>
       <cn type="float">0.6273</cn>
      </matrixrow>
      <matrixrow>
       <cn type="float">0.3727</cn>
      </matrixrow>
     </matrix>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{\hat{b}_{4:5}}=\alpha\begin{pmatrix}0.7&0.3\\
0.3&0.7\end{pmatrix}\begin{pmatrix}0.9&0.0\\
0.0&0.2\end{pmatrix}\begin{pmatrix}1.0000\\
1.0000\end{pmatrix}=\alpha\begin{pmatrix}0.6900\\
0.4100\end{pmatrix}=\begin{pmatrix}0.6273\\
0.3727\end{pmatrix}
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Forward–backward_algorithm:59">
 <semantics>
  <mrow>
   <msub>
    <mover accent="true">
     <mi>𝐛</mi>
     <mo stretchy="false">^</mo>
    </mover>
    <mrow>
     <mn>𝟑</mn>
     <mo>:</mo>
     <mn>𝟓</mn>
    </mrow>
   </msub>
   <mo>=</mo>
   <mrow>
    <mi>α</mi>
    <mrow>
     <mo>(</mo>
     <mtable displaystyle="true">
      <mtr>
       <mtd columnalign="center">
        <mn>0.7</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>0.3</mn>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mn>0.3</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>0.7</mn>
       </mtd>
      </mtr>
     </mtable>
     <mo>)</mo>
    </mrow>
    <mrow>
     <mo>(</mo>
     <mtable displaystyle="true">
      <mtr>
       <mtd columnalign="center">
        <mn>0.9</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>0.0</mn>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mn>0.0</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>0.2</mn>
       </mtd>
      </mtr>
     </mtable>
     <mo>)</mo>
    </mrow>
    <mrow>
     <mo>(</mo>
     <mtable displaystyle="true">
      <mtr>
       <mtd columnalign="center">
        <mn>0.6273</mn>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mn>0.3727</mn>
       </mtd>
      </mtr>
     </mtable>
     <mo>)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mi>α</mi>
    <mrow>
     <mo>(</mo>
     <mtable displaystyle="true">
      <mtr>
       <mtd columnalign="center">
        <mn>0.4175</mn>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mn>0.2215</mn>
       </mtd>
      </mtr>
     </mtable>
     <mo>)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mo>(</mo>
    <mtable displaystyle="true">
     <mtr>
      <mtd columnalign="center">
       <mn>0.6533</mn>
      </mtd>
     </mtr>
     <mtr>
      <mtd columnalign="center">
       <mn>0.3467</mn>
      </mtd>
     </mtr>
    </mtable>
    <mo>)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <ci>normal-^</ci>
       <ci>𝐛</ci>
      </apply>
      <apply>
       <ci>normal-:</ci>
       <cn type="integer">3</cn>
       <cn type="integer">5</cn>
      </apply>
     </apply>
     <apply>
      <times></times>
      <ci>α</ci>
      <matrix>
       <matrixrow>
        <cn type="float">0.7</cn>
        <cn type="float">0.3</cn>
       </matrixrow>
       <matrixrow>
        <cn type="float">0.3</cn>
        <cn type="float">0.7</cn>
       </matrixrow>
      </matrix>
      <matrix>
       <matrixrow>
        <cn type="float">0.9</cn>
        <cn type="float">0.0</cn>
       </matrixrow>
       <matrixrow>
        <cn type="float">0.0</cn>
        <cn type="float">0.2</cn>
       </matrixrow>
      </matrix>
      <matrix>
       <matrixrow>
        <cn type="float">0.6273</cn>
       </matrixrow>
       <matrixrow>
        <cn type="float">0.3727</cn>
       </matrixrow>
      </matrix>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <ci>α</ci>
      <matrix>
       <matrixrow>
        <cn type="float">0.4175</cn>
       </matrixrow>
       <matrixrow>
        <cn type="float">0.2215</cn>
       </matrixrow>
      </matrix>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <matrix>
      <matrixrow>
       <cn type="float">0.6533</cn>
      </matrixrow>
      <matrixrow>
       <cn type="float">0.3467</cn>
      </matrixrow>
     </matrix>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{\hat{b}_{3:5}}=\alpha\begin{pmatrix}0.7&0.3\\
0.3&0.7\end{pmatrix}\begin{pmatrix}0.9&0.0\\
0.0&0.2\end{pmatrix}\begin{pmatrix}0.6273\\
0.3727\end{pmatrix}=\alpha\begin{pmatrix}0.4175\\
0.2215\end{pmatrix}=\begin{pmatrix}0.6533\\
0.3467\end{pmatrix}
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Forward–backward_algorithm:60">
 <semantics>
  <mrow>
   <msub>
    <mover accent="true">
     <mi>𝐛</mi>
     <mo stretchy="false">^</mo>
    </mover>
    <mrow>
     <mn>𝟐</mn>
     <mo>:</mo>
     <mn>𝟓</mn>
    </mrow>
   </msub>
   <mo>=</mo>
   <mrow>
    <mi>α</mi>
    <mrow>
     <mo>(</mo>
     <mtable displaystyle="true">
      <mtr>
       <mtd columnalign="center">
        <mn>0.7</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>0.3</mn>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mn>0.3</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>0.7</mn>
       </mtd>
      </mtr>
     </mtable>
     <mo>)</mo>
    </mrow>
    <mrow>
     <mo>(</mo>
     <mtable displaystyle="true">
      <mtr>
       <mtd columnalign="center">
        <mn>0.1</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>0.0</mn>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mn>0.0</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>0.8</mn>
       </mtd>
      </mtr>
     </mtable>
     <mo>)</mo>
    </mrow>
    <mrow>
     <mo>(</mo>
     <mtable displaystyle="true">
      <mtr>
       <mtd columnalign="center">
        <mn>0.6533</mn>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mn>0.3467</mn>
       </mtd>
      </mtr>
     </mtable>
     <mo>)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mi>α</mi>
    <mrow>
     <mo>(</mo>
     <mtable displaystyle="true">
      <mtr>
       <mtd columnalign="center">
        <mn>0.1289</mn>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mn>0.2138</mn>
       </mtd>
      </mtr>
     </mtable>
     <mo>)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mo>(</mo>
    <mtable displaystyle="true">
     <mtr>
      <mtd columnalign="center">
       <mn>0.3763</mn>
      </mtd>
     </mtr>
     <mtr>
      <mtd columnalign="center">
       <mn>0.6237</mn>
      </mtd>
     </mtr>
    </mtable>
    <mo>)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <ci>normal-^</ci>
       <ci>𝐛</ci>
      </apply>
      <apply>
       <ci>normal-:</ci>
       <cn type="integer">2</cn>
       <cn type="integer">5</cn>
      </apply>
     </apply>
     <apply>
      <times></times>
      <ci>α</ci>
      <matrix>
       <matrixrow>
        <cn type="float">0.7</cn>
        <cn type="float">0.3</cn>
       </matrixrow>
       <matrixrow>
        <cn type="float">0.3</cn>
        <cn type="float">0.7</cn>
       </matrixrow>
      </matrix>
      <matrix>
       <matrixrow>
        <cn type="float">0.1</cn>
        <cn type="float">0.0</cn>
       </matrixrow>
       <matrixrow>
        <cn type="float">0.0</cn>
        <cn type="float">0.8</cn>
       </matrixrow>
      </matrix>
      <matrix>
       <matrixrow>
        <cn type="float">0.6533</cn>
       </matrixrow>
       <matrixrow>
        <cn type="float">0.3467</cn>
       </matrixrow>
      </matrix>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <ci>α</ci>
      <matrix>
       <matrixrow>
        <cn type="float">0.1289</cn>
       </matrixrow>
       <matrixrow>
        <cn type="float">0.2138</cn>
       </matrixrow>
      </matrix>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <matrix>
      <matrixrow>
       <cn type="float">0.3763</cn>
      </matrixrow>
      <matrixrow>
       <cn type="float">0.6237</cn>
      </matrixrow>
     </matrix>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{\hat{b}_{2:5}}=\alpha\begin{pmatrix}0.7&0.3\\
0.3&0.7\end{pmatrix}\begin{pmatrix}0.1&0.0\\
0.0&0.8\end{pmatrix}\begin{pmatrix}0.6533\\
0.3467\end{pmatrix}=\alpha\begin{pmatrix}0.1289\\
0.2138\end{pmatrix}=\begin{pmatrix}0.3763\\
0.6237\end{pmatrix}
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Forward–backward_algorithm:61">
 <semantics>
  <mrow>
   <msub>
    <mover accent="true">
     <mi>𝐛</mi>
     <mo stretchy="false">^</mo>
    </mover>
    <mrow>
     <mn>𝟏</mn>
     <mo>:</mo>
     <mn>𝟓</mn>
    </mrow>
   </msub>
   <mo>=</mo>
   <mrow>
    <mi>α</mi>
    <mrow>
     <mo>(</mo>
     <mtable displaystyle="true">
      <mtr>
       <mtd columnalign="center">
        <mn>0.7</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>0.3</mn>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mn>0.3</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>0.7</mn>
       </mtd>
      </mtr>
     </mtable>
     <mo>)</mo>
    </mrow>
    <mrow>
     <mo>(</mo>
     <mtable displaystyle="true">
      <mtr>
       <mtd columnalign="center">
        <mn>0.9</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>0.0</mn>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mn>0.0</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>0.2</mn>
       </mtd>
      </mtr>
     </mtable>
     <mo>)</mo>
    </mrow>
    <mrow>
     <mo>(</mo>
     <mtable displaystyle="true">
      <mtr>
       <mtd columnalign="center">
        <mn>0.3763</mn>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mn>0.6237</mn>
       </mtd>
      </mtr>
     </mtable>
     <mo>)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mi>α</mi>
    <mrow>
     <mo>(</mo>
     <mtable displaystyle="true">
      <mtr>
       <mtd columnalign="center">
        <mn>0.2745</mn>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mn>0.1889</mn>
       </mtd>
      </mtr>
     </mtable>
     <mo>)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mo>(</mo>
    <mtable displaystyle="true">
     <mtr>
      <mtd columnalign="center">
       <mn>0.5923</mn>
      </mtd>
     </mtr>
     <mtr>
      <mtd columnalign="center">
       <mn>0.4077</mn>
      </mtd>
     </mtr>
    </mtable>
    <mo>)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <ci>normal-^</ci>
       <ci>𝐛</ci>
      </apply>
      <apply>
       <ci>normal-:</ci>
       <cn type="integer">1</cn>
       <cn type="integer">5</cn>
      </apply>
     </apply>
     <apply>
      <times></times>
      <ci>α</ci>
      <matrix>
       <matrixrow>
        <cn type="float">0.7</cn>
        <cn type="float">0.3</cn>
       </matrixrow>
       <matrixrow>
        <cn type="float">0.3</cn>
        <cn type="float">0.7</cn>
       </matrixrow>
      </matrix>
      <matrix>
       <matrixrow>
        <cn type="float">0.9</cn>
        <cn type="float">0.0</cn>
       </matrixrow>
       <matrixrow>
        <cn type="float">0.0</cn>
        <cn type="float">0.2</cn>
       </matrixrow>
      </matrix>
      <matrix>
       <matrixrow>
        <cn type="float">0.3763</cn>
       </matrixrow>
       <matrixrow>
        <cn type="float">0.6237</cn>
       </matrixrow>
      </matrix>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <ci>α</ci>
      <matrix>
       <matrixrow>
        <cn type="float">0.2745</cn>
       </matrixrow>
       <matrixrow>
        <cn type="float">0.1889</cn>
       </matrixrow>
      </matrix>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <matrix>
      <matrixrow>
       <cn type="float">0.5923</cn>
      </matrixrow>
      <matrixrow>
       <cn type="float">0.4077</cn>
      </matrixrow>
     </matrix>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{\hat{b}_{1:5}}=\alpha\begin{pmatrix}0.7&0.3\\
0.3&0.7\end{pmatrix}\begin{pmatrix}0.9&0.0\\
0.0&0.2\end{pmatrix}\begin{pmatrix}0.3763\\
0.6237\end{pmatrix}=\alpha\begin{pmatrix}0.2745\\
0.1889\end{pmatrix}=\begin{pmatrix}0.5923\\
0.4077\end{pmatrix}
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Forward–backward_algorithm:62">
 <semantics>
  <mrow>
   <msub>
    <mover accent="true">
     <mi>𝐛</mi>
     <mo stretchy="false">^</mo>
    </mover>
    <mrow>
     <mn>𝟎</mn>
     <mo>:</mo>
     <mn>𝟓</mn>
    </mrow>
   </msub>
   <mo>=</mo>
   <mrow>
    <mi>α</mi>
    <mrow>
     <mo>(</mo>
     <mtable displaystyle="true">
      <mtr>
       <mtd columnalign="center">
        <mn>0.7</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>0.3</mn>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mn>0.3</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>0.7</mn>
       </mtd>
      </mtr>
     </mtable>
     <mo>)</mo>
    </mrow>
    <mrow>
     <mo>(</mo>
     <mtable displaystyle="true">
      <mtr>
       <mtd columnalign="center">
        <mn>0.9</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>0.0</mn>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mn>0.0</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>0.2</mn>
       </mtd>
      </mtr>
     </mtable>
     <mo>)</mo>
    </mrow>
    <mrow>
     <mo>(</mo>
     <mtable displaystyle="true">
      <mtr>
       <mtd columnalign="center">
        <mn>0.5923</mn>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mn>0.4077</mn>
       </mtd>
      </mtr>
     </mtable>
     <mo>)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mi>α</mi>
    <mrow>
     <mo>(</mo>
     <mtable displaystyle="true">
      <mtr>
       <mtd columnalign="center">
        <mn>0.3976</mn>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mn>0.2170</mn>
       </mtd>
      </mtr>
     </mtable>
     <mo>)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mo>(</mo>
    <mtable displaystyle="true">
     <mtr>
      <mtd columnalign="center">
       <mn>0.6469</mn>
      </mtd>
     </mtr>
     <mtr>
      <mtd columnalign="center">
       <mn>0.3531</mn>
      </mtd>
     </mtr>
    </mtable>
    <mo>)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <ci>normal-^</ci>
       <ci>𝐛</ci>
      </apply>
      <apply>
       <ci>normal-:</ci>
       <cn type="integer">0</cn>
       <cn type="integer">5</cn>
      </apply>
     </apply>
     <apply>
      <times></times>
      <ci>α</ci>
      <matrix>
       <matrixrow>
        <cn type="float">0.7</cn>
        <cn type="float">0.3</cn>
       </matrixrow>
       <matrixrow>
        <cn type="float">0.3</cn>
        <cn type="float">0.7</cn>
       </matrixrow>
      </matrix>
      <matrix>
       <matrixrow>
        <cn type="float">0.9</cn>
        <cn type="float">0.0</cn>
       </matrixrow>
       <matrixrow>
        <cn type="float">0.0</cn>
        <cn type="float">0.2</cn>
       </matrixrow>
      </matrix>
      <matrix>
       <matrixrow>
        <cn type="float">0.5923</cn>
       </matrixrow>
       <matrixrow>
        <cn type="float">0.4077</cn>
       </matrixrow>
      </matrix>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <ci>α</ci>
      <matrix>
       <matrixrow>
        <cn type="float">0.3976</cn>
       </matrixrow>
       <matrixrow>
        <cn type="float">0.2170</cn>
       </matrixrow>
      </matrix>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <matrix>
      <matrixrow>
       <cn type="float">0.6469</cn>
      </matrixrow>
      <matrixrow>
       <cn type="float">0.3531</cn>
      </matrixrow>
     </matrix>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{\hat{b}_{0:5}}=\alpha\begin{pmatrix}0.7&0.3\\
0.3&0.7\end{pmatrix}\begin{pmatrix}0.9&0.0\\
0.0&0.2\end{pmatrix}\begin{pmatrix}0.5923\\
0.4077\end{pmatrix}=\alpha\begin{pmatrix}0.3976\\
0.2170\end{pmatrix}=\begin{pmatrix}0.6469\\
0.3531\end{pmatrix}
  </annotation>
 </semantics>
</math>

</p>

<p>Finally, we will compute the smoothed probability values. These result also must be scaled so that its entries sum to 1 because we did not scale the backward probabilities with the 

<math display="inline" id="Forward–backward_algorithm:63">
 <semantics>
  <msub>
   <mi>c</mi>
   <mi>t</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>c</ci>
    <ci>t</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   c_{t}
  </annotation>
 </semantics>
</math>

's found earlier. The backward probability vectors above thus actually represent the likelihood of each state at time t given the future observations. Because these vectors are proportional to the actual backward probabilities, the result has to be scaled an additional time.</p>

<p>

<math display="block" id="Forward–backward_algorithm:64">
 <semantics>
  <mrow>
   <msup>
    <mrow>
     <mo stretchy="false">(</mo>
     <msub>
      <mi>γ</mi>
      <mn>𝟎</mn>
     </msub>
     <mo stretchy="false">)</mo>
    </mrow>
    <mi>T</mi>
   </msup>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mi>α</mi>
     <mrow>
      <mo>(</mo>
      <mtable displaystyle="true">
       <mtr>
        <mtd columnalign="center">
         <mn>0.5000</mn>
        </mtd>
       </mtr>
       <mtr>
        <mtd columnalign="center">
         <mn>0.5000</mn>
        </mtd>
       </mtr>
      </mtable>
      <mo>)</mo>
     </mrow>
    </mrow>
    <mo>∘</mo>
    <mrow>
     <mo>(</mo>
     <mtable displaystyle="true">
      <mtr>
       <mtd columnalign="center">
        <mn>0.6469</mn>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mn>0.3531</mn>
       </mtd>
      </mtr>
     </mtable>
     <mo>)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mi>α</mi>
    <mrow>
     <mo>(</mo>
     <mtable displaystyle="true">
      <mtr>
       <mtd columnalign="center">
        <mn>0.3235</mn>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mn>0.1765</mn>
       </mtd>
      </mtr>
     </mtable>
     <mo>)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mo>(</mo>
    <mtable displaystyle="true">
     <mtr>
      <mtd columnalign="center">
       <mn>0.6469</mn>
      </mtd>
     </mtr>
     <mtr>
      <mtd columnalign="center">
       <mn>0.3531</mn>
      </mtd>
     </mtr>
    </mtable>
    <mo>)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>γ</ci>
       <cn type="integer">0</cn>
      </apply>
      <ci>T</ci>
     </apply>
     <apply>
      <compose></compose>
      <apply>
       <times></times>
       <ci>α</ci>
       <matrix>
        <matrixrow>
         <cn type="float">0.5000</cn>
        </matrixrow>
        <matrixrow>
         <cn type="float">0.5000</cn>
        </matrixrow>
       </matrix>
      </apply>
      <matrix>
       <matrixrow>
        <cn type="float">0.6469</cn>
       </matrixrow>
       <matrixrow>
        <cn type="float">0.3531</cn>
       </matrixrow>
      </matrix>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <ci>α</ci>
      <matrix>
       <matrixrow>
        <cn type="float">0.3235</cn>
       </matrixrow>
       <matrixrow>
        <cn type="float">0.1765</cn>
       </matrixrow>
      </matrix>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <matrix>
      <matrixrow>
       <cn type="float">0.6469</cn>
      </matrixrow>
      <matrixrow>
       <cn type="float">0.3531</cn>
      </matrixrow>
     </matrix>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (\mathbf{\gamma_{0}})^{T}=\alpha\begin{pmatrix}0.5000\\
0.5000\end{pmatrix}\circ\begin{pmatrix}0.6469\\
0.3531\end{pmatrix}=\alpha\begin{pmatrix}0.3235\\
0.1765\end{pmatrix}=\begin{pmatrix}0.6469\\
0.3531\end{pmatrix}
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Forward–backward_algorithm:65">
 <semantics>
  <mrow>
   <msup>
    <mrow>
     <mo stretchy="false">(</mo>
     <msub>
      <mi>γ</mi>
      <mn>𝟏</mn>
     </msub>
     <mo stretchy="false">)</mo>
    </mrow>
    <mi>T</mi>
   </msup>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mi>α</mi>
     <mrow>
      <mo>(</mo>
      <mtable displaystyle="true">
       <mtr>
        <mtd columnalign="center">
         <mn>0.8182</mn>
        </mtd>
       </mtr>
       <mtr>
        <mtd columnalign="center">
         <mn>0.1818</mn>
        </mtd>
       </mtr>
      </mtable>
      <mo>)</mo>
     </mrow>
    </mrow>
    <mo>∘</mo>
    <mrow>
     <mo>(</mo>
     <mtable displaystyle="true">
      <mtr>
       <mtd columnalign="center">
        <mn>0.5923</mn>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mn>0.4077</mn>
       </mtd>
      </mtr>
     </mtable>
     <mo>)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mi>α</mi>
    <mrow>
     <mo>(</mo>
     <mtable displaystyle="true">
      <mtr>
       <mtd columnalign="center">
        <mn>0.4846</mn>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mn>0.0741</mn>
       </mtd>
      </mtr>
     </mtable>
     <mo>)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mo>(</mo>
    <mtable displaystyle="true">
     <mtr>
      <mtd columnalign="center">
       <mn>0.8673</mn>
      </mtd>
     </mtr>
     <mtr>
      <mtd columnalign="center">
       <mn>0.1327</mn>
      </mtd>
     </mtr>
    </mtable>
    <mo>)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>γ</ci>
       <cn type="integer">1</cn>
      </apply>
      <ci>T</ci>
     </apply>
     <apply>
      <compose></compose>
      <apply>
       <times></times>
       <ci>α</ci>
       <matrix>
        <matrixrow>
         <cn type="float">0.8182</cn>
        </matrixrow>
        <matrixrow>
         <cn type="float">0.1818</cn>
        </matrixrow>
       </matrix>
      </apply>
      <matrix>
       <matrixrow>
        <cn type="float">0.5923</cn>
       </matrixrow>
       <matrixrow>
        <cn type="float">0.4077</cn>
       </matrixrow>
      </matrix>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <ci>α</ci>
      <matrix>
       <matrixrow>
        <cn type="float">0.4846</cn>
       </matrixrow>
       <matrixrow>
        <cn type="float">0.0741</cn>
       </matrixrow>
      </matrix>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <matrix>
      <matrixrow>
       <cn type="float">0.8673</cn>
      </matrixrow>
      <matrixrow>
       <cn type="float">0.1327</cn>
      </matrixrow>
     </matrix>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (\mathbf{\gamma_{1}})^{T}=\alpha\begin{pmatrix}0.8182\\
0.1818\end{pmatrix}\circ\begin{pmatrix}0.5923\\
0.4077\end{pmatrix}=\alpha\begin{pmatrix}0.4846\\
0.0741\end{pmatrix}=\begin{pmatrix}0.8673\\
0.1327\end{pmatrix}
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Forward–backward_algorithm:66">
 <semantics>
  <mrow>
   <msup>
    <mrow>
     <mo stretchy="false">(</mo>
     <msub>
      <mi>γ</mi>
      <mn>𝟐</mn>
     </msub>
     <mo stretchy="false">)</mo>
    </mrow>
    <mi>T</mi>
   </msup>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mi>α</mi>
     <mrow>
      <mo>(</mo>
      <mtable displaystyle="true">
       <mtr>
        <mtd columnalign="center">
         <mn>0.8834</mn>
        </mtd>
       </mtr>
       <mtr>
        <mtd columnalign="center">
         <mn>0.1166</mn>
        </mtd>
       </mtr>
      </mtable>
      <mo>)</mo>
     </mrow>
    </mrow>
    <mo>∘</mo>
    <mrow>
     <mo>(</mo>
     <mtable displaystyle="true">
      <mtr>
       <mtd columnalign="center">
        <mn>0.3763</mn>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mn>0.6237</mn>
       </mtd>
      </mtr>
     </mtable>
     <mo>)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mi>α</mi>
    <mrow>
     <mo>(</mo>
     <mtable displaystyle="true">
      <mtr>
       <mtd columnalign="center">
        <mn>0.3324</mn>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mn>0.0728</mn>
       </mtd>
      </mtr>
     </mtable>
     <mo>)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mo>(</mo>
    <mtable displaystyle="true">
     <mtr>
      <mtd columnalign="center">
       <mn>0.8204</mn>
      </mtd>
     </mtr>
     <mtr>
      <mtd columnalign="center">
       <mn>0.1796</mn>
      </mtd>
     </mtr>
    </mtable>
    <mo>)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>γ</ci>
       <cn type="integer">2</cn>
      </apply>
      <ci>T</ci>
     </apply>
     <apply>
      <compose></compose>
      <apply>
       <times></times>
       <ci>α</ci>
       <matrix>
        <matrixrow>
         <cn type="float">0.8834</cn>
        </matrixrow>
        <matrixrow>
         <cn type="float">0.1166</cn>
        </matrixrow>
       </matrix>
      </apply>
      <matrix>
       <matrixrow>
        <cn type="float">0.3763</cn>
       </matrixrow>
       <matrixrow>
        <cn type="float">0.6237</cn>
       </matrixrow>
      </matrix>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <ci>α</ci>
      <matrix>
       <matrixrow>
        <cn type="float">0.3324</cn>
       </matrixrow>
       <matrixrow>
        <cn type="float">0.0728</cn>
       </matrixrow>
      </matrix>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <matrix>
      <matrixrow>
       <cn type="float">0.8204</cn>
      </matrixrow>
      <matrixrow>
       <cn type="float">0.1796</cn>
      </matrixrow>
     </matrix>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (\mathbf{\gamma_{2}})^{T}=\alpha\begin{pmatrix}0.8834\\
0.1166\end{pmatrix}\circ\begin{pmatrix}0.3763\\
0.6237\end{pmatrix}=\alpha\begin{pmatrix}0.3324\\
0.0728\end{pmatrix}=\begin{pmatrix}0.8204\\
0.1796\end{pmatrix}
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Forward–backward_algorithm:67">
 <semantics>
  <mrow>
   <msup>
    <mrow>
     <mo stretchy="false">(</mo>
     <msub>
      <mi>γ</mi>
      <mn>𝟑</mn>
     </msub>
     <mo stretchy="false">)</mo>
    </mrow>
    <mi>T</mi>
   </msup>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mi>α</mi>
     <mrow>
      <mo>(</mo>
      <mtable displaystyle="true">
       <mtr>
        <mtd columnalign="center">
         <mn>0.1907</mn>
        </mtd>
       </mtr>
       <mtr>
        <mtd columnalign="center">
         <mn>0.8093</mn>
        </mtd>
       </mtr>
      </mtable>
      <mo>)</mo>
     </mrow>
    </mrow>
    <mo>∘</mo>
    <mrow>
     <mo>(</mo>
     <mtable displaystyle="true">
      <mtr>
       <mtd columnalign="center">
        <mn>0.6533</mn>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mn>0.3467</mn>
       </mtd>
      </mtr>
     </mtable>
     <mo>)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mi>α</mi>
    <mrow>
     <mo>(</mo>
     <mtable displaystyle="true">
      <mtr>
       <mtd columnalign="center">
        <mn>0.1246</mn>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mn>0.2806</mn>
       </mtd>
      </mtr>
     </mtable>
     <mo>)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mo>(</mo>
    <mtable displaystyle="true">
     <mtr>
      <mtd columnalign="center">
       <mn>0.3075</mn>
      </mtd>
     </mtr>
     <mtr>
      <mtd columnalign="center">
       <mn>0.6925</mn>
      </mtd>
     </mtr>
    </mtable>
    <mo>)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>γ</ci>
       <cn type="integer">3</cn>
      </apply>
      <ci>T</ci>
     </apply>
     <apply>
      <compose></compose>
      <apply>
       <times></times>
       <ci>α</ci>
       <matrix>
        <matrixrow>
         <cn type="float">0.1907</cn>
        </matrixrow>
        <matrixrow>
         <cn type="float">0.8093</cn>
        </matrixrow>
       </matrix>
      </apply>
      <matrix>
       <matrixrow>
        <cn type="float">0.6533</cn>
       </matrixrow>
       <matrixrow>
        <cn type="float">0.3467</cn>
       </matrixrow>
      </matrix>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <ci>α</ci>
      <matrix>
       <matrixrow>
        <cn type="float">0.1246</cn>
       </matrixrow>
       <matrixrow>
        <cn type="float">0.2806</cn>
       </matrixrow>
      </matrix>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <matrix>
      <matrixrow>
       <cn type="float">0.3075</cn>
      </matrixrow>
      <matrixrow>
       <cn type="float">0.6925</cn>
      </matrixrow>
     </matrix>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (\mathbf{\gamma_{3}})^{T}=\alpha\begin{pmatrix}0.1907\\
0.8093\end{pmatrix}\circ\begin{pmatrix}0.6533\\
0.3467\end{pmatrix}=\alpha\begin{pmatrix}0.1246\\
0.2806\end{pmatrix}=\begin{pmatrix}0.3075\\
0.6925\end{pmatrix}
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Forward–backward_algorithm:68">
 <semantics>
  <mrow>
   <msup>
    <mrow>
     <mo stretchy="false">(</mo>
     <msub>
      <mi>γ</mi>
      <mn>𝟒</mn>
     </msub>
     <mo stretchy="false">)</mo>
    </mrow>
    <mi>T</mi>
   </msup>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mi>α</mi>
     <mrow>
      <mo>(</mo>
      <mtable displaystyle="true">
       <mtr>
        <mtd columnalign="center">
         <mn>0.7308</mn>
        </mtd>
       </mtr>
       <mtr>
        <mtd columnalign="center">
         <mn>0.2692</mn>
        </mtd>
       </mtr>
      </mtable>
      <mo>)</mo>
     </mrow>
    </mrow>
    <mo>∘</mo>
    <mrow>
     <mo>(</mo>
     <mtable displaystyle="true">
      <mtr>
       <mtd columnalign="center">
        <mn>0.6273</mn>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mn>0.3727</mn>
       </mtd>
      </mtr>
     </mtable>
     <mo>)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mi>α</mi>
    <mrow>
     <mo>(</mo>
     <mtable displaystyle="true">
      <mtr>
       <mtd columnalign="center">
        <mn>0.4584</mn>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mn>0.1003</mn>
       </mtd>
      </mtr>
     </mtable>
     <mo>)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mo>(</mo>
    <mtable displaystyle="true">
     <mtr>
      <mtd columnalign="center">
       <mn>0.8204</mn>
      </mtd>
     </mtr>
     <mtr>
      <mtd columnalign="center">
       <mn>0.1796</mn>
      </mtd>
     </mtr>
    </mtable>
    <mo>)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>γ</ci>
       <cn type="integer">4</cn>
      </apply>
      <ci>T</ci>
     </apply>
     <apply>
      <compose></compose>
      <apply>
       <times></times>
       <ci>α</ci>
       <matrix>
        <matrixrow>
         <cn type="float">0.7308</cn>
        </matrixrow>
        <matrixrow>
         <cn type="float">0.2692</cn>
        </matrixrow>
       </matrix>
      </apply>
      <matrix>
       <matrixrow>
        <cn type="float">0.6273</cn>
       </matrixrow>
       <matrixrow>
        <cn type="float">0.3727</cn>
       </matrixrow>
      </matrix>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <ci>α</ci>
      <matrix>
       <matrixrow>
        <cn type="float">0.4584</cn>
       </matrixrow>
       <matrixrow>
        <cn type="float">0.1003</cn>
       </matrixrow>
      </matrix>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <matrix>
      <matrixrow>
       <cn type="float">0.8204</cn>
      </matrixrow>
      <matrixrow>
       <cn type="float">0.1796</cn>
      </matrixrow>
     </matrix>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (\mathbf{\gamma_{4}})^{T}=\alpha\begin{pmatrix}0.7308\\
0.2692\end{pmatrix}\circ\begin{pmatrix}0.6273\\
0.3727\end{pmatrix}=\alpha\begin{pmatrix}0.4584\\
0.1003\end{pmatrix}=\begin{pmatrix}0.8204\\
0.1796\end{pmatrix}
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Forward–backward_algorithm:69">
 <semantics>
  <mrow>
   <msup>
    <mrow>
     <mo stretchy="false">(</mo>
     <msub>
      <mi>γ</mi>
      <mn>𝟓</mn>
     </msub>
     <mo stretchy="false">)</mo>
    </mrow>
    <mi>T</mi>
   </msup>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mi>α</mi>
     <mrow>
      <mo>(</mo>
      <mtable displaystyle="true">
       <mtr>
        <mtd columnalign="center">
         <mn>0.8673</mn>
        </mtd>
       </mtr>
       <mtr>
        <mtd columnalign="center">
         <mn>0.1327</mn>
        </mtd>
       </mtr>
      </mtable>
      <mo>)</mo>
     </mrow>
    </mrow>
    <mo>∘</mo>
    <mrow>
     <mo>(</mo>
     <mtable displaystyle="true">
      <mtr>
       <mtd columnalign="center">
        <mn>1.0000</mn>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mn>1.0000</mn>
       </mtd>
      </mtr>
     </mtable>
     <mo>)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mi>α</mi>
    <mrow>
     <mo>(</mo>
     <mtable displaystyle="true">
      <mtr>
       <mtd columnalign="center">
        <mn>0.8673</mn>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mn>0.1327</mn>
       </mtd>
      </mtr>
     </mtable>
     <mo>)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mo>(</mo>
    <mtable displaystyle="true">
     <mtr>
      <mtd columnalign="center">
       <mn>0.8673</mn>
      </mtd>
     </mtr>
     <mtr>
      <mtd columnalign="center">
       <mn>0.1327</mn>
      </mtd>
     </mtr>
    </mtable>
    <mo>)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>γ</ci>
       <cn type="integer">5</cn>
      </apply>
      <ci>T</ci>
     </apply>
     <apply>
      <compose></compose>
      <apply>
       <times></times>
       <ci>α</ci>
       <matrix>
        <matrixrow>
         <cn type="float">0.8673</cn>
        </matrixrow>
        <matrixrow>
         <cn type="float">0.1327</cn>
        </matrixrow>
       </matrix>
      </apply>
      <matrix>
       <matrixrow>
        <cn type="float">1.0000</cn>
       </matrixrow>
       <matrixrow>
        <cn type="float">1.0000</cn>
       </matrixrow>
      </matrix>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <ci>α</ci>
      <matrix>
       <matrixrow>
        <cn type="float">0.8673</cn>
       </matrixrow>
       <matrixrow>
        <cn type="float">0.1327</cn>
       </matrixrow>
      </matrix>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <matrix>
      <matrixrow>
       <cn type="float">0.8673</cn>
      </matrixrow>
      <matrixrow>
       <cn type="float">0.1327</cn>
      </matrixrow>
     </matrix>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (\mathbf{\gamma_{5}})^{T}=\alpha\begin{pmatrix}0.8673\\
0.1327\end{pmatrix}\circ\begin{pmatrix}1.0000\\
1.0000\end{pmatrix}=\alpha\begin{pmatrix}0.8673\\
0.1327\end{pmatrix}=\begin{pmatrix}0.8673\\
0.1327\end{pmatrix}
  </annotation>
 </semantics>
</math>

</p>

<p>Notice that the value of 

<math display="inline" id="Forward–backward_algorithm:70">
 <semantics>
  <msub>
   <mi>γ</mi>
   <mn>𝟎</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>γ</ci>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{\gamma_{0}}
  </annotation>
 </semantics>
</math>


 is equal to 

<math display="inline" id="Forward–backward_algorithm:71">
 <semantics>
  <msub>
   <mover accent="true">
    <mi>𝐛</mi>
    <mo stretchy="false">^</mo>
   </mover>
   <mrow>
    <mn>𝟎</mn>
    <mo>:</mo>
    <mn>𝟓</mn>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <apply>
     <ci>normal-^</ci>
     <ci>𝐛</ci>
    </apply>
    <apply>
     <ci>normal-:</ci>
     <cn type="integer">0</cn>
     <cn type="integer">5</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{\hat{b}_{0:5}}
  </annotation>
 </semantics>
</math>

 and that 

<math display="inline" id="Forward–backward_algorithm:72">
 <semantics>
  <msub>
   <mi>γ</mi>
   <mn>𝟓</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>γ</ci>
    <cn type="integer">5</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{\gamma_{5}}
  </annotation>
 </semantics>
</math>

 is equal to 

<math display="inline" id="Forward–backward_algorithm:73">
 <semantics>
  <msub>
   <mover accent="true">
    <mi>𝐟</mi>
    <mo stretchy="false">^</mo>
   </mover>
   <mrow>
    <mn>𝟎</mn>
    <mo>:</mo>
    <mn>𝟓</mn>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <apply>
     <ci>normal-^</ci>
     <ci>𝐟</ci>
    </apply>
    <apply>
     <ci>normal-:</ci>
     <cn type="integer">0</cn>
     <cn type="integer">5</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{\hat{f}_{0:5}}
  </annotation>
 </semantics>
</math>

. This follows naturally because both 

<math display="inline" id="Forward–backward_algorithm:74">
 <semantics>
  <msub>
   <mover accent="true">
    <mi>𝐟</mi>
    <mo stretchy="false">^</mo>
   </mover>
   <mrow>
    <mn>𝟎</mn>
    <mo>:</mo>
    <mn>𝟓</mn>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <apply>
     <ci>normal-^</ci>
     <ci>𝐟</ci>
    </apply>
    <apply>
     <ci>normal-:</ci>
     <cn type="integer">0</cn>
     <cn type="integer">5</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{\hat{f}_{0:5}}
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Forward–backward_algorithm:75">
 <semantics>
  <msub>
   <mover accent="true">
    <mi>𝐛</mi>
    <mo stretchy="false">^</mo>
   </mover>
   <mrow>
    <mn>𝟎</mn>
    <mo>:</mo>
    <mn>𝟓</mn>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <apply>
     <ci>normal-^</ci>
     <ci>𝐛</ci>
    </apply>
    <apply>
     <ci>normal-:</ci>
     <cn type="integer">0</cn>
     <cn type="integer">5</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{\hat{b}_{0:5}}
  </annotation>
 </semantics>
</math>


 begin with uniform priors over the initial and final state vectors (respectively) and take into account all of the observations. However, 

<math display="inline" id="Forward–backward_algorithm:76">
 <semantics>
  <msub>
   <mi>γ</mi>
   <mn>𝟎</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>γ</ci>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{\gamma_{0}}
  </annotation>
 </semantics>
</math>

 will only be equal to 

<math display="inline" id="Forward–backward_algorithm:77">
 <semantics>
  <msub>
   <mover accent="true">
    <mi>𝐛</mi>
    <mo stretchy="false">^</mo>
   </mover>
   <mrow>
    <mn>𝟎</mn>
    <mo>:</mo>
    <mn>𝟓</mn>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <apply>
     <ci>normal-^</ci>
     <ci>𝐛</ci>
    </apply>
    <apply>
     <ci>normal-:</ci>
     <cn type="integer">0</cn>
     <cn type="integer">5</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{\hat{b}_{0:5}}
  </annotation>
 </semantics>
</math>

 when our initial state vector represents a uniform prior (i.e. all entries are equal). When this is not the case 

<math display="inline" id="Forward–backward_algorithm:78">
 <semantics>
  <msub>
   <mover accent="true">
    <mi>𝐛</mi>
    <mo stretchy="false">^</mo>
   </mover>
   <mrow>
    <mn>𝟎</mn>
    <mo>:</mo>
    <mn>𝟓</mn>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <apply>
     <ci>normal-^</ci>
     <ci>𝐛</ci>
    </apply>
    <apply>
     <ci>normal-:</ci>
     <cn type="integer">0</cn>
     <cn type="integer">5</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{\hat{b}_{0:5}}
  </annotation>
 </semantics>
</math>

 needs to be combined with the initial state vector to find the most likely initial state. We thus find that the forward probabilities by themselves are sufficient to calculate the most likely final state. Similarly, the backward probabilities can be combined with the initial state vector to provide the most probable initial state given the observations. The forward and backward probabilities need only be combined to infer the most probable states between the initial and final points.</p>

<p>The calculations above reveal that the most probable weather state on every day except for the third one was "rain." They tell us more than this, however, as they now provide a way to quantify the probabilities of each state at different times. Perhaps most importantly, our value at 

<math display="inline" id="Forward–backward_algorithm:79">
 <semantics>
  <msub>
   <mi>γ</mi>
   <mn>𝟓</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>γ</ci>
    <cn type="integer">5</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{\gamma_{5}}
  </annotation>
 </semantics>
</math>

 quantifies our knowledge of the state vector at the end of the observation sequence. We can then use this to predict the probability of the various weather states tomorrow as well as the probability of observing an umbrella.</p>
<h2 id="performance">Performance</h2>

<p>The brute-force procedure for the solution of this problem is the generation of all possible 

<math display="inline" id="Forward–backward_algorithm:80">
 <semantics>
  <msup>
   <mi>N</mi>
   <mi>T</mi>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>N</ci>
    <ci>T</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   N^{T}
  </annotation>
 </semantics>
</math>


 state sequences and calculating the joint probability of each state sequence with the observed series of events. This approach has <a href="time_complexity" title="wikilink">time complexity</a> 

<math display="inline" id="Forward–backward_algorithm:81">
 <semantics>
  <mrow>
   <mi>O</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mrow>
     <mi>T</mi>
     <mo>⋅</mo>
     <msup>
      <mi>N</mi>
      <mi>T</mi>
     </msup>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>O</ci>
    <apply>
     <ci>normal-⋅</ci>
     <ci>T</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>N</ci>
      <ci>T</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   O(T\cdot N^{T})
  </annotation>
 </semantics>
</math>

, where 

<math display="inline" id="Forward–backward_algorithm:82">
 <semantics>
  <mi>T</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>T</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   T
  </annotation>
 </semantics>
</math>

 is the length of sequences and 

<math display="inline" id="Forward–backward_algorithm:83">
 <semantics>
  <mi>N</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>N</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   N
  </annotation>
 </semantics>
</math>

 is the number of symbols in the state alphabet. This is intractable for realistic problems, as the number of possible hidden node sequences typically is extremely high. However, the forward–backward algorithm has time complexity 

<math display="inline" id="Forward–backward_algorithm:84">
 <semantics>
  <mrow>
   <mi>O</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mrow>
     <msup>
      <mi>N</mi>
      <mn>2</mn>
     </msup>
     <mi>T</mi>
    </mrow>
    <mo rspace="4.2pt" stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>O</ci>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>N</ci>
      <cn type="integer">2</cn>
     </apply>
     <ci>T</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   O(N^{2}T)\,
  </annotation>
 </semantics>
</math>

.</p>

<p>An enhancement to the general forward-backward algorithm, called the <a href="Island_algorithm" title="wikilink">Island algorithm</a>, trades smaller memory usage for longer running time, taking 

<math display="inline" id="Forward–backward_algorithm:85">
 <semantics>
  <mrow>
   <mi>O</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mrow>
     <msup>
      <mi>N</mi>
      <mn>2</mn>
     </msup>
     <mi>T</mi>
     <mrow>
      <mi>log</mi>
      <mi>T</mi>
     </mrow>
    </mrow>
    <mo rspace="4.2pt" stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>O</ci>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>N</ci>
      <cn type="integer">2</cn>
     </apply>
     <ci>T</ci>
     <apply>
      <log></log>
      <ci>T</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   O(N^{2}T\log T)\,
  </annotation>
 </semantics>
</math>


 time and 

<math display="inline" id="Forward–backward_algorithm:86">
 <semantics>
  <mrow>
   <mi>O</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mrow>
     <msup>
      <mi>N</mi>
      <mn>2</mn>
     </msup>
     <mrow>
      <mi>log</mi>
      <mi>T</mi>
     </mrow>
    </mrow>
    <mo rspace="4.2pt" stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>O</ci>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>N</ci>
      <cn type="integer">2</cn>
     </apply>
     <apply>
      <log></log>
      <ci>T</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   O(N^{2}\log T)\,
  </annotation>
 </semantics>
</math>

 memory. On a computer with an unlimited number of processors, this can be reduced to 

<math display="inline" id="Forward–backward_algorithm:87">
 <semantics>
  <mrow>
   <mi>O</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mrow>
     <msup>
      <mi>N</mi>
      <mn>2</mn>
     </msup>
     <mi>T</mi>
    </mrow>
    <mo rspace="4.2pt" stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>O</ci>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>N</ci>
      <cn type="integer">2</cn>
     </apply>
     <ci>T</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   O(N^{2}T)\,
  </annotation>
 </semantics>
</math>

 total time, while still taking only 

<math display="inline" id="Forward–backward_algorithm:88">
 <semantics>
  <mrow>
   <mi>O</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mrow>
     <msup>
      <mi>N</mi>
      <mn>2</mn>
     </msup>
     <mrow>
      <mi>log</mi>
      <mi>T</mi>
     </mrow>
    </mrow>
    <mo rspace="4.2pt" stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>O</ci>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>N</ci>
      <cn type="integer">2</cn>
     </apply>
     <apply>
      <log></log>
      <ci>T</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   O(N^{2}\log T)\,
  </annotation>
 </semantics>
</math>

 memory.<a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a></p>

<p>In addition, algorithms have been developed to compute 

<math display="inline" id="Forward–backward_algorithm:89">
 <semantics>
  <msub>
   <mi>𝐟</mi>
   <mrow>
    <mn>𝟎</mn>
    <mo>:</mo>
    <mrow>
     <mi>𝐭</mi>
     <mo>+</mo>
     <mn>𝟏</mn>
    </mrow>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>𝐟</ci>
    <apply>
     <ci>normal-:</ci>
     <cn type="integer">0</cn>
     <apply>
      <plus></plus>
      <ci>𝐭</ci>
      <cn type="integer">1</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{f_{0:t+1}}
  </annotation>
 </semantics>
</math>

 efficiently through online smoothing such as the fixed-lag smoothing (FLS) algorithm <a href="#RussellNorvig10" title="wikilink">Russell &amp; Norvig 2010 Figure 15.6 pp. 580</a>.</p>
<h2 id="pseudocode">Pseudocode</h2>
<pre><code>ForwardBackward(guessState, sequenceIndex):
    if sequenceIndex is past the end of the sequence, return 1
    if (guessState, sequenceIndex) has been seen before, return saved result
    result = 0
    for each neighboring state n:
        result = result + (transition probability from guessState to 
                           n given observation element at sequenceIndex)
                        * ForwardBackward(n, sequenceIndex+1)
    save result for (guessState, sequenceIndex)
    return result</code></pre>
<h2 id="python-example">Python example</h2>

<p>Given HMM (just like in <a href="Viterbi_algorithm" title="wikilink">Viterbi algorithm</a>) represented in the <a href="Python_programming_language" title="wikilink">Python programming language</a>:</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python">states <span class="op">=</span> (<span class="st">'Healthy'</span>, <span class="st">'Fever'</span>)
end_state <span class="op">=</span> <span class="st">'E'</span>
 
observations <span class="op">=</span> (<span class="st">'normal'</span>, <span class="st">'cold'</span>, <span class="st">'dizzy'</span>)
 
start_probability <span class="op">=</span> {<span class="st">'Healthy'</span>: <span class="fl">0.6</span>, <span class="st">'Fever'</span>: <span class="fl">0.4</span>}
 
transition_probability <span class="op">=</span> {
   <span class="st">'Healthy'</span> : {<span class="st">'Healthy'</span>: <span class="fl">0.69</span>, <span class="st">'Fever'</span>: <span class="fl">0.3</span>, <span class="st">'E'</span>: <span class="fl">0.01</span>},
   <span class="co">'Fever'</span> : {<span class="st">'Healthy'</span>: <span class="fl">0.4</span>, <span class="st">'Fever'</span>: <span class="fl">0.59</span>, <span class="st">'E'</span>: <span class="fl">0.01</span>},
   }
 
emission_probability <span class="op">=</span> {
   <span class="st">'Healthy'</span> : {<span class="st">'normal'</span>: <span class="fl">0.5</span>, <span class="st">'cold'</span>: <span class="fl">0.4</span>, <span class="st">'dizzy'</span>: <span class="fl">0.1</span>},
   <span class="co">'Fever'</span> : {<span class="st">'normal'</span>: <span class="fl">0.1</span>, <span class="st">'cold'</span>: <span class="fl">0.3</span>, <span class="st">'dizzy'</span>: <span class="fl">0.6</span>},
   }</code></pre></div>

<p>We can write implementation like this:</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="kw">def</span> fwd_bkw(x, states, a_0, a, e, end_st):
    L <span class="op">=</span> <span class="bu">len</span>(x)
 
    fwd <span class="op">=</span> []
    f_prev <span class="op">=</span> {}
    <span class="co"># forward part of the algorithm</span>
    <span class="cf">for</span> i, x_i <span class="op">in</span> <span class="bu">enumerate</span>(x):
        f_curr <span class="op">=</span> {}
        <span class="cf">for</span> st <span class="op">in</span> states:
            <span class="cf">if</span> i <span class="op">==</span> <span class="dv">0</span>:
                <span class="co"># base case for the forward part</span>
                prev_f_sum <span class="op">=</span> a_0[st]
            <span class="cf">else</span>:
                prev_f_sum <span class="op">=</span> <span class="bu">sum</span>(f_prev[k]<span class="op">*</span>a[k][st] <span class="cf">for</span> k <span class="op">in</span> states)
 
            f_curr[st] <span class="op">=</span> e[st][x_i] <span class="op">*</span> prev_f_sum
        
        sum_prob <span class="op">=</span> <span class="bu">sum</span>(f_curr.values())
        <span class="cf">for</span> st <span class="op">in</span> states:
            f_curr[st] <span class="op">/=</span> sum_prob <span class="co"># normalising to make sum == 1</span>

        fwd.append(f_curr)
        f_prev <span class="op">=</span> f_curr
 
    p_fwd <span class="op">=</span> <span class="bu">sum</span>(f_curr[k]<span class="op">*</span>a[k][end_st] <span class="cf">for</span> k <span class="op">in</span> states)
 
    bkw <span class="op">=</span> []
    b_prev <span class="op">=</span> {}
    <span class="co"># backward part of the algorithm</span>
    <span class="cf">for</span> i, x_i_plus <span class="op">in</span> <span class="bu">enumerate</span>(<span class="bu">reversed</span>(x[<span class="dv">1</span>:]<span class="op">+</span>(<span class="va">None</span>,))):
        b_curr <span class="op">=</span> {}
        <span class="cf">for</span> st <span class="op">in</span> states:
            <span class="cf">if</span> i <span class="op">==</span> <span class="dv">0</span>:
                <span class="co"># base case for backward part</span>
                b_curr[st] <span class="op">=</span> a[st][end_st]
            <span class="cf">else</span>:
                b_curr[st] <span class="op">=</span> <span class="bu">sum</span>(a[st][l]<span class="op">*</span>e[l][x_i_plus]<span class="op">*</span>b_prev[l] <span class="cf">for</span> l <span class="op">in</span> states)
 

        sum_prob <span class="op">=</span> <span class="bu">sum</span>(b_curr.values())
        <span class="cf">for</span> st <span class="op">in</span> states:
            b_curr[st] <span class="op">/=</span> sum_prob <span class="co"># normalising to make sum == 1  </span>

        bkw.insert(<span class="dv">0</span>,b_curr)
        b_prev <span class="op">=</span> b_curr
 
    p_bkw <span class="op">=</span> <span class="bu">sum</span>(a_0[l] <span class="op">*</span> e[l][x[<span class="dv">0</span>]] <span class="op">*</span> b_curr[l] <span class="cf">for</span> l <span class="op">in</span> states)
 
    <span class="co"># merging the two parts</span>
    posterior <span class="op">=</span> []
    <span class="cf">for</span> i <span class="op">in</span> <span class="bu">range</span>(L):
        posterior.append({st: fwd[i][st]<span class="op">*</span>bkw[i][st]<span class="op">/</span>p_fwd <span class="cf">for</span> st <span class="op">in</span> states})
 
    <span class="cf">assert</span> p_fwd <span class="op">==</span> p_bkw
    <span class="cf">return</span> fwd, bkw, posterior</code></pre></div>

<p>The function <code>fwd_bkw</code> takes the following arguments: <code>x</code> is the sequence of observations, e.g. <code>['normal', 'cold', 'dizzy']</code>; <code>states</code> is the set of hidden states; <code>a_0</code> is the start probability; <code>a</code> are the transition probabilities; and <code>e</code> are the emission probabilities.</p>

<p>For simplicity of code, we assume that the observation sequence <code>x</code> is non-empty and that <code>a[i][j]</code> and <code>e[i][j]</code> is defined for all states i,j.</p>

<p>In the running example, the forward-backward algorithm is used as follows:</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="kw">def</span> example():
    <span class="cf">return</span> fwd_bkw(observations,
                   states,
                   start_probability,
                   transition_probability,
                   emission_probability,
                   end_state)

<span class="cf">for</span> line <span class="op">in</span> example():
    <span class="bu">print</span>(<span class="st">' '</span>.join(<span class="bu">map</span>(<span class="bu">str</span>, line)))</code></pre></div>
<h2 id="see-also">See also</h2>
<ul>
<li><a href="Baum-Welch_algorithm" title="wikilink">Baum-Welch algorithm</a></li>
<li><a href="Viterbi_algorithm" title="wikilink">Viterbi algorithm</a></li>
<li><a href="BCJR_algorithm" title="wikilink">BCJR algorithm</a></li>
</ul>
<h2 id="references">References</h2>
<ul>
<li><a href="Lawrence_Rabiner" title="wikilink">Lawrence R. Rabiner</a>, A Tutorial on Hidden Markov Models and Selected Applications in Speech Recognition. <em>Proceedings of the <a class="uri" href="IEEE" title="wikilink">IEEE</a></em>, 77 (2), p. 257–286, February 1989. <a href="http://dx.doi.org/10.1109/5.18626">10.1109/5.18626</a></li>
<li></li>
<li></li>
</ul>

<p><cite id="RussellNorvig10"></cite></p>
<ul>
<li></li>
</ul>
<h2 id="external-links">External links</h2>
<ul>
<li><a href="http://www.cs.jhu.edu/~jason/papers/#eisner-2002-tnlp">An interactive spreadsheet for teaching the forward–backward algorithm</a> (spreadsheet and article with step-by-step walk-through)</li>
<li><a href="http://www.cs.brown.edu/research/ai/dynamics/tutorial/Documents/HiddenMarkovModels.html">Tutorial of hidden Markov models including the forward–backward algorithm</a></li>
<li><a href="http://code.google.com/p/aima-java/">Collection of AI algorithms implemented in Java</a> (including HMM and the forward–backward algorithm)</li>
</ul>

<p>"</p>

<p><a href="Category:Dynamic_programming" title="wikilink">Category:Dynamic programming</a> <a href="Category:Error_detection_and_correction" title="wikilink">Category:Error detection and correction</a> <a href="Category:Machine_learning_algorithms" title="wikilink">Category:Machine learning algorithms</a> <a href="Category:Markov_models" title="wikilink">Category:Markov models</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1">J. Binder, K. Murphy and S. Russell. Space-Efficient Inference in Dynamic Probabilistic Networks. Int'l, Joint Conf. on Artificial Intelligence, 1997.<a href="#fnref1">↩</a></li>
</ol>
</section>
</body>


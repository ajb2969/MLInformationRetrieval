<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="665">Gravitational lensing formalism</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Gravitational lensing formalism</h1>
<hr/>

<p>In <a href="general_relativity" title="wikilink">general relativity</a>, a point mass deflects a light ray with <a href="impact_parameter" title="wikilink">impact parameter</a> 

<math display="inline" id="Gravitational_lensing_formalism:0">
 <semantics>
  <mpadded width="+3.3pt">
   <mi>b</mi>
  </mpadded>
  <annotation-xml encoding="MathML-Content">
   <ci>b</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   b~{}
  </annotation>
 </semantics>
</math>

 by an angle 

<math display="inline" id="Gravitational_lensing_formalism:1">
 <semantics>
  <mrow>
   <mover accent="true">
    <mi>α</mi>
    <mo stretchy="false">^</mo>
   </mover>
   <mo>=</mo>
   <mfrac>
    <mrow>
     <mn>4</mn>
     <mi>G</mi>
     <mi>M</mi>
    </mrow>
    <mrow>
     <msup>
      <mi>c</mi>
      <mn>2</mn>
     </msup>
     <mi>b</mi>
    </mrow>
   </mfrac>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <ci>normal-^</ci>
     <ci>α</ci>
    </apply>
    <apply>
     <divide></divide>
     <apply>
      <times></times>
      <cn type="integer">4</cn>
      <ci>G</ci>
      <ci>M</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>c</ci>
       <cn type="integer">2</cn>
      </apply>
      <ci>b</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \hat{\alpha}=\frac{4GM}{c^{2}b}
  </annotation>
 </semantics>
</math>

, where G is the <a href="gravitational_constant" title="wikilink">gravitational constant</a>, M the mass of the deflecting object and c the <a href="speed_of_light" title="wikilink">speed of light</a>. A naive application of <a href="Newtonian_gravity" title="wikilink">Newtonian gravity</a> can yield exactly half this value, where the light ray is assumed as a massed particle and scattered by the gravitational potential well.</p>

<p>In situations where general relativity can be approximated by <a href="linearized_gravity" title="wikilink">linearized gravity</a>, the deflection due to a spatially extended mass can be written simply as a vector sum over point masses. In the <a href="continuum_limit" title="wikilink">continuum limit</a>, this becomes an integral over the density 

<math display="inline" id="Gravitational_lensing_formalism:2">
 <semantics>
  <mpadded width="+3.3pt">
   <mi>ρ</mi>
  </mpadded>
  <annotation-xml encoding="MathML-Content">
   <ci>ρ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \rho~{}
  </annotation>
 </semantics>
</math>

, and if the deflection is small we can approximate the gravitational potential along the deflected trajectory by the potential along the undeflected trajectory, as in the <a href="Born_approximation" title="wikilink">Born approximation</a> in quantum mechanics. The deflection is then</p>

<p>

<math display="inline" id="Gravitational_lensing_formalism:3">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mover accent="true">
      <mover accent="true">
       <mi>α</mi>
       <mo stretchy="false">^</mo>
      </mover>
      <mo stretchy="false">→</mo>
     </mover>
     <mrow>
      <mo stretchy="false">(</mo>
      <mover accent="true">
       <mi>ξ</mi>
       <mo stretchy="false">→</mo>
      </mover>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mfrac>
      <mrow>
       <mn>4</mn>
       <mi>G</mi>
      </mrow>
      <msup>
       <mi>c</mi>
       <mn>2</mn>
      </msup>
     </mfrac>
     <mrow>
      <mo largeop="true" symmetric="true">∫</mo>
      <mrow>
       <msup>
        <mi>d</mi>
        <mn>2</mn>
       </msup>
       <msup>
        <mi>ξ</mi>
        <mo>′</mo>
       </msup>
       <mrow>
        <mo largeop="true" symmetric="true">∫</mo>
        <mrow>
         <mi>d</mi>
         <mi>z</mi>
         <mi>ρ</mi>
         <mrow>
          <mo stretchy="false">(</mo>
          <msup>
           <mover accent="true">
            <mi>ξ</mi>
            <mo stretchy="false">→</mo>
           </mover>
           <mo>′</mo>
          </msup>
          <mo>,</mo>
          <mi>z</mi>
          <mo stretchy="false">)</mo>
         </mrow>
         <mfrac>
          <mover accent="true">
           <mi>b</mi>
           <mo stretchy="false">→</mo>
          </mover>
          <msup>
           <mrow>
            <mo stretchy="false">|</mo>
            <mover accent="true">
             <mi>b</mi>
             <mo stretchy="false">→</mo>
            </mover>
            <mo stretchy="false">|</mo>
           </mrow>
           <mn>2</mn>
          </msup>
         </mfrac>
        </mrow>
       </mrow>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo rspace="5.8pt">,</mo>
   <mrow>
    <mover accent="true">
     <mi>b</mi>
     <mo stretchy="false">→</mo>
    </mover>
    <mo>≡</mo>
    <mrow>
     <mover accent="true">
      <mi>ξ</mi>
      <mo stretchy="false">→</mo>
     </mover>
     <mo>-</mo>
     <mover accent="true">
      <msup>
       <mi>ξ</mi>
       <mo>′</mo>
      </msup>
      <mo stretchy="false">→</mo>
     </mover>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <eq></eq>
     <apply>
      <times></times>
      <apply>
       <ci>normal-→</ci>
       <apply>
        <ci>normal-^</ci>
        <ci>α</ci>
       </apply>
      </apply>
      <apply>
       <ci>normal-→</ci>
       <ci>ξ</ci>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <apply>
        <times></times>
        <cn type="integer">4</cn>
        <ci>G</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>c</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
      <apply>
       <int></int>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>d</ci>
         <cn type="integer">2</cn>
        </apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>ξ</ci>
         <ci>normal-′</ci>
        </apply>
        <apply>
         <int></int>
         <apply>
          <times></times>
          <ci>d</ci>
          <ci>z</ci>
          <ci>ρ</ci>
          <interval closure="open">
           <apply>
            <csymbol cd="ambiguous">superscript</csymbol>
            <apply>
             <ci>normal-→</ci>
             <ci>ξ</ci>
            </apply>
            <ci>normal-′</ci>
           </apply>
           <ci>z</ci>
          </interval>
          <apply>
           <divide></divide>
           <apply>
            <ci>normal-→</ci>
            <ci>b</ci>
           </apply>
           <apply>
            <csymbol cd="ambiguous">superscript</csymbol>
            <apply>
             <abs></abs>
             <apply>
              <ci>normal-→</ci>
              <ci>b</ci>
             </apply>
            </apply>
            <cn type="integer">2</cn>
           </apply>
          </apply>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <equivalent></equivalent>
     <apply>
      <ci>normal-→</ci>
      <ci>b</ci>
     </apply>
     <apply>
      <minus></minus>
      <apply>
       <ci>normal-→</ci>
       <ci>ξ</ci>
      </apply>
      <apply>
       <ci>normal-→</ci>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>ξ</ci>
        <ci>normal-′</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \vec{\hat{\alpha}}(\vec{\xi})=\frac{4G}{c^{2}}\int d^{2}\xi^{\prime}\int dz%
\rho(\vec{\xi}^{\prime},z)\frac{\vec{b}}{|\vec{b}|^{2}},~{}\vec{b}\equiv\vec{%
\xi}-\vec{\xi^{\prime}}
  </annotation>
 </semantics>
</math>

</p>

<p>where 

<math display="inline" id="Gravitational_lensing_formalism:4">
 <semantics>
  <mi>z</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>z</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   z
  </annotation>
 </semantics>
</math>

 is the line-of-sight coordinate, and 

<math display="inline" id="Gravitational_lensing_formalism:5">
 <semantics>
  <mover accent="true">
   <mi>b</mi>
   <mo stretchy="false">→</mo>
  </mover>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-→</ci>
    <ci>b</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \vec{b}
  </annotation>
 </semantics>
</math>

 is the vector impact parameter of the actual ray path from the infinitesimal mass 

<math display="inline" id="Gravitational_lensing_formalism:6">
 <semantics>
  <mrow>
   <msup>
    <mi>d</mi>
    <mn>2</mn>
   </msup>
   <msup>
    <mi>ξ</mi>
    <mo>′</mo>
   </msup>
   <mi>d</mi>
   <mi>z</mi>
   <mi>ρ</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msup>
     <mover accent="true">
      <mi>ξ</mi>
      <mo stretchy="false">→</mo>
     </mover>
     <mo>′</mo>
    </msup>
    <mo>,</mo>
    <mi>z</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>d</ci>
     <cn type="integer">2</cn>
    </apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>ξ</ci>
     <ci>normal-′</ci>
    </apply>
    <ci>d</ci>
    <ci>z</ci>
    <ci>ρ</ci>
    <interval closure="open">
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <ci>normal-→</ci>
       <ci>ξ</ci>
      </apply>
      <ci>normal-′</ci>
     </apply>
     <ci>z</ci>
    </interval>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   d^{2}\xi^{\prime}dz\rho(\vec{\xi}^{\prime},z)
  </annotation>
 </semantics>
</math>

 located at the coordinates 

<math display="inline" id="Gravitational_lensing_formalism:7">
 <semantics>
  <mrow>
   <mo stretchy="false">(</mo>
   <msup>
    <mover accent="true">
     <mi>ξ</mi>
     <mo stretchy="false">→</mo>
    </mover>
    <mo>′</mo>
   </msup>
   <mo>,</mo>
   <mi>z</mi>
   <mo stretchy="false">)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <interval closure="open">
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <ci>normal-→</ci>
      <ci>ξ</ci>
     </apply>
     <ci>normal-′</ci>
    </apply>
    <ci>z</ci>
   </interval>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (\vec{\xi}^{\prime},z)
  </annotation>
 </semantics>
</math>

.<a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a></p>
<h2 id="thin-lens-approximation">Thin lens approximation</h2>

<p>In the limit of a "thin lens", where the distances between the source, lens, and observer are much larger than the size of the lens (this is almost always true for astronomical objects), we can define the projected mass density</p>

<p>

<math display="inline" id="Gravitational_lensing_formalism:8">
 <semantics>
  <mrow>
   <mrow>
    <mi mathvariant="normal">Σ</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mover accent="true">
      <mi>ξ</mi>
      <mo stretchy="false">→</mo>
     </mover>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mo largeop="true" symmetric="true">∫</mo>
    <mrow>
     <mi>ρ</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mover accent="true">
       <mi>ξ</mi>
       <mo stretchy="false">→</mo>
      </mover>
      <mo>,</mo>
      <mi>z</mi>
      <mo stretchy="false">)</mo>
     </mrow>
     <mi>d</mi>
     <mi>z</mi>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>normal-Σ</ci>
     <apply>
      <ci>normal-→</ci>
      <ci>ξ</ci>
     </apply>
    </apply>
    <apply>
     <int></int>
     <apply>
      <times></times>
      <ci>ρ</ci>
      <interval closure="open">
       <apply>
        <ci>normal-→</ci>
        <ci>ξ</ci>
       </apply>
       <ci>z</ci>
      </interval>
      <ci>d</ci>
      <ci>z</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Sigma(\vec{\xi})=\int\rho(\vec{\xi},z)dz
  </annotation>
 </semantics>
</math>

</p>

<p>where 

<math display="inline" id="Gravitational_lensing_formalism:9">
 <semantics>
  <mover accent="true">
   <mi>ξ</mi>
   <mo stretchy="false">→</mo>
  </mover>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-→</ci>
    <ci>ξ</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \vec{\xi}
  </annotation>
 </semantics>
</math>

 is a vector in the plane of the sky. The deflection angle is then</p>

<p>

<math display="inline" id="Gravitational_lensing_formalism:10">
 <semantics>
  <mrow>
   <mover accent="true">
    <mover accent="true">
     <mi>α</mi>
     <mo stretchy="false">^</mo>
    </mover>
    <mo stretchy="false">→</mo>
   </mover>
   <mo>=</mo>
   <mrow>
    <mfrac>
     <mrow>
      <mn>4</mn>
      <mi>G</mi>
     </mrow>
     <msup>
      <mi>c</mi>
      <mn>2</mn>
     </msup>
    </mfrac>
    <mrow>
     <mo largeop="true" symmetric="true">∫</mo>
     <mrow>
      <mfrac>
       <mrow>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <mover accent="true">
           <mi>ξ</mi>
           <mo stretchy="false">→</mo>
          </mover>
          <mo>-</mo>
          <msup>
           <mover accent="true">
            <mi>ξ</mi>
            <mo stretchy="false">→</mo>
           </mover>
           <mo>′</mo>
          </msup>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
        <mi mathvariant="normal">Σ</mi>
        <mrow>
         <mo stretchy="false">(</mo>
         <msup>
          <mover accent="true">
           <mi>ξ</mi>
           <mo stretchy="false">→</mo>
          </mover>
          <mo>′</mo>
         </msup>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
       <msup>
        <mrow>
         <mo stretchy="false">|</mo>
         <mrow>
          <mover accent="true">
           <mi>ξ</mi>
           <mo stretchy="false">→</mo>
          </mover>
          <mo>-</mo>
          <msup>
           <mover accent="true">
            <mi>ξ</mi>
            <mo stretchy="false">→</mo>
           </mover>
           <mo>′</mo>
          </msup>
         </mrow>
         <mo stretchy="false">|</mo>
        </mrow>
        <mn>2</mn>
       </msup>
      </mfrac>
      <msup>
       <mi>d</mi>
       <mn>2</mn>
      </msup>
      <msup>
       <mi>ξ</mi>
       <mrow>
        <mi mathvariant="normal">′</mi>
        <mn>2</mn>
       </mrow>
      </msup>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <ci>normal-→</ci>
     <apply>
      <ci>normal-^</ci>
      <ci>α</ci>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <divide></divide>
      <apply>
       <times></times>
       <cn type="integer">4</cn>
       <ci>G</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>c</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
     <apply>
      <int></int>
      <apply>
       <times></times>
       <apply>
        <divide></divide>
        <apply>
         <times></times>
         <apply>
          <minus></minus>
          <apply>
           <ci>normal-→</ci>
           <ci>ξ</ci>
          </apply>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <apply>
            <ci>normal-→</ci>
            <ci>ξ</ci>
           </apply>
           <ci>normal-′</ci>
          </apply>
         </apply>
         <ci>normal-Σ</ci>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <apply>
           <ci>normal-→</ci>
           <ci>ξ</ci>
          </apply>
          <ci>normal-′</ci>
         </apply>
        </apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <abs></abs>
          <apply>
           <minus></minus>
           <apply>
            <ci>normal-→</ci>
            <ci>ξ</ci>
           </apply>
           <apply>
            <csymbol cd="ambiguous">superscript</csymbol>
            <apply>
             <ci>normal-→</ci>
             <ci>ξ</ci>
            </apply>
            <ci>normal-′</ci>
           </apply>
          </apply>
         </apply>
         <cn type="integer">2</cn>
        </apply>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>d</ci>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>ξ</ci>
        <list>
         <ci>normal-′</ci>
         <cn type="integer">2</cn>
        </list>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \vec{\hat{\alpha}}=\frac{4G}{c^{2}}\int\frac{(\vec{\xi}-\vec{\xi}^{\prime})%
\Sigma(\vec{\xi}^{\prime})}{|\vec{\xi}-\vec{\xi}^{\prime}|^{2}}d^{2}\xi^{%
\prime 2}
  </annotation>
 </semantics>
</math>

</p>
<figure><b>(Figure)</b>
<figcaption>Angles involved in a thin gravitational lens system.</figcaption>
</figure>

<p>As shown in the diagram on the right, the difference between the unlensed angular position 

<math display="inline" id="Gravitational_lensing_formalism:11">
 <semantics>
  <mover accent="true">
   <mi>β</mi>
   <mo stretchy="false">→</mo>
  </mover>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-→</ci>
    <ci>β</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \vec{\beta}
  </annotation>
 </semantics>
</math>

 and the observed position 

<math display="inline" id="Gravitational_lensing_formalism:12">
 <semantics>
  <mover accent="true">
   <mi>θ</mi>
   <mo stretchy="false">→</mo>
  </mover>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-→</ci>
    <ci>θ</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \vec{\theta}
  </annotation>
 </semantics>
</math>

 is this deflection angle, reduced by a ratio of distances, described as the lens equation</p>

<p>

<math display="inline" id="Gravitational_lensing_formalism:13">
 <semantics>
  <mrow>
   <mover accent="true">
    <mi>β</mi>
    <mo stretchy="false">→</mo>
   </mover>
   <mo>=</mo>
   <mrow>
    <mover accent="true">
     <mi>θ</mi>
     <mo stretchy="false">→</mo>
    </mover>
    <mo>-</mo>
    <mrow>
     <mover accent="true">
      <mi>α</mi>
      <mo stretchy="false">→</mo>
     </mover>
     <mrow>
      <mo stretchy="false">(</mo>
      <mover accent="true">
       <mi>θ</mi>
       <mo stretchy="false">→</mo>
      </mover>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mover accent="true">
     <mi>θ</mi>
     <mo stretchy="false">→</mo>
    </mover>
    <mo>-</mo>
    <mrow>
     <mfrac>
      <msub>
       <mi>D</mi>
       <mrow>
        <mi>d</mi>
        <mi>s</mi>
       </mrow>
      </msub>
      <msub>
       <mi>D</mi>
       <mi>s</mi>
      </msub>
     </mfrac>
     <mover accent="true">
      <mover accent="true">
       <mi>α</mi>
       <mo stretchy="false">^</mo>
      </mover>
      <mo stretchy="false">→</mo>
     </mover>
     <mrow>
      <mo stretchy="false">(</mo>
      <mover accent="true">
       <mrow>
        <msub>
         <mi>D</mi>
         <mi>d</mi>
        </msub>
        <mi>θ</mi>
       </mrow>
       <mo stretchy="false">→</mo>
      </mover>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <ci>normal-→</ci>
      <ci>β</ci>
     </apply>
     <apply>
      <minus></minus>
      <apply>
       <ci>normal-→</ci>
       <ci>θ</ci>
      </apply>
      <apply>
       <times></times>
       <apply>
        <ci>normal-→</ci>
        <ci>α</ci>
       </apply>
       <apply>
        <ci>normal-→</ci>
        <ci>θ</ci>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <minus></minus>
      <apply>
       <ci>normal-→</ci>
       <ci>θ</ci>
      </apply>
      <apply>
       <times></times>
       <apply>
        <divide></divide>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>D</ci>
         <apply>
          <times></times>
          <ci>d</ci>
          <ci>s</ci>
         </apply>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>D</ci>
         <ci>s</ci>
        </apply>
       </apply>
       <apply>
        <ci>normal-→</ci>
        <apply>
         <ci>normal-^</ci>
         <ci>α</ci>
        </apply>
       </apply>
       <apply>
        <ci>normal-→</ci>
        <apply>
         <times></times>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>D</ci>
          <ci>d</ci>
         </apply>
         <ci>θ</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \vec{\beta}=\vec{\theta}-\vec{\alpha}(\vec{\theta})=\vec{\theta}-\frac{D_{ds}}%
{D_{s}}\vec{\hat{\alpha}}(\vec{D_{d}\theta})
  </annotation>
 </semantics>
</math>

</p>

<p>where 

<math display="inline" id="Gravitational_lensing_formalism:14">
 <semantics>
  <mpadded width="+3.3pt">
   <msub>
    <mi>D</mi>
    <mrow>
     <mi>d</mi>
     <mi>s</mi>
    </mrow>
   </msub>
  </mpadded>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>D</ci>
    <apply>
     <times></times>
     <ci>d</ci>
     <ci>s</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   D_{ds}~{}
  </annotation>
 </semantics>
</math>

 is the distance from the lens to the source 

<math display="inline" id="Gravitational_lensing_formalism:15">
 <semantics>
  <mpadded width="+3.3pt">
   <msub>
    <mi>D</mi>
    <mi>s</mi>
   </msub>
  </mpadded>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>D</ci>
    <ci>s</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   D_{s}~{}
  </annotation>
 </semantics>
</math>

 is the distance from the observer to the source, and 

<math display="inline" id="Gravitational_lensing_formalism:16">
 <semantics>
  <mpadded width="+3.3pt">
   <msub>
    <mi>D</mi>
    <mi>d</mi>
   </msub>
  </mpadded>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>D</ci>
    <ci>d</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   D_{d}~{}
  </annotation>
 </semantics>
</math>

 is the distance from the observer to the lens. For extragalactic lenses, these must be <a href="angular_diameter_distance" title="wikilink">angular diameter distances</a>.</p>

<p>In strong gravitational lensing, this equation can have multiple solutions, because a single source at 

<math display="inline" id="Gravitational_lensing_formalism:17">
 <semantics>
  <mover accent="true">
   <mi>β</mi>
   <mo stretchy="false">→</mo>
  </mover>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-→</ci>
    <ci>β</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \vec{\beta}
  </annotation>
 </semantics>
</math>

 can be lensed into multiple images.</p>
<h3 id="convergence-and-deflection-potential">Convergence and deflection potential</h3>

<p>It is convenient to define the <em>convergence</em></p>

<p>

<math display="inline" id="Gravitational_lensing_formalism:18">
 <semantics>
  <mrow>
   <mrow>
    <mi>κ</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mover accent="true">
      <mi>θ</mi>
      <mo stretchy="false">→</mo>
     </mover>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mfrac>
    <mrow>
     <mi mathvariant="normal">Σ</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <msub>
        <mi>D</mi>
        <mi>d</mi>
       </msub>
       <mover accent="true">
        <mi>θ</mi>
        <mo stretchy="false">→</mo>
       </mover>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <msub>
     <mi mathvariant="normal">Σ</mi>
     <mrow>
      <mi>c</mi>
      <mi>r</mi>
     </mrow>
    </msub>
   </mfrac>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>κ</ci>
     <apply>
      <ci>normal-→</ci>
      <ci>θ</ci>
     </apply>
    </apply>
    <apply>
     <divide></divide>
     <apply>
      <times></times>
      <ci>normal-Σ</ci>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>D</ci>
        <ci>d</ci>
       </apply>
       <apply>
        <ci>normal-→</ci>
        <ci>θ</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>normal-Σ</ci>
      <apply>
       <times></times>
       <ci>c</ci>
       <ci>r</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \kappa(\vec{\theta})=\frac{\Sigma(D_{d}\vec{\theta})}{\Sigma_{cr}}
  </annotation>
 </semantics>
</math>

</p>

<p>and the <em>critical surface density</em> (not to be confused with the <a href="Critical_density_(cosmology)" title="wikilink">critical density</a> of the universe)</p>

<p>

<math display="inline" id="Gravitational_lensing_formalism:19">
 <semantics>
  <mrow>
   <msub>
    <mi mathvariant="normal">Σ</mi>
    <mrow>
     <mi>c</mi>
     <mi>r</mi>
    </mrow>
   </msub>
   <mo>=</mo>
   <mfrac>
    <mrow>
     <msup>
      <mi>c</mi>
      <mn>2</mn>
     </msup>
     <msub>
      <mi>D</mi>
      <mi>s</mi>
     </msub>
    </mrow>
    <mrow>
     <mn>4</mn>
     <mi>π</mi>
     <mi>G</mi>
     <msub>
      <mi>D</mi>
      <mrow>
       <mi>d</mi>
       <mi>s</mi>
      </mrow>
     </msub>
     <msub>
      <mi>D</mi>
      <mi>d</mi>
     </msub>
    </mrow>
   </mfrac>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>normal-Σ</ci>
     <apply>
      <times></times>
      <ci>c</ci>
      <ci>r</ci>
     </apply>
    </apply>
    <apply>
     <divide></divide>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>c</ci>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>D</ci>
       <ci>s</ci>
      </apply>
     </apply>
     <apply>
      <times></times>
      <cn type="integer">4</cn>
      <ci>π</ci>
      <ci>G</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>D</ci>
       <apply>
        <times></times>
        <ci>d</ci>
        <ci>s</ci>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>D</ci>
       <ci>d</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Sigma_{cr}=\frac{c^{2}D_{s}}{4\pi GD_{ds}D_{d}}
  </annotation>
 </semantics>
</math>

</p>

<p>The reduced deflection angle 

<math display="inline" id="Gravitational_lensing_formalism:20">
 <semantics>
  <mrow>
   <mover accent="true">
    <mi>α</mi>
    <mo stretchy="false">→</mo>
   </mover>
   <mrow>
    <mo stretchy="false">(</mo>
    <mover accent="true">
     <mi>θ</mi>
     <mo stretchy="false">→</mo>
    </mover>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <ci>normal-→</ci>
     <ci>α</ci>
    </apply>
    <apply>
     <ci>normal-→</ci>
     <ci>θ</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \vec{\alpha}(\vec{\theta})
  </annotation>
 </semantics>
</math>

 can now be written as</p>

<p>

<math display="inline" id="Gravitational_lensing_formalism:21">
 <semantics>
  <mrow>
   <mrow>
    <mover accent="true">
     <mi>α</mi>
     <mo stretchy="false">→</mo>
    </mover>
    <mrow>
     <mo stretchy="false">(</mo>
     <mover accent="true">
      <mi>θ</mi>
      <mo stretchy="false">→</mo>
     </mover>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mfrac>
     <mn>1</mn>
     <mi>π</mi>
    </mfrac>
    <mrow>
     <mo largeop="true" symmetric="true">∫</mo>
     <mrow>
      <msup>
       <mi>d</mi>
       <mn>2</mn>
      </msup>
      <msup>
       <mi>θ</mi>
       <mo>′</mo>
      </msup>
      <mfrac>
       <mrow>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <mover accent="true">
           <mi>θ</mi>
           <mo stretchy="false">→</mo>
          </mover>
          <mo>-</mo>
          <msup>
           <mover accent="true">
            <mi>θ</mi>
            <mo stretchy="false">→</mo>
           </mover>
           <mo>′</mo>
          </msup>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
        <mi>κ</mi>
        <mrow>
         <mo stretchy="false">(</mo>
         <msup>
          <mover accent="true">
           <mi>θ</mi>
           <mo stretchy="false">→</mo>
          </mover>
          <mo>′</mo>
         </msup>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
       <msup>
        <mrow>
         <mo stretchy="false">|</mo>
         <mrow>
          <mover accent="true">
           <mi>θ</mi>
           <mo stretchy="false">→</mo>
          </mover>
          <mo>-</mo>
          <msup>
           <mover accent="true">
            <mi>θ</mi>
            <mo stretchy="false">→</mo>
           </mover>
           <mo>′</mo>
          </msup>
         </mrow>
         <mo stretchy="false">|</mo>
        </mrow>
        <mn>2</mn>
       </msup>
      </mfrac>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <ci>normal-→</ci>
      <ci>α</ci>
     </apply>
     <apply>
      <ci>normal-→</ci>
      <ci>θ</ci>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <divide></divide>
      <cn type="integer">1</cn>
      <ci>π</ci>
     </apply>
     <apply>
      <int></int>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>d</ci>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>θ</ci>
        <ci>normal-′</ci>
       </apply>
       <apply>
        <divide></divide>
        <apply>
         <times></times>
         <apply>
          <minus></minus>
          <apply>
           <ci>normal-→</ci>
           <ci>θ</ci>
          </apply>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <apply>
            <ci>normal-→</ci>
            <ci>θ</ci>
           </apply>
           <ci>normal-′</ci>
          </apply>
         </apply>
         <ci>κ</ci>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <apply>
           <ci>normal-→</ci>
           <ci>θ</ci>
          </apply>
          <ci>normal-′</ci>
         </apply>
        </apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <abs></abs>
          <apply>
           <minus></minus>
           <apply>
            <ci>normal-→</ci>
            <ci>θ</ci>
           </apply>
           <apply>
            <csymbol cd="ambiguous">superscript</csymbol>
            <apply>
             <ci>normal-→</ci>
             <ci>θ</ci>
            </apply>
            <ci>normal-′</ci>
           </apply>
          </apply>
         </apply>
         <cn type="integer">2</cn>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \vec{\alpha}(\vec{\theta})=\frac{1}{\pi}\int d^{2}\theta^{\prime}\frac{(\vec{%
\theta}-\vec{\theta}^{\prime})\kappa(\vec{\theta}^{\prime})}{|\vec{\theta}-%
\vec{\theta}^{\prime}|^{2}}
  </annotation>
 </semantics>
</math>

</p>

<p>We can also define the <em>deflection potential</em></p>

<p>

<math display="inline" id="Gravitational_lensing_formalism:22">
 <semantics>
  <mrow>
   <mrow>
    <mi>ψ</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mover accent="true">
      <mi>θ</mi>
      <mo stretchy="false">→</mo>
     </mover>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mfrac>
     <mn>1</mn>
     <mi>π</mi>
    </mfrac>
    <mrow>
     <mo largeop="true" symmetric="true">∫</mo>
     <mrow>
      <msup>
       <mi>d</mi>
       <mn>2</mn>
      </msup>
      <msup>
       <mi>θ</mi>
       <mo>′</mo>
      </msup>
      <mi>κ</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <msup>
        <mover accent="true">
         <mi>θ</mi>
         <mo stretchy="false">→</mo>
        </mover>
        <mo>′</mo>
       </msup>
       <mo stretchy="false">)</mo>
      </mrow>
      <mrow>
       <mi>ln</mi>
       <mrow>
        <mo stretchy="false">|</mo>
        <mrow>
         <mover accent="true">
          <mi>θ</mi>
          <mo stretchy="false">→</mo>
         </mover>
         <mo>-</mo>
         <msup>
          <mover accent="true">
           <mi>θ</mi>
           <mo stretchy="false">→</mo>
          </mover>
          <mo>′</mo>
         </msup>
        </mrow>
        <mo stretchy="false">|</mo>
       </mrow>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>ψ</ci>
     <apply>
      <ci>normal-→</ci>
      <ci>θ</ci>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <divide></divide>
      <cn type="integer">1</cn>
      <ci>π</ci>
     </apply>
     <apply>
      <int></int>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>d</ci>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>θ</ci>
        <ci>normal-′</ci>
       </apply>
       <ci>κ</ci>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <ci>normal-→</ci>
         <ci>θ</ci>
        </apply>
        <ci>normal-′</ci>
       </apply>
       <apply>
        <ln></ln>
        <apply>
         <abs></abs>
         <apply>
          <minus></minus>
          <apply>
           <ci>normal-→</ci>
           <ci>θ</ci>
          </apply>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <apply>
            <ci>normal-→</ci>
            <ci>θ</ci>
           </apply>
           <ci>normal-′</ci>
          </apply>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \psi(\vec{\theta})=\frac{1}{\pi}\int d^{2}\theta^{\prime}\kappa(\vec{\theta}^{%
\prime})\ln|\vec{\theta}-\vec{\theta}^{\prime}|
  </annotation>
 </semantics>
</math>

</p>

<p>such that the scaled deflection angle is just the <a class="uri" href="gradient" title="wikilink">gradient</a> of the potential and the convergence is half the <a class="uri" href="Laplacian" title="wikilink">Laplacian</a> of the potential:</p>

<p>

<math display="inline" id="Gravitational_lensing_formalism:23">
 <semantics>
  <mrow>
   <mrow>
    <mover accent="true">
     <mi>α</mi>
     <mo stretchy="false">→</mo>
    </mover>
    <mrow>
     <mo stretchy="false">(</mo>
     <mover accent="true">
      <mi>θ</mi>
      <mo stretchy="false">→</mo>
     </mover>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mover accent="true">
     <mo>∇</mo>
     <mo stretchy="false">→</mo>
    </mover>
    <mi>ψ</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mover accent="true">
      <mi>θ</mi>
      <mo stretchy="false">→</mo>
     </mover>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <ci>normal-→</ci>
      <ci>α</ci>
     </apply>
     <apply>
      <ci>normal-→</ci>
      <ci>θ</ci>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <ci>normal-→</ci>
      <ci>normal-∇</ci>
     </apply>
     <ci>ψ</ci>
     <apply>
      <ci>normal-→</ci>
      <ci>θ</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \vec{\alpha}(\vec{\theta})=\vec{\nabla}\psi(\vec{\theta})
  </annotation>
 </semantics>
</math>

 

<math display="inline" id="Gravitational_lensing_formalism:24">
 <semantics>
  <mrow>
   <mrow>
    <mi>κ</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mover accent="true">
      <mi>θ</mi>
      <mo stretchy="false">→</mo>
     </mover>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mfrac>
     <mn>1</mn>
     <mn>2</mn>
    </mfrac>
    <mrow>
     <msup>
      <mo>∇</mo>
      <mn>2</mn>
     </msup>
     <mi>ψ</mi>
    </mrow>
    <mrow>
     <mo stretchy="false">(</mo>
     <mover accent="true">
      <mi>θ</mi>
      <mo stretchy="false">→</mo>
     </mover>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>κ</ci>
     <apply>
      <ci>normal-→</ci>
      <ci>θ</ci>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <divide></divide>
      <cn type="integer">1</cn>
      <cn type="integer">2</cn>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>normal-∇</ci>
       <cn type="integer">2</cn>
      </apply>
      <ci>ψ</ci>
     </apply>
     <apply>
      <ci>normal-→</ci>
      <ci>θ</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \kappa(\vec{\theta})=\frac{1}{2}\nabla^{2}\psi(\vec{\theta})
  </annotation>
 </semantics>
</math>

</p>

<p>The deflection potential can also be written as a scaled projection of the Newtonian gravitational potential 

<math display="inline" id="Gravitational_lensing_formalism:25">
 <semantics>
  <mpadded width="+3.3pt">
   <mi mathvariant="normal">Φ</mi>
  </mpadded>
  <annotation-xml encoding="MathML-Content">
   <ci>normal-Φ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Phi~{}
  </annotation>
 </semantics>
</math>

 of the lens<a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a> 

<math display="inline" id="Gravitational_lensing_formalism:26">
 <semantics>
  <mrow>
   <mrow>
    <mi>ψ</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mover accent="true">
      <mi>θ</mi>
      <mo stretchy="false">→</mo>
     </mover>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mfrac>
     <mrow>
      <mn>2</mn>
      <msub>
       <mi>D</mi>
       <mrow>
        <mi>d</mi>
        <mi>s</mi>
       </mrow>
      </msub>
     </mrow>
     <mrow>
      <msub>
       <mi>D</mi>
       <mi>d</mi>
      </msub>
      <msub>
       <mi>D</mi>
       <mi>s</mi>
      </msub>
      <msup>
       <mi>c</mi>
       <mn>2</mn>
      </msup>
     </mrow>
    </mfrac>
    <mrow>
     <mo largeop="true" symmetric="true">∫</mo>
     <mrow>
      <mi mathvariant="normal">Φ</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <msub>
         <mi>D</mi>
         <mi>d</mi>
        </msub>
        <mover accent="true">
         <mi>θ</mi>
         <mo stretchy="false">→</mo>
        </mover>
       </mrow>
       <mo>,</mo>
       <mi>z</mi>
       <mo stretchy="false">)</mo>
      </mrow>
      <mi>d</mi>
      <mi>z</mi>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>ψ</ci>
     <apply>
      <ci>normal-→</ci>
      <ci>θ</ci>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <divide></divide>
      <apply>
       <times></times>
       <cn type="integer">2</cn>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>D</ci>
        <apply>
         <times></times>
         <ci>d</ci>
         <ci>s</ci>
        </apply>
       </apply>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>D</ci>
        <ci>d</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>D</ci>
        <ci>s</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>c</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
     </apply>
     <apply>
      <int></int>
      <apply>
       <times></times>
       <ci>normal-Φ</ci>
       <interval closure="open">
        <apply>
         <times></times>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>D</ci>
          <ci>d</ci>
         </apply>
         <apply>
          <ci>normal-→</ci>
          <ci>θ</ci>
         </apply>
        </apply>
        <ci>z</ci>
       </interval>
       <ci>d</ci>
       <ci>z</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \psi(\vec{\theta})=\frac{2D_{ds}}{D_{d}D_{s}c^{2}}\int\Phi(D_{d}\vec{\theta},z%
)dz
  </annotation>
 </semantics>
</math>

</p>
<h3 id="lensing-jacobian">Lensing Jacobian</h3>

<p>The <a href="Jacobian_matrix_and_determinant" title="wikilink">Jacobian</a> between the unlensed and lensed coordinate systems is</p>

<p>

<math display="inline" id="Gravitational_lensing_formalism:27">
 <semantics>
  <mrow>
   <msub>
    <mi>A</mi>
    <mrow>
     <mi>i</mi>
     <mi>j</mi>
    </mrow>
   </msub>
   <mo>=</mo>
   <mfrac>
    <mrow>
     <mo>∂</mo>
     <msub>
      <mi>β</mi>
      <mi>i</mi>
     </msub>
    </mrow>
    <mrow>
     <mo>∂</mo>
     <msub>
      <mi>θ</mi>
      <mi>j</mi>
     </msub>
    </mrow>
   </mfrac>
   <mo>=</mo>
   <mrow>
    <msub>
     <mi>δ</mi>
     <mrow>
      <mi>i</mi>
      <mi>j</mi>
     </mrow>
    </msub>
    <mo>-</mo>
    <mfrac>
     <mrow>
      <mo>∂</mo>
      <msub>
       <mi>α</mi>
       <mi>i</mi>
      </msub>
     </mrow>
     <mrow>
      <mo>∂</mo>
      <msub>
       <mi>θ</mi>
       <mi>j</mi>
      </msub>
     </mrow>
    </mfrac>
   </mrow>
   <mo>=</mo>
   <mrow>
    <msub>
     <mi>δ</mi>
     <mrow>
      <mi>i</mi>
      <mi>j</mi>
     </mrow>
    </msub>
    <mo>-</mo>
    <mfrac>
     <mrow>
      <msup>
       <mo>∂</mo>
       <mn>2</mn>
      </msup>
      <mi>ψ</mi>
     </mrow>
     <mrow>
      <mrow>
       <mo>∂</mo>
       <msub>
        <mi>θ</mi>
        <mi>i</mi>
       </msub>
      </mrow>
      <mrow>
       <mo>∂</mo>
       <msub>
        <mi>θ</mi>
        <mi>j</mi>
       </msub>
      </mrow>
     </mrow>
    </mfrac>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>A</ci>
      <apply>
       <times></times>
       <ci>i</ci>
       <ci>j</ci>
      </apply>
     </apply>
     <apply>
      <divide></divide>
      <apply>
       <partialdiff></partialdiff>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>β</ci>
        <ci>i</ci>
       </apply>
      </apply>
      <apply>
       <partialdiff></partialdiff>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>θ</ci>
        <ci>j</ci>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <minus></minus>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>δ</ci>
       <apply>
        <times></times>
        <ci>i</ci>
        <ci>j</ci>
       </apply>
      </apply>
      <apply>
       <divide></divide>
       <apply>
        <partialdiff></partialdiff>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>α</ci>
         <ci>i</ci>
        </apply>
       </apply>
       <apply>
        <partialdiff></partialdiff>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>θ</ci>
         <ci>j</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <minus></minus>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>δ</ci>
       <apply>
        <times></times>
        <ci>i</ci>
        <ci>j</ci>
       </apply>
      </apply>
      <apply>
       <divide></divide>
       <apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <partialdiff></partialdiff>
         <cn type="integer">2</cn>
        </apply>
        <ci>ψ</ci>
       </apply>
       <apply>
        <times></times>
        <apply>
         <partialdiff></partialdiff>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>θ</ci>
          <ci>i</ci>
         </apply>
        </apply>
        <apply>
         <partialdiff></partialdiff>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>θ</ci>
          <ci>j</ci>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A_{ij}=\frac{\partial\beta_{i}}{\partial\theta_{j}}=\delta_{ij}-\frac{\partial%
\alpha_{i}}{\partial\theta_{j}}=\delta_{ij}-\frac{\partial^{2}\psi}{\partial%
\theta_{i}\partial\theta_{j}}
  </annotation>
 </semantics>
</math>

</p>

<p>where 

<math display="inline" id="Gravitational_lensing_formalism:28">
 <semantics>
  <mpadded width="+3.3pt">
   <msub>
    <mi>δ</mi>
    <mrow>
     <mi>i</mi>
     <mi>j</mi>
    </mrow>
   </msub>
  </mpadded>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>δ</ci>
    <apply>
     <times></times>
     <ci>i</ci>
     <ci>j</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \delta_{ij}~{}
  </annotation>
 </semantics>
</math>

 is the <a href="Kronecker_delta" title="wikilink">Kronecker delta</a>. Because the matrix of second derivatives must be symmetric, the Jacobian can be decomposed into a diagonal term involving the convergence and a <a href="matrix_trace" title="wikilink">trace</a>-free term involving the <em>shear</em> 

<math display="inline" id="Gravitational_lensing_formalism:29">
 <semantics>
  <mpadded width="+3.3pt">
   <mi>γ</mi>
  </mpadded>
  <annotation-xml encoding="MathML-Content">
   <ci>γ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \gamma~{}
  </annotation>
 </semantics>
</math>

 

<math display="inline" id="Gravitational_lensing_formalism:30">
 <semantics>
  <mrow>
   <mi>A</mi>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mn>1</mn>
       <mo>-</mo>
       <mi>κ</mi>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <mrow>
      <mo>[</mo>
      <mtable>
       <mtr>
        <mtd columnalign="center">
         <mn>1</mn>
        </mtd>
        <mtd columnalign="center">
         <mn>0</mn>
        </mtd>
       </mtr>
       <mtr>
        <mtd columnalign="center">
         <mn>0</mn>
        </mtd>
        <mtd columnalign="center">
         <mn>1</mn>
        </mtd>
       </mtr>
      </mtable>
      <mo>]</mo>
     </mrow>
    </mrow>
    <mo>-</mo>
    <mrow>
     <mi>γ</mi>
     <mrow>
      <mo>[</mo>
      <mtable>
       <mtr>
        <mtd columnalign="center">
         <mrow>
          <mi>cos</mi>
          <mrow>
           <mn>2</mn>
           <mi>ϕ</mi>
          </mrow>
         </mrow>
        </mtd>
        <mtd columnalign="center">
         <mrow>
          <mi>sin</mi>
          <mrow>
           <mn>2</mn>
           <mi>ϕ</mi>
          </mrow>
         </mrow>
        </mtd>
       </mtr>
       <mtr>
        <mtd columnalign="center">
         <mrow>
          <mi>sin</mi>
          <mrow>
           <mn>2</mn>
           <mi>ϕ</mi>
          </mrow>
         </mrow>
        </mtd>
        <mtd columnalign="center">
         <mrow>
          <mo>-</mo>
          <mrow>
           <mi>cos</mi>
           <mrow>
            <mn>2</mn>
            <mi>ϕ</mi>
           </mrow>
          </mrow>
         </mrow>
        </mtd>
       </mtr>
      </mtable>
      <mo>]</mo>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>A</ci>
    <apply>
     <minus></minus>
     <apply>
      <times></times>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
       <ci>κ</ci>
      </apply>
      <apply>
       <csymbol cd="latexml">delimited-[]</csymbol>
       <matrix>
        <matrixrow>
         <cn type="integer">1</cn>
         <cn type="integer">0</cn>
        </matrixrow>
        <matrixrow>
         <cn type="integer">0</cn>
         <cn type="integer">1</cn>
        </matrixrow>
       </matrix>
      </apply>
     </apply>
     <apply>
      <times></times>
      <ci>γ</ci>
      <apply>
       <csymbol cd="latexml">delimited-[]</csymbol>
       <matrix>
        <matrixrow>
         <apply>
          <cos></cos>
          <apply>
           <times></times>
           <cn type="integer">2</cn>
           <ci>ϕ</ci>
          </apply>
         </apply>
         <apply>
          <sin></sin>
          <apply>
           <times></times>
           <cn type="integer">2</cn>
           <ci>ϕ</ci>
          </apply>
         </apply>
        </matrixrow>
        <matrixrow>
         <apply>
          <sin></sin>
          <apply>
           <times></times>
           <cn type="integer">2</cn>
           <ci>ϕ</ci>
          </apply>
         </apply>
         <apply>
          <minus></minus>
          <apply>
           <cos></cos>
           <apply>
            <times></times>
            <cn type="integer">2</cn>
            <ci>ϕ</ci>
           </apply>
          </apply>
         </apply>
        </matrixrow>
       </matrix>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A=(1-\kappa)\left[\begin{array}[]{ c c }1&0\\
0&1\end{array}\right]-\gamma\left[\begin{array}[]{ c c }\cos 2\phi&\sin 2\phi%
\\
\sin 2\phi&-\cos 2\phi\end{array}\right]
  </annotation>
 </semantics>
</math>

</p>

<p>where 

<math display="inline" id="Gravitational_lensing_formalism:31">
 <semantics>
  <mpadded width="+3.3pt">
   <mi>ϕ</mi>
  </mpadded>
  <annotation-xml encoding="MathML-Content">
   <ci>ϕ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \phi~{}
  </annotation>
 </semantics>
</math>

 is the angle between 

<math display="inline" id="Gravitational_lensing_formalism:32">
 <semantics>
  <mover accent="true">
   <mi>α</mi>
   <mo stretchy="false">→</mo>
  </mover>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-→</ci>
    <ci>α</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \vec{\alpha}
  </annotation>
 </semantics>
</math>

 and the x-axis. The term involving the convergence magnifies the image by increasing its size while conserving surface brightness. The term involving the shear stretches the image tangentially around the lens, as discussed in <a href="#Weak_lensing_observables" title="wikilink">weak lensing observables</a>.</p>

<p>The shear defined here is <em>not</em> equivalent to the <a href="shear_mapping" title="wikilink">shear</a> traditionally defined in mathematics, though both stretch an image non-uniformly.</p>
<figure><b>(Figure)</b>
<figcaption>Effect of the components of convergence and shear on a circular source represented by the solid green circle. The complex shear notation is defined <a href="#Shear_and_reduced_shear" title="wikilink">below</a>.</figcaption>
</figure>
<h3 id="fermat-surface">Fermat surface</h3>

<p>There is an alternative way of deriving the lens equation, starting from the photon arrival time (Fermat surface)</p>

<p>

<math display="inline" id="Gravitational_lensing_formalism:33">
 <semantics>
  <mrow>
   <mi>t</mi>
   <mo>=</mo>
   <mrow>
    <msubsup>
     <mo largeop="true" symmetric="true">∫</mo>
     <mn>0</mn>
     <msub>
      <mi>z</mi>
      <mi>s</mi>
     </msub>
    </msubsup>
    <mfrac>
     <mrow>
      <mi>n</mi>
      <mi>d</mi>
      <mi>z</mi>
     </mrow>
     <mrow>
      <mi>c</mi>
      <mrow>
       <mi>cos</mi>
       <mi>α</mi>
      </mrow>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>z</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mfrac>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>t</ci>
    <apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <int></int>
       <cn type="integer">0</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>z</ci>
       <ci>s</ci>
      </apply>
     </apply>
     <apply>
      <divide></divide>
      <apply>
       <times></times>
       <ci>n</ci>
       <ci>d</ci>
       <ci>z</ci>
      </apply>
      <apply>
       <times></times>
       <ci>c</ci>
       <apply>
        <cos></cos>
        <ci>α</ci>
       </apply>
       <ci>z</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   t=\int_{0}^{z_{s}}{ndz\over c\cos\alpha(z)}
  </annotation>
 </semantics>
</math>

</p>

<p>where 

<math display="inline" id="Gravitational_lensing_formalism:34">
 <semantics>
  <mrow>
   <mrow>
    <mi>d</mi>
    <mi>z</mi>
   </mrow>
   <mo>/</mo>
   <mi>c</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <divide></divide>
    <apply>
     <times></times>
     <ci>d</ci>
     <ci>z</ci>
    </apply>
    <ci>c</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   dz/c
  </annotation>
 </semantics>
</math>

 is the time to travel an infinitesimal line element along the source-observer straight line in vacuum, which is then corrected by the factor</p>

<p>

<math display="inline" id="Gravitational_lensing_formalism:35">
 <semantics>
  <mrow>
   <mrow>
    <mn>1</mn>
    <mo>/</mo>
    <mrow>
     <mi>cos</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mi>α</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>z</mi>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>≈</mo>
   <mrow>
    <mn>1</mn>
    <mo>+</mo>
    <mfrac>
     <mrow>
      <mi>α</mi>
      <msup>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>z</mi>
        <mo stretchy="false">)</mo>
       </mrow>
       <mn>2</mn>
      </msup>
     </mrow>
     <mn>2</mn>
    </mfrac>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <approx></approx>
    <apply>
     <divide></divide>
     <cn type="integer">1</cn>
     <apply>
      <cos></cos>
      <apply>
       <times></times>
       <ci>α</ci>
       <ci>z</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <plus></plus>
     <cn type="integer">1</cn>
     <apply>
      <divide></divide>
      <apply>
       <times></times>
       <ci>α</ci>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>z</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
      <cn type="integer">2</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   1/\cos(\alpha(z))\approx 1+{\alpha(z)^{2}\over 2}
  </annotation>
 </semantics>
</math>

</p>

<p>to get the line element along the bended path 

<math display="inline" id="Gravitational_lensing_formalism:36">
 <semantics>
  <mrow>
   <mrow>
    <mi>d</mi>
    <mi>l</mi>
   </mrow>
   <mo>=</mo>
   <mfrac>
    <mrow>
     <mi>d</mi>
     <mi>z</mi>
    </mrow>
    <mrow>
     <mi>c</mi>
     <mrow>
      <mi>cos</mi>
      <mi>α</mi>
     </mrow>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>z</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mfrac>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>d</ci>
     <ci>l</ci>
    </apply>
    <apply>
     <divide></divide>
     <apply>
      <times></times>
      <ci>d</ci>
      <ci>z</ci>
     </apply>
     <apply>
      <times></times>
      <ci>c</ci>
      <apply>
       <cos></cos>
       <ci>α</ci>
      </apply>
      <ci>z</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   dl={dz\over c\cos\alpha(z)}
  </annotation>
 </semantics>
</math>

 with a varying small pitch angle 

<math display="inline" id="Gravitational_lensing_formalism:37">
 <semantics>
  <mrow>
   <mrow>
    <mi>α</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>z</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>α</ci>
    <ci>z</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \alpha(z),
  </annotation>
 </semantics>
</math>

 and the refraction index 

<math display="inline" id="Gravitational_lensing_formalism:38">
 <semantics>
  <mi>n</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>n</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n
  </annotation>
 </semantics>
</math>

 for the "aether", i.e., the gravitational field. The last can be obtained from the fact that a photon travels on a null geodesic of a weakly perturbed static Minkowski universe</p>

<p>

<math display="inline" id="Gravitational_lensing_formalism:39">
 <semantics>
  <mrow>
   <mrow>
    <mi>d</mi>
    <msup>
     <mi>s</mi>
     <mn>2</mn>
    </msup>
   </mrow>
   <mo>=</mo>
   <mn>0</mn>
   <mo>=</mo>
   <mrow>
    <mrow>
     <msup>
      <mi>c</mi>
      <mn>2</mn>
     </msup>
     <mi>d</mi>
     <msup>
      <mi>t</mi>
      <mn>2</mn>
     </msup>
     <mrow>
      <mo>(</mo>
      <mrow>
       <mn>1</mn>
       <mo>+</mo>
       <mfrac>
        <mrow>
         <mn>2</mn>
         <mi mathvariant="normal">Φ</mi>
        </mrow>
        <msup>
         <mi>c</mi>
         <mn>2</mn>
        </msup>
       </mfrac>
      </mrow>
      <mo>)</mo>
     </mrow>
    </mrow>
    <mo>-</mo>
    <mrow>
     <msup>
      <mrow>
       <mo>(</mo>
       <mrow>
        <mn>1</mn>
        <mo>+</mo>
        <mfrac>
         <mrow>
          <mn>2</mn>
          <mi mathvariant="normal">Φ</mi>
         </mrow>
         <msup>
          <mi>c</mi>
          <mn>2</mn>
         </msup>
        </mfrac>
       </mrow>
       <mo>)</mo>
      </mrow>
      <mrow>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
     </msup>
     <mi>d</mi>
     <msup>
      <mi>l</mi>
      <mn>2</mn>
     </msup>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <times></times>
      <ci>d</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>s</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
     <cn type="integer">0</cn>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <minus></minus>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>c</ci>
        <cn type="integer">2</cn>
       </apply>
       <ci>d</ci>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>t</ci>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <plus></plus>
        <cn type="integer">1</cn>
        <apply>
         <divide></divide>
         <apply>
          <times></times>
          <cn type="integer">2</cn>
          <ci>normal-Φ</ci>
         </apply>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>c</ci>
          <cn type="integer">2</cn>
         </apply>
        </apply>
       </apply>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <plus></plus>
         <cn type="integer">1</cn>
         <apply>
          <divide></divide>
          <apply>
           <times></times>
           <cn type="integer">2</cn>
           <ci>normal-Φ</ci>
          </apply>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <ci>c</ci>
           <cn type="integer">2</cn>
          </apply>
         </apply>
        </apply>
        <apply>
         <minus></minus>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <ci>d</ci>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>l</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   ds^{2}=0=c^{2}dt^{2}\left(1+{2\Phi\over c^{2}}\right)-\left(1+{2\Phi\over c^{2%
}}\right)^{-1}dl^{2}
  </annotation>
 </semantics>
</math>

</p>

<p>where the uneven gravitational potential 

<math display="inline" id="Gravitational_lensing_formalism:40">
 <semantics>
  <mrow>
   <mi mathvariant="normal">Φ</mi>
   <mo>≪</mo>
   <msup>
    <mi>c</mi>
    <mn>2</mn>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">much-less-than</csymbol>
    <ci>normal-Φ</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>c</ci>
     <cn type="integer">2</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Phi\ll c^{2}
  </annotation>
 </semantics>
</math>

 drives a changing the speed of light</p>

<p>

<math display="inline" id="Gravitational_lensing_formalism:41">
 <semantics>
  <mrow>
   <mrow>
    <msup>
     <mi>c</mi>
     <mo>′</mo>
    </msup>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mrow>
       <mi>d</mi>
       <mi>l</mi>
      </mrow>
      <mo>/</mo>
      <mi>d</mi>
     </mrow>
     <mi>t</mi>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mo>(</mo>
      <mrow>
       <mn>1</mn>
       <mo>+</mo>
       <mfrac>
        <mrow>
         <mn>2</mn>
         <mi mathvariant="normal">Φ</mi>
        </mrow>
        <msup>
         <mi>c</mi>
         <mn>2</mn>
        </msup>
       </mfrac>
      </mrow>
      <mo>)</mo>
     </mrow>
     <mi>c</mi>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>c</ci>
      <ci>normal-′</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <apply>
        <times></times>
        <ci>d</ci>
        <ci>l</ci>
       </apply>
       <ci>d</ci>
      </apply>
      <ci>t</ci>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <apply>
       <plus></plus>
       <cn type="integer">1</cn>
       <apply>
        <divide></divide>
        <apply>
         <times></times>
         <cn type="integer">2</cn>
         <ci>normal-Φ</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>c</ci>
         <cn type="integer">2</cn>
        </apply>
       </apply>
      </apply>
      <ci>c</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   c^{\prime}={dl/dt}=\left(1+{2\Phi\over c^{2}}\right)c.
  </annotation>
 </semantics>
</math>

</p>

<p>So the refraction index</p>

<p>

<math display="inline" id="Gravitational_lensing_formalism:42">
 <semantics>
  <mrow>
   <mrow>
    <mi>n</mi>
    <mo>≡</mo>
    <mfrac>
     <mi>c</mi>
     <msup>
      <mi>c</mi>
      <mo>′</mo>
     </msup>
    </mfrac>
    <mo>≈</mo>
    <mrow>
     <mo>(</mo>
     <mrow>
      <mn>1</mn>
      <mo>-</mo>
      <mfrac>
       <mrow>
        <mn>2</mn>
        <mi mathvariant="normal">Φ</mi>
       </mrow>
       <msup>
        <mi>c</mi>
        <mn>2</mn>
       </msup>
      </mfrac>
     </mrow>
     <mo>)</mo>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <equivalent></equivalent>
     <ci>n</ci>
     <apply>
      <divide></divide>
      <ci>c</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>c</ci>
       <ci>normal-′</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <approx></approx>
     <share href="#.cmml">
     </share>
     <apply>
      <minus></minus>
      <cn type="integer">1</cn>
      <apply>
       <divide></divide>
       <apply>
        <times></times>
        <cn type="integer">2</cn>
        <ci>normal-Φ</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>c</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n\equiv{c\over c^{\prime}}\approx\left(1-{2\Phi\over c^{2}}\right).
  </annotation>
 </semantics>
</math>

</p>

<p>The refraction index greater than unity because of the negative gravitational potential 

<math display="inline" id="Gravitational_lensing_formalism:43">
 <semantics>
  <mi mathvariant="normal">Φ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>normal-Φ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Phi
  </annotation>
 </semantics>
</math>

.</p>

<p>Put these together and keep the leading terms we have the time arrival surface</p>

<p>

<math display="inline" id="Gravitational_lensing_formalism:44">
 <semantics>
  <mrow>
   <mrow>
    <mi>t</mi>
    <mo>≈</mo>
    <mrow>
     <mrow>
      <mrow>
       <msubsup>
        <mo largeop="true" symmetric="true">∫</mo>
        <mn>0</mn>
        <msub>
         <mi>z</mi>
         <mi>s</mi>
        </msub>
       </msubsup>
       <mfrac>
        <mrow>
         <mi>d</mi>
         <mi>z</mi>
        </mrow>
        <mi>c</mi>
       </mfrac>
      </mrow>
      <mo>+</mo>
      <mrow>
       <msubsup>
        <mo largeop="true" symmetric="true">∫</mo>
        <mn>0</mn>
        <msub>
         <mi>z</mi>
         <mi>s</mi>
        </msub>
       </msubsup>
       <mrow>
        <mfrac>
         <mrow>
          <mi>d</mi>
          <mi>z</mi>
         </mrow>
         <mi>c</mi>
        </mfrac>
        <mfrac>
         <mrow>
          <mi>α</mi>
          <msup>
           <mrow>
            <mo stretchy="false">(</mo>
            <mi>z</mi>
            <mo stretchy="false">)</mo>
           </mrow>
           <mn>2</mn>
          </msup>
         </mrow>
         <mn>2</mn>
        </mfrac>
       </mrow>
      </mrow>
     </mrow>
     <mo>-</mo>
     <mrow>
      <msubsup>
       <mo largeop="true" symmetric="true">∫</mo>
       <mn>0</mn>
       <msub>
        <mi>z</mi>
        <mi>s</mi>
       </msub>
      </msubsup>
      <mrow>
       <mfrac>
        <mrow>
         <mi>d</mi>
         <mi>z</mi>
        </mrow>
        <mi>c</mi>
       </mfrac>
       <mfrac>
        <mrow>
         <mn>2</mn>
         <mi mathvariant="normal">Φ</mi>
        </mrow>
        <msup>
         <mi>c</mi>
         <mn>2</mn>
        </msup>
       </mfrac>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <approx></approx>
    <ci>t</ci>
    <apply>
     <minus></minus>
     <apply>
      <plus></plus>
      <apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <int></int>
         <cn type="integer">0</cn>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>z</ci>
         <ci>s</ci>
        </apply>
       </apply>
       <apply>
        <divide></divide>
        <apply>
         <times></times>
         <ci>d</ci>
         <ci>z</ci>
        </apply>
        <ci>c</ci>
       </apply>
      </apply>
      <apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <int></int>
         <cn type="integer">0</cn>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>z</ci>
         <ci>s</ci>
        </apply>
       </apply>
       <apply>
        <times></times>
        <apply>
         <divide></divide>
         <apply>
          <times></times>
          <ci>d</ci>
          <ci>z</ci>
         </apply>
         <ci>c</ci>
        </apply>
        <apply>
         <divide></divide>
         <apply>
          <times></times>
          <ci>α</ci>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <ci>z</ci>
           <cn type="integer">2</cn>
          </apply>
         </apply>
         <cn type="integer">2</cn>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <int></int>
        <cn type="integer">0</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>z</ci>
        <ci>s</ci>
       </apply>
      </apply>
      <apply>
       <times></times>
       <apply>
        <divide></divide>
        <apply>
         <times></times>
         <ci>d</ci>
         <ci>z</ci>
        </apply>
        <ci>c</ci>
       </apply>
       <apply>
        <divide></divide>
        <apply>
         <times></times>
         <cn type="integer">2</cn>
         <ci>normal-Φ</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>c</ci>
         <cn type="integer">2</cn>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   t\approx\int_{0}^{z_{s}}{dz\over c}+\int_{0}^{z_{s}}{dz\over c}{\alpha(z)^{2}%
\over 2}-\int_{0}^{z_{s}}{dz\over c}{2\Phi\over c^{2}}.
  </annotation>
 </semantics>
</math>

</p>

<p>The first term is the straight path travel time, the second term is the extra geometric path, and the third is the gravitational delay. Make the triangle approximation that 

<math display="inline" id="Gravitational_lensing_formalism:45">
 <semantics>
  <mrow>
   <mrow>
    <mi>α</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>z</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mi>θ</mi>
    <mo>-</mo>
    <mi>β</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>α</ci>
     <ci>z</ci>
    </apply>
    <apply>
     <minus></minus>
     <ci>θ</ci>
     <ci>β</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \alpha(z)=\theta-\beta
  </annotation>
 </semantics>
</math>

 for the path between the observer and the lens, and 

<math display="inline" id="Gravitational_lensing_formalism:46">
 <semantics>
  <mrow>
   <mrow>
    <mi>α</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>z</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>≈</mo>
   <mrow>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>θ</mi>
      <mo>-</mo>
      <mi>β</mi>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
    <mfrac>
     <msub>
      <mi>D</mi>
      <mi>d</mi>
     </msub>
     <msub>
      <mi>D</mi>
      <mrow>
       <mi>d</mi>
       <mi>s</mi>
      </mrow>
     </msub>
    </mfrac>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <approx></approx>
    <apply>
     <times></times>
     <ci>α</ci>
     <ci>z</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <minus></minus>
      <ci>θ</ci>
      <ci>β</ci>
     </apply>
     <apply>
      <divide></divide>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>D</ci>
       <ci>d</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>D</ci>
       <apply>
        <times></times>
        <ci>d</ci>
        <ci>s</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \alpha(z)\approx(\theta-\beta){D_{d}\over D_{ds}}
  </annotation>
 </semantics>
</math>

 for the path between the lens and the source. The geometric delay term becomes</p>

<p>

<math display="inline" id="Gravitational_lensing_formalism:47">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mrow>
      <mfrac>
       <msub>
        <mi>D</mi>
        <mi>d</mi>
       </msub>
       <mi>c</mi>
      </mfrac>
      <mfrac>
       <msup>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <mover accent="true">
           <mi>θ</mi>
           <mo stretchy="false">→</mo>
          </mover>
          <mo>-</mo>
          <mover accent="true">
           <mi>β</mi>
           <mo stretchy="false">→</mo>
          </mover>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
        <mn>2</mn>
       </msup>
       <mn>2</mn>
      </mfrac>
     </mrow>
     <mo>+</mo>
     <mrow>
      <mfrac>
       <msub>
        <mi>D</mi>
        <mrow>
         <mi>d</mi>
         <mi>s</mi>
        </mrow>
       </msub>
       <mi>c</mi>
      </mfrac>
      <mfrac>
       <msup>
        <mrow>
         <mo>[</mo>
         <mrow>
          <mrow>
           <mo stretchy="false">(</mo>
           <mrow>
            <mover accent="true">
             <mi>θ</mi>
             <mo stretchy="false">→</mo>
            </mover>
            <mo>-</mo>
            <mover accent="true">
             <mi>β</mi>
             <mo stretchy="false">→</mo>
            </mover>
           </mrow>
           <mo stretchy="false">)</mo>
          </mrow>
          <mfrac>
           <msub>
            <mi>D</mi>
            <mi>d</mi>
           </msub>
           <msub>
            <mi>D</mi>
            <mrow>
             <mi>d</mi>
             <mi>s</mi>
            </mrow>
           </msub>
          </mfrac>
         </mrow>
         <mo>]</mo>
        </mrow>
        <mn>2</mn>
       </msup>
       <mn>2</mn>
      </mfrac>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mfrac>
      <mrow>
       <msub>
        <mi>D</mi>
        <mi>d</mi>
       </msub>
       <msub>
        <mi>D</mi>
        <mi>s</mi>
       </msub>
      </mrow>
      <msub>
       <mi>D</mi>
       <mrow>
        <mi>d</mi>
        <mi>s</mi>
       </mrow>
      </msub>
     </mfrac>
     <mfrac>
      <msup>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mover accent="true">
          <mi>θ</mi>
          <mo stretchy="false">→</mo>
         </mover>
         <mo>-</mo>
         <mover accent="true">
          <mi>β</mi>
          <mo stretchy="false">→</mo>
         </mover>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
       <mn>2</mn>
      </msup>
      <mn>2</mn>
     </mfrac>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>D</ci>
        <ci>d</ci>
       </apply>
       <ci>c</ci>
      </apply>
      <apply>
       <divide></divide>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <minus></minus>
         <apply>
          <ci>normal-→</ci>
          <ci>θ</ci>
         </apply>
         <apply>
          <ci>normal-→</ci>
          <ci>β</ci>
         </apply>
        </apply>
        <cn type="integer">2</cn>
       </apply>
       <cn type="integer">2</cn>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>D</ci>
        <apply>
         <times></times>
         <ci>d</ci>
         <ci>s</ci>
        </apply>
       </apply>
       <ci>c</ci>
      </apply>
      <apply>
       <divide></divide>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="latexml">delimited-[]</csymbol>
         <apply>
          <times></times>
          <apply>
           <minus></minus>
           <apply>
            <ci>normal-→</ci>
            <ci>θ</ci>
           </apply>
           <apply>
            <ci>normal-→</ci>
            <ci>β</ci>
           </apply>
          </apply>
          <apply>
           <divide></divide>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <ci>D</ci>
            <ci>d</ci>
           </apply>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <ci>D</ci>
            <apply>
             <times></times>
             <ci>d</ci>
             <ci>s</ci>
            </apply>
           </apply>
          </apply>
         </apply>
        </apply>
        <cn type="integer">2</cn>
       </apply>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <divide></divide>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>D</ci>
        <ci>d</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>D</ci>
        <ci>s</ci>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>D</ci>
       <apply>
        <times></times>
        <ci>d</ci>
        <ci>s</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <divide></divide>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <minus></minus>
        <apply>
         <ci>normal-→</ci>
         <ci>θ</ci>
        </apply>
        <apply>
         <ci>normal-→</ci>
         <ci>β</ci>
        </apply>
       </apply>
       <cn type="integer">2</cn>
      </apply>
      <cn type="integer">2</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   {D_{d}\over c}{(\vec{\theta}-\vec{\beta})^{2}\over 2}+{D_{ds}\over c}{\left[(%
\vec{\theta}-\vec{\beta}){D_{d}\over D_{ds}}\right]^{2}\over 2}={D_{d}D_{s}%
\over D_{ds}}{(\vec{\theta}-\vec{\beta})^{2}\over 2}.
  </annotation>
 </semantics>
</math>

 (How? There is no D_s on the left. Angular diameter distances don't add in a simple way, in general.) So the Fermat surface becomes</p>

<p>

<math display="inline" id="Gravitational_lensing_formalism:48">
 <semantics>
  <mrow>
   <mrow>
    <mi>t</mi>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mi>c</mi>
      <mi>o</mi>
      <mi>n</mi>
      <mi>s</mi>
      <mi>t</mi>
      <mi>a</mi>
      <mi>n</mi>
      <mi>t</mi>
     </mrow>
     <mo>+</mo>
     <mrow>
      <mfrac>
       <mrow>
        <msub>
         <mi>D</mi>
         <mi>d</mi>
        </msub>
        <msub>
         <mi>D</mi>
         <mi>s</mi>
        </msub>
       </mrow>
       <mrow>
        <msub>
         <mi>D</mi>
         <mrow>
          <mi>d</mi>
          <mi>s</mi>
         </mrow>
        </msub>
        <mi>c</mi>
       </mrow>
      </mfrac>
      <mi>τ</mi>
     </mrow>
    </mrow>
   </mrow>
   <mo rspace="5.8pt">,</mo>
   <mrow>
    <mi>τ</mi>
    <mo>≡</mo>
    <mrow>
     <mo>[</mo>
     <mrow>
      <mfrac>
       <msup>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <mover accent="true">
           <mi>θ</mi>
           <mo stretchy="false">→</mo>
          </mover>
          <mo>-</mo>
          <mover accent="true">
           <mi>β</mi>
           <mo stretchy="false">→</mo>
          </mover>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
        <mn>2</mn>
       </msup>
       <mn>2</mn>
      </mfrac>
      <mo>-</mo>
      <mi>ψ</mi>
     </mrow>
     <mo>]</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <eq></eq>
     <ci>t</ci>
     <apply>
      <plus></plus>
      <apply>
       <times></times>
       <ci>c</ci>
       <ci>o</ci>
       <ci>n</ci>
       <ci>s</ci>
       <ci>t</ci>
       <ci>a</ci>
       <ci>n</ci>
       <ci>t</ci>
      </apply>
      <apply>
       <times></times>
       <apply>
        <divide></divide>
        <apply>
         <times></times>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>D</ci>
          <ci>d</ci>
         </apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>D</ci>
          <ci>s</ci>
         </apply>
        </apply>
        <apply>
         <times></times>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>D</ci>
          <apply>
           <times></times>
           <ci>d</ci>
           <ci>s</ci>
          </apply>
         </apply>
         <ci>c</ci>
        </apply>
       </apply>
       <ci>τ</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <equivalent></equivalent>
     <ci>τ</ci>
     <apply>
      <csymbol cd="latexml">delimited-[]</csymbol>
      <apply>
       <minus></minus>
       <apply>
        <divide></divide>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <minus></minus>
          <apply>
           <ci>normal-→</ci>
           <ci>θ</ci>
          </apply>
          <apply>
           <ci>normal-→</ci>
           <ci>β</ci>
          </apply>
         </apply>
         <cn type="integer">2</cn>
        </apply>
        <cn type="integer">2</cn>
       </apply>
       <ci>ψ</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   t=constant+{D_{d}D_{s}\over D_{ds}c}\tau,~{}\tau\equiv\left[{(\vec{\theta}-%
\vec{\beta})^{2}\over 2}-\psi\right]
  </annotation>
 </semantics>
</math>

</p>

<p>where 

<math display="inline" id="Gravitational_lensing_formalism:49">
 <semantics>
  <mi>τ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>τ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \tau
  </annotation>
 </semantics>
</math>


 is so-called dimensionless time delay, and the 2D lensing potential</p>

<p>

<math display="inline" id="Gravitational_lensing_formalism:50">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>ψ</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mover accent="true">
       <mi>θ</mi>
       <mo stretchy="false">→</mo>
      </mover>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mfrac>
      <mrow>
       <mn>2</mn>
       <msub>
        <mi>D</mi>
        <mrow>
         <mi>d</mi>
         <mi>s</mi>
        </mrow>
       </msub>
      </mrow>
      <mrow>
       <msub>
        <mi>D</mi>
        <mi>d</mi>
       </msub>
       <msub>
        <mi>D</mi>
        <mi>s</mi>
       </msub>
       <msup>
        <mi>c</mi>
        <mn>2</mn>
       </msup>
      </mrow>
     </mfrac>
     <mrow>
      <mo largeop="true" symmetric="true">∫</mo>
      <mrow>
       <mi mathvariant="normal">Φ</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <msub>
          <mi>D</mi>
          <mi>d</mi>
         </msub>
         <mover accent="true">
          <mi>θ</mi>
          <mo stretchy="false">→</mo>
         </mover>
        </mrow>
        <mo>,</mo>
        <mi>z</mi>
        <mo stretchy="false">)</mo>
       </mrow>
       <mi>d</mi>
       <mi>z</mi>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>ψ</ci>
     <apply>
      <ci>normal-→</ci>
      <ci>θ</ci>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <divide></divide>
      <apply>
       <times></times>
       <cn type="integer">2</cn>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>D</ci>
        <apply>
         <times></times>
         <ci>d</ci>
         <ci>s</ci>
        </apply>
       </apply>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>D</ci>
        <ci>d</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>D</ci>
        <ci>s</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>c</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
     </apply>
     <apply>
      <int></int>
      <apply>
       <times></times>
       <ci>normal-Φ</ci>
       <interval closure="open">
        <apply>
         <times></times>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>D</ci>
          <ci>d</ci>
         </apply>
         <apply>
          <ci>normal-→</ci>
          <ci>θ</ci>
         </apply>
        </apply>
        <ci>z</ci>
       </interval>
       <ci>d</ci>
       <ci>z</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \psi(\vec{\theta})=\frac{2D_{ds}}{D_{d}D_{s}c^{2}}\int\Phi(D_{d}\vec{\theta},z%
)dz.
  </annotation>
 </semantics>
</math>

</p>

<p>The images lie at the extrema of this surface, so the variation of t with 

<math display="inline" id="Gravitational_lensing_formalism:51">
 <semantics>
  <mover accent="true">
   <mi>θ</mi>
   <mo stretchy="false">→</mo>
  </mover>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-→</ci>
    <ci>θ</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \vec{\theta}
  </annotation>
 </semantics>
</math>

 is zero,</p>

<p>

<math display="inline" id="Gravitational_lensing_formalism:52">
 <semantics>
  <mrow>
   <mn>0</mn>
   <mo>=</mo>
   <mrow>
    <msub>
     <mo>∇</mo>
     <mover accent="true">
      <mi>θ</mi>
      <mo stretchy="false">→</mo>
     </mover>
    </msub>
    <mi>τ</mi>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mover accent="true">
     <mi>θ</mi>
     <mo stretchy="false">→</mo>
    </mover>
    <mo>-</mo>
    <mover accent="true">
     <mi>β</mi>
     <mo stretchy="false">→</mo>
    </mover>
    <mo>-</mo>
    <mrow>
     <mrow>
      <msub>
       <mo>∇</mo>
       <mover accent="true">
        <mi>θ</mi>
        <mo stretchy="false">→</mo>
       </mover>
      </msub>
      <mi>ψ</mi>
     </mrow>
     <mrow>
      <mo stretchy="false">(</mo>
      <mover accent="true">
       <mi>θ</mi>
       <mo stretchy="false">→</mo>
      </mover>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <cn type="integer">0</cn>
     <apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>normal-∇</ci>
       <apply>
        <ci>normal-→</ci>
        <ci>θ</ci>
       </apply>
      </apply>
      <ci>τ</ci>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <minus></minus>
      <apply>
       <ci>normal-→</ci>
       <ci>θ</ci>
      </apply>
      <apply>
       <ci>normal-→</ci>
       <ci>β</ci>
      </apply>
      <apply>
       <times></times>
       <apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>normal-∇</ci>
         <apply>
          <ci>normal-→</ci>
          <ci>θ</ci>
         </apply>
        </apply>
        <ci>ψ</ci>
       </apply>
       <apply>
        <ci>normal-→</ci>
        <ci>θ</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   0=\nabla_{\vec{\theta}}\tau=\vec{\theta}-\vec{\beta}-\nabla_{\vec{\theta}}\psi%
(\vec{\theta})
  </annotation>
 </semantics>
</math>

</p>

<p>which is the lens equation. Take the Poisson's equation for 3D potential 

<math display="inline" id="Gravitational_lensing_formalism:53">
 <semantics>
  <mrow>
   <mrow>
    <mi mathvariant="normal">Φ</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mover accent="true">
      <mi>ξ</mi>
      <mo stretchy="false">→</mo>
     </mover>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mo>-</mo>
    <mrow>
     <mo largeop="true" symmetric="true">∫</mo>
     <mfrac>
      <mrow>
       <msup>
        <mi>d</mi>
        <mn>3</mn>
       </msup>
       <msup>
        <mi>ξ</mi>
        <mo>′</mo>
       </msup>
       <mi>ρ</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <msup>
         <mover accent="true">
          <mi>ξ</mi>
          <mo stretchy="false">→</mo>
         </mover>
         <mo>′</mo>
        </msup>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
      <mrow>
       <mo stretchy="false">|</mo>
       <mrow>
        <mover accent="true">
         <mi>ξ</mi>
         <mo stretchy="false">→</mo>
        </mover>
        <mo>-</mo>
        <msup>
         <mover accent="true">
          <mi>ξ</mi>
          <mo stretchy="false">→</mo>
         </mover>
         <mo>′</mo>
        </msup>
       </mrow>
       <mo stretchy="false">|</mo>
      </mrow>
     </mfrac>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>normal-Φ</ci>
     <apply>
      <ci>normal-→</ci>
      <ci>ξ</ci>
     </apply>
    </apply>
    <apply>
     <minus></minus>
     <apply>
      <int></int>
      <apply>
       <divide></divide>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>d</ci>
         <cn type="integer">3</cn>
        </apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>ξ</ci>
         <ci>normal-′</ci>
        </apply>
        <ci>ρ</ci>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <ci>normal-→</ci>
          <ci>ξ</ci>
         </apply>
         <ci>normal-′</ci>
        </apply>
       </apply>
       <apply>
        <abs></abs>
        <apply>
         <minus></minus>
         <apply>
          <ci>normal-→</ci>
          <ci>ξ</ci>
         </apply>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <apply>
           <ci>normal-→</ci>
           <ci>ξ</ci>
          </apply>
          <ci>normal-′</ci>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Phi(\vec{\xi})=-\int\frac{d^{3}\xi^{\prime}\rho(\vec{\xi}^{\prime})}{|\vec{%
\xi}-\vec{\xi}^{\prime}|}
  </annotation>
 </semantics>
</math>

</p>

<p>and we find the 2D lensing potential</p>

<p>

<math display="inline" id="Gravitational_lensing_formalism:54">
 <semantics>
  <mrow>
   <mi>ψ</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mover accent="true">
     <mi>θ</mi>
     <mo stretchy="false">→</mo>
    </mover>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>=</mo>
   <mo>-</mo>
   <mfrac>
    <mrow>
     <mn>2</mn>
     <mi>G</mi>
     <msub>
      <mi>D</mi>
      <mrow>
       <mi>d</mi>
       <mi>s</mi>
      </mrow>
     </msub>
    </mrow>
    <mrow>
     <msub>
      <mi>D</mi>
      <mi>d</mi>
     </msub>
     <msub>
      <mi>D</mi>
      <mi>s</mi>
     </msub>
     <msup>
      <mi>c</mi>
      <mn>2</mn>
     </msup>
    </mrow>
   </mfrac>
   <mo largeop="true" symmetric="true">∫</mo>
   <mi>d</mi>
   <mi>z</mi>
   <mo largeop="true" symmetric="true">∫</mo>
   <mfrac>
    <mrow>
     <msup>
      <mi>d</mi>
      <mn>3</mn>
     </msup>
     <msup>
      <mi>ξ</mi>
      <mo>′</mo>
     </msup>
     <mi>ρ</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <msup>
       <mover accent="true">
        <mi>ξ</mi>
        <mo stretchy="false">→</mo>
       </mover>
       <mo>′</mo>
      </msup>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mrow>
     <mo stretchy="false">|</mo>
     <mrow>
      <mover accent="true">
       <mi>ξ</mi>
       <mo stretchy="false">→</mo>
      </mover>
      <mo>-</mo>
      <msup>
       <mover accent="true">
        <mi>ξ</mi>
        <mo stretchy="false">→</mo>
       </mover>
       <mo>′</mo>
      </msup>
     </mrow>
     <mo stretchy="false">|</mo>
    </mrow>
   </mfrac>
   <mo>=</mo>
   <mo>-</mo>
   <msub>
    <mo largeop="true" symmetric="true">∑</mo>
    <mi>i</mi>
   </msub>
   <mfrac>
    <mrow>
     <mn>2</mn>
     <mi>G</mi>
     <msub>
      <mi>M</mi>
      <mi>i</mi>
     </msub>
     <msub>
      <mi>D</mi>
      <mrow>
       <mi>i</mi>
       <mi>s</mi>
      </mrow>
     </msub>
    </mrow>
    <mrow>
     <msub>
      <mi>D</mi>
      <mi>s</mi>
     </msub>
     <msub>
      <mi>D</mi>
      <mi>i</mi>
     </msub>
     <msup>
      <mi>c</mi>
      <mn>2</mn>
     </msup>
    </mrow>
   </mfrac>
   <mrow>
    <mo>[</mo>
    <msup>
     <mi>sinh</mi>
     <mrow>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </msup>
    <mfrac>
     <mrow>
      <mo stretchy="false">|</mo>
      <mrow>
       <mi>z</mi>
       <mo>-</mo>
       <msub>
        <mi>D</mi>
        <mi>i</mi>
       </msub>
      </mrow>
      <mo stretchy="false">|</mo>
     </mrow>
     <mrow>
      <msub>
       <mi>D</mi>
       <mi>i</mi>
      </msub>
      <mrow>
       <mo stretchy="false">|</mo>
       <mrow>
        <mover accent="true">
         <mi>θ</mi>
         <mo stretchy="false">→</mo>
        </mover>
        <mo>-</mo>
        <msub>
         <mover accent="true">
          <mi>θ</mi>
          <mo stretchy="false">→</mo>
         </mover>
         <mi>i</mi>
        </msub>
       </mrow>
       <mo stretchy="false">|</mo>
      </mrow>
     </mrow>
    </mfrac>
    <mo>]</mo>
   </mrow>
   <msubsup>
    <mo stretchy="false">|</mo>
    <msub>
     <mi>D</mi>
     <mi>i</mi>
    </msub>
    <msub>
     <mi>D</mi>
     <mi>s</mi>
    </msub>
   </msubsup>
   <mo>+</mo>
   <msubsup>
    <mo stretchy="false">|</mo>
    <msub>
     <mi>D</mi>
     <mi>i</mi>
    </msub>
    <mn>0</mn>
   </msubsup>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">ψ</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <ci>normal-→</ci>
      <ci>θ</ci>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <eq></eq>
    <minus></minus>
    <apply>
     <divide></divide>
     <apply>
      <times></times>
      <cn type="integer">2</cn>
      <ci>G</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>D</ci>
       <apply>
        <times></times>
        <ci>d</ci>
        <ci>s</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>D</ci>
       <ci>d</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>D</ci>
       <ci>s</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>c</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
    <int></int>
    <csymbol cd="unknown">d</csymbol>
    <csymbol cd="unknown">z</csymbol>
    <int></int>
    <apply>
     <divide></divide>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>d</ci>
       <cn type="integer">3</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>ξ</ci>
       <ci>normal-′</ci>
      </apply>
      <ci>ρ</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <ci>normal-→</ci>
        <ci>ξ</ci>
       </apply>
       <ci>normal-′</ci>
      </apply>
     </apply>
     <apply>
      <abs></abs>
      <apply>
       <minus></minus>
       <apply>
        <ci>normal-→</ci>
        <ci>ξ</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <ci>normal-→</ci>
         <ci>ξ</ci>
        </apply>
        <ci>normal-′</ci>
       </apply>
      </apply>
     </apply>
    </apply>
    <eq></eq>
    <minus></minus>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <sum></sum>
     <ci>i</ci>
    </apply>
    <apply>
     <divide></divide>
     <apply>
      <times></times>
      <cn type="integer">2</cn>
      <ci>G</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>M</ci>
       <ci>i</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>D</ci>
       <apply>
        <times></times>
        <ci>i</ci>
        <ci>s</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>D</ci>
       <ci>s</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>D</ci>
       <ci>i</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>c</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-[</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <sinh></sinh>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <apply>
      <divide></divide>
      <apply>
       <abs></abs>
       <apply>
        <minus></minus>
        <ci>z</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>D</ci>
         <ci>i</ci>
        </apply>
       </apply>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>D</ci>
        <ci>i</ci>
       </apply>
       <apply>
        <abs></abs>
        <apply>
         <minus></minus>
         <apply>
          <ci>normal-→</ci>
          <ci>θ</ci>
         </apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <apply>
           <ci>normal-→</ci>
           <ci>θ</ci>
          </apply>
          <ci>i</ci>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
     <ci>normal-]</ci>
    </cerror>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>normal-|</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>D</ci>
       <ci>i</ci>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>D</ci>
      <ci>s</ci>
     </apply>
    </apply>
    <plus></plus>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>normal-|</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>D</ci>
       <ci>i</ci>
      </apply>
     </apply>
     <cn type="integer">0</cn>
    </apply>
    <ci>normal-.</ci>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \psi(\vec{\theta})=-\frac{2GD_{ds}}{D_{d}D_{s}c^{2}}\int dz\int\frac{d^{3}\xi^%
{\prime}\rho(\vec{\xi}^{\prime})}{|\vec{\xi}-\vec{\xi}^{\prime}|}=-\sum_{i}%
\frac{2GM_{i}D_{is}}{D_{s}D_{i}c^{2}}\left[\sinh^{-1}{|z-D_{i}|\over D_{i}|%
\vec{\theta}-\vec{\theta}_{i}|}\right]|_{D_{i}}^{D_{s}}+|_{D_{i}}^{0}.
  </annotation>
 </semantics>
</math>

</p>

<p>Here we assumed the lens is a collection of point masses 

<math display="inline" id="Gravitational_lensing_formalism:55">
 <semantics>
  <msub>
   <mi>M</mi>
   <mi>i</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>M</ci>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   M_{i}
  </annotation>
 </semantics>
</math>

 at angular coordinates 

<math display="inline" id="Gravitational_lensing_formalism:56">
 <semantics>
  <msub>
   <mover accent="true">
    <mi>θ</mi>
    <mo stretchy="false">→</mo>
   </mover>
   <mi>i</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <apply>
     <ci>normal-→</ci>
     <ci>θ</ci>
    </apply>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \vec{\theta}_{i}
  </annotation>
 </semantics>
</math>

 and distances 

<math display="inline" id="Gravitational_lensing_formalism:57">
 <semantics>
  <mrow>
   <mrow>
    <mi>z</mi>
    <mo>=</mo>
    <msub>
     <mi>D</mi>
     <mi>i</mi>
    </msub>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>z</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>D</ci>
     <ci>i</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   z=D_{i}.
  </annotation>
 </semantics>
</math>

 Use 

<math display="inline" id="Gravitational_lensing_formalism:58">
 <semantics>
  <mrow>
   <mrow>
    <msup>
     <mi>sinh</mi>
     <mrow>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </msup>
    <mrow>
     <mn>1</mn>
     <mo>/</mo>
     <mi>x</mi>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mi>ln</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mrow>
       <mn>1</mn>
       <mo>/</mo>
       <mi>x</mi>
      </mrow>
      <mo>+</mo>
      <msqrt>
       <mrow>
        <mrow>
         <mn>1</mn>
         <mo>/</mo>
         <msup>
          <mi>x</mi>
          <mn>2</mn>
         </msup>
        </mrow>
        <mo>+</mo>
        <mn>1</mn>
       </mrow>
      </msqrt>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>≈</mo>
   <mrow>
    <mo>-</mo>
    <mrow>
     <mi>ln</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mi>x</mi>
       <mo>/</mo>
       <mn>2</mn>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <sinh></sinh>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <ci>x</ci>
      </apply>
     </apply>
     <apply>
      <ln></ln>
      <apply>
       <plus></plus>
       <apply>
        <divide></divide>
        <cn type="integer">1</cn>
        <ci>x</ci>
       </apply>
       <apply>
        <root></root>
        <apply>
         <plus></plus>
         <apply>
          <divide></divide>
          <cn type="integer">1</cn>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <ci>x</ci>
           <cn type="integer">2</cn>
          </apply>
         </apply>
         <cn type="integer">1</cn>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <approx></approx>
     <share href="#.cmml">
     </share>
     <apply>
      <minus></minus>
      <apply>
       <ln></ln>
       <apply>
        <divide></divide>
        <ci>x</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \sinh^{-1}1/x=\ln(1/x+\sqrt{1/x^{2}+1})\approx-\ln(x/2)
  </annotation>
 </semantics>
</math>

 for very small 

<math display="inline" id="Gravitational_lensing_formalism:59">
 <semantics>
  <mi>x</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>x</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x
  </annotation>
 </semantics>
</math>

 we find</p>

<p>

<math display="inline" id="Gravitational_lensing_formalism:60">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>ψ</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mover accent="true">
       <mi>θ</mi>
       <mo stretchy="false">→</mo>
      </mover>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>≈</mo>
    <mrow>
     <msub>
      <mo largeop="true" symmetric="true">∑</mo>
      <mi>i</mi>
     </msub>
     <mrow>
      <mfrac>
       <mrow>
        <mn>2</mn>
        <mi>G</mi>
        <msub>
         <mi>M</mi>
         <mi>i</mi>
        </msub>
        <msub>
         <mi>D</mi>
         <mrow>
          <mi>i</mi>
          <mi>s</mi>
         </mrow>
        </msub>
       </mrow>
       <mrow>
        <msub>
         <mi>D</mi>
         <mi>s</mi>
        </msub>
        <msub>
         <mi>D</mi>
         <mi>i</mi>
        </msub>
        <msup>
         <mi>c</mi>
         <mn>2</mn>
        </msup>
       </mrow>
      </mfrac>
      <mrow>
       <mo>[</mo>
       <mrow>
        <mi>ln</mi>
        <mrow>
         <mo>(</mo>
         <mrow>
          <mfrac>
           <msup>
            <mrow>
             <mo stretchy="false">|</mo>
             <mrow>
              <mover accent="true">
               <mi>θ</mi>
               <mo stretchy="false">→</mo>
              </mover>
              <mo>-</mo>
              <msub>
               <mover accent="true">
                <mi>θ</mi>
                <mo stretchy="false">→</mo>
               </mover>
               <mi>i</mi>
              </msub>
             </mrow>
             <mo stretchy="false">|</mo>
            </mrow>
            <mn>2</mn>
           </msup>
           <mn>4</mn>
          </mfrac>
          <mfrac>
           <msub>
            <mi>D</mi>
            <mi>i</mi>
           </msub>
           <msub>
            <mi>D</mi>
            <mrow>
             <mi>i</mi>
             <mi>s</mi>
            </mrow>
           </msub>
          </mfrac>
         </mrow>
         <mo>)</mo>
        </mrow>
       </mrow>
       <mo>]</mo>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <approx></approx>
    <apply>
     <times></times>
     <ci>ψ</ci>
     <apply>
      <ci>normal-→</ci>
      <ci>θ</ci>
     </apply>
    </apply>
    <apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <sum></sum>
      <ci>i</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <apply>
        <times></times>
        <cn type="integer">2</cn>
        <ci>G</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>M</ci>
         <ci>i</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>D</ci>
         <apply>
          <times></times>
          <ci>i</ci>
          <ci>s</ci>
         </apply>
        </apply>
       </apply>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>D</ci>
         <ci>s</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>D</ci>
         <ci>i</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>c</ci>
         <cn type="integer">2</cn>
        </apply>
       </apply>
      </apply>
      <apply>
       <csymbol cd="latexml">delimited-[]</csymbol>
       <apply>
        <ln></ln>
        <apply>
         <times></times>
         <apply>
          <divide></divide>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <apply>
            <abs></abs>
            <apply>
             <minus></minus>
             <apply>
              <ci>normal-→</ci>
              <ci>θ</ci>
             </apply>
             <apply>
              <csymbol cd="ambiguous">subscript</csymbol>
              <apply>
               <ci>normal-→</ci>
               <ci>θ</ci>
              </apply>
              <ci>i</ci>
             </apply>
            </apply>
           </apply>
           <cn type="integer">2</cn>
          </apply>
          <cn type="integer">4</cn>
         </apply>
         <apply>
          <divide></divide>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>D</ci>
           <ci>i</ci>
          </apply>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>D</ci>
           <apply>
            <times></times>
            <ci>i</ci>
            <ci>s</ci>
           </apply>
          </apply>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \psi(\vec{\theta})\approx\sum_{i}\frac{2GM_{i}D_{is}}{D_{s}D_{i}c^{2}}\left[%
\ln\left({|\vec{\theta}-\vec{\theta}_{i}|^{2}\over 4}{D_{i}\over D_{is}}\right%
)\right].
  </annotation>
 </semantics>
</math>

</p>

<p>One can compute the <em>convergence</em> by applying the 2D Laplacian of the 2D lensing potential</p>

<p>

<math display="inline" id="Gravitational_lensing_formalism:61">
 <semantics>
  <mrow>
   <mi>κ</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mover accent="true">
     <mi>θ</mi>
     <mo stretchy="false">→</mo>
    </mover>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>=</mo>
   <mfrac>
    <mn>1</mn>
    <mn>2</mn>
   </mfrac>
   <msubsup>
    <mo>∇</mo>
    <mover accent="true">
     <mi>θ</mi>
     <mo stretchy="false">→</mo>
    </mover>
    <mn>2</mn>
   </msubsup>
   <mi>ψ</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mover accent="true">
     <mi>θ</mi>
     <mo stretchy="false">→</mo>
    </mover>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>=</mo>
   <mfrac>
    <mrow>
     <mn>4</mn>
     <mi>π</mi>
     <mi>G</mi>
     <msub>
      <mi>D</mi>
      <mrow>
       <mi>d</mi>
       <mi>s</mi>
      </mrow>
     </msub>
     <msub>
      <mi>D</mi>
      <mi>d</mi>
     </msub>
    </mrow>
    <mrow>
     <msup>
      <mi>c</mi>
      <mn>2</mn>
     </msup>
     <msub>
      <mi>D</mi>
      <mi>s</mi>
     </msub>
    </mrow>
   </mfrac>
   <mo largeop="true" symmetric="true">∫</mo>
   <mi>d</mi>
   <mi>z</mi>
   <mi>ρ</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>D</mi>
     <mi>d</mi>
    </msub>
    <mover accent="true">
     <mi>θ</mi>
     <mo stretchy="false">→</mo>
    </mover>
    <mo>,</mo>
    <mi>z</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>=</mo>
   <mo>=</mo>
   <mfrac>
    <mi mathvariant="normal">Σ</mi>
    <msub>
     <mi mathvariant="normal">Σ</mi>
     <mrow>
      <mi>c</mi>
      <mi>r</mi>
     </mrow>
    </msub>
   </mfrac>
   <mo>=</mo>
   <mo>=</mo>
   <msub>
    <mo largeop="true" symmetric="true">∑</mo>
    <mi>i</mi>
   </msub>
   <mfrac>
    <mrow>
     <mn>4</mn>
     <mi>π</mi>
     <mi>G</mi>
     <msub>
      <mi>M</mi>
      <mi>i</mi>
     </msub>
     <msub>
      <mi>D</mi>
      <mrow>
       <mi>i</mi>
       <mi>s</mi>
      </mrow>
     </msub>
    </mrow>
    <mrow>
     <msup>
      <mi>c</mi>
      <mn>2</mn>
     </msup>
     <msub>
      <mi>D</mi>
      <mi>i</mi>
     </msub>
     <msub>
      <mi>D</mi>
      <mi>s</mi>
     </msub>
    </mrow>
   </mfrac>
   <mi>δ</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mover accent="true">
     <mi>θ</mi>
     <mo stretchy="false">→</mo>
    </mover>
    <mo>-</mo>
    <msub>
     <mover accent="true">
      <mi>θ</mi>
      <mo stretchy="false">→</mo>
     </mover>
     <mi>i</mi>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">κ</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <ci>normal-→</ci>
      <ci>θ</ci>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <eq></eq>
    <apply>
     <divide></divide>
     <cn type="integer">1</cn>
     <cn type="integer">2</cn>
    </apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>normal-∇</ci>
      <apply>
       <ci>normal-→</ci>
       <ci>θ</ci>
      </apply>
     </apply>
     <cn type="integer">2</cn>
    </apply>
    <csymbol cd="unknown">ψ</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <ci>normal-→</ci>
      <ci>θ</ci>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <eq></eq>
    <apply>
     <divide></divide>
     <apply>
      <times></times>
      <cn type="integer">4</cn>
      <ci>π</ci>
      <ci>G</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>D</ci>
       <apply>
        <times></times>
        <ci>d</ci>
        <ci>s</ci>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>D</ci>
       <ci>d</ci>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>c</ci>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>D</ci>
       <ci>s</ci>
      </apply>
     </apply>
    </apply>
    <int></int>
    <csymbol cd="unknown">d</csymbol>
    <csymbol cd="unknown">z</csymbol>
    <csymbol cd="unknown">ρ</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>D</ci>
      <ci>d</ci>
     </apply>
     <apply>
      <ci>normal-→</ci>
      <ci>θ</ci>
     </apply>
     <ci>normal-,</ci>
     <csymbol cd="unknown">z</csymbol>
     <ci>normal-)</ci>
    </cerror>
    <eq></eq>
    <eq></eq>
    <apply>
     <divide></divide>
     <ci>normal-Σ</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>normal-Σ</ci>
      <apply>
       <times></times>
       <ci>c</ci>
       <ci>r</ci>
      </apply>
     </apply>
    </apply>
    <eq></eq>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <sum></sum>
     <ci>i</ci>
    </apply>
    <apply>
     <divide></divide>
     <apply>
      <times></times>
      <cn type="integer">4</cn>
      <ci>π</ci>
      <ci>G</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>M</ci>
       <ci>i</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>D</ci>
       <apply>
        <times></times>
        <ci>i</ci>
        <ci>s</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>c</ci>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>D</ci>
       <ci>i</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>D</ci>
       <ci>s</ci>
      </apply>
     </apply>
    </apply>
    <csymbol cd="unknown">δ</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <ci>normal-→</ci>
      <ci>θ</ci>
     </apply>
     <minus></minus>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <ci>normal-→</ci>
       <ci>θ</ci>
      </apply>
      <ci>i</ci>
     </apply>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \kappa(\vec{\theta})=\frac{1}{2}\nabla_{\vec{\theta}}^{2}\psi(\vec{\theta})=%
\frac{4\pi GD_{ds}D_{d}}{c^{2}D_{s}}\int dz\rho(D_{d}\vec{\theta},z)=={\Sigma%
\over\Sigma_{cr}}==\sum_{i}{4\pi GM_{i}D_{is}\over c^{2}D_{i}D_{s}}\delta(\vec%
{\theta}-\vec{\theta}_{i})
  </annotation>
 </semantics>
</math>

</p>

<p>in agreement with earlier definition 

<math display="inline" id="Gravitational_lensing_formalism:62">
 <semantics>
  <mrow>
   <mrow>
    <mi>κ</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mover accent="true">
      <mi>θ</mi>
      <mo stretchy="false">→</mo>
     </mover>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mfrac>
    <mi mathvariant="normal">Σ</mi>
    <msub>
     <mi mathvariant="normal">Σ</mi>
     <mrow>
      <mi>c</mi>
      <mi>r</mi>
     </mrow>
    </msub>
   </mfrac>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>κ</ci>
     <apply>
      <ci>normal-→</ci>
      <ci>θ</ci>
     </apply>
    </apply>
    <apply>
     <divide></divide>
     <ci>normal-Σ</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>normal-Σ</ci>
      <apply>
       <times></times>
       <ci>c</ci>
       <ci>r</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \kappa(\vec{\theta})={\Sigma\over\Sigma_{cr}}
  </annotation>
 </semantics>
</math>

 as the ratio of projected density with the critical density. Here we used 

<math display="inline" id="Gravitational_lensing_formalism:63">
 <semantics>
  <mrow>
   <mrow>
    <msup>
     <mo>∇</mo>
     <mn>2</mn>
    </msup>
    <mrow>
     <mn>1</mn>
     <mo>/</mo>
     <mi>r</mi>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mo>-</mo>
    <mrow>
     <mn>4</mn>
     <mi>π</mi>
     <mi>δ</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>r</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>normal-∇</ci>
      <cn type="integer">2</cn>
     </apply>
     <apply>
      <divide></divide>
      <cn type="integer">1</cn>
      <ci>r</ci>
     </apply>
    </apply>
    <apply>
     <minus></minus>
     <apply>
      <times></times>
      <cn type="integer">4</cn>
      <ci>π</ci>
      <ci>δ</ci>
      <ci>r</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \nabla^{2}1/r=-4\pi\delta(r)
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Gravitational_lensing_formalism:64">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mo>∇</mo>
     <mover accent="true">
      <mi>θ</mi>
      <mo stretchy="false">→</mo>
     </mover>
    </msub>
    <mo>=</mo>
    <mrow>
     <msub>
      <mi>D</mi>
      <mi>d</mi>
     </msub>
     <mo>∇</mo>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>normal-∇</ci>
     <apply>
      <ci>normal-→</ci>
      <ci>θ</ci>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>D</ci>
      <ci>d</ci>
     </apply>
     <ci>normal-∇</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \nabla_{\vec{\theta}}=D_{d}\nabla.
  </annotation>
 </semantics>
</math>

</p>

<p>We can also confirm the previously defined reduced deflection angle</p>

<p>

<math display="inline" id="Gravitational_lensing_formalism:65">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mover accent="true">
      <mi>θ</mi>
      <mo stretchy="false">→</mo>
     </mover>
     <mo>-</mo>
     <mover accent="true">
      <mi>β</mi>
      <mo stretchy="false">→</mo>
     </mover>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mrow>
      <msub>
       <mo>∇</mo>
       <mover accent="true">
        <mi>θ</mi>
        <mo stretchy="false">→</mo>
       </mover>
      </msub>
      <mi>ψ</mi>
     </mrow>
     <mrow>
      <mo stretchy="false">(</mo>
      <mover accent="true">
       <mi>θ</mi>
       <mo stretchy="false">→</mo>
      </mover>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <msub>
      <mo largeop="true" symmetric="true">∑</mo>
      <mi>i</mi>
     </msub>
     <mfrac>
      <msubsup>
       <mi>θ</mi>
       <mrow>
        <mi>E</mi>
        <mi>i</mi>
       </mrow>
       <mn>2</mn>
      </msubsup>
      <mrow>
       <mo stretchy="false">|</mo>
       <mrow>
        <mover accent="true">
         <mi>θ</mi>
         <mo stretchy="false">→</mo>
        </mover>
        <mo>-</mo>
        <msub>
         <mover accent="true">
          <mi>θ</mi>
          <mo stretchy="false">→</mo>
         </mover>
         <mi>i</mi>
        </msub>
       </mrow>
       <mo stretchy="false">|</mo>
      </mrow>
     </mfrac>
    </mrow>
   </mrow>
   <mo rspace="5.8pt">,</mo>
   <mrow>
    <mrow>
     <mi>π</mi>
     <msubsup>
      <mi>θ</mi>
      <mrow>
       <mi>E</mi>
       <mi>i</mi>
      </mrow>
      <mn>2</mn>
     </msubsup>
    </mrow>
    <mo>≡</mo>
    <mfrac>
     <mrow>
      <mn>4</mn>
      <mi>π</mi>
      <mi>G</mi>
      <msub>
       <mi>M</mi>
       <mi>i</mi>
      </msub>
      <msub>
       <mi>D</mi>
       <mrow>
        <mi>i</mi>
        <mi>s</mi>
       </mrow>
      </msub>
     </mrow>
     <mrow>
      <msup>
       <mi>c</mi>
       <mn>2</mn>
      </msup>
      <msub>
       <mi>D</mi>
       <mi>s</mi>
      </msub>
      <msub>
       <mi>D</mi>
       <mi>i</mi>
      </msub>
     </mrow>
    </mfrac>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <and></and>
     <apply>
      <eq></eq>
      <apply>
       <minus></minus>
       <apply>
        <ci>normal-→</ci>
        <ci>θ</ci>
       </apply>
       <apply>
        <ci>normal-→</ci>
        <ci>β</ci>
       </apply>
      </apply>
      <apply>
       <times></times>
       <apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>normal-∇</ci>
         <apply>
          <ci>normal-→</ci>
          <ci>θ</ci>
         </apply>
        </apply>
        <ci>ψ</ci>
       </apply>
       <apply>
        <ci>normal-→</ci>
        <ci>θ</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <eq></eq>
      <share href="#.cmml">
      </share>
      <apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <ci>i</ci>
       </apply>
       <apply>
        <divide></divide>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>θ</ci>
          <apply>
           <times></times>
           <ci>E</ci>
           <ci>i</ci>
          </apply>
         </apply>
         <cn type="integer">2</cn>
        </apply>
        <apply>
         <abs></abs>
         <apply>
          <minus></minus>
          <apply>
           <ci>normal-→</ci>
           <ci>θ</ci>
          </apply>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <apply>
            <ci>normal-→</ci>
            <ci>θ</ci>
           </apply>
           <ci>i</ci>
          </apply>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <equivalent></equivalent>
     <apply>
      <times></times>
      <ci>π</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>θ</ci>
        <apply>
         <times></times>
         <ci>E</ci>
         <ci>i</ci>
        </apply>
       </apply>
       <cn type="integer">2</cn>
      </apply>
     </apply>
     <apply>
      <divide></divide>
      <apply>
       <times></times>
       <cn type="integer">4</cn>
       <ci>π</ci>
       <ci>G</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>M</ci>
        <ci>i</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>D</ci>
        <apply>
         <times></times>
         <ci>i</ci>
         <ci>s</ci>
        </apply>
       </apply>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>c</ci>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>D</ci>
        <ci>s</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>D</ci>
        <ci>i</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \vec{\theta}-\vec{\beta}=\nabla_{\vec{\theta}}\psi(\vec{\theta})=\sum_{i}{%
\theta_{Ei}^{2}\over|\vec{\theta}-\vec{\theta}_{i}|},~{}\pi\theta_{Ei}^{2}%
\equiv{4\pi GM_{i}D_{is}\over c^{2}D_{s}D_{i}}
  </annotation>
 </semantics>
</math>

</p>

<p>where 

<math display="inline" id="Gravitational_lensing_formalism:66">
 <semantics>
  <msub>
   <mi>θ</mi>
   <mrow>
    <mi>E</mi>
    <mi>i</mi>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>θ</ci>
    <apply>
     <times></times>
     <ci>E</ci>
     <ci>i</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \theta_{Ei}
  </annotation>
 </semantics>
</math>

 is the so-called Einstein angular radius of a point lens Mi. For a single point lens at the origin we recover the standard result that there will be two images at the two solutions of the essentially quadratic equation</p>

<p>

<math display="inline" id="Gravitational_lensing_formalism:67">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mover accent="true">
      <mi>θ</mi>
      <mo stretchy="false">→</mo>
     </mover>
     <mo>-</mo>
     <mover accent="true">
      <mi>β</mi>
      <mo stretchy="false">→</mo>
     </mover>
    </mrow>
    <mo>=</mo>
    <mfrac>
     <msubsup>
      <mi>θ</mi>
      <mi>E</mi>
      <mn>2</mn>
     </msubsup>
     <mrow>
      <mo stretchy="false">|</mo>
      <mover accent="true">
       <mi>θ</mi>
       <mo stretchy="false">→</mo>
      </mover>
      <mo stretchy="false">|</mo>
     </mrow>
    </mfrac>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <minus></minus>
     <apply>
      <ci>normal-→</ci>
      <ci>θ</ci>
     </apply>
     <apply>
      <ci>normal-→</ci>
      <ci>β</ci>
     </apply>
    </apply>
    <apply>
     <divide></divide>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>θ</ci>
       <ci>E</ci>
      </apply>
      <cn type="integer">2</cn>
     </apply>
     <apply>
      <abs></abs>
      <apply>
       <ci>normal-→</ci>
       <ci>θ</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \vec{\theta}-\vec{\beta}={\theta_{E}^{2}\over|\vec{\theta}|}.
  </annotation>
 </semantics>
</math>

</p>

<p>The amplification matrix can be obtained by double derivatives of the dimensionless time delay</p>

<p>

<math display="inline" id="Gravitational_lensing_formalism:68">
 <semantics>
  <mrow>
   <msub>
    <mi>A</mi>
    <mrow>
     <mi>i</mi>
     <mi>j</mi>
    </mrow>
   </msub>
   <mo>=</mo>
   <mfrac>
    <mrow>
     <mo>∂</mo>
     <msub>
      <mi>β</mi>
      <mi>j</mi>
     </msub>
    </mrow>
    <mrow>
     <mo>∂</mo>
     <msub>
      <mi>θ</mi>
      <mi>i</mi>
     </msub>
    </mrow>
   </mfrac>
   <mo>=</mo>
   <mfrac>
    <mrow>
     <mo>∂</mo>
     <mi>τ</mi>
    </mrow>
    <mrow>
     <mrow>
      <mo>∂</mo>
      <msub>
       <mi>θ</mi>
       <mi>i</mi>
      </msub>
     </mrow>
     <mrow>
      <mo>∂</mo>
      <msub>
       <mi>θ</mi>
       <mi>j</mi>
      </msub>
     </mrow>
    </mrow>
   </mfrac>
   <mo>=</mo>
   <mrow>
    <msub>
     <mi>δ</mi>
     <mrow>
      <mi>i</mi>
      <mi>j</mi>
     </mrow>
    </msub>
    <mo>-</mo>
    <mfrac>
     <mrow>
      <mo>∂</mo>
      <mi>ψ</mi>
     </mrow>
     <mrow>
      <mrow>
       <mo>∂</mo>
       <msub>
        <mi>θ</mi>
        <mi>i</mi>
       </msub>
      </mrow>
      <mrow>
       <mo>∂</mo>
       <msub>
        <mi>θ</mi>
        <mi>j</mi>
       </msub>
      </mrow>
     </mrow>
    </mfrac>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mo>[</mo>
    <mtable>
     <mtr>
      <mtd columnalign="center">
       <mrow>
        <mn>1</mn>
        <mo>-</mo>
        <mi>κ</mi>
        <mo>-</mo>
        <msub>
         <mi>γ</mi>
         <mn>1</mn>
        </msub>
       </mrow>
      </mtd>
      <mtd columnalign="center">
       <msub>
        <mi>γ</mi>
        <mn>2</mn>
       </msub>
      </mtd>
     </mtr>
     <mtr>
      <mtd columnalign="center">
       <msub>
        <mi>γ</mi>
        <mn>2</mn>
       </msub>
      </mtd>
      <mtd columnalign="center">
       <mrow>
        <mrow>
         <mn>1</mn>
         <mo>-</mo>
         <mi>κ</mi>
        </mrow>
        <mo>+</mo>
        <msub>
         <mi>γ</mi>
         <mn>1</mn>
        </msub>
       </mrow>
      </mtd>
     </mtr>
    </mtable>
    <mo>]</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>A</ci>
      <apply>
       <times></times>
       <ci>i</ci>
       <ci>j</ci>
      </apply>
     </apply>
     <apply>
      <divide></divide>
      <apply>
       <partialdiff></partialdiff>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>β</ci>
        <ci>j</ci>
       </apply>
      </apply>
      <apply>
       <partialdiff></partialdiff>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>θ</ci>
        <ci>i</ci>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <divide></divide>
      <apply>
       <partialdiff></partialdiff>
       <ci>τ</ci>
      </apply>
      <apply>
       <times></times>
       <apply>
        <partialdiff></partialdiff>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>θ</ci>
         <ci>i</ci>
        </apply>
       </apply>
       <apply>
        <partialdiff></partialdiff>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>θ</ci>
         <ci>j</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <minus></minus>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>δ</ci>
       <apply>
        <times></times>
        <ci>i</ci>
        <ci>j</ci>
       </apply>
      </apply>
      <apply>
       <divide></divide>
       <apply>
        <partialdiff></partialdiff>
        <ci>ψ</ci>
       </apply>
       <apply>
        <times></times>
        <apply>
         <partialdiff></partialdiff>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>θ</ci>
          <ci>i</ci>
         </apply>
        </apply>
        <apply>
         <partialdiff></partialdiff>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>θ</ci>
          <ci>j</ci>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <csymbol cd="latexml">delimited-[]</csymbol>
      <matrix>
       <matrixrow>
        <apply>
         <minus></minus>
         <cn type="integer">1</cn>
         <ci>κ</ci>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>γ</ci>
          <cn type="integer">1</cn>
         </apply>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>γ</ci>
         <cn type="integer">2</cn>
        </apply>
       </matrixrow>
       <matrixrow>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>γ</ci>
         <cn type="integer">2</cn>
        </apply>
        <apply>
         <plus></plus>
         <apply>
          <minus></minus>
          <cn type="integer">1</cn>
          <ci>κ</ci>
         </apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>γ</ci>
          <cn type="integer">1</cn>
         </apply>
        </apply>
       </matrixrow>
      </matrix>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A_{ij}={\partial\beta_{j}\over\partial\theta_{i}}={\partial\tau\over\partial%
\theta_{i}\partial\theta_{j}}=\delta_{ij}-{\partial\psi\over\partial\theta_{i}%
\partial\theta_{j}}=\left[\begin{array}[]{ c c }1-\kappa-\gamma_{1}&\gamma_{2}%
\\
\gamma_{2}&1-\kappa+\gamma_{1}\end{array}\right]
  </annotation>
 </semantics>
</math>

</p>

<p>where we have define the derivatives</p>

<p>

<math display="inline" id="Gravitational_lensing_formalism:69">
 <semantics>
  <mrow>
   <mrow>
    <mi>κ</mi>
    <mo>=</mo>
    <mrow>
     <mfrac>
      <mrow>
       <mo>∂</mo>
       <mi>ψ</mi>
      </mrow>
      <mrow>
       <mn>2</mn>
       <mrow>
        <mo>∂</mo>
        <msub>
         <mi>θ</mi>
         <mn>1</mn>
        </msub>
       </mrow>
       <mrow>
        <mo>∂</mo>
        <msub>
         <mi>θ</mi>
         <mn>1</mn>
        </msub>
       </mrow>
      </mrow>
     </mfrac>
     <mo>+</mo>
     <mfrac>
      <mrow>
       <mo>∂</mo>
       <mi>ψ</mi>
      </mrow>
      <mrow>
       <mn>2</mn>
       <mrow>
        <mo>∂</mo>
        <msub>
         <mi>θ</mi>
         <mn>2</mn>
        </msub>
       </mrow>
       <mrow>
        <mo>∂</mo>
        <msub>
         <mi>θ</mi>
         <mn>2</mn>
        </msub>
       </mrow>
      </mrow>
     </mfrac>
    </mrow>
   </mrow>
   <mo rspace="5.8pt">,</mo>
   <mrow>
    <mrow>
     <msub>
      <mi>γ</mi>
      <mn>1</mn>
     </msub>
     <mo>≡</mo>
     <mrow>
      <mfrac>
       <mrow>
        <mo>∂</mo>
        <mi>ψ</mi>
       </mrow>
       <mrow>
        <mn>2</mn>
        <mrow>
         <mo>∂</mo>
         <msub>
          <mi>θ</mi>
          <mn>1</mn>
         </msub>
        </mrow>
        <mrow>
         <mo>∂</mo>
         <msub>
          <mi>θ</mi>
          <mn>1</mn>
         </msub>
        </mrow>
       </mrow>
      </mfrac>
      <mo>-</mo>
      <mfrac>
       <mrow>
        <mo>∂</mo>
        <mi>ψ</mi>
       </mrow>
       <mrow>
        <mn>2</mn>
        <mrow>
         <mo>∂</mo>
         <msub>
          <mi>θ</mi>
          <mn>2</mn>
         </msub>
        </mrow>
        <mrow>
         <mo>∂</mo>
         <msub>
          <mi>θ</mi>
          <mn>2</mn>
         </msub>
        </mrow>
       </mrow>
      </mfrac>
     </mrow>
    </mrow>
    <mo rspace="5.8pt">,</mo>
    <mrow>
     <msub>
      <mi>γ</mi>
      <mn>2</mn>
     </msub>
     <mo>≡</mo>
     <mfrac>
      <mrow>
       <mo>∂</mo>
       <mi>ψ</mi>
      </mrow>
      <mrow>
       <mrow>
        <mo>∂</mo>
        <msub>
         <mi>θ</mi>
         <mn>1</mn>
        </msub>
       </mrow>
       <mrow>
        <mo>∂</mo>
        <msub>
         <mi>θ</mi>
         <mn>2</mn>
        </msub>
       </mrow>
      </mrow>
     </mfrac>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <eq></eq>
     <ci>κ</ci>
     <apply>
      <plus></plus>
      <apply>
       <divide></divide>
       <apply>
        <partialdiff></partialdiff>
        <ci>ψ</ci>
       </apply>
       <apply>
        <times></times>
        <cn type="integer">2</cn>
        <apply>
         <partialdiff></partialdiff>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>θ</ci>
          <cn type="integer">1</cn>
         </apply>
        </apply>
        <apply>
         <partialdiff></partialdiff>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>θ</ci>
          <cn type="integer">1</cn>
         </apply>
        </apply>
       </apply>
      </apply>
      <apply>
       <divide></divide>
       <apply>
        <partialdiff></partialdiff>
        <ci>ψ</ci>
       </apply>
       <apply>
        <times></times>
        <cn type="integer">2</cn>
        <apply>
         <partialdiff></partialdiff>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>θ</ci>
          <cn type="integer">2</cn>
         </apply>
        </apply>
        <apply>
         <partialdiff></partialdiff>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>θ</ci>
          <cn type="integer">2</cn>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <csymbol cd="ambiguous">formulae-sequence</csymbol>
     <apply>
      <equivalent></equivalent>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>γ</ci>
       <cn type="integer">1</cn>
      </apply>
      <apply>
       <minus></minus>
       <apply>
        <divide></divide>
        <apply>
         <partialdiff></partialdiff>
         <ci>ψ</ci>
        </apply>
        <apply>
         <times></times>
         <cn type="integer">2</cn>
         <apply>
          <partialdiff></partialdiff>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>θ</ci>
           <cn type="integer">1</cn>
          </apply>
         </apply>
         <apply>
          <partialdiff></partialdiff>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>θ</ci>
           <cn type="integer">1</cn>
          </apply>
         </apply>
        </apply>
       </apply>
       <apply>
        <divide></divide>
        <apply>
         <partialdiff></partialdiff>
         <ci>ψ</ci>
        </apply>
        <apply>
         <times></times>
         <cn type="integer">2</cn>
         <apply>
          <partialdiff></partialdiff>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>θ</ci>
           <cn type="integer">2</cn>
          </apply>
         </apply>
         <apply>
          <partialdiff></partialdiff>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>θ</ci>
           <cn type="integer">2</cn>
          </apply>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <equivalent></equivalent>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>γ</ci>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <divide></divide>
       <apply>
        <partialdiff></partialdiff>
        <ci>ψ</ci>
       </apply>
       <apply>
        <times></times>
        <apply>
         <partialdiff></partialdiff>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>θ</ci>
          <cn type="integer">1</cn>
         </apply>
        </apply>
        <apply>
         <partialdiff></partialdiff>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>θ</ci>
          <cn type="integer">2</cn>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \kappa={\partial\psi\over 2\partial\theta_{1}\partial\theta_{1}}+{\partial\psi%
\over 2\partial\theta_{2}\partial\theta_{2}},~{}\gamma_{1}\equiv{\partial\psi%
\over 2\partial\theta_{1}\partial\theta_{1}}-{\partial\psi\over 2\partial%
\theta_{2}\partial\theta_{2}},~{}\gamma_{2}\equiv{\partial\psi\over\partial%
\theta_{1}\partial\theta_{2}}
  </annotation>
 </semantics>
</math>

</p>

<p>which takes the meaning of convergence and shear. The amplification is the inverse of the Jacobian</p>

<p>

<math display="inline" id="Gravitational_lensing_formalism:70">
 <semantics>
  <mrow>
   <mi>A</mi>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mn>1</mn>
     <mo>/</mo>
     <mi>d</mi>
    </mrow>
    <mi>e</mi>
    <mi>t</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <msub>
      <mi>A</mi>
      <mrow>
       <mi>i</mi>
       <mi>j</mi>
      </mrow>
     </msub>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mfrac>
    <mn>1</mn>
    <mrow>
     <msup>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mn>1</mn>
        <mo>-</mo>
        <mi>κ</mi>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
      <mn>2</mn>
     </msup>
     <mo>-</mo>
     <msubsup>
      <mi>γ</mi>
      <mn>1</mn>
      <mn>2</mn>
     </msubsup>
     <mo>-</mo>
     <msubsup>
      <mi>γ</mi>
      <mn>2</mn>
      <mn>2</mn>
     </msubsup>
    </mrow>
   </mfrac>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <ci>A</ci>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <ci>d</ci>
      </apply>
      <ci>e</ci>
      <ci>t</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>A</ci>
       <apply>
        <times></times>
        <ci>i</ci>
        <ci>j</ci>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <divide></divide>
      <cn type="integer">1</cn>
      <apply>
       <minus></minus>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <minus></minus>
         <cn type="integer">1</cn>
         <ci>κ</ci>
        </apply>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>γ</ci>
         <cn type="integer">1</cn>
        </apply>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>γ</ci>
         <cn type="integer">2</cn>
        </apply>
        <cn type="integer">2</cn>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A=1/det(A_{ij})={1\over(1-\kappa)^{2}-\gamma_{1}^{2}-\gamma_{2}^{2}}
  </annotation>
 </semantics>
</math>

</p>

<p>where a positive A means either a maxima or a minima, and a negative A means a saddle point in the arrival surface.</p>

<p>For a single point lens, one can show (albeit a lengthy calculation) that</p>

<p>

<math display="inline" id="Gravitational_lensing_formalism:71">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mrow>
      <mi>κ</mi>
      <mo>=</mo>
      <mn>0</mn>
     </mrow>
     <mo rspace="5.8pt">,</mo>
     <mrow>
      <mi>γ</mi>
      <mo>=</mo>
      <msqrt>
       <mrow>
        <msubsup>
         <mi>γ</mi>
         <mn>1</mn>
         <mn>2</mn>
        </msubsup>
        <mo>+</mo>
        <msubsup>
         <mi>γ</mi>
         <mn>2</mn>
         <mn>2</mn>
        </msubsup>
       </mrow>
      </msqrt>
      <mo>=</mo>
      <mfrac>
       <msubsup>
        <mi>θ</mi>
        <mi>E</mi>
        <mn>2</mn>
       </msubsup>
       <msup>
        <mrow>
         <mo stretchy="false">|</mo>
         <mi>θ</mi>
         <mo stretchy="false">|</mo>
        </mrow>
        <mn>2</mn>
       </msup>
      </mfrac>
     </mrow>
    </mrow>
    <mo rspace="5.8pt">,</mo>
    <mrow>
     <msubsup>
      <mi>θ</mi>
      <mi>E</mi>
      <mn>2</mn>
     </msubsup>
     <mo>=</mo>
     <mfrac>
      <mrow>
       <mn>4</mn>
       <mi>G</mi>
       <mi>M</mi>
       <msub>
        <mi>D</mi>
        <mrow>
         <mi>d</mi>
         <mi>s</mi>
        </mrow>
       </msub>
      </mrow>
      <mrow>
       <msup>
        <mi>c</mi>
        <mn>2</mn>
       </msup>
       <msub>
        <mi>D</mi>
        <mi>d</mi>
       </msub>
       <msub>
        <mi>D</mi>
        <mi>s</mi>
       </msub>
      </mrow>
     </mfrac>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <csymbol cd="ambiguous">formulae-sequence</csymbol>
     <apply>
      <eq></eq>
      <ci>κ</ci>
      <cn type="integer">0</cn>
     </apply>
     <apply>
      <and></and>
      <apply>
       <eq></eq>
       <ci>γ</ci>
       <apply>
        <root></root>
        <apply>
         <plus></plus>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>γ</ci>
           <cn type="integer">1</cn>
          </apply>
          <cn type="integer">2</cn>
         </apply>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>γ</ci>
           <cn type="integer">2</cn>
          </apply>
          <cn type="integer">2</cn>
         </apply>
        </apply>
       </apply>
      </apply>
      <apply>
       <eq></eq>
       <share href="#.cmml">
       </share>
       <apply>
        <divide></divide>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>θ</ci>
          <ci>E</ci>
         </apply>
         <cn type="integer">2</cn>
        </apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <abs></abs>
          <ci>θ</ci>
         </apply>
         <cn type="integer">2</cn>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>θ</ci>
       <ci>E</ci>
      </apply>
      <cn type="integer">2</cn>
     </apply>
     <apply>
      <divide></divide>
      <apply>
       <times></times>
       <cn type="integer">4</cn>
       <ci>G</ci>
       <ci>M</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>D</ci>
        <apply>
         <times></times>
         <ci>d</ci>
         <ci>s</ci>
        </apply>
       </apply>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>c</ci>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>D</ci>
        <ci>d</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>D</ci>
        <ci>s</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \kappa=0,~{}\gamma=\sqrt{\gamma_{1}^{2}+\gamma_{2}^{2}}={\theta_{E}^{2}\over|%
\theta|^{2}},~{}\theta_{E}^{2}={4GMD_{ds}\over c^{2}D_{d}D_{s}}.
  </annotation>
 </semantics>
</math>

</p>

<p>So the amplification of a point lens is given by</p>

<p>

<math display="inline" id="Gravitational_lensing_formalism:72">
 <semantics>
  <mrow>
   <mrow>
    <mi>A</mi>
    <mo>=</mo>
    <msup>
     <mrow>
      <mo>(</mo>
      <mrow>
       <mn>1</mn>
       <mo>-</mo>
       <mfrac>
        <msubsup>
         <mi>θ</mi>
         <mi>E</mi>
         <mn>4</mn>
        </msubsup>
        <msup>
         <mi>θ</mi>
         <mn>4</mn>
        </msup>
       </mfrac>
      </mrow>
      <mo>)</mo>
     </mrow>
     <mrow>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </msup>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>A</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <minus></minus>
      <cn type="integer">1</cn>
      <apply>
       <divide></divide>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>θ</ci>
         <ci>E</ci>
        </apply>
        <cn type="integer">4</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>θ</ci>
        <cn type="integer">4</cn>
       </apply>
      </apply>
     </apply>
     <apply>
      <minus></minus>
      <cn type="integer">1</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A=\left(1-{\theta_{E}^{4}\over\theta^{4}}\right)^{-1}.
  </annotation>
 </semantics>
</math>

</p>

<p>Note A diverges for images at the Einstein radius 

<math display="inline" id="Gravitational_lensing_formalism:73">
 <semantics>
  <mrow>
   <msub>
    <mi>θ</mi>
    <mi>E</mi>
   </msub>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>θ</ci>
    <ci>E</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \theta_{E}.
  </annotation>
 </semantics>
</math>

</p>

<p>In cases there are multiple point lenses plus a smooth background of (dark) particles of surface density 

<math display="inline" id="Gravitational_lensing_formalism:74">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi mathvariant="normal">Σ</mi>
     <mi>cr</mi>
    </msub>
    <msub>
     <mi>κ</mi>
     <mi>smooth</mi>
    </msub>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>normal-Σ</ci>
     <ci>cr</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>κ</ci>
     <ci>smooth</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Sigma_{\rm cr}\kappa_{\rm smooth},
  </annotation>
 </semantics>
</math>

 the time arrival surface is</p>

<p>

<math display="inline" id="Gravitational_lensing_formalism:75">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>ψ</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mover accent="true">
       <mi>θ</mi>
       <mo stretchy="false">→</mo>
      </mover>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>≈</mo>
    <mrow>
     <mrow>
      <mfrac>
       <mn>1</mn>
       <mn>2</mn>
      </mfrac>
      <msub>
       <mi>κ</mi>
       <mi>smooth</mi>
      </msub>
      <msup>
       <mrow>
        <mo stretchy="false">|</mo>
        <mi>θ</mi>
        <mo stretchy="false">|</mo>
       </mrow>
       <mn>2</mn>
      </msup>
     </mrow>
     <mo>+</mo>
     <mrow>
      <msub>
       <mo largeop="true" symmetric="true">∑</mo>
       <mi>i</mi>
      </msub>
      <mrow>
       <msubsup>
        <mi>θ</mi>
        <mi>E</mi>
        <mn>2</mn>
       </msubsup>
       <mrow>
        <mo>[</mo>
        <mrow>
         <mi>ln</mi>
         <mrow>
          <mo>(</mo>
          <mrow>
           <mfrac>
            <msup>
             <mrow>
              <mo stretchy="false">|</mo>
              <mrow>
               <mover accent="true">
                <mi>θ</mi>
                <mo stretchy="false">→</mo>
               </mover>
               <mo>-</mo>
               <msub>
                <mover accent="true">
                 <mi>θ</mi>
                 <mo stretchy="false">→</mo>
                </mover>
                <mi>i</mi>
               </msub>
              </mrow>
              <mo stretchy="false">|</mo>
             </mrow>
             <mn>2</mn>
            </msup>
            <mn>4</mn>
           </mfrac>
           <mfrac>
            <msub>
             <mi>D</mi>
             <mi>d</mi>
            </msub>
            <msub>
             <mi>D</mi>
             <mrow>
              <mi>d</mi>
              <mi>s</mi>
             </mrow>
            </msub>
           </mfrac>
          </mrow>
          <mo>)</mo>
         </mrow>
        </mrow>
        <mo>]</mo>
       </mrow>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <approx></approx>
    <apply>
     <times></times>
     <ci>ψ</ci>
     <apply>
      <ci>normal-→</ci>
      <ci>θ</ci>
     </apply>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>κ</ci>
       <ci>smooth</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <abs></abs>
        <ci>θ</ci>
       </apply>
       <cn type="integer">2</cn>
      </apply>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <ci>i</ci>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>θ</ci>
         <ci>E</ci>
        </apply>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <csymbol cd="latexml">delimited-[]</csymbol>
        <apply>
         <ln></ln>
         <apply>
          <times></times>
          <apply>
           <divide></divide>
           <apply>
            <csymbol cd="ambiguous">superscript</csymbol>
            <apply>
             <abs></abs>
             <apply>
              <minus></minus>
              <apply>
               <ci>normal-→</ci>
               <ci>θ</ci>
              </apply>
              <apply>
               <csymbol cd="ambiguous">subscript</csymbol>
               <apply>
                <ci>normal-→</ci>
                <ci>θ</ci>
               </apply>
               <ci>i</ci>
              </apply>
             </apply>
            </apply>
            <cn type="integer">2</cn>
           </apply>
           <cn type="integer">4</cn>
          </apply>
          <apply>
           <divide></divide>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <ci>D</ci>
            <ci>d</ci>
           </apply>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <ci>D</ci>
            <apply>
             <times></times>
             <ci>d</ci>
             <ci>s</ci>
            </apply>
           </apply>
          </apply>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \psi(\vec{\theta})\approx{1\over 2}\kappa_{\rm smooth}|\theta|^{2}+\sum_{i}%
\theta_{E}^{2}\left[\ln\left({|\vec{\theta}-\vec{\theta}_{i}|^{2}\over 4}{D_{d%
}\over D_{ds}}\right)\right].
  </annotation>
 </semantics>
</math>

</p>

<p>To compute the amplification, e.g., at the origin (0,0), due to identical point masses distributed at 

<math display="inline" id="Gravitational_lensing_formalism:76">
 <semantics>
  <mrow>
   <mo stretchy="false">(</mo>
   <msub>
    <mi>θ</mi>
    <mrow>
     <mi>x</mi>
     <mi>i</mi>
    </mrow>
   </msub>
   <mo>,</mo>
   <msub>
    <mi>θ</mi>
    <mrow>
     <mi>y</mi>
     <mi>i</mi>
    </mrow>
   </msub>
   <mo stretchy="false">)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <interval closure="open">
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>θ</ci>
     <apply>
      <times></times>
      <ci>x</ci>
      <ci>i</ci>
     </apply>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>θ</ci>
     <apply>
      <times></times>
      <ci>y</ci>
      <ci>i</ci>
     </apply>
    </apply>
   </interval>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (\theta_{xi},\theta_{yi})
  </annotation>
 </semantics>
</math>

 we have to add up the total shear, and include a convergence of the smooth background, 

<math display="inline" id="Gravitational_lensing_formalism:77">
 <semantics>
  <mrow>
   <mi>A</mi>
   <mo>=</mo>
   <msup>
    <mrow>
     <mo>[</mo>
     <mrow>
      <msup>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mn>1</mn>
         <mo>-</mo>
         <msub>
          <mi>κ</mi>
          <mi>smooth</mi>
         </msub>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
       <mn>2</mn>
      </msup>
      <mo>-</mo>
      <msup>
       <mrow>
        <mo>(</mo>
        <mrow>
         <msub>
          <mo largeop="true" symmetric="true">∑</mo>
          <mi>i</mi>
         </msub>
         <mfrac>
          <mrow>
           <mrow>
            <mo stretchy="false">(</mo>
            <mrow>
             <msubsup>
              <mi>θ</mi>
              <mrow>
               <mi>x</mi>
               <mi>i</mi>
              </mrow>
              <mn>2</mn>
             </msubsup>
             <mo>-</mo>
             <msubsup>
              <mi>θ</mi>
              <mrow>
               <mi>y</mi>
               <mi>i</mi>
              </mrow>
              <mn>2</mn>
             </msubsup>
            </mrow>
            <mo stretchy="false">)</mo>
           </mrow>
           <msubsup>
            <mi>θ</mi>
            <mi>E</mi>
            <mn>2</mn>
           </msubsup>
          </mrow>
          <msup>
           <mrow>
            <mo stretchy="false">(</mo>
            <mrow>
             <msubsup>
              <mi>θ</mi>
              <mrow>
               <mi>x</mi>
               <mi>i</mi>
              </mrow>
              <mn>2</mn>
             </msubsup>
             <mo>+</mo>
             <msubsup>
              <mi>θ</mi>
              <mrow>
               <mi>y</mi>
               <mi>i</mi>
              </mrow>
              <mn>2</mn>
             </msubsup>
            </mrow>
            <mo stretchy="false">)</mo>
           </mrow>
           <mn>2</mn>
          </msup>
         </mfrac>
        </mrow>
        <mo>)</mo>
       </mrow>
       <mn>2</mn>
      </msup>
      <mo>-</mo>
      <msup>
       <mrow>
        <mo>(</mo>
        <mrow>
         <msub>
          <mo largeop="true" symmetric="true">∑</mo>
          <mi>i</mi>
         </msub>
         <mfrac>
          <mrow>
           <mrow>
            <mo stretchy="false">(</mo>
            <mrow>
             <mn>2</mn>
             <msub>
              <mi>θ</mi>
              <mrow>
               <mi>x</mi>
               <mi>i</mi>
              </mrow>
             </msub>
             <msub>
              <mi>θ</mi>
              <mrow>
               <mi>y</mi>
               <mi>i</mi>
              </mrow>
             </msub>
            </mrow>
            <mo stretchy="false">)</mo>
           </mrow>
           <msubsup>
            <mi>θ</mi>
            <mi>E</mi>
            <mn>2</mn>
           </msubsup>
          </mrow>
          <msup>
           <mrow>
            <mo stretchy="false">(</mo>
            <mrow>
             <msubsup>
              <mi>θ</mi>
              <mrow>
               <mi>x</mi>
               <mi>i</mi>
              </mrow>
              <mn>2</mn>
             </msubsup>
             <mo>+</mo>
             <msubsup>
              <mi>θ</mi>
              <mrow>
               <mi>y</mi>
               <mi>i</mi>
              </mrow>
              <mn>2</mn>
             </msubsup>
            </mrow>
            <mo stretchy="false">)</mo>
           </mrow>
           <mn>2</mn>
          </msup>
         </mfrac>
        </mrow>
        <mo>)</mo>
       </mrow>
       <mn>2</mn>
      </msup>
     </mrow>
     <mo>]</mo>
    </mrow>
    <mrow>
     <mo>-</mo>
     <mn>1</mn>
    </mrow>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>A</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="latexml">delimited-[]</csymbol>
      <apply>
       <minus></minus>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <minus></minus>
         <cn type="integer">1</cn>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>κ</ci>
          <ci>smooth</ci>
         </apply>
        </apply>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <sum></sum>
          <ci>i</ci>
         </apply>
         <apply>
          <divide></divide>
          <apply>
           <times></times>
           <apply>
            <minus></minus>
            <apply>
             <csymbol cd="ambiguous">superscript</csymbol>
             <apply>
              <csymbol cd="ambiguous">subscript</csymbol>
              <ci>θ</ci>
              <apply>
               <times></times>
               <ci>x</ci>
               <ci>i</ci>
              </apply>
             </apply>
             <cn type="integer">2</cn>
            </apply>
            <apply>
             <csymbol cd="ambiguous">superscript</csymbol>
             <apply>
              <csymbol cd="ambiguous">subscript</csymbol>
              <ci>θ</ci>
              <apply>
               <times></times>
               <ci>y</ci>
               <ci>i</ci>
              </apply>
             </apply>
             <cn type="integer">2</cn>
            </apply>
           </apply>
           <apply>
            <csymbol cd="ambiguous">superscript</csymbol>
            <apply>
             <csymbol cd="ambiguous">subscript</csymbol>
             <ci>θ</ci>
             <ci>E</ci>
            </apply>
            <cn type="integer">2</cn>
           </apply>
          </apply>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <apply>
            <plus></plus>
            <apply>
             <csymbol cd="ambiguous">superscript</csymbol>
             <apply>
              <csymbol cd="ambiguous">subscript</csymbol>
              <ci>θ</ci>
              <apply>
               <times></times>
               <ci>x</ci>
               <ci>i</ci>
              </apply>
             </apply>
             <cn type="integer">2</cn>
            </apply>
            <apply>
             <csymbol cd="ambiguous">superscript</csymbol>
             <apply>
              <csymbol cd="ambiguous">subscript</csymbol>
              <ci>θ</ci>
              <apply>
               <times></times>
               <ci>y</ci>
               <ci>i</ci>
              </apply>
             </apply>
             <cn type="integer">2</cn>
            </apply>
           </apply>
           <cn type="integer">2</cn>
          </apply>
         </apply>
        </apply>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <sum></sum>
          <ci>i</ci>
         </apply>
         <apply>
          <divide></divide>
          <apply>
           <times></times>
           <apply>
            <times></times>
            <cn type="integer">2</cn>
            <apply>
             <csymbol cd="ambiguous">subscript</csymbol>
             <ci>θ</ci>
             <apply>
              <times></times>
              <ci>x</ci>
              <ci>i</ci>
             </apply>
            </apply>
            <apply>
             <csymbol cd="ambiguous">subscript</csymbol>
             <ci>θ</ci>
             <apply>
              <times></times>
              <ci>y</ci>
              <ci>i</ci>
             </apply>
            </apply>
           </apply>
           <apply>
            <csymbol cd="ambiguous">superscript</csymbol>
            <apply>
             <csymbol cd="ambiguous">subscript</csymbol>
             <ci>θ</ci>
             <ci>E</ci>
            </apply>
            <cn type="integer">2</cn>
           </apply>
          </apply>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <apply>
            <plus></plus>
            <apply>
             <csymbol cd="ambiguous">superscript</csymbol>
             <apply>
              <csymbol cd="ambiguous">subscript</csymbol>
              <ci>θ</ci>
              <apply>
               <times></times>
               <ci>x</ci>
               <ci>i</ci>
              </apply>
             </apply>
             <cn type="integer">2</cn>
            </apply>
            <apply>
             <csymbol cd="ambiguous">superscript</csymbol>
             <apply>
              <csymbol cd="ambiguous">subscript</csymbol>
              <ci>θ</ci>
              <apply>
               <times></times>
               <ci>y</ci>
               <ci>i</ci>
              </apply>
             </apply>
             <cn type="integer">2</cn>
            </apply>
           </apply>
           <cn type="integer">2</cn>
          </apply>
         </apply>
        </apply>
        <cn type="integer">2</cn>
       </apply>
      </apply>
     </apply>
     <apply>
      <minus></minus>
      <cn type="integer">1</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A=\left[(1-\kappa_{\rm smooth})^{2}-\left(\sum_{i}{(\theta_{xi}^{2}-\theta_{yi%
}^{2})\theta_{E}^{2}\over(\theta_{xi}^{2}+\theta_{yi}^{2})^{2}}\right)^{2}-%
\left(\sum_{i}{(2\theta_{xi}\theta_{yi})\theta_{E}^{2}\over(\theta_{xi}^{2}+%
\theta_{yi}^{2})^{2}}\right)^{2}\right]^{-1}
  </annotation>
 </semantics>
</math>

</p>

<p>This generally creates a network of critical curves, lines connecting image points of infinite amplification.</p>
<h2 id="general-weak-lensing">General weak lensing</h2>

<p>In <a href="Weak_gravitational_lensing#Cosmic_shear" title="wikilink">weak lensing by large-scale structure</a>, the thin-lens approximation may break down, and low-density extended structures may not be well approximated by multiple thin-lens planes. In this case, the deflection can be derived by instead assuming that the gravitational potential is slowly varying everywhere (for this reason, this approximation is not valid for strong lensing). This approach assumes the universe is well described by a Newtonian-perturbed <a href="FRW_metric" title="wikilink">FRW metric</a>, but it makes no other assumptions about the distribution of the lensing mass.</p>

<p>As in the thin-lens case, the effect can be written as a mapping from the unlensed angular position 

<math display="inline" id="Gravitational_lensing_formalism:78">
 <semantics>
  <mover accent="true">
   <mi>β</mi>
   <mo stretchy="false">→</mo>
  </mover>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-→</ci>
    <ci>β</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \vec{\beta}
  </annotation>
 </semantics>
</math>

 to the lensed position 

<math display="inline" id="Gravitational_lensing_formalism:79">
 <semantics>
  <mover accent="true">
   <mi>θ</mi>
   <mo stretchy="false">→</mo>
  </mover>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-→</ci>
    <ci>θ</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \vec{\theta}
  </annotation>
 </semantics>
</math>

. The <a href="Jacobian_matrix_and_determinant" title="wikilink">Jacobian</a> of the transform can be written as an integral over the gravitational potential 

<math display="inline" id="Gravitational_lensing_formalism:80">
 <semantics>
  <mpadded width="+3.3pt">
   <mi mathvariant="normal">Φ</mi>
  </mpadded>
  <annotation-xml encoding="MathML-Content">
   <ci>normal-Φ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Phi~{}
  </annotation>
 </semantics>
</math>

 along the line of sight <a class="footnoteRef" href="#fn3" id="fnref3"><sup>3</sup></a> 

<math display="inline" id="Gravitational_lensing_formalism:81">
 <semantics>
  <mrow>
   <mfrac>
    <mrow>
     <mo>∂</mo>
     <msub>
      <mi>β</mi>
      <mi>i</mi>
     </msub>
    </mrow>
    <mrow>
     <mo>∂</mo>
     <msub>
      <mi>θ</mi>
      <mi>j</mi>
     </msub>
    </mrow>
   </mfrac>
   <mo>=</mo>
   <mrow>
    <msub>
     <mi>δ</mi>
     <mrow>
      <mi>i</mi>
      <mi>j</mi>
     </mrow>
    </msub>
    <mo>+</mo>
    <mrow>
     <msubsup>
      <mo largeop="true" symmetric="true">∫</mo>
      <mn>0</mn>
      <msub>
       <mi>r</mi>
       <mi mathvariant="normal">∞</mi>
      </msub>
     </msubsup>
     <mrow>
      <mi>d</mi>
      <mi>r</mi>
      <mi>g</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>r</mi>
       <mo stretchy="false">)</mo>
      </mrow>
      <mfrac>
       <mrow>
        <mrow>
         <msup>
          <mo>∂</mo>
          <mn>2</mn>
         </msup>
         <mi mathvariant="normal">Φ</mi>
        </mrow>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <mover accent="true">
           <mi>x</mi>
           <mo stretchy="false">→</mo>
          </mover>
          <mrow>
           <mo stretchy="false">(</mo>
           <mi>r</mi>
           <mo stretchy="false">)</mo>
          </mrow>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
       <mrow>
        <mrow>
         <mo>∂</mo>
         <msup>
          <mi>x</mi>
          <mi>i</mi>
         </msup>
        </mrow>
        <mrow>
         <mo>∂</mo>
         <msup>
          <mi>x</mi>
          <mi>j</mi>
         </msup>
        </mrow>
       </mrow>
      </mfrac>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <divide></divide>
     <apply>
      <partialdiff></partialdiff>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>β</ci>
       <ci>i</ci>
      </apply>
     </apply>
     <apply>
      <partialdiff></partialdiff>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>θ</ci>
       <ci>j</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>δ</ci>
      <apply>
       <times></times>
       <ci>i</ci>
       <ci>j</ci>
      </apply>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <int></int>
        <cn type="integer">0</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>r</ci>
        <infinity></infinity>
       </apply>
      </apply>
      <apply>
       <times></times>
       <ci>d</ci>
       <ci>r</ci>
       <ci>g</ci>
       <ci>r</ci>
       <apply>
        <divide></divide>
        <apply>
         <times></times>
         <apply>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <partialdiff></partialdiff>
           <cn type="integer">2</cn>
          </apply>
          <ci>normal-Φ</ci>
         </apply>
         <apply>
          <times></times>
          <apply>
           <ci>normal-→</ci>
           <ci>x</ci>
          </apply>
          <ci>r</ci>
         </apply>
        </apply>
        <apply>
         <times></times>
         <apply>
          <partialdiff></partialdiff>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <ci>x</ci>
           <ci>i</ci>
          </apply>
         </apply>
         <apply>
          <partialdiff></partialdiff>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <ci>x</ci>
           <ci>j</ci>
          </apply>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \frac{\partial\beta_{i}}{\partial\theta_{j}}=\delta_{ij}+\int_{0}^{r_{\infty}}%
drg(r)\frac{\partial^{2}\Phi(\vec{x}(r))}{\partial x^{i}\partial x^{j}}
  </annotation>
 </semantics>
</math>

</p>

<p>where 

<math display="inline" id="Gravitational_lensing_formalism:82">
 <semantics>
  <mpadded width="+3.3pt">
   <mi>r</mi>
  </mpadded>
  <annotation-xml encoding="MathML-Content">
   <ci>r</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   r~{}
  </annotation>
 </semantics>
</math>


 is the <a href="comoving_distance" title="wikilink">comoving distance</a>, 

<math display="inline" id="Gravitational_lensing_formalism:83">
 <semantics>
  <mpadded width="+3.3pt">
   <msup>
    <mi>x</mi>
    <mi>i</mi>
   </msup>
  </mpadded>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>x</ci>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x^{i}~{}
  </annotation>
 </semantics>
</math>

 are the transverse distances, and</p>

<p>

<math display="inline" id="Gravitational_lensing_formalism:84">
 <semantics>
  <mrow>
   <mrow>
    <mi>g</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>r</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mn>2</mn>
    <mi>r</mi>
    <mrow>
     <msubsup>
      <mo largeop="true" symmetric="true">∫</mo>
      <mi>r</mi>
      <msub>
       <mi>r</mi>
       <mi mathvariant="normal">∞</mi>
      </msub>
     </msubsup>
     <mrow>
      <mrow>
       <mo>(</mo>
       <mrow>
        <mn>1</mn>
        <mo>-</mo>
        <mfrac>
         <msup>
          <mi>r</mi>
          <mo>′</mo>
         </msup>
         <mi>r</mi>
        </mfrac>
       </mrow>
       <mo>)</mo>
      </mrow>
      <mi>W</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <msup>
        <mi>r</mi>
        <mo>′</mo>
       </msup>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>g</ci>
     <ci>r</ci>
    </apply>
    <apply>
     <times></times>
     <cn type="integer">2</cn>
     <ci>r</ci>
     <apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <int></int>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>r</ci>
         <infinity></infinity>
        </apply>
       </apply>
       <ci>r</ci>
      </apply>
      <apply>
       <times></times>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
        <apply>
         <divide></divide>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>r</ci>
          <ci>normal-′</ci>
         </apply>
         <ci>r</ci>
        </apply>
       </apply>
       <ci>W</ci>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>r</ci>
        <ci>normal-′</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   g(r)=2r\int^{r_{\infty}}_{r}\left(1-\frac{r^{\prime}}{r}\right)W(r^{\prime})
  </annotation>
 </semantics>
</math>

</p>

<p>is the <em>lensing kernel</em>, which defines the efficiency of lensing for a distribution of sources 

<math display="inline" id="Gravitational_lensing_formalism:85">
 <semantics>
  <mrow>
   <mi>W</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>r</mi>
    <mo rspace="5.8pt" stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>W</ci>
    <ci>r</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   W(r)~{}
  </annotation>
 </semantics>
</math>

.</p>

<p>The Jacobian 

<math display="inline" id="Gravitational_lensing_formalism:86">
 <semantics>
  <mpadded width="+3.3pt">
   <msub>
    <mi>A</mi>
    <mrow>
     <mi>i</mi>
     <mi>j</mi>
    </mrow>
   </msub>
  </mpadded>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>A</ci>
    <apply>
     <times></times>
     <ci>i</ci>
     <ci>j</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A_{ij}~{}
  </annotation>
 </semantics>
</math>

 can be decomposed into convergence and shear terms just as with the thin-lens case, and in the limit of a lens that is both thin and weak, their physical interpretations are the same.</p>
<h2 id="weak-lensing-observables">Weak lensing observables</h2>

<p>In <a href="weak_gravitational_lensing" title="wikilink">weak gravitational lensing</a>, the <a href="Gravitational_Lensing_Formalism#Lensing_Jacobian" title="wikilink">Jacobian</a> is mapped out by observing the effect of the shear on the ellipticities of background galaxies. This effect is purely statistical; the shape of any galaxy will be dominated by its random, unlensed shape, but lensing will produce a spatially coherent distortion of these shapes.</p>
<h3 id="measures-of-ellipticity">Measures of ellipticity</h3>

<p>In most fields of astronomy, the ellipticity is defined as 

<math display="inline" id="Gravitational_lensing_formalism:87">
 <semantics>
  <mrow>
   <mn>1</mn>
   <mo>-</mo>
   <mpadded width="+3.3pt">
    <mi>q</mi>
   </mpadded>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <minus></minus>
    <cn type="integer">1</cn>
    <ci>q</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   1-q~{}
  </annotation>
 </semantics>
</math>

, where 

<math display="inline" id="Gravitational_lensing_formalism:88">
 <semantics>
  <mrow>
   <mi>q</mi>
   <mo>=</mo>
   <mfrac>
    <mi>b</mi>
    <mi>a</mi>
   </mfrac>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>q</ci>
    <apply>
     <divide></divide>
     <ci>b</ci>
     <ci>a</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   q=\frac{b}{a}
  </annotation>
 </semantics>
</math>

 is the axis ratio of the <a class="uri" href="ellipse" title="wikilink">ellipse</a>. In <a href="weak_gravitational_lensing" title="wikilink">weak gravitational lensing</a>, two different definitions are commonly used, and both are complex quantities which specify both the axis ratio and the position angle 

<math display="inline" id="Gravitational_lensing_formalism:89">
 <semantics>
  <mpadded width="+3.3pt">
   <mi>ϕ</mi>
  </mpadded>
  <annotation-xml encoding="MathML-Content">
   <ci>ϕ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \phi~{}
  </annotation>
 </semantics>
</math>

:</p>

<p>

<math display="inline" id="Gravitational_lensing_formalism:90">
 <semantics>
  <mrow>
   <mi>χ</mi>
   <mo>=</mo>
   <mrow>
    <mfrac>
     <mrow>
      <mn>1</mn>
      <mo>-</mo>
      <msup>
       <mi>q</mi>
       <mn>2</mn>
      </msup>
     </mrow>
     <mrow>
      <mn>1</mn>
      <mo>+</mo>
      <msup>
       <mi>q</mi>
       <mn>2</mn>
      </msup>
     </mrow>
    </mfrac>
    <msup>
     <mi>e</mi>
     <mrow>
      <mn>2</mn>
      <mi>i</mi>
      <mi>ϕ</mi>
     </mrow>
    </msup>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mfrac>
     <mrow>
      <msup>
       <mi>a</mi>
       <mn>2</mn>
      </msup>
      <mo>-</mo>
      <msup>
       <mi>b</mi>
       <mn>2</mn>
      </msup>
     </mrow>
     <mrow>
      <msup>
       <mi>a</mi>
       <mn>2</mn>
      </msup>
      <mo>+</mo>
      <msup>
       <mi>b</mi>
       <mn>2</mn>
      </msup>
     </mrow>
    </mfrac>
    <msup>
     <mi>e</mi>
     <mrow>
      <mn>2</mn>
      <mi>i</mi>
      <mi>ϕ</mi>
     </mrow>
    </msup>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <ci>χ</ci>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>q</ci>
         <cn type="integer">2</cn>
        </apply>
       </apply>
       <apply>
        <plus></plus>
        <cn type="integer">1</cn>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>q</ci>
         <cn type="integer">2</cn>
        </apply>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>e</ci>
       <apply>
        <times></times>
        <cn type="integer">2</cn>
        <ci>i</ci>
        <ci>ϕ</ci>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <apply>
        <minus></minus>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>a</ci>
         <cn type="integer">2</cn>
        </apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>b</ci>
         <cn type="integer">2</cn>
        </apply>
       </apply>
       <apply>
        <plus></plus>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>a</ci>
         <cn type="integer">2</cn>
        </apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>b</ci>
         <cn type="integer">2</cn>
        </apply>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>e</ci>
       <apply>
        <times></times>
        <cn type="integer">2</cn>
        <ci>i</ci>
        <ci>ϕ</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \chi=\frac{1-q^{2}}{1+q^{2}}e^{2i\phi}=\frac{a^{2}-b^{2}}{a^{2}+b^{2}}e^{2i\phi}
  </annotation>
 </semantics>
</math>

 

<math display="inline" id="Gravitational_lensing_formalism:91">
 <semantics>
  <mrow>
   <mi>ϵ</mi>
   <mo>=</mo>
   <mrow>
    <mfrac>
     <mrow>
      <mn>1</mn>
      <mo>-</mo>
      <mi>q</mi>
     </mrow>
     <mrow>
      <mn>1</mn>
      <mo>+</mo>
      <mi>q</mi>
     </mrow>
    </mfrac>
    <msup>
     <mi>e</mi>
     <mrow>
      <mn>2</mn>
      <mi>i</mi>
      <mi>ϕ</mi>
     </mrow>
    </msup>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mfrac>
     <mrow>
      <mi>a</mi>
      <mo>-</mo>
      <mi>b</mi>
     </mrow>
     <mrow>
      <mi>a</mi>
      <mo>+</mo>
      <mi>b</mi>
     </mrow>
    </mfrac>
    <msup>
     <mi>e</mi>
     <mrow>
      <mn>2</mn>
      <mi>i</mi>
      <mi>ϕ</mi>
     </mrow>
    </msup>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <ci>ϵ</ci>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
        <ci>q</ci>
       </apply>
       <apply>
        <plus></plus>
        <cn type="integer">1</cn>
        <ci>q</ci>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>e</ci>
       <apply>
        <times></times>
        <cn type="integer">2</cn>
        <ci>i</ci>
        <ci>ϕ</ci>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <apply>
        <minus></minus>
        <ci>a</ci>
        <ci>b</ci>
       </apply>
       <apply>
        <plus></plus>
        <ci>a</ci>
        <ci>b</ci>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>e</ci>
       <apply>
        <times></times>
        <cn type="integer">2</cn>
        <ci>i</ci>
        <ci>ϕ</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \epsilon=\frac{1-q}{1+q}e^{2i\phi}=\frac{a-b}{a+b}e^{2i\phi}
  </annotation>
 </semantics>
</math>

</p>

<p>Like the traditional ellipticity, the magnitudes of both of these quantities range from 0 (circular) to 1 (a line segment). The position angle is encoded in the complex phase, but because of the factor of 2 in the trigonometric arguments, ellipticity is invariant under a rotation of 180 degrees. This is to be expected; an ellipse is unchanged by a 180° rotation. Taken as imaginary and real parts, the real part of the complex ellipticity describes the elongation along the coordinate axes, while the imaginary part describes the elongation at 45° from the axes.</p>

<p>The ellipticity is often written as a two-component vector instead of a complex number, though it is not a true <a href="Coordinate_vector" title="wikilink">vector</a> with regard to transforms:</p>

<p>

<math display="inline" id="Gravitational_lensing_formalism:92">
 <semantics>
  <mrow>
   <mi>χ</mi>
   <mo>=</mo>
   <mrow>
    <mo stretchy="false">{</mo>
    <mrow>
     <mrow>
      <mo>|</mo>
      <mi>χ</mi>
      <mo>|</mo>
     </mrow>
     <mrow>
      <mi>cos</mi>
      <mrow>
       <mn>2</mn>
       <mi>ϕ</mi>
      </mrow>
     </mrow>
    </mrow>
    <mo>,</mo>
    <mrow>
     <mrow>
      <mo>|</mo>
      <mi>χ</mi>
      <mo>|</mo>
     </mrow>
     <mrow>
      <mi>sin</mi>
      <mrow>
       <mn>2</mn>
       <mi>ϕ</mi>
      </mrow>
     </mrow>
    </mrow>
    <mo stretchy="false">}</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>χ</ci>
    <set>
     <apply>
      <times></times>
      <apply>
       <abs></abs>
       <ci>χ</ci>
      </apply>
      <apply>
       <cos></cos>
       <apply>
        <times></times>
        <cn type="integer">2</cn>
        <ci>ϕ</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <abs></abs>
       <ci>χ</ci>
      </apply>
      <apply>
       <sin></sin>
       <apply>
        <times></times>
        <cn type="integer">2</cn>
        <ci>ϕ</ci>
       </apply>
      </apply>
     </apply>
    </set>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \chi=\{\left|\chi\right|\cos 2\phi,\left|\chi\right|\sin 2\phi\}
  </annotation>
 </semantics>
</math>

 

<math display="inline" id="Gravitational_lensing_formalism:93">
 <semantics>
  <mrow>
   <mi>ϵ</mi>
   <mo>=</mo>
   <mrow>
    <mo stretchy="false">{</mo>
    <mrow>
     <mrow>
      <mo>|</mo>
      <mi>ϵ</mi>
      <mo>|</mo>
     </mrow>
     <mrow>
      <mi>cos</mi>
      <mrow>
       <mn>2</mn>
       <mi>ϕ</mi>
      </mrow>
     </mrow>
    </mrow>
    <mo>,</mo>
    <mrow>
     <mrow>
      <mo>|</mo>
      <mi>ϵ</mi>
      <mo>|</mo>
     </mrow>
     <mrow>
      <mi>sin</mi>
      <mrow>
       <mn>2</mn>
       <mi>ϕ</mi>
      </mrow>
     </mrow>
    </mrow>
    <mo stretchy="false">}</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>ϵ</ci>
    <set>
     <apply>
      <times></times>
      <apply>
       <abs></abs>
       <ci>ϵ</ci>
      </apply>
      <apply>
       <cos></cos>
       <apply>
        <times></times>
        <cn type="integer">2</cn>
        <ci>ϕ</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <abs></abs>
       <ci>ϵ</ci>
      </apply>
      <apply>
       <sin></sin>
       <apply>
        <times></times>
        <cn type="integer">2</cn>
        <ci>ϕ</ci>
       </apply>
      </apply>
     </apply>
    </set>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \epsilon=\{\left|\epsilon\right|\cos 2\phi,\left|\epsilon\right|\sin 2\phi\}
  </annotation>
 </semantics>
</math>

</p>

<p>Real astronomical background sources are not perfect ellipses. Their ellipticities can be measured by finding a best-fit elliptical model to the data, or by measuring the second moments of the image about some <a class="uri" href="centroid" title="wikilink">centroid</a> 

<math display="inline" id="Gravitational_lensing_formalism:94">
 <semantics>
  <mrow>
   <mo stretchy="false">(</mo>
   <mover accent="true">
    <mi>x</mi>
    <mo stretchy="false">¯</mo>
   </mover>
   <mo>,</mo>
   <mover accent="true">
    <mi>y</mi>
    <mo stretchy="false">¯</mo>
   </mover>
   <mo stretchy="false">)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <interval closure="open">
    <apply>
     <ci>normal-¯</ci>
     <ci>x</ci>
    </apply>
    <apply>
     <ci>normal-¯</ci>
     <ci>y</ci>
    </apply>
   </interval>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (\bar{x},\bar{y})
  </annotation>
 </semantics>
</math>

 

<math display="inline" id="Gravitational_lensing_formalism:95">
 <semantics>
  <mrow>
   <msub>
    <mi>q</mi>
    <mrow>
     <mi>x</mi>
     <mi>x</mi>
    </mrow>
   </msub>
   <mo>=</mo>
   <mfrac>
    <mstyle scriptlevel="-1">
     <mrow>
      <mo largeop="true" symmetric="true">∑</mo>
      <mrow>
       <msup>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <mi>x</mi>
          <mo>-</mo>
          <mover accent="true">
           <mi>x</mi>
           <mo stretchy="false">¯</mo>
          </mover>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
        <mn>2</mn>
       </msup>
       <mi>I</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>x</mi>
        <mo>,</mo>
        <mi>y</mi>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
     </mrow>
    </mstyle>
    <mstyle scriptlevel="-1">
     <mrow>
      <mo largeop="true" symmetric="true">∑</mo>
      <mrow>
       <mi>I</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>x</mi>
        <mo>,</mo>
        <mi>y</mi>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
     </mrow>
    </mstyle>
   </mfrac>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>q</ci>
     <apply>
      <times></times>
      <ci>x</ci>
      <ci>x</ci>
     </apply>
    </apply>
    <apply>
     <divide></divide>
     <apply>
      <sum></sum>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <minus></minus>
         <ci>x</ci>
         <apply>
          <ci>normal-¯</ci>
          <ci>x</ci>
         </apply>
        </apply>
        <cn type="integer">2</cn>
       </apply>
       <ci>I</ci>
       <interval closure="open">
        <ci>x</ci>
        <ci>y</ci>
       </interval>
      </apply>
     </apply>
     <apply>
      <sum></sum>
      <apply>
       <times></times>
       <ci>I</ci>
       <interval closure="open">
        <ci>x</ci>
        <ci>y</ci>
       </interval>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   q_{xx}=\frac{\sum(x-\bar{x})^{2}I(x,y)}{\sum I(x,y)}
  </annotation>
 </semantics>
</math>

 

<math display="inline" id="Gravitational_lensing_formalism:96">
 <semantics>
  <mrow>
   <msub>
    <mi>q</mi>
    <mrow>
     <mi>y</mi>
     <mi>y</mi>
    </mrow>
   </msub>
   <mo>=</mo>
   <mfrac>
    <mstyle scriptlevel="-1">
     <mrow>
      <mo largeop="true" symmetric="true">∑</mo>
      <mrow>
       <msup>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <mi>y</mi>
          <mo>-</mo>
          <mover accent="true">
           <mi>y</mi>
           <mo stretchy="false">¯</mo>
          </mover>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
        <mn>2</mn>
       </msup>
       <mi>I</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>x</mi>
        <mo>,</mo>
        <mi>y</mi>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
     </mrow>
    </mstyle>
    <mstyle scriptlevel="-1">
     <mrow>
      <mo largeop="true" symmetric="true">∑</mo>
      <mrow>
       <mi>I</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>x</mi>
        <mo>,</mo>
        <mi>y</mi>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
     </mrow>
    </mstyle>
   </mfrac>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>q</ci>
     <apply>
      <times></times>
      <ci>y</ci>
      <ci>y</ci>
     </apply>
    </apply>
    <apply>
     <divide></divide>
     <apply>
      <sum></sum>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <minus></minus>
         <ci>y</ci>
         <apply>
          <ci>normal-¯</ci>
          <ci>y</ci>
         </apply>
        </apply>
        <cn type="integer">2</cn>
       </apply>
       <ci>I</ci>
       <interval closure="open">
        <ci>x</ci>
        <ci>y</ci>
       </interval>
      </apply>
     </apply>
     <apply>
      <sum></sum>
      <apply>
       <times></times>
       <ci>I</ci>
       <interval closure="open">
        <ci>x</ci>
        <ci>y</ci>
       </interval>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   q_{yy}=\frac{\sum(y-\bar{y})^{2}I(x,y)}{\sum I(x,y)}
  </annotation>
 </semantics>
</math>

 

<math display="inline" id="Gravitational_lensing_formalism:97">
 <semantics>
  <mrow>
   <msub>
    <mi>q</mi>
    <mrow>
     <mi>x</mi>
     <mi>y</mi>
    </mrow>
   </msub>
   <mo>=</mo>
   <mfrac>
    <mstyle scriptlevel="-1">
     <mrow>
      <mo largeop="true" symmetric="true">∑</mo>
      <mrow>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mi>x</mi>
         <mo>-</mo>
         <mover accent="true">
          <mi>x</mi>
          <mo stretchy="false">¯</mo>
         </mover>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mi>y</mi>
         <mo>-</mo>
         <mover accent="true">
          <mi>y</mi>
          <mo stretchy="false">¯</mo>
         </mover>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
       <mi>I</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>x</mi>
        <mo>,</mo>
        <mi>y</mi>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
     </mrow>
    </mstyle>
    <mstyle scriptlevel="-1">
     <mrow>
      <mo largeop="true" symmetric="true">∑</mo>
      <mrow>
       <mi>I</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>x</mi>
        <mo>,</mo>
        <mi>y</mi>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
     </mrow>
    </mstyle>
   </mfrac>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>q</ci>
     <apply>
      <times></times>
      <ci>x</ci>
      <ci>y</ci>
     </apply>
    </apply>
    <apply>
     <divide></divide>
     <apply>
      <sum></sum>
      <apply>
       <times></times>
       <apply>
        <minus></minus>
        <ci>x</ci>
        <apply>
         <ci>normal-¯</ci>
         <ci>x</ci>
        </apply>
       </apply>
       <apply>
        <minus></minus>
        <ci>y</ci>
        <apply>
         <ci>normal-¯</ci>
         <ci>y</ci>
        </apply>
       </apply>
       <ci>I</ci>
       <interval closure="open">
        <ci>x</ci>
        <ci>y</ci>
       </interval>
      </apply>
     </apply>
     <apply>
      <sum></sum>
      <apply>
       <times></times>
       <ci>I</ci>
       <interval closure="open">
        <ci>x</ci>
        <ci>y</ci>
       </interval>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   q_{xy}=\frac{\sum(x-\bar{x})(y-\bar{y})I(x,y)}{\sum I(x,y)}
  </annotation>
 </semantics>
</math>

</p>

<p>The complex ellipticities are then</p>

<p>

<math display="inline" id="Gravitational_lensing_formalism:98">
 <semantics>
  <mrow>
   <mi>χ</mi>
   <mo>=</mo>
   <mfrac>
    <mrow>
     <mrow>
      <msub>
       <mi>q</mi>
       <mrow>
        <mi>x</mi>
        <mi>x</mi>
       </mrow>
      </msub>
      <mo>-</mo>
      <msub>
       <mi>q</mi>
       <mrow>
        <mi>y</mi>
        <mi>y</mi>
       </mrow>
      </msub>
     </mrow>
     <mo>+</mo>
     <mrow>
      <mn>2</mn>
      <mi>i</mi>
      <msub>
       <mi>q</mi>
       <mrow>
        <mi>x</mi>
        <mi>y</mi>
       </mrow>
      </msub>
     </mrow>
    </mrow>
    <mrow>
     <msub>
      <mi>q</mi>
      <mrow>
       <mi>x</mi>
       <mi>x</mi>
      </mrow>
     </msub>
     <mo>+</mo>
     <msub>
      <mi>q</mi>
      <mrow>
       <mi>y</mi>
       <mi>y</mi>
      </mrow>
     </msub>
    </mrow>
   </mfrac>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>χ</ci>
    <apply>
     <divide></divide>
     <apply>
      <plus></plus>
      <apply>
       <minus></minus>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>q</ci>
        <apply>
         <times></times>
         <ci>x</ci>
         <ci>x</ci>
        </apply>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>q</ci>
        <apply>
         <times></times>
         <ci>y</ci>
         <ci>y</ci>
        </apply>
       </apply>
      </apply>
      <apply>
       <times></times>
       <cn type="integer">2</cn>
       <ci>i</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>q</ci>
        <apply>
         <times></times>
         <ci>x</ci>
         <ci>y</ci>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <plus></plus>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>q</ci>
       <apply>
        <times></times>
        <ci>x</ci>
        <ci>x</ci>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>q</ci>
       <apply>
        <times></times>
        <ci>y</ci>
        <ci>y</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \chi=\frac{q_{xx}-q_{yy}+2iq_{xy}}{q_{xx}+q_{yy}}
  </annotation>
 </semantics>
</math>

 

<math display="inline" id="Gravitational_lensing_formalism:99">
 <semantics>
  <mrow>
   <mi>ϵ</mi>
   <mo>=</mo>
   <mfrac>
    <mrow>
     <mrow>
      <msub>
       <mi>q</mi>
       <mrow>
        <mi>x</mi>
        <mi>x</mi>
       </mrow>
      </msub>
      <mo>-</mo>
      <msub>
       <mi>q</mi>
       <mrow>
        <mi>y</mi>
        <mi>y</mi>
       </mrow>
      </msub>
     </mrow>
     <mo>+</mo>
     <mrow>
      <mn>2</mn>
      <mi>i</mi>
      <msub>
       <mi>q</mi>
       <mrow>
        <mi>x</mi>
        <mi>y</mi>
       </mrow>
      </msub>
     </mrow>
    </mrow>
    <mrow>
     <msub>
      <mi>q</mi>
      <mrow>
       <mi>x</mi>
       <mi>x</mi>
      </mrow>
     </msub>
     <mo>+</mo>
     <msub>
      <mi>q</mi>
      <mrow>
       <mi>y</mi>
       <mi>y</mi>
      </mrow>
     </msub>
     <mo>+</mo>
     <mrow>
      <mn>2</mn>
      <msqrt>
       <mrow>
        <mrow>
         <msub>
          <mi>q</mi>
          <mrow>
           <mi>x</mi>
           <mi>x</mi>
          </mrow>
         </msub>
         <msub>
          <mi>q</mi>
          <mrow>
           <mi>y</mi>
           <mi>y</mi>
          </mrow>
         </msub>
        </mrow>
        <mo>-</mo>
        <msubsup>
         <mi>q</mi>
         <mrow>
          <mi>x</mi>
          <mi>y</mi>
         </mrow>
         <mn>2</mn>
        </msubsup>
       </mrow>
      </msqrt>
     </mrow>
    </mrow>
   </mfrac>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>ϵ</ci>
    <apply>
     <divide></divide>
     <apply>
      <plus></plus>
      <apply>
       <minus></minus>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>q</ci>
        <apply>
         <times></times>
         <ci>x</ci>
         <ci>x</ci>
        </apply>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>q</ci>
        <apply>
         <times></times>
         <ci>y</ci>
         <ci>y</ci>
        </apply>
       </apply>
      </apply>
      <apply>
       <times></times>
       <cn type="integer">2</cn>
       <ci>i</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>q</ci>
        <apply>
         <times></times>
         <ci>x</ci>
         <ci>y</ci>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <plus></plus>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>q</ci>
       <apply>
        <times></times>
        <ci>x</ci>
        <ci>x</ci>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>q</ci>
       <apply>
        <times></times>
        <ci>y</ci>
        <ci>y</ci>
       </apply>
      </apply>
      <apply>
       <times></times>
       <cn type="integer">2</cn>
       <apply>
        <root></root>
        <apply>
         <minus></minus>
         <apply>
          <times></times>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>q</ci>
           <apply>
            <times></times>
            <ci>x</ci>
            <ci>x</ci>
           </apply>
          </apply>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>q</ci>
           <apply>
            <times></times>
            <ci>y</ci>
            <ci>y</ci>
           </apply>
          </apply>
         </apply>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>q</ci>
           <apply>
            <times></times>
            <ci>x</ci>
            <ci>y</ci>
           </apply>
          </apply>
          <cn type="integer">2</cn>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \epsilon=\frac{q_{xx}-q_{yy}+2iq_{xy}}{q_{xx}+q_{yy}+2\sqrt{q_{xx}q_{yy}-q_{xy%
}^{2}}}
  </annotation>
 </semantics>
</math>

</p>

<p>This can be used to relate the second moments to traditional ellipse parameters:</p>

<p>

<math display="inline" id="Gravitational_lensing_formalism:100">
 <semantics>
  <mrow>
   <msub>
    <mi>q</mi>
    <mrow>
     <mi>x</mi>
     <mi>x</mi>
    </mrow>
   </msub>
   <mo>=</mo>
   <mrow>
    <mrow>
     <msup>
      <mi>a</mi>
      <mn>2</mn>
     </msup>
     <mrow>
      <msup>
       <mi>cos</mi>
       <mn>2</mn>
      </msup>
      <mi>θ</mi>
     </mrow>
    </mrow>
    <mo>+</mo>
    <mrow>
     <msup>
      <mi>b</mi>
      <mn>2</mn>
     </msup>
     <mrow>
      <msup>
       <mi>sin</mi>
       <mn>2</mn>
      </msup>
      <mpadded width="+1.7pt">
       <mi>θ</mi>
      </mpadded>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>q</ci>
     <apply>
      <times></times>
      <ci>x</ci>
      <ci>x</ci>
     </apply>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>a</ci>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <cos></cos>
        <cn type="integer">2</cn>
       </apply>
       <ci>θ</ci>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>b</ci>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <sin></sin>
        <cn type="integer">2</cn>
       </apply>
       <ci>θ</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   q_{xx}=a^{2}\cos^{2}\theta+b^{2}\sin^{2}\theta\,
  </annotation>
 </semantics>
</math>

 

<math display="inline" id="Gravitational_lensing_formalism:101">
 <semantics>
  <mrow>
   <msub>
    <mi>q</mi>
    <mrow>
     <mi>y</mi>
     <mi>y</mi>
    </mrow>
   </msub>
   <mo>=</mo>
   <mrow>
    <mrow>
     <msup>
      <mi>a</mi>
      <mn>2</mn>
     </msup>
     <mrow>
      <msup>
       <mi>sin</mi>
       <mn>2</mn>
      </msup>
      <mi>θ</mi>
     </mrow>
    </mrow>
    <mo>+</mo>
    <mrow>
     <msup>
      <mi>b</mi>
      <mn>2</mn>
     </msup>
     <mrow>
      <msup>
       <mi>cos</mi>
       <mn>2</mn>
      </msup>
      <mpadded width="+1.7pt">
       <mi>θ</mi>
      </mpadded>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>q</ci>
     <apply>
      <times></times>
      <ci>y</ci>
      <ci>y</ci>
     </apply>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>a</ci>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <sin></sin>
        <cn type="integer">2</cn>
       </apply>
       <ci>θ</ci>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>b</ci>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <cos></cos>
        <cn type="integer">2</cn>
       </apply>
       <ci>θ</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   q_{yy}=a^{2}\sin^{2}\theta+b^{2}\cos^{2}\theta\,
  </annotation>
 </semantics>
</math>

 

<math display="inline" id="Gravitational_lensing_formalism:102">
 <semantics>
  <mrow>
   <msub>
    <mi>q</mi>
    <mrow>
     <mi>x</mi>
     <mi>y</mi>
    </mrow>
   </msub>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <msup>
       <mi>a</mi>
       <mn>2</mn>
      </msup>
      <mo>-</mo>
      <msup>
       <mi>b</mi>
       <mn>2</mn>
      </msup>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
    <mrow>
     <mi>sin</mi>
     <mi>θ</mi>
    </mrow>
    <mrow>
     <mi>cos</mi>
     <mpadded width="+1.7pt">
      <mi>θ</mi>
     </mpadded>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>q</ci>
     <apply>
      <times></times>
      <ci>x</ci>
      <ci>y</ci>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <minus></minus>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>a</ci>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>b</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
     <apply>
      <sin></sin>
      <ci>θ</ci>
     </apply>
     <apply>
      <cos></cos>
      <ci>θ</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   q_{xy}=(a^{2}-b^{2})\sin\theta\cos\theta\,
  </annotation>
 </semantics>
</math>

</p>

<p>and in reverse:</p>

<p>

<math display="inline" id="Gravitational_lensing_formalism:103">
 <semantics>
  <mrow>
   <msup>
    <mi>a</mi>
    <mn>2</mn>
   </msup>
   <mo>=</mo>
   <mfrac>
    <mrow>
     <msub>
      <mi>q</mi>
      <mrow>
       <mi>x</mi>
       <mi>x</mi>
      </mrow>
     </msub>
     <mo>+</mo>
     <msub>
      <mi>q</mi>
      <mrow>
       <mi>y</mi>
       <mi>y</mi>
      </mrow>
     </msub>
     <mo>+</mo>
     <msqrt>
      <mrow>
       <msup>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <msub>
           <mi>q</mi>
           <mrow>
            <mi>x</mi>
            <mi>x</mi>
           </mrow>
          </msub>
          <mo>-</mo>
          <msub>
           <mi>q</mi>
           <mrow>
            <mi>y</mi>
            <mi>y</mi>
           </mrow>
          </msub>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
        <mn>2</mn>
       </msup>
       <mo>+</mo>
       <mrow>
        <mn>4</mn>
        <msubsup>
         <mi>q</mi>
         <mrow>
          <mi>x</mi>
          <mi>y</mi>
         </mrow>
         <mn>2</mn>
        </msubsup>
       </mrow>
      </mrow>
     </msqrt>
    </mrow>
    <mn>2</mn>
   </mfrac>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>a</ci>
     <cn type="integer">2</cn>
    </apply>
    <apply>
     <divide></divide>
     <apply>
      <plus></plus>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>q</ci>
       <apply>
        <times></times>
        <ci>x</ci>
        <ci>x</ci>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>q</ci>
       <apply>
        <times></times>
        <ci>y</ci>
        <ci>y</ci>
       </apply>
      </apply>
      <apply>
       <root></root>
       <apply>
        <plus></plus>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <minus></minus>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>q</ci>
           <apply>
            <times></times>
            <ci>x</ci>
            <ci>x</ci>
           </apply>
          </apply>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>q</ci>
           <apply>
            <times></times>
            <ci>y</ci>
            <ci>y</ci>
           </apply>
          </apply>
         </apply>
         <cn type="integer">2</cn>
        </apply>
        <apply>
         <times></times>
         <cn type="integer">4</cn>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>q</ci>
           <apply>
            <times></times>
            <ci>x</ci>
            <ci>y</ci>
           </apply>
          </apply>
          <cn type="integer">2</cn>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
     <cn type="integer">2</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a^{2}=\frac{q_{xx}+q_{yy}+\sqrt{(q_{xx}-q_{yy})^{2}+4q_{xy}^{2}}}{2}
  </annotation>
 </semantics>
</math>

 

<math display="inline" id="Gravitational_lensing_formalism:104">
 <semantics>
  <mrow>
   <msup>
    <mi>b</mi>
    <mn>2</mn>
   </msup>
   <mo>=</mo>
   <mfrac>
    <mrow>
     <mrow>
      <msub>
       <mi>q</mi>
       <mrow>
        <mi>x</mi>
        <mi>x</mi>
       </mrow>
      </msub>
      <mo>+</mo>
      <msub>
       <mi>q</mi>
       <mrow>
        <mi>y</mi>
        <mi>y</mi>
       </mrow>
      </msub>
     </mrow>
     <mo>-</mo>
     <msqrt>
      <mrow>
       <msup>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <msub>
           <mi>q</mi>
           <mrow>
            <mi>x</mi>
            <mi>x</mi>
           </mrow>
          </msub>
          <mo>-</mo>
          <msub>
           <mi>q</mi>
           <mrow>
            <mi>y</mi>
            <mi>y</mi>
           </mrow>
          </msub>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
        <mn>2</mn>
       </msup>
       <mo>+</mo>
       <mrow>
        <mn>4</mn>
        <msubsup>
         <mi>q</mi>
         <mrow>
          <mi>x</mi>
          <mi>y</mi>
         </mrow>
         <mn>2</mn>
        </msubsup>
       </mrow>
      </mrow>
     </msqrt>
    </mrow>
    <mn>2</mn>
   </mfrac>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>b</ci>
     <cn type="integer">2</cn>
    </apply>
    <apply>
     <divide></divide>
     <apply>
      <minus></minus>
      <apply>
       <plus></plus>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>q</ci>
        <apply>
         <times></times>
         <ci>x</ci>
         <ci>x</ci>
        </apply>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>q</ci>
        <apply>
         <times></times>
         <ci>y</ci>
         <ci>y</ci>
        </apply>
       </apply>
      </apply>
      <apply>
       <root></root>
       <apply>
        <plus></plus>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <minus></minus>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>q</ci>
           <apply>
            <times></times>
            <ci>x</ci>
            <ci>x</ci>
           </apply>
          </apply>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>q</ci>
           <apply>
            <times></times>
            <ci>y</ci>
            <ci>y</ci>
           </apply>
          </apply>
         </apply>
         <cn type="integer">2</cn>
        </apply>
        <apply>
         <times></times>
         <cn type="integer">4</cn>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>q</ci>
           <apply>
            <times></times>
            <ci>x</ci>
            <ci>y</ci>
           </apply>
          </apply>
          <cn type="integer">2</cn>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
     <cn type="integer">2</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   b^{2}=\frac{q_{xx}+q_{yy}-\sqrt{(q_{xx}-q_{yy})^{2}+4q_{xy}^{2}}}{2}
  </annotation>
 </semantics>
</math>

 

<math display="inline" id="Gravitational_lensing_formalism:105">
 <semantics>
  <mrow>
   <mrow>
    <mi>tan</mi>
    <mrow>
     <mn>2</mn>
     <mi>θ</mi>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mfrac>
    <mrow>
     <mn>2</mn>
     <msub>
      <mi>q</mi>
      <mrow>
       <mi>x</mi>
       <mi>y</mi>
      </mrow>
     </msub>
    </mrow>
    <mrow>
     <msub>
      <mi>q</mi>
      <mrow>
       <mi>x</mi>
       <mi>x</mi>
      </mrow>
     </msub>
     <mo>-</mo>
     <msub>
      <mi>q</mi>
      <mrow>
       <mi>y</mi>
       <mi>y</mi>
      </mrow>
     </msub>
    </mrow>
   </mfrac>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <tan></tan>
     <apply>
      <times></times>
      <cn type="integer">2</cn>
      <ci>θ</ci>
     </apply>
    </apply>
    <apply>
     <divide></divide>
     <apply>
      <times></times>
      <cn type="integer">2</cn>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>q</ci>
       <apply>
        <times></times>
        <ci>x</ci>
        <ci>y</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <minus></minus>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>q</ci>
       <apply>
        <times></times>
        <ci>x</ci>
        <ci>x</ci>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>q</ci>
       <apply>
        <times></times>
        <ci>y</ci>
        <ci>y</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \tan 2\theta=\frac{2q_{xy}}{q_{xx}-q_{yy}}
  </annotation>
 </semantics>
</math>

</p>

<p>The unweighted second moments above are problematic in the presence of noise, neighboring objects, or extended galaxy profiles, so it is typical to use <a href="apodization" title="wikilink">apodized</a> moments instead:</p>

<p>

<math display="inline" id="Gravitational_lensing_formalism:106">
 <semantics>
  <mrow>
   <msub>
    <mi>q</mi>
    <mrow>
     <mi>x</mi>
     <mi>x</mi>
    </mrow>
   </msub>
   <mo>=</mo>
   <mfrac>
    <mstyle scriptlevel="-1">
     <mrow>
      <mo largeop="true" symmetric="true">∑</mo>
      <mrow>
       <msup>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <mi>x</mi>
          <mo>-</mo>
          <mover accent="true">
           <mi>x</mi>
           <mo stretchy="false">¯</mo>
          </mover>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
        <mn>2</mn>
       </msup>
       <mi>w</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mi>x</mi>
         <mo>-</mo>
         <mover accent="true">
          <mi>x</mi>
          <mo stretchy="false">¯</mo>
         </mover>
        </mrow>
        <mo>,</mo>
        <mrow>
         <mi>y</mi>
         <mo>-</mo>
         <mover accent="true">
          <mi>y</mi>
          <mo stretchy="false">¯</mo>
         </mover>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
       <mi>I</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>x</mi>
        <mo>,</mo>
        <mi>y</mi>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
     </mrow>
    </mstyle>
    <mstyle scriptlevel="-1">
     <mrow>
      <mo largeop="true" symmetric="true">∑</mo>
      <mrow>
       <mi>w</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mi>x</mi>
         <mo>-</mo>
         <mover accent="true">
          <mi>x</mi>
          <mo stretchy="false">¯</mo>
         </mover>
        </mrow>
        <mo>,</mo>
        <mrow>
         <mi>y</mi>
         <mo>-</mo>
         <mover accent="true">
          <mi>y</mi>
          <mo stretchy="false">¯</mo>
         </mover>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
       <mi>I</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>x</mi>
        <mo>,</mo>
        <mi>y</mi>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
     </mrow>
    </mstyle>
   </mfrac>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>q</ci>
     <apply>
      <times></times>
      <ci>x</ci>
      <ci>x</ci>
     </apply>
    </apply>
    <apply>
     <divide></divide>
     <apply>
      <sum></sum>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <minus></minus>
         <ci>x</ci>
         <apply>
          <ci>normal-¯</ci>
          <ci>x</ci>
         </apply>
        </apply>
        <cn type="integer">2</cn>
       </apply>
       <ci>w</ci>
       <interval closure="open">
        <apply>
         <minus></minus>
         <ci>x</ci>
         <apply>
          <ci>normal-¯</ci>
          <ci>x</ci>
         </apply>
        </apply>
        <apply>
         <minus></minus>
         <ci>y</ci>
         <apply>
          <ci>normal-¯</ci>
          <ci>y</ci>
         </apply>
        </apply>
       </interval>
       <ci>I</ci>
       <interval closure="open">
        <ci>x</ci>
        <ci>y</ci>
       </interval>
      </apply>
     </apply>
     <apply>
      <sum></sum>
      <apply>
       <times></times>
       <ci>w</ci>
       <interval closure="open">
        <apply>
         <minus></minus>
         <ci>x</ci>
         <apply>
          <ci>normal-¯</ci>
          <ci>x</ci>
         </apply>
        </apply>
        <apply>
         <minus></minus>
         <ci>y</ci>
         <apply>
          <ci>normal-¯</ci>
          <ci>y</ci>
         </apply>
        </apply>
       </interval>
       <ci>I</ci>
       <interval closure="open">
        <ci>x</ci>
        <ci>y</ci>
       </interval>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   q_{xx}=\frac{\sum(x-\bar{x})^{2}w(x-\bar{x},y-\bar{y})I(x,y)}{\sum w(x-\bar{x}%
,y-\bar{y})I(x,y)}
  </annotation>
 </semantics>
</math>

 

<math display="inline" id="Gravitational_lensing_formalism:107">
 <semantics>
  <mrow>
   <msub>
    <mi>q</mi>
    <mrow>
     <mi>y</mi>
     <mi>y</mi>
    </mrow>
   </msub>
   <mo>=</mo>
   <mfrac>
    <mstyle scriptlevel="-1">
     <mrow>
      <mo largeop="true" symmetric="true">∑</mo>
      <mrow>
       <msup>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <mi>y</mi>
          <mo>-</mo>
          <mover accent="true">
           <mi>y</mi>
           <mo stretchy="false">¯</mo>
          </mover>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
        <mn>2</mn>
       </msup>
       <mi>w</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mi>x</mi>
         <mo>-</mo>
         <mover accent="true">
          <mi>x</mi>
          <mo stretchy="false">¯</mo>
         </mover>
        </mrow>
        <mo>,</mo>
        <mrow>
         <mi>y</mi>
         <mo>-</mo>
         <mover accent="true">
          <mi>y</mi>
          <mo stretchy="false">¯</mo>
         </mover>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
       <mi>I</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>x</mi>
        <mo>,</mo>
        <mi>y</mi>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
     </mrow>
    </mstyle>
    <mstyle scriptlevel="-1">
     <mrow>
      <mo largeop="true" symmetric="true">∑</mo>
      <mrow>
       <mi>w</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mi>x</mi>
         <mo>-</mo>
         <mover accent="true">
          <mi>x</mi>
          <mo stretchy="false">¯</mo>
         </mover>
        </mrow>
        <mo>,</mo>
        <mrow>
         <mi>y</mi>
         <mo>-</mo>
         <mover accent="true">
          <mi>y</mi>
          <mo stretchy="false">¯</mo>
         </mover>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
       <mi>I</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>x</mi>
        <mo>,</mo>
        <mi>y</mi>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
     </mrow>
    </mstyle>
   </mfrac>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>q</ci>
     <apply>
      <times></times>
      <ci>y</ci>
      <ci>y</ci>
     </apply>
    </apply>
    <apply>
     <divide></divide>
     <apply>
      <sum></sum>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <minus></minus>
         <ci>y</ci>
         <apply>
          <ci>normal-¯</ci>
          <ci>y</ci>
         </apply>
        </apply>
        <cn type="integer">2</cn>
       </apply>
       <ci>w</ci>
       <interval closure="open">
        <apply>
         <minus></minus>
         <ci>x</ci>
         <apply>
          <ci>normal-¯</ci>
          <ci>x</ci>
         </apply>
        </apply>
        <apply>
         <minus></minus>
         <ci>y</ci>
         <apply>
          <ci>normal-¯</ci>
          <ci>y</ci>
         </apply>
        </apply>
       </interval>
       <ci>I</ci>
       <interval closure="open">
        <ci>x</ci>
        <ci>y</ci>
       </interval>
      </apply>
     </apply>
     <apply>
      <sum></sum>
      <apply>
       <times></times>
       <ci>w</ci>
       <interval closure="open">
        <apply>
         <minus></minus>
         <ci>x</ci>
         <apply>
          <ci>normal-¯</ci>
          <ci>x</ci>
         </apply>
        </apply>
        <apply>
         <minus></minus>
         <ci>y</ci>
         <apply>
          <ci>normal-¯</ci>
          <ci>y</ci>
         </apply>
        </apply>
       </interval>
       <ci>I</ci>
       <interval closure="open">
        <ci>x</ci>
        <ci>y</ci>
       </interval>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   q_{yy}=\frac{\sum(y-\bar{y})^{2}w(x-\bar{x},y-\bar{y})I(x,y)}{\sum w(x-\bar{x}%
,y-\bar{y})I(x,y)}
  </annotation>
 </semantics>
</math>

 

<math display="inline" id="Gravitational_lensing_formalism:108">
 <semantics>
  <mrow>
   <msub>
    <mi>q</mi>
    <mrow>
     <mi>x</mi>
     <mi>y</mi>
    </mrow>
   </msub>
   <mo>=</mo>
   <mfrac>
    <mstyle scriptlevel="-1">
     <mrow>
      <mo largeop="true" symmetric="true">∑</mo>
      <mrow>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mi>x</mi>
         <mo>-</mo>
         <mover accent="true">
          <mi>x</mi>
          <mo stretchy="false">¯</mo>
         </mover>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mi>y</mi>
         <mo>-</mo>
         <mover accent="true">
          <mi>y</mi>
          <mo stretchy="false">¯</mo>
         </mover>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
       <mi>w</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mi>x</mi>
         <mo>-</mo>
         <mover accent="true">
          <mi>x</mi>
          <mo stretchy="false">¯</mo>
         </mover>
        </mrow>
        <mo>,</mo>
        <mrow>
         <mi>y</mi>
         <mo>-</mo>
         <mover accent="true">
          <mi>y</mi>
          <mo stretchy="false">¯</mo>
         </mover>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
       <mi>I</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>x</mi>
        <mo>,</mo>
        <mi>y</mi>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
     </mrow>
    </mstyle>
    <mstyle scriptlevel="-1">
     <mrow>
      <mo largeop="true" symmetric="true">∑</mo>
      <mrow>
       <mi>w</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mi>x</mi>
         <mo>-</mo>
         <mover accent="true">
          <mi>x</mi>
          <mo stretchy="false">¯</mo>
         </mover>
        </mrow>
        <mo>,</mo>
        <mrow>
         <mi>y</mi>
         <mo>-</mo>
         <mover accent="true">
          <mi>y</mi>
          <mo stretchy="false">¯</mo>
         </mover>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
       <mi>I</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>x</mi>
        <mo>,</mo>
        <mi>y</mi>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
     </mrow>
    </mstyle>
   </mfrac>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>q</ci>
     <apply>
      <times></times>
      <ci>x</ci>
      <ci>y</ci>
     </apply>
    </apply>
    <apply>
     <divide></divide>
     <apply>
      <sum></sum>
      <apply>
       <times></times>
       <apply>
        <minus></minus>
        <ci>x</ci>
        <apply>
         <ci>normal-¯</ci>
         <ci>x</ci>
        </apply>
       </apply>
       <apply>
        <minus></minus>
        <ci>y</ci>
        <apply>
         <ci>normal-¯</ci>
         <ci>y</ci>
        </apply>
       </apply>
       <ci>w</ci>
       <interval closure="open">
        <apply>
         <minus></minus>
         <ci>x</ci>
         <apply>
          <ci>normal-¯</ci>
          <ci>x</ci>
         </apply>
        </apply>
        <apply>
         <minus></minus>
         <ci>y</ci>
         <apply>
          <ci>normal-¯</ci>
          <ci>y</ci>
         </apply>
        </apply>
       </interval>
       <ci>I</ci>
       <interval closure="open">
        <ci>x</ci>
        <ci>y</ci>
       </interval>
      </apply>
     </apply>
     <apply>
      <sum></sum>
      <apply>
       <times></times>
       <ci>w</ci>
       <interval closure="open">
        <apply>
         <minus></minus>
         <ci>x</ci>
         <apply>
          <ci>normal-¯</ci>
          <ci>x</ci>
         </apply>
        </apply>
        <apply>
         <minus></minus>
         <ci>y</ci>
         <apply>
          <ci>normal-¯</ci>
          <ci>y</ci>
         </apply>
        </apply>
       </interval>
       <ci>I</ci>
       <interval closure="open">
        <ci>x</ci>
        <ci>y</ci>
       </interval>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   q_{xy}=\frac{\sum(x-\bar{x})(y-\bar{y})w(x-\bar{x},y-\bar{y})I(x,y)}{\sum w(x-%
\bar{x},y-\bar{y})I(x,y)}
  </annotation>
 </semantics>
</math>

</p>

<p>Here 

<math display="inline" id="Gravitational_lensing_formalism:109">
 <semantics>
  <mrow>
   <mi>w</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>x</mi>
    <mo>,</mo>
    <mi>y</mi>
    <mo rspace="5.8pt" stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>w</ci>
    <interval closure="open">
     <ci>x</ci>
     <ci>y</ci>
    </interval>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   w(x,y)~{}
  </annotation>
 </semantics>
</math>

 is a weight function that typically goes to zero or quickly approaches zero at some finite radius.</p>

<p>Image moments cannot generally be used to measure the ellipticity of galaxies without correcting for <a href="Weak_gravitational_lensing#Methodology" title="wikilink">observational effects</a>, particularly the <a href="point_spread_function" title="wikilink">point spread function</a>.<a class="footnoteRef" href="#fn4" id="fnref4"><sup>4</sup></a></p>
<h3 id="shear-and-reduced-shear">Shear and reduced shear</h3>

<p>Recall that the <a href="Gravitational_Lensing_Formalism#Lensing_Jacobian" title="wikilink">lensing Jacobian</a> can be decomposed into shear 

<math display="inline" id="Gravitational_lensing_formalism:110">
 <semantics>
  <mpadded width="+3.3pt">
   <mi>γ</mi>
  </mpadded>
  <annotation-xml encoding="MathML-Content">
   <ci>γ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \gamma~{}
  </annotation>
 </semantics>
</math>

 and convergence 

<math display="inline" id="Gravitational_lensing_formalism:111">
 <semantics>
  <mpadded width="+3.3pt">
   <mi>κ</mi>
  </mpadded>
  <annotation-xml encoding="MathML-Content">
   <ci>κ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \kappa~{}
  </annotation>
 </semantics>
</math>

. Acting on a circular background source with radius 

<math display="inline" id="Gravitational_lensing_formalism:112">
 <semantics>
  <mpadded width="+3.3pt">
   <mi>R</mi>
  </mpadded>
  <annotation-xml encoding="MathML-Content">
   <ci>R</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   R~{}
  </annotation>
 </semantics>
</math>

, lensing generates an ellipse with major and minor axes</p>

<p>

<math display="inline" id="Gravitational_lensing_formalism:113">
 <semantics>
  <mrow>
   <mi>a</mi>
   <mo>=</mo>
   <mfrac>
    <mi>R</mi>
    <mrow>
     <mn>1</mn>
     <mo>-</mo>
     <mi>κ</mi>
     <mo>-</mo>
     <mi>γ</mi>
    </mrow>
   </mfrac>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>a</ci>
    <apply>
     <divide></divide>
     <ci>R</ci>
     <apply>
      <minus></minus>
      <cn type="integer">1</cn>
      <ci>κ</ci>
      <ci>γ</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a=\frac{R}{1-\kappa-\gamma}
  </annotation>
 </semantics>
</math>

 

<math display="inline" id="Gravitational_lensing_formalism:114">
 <semantics>
  <mrow>
   <mi>b</mi>
   <mo>=</mo>
   <mfrac>
    <mi>R</mi>
    <mrow>
     <mrow>
      <mn>1</mn>
      <mo>-</mo>
      <mi>κ</mi>
     </mrow>
     <mo>+</mo>
     <mi>γ</mi>
    </mrow>
   </mfrac>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>b</ci>
    <apply>
     <divide></divide>
     <ci>R</ci>
     <apply>
      <plus></plus>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
       <ci>κ</ci>
      </apply>
      <ci>γ</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   b=\frac{R}{1-\kappa+\gamma}
  </annotation>
 </semantics>
</math>

</p>

<p>as long as the shear and convergence do not change appreciably over the size of the source (in that case, the lensed image is not an ellipse). Galaxies are not intrinsically circular, however, so it is necessary to quantify the effect of lensing on a non-zero ellipticity.</p>

<p>We can define the <em>complex shear</em> in analogy to the complex ellipticities defined above</p>

<p>

<math display="inline" id="Gravitational_lensing_formalism:115">
 <semantics>
  <mrow>
   <mi>γ</mi>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mo>|</mo>
     <mi>γ</mi>
     <mo>|</mo>
    </mrow>
    <msup>
     <mi>e</mi>
     <mrow>
      <mn>2</mn>
      <mi>i</mi>
      <mi>ϕ</mi>
     </mrow>
    </msup>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>γ</ci>
    <apply>
     <times></times>
     <apply>
      <abs></abs>
      <ci>γ</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>e</ci>
      <apply>
       <times></times>
       <cn type="integer">2</cn>
       <ci>i</ci>
       <ci>ϕ</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \gamma=\left|\gamma\right|e^{2i\phi}
  </annotation>
 </semantics>
</math>

</p>

<p>as well as the <em>reduced shear</em></p>

<p>

<math display="inline" id="Gravitational_lensing_formalism:116">
 <semantics>
  <mrow>
   <mi>g</mi>
   <mo>≡</mo>
   <mfrac>
    <mi>γ</mi>
    <mrow>
     <mn>1</mn>
     <mo>-</mo>
     <mi>κ</mi>
    </mrow>
   </mfrac>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <equivalent></equivalent>
    <ci>g</ci>
    <apply>
     <divide></divide>
     <ci>γ</ci>
     <apply>
      <minus></minus>
      <cn type="integer">1</cn>
      <ci>κ</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   g\equiv\frac{\gamma}{1-\kappa}
  </annotation>
 </semantics>
</math>

</p>

<p>The lensing Jacobian can now be written as</p>

<p>

<math display="inline" id="Gravitational_lensing_formalism:117">
 <semantics>
  <mrow>
   <mi>A</mi>
   <mo>=</mo>
   <mrow>
    <mo>[</mo>
    <mtable>
     <mtr>
      <mtd columnalign="center">
       <mrow>
        <mn>1</mn>
        <mo>-</mo>
        <mi>κ</mi>
        <mo>-</mo>
        <mrow>
         <mi>Re</mi>
         <mrow>
          <mo stretchy="false">[</mo>
          <mi>γ</mi>
          <mo stretchy="false">]</mo>
         </mrow>
        </mrow>
       </mrow>
      </mtd>
      <mtd columnalign="center">
       <mrow>
        <mo>-</mo>
        <mrow>
         <mi>Im</mi>
         <mrow>
          <mo stretchy="false">[</mo>
          <mi>γ</mi>
          <mo stretchy="false">]</mo>
         </mrow>
        </mrow>
       </mrow>
      </mtd>
     </mtr>
     <mtr>
      <mtd columnalign="center">
       <mrow>
        <mo>-</mo>
        <mrow>
         <mi>Im</mi>
         <mrow>
          <mo stretchy="false">[</mo>
          <mi>γ</mi>
          <mo stretchy="false">]</mo>
         </mrow>
        </mrow>
       </mrow>
      </mtd>
      <mtd columnalign="center">
       <mrow>
        <mrow>
         <mn>1</mn>
         <mo>-</mo>
         <mi>κ</mi>
        </mrow>
        <mo>+</mo>
        <mrow>
         <mi>Re</mi>
         <mrow>
          <mo stretchy="false">[</mo>
          <mi>γ</mi>
          <mo stretchy="false">]</mo>
         </mrow>
        </mrow>
       </mrow>
      </mtd>
     </mtr>
    </mtable>
    <mo>]</mo>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mn>1</mn>
      <mo>-</mo>
      <mi>κ</mi>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
    <mrow>
     <mo>[</mo>
     <mtable>
      <mtr>
       <mtd columnalign="center">
        <mrow>
         <mn>1</mn>
         <mo>-</mo>
         <mrow>
          <mi>Re</mi>
          <mrow>
           <mo stretchy="false">[</mo>
           <mi>g</mi>
           <mo stretchy="false">]</mo>
          </mrow>
         </mrow>
        </mrow>
       </mtd>
       <mtd columnalign="center">
        <mrow>
         <mo>-</mo>
         <mrow>
          <mi>Im</mi>
          <mrow>
           <mo stretchy="false">[</mo>
           <mi>g</mi>
           <mo stretchy="false">]</mo>
          </mrow>
         </mrow>
        </mrow>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mrow>
         <mo>-</mo>
         <mrow>
          <mi>Im</mi>
          <mrow>
           <mo stretchy="false">[</mo>
           <mi>g</mi>
           <mo stretchy="false">]</mo>
          </mrow>
         </mrow>
        </mrow>
       </mtd>
       <mtd columnalign="center">
        <mrow>
         <mn>1</mn>
         <mo>+</mo>
         <mrow>
          <mi>Re</mi>
          <mrow>
           <mo stretchy="false">[</mo>
           <mi>g</mi>
           <mo stretchy="false">]</mo>
          </mrow>
         </mrow>
        </mrow>
       </mtd>
      </mtr>
     </mtable>
     <mo>]</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <ci>A</ci>
     <apply>
      <csymbol cd="latexml">delimited-[]</csymbol>
      <matrix>
       <matrixrow>
        <apply>
         <minus></minus>
         <cn type="integer">1</cn>
         <ci>κ</ci>
         <apply>
          <times></times>
          <ci>Re</ci>
          <apply>
           <csymbol cd="latexml">delimited-[]</csymbol>
           <ci>γ</ci>
          </apply>
         </apply>
        </apply>
        <apply>
         <minus></minus>
         <apply>
          <times></times>
          <ci>Im</ci>
          <apply>
           <csymbol cd="latexml">delimited-[]</csymbol>
           <ci>γ</ci>
          </apply>
         </apply>
        </apply>
       </matrixrow>
       <matrixrow>
        <apply>
         <minus></minus>
         <apply>
          <times></times>
          <ci>Im</ci>
          <apply>
           <csymbol cd="latexml">delimited-[]</csymbol>
           <ci>γ</ci>
          </apply>
         </apply>
        </apply>
        <apply>
         <plus></plus>
         <apply>
          <minus></minus>
          <cn type="integer">1</cn>
          <ci>κ</ci>
         </apply>
         <apply>
          <times></times>
          <ci>Re</ci>
          <apply>
           <csymbol cd="latexml">delimited-[]</csymbol>
           <ci>γ</ci>
          </apply>
         </apply>
        </apply>
       </matrixrow>
      </matrix>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
       <ci>κ</ci>
      </apply>
      <apply>
       <csymbol cd="latexml">delimited-[]</csymbol>
       <matrix>
        <matrixrow>
         <apply>
          <minus></minus>
          <cn type="integer">1</cn>
          <apply>
           <times></times>
           <ci>Re</ci>
           <apply>
            <csymbol cd="latexml">delimited-[]</csymbol>
            <ci>g</ci>
           </apply>
          </apply>
         </apply>
         <apply>
          <minus></minus>
          <apply>
           <times></times>
           <ci>Im</ci>
           <apply>
            <csymbol cd="latexml">delimited-[]</csymbol>
            <ci>g</ci>
           </apply>
          </apply>
         </apply>
        </matrixrow>
        <matrixrow>
         <apply>
          <minus></minus>
          <apply>
           <times></times>
           <ci>Im</ci>
           <apply>
            <csymbol cd="latexml">delimited-[]</csymbol>
            <ci>g</ci>
           </apply>
          </apply>
         </apply>
         <apply>
          <plus></plus>
          <cn type="integer">1</cn>
          <apply>
           <times></times>
           <ci>Re</ci>
           <apply>
            <csymbol cd="latexml">delimited-[]</csymbol>
            <ci>g</ci>
           </apply>
          </apply>
         </apply>
        </matrixrow>
       </matrix>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A=\left[\begin{array}[]{ c c }1-\kappa-\mathrm{Re}[\gamma]&-\mathrm{Im}[\gamma%
]\\
-\mathrm{Im}[\gamma]&1-\kappa+\mathrm{Re}[\gamma]\end{array}\right]=(1-\kappa)%
\left[\begin{array}[]{ c c }1-\mathrm{Re}[g]&-\mathrm{Im}[g]\\
-\mathrm{Im}[g]&1+\mathrm{Re}[g]\end{array}\right]
  </annotation>
 </semantics>
</math>

</p>

<p>For a reduced shear 

<math display="inline" id="Gravitational_lensing_formalism:118">
 <semantics>
  <mpadded width="+3.3pt">
   <mi>g</mi>
  </mpadded>
  <annotation-xml encoding="MathML-Content">
   <ci>g</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   g~{}
  </annotation>
 </semantics>
</math>

 and unlensed complex ellipticities 

<math display="inline" id="Gravitational_lensing_formalism:119">
 <semantics>
  <mpadded width="+3.3pt">
   <msub>
    <mi>χ</mi>
    <mi>s</mi>
   </msub>
  </mpadded>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>χ</ci>
    <ci>s</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \chi_{s}~{}
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Gravitational_lensing_formalism:120">
 <semantics>
  <mpadded width="+3.3pt">
   <msub>
    <mi>ϵ</mi>
    <mi>s</mi>
   </msub>
  </mpadded>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>ϵ</ci>
    <ci>s</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \epsilon_{s}~{}
  </annotation>
 </semantics>
</math>

, the lensed ellipticities are</p>

<p>

<math display="inline" id="Gravitational_lensing_formalism:121">
 <semantics>
  <mrow>
   <mi>χ</mi>
   <mo>=</mo>
   <mfrac>
    <mrow>
     <msub>
      <mi>χ</mi>
      <mi>s</mi>
     </msub>
     <mo>+</mo>
     <mrow>
      <mn>2</mn>
      <mi>g</mi>
     </mrow>
     <mo>+</mo>
     <mrow>
      <msup>
       <mi>g</mi>
       <mn>2</mn>
      </msup>
      <msubsup>
       <mi>χ</mi>
       <mi>s</mi>
       <mo>*</mo>
      </msubsup>
     </mrow>
    </mrow>
    <mrow>
     <mn>1</mn>
     <mo>+</mo>
     <msup>
      <mrow>
       <mo stretchy="false">|</mo>
       <mi>g</mi>
       <mo stretchy="false">|</mo>
      </mrow>
      <mn>2</mn>
     </msup>
     <mo>+</mo>
     <mrow>
      <mn>2</mn>
      <mi mathvariant="normal">R</mi>
      <mi mathvariant="normal">e</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mi>g</mi>
        <msubsup>
         <mi>χ</mi>
         <mi>s</mi>
         <mo>*</mo>
        </msubsup>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mrow>
   </mfrac>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>χ</ci>
    <apply>
     <divide></divide>
     <apply>
      <plus></plus>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>χ</ci>
       <ci>s</ci>
      </apply>
      <apply>
       <times></times>
       <cn type="integer">2</cn>
       <ci>g</ci>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>g</ci>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>χ</ci>
         <ci>s</ci>
        </apply>
        <times></times>
       </apply>
      </apply>
     </apply>
     <apply>
      <plus></plus>
      <cn type="integer">1</cn>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <abs></abs>
        <ci>g</ci>
       </apply>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <times></times>
       <cn type="integer">2</cn>
       <ci>normal-R</ci>
       <ci>normal-e</ci>
       <apply>
        <times></times>
        <ci>g</ci>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>χ</ci>
          <ci>s</ci>
         </apply>
         <times></times>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \chi=\frac{\chi_{s}+2g+g^{2}\chi_{s}^{*}}{1+|g|^{2}+2\mathrm{Re}(g\chi_{s}^{*})}
  </annotation>
 </semantics>
</math>

 

<math display="inline" id="Gravitational_lensing_formalism:122">
 <semantics>
  <mrow>
   <mi>ϵ</mi>
   <mo>=</mo>
   <mfrac>
    <mrow>
     <msub>
      <mi>ϵ</mi>
      <mi>s</mi>
     </msub>
     <mo>+</mo>
     <mi>g</mi>
    </mrow>
    <mrow>
     <mn>1</mn>
     <mo>+</mo>
     <mrow>
      <msup>
       <mi>g</mi>
       <mo>*</mo>
      </msup>
      <mi>ϵ</mi>
     </mrow>
    </mrow>
   </mfrac>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>ϵ</ci>
    <apply>
     <divide></divide>
     <apply>
      <plus></plus>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>ϵ</ci>
       <ci>s</ci>
      </apply>
      <ci>g</ci>
     </apply>
     <apply>
      <plus></plus>
      <cn type="integer">1</cn>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>g</ci>
        <times></times>
       </apply>
       <ci>ϵ</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \epsilon=\frac{\epsilon_{s}+g}{1+g^{*}\epsilon}
  </annotation>
 </semantics>
</math>

</p>

<p>In the weak lensing limit, 

<math display="inline" id="Gravitational_lensing_formalism:123">
 <semantics>
  <mrow>
   <mi>γ</mi>
   <mo>≪</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">much-less-than</csymbol>
    <ci>γ</ci>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \gamma\ll 1
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Gravitational_lensing_formalism:124">
 <semantics>
  <mrow>
   <mi>κ</mi>
   <mo>≪</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">much-less-than</csymbol>
    <ci>κ</ci>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \kappa\ll 1
  </annotation>
 </semantics>
</math>

, so</p>

<p>

<math display="inline" id="Gravitational_lensing_formalism:125">
 <semantics>
  <mrow>
   <mi>χ</mi>
   <mo>≈</mo>
   <mrow>
    <msub>
     <mi>χ</mi>
     <mi>s</mi>
    </msub>
    <mo>+</mo>
    <mrow>
     <mn>2</mn>
     <mi>g</mi>
    </mrow>
   </mrow>
   <mo>≈</mo>
   <mrow>
    <msub>
     <mi>χ</mi>
     <mi>s</mi>
    </msub>
    <mo>+</mo>
    <mrow>
     <mn>2</mn>
     <mi>γ</mi>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <approx></approx>
     <ci>χ</ci>
     <apply>
      <plus></plus>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>χ</ci>
       <ci>s</ci>
      </apply>
      <apply>
       <times></times>
       <cn type="integer">2</cn>
       <ci>g</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <approx></approx>
     <share href="#.cmml">
     </share>
     <apply>
      <plus></plus>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>χ</ci>
       <ci>s</ci>
      </apply>
      <apply>
       <times></times>
       <cn type="integer">2</cn>
       <ci>γ</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \chi\approx\chi_{s}+2g\approx\chi_{s}+2\gamma
  </annotation>
 </semantics>
</math>

 

<math display="inline" id="Gravitational_lensing_formalism:126">
 <semantics>
  <mrow>
   <mi>ϵ</mi>
   <mo>≈</mo>
   <mrow>
    <msub>
     <mi>ϵ</mi>
     <mi>s</mi>
    </msub>
    <mo>+</mo>
    <mi>g</mi>
   </mrow>
   <mo>≈</mo>
   <mrow>
    <msub>
     <mi>ϵ</mi>
     <mi>s</mi>
    </msub>
    <mo>+</mo>
    <mi>γ</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <approx></approx>
     <ci>ϵ</ci>
     <apply>
      <plus></plus>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>ϵ</ci>
       <ci>s</ci>
      </apply>
      <ci>g</ci>
     </apply>
    </apply>
    <apply>
     <approx></approx>
     <share href="#.cmml">
     </share>
     <apply>
      <plus></plus>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>ϵ</ci>
       <ci>s</ci>
      </apply>
      <ci>γ</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \epsilon\approx\epsilon_{s}+g\approx\epsilon_{s}+\gamma
  </annotation>
 </semantics>
</math>

</p>

<p>If we can assume that the sources are randomly oriented, their complex ellipticities average to zero, so 

<math display="inline" id="Gravitational_lensing_formalism:127">
 <semantics>
  <mrow>
   <mrow>
    <mo stretchy="false">⟨</mo>
    <mi>χ</mi>
    <mo stretchy="false">⟩</mo>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mn>2</mn>
    <mrow>
     <mo stretchy="false">⟨</mo>
     <mi>γ</mi>
     <mo stretchy="false">⟩</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="latexml">delimited-⟨⟩</csymbol>
     <ci>χ</ci>
    </apply>
    <apply>
     <times></times>
     <cn type="integer">2</cn>
     <apply>
      <csymbol cd="latexml">delimited-⟨⟩</csymbol>
      <ci>γ</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \langle\chi\rangle=2\langle\gamma\rangle
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Gravitational_lensing_formalism:128">
 <semantics>
  <mrow>
   <mrow>
    <mo stretchy="false">⟨</mo>
    <mi>ϵ</mi>
    <mo stretchy="false">⟩</mo>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mo stretchy="false">⟨</mo>
    <mi>γ</mi>
    <mo stretchy="false">⟩</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="latexml">delimited-⟨⟩</csymbol>
     <ci>ϵ</ci>
    </apply>
    <apply>
     <csymbol cd="latexml">delimited-⟨⟩</csymbol>
     <ci>γ</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \langle\epsilon\rangle=\langle\gamma\rangle
  </annotation>
 </semantics>
</math>

. This is the principal equation of weak lensing: the average ellipticity of background galaxies is a direct measure of the shear induced by foreground mass.</p>
<h3 id="magnification">Magnification</h3>

<p>While gravitational lensing preserves surface brightness, as dictated by <a href="Liouville's_theorem_(Hamiltonian)" title="wikilink">Liouville's theorem</a>, lensing does change the apparent <a href="solid_angle" title="wikilink">solid angle</a> of a source. The amount of <a class="uri" href="magnification" title="wikilink">magnification</a> is given by the ratio of the image area to the source area. For a circularly <a href="symmetry" title="wikilink">symmetric</a> lens, the magnification factor μ is given by</p>

<p>

<math display="inline" id="Gravitational_lensing_formalism:129">
 <semantics>
  <mrow>
   <mi>μ</mi>
   <mo>=</mo>
   <mrow>
    <mfrac>
     <mi>θ</mi>
     <mi>β</mi>
    </mfrac>
    <mfrac>
     <mrow>
      <mi>d</mi>
      <mi>θ</mi>
     </mrow>
     <mrow>
      <mi>d</mi>
      <mi>β</mi>
     </mrow>
    </mfrac>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>μ</ci>
    <apply>
     <times></times>
     <apply>
      <divide></divide>
      <ci>θ</ci>
      <ci>β</ci>
     </apply>
     <apply>
      <divide></divide>
      <apply>
       <times></times>
       <ci>d</ci>
       <ci>θ</ci>
      </apply>
      <apply>
       <times></times>
       <ci>d</ci>
       <ci>β</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mu=\frac{\theta}{\beta}\frac{d\theta}{d\beta}
  </annotation>
 </semantics>
</math>

</p>

<p>In terms of convergence and shear</p>

<p>

<math display="inline" id="Gravitational_lensing_formalism:130">
 <semantics>
  <mrow>
   <mi>μ</mi>
   <mo>=</mo>
   <mfrac>
    <mn>1</mn>
    <mrow>
     <mo>det</mo>
     <mi>A</mi>
    </mrow>
   </mfrac>
   <mo>=</mo>
   <mfrac>
    <mn>1</mn>
    <mrow>
     <mo stretchy="false">[</mo>
     <mrow>
      <msup>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mn>1</mn>
         <mo>-</mo>
         <mi>κ</mi>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
       <mn>2</mn>
      </msup>
      <mo>-</mo>
      <msup>
       <mi>γ</mi>
       <mn>2</mn>
      </msup>
     </mrow>
     <mo stretchy="false">]</mo>
    </mrow>
   </mfrac>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <ci>μ</ci>
     <apply>
      <divide></divide>
      <cn type="integer">1</cn>
      <apply>
       <determinant></determinant>
       <ci>A</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <divide></divide>
      <cn type="integer">1</cn>
      <apply>
       <csymbol cd="latexml">delimited-[]</csymbol>
       <apply>
        <minus></minus>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <minus></minus>
          <cn type="integer">1</cn>
          <ci>κ</ci>
         </apply>
         <cn type="integer">2</cn>
        </apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>γ</ci>
         <cn type="integer">2</cn>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mu=\frac{1}{\det A}=\frac{1}{[(1-\kappa)^{2}-\gamma^{2}]}
  </annotation>
 </semantics>
</math>

</p>

<p>For this reason, the Jacobian 

<math display="inline" id="Gravitational_lensing_formalism:131">
 <semantics>
  <mpadded width="+3.3pt">
   <mi>A</mi>
  </mpadded>
  <annotation-xml encoding="MathML-Content">
   <ci>A</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A~{}
  </annotation>
 </semantics>
</math>

 is also known as the "inverse magnification matrix".</p>

<p>The reduced shear is invariant with the scaling of the Jacobian 

<math display="inline" id="Gravitational_lensing_formalism:132">
 <semantics>
  <mpadded width="+3.3pt">
   <mi>A</mi>
  </mpadded>
  <annotation-xml encoding="MathML-Content">
   <ci>A</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A~{}
  </annotation>
 </semantics>
</math>

 by a scalar 

<math display="inline" id="Gravitational_lensing_formalism:133">
 <semantics>
  <mpadded width="+3.3pt">
   <mi>λ</mi>
  </mpadded>
  <annotation-xml encoding="MathML-Content">
   <ci>λ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \lambda~{}
  </annotation>
 </semantics>
</math>

, which is equivalent to the transformations 

<math display="inline" id="Gravitational_lensing_formalism:134">
 <semantics>
  <mrow>
   <mrow>
    <mn>1</mn>
    <mo>-</mo>
    <msup>
     <mi>κ</mi>
     <mo>′</mo>
    </msup>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mi>λ</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mn>1</mn>
      <mo>-</mo>
      <mi>κ</mi>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <minus></minus>
     <cn type="integer">1</cn>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>κ</ci>
      <ci>normal-′</ci>
     </apply>
    </apply>
    <apply>
     <times></times>
     <ci>λ</ci>
     <apply>
      <minus></minus>
      <cn type="integer">1</cn>
      <ci>κ</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   1-\kappa^{\prime}=\lambda(1-\kappa)
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Gravitational_lensing_formalism:135">
 <semantics>
  <mrow>
   <msup>
    <mi>γ</mi>
    <mo>′</mo>
   </msup>
   <mo>=</mo>
   <mrow>
    <mi>λ</mi>
    <mi>γ</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>γ</ci>
     <ci>normal-′</ci>
    </apply>
    <apply>
     <times></times>
     <ci>λ</ci>
     <ci>γ</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \gamma^{\prime}=\lambda\gamma
  </annotation>
 </semantics>
</math>

.</p>

<p>Thus, 

<math display="inline" id="Gravitational_lensing_formalism:136">
 <semantics>
  <mi>κ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>κ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \kappa
  </annotation>
 </semantics>
</math>

 can only be determined up to a transformation 

<math display="inline" id="Gravitational_lensing_formalism:137">
 <semantics>
  <mrow>
   <mi>κ</mi>
   <mo>→</mo>
   <mrow>
    <mrow>
     <mi>λ</mi>
     <mi>κ</mi>
    </mrow>
    <mo>+</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mn>1</mn>
      <mo>-</mo>
      <mi>λ</mi>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-→</ci>
    <ci>κ</ci>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <ci>λ</ci>
      <ci>κ</ci>
     </apply>
     <apply>
      <minus></minus>
      <cn type="integer">1</cn>
      <ci>λ</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \kappa\rightarrow\lambda\kappa+(1-\lambda)
  </annotation>
 </semantics>
</math>

, which is known as the "mass sheet degeneracy." In principle, this degeneracy can be broken if an independent measurement of the magnification is available because the magnification is not invariant under the aforementioned degeneracy transformation. Specifically, 

<math display="inline" id="Gravitational_lensing_formalism:138">
 <semantics>
  <mpadded width="+3.3pt">
   <mi>μ</mi>
  </mpadded>
  <annotation-xml encoding="MathML-Content">
   <ci>μ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mu~{}
  </annotation>
 </semantics>
</math>

 scales with 

<math display="inline" id="Gravitational_lensing_formalism:139">
 <semantics>
  <mpadded width="+3.3pt">
   <mi>λ</mi>
  </mpadded>
  <annotation-xml encoding="MathML-Content">
   <ci>λ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \lambda~{}
  </annotation>
 </semantics>
</math>

 as 

<math display="inline" id="Gravitational_lensing_formalism:140">
 <semantics>
  <mrow>
   <mi>μ</mi>
   <mo>∝</mo>
   <msup>
    <mi>λ</mi>
    <mrow>
     <mo>-</mo>
     <mn>2</mn>
    </mrow>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">proportional-to</csymbol>
    <ci>μ</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>λ</ci>
     <apply>
      <minus></minus>
      <cn type="integer">2</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mu\propto\lambda^{-2}
  </annotation>
 </semantics>
</math>

.</p>
<h2 id="references">References</h2>

<p>"</p>

<p><a class="uri" href="Category:Astrophysics" title="wikilink">Category:Astrophysics</a> <a href="Category:Effects_of_gravitation" title="wikilink">Category:Effects of gravitation</a> <a href="Category:Gravitational_lensing" title="wikilink">Category:Gravitational lensing</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1"><a href="#fnref1">↩</a></li>
<li id="fn2"><a href="#fnref2">↩</a></li>
<li id="fn3"><a href="#fnref3">↩</a></li>
<li id="fn4"><a href="#fnref4">↩</a></li>
</ol>
</section>
</body>
</html>

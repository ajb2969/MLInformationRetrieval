<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="1160">Trend estimation</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Trend estimation</h1>
<hr/>

<p><strong>Trend estimation</strong> is a <a href="statistics" title="wikilink">statistical</a> technique to aid interpretation of data. When a series of measurements of a process are treated as a <a href="time_series" title="wikilink">time series</a>, trend estimation can be used to make and justify statements about tendencies in the data, by relating the measurements to the times at which they occurred. By using trend estimation it is possible to construct a model which is independent of anything known about the nature of the process of an incompletely understood system (for example, physical, economic, or other system). This model can then be used to describe the behaviour of the observed data.</p>

<p>In particular, it may be useful to determine if measurements exhibit an increasing or decreasing trend which is statistically distinguished from <a href="randomness" title="wikilink">random behaviour</a>. Some examples are determining the trend of the daily average temperatures at a given location from winter to summer, and determining the trend in a global temperature series over the last 100 years. In the latter case, issues of <a href="homogeneity_(statistics)" title="wikilink">homogeneity</a> are important (for example, about whether the series is equally reliable throughout its length).</p>
<h2 id="fitting-a-trend-least-squares">Fitting a trend: least-squares</h2>

<p>Given a set of data and the desire to produce some kind of <a href="Econometric_model" title="wikilink">model</a> of those data, there are a variety of functions that can be chosen for the fit. If there is no prior understanding of the data, then the simplest function to fit is a straight line with the data plotted vertically and values of time (<em>t</em> = 1, 2, 3, ...) plotted horizontally.</p>

<p>Once it has been decided to fit a straight line, there are various ways to do so, but the most usual choice is a <a class="uri" href="least-squares" title="wikilink">least-squares</a> fit. This method minimises the sum of the squared errors in the data series, denoted the <em>y</em> variable.</p>

<p>Given a set of points in time 

<math display="inline" id="Trend_estimation:0">
 <semantics>
  <mi>t</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>t</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   t
  </annotation>
 </semantics>
</math>

, and data values 

<math display="inline" id="Trend_estimation:1">
 <semantics>
  <msub>
   <mi>y</mi>
   <mi>t</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>y</ci>
    <ci>t</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   y_{t}
  </annotation>
 </semantics>
</math>

 observed for those points in time, values of 

<math display="inline" id="Trend_estimation:2">
 <semantics>
  <mi>a</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>a</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Trend_estimation:3">
 <semantics>
  <mi>b</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>b</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   b
  </annotation>
 </semantics>
</math>

 are chosen so that</p>

<p>

<math display="block" id="Trend_estimation:4">
 <semantics>
  <mrow>
   <munder>
    <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
    <mi>t</mi>
   </munder>
   <mrow>
    <mo>{</mo>
    <msup>
     <mrow>
      <mo stretchy="false">[</mo>
      <mrow>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mrow>
          <mi>a</mi>
          <mi>t</mi>
         </mrow>
         <mo>+</mo>
         <mi>b</mi>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
       <mo>-</mo>
       <msub>
        <mi>y</mi>
        <mi>t</mi>
       </msub>
      </mrow>
      <mo stretchy="false">]</mo>
     </mrow>
     <mn>2</mn>
    </msup>
    <mo>}</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <sum></sum>
     <ci>t</ci>
    </apply>
    <set>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="latexml">delimited-[]</csymbol>
       <apply>
        <minus></minus>
        <apply>
         <plus></plus>
         <apply>
          <times></times>
          <ci>a</ci>
          <ci>t</ci>
         </apply>
         <ci>b</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>y</ci>
         <ci>t</ci>
        </apply>
       </apply>
      </apply>
      <cn type="integer">2</cn>
     </apply>
    </set>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \sum_{t}\left\{[(at+b)-y_{t}]^{2}\right\}
  </annotation>
 </semantics>
</math>

</p>

<p>is minimised. Here <em>at</em> + <em>b</em> is the trend line, so the sum of <a href="squared_deviations" title="wikilink">squared deviations</a> from the trend line is what is being minimised. This can always be done in closed form since this is a case of <a href="simple_linear_regression" title="wikilink">simple linear regression</a>.</p>

<p>For the rest of this article, “trend” will mean the slope of the least squares line, since this is a common convention.</p>
<h2 id="trends-in-random-data">Trends in random data</h2>

<p>Before considering trends in real data, it is useful to understand trends in <a href="random_variable" title="wikilink">random data</a>.</p>
<figure><b>(Figure)</b>
<figcaption>Red shaded values are greater than 99% of the rest; blue, 95%; green, 90%. In this case, the V values discussed in the text for (one-sided) 95% confidence is seen to be 0.2.</figcaption>
</figure>

<p>If a series which is known to be random is analysed – fair dice falls, or computer-generated pseudo-random numbers – and a trend line is fitted through the data, the chances of an exactly zero estimated trend are negligible. But the trend would be expected to be small. If an individual series of observations is generated from simulations that employ a given <a class="uri" href="variance" title="wikilink">variance</a> of noise that equals the observed variance of our data series of interest, and a given length (say, 100 points), a large number of such simulated series (say, 100,000 series) can be generated. These 100,000 series can then be analysed individually to calculate estimated trends in each series, and these results establish a distribution of estimated trends that are to be expected from such random data – see diagram. Such a distribution will be <a href="normal_distribution" title="wikilink">normal</a> according to the <a href="central_limit_theorem" title="wikilink">central limit theorem</a> except in pathological cases. A level of statistical certainty, <em>S</em>, may now be selected – 95% confidence is typical; 99% would be stricter, 90% looser – and the following question can be asked: what is the borderline trend value <em>V</em> that would result in <em>S</em>% of trends being between −<em>V</em> and <em>+V</em>?</p>

<p>The above procedure can be replaced by a <a href="permutation_test" title="wikilink">permutation test</a>. For this, the set of 100,000 generated series would be replaced by 100,000 series constructed by randomly shuffling the observed data series; clearly such a constructed series would be trend-free, so as with the approach of using simulated data these series can be used to generate borderline trend values <em>V</em> and −<em>V</em>.</p>

<p>In the above discussion the distribution of trends was calculated by simulation, from a large number of trials. In simple cases (normally distributed random noise being a classic) the distribution of trends can be calculated exactly without simulation.</p>

<p>The range (−<em>V</em>, <em>V</em>) can be employed in deciding whether a trend estimated from the actual data is unlikely to have come from a data series that truly has a zero trend. If the estimated value of the regression parameter <em>a</em> lies outside this range, such a result could have occurred in the presence of a true zero trend only, for example, one time out of twenty if the confidence value <em>S</em>=95% was used; in this case, it can be said that, at degree of certainty <em>S</em>, we reject the null hypothesis that the true underlying trend is zero.</p>

<p>However, note that whatever value of <em>S</em> we choose, then a given fraction, 1 − <em>S</em>, of truly random series will be declared (falsely, by construction) to have a significant trend. Conversely, a certain fraction of series that in fact have a non-zero trend will not be declared to have a trend.</p>
<h2 id="data-as-trend-plus-noise">Data as trend plus noise</h2>

<p>To analyse a (time) series of data, we assume that it may be represented as trend plus noise:</p>

<p>

<math display="block" id="Trend_estimation:5">
 <semantics>
  <mrow>
   <msub>
    <mi>y</mi>
    <mi>t</mi>
   </msub>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mi>a</mi>
     <mi>t</mi>
    </mrow>
    <mo>+</mo>
    <mi>b</mi>
    <mo>+</mo>
    <mpadded width="+1.7pt">
     <msub>
      <mi>e</mi>
      <mi>t</mi>
     </msub>
    </mpadded>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>y</ci>
     <ci>t</ci>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <ci>a</ci>
      <ci>t</ci>
     </apply>
     <ci>b</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>e</ci>
      <ci>t</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   y_{t}=at+b+e_{t}\,
  </annotation>
 </semantics>
</math>

</p>

<p>where 

<math display="inline" id="Trend_estimation:6">
 <semantics>
  <mi>a</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>a</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Trend_estimation:7">
 <semantics>
  <mi>b</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>b</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   b
  </annotation>
 </semantics>
</math>

 are unknown constants and the 

<math display="inline" id="Trend_estimation:8">
 <semantics>
  <mi>e</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>e</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   e
  </annotation>
 </semantics>
</math>

's are randomly distributed <a href="errors_and_residuals_in_statistics" title="wikilink">errors</a>. If one can reject the null hypothesis that the errors are non-stationary, then the non-stationary series {<em>y</em><sub><em>t</em></sub> } is called <a href="trend_stationary" title="wikilink">trend stationary</a>. The least squares method assumes the errors to be independently distributed with a <a href="normal_distribution" title="wikilink">normal distribution</a>. If this is not the case, hypothesis tests about the estimated values of <em>a</em> and <em>b</em> may be inaccurate. It is simplest if the 

<math display="inline" id="Trend_estimation:9">
 <semantics>
  <mi>e</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>e</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   e
  </annotation>
 </semantics>
</math>

's all have the same distribution, but if not (if some have <a href="heteroskedasticity" title="wikilink">higher variance</a>, meaning that those data points are effectively less certain) then this can be taken into account during the least squares fitting, by weighting each point by the inverse of the variance of that point.</p>

<p>In most cases, where only a single time series exists to be analysed, the variance of the 

<math display="inline" id="Trend_estimation:10">
 <semantics>
  <mi>e</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>e</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   e
  </annotation>
 </semantics>
</math>

's is estimated by fitting a trend, thus allowing 

<math display="inline" id="Trend_estimation:11">
 <semantics>
  <mrow>
   <mrow>
    <mi>a</mi>
    <mi>t</mi>
   </mrow>
   <mo>+</mo>
   <mi>b</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <plus></plus>
    <apply>
     <times></times>
     <ci>a</ci>
     <ci>t</ci>
    </apply>
    <ci>b</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   at+b
  </annotation>
 </semantics>
</math>

 to be subtracted from the data 

<math display="inline" id="Trend_estimation:12">
 <semantics>
  <msub>
   <mi>y</mi>
   <mi>t</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>y</ci>
    <ci>t</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   y_{t}
  </annotation>
 </semantics>
</math>

 (thus <em>detrending</em> the data) and leaving the residuals 

<math display="inline" id="Trend_estimation:13">
 <semantics>
  <msub>
   <mi>e</mi>
   <mi>t</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>e</ci>
    <ci>t</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   e_{t}
  </annotation>
 </semantics>
</math>

 as the <em>detrended data</em>, and calculating the variance of the 

<math display="inline" id="Trend_estimation:14">
 <semantics>
  <msub>
   <mi>e</mi>
   <mi>t</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>e</ci>
    <ci>t</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   e_{t}
  </annotation>
 </semantics>
</math>

's from the residuals — this is often the only way of estimating the variance of the 

<math display="inline" id="Trend_estimation:15">
 <semantics>
  <msub>
   <mi>e</mi>
   <mi>t</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>e</ci>
    <ci>t</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   e_{t}
  </annotation>
 </semantics>
</math>

's.</p>

<p>One particular special case of great interest, the (global) temperature time series, is known not to be homogeneous in time: apart from anything else, the number of weather observations has (generally) increased with time, and thus the error associated with estimating the global temperature from a limited set of observations has decreased with time. Though many people do attempt to fit a "trend" to climate data the climate trend is clearly not a straight line and the idea of attributing a straight line is not mathematically correct because the assumptions of the method are not valid in this context.</p>

<p>Once we know the "noise" of the series, we can then assess the significance of the trend by making the <em>null hypothesis</em> that the trend, 

<math display="inline" id="Trend_estimation:16">
 <semantics>
  <mi>a</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>a</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a
  </annotation>
 </semantics>
</math>

, is not significantly different from 0. From the above discussion of trends in random data with known variance, we know the distribution of trends to be expected from random (trendless) data. If the calculated trend, 

<math display="inline" id="Trend_estimation:17">
 <semantics>
  <mi>a</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>a</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a
  </annotation>
 </semantics>
</math>

, is larger than the value, 

<math display="inline" id="Trend_estimation:18">
 <semantics>
  <mi>V</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>V</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   V
  </annotation>
 </semantics>
</math>

, then the trend is deemed significantly different from zero at significance level 

<math display="inline" id="Trend_estimation:19">
 <semantics>
  <mi>S</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>S</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   S
  </annotation>
 </semantics>
</math>

.</p>

<p>The use of a linear trend line has been the subject of criticism, leading to a search for alternative approaches to avoid its use in model estimation. One of the alternative approaches involves <a href="unit_root" title="wikilink">unit root</a> tests and the <a class="uri" href="cointegration" title="wikilink">cointegration</a> technique in econometric studies.</p>

<p>The estimated coefficient associated with a linear time trend variable is interpreted as a measure of the impact of a number of unknown or known but unmeasurable factors on the dependent variable over one unit of time. Strictly speaking, that interpretation is applicable for the estimation time frame only. Outside that time frame, one does not know how those unmeasurable factors behave both qualitatively and quantitatively. Furthermore, the linearity of the time trend poses many questions:</p>

<p>(i) Why should it be linear?</p>

<p>(ii) If the trend is non-linear then under what conditions does its inclusion influence the magnitude as well as the statistical significance of the estimates of other parameters in the model?</p>

<p>(iii) The inclusion of a linear time trend in a model precludes by assumption the presence of fluctuations in the tendencies of the dependent variable over time; is this necessarily valid in a particular context?</p>

<p>(iv) And, does a spurious relationship exist in the model because an underlying causative variable is itself time-trending?</p>

<p>Research results of mathematicians, statisticians, econometricians, and economists have been published in response to those questions. For example, detailed notes on the meaning of linear time trends in regression model are given in Cameron (2005);<a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a> Granger, Engle and many other econometricians have written on stationarity, unit root testing, co-integration and related issues (a summary of some of the works in this area can be found in an information paper<a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a> by the Royal Swedish Academy of Sciences (2003); and Ho-Trieu &amp; Tucker (1990) have written on logarithmic time trends<a class="footnoteRef" href="#fn3" id="fnref3"><sup>3</sup></a> with results indicating linear time trends are special cases of <a class="uri" href="cycles" title="wikilink">cycles</a><a class="footnoteRef" href="#fn4" id="fnref4"><sup>4</sup></a></p>
<h2 id="noisy-time-series-and-an-example">Noisy time series, and an example</h2>

<p>It is harder to see a trend in a noisy time series. For example, if the true series is 0, 1, 2, 3 all plus some independent normally distributed "noise" <em>e</em> of <a href="standard_deviation" title="wikilink">standard deviation</a> <em>E</em>, and we have a sample series of length 50, then if <em>E</em> = 0.1 the trend will be obvious; if <em>E</em> = 100 the trend will probably be visible; but if <em>E</em> = 10000 the trend will be buried in the noise.</p>

<p>If we consider a concrete example, the global surface temperature record of the past 140 years as presented by the <a href="Intergovernmental_Panel_on_Climate_Change" title="wikilink">IPCC</a>:<a class="footnoteRef" href="#fn5" id="fnref5"><sup>5</sup></a> then the interannual variation is about 0.2 °C and the trend about 0.6 °C over 140 years, with 95% confidence limits of 0.2 °C (by coincidence, about the same value as the interannual variation). Hence the trend is statistically different from 0. However, as noted elsewhere this time series doesn't conform to the assumptions necessary for least squares to be valid.</p>
<h2 id="goodness-of-fit-r-squared-and-trend">Goodness of fit (R-squared) and trend</h2>
<figure><b>(Figure)</b>
<figcaption>Illustration of the effect of filtering on <em>r</em><sup>2</sup>. Black=unfiltered data; red=data averaged every 10 points; blue=data averaged every 100 points. All have the same trend, but more filtering leads to higher <em>r</em><sup>2</sup> of fitted trend line.</figcaption>
</figure>

<p>The least-squares fitting process produces a value – <a href="Coefficient_of_determination" title="wikilink">r-squared</a> (<em>r</em><sup>2</sup>) – which is the square of the residuals of the data after the fit. It says what fraction of the variance of the data is explained by the fitted trend line. It does <strong>not</strong> relate to the <a href="statistical_significance" title="wikilink">statistical significance</a> of the trend line (see graph); statistical significance of the trend is determined by its <a class="uri" href="t-statistic" title="wikilink">t-statistic</a>. Often, filtering a series increases <em>r</em><sup>2</sup> while making little difference to the fitted trend.</p>
<h2 id="real-data-need-more-complicated-models">Real data need more complicated models</h2>

<p>Thus far the data have been assumed to consist of the trend plus noise, with the noise at each data point being <a href="independent_and_identically_distributed_random_variables" title="wikilink">independent and identically distributed random variables</a> and to have a <a href="normal_distribution" title="wikilink">normal distribution</a>. Real data (for example climate data) may not fulfill these criteria. This is important, as it makes an enormous difference to the ease with which the statistics can be analysed so as to extract maximum information from the data series. If there are other non-linear effects that have a correlation to the independent variable (such as cyclic influences), the use of least-squares estimation of the trend is not valid. Also where the variations are significantly larger than the resulting straight line trend, the choice of start and end points can significantly change the result. That is, the result is mathematically <a href="Consistent_estimator" title="wikilink">inconsistent</a>. Statistical inferences (tests for the presence of trend, confidence intervals for the trend, etc.) are invalid unless departures from the standard assumptions are properly accounted for, for example as follows:</p>
<ul>
<li>Dependence: autocorrelated time series might be modeled using <a href="autoregressive_moving_average_model" title="wikilink">autoregressive moving average models</a>.</li>
</ul>
<ul>
<li>Non-constant variance: in the simplest cases <a href="weighted_least_squares" title="wikilink">weighted least squares</a> might be used.</li>
</ul>
<ul>
<li>Non-normal distribution for errors: in the simplest cases a <a href="generalised_linear_model" title="wikilink">generalised linear model</a> might be applicable.</li>
</ul>
<ul>
<li><a href="Unit_root" title="wikilink">Unit root</a>: taking first (or occasionally second) differences of the data, with the level of differencing being identified through various unit root tests.<a class="footnoteRef" href="#fn6" id="fnref6"><sup>6</sup></a></li>
</ul>
<h2 id="see-also">See also</h2>
<ul>
<li><a class="uri" href="Extrapolation" title="wikilink">Extrapolation</a></li>
<li><a class="uri" href="Forecasting" title="wikilink">Forecasting</a></li>
<li><a href="Prediction_interval" title="wikilink">Prediction interval</a></li>
<li><a href="Regression_analysis" title="wikilink">Regression analysis</a></li>
</ul>
<h2 id="notes">Notes</h2>
<h2 id="references">References</h2>
<ul>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
</ul>

<p>"</p>

<p><a href="Category:Estimation_theory" title="wikilink">Category:Estimation theory</a> <a href="Category:Time_series_analysis" title="wikilink">Category:Time series analysis</a> <a href="Category:Statistical_forecasting" title="wikilink">Category:Statistical forecasting</a> <a href="Category:Change_detection" title="wikilink">Category:Change detection</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1"><a href="#fnref1">↩</a></li>
<li id="fn2"><a href="#fnref2">↩</a></li>
<li id="fn3"><a href="#fnref3">↩</a></li>
<li id="fn4"></li>
<li id="fn5"><a href="#fnref5">↩</a></li>
<li id="fn6"><a href="#fnref6">↩</a></li>
</ol>
</section>
</body>
</html>

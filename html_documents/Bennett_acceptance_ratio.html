<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="1225">Bennett acceptance ratio</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Bennett acceptance ratio</h1>
<hr/>

<p>The <strong>Bennett acceptance ratio</strong> method (sometimes abbreviated to <strong>BAR</strong>) is an algorithm for estimating the difference in free energy between two systems (usually the systems will be simulated on the computer). It was suggested by <a href="Charles_H._Bennett_(computer_scientist)" title="wikilink"> Charles H. Bennett</a> in 1976.<a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a></p>
<h2 id="preliminaries">Preliminaries</h2>

<p>Take a system in a certain super state. By performing a <a href="Metropolis_Monte_Carlo" title="wikilink">Metropolis Monte Carlo</a> walk it is possible to sample the landscape of states that the system moves between, using the equation</p>

<p>

<math display="block" id="Bennett_acceptance_ratio:0">
 <semantics>
  <mrow>
   <mi>p</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mtext>State</mtext>
     <mi>x</mi>
    </msub>
    <mo>→</mo>
    <msub>
     <mtext>State</mtext>
     <mi>y</mi>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>=</mo>
   <mi>min</mi>
   <mrow>
    <mo>(</mo>
    <msup>
     <mi>e</mi>
     <mrow>
      <mo>-</mo>
      <mrow>
       <mpadded width="+1.7pt">
        <mi>β</mi>
       </mpadded>
       <mi mathvariant="normal">Δ</mi>
       <mi>U</mi>
      </mrow>
     </mrow>
    </msup>
    <mo>,</mo>
    <mn>1</mn>
    <mo>)</mo>
   </mrow>
   <mo>=</mo>
   <mi>M</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mpadded width="+1.7pt">
     <mi>β</mi>
    </mpadded>
    <mi mathvariant="normal">Δ</mi>
    <mi>U</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">p</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <mtext>State</mtext>
      <ci>x</ci>
     </apply>
     <ci>normal-→</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <mtext>State</mtext>
      <ci>y</ci>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <eq></eq>
    <min></min>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>e</ci>
      <apply>
       <minus></minus>
       <apply>
        <times></times>
        <ci>β</ci>
        <ci>normal-Δ</ci>
        <ci>U</ci>
       </apply>
      </apply>
     </apply>
     <ci>normal-,</ci>
     <cn type="integer">1</cn>
     <ci>normal-)</ci>
    </cerror>
    <eq></eq>
    <csymbol cd="unknown">M</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">β</csymbol>
     <csymbol cd="unknown">Δ</csymbol>
     <csymbol cd="unknown">U</csymbol>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p(\text{State}_{x}\rightarrow\text{State}_{y})=\min\left(e^{-\beta\,\Delta U},%
1\right)=M(\beta\,\Delta U)
  </annotation>
 </semantics>
</math>

</p>

<p>where Δ<em>U</em> = <em>U</em>(State<sub><em>y</em></sub>) − <em>U</em>(State<sub><em>x</em></sub>) is the difference in potential energy, β = 1/<em>kT</em> (<em>T</em> is the temperature in <a class="uri" href="Kelvin" title="wikilink">Kelvin</a> while <em>k</em> is the <a href="Boltzmann_constant" title="wikilink">Boltzmann constant</a>), and 

<math display="inline" id="Bennett_acceptance_ratio:1">
 <semantics>
  <mrow>
   <mrow>
    <mi>M</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>x</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>≡</mo>
   <mrow>
    <mi>min</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <msup>
      <mi>e</mi>
      <mrow>
       <mo>-</mo>
       <mi>x</mi>
      </mrow>
     </msup>
     <mo>,</mo>
     <mn>1</mn>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <equivalent></equivalent>
    <apply>
     <times></times>
     <ci>M</ci>
     <ci>x</ci>
    </apply>
    <apply>
     <min></min>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>e</ci>
      <apply>
       <minus></minus>
       <ci>x</ci>
      </apply>
     </apply>
     <cn type="integer">1</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   M(x)\equiv\min(e^{-x},1)
  </annotation>
 </semantics>
</math>

 is the Metropolis function. The resulting states are then sampled according to the <a href="Boltzmann_distribution" title="wikilink">Boltzmann distribution</a> of the super state at temperature <em>T</em>. Alternatively, if the system is dynamically simulated in the <a href="canonical_ensemble" title="wikilink">canonical ensemble</a> (also called the <em>NVT</em> ensemble), the resulting states along the simulated trajectory are likewise distributed. Averaging along the trajectory (in either formulation) is denoted by angle brackets 

<math display="inline" id="Bennett_acceptance_ratio:2">
 <semantics>
  <mrow>
   <mo>⟨</mo>
   <mi mathvariant="normal">⋯</mi>
   <mo>⟩</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">delimited-⟨⟩</csymbol>
    <ci>normal-⋯</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \left\langle\cdots\right\rangle
  </annotation>
 </semantics>
</math>

.</p>

<p>Suppose that two super states of interest, A and B, are given. We assume that they have a common configuration space, i.e., they share all of their micro states, but the energies associated to these (and hence the probabilities) differ because of a change in some parameter (such as the strength of a certain interaction). The basic question to be addressed is, then, how can the <a href="Helmholtz_free_energy" title="wikilink">Helmholtz free energy</a> change (Δ<em>F</em> = <em>F</em><sub>B</sub> − <em>F</em><sub>A</sub>) on moving between the two super states be calculated from sampling in both ensembles? Note that the kinetic energy part in the free energy is equal between states so can be ignored. Note also that the <a href="Gibbs_free_energy" title="wikilink">Gibbs free energy</a> corresponds to the <em>NpT</em> ensemble.</p>
<h2 id="the-general-case">The general case</h2>

<p>Bennett shows that for every function <em>f</em> satisfying the condition 

<math display="inline" id="Bennett_acceptance_ratio:3">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mrow>
      <mi>f</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>x</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo>/</mo>
     <mi>f</mi>
    </mrow>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mo>-</mo>
      <mi>x</mi>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>≡</mo>
   <msup>
    <mi>e</mi>
    <mrow>
     <mo>-</mo>
     <mi>x</mi>
    </mrow>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <equivalent></equivalent>
    <apply>
     <times></times>
     <apply>
      <divide></divide>
      <apply>
       <times></times>
       <ci>f</ci>
       <ci>x</ci>
      </apply>
      <ci>f</ci>
     </apply>
     <apply>
      <minus></minus>
      <ci>x</ci>
     </apply>
    </apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>e</ci>
     <apply>
      <minus></minus>
      <ci>x</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f(x)/f(-x)\equiv e^{-x}
  </annotation>
 </semantics>
</math>

 (which is essentially the <a href="detailed_balance" title="wikilink">detailed balance</a> condition), and for every energy offset <em>C</em>, one has the exact relationship</p>

<p>

<math display="block" id="Bennett_acceptance_ratio:4">
 <semantics>
  <mrow>
   <msup>
    <mi>e</mi>
    <mrow>
     <mo>-</mo>
     <mrow>
      <mi>β</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mrow>
         <mi mathvariant="normal">Δ</mi>
         <mi>F</mi>
        </mrow>
        <mo>-</mo>
        <mi>C</mi>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mrow>
   </msup>
   <mo>=</mo>
   <mfrac>
    <msub>
     <mrow>
      <mo>⟨</mo>
      <mrow>
       <mi>f</mi>
       <mrow>
        <mo>(</mo>
        <mrow>
         <mi>β</mi>
         <mrow>
          <mo stretchy="false">(</mo>
          <mrow>
           <msub>
            <mi>U</mi>
            <mtext>B</mtext>
           </msub>
           <mo>-</mo>
           <msub>
            <mi>U</mi>
            <mtext>A</mtext>
           </msub>
           <mo>-</mo>
           <mi>C</mi>
          </mrow>
          <mo stretchy="false">)</mo>
         </mrow>
        </mrow>
        <mo>)</mo>
       </mrow>
      </mrow>
      <mo>⟩</mo>
     </mrow>
     <mtext>A</mtext>
    </msub>
    <msub>
     <mrow>
      <mo>⟨</mo>
      <mrow>
       <mi>f</mi>
       <mrow>
        <mo>(</mo>
        <mrow>
         <mi>β</mi>
         <mrow>
          <mo stretchy="false">(</mo>
          <mrow>
           <mrow>
            <msub>
             <mi>U</mi>
             <mtext>A</mtext>
            </msub>
            <mo>-</mo>
            <msub>
             <mi>U</mi>
             <mtext>B</mtext>
            </msub>
           </mrow>
           <mo>+</mo>
           <mi>C</mi>
          </mrow>
          <mo stretchy="false">)</mo>
         </mrow>
        </mrow>
        <mo>)</mo>
       </mrow>
      </mrow>
      <mo>⟩</mo>
     </mrow>
     <mtext>B</mtext>
    </msub>
   </mfrac>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>e</ci>
     <apply>
      <minus></minus>
      <apply>
       <times></times>
       <ci>β</ci>
       <apply>
        <minus></minus>
        <apply>
         <times></times>
         <ci>normal-Δ</ci>
         <ci>F</ci>
        </apply>
        <ci>C</ci>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <divide></divide>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <csymbol cd="latexml">delimited-⟨⟩</csymbol>
       <apply>
        <times></times>
        <ci>f</ci>
        <apply>
         <times></times>
         <ci>β</ci>
         <apply>
          <minus></minus>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>U</ci>
           <mtext>B</mtext>
          </apply>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>U</ci>
           <mtext>A</mtext>
          </apply>
          <ci>C</ci>
         </apply>
        </apply>
       </apply>
      </apply>
      <mtext>A</mtext>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <csymbol cd="latexml">delimited-⟨⟩</csymbol>
       <apply>
        <times></times>
        <ci>f</ci>
        <apply>
         <times></times>
         <ci>β</ci>
         <apply>
          <plus></plus>
          <apply>
           <minus></minus>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <ci>U</ci>
            <mtext>A</mtext>
           </apply>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <ci>U</ci>
            <mtext>B</mtext>
           </apply>
          </apply>
          <ci>C</ci>
         </apply>
        </apply>
       </apply>
      </apply>
      <mtext>B</mtext>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   e^{-\beta(\Delta F-C)}=\frac{\left\langle f\left(\beta(U_{\text{B}}-U_{\text{A%
}}-C)\right)\right\rangle_{\text{A}}}{\left\langle f\left(\beta(U_{\text{A}}-U%
_{\text{B}}+C)\right)\right\rangle_{\text{B}}}
  </annotation>
 </semantics>
</math>

</p>

<p>where <em>U</em><sub>A</sub> and <em>U</em><sub>B</sub> are the potential energies of the same configurations, calculated using potential function A (when the system is in superstate A) and potential function B (when the system is in the superstate B) respectively.</p>
<h2 id="the-basic-case">The basic case</h2>

<p>Substituting for <em>f</em> the Metropolis function defined above (which satisfies the detailed balance condition), and setting <em>C</em> to zero, gives</p>

<p>

<math display="block" id="Bennett_acceptance_ratio:5">
 <semantics>
  <mrow>
   <msup>
    <mi>e</mi>
    <mrow>
     <mo>-</mo>
     <mrow>
      <mi>β</mi>
      <mi mathvariant="normal">Δ</mi>
      <mi>F</mi>
     </mrow>
    </mrow>
   </msup>
   <mo>=</mo>
   <mfrac>
    <msub>
     <mrow>
      <mo>⟨</mo>
      <mrow>
       <mi>M</mi>
       <mrow>
        <mo>(</mo>
        <mrow>
         <mi>β</mi>
         <mrow>
          <mo stretchy="false">(</mo>
          <mrow>
           <msub>
            <mi>U</mi>
            <mtext>B</mtext>
           </msub>
           <mo>-</mo>
           <msub>
            <mi>U</mi>
            <mtext>A</mtext>
           </msub>
          </mrow>
          <mo stretchy="false">)</mo>
         </mrow>
        </mrow>
        <mo>)</mo>
       </mrow>
      </mrow>
      <mo>⟩</mo>
     </mrow>
     <mtext>A</mtext>
    </msub>
    <msub>
     <mrow>
      <mo>⟨</mo>
      <mrow>
       <mi>M</mi>
       <mrow>
        <mo>(</mo>
        <mrow>
         <mi>β</mi>
         <mrow>
          <mo stretchy="false">(</mo>
          <mrow>
           <msub>
            <mi>U</mi>
            <mtext>A</mtext>
           </msub>
           <mo>-</mo>
           <msub>
            <mi>U</mi>
            <mtext>B</mtext>
           </msub>
          </mrow>
          <mo stretchy="false">)</mo>
         </mrow>
        </mrow>
        <mo>)</mo>
       </mrow>
      </mrow>
      <mo>⟩</mo>
     </mrow>
     <mtext>B</mtext>
    </msub>
   </mfrac>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>e</ci>
     <apply>
      <minus></minus>
      <apply>
       <times></times>
       <ci>β</ci>
       <ci>normal-Δ</ci>
       <ci>F</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <divide></divide>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <csymbol cd="latexml">delimited-⟨⟩</csymbol>
       <apply>
        <times></times>
        <ci>M</ci>
        <apply>
         <times></times>
         <ci>β</ci>
         <apply>
          <minus></minus>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>U</ci>
           <mtext>B</mtext>
          </apply>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>U</ci>
           <mtext>A</mtext>
          </apply>
         </apply>
        </apply>
       </apply>
      </apply>
      <mtext>A</mtext>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <csymbol cd="latexml">delimited-⟨⟩</csymbol>
       <apply>
        <times></times>
        <ci>M</ci>
        <apply>
         <times></times>
         <ci>β</ci>
         <apply>
          <minus></minus>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>U</ci>
           <mtext>A</mtext>
          </apply>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>U</ci>
           <mtext>B</mtext>
          </apply>
         </apply>
        </apply>
       </apply>
      </apply>
      <mtext>B</mtext>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   e^{-\beta\Delta F}=\frac{\left\langle M\left(\beta(U_{\text{B}}-U_{\text{A}})%
\right)\right\rangle_{\text{A}}}{\left\langle M\left(\beta(U_{\text{A}}-U_{%
\text{B}})\right)\right\rangle_{\text{B}}}
  </annotation>
 </semantics>
</math>

</p>

<p>The advantage of this formulation (apart from its simplicity) is that it can be computed without performing two simulations, one in each specific ensemble. Indeed, it is possible to define an extra kind of "potential switching" Metropolis trial move (taken every fixed number of steps), such that the single sampling from the "mixed" ensemble suffices for the computation.</p>
<h2 id="the-most-efficient-case">The most efficient case</h2>

<p>Bennett explores which specific expression for Δ<em>F</em> is the most efficient, in the sense of yielding the smallest standard error for a given simulation time. He shows that the optimal choice is to take</p>
<ol>
<li>

<math display="inline" id="Bennett_acceptance_ratio:6">
 <semantics>
  <mrow>
   <mrow>
    <mi>f</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>x</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>≡</mo>
   <mfrac>
    <mn>1</mn>
    <mrow>
     <mn>1</mn>
     <mo>+</mo>
     <msup>
      <mi>e</mi>
      <mi>x</mi>
     </msup>
    </mrow>
   </mfrac>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <equivalent></equivalent>
    <apply>
     <times></times>
     <ci>f</ci>
     <ci>x</ci>
    </apply>
    <apply>
     <divide></divide>
     <cn type="integer">1</cn>
     <apply>
      <plus></plus>
      <cn type="integer">1</cn>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>e</ci>
       <ci>x</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f(x)\equiv\frac{1}{1+e^{x}}
  </annotation>
 </semantics>
</math>

, which is essentially the <a href="Fermi–Dirac_statistics#Fermi–Dirac_distribution" title="wikilink"> Fermi–Dirac distribution</a> (satisfying indeed the detailed balance condition).</li>
<li>

<math display="inline" id="Bennett_acceptance_ratio:7">
 <semantics>
  <mrow>
   <mi>C</mi>
   <mo>≈</mo>
   <mrow>
    <mi mathvariant="normal">Δ</mi>
    <mi>F</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <approx></approx>
    <ci>C</ci>
    <apply>
     <times></times>
     <ci>normal-Δ</ci>
     <ci>F</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   C\approx\Delta F
  </annotation>
 </semantics>
</math>

. This value, of course, is not known (it is exactly what one is trying to compute), but it can be approximately chosen in a self-consistent manner.</li>
</ol>

<p>Some assumptions needed for the efficiency are the following:</p>
<ol>
<li>The densities of the two super states (in their common configuration space) should have a large overlap. Otherwise, a chain of super states between A and B may be needed, such that the overlap of each two consecutive super states is adequate.</li>
<li>The sample size should be large. In particular, as successive states are correlated, the simulation time should be much larger than the correlation time.</li>
<li>The cost of simulating both ensembles should be approximately equal - and then, in fact, the system is sampled roughly equally in both super states. Otherwise, the optimal expression for <em>C</em> is modified, and the sampling should devote equal times (rather than equal number of time steps) to the two ensembles.</li>
</ol>
<h2 id="multistate-bennett-acceptance-ratio">Multistate Bennett acceptance ratio</h2>

<p>The multistate Bennett acceptance ratio (<strong>MBAR</strong>) is a generalization of the Bennett acceptance ratio that calculates the (relative) free energies of several multi states. It essentially reduces to the BAR method when only two super states are involved.</p>
<h2 id="relation-to-other-methods">Relation to other methods</h2>
<h3 id="the-perturbation-theory-method">The perturbation theory method</h3>

<p>This method, also called <a href="Free_energy_perturbation" title="wikilink">Free energy perturbation</a> (or FEP), involves sampling from state A only. Unsurprisingly, it might be much less efficient than the BAR method. In fact, it requires that all the high probability configurations of super state B are contained in high probability configurations of super state A, which is a much more stringent requirement than the overlap condition stated above.</p>
<h4 id="the-exact-infinite-order-result">The exact (infinite order) result</h4>

<p>

<math display="block" id="Bennett_acceptance_ratio:8">
 <semantics>
  <mrow>
   <msup>
    <mi>e</mi>
    <mrow>
     <mo>-</mo>
     <mrow>
      <mi>β</mi>
      <mi mathvariant="normal">Δ</mi>
      <mi>F</mi>
     </mrow>
    </mrow>
   </msup>
   <mo>=</mo>
   <msub>
    <mrow>
     <mo>⟨</mo>
     <msup>
      <mi>e</mi>
      <mrow>
       <mo>-</mo>
       <mrow>
        <mi>β</mi>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <msub>
           <mi>U</mi>
           <mtext>B</mtext>
          </msub>
          <mo>-</mo>
          <msub>
           <mi>U</mi>
           <mtext>A</mtext>
          </msub>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
      </mrow>
     </msup>
     <mo>⟩</mo>
    </mrow>
    <mtext>A</mtext>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>e</ci>
     <apply>
      <minus></minus>
      <apply>
       <times></times>
       <ci>β</ci>
       <ci>normal-Δ</ci>
       <ci>F</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <csymbol cd="latexml">delimited-⟨⟩</csymbol>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>e</ci>
       <apply>
        <minus></minus>
        <apply>
         <times></times>
         <ci>β</ci>
         <apply>
          <minus></minus>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>U</ci>
           <mtext>B</mtext>
          </apply>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>U</ci>
           <mtext>A</mtext>
          </apply>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
     <mtext>A</mtext>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   e^{-\beta\Delta F}=\left\langle e^{-\beta(U_{\text{B}}-U_{\text{A}})}\right%
\rangle_{\text{A}}
  </annotation>
 </semantics>
</math>

 or</p>

<p>

<math display="block" id="Bennett_acceptance_ratio:9">
 <semantics>
  <mrow>
   <mi mathvariant="normal">Δ</mi>
   <mi>F</mi>
   <mo>=</mo>
   <mo>-</mo>
   <mi>k</mi>
   <mi>T</mi>
   <mo>⋅</mo>
   <mi>log</mi>
   <msub>
    <mrow>
     <mo>⟨</mo>
     <msup>
      <mi>e</mi>
      <mrow>
       <mi>β</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <msub>
          <mi>U</mi>
          <mtext>A</mtext>
         </msub>
         <mo>-</mo>
         <msub>
          <mi>U</mi>
          <mtext>B</mtext>
         </msub>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
     </msup>
     <mo>⟩</mo>
    </mrow>
    <mtext>A</mtext>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">Δ</csymbol>
    <csymbol cd="unknown">F</csymbol>
    <eq></eq>
    <minus></minus>
    <csymbol cd="unknown">k</csymbol>
    <csymbol cd="unknown">T</csymbol>
    <ci>normal-⋅</ci>
    <log></log>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <ci>normal-⟨</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>e</ci>
       <apply>
        <times></times>
        <ci>β</ci>
        <apply>
         <minus></minus>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>U</ci>
          <mtext>A</mtext>
         </apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>U</ci>
          <mtext>B</mtext>
         </apply>
        </apply>
       </apply>
      </apply>
      <ci>normal-⟩</ci>
     </cerror>
     <mtext>A</mtext>
    </apply>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Delta F=-kT\cdot\log\left\langle e^{\beta(U_{\text{A}}-U_{\text{B}})}\right%
\rangle_{\text{A}}
  </annotation>
 </semantics>
</math>

</p>

<p>This exact result can be obtained from the general BAR method, using (for example) the Metropolis function, in the limit 

<math display="inline" id="Bennett_acceptance_ratio:10">
 <semantics>
  <mrow>
   <mi>C</mi>
   <mo>→</mo>
   <mrow>
    <mo>-</mo>
    <mi mathvariant="normal">∞</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-→</ci>
    <ci>C</ci>
    <apply>
     <minus></minus>
     <infinity></infinity>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   C\rightarrow-\infty
  </annotation>
 </semantics>
</math>

. Indeed, in that case, the denominator of the general case expression above tends to 1, while the numerator tends to 

<math display="inline" id="Bennett_acceptance_ratio:11">
 <semantics>
  <mrow>
   <msup>
    <mi>e</mi>
    <mrow>
     <mi>β</mi>
     <mi>C</mi>
    </mrow>
   </msup>
   <msub>
    <mrow>
     <mo>⟨</mo>
     <msup>
      <mi>e</mi>
      <mrow>
       <mo>-</mo>
       <mrow>
        <mi>β</mi>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <msub>
           <mi>U</mi>
           <mtext>B</mtext>
          </msub>
          <mo>-</mo>
          <msub>
           <mi>U</mi>
           <mtext>A</mtext>
          </msub>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
      </mrow>
     </msup>
     <mo>⟩</mo>
    </mrow>
    <mtext>A</mtext>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>e</ci>
     <apply>
      <times></times>
      <ci>β</ci>
      <ci>C</ci>
     </apply>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <csymbol cd="latexml">delimited-⟨⟩</csymbol>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>e</ci>
       <apply>
        <minus></minus>
        <apply>
         <times></times>
         <ci>β</ci>
         <apply>
          <minus></minus>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>U</ci>
           <mtext>B</mtext>
          </apply>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>U</ci>
           <mtext>A</mtext>
          </apply>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
     <mtext>A</mtext>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   e^{\beta C}\left\langle e^{-\beta(U_{\text{B}}-U_{\text{A}})}\right\rangle_{%
\text{A}}
  </annotation>
 </semantics>
</math>

. A direct derivation from the definitions is more straightforward, though.</p>
<h4 id="the-second-order-approximate-result">The second order (approximate) result</h4>

<p>Assuming that 

<math display="inline" id="Bennett_acceptance_ratio:12">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>U</mi>
     <mtext>B</mtext>
    </msub>
    <mo>-</mo>
    <msub>
     <mi>U</mi>
     <mtext>A</mtext>
    </msub>
   </mrow>
   <mo>≪</mo>
   <mrow>
    <mi>k</mi>
    <mi>T</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">much-less-than</csymbol>
    <apply>
     <minus></minus>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>U</ci>
      <mtext>B</mtext>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>U</ci>
      <mtext>A</mtext>
     </apply>
    </apply>
    <apply>
     <times></times>
     <ci>k</ci>
     <ci>T</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   U_{\text{B}}-U_{\text{A}}\ll kT
  </annotation>
 </semantics>
</math>

 and Taylor expanding the second exact perturbation theory expression to the second order, one gets the approximation</p>

<p>

<math display="block" id="Bennett_acceptance_ratio:13">
 <semantics>
  <mrow>
   <mrow>
    <mi mathvariant="normal">Δ</mi>
    <mi>F</mi>
   </mrow>
   <mo>≈</mo>
   <mrow>
    <msub>
     <mrow>
      <mo>⟨</mo>
      <mrow>
       <msub>
        <mi>U</mi>
        <mtext>B</mtext>
       </msub>
       <mo>-</mo>
       <msub>
        <mi>U</mi>
        <mtext>A</mtext>
       </msub>
      </mrow>
      <mo>⟩</mo>
     </mrow>
     <mtext>A</mtext>
    </msub>
    <mo>-</mo>
    <mrow>
     <mfrac>
      <mi>β</mi>
      <mn>2</mn>
     </mfrac>
     <mrow>
      <mo>(</mo>
      <mrow>
       <msub>
        <mrow>
         <mo>⟨</mo>
         <msup>
          <mrow>
           <mo stretchy="false">(</mo>
           <mrow>
            <msub>
             <mi>U</mi>
             <mtext>B</mtext>
            </msub>
            <mo>-</mo>
            <msub>
             <mi>U</mi>
             <mtext>A</mtext>
            </msub>
           </mrow>
           <mo stretchy="false">)</mo>
          </mrow>
          <mn>2</mn>
         </msup>
         <mo>⟩</mo>
        </mrow>
        <mtext>A</mtext>
       </msub>
       <mo>-</mo>
       <msup>
        <mrow>
         <mo>(</mo>
         <msub>
          <mrow>
           <mo>⟨</mo>
           <mrow>
            <mo stretchy="false">(</mo>
            <mrow>
             <msub>
              <mi>U</mi>
              <mtext>B</mtext>
             </msub>
             <mo>-</mo>
             <msub>
              <mi>U</mi>
              <mtext>A</mtext>
             </msub>
            </mrow>
            <mo stretchy="false">)</mo>
           </mrow>
           <mo>⟩</mo>
          </mrow>
          <mtext>A</mtext>
         </msub>
         <mo>)</mo>
        </mrow>
        <mn>2</mn>
       </msup>
      </mrow>
      <mo>)</mo>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <approx></approx>
    <apply>
     <times></times>
     <ci>normal-Δ</ci>
     <ci>F</ci>
    </apply>
    <apply>
     <minus></minus>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <csymbol cd="latexml">delimited-⟨⟩</csymbol>
       <apply>
        <minus></minus>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>U</ci>
         <mtext>B</mtext>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>U</ci>
         <mtext>A</mtext>
        </apply>
       </apply>
      </apply>
      <mtext>A</mtext>
     </apply>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <ci>β</ci>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <minus></minus>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <apply>
         <csymbol cd="latexml">delimited-⟨⟩</csymbol>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <apply>
           <minus></minus>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <ci>U</ci>
            <mtext>B</mtext>
           </apply>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <ci>U</ci>
            <mtext>A</mtext>
           </apply>
          </apply>
          <cn type="integer">2</cn>
         </apply>
        </apply>
        <mtext>A</mtext>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <apply>
          <csymbol cd="latexml">delimited-⟨⟩</csymbol>
          <apply>
           <minus></minus>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <ci>U</ci>
            <mtext>B</mtext>
           </apply>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <ci>U</ci>
            <mtext>A</mtext>
           </apply>
          </apply>
         </apply>
         <mtext>A</mtext>
        </apply>
        <cn type="integer">2</cn>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Delta F\approx\left\langle U_{\text{B}}-U_{\text{A}}\right\rangle_{\text{A}}-%
\frac{\beta}{2}\left(\left\langle(U_{\text{B}}-U_{\text{A}})^{2}\right\rangle_%
{\text{A}}-\left(\left\langle(U_{\text{B}}-U_{\text{A}})\right\rangle_{\text{A%
}}\right)^{2}\right)
  </annotation>
 </semantics>
</math>

</p>

<p>Note that the first term is the expected value of the energy difference, while the second is essentially its variance.</p>
<h4 id="the-first-order-inequalities">The first order inequalities</h4>

<p>Using the convexity of the log function appearing in the exact perturbation analysis result, together with <a href="Jensen's_inequality" title="wikilink">Jensen's inequality</a>, gives an inequality in the linear level; combined with the analogous result for the B ensemble one gets the following version of the <a href="Helmholtz_free_energy#Bogoliubov_inequality" title="wikilink"> Gibbs-Bogoliubov inequality</a>:</p>

<p>

<math display="block" id="Bennett_acceptance_ratio:14">
 <semantics>
  <mrow>
   <msub>
    <mrow>
     <mo stretchy="false">⟨</mo>
     <mrow>
      <msub>
       <mi>U</mi>
       <mtext>B</mtext>
      </msub>
      <mo>-</mo>
      <msub>
       <mi>U</mi>
       <mtext>A</mtext>
      </msub>
     </mrow>
     <mo stretchy="false">⟩</mo>
    </mrow>
    <mtext>B</mtext>
   </msub>
   <mo>≤</mo>
   <mrow>
    <mi mathvariant="normal">Δ</mi>
    <mi>F</mi>
   </mrow>
   <mo>≤</mo>
   <msub>
    <mrow>
     <mo stretchy="false">⟨</mo>
     <mrow>
      <msub>
       <mi>U</mi>
       <mtext>B</mtext>
      </msub>
      <mo>-</mo>
      <msub>
       <mi>U</mi>
       <mtext>A</mtext>
      </msub>
     </mrow>
     <mo stretchy="false">⟩</mo>
    </mrow>
    <mtext>A</mtext>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <leq></leq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <csymbol cd="latexml">delimited-⟨⟩</csymbol>
       <apply>
        <minus></minus>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>U</ci>
         <mtext>B</mtext>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>U</ci>
         <mtext>A</mtext>
        </apply>
       </apply>
      </apply>
      <mtext>B</mtext>
     </apply>
     <apply>
      <times></times>
      <ci>normal-Δ</ci>
      <ci>F</ci>
     </apply>
    </apply>
    <apply>
     <leq></leq>
     <share href="#.cmml">
     </share>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <csymbol cd="latexml">delimited-⟨⟩</csymbol>
       <apply>
        <minus></minus>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>U</ci>
         <mtext>B</mtext>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>U</ci>
         <mtext>A</mtext>
        </apply>
       </apply>
      </apply>
      <mtext>A</mtext>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \langle U_{\text{B}}-U_{\text{A}}\rangle_{\text{B}}\leq\Delta F\leq\langle U_{%
\text{B}}-U_{\text{A}}\rangle_{\text{A}}
  </annotation>
 </semantics>
</math>

</p>

<p>Note that the inequality agrees with the negative sign of the coefficient of the (positive) variance term in the second order result.</p>
<h3 id="the-thermodynamic-integration-method">The thermodynamic integration method</h3>

<p>writing the potential energy as depending on a continuous parameter, 

<math display="inline" id="Bennett_acceptance_ratio:15">
 <semantics>
  <mrow>
   <msub>
    <mi>U</mi>
    <mtext>A</mtext>
   </msub>
   <mo>=</mo>
   <mi>U</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>λ</mi>
    <mo>=</mo>
    <mn>0</mn>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>,</mo>
   <msub>
    <mi>U</mi>
    <mtext>B</mtext>
   </msub>
   <mo>=</mo>
   <mi>U</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>λ</mi>
    <mo>=</mo>
    <mn>1</mn>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>U</ci>
     <mtext>A</mtext>
    </apply>
    <eq></eq>
    <csymbol cd="unknown">U</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">λ</csymbol>
     <eq></eq>
     <cn type="integer">0</cn>
     <ci>normal-)</ci>
    </cerror>
    <ci>normal-,</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>U</ci>
     <mtext>B</mtext>
    </apply>
    <eq></eq>
    <csymbol cd="unknown">U</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">λ</csymbol>
     <eq></eq>
     <cn type="integer">1</cn>
     <ci>normal-)</ci>
    </cerror>
    <ci>normal-,</ci>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   U_{\text{A}}=U(\lambda=0),U_{\text{B}}=U(\lambda=1),
  </annotation>
 </semantics>
</math>

</p>

<p>one has the exact result 

<math display="inline" id="Bennett_acceptance_ratio:16">
 <semantics>
  <mrow>
   <mfrac>
    <mrow>
     <mtext>Part IFIF</mtext>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>λ</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mtext>Part IIλIIλ</mtext>
   </mfrac>
   <mo>=</mo>
   <msub>
    <mrow>
     <mo>⟨</mo>
     <mfrac>
      <mrow>
       <mtext>Part IIIUIIIU</mtext>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>λ</mi>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
      <mtext>Part IVλIVλ</mtext>
     </mfrac>
     <mo>⟩</mo>
    </mrow>
    <mi>λ</mi>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <divide></divide>
     <apply>
      <times></times>
      <mtext>Part IFIF</mtext>
      <ci>λ</ci>
     </apply>
     <mtext>Part IIλIIλ</mtext>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <csymbol cd="latexml">delimited-⟨⟩</csymbol>
      <apply>
       <divide></divide>
       <apply>
        <times></times>
        <mtext>Part IIIUIIIU</mtext>
        <ci>λ</ci>
       </apply>
       <mtext>Part IVλIVλ</mtext>
      </apply>
     </apply>
     <ci>λ</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \frac{\@@section{part}{Pt1}{I}{Part~I}{{\@tag[][]{I}F}}{{\@tag[][]{Part~I}F}}(%
\lambda)}{\@@section{part}{Pt2}{II}{Part~II}{{\@tag[][]{II}\lambda}}{{\@tag[][%
]{Part~II}\lambda}}}=\left\langle\frac{\@@section{part}{Pt3}{III}{Part~III}{{%
\@tag[][]{III}U}}{{\@tag[][]{Part~III}U}}(\lambda)}{\@@section{part}{Pt4}{IV}{%
Part~IV}{{\@tag[][]{IV}\lambda}}{{\@tag[][]{Part~IV}\lambda}}}\right\rangle_{\lambda}
  </annotation>
 </semantics>
</math>

 This can either be directly verified from definitions or seen from the limit of the above Gibbs-Bogoliubov inequalities when 

<math display="inline" id="Bennett_acceptance_ratio:17">
 <semantics>
  <mrow>
   <mrow>
    <mtext>A</mtext>
    <mo>=</mo>
    <msup>
     <mi>λ</mi>
     <mo>+</mo>
    </msup>
   </mrow>
   <mo>,</mo>
   <mrow>
    <mtext>B</mtext>
    <mo>=</mo>
    <msup>
     <mi>λ</mi>
     <mo>-</mo>
    </msup>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <eq></eq>
     <mtext>A</mtext>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>λ</ci>
      <plus></plus>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <mtext>B</mtext>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>λ</ci>
      <minus></minus>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \text{A}=\lambda^{+},\text{B}=\lambda^{-}
  </annotation>
 </semantics>
</math>

. we can therefore write</p>

<p>

<math display="block" id="Bennett_acceptance_ratio:18">
 <semantics>
  <mrow>
   <mrow>
    <mi mathvariant="normal">Δ</mi>
    <mi>F</mi>
   </mrow>
   <mo>=</mo>
   <mrow>
    <msubsup>
     <mo largeop="true" symmetric="true">∫</mo>
     <mn>0</mn>
     <mn>1</mn>
    </msubsup>
    <mrow>
     <mrow>
      <mo>⟨</mo>
      <mfrac>
       <mrow>
        <mtext>
         P
                                  a
                                  r
                                  t
                                   
                                  V
                                
                                U
                              
                              
                                
                                  V
                                
                                U
        </mtext>
        <mrow>
         <mo stretchy="false">(</mo>
         <mi>λ</mi>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
       <mtext>
        P
                                a
                                r
                                t
                                 
                                V
                                I
                              
                              λ
                            
                            
                              
                                V
                                I
                              
                              λ
       </mtext>
      </mfrac>
      <mo rspace="4.2pt">⟩</mo>
     </mrow>
     <mi>d</mi>
     <mi>λ</mi>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>normal-Δ</ci>
     <ci>F</ci>
    </apply>
    <apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <int></int>
       <cn type="integer">0</cn>
      </apply>
      <cn type="integer">1</cn>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="latexml">delimited-⟨⟩</csymbol>
       <apply>
        <divide></divide>
        <apply>
         <times></times>
         <mtext>
          P
                                  a
                                  r
                                  t
                                   
                                  V
                                
                                U
                              
                              
                                
                                  V
                                
                                U
         </mtext>
         <ci>λ</ci>
        </apply>
        <mtext>
         P
                                a
                                r
                                t
                                 
                                V
                                I
                              
                              λ
                            
                            
                              
                                V
                                I
                              
                              λ
        </mtext>
       </apply>
      </apply>
      <ci>d</ci>
      <ci>λ</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Delta F=\int_{0}^{1}\left\langle\frac{\@@section{part}{Pt5}{V}{Part~V}{{\@tag%
[][]{V}U}}{{\@tag[][]{Part~V}U}}(\lambda)}{\@@section{part}{Pt6}{VI}{Part~VI}{%
{\@tag[][]{VI}\lambda}}{{\@tag[][]{Part~VI}\lambda}}}\right\rangle\,d\lambda
  </annotation>
 </semantics>
</math>

</p>

<p>which is the <a href="thermodynamic_integration" title="wikilink">thermodynamic integration</a> (or TI) result. It can be approximated by dividing the range between states A and B into many values of λ at which the expectation value is estimated, and performing numerical integration.</p>
<h2 id="implementation">Implementation</h2>

<p>The Bennett acceptance ratio method is implemented in modern <a href="molecular_dynamics" title="wikilink">molecular dynamics</a> systems, such as <a class="uri" href="Gromacs" title="wikilink">Gromacs</a>. Python-based code for MBAR and BAR is available for download at <a href="https://simtk.org/home/pymbar">1</a>.</p>
<h2 id="references">References</h2>
<h2 id="external-links">External links</h2>
<ul>
<li><a href="http://www.alchemistry.org/wiki/Bennett_Acceptance_Ratio">Bennett Acceptance Ratio</a> from AlchemistryWiki.</li>
<li><a href="http://www.alchemistry.org/wiki/Multistate_Bennett_Acceptance_Ratio">Multistate Bennett Acceptance Ratio</a> from AlchemistryWiki.</li>
</ul>

<p>"</p>

<p><a class="uri" href="Category:Thermodynamics" title="wikilink">Category:Thermodynamics</a> <a href="Category:Statistical_mechanics" title="wikilink">Category:Statistical mechanics</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1"></li>
</ol>
</section>
</body>
</html>

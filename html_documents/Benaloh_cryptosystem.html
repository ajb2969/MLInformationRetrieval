<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="822">Benaloh cryptosystem</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Benaloh cryptosystem</h1>
<hr/>

<p>The <strong>Benaloh Cryptosystem</strong> is an extension of the <a href="Goldwasser-Micali_cryptosystem" title="wikilink">Goldwasser-Micali cryptosystem</a> (GM) created in 1994 by Josh (Cohen) Benaloh. The main improvement of the Benaloh Cryptosystem over GM is that longer blocks of data can be encrypted at once, whereas in GM each bit is encrypted individually.<a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a></p>
<h2 id="scheme-definition">Scheme Definition</h2>

<p>Like many <a href="Public_key_cryptography" title="wikilink">public key cryptosystems</a>, this scheme works in the group 

<math display="inline" id="Benaloh_cryptosystem:0">
 <semantics>
  <msup>
   <mrow>
    <mo stretchy="false">(</mo>
    <mrow>
     <mrow>
      <mi>ℤ</mi>
      <mo>/</mo>
      <mi>n</mi>
     </mrow>
     <mi>ℤ</mi>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>*</mo>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <apply>
     <times></times>
     <apply>
      <divide></divide>
      <ci>ℤ</ci>
      <ci>n</ci>
     </apply>
     <ci>ℤ</ci>
    </apply>
    <times></times>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (\mathbb{Z}/n\mathbb{Z})^{*}
  </annotation>
 </semantics>
</math>

 where <em>n</em> is a product of two large <a href="Prime_number" title="wikilink">primes</a>. This scheme is <a href="Homomorphic_encryption" title="wikilink">homomorphic</a> and hence <a href="Malleability_(cryptography)" title="wikilink">malleable</a>.</p>
<h3 id="key-generation">Key Generation</h3>

<p>Given block size <em>r</em>, a public/private key pair is generated as follows:</p>
<ol>
<li>Choose large primes <em>p</em> and <em>q</em> such that 

<math display="inline" id="Benaloh_cryptosystem:1">
 <semantics>
  <mrow>
   <mi>r</mi>
   <mo stretchy="false">|</mo>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>p</mi>
    <mo>-</mo>
    <mn>1</mn>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>,</mo>
   <mo>gcd</mo>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>r</mi>
    <mo>,</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>p</mi>
     <mo>-</mo>
     <mn>1</mn>
     <mo stretchy="false">)</mo>
    </mrow>
    <mo>/</mo>
    <mi>r</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>=</mo>
   <mn>1</mn>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">r</csymbol>
    <ci>normal-|</ci>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">p</csymbol>
     <minus></minus>
     <cn type="integer">1</cn>
     <ci>normal-)</ci>
    </cerror>
    <ci>normal-,</ci>
    <ci>gcd</ci>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">r</csymbol>
     <ci>normal-,</ci>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <ci>normal-(</ci>
      <csymbol cd="unknown">p</csymbol>
      <minus></minus>
      <cn type="integer">1</cn>
      <ci>normal-)</ci>
     </cerror>
     <divide></divide>
     <csymbol cd="unknown">r</csymbol>
     <ci>normal-)</ci>
    </cerror>
    <eq></eq>
    <cn type="integer">1</cn>
    <ci>normal-,</ci>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   r|(p-1),\operatorname{gcd}(r,(p-1)/r)=1,
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Benaloh_cryptosystem:2">
 <semantics>
  <mrow>
   <mrow>
    <mo>gcd</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>r</mi>
     <mo>,</mo>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mi>q</mi>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <ci>gcd</ci>
     <ci>r</ci>
     <apply>
      <minus></minus>
      <ci>q</ci>
      <cn type="integer">1</cn>
     </apply>
    </apply>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \operatorname{gcd}(r,(q-1))=1
  </annotation>
 </semantics>
</math>

</li>
<li>Set 

<math display="inline" id="Benaloh_cryptosystem:3">
 <semantics>
  <mrow>
   <mrow>
    <mi>n</mi>
    <mo>=</mo>
    <mrow>
     <mi>p</mi>
     <mi>q</mi>
    </mrow>
   </mrow>
   <mo>,</mo>
   <mrow>
    <mi>ϕ</mi>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mi>p</mi>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mi>q</mi>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <eq></eq>
     <ci>n</ci>
     <apply>
      <times></times>
      <ci>p</ci>
      <ci>q</ci>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <ci>ϕ</ci>
     <apply>
      <times></times>
      <apply>
       <minus></minus>
       <ci>p</ci>
       <cn type="integer">1</cn>
      </apply>
      <apply>
       <minus></minus>
       <ci>q</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n=pq,\phi=(p-1)(q-1)
  </annotation>
 </semantics>
</math>


</li>
<li>Choose 

<math display="inline" id="Benaloh_cryptosystem:4">
 <semantics>
  <mrow>
   <mi>y</mi>
   <mo>∈</mo>
   <msubsup>
    <mi>ℤ</mi>
    <mi>n</mi>
    <mo>*</mo>
   </msubsup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <in></in>
    <ci>y</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>ℤ</ci>
      <times></times>
     </apply>
     <ci>n</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   y\in\mathbb{Z}^{*}_{n}
  </annotation>
 </semantics>
</math>

 such that 

<math display="inline" id="Benaloh_cryptosystem:5">
 <semantics>
  <mrow>
   <msup>
    <mi>y</mi>
    <mrow>
     <mi>ϕ</mi>
     <mo>/</mo>
     <mi>r</mi>
    </mrow>
   </msup>
   <mo>≢</mo>
   <mrow>
    <mn>1</mn>
    <mo lspace="2.5pt" rspace="2.5pt">mod</mo>
    <mi>n</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">not-equivalent-to</csymbol>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>y</ci>
     <apply>
      <divide></divide>
      <ci>ϕ</ci>
      <ci>r</ci>
     </apply>
    </apply>
    <apply>
     <csymbol cd="latexml">modulo</csymbol>
     <cn type="integer">1</cn>
     <ci>n</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   y^{\phi/r}\not\equiv 1\mod n
  </annotation>
 </semantics>
</math>

.</li>
</ol>
<dl>
<dd><dl>
<dd><strong>Note:</strong> If <em>r</em> is composite, it was pointed out by Fousse et al. in 2011<a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a> that the above conditions (i.e., those stated in the original paper) are insufficient to guarantee correct decryption, i.e., to guarantee that 

<math display="inline" id="Benaloh_cryptosystem:6">
 <semantics>
  <mrow>
   <mrow>
    <mi>D</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>E</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>m</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mi>m</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>D</ci>
     <apply>
      <times></times>
      <ci>E</ci>
      <ci>m</ci>
     </apply>
    </apply>
    <ci>m</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   D(E(m))=m
  </annotation>
 </semantics>
</math>

 in all cases (as should be the case). To address this, the authors propose the following check: let 

<math display="inline" id="Benaloh_cryptosystem:7">
 <semantics>
  <mrow>
   <mi>r</mi>
   <mo>=</mo>
   <mrow>
    <msub>
     <mi>p</mi>
     <mn>1</mn>
    </msub>
    <msub>
     <mi>p</mi>
     <mn>2</mn>
    </msub>
    <mi mathvariant="normal">…</mi>
    <msub>
     <mi>p</mi>
     <mi>k</mi>
    </msub>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>r</ci>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>p</ci>
      <cn type="integer">1</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>p</ci>
      <cn type="integer">2</cn>
     </apply>
     <ci>normal-…</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>p</ci>
      <ci>k</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   r=p_{1}p_{2}\dots p_{k}
  </annotation>
 </semantics>
</math>

 be the prime factorization of <em>r</em>. Choose 

<math display="inline" id="Benaloh_cryptosystem:8">
 <semantics>
  <mrow>
   <mi>y</mi>
   <mo>∈</mo>
   <msubsup>
    <mi>ℤ</mi>
    <mi>n</mi>
    <mo>*</mo>
   </msubsup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <in></in>
    <ci>y</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>ℤ</ci>
      <times></times>
     </apply>
     <ci>n</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   y\in\mathbb{Z}^{*}_{n}
  </annotation>
 </semantics>
</math>


 such that for each factor 

<math display="inline" id="Benaloh_cryptosystem:9">
 <semantics>
  <msub>
   <mi>p</mi>
   <mi>i</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>p</ci>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p_{i}
  </annotation>
 </semantics>
</math>

, it is the case that 

<math display="inline" id="Benaloh_cryptosystem:10">
 <semantics>
  <mrow>
   <msup>
    <mi>y</mi>
    <mrow>
     <mi>ϕ</mi>
     <mo>/</mo>
     <msub>
      <mi>p</mi>
      <mi>i</mi>
     </msub>
    </mrow>
   </msup>
   <mo>≠</mo>
   <mrow>
    <mn>1</mn>
    <mo lspace="2.5pt" rspace="2.5pt">mod</mo>
    <mi>n</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <neq></neq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>y</ci>
     <apply>
      <divide></divide>
      <ci>ϕ</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>p</ci>
       <ci>i</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <csymbol cd="latexml">modulo</csymbol>
     <cn type="integer">1</cn>
     <ci>n</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   y^{\phi/p_{i}}\neq 1\mod n
  </annotation>
 </semantics>
</math>

.
</dd>
</dl>
</dd>
</dl>
<ol>
<li>Set 

<math display="inline" id="Benaloh_cryptosystem:11">
 <semantics>
  <mrow>
   <mi>x</mi>
   <mo>=</mo>
   <mrow>
    <msup>
     <mi>y</mi>
     <mrow>
      <mi>ϕ</mi>
      <mo>/</mo>
      <mi>r</mi>
     </mrow>
    </msup>
    <mo lspace="2.5pt" rspace="2.5pt">mod</mo>
    <mi>n</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>x</ci>
    <apply>
     <csymbol cd="latexml">modulo</csymbol>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>y</ci>
      <apply>
       <divide></divide>
       <ci>ϕ</ci>
       <ci>r</ci>
      </apply>
     </apply>
     <ci>n</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x=y^{\phi/r}\mod n
  </annotation>
 </semantics>
</math>

</li>
</ol>

<p>The public key is then 

<math display="inline" id="Benaloh_cryptosystem:12">
 <semantics>
  <mrow>
   <mi>y</mi>
   <mo>,</mo>
   <mi>n</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <list>
    <ci>y</ci>
    <ci>n</ci>
   </list>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   y,n
  </annotation>
 </semantics>
</math>

, and the private key is 

<math display="inline" id="Benaloh_cryptosystem:13">
 <semantics>
  <mrow>
   <mi>ϕ</mi>
   <mo>,</mo>
   <mi>x</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <list>
    <ci>ϕ</ci>
    <ci>x</ci>
   </list>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \phi,x
  </annotation>
 </semantics>
</math>


.</p>
<h3 id="message-encryption">Message Encryption</h3>

<p>To encrypt message 

<math display="inline" id="Benaloh_cryptosystem:14">
 <semantics>
  <mrow>
   <mi>m</mi>
   <mo>∈</mo>
   <msub>
    <mi>ℤ</mi>
    <mi>r</mi>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <in></in>
    <ci>m</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>ℤ</ci>
     <ci>r</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   m\in\mathbb{Z}_{r}
  </annotation>
 </semantics>
</math>

:</p>
<ol>
<li>Choose a random 

<math display="inline" id="Benaloh_cryptosystem:15">
 <semantics>
  <mrow>
   <mi>u</mi>
   <mo>∈</mo>
   <msubsup>
    <mi>ℤ</mi>
    <mi>n</mi>
    <mo>*</mo>
   </msubsup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <in></in>
    <ci>u</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>ℤ</ci>
      <times></times>
     </apply>
     <ci>n</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   u\in\mathbb{Z}^{*}_{n}
  </annotation>
 </semantics>
</math>

</li>
<li>Set 

<math display="inline" id="Benaloh_cryptosystem:16">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>E</mi>
     <mi>r</mi>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>m</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <msup>
      <mi>y</mi>
      <mi>m</mi>
     </msup>
     <msup>
      <mi>u</mi>
      <mi>r</mi>
     </msup>
    </mrow>
    <mo lspace="2.5pt" rspace="2.5pt">mod</mo>
    <mi>n</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>E</ci>
      <ci>r</ci>
     </apply>
     <ci>m</ci>
    </apply>
    <apply>
     <csymbol cd="latexml">modulo</csymbol>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>y</ci>
       <ci>m</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>u</ci>
       <ci>r</ci>
      </apply>
     </apply>
     <ci>n</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   E_{r}(m)=y^{m}u^{r}\mod n
  </annotation>
 </semantics>
</math>

</li>
</ol>
<h3 id="message-decryption">Message Decryption</h3>

<p>To decrypt a ciphertext 

<math display="inline" id="Benaloh_cryptosystem:17">
 <semantics>
  <mrow>
   <mi>c</mi>
   <mo>∈</mo>
   <msubsup>
    <mi>ℤ</mi>
    <mi>n</mi>
    <mo>*</mo>
   </msubsup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <in></in>
    <ci>c</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>ℤ</ci>
      <times></times>
     </apply>
     <ci>n</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   c\in\mathbb{Z}^{*}_{n}
  </annotation>
 </semantics>
</math>

:</p>
<ol>
<li>Compute 

<math display="inline" id="Benaloh_cryptosystem:18">
 <semantics>
  <mrow>
   <mi>a</mi>
   <mo>=</mo>
   <mrow>
    <msup>
     <mi>c</mi>
     <mrow>
      <mi>ϕ</mi>
      <mo>/</mo>
      <mi>r</mi>
     </mrow>
    </msup>
    <mo lspace="2.5pt" rspace="2.5pt">mod</mo>
    <mi>n</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>a</ci>
    <apply>
     <csymbol cd="latexml">modulo</csymbol>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>c</ci>
      <apply>
       <divide></divide>
       <ci>ϕ</ci>
       <ci>r</ci>
      </apply>
     </apply>
     <ci>n</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a=c^{\phi/r}\mod n
  </annotation>
 </semantics>
</math>


</li>
<li>Output 

<math display="inline" id="Benaloh_cryptosystem:19">
 <semantics>
  <mrow>
   <mi>m</mi>
   <mo>=</mo>
   <mrow>
    <msub>
     <mi>log</mi>
     <mi>x</mi>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>a</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>m</ci>
    <apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <log></log>
      <ci>x</ci>
     </apply>
     <ci>a</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   m=\log_{x}(a)
  </annotation>
 </semantics>
</math>

, i.e., find <em>m</em> such that 

<math display="inline" id="Benaloh_cryptosystem:20">
 <semantics>
  <mrow>
   <msup>
    <mi>x</mi>
    <mi>m</mi>
   </msup>
   <mo>≡</mo>
   <mrow>
    <mi>a</mi>
    <mo lspace="2.5pt" rspace="2.5pt">mod</mo>
    <mi>n</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <equivalent></equivalent>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>x</ci>
     <ci>m</ci>
    </apply>
    <apply>
     <csymbol cd="latexml">modulo</csymbol>
     <ci>a</ci>
     <ci>n</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x^{m}\equiv a\mod n
  </annotation>
 </semantics>
</math>

</li>
</ol>

<p>To understand decryption, first notice that for any 

<math display="inline" id="Benaloh_cryptosystem:21">
 <semantics>
  <mrow>
   <mi>m</mi>
   <mo>∈</mo>
   <msub>
    <mi>ℤ</mi>
    <mi>r</mi>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <in></in>
    <ci>m</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>ℤ</ci>
     <ci>r</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   m\in\mathbb{Z}_{r}
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Benaloh_cryptosystem:22">
 <semantics>
  <mrow>
   <mi>u</mi>
   <mo>∈</mo>
   <msubsup>
    <mi>ℤ</mi>
    <mi>n</mi>
    <mo>*</mo>
   </msubsup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <in></in>
    <ci>u</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>ℤ</ci>
      <times></times>
     </apply>
     <ci>n</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   u\in\mathbb{Z}^{*}_{n}
  </annotation>
 </semantics>
</math>

 we have:</p>

<p>

<math display="block" id="Benaloh_cryptosystem:23">
 <semantics>
  <mrow>
   <mi>a</mi>
   <mo>=</mo>
   <msup>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>c</mi>
     <mo stretchy="false">)</mo>
    </mrow>
    <mrow>
     <mi>ϕ</mi>
     <mo>/</mo>
     <mi>r</mi>
    </mrow>
   </msup>
   <mo>≡</mo>
   <msup>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <msup>
       <mi>y</mi>
       <mi>m</mi>
      </msup>
      <msup>
       <mi>u</mi>
       <mi>r</mi>
      </msup>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
    <mrow>
     <mi>ϕ</mi>
     <mo>/</mo>
     <mi>r</mi>
    </mrow>
   </msup>
   <mo>≡</mo>
   <mrow>
    <msup>
     <mrow>
      <mo stretchy="false">(</mo>
      <msup>
       <mi>y</mi>
       <mi>m</mi>
      </msup>
      <mo stretchy="false">)</mo>
     </mrow>
     <mrow>
      <mi>ϕ</mi>
      <mo>/</mo>
      <mi>r</mi>
     </mrow>
    </msup>
    <msup>
     <mrow>
      <mo stretchy="false">(</mo>
      <msup>
       <mi>u</mi>
       <mi>r</mi>
      </msup>
      <mo stretchy="false">)</mo>
     </mrow>
     <mrow>
      <mi>ϕ</mi>
      <mo>/</mo>
      <mi>r</mi>
     </mrow>
    </msup>
   </mrow>
   <mo>≡</mo>
   <mrow>
    <msup>
     <mrow>
      <mo stretchy="false">(</mo>
      <msup>
       <mi>y</mi>
       <mrow>
        <mi>ϕ</mi>
        <mo>/</mo>
        <mi>r</mi>
       </mrow>
      </msup>
      <mo stretchy="false">)</mo>
     </mrow>
     <mi>m</mi>
    </msup>
    <msup>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>u</mi>
      <mo stretchy="false">)</mo>
     </mrow>
     <mi>ϕ</mi>
    </msup>
   </mrow>
   <mo>≡</mo>
   <mrow>
    <msup>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>x</mi>
      <mo stretchy="false">)</mo>
     </mrow>
     <mi>m</mi>
    </msup>
    <msup>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>u</mi>
      <mo stretchy="false">)</mo>
     </mrow>
     <mn>0</mn>
    </msup>
   </mrow>
   <mo>≡</mo>
   <mrow>
    <msup>
     <mi>x</mi>
     <mi>m</mi>
    </msup>
    <mo lspace="2.5pt" rspace="2.5pt">mod</mo>
    <mi>n</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <ci>a</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>c</ci>
      <apply>
       <divide></divide>
       <ci>ϕ</ci>
       <ci>r</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <equivalent></equivalent>
     <share href="#.cmml">
     </share>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>y</ci>
        <ci>m</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>u</ci>
        <ci>r</ci>
       </apply>
      </apply>
      <apply>
       <divide></divide>
       <ci>ϕ</ci>
       <ci>r</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <equivalent></equivalent>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>y</ci>
        <ci>m</ci>
       </apply>
       <apply>
        <divide></divide>
        <ci>ϕ</ci>
        <ci>r</ci>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>u</ci>
        <ci>r</ci>
       </apply>
       <apply>
        <divide></divide>
        <ci>ϕ</ci>
        <ci>r</ci>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <equivalent></equivalent>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>y</ci>
        <apply>
         <divide></divide>
         <ci>ϕ</ci>
         <ci>r</ci>
        </apply>
       </apply>
       <ci>m</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>u</ci>
       <ci>ϕ</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <equivalent></equivalent>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>x</ci>
       <ci>m</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>u</ci>
       <cn type="integer">0</cn>
      </apply>
     </apply>
    </apply>
    <apply>
     <equivalent></equivalent>
     <share href="#.cmml">
     </share>
     <apply>
      <csymbol cd="latexml">modulo</csymbol>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>x</ci>
       <ci>m</ci>
      </apply>
      <ci>n</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a=(c)^{\phi/r}\equiv(y^{m}u^{r})^{\phi/r}\equiv(y^{m})^{\phi/r}(u^{r})^{\phi/r%
}\equiv(y^{\phi/r})^{m}(u)^{\phi}\equiv(x)^{m}(u)^{0}\equiv x^{m}\mod n
  </annotation>
 </semantics>
</math>

</p>

<p>To recover <em>m</em> from <em>a</em>, we take the <a href="discrete_log" title="wikilink">discrete log</a> of <em>a</em> base <em>x</em>. If <em>r</em> is small, we can recover m by an exhaustive search, i.e. checking if 

<math display="inline" id="Benaloh_cryptosystem:24">
 <semantics>
  <mrow>
   <msup>
    <mi>x</mi>
    <mi>i</mi>
   </msup>
   <mo>≡</mo>
   <mrow>
    <mi>a</mi>
    <mo lspace="2.5pt" rspace="2.5pt">mod</mo>
    <mi>n</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <equivalent></equivalent>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>x</ci>
     <ci>i</ci>
    </apply>
    <apply>
     <csymbol cd="latexml">modulo</csymbol>
     <ci>a</ci>
     <ci>n</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x^{i}\equiv a\mod n
  </annotation>
 </semantics>
</math>

 for all 

<math display="inline" id="Benaloh_cryptosystem:25">
 <semantics>
  <mrow>
   <mn>0</mn>
   <mi mathvariant="normal">…</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mrow>
     <mi>r</mi>
     <mo>-</mo>
     <mn>1</mn>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <cn type="integer">0</cn>
    <ci>normal-…</ci>
    <apply>
     <minus></minus>
     <ci>r</ci>
     <cn type="integer">1</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   0\dots(r-1)
  </annotation>
 </semantics>
</math>

. For larger values of <em>r</em>, the <a href="Baby-step_giant-step" title="wikilink">Baby-step giant-step</a> algorithm can be used to recover <em>m</em> in 

<math display="inline" id="Benaloh_cryptosystem:26">
 <semantics>
  <mrow>
   <mi>O</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msqrt>
     <mi>r</mi>
    </msqrt>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>O</ci>
    <apply>
     <root></root>
     <ci>r</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   O(\sqrt{r})
  </annotation>
 </semantics>
</math>

 time and space.</p>
<h3 id="security">Security</h3>

<p>The security of this scheme rests on the <a href="Higher_residuosity_problem" title="wikilink">Higher residuosity problem</a>, specifically, given <em>z</em>,<em>r</em> and <em>n</em> where the factorization of <em>n</em> is unknown, it is computationally infeasible to determine whether <em>z</em> is an <em>r</em>th residue mod <em>n</em>, i.e. if there exists an <em>x</em> such that 

<math display="inline" id="Benaloh_cryptosystem:27">
 <semantics>
  <mrow>
   <mi>z</mi>
   <mo>≡</mo>
   <mrow>
    <msup>
     <mi>x</mi>
     <mi>r</mi>
    </msup>
    <mo lspace="2.5pt" rspace="2.5pt">mod</mo>
    <mi>n</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <equivalent></equivalent>
    <ci>z</ci>
    <apply>
     <csymbol cd="latexml">modulo</csymbol>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>x</ci>
      <ci>r</ci>
     </apply>
     <ci>n</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   z\equiv x^{r}\mod n
  </annotation>
 </semantics>
</math>

.</p>
<h2 id="references">References</h2>

<p>"</p>

<p><a href="Category:Public-key_encryption_schemes" title="wikilink">Category:Public-key encryption schemes</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1"><a href="#fnref1">↩</a></li>
<li id="fn2"><a href="#fnref2">↩</a></li>
</ol>
</section>
</body>
</html>

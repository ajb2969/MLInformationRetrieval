<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="293">Hunt–McIlroy algorithm</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Hunt–McIlroy algorithm</h1>
<hr/>

<p>In <a href="computer_science" title="wikilink">computer science</a>, the <strong>Hunt–McIlroy algorithm</strong> is a solution to the <a href="longest_common_subsequence_problem" title="wikilink">longest common subsequence problem</a>. It was one of the first non-heuristic algorithms used in <a class="uri" href="diff" title="wikilink">diff</a>. To this day, variations of this algorithm are found in incremental <a href="version_control_system" title="wikilink">version control systems</a>, <a href="wiki_software" title="wikilink">wiki engines</a>, and <a href="molecular_phylogenetics" title="wikilink">molecular phylogenetics</a> research software.</p>

<p>The research accompanying the final version of <a class="uri" href="Unix" title="wikilink">Unix</a> <code>[[diff]]</code>, written by <a href="Douglas_McIlroy" title="wikilink">Douglas McIlroy</a>, was published in the 1976 paper "An Algorithm for Differential File Comparison", co-written with <a href="James_W._Hunt" title="wikilink">James W. Hunt</a>, who developed an initial prototype of diff.<a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a></p>
<h2 id="algorithm">Algorithm</h2>

<p>The Hunt–McIlroy algorithm is a modification to a basic solution for the longest common subsequence problem. The solution is modified so that there are lower time and space requirements for the algorithm when it is working with typical inputs.</p>
<h3 id="basic-longest-common-subsequence-solution">Basic Longest Common Subsequence Solution</h3>
<h4 id="algorithm-1">Algorithm</h4>

<p>Let A<sub>i</sub> be the <em>i</em>th line of the first file.</p>

<p>Let B<sub>j</sub> be the <em>j</em>th line of the second file.</p>

<p>Let P<sub>ij</sub> be the length of the longest common subsequence for the first i lines of the first file and the first j lines of the second file.</p>

<p>

<math display="block" id="Hunt–McIlroy_algorithm:0">
 <semantics>
  <mrow>
   <msub>
    <mi>P</mi>
    <mrow>
     <mi>i</mi>
     <mi>j</mi>
    </mrow>
   </msub>
   <mo>=</mo>
   <mrow>
    <mo>{</mo>
    <mtable displaystyle="true">
     <mtr>
      <mtd columnalign="left">
       <mn>0</mn>
      </mtd>
      <mtd columnalign="left">
       <mrow>
        <mrow>
         <mpadded width="+5pt">
          <mtext>if</mtext>
         </mpadded>
         <mi>i</mi>
        </mrow>
        <mo>=</mo>
        <mrow>
         <mn>0</mn>
         <mtext>or</mtext>
         <mi>j</mi>
        </mrow>
        <mo>=</mo>
        <mn>0</mn>
       </mrow>
      </mtd>
     </mtr>
     <mtr>
      <mtd columnalign="left">
       <mrow>
        <mn>1</mn>
        <mo>+</mo>
        <msub>
         <mi>P</mi>
         <mrow>
          <mrow>
           <mi>i</mi>
           <mo>-</mo>
           <mn>1</mn>
          </mrow>
          <mo>,</mo>
          <mrow>
           <mi>j</mi>
           <mo>-</mo>
           <mn>1</mn>
          </mrow>
         </mrow>
        </msub>
       </mrow>
      </mtd>
      <mtd columnalign="left">
       <mrow>
        <mrow>
         <mtext>if</mtext>
         <msub>
          <mi>A</mi>
          <mi>i</mi>
         </msub>
        </mrow>
        <mo>=</mo>
        <msub>
         <mi>B</mi>
         <mi>j</mi>
        </msub>
       </mrow>
      </mtd>
     </mtr>
     <mtr>
      <mtd columnalign="left">
       <mrow>
        <mi>m</mi>
        <mi>a</mi>
        <mi>x</mi>
        <mrow>
         <mo stretchy="false">(</mo>
         <msub>
          <mi>P</mi>
          <mrow>
           <mrow>
            <mi>i</mi>
            <mo>-</mo>
            <mn>1</mn>
           </mrow>
           <mo>,</mo>
           <mi>j</mi>
          </mrow>
         </msub>
         <mo>,</mo>
         <msub>
          <mi>P</mi>
          <mrow>
           <mi>i</mi>
           <mo>,</mo>
           <mrow>
            <mi>j</mi>
            <mo>-</mo>
            <mn>1</mn>
           </mrow>
          </mrow>
         </msub>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
      </mtd>
      <mtd columnalign="left">
       <mrow>
        <mrow>
         <mtext>if</mtext>
         <msub>
          <mi>A</mi>
          <mi>i</mi>
         </msub>
        </mrow>
        <mo>≠</mo>
        <msub>
         <mi>B</mi>
         <mi>j</mi>
        </msub>
       </mrow>
      </mtd>
     </mtr>
    </mtable>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>P</ci>
     <apply>
      <times></times>
      <ci>i</ci>
      <ci>j</ci>
     </apply>
    </apply>
    <apply>
     <csymbol cd="latexml">cases</csymbol>
     <cn type="integer">0</cn>
     <apply>
      <and></and>
      <apply>
       <eq></eq>
       <apply>
        <times></times>
        <mtext>if</mtext>
        <ci>i</ci>
       </apply>
       <apply>
        <times></times>
        <cn type="integer">0</cn>
        <mtext>or</mtext>
        <ci>j</ci>
       </apply>
      </apply>
      <apply>
       <eq></eq>
       <share href="#.cmml">
       </share>
       <cn type="integer">0</cn>
      </apply>
     </apply>
     <apply>
      <plus></plus>
      <cn type="integer">1</cn>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>P</ci>
       <list>
        <apply>
         <minus></minus>
         <ci>i</ci>
         <cn type="integer">1</cn>
        </apply>
        <apply>
         <minus></minus>
         <ci>j</ci>
         <cn type="integer">1</cn>
        </apply>
       </list>
      </apply>
     </apply>
     <apply>
      <eq></eq>
      <apply>
       <times></times>
       <mtext>if</mtext>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>A</ci>
        <ci>i</ci>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>B</ci>
       <ci>j</ci>
      </apply>
     </apply>
     <apply>
      <times></times>
      <ci>m</ci>
      <ci>a</ci>
      <ci>x</ci>
      <interval closure="open">
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>P</ci>
        <list>
         <apply>
          <minus></minus>
          <ci>i</ci>
          <cn type="integer">1</cn>
         </apply>
         <ci>j</ci>
        </list>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>P</ci>
        <list>
         <ci>i</ci>
         <apply>
          <minus></minus>
          <ci>j</ci>
          <cn type="integer">1</cn>
         </apply>
        </list>
       </apply>
      </interval>
     </apply>
     <apply>
      <neq></neq>
      <apply>
       <times></times>
       <mtext>if</mtext>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>A</ci>
        <ci>i</ci>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>B</ci>
       <ci>j</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   P_{ij}=\begin{cases}0&\mbox{ if }\ i=0\mbox{ or }j=0\\
1+P_{i-1,j-1}&\mbox{ if }A_{i}=B_{j}\\
max(P_{i-1,j},P_{i,j-1})&\mbox{ if }A_{i}\neq B_{j}\\
\end{cases}
  </annotation>
 </semantics>
</math>

</p>
<h4 id="example">Example</h4>

<p> Consider the files A and B.</p>

<p>A contains three lines:</p>
<ul>
<li>A<sub>1</sub> = a</li>
<li>A<sub>2</sub> = b</li>
<li>A<sub>3</sub> = c</li>
</ul>

<p>B contains three lines:</p>
<ul>
<li>B<sub>1</sub> = a</li>
<li>B<sub>2</sub> = c</li>
<li>B<sub>3</sub> = b</li>
</ul>

<p>The steps the above algorithm would perform to determine the length of the longest common subsequence for both files are shown in the diagram. The algorithm correctly reports that the longest common subsequence of the two files is two lines long.</p>
<h4 id="complexity">Complexity</h4>

<p>The above algorithm has worst-case time and space complexities of 

<math display="inline" id="Hunt–McIlroy_algorithm:1">
 <semantics>
  <mrow>
   <mi>O</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mrow>
     <mi>m</mi>
     <mi>n</mi>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>O</ci>
    <apply>
     <times></times>
     <ci>m</ci>
     <ci>n</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   O(mn)
  </annotation>
 </semantics>
</math>

 (see <a href="big_O_notation" title="wikilink">big O notation</a>), where m is the number of lines in file A and n is the number of lines in file B. The Hunt–McIlroy algorithm modifies this algorithm to have a worst case time complexity of 

<math display="inline" id="Hunt–McIlroy_algorithm:2">
 <semantics>
  <mrow>
   <mi>O</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mrow>
     <mi>m</mi>
     <mi>n</mi>
     <mrow>
      <mi>log</mi>
      <mi>m</mi>
     </mrow>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>O</ci>
    <apply>
     <times></times>
     <ci>m</ci>
     <ci>n</ci>
     <apply>
      <log></log>
      <ci>m</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   O(mn\log m)
  </annotation>
 </semantics>
</math>

 and space complexity of 

<math display="inline" id="Hunt–McIlroy_algorithm:3">
 <semantics>
  <mrow>
   <mi>O</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mrow>
     <mi>m</mi>
     <mi>n</mi>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>O</ci>
    <apply>
     <times></times>
     <ci>m</ci>
     <ci>n</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   O(mn)
  </annotation>
 </semantics>
</math>

, though it regularly beats the worst-case with typical inputs.</p>
<h3 id="essential-matches">Essential Matches</h3>
<h4 id="k-candidates">k-candidates</h4>

<p>The Hunt–McIlroy algorithm only considers what the authors call essential matches, or k-candidates. k-candidates are pairs of indices (i, j) such that:</p>
<ul>
<li>A<sub>i</sub> = B<sub>j</sub></li>
<li>P<sub>ij</sub> &gt; max(P<sub>i-1, j</sub>, P<sub>i, j-1</sub>)</li>
</ul>

<p>The second point implies two properties of k-candidates:</p>
<ul>
<li>There is a common subsequence of length k in the first i lines of file A and the first j lines of file B.</li>
<li>There are no common subsequences of length k for any fewer than i lines of file A or j lines of file B.</li>
</ul>
<h4 id="connecting-k-candidates">Connecting k-candidates</h4>

<p> To create the longest common subsequence from a collection of k-candidates, a grid with each file's contents on each axis is created. The k-candidates are marked on the grid. A common subsequence can be created by joining marked coordinates of the grid such that any increase in i is accompanied by an increase in j.</p>

<p>This is illustrated in the diagram to the right.</p>

<p>Black dots represent candidates that would have to be considered by the simple algorithm and the black lines are connections that create common subsequences of length 3.</p>

<p>Red dots represent k-candidates that are considered by the Hunt–McIlroy algorithm and the red line is the connection that creates a common subsequence of length 3.</p>
<h2 id="see-also">See also</h2>
<ul>
<li><a href="Levenshtein_distance" title="wikilink">Levenshtein distance</a></li>
<li><a href="Longest_common_subsequence_problem" title="wikilink">Longest common subsequence problem</a></li>
<li><a href="Wagner–Fischer_algorithm" title="wikilink">Wagner–Fischer algorithm</a></li>
</ul>
<h2 id="references">References</h2>

<p>"</p>

<p><a href="Category:Algorithms_on_strings" title="wikilink">Category:Algorithms on strings</a> <a class="uri" href="Category:Combinatorics" title="wikilink">Category:Combinatorics</a> <a href="Category:Dynamic_programming" title="wikilink">Category:Dynamic programming</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1"><a href="#fnref1">↩</a></li>
</ol>
</section>
</body>
</html>

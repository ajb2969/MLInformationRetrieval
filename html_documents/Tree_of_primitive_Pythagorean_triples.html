<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="1502">Tree of primitive Pythagorean triples</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Tree of primitive Pythagorean triples</h1>
<hr/>
<figure><b>(Figure)</b>
<figcaption>The tree of primitive Pythagorean triples.</figcaption>
</figure>

<p>In <a class="uri" href="mathematics" title="wikilink">mathematics</a>, a <strong>tree of primitive Pythagorean triples</strong> is a <a href="tree_(data_structure)" title="wikilink">data tree</a> in which each node branches to more than one subsequent node with the infinite set of all nodes giving all (and only) primitive <a href="Pythagorean_triple" title="wikilink">Pythagorean triples</a> without duplication.</p>

<p>A Pythagorean triple is a set of three positive <a href="integer" title="wikilink">integers</a> <em>a, b,</em> and <em>c</em> having the property that they can be respectively the two legs and the <a class="uri" href="hypotenuse" title="wikilink">hypotenuse</a> of a <a href="right_triangle" title="wikilink">right triangle</a>, thus satisfying the equation 

<math display="inline" id="Tree_of_primitive_Pythagorean_triples:0">
 <semantics>
  <mrow>
   <mrow>
    <msup>
     <mi>a</mi>
     <mn>2</mn>
    </msup>
    <mo>+</mo>
    <msup>
     <mi>b</mi>
     <mn>2</mn>
    </msup>
   </mrow>
   <mo>=</mo>
   <msup>
    <mi>c</mi>
    <mn>2</mn>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <plus></plus>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>a</ci>
      <cn type="integer">2</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>b</ci>
      <cn type="integer">2</cn>
     </apply>
    </apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>c</ci>
     <cn type="integer">2</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a^{2}+b^{2}=c^{2}
  </annotation>
 </semantics>
</math>

; the triple is said to be <strong>primitive</strong> <a href="if_and_only_if" title="wikilink">if and only if</a> <em>a, b,</em> and <em>c</em> share no common <a class="uri" href="divisor" title="wikilink">divisor</a>. The set of all primitive Pythagorean triples has the structure of a rooted <a href="Tree_structure" title="wikilink">tree</a>, specifically a <a href="ternary_tree" title="wikilink">ternary tree</a>, in a natural way. This was first discovered by B. Berggren in 1934.<a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a></p>

<p>F. J. M. Barning showed<a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a> that when any of the three <a href="Matrix_(mathematics)" title="wikilink">matrices</a></p>

<p>

<math display="block" id="Tree_of_primitive_Pythagorean_triples:1">
 <semantics>
  <mtable displaystyle="true">
   <mtr>
    <mtd columnalign="left">
     <mrow>
      <mi>A</mi>
      <mo>=</mo>
      <mrow>
       <mo>[</mo>
       <mtable displaystyle="true">
        <mtr>
         <mtd columnalign="center">
          <mn>1</mn>
         </mtd>
         <mtd columnalign="center">
          <mrow>
           <mo>-</mo>
           <mn>2</mn>
          </mrow>
         </mtd>
         <mtd columnalign="center">
          <mn>2</mn>
         </mtd>
        </mtr>
        <mtr>
         <mtd columnalign="center">
          <mn>2</mn>
         </mtd>
         <mtd columnalign="center">
          <mrow>
           <mo>-</mo>
           <mn>1</mn>
          </mrow>
         </mtd>
         <mtd columnalign="center">
          <mn>2</mn>
         </mtd>
        </mtr>
        <mtr>
         <mtd columnalign="center">
          <mn>2</mn>
         </mtd>
         <mtd columnalign="center">
          <mrow>
           <mo>-</mo>
           <mn>2</mn>
          </mrow>
         </mtd>
         <mtd columnalign="center">
          <mn>3</mn>
         </mtd>
        </mtr>
       </mtable>
       <mo>]</mo>
      </mrow>
     </mrow>
    </mtd>
    <mtd columnalign="center">
     <mrow>
      <mi>B</mi>
      <mo>=</mo>
      <mrow>
       <mo>[</mo>
       <mtable displaystyle="true">
        <mtr>
         <mtd columnalign="center">
          <mn>1</mn>
         </mtd>
         <mtd columnalign="center">
          <mn>2</mn>
         </mtd>
         <mtd columnalign="center">
          <mn>2</mn>
         </mtd>
        </mtr>
        <mtr>
         <mtd columnalign="center">
          <mn>2</mn>
         </mtd>
         <mtd columnalign="center">
          <mn>1</mn>
         </mtd>
         <mtd columnalign="center">
          <mn>2</mn>
         </mtd>
        </mtr>
        <mtr>
         <mtd columnalign="center">
          <mn>2</mn>
         </mtd>
         <mtd columnalign="center">
          <mn>2</mn>
         </mtd>
         <mtd columnalign="center">
          <mn>3</mn>
         </mtd>
        </mtr>
       </mtable>
       <mo>]</mo>
      </mrow>
     </mrow>
    </mtd>
    <mtd columnalign="right">
     <mrow>
      <mi>C</mi>
      <mo>=</mo>
      <mrow>
       <mo>[</mo>
       <mtable displaystyle="true">
        <mtr>
         <mtd columnalign="center">
          <mrow>
           <mo>-</mo>
           <mn>1</mn>
          </mrow>
         </mtd>
         <mtd columnalign="center">
          <mn>2</mn>
         </mtd>
         <mtd columnalign="center">
          <mn>2</mn>
         </mtd>
        </mtr>
        <mtr>
         <mtd columnalign="center">
          <mrow>
           <mo>-</mo>
           <mn>2</mn>
          </mrow>
         </mtd>
         <mtd columnalign="center">
          <mn>1</mn>
         </mtd>
         <mtd columnalign="center">
          <mn>2</mn>
         </mtd>
        </mtr>
        <mtr>
         <mtd columnalign="center">
          <mrow>
           <mo>-</mo>
           <mn>2</mn>
          </mrow>
         </mtd>
         <mtd columnalign="center">
          <mn>2</mn>
         </mtd>
         <mtd columnalign="center">
          <mn>3</mn>
         </mtd>
        </mtr>
       </mtable>
       <mo>]</mo>
      </mrow>
     </mrow>
    </mtd>
   </mtr>
  </mtable>
  <annotation-xml encoding="MathML-Content">
   <matrix>
    <matrixrow>
     <apply>
      <eq></eq>
      <ci>A</ci>
      <matrix>
       <matrixrow>
        <cn type="integer">1</cn>
        <apply>
         <minus></minus>
         <cn type="integer">2</cn>
        </apply>
        <cn type="integer">2</cn>
       </matrixrow>
       <matrixrow>
        <cn type="integer">2</cn>
        <apply>
         <minus></minus>
         <cn type="integer">1</cn>
        </apply>
        <cn type="integer">2</cn>
       </matrixrow>
       <matrixrow>
        <cn type="integer">2</cn>
        <apply>
         <minus></minus>
         <cn type="integer">2</cn>
        </apply>
        <cn type="integer">3</cn>
       </matrixrow>
      </matrix>
     </apply>
     <apply>
      <eq></eq>
      <ci>B</ci>
      <matrix>
       <matrixrow>
        <cn type="integer">1</cn>
        <cn type="integer">2</cn>
        <cn type="integer">2</cn>
       </matrixrow>
       <matrixrow>
        <cn type="integer">2</cn>
        <cn type="integer">1</cn>
        <cn type="integer">2</cn>
       </matrixrow>
       <matrixrow>
        <cn type="integer">2</cn>
        <cn type="integer">2</cn>
        <cn type="integer">3</cn>
       </matrixrow>
      </matrix>
     </apply>
     <apply>
      <eq></eq>
      <ci>C</ci>
      <matrix>
       <matrixrow>
        <apply>
         <minus></minus>
         <cn type="integer">1</cn>
        </apply>
        <cn type="integer">2</cn>
        <cn type="integer">2</cn>
       </matrixrow>
       <matrixrow>
        <apply>
         <minus></minus>
         <cn type="integer">2</cn>
        </apply>
        <cn type="integer">1</cn>
        <cn type="integer">2</cn>
       </matrixrow>
       <matrixrow>
        <apply>
         <minus></minus>
         <cn type="integer">2</cn>
        </apply>
        <cn type="integer">2</cn>
        <cn type="integer">3</cn>
       </matrixrow>
      </matrix>
     </apply>
    </matrixrow>
   </matrix>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \begin{array}[]{lcr}A=\begin{bmatrix}1&-2&2\\
2&-1&2\\
2&-2&3\end{bmatrix}&B=\begin{bmatrix}1&2&2\\
2&1&2\\
2&2&3\end{bmatrix}&C=\begin{bmatrix}-1&2&2\\
-2&1&2\\
-2&2&3\end{bmatrix}\end{array}
  </annotation>
 </semantics>
</math>

 is <a href="matrix_multiplication" title="wikilink">multiplied</a> on the right by a <a href="column_vector" title="wikilink">column vector</a> whose components form a Pythagorean triple, then the result is another column vector whose components are a different Pythagorean triple. If the initial triple is primitive, then so is the one that results. Thus each primitive Pythagorean triple has three "children". All primitive Pythagorean triples are descended in this way from the triple (3 ,4, 5), and no primitive triple appears more than once. The result may be graphically represented as an infinite ternary tree with (3, 4, 5) at the root node (see classic tree at right). This tree also appeared in papers of A. Hall in 1970<a class="footnoteRef" href="#fn3" id="fnref3"><sup>3</sup></a> and A. R. Kanga in 1990.<a class="footnoteRef" href="#fn4" id="fnref4"><sup>4</sup></a></p>
<h2 id="proofs">Proofs</h2>
<h3 id="presence-of-exclusively-primitive-pythagorean-triples">Presence of exclusively primitive Pythagorean triples</h3>

<p>It can be shown <a href="Induction_(mathematics)" title="wikilink">inductively</a> that the tree contains primitive Pythagorean triples and nothing else by showing that starting from a primitive Pythagorean triple, such as is present at the initial node with (3, 4, 5), each generated triple is both Pythagorean and primitive.</p>
<h4 id="preservation-of-the-pythagorean-property">Preservation of the Pythagorean property</h4>

<p>If any of the above matrices, say <em>A</em>, is applied to a triple (<em>a</em>, <em>b</em>, <em>c</em>)<sup>T</sup> having the Pythagorean property <em>a</em><sup>2</sup>+<em>b</em><sup>2</sup>=<em>c</em><sup>2</sup> to obtain a new triple (<em>d</em>, <em>e</em>, <em>f</em>)<sup>T</sup> = <em>A</em>(<em>a</em>, <em>b</em>, <em>c</em>)<sup>T</sup>, this new triple is also Pythagorean. This can be seen by writing out each of <em>d</em>, <em>e</em>, and <em>f</em> as the sum of three terms in <em>a</em>, <em>b</em>, and <em>c</em>, squaring each of them, and substituting <em>c</em><sup>2</sup>=<em>a</em><sup>2</sup>+<em>b</em><sup>2</sup> to obtain <em>f</em><sup>2</sup>=<em>d</em><sup>2</sup>+<em>e</em><sup>2</sup>. This holds for <em>B</em> and <em>C</em> as well as for <em>A</em>.</p>
<h4 id="preservation-of-primitivity">Preservation of primitivity</h4>

<p>The matricies <em>A</em>, <em>B</em>, and <em>C</em> are all <a href="unimodular_matrix" title="wikilink">unimodular</a>—that is, they have only integer entries and their determinants are ±1. Thus their inverses are also unimodular and in particular have only integer entries. So if any one of them, for example <em>A</em>, is applied to a primitive Pythagorean triple (<em>a</em>, <em>b</em>, <em>c</em>)<sup>T</sup> to obtain another triple (<em>d</em>, <em>e</em>, <em>f</em>)<sup>T</sup>, we have (<em>d</em>, <em>e</em>, <em>f</em>)<sup>T</sup> = <em>A</em>(<em>a</em>, <em>b</em>, <em>c</em>)<sup>T</sup> and hence (<em>a</em>, <em>b</em>, <em>c</em>)<sup>T</sup> = <em>A</em><sup>−1</sup>(<em>d</em>, <em>e</em>, <em>f</em>)<sup>T</sup>. If any prime factor were shared by any two of (and hence all three of) <em>d</em>, <em>e</em>, and <em>f</em> then by this last equation that prime would also divide each of <em>a</em>, <em>b</em>, and <em>c</em>. So if <em>a</em>, <em>b</em>, and <em>c</em> are in fact pairwise coprime, then <em>d</em>, <em>e</em>, and <em>f</em> must be pairwise coprime as well. This holds for <em>B</em> and <em>C</em> as well as for <em>A</em>.</p>
<h3 id="presence-of-every-primitive-pythagorean-triple-exactly-once">Presence of every primitive Pythagorean triple exactly once</h3>

<p>To show that the tree contains every primitive Pythagorean triple, but no more than once, it suffices to show that for any such triple there is exactly one path back through the tree to the starting node (3, 4, 5). This can be seen by applying in turn each of the unimodular inverse matrices <em>A</em><sup>−1</sup>, <em>B</em><sup>−1</sup>, and <em>C</em><sup>−1</sup> to an arbitrary primitive Pythagorean triple (<em>d</em>, <em>e</em>, <em>f</em>), noting that by the above reasoning primitivity and the Pythagorean property are retained, and noting that for any triple larger than (3, 4, 5) exactly one of the inverse transition matrices yields a new triple with all positive entries (and a smaller hypotenuse). By induction, this new valid triple itself leads to exactly one smaller valid triple, and so forth. By the finiteness of the number of smaller and smaller potential hypotenuses, eventually (3, 4, 5) is reached. This proves that (<em>d</em>, <em>e</em>, <em>f</em>) does in fact occur in the tree, since it can be reached from (3, 4, 5) by reversing the steps; and it occurs uniquely because there was only one path from (<em>d</em>, <em>e</em>, <em>f</em>) to (3, 4, 5).</p>
<h2 id="properties">Properties</h2>

<p>The transformation using matrix <em>A</em>, if performed repeatedly from (<em>a</em>, <em>b</em>, <em>c</em>) = (3, 4, 5), preserves the feature <em>b</em> + 1 = <em>c</em>; matrix <em>B</em> preserves <em>a</em> – <em>b</em> = ±1 starting from (3, 4, 5); and matrix <em>C</em> preserves the feature <em>a</em> + 2 = <em>c</em> starting from (3, 4, 5).</p>

<p>A geometric interpretation for this tree involves the <a href="excircle" title="wikilink">excircles</a> present at each node. The three children of any parent triangle “inherit” their <a href="inradius" title="wikilink">inradii</a> from the parent: the parent’s excircle radii become the inradii for the next generation.<a class="footnoteRef" href="#fn5" id="fnref5"><sup>5</sup></a> For example, parent ( 3, 4, 5) has excircle radii equal to 2, 3, and 6. These are precisely the inradii of the three children (5, 12, 13), (15, 8, 17) and  respectively.</p>

<p>If either of <em>A</em> or <em>C</em> is applied repeatedly from any Pythagorean triple used as an initial condition, then the dynamics of any of <em>a</em>, <em>b</em>, and <em>c</em> can be expressed as the dynamics of <em>x</em> in</p>

<p>

<math display="block" id="Tree_of_primitive_Pythagorean_triples:2">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mrow>
      <msub>
       <mi>x</mi>
       <mrow>
        <mi>n</mi>
        <mo>+</mo>
        <mn>3</mn>
       </mrow>
      </msub>
      <mo>-</mo>
      <mrow>
       <mn>3</mn>
       <msub>
        <mi>x</mi>
        <mrow>
         <mi>n</mi>
         <mo>+</mo>
         <mn>2</mn>
        </mrow>
       </msub>
      </mrow>
     </mrow>
     <mo>+</mo>
     <mrow>
      <mn>3</mn>
      <msub>
       <mi>x</mi>
       <mrow>
        <mi>n</mi>
        <mo>+</mo>
        <mn>1</mn>
       </mrow>
      </msub>
     </mrow>
    </mrow>
    <mo>-</mo>
    <msub>
     <mi>x</mi>
     <mi>n</mi>
    </msub>
   </mrow>
   <mo>=</mo>
   <mpadded width="+1.7pt">
    <mn>0</mn>
   </mpadded>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <minus></minus>
     <apply>
      <plus></plus>
      <apply>
       <minus></minus>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <apply>
         <plus></plus>
         <ci>n</ci>
         <cn type="integer">3</cn>
        </apply>
       </apply>
       <apply>
        <times></times>
        <cn type="integer">3</cn>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>x</ci>
         <apply>
          <plus></plus>
          <ci>n</ci>
          <cn type="integer">2</cn>
         </apply>
        </apply>
       </apply>
      </apply>
      <apply>
       <times></times>
       <cn type="integer">3</cn>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <apply>
         <plus></plus>
         <ci>n</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <ci>n</ci>
     </apply>
    </apply>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x_{n+3}-3x_{n+2}+3x_{n+1}-x_{n}=0\,
  </annotation>
 </semantics>
</math>

</p>

<p>which is patterned on the matrices' shared <a href="Characteristic_polynomial#Characteristic_equation" title="wikilink">characteristic equation</a></p>

<p>

<math display="block" id="Tree_of_primitive_Pythagorean_triples:3">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mrow>
      <msup>
       <mi>λ</mi>
       <mn>3</mn>
      </msup>
      <mo>-</mo>
      <mrow>
       <mn>3</mn>
       <msup>
        <mi>λ</mi>
        <mn>2</mn>
       </msup>
      </mrow>
     </mrow>
     <mo>+</mo>
     <mrow>
      <mn>3</mn>
      <mi>λ</mi>
     </mrow>
    </mrow>
    <mo>-</mo>
    <mn>1</mn>
   </mrow>
   <mo>=</mo>
   <mpadded width="+1.7pt">
    <mn>0.</mn>
   </mpadded>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <minus></minus>
     <apply>
      <plus></plus>
      <apply>
       <minus></minus>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>λ</ci>
        <cn type="integer">3</cn>
       </apply>
       <apply>
        <times></times>
        <cn type="integer">3</cn>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>λ</ci>
         <cn type="integer">2</cn>
        </apply>
       </apply>
      </apply>
      <apply>
       <times></times>
       <cn type="integer">3</cn>
       <ci>λ</ci>
      </apply>
     </apply>
     <cn type="integer">1</cn>
    </apply>
    <cn type="float">0.</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \lambda^{3}-3\lambda^{2}+3\lambda-1=0.\,
  </annotation>
 </semantics>
</math>

</p>

<p>If <em>B</em> is applied repeatedly, then the dynamics of any of <em>a</em>, <em>b</em>, and <em>c</em> can be expressed as the dynamics of <em>x</em> in</p>

<p>

<math display="block" id="Tree_of_primitive_Pythagorean_triples:4">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mrow>
      <msub>
       <mi>x</mi>
       <mrow>
        <mi>n</mi>
        <mo>+</mo>
        <mn>3</mn>
       </mrow>
      </msub>
      <mo>-</mo>
      <mrow>
       <mn>5</mn>
       <msub>
        <mi>x</mi>
        <mrow>
         <mi>n</mi>
         <mo>+</mo>
         <mn>2</mn>
        </mrow>
       </msub>
      </mrow>
      <mo>-</mo>
      <mrow>
       <mn>5</mn>
       <msub>
        <mi>x</mi>
        <mrow>
         <mi>n</mi>
         <mo>+</mo>
         <mn>1</mn>
        </mrow>
       </msub>
      </mrow>
     </mrow>
     <mo>+</mo>
     <msub>
      <mi>x</mi>
      <mi>n</mi>
     </msub>
    </mrow>
    <mo>=</mo>
    <mn>0</mn>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <plus></plus>
     <apply>
      <minus></minus>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <apply>
        <plus></plus>
        <ci>n</ci>
        <cn type="integer">3</cn>
       </apply>
      </apply>
      <apply>
       <times></times>
       <cn type="integer">5</cn>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <apply>
         <plus></plus>
         <ci>n</ci>
         <cn type="integer">2</cn>
        </apply>
       </apply>
      </apply>
      <apply>
       <times></times>
       <cn type="integer">5</cn>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <apply>
         <plus></plus>
         <ci>n</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <ci>n</ci>
     </apply>
    </apply>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x_{n+3}-5x_{n+2}-5x_{n+1}+x_{n}=0,\,
  </annotation>
 </semantics>
</math>

</p>

<p>which is patterned on the characteristic equation of <em>B</em>.<a class="footnoteRef" href="#fn6" id="fnref6"><sup>6</sup></a></p>

<p>Moreover, an infinitude of other third-order univariate <a href="difference_equations" title="wikilink">difference equations</a> can be found by multiplying any of the three matrices together an arbitrary number of times in an arbitrary sequence. For instance, the matrix <em>D</em> = <em>CB</em> moves one out the tree by two nodes (across, then down) in a single step; the characteristic equation of <em>D</em> provides the pattern for the third-order dynamics of any of <em>a</em>, <em>b,</em> or <em>c</em> in the <a href="Collectively_exhaustive_events" title="wikilink">non-exhaustive</a> tree formed by <em>D</em>.</p>
<h2 id="alternative-methods-of-generating-the-tree">Alternative methods of generating the tree</h2>

<p>Another approach to the dynamics of this tree<a class="footnoteRef" href="#fn7" id="fnref7"><sup>7</sup></a> relies on the standard formula for generating all primitive Pythagorean triples:</p>

<p>

<math display="block" id="Tree_of_primitive_Pythagorean_triples:5">
 <semantics>
  <mrow>
   <mrow>
    <mi>a</mi>
    <mo>=</mo>
    <mrow>
     <msup>
      <mi>m</mi>
      <mn>2</mn>
     </msup>
     <mo>-</mo>
     <msup>
      <mi>n</mi>
      <mn>2</mn>
     </msup>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>a</ci>
    <apply>
     <minus></minus>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>m</ci>
      <cn type="integer">2</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>n</ci>
      <cn type="integer">2</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a=m^{2}-n^{2},\,
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Tree_of_primitive_Pythagorean_triples:6">
 <semantics>
  <mrow>
   <mrow>
    <mi>b</mi>
    <mo>=</mo>
    <mrow>
     <mn>2</mn>
     <mi>m</mi>
     <mi>n</mi>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>b</ci>
    <apply>
     <times></times>
     <cn type="integer">2</cn>
     <ci>m</ci>
     <ci>n</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   b=2mn,\,
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Tree_of_primitive_Pythagorean_triples:7">
 <semantics>
  <mrow>
   <mrow>
    <mi>c</mi>
    <mo>=</mo>
    <mrow>
     <msup>
      <mi>m</mi>
      <mn>2</mn>
     </msup>
     <mo>+</mo>
     <msup>
      <mi>n</mi>
      <mn>2</mn>
     </msup>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>c</ci>
    <apply>
     <plus></plus>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>m</ci>
      <cn type="integer">2</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>n</ci>
      <cn type="integer">2</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   c=m^{2}+n^{2},\,
  </annotation>
 </semantics>
</math>

</p>

<p>with <em>m</em> &gt; <em>n</em> &gt; 0 and <em>m</em> and <em>n</em> coprime and of opposite parity. Pairs (<em>m</em>, <em>n</em>) can be iterated by pre-multiplying them (expressed as a column vector) by any of</p>

<p>

<math display="block" id="Tree_of_primitive_Pythagorean_triples:8">
 <semantics>
  <mtable displaystyle="true">
   <mtr>
    <mtd columnalign="left">
     <mrow>
      <mrow>
       <mo>[</mo>
       <mtable displaystyle="true">
        <mtr>
         <mtd columnalign="center">
          <mn>2</mn>
         </mtd>
         <mtd columnalign="center">
          <mrow>
           <mo>-</mo>
           <mn>1</mn>
          </mrow>
         </mtd>
        </mtr>
        <mtr>
         <mtd columnalign="center">
          <mn>1</mn>
         </mtd>
         <mtd columnalign="center">
          <mn>0</mn>
         </mtd>
        </mtr>
       </mtable>
       <mo>]</mo>
      </mrow>
      <mo>,</mo>
     </mrow>
    </mtd>
    <mtd columnalign="center">
     <mrow>
      <mrow>
       <mo>[</mo>
       <mtable displaystyle="true">
        <mtr>
         <mtd columnalign="center">
          <mn>2</mn>
         </mtd>
         <mtd columnalign="center">
          <mn>1</mn>
         </mtd>
        </mtr>
        <mtr>
         <mtd columnalign="center">
          <mn>1</mn>
         </mtd>
         <mtd columnalign="center">
          <mn>0</mn>
         </mtd>
        </mtr>
       </mtable>
       <mo>]</mo>
      </mrow>
      <mo>,</mo>
     </mrow>
    </mtd>
    <mtd columnalign="right">
     <mrow>
      <mrow>
       <mo>[</mo>
       <mtable displaystyle="true">
        <mtr>
         <mtd columnalign="center">
          <mn>1</mn>
         </mtd>
         <mtd columnalign="center">
          <mn>2</mn>
         </mtd>
        </mtr>
        <mtr>
         <mtd columnalign="center">
          <mn>0</mn>
         </mtd>
         <mtd columnalign="center">
          <mn>1</mn>
         </mtd>
        </mtr>
       </mtable>
       <mo>]</mo>
      </mrow>
      <mo>,</mo>
     </mrow>
    </mtd>
   </mtr>
  </mtable>
  <annotation-xml encoding="MathML-Content">
   <matrix>
    <matrixrow>
     <matrix>
      <matrixrow>
       <cn type="integer">2</cn>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
       </apply>
      </matrixrow>
      <matrixrow>
       <cn type="integer">1</cn>
       <cn type="integer">0</cn>
      </matrixrow>
     </matrix>
     <matrix>
      <matrixrow>
       <cn type="integer">2</cn>
       <cn type="integer">1</cn>
      </matrixrow>
      <matrixrow>
       <cn type="integer">1</cn>
       <cn type="integer">0</cn>
      </matrixrow>
     </matrix>
     <matrix>
      <matrixrow>
       <cn type="integer">1</cn>
       <cn type="integer">2</cn>
      </matrixrow>
      <matrixrow>
       <cn type="integer">0</cn>
       <cn type="integer">1</cn>
      </matrixrow>
     </matrix>
    </matrixrow>
   </matrix>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \begin{array}[]{lcr}\begin{bmatrix}2&-1\\
1&0\end{bmatrix},&\begin{bmatrix}2&1\\
1&0\end{bmatrix},&\begin{bmatrix}1&2\\
0&1\end{bmatrix},\end{array}
  </annotation>
 </semantics>
</math>

</p>

<p>each of which preserves the inequalities, coprimeness, and opposite parity. The resulting ternary tree contains every such (<em>m</em>, <em>n</em>) pair exactly once, and when converted into (<em>a</em>, <em>b</em>, <em>c</em>) triples it becomes identical to the tree described above.</p>

<p>Another way of using two underlying parameters to generate the tree of triples<a class="footnoteRef" href="#fn8" id="fnref8"><sup>8</sup></a> uses an alternative formula for all primitive triples:</p>

<p>

<math display="block" id="Tree_of_primitive_Pythagorean_triples:9">
 <semantics>
  <mrow>
   <mrow>
    <mi>a</mi>
    <mo>=</mo>
    <mrow>
     <mi>u</mi>
     <mi>v</mi>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>a</ci>
    <apply>
     <times></times>
     <ci>u</ci>
     <ci>v</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a=uv,\,
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Tree_of_primitive_Pythagorean_triples:10">
 <semantics>
  <mrow>
   <mrow>
    <mi>b</mi>
    <mo>=</mo>
    <mfrac>
     <mrow>
      <msup>
       <mi>u</mi>
       <mn>2</mn>
      </msup>
      <mo>-</mo>
      <msup>
       <mi>v</mi>
       <mn>2</mn>
      </msup>
     </mrow>
     <mn>2</mn>
    </mfrac>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>b</ci>
    <apply>
     <divide></divide>
     <apply>
      <minus></minus>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>u</ci>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>v</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
     <cn type="integer">2</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   b=\frac{u^{2}-v^{2}}{2},
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Tree_of_primitive_Pythagorean_triples:11">
 <semantics>
  <mrow>
   <mrow>
    <mi>c</mi>
    <mo>=</mo>
    <mfrac>
     <mrow>
      <msup>
       <mi>u</mi>
       <mn>2</mn>
      </msup>
      <mo>+</mo>
      <msup>
       <mi>v</mi>
       <mn>2</mn>
      </msup>
     </mrow>
     <mn>2</mn>
    </mfrac>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>c</ci>
    <apply>
     <divide></divide>
     <apply>
      <plus></plus>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>u</ci>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>v</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
     <cn type="integer">2</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   c=\frac{u^{2}+v^{2}}{2},
  </annotation>
 </semantics>
</math>

</p>

<p>with <em>u</em> &gt; <em>v</em> &gt; 0 and <em>u</em> and <em>v</em> coprime and <em>both odd</em>. Pairs (<em>u</em>, <em>v</em>) can be iterated by pre-multiplying them (expressed as a column vector) by any of the above 2 × 2 matrices, all three of which preserve the inequalities, coprimeness, and the odd parity of both elements. When this process is begun at (3, 1), the resulting ternary tree contains every such (<em>u</em>, <em>v</em>) pair exactly once, and when converted into (<em>a</em>, <em>b</em>, <em>c</em>) triples it becomes identical to the tree described above.</p>
<h2 id="a-different-tree">A different tree</h2>

<p>A different tree found by Price<a class="footnoteRef" href="#fn9" id="fnref9"><sup>9</sup></a> may be produced in a similar way using matrices A',B',C' shown below. (See <a href="Formulas_for_generating_Pythagorean_triples#Pythagorean_triples_by_use_of_matrices_and_linear_transformations" title="wikilink">Pythagorean triples by use of matrices and linear transformations</a>.)</p>

<p>

<math display="block" id="Tree_of_primitive_Pythagorean_triples:12">
 <semantics>
  <mtable displaystyle="true">
   <mtr>
    <mtd columnalign="left">
     <mrow>
      <msup>
       <mi>A</mi>
       <mo>′</mo>
      </msup>
      <mo>=</mo>
      <mrow>
       <mo>[</mo>
       <mtable displaystyle="true">
        <mtr>
         <mtd columnalign="center">
          <mn>2</mn>
         </mtd>
         <mtd columnalign="center">
          <mn>1</mn>
         </mtd>
         <mtd columnalign="center">
          <mrow>
           <mo>-</mo>
           <mn>1</mn>
          </mrow>
         </mtd>
        </mtr>
        <mtr>
         <mtd columnalign="center">
          <mrow>
           <mo>-</mo>
           <mn>2</mn>
          </mrow>
         </mtd>
         <mtd columnalign="center">
          <mn>2</mn>
         </mtd>
         <mtd columnalign="center">
          <mn>2</mn>
         </mtd>
        </mtr>
        <mtr>
         <mtd columnalign="center">
          <mrow>
           <mo>-</mo>
           <mn>2</mn>
          </mrow>
         </mtd>
         <mtd columnalign="center">
          <mn>1</mn>
         </mtd>
         <mtd columnalign="center">
          <mn>3</mn>
         </mtd>
        </mtr>
       </mtable>
       <mo>]</mo>
      </mrow>
     </mrow>
    </mtd>
    <mtd columnalign="center">
     <mrow>
      <msup>
       <mi>B</mi>
       <mo>′</mo>
      </msup>
      <mo>=</mo>
      <mrow>
       <mo>[</mo>
       <mtable displaystyle="true">
        <mtr>
         <mtd columnalign="center">
          <mn>2</mn>
         </mtd>
         <mtd columnalign="center">
          <mn>1</mn>
         </mtd>
         <mtd columnalign="center">
          <mn>1</mn>
         </mtd>
        </mtr>
        <mtr>
         <mtd columnalign="center">
          <mn>2</mn>
         </mtd>
         <mtd columnalign="center">
          <mrow>
           <mo>-</mo>
           <mn>2</mn>
          </mrow>
         </mtd>
         <mtd columnalign="center">
          <mn>2</mn>
         </mtd>
        </mtr>
        <mtr>
         <mtd columnalign="center">
          <mn>2</mn>
         </mtd>
         <mtd columnalign="center">
          <mrow>
           <mo>-</mo>
           <mn>1</mn>
          </mrow>
         </mtd>
         <mtd columnalign="center">
          <mn>3</mn>
         </mtd>
        </mtr>
       </mtable>
       <mo>]</mo>
      </mrow>
     </mrow>
    </mtd>
    <mtd columnalign="right">
     <mrow>
      <msup>
       <mi>C</mi>
       <mo>′</mo>
      </msup>
      <mo>=</mo>
      <mrow>
       <mo>[</mo>
       <mtable displaystyle="true">
        <mtr>
         <mtd columnalign="center">
          <mn>2</mn>
         </mtd>
         <mtd columnalign="center">
          <mrow>
           <mo>-</mo>
           <mn>1</mn>
          </mrow>
         </mtd>
         <mtd columnalign="center">
          <mn>1</mn>
         </mtd>
        </mtr>
        <mtr>
         <mtd columnalign="center">
          <mn>2</mn>
         </mtd>
         <mtd columnalign="center">
          <mn>2</mn>
         </mtd>
         <mtd columnalign="center">
          <mn>2</mn>
         </mtd>
        </mtr>
        <mtr>
         <mtd columnalign="center">
          <mn>2</mn>
         </mtd>
         <mtd columnalign="center">
          <mn>1</mn>
         </mtd>
         <mtd columnalign="center">
          <mn>3</mn>
         </mtd>
        </mtr>
       </mtable>
       <mo>]</mo>
      </mrow>
     </mrow>
    </mtd>
   </mtr>
  </mtable>
  <annotation-xml encoding="MathML-Content">
   <matrix>
    <matrixrow>
     <apply>
      <eq></eq>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>A</ci>
       <ci>normal-′</ci>
      </apply>
      <matrix>
       <matrixrow>
        <cn type="integer">2</cn>
        <cn type="integer">1</cn>
        <apply>
         <minus></minus>
         <cn type="integer">1</cn>
        </apply>
       </matrixrow>
       <matrixrow>
        <apply>
         <minus></minus>
         <cn type="integer">2</cn>
        </apply>
        <cn type="integer">2</cn>
        <cn type="integer">2</cn>
       </matrixrow>
       <matrixrow>
        <apply>
         <minus></minus>
         <cn type="integer">2</cn>
        </apply>
        <cn type="integer">1</cn>
        <cn type="integer">3</cn>
       </matrixrow>
      </matrix>
     </apply>
     <apply>
      <eq></eq>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>B</ci>
       <ci>normal-′</ci>
      </apply>
      <matrix>
       <matrixrow>
        <cn type="integer">2</cn>
        <cn type="integer">1</cn>
        <cn type="integer">1</cn>
       </matrixrow>
       <matrixrow>
        <cn type="integer">2</cn>
        <apply>
         <minus></minus>
         <cn type="integer">2</cn>
        </apply>
        <cn type="integer">2</cn>
       </matrixrow>
       <matrixrow>
        <cn type="integer">2</cn>
        <apply>
         <minus></minus>
         <cn type="integer">1</cn>
        </apply>
        <cn type="integer">3</cn>
       </matrixrow>
      </matrix>
     </apply>
     <apply>
      <eq></eq>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>C</ci>
       <ci>normal-′</ci>
      </apply>
      <matrix>
       <matrixrow>
        <cn type="integer">2</cn>
        <apply>
         <minus></minus>
         <cn type="integer">1</cn>
        </apply>
        <cn type="integer">1</cn>
       </matrixrow>
       <matrixrow>
        <cn type="integer">2</cn>
        <cn type="integer">2</cn>
        <cn type="integer">2</cn>
       </matrixrow>
       <matrixrow>
        <cn type="integer">2</cn>
        <cn type="integer">1</cn>
        <cn type="integer">3</cn>
       </matrixrow>
      </matrix>
     </apply>
    </matrixrow>
   </matrix>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \begin{array}[]{lcr}A^{\prime}=\begin{bmatrix}2&1&-1\\
-2&2&2\\
-2&1&3\end{bmatrix}&B^{\prime}=\begin{bmatrix}2&1&1\\
2&-2&2\\
2&-1&3\end{bmatrix}&C^{\prime}=\begin{bmatrix}2&-1&1\\
2&2&2\\
2&1&3\end{bmatrix}\end{array}
  </annotation>
 </semantics>
</math>

</p>
<h2 id="notes-and-references">Notes and references</h2>
<h2 id="external-links">External links</h2>
<ul>
<li><a href="https://web.archive.org/web/20070616141532/http://www.cut-the-knot.org/pythagoras/PT_matrix.shtml">The Trinary Tree(s) underlying Primitive Pythagorean Triples</a> at <a class="uri" href="cut-the-knot" title="wikilink">cut-the-knot</a></li>
<li>Frank R. Bernhart, and H. Lee Price, "Pythagoras' garden, revisited", Australian Senior Mathematics Journal 01/2012; 26(1):29-40.<a href="http://www.eric.ed.gov/PDFS/EJ992372.pdf">1</a></li>
</ul>

<p>"</p>

<p><a href="Category:Diophantine_equations" title="wikilink">Category:Diophantine equations</a> <a href="Category:Trees_(data_structures)" title="wikilink">Category:Trees (data structures)</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1">B. Berggren, "Pytagoreiska trianglar" (in Swedish), <em>Elementa: Tidskrift för elementär matematik, fysik och kemi</em> 17 (1934), 129–139. See page 6 for the rooted tree.<a href="#fnref1">↩</a></li>
<li id="fn2">Barning, F. J. M. (1963), "Over pythagorese en bijna-pythagorese driehoeken en een generatieproces met behulp van unimodulaire matrices" (in Dutch), Math. Centrum Amsterdam Afd. Zuivere Wisk. ZW-011: 37, <a class="uri" href="http://oai.cwi.nl/oai/asset/7151/7151A.pdf">http://oai.cwi.nl/oai/asset/7151/7151A.pdf</a><a href="#fnref2">↩</a></li>
<li id="fn3">A. Hall, "Genealogy of Pythagorean Triads", <em><a href="The_Mathematical_Gazette" title="wikilink">The Mathematical Gazette</a></em>, volume 54, number 390, December, 1970, pages 377–9.<a href="#fnref3">↩</a></li>
<li id="fn4">Kanga, A. R., "The family tree of Pythagorean triples," <em>Bulletin of the <a href="Institute_of_Mathematics_and_its_Applications" title="wikilink">Institute of Mathematics and its Applications</a></em> 26, January/February 1990, 15–17.<a href="#fnref4">↩</a></li>
<li id="fn5"><a href="#fnref5">↩</a></li>
<li id="fn6">Mitchell, Douglas W., "Feedback on 92.60", <em>Mathematical Gazette</em> 93, July 2009, 358–9.<a href="#fnref6">↩</a></li>
<li id="fn7">.<a href="#fnref7">↩</a></li>
<li id="fn8">Mitchell, Douglas W., "An alternative characterisation of all primitive Pythagorean triples", <em>Mathematical Gazette</em> 85, July 2001, 273–275.<a href="#fnref8">↩</a></li>
<li id="fn9"></li>
</ol>
</section>
</body>
</html>

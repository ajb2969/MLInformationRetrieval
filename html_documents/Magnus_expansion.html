<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="204">Magnus expansion</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Magnus expansion</h1>
<hr/>

<p>In <a class="uri" href="mathematics" title="wikilink">mathematics</a> and <a class="uri" href="physics" title="wikilink">physics</a>, the <strong>Magnus expansion</strong>, named after <a href="Wilhelm_Magnus" title="wikilink">Wilhelm Magnus</a> (1907–1990), provides an exponential representation of the solution of a first order homogeneous <a href="linear_differential_equation" title="wikilink">linear differential equation</a> for a <a href="linear_operator" title="wikilink">linear operator</a>. In particular it furnishes the fundamental matrix of a system of linear <a href="ordinary_differential_equations" title="wikilink">ordinary differential equations</a> of order 

<math display="inline" id="Magnus_expansion:0">
 <semantics>
  <mi>n</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>n</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n
  </annotation>
 </semantics>
</math>

 with varying coefficients. The exponent is built up as an infinite series whose terms involve multiple integrals and nested commutators.</p>
<h2 id="magnus-approach-and-its-interpretation">Magnus approach and its interpretation</h2>

<p>Given the 

<math display="inline" id="Magnus_expansion:1">
 <semantics>
  <mrow>
   <mi>n</mi>
   <mi mathvariant="normal">×</mi>
   <mi>n</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>n</ci>
    <ci>normal-×</ci>
    <ci>n</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n×n
  </annotation>
 </semantics>
</math>

 coefficient matrix 

<math display="inline" id="Magnus_expansion:2">
 <semantics>
  <mrow>
   <mi>A</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>t</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>A</ci>
    <ci>t</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A(t)
  </annotation>
 </semantics>
</math>

, one wishes to solve the <a href="initial_value_problem" title="wikilink">initial value problem</a> associated with the linear ordinary differential equation</p>

<p>

<math display="block" id="Magnus_expansion:3">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <msup>
      <mi>Y</mi>
      <mo>′</mo>
     </msup>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>t</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mi>A</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>t</mi>
      <mo stretchy="false">)</mo>
     </mrow>
     <mi>Y</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>t</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo rspace="42.5pt">,</mo>
   <mrow>
    <mrow>
     <mi>Y</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <msub>
       <mi>t</mi>
       <mn>0</mn>
      </msub>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <msub>
     <mi>Y</mi>
     <mn>0</mn>
    </msub>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <eq></eq>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>Y</ci>
       <ci>normal-′</ci>
      </apply>
      <ci>t</ci>
     </apply>
     <apply>
      <times></times>
      <ci>A</ci>
      <ci>t</ci>
      <ci>Y</ci>
      <ci>t</ci>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <apply>
      <times></times>
      <ci>Y</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>t</ci>
       <cn type="integer">0</cn>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>Y</ci>
      <cn type="integer">0</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Y^{\prime}(t)=A(t)Y(t),\qquad\qquad Y(t_{0})=Y_{0}
  </annotation>
 </semantics>
</math>

</p>

<p>for the unknown 

<math display="inline" id="Magnus_expansion:4">
 <semantics>
  <mi>n</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>n</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n
  </annotation>
 </semantics>
</math>

-dimensional vector function 

<math display="inline" id="Magnus_expansion:5">
 <semantics>
  <mrow>
   <mi>Y</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>t</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>Y</ci>
    <ci>t</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Y(t)
  </annotation>
 </semantics>
</math>

.</p>

<p>When <em>n</em> = 1, the solution simply reads</p>

<p>

<math display="block" id="Magnus_expansion:6">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>Y</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>t</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mi>exp</mi>
      <mrow>
       <mo>(</mo>
       <mrow>
        <msubsup>
         <mo largeop="true" symmetric="true">∫</mo>
         <msub>
          <mi>t</mi>
          <mn>0</mn>
         </msub>
         <mi>t</mi>
        </msubsup>
        <mrow>
         <mi>A</mi>
         <mrow>
          <mo stretchy="false">(</mo>
          <mi>s</mi>
          <mo rspace="4.2pt" stretchy="false">)</mo>
         </mrow>
         <mi>d</mi>
         <mi>s</mi>
        </mrow>
       </mrow>
       <mo>)</mo>
      </mrow>
     </mrow>
     <msub>
      <mi>Y</mi>
      <mn>0</mn>
     </msub>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>Y</ci>
     <ci>t</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <exp></exp>
      <apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <int></int>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>t</ci>
          <cn type="integer">0</cn>
         </apply>
        </apply>
        <ci>t</ci>
       </apply>
       <apply>
        <times></times>
        <ci>A</ci>
        <ci>s</ci>
        <ci>d</ci>
        <ci>s</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>Y</ci>
      <cn type="integer">0</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Y(t)=\exp\left(\int_{t_{0}}^{t}A(s)\,ds\right)Y_{0}.
  </annotation>
 </semantics>
</math>

</p>

<p>This is still valid for <em>n</em> &gt; 1 if the matrix 

<math display="inline" id="Magnus_expansion:7">
 <semantics>
  <mrow>
   <mi>A</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>t</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>A</ci>
    <ci>t</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A(t)
  </annotation>
 </semantics>
</math>

 satisfies <mtpl> <em>A</em>(<em>t</em><sub>2</sub>) <em>A</em>(<em>t</em><sub>1</sub>)}}</mtpl> for any pair of values of <em>t</em>, <em>t</em><sub>1</sub> and <em>t</em><sub>2</sub>. In particular, this is the case if the matrix 

<math display="inline" id="Magnus_expansion:8">
 <semantics>
  <mi>A</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>A</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A
  </annotation>
 </semantics>
</math>

 is independent of 

<math display="inline" id="Magnus_expansion:9">
 <semantics>
  <mi>t</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>t</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   t
  </annotation>
 </semantics>
</math>

. In the general case, however, the expression above is no longer the solution of the problem.</p>

<p>The approach introduced by Magnus to solve the matrix initial value problem is to express the solution by means of the exponential of a certain 

<math display="inline" id="Magnus_expansion:10">
 <semantics>
  <mrow>
   <mi>n</mi>
   <mi mathvariant="normal">×</mi>
   <mi>n</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>n</ci>
    <ci>normal-×</ci>
    <ci>n</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n×n
  </annotation>
 </semantics>
</math>

 matrix function <mtpl></mtpl>,</p>

<p>

<math display="block" id="Magnus_expansion:11">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>Y</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>t</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mi>exp</mi>
      <mrow>
       <mo>(</mo>
       <mrow>
        <mi mathvariant="normal">Ω</mi>
        <mrow>
         <mo stretchy="false">(</mo>
         <mi>t</mi>
         <mo>,</mo>
         <msub>
          <mi>t</mi>
          <mn>0</mn>
         </msub>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
       <mo rspace="4.2pt">)</mo>
      </mrow>
     </mrow>
     <mpadded width="+3.3pt">
      <msub>
       <mi>Y</mi>
       <mn>0</mn>
      </msub>
     </mpadded>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>Y</ci>
     <ci>t</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <exp></exp>
      <apply>
       <times></times>
       <ci>normal-Ω</ci>
       <interval closure="open">
        <ci>t</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>t</ci>
         <cn type="integer">0</cn>
        </apply>
       </interval>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>Y</ci>
      <cn type="integer">0</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Y(t)=\exp\left(\Omega(t,t_{0})\right)\,Y_{0}~{},
  </annotation>
 </semantics>
</math>

 which is subsequently constructed as a <a href="Series_(mathematics)" title="wikilink">series</a> expansion,</p>
<dl>
<dd><dl>
<dd>

<math display="inline" id="Magnus_expansion:12">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi mathvariant="normal">Ω</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>t</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <msubsup>
      <mo largeop="true" symmetric="true">∑</mo>
      <mrow>
       <mi>k</mi>
       <mo>=</mo>
       <mn>1</mn>
      </mrow>
      <mi mathvariant="normal">∞</mi>
     </msubsup>
     <mrow>
      <msub>
       <mi mathvariant="normal">Ω</mi>
       <mi>k</mi>
      </msub>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>t</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>normal-Ω</ci>
     <ci>t</ci>
    </apply>
    <apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <apply>
        <eq></eq>
        <ci>k</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <infinity></infinity>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>normal-Ω</ci>
       <ci>k</ci>
      </apply>
      <ci>t</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Omega(t)=\sum_{k=1}^{\infty}\Omega_{k}(t),
  </annotation>
 </semantics>
</math>


</dd>
</dl>
</dd>
</dl>

<p>where, for simplicity, it is customary to write 

<math display="inline" id="Magnus_expansion:13">
 <semantics>
  <mrow>
   <mi mathvariant="normal">Ω</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>t</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>normal-Ω</ci>
    <ci>t</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Ω(t)
  </annotation>
 </semantics>
</math>

 for <mtpl></mtpl> and to take <em>t</em><sub>0</sub> = 0.</p>

<p>Magnus appreciated that, since <mtpl> <em>A</em>(<em>t</em>)}}</mtpl>, using a <a href="Derivative_of_the_exponential_map" title="wikilink">Poincaré−Hausdorff</a> matrix identity, he could relate the time-derivative of 

<math display="inline" id="Magnus_expansion:14">
 <semantics>
  <mi mathvariant="normal">Ω</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>normal-Ω</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Ω
  </annotation>
 </semantics>
</math>

 to the generating function of <a href="Bernoulli_number#Generating_function" title="wikilink">Bernoulli numbers</a> and the <a href="Adjoint_representation_of_a_Lie_algebra" title="wikilink">adjoint endomorphism</a> of 

<math display="inline" id="Magnus_expansion:15">
 <semantics>
  <mi mathvariant="normal">Ω</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>normal-Ω</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Ω
  </annotation>
 </semantics>
</math>

,</p>
<dl>
<dd><dl>
<dd>

<math display="inline" id="Magnus_expansion:16">
 <semantics>
  <mrow>
   <mrow>
    <msup>
     <mi mathvariant="normal">Ω</mi>
     <mo>′</mo>
    </msup>
    <mo>=</mo>
    <mrow>
     <mpadded width="+3.3pt">
      <mfrac>
       <msub>
        <mo>ad</mo>
        <mi mathvariant="normal">Ω</mi>
       </msub>
       <mrow>
        <mrow>
         <mi>exp</mi>
         <mrow>
          <mo stretchy="false">(</mo>
          <msub>
           <mo>ad</mo>
           <mi mathvariant="normal">Ω</mi>
          </msub>
          <mo stretchy="false">)</mo>
         </mrow>
        </mrow>
        <mo>-</mo>
        <mn>1</mn>
       </mrow>
      </mfrac>
     </mpadded>
     <mpadded width="+3.3pt">
      <mi>A</mi>
     </mpadded>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>normal-Ω</ci>
     <ci>normal-′</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <divide></divide>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>ad</ci>
       <ci>normal-Ω</ci>
      </apply>
      <apply>
       <minus></minus>
       <apply>
        <exp></exp>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>ad</ci>
         <ci>normal-Ω</ci>
        </apply>
       </apply>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <ci>A</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Omega^{\prime}=\frac{\operatorname{ad}_{\Omega}}{\exp(\operatorname{ad}_{%
\Omega})-1}~{}A~{},
  </annotation>
 </semantics>
</math>


</dd>
</dl>
</dd>
</dl>

<p>to solve for 

<math display="inline" id="Magnus_expansion:17">
 <semantics>
  <mi mathvariant="normal">Ω</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>normal-Ω</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Ω
  </annotation>
 </semantics>
</math>

 recursively in terms of 

<math display="inline" id="Magnus_expansion:18">
 <semantics>
  <mi>A</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>A</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A
  </annotation>
 </semantics>
</math>

, "in a continuous analog of the <a href="Baker–Campbell–Hausdorff_formula" title="wikilink">CBH expansion</a>", as outlined in a subsequent section.</p>

<p>The equation above constitutes the <strong>Magnus expansion</strong> or <strong>Magnus series</strong> for the solution of matrix linear initial value problem. The first four terms of this series read</p>

<p>

<math display="inline" id="Magnus_expansion:19">
 <semantics>
  <mrow>
   <msub>
    <mi mathvariant="normal">Ω</mi>
    <mn>1</mn>
   </msub>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>t</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>normal-Ω</ci>
     <cn type="integer">1</cn>
    </apply>
    <ci>t</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle\Omega_{1}(t)
  </annotation>
 </semantics>
</math>


 where 

<math display="inline" id="Magnus_expansion:20">
 <semantics>
  <mrow>
   <mrow>
    <mi>A</mi>
    <mi>A</mi>
   </mrow>
   <mo>,</mo>
   <mrow>
    <mi>B</mi>
    <mi mathvariant="normal">≡</mi>
    <mi>A</mi>
    <mi>B</mi>
    <mi mathvariant="normal">−</mi>
    <mi>B</mi>
    <mi>A</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <list>
    <apply>
     <times></times>
     <ci>A</ci>
     <ci>A</ci>
    </apply>
    <apply>
     <times></times>
     <ci>B</ci>
     <ci>normal-≡</ci>
     <ci>A</ci>
     <ci>B</ci>
     <ci>normal-−</ci>
     <ci>B</ci>
     <ci>A</ci>
    </apply>
   </list>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   AA,B≡AB−BA
  </annotation>
 </semantics>
</math>

 is the matrix <a class="uri" href="commutator" title="wikilink">commutator</a> of <em>A</em> and <em>B</em>.</p>

<p>These equations may be interpreted as follows: <mtpl></mtpl> coincides exactly with the exponent in the scalar (

<math display="inline" id="Magnus_expansion:21">
 <semantics>
  <mi>n</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>n</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n
  </annotation>
 </semantics>
</math>

 = 1) case, but this equation cannot give the whole solution. If one insists in having an exponential representation (<a href="Lie_group" title="wikilink">Lie group</a>), the exponent needs to be corrected. The rest of the Magnus series provides that correction systematically: 

<math display="inline" id="Magnus_expansion:22">
 <semantics>
  <mi mathvariant="normal">Ω</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>normal-Ω</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Ω
  </annotation>
 </semantics>
</math>

 or parts of it are in the <a href="Lie_algebra" title="wikilink">Lie algebra</a> of the <a href="Lie_group" title="wikilink">Lie group</a> of the evolution.</p>

<p>In applications, one can rarely sum exactly the Magnus series and one has to truncate it to get approximate solutions. The main advantage of the Magnus proposal is that, very often, the truncated series still shares with the exact solution important qualitative properties, at variance with other conventional <a href="Perturbation_theory" title="wikilink">perturbation</a> theories. For instance, in <a href="classical_mechanics" title="wikilink">classical mechanics</a> the <a href="Symplectic_geometry" title="wikilink">symplectic</a> character of the <a href="time_evolution" title="wikilink">time evolution</a> is preserved at every order of approximation. Similarly the <a href="unitary_operator" title="wikilink">unitary</a> character of the time evolution operator in <a href="quantum_mechanics" title="wikilink">quantum mechanics</a> is also preserved (in contrast, e.g., to the <a href="Dyson_series" title="wikilink">Dyson series</a> solving the same problem).</p>
<h2 id="convergence-of-the-expansion">Convergence of the expansion</h2>

<p>From a mathematical point of view, the convergence problem is the following: given a certain matrix 

<math display="inline" id="Magnus_expansion:23">
 <semantics>
  <mrow>
   <mi>A</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>t</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>A</ci>
    <ci>t</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A(t)
  </annotation>
 </semantics>
</math>

, when can the exponent 

<math display="inline" id="Magnus_expansion:24">
 <semantics>
  <mrow>
   <mi mathvariant="normal">Ω</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>t</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>normal-Ω</ci>
    <ci>t</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Ω(t)
  </annotation>
 </semantics>
</math>

 be obtained as the sum of the Magnus series?</p>

<p>A sufficient condition for this series to <a href="convergent_series" title="wikilink">converge</a> for 

<math display="inline" id="Magnus_expansion:25">
 <semantics>
  <mrow>
   <mi>t</mi>
   <mi mathvariant="normal">∈</mi>
   <mn>0</mn>
   <mo>,</mo>
   <mo>,</mo>
   <mi>T</mi>
   <mo stretchy="false">)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">t</csymbol>
    <csymbol cd="unknown">∈</csymbol>
    <cn type="integer">0</cn>
    <ci>normal-,</ci>
    <ci>normal-,</ci>
    <csymbol cd="unknown">T</csymbol>
    <ci>normal-)</ci>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   t∈0,,T)
  </annotation>
 </semantics>
</math>

 is</p>

<p>

<math display="block" id="Magnus_expansion:26">
 <semantics>
  <mrow>
   <mrow>
    <msubsup>
     <mo largeop="true" symmetric="true">∫</mo>
     <mn>0</mn>
     <mi>T</mi>
    </msubsup>
    <mrow>
     <msub>
      <mrow>
       <mo>∥</mo>
       <mrow>
        <mi>A</mi>
        <mrow>
         <mo stretchy="false">(</mo>
         <mi>s</mi>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
       <mo>∥</mo>
      </mrow>
      <mn>2</mn>
     </msub>
     <mi>d</mi>
     <mi>s</mi>
    </mrow>
   </mrow>
   <mo><</mo>
   <mi>π</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <lt></lt>
    <apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <int></int>
       <cn type="integer">0</cn>
      </apply>
      <ci>T</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <apply>
        <csymbol cd="latexml">norm</csymbol>
        <apply>
         <times></times>
         <ci>A</ci>
         <ci>s</ci>
        </apply>
       </apply>
       <cn type="integer">2</cn>
      </apply>
      <ci>d</ci>
      <ci>s</ci>
     </apply>
    </apply>
    <ci>π</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \int_{0}^{T}\|A(s)\|_{2}ds<\pi
  </annotation>
 </semantics>
</math>

 where 

<math display="inline" id="Magnus_expansion:27">
 <semantics>
  <mrow>
   <mo>∥</mo>
   <mo>⋅</mo>
   <msub>
    <mo>∥</mo>
    <mn>2</mn>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="latexml">parallel-to</csymbol>
    <ci>normal-⋅</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <csymbol cd="latexml">parallel-to</csymbol>
     <cn type="integer">2</cn>
    </apply>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \|\cdot\|_{2}
  </annotation>
 </semantics>
</math>

 denotes a <a href="matrix_norm" title="wikilink">matrix norm</a>. This result is generic, in the sense that one may construct specific matrices 

<math display="inline" id="Magnus_expansion:28">
 <semantics>
  <mrow>
   <mi>A</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>t</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>A</ci>
    <ci>t</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A(t)
  </annotation>
 </semantics>
</math>

 for which the series diverges for any 

<math display="inline" id="Magnus_expansion:29">
 <semantics>
  <mrow>
   <mi>t</mi>
   <mo>></mo>
   <mi>T</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <gt></gt>
    <ci>t</ci>
    <ci>T</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   t>T
  </annotation>
 </semantics>
</math>

.</p>
<h2 id="magnus-generator">Magnus generator</h2>

<p>A recursive procedure to generate all the terms in the Magnus expansion utilizes the matrices <mtpl></mtpl>, defined recursively through</p>

<p>

<math display="block" id="Magnus_expansion:30">
 <semantics>
  <mrow>
   <mrow>
    <msubsup>
     <mi>S</mi>
     <mi>n</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>j</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </msubsup>
    <mo>=</mo>
    <mrow>
     <munderover>
      <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
      <mrow>
       <mi>m</mi>
       <mo>=</mo>
       <mn>1</mn>
      </mrow>
      <mrow>
       <mi>n</mi>
       <mo>-</mo>
       <mi>j</mi>
      </mrow>
     </munderover>
     <mrow>
      <mo>[</mo>
      <msub>
       <mi mathvariant="normal">Ω</mi>
       <mi>m</mi>
      </msub>
      <mo>,</mo>
      <msubsup>
       <mi>S</mi>
       <mrow>
        <mi>n</mi>
        <mo>-</mo>
        <mi>m</mi>
       </mrow>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mi>j</mi>
         <mo>-</mo>
         <mn>1</mn>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
      </msubsup>
      <mo>]</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo rspace="42.5pt">,</mo>
   <mrow>
    <mn>2</mn>
    <mo>≤</mo>
    <mi>j</mi>
    <mo>≤</mo>
    <mrow>
     <mi>n</mi>
     <mo>-</mo>
     <mn>1</mn>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>S</ci>
       <ci>n</ci>
      </apply>
      <ci>j</ci>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <apply>
         <eq></eq>
         <ci>m</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <apply>
        <minus></minus>
        <ci>n</ci>
        <ci>j</ci>
       </apply>
      </apply>
      <interval closure="closed">
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>normal-Ω</ci>
        <ci>m</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>S</ci>
         <apply>
          <minus></minus>
          <ci>n</ci>
          <ci>m</ci>
         </apply>
        </apply>
        <apply>
         <minus></minus>
         <ci>j</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
      </interval>
     </apply>
    </apply>
    <apply>
     <and></and>
     <apply>
      <leq></leq>
      <cn type="integer">2</cn>
      <ci>j</ci>
     </apply>
     <apply>
      <leq></leq>
      <share href="#.cmml">
      </share>
      <apply>
       <minus></minus>
       <ci>n</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   S_{n}^{(j)}=\sum_{m=1}^{n-j}\left[\Omega_{m},S_{n-m}^{(j-1)}\right],\qquad%
\qquad 2\leq j\leq n-1
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Magnus_expansion:31">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <msubsup>
      <mi>S</mi>
      <mi>n</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mn>1</mn>
       <mo stretchy="false">)</mo>
      </mrow>
     </msubsup>
     <mo>=</mo>
     <mrow>
      <mo>[</mo>
      <msub>
       <mi mathvariant="normal">Ω</mi>
       <mrow>
        <mi>n</mi>
        <mo>-</mo>
        <mn>1</mn>
       </mrow>
      </msub>
      <mo>,</mo>
      <mi>A</mi>
      <mo>]</mo>
     </mrow>
    </mrow>
    <mo rspace="22.5pt">,</mo>
    <mrow>
     <msubsup>
      <mi>S</mi>
      <mi>n</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mi>n</mi>
        <mo>-</mo>
        <mn>1</mn>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
     </msubsup>
     <mo>=</mo>
     <mrow>
      <msubsup>
       <mi>ad</mi>
       <msub>
        <mi mathvariant="normal">Ω</mi>
        <mn>1</mn>
       </msub>
       <mrow>
        <mi>n</mi>
        <mo>-</mo>
        <mn>1</mn>
       </mrow>
      </msubsup>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>A</mi>
       <mo rspace="5.8pt" stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>S</ci>
       <ci>n</ci>
      </apply>
      <cn type="integer">1</cn>
     </apply>
     <interval closure="closed">
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>normal-Ω</ci>
       <apply>
        <minus></minus>
        <ci>n</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <ci>A</ci>
     </interval>
    </apply>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>S</ci>
       <ci>n</ci>
      </apply>
      <apply>
       <minus></minus>
       <ci>n</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>ad</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>normal-Ω</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <apply>
        <minus></minus>
        <ci>n</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <ci>A</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   S_{n}^{(1)}=\left[\Omega_{n-1},A\right],\qquad S_{n}^{(n-1)}=\mathrm{ad}_{%
\Omega_{1}}^{n-1}(A)~{},
  </annotation>
 </semantics>
</math>

 which then furnish</p>

<p>

<math display="block" id="Magnus_expansion:32">
 <semantics>
  <mrow>
   <msub>
    <mi mathvariant="normal">Ω</mi>
    <mn>1</mn>
   </msub>
   <mo>=</mo>
   <mrow>
    <msubsup>
     <mo largeop="true" symmetric="true">∫</mo>
     <mn>0</mn>
     <mi>t</mi>
    </msubsup>
    <mrow>
     <mi>A</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>τ</mi>
      <mo stretchy="false">)</mo>
     </mrow>
     <mi>d</mi>
     <mi>τ</mi>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>normal-Ω</ci>
     <cn type="integer">1</cn>
    </apply>
    <apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <int></int>
       <cn type="integer">0</cn>
      </apply>
      <ci>t</ci>
     </apply>
     <apply>
      <times></times>
      <ci>A</ci>
      <ci>τ</ci>
      <ci>d</ci>
      <ci>τ</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Omega_{1}=\int_{0}^{t}A(\tau)d\tau
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Magnus_expansion:33">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi mathvariant="normal">Ω</mi>
     <mi>n</mi>
    </msub>
    <mo>=</mo>
    <mrow>
     <munderover>
      <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
      <mrow>
       <mi>j</mi>
       <mo>=</mo>
       <mn>1</mn>
      </mrow>
      <mrow>
       <mi>n</mi>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
     </munderover>
     <mrow>
      <mfrac>
       <msub>
        <mi>B</mi>
        <mi>j</mi>
       </msub>
       <mrow>
        <mi>j</mi>
        <mo lspace="0pt" rspace="3.5pt">!</mo>
       </mrow>
      </mfrac>
      <mrow>
       <msubsup>
        <mo largeop="true" symmetric="true">∫</mo>
        <mn>0</mn>
        <mi>t</mi>
       </msubsup>
       <mrow>
        <msubsup>
         <mi>S</mi>
         <mi>n</mi>
         <mrow>
          <mo stretchy="false">(</mo>
          <mi>j</mi>
          <mo stretchy="false">)</mo>
         </mrow>
        </msubsup>
        <mrow>
         <mo stretchy="false">(</mo>
         <mi>τ</mi>
         <mo stretchy="false">)</mo>
        </mrow>
        <mi>d</mi>
        <mi>τ</mi>
       </mrow>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo rspace="42.5pt">,</mo>
   <mrow>
    <mi>n</mi>
    <mo>≥</mo>
    <mn>2.</mn>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>normal-Ω</ci>
      <ci>n</ci>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <apply>
         <eq></eq>
         <ci>j</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <apply>
        <minus></minus>
        <ci>n</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <apply>
       <times></times>
       <apply>
        <divide></divide>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>B</ci>
         <ci>j</ci>
        </apply>
        <apply>
         <factorial></factorial>
         <ci>j</ci>
        </apply>
       </apply>
       <apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <int></int>
          <cn type="integer">0</cn>
         </apply>
         <ci>t</ci>
        </apply>
        <apply>
         <times></times>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>S</ci>
           <ci>n</ci>
          </apply>
          <ci>j</ci>
         </apply>
         <ci>τ</ci>
         <ci>d</ci>
         <ci>τ</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <geq></geq>
     <ci>n</ci>
     <cn type="float">2.</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Omega_{n}=\sum_{j=1}^{n-1}\frac{B_{j}}{j!}\int_{0}^{t}S_{n}^{(j)}(\tau)d\tau,%
\qquad\qquad n\geq 2.
  </annotation>
 </semantics>
</math>

</p>

<p>Here, ad<sup><em>k</em></sup><sub><em>Ω</em></sub> is a shorthand for an iterated commutator, (see <a href="Adjoint_representation_of_a_Lie_algebra" title="wikilink">adjoint endomorphism</a>),</p>

<p>

<math display="block" id="Magnus_expansion:34">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mrow>
      <msubsup>
       <mi>ad</mi>
       <mi mathvariant="normal">Ω</mi>
       <mn>0</mn>
      </msubsup>
      <mi>A</mi>
     </mrow>
     <mo>=</mo>
     <mi>A</mi>
    </mrow>
    <mo rspace="22.5pt">,</mo>
    <mrow>
     <mrow>
      <msubsup>
       <mi>ad</mi>
       <mi mathvariant="normal">Ω</mi>
       <mrow>
        <mi>k</mi>
        <mo>+</mo>
        <mn>1</mn>
       </mrow>
      </msubsup>
      <mi>A</mi>
     </mrow>
     <mo>=</mo>
     <mrow>
      <mo stretchy="false">[</mo>
      <mi mathvariant="normal">Ω</mi>
      <mo>,</mo>
      <mrow>
       <msubsup>
        <mi>ad</mi>
        <mi mathvariant="normal">Ω</mi>
        <mi>k</mi>
       </msubsup>
       <mi>A</mi>
      </mrow>
      <mo stretchy="false">]</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <eq></eq>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>ad</ci>
        <ci>normal-Ω</ci>
       </apply>
       <cn type="integer">0</cn>
      </apply>
      <ci>A</ci>
     </apply>
     <ci>A</ci>
    </apply>
    <apply>
     <eq></eq>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>ad</ci>
        <ci>normal-Ω</ci>
       </apply>
       <apply>
        <plus></plus>
        <ci>k</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <ci>A</ci>
     </apply>
     <interval closure="closed">
      <ci>normal-Ω</ci>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>ad</ci>
         <ci>normal-Ω</ci>
        </apply>
        <ci>k</ci>
       </apply>
       <ci>A</ci>
      </apply>
     </interval>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathrm{ad}_{\Omega}^{0}A=A,\qquad\mathrm{ad}_{\Omega}^{k+1}A=[\Omega,\mathrm{%
ad}_{\Omega}^{k}A],
  </annotation>
 </semantics>
</math>

 while <mtpl></mtpl> are the <a href="Bernoulli_numbers" title="wikilink">Bernoulli numbers</a>.</p>

<p>Finally, when this recursion is worked out explicitly, it is possible to express <mtpl></mtpl> as a linear combination of <em>n</em>-fold integrals of <em>n</em>−1 nested commutators involving 

<math display="inline" id="Magnus_expansion:35">
 <semantics>
  <mi>n</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>n</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n
  </annotation>
 </semantics>
</math>

 matrices 

<math display="inline" id="Magnus_expansion:36">
 <semantics>
  <mi>A</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>A</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A
  </annotation>
 </semantics>
</math>

,</p>

<p>

<math display="block" id="Magnus_expansion:37">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mrow>
      <msub>
       <mi mathvariant="normal">Ω</mi>
       <mi>n</mi>
      </msub>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>t</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo>=</mo>
     <mrow>
      <munderover>
       <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
       <mrow>
        <mi>j</mi>
        <mo>=</mo>
        <mn>1</mn>
       </mrow>
       <mrow>
        <mi>n</mi>
        <mo>-</mo>
        <mn>1</mn>
       </mrow>
      </munderover>
      <mrow>
       <mpadded width="+1.7pt">
        <mfrac>
         <msub>
          <mi>B</mi>
          <mi>j</mi>
         </msub>
         <mrow>
          <mi>j</mi>
          <mo lspace="0pt" rspace="3.5pt">!</mo>
         </mrow>
        </mfrac>
       </mpadded>
       <mrow>
        <mpadded width="+1.7pt">
         <munder>
          <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
          <mstyle scriptlevel="+1">
           <mtable columnspacing="0.4em" rowspacing="0.2ex">
            <mtr>
             <mtd>
              <mrow>
               <mrow>
                <msub>
                 <mi>k</mi>
                 <mn>1</mn>
                </msub>
                <mo>+</mo>
                <mi mathvariant="normal">⋯</mi>
                <mo>+</mo>
                <msub>
                 <mi>k</mi>
                 <mi>j</mi>
                </msub>
               </mrow>
               <mo>=</mo>
               <mrow>
                <mi>n</mi>
                <mo>-</mo>
                <mn>1</mn>
               </mrow>
              </mrow>
             </mtd>
            </mtr>
            <mtr>
             <mtd>
              <mrow>
               <mrow>
                <msub>
                 <mi>k</mi>
                 <mn>1</mn>
                </msub>
                <mo>≥</mo>
                <mrow>
                 <mn>1</mn>
                 <mo>,</mo>
                 <mi mathvariant="normal">…</mi>
                </mrow>
               </mrow>
               <mo>,</mo>
               <mrow>
                <msub>
                 <mi>k</mi>
                 <mi>j</mi>
                </msub>
                <mo>≥</mo>
                <mn>1</mn>
               </mrow>
              </mrow>
             </mtd>
            </mtr>
           </mtable>
          </mstyle>
         </munder>
        </mpadded>
        <mrow>
         <mpadded width="+1.7pt">
          <msubsup>
           <mo largeop="true" symmetric="true">∫</mo>
           <mn>0</mn>
           <mi>t</mi>
          </msubsup>
         </mpadded>
         <mrow>
          <mpadded width="+1.7pt">
           <msub>
            <mi>ad</mi>
            <mrow>
             <msub>
              <mi mathvariant="normal">Ω</mi>
              <msub>
               <mi>k</mi>
               <mn>1</mn>
              </msub>
             </msub>
             <mrow>
              <mo stretchy="false">(</mo>
              <mi>τ</mi>
              <mo stretchy="false">)</mo>
             </mrow>
            </mrow>
           </msub>
          </mpadded>
          <msub>
           <mi>ad</mi>
           <mrow>
            <msub>
             <mi mathvariant="normal">Ω</mi>
             <msub>
              <mi>k</mi>
              <mn>2</mn>
             </msub>
            </msub>
            <mrow>
             <mo stretchy="false">(</mo>
             <mi>τ</mi>
             <mo stretchy="false">)</mo>
            </mrow>
           </mrow>
          </msub>
          <mpadded width="+1.7pt">
           <mi mathvariant="normal">⋯</mi>
          </mpadded>
          <msub>
           <mi>ad</mi>
           <mrow>
            <msub>
             <mi mathvariant="normal">Ω</mi>
             <msub>
              <mi>k</mi>
              <mi>j</mi>
             </msub>
            </msub>
            <mrow>
             <mo stretchy="false">(</mo>
             <mi>τ</mi>
             <mo stretchy="false">)</mo>
            </mrow>
           </mrow>
          </msub>
          <mi>A</mi>
          <mrow>
           <mo stretchy="false">(</mo>
           <mi>τ</mi>
           <mo rspace="4.2pt" stretchy="false">)</mo>
          </mrow>
          <mi>d</mi>
          <mi>τ</mi>
         </mrow>
        </mrow>
       </mrow>
      </mrow>
     </mrow>
    </mrow>
    <mrow>
     <mi>n</mi>
     <mo>≥</mo>
     <mn>2</mn>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <eq></eq>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>normal-Ω</ci>
       <ci>n</ci>
      </apply>
      <ci>t</ci>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <apply>
         <eq></eq>
         <ci>j</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <apply>
        <minus></minus>
        <ci>n</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <apply>
       <times></times>
       <apply>
        <divide></divide>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>B</ci>
         <ci>j</ci>
        </apply>
        <apply>
         <factorial></factorial>
         <ci>j</ci>
        </apply>
       </apply>
       <apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <sum></sum>
         <apply>
          <ci>STACKED</ci>
          <apply>
           <eq></eq>
           <apply>
            <plus></plus>
            <apply>
             <csymbol cd="ambiguous">subscript</csymbol>
             <ci>k</ci>
             <cn type="integer">1</cn>
            </apply>
            <ci>normal-⋯</ci>
            <apply>
             <csymbol cd="ambiguous">subscript</csymbol>
             <ci>k</ci>
             <ci>j</ci>
            </apply>
           </apply>
           <apply>
            <minus></minus>
            <ci>n</ci>
            <cn type="integer">1</cn>
           </apply>
          </apply>
          <apply>
           <csymbol cd="ambiguous">formulae-sequence</csymbol>
           <apply>
            <geq></geq>
            <apply>
             <csymbol cd="ambiguous">subscript</csymbol>
             <ci>k</ci>
             <cn type="integer">1</cn>
            </apply>
            <list>
             <cn type="integer">1</cn>
             <ci>normal-…</ci>
            </list>
           </apply>
           <apply>
            <geq></geq>
            <apply>
             <csymbol cd="ambiguous">subscript</csymbol>
             <ci>k</ci>
             <ci>j</ci>
            </apply>
            <cn type="integer">1</cn>
           </apply>
          </apply>
         </apply>
        </apply>
        <apply>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <int></int>
           <cn type="integer">0</cn>
          </apply>
          <ci>t</ci>
         </apply>
         <apply>
          <times></times>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>ad</ci>
           <apply>
            <times></times>
            <apply>
             <csymbol cd="ambiguous">subscript</csymbol>
             <ci>normal-Ω</ci>
             <apply>
              <csymbol cd="ambiguous">subscript</csymbol>
              <ci>k</ci>
              <cn type="integer">1</cn>
             </apply>
            </apply>
            <ci>τ</ci>
           </apply>
          </apply>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>ad</ci>
           <apply>
            <times></times>
            <apply>
             <csymbol cd="ambiguous">subscript</csymbol>
             <ci>normal-Ω</ci>
             <apply>
              <csymbol cd="ambiguous">subscript</csymbol>
              <ci>k</ci>
              <cn type="integer">2</cn>
             </apply>
            </apply>
            <ci>τ</ci>
           </apply>
          </apply>
          <ci>normal-⋯</ci>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>ad</ci>
           <apply>
            <times></times>
            <apply>
             <csymbol cd="ambiguous">subscript</csymbol>
             <ci>normal-Ω</ci>
             <apply>
              <csymbol cd="ambiguous">subscript</csymbol>
              <ci>k</ci>
              <ci>j</ci>
             </apply>
            </apply>
            <ci>τ</ci>
           </apply>
          </apply>
          <ci>A</ci>
          <ci>τ</ci>
          <ci>d</ci>
          <ci>τ</ci>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <geq></geq>
     <ci>n</ci>
     <cn type="integer">2</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Omega_{n}(t)=\sum_{j=1}^{n-1}\frac{B_{j}}{j!}\,\sum_{k_{1}+\cdots+k_{j}=n-1%
\atop k_{1}\geq 1,\ldots,k_{j}\geq 1}\,\int_{0}^{t}\,\mathrm{ad}_{\Omega_{k_{1%
}}(\tau)}\,\mathrm{ad}_{\Omega_{k_{2}}(\tau)}\cdots\,\mathrm{ad}_{\Omega_{k_{j%
}}(\tau)}A(\tau)\,d\tau\qquad n\geq 2,
  </annotation>
 </semantics>
</math>

 an expression which becomes increasingly intricate with 

<math display="inline" id="Magnus_expansion:38">
 <semantics>
  <mi>n</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>n</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n
  </annotation>
 </semantics>
</math>

.</p>
<h2 id="applications">Applications</h2>

<p>Since the 1960s, the Magnus expansion has been successfully applied as a perturbative tool in numerous areas of physics and chemistry, from <a href="atomic_physics" title="wikilink">atomic</a> and <a href="molecular_physics" title="wikilink">molecular physics</a> to <a href="nuclear_magnetic_resonance" title="wikilink">nuclear magnetic resonance</a><a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a> and <a href="quantum_electrodynamics" title="wikilink">quantum electrodynamics</a>. It has been also used since 1998 as a tool to construct practical algorithms for the numerical integration of matrix linear differential equations. As they inherit from the Magnus expansion the preservation of qualitative traits of the problem, the corresponding schemes are prototypical examples of <a href="geometric_integrator" title="wikilink">geometric numerical integrators</a>.</p>
<h2 id="see-also">See also</h2>
<ul>
<li><a href="Baker–Campbell–Hausdorff_formula" title="wikilink">Baker–Campbell–Hausdorff formula</a></li>
<li><a href="Derivative_of_the_exponential_map" title="wikilink">Derivative of the exponential map</a></li>
</ul>
<h2 id="references">References</h2>
<ul>
<li></li>
<li></li>
<li></li>
<li></li>
</ul>

<p>"</p>

<p><a href="Category:Ordinary_differential_equations" title="wikilink">Category:Ordinary differential equations</a> <a href="Category:Lie_algebras" title="wikilink">Category:Lie algebras</a> <a href="Category:Recursion_schemes" title="wikilink">Category:Recursion schemes</a> <a href="Category:Mathematical_physics" title="wikilink">Category:Mathematical physics</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1">1.Haeberlen, U. &amp; Waugh, J. S. Coherent Averaging Effects in Magnetic Resonance. Phys. Rev. 175, 453–467 (1968).<a href="#fnref1">↩</a></li>
</ol>
</section>
</body>
</html>

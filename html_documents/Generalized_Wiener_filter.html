<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="1293">Generalized Wiener filter</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Generalized Wiener filter</h1>
<hr/>

<p>The <a href="Wiener_filter" title="wikilink">Wiener filter</a> as originally proposed by <a href="Norbert_Wiener" title="wikilink">Norbert Wiener</a> is a <a href="signal_processing" title="wikilink">signal processing</a> <a href="Filter_(signal_processing)" title="wikilink">filter</a> which uses knowledge of the statistical properties of both the signal and the noise to reconstruct an optimal estimate of the signal from a noisy one-dimensional time-ordered data stream. The <strong>generalized Wiener filter</strong> generalizes the same idea beyond the domain of one-dimensional time-ordered signal processing, with two-dimensional <a href="image_processing" title="wikilink">image processing</a> being the most common application.<a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a></p>
<h2 id="description">Description</h2>

<p>Consider a data <a href="vector_space" title="wikilink">vector</a> 

<math display="inline" id="Generalized_Wiener_filter:0">
 <semantics>
  <mi>d</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>d</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   d
  </annotation>
 </semantics>
</math>

 which is the sum of <a href="statistically_independent" title="wikilink">independent</a> signal and noise vectors 

<math display="inline" id="Generalized_Wiener_filter:1">
 <semantics>
  <mrow>
   <mi>d</mi>
   <mo>=</mo>
   <mrow>
    <mi>s</mi>
    <mo>+</mo>
    <mi>n</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>d</ci>
    <apply>
     <plus></plus>
     <ci>s</ci>
     <ci>n</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   d=s+n
  </annotation>
 </semantics>
</math>

 with zero mean and <a href="covariance" title="wikilink">covariances</a> 

<math display="inline" id="Generalized_Wiener_filter:2">
 <semantics>
  <mrow>
   <mrow>
    <mo stretchy="false">⟨</mo>
    <mrow>
     <msup>
      <mi>s</mi>
      <mi>T</mi>
     </msup>
     <mi>s</mi>
    </mrow>
    <mo stretchy="false">⟩</mo>
   </mrow>
   <mo>=</mo>
   <mi>S</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="latexml">delimited-⟨⟩</csymbol>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>s</ci>
       <ci>T</ci>
      </apply>
      <ci>s</ci>
     </apply>
    </apply>
    <ci>S</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \langle s^{T}s\rangle=S
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Generalized_Wiener_filter:3">
 <semantics>
  <mrow>
   <mrow>
    <mo stretchy="false">⟨</mo>
    <mrow>
     <msup>
      <mi>n</mi>
      <mi>T</mi>
     </msup>
     <mi>n</mi>
    </mrow>
    <mo stretchy="false">⟩</mo>
   </mrow>
   <mo>=</mo>
   <mi>N</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="latexml">delimited-⟨⟩</csymbol>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>n</ci>
       <ci>T</ci>
      </apply>
      <ci>n</ci>
     </apply>
    </apply>
    <ci>N</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \langle n^{T}n\rangle=N
  </annotation>
 </semantics>
</math>

. The generalized Wiener Filter is the <a href="linear_operator" title="wikilink">linear operator</a> 

<math display="inline" id="Generalized_Wiener_filter:4">
 <semantics>
  <mi>G</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>G</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   G
  </annotation>
 </semantics>
</math>

 which minimizes the expected residual between the estimated signal and the true signal, 

<math display="inline" id="Generalized_Wiener_filter:5">
 <semantics>
  <mrow>
   <mi>e</mi>
   <mo>=</mo>
   <mrow>
    <mo stretchy="false">⟨</mo>
    <mrow>
     <msup>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mrow>
         <mi>G</mi>
         <mi>d</mi>
        </mrow>
        <mo>-</mo>
        <mi>s</mi>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
      <mi>T</mi>
     </msup>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mrow>
        <mi>G</mi>
        <mi>d</mi>
       </mrow>
       <mo>-</mo>
       <mi>s</mi>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo stretchy="false">⟩</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>e</ci>
    <apply>
     <csymbol cd="latexml">delimited-⟨⟩</csymbol>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <minus></minus>
        <apply>
         <times></times>
         <ci>G</ci>
         <ci>d</ci>
        </apply>
        <ci>s</ci>
       </apply>
       <ci>T</ci>
      </apply>
      <apply>
       <minus></minus>
       <apply>
        <times></times>
        <ci>G</ci>
        <ci>d</ci>
       </apply>
       <ci>s</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   e=\langle(Gd-s)^{T}(Gd-s)\rangle
  </annotation>
 </semantics>
</math>

. The 

<math display="inline" id="Generalized_Wiener_filter:6">
 <semantics>
  <mi>G</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>G</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   G
  </annotation>
 </semantics>
</math>

 that minimizes this is 

<math display="inline" id="Generalized_Wiener_filter:7">
 <semantics>
  <mrow>
   <mi>G</mi>
   <mo>=</mo>
   <mrow>
    <mi>S</mi>
    <msup>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mi>S</mi>
       <mo>+</mo>
       <mi>N</mi>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <mrow>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </msup>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>G</ci>
    <apply>
     <times></times>
     <ci>S</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <plus></plus>
       <ci>S</ci>
       <ci>N</ci>
      </apply>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   G=S(S+N)^{-1}
  </annotation>
 </semantics>
</math>

, resulting in the Wiener estimator 

<math display="inline" id="Generalized_Wiener_filter:8">
 <semantics>
  <mrow>
   <mover accent="true">
    <mi>s</mi>
    <mo stretchy="false">^</mo>
   </mover>
   <mo>=</mo>
   <mrow>
    <mi>S</mi>
    <msup>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mi>S</mi>
       <mo>+</mo>
       <mi>N</mi>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <mrow>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </msup>
    <mi>d</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <ci>normal-^</ci>
     <ci>s</ci>
    </apply>
    <apply>
     <times></times>
     <ci>S</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <plus></plus>
       <ci>S</ci>
       <ci>N</ci>
      </apply>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <ci>d</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \hat{s}=S(S+N)^{-1}d
  </annotation>
 </semantics>
</math>

. In the case of <a href="Normal_distribution" title="wikilink">Gaussian distributed</a> signal and noise, this estimator is also the <a href="Maximum_a_posteriori_estimation" title="wikilink">maximum a posteriori estimator</a>.</p>

<p>The generalized Wiener filter approaches 1 for signal-dominated parts of the data, and S/N for noise-dominated parts.</p>

<p>An often-seen variant expresses the filter in terms of inverse covariances. This is mathematically equivalent, but avoids excessive loss of numerical precision in the presence of high-variance modes. In this formulation, the generalized Wiener filter becomes 

<math display="inline" id="Generalized_Wiener_filter:9">
 <semantics>
  <mrow>
   <mi>G</mi>
   <mo>=</mo>
   <mrow>
    <msup>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <msup>
        <mi>S</mi>
        <mrow>
         <mo>-</mo>
         <mn>1</mn>
        </mrow>
       </msup>
       <mo>+</mo>
       <msup>
        <mi>N</mi>
        <mrow>
         <mo>-</mo>
         <mn>1</mn>
        </mrow>
       </msup>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <mrow>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </msup>
    <msup>
     <mi>N</mi>
     <mrow>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </msup>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>G</ci>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <plus></plus>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>S</ci>
        <apply>
         <minus></minus>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>N</ci>
        <apply>
         <minus></minus>
         <cn type="integer">1</cn>
        </apply>
       </apply>
      </apply>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>N</ci>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   G=(S^{-1}+N^{-1})^{-1}N^{-1}
  </annotation>
 </semantics>
</math>

 using the identity 

<math display="inline" id="Generalized_Wiener_filter:10">
 <semantics>
  <mrow>
   <mrow>
    <msup>
     <mi>A</mi>
     <mrow>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </msup>
    <mo>+</mo>
    <msup>
     <mi>B</mi>
     <mrow>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </msup>
   </mrow>
   <mo>=</mo>
   <mrow>
    <msup>
     <mi>A</mi>
     <mrow>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </msup>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>A</mi>
      <mo>+</mo>
      <mi>B</mi>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
    <msup>
     <mi>B</mi>
     <mrow>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </msup>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <plus></plus>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>A</ci>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>B</ci>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
      </apply>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>A</ci>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <apply>
      <plus></plus>
      <ci>A</ci>
      <ci>B</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>B</ci>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A^{-1}+B^{-1}=A^{-1}(A+B)B^{-1}
  </annotation>
 </semantics>
</math>

.</p>
<h2 id="an-example">An example</h2>

<p>The <a href="cosmic_microwave_background" title="wikilink">cosmic microwave background</a> (CMB) is a <a href="Lambda-CDM_model" title="wikilink">homogeneous and isotropic random field</a>, and its covariance is therefore diagonal in a <a href="spherical_harmonics" title="wikilink">spherical harmonics</a> basis. Any given observation of the CMB will be noisy, with the noise typically having different statistical properties than the CMB. It could for example be uncorrelated in pixel space. The generalized Wiener filter exploits this difference in behavior to isolate as much as possible of the signal from the noise. <a href="File:CMB_Wiener_filter_example.png" title="wikilink">thumb|upright=4|center|The result of applying a generalized Wiener filter to a noisy observation of the cosmic microwave background. The filter results in an image that is signal-dominated at all scales, at the cost of introducing a bias (seen as blurring in this example).</a></p>

<p>The Wiener-filtered estimate of the signal (the CMB in this case) 

<math display="inline" id="Generalized_Wiener_filter:11">
 <semantics>
  <mrow>
   <mover accent="true">
    <mi>s</mi>
    <mo stretchy="false">^</mo>
   </mover>
   <mo>=</mo>
   <mrow>
    <mi>S</mi>
    <msup>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mi>S</mi>
       <mo>+</mo>
       <mi>N</mi>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <mrow>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </msup>
    <mi>d</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <ci>normal-^</ci>
     <ci>s</ci>
    </apply>
    <apply>
     <times></times>
     <ci>S</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <plus></plus>
       <ci>S</ci>
       <ci>N</ci>
      </apply>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <ci>d</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \hat{s}=S(S+N)^{-1}d
  </annotation>
 </semantics>
</math>

 requires the inversion of the usually huge matrix 

<math display="inline" id="Generalized_Wiener_filter:12">
 <semantics>
  <mrow>
   <mi>S</mi>
   <mo>+</mo>
   <mi>N</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <plus></plus>
    <ci>S</ci>
    <ci>N</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   S+N
  </annotation>
 </semantics>
</math>

. If S and N were diagonal in the same basis this would be trivial, but often, as here, that isn't the case. The solution must in these cases be found by solving the equivalent equation 

<math display="inline" id="Generalized_Wiener_filter:13">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>S</mi>
      <mo>+</mo>
      <mi>N</mi>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
    <msup>
     <mi>S</mi>
     <mrow>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </msup>
    <mover accent="true">
     <mi>s</mi>
     <mo stretchy="false">^</mo>
    </mover>
   </mrow>
   <mo>=</mo>
   <mi>d</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <plus></plus>
      <ci>S</ci>
      <ci>N</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>S</ci>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <apply>
      <ci>normal-^</ci>
      <ci>s</ci>
     </apply>
    </apply>
    <ci>d</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (S+N)S^{-1}\hat{s}=d
  </annotation>
 </semantics>
</math>

, for example via <a href="conjugate_gradients" title="wikilink">conjugate gradients</a> iteration. In this case all the multiplications can be performed in the appropriate basis for each matrix, avoiding the need to store or invert more than their diagonal. The result can be seen in the figure.</p>
<h2 id="see-also">See also</h2>
<ul>
<li><a href="Wiener_filter" title="wikilink">Wiener filter</a></li>
<li><a href="Norbert_Wiener" title="wikilink">Norbert Wiener</a></li>
<li><a href="Wiener_deconvolution" title="wikilink">Wiener deconvolution</a></li>
<li><a href="Maximum_a_posteriori_estimation" title="wikilink">Maximum a posteriori estimation</a></li>
</ul>
<h2 id="references">References</h2>

<p>"</p>

<p><a href="Category:Signal_processing_filter" title="wikilink">Category:Signal processing filter</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1"><a href="#fnref1">↩</a></li>
</ol>
</section>
</body>
</html>

<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="1200">Wilson's theorem</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Wilson's theorem</h1>
<hr/>

<p>In <a href="number_theory" title="wikilink">number theory</a>, <strong>Wilson's theorem</strong> states that a natural number <em>n</em> &gt; 1 is a <a href="prime_number" title="wikilink">prime number</a> <a href="if_and_only_if" title="wikilink">if and only if</a></p>

<p>

<math display="block" id="Wilson's_theorem:0">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>n</mi>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
    <mo lspace="0pt" rspace="3.5pt">!</mo>
   </mrow>
   <mo rspace="7.5pt">≡</mo>
   <mrow>
    <mrow>
     <mo>-</mo>
     <mn>1</mn>
    </mrow>
    <mspace width="veryverythickmathspace">
    </mspace>
    <mrow>
     <mo lspace="8.1pt" stretchy="false">(</mo>
     <mrow>
      <mo>mod</mo>
      <mi>n</mi>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <equivalent></equivalent>
    <apply>
     <factorial></factorial>
     <apply>
      <minus></minus>
      <ci>n</ci>
      <cn type="integer">1</cn>
     </apply>
    </apply>
    <apply>
     <csymbol cd="latexml">annotated</csymbol>
     <apply>
      <minus></minus>
      <cn type="integer">1</cn>
     </apply>
     <apply>
      <ci>pmod</ci>
      <ci>n</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (n-1)!\ \equiv\ -1\;\;(\mathop{{\rm mod}}n)
  </annotation>
 </semantics>
</math>

.</p>

<p>That is, it asserts that the <a class="uri" href="factorial" title="wikilink">factorial</a> 

<math display="inline" id="Wilson's_theorem:1">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>n</mi>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
    <mo lspace="0pt" rspace="3.5pt">!</mo>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mn>1</mn>
    <mo>×</mo>
    <mn>2</mn>
    <mo>×</mo>
    <mn>3</mn>
    <mo>×</mo>
    <mi mathvariant="normal">⋯</mi>
    <mo>×</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>n</mi>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <factorial></factorial>
     <apply>
      <minus></minus>
      <ci>n</ci>
      <cn type="integer">1</cn>
     </apply>
    </apply>
    <apply>
     <times></times>
     <cn type="integer">1</cn>
     <cn type="integer">2</cn>
     <cn type="integer">3</cn>
     <ci>normal-⋯</ci>
     <apply>
      <minus></minus>
      <ci>n</ci>
      <cn type="integer">1</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (n-1)!=1\times 2\times 3\times\cdots\times(n-1)
  </annotation>
 </semantics>
</math>

 is one less than a multiple of <em>n</em> exactly when <em>n</em> is a prime number.</p>
<h2 id="history">History</h2>

<p>This theorem was stated by <a href="Ibn_al-Haytham" title="wikilink">Ibn al-Haytham</a> (c. 1000 AD),<a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a> and <a href="John_Wilson_(mathematician)" title="wikilink">John Wilson</a>.<a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a> <a href="Edward_Waring" title="wikilink">Edward Waring</a> announced the theorem in 1770, although neither he nor his student Wilson could prove it. <a href="Joseph_Louis_Lagrange" title="wikilink">Lagrange</a> gave the first proof in 1771.<a class="footnoteRef" href="#fn3" id="fnref3"><sup>3</sup></a> There is evidence that <a href="Gottfried_Leibniz" title="wikilink">Leibniz</a> was also aware of the result a century earlier, but he never published it.<ref>Giovanni Vacca (1899) "Sui manoscritti inediti di Leibniz" (On unpublished manuscripts of Leibniz), <em>Bollettino di bibliografia e storia delle scienze matematiche</em> ... (Bulletin of the bibliography and history of mathematics), vol. 2, pages 113–116; see [<a class="uri" href="http://books.google.com/books?id=vqwSAQAAMAAJ&amp;pg">http://books.google.com/books?id=vqwSAQAAMAAJ&amp;pg;</a>;=PA114#v=onepage&amp;q;&amp;f;=false page 114] (in Italian). Vacca quotes from Leibniz's mathematical manuscripts kept at the Royal Public Library in Hanover (Germany), vol. 3 B, bundle 11, page 10:</ref></p>
<blockquote>

<p><em>Original</em> : Inoltre egli intravide anche il teorema di Wilson, come risulta dall'enunciato seguente:<br/>
<br/>
"Productus continuorum usque ad numerum qui antepraecedit datum divisus per datum relinquit 1 (vel complementum ad unum?) si datus sit primitivus. Si datus sit derivativus relinquet numerum qui cum dato habeat communem mensuram unitate majorem."<br/>
<br/>
Egli non giunse pero a dimostrarlo.</p>
</blockquote>
<blockquote>

<p><em>Translation</em> : In addition, he [Leibniz] also glimpsed Wilson's theorem, as shown in the following statement:<br/>
<br/>
"The product of all integers preceding the given integer, when divided by the given integer, leaves 1 (or the complement of 1?) if the given integer be prime. If the given integer be composite, it leaves a number which has a common factor with the given integer [which is] greater than one."<br/>
<br/>
However, he didn't succeed in proving it.</p>
</blockquote>

<p>See also: Giuseppe Peano, ed., <em>Formulaire de mathématiques</em>, vol. 2, no. 3, [<a class="uri" href="http://books.google.com/books?id=bfDuAAAAMAAJ&amp;pg">http://books.google.com/books?id=bfDuAAAAMAAJ&amp;pg;</a>;=PA85#v=onepage&amp;q;&amp;f;=false page 85] (1897).</p>
<h2 id="example">Example</h2>

<p>The following table shows the values of <em>n</em> from 2 to 30, (<em>n</em> − 1)!, and the remainder when (<em>n</em> − 1)! is divided by <em>n</em>. (In the notation of <a href="modular_arithmetic" title="wikilink">modular arithmetic</a>, the remainder when <em>m</em> is divided by <em>n</em> is written <em>m</em> mod <em>n</em>.) The background color is <span style="background-color:#94DCF2">blue</span> for prime values of <em>n</em>, <span style="background-color:#E6C647">gold</span> for composite values.</p>
<table>
<tbody>
<tr class="odd">
<td style="text-align: left;">
<p>Table of remainder modulo <em>n</em></p></td>
<td style="text-align: left;">
<p>

<math display="inline" id="Wilson's_theorem:2">
 <semantics>
  <mi>n</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>n</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n
  </annotation>
 </semantics>
</math>

</p></td>
<td style="text-align: left;">
<p>

<math display="inline" id="Wilson's_theorem:3">
 <semantics>
  <mrow>
   <mrow>
    <mo stretchy="false">(</mo>
    <mrow>
     <mi>n</mi>
     <mo>-</mo>
     <mn>1</mn>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo lspace="0pt" rspace="3.5pt">!</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <factorial></factorial>
    <apply>
     <minus></minus>
     <ci>n</ci>
     <cn type="integer">1</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (n-1)!
  </annotation>
 </semantics>
</math>

 </p></td>
<td style="text-align: left;">
<p>

<math display="inline" id="Wilson's_theorem:4">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>n</mi>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
    <mo lspace="0pt" rspace="3.5pt">!</mo>
   </mrow>
   <mo lspace="2.5pt" rspace="7.5pt">mod</mo>
   <mi>n</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">modulo</csymbol>
    <apply>
     <factorial></factorial>
     <apply>
      <minus></minus>
      <ci>n</ci>
      <cn type="integer">1</cn>
     </apply>
    </apply>
    <ci>n</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (n-1)!\ \bmod\ n
  </annotation>
 </semantics>
</math>

 </p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>2</p></td>
<td style="text-align: left;">
<p>1</p></td>
<td style="text-align: left;">
<p>1</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>3</p></td>
<td style="text-align: left;">
<p>2</p></td>
<td style="text-align: left;">
<p>2</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>4</p></td>
<td style="text-align: left;">
<p>6</p></td>
<td style="text-align: left;">
<p>2</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>5</p></td>
<td style="text-align: left;">
<p>24</p></td>
<td style="text-align: left;">
<p>4</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>6</p></td>
<td style="text-align: left;">
<p>120</p></td>
<td style="text-align: left;">
<p>0</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>7</p></td>
<td style="text-align: left;">
<p>720</p></td>
<td style="text-align: left;">
<p>6</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>8</p></td>
<td style="text-align: left;">
<p>5040</p></td>
<td style="text-align: left;">
<p>0</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>9</p></td>
<td style="text-align: left;">
<p>40320</p></td>
<td style="text-align: left;">
<p>0</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>10</p></td>
<td style="text-align: left;">
<p>362880</p></td>
<td style="text-align: left;">
<p>0</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>11</p></td>
<td style="text-align: left;">
<p>3628800</p></td>
<td style="text-align: left;">
<p>10</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>12</p></td>
<td style="text-align: left;">
<p>39916800</p></td>
<td style="text-align: left;">
<p>0</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>13</p></td>
<td style="text-align: left;">
<p>479001600</p></td>
<td style="text-align: left;">
<p>12</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>14</p></td>
<td style="text-align: left;">
<p>6227020800</p></td>
<td style="text-align: left;">
<p>0</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>15</p></td>
<td style="text-align: left;">
<p>87178291200</p></td>
<td style="text-align: left;">
<p>0</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>16</p></td>
<td style="text-align: left;">
<p>1307674368000</p></td>
<td style="text-align: left;">
<p>0</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>17</p></td>
<td style="text-align: left;">
<p>20922789888000</p></td>
<td style="text-align: left;">
<p>16</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>18</p></td>
<td style="text-align: left;">
<p>355687428096000</p></td>
<td style="text-align: left;">
<p>0</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>19</p></td>
<td style="text-align: left;">
<p>6402373705728000</p></td>
<td style="text-align: left;">
<p>18</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>20</p></td>
<td style="text-align: left;">
<p>121645100408832000</p></td>
<td style="text-align: left;">
<p>0</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>21</p></td>
<td style="text-align: left;">
<p>2432902008176640000</p></td>
<td style="text-align: left;">
<p>0</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>22</p></td>
<td style="text-align: left;">
<p>51090942171709440000</p></td>
<td style="text-align: left;">
<p>0</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>23</p></td>
<td style="text-align: left;">
<p>1124000727777607680000</p></td>
<td style="text-align: left;">
<p>22</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>24</p></td>
<td style="text-align: left;">
<p>25852016738884976640000</p></td>
<td style="text-align: left;">
<p>0</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>25</p></td>
<td style="text-align: left;">
<p>620448401733239439360000</p></td>
<td style="text-align: left;">
<p>0</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>26</p></td>
<td style="text-align: left;">
<p>15511210043330985984000000</p></td>
<td style="text-align: left;">
<p>0</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>27</p></td>
<td style="text-align: left;">
<p>403291461126605635584000000</p></td>
<td style="text-align: left;">
<p>0</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>28</p></td>
<td style="text-align: left;">
<p>10888869450418352160768000000</p></td>
<td style="text-align: left;">
<p>0</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>29</p></td>
<td style="text-align: left;">
<p>304888344611713860501504000000</p></td>
<td style="text-align: left;">
<p>28</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>30</p></td>
<td style="text-align: left;">
<p>8841761993739701954543616000000</p></td>
<td style="text-align: left;">
<p>0</p></td>
</tr>
</tbody>
</table>
<h2 id="proofs">Proofs</h2>

<p>Both of the proofs (for prime moduli)<a class="footnoteRef" href="#fn4" id="fnref4"><sup>4</sup></a> below make use of the fact that the residue classes modulo a prime number are a <a href="finite_field" title="wikilink">field</a>—see the article <a href="Characteristic_(algebra)#Case_of_fields" title="wikilink">prime field</a> for more details. <a href="Lagrange's_theorem_(number_theory)" title="wikilink">Lagrange's theorem</a>, which states that in any field a polynomial of degree <em>n</em> has at most <em>n</em> roots, is needed for both proofs.</p>
<h3 id="composite-modulus">Composite modulus</h3>

<p>If <em>n</em> is composite it is divisible by some prime number <em>q</em>, where . If  were congruent to  then it would also be congruent to −1 (mod <em>q</em>). But (<em>n</em> − 1)! ≡ 0 (mod <em>q</em>).</p>

<p>In fact, more is true. With the sole exception of 4, where 3! = 6 ≡ 2 (mod 4), if <em>n</em> is composite then (<em>n</em> − 1)! is congruent to 0 (mod <em>n</em>). The proof is divided into two cases: First, if <em>n</em> can be factored as the product of two unequal numbers, , where 2 ≤ <em>a</em>  2. But then 2<em>q</em> 2 = <em>n</em>, both <em>q</em> and 2<em>q</em> will be factors of (<em>n</em> − 1)!, and again <em>n</em> divides (<em>n</em> − 1)!.</p>
<h3 id="prime-modulus">Prime modulus</h3>
<dl>
<dt>Elementary proof</dt>
</dl>

<p>The result is trivial when , so assume <em>p</em> is an odd prime, . Since the residue classes (mod <em>p</em>) are a field, every non-zero <em>a</em> has a unique multiplicative inverse, <em>a</em><sup>−1</sup>. Lagrange's theorem implies that the only values of <em>a</em> for which <mtpl></mtpl> are  (because the congruence <mtpl></mtpl> can have at most two roots (mod <em>p</em>)). Therefore, with the exception of ±1, the factors of  can be arranged in unequal pairs,<a class="footnoteRef" href="#fn5" id="fnref5"><sup>5</sup></a> where the product of each pair is . This proves Wilson's theorem.</p>

<p>For example, if ,</p>

<p>

<math display="block" id="Wilson's_theorem:5">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mn>10</mn>
     <mo lspace="0pt" rspace="3.5pt">!</mo>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mo stretchy="false">[</mo>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mn>1</mn>
        <mo>⋅</mo>
        <mn>10</mn>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
      <mo stretchy="false">]</mo>
     </mrow>
     <mo>⋅</mo>
     <mrow>
      <mo stretchy="false">[</mo>
      <mrow>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mn>2</mn>
         <mo>⋅</mo>
         <mn>6</mn>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mn>3</mn>
         <mo>⋅</mo>
         <mn>4</mn>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mn>5</mn>
         <mo>⋅</mo>
         <mn>9</mn>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mn>7</mn>
         <mo>⋅</mo>
         <mn>8</mn>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
      <mo stretchy="false">]</mo>
     </mrow>
    </mrow>
    <mo>≡</mo>
    <mrow>
     <mrow>
      <mo stretchy="false">[</mo>
      <mrow>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
      <mo stretchy="false">]</mo>
     </mrow>
     <mo>⋅</mo>
     <mrow>
      <mo stretchy="false">[</mo>
      <mrow>
       <mn>1</mn>
       <mo>⋅</mo>
       <mn>1</mn>
       <mo>⋅</mo>
       <mn>1</mn>
       <mo>⋅</mo>
       <mn>1</mn>
      </mrow>
      <mo stretchy="false">]</mo>
     </mrow>
    </mrow>
    <mo>≡</mo>
    <mrow>
     <mrow>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
     <mspace width="veryverythickmathspace">
     </mspace>
     <mrow>
      <mo lspace="8.1pt" stretchy="false">(</mo>
      <mrow>
       <mo>mod</mo>
       <mn>11</mn>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <factorial></factorial>
      <cn type="integer">10</cn>
     </apply>
     <apply>
      <ci>normal-⋅</ci>
      <apply>
       <csymbol cd="latexml">delimited-[]</csymbol>
       <apply>
        <ci>normal-⋅</ci>
        <cn type="integer">1</cn>
        <cn type="integer">10</cn>
       </apply>
      </apply>
      <apply>
       <csymbol cd="latexml">delimited-[]</csymbol>
       <apply>
        <times></times>
        <apply>
         <ci>normal-⋅</ci>
         <cn type="integer">2</cn>
         <cn type="integer">6</cn>
        </apply>
        <apply>
         <ci>normal-⋅</ci>
         <cn type="integer">3</cn>
         <cn type="integer">4</cn>
        </apply>
        <apply>
         <ci>normal-⋅</ci>
         <cn type="integer">5</cn>
         <cn type="integer">9</cn>
        </apply>
        <apply>
         <ci>normal-⋅</ci>
         <cn type="integer">7</cn>
         <cn type="integer">8</cn>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <equivalent></equivalent>
     <share href="#.cmml">
     </share>
     <apply>
      <ci>normal-⋅</ci>
      <apply>
       <csymbol cd="latexml">delimited-[]</csymbol>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <apply>
       <csymbol cd="latexml">delimited-[]</csymbol>
       <apply>
        <ci>normal-⋅</ci>
        <cn type="integer">1</cn>
        <cn type="integer">1</cn>
        <cn type="integer">1</cn>
        <cn type="integer">1</cn>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <equivalent></equivalent>
     <share href="#.cmml">
     </share>
     <apply>
      <csymbol cd="latexml">annotated</csymbol>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
      </apply>
      <apply>
       <ci>pmod</ci>
       <cn type="integer">11</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   10!=[(1\cdot 10)]\cdot[(2\cdot 6)(3\cdot 4)(5\cdot 9)(7\cdot 8)]\equiv[-1]%
\cdot[1\cdot 1\cdot 1\cdot 1]\equiv-1\;\;(\mathop{{\rm mod}}11).\,
  </annotation>
 </semantics>
</math>

</p>
<dl>
<dt>Proof using Fermat's little theorem</dt>
</dl>

<p>Again, the result is trivial for <em>p</em> = 2, so suppose <em>p</em> is an odd prime, . Consider the polynomial</p>

<p>

<math display="block" id="Wilson's_theorem:6">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>g</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>x</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mi>x</mi>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mi>x</mi>
       <mo>-</mo>
       <mn>2</mn>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <mi mathvariant="normal">⋯</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mi>x</mi>
       <mo>-</mo>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mi>p</mi>
         <mo>-</mo>
         <mn>1</mn>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>g</ci>
     <ci>x</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <minus></minus>
      <ci>x</ci>
      <cn type="integer">1</cn>
     </apply>
     <apply>
      <minus></minus>
      <ci>x</ci>
      <cn type="integer">2</cn>
     </apply>
     <ci>normal-⋯</ci>
     <apply>
      <minus></minus>
      <ci>x</ci>
      <apply>
       <minus></minus>
       <ci>p</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   g(x)=(x-1)(x-2)\cdots(x-(p-1)).\,
  </annotation>
 </semantics>
</math>

</p>

<p><em>g</em> has degree , leading term <mtpl></mtpl>, and constant term . Its  roots are 1, 2, ..., .</p>

<p>Now consider</p>

<p>

<math display="block" id="Wilson's_theorem:7">
 <semantics>
  <mrow>
   <mrow>
    <mi>h</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>x</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <msup>
     <mi>x</mi>
     <mrow>
      <mi>p</mi>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </msup>
    <mo>-</mo>
    <mpadded width="+1.7pt">
     <mn>1.</mn>
    </mpadded>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>h</ci>
     <ci>x</ci>
    </apply>
    <apply>
     <minus></minus>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>x</ci>
      <apply>
       <minus></minus>
       <ci>p</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <cn type="float">1.</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   h(x)=x^{p-1}-1.\,
  </annotation>
 </semantics>
</math>

</p>

<p><em>h</em> also has degree  and leading term <mtpl></mtpl>. Modulo <em>p</em>, <a href="Fermat's_little_theorem" title="wikilink">Fermat's little theorem</a> says it also has the same  roots, 1, 2, ..., .</p>

<p>Finally, consider</p>

<p>

<math display="block" id="Wilson's_theorem:8">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>f</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>x</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mi>g</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>x</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo>-</mo>
     <mrow>
      <mi>h</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>x</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>f</ci>
     <ci>x</ci>
    </apply>
    <apply>
     <minus></minus>
     <apply>
      <times></times>
      <ci>g</ci>
      <ci>x</ci>
     </apply>
     <apply>
      <times></times>
      <ci>h</ci>
      <ci>x</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f(x)=g(x)-h(x).\,
  </annotation>
 </semantics>
</math>

</p>

<p><em>f</em> has degree at most <em>p</em> − 2 (since the leading terms cancel), and modulo <em>p</em> also has the  roots 1, 2, ..., . But Lagrange's theorem says it cannot have more than <em>p</em> − 2 roots. Therefore <em>f</em> must be identically zero (mod <em>p</em>), so its constant term . This is Wilson's theorem.</p>
<dl>
<dt>Proof using the Sylow theorems</dt>
</dl>

<p>It is possible to deduce Wilson's theorem from a particular application of the <a href="Sylow_theorems" title="wikilink">Sylow theorems</a>. Let <em>p</em> be a prime. It is immediate to deduce that the <a href="symmetric_group" title="wikilink">symmetric group</a> 

<math display="inline" id="Wilson's_theorem:9">
 <semantics>
  <msub>
   <mi>S</mi>
   <mi>p</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>S</ci>
    <ci>p</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   S_{p}
  </annotation>
 </semantics>
</math>

 has exactly 

<math display="inline" id="Wilson's_theorem:10">
 <semantics>
  <mrow>
   <mrow>
    <mo stretchy="false">(</mo>
    <mrow>
     <mi>p</mi>
     <mo>-</mo>
     <mn>1</mn>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo lspace="0pt" rspace="3.5pt">!</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <factorial></factorial>
    <apply>
     <minus></minus>
     <ci>p</ci>
     <cn type="integer">1</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (p-1)!
  </annotation>
 </semantics>
</math>

 elements of order <em>p</em>, namely the <em>p</em>-cycles 

<math display="inline" id="Wilson's_theorem:11">
 <semantics>
  <msub>
   <mi>C</mi>
   <mi>p</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>C</ci>
    <ci>p</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   C_{p}
  </annotation>
 </semantics>
</math>

. On the other hand, each Sylow <em>p</em>-subgroup in 

<math display="inline" id="Wilson's_theorem:12">
 <semantics>
  <msub>
   <mi>S</mi>
   <mi>p</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>S</ci>
    <ci>p</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   S_{p}
  </annotation>
 </semantics>
</math>

 is a copy of 

<math display="inline" id="Wilson's_theorem:13">
 <semantics>
  <msub>
   <mi>C</mi>
   <mi>p</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>C</ci>
    <ci>p</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   C_{p}
  </annotation>
 </semantics>
</math>

. Hence it follows that the number of Sylow <em>p</em>-subgroups is 

<math display="inline" id="Wilson's_theorem:14">
 <semantics>
  <mrow>
   <msub>
    <mi>n</mi>
    <mi>p</mi>
   </msub>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>p</mi>
      <mo>-</mo>
      <mn>2</mn>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
    <mo lspace="0pt" rspace="3.5pt">!</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>n</ci>
     <ci>p</ci>
    </apply>
    <apply>
     <factorial></factorial>
     <apply>
      <minus></minus>
      <ci>p</ci>
      <cn type="integer">2</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n_{p}=(p-2)!
  </annotation>
 </semantics>
</math>

. The <a href="Sylow_theorems" title="wikilink">Sylow theorems</a> imply</p>

<p>

<math display="block" id="Wilson's_theorem:15">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mi>p</mi>
       <mo>-</mo>
       <mn>2</mn>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <mo lspace="0pt" rspace="3.5pt">!</mo>
    </mrow>
    <mo>≡</mo>
    <mrow>
     <mn>1</mn>
     <mspace width="veryverythickmathspace">
     </mspace>
     <mrow>
      <mo lspace="8.1pt" stretchy="false">(</mo>
      <mrow>
       <mo>mod</mo>
       <mi>p</mi>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <equivalent></equivalent>
    <apply>
     <factorial></factorial>
     <apply>
      <minus></minus>
      <ci>p</ci>
      <cn type="integer">2</cn>
     </apply>
    </apply>
    <apply>
     <csymbol cd="latexml">annotated</csymbol>
     <cn type="integer">1</cn>
     <apply>
      <ci>pmod</ci>
      <ci>p</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (p-2)!\equiv 1\;\;(\mathop{{\rm mod}}p).
  </annotation>
 </semantics>
</math>

 Multiplying both sides by (<em>p</em> - 1) gives</p>

<p>

<math display="block" id="Wilson's_theorem:16">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mi>p</mi>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <mo lspace="0pt" rspace="3.5pt">!</mo>
    </mrow>
    <mo>≡</mo>
    <mrow>
     <mi>p</mi>
     <mo>-</mo>
     <mn>1</mn>
    </mrow>
    <mo>≡</mo>
    <mrow>
     <mrow>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
     <mspace width="veryverythickmathspace">
     </mspace>
     <mrow>
      <mo lspace="8.1pt" stretchy="false">(</mo>
      <mrow>
       <mo>mod</mo>
       <mi>p</mi>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <equivalent></equivalent>
     <apply>
      <factorial></factorial>
      <apply>
       <minus></minus>
       <ci>p</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <apply>
      <minus></minus>
      <ci>p</ci>
      <cn type="integer">1</cn>
     </apply>
    </apply>
    <apply>
     <equivalent></equivalent>
     <share href="#.cmml">
     </share>
     <apply>
      <csymbol cd="latexml">annotated</csymbol>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
      </apply>
      <apply>
       <ci>pmod</ci>
       <ci>p</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (p-1)!\equiv p-1\equiv-1\;\;(\mathop{{\rm mod}}p),
  </annotation>
 </semantics>
</math>

 that is, the result.</p>
<h2 id="applications">Applications</h2>
<h3 id="primality-tests">Primality tests</h3>

<p>In practice, Wilson's theorem is useless as a <a href="primality_test" title="wikilink">primality test</a> because computing (<em>n</em> − 1)! modulo <em>n</em> for large <em>n</em> is <a href="Computational_complexity_theory" title="wikilink">computationally complex</a>, and much faster primality tests are known (indeed, even <a href="trial_division" title="wikilink">trial division</a> is considerably more efficient).</p>
<h3 id="quadratic-residues">Quadratic residues</h3>

<p>Using Wilson's Theorem, for any odd prime , we can rearrange the left hand side of</p>

<p>

<math display="block" id="Wilson's_theorem:17">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mn>1</mn>
     <mo>⋅</mo>
     <mn>2</mn>
    </mrow>
    <mi mathvariant="normal">⋯</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>p</mi>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
     <mo rspace="7.5pt" stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo rspace="7.5pt">≡</mo>
   <mrow>
    <mrow>
     <mo>-</mo>
     <mpadded width="+5pt">
      <mn>1</mn>
     </mpadded>
    </mrow>
    <mspace width="veryverythickmathspace">
    </mspace>
    <mrow>
     <mo lspace="8.1pt" stretchy="false">(</mo>
     <mrow>
      <mo>mod</mo>
      <mi>p</mi>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <equivalent></equivalent>
    <apply>
     <times></times>
     <apply>
      <ci>normal-⋅</ci>
      <cn type="integer">1</cn>
      <cn type="integer">2</cn>
     </apply>
     <ci>normal-⋯</ci>
     <apply>
      <minus></minus>
      <ci>p</ci>
      <cn type="integer">1</cn>
     </apply>
    </apply>
    <apply>
     <csymbol cd="latexml">annotated</csymbol>
     <apply>
      <minus></minus>
      <cn type="integer">1</cn>
     </apply>
     <apply>
      <ci>pmod</ci>
      <ci>p</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   1\cdot 2\cdots(p-1)\ \equiv\ -1\ \;\;(\mathop{{\rm mod}}p)
  </annotation>
 </semantics>
</math>

</p>

<p>to obtain the equality</p>

<p>

<math display="block" id="Wilson's_theorem:18">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mrow>
      <mrow>
       <mn>1</mn>
       <mo>⋅</mo>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mi>p</mi>
         <mo>-</mo>
         <mn>1</mn>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
       <mo>⋅</mo>
       <mn>2</mn>
       <mo>⋅</mo>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mi>p</mi>
         <mo>-</mo>
         <mn>2</mn>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
      <mi mathvariant="normal">⋯</mi>
      <mi>m</mi>
     </mrow>
     <mo>⋅</mo>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mi>p</mi>
       <mo>-</mo>
       <mi>m</mi>
      </mrow>
      <mo rspace="7.5pt" stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>≡</mo>
    <mrow>
     <mrow>
      <mrow>
       <mn>1</mn>
       <mo>⋅</mo>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mo>-</mo>
         <mn>1</mn>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
       <mo>⋅</mo>
       <mn>2</mn>
       <mo>⋅</mo>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mo>-</mo>
         <mn>2</mn>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
      <mi mathvariant="normal">⋯</mi>
      <mi>m</mi>
     </mrow>
     <mo>⋅</mo>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mo>-</mo>
       <mi>m</mi>
      </mrow>
      <mo rspace="7.5pt" stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo rspace="7.5pt">≡</mo>
    <mrow>
     <mrow>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
     <mspace width="veryverythickmathspace">
     </mspace>
     <mrow>
      <mo lspace="8.1pt" stretchy="false">(</mo>
      <mrow>
       <mo>mod</mo>
       <mi>p</mi>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <equivalent></equivalent>
     <apply>
      <ci>normal-⋅</ci>
      <apply>
       <times></times>
       <apply>
        <ci>normal-⋅</ci>
        <cn type="integer">1</cn>
        <apply>
         <minus></minus>
         <ci>p</ci>
         <cn type="integer">1</cn>
        </apply>
        <cn type="integer">2</cn>
        <apply>
         <minus></minus>
         <ci>p</ci>
         <cn type="integer">2</cn>
        </apply>
       </apply>
       <ci>normal-⋯</ci>
       <ci>m</ci>
      </apply>
      <apply>
       <minus></minus>
       <ci>p</ci>
       <ci>m</ci>
      </apply>
     </apply>
     <apply>
      <ci>normal-⋅</ci>
      <apply>
       <times></times>
       <apply>
        <ci>normal-⋅</ci>
        <cn type="float">1</cn>
        <apply>
         <minus></minus>
         <cn type="integer">1</cn>
        </apply>
        <cn type="integer">2</cn>
        <apply>
         <minus></minus>
         <cn type="integer">2</cn>
        </apply>
       </apply>
       <ci>normal-⋯</ci>
       <ci>m</ci>
      </apply>
      <apply>
       <minus></minus>
       <ci>m</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <equivalent></equivalent>
     <share href="#.cmml">
     </share>
     <apply>
      <csymbol cd="latexml">annotated</csymbol>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
      </apply>
      <apply>
       <ci>pmod</ci>
       <ci>p</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   1\cdot(p-1)\cdot 2\cdot(p-2)\cdots m\cdot(p-m)\ \equiv\ 1\cdot(-1)\cdot 2\cdot%
(-2)\cdots m\cdot(-m)\ \equiv\ -1\;\;(\mathop{{\rm mod}}p).
  </annotation>
 </semantics>
</math>

</p>

<p>This becomes</p>

<p>

<math display="block" id="Wilson's_theorem:19">
 <semantics>
  <mrow>
   <mrow>
    <mpadded width="+5pt">
     <munderover>
      <mo largeop="true" movablelimits="false" symmetric="true">∏</mo>
      <mrow>
       <mi>j</mi>
       <mo>=</mo>
       <mn>1</mn>
      </mrow>
      <mi>m</mi>
     </munderover>
    </mpadded>
    <mpadded width="+5pt">
     <msup>
      <mi>j</mi>
      <mn>2</mn>
     </msup>
    </mpadded>
   </mrow>
   <mo>≡</mo>
   <mrow>
    <msup>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <mrow>
      <mi>m</mi>
      <mo>+</mo>
      <mn>1</mn>
     </mrow>
    </msup>
    <mspace width="veryverythickmathspace">
    </mspace>
    <mrow>
     <mo lspace="8.1pt" stretchy="false">(</mo>
     <mrow>
      <mo>mod</mo>
      <mi>p</mi>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <equivalent></equivalent>
    <apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <csymbol cd="latexml">product</csymbol>
       <apply>
        <eq></eq>
        <ci>j</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <ci>m</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>j</ci>
      <cn type="integer">2</cn>
     </apply>
    </apply>
    <apply>
     <csymbol cd="latexml">annotated</csymbol>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
      </apply>
      <apply>
       <plus></plus>
       <ci>m</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <apply>
      <ci>pmod</ci>
      <ci>p</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \prod_{j=1}^{m}\ j^{2}\ \equiv(-1)^{m+1}\;\;(\mathop{{\rm mod}}p)
  </annotation>
 </semantics>
</math>

</p>

<p>or</p>

<p>

<math display="block" id="Wilson's_theorem:20">
 <semantics>
  <mrow>
   <mrow>
    <msup>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mi>m</mi>
       <mo lspace="0pt" rspace="3.5pt">!</mo>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <mn>2</mn>
    </msup>
    <mo>≡</mo>
    <mrow>
     <msup>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mo>-</mo>
        <mn>1</mn>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
      <mrow>
       <mi>m</mi>
       <mo>+</mo>
       <mn>1</mn>
      </mrow>
     </msup>
     <mspace width="veryverythickmathspace">
     </mspace>
     <mrow>
      <mo lspace="8.1pt" stretchy="false">(</mo>
      <mrow>
       <mo>mod</mo>
       <mi>p</mi>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <equivalent></equivalent>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <factorial></factorial>
      <ci>m</ci>
     </apply>
     <cn type="integer">2</cn>
    </apply>
    <apply>
     <csymbol cd="latexml">annotated</csymbol>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
      </apply>
      <apply>
       <plus></plus>
       <ci>m</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <apply>
      <ci>pmod</ci>
      <ci>p</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (m!)^{2}\equiv(-1)^{m+1}\;\;(\mathop{{\rm mod}}p).
  </annotation>
 </semantics>
</math>

</p>

<p>We can use this fact to prove part of a famous result: for any prime <em>p</em> such that <a href="Pythagorean_prime" title="wikilink"><em>p</em> ≡ 1 (mod 4)</a>, the number (−1) is a square (<a href="quadratic_residue" title="wikilink">quadratic residue</a>) mod <em>p</em>. For suppose <em>p</em> = 4<em>k</em> + 1 for some integer <em>k</em>. Then we can take <em>m</em> = 2<em>k</em> above, and we conclude that (<em>m</em>!)<sup>2</sup> is congruent to (−1).</p>
<h3 id="formulas-for-primes">Formulas for primes</h3>

<p>Wilson's theorem has been used to construct <a href="Formula_for_primes#Floor_function_formulas_based_on_Wilson's_theorem" title="wikilink">formulas for primes</a>, but they are too slow to have practical value.</p>
<h3 id="p-adic-gamma-function">p-adic gamma function</h3>

<p>Wilson's theorem allows to define the <a href="p-adic_gamma_function" title="wikilink">p-adic gamma function</a>.</p>
<h2 id="gausss-generalization">Gauss's generalization</h2>

<p><a href="Carl_Friedrich_Gauss" title="wikilink">Gauss</a> proved<a class="footnoteRef" href="#fn6" id="fnref6"><sup>6</sup></a> that if <em>m</em> &gt; 2</p>

<p>

<math display="block" id="Wilson's_theorem:21">
 <semantics>
  <mrow>
   <mrow>
    <mpadded width="-3.4pt">
     <munderover>
      <mo largeop="true" movablelimits="false" symmetric="true">∏</mo>
      <mstyle scriptlevel="+1">
       <mtable columnspacing="0.4em" rowspacing="0.2ex">
        <mtr>
         <mtd>
          <mrow>
           <mi>k</mi>
           <mo>=</mo>
           <mn>1</mn>
          </mrow>
         </mtd>
        </mtr>
        <mtr>
         <mtd>
          <mrow>
           <mrow>
            <mi>gcd</mi>
            <mrow>
             <mo stretchy="false">(</mo>
             <mi>k</mi>
             <mo>,</mo>
             <mi>m</mi>
             <mo stretchy="false">)</mo>
            </mrow>
           </mrow>
           <mo>=</mo>
           <mn>1</mn>
          </mrow>
         </mtd>
        </mtr>
       </mtable>
      </mstyle>
      <mi>m</mi>
     </munderover>
    </mpadded>
    <mpadded width="+5pt">
     <mi>k</mi>
    </mpadded>
   </mrow>
   <mo>≡</mo>
   <mrow>
    <mo>{</mo>
    <mtable displaystyle="true">
     <mtr>
      <mtd columnalign="left">
       <mrow>
        <mrow>
         <mo>-</mo>
         <mn>1</mn>
        </mrow>
        <mspace width="veryverythickmathspace">
        </mspace>
        <mrow>
         <mo lspace="8.1pt" stretchy="false">(</mo>
         <mrow>
          <mo>mod</mo>
          <mi>m</mi>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
      </mtd>
      <mtd columnalign="left">
       <mrow>
        <mrow>
         <mtext>if</mtext>
         <mi>m</mi>
        </mrow>
        <mo>=</mo>
        <mrow>
         <mn>4</mn>
         <mo rspace="5.3pt">,</mo>
         <msup>
          <mi>p</mi>
          <mi>α</mi>
         </msup>
         <mo>,</mo>
         <mrow>
          <mn>2</mn>
          <msup>
           <mi>p</mi>
           <mi>α</mi>
          </msup>
         </mrow>
        </mrow>
       </mrow>
      </mtd>
     </mtr>
     <mtr>
      <mtd columnalign="left">
       <mrow>
        <mn>1</mn>
        <mspace width="veryverythickmathspace">
        </mspace>
        <mrow>
         <mo lspace="8.1pt" stretchy="false">(</mo>
         <mrow>
          <mo>mod</mo>
          <mi>m</mi>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
      </mtd>
      <mtd columnalign="left">
       <mtext>otherwise</mtext>
      </mtd>
     </mtr>
    </mtable>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <equivalent></equivalent>
    <apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <csymbol cd="latexml">product</csymbol>
       <apply>
        <ci>STACKED</ci>
        <apply>
         <eq></eq>
         <ci>k</ci>
         <cn type="integer">1</cn>
        </apply>
        <apply>
         <eq></eq>
         <apply>
          <gcd></gcd>
          <ci>k</ci>
          <ci>m</ci>
         </apply>
         <cn type="integer">1</cn>
        </apply>
       </apply>
      </apply>
      <ci>m</ci>
     </apply>
     <ci>k</ci>
    </apply>
    <apply>
     <csymbol cd="latexml">cases</csymbol>
     <apply>
      <csymbol cd="latexml">annotated</csymbol>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
      </apply>
      <apply>
       <ci>pmod</ci>
       <ci>m</ci>
      </apply>
     </apply>
     <apply>
      <eq></eq>
      <apply>
       <times></times>
       <mtext>if</mtext>
       <ci>m</ci>
      </apply>
      <list>
       <cn type="integer">4</cn>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>p</ci>
        <ci>α</ci>
       </apply>
       <apply>
        <times></times>
        <cn type="float">2</cn>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>p</ci>
         <ci>α</ci>
        </apply>
       </apply>
      </list>
     </apply>
     <apply>
      <csymbol cd="latexml">annotated</csymbol>
      <cn type="float">1</cn>
      <apply>
       <ci>pmod</ci>
       <ci>m</ci>
      </apply>
     </apply>
     <mtext>otherwise</mtext>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \prod_{k=1\atop\gcd(k,m)=1}^{m}\!\!k\ \equiv\begin{cases}-1\;\;(\mathop{{\rm
mod%
}}m)&\text{if }m=4,\;p^{\alpha},\;2p^{\alpha}\\
\;\;\,1\;\;(\mathop{{\rm mod}}m)&\text{otherwise}\end{cases}
  </annotation>
 </semantics>
</math>

</p>

<p>where <em>p</em> is an odd prime, and 

<math display="inline" id="Wilson's_theorem:22">
 <semantics>
  <mi>α</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>α</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \alpha
  </annotation>
 </semantics>
</math>

 is a positive integer. The values of <em>m</em> for which the product is −1 are precisely the ones where there is a <a href="Primitive_root_modulo_n" title="wikilink">primitive root modulo <em>m</em></a>.<a class="footnoteRef" href="#fn7" id="fnref7"><sup>7</sup></a></p>

<p>This further generalizes to the fact that in any finite <a href="abelian_group" title="wikilink">abelian group</a>, either the product of all elements is the identity, or there is precisely one element <em>a</em> of order 2 (but not both). In the latter case, the product of all elements equals <em>a</em>.</p>
<h2 id="see-also">See also</h2>
<ul>
<li><a href="Primitive_root_modulo_n" title="wikilink">Primitive root modulo n</a></li>
<li><a href="Wilson_prime" title="wikilink">Wilson prime</a></li>
<li><a href="Ibn_al-Haitham" title="wikilink">Ibn al-Haitham</a></li>
<li><a href="Table_of_congruences" title="wikilink">Table of congruences</a></li>
</ul>
<h2 id="notes">Notes</h2>
<h2 id="references">References</h2>

<p>The <em><a href="Disquisitiones_Arithmeticae" title="wikilink">Disquisitiones Arithmeticae</a></em> has been translated from Gauss's Ciceronian Latin into English and German. The German edition includes all of his papers on number theory: all the proofs of quadratic reciprocity, the determination of the sign of the Gauss sum, the investigations into biquadratic reciprocity, and unpublished notes.</p>
<ul>
<li></li>
</ul>
<ul>
<li></li>
</ul>
<ul>
<li></li>
</ul>
<ul>
<li></li>
</ul>
<h2 id="external-links">External links</h2>
<ul>
<li></li>
<li></li>
</ul>

<p>"</p>

<p><a href="Category:Modular_arithmetic" title="wikilink">Category:Modular arithmetic</a> <a href="Category:Factorial_and_binomial_topics" title="wikilink">Category:Factorial and binomial topics</a> <a href="Category:Articles_containing_proofs" title="wikilink">Category:Articles containing proofs</a> <a href="Category:Theorems_about_prime_numbers" title="wikilink">Category:Theorems about prime numbers</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1"><a href="#fnref1">↩</a></li>
<li id="fn2">Edward Waring, <em>Mediationes Algebraicae</em> (Cambridge, England: 1770), page 218 (in Latin). In the third (1782) edition of Waring's <em>Mediationes Algebraicae</em>, Wilson's theorem appears as problem 5 on [<a class="uri" href="http://books.google.co.uk/books?id=1MNbAAAAQAAJ&amp;pg">http://books.google.co.uk/books?id=1MNbAAAAQAAJ&amp;pg;</a>;=PA380#v=onepage&amp;f;=false page 380]. On that page, Waring states: "Hanc maxime elegantem primorum numerorum proprietatem invenit vir clarissimus, rerumque mathematicarum peritissimus Joannes Wilson Armiger." (A man most illustrious and most skilled in mathematics, Squire John Wilson, found this most elegant property of prime numbers.)<a href="#fnref2">↩</a></li>
<li id="fn3">Joseph Louis Lagrange, [<a class="uri" href="http://books.google.com/books?id=_-U_AAAAYAAJ&amp;pg">http://books.google.com/books?id=_-U_AAAAYAAJ&amp;pg;</a>;=PA125#v=onepage&amp;q;&amp;f;=false "Demonstration d'un théorème nouveau concernant les nombres premiers"] (Proof of a new theorem concerning prime numbers), <em>Nouveaux Mémoires de l'Académie Royale des Sciences et Belles-Lettres</em> (Berlin), vol. 2, pages 125–137 (1771).<a href="#fnref3">↩</a></li>
<li id="fn4">Landau, two proofs of thm. 78<a href="#fnref4">↩</a></li>
<li id="fn5">When <em>n</em> = 3, the only factors are ±1<a href="#fnref5">↩</a></li>
<li id="fn6">Gauss, DA, art. 78<a href="#fnref6">↩</a></li>
<li id="fn7"> have to be excluded because .<a href="#fnref7">↩</a></li>
</ol>
</section>
</body>
</html>

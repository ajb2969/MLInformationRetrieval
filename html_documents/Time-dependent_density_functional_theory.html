<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="543">Time-dependent density functional theory</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Time-dependent density functional theory</h1>
<hr/>

<p><strong>Time-dependent density functional theory</strong> (<strong>TDDFT</strong>) is a <a href="quantum_mechanical" title="wikilink">quantum mechanical</a> theory used in physics and chemistry to investigate the properties and <a href="Molecular_dynamics" title="wikilink">dynamics</a> of many-body systems in the presence of time-dependent potentials, such as electric or magnetic fields. The effect of such fields on molecules and solids can be studied with TDDFT to extract features like excitation energies, frequency-dependent response properties, and photoabsorption spectra.</p>

<p>TDDFT is an extension of <a href="density_functional_theory" title="wikilink">density functional theory</a> (DFT), and the conceptual and computational foundations are analogous – to show that the (time-dependent) <a href="wave_function" title="wikilink">wave function</a> is equivalent to the (time-dependent) <a href="electronic_density" title="wikilink">electronic density</a>, and then to derive the effective potential of a fictitious non-interacting system which returns the same density as any given interacting system. The issue of constructing such a system is more complex for TDDFT, most notably because the time-dependent effective potential at any given instant depends on value of the density at all previous times. Consequently the development of time-dependent approximations for the implementation of TDDFT is behind that of DFT, with applications routinely ignoring this memory requirement.</p>
<h2 id="overview">Overview</h2>

<p>The formal foundation of TDDFT is the <a href="Runge–Gross_theorem" title="wikilink"><strong>Runge-Gross</strong> (<strong>RG</strong>) <strong>theorem</strong></a> (1984)<a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a> – the time-dependent analogue of the Hohenberg-Kohn (HK) theorem (1964).<a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a> The RG theorem shows that, for a given initial wavefunction, there is a unique mapping between the time-dependent external potential of a system and its time-dependent density. This implies that the many-body wavefunction, depending upon 3<em>N</em> variables, is equivalent to the density, which depends upon only 3, and that all properties of a system can thus be determined from knowledge of the density alone. Unlike in DFT, there is no general minimization principle in time-dependent quantum mechanics. Consequently the proof of the RG theorem is more involved than the HK theorem.</p>

<p>Given the RG theorem, the next step in developing a computationally useful method is to determine the fictitious non-interacting system which has the same density as the physical (interacting) system of interest. As in DFT, this is called the (time-dependent) Kohn-Sham system. This system is formally found as the <a href="stationary_point" title="wikilink">stationary point</a> of an <a href="Action_(physics)" title="wikilink">action</a> functional defined in the <a href="Keldysh_formalism" title="wikilink">Keldysh formalism</a>.<a class="footnoteRef" href="#fn3" id="fnref3"><sup>3</sup></a></p>

<p>The most popular application of TDDFT is in the calculation of the energies of excited states of isolated systems and, less commonly, solids. Such calculations are based on the fact that the linear response function – that is, how the electron density changes when the external potential changes – has poles at the exact excitation energies of a system. Such calculations require, in addition to the exchange-correlation potential, the exchange-correlation kernel – the <a href="functional_derivative" title="wikilink">functional derivative</a> of the exchange-correlation potential with respect to the density.<a class="footnoteRef" href="#fn4" id="fnref4"><sup>4</sup></a><a class="footnoteRef" href="#fn5" id="fnref5"><sup>5</sup></a></p>
<h2 id="formalism">Formalism</h2>
<h3 id="runge-gross-theorem">Runge-Gross theorem</h3>

<p>The approach of Runge and Gross considers a single-component system in the presence of a time-dependent <a href="scalar_field" title="wikilink">scalar field</a> for which the <a href="Hamiltonian_(quantum_mechanics)" title="wikilink">Hamiltonian</a> takes the form</p>

<p>

<math display="block" id="Time-dependent_density_functional_theory:0">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mover accent="true">
      <mi>H</mi>
      <mo stretchy="false">^</mo>
     </mover>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>t</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mover accent="true">
      <mi>T</mi>
      <mo stretchy="false">^</mo>
     </mover>
     <mo>+</mo>
     <mrow>
      <msub>
       <mover accent="true">
        <mi>V</mi>
        <mo stretchy="false">^</mo>
       </mover>
       <mi>ext</mi>
      </msub>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>t</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo>+</mo>
     <mover accent="true">
      <mi>W</mi>
      <mo stretchy="false">^</mo>
     </mover>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <ci>normal-^</ci>
      <ci>H</ci>
     </apply>
     <ci>t</ci>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <ci>normal-^</ci>
      <ci>T</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <apply>
        <ci>normal-^</ci>
        <ci>V</ci>
       </apply>
       <ci>ext</ci>
      </apply>
      <ci>t</ci>
     </apply>
     <apply>
      <ci>normal-^</ci>
      <ci>W</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \hat{H}(t)=\hat{T}+\hat{V}_{\mathrm{ext}}(t)+\hat{W},
  </annotation>
 </semantics>
</math>

</p>

<p>where <em>T</em> is the kinetic energy operator, <em>W</em> the electron-electron interaction, and <em>V</em><sub>ext</sub>(<em>t</em>) the external potential which along with the number of electrons defines the system. Nominally, the external potential contains the electrons' interaction with the nuclei of the system. For non-trivial time-dependence, an additional explicitly time-dependent potential is present which can arise, for example, from a time-dependent electric or magnetic field. The many-body wavefunction evolves according to the <a href="Schrödinger_equation#Time_dependent_equation" title="wikilink">time-dependent Schrödinger equation</a> under a single <a href="initial_condition" title="wikilink">initial condition</a>,</p>

<p>

<math display="block" id="Time-dependent_density_functional_theory:1">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mrow>
      <mover accent="true">
       <mi>H</mi>
       <mo stretchy="false">^</mo>
      </mover>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>t</mi>
       <mo stretchy="false">)</mo>
      </mrow>
      <mrow>
       <mo fence="true" stretchy="false">|</mo>
       <mrow>
        <mi mathvariant="normal">Ψ</mi>
        <mrow>
         <mo stretchy="false">(</mo>
         <mi>t</mi>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
       <mo stretchy="false">⟩</mo>
      </mrow>
     </mrow>
     <mo>=</mo>
     <mrow>
      <mi>i</mi>
      <mi mathvariant="normal">ℏ</mi>
      <mfrac>
       <mo>∂</mo>
       <mrow>
        <mo>∂</mo>
        <mi>t</mi>
       </mrow>
      </mfrac>
      <mrow>
       <mo fence="true" stretchy="false">|</mo>
       <mrow>
        <mi mathvariant="normal">Ψ</mi>
        <mrow>
         <mo stretchy="false">(</mo>
         <mi>t</mi>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
       <mo stretchy="false">⟩</mo>
      </mrow>
     </mrow>
    </mrow>
    <mo rspace="17.5pt">,</mo>
    <mrow>
     <mrow>
      <mo fence="true" stretchy="false">|</mo>
      <mrow>
       <mi mathvariant="normal">Ψ</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mn>0</mn>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
      <mo stretchy="false">⟩</mo>
     </mrow>
     <mo>=</mo>
     <mrow>
      <mo fence="true" stretchy="false">|</mo>
      <mi mathvariant="normal">Ψ</mi>
      <mo stretchy="false">⟩</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <eq></eq>
     <apply>
      <times></times>
      <apply>
       <ci>normal-^</ci>
       <ci>H</ci>
      </apply>
      <ci>t</ci>
      <apply>
       <csymbol cd="latexml">ket</csymbol>
       <apply>
        <times></times>
        <ci>normal-Ψ</ci>
        <ci>t</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <ci>i</ci>
      <csymbol cd="latexml">Planck-constant-over-2-pi</csymbol>
      <apply>
       <divide></divide>
       <partialdiff></partialdiff>
       <apply>
        <partialdiff></partialdiff>
        <ci>t</ci>
       </apply>
      </apply>
      <apply>
       <csymbol cd="latexml">ket</csymbol>
       <apply>
        <times></times>
        <ci>normal-Ψ</ci>
        <ci>t</ci>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="latexml">ket</csymbol>
      <apply>
       <times></times>
       <ci>normal-Ψ</ci>
       <cn type="integer">0</cn>
      </apply>
     </apply>
     <apply>
      <csymbol cd="latexml">ket</csymbol>
      <ci>normal-Ψ</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \hat{H}(t)|\Psi(t)\rangle=i\hbar\frac{\partial}{\partial t}|\Psi(t)\rangle,\ %
\ \ |\Psi(0)\rangle=|\Psi\rangle.
  </annotation>
 </semantics>
</math>

</p>

<p>Employing the Schrödinger equation as its starting point, the Runge-Gross theorem shows that at any time, the density uniquely determines the external potential. This is done in two steps:</p>
<ol>
<li>Assuming that the external potential can be expanded in a <a href="Taylor_series" title="wikilink">Taylor series</a> about a given time, it is shown that two external potentials differing by more than an additive constant generate different <a href="current_density" title="wikilink">current densities</a>.</li>
<li>Employing the <a href="continuity_equation" title="wikilink">continuity equation</a>, it is then shown that for finite systems, different current densities correspond to different electron densities.</li>
</ol>
<h3 id="time-dependent-kohn-sham-system">Time-dependent Kohn-Sham system</h3>

<p>For a given interaction potential, the RG theorem shows that the external potential uniquely determines the density. The Kohn-Sham approaches chooses a non-interacting system (that for which the interaction potential is zero) in which to form the density that is equal to the interacting system. The advantage of doing so lies in the ease in which non-interacting systems can be solved – the wave function of a non-interacting system can be represented as a <a href="Slater_determinant" title="wikilink">Slater determinant</a> of single-particle <a href="Molecular_orbital" title="wikilink">orbitals</a>, each of which are determined by a single <a href="partial_differential_equation" title="wikilink">partial differential equation</a> in three variable – and that the kinetic energy of a non-interacting system can be expressed exactly in terms of those orbitals. The problem is thus to determine a potential, denoted as <em>v</em><sub>s</sub>(<strong>r</strong>,<em>t</em>) or <em>v</em><sub>KS</sub>(<strong>r</strong>,<em>t</em>), that determines a non-interacting Hamiltonian, <em>H</em><sub>s</sub>,</p>

<p>

<math display="block" id="Time-dependent_density_functional_theory:2">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <msub>
      <mover accent="true">
       <mi>H</mi>
       <mo stretchy="false">^</mo>
      </mover>
      <mi>s</mi>
     </msub>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>t</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mover accent="true">
      <mi>T</mi>
      <mo stretchy="false">^</mo>
     </mover>
     <mo>+</mo>
     <mrow>
      <msub>
       <mover accent="true">
        <mi>V</mi>
        <mo stretchy="false">^</mo>
       </mover>
       <mi>s</mi>
      </msub>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>t</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <ci>normal-^</ci>
       <ci>H</ci>
      </apply>
      <ci>s</ci>
     </apply>
     <ci>t</ci>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <ci>normal-^</ci>
      <ci>T</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <apply>
        <ci>normal-^</ci>
        <ci>V</ci>
       </apply>
       <ci>s</ci>
      </apply>
      <ci>t</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \hat{H}_{s}(t)=\hat{T}+\hat{V}_{s}(t),
  </annotation>
 </semantics>
</math>

</p>

<p>which in turn determines a determinantal wave function</p>

<p>

<math display="block" id="Time-dependent_density_functional_theory:3">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mrow>
      <msub>
       <mover accent="true">
        <mi>H</mi>
        <mo stretchy="false">^</mo>
       </mover>
       <mi>s</mi>
      </msub>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>t</mi>
       <mo stretchy="false">)</mo>
      </mrow>
      <mrow>
       <mo fence="true" stretchy="false">|</mo>
       <mrow>
        <mi mathvariant="normal">Φ</mi>
        <mrow>
         <mo stretchy="false">(</mo>
         <mi>t</mi>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
       <mo stretchy="false">⟩</mo>
      </mrow>
     </mrow>
     <mo>=</mo>
     <mrow>
      <mi>i</mi>
      <mfrac>
       <mo>∂</mo>
       <mrow>
        <mo>∂</mo>
        <mi>t</mi>
       </mrow>
      </mfrac>
      <mrow>
       <mo fence="true" stretchy="false">|</mo>
       <mrow>
        <mi mathvariant="normal">Φ</mi>
        <mrow>
         <mo stretchy="false">(</mo>
         <mi>t</mi>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
       <mo stretchy="false">⟩</mo>
      </mrow>
     </mrow>
    </mrow>
    <mo rspace="17.5pt">,</mo>
    <mrow>
     <mrow>
      <mo fence="true" stretchy="false">|</mo>
      <mrow>
       <mi mathvariant="normal">Φ</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mn>0</mn>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
      <mo stretchy="false">⟩</mo>
     </mrow>
     <mo>=</mo>
     <mrow>
      <mo fence="true" stretchy="false">|</mo>
      <mi mathvariant="normal">Φ</mi>
      <mo stretchy="false">⟩</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <eq></eq>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <apply>
        <ci>normal-^</ci>
        <ci>H</ci>
       </apply>
       <ci>s</ci>
      </apply>
      <ci>t</ci>
      <apply>
       <csymbol cd="latexml">ket</csymbol>
       <apply>
        <times></times>
        <ci>normal-Φ</ci>
        <ci>t</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <ci>i</ci>
      <apply>
       <divide></divide>
       <partialdiff></partialdiff>
       <apply>
        <partialdiff></partialdiff>
        <ci>t</ci>
       </apply>
      </apply>
      <apply>
       <csymbol cd="latexml">ket</csymbol>
       <apply>
        <times></times>
        <ci>normal-Φ</ci>
        <ci>t</ci>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="latexml">ket</csymbol>
      <apply>
       <times></times>
       <ci>normal-Φ</ci>
       <cn type="integer">0</cn>
      </apply>
     </apply>
     <apply>
      <csymbol cd="latexml">ket</csymbol>
      <ci>normal-Φ</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \hat{H}_{s}(t)|\Phi(t)\rangle=i\frac{\partial}{\partial t}|\Phi(t)\rangle,\ \ %
\ |\Phi(0)\rangle=|\Phi\rangle,
  </annotation>
 </semantics>
</math>

</p>

<p>which is constructed in terms of a set of <em>N</em> orbitals which obey the equation,</p>

<p>

<math display="block" id="Time-dependent_density_functional_theory:4">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mrow>
      <mrow>
       <mo>(</mo>
       <mrow>
        <mrow>
         <mo>-</mo>
         <mrow>
          <mfrac>
           <mn>1</mn>
           <mn>2</mn>
          </mfrac>
          <msup>
           <mo>∇</mo>
           <mn>2</mn>
          </msup>
         </mrow>
        </mrow>
        <mo>+</mo>
        <mrow>
         <msub>
          <mi>v</mi>
          <mi>s</mi>
         </msub>
         <mrow>
          <mo stretchy="false">(</mo>
          <mi>𝐫</mi>
          <mo>,</mo>
          <mi>t</mi>
          <mo stretchy="false">)</mo>
         </mrow>
        </mrow>
       </mrow>
       <mo>)</mo>
      </mrow>
      <msub>
       <mi>ϕ</mi>
       <mi>i</mi>
      </msub>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>𝐫</mi>
       <mo>,</mo>
       <mi>t</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo>=</mo>
     <mrow>
      <mi>i</mi>
      <mfrac>
       <mo>∂</mo>
       <mrow>
        <mo>∂</mo>
        <mi>t</mi>
       </mrow>
      </mfrac>
      <msub>
       <mi>ϕ</mi>
       <mi>i</mi>
      </msub>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>𝐫</mi>
       <mo>,</mo>
       <mi>t</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mrow>
    <mrow>
     <mrow>
      <msub>
       <mi>ϕ</mi>
       <mi>i</mi>
      </msub>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>𝐫</mi>
       <mo>,</mo>
       <mn>0</mn>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo>=</mo>
     <mrow>
      <msub>
       <mi>ϕ</mi>
       <mi>i</mi>
      </msub>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>𝐫</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <eq></eq>
     <apply>
      <times></times>
      <apply>
       <plus></plus>
       <apply>
        <minus></minus>
        <apply>
         <times></times>
         <apply>
          <divide></divide>
          <cn type="integer">1</cn>
          <cn type="integer">2</cn>
         </apply>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>normal-∇</ci>
          <cn type="integer">2</cn>
         </apply>
        </apply>
       </apply>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>v</ci>
         <ci>s</ci>
        </apply>
        <interval closure="open">
         <ci>𝐫</ci>
         <ci>t</ci>
        </interval>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>ϕ</ci>
       <ci>i</ci>
      </apply>
      <interval closure="open">
       <ci>𝐫</ci>
       <ci>t</ci>
      </interval>
     </apply>
     <apply>
      <times></times>
      <ci>i</ci>
      <apply>
       <divide></divide>
       <partialdiff></partialdiff>
       <apply>
        <partialdiff></partialdiff>
        <ci>t</ci>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>ϕ</ci>
       <ci>i</ci>
      </apply>
      <interval closure="open">
       <ci>𝐫</ci>
       <ci>t</ci>
      </interval>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>ϕ</ci>
       <ci>i</ci>
      </apply>
      <interval closure="open">
       <ci>𝐫</ci>
       <cn type="integer">0</cn>
      </interval>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>ϕ</ci>
       <ci>i</ci>
      </apply>
      <ci>𝐫</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \left(-\frac{1}{2}\nabla^{2}+v_{s}(\mathbf{r},t)\right)\phi_{i}(\mathbf{r},t)=%
i\frac{\partial}{\partial t}\phi_{i}(\mathbf{r},t)\ \ \ \phi_{i}(\mathbf{r},0)%
=\phi_{i}(\mathbf{r}),
  </annotation>
 </semantics>
</math>

</p>

<p>and generate a time-dependent density</p>

<p>

<math display="block" id="Time-dependent_density_functional_theory:5">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <msub>
      <mi>ρ</mi>
      <mi>s</mi>
     </msub>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>𝐫</mi>
      <mo>,</mo>
      <mi>t</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <munderover>
      <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
      <mrow>
       <mi>i</mi>
       <mo>=</mo>
       <mn>1</mn>
      </mrow>
      <mi>N</mi>
     </munderover>
     <msup>
      <mrow>
       <mo stretchy="false">|</mo>
       <mrow>
        <msub>
         <mi>ϕ</mi>
         <mi>i</mi>
        </msub>
        <mrow>
         <mo stretchy="false">(</mo>
         <mi>𝐫</mi>
         <mo>,</mo>
         <mi>t</mi>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
       <mo stretchy="false">|</mo>
      </mrow>
      <mn>2</mn>
     </msup>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>ρ</ci>
      <ci>s</ci>
     </apply>
     <interval closure="open">
      <ci>𝐫</ci>
      <ci>t</ci>
     </interval>
    </apply>
    <apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <apply>
        <eq></eq>
        <ci>i</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <ci>N</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <abs></abs>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>ϕ</ci>
         <ci>i</ci>
        </apply>
        <interval closure="open">
         <ci>𝐫</ci>
         <ci>t</ci>
        </interval>
       </apply>
      </apply>
      <cn type="integer">2</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \rho_{s}(\mathbf{r},t)=\sum_{i=1}^{N}|\phi_{i}(\mathbf{r},t)|^{2},
  </annotation>
 </semantics>
</math>

</p>

<p>such that <em>ρ</em><sub>s</sub> is equal to the density of the interacting system at all times:</p>

<p>

<math display="block" id="Time-dependent_density_functional_theory:6">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <msub>
      <mi>ρ</mi>
      <mi>s</mi>
     </msub>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>𝐫</mi>
      <mo>,</mo>
      <mi>t</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mi>ρ</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>𝐫</mi>
      <mo>,</mo>
      <mi>t</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>ρ</ci>
      <ci>s</ci>
     </apply>
     <interval closure="open">
      <ci>𝐫</ci>
      <ci>t</ci>
     </interval>
    </apply>
    <apply>
     <times></times>
     <ci>ρ</ci>
     <interval closure="open">
      <ci>𝐫</ci>
      <ci>t</ci>
     </interval>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \rho_{s}(\mathbf{r},t)=\rho(\mathbf{r},t).
  </annotation>
 </semantics>
</math>

</p>

<p>If the potential <em>v</em><sub>s</sub>(<strong>r</strong>,<em>t</em>) can be determined, or at the least well-approximated, then the original Schrödinger equation, a single partial differential equation in 3<em>N</em> variables, has been replaced by <em>N</em> differential equations in 3 dimensions, each differing only in the initial condition.</p>

<p>The problem of determining approximations to the Kohn-Sham potential is challenging. Analogously to DFT, the time-dependent KS potential is decomposed to extract the external potential of the system and the time-dependent Coulomb interaction, <em>v</em><sub>J</sub>. The remaining component is the exchange-correlation potential:</p>

<p>

<math display="block" id="Time-dependent_density_functional_theory:7">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <msub>
      <mi>v</mi>
      <mi>s</mi>
     </msub>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>𝐫</mi>
      <mo>,</mo>
      <mi>t</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mrow>
      <msub>
       <mi>v</mi>
       <mi>ext</mi>
      </msub>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>𝐫</mi>
       <mo>,</mo>
       <mi>t</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo>+</mo>
     <mrow>
      <msub>
       <mi>v</mi>
       <mi>J</mi>
      </msub>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>𝐫</mi>
       <mo>,</mo>
       <mi>t</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo>+</mo>
     <mrow>
      <msub>
       <mi>v</mi>
       <mi>xc</mi>
      </msub>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>𝐫</mi>
       <mo>,</mo>
       <mi>t</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>v</ci>
      <ci>s</ci>
     </apply>
     <interval closure="open">
      <ci>𝐫</ci>
      <ci>t</ci>
     </interval>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>v</ci>
       <ci>ext</ci>
      </apply>
      <interval closure="open">
       <ci>𝐫</ci>
       <ci>t</ci>
      </interval>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>v</ci>
       <ci>J</ci>
      </apply>
      <interval closure="open">
       <ci>𝐫</ci>
       <ci>t</ci>
      </interval>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>v</ci>
       <ci>xc</ci>
      </apply>
      <interval closure="open">
       <ci>𝐫</ci>
       <ci>t</ci>
      </interval>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   v_{s}(\mathbf{r},t)=v_{\rm ext}(\mathbf{r},t)+v_{J}(\mathbf{r},t)+v_{\rm xc}(%
\mathbf{r},t).\,
  </annotation>
 </semantics>
</math>

</p>

<p>In their seminal paper, Runge and Gross approached the definition of the KS potential through an action-based argument starting from the <a href="Dirac_action" title="wikilink">Dirac action</a></p>

<p>

<math display="block" id="Time-dependent_density_functional_theory:8">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>A</mi>
     <mrow>
      <mo stretchy="false">[</mo>
      <mi mathvariant="normal">Ψ</mi>
      <mo stretchy="false">]</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mo largeop="true" symmetric="true">∫</mo>
     <mrow>
      <mi mathvariant="normal">d</mi>
      <mpadded width="+5pt">
       <mi>t</mi>
      </mpadded>
      <mrow>
       <mo stretchy="false">⟨</mo>
       <mrow>
        <mi mathvariant="normal">Ψ</mi>
        <mrow>
         <mo stretchy="false">(</mo>
         <mi>t</mi>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
       <mo fence="true" stretchy="false">|</mo>
       <mrow>
        <mi>H</mi>
        <mo>-</mo>
        <mrow>
         <mi>i</mi>
         <mfrac>
          <mo>∂</mo>
          <mrow>
           <mo>∂</mo>
           <mi>t</mi>
          </mrow>
         </mfrac>
        </mrow>
       </mrow>
       <mo fence="true" stretchy="false">|</mo>
       <mrow>
        <mi mathvariant="normal">Ψ</mi>
        <mrow>
         <mo stretchy="false">(</mo>
         <mi>t</mi>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
       <mo stretchy="false">⟩</mo>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>A</ci>
     <apply>
      <csymbol cd="latexml">delimited-[]</csymbol>
      <ci>normal-Ψ</ci>
     </apply>
    </apply>
    <apply>
     <int></int>
     <apply>
      <times></times>
      <ci>normal-d</ci>
      <ci>t</ci>
      <apply>
       <csymbol cd="latexml">quantum-operator-product</csymbol>
       <apply>
        <times></times>
        <ci>normal-Ψ</ci>
        <ci>t</ci>
       </apply>
       <apply>
        <minus></minus>
        <ci>H</ci>
        <apply>
         <times></times>
         <ci>i</ci>
         <apply>
          <divide></divide>
          <partialdiff></partialdiff>
          <apply>
           <partialdiff></partialdiff>
           <ci>t</ci>
          </apply>
         </apply>
        </apply>
       </apply>
       <apply>
        <times></times>
        <ci>normal-Ψ</ci>
        <ci>t</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A[\Psi]=\int\mathrm{d}t\ \langle\Psi(t)|H-i\frac{\partial}{\partial t}|\Psi(t)\rangle.
  </annotation>
 </semantics>
</math>

</p>

<p>Treated as a functional of the wave function, <em>A</em>[Ψ], variations of the wave function yield the many-body Schrödinger equation as the stationary point. Given the unique mapping between densities and wave function, Runge and Gross then treated the Dirac action as a density functional,</p>

<p>

<math display="block" id="Time-dependent_density_functional_theory:9">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>A</mi>
     <mrow>
      <mo stretchy="false">[</mo>
      <mi>ρ</mi>
      <mo stretchy="false">]</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mi>A</mi>
     <mrow>
      <mo stretchy="false">[</mo>
      <mrow>
       <mi mathvariant="normal">Ψ</mi>
       <mrow>
        <mo stretchy="false">[</mo>
        <mi>ρ</mi>
        <mo stretchy="false">]</mo>
       </mrow>
      </mrow>
      <mo stretchy="false">]</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>A</ci>
     <apply>
      <csymbol cd="latexml">delimited-[]</csymbol>
      <ci>ρ</ci>
     </apply>
    </apply>
    <apply>
     <times></times>
     <ci>A</ci>
     <apply>
      <csymbol cd="latexml">delimited-[]</csymbol>
      <apply>
       <times></times>
       <ci>normal-Ψ</ci>
       <apply>
        <csymbol cd="latexml">delimited-[]</csymbol>
        <ci>ρ</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A[\rho]=A[\Psi[\rho]],\,
  </annotation>
 </semantics>
</math>

</p>

<p>and derived a formal expression for the exchange-correlation component of the action, which determines the exchange-correlation potential by functional differentiation. Later it was observed that an approach based on the Dirac action yields paradoxical conclusions when considering the causality of the response functions it generates.<a class="footnoteRef" href="#fn6" id="fnref6"><sup>6</sup></a> The density response function, the functional derivative of the density with respect to the external potential, should be causal: a change in the potential at a given time can not affect the density at earlier times. The response functions from the Dirac action however are symmetric in time so lack the required causal structure. An approach which does not suffer from this issue was later introduced with through an action based on the <a href="Keldysh_formalism" title="wikilink">Keldysh formalism</a> of complex-time path integration.</p>
<h2 id="linear-response-tddft">Linear response TDDFT</h2>

<p>Linear-response TDDFT can be used if the external perturbation is small in the sense that it does not completely destroy the ground-state structure of the system. In this case one can analyze the linear response of the system. This is a great advantage as, to first order, the variation of the system will depend only on the ground-state wave-function so that we can simply use all the properties of DFT.</p>

<p>Consider a small time-dependent external perturbation 

<math display="inline" id="Time-dependent_density_functional_theory:10">
 <semantics>
  <mrow>
   <mi>δ</mi>
   <msup>
    <mi>V</mi>
    <mrow>
     <mi>e</mi>
     <mi>x</mi>
     <mi>t</mi>
    </mrow>
   </msup>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>t</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>δ</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>V</ci>
     <apply>
      <times></times>
      <ci>e</ci>
      <ci>x</ci>
      <ci>t</ci>
     </apply>
    </apply>
    <ci>t</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \delta V^{ext}(t)
  </annotation>
 </semantics>
</math>

. This gives</p>

<p>

<math display="block" id="Time-dependent_density_functional_theory:11">
 <semantics>
  <mrow>
   <mrow>
    <msup>
     <mi>H</mi>
     <mo>′</mo>
    </msup>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>t</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mi>H</mi>
    <mo>+</mo>
    <mrow>
     <mi>δ</mi>
     <msup>
      <mi>V</mi>
      <mrow>
       <mi>e</mi>
       <mi>x</mi>
       <mi>t</mi>
      </mrow>
     </msup>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>t</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>H</ci>
      <ci>normal-′</ci>
     </apply>
     <ci>t</ci>
    </apply>
    <apply>
     <plus></plus>
     <ci>H</ci>
     <apply>
      <times></times>
      <ci>δ</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>V</ci>
       <apply>
        <times></times>
        <ci>e</ci>
        <ci>x</ci>
        <ci>t</ci>
       </apply>
      </apply>
      <ci>t</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   H^{\prime}(t)=H+\delta V^{ext}(t)
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Time-dependent_density_functional_theory:12">
 <semantics>
  <mrow>
   <mrow>
    <msubsup>
     <mi>H</mi>
     <mrow>
      <mi>K</mi>
      <mi>S</mi>
     </mrow>
     <mo>′</mo>
    </msubsup>
    <mrow>
     <mo stretchy="false">[</mo>
     <mi>ρ</mi>
     <mo stretchy="false">]</mo>
    </mrow>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>t</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <msub>
      <mi>H</mi>
      <mrow>
       <mi>K</mi>
       <mi>S</mi>
      </mrow>
     </msub>
     <mrow>
      <mo stretchy="false">[</mo>
      <mi>ρ</mi>
      <mo stretchy="false">]</mo>
     </mrow>
    </mrow>
    <mo>+</mo>
    <mrow>
     <mi>δ</mi>
     <msub>
      <mi>V</mi>
      <mi>H</mi>
     </msub>
     <mrow>
      <mo stretchy="false">[</mo>
      <mi>ρ</mi>
      <mo stretchy="false">]</mo>
     </mrow>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>t</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>+</mo>
    <mrow>
     <mi>δ</mi>
     <msub>
      <mi>V</mi>
      <mrow>
       <mi>x</mi>
       <mi>c</mi>
      </mrow>
     </msub>
     <mrow>
      <mo stretchy="false">[</mo>
      <mi>ρ</mi>
      <mo stretchy="false">]</mo>
     </mrow>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>t</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>+</mo>
    <mrow>
     <mi>δ</mi>
     <msup>
      <mi>V</mi>
      <mrow>
       <mi>e</mi>
       <mi>x</mi>
       <mi>t</mi>
      </mrow>
     </msup>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>t</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>H</ci>
       <ci>normal-′</ci>
      </apply>
      <apply>
       <times></times>
       <ci>K</ci>
       <ci>S</ci>
      </apply>
     </apply>
     <apply>
      <csymbol cd="latexml">delimited-[]</csymbol>
      <ci>ρ</ci>
     </apply>
     <ci>t</ci>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>H</ci>
       <apply>
        <times></times>
        <ci>K</ci>
        <ci>S</ci>
       </apply>
      </apply>
      <apply>
       <csymbol cd="latexml">delimited-[]</csymbol>
       <ci>ρ</ci>
      </apply>
     </apply>
     <apply>
      <times></times>
      <ci>δ</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>V</ci>
       <ci>H</ci>
      </apply>
      <apply>
       <csymbol cd="latexml">delimited-[]</csymbol>
       <ci>ρ</ci>
      </apply>
      <ci>t</ci>
     </apply>
     <apply>
      <times></times>
      <ci>δ</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>V</ci>
       <apply>
        <times></times>
        <ci>x</ci>
        <ci>c</ci>
       </apply>
      </apply>
      <apply>
       <csymbol cd="latexml">delimited-[]</csymbol>
       <ci>ρ</ci>
      </apply>
      <ci>t</ci>
     </apply>
     <apply>
      <times></times>
      <ci>δ</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>V</ci>
       <apply>
        <times></times>
        <ci>e</ci>
        <ci>x</ci>
        <ci>t</ci>
       </apply>
      </apply>
      <ci>t</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   H^{\prime}_{KS}[\rho](t)=H_{KS}[\rho]+\delta V_{H}[\rho](t)+\delta V_{xc}[\rho%
](t)+\delta V^{ext}(t)
  </annotation>
 </semantics>
</math>

 and looking at the linear response of the density</p>

<p>

<math display="block" id="Time-dependent_density_functional_theory:13">
 <semantics>
  <mrow>
   <mrow>
    <mi>δ</mi>
    <mi>ρ</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>𝐫</mi>
      <mi>t</mi>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mi>χ</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>𝐫</mi>
      <mi>t</mi>
     </mrow>
     <mo>,</mo>
     <mrow>
      <msup>
       <mi>𝐫</mi>
       <mo>′</mo>
      </msup>
      <msup>
       <mi>t</mi>
       <mo>′</mo>
      </msup>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
    <mi>δ</mi>
    <msup>
     <mi>V</mi>
     <mrow>
      <mi>e</mi>
      <mi>x</mi>
      <mi>t</mi>
     </mrow>
    </msup>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <msup>
       <mi>𝐫</mi>
       <mo>′</mo>
      </msup>
      <msup>
       <mi>t</mi>
       <mo>′</mo>
      </msup>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>δ</ci>
     <ci>ρ</ci>
     <apply>
      <times></times>
      <ci>𝐫</ci>
      <ci>t</ci>
     </apply>
    </apply>
    <apply>
     <times></times>
     <ci>χ</ci>
     <interval closure="open">
      <apply>
       <times></times>
       <ci>𝐫</ci>
       <ci>t</ci>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>𝐫</ci>
        <ci>normal-′</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>t</ci>
        <ci>normal-′</ci>
       </apply>
      </apply>
     </interval>
     <ci>δ</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>V</ci>
      <apply>
       <times></times>
       <ci>e</ci>
       <ci>x</ci>
       <ci>t</ci>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>𝐫</ci>
       <ci>normal-′</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>t</ci>
       <ci>normal-′</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \delta\rho(\mathbf{r}t)=\chi(\mathbf{r}t,\mathbf{r^{\prime}}t^{\prime})\delta V%
^{ext}(\mathbf{r^{\prime}}t^{\prime})
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Time-dependent_density_functional_theory:14">
 <semantics>
  <mrow>
   <mrow>
    <mi>δ</mi>
    <mi>ρ</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>𝐫</mi>
      <mi>t</mi>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <msub>
     <mi>χ</mi>
     <mrow>
      <mi>K</mi>
      <mi>S</mi>
     </mrow>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>𝐫</mi>
      <mi>t</mi>
     </mrow>
     <mo>,</mo>
     <mrow>
      <msup>
       <mi>𝐫</mi>
       <mo>′</mo>
      </msup>
      <msup>
       <mi>t</mi>
       <mo>′</mo>
      </msup>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
    <mi>δ</mi>
    <msup>
     <mi>V</mi>
     <mrow>
      <mi>e</mi>
      <mi>f</mi>
      <mi>f</mi>
     </mrow>
    </msup>
    <mrow>
     <mo stretchy="false">[</mo>
     <mi>ρ</mi>
     <mo stretchy="false">]</mo>
    </mrow>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <msup>
       <mi>𝐫</mi>
       <mo>′</mo>
      </msup>
      <msup>
       <mi>t</mi>
       <mo>′</mo>
      </msup>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>δ</ci>
     <ci>ρ</ci>
     <apply>
      <times></times>
      <ci>𝐫</ci>
      <ci>t</ci>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>χ</ci>
      <apply>
       <times></times>
       <ci>K</ci>
       <ci>S</ci>
      </apply>
     </apply>
     <interval closure="open">
      <apply>
       <times></times>
       <ci>𝐫</ci>
       <ci>t</ci>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>𝐫</ci>
        <ci>normal-′</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>t</ci>
        <ci>normal-′</ci>
       </apply>
      </apply>
     </interval>
     <ci>δ</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>V</ci>
      <apply>
       <times></times>
       <ci>e</ci>
       <ci>f</ci>
       <ci>f</ci>
      </apply>
     </apply>
     <apply>
      <csymbol cd="latexml">delimited-[]</csymbol>
      <ci>ρ</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>𝐫</ci>
       <ci>normal-′</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>t</ci>
       <ci>normal-′</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \delta\rho(\mathbf{r}t)=\chi_{KS}(\mathbf{r}t,\mathbf{r^{\prime}}t^{\prime})%
\delta V^{eff}[\rho](\mathbf{r^{\prime}}t^{\prime})
  </annotation>
 </semantics>
</math>

 where 

<math display="inline" id="Time-dependent_density_functional_theory:15">
 <semantics>
  <mrow>
   <mrow>
    <mi>δ</mi>
    <msup>
     <mi>V</mi>
     <mrow>
      <mi>e</mi>
      <mi>f</mi>
      <mi>f</mi>
     </mrow>
    </msup>
    <mrow>
     <mo stretchy="false">[</mo>
     <mi>ρ</mi>
     <mo stretchy="false">]</mo>
    </mrow>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>t</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mi>δ</mi>
     <msup>
      <mi>V</mi>
      <mrow>
       <mi>e</mi>
       <mi>x</mi>
       <mi>t</mi>
      </mrow>
     </msup>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>t</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>+</mo>
    <mrow>
     <mi>δ</mi>
     <msub>
      <mi>V</mi>
      <mi>H</mi>
     </msub>
     <mrow>
      <mo stretchy="false">[</mo>
      <mi>ρ</mi>
      <mo stretchy="false">]</mo>
     </mrow>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>t</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>+</mo>
    <mrow>
     <mi>δ</mi>
     <msub>
      <mi>V</mi>
      <mrow>
       <mi>x</mi>
       <mi>c</mi>
      </mrow>
     </msub>
     <mrow>
      <mo stretchy="false">[</mo>
      <mi>ρ</mi>
      <mo stretchy="false">]</mo>
     </mrow>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>t</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>δ</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>V</ci>
      <apply>
       <times></times>
       <ci>e</ci>
       <ci>f</ci>
       <ci>f</ci>
      </apply>
     </apply>
     <apply>
      <csymbol cd="latexml">delimited-[]</csymbol>
      <ci>ρ</ci>
     </apply>
     <ci>t</ci>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <ci>δ</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>V</ci>
       <apply>
        <times></times>
        <ci>e</ci>
        <ci>x</ci>
        <ci>t</ci>
       </apply>
      </apply>
      <ci>t</ci>
     </apply>
     <apply>
      <times></times>
      <ci>δ</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>V</ci>
       <ci>H</ci>
      </apply>
      <apply>
       <csymbol cd="latexml">delimited-[]</csymbol>
       <ci>ρ</ci>
      </apply>
      <ci>t</ci>
     </apply>
     <apply>
      <times></times>
      <ci>δ</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>V</ci>
       <apply>
        <times></times>
        <ci>x</ci>
        <ci>c</ci>
       </apply>
      </apply>
      <apply>
       <csymbol cd="latexml">delimited-[]</csymbol>
       <ci>ρ</ci>
      </apply>
      <ci>t</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \delta V^{eff}[\rho](t)=\delta V^{ext}(t)+\delta V_{H}[\rho](t)+\delta V_{xc}[%
\rho](t)
  </annotation>
 </semantics>
</math>

 Here and in the following it is assumed that primed variables are integrated.</p>

<p>Within the linear-response domain, the variation of the Hartree (H) and the exchange-correlation (xc) potential to linear order may be expanded with respect to the density variation</p>

<p>

<math display="block" id="Time-dependent_density_functional_theory:16">
 <semantics>
  <mrow>
   <mrow>
    <mi>δ</mi>
    <msub>
     <mi>V</mi>
     <mi>H</mi>
    </msub>
    <mrow>
     <mo stretchy="false">[</mo>
     <mi>ρ</mi>
     <mo stretchy="false">]</mo>
    </mrow>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>𝐫</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mfrac>
     <mrow>
      <mi>δ</mi>
      <msub>
       <mi>V</mi>
       <mi>H</mi>
      </msub>
      <mrow>
       <mo stretchy="false">[</mo>
       <mi>ρ</mi>
       <mo stretchy="false">]</mo>
      </mrow>
     </mrow>
     <mrow>
      <mi>δ</mi>
      <mi>ρ</mi>
     </mrow>
    </mfrac>
    <mi>δ</mi>
    <mi>ρ</mi>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mfrac>
     <mn>1</mn>
     <mrow>
      <mo stretchy="false">|</mo>
      <mrow>
       <mi>𝐫</mi>
       <mo>-</mo>
       <msup>
        <mi>𝐫</mi>
        <mo>′</mo>
       </msup>
      </mrow>
      <mo stretchy="false">|</mo>
     </mrow>
    </mfrac>
    <mi>δ</mi>
    <mi>ρ</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <msup>
      <mi>𝐫</mi>
      <mo>′</mo>
     </msup>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <times></times>
      <ci>δ</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>V</ci>
       <ci>H</ci>
      </apply>
      <apply>
       <csymbol cd="latexml">delimited-[]</csymbol>
       <ci>ρ</ci>
      </apply>
      <ci>𝐫</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <apply>
        <times></times>
        <ci>δ</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>V</ci>
         <ci>H</ci>
        </apply>
        <apply>
         <csymbol cd="latexml">delimited-[]</csymbol>
         <ci>ρ</ci>
        </apply>
       </apply>
       <apply>
        <times></times>
        <ci>δ</ci>
        <ci>ρ</ci>
       </apply>
      </apply>
      <ci>δ</ci>
      <ci>ρ</ci>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <apply>
        <abs></abs>
        <apply>
         <minus></minus>
         <ci>𝐫</ci>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>𝐫</ci>
          <ci>normal-′</ci>
         </apply>
        </apply>
       </apply>
      </apply>
      <ci>δ</ci>
      <ci>ρ</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>𝐫</ci>
       <ci>normal-′</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \delta V_{H}[\rho](\mathbf{r})=\frac{\delta V_{H}[\rho]}{\delta\rho}\delta\rho%
=\frac{1}{|\mathbf{r}-\mathbf{r^{\prime}}|}\delta\rho(\mathbf{r^{\prime}})
  </annotation>
 </semantics>
</math>

 and</p>

<p>

<math display="block" id="Time-dependent_density_functional_theory:17">
 <semantics>
  <mrow>
   <mrow>
    <mi>δ</mi>
    <msub>
     <mi>V</mi>
     <mrow>
      <mi>x</mi>
      <mi>c</mi>
     </mrow>
    </msub>
    <mrow>
     <mo stretchy="false">[</mo>
     <mi>ρ</mi>
     <mo stretchy="false">]</mo>
    </mrow>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>𝐫</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mfrac>
     <mrow>
      <mi>δ</mi>
      <msub>
       <mi>V</mi>
       <mrow>
        <mi>x</mi>
        <mi>c</mi>
       </mrow>
      </msub>
      <mrow>
       <mo stretchy="false">[</mo>
       <mi>ρ</mi>
       <mo stretchy="false">]</mo>
      </mrow>
     </mrow>
     <mrow>
      <mi>δ</mi>
      <mi>ρ</mi>
     </mrow>
    </mfrac>
    <mi>δ</mi>
    <mi>ρ</mi>
   </mrow>
   <mo>=</mo>
   <mrow>
    <msub>
     <mi>f</mi>
     <mrow>
      <mi>x</mi>
      <mi>c</mi>
     </mrow>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>𝐫</mi>
      <mi>t</mi>
     </mrow>
     <mo>,</mo>
     <mrow>
      <msup>
       <mi>𝐫</mi>
       <mo>′</mo>
      </msup>
      <msup>
       <mi>t</mi>
       <mo>′</mo>
      </msup>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
    <mi>δ</mi>
    <mi>ρ</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <msup>
      <mi>𝐫</mi>
      <mo>′</mo>
     </msup>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <times></times>
      <ci>δ</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>V</ci>
       <apply>
        <times></times>
        <ci>x</ci>
        <ci>c</ci>
       </apply>
      </apply>
      <apply>
       <csymbol cd="latexml">delimited-[]</csymbol>
       <ci>ρ</ci>
      </apply>
      <ci>𝐫</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <apply>
        <times></times>
        <ci>δ</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>V</ci>
         <apply>
          <times></times>
          <ci>x</ci>
          <ci>c</ci>
         </apply>
        </apply>
        <apply>
         <csymbol cd="latexml">delimited-[]</csymbol>
         <ci>ρ</ci>
        </apply>
       </apply>
       <apply>
        <times></times>
        <ci>δ</ci>
        <ci>ρ</ci>
       </apply>
      </apply>
      <ci>δ</ci>
      <ci>ρ</ci>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>f</ci>
       <apply>
        <times></times>
        <ci>x</ci>
        <ci>c</ci>
       </apply>
      </apply>
      <interval closure="open">
       <apply>
        <times></times>
        <ci>𝐫</ci>
        <ci>t</ci>
       </apply>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>𝐫</ci>
         <ci>normal-′</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>t</ci>
         <ci>normal-′</ci>
        </apply>
       </apply>
      </interval>
      <ci>δ</ci>
      <ci>ρ</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>𝐫</ci>
       <ci>normal-′</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \delta V_{xc}[\rho](\mathbf{r})=\frac{\delta V_{xc}[\rho]}{\delta\rho}\delta%
\rho=f_{xc}(\mathbf{r}t,\mathbf{r^{\prime}}t^{\prime})\delta\rho(\mathbf{r^{%
\prime}})
  </annotation>
 </semantics>
</math>

 Finally, inserting this relation in the response equation for the KS system and comparing the resultant equation with the response equation for the physical system yields the Dyson equation of TDDFT:</p>

<p>

<math display="block" id="Time-dependent_density_functional_theory:18">
 <semantics>
  <mrow>
   <mrow>
    <mi>χ</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <msub>
       <mi>𝐫</mi>
       <mn>1</mn>
      </msub>
      <msub>
       <mi>t</mi>
       <mn>1</mn>
      </msub>
     </mrow>
     <mo>,</mo>
     <mrow>
      <msub>
       <mi>𝐫</mi>
       <mn>2</mn>
      </msub>
      <msub>
       <mi>t</mi>
       <mn>2</mn>
      </msub>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <msub>
      <mi>χ</mi>
      <mrow>
       <mi>K</mi>
       <mi>S</mi>
      </mrow>
     </msub>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <msub>
        <mi>𝐫</mi>
        <mn>𝟏</mn>
       </msub>
       <msub>
        <mi>t</mi>
        <mn>1</mn>
       </msub>
      </mrow>
      <mo>,</mo>
      <mrow>
       <msub>
        <mi>𝐫</mi>
        <mn>2</mn>
       </msub>
       <msub>
        <mi>t</mi>
        <mn>2</mn>
       </msub>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>+</mo>
    <mrow>
     <msub>
      <mi>χ</mi>
      <mrow>
       <mi>K</mi>
       <mi>S</mi>
      </mrow>
     </msub>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <msub>
        <mi>𝐫</mi>
        <mn>𝟏</mn>
       </msub>
       <msub>
        <mi>t</mi>
        <mn>1</mn>
       </msub>
      </mrow>
      <mo>,</mo>
      <mrow>
       <msubsup>
        <mi>𝐫</mi>
        <mn>2</mn>
        <mo>′</mo>
       </msubsup>
       <msubsup>
        <mi>t</mi>
        <mn>2</mn>
        <mo>′</mo>
       </msubsup>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <mrow>
      <mo>(</mo>
      <mrow>
       <mfrac>
        <mn>1</mn>
        <mrow>
         <mo stretchy="false">|</mo>
         <mrow>
          <msubsup>
           <mi>𝐫</mi>
           <mn>2</mn>
           <mo>′</mo>
          </msubsup>
          <mo>-</mo>
          <msubsup>
           <mi>𝐫</mi>
           <mn>1</mn>
           <mo>′</mo>
          </msubsup>
         </mrow>
         <mo stretchy="false">|</mo>
        </mrow>
       </mfrac>
       <mo>+</mo>
       <mrow>
        <msub>
         <mi>f</mi>
         <mrow>
          <mi>x</mi>
          <mi>c</mi>
         </mrow>
        </msub>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <msubsup>
           <mi>𝐫</mi>
           <mn>2</mn>
           <mo>′</mo>
          </msubsup>
          <msubsup>
           <mi>t</mi>
           <mn>2</mn>
           <mo>′</mo>
          </msubsup>
         </mrow>
         <mo>,</mo>
         <mrow>
          <msubsup>
           <mi>𝐫</mi>
           <mn>1</mn>
           <mo>′</mo>
          </msubsup>
          <msubsup>
           <mi>t</mi>
           <mn>1</mn>
           <mo>′</mo>
          </msubsup>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
      </mrow>
      <mo>)</mo>
     </mrow>
     <mi>χ</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <msubsup>
        <mi>𝐫</mi>
        <mn>1</mn>
        <mo>′</mo>
       </msubsup>
       <msubsup>
        <mi>t</mi>
        <mn>1</mn>
        <mo>′</mo>
       </msubsup>
      </mrow>
      <mo>,</mo>
      <mrow>
       <msub>
        <mi>𝐫</mi>
        <mn>2</mn>
       </msub>
       <msub>
        <mi>t</mi>
        <mn>2</mn>
       </msub>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>χ</ci>
     <interval closure="open">
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>𝐫</ci>
        <cn type="integer">1</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>t</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>𝐫</ci>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>t</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
     </interval>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>χ</ci>
       <apply>
        <times></times>
        <ci>K</ci>
        <ci>S</ci>
       </apply>
      </apply>
      <interval closure="open">
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>𝐫</ci>
         <cn type="integer">1</cn>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>t</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>𝐫</ci>
         <cn type="integer">2</cn>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>t</ci>
         <cn type="integer">2</cn>
        </apply>
       </apply>
      </interval>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>χ</ci>
       <apply>
        <times></times>
        <ci>K</ci>
        <ci>S</ci>
       </apply>
      </apply>
      <interval closure="open">
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>𝐫</ci>
         <cn type="integer">1</cn>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>t</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>𝐫</ci>
          <cn type="integer">2</cn>
         </apply>
         <ci>normal-′</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>t</ci>
          <cn type="integer">2</cn>
         </apply>
         <ci>normal-′</ci>
        </apply>
       </apply>
      </interval>
      <apply>
       <plus></plus>
       <apply>
        <divide></divide>
        <cn type="integer">1</cn>
        <apply>
         <abs></abs>
         <apply>
          <minus></minus>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <ci>𝐫</ci>
            <cn type="integer">2</cn>
           </apply>
           <ci>normal-′</ci>
          </apply>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <ci>𝐫</ci>
            <cn type="integer">1</cn>
           </apply>
           <ci>normal-′</ci>
          </apply>
         </apply>
        </apply>
       </apply>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>f</ci>
         <apply>
          <times></times>
          <ci>x</ci>
          <ci>c</ci>
         </apply>
        </apply>
        <interval closure="open">
         <apply>
          <times></times>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <ci>𝐫</ci>
            <cn type="integer">2</cn>
           </apply>
           <ci>normal-′</ci>
          </apply>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <ci>t</ci>
            <cn type="integer">2</cn>
           </apply>
           <ci>normal-′</ci>
          </apply>
         </apply>
         <apply>
          <times></times>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <ci>𝐫</ci>
            <cn type="integer">1</cn>
           </apply>
           <ci>normal-′</ci>
          </apply>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <ci>t</ci>
            <cn type="integer">1</cn>
           </apply>
           <ci>normal-′</ci>
          </apply>
         </apply>
        </interval>
       </apply>
      </apply>
      <ci>χ</ci>
      <interval closure="open">
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>𝐫</ci>
          <cn type="integer">1</cn>
         </apply>
         <ci>normal-′</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>t</ci>
          <cn type="integer">1</cn>
         </apply>
         <ci>normal-′</ci>
        </apply>
       </apply>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>𝐫</ci>
         <cn type="integer">2</cn>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>t</ci>
         <cn type="integer">2</cn>
        </apply>
       </apply>
      </interval>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \chi(\mathbf{r}_{1}t_{1},\mathbf{r}_{2}t_{2})=\chi_{KS}(\mathbf{r_{1}}t_{1},%
\mathbf{r}_{2}t_{2})+\chi_{KS}(\mathbf{r_{1}}t_{1},\mathbf{r}_{2}^{\prime}t_{2%
}^{\prime})\left(\frac{1}{|\mathbf{r}_{2}^{\prime}-\mathbf{r}_{1}^{\prime}|}+f%
_{xc}(\mathbf{r}_{2}^{\prime}t_{2}^{\prime},\mathbf{r}_{1}^{\prime}t_{1}^{%
\prime})\right)\chi(\mathbf{r}_{1}^{\prime}t_{1}^{\prime},\mathbf{r}_{2}t_{2})
  </annotation>
 </semantics>
</math>

</p>

<p>From this last equation it is possible to derive the excitation energies of the system, as these are simply the poles of the response function.</p>

<p>Other linear-response approaches include the Casida formalism (an expansion in electron-hole pairs) and the Sternheimer equation (density-functional perturbation theory).</p>
<h2 id="key-papers">Key papers</h2>
<ul>
<li></li>
<li></li>
</ul>
<h2 id="books-on-tddft">Books on TDDFT</h2>
<ul>
<li></li>
</ul>
<h2 id="tddft-codes">TDDFT codes</h2>
<ul>
<li><a href="http://classic.chem.msu.su/gran/gamess/index.html">Firefly</a></li>
<li><a href="http://www.msg.ameslab.gov/gamess/">GAMESS-US</a></li>
<li><a href="Gaussian_(software)" title="wikilink">Gaussian</a></li>
<li><a href="Amsterdam_Density_Functional" title="wikilink">Amsterdam Density Functional</a></li>
<li><a class="uri" href="CP2K" title="wikilink">CP2K</a></li>
<li><a href="Dalton_(program)" title="wikilink">Dalton</a></li>
<li><a class="uri" href="NWChem" title="wikilink">NWChem</a></li>
<li><a href="octopus_(software)" title="wikilink">Octopus</a></li>
<li><a href="http://www.pw-teleman.org">pw-teleman library</a></li>
<li><a class="uri" href="PARSEC" title="wikilink">PARSEC</a></li>
<li><a class="uri" href="Q-Chem" title="wikilink">Q-Chem</a></li>
<li><a href="Spartan_(software)" title="wikilink">Spartan</a></li>
<li><a class="uri" href="TeraChem" title="wikilink">TeraChem</a></li>
<li><a class="uri" href="TURBOMOLE" title="wikilink">TURBOMOLE</a></li>
<li><a href="YAMBO_code" title="wikilink">YAMBO code</a></li>
<li><a href="https://orcaforum.cec.mpg.de/">ORCA</a></li>
<li><a href="Jaguar_(software)" title="wikilink">Jaguar</a></li>
<li><a href="https://wiki.fysik.dtu.dk/gpaw/">GPAW</a></li>
</ul>
<h2 id="references">References</h2>
<h2 id="external-links">External links</h2>
<ul>
<li><a href="http://tddft.org">tddft.org</a></li>
<li><a href="http://th.physik.uni-frankfurt.de/~engel/tddft.html">Brief introduction of TD-DFT</a></li>
</ul>

<p>"</p>

<p><a href="Category:Density_functional_theory" title="wikilink">Category:Density functional theory</a> <a href="Category:Computational_chemistry" title="wikilink">Category:Computational chemistry</a> <a href="Category:Computational_physics" title="wikilink">Category:Computational physics</a> <a href="Category:Quantum_chemistry" title="wikilink">Category:Quantum chemistry</a> <a href="Category:Theoretical_chemistry" title="wikilink">Category:Theoretical chemistry</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1"><a href="#fnref1">↩</a></li>
<li id="fn2"><a href="#fnref2">↩</a></li>
<li id="fn3"><a href="#fnref3">↩</a></li>
<li id="fn4"><a href="#fnref4">↩</a></li>
<li id="fn5"><a href="#fnref5">↩</a></li>
<li id="fn6"><a href="#fnref6">↩</a></li>
</ol>
</section>
</body>
</html>

<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="1857">Adjunction formula</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Adjunction formula</h1>
<hr/>

<p>In <a class="uri" href="mathematics" title="wikilink">mathematics</a>, especially in <a href="algebraic_geometry" title="wikilink">algebraic geometry</a> and the theory of <a href="complex_manifolds" title="wikilink">complex manifolds</a>, the <strong>adjunction formula</strong> relates the <a href="canonical_bundle" title="wikilink">canonical bundle</a> of a variety and a <a class="uri" href="hypersurface" title="wikilink">hypersurface</a> inside that variety. It is often used to deduce facts about varieties embedded in well-behaved spaces such as <a href="projective_space" title="wikilink">projective space</a> or to prove theorems by induction.</p>
<h2 id="adjunction-for-smooth-varieties">Adjunction for smooth varieties</h2>
<h3 id="formula-for-a-smooth-subvariety">Formula for a smooth subvariety</h3>

<p>Let <em>X</em> be a <a href="smooth_scheme" title="wikilink">smooth</a> algebraic variety or smooth complex manifold and <em>Y</em> be a smooth subvariety of <em>X</em>. Denote the inclusion map  by <em>i</em> and the <a href="ideal_sheaf" title="wikilink">ideal sheaf</a> of <em>Y</em> in <em>X</em> by 

<math display="inline" id="Adjunction_formula:0">
 <semantics>
  <mi class="ltx_font_mathcaligraphic">‚Ñê</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>‚Ñê</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathcal{I}
  </annotation>
 </semantics>
</math>

. The <a href="conormal_exact_sequence" title="wikilink">conormal exact sequence</a> for <em>i</em> is</p>

<p>

<math display="block" id="Adjunction_formula:1">
 <semantics>
  <mrow>
   <mrow>
    <mn>0</mn>
    <mo>‚Üí</mo>
    <mrow>
     <mi class="ltx_font_mathcaligraphic">‚Ñê</mi>
     <mo>/</mo>
     <msup>
      <mi class="ltx_font_mathcaligraphic">‚Ñê</mi>
      <mn>2</mn>
     </msup>
    </mrow>
    <mo>‚Üí</mo>
    <mrow>
     <msup>
      <mi>i</mi>
      <mo>*</mo>
     </msup>
     <msub>
      <mi mathvariant="normal">Œ©</mi>
      <mi>X</mi>
     </msub>
    </mrow>
    <mo>‚Üí</mo>
    <msub>
     <mi mathvariant="normal">Œ©</mi>
     <mi>Y</mi>
    </msub>
    <mo>‚Üí</mo>
    <mn>0</mn>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <ci>normal-‚Üí</ci>
     <cn type="integer">0</cn>
     <apply>
      <divide></divide>
      <ci>‚Ñê</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>‚Ñê</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
    <apply>
     <ci>normal-‚Üí</ci>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>i</ci>
       <times></times>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>normal-Œ©</ci>
       <ci>X</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <ci>normal-‚Üí</ci>
     <share href="#.cmml">
     </share>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>normal-Œ©</ci>
      <ci>Y</ci>
     </apply>
    </apply>
    <apply>
     <ci>normal-‚Üí</ci>
     <share href="#.cmml">
     </share>
     <cn type="integer">0</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   0\to\mathcal{I}/\mathcal{I}^{2}\to i^{*}\Omega_{X}\to\Omega_{Y}\to 0,
  </annotation>
 </semantics>
</math>

 where Œ© denotes a <a href="cotangent_bundle" title="wikilink">cotangent bundle</a>. The determinant of this exact sequence is a natural isomorphism</p>

<p>

<math display="block" id="Adjunction_formula:2">
 <semantics>
  <mrow>
   <msub>
    <mi>œâ</mi>
    <mi>Y</mi>
   </msub>
   <mo>=</mo>
   <msup>
    <mi>i</mi>
    <mo>*</mo>
   </msup>
   <msub>
    <mi>œâ</mi>
    <mi>X</mi>
   </msub>
   <mo>‚äó</mo>
   <mo>det</mo>
   <msup>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi class="ltx_font_mathcaligraphic">‚Ñê</mi>
     <mo>/</mo>
     <msup>
      <mi class="ltx_font_mathcaligraphic">‚Ñê</mi>
      <mn>2</mn>
     </msup>
     <mo stretchy="false">)</mo>
    </mrow>
    <mo>‚à®</mo>
   </msup>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>œâ</ci>
     <ci>Y</ci>
    </apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>i</ci>
     <times></times>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>œâ</ci>
     <ci>X</ci>
    </apply>
    <csymbol cd="latexml">tensor-product</csymbol>
    <ci>det</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <ci>normal-(</ci>
      <csymbol cd="unknown">I</csymbol>
      <divide></divide>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>‚Ñê</ci>
       <cn type="integer">2</cn>
      </apply>
      <ci>normal-)</ci>
     </cerror>
     <or></or>
    </apply>
    <ci>normal-,</ci>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \omega_{Y}=i^{*}\omega_{X}\otimes\operatorname{det}(\mathcal{I}/\mathcal{I}^{2%
})^{\vee},
  </annotation>
 </semantics>
</math>

 where 

<math display="inline" id="Adjunction_formula:3">
 <semantics>
  <mo>‚à®</mo>
  <annotation-xml encoding="MathML-Content">
   <or></or>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \vee
  </annotation>
 </semantics>
</math>

 denotes the dual of a line bundle.</p>
<h3 id="the-particular-case-of-a-smooth-divisor">The particular case of a smooth divisor</h3>

<p>Suppose that <em>D</em> is a smooth <a href="divisor_(algebraic_geometry)" title="wikilink">divisor</a> on <em>X</em>. Its <a href="normal_bundle" title="wikilink">normal bundle</a> extends to a <a href="line_bundle" title="wikilink">line bundle</a> 

<math display="inline" id="Adjunction_formula:4">
 <semantics>
  <mrow>
   <mi class="ltx_font_mathcaligraphic">ùí™</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>D</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>ùí™</ci>
    <ci>D</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathcal{O}(D)
  </annotation>
 </semantics>
</math>

 on <em>X</em>, and the ideal sheaf of <em>D</em> corresponds to its dual 

<math display="inline" id="Adjunction_formula:5">
 <semantics>
  <mrow>
   <mi class="ltx_font_mathcaligraphic">ùí™</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mrow>
     <mo>-</mo>
     <mi>D</mi>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>ùí™</ci>
    <apply>
     <minus></minus>
     <ci>D</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathcal{O}(-D)
  </annotation>
 </semantics>
</math>

. The conormal bundle 

<math display="inline" id="Adjunction_formula:6">
 <semantics>
  <mrow>
   <mi class="ltx_font_mathcaligraphic">‚Ñê</mi>
   <mo>/</mo>
   <msup>
    <mi class="ltx_font_mathcaligraphic">‚Ñê</mi>
    <mn>2</mn>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <divide></divide>
    <ci>‚Ñê</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>‚Ñê</ci>
     <cn type="integer">2</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathcal{I}/\mathcal{I}^{2}
  </annotation>
 </semantics>
</math>

 is 

<math display="inline" id="Adjunction_formula:7">
 <semantics>
  <mrow>
   <msup>
    <mi>i</mi>
    <mo>*</mo>
   </msup>
   <mi class="ltx_font_mathcaligraphic">ùí™</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mrow>
     <mo>-</mo>
     <mi>D</mi>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>i</ci>
     <times></times>
    </apply>
    <ci>ùí™</ci>
    <apply>
     <minus></minus>
     <ci>D</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   i^{*}\mathcal{O}(-D)
  </annotation>
 </semantics>
</math>

, which, combined with the formula above, gives</p>

<p>

<math display="block" id="Adjunction_formula:8">
 <semantics>
  <mrow>
   <msub>
    <mi>œâ</mi>
    <mi>D</mi>
   </msub>
   <mo>=</mo>
   <mrow>
    <msup>
     <mi>i</mi>
     <mo>*</mo>
    </msup>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mrow>
       <msub>
        <mi>œâ</mi>
        <mi>X</mi>
       </msub>
       <mo>‚äó</mo>
       <mi class="ltx_font_mathcaligraphic">ùí™</mi>
      </mrow>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>D</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>œâ</ci>
     <ci>D</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>i</ci>
      <times></times>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="latexml">tensor-product</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>œâ</ci>
        <ci>X</ci>
       </apply>
       <ci>ùí™</ci>
      </apply>
      <ci>D</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \omega_{D}=i^{*}(\omega_{X}\otimes\mathcal{O}(D))
  </annotation>
 </semantics>
</math>

 In terms of canonical classes, this says that</p>

<p>

<math display="block" id="Adjunction_formula:9">
 <semantics>
  <mrow>
   <msub>
    <mi>K</mi>
    <mi>D</mi>
   </msub>
   <mo>=</mo>
   <msub>
    <mrow>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <msub>
        <mi>K</mi>
        <mi>X</mi>
       </msub>
       <mo>+</mo>
       <mi>D</mi>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <mo fence="true">|</mo>
    </mrow>
    <mi>D</mi>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>K</ci>
     <ci>D</ci>
    </apply>
    <apply>
     <csymbol cd="latexml">evaluated-at</csymbol>
     <apply>
      <plus></plus>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>K</ci>
       <ci>X</ci>
      </apply>
      <ci>D</ci>
     </apply>
     <ci>D</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   K_{D}=(K_{X}+D)|_{D}
  </annotation>
 </semantics>
</math>

 Both of these two formulas are called the <strong>adjunction formula</strong>.</p>
<h2 id="poincar√©-residue">Poincar√© residue</h2>

<p>The restriction map 

<math display="inline" id="Adjunction_formula:10">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <msub>
      <mi>œâ</mi>
      <mi>X</mi>
     </msub>
     <mo>‚äó</mo>
     <mi class="ltx_font_mathcaligraphic">ùí™</mi>
    </mrow>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>D</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>‚Üí</mo>
   <msub>
    <mi>œâ</mi>
    <mi>D</mi>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-‚Üí</ci>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="latexml">tensor-product</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>œâ</ci>
       <ci>X</ci>
      </apply>
      <ci>ùí™</ci>
     </apply>
     <ci>D</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>œâ</ci>
     <ci>D</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \omega_{X}\otimes\mathcal{O}(D)\to\omega_{D}
  </annotation>
 </semantics>
</math>

 is called the <strong>Poincar√© residue</strong>. Suppose that <em>X</em> is a complex manifold. Then on sections, the Poincar√© residue can be expressed as follows. Fix an open set <em>U</em> on which <em>D</em> is given by the vanishing of a function <em>f</em>. Any section over <em>U</em> of 

<math display="inline" id="Adjunction_formula:11">
 <semantics>
  <mrow>
   <mi class="ltx_font_mathcaligraphic">ùí™</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>D</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>ùí™</ci>
    <ci>D</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathcal{O}(D)
  </annotation>
 </semantics>
</math>

 can be written as <em>s</em>/<em>f</em>, where <em>s</em> is a holomorphic function on <em>U</em>. Let Œ∑ be a section over <em>U</em> of œâ<sub><em>X</em></sub>. The Poincar√© residue is the map</p>

<p>

<math display="block" id="Adjunction_formula:12">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>Œ∑</mi>
     <mo>‚äó</mo>
     <mfrac>
      <mi>s</mi>
      <mi>f</mi>
     </mfrac>
    </mrow>
    <mo>‚Ü¶</mo>
    <msub>
     <mrow>
      <mrow>
       <mi>s</mi>
       <mfrac>
        <mrow>
         <mo>‚àÇ</mo>
         <mi>Œ∑</mi>
        </mrow>
        <mrow>
         <mo>‚àÇ</mo>
         <mi>f</mi>
        </mrow>
       </mfrac>
      </mrow>
      <mo fence="true">|</mo>
     </mrow>
     <mrow>
      <mi>f</mi>
      <mo>=</mo>
      <mn>0</mn>
     </mrow>
    </msub>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">maps-to</csymbol>
    <apply>
     <csymbol cd="latexml">tensor-product</csymbol>
     <ci>Œ∑</ci>
     <apply>
      <divide></divide>
      <ci>s</ci>
      <ci>f</ci>
     </apply>
    </apply>
    <apply>
     <csymbol cd="latexml">evaluated-at</csymbol>
     <apply>
      <times></times>
      <ci>s</ci>
      <apply>
       <divide></divide>
       <apply>
        <partialdiff></partialdiff>
        <ci>Œ∑</ci>
       </apply>
       <apply>
        <partialdiff></partialdiff>
        <ci>f</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <eq></eq>
      <ci>f</ci>
      <cn type="integer">0</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \eta\otimes\frac{s}{f}\mapsto s\frac{\partial\eta}{\partial f}\bigg|_{f=0},
  </annotation>
 </semantics>
</math>

 that is, it is formed by applying the vector field ‚àÇ/‚àÇ<em>f</em> to the volume form Œ∑, then multiplying by the holomorphic function <em>s</em>. If <em>U</em> admits local coordinates <em>z</em><sub>1</sub>, ..., <em>z</em><sub><em>n</em></sub> such that for some <em>i</em>, ‚àÇ<em>f</em>/‚àÇ<em>z</em><sub><em>i</em></sub> ‚â† 0, then this can also be expressed as</p>

<p>

<math display="block" id="Adjunction_formula:13">
 <semantics>
  <mrow>
   <mrow>
    <mfrac>
     <mrow>
      <mrow>
       <mi>g</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>z</mi>
        <mo rspace="4.2pt" stretchy="false">)</mo>
       </mrow>
       <mi>d</mi>
       <msub>
        <mi>z</mi>
        <mn>1</mn>
       </msub>
      </mrow>
      <mo>‚àß</mo>
      <mi mathvariant="normal">‚ãØ</mi>
      <mo>‚àß</mo>
      <mrow>
       <mi>d</mi>
       <msub>
        <mi>z</mi>
        <mi>n</mi>
       </msub>
      </mrow>
     </mrow>
     <mrow>
      <mi>f</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>z</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mfrac>
    <mo>‚Ü¶</mo>
    <msub>
     <mrow>
      <mrow>
       <msup>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <mo>-</mo>
          <mn>1</mn>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
        <mrow>
         <mi>i</mi>
         <mo>-</mo>
         <mn>1</mn>
        </mrow>
       </msup>
       <mfrac>
        <mrow>
         <mrow>
          <mi>g</mi>
          <mrow>
           <mo stretchy="false">(</mo>
           <mi>z</mi>
           <mo rspace="4.2pt" stretchy="false">)</mo>
          </mrow>
          <mi>d</mi>
          <msub>
           <mi>z</mi>
           <mn>1</mn>
          </msub>
         </mrow>
         <mo>‚àß</mo>
         <mi mathvariant="normal">‚ãØ</mi>
         <mo>‚àß</mo>
         <mover accent="true">
          <mrow>
           <mi>d</mi>
           <msub>
            <mi>z</mi>
            <mi>i</mi>
           </msub>
          </mrow>
          <mo>^</mo>
         </mover>
         <mo>‚àß</mo>
         <mi mathvariant="normal">‚ãØ</mi>
         <mo>‚àß</mo>
         <mrow>
          <mi>d</mi>
          <msub>
           <mi>z</mi>
           <mi>n</mi>
          </msub>
         </mrow>
        </mrow>
        <mrow>
         <mrow>
          <mo>‚àÇ</mo>
          <mi>f</mi>
         </mrow>
         <mo>/</mo>
         <mrow>
          <mo>‚àÇ</mo>
          <msub>
           <mi>z</mi>
           <mi>i</mi>
          </msub>
         </mrow>
        </mrow>
       </mfrac>
      </mrow>
      <mo fence="true">|</mo>
     </mrow>
     <mrow>
      <mi>f</mi>
      <mo>=</mo>
      <mn>0</mn>
     </mrow>
    </msub>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">maps-to</csymbol>
    <apply>
     <divide></divide>
     <apply>
      <and></and>
      <apply>
       <times></times>
       <ci>g</ci>
       <ci>z</ci>
       <ci>d</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>z</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <ci>normal-‚ãØ</ci>
      <apply>
       <times></times>
       <ci>d</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>z</ci>
        <ci>n</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <ci>f</ci>
      <ci>z</ci>
     </apply>
    </apply>
    <apply>
     <csymbol cd="latexml">evaluated-at</csymbol>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
       </apply>
       <apply>
        <minus></minus>
        <ci>i</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <apply>
       <divide></divide>
       <apply>
        <and></and>
        <apply>
         <times></times>
         <ci>g</ci>
         <ci>z</ci>
         <ci>d</ci>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>z</ci>
          <cn type="integer">1</cn>
         </apply>
        </apply>
        <ci>normal-‚ãØ</ci>
        <apply>
         <ci>normal-^</ci>
         <apply>
          <times></times>
          <ci>d</ci>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>z</ci>
           <ci>i</ci>
          </apply>
         </apply>
        </apply>
        <ci>normal-‚ãØ</ci>
        <apply>
         <times></times>
         <ci>d</ci>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>z</ci>
          <ci>n</ci>
         </apply>
        </apply>
       </apply>
       <apply>
        <divide></divide>
        <apply>
         <partialdiff></partialdiff>
         <ci>f</ci>
        </apply>
        <apply>
         <partialdiff></partialdiff>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>z</ci>
          <ci>i</ci>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <eq></eq>
      <ci>f</ci>
      <cn type="integer">0</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \frac{g(z)\,dz_{1}\wedge\cdots\wedge dz_{n}}{f(z)}\mapsto(-1)^{i-1}\frac{g(z)%
\,dz_{1}\wedge\cdots\wedge\widehat{dz_{i}}\wedge\cdots\wedge dz_{n}}{\partial f%
/\partial z_{i}}\bigg|_{f=0}.
  </annotation>
 </semantics>
</math>

</p>

<p>Another way of viewing Poincar√© residue first reinterprets the adjunction formula as an isomorphism</p>

<p>

<math display="block" id="Adjunction_formula:14">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mrow>
      <msub>
       <mi>œâ</mi>
       <mi>D</mi>
      </msub>
      <mo>‚äó</mo>
      <msup>
       <mi>i</mi>
       <mo>*</mo>
      </msup>
     </mrow>
     <mi class="ltx_font_mathcaligraphic">ùí™</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mo>-</mo>
       <mi>D</mi>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <msup>
      <mi>i</mi>
      <mo>*</mo>
     </msup>
     <msub>
      <mi>œâ</mi>
      <mi>X</mi>
     </msub>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="latexml">tensor-product</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>œâ</ci>
       <ci>D</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>i</ci>
       <times></times>
      </apply>
     </apply>
     <ci>ùí™</ci>
     <apply>
      <minus></minus>
      <ci>D</ci>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>i</ci>
      <times></times>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>œâ</ci>
      <ci>X</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \omega_{D}\otimes i^{*}\mathcal{O}(-D)=i^{*}\omega_{X}.
  </annotation>
 </semantics>
</math>

 On an open set <em>U</em> as before, a section of 

<math display="inline" id="Adjunction_formula:15">
 <semantics>
  <mrow>
   <msup>
    <mi>i</mi>
    <mo>*</mo>
   </msup>
   <mi class="ltx_font_mathcaligraphic">ùí™</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mrow>
     <mo>-</mo>
     <mi>D</mi>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>i</ci>
     <times></times>
    </apply>
    <ci>ùí™</ci>
    <apply>
     <minus></minus>
     <ci>D</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   i^{*}\mathcal{O}(-D)
  </annotation>
 </semantics>
</math>

 is the product of a holomorphic function <em>s</em> with the form . The Poincar√© residue is the map that takes the wedge product of a section of œâ<sub><em>D</em></sub> and a section of 

<math display="inline" id="Adjunction_formula:16">
 <semantics>
  <mrow>
   <msup>
    <mi>i</mi>
    <mo>*</mo>
   </msup>
   <mi class="ltx_font_mathcaligraphic">ùí™</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mrow>
     <mo>-</mo>
     <mi>D</mi>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>i</ci>
     <times></times>
    </apply>
    <ci>ùí™</ci>
    <apply>
     <minus></minus>
     <ci>D</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   i^{*}\mathcal{O}(-D)
  </annotation>
 </semantics>
</math>

.</p>
<h2 id="inversion-of-adjunction">Inversion of adjunction</h2>

<p>The adjunction formula is false when the conormal exact sequence is not a short exact sequence. However, it is possible to use this failure to relate the singularities of <em>X</em> with the singularities of <em>D</em>. Theorems of this type are called <strong>inversion of adjunction</strong>. They are an important tool in modern birational geometry.</p>
<h2 id="applications-to-curves">Applications to curves</h2>
<ul>
<li>The <a href="genus-degree_formula" title="wikilink">genus-degree formula</a> for plane curves can be deduced from the adjunction formula.<a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a> Let <em>C</em>¬†‚äÇ¬†<strong>P</strong><sup>2</sup> be a smooth plane curve of degree <em>d</em> and genus <em>g</em>. Let <em>H</em> be the class of a hypersurface in <strong>P</strong><sup>2</sup>, that is, the class of a line. The canonical class of <strong>P</strong><sup>2</sup> is ‚àí3<em>H</em>. Consequently, the adjunction formula says that the restriction of  to <em>C</em> equals the canonical class of <em>C</em>. This restriction is the same as the intersection product  restricted to <em>C</em>, and so the degree of the canonical class of <em>C</em> is . By the <a href="Riemann‚ÄìRoch_theorem" title="wikilink">Riemann‚ÄìRoch theorem</a>, <em>g</em> ‚àí 1 = (<em>d</em> ‚àí 3)<em>d</em> ‚àí <em>g</em> + 1, which implies the formula

<p>

<math display="block" id="Adjunction_formula:17">
 <semantics>
  <mrow>
   <mi>g</mi>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mi>d</mi>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mi>d</mi>
       <mo>-</mo>
       <mn>2</mn>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>/</mo>
    <mn>2.</mn>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>g</ci>
    <apply>
     <divide></divide>
     <apply>
      <times></times>
      <apply>
       <minus></minus>
       <ci>d</ci>
       <cn type="integer">1</cn>
      </apply>
      <apply>
       <minus></minus>
       <ci>d</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
     <cn type="float">2.</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   g=(d-1)(d-2)/2.
  </annotation>
 </semantics>
</math>

</p></li>
<li>Similarly,<a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a> if <em>C</em> is a smooth curve on the quadric surface <strong>P</strong><sup>1</sup>√ó<strong>P</strong><sup>1</sup> with bidegree (<em>d</em><sub>1</sub>,<em>d</em><sub>2</sub>) (meaning <em>d</em><sub>1</sub>,<em>d</em><sub>2</sub> are its intersection degrees with a fiber of each projection to <strong>P</strong><sup>1</sup>), since the canonical class of <strong>P</strong><sup>1</sup>√ó<strong>P</strong><sup>1</sup> has bidegree (‚àí2,‚àí2), the adjunction formula shows that the canonical class of <em>C</em> is the intersection product of divisors of bidegrees (<em>d</em><sub>1</sub>,<em>d</em><sub>2</sub>) and (<em>d</em><sub>1</sub>‚àí2,<em>d</em><sub>2</sub>‚àí2). The intersection form on <strong>P</strong><sup>1</sup>√ó<strong>P</strong><sup>1</sup> is 

<math display="inline" id="Adjunction_formula:18">
 <semantics>
  <mrow>
   <mrow>
    <mo stretchy="false">(</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <msub>
      <mi>d</mi>
      <mn>1</mn>
     </msub>
     <mo>,</mo>
     <msub>
      <mi>d</mi>
      <mn>2</mn>
     </msub>
     <mo stretchy="false">)</mo>
    </mrow>
    <mo>,</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <msub>
      <mi>e</mi>
      <mn>1</mn>
     </msub>
     <mo>,</mo>
     <msub>
      <mi>e</mi>
      <mn>2</mn>
     </msub>
     <mo stretchy="false">)</mo>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>‚Ü¶</mo>
   <mrow>
    <mrow>
     <msub>
      <mi>d</mi>
      <mn>1</mn>
     </msub>
     <msub>
      <mi>e</mi>
      <mn>2</mn>
     </msub>
    </mrow>
    <mo>+</mo>
    <mrow>
     <msub>
      <mi>d</mi>
      <mn>2</mn>
     </msub>
     <msub>
      <mi>e</mi>
      <mn>1</mn>
     </msub>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">maps-to</csymbol>
    <interval closure="open">
     <interval closure="open">
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>d</ci>
       <cn type="integer">1</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>d</ci>
       <cn type="integer">2</cn>
      </apply>
     </interval>
     <interval closure="open">
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>e</ci>
       <cn type="integer">1</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>e</ci>
       <cn type="integer">2</cn>
      </apply>
     </interval>
    </interval>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>d</ci>
       <cn type="integer">1</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>e</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>d</ci>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>e</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   ((d_{1},d_{2}),(e_{1},e_{2}))\mapsto d_{1}e_{2}+d_{2}e_{1}
  </annotation>
 </semantics>
</math>

 by definition of the bidegree and by bilinearity, so applying Riemann‚ÄìRoch gives 

<math display="inline" id="Adjunction_formula:19">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mn>2</mn>
     <mi>g</mi>
    </mrow>
    <mo>-</mo>
    <mn>2</mn>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <msub>
      <mi>d</mi>
      <mn>1</mn>
     </msub>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <msub>
        <mi>d</mi>
        <mn>2</mn>
       </msub>
       <mo>-</mo>
       <mn>2</mn>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>+</mo>
    <mrow>
     <msub>
      <mi>d</mi>
      <mn>2</mn>
     </msub>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <msub>
        <mi>d</mi>
        <mn>1</mn>
       </msub>
       <mo>-</mo>
       <mn>2</mn>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <minus></minus>
     <apply>
      <times></times>
      <cn type="integer">2</cn>
      <ci>g</ci>
     </apply>
     <cn type="integer">2</cn>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>d</ci>
       <cn type="integer">1</cn>
      </apply>
      <apply>
       <minus></minus>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>d</ci>
        <cn type="integer">2</cn>
       </apply>
       <cn type="integer">2</cn>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>d</ci>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <minus></minus>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>d</ci>
        <cn type="integer">1</cn>
       </apply>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   2g-2=d_{1}(d_{2}-2)+d_{2}(d_{1}-2)
  </annotation>
 </semantics>
</math>

 or

<p>

<math display="block" id="Adjunction_formula:20">
 <semantics>
  <mrow>
   <mi>g</mi>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mrow>
      <msub>
       <mi>d</mi>
       <mn>1</mn>
      </msub>
      <msub>
       <mi>d</mi>
       <mn>2</mn>
      </msub>
     </mrow>
     <mo>-</mo>
     <msub>
      <mi>d</mi>
      <mn>1</mn>
     </msub>
     <mo>-</mo>
     <msub>
      <mi>d</mi>
      <mn>2</mn>
     </msub>
    </mrow>
    <mo>+</mo>
    <mn>1</mn>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>g</ci>
    <apply>
     <plus></plus>
     <apply>
      <minus></minus>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>d</ci>
        <cn type="integer">1</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>d</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>d</ci>
       <cn type="integer">1</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>d</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
     <cn type="integer">1</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   g=d_{1}d_{2}-d_{1}-d_{2}+1
  </annotation>
 </semantics>
</math>

</p></li>
<li>The genus of a curve <em>C</em> which is the <a href="complete_intersection" title="wikilink">complete intersection</a> of two surfaces <em>D</em> and <em>E</em> in <strong>P</strong><sup>3</sup> can also be computed using the adjunction formula. Suppose that <em>d</em> and <em>e</em> are the degrees of <em>D</em> and <em>E</em>, respectively. Applying the adjunction formula to <em>D</em> shows that its canonical divisor is <mtpl></mtpl>, which is the intersection product of  and <em>D</em>. Doing this again with <em>E</em>, which is possible because <em>C</em> is a complete intersection, shows that the canonical divisor <em>C</em> is the product , that is, it has degree . By the Riemann‚ÄìRoch theorem, this implies that the genus of <em>C</em> is

<p>

<math display="block" id="Adjunction_formula:21">
 <semantics>
  <mrow>
   <mi>g</mi>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mrow>
      <mi>d</mi>
      <mi>e</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mrow>
         <mi>d</mi>
         <mo>+</mo>
         <mi>e</mi>
        </mrow>
        <mo>-</mo>
        <mn>4</mn>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo>/</mo>
     <mn>2</mn>
    </mrow>
    <mo>+</mo>
    <mn>1.</mn>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>g</ci>
    <apply>
     <plus></plus>
     <apply>
      <divide></divide>
      <apply>
       <times></times>
       <ci>d</ci>
       <ci>e</ci>
       <apply>
        <minus></minus>
        <apply>
         <plus></plus>
         <ci>d</ci>
         <ci>e</ci>
        </apply>
        <cn type="integer">4</cn>
       </apply>
      </apply>
      <cn type="integer">2</cn>
     </apply>
     <cn type="float">1.</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   g=de(d+e-4)/2+1.
  </annotation>
 </semantics>
</math>

</p></li>
</ul>
<h2 id="see-also">See also</h2>

<p><a href="Logarithmic_form" title="wikilink">Logarithmic form</a></p>
<h2 id="references">References</h2>
<ul>
<li></li>
<li><em>Intersection theory</em> 2nd edition, William Fulton, Springer, ISBN 0-387-98549-2, Example 3.2.12.</li>
<li><em>Principles of algebraic geometry</em>, Griffiths and Harris, Wiley classics library, ISBN 0-471-05059-8 pp 146‚Äì147.</li>
<li><em>Algebraic geometry</em>, <a href="Robin_Hartshorne" title="wikilink">Robin Hartshorne</a>, Springer GTM 52, ISBN 0-387-90244-9, Proposition II.8.20.</li>
</ul>

<p>"</p>

<p><a href="Category:Algebraic_geometry" title="wikilink">Category:Algebraic geometry</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1">Hartshorne, chapter V, example 1.5.1<a href="#fnref1">‚Ü©</a></li>
<li id="fn2">Hartshorne, chapter V, example 1.5.2<a href="#fnref2">‚Ü©</a></li>
</ol>
</section>
</body>
</html>

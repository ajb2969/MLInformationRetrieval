<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="1403">Canonical transformation</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Canonical transformation</h1>
<hr/>

<p>In <a href="Hamiltonian_mechanics" title="wikilink">Hamiltonian mechanics</a>, a <strong>canonical transformation</strong> is a change of <a href="canonical_coordinates" title="wikilink">canonical coordinates</a> 

<math display="inline" id="Canonical_transformation:0">
 <semantics>
  <mrow>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>𝐪</mi>
    <mo>,</mo>
    <mi>𝐩</mi>
    <mo>,</mo>
    <mi>t</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mi mathvariant="normal">→</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>𝐐</mi>
    <mo>,</mo>
    <mi>𝐏</mi>
    <mo>,</mo>
    <mi>t</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <vector>
     <ci>𝐪</ci>
     <ci>𝐩</ci>
     <ci>t</ci>
    </vector>
    <ci>normal-→</ci>
    <vector>
     <ci>𝐐</ci>
     <ci>𝐏</ci>
     <ci>t</ci>
    </vector>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (\mathbf{q},\mathbf{p},t)→(\mathbf{Q},\mathbf{P},t)
  </annotation>
 </semantics>
</math>

 that preserves the form of <a href="Hamilton's_equations" title="wikilink">Hamilton's equations</a> (that is, the new Hamilton's equations resulting from the transformed Hamiltonian may be simply obtained by substituting the new coordinates for the old coordinates), although it might not preserve the <a href="Hamiltonian_mechanics" title="wikilink">Hamiltonian</a> itself. This is sometimes known as <strong>form invariance</strong>. Canonical transformations are useful in their own right, and also form the basis for the <a href="Hamilton–Jacobi_equation" title="wikilink">Hamilton–Jacobi equations</a> (a useful method for calculating <a href="constant_of_motion" title="wikilink">conserved quantities</a>) and <a href="Liouville's_theorem_(Hamiltonian)" title="wikilink">Liouville's theorem</a> (itself the basis for classical <a href="statistical_mechanics" title="wikilink">statistical mechanics</a>).</p>

<p>Since <a href="Lagrangian_mechanics" title="wikilink">Lagrangian mechanics</a> is based on <a href="generalized_coordinates" title="wikilink">generalized coordinates</a>, transformations of the coordinates 

<math display="inline" id="Canonical_transformation:1">
 <semantics>
  <mrow>
   <mi>𝐪</mi>
   <mi mathvariant="normal">→</mi>
   <mi>𝐐</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>𝐪</ci>
    <ci>normal-→</ci>
    <ci>𝐐</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{q}→\mathbf{Q}
  </annotation>
 </semantics>
</math>

 do not affect the form of <a href="Lagrangian_mechanics" title="wikilink">Lagrange's equations</a> and, hence, do not affect the form of <a href="Hamilton's_equations" title="wikilink">Hamilton's equations</a> if we simultaneously change the momentum by a <a href="Legendre_transform" title="wikilink">Legendre transform</a> into</p>

<p>

<math display="block" id="Canonical_transformation:2">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>P</mi>
     <mi>i</mi>
    </msub>
    <mo>=</mo>
    <mfrac>
     <mrow>
      <mo>∂</mo>
      <mi>L</mi>
     </mrow>
     <mrow>
      <mo>∂</mo>
      <msub>
       <mover accent="true">
        <mi>Q</mi>
        <mo>˙</mo>
       </mover>
       <mi>i</mi>
      </msub>
     </mrow>
    </mfrac>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>P</ci>
     <ci>i</ci>
    </apply>
    <apply>
     <divide></divide>
     <apply>
      <partialdiff></partialdiff>
      <ci>L</ci>
     </apply>
     <apply>
      <partialdiff></partialdiff>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <apply>
        <ci>normal-˙</ci>
        <ci>Q</ci>
       </apply>
       <ci>i</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   P_{i}=\frac{\partial L}{\partial\dot{Q}_{i}}.
  </annotation>
 </semantics>
</math>

</p>

<p>Therefore, coordinate transformations (also called <strong>point transformations</strong>) are a <em>type</em> of canonical transformation. However, the class of canonical transformations is much broader, since the old generalized coordinates, momenta and even time may be combined to form the new generalized coordinates and momenta. Canonical transformations that do not include the time explicitly are called <strong>restricted canonical transformations</strong> (many textbooks consider only this type).</p>

<p>For clarity, we restrict the presentation here to <a class="uri" href="calculus" title="wikilink">calculus</a> and <a href="classical_mechanics" title="wikilink">classical mechanics</a>. Readers familiar with more advanced mathematics such as <a href="cotangent_bundle" title="wikilink">cotangent bundles</a>, <a href="exterior_derivative" title="wikilink">exterior derivatives</a> and <a href="symplectic_manifold" title="wikilink">symplectic manifolds</a> should read the related <a class="uri" href="symplectomorphism" title="wikilink">symplectomorphism</a> article. (Canonical transformations are a special case of a symplectomorphism.) However, a brief introduction to the modern mathematical description is included at the end of this article.</p>
<h2 id="notation">Notation</h2>

<p>Boldface variables such as 

<math display="inline" id="Canonical_transformation:3">
 <semantics>
  <mi>𝐪</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>𝐪</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{q}
  </annotation>
 </semantics>
</math>

 represent a list of 

<math display="inline" id="Canonical_transformation:4">
 <semantics>
  <mi>N</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>N</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   N
  </annotation>
 </semantics>
</math>

 <a href="generalized_coordinates" title="wikilink">generalized coordinates</a> that need not transform like a <a href="Vector_(geometric)" title="wikilink">vector</a> under <a class="uri" href="rotation" title="wikilink">rotation</a>, e.g.,</p>

<p>

<math display="block" id="Canonical_transformation:5">
 <semantics>
  <mrow>
   <mrow>
    <mi>𝐪</mi>
    <mo>≡</mo>
    <mrow>
     <mo>(</mo>
     <msub>
      <mi>q</mi>
      <mn>1</mn>
     </msub>
     <mo>,</mo>
     <msub>
      <mi>q</mi>
      <mn>2</mn>
     </msub>
     <mo>,</mo>
     <mi mathvariant="normal">…</mi>
     <mo>,</mo>
     <msub>
      <mi>q</mi>
      <mrow>
       <mi>N</mi>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
     </msub>
     <mo>,</mo>
     <msub>
      <mi>q</mi>
      <mi>N</mi>
     </msub>
     <mo>)</mo>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <equivalent></equivalent>
    <ci>𝐪</ci>
    <vector>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>q</ci>
      <cn type="integer">1</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>q</ci>
      <cn type="integer">2</cn>
     </apply>
     <ci>normal-…</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>q</ci>
      <apply>
       <minus></minus>
       <ci>N</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>q</ci>
      <ci>N</ci>
     </apply>
    </vector>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{q}\equiv\left(q_{1},q_{2},\ldots,q_{N-1},q_{N}\right).
  </annotation>
 </semantics>
</math>

</p>

<p>A dot over a variable or list signifies the time derivative, e.g.,</p>

<p>

<math display="block" id="Canonical_transformation:6">
 <semantics>
  <mrow>
   <mrow>
    <mover accent="true">
     <mi>𝐪</mi>
     <mo>˙</mo>
    </mover>
    <mo>≡</mo>
    <mfrac>
     <mrow>
      <mi>d</mi>
      <mi>𝐪</mi>
     </mrow>
     <mrow>
      <mi>d</mi>
      <mi>t</mi>
     </mrow>
    </mfrac>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <equivalent></equivalent>
    <apply>
     <ci>normal-˙</ci>
     <ci>𝐪</ci>
    </apply>
    <apply>
     <divide></divide>
     <apply>
      <times></times>
      <ci>d</ci>
      <ci>𝐪</ci>
     </apply>
     <apply>
      <times></times>
      <ci>d</ci>
      <ci>t</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \dot{\mathbf{q}}\equiv\frac{d\mathbf{q}}{dt}.
  </annotation>
 </semantics>
</math>

</p>

<p>The <a href="dot_product" title="wikilink">dot product</a> notation between two lists of the same number of coordinates is a shorthand for the sum of the products of corresponding components, e.g.,</p>

<p>

<math display="block" id="Canonical_transformation:7">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>𝐩</mi>
     <mo>⋅</mo>
     <mi>𝐪</mi>
    </mrow>
    <mo>≡</mo>
    <mrow>
     <munderover>
      <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
      <mrow>
       <mi>k</mi>
       <mo>=</mo>
       <mn>1</mn>
      </mrow>
      <mi>N</mi>
     </munderover>
     <mrow>
      <msub>
       <mi>p</mi>
       <mi>k</mi>
      </msub>
      <msub>
       <mi>q</mi>
       <mi>k</mi>
      </msub>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <equivalent></equivalent>
    <apply>
     <ci>normal-⋅</ci>
     <ci>𝐩</ci>
     <ci>𝐪</ci>
    </apply>
    <apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <apply>
        <eq></eq>
        <ci>k</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <ci>N</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>p</ci>
       <ci>k</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>q</ci>
       <ci>k</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{p}\cdot\mathbf{q}\equiv\sum_{k=1}^{N}p_{k}q_{k}.
  </annotation>
 </semantics>
</math>

</p>

<p>The dot product (also known as an "inner product") maps the two coordinate lists into one variable representing a single numerical value.</p>
<h2 id="direct-approach">Direct approach</h2>

<p>The functional form of <a href="Hamilton's_equations" title="wikilink">Hamilton's equations</a> is</p>

<p>

<math display="inline" id="Canonical_transformation:8">
 <semantics>
  <mover accent="true">
   <mi>𝐩</mi>
   <mo>˙</mo>
  </mover>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-˙</ci>
    <ci>𝐩</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle\dot{\mathbf{p}}
  </annotation>
 </semantics>
</math>


</p>

<p>By definition, the transformed coordinates have analogous dynamics</p>

<p>

<math display="inline" id="Canonical_transformation:9">
 <semantics>
  <mover accent="true">
   <mi>𝐏</mi>
   <mo>˙</mo>
  </mover>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-˙</ci>
    <ci>𝐏</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle\dot{\mathbf{P}}
  </annotation>
 </semantics>
</math>


</p>

<p>where 

<math display="inline" id="Canonical_transformation:10">
 <semantics>
  <mrow>
   <mi>K</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>𝐐</mi>
    <mo>,</mo>
    <mi>𝐏</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>K</ci>
    <interval closure="open">
     <ci>𝐐</ci>
     <ci>𝐏</ci>
    </interval>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   K(\mathbf{Q},\mathbf{P})
  </annotation>
 </semantics>
</math>

 is a new Hamiltonian that must be determined.</p>

<p>In general, a transformation 

<math display="inline" id="Canonical_transformation:11">
 <semantics>
  <mrow>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>𝐪</mi>
    <mo>,</mo>
    <mi>𝐩</mi>
    <mo>,</mo>
    <mi>t</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mi mathvariant="normal">→</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>𝐐</mi>
    <mo>,</mo>
    <mi>𝐏</mi>
    <mo>,</mo>
    <mi>t</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <vector>
     <ci>𝐪</ci>
     <ci>𝐩</ci>
     <ci>t</ci>
    </vector>
    <ci>normal-→</ci>
    <vector>
     <ci>𝐐</ci>
     <ci>𝐏</ci>
     <ci>t</ci>
    </vector>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (\mathbf{q},\mathbf{p},t)→(\mathbf{Q},\mathbf{P},t)
  </annotation>
 </semantics>
</math>

 does not preserve the form of <a href="Hamilton's_equations" title="wikilink">Hamilton's equations</a>. For time independent transformations between 

<math display="inline" id="Canonical_transformation:12">
 <semantics>
  <mrow>
   <mo stretchy="false">(</mo>
   <mi>𝐪</mi>
   <mo>,</mo>
   <mi>𝐩</mi>
   <mo stretchy="false">)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <interval closure="open">
    <ci>𝐪</ci>
    <ci>𝐩</ci>
   </interval>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (\mathbf{q},\mathbf{p})
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Canonical_transformation:13">
 <semantics>
  <mrow>
   <mo stretchy="false">(</mo>
   <mi>𝐐</mi>
   <mo>,</mo>
   <mi>𝐏</mi>
   <mo stretchy="false">)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <interval closure="open">
    <ci>𝐐</ci>
    <ci>𝐏</ci>
   </interval>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (\mathbf{Q},\mathbf{P})
  </annotation>
 </semantics>
</math>

 we may check if the transformation is restricted canonical, as follows. Since restricted transformations have no explicit time dependence (by definition), the time derivative of a new generalized coordinate <mtpl></mtpl> is</p>

<p>

<math display="inline" id="Canonical_transformation:14">
 <semantics>
  <msub>
   <mover accent="true">
    <mi>Q</mi>
    <mo>˙</mo>
   </mover>
   <mi>m</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <apply>
     <ci>normal-˙</ci>
     <ci>Q</ci>
    </apply>
    <ci>m</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle\dot{Q}_{m}
  </annotation>
 </semantics>
</math>


</p>

<p>where  is the <a href="Poisson_bracket" title="wikilink">Poisson bracket</a>.</p>

<p>We also have the identity for the conjugate momentum <em>P<sub>m</sub></em></p>

<p>

<math display="block" id="Canonical_transformation:15">
 <semantics>
  <mrow>
   <mfrac>
    <mrow>
     <mo>∂</mo>
     <mi>H</mi>
    </mrow>
    <mrow>
     <mo>∂</mo>
     <msub>
      <mi>P</mi>
      <mi>m</mi>
     </msub>
    </mrow>
   </mfrac>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mfrac>
      <mrow>
       <mo>∂</mo>
       <mi>H</mi>
      </mrow>
      <mrow>
       <mo>∂</mo>
       <mi>𝐪</mi>
      </mrow>
     </mfrac>
     <mo>⋅</mo>
     <mfrac>
      <mrow>
       <mo>∂</mo>
       <mi>𝐪</mi>
      </mrow>
      <mrow>
       <mo>∂</mo>
       <msub>
        <mi>P</mi>
        <mi>m</mi>
       </msub>
      </mrow>
     </mfrac>
    </mrow>
    <mo>+</mo>
    <mrow>
     <mfrac>
      <mrow>
       <mo>∂</mo>
       <mi>H</mi>
      </mrow>
      <mrow>
       <mo>∂</mo>
       <mi>𝐩</mi>
      </mrow>
     </mfrac>
     <mo>⋅</mo>
     <mfrac>
      <mrow>
       <mo>∂</mo>
       <mi>𝐩</mi>
      </mrow>
      <mrow>
       <mo>∂</mo>
       <msub>
        <mi>P</mi>
        <mi>m</mi>
       </msub>
      </mrow>
     </mfrac>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <divide></divide>
     <apply>
      <partialdiff></partialdiff>
      <ci>H</ci>
     </apply>
     <apply>
      <partialdiff></partialdiff>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>P</ci>
       <ci>m</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <ci>normal-⋅</ci>
      <apply>
       <divide></divide>
       <apply>
        <partialdiff></partialdiff>
        <ci>H</ci>
       </apply>
       <apply>
        <partialdiff></partialdiff>
        <ci>𝐪</ci>
       </apply>
      </apply>
      <apply>
       <divide></divide>
       <apply>
        <partialdiff></partialdiff>
        <ci>𝐪</ci>
       </apply>
       <apply>
        <partialdiff></partialdiff>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>P</ci>
         <ci>m</ci>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <ci>normal-⋅</ci>
      <apply>
       <divide></divide>
       <apply>
        <partialdiff></partialdiff>
        <ci>H</ci>
       </apply>
       <apply>
        <partialdiff></partialdiff>
        <ci>𝐩</ci>
       </apply>
      </apply>
      <apply>
       <divide></divide>
       <apply>
        <partialdiff></partialdiff>
        <ci>𝐩</ci>
       </apply>
       <apply>
        <partialdiff></partialdiff>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>P</ci>
         <ci>m</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \frac{\partial H}{\partial P_{m}}=\frac{\partial H}{\partial\mathbf{q}}\cdot%
\frac{\partial\mathbf{q}}{\partial P_{m}}+\frac{\partial H}{\partial\mathbf{p}%
}\cdot\frac{\partial\mathbf{p}}{\partial P_{m}}
  </annotation>
 </semantics>
</math>

</p>

<p>If the transformation is canonical, these two must be equal, resulting in the equations</p>

<p>

<math display="inline" id="Canonical_transformation:16">
 <semantics>
  <msub>
   <mrow>
    <mo>(</mo>
    <mstyle displaystyle="true">
     <mfrac>
      <mrow>
       <mo>∂</mo>
       <msub>
        <mi>Q</mi>
        <mi>m</mi>
       </msub>
      </mrow>
      <mrow>
       <mo>∂</mo>
       <msub>
        <mi>p</mi>
        <mi>n</mi>
       </msub>
      </mrow>
     </mfrac>
    </mstyle>
    <mo>)</mo>
   </mrow>
   <mrow>
    <mi>𝐪</mi>
    <mo>,</mo>
    <mi>𝐩</mi>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <apply>
     <divide></divide>
     <apply>
      <partialdiff></partialdiff>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>Q</ci>
       <ci>m</ci>
      </apply>
     </apply>
     <apply>
      <partialdiff></partialdiff>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>p</ci>
       <ci>n</ci>
      </apply>
     </apply>
    </apply>
    <list>
     <ci>𝐪</ci>
     <ci>𝐩</ci>
    </list>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle\left(\frac{\partial Q_{m}}{\partial p_{n}}\right)_{\mathbf{q},%
\mathbf{p}}
  </annotation>
 </semantics>
</math>


</p>

<p>The analogous argument for the generalized momenta <em>P<sub>m</sub></em> leads to two other sets of equations</p>

<p>

<math display="inline" id="Canonical_transformation:17">
 <semantics>
  <msub>
   <mrow>
    <mo>(</mo>
    <mstyle displaystyle="true">
     <mfrac>
      <mrow>
       <mo>∂</mo>
       <msub>
        <mi>P</mi>
        <mi>m</mi>
       </msub>
      </mrow>
      <mrow>
       <mo>∂</mo>
       <msub>
        <mi>p</mi>
        <mi>n</mi>
       </msub>
      </mrow>
     </mfrac>
    </mstyle>
    <mo>)</mo>
   </mrow>
   <mrow>
    <mi>𝐪</mi>
    <mo>,</mo>
    <mi>𝐩</mi>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <apply>
     <divide></divide>
     <apply>
      <partialdiff></partialdiff>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>P</ci>
       <ci>m</ci>
      </apply>
     </apply>
     <apply>
      <partialdiff></partialdiff>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>p</ci>
       <ci>n</ci>
      </apply>
     </apply>
    </apply>
    <list>
     <ci>𝐪</ci>
     <ci>𝐩</ci>
    </list>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle\left(\frac{\partial P_{m}}{\partial p_{n}}\right)_{\mathbf{q},%
\mathbf{p}}
  </annotation>
 </semantics>
</math>


</p>

<p>These are the <strong>direct conditions</strong> to check whether a given transformation is canonical.</p>
<h2 id="liouvilles-theorem">Liouville's theorem</h2>

<p>The direct conditions allow us to prove <a href="Liouville's_theorem_(Hamiltonian)" title="wikilink">Liouville's theorem</a>, which states that the <em>volume</em> in phase space is conserved under canonical transformations, i.e.,</p>

<p>

<math display="block" id="Canonical_transformation:18">
 <semantics>
  <mrow>
   <mrow>
    <mo largeop="true" symmetric="true">∫</mo>
    <mrow>
     <mi>d</mi>
     <mi>𝐪</mi>
     <mi>d</mi>
     <mi>𝐩</mi>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mo largeop="true" symmetric="true">∫</mo>
    <mrow>
     <mi>d</mi>
     <mi>𝐐</mi>
     <mi>d</mi>
     <mi>𝐏</mi>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <int></int>
     <apply>
      <times></times>
      <ci>d</ci>
      <ci>𝐪</ci>
      <ci>d</ci>
      <ci>𝐩</ci>
     </apply>
    </apply>
    <apply>
     <int></int>
     <apply>
      <times></times>
      <ci>d</ci>
      <ci>𝐐</ci>
      <ci>d</ci>
      <ci>𝐏</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \int d\mathbf{q}d\mathbf{p}=\int d\mathbf{Q}d\mathbf{P}
  </annotation>
 </semantics>
</math>

</p>

<p>By <a class="uri" href="calculus" title="wikilink">calculus</a>, the latter integral must equal the former times the <a href="Jacobian_matrix_and_determinant" title="wikilink">Jacobian</a> 

<math display="inline" id="Canonical_transformation:19">
 <semantics>
  <mi>J</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>J</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   J
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Canonical_transformation:20">
 <semantics>
  <mrow>
   <mrow>
    <mo largeop="true" symmetric="true">∫</mo>
    <mrow>
     <mi>d</mi>
     <mi>𝐐</mi>
     <mi>d</mi>
     <mi>𝐏</mi>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mo largeop="true" symmetric="true">∫</mo>
    <mrow>
     <mi>J</mi>
     <mi>d</mi>
     <mi>𝐪</mi>
     <mi>d</mi>
     <mi>𝐩</mi>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <int></int>
     <apply>
      <times></times>
      <ci>d</ci>
      <ci>𝐐</ci>
      <ci>d</ci>
      <ci>𝐏</ci>
     </apply>
    </apply>
    <apply>
     <int></int>
     <apply>
      <times></times>
      <ci>J</ci>
      <ci>d</ci>
      <ci>𝐪</ci>
      <ci>d</ci>
      <ci>𝐩</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \int d\mathbf{Q}d\mathbf{P}=\int Jd\mathbf{q}d\mathbf{p}
  </annotation>
 </semantics>
</math>

</p>

<p>where the Jacobian is the <a class="uri" href="determinant" title="wikilink">determinant</a> of the <a href="matrix_(mathematics)" title="wikilink">matrix</a> of <a href="partial_derivative" title="wikilink">partial derivatives</a>, which we write as</p>

<p>

<math display="block" id="Canonical_transformation:21">
 <semantics>
  <mrow>
   <mi>J</mi>
   <mo>≡</mo>
   <mfrac>
    <mrow>
     <mo>∂</mo>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>𝐐</mi>
      <mo>,</mo>
      <mi>𝐏</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mrow>
     <mo>∂</mo>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>𝐪</mi>
      <mo>,</mo>
      <mi>𝐩</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mfrac>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <equivalent></equivalent>
    <ci>J</ci>
    <apply>
     <divide></divide>
     <apply>
      <partialdiff></partialdiff>
      <ci>𝐐</ci>
      <ci>𝐏</ci>
     </apply>
     <apply>
      <partialdiff></partialdiff>
      <ci>𝐪</ci>
      <ci>𝐩</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   J\equiv\frac{\partial(\mathbf{Q},\mathbf{P})}{\partial(\mathbf{q},\mathbf{p})}
  </annotation>
 </semantics>
</math>

</p>

<p>Exploiting the "division" property of <a href="Jacobian_matrix_and_determinant" title="wikilink">Jacobians</a> yields</p>

<p>

<math display="block" id="Canonical_transformation:22">
 <semantics>
  <mrow>
   <mi>J</mi>
   <mo>≡</mo>
   <mrow>
    <mfrac>
     <mrow>
      <mo>∂</mo>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>𝐐</mi>
       <mo>,</mo>
       <mi>𝐏</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mrow>
      <mo>∂</mo>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>𝐪</mi>
       <mo>,</mo>
       <mi>𝐏</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mfrac>
    <mo>/</mo>
    <mfrac>
     <mrow>
      <mo>∂</mo>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>𝐪</mi>
       <mo>,</mo>
       <mi>𝐩</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mrow>
      <mo>∂</mo>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>𝐪</mi>
       <mo>,</mo>
       <mi>𝐏</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mfrac>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <equivalent></equivalent>
    <ci>J</ci>
    <apply>
     <ci>normal-/</ci>
     <apply>
      <divide></divide>
      <apply>
       <partialdiff></partialdiff>
       <ci>𝐐</ci>
       <ci>𝐏</ci>
      </apply>
      <apply>
       <partialdiff></partialdiff>
       <ci>𝐪</ci>
       <ci>𝐏</ci>
      </apply>
     </apply>
     <apply>
      <divide></divide>
      <apply>
       <partialdiff></partialdiff>
       <ci>𝐪</ci>
       <ci>𝐩</ci>
      </apply>
      <apply>
       <partialdiff></partialdiff>
       <ci>𝐪</ci>
       <ci>𝐏</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   J\equiv\frac{\partial(\mathbf{Q},\mathbf{P})}{\partial(\mathbf{q},\mathbf{P})}%
\left/\frac{\partial(\mathbf{q},\mathbf{p})}{\partial(\mathbf{q},\mathbf{P})}\right.
  </annotation>
 </semantics>
</math>

</p>

<p>Eliminating the repeated variables gives</p>

<p>

<math display="block" id="Canonical_transformation:23">
 <semantics>
  <mrow>
   <mi>J</mi>
   <mo>≡</mo>
   <mrow>
    <mfrac>
     <mrow>
      <mo>∂</mo>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>𝐐</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mrow>
      <mo>∂</mo>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>𝐪</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mfrac>
    <mo>/</mo>
    <mfrac>
     <mrow>
      <mo>∂</mo>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>𝐩</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mrow>
      <mo>∂</mo>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>𝐏</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mfrac>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <equivalent></equivalent>
    <ci>J</ci>
    <apply>
     <ci>normal-/</ci>
     <apply>
      <divide></divide>
      <apply>
       <partialdiff></partialdiff>
       <ci>𝐐</ci>
      </apply>
      <apply>
       <partialdiff></partialdiff>
       <ci>𝐪</ci>
      </apply>
     </apply>
     <apply>
      <divide></divide>
      <apply>
       <partialdiff></partialdiff>
       <ci>𝐩</ci>
      </apply>
      <apply>
       <partialdiff></partialdiff>
       <ci>𝐏</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   J\equiv\frac{\partial(\mathbf{Q})}{\partial(\mathbf{q})}\left/\frac{\partial(%
\mathbf{p})}{\partial(\mathbf{P})}\right.
  </annotation>
 </semantics>
</math>

</p>

<p>Application of the <strong>direct conditions</strong> above yields 

<math display="inline" id="Canonical_transformation:24">
 <semantics>
  <mrow>
   <mi>J</mi>
   <mo>=</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>J</ci>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   J=1
  </annotation>
 </semantics>
</math>

.</p>
<h2 id="generating-function-approach">Generating function approach</h2>

<p>To <em>guarantee</em> a valid transformation between 

<math display="inline" id="Canonical_transformation:25">
 <semantics>
  <mrow>
   <mo stretchy="false">(</mo>
   <mi>𝐪</mi>
   <mo>,</mo>
   <mi>𝐩</mi>
   <mo>,</mo>
   <mi>H</mi>
   <mo stretchy="false">)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <vector>
    <ci>𝐪</ci>
    <ci>𝐩</ci>
    <ci>H</ci>
   </vector>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (\mathbf{q},\mathbf{p},H)
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Canonical_transformation:26">
 <semantics>
  <mrow>
   <mo stretchy="false">(</mo>
   <mi>𝐐</mi>
   <mo>,</mo>
   <mi>𝐏</mi>
   <mo>,</mo>
   <mi>K</mi>
   <mo stretchy="false">)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <vector>
    <ci>𝐐</ci>
    <ci>𝐏</ci>
    <ci>K</ci>
   </vector>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (\mathbf{Q},\mathbf{P},K)
  </annotation>
 </semantics>
</math>

, we may resort to an indirect <strong>generating function</strong> approach. Both sets of variables must obey <a href="action_(physics)" title="wikilink">Hamilton's principle</a>. That is the <a href="Action_Integral" title="wikilink">Action Integral</a> over the <a href="Lagrangian_mechanics" title="wikilink">Lagrangian</a> 

<math display="inline" id="Canonical_transformation:27">
 <semantics>
  <mrow>
   <msub>
    <mi class="ltx_font_mathcaligraphic">ℒ</mi>
    <mrow>
     <mi>q</mi>
     <mi>p</mi>
    </mrow>
   </msub>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mi>𝐩</mi>
     <mo>⋅</mo>
     <mover accent="true">
      <mi>𝐪</mi>
      <mo>˙</mo>
     </mover>
    </mrow>
    <mo>-</mo>
    <mrow>
     <mi>H</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>𝐪</mi>
      <mo>,</mo>
      <mi>𝐩</mi>
      <mo>,</mo>
      <mi>t</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>ℒ</ci>
     <apply>
      <times></times>
      <ci>q</ci>
      <ci>p</ci>
     </apply>
    </apply>
    <apply>
     <minus></minus>
     <apply>
      <ci>normal-⋅</ci>
      <ci>𝐩</ci>
      <apply>
       <ci>normal-˙</ci>
       <ci>𝐪</ci>
      </apply>
     </apply>
     <apply>
      <times></times>
      <ci>H</ci>
      <vector>
       <ci>𝐪</ci>
       <ci>𝐩</ci>
       <ci>t</ci>
      </vector>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathcal{L}_{qp}=\mathbf{p}\cdot\dot{\mathbf{q}}-H(\mathbf{q},\mathbf{p},t)
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Canonical_transformation:28">
 <semantics>
  <mrow>
   <msub>
    <mi class="ltx_font_mathcaligraphic">ℒ</mi>
    <mrow>
     <mi>Q</mi>
     <mi>P</mi>
    </mrow>
   </msub>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mi>𝐏</mi>
     <mo>⋅</mo>
     <mover accent="true">
      <mi>𝐐</mi>
      <mo>˙</mo>
     </mover>
    </mrow>
    <mo>-</mo>
    <mrow>
     <mi>K</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>𝐐</mi>
      <mo>,</mo>
      <mi>𝐏</mi>
      <mo>,</mo>
      <mi>t</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>ℒ</ci>
     <apply>
      <times></times>
      <ci>Q</ci>
      <ci>P</ci>
     </apply>
    </apply>
    <apply>
     <minus></minus>
     <apply>
      <ci>normal-⋅</ci>
      <ci>𝐏</ci>
      <apply>
       <ci>normal-˙</ci>
       <ci>𝐐</ci>
      </apply>
     </apply>
     <apply>
      <times></times>
      <ci>K</ci>
      <vector>
       <ci>𝐐</ci>
       <ci>𝐏</ci>
       <ci>t</ci>
      </vector>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathcal{L}_{QP}=\mathbf{P}\cdot\dot{\mathbf{Q}}-K(\mathbf{Q},\mathbf{P},t)
  </annotation>
 </semantics>
</math>

 respectively, obtained by the Hamiltonian via ("inverse") <a href="Legendre_transformation" title="wikilink">Legendre transformation</a>, both must be stationary (so that one can use the <a href="Euler–Lagrange_equations" title="wikilink">Euler–Lagrange equations</a> to arrive at equations of the above-mentioned and designated form; as it is shown for example <a href="Hamilton_equations#Deriving_Hamilton's_equations" title="wikilink">here</a>):</p>

<p>

<math display="inline" id="Canonical_transformation:29">
 <semantics>
  <mrow>
   <mi>δ</mi>
   <mrow>
    <mstyle displaystyle="true">
     <msubsup>
      <mo largeop="true" symmetric="true">∫</mo>
      <msub>
       <mi>t</mi>
       <mn>1</mn>
      </msub>
      <msub>
       <mi>t</mi>
       <mn>2</mn>
      </msub>
     </msubsup>
    </mstyle>
    <mrow>
     <mrow>
      <mo>[</mo>
      <mrow>
       <mrow>
        <mi>𝐩</mi>
        <mo>⋅</mo>
        <mover accent="true">
         <mi>𝐪</mi>
         <mo>˙</mo>
        </mover>
       </mrow>
       <mo>-</mo>
       <mrow>
        <mi>H</mi>
        <mrow>
         <mo stretchy="false">(</mo>
         <mi>𝐪</mi>
         <mo>,</mo>
         <mi>𝐩</mi>
         <mo>,</mo>
         <mi>t</mi>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
      </mrow>
      <mo>]</mo>
     </mrow>
     <mi>d</mi>
     <mi>t</mi>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>δ</ci>
    <apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <int></int>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>t</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>t</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="latexml">delimited-[]</csymbol>
       <apply>
        <minus></minus>
        <apply>
         <ci>normal-⋅</ci>
         <ci>𝐩</ci>
         <apply>
          <ci>normal-˙</ci>
          <ci>𝐪</ci>
         </apply>
        </apply>
        <apply>
         <times></times>
         <ci>H</ci>
         <vector>
          <ci>𝐪</ci>
          <ci>𝐩</ci>
          <ci>t</ci>
         </vector>
        </apply>
       </apply>
      </apply>
      <ci>d</ci>
      <ci>t</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle\delta\int_{t_{1}}^{t_{2}}\left[\mathbf{p}\cdot\dot{\mathbf{q}}-H%
(\mathbf{q},\mathbf{p},t)\right]dt
  </annotation>
 </semantics>
</math>


</p>

<p>One way for both <a href="calculus_of_variations" title="wikilink">variational integral</a> equalities to be satisfied is to have</p>

<p>

<math display="block" id="Canonical_transformation:30">
 <semantics>
  <mrow>
   <mrow>
    <mi>λ</mi>
    <mrow>
     <mo>[</mo>
     <mrow>
      <mrow>
       <mi>𝐩</mi>
       <mo>⋅</mo>
       <mover accent="true">
        <mi>𝐪</mi>
        <mo>˙</mo>
       </mover>
      </mrow>
      <mo>-</mo>
      <mrow>
       <mi>H</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>𝐪</mi>
        <mo>,</mo>
        <mi>𝐩</mi>
        <mo>,</mo>
        <mi>t</mi>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
     </mrow>
     <mo>]</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mrow>
      <mi>𝐏</mi>
      <mo>⋅</mo>
      <mover accent="true">
       <mi>𝐐</mi>
       <mo>˙</mo>
      </mover>
     </mrow>
     <mo>-</mo>
     <mrow>
      <mi>K</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>𝐐</mi>
       <mo>,</mo>
       <mi>𝐏</mi>
       <mo>,</mo>
       <mi>t</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mrow>
    <mo>+</mo>
    <mfrac>
     <mrow>
      <mi>d</mi>
      <mi>G</mi>
     </mrow>
     <mrow>
      <mi>d</mi>
      <mi>t</mi>
     </mrow>
    </mfrac>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>λ</ci>
     <apply>
      <csymbol cd="latexml">delimited-[]</csymbol>
      <apply>
       <minus></minus>
       <apply>
        <ci>normal-⋅</ci>
        <ci>𝐩</ci>
        <apply>
         <ci>normal-˙</ci>
         <ci>𝐪</ci>
        </apply>
       </apply>
       <apply>
        <times></times>
        <ci>H</ci>
        <vector>
         <ci>𝐪</ci>
         <ci>𝐩</ci>
         <ci>t</ci>
        </vector>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <minus></minus>
      <apply>
       <ci>normal-⋅</ci>
       <ci>𝐏</ci>
       <apply>
        <ci>normal-˙</ci>
        <ci>𝐐</ci>
       </apply>
      </apply>
      <apply>
       <times></times>
       <ci>K</ci>
       <vector>
        <ci>𝐐</ci>
        <ci>𝐏</ci>
        <ci>t</ci>
       </vector>
      </apply>
     </apply>
     <apply>
      <divide></divide>
      <apply>
       <times></times>
       <ci>d</ci>
       <ci>G</ci>
      </apply>
      <apply>
       <times></times>
       <ci>d</ci>
       <ci>t</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \lambda\left[\mathbf{p}\cdot\dot{\mathbf{q}}-H(\mathbf{q},\mathbf{p},t)\right]%
=\mathbf{P}\cdot\dot{\mathbf{Q}}-K(\mathbf{Q},\mathbf{P},t)+\frac{dG}{dt}
  </annotation>
 </semantics>
</math>

</p>

<p>Lagrangians are not unique: one can always multiply by a constant 

<math display="inline" id="Canonical_transformation:31">
 <semantics>
  <mi>λ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>λ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   λ
  </annotation>
 </semantics>
</math>

 and add a total time derivative 

<math display="inline" id="Canonical_transformation:32">
 <semantics>
  <mfrac>
   <mrow>
    <mi>d</mi>
    <mi>G</mi>
   </mrow>
   <mrow>
    <mi>d</mi>
    <mi>t</mi>
   </mrow>
  </mfrac>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <divide></divide>
    <apply>
     <times></times>
     <ci>d</ci>
     <ci>G</ci>
    </apply>
    <apply>
     <times></times>
     <ci>d</ci>
     <ci>t</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \frac{dG}{dt}
  </annotation>
 </semantics>
</math>

 and yield the same equations of motion (see for reference: <a class="uri" href="http://en.wikibooks.org/wiki/Classical_Mechanics/Lagrange_Theory#Is_the_Lagrangian_unique.3F">http://en.wikibooks.org/wiki/Classical_Mechanics/Lagrange_Theory#Is_the_Lagrangian_unique.3F</a>).</p>

<p>In general, the scaling factor 

<math display="inline" id="Canonical_transformation:33">
 <semantics>
  <mi>λ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>λ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   λ
  </annotation>
 </semantics>
</math>

 is set equal to one; canonical transformations for which 

<math display="inline" id="Canonical_transformation:34">
 <semantics>
  <mrow>
   <mi>λ</mi>
   <mi mathvariant="normal">≠</mi>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>λ</ci>
    <ci>normal-≠</ci>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   λ≠1
  </annotation>
 </semantics>
</math>

 are called <strong>extended canonical transformations</strong>. 

<math display="inline" id="Canonical_transformation:35">
 <semantics>
  <mfrac>
   <mrow>
    <mi>d</mi>
    <mi>G</mi>
   </mrow>
   <mrow>
    <mi>d</mi>
    <mi>t</mi>
   </mrow>
  </mfrac>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <divide></divide>
    <apply>
     <times></times>
     <ci>d</ci>
     <ci>G</ci>
    </apply>
    <apply>
     <times></times>
     <ci>d</ci>
     <ci>t</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \frac{dG}{dt}
  </annotation>
 </semantics>
</math>

 is kept, otherwise the problem would be rendered trivial and there would be not much freedom for the new canonical variables to differ from the old ones.</p>

<p>Here 

<math display="inline" id="Canonical_transformation:36">
 <semantics>
  <mi>G</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>G</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   G
  </annotation>
 </semantics>
</math>

 is a <a href="generating_function_(physics)" title="wikilink">generating function</a> of one old <a href="canonical_coordinates" title="wikilink">canonical coordinate</a> (

<math display="inline" id="Canonical_transformation:37">
 <semantics>
  <mi>𝐪</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>𝐪</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{q}
  </annotation>
 </semantics>
</math>

 or 

<math display="inline" id="Canonical_transformation:38">
 <semantics>
  <mi>𝐩</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>𝐩</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{p}
  </annotation>
 </semantics>
</math>

), one new <a href="canonical_coordinates" title="wikilink">canonical coordinate</a> (

<math display="inline" id="Canonical_transformation:39">
 <semantics>
  <mi>𝐐</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>𝐐</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{Q}
  </annotation>
 </semantics>
</math>

 or 

<math display="inline" id="Canonical_transformation:40">
 <semantics>
  <mi>𝐏</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>𝐏</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{P}
  </annotation>
 </semantics>
</math>

) and (possibly) the time 

<math display="inline" id="Canonical_transformation:41">
 <semantics>
  <mi>t</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>t</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   t
  </annotation>
 </semantics>
</math>

. Thus, there are four basic types of generating functions (although it should be noted that mixtures of these four types can exist), depending on the choice of variables. As will be shown below, the generating function will define a transformation from old to new <a href="canonical_coordinates" title="wikilink">canonical coordinates</a>, and any such transformation 

<math display="inline" id="Canonical_transformation:42">
 <semantics>
  <mrow>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>𝐪</mi>
    <mo>,</mo>
    <mi>𝐩</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mi mathvariant="normal">→</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>𝐐</mi>
    <mo>,</mo>
    <mi>𝐏</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <interval closure="open">
     <ci>𝐪</ci>
     <ci>𝐩</ci>
    </interval>
    <ci>normal-→</ci>
    <interval closure="open">
     <ci>𝐐</ci>
     <ci>𝐏</ci>
    </interval>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (\mathbf{q},\mathbf{p})→(\mathbf{Q},\mathbf{P})
  </annotation>
 </semantics>
</math>

 is guaranteed to be canonical.</p>
<h3 id="type-1-generating-function">Type 1 generating function</h3>

<p>The type 1 generating function <mtpl></mtpl> depends only on the old and new generalized coordinates</p>

<p>

<math display="block" id="Canonical_transformation:43">
 <semantics>
  <mrow>
   <mi>G</mi>
   <mo>≡</mo>
   <mrow>
    <msub>
     <mi>G</mi>
     <mn>1</mn>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>𝐪</mi>
     <mo>,</mo>
     <mi>𝐐</mi>
     <mo>,</mo>
     <mi>t</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <equivalent></equivalent>
    <ci>G</ci>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>G</ci>
      <cn type="integer">1</cn>
     </apply>
     <vector>
      <ci>𝐪</ci>
      <ci>𝐐</ci>
      <ci>t</ci>
     </vector>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   G\equiv G_{1}(\mathbf{q},\mathbf{Q},t)
  </annotation>
 </semantics>
</math>

 To derive the implicit transformation, we expand the defining equation above</p>

<p>

<math display="block" id="Canonical_transformation:44">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>𝐩</mi>
     <mo>⋅</mo>
     <mover accent="true">
      <mi>𝐪</mi>
      <mo>˙</mo>
     </mover>
    </mrow>
    <mo>-</mo>
    <mrow>
     <mi>H</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>𝐪</mi>
      <mo>,</mo>
      <mi>𝐩</mi>
      <mo>,</mo>
      <mi>t</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mrow>
      <mi>𝐏</mi>
      <mo>⋅</mo>
      <mover accent="true">
       <mi>𝐐</mi>
       <mo>˙</mo>
      </mover>
     </mrow>
     <mo>-</mo>
     <mrow>
      <mi>K</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>𝐐</mi>
       <mo>,</mo>
       <mi>𝐏</mi>
       <mo>,</mo>
       <mi>t</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mrow>
    <mo>+</mo>
    <mfrac>
     <mrow>
      <mo>∂</mo>
      <msub>
       <mi>G</mi>
       <mn>1</mn>
      </msub>
     </mrow>
     <mrow>
      <mo>∂</mo>
      <mi>t</mi>
     </mrow>
    </mfrac>
    <mo>+</mo>
    <mrow>
     <mfrac>
      <mrow>
       <mo>∂</mo>
       <msub>
        <mi>G</mi>
        <mn>1</mn>
       </msub>
      </mrow>
      <mrow>
       <mo>∂</mo>
       <mi>𝐪</mi>
      </mrow>
     </mfrac>
     <mo>⋅</mo>
     <mover accent="true">
      <mi>𝐪</mi>
      <mo>˙</mo>
     </mover>
    </mrow>
    <mo>+</mo>
    <mrow>
     <mfrac>
      <mrow>
       <mo>∂</mo>
       <msub>
        <mi>G</mi>
        <mn>1</mn>
       </msub>
      </mrow>
      <mrow>
       <mo>∂</mo>
       <mi>𝐐</mi>
      </mrow>
     </mfrac>
     <mo>⋅</mo>
     <mover accent="true">
      <mi>𝐐</mi>
      <mo>˙</mo>
     </mover>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <minus></minus>
     <apply>
      <ci>normal-⋅</ci>
      <ci>𝐩</ci>
      <apply>
       <ci>normal-˙</ci>
       <ci>𝐪</ci>
      </apply>
     </apply>
     <apply>
      <times></times>
      <ci>H</ci>
      <vector>
       <ci>𝐪</ci>
       <ci>𝐩</ci>
       <ci>t</ci>
      </vector>
     </apply>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <minus></minus>
      <apply>
       <ci>normal-⋅</ci>
       <ci>𝐏</ci>
       <apply>
        <ci>normal-˙</ci>
        <ci>𝐐</ci>
       </apply>
      </apply>
      <apply>
       <times></times>
       <ci>K</ci>
       <vector>
        <ci>𝐐</ci>
        <ci>𝐏</ci>
        <ci>t</ci>
       </vector>
      </apply>
     </apply>
     <apply>
      <divide></divide>
      <apply>
       <partialdiff></partialdiff>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>G</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <apply>
       <partialdiff></partialdiff>
       <ci>t</ci>
      </apply>
     </apply>
     <apply>
      <ci>normal-⋅</ci>
      <apply>
       <divide></divide>
       <apply>
        <partialdiff></partialdiff>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>G</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <apply>
        <partialdiff></partialdiff>
        <ci>𝐪</ci>
       </apply>
      </apply>
      <apply>
       <ci>normal-˙</ci>
       <ci>𝐪</ci>
      </apply>
     </apply>
     <apply>
      <ci>normal-⋅</ci>
      <apply>
       <divide></divide>
       <apply>
        <partialdiff></partialdiff>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>G</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <apply>
        <partialdiff></partialdiff>
        <ci>𝐐</ci>
       </apply>
      </apply>
      <apply>
       <ci>normal-˙</ci>
       <ci>𝐐</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{p}\cdot\dot{\mathbf{q}}-H(\mathbf{q},\mathbf{p},t)=\mathbf{P}\cdot\dot%
{\mathbf{Q}}-K(\mathbf{Q},\mathbf{P},t)+\frac{\partial G_{1}}{\partial t}+%
\frac{\partial G_{1}}{\partial\mathbf{q}}\cdot\dot{\mathbf{q}}+\frac{\partial G%
_{1}}{\partial\mathbf{Q}}\cdot\dot{\mathbf{Q}}
  </annotation>
 </semantics>
</math>

</p>

<p>Since the new and old coordinates are each independent, the following 

<math display="inline" id="Canonical_transformation:45">
 <semantics>
  <mrow>
   <mrow>
    <mn>2</mn>
    <mi>N</mi>
   </mrow>
   <mo>+</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <plus></plus>
    <apply>
     <times></times>
     <cn type="integer">2</cn>
     <ci>N</ci>
    </apply>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   2N+1
  </annotation>
 </semantics>
</math>

 equations must hold</p>

<p>

<math display="inline" id="Canonical_transformation:46">
 <semantics>
  <mi>𝐩</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>𝐩</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle\mathbf{p}
  </annotation>
 </semantics>
</math>


</p>

<p>These equations define the transformation 

<math display="inline" id="Canonical_transformation:47">
 <semantics>
  <mrow>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>𝐪</mi>
    <mo>,</mo>
    <mi>𝐩</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mi mathvariant="normal">→</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>𝐐</mi>
    <mo>,</mo>
    <mi>𝐏</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <interval closure="open">
     <ci>𝐪</ci>
     <ci>𝐩</ci>
    </interval>
    <ci>normal-→</ci>
    <interval closure="open">
     <ci>𝐐</ci>
     <ci>𝐏</ci>
    </interval>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (\mathbf{q},\mathbf{p})→(\mathbf{Q},\mathbf{P})
  </annotation>
 </semantics>
</math>

 as follows. The <em>first</em> set of 

<math display="inline" id="Canonical_transformation:48">
 <semantics>
  <mi>N</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>N</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   N
  </annotation>
 </semantics>
</math>

 equations</p>

<p>

<math display="block" id="Canonical_transformation:49">
 <semantics>
  <mrow>
   <mi>𝐩</mi>
   <mo>=</mo>
   <mfrac>
    <mrow>
     <mo>∂</mo>
     <msub>
      <mi>G</mi>
      <mn>1</mn>
     </msub>
    </mrow>
    <mrow>
     <mo>∂</mo>
     <mi>𝐪</mi>
    </mrow>
   </mfrac>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>𝐩</ci>
    <apply>
     <divide></divide>
     <apply>
      <partialdiff></partialdiff>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>G</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <apply>
      <partialdiff></partialdiff>
      <ci>𝐪</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{p}=\frac{\partial G_{1}}{\partial\mathbf{q}}
  </annotation>
 </semantics>
</math>

</p>

<p>define relations between the new <a href="generalized_coordinates" title="wikilink">generalized coordinates</a> 

<math display="inline" id="Canonical_transformation:50">
 <semantics>
  <mi>𝐐</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>𝐐</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{Q}
  </annotation>
 </semantics>
</math>

 and the old <a href="canonical_coordinates" title="wikilink">canonical coordinates</a> 

<math display="inline" id="Canonical_transformation:51">
 <semantics>
  <mrow>
   <mo stretchy="false">(</mo>
   <mi>𝐪</mi>
   <mo>,</mo>
   <mi>𝐩</mi>
   <mo stretchy="false">)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <interval closure="open">
    <ci>𝐪</ci>
    <ci>𝐩</ci>
   </interval>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (\mathbf{q},\mathbf{p})
  </annotation>
 </semantics>
</math>

. Ideally, one can invert these relations to obtain formulae for each <mtpl></mtpl> as a function of the old canonical coordinates. Substitution of these formulae for the 

<math display="inline" id="Canonical_transformation:52">
 <semantics>
  <mi>𝐐</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>𝐐</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{Q}
  </annotation>
 </semantics>
</math>

 coordinates into the <em>second</em> set of 

<math display="inline" id="Canonical_transformation:53">
 <semantics>
  <mi>N</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>N</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   N
  </annotation>
 </semantics>
</math>

 equations</p>

<p>

<math display="block" id="Canonical_transformation:54">
 <semantics>
  <mrow>
   <mi>𝐏</mi>
   <mo>=</mo>
   <mrow>
    <mo>-</mo>
    <mfrac>
     <mrow>
      <mo>∂</mo>
      <msub>
       <mi>G</mi>
       <mn>1</mn>
      </msub>
     </mrow>
     <mrow>
      <mo>∂</mo>
      <mi>𝐐</mi>
     </mrow>
    </mfrac>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>𝐏</ci>
    <apply>
     <minus></minus>
     <apply>
      <divide></divide>
      <apply>
       <partialdiff></partialdiff>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>G</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <apply>
       <partialdiff></partialdiff>
       <ci>𝐐</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{P}=-\frac{\partial G_{1}}{\partial\mathbf{Q}}
  </annotation>
 </semantics>
</math>

</p>

<p>yields analogous formulae for the new generalized momenta 

<math display="inline" id="Canonical_transformation:55">
 <semantics>
  <mi>𝐏</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>𝐏</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{P}
  </annotation>
 </semantics>
</math>

 in terms of the old <a href="canonical_coordinates" title="wikilink">canonical coordinates</a> 

<math display="inline" id="Canonical_transformation:56">
 <semantics>
  <mrow>
   <mo stretchy="false">(</mo>
   <mi>𝐪</mi>
   <mo>,</mo>
   <mi>𝐩</mi>
   <mo stretchy="false">)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <interval closure="open">
    <ci>𝐪</ci>
    <ci>𝐩</ci>
   </interval>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (\mathbf{q},\mathbf{p})
  </annotation>
 </semantics>
</math>

. We then invert both sets of formulae to obtain the <em>old</em> <a href="canonical_coordinates" title="wikilink">canonical coordinates</a> 

<math display="inline" id="Canonical_transformation:57">
 <semantics>
  <mrow>
   <mo stretchy="false">(</mo>
   <mi>𝐪</mi>
   <mo>,</mo>
   <mi>𝐩</mi>
   <mo stretchy="false">)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <interval closure="open">
    <ci>𝐪</ci>
    <ci>𝐩</ci>
   </interval>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (\mathbf{q},\mathbf{p})
  </annotation>
 </semantics>
</math>

 as functions of the <em>new</em> <a href="canonical_coordinates" title="wikilink">canonical coordinates</a> 

<math display="inline" id="Canonical_transformation:58">
 <semantics>
  <mrow>
   <mo stretchy="false">(</mo>
   <mi>𝐐</mi>
   <mo>,</mo>
   <mi>𝐏</mi>
   <mo stretchy="false">)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <interval closure="open">
    <ci>𝐐</ci>
    <ci>𝐏</ci>
   </interval>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (\mathbf{Q},\mathbf{P})
  </annotation>
 </semantics>
</math>

. Substitution of the inverted formulae into the final equation</p>

<p>

<math display="block" id="Canonical_transformation:59">
 <semantics>
  <mrow>
   <mi>K</mi>
   <mo>=</mo>
   <mrow>
    <mi>H</mi>
    <mo>+</mo>
    <mfrac>
     <mrow>
      <mo>∂</mo>
      <msub>
       <mi>G</mi>
       <mn>1</mn>
      </msub>
     </mrow>
     <mrow>
      <mo>∂</mo>
      <mi>t</mi>
     </mrow>
    </mfrac>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>K</ci>
    <apply>
     <plus></plus>
     <ci>H</ci>
     <apply>
      <divide></divide>
      <apply>
       <partialdiff></partialdiff>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>G</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <apply>
       <partialdiff></partialdiff>
       <ci>t</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   K=H+\frac{\partial G_{1}}{\partial t}
  </annotation>
 </semantics>
</math>

 yields a formula for 

<math display="inline" id="Canonical_transformation:60">
 <semantics>
  <mi>K</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>K</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   K
  </annotation>
 </semantics>
</math>

 as a function of the new <a href="canonical_coordinates" title="wikilink">canonical coordinates</a> 

<math display="inline" id="Canonical_transformation:61">
 <semantics>
  <mrow>
   <mo stretchy="false">(</mo>
   <mi>𝐐</mi>
   <mo>,</mo>
   <mi>𝐏</mi>
   <mo stretchy="false">)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <interval closure="open">
    <ci>𝐐</ci>
    <ci>𝐏</ci>
   </interval>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (\mathbf{Q},\mathbf{P})
  </annotation>
 </semantics>
</math>

.</p>

<p>In practice, this procedure is easier than it sounds, because the generating function is usually simple. For example, let</p>

<p>

<math display="block" id="Canonical_transformation:62">
 <semantics>
  <mrow>
   <msub>
    <mi>G</mi>
    <mn>1</mn>
   </msub>
   <mo>≡</mo>
   <mrow>
    <mi>𝐪</mi>
    <mo>⋅</mo>
    <mi>𝐐</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <equivalent></equivalent>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>G</ci>
     <cn type="integer">1</cn>
    </apply>
    <apply>
     <ci>normal-⋅</ci>
     <ci>𝐪</ci>
     <ci>𝐐</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   G_{1}\equiv\mathbf{q}\cdot\mathbf{Q}
  </annotation>
 </semantics>
</math>

 This results in swapping the generalized coordinates for the momenta and vice versa</p>

<p>

<math display="inline" id="Canonical_transformation:63">
 <semantics>
  <mi>𝐩</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>𝐩</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle\mathbf{p}
  </annotation>
 </semantics>
</math>


 and 

<math display="inline" id="Canonical_transformation:64">
 <semantics>
  <mrow>
   <mi>K</mi>
   <mo>=</mo>
   <mi>H</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>K</ci>
    <ci>H</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   K=H
  </annotation>
 </semantics>
</math>

. This example illustrates how independent the coordinates and momenta are in the Hamiltonian formulation; they are equivalent variables.</p>
<h3 id="type-2-generating-function">Type 2 generating function</h3>

<p>The type 2 generating function <mtpl></mtpl> depends only on the old <a href="generalized_coordinates" title="wikilink">generalized coordinates</a> and the new generalized momenta</p>

<p>

<math display="block" id="Canonical_transformation:65">
 <semantics>
  <mrow>
   <mi>G</mi>
   <mo>≡</mo>
   <mrow>
    <mrow>
     <mo>-</mo>
     <mrow>
      <mi>𝐐</mi>
      <mo>⋅</mo>
      <mi>𝐏</mi>
     </mrow>
    </mrow>
    <mo>+</mo>
    <mrow>
     <msub>
      <mi>G</mi>
      <mn>2</mn>
     </msub>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>𝐪</mi>
      <mo>,</mo>
      <mi>𝐏</mi>
      <mo>,</mo>
      <mi>t</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <equivalent></equivalent>
    <ci>G</ci>
    <apply>
     <plus></plus>
     <apply>
      <minus></minus>
      <apply>
       <ci>normal-⋅</ci>
       <ci>𝐐</ci>
       <ci>𝐏</ci>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>G</ci>
       <cn type="integer">2</cn>
      </apply>
      <vector>
       <ci>𝐪</ci>
       <ci>𝐏</ci>
       <ci>t</ci>
      </vector>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   G\equiv-\mathbf{Q}\cdot\mathbf{P}+G_{2}(\mathbf{q},\mathbf{P},t)
  </annotation>
 </semantics>
</math>

 where the 

<math display="inline" id="Canonical_transformation:66">
 <semantics>
  <mrow>
   <mo>-</mo>
   <mrow>
    <mi>𝐐</mi>
    <mo>⋅</mo>
    <mi>𝐏</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <minus></minus>
    <apply>
     <ci>normal-⋅</ci>
     <ci>𝐐</ci>
     <ci>𝐏</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   -\mathbf{Q}\cdot\mathbf{P}
  </annotation>
 </semantics>
</math>

 terms represent a <a href="Legendre_transformation" title="wikilink">Legendre transformation</a> to change the right-hand side of the equation below. To derive the implicit transformation, we expand the defining equation above</p>

<p>

<math display="block" id="Canonical_transformation:67">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>𝐩</mi>
     <mo>⋅</mo>
     <mover accent="true">
      <mi>𝐪</mi>
      <mo>˙</mo>
     </mover>
    </mrow>
    <mo>-</mo>
    <mrow>
     <mi>H</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>𝐪</mi>
      <mo>,</mo>
      <mi>𝐩</mi>
      <mo>,</mo>
      <mi>t</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mrow>
      <mo>-</mo>
      <mrow>
       <mi>𝐐</mi>
       <mo>⋅</mo>
       <mover accent="true">
        <mi>𝐏</mi>
        <mo>˙</mo>
       </mover>
      </mrow>
     </mrow>
     <mo>-</mo>
     <mrow>
      <mi>K</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>𝐐</mi>
       <mo>,</mo>
       <mi>𝐏</mi>
       <mo>,</mo>
       <mi>t</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mrow>
    <mo>+</mo>
    <mfrac>
     <mrow>
      <mo>∂</mo>
      <msub>
       <mi>G</mi>
       <mn>2</mn>
      </msub>
     </mrow>
     <mrow>
      <mo>∂</mo>
      <mi>t</mi>
     </mrow>
    </mfrac>
    <mo>+</mo>
    <mrow>
     <mfrac>
      <mrow>
       <mo>∂</mo>
       <msub>
        <mi>G</mi>
        <mn>2</mn>
       </msub>
      </mrow>
      <mrow>
       <mo>∂</mo>
       <mi>𝐪</mi>
      </mrow>
     </mfrac>
     <mo>⋅</mo>
     <mover accent="true">
      <mi>𝐪</mi>
      <mo>˙</mo>
     </mover>
    </mrow>
    <mo>+</mo>
    <mrow>
     <mfrac>
      <mrow>
       <mo>∂</mo>
       <msub>
        <mi>G</mi>
        <mn>2</mn>
       </msub>
      </mrow>
      <mrow>
       <mo>∂</mo>
       <mi>𝐏</mi>
      </mrow>
     </mfrac>
     <mo>⋅</mo>
     <mover accent="true">
      <mi>𝐏</mi>
      <mo>˙</mo>
     </mover>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <minus></minus>
     <apply>
      <ci>normal-⋅</ci>
      <ci>𝐩</ci>
      <apply>
       <ci>normal-˙</ci>
       <ci>𝐪</ci>
      </apply>
     </apply>
     <apply>
      <times></times>
      <ci>H</ci>
      <vector>
       <ci>𝐪</ci>
       <ci>𝐩</ci>
       <ci>t</ci>
      </vector>
     </apply>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <minus></minus>
      <apply>
       <minus></minus>
       <apply>
        <ci>normal-⋅</ci>
        <ci>𝐐</ci>
        <apply>
         <ci>normal-˙</ci>
         <ci>𝐏</ci>
        </apply>
       </apply>
      </apply>
      <apply>
       <times></times>
       <ci>K</ci>
       <vector>
        <ci>𝐐</ci>
        <ci>𝐏</ci>
        <ci>t</ci>
       </vector>
      </apply>
     </apply>
     <apply>
      <divide></divide>
      <apply>
       <partialdiff></partialdiff>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>G</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
      <apply>
       <partialdiff></partialdiff>
       <ci>t</ci>
      </apply>
     </apply>
     <apply>
      <ci>normal-⋅</ci>
      <apply>
       <divide></divide>
       <apply>
        <partialdiff></partialdiff>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>G</ci>
         <cn type="integer">2</cn>
        </apply>
       </apply>
       <apply>
        <partialdiff></partialdiff>
        <ci>𝐪</ci>
       </apply>
      </apply>
      <apply>
       <ci>normal-˙</ci>
       <ci>𝐪</ci>
      </apply>
     </apply>
     <apply>
      <ci>normal-⋅</ci>
      <apply>
       <divide></divide>
       <apply>
        <partialdiff></partialdiff>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>G</ci>
         <cn type="integer">2</cn>
        </apply>
       </apply>
       <apply>
        <partialdiff></partialdiff>
        <ci>𝐏</ci>
       </apply>
      </apply>
      <apply>
       <ci>normal-˙</ci>
       <ci>𝐏</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{p}\cdot\dot{\mathbf{q}}-H(\mathbf{q},\mathbf{p},t)=-\mathbf{Q}\cdot%
\dot{\mathbf{P}}-K(\mathbf{Q},\mathbf{P},t)+\frac{\partial G_{2}}{\partial t}+%
\frac{\partial G_{2}}{\partial\mathbf{q}}\cdot\dot{\mathbf{q}}+\frac{\partial G%
_{2}}{\partial\mathbf{P}}\cdot\dot{\mathbf{P}}
  </annotation>
 </semantics>
</math>

</p>

<p>Since the old coordinates and new momenta are each independent, the following 

<math display="inline" id="Canonical_transformation:68">
 <semantics>
  <mrow>
   <mrow>
    <mn>2</mn>
    <mi>N</mi>
   </mrow>
   <mo>+</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <plus></plus>
    <apply>
     <times></times>
     <cn type="integer">2</cn>
     <ci>N</ci>
    </apply>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   2N+1
  </annotation>
 </semantics>
</math>

 equations must hold</p>

<p>

<math display="inline" id="Canonical_transformation:69">
 <semantics>
  <mi>𝐩</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>𝐩</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle\mathbf{p}
  </annotation>
 </semantics>
</math>


</p>

<p>These equations define the transformation 

<math display="inline" id="Canonical_transformation:70">
 <semantics>
  <mrow>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>𝐪</mi>
    <mo>,</mo>
    <mi>𝐩</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mi mathvariant="normal">→</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>𝐐</mi>
    <mo>,</mo>
    <mi>𝐏</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <interval closure="open">
     <ci>𝐪</ci>
     <ci>𝐩</ci>
    </interval>
    <ci>normal-→</ci>
    <interval closure="open">
     <ci>𝐐</ci>
     <ci>𝐏</ci>
    </interval>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (\mathbf{q},\mathbf{p})→(\mathbf{Q},\mathbf{P})
  </annotation>
 </semantics>
</math>

 as follows. The <em>first</em> set of 

<math display="inline" id="Canonical_transformation:71">
 <semantics>
  <mi>N</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>N</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   N
  </annotation>
 </semantics>
</math>

 equations</p>

<p>

<math display="block" id="Canonical_transformation:72">
 <semantics>
  <mrow>
   <mi>𝐩</mi>
   <mo>=</mo>
   <mfrac>
    <mrow>
     <mo>∂</mo>
     <msub>
      <mi>G</mi>
      <mn>2</mn>
     </msub>
    </mrow>
    <mrow>
     <mo>∂</mo>
     <mi>𝐪</mi>
    </mrow>
   </mfrac>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>𝐩</ci>
    <apply>
     <divide></divide>
     <apply>
      <partialdiff></partialdiff>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>G</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
     <apply>
      <partialdiff></partialdiff>
      <ci>𝐪</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{p}=\frac{\partial G_{2}}{\partial\mathbf{q}}
  </annotation>
 </semantics>
</math>

</p>

<p>define relations between the new generalized momenta 

<math display="inline" id="Canonical_transformation:73">
 <semantics>
  <mi>𝐏</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>𝐏</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{P}
  </annotation>
 </semantics>
</math>

 and the old <a href="canonical_coordinates" title="wikilink">canonical coordinates</a> 

<math display="inline" id="Canonical_transformation:74">
 <semantics>
  <mrow>
   <mo stretchy="false">(</mo>
   <mi>𝐪</mi>
   <mo>,</mo>
   <mi>𝐩</mi>
   <mo stretchy="false">)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <interval closure="open">
    <ci>𝐪</ci>
    <ci>𝐩</ci>
   </interval>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (\mathbf{q},\mathbf{p})
  </annotation>
 </semantics>
</math>

. Ideally, one can invert these relations to obtain formulae for each <mtpl></mtpl> as a function of the old canonical coordinates. Substitution of these formulae for the 

<math display="inline" id="Canonical_transformation:75">
 <semantics>
  <mi>𝐏</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>𝐏</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{P}
  </annotation>
 </semantics>
</math>

 coordinates into the <em>second</em> set of 

<math display="inline" id="Canonical_transformation:76">
 <semantics>
  <mi>N</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>N</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   N
  </annotation>
 </semantics>
</math>

 equations</p>

<p>

<math display="block" id="Canonical_transformation:77">
 <semantics>
  <mrow>
   <mi>𝐐</mi>
   <mo>=</mo>
   <mfrac>
    <mrow>
     <mo>∂</mo>
     <msub>
      <mi>G</mi>
      <mn>2</mn>
     </msub>
    </mrow>
    <mrow>
     <mo>∂</mo>
     <mi>𝐏</mi>
    </mrow>
   </mfrac>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>𝐐</ci>
    <apply>
     <divide></divide>
     <apply>
      <partialdiff></partialdiff>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>G</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
     <apply>
      <partialdiff></partialdiff>
      <ci>𝐏</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{Q}=\frac{\partial G_{2}}{\partial\mathbf{P}}
  </annotation>
 </semantics>
</math>

</p>

<p>yields analogous formulae for the new generalized coordinates 

<math display="inline" id="Canonical_transformation:78">
 <semantics>
  <mi>𝐐</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>𝐐</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{Q}
  </annotation>
 </semantics>
</math>

 in terms of the old <a href="canonical_coordinates" title="wikilink">canonical coordinates</a> 

<math display="inline" id="Canonical_transformation:79">
 <semantics>
  <mrow>
   <mo stretchy="false">(</mo>
   <mi>𝐪</mi>
   <mo>,</mo>
   <mi>𝐩</mi>
   <mo stretchy="false">)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <interval closure="open">
    <ci>𝐪</ci>
    <ci>𝐩</ci>
   </interval>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (\mathbf{q},\mathbf{p})
  </annotation>
 </semantics>
</math>

. We then invert both sets of formulae to obtain the <em>old</em> <a href="canonical_coordinates" title="wikilink">canonical coordinates</a> 

<math display="inline" id="Canonical_transformation:80">
 <semantics>
  <mrow>
   <mo stretchy="false">(</mo>
   <mi>𝐪</mi>
   <mo>,</mo>
   <mi>𝐩</mi>
   <mo stretchy="false">)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <interval closure="open">
    <ci>𝐪</ci>
    <ci>𝐩</ci>
   </interval>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (\mathbf{q},\mathbf{p})
  </annotation>
 </semantics>
</math>

 as functions of the <em>new</em> <a href="canonical_coordinates" title="wikilink">canonical coordinates</a> 

<math display="inline" id="Canonical_transformation:81">
 <semantics>
  <mrow>
   <mo stretchy="false">(</mo>
   <mi>𝐐</mi>
   <mo>,</mo>
   <mi>𝐏</mi>
   <mo stretchy="false">)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <interval closure="open">
    <ci>𝐐</ci>
    <ci>𝐏</ci>
   </interval>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (\mathbf{Q},\mathbf{P})
  </annotation>
 </semantics>
</math>

. Substitution of the inverted formulae into the final equation</p>

<p>

<math display="block" id="Canonical_transformation:82">
 <semantics>
  <mrow>
   <mi>K</mi>
   <mo>=</mo>
   <mrow>
    <mi>H</mi>
    <mo>+</mo>
    <mfrac>
     <mrow>
      <mo>∂</mo>
      <msub>
       <mi>G</mi>
       <mn>2</mn>
      </msub>
     </mrow>
     <mrow>
      <mo>∂</mo>
      <mi>t</mi>
     </mrow>
    </mfrac>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>K</ci>
    <apply>
     <plus></plus>
     <ci>H</ci>
     <apply>
      <divide></divide>
      <apply>
       <partialdiff></partialdiff>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>G</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
      <apply>
       <partialdiff></partialdiff>
       <ci>t</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   K=H+\frac{\partial G_{2}}{\partial t}
  </annotation>
 </semantics>
</math>

 yields a formula for 

<math display="inline" id="Canonical_transformation:83">
 <semantics>
  <mi>K</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>K</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   K
  </annotation>
 </semantics>
</math>

 as a function of the new <a href="canonical_coordinates" title="wikilink">canonical coordinates</a> 

<math display="inline" id="Canonical_transformation:84">
 <semantics>
  <mrow>
   <mo stretchy="false">(</mo>
   <mi>𝐐</mi>
   <mo>,</mo>
   <mi>𝐏</mi>
   <mo stretchy="false">)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <interval closure="open">
    <ci>𝐐</ci>
    <ci>𝐏</ci>
   </interval>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (\mathbf{Q},\mathbf{P})
  </annotation>
 </semantics>
</math>

.</p>

<p>In practice, this procedure is easier than it sounds, because the generating function is usually simple. For example, let</p>

<p>

<math display="block" id="Canonical_transformation:85">
 <semantics>
  <mrow>
   <msub>
    <mi>G</mi>
    <mn>2</mn>
   </msub>
   <mo>≡</mo>
   <mrow>
    <mrow>
     <mi>𝐠</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>𝐪</mi>
      <mo>;</mo>
      <mi>t</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>⋅</mo>
    <mi>𝐏</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <equivalent></equivalent>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>G</ci>
     <cn type="integer">2</cn>
    </apply>
    <apply>
     <ci>normal-⋅</ci>
     <apply>
      <times></times>
      <ci>𝐠</ci>
      <list>
       <ci>𝐪</ci>
       <ci>t</ci>
      </list>
     </apply>
     <ci>𝐏</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   G_{2}\equiv\mathbf{g}(\mathbf{q};t)\cdot\mathbf{P}
  </annotation>
 </semantics>
</math>

 where 

<math display="inline" id="Canonical_transformation:86">
 <semantics>
  <mi>𝐠</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>𝐠</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{g}
  </annotation>
 </semantics>
</math>

 is a set of 

<math display="inline" id="Canonical_transformation:87">
 <semantics>
  <mi>N</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>N</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   N
  </annotation>
 </semantics>
</math>

 functions. This results in a point transformation of the generalized coordinates</p>

<p>

<math display="block" id="Canonical_transformation:88">
 <semantics>
  <mrow>
   <mi>𝐐</mi>
   <mo>=</mo>
   <mfrac>
    <mrow>
     <mo>∂</mo>
     <msub>
      <mi>G</mi>
      <mn>2</mn>
     </msub>
    </mrow>
    <mrow>
     <mo>∂</mo>
     <mi>𝐏</mi>
    </mrow>
   </mfrac>
   <mo>=</mo>
   <mrow>
    <mi>𝐠</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>𝐪</mi>
     <mo>;</mo>
     <mi>t</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <ci>𝐐</ci>
     <apply>
      <divide></divide>
      <apply>
       <partialdiff></partialdiff>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>G</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
      <apply>
       <partialdiff></partialdiff>
       <ci>𝐏</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <ci>𝐠</ci>
      <list>
       <ci>𝐪</ci>
       <ci>t</ci>
      </list>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{Q}=\frac{\partial G_{2}}{\partial\mathbf{P}}=\mathbf{g}(\mathbf{q};t)
  </annotation>
 </semantics>
</math>

</p>
<h3 id="type-3-generating-function">Type 3 generating function</h3>

<p>The type 3 generating function <mtpl></mtpl> depends only on the old generalized momenta and the new generalized coordinates</p>

<p>

<math display="block" id="Canonical_transformation:89">
 <semantics>
  <mrow>
   <mi>G</mi>
   <mo>≡</mo>
   <mrow>
    <mrow>
     <mi>𝐪</mi>
     <mo>⋅</mo>
     <mi>𝐩</mi>
    </mrow>
    <mo>+</mo>
    <mrow>
     <msub>
      <mi>G</mi>
      <mn>3</mn>
     </msub>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>𝐩</mi>
      <mo>,</mo>
      <mi>𝐐</mi>
      <mo>,</mo>
      <mi>t</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <equivalent></equivalent>
    <ci>G</ci>
    <apply>
     <plus></plus>
     <apply>
      <ci>normal-⋅</ci>
      <ci>𝐪</ci>
      <ci>𝐩</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>G</ci>
       <cn type="integer">3</cn>
      </apply>
      <vector>
       <ci>𝐩</ci>
       <ci>𝐐</ci>
       <ci>t</ci>
      </vector>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   G\equiv\mathbf{q}\cdot\mathbf{p}+G_{3}(\mathbf{p},\mathbf{Q},t)
  </annotation>
 </semantics>
</math>

 where the 

<math display="inline" id="Canonical_transformation:90">
 <semantics>
  <mrow>
   <mi>𝐪</mi>
   <mo>⋅</mo>
   <mi>𝐩</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-⋅</ci>
    <ci>𝐪</ci>
    <ci>𝐩</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{q}\cdot\mathbf{p}
  </annotation>
 </semantics>
</math>

 terms represent a <a href="Legendre_transformation" title="wikilink">Legendre transformation</a> to change the left-hand side of the equation below. To derive the implicit transformation, we expand the defining equation above</p>

<p>

<math display="block" id="Canonical_transformation:91">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mo>-</mo>
     <mrow>
      <mi>𝐪</mi>
      <mo>⋅</mo>
      <mover accent="true">
       <mi>𝐩</mi>
       <mo>˙</mo>
      </mover>
     </mrow>
    </mrow>
    <mo>-</mo>
    <mrow>
     <mi>H</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>𝐪</mi>
      <mo>,</mo>
      <mi>𝐩</mi>
      <mo>,</mo>
      <mi>t</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mrow>
      <mi>𝐏</mi>
      <mo>⋅</mo>
      <mover accent="true">
       <mi>𝐐</mi>
       <mo>˙</mo>
      </mover>
     </mrow>
     <mo>-</mo>
     <mrow>
      <mi>K</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>𝐐</mi>
       <mo>,</mo>
       <mi>𝐏</mi>
       <mo>,</mo>
       <mi>t</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mrow>
    <mo>+</mo>
    <mfrac>
     <mrow>
      <mo>∂</mo>
      <msub>
       <mi>G</mi>
       <mn>3</mn>
      </msub>
     </mrow>
     <mrow>
      <mo>∂</mo>
      <mi>t</mi>
     </mrow>
    </mfrac>
    <mo>+</mo>
    <mrow>
     <mfrac>
      <mrow>
       <mo>∂</mo>
       <msub>
        <mi>G</mi>
        <mn>3</mn>
       </msub>
      </mrow>
      <mrow>
       <mo>∂</mo>
       <mi>𝐩</mi>
      </mrow>
     </mfrac>
     <mo>⋅</mo>
     <mover accent="true">
      <mi>𝐩</mi>
      <mo>˙</mo>
     </mover>
    </mrow>
    <mo>+</mo>
    <mrow>
     <mfrac>
      <mrow>
       <mo>∂</mo>
       <msub>
        <mi>G</mi>
        <mn>3</mn>
       </msub>
      </mrow>
      <mrow>
       <mo>∂</mo>
       <mi>𝐐</mi>
      </mrow>
     </mfrac>
     <mo>⋅</mo>
     <mover accent="true">
      <mi>𝐐</mi>
      <mo>˙</mo>
     </mover>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <minus></minus>
     <apply>
      <minus></minus>
      <apply>
       <ci>normal-⋅</ci>
       <ci>𝐪</ci>
       <apply>
        <ci>normal-˙</ci>
        <ci>𝐩</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <ci>H</ci>
      <vector>
       <ci>𝐪</ci>
       <ci>𝐩</ci>
       <ci>t</ci>
      </vector>
     </apply>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <minus></minus>
      <apply>
       <ci>normal-⋅</ci>
       <ci>𝐏</ci>
       <apply>
        <ci>normal-˙</ci>
        <ci>𝐐</ci>
       </apply>
      </apply>
      <apply>
       <times></times>
       <ci>K</ci>
       <vector>
        <ci>𝐐</ci>
        <ci>𝐏</ci>
        <ci>t</ci>
       </vector>
      </apply>
     </apply>
     <apply>
      <divide></divide>
      <apply>
       <partialdiff></partialdiff>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>G</ci>
        <cn type="integer">3</cn>
       </apply>
      </apply>
      <apply>
       <partialdiff></partialdiff>
       <ci>t</ci>
      </apply>
     </apply>
     <apply>
      <ci>normal-⋅</ci>
      <apply>
       <divide></divide>
       <apply>
        <partialdiff></partialdiff>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>G</ci>
         <cn type="integer">3</cn>
        </apply>
       </apply>
       <apply>
        <partialdiff></partialdiff>
        <ci>𝐩</ci>
       </apply>
      </apply>
      <apply>
       <ci>normal-˙</ci>
       <ci>𝐩</ci>
      </apply>
     </apply>
     <apply>
      <ci>normal-⋅</ci>
      <apply>
       <divide></divide>
       <apply>
        <partialdiff></partialdiff>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>G</ci>
         <cn type="integer">3</cn>
        </apply>
       </apply>
       <apply>
        <partialdiff></partialdiff>
        <ci>𝐐</ci>
       </apply>
      </apply>
      <apply>
       <ci>normal-˙</ci>
       <ci>𝐐</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   -\mathbf{q}\cdot\dot{\mathbf{p}}-H(\mathbf{q},\mathbf{p},t)=\mathbf{P}\cdot%
\dot{\mathbf{Q}}-K(\mathbf{Q},\mathbf{P},t)+\frac{\partial G_{3}}{\partial t}+%
\frac{\partial G_{3}}{\partial\mathbf{p}}\cdot\dot{\mathbf{p}}+\frac{\partial G%
_{3}}{\partial\mathbf{Q}}\cdot\dot{\mathbf{Q}}
  </annotation>
 </semantics>
</math>

</p>

<p>Since the new and old coordinates are each independent, the following 

<math display="inline" id="Canonical_transformation:92">
 <semantics>
  <mrow>
   <mrow>
    <mn>2</mn>
    <mi>N</mi>
   </mrow>
   <mo>+</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <plus></plus>
    <apply>
     <times></times>
     <cn type="integer">2</cn>
     <ci>N</ci>
    </apply>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   2N+1
  </annotation>
 </semantics>
</math>

 equations must hold</p>

<p>

<math display="inline" id="Canonical_transformation:93">
 <semantics>
  <mi>𝐪</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>𝐪</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle\mathbf{q}
  </annotation>
 </semantics>
</math>


</p>

<p>These equations define the transformation 

<math display="inline" id="Canonical_transformation:94">
 <semantics>
  <mrow>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>𝐪</mi>
    <mo>,</mo>
    <mi>𝐩</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mi mathvariant="normal">→</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>𝐐</mi>
    <mo>,</mo>
    <mi>𝐏</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <interval closure="open">
     <ci>𝐪</ci>
     <ci>𝐩</ci>
    </interval>
    <ci>normal-→</ci>
    <interval closure="open">
     <ci>𝐐</ci>
     <ci>𝐏</ci>
    </interval>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (\mathbf{q},\mathbf{p})→(\mathbf{Q},\mathbf{P})
  </annotation>
 </semantics>
</math>

 as follows. The <em>first</em> set of 

<math display="inline" id="Canonical_transformation:95">
 <semantics>
  <mi>N</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>N</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   N
  </annotation>
 </semantics>
</math>

 equations</p>

<p>

<math display="block" id="Canonical_transformation:96">
 <semantics>
  <mrow>
   <mi>𝐪</mi>
   <mo>=</mo>
   <mrow>
    <mo>-</mo>
    <mfrac>
     <mrow>
      <mo>∂</mo>
      <msub>
       <mi>G</mi>
       <mn>3</mn>
      </msub>
     </mrow>
     <mrow>
      <mo>∂</mo>
      <mi>𝐩</mi>
     </mrow>
    </mfrac>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>𝐪</ci>
    <apply>
     <minus></minus>
     <apply>
      <divide></divide>
      <apply>
       <partialdiff></partialdiff>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>G</ci>
        <cn type="integer">3</cn>
       </apply>
      </apply>
      <apply>
       <partialdiff></partialdiff>
       <ci>𝐩</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{q}=-\frac{\partial G_{3}}{\partial\mathbf{p}}
  </annotation>
 </semantics>
</math>

</p>

<p>define relations between the new <a href="generalized_coordinates" title="wikilink">generalized coordinates</a> 

<math display="inline" id="Canonical_transformation:97">
 <semantics>
  <mi>𝐐</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>𝐐</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{Q}
  </annotation>
 </semantics>
</math>

 and the old <a href="canonical_coordinates" title="wikilink">canonical coordinates</a> 

<math display="inline" id="Canonical_transformation:98">
 <semantics>
  <mrow>
   <mo stretchy="false">(</mo>
   <mi>𝐪</mi>
   <mo>,</mo>
   <mi>𝐩</mi>
   <mo stretchy="false">)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <interval closure="open">
    <ci>𝐪</ci>
    <ci>𝐩</ci>
   </interval>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (\mathbf{q},\mathbf{p})
  </annotation>
 </semantics>
</math>

. Ideally, one can invert these relations to obtain formulae for each <mtpl></mtpl> as a function of the old canonical coordinates. Substitution of these formulae for the 

<math display="inline" id="Canonical_transformation:99">
 <semantics>
  <mi>𝐐</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>𝐐</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{Q}
  </annotation>
 </semantics>
</math>

 coordinates into the <em>second</em> set of 

<math display="inline" id="Canonical_transformation:100">
 <semantics>
  <mi>N</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>N</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   N
  </annotation>
 </semantics>
</math>

 equations</p>

<p>

<math display="block" id="Canonical_transformation:101">
 <semantics>
  <mrow>
   <mi>𝐏</mi>
   <mo>=</mo>
   <mrow>
    <mo>-</mo>
    <mfrac>
     <mrow>
      <mo>∂</mo>
      <msub>
       <mi>G</mi>
       <mn>3</mn>
      </msub>
     </mrow>
     <mrow>
      <mo>∂</mo>
      <mi>𝐐</mi>
     </mrow>
    </mfrac>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>𝐏</ci>
    <apply>
     <minus></minus>
     <apply>
      <divide></divide>
      <apply>
       <partialdiff></partialdiff>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>G</ci>
        <cn type="integer">3</cn>
       </apply>
      </apply>
      <apply>
       <partialdiff></partialdiff>
       <ci>𝐐</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{P}=-\frac{\partial G_{3}}{\partial\mathbf{Q}}
  </annotation>
 </semantics>
</math>

</p>

<p>yields analogous formulae for the new generalized momenta 

<math display="inline" id="Canonical_transformation:102">
 <semantics>
  <mi>𝐏</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>𝐏</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{P}
  </annotation>
 </semantics>
</math>

 in terms of the old <a href="canonical_coordinates" title="wikilink">canonical coordinates</a> 

<math display="inline" id="Canonical_transformation:103">
 <semantics>
  <mrow>
   <mo stretchy="false">(</mo>
   <mi>𝐪</mi>
   <mo>,</mo>
   <mi>𝐩</mi>
   <mo stretchy="false">)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <interval closure="open">
    <ci>𝐪</ci>
    <ci>𝐩</ci>
   </interval>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (\mathbf{q},\mathbf{p})
  </annotation>
 </semantics>
</math>

. We then invert both sets of formulae to obtain the <em>old</em> <a href="canonical_coordinates" title="wikilink">canonical coordinates</a> 

<math display="inline" id="Canonical_transformation:104">
 <semantics>
  <mrow>
   <mo stretchy="false">(</mo>
   <mi>𝐪</mi>
   <mo>,</mo>
   <mi>𝐩</mi>
   <mo stretchy="false">)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <interval closure="open">
    <ci>𝐪</ci>
    <ci>𝐩</ci>
   </interval>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (\mathbf{q},\mathbf{p})
  </annotation>
 </semantics>
</math>

 as functions of the <em>new</em> <a href="canonical_coordinates" title="wikilink">canonical coordinates</a> 

<math display="inline" id="Canonical_transformation:105">
 <semantics>
  <mrow>
   <mo stretchy="false">(</mo>
   <mi>𝐐</mi>
   <mo>,</mo>
   <mi>𝐏</mi>
   <mo stretchy="false">)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <interval closure="open">
    <ci>𝐐</ci>
    <ci>𝐏</ci>
   </interval>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (\mathbf{Q},\mathbf{P})
  </annotation>
 </semantics>
</math>

. Substitution of the inverted formulae into the final equation</p>

<p>

<math display="block" id="Canonical_transformation:106">
 <semantics>
  <mrow>
   <mi>K</mi>
   <mo>=</mo>
   <mrow>
    <mi>H</mi>
    <mo>+</mo>
    <mfrac>
     <mrow>
      <mo>∂</mo>
      <msub>
       <mi>G</mi>
       <mn>3</mn>
      </msub>
     </mrow>
     <mrow>
      <mo>∂</mo>
      <mi>t</mi>
     </mrow>
    </mfrac>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>K</ci>
    <apply>
     <plus></plus>
     <ci>H</ci>
     <apply>
      <divide></divide>
      <apply>
       <partialdiff></partialdiff>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>G</ci>
        <cn type="integer">3</cn>
       </apply>
      </apply>
      <apply>
       <partialdiff></partialdiff>
       <ci>t</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   K=H+\frac{\partial G_{3}}{\partial t}
  </annotation>
 </semantics>
</math>

 yields a formula for 

<math display="inline" id="Canonical_transformation:107">
 <semantics>
  <mi>K</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>K</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   K
  </annotation>
 </semantics>
</math>

 as a function of the new <a href="canonical_coordinates" title="wikilink">canonical coordinates</a> 

<math display="inline" id="Canonical_transformation:108">
 <semantics>
  <mrow>
   <mo stretchy="false">(</mo>
   <mi>𝐐</mi>
   <mo>,</mo>
   <mi>𝐏</mi>
   <mo stretchy="false">)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <interval closure="open">
    <ci>𝐐</ci>
    <ci>𝐏</ci>
   </interval>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (\mathbf{Q},\mathbf{P})
  </annotation>
 </semantics>
</math>

.</p>

<p>In practice, this procedure is easier than it sounds, because the generating function is usually simple.</p>
<h3 id="type-4-generating-function">Type 4 generating function</h3>

<p>The type 4 generating function 

<math display="inline" id="Canonical_transformation:109">
 <semantics>
  <mrow>
   <msub>
    <mi>G</mi>
    <mn>4</mn>
   </msub>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>𝐩</mi>
    <mo>,</mo>
    <mi>𝐏</mi>
    <mo>,</mo>
    <mi>t</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>G</ci>
     <cn type="integer">4</cn>
    </apply>
    <vector>
     <ci>𝐩</ci>
     <ci>𝐏</ci>
     <ci>t</ci>
    </vector>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   G_{4}(\mathbf{p},\mathbf{P},t)
  </annotation>
 </semantics>
</math>

 depends only on the old and new generalized momenta</p>

<p>

<math display="block" id="Canonical_transformation:110">
 <semantics>
  <mrow>
   <mi>G</mi>
   <mo>≡</mo>
   <mrow>
    <mrow>
     <mrow>
      <mi>𝐪</mi>
      <mo>⋅</mo>
      <mi>𝐩</mi>
     </mrow>
     <mo>-</mo>
     <mrow>
      <mi>𝐐</mi>
      <mo>⋅</mo>
      <mi>𝐏</mi>
     </mrow>
    </mrow>
    <mo>+</mo>
    <mrow>
     <msub>
      <mi>G</mi>
      <mn>4</mn>
     </msub>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>𝐩</mi>
      <mo>,</mo>
      <mi>𝐏</mi>
      <mo>,</mo>
      <mi>t</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <equivalent></equivalent>
    <ci>G</ci>
    <apply>
     <plus></plus>
     <apply>
      <minus></minus>
      <apply>
       <ci>normal-⋅</ci>
       <ci>𝐪</ci>
       <ci>𝐩</ci>
      </apply>
      <apply>
       <ci>normal-⋅</ci>
       <ci>𝐐</ci>
       <ci>𝐏</ci>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>G</ci>
       <cn type="integer">4</cn>
      </apply>
      <vector>
       <ci>𝐩</ci>
       <ci>𝐏</ci>
       <ci>t</ci>
      </vector>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   G\equiv\mathbf{q}\cdot\mathbf{p}-\mathbf{Q}\cdot\mathbf{P}+G_{4}(\mathbf{p},%
\mathbf{P},t)
  </annotation>
 </semantics>
</math>

 where the 

<math display="inline" id="Canonical_transformation:111">
 <semantics>
  <mrow>
   <mrow>
    <mi>𝐪</mi>
    <mo>⋅</mo>
    <mi>𝐩</mi>
   </mrow>
   <mo>-</mo>
   <mrow>
    <mi>𝐐</mi>
    <mo>⋅</mo>
    <mi>𝐏</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <minus></minus>
    <apply>
     <ci>normal-⋅</ci>
     <ci>𝐪</ci>
     <ci>𝐩</ci>
    </apply>
    <apply>
     <ci>normal-⋅</ci>
     <ci>𝐐</ci>
     <ci>𝐏</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{q}\cdot\mathbf{p}-\mathbf{Q}\cdot\mathbf{P}
  </annotation>
 </semantics>
</math>

 terms represent a <a href="Legendre_transformation" title="wikilink">Legendre transformation</a> to change both sides of the equation below. To derive the implicit transformation, we expand the defining equation above</p>

<p>

<math display="block" id="Canonical_transformation:112">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mo>-</mo>
     <mrow>
      <mi>𝐪</mi>
      <mo>⋅</mo>
      <mover accent="true">
       <mi>𝐩</mi>
       <mo>˙</mo>
      </mover>
     </mrow>
    </mrow>
    <mo>-</mo>
    <mrow>
     <mi>H</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>𝐪</mi>
      <mo>,</mo>
      <mi>𝐩</mi>
      <mo>,</mo>
      <mi>t</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mrow>
      <mo>-</mo>
      <mrow>
       <mi>𝐐</mi>
       <mo>⋅</mo>
       <mover accent="true">
        <mi>𝐏</mi>
        <mo>˙</mo>
       </mover>
      </mrow>
     </mrow>
     <mo>-</mo>
     <mrow>
      <mi>K</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>𝐐</mi>
       <mo>,</mo>
       <mi>𝐏</mi>
       <mo>,</mo>
       <mi>t</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mrow>
    <mo>+</mo>
    <mfrac>
     <mrow>
      <mo>∂</mo>
      <msub>
       <mi>G</mi>
       <mn>4</mn>
      </msub>
     </mrow>
     <mrow>
      <mo>∂</mo>
      <mi>t</mi>
     </mrow>
    </mfrac>
    <mo>+</mo>
    <mrow>
     <mfrac>
      <mrow>
       <mo>∂</mo>
       <msub>
        <mi>G</mi>
        <mn>4</mn>
       </msub>
      </mrow>
      <mrow>
       <mo>∂</mo>
       <mi>𝐩</mi>
      </mrow>
     </mfrac>
     <mo>⋅</mo>
     <mover accent="true">
      <mi>𝐩</mi>
      <mo>˙</mo>
     </mover>
    </mrow>
    <mo>+</mo>
    <mrow>
     <mfrac>
      <mrow>
       <mo>∂</mo>
       <msub>
        <mi>G</mi>
        <mn>4</mn>
       </msub>
      </mrow>
      <mrow>
       <mo>∂</mo>
       <mi>𝐏</mi>
      </mrow>
     </mfrac>
     <mo>⋅</mo>
     <mover accent="true">
      <mi>𝐏</mi>
      <mo>˙</mo>
     </mover>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <minus></minus>
     <apply>
      <minus></minus>
      <apply>
       <ci>normal-⋅</ci>
       <ci>𝐪</ci>
       <apply>
        <ci>normal-˙</ci>
        <ci>𝐩</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <ci>H</ci>
      <vector>
       <ci>𝐪</ci>
       <ci>𝐩</ci>
       <ci>t</ci>
      </vector>
     </apply>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <minus></minus>
      <apply>
       <minus></minus>
       <apply>
        <ci>normal-⋅</ci>
        <ci>𝐐</ci>
        <apply>
         <ci>normal-˙</ci>
         <ci>𝐏</ci>
        </apply>
       </apply>
      </apply>
      <apply>
       <times></times>
       <ci>K</ci>
       <vector>
        <ci>𝐐</ci>
        <ci>𝐏</ci>
        <ci>t</ci>
       </vector>
      </apply>
     </apply>
     <apply>
      <divide></divide>
      <apply>
       <partialdiff></partialdiff>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>G</ci>
        <cn type="integer">4</cn>
       </apply>
      </apply>
      <apply>
       <partialdiff></partialdiff>
       <ci>t</ci>
      </apply>
     </apply>
     <apply>
      <ci>normal-⋅</ci>
      <apply>
       <divide></divide>
       <apply>
        <partialdiff></partialdiff>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>G</ci>
         <cn type="integer">4</cn>
        </apply>
       </apply>
       <apply>
        <partialdiff></partialdiff>
        <ci>𝐩</ci>
       </apply>
      </apply>
      <apply>
       <ci>normal-˙</ci>
       <ci>𝐩</ci>
      </apply>
     </apply>
     <apply>
      <ci>normal-⋅</ci>
      <apply>
       <divide></divide>
       <apply>
        <partialdiff></partialdiff>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>G</ci>
         <cn type="integer">4</cn>
        </apply>
       </apply>
       <apply>
        <partialdiff></partialdiff>
        <ci>𝐏</ci>
       </apply>
      </apply>
      <apply>
       <ci>normal-˙</ci>
       <ci>𝐏</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   -\mathbf{q}\cdot\dot{\mathbf{p}}-H(\mathbf{q},\mathbf{p},t)=-\mathbf{Q}\cdot%
\dot{\mathbf{P}}-K(\mathbf{Q},\mathbf{P},t)+\frac{\partial G_{4}}{\partial t}+%
\frac{\partial G_{4}}{\partial\mathbf{p}}\cdot\dot{\mathbf{p}}+\frac{\partial G%
_{4}}{\partial\mathbf{P}}\cdot\dot{\mathbf{P}}
  </annotation>
 </semantics>
</math>

</p>

<p>Since the new and old coordinates are each independent, the following 

<math display="inline" id="Canonical_transformation:113">
 <semantics>
  <mrow>
   <mrow>
    <mn>2</mn>
    <mi>N</mi>
   </mrow>
   <mo>+</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <plus></plus>
    <apply>
     <times></times>
     <cn type="integer">2</cn>
     <ci>N</ci>
    </apply>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   2N+1
  </annotation>
 </semantics>
</math>

 equations must hold</p>

<p>

<math display="inline" id="Canonical_transformation:114">
 <semantics>
  <mi>𝐪</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>𝐪</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle\mathbf{q}
  </annotation>
 </semantics>
</math>


</p>

<p>These equations define the transformation 

<math display="inline" id="Canonical_transformation:115">
 <semantics>
  <mrow>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>𝐪</mi>
    <mo>,</mo>
    <mi>𝐩</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mi mathvariant="normal">→</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>𝐐</mi>
    <mo>,</mo>
    <mi>𝐏</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <interval closure="open">
     <ci>𝐪</ci>
     <ci>𝐩</ci>
    </interval>
    <ci>normal-→</ci>
    <interval closure="open">
     <ci>𝐐</ci>
     <ci>𝐏</ci>
    </interval>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (\mathbf{q},\mathbf{p})→(\mathbf{Q},\mathbf{P})
  </annotation>
 </semantics>
</math>

 as follows. The <em>first</em> set of 

<math display="inline" id="Canonical_transformation:116">
 <semantics>
  <mi>N</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>N</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   N
  </annotation>
 </semantics>
</math>

 equations</p>

<p>

<math display="block" id="Canonical_transformation:117">
 <semantics>
  <mrow>
   <mi>𝐪</mi>
   <mo>=</mo>
   <mrow>
    <mo>-</mo>
    <mfrac>
     <mrow>
      <mo>∂</mo>
      <msub>
       <mi>G</mi>
       <mn>4</mn>
      </msub>
     </mrow>
     <mrow>
      <mo>∂</mo>
      <mi>𝐩</mi>
     </mrow>
    </mfrac>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>𝐪</ci>
    <apply>
     <minus></minus>
     <apply>
      <divide></divide>
      <apply>
       <partialdiff></partialdiff>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>G</ci>
        <cn type="integer">4</cn>
       </apply>
      </apply>
      <apply>
       <partialdiff></partialdiff>
       <ci>𝐩</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{q}=-\frac{\partial G_{4}}{\partial\mathbf{p}}
  </annotation>
 </semantics>
</math>

</p>

<p>define relations between the new generalized momenta 

<math display="inline" id="Canonical_transformation:118">
 <semantics>
  <mi>𝐏</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>𝐏</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{P}
  </annotation>
 </semantics>
</math>

 and the old <a href="canonical_coordinates" title="wikilink">canonical coordinates</a> 

<math display="inline" id="Canonical_transformation:119">
 <semantics>
  <mrow>
   <mo stretchy="false">(</mo>
   <mi>𝐪</mi>
   <mo>,</mo>
   <mi>𝐩</mi>
   <mo stretchy="false">)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <interval closure="open">
    <ci>𝐪</ci>
    <ci>𝐩</ci>
   </interval>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (\mathbf{q},\mathbf{p})
  </annotation>
 </semantics>
</math>

. Ideally, one can invert these relations to obtain formulae for each <mtpl></mtpl> as a function of the old canonical coordinates. Substitution of these formulae for the 

<math display="inline" id="Canonical_transformation:120">
 <semantics>
  <mi>𝐏</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>𝐏</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{P}
  </annotation>
 </semantics>
</math>

 coordinates into the <em>second</em> set of 

<math display="inline" id="Canonical_transformation:121">
 <semantics>
  <mi>N</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>N</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   N
  </annotation>
 </semantics>
</math>

 equations</p>

<p>

<math display="block" id="Canonical_transformation:122">
 <semantics>
  <mrow>
   <mi>𝐐</mi>
   <mo>=</mo>
   <mfrac>
    <mrow>
     <mo>∂</mo>
     <msub>
      <mi>G</mi>
      <mn>4</mn>
     </msub>
    </mrow>
    <mrow>
     <mo>∂</mo>
     <mi>𝐏</mi>
    </mrow>
   </mfrac>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>𝐐</ci>
    <apply>
     <divide></divide>
     <apply>
      <partialdiff></partialdiff>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>G</ci>
       <cn type="integer">4</cn>
      </apply>
     </apply>
     <apply>
      <partialdiff></partialdiff>
      <ci>𝐏</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{Q}=\frac{\partial G_{4}}{\partial\mathbf{P}}
  </annotation>
 </semantics>
</math>

</p>

<p>yields analogous formulae for the new generalized coordinates 

<math display="inline" id="Canonical_transformation:123">
 <semantics>
  <mi>𝐐</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>𝐐</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{Q}
  </annotation>
 </semantics>
</math>

 in terms of the old <a href="canonical_coordinates" title="wikilink">canonical coordinates</a> 

<math display="inline" id="Canonical_transformation:124">
 <semantics>
  <mrow>
   <mo stretchy="false">(</mo>
   <mi>𝐪</mi>
   <mo>,</mo>
   <mi>𝐩</mi>
   <mo stretchy="false">)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <interval closure="open">
    <ci>𝐪</ci>
    <ci>𝐩</ci>
   </interval>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (\mathbf{q},\mathbf{p})
  </annotation>
 </semantics>
</math>

. We then invert both sets of formulae to obtain the <em>old</em> <a href="canonical_coordinates" title="wikilink">canonical coordinates</a> 

<math display="inline" id="Canonical_transformation:125">
 <semantics>
  <mrow>
   <mo stretchy="false">(</mo>
   <mi>𝐪</mi>
   <mo>,</mo>
   <mi>𝐩</mi>
   <mo stretchy="false">)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <interval closure="open">
    <ci>𝐪</ci>
    <ci>𝐩</ci>
   </interval>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (\mathbf{q},\mathbf{p})
  </annotation>
 </semantics>
</math>

 as functions of the <em>new</em> <a href="canonical_coordinates" title="wikilink">canonical coordinates</a> 

<math display="inline" id="Canonical_transformation:126">
 <semantics>
  <mrow>
   <mo stretchy="false">(</mo>
   <mi>𝐐</mi>
   <mo>,</mo>
   <mi>𝐏</mi>
   <mo stretchy="false">)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <interval closure="open">
    <ci>𝐐</ci>
    <ci>𝐏</ci>
   </interval>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (\mathbf{Q},\mathbf{P})
  </annotation>
 </semantics>
</math>

. Substitution of the inverted formulae into the final equation</p>

<p>

<math display="block" id="Canonical_transformation:127">
 <semantics>
  <mrow>
   <mi>K</mi>
   <mo>=</mo>
   <mrow>
    <mi>H</mi>
    <mo>+</mo>
    <mfrac>
     <mrow>
      <mo>∂</mo>
      <msub>
       <mi>G</mi>
       <mn>4</mn>
      </msub>
     </mrow>
     <mrow>
      <mo>∂</mo>
      <mi>t</mi>
     </mrow>
    </mfrac>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>K</ci>
    <apply>
     <plus></plus>
     <ci>H</ci>
     <apply>
      <divide></divide>
      <apply>
       <partialdiff></partialdiff>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>G</ci>
        <cn type="integer">4</cn>
       </apply>
      </apply>
      <apply>
       <partialdiff></partialdiff>
       <ci>t</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   K=H+\frac{\partial G_{4}}{\partial t}
  </annotation>
 </semantics>
</math>

 yields a formula for 

<math display="inline" id="Canonical_transformation:128">
 <semantics>
  <mi>K</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>K</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   K
  </annotation>
 </semantics>
</math>

 as a function of the new <a href="canonical_coordinates" title="wikilink">canonical coordinates</a> 

<math display="inline" id="Canonical_transformation:129">
 <semantics>
  <mrow>
   <mo stretchy="false">(</mo>
   <mi>𝐐</mi>
   <mo>,</mo>
   <mi>𝐏</mi>
   <mo stretchy="false">)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <interval closure="open">
    <ci>𝐐</ci>
    <ci>𝐏</ci>
   </interval>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (\mathbf{Q},\mathbf{P})
  </annotation>
 </semantics>
</math>

.</p>
<h2 id="motion-as-a-canonical-transformation">Motion as a canonical transformation</h2>

<p>Motion itself (or, equivalently, a shift in the time origin) is a canonical transformation. If 

<math display="inline" id="Canonical_transformation:130">
 <semantics>
  <mrow>
   <mrow>
    <mi>𝐐</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>t</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>≡</mo>
   <mrow>
    <mi>𝐪</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>t</mi>
      <mo>+</mo>
      <mi>τ</mi>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <equivalent></equivalent>
    <apply>
     <times></times>
     <ci>𝐐</ci>
     <ci>t</ci>
    </apply>
    <apply>
     <times></times>
     <ci>𝐪</ci>
     <apply>
      <plus></plus>
      <ci>t</ci>
      <ci>τ</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{Q}(t)\equiv\mathbf{q}(t+\tau)
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Canonical_transformation:131">
 <semantics>
  <mrow>
   <mrow>
    <mi>𝐏</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>t</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>≡</mo>
   <mrow>
    <mi>𝐩</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>t</mi>
      <mo>+</mo>
      <mi>τ</mi>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <equivalent></equivalent>
    <apply>
     <times></times>
     <ci>𝐏</ci>
     <ci>t</ci>
    </apply>
    <apply>
     <times></times>
     <ci>𝐩</ci>
     <apply>
      <plus></plus>
      <ci>t</ci>
      <ci>τ</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{P}(t)\equiv\mathbf{p}(t+\tau)
  </annotation>
 </semantics>
</math>

, then <a href="action_(physics)" title="wikilink">Hamilton's principle</a> is automatically satisfied</p>

<p>

<math display="block" id="Canonical_transformation:132">
 <semantics>
  <mrow>
   <mrow>
    <mi>δ</mi>
    <mrow>
     <msubsup>
      <mo largeop="true" symmetric="true">∫</mo>
      <msub>
       <mi>t</mi>
       <mn>1</mn>
      </msub>
      <msub>
       <mi>t</mi>
       <mn>2</mn>
      </msub>
     </msubsup>
     <mrow>
      <mrow>
       <mo>[</mo>
       <mrow>
        <mrow>
         <mi>𝐏</mi>
         <mo>⋅</mo>
         <mover accent="true">
          <mi>𝐐</mi>
          <mo>˙</mo>
         </mover>
        </mrow>
        <mo>-</mo>
        <mrow>
         <mi>K</mi>
         <mrow>
          <mo stretchy="false">(</mo>
          <mi>𝐐</mi>
          <mo>,</mo>
          <mi>𝐏</mi>
          <mo>,</mo>
          <mi>t</mi>
          <mo stretchy="false">)</mo>
         </mrow>
        </mrow>
       </mrow>
       <mo>]</mo>
      </mrow>
      <mi>d</mi>
      <mi>t</mi>
     </mrow>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mi>δ</mi>
    <mrow>
     <msubsup>
      <mo largeop="true" symmetric="true">∫</mo>
      <mrow>
       <msub>
        <mi>t</mi>
        <mn>1</mn>
       </msub>
       <mo>+</mo>
       <mi>τ</mi>
      </mrow>
      <mrow>
       <msub>
        <mi>t</mi>
        <mn>2</mn>
       </msub>
       <mo>+</mo>
       <mi>τ</mi>
      </mrow>
     </msubsup>
     <mrow>
      <mrow>
       <mo>[</mo>
       <mrow>
        <mrow>
         <mi>𝐩</mi>
         <mo>⋅</mo>
         <mover accent="true">
          <mi>𝐪</mi>
          <mo>˙</mo>
         </mover>
        </mrow>
        <mo>-</mo>
        <mrow>
         <mi>H</mi>
         <mrow>
          <mo stretchy="false">(</mo>
          <mi>𝐪</mi>
          <mo>,</mo>
          <mi>𝐩</mi>
          <mo>,</mo>
          <mrow>
           <mi>t</mi>
           <mo>+</mo>
           <mi>τ</mi>
          </mrow>
          <mo stretchy="false">)</mo>
         </mrow>
        </mrow>
       </mrow>
       <mo>]</mo>
      </mrow>
      <mi>d</mi>
      <mi>t</mi>
     </mrow>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <times></times>
      <ci>δ</ci>
      <apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <int></int>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>t</ci>
          <cn type="integer">1</cn>
         </apply>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>t</ci>
         <cn type="integer">2</cn>
        </apply>
       </apply>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="latexml">delimited-[]</csymbol>
         <apply>
          <minus></minus>
          <apply>
           <ci>normal-⋅</ci>
           <ci>𝐏</ci>
           <apply>
            <ci>normal-˙</ci>
            <ci>𝐐</ci>
           </apply>
          </apply>
          <apply>
           <times></times>
           <ci>K</ci>
           <vector>
            <ci>𝐐</ci>
            <ci>𝐏</ci>
            <ci>t</ci>
           </vector>
          </apply>
         </apply>
        </apply>
        <ci>d</ci>
        <ci>t</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <ci>δ</ci>
      <apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <int></int>
         <apply>
          <plus></plus>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>t</ci>
           <cn type="integer">1</cn>
          </apply>
          <ci>τ</ci>
         </apply>
        </apply>
        <apply>
         <plus></plus>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>t</ci>
          <cn type="integer">2</cn>
         </apply>
         <ci>τ</ci>
        </apply>
       </apply>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="latexml">delimited-[]</csymbol>
         <apply>
          <minus></minus>
          <apply>
           <ci>normal-⋅</ci>
           <ci>𝐩</ci>
           <apply>
            <ci>normal-˙</ci>
            <ci>𝐪</ci>
           </apply>
          </apply>
          <apply>
           <times></times>
           <ci>H</ci>
           <vector>
            <ci>𝐪</ci>
            <ci>𝐩</ci>
            <apply>
             <plus></plus>
             <ci>t</ci>
             <ci>τ</ci>
            </apply>
           </vector>
          </apply>
         </apply>
        </apply>
        <ci>d</ci>
        <ci>t</ci>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <cn type="integer">0</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \delta\int_{t_{1}}^{t_{2}}\left[\mathbf{P}\cdot\dot{\mathbf{Q}}-K(\mathbf{Q},%
\mathbf{P},t)\right]dt=\delta\int_{t_{1}+\tau}^{t_{2}+\tau}\left[\mathbf{p}%
\cdot\dot{\mathbf{q}}-H(\mathbf{q},\mathbf{p},t+\tau)\right]dt=0
  </annotation>
 </semantics>
</math>

</p>

<p>since a valid trajectory 

<math display="inline" id="Canonical_transformation:133">
 <semantics>
  <mrow>
   <mo stretchy="false">(</mo>
   <mrow>
    <mi>𝐪</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>t</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>,</mo>
   <mrow>
    <mi>𝐩</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>t</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo stretchy="false">)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <interval closure="open">
    <apply>
     <times></times>
     <ci>𝐪</ci>
     <ci>t</ci>
    </apply>
    <apply>
     <times></times>
     <ci>𝐩</ci>
     <ci>t</ci>
    </apply>
   </interval>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (\mathbf{q}(t),\mathbf{p}(t))
  </annotation>
 </semantics>
</math>

 should always satisfy <a href="action_(physics)" title="wikilink">Hamilton's principle</a>, regardless of the endpoints.</p>
<h2 id="modern-mathematical-description">Modern mathematical description</h2>

<p>In mathematical terms, <a href="canonical_coordinates" title="wikilink">canonical coordinates</a> are any coordinates on the phase space (<a href="cotangent_bundle" title="wikilink">cotangent bundle</a>) of the system that allow the <a href="canonical_one-form" title="wikilink">canonical one-form</a> to be written as</p>

<p>

<math display="block" id="Canonical_transformation:134">
 <semantics>
  <mrow>
   <munder>
    <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
    <mi>i</mi>
   </munder>
   <mrow>
    <mpadded width="+1.7pt">
     <msub>
      <mi>p</mi>
      <mi>i</mi>
     </msub>
    </mpadded>
    <mi>d</mi>
    <msup>
     <mi>q</mi>
     <mi>i</mi>
    </msup>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <sum></sum>
     <ci>i</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>p</ci>
      <ci>i</ci>
     </apply>
     <ci>d</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>q</ci>
      <ci>i</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \sum_{i}p_{i}\,dq^{i}
  </annotation>
 </semantics>
</math>

</p>

<p>up to a total differential (<a href="exact_form" title="wikilink">exact form</a>). The change of variable between one set of canonical coordinates and another is a <strong>canonical transformation</strong>. The index of the <a href="generalized_coordinate" title="wikilink">generalized coordinates</a> 

<math display="inline" id="Canonical_transformation:135">
 <semantics>
  <mi>𝐪</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>𝐪</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{q}
  </annotation>
 </semantics>
</math>

 is written here as a <em>superscript</em> (

<math display="inline" id="Canonical_transformation:136">
 <semantics>
  <msup>
   <mi>q</mi>
   <mi>i</mi>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>q</ci>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   q^{i}
  </annotation>
 </semantics>
</math>

), not as a <em>subscript</em> as done above (

<math display="inline" id="Canonical_transformation:137">
 <semantics>
  <msub>
   <mi>q</mi>
   <mi>i</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>q</ci>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   q_{i}
  </annotation>
 </semantics>
</math>

). The superscript conveys the <a href="Covariance_and_contravariance_of_vectors" title="wikilink">contravariant transformation properties</a> of the generalized coordinates, and does <em>not</em> mean that the coordinate is being raised to a power. Further details may be found at the <a class="uri" href="symplectomorphism" title="wikilink">symplectomorphism</a> article.</p>
<h2 id="history">History</h2>

<p>The first major application of the canonical transformation was in 1846, by <a href="Charles-Eugène_Delaunay" title="wikilink">Charles Delaunay</a>, in the study of the <a href="Earth-Moon-Sun_system" title="wikilink">Earth-Moon-Sun system</a>. This work resulted in the publication of a pair of large volumes as <em>Mémoires</em> by the <a href="French_Academy_of_Sciences" title="wikilink">French Academy of Sciences</a>, in 1860 and 1867.</p>
<h2 id="see-also">See also</h2>
<ul>
<li><a class="uri" href="Symplectomorphism" title="wikilink">Symplectomorphism</a></li>
<li><a href="Hamilton–Jacobi_equation" title="wikilink">Hamilton–Jacobi equation</a></li>
<li><a href="Liouville's_theorem_(Hamiltonian)" title="wikilink">Liouville's theorem (Hamiltonian)</a></li>
<li><a href="Mathieu_transformation" title="wikilink">Mathieu transformation</a></li>
<li><a href="Linear_canonical_transformation" title="wikilink">Linear canonical transformation</a></li>
</ul>
<h2 id="references">References</h2>
<ul>
<li><a href="Lev_Landau" title="wikilink">Landau LD</a> and <a href="Evgeny_Lifshitz" title="wikilink">Lifshitz EM</a> (1976) <em>Mechanics</em>, 3rd. ed., Pergamon Press. ISBN 0-08-021022-8 (hardcover) and ISBN 0-08-029141-4 (softcover).</li>
<li><a href="Herbert_Goldstein" title="wikilink">Goldstein H.</a> (1980) <em>Classical Mechanics</em>, 2nd. ed., Addison-Wesley. ISBN 0-201-02918-9</li>
</ul>

<p>"</p>

<p><a href="Category:Concepts_in_physics" title="wikilink">Category:Concepts in physics</a> <a href="Category:Hamiltonian_mechanics" title="wikilink">Category:Hamiltonian mechanics</a> <a class="uri" href="Category:Transforms" title="wikilink">Category:Transforms</a></p>
</body>
</html>

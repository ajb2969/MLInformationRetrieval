<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="994">Ershove Number</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Ershove Number</h1>
<hr/>

<p><strong>Ershov numbers</strong> are used in code optimization to minimize the amount of register allocations. Method can be used to optimally select registers when there is only one expression in a code block. Given an expression E = E<sub>1</sub> <em>op</em> E<sub>2</sub> the goal is to generate code so as to either minimize the number of registers used, or, if an insufficient number of registers is available, to minimize the number of nonregister temporaries required.</p>

<p>The Ershov number <em>n</em> of a node in given <a href="expression_tree" title="wikilink">expression tree</a> is defined as follows:</p>
<ol>
<li>Every leaf has <em>n</em> = 1.</li>
<li>For a node with one child, <em>n</em> is the same as child's.</li>
<li>For a node with two children, <em>n</em> is defined as:</li>
</ol>
<dl>
<dd><dl>
<dd>

<math display="inline" id="Ershove_Number:0">
 <semantics>
  <mrow>
   <mrow>
    <mi>n</mi>
    <mo>=</mo>
    <mrow>
     <mi>m</mi>
     <mi>a</mi>
     <mi>x</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mi>c</mi>
       <mi>h</mi>
       <mi>i</mi>
       <mi>l</mi>
       <msub>
        <mi>d</mi>
        <mn>1</mn>
       </msub>
      </mrow>
      <mo>,</mo>
      <mrow>
       <mi>c</mi>
       <mi>h</mi>
       <mi>i</mi>
       <mi>l</mi>
       <msub>
        <mi>d</mi>
        <mn>2</mn>
       </msub>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
   <mrow>
    <mrow>
     <mi>i</mi>
     <mi>f</mi>
     <mi>c</mi>
     <mi>h</mi>
     <mi>i</mi>
     <mi>l</mi>
     <msub>
      <mi>d</mi>
      <mn>1</mn>
     </msub>
    </mrow>
    <mo>â‰ </mo>
    <mrow>
     <mi>c</mi>
     <mi>h</mi>
     <mi>i</mi>
     <mi>l</mi>
     <msub>
      <mi>d</mi>
      <mn>2</mn>
     </msub>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <eq></eq>
     <ci>n</ci>
     <apply>
      <times></times>
      <ci>m</ci>
      <ci>a</ci>
      <ci>x</ci>
      <interval closure="open">
       <apply>
        <times></times>
        <ci>c</ci>
        <ci>h</ci>
        <ci>i</ci>
        <ci>l</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>d</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <apply>
        <times></times>
        <ci>c</ci>
        <ci>h</ci>
        <ci>i</ci>
        <ci>l</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>d</ci>
         <cn type="integer">2</cn>
        </apply>
       </apply>
      </interval>
     </apply>
    </apply>
    <apply>
     <neq></neq>
     <apply>
      <times></times>
      <ci>i</ci>
      <ci>f</ci>
      <ci>c</ci>
      <ci>h</ci>
      <ci>i</ci>
      <ci>l</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>d</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <apply>
      <times></times>
      <ci>c</ci>
      <ci>h</ci>
      <ci>i</ci>
      <ci>l</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>d</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n=max(child_{1},child_{2}),ifchild_{1}\neq child_{2}
  </annotation>
 </semantics>
</math>


</dd>
<dd>

<math display="inline" id="Ershove_Number:1">
 <semantics>
  <mrow>
   <mrow>
    <mi>n</mi>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mi>c</mi>
      <mi>h</mi>
      <mi>i</mi>
      <mi>l</mi>
      <msub>
       <mi>d</mi>
       <mn>1</mn>
      </msub>
     </mrow>
     <mo>+</mo>
     <mn>1</mn>
    </mrow>
   </mrow>
   <mo>,</mo>
   <mrow>
    <mrow>
     <mi>i</mi>
     <mi>f</mi>
     <mi>c</mi>
     <mi>h</mi>
     <mi>i</mi>
     <mi>l</mi>
     <msub>
      <mi>d</mi>
      <mn>1</mn>
     </msub>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mi>c</mi>
     <mi>h</mi>
     <mi>i</mi>
     <mi>l</mi>
     <msub>
      <mi>d</mi>
      <mn>2</mn>
     </msub>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <eq></eq>
     <ci>n</ci>
     <apply>
      <plus></plus>
      <apply>
       <times></times>
       <ci>c</ci>
       <ci>h</ci>
       <ci>i</ci>
       <ci>l</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>d</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <cn type="integer">1</cn>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <apply>
      <times></times>
      <ci>i</ci>
      <ci>f</ci>
      <ci>c</ci>
      <ci>h</ci>
      <ci>i</ci>
      <ci>l</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>d</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <apply>
      <times></times>
      <ci>c</ci>
      <ci>h</ci>
      <ci>i</ci>
      <ci>l</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>d</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n=child_{1}+1,ifchild_{1}=child_{2}
  </annotation>
 </semantics>
</math>


</dd>
</dl>
</dd>
</dl>

<p>The Ershov number of a <a href="node_(autonomous_system)" title="wikilink">node</a> represents the minimum number of registers required to evaluate the subexpression whose root is that node. The idea is that we evaluate the child with the larger Ershov number first, then the other child, then perform the operation at the root.</p>
<h2 id="example">Example</h2>

<p>Suppose we have an expression tree with a '+' operation at the root, and the left and right <a href="subtree" title="wikilink">subtrees</a> have Ershov numbers of 3 and 4, respectively. The Ershov number of this node is 4, so we should be able to generate code for the expression using 4 registers.</p>
<ol>
<li>Generate code to evaluate the right child using registers r1, r2, r3, and r4. Place the result in r1.</li>
<li>Generate code to evaluate the left child using registers r2, r3, and r4. Place the result in r2.</li>
<li>Issue the instruction "ADD r1, r2, r1".</li>
</ol>

<p>What if there are not enough registers available? That is, if the Ershov number of the root of the expression tree is greater than the number of registers. We can still use the Ershov numbers to generate code using a minimal number of loads and stores, as follows:</p>
<ol>
<li>generate code for the child with the larger Ershov number</li>
<li>issue an instruction to store the result in a temporary</li>
<li>generate code for the child with the smaller Ershov number</li>
<li>issue an instruction to load the temporary into a register</li>
<li>issue an instruction to perform the operation at the root</li>
</ol>
<h2 id="example-1">Example</h2>

<p>Suppose we have an expression tree in the following form:</p>
<ul>
<li>Generate code for this tree using only 3 registers.</li>
<li>Generate code for this tree using only 2 registers.</li>
</ul>

<p>"</p>

<p><a href="Category:Syntax" title="wikilink"> Softaware optimization</a></p>
</body>
</html>

<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="1613">Segmented regression</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Segmented regression</h1>
<hr/>

<p><strong>Segmented regression</strong>, also known as <strong>piecewise regression</strong> or 'broken-stick regression', is a method in <a href="regression_analysis" title="wikilink">regression analysis</a> in which the <a href="independent_variable" title="wikilink">independent variable</a> is partitioned into intervals and a separate line segment is fit to each interval. Segmented regression analysis can also be performed on multivariate data by partitioning the various independent variables. Segmented regression is useful when the independent variables, clustered into different groups, exhibit different relationships between the variables in these regions. The boundaries between the segments are <em>breakpoints</em>.</p>

<p><strong>Segmented linear regression</strong> is segmented regression whereby the relations in the intervals are obtained by <a href="linear_regression" title="wikilink">linear regression</a>.</p>
<h2 id="segmented-linear-regression-two-segments">Segmented linear regression, two segments</h2>

<p> </p>

<p>Segmented linear regression with two segments separated by a <em>breakpoint</em> can be useful to quantify an abrupt change of the response function (Yr) of a varying influential factor (<strong>x</strong>). The breakpoint can be interpreted as a <em>critical</em>, <em>safe</em>, or <em>threshold</em> value beyond or below which (un)desired effects occur. The breakpoint can be important in decision making <a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a></p>

<p>The figures illustrate some of the results and regression types obtainable.</p>

<p>A segmented regression analysis is based on the presence of a set of ( <strong>y, x</strong> ) data, in which <strong>y</strong> is the <a href="dependent_variable" title="wikilink">dependent variable</a> and <strong>x</strong> the <a href="independent_variable" title="wikilink">independent variable</a>.</p>

<p>The <a href="least_squares" title="wikilink">least squares</a> method applied separately to each segment, by which the two regression lines are made to fit the data set as closely as possible while minimizing the <em>sum of squares of the differences</em> (SSD) between observed (<strong>y</strong>) and calculated (Yr) values of the dependent variable, results in the following two equations:</p>
<ul>
<li>Yr = A<sub>1</sub>.<strong>x</strong> + K<sub>1</sub>     for <strong>x</strong> &lt; BP (breakpoint)</li>
<li>Yr = A<sub>2</sub>.<strong>x</strong> + K<sub>2</sub>     for <strong>x</strong> &gt; BP (breakpoint)</li>
</ul>

<p>where:<br/>
:Yr is the expected (predicted) value of <strong>y</strong> for a certain value of <strong>x</strong>;</p>
<dl>
<dd>A<sub>1</sub> and A<sub>2</sub> are <a href="regression_coefficient" title="wikilink">regression coefficients</a> (indicating the slope of the line segments);
</dd>
<dd>K<sub>1</sub> and K<sub>2</sub> are <em>regression constants</em> (indicating the intercept at the <strong>y</strong>-axis).
</dd>
</dl>

<p>The data may show many types or trends,<a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a> see the figures.</p>

<p>The method also yields two <a href="Pearson_product-moment_correlation_coefficient" title="wikilink">correlation coefficients</a> (R):</p>
<ul>
<li>

<math display="inline" id="Segmented_regression:0">
 <semantics>
  <mrow>
   <msubsup>
    <mi>R</mi>
    <mn>1</mn>
    <mn>2</mn>
   </msubsup>
   <mo>=</mo>
   <mrow>
    <mn>1</mn>
    <mo>-</mo>
    <mfrac>
     <mstyle scriptlevel="-1">
      <mrow>
       <mo largeop="true" symmetric="true">∑</mo>
       <msup>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <mi>y</mi>
          <mo>-</mo>
          <msub>
           <mi>Y</mi>
           <mi>r</mi>
          </msub>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
        <mn>2</mn>
       </msup>
      </mrow>
     </mstyle>
     <mstyle scriptlevel="-1">
      <mrow>
       <mo largeop="true" symmetric="true">∑</mo>
       <msup>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <mi>y</mi>
          <mo>-</mo>
          <msub>
           <mi>Y</mi>
           <mrow>
            <mi>a</mi>
            <mn>1</mn>
           </mrow>
          </msub>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
        <mn>2</mn>
       </msup>
      </mrow>
     </mstyle>
    </mfrac>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>R</ci>
      <cn type="integer">1</cn>
     </apply>
     <cn type="integer">2</cn>
    </apply>
    <apply>
     <minus></minus>
     <cn type="integer">1</cn>
     <apply>
      <divide></divide>
      <apply>
       <sum></sum>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <minus></minus>
         <ci>y</ci>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>Y</ci>
          <ci>r</ci>
         </apply>
        </apply>
        <cn type="integer">2</cn>
       </apply>
      </apply>
      <apply>
       <sum></sum>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <minus></minus>
         <ci>y</ci>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>Y</ci>
          <apply>
           <times></times>
           <ci>a</ci>
           <cn type="integer">1</cn>
          </apply>
         </apply>
        </apply>
        <cn type="integer">2</cn>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   R_{1}^{2}=1-\frac{\sum(y-Y_{r})^{2}}{\sum(y-Y_{a1})^{2}}
  </annotation>
 </semantics>
</math>

     for <strong>x</strong> &lt; BP (breakpoint)</li>
</ul>

<p>and</p>
<ul>
<li>

<math display="inline" id="Segmented_regression:1">
 <semantics>
  <mrow>
   <msubsup>
    <mi>R</mi>
    <mn>2</mn>
    <mn>2</mn>
   </msubsup>
   <mo>=</mo>
   <mrow>
    <mn>1</mn>
    <mo>-</mo>
    <mfrac>
     <mstyle scriptlevel="-1">
      <mrow>
       <mo largeop="true" symmetric="true">∑</mo>
       <msup>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <mi>y</mi>
          <mo>-</mo>
          <msub>
           <mi>Y</mi>
           <mi>r</mi>
          </msub>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
        <mn>2</mn>
       </msup>
      </mrow>
     </mstyle>
     <mstyle scriptlevel="-1">
      <mrow>
       <mo largeop="true" symmetric="true">∑</mo>
       <msup>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <mi>y</mi>
          <mo>-</mo>
          <msub>
           <mi>Y</mi>
           <mrow>
            <mi>a</mi>
            <mn>2</mn>
           </mrow>
          </msub>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
        <mn>2</mn>
       </msup>
      </mrow>
     </mstyle>
    </mfrac>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>R</ci>
      <cn type="integer">2</cn>
     </apply>
     <cn type="integer">2</cn>
    </apply>
    <apply>
     <minus></minus>
     <cn type="integer">1</cn>
     <apply>
      <divide></divide>
      <apply>
       <sum></sum>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <minus></minus>
         <ci>y</ci>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>Y</ci>
          <ci>r</ci>
         </apply>
        </apply>
        <cn type="integer">2</cn>
       </apply>
      </apply>
      <apply>
       <sum></sum>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <minus></minus>
         <ci>y</ci>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>Y</ci>
          <apply>
           <times></times>
           <ci>a</ci>
           <cn type="integer">2</cn>
          </apply>
         </apply>
        </apply>
        <cn type="integer">2</cn>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   R_{2}^{2}=1-\frac{\sum(y-Y_{r})^{2}}{\sum(y-Y_{a2})^{2}}
  </annotation>
 </semantics>
</math>

     for <strong>x</strong> &gt; BP (breakpoint)</li>
</ul>

<p>where:<br/>


<math display="block" id="Segmented_regression:2">
 <semantics>
  <mrow>
   <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
   <msup>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>y</mi>
      <mo>-</mo>
      <msub>
       <mi>Y</mi>
       <mi>r</mi>
      </msub>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
    <mn>2</mn>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <sum></sum>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <minus></minus>
      <ci>y</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>Y</ci>
       <ci>r</ci>
      </apply>
     </apply>
     <cn type="integer">2</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \sum(y-Y_{r})^{2}
  </annotation>
 </semantics>
</math>

 is the minimized SSD per segment and</p>
<dl>
<dd><big>Y<sub>a1</sub></big> and <big>Y<sub>a2</sub></big> are the average values of <strong>y</strong> in the respective segments.
</dd>
</dl>

<p>In the determination of the most suitable trend, <a href="statistical_tests" title="wikilink">statistical tests</a> must be performed to ensure that this trend is reliable (significant).</p>

<p>When no significant breakpoint can be detected, one must fall back on a regression without breakpoint.</p>
<h2 id="example">Example</h2>

<p> For the blue figure at the right that gives the relation between yield of mustard (Yr = Ym, t/ha) and soil salinity (<strong>x</strong> = Ss, expressed as electric conductivity of the soil solution EC in dS/m) it is found that:<a class="footnoteRef" href="#fn3" id="fnref3"><sup>3</sup></a></p>

<p>BP = 4.93, A<sub>1</sub> = 0, K<sub>1</sub> = 1.74, A<sub>2</sub> = −0.129, K<sub>2</sub> = 2.38, R<sub>1</sub><sup>2</sup> = 0.0035 (insignificant), R<sub>2</sub><sup>2</sup> = 0.395 (significant) and:</p>
<ul>
<li>Ym = 1.74 t/ha                        for Ss &lt; 4.93 (breakpoint)</li>
<li>Ym = −0.129 Ss + 2.38 t/ha     for Ss &gt; 4.93 (breakpoint)</li>
</ul>

<p>indicating that soil salinities  4.93 dS/m reduce the yield @ 0.129 t/ha per unit increase of soil salinity.</p>

<p>The figure also shows confidence intervals and uncertainty as elaborated hereunder.</p>
<h2 id="test-procedures">Test procedures</h2>

<p>  The following <em>statistical tests</em> are used to determine the type of trend:</p>
<ol>
<li>significance of the breakpoint (BP) by expressing BP as a function of <em>regression coefficients</em> A<sub>1</sub> and A<sub>2</sub> and the means Y<sub>1</sub> and Y<sub>2</sub> of the <strong>y</strong>-data and the means X<sub>1</sub> and X<sub>2</sub> of the <strong>x</strong> data (left and an right of BP), using the laws of <a href="propagation_of_uncertainty" title="wikilink">propagation of errors</a> in additions and multiplications to compute the <a href="standard_error" title="wikilink">standard error</a> (SE) of BP, and applying <a href="Student's_t-test" title="wikilink">Student's t-test</a></li>
<li>significance of A<sub>1</sub> and A<sub>2</sub> applying Student's t-distribution and the <em>standard error</em> SE of A<sub>1</sub> and A<sub>2</sub></li>
<li>significance of the difference of A<sub>1</sub> and A<sub>2</sub> applying Student's t-distribution using the SE of their difference.</li>
<li>significance of the difference of Y<sub>1</sub> and Y<sub>2</sub> applying Student's t-distribution using the SE of their difference.</li>
</ol>

<p>In addition, use is made of the <a href="Pearson_product-moment_correlation_coefficient" title="wikilink">correlation coefficient</a> of all data (Ra), the <a href="coefficient_of_determination" title="wikilink">coefficient of determination</a> or coefficient of explanation, <a href="confidence_interval" title="wikilink">confidence intervals</a> of the regression functions, and <a class="uri" href="Anova" title="wikilink">Anova</a> analysis.<a class="footnoteRef" href="#fn4" id="fnref4"><sup>4</sup></a></p>

<p>The coefficient of determination for all data (Cd), that is to be maximized under the conditions set by the significance tests, is found from:</p>
<ul>
<li>

<math display="inline" id="Segmented_regression:3">
 <semantics>
  <mrow>
   <msub>
    <mi>C</mi>
    <mi>d</mi>
   </msub>
   <mo>=</mo>
   <mrow>
    <mn>1</mn>
    <mo>-</mo>
    <mfrac>
     <mrow>
      <mo largeop="true" symmetric="true">∑</mo>
      <msup>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mi>y</mi>
         <mo>-</mo>
         <msub>
          <mi>Y</mi>
          <mi>r</mi>
         </msub>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
       <mn>2</mn>
      </msup>
     </mrow>
     <mstyle scriptlevel="-1">
      <mrow>
       <mo largeop="true" symmetric="true">∑</mo>
       <msup>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <mi>y</mi>
          <mo>-</mo>
          <msub>
           <mi>Y</mi>
           <mi>a</mi>
          </msub>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
        <mn>2</mn>
       </msup>
      </mrow>
     </mstyle>
    </mfrac>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>C</ci>
     <ci>d</ci>
    </apply>
    <apply>
     <minus></minus>
     <cn type="integer">1</cn>
     <apply>
      <divide></divide>
      <apply>
       <sum></sum>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <minus></minus>
         <ci>y</ci>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>Y</ci>
          <ci>r</ci>
         </apply>
        </apply>
        <cn type="integer">2</cn>
       </apply>
      </apply>
      <apply>
       <sum></sum>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <minus></minus>
         <ci>y</ci>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>Y</ci>
          <ci>a</ci>
         </apply>
        </apply>
        <cn type="integer">2</cn>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   C_{d}=1-{\sum(y-Y_{r})^{2}\over\sum(y-Y_{a})^{2}}
  </annotation>
 </semantics>
</math>

</li>
</ul>

<p>where Yr is the expected (predicted) value of <strong>y</strong> according to the former regression equations and Ya is the average of all <strong>y</strong> values.</p>

<p>The Cd coefficient ranges between 0 (no explanation at all) to 1 (full explanation, perfect match).<br/>
In a pure, unsegmented, linear regression, the values of Cd and Ra<sup>2</sup> are equal. In a segmented regression, Cd needs to be significantly larger than Ra<sup>2</sup> to justify the segmentation.</p>

<p>The <a href="Optimization_(mathematics)" title="wikilink">optimal</a> value of the breakpoint may be found such that the Cd coefficient is <a href="Maxima_and_minima" title="wikilink">maximum</a>.</p>
<h2 id="see-also">See also</h2>
<ul>
<li><a href="Simple_regression" title="wikilink">Simple regression</a></li>
<li><a href="Linear_regression" title="wikilink">Linear regression</a></li>
<li><a href="Ordinary_least_squares" title="wikilink">Ordinary least squares</a></li>
<li><a href="Multivariate_adaptive_regression_splines" title="wikilink">Multivariate adaptive regression splines</a></li>
<li><a href="Local_regression" title="wikilink">Local regression</a></li>
<li><a href="Regression_discontinuity_design" title="wikilink">Regression discontinuity design</a></li>
<li><a href="SegReg" title="wikilink">SegReg (software)</a> for segmented regression</li>
</ul>
<h2 id="references">References</h2>
<references>
</references>

<p>"</p>

<p><a href="Category:Regression_analysis" title="wikilink">Category:Regression analysis</a> <a href="Category:Statistical_models" title="wikilink">Category:Statistical models</a> <a href="Category:Data_analysis" title="wikilink">Category:Data analysis</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1"><em>Frequency and Regression Analysis</em>. Chapter 6 in: H.P.Ritzema (ed., 1994), <em>Drainage Principles and Applications</em>, Publ. 16, pp. 175-224, International Institute for Land Reclamation and Improvement (ILRI), Wageningen, The Netherlands. ISBN 90-70754-33-9 . Free download from the webpage <a href="http://www.waterlog.info/articles.htm">1</a> , under nr. 13, or directly as PDF : <a href="http://www.waterlog.info/pdf/regtxt.pdf">2</a><a href="#fnref1">↩</a></li>
<li id="fn2">'' Drainage research in farmers' fields: analysis of data''. Part of project “Liquid Gold” of the International Institute for Land Reclamation and Improvement (ILRI), Wageningen, The Netherlands. Download as PDF : <a href="http://www.waterlog.info/pdf/analysis.pdf">3</a><a href="#fnref2">↩</a></li>
<li id="fn3">R.J.Oosterbaan, D.P.Sharma, K.N.Singh and K.V.G.K.Rao, 1990, <em>Crop production and soil salinity: evaluation of field data from India by segmented linear regression</em>. In: Proceedings of the Symposium on Land Drainage for Salinity Control in Arid and Semi-Arid Regions, February 25th to March 2nd, 1990, Cairo, Egypt, Vol. 3, Session V, p. 373 - 383.<a href="#fnref3">↩</a></li>
<li id="fn4"><em>Statistical significance of segmented linear regression with break-point using variance analysis and F-tests</em>. Download from <a href="http://www.waterlog.info/faqs.htm">4</a> under nr. 13, or directly as PDF : <a href="http://www.waterlog.info/pdf/anova.pdf">5</a><a href="#fnref4">↩</a></li>
</ol>
</section>
</body>
</html>

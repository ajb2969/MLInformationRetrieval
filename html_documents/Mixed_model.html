<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="284">Mixed model</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Mixed model</h1>
<hr/>

<p>A <strong>mixed model</strong> is a <a href="statistical_model" title="wikilink">statistical model</a> containing both <a href="fixed_effect" title="wikilink">fixed effects</a> and <a href="random_effect" title="wikilink">random effects</a>. These models are useful in a wide variety of disciplines in the physical, biological and social sciences. They are particularly useful in settings where <a href="repeated_measures_design" title="wikilink">repeated measurements</a> are made on the same <a href="statistical_unit" title="wikilink">statistical units</a> (<a href="longitudinal_study" title="wikilink">longitudinal study</a>), or where measurements are made on clusters of related statistical units. Because of their advantage in dealing with missing values, mixed effects models are often preferred over more traditional approaches such as repeated measures <a class="uri" href="ANOVA" title="wikilink">ANOVA</a>.</p>
<h2 id="history-and-current-status">History and current status</h2>

<p><a href="Ronald_Fisher" title="wikilink">Ronald Fisher</a> introduced <a href="random_effects_model" title="wikilink">random effects models</a> to study the correlations of trait values between relatives.<a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a> In the 1950s, <a href="Charles_Roy_Henderson" title="wikilink">Charles Roy Henderson</a> provided <a href="Gauss–Markov_theorem" title="wikilink">best linear unbiased estimates</a> (BLUE) of fixed effects and <a href="best_linear_unbiased_prediction" title="wikilink">best linear unbiased predictions</a> (BLUP) of random effects.<a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a><a class="footnoteRef" href="#fn3" id="fnref3"><sup>3</sup></a><a class="footnoteRef" href="#fn4" id="fnref4"><sup>4</sup></a><a class="footnoteRef" href="#fn5" id="fnref5"><sup>5</sup></a> Subsequently, mixed modeling has become a major area of statistical research, including work on computation of maximum likelihood estimates, non-linear mixed effect models, missing data in mixed effects models, and <a href="Bayesian_statistics" title="wikilink">Bayesian</a> estimation of mixed effects models. Mixed models are applied in many disciplines where multiple correlated measurements are made on each unit of interest. They are prominently used in research involving human and animal subjects in fields ranging from genetics to marketing, and have also been used in industrial statistics.</p>
<h2 id="definition">Definition</h2>

<p>In <a href="Matrix_notation#Notation" title="wikilink">matrix notation</a> a mixed model can be represented as</p>

<p>

<math display="block" id="Mixed_model:0">
 <semantics>
  <mrow>
   <mi>𝒚</mi>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mi>X</mi>
     <mi>𝜷</mi>
    </mrow>
    <mo>+</mo>
    <mrow>
     <mi>Z</mi>
     <mi>𝒖</mi>
    </mrow>
    <mo>+</mo>
    <mi mathvariant="bold-italic">ϵ</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>𝒚</ci>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <ci>X</ci>
      <ci>𝜷</ci>
     </apply>
     <apply>
      <times></times>
      <ci>Z</ci>
      <ci>𝒖</ci>
     </apply>
     <ci>bold-italic-ϵ</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \boldsymbol{y}=X\boldsymbol{\beta}+Z\boldsymbol{u}+\boldsymbol{\epsilon}
  </annotation>
 </semantics>
</math>

</p>

<p>where</p>
<ul>
<li>

<math display="inline" id="Mixed_model:1">
 <semantics>
  <mi>𝒚</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>𝒚</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \boldsymbol{y}
  </annotation>
 </semantics>
</math>

 is a known vector of observations, with mean 

<math display="inline" id="Mixed_model:2">
 <semantics>
  <mrow>
   <mrow>
    <mi>E</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>𝒚</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mi>X</mi>
    <mi>𝜷</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>E</ci>
     <ci>𝒚</ci>
    </apply>
    <apply>
     <times></times>
     <ci>X</ci>
     <ci>𝜷</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   E(\boldsymbol{y})=X\boldsymbol{\beta}
  </annotation>
 </semantics>
</math>

;</li>
</ul>
<ul>
<li>

<math display="inline" id="Mixed_model:3">
 <semantics>
  <mi>𝜷</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>𝜷</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \boldsymbol{\beta}
  </annotation>
 </semantics>
</math>

 is an unknown vector of fixed effects;</li>
</ul>
<ul>
<li>

<math display="inline" id="Mixed_model:4">
 <semantics>
  <mi>𝒖</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>𝒖</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \boldsymbol{u}
  </annotation>
 </semantics>
</math>

 is an unknown vector of random effects, with mean 

<math display="inline" id="Mixed_model:5">
 <semantics>
  <mrow>
   <mrow>
    <mi>E</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>𝒖</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mn>𝟎</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>E</ci>
     <ci>𝒖</ci>
    </apply>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   E(\boldsymbol{u})=\boldsymbol{0}
  </annotation>
 </semantics>
</math>


 and <a href="Covariance_matrix" title="wikilink">variance-covariance matrix</a> 

<math display="inline" id="Mixed_model:6">
 <semantics>
  <mrow>
   <mrow>
    <mo>var</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>𝒖</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mi>G</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <ci>var</ci>
     <ci>𝒖</ci>
    </apply>
    <ci>G</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \operatorname{var}(\boldsymbol{u})=G
  </annotation>
 </semantics>
</math>

;</li>
</ul>
<ul>
<li>

<math display="inline" id="Mixed_model:7">
 <semantics>
  <mi mathvariant="bold-italic">ϵ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>bold-italic-ϵ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \boldsymbol{\epsilon}
  </annotation>
 </semantics>
</math>

 is an unknown vector of random errors, with mean 

<math display="inline" id="Mixed_model:8">
 <semantics>
  <mrow>
   <mrow>
    <mi>E</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi mathvariant="bold-italic">ϵ</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mn>𝟎</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>E</ci>
     <ci>bold-italic-ϵ</ci>
    </apply>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   E(\boldsymbol{\epsilon})=\boldsymbol{0}
  </annotation>
 </semantics>
</math>

 and variance 

<math display="inline" id="Mixed_model:9">
 <semantics>
  <mrow>
   <mrow>
    <mo>var</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi mathvariant="bold-italic">ϵ</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mi>R</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <ci>var</ci>
     <ci>bold-italic-ϵ</ci>
    </apply>
    <ci>R</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \operatorname{var}(\boldsymbol{\epsilon})=R
  </annotation>
 </semantics>
</math>

;</li>
</ul>
<ul>
<li>

<math display="inline" id="Mixed_model:10">
 <semantics>
  <mi>X</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>X</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   X
  </annotation>
 </semantics>
</math>


 and 

<math display="inline" id="Mixed_model:11">
 <semantics>
  <mi>Z</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>Z</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Z
  </annotation>
 </semantics>
</math>

 are known <a href="Design_matrix" title="wikilink">design matrices</a> relating the observations 

<math display="inline" id="Mixed_model:12">
 <semantics>
  <mi>𝒚</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>𝒚</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \boldsymbol{y}
  </annotation>
 </semantics>
</math>

 to 

<math display="inline" id="Mixed_model:13">
 <semantics>
  <mi>𝜷</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>𝜷</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \boldsymbol{\beta}
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Mixed_model:14">
 <semantics>
  <mi>𝒖</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>𝒖</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \boldsymbol{u}
  </annotation>
 </semantics>
</math>

, respectively.</li>
</ul>
<h2 id="estimation">Estimation</h2>

<p>The joint density of 

<math display="inline" id="Mixed_model:15">
 <semantics>
  <mi>𝒚</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>𝒚</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \boldsymbol{y}
  </annotation>
 </semantics>
</math>


 and 

<math display="inline" id="Mixed_model:16">
 <semantics>
  <mi>𝒖</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>𝒖</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \boldsymbol{u}
  </annotation>
 </semantics>
</math>

 can be written as

<math display="block" id="Mixed_model:17">
 <semantics>
  <mrow>
   <mi>f</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>𝒚</mi>
    <mo>,</mo>
    <mi>𝒖</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>=</mo>
   <mi>f</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>𝒚</mi>
    <mo stretchy="false">|</mo>
    <mi>𝒖</mi>
    <mo rspace="4.2pt" stretchy="false">)</mo>
   </mrow>
   <mi>f</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>𝒖</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">f</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">y</csymbol>
     <ci>normal-,</ci>
     <csymbol cd="unknown">u</csymbol>
     <ci>normal-)</ci>
    </cerror>
    <eq></eq>
    <csymbol cd="unknown">f</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">y</csymbol>
     <ci>normal-|</ci>
     <csymbol cd="unknown">u</csymbol>
     <ci>normal-)</ci>
    </cerror>
    <csymbol cd="unknown">f</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">u</csymbol>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f(\boldsymbol{y},\boldsymbol{u})=f(\boldsymbol{y}|\boldsymbol{u})\,f(%
\boldsymbol{u})
  </annotation>
 </semantics>
</math>

. Assuming normality, 

<math display="inline" id="Mixed_model:18">
 <semantics>
  <mrow>
   <mi>𝒖</mi>
   <mo>∼</mo>
   <mrow>
    <mi class="ltx_font_mathcaligraphic">𝒩</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mn>𝟎</mn>
     <mo>,</mo>
     <mi>G</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">similar-to</csymbol>
    <ci>𝒖</ci>
    <apply>
     <times></times>
     <ci>𝒩</ci>
     <interval closure="open">
      <cn type="integer">0</cn>
      <ci>G</ci>
     </interval>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \boldsymbol{u}\sim\mathcal{N}(\boldsymbol{0},G)
  </annotation>
 </semantics>
</math>

, 

<math display="inline" id="Mixed_model:19">
 <semantics>
  <mrow>
   <mi mathvariant="bold-italic">ϵ</mi>
   <mo>∼</mo>
   <mrow>
    <mi class="ltx_font_mathcaligraphic">𝒩</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mn>𝟎</mn>
     <mo>,</mo>
     <mi>R</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">similar-to</csymbol>
    <ci>bold-italic-ϵ</ci>
    <apply>
     <times></times>
     <ci>𝒩</ci>
     <interval closure="open">
      <cn type="integer">0</cn>
      <ci>R</ci>
     </interval>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \boldsymbol{\epsilon}\sim\mathcal{N}(\boldsymbol{0},R)
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Mixed_model:20">
 <semantics>
  <mrow>
   <mrow>
    <mi>C</mi>
    <mi>o</mi>
    <mi>v</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>𝒖</mi>
     <mo>,</mo>
     <mi mathvariant="bold-italic">ϵ</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mn>𝟎</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>C</ci>
     <ci>o</ci>
     <ci>v</ci>
     <interval closure="open">
      <ci>𝒖</ci>
      <ci>bold-italic-ϵ</ci>
     </interval>
    </apply>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Cov(\boldsymbol{u},\boldsymbol{\epsilon})=\boldsymbol{0}
  </annotation>
 </semantics>
</math>


, and maximizing the joint density for 

<math display="inline" id="Mixed_model:21">
 <semantics>
  <mi>𝜷</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>𝜷</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \boldsymbol{\beta}
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Mixed_model:22">
 <semantics>
  <mi>𝒖</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>𝒖</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \boldsymbol{u}
  </annotation>
 </semantics>
</math>

, gives Henderson's "mixed model equations" (MME):<a class="footnoteRef" href="#fn6" id="fnref6"><sup>6</sup></a><a class="footnoteRef" href="#fn7" id="fnref7"><sup>7</sup></a><a class="footnoteRef" href="#fn8" id="fnref8"><sup>8</sup></a></p>

<p>

<math display="block" id="Mixed_model:23">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mo>(</mo>
     <mtable displaystyle="true">
      <mtr>
       <mtd columnalign="center">
        <mrow>
         <msup>
          <mi>X</mi>
          <mo>′</mo>
         </msup>
         <msup>
          <mi>R</mi>
          <mrow>
           <mo>-</mo>
           <mn>1</mn>
          </mrow>
         </msup>
         <mi>X</mi>
        </mrow>
       </mtd>
       <mtd columnalign="center">
        <mrow>
         <msup>
          <mi>X</mi>
          <mo>′</mo>
         </msup>
         <msup>
          <mi>R</mi>
          <mrow>
           <mo>-</mo>
           <mn>1</mn>
          </mrow>
         </msup>
         <mi>Z</mi>
        </mrow>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mrow>
         <msup>
          <mi>Z</mi>
          <mo>′</mo>
         </msup>
         <msup>
          <mi>R</mi>
          <mrow>
           <mo>-</mo>
           <mn>1</mn>
          </mrow>
         </msup>
         <mi>X</mi>
        </mrow>
       </mtd>
       <mtd columnalign="center">
        <mrow>
         <mrow>
          <msup>
           <mi>Z</mi>
           <mo>′</mo>
          </msup>
          <msup>
           <mi>R</mi>
           <mrow>
            <mo>-</mo>
            <mn>1</mn>
           </mrow>
          </msup>
          <mi>Z</mi>
         </mrow>
         <mo>+</mo>
         <msup>
          <mi>G</mi>
          <mrow>
           <mo>-</mo>
           <mn>1</mn>
          </mrow>
         </msup>
        </mrow>
       </mtd>
      </mtr>
     </mtable>
     <mo>)</mo>
    </mrow>
    <mrow>
     <mo>(</mo>
     <mtable displaystyle="true">
      <mtr>
       <mtd columnalign="center">
        <mover accent="true">
         <mi>𝜷</mi>
         <mo stretchy="false">^</mo>
        </mover>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mover accent="true">
         <mi>𝒖</mi>
         <mo stretchy="false">^</mo>
        </mover>
       </mtd>
      </mtr>
     </mtable>
     <mo>)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mo>(</mo>
    <mtable displaystyle="true">
     <mtr>
      <mtd columnalign="center">
       <mrow>
        <msup>
         <mi>X</mi>
         <mo>′</mo>
        </msup>
        <msup>
         <mi>R</mi>
         <mrow>
          <mo>-</mo>
          <mn>1</mn>
         </mrow>
        </msup>
        <mi>𝒚</mi>
       </mrow>
      </mtd>
     </mtr>
     <mtr>
      <mtd columnalign="center">
       <mrow>
        <msup>
         <mi>Z</mi>
         <mo>′</mo>
        </msup>
        <msup>
         <mi>R</mi>
         <mrow>
          <mo>-</mo>
          <mn>1</mn>
         </mrow>
        </msup>
        <mi>𝒚</mi>
       </mrow>
      </mtd>
     </mtr>
    </mtable>
    <mo>)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <matrix>
      <matrixrow>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>X</ci>
         <ci>normal-′</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>R</ci>
         <apply>
          <minus></minus>
          <cn type="integer">1</cn>
         </apply>
        </apply>
        <ci>X</ci>
       </apply>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>X</ci>
         <ci>normal-′</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>R</ci>
         <apply>
          <minus></minus>
          <cn type="integer">1</cn>
         </apply>
        </apply>
        <ci>Z</ci>
       </apply>
      </matrixrow>
      <matrixrow>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>Z</ci>
         <ci>normal-′</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>R</ci>
         <apply>
          <minus></minus>
          <cn type="integer">1</cn>
         </apply>
        </apply>
        <ci>X</ci>
       </apply>
       <apply>
        <plus></plus>
        <apply>
         <times></times>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>Z</ci>
          <ci>normal-′</ci>
         </apply>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>R</ci>
          <apply>
           <minus></minus>
           <cn type="integer">1</cn>
          </apply>
         </apply>
         <ci>Z</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>G</ci>
         <apply>
          <minus></minus>
          <cn type="integer">1</cn>
         </apply>
        </apply>
       </apply>
      </matrixrow>
     </matrix>
     <matrix>
      <matrixrow>
       <apply>
        <ci>normal-^</ci>
        <ci>𝜷</ci>
       </apply>
      </matrixrow>
      <matrixrow>
       <apply>
        <ci>normal-^</ci>
        <ci>𝒖</ci>
       </apply>
      </matrixrow>
     </matrix>
    </apply>
    <matrix>
     <matrixrow>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>X</ci>
        <ci>normal-′</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>R</ci>
        <apply>
         <minus></minus>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <ci>𝒚</ci>
      </apply>
     </matrixrow>
     <matrixrow>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>Z</ci>
        <ci>normal-′</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>R</ci>
        <apply>
         <minus></minus>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <ci>𝒚</ci>
      </apply>
     </matrixrow>
    </matrix>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \begin{pmatrix}X^{\prime}R^{-1}X&X^{\prime}R^{-1}Z\\
Z^{\prime}R^{-1}X&Z^{\prime}R^{-1}Z+G^{-1}\end{pmatrix}\begin{pmatrix}\hat{%
\boldsymbol{\beta}}\\
\hat{\boldsymbol{u}}\end{pmatrix}=\begin{pmatrix}X^{\prime}R^{-1}\boldsymbol{y%
}\\
Z^{\prime}R^{-1}\boldsymbol{y}\end{pmatrix}
  </annotation>
 </semantics>
</math>

</p>

<p>The solutions to the MME, 

<math display="inline" id="Mixed_model:24">
 <semantics>
  <mover accent="true">
   <mi>𝜷</mi>
   <mo stretchy="false">^</mo>
  </mover>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-^</ci>
    <ci>𝜷</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \textstyle\hat{\boldsymbol{\beta}}
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Mixed_model:25">
 <semantics>
  <mover accent="true">
   <mi>𝒖</mi>
   <mo stretchy="false">^</mo>
  </mover>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-^</ci>
    <ci>𝒖</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \textstyle\hat{\boldsymbol{u}}
  </annotation>
 </semantics>
</math>

 are best linear unbiased estimates (BLUE) and predictors (BLUP) for 

<math display="inline" id="Mixed_model:26">
 <semantics>
  <mi>𝜷</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>𝜷</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \boldsymbol{\beta}
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Mixed_model:27">
 <semantics>
  <mi>𝒖</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>𝒖</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \boldsymbol{u}
  </annotation>
 </semantics>
</math>

, respectively. This is a consequence of the <a href="Gauss–Markov_theorem" title="wikilink">Gauss-Markov theorem</a> when the conditional variance of the outcome is not scalable to the identity matrix. When the conditional variance is known, then the inverse variance weighted least squares estimate is BLUE. However, the conditional variance is rarely, if ever, known. So it is desirable to jointly estimate the variance and weighted parameter estimates when solving MMEs.</p>

<p>One method used to fit such mixed models is that of the <a href="EM_algorithm" title="wikilink">EM algorithm</a><a class="footnoteRef" href="#fn9" id="fnref9"><sup>9</sup></a> where the variance components are treated as unobserved <a href="nuisance_parameter" title="wikilink">nuisance parameters</a> in the joint likelihood. Currently, this is the implemented method for the major statistical software packages <a href="R_(programming_language)" title="wikilink">R</a> (lme in the nlme library) and <a href="SAS_(software)" title="wikilink">SAS</a> (proc mixed). The solution to the mixed model equations is a maximum likelihood estimate when the distribution of the errors is normal.<a class="footnoteRef" href="#fn10" id="fnref10"><sup>10</sup></a><a class="footnoteRef" href="#fn11" id="fnref11"><sup>11</sup></a></p>
<h2 id="see-also">See also</h2>
<ul>
<li><a href="Fixed_effects_model" title="wikilink">Fixed effects model</a></li>
<li><a href="Generalized_linear_mixed_model" title="wikilink">Generalized linear mixed model</a></li>
<li><a href="Linear_regression" title="wikilink">Linear regression</a></li>
<li><a href="Mixed-design_analysis_of_variance" title="wikilink">Mixed-design analysis of variance</a></li>
<li><a href="Multilevel_model" title="wikilink">Multilevel model</a></li>
<li><a href="Random_effects_model" title="wikilink">Random effects model</a></li>
<li><a href="Repeated_measures_design" title="wikilink">Repeated measures design</a></li>
</ul>
<h2 id="references">References</h2>
<h2 id="further-reading">Further reading</h2>
<ul>
<li>Milliken, G. A., &amp; Johnson, D. E. (1992). <em>Analysis of messy data: Vol. I. Designed experiments</em>. New York: Chapman &amp; Hall.</li>
</ul>
<ul>
<li>West, B. T., Welch, K. B., &amp; Galecki, A. T. (2007). Linear mixed models: A practical guide using statistical software. New York: Chapman &amp; Hall/CRC.</li>
</ul>
<h2 id="commercial">Commercial</h2>
<ul>
<li><a href="NCSS_(statistical_software)" title="wikilink">NCSS (statistical software)</a> includes longitudinal mixed models analysis.</li>
</ul>

<p>"</p>

<p><a href="Category:Statistical_methods" title="wikilink">Category:Statistical methods</a> <a href="Category:Regression_analysis" title="wikilink">Category:Regression analysis</a> <a href="Category:Analysis_of_variance" title="wikilink">Category:Analysis of variance</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1"><a href="#fnref1">↩</a></li>
<li id="fn2"><a href="#fnref2">↩</a></li>
<li id="fn3"><a href="#fnref3">↩</a></li>
<li id="fn4"><a href="#fnref4">↩</a></li>
<li id="fn5"><a href="#fnref5">↩</a></li>
<li id="fn6"><a href="#fnref6">↩</a></li>
<li id="fn7"></li>
<li id="fn8"></li>
<li id="fn9"><a href="#fnref9">↩</a></li>
<li id="fn10"><a href="#fnref10">↩</a></li>
<li id="fn11"><a href="Garrett_M._Fitzmaurice" title="wikilink">Garrett M. Fitzmaurice</a>, <a href="Nan_M._Laird" title="wikilink">Nan M. Laird</a>, and <a href="James_H._Ware" title="wikilink">James H. Ware</a>, 2004. <em><a href="Applied_Longitudinal_Analysis_(textbook)" title="wikilink">Applied Longitudinal Analysis</a></em>. John Wiley &amp; Sons, Inc., p. 326-328.<a href="#fnref11">↩</a></li>
</ol>
</section>
</body>
</html>

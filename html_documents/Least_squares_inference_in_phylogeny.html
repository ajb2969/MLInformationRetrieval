<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="825">Least squares inference in phylogeny</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Least squares inference in phylogeny</h1>
<hr/>

<p><strong>Least squares inference in phylogeny</strong> generates a <a href="phylogenetic_tree" title="wikilink">phylogenetic tree</a> based on an observed matrix of pairwise <a href="genetic_distance" title="wikilink">genetic distances</a> and optionally a weight matrix. The goal is to find a tree which satisfies the distance constraints as best as possible.</p>
<h2 id="ordinary-and-weighted-least-squares">Ordinary and weighted least squares</h2>

<p>The discrepancy between the observed pairwise distances 

<math display="inline" id="Least_squares_inference_in_phylogeny:0">
 <semantics>
  <msub>
   <mi>D</mi>
   <mrow>
    <mi>i</mi>
    <mi>j</mi>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>D</ci>
    <apply>
     <times></times>
     <ci>i</ci>
     <ci>j</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   D_{ij}
  </annotation>
 </semantics>
</math>

 and the distances 

<math display="inline" id="Least_squares_inference_in_phylogeny:1">
 <semantics>
  <msub>
   <mi>T</mi>
   <mrow>
    <mi>i</mi>
    <mi>j</mi>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>T</ci>
    <apply>
     <times></times>
     <ci>i</ci>
     <ci>j</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   T_{ij}
  </annotation>
 </semantics>
</math>

 over a phylogenetic tree (i.e. the sum of the branch lengths in the path from leaf 

<math display="inline" id="Least_squares_inference_in_phylogeny:2">
 <semantics>
  <mi>i</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>i</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   i
  </annotation>
 </semantics>
</math>

 to leaf 

<math display="inline" id="Least_squares_inference_in_phylogeny:3">
 <semantics>
  <mi>j</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>j</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   j
  </annotation>
 </semantics>
</math>


) is measured by</p>

<p>

<math display="block" id="Least_squares_inference_in_phylogeny:4">
 <semantics>
  <mrow>
   <mi>S</mi>
   <mo>=</mo>
   <mrow>
    <munder>
     <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
     <mrow>
      <mi>i</mi>
      <mi>j</mi>
     </mrow>
    </munder>
    <mrow>
     <msub>
      <mi>w</mi>
      <mrow>
       <mi>i</mi>
       <mi>j</mi>
      </mrow>
     </msub>
     <msup>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <msub>
         <mi>D</mi>
         <mrow>
          <mi>i</mi>
          <mi>j</mi>
         </mrow>
        </msub>
        <mo>-</mo>
        <msub>
         <mi>T</mi>
         <mrow>
          <mi>i</mi>
          <mi>j</mi>
         </mrow>
        </msub>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
      <mn>2</mn>
     </msup>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>S</ci>
    <apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <sum></sum>
      <apply>
       <times></times>
       <ci>i</ci>
       <ci>j</ci>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>w</ci>
       <apply>
        <times></times>
        <ci>i</ci>
        <ci>j</ci>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <minus></minus>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>D</ci>
         <apply>
          <times></times>
          <ci>i</ci>
          <ci>j</ci>
         </apply>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>T</ci>
         <apply>
          <times></times>
          <ci>i</ci>
          <ci>j</ci>
         </apply>
        </apply>
       </apply>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   S=\sum_{ij}w_{ij}(D_{ij}-T_{ij})^{2}
  </annotation>
 </semantics>
</math>

 where the weights 

<math display="inline" id="Least_squares_inference_in_phylogeny:5">
 <semantics>
  <msub>
   <mi>w</mi>
   <mrow>
    <mi>i</mi>
    <mi>j</mi>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>w</ci>
    <apply>
     <times></times>
     <ci>i</ci>
     <ci>j</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   w_{ij}
  </annotation>
 </semantics>
</math>

 depend on the least squares method used. Least squares distance tree construction aims to find the tree (topology and branch lengths) with minimal S. This is a non-trivial problem. It involves searching the discrete space of unrooted binary tree topologies whose size is exponential in the number of leaves. For n leaves there are 1 • 3 • 5 • ... • (2n-3) different topologies. Enumerating them is not feasible already for a small number of leaves. Heuristic search methods are used to find a reasonably good topology. The evaluation of S for a given topology (which includes the computation of the branch lengths) is a <a href="linear_least_squares_(mathematics)" title="wikilink">linear least squares</a> problem. There are several ways to weight the squared errors 

<math display="inline" id="Least_squares_inference_in_phylogeny:6">
 <semantics>
  <msup>
   <mrow>
    <mo stretchy="false">(</mo>
    <mrow>
     <msub>
      <mi>D</mi>
      <mrow>
       <mi>i</mi>
       <mi>j</mi>
      </mrow>
     </msub>
     <mo>-</mo>
     <msub>
      <mi>T</mi>
      <mrow>
       <mi>i</mi>
       <mi>j</mi>
      </mrow>
     </msub>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
   <mn>2</mn>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <apply>
     <minus></minus>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>D</ci>
      <apply>
       <times></times>
       <ci>i</ci>
       <ci>j</ci>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>T</ci>
      <apply>
       <times></times>
       <ci>i</ci>
       <ci>j</ci>
      </apply>
     </apply>
    </apply>
    <cn type="integer">2</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (D_{ij}-T_{ij})^{2}
  </annotation>
 </semantics>
</math>

, depending on the knowledge and assumptions about the variances of the observed distances. When nothing is known about the errors, or if they are assumed to be independently distributed and equal for all observed distances, then all the weights 

<math display="inline" id="Least_squares_inference_in_phylogeny:7">
 <semantics>
  <msub>
   <mi>w</mi>
   <mrow>
    <mi>i</mi>
    <mi>j</mi>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>w</ci>
    <apply>
     <times></times>
     <ci>i</ci>
     <ci>j</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   w_{ij}
  </annotation>
 </semantics>
</math>

 are set to one. This leads to an ordinary least squares estimate. In the weighted least squares case the errors are assumed to be independent (or their correlations are not known). Given independent errors, a particular weight should ideally be set to the inverse of the variance of the corresponding distance estimate. Sometimes the variances may not be known, but they can be modeled as a function of the distance estimates. In the Fitch and Margoliash method <a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a> for instance it is assumed that the variances are proportional to the squared distances.</p>
<h2 id="generalized-least-squares">Generalized least squares</h2>

<p>The ordinary and weighted least squares methods described above assume independent distance estimates. If the distances are derived from genomic data their estimates covary, because evolutionary events on internal branches (of the true tree) can push several distances up or down at the same time. The resulting covariances can be taken into account using the method of generalized least squares, i.e. minimizing the following quantity</p>

<p>

<math display="block" id="Least_squares_inference_in_phylogeny:8">
 <semantics>
  <mrow>
   <munder>
    <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
    <mrow>
     <mrow>
      <mi>i</mi>
      <mi>j</mi>
     </mrow>
     <mo>,</mo>
     <mrow>
      <mi>k</mi>
      <mi>l</mi>
     </mrow>
    </mrow>
   </munder>
   <mrow>
    <msub>
     <mi>w</mi>
     <mrow>
      <mrow>
       <mi>i</mi>
       <mi>j</mi>
      </mrow>
      <mo>,</mo>
      <mrow>
       <mi>k</mi>
       <mi>l</mi>
      </mrow>
     </mrow>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <msub>
       <mi>D</mi>
       <mrow>
        <mi>i</mi>
        <mi>j</mi>
       </mrow>
      </msub>
      <mo>-</mo>
      <msub>
       <mi>T</mi>
       <mrow>
        <mi>i</mi>
        <mi>j</mi>
       </mrow>
      </msub>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <msub>
       <mi>D</mi>
       <mrow>
        <mi>k</mi>
        <mi>l</mi>
       </mrow>
      </msub>
      <mo>-</mo>
      <msub>
       <mi>T</mi>
       <mrow>
        <mi>k</mi>
        <mi>l</mi>
       </mrow>
      </msub>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <sum></sum>
     <list>
      <apply>
       <times></times>
       <ci>i</ci>
       <ci>j</ci>
      </apply>
      <apply>
       <times></times>
       <ci>k</ci>
       <ci>l</ci>
      </apply>
     </list>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>w</ci>
      <list>
       <apply>
        <times></times>
        <ci>i</ci>
        <ci>j</ci>
       </apply>
       <apply>
        <times></times>
        <ci>k</ci>
        <ci>l</ci>
       </apply>
      </list>
     </apply>
     <apply>
      <minus></minus>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>D</ci>
       <apply>
        <times></times>
        <ci>i</ci>
        <ci>j</ci>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>T</ci>
       <apply>
        <times></times>
        <ci>i</ci>
        <ci>j</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <minus></minus>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>D</ci>
       <apply>
        <times></times>
        <ci>k</ci>
        <ci>l</ci>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>T</ci>
       <apply>
        <times></times>
        <ci>k</ci>
        <ci>l</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \sum_{ij,kl}w_{ij,kl}(D_{ij}-T_{ij})(D_{kl}-T_{kl})
  </annotation>
 </semantics>
</math>

 where 

<math display="inline" id="Least_squares_inference_in_phylogeny:9">
 <semantics>
  <msub>
   <mi>w</mi>
   <mrow>
    <mrow>
     <mi>i</mi>
     <mi>j</mi>
    </mrow>
    <mo>,</mo>
    <mrow>
     <mi>k</mi>
     <mi>l</mi>
    </mrow>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>w</ci>
    <list>
     <apply>
      <times></times>
      <ci>i</ci>
      <ci>j</ci>
     </apply>
     <apply>
      <times></times>
      <ci>k</ci>
      <ci>l</ci>
     </apply>
    </list>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   w_{ij,kl}
  </annotation>
 </semantics>
</math>

 are the entries of the inverse of the <a href="covariance_matrix" title="wikilink">covariance matrix</a> of the distance estimates.</p>
<h2 id="computational-complexity">Computational Complexity</h2>

<p>Finding the tree and branch lengths minimizing the least squares residual is an <a class="uri" href="NP-complete" title="wikilink">NP-complete</a> problem.<a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a> However, for a given tree, the optimal branch lengths can be determined in 

<math display="inline" id="Least_squares_inference_in_phylogeny:10">
 <semantics>
  <mrow>
   <mi>O</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msup>
     <mi>n</mi>
     <mn>2</mn>
    </msup>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>O</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>n</ci>
     <cn type="integer">2</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   O(n^{2})
  </annotation>
 </semantics>
</math>

 time for ordinary least squares, 

<math display="inline" id="Least_squares_inference_in_phylogeny:11">
 <semantics>
  <mrow>
   <mi>O</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msup>
     <mi>n</mi>
     <mn>3</mn>
    </msup>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>O</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>n</ci>
     <cn type="integer">3</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   O(n^{3})
  </annotation>
 </semantics>
</math>

 time for weighted least squares, and 

<math display="inline" id="Least_squares_inference_in_phylogeny:12">
 <semantics>
  <mrow>
   <mi>O</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msup>
     <mi>n</mi>
     <mn>4</mn>
    </msup>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>O</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>n</ci>
     <cn type="integer">4</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   O(n^{4})
  </annotation>
 </semantics>
</math>

 time for generalised least squares (given the inverse of the <a href="covariance_matrix" title="wikilink">covariance matrix</a>).<a class="footnoteRef" href="#fn3" id="fnref3"><sup>3</sup></a></p>
<h2 id="external-links">External links</h2>
<ul>
<li><a href="http://evolution.genetics.washington.edu/phylip.html">PHYLIP</a>, a freely distributed phylogenetic analysis package containing an implementation of the weighted least squares method</li>
<li><a href="http://paup.csit.fsu.edu/">PAUP</a>, a similar package available for purchase</li>
<li><a href="http://www.cbrg.ethz.ch/darwin/index">Darwin</a>, a programming environment with a library of functions for statistics, numerics, sequence and phylogenetic analysis</li>
</ul>
<h2 id="references">References</h2>

<p>"</p>

<p><a href="Category:Computational_phylogenetics" title="wikilink">Category:Computational phylogenetics</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1">Fitch WM, Margoliash E. (1967). Construction of phylogenetic trees. <em>Science</em> 155: 279-84.<a href="#fnref1">↩</a></li>
<li id="fn2">William H.E. Day, <a href="http://www.sciencedirect.com/science/article/B6WC7-4GP2507-7/2/8bed127a0bba589021e7cd6e8f0306f6">Computational complexity of inferring phylogenies from dissimilarity matrices</a>, Bulletin of Mathematical Biology, Volume 49, Issue 4, 1987, Pages 461-467, ISSN 0092-8240, .<a href="#fnref2">↩</a></li>
<li id="fn3">David Bryant, Peter Waddell, <a href="http://mbe.oxfordjournals.org/content/15/10/1346.full.pdf">Rapid Evaluation of Least-Squares and Minimum-Evolution Criteria on Phylogenetic Trees</a>, Mol Biol Evol (1998) 15(10): 1346<a href="#fnref3">↩</a></li>
</ol>
</section>
</body>
</html>

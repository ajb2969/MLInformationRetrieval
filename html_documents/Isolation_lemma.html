<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="1951">Isolation lemma</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Isolation lemma</h1>
<hr/>

<p>In <a href="theoretical_computer_science" title="wikilink">theoretical computer science</a>, the term <strong>isolation lemma</strong> (or <strong>isolating lemma</strong>) refers to <a href="randomized_algorithm" title="wikilink">randomized algorithms</a> that reduce the number of solutions to a problem to one, should a solution exist. This is achieved by constructing random constraints such that, with non-negligible probability, exactly one solution satisfies these additional constraints if the solution space is not empty. Isolation lemmas have important applications in computer science, such as the <a href="Valiant–Vazirani_theorem" title="wikilink">Valiant–Vazirani theorem</a> and <a href="Toda's_theorem" title="wikilink">Toda's theorem</a> in <a href="computational_complexity_theory" title="wikilink">computational complexity theory</a>.</p>

<p>The first isolation lemma was introduced by , albeit not under that name. Their isolation lemma chooses a random number of random hyperplanes, and has the property that, with non-negligible probability, the intersection of any fixed non-empty solution space with the chosen hyperplanes contains exactly one element. This suffices to show the <a href="Valiant–Vazirani_theorem" title="wikilink">Valiant–Vazirani theorem</a>: there exists a randomized <a href="polynomial-time_reduction" title="wikilink">polynomial-time reduction</a> from the <a href="Boolean_satisfiability_problem" title="wikilink">satisfiability problem for Boolean formulas</a> to the problem of detecting whether a Boolean formula has a unique solution.  introduced an isolation lemma of a slightly different kind: Here every coordinate of the solution space gets assigned a random weight in a certain range of integers, and the property is that, with non-negligible probability, there is exactly one element in the solution space that has minimum weight. This can be used to obtain a randomized parallel algorithm for the <a href="maximum_matching" title="wikilink">maximum matching</a> problem.</p>

<p>Stronger isolation lemmas have been introduced in the literature to fit different needs in various settings. For example, the isolation lemma of  has similar guarantees as that of Mulmuley et al., but it uses fewer random bits. In the context of the <a href="exponential_time_hypothesis" title="wikilink">exponential time hypothesis</a>,  prove an isolation lemma for <a href="Boolean_satisfiability_problem" title="wikilink">k-CNF formulas</a>. Noam Ta-Shma<a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a> gives an isolation lemma with slightly stronger parameters, and gives non-trivial results even when the size of the weight domain is smaller than the number of variables.</p>
<h2 id="the-isolation-lemma-of-mulmuley-vazirani-and-vazirani">The isolation lemma of Mulmuley, Vazirani, and Vazirani</h2>
<figure><b>(Figure)</b>
<figcaption>Any <a href="linear_program" title="wikilink">linear program</a> with a randomly chosen linear cost function has a unique optimum with high probability. The isolation lemma of Mulmuley, Vazirani, and Vazirani extends this fact to <em>arbitrary</em> sets and a random cost function that is sampled using <em>few</em> random bits.</figcaption>
</figure>
<dl>
<dd><strong>Lemma.</strong> Let 

<math display="inline" id="Isolation_lemma:0">
 <semantics>
  <mi>n</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>n</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Isolation_lemma:1">
 <semantics>
  <mi>N</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>N</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   N
  </annotation>
 </semantics>
</math>

 be positive integers, and let 

<math display="inline" id="Isolation_lemma:2">
 <semantics>
  <mi class="ltx_font_mathcaligraphic">ℱ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>ℱ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathcal{F}
  </annotation>
 </semantics>
</math>

 be an arbitrary family of subsets of the universe 

<math display="inline" id="Isolation_lemma:3">
 <semantics>
  <mrow>
   <mo stretchy="false">{</mo>
   <mn>1</mn>
   <mo>,</mo>
   <mi mathvariant="normal">…</mi>
   <mo>,</mo>
   <mi>n</mi>
   <mo stretchy="false">}</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <set>
    <cn type="integer">1</cn>
    <ci>normal-…</ci>
    <ci>n</ci>
   </set>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \{1,\dots,n\}
  </annotation>
 </semantics>
</math>

. Suppose each element 

<math display="inline" id="Isolation_lemma:4">
 <semantics>
  <mrow>
   <mi>x</mi>
   <mo>∈</mo>
   <mrow>
    <mo stretchy="false">{</mo>
    <mn>1</mn>
    <mo>,</mo>
    <mi mathvariant="normal">…</mi>
    <mo>,</mo>
    <mi>n</mi>
    <mo stretchy="false">}</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <in></in>
    <ci>x</ci>
    <set>
     <cn type="integer">1</cn>
     <ci>normal-…</ci>
     <ci>n</ci>
    </set>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x\in\{1,\dots,n\}
  </annotation>
 </semantics>
</math>

 in the universe receives an integer weight 

<math display="inline" id="Isolation_lemma:5">
 <semantics>
  <mrow>
   <mi>w</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>x</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>w</ci>
    <ci>x</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   w(x)
  </annotation>
 </semantics>
</math>

, each of which is chosen independently and uniformly at random from 

<math display="inline" id="Isolation_lemma:6">
 <semantics>
  <mrow>
   <mo stretchy="false">{</mo>
   <mn>1</mn>
   <mo>,</mo>
   <mi mathvariant="normal">…</mi>
   <mo>,</mo>
   <mi>N</mi>
   <mo stretchy="false">}</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <set>
    <cn type="integer">1</cn>
    <ci>normal-…</ci>
    <ci>N</ci>
   </set>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \{1,\dots,N\}
  </annotation>
 </semantics>
</math>

. The weight of a set <em>S</em> in 

<math display="inline" id="Isolation_lemma:7">
 <semantics>
  <mi class="ltx_font_mathcaligraphic">ℱ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>ℱ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathcal{F}
  </annotation>
 </semantics>
</math>

 is defined as

<p>

<math display="block" id="Isolation_lemma:8">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>w</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>S</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <munder>
      <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
      <mrow>
       <mi>x</mi>
       <mo>∈</mo>
       <mi>S</mi>
      </mrow>
     </munder>
     <mrow>
      <mi>w</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>x</mi>
       <mo rspace="4.2pt" stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>w</ci>
     <ci>S</ci>
    </apply>
    <apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <sum></sum>
      <apply>
       <in></in>
       <ci>x</ci>
       <ci>S</ci>
      </apply>
     </apply>
     <apply>
      <times></times>
      <ci>w</ci>
      <ci>x</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   w(S)=\sum_{x\in S}w(x)\,.
  </annotation>
 </semantics>
</math>

</p>
</dd>
<dd>Then, with probability at least 

<math display="inline" id="Isolation_lemma:9">
 <semantics>
  <mrow>
   <mn>1</mn>
   <mo>-</mo>
   <mrow>
    <mi>n</mi>
    <mo>/</mo>
    <mi>N</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <minus></minus>
    <cn type="integer">1</cn>
    <apply>
     <divide></divide>
     <ci>n</ci>
     <ci>N</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   1-n/N
  </annotation>
 </semantics>
</math>

, there is a <em>unique</em> set in 

<math display="inline" id="Isolation_lemma:10">
 <semantics>
  <mi class="ltx_font_mathcaligraphic">ℱ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>ℱ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathcal{F}
  </annotation>
 </semantics>
</math>

 that has the minimum weight among all sets of 

<math display="inline" id="Isolation_lemma:11">
 <semantics>
  <mi class="ltx_font_mathcaligraphic">ℱ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>ℱ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathcal{F}
  </annotation>
 </semantics>
</math>

.
</dd>
</dl>

<p>It is remarkable that the lemma assumes nothing about the nature of the family 

<math display="inline" id="Isolation_lemma:12">
 <semantics>
  <mi class="ltx_font_mathcaligraphic">ℱ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>ℱ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathcal{F}
  </annotation>
 </semantics>
</math>

: for instance 

<math display="inline" id="Isolation_lemma:13">
 <semantics>
  <mi class="ltx_font_mathcaligraphic">ℱ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>ℱ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathcal{F}
  </annotation>
 </semantics>
</math>

 may include <em>all</em> 

<math display="inline" id="Isolation_lemma:14">
 <semantics>
  <mrow>
   <msup>
    <mn>2</mn>
    <mi>n</mi>
   </msup>
   <mo>-</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <minus></minus>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <cn type="integer">2</cn>
     <ci>n</ci>
    </apply>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   2^{n}-1
  </annotation>
 </semantics>
</math>

 nonempty subsets. Since the weight of each set in 

<math display="inline" id="Isolation_lemma:15">
 <semantics>
  <mi class="ltx_font_mathcaligraphic">ℱ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>ℱ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathcal{F}
  </annotation>
 </semantics>
</math>

 is between 

<math display="inline" id="Isolation_lemma:16">
 <semantics>
  <mn>1</mn>
  <annotation-xml encoding="MathML-Content">
   <cn type="integer">1</cn>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   1
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Isolation_lemma:17">
 <semantics>
  <mrow>
   <mi>n</mi>
   <mi>N</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>n</ci>
    <ci>N</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   nN
  </annotation>
 </semantics>
</math>

 on average there will be 

<math display="inline" id="Isolation_lemma:18">
 <semantics>
  <mrow>
   <mrow>
    <mo stretchy="false">(</mo>
    <mrow>
     <msup>
      <mn>2</mn>
      <mi>n</mi>
     </msup>
     <mo>-</mo>
     <mn>1</mn>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>/</mo>
   <mrow>
    <mo stretchy="false">(</mo>
    <mrow>
     <mi>n</mi>
     <mi>N</mi>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <divide></divide>
    <apply>
     <minus></minus>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <cn type="integer">2</cn>
      <ci>n</ci>
     </apply>
     <cn type="integer">1</cn>
    </apply>
    <apply>
     <times></times>
     <ci>n</ci>
     <ci>N</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (2^{n}-1)/(nN)
  </annotation>
 </semantics>
</math>

 sets of each possible weight. Still, with high probability, there is a unique set that has minimum weight.</p>
<div class="NavFrame collapsed" style="width: 50%;">
<div class="NavHead">

<p>[Mulmuley, Vazirani, and Vazirani's Proof]</p>
</div>
<div class="NavContent" style="text-align:left">

<p>Suppose we have fixed the weights of all elements except an element <em>x</em>. Then <em>x</em> has a <em>threshold</em> weight <em>α</em>, such that if the weight <em>w</em>(<em>x</em>) of <em>x</em> is greater than <em>α</em>, then it is not contained in any minimum-weight subset, and if 

<math display="inline" id="Isolation_lemma:19">
 <semantics>
  <mrow>
   <mrow>
    <mi>w</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>x</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>≤</mo>
   <mi>α</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <leq></leq>
    <apply>
     <times></times>
     <ci>w</ci>
     <ci>x</ci>
    </apply>
    <ci>α</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   w(x)\leq\alpha
  </annotation>
 </semantics>
</math>

, then it is contained in some sets of minimum weight. Further, observe that if 

<math display="inline" id="Isolation_lemma:20">
 <semantics>
  <mrow>
   <mrow>
    <mi>w</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>x</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo><</mo>
   <mi>α</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <lt></lt>
    <apply>
     <times></times>
     <ci>w</ci>
     <ci>x</ci>
    </apply>
    <ci>α</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   w(x)<\alpha
  </annotation>
 </semantics>
</math>

, then <em>every</em> minimum-weight subset must contain <em>x</em> (since, when we decrease <em>w(x)</em> from <em>α</em>, sets that do not contain <em>x</em> do not decrease in weight, while those that contain <em>x</em> do). Thus, ambiguity about whether a minimum-weight subset contains <em>x</em> or not can happen only when the weight of <em>x</em> is exactly equal to its threshold; in this case we will call <em>x</em> "singular". Now, as the threshold of <em>x</em> was defined only in terms of the weights of the <em>other</em> elements, it is independent of <em>w(x)</em>, and therefore, as <em>w</em>(<em>x</em>) is chosen uniformly from {1, …, <em>N</em>},</p>

<p>

<math display="block" id="Isolation_lemma:21">
 <semantics>
  <mrow>
   <mrow>
    <mi>Pr</mi>
    <mrow>
     <mo stretchy="false">[</mo>
     <mrow>
      <mi>x</mi>
      <mtext>is singular</mtext>
     </mrow>
     <mo stretchy="false">]</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mi>Pr</mi>
    <mrow>
     <mo stretchy="false">[</mo>
     <mrow>
      <mrow>
       <mi>w</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>x</mi>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
      <mo>=</mo>
      <mi>α</mi>
     </mrow>
     <mo stretchy="false">]</mo>
    </mrow>
   </mrow>
   <mo>≤</mo>
   <mrow>
    <mn>1</mn>
    <mo>/</mo>
    <mi>N</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <ci>Pr</ci>
      <apply>
       <times></times>
       <ci>x</ci>
       <mtext>is singular</mtext>
      </apply>
     </apply>
     <apply>
      <ci>Pr</ci>
      <apply>
       <eq></eq>
       <apply>
        <times></times>
        <ci>w</ci>
        <ci>x</ci>
       </apply>
       <ci>α</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <leq></leq>
     <share href="#.cmml">
     </share>
     <apply>
      <divide></divide>
      <cn type="integer">1</cn>
      <ci>N</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Pr[x\text{ is singular}]=\Pr[w(x)=\alpha]\leq 1/N
  </annotation>
 </semantics>
</math>

</p>

<p>and the probability that <em>some</em> <em>x</em> is singular is at most <em>n/N</em>. As there is a unique minimum-weight subset <a class="uri" href="iff" title="wikilink">iff</a> no element is singular, the lemma follows.</p>

<p>Remark: The lemma holds with 

<math display="inline" id="Isolation_lemma:22">
 <semantics>
  <mo>≤</mo>
  <annotation-xml encoding="MathML-Content">
   <leq></leq>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \leq
  </annotation>
 </semantics>
</math>

 (rather than =) since it is possible that some <em>x</em> has no threshold value (i.e., <em>x</em> will not be in any minimum-weight subset even if <em>w</em>(<em>x</em>) gets the minimum possible value, 1).</p>
</div>
</div>
<div class="NavFrame collapsed" style="width: 50%;">
<div class="NavHead">

<p>[Joel Spencer's Proof]</p>
</div>
<div class="NavContent" style="text-align:left">

<p>This is a restatement version of the above proof, due to <a href="Joel_Spencer" title="wikilink">Joel Spencer</a> (1995).<a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a></p>

<p>For any element <em>x</em> in the set, define</p>

<p>

<math display="block" id="Isolation_lemma:23">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>α</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>x</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mrow>
       <munder>
        <mi>min</mi>
        <mrow>
         <mrow>
          <mi>S</mi>
          <mo>∈</mo>
          <mi class="ltx_font_mathcaligraphic">ℱ</mi>
         </mrow>
         <mo>,</mo>
         <mrow>
          <mi>x</mi>
          <mo>∉</mo>
          <mi>S</mi>
         </mrow>
        </mrow>
       </munder>
       <mi>w</mi>
      </mrow>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>S</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo>-</mo>
     <mrow>
      <mrow>
       <munder>
        <mi>min</mi>
        <mrow>
         <mrow>
          <mi>S</mi>
          <mo>∈</mo>
          <mi class="ltx_font_mathcaligraphic">ℱ</mi>
         </mrow>
         <mo>,</mo>
         <mrow>
          <mi>x</mi>
          <mo>∈</mo>
          <mi>S</mi>
         </mrow>
        </mrow>
       </munder>
       <mi>w</mi>
      </mrow>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mi>S</mi>
        <mo>∖</mo>
        <mrow>
         <mo stretchy="false">{</mo>
         <mi>x</mi>
         <mo stretchy="false">}</mo>
        </mrow>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>α</ci>
     <ci>x</ci>
    </apply>
    <apply>
     <minus></minus>
     <apply>
      <times></times>
      <apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <min></min>
        <apply>
         <csymbol cd="ambiguous">formulae-sequence</csymbol>
         <apply>
          <in></in>
          <ci>S</ci>
          <ci>ℱ</ci>
         </apply>
         <apply>
          <notin></notin>
          <ci>x</ci>
          <ci>S</ci>
         </apply>
        </apply>
       </apply>
       <ci>w</ci>
      </apply>
      <ci>S</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <min></min>
        <apply>
         <csymbol cd="ambiguous">formulae-sequence</csymbol>
         <apply>
          <in></in>
          <ci>S</ci>
          <ci>ℱ</ci>
         </apply>
         <apply>
          <in></in>
          <ci>x</ci>
          <ci>S</ci>
         </apply>
        </apply>
       </apply>
       <ci>w</ci>
      </apply>
      <apply>
       <setdiff></setdiff>
       <ci>S</ci>
       <set>
        <ci>x</ci>
       </set>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \alpha(x)=\min_{S\in\mathcal{F},x\not\in S}w(S)-\min_{S\in\mathcal{F},x\in S}w%
(S\setminus\{x\}).\,
  </annotation>
 </semantics>
</math>

</p>

<p>Observe that 

<math display="inline" id="Isolation_lemma:24">
 <semantics>
  <mrow>
   <mi>α</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>x</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>α</ci>
    <ci>x</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \alpha(x)
  </annotation>
 </semantics>
</math>

 depends only on the weights of elements other than <em>x</em>, and not on <em>w</em>(<em>x</em>) itself. So whatever the value of 

<math display="inline" id="Isolation_lemma:25">
 <semantics>
  <mrow>
   <mi>α</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>x</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>α</ci>
    <ci>x</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \alpha(x)
  </annotation>
 </semantics>
</math>

, as <em>w</em>(<em>x</em>) is chosen uniformly from {1, …, <em>N</em>}, the probability that it is equal to 

<math display="inline" id="Isolation_lemma:26">
 <semantics>
  <mrow>
   <mi>α</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>x</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>α</ci>
    <ci>x</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \alpha(x)
  </annotation>
 </semantics>
</math>

 is at most 1/<em>N</em>. Thus the probability that 

<math display="inline" id="Isolation_lemma:27">
 <semantics>
  <mrow>
   <mrow>
    <mi>w</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>x</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mi>α</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>x</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>w</ci>
     <ci>x</ci>
    </apply>
    <apply>
     <times></times>
     <ci>α</ci>
     <ci>x</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   w(x)=\alpha(x)
  </annotation>
 </semantics>
</math>

 for <em>some</em> <em>x</em> is at most <em>n/N</em>.</p>

<p>Now if there are two sets <em>A</em> and <em>B</em> in 

<math display="inline" id="Isolation_lemma:28">
 <semantics>
  <mi class="ltx_font_mathcaligraphic">ℱ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>ℱ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathcal{F}
  </annotation>
 </semantics>
</math>

 with minimum weight, then, taking any <em>x</em> in <em>A\B</em>, we have</p>

<p>

<math display="inline" id="Isolation_lemma:29">
 <semantics>
  <mrow>
   <mi>α</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>x</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>α</ci>
    <ci>x</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle\alpha(x)
  </annotation>
 </semantics>
</math>


</p>

<p>and as we have seen, this event happens with probability at most <em>n/N</em>.</p>
</div>
</div>
<h2 id="examplesapplications">Examples/applications</h2>
<ul>
<li>The original application was to minimum-weight (or maximum-weight) perfect matchings in a graph. Each edge is assigned a random weight in {1, …, 2<em>m</em>}, and 

<math display="inline" id="Isolation_lemma:30">
 <semantics>
  <mi class="ltx_font_mathcaligraphic">ℱ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>ℱ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathcal{F}
  </annotation>
 </semantics>
</math>

 is the set of perfect matchings, so that with probability at least 1/2, there exists a unique perfect matching. When each indeterminate 

<math display="inline" id="Isolation_lemma:31">
 <semantics>
  <msub>
   <mi>x</mi>
   <mrow>
    <mi>i</mi>
    <mi>j</mi>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>x</ci>
    <apply>
     <times></times>
     <ci>i</ci>
     <ci>j</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x_{ij}
  </annotation>
 </semantics>
</math>

 in the <a href="Tutte_matrix" title="wikilink">Tutte matrix</a> of the graph is replaced with 

<math display="inline" id="Isolation_lemma:32">
 <semantics>
  <msup>
   <mn>2</mn>
   <msub>
    <mi>w</mi>
    <mrow>
     <mi>i</mi>
     <mi>j</mi>
    </mrow>
   </msub>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <cn type="integer">2</cn>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>w</ci>
     <apply>
      <times></times>
      <ci>i</ci>
      <ci>j</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   2^{w_{ij}}
  </annotation>
 </semantics>
</math>

 where 

<math display="inline" id="Isolation_lemma:33">
 <semantics>
  <msub>
   <mi>w</mi>
   <mrow>
    <mi>i</mi>
    <mi>j</mi>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>w</ci>
    <apply>
     <times></times>
     <ci>i</ci>
     <ci>j</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   w_{ij}
  </annotation>
 </semantics>
</math>

 is the random weight of the edge, we can show that the determinant of the matrix is nonzero, and further use this to find the matching.</li>
<li>More generally, the paper also observed that any search problem of the form "Given a set system 

<math display="inline" id="Isolation_lemma:34">
 <semantics>
  <mrow>
   <mo stretchy="false">(</mo>
   <mi>S</mi>
   <mo>,</mo>
   <mi class="ltx_font_mathcaligraphic">ℱ</mi>
   <mo stretchy="false">)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <interval closure="open">
    <ci>S</ci>
    <ci>ℱ</ci>
   </interval>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (S,\mathcal{F})
  </annotation>
 </semantics>
</math>

, find a set in 

<math display="inline" id="Isolation_lemma:35">
 <semantics>
  <mi class="ltx_font_mathcaligraphic">ℱ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>ℱ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathcal{F}
  </annotation>
 </semantics>
</math>

" could be reduced to a decision problem of the form "Is there a set in 

<math display="inline" id="Isolation_lemma:36">
 <semantics>
  <mi class="ltx_font_mathcaligraphic">ℱ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>ℱ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathcal{F}
  </annotation>
 </semantics>
</math>

 with total weight at most <em>k</em>?". For instance, it showed how to solve the following problem posed by Papadimitriou and Yannakakis, for which (as of the time the paper was written) no deterministic polynomial-time algorithm is known: given a graph and a subset of the edges marked as "red", find a perfect matching with exactly <em>k</em> red edges.</li>
<li>The <a href="Valiant–Vazirani_theorem" title="wikilink">Valiant–Vazirani theorem</a>, concerning unique solutions to NP-complete problems, has a simpler proof using the isolation lemma. This is proved by giving a randomized reduction from <a href="Clique_problem" title="wikilink">CLIQUE</a> to UNIQUE-CLIQUE.<a class="footnoteRef" href="#fn3" id="fnref3"><sup>3</sup></a></li>
<li>

<p>use the proof of Valiant-Vazirani in their search-to-decision reduction for <a href="average-case_complexity" title="wikilink">average-case complexity</a>.</p></li>
<li><a href="Avi_Wigderson" title="wikilink">Avi Wigderson</a> used the isolation lemma in 1994 to give a randomized reduction from <a href="NL_(complexity)" title="wikilink">NL</a> to UL, and thereby prove that NL/poly ⊆ ⊕L/poly.<a class="footnoteRef" href="#fn4" id="fnref4"><sup>4</sup></a> Reinhardt and Allender later used the isolation lemma again to prove that NL/poly = UL/poly.<a class="footnoteRef" href="#fn5" id="fnref5"><sup>5</sup></a></li>
<li>The book by Hemaspaandra and Ogihara has a chapter on the isolation technique, including generalizations.<a class="footnoteRef" href="#fn6" id="fnref6"><sup>6</sup></a></li>
<li>The isolation lemma has been proposed as the basis of a scheme for <a href="digital_watermarking" title="wikilink">digital watermarking</a>.<a class="footnoteRef" href="#fn7" id="fnref7"><sup>7</sup></a></li>
<li>There is ongoing work on derandomizing the isolation lemma in specific cases<a class="footnoteRef" href="#fn8" id="fnref8"><sup>8</sup></a> and on using it for identity testing.<a class="footnoteRef" href="#fn9" id="fnref9"><sup>9</sup></a></li>
</ul>
<h2 id="notes">Notes</h2>
<h2 id="references">References</h2>
<ul>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
</ul>
<h2 id="external-links">External links</h2>
<ul>
<li><a href="http://blog.computationalcomplexity.org/2006/09/favorite-theorems-unique-witnesses.html">Favorite Theorems: Unique Witnesses</a> by <a href="Lance_Fortnow" title="wikilink">Lance Fortnow</a></li>
<li><a href="http://rjlipton.wordpress.com/2009/07/01/the-isolation-lemma-and-beyond/">The Isolation Lemma and Beyond</a> by <a href="Richard_J._Lipton" title="wikilink">Richard J. Lipton</a></li>
</ul>

<p>"</p>

<p><a href="Category:Probability_theorems" title="wikilink">Category:Probability theorems</a> <a class="uri" href="Category:Combinatorics" title="wikilink">Category:Combinatorics</a> <a class="uri" href="Category:Lemmas" title="wikilink">Category:Lemmas</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1">Noam Ta-Shma (2015); <a href="http://eccc.hpi-web.de/report/2015/080/"><em>A simple proof of the Isolation Lemma</em></a>, in <em>eccc</em><a href="#fnref1">↩</a></li>
<li id="fn2"><a href="#fnref2">↩</a></li>
<li id="fn3"><a href="#fnref3">↩</a></li>
<li id="fn4"><a href="#fnref4">↩</a></li>
<li id="fn5"><a href="#fnref5">↩</a></li>
<li id="fn6"><a href="#fnref6">↩</a></li>
<li id="fn7"><a href="#fnref7">↩</a></li>
<li id="fn8"><a href="#fnref8">↩</a></li>
<li id="fn9"><a href="#fnref9">↩</a></li>
</ol>
</section>
</body>
</html>

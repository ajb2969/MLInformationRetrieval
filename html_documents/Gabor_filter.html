<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="984">Gabor filter</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Gabor filter</h1>
<style>
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
<style>
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
  </style>
</body></html>
<body>
<hr/>
<figure><b>(Figure)</b>
<figcaption>Right|<em>Example of a two-dimensional Gabor filter</em></figcaption>
</figure>

<p>In <a href="image_processing" title="wikilink">image processing</a>, a <strong>Gabor filter</strong>, named after <a href="Dennis_Gabor" title="wikilink">Dennis Gabor</a>, is a <a href="linear_filter" title="wikilink">linear filter</a> used for edge detection. Frequency and orientation representations of Gabor filters are similar to those of the human visual system, and they have been found to be particularly appropriate for texture representation and discrimination. In the spatial domain, a 2D Gabor filter is a Gaussian kernel function modulated by a sinusoidal plane wave.</p>

<p>Simple cells in the <a href="visual_cortex" title="wikilink">visual cortex</a> of <a href="mammalian_brain" title="wikilink">mammalian brains</a> can be modeled by Gabor functions.<a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a><a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a> Thus, <a href="image_analysis" title="wikilink">image analysis</a> with Gabor filters is thought to be similar to perception in the <a href="human_visual_system" title="wikilink">human visual system</a>.</p>
<h2 id="definition">Definition</h2>

<p>Its <a href="impulse_response" title="wikilink">impulse response</a> is defined by a <a href="sine_wave" title="wikilink">sinusoidal</a> wave (a <a href="plane_wave" title="wikilink">plane wave</a> for 2D Gabor filters) multiplied by a <a href="Gaussian_function" title="wikilink">Gaussian function</a>.<a class="footnoteRef" href="#fn3" id="fnref3"><sup>3</sup></a> Because of the multiplication-convolution property (<a href="Convolution_theorem" title="wikilink">Convolution theorem</a>), the <a href="Fourier_transform" title="wikilink">Fourier transform</a> of a Gabor filter's impulse response is the <a class="uri" href="convolution" title="wikilink">convolution</a> of the Fourier transform of the harmonic function and the Fourier transform of the Gaussian function. The filter has a real and an imaginary component representing <a class="uri" href="orthogonal" title="wikilink">orthogonal</a> directions.<a class="footnoteRef" href="#fn4" id="fnref4"><sup>4</sup></a> The two components may be formed into a <a href="complex_number" title="wikilink">complex number</a> or used individually.</p>

<p>Complex</p>

<p>

<math display="block" id="Gabor_filter:0">
 <semantics>
  <mrow>
   <mrow>
    <mi>g</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>x</mi>
     <mo>,</mo>
     <mi>y</mi>
     <mo>;</mo>
     <mi>λ</mi>
     <mo>,</mo>
     <mi>θ</mi>
     <mo>,</mo>
     <mi>ψ</mi>
     <mo>,</mo>
     <mi>σ</mi>
     <mo>,</mo>
     <mi>γ</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mi>exp</mi>
     <mrow>
      <mo>(</mo>
      <mrow>
       <mo>-</mo>
       <mfrac>
        <mrow>
         <msup>
          <mi>x</mi>
          <mrow>
           <mi mathvariant="normal">′</mi>
           <mn>2</mn>
          </mrow>
         </msup>
         <mo>+</mo>
         <mrow>
          <msup>
           <mi>γ</mi>
           <mn>2</mn>
          </msup>
          <msup>
           <mi>y</mi>
           <mrow>
            <mi mathvariant="normal">′</mi>
            <mn>2</mn>
           </mrow>
          </msup>
         </mrow>
        </mrow>
        <mrow>
         <mn>2</mn>
         <msup>
          <mi>σ</mi>
          <mn>2</mn>
         </msup>
        </mrow>
       </mfrac>
      </mrow>
      <mo>)</mo>
     </mrow>
    </mrow>
    <mrow>
     <mi>exp</mi>
     <mrow>
      <mo>(</mo>
      <mrow>
       <mi>i</mi>
       <mrow>
        <mo>(</mo>
        <mrow>
         <mrow>
          <mn>2</mn>
          <mi>π</mi>
          <mfrac>
           <msup>
            <mi>x</mi>
            <mo>′</mo>
           </msup>
           <mi>λ</mi>
          </mfrac>
         </mrow>
         <mo>+</mo>
         <mi>ψ</mi>
        </mrow>
        <mo>)</mo>
       </mrow>
      </mrow>
      <mo>)</mo>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>g</ci>
     <vector>
      <ci>x</ci>
      <ci>y</ci>
      <ci>λ</ci>
      <ci>θ</ci>
      <ci>ψ</ci>
      <ci>σ</ci>
      <ci>γ</ci>
     </vector>
    </apply>
    <apply>
     <times></times>
     <apply>
      <exp></exp>
      <apply>
       <minus></minus>
       <apply>
        <divide></divide>
        <apply>
         <plus></plus>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>x</ci>
          <list>
           <ci>normal-′</ci>
           <cn type="integer">2</cn>
          </list>
         </apply>
         <apply>
          <times></times>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <ci>γ</ci>
           <cn type="integer">2</cn>
          </apply>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <ci>y</ci>
           <list>
            <ci>normal-′</ci>
            <cn type="integer">2</cn>
           </list>
          </apply>
         </apply>
        </apply>
        <apply>
         <times></times>
         <cn type="integer">2</cn>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>σ</ci>
          <cn type="integer">2</cn>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <exp></exp>
      <apply>
       <times></times>
       <ci>i</ci>
       <apply>
        <plus></plus>
        <apply>
         <times></times>
         <cn type="integer">2</cn>
         <ci>π</ci>
         <apply>
          <divide></divide>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <ci>x</ci>
           <ci>normal-′</ci>
          </apply>
          <ci>λ</ci>
         </apply>
        </apply>
        <ci>ψ</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   g(x,y;\lambda,\theta,\psi,\sigma,\gamma)=\exp\left(-\frac{x^{\prime 2}+\gamma^%
{2}y^{\prime 2}}{2\sigma^{2}}\right)\exp\left(i\left(2\pi\frac{x^{\prime}}{%
\lambda}+\psi\right)\right)
  </annotation>
 </semantics>
</math>

</p>

<p>Real</p>

<p>

<math display="block" id="Gabor_filter:1">
 <semantics>
  <mrow>
   <mrow>
    <mi>g</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>x</mi>
     <mo>,</mo>
     <mi>y</mi>
     <mo>;</mo>
     <mi>λ</mi>
     <mo>,</mo>
     <mi>θ</mi>
     <mo>,</mo>
     <mi>ψ</mi>
     <mo>,</mo>
     <mi>σ</mi>
     <mo>,</mo>
     <mi>γ</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mi>exp</mi>
     <mrow>
      <mo>(</mo>
      <mrow>
       <mo>-</mo>
       <mfrac>
        <mrow>
         <msup>
          <mi>x</mi>
          <mrow>
           <mi mathvariant="normal">′</mi>
           <mn>2</mn>
          </mrow>
         </msup>
         <mo>+</mo>
         <mrow>
          <msup>
           <mi>γ</mi>
           <mn>2</mn>
          </msup>
          <msup>
           <mi>y</mi>
           <mrow>
            <mi mathvariant="normal">′</mi>
            <mn>2</mn>
           </mrow>
          </msup>
         </mrow>
        </mrow>
        <mrow>
         <mn>2</mn>
         <msup>
          <mi>σ</mi>
          <mn>2</mn>
         </msup>
        </mrow>
       </mfrac>
      </mrow>
      <mo>)</mo>
     </mrow>
    </mrow>
    <mrow>
     <mi>cos</mi>
     <mrow>
      <mo>(</mo>
      <mrow>
       <mrow>
        <mn>2</mn>
        <mi>π</mi>
        <mfrac>
         <msup>
          <mi>x</mi>
          <mo>′</mo>
         </msup>
         <mi>λ</mi>
        </mfrac>
       </mrow>
       <mo>+</mo>
       <mi>ψ</mi>
      </mrow>
      <mo>)</mo>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>g</ci>
     <vector>
      <ci>x</ci>
      <ci>y</ci>
      <ci>λ</ci>
      <ci>θ</ci>
      <ci>ψ</ci>
      <ci>σ</ci>
      <ci>γ</ci>
     </vector>
    </apply>
    <apply>
     <times></times>
     <apply>
      <exp></exp>
      <apply>
       <minus></minus>
       <apply>
        <divide></divide>
        <apply>
         <plus></plus>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>x</ci>
          <list>
           <ci>normal-′</ci>
           <cn type="integer">2</cn>
          </list>
         </apply>
         <apply>
          <times></times>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <ci>γ</ci>
           <cn type="integer">2</cn>
          </apply>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <ci>y</ci>
           <list>
            <ci>normal-′</ci>
            <cn type="integer">2</cn>
           </list>
          </apply>
         </apply>
        </apply>
        <apply>
         <times></times>
         <cn type="integer">2</cn>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>σ</ci>
          <cn type="integer">2</cn>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <cos></cos>
      <apply>
       <plus></plus>
       <apply>
        <times></times>
        <cn type="integer">2</cn>
        <ci>π</ci>
        <apply>
         <divide></divide>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>x</ci>
          <ci>normal-′</ci>
         </apply>
         <ci>λ</ci>
        </apply>
       </apply>
       <ci>ψ</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   g(x,y;\lambda,\theta,\psi,\sigma,\gamma)=\exp\left(-\frac{x^{\prime 2}+\gamma^%
{2}y^{\prime 2}}{2\sigma^{2}}\right)\cos\left(2\pi\frac{x^{\prime}}{\lambda}+%
\psi\right)
  </annotation>
 </semantics>
</math>

</p>

<p>Imaginary</p>

<p>

<math display="block" id="Gabor_filter:2">
 <semantics>
  <mrow>
   <mrow>
    <mi>g</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>x</mi>
     <mo>,</mo>
     <mi>y</mi>
     <mo>;</mo>
     <mi>λ</mi>
     <mo>,</mo>
     <mi>θ</mi>
     <mo>,</mo>
     <mi>ψ</mi>
     <mo>,</mo>
     <mi>σ</mi>
     <mo>,</mo>
     <mi>γ</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mi>exp</mi>
     <mrow>
      <mo>(</mo>
      <mrow>
       <mo>-</mo>
       <mfrac>
        <mrow>
         <msup>
          <mi>x</mi>
          <mrow>
           <mi mathvariant="normal">′</mi>
           <mn>2</mn>
          </mrow>
         </msup>
         <mo>+</mo>
         <mrow>
          <msup>
           <mi>γ</mi>
           <mn>2</mn>
          </msup>
          <msup>
           <mi>y</mi>
           <mrow>
            <mi mathvariant="normal">′</mi>
            <mn>2</mn>
           </mrow>
          </msup>
         </mrow>
        </mrow>
        <mrow>
         <mn>2</mn>
         <msup>
          <mi>σ</mi>
          <mn>2</mn>
         </msup>
        </mrow>
       </mfrac>
      </mrow>
      <mo>)</mo>
     </mrow>
    </mrow>
    <mrow>
     <mi>sin</mi>
     <mrow>
      <mo>(</mo>
      <mrow>
       <mrow>
        <mn>2</mn>
        <mi>π</mi>
        <mfrac>
         <msup>
          <mi>x</mi>
          <mo>′</mo>
         </msup>
         <mi>λ</mi>
        </mfrac>
       </mrow>
       <mo>+</mo>
       <mi>ψ</mi>
      </mrow>
      <mo>)</mo>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>g</ci>
     <vector>
      <ci>x</ci>
      <ci>y</ci>
      <ci>λ</ci>
      <ci>θ</ci>
      <ci>ψ</ci>
      <ci>σ</ci>
      <ci>γ</ci>
     </vector>
    </apply>
    <apply>
     <times></times>
     <apply>
      <exp></exp>
      <apply>
       <minus></minus>
       <apply>
        <divide></divide>
        <apply>
         <plus></plus>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>x</ci>
          <list>
           <ci>normal-′</ci>
           <cn type="integer">2</cn>
          </list>
         </apply>
         <apply>
          <times></times>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <ci>γ</ci>
           <cn type="integer">2</cn>
          </apply>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <ci>y</ci>
           <list>
            <ci>normal-′</ci>
            <cn type="integer">2</cn>
           </list>
          </apply>
         </apply>
        </apply>
        <apply>
         <times></times>
         <cn type="integer">2</cn>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>σ</ci>
          <cn type="integer">2</cn>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <sin></sin>
      <apply>
       <plus></plus>
       <apply>
        <times></times>
        <cn type="integer">2</cn>
        <ci>π</ci>
        <apply>
         <divide></divide>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>x</ci>
          <ci>normal-′</ci>
         </apply>
         <ci>λ</ci>
        </apply>
       </apply>
       <ci>ψ</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   g(x,y;\lambda,\theta,\psi,\sigma,\gamma)=\exp\left(-\frac{x^{\prime 2}+\gamma^%
{2}y^{\prime 2}}{2\sigma^{2}}\right)\sin\left(2\pi\frac{x^{\prime}}{\lambda}+%
\psi\right)
  </annotation>
 </semantics>
</math>

</p>

<p>where</p>

<p>

<math display="block" id="Gabor_filter:3">
 <semantics>
  <mrow>
   <msup>
    <mi>x</mi>
    <mo>′</mo>
   </msup>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mi>x</mi>
     <mrow>
      <mi>cos</mi>
      <mi>θ</mi>
     </mrow>
    </mrow>
    <mo>+</mo>
    <mrow>
     <mi>y</mi>
     <mrow>
      <mi>sin</mi>
      <mpadded width="+1.7pt">
       <mi>θ</mi>
      </mpadded>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>x</ci>
     <ci>normal-′</ci>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <ci>x</ci>
      <apply>
       <cos></cos>
       <ci>θ</ci>
      </apply>
     </apply>
     <apply>
      <times></times>
      <ci>y</ci>
      <apply>
       <sin></sin>
       <ci>θ</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x^{\prime}=x\cos\theta+y\sin\theta\,
  </annotation>
 </semantics>
</math>

</p>

<p>and</p>

<p>

<math display="block" id="Gabor_filter:4">
 <semantics>
  <mrow>
   <msup>
    <mi>y</mi>
    <mo>′</mo>
   </msup>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mo>-</mo>
     <mrow>
      <mi>x</mi>
      <mrow>
       <mi>sin</mi>
       <mi>θ</mi>
      </mrow>
     </mrow>
    </mrow>
    <mo>+</mo>
    <mrow>
     <mi>y</mi>
     <mrow>
      <mi>cos</mi>
      <mpadded width="+1.7pt">
       <mi>θ</mi>
      </mpadded>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>y</ci>
     <ci>normal-′</ci>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <minus></minus>
      <apply>
       <times></times>
       <ci>x</ci>
       <apply>
        <sin></sin>
        <ci>θ</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <ci>y</ci>
      <apply>
       <cos></cos>
       <ci>θ</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   y^{\prime}=-x\sin\theta+y\cos\theta\,
  </annotation>
 </semantics>
</math>

</p>

<p>In this equation, 

<math display="inline" id="Gabor_filter:5">
 <semantics>
  <mi>λ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>λ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \lambda
  </annotation>
 </semantics>
</math>

 represents the wavelength of the sinusoidal factor, 

<math display="inline" id="Gabor_filter:6">
 <semantics>
  <mi>θ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>θ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \theta
  </annotation>
 </semantics>
</math>

 represents the orientation of the normal to the parallel stripes of a <a href="Gabor_function" title="wikilink">Gabor function</a>, 

<math display="inline" id="Gabor_filter:7">
 <semantics>
  <mi>ψ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>ψ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \psi
  </annotation>
 </semantics>
</math>

 is the phase offset, 

<math display="inline" id="Gabor_filter:8">
 <semantics>
  <mi>σ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>σ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \sigma
  </annotation>
 </semantics>
</math>

 is the sigma/standard deviation of the Gaussian envelope and 

<math display="inline" id="Gabor_filter:9">
 <semantics>
  <mi>γ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>γ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \gamma
  </annotation>
 </semantics>
</math>

 is the spatial aspect ratio, and specifies the ellipticity of the support of the Gabor function.</p>
<h2 id="feature-extraction">Feature extraction</h2>

<p>A set of Gabor filters with different frequencies and orientations may be helpful for extracting useful features from an image. Gabor filters have been widely used in pattern analysis applications.<a class="footnoteRef" href="#fn5" id="fnref5"><sup>5</sup></a> For example, it has been used to study the directionality distribution inside the porous spongy <a class="uri" href="trabecular" title="wikilink">trabecular</a> <a class="uri" href="bone" title="wikilink">bone</a> in the <a href="Vertebral_column" title="wikilink">spine</a>.<a class="footnoteRef" href="#fn6" id="fnref6"><sup>6</sup></a></p>
<h2 id="wavelet-space">Wavelet space</h2>

<p> Gabor filters are directly related to <a href="Gabor_wavelet" title="wikilink">Gabor wavelets</a>, since they can be designed for a number of dilations and rotations. However, in general, expansion is not applied for Gabor wavelets, since this requires computation of bi-orthogonal wavelets, which may be very time-consuming. Therefore, usually, a filter bank consisting of Gabor filters with various scales and rotations is created. The filters are convolved with the signal, resulting in a so-called Gabor space. This process is closely related to processes in the primary <a href="visual_cortex" title="wikilink">visual cortex</a>.<a class="footnoteRef" href="#fn7" id="fnref7"><sup>7</sup></a> Jones and Palmer showed that the real part of the complex Gabor function is a good fit to the receptive field weight functions found in simple cells in a cat's striate cortex.<a class="footnoteRef" href="#fn8" id="fnref8"><sup>8</sup></a></p>

<p>The Gabor space is very useful in <a href="image_processing" title="wikilink">image processing</a> applications such as <a href="optical_character_recognition" title="wikilink">optical character recognition</a>, <a href="iris_recognition" title="wikilink">iris recognition</a> and <a href="fingerprint_recognition" title="wikilink">fingerprint recognition</a>. Relations between activations for a specific spatial location are very distinctive between objects in an image. Furthermore, important activations can be extracted from the Gabor space in order to create a sparse object representation.</p>
<h2 id="example-implementation">Example implementation</h2>

<p>This is an example implementation in <a href="Python_(programming_language)" title="wikilink">Python</a>:</p>
<pre class="numpy"><code>import numpy

def gabor_fn(sigma,theta,Lambda,psi,gamma):
    sigma_x = sigma;
    sigma_y = float(sigma)/gamma;
    
    # Bounding box
    nstds = 3;
    xmax = max(abs(nstds*sigma_x*numpy.cos(theta)),abs(nstds*sigma_y*numpy.sin(theta)));
    xmax = numpy.ceil(max(1,xmax));
    ymax = max(abs(nstds*sigma_x*numpy.sin(theta)),abs(nstds*sigma_y*numpy.cos(theta)));
    ymax = numpy.ceil(max(1,ymax));
    xmin = -xmax; ymin = -ymax;
    (x,y) = numpy.meshgrid(numpy.arange(xmin,xmax+1),numpy.arange(ymin,ymax+1 ));
    (y,x) = numpy.meshgrid(numpy.arange(ymin,ymax+1),numpy.arange(xmin,xmax+1 ));
    
    # Rotation 
    x_theta=x*numpy.cos(theta)+y*numpy.sin(theta);
    y_theta=-x*numpy.sin(theta)+y*numpy.cos(theta);
    
    gb= numpy.exp(-.5*(x_theta**2/sigma_x**2+y_theta**2/sigma_y**2))*numpy.cos(2*numpy.pi/Lambda*x_theta+psi);
    return gb</code></pre>

<p>This is an example implementation in <a class="uri" href="MATLAB" title="wikilink">MATLAB</a>/<a href="GNU_Octave" title="wikilink">Octave</a>:</p>
<div class="sourceCode"><pre class="sourceCode matlab"><code class="sourceCode matlab">function gb=gabor_fn(sigma,theta,lambda,psi,gamma)

sigma_x = sigma;
sigma_y = sigma/gamma;

<span class="co">% Bounding box</span>
nstds = <span class="fl">3</span>;
xmax = max(abs(nstds*sigma_x*cos(theta)),abs(nstds*sigma_y*sin(theta)));
xmax = ceil(max(<span class="fl">1</span>,xmax));
ymax = max(abs(nstds*sigma_x*sin(theta)),abs(nstds*sigma_y*cos(theta)));
ymax = ceil(max(<span class="fl">1</span>,ymax));
xmin = -xmax; ymin = -ymax;
[x,y] = meshgrid(xmin:xmax,ymin:ymax);

<span class="co">% Rotation </span>
x_theta=x*cos(theta)+y*sin(theta);
y_theta=-x*sin(theta)+y*cos(theta);

gb= exp(-<span class="fl">.5</span>*(x_theta.^<span class="fl">2</span>/sigma_x^<span class="fl">2</span>+y_theta.^<span class="fl">2</span>/sigma_y^<span class="fl">2</span>)).*cos(<span class="fl">2</span>*pi/lambda*x_theta+psi);</code></pre></div>

<p><a class="uri" href="MATLAB" title="wikilink">MATLAB</a> code for Gabor feature extraction from images can be found at <a class="uri" href="http://www.mathworks.com/matlabcentral/fileexchange/44630">http://www.mathworks.com/matlabcentral/fileexchange/44630</a> .</p>

<p>This is another example implementation in <a href="Haskell_(programming_language)" title="wikilink">Haskell</a>:</p>
<div class="sourceCode"><pre class="sourceCode haskell"><code class="sourceCode haskell">gabor λ θ ψ σ γ x y <span class="fu">=</span> exp ( (<span class="fu">-</span><span class="fl">0.5</span>) <span class="fu">*</span> ((x2<span class="fu">^</span><span class="dv">2</span> <span class="fu">+</span> γ<span class="fu">^</span><span class="dv">2</span><span class="fu">*</span>y2<span class="fu">^</span><span class="dv">2</span>) <span class="fu">/</span> (σ<span class="fu">^</span><span class="dv">2</span>)) <span class="fu">:+</span> <span class="dv">0</span>) <span class="fu">*</span> exp ( <span class="dv">0</span> <span class="fu">:+</span> (<span class="dv">2</span><span class="fu">*</span>pi<span class="fu">*</span>(x2<span class="fu">/</span>λ<span class="fu">+</span>ψ)) )
    <span class="kw">where</span> x2 <span class="fu">=</span>  x <span class="fu">*</span> cos θ <span class="fu">+</span> y <span class="fu">*</span> sin θ
          y2 <span class="fu">=</span> <span class="fu">-</span>x <span class="fu">*</span> sin θ <span class="fu">+</span> y <span class="fu">*</span> cos θ</code></pre></div>

<p>(Note: <code>a :+ b</code> should be read as <code>a + i b</code>)</p>
<h2 id="see-also">See also</h2>
<ul>
<li><a href="Gabor_transform" title="wikilink">Gabor transform</a></li>
<li><a href="Gabor_atom" title="wikilink">Gabor atom</a></li>
</ul>
<h2 id="references">References</h2>
<references>
</references>
<h2 id="external-links">External links</h2>
<ul>
<li><a href="http://www.mathworks.com/matlabcentral/fileexchange/44630">MATLAB code for Gabor filters and Gabor feature extraction</a></li>
<li><a href="http://demonstrations.wolfram.com/Gabor3D/">3D Gabor demonstrated with Mathematica</a></li>
<li><a href="https://pythonhosted.org/LogGabor/">python implementation of log-Gabors for still images</a></li>
</ul>
<h2 id="further-reading">Further reading</h2>
<ul>
<li>Hans G. Feichtinger, Thomas Strohmer: "Gabor Analysis and Algorithms", Birkhäuser, 1998; ISBN 0-8176-3959-4</li>
<li>Karlheinz Gröchenig: "Foundations of Time-Frequency Analysis", Birkhäuser, 2001; ISBN 0-8176-4022-3</li>
<li><a href="http://www.cs.gmu.edu/~zduric/cs774/Papers/Daugman-GaborTransforms.pdf">John Daugman: "Complete Discrete 2-D Gabor Transforms by Neural Networks for Image Analysis and Compression", IEEE Trans on Acoustics, Speech, and Signal Processing. Vol. 36. No. 7. July 1988, pp. 1169–1179</a></li>
<li></li>
<li></li>
<li></li>
<li>Steerable Pyramids:
<ol>
<li>Eero Simoncelli's page on <a href="http://www.cns.nyu.edu/~eero/STEERPYR/">Steerable Pyramids</a></li>
<li>R. Manduchi, P. Perona and D. Shy. Efficient Deformable Filter Banks (<a href="http://www.vision.caltech.edu/publications/ManduchiPeronaShy_efficient_deformable.pdf">PDF</a>) (<a href="http://www.vision.caltech.edu/manduchi/def.tar.Z">Code</a>)</li>
</ol></li>
</ul>
<ul>
<li></li>
</ul>

<p>"</p>

<p><a href="Category:Linear_filters" title="wikilink">Category:Linear filters</a> <a href="Category:Articles_with_example_MATLAB/Octave_code" title="wikilink">Category:Articles with example MATLAB/Octave code</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1"><a href="#fnref1">↩</a></li>
<li id="fn2"><a href="John_Daugman" title="wikilink">J. G. Daugman</a>. Uncertainty relation for resolution in space, spatial frequency, and orientation optimized by two-dimensional visual cortical filters. <em>Journal of the Optical Society of America A</em>, 2(7):1160–1169, July 1985.<a href="#fnref2">↩</a></li>
<li id="fn3"><a href="#fnref3">↩</a></li>
<li id="fn4">3D surface tracking and approximation using Gabor filters, Jesper Juul Henriksen, South Denmark University, March 28, 2007<a href="#fnref4">↩</a></li>
<li id="fn5"><a href="#fnref5">↩</a></li>
<li id="fn6"><a href="#fnref6">↩</a></li>
<li id="fn7"><a href="#fnref7">↩</a></li>
<li id="fn8"><a href="#fnref8">↩</a></li>
</ol>
</section>
</body>


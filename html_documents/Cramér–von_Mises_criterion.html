<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="372">Cramér–von Mises criterion</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Cramér–von Mises criterion</h1>
<hr/>

<p>In <a class="uri" href="statistics" title="wikilink">statistics</a> the <strong>Cramér–von Mises criterion</strong> is a criterion used for judging the <a href="goodness_of_fit" title="wikilink">goodness of fit</a> of a <a href="cumulative_distribution_function" title="wikilink">cumulative distribution function</a> 

<math display="inline" id="Cramér–von_Mises_criterion:0">
 <semantics>
  <msup>
   <mi>F</mi>
   <mo>*</mo>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>F</ci>
    <times></times>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   F^{*}
  </annotation>
 </semantics>
</math>

 compared to a given <a href="empirical_distribution_function" title="wikilink">empirical distribution function</a> 

<math display="inline" id="Cramér–von_Mises_criterion:1">
 <semantics>
  <msub>
   <mi>F</mi>
   <mi>n</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>F</ci>
    <ci>n</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   F_{n}
  </annotation>
 </semantics>
</math>

, or for comparing two empirical distributions. It is also used as a part of other algorithms, such as <a href="minimum_distance_estimation" title="wikilink">minimum distance estimation</a>. It is defined as</p>

<p>

<math display="block" id="Cramér–von_Mises_criterion:2">
 <semantics>
  <mrow>
   <msup>
    <mi>ω</mi>
    <mn>2</mn>
   </msup>
   <mo>=</mo>
   <mrow>
    <msubsup>
     <mo largeop="true" symmetric="true">∫</mo>
     <mrow>
      <mo>-</mo>
      <mi mathvariant="normal">∞</mi>
     </mrow>
     <mi mathvariant="normal">∞</mi>
    </msubsup>
    <mrow>
     <mpadded width="+1.7pt">
      <msup>
       <mrow>
        <mo stretchy="false">[</mo>
        <mrow>
         <mrow>
          <msub>
           <mi>F</mi>
           <mi>n</mi>
          </msub>
          <mrow>
           <mo stretchy="false">(</mo>
           <mi>x</mi>
           <mo stretchy="false">)</mo>
          </mrow>
         </mrow>
         <mo>-</mo>
         <mrow>
          <msup>
           <mi>F</mi>
           <mo>*</mo>
          </msup>
          <mrow>
           <mo stretchy="false">(</mo>
           <mi>x</mi>
           <mo stretchy="false">)</mo>
          </mrow>
         </mrow>
        </mrow>
        <mo stretchy="false">]</mo>
       </mrow>
       <mn>2</mn>
      </msup>
     </mpadded>
     <mi mathvariant="normal">d</mi>
     <msup>
      <mi>F</mi>
      <mo>*</mo>
     </msup>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>x</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>ω</ci>
     <cn type="integer">2</cn>
    </apply>
    <apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <int></int>
       <apply>
        <minus></minus>
        <infinity></infinity>
       </apply>
      </apply>
      <infinity></infinity>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="latexml">delimited-[]</csymbol>
        <apply>
         <minus></minus>
         <apply>
          <times></times>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>F</ci>
           <ci>n</ci>
          </apply>
          <ci>x</ci>
         </apply>
         <apply>
          <times></times>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <ci>F</ci>
           <times></times>
          </apply>
          <ci>x</ci>
         </apply>
        </apply>
       </apply>
       <cn type="integer">2</cn>
      </apply>
      <ci>normal-d</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>F</ci>
       <times></times>
      </apply>
      <ci>x</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \omega^{2}=\int_{-\infty}^{\infty}[F_{n}(x)-F^{*}(x)]^{2}\,\mathrm{d}F^{*}(x)
  </annotation>
 </semantics>
</math>

</p>

<p>In one-sample applications 

<math display="inline" id="Cramér–von_Mises_criterion:3">
 <semantics>
  <msup>
   <mi>F</mi>
   <mo>*</mo>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>F</ci>
    <times></times>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   F^{*}
  </annotation>
 </semantics>
</math>

 is the theoretical distribution and 

<math display="inline" id="Cramér–von_Mises_criterion:4">
 <semantics>
  <msub>
   <mi>F</mi>
   <mi>n</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>F</ci>
    <ci>n</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   F_{n}
  </annotation>
 </semantics>
</math>

 is the <a href="empirical_distribution_function" title="wikilink">empirically observed distribution</a>. Alternatively the two distributions can both be empirically estimated ones; this is called the two-sample case.</p>

<p>The criterion is named after <a href="Harald_Cramér" title="wikilink">Harald Cramér</a> and <a href="Richard_Edler_von_Mises" title="wikilink">Richard Edler von Mises</a> who first proposed it in 1928–1930.<a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a> <a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a> The generalization to two samples is due to <a href="Theodore_Wilbur_Anderson" title="wikilink">Anderson</a>.<a class="footnoteRef" href="#fn3" id="fnref3"><sup>3</sup></a></p>

<p>The Cramér–von Mises test is an alternative to the <a href="Kolmogorov–Smirnov_test" title="wikilink">Kolmogorov–Smirnov test</a>.</p>
<h2 id="cramérvon-mises-test-one-sample">Cramér–von Mises test (one sample)</h2>

<p>Let 

<math display="inline" id="Cramér–von_Mises_criterion:5">
 <semantics>
  <mrow>
   <msub>
    <mi>x</mi>
    <mn>1</mn>
   </msub>
   <mo>,</mo>
   <msub>
    <mi>x</mi>
    <mn>2</mn>
   </msub>
   <mo>,</mo>
   <mi mathvariant="normal">⋯</mi>
   <mo>,</mo>
   <msub>
    <mi>x</mi>
    <mi>n</mi>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <list>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>x</ci>
     <cn type="integer">1</cn>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>x</ci>
     <cn type="integer">2</cn>
    </apply>
    <ci>normal-⋯</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>x</ci>
     <ci>n</ci>
    </apply>
   </list>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x_{1},x_{2},\cdots,x_{n}
  </annotation>
 </semantics>
</math>

 be the observed values, in increasing order. Then the statistic is<a class="footnoteRef" href="#fn4" id="fnref4"><sup>4</sup></a><a class="footnoteRef" href="#fn5" id="fnref5"><sup>5</sup></a></p>

<p>

<math display="block" id="Cramér–von_Mises_criterion:6">
 <semantics>
  <mrow>
   <mrow>
    <mi>T</mi>
    <mo>=</mo>
    <mrow>
     <mi>n</mi>
     <msup>
      <mi>ω</mi>
      <mn>2</mn>
     </msup>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mfrac>
      <mn>1</mn>
      <mrow>
       <mn>12</mn>
       <mi>n</mi>
      </mrow>
     </mfrac>
     <mo>+</mo>
     <mrow>
      <munderover>
       <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
       <mrow>
        <mi>i</mi>
        <mo>=</mo>
        <mn>1</mn>
       </mrow>
       <mi>n</mi>
      </munderover>
      <msup>
       <mrow>
        <mo>[</mo>
        <mrow>
         <mfrac>
          <mrow>
           <mrow>
            <mn>2</mn>
            <mi>i</mi>
           </mrow>
           <mo>-</mo>
           <mn>1</mn>
          </mrow>
          <mrow>
           <mn>2</mn>
           <mi>n</mi>
          </mrow>
         </mfrac>
         <mo>-</mo>
         <mrow>
          <mi>F</mi>
          <mrow>
           <mo stretchy="false">(</mo>
           <msub>
            <mi>x</mi>
            <mi>i</mi>
           </msub>
           <mo stretchy="false">)</mo>
          </mrow>
         </mrow>
        </mrow>
        <mo>]</mo>
       </mrow>
       <mn>2</mn>
      </msup>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <ci>T</ci>
     <apply>
      <times></times>
      <ci>n</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>ω</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <plus></plus>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <apply>
        <times></times>
        <cn type="integer">12</cn>
        <ci>n</ci>
       </apply>
      </apply>
      <apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <sum></sum>
         <apply>
          <eq></eq>
          <ci>i</ci>
          <cn type="integer">1</cn>
         </apply>
        </apply>
        <ci>n</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="latexml">delimited-[]</csymbol>
         <apply>
          <minus></minus>
          <apply>
           <divide></divide>
           <apply>
            <minus></minus>
            <apply>
             <times></times>
             <cn type="integer">2</cn>
             <ci>i</ci>
            </apply>
            <cn type="integer">1</cn>
           </apply>
           <apply>
            <times></times>
            <cn type="integer">2</cn>
            <ci>n</ci>
           </apply>
          </apply>
          <apply>
           <times></times>
           <ci>F</ci>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <ci>x</ci>
            <ci>i</ci>
           </apply>
          </apply>
         </apply>
        </apply>
        <cn type="integer">2</cn>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   T=n\omega^{2}=\frac{1}{12n}+\sum_{i=1}^{n}\left[\frac{2i-1}{2n}-F(x_{i})\right%
]^{2}.
  </annotation>
 </semantics>
</math>

</p>

<p>If this value is larger than the tabulated value, then the hypothesis that the data come from the distribution 

<math display="inline" id="Cramér–von_Mises_criterion:7">
 <semantics>
  <mi>F</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>F</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   F
  </annotation>
 </semantics>
</math>

 can be rejected.</p>
<h3 id="watson-test">Watson test</h3>

<p>A modified version of the Cramér–von Mises test is the Watson test<a class="footnoteRef" href="#fn6" id="fnref6"><sup>6</sup></a> which uses the statistic <em>U</em><sup>2</sup>, where<a class="footnoteRef" href="#fn7" id="fnref7"><sup>7</sup></a></p>

<p>

<math display="block" id="Cramér–von_Mises_criterion:8">
 <semantics>
  <mrow>
   <mrow>
    <msup>
     <mi>U</mi>
     <mn>2</mn>
    </msup>
    <mo>=</mo>
    <mrow>
     <mi>T</mi>
     <mo>-</mo>
     <mrow>
      <mi>n</mi>
      <msup>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mover accent="true">
          <mi>F</mi>
          <mo stretchy="false">¯</mo>
         </mover>
         <mo>-</mo>
         <mstyle displaystyle="false">
          <mfrac>
           <mn>1</mn>
           <mn>2</mn>
          </mfrac>
         </mstyle>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
       <mn>2</mn>
      </msup>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>U</ci>
     <cn type="integer">2</cn>
    </apply>
    <apply>
     <minus></minus>
     <ci>T</ci>
     <apply>
      <times></times>
      <ci>n</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <minus></minus>
        <apply>
         <ci>normal-¯</ci>
         <ci>F</ci>
        </apply>
        <apply>
         <divide></divide>
         <cn type="integer">1</cn>
         <cn type="integer">2</cn>
        </apply>
       </apply>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   U^{2}=T-n(\bar{F}-\tfrac{1}{2})^{2},
  </annotation>
 </semantics>
</math>

</p>

<p>where</p>

<p>

<math display="block" id="Cramér–von_Mises_criterion:9">
 <semantics>
  <mrow>
   <mrow>
    <mover accent="true">
     <mi>F</mi>
     <mo stretchy="false">¯</mo>
    </mover>
    <mo>=</mo>
    <mrow>
     <mfrac>
      <mn>1</mn>
      <mi>n</mi>
     </mfrac>
     <mrow>
      <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
      <mrow>
       <mi>F</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <msub>
         <mi>x</mi>
         <mi>i</mi>
        </msub>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <ci>normal-¯</ci>
     <ci>F</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <divide></divide>
      <cn type="integer">1</cn>
      <ci>n</ci>
     </apply>
     <apply>
      <sum></sum>
      <apply>
       <times></times>
       <ci>F</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <ci>i</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \bar{F}=\frac{1}{n}\sum F(x_{i}).
  </annotation>
 </semantics>
</math>

</p>
<h2 id="cramérvon-mises-test-two-samples">Cramér–von Mises test (two samples)</h2>

<p>Let 

<math display="inline" id="Cramér–von_Mises_criterion:10">
 <semantics>
  <mrow>
   <msub>
    <mi>x</mi>
    <mn>1</mn>
   </msub>
   <mo>,</mo>
   <msub>
    <mi>x</mi>
    <mn>2</mn>
   </msub>
   <mo>,</mo>
   <mi mathvariant="normal">⋯</mi>
   <mo>,</mo>
   <msub>
    <mi>x</mi>
    <mi>N</mi>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <list>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>x</ci>
     <cn type="integer">1</cn>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>x</ci>
     <cn type="integer">2</cn>
    </apply>
    <ci>normal-⋯</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>x</ci>
     <ci>N</ci>
    </apply>
   </list>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x_{1},x_{2},\cdots,x_{N}
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Cramér–von_Mises_criterion:11">
 <semantics>
  <mrow>
   <msub>
    <mi>y</mi>
    <mn>1</mn>
   </msub>
   <mo>,</mo>
   <msub>
    <mi>y</mi>
    <mn>2</mn>
   </msub>
   <mo>,</mo>
   <mi mathvariant="normal">⋯</mi>
   <mo>,</mo>
   <msub>
    <mi>y</mi>
    <mi>M</mi>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <list>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>y</ci>
     <cn type="integer">1</cn>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>y</ci>
     <cn type="integer">2</cn>
    </apply>
    <ci>normal-⋯</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>y</ci>
     <ci>M</ci>
    </apply>
   </list>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   y_{1},y_{2},\cdots,y_{M}
  </annotation>
 </semantics>
</math>

 be the observed values in the first and second sample respectively, in increasing order. Let 

<math display="inline" id="Cramér–von_Mises_criterion:12">
 <semantics>
  <mrow>
   <msub>
    <mi>r</mi>
    <mn>1</mn>
   </msub>
   <mo>,</mo>
   <msub>
    <mi>r</mi>
    <mn>2</mn>
   </msub>
   <mo>,</mo>
   <mi mathvariant="normal">⋯</mi>
   <mo>,</mo>
   <msub>
    <mi>r</mi>
    <mi>N</mi>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <list>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>r</ci>
     <cn type="integer">1</cn>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>r</ci>
     <cn type="integer">2</cn>
    </apply>
    <ci>normal-⋯</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>r</ci>
     <ci>N</ci>
    </apply>
   </list>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   r_{1},r_{2},\cdots,r_{N}
  </annotation>
 </semantics>
</math>

 be the ranks of the x's in the combined sample, and let 

<math display="inline" id="Cramér–von_Mises_criterion:13">
 <semantics>
  <mrow>
   <msub>
    <mi>s</mi>
    <mn>1</mn>
   </msub>
   <mo>,</mo>
   <msub>
    <mi>s</mi>
    <mn>2</mn>
   </msub>
   <mo>,</mo>
   <mi mathvariant="normal">⋯</mi>
   <mo>,</mo>
   <msub>
    <mi>s</mi>
    <mi>M</mi>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <list>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>s</ci>
     <cn type="integer">1</cn>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>s</ci>
     <cn type="integer">2</cn>
    </apply>
    <ci>normal-⋯</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>s</ci>
     <ci>M</ci>
    </apply>
   </list>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   s_{1},s_{2},\cdots,s_{M}
  </annotation>
 </semantics>
</math>

 be the ranks of the y's in the combined sample. Anderson<a class="footnoteRef" href="#fn8" id="fnref8"><sup>8</sup></a> shows that</p>

<p>

<math display="block" id="Cramér–von_Mises_criterion:14">
 <semantics>
  <mrow>
   <mi>T</mi>
   <mo>=</mo>
   <mrow>
    <mi>N</mi>
    <msup>
     <mi>ω</mi>
     <mn>2</mn>
    </msup>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mfrac>
     <mi>U</mi>
     <mrow>
      <mi>N</mi>
      <mi>M</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mi>N</mi>
        <mo>+</mo>
        <mi>M</mi>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mfrac>
    <mo>-</mo>
    <mfrac>
     <mrow>
      <mrow>
       <mn>4</mn>
       <mi>M</mi>
       <mi>N</mi>
      </mrow>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
     <mrow>
      <mn>6</mn>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mi>M</mi>
        <mo>+</mo>
        <mi>N</mi>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mfrac>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <ci>T</ci>
     <apply>
      <times></times>
      <ci>N</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>ω</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <minus></minus>
      <apply>
       <divide></divide>
       <ci>U</ci>
       <apply>
        <times></times>
        <ci>N</ci>
        <ci>M</ci>
        <apply>
         <plus></plus>
         <ci>N</ci>
         <ci>M</ci>
        </apply>
       </apply>
      </apply>
      <apply>
       <divide></divide>
       <apply>
        <minus></minus>
        <apply>
         <times></times>
         <cn type="integer">4</cn>
         <ci>M</ci>
         <ci>N</ci>
        </apply>
        <cn type="integer">1</cn>
       </apply>
       <apply>
        <times></times>
        <cn type="integer">6</cn>
        <apply>
         <plus></plus>
         <ci>M</ci>
         <ci>N</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   T=N\omega^{2}=\frac{U}{NM(N+M)}-\frac{4MN-1}{6(M+N)}
  </annotation>
 </semantics>
</math>

</p>

<p>where U is defined as</p>

<p>

<math display="block" id="Cramér–von_Mises_criterion:15">
 <semantics>
  <mrow>
   <mi>U</mi>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mi>N</mi>
     <mrow>
      <munderover>
       <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
       <mrow>
        <mi>i</mi>
        <mo>=</mo>
        <mn>1</mn>
       </mrow>
       <mi>N</mi>
      </munderover>
      <msup>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <msub>
          <mi>r</mi>
          <mi>i</mi>
         </msub>
         <mo>-</mo>
         <mi>i</mi>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
       <mn>2</mn>
      </msup>
     </mrow>
    </mrow>
    <mo>+</mo>
    <mrow>
     <mi>M</mi>
     <mrow>
      <munderover>
       <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
       <mrow>
        <mi>j</mi>
        <mo>=</mo>
        <mn>1</mn>
       </mrow>
       <mi>M</mi>
      </munderover>
      <msup>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <msub>
          <mi>s</mi>
          <mi>j</mi>
         </msub>
         <mo>-</mo>
         <mi>j</mi>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
       <mn>2</mn>
      </msup>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>U</ci>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <ci>N</ci>
      <apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <sum></sum>
         <apply>
          <eq></eq>
          <ci>i</ci>
          <cn type="integer">1</cn>
         </apply>
        </apply>
        <ci>N</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <minus></minus>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>r</ci>
          <ci>i</ci>
         </apply>
         <ci>i</ci>
        </apply>
        <cn type="integer">2</cn>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <ci>M</ci>
      <apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <sum></sum>
         <apply>
          <eq></eq>
          <ci>j</ci>
          <cn type="integer">1</cn>
         </apply>
        </apply>
        <ci>M</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <minus></minus>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>s</ci>
          <ci>j</ci>
         </apply>
         <ci>j</ci>
        </apply>
        <cn type="integer">2</cn>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   U=N\sum_{i=1}^{N}(r_{i}-i)^{2}+M\sum_{j=1}^{M}(s_{j}-j)^{2}
  </annotation>
 </semantics>
</math>

</p>

<p>If the value of T is larger than the tabulated values,<a class="footnoteRef" href="#fn9" id="fnref9"><sup>9</sup></a> the hypothesis that the two samples come from the same distribution can be rejected. (Some books give critical values for U, which is more convenient, as it avoids the need to compute T via the expression above. The conclusion will be the same).</p>

<p>The above assumes there are no duplicates in the 

<math display="inline" id="Cramér–von_Mises_criterion:16">
 <semantics>
  <mi>x</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>x</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x
  </annotation>
 </semantics>
</math>

, 

<math display="inline" id="Cramér–von_Mises_criterion:17">
 <semantics>
  <mi>y</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>y</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   y
  </annotation>
 </semantics>
</math>

, and 

<math display="inline" id="Cramér–von_Mises_criterion:18">
 <semantics>
  <mi>r</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>r</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   r
  </annotation>
 </semantics>
</math>

 sequences. So 

<math display="inline" id="Cramér–von_Mises_criterion:19">
 <semantics>
  <msub>
   <mi>x</mi>
   <mi>i</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>x</ci>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x_{i}
  </annotation>
 </semantics>
</math>

 is unique, and its rank is 

<math display="inline" id="Cramér–von_Mises_criterion:20">
 <semantics>
  <mi>i</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>i</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   i
  </annotation>
 </semantics>
</math>

 in the sorted list 

<math display="inline" id="Cramér–von_Mises_criterion:21">
 <semantics>
  <mrow>
   <msub>
    <mi>x</mi>
    <mn>1</mn>
   </msub>
   <mo>,</mo>
   <mrow>
    <mi mathvariant="normal">…</mi>
    <msub>
     <mi>x</mi>
     <mi>N</mi>
    </msub>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <list>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>x</ci>
     <cn type="integer">1</cn>
    </apply>
    <apply>
     <times></times>
     <ci>normal-…</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <ci>N</ci>
     </apply>
    </apply>
   </list>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x_{1},...x_{N}
  </annotation>
 </semantics>
</math>

. If there are duplicates, and 

<math display="inline" id="Cramér–von_Mises_criterion:22">
 <semantics>
  <msub>
   <mi>x</mi>
   <mi>i</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>x</ci>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x_{i}
  </annotation>
 </semantics>
</math>

 through 

<math display="inline" id="Cramér–von_Mises_criterion:23">
 <semantics>
  <msub>
   <mi>x</mi>
   <mi>j</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>x</ci>
    <ci>j</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x_{j}
  </annotation>
 </semantics>
</math>

 are a run of identical values in the sorted list, then one common approach is the <em>midrank</em><a class="footnoteRef" href="#fn10" id="fnref10"><sup>10</sup></a> method: assign each duplicate a "rank" of 

<math display="inline" id="Cramér–von_Mises_criterion:24">
 <semantics>
  <mrow>
   <mrow>
    <mo stretchy="false">(</mo>
    <mrow>
     <mi>i</mi>
     <mo>+</mo>
     <mi>j</mi>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>/</mo>
   <mn>2</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <divide></divide>
    <apply>
     <plus></plus>
     <ci>i</ci>
     <ci>j</ci>
    </apply>
    <cn type="integer">2</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (i+j)/2
  </annotation>
 </semantics>
</math>

. In the above equations, in the expressions 

<math display="inline" id="Cramér–von_Mises_criterion:25">
 <semantics>
  <msup>
   <mrow>
    <mo stretchy="false">(</mo>
    <mrow>
     <msub>
      <mi>r</mi>
      <mi>i</mi>
     </msub>
     <mo>-</mo>
     <mi>i</mi>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
   <mn>2</mn>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <apply>
     <minus></minus>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>r</ci>
      <ci>i</ci>
     </apply>
     <ci>i</ci>
    </apply>
    <cn type="integer">2</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (r_{i}-i)^{2}
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Cramér–von_Mises_criterion:26">
 <semantics>
  <msup>
   <mrow>
    <mo stretchy="false">(</mo>
    <mrow>
     <msub>
      <mi>s</mi>
      <mi>j</mi>
     </msub>
     <mo>-</mo>
     <mi>j</mi>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
   <mn>2</mn>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <apply>
     <minus></minus>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>s</ci>
      <ci>j</ci>
     </apply>
     <ci>j</ci>
    </apply>
    <cn type="integer">2</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (s_{j}-j)^{2}
  </annotation>
 </semantics>
</math>

, duplicates can modify all four variables 

<math display="inline" id="Cramér–von_Mises_criterion:27">
 <semantics>
  <msub>
   <mi>r</mi>
   <mi>i</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>r</ci>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   r_{i}
  </annotation>
 </semantics>
</math>

, 

<math display="inline" id="Cramér–von_Mises_criterion:28">
 <semantics>
  <mi>i</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>i</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   i
  </annotation>
 </semantics>
</math>

, 

<math display="inline" id="Cramér–von_Mises_criterion:29">
 <semantics>
  <msub>
   <mi>s</mi>
   <mi>j</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>s</ci>
    <ci>j</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   s_{j}
  </annotation>
 </semantics>
</math>

, and 

<math display="inline" id="Cramér–von_Mises_criterion:30">
 <semantics>
  <mi>j</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>j</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   j
  </annotation>
 </semantics>
</math>

.</p>
<h2 id="references">References</h2>
<ul>
<li></li>
</ul>
<h2 id="further-reading">Further reading</h2>
<ul>
<li></li>
</ul>
<h2 id="external-links">External links</h2>
<ul>
<li><a href="http://finzi.psych.upenn.edu/R/library/CvM2SL2Test/html/00Index.html">C-vM Two Sample Test</a> (Documentation for performing the test using <a href="R_(programming_language)" title="wikilink">R</a></li>
</ul>

<p>"</p>

<p><a href="Category:Statistical_tests" title="wikilink">Category:Statistical tests</a> <a href="Category:Statistical_distance_measures" title="wikilink">Category:Statistical distance measures</a> <a href="Category:Non-parametric_statistics" title="wikilink">Category:Non-parametric statistics</a> <a href="Category:Normality_tests" title="wikilink">Category:Normality tests</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1">H. Cramér, On the composition of elementary errors, Scandinavian Actuarial Journal 1928<a href="#fnref1">↩</a></li>
<li id="fn2">R. E. von Mises, Wahrscheinlichkeit, Statistik und Wahrheit, Julius Springer 1928<a href="#fnref2">↩</a></li>
<li id="fn3"><a href="#fnref3">↩</a></li>
<li id="fn4"></li>
<li id="fn5"><a href="Egon_Pearson" title="wikilink">Pearson, E.S.</a>, Hartley, H.O. (1972) <em>Biometrika Tables for Statisticians, Volume 2</em>, CUP. ISBN 0-521-06937-8 (page 118 and Table 54)<a href="#fnref5">↩</a></li>
<li id="fn6">Watson, G.S. (1961) "Goodness-Of-Fit Tests on a Circle", <em><a class="uri" href="Biometrika" title="wikilink">Biometrika</a></em>, 48 (1/2), 109-114 <a href="#fnref6">↩</a></li>
<li id="fn7"></li>
<li id="fn8"></li>
<li id="fn9"></li>
<li id="fn10">Ruymgaart, F. H., (1980) "A unified approach to the asymptotic distribution theory of certain midrank statistics". In: <em>Statistique non Parametrique Asymptotique</em>, 1±18, J. P. Raoult (Ed.), Lecture Notes on Mathematics, No. 821, Springer, Berlin.<a href="#fnref10">↩</a></li>
</ol>
</section>
</body>
</html>

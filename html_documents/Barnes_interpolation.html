<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="455">Barnes interpolation</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Barnes interpolation</h1>
<hr/>

<p><strong>Barnes interpolation</strong>, named after Stanley L. Barnes, is the <a class="uri" href="interpolation" title="wikilink">interpolation</a> of unstructured data points from a set of measurements of an unknown function in two dimensions into an <a href="analytic_function" title="wikilink">analytic function</a> of two variables. An example of a situation where the Barnes scheme is important is in <a href="weather_forecasting" title="wikilink">weather forecasting</a><a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a><a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a> where measurements are made wherever monitoring stations may be located, the positions of which are constrained by <a class="uri" href="topography" title="wikilink">topography</a>. Such interpolation is essential in data visualisation, e.g. in the construction of <a href="contour_plot" title="wikilink">contour plots</a> or other representations of analytic surfaces.</p>
<h2 id="introduction">Introduction</h2>

<p>Barnes proposed an objective scheme for the interpolation of two dimensional data using a multi-pass scheme.<a class="footnoteRef" href="#fn3" id="fnref3"><sup>3</sup></a><a class="footnoteRef" href="#fn4" id="fnref4"><sup>4</sup></a> This provided a method to interpolating sea-level pressures across the entire United States of America, producing a <a href="synoptic_chart" title="wikilink">synoptic chart</a> across the country using dispersed monitoring stations. Researchers have subsequently improved the Barnes method to reduce the number of parameters required for calculation of the interpolated result, increasing the objectivity of the method.<a class="footnoteRef" href="#fn5" id="fnref5"><sup>5</sup></a></p>

<p>The method constructs a grid of size determined by the distribution of the two dimensional data points. Using this grid, the function values are calculated at each grid point. To do this the method utilises a series of <a href="Gaussian_function" title="wikilink">Gaussian functions</a>, given a <a href="distance_weighting" title="wikilink">distance weighting</a> in order to determine the relative importance of any given measurement on the determination of the function values. Correction passes are then made to optimise the function values, by accounting for the <a href="spectral_response" title="wikilink">spectral response</a> of the interpolated points.</p>
<h2 id="method">Method</h2>

<p>Here we describe the method of interpolation used in a multi-pass Barnes interpolation.</p>
<h3 id="first-pass">First pass</h3>

<p>For a given grid point <em>i</em>, <em>j</em> the interpolated function <em>g</em>(<em>x</em><sub><em>i</em></sub>, <em>y</em><sub><em>i</em></sub>) is first approximated by the inverse weighting of the data points. To do this as weighting values is assigned to each Gaussian for each grid point, such that</p>

<p>
<math display="block" id="Barnes_interpolation:0">
<semantics>
<mrow>
<mrow>
<msub>
<mi>w</mi>
<mrow>
<mi>i</mi>
<mi>j</mi>
</mrow>
</msub>
<mo>=</mo>
<mrow>
<mi>exp</mi>
<mrow>
<mo>(</mo>
<mrow>
<mo>-</mo>
<mfrac>
<msubsup>
<mi>r</mi>
<mi>m</mi>
<mn>2</mn>
</msubsup>
<mi>κ</mi>
</mfrac>
</mrow>
<mo>)</mo>
</mrow>
</mrow>
</mrow>
<mo>,</mo>
</mrow>
<annotation-xml encoding="MathML-Content">
<apply>
<eq></eq>
<apply>
<csymbol cd="ambiguous">subscript</csymbol>
<ci>w</ci>
<apply>
<times></times>
<ci>i</ci>
<ci>j</ci>
</apply>
</apply>
<apply>
<exp></exp>
<apply>
<minus></minus>
<apply>
<divide></divide>
<apply>
<csymbol cd="ambiguous">superscript</csymbol>
<apply>
<csymbol cd="ambiguous">subscript</csymbol>
<ci>r</ci>
<ci>m</ci>
</apply>
<cn type="integer">2</cn>
</apply>
<ci>κ</ci>
</apply>
</apply>
</apply>
</apply>
</annotation-xml>
<annotation encoding="application/x-tex">
   w_{ij}=\exp\left(-\frac{r_{m}^{2}}{\kappa}\right),\,
  </annotation>
</semantics>
</math>
</p>

<p>where 

<math display="inline" id="Barnes_interpolation:1">
<semantics>
<mi>κ</mi>
<annotation-xml encoding="MathML-Content">
<ci>κ</ci>
</annotation-xml>
<annotation encoding="application/x-tex">
   \kappa
  </annotation>
</semantics>
</math>

 is a falloff parameter that controls the width of the Gaussian function. This parameter is controlled by the characteristic data spacing, for a fixed Gaussian cutoff radius <em>w</em><sub><em>ij</em></sub> = <em>e</em><sup>−1</sup> giving Δ<em>n</em> such that:</p>

<p>
<math display="block" id="Barnes_interpolation:2">
<semantics>
<mrow>
<mrow>
<mi>κ</mi>
<mo>=</mo>
<mrow>
<mpadded width="+1.7pt">
<mn>5.052</mn>
</mpadded>
<msup>
<mrow>
<mo>(</mo>
<mfrac>
<mrow>
<mpadded width="+1.7pt">
<mn>2</mn>
</mpadded>
<mi mathvariant="normal">Δ</mi>
<mi>n</mi>
</mrow>
<mi>π</mi>
</mfrac>
<mo>)</mo>
</mrow>
<mn>2</mn>
</msup>
</mrow>
</mrow>
<mo>.</mo>
</mrow>
<annotation-xml encoding="MathML-Content">
<apply>
<eq></eq>
<ci>κ</ci>
<apply>
<times></times>
<cn type="float">5.052</cn>
<apply>
<csymbol cd="ambiguous">superscript</csymbol>
<apply>
<divide></divide>
<apply>
<times></times>
<cn type="integer">2</cn>
<ci>normal-Δ</ci>
<ci>n</ci>
</apply>
<ci>π</ci>
</apply>
<cn type="integer">2</cn>
</apply>
</apply>
</apply>
</annotation-xml>
<annotation encoding="application/x-tex">
   \kappa=5.052\,\left(\frac{2\,\Delta n}{\pi}\right)^{2}.\,
  </annotation>
</semantics>
</math>
</p>

<p>The initial interpolation for the function from the measured values 

<math display="inline" id="Barnes_interpolation:3">
<semantics>
<mrow>
<msub>
<mi>f</mi>
<mi>k</mi>
</msub>
<mrow>
<mo stretchy="false">(</mo>
<mi>x</mi>
<mo>,</mo>
<mi>y</mi>
<mo stretchy="false">)</mo>
</mrow>
</mrow>
<annotation-xml encoding="MathML-Content">
<apply>
<times></times>
<apply>
<csymbol cd="ambiguous">subscript</csymbol>
<ci>f</ci>
<ci>k</ci>
</apply>
<interval closure="open">
<ci>x</ci>
<ci>y</ci>
</interval>
</apply>
</annotation-xml>
<annotation encoding="application/x-tex">
   f_{k}(x,y)
  </annotation>
</semantics>
</math>


 then becomes:</p>

<p>
<math display="block" id="Barnes_interpolation:4">
<semantics>
<mrow>
<mrow>
<mrow>
<msub>
<mi>g</mi>
<mn>0</mn>
</msub>
<mrow>
<mo stretchy="false">(</mo>
<msub>
<mi>x</mi>
<mi>i</mi>
</msub>
<mo>,</mo>
<msub>
<mi>y</mi>
<mi>j</mi>
</msub>
<mo stretchy="false">)</mo>
</mrow>
</mrow>
<mo>=</mo>
<mfrac>
<mrow>
<mstyle displaystyle="true">
<munder>
<mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
<mi>k</mi>
</munder>
</mstyle>
<mrow>
<msub>
<mi>w</mi>
<mrow>
<mi>i</mi>
<mi>j</mi>
</mrow>
</msub>
<msub>
<mi>f</mi>
<mi>k</mi>
</msub>
<mrow>
<mo stretchy="false">(</mo>
<mi>x</mi>
<mo>,</mo>
<mi>y</mi>
<mo stretchy="false">)</mo>
</mrow>
</mrow>
</mrow>
<mrow>
<mstyle displaystyle="true">
<munder>
<mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
<mi>k</mi>
</munder>
</mstyle>
<msub>
<mi>w</mi>
<mrow>
<mi>i</mi>
<mi>j</mi>
</mrow>
</msub>
</mrow>
</mfrac>
</mrow>
<mo>.</mo>
</mrow>
<annotation-xml encoding="MathML-Content">
<apply>
<eq></eq>
<apply>
<times></times>
<apply>
<csymbol cd="ambiguous">subscript</csymbol>
<ci>g</ci>
<cn type="integer">0</cn>
</apply>
<interval closure="open">
<apply>
<csymbol cd="ambiguous">subscript</csymbol>
<ci>x</ci>
<ci>i</ci>
</apply>
<apply>
<csymbol cd="ambiguous">subscript</csymbol>
<ci>y</ci>
<ci>j</ci>
</apply>
</interval>
</apply>
<apply>
<divide></divide>
<apply>
<apply>
<csymbol cd="ambiguous">subscript</csymbol>
<sum></sum>
<ci>k</ci>
</apply>
<apply>
<times></times>
<apply>
<csymbol cd="ambiguous">subscript</csymbol>
<ci>w</ci>
<apply>
<times></times>
<ci>i</ci>
<ci>j</ci>
</apply>
</apply>
<apply>
<csymbol cd="ambiguous">subscript</csymbol>
<ci>f</ci>
<ci>k</ci>
</apply>
<interval closure="open">
<ci>x</ci>
<ci>y</ci>
</interval>
</apply>
</apply>
<apply>
<apply>
<csymbol cd="ambiguous">subscript</csymbol>
<sum></sum>
<ci>k</ci>
</apply>
<apply>
<csymbol cd="ambiguous">subscript</csymbol>
<ci>w</ci>
<apply>
<times></times>
<ci>i</ci>
<ci>j</ci>
</apply>
</apply>
</apply>
</apply>
</apply>
</annotation-xml>
<annotation encoding="application/x-tex">
   g_{0}(x_{i},y_{j})=\frac{\displaystyle\sum_{k}w_{ij}f_{k}(x,y)}{\displaystyle%
\sum_{k}w_{ij}}.
  </annotation>
</semantics>
</math>
</p>
<h3 id="second-pass">Second pass</h3>

<p>The correction for the next pass then utilises the difference between the observed field and the interpolated values at the measurement points to optimise the result:<a class="footnoteRef" href="#fn6" id="fnref6"><sup>6</sup></a></p>

<p>
<math display="block" id="Barnes_interpolation:5">
<semantics>
<mrow>
<mrow>
<mrow>
<msub>
<mi>g</mi>
<mn>1</mn>
</msub>
<mrow>
<mo stretchy="false">(</mo>
<msub>
<mi>x</mi>
<mi>i</mi>
</msub>
<mo>,</mo>
<msub>
<mi>y</mi>
<mi>j</mi>
</msub>
<mo stretchy="false">)</mo>
</mrow>
</mrow>
<mo>=</mo>
<mrow>
<mrow>
<msub>
<mi>g</mi>
<mn>0</mn>
</msub>
<mrow>
<mo stretchy="false">(</mo>
<msub>
<mi>x</mi>
<mi>i</mi>
</msub>
<mo>,</mo>
<msub>
<mi>y</mi>
<mi>j</mi>
</msub>
<mo stretchy="false">)</mo>
</mrow>
</mrow>
<mo>+</mo>
<mrow>
<mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
<mrow>
<mrow>
<mo stretchy="false">(</mo>
<mrow>
<mrow>
<mi>f</mi>
<mrow>
<mo stretchy="false">(</mo>
<mi>x</mi>
<mo>,</mo>
<mi>y</mi>
<mo stretchy="false">)</mo>
</mrow>
</mrow>
<mo>-</mo>
<mrow>
<msub>
<mi>g</mi>
<mn>0</mn>
</msub>
<mrow>
<mo stretchy="false">(</mo>
<mi>x</mi>
<mo>,</mo>
<mi>y</mi>
<mo stretchy="false">)</mo>
</mrow>
</mrow>
</mrow>
<mo stretchy="false">)</mo>
</mrow>
<mrow>
<mi>exp</mi>
<mrow>
<mo>(</mo>
<mrow>
<mo>-</mo>
<mfrac>
<msubsup>
<mi>r</mi>
<mi>m</mi>
<mn>2</mn>
</msubsup>
<mrow>
<mi>γ</mi>
<mi>κ</mi>
</mrow>
</mfrac>
</mrow>
<mo>)</mo>
</mrow>
</mrow>
</mrow>
</mrow>
</mrow>
</mrow>
<mo>.</mo>
</mrow>
<annotation-xml encoding="MathML-Content">
<apply>
<eq></eq>
<apply>
<times></times>
<apply>
<csymbol cd="ambiguous">subscript</csymbol>
<ci>g</ci>
<cn type="integer">1</cn>
</apply>
<interval closure="open">
<apply>
<csymbol cd="ambiguous">subscript</csymbol>
<ci>x</ci>
<ci>i</ci>
</apply>
<apply>
<csymbol cd="ambiguous">subscript</csymbol>
<ci>y</ci>
<ci>j</ci>
</apply>
</interval>
</apply>
<apply>
<plus></plus>
<apply>
<times></times>
<apply>
<csymbol cd="ambiguous">subscript</csymbol>
<ci>g</ci>
<cn type="integer">0</cn>
</apply>
<interval closure="open">
<apply>
<csymbol cd="ambiguous">subscript</csymbol>
<ci>x</ci>
<ci>i</ci>
</apply>
<apply>
<csymbol cd="ambiguous">subscript</csymbol>
<ci>y</ci>
<ci>j</ci>
</apply>
</interval>
</apply>
<apply>
<sum></sum>
<apply>
<times></times>
<apply>
<minus></minus>
<apply>
<times></times>
<ci>f</ci>
<interval closure="open">
<ci>x</ci>
<ci>y</ci>
</interval>
</apply>
<apply>
<times></times>
<apply>
<csymbol cd="ambiguous">subscript</csymbol>
<ci>g</ci>
<cn type="integer">0</cn>
</apply>
<interval closure="open">
<ci>x</ci>
<ci>y</ci>
</interval>
</apply>
</apply>
<apply>
<exp></exp>
<apply>
<minus></minus>
<apply>
<divide></divide>
<apply>
<csymbol cd="ambiguous">superscript</csymbol>
<apply>
<csymbol cd="ambiguous">subscript</csymbol>
<ci>r</ci>
<ci>m</ci>
</apply>
<cn type="integer">2</cn>
</apply>
<apply>
<times></times>
<ci>γ</ci>
<ci>κ</ci>
</apply>
</apply>
</apply>
</apply>
</apply>
</apply>
</apply>
</apply>
</annotation-xml>
<annotation encoding="application/x-tex">
   g_{1}(x_{i},y_{j})=g_{0}(x_{i},y_{j})+\sum(f(x,y)-g_{0}(x,y))\exp\left(-\frac{%
r_{m}^{2}}{\gamma\kappa}\right).\,
  </annotation>
</semantics>
</math>
</p>

<p>It is worth to note that successive correction steps can be used in order to achieve better agreement between the interpolated function and the measured values at the experimental points.</p>
<h2 id="parameter-selection">Parameter selection</h2>

<p>Although described as an objective method, there are many parameters which control the interpolated field. The choice of Δ<em>n</em>, grid spacing Δ<em>x</em> and 

<math display="inline" id="Barnes_interpolation:6">
<semantics>
<mi>γ</mi>
<annotation-xml encoding="MathML-Content">
<ci>γ</ci>
</annotation-xml>
<annotation encoding="application/x-tex">
   \gamma
  </annotation>
</semantics>
</math>

 as well influence the final result. Guidelines for the selection of these parameters have been suggested,<a class="footnoteRef" href="#fn7" id="fnref7"><sup>7</sup></a> however the final values used are free to be chosen within these guidelines.</p>

<p>The data spacing used in the analysis, Δ<em>n</em> may be chosen either by calculating the true experimental data inter-point spacing, or by the use of a <a href="complete_spatial_randomness" title="wikilink">complete spatial randomness</a> assumption, depending upon the degree of <a href="Cluster_analysis" title="wikilink">clustering</a> in the observed data. The smoothing parameter 

<math display="inline" id="Barnes_interpolation:7">
<semantics>
<mi>γ</mi>
<annotation-xml encoding="MathML-Content">
<ci>γ</ci>
</annotation-xml>
<annotation encoding="application/x-tex">
   \gamma
  </annotation>
</semantics>
</math>

 is constrained to be between 0.2 and 1.0. For reasons of interpolation integrity, Δ<em>x</em> is argued to be constrained between 0.3 and 0.5.</p>
<h2 id="notes">Notes</h2>
<references>
</references>

<p>"</p>

<p><a class="uri" href="Category:Interpolation" title="wikilink">Category:Interpolation</a> <a href="Category:Spatial_data_analysis" title="wikilink">Category:Spatial data analysis</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1"><a href="#fnref1">↩</a></li>
<li id="fn2"><a href="#fnref2">↩</a></li>
<li id="fn3"><a href="#fnref3">↩</a></li>
<li id="fn4"><a href="#fnref4">↩</a></li>
<li id="fn5"><a href="#fnref5">↩</a></li>
<li id="fn6"></li>
<li id="fn7"></li>
</ol>
</section>
</body>
</html>

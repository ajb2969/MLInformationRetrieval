<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="1669">Proofs of Fermat's theorem on sums of two squares</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Proofs of Fermat's theorem on sums of two squares</h1>
<hr/>

<p><a href="Fermat's_theorem_on_sums_of_two_squares" title="wikilink">Fermat's theorem on sums of two squares</a> asserts that an odd <a href="prime_number" title="wikilink">prime number</a> <em>p</em> can be expressed as</p>

<p>

<math display="block" id="Proofs_of_Fermat's_theorem_on_sums_of_two_squares:0">
 <semantics>
  <mrow>
   <mi>p</mi>
   <mo>=</mo>
   <mrow>
    <msup>
     <mi>x</mi>
     <mn>2</mn>
    </msup>
    <mo>+</mo>
    <msup>
     <mi>y</mi>
     <mn>2</mn>
    </msup>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>p</ci>
    <apply>
     <plus></plus>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>x</ci>
      <cn type="integer">2</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>y</ci>
      <cn type="integer">2</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p=x^{2}+y^{2}
  </annotation>
 </semantics>
</math>

</p>

<p>with <a class="uri" href="integer" title="wikilink">integer</a> <em>x</em> and <em>y</em> if and only if <em>p</em> is <a href="Modular_arithmetic" title="wikilink">congruent</a> to 1 (mod 4). The statement was announced by <a href="Pierre_de_Fermat" title="wikilink">Fermat</a> in 1640, but he supplied no proof.</p>

<p>The "only if" clause is easy: a <a href="Square_number" title="wikilink">perfect square</a> is congruent to 0 or 1 modulo 4, hence a sum of two squares is congruent to 0, 1, or 2. An odd prime number is congruent to either 1 or 3 modulo 4, and the second possibility has just been ruled out. The first proof that such a representation exists was given by <a href="Leonhard_Euler" title="wikilink">Leonhard Euler</a> in 1747 and was complicated. Since then, many different proofs have been found. Among them, the proof using <a href="Minkowski's_theorem" title="wikilink">Minkowski's theorem</a> about <a href="convex_set" title="wikilink">convex sets</a><a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a> and <a href="Don_Zagier" title="wikilink">Don Zagier</a>'s short proof based on involutions have appeared.</p>
<h2 id="eulers-proof-by-infinite-descent">Euler's proof by infinite descent</h2>

<p><a href="Leonhard_Euler" title="wikilink">Euler</a> succeeded in proving Fermat's theorem on sums of two squares in 1749, when he was forty-two years old. He communicated this in a letter to <a href="Christian_Goldbach" title="wikilink">Goldbach</a> dated 12 April 1749.<a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a> The proof relies on <a href="Proof_by_infinite_descent" title="wikilink">infinite descent</a>, and is only briefly sketched in the letter. The full proof consists in five steps and is published in two papers. The first four steps are Propositions 1 to 4 of the first paper<a class="footnoteRef" href="#fn3" id="fnref3"><sup>3</sup></a> and do not correspond exactly to the four steps below. The fifth step below is from the second paper.<a class="footnoteRef" href="#fn4" id="fnref4"><sup>4</sup></a></p>

<p>1. <em>The product of two numbers, each of which is a sum of two squares, is itself a sum of two squares.</em></p>
<dl>
<dd><dl>
<dd>This is a well known property, based on the identity
</dd>
</dl>
</dd>
</dl>
<dl>
<dd><dl>
<dd>

<math display="inline" id="Proofs_of_Fermat's_theorem_on_sums_of_two_squares:1">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <msup>
       <mi>a</mi>
       <mn>2</mn>
      </msup>
      <mo>+</mo>
      <msup>
       <mi>b</mi>
       <mn>2</mn>
      </msup>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <msup>
       <mi>p</mi>
       <mn>2</mn>
      </msup>
      <mo>+</mo>
      <msup>
       <mi>q</mi>
       <mn>2</mn>
      </msup>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <msup>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mrow>
        <mi>a</mi>
        <mi>p</mi>
       </mrow>
       <mo>+</mo>
       <mrow>
        <mi>b</mi>
        <mi>q</mi>
       </mrow>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <mn>2</mn>
    </msup>
    <mo>+</mo>
    <mpadded width="+1.7pt">
     <msup>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mrow>
         <mi>a</mi>
         <mi>q</mi>
        </mrow>
        <mo>-</mo>
        <mrow>
         <mi>b</mi>
         <mi>p</mi>
        </mrow>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
      <mn>2</mn>
     </msup>
    </mpadded>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <plus></plus>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>a</ci>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>b</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
     <apply>
      <plus></plus>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>p</ci>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>q</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <plus></plus>
       <apply>
        <times></times>
        <ci>a</ci>
        <ci>p</ci>
       </apply>
       <apply>
        <times></times>
        <ci>b</ci>
        <ci>q</ci>
       </apply>
      </apply>
      <cn type="integer">2</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <minus></minus>
       <apply>
        <times></times>
        <ci>a</ci>
        <ci>q</ci>
       </apply>
       <apply>
        <times></times>
        <ci>b</ci>
        <ci>p</ci>
       </apply>
      </apply>
      <cn type="integer">2</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (a^{2}+b^{2})(p^{2}+q^{2})=(ap+bq)^{2}+(aq-bp)^{2}\,
  </annotation>
 </semantics>
</math>


</dd>
</dl>
</dd>
</dl>
<dl>
<dd><dl>
<dd>due to <a href="Brahmagupta–Fibonacci_identity" title="wikilink">Diophantus of Alexandria</a>.
</dd>
</dl>
</dd>
</dl>

<p>2. <em>If a number which is a sum of two squares is divisible by a prime which is a sum of two squares, then the quotient is a sum of two squares.</em> (This is Euler's first Proposition).</p>
<dl>
<dd><dl>
<dd>Indeed, suppose for example that 

<math display="inline" id="Proofs_of_Fermat's_theorem_on_sums_of_two_squares:2">
 <semantics>
  <mrow>
   <msup>
    <mi>a</mi>
    <mn>2</mn>
   </msup>
   <mo>+</mo>
   <msup>
    <mi>b</mi>
    <mn>2</mn>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <plus></plus>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>a</ci>
     <cn type="integer">2</cn>
    </apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>b</ci>
     <cn type="integer">2</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a^{2}+b^{2}
  </annotation>
 </semantics>
</math>

 is divisible by 

<math display="inline" id="Proofs_of_Fermat's_theorem_on_sums_of_two_squares:3">
 <semantics>
  <mrow>
   <msup>
    <mi>p</mi>
    <mn>2</mn>
   </msup>
   <mo>+</mo>
   <msup>
    <mi>q</mi>
    <mn>2</mn>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <plus></plus>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>p</ci>
     <cn type="integer">2</cn>
    </apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>q</ci>
     <cn type="integer">2</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p^{2}+q^{2}
  </annotation>
 </semantics>
</math>


 and that this latter is a prime. Then 

<math display="inline" id="Proofs_of_Fermat's_theorem_on_sums_of_two_squares:4">
 <semantics>
  <mrow>
   <msup>
    <mi>p</mi>
    <mn>2</mn>
   </msup>
   <mo>+</mo>
   <msup>
    <mi>q</mi>
    <mn>2</mn>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <plus></plus>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>p</ci>
     <cn type="integer">2</cn>
    </apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>q</ci>
     <cn type="integer">2</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p^{2}+q^{2}
  </annotation>
 </semantics>
</math>

 divides
</dd>
</dl>
</dd>
</dl>
<dl>
<dd><dl>
<dd>

<math display="inline" id="Proofs_of_Fermat's_theorem_on_sums_of_two_squares:5">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mrow>
        <mi>p</mi>
        <mi>b</mi>
       </mrow>
       <mo>-</mo>
       <mrow>
        <mi>a</mi>
        <mi>q</mi>
       </mrow>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mrow>
        <mi>p</mi>
        <mi>b</mi>
       </mrow>
       <mo>+</mo>
       <mrow>
        <mi>a</mi>
        <mi>q</mi>
       </mrow>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mrow>
      <msup>
       <mi>p</mi>
       <mn>2</mn>
      </msup>
      <msup>
       <mi>b</mi>
       <mn>2</mn>
      </msup>
     </mrow>
     <mo>-</mo>
     <mrow>
      <msup>
       <mi>a</mi>
       <mn>2</mn>
      </msup>
      <msup>
       <mi>q</mi>
       <mn>2</mn>
      </msup>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mrow>
      <msup>
       <mi>p</mi>
       <mn>2</mn>
      </msup>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <msup>
         <mi>a</mi>
         <mn>2</mn>
        </msup>
        <mo>+</mo>
        <msup>
         <mi>b</mi>
         <mn>2</mn>
        </msup>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo>-</mo>
     <mrow>
      <msup>
       <mi>a</mi>
       <mn>2</mn>
      </msup>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <msup>
         <mi>p</mi>
         <mn>2</mn>
        </msup>
        <mo>+</mo>
        <msup>
         <mi>q</mi>
         <mn>2</mn>
        </msup>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <times></times>
      <apply>
       <minus></minus>
       <apply>
        <times></times>
        <ci>p</ci>
        <ci>b</ci>
       </apply>
       <apply>
        <times></times>
        <ci>a</ci>
        <ci>q</ci>
       </apply>
      </apply>
      <apply>
       <plus></plus>
       <apply>
        <times></times>
        <ci>p</ci>
        <ci>b</ci>
       </apply>
       <apply>
        <times></times>
        <ci>a</ci>
        <ci>q</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <minus></minus>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>p</ci>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>b</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>a</ci>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>q</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <minus></minus>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>p</ci>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <plus></plus>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>a</ci>
         <cn type="integer">2</cn>
        </apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>b</ci>
         <cn type="integer">2</cn>
        </apply>
       </apply>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>a</ci>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <plus></plus>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>p</ci>
         <cn type="integer">2</cn>
        </apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>q</ci>
         <cn type="integer">2</cn>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (pb-aq)(pb+aq)=p^{2}b^{2}-a^{2}q^{2}=p^{2}(a^{2}+b^{2})-a^{2}(p^{2}+q^{2}).
  </annotation>
 </semantics>
</math>


</dd>
</dl>
</dd>
</dl>
<dl>
<dd><dl>
<dd>Since 

<math display="inline" id="Proofs_of_Fermat's_theorem_on_sums_of_two_squares:6">
 <semantics>
  <mrow>
   <msup>
    <mi>p</mi>
    <mn>2</mn>
   </msup>
   <mo>+</mo>
   <msup>
    <mi>q</mi>
    <mn>2</mn>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <plus></plus>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>p</ci>
     <cn type="integer">2</cn>
    </apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>q</ci>
     <cn type="integer">2</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p^{2}+q^{2}
  </annotation>
 </semantics>
</math>

 is a prime, it divides one of the two factors. Suppose that it divides 

<math display="inline" id="Proofs_of_Fermat's_theorem_on_sums_of_two_squares:7">
 <semantics>
  <mrow>
   <mrow>
    <mi>p</mi>
    <mi>b</mi>
   </mrow>
   <mo>-</mo>
   <mrow>
    <mi>a</mi>
    <mi>q</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <minus></minus>
    <apply>
     <times></times>
     <ci>p</ci>
     <ci>b</ci>
    </apply>
    <apply>
     <times></times>
     <ci>a</ci>
     <ci>q</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   pb-aq
  </annotation>
 </semantics>
</math>

. Since
</dd>
</dl>
</dd>
</dl>
<dl>
<dd><dl>
<dd>

<math display="inline" id="Proofs_of_Fermat's_theorem_on_sums_of_two_squares:8">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <msup>
       <mi>a</mi>
       <mn>2</mn>
      </msup>
      <mo>+</mo>
      <msup>
       <mi>b</mi>
       <mn>2</mn>
      </msup>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <msup>
       <mi>p</mi>
       <mn>2</mn>
      </msup>
      <mo>+</mo>
      <msup>
       <mi>q</mi>
       <mn>2</mn>
      </msup>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <msup>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mrow>
        <mi>a</mi>
        <mi>p</mi>
       </mrow>
       <mo>+</mo>
       <mrow>
        <mi>b</mi>
        <mi>q</mi>
       </mrow>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <mn>2</mn>
    </msup>
    <mo>+</mo>
    <mpadded width="+1.7pt">
     <msup>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mrow>
         <mi>a</mi>
         <mi>q</mi>
        </mrow>
        <mo>-</mo>
        <mrow>
         <mi>b</mi>
         <mi>p</mi>
        </mrow>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
      <mn>2</mn>
     </msup>
    </mpadded>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <plus></plus>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>a</ci>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>b</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
     <apply>
      <plus></plus>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>p</ci>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>q</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <plus></plus>
       <apply>
        <times></times>
        <ci>a</ci>
        <ci>p</ci>
       </apply>
       <apply>
        <times></times>
        <ci>b</ci>
        <ci>q</ci>
       </apply>
      </apply>
      <cn type="integer">2</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <minus></minus>
       <apply>
        <times></times>
        <ci>a</ci>
        <ci>q</ci>
       </apply>
       <apply>
        <times></times>
        <ci>b</ci>
        <ci>p</ci>
       </apply>
      </apply>
      <cn type="integer">2</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (a^{2}+b^{2})(p^{2}+q^{2})=(ap+bq)^{2}+(aq-bp)^{2}\,
  </annotation>
 </semantics>
</math>



</dd>
</dl>
</dd>
</dl>
<dl>
<dd><dl>
<dd>(Diophantus identity) it follows that 

<math display="inline" id="Proofs_of_Fermat's_theorem_on_sums_of_two_squares:9">
 <semantics>
  <mrow>
   <msup>
    <mi>p</mi>
    <mn>2</mn>
   </msup>
   <mo>+</mo>
   <msup>
    <mi>q</mi>
    <mn>2</mn>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <plus></plus>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>p</ci>
     <cn type="integer">2</cn>
    </apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>q</ci>
     <cn type="integer">2</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p^{2}+q^{2}
  </annotation>
 </semantics>
</math>

 must divide 

<math display="inline" id="Proofs_of_Fermat's_theorem_on_sums_of_two_squares:10">
 <semantics>
  <msup>
   <mrow>
    <mo stretchy="false">(</mo>
    <mrow>
     <mrow>
      <mi>a</mi>
      <mi>p</mi>
     </mrow>
     <mo>+</mo>
     <mrow>
      <mi>b</mi>
      <mi>q</mi>
     </mrow>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
   <mn>2</mn>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <ci>a</ci>
      <ci>p</ci>
     </apply>
     <apply>
      <times></times>
      <ci>b</ci>
      <ci>q</ci>
     </apply>
    </apply>
    <cn type="integer">2</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (ap+bq)^{2}
  </annotation>
 </semantics>
</math>

. So the equation can be divided by the square of 

<math display="inline" id="Proofs_of_Fermat's_theorem_on_sums_of_two_squares:11">
 <semantics>
  <mrow>
   <msup>
    <mi>p</mi>
    <mn>2</mn>
   </msup>
   <mo>+</mo>
   <msup>
    <mi>q</mi>
    <mn>2</mn>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <plus></plus>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>p</ci>
     <cn type="integer">2</cn>
    </apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>q</ci>
     <cn type="integer">2</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p^{2}+q^{2}
  </annotation>
 </semantics>
</math>

. Dividing the expression by 

<math display="inline" id="Proofs_of_Fermat's_theorem_on_sums_of_two_squares:12">
 <semantics>
  <msup>
   <mrow>
    <mo stretchy="false">(</mo>
    <mrow>
     <msup>
      <mi>p</mi>
      <mn>2</mn>
     </msup>
     <mo>+</mo>
     <msup>
      <mi>q</mi>
      <mn>2</mn>
     </msup>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
   <mn>2</mn>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <apply>
     <plus></plus>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>p</ci>
      <cn type="integer">2</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>q</ci>
      <cn type="integer">2</cn>
     </apply>
    </apply>
    <cn type="integer">2</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (p^{2}+q^{2})^{2}
  </annotation>
 </semantics>
</math>

 yields:
</dd>
</dl>
</dd>
</dl>
<dl>
<dd><dl>
<dd>

<math display="inline" id="Proofs_of_Fermat's_theorem_on_sums_of_two_squares:13">
 <semantics>
  <mrow>
   <mfrac>
    <mrow>
     <msup>
      <mi>a</mi>
      <mn>2</mn>
     </msup>
     <mo>+</mo>
     <msup>
      <mi>b</mi>
      <mn>2</mn>
     </msup>
    </mrow>
    <mrow>
     <msup>
      <mi>p</mi>
      <mn>2</mn>
     </msup>
     <mo>+</mo>
     <msup>
      <mi>q</mi>
      <mn>2</mn>
     </msup>
    </mrow>
   </mfrac>
   <mo>=</mo>
   <mrow>
    <msup>
     <mrow>
      <mo>(</mo>
      <mfrac>
       <mrow>
        <mrow>
         <mi>a</mi>
         <mi>p</mi>
        </mrow>
        <mo>+</mo>
        <mrow>
         <mi>b</mi>
         <mi>q</mi>
        </mrow>
       </mrow>
       <mrow>
        <msup>
         <mi>p</mi>
         <mn>2</mn>
        </msup>
        <mo>+</mo>
        <msup>
         <mi>q</mi>
         <mn>2</mn>
        </msup>
       </mrow>
      </mfrac>
      <mo>)</mo>
     </mrow>
     <mn>2</mn>
    </msup>
    <mo>+</mo>
    <msup>
     <mrow>
      <mo>(</mo>
      <mfrac>
       <mrow>
        <mrow>
         <mi>a</mi>
         <mi>q</mi>
        </mrow>
        <mo>-</mo>
        <mrow>
         <mi>b</mi>
         <mi>p</mi>
        </mrow>
       </mrow>
       <mrow>
        <msup>
         <mi>p</mi>
         <mn>2</mn>
        </msup>
        <mo>+</mo>
        <msup>
         <mi>q</mi>
         <mn>2</mn>
        </msup>
       </mrow>
      </mfrac>
      <mo>)</mo>
     </mrow>
     <mn>2</mn>
    </msup>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <divide></divide>
     <apply>
      <plus></plus>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>a</ci>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>b</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
     <apply>
      <plus></plus>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>p</ci>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>q</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <divide></divide>
       <apply>
        <plus></plus>
        <apply>
         <times></times>
         <ci>a</ci>
         <ci>p</ci>
        </apply>
        <apply>
         <times></times>
         <ci>b</ci>
         <ci>q</ci>
        </apply>
       </apply>
       <apply>
        <plus></plus>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>p</ci>
         <cn type="integer">2</cn>
        </apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>q</ci>
         <cn type="integer">2</cn>
        </apply>
       </apply>
      </apply>
      <cn type="integer">2</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <divide></divide>
       <apply>
        <minus></minus>
        <apply>
         <times></times>
         <ci>a</ci>
         <ci>q</ci>
        </apply>
        <apply>
         <times></times>
         <ci>b</ci>
         <ci>p</ci>
        </apply>
       </apply>
       <apply>
        <plus></plus>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>p</ci>
         <cn type="integer">2</cn>
        </apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>q</ci>
         <cn type="integer">2</cn>
        </apply>
       </apply>
      </apply>
      <cn type="integer">2</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \frac{a^{2}+b^{2}}{p^{2}+q^{2}}=\left(\frac{ap+bq}{p^{2}+q^{2}}\right)^{2}+%
\left(\frac{aq-bp}{p^{2}+q^{2}}\right)^{2}
  </annotation>
 </semantics>
</math>



</dd>
</dl>
</dd>
</dl>
<dl>
<dd><dl>
<dd>and thus expresses the quotient as a sum of two squares, as claimed.
</dd>
</dl>
</dd>
</dl>
<dl>
<dd><dl>
<dd>If 

<math display="inline" id="Proofs_of_Fermat's_theorem_on_sums_of_two_squares:14">
 <semantics>
  <mrow>
   <msup>
    <mi>p</mi>
    <mn>2</mn>
   </msup>
   <mo>+</mo>
   <msup>
    <mi>q</mi>
    <mn>2</mn>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <plus></plus>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>p</ci>
     <cn type="integer">2</cn>
    </apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>q</ci>
     <cn type="integer">2</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p^{2}+q^{2}
  </annotation>
 </semantics>
</math>

 divides 

<math display="inline" id="Proofs_of_Fermat's_theorem_on_sums_of_two_squares:15">
 <semantics>
  <mrow>
   <mrow>
    <mi>p</mi>
    <mi>b</mi>
   </mrow>
   <mo>+</mo>
   <mrow>
    <mi>a</mi>
    <mi>q</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <plus></plus>
    <apply>
     <times></times>
     <ci>p</ci>
     <ci>b</ci>
    </apply>
    <apply>
     <times></times>
     <ci>a</ci>
     <ci>q</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   pb+aq
  </annotation>
 </semantics>
</math>

, a similar argument holds by using
</dd>
</dl>
</dd>
</dl>
<dl>
<dd><dl>
<dd>

<math display="inline" id="Proofs_of_Fermat's_theorem_on_sums_of_two_squares:16">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <msup>
       <mi>a</mi>
       <mn>2</mn>
      </msup>
      <mo>+</mo>
      <msup>
       <mi>b</mi>
       <mn>2</mn>
      </msup>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <msup>
       <mi>q</mi>
       <mn>2</mn>
      </msup>
      <mo>+</mo>
      <msup>
       <mi>p</mi>
       <mn>2</mn>
      </msup>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <msup>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mrow>
        <mi>a</mi>
        <mi>q</mi>
       </mrow>
       <mo>+</mo>
       <mrow>
        <mi>b</mi>
        <mi>p</mi>
       </mrow>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <mn>2</mn>
    </msup>
    <mo>+</mo>
    <mpadded width="+1.7pt">
     <msup>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mrow>
         <mi>a</mi>
         <mi>p</mi>
        </mrow>
        <mo>-</mo>
        <mrow>
         <mi>b</mi>
         <mi>q</mi>
        </mrow>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
      <mn>2</mn>
     </msup>
    </mpadded>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <plus></plus>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>a</ci>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>b</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
     <apply>
      <plus></plus>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>q</ci>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>p</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <plus></plus>
       <apply>
        <times></times>
        <ci>a</ci>
        <ci>q</ci>
       </apply>
       <apply>
        <times></times>
        <ci>b</ci>
        <ci>p</ci>
       </apply>
      </apply>
      <cn type="integer">2</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <minus></minus>
       <apply>
        <times></times>
        <ci>a</ci>
        <ci>p</ci>
       </apply>
       <apply>
        <times></times>
        <ci>b</ci>
        <ci>q</ci>
       </apply>
      </apply>
      <cn type="integer">2</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (a^{2}+b^{2})(q^{2}+p^{2})=(aq+bp)^{2}+(ap-bq)^{2}\,
  </annotation>
 </semantics>
</math>


</dd>
</dl>
</dd>
</dl>
<dl>
<dd><dl>
<dd>(Diophantus identity).
</dd>
</dl>
</dd>
</dl>

<p>3. <em>If a number which can be written as a sum of two squares is divisible by a number which is not a sum of two squares, then the quotient has a factor which is not a sum of two squares.</em> (This is Euler's second Proposition).</p>
<dl>
<dd><dl>
<dd>Suppose 

<math display="inline" id="Proofs_of_Fermat's_theorem_on_sums_of_two_squares:17">
 <semantics>
  <mi>x</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>x</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x
  </annotation>
 </semantics>
</math>

 divides 

<math display="inline" id="Proofs_of_Fermat's_theorem_on_sums_of_two_squares:18">
 <semantics>
  <mrow>
   <msup>
    <mi>a</mi>
    <mn>2</mn>
   </msup>
   <mo>+</mo>
   <msup>
    <mi>b</mi>
    <mn>2</mn>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <plus></plus>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>a</ci>
     <cn type="integer">2</cn>
    </apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>b</ci>
     <cn type="integer">2</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a^{2}+b^{2}
  </annotation>
 </semantics>
</math>


 and that the quotient, factored into its prime factors is 

<math display="inline" id="Proofs_of_Fermat's_theorem_on_sums_of_two_squares:19">
 <semantics>
  <mrow>
   <msub>
    <mi>p</mi>
    <mn>1</mn>
   </msub>
   <msub>
    <mi>p</mi>
    <mn>2</mn>
   </msub>
   <mi mathvariant="normal">⋯</mi>
   <msub>
    <mi>p</mi>
    <mi>n</mi>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>p</ci>
     <cn type="integer">1</cn>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>p</ci>
     <cn type="integer">2</cn>
    </apply>
    <ci>normal-⋯</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>p</ci>
     <ci>n</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p_{1}p_{2}\cdots p_{n}
  </annotation>
 </semantics>
</math>

. Then 

<math display="inline" id="Proofs_of_Fermat's_theorem_on_sums_of_two_squares:20">
 <semantics>
  <mrow>
   <mrow>
    <msup>
     <mi>a</mi>
     <mn>2</mn>
    </msup>
    <mo>+</mo>
    <msup>
     <mi>b</mi>
     <mn>2</mn>
    </msup>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mi>x</mi>
    <msub>
     <mi>p</mi>
     <mn>1</mn>
    </msub>
    <msub>
     <mi>p</mi>
     <mn>2</mn>
    </msub>
    <mi mathvariant="normal">⋯</mi>
    <msub>
     <mi>p</mi>
     <mi>n</mi>
    </msub>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <plus></plus>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>a</ci>
      <cn type="integer">2</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>b</ci>
      <cn type="integer">2</cn>
     </apply>
    </apply>
    <apply>
     <times></times>
     <ci>x</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>p</ci>
      <cn type="integer">1</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>p</ci>
      <cn type="integer">2</cn>
     </apply>
     <ci>normal-⋯</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>p</ci>
      <ci>n</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a^{2}+b^{2}=xp_{1}p_{2}\cdots p_{n}
  </annotation>
 </semantics>
</math>

. If all factors 

<math display="inline" id="Proofs_of_Fermat's_theorem_on_sums_of_two_squares:21">
 <semantics>
  <msub>
   <mi>p</mi>
   <mi>i</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>p</ci>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p_{i}
  </annotation>
 </semantics>
</math>

 can be written as sums of two squares, then we can divide 

<math display="inline" id="Proofs_of_Fermat's_theorem_on_sums_of_two_squares:22">
 <semantics>
  <mrow>
   <msup>
    <mi>a</mi>
    <mn>2</mn>
   </msup>
   <mo>+</mo>
   <msup>
    <mi>b</mi>
    <mn>2</mn>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <plus></plus>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>a</ci>
     <cn type="integer">2</cn>
    </apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>b</ci>
     <cn type="integer">2</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a^{2}+b^{2}
  </annotation>
 </semantics>
</math>

 successively by 

<math display="inline" id="Proofs_of_Fermat's_theorem_on_sums_of_two_squares:23">
 <semantics>
  <msub>
   <mi>p</mi>
   <mn>1</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>p</ci>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p_{1}
  </annotation>
 </semantics>
</math>


, 

<math display="inline" id="Proofs_of_Fermat's_theorem_on_sums_of_two_squares:24">
 <semantics>
  <msub>
   <mi>p</mi>
   <mn>2</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>p</ci>
    <cn type="integer">2</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p_{2}
  </annotation>
 </semantics>
</math>

, etc., and applying the previous step we deduce that each quotient is a sum of two squares. This until we get to 

<math display="inline" id="Proofs_of_Fermat's_theorem_on_sums_of_two_squares:25">
 <semantics>
  <mi>x</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>x</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x
  </annotation>
 </semantics>
</math>

, concluding that 

<math display="inline" id="Proofs_of_Fermat's_theorem_on_sums_of_two_squares:26">
 <semantics>
  <mi>x</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>x</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x
  </annotation>
 </semantics>
</math>

 would have to be the sum of two squares. So, by contraposition, if 

<math display="inline" id="Proofs_of_Fermat's_theorem_on_sums_of_two_squares:27">
 <semantics>
  <mi>x</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>x</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x
  </annotation>
 </semantics>
</math>

 is not the sum of two squares, then at least one of the primes 

<math display="inline" id="Proofs_of_Fermat's_theorem_on_sums_of_two_squares:28">
 <semantics>
  <msub>
   <mi>p</mi>
   <mi>i</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>p</ci>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p_{i}
  </annotation>
 </semantics>
</math>


 is not the sum of two squares.
</dd>
</dl>
</dd>
</dl>

<p>4. <em>If 

<math display="inline" id="Proofs_of_Fermat's_theorem_on_sums_of_two_squares:29">
 <semantics>
  <mi>a</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>a</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Proofs_of_Fermat's_theorem_on_sums_of_two_squares:30">
 <semantics>
  <mi>b</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>b</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   b
  </annotation>
 </semantics>
</math>

 are relatively prime then every factor of 

<math display="inline" id="Proofs_of_Fermat's_theorem_on_sums_of_two_squares:31">
 <semantics>
  <mrow>
   <msup>
    <mi>a</mi>
    <mn>2</mn>
   </msup>
   <mo>+</mo>
   <msup>
    <mi>b</mi>
    <mn>2</mn>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <plus></plus>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>a</ci>
     <cn type="integer">2</cn>
    </apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>b</ci>
     <cn type="integer">2</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a^{2}+b^{2}
  </annotation>
 </semantics>
</math>

 is a sum of two squares.</em> (This is Euler's Proposition 4. The proof sketched below includes the proof of his Proposition 3).</p>
<dl>
<dd><dl>
<dd>This is the step that uses infinite descent. Let 

<math display="inline" id="Proofs_of_Fermat's_theorem_on_sums_of_two_squares:32">
 <semantics>
  <mi>x</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>x</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x
  </annotation>
 </semantics>
</math>

 be a factor of 

<math display="inline" id="Proofs_of_Fermat's_theorem_on_sums_of_two_squares:33">
 <semantics>
  <mrow>
   <msup>
    <mi>a</mi>
    <mn>2</mn>
   </msup>
   <mo>+</mo>
   <msup>
    <mi>b</mi>
    <mn>2</mn>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <plus></plus>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>a</ci>
     <cn type="integer">2</cn>
    </apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>b</ci>
     <cn type="integer">2</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a^{2}+b^{2}
  </annotation>
 </semantics>
</math>


. We can write

<p>

<math display="block" id="Proofs_of_Fermat's_theorem_on_sums_of_two_squares:34">
 <semantics>
  <mrow>
   <mrow>
    <mi>a</mi>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mi>m</mi>
      <mi>x</mi>
     </mrow>
     <mo>±</mo>
     <mi>c</mi>
    </mrow>
   </mrow>
   <mo rspace="22.5pt">,</mo>
   <mrow>
    <mi>b</mi>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mi>n</mi>
      <mi>x</mi>
     </mrow>
     <mo>±</mo>
     <mi>d</mi>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <eq></eq>
     <ci>a</ci>
     <apply>
      <csymbol cd="latexml">plus-or-minus</csymbol>
      <apply>
       <times></times>
       <ci>m</ci>
       <ci>x</ci>
      </apply>
      <ci>c</ci>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <ci>b</ci>
     <apply>
      <csymbol cd="latexml">plus-or-minus</csymbol>
      <apply>
       <times></times>
       <ci>n</ci>
       <ci>x</ci>
      </apply>
      <ci>d</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a=mx\pm c,\qquad b=nx\pm d
  </annotation>
 </semantics>
</math>

</p>
</dd>
<dd>where 

<math display="inline" id="Proofs_of_Fermat's_theorem_on_sums_of_two_squares:35">
 <semantics>
  <mi>c</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>c</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   c
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Proofs_of_Fermat's_theorem_on_sums_of_two_squares:36">
 <semantics>
  <mi>d</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>d</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   d
  </annotation>
 </semantics>
</math>

 are at most half of 

<math display="inline" id="Proofs_of_Fermat's_theorem_on_sums_of_two_squares:37">
 <semantics>
  <mi>x</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>x</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x
  </annotation>
 </semantics>
</math>

 in absolute value. This gives:

<p>

<math display="block" id="Proofs_of_Fermat's_theorem_on_sums_of_two_squares:38">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <msup>
      <mi>a</mi>
      <mn>2</mn>
     </msup>
     <mo>+</mo>
     <msup>
      <mi>b</mi>
      <mn>2</mn>
     </msup>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mrow>
       <mrow>
        <mrow>
         <msup>
          <mi>m</mi>
          <mn>2</mn>
         </msup>
         <msup>
          <mi>x</mi>
          <mn>2</mn>
         </msup>
        </mrow>
        <mo>±</mo>
        <mrow>
         <mn>2</mn>
         <mi>m</mi>
         <mi>x</mi>
         <mi>c</mi>
        </mrow>
       </mrow>
       <mo>+</mo>
       <msup>
        <mi>c</mi>
        <mn>2</mn>
       </msup>
       <mo>+</mo>
       <mrow>
        <msup>
         <mi>n</mi>
         <mn>2</mn>
        </msup>
        <msup>
         <mi>x</mi>
         <mn>2</mn>
        </msup>
       </mrow>
      </mrow>
      <mo>±</mo>
      <mrow>
       <mn>2</mn>
       <mi>n</mi>
       <mi>x</mi>
       <mi>d</mi>
      </mrow>
     </mrow>
     <mo>+</mo>
     <msup>
      <mi>d</mi>
      <mn>2</mn>
     </msup>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mi>A</mi>
      <mi>x</mi>
     </mrow>
     <mo>+</mo>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <msup>
        <mi>c</mi>
        <mn>2</mn>
       </msup>
       <mo>+</mo>
       <msup>
        <mi>d</mi>
        <mn>2</mn>
       </msup>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <plus></plus>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>a</ci>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>b</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
     <apply>
      <plus></plus>
      <apply>
       <csymbol cd="latexml">plus-or-minus</csymbol>
       <apply>
        <plus></plus>
        <apply>
         <csymbol cd="latexml">plus-or-minus</csymbol>
         <apply>
          <times></times>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <ci>m</ci>
           <cn type="integer">2</cn>
          </apply>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <ci>x</ci>
           <cn type="integer">2</cn>
          </apply>
         </apply>
         <apply>
          <times></times>
          <cn type="integer">2</cn>
          <ci>m</ci>
          <ci>x</ci>
          <ci>c</ci>
         </apply>
        </apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>c</ci>
         <cn type="integer">2</cn>
        </apply>
        <apply>
         <times></times>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>n</ci>
          <cn type="integer">2</cn>
         </apply>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>x</ci>
          <cn type="integer">2</cn>
         </apply>
        </apply>
       </apply>
       <apply>
        <times></times>
        <cn type="integer">2</cn>
        <ci>n</ci>
        <ci>x</ci>
        <ci>d</ci>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>d</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <plus></plus>
      <apply>
       <times></times>
       <ci>A</ci>
       <ci>x</ci>
      </apply>
      <apply>
       <plus></plus>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>c</ci>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>d</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a^{2}+b^{2}=m^{2}x^{2}\pm 2mxc+c^{2}+n^{2}x^{2}\pm 2nxd+d^{2}=Ax+(c^{2}+d^{2}).
  </annotation>
 </semantics>
</math>

</p>
</dd>
<dd>Therefore, 

<math display="inline" id="Proofs_of_Fermat's_theorem_on_sums_of_two_squares:39">
 <semantics>
  <mrow>
   <msup>
    <mi>c</mi>
    <mn>2</mn>
   </msup>
   <mo>+</mo>
   <msup>
    <mi>d</mi>
    <mn>2</mn>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <plus></plus>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>c</ci>
     <cn type="integer">2</cn>
    </apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>d</ci>
     <cn type="integer">2</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   c^{2}+d^{2}
  </annotation>
 </semantics>
</math>

 must be divisible by 

<math display="inline" id="Proofs_of_Fermat's_theorem_on_sums_of_two_squares:40">
 <semantics>
  <mi>x</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>x</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x
  </annotation>
 </semantics>
</math>

, say 

<math display="inline" id="Proofs_of_Fermat's_theorem_on_sums_of_two_squares:41">
 <semantics>
  <mrow>
   <mrow>
    <msup>
     <mi>c</mi>
     <mn>2</mn>
    </msup>
    <mo>+</mo>
    <msup>
     <mi>d</mi>
     <mn>2</mn>
    </msup>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mi>y</mi>
    <mi>x</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <plus></plus>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>c</ci>
      <cn type="integer">2</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>d</ci>
      <cn type="integer">2</cn>
     </apply>
    </apply>
    <apply>
     <times></times>
     <ci>y</ci>
     <ci>x</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   c^{2}+d^{2}=yx
  </annotation>
 </semantics>
</math>

. If 

<math display="inline" id="Proofs_of_Fermat's_theorem_on_sums_of_two_squares:42">
 <semantics>
  <mi>c</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>c</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   c
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Proofs_of_Fermat's_theorem_on_sums_of_two_squares:43">
 <semantics>
  <mi>d</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>d</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   d
  </annotation>
 </semantics>
</math>


 are not relatively prime, then their gcd must be relatively prime to 

<math display="inline" id="Proofs_of_Fermat's_theorem_on_sums_of_two_squares:44">
 <semantics>
  <mi>x</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>x</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x
  </annotation>
 </semantics>
</math>

 (else the common factor of their gcd and 

<math display="inline" id="Proofs_of_Fermat's_theorem_on_sums_of_two_squares:45">
 <semantics>
  <mi>x</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>x</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x
  </annotation>
 </semantics>
</math>

 would also be a common factor of 

<math display="inline" id="Proofs_of_Fermat's_theorem_on_sums_of_two_squares:46">
 <semantics>
  <mi>a</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>a</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Proofs_of_Fermat's_theorem_on_sums_of_two_squares:47">
 <semantics>
  <mi>b</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>b</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   b
  </annotation>
 </semantics>
</math>

 which we assume are relatively prime). Thus the square of the gcd divides 

<math display="inline" id="Proofs_of_Fermat's_theorem_on_sums_of_two_squares:48">
 <semantics>
  <mi>y</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>y</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   y
  </annotation>
 </semantics>
</math>


 (as it divides 

<math display="inline" id="Proofs_of_Fermat's_theorem_on_sums_of_two_squares:49">
 <semantics>
  <mrow>
   <msup>
    <mi>c</mi>
    <mn>2</mn>
   </msup>
   <mo>+</mo>
   <msup>
    <mi>d</mi>
    <mn>2</mn>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <plus></plus>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>c</ci>
     <cn type="integer">2</cn>
    </apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>d</ci>
     <cn type="integer">2</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   c^{2}+d^{2}
  </annotation>
 </semantics>
</math>

), giving us an expression of the form 

<math display="inline" id="Proofs_of_Fermat's_theorem_on_sums_of_two_squares:50">
 <semantics>
  <mrow>
   <mrow>
    <msup>
     <mi>e</mi>
     <mn>2</mn>
    </msup>
    <mo>+</mo>
    <msup>
     <mi>f</mi>
     <mn>2</mn>
    </msup>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mi>z</mi>
    <mi>x</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <plus></plus>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>e</ci>
      <cn type="integer">2</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>f</ci>
      <cn type="integer">2</cn>
     </apply>
    </apply>
    <apply>
     <times></times>
     <ci>z</ci>
     <ci>x</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   e^{2}+f^{2}=zx
  </annotation>
 </semantics>
</math>

 for relatively prime 

<math display="inline" id="Proofs_of_Fermat's_theorem_on_sums_of_two_squares:51">
 <semantics>
  <mi>e</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>e</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   e
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Proofs_of_Fermat's_theorem_on_sums_of_two_squares:52">
 <semantics>
  <mi>f</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>f</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f
  </annotation>
 </semantics>
</math>

, and with 

<math display="inline" id="Proofs_of_Fermat's_theorem_on_sums_of_two_squares:53">
 <semantics>
  <mi>z</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>z</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   z
  </annotation>
 </semantics>
</math>


 no more than half of 

<math display="inline" id="Proofs_of_Fermat's_theorem_on_sums_of_two_squares:54">
 <semantics>
  <mi>x</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>x</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x
  </annotation>
 </semantics>
</math>

, since
</dd>
</dl>
</dd>
</dl>
<dl>
<dd><dl>
<dd>

<math display="inline" id="Proofs_of_Fermat's_theorem_on_sums_of_two_squares:55">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>z</mi>
     <mi>x</mi>
    </mrow>
    <mo>=</mo>
    <mrow>
     <msup>
      <mi>e</mi>
      <mn>2</mn>
     </msup>
     <mo>+</mo>
     <msup>
      <mi>f</mi>
      <mn>2</mn>
     </msup>
    </mrow>
    <mo>≤</mo>
    <mrow>
     <msup>
      <mi>c</mi>
      <mn>2</mn>
     </msup>
     <mo>+</mo>
     <msup>
      <mi>d</mi>
      <mn>2</mn>
     </msup>
    </mrow>
    <mo>≤</mo>
    <mrow>
     <msup>
      <mrow>
       <mo>(</mo>
       <mfrac>
        <mi>x</mi>
        <mn>2</mn>
       </mfrac>
       <mo>)</mo>
      </mrow>
      <mn>2</mn>
     </msup>
     <mo>+</mo>
     <msup>
      <mrow>
       <mo>(</mo>
       <mfrac>
        <mi>x</mi>
        <mn>2</mn>
       </mfrac>
       <mo>)</mo>
      </mrow>
      <mn>2</mn>
     </msup>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mfrac>
      <mn>1</mn>
      <mn>2</mn>
     </mfrac>
     <msup>
      <mi>x</mi>
      <mn>2</mn>
     </msup>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <times></times>
      <ci>z</ci>
      <ci>x</ci>
     </apply>
     <apply>
      <plus></plus>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>e</ci>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>f</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
    <apply>
     <leq></leq>
     <share href="#.cmml">
     </share>
     <apply>
      <plus></plus>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>c</ci>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>d</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
    <apply>
     <leq></leq>
     <share href="#.cmml">
     </share>
     <apply>
      <plus></plus>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <divide></divide>
        <ci>x</ci>
        <cn type="integer">2</cn>
       </apply>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <divide></divide>
        <ci>x</ci>
        <cn type="integer">2</cn>
       </apply>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>x</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   zx=e^{2}+f^{2}\leq c^{2}+d^{2}\leq\left(\frac{x}{2}\right)^{2}+\left(\frac{x}{%
2}\right)^{2}=\frac{1}{2}x^{2}.
  </annotation>
 </semantics>
</math>


</dd>
</dl>
</dd>
</dl>
<dl>
<dd><dl>
<dd>If 

<math display="inline" id="Proofs_of_Fermat's_theorem_on_sums_of_two_squares:56">
 <semantics>
  <mi>c</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>c</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   c
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Proofs_of_Fermat's_theorem_on_sums_of_two_squares:57">
 <semantics>
  <mi>d</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>d</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   d
  </annotation>
 </semantics>
</math>

 are relatively prime, then we can use them directly instead of switching to 

<math display="inline" id="Proofs_of_Fermat's_theorem_on_sums_of_two_squares:58">
 <semantics>
  <mi>e</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>e</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   e
  </annotation>
 </semantics>
</math>


 and 

<math display="inline" id="Proofs_of_Fermat's_theorem_on_sums_of_two_squares:59">
 <semantics>
  <mi>f</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>f</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f
  </annotation>
 </semantics>
</math>

.
</dd>
</dl>
</dd>
</dl>
<dl>
<dd><dl>
<dd>If 

<math display="inline" id="Proofs_of_Fermat's_theorem_on_sums_of_two_squares:60">
 <semantics>
  <mi>x</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>x</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x
  </annotation>
 </semantics>
</math>

 is not the sum of two squares, then by the third step there must be a factor of 

<math display="inline" id="Proofs_of_Fermat's_theorem_on_sums_of_two_squares:61">
 <semantics>
  <mi>z</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>z</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   z
  </annotation>
 </semantics>
</math>

 which is not the sum of two squares; call it 

<math display="inline" id="Proofs_of_Fermat's_theorem_on_sums_of_two_squares:62">
 <semantics>
  <mi>w</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>w</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   w
  </annotation>
 </semantics>
</math>

. This gives an infinite descent, going from 

<math display="inline" id="Proofs_of_Fermat's_theorem_on_sums_of_two_squares:63">
 <semantics>
  <mi>x</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>x</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x
  </annotation>
 </semantics>
</math>


 to a smaller number 

<math display="inline" id="Proofs_of_Fermat's_theorem_on_sums_of_two_squares:64">
 <semantics>
  <mi>w</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>w</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   w
  </annotation>
 </semantics>
</math>

, both not the sums of two squares but dividing a sum of two squares. Since an infinite descent is impossible, we conclude that 

<math display="inline" id="Proofs_of_Fermat's_theorem_on_sums_of_two_squares:65">
 <semantics>
  <mi>x</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>x</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x
  </annotation>
 </semantics>
</math>

 must be expressible as a sum of two squares, as claimed.
</dd>
</dl>
</dd>
</dl>

<p>5. <em>Every prime of the form 

<math display="inline" id="Proofs_of_Fermat's_theorem_on_sums_of_two_squares:66">
 <semantics>
  <mrow>
   <mrow>
    <mn>4</mn>
    <mi>n</mi>
   </mrow>
   <mo>+</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <plus></plus>
    <apply>
     <times></times>
     <cn type="integer">4</cn>
     <ci>n</ci>
    </apply>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   4n+1
  </annotation>
 </semantics>
</math>

 is a sum of two squares.</em> (This is the main result of Euler's second paper).</p>
<dl>
<dd><dl>
<dd>If 

<math display="inline" id="Proofs_of_Fermat's_theorem_on_sums_of_two_squares:67">
 <semantics>
  <mrow>
   <mi>p</mi>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mn>4</mn>
     <mi>n</mi>
    </mrow>
    <mo>+</mo>
    <mn>1</mn>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>p</ci>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <cn type="integer">4</cn>
      <ci>n</ci>
     </apply>
     <cn type="integer">1</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p=4n+1
  </annotation>
 </semantics>
</math>

, then by <a href="Fermat's_Little_Theorem" title="wikilink">Fermat's Little Theorem</a> each of the numbers 

<math display="inline" id="Proofs_of_Fermat's_theorem_on_sums_of_two_squares:68">
 <semantics>
  <mrow>
   <mn>1</mn>
   <mo>,</mo>
   <msup>
    <mn>2</mn>
    <mrow>
     <mn>4</mn>
     <mi>n</mi>
    </mrow>
   </msup>
   <mo>,</mo>
   <msup>
    <mn>3</mn>
    <mrow>
     <mn>4</mn>
     <mi>n</mi>
    </mrow>
   </msup>
   <mo>,</mo>
   <mi mathvariant="normal">…</mi>
   <mo>,</mo>
   <msup>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mn>4</mn>
      <mi>n</mi>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
    <mrow>
     <mn>4</mn>
     <mi>n</mi>
    </mrow>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <list>
    <cn type="integer">1</cn>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <cn type="integer">2</cn>
     <apply>
      <times></times>
      <cn type="integer">4</cn>
      <ci>n</ci>
     </apply>
    </apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <cn type="integer">3</cn>
     <apply>
      <times></times>
      <cn type="integer">4</cn>
      <ci>n</ci>
     </apply>
    </apply>
    <ci>normal-…</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <times></times>
      <cn type="integer">4</cn>
      <ci>n</ci>
     </apply>
     <apply>
      <times></times>
      <cn type="integer">4</cn>
      <ci>n</ci>
     </apply>
    </apply>
   </list>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   1,2^{4n},3^{4n},\dots,(4n)^{4n}
  </annotation>
 </semantics>
</math>


 is congruent to one modulo 

<math display="inline" id="Proofs_of_Fermat's_theorem_on_sums_of_two_squares:69">
 <semantics>
  <mi>p</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>p</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p
  </annotation>
 </semantics>
</math>

. The differences 

<math display="inline" id="Proofs_of_Fermat's_theorem_on_sums_of_two_squares:70">
 <semantics>
  <mrow>
   <mrow>
    <msup>
     <mn>2</mn>
     <mrow>
      <mn>4</mn>
      <mi>n</mi>
     </mrow>
    </msup>
    <mo>-</mo>
    <mn>1</mn>
   </mrow>
   <mo>,</mo>
   <mrow>
    <msup>
     <mn>3</mn>
     <mrow>
      <mn>4</mn>
      <mi>n</mi>
     </mrow>
    </msup>
    <mo>-</mo>
    <msup>
     <mn>2</mn>
     <mrow>
      <mn>4</mn>
      <mi>n</mi>
     </mrow>
    </msup>
   </mrow>
   <mo>,</mo>
   <mi mathvariant="normal">…</mi>
   <mo>,</mo>
   <mrow>
    <msup>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mn>4</mn>
       <mi>n</mi>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <mrow>
      <mn>4</mn>
      <mi>n</mi>
     </mrow>
    </msup>
    <mo>-</mo>
    <msup>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mrow>
        <mn>4</mn>
        <mi>n</mi>
       </mrow>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <mrow>
      <mn>4</mn>
      <mi>n</mi>
     </mrow>
    </msup>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <list>
    <apply>
     <minus></minus>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <cn type="integer">2</cn>
      <apply>
       <times></times>
       <cn type="integer">4</cn>
       <ci>n</ci>
      </apply>
     </apply>
     <cn type="integer">1</cn>
    </apply>
    <apply>
     <minus></minus>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <cn type="integer">3</cn>
      <apply>
       <times></times>
       <cn type="integer">4</cn>
       <ci>n</ci>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <cn type="integer">2</cn>
      <apply>
       <times></times>
       <cn type="integer">4</cn>
       <ci>n</ci>
      </apply>
     </apply>
    </apply>
    <ci>normal-…</ci>
    <apply>
     <minus></minus>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <times></times>
       <cn type="integer">4</cn>
       <ci>n</ci>
      </apply>
      <apply>
       <times></times>
       <cn type="integer">4</cn>
       <ci>n</ci>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <minus></minus>
       <apply>
        <times></times>
        <cn type="integer">4</cn>
        <ci>n</ci>
       </apply>
       <cn type="integer">1</cn>
      </apply>
      <apply>
       <times></times>
       <cn type="integer">4</cn>
       <ci>n</ci>
      </apply>
     </apply>
    </apply>
   </list>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   2^{4n}-1,3^{4n}-2^{4n},\dots,(4n)^{4n}-(4n-1)^{4n}
  </annotation>
 </semantics>
</math>

 are therefore all divisible by 

<math display="inline" id="Proofs_of_Fermat's_theorem_on_sums_of_two_squares:71">
 <semantics>
  <mi>p</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>p</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p
  </annotation>
 </semantics>
</math>

. Each of these differences can be factored as

<p>

<math display="block" id="Proofs_of_Fermat's_theorem_on_sums_of_two_squares:72">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <msup>
      <mi>a</mi>
      <mrow>
       <mn>4</mn>
       <mi>n</mi>
      </mrow>
     </msup>
     <mo>-</mo>
     <msup>
      <mi>b</mi>
      <mrow>
       <mn>4</mn>
       <mi>n</mi>
      </mrow>
     </msup>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mo>(</mo>
      <mrow>
       <msup>
        <mi>a</mi>
        <mrow>
         <mn>2</mn>
         <mi>n</mi>
        </mrow>
       </msup>
       <mo>+</mo>
       <msup>
        <mi>b</mi>
        <mrow>
         <mn>2</mn>
         <mi>n</mi>
        </mrow>
       </msup>
      </mrow>
      <mo>)</mo>
     </mrow>
     <mrow>
      <mo>(</mo>
      <mrow>
       <msup>
        <mi>a</mi>
        <mrow>
         <mn>2</mn>
         <mi>n</mi>
        </mrow>
       </msup>
       <mo>-</mo>
       <msup>
        <mi>b</mi>
        <mrow>
         <mn>2</mn>
         <mi>n</mi>
        </mrow>
       </msup>
      </mrow>
      <mo>)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <minus></minus>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>a</ci>
      <apply>
       <times></times>
       <cn type="integer">4</cn>
       <ci>n</ci>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>b</ci>
      <apply>
       <times></times>
       <cn type="integer">4</cn>
       <ci>n</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <plus></plus>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>a</ci>
       <apply>
        <times></times>
        <cn type="integer">2</cn>
        <ci>n</ci>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>b</ci>
       <apply>
        <times></times>
        <cn type="integer">2</cn>
        <ci>n</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <minus></minus>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>a</ci>
       <apply>
        <times></times>
        <cn type="integer">2</cn>
        <ci>n</ci>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>b</ci>
       <apply>
        <times></times>
        <cn type="integer">2</cn>
        <ci>n</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a^{4n}-b^{4n}=\left(a^{2n}+b^{2n}\right)\left(a^{2n}-b^{2n}\right).
  </annotation>
 </semantics>
</math>

</p>
</dd>
<dd>Since 

<math display="inline" id="Proofs_of_Fermat's_theorem_on_sums_of_two_squares:73">
 <semantics>
  <mi>p</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>p</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p
  </annotation>
 </semantics>
</math>


 is prime, it must divide one of the two factors. If in any of the 

<math display="inline" id="Proofs_of_Fermat's_theorem_on_sums_of_two_squares:74">
 <semantics>
  <mrow>
   <mrow>
    <mn>4</mn>
    <mi>n</mi>
   </mrow>
   <mo>-</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <minus></minus>
    <apply>
     <times></times>
     <cn type="integer">4</cn>
     <ci>n</ci>
    </apply>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   4n-1
  </annotation>
 </semantics>
</math>

 cases it divides the first factor, then by the previous step we conclude that 

<math display="inline" id="Proofs_of_Fermat's_theorem_on_sums_of_two_squares:75">
 <semantics>
  <mi>p</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>p</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p
  </annotation>
 </semantics>
</math>

 is itself a sum of two squares (since 

<math display="inline" id="Proofs_of_Fermat's_theorem_on_sums_of_two_squares:76">
 <semantics>
  <mi>a</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>a</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Proofs_of_Fermat's_theorem_on_sums_of_two_squares:77">
 <semantics>
  <mi>b</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>b</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   b
  </annotation>
 </semantics>
</math>

 differ by 

<math display="inline" id="Proofs_of_Fermat's_theorem_on_sums_of_two_squares:78">
 <semantics>
  <mn>1</mn>
  <annotation-xml encoding="MathML-Content">
   <cn type="integer">1</cn>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   1
  </annotation>
 </semantics>
</math>


, they are relatively prime). So it is enough to show that 

<math display="inline" id="Proofs_of_Fermat's_theorem_on_sums_of_two_squares:79">
 <semantics>
  <mi>p</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>p</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p
  </annotation>
 </semantics>
</math>

 cannot always divide the second factor. If it divides all 

<math display="inline" id="Proofs_of_Fermat's_theorem_on_sums_of_two_squares:80">
 <semantics>
  <mrow>
   <mrow>
    <mn>4</mn>
    <mi>n</mi>
   </mrow>
   <mo>-</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <minus></minus>
    <apply>
     <times></times>
     <cn type="integer">4</cn>
     <ci>n</ci>
    </apply>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   4n-1
  </annotation>
 </semantics>
</math>

 differences 

<math display="inline" id="Proofs_of_Fermat's_theorem_on_sums_of_two_squares:81">
 <semantics>
  <mrow>
   <mrow>
    <msup>
     <mn>2</mn>
     <mrow>
      <mn>2</mn>
      <mi>n</mi>
     </mrow>
    </msup>
    <mo>-</mo>
    <mn>1</mn>
   </mrow>
   <mo>,</mo>
   <mrow>
    <msup>
     <mn>3</mn>
     <mrow>
      <mn>2</mn>
      <mi>n</mi>
     </mrow>
    </msup>
    <mo>-</mo>
    <msup>
     <mn>2</mn>
     <mrow>
      <mn>2</mn>
      <mi>n</mi>
     </mrow>
    </msup>
   </mrow>
   <mo>,</mo>
   <mi mathvariant="normal">…</mi>
   <mo>,</mo>
   <mrow>
    <msup>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mn>4</mn>
       <mi>n</mi>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <mrow>
      <mn>2</mn>
      <mi>n</mi>
     </mrow>
    </msup>
    <mo>-</mo>
    <msup>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mrow>
        <mn>4</mn>
        <mi>n</mi>
       </mrow>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <mrow>
      <mn>2</mn>
      <mi>n</mi>
     </mrow>
    </msup>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <list>
    <apply>
     <minus></minus>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <cn type="integer">2</cn>
      <apply>
       <times></times>
       <cn type="integer">2</cn>
       <ci>n</ci>
      </apply>
     </apply>
     <cn type="integer">1</cn>
    </apply>
    <apply>
     <minus></minus>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <cn type="integer">3</cn>
      <apply>
       <times></times>
       <cn type="integer">2</cn>
       <ci>n</ci>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <cn type="integer">2</cn>
      <apply>
       <times></times>
       <cn type="integer">2</cn>
       <ci>n</ci>
      </apply>
     </apply>
    </apply>
    <ci>normal-…</ci>
    <apply>
     <minus></minus>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <times></times>
       <cn type="integer">4</cn>
       <ci>n</ci>
      </apply>
      <apply>
       <times></times>
       <cn type="integer">2</cn>
       <ci>n</ci>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <minus></minus>
       <apply>
        <times></times>
        <cn type="integer">4</cn>
        <ci>n</ci>
       </apply>
       <cn type="integer">1</cn>
      </apply>
      <apply>
       <times></times>
       <cn type="integer">2</cn>
       <ci>n</ci>
      </apply>
     </apply>
    </apply>
   </list>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   2^{2n}-1,3^{2n}-2^{2n},\dots,(4n)^{2n}-(4n-1)^{2n}
  </annotation>
 </semantics>
</math>

, then it would divide all 

<math display="inline" id="Proofs_of_Fermat's_theorem_on_sums_of_two_squares:82">
 <semantics>
  <mrow>
   <mrow>
    <mn>4</mn>
    <mi>n</mi>
   </mrow>
   <mo>-</mo>
   <mn>2</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <minus></minus>
    <apply>
     <times></times>
     <cn type="integer">4</cn>
     <ci>n</ci>
    </apply>
    <cn type="integer">2</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   4n-2
  </annotation>
 </semantics>
</math>

 differences of successive terms, all 

<math display="inline" id="Proofs_of_Fermat's_theorem_on_sums_of_two_squares:83">
 <semantics>
  <mrow>
   <mrow>
    <mn>4</mn>
    <mi>n</mi>
   </mrow>
   <mo>-</mo>
   <mn>3</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <minus></minus>
    <apply>
     <times></times>
     <cn type="integer">4</cn>
     <ci>n</ci>
    </apply>
    <cn type="integer">3</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   4n-3
  </annotation>
 </semantics>
</math>


 differences of the differences, and so forth. Since the 

<math display="inline" id="Proofs_of_Fermat's_theorem_on_sums_of_two_squares:84">
 <semantics>
  <mi>k</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>k</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   k
  </annotation>
 </semantics>
</math>

th differences of the sequence 

<math display="inline" id="Proofs_of_Fermat's_theorem_on_sums_of_two_squares:85">
 <semantics>
  <mrow>
   <msup>
    <mn>1</mn>
    <mi>k</mi>
   </msup>
   <mo>,</mo>
   <msup>
    <mn>2</mn>
    <mi>k</mi>
   </msup>
   <mo>,</mo>
   <msup>
    <mn>3</mn>
    <mi>k</mi>
   </msup>
   <mo>,</mo>
   <mi mathvariant="normal">…</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <list>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <cn type="integer">1</cn>
     <ci>k</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <cn type="integer">2</cn>
     <ci>k</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <cn type="integer">3</cn>
     <ci>k</ci>
    </apply>
    <ci>normal-…</ci>
   </list>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   1^{k},2^{k},3^{k},\dots
  </annotation>
 </semantics>
</math>

 are all equal to 

<math display="inline" id="Proofs_of_Fermat's_theorem_on_sums_of_two_squares:86">
 <semantics>
  <mrow>
   <mi>k</mi>
   <mo lspace="0pt" rspace="3.5pt">!</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <factorial></factorial>
    <ci>k</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   k!
  </annotation>
 </semantics>
</math>

 (<a href="Finite_difference#Calculus_of_finite_differences" title="wikilink">Finite difference</a>), the 

<math display="inline" id="Proofs_of_Fermat's_theorem_on_sums_of_two_squares:87">
 <semantics>
  <mrow>
   <mn>2</mn>
   <mi>n</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <cn type="integer">2</cn>
    <ci>n</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   2n
  </annotation>
 </semantics>
</math>

th differences would all be constant and equal to 

<math display="inline" id="Proofs_of_Fermat's_theorem_on_sums_of_two_squares:88">
 <semantics>
  <mrow>
   <mrow>
    <mo stretchy="false">(</mo>
    <mrow>
     <mn>2</mn>
     <mi>n</mi>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo lspace="0pt" rspace="3.5pt">!</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <factorial></factorial>
    <apply>
     <times></times>
     <cn type="integer">2</cn>
     <ci>n</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (2n)!
  </annotation>
 </semantics>
</math>


, which is certainly not divisible by 

<math display="inline" id="Proofs_of_Fermat's_theorem_on_sums_of_two_squares:89">
 <semantics>
  <mi>p</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>p</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p
  </annotation>
 </semantics>
</math>

. Therefore, 

<math display="inline" id="Proofs_of_Fermat's_theorem_on_sums_of_two_squares:90">
 <semantics>
  <mi>p</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>p</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p
  </annotation>
 </semantics>
</math>

 cannot divide all the second factors which proves that 

<math display="inline" id="Proofs_of_Fermat's_theorem_on_sums_of_two_squares:91">
 <semantics>
  <mi>p</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>p</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p
  </annotation>
 </semantics>
</math>

 is indeed the sum of two squares.
</dd>
</dl>
</dd>
</dl>
<h2 id="lagranges-proof-through-quadratic-forms">Lagrange's proof through quadratic forms</h2>

<p><a href="Joseph_Louis_Lagrange" title="wikilink">Lagrange</a> completed a proof in 1775<a class="footnoteRef" href="#fn5" id="fnref5"><sup>5</sup></a> based on his general theory of integral <a href="quadratic_forms" title="wikilink">quadratic forms</a>. The following is a slight simplification of his argument, due to <a href="Carl_Friedrich_Gauss" title="wikilink">Gauss</a>, which appears in article 182 of the <a href="Disquisitiones_Arithmeticae" title="wikilink">Disquisitiones Arithmeticae</a>.</p>

<p>A (binary) quadratic form will be taken to be an expression of the form 

<math display="inline" id="Proofs_of_Fermat's_theorem_on_sums_of_two_squares:92">
 <semantics>
  <mrow>
   <mrow>
    <mi>a</mi>
    <msup>
     <mi>x</mi>
     <mn>2</mn>
    </msup>
   </mrow>
   <mo>+</mo>
   <mrow>
    <mn>2</mn>
    <mi>b</mi>
    <mi>x</mi>
    <mi>y</mi>
   </mrow>
   <mo>+</mo>
   <mrow>
    <mi>c</mi>
    <msup>
     <mi>y</mi>
     <mn>2</mn>
    </msup>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <plus></plus>
    <apply>
     <times></times>
     <ci>a</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>x</ci>
      <cn type="integer">2</cn>
     </apply>
    </apply>
    <apply>
     <times></times>
     <cn type="integer">2</cn>
     <ci>b</ci>
     <ci>x</ci>
     <ci>y</ci>
    </apply>
    <apply>
     <times></times>
     <ci>c</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>y</ci>
      <cn type="integer">2</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   ax^{2}+2bxy+cy^{2}
  </annotation>
 </semantics>
</math>

 with 

<math display="inline" id="Proofs_of_Fermat's_theorem_on_sums_of_two_squares:93">
 <semantics>
  <mrow>
   <mi>a</mi>
   <mo>,</mo>
   <mi>b</mi>
   <mo>,</mo>
   <mi>c</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <list>
    <ci>a</ci>
    <ci>b</ci>
    <ci>c</ci>
   </list>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a,b,c
  </annotation>
 </semantics>
</math>


 integers. A number 

<math display="inline" id="Proofs_of_Fermat's_theorem_on_sums_of_two_squares:94">
 <semantics>
  <mi>n</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>n</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n
  </annotation>
 </semantics>
</math>

 is said to be <em>represented by the form</em> if there exist integers 

<math display="inline" id="Proofs_of_Fermat's_theorem_on_sums_of_two_squares:95">
 <semantics>
  <mrow>
   <mi>x</mi>
   <mo>,</mo>
   <mi>y</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <list>
    <ci>x</ci>
    <ci>y</ci>
   </list>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x,y
  </annotation>
 </semantics>
</math>

 such that 

<math display="inline" id="Proofs_of_Fermat's_theorem_on_sums_of_two_squares:96">
 <semantics>
  <mrow>
   <mi>n</mi>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mi>a</mi>
     <msup>
      <mi>x</mi>
      <mn>2</mn>
     </msup>
    </mrow>
    <mo>+</mo>
    <mrow>
     <mn>2</mn>
     <mi>b</mi>
     <mi>x</mi>
     <mi>y</mi>
    </mrow>
    <mo>+</mo>
    <mrow>
     <mi>c</mi>
     <msup>
      <mi>y</mi>
      <mn>2</mn>
     </msup>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>n</ci>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <ci>a</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>x</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
     <apply>
      <times></times>
      <cn type="integer">2</cn>
      <ci>b</ci>
      <ci>x</ci>
      <ci>y</ci>
     </apply>
     <apply>
      <times></times>
      <ci>c</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>y</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n=ax^{2}+2bxy+cy^{2}
  </annotation>
 </semantics>
</math>

. Fermat's theorem on sums of two squares is then equivalent to the statement that a prime 

<math display="inline" id="Proofs_of_Fermat's_theorem_on_sums_of_two_squares:97">
 <semantics>
  <mi>p</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>p</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p
  </annotation>
 </semantics>
</math>

 is represented by the form 

<math display="inline" id="Proofs_of_Fermat's_theorem_on_sums_of_two_squares:98">
 <semantics>
  <mrow>
   <msup>
    <mi>x</mi>
    <mn>2</mn>
   </msup>
   <mo>+</mo>
   <msup>
    <mi>y</mi>
    <mn>2</mn>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <plus></plus>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>x</ci>
     <cn type="integer">2</cn>
    </apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>y</ci>
     <cn type="integer">2</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x^{2}+y^{2}
  </annotation>
 </semantics>
</math>


 (i.e., 

<math display="inline" id="Proofs_of_Fermat's_theorem_on_sums_of_two_squares:99">
 <semantics>
  <mrow>
   <mi>a</mi>
   <mo>=</mo>
   <mi>c</mi>
   <mo>=</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <ci>a</ci>
     <ci>c</ci>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <cn type="integer">1</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a=c=1
  </annotation>
 </semantics>
</math>

, 

<math display="inline" id="Proofs_of_Fermat's_theorem_on_sums_of_two_squares:100">
 <semantics>
  <mrow>
   <mi>b</mi>
   <mo>=</mo>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>b</ci>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   b=0
  </annotation>
 </semantics>
</math>

) exactly when 

<math display="inline" id="Proofs_of_Fermat's_theorem_on_sums_of_two_squares:101">
 <semantics>
  <mi>p</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>p</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p
  </annotation>
 </semantics>
</math>

 is congruent to 

<math display="inline" id="Proofs_of_Fermat's_theorem_on_sums_of_two_squares:102">
 <semantics>
  <mn>1</mn>
  <annotation-xml encoding="MathML-Content">
   <cn type="integer">1</cn>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   1
  </annotation>
 </semantics>
</math>

 modulo 

<math display="inline" id="Proofs_of_Fermat's_theorem_on_sums_of_two_squares:103">
 <semantics>
  <mn>4</mn>
  <annotation-xml encoding="MathML-Content">
   <cn type="integer">4</cn>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   4
  </annotation>
 </semantics>
</math>


.</p>

<p>The <a class="uri" href="discriminant" title="wikilink">discriminant</a> of the quadratic form is defined to be 

<math display="inline" id="Proofs_of_Fermat's_theorem_on_sums_of_two_squares:104">
 <semantics>
  <mrow>
   <msup>
    <mi>b</mi>
    <mn>2</mn>
   </msup>
   <mo>-</mo>
   <mrow>
    <mi>a</mi>
    <mi>c</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <minus></minus>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>b</ci>
     <cn type="integer">2</cn>
    </apply>
    <apply>
     <times></times>
     <ci>a</ci>
     <ci>c</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   b^{2}-ac
  </annotation>
 </semantics>
</math>

 (this is the definition due to Gauss; Lagrange did not require the 

<math display="inline" id="Proofs_of_Fermat's_theorem_on_sums_of_two_squares:105">
 <semantics>
  <mrow>
   <mi>x</mi>
   <mi>y</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>x</ci>
    <ci>y</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   xy
  </annotation>
 </semantics>
</math>

 term to have even coefficient, and defined the discriminant as 

<math display="inline" id="Proofs_of_Fermat's_theorem_on_sums_of_two_squares:106">
 <semantics>
  <mrow>
   <msup>
    <mi>b</mi>
    <mn>2</mn>
   </msup>
   <mo>-</mo>
   <mrow>
    <mn>4</mn>
    <mi>a</mi>
    <mi>c</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <minus></minus>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>b</ci>
     <cn type="integer">2</cn>
    </apply>
    <apply>
     <times></times>
     <cn type="integer">4</cn>
     <ci>a</ci>
     <ci>c</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   b^{2}-4ac
  </annotation>
 </semantics>
</math>

). The discriminant of 

<math display="inline" id="Proofs_of_Fermat's_theorem_on_sums_of_two_squares:107">
 <semantics>
  <mrow>
   <msup>
    <mi>x</mi>
    <mn>2</mn>
   </msup>
   <mo>+</mo>
   <msup>
    <mi>y</mi>
    <mn>2</mn>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <plus></plus>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>x</ci>
     <cn type="integer">2</cn>
    </apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>y</ci>
     <cn type="integer">2</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x^{2}+y^{2}
  </annotation>
 </semantics>
</math>

 is then equal to 

<math display="inline" id="Proofs_of_Fermat's_theorem_on_sums_of_two_squares:108">
 <semantics>
  <mrow>
   <mo>-</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <minus></minus>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   -1
  </annotation>
 </semantics>
</math>


.</p>

<p>Two forms 

<math display="inline" id="Proofs_of_Fermat's_theorem_on_sums_of_two_squares:109">
 <semantics>
  <mrow>
   <mrow>
    <mi>a</mi>
    <msup>
     <mi>x</mi>
     <mn>2</mn>
    </msup>
   </mrow>
   <mo>+</mo>
   <mrow>
    <mn>2</mn>
    <mi>b</mi>
    <mi>x</mi>
    <mi>y</mi>
   </mrow>
   <mo>+</mo>
   <mrow>
    <mi>c</mi>
    <msup>
     <mi>y</mi>
     <mn>2</mn>
    </msup>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <plus></plus>
    <apply>
     <times></times>
     <ci>a</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>x</ci>
      <cn type="integer">2</cn>
     </apply>
    </apply>
    <apply>
     <times></times>
     <cn type="integer">2</cn>
     <ci>b</ci>
     <ci>x</ci>
     <ci>y</ci>
    </apply>
    <apply>
     <times></times>
     <ci>c</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>y</ci>
      <cn type="integer">2</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   ax^{2}+2bxy+cy^{2}
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Proofs_of_Fermat's_theorem_on_sums_of_two_squares:110">
 <semantics>
  <mrow>
   <mrow>
    <mi>r</mi>
    <msup>
     <mi>x</mi>
     <mrow>
      <mi mathvariant="normal">′</mi>
      <mn>2</mn>
     </mrow>
    </msup>
   </mrow>
   <mo>+</mo>
   <mrow>
    <mn>2</mn>
    <mi>s</mi>
    <msup>
     <mi>x</mi>
     <mo>′</mo>
    </msup>
    <msup>
     <mi>y</mi>
     <mo>′</mo>
    </msup>
   </mrow>
   <mo>+</mo>
   <mrow>
    <mi>t</mi>
    <msup>
     <mi>y</mi>
     <mrow>
      <mi mathvariant="normal">′</mi>
      <mn>2</mn>
     </mrow>
    </msup>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <plus></plus>
    <apply>
     <times></times>
     <ci>r</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>x</ci>
      <list>
       <ci>normal-′</ci>
       <cn type="integer">2</cn>
      </list>
     </apply>
    </apply>
    <apply>
     <times></times>
     <cn type="integer">2</cn>
     <ci>s</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>x</ci>
      <ci>normal-′</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>y</ci>
      <ci>normal-′</ci>
     </apply>
    </apply>
    <apply>
     <times></times>
     <ci>t</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>y</ci>
      <list>
       <ci>normal-′</ci>
       <cn type="integer">2</cn>
      </list>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   rx^{\prime 2}+2sx^{\prime}y^{\prime}+ty^{\prime 2}
  </annotation>
 </semantics>
</math>

 are <em>equivalent</em> if and only if there exist substitutions with integer coefficients</p>

<p>

<math display="block" id="Proofs_of_Fermat's_theorem_on_sums_of_two_squares:111">
 <semantics>
  <mrow>
   <mi>x</mi>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mi>α</mi>
     <msup>
      <mi>x</mi>
      <mo>′</mo>
     </msup>
    </mrow>
    <mo>+</mo>
    <mrow>
     <mi>β</mi>
     <msup>
      <mi>y</mi>
      <mo>′</mo>
     </msup>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>x</ci>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <ci>α</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>x</ci>
       <ci>normal-′</ci>
      </apply>
     </apply>
     <apply>
      <times></times>
      <ci>β</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>y</ci>
       <ci>normal-′</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x=\alpha x^{\prime}+\beta y^{\prime}
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Proofs_of_Fermat's_theorem_on_sums_of_two_squares:112">
 <semantics>
  <mrow>
   <mi>y</mi>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mi>γ</mi>
     <msup>
      <mi>x</mi>
      <mo>′</mo>
     </msup>
    </mrow>
    <mo>+</mo>
    <mrow>
     <mi>δ</mi>
     <msup>
      <mi>y</mi>
      <mo>′</mo>
     </msup>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>y</ci>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <ci>γ</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>x</ci>
       <ci>normal-′</ci>
      </apply>
     </apply>
     <apply>
      <times></times>
      <ci>δ</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>y</ci>
       <ci>normal-′</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   y=\gamma x^{\prime}+\delta y^{\prime}
  </annotation>
 </semantics>
</math>

 with 

<math display="inline" id="Proofs_of_Fermat's_theorem_on_sums_of_two_squares:113">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>α</mi>
     <mi>δ</mi>
    </mrow>
    <mo>-</mo>
    <mrow>
     <mi>β</mi>
     <mi>γ</mi>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mo>±</mo>
    <mn>1</mn>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <minus></minus>
     <apply>
      <times></times>
      <ci>α</ci>
      <ci>δ</ci>
     </apply>
     <apply>
      <times></times>
      <ci>β</ci>
      <ci>γ</ci>
     </apply>
    </apply>
    <apply>
     <csymbol cd="latexml">plus-or-minus</csymbol>
     <cn type="integer">1</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \alpha\delta-\beta\gamma=\pm 1
  </annotation>
 </semantics>
</math>


 such that, when substituted into the first form, yield the second. Equivalent forms are readily seen to have the same discriminant. Moreover, it is clear that equivalent forms will represent exactly the same integers.</p>

<p>Lagrange proved that all positive definite forms of discriminant −1 are equivalent. Thus, to prove Fermat's theorem it is enough to find <em>any</em> positive definite form of discriminant −1 that represents 

<math display="inline" id="Proofs_of_Fermat's_theorem_on_sums_of_two_squares:114">
 <semantics>
  <mi>p</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>p</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p
  </annotation>
 </semantics>
</math>

. To do this, it suffices to find an integer 

<math display="inline" id="Proofs_of_Fermat's_theorem_on_sums_of_two_squares:115">
 <semantics>
  <mi>m</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>m</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   m
  </annotation>
 </semantics>
</math>

 such that 

<math display="inline" id="Proofs_of_Fermat's_theorem_on_sums_of_two_squares:116">
 <semantics>
  <mi>p</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>p</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p
  </annotation>
 </semantics>
</math>

 divides 

<math display="inline" id="Proofs_of_Fermat's_theorem_on_sums_of_two_squares:117">
 <semantics>
  <mrow>
   <msup>
    <mi>m</mi>
    <mn>2</mn>
   </msup>
   <mo>+</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <plus></plus>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>m</ci>
     <cn type="integer">2</cn>
    </apply>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   m^{2}+1
  </annotation>
 </semantics>
</math>

. For, finding such an integer, we can consider the form</p>

<p>

<math display="block" id="Proofs_of_Fermat's_theorem_on_sums_of_two_squares:118">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>p</mi>
     <msup>
      <mi>x</mi>
      <mn>2</mn>
     </msup>
    </mrow>
    <mo>+</mo>
    <mrow>
     <mn>2</mn>
     <mi>m</mi>
     <mi>x</mi>
     <mi>y</mi>
    </mrow>
    <mo>+</mo>
    <mrow>
     <mrow>
      <mo>(</mo>
      <mfrac>
       <mrow>
        <msup>
         <mi>m</mi>
         <mn>2</mn>
        </msup>
        <mo>+</mo>
        <mn>1</mn>
       </mrow>
       <mi>p</mi>
      </mfrac>
      <mo>)</mo>
     </mrow>
     <msup>
      <mi>y</mi>
      <mn>2</mn>
     </msup>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <plus></plus>
    <apply>
     <times></times>
     <ci>p</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>x</ci>
      <cn type="integer">2</cn>
     </apply>
    </apply>
    <apply>
     <times></times>
     <cn type="integer">2</cn>
     <ci>m</ci>
     <ci>x</ci>
     <ci>y</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <divide></divide>
      <apply>
       <plus></plus>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>m</ci>
        <cn type="integer">2</cn>
       </apply>
       <cn type="integer">1</cn>
      </apply>
      <ci>p</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>y</ci>
      <cn type="integer">2</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   px^{2}+2mxy+\left(\frac{m^{2}+1}{p}\right)y^{2},
  </annotation>
 </semantics>
</math>

 which has discriminant −1 and represents <em>p</em> by setting <em>x</em> = 1 and <em>y</em> = 0.</p>

<p>Suppose then that <em>p</em> = 4<em>n</em> + 1. Again we invoke Fermat's Little Theorem: for any <em>z</em> relatively prime to <em>p</em>, we know that <em>p</em> divides 

<math display="inline" id="Proofs_of_Fermat's_theorem_on_sums_of_two_squares:119">
 <semantics>
  <mrow>
   <mrow>
    <msup>
     <mi>z</mi>
     <mrow>
      <mi>p</mi>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </msup>
    <mo>-</mo>
    <mn>1</mn>
   </mrow>
   <mo>=</mo>
   <mrow>
    <msup>
     <mi>z</mi>
     <mrow>
      <mn>4</mn>
      <mi>n</mi>
     </mrow>
    </msup>
    <mo>-</mo>
    <mn>1</mn>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <msup>
       <mi>z</mi>
       <mrow>
        <mn>2</mn>
        <mi>n</mi>
       </mrow>
      </msup>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <msup>
       <mi>z</mi>
       <mrow>
        <mn>2</mn>
        <mi>n</mi>
       </mrow>
      </msup>
      <mo>+</mo>
      <mn>1</mn>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <minus></minus>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>z</ci>
       <apply>
        <minus></minus>
        <ci>p</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <cn type="integer">1</cn>
     </apply>
     <apply>
      <minus></minus>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>z</ci>
       <apply>
        <times></times>
        <cn type="integer">4</cn>
        <ci>n</ci>
       </apply>
      </apply>
      <cn type="integer">1</cn>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <apply>
       <minus></minus>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>z</ci>
        <apply>
         <times></times>
         <cn type="integer">2</cn>
         <ci>n</ci>
        </apply>
       </apply>
       <cn type="integer">1</cn>
      </apply>
      <apply>
       <plus></plus>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>z</ci>
        <apply>
         <times></times>
         <cn type="integer">2</cn>
         <ci>n</ci>
        </apply>
       </apply>
       <cn type="integer">1</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   z^{p-1}-1=z^{4n}-1=(z^{2n}-1)(z^{2n}+1)
  </annotation>
 </semantics>
</math>

. Moreover, by a theorem of Lagrange, the number of solutions modulo <em>p</em> to a congruence of degree <em>q</em> modulo <em>p</em> is at most <em>q</em> (this follows since the integers modulo <em>p</em> form a field, and a polynomial of degree <em>q</em> has at most <em>q</em> roots). So the congruence 

<math display="inline" id="Proofs_of_Fermat's_theorem_on_sums_of_two_squares:120">
 <semantics>
  <mrow>
   <mrow>
    <msup>
     <mi>z</mi>
     <mrow>
      <mn>2</mn>
      <mi>n</mi>
     </mrow>
    </msup>
    <mo>-</mo>
    <mn>1</mn>
   </mrow>
   <mo>≡</mo>
   <mrow>
    <mn>0</mn>
    <mspace width="veryverythickmathspace">
    </mspace>
    <mrow>
     <mo lspace="8.1pt" stretchy="false">(</mo>
     <mrow>
      <mo>mod</mo>
      <mi>p</mi>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <equivalent></equivalent>
    <apply>
     <minus></minus>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>z</ci>
      <apply>
       <times></times>
       <cn type="integer">2</cn>
       <ci>n</ci>
      </apply>
     </apply>
     <cn type="integer">1</cn>
    </apply>
    <apply>
     <csymbol cd="latexml">annotated</csymbol>
     <cn type="integer">0</cn>
     <apply>
      <ci>pmod</ci>
      <ci>p</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   z^{2n}-1\equiv 0\;\;(\mathop{{\rm mod}}p)
  </annotation>
 </semantics>
</math>

 has at most 2<em>n</em> solutions among the numbers 1, 2, …, <em>p</em> − 1 = 4<em>n</em>. Therefore, there exists some positive integer <em>z</em> strictly smaller than <em>p</em> (and so relatively prime to <em>p</em>) such that <em>p</em> does not divide 

<math display="inline" id="Proofs_of_Fermat's_theorem_on_sums_of_two_squares:121">
 <semantics>
  <mrow>
   <msup>
    <mi>z</mi>
    <mrow>
     <mn>2</mn>
     <mi>n</mi>
    </mrow>
   </msup>
   <mo>-</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <minus></minus>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>z</ci>
     <apply>
      <times></times>
      <cn type="integer">2</cn>
      <ci>n</ci>
     </apply>
    </apply>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   z^{2n}-1
  </annotation>
 </semantics>
</math>

. Since <em>p</em> divides 

<math display="inline" id="Proofs_of_Fermat's_theorem_on_sums_of_two_squares:122">
 <semantics>
  <mrow>
   <mrow>
    <msup>
     <mi>z</mi>
     <mrow>
      <mn>4</mn>
      <mi>n</mi>
     </mrow>
    </msup>
    <mo>-</mo>
    <mn>1</mn>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <msup>
       <mi>z</mi>
       <mrow>
        <mn>2</mn>
        <mi>n</mi>
       </mrow>
      </msup>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <msup>
       <mi>z</mi>
       <mrow>
        <mn>2</mn>
        <mi>n</mi>
       </mrow>
      </msup>
      <mo>+</mo>
      <mn>1</mn>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <minus></minus>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>z</ci>
      <apply>
       <times></times>
       <cn type="integer">4</cn>
       <ci>n</ci>
      </apply>
     </apply>
     <cn type="integer">1</cn>
    </apply>
    <apply>
     <times></times>
     <apply>
      <minus></minus>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>z</ci>
       <apply>
        <times></times>
        <cn type="integer">2</cn>
        <ci>n</ci>
       </apply>
      </apply>
      <cn type="integer">1</cn>
     </apply>
     <apply>
      <plus></plus>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>z</ci>
       <apply>
        <times></times>
        <cn type="integer">2</cn>
        <ci>n</ci>
       </apply>
      </apply>
      <cn type="integer">1</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   z^{4n}-1=(z^{2n}-1)(z^{2n}+1)
  </annotation>
 </semantics>
</math>

, <em>p</em> must divide 

<math display="inline" id="Proofs_of_Fermat's_theorem_on_sums_of_two_squares:123">
 <semantics>
  <mrow>
   <msup>
    <mi>z</mi>
    <mrow>
     <mn>2</mn>
     <mi>n</mi>
    </mrow>
   </msup>
   <mo>+</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <plus></plus>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>z</ci>
     <apply>
      <times></times>
      <cn type="integer">2</cn>
      <ci>n</ci>
     </apply>
    </apply>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   z^{2n}+1
  </annotation>
 </semantics>
</math>


. Setting 

<math display="inline" id="Proofs_of_Fermat's_theorem_on_sums_of_two_squares:124">
 <semantics>
  <mrow>
   <mi>m</mi>
   <mo>=</mo>
   <msup>
    <mi>z</mi>
    <mi>n</mi>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>m</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>z</ci>
     <ci>n</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   m=z^{n}
  </annotation>
 </semantics>
</math>

 completes the proof.</p>
<h2 id="dedekinds-two-proofs-using-gaussian-integers">Dedekind's two proofs using Gaussian integers</h2>

<p><a href="Richard_Dedekind" title="wikilink">Richard Dedekind</a> gave at least two proofs of Fermat's theorem on sums of two squares, both using the arithmetical properties of the <a href="Gaussian_integers" title="wikilink">Gaussian integers</a>, which are numbers of the form <em>a</em> + <em>bi</em>, where <em>a</em> and <em>b</em> are integers, and <em>i</em> is the square root of −1. One appears in section 27 of his exposition of ideals published in 1877; the second appeared in Supplement XI to <a href="Peter_Gustav_Lejeune_Dirichlet" title="wikilink">Peter Gustav Lejeune Dirichlet</a>'s <em><a href="Vorlesungen_über_Zahlentheorie" title="wikilink">Vorlesungen über Zahlentheorie</a></em>, and was published in 1894.</p>

<p><strong>1. First proof.</strong> If 

<math display="inline" id="Proofs_of_Fermat's_theorem_on_sums_of_two_squares:125">
 <semantics>
  <mi>p</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>p</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p
  </annotation>
 </semantics>
</math>

 is an odd <a href="prime_number" title="wikilink">prime number</a>, then we have 

<math display="inline" id="Proofs_of_Fermat's_theorem_on_sums_of_two_squares:126">
 <semantics>
  <mrow>
   <msup>
    <mi>i</mi>
    <mrow>
     <mi>p</mi>
     <mo>-</mo>
     <mn>1</mn>
    </mrow>
   </msup>
   <mo>=</mo>
   <msup>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
    <mfrac>
     <mrow>
      <mi>p</mi>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
     <mn>2</mn>
    </mfrac>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>i</ci>
     <apply>
      <minus></minus>
      <ci>p</ci>
      <cn type="integer">1</cn>
     </apply>
    </apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <minus></minus>
      <cn type="integer">1</cn>
     </apply>
     <apply>
      <divide></divide>
      <apply>
       <minus></minus>
       <ci>p</ci>
       <cn type="integer">1</cn>
      </apply>
      <cn type="integer">2</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   i^{p-1}=(-1)^{\frac{p-1}{2}}
  </annotation>
 </semantics>
</math>

 in the Gaussian integers. Consequently, writing a Gaussian integer ω = <em>x</em> + <em>iy</em> with <em>x,y</em> ∈ <strong>Z</strong> and applying the <a href="Frobenius_automorphism" title="wikilink">Frobenius automorphism</a> in <strong>Z</strong>[<em>i</em>]/(<em>p</em>), one finds</p>

<p>

<math display="block" id="Proofs_of_Fermat's_theorem_on_sums_of_two_squares:127">
 <semantics>
  <mrow>
   <mrow>
    <msup>
     <mi>ω</mi>
     <mi>p</mi>
    </msup>
    <mo>=</mo>
    <msup>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mi>x</mi>
       <mo>+</mo>
       <mrow>
        <mi>y</mi>
        <mi>i</mi>
       </mrow>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <mi>p</mi>
    </msup>
    <mo>≡</mo>
    <mrow>
     <msup>
      <mi>x</mi>
      <mi>p</mi>
     </msup>
     <mo>+</mo>
     <mrow>
      <msup>
       <mi>y</mi>
       <mi>p</mi>
      </msup>
      <msup>
       <mi>i</mi>
       <mi>p</mi>
      </msup>
     </mrow>
    </mrow>
    <mo>≡</mo>
    <mrow>
     <mrow>
      <mi>x</mi>
      <mo>+</mo>
      <mrow>
       <msup>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <mo>-</mo>
          <mn>1</mn>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
        <mfrac>
         <mrow>
          <mi>p</mi>
          <mo>-</mo>
          <mn>1</mn>
         </mrow>
         <mn>2</mn>
        </mfrac>
       </msup>
       <mi>y</mi>
       <mi>i</mi>
      </mrow>
     </mrow>
     <mspace width="veryverythickmathspace">
     </mspace>
     <mrow>
      <mo lspace="8.1pt" stretchy="false">(</mo>
      <mrow>
       <mo>mod</mo>
       <mi>p</mi>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>ω</ci>
      <ci>p</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <plus></plus>
       <ci>x</ci>
       <apply>
        <times></times>
        <ci>y</ci>
        <ci>i</ci>
       </apply>
      </apply>
      <ci>p</ci>
     </apply>
    </apply>
    <apply>
     <equivalent></equivalent>
     <share href="#.cmml">
     </share>
     <apply>
      <plus></plus>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>x</ci>
       <ci>p</ci>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>y</ci>
        <ci>p</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>i</ci>
        <ci>p</ci>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <equivalent></equivalent>
     <share href="#.cmml">
     </share>
     <apply>
      <csymbol cd="latexml">annotated</csymbol>
      <apply>
       <plus></plus>
       <ci>x</ci>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <minus></minus>
          <cn type="integer">1</cn>
         </apply>
         <apply>
          <divide></divide>
          <apply>
           <minus></minus>
           <ci>p</ci>
           <cn type="integer">1</cn>
          </apply>
          <cn type="integer">2</cn>
         </apply>
        </apply>
        <ci>y</ci>
        <ci>i</ci>
       </apply>
      </apply>
      <apply>
       <ci>pmod</ci>
       <ci>p</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \omega^{p}=(x+yi)^{p}\equiv x^{p}+y^{p}i^{p}\equiv x+(-1)^{\frac{p-1}{2}}yi\;%
\;(\mathop{{\rm mod}}p),
  </annotation>
 </semantics>
</math>

 since the automorphism fixes the elements of <strong>Z</strong>/(<em>p</em>). In the current case, 

<math display="inline" id="Proofs_of_Fermat's_theorem_on_sums_of_two_squares:128">
 <semantics>
  <mrow>
   <mi>p</mi>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mn>4</mn>
     <mi>n</mi>
    </mrow>
    <mo>+</mo>
    <mn>1</mn>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>p</ci>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <cn type="integer">4</cn>
      <ci>n</ci>
     </apply>
     <cn type="integer">1</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p=4n+1
  </annotation>
 </semantics>
</math>


 for some integer n, and so in the above expression for ω<sup>p</sup>, the exponent (p-1)/2 of -1 is even. Hence the right hand side equals ω, so in this case the Frobenius endomorphism of <strong>Z</strong>[<em>i</em>]/(<em>p</em>) is the identity. Kummer had already established that if } is the <a href="order_(group_theory)" title="wikilink">order</a> of the Frobenius automorphism of <strong>Z</strong>[<em>i</em>]/(<em>p</em>), then the <a href="ideal_(ring_theory)" title="wikilink">ideal</a> 

<math display="inline" id="Proofs_of_Fermat's_theorem_on_sums_of_two_squares:129">
 <semantics>
  <mrow>
   <mo stretchy="false">(</mo>
   <mi>p</mi>
   <mo stretchy="false">)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <ci>p</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (p)
  </annotation>
 </semantics>
</math>

 in <strong>Z</strong>[<em>i</em>] would be a product of 2/<em>f</em> distinct <a href="prime_ideal" title="wikilink">prime ideals</a>. (In fact, Kummer had established a much more general result for any extension of <strong>Z</strong> obtained by adjoining a primitive <em>m</em>-th <a href="root_of_unity" title="wikilink">root of unity</a>, where <em>m</em> was any positive integer; this is the case  of that result.) Therefore the ideal (<em>p</em>) is the product of two different prime ideals in <strong>Z</strong>[<em>i</em>]. Since the Gaussian integers are a <a href="Euclidean_domain" title="wikilink">Euclidean domain</a> for the norm function 

<math display="inline" id="Proofs_of_Fermat's_theorem_on_sums_of_two_squares:130">
 <semantics>
  <mrow>
   <mrow>
    <mi>N</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>x</mi>
      <mo>+</mo>
      <mrow>
       <mi>i</mi>
       <mi>y</mi>
      </mrow>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <msup>
     <mi>x</mi>
     <mn>2</mn>
    </msup>
    <mo>+</mo>
    <msup>
     <mi>y</mi>
     <mn>2</mn>
    </msup>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>N</ci>
     <apply>
      <plus></plus>
      <ci>x</ci>
      <apply>
       <times></times>
       <ci>i</ci>
       <ci>y</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>x</ci>
      <cn type="integer">2</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>y</ci>
      <cn type="integer">2</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   N(x+iy)=x^{2}+y^{2}
  </annotation>
 </semantics>
</math>

, every ideal is principal and generated by a nonzero element of the ideal of minimal norm. Since the norm is multiplicative, the norm of a generator 

<math display="inline" id="Proofs_of_Fermat's_theorem_on_sums_of_two_squares:131">
 <semantics>
  <mi>α</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>α</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \alpha
  </annotation>
 </semantics>
</math>

 of one of the ideal factors of (<em>p</em>) must be a strict divisor of 

<math display="inline" id="Proofs_of_Fermat's_theorem_on_sums_of_two_squares:132">
 <semantics>
  <mrow>
   <mrow>
    <mi>N</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>p</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <msup>
    <mi>p</mi>
    <mn>2</mn>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>N</ci>
     <ci>p</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>p</ci>
     <cn type="integer">2</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   N(p)=p^{2}
  </annotation>
 </semantics>
</math>

, so that we must have 

<math display="inline" id="Proofs_of_Fermat's_theorem_on_sums_of_two_squares:133">
 <semantics>
  <mrow>
   <mi>p</mi>
   <mo>=</mo>
   <mrow>
    <mi>N</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>α</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mi>N</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>a</mi>
      <mo>+</mo>
      <mrow>
       <mi>b</mi>
       <mi>i</mi>
      </mrow>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <msup>
     <mi>a</mi>
     <mn>2</mn>
    </msup>
    <mo>+</mo>
    <msup>
     <mi>b</mi>
     <mn>2</mn>
    </msup>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <ci>p</ci>
     <apply>
      <times></times>
      <ci>N</ci>
      <ci>α</ci>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <ci>N</ci>
      <apply>
       <plus></plus>
       <ci>a</ci>
       <apply>
        <times></times>
        <ci>b</ci>
        <ci>i</ci>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <plus></plus>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>a</ci>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>b</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p=N(\alpha)=N(a+bi)=a^{2}+b^{2}
  </annotation>
 </semantics>
</math>


, which gives Fermat's theorem.</p>

<p><strong>2. Second proof.</strong> This proof builds on Lagrange's result that if 

<math display="inline" id="Proofs_of_Fermat's_theorem_on_sums_of_two_squares:134">
 <semantics>
  <mrow>
   <mi>p</mi>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mn>4</mn>
     <mi>n</mi>
    </mrow>
    <mo>+</mo>
    <mn>1</mn>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>p</ci>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <cn type="integer">4</cn>
      <ci>n</ci>
     </apply>
     <cn type="integer">1</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p=4n+1
  </annotation>
 </semantics>
</math>

 is a prime number, then there must be an integer <em>m</em> such that 

<math display="inline" id="Proofs_of_Fermat's_theorem_on_sums_of_two_squares:135">
 <semantics>
  <mrow>
   <msup>
    <mi>m</mi>
    <mn>2</mn>
   </msup>
   <mo>+</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <plus></plus>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>m</ci>
     <cn type="integer">2</cn>
    </apply>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   m^{2}+1
  </annotation>
 </semantics>
</math>

 is divisible by <em>p</em> (we can also see this by <a href="Euler's_criterion" title="wikilink">Euler's criterion</a>); it also uses the fact that the Gaussian integers are a <a href="unique_factorization_domain" title="wikilink">unique factorization domain</a> (because they are a Euclidean domain). Since  does not divide either of the Gaussian integers 

<math display="inline" id="Proofs_of_Fermat's_theorem_on_sums_of_two_squares:136">
 <semantics>
  <mrow>
   <mi>m</mi>
   <mo>+</mo>
   <mi>i</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <plus></plus>
    <ci>m</ci>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   m+i
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Proofs_of_Fermat's_theorem_on_sums_of_two_squares:137">
 <semantics>
  <mrow>
   <mi>m</mi>
   <mo>-</mo>
   <mi>i</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <minus></minus>
    <ci>m</ci>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   m-i
  </annotation>
 </semantics>
</math>

 (as it does not divide their <a href="imaginary_part" title="wikilink">imaginary parts</a>), but it does divide their product 

<math display="inline" id="Proofs_of_Fermat's_theorem_on_sums_of_two_squares:138">
 <semantics>
  <mrow>
   <msup>
    <mi>m</mi>
    <mn>2</mn>
   </msup>
   <mo>+</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <plus></plus>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>m</ci>
     <cn type="integer">2</cn>
    </apply>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   m^{2}+1
  </annotation>
 </semantics>
</math>


, it follows that 

<math display="inline" id="Proofs_of_Fermat's_theorem_on_sums_of_two_squares:139">
 <semantics>
  <mi>p</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>p</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p
  </annotation>
 </semantics>
</math>

 cannot be a <a href="Integral_domain#Divisibility,_prime_and_irreducible_elements" title="wikilink">prime</a> element in the Gaussian integers. We must therefore have a nontrivial factorization of <em>p</em> in the Gaussian integers, which in view of the norm can have only two factors (since the norm is multiplicative, and 

<math display="inline" id="Proofs_of_Fermat's_theorem_on_sums_of_two_squares:140">
 <semantics>
  <mrow>
   <msup>
    <mi>p</mi>
    <mn>2</mn>
   </msup>
   <mo>=</mo>
   <mrow>
    <mi>N</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>p</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>p</ci>
     <cn type="integer">2</cn>
    </apply>
    <apply>
     <times></times>
     <ci>N</ci>
     <ci>p</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p^{2}=N(p)
  </annotation>
 </semantics>
</math>

, there can only be up to two factors of p), so it must be of the form 

<math display="inline" id="Proofs_of_Fermat's_theorem_on_sums_of_two_squares:141">
 <semantics>
  <mrow>
   <mi>p</mi>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>x</mi>
      <mo>+</mo>
      <mrow>
       <mi>y</mi>
       <mi>i</mi>
      </mrow>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>x</mi>
      <mo>-</mo>
      <mrow>
       <mi>y</mi>
       <mi>i</mi>
      </mrow>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>p</ci>
    <apply>
     <times></times>
     <apply>
      <plus></plus>
      <ci>x</ci>
      <apply>
       <times></times>
       <ci>y</ci>
       <ci>i</ci>
      </apply>
     </apply>
     <apply>
      <minus></minus>
      <ci>x</ci>
      <apply>
       <times></times>
       <ci>y</ci>
       <ci>i</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p=(x+yi)(x-yi)
  </annotation>
 </semantics>
</math>

 for some integers 

<math display="inline" id="Proofs_of_Fermat's_theorem_on_sums_of_two_squares:142">
 <semantics>
  <mi>x</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>x</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Proofs_of_Fermat's_theorem_on_sums_of_two_squares:143">
 <semantics>
  <mi>y</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>y</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   y
  </annotation>
 </semantics>
</math>


. This immediately yields that 

<math display="inline" id="Proofs_of_Fermat's_theorem_on_sums_of_two_squares:144">
 <semantics>
  <mrow>
   <mi>p</mi>
   <mo>=</mo>
   <mrow>
    <msup>
     <mi>x</mi>
     <mn>2</mn>
    </msup>
    <mo>+</mo>
    <msup>
     <mi>y</mi>
     <mn>2</mn>
    </msup>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>p</ci>
    <apply>
     <plus></plus>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>x</ci>
      <cn type="integer">2</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>y</ci>
      <cn type="integer">2</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p=x^{2}+y^{2}
  </annotation>
 </semantics>
</math>

.</p>
<h2 id="zagiers-one-sentence-proof">Zagier's "one-sentence proof"</h2>

<p>If <em>p</em> = 4<em>k</em> + 1 is prime, then the set <em>S</em> = {(<em>x</em>, <em>y</em>, <em>z</em>) ∈ <strong>N</strong><sup>3</sup>: <em>x</em><sup>2</sup> + 4<em>yz</em> = <em>p</em>} (here the set <strong>N</strong> of all natural numbers can be taken to include 0 or to exclude 0, and in both cases, <em>x</em>, <em>y</em> and <em>z</em> must be positive for any (<em>x</em>, <em>y</em>, <em>z</em>) ∈ <em>S</em>, as <em>p</em> is an odd prime) is finite and has two <a href="involution_(mathematics)" title="wikilink">involutions</a>: an obvious one (<em>x</em>, <em>y</em>, <em>z</em>) → (<em>x</em>, <em>z</em>, <em>y</em>), whose fixed points correspond to representations of <em>p</em> as a sum of two squares, and a more complicated one,</p>

<p>

<math display="block" id="Proofs_of_Fermat's_theorem_on_sums_of_two_squares:145">
 <semantics>
  <mrow>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>x</mi>
    <mo>,</mo>
    <mi>y</mi>
    <mo>,</mo>
    <mi>z</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>↦</mo>
   <mrow>
    <mo>{</mo>
    <mtable displaystyle="true">
     <mtr>
      <mtd columnalign="left">
       <mrow>
        <mrow>
         <mrow>
          <mo stretchy="false">(</mo>
          <mrow>
           <mi>x</mi>
           <mo>+</mo>
           <mrow>
            <mn>2</mn>
            <mi>z</mi>
           </mrow>
          </mrow>
          <mo rspace="5.8pt">,</mo>
          <mi>z</mi>
          <mo rspace="5.8pt">,</mo>
          <mrow>
           <mi>y</mi>
           <mo>-</mo>
           <mi>x</mi>
           <mo>-</mo>
           <mi>z</mi>
          </mrow>
          <mo stretchy="false">)</mo>
         </mrow>
         <mo rspace="12.5pt">,</mo>
         <mrow>
          <mpadded width="+5.1pt">
           <mtext>if</mtext>
          </mpadded>
          <mi>x</mi>
         </mrow>
        </mrow>
        <mo><</mo>
        <mrow>
         <mi>y</mi>
         <mo>-</mo>
         <mi>z</mi>
        </mrow>
       </mrow>
      </mtd>
      <mtd></mtd>
     </mtr>
     <mtr>
      <mtd columnalign="left">
       <mrow>
        <mrow>
         <mrow>
          <mo stretchy="false">(</mo>
          <mrow>
           <mrow>
            <mn>2</mn>
            <mi>y</mi>
           </mrow>
           <mo>-</mo>
           <mi>x</mi>
          </mrow>
          <mo rspace="5.8pt">,</mo>
          <mi>y</mi>
          <mo rspace="5.8pt">,</mo>
          <mrow>
           <mrow>
            <mi>x</mi>
            <mo>-</mo>
            <mi>y</mi>
           </mrow>
           <mo>+</mo>
           <mi>z</mi>
          </mrow>
          <mo stretchy="false">)</mo>
         </mrow>
         <mo rspace="12.5pt">,</mo>
         <mrow>
          <mrow>
           <mpadded width="+5.1pt">
            <mtext>if</mtext>
           </mpadded>
           <mi>y</mi>
          </mrow>
          <mo>-</mo>
          <mi>z</mi>
         </mrow>
        </mrow>
        <mo><</mo>
        <mi>x</mi>
        <mo><</mo>
        <mrow>
         <mn>2</mn>
         <mi>y</mi>
        </mrow>
       </mrow>
      </mtd>
      <mtd></mtd>
     </mtr>
     <mtr>
      <mtd columnalign="left">
       <mrow>
        <mrow>
         <mrow>
          <mo stretchy="false">(</mo>
          <mrow>
           <mi>x</mi>
           <mo>-</mo>
           <mrow>
            <mn>2</mn>
            <mi>y</mi>
           </mrow>
          </mrow>
          <mo rspace="5.8pt">,</mo>
          <mrow>
           <mrow>
            <mi>x</mi>
            <mo>-</mo>
            <mi>y</mi>
           </mrow>
           <mo>+</mo>
           <mi>z</mi>
          </mrow>
          <mo rspace="5.8pt">,</mo>
          <mi>y</mi>
          <mo stretchy="false">)</mo>
         </mrow>
         <mo rspace="12.5pt">,</mo>
         <mrow>
          <mpadded width="+5.1pt">
           <mtext>if</mtext>
          </mpadded>
          <mi>x</mi>
         </mrow>
        </mrow>
        <mo>></mo>
        <mrow>
         <mn>2</mn>
         <mi>y</mi>
        </mrow>
       </mrow>
      </mtd>
      <mtd></mtd>
     </mtr>
    </mtable>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">maps-to</csymbol>
    <vector>
     <ci>x</ci>
     <ci>y</ci>
     <ci>z</ci>
    </vector>
    <apply>
     <csymbol cd="latexml">cases</csymbol>
     <apply>
      <lt></lt>
      <list>
       <vector>
        <apply>
         <plus></plus>
         <ci>x</ci>
         <apply>
          <times></times>
          <cn type="integer">2</cn>
          <ci>z</ci>
         </apply>
        </apply>
        <ci>z</ci>
        <apply>
         <minus></minus>
         <ci>y</ci>
         <ci>x</ci>
         <ci>z</ci>
        </apply>
       </vector>
       <apply>
        <times></times>
        <mtext>if</mtext>
        <ci>x</ci>
       </apply>
      </list>
      <apply>
       <minus></minus>
       <ci>y</ci>
       <ci>z</ci>
      </apply>
     </apply>
     <mtext>otherwise</mtext>
     <apply>
      <and></and>
      <apply>
       <lt></lt>
       <list>
        <vector>
         <apply>
          <minus></minus>
          <apply>
           <times></times>
           <cn type="integer">2</cn>
           <ci>y</ci>
          </apply>
          <ci>x</ci>
         </apply>
         <ci>y</ci>
         <apply>
          <plus></plus>
          <apply>
           <minus></minus>
           <ci>x</ci>
           <ci>y</ci>
          </apply>
          <ci>z</ci>
         </apply>
        </vector>
        <apply>
         <minus></minus>
         <apply>
          <times></times>
          <mtext>if</mtext>
          <ci>y</ci>
         </apply>
         <ci>z</ci>
        </apply>
       </list>
       <ci>x</ci>
      </apply>
      <apply>
       <lt></lt>
       <share href="#.cmml">
       </share>
       <apply>
        <times></times>
        <cn type="integer">2</cn>
        <ci>y</ci>
       </apply>
      </apply>
     </apply>
     <mtext>otherwise</mtext>
     <apply>
      <gt></gt>
      <list>
       <vector>
        <apply>
         <minus></minus>
         <ci>x</ci>
         <apply>
          <times></times>
          <cn type="integer">2</cn>
          <ci>y</ci>
         </apply>
        </apply>
        <apply>
         <plus></plus>
         <apply>
          <minus></minus>
          <ci>x</ci>
          <ci>y</ci>
         </apply>
         <ci>z</ci>
        </apply>
        <ci>y</ci>
       </vector>
       <apply>
        <times></times>
        <mtext>if</mtext>
        <ci>x</ci>
       </apply>
      </list>
      <apply>
       <times></times>
       <cn type="integer">2</cn>
       <ci>y</ci>
      </apply>
     </apply>
     <mtext>otherwise</mtext>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (x,y,z)\mapsto\begin{cases}(x+2z,~{}z,~{}y-x-z),\quad\textrm{if}\,\,\,x<y-z\\
(2y-x,~{}y,~{}x-y+z),\quad\textrm{if}\,\,\,y-z<x<2y\\
(x-2y,~{}x-y+z,~{}y),\quad\textrm{if}\,\,\,x>2y\end{cases}
  </annotation>
 </semantics>
</math>

</p>

<p>which has exactly one fixed point, (1, 1, <em>k</em>); however, the number of fixed points of an involution of a finite set <em>S</em> has the same parity as the <a class="uri" href="cardinality" title="wikilink">cardinality</a> of <em>S</em>, so this number is odd (hence, not zero) for the first involution as well, proving that <em>p</em> is a sum of two squares.</p>

<p>This proof, due to <a href="Don_Zagier" title="wikilink">Zagier</a>, is a simplification of an earlier proof by <a href="Roger_Heath-Brown" title="wikilink">Heath-Brown</a>, which in turn was inspired by a proof of <a href="Joseph_Liouville" title="wikilink">Liouville</a>. The technique of the proof is a combinatorial analogue of the topological principle that the <a href="Euler_characteristic" title="wikilink">Euler characteristics</a> of a <a href="topological_space" title="wikilink">topological space</a> with an involution and of its <a href="Fixed_point_theorem" title="wikilink">fixed point set</a> have the same parity and is reminiscent of the use of <em>sign-reversing involutions</em> in the proofs of combinatorial bijections.</p>
<h2 id="references">References</h2>
<ul>
<li>Richard Dedekind, <em>The theory of algebraic integers</em>.</li>
<li>Harold M. Edwards, <em>Fermat's Last Theorem. A genetic introduction to algebraic number theory</em>. Graduate Texts in Mathematics no. 50, Springer-Verlag, NY, 1977.</li>
<li>C. F. Gauss, <em><a href="Disquisitiones_Arithmeticae" title="wikilink">Disquisitiones Arithmeticae</a></em> (English Edition). Transl. by Arthur A. Clarke. Springer-Verlag, 1986.</li>
<li></li>
<li>D. R. Heath-Brown, <em>Fermat's two squares theorem</em>. Invariant, 11 (1984) pp. 3–5.</li>
<li><a href="John_Stillwell" title="wikilink">John Stillwell</a>, Introduction to <em>Theory of Algebraic Integers</em> by Richard Dedekind. Cambridge Mathematical Library, Cambridge University Press, 1996.</li>
<li><a href="Don_Zagier" title="wikilink">Don Zagier</a>, <em>A one-sentence proof that every prime p ≡ 1 mod 4 is a sum of two squares</em>. Amer. Math. Monthly 97 (1990), no. 2, 144, </li>
</ul>
<h2 id="notes">Notes</h2>
<h2 id="external-links">External links</h2>
<ul>
<li><a href="http://planetmath.org/encyclopedia/ProofOfThuesLemma.html">Two more proofs at PlanetMath.org</a></li>
<li></li>
<li><a href="http://eprints.maths.ox.ac.uk/677/">reprint of Heath-Brown's proof, with commentary</a></li>
</ul>

<p>"</p>

<p><a href="Category:Additive_number_theory" title="wikilink">Category:Additive number theory</a> <a href="Category:Algebraic_number_theory" title="wikilink">Category:Algebraic number theory</a> <a href="Category:Quadratic_forms" title="wikilink">Category:Quadratic forms</a> <a href="Category:Article_proofs" title="wikilink">Category:Article proofs</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1">See Goldman's book, §22.5<a href="#fnref1">↩</a></li>
<li id="fn2"><a href="http://www.math.dartmouth.edu/~euler/correspondence/letters/OO0852.pdf">Euler à Goldbach, lettre CXXV</a><a href="#fnref2">↩</a></li>
<li id="fn3">De numerus qui sunt aggregata quorum quadratorum. (Novi commentarii academiae scientiarum Petropolitanae 4 (1752/3), 1758, 3-40) <a href="http://www.math.dartmouth.edu/~euler/docs/originals/E228.pdf">1</a><a href="#fnref3">↩</a></li>
<li id="fn4">Demonstratio theorematis FERMATIANI omnem numerum primum formae 4n+1 esse summam duorum quadratorum. (Novi commentarii academiae scientiarum Petropolitanae 5 (1754/5), 1760, 3-13) <a href="http://www.math.dartmouth.edu/~euler/docs/originals/E241.pdf">2</a><a href="#fnref4">↩</a></li>
<li id="fn5">Nouv. Mém. Acad. Berlin, année 1771, 125; ibid. année 1773, 275; ibid année 1775, 351.<a href="#fnref5">↩</a></li>
</ol>
</section>
</body>
</html>

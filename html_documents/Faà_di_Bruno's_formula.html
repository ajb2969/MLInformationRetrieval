<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="823">Faà di Bruno's formula</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Faà di Bruno's formula</h1>
<hr/>

<p><strong>Faà di Bruno's formula</strong> is an identity in <a class="uri" href="mathematics" title="wikilink">mathematics</a> generalizing the <a href="chain_rule" title="wikilink">chain rule</a> to higher derivatives, named after , though he was not the first to state or prove the formula. In 1800, more than 50 years before Faà di Bruno, the French mathematician <a href="Louis_François_Antoine_Arbogast" title="wikilink">Louis François Antoine Arbogast</a> stated the formula in a calculus textbook,<a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a> considered the first published reference on the subject.<a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a></p>

<p>Perhaps the most well-known form of Faà di Bruno's formula says that</p>

<p>

<math display="block" id="Faà_di_Bruno's_formula:0">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mfrac>
      <msup>
       <mi>d</mi>
       <mi>n</mi>
      </msup>
      <mrow>
       <mi>d</mi>
       <msup>
        <mi>x</mi>
        <mi>n</mi>
       </msup>
      </mrow>
     </mfrac>
     <mi>f</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mi>g</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>x</mi>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
     <mrow>
      <mrow>
       <mrow>
        <mfrac>
         <mrow>
          <mi>n</mi>
          <mo lspace="0pt" rspace="3.5pt">!</mo>
         </mrow>
         <mrow>
          <mrow>
           <msub>
            <mi>m</mi>
            <mn>1</mn>
           </msub>
           <mo lspace="0pt" rspace="3.5pt">!</mo>
          </mrow>
          <mpadded width="+1.7pt">
           <msup>
            <mrow>
             <mn>1</mn>
             <mo lspace="0pt" rspace="3.5pt">!</mo>
            </mrow>
            <msub>
             <mi>m</mi>
             <mn>1</mn>
            </msub>
           </msup>
          </mpadded>
          <mrow>
           <msub>
            <mi>m</mi>
            <mn>2</mn>
           </msub>
           <mo lspace="0pt" rspace="3.5pt">!</mo>
          </mrow>
          <mpadded width="+1.7pt">
           <msup>
            <mrow>
             <mn>2</mn>
             <mo lspace="0pt" rspace="3.5pt">!</mo>
            </mrow>
            <msub>
             <mi>m</mi>
             <mn>2</mn>
            </msub>
           </msup>
          </mpadded>
          <mpadded width="+1.7pt">
           <mi mathvariant="normal">⋯</mi>
          </mpadded>
          <mrow>
           <msub>
            <mi>m</mi>
            <mi>n</mi>
           </msub>
           <mo lspace="0pt" rspace="3.5pt">!</mo>
          </mrow>
          <msup>
           <mrow>
            <mi>n</mi>
            <mo lspace="0pt" rspace="3.5pt">!</mo>
           </mrow>
           <msub>
            <mi>m</mi>
            <mi>n</mi>
           </msub>
          </msup>
         </mrow>
        </mfrac>
        <mo>⋅</mo>
        <msup>
         <mi>f</mi>
         <mrow>
          <mo stretchy="false">(</mo>
          <mrow>
           <msub>
            <mi>m</mi>
            <mn>1</mn>
           </msub>
           <mo>+</mo>
           <mi mathvariant="normal">⋯</mi>
           <mo>+</mo>
           <msub>
            <mi>m</mi>
            <mi>n</mi>
           </msub>
          </mrow>
          <mo stretchy="false">)</mo>
         </mrow>
        </msup>
       </mrow>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mi>g</mi>
         <mrow>
          <mo stretchy="false">(</mo>
          <mi>x</mi>
          <mo stretchy="false">)</mo>
         </mrow>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
      <mo>⋅</mo>
      <mrow>
       <munderover>
        <mo largeop="true" movablelimits="false" symmetric="true">∏</mo>
        <mrow>
         <mi>j</mi>
         <mo>=</mo>
         <mn>1</mn>
        </mrow>
        <mi>n</mi>
       </munderover>
       <msup>
        <mrow>
         <mo>(</mo>
         <mrow>
          <msup>
           <mi>g</mi>
           <mrow>
            <mo stretchy="false">(</mo>
            <mi>j</mi>
            <mo stretchy="false">)</mo>
           </mrow>
          </msup>
          <mrow>
           <mo stretchy="false">(</mo>
           <mi>x</mi>
           <mo stretchy="false">)</mo>
          </mrow>
         </mrow>
         <mo>)</mo>
        </mrow>
        <msub>
         <mi>m</mi>
         <mi>j</mi>
        </msub>
       </msup>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <divide></divide>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>d</ci>
       <ci>n</ci>
      </apply>
      <apply>
       <times></times>
       <ci>d</ci>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>x</ci>
        <ci>n</ci>
       </apply>
      </apply>
     </apply>
     <ci>f</ci>
     <apply>
      <times></times>
      <ci>g</ci>
      <ci>x</ci>
     </apply>
    </apply>
    <apply>
     <sum></sum>
     <apply>
      <ci>normal-⋅</ci>
      <apply>
       <times></times>
       <apply>
        <ci>normal-⋅</ci>
        <apply>
         <divide></divide>
         <apply>
          <factorial></factorial>
          <ci>n</ci>
         </apply>
         <apply>
          <times></times>
          <apply>
           <factorial></factorial>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <ci>m</ci>
            <cn type="integer">1</cn>
           </apply>
          </apply>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <apply>
            <factorial></factorial>
            <cn type="float">1</cn>
           </apply>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <ci>m</ci>
            <cn type="integer">1</cn>
           </apply>
          </apply>
          <apply>
           <factorial></factorial>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <ci>m</ci>
            <cn type="integer">2</cn>
           </apply>
          </apply>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <apply>
            <factorial></factorial>
            <cn type="float">2</cn>
           </apply>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <ci>m</ci>
            <cn type="integer">2</cn>
           </apply>
          </apply>
          <ci>normal-⋯</ci>
          <apply>
           <factorial></factorial>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <ci>m</ci>
            <ci>n</ci>
           </apply>
          </apply>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <apply>
            <factorial></factorial>
            <ci>n</ci>
           </apply>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <ci>m</ci>
            <ci>n</ci>
           </apply>
          </apply>
         </apply>
        </apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>f</ci>
         <apply>
          <plus></plus>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>m</ci>
           <cn type="integer">1</cn>
          </apply>
          <ci>normal-⋯</ci>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>m</ci>
           <ci>n</ci>
          </apply>
         </apply>
        </apply>
       </apply>
       <apply>
        <times></times>
        <ci>g</ci>
        <ci>x</ci>
       </apply>
      </apply>
      <apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <csymbol cd="latexml">product</csymbol>
         <apply>
          <eq></eq>
          <ci>j</ci>
          <cn type="integer">1</cn>
         </apply>
        </apply>
        <ci>n</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <times></times>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>g</ci>
          <ci>j</ci>
         </apply>
         <ci>x</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>m</ci>
         <ci>j</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   {d^{n}\over dx^{n}}f(g(x))=\sum\frac{n!}{m_{1}!\,1!^{m_{1}}\,m_{2}!\,2!^{m_{2}%
}\,\cdots\,m_{n}!\,n!^{m_{n}}}\cdot f^{(m_{1}+\cdots+m_{n})}(g(x))\cdot\prod_{%
j=1}^{n}\left(g^{(j)}(x)\right)^{m_{j}},
  </annotation>
 </semantics>
</math>

</p>

<p>where the sum is over all <em>n</em>-<a href="tuple" title="wikilink">tuples</a> of nonnegative integers (<em>m</em><sub>1</sub>, …, <em>m</em><sub><em>n</em></sub>) satisfying the constraint</p>

<p>

<math display="block" id="Faà_di_Bruno's_formula:1">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mrow>
      <mn>1</mn>
      <mo>⋅</mo>
      <msub>
       <mi>m</mi>
       <mn>1</mn>
      </msub>
     </mrow>
     <mo>+</mo>
     <mrow>
      <mn>2</mn>
      <mo>⋅</mo>
      <msub>
       <mi>m</mi>
       <mn>2</mn>
      </msub>
     </mrow>
     <mo>+</mo>
     <mrow>
      <mn>3</mn>
      <mo>⋅</mo>
      <msub>
       <mi>m</mi>
       <mn>3</mn>
      </msub>
     </mrow>
     <mo>+</mo>
     <mi mathvariant="normal">⋯</mi>
     <mo>+</mo>
     <mrow>
      <mi>n</mi>
      <mo>⋅</mo>
      <msub>
       <mi>m</mi>
       <mi>n</mi>
      </msub>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mi>n</mi>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <plus></plus>
     <apply>
      <ci>normal-⋅</ci>
      <cn type="integer">1</cn>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>m</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <apply>
      <ci>normal-⋅</ci>
      <cn type="integer">2</cn>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>m</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
     <apply>
      <ci>normal-⋅</ci>
      <cn type="integer">3</cn>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>m</ci>
       <cn type="integer">3</cn>
      </apply>
     </apply>
     <ci>normal-⋯</ci>
     <apply>
      <ci>normal-⋅</ci>
      <ci>n</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>m</ci>
       <ci>n</ci>
      </apply>
     </apply>
    </apply>
    <ci>n</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   1\cdot m_{1}+2\cdot m_{2}+3\cdot m_{3}+\cdots+n\cdot m_{n}=n.\,
  </annotation>
 </semantics>
</math>

</p>

<p>Sometimes, to give it a memorable pattern, it is written in a way in which the coefficients that have the combinatorial interpretation discussed below are less explicit:</p>

<p>

<math display="block" id="Faà_di_Bruno's_formula:2">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mfrac>
      <msup>
       <mi>d</mi>
       <mi>n</mi>
      </msup>
      <mrow>
       <mi>d</mi>
       <msup>
        <mi>x</mi>
        <mi>n</mi>
       </msup>
      </mrow>
     </mfrac>
     <mi>f</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mi>g</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>x</mi>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
     <mrow>
      <mrow>
       <mrow>
        <mfrac>
         <mrow>
          <mi>n</mi>
          <mo lspace="0pt" rspace="3.5pt">!</mo>
         </mrow>
         <mrow>
          <mrow>
           <msub>
            <mi>m</mi>
            <mn>1</mn>
           </msub>
           <mo lspace="0pt" rspace="3.5pt">!</mo>
          </mrow>
          <mrow>
           <msub>
            <mi>m</mi>
            <mn>2</mn>
           </msub>
           <mo lspace="0pt" rspace="3.5pt">!</mo>
          </mrow>
          <mpadded width="+1.7pt">
           <mi mathvariant="normal">⋯</mi>
          </mpadded>
          <mrow>
           <msub>
            <mi>m</mi>
            <mi>n</mi>
           </msub>
           <mo lspace="0pt" rspace="3.5pt">!</mo>
          </mrow>
         </mrow>
        </mfrac>
        <mo>⋅</mo>
        <msup>
         <mi>f</mi>
         <mrow>
          <mo stretchy="false">(</mo>
          <mrow>
           <msub>
            <mi>m</mi>
            <mn>1</mn>
           </msub>
           <mo>+</mo>
           <mi mathvariant="normal">⋯</mi>
           <mo>+</mo>
           <msub>
            <mi>m</mi>
            <mi>n</mi>
           </msub>
          </mrow>
          <mo stretchy="false">)</mo>
         </mrow>
        </msup>
       </mrow>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mi>g</mi>
         <mrow>
          <mo stretchy="false">(</mo>
          <mi>x</mi>
          <mo stretchy="false">)</mo>
         </mrow>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
      <mo>⋅</mo>
      <mrow>
       <munderover>
        <mo largeop="true" movablelimits="false" symmetric="true">∏</mo>
        <mrow>
         <mi>j</mi>
         <mo>=</mo>
         <mn>1</mn>
        </mrow>
        <mi>n</mi>
       </munderover>
       <msup>
        <mrow>
         <mo>(</mo>
         <mfrac>
          <mrow>
           <msup>
            <mi>g</mi>
            <mrow>
             <mo stretchy="false">(</mo>
             <mi>j</mi>
             <mo stretchy="false">)</mo>
            </mrow>
           </msup>
           <mrow>
            <mo stretchy="false">(</mo>
            <mi>x</mi>
            <mo stretchy="false">)</mo>
           </mrow>
          </mrow>
          <mrow>
           <mi>j</mi>
           <mo lspace="0pt" rspace="3.5pt">!</mo>
          </mrow>
         </mfrac>
         <mo>)</mo>
        </mrow>
        <msub>
         <mi>m</mi>
         <mi>j</mi>
        </msub>
       </msup>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <divide></divide>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>d</ci>
       <ci>n</ci>
      </apply>
      <apply>
       <times></times>
       <ci>d</ci>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>x</ci>
        <ci>n</ci>
       </apply>
      </apply>
     </apply>
     <ci>f</ci>
     <apply>
      <times></times>
      <ci>g</ci>
      <ci>x</ci>
     </apply>
    </apply>
    <apply>
     <sum></sum>
     <apply>
      <ci>normal-⋅</ci>
      <apply>
       <times></times>
       <apply>
        <ci>normal-⋅</ci>
        <apply>
         <divide></divide>
         <apply>
          <factorial></factorial>
          <ci>n</ci>
         </apply>
         <apply>
          <times></times>
          <apply>
           <factorial></factorial>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <ci>m</ci>
            <cn type="integer">1</cn>
           </apply>
          </apply>
          <apply>
           <factorial></factorial>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <ci>m</ci>
            <cn type="integer">2</cn>
           </apply>
          </apply>
          <ci>normal-⋯</ci>
          <apply>
           <factorial></factorial>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <ci>m</ci>
            <ci>n</ci>
           </apply>
          </apply>
         </apply>
        </apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>f</ci>
         <apply>
          <plus></plus>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>m</ci>
           <cn type="integer">1</cn>
          </apply>
          <ci>normal-⋯</ci>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>m</ci>
           <ci>n</ci>
          </apply>
         </apply>
        </apply>
       </apply>
       <apply>
        <times></times>
        <ci>g</ci>
        <ci>x</ci>
       </apply>
      </apply>
      <apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <csymbol cd="latexml">product</csymbol>
         <apply>
          <eq></eq>
          <ci>j</ci>
          <cn type="integer">1</cn>
         </apply>
        </apply>
        <ci>n</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <divide></divide>
         <apply>
          <times></times>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <ci>g</ci>
           <ci>j</ci>
          </apply>
          <ci>x</ci>
         </apply>
         <apply>
          <factorial></factorial>
          <ci>j</ci>
         </apply>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>m</ci>
         <ci>j</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   {d^{n}\over dx^{n}}f(g(x))=\sum\frac{n!}{m_{1}!\,m_{2}!\,\cdots\,m_{n}!}\cdot f%
^{(m_{1}+\cdots+m_{n})}(g(x))\cdot\prod_{j=1}^{n}\left(\frac{g^{(j)}(x)}{j!}%
\right)^{m_{j}}.
  </annotation>
 </semantics>
</math>

</p>

<p>Combining the terms with the same value of <em>m</em><sub>1</sub> + <em>m</em><sub>2</sub> + ... + <em>m</em><sub><em>n</em></sub> = <em>k</em> and noticing that <em>m</em><sub> <em>j</em></sub> has to be zero for <em>j</em> &gt; <em>n</em> − <em>k</em> + 1 leads to a somewhat simpler formula expressed in terms of <a href="Bell_polynomial" title="wikilink">Bell polynomials</a> <em>B</em><sub><em>n</em>,<em>k</em></sub>(<em>x</em><sub>1</sub>,...,<em>x</em><sub><em>n</em>−<em>k</em>+1</sub>):</p>

<p>

<math display="block" id="Faà_di_Bruno's_formula:3">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mfrac>
      <msup>
       <mi>d</mi>
       <mi>n</mi>
      </msup>
      <mrow>
       <mi>d</mi>
       <msup>
        <mi>x</mi>
        <mi>n</mi>
       </msup>
      </mrow>
     </mfrac>
     <mi>f</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mi>g</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>x</mi>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <munderover>
      <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
      <mrow>
       <mi>k</mi>
       <mo>=</mo>
       <mn>1</mn>
      </mrow>
      <mi>n</mi>
     </munderover>
     <mrow>
      <mrow>
       <mrow>
        <msup>
         <mi>f</mi>
         <mrow>
          <mo stretchy="false">(</mo>
          <mi>k</mi>
          <mo stretchy="false">)</mo>
         </mrow>
        </msup>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <mi>g</mi>
          <mrow>
           <mo stretchy="false">(</mo>
           <mi>x</mi>
           <mo stretchy="false">)</mo>
          </mrow>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
       <mo>⋅</mo>
       <msub>
        <mi>B</mi>
        <mrow>
         <mi>n</mi>
         <mo>,</mo>
         <mi>k</mi>
        </mrow>
       </msub>
      </mrow>
      <mrow>
       <mo>(</mo>
       <mrow>
        <msup>
         <mi>g</mi>
         <mo>′</mo>
        </msup>
        <mrow>
         <mo stretchy="false">(</mo>
         <mi>x</mi>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
       <mo>,</mo>
       <mrow>
        <msup>
         <mi>g</mi>
         <mi>′′</mi>
        </msup>
        <mrow>
         <mo stretchy="false">(</mo>
         <mi>x</mi>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
       <mo>,</mo>
       <mi mathvariant="normal">…</mi>
       <mo>,</mo>
       <mrow>
        <msup>
         <mi>g</mi>
         <mrow>
          <mo stretchy="false">(</mo>
          <mrow>
           <mrow>
            <mi>n</mi>
            <mo>-</mo>
            <mi>k</mi>
           </mrow>
           <mo>+</mo>
           <mn>1</mn>
          </mrow>
          <mo stretchy="false">)</mo>
         </mrow>
        </msup>
        <mrow>
         <mo stretchy="false">(</mo>
         <mi>x</mi>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
       <mo>)</mo>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <divide></divide>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>d</ci>
       <ci>n</ci>
      </apply>
      <apply>
       <times></times>
       <ci>d</ci>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>x</ci>
        <ci>n</ci>
       </apply>
      </apply>
     </apply>
     <ci>f</ci>
     <apply>
      <times></times>
      <ci>g</ci>
      <ci>x</ci>
     </apply>
    </apply>
    <apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <apply>
        <eq></eq>
        <ci>k</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <ci>n</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <ci>normal-⋅</ci>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>f</ci>
         <ci>k</ci>
        </apply>
        <apply>
         <times></times>
         <ci>g</ci>
         <ci>x</ci>
        </apply>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>B</ci>
        <list>
         <ci>n</ci>
         <ci>k</ci>
        </list>
       </apply>
      </apply>
      <vector>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>g</ci>
         <ci>normal-′</ci>
        </apply>
        <ci>x</ci>
       </apply>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>g</ci>
         <ci>′′</ci>
        </apply>
        <ci>x</ci>
       </apply>
       <ci>normal-…</ci>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>g</ci>
         <apply>
          <plus></plus>
          <apply>
           <minus></minus>
           <ci>n</ci>
           <ci>k</ci>
          </apply>
          <cn type="integer">1</cn>
         </apply>
        </apply>
        <ci>x</ci>
       </apply>
      </vector>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   {d^{n}\over dx^{n}}f(g(x))=\sum_{k=1}^{n}f^{(k)}(g(x))\cdot B_{n,k}\left(g^{%
\prime}(x),g^{\prime\prime}(x),\dots,g^{(n-k+1)}(x)\right).
  </annotation>
 </semantics>
</math>

</p>
<h2 id="combinatorial-form">Combinatorial form</h2>

<p>The formula has a "combinatorial" form:</p>

<p>

<math display="block" id="Faà_di_Bruno's_formula:4">
 <semantics>
  <mrow>
   <mrow>
    <mfrac>
     <msup>
      <mi>d</mi>
      <mi>n</mi>
     </msup>
     <mrow>
      <mi>d</mi>
      <msup>
       <mi>x</mi>
       <mi>n</mi>
      </msup>
     </mrow>
    </mfrac>
    <mi>f</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>g</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>x</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <msup>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mi>f</mi>
       <mo>∘</mo>
       <mi>g</mi>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>n</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </msup>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>x</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <munder>
     <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
     <mrow>
      <mi>π</mi>
      <mo>∈</mo>
      <mi mathvariant="normal">Π</mi>
     </mrow>
    </munder>
    <mrow>
     <mrow>
      <msup>
       <mi>f</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mo>|</mo>
         <mi>π</mi>
         <mo>|</mo>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
      </msup>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mi>g</mi>
        <mrow>
         <mo stretchy="false">(</mo>
         <mi>x</mi>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo>⋅</mo>
     <mrow>
      <munder>
       <mo largeop="true" movablelimits="false" symmetric="true">∏</mo>
       <mrow>
        <mi>B</mi>
        <mo>∈</mo>
        <mi>π</mi>
       </mrow>
      </munder>
      <mrow>
       <msup>
        <mi>g</mi>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <mo>|</mo>
          <mi>B</mi>
          <mo>|</mo>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
       </msup>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>x</mi>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>d</ci>
        <ci>n</ci>
       </apply>
       <apply>
        <times></times>
        <ci>d</ci>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>x</ci>
         <ci>n</ci>
        </apply>
       </apply>
      </apply>
      <ci>f</ci>
      <apply>
       <times></times>
       <ci>g</ci>
       <ci>x</ci>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <compose></compose>
        <ci>f</ci>
        <ci>g</ci>
       </apply>
       <ci>n</ci>
      </apply>
      <ci>x</ci>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <apply>
        <in></in>
        <ci>π</ci>
        <ci>normal-Π</ci>
       </apply>
      </apply>
      <apply>
       <ci>normal-⋅</ci>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>f</ci>
         <apply>
          <abs></abs>
          <ci>π</ci>
         </apply>
        </apply>
        <apply>
         <times></times>
         <ci>g</ci>
         <ci>x</ci>
        </apply>
       </apply>
       <apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <csymbol cd="latexml">product</csymbol>
         <apply>
          <in></in>
          <ci>B</ci>
          <ci>π</ci>
         </apply>
        </apply>
        <apply>
         <times></times>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>g</ci>
          <apply>
           <abs></abs>
           <ci>B</ci>
          </apply>
         </apply>
         <ci>x</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   {d^{n}\over dx^{n}}f(g(x))=(f\circ g)^{(n)}(x)=\sum_{\pi\in\Pi}f^{(\left|\pi%
\right|)}(g(x))\cdot\prod_{B\in\pi}g^{(\left|B\right|)}(x)
  </annotation>
 </semantics>
</math>

</p>

<p>where</p>
<ul>
<li>π runs through the set Π of all <a href="partition_of_a_set" title="wikilink">partitions of the set</a> { 1, ..., <em>n</em> },</li>
</ul>
<ul>
<li>"<em>B</em> ∈ π" means the variable <em>B</em> runs through the list of all of the "blocks" of the partition π, and</li>
</ul>
<ul>
<li>|<em>A</em>| denotes the cardinality of the set <em>A</em> (so that |π| is the number of blocks in the partition π and |<em>B</em>| is the size of the block <em>B</em>).</li>
</ul>
<h2 id="explanation-via-an-example">Explanation via an example</h2>

<p>The combinatorial form may initially seem forbidding, so let us examine a concrete case, and see what the pattern is:</p>

<p>

<math display="inline" id="Faà_di_Bruno's_formula:5">
 <semantics>
  <mrow>
   <msup>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>f</mi>
      <mo>∘</mo>
      <mi>g</mi>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
    <mi>′′′′</mi>
   </msup>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>x</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <compose></compose>
      <ci>f</ci>
      <ci>g</ci>
     </apply>
     <ci>′′′′</ci>
    </apply>
    <ci>x</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle(f\circ g)^{\prime\prime\prime\prime}(x)
  </annotation>
 </semantics>
</math>


</p>

<p>The pattern is</p>

<p>

<math display="inline" id="Faà_di_Bruno's_formula:6">
 <semantics>
  <mrow>
   <msup>
    <mi>g</mi>
    <mo>′</mo>
   </msup>
   <msup>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>x</mi>
     <mo stretchy="false">)</mo>
    </mrow>
    <mn>4</mn>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>g</ci>
     <ci>normal-′</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>x</ci>
     <cn type="integer">4</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle g^{\prime}(x)^{4}
  </annotation>
 </semantics>
</math>


</p>

<p>The factor 

<math display="inline" id="Faà_di_Bruno's_formula:7">
 <semantics>
  <mrow>
   <msup>
    <mi>g</mi>
    <mi>′′</mi>
   </msup>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>x</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <msup>
    <mi>g</mi>
    <mo>′</mo>
   </msup>
   <mpadded width="+2.8pt">
    <msup>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>x</mi>
      <mo stretchy="false">)</mo>
     </mrow>
     <mn>2</mn>
    </msup>
   </mpadded>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>g</ci>
     <ci>′′</ci>
    </apply>
    <ci>x</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>g</ci>
     <ci>normal-′</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>x</ci>
     <cn type="integer">2</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \scriptstyle g^{\prime\prime}(x)g^{\prime}(x)^{2}\;
  </annotation>
 </semantics>
</math>

 corresponds to the partition 2 + 1 + 1 of the integer 4, in the obvious way. The factor 

<math display="inline" id="Faà_di_Bruno's_formula:8">
 <semantics>
  <mrow>
   <msup>
    <mi>f</mi>
    <mi>′′′</mi>
   </msup>
   <mrow>
    <mo stretchy="false">(</mo>
    <mrow>
     <mi>g</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>x</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo rspace="5.3pt" stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>f</ci>
     <ci>′′′</ci>
    </apply>
    <apply>
     <times></times>
     <ci>g</ci>
     <ci>x</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \scriptstyle f^{\prime\prime\prime}(g(x))\;
  </annotation>
 </semantics>
</math>

 that goes with it corresponds to the fact that there are <em>three</em> summands in that partition. The coefficient 6 that goes with those factors corresponds to the fact that there are exactly six partitions of a set of four members that break it into one part of size 2 and two parts of size 1.</p>

<p>Similarly, the factor 

<math display="inline" id="Faà_di_Bruno's_formula:9">
 <semantics>
  <mrow>
   <msup>
    <mi>g</mi>
    <mi>′′</mi>
   </msup>
   <mpadded width="+2.8pt">
    <msup>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>x</mi>
      <mo stretchy="false">)</mo>
     </mrow>
     <mn>2</mn>
    </msup>
   </mpadded>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>g</ci>
     <ci>′′</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>x</ci>
     <cn type="integer">2</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \scriptstyle g^{\prime\prime}(x)^{2}\;
  </annotation>
 </semantics>
</math>

 in the third line corresponds to the partition 2 + 2 of the integer 4, (4, because we are finding the fourth derivative), while 

<math display="inline" id="Faà_di_Bruno's_formula:10">
 <semantics>
  <mrow>
   <msup>
    <mi>f</mi>
    <mi>′′</mi>
   </msup>
   <mrow>
    <mo stretchy="false">(</mo>
    <mrow>
     <mi>g</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>x</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>f</ci>
     <ci>′′</ci>
    </apply>
    <apply>
     <times></times>
     <ci>g</ci>
     <ci>x</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \scriptstyle f^{\prime\prime}(g(x))\,\!
  </annotation>
 </semantics>
</math>

 corresponds to the fact that there are <em>two</em> summands (2 + 2) in that partition. The coefficient 3 corresponds to the fact that there are 

<math display="inline" id="Faà_di_Bruno's_formula:11">
 <semantics>
  <mrow>
   <mrow>
    <mfrac>
     <mn>1</mn>
     <mn>2</mn>
    </mfrac>
    <mrow>
     <mo>(</mo>
     <mstyle scriptlevel="+1">
      <mtable columnspacing="0.4em" rowspacing="0.2ex">
       <mtr>
        <mtd>
         <mn>4</mn>
        </mtd>
       </mtr>
       <mtr>
        <mtd>
         <mn>2</mn>
        </mtd>
       </mtr>
      </mtable>
     </mstyle>
     <mo>)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mn>3</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <divide></divide>
      <cn type="integer">1</cn>
      <cn type="integer">2</cn>
     </apply>
     <apply>
      <csymbol cd="latexml">binomial</csymbol>
      <cn type="integer">4</cn>
      <cn type="integer">2</cn>
     </apply>
    </apply>
    <cn type="integer">3</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \tfrac{1}{2}{\textstyle\left({{4}\atop{2}}\right)}=3
  </annotation>
 </semantics>
</math>


 ways of partitioning 4 objects into groups of 2. The same concept applies to the others.</p>

<p>A memorizable scheme is as follows:</p>

<p>

<math display="inline" id="Faà_di_Bruno's_formula:12">
 <semantics>
  <mstyle displaystyle="true">
   <mfrac>
    <mrow>
     <msup>
      <mi>D</mi>
      <mn>1</mn>
     </msup>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mi>f</mi>
       <mo>∘</mo>
       <mi>g</mi>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mrow>
     <mn>1</mn>
     <mo lspace="0pt" rspace="3.5pt">!</mo>
    </mrow>
   </mfrac>
  </mstyle>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <divide></divide>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>D</ci>
      <cn type="integer">1</cn>
     </apply>
     <apply>
      <compose></compose>
      <ci>f</ci>
      <ci>g</ci>
     </apply>
    </apply>
    <apply>
     <factorial></factorial>
     <cn type="integer">1</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle\frac{D^{1}(f\circ{}g)}{1!}
  </annotation>
 </semantics>
</math>


</p>
<h2 id="combinatorics-of-the-faà-di-bruno-coefficients">Combinatorics of the Faà di Bruno coefficients</h2>

<p>These partition-counting <strong>Faà di Bruno coefficients</strong> have a "closed-form" expression. The number of <a href="partition_of_a_set" title="wikilink">partitions of a set</a> of size <em>n</em> corresponding to the <a href="integer_partition" title="wikilink">integer partition</a></p>

<p>

<math display="block" id="Faà_di_Bruno's_formula:13">
 <semantics>
  <mrow>
   <mi>n</mi>
   <mo>=</mo>
   <mrow>
    <mpadded width="+1.7pt">
     <munder>
      <munder accentunder="true">
       <mrow>
        <mn>1</mn>
        <mo movablelimits="false">+</mo>
        <mi mathvariant="normal">⋯</mi>
        <mo movablelimits="false">+</mo>
        <mn>1</mn>
       </mrow>
       <mo movablelimits="false">⏟</mo>
      </munder>
      <msub>
       <mi>m</mi>
       <mn>1</mn>
      </msub>
     </munder>
    </mpadded>
    <mo rspace="4.2pt">+</mo>
    <mpadded width="+1.7pt">
     <munder>
      <munder accentunder="true">
       <mrow>
        <mn>2</mn>
        <mo movablelimits="false">+</mo>
        <mi mathvariant="normal">⋯</mi>
        <mo movablelimits="false">+</mo>
        <mn>2</mn>
       </mrow>
       <mo movablelimits="false">⏟</mo>
      </munder>
      <msub>
       <mi>m</mi>
       <mn>2</mn>
      </msub>
     </munder>
    </mpadded>
    <mo rspace="4.2pt">+</mo>
    <munder>
     <munder accentunder="true">
      <mrow>
       <mn>3</mn>
       <mo movablelimits="false">+</mo>
       <mi mathvariant="normal">⋯</mi>
       <mo movablelimits="false">+</mo>
       <mn>3</mn>
      </mrow>
      <mo movablelimits="false">⏟</mo>
     </munder>
     <msub>
      <mi>m</mi>
      <mn>3</mn>
     </msub>
    </munder>
    <mo rspace="4.2pt">+</mo>
    <mi mathvariant="normal">⋯</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>n</ci>
    <apply>
     <plus></plus>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <ci>normal-⏟</ci>
       <apply>
        <plus></plus>
        <cn type="integer">1</cn>
        <ci>normal-⋯</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>m</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <ci>normal-⏟</ci>
       <apply>
        <plus></plus>
        <cn type="integer">2</cn>
        <ci>normal-⋯</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>m</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <ci>normal-⏟</ci>
       <apply>
        <plus></plus>
        <cn type="integer">3</cn>
        <ci>normal-⋯</ci>
        <cn type="integer">3</cn>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>m</ci>
       <cn type="integer">3</cn>
      </apply>
     </apply>
     <ci>normal-⋯</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle n=\underbrace{1+\cdots+1}_{m_{1}}\,+\,\underbrace{2+\cdots+2}_{m%
_{2}}\,+\,\underbrace{3+\cdots+3}_{m_{3}}+\cdots
  </annotation>
 </semantics>
</math>

</p>

<p>of the integer <em>n</em> is equal to</p>

<p>

<math display="block" id="Faà_di_Bruno's_formula:14">
 <semantics>
  <mrow>
   <mfrac>
    <mrow>
     <mi>n</mi>
     <mo lspace="0pt" rspace="3.5pt">!</mo>
    </mrow>
    <mrow>
     <mrow>
      <msub>
       <mi>m</mi>
       <mn>1</mn>
      </msub>
      <mo lspace="0pt" rspace="3.5pt">!</mo>
     </mrow>
     <mrow>
      <msub>
       <mi>m</mi>
       <mn>2</mn>
      </msub>
      <mo lspace="0pt" rspace="3.5pt">!</mo>
     </mrow>
     <mrow>
      <msub>
       <mi>m</mi>
       <mn>3</mn>
      </msub>
      <mo lspace="0pt" rspace="3.5pt">!</mo>
     </mrow>
     <mi mathvariant="normal">⋯</mi>
     <msup>
      <mrow>
       <mn>1</mn>
       <mo lspace="0pt" rspace="3.5pt">!</mo>
      </mrow>
      <msub>
       <mi>m</mi>
       <mn>1</mn>
      </msub>
     </msup>
     <msup>
      <mrow>
       <mn>2</mn>
       <mo lspace="0pt" rspace="3.5pt">!</mo>
      </mrow>
      <msub>
       <mi>m</mi>
       <mn>2</mn>
      </msub>
     </msup>
     <mpadded width="+1.7pt">
      <msup>
       <mrow>
        <mn>3</mn>
        <mo lspace="0pt" rspace="3.5pt">!</mo>
       </mrow>
       <msub>
        <mi>m</mi>
        <mn>3</mn>
       </msub>
      </msup>
     </mpadded>
     <mi mathvariant="normal">⋯</mi>
    </mrow>
   </mfrac>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <divide></divide>
    <apply>
     <factorial></factorial>
     <ci>n</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <factorial></factorial>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>m</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <apply>
      <factorial></factorial>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>m</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
     <apply>
      <factorial></factorial>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>m</ci>
       <cn type="integer">3</cn>
      </apply>
     </apply>
     <ci>normal-⋯</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <factorial></factorial>
       <cn type="integer">1</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>m</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <factorial></factorial>
       <cn type="float">2</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>m</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <factorial></factorial>
       <cn type="float">3</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>m</ci>
       <cn type="integer">3</cn>
      </apply>
     </apply>
     <ci>normal-⋯</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \frac{n!}{m_{1}!\,m_{2}!\,m_{3}!\,\cdots 1!^{m_{1}}\,2!^{m_{2}}\,3!^{m_{3}}\,%
\cdots}.
  </annotation>
 </semantics>
</math>

</p>

<p>These coefficients also arise in the <a href="Bell_polynomials" title="wikilink">Bell polynomials</a>, which are relevant to the study of <a href="cumulant" title="wikilink">cumulants</a>.</p>
<h2 id="variations">Variations</h2>
<h3 id="multivariate-version">Multivariate version</h3>

<p>Let <em>y</em> = <em>g</em>(<em>x</em><sub>1</sub>, ..., <em>x</em><sub><em>n</em></sub>). Then the following identity holds regardless of whether the <em>n</em> variables are all distinct, or all identical, or partitioned into several distinguishable classes of indistinguishable variables (if it seems opaque, see the very concrete example below):<a class="footnoteRef" href="#fn3" id="fnref3"><sup>3</sup></a></p>

<p>

<math display="block" id="Faà_di_Bruno's_formula:15">
 <semantics>
  <mrow>
   <mrow>
    <mfrac>
     <msup>
      <mo>∂</mo>
      <mi>n</mi>
     </msup>
     <mrow>
      <mrow>
       <mo>∂</mo>
       <mrow>
        <msub>
         <mi>x</mi>
         <mn>1</mn>
        </msub>
        <mi mathvariant="normal">⋯</mi>
       </mrow>
      </mrow>
      <mrow>
       <mo>∂</mo>
       <msub>
        <mi>x</mi>
        <mi>n</mi>
       </msub>
      </mrow>
     </mrow>
    </mfrac>
    <mi>f</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>y</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <munder>
     <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
     <mrow>
      <mi>π</mi>
      <mo>∈</mo>
      <mi mathvariant="normal">Π</mi>
     </mrow>
    </munder>
    <mrow>
     <mrow>
      <msup>
       <mi>f</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mo>|</mo>
         <mi>π</mi>
         <mo>|</mo>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
      </msup>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>y</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo>⋅</mo>
     <mrow>
      <munder>
       <mo largeop="true" movablelimits="false" symmetric="true">∏</mo>
       <mrow>
        <mi>B</mi>
        <mo>∈</mo>
        <mi>π</mi>
       </mrow>
      </munder>
      <mfrac>
       <mrow>
        <msup>
         <mo>∂</mo>
         <mrow>
          <mo>|</mo>
          <mi>B</mi>
          <mo>|</mo>
         </mrow>
        </msup>
        <mi>y</mi>
       </mrow>
       <mrow>
        <msub>
         <mo largeop="true" symmetric="true">∏</mo>
         <mrow>
          <mi>j</mi>
          <mo>∈</mo>
          <mi>B</mi>
         </mrow>
        </msub>
        <mrow>
         <mo>∂</mo>
         <msub>
          <mi>x</mi>
          <mi>j</mi>
         </msub>
        </mrow>
       </mrow>
      </mfrac>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <divide></divide>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <partialdiff></partialdiff>
       <ci>n</ci>
      </apply>
      <apply>
       <times></times>
       <apply>
        <partialdiff></partialdiff>
        <apply>
         <times></times>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>x</ci>
          <cn type="integer">1</cn>
         </apply>
         <ci>normal-⋯</ci>
        </apply>
       </apply>
       <apply>
        <partialdiff></partialdiff>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>x</ci>
         <ci>n</ci>
        </apply>
       </apply>
      </apply>
     </apply>
     <ci>f</ci>
     <ci>y</ci>
    </apply>
    <apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <sum></sum>
      <apply>
       <in></in>
       <ci>π</ci>
       <ci>normal-Π</ci>
      </apply>
     </apply>
     <apply>
      <ci>normal-⋅</ci>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>f</ci>
        <apply>
         <abs></abs>
         <ci>π</ci>
        </apply>
       </apply>
       <ci>y</ci>
      </apply>
      <apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <csymbol cd="latexml">product</csymbol>
        <apply>
         <in></in>
         <ci>B</ci>
         <ci>π</ci>
        </apply>
       </apply>
       <apply>
        <divide></divide>
        <apply>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <partialdiff></partialdiff>
          <apply>
           <abs></abs>
           <ci>B</ci>
          </apply>
         </apply>
         <ci>y</ci>
        </apply>
        <apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <csymbol cd="latexml">product</csymbol>
          <apply>
           <in></in>
           <ci>j</ci>
           <ci>B</ci>
          </apply>
         </apply>
         <apply>
          <partialdiff></partialdiff>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>x</ci>
           <ci>j</ci>
          </apply>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   {\partial^{n}\over\partial x_{1}\cdots\partial x_{n}}f(y)=\sum_{\pi\in\Pi}f^{(%
\left|\pi\right|)}(y)\cdot\prod_{B\in\pi}{\partial^{\left|B\right|}y\over\prod%
_{j\in B}\partial x_{j}}
  </annotation>
 </semantics>
</math>

</p>

<p>where (as above)</p>
<ul>
<li>π runs through the set Π of all <a href="partition_of_a_set" title="wikilink">partitions of the set</a> { 1, ..., <em>n</em> },</li>
</ul>
<ul>
<li>"<em>B</em> ∈ π" means the variable <em>B</em> runs through the list of all of the "blocks" of the partition π, and</li>
</ul>
<ul>
<li>|<em>A</em>| denotes the cardinality of the set <em>A</em> (so that |π| is the number of blocks in the partition π and |<em>B</em>| is the size of the block <em>B</em>).</li>
</ul>

<p>A further generalization, due to Tsoy-Wo Ma, considers the case where <em>y</em> is a vector-valued variable.<a class="footnoteRef" href="#fn4" id="fnref4"><sup>4</sup></a> The general form, for variational calculus (<a href="Gâteaux_derivative" title="wikilink">Gâteaux differentials</a> are the most general form of differential), was derived in 2012.<a class="footnoteRef" href="#fn5" id="fnref5"><sup>5</sup></a></p>
<dl>
<dt>Example</dt>
</dl>

<p>The five terms in the following expression correspond in the obvious way to the five partitions of the set { 1, 2, 3 }, and in each case the order of the derivative of <em>f</em> is the number of parts in the partition:</p>

<p>

<math display="inline" id="Faà_di_Bruno's_formula:16">
 <semantics>
  <mrow>
   <mstyle displaystyle="true">
    <mfrac>
     <msup>
      <mo>∂</mo>
      <mn>3</mn>
     </msup>
     <mrow>
      <mrow>
       <mo>∂</mo>
       <mpadded width="+1.7pt">
        <msub>
         <mi>x</mi>
         <mn>1</mn>
        </msub>
       </mpadded>
      </mrow>
      <mrow>
       <mo>∂</mo>
       <mpadded width="+1.7pt">
        <msub>
         <mi>x</mi>
         <mn>2</mn>
        </msub>
       </mpadded>
      </mrow>
      <mrow>
       <mo>∂</mo>
       <msub>
        <mi>x</mi>
        <mn>3</mn>
       </msub>
      </mrow>
     </mrow>
    </mfrac>
   </mstyle>
   <mi>f</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>y</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <divide></divide>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <partialdiff></partialdiff>
      <cn type="integer">3</cn>
     </apply>
     <apply>
      <times></times>
      <apply>
       <partialdiff></partialdiff>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <apply>
       <partialdiff></partialdiff>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
      <apply>
       <partialdiff></partialdiff>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <cn type="integer">3</cn>
       </apply>
      </apply>
     </apply>
    </apply>
    <ci>f</ci>
    <ci>y</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle{\partial^{3}\over\partial x_{1}\,\partial x_{2}\,\partial x_{3}}%
f(y)
  </annotation>
 </semantics>
</math>


</p>

<p>If the three variables are indistinguishable from each other, then three of the five terms above are also indistinguishable from each other, and then we have the classic one-variable formula.</p>
<h3 id="formal-power-series-version">Formal power series version</h3>

<p>Suppose 

<math display="inline" id="Faà_di_Bruno's_formula:17">
 <semantics>
  <mrow>
   <mrow>
    <mi>f</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>x</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <msubsup>
     <mo largeop="true" symmetric="true">∑</mo>
     <mrow>
      <mi>n</mi>
      <mo>=</mo>
      <mn>0</mn>
     </mrow>
     <mi mathvariant="normal">∞</mi>
    </msubsup>
    <mrow>
     <msub>
      <mi>a</mi>
      <mi>n</mi>
     </msub>
     <msup>
      <mi>x</mi>
      <mi>n</mi>
     </msup>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>f</ci>
     <ci>x</ci>
    </apply>
    <apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <apply>
        <eq></eq>
        <ci>n</ci>
        <cn type="integer">0</cn>
       </apply>
      </apply>
      <infinity></infinity>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>a</ci>
       <ci>n</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>x</ci>
       <ci>n</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f(x)=\sum_{n=0}^{\infty}{a_{n}}x^{n}
  </annotation>
 </semantics>
</math>


 and 

<math display="inline" id="Faà_di_Bruno's_formula:18">
 <semantics>
  <mrow>
   <mrow>
    <mi>g</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>x</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <msubsup>
     <mo largeop="true" symmetric="true">∑</mo>
     <mrow>
      <mi>n</mi>
      <mo>=</mo>
      <mn>0</mn>
     </mrow>
     <mi mathvariant="normal">∞</mi>
    </msubsup>
    <mrow>
     <msub>
      <mi>b</mi>
      <mi>n</mi>
     </msub>
     <msup>
      <mi>x</mi>
      <mi>n</mi>
     </msup>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>g</ci>
     <ci>x</ci>
    </apply>
    <apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <apply>
        <eq></eq>
        <ci>n</ci>
        <cn type="integer">0</cn>
       </apply>
      </apply>
      <infinity></infinity>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>b</ci>
       <ci>n</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>x</ci>
       <ci>n</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   g(x)=\sum_{n=0}^{\infty}{b_{n}}x^{n}
  </annotation>
 </semantics>
</math>

 are <a href="formal_power_series" title="wikilink">formal power series</a> and 

<math display="inline" id="Faà_di_Bruno's_formula:19">
 <semantics>
  <mrow>
   <msub>
    <mi>b</mi>
    <mn>0</mn>
   </msub>
   <mo>=</mo>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>b</ci>
     <cn type="integer">0</cn>
    </apply>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   b_{0}=0
  </annotation>
 </semantics>
</math>

.</p>

<p>Then the composition 

<math display="inline" id="Faà_di_Bruno's_formula:20">
 <semantics>
  <mrow>
   <mi>f</mi>
   <mo>∘</mo>
   <mi>g</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <compose></compose>
    <ci>f</ci>
    <ci>g</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f\circ g
  </annotation>
 </semantics>
</math>

 is again a formal power series,</p>

<p>

<math display="block" id="Faà_di_Bruno's_formula:21">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>f</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mi>g</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>x</mi>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <munderover>
      <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
      <mrow>
       <mi>n</mi>
       <mo>=</mo>
       <mn>0</mn>
      </mrow>
      <mi mathvariant="normal">∞</mi>
     </munderover>
     <mrow>
      <msub>
       <mi>c</mi>
       <mi>n</mi>
      </msub>
      <msup>
       <mi>x</mi>
       <mi>n</mi>
      </msup>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>f</ci>
     <apply>
      <times></times>
      <ci>g</ci>
      <ci>x</ci>
     </apply>
    </apply>
    <apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <apply>
        <eq></eq>
        <ci>n</ci>
        <cn type="integer">0</cn>
       </apply>
      </apply>
      <infinity></infinity>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>c</ci>
       <ci>n</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>x</ci>
       <ci>n</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f(g(x))=\sum_{n=0}^{\infty}{c_{n}}x^{n},
  </annotation>
 </semantics>
</math>

 and the coefficient <em>c</em><sub><em>n</em></sub>, for <em>n ≥ 1</em>, can be expressed as a sum over compositions of <em>n</em> or as an equivalent sum over partitions of <em>n</em> :</p>

<p>

<math display="block" id="Faà_di_Bruno's_formula:22">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>c</mi>
     <mi>n</mi>
    </msub>
    <mo>=</mo>
    <mrow>
     <munder>
      <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
      <mrow>
       <mi>𝐢</mi>
       <mo>∈</mo>
       <msub>
        <mi class="ltx_font_mathcaligraphic">𝒞</mi>
        <mi>n</mi>
       </msub>
      </mrow>
     </munder>
     <mrow>
      <msub>
       <mi>a</mi>
       <mi>k</mi>
      </msub>
      <msub>
       <mi>b</mi>
       <msub>
        <mi>i</mi>
        <mn>1</mn>
       </msub>
      </msub>
      <msub>
       <mi>b</mi>
       <msub>
        <mi>i</mi>
        <mn>2</mn>
       </msub>
      </msub>
      <mi mathvariant="normal">⋯</mi>
      <msub>
       <mi>b</mi>
       <msub>
        <mi>i</mi>
        <mi>k</mi>
       </msub>
      </msub>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>c</ci>
     <ci>n</ci>
    </apply>
    <apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <sum></sum>
      <apply>
       <in></in>
       <ci>𝐢</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>𝒞</ci>
        <ci>n</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>a</ci>
       <ci>k</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>b</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>i</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>b</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>i</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
      <ci>normal-⋯</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>b</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>i</ci>
        <ci>k</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   c_{n}=\sum_{\mathbf{i}\in\mathcal{C}_{n}}a_{k}b_{i_{1}}b_{i_{2}}\cdots b_{i_{k%
}},
  </annotation>
 </semantics>
</math>

 where</p>

<p>

<math display="block" id="Faà_di_Bruno's_formula:23">
 <semantics>
  <mrow>
   <msub>
    <mi class="ltx_font_mathcaligraphic">𝒞</mi>
    <mi>n</mi>
   </msub>
   <mo>=</mo>
   <mrow>
    <mo stretchy="false">{</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <msub>
      <mi>i</mi>
      <mn>1</mn>
     </msub>
     <mo>,</mo>
     <msub>
      <mi>i</mi>
      <mn>2</mn>
     </msub>
     <mo>,</mo>
     <mi mathvariant="normal">…</mi>
     <mo>,</mo>
     <msub>
      <mi>i</mi>
      <mi>k</mi>
     </msub>
     <mo rspace="4.2pt" stretchy="false">)</mo>
    </mrow>
    <mo>:</mo>
    <mrow>
     <mrow>
      <mn>1</mn>
      <mo>≤</mo>
      <mi>k</mi>
      <mo>≤</mo>
      <mi>n</mi>
     </mrow>
     <mo rspace="7.5pt">,</mo>
     <mrow>
      <mrow>
       <msub>
        <mi>i</mi>
        <mn>1</mn>
       </msub>
       <mo>+</mo>
       <msub>
        <mi>i</mi>
        <mn>2</mn>
       </msub>
       <mo>+</mo>
       <mi mathvariant="normal">⋯</mi>
       <mo>+</mo>
       <msub>
        <mi>i</mi>
        <mi>k</mi>
       </msub>
      </mrow>
      <mo>=</mo>
      <mi>n</mi>
     </mrow>
    </mrow>
    <mo stretchy="false">}</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>𝒞</ci>
     <ci>n</ci>
    </apply>
    <apply>
     <csymbol cd="latexml">conditional-set</csymbol>
     <vector>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>i</ci>
       <cn type="integer">1</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>i</ci>
       <cn type="integer">2</cn>
      </apply>
      <ci>normal-…</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>i</ci>
       <ci>k</ci>
      </apply>
     </vector>
     <apply>
      <csymbol cd="ambiguous">formulae-sequence</csymbol>
      <apply>
       <and></and>
       <apply>
        <leq></leq>
        <cn type="float">1</cn>
        <ci>k</ci>
       </apply>
       <apply>
        <leq></leq>
        <share href="#.cmml">
        </share>
        <ci>n</ci>
       </apply>
      </apply>
      <apply>
       <eq></eq>
       <apply>
        <plus></plus>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>i</ci>
         <cn type="integer">1</cn>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>i</ci>
         <cn type="integer">2</cn>
        </apply>
        <ci>normal-⋯</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>i</ci>
         <ci>k</ci>
        </apply>
       </apply>
       <ci>n</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathcal{C}_{n}=\{(i_{1},i_{2},\dots,i_{k})\,:\ 1\leq k\leq n,\ i_{1}+i_{2}+%
\cdots+i_{k}=n\}
  </annotation>
 </semantics>
</math>

 is the set of compositions of <em>n</em> with <em>k</em> denoting the number of parts,</p>

<p>or</p>

<p>

<math display="block" id="Faà_di_Bruno's_formula:24">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>c</mi>
     <mi>n</mi>
    </msub>
    <mo>=</mo>
    <mrow>
     <munderover>
      <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
      <mrow>
       <mi>k</mi>
       <mo>=</mo>
       <mn>1</mn>
      </mrow>
      <mi>n</mi>
     </munderover>
     <mrow>
      <msub>
       <mi>a</mi>
       <mi>k</mi>
      </msub>
      <mrow>
       <munder>
        <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
        <mrow>
         <mi>π</mi>
         <mo>∈</mo>
         <msub>
          <mi class="ltx_font_mathcaligraphic">𝒫</mi>
          <mrow>
           <mi>n</mi>
           <mo>,</mo>
           <mi>k</mi>
          </mrow>
         </msub>
        </mrow>
       </munder>
       <mrow>
        <mrow>
         <mo>(</mo>
         <mtable columnspacing="0.4em" rowspacing="0.2ex">
          <mtr>
           <mtd>
            <mi>k</mi>
           </mtd>
          </mtr>
          <mtr>
           <mtd>
            <mrow>
             <msub>
              <mi>π</mi>
              <mn>1</mn>
             </msub>
             <mo>,</mo>
             <msub>
              <mi>π</mi>
              <mn>2</mn>
             </msub>
             <mo>,</mo>
             <mi mathvariant="normal">…</mi>
             <mo>,</mo>
             <msub>
              <mi>π</mi>
              <mi>n</mi>
             </msub>
            </mrow>
           </mtd>
          </mtr>
         </mtable>
         <mo>)</mo>
        </mrow>
        <msubsup>
         <mi>b</mi>
         <mn>1</mn>
         <msub>
          <mi>π</mi>
          <mn>1</mn>
         </msub>
        </msubsup>
        <msubsup>
         <mi>b</mi>
         <mn>2</mn>
         <msub>
          <mi>π</mi>
          <mn>2</mn>
         </msub>
        </msubsup>
        <mi mathvariant="normal">⋯</mi>
        <msubsup>
         <mi>b</mi>
         <mi>n</mi>
         <msub>
          <mi>π</mi>
          <mi>n</mi>
         </msub>
        </msubsup>
       </mrow>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>c</ci>
     <ci>n</ci>
    </apply>
    <apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <apply>
        <eq></eq>
        <ci>k</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <ci>n</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>a</ci>
       <ci>k</ci>
      </apply>
      <apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <apply>
         <in></in>
         <ci>π</ci>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>𝒫</ci>
          <list>
           <ci>n</ci>
           <ci>k</ci>
          </list>
         </apply>
        </apply>
       </apply>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="latexml">binomial</csymbol>
         <ci>k</ci>
         <list>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>π</ci>
           <cn type="integer">1</cn>
          </apply>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>π</ci>
           <cn type="integer">2</cn>
          </apply>
          <ci>normal-…</ci>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>π</ci>
           <ci>n</ci>
          </apply>
         </list>
        </apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>b</ci>
          <cn type="integer">1</cn>
         </apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>π</ci>
          <cn type="integer">1</cn>
         </apply>
        </apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>b</ci>
          <cn type="integer">2</cn>
         </apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>π</ci>
          <cn type="integer">2</cn>
         </apply>
        </apply>
        <ci>normal-⋯</ci>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>b</ci>
          <ci>n</ci>
         </apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>π</ci>
          <ci>n</ci>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   c_{n}=\sum_{k=1}^{n}a_{k}\sum_{\mathbf{\pi}\in\mathcal{P}_{n,k}}{\left({{k}%
\atop{\pi_{1},\pi_{2},...,\pi_{n}}}\right)}b_{1}^{\pi_{1}}b_{2}^{\pi_{2}}%
\cdots b_{n}^{\pi_{n}},
  </annotation>
 </semantics>
</math>

 where</p>

<p>

<math display="block" id="Faà_di_Bruno's_formula:25">
 <semantics>
  <mrow>
   <msub>
    <mi class="ltx_font_mathcaligraphic">𝒫</mi>
    <mrow>
     <mi>n</mi>
     <mo>,</mo>
     <mi>k</mi>
    </mrow>
   </msub>
   <mo>=</mo>
   <mrow>
    <mo stretchy="false">{</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <msub>
      <mi>π</mi>
      <mn>1</mn>
     </msub>
     <mo>,</mo>
     <msub>
      <mi>π</mi>
      <mn>2</mn>
     </msub>
     <mo>,</mo>
     <mi mathvariant="normal">…</mi>
     <mo>,</mo>
     <msub>
      <mi>π</mi>
      <mi>n</mi>
     </msub>
     <mo rspace="4.2pt" stretchy="false">)</mo>
    </mrow>
    <mo rspace="7.5pt">:</mo>
    <mrow>
     <mrow>
      <mrow>
       <msub>
        <mi>π</mi>
        <mn>1</mn>
       </msub>
       <mo>+</mo>
       <msub>
        <mi>π</mi>
        <mn>2</mn>
       </msub>
       <mo>+</mo>
       <mi mathvariant="normal">⋯</mi>
       <mo>+</mo>
       <msub>
        <mi>π</mi>
        <mi>n</mi>
       </msub>
      </mrow>
      <mo>=</mo>
      <mi>k</mi>
     </mrow>
     <mo rspace="7.5pt">,</mo>
     <mrow>
      <mrow>
       <mrow>
        <msub>
         <mi>π</mi>
         <mn>1</mn>
        </msub>
        <mo>⋅</mo>
        <mn>1</mn>
       </mrow>
       <mo>+</mo>
       <mrow>
        <msub>
         <mi>π</mi>
         <mn>2</mn>
        </msub>
        <mo>⋅</mo>
        <mn>2</mn>
       </mrow>
       <mo>+</mo>
       <mi mathvariant="normal">⋯</mi>
       <mo>+</mo>
       <mrow>
        <msub>
         <mi>π</mi>
         <mi>n</mi>
        </msub>
        <mo>⋅</mo>
        <mi>n</mi>
       </mrow>
      </mrow>
      <mo>=</mo>
      <mi>n</mi>
     </mrow>
    </mrow>
    <mo stretchy="false">}</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>𝒫</ci>
     <list>
      <ci>n</ci>
      <ci>k</ci>
     </list>
    </apply>
    <apply>
     <csymbol cd="latexml">conditional-set</csymbol>
     <vector>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>π</ci>
       <cn type="integer">1</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>π</ci>
       <cn type="integer">2</cn>
      </apply>
      <ci>normal-…</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>π</ci>
       <ci>n</ci>
      </apply>
     </vector>
     <apply>
      <csymbol cd="ambiguous">formulae-sequence</csymbol>
      <apply>
       <eq></eq>
       <apply>
        <plus></plus>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>π</ci>
         <cn type="integer">1</cn>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>π</ci>
         <cn type="integer">2</cn>
        </apply>
        <ci>normal-⋯</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>π</ci>
         <ci>n</ci>
        </apply>
       </apply>
       <ci>k</ci>
      </apply>
      <apply>
       <eq></eq>
       <apply>
        <plus></plus>
        <apply>
         <ci>normal-⋅</ci>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>π</ci>
          <cn type="integer">1</cn>
         </apply>
         <cn type="integer">1</cn>
        </apply>
        <apply>
         <ci>normal-⋅</ci>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>π</ci>
          <cn type="integer">2</cn>
         </apply>
         <cn type="integer">2</cn>
        </apply>
        <ci>normal-⋯</ci>
        <apply>
         <ci>normal-⋅</ci>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>π</ci>
          <ci>n</ci>
         </apply>
         <ci>n</ci>
        </apply>
       </apply>
       <ci>n</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathcal{P}_{n,k}=\{(\pi_{1},\pi_{2},\dots,\pi_{n})\,:\ \pi_{1}+\pi_{2}+\cdots%
+\pi_{n}=k,\ \pi_{1}\cdot 1+\pi_{2}\cdot 2+\cdots+\pi_{n}\cdot n=n\}
  </annotation>
 </semantics>
</math>

 is the set of partitions of <em>n</em> into <em>k</em> parts, in frequency-of-parts form.</p>

<p>The first form is obtained by picking out the coefficient of <em>x</em><sup><em>n</em></sup> in 

<math display="inline" id="Faà_di_Bruno's_formula:26">
 <semantics>
  <msup>
   <mrow>
    <mo stretchy="false">(</mo>
    <mrow>
     <mrow>
      <msub>
       <mi>b</mi>
       <mn>1</mn>
      </msub>
      <mi>x</mi>
     </mrow>
     <mo>+</mo>
     <mrow>
      <msub>
       <mi>b</mi>
       <mn>2</mn>
      </msub>
      <msup>
       <mi>x</mi>
       <mn>2</mn>
      </msup>
     </mrow>
     <mo>+</mo>
     <mi mathvariant="normal">⋯</mi>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
   <mi>k</mi>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>b</ci>
       <cn type="integer">1</cn>
      </apply>
      <ci>x</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>b</ci>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>x</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
     <ci>normal-⋯</ci>
    </apply>
    <ci>k</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (b_{1}x+b_{2}x^{2}+\cdots)^{k}
  </annotation>
 </semantics>
</math>

 "by inspection", and the second form is then obtained by collecting like terms, or alternatively, by applying the <a href="multinomial_theorem" title="wikilink">multinomial theorem</a>.</p>

<p>The special case <em>f(x) = e<sup>x</sup>, g(x) = ∑<sub>n ≥ 1</sub> a<sub>n</sub>/n! x<sup>n</sup></em> gives the <a href="exponential_formula" title="wikilink">exponential formula</a>. The special case <em>f(x) = 1/(1-x), g(x) = ∑<sub>n ≥ 1</sub> (-a<sub>n</sub>) x<sup>n</sup></em> gives an expression for the <a href="Reciprocal_(mathematics)" title="wikilink">reciprocal</a> of the formal power series '' ∑<sub>n ≥ 0</sub> a<sub>n</sub> x<sup>n</sup>'' in the case <em>a<sub>0</sub> = 1</em> .</p>

<p>Stanley <a class="footnoteRef" href="#fn6" id="fnref6"><sup>6</sup></a> gives a version for exponential power series. In the <a href="formal_power_series" title="wikilink">formal power series</a></p>

<p>

<math display="block" id="Faà_di_Bruno's_formula:27">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>f</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>x</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <munder>
      <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
      <mi>n</mi>
     </munder>
     <mrow>
      <mfrac>
       <msub>
        <mi>a</mi>
        <mi>n</mi>
       </msub>
       <mrow>
        <mi>n</mi>
        <mo lspace="0pt" rspace="3.5pt">!</mo>
       </mrow>
      </mfrac>
      <msup>
       <mi>x</mi>
       <mi>n</mi>
      </msup>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>f</ci>
     <ci>x</ci>
    </apply>
    <apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <sum></sum>
      <ci>n</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>a</ci>
        <ci>n</ci>
       </apply>
       <apply>
        <factorial></factorial>
        <ci>n</ci>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>x</ci>
       <ci>n</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f(x)=\sum_{n}{a_{n}\over n!}x^{n},
  </annotation>
 </semantics>
</math>

</p>

<p>we have the <em>n</em>th derivative at 0:</p>

<p>

<math display="block" id="Faà_di_Bruno's_formula:28">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <msup>
      <mi>f</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>n</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </msup>
     <mrow>
      <mo stretchy="false">(</mo>
      <mn>0</mn>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <msub>
     <mi>a</mi>
     <mi>n</mi>
    </msub>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>f</ci>
      <ci>n</ci>
     </apply>
     <cn type="integer">0</cn>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>a</ci>
     <ci>n</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f^{(n)}(0)=a_{n}.\;
  </annotation>
 </semantics>
</math>

</p>

<p>This should not be construed as the value of a function, since these series are purely formal; there is no such thing as convergence or divergence in this context.</p>

<p>If</p>

<p>

<math display="block" id="Faà_di_Bruno's_formula:29">
 <semantics>
  <mrow>
   <mrow>
    <mi>g</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>x</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <munderover>
     <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
     <mrow>
      <mi>n</mi>
      <mo>=</mo>
      <mn>0</mn>
     </mrow>
     <mi mathvariant="normal">∞</mi>
    </munderover>
    <mrow>
     <mfrac>
      <msub>
       <mi>b</mi>
       <mi>n</mi>
      </msub>
      <mrow>
       <mi>n</mi>
       <mo lspace="0pt" rspace="3.5pt">!</mo>
      </mrow>
     </mfrac>
     <msup>
      <mi>x</mi>
      <mi>n</mi>
     </msup>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>g</ci>
     <ci>x</ci>
    </apply>
    <apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <apply>
        <eq></eq>
        <ci>n</ci>
        <cn type="integer">0</cn>
       </apply>
      </apply>
      <infinity></infinity>
     </apply>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>b</ci>
        <ci>n</ci>
       </apply>
       <apply>
        <factorial></factorial>
        <ci>n</ci>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>x</ci>
       <ci>n</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   g(x)=\sum_{n=0}^{\infty}{b_{n}\over n!}x^{n}
  </annotation>
 </semantics>
</math>

</p>

<p>and</p>

<p>

<math display="block" id="Faà_di_Bruno's_formula:30">
 <semantics>
  <mrow>
   <mrow>
    <mi>f</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>x</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <munderover>
     <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
     <mrow>
      <mi>n</mi>
      <mo>=</mo>
      <mn>1</mn>
     </mrow>
     <mi mathvariant="normal">∞</mi>
    </munderover>
    <mrow>
     <mfrac>
      <msub>
       <mi>a</mi>
       <mi>n</mi>
      </msub>
      <mrow>
       <mi>n</mi>
       <mo lspace="0pt" rspace="3.5pt">!</mo>
      </mrow>
     </mfrac>
     <msup>
      <mi>x</mi>
      <mi>n</mi>
     </msup>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>f</ci>
     <ci>x</ci>
    </apply>
    <apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <apply>
        <eq></eq>
        <ci>n</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <infinity></infinity>
     </apply>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>a</ci>
        <ci>n</ci>
       </apply>
       <apply>
        <factorial></factorial>
        <ci>n</ci>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>x</ci>
       <ci>n</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f(x)=\sum_{n=1}^{\infty}{a_{n}\over n!}x^{n}
  </annotation>
 </semantics>
</math>

</p>

<p>and</p>

<p>

<math display="block" id="Faà_di_Bruno's_formula:31">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>g</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mi>f</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>x</mi>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mi>h</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>x</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <munderover>
      <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
      <mrow>
       <mi>n</mi>
       <mo>=</mo>
       <mn>0</mn>
      </mrow>
      <mi mathvariant="normal">∞</mi>
     </munderover>
     <mrow>
      <mfrac>
       <msub>
        <mi>c</mi>
        <mi>n</mi>
       </msub>
       <mrow>
        <mi>n</mi>
        <mo lspace="0pt" rspace="3.5pt">!</mo>
       </mrow>
      </mfrac>
      <msup>
       <mi>x</mi>
       <mi>n</mi>
      </msup>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <times></times>
      <ci>g</ci>
      <apply>
       <times></times>
       <ci>f</ci>
       <ci>x</ci>
      </apply>
     </apply>
     <apply>
      <times></times>
      <ci>h</ci>
      <ci>x</ci>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <apply>
         <eq></eq>
         <ci>n</ci>
         <cn type="integer">0</cn>
        </apply>
       </apply>
       <infinity></infinity>
      </apply>
      <apply>
       <times></times>
       <apply>
        <divide></divide>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>c</ci>
         <ci>n</ci>
        </apply>
        <apply>
         <factorial></factorial>
         <ci>n</ci>
        </apply>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>x</ci>
        <ci>n</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   g(f(x))=h(x)=\sum_{n=0}^{\infty}{c_{n}\over n!}x^{n},
  </annotation>
 </semantics>
</math>

</p>

<p>then the coefficient <em>c</em><sub><em>n</em></sub> (which would be the <em>n</em>th derivative of <em>h</em> evaluated at 0 if we were dealing with convergent series rather than formal power series) is given by</p>

<p>

<math display="block" id="Faà_di_Bruno's_formula:32">
 <semantics>
  <mrow>
   <msub>
    <mi>c</mi>
    <mi>n</mi>
   </msub>
   <mo>=</mo>
   <mrow>
    <munder>
     <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
     <mrow>
      <mi>π</mi>
      <mo>=</mo>
      <mrow>
       <mo rspace="4.2pt">{</mo>
       <msub>
        <mi>B</mi>
        <mn>1</mn>
       </msub>
       <mo rspace="4.2pt">,</mo>
       <mi mathvariant="normal">…</mi>
       <mo rspace="4.2pt">,</mo>
       <mpadded width="+1.7pt">
        <msub>
         <mi>B</mi>
         <mi>k</mi>
        </msub>
       </mpadded>
       <mo>}</mo>
      </mrow>
     </mrow>
    </munder>
    <mrow>
     <msub>
      <mi>a</mi>
      <mrow>
       <mo>|</mo>
       <msub>
        <mi>B</mi>
        <mn>1</mn>
       </msub>
       <mo>|</mo>
      </mrow>
     </msub>
     <mi mathvariant="normal">⋯</mi>
     <msub>
      <mi>a</mi>
      <mrow>
       <mo>|</mo>
       <msub>
        <mi>B</mi>
        <mi>k</mi>
       </msub>
       <mo>|</mo>
      </mrow>
     </msub>
     <msub>
      <mi>b</mi>
      <mi>k</mi>
     </msub>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>c</ci>
     <ci>n</ci>
    </apply>
    <apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <sum></sum>
      <apply>
       <eq></eq>
       <ci>π</ci>
       <set>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>B</ci>
         <cn type="integer">1</cn>
        </apply>
        <ci>normal-…</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>B</ci>
         <ci>k</ci>
        </apply>
       </set>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>a</ci>
       <apply>
        <abs></abs>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>B</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
      </apply>
      <ci>normal-⋯</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>a</ci>
       <apply>
        <abs></abs>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>B</ci>
         <ci>k</ci>
        </apply>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>b</ci>
       <ci>k</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   c_{n}=\sum_{\pi=\left\{\,B_{1},\,\dots,\,B_{k}\,\right\}}a_{\left|B_{1}\right|%
}\cdots a_{\left|B_{k}\right|}b_{k}
  </annotation>
 </semantics>
</math>

</p>

<p>where π runs through the set of all partitions of the set { 1, ..., <em>n</em> } and <em>B</em><sub>1</sub>, ..., <em>B</em><sub><em>k</em></sub> are the blocks of the partition π, and | <em>B</em><sub><em>j</em></sub> | is the number of members of the <em>j</em>th block, for <em>j</em> = 1, ..., <em>k</em>.</p>

<p>This version of the formula is particularly well suited to the purposes of <a class="uri" href="combinatorics" title="wikilink">combinatorics</a>.</p>

<p>We can also write with respect to the notation above</p>

<p>

<math display="block" id="Faà_di_Bruno's_formula:33">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>g</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mi>f</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>x</mi>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <msub>
      <mi>b</mi>
      <mn>0</mn>
     </msub>
     <mo>+</mo>
     <mrow>
      <munderover>
       <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
       <mrow>
        <mi>n</mi>
        <mo>=</mo>
        <mn>1</mn>
       </mrow>
       <mi mathvariant="normal">∞</mi>
      </munderover>
      <mrow>
       <mfrac>
        <mrow>
         <munderover>
          <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
          <mrow>
           <mi>k</mi>
           <mo>=</mo>
           <mn>1</mn>
          </mrow>
          <mi>n</mi>
         </munderover>
         <mrow>
          <msub>
           <mi>b</mi>
           <mi>k</mi>
          </msub>
          <msub>
           <mi>B</mi>
           <mrow>
            <mi>n</mi>
            <mo>,</mo>
            <mi>k</mi>
           </mrow>
          </msub>
          <mrow>
           <mo stretchy="false">(</mo>
           <msub>
            <mi>a</mi>
            <mn>1</mn>
           </msub>
           <mo>,</mo>
           <mi mathvariant="normal">…</mi>
           <mo>,</mo>
           <msub>
            <mi>a</mi>
            <mrow>
             <mrow>
              <mi>n</mi>
              <mo>-</mo>
              <mi>k</mi>
             </mrow>
             <mo>+</mo>
             <mn>1</mn>
            </mrow>
           </msub>
           <mo stretchy="false">)</mo>
          </mrow>
         </mrow>
        </mrow>
        <mrow>
         <mi>n</mi>
         <mo lspace="0pt" rspace="3.5pt">!</mo>
        </mrow>
       </mfrac>
       <msup>
        <mi>x</mi>
        <mi>n</mi>
       </msup>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>g</ci>
     <apply>
      <times></times>
      <ci>f</ci>
      <ci>x</ci>
     </apply>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>b</ci>
      <cn type="integer">0</cn>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <apply>
         <eq></eq>
         <ci>n</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <infinity></infinity>
      </apply>
      <apply>
       <times></times>
       <apply>
        <divide></divide>
        <apply>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <sum></sum>
           <apply>
            <eq></eq>
            <ci>k</ci>
            <cn type="integer">1</cn>
           </apply>
          </apply>
          <ci>n</ci>
         </apply>
         <apply>
          <times></times>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>b</ci>
           <ci>k</ci>
          </apply>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>B</ci>
           <list>
            <ci>n</ci>
            <ci>k</ci>
           </list>
          </apply>
          <vector>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <ci>a</ci>
            <cn type="integer">1</cn>
           </apply>
           <ci>normal-…</ci>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <ci>a</ci>
            <apply>
             <plus></plus>
             <apply>
              <minus></minus>
              <ci>n</ci>
              <ci>k</ci>
             </apply>
             <cn type="integer">1</cn>
            </apply>
           </apply>
          </vector>
         </apply>
        </apply>
        <apply>
         <factorial></factorial>
         <ci>n</ci>
        </apply>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>x</ci>
        <ci>n</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   g(f(x))=b_{0}+\sum_{n=1}^{\infty}{\sum_{k=1}^{n}b_{k}B_{n,k}(a_{1},\dots,a_{n-%
k+1})\over n!}x^{n},
  </annotation>
 </semantics>
</math>

</p>

<p>where <em>B</em><sub><em>n</em>,<em>k</em></sub>(<em>a</em><sub>1</sub>,...,<em>a</em><sub><em>n</em>−<em>k</em>+1</sub>) are <a href="Bell_polynomials" title="wikilink">Bell polynomials</a>.</p>
<h3 id="a-special-case">A special case</h3>

<p>If <em>f</em>(<em>x</em>) = e<sup><em>x</em></sup> then all of the derivatives of <em>f</em> are the same, and are a factor common to every term. In case <em>g</em>(<em>x</em>) is a <a href="cumulant-generating_function" title="wikilink">cumulant-generating function</a>, then <em>f</em>(<em>g</em>(<em>x</em>)) is a <a href="moment-generating_function" title="wikilink">moment-generating function</a>, and the polynomial in various derivatives of <em>g</em> is the polynomial that expresses the <a href="moment_(mathematics)" title="wikilink">moments</a> as functions of the <a href="cumulant" title="wikilink">cumulants</a>.</p>
<h2 id="notes">Notes</h2>
<h2 id="references">References</h2>
<ul>
<li>

<p>, Entirely freely available from <a href="Google_books" title="wikilink">Google books</a>.</p></li>
<li>

<p>.</p></li>
<li>

<p>. Entirely freely available from <a href="Google_books" title="wikilink">Google books</a>. A well-known paper where Francesco Faà di Bruno presents the two versions of the formula that now bears his name, published in the journal founded by <a href="Barnaba_Tortolini" title="wikilink">Barnaba Tortolini</a>.</p></li>
<li>

<p>. Entirely freely available from <a href="Google_books" title="wikilink">Google books</a>.</p></li>
<li>

<p>. Entirely freely available from <a href="Google_books" title="wikilink">Google books</a>.</p></li>
<li></li>
<li>

<p>.</p></li>
<li></li>
<li>

<p>.</p></li>
<li>

<p>, available at <a href="http://www.numdam.org">NUMDAM</a>. This paper, according to  is one of the precursors of : note that the author signs only as "T.A.", and the attribution to J. F. C. Tiburce Abadie is due again to Johnson.</p></li>
<li>

<p>, available at <a href="http://www.numdam.org">NUMDAM</a>. This paper, according to  is one of the precursors of : note that the author signs only as "A.", and the attribution to J. F. C. Tiburce Abadie is due again to Johnson.</p></li>
</ul>
<h2 id="external-links">External links</h2>
<ul>
<li></li>
<li><a href="http://dida.sns.it/dida2/cl/10-11/folde0/pdf20">An intuitive presentation of Faà di Bruno's formula, with examples</a></li>
</ul>

<p>"</p>

<p><a href="Category:Differentiation_rules" title="wikilink">Category:Differentiation rules</a> <a href="Category:Differential_calculus" title="wikilink">Category:Differential calculus</a> <a href="Category:Differential_algebra" title="wikilink">Category:Differential algebra</a> <a href="Category:Enumerative_combinatorics" title="wikilink">Category:Enumerative combinatorics</a> <a href="Category:Factorial_and_binomial_topics" title="wikilink">Category:Factorial and binomial topics</a> <a href="Category:Theorems_in_analysis" title="wikilink">Category:Theorems in analysis</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1"><a href="#fnref1">↩</a></li>
<li id="fn2"><a href="#fnref2">↩</a></li>
<li id="fn3"><a href="#fnref3">↩</a></li>
<li id="fn4"><a href="#fnref4">↩</a></li>
<li id="fn5"><a href="#fnref5">↩</a></li>
<li id="fn6">See the "compositional formula" in Chapter 5 of <a href="#fnref6">↩</a></li>
</ol>
</section>
</body>
</html>

<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="258">Ring signature</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Ring signature</h1>
<style>
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
<style>
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
  </style>
</body></html>
<body>
<hr/>

<p>In <a class="uri" href="cryptography" title="wikilink">cryptography</a>, a <strong>ring signature</strong> is a type of <a href="digital_signature" title="wikilink">digital signature</a> that can be performed by any member of a group of users that each have <a href="key_(cryptography)" title="wikilink">keys</a>. Therefore, a message signed with a ring signature is endorsed by someone in a particular group of people. One of the security properties of a ring signature is that it should be computationally infeasible to determine <em>which</em> of the group members' keys was used to produce the signature. Ring signatures are similar to <a href="group_signature" title="wikilink">group signatures</a> but differ in two key ways: first, there is no way to revoke the anonymity of an individual signature, and second, any group of users can be used as a group without additional setup. Ring signatures were invented by <a href="Ron_Rivest" title="wikilink">Ron Rivest</a>, <a href="Adi_Shamir" title="wikilink">Adi Shamir</a>, and <a href="Yael_Tauman" title="wikilink">Yael Tauman</a>, and introduced at <a class="uri" href="ASIACRYPT" title="wikilink">ASIACRYPT</a> in 2001.<a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a> The name "ring signature" comes from the ring-like structure of the signature <a class="uri" href="algorithm" title="wikilink">algorithm</a>.</p>
<h2 id="definition">Definition</h2>

<p>Suppose that a group of entities each have public/private key pairs, (<em>PK</em><sub>1</sub>, <em>SK</em><sub>1</sub>), (<em>PK</em><sub>2</sub>, <em>SK</em><sub>2</sub>), ... ,(<em>PK</em><sub><em>n</em></sub>, <em>SK</em><sub><em>n</em></sub>). Party <em>i</em> can compute a ring signature σ on a message <em>m</em>, on input (<em>m</em>, <em>SK</em><sub><em>i</em></sub>, <em>PK</em><sub>1</sub>, ... , <em>PK</em><sub><em>n</em></sub>). Anyone can check the validity of a ring signature given σ, <em>m</em>, and the public keys involved, <em>PK</em><sub>1</sub>, ... , <em>PK</em><sub><em>n</em></sub>. If a ring signature is properly computed, it should pass the check. On the other hand, it should be hard for anyone to create a valid ring signature on any message for any group without knowing any of the secret keys for that group.<a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a></p>
<h2 id="applications-and-modifications">Applications and modifications</h2>

<p>In the original paper, Rivest, Shamir, and Tauman described ring signatures as a way to leak a secret. For instance, a ring signature could be used to provide an anonymous signature from "a high-ranking <a href="White_House" title="wikilink">White House</a> official", without revealing which official signed the message. Ring signatures are right for this application because the anonymity of a ring signature cannot be revoked, and because the group for a ring signature can be improvised.</p>

<p>Another application, also described in the original paper, is for <a href="deniable_signature" title="wikilink">deniable signatures</a>. A ring signature where the group is the sender and the recipient of a message will only seem to be a signature of the sender to the recipient: anyone else will be unsure whether the recipient or the sender was the actual signer. Thus, such a signature is convincing, but cannot be transferred beyond its intended recipient.</p>

<p>There were various works, introducing new features and based on different assumptions:</p>
<ul>
<li>Threshold ring signatures.<a class="footnoteRef" href="#fn3" id="fnref3"><sup>3</sup></a> Unlike standard "<em>t</em>-out-of-<em>n</em>" <a href="Threshold_cryptosystem" title="wikilink">threshold signature</a>, where <em>t</em> of <em>n</em> users should collaborate to decrypt a message, this variant of a ring signature requires <em>t</em> users to cooperate in the signing <a href="Cryptographic_protocol" title="wikilink">protocol</a>. Namely, parties (<em>l</em><sub>1</sub>,<em>l</em><sub>2</sub>, ... , <em>l</em><sub><em>t</em></sub>) can compute a (<em>t</em>,<em>n</em>)-ring signature σ on a message <em>m</em>, on input (<em>m</em>, <em>SK</em><sub><em>l</em><sub>1</sub></sub>,<em>SK</em><sub><em>l</em><sub>2</sub></sub>, ... , <em>SK</em><sub><em>l</em><sub><em>t</em></sub></sub>, <em>PK</em><sub>1</sub>, ... , <em>PK</em><sub><em>n</em></sub>).</li>
<li>Linkable ring signatures.<a class="footnoteRef" href="#fn4" id="fnref4"><sup>4</sup></a> The property of linkability allows to determine whether any two signatures have been produced by the same member (under the same private key). The identity of the signer is nevertheless preserved. One of the possible applications can be an offline <a href="E-cash" title="wikilink">e-cash system</a>.</li>
<li>Traceable ring signature.<a class="footnoteRef" href="#fn5" id="fnref5"><sup>5</sup></a> In addition to the previous scheme the public key of the signer is revealed (if he issued more than one signatures under the same private key). An <a href="E-voting" title="wikilink">e-voting system</a> can be implemented using this protocol.</li>
</ul>
<h2 id="efficiency">Efficiency</h2>

<p>Most of the proposed algorithms have <a href="Big_O_notation" title="wikilink">asymptotic</a> output size 

<math display="inline" id="Ring_signature:0">
 <semantics>
  <mrow>
   <mi>O</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>n</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>O</ci>
    <ci>n</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   O(n)
  </annotation>
 </semantics>
</math>

, i.e. the size of the resulting signature increases linearly with the size of input (amount of public keys). That means that such schemes are impracticable for real use cases with sufficiently large 

<math display="inline" id="Ring_signature:1">
 <semantics>
  <mi>n</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>n</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n
  </annotation>
 </semantics>
</math>

 (for example, an e-voting with millions of participants). But for some application with relatively small <a class="uri" href="median" title="wikilink">median</a> input size such estimate may be acceptable. <a class="uri" href="CryptoNote" title="wikilink">CryptoNote</a> implements 

<math display="inline" id="Ring_signature:2">
 <semantics>
  <mrow>
   <mi>O</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>n</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>O</ci>
    <ci>n</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   O(n)
  </annotation>
 </semantics>
</math>

 ring signature scheme by Fujisaki and Suzuki<a class="footnoteRef" href="#fn6" id="fnref6"><sup>6</sup></a> in p2p payments to achieve sender's untraceability.</p>

<p>More efficient algorithms have appeared recently. There are schemes with the sublinear size of the signature,<a class="footnoteRef" href="#fn7" id="fnref7"><sup>7</sup></a> as well as with constant size.<a class="footnoteRef" href="#fn8" id="fnref8"><sup>8</sup></a></p>
<h2 id="implementation">Implementation</h2>

<p>Here is a <a href="Python_(language)" title="wikilink">Python</a> implementation of the original paper using <a href="Rivest_Shamir_Adleman" title="wikilink">RSA</a>.</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="im">import</span> os, hashlib, random, Crypto.PublicKey.RSA

<span class="kw">class</span> ring:
    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, k, L<span class="op">=</span><span class="dv">1024</span>):
        <span class="va">self</span>.k <span class="op">=</span> k
        <span class="va">self</span>.l <span class="op">=</span> L
        <span class="va">self</span>.n <span class="op">=</span> <span class="bu">len</span>(k)
        <span class="va">self</span>.q <span class="op">=</span> <span class="dv">1</span> <span class="op">&lt;&lt;</span> (L <span class="op">-</span> <span class="dv">1</span>)

    <span class="kw">def</span> sign(<span class="va">self</span>, m, z):
        <span class="va">self</span>.permut(m)
        s <span class="op">=</span> [<span class="va">None</span>] <span class="op">*</span> <span class="va">self</span>.n
        u <span class="op">=</span> random.randint(<span class="dv">0</span>, <span class="va">self</span>.q)
        c <span class="op">=</span> v <span class="op">=</span> <span class="va">self</span>.E(u) 
        <span class="cf">for</span> i <span class="op">in</span> (<span class="bu">range</span>(z<span class="dv">+1</span>, <span class="va">self</span>.n) <span class="op">+</span> <span class="bu">range</span>(z)):
            s[i] <span class="op">=</span> random.randint(<span class="dv">0</span>, <span class="va">self</span>.q)
            e <span class="op">=</span> <span class="va">self</span>.g(s[i], <span class="va">self</span>.k[i].e, <span class="va">self</span>.k[i].n)
            v <span class="op">=</span> <span class="va">self</span>.E(v<span class="op">^</span>e) 
            <span class="cf">if</span> (i<span class="dv">+1</span>) <span class="op">%</span> <span class="va">self</span>.n <span class="op">==</span> <span class="dv">0</span>:
                c <span class="op">=</span> v
        s[z] <span class="op">=</span> <span class="va">self</span>.g(v<span class="op">^</span>u, <span class="va">self</span>.k[z].d, <span class="va">self</span>.k[z].n)
        <span class="cf">return</span> [c] <span class="op">+</span> s

    <span class="kw">def</span> verify(<span class="va">self</span>, m, X):
        <span class="va">self</span>.permut(m)
        <span class="kw">def</span> _f(i):
            <span class="cf">return</span> <span class="va">self</span>.g(X[i<span class="dv">+1</span>], <span class="va">self</span>.k[i].e, <span class="va">self</span>.k[i].n)
        y <span class="op">=</span> <span class="bu">map</span>(_f, <span class="bu">range</span>(<span class="bu">len</span>(X)<span class="op">-</span><span class="dv">1</span>))
        <span class="kw">def</span> _g(x, i):
            <span class="cf">return</span> <span class="va">self</span>.E(x<span class="op">^</span>y[i])
        r <span class="op">=</span> <span class="bu">reduce</span>(_g, <span class="bu">range</span>(<span class="va">self</span>.n), X[<span class="dv">0</span>])
        <span class="cf">return</span> r <span class="op">==</span> X[<span class="dv">0</span>]

    <span class="kw">def</span> permut(<span class="va">self</span>, m):
        <span class="va">self</span>.p <span class="op">=</span> <span class="bu">int</span>(hashlib.sha1(<span class="st">'</span><span class="sc">%s</span><span class="st">'</span> <span class="op">%</span> m).hexdigest(),<span class="dv">16</span>)

    <span class="kw">def</span> E(<span class="va">self</span>, x): 
        msg <span class="op">=</span> <span class="st">'</span><span class="sc">%s%s</span><span class="st">'</span> <span class="op">%</span> (x, <span class="va">self</span>.p)
        <span class="cf">return</span> <span class="bu">int</span>(hashlib.sha1(msg).hexdigest(), <span class="dv">16</span>)

    <span class="kw">def</span> g(<span class="va">self</span>, x, e, n):
        q, r <span class="op">=</span> <span class="bu">divmod</span>(x, n)
        <span class="cf">if</span> ((q <span class="op">+</span> <span class="dv">1</span>) <span class="op">*</span> n) <span class="op">&lt;=</span> ((<span class="dv">1</span> <span class="op">&lt;&lt;</span> <span class="va">self</span>.l) <span class="op">-</span> <span class="dv">1</span>):
            rslt <span class="op">=</span> q <span class="op">*</span> n <span class="op">+</span> <span class="bu">pow</span>(r, e, n)
        <span class="cf">else</span>:
            rslt <span class="op">=</span> x
        <span class="cf">return</span> rslt</code></pre></div>

<p>To sign and verify 2 messages in a ring of 4 users:</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python">size <span class="op">=</span> <span class="dv">4</span>
msg1, msg2 <span class="op">=</span> <span class="st">'hello'</span>, <span class="st">'world!'</span>

<span class="kw">def</span> _rn(_):
  <span class="cf">return</span> Crypto.PublicKey.RSA.generate(<span class="dv">1024</span>, os.urandom)

key <span class="op">=</span> <span class="bu">map</span>(_rn, <span class="bu">range</span>(size))
r <span class="op">=</span> ring(key)
<span class="cf">for</span> i <span class="op">in</span> <span class="bu">range</span>(size):
    s1 <span class="op">=</span> r.sign(msg1, i)
    s2 <span class="op">=</span> r.sign(msg2, i)
    <span class="cf">assert</span> r.verify(msg1, s1) <span class="op">and</span> r.verify(msg2, s2) <span class="op">and</span> <span class="op">not</span> r.verify(msg1, s2)</code></pre></div>
<h2 id="crypto-currencies">Crypto-currencies</h2>

<p>The <a class="uri" href="CryptoNote" title="wikilink">CryptoNote</a> technology uses ring signatures.<a class="footnoteRef" href="#fn9" id="fnref9"><sup>9</sup></a> It was first implemented by Bytecoin (BCN) in July 2012.<a class="footnoteRef" href="#fn10" id="fnref10"><sup>10</sup></a></p>
<h2 id="references">References</h2>
<references>
</references>

<p>"</p>

<p><a href="Category:Public-key_cryptography" title="wikilink">Category:Public-key cryptography</a> <a href="Category:Digital_signature_schemes" title="wikilink">Category:Digital signature schemes</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1"><a href="http://www.springerlink.com/content/kxkndv9rgk8lu3h9/"><em>How to leak a secret</em></a>, <a href="Ron_Rivest" title="wikilink">Ron Rivest</a>, <a href="Adi_Shamir" title="wikilink">Adi Shamir</a>, and <a href="Yael_Tauman" title="wikilink">Yael Tauman</a>, ASIACRYPT 2001.<a href="#fnref1">↩</a></li>
<li id="fn2"><a href="#fnref2">↩</a></li>
<li id="fn3"><a href="#fnref3">↩</a></li>
<li id="fn4"><a href="#fnref4">↩</a></li>
<li id="fn5"><a href="#fnref5">↩</a></li>
<li id="fn6"></li>
<li id="fn7"><a href="#fnref7">↩</a></li>
<li id="fn8"><a href="#fnref8">↩</a></li>
<li id="fn9"><a href="https://cryptonote.org/inside#untraceable-payments">CryptoNote Technology - Untraceable payments</a><a href="#fnref9">↩</a></li>
<li id="fn10"><a href="http://bravenewcoin.com/profiles/coins/bytecoin/">Bytecoin profile</a> Bravenewcoin.com<a href="#fnref10">↩</a></li>
</ol>
</section>
</body>


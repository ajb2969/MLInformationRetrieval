<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="265">Shanks' square forms factorization</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Shanks' square forms factorization</h1>
<hr/>

<p><strong>Shanks's square forms factorization</strong> is a method for <a href="integer_factorization" title="wikilink">integer factorization</a> devised by <a href="Daniel_Shanks" title="wikilink">Daniel Shanks</a> as an improvement on <a href="Fermat's_factorization_method" title="wikilink">Fermat's factorization method</a>.</p>

<p>The success of Fermat's method depends on finding integers 

<math display="inline" id="Shanks'_square_forms_factorization:0">
 <semantics>
  <mi>x</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>x</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Shanks'_square_forms_factorization:1">
 <semantics>
  <mi>y</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>y</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   y
  </annotation>
 </semantics>
</math>

 such that 

<math display="inline" id="Shanks'_square_forms_factorization:2">
 <semantics>
  <mrow>
   <mrow>
    <msup>
     <mi>x</mi>
     <mn>2</mn>
    </msup>
    <mo>-</mo>
    <msup>
     <mi>y</mi>
     <mn>2</mn>
    </msup>
   </mrow>
   <mo>=</mo>
   <mi>N</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <minus></minus>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>x</ci>
      <cn type="integer">2</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>y</ci>
      <cn type="integer">2</cn>
     </apply>
    </apply>
    <ci>N</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x^{2}-y^{2}=N
  </annotation>
 </semantics>
</math>

, where 

<math display="inline" id="Shanks'_square_forms_factorization:3">
 <semantics>
  <mi>N</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>N</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   N
  </annotation>
 </semantics>
</math>


 is the integer to be factored. An improvement (noticed by <a href="Maurice_Kraitchik" title="wikilink">Kraitchik</a>) is to look for integers 

<math display="inline" id="Shanks'_square_forms_factorization:4">
 <semantics>
  <mi>x</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>x</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Shanks'_square_forms_factorization:5">
 <semantics>
  <mi>y</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>y</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   y
  </annotation>
 </semantics>
</math>

 such that 

<math display="inline" id="Shanks'_square_forms_factorization:6">
 <semantics>
  <mrow>
   <msup>
    <mi>x</mi>
    <mn>2</mn>
   </msup>
   <mo>≡</mo>
   <mrow>
    <msup>
     <mi>y</mi>
     <mn>2</mn>
    </msup>
    <mspace width="veryverythickmathspace">
    </mspace>
    <mrow>
     <mo lspace="8.1pt" stretchy="false">(</mo>
     <mrow>
      <mo>mod</mo>
      <mi>N</mi>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <equivalent></equivalent>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>x</ci>
     <cn type="integer">2</cn>
    </apply>
    <apply>
     <csymbol cd="latexml">annotated</csymbol>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>y</ci>
      <cn type="integer">2</cn>
     </apply>
     <apply>
      <ci>pmod</ci>
      <ci>N</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x^{2}\equiv y^{2}\;\;(\mathop{{\rm mod}}N)
  </annotation>
 </semantics>
</math>

. Finding a suitable pair 

<math display="inline" id="Shanks'_square_forms_factorization:7">
 <semantics>
  <mrow>
   <mo stretchy="false">(</mo>
   <mi>x</mi>
   <mo>,</mo>
   <mi>y</mi>
   <mo stretchy="false">)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <interval closure="open">
    <ci>x</ci>
    <ci>y</ci>
   </interval>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (x,y)
  </annotation>
 </semantics>
</math>

 does not guarantee a factorization of 

<math display="inline" id="Shanks'_square_forms_factorization:8">
 <semantics>
  <mi>N</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>N</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   N
  </annotation>
 </semantics>
</math>


, but it implies that 

<math display="inline" id="Shanks'_square_forms_factorization:9">
 <semantics>
  <mi>N</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>N</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   N
  </annotation>
 </semantics>
</math>

 is a factor of 

<math display="inline" id="Shanks'_square_forms_factorization:10">
 <semantics>
  <mrow>
   <mrow>
    <msup>
     <mi>x</mi>
     <mn>2</mn>
    </msup>
    <mo>-</mo>
    <msup>
     <mi>y</mi>
     <mn>2</mn>
    </msup>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>x</mi>
      <mo>-</mo>
      <mi>y</mi>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>x</mi>
      <mo>+</mo>
      <mi>y</mi>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <minus></minus>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>x</ci>
      <cn type="integer">2</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>y</ci>
      <cn type="integer">2</cn>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <minus></minus>
      <ci>x</ci>
      <ci>y</ci>
     </apply>
     <apply>
      <plus></plus>
      <ci>x</ci>
      <ci>y</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x^{2}-y^{2}=(x-y)(x+y)
  </annotation>
 </semantics>
</math>

, and there is a good chance that the <a href="prime_divisor" title="wikilink">prime divisors</a> of 

<math display="inline" id="Shanks'_square_forms_factorization:11">
 <semantics>
  <mi>N</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>N</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   N
  </annotation>
 </semantics>
</math>

 are distributed between these two factors, so that calculation of the <a href="greatest_common_divisor" title="wikilink">greatest common divisor</a> of 

<math display="inline" id="Shanks'_square_forms_factorization:12">
 <semantics>
  <mi>N</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>N</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   N
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Shanks'_square_forms_factorization:13">
 <semantics>
  <mrow>
   <mi>x</mi>
   <mo>-</mo>
   <mi>y</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <minus></minus>
    <ci>x</ci>
    <ci>y</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x-y
  </annotation>
 </semantics>
</math>


 will give a non-trivial factor of 

<math display="inline" id="Shanks'_square_forms_factorization:14">
 <semantics>
  <mi>N</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>N</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   N
  </annotation>
 </semantics>
</math>

.</p>

<p>A practical algorithm for finding pairs 

<math display="inline" id="Shanks'_square_forms_factorization:15">
 <semantics>
  <mrow>
   <mo stretchy="false">(</mo>
   <mi>x</mi>
   <mo>,</mo>
   <mi>y</mi>
   <mo stretchy="false">)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <interval closure="open">
    <ci>x</ci>
    <ci>y</ci>
   </interval>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (x,y)
  </annotation>
 </semantics>
</math>

 which satisfy 

<math display="inline" id="Shanks'_square_forms_factorization:16">
 <semantics>
  <mrow>
   <msup>
    <mi>x</mi>
    <mn>2</mn>
   </msup>
   <mo>≡</mo>
   <mrow>
    <msup>
     <mi>y</mi>
     <mn>2</mn>
    </msup>
    <mspace width="veryverythickmathspace">
    </mspace>
    <mrow>
     <mo lspace="8.1pt" stretchy="false">(</mo>
     <mrow>
      <mo>mod</mo>
      <mi>N</mi>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <equivalent></equivalent>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>x</ci>
     <cn type="integer">2</cn>
    </apply>
    <apply>
     <csymbol cd="latexml">annotated</csymbol>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>y</ci>
      <cn type="integer">2</cn>
     </apply>
     <apply>
      <ci>pmod</ci>
      <ci>N</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x^{2}\equiv y^{2}\;\;(\mathop{{\rm mod}}N)
  </annotation>
 </semantics>
</math>

 was developed by Shanks, who named it Square Forms Factorization or SQUFOF. The algorithm can be expressed in terms of continued fractions, or in terms of quadratic forms. Although there are now much more efficient factorization methods available, SQUFOF has the advantage that it is small enough to be implemented on a programmable calculator.</p>
<h2 id="algorithm">Algorithm</h2>

<p><strong>Input</strong>

<math display="block" id="Shanks'_square_forms_factorization:17">
 <semantics>
  <mi>N</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>N</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   N
  </annotation>
 </semantics>
</math>

, the integer to be factored, which must be neither a <a href="prime_number" title="wikilink">prime number</a> nor a <a href="Square_number" title="wikilink">perfect square</a>, and a small multiplier 

<math display="inline" id="Shanks'_square_forms_factorization:18">
 <semantics>
  <mi>k</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>k</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   k
  </annotation>
 </semantics>
</math>


.</p>

<p><strong>Output</strong>: a non-trivial factor of 

<math display="inline" id="Shanks'_square_forms_factorization:19">
 <semantics>
  <mi>N</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>N</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   N
  </annotation>
 </semantics>
</math>

.</p>

<p><strong>The algorithm:</strong></p>

<p>Initialize 

<math display="inline" id="Shanks'_square_forms_factorization:20">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <msub>
      <mi>P</mi>
      <mn>0</mn>
     </msub>
     <mo>=</mo>
     <mrow>
      <mo stretchy="false">⌊</mo>
      <msqrt>
       <mrow>
        <mi>k</mi>
        <mi>N</mi>
       </mrow>
      </msqrt>
      <mo stretchy="false">⌋</mo>
     </mrow>
    </mrow>
    <mo>,</mo>
    <mrow>
     <mrow>
      <msub>
       <mi>Q</mi>
       <mn>0</mn>
      </msub>
      <mo>=</mo>
      <mn>1</mn>
     </mrow>
     <mo>,</mo>
     <mrow>
      <msub>
       <mi>Q</mi>
       <mn>1</mn>
      </msub>
      <mo>=</mo>
      <mrow>
       <mrow>
        <mi>k</mi>
        <mi>N</mi>
       </mrow>
       <mo>-</mo>
       <msubsup>
        <mi>P</mi>
        <mn>0</mn>
        <mn>2</mn>
       </msubsup>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>P</ci>
      <cn type="integer">0</cn>
     </apply>
     <apply>
      <floor></floor>
      <apply>
       <root></root>
       <apply>
        <times></times>
        <ci>k</ci>
        <ci>N</ci>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <csymbol cd="ambiguous">formulae-sequence</csymbol>
     <apply>
      <eq></eq>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>Q</ci>
       <cn type="integer">0</cn>
      </apply>
      <cn type="integer">1</cn>
     </apply>
     <apply>
      <eq></eq>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>Q</ci>
       <cn type="integer">1</cn>
      </apply>
      <apply>
       <minus></minus>
       <apply>
        <times></times>
        <ci>k</ci>
        <ci>N</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>P</ci>
         <cn type="integer">0</cn>
        </apply>
        <cn type="integer">2</cn>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   P_{0}=\lfloor\sqrt{kN}\rfloor,Q_{0}=1,Q_{1}=kN-P_{0}^{2}.
  </annotation>
 </semantics>
</math>

</p>

<p>Repeat</p>

<p>

<math display="inline" id="Shanks'_square_forms_factorization:21">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>b</mi>
     <mi>i</mi>
    </msub>
    <mo>=</mo>
    <mrow>
     <mo>⌊</mo>
     <mfrac>
      <mrow>
       <mrow>
        <mo stretchy="false">⌊</mo>
        <msqrt>
         <mrow>
          <mi>k</mi>
          <mi>N</mi>
         </mrow>
        </msqrt>
        <mo stretchy="false">⌋</mo>
       </mrow>
       <mo>+</mo>
       <msub>
        <mi>P</mi>
        <mrow>
         <mi>i</mi>
         <mo>-</mo>
         <mn>1</mn>
        </mrow>
       </msub>
      </mrow>
      <msub>
       <mi>Q</mi>
       <mi>i</mi>
      </msub>
     </mfrac>
     <mo>⌋</mo>
    </mrow>
   </mrow>
   <mo>,</mo>
   <mrow>
    <mrow>
     <msub>
      <mi>P</mi>
      <mi>i</mi>
     </msub>
     <mo>=</mo>
     <mrow>
      <mrow>
       <msub>
        <mi>b</mi>
        <mi>i</mi>
       </msub>
       <msub>
        <mi>Q</mi>
        <mi>i</mi>
       </msub>
      </mrow>
      <mo>-</mo>
      <msub>
       <mi>P</mi>
       <mrow>
        <mi>i</mi>
        <mo>-</mo>
        <mn>1</mn>
       </mrow>
      </msub>
     </mrow>
    </mrow>
    <mo>,</mo>
    <mrow>
     <msub>
      <mi>Q</mi>
      <mrow>
       <mi>i</mi>
       <mo>+</mo>
       <mn>1</mn>
      </mrow>
     </msub>
     <mo>=</mo>
     <mrow>
      <msub>
       <mi>Q</mi>
       <mrow>
        <mi>i</mi>
        <mo>-</mo>
        <mn>1</mn>
       </mrow>
      </msub>
      <mo>+</mo>
      <mrow>
       <msub>
        <mi>b</mi>
        <mi>i</mi>
       </msub>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <msub>
          <mi>P</mi>
          <mrow>
           <mi>i</mi>
           <mo>-</mo>
           <mn>1</mn>
          </mrow>
         </msub>
         <mo>-</mo>
         <msub>
          <mi>P</mi>
          <mi>i</mi>
         </msub>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>b</ci>
      <ci>i</ci>
     </apply>
     <apply>
      <floor></floor>
      <apply>
       <divide></divide>
       <apply>
        <plus></plus>
        <apply>
         <floor></floor>
         <apply>
          <root></root>
          <apply>
           <times></times>
           <ci>k</ci>
           <ci>N</ci>
          </apply>
         </apply>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>P</ci>
         <apply>
          <minus></minus>
          <ci>i</ci>
          <cn type="integer">1</cn>
         </apply>
        </apply>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>Q</ci>
        <ci>i</ci>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <csymbol cd="ambiguous">formulae-sequence</csymbol>
     <apply>
      <eq></eq>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>P</ci>
       <ci>i</ci>
      </apply>
      <apply>
       <minus></minus>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>b</ci>
         <ci>i</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>Q</ci>
         <ci>i</ci>
        </apply>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>P</ci>
        <apply>
         <minus></minus>
         <ci>i</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <eq></eq>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>Q</ci>
       <apply>
        <plus></plus>
        <ci>i</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <apply>
       <plus></plus>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>Q</ci>
        <apply>
         <minus></minus>
         <ci>i</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>b</ci>
         <ci>i</ci>
        </apply>
        <apply>
         <minus></minus>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>P</ci>
          <apply>
           <minus></minus>
           <ci>i</ci>
           <cn type="integer">1</cn>
          </apply>
         </apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>P</ci>
          <ci>i</ci>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   b_{i}=\left\lfloor\frac{\lfloor\sqrt{kN}\rfloor+P_{i-1}}{Q_{i}}\right\rfloor,P%
_{i}=b_{i}Q_{i}-P_{i-1},Q_{i+1}=Q_{i-1}+b_{i}(P_{i-1}-P_{i})
  </annotation>
 </semantics>
</math>

</p>

<p>until 

<math display="inline" id="Shanks'_square_forms_factorization:22">
 <semantics>
  <msub>
   <mi>Q</mi>
   <mi>i</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>Q</ci>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Q_{i}
  </annotation>
 </semantics>
</math>

 is a perfect square at some even 

<math display="inline" id="Shanks'_square_forms_factorization:23">
 <semantics>
  <mi>i</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>i</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   i
  </annotation>
 </semantics>
</math>


.</p>

<p>Initialize 

<math display="inline" id="Shanks'_square_forms_factorization:24">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>b</mi>
     <mn>0</mn>
    </msub>
    <mo>=</mo>
    <mrow>
     <mo>⌊</mo>
     <mfrac>
      <mrow>
       <mrow>
        <mo stretchy="false">⌊</mo>
        <msqrt>
         <mrow>
          <mi>k</mi>
          <mi>N</mi>
         </mrow>
        </msqrt>
        <mo stretchy="false">⌋</mo>
       </mrow>
       <mo>-</mo>
       <msub>
        <mi>P</mi>
        <mrow>
         <mi>i</mi>
         <mo>-</mo>
         <mn>1</mn>
        </mrow>
       </msub>
      </mrow>
      <msqrt>
       <msub>
        <mi>Q</mi>
        <mi>i</mi>
       </msub>
      </msqrt>
     </mfrac>
     <mo>⌋</mo>
    </mrow>
   </mrow>
   <mo>,</mo>
   <mrow>
    <mrow>
     <msub>
      <mi>P</mi>
      <mn>0</mn>
     </msub>
     <mo>=</mo>
     <mrow>
      <mrow>
       <msub>
        <mi>b</mi>
        <mn>0</mn>
       </msub>
       <msqrt>
        <msub>
         <mi>Q</mi>
         <mi>i</mi>
        </msub>
       </msqrt>
      </mrow>
      <mo>+</mo>
      <msub>
       <mi>P</mi>
       <mrow>
        <mi>i</mi>
        <mo>-</mo>
        <mn>1</mn>
       </mrow>
      </msub>
     </mrow>
    </mrow>
    <mo>,</mo>
    <mrow>
     <mrow>
      <msub>
       <mi>Q</mi>
       <mn>0</mn>
      </msub>
      <mo>=</mo>
      <msqrt>
       <msub>
        <mi>Q</mi>
        <mi>i</mi>
       </msub>
      </msqrt>
     </mrow>
     <mo>,</mo>
     <mrow>
      <msub>
       <mi>Q</mi>
       <mn>1</mn>
      </msub>
      <mo>=</mo>
      <mfrac>
       <mrow>
        <mrow>
         <mi>k</mi>
         <mi>N</mi>
        </mrow>
        <mo>-</mo>
        <msubsup>
         <mi>P</mi>
         <mn>0</mn>
         <mn>2</mn>
        </msubsup>
       </mrow>
       <msub>
        <mi>Q</mi>
        <mn>0</mn>
       </msub>
      </mfrac>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>b</ci>
      <cn type="integer">0</cn>
     </apply>
     <apply>
      <floor></floor>
      <apply>
       <divide></divide>
       <apply>
        <minus></minus>
        <apply>
         <floor></floor>
         <apply>
          <root></root>
          <apply>
           <times></times>
           <ci>k</ci>
           <ci>N</ci>
          </apply>
         </apply>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>P</ci>
         <apply>
          <minus></minus>
          <ci>i</ci>
          <cn type="integer">1</cn>
         </apply>
        </apply>
       </apply>
       <apply>
        <root></root>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>Q</ci>
         <ci>i</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <csymbol cd="ambiguous">formulae-sequence</csymbol>
     <apply>
      <eq></eq>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>P</ci>
       <cn type="integer">0</cn>
      </apply>
      <apply>
       <plus></plus>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>b</ci>
         <cn type="integer">0</cn>
        </apply>
        <apply>
         <root></root>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>Q</ci>
          <ci>i</ci>
         </apply>
        </apply>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>P</ci>
        <apply>
         <minus></minus>
         <ci>i</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">formulae-sequence</csymbol>
      <apply>
       <eq></eq>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>Q</ci>
        <cn type="integer">0</cn>
       </apply>
       <apply>
        <root></root>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>Q</ci>
         <ci>i</ci>
        </apply>
       </apply>
      </apply>
      <apply>
       <eq></eq>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>Q</ci>
        <cn type="integer">1</cn>
       </apply>
       <apply>
        <divide></divide>
        <apply>
         <minus></minus>
         <apply>
          <times></times>
          <ci>k</ci>
          <ci>N</ci>
         </apply>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>P</ci>
           <cn type="integer">0</cn>
          </apply>
          <cn type="integer">2</cn>
         </apply>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>Q</ci>
         <cn type="integer">0</cn>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   b_{0}=\left\lfloor\frac{\lfloor\sqrt{kN}\rfloor-P_{i-1}}{\sqrt{Q_{i}}}\right%
\rfloor,P_{0}=b_{0}\sqrt{Q_{i}}+P_{i-1},Q_{0}=\sqrt{Q_{i}},Q_{1}=\frac{kN-P_{0%
}^{2}}{Q_{0}}
  </annotation>
 </semantics>
</math>

</p>

<p>Repeat</p>

<p>

<math display="inline" id="Shanks'_square_forms_factorization:25">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>b</mi>
     <mi>i</mi>
    </msub>
    <mo>=</mo>
    <mrow>
     <mo>⌊</mo>
     <mfrac>
      <mrow>
       <mrow>
        <mo stretchy="false">⌊</mo>
        <msqrt>
         <mrow>
          <mi>k</mi>
          <mi>N</mi>
         </mrow>
        </msqrt>
        <mo stretchy="false">⌋</mo>
       </mrow>
       <mo>+</mo>
       <msub>
        <mi>P</mi>
        <mrow>
         <mi>i</mi>
         <mo>-</mo>
         <mn>1</mn>
        </mrow>
       </msub>
      </mrow>
      <msub>
       <mi>Q</mi>
       <mi>i</mi>
      </msub>
     </mfrac>
     <mo>⌋</mo>
    </mrow>
   </mrow>
   <mo>,</mo>
   <mrow>
    <mrow>
     <msub>
      <mi>P</mi>
      <mi>i</mi>
     </msub>
     <mo>=</mo>
     <mrow>
      <mrow>
       <msub>
        <mi>b</mi>
        <mi>i</mi>
       </msub>
       <msub>
        <mi>Q</mi>
        <mi>i</mi>
       </msub>
      </mrow>
      <mo>-</mo>
      <msub>
       <mi>P</mi>
       <mrow>
        <mi>i</mi>
        <mo>-</mo>
        <mn>1</mn>
       </mrow>
      </msub>
     </mrow>
    </mrow>
    <mo>,</mo>
    <mrow>
     <msub>
      <mi>Q</mi>
      <mrow>
       <mi>i</mi>
       <mo>+</mo>
       <mn>1</mn>
      </mrow>
     </msub>
     <mo>=</mo>
     <mrow>
      <msub>
       <mi>Q</mi>
       <mrow>
        <mi>i</mi>
        <mo>-</mo>
        <mn>1</mn>
       </mrow>
      </msub>
      <mo>+</mo>
      <mrow>
       <msub>
        <mi>b</mi>
        <mi>i</mi>
       </msub>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <msub>
          <mi>P</mi>
          <mrow>
           <mi>i</mi>
           <mo>-</mo>
           <mn>1</mn>
          </mrow>
         </msub>
         <mo>-</mo>
         <msub>
          <mi>P</mi>
          <mi>i</mi>
         </msub>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>b</ci>
      <ci>i</ci>
     </apply>
     <apply>
      <floor></floor>
      <apply>
       <divide></divide>
       <apply>
        <plus></plus>
        <apply>
         <floor></floor>
         <apply>
          <root></root>
          <apply>
           <times></times>
           <ci>k</ci>
           <ci>N</ci>
          </apply>
         </apply>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>P</ci>
         <apply>
          <minus></minus>
          <ci>i</ci>
          <cn type="integer">1</cn>
         </apply>
        </apply>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>Q</ci>
        <ci>i</ci>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <csymbol cd="ambiguous">formulae-sequence</csymbol>
     <apply>
      <eq></eq>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>P</ci>
       <ci>i</ci>
      </apply>
      <apply>
       <minus></minus>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>b</ci>
         <ci>i</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>Q</ci>
         <ci>i</ci>
        </apply>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>P</ci>
        <apply>
         <minus></minus>
         <ci>i</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <eq></eq>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>Q</ci>
       <apply>
        <plus></plus>
        <ci>i</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <apply>
       <plus></plus>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>Q</ci>
        <apply>
         <minus></minus>
         <ci>i</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>b</ci>
         <ci>i</ci>
        </apply>
        <apply>
         <minus></minus>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>P</ci>
          <apply>
           <minus></minus>
           <ci>i</ci>
           <cn type="integer">1</cn>
          </apply>
         </apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>P</ci>
          <ci>i</ci>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   b_{i}=\left\lfloor\frac{\lfloor\sqrt{kN}\rfloor+P_{i-1}}{Q_{i}}\right\rfloor,P%
_{i}=b_{i}Q_{i}-P_{i-1},Q_{i+1}=Q_{i-1}+b_{i}(P_{i-1}-P_{i})
  </annotation>
 </semantics>
</math>

</p>

<p>until 

<math display="inline" id="Shanks'_square_forms_factorization:26">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>P</mi>
     <mi>i</mi>
    </msub>
    <mo>=</mo>
    <msub>
     <mi>P</mi>
     <mrow>
      <mi>i</mi>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </msub>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>P</ci>
     <ci>i</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>P</ci>
     <apply>
      <minus></minus>
      <ci>i</ci>
      <cn type="integer">1</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   P_{i}=P_{i-1}.
  </annotation>
 </semantics>
</math>

</p>

<p>Then if 

<math display="inline" id="Shanks'_square_forms_factorization:27">
 <semantics>
  <mrow>
   <mi>f</mi>
   <mo>=</mo>
   <mrow>
    <mi>gcd</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>N</mi>
     <mo>,</mo>
     <msub>
      <mi>P</mi>
      <mi>i</mi>
     </msub>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>f</ci>
    <apply>
     <gcd></gcd>
     <ci>N</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>P</ci>
      <ci>i</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f=\gcd(N,P_{i})
  </annotation>
 </semantics>
</math>

 is not equal to 

<math display="inline" id="Shanks'_square_forms_factorization:28">
 <semantics>
  <mn>1</mn>
  <annotation-xml encoding="MathML-Content">
   <cn type="integer">1</cn>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   1
  </annotation>
 </semantics>
</math>


 and not equal to 

<math display="inline" id="Shanks'_square_forms_factorization:29">
 <semantics>
  <mi>N</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>N</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   N
  </annotation>
 </semantics>
</math>

, then 

<math display="inline" id="Shanks'_square_forms_factorization:30">
 <semantics>
  <mi>f</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>f</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f
  </annotation>
 </semantics>
</math>

 is a non-trivial factor of 

<math display="inline" id="Shanks'_square_forms_factorization:31">
 <semantics>
  <mi>N</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>N</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   N
  </annotation>
 </semantics>
</math>

. Otherwise try another value of 

<math display="inline" id="Shanks'_square_forms_factorization:32">
 <semantics>
  <mi>k</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>k</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   k
  </annotation>
 </semantics>
</math>

.</p>

<p>Shanks's method has time complexity 

<math display="inline" id="Shanks'_square_forms_factorization:33">
 <semantics>
  <mrow>
   <mi>O</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mroot>
     <mi>N</mi>
     <mn>4</mn>
    </mroot>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>O</ci>
    <apply>
     <root></root>
     <degree>
      <cn type="integer">4</cn>
     </degree>
     <ci>N</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   O(\sqrt[4]{N})
  </annotation>
 </semantics>
</math>


.</p>

<p>Stephen S. McMasters (see link in External Link section) wrote a more detailed discussion of the mathematics of Shanks's method, together with a proof of its correctness.</p>
<h2 id="example">Example</h2>

<p>N = 11111, k = 1</p>

<p>P<sub>0</sub> = 105 Q<sub>0</sub> = 1 Q<sub>1</sub> = 86</p>

<p>P<sub>1</sub> = 67 Q<sub>1</sub> = 86 Q<sub>2</sub> = 77</p>

<p>P<sub>2</sub> = 87 Q<sub>2</sub> = 77 Q<sub>3</sub> = 46</p>

<p>P<sub>3</sub> = 97 Q<sub>3</sub> = 46 Q<sub>4</sub> = 37</p>

<p>P<sub>4</sub> = 88 Q<sub>4</sub> = 37 Q<sub>5</sub> = 91</p>

<p>P<sub>5</sub> = 94 Q<sub>5</sub> = 91 Q<sub>6</sub> = 25</p>

<p>Here Q<sub>6</sub> is a perfect square</p>

<p>P<sub>0</sub> = 104 Q<sub>0</sub> = 5 Q<sub>1</sub> = 59</p>

<p>P<sub>1</sub> = 73 Q<sub>1</sub> = 59 Q<sub>2</sub> = 98</p>

<p>P<sub>2</sub> = 25 Q<sub>2</sub> = 98 Q<sub>3</sub> = 107</p>

<p>P<sub>3</sub> = 82 Q<sub>3</sub> = 107 Q<sub>4</sub> = 41</p>

<p>P<sub>4</sub> = 82</p>

<p>Here P<sub>3</sub> = P<sub>4</sub></p>

<p>gcd(11111, 82) = 41, which is a factor of 11111.</p>
<h2 id="references">References</h2>
<ul>
<li></li>
<li></li>
<li></li>
</ul>
<h2 id="external-links">External links</h2>
<ul>
<li>Daniel Shanks: <a href="http://www.usna.edu/Users/math/wdj/_files/documents/mcmath/shanks_analysis.pdf"><em>Analysis and Improvement of the Continued Fraction Method of Factorization</em></a>, (transcribed by S. McMath 2004)</li>
<li>Daniel Shanks: <a href="http://www.usna.edu/Users/math/wdj/_files/documents/mcmath/shanks_squfof.pdf"><em>SQUFOF Notes</em></a>, (transcribed by S. McMath 2004)</li>
<li>Stephen McMath: <em>[<a class="uri" href="http://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.107.9984&amp;rep">http://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.107.9984&amp;rep;</a>;=rep1&amp;type;=pdf Daniel Shanks’s Square Forms Factorization]</em> (Nov. 2004)</li>
<li>Stephen S. McMath: <a href="http://www.usna.edu/Users/math/wdj/_files/documents/mcmath/TridentFinal.pdf"><em>Parallel integer factorization using quadratic forms</em></a>, 2005</li>
<li>S. McMath, F. Crabbe, D. Joyner: <a href="http://www.usna.edu/Users/cs/crabbe/papers/mcmath-IJPAM.pdf"><em>Continued fractions and parallel SQUFOF</em></a>, 2005</li>
<li>Jason Gower, Samuel Wagstaff: <a href="http://homes.cerias.purdue.edu/~ssw/squfof.pdf"><em>Square Form Factorisation</em></a></li>
<li><a href="http://colin.barker.pagesperso-orange.fr/lpa/big_squf.htm">Shanks' SQUFOF Factoring Algorithm</a></li>
</ul>

<p>"</p>

<p><a href="Category:Integer_factorization_algorithms" title="wikilink">Category:Integer factorization algorithms</a></p>
</body>
</html>

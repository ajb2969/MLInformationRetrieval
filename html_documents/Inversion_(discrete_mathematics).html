<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="21">Inversion (discrete mathematics)</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Inversion (discrete mathematics)</h1>
<hr/>

<p>  In <a href="computer_science" title="wikilink">computer science</a> and <a href="discrete_mathematics" title="wikilink">discrete mathematics</a>, an <strong>inversion</strong> is a pair of places of a sequence where the elements on these places are out of their natural <a href="total_order" title="wikilink">order</a>.</p>
<h2 id="definitions">Definitions</h2>

<p>Formally, let 

<math display="inline" id="Inversion_(discrete_mathematics):0">
 <semantics>
  <mrow>
   <mo stretchy="false">(</mo>
   <mrow>
    <mi>A</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mn>1</mn>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>,</mo>
   <mi mathvariant="normal">…</mi>
   <mo>,</mo>
   <mrow>
    <mi>A</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>n</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo stretchy="false">)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <vector>
    <apply>
     <times></times>
     <ci>A</ci>
     <cn type="integer">1</cn>
    </apply>
    <ci>normal-…</ci>
    <apply>
     <times></times>
     <ci>A</ci>
     <ci>n</ci>
    </apply>
   </vector>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (A(1),\ldots,A(n))
  </annotation>
 </semantics>
</math>

 be a sequence of <em>n</em> distinct numbers. If 

<math display="inline" id="Inversion_(discrete_mathematics):1">
 <semantics>
  <mrow>
   <mi>i</mi>
   <mo><</mo>
   <mi>j</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <lt></lt>
    <ci>i</ci>
    <ci>j</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   i<j
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Inversion_(discrete_mathematics):2">
 <semantics>
  <mrow>
   <mrow>
    <mi>A</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>i</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>></mo>
   <mrow>
    <mi>A</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>j</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <gt></gt>
    <apply>
     <times></times>
     <ci>A</ci>
     <ci>i</ci>
    </apply>
    <apply>
     <times></times>
     <ci>A</ci>
     <ci>j</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A(i)>A(j)
  </annotation>
 </semantics>
</math>

, then the pair 

<math display="inline" id="Inversion_(discrete_mathematics):3">
 <semantics>
  <mrow>
   <mo stretchy="false">(</mo>
   <mi>i</mi>
   <mo>,</mo>
   <mi>j</mi>
   <mo stretchy="false">)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <interval closure="open">
    <ci>i</ci>
    <ci>j</ci>
   </interval>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (i,j)
  </annotation>
 </semantics>
</math>


 is called an inversion of 

<math display="inline" id="Inversion_(discrete_mathematics):4">
 <semantics>
  <mi>A</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>A</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A
  </annotation>
 </semantics>
</math>

.</p>

<p>The <strong>inversion number</strong> of a sequence is one common measure of its sortedness. Formally, the inversion number is defined to be the number of inversions, that is,</p>

<p>

<math display="block" id="Inversion_(discrete_mathematics):5">
 <semantics>
  <mrow>
   <mrow>
    <mtext>inv</mtext>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>A</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mo stretchy="false">|</mo>
    <mrow>
     <mo stretchy="false">{</mo>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mi>A</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>i</mi>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
      <mo>,</mo>
      <mrow>
       <mi>A</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>j</mi>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <mo>∣</mo>
     <mrow>
      <mi>i</mi>
      <mo><</mo>
      <mrow>
       <mi>j</mi>
       <mtext>and</mtext>
       <mi>A</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>i</mi>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
      <mo>></mo>
      <mrow>
       <mi>A</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>j</mi>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
     </mrow>
     <mo stretchy="false">}</mo>
    </mrow>
    <mo stretchy="false">|</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <mtext>inv</mtext>
     <ci>A</ci>
    </apply>
    <apply>
     <abs></abs>
     <apply>
      <csymbol cd="latexml">conditional-set</csymbol>
      <interval closure="open">
       <apply>
        <times></times>
        <ci>A</ci>
        <ci>i</ci>
       </apply>
       <apply>
        <times></times>
        <ci>A</ci>
        <ci>j</ci>
       </apply>
      </interval>
      <apply>
       <and></and>
       <apply>
        <lt></lt>
        <ci>i</ci>
        <apply>
         <times></times>
         <ci>j</ci>
         <mtext>and</mtext>
         <ci>A</ci>
         <ci>i</ci>
        </apply>
       </apply>
       <apply>
        <gt></gt>
        <share href="#.cmml">
        </share>
        <apply>
         <times></times>
         <ci>A</ci>
         <ci>j</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \text{inv}(A)=|\{(A(i),A(j))\mid i<j\text{ and }A(i)>A(j)\}|
  </annotation>
 </semantics>
</math>

. Equivalently, it is the <a href="Kendall_tau_distance" title="wikilink">Kendall tau distance</a> from the identity permutation. Other measures of (pre-)sortedness include the minimum number of elements that can be deleted from the sequence to yield a fully sorted sequence, the number and lengths of sorted "runs" within the sequence, the Spearman footrule (sum of distances of each element from its sorted position), and the smallest number of exchanges needed to sort the sequence. Standard <a href="comparison_sort" title="wikilink">comparison sorting</a> algorithms can be adapted to compute the inversion number in time 

<math display="inline" id="Inversion_(discrete_mathematics):6">
 <semantics>
  <mrow>
   <mi>O</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mrow>
     <mi>n</mi>
     <mi>l</mi>
     <mi>o</mi>
     <mi>g</mi>
     <mi>n</mi>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>O</ci>
    <apply>
     <times></times>
     <ci>n</ci>
     <ci>l</ci>
     <ci>o</ci>
     <ci>g</ci>
     <ci>n</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   O(nlogn)
  </annotation>
 </semantics>
</math>

.</p>

<p>The <strong>inversion vector</strong> <em>V(i)</em> of the sequence is defined for <em>i</em> = 2, ..., <em>n</em> as 

<math display="inline" id="Inversion_(discrete_mathematics):7">
 <semantics>
  <mrow>
   <mrow>
    <mi>V</mi>
    <mrow>
     <mo stretchy="false">[</mo>
     <mi>i</mi>
     <mo stretchy="false">]</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mo>|</mo>
    <mrow>
     <mo stretchy="false">{</mo>
     <mi>k</mi>
     <mo>∣</mo>
     <mrow>
      <mi>k</mi>
      <mo><</mo>
      <mrow>
       <mi>i</mi>
       <mtext>and</mtext>
       <mi>A</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>k</mi>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
      <mo>></mo>
      <mrow>
       <mi>A</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>i</mi>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
     </mrow>
     <mo stretchy="false">}</mo>
    </mrow>
    <mo>|</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>V</ci>
     <apply>
      <csymbol cd="latexml">delimited-[]</csymbol>
      <ci>i</ci>
     </apply>
    </apply>
    <apply>
     <abs></abs>
     <apply>
      <csymbol cd="latexml">conditional-set</csymbol>
      <ci>k</ci>
      <apply>
       <and></and>
       <apply>
        <lt></lt>
        <ci>k</ci>
        <apply>
         <times></times>
         <ci>i</ci>
         <mtext>and</mtext>
         <ci>A</ci>
         <ci>k</ci>
        </apply>
       </apply>
       <apply>
        <gt></gt>
        <share href="#.cmml">
        </share>
        <apply>
         <times></times>
         <ci>A</ci>
         <ci>i</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   V[i]=\left|\{k\mid k<i\text{ and }A(k)>A(i)\}\right|
  </annotation>
 </semantics>
</math>

. In other words each element is the number of elements preceding the element in the original sequence that are greater than it. Note that the inversion vector of a sequence has one less element than the sequence, because of course the number of preceding elements that are greater than the first is always zero. Each permutation of a sequence has a unique inversion vector and it is possible to construct any given permutation of a (fully sorted) sequence from that sequence and the permutation's inversion vector.</p>
<h2 id="weak-order-of-permutations">Weak order of permutations</h2>

<p>The set of permutations on <em>n</em> items can be given the structure of a <a href="partial_order" title="wikilink">partial order</a>, called the <strong>weak order of permutations</strong>, which forms a <a href="lattice_(order)" title="wikilink">lattice</a>.</p>

<p>To define this order, consider the items being permuted to be the integers from 1 to <em>n</em>, and let Inv(<em>u</em>) denote the set of inversions of a permutation <em>u</em> for the natural ordering on these items. That is, Inv(<em>u</em>) is the set of ordered pairs (<em>i</em>, <em>j</em>) such that 1 ≤ <em>i</em> <em>u</em>(<em>j</em>). Then, in the weak order, we define <em>u</em> ≤ <em>v</em> whenever Inv(<em>u</em>) ⊆ Inv(<em>v</em>).</p>

<p>The edges of the <a href="Hasse_diagram" title="wikilink">Hasse diagram</a> of the weak order are given by permutations <em>u</em> and <em>v</em> such that ''u </p>
</body>
</html>

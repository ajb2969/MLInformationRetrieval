<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="848">Addition-chain exponentiation</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Addition-chain exponentiation</h1>
<hr/>

<p>In <a class="uri" href="mathematics" title="wikilink">mathematics</a> and <a href="computer_science" title="wikilink">computer science</a>, optimal <strong>addition-chain exponentiation</strong> is a method of <a class="uri" href="exponentiation" title="wikilink">exponentiation</a> by positive <a class="uri" href="integer" title="wikilink">integer</a> powers that requires a minimal number of multiplications. It works by creating the shortest <a href="addition_chain" title="wikilink">addition chain</a> that generates the desired exponent. Each exponentiation in the chain can be evaluated by multiplying two of the earlier exponentiation results. More generally, <em>addition-chain exponentiation</em> may also refer to exponentiation by non-minimal addition chains constructed by a variety of algorithms (since a shortest addition chain is very difficult to find).</p>

<p>The shortest addition-chain <a class="uri" href="algorithm" title="wikilink">algorithm</a> requires no more multiplications than <a href="binary_exponentiation" title="wikilink">binary exponentiation</a> and usually less. The first example of where it does better is for <em>a</em><sup>15</sup>, where the binary method needs six multiplications but a shortest addition chain requires only five:</p>

<p>

<math display="block" id="Addition-chain_exponentiation:0">
 <semantics>
  <mrow>
   <msup>
    <mi>a</mi>
    <mn>15</mn>
   </msup>
   <mo>=</mo>
   <mrow>
    <mi>a</mi>
    <mo>×</mo>
    <mpadded width="-1.7pt">
     <msup>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mi>a</mi>
        <mo>×</mo>
        <msup>
         <mrow>
          <mo stretchy="false">[</mo>
          <mrow>
           <mi>a</mi>
           <mo>×</mo>
           <msup>
            <mi>a</mi>
            <mn>2</mn>
           </msup>
          </mrow>
          <mo stretchy="false">]</mo>
         </mrow>
         <mn>2</mn>
        </msup>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
      <mn>2</mn>
     </msup>
    </mpadded>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>a</ci>
     <cn type="integer">15</cn>
    </apply>
    <apply>
     <times></times>
     <ci>a</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <times></times>
       <ci>a</ci>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="latexml">delimited-[]</csymbol>
         <apply>
          <times></times>
          <ci>a</ci>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <ci>a</ci>
           <cn type="integer">2</cn>
          </apply>
         </apply>
        </apply>
        <cn type="integer">2</cn>
       </apply>
      </apply>
      <cn type="integer">2</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a^{15}=a\times(a\times[a\times a^{2}]^{2})^{2}\!
  </annotation>
 </semantics>
</math>

 (binary, 6 multiplications)</p>

<p>

<math display="block" id="Addition-chain_exponentiation:1">
 <semantics>
  <mrow>
   <msup>
    <mi>a</mi>
    <mn>15</mn>
   </msup>
   <mo>=</mo>
   <mrow>
    <msup>
     <mi>a</mi>
     <mn>3</mn>
    </msup>
    <mo>×</mo>
    <mpadded width="-1.7pt">
     <msup>
      <mrow>
       <mo stretchy="false">(</mo>
       <msup>
        <mrow>
         <mo stretchy="false">[</mo>
         <msup>
          <mi>a</mi>
          <mn>3</mn>
         </msup>
         <mo stretchy="false">]</mo>
        </mrow>
        <mn>2</mn>
       </msup>
       <mo stretchy="false">)</mo>
      </mrow>
      <mn>2</mn>
     </msup>
    </mpadded>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>a</ci>
     <cn type="integer">15</cn>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>a</ci>
      <cn type="integer">3</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="latexml">delimited-[]</csymbol>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>a</ci>
         <cn type="integer">3</cn>
        </apply>
       </apply>
       <cn type="integer">2</cn>
      </apply>
      <cn type="integer">2</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a^{15}=a^{3}\times([a^{3}]^{2})^{2}\!
  </annotation>
 </semantics>
</math>

 (shortest addition chain, 5 multiplications).</p>
<table>
<tbody>
<tr class="odd">
<td style="text-align: left;">
<p>Table demonstrating how to do <em>Exponentiation</em> using <em>Addition Chains</em></p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>Number of<br/>
Multiplications</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>0</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>1</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>2</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>2</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>3</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>3</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>4</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>3</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>4</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>4</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>5</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>4</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>5</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>5</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>5</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>4</p></td>
</tr>
</tbody>
</table>

<p>On the other hand, the determination of a shortest addition chain is hard: no efficient optimal methods are currently known for arbitrary exponents, and the related problem of finding a shortest addition chain for a given set of exponents has been proven <a class="uri" href="NP-complete" title="wikilink">NP-complete</a>.<a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a> Even given a shortest chain, addition-chain exponentiation requires more memory than the binary method, because it must potentially store many previous exponents from the chain. So in practice, shortest addition-chain exponentiation is primarily used for small fixed exponents for which a shortest chain can be precomputed and is not too large.</p>

<p>There are also several methods to <em>approximate</em> a shortest addition chain, and which often require fewer multiplications than binary exponentiation; binary exponentiation itself is a suboptimal addition-chain algorithm. The optimal algorithm choice depends on the context (such as the relative cost of the multiplication and the number of times a given exponent is re-used).<a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a></p>

<p>The problem of finding the shortest addition chain cannot be solved by <a href="dynamic_programming" title="wikilink">dynamic programming</a>, because it does not satisfy the assumption of <a href="optimal_substructure" title="wikilink">optimal substructure</a>. That is, it is not sufficient to decompose the power into smaller powers, each of which is computed minimally, since the addition chains for the smaller powers may be related (to share computations). For example, in the shortest addition chain for <em>a</em><sup>15</sup> above, the subproblem for <em>a</em><sup>6</sup> must be computed as (<em>a</em><sup>3</sup>)<sup>2</sup> since <em>a</em><sup>3</sup> is re-used (as opposed to, say, <em>a</em><sup>6</sup> = <em>a</em><sup>2</sup>(<em>a</em><sup>2</sup>)<sup>2</sup>, which also requires three multiplies).</p>
<h2 id="addition-subtractionchain-exponentiation">Addition-subtraction–chain exponentiation</h2>

<p>If both multiplication and division are allowed, then an <a href="addition-subtraction_chain" title="wikilink">addition-subtraction chain</a> may be used to obtain even fewer total multiplications+divisions (where subtraction corresponds to division). However, the slowness of division compared to multiplication makes this technique unattractive in general. For exponentiation to <a href="negative_number" title="wikilink">negative</a> integer powers, on the other hand, since one division is required anyway, an addition-subtraction chain is often beneficial. One such example is <em>a</em><sup>−31</sup>, where computing 1/<em>a</em><sup>31</sup> by a shortest addition chain for <em>a</em><sup>31</sup> requires 7 multiplications and one division, whereas the shortest addition-subtraction chain requires 5 multiplications and one division:</p>

<p>

<math display="block" id="Addition-chain_exponentiation:2">
 <semantics>
  <mrow>
   <msup>
    <mi>a</mi>
    <mrow>
     <mo>-</mo>
     <mn>31</mn>
    </mrow>
   </msup>
   <mo>=</mo>
   <mrow>
    <mi>a</mi>
    <mo>/</mo>
    <mpadded width="-1.7pt">
     <msup>
      <mrow>
       <mo stretchy="false">(</mo>
       <msup>
        <mrow>
         <mo stretchy="false">(</mo>
         <msup>
          <mrow>
           <mo stretchy="false">(</mo>
           <msup>
            <mrow>
             <mo stretchy="false">(</mo>
             <msup>
              <mi>a</mi>
              <mn>2</mn>
             </msup>
             <mo stretchy="false">)</mo>
            </mrow>
            <mn>2</mn>
           </msup>
           <mo stretchy="false">)</mo>
          </mrow>
          <mn>2</mn>
         </msup>
         <mo stretchy="false">)</mo>
        </mrow>
        <mn>2</mn>
       </msup>
       <mo stretchy="false">)</mo>
      </mrow>
      <mn>2</mn>
     </msup>
    </mpadded>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>a</ci>
     <apply>
      <minus></minus>
      <cn type="integer">31</cn>
     </apply>
    </apply>
    <apply>
     <divide></divide>
     <ci>a</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>a</ci>
          <cn type="integer">2</cn>
         </apply>
         <cn type="integer">2</cn>
        </apply>
        <cn type="integer">2</cn>
       </apply>
       <cn type="integer">2</cn>
      </apply>
      <cn type="integer">2</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a^{-31}=a/((((a^{2})^{2})^{2})^{2})^{2}\!
  </annotation>
 </semantics>
</math>

 (addition-subtraction chain, 5 mults + 1 div).</p>

<p>For exponentiation on <a href="elliptic_curve" title="wikilink">elliptic curves</a>, the inverse of a point (<em>x</em>, <em>y</em>) is available at no cost, since it is simply (<em>x</em>, −<em>y</em>), and therefore addition-subtraction chains are optimal in this context even for positive integer exponents.<a class="footnoteRef" href="#fn3" id="fnref3"><sup>3</sup></a></p>
<h2 id="references">References</h2>
<ul>
<li><a href="Donald_E._Knuth" title="wikilink">Donald E. Knuth</a>, <em>The Art of Computer Programming, Volume 2: Seminumerical Algorithms</em>, 3rd edition, §4.6.3 (Addison-Wesley: San Francisco, 1998).</li>
<li>Daniel J. Bernstein, "<a href="http://cr.yp.to/papers/pippenger.pdf">Pippenger's Algorithm</a>," to be incorporated into author's <em>High-speed cryptography</em> book. (2002)</li>
</ul>

<p>"</p>

<p><a href="Category:Addition_chains" title="wikilink">Category:Addition chains</a> <a class="uri" href="Category:Exponentials" title="wikilink">Category:Exponentials</a> <a href="Category:Computer_arithmetic_algorithms" title="wikilink">Category:Computer arithmetic algorithms</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1"><a href="#fnref1">↩</a></li>
<li id="fn2"><a href="#fnref2">↩</a></li>
<li id="fn3">François Morain and Jorge Olivos, "<a href="ftp://ftp.inria.fr/INRIA/publication/Theses/TU-0144/ch4.ps">Speeding up the computations on an elliptic curve using addition-subtraction chains</a>," <em>RAIRO Informatique théoretique et application</em> <strong>24</strong>, pp. 531-543 (1990).<a href="#fnref3">↩</a></li>
</ol>
</section>
</body>
</html>

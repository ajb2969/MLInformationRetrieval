<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="419">Stirling's approximation</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Stirling's approximation</h1>
<hr/>

<p> In <a class="uri" href="mathematics" title="wikilink">mathematics</a>, <strong>Stirling's approximation</strong> (or <strong>Stirling's formula</strong>) is an approximation for <a href="factorial" title="wikilink">factorials</a>. It is a very powerful approximation, leading to accurate results even for small values of <em>n</em>. It is named after <a href="James_Stirling_(mathematician)" title="wikilink">James Stirling</a>, though it was first stated by <a href="Abraham_de_Moivre" title="wikilink">Abraham de Moivre</a>.<a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a><a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a><a class="footnoteRef" href="#fn3" id="fnref3"><sup>3</sup></a></p>

<p>The formula as typically used in applications is</p>

<p>

<math display="block" id="Stirling's_approximation:0">
 <semantics>
  <mrow>
   <mrow>
    <mi>ln</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>n</mi>
      <mo lspace="0pt" rspace="3.5pt">!</mo>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mrow>
      <mi>n</mi>
      <mrow>
       <mi>ln</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>n</mi>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
     </mrow>
     <mo>-</mo>
     <mi>n</mi>
    </mrow>
    <mo>+</mo>
    <mrow>
     <mi>O</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mi>ln</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>n</mi>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <ln></ln>
     <apply>
      <factorial></factorial>
      <ci>n</ci>
     </apply>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <minus></minus>
      <apply>
       <times></times>
       <ci>n</ci>
       <apply>
        <ln></ln>
        <ci>n</ci>
       </apply>
      </apply>
      <ci>n</ci>
     </apply>
     <apply>
      <times></times>
      <ci>O</ci>
      <apply>
       <ln></ln>
       <ci>n</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \ln(n!)=n\ln(n)-n+O(\ln(n))
  </annotation>
 </semantics>
</math>

</p>

<p>(in <a href="big_O_notation" title="wikilink">big O notation</a>). The next term in the <em>O</em>(ln(<em>n</em>)) is (1/2)ln(2π<em>n</em>); a more precise variant of the formula is therefore</p>

<p>

<math display="block" id="Stirling's_approximation:1">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>n</mi>
     <mo lspace="0pt" rspace="3.5pt">!</mo>
    </mrow>
    <mo>∼</mo>
    <mrow>
     <msqrt>
      <mrow>
       <mn>2</mn>
       <mi>π</mi>
       <mi>n</mi>
      </mrow>
     </msqrt>
     <msup>
      <mrow>
       <mo>(</mo>
       <mfrac>
        <mi>n</mi>
        <mi>e</mi>
       </mfrac>
       <mo>)</mo>
      </mrow>
      <mi>n</mi>
     </msup>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">similar-to</csymbol>
    <apply>
     <factorial></factorial>
     <ci>n</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <root></root>
      <apply>
       <times></times>
       <cn type="integer">2</cn>
       <ci>π</ci>
       <ci>n</ci>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <divide></divide>
       <ci>n</ci>
       <ci>e</ci>
      </apply>
      <ci>n</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n!\sim\sqrt{2\pi n}\left(\frac{n}{e}\right)^{n}.
  </annotation>
 </semantics>
</math>

</p>

<p>As an <a href="asymptotic_formula" title="wikilink">asymptotic formula</a>, Stirling's approximation has the property that the ratio</p>

<p>

<math display="block" id="Stirling's_approximation:2">
 <semantics>
  <mfrac>
   <mrow>
    <mi>n</mi>
    <mo lspace="0pt" rspace="3.5pt">!</mo>
   </mrow>
   <mrow>
    <msqrt>
     <mrow>
      <mn>2</mn>
      <mi>π</mi>
      <mi>n</mi>
     </mrow>
    </msqrt>
    <msup>
     <mrow>
      <mo>(</mo>
      <mfrac>
       <mi>n</mi>
       <mi>e</mi>
      </mfrac>
      <mo>)</mo>
     </mrow>
     <mi>n</mi>
    </msup>
   </mrow>
  </mfrac>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <divide></divide>
    <apply>
     <factorial></factorial>
     <ci>n</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <root></root>
      <apply>
       <times></times>
       <cn type="integer">2</cn>
       <ci>π</ci>
       <ci>n</ci>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <divide></divide>
       <ci>n</ci>
       <ci>e</ci>
      </apply>
      <ci>n</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \frac{n!}{\sqrt{2\pi n}\left(\frac{n}{e}\right)^{n}}
  </annotation>
 </semantics>
</math>

</p>

<p>approaches 1 as <em>n</em> grows to infinity.</p>
<h2 id="derivation">Derivation</h2>

<p>The formula, together with precise estimates of its error, can be derived as follows. Instead of approximating <em>n</em>!, one considers its <a href="natural_logarithm" title="wikilink">natural logarithm</a> as this is a slowly varying function:</p>

<p>

<math display="block" id="Stirling's_approximation:3">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>ln</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mi>n</mi>
       <mo lspace="0pt" rspace="3.5pt">!</mo>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mi>ln</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mn>1</mn>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo>+</mo>
     <mrow>
      <mi>ln</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mn>2</mn>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo>+</mo>
     <mi mathvariant="normal">⋯</mi>
     <mo>+</mo>
     <mrow>
      <mi>ln</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>n</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <ln></ln>
     <apply>
      <factorial></factorial>
      <ci>n</ci>
     </apply>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <ln></ln>
      <cn type="integer">1</cn>
     </apply>
     <apply>
      <ln></ln>
      <cn type="integer">2</cn>
     </apply>
     <ci>normal-⋯</ci>
     <apply>
      <ln></ln>
      <ci>n</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \ln(n!)=\ln(1)+\ln(2)+\cdots+\ln(n).
  </annotation>
 </semantics>
</math>

</p>

<p>The right-hand side of this equation minus</p>

<p>

<math display="block" id="Stirling's_approximation:4">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mstyle displaystyle="false">
      <mfrac>
       <mn>1</mn>
       <mn>2</mn>
      </mfrac>
     </mstyle>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mrow>
        <mi>ln</mi>
        <mrow>
         <mo stretchy="false">(</mo>
         <mn>1</mn>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
       <mo>+</mo>
       <mrow>
        <mi>ln</mi>
        <mrow>
         <mo stretchy="false">(</mo>
         <mi>n</mi>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mstyle displaystyle="false">
      <mfrac>
       <mn>1</mn>
       <mn>2</mn>
      </mfrac>
     </mstyle>
     <mrow>
      <mi>ln</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>n</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <divide></divide>
      <cn type="integer">1</cn>
      <cn type="integer">2</cn>
     </apply>
     <apply>
      <plus></plus>
      <apply>
       <ln></ln>
       <cn type="integer">1</cn>
      </apply>
      <apply>
       <ln></ln>
       <ci>n</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <divide></divide>
      <cn type="integer">1</cn>
      <cn type="integer">2</cn>
     </apply>
     <apply>
      <ln></ln>
      <ci>n</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \tfrac{1}{2}(\ln(1)+\ln(n))=\tfrac{1}{2}\ln(n),
  </annotation>
 </semantics>
</math>

</p>

<p>is the approximation by the <a href="trapezoid_rule" title="wikilink">trapezoid rule</a> of the integral</p>

<p>

<math display="block" id="Stirling's_approximation:5">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mrow>
      <mi>ln</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mi>n</mi>
        <mo lspace="0pt" rspace="3.5pt">!</mo>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo>-</mo>
     <mrow>
      <mstyle displaystyle="false">
       <mfrac>
        <mn>1</mn>
        <mn>2</mn>
       </mfrac>
      </mstyle>
      <mrow>
       <mi>ln</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>n</mi>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
     </mrow>
    </mrow>
    <mo>≈</mo>
    <mrow>
     <msubsup>
      <mo largeop="true" symmetric="true">∫</mo>
      <mn>1</mn>
      <mi>n</mi>
     </msubsup>
     <mrow>
      <mrow>
       <mi>ln</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>x</mi>
        <mo rspace="4.2pt" stretchy="false">)</mo>
       </mrow>
      </mrow>
      <mi mathvariant="normal">d</mi>
      <mi>x</mi>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mrow>
       <mi>n</mi>
       <mrow>
        <mi>ln</mi>
        <mrow>
         <mo stretchy="false">(</mo>
         <mi>n</mi>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
      </mrow>
      <mo>-</mo>
      <mi>n</mi>
     </mrow>
     <mo>+</mo>
     <mn>1</mn>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <approx></approx>
     <apply>
      <minus></minus>
      <apply>
       <ln></ln>
       <apply>
        <factorial></factorial>
        <ci>n</ci>
       </apply>
      </apply>
      <apply>
       <times></times>
       <apply>
        <divide></divide>
        <cn type="integer">1</cn>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <ln></ln>
        <ci>n</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <int></int>
        <cn type="integer">1</cn>
       </apply>
       <ci>n</ci>
      </apply>
      <apply>
       <times></times>
       <apply>
        <ln></ln>
        <ci>x</ci>
       </apply>
       <ci>normal-d</ci>
       <ci>x</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <plus></plus>
      <apply>
       <minus></minus>
       <apply>
        <times></times>
        <ci>n</ci>
        <apply>
         <ln></ln>
         <ci>n</ci>
        </apply>
       </apply>
       <ci>n</ci>
      </apply>
      <cn type="integer">1</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \ln(n!)-\tfrac{1}{2}\ln(n)\approx\int_{1}^{n}\ln(x)\,{\rm d}x=n\ln(n)-n+1,
  </annotation>
 </semantics>
</math>

</p>

<p>and the error in this approximation is given by the <a href="Euler–Maclaurin_formula" title="wikilink">Euler–Maclaurin formula</a>:</p>

<p>

<math display="inline" id="Stirling's_approximation:6">
 <semantics>
  <mrow>
   <mrow>
    <mi>ln</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>n</mi>
      <mo lspace="0pt" rspace="3.5pt">!</mo>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>-</mo>
   <mrow>
    <mfrac>
     <mn>1</mn>
     <mn>2</mn>
    </mfrac>
    <mrow>
     <mi>ln</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>n</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <minus></minus>
    <apply>
     <ln></ln>
     <apply>
      <factorial></factorial>
      <ci>n</ci>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <divide></divide>
      <cn type="integer">1</cn>
      <cn type="integer">2</cn>
     </apply>
     <apply>
      <ln></ln>
      <ci>n</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle\ln(n!)-\tfrac{1}{2}\ln(n)
  </annotation>
 </semantics>
</math>


</p>

<p>where <em>B</em><sub><em>k</em></sub> is a <a href="Bernoulli_number" title="wikilink">Bernoulli number</a> and <em>R</em><sub><em>m</em>,<em>n</em></sub> is the remainder term in the Euler–Maclaurin formula. Take limits to find that</p>

<p>

<math display="block" id="Stirling's_approximation:7">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <munder>
      <mo movablelimits="false">lim</mo>
      <mrow>
       <mi>n</mi>
       <mo>→</mo>
       <mi mathvariant="normal">∞</mi>
      </mrow>
     </munder>
     <mrow>
      <mo>(</mo>
      <mrow>
       <mrow>
        <mrow>
         <mrow>
          <mi>ln</mi>
          <mrow>
           <mo stretchy="false">(</mo>
           <mrow>
            <mi>n</mi>
            <mo lspace="0pt" rspace="3.5pt">!</mo>
           </mrow>
           <mo stretchy="false">)</mo>
          </mrow>
         </mrow>
         <mo>-</mo>
         <mrow>
          <mi>n</mi>
          <mrow>
           <mi>ln</mi>
           <mrow>
            <mo stretchy="false">(</mo>
            <mi>n</mi>
            <mo stretchy="false">)</mo>
           </mrow>
          </mrow>
         </mrow>
        </mrow>
        <mo>+</mo>
        <mi>n</mi>
       </mrow>
       <mo>-</mo>
       <mrow>
        <mstyle displaystyle="false">
         <mfrac>
          <mn>1</mn>
          <mn>2</mn>
         </mfrac>
        </mstyle>
        <mrow>
         <mi>ln</mi>
         <mrow>
          <mo stretchy="false">(</mo>
          <mi>n</mi>
          <mo stretchy="false">)</mo>
         </mrow>
        </mrow>
       </mrow>
      </mrow>
      <mo>)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mn>1</mn>
      <mo>-</mo>
      <mrow>
       <munderover>
        <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
        <mrow>
         <mi>k</mi>
         <mo>=</mo>
         <mn>2</mn>
        </mrow>
        <mi>m</mi>
       </munderover>
       <mfrac>
        <mrow>
         <msup>
          <mrow>
           <mo stretchy="false">(</mo>
           <mrow>
            <mo>-</mo>
            <mn>1</mn>
           </mrow>
           <mo stretchy="false">)</mo>
          </mrow>
          <mi>k</mi>
         </msup>
         <msub>
          <mi>B</mi>
          <mi>k</mi>
         </msub>
        </mrow>
        <mrow>
         <mi>k</mi>
         <mrow>
          <mo stretchy="false">(</mo>
          <mrow>
           <mi>k</mi>
           <mo>-</mo>
           <mn>1</mn>
          </mrow>
          <mo stretchy="false">)</mo>
         </mrow>
        </mrow>
       </mfrac>
      </mrow>
     </mrow>
     <mo>+</mo>
     <mrow>
      <munder>
       <mo movablelimits="false">lim</mo>
       <mrow>
        <mi>n</mi>
        <mo>→</mo>
        <mi mathvariant="normal">∞</mi>
       </mrow>
      </munder>
      <msub>
       <mi>R</mi>
       <mrow>
        <mi>m</mi>
        <mo>,</mo>
        <mi>n</mi>
       </mrow>
      </msub>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <limit></limit>
      <apply>
       <ci>normal-→</ci>
       <ci>n</ci>
       <infinity></infinity>
      </apply>
     </apply>
     <apply>
      <minus></minus>
      <apply>
       <plus></plus>
       <apply>
        <minus></minus>
        <apply>
         <ln></ln>
         <apply>
          <factorial></factorial>
          <ci>n</ci>
         </apply>
        </apply>
        <apply>
         <times></times>
         <ci>n</ci>
         <apply>
          <ln></ln>
          <ci>n</ci>
         </apply>
        </apply>
       </apply>
       <ci>n</ci>
      </apply>
      <apply>
       <times></times>
       <apply>
        <divide></divide>
        <cn type="integer">1</cn>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <ln></ln>
        <ci>n</ci>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <minus></minus>
      <cn type="integer">1</cn>
      <apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <sum></sum>
         <apply>
          <eq></eq>
          <ci>k</ci>
          <cn type="integer">2</cn>
         </apply>
        </apply>
        <ci>m</ci>
       </apply>
       <apply>
        <divide></divide>
        <apply>
         <times></times>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <apply>
           <minus></minus>
           <cn type="integer">1</cn>
          </apply>
          <ci>k</ci>
         </apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>B</ci>
          <ci>k</ci>
         </apply>
        </apply>
        <apply>
         <times></times>
         <ci>k</ci>
         <apply>
          <minus></minus>
          <ci>k</ci>
          <cn type="integer">1</cn>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <limit></limit>
       <apply>
        <ci>normal-→</ci>
        <ci>n</ci>
        <infinity></infinity>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>R</ci>
       <list>
        <ci>m</ci>
        <ci>n</ci>
       </list>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \lim_{n\to\infty}\left(\ln(n!)-n\ln(n)+n-\tfrac{1}{2}\ln(n)\right)=1-\sum_{k=2%
}^{m}\frac{(-1)^{k}B_{k}}{k(k-1)}+\lim_{n\to\infty}R_{m,n}.
  </annotation>
 </semantics>
</math>

</p>

<p>Denote this limit by <em>y</em>. Because the remainder <em>R</em><sub><em>m</em>,<em>n</em></sub> in the <a href="Euler–Maclaurin_formula" title="wikilink">Euler–Maclaurin formula</a> satisfies</p>

<p>

<math display="block" id="Stirling's_approximation:8">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>R</mi>
     <mrow>
      <mi>m</mi>
      <mo>,</mo>
      <mi>n</mi>
     </mrow>
    </msub>
    <mo>=</mo>
    <mrow>
     <mrow>
      <munder>
       <mo movablelimits="false">lim</mo>
       <mrow>
        <mi>n</mi>
        <mo>→</mo>
        <mi mathvariant="normal">∞</mi>
       </mrow>
      </munder>
      <msub>
       <mi>R</mi>
       <mrow>
        <mi>m</mi>
        <mo>,</mo>
        <mi>n</mi>
       </mrow>
      </msub>
     </mrow>
     <mo>+</mo>
     <mrow>
      <mi>O</mi>
      <mrow>
       <mo>(</mo>
       <mfrac>
        <mn>1</mn>
        <msup>
         <mi>n</mi>
         <mi>m</mi>
        </msup>
       </mfrac>
       <mo>)</mo>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>R</ci>
     <list>
      <ci>m</ci>
      <ci>n</ci>
     </list>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <limit></limit>
       <apply>
        <ci>normal-→</ci>
        <ci>n</ci>
        <infinity></infinity>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>R</ci>
       <list>
        <ci>m</ci>
        <ci>n</ci>
       </list>
      </apply>
     </apply>
     <apply>
      <times></times>
      <ci>O</ci>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>n</ci>
        <ci>m</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   R_{m,n}=\lim_{n\to\infty}R_{m,n}+O\left(\frac{1}{n^{m}}\right),
  </annotation>
 </semantics>
</math>

</p>

<p>where we use <a href="Big-O_notation" title="wikilink">Big-O notation</a>, combining the equations above yields the approximation formula in its logarithmic form:</p>

<p>

<math display="block" id="Stirling's_approximation:9">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>ln</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mi>n</mi>
       <mo lspace="0pt" rspace="3.5pt">!</mo>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mi>n</mi>
      <mrow>
       <mi>ln</mi>
       <mrow>
        <mo>(</mo>
        <mfrac>
         <mi>n</mi>
         <mi>e</mi>
        </mfrac>
        <mo>)</mo>
       </mrow>
      </mrow>
     </mrow>
     <mo>+</mo>
     <mrow>
      <mstyle displaystyle="false">
       <mfrac>
        <mn>1</mn>
        <mn>2</mn>
       </mfrac>
      </mstyle>
      <mrow>
       <mi>ln</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>n</mi>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
     </mrow>
     <mo>+</mo>
     <mi>y</mi>
     <mo>+</mo>
     <mrow>
      <munderover>
       <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
       <mrow>
        <mi>k</mi>
        <mo>=</mo>
        <mn>2</mn>
       </mrow>
       <mi>m</mi>
      </munderover>
      <mfrac>
       <mrow>
        <msup>
         <mrow>
          <mo stretchy="false">(</mo>
          <mrow>
           <mo>-</mo>
           <mn>1</mn>
          </mrow>
          <mo stretchy="false">)</mo>
         </mrow>
         <mi>k</mi>
        </msup>
        <msub>
         <mi>B</mi>
         <mi>k</mi>
        </msub>
       </mrow>
       <mrow>
        <mi>k</mi>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <mi>k</mi>
          <mo>-</mo>
          <mn>1</mn>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
        <msup>
         <mi>n</mi>
         <mrow>
          <mi>k</mi>
          <mo>-</mo>
          <mn>1</mn>
         </mrow>
        </msup>
       </mrow>
      </mfrac>
     </mrow>
     <mo>+</mo>
     <mrow>
      <mi>O</mi>
      <mrow>
       <mo>(</mo>
       <mfrac>
        <mn>1</mn>
        <msup>
         <mi>n</mi>
         <mi>m</mi>
        </msup>
       </mfrac>
       <mo>)</mo>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <ln></ln>
     <apply>
      <factorial></factorial>
      <ci>n</ci>
     </apply>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <ci>n</ci>
      <apply>
       <ln></ln>
       <apply>
        <divide></divide>
        <ci>n</ci>
        <ci>e</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <ln></ln>
       <ci>n</ci>
      </apply>
     </apply>
     <ci>y</ci>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <apply>
         <eq></eq>
         <ci>k</ci>
         <cn type="integer">2</cn>
        </apply>
       </apply>
       <ci>m</ci>
      </apply>
      <apply>
       <divide></divide>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <minus></minus>
          <cn type="integer">1</cn>
         </apply>
         <ci>k</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>B</ci>
         <ci>k</ci>
        </apply>
       </apply>
       <apply>
        <times></times>
        <ci>k</ci>
        <apply>
         <minus></minus>
         <ci>k</ci>
         <cn type="integer">1</cn>
        </apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>n</ci>
         <apply>
          <minus></minus>
          <ci>k</ci>
          <cn type="integer">1</cn>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <ci>O</ci>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>n</ci>
        <ci>m</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \ln(n!)=n\ln\left(\frac{n}{e}\right)+\tfrac{1}{2}\ln(n)+y+\sum_{k=2}^{m}\frac{%
(-1)^{k}B_{k}}{k(k-1)n^{k-1}}+O\left(\frac{1}{n^{m}}\right).
  </annotation>
 </semantics>
</math>

</p>

<p>Taking the exponential of both sides, and choosing any positive integer <em>m</em>, we get a formula involving an unknown quantity <em>e</em><sup><em>y</em></sup>. For <em>m</em> = 1, the formula is</p>

<p>

<math display="block" id="Stirling's_approximation:10">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>n</mi>
     <mo lspace="0pt" rspace="3.5pt">!</mo>
    </mrow>
    <mo>=</mo>
    <mrow>
     <msup>
      <mi>e</mi>
      <mi>y</mi>
     </msup>
     <msqrt>
      <mi>n</mi>
     </msqrt>
     <msup>
      <mrow>
       <mo>(</mo>
       <mfrac>
        <mi>n</mi>
        <mi>e</mi>
       </mfrac>
       <mo>)</mo>
      </mrow>
      <mi>n</mi>
     </msup>
     <mrow>
      <mo>(</mo>
      <mrow>
       <mn>1</mn>
       <mo>+</mo>
       <mrow>
        <mi>O</mi>
        <mrow>
         <mo>(</mo>
         <mfrac>
          <mn>1</mn>
          <mi>n</mi>
         </mfrac>
         <mo>)</mo>
        </mrow>
       </mrow>
      </mrow>
      <mo>)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <factorial></factorial>
     <ci>n</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>e</ci>
      <ci>y</ci>
     </apply>
     <apply>
      <root></root>
      <ci>n</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <divide></divide>
       <ci>n</ci>
       <ci>e</ci>
      </apply>
      <ci>n</ci>
     </apply>
     <apply>
      <plus></plus>
      <cn type="integer">1</cn>
      <apply>
       <times></times>
       <ci>O</ci>
       <apply>
        <divide></divide>
        <cn type="integer">1</cn>
        <ci>n</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n!=e^{y}\sqrt{n}\left(\frac{n}{e}\right)^{n}\left(1+O\left(\frac{1}{n}\right)%
\right).
  </annotation>
 </semantics>
</math>

</p>

<p>The quantity <em>e</em><sup><em>y</em></sup> can be found by taking the limit on both sides as <em>n</em> tends to infinity and using <a href="Wallis_product" title="wikilink">Wallis' product</a>, which shows that 

<math display="inline" id="Stirling's_approximation:11">
 <semantics>
  <mrow>
   <msup>
    <mi>e</mi>
    <mi>y</mi>
   </msup>
   <mo>=</mo>
   <msqrt>
    <mrow>
     <mn>2</mn>
     <mi>π</mi>
    </mrow>
   </msqrt>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>e</ci>
     <ci>y</ci>
    </apply>
    <apply>
     <root></root>
     <apply>
      <times></times>
      <cn type="integer">2</cn>
      <ci>π</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   e^{y}=\sqrt{2\pi}
  </annotation>
 </semantics>
</math>

. Therefore, we get Stirling's formula:</p>

<p>

<math display="block" id="Stirling's_approximation:12">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>n</mi>
     <mo lspace="0pt" rspace="3.5pt">!</mo>
    </mrow>
    <mo>=</mo>
    <mrow>
     <msqrt>
      <mrow>
       <mn>2</mn>
       <mi>π</mi>
       <mi>n</mi>
      </mrow>
     </msqrt>
     <msup>
      <mrow>
       <mo>(</mo>
       <mfrac>
        <mi>n</mi>
        <mi>e</mi>
       </mfrac>
       <mo>)</mo>
      </mrow>
      <mi>n</mi>
     </msup>
     <mrow>
      <mo>(</mo>
      <mrow>
       <mn>1</mn>
       <mo>+</mo>
       <mrow>
        <mi>O</mi>
        <mrow>
         <mo>(</mo>
         <mfrac>
          <mn>1</mn>
          <mi>n</mi>
         </mfrac>
         <mo>)</mo>
        </mrow>
       </mrow>
      </mrow>
      <mo>)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <factorial></factorial>
     <ci>n</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <root></root>
      <apply>
       <times></times>
       <cn type="integer">2</cn>
       <ci>π</ci>
       <ci>n</ci>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <divide></divide>
       <ci>n</ci>
       <ci>e</ci>
      </apply>
      <ci>n</ci>
     </apply>
     <apply>
      <plus></plus>
      <cn type="integer">1</cn>
      <apply>
       <times></times>
       <ci>O</ci>
       <apply>
        <divide></divide>
        <cn type="integer">1</cn>
        <ci>n</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n!=\sqrt{2\pi n}\left(\frac{n}{e}\right)^{n}\left(1+O\left(\frac{1}{n}\right)%
\right).
  </annotation>
 </semantics>
</math>

</p>

<p>The formula may also be obtained by repeated <a href="integration_by_parts" title="wikilink">integration by parts</a>, and the leading term can be found through <a href="Laplace's_method" title="wikilink">Laplace's method</a>. Stirling's formula, without the factor 

<math display="inline" id="Stirling's_approximation:13">
 <semantics>
  <msqrt>
   <mrow>
    <mn>2</mn>
    <mi>π</mi>
    <mi>n</mi>
   </mrow>
  </msqrt>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <root></root>
    <apply>
     <times></times>
     <cn type="integer">2</cn>
     <ci>π</ci>
     <ci>n</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \sqrt{2\pi n}
  </annotation>
 </semantics>
</math>

 that is often irrelevant in applications, can be quickly obtained by approximating the sum</p>

<p>

<math display="block" id="Stirling's_approximation:14">
 <semantics>
  <mrow>
   <mrow>
    <mi>ln</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>n</mi>
      <mo lspace="0pt" rspace="3.5pt">!</mo>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <munderover>
     <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
     <mrow>
      <mi>j</mi>
      <mo>=</mo>
      <mn>1</mn>
     </mrow>
     <mi>n</mi>
    </munderover>
    <mrow>
     <mi>ln</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>j</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <ln></ln>
     <apply>
      <factorial></factorial>
      <ci>n</ci>
     </apply>
    </apply>
    <apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <apply>
        <eq></eq>
        <ci>j</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <ci>n</ci>
     </apply>
     <apply>
      <ln></ln>
      <ci>j</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \ln(n!)=\sum_{j=1}^{n}\ln(j)
  </annotation>
 </semantics>
</math>

</p>

<p>with an integral:</p>

<p>

<math display="block" id="Stirling's_approximation:15">
 <semantics>
  <mrow>
   <mrow>
    <munderover>
     <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
     <mrow>
      <mi>j</mi>
      <mo>=</mo>
      <mn>1</mn>
     </mrow>
     <mi>n</mi>
    </munderover>
    <mrow>
     <mi>ln</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>j</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>≈</mo>
   <mrow>
    <msubsup>
     <mo largeop="true" symmetric="true">∫</mo>
     <mn>1</mn>
     <mi>n</mi>
    </msubsup>
    <mrow>
     <mrow>
      <mi>ln</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>x</mi>
       <mo rspace="4.2pt" stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mi mathvariant="normal">d</mi>
     <mi>x</mi>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mrow>
      <mi>n</mi>
      <mrow>
       <mi>ln</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>n</mi>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
     </mrow>
     <mo>-</mo>
     <mi>n</mi>
    </mrow>
    <mo>+</mo>
    <mn>1.</mn>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <approx></approx>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <apply>
         <eq></eq>
         <ci>j</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <ci>n</ci>
      </apply>
      <apply>
       <ln></ln>
       <ci>j</ci>
      </apply>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <int></int>
        <cn type="integer">1</cn>
       </apply>
       <ci>n</ci>
      </apply>
      <apply>
       <times></times>
       <apply>
        <ln></ln>
        <ci>x</ci>
       </apply>
       <ci>normal-d</ci>
       <ci>x</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <plus></plus>
      <apply>
       <minus></minus>
       <apply>
        <times></times>
        <ci>n</ci>
        <apply>
         <ln></ln>
         <ci>n</ci>
        </apply>
       </apply>
       <ci>n</ci>
      </apply>
      <cn type="float">1.</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \sum_{j=1}^{n}\ln(j)\approx\int_{1}^{n}\ln(x)\,{\rm d}x=n\ln(n)-n+1.
  </annotation>
 </semantics>
</math>

</p>
<h2 id="an-alternative-derivation">An alternative derivation</h2>

<p>An alternative formula for 

<math display="inline" id="Stirling's_approximation:16">
 <semantics>
  <mrow>
   <mi>n</mi>
   <mo lspace="0pt" rspace="3.5pt">!</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <factorial></factorial>
    <ci>n</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n!
  </annotation>
 </semantics>
</math>

 using the <a href="Gamma_function" title="wikilink">Gamma function</a> is</p>

<p>

<math display="block" id="Stirling's_approximation:17">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>n</mi>
     <mo lspace="0pt" rspace="3.5pt">!</mo>
    </mrow>
    <mo>=</mo>
    <mrow>
     <msubsup>
      <mo largeop="true" symmetric="true">∫</mo>
      <mn>0</mn>
      <mi mathvariant="normal">∞</mi>
     </msubsup>
     <mrow>
      <msup>
       <mi>x</mi>
       <mi>n</mi>
      </msup>
      <msup>
       <mi>e</mi>
       <mrow>
        <mo>-</mo>
        <mi>x</mi>
       </mrow>
      </msup>
      <mi>d</mi>
      <mi>x</mi>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <factorial></factorial>
     <ci>n</ci>
    </apply>
    <apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <int></int>
       <cn type="integer">0</cn>
      </apply>
      <infinity></infinity>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>x</ci>
       <ci>n</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>e</ci>
       <apply>
        <minus></minus>
        <ci>x</ci>
       </apply>
      </apply>
      <ci>d</ci>
      <ci>x</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n!=\int_{0}^{\infty}x^{n}e^{-x}dx.
  </annotation>
 </semantics>
</math>

 (as can be seen by repeated integration by parts). Rewriting and changing variables 

<math display="inline" id="Stirling's_approximation:18">
 <semantics>
  <mrow>
   <mi>x</mi>
   <mo>=</mo>
   <mrow>
    <mi>n</mi>
    <mi>y</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>x</ci>
    <apply>
     <times></times>
     <ci>n</ci>
     <ci>y</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x=ny
  </annotation>
 </semantics>
</math>

 one gets</p>

<p>

<math display="block" id="Stirling's_approximation:19">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>n</mi>
     <mo lspace="0pt" rspace="3.5pt">!</mo>
    </mrow>
    <mo>=</mo>
    <mrow>
     <msubsup>
      <mo largeop="true" symmetric="true">∫</mo>
      <mn>0</mn>
      <mi mathvariant="normal">∞</mi>
     </msubsup>
     <mrow>
      <msup>
       <mi>e</mi>
       <mrow>
        <mrow>
         <mi>n</mi>
         <mrow>
          <mi>ln</mi>
          <mi>x</mi>
         </mrow>
        </mrow>
        <mo>-</mo>
        <mi>x</mi>
       </mrow>
      </msup>
      <mi>d</mi>
      <mi>x</mi>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <msup>
      <mi>e</mi>
      <mrow>
       <mi>n</mi>
       <mrow>
        <mi>ln</mi>
        <mi>n</mi>
       </mrow>
      </mrow>
     </msup>
     <mi>n</mi>
     <mrow>
      <msubsup>
       <mo largeop="true" symmetric="true">∫</mo>
       <mn>0</mn>
       <mi mathvariant="normal">∞</mi>
      </msubsup>
      <mrow>
       <msup>
        <mi>e</mi>
        <mrow>
         <mi>n</mi>
         <mrow>
          <mo stretchy="false">(</mo>
          <mrow>
           <mrow>
            <mi>ln</mi>
            <mi>y</mi>
           </mrow>
           <mo>-</mo>
           <mi>y</mi>
          </mrow>
          <mo stretchy="false">)</mo>
         </mrow>
        </mrow>
       </msup>
       <mi>d</mi>
       <mi>y</mi>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <factorial></factorial>
      <ci>n</ci>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <int></int>
        <cn type="integer">0</cn>
       </apply>
       <infinity></infinity>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>e</ci>
        <apply>
         <minus></minus>
         <apply>
          <times></times>
          <ci>n</ci>
          <apply>
           <ln></ln>
           <ci>x</ci>
          </apply>
         </apply>
         <ci>x</ci>
        </apply>
       </apply>
       <ci>d</ci>
       <ci>x</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>e</ci>
       <apply>
        <times></times>
        <ci>n</ci>
        <apply>
         <ln></ln>
         <ci>n</ci>
        </apply>
       </apply>
      </apply>
      <ci>n</ci>
      <apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <int></int>
         <cn type="integer">0</cn>
        </apply>
        <infinity></infinity>
       </apply>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>e</ci>
         <apply>
          <times></times>
          <ci>n</ci>
          <apply>
           <minus></minus>
           <apply>
            <ln></ln>
            <ci>y</ci>
           </apply>
           <ci>y</ci>
          </apply>
         </apply>
        </apply>
        <ci>d</ci>
        <ci>y</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n!=\int_{0}^{\infty}e^{n\ln x-x}dx=e^{n\ln n}n\int_{0}^{\infty}e^{n(\ln y-y)}dy.
  </annotation>
 </semantics>
</math>

 Applying <a href="Laplace's_method" title="wikilink">Laplace's method</a> we have:</p>

<p>

<math display="block" id="Stirling's_approximation:20">
 <semantics>
  <mrow>
   <mrow>
    <msubsup>
     <mo largeop="true" symmetric="true">∫</mo>
     <mn>0</mn>
     <mi mathvariant="normal">∞</mi>
    </msubsup>
    <mrow>
     <msup>
      <mi>e</mi>
      <mrow>
       <mi>n</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mrow>
          <mi>ln</mi>
          <mi>y</mi>
         </mrow>
         <mo>-</mo>
         <mi>y</mi>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
     </msup>
     <mi>d</mi>
     <mi>y</mi>
    </mrow>
   </mrow>
   <mo>∼</mo>
   <mrow>
    <msqrt>
     <mfrac>
      <mrow>
       <mn>2</mn>
       <mi>π</mi>
      </mrow>
      <mi>n</mi>
     </mfrac>
    </msqrt>
    <msup>
     <mi>e</mi>
     <mrow>
      <mo>-</mo>
      <mi>n</mi>
     </mrow>
    </msup>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">similar-to</csymbol>
    <apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <int></int>
       <cn type="integer">0</cn>
      </apply>
      <infinity></infinity>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>e</ci>
       <apply>
        <times></times>
        <ci>n</ci>
        <apply>
         <minus></minus>
         <apply>
          <ln></ln>
          <ci>y</ci>
         </apply>
         <ci>y</ci>
        </apply>
       </apply>
      </apply>
      <ci>d</ci>
      <ci>y</ci>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <root></root>
      <apply>
       <divide></divide>
       <apply>
        <times></times>
        <cn type="integer">2</cn>
        <ci>π</ci>
       </apply>
       <ci>n</ci>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>e</ci>
      <apply>
       <minus></minus>
       <ci>n</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \int_{0}^{\infty}e^{n(\ln y-y)}dy\sim\sqrt{\frac{2\pi}{n}}e^{-n}
  </annotation>
 </semantics>
</math>

 which recovers the Stirling's formula,</p>

<p>

<math display="block" id="Stirling's_approximation:21">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>n</mi>
     <mo lspace="0pt" rspace="3.5pt">!</mo>
    </mrow>
    <mo>∼</mo>
    <mrow>
     <msup>
      <mi>e</mi>
      <mrow>
       <mi>n</mi>
       <mrow>
        <mi>ln</mi>
        <mi>n</mi>
       </mrow>
      </mrow>
     </msup>
     <mi>n</mi>
     <msqrt>
      <mfrac>
       <mrow>
        <mn>2</mn>
        <mi>π</mi>
       </mrow>
       <mi>n</mi>
      </mfrac>
     </msqrt>
     <msup>
      <mi>e</mi>
      <mrow>
       <mo>-</mo>
       <mi>n</mi>
      </mrow>
     </msup>
    </mrow>
    <mo>=</mo>
    <mrow>
     <msqrt>
      <mrow>
       <mn>2</mn>
       <mi>π</mi>
       <mi>n</mi>
      </mrow>
     </msqrt>
     <msup>
      <mrow>
       <mo>(</mo>
       <mfrac>
        <mi>n</mi>
        <mi>e</mi>
       </mfrac>
       <mo>)</mo>
      </mrow>
      <mi>n</mi>
     </msup>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <csymbol cd="latexml">similar-to</csymbol>
     <apply>
      <factorial></factorial>
      <ci>n</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>e</ci>
       <apply>
        <times></times>
        <ci>n</ci>
        <apply>
         <ln></ln>
         <ci>n</ci>
        </apply>
       </apply>
      </apply>
      <ci>n</ci>
      <apply>
       <root></root>
       <apply>
        <divide></divide>
        <apply>
         <times></times>
         <cn type="integer">2</cn>
         <ci>π</ci>
        </apply>
        <ci>n</ci>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>e</ci>
       <apply>
        <minus></minus>
        <ci>n</ci>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <apply>
       <root></root>
       <apply>
        <times></times>
        <cn type="integer">2</cn>
        <ci>π</ci>
        <ci>n</ci>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <divide></divide>
        <ci>n</ci>
        <ci>e</ci>
       </apply>
       <ci>n</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n!\sim e^{n\ln n}n\sqrt{\frac{2\pi}{n}}e^{-n}=\sqrt{2\pi n}\left(\frac{n}{e}%
\right)^{n}.
  </annotation>
 </semantics>
</math>

 In fact further corrections can also be obtained using Laplace's method. For example, computing two-order expansion using Laplace's method yields</p>

<p>

<math display="block" id="Stirling's_approximation:22">
 <semantics>
  <mrow>
   <mrow>
    <msubsup>
     <mo largeop="true" symmetric="true">∫</mo>
     <mn>0</mn>
     <mi mathvariant="normal">∞</mi>
    </msubsup>
    <mrow>
     <msup>
      <mi>e</mi>
      <mrow>
       <mi>n</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mrow>
          <mi>ln</mi>
          <mi>y</mi>
         </mrow>
         <mo>-</mo>
         <mi>y</mi>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
     </msup>
     <mi>d</mi>
     <mi>y</mi>
    </mrow>
   </mrow>
   <mo>∼</mo>
   <mrow>
    <msqrt>
     <mfrac>
      <mrow>
       <mn>2</mn>
       <mi>π</mi>
      </mrow>
      <mi>n</mi>
     </mfrac>
    </msqrt>
    <msup>
     <mi>e</mi>
     <mrow>
      <mo>-</mo>
      <mi>n</mi>
     </mrow>
    </msup>
    <mrow>
     <mo>(</mo>
     <mrow>
      <mn>1</mn>
      <mo>+</mo>
      <mfrac>
       <mn>1</mn>
       <mrow>
        <mn>12</mn>
        <mi>n</mi>
       </mrow>
      </mfrac>
     </mrow>
     <mo>)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">similar-to</csymbol>
    <apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <int></int>
       <cn type="integer">0</cn>
      </apply>
      <infinity></infinity>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>e</ci>
       <apply>
        <times></times>
        <ci>n</ci>
        <apply>
         <minus></minus>
         <apply>
          <ln></ln>
          <ci>y</ci>
         </apply>
         <ci>y</ci>
        </apply>
       </apply>
      </apply>
      <ci>d</ci>
      <ci>y</ci>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <root></root>
      <apply>
       <divide></divide>
       <apply>
        <times></times>
        <cn type="integer">2</cn>
        <ci>π</ci>
       </apply>
       <ci>n</ci>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>e</ci>
      <apply>
       <minus></minus>
       <ci>n</ci>
      </apply>
     </apply>
     <apply>
      <plus></plus>
      <cn type="integer">1</cn>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <apply>
        <times></times>
        <cn type="integer">12</cn>
        <ci>n</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \int_{0}^{\infty}e^{n(\ln y-y)}dy\sim\sqrt{\frac{2\pi}{n}}e^{-n}\left(1+\frac{%
1}{12n}\right)
  </annotation>
 </semantics>
</math>

 and gives Stirling's formula to two orders,</p>

<p>

<math display="block" id="Stirling's_approximation:23">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>n</mi>
     <mo lspace="0pt" rspace="3.5pt">!</mo>
    </mrow>
    <mo>∼</mo>
    <mrow>
     <msup>
      <mi>e</mi>
      <mrow>
       <mi>n</mi>
       <mrow>
        <mi>ln</mi>
        <mi>n</mi>
       </mrow>
      </mrow>
     </msup>
     <mi>n</mi>
     <msqrt>
      <mfrac>
       <mrow>
        <mn>2</mn>
        <mi>π</mi>
       </mrow>
       <mi>n</mi>
      </mfrac>
     </msqrt>
     <msup>
      <mi>e</mi>
      <mrow>
       <mo>-</mo>
       <mi>n</mi>
      </mrow>
     </msup>
     <mrow>
      <mo>(</mo>
      <mrow>
       <mn>1</mn>
       <mo>+</mo>
       <mfrac>
        <mn>1</mn>
        <mrow>
         <mn>12</mn>
         <mi>n</mi>
        </mrow>
       </mfrac>
      </mrow>
      <mo>)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <msqrt>
      <mrow>
       <mn>2</mn>
       <mi>π</mi>
       <mi>n</mi>
      </mrow>
     </msqrt>
     <msup>
      <mrow>
       <mo>(</mo>
       <mfrac>
        <mi>n</mi>
        <mi>e</mi>
       </mfrac>
       <mo>)</mo>
      </mrow>
      <mi>n</mi>
     </msup>
     <mrow>
      <mo>(</mo>
      <mrow>
       <mn>1</mn>
       <mo>+</mo>
       <mfrac>
        <mn>1</mn>
        <mrow>
         <mn>12</mn>
         <mi>n</mi>
        </mrow>
       </mfrac>
      </mrow>
      <mo>)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <csymbol cd="latexml">similar-to</csymbol>
     <apply>
      <factorial></factorial>
      <ci>n</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>e</ci>
       <apply>
        <times></times>
        <ci>n</ci>
        <apply>
         <ln></ln>
         <ci>n</ci>
        </apply>
       </apply>
      </apply>
      <ci>n</ci>
      <apply>
       <root></root>
       <apply>
        <divide></divide>
        <apply>
         <times></times>
         <cn type="integer">2</cn>
         <ci>π</ci>
        </apply>
        <ci>n</ci>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>e</ci>
       <apply>
        <minus></minus>
        <ci>n</ci>
       </apply>
      </apply>
      <apply>
       <plus></plus>
       <cn type="integer">1</cn>
       <apply>
        <divide></divide>
        <cn type="integer">1</cn>
        <apply>
         <times></times>
         <cn type="integer">12</cn>
         <ci>n</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <apply>
       <root></root>
       <apply>
        <times></times>
        <cn type="integer">2</cn>
        <ci>π</ci>
        <ci>n</ci>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <divide></divide>
        <ci>n</ci>
        <ci>e</ci>
       </apply>
       <ci>n</ci>
      </apply>
      <apply>
       <plus></plus>
       <cn type="integer">1</cn>
       <apply>
        <divide></divide>
        <cn type="integer">1</cn>
        <apply>
         <times></times>
         <cn type="integer">12</cn>
         <ci>n</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n!\sim e^{n\ln n}n\sqrt{\frac{2\pi}{n}}e^{-n}\left(1+\frac{1}{12n}\right)=%
\sqrt{2\pi n}\left(\frac{n}{e}\right)^{n}\left(1+\frac{1}{12n}\right).
  </annotation>
 </semantics>
</math>

</p>
<h2 id="speed-of-convergence-and-error-estimates">Speed of convergence and error estimates</h2>
<figure><b>(Figure)</b>
<figcaption>The relative error in a truncated Stirling series vs. <em>n</em>, for 1 to 5 terms</figcaption>
</figure>

<p>Stirling's formula is in fact the first approximation to the following series (now called the <strong>Stirling series</strong>):</p>

<p>

<math display="inline" id="Stirling's_approximation:24">
 <semantics>
  <mrow>
   <mi>n</mi>
   <mo lspace="0pt" rspace="3.5pt">!</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <factorial></factorial>
    <ci>n</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle n!
  </annotation>
 </semantics>
</math>


</p>

<p>An explicit formula for the coefficients in this series was given by G. Nemes.<a class="footnoteRef" href="#fn4" id="fnref4"><sup>4</sup></a> The first graph in this section shows the <a href="Approximation_error" title="wikilink">relative error</a> vs. <em>n</em>, for 1 through all 5 terms listed above.</p>
<figure><b>(Figure)</b>
<figcaption>The relative error in a truncated Stirling series vs. the number of terms used</figcaption>
</figure>

<p>As <em>n</em> → ∞, the error in the truncated series is asymptotically equal to the first omitted term. This is an example of an <a href="asymptotic_expansion" title="wikilink">asymptotic expansion</a>. It is not a <a href="convergent_series" title="wikilink">convergent series</a>; for any <em>particular</em> value of <em>n</em> there are only so many terms of the series that improve accuracy, after which point accuracy actually gets worse. This is shown in the next graph, which shows the relative error versus the number of terms in the series, for larger numbers of terms. More precisely, let <em>S</em>(<em>n</em>, <em>t</em>) be the Stirling series to <em>t</em> terms evaluated at <em>n</em>. The graphs show</p>

<p>

<math display="block" id="Stirling's_approximation:25">
 <semantics>
  <mrow>
   <mrow>
    <mo>|</mo>
    <mrow>
     <mi>ln</mi>
     <mrow>
      <mo>(</mo>
      <mfrac>
       <mrow>
        <mi>S</mi>
        <mrow>
         <mo stretchy="false">(</mo>
         <mi>n</mi>
         <mo>,</mo>
         <mi>t</mi>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
       <mrow>
        <mi>n</mi>
        <mo lspace="0pt" rspace="3.5pt">!</mo>
       </mrow>
      </mfrac>
      <mo>)</mo>
     </mrow>
    </mrow>
    <mo>|</mo>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <abs></abs>
    <apply>
     <ln></ln>
     <apply>
      <divide></divide>
      <apply>
       <times></times>
       <ci>S</ci>
       <interval closure="open">
        <ci>n</ci>
        <ci>t</ci>
       </interval>
      </apply>
      <apply>
       <factorial></factorial>
       <ci>n</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \left|\ln\left(\frac{S(n,t)}{n!}\right)\right|,
  </annotation>
 </semantics>
</math>

 which, when small, is essentially the relative error.</p>

<p>Writing Stirling's series in the form:</p>

<p>

<math display="inline" id="Stirling's_approximation:26">
 <semantics>
  <mrow>
   <mi>ln</mi>
   <mrow>
    <mi>n</mi>
    <mo lspace="0pt" rspace="3.5pt">!</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ln></ln>
    <apply>
     <factorial></factorial>
     <ci>n</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle\ln n!
  </annotation>
 </semantics>
</math>


</p>

<p>it is known that the error in truncating the series is always of the same sign and at most the same magnitude as the first omitted term.</p>

<p>It is also possible to give a version of Stirling's formula with bounds valid for all positive integers <em>n</em>, rather than asymptotics: one has</p>

<p>

<math display="block" id="Stirling's_approximation:27">
 <semantics>
  <mrow>
   <mrow>
    <mpadded width="+5pt">
     <msqrt>
      <mrow>
       <mn>2</mn>
       <mi>π</mi>
      </mrow>
     </msqrt>
    </mpadded>
    <msup>
     <mi>n</mi>
     <mrow>
      <mi>n</mi>
      <mo>+</mo>
      <mrow>
       <mn>1</mn>
       <mo>/</mo>
       <mn>2</mn>
      </mrow>
     </mrow>
    </msup>
    <msup>
     <mi>e</mi>
     <mrow>
      <mo>-</mo>
      <mi>n</mi>
     </mrow>
    </msup>
   </mrow>
   <mo>≤</mo>
   <mrow>
    <mi>n</mi>
    <mo lspace="0pt" rspace="3.5pt">!</mo>
   </mrow>
   <mo>≤</mo>
   <mrow>
    <mpadded width="+5pt">
     <mi>e</mi>
    </mpadded>
    <msup>
     <mi>n</mi>
     <mrow>
      <mi>n</mi>
      <mo>+</mo>
      <mrow>
       <mn>1</mn>
       <mo>/</mo>
       <mn>2</mn>
      </mrow>
     </mrow>
    </msup>
    <msup>
     <mi>e</mi>
     <mrow>
      <mo>-</mo>
      <mi>n</mi>
     </mrow>
    </msup>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <leq></leq>
     <apply>
      <times></times>
      <apply>
       <root></root>
       <apply>
        <times></times>
        <cn type="integer">2</cn>
        <ci>π</ci>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>n</ci>
       <apply>
        <plus></plus>
        <ci>n</ci>
        <apply>
         <divide></divide>
         <cn type="integer">1</cn>
         <cn type="integer">2</cn>
        </apply>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>e</ci>
       <apply>
        <minus></minus>
        <ci>n</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <factorial></factorial>
      <ci>n</ci>
     </apply>
    </apply>
    <apply>
     <leq></leq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <ci>e</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>n</ci>
       <apply>
        <plus></plus>
        <ci>n</ci>
        <apply>
         <divide></divide>
         <cn type="integer">1</cn>
         <cn type="integer">2</cn>
        </apply>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>e</ci>
       <apply>
        <minus></minus>
        <ci>n</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \sqrt{2\pi}\ n^{n+1/2}e^{-n}\leq n!\leq e\ n^{n+1/2}e^{-n}
  </annotation>
 </semantics>
</math>

</p>

<p>for all positive integers <em>n</em>. Thus the ratio 

<math display="inline" id="Stirling's_approximation:28">
 <semantics>
  <mfrac>
   <mrow>
    <mi>n</mi>
    <mo lspace="0pt" rspace="3.5pt">!</mo>
   </mrow>
   <mrow>
    <msup>
     <mi>n</mi>
     <mrow>
      <mi>n</mi>
      <mo>+</mo>
      <mrow>
       <mn>1</mn>
       <mo>/</mo>
       <mn>2</mn>
      </mrow>
     </mrow>
    </msup>
    <msup>
     <mi>e</mi>
     <mrow>
      <mo>-</mo>
      <mi>n</mi>
     </mrow>
    </msup>
   </mrow>
  </mfrac>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <divide></divide>
    <apply>
     <factorial></factorial>
     <ci>n</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>n</ci>
      <apply>
       <plus></plus>
       <ci>n</ci>
       <apply>
        <divide></divide>
        <cn type="integer">1</cn>
        <cn type="integer">2</cn>
       </apply>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>e</ci>
      <apply>
       <minus></minus>
       <ci>n</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \frac{n!}{n^{n+1/2}e^{-n}}
  </annotation>
 </semantics>
</math>

 is always between 

<math display="inline" id="Stirling's_approximation:29">
 <semantics>
  <mrow>
   <msqrt>
    <mrow>
     <mn>2</mn>
     <mi>π</mi>
    </mrow>
   </msqrt>
   <mo>=</mo>
   <mrow>
    <mn>2.5066</mn>
    <mi mathvariant="normal">…</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <root></root>
     <apply>
      <times></times>
      <cn type="integer">2</cn>
      <ci>π</ci>
     </apply>
    </apply>
    <apply>
     <times></times>
     <cn type="float">2.5066</cn>
     <ci>normal-…</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \sqrt{2\pi}=2.5066\ldots
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Stirling's_approximation:30">
 <semantics>
  <mrow>
   <mi>e</mi>
   <mo>=</mo>
   <mrow>
    <mn>2.71828</mn>
    <mi mathvariant="normal">…</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>e</ci>
    <apply>
     <times></times>
     <cn type="float">2.71828</cn>
     <ci>normal-…</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   e=2.71828\ldots
  </annotation>
 </semantics>
</math>

.</p>
<h2 id="stirlings-formula-for-the-gamma-function">Stirling's formula for the gamma function</h2>

<p>For all positive integers,</p>

<p>

<math display="block" id="Stirling's_approximation:31">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>n</mi>
     <mo lspace="0pt" rspace="3.5pt">!</mo>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mi mathvariant="normal">Γ</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mi>n</mi>
       <mo>+</mo>
       <mn>1</mn>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <factorial></factorial>
     <ci>n</ci>
    </apply>
    <apply>
     <times></times>
     <ci>normal-Γ</ci>
     <apply>
      <plus></plus>
      <ci>n</ci>
      <cn type="integer">1</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n!=\Gamma(n+1),
  </annotation>
 </semantics>
</math>

</p>

<p>where Γ denotes the <a href="gamma_function" title="wikilink">gamma function</a>.</p>

<p>However, the gamma function, unlike the factorial, is more broadly defined for all complex numbers other than non-positive integers; nevertheless, Stirling's formula may still be applied. If Re(<em>z</em>) &gt; 0 then</p>

<p>

<math display="block" id="Stirling's_approximation:32">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mrow>
      <mi>ln</mi>
      <mi mathvariant="normal">Γ</mi>
     </mrow>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>z</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mrow>
       <mi>z</mi>
       <mrow>
        <mi>ln</mi>
        <mi>z</mi>
       </mrow>
      </mrow>
      <mo>-</mo>
      <mi>z</mi>
     </mrow>
     <mo>+</mo>
     <mrow>
      <mfrac>
       <mn>1</mn>
       <mn>2</mn>
      </mfrac>
      <mrow>
       <mi>ln</mi>
       <mfrac>
        <mrow>
         <mn>2</mn>
         <mi>π</mi>
        </mrow>
        <mi>z</mi>
       </mfrac>
      </mrow>
     </mrow>
     <mo>+</mo>
     <mrow>
      <msubsup>
       <mo largeop="true" symmetric="true">∫</mo>
       <mn>0</mn>
       <mi mathvariant="normal">∞</mi>
      </msubsup>
      <mrow>
       <mpadded width="+1.7pt">
        <mfrac>
         <mrow>
          <mn>2</mn>
          <mrow>
           <mi>arctan</mi>
           <mrow>
            <mo stretchy="false">(</mo>
            <mfrac>
             <mi>t</mi>
             <mi>z</mi>
            </mfrac>
            <mo stretchy="false">)</mo>
           </mrow>
          </mrow>
         </mrow>
         <mrow>
          <msup>
           <mi>e</mi>
           <mrow>
            <mn>2</mn>
            <mi>π</mi>
            <mi>t</mi>
           </mrow>
          </msup>
          <mo>-</mo>
          <mn>1</mn>
         </mrow>
        </mfrac>
       </mpadded>
       <mi mathvariant="normal">d</mi>
       <mi>t</mi>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <ln></ln>
      <ci>normal-Γ</ci>
     </apply>
     <ci>z</ci>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <minus></minus>
      <apply>
       <times></times>
       <ci>z</ci>
       <apply>
        <ln></ln>
        <ci>z</ci>
       </apply>
      </apply>
      <ci>z</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <ln></ln>
       <apply>
        <divide></divide>
        <apply>
         <times></times>
         <cn type="integer">2</cn>
         <ci>π</ci>
        </apply>
        <ci>z</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <int></int>
        <cn type="integer">0</cn>
       </apply>
       <infinity></infinity>
      </apply>
      <apply>
       <times></times>
       <apply>
        <divide></divide>
        <apply>
         <times></times>
         <cn type="integer">2</cn>
         <apply>
          <arctan></arctan>
          <apply>
           <divide></divide>
           <ci>t</ci>
           <ci>z</ci>
          </apply>
         </apply>
        </apply>
        <apply>
         <minus></minus>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>e</ci>
          <apply>
           <times></times>
           <cn type="integer">2</cn>
           <ci>π</ci>
           <ci>t</ci>
          </apply>
         </apply>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <ci>normal-d</ci>
       <ci>t</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \ln\Gamma(z)=z\ln z-z+\frac{1}{2}\ln\frac{2\pi}{z}+\int_{0}^{\infty}\frac{2%
\arctan(\frac{t}{z})}{e^{2\pi t}-1}\,{\rm d}t.
  </annotation>
 </semantics>
</math>

</p>

<p>Repeated integration by parts gives</p>

<p>

<math display="block" id="Stirling's_approximation:33">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>ln</mi>
     <mi mathvariant="normal">Γ</mi>
    </mrow>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>z</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>∼</mo>
   <mrow>
    <mrow>
     <mrow>
      <mi>z</mi>
      <mrow>
       <mi>ln</mi>
       <mi>z</mi>
      </mrow>
     </mrow>
     <mo>-</mo>
     <mi>z</mi>
    </mrow>
    <mo>+</mo>
    <mrow>
     <mfrac>
      <mn>1</mn>
      <mn>2</mn>
     </mfrac>
     <mrow>
      <mi>ln</mi>
      <mfrac>
       <mrow>
        <mn>2</mn>
        <mi>π</mi>
       </mrow>
       <mi>z</mi>
      </mfrac>
     </mrow>
    </mrow>
    <mo>+</mo>
    <mrow>
     <munderover>
      <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
      <mrow>
       <mi>n</mi>
       <mo>=</mo>
       <mn>1</mn>
      </mrow>
      <mi mathvariant="normal">∞</mi>
     </munderover>
     <mfrac>
      <msub>
       <mi>B</mi>
       <mrow>
        <mn>2</mn>
        <mi>n</mi>
       </mrow>
      </msub>
      <mrow>
       <mn>2</mn>
       <mi>n</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mrow>
          <mn>2</mn>
          <mi>n</mi>
         </mrow>
         <mo>-</mo>
         <mn>1</mn>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
       <msup>
        <mi>z</mi>
        <mrow>
         <mrow>
          <mn>2</mn>
          <mi>n</mi>
         </mrow>
         <mo>-</mo>
         <mn>1</mn>
        </mrow>
       </msup>
      </mrow>
     </mfrac>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">similar-to</csymbol>
    <apply>
     <times></times>
     <apply>
      <ln></ln>
      <ci>normal-Γ</ci>
     </apply>
     <ci>z</ci>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <minus></minus>
      <apply>
       <times></times>
       <ci>z</ci>
       <apply>
        <ln></ln>
        <ci>z</ci>
       </apply>
      </apply>
      <ci>z</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <ln></ln>
       <apply>
        <divide></divide>
        <apply>
         <times></times>
         <cn type="integer">2</cn>
         <ci>π</ci>
        </apply>
        <ci>z</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <apply>
         <eq></eq>
         <ci>n</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <infinity></infinity>
      </apply>
      <apply>
       <divide></divide>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>B</ci>
        <apply>
         <times></times>
         <cn type="integer">2</cn>
         <ci>n</ci>
        </apply>
       </apply>
       <apply>
        <times></times>
        <cn type="integer">2</cn>
        <ci>n</ci>
        <apply>
         <minus></minus>
         <apply>
          <times></times>
          <cn type="integer">2</cn>
          <ci>n</ci>
         </apply>
         <cn type="integer">1</cn>
        </apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>z</ci>
         <apply>
          <minus></minus>
          <apply>
           <times></times>
           <cn type="integer">2</cn>
           <ci>n</ci>
          </apply>
          <cn type="integer">1</cn>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \ln\Gamma(z)\sim z\ln z-z+\frac{1}{2}\ln\frac{2\pi}{z}+\sum_{n=1}^{\infty}%
\frac{B_{2n}}{2n(2n-1)z^{2n-1}}
  </annotation>
 </semantics>
</math>

</p>

<p>where <em>B<sub>n</sub></em> is the <em>n</em>-th <a href="Bernoulli_number" title="wikilink">Bernoulli number</a> (note that the infinite sum is not convergent, so this formula is just an <a href="asymptotic_expansion" title="wikilink">asymptotic expansion</a>). The formula is valid for <em>z</em> large enough in absolute value when |arg(<em>z</em>)| O(z^{-2m - 1}) when the first <em>m</em> terms are used. The corresponding approximation may now be written:</p>

<p>

<math display="block" id="Stirling's_approximation:34">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi mathvariant="normal">Γ</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>z</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mpadded width="+3.3pt">
      <msqrt>
       <mfrac>
        <mrow>
         <mn>2</mn>
         <mi>π</mi>
        </mrow>
        <mi>z</mi>
       </mfrac>
      </msqrt>
     </mpadded>
     <msup>
      <mrow>
       <mo>(</mo>
       <mfrac>
        <mi>z</mi>
        <mi>e</mi>
       </mfrac>
       <mo>)</mo>
      </mrow>
      <mi>z</mi>
     </msup>
     <mrow>
      <mo>(</mo>
      <mrow>
       <mn>1</mn>
       <mo>+</mo>
       <mrow>
        <mi>O</mi>
        <mrow>
         <mo>(</mo>
         <mfrac>
          <mn>1</mn>
          <mi>z</mi>
         </mfrac>
         <mo>)</mo>
        </mrow>
       </mrow>
      </mrow>
      <mo>)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>normal-Γ</ci>
     <ci>z</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <root></root>
      <apply>
       <divide></divide>
       <apply>
        <times></times>
        <cn type="integer">2</cn>
        <ci>π</ci>
       </apply>
       <ci>z</ci>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <divide></divide>
       <ci>z</ci>
       <ci>e</ci>
      </apply>
      <ci>z</ci>
     </apply>
     <apply>
      <plus></plus>
      <cn type="integer">1</cn>
      <apply>
       <times></times>
       <ci>O</ci>
       <apply>
        <divide></divide>
        <cn type="integer">1</cn>
        <ci>z</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Gamma(z)=\sqrt{\frac{2\pi}{z}}~{}{\left(\frac{z}{e}\right)}^{z}\left(1+O\left%
(\frac{1}{z}\right)\right).
  </annotation>
 </semantics>
</math>

</p>

<p>A further application of this asymptotic expansion is for complex argument <em>z</em> with constant Re(<em>z</em>). See for example the Stirling formula applied in Im(<em>z</em>) = <em>t</em> of the <a href="Riemann-Siegel_theta_function" title="wikilink">Riemann-Siegel theta function</a> on the straight line 1/4 + <em>it</em>.</p>
<h2 id="a-convergent-version-of-stirlings-formula">A convergent version of Stirling's formula</h2>

<p><a href="Thomas_Bayes" title="wikilink">Thomas Bayes</a> showed, in a letter to <a href="John_Canton" title="wikilink">John Canton</a> published by the <a href="Royal_Society" title="wikilink">Royal Society</a> in 1763, that Stirling's formula did not give a <a href="convergent_series" title="wikilink">convergent series</a>.<a class="footnoteRef" href="#fn5" id="fnref5"><sup>5</sup></a></p>

<p>Obtaining a convergent version of Stirling's formula entails evaluating</p>

<p>

<math display="block" id="Stirling's_approximation:35">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <msubsup>
      <mo largeop="true" symmetric="true">∫</mo>
      <mn>0</mn>
      <mi mathvariant="normal">∞</mi>
     </msubsup>
     <mrow>
      <mfrac>
       <mrow>
        <mn>2</mn>
        <mrow>
         <mi>arctan</mi>
         <mrow>
          <mo stretchy="false">(</mo>
          <mfrac>
           <mi>t</mi>
           <mi>x</mi>
          </mfrac>
          <mo stretchy="false">)</mo>
         </mrow>
        </mrow>
       </mrow>
       <mrow>
        <msup>
         <mi>e</mi>
         <mrow>
          <mn>2</mn>
          <mi>π</mi>
          <mi>t</mi>
         </mrow>
        </msup>
        <mo>-</mo>
        <mn>1</mn>
       </mrow>
      </mfrac>
      <mi>d</mi>
      <mi>t</mi>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mrow>
       <mrow>
        <mrow>
         <mi>ln</mi>
         <mi mathvariant="normal">Γ</mi>
        </mrow>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <mn>1</mn>
          <mo>+</mo>
          <mi>x</mi>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
       <mo>-</mo>
       <mrow>
        <mi>x</mi>
        <mrow>
         <mi>ln</mi>
         <mi>x</mi>
        </mrow>
       </mrow>
      </mrow>
      <mo>+</mo>
      <mi>x</mi>
     </mrow>
     <mo>-</mo>
     <mrow>
      <mfrac>
       <mn>1</mn>
       <mn>2</mn>
      </mfrac>
      <mrow>
       <mi>ln</mi>
       <mrow>
        <mn>2</mn>
        <mi>π</mi>
        <mi>x</mi>
       </mrow>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <int></int>
       <cn type="integer">0</cn>
      </apply>
      <infinity></infinity>
     </apply>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <apply>
        <times></times>
        <cn type="integer">2</cn>
        <apply>
         <arctan></arctan>
         <apply>
          <divide></divide>
          <ci>t</ci>
          <ci>x</ci>
         </apply>
        </apply>
       </apply>
       <apply>
        <minus></minus>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>e</ci>
         <apply>
          <times></times>
          <cn type="integer">2</cn>
          <ci>π</ci>
          <ci>t</ci>
         </apply>
        </apply>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <ci>d</ci>
      <ci>t</ci>
     </apply>
    </apply>
    <apply>
     <minus></minus>
     <apply>
      <plus></plus>
      <apply>
       <minus></minus>
       <apply>
        <times></times>
        <apply>
         <ln></ln>
         <ci>normal-Γ</ci>
        </apply>
        <apply>
         <plus></plus>
         <cn type="integer">1</cn>
         <ci>x</ci>
        </apply>
       </apply>
       <apply>
        <times></times>
        <ci>x</ci>
        <apply>
         <ln></ln>
         <ci>x</ci>
        </apply>
       </apply>
      </apply>
      <ci>x</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <ln></ln>
       <apply>
        <times></times>
        <cn type="integer">2</cn>
        <ci>π</ci>
        <ci>x</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \int_{0}^{\infty}\frac{2\arctan(\frac{t}{x})}{e^{2\pi t}-1}dt=\ln\Gamma(1+x)-x%
\ln x+x-\frac{1}{2}\ln 2\pi x.
  </annotation>
 </semantics>
</math>

</p>

<p>One way to do this is by means of a convergent series of inverted <a href="Pochhammer_symbol#Alternate_notations" title="wikilink">rising exponentials</a>. If</p>

<p>

<math display="block" id="Stirling's_approximation:36">
 <semantics>
  <mrow>
   <mrow>
    <msup>
     <mi>z</mi>
     <mover accent="true">
      <mi>n</mi>
      <mo stretchy="false">¯</mo>
     </mover>
    </msup>
    <mo>=</mo>
    <mrow>
     <mi>z</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mi>z</mi>
       <mo>+</mo>
       <mn>1</mn>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <mi mathvariant="normal">⋯</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mrow>
        <mi>z</mi>
        <mo>+</mo>
        <mi>n</mi>
       </mrow>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>;</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>z</ci>
     <apply>
      <ci>normal-¯</ci>
      <ci>n</ci>
     </apply>
    </apply>
    <apply>
     <times></times>
     <ci>z</ci>
     <apply>
      <plus></plus>
      <ci>z</ci>
      <cn type="integer">1</cn>
     </apply>
     <ci>normal-⋯</ci>
     <apply>
      <minus></minus>
      <apply>
       <plus></plus>
       <ci>z</ci>
       <ci>n</ci>
      </apply>
      <cn type="integer">1</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   z^{\bar{n}}=z(z+1)\cdots(z+n-1);
  </annotation>
 </semantics>
</math>

</p>

<p>then</p>

<p>

<math display="block" id="Stirling's_approximation:37">
 <semantics>
  <mrow>
   <mrow>
    <msubsup>
     <mo largeop="true" symmetric="true">∫</mo>
     <mn>0</mn>
     <mi mathvariant="normal">∞</mi>
    </msubsup>
    <mrow>
     <mfrac>
      <mrow>
       <mn>2</mn>
       <mrow>
        <mi>arctan</mi>
        <mrow>
         <mo stretchy="false">(</mo>
         <mfrac>
          <mi>t</mi>
          <mi>x</mi>
         </mfrac>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
      </mrow>
      <mrow>
       <msup>
        <mi>e</mi>
        <mrow>
         <mn>2</mn>
         <mi>π</mi>
         <mi>t</mi>
        </mrow>
       </msup>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
     </mfrac>
     <mi>d</mi>
     <mi>t</mi>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <munderover>
     <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
     <mrow>
      <mi>n</mi>
      <mo>=</mo>
      <mn>1</mn>
     </mrow>
     <mi mathvariant="normal">∞</mi>
    </munderover>
    <mfrac>
     <msub>
      <mi>c</mi>
      <mi>n</mi>
     </msub>
     <msup>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mi>x</mi>
        <mo>+</mo>
        <mn>1</mn>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
      <mover accent="true">
       <mi>n</mi>
       <mo stretchy="false">¯</mo>
      </mover>
     </msup>
    </mfrac>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <int></int>
       <cn type="integer">0</cn>
      </apply>
      <infinity></infinity>
     </apply>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <apply>
        <times></times>
        <cn type="integer">2</cn>
        <apply>
         <arctan></arctan>
         <apply>
          <divide></divide>
          <ci>t</ci>
          <ci>x</ci>
         </apply>
        </apply>
       </apply>
       <apply>
        <minus></minus>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>e</ci>
         <apply>
          <times></times>
          <cn type="integer">2</cn>
          <ci>π</ci>
          <ci>t</ci>
         </apply>
        </apply>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <ci>d</ci>
      <ci>t</ci>
     </apply>
    </apply>
    <apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <apply>
        <eq></eq>
        <ci>n</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <infinity></infinity>
     </apply>
     <apply>
      <divide></divide>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>c</ci>
       <ci>n</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <plus></plus>
        <ci>x</ci>
        <cn type="integer">1</cn>
       </apply>
       <apply>
        <ci>normal-¯</ci>
        <ci>n</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \int_{0}^{\infty}\frac{2\arctan(\frac{t}{x})}{e^{2\pi t}-1}dt=\sum_{n=1}^{%
\infty}\frac{c_{n}}{(x+1)^{\bar{n}}}
  </annotation>
 </semantics>
</math>

</p>

<p>where</p>

<p>

<math display="block" id="Stirling's_approximation:38">
 <semantics>
  <mrow>
   <msub>
    <mi>c</mi>
    <mi>n</mi>
   </msub>
   <mo>=</mo>
   <mrow>
    <mfrac>
     <mn>1</mn>
     <mi>n</mi>
    </mfrac>
    <mrow>
     <msubsup>
      <mo largeop="true" symmetric="true">∫</mo>
      <mn>0</mn>
      <mn>1</mn>
     </msubsup>
     <mrow>
      <msup>
       <mi>x</mi>
       <mover accent="true">
        <mi>n</mi>
        <mo stretchy="false">¯</mo>
       </mover>
      </msup>
      <mrow>
       <mo>(</mo>
       <mrow>
        <mi>x</mi>
        <mo>-</mo>
        <mstyle displaystyle="false">
         <mfrac>
          <mn>1</mn>
          <mn>2</mn>
         </mfrac>
        </mstyle>
       </mrow>
       <mo rspace="4.2pt">)</mo>
      </mrow>
      <mi mathvariant="normal">d</mi>
      <mi>x</mi>
     </mrow>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mfrac>
     <mn>1</mn>
     <mrow>
      <mn>2</mn>
      <mi>n</mi>
     </mrow>
    </mfrac>
    <mrow>
     <munderover>
      <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
      <mrow>
       <mi>k</mi>
       <mo>=</mo>
       <mn>1</mn>
      </mrow>
      <mi>n</mi>
     </munderover>
     <mfrac>
      <mrow>
       <mi>k</mi>
       <mrow>
        <mo stretchy="false">|</mo>
        <mrow>
         <mi>s</mi>
         <mrow>
          <mo stretchy="false">(</mo>
          <mi>n</mi>
          <mo>,</mo>
          <mi>k</mi>
          <mo stretchy="false">)</mo>
         </mrow>
        </mrow>
        <mo stretchy="false">|</mo>
       </mrow>
      </mrow>
      <mrow>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mi>k</mi>
         <mo>+</mo>
         <mn>1</mn>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mi>k</mi>
         <mo>+</mo>
         <mn>2</mn>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
     </mfrac>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>c</ci>
      <ci>n</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <ci>n</ci>
      </apply>
      <apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <int></int>
         <cn type="integer">0</cn>
        </apply>
        <cn type="integer">1</cn>
       </apply>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>x</ci>
         <apply>
          <ci>normal-¯</ci>
          <ci>n</ci>
         </apply>
        </apply>
        <apply>
         <minus></minus>
         <ci>x</ci>
         <apply>
          <divide></divide>
          <cn type="integer">1</cn>
          <cn type="integer">2</cn>
         </apply>
        </apply>
        <ci>normal-d</ci>
        <ci>x</ci>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <apply>
        <times></times>
        <cn type="integer">2</cn>
        <ci>n</ci>
       </apply>
      </apply>
      <apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <sum></sum>
         <apply>
          <eq></eq>
          <ci>k</ci>
          <cn type="integer">1</cn>
         </apply>
        </apply>
        <ci>n</ci>
       </apply>
       <apply>
        <divide></divide>
        <apply>
         <times></times>
         <ci>k</ci>
         <apply>
          <abs></abs>
          <apply>
           <times></times>
           <ci>s</ci>
           <interval closure="open">
            <ci>n</ci>
            <ci>k</ci>
           </interval>
          </apply>
         </apply>
        </apply>
        <apply>
         <times></times>
         <apply>
          <plus></plus>
          <ci>k</ci>
          <cn type="integer">1</cn>
         </apply>
         <apply>
          <plus></plus>
          <ci>k</ci>
          <cn type="integer">2</cn>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   c_{n}=\frac{1}{n}\int_{0}^{1}x^{\bar{n}}\left(x-\tfrac{1}{2}\right)\,{\rm d}x=%
\frac{1}{2n}\sum_{k=1}^{n}\frac{k|s(n,k)|}{(k+1)(k+2)}
  </annotation>
 </semantics>
</math>

</p>

<p>where <em>s</em>(<em>n</em>, <em>k</em>) denotes the <a href="Stirling_numbers_of_the_first_kind" title="wikilink">Stirling numbers of the first kind</a>. From this we obtain a version of Stirling's series</p>

<p>

<math display="inline" id="Stirling's_approximation:39">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>ln</mi>
     <mi mathvariant="normal">Γ</mi>
    </mrow>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>x</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mrow>
      <mi>x</mi>
      <mrow>
       <mi>ln</mi>
       <mi>x</mi>
      </mrow>
     </mrow>
     <mo>-</mo>
     <mi>x</mi>
    </mrow>
    <mo>+</mo>
    <mrow>
     <mstyle displaystyle="true">
      <mfrac>
       <mn>1</mn>
       <mn>2</mn>
      </mfrac>
     </mstyle>
     <mrow>
      <mi>ln</mi>
      <mstyle displaystyle="true">
       <mfrac>
        <mrow>
         <mn>2</mn>
         <mi>π</mi>
        </mrow>
        <mi>x</mi>
       </mfrac>
      </mstyle>
     </mrow>
    </mrow>
    <mo>+</mo>
    <mstyle displaystyle="true">
     <mfrac>
      <mn>1</mn>
      <mrow>
       <mn>12</mn>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mi>x</mi>
         <mo>+</mo>
         <mn>1</mn>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
     </mfrac>
    </mstyle>
    <mo>+</mo>
    <mrow>
     <mstyle displaystyle="true">
      <mfrac>
       <mn>1</mn>
       <mrow>
        <mn>12</mn>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <mi>x</mi>
          <mo>+</mo>
          <mn>1</mn>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <mi>x</mi>
          <mo>+</mo>
          <mn>2</mn>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
      </mfrac>
     </mstyle>
     <mo>+</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <ln></ln>
      <ci>normal-Γ</ci>
     </apply>
     <ci>x</ci>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <minus></minus>
      <apply>
       <times></times>
       <ci>x</ci>
       <apply>
        <ln></ln>
        <ci>x</ci>
       </apply>
      </apply>
      <ci>x</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <ln></ln>
       <apply>
        <divide></divide>
        <apply>
         <times></times>
         <cn type="integer">2</cn>
         <ci>π</ci>
        </apply>
        <ci>x</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <divide></divide>
      <cn type="integer">1</cn>
      <apply>
       <times></times>
       <cn type="integer">12</cn>
       <apply>
        <plus></plus>
        <ci>x</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
     </apply>
     <apply>
      <csymbol cd="latexml">limit-from</csymbol>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <apply>
        <times></times>
        <cn type="integer">12</cn>
        <apply>
         <plus></plus>
         <ci>x</ci>
         <cn type="integer">1</cn>
        </apply>
        <apply>
         <plus></plus>
         <ci>x</ci>
         <cn type="integer">2</cn>
        </apply>
       </apply>
      </apply>
      <plus></plus>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle\ln\Gamma(x)=x\ln x-x+\frac{1}{2}\ln\frac{2\pi}{x}+\frac{1}{12(x+%
1)}+\frac{1}{12(x+1)(x+2)}+
  </annotation>
 </semantics>
</math>


</p>

<p>which converges when Re(<em>x</em>) &gt; 0.</p>
<h2 id="versions-suitable-for-calculators">Versions suitable for calculators</h2>

<p>The approximation:</p>

<p>

<math display="block" id="Stirling's_approximation:40">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi mathvariant="normal">Γ</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>z</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>≈</mo>
    <mrow>
     <msqrt>
      <mfrac>
       <mrow>
        <mn>2</mn>
        <mi>π</mi>
       </mrow>
       <mi>z</mi>
      </mfrac>
     </msqrt>
     <msup>
      <mrow>
       <mo>(</mo>
       <mrow>
        <mfrac>
         <mi>z</mi>
         <mi>e</mi>
        </mfrac>
        <msqrt>
         <mrow>
          <mrow>
           <mi>z</mi>
           <mrow>
            <mi>sinh</mi>
            <mfrac>
             <mn>1</mn>
             <mi>z</mi>
            </mfrac>
           </mrow>
          </mrow>
          <mo>+</mo>
          <mfrac>
           <mn>1</mn>
           <mrow>
            <mn>810</mn>
            <msup>
             <mi>z</mi>
             <mn>6</mn>
            </msup>
           </mrow>
          </mfrac>
         </mrow>
        </msqrt>
       </mrow>
       <mo>)</mo>
      </mrow>
      <mi>z</mi>
     </msup>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <approx></approx>
    <apply>
     <times></times>
     <ci>normal-Γ</ci>
     <ci>z</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <root></root>
      <apply>
       <divide></divide>
       <apply>
        <times></times>
        <cn type="integer">2</cn>
        <ci>π</ci>
       </apply>
       <ci>z</ci>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <times></times>
       <apply>
        <divide></divide>
        <ci>z</ci>
        <ci>e</ci>
       </apply>
       <apply>
        <root></root>
        <apply>
         <plus></plus>
         <apply>
          <times></times>
          <ci>z</ci>
          <apply>
           <sinh></sinh>
           <apply>
            <divide></divide>
            <cn type="integer">1</cn>
            <ci>z</ci>
           </apply>
          </apply>
         </apply>
         <apply>
          <divide></divide>
          <cn type="integer">1</cn>
          <apply>
           <times></times>
           <cn type="integer">810</cn>
           <apply>
            <csymbol cd="ambiguous">superscript</csymbol>
            <ci>z</ci>
            <cn type="integer">6</cn>
           </apply>
          </apply>
         </apply>
        </apply>
       </apply>
      </apply>
      <ci>z</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Gamma(z)\approx\sqrt{\frac{2\pi}{z}}\left(\frac{z}{e}\sqrt{z\sinh\frac{1}{z}+%
\frac{1}{810z^{6}}}\right)^{z},
  </annotation>
 </semantics>
</math>

</p>

<p>or equivalently,</p>

<p>

<math display="block" id="Stirling's_approximation:41">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mn>2</mn>
     <mrow>
      <mi>ln</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mi mathvariant="normal">Γ</mi>
        <mrow>
         <mo stretchy="false">(</mo>
         <mi>z</mi>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mrow>
    <mo>≈</mo>
    <mrow>
     <mrow>
      <mrow>
       <mi>ln</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mn>2</mn>
         <mi>π</mi>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
      <mo>-</mo>
      <mrow>
       <mi>ln</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>z</mi>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
     </mrow>
     <mo>+</mo>
     <mrow>
      <mi>z</mi>
      <mrow>
       <mo>(</mo>
       <mrow>
        <mrow>
         <mrow>
          <mn>2</mn>
          <mrow>
           <mi>ln</mi>
           <mrow>
            <mo stretchy="false">(</mo>
            <mi>z</mi>
            <mo stretchy="false">)</mo>
           </mrow>
          </mrow>
         </mrow>
         <mo>+</mo>
         <mrow>
          <mi>ln</mi>
          <mrow>
           <mo>(</mo>
           <mrow>
            <mrow>
             <mi>z</mi>
             <mrow>
              <mi>sinh</mi>
              <mfrac>
               <mn>1</mn>
               <mi>z</mi>
              </mfrac>
             </mrow>
            </mrow>
            <mo>+</mo>
            <mfrac>
             <mn>1</mn>
             <mrow>
              <mn>810</mn>
              <msup>
               <mi>z</mi>
               <mn>6</mn>
              </msup>
             </mrow>
            </mfrac>
           </mrow>
           <mo>)</mo>
          </mrow>
         </mrow>
        </mrow>
        <mo>-</mo>
        <mn>2</mn>
       </mrow>
       <mo>)</mo>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <approx></approx>
    <apply>
     <times></times>
     <cn type="integer">2</cn>
     <apply>
      <ln></ln>
      <apply>
       <times></times>
       <ci>normal-Γ</ci>
       <ci>z</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <minus></minus>
      <apply>
       <ln></ln>
       <apply>
        <times></times>
        <cn type="integer">2</cn>
        <ci>π</ci>
       </apply>
      </apply>
      <apply>
       <ln></ln>
       <ci>z</ci>
      </apply>
     </apply>
     <apply>
      <times></times>
      <ci>z</ci>
      <apply>
       <minus></minus>
       <apply>
        <plus></plus>
        <apply>
         <times></times>
         <cn type="integer">2</cn>
         <apply>
          <ln></ln>
          <ci>z</ci>
         </apply>
        </apply>
        <apply>
         <ln></ln>
         <apply>
          <plus></plus>
          <apply>
           <times></times>
           <ci>z</ci>
           <apply>
            <sinh></sinh>
            <apply>
             <divide></divide>
             <cn type="integer">1</cn>
             <ci>z</ci>
            </apply>
           </apply>
          </apply>
          <apply>
           <divide></divide>
           <cn type="integer">1</cn>
           <apply>
            <times></times>
            <cn type="integer">810</cn>
            <apply>
             <csymbol cd="ambiguous">superscript</csymbol>
             <ci>z</ci>
             <cn type="integer">6</cn>
            </apply>
           </apply>
          </apply>
         </apply>
        </apply>
       </apply>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   2\ln(\Gamma(z))\approx\ln(2\pi)-\ln(z)+z\left(2\ln(z)+\ln\left(z\sinh\frac{1}{%
z}+\frac{1}{810z^{6}}\right)-2\right),
  </annotation>
 </semantics>
</math>

</p>

<p>can be obtained by rearranging Stirling's extended formula and observing a coincidence between the resultant power series and the <a href="Taylor_series" title="wikilink">Taylor series</a> expansion of the <a href="hyperbolic_sine" title="wikilink">hyperbolic sine</a> function. This approximation is good to more than 8 decimal digits for <em>z</em> with a real part greater than 8. Robert H. Windschitl suggested it in 2002 for computing the Gamma function with fair accuracy on calculators with limited program or register memory.<a class="footnoteRef" href="#fn6" id="fnref6"><sup>6</sup></a></p>

<p>Gergő Nemes proposed in 2007 an approximation which gives the same number of exact digits as the Windschitl approximation but is much simpler:<a class="footnoteRef" href="#fn7" id="fnref7"><sup>7</sup></a></p>

<p>

<math display="block" id="Stirling's_approximation:42">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi mathvariant="normal">Γ</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>z</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>≈</mo>
    <mrow>
     <msqrt>
      <mfrac>
       <mrow>
        <mn>2</mn>
        <mi>π</mi>
       </mrow>
       <mi>z</mi>
      </mfrac>
     </msqrt>
     <msup>
      <mrow>
       <mo>(</mo>
       <mrow>
        <mfrac>
         <mn>1</mn>
         <mi>e</mi>
        </mfrac>
        <mrow>
         <mo>(</mo>
         <mrow>
          <mi>z</mi>
          <mo>+</mo>
          <mfrac>
           <mn>1</mn>
           <mrow>
            <mrow>
             <mn>12</mn>
             <mi>z</mi>
            </mrow>
            <mo>-</mo>
            <mfrac>
             <mn>1</mn>
             <mrow>
              <mn>10</mn>
              <mi>z</mi>
             </mrow>
            </mfrac>
           </mrow>
          </mfrac>
         </mrow>
         <mo>)</mo>
        </mrow>
       </mrow>
       <mo>)</mo>
      </mrow>
      <mi>z</mi>
     </msup>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <approx></approx>
    <apply>
     <times></times>
     <ci>normal-Γ</ci>
     <ci>z</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <root></root>
      <apply>
       <divide></divide>
       <apply>
        <times></times>
        <cn type="integer">2</cn>
        <ci>π</ci>
       </apply>
       <ci>z</ci>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <times></times>
       <apply>
        <divide></divide>
        <cn type="integer">1</cn>
        <ci>e</ci>
       </apply>
       <apply>
        <plus></plus>
        <ci>z</ci>
        <apply>
         <divide></divide>
         <cn type="integer">1</cn>
         <apply>
          <minus></minus>
          <apply>
           <times></times>
           <cn type="integer">12</cn>
           <ci>z</ci>
          </apply>
          <apply>
           <divide></divide>
           <cn type="integer">1</cn>
           <apply>
            <times></times>
            <cn type="integer">10</cn>
            <ci>z</ci>
           </apply>
          </apply>
         </apply>
        </apply>
       </apply>
      </apply>
      <ci>z</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Gamma(z)\approx\sqrt{\frac{2\pi}{z}}\left(\frac{1}{e}\left(z+\frac{1}{12z-%
\frac{1}{10z}}\right)\right)^{z},
  </annotation>
 </semantics>
</math>

</p>

<p>or equivalently,</p>

<p>

<math display="block" id="Stirling's_approximation:43">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>ln</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mi mathvariant="normal">Γ</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>z</mi>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>≈</mo>
    <mrow>
     <mrow>
      <mstyle displaystyle="false">
       <mfrac>
        <mn>1</mn>
        <mn>2</mn>
       </mfrac>
      </mstyle>
      <mrow>
       <mo>[</mo>
       <mrow>
        <mrow>
         <mi>ln</mi>
         <mrow>
          <mo stretchy="false">(</mo>
          <mrow>
           <mn>2</mn>
           <mi>π</mi>
          </mrow>
          <mo stretchy="false">)</mo>
         </mrow>
        </mrow>
        <mo>-</mo>
        <mrow>
         <mi>ln</mi>
         <mrow>
          <mo stretchy="false">(</mo>
          <mi>z</mi>
          <mo stretchy="false">)</mo>
         </mrow>
        </mrow>
       </mrow>
       <mo>]</mo>
      </mrow>
     </mrow>
     <mo>+</mo>
     <mrow>
      <mi>z</mi>
      <mrow>
       <mo>[</mo>
       <mrow>
        <mrow>
         <mi>ln</mi>
         <mrow>
          <mo>(</mo>
          <mrow>
           <mi>z</mi>
           <mo>+</mo>
           <mfrac>
            <mn>1</mn>
            <mrow>
             <mrow>
              <mn>12</mn>
              <mi>z</mi>
             </mrow>
             <mo>-</mo>
             <mfrac>
              <mn>1</mn>
              <mrow>
               <mn>10</mn>
               <mi>z</mi>
              </mrow>
             </mfrac>
            </mrow>
           </mfrac>
          </mrow>
          <mo>)</mo>
         </mrow>
        </mrow>
        <mo>-</mo>
        <mn>1</mn>
       </mrow>
       <mo>]</mo>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <approx></approx>
    <apply>
     <ln></ln>
     <apply>
      <times></times>
      <ci>normal-Γ</ci>
      <ci>z</ci>
     </apply>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <csymbol cd="latexml">delimited-[]</csymbol>
       <apply>
        <minus></minus>
        <apply>
         <ln></ln>
         <apply>
          <times></times>
          <cn type="integer">2</cn>
          <ci>π</ci>
         </apply>
        </apply>
        <apply>
         <ln></ln>
         <ci>z</ci>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <ci>z</ci>
      <apply>
       <csymbol cd="latexml">delimited-[]</csymbol>
       <apply>
        <minus></minus>
        <apply>
         <ln></ln>
         <apply>
          <plus></plus>
          <ci>z</ci>
          <apply>
           <divide></divide>
           <cn type="integer">1</cn>
           <apply>
            <minus></minus>
            <apply>
             <times></times>
             <cn type="integer">12</cn>
             <ci>z</ci>
            </apply>
            <apply>
             <divide></divide>
             <cn type="integer">1</cn>
             <apply>
              <times></times>
              <cn type="integer">10</cn>
              <ci>z</ci>
             </apply>
            </apply>
           </apply>
          </apply>
         </apply>
        </apply>
        <cn type="integer">1</cn>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \ln(\Gamma(z))\approx\tfrac{1}{2}\left[\ln(2\pi)-\ln(z)\right]+z\left[\ln\left%
(z+\frac{1}{12z-\frac{1}{10z}}\right)-1\right].
  </annotation>
 </semantics>
</math>

</p>

<p>An alternative approximation for  was also given by <a href="Srinivasa_Ramanujan" title="wikilink">Srinivasa Ramanujan</a> (<a href="Ramanujan's_lost_notebook#References" title="wikilink">Ramanujan 1988</a>)</p>

<p>

<math display="block" id="Stirling's_approximation:44">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>ln</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mi>n</mi>
       <mo lspace="0pt" rspace="3.5pt">!</mo>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>≈</mo>
    <mrow>
     <mrow>
      <mrow>
       <mi>n</mi>
       <mrow>
        <mi>ln</mi>
        <mrow>
         <mo stretchy="false">(</mo>
         <mi>n</mi>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
      </mrow>
      <mo>-</mo>
      <mi>n</mi>
     </mrow>
     <mo>+</mo>
     <mrow>
      <mstyle displaystyle="false">
       <mfrac>
        <mn>1</mn>
        <mn>6</mn>
       </mfrac>
      </mstyle>
      <mrow>
       <mi>ln</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mi>n</mi>
         <mrow>
          <mo stretchy="false">(</mo>
          <mrow>
           <mn>1</mn>
           <mo>+</mo>
           <mrow>
            <mn>4</mn>
            <mi>n</mi>
            <mrow>
             <mo stretchy="false">(</mo>
             <mrow>
              <mn>1</mn>
              <mo>+</mo>
              <mrow>
               <mn>2</mn>
               <mi>n</mi>
              </mrow>
             </mrow>
             <mo stretchy="false">)</mo>
            </mrow>
           </mrow>
          </mrow>
          <mo stretchy="false">)</mo>
         </mrow>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
     </mrow>
     <mo>+</mo>
     <mrow>
      <mstyle displaystyle="false">
       <mfrac>
        <mn>1</mn>
        <mn>2</mn>
       </mfrac>
      </mstyle>
      <mrow>
       <mi>ln</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>π</mi>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <approx></approx>
    <apply>
     <ln></ln>
     <apply>
      <factorial></factorial>
      <ci>n</ci>
     </apply>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <minus></minus>
      <apply>
       <times></times>
       <ci>n</ci>
       <apply>
        <ln></ln>
        <ci>n</ci>
       </apply>
      </apply>
      <ci>n</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <cn type="integer">6</cn>
      </apply>
      <apply>
       <ln></ln>
       <apply>
        <times></times>
        <ci>n</ci>
        <apply>
         <plus></plus>
         <cn type="integer">1</cn>
         <apply>
          <times></times>
          <cn type="integer">4</cn>
          <ci>n</ci>
          <apply>
           <plus></plus>
           <cn type="integer">1</cn>
           <apply>
            <times></times>
            <cn type="integer">2</cn>
            <ci>n</ci>
           </apply>
          </apply>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <ln></ln>
       <ci>π</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \ln(n!)\approx n\ln(n)-n+\tfrac{1}{6}\ln(n(1+4n(1+2n)))+\tfrac{1}{2}\ln(\pi).
  </annotation>
 </semantics>
</math>

</p>
<h2 id="history">History</h2>

<p>The formula was first discovered by <a href="Abraham_de_Moivre" title="wikilink">Abraham de Moivre</a><a class="footnoteRef" href="#fn8" id="fnref8"><sup>8</sup></a> in the form</p>

<p>

<math display="block" id="Stirling's_approximation:45">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>n</mi>
     <mo lspace="0pt" rspace="3.5pt">!</mo>
    </mrow>
    <mo>∼</mo>
    <mrow>
     <mrow>
      <mrow>
       <mo stretchy="false">[</mo>
       <mi>constant</mi>
       <mo stretchy="false">]</mo>
      </mrow>
      <mo>⋅</mo>
      <msup>
       <mi>n</mi>
       <mrow>
        <mi>n</mi>
        <mo>+</mo>
        <mrow>
         <mn>1</mn>
         <mo>/</mo>
         <mn>2</mn>
        </mrow>
       </mrow>
      </msup>
     </mrow>
     <msup>
      <mi>e</mi>
      <mrow>
       <mo>-</mo>
       <mi>n</mi>
      </mrow>
     </msup>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">similar-to</csymbol>
    <apply>
     <factorial></factorial>
     <ci>n</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <ci>normal-⋅</ci>
      <apply>
       <csymbol cd="latexml">delimited-[]</csymbol>
       <ci>constant</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>n</ci>
       <apply>
        <plus></plus>
        <ci>n</ci>
        <apply>
         <divide></divide>
         <cn type="integer">1</cn>
         <cn type="integer">2</cn>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>e</ci>
      <apply>
       <minus></minus>
       <ci>n</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n!\sim[{\rm constant}]\cdot n^{n+1/2}e^{-n}.
  </annotation>
 </semantics>
</math>

</p>

<p>De Moivre gave an expression for the constant in terms of its natural logarithm. Stirling's contribution consisted of showing that the constant is 

<math display="inline" id="Stirling's_approximation:46">
 <semantics>
  <msqrt>
   <mrow>
    <mn>2</mn>
    <mi>π</mi>
   </mrow>
  </msqrt>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <root></root>
    <apply>
     <times></times>
     <cn type="integer">2</cn>
     <ci>π</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \sqrt{2\pi}
  </annotation>
 </semantics>
</math>

.<a class="footnoteRef" href="#fn9" id="fnref9"><sup>9</sup></a></p>
<h2 id="see-also">See also</h2>
<ul>
<li><a class="uri" href="Factorial" title="wikilink">Factorial</a></li>
<li><a href="Gamma_Function" title="wikilink">Gamma Function</a></li>
<li><a href="Lanczos_approximation" title="wikilink">Lanczos approximation</a></li>
<li><a href="Spouge's_approximation" title="wikilink">Spouge's approximation</a></li>
</ul>
<h2 id="notes">Notes</h2>
<h2 id="references">References</h2>
<ul>
<li></li>
<li></li>
<li></li>
<li></li>
<li>Dan Romik, <em>Stirling’s Approximation for n!: The Ultimate Short Proof?</em>, The American Mathematical Monthly, Vol. 107, No. 6 (Jun. – Jul., 2000), 556–557.</li>
<li>Y.-C. Li, <em>A Note on an Identity of The Gamma Function and Stirling’s Formula</em>, Real Analysis Exchang, Vol. 32(1), 2006/2007, pp. 267–272.</li>
</ul>
<h2 id="external-links">External links</h2>
<ul>
<li></li>
<li><a href="http://www.luschny.de/math/factorial/approx/SimpleCases.html">Peter Luschny, <em>Approximation formulas for the factorial function n!</em></a></li>
<li></li>
<li></li>
</ul>

<p>"</p>

<p><a class="uri" href="Category:Approximations" title="wikilink">Category:Approximations</a> <a href="Category:Asymptotic_analysis" title="wikilink">Category:Asymptotic analysis</a> <a href="Category:Analytic_number_theory" title="wikilink">Category:Analytic number theory</a> <a href="Category:Gamma_and_related_functions" title="wikilink">Category:Gamma and related functions</a> <a href="Category:Theorems_in_analysis" title="wikilink">Category:Theorems in analysis</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1"><a href="#fnref1">↩</a></li>
<li id="fn2">.<a href="#fnref2">↩</a></li>
<li id="fn3"><a href="#fnref3">↩</a></li>
<li id="fn4"><a href="#fnref4">↩</a></li>
<li id="fn5"><a class="uri" href="http://www.york.ac.uk/depts/maths/histstat/letter.pdf">http://www.york.ac.uk/depts/maths/histstat/letter.pdf</a><a href="#fnref5">↩</a></li>
<li id="fn6"><a href="http://www.rskey.org/gamma.htm">Toth, V. T. <em>Programmable Calculators: Calculators and the Gamma Function</em> (2006)</a><a href="#fnref6">↩</a></li>
<li id="fn7"><a href="#fnref7">↩</a></li>
<li id="fn8"></li>
<li id="fn9"></li>
</ol>
</section>
</body>
</html>

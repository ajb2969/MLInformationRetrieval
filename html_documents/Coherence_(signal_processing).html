<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="915">Coherence (signal processing)</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Coherence (signal processing)</h1>
<hr/>

<p>The <strong><a href="Frequency_domain" title="wikilink">spectral</a> coherence</strong> is a <a class="uri" href="statistic" title="wikilink">statistic</a> that can be used to examine the relation between two <a href="Signal_(electrical_engineering)" title="wikilink">signals</a> or <a class="uri" href="data" title="wikilink">data</a> sets. It is commonly used to estimate the <a href="Power_(physics)" title="wikilink">power</a> transfer between input and output of a <a href="linear_system" title="wikilink">linear system</a>. If the signals are <a href="Ergodic_process" title="wikilink">ergodic</a>, and the <a href="Transfer_function" title="wikilink">system function</a> <a href="Linear_system" title="wikilink">linear</a>, it can be used to <em>estimate</em> the <a class="uri" href="causality" title="wikilink">causality</a> between the input and output.</p>
<h2 id="definition-and-formulation">Definition and Formulation</h2>

<p>The <strong>coherence</strong> (sometimes called <strong>magnitude-squared coherence</strong>) between two signals x(t) and y(t) is a <a href="Real_number" title="wikilink">real</a>-valued function that is defined as:<a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a><a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a></p>
<dl>
<dd><dl>
<dd>

<math display="inline" id="Coherence_(signal_processing):0">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>C</mi>
     <mrow>
      <mi>x</mi>
      <mi>y</mi>
     </mrow>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>f</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mfrac>
    <msup>
     <mrow>
      <mo stretchy="false">|</mo>
      <mrow>
       <msub>
        <mi>G</mi>
        <mrow>
         <mi>x</mi>
         <mi>y</mi>
        </mrow>
       </msub>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>f</mi>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
      <mo stretchy="false">|</mo>
     </mrow>
     <mn>2</mn>
    </msup>
    <mrow>
     <msub>
      <mi>G</mi>
      <mrow>
       <mi>x</mi>
       <mi>x</mi>
      </mrow>
     </msub>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>f</mi>
      <mo stretchy="false">)</mo>
     </mrow>
     <msub>
      <mi>G</mi>
      <mrow>
       <mi>y</mi>
       <mi>y</mi>
      </mrow>
     </msub>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>f</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mfrac>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>C</ci>
      <apply>
       <times></times>
       <ci>x</ci>
       <ci>y</ci>
      </apply>
     </apply>
     <ci>f</ci>
    </apply>
    <apply>
     <divide></divide>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <abs></abs>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>G</ci>
         <apply>
          <times></times>
          <ci>x</ci>
          <ci>y</ci>
         </apply>
        </apply>
        <ci>f</ci>
       </apply>
      </apply>
      <cn type="integer">2</cn>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>G</ci>
       <apply>
        <times></times>
        <ci>x</ci>
        <ci>x</ci>
       </apply>
      </apply>
      <ci>f</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>G</ci>
       <apply>
        <times></times>
        <ci>y</ci>
        <ci>y</ci>
       </apply>
      </apply>
      <ci>f</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   C_{xy}(f)=\frac{|G_{xy}(f)|^{2}}{G_{xx}(f)G_{yy}(f)}
  </annotation>
 </semantics>
</math>


</dd>
</dl>
</dd>
</dl>

<p>where G<sub>xy</sub>(f) is the cross-<a href="spectral_density" title="wikilink">spectral density</a> between x and y, and G<sub>xx</sub>(f) and G<sub>yy</sub>(f) the autospectral density of x and y respectively. The <a href="Magnitude_(mathematics)" title="wikilink">magnitude</a> of the spectral density is denoted as |G|. Given the restrictions noted above (ergodicity, linearity) the coherence function estimates the extent to which y(t) may be predicted from x(t) by an optimum linear <a href="least_squares" title="wikilink">least squares</a> function.</p>

<p>Values of coherence will always satisfy 

<math display="inline" id="Coherence_(signal_processing):1">
 <semantics>
  <mrow>
   <mn>0</mn>
   <mo>≤</mo>
   <mrow>
    <msub>
     <mi>C</mi>
     <mrow>
      <mi>x</mi>
      <mi>y</mi>
     </mrow>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>f</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>≤</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <leq></leq>
     <cn type="integer">0</cn>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>C</ci>
       <apply>
        <times></times>
        <ci>x</ci>
        <ci>y</ci>
       </apply>
      </apply>
      <ci>f</ci>
     </apply>
    </apply>
    <apply>
     <leq></leq>
     <share href="#.cmml">
     </share>
     <cn type="integer">1</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   0\leq C_{xy}(f)\leq 1
  </annotation>
 </semantics>
</math>

. For an <em>ideal</em> constant parameter linear system with a single input x(t) and single output y(t), the coherence will be equal to one. To see this, consider a linear system with an <a href="impulse_response" title="wikilink">impulse response</a> h(t) defined as

<math display="block" id="Coherence_(signal_processing):2">
 <semantics>
  <mrow>
   <mrow>
    <mi>y</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>t</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mrow>
      <mi>h</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>t</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo>*</mo>
     <mi>x</mi>
    </mrow>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>t</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>y</ci>
     <ci>t</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <times></times>
      <apply>
       <times></times>
       <ci>h</ci>
       <ci>t</ci>
      </apply>
      <ci>x</ci>
     </apply>
     <ci>t</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   y(t)=h(t)*x(t)
  </annotation>
 </semantics>
</math>

, where * denotes <a class="uri" href="convolution" title="wikilink">convolution</a>. In the <a href="Joseph_Fourier" title="wikilink">Fourier</a> domain this equation becomes 

<math display="inline" id="Coherence_(signal_processing):3">
 <semantics>
  <mrow>
   <mrow>
    <mi>Y</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>f</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mi>H</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>f</mi>
     <mo stretchy="false">)</mo>
    </mrow>
    <mi>X</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>f</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>Y</ci>
     <ci>f</ci>
    </apply>
    <apply>
     <times></times>
     <ci>H</ci>
     <ci>f</ci>
     <ci>X</ci>
     <ci>f</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Y(f)=H(f)X(f)
  </annotation>
 </semantics>
</math>

, where Y(f) is the <a href="Fourier_transform" title="wikilink">Fourier transform</a> of y(t) and H(f) is the linear system <a href="transfer_function" title="wikilink">transfer function</a>. Since, for an ideal linear system

<math display="block" id="Coherence_(signal_processing):4">
 <semantics>
  <mrow>
   <msub>
    <mi>G</mi>
    <mrow>
     <mi>y</mi>
     <mi>y</mi>
    </mrow>
   </msub>
   <mo>=</mo>
   <mrow>
    <msup>
     <mrow>
      <mo stretchy="false">|</mo>
      <mrow>
       <mi>H</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>f</mi>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
      <mo stretchy="false">|</mo>
     </mrow>
     <mn>2</mn>
    </msup>
    <msub>
     <mi>G</mi>
     <mrow>
      <mi>x</mi>
      <mi>x</mi>
     </mrow>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>f</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>G</ci>
     <apply>
      <times></times>
      <ci>y</ci>
      <ci>y</ci>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <abs></abs>
       <apply>
        <times></times>
        <ci>H</ci>
        <ci>f</ci>
       </apply>
      </apply>
      <cn type="integer">2</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>G</ci>
      <apply>
       <times></times>
       <ci>x</ci>
       <ci>x</ci>
      </apply>
     </apply>
     <ci>f</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   G_{yy}=|H(f)|^{2}G_{xx}(f)
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Coherence_(signal_processing):5">
 <semantics>
  <mrow>
   <msub>
    <mi>G</mi>
    <mrow>
     <mi>x</mi>
     <mi>y</mi>
    </mrow>
   </msub>
   <mo>=</mo>
   <mrow>
    <mi>H</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>f</mi>
     <mo stretchy="false">)</mo>
    </mrow>
    <msub>
     <mi>G</mi>
     <mrow>
      <mi>x</mi>
      <mi>x</mi>
     </mrow>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>f</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>G</ci>
     <apply>
      <times></times>
      <ci>x</ci>
      <ci>y</ci>
     </apply>
    </apply>
    <apply>
     <times></times>
     <ci>H</ci>
     <ci>f</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>G</ci>
      <apply>
       <times></times>
       <ci>x</ci>
       <ci>x</ci>
      </apply>
     </apply>
     <ci>f</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   G_{xy}=H(f)G_{xx}(f)
  </annotation>
 </semantics>
</math>

, and since 

<math display="inline" id="Coherence_(signal_processing):6">
 <semantics>
  <mrow>
   <msub>
    <mi>G</mi>
    <mrow>
     <mi>x</mi>
     <mi>x</mi>
    </mrow>
   </msub>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>f</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>G</ci>
     <apply>
      <times></times>
      <ci>x</ci>
      <ci>x</ci>
     </apply>
    </apply>
    <ci>f</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   G_{xx}(f)
  </annotation>
 </semantics>
</math>

 is real, the following identity holds,</p>
<dl>
<dd><dl>
<dd>

<math display="inline" id="Coherence_(signal_processing):7">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>C</mi>
     <mrow>
      <mi>x</mi>
      <mi>y</mi>
     </mrow>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>f</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mfrac>
    <msup>
     <mrow>
      <mo stretchy="false">|</mo>
      <mrow>
       <mi>H</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>f</mi>
        <mo stretchy="false">)</mo>
       </mrow>
       <msub>
        <mi>G</mi>
        <mrow>
         <mi>x</mi>
         <mi>x</mi>
        </mrow>
       </msub>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>f</mi>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
      <mo stretchy="false">|</mo>
     </mrow>
     <mn>2</mn>
    </msup>
    <mrow>
     <msub>
      <mi>G</mi>
      <mrow>
       <mi>x</mi>
       <mi>x</mi>
      </mrow>
     </msub>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>f</mi>
      <mo stretchy="false">)</mo>
     </mrow>
     <msub>
      <mi>G</mi>
      <mrow>
       <mi>y</mi>
       <mi>y</mi>
      </mrow>
     </msub>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>f</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mfrac>
   <mo>=</mo>
   <mfrac>
    <msup>
     <mrow>
      <mo stretchy="false">|</mo>
      <mrow>
       <mi>H</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>f</mi>
        <mo stretchy="false">)</mo>
       </mrow>
       <msub>
        <mi>G</mi>
        <mrow>
         <mi>x</mi>
         <mi>x</mi>
        </mrow>
       </msub>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>f</mi>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
      <mo stretchy="false">|</mo>
     </mrow>
     <mn>2</mn>
    </msup>
    <mrow>
     <msubsup>
      <mi>G</mi>
      <mrow>
       <mi>x</mi>
       <mi>x</mi>
      </mrow>
      <mn>2</mn>
     </msubsup>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>f</mi>
      <mo stretchy="false">)</mo>
     </mrow>
     <msup>
      <mrow>
       <mo stretchy="false">|</mo>
       <mrow>
        <mi>H</mi>
        <mrow>
         <mo stretchy="false">(</mo>
         <mi>f</mi>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
       <mo stretchy="false">|</mo>
      </mrow>
      <mn>2</mn>
     </msup>
    </mrow>
   </mfrac>
   <mo>=</mo>
   <mfrac>
    <msup>
     <mrow>
      <mo stretchy="false">|</mo>
      <mrow>
       <msub>
        <mi>G</mi>
        <mrow>
         <mi>x</mi>
         <mi>x</mi>
        </mrow>
       </msub>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>f</mi>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
      <mo stretchy="false">|</mo>
     </mrow>
     <mn>2</mn>
    </msup>
    <mrow>
     <msubsup>
      <mi>G</mi>
      <mrow>
       <mi>x</mi>
       <mi>x</mi>
      </mrow>
      <mn>2</mn>
     </msubsup>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>f</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mfrac>
   <mo>=</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>C</ci>
       <apply>
        <times></times>
        <ci>x</ci>
        <ci>y</ci>
       </apply>
      </apply>
      <ci>f</ci>
     </apply>
     <apply>
      <divide></divide>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <abs></abs>
        <apply>
         <times></times>
         <ci>H</ci>
         <ci>f</ci>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>G</ci>
          <apply>
           <times></times>
           <ci>x</ci>
           <ci>x</ci>
          </apply>
         </apply>
         <ci>f</ci>
        </apply>
       </apply>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>G</ci>
        <apply>
         <times></times>
         <ci>x</ci>
         <ci>x</ci>
        </apply>
       </apply>
       <ci>f</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>G</ci>
        <apply>
         <times></times>
         <ci>y</ci>
         <ci>y</ci>
        </apply>
       </apply>
       <ci>f</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <divide></divide>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <abs></abs>
        <apply>
         <times></times>
         <ci>H</ci>
         <ci>f</ci>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>G</ci>
          <apply>
           <times></times>
           <ci>x</ci>
           <ci>x</ci>
          </apply>
         </apply>
         <ci>f</ci>
        </apply>
       </apply>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>G</ci>
         <apply>
          <times></times>
          <ci>x</ci>
          <ci>x</ci>
         </apply>
        </apply>
        <cn type="integer">2</cn>
       </apply>
       <ci>f</ci>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <abs></abs>
         <apply>
          <times></times>
          <ci>H</ci>
          <ci>f</ci>
         </apply>
        </apply>
        <cn type="integer">2</cn>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <divide></divide>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <abs></abs>
        <apply>
         <times></times>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>G</ci>
          <apply>
           <times></times>
           <ci>x</ci>
           <ci>x</ci>
          </apply>
         </apply>
         <ci>f</ci>
        </apply>
       </apply>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>G</ci>
         <apply>
          <times></times>
          <ci>x</ci>
          <ci>x</ci>
         </apply>
        </apply>
        <cn type="integer">2</cn>
       </apply>
       <ci>f</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <cn type="integer">1</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   C_{xy}(f)=\frac{|H(f)G_{xx}(f)|^{2}}{G_{xx}(f)G_{yy}(f)}=\frac{|H(f)G_{xx}(f)|%
^{2}}{G_{xx}^{2}(f)|H(f)|^{2}}=\frac{|G_{xx}(f)|^{2}}{G_{xx}^{2}(f)}=1
  </annotation>
 </semantics>
</math>

.
</dd>
</dl>
</dd>
</dl>

<p>However, in the physical world an ideal linear system is rarely realized, noise is an inherent component of system measurement, and it is likely that a single input, single output linear system is insufficient to capture the complete system dynamics. In cases where the ideal linear system assumptions are insufficient, the <a href="Cauchy–Schwarz_inequality" title="wikilink">Cauchy–Schwarz inequality</a> guarantees a value of 

<math display="inline" id="Coherence_(signal_processing):8">
 <semantics>
  <mrow>
   <msub>
    <mi>C</mi>
    <mrow>
     <mi>x</mi>
     <mi>y</mi>
    </mrow>
   </msub>
   <mo>≤</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <leq></leq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>C</ci>
     <apply>
      <times></times>
      <ci>x</ci>
      <ci>y</ci>
     </apply>
    </apply>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   C_{xy}\leq 1
  </annotation>
 </semantics>
</math>

.</p>

<p>If C<sub>xy</sub> is less than one but greater than zero it is an indication that either: noise is entering the measurements, that the assumed function relating x(t) and y(t) is not linear, or that y(t) is producing output due to input x(t) as well as other inputs. If the coherence is equal to zero, it is an indication that x(t) and y(t) are completely unrelated, given the constraints mentioned above.</p>

<p>The coherence of a linear system therefore represents the fractional part of the output signal power that is produced by the input at that frequency. We can also view the quantity 

<math display="inline" id="Coherence_(signal_processing):9">
 <semantics>
  <mrow>
   <mn>1</mn>
   <mo>-</mo>
   <msub>
    <mi>C</mi>
    <mrow>
     <mi>x</mi>
     <mi>y</mi>
    </mrow>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <minus></minus>
    <cn type="integer">1</cn>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>C</ci>
     <apply>
      <times></times>
      <ci>x</ci>
      <ci>y</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   1-C_{xy}
  </annotation>
 </semantics>
</math>

 as an estimate of the fractional power of the output that is not contributed by the input at a particular frequency. This leads naturally to definition of the coherent output spectrum:</p>
<dl>
<dd><dl>
<dd>

<math display="inline" id="Coherence_(signal_processing):10">
 <semantics>
  <mrow>
   <msub>
    <mi>G</mi>
    <mrow>
     <mi>v</mi>
     <mi>v</mi>
    </mrow>
   </msub>
   <mo>=</mo>
   <mrow>
    <msub>
     <mi>C</mi>
     <mrow>
      <mi>x</mi>
      <mi>y</mi>
     </mrow>
    </msub>
    <msub>
     <mi>G</mi>
     <mrow>
      <mi>y</mi>
      <mi>y</mi>
     </mrow>
    </msub>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>G</ci>
     <apply>
      <times></times>
      <ci>v</ci>
      <ci>v</ci>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>C</ci>
      <apply>
       <times></times>
       <ci>x</ci>
       <ci>y</ci>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>G</ci>
      <apply>
       <times></times>
       <ci>y</ci>
       <ci>y</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   G_{vv}=C_{xy}G_{yy}
  </annotation>
 </semantics>
</math>


</dd>
</dl>
</dd>
</dl>

<p>

<math display="inline" id="Coherence_(signal_processing):11">
 <semantics>
  <msub>
   <mi>G</mi>
   <mrow>
    <mi>v</mi>
    <mi>v</mi>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>G</ci>
    <apply>
     <times></times>
     <ci>v</ci>
     <ci>v</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   G_{vv}
  </annotation>
 </semantics>
</math>

 provides a spectral quantification of the output power that is uncorrelated with noise or other inputs.</p>
<h2 id="example">Example</h2>
<figure><b>(Figure)</b>
<figcaption>Figure 1: Barometric pressure (black), ocean water levels (red), and groundwater well level (blue) near Lake Worth Florida during hurricane Frances.</figcaption>
</figure>

<p>Consider the two signals shown in the lower portion of figure 1. There appears to be a close relationship between the ocean surface water levels and the groundwater well levels. It is also clear that the barometric pressure has an effect on both the ocean water levels and groundwater levels.</p>

<p>Figure 2. shows the autospectral density of ocean water level over a long period of time.As expected, most of the energy is centered on the well-known <a href="Tide" title="wikilink">tidal</a> frequencies. Likewise, the autospectral density of groundwater well levels are shown in figure 3.It is clear that variation of the groundwater levels have significant power at the ocean tidal frequencies. To estimate the extent at which the groundwater levels are influenced by the ocean surface levels, we compute the coherence between them. Let us assume that there is a linear relationship between the ocean surface height and the groundwater levels. We further assume that the ocean surface height controls the groundwater levels so that we take the ocean surface height as the input variable, and the groundwater well height as the output variable.</p>

<p>The computed coherence is shown in figure 4 (note that coherence is often denoted as 

<math display="inline" id="Coherence_(signal_processing):12">
 <semantics>
  <msup>
   <mi>γ</mi>
   <mn>2</mn>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>γ</ci>
    <cn type="integer">2</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \gamma^{2}
  </annotation>
 </semantics>
</math>

.)  This result indicates that at most of the major ocean tidal frequencies the variation of groundwater level at this particular site is over 90% due to the forcing of the ocean tides. However, one must exercise caution in attributing causality. If the relation (<a href="transfer_function" title="wikilink">transfer function</a>) between the input and output is <a href="Nonlinear_system" title="wikilink">nonlinear</a>, then values of the coherence can be erroneous. Another common mistake is to assume a causal input/output relation between observed variables, when in fact the causative mechanism is not in the system model. For example, it is clear that the atmospheric barometric pressure induces a variation in both the ocean water levels and the groundwater levels, but the barometric pressure is not included in the system model as an input variable. We have also assumed that the ocean water levels drive or control the groundwater levels. In reality it is a combination of hydrological forcing from the ocean water levels and the tidal <a href="tidal_force" title="wikilink">potential</a> that are driving both the observed input and output signals. Additionally, noise introduced in the measurement process, or by the spectral signal processing can contribute to or corrupt the coherence.</p>
<h2 id="extension-to-non-stationary-signals">Extension to non-stationary signals</h2>

<p>If the signals are <a class="uri" href="non-stationary" title="wikilink">non-stationary</a>, (and therefore not <a href="Ergodic_process" title="wikilink">ergodic</a>), the above formulations may not be appropriate. For such signals, the concept of coherence has been extended by using the concept of time-frequency distributions to represent the time-varying spectral variations of non-stationary signals in lieu of traditional spectra. For more details, see.<a class="footnoteRef" href="#fn3" id="fnref3"><sup>3</sup></a></p>
<h2 id="see-also">See also</h2>
<ul>
<li><a href="Scaled_Correlation" title="wikilink">Scaled Correlation</a></li>
<li><a href="Normalized_cross-correlation" title="wikilink">Normalized cross-correlation</a></li>
</ul>
<h2 id="references">References</h2>
<references>
</references>

<p><br/>
 "</p>

<p><a href="Category:Signal_processing" title="wikilink">Category:Signal processing</a> <a href="Category:Telecommunication_theory" title="wikilink">Category:Telecommunication theory</a> <a href="Category:Frequency_domain_analysis" title="wikilink">Category:Frequency domain analysis</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1">J. S. Bendat, A. G. Piersol, <em>Random Data</em>, Wiley-Interscience, 1986<a href="#fnref1">↩</a></li>
<li id="fn2"><a class="uri" href="http://www.fil.ion.ucl.ac.uk/~wpenny/course/course.html">http://www.fil.ion.ucl.ac.uk/~wpenny/course/course.html</a>, chapter 7<a href="#fnref2">↩</a></li>
<li id="fn3">L.B. White and B. Boashash, "Cross Spectral Analysis of Non-Stationary Processes", IEEE Transactions on Information Theory, Vol. 36, No. 4, pp. 830-835, July 1990.<a href="#fnref3">↩</a></li>
</ol>
</section>
</body>
</html>

<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="737">Partial trace</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Partial trace</h1>
<hr/>

<p> In <a href="linear_algebra" title="wikilink">linear algebra</a> and <a href="functional_analysis" title="wikilink">functional analysis</a>, the <strong>partial trace</strong> is a generalization of the <a href="trace_(linear_algebra)" title="wikilink">trace</a>. Whereas the trace is a <a href="scalar_(mathematics)" title="wikilink">scalar</a> valued function on operators, the partial trace is an operator-valued function. The partial trace has applications in <a href="quantum_information" title="wikilink">quantum information</a> and <a class="uri" href="decoherence" title="wikilink">decoherence</a> which is relevant for <a href="quantum_measurement" title="wikilink">quantum measurement</a> and thereby to the decoherent approaches to <a href="interpretations_of_quantum_mechanics" title="wikilink">interpretations of quantum mechanics</a>, including <a href="consistent_histories" title="wikilink">consistent histories</a> and the <a href="relative_state_interpretation" title="wikilink">relative state interpretation</a>.</p>
<h2 id="details">Details</h2>

<p>Suppose 

<math display="inline" id="Partial_trace:0">
 <semantics>
  <mi>V</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>V</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   V
  </annotation>
 </semantics>
</math>

, 

<math display="inline" id="Partial_trace:1">
 <semantics>
  <mi>W</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>W</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   W
  </annotation>
 </semantics>
</math>

 are finite-dimensional vector spaces over a <a href="field_(mathematics)" title="wikilink">field</a>, with <a href="dimension" title="wikilink">dimensions</a> 

<math display="inline" id="Partial_trace:2">
 <semantics>
  <mi>m</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>m</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   m
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Partial_trace:3">
 <semantics>
  <mi>n</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>n</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n
  </annotation>
 </semantics>
</math>

, respectively. For any space 

<math display="inline" id="Partial_trace:4">
 <semantics>
  <mi>A</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>A</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A
  </annotation>
 </semantics>
</math>

 let 

<math display="inline" id="Partial_trace:5">
 <semantics>
  <mrow>
   <mi>L</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>A</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>L</ci>
    <ci>A</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   L(A)
  </annotation>
 </semantics>
</math>

 denote the space of <a href="linear_operators" title="wikilink">linear operators</a> on 

<math display="inline" id="Partial_trace:6">
 <semantics>
  <mi>A</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>A</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A
  </annotation>
 </semantics>
</math>

. The partial trace over 

<math display="inline" id="Partial_trace:7">
 <semantics>
  <mi>W</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>W</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   W
  </annotation>
 </semantics>
</math>

, 

<math display="inline" id="Partial_trace:8">
 <semantics>
  <mrow>
   <msub>
    <mo>Tr</mo>
    <mi>W</mi>
   </msub>
   <mo>:</mo>
   <mrow>
    <mrow>
     <mo>L</mo>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mi>V</mi>
       <mo>⊗</mo>
       <mi>W</mi>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>→</mo>
    <mrow>
     <mo>L</mo>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>V</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-:</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>Tr</ci>
     <ci>W</ci>
    </apply>
    <apply>
     <ci>normal-→</ci>
     <apply>
      <ci>normal-L</ci>
      <apply>
       <csymbol cd="latexml">tensor-product</csymbol>
       <ci>V</ci>
       <ci>W</ci>
      </apply>
     </apply>
     <apply>
      <ci>normal-L</ci>
      <ci>V</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \operatorname{Tr}_{W}:\operatorname{L}(V\otimes W)\to\operatorname{L}(V)
  </annotation>
 </semantics>
</math>

, is a mapping</p>

<p>

<math display="block" id="Partial_trace:9">
 <semantics>
  <mrow>
   <mi>T</mi>
   <mo>∈</mo>
   <mrow>
    <mo>L</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>V</mi>
      <mo>⊗</mo>
      <mi>W</mi>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>↦</mo>
   <mrow>
    <msub>
     <mo>Tr</mo>
     <mi>W</mi>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>T</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>∈</mo>
   <mrow>
    <mo>L</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>V</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <in></in>
     <ci>T</ci>
     <apply>
      <ci>normal-L</ci>
      <apply>
       <csymbol cd="latexml">tensor-product</csymbol>
       <ci>V</ci>
       <ci>W</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <csymbol cd="latexml">maps-to</csymbol>
     <share href="#.cmml">
     </share>
     <apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>Tr</ci>
       <ci>W</ci>
      </apply>
      <ci>T</ci>
     </apply>
    </apply>
    <apply>
     <in></in>
     <share href="#.cmml">
     </share>
     <apply>
      <ci>normal-L</ci>
      <ci>V</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   T\in\operatorname{L}(V\otimes W)\mapsto\operatorname{Tr}_{W}(T)\in%
\operatorname{L}(V)
  </annotation>
 </semantics>
</math>

</p>

<p>It is defined as follows: let</p>

<p>

<math display="block" id="Partial_trace:10">
 <semantics>
  <mrow>
   <msub>
    <mi>e</mi>
    <mn>1</mn>
   </msub>
   <mo>,</mo>
   <mi mathvariant="normal">…</mi>
   <mo>,</mo>
   <msub>
    <mi>e</mi>
    <mi>m</mi>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <list>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>e</ci>
     <cn type="integer">1</cn>
    </apply>
    <ci>normal-…</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>e</ci>
     <ci>m</ci>
    </apply>
   </list>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   e_{1},\ldots,e_{m}
  </annotation>
 </semantics>
</math>

</p>

<p>and</p>

<p>

<math display="block" id="Partial_trace:11">
 <semantics>
  <mrow>
   <msub>
    <mi>f</mi>
    <mn>1</mn>
   </msub>
   <mo>,</mo>
   <mi mathvariant="normal">…</mi>
   <mo>,</mo>
   <msub>
    <mi>f</mi>
    <mi>n</mi>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <list>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>f</ci>
     <cn type="integer">1</cn>
    </apply>
    <ci>normal-…</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>f</ci>
     <ci>n</ci>
    </apply>
   </list>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f_{1},\ldots,f_{n}
  </annotation>
 </semantics>
</math>

</p>

<p>be bases for <em>V</em> and <em>W</em> respectively; then <em>T</em> has a matrix representation</p>

<p>

<math display="block" id="Partial_trace:12">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mrow>
      <mo stretchy="false">{</mo>
      <msub>
       <mi>a</mi>
       <mrow>
        <mrow>
         <mi>k</mi>
         <mi mathvariant="normal">ℓ</mi>
        </mrow>
        <mo>,</mo>
        <mrow>
         <mi>i</mi>
         <mi>j</mi>
        </mrow>
       </mrow>
      </msub>
      <mo stretchy="false">}</mo>
     </mrow>
     <mn>1</mn>
    </mrow>
    <mo>≤</mo>
    <mi>k</mi>
   </mrow>
   <mo>,</mo>
   <mrow>
    <mrow>
     <mi>i</mi>
     <mo>≤</mo>
     <mi>m</mi>
    </mrow>
    <mo rspace="12.5pt">,</mo>
    <mrow>
     <mrow>
      <mn>1</mn>
      <mo>≤</mo>
      <mi mathvariant="normal">ℓ</mi>
     </mrow>
     <mo>,</mo>
     <mrow>
      <mi>j</mi>
      <mo>≤</mo>
      <mi>n</mi>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <leq></leq>
     <list>
      <set>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>a</ci>
        <list>
         <apply>
          <times></times>
          <ci>k</ci>
          <ci>normal-ℓ</ci>
         </apply>
         <apply>
          <times></times>
          <ci>i</ci>
          <ci>j</ci>
         </apply>
        </list>
       </apply>
      </set>
      <cn type="integer">1</cn>
     </list>
     <ci>k</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">formulae-sequence</csymbol>
     <apply>
      <leq></leq>
      <ci>i</ci>
      <ci>m</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">formulae-sequence</csymbol>
      <apply>
       <leq></leq>
       <cn type="integer">1</cn>
       <ci>normal-ℓ</ci>
      </apply>
      <apply>
       <leq></leq>
       <ci>j</ci>
       <ci>n</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \{a_{k\ell,ij}\}\quad 1\leq k,i\leq m,\quad 1\leq\ell,j\leq n
  </annotation>
 </semantics>
</math>

</p>

<p>relative to the basis</p>

<p>

<math display="block" id="Partial_trace:13">
 <semantics>
  <mrow>
   <msub>
    <mi>e</mi>
    <mi>k</mi>
   </msub>
   <mo>⊗</mo>
   <msub>
    <mi>f</mi>
    <mi mathvariant="normal">ℓ</mi>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">tensor-product</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>e</ci>
     <ci>k</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>f</ci>
     <ci>normal-ℓ</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   e_{k}\otimes f_{\ell}
  </annotation>
 </semantics>
</math>

</p>

<p>of</p>

<p>

<math display="block" id="Partial_trace:14">
 <semantics>
  <mrow>
   <mi>V</mi>
   <mo>⊗</mo>
   <mi>W</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">tensor-product</csymbol>
    <ci>V</ci>
    <ci>W</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   V\otimes W
  </annotation>
 </semantics>
</math>

.</p>

<p>Now for indices <em>k</em>, <em>i</em> in the range 1, ..., <em>m</em>, consider the sum</p>

<p>

<math display="block" id="Partial_trace:15">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>b</mi>
     <mrow>
      <mi>k</mi>
      <mo>,</mo>
      <mi>i</mi>
     </mrow>
    </msub>
    <mo>=</mo>
    <mrow>
     <munderover>
      <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
      <mrow>
       <mi>j</mi>
       <mo>=</mo>
       <mn>1</mn>
      </mrow>
      <mi>n</mi>
     </munderover>
     <msub>
      <mi>a</mi>
      <mrow>
       <mrow>
        <mi>k</mi>
        <mi>j</mi>
       </mrow>
       <mo>,</mo>
       <mrow>
        <mi>i</mi>
        <mi>j</mi>
       </mrow>
      </mrow>
     </msub>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>b</ci>
     <list>
      <ci>k</ci>
      <ci>i</ci>
     </list>
    </apply>
    <apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <apply>
        <eq></eq>
        <ci>j</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <ci>n</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>a</ci>
      <list>
       <apply>
        <times></times>
        <ci>k</ci>
        <ci>j</ci>
       </apply>
       <apply>
        <times></times>
        <ci>i</ci>
        <ci>j</ci>
       </apply>
      </list>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   b_{k,i}=\sum_{j=1}^{n}a_{kj,ij}.
  </annotation>
 </semantics>
</math>

</p>

<p>This gives a matrix <em>b</em><sub><em>k</em>, <em>i</em></sub>. The associated linear operator on <em>V</em> is independent of the choice of bases and is by definition the <strong>partial trace</strong>.</p>

<p>Among physicists, this is often called "tracing out" or "tracing over" <em>W</em> to leave only an operator on <em>V</em> in the context where <em>W</em> and <em>V</em> are Hilbert spaces associated with quantum systems (see below).</p>
<h3 id="invariant-definition">Invariant definition</h3>

<p>The partial trace operator can be defined invariantly (that is, without reference to a basis) as follows: it is the unique linear operator</p>

<p>

<math display="block" id="Partial_trace:16">
 <semantics>
  <mrow>
   <msub>
    <mo>Tr</mo>
    <mi>W</mi>
   </msub>
   <mo>:</mo>
   <mrow>
    <mrow>
     <mo>L</mo>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mi>V</mi>
       <mo>⊗</mo>
       <mi>W</mi>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>→</mo>
    <mrow>
     <mo>L</mo>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>V</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-:</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>Tr</ci>
     <ci>W</ci>
    </apply>
    <apply>
     <ci>normal-→</ci>
     <apply>
      <ci>normal-L</ci>
      <apply>
       <csymbol cd="latexml">tensor-product</csymbol>
       <ci>V</ci>
       <ci>W</ci>
      </apply>
     </apply>
     <apply>
      <ci>normal-L</ci>
      <ci>V</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \operatorname{Tr}_{W}:\operatorname{L}(V\otimes W)\rightarrow\operatorname{L}(V)
  </annotation>
 </semantics>
</math>

 such that</p>

<p>

<math display="block" id="Partial_trace:17">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mrow>
      <msub>
       <mo>Tr</mo>
       <mi>W</mi>
      </msub>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mi>R</mi>
        <mo>⊗</mo>
        <mi>S</mi>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo>=</mo>
     <mrow>
      <mpadded width="+1.7pt">
       <mi>R</mi>
      </mpadded>
      <mrow>
       <mo>Tr</mo>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>S</mi>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
     </mrow>
    </mrow>
    <mrow>
     <mrow>
      <mrow>
       <mo>∀</mo>
       <mi>R</mi>
      </mrow>
      <mo>∈</mo>
      <mrow>
       <mo>L</mo>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>V</mi>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
     </mrow>
     <mrow>
      <mrow>
       <mo>∀</mo>
       <mi>S</mi>
      </mrow>
      <mo>∈</mo>
      <mrow>
       <mo>L</mo>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>W</mi>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <eq></eq>
     <apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>Tr</ci>
       <ci>W</ci>
      </apply>
      <apply>
       <csymbol cd="latexml">tensor-product</csymbol>
       <ci>R</ci>
       <ci>S</ci>
      </apply>
     </apply>
     <apply>
      <times></times>
      <ci>R</ci>
      <apply>
       <ci>Tr</ci>
       <ci>S</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <csymbol cd="ambiguous">formulae-sequence</csymbol>
     <apply>
      <in></in>
      <apply>
       <csymbol cd="latexml">for-all</csymbol>
       <ci>R</ci>
      </apply>
      <apply>
       <ci>normal-L</ci>
       <ci>V</ci>
      </apply>
     </apply>
     <apply>
      <in></in>
      <apply>
       <csymbol cd="latexml">for-all</csymbol>
       <ci>S</ci>
      </apply>
      <apply>
       <ci>normal-L</ci>
       <ci>W</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \operatorname{Tr}_{W}(R\otimes S)=R\,\operatorname{Tr}(S)\quad\forall R\in%
\operatorname{L}(V)\quad\forall S\in\operatorname{L}(W).
  </annotation>
 </semantics>
</math>

 To see that the conditions above determine the partial trace uniquely, let 

<math display="inline" id="Partial_trace:18">
 <semantics>
  <mrow>
   <msub>
    <mi>v</mi>
    <mn>1</mn>
   </msub>
   <mo>,</mo>
   <mi mathvariant="normal">…</mi>
   <mo>,</mo>
   <msub>
    <mi>v</mi>
    <mi>m</mi>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <list>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>v</ci>
     <cn type="integer">1</cn>
    </apply>
    <ci>normal-…</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>v</ci>
     <ci>m</ci>
    </apply>
   </list>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   v_{1},\ldots,v_{m}
  </annotation>
 </semantics>
</math>

 form a basis for 

<math display="inline" id="Partial_trace:19">
 <semantics>
  <mi>V</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>V</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   V
  </annotation>
 </semantics>
</math>

, let 

<math display="inline" id="Partial_trace:20">
 <semantics>
  <mrow>
   <msub>
    <mi>w</mi>
    <mn>1</mn>
   </msub>
   <mo>,</mo>
   <mi mathvariant="normal">…</mi>
   <mo>,</mo>
   <msub>
    <mi>w</mi>
    <mi>n</mi>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <list>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>w</ci>
     <cn type="integer">1</cn>
    </apply>
    <ci>normal-…</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>w</ci>
     <ci>n</ci>
    </apply>
   </list>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   w_{1},\ldots,w_{n}
  </annotation>
 </semantics>
</math>

 form a basis for 

<math display="inline" id="Partial_trace:21">
 <semantics>
  <mi>W</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>W</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   W
  </annotation>
 </semantics>
</math>

, let 

<math display="inline" id="Partial_trace:22">
 <semantics>
  <mrow>
   <msub>
    <mi>E</mi>
    <mrow>
     <mi>i</mi>
     <mi>j</mi>
    </mrow>
   </msub>
   <mo>:</mo>
   <mrow>
    <mi>V</mi>
    <mo>→</mo>
    <mi>V</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-:</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>E</ci>
     <apply>
      <times></times>
      <ci>i</ci>
      <ci>j</ci>
     </apply>
    </apply>
    <apply>
     <ci>normal-→</ci>
     <ci>V</ci>
     <ci>V</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   E_{ij}\colon V\to V
  </annotation>
 </semantics>
</math>

 be the map that sends 

<math display="inline" id="Partial_trace:23">
 <semantics>
  <msub>
   <mi>v</mi>
   <mi>i</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>v</ci>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   v_{i}
  </annotation>
 </semantics>
</math>

 to 

<math display="inline" id="Partial_trace:24">
 <semantics>
  <msub>
   <mi>v</mi>
   <mi>j</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>v</ci>
    <ci>j</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   v_{j}
  </annotation>
 </semantics>
</math>

 (and all other basis elements to zero), and let 

<math display="inline" id="Partial_trace:25">
 <semantics>
  <mrow>
   <msub>
    <mi>F</mi>
    <mrow>
     <mi>k</mi>
     <mi>l</mi>
    </mrow>
   </msub>
   <mo>:</mo>
   <mrow>
    <mi>W</mi>
    <mo>→</mo>
    <mi>W</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-:</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>F</ci>
     <apply>
      <times></times>
      <ci>k</ci>
      <ci>l</ci>
     </apply>
    </apply>
    <apply>
     <ci>normal-→</ci>
     <ci>W</ci>
     <ci>W</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   F_{kl}\colon W\to W
  </annotation>
 </semantics>
</math>

 be the map that sends 

<math display="inline" id="Partial_trace:26">
 <semantics>
  <msub>
   <mi>w</mi>
   <mi>k</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>w</ci>
    <ci>k</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   w_{k}
  </annotation>
 </semantics>
</math>

 to 

<math display="inline" id="Partial_trace:27">
 <semantics>
  <msub>
   <mi>w</mi>
   <mi>l</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>w</ci>
    <ci>l</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   w_{l}
  </annotation>
 </semantics>
</math>

. Since the vectors 

<math display="inline" id="Partial_trace:28">
 <semantics>
  <mrow>
   <msub>
    <mi>v</mi>
    <mi>i</mi>
   </msub>
   <mo>⊗</mo>
   <msub>
    <mi>w</mi>
    <mi>k</mi>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">tensor-product</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>v</ci>
     <ci>i</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>w</ci>
     <ci>k</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   v_{i}\otimes w_{k}
  </annotation>
 </semantics>
</math>

 form a basis for 

<math display="inline" id="Partial_trace:29">
 <semantics>
  <mrow>
   <mi>V</mi>
   <mo>⊗</mo>
   <mi>W</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">tensor-product</csymbol>
    <ci>V</ci>
    <ci>W</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   V\otimes W
  </annotation>
 </semantics>
</math>

, the maps 

<math display="inline" id="Partial_trace:30">
 <semantics>
  <mrow>
   <msub>
    <mi>E</mi>
    <mrow>
     <mi>i</mi>
     <mi>j</mi>
    </mrow>
   </msub>
   <mo>⊗</mo>
   <msub>
    <mi>F</mi>
    <mrow>
     <mi>k</mi>
     <mi>l</mi>
    </mrow>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">tensor-product</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>E</ci>
     <apply>
      <times></times>
      <ci>i</ci>
      <ci>j</ci>
     </apply>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>F</ci>
     <apply>
      <times></times>
      <ci>k</ci>
      <ci>l</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   E_{ij}\otimes F_{kl}
  </annotation>
 </semantics>
</math>

 form a basis for 

<math display="inline" id="Partial_trace:31">
 <semantics>
  <mrow>
   <mo>L</mo>
   <mrow>
    <mo stretchy="false">(</mo>
    <mrow>
     <mi>V</mi>
     <mo>⊗</mo>
     <mi>W</mi>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-L</ci>
    <apply>
     <csymbol cd="latexml">tensor-product</csymbol>
     <ci>V</ci>
     <ci>W</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \operatorname{L}(V\otimes W)
  </annotation>
 </semantics>
</math>

.</p>

<p>From this abstract definition, the following properties follow:</p>

<p>

<math display="block" id="Partial_trace:32">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mo>Tr</mo>
     <mi>W</mi>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <msub>
      <mi>I</mi>
      <mrow>
       <mi>V</mi>
       <mo>⊗</mo>
       <mi>W</mi>
      </mrow>
     </msub>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mo>dim</mo>
    <mrow>
     <mpadded width="+5pt">
      <mi>W</mi>
     </mpadded>
     <msub>
      <mi>I</mi>
      <mi>V</mi>
     </msub>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>Tr</ci>
      <ci>W</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>I</ci>
      <apply>
       <csymbol cd="latexml">tensor-product</csymbol>
       <ci>V</ci>
       <ci>W</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <csymbol cd="latexml">dimension</csymbol>
     <apply>
      <times></times>
      <ci>W</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>I</ci>
       <ci>V</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \operatorname{Tr}_{W}(I_{V\otimes W})=\dim W\ I_{V}
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Partial_trace:33">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mrow>
      <msub>
       <mo>Tr</mo>
       <mi>W</mi>
      </msub>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mi>T</mi>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <msub>
           <mi>I</mi>
           <mi>V</mi>
          </msub>
          <mo>⊗</mo>
          <mi>S</mi>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo>=</mo>
     <mrow>
      <msub>
       <mo>Tr</mo>
       <mi>W</mi>
      </msub>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <msub>
           <mi>I</mi>
           <mi>V</mi>
          </msub>
          <mo>⊗</mo>
          <mi>S</mi>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
        <mi>T</mi>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mrow>
    <mrow>
     <mrow>
      <mrow>
       <mo>∀</mo>
       <mi>S</mi>
      </mrow>
      <mo>∈</mo>
      <mrow>
       <mo>L</mo>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>W</mi>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
     </mrow>
     <mrow>
      <mrow>
       <mo>∀</mo>
       <mi>T</mi>
      </mrow>
      <mo>∈</mo>
      <mrow>
       <mo>L</mo>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mi>V</mi>
         <mo>⊗</mo>
         <mi>W</mi>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <eq></eq>
     <apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>Tr</ci>
       <ci>W</ci>
      </apply>
      <apply>
       <times></times>
       <ci>T</ci>
       <apply>
        <csymbol cd="latexml">tensor-product</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>I</ci>
         <ci>V</ci>
        </apply>
        <ci>S</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>Tr</ci>
       <ci>W</ci>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="latexml">tensor-product</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>I</ci>
         <ci>V</ci>
        </apply>
        <ci>S</ci>
       </apply>
       <ci>T</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <csymbol cd="ambiguous">formulae-sequence</csymbol>
     <apply>
      <in></in>
      <apply>
       <csymbol cd="latexml">for-all</csymbol>
       <ci>S</ci>
      </apply>
      <apply>
       <ci>normal-L</ci>
       <ci>W</ci>
      </apply>
     </apply>
     <apply>
      <in></in>
      <apply>
       <csymbol cd="latexml">for-all</csymbol>
       <ci>T</ci>
      </apply>
      <apply>
       <ci>normal-L</ci>
       <apply>
        <csymbol cd="latexml">tensor-product</csymbol>
        <ci>V</ci>
        <ci>W</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \operatorname{Tr}_{W}(T(I_{V}\otimes S))=\operatorname{Tr}_{W}((I_{V}\otimes S%
)T)\quad\forall S\in\operatorname{L}(W)\quad\forall T\in\operatorname{L}(V%
\otimes W).
  </annotation>
 </semantics>
</math>

</p>
<h3 id="category-theoretic-notion">Category theoretic notion</h3>

<p>It is the partial trace of linear transformations that is the subject of Joyal, Street, and Verity's notion of <a href="Traced_monoidal_category" title="wikilink">Traced monoidal category</a>. A traced monoidal category is a monoidal category 

<math display="inline" id="Partial_trace:34">
 <semantics>
  <mrow>
   <mo stretchy="false">(</mo>
   <mi>C</mi>
   <mo>,</mo>
   <mo>⊗</mo>
   <mo>,</mo>
   <mi>I</mi>
   <mo stretchy="false">)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <vector>
    <ci>C</ci>
    <csymbol cd="latexml">tensor-product</csymbol>
    <ci>I</ci>
   </vector>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (C,\otimes,I)
  </annotation>
 </semantics>
</math>

 together with, for objects <em>X, Y, U</em> in the category, a function of Hom-sets,</p>

<p>

<math display="block" id="Partial_trace:35">
 <semantics>
  <mrow>
   <msubsup>
    <mo>Tr</mo>
    <mrow>
     <mi>X</mi>
     <mo>,</mo>
     <mi>Y</mi>
    </mrow>
    <mi>U</mi>
   </msubsup>
   <mo>:</mo>
   <mrow>
    <mrow>
     <msub>
      <mo>Hom</mo>
      <mi>C</mi>
     </msub>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mi>X</mi>
       <mo>⊗</mo>
       <mi>U</mi>
      </mrow>
      <mo>,</mo>
      <mrow>
       <mi>Y</mi>
       <mo>⊗</mo>
       <mi>U</mi>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>→</mo>
    <mrow>
     <msub>
      <mo>Hom</mo>
      <mi>C</mi>
     </msub>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>X</mi>
      <mo>,</mo>
      <mi>Y</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-:</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>Tr</ci>
      <ci>U</ci>
     </apply>
     <list>
      <ci>X</ci>
      <ci>Y</ci>
     </list>
    </apply>
    <apply>
     <ci>normal-→</ci>
     <apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>Hom</ci>
       <ci>C</ci>
      </apply>
      <apply>
       <csymbol cd="latexml">tensor-product</csymbol>
       <ci>X</ci>
       <ci>U</ci>
      </apply>
      <apply>
       <csymbol cd="latexml">tensor-product</csymbol>
       <ci>Y</ci>
       <ci>U</ci>
      </apply>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>Hom</ci>
       <ci>C</ci>
      </apply>
      <ci>X</ci>
      <ci>Y</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \operatorname{Tr}^{U}_{X,Y}\colon\operatorname{Hom}_{C}(X\otimes U,Y\otimes U)%
\to\operatorname{Hom}_{C}(X,Y)
  </annotation>
 </semantics>
</math>

 satisfying certain axioms.</p>

<p>Another case of this abstract notion of partial trace takes place in the category of finite sets and bijections between them, in which the monoidal product is disjoint union. One can show that for any finite sets, <em>X,Y,U</em> and bijection 

<math display="inline" id="Partial_trace:36">
 <semantics>
  <mrow>
   <mrow>
    <mi>X</mi>
    <mo>+</mo>
    <mi>U</mi>
   </mrow>
   <mo>≅</mo>
   <mrow>
    <mi>Y</mi>
    <mo>+</mo>
    <mi>U</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <approx></approx>
    <apply>
     <plus></plus>
     <ci>X</ci>
     <ci>U</ci>
    </apply>
    <apply>
     <plus></plus>
     <ci>Y</ci>
     <ci>U</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   X+U\cong Y+U
  </annotation>
 </semantics>
</math>

 there exists a corresponding "partially traced" bijection 

<math display="inline" id="Partial_trace:37">
 <semantics>
  <mrow>
   <mi>X</mi>
   <mo>≅</mo>
   <mi>Y</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <approx></approx>
    <ci>X</ci>
    <ci>Y</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   X\cong Y
  </annotation>
 </semantics>
</math>

.</p>
<h2 id="partial-trace-for-operators-on-hilbert-spaces">Partial trace for operators on Hilbert spaces</h2>

<p>The partial trace generalizes to operators on infinite dimensional Hilbert spaces. Suppose <em>V</em>, <em>W</em> are Hilbert spaces, and let</p>

<p>

<math display="block" id="Partial_trace:38">
 <semantics>
  <msub>
   <mrow>
    <mo stretchy="false">{</mo>
    <msub>
     <mi>f</mi>
     <mi>i</mi>
    </msub>
    <mo stretchy="false">}</mo>
   </mrow>
   <mrow>
    <mi>i</mi>
    <mo>∈</mo>
    <mi>I</mi>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <set>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>f</ci>
      <ci>i</ci>
     </apply>
    </set>
    <apply>
     <in></in>
     <ci>i</ci>
     <ci>I</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \{f_{i}\}_{i\in I}
  </annotation>
 </semantics>
</math>

</p>

<p>be an <a href="orthonormal_basis" title="wikilink">orthonormal basis</a> for <em>W</em>. Now there is an isometric isomorphism</p>

<p>

<math display="block" id="Partial_trace:39">
 <semantics>
  <mrow>
   <mrow>
    <munder>
     <mo largeop="true" mathsize="160%" movablelimits="false" stretchy="false" symmetric="true">⊕</mo>
     <mrow>
      <mi mathvariant="normal">ℓ</mi>
      <mo>∈</mo>
      <mi>I</mi>
     </mrow>
    </munder>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mrow>
       <mi>V</mi>
       <mo>⊗</mo>
       <mi>ℂ</mi>
      </mrow>
      <msub>
       <mi>f</mi>
       <mi mathvariant="normal">ℓ</mi>
      </msub>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>→</mo>
   <mrow>
    <mi>V</mi>
    <mo>⊗</mo>
    <mi>W</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-→</ci>
    <apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <csymbol cd="latexml">direct-sum</csymbol>
      <apply>
       <in></in>
       <ci>normal-ℓ</ci>
       <ci>I</ci>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="latexml">tensor-product</csymbol>
       <ci>V</ci>
       <ci>ℂ</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>f</ci>
       <ci>normal-ℓ</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <csymbol cd="latexml">tensor-product</csymbol>
     <ci>V</ci>
     <ci>W</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \bigoplus_{\ell\in I}(V\otimes\mathbb{C}f_{\ell})\rightarrow V\otimes W
  </annotation>
 </semantics>
</math>

</p>

<p>Under this decomposition, any operator 

<math display="inline" id="Partial_trace:40">
 <semantics>
  <mrow>
   <mi>T</mi>
   <mo>∈</mo>
   <mrow>
    <mo>L</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>V</mi>
      <mo>⊗</mo>
      <mi>W</mi>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <in></in>
    <ci>T</ci>
    <apply>
     <ci>normal-L</ci>
     <apply>
      <csymbol cd="latexml">tensor-product</csymbol>
      <ci>V</ci>
      <ci>W</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   T\in\operatorname{L}(V\otimes W)
  </annotation>
 </semantics>
</math>

 can be regarded as an infinite matrix of operators on <em>V</em></p>

<p>

<math display="block" id="Partial_trace:41">
 <semantics>
  <mrow>
   <mrow>
    <mo>[</mo>
    <mtable displaystyle="true">
     <mtr>
      <mtd columnalign="center">
       <msub>
        <mi>T</mi>
        <mn>11</mn>
       </msub>
      </mtd>
      <mtd columnalign="center">
       <msub>
        <mi>T</mi>
        <mn>12</mn>
       </msub>
      </mtd>
      <mtd columnalign="center">
       <mi mathvariant="normal">…</mi>
      </mtd>
      <mtd columnalign="center">
       <msub>
        <mi>T</mi>
        <mrow>
         <mn>1</mn>
         <mi>j</mi>
        </mrow>
       </msub>
      </mtd>
      <mtd columnalign="center">
       <mi mathvariant="normal">…</mi>
      </mtd>
     </mtr>
     <mtr>
      <mtd columnalign="center">
       <msub>
        <mi>T</mi>
        <mn>21</mn>
       </msub>
      </mtd>
      <mtd columnalign="center">
       <msub>
        <mi>T</mi>
        <mn>22</mn>
       </msub>
      </mtd>
      <mtd columnalign="center">
       <mi mathvariant="normal">…</mi>
      </mtd>
      <mtd columnalign="center">
       <msub>
        <mi>T</mi>
        <mrow>
         <mn>2</mn>
         <mi>j</mi>
        </mrow>
       </msub>
      </mtd>
      <mtd columnalign="center">
       <mi mathvariant="normal">…</mi>
      </mtd>
     </mtr>
     <mtr>
      <mtd columnalign="center">
       <mi mathvariant="normal">⋮</mi>
      </mtd>
      <mtd columnalign="center">
       <mi mathvariant="normal">⋮</mi>
      </mtd>
      <mtd columnalign="center">
       <mi></mi>
      </mtd>
      <mtd columnalign="center">
       <mi mathvariant="normal">⋮</mi>
      </mtd>
     </mtr>
     <mtr>
      <mtd columnalign="center">
       <msub>
        <mi>T</mi>
        <mrow>
         <mi>k</mi>
         <mn>1</mn>
        </mrow>
       </msub>
      </mtd>
      <mtd columnalign="center">
       <msub>
        <mi>T</mi>
        <mrow>
         <mi>k</mi>
         <mn>2</mn>
        </mrow>
       </msub>
      </mtd>
      <mtd columnalign="center">
       <mi mathvariant="normal">…</mi>
      </mtd>
      <mtd columnalign="center">
       <msub>
        <mi>T</mi>
        <mrow>
         <mi>k</mi>
         <mi>j</mi>
        </mrow>
       </msub>
      </mtd>
      <mtd columnalign="center">
       <mi mathvariant="normal">…</mi>
      </mtd>
     </mtr>
     <mtr>
      <mtd columnalign="center">
       <mi mathvariant="normal">⋮</mi>
      </mtd>
      <mtd columnalign="center">
       <mi mathvariant="normal">⋮</mi>
      </mtd>
      <mtd columnalign="center">
       <mi></mi>
      </mtd>
      <mtd columnalign="center">
       <mi mathvariant="normal">⋮</mi>
      </mtd>
     </mtr>
    </mtable>
    <mo>]</mo>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <matrix>
    <matrixrow>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>T</ci>
      <cn type="integer">11</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>T</ci>
      <cn type="integer">12</cn>
     </apply>
     <ci>normal-…</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>T</ci>
      <apply>
       <times></times>
       <cn type="integer">1</cn>
       <ci>j</ci>
      </apply>
     </apply>
     <ci>normal-…</ci>
    </matrixrow>
    <matrixrow>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>T</ci>
      <cn type="integer">21</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>T</ci>
      <cn type="integer">22</cn>
     </apply>
     <ci>normal-…</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>T</ci>
      <apply>
       <times></times>
       <cn type="integer">2</cn>
       <ci>j</ci>
      </apply>
     </apply>
     <ci>normal-…</ci>
    </matrixrow>
    <matrixrow>
     <ci>normal-⋮</ci>
     <ci>normal-⋮</ci>
     <csymbol cd="latexml">absent</csymbol>
     <ci>normal-⋮</ci>
    </matrixrow>
    <matrixrow>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>T</ci>
      <apply>
       <times></times>
       <ci>k</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>T</ci>
      <apply>
       <times></times>
       <ci>k</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
     <ci>normal-…</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>T</ci>
      <apply>
       <times></times>
       <ci>k</ci>
       <ci>j</ci>
      </apply>
     </apply>
     <ci>normal-…</ci>
    </matrixrow>
    <matrixrow>
     <ci>normal-⋮</ci>
     <ci>normal-⋮</ci>
     <csymbol cd="latexml">absent</csymbol>
     <ci>normal-⋮</ci>
    </matrixrow>
   </matrix>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \begin{bmatrix}T_{11}&T_{12}&\ldots&T_{1j}&\ldots\\
T_{21}&T_{22}&\ldots&T_{2j}&\ldots\\
\vdots&\vdots&&\vdots\\
T_{k1}&T_{k2}&\ldots&T_{kj}&\ldots\\
\vdots&\vdots&&\vdots\end{bmatrix},
  </annotation>
 </semantics>
</math>

</p>

<p>where 

<math display="inline" id="Partial_trace:42">
 <semantics>
  <mrow>
   <msub>
    <mi>T</mi>
    <mrow>
     <mi>k</mi>
     <mi mathvariant="normal">ℓ</mi>
    </mrow>
   </msub>
   <mo>∈</mo>
   <mrow>
    <mo>L</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>V</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <in></in>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>T</ci>
     <apply>
      <times></times>
      <ci>k</ci>
      <ci>normal-ℓ</ci>
     </apply>
    </apply>
    <apply>
     <ci>normal-L</ci>
     <ci>V</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   T_{k\ell}\in\operatorname{L}(V)
  </annotation>
 </semantics>
</math>

.</p>

<p>First suppose <em>T</em> is a non-negative operator. In this case, all the diagonal entries of the above matrix are non-negative operators on <em>V</em>. If the sum</p>

<p>

<math display="block" id="Partial_trace:43">
 <semantics>
  <mrow>
   <munder>
    <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
    <mi mathvariant="normal">ℓ</mi>
   </munder>
   <msub>
    <mi>T</mi>
    <mrow>
     <mi mathvariant="normal">ℓ</mi>
     <mi mathvariant="normal">ℓ</mi>
    </mrow>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <sum></sum>
     <ci>normal-ℓ</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>T</ci>
     <apply>
      <times></times>
      <ci>normal-ℓ</ci>
      <ci>normal-ℓ</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \sum_{\ell}T_{\ell\ell}
  </annotation>
 </semantics>
</math>

</p>

<p>converges in the <a href="strong_operator_topology" title="wikilink">strong operator topology</a> of L(<em>V</em>), it is independent of the chosen basis of <em>W</em>. The partial trace Tr<sub><em>W</em></sub>(<em>T</em>) is defined to be this operator. The partial trace of a self-adjoint operator is defined if and only if the partial traces of the positive and negative parts are defined.</p>
<h3 id="computing-the-partial-trace">Computing the partial trace</h3>

<p>Suppose <em>W</em> has an orthonormal basis, which we denote by <a href="bra-ket" title="wikilink">ket</a> vector notation as 

<math display="inline" id="Partial_trace:44">
 <semantics>
  <msub>
   <mrow>
    <mo stretchy="false">{</mo>
    <mrow>
     <mo fence="true" stretchy="false">|</mo>
     <mi mathvariant="normal">ℓ</mi>
     <mo stretchy="false">⟩</mo>
    </mrow>
    <mo stretchy="false">}</mo>
   </mrow>
   <mi mathvariant="normal">ℓ</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <set>
     <apply>
      <csymbol cd="latexml">ket</csymbol>
      <ci>normal-ℓ</ci>
     </apply>
    </set>
    <ci>normal-ℓ</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \{|\ell\rangle\}_{\ell}
  </annotation>
 </semantics>
</math>

. Then</p>

<p>

<math display="block" id="Partial_trace:45">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <msub>
      <mo>Tr</mo>
      <mi>W</mi>
     </msub>
     <mrow>
      <mo>(</mo>
      <mrow>
       <munder>
        <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
        <mrow>
         <mi>k</mi>
         <mo>,</mo>
         <mi mathvariant="normal">ℓ</mi>
        </mrow>
       </munder>
       <mrow>
        <mrow>
         <mpadded width="+1.7pt">
          <msub>
           <mi>T</mi>
           <mrow>
            <mi>k</mi>
            <mi mathvariant="normal">ℓ</mi>
           </mrow>
          </msub>
         </mpadded>
         <mo rspace="4.2pt">⊗</mo>
         <mrow>
          <mo fence="true" stretchy="false">|</mo>
          <mi>k</mi>
          <mo stretchy="false">⟩</mo>
         </mrow>
        </mrow>
        <mrow>
         <mo stretchy="false">⟨</mo>
         <mi mathvariant="normal">ℓ</mi>
         <mo fence="true" stretchy="false">|</mo>
        </mrow>
       </mrow>
      </mrow>
      <mo>)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <munder>
      <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
      <mi>j</mi>
     </munder>
     <msub>
      <mi>T</mi>
      <mrow>
       <mi>j</mi>
       <mi>j</mi>
      </mrow>
     </msub>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>Tr</ci>
      <ci>W</ci>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <list>
        <ci>k</ci>
        <ci>normal-ℓ</ci>
       </list>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="latexml">tensor-product</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>T</ci>
         <apply>
          <times></times>
          <ci>k</ci>
          <ci>normal-ℓ</ci>
         </apply>
        </apply>
        <apply>
         <csymbol cd="latexml">ket</csymbol>
         <ci>k</ci>
        </apply>
       </apply>
       <apply>
        <csymbol cd="latexml">bra</csymbol>
        <ci>normal-ℓ</ci>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <sum></sum>
      <ci>j</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>T</ci>
      <apply>
       <times></times>
       <ci>j</ci>
       <ci>j</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \operatorname{Tr}_{W}\left(\sum_{k,\ell}T_{k\ell}\,\otimes\,|k\rangle\langle%
\ell|\right)=\sum_{j}T_{jj}.
  </annotation>
 </semantics>
</math>

</p>
<h2 id="partial-trace-and-invariant-integration">Partial trace and invariant integration</h2>

<p>In the case of finite dimensional Hilbert spaces, there is a useful way of looking at partial trace involving integration with respect to a suitably normalized Haar measure μ over the unitary group U(<em>W</em>) of <em>W</em>. Suitably normalized means that μ is taken to be a measure with total mass dim(<em>W</em>).</p>

<p><strong>Theorem</strong>. Suppose <em>V</em>, <em>W</em> are finite dimensional Hilbert spaces. Then</p>

<p>

<math display="block" id="Partial_trace:46">
 <semantics>
  <mrow>
   <msub>
    <mo largeop="true" symmetric="true">∫</mo>
    <mrow>
     <mo>U</mo>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>W</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </msub>
   <mrow>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <msub>
       <mi>I</mi>
       <mi>V</mi>
      </msub>
      <mo>⊗</mo>
      <msup>
       <mi>U</mi>
       <mo>*</mo>
      </msup>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
    <mi>T</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <msub>
       <mi>I</mi>
       <mi>V</mi>
      </msub>
      <mo>⊗</mo>
      <mi>U</mi>
     </mrow>
     <mo rspace="7.5pt" stretchy="false">)</mo>
    </mrow>
    <mi>d</mi>
    <mi>μ</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>U</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <int></int>
     <apply>
      <ci>normal-U</ci>
      <ci>W</ci>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="latexml">tensor-product</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>I</ci>
       <ci>V</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>U</ci>
       <times></times>
      </apply>
     </apply>
     <ci>T</ci>
     <apply>
      <csymbol cd="latexml">tensor-product</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>I</ci>
       <ci>V</ci>
      </apply>
      <ci>U</ci>
     </apply>
     <ci>d</ci>
     <ci>μ</ci>
     <ci>U</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \int_{\operatorname{U}(W)}(I_{V}\otimes U^{*})T(I_{V}\otimes U)\ d\mu(U)
  </annotation>
 </semantics>
</math>

</p>

<p>commutes with all operators of the form 

<math display="inline" id="Partial_trace:47">
 <semantics>
  <mrow>
   <msub>
    <mi>I</mi>
    <mi>V</mi>
   </msub>
   <mo>⊗</mo>
   <mi>S</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">tensor-product</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>I</ci>
     <ci>V</ci>
    </apply>
    <ci>S</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   I_{V}\otimes S
  </annotation>
 </semantics>
</math>

 and hence is uniquely of the form 

<math display="inline" id="Partial_trace:48">
 <semantics>
  <mrow>
   <mi>R</mi>
   <mo>⊗</mo>
   <msub>
    <mi>I</mi>
    <mi>W</mi>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">tensor-product</csymbol>
    <ci>R</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>I</ci>
     <ci>W</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   R\otimes I_{W}
  </annotation>
 </semantics>
</math>

. The operator <em>R</em> is the partial trace of <em>T</em>.</p>
<h2 id="partial-trace-as-a-quantum-operation">Partial trace as a quantum operation</h2>

<p>The partial trace can be viewed as a <a href="quantum_operation" title="wikilink">quantum operation</a>. Consider a quantum mechanical system whose state space is the tensor product 

<math display="inline" id="Partial_trace:49">
 <semantics>
  <mrow>
   <msub>
    <mi>H</mi>
    <mi>A</mi>
   </msub>
   <mo>⊗</mo>
   <msub>
    <mi>H</mi>
    <mi>B</mi>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">tensor-product</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>H</ci>
     <ci>A</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>H</ci>
     <ci>B</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   H_{A}\otimes H_{B}
  </annotation>
 </semantics>
</math>

 of Hilbert spaces. A mixed state is described by a <a href="density_matrix" title="wikilink">density matrix</a> ρ, that is a non-negative trace-class operator of trace 1 on the tensor product 

<math display="inline" id="Partial_trace:50">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>H</mi>
     <mi>A</mi>
    </msub>
    <mo>⊗</mo>
    <msub>
     <mi>H</mi>
     <mi>B</mi>
    </msub>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">tensor-product</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>H</ci>
     <ci>A</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>H</ci>
     <ci>B</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   H_{A}\otimes H_{B}.
  </annotation>
 </semantics>
</math>

 The partial trace of ρ with respect to the system <em>B</em>, denoted by 

<math display="inline" id="Partial_trace:51">
 <semantics>
  <msup>
   <mi>ρ</mi>
   <mi>A</mi>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>ρ</ci>
    <ci>A</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \rho^{A}
  </annotation>
 </semantics>
</math>

, is called the reduced state of ρ on system <em>A</em>. In symbols,</p>

<p>

<math display="block" id="Partial_trace:52">
 <semantics>
  <mrow>
   <mrow>
    <msup>
     <mi>ρ</mi>
     <mi>A</mi>
    </msup>
    <mo>=</mo>
    <mrow>
     <msub>
      <mo>Tr</mo>
      <mi>B</mi>
     </msub>
     <mi>ρ</mi>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>ρ</ci>
     <ci>A</ci>
    </apply>
    <apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>Tr</ci>
      <ci>B</ci>
     </apply>
     <ci>ρ</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \rho^{A}=\operatorname{Tr}_{B}\rho.
  </annotation>
 </semantics>
</math>

</p>

<p>To show that this is indeed a sensible way to assign a state on the <em>A</em> subsystem to ρ, we offer the following justification. Let <em>M</em> be an observable on the subsystem <em>A</em>, then the corresponding observable on the composite system is 

<math display="inline" id="Partial_trace:53">
 <semantics>
  <mrow>
   <mi>M</mi>
   <mo>⊗</mo>
   <mi>I</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">tensor-product</csymbol>
    <ci>M</ci>
    <ci>I</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   M\otimes I
  </annotation>
 </semantics>
</math>

. However one chooses to define a reduced state 

<math display="inline" id="Partial_trace:54">
 <semantics>
  <msup>
   <mi>ρ</mi>
   <mi>A</mi>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>ρ</ci>
    <ci>A</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \rho^{A}
  </annotation>
 </semantics>
</math>

, there should be consistency of measurement statistics. The expectation value of <em>M</em> after the subsystem <em>A</em> is prepared in 

<math display="inline" id="Partial_trace:55">
 <semantics>
  <msup>
   <mi>ρ</mi>
   <mi>A</mi>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>ρ</ci>
    <ci>A</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \rho^{A}
  </annotation>
 </semantics>
</math>

 and that of 

<math display="inline" id="Partial_trace:56">
 <semantics>
  <mrow>
   <mi>M</mi>
   <mo>⊗</mo>
   <mi>I</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">tensor-product</csymbol>
    <ci>M</ci>
    <ci>I</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   M\otimes I
  </annotation>
 </semantics>
</math>

 when the composite system is prepared in ρ should be the same, i.e. the following equality should hold:</p>

<p>

<math display="block" id="Partial_trace:57">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mo>Tr</mo>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mi>M</mi>
       <mo>⋅</mo>
       <msup>
        <mi>ρ</mi>
        <mi>A</mi>
       </msup>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mo>Tr</mo>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mrow>
        <mi>M</mi>
        <mo>⊗</mo>
        <mi>I</mi>
       </mrow>
       <mo>⋅</mo>
       <mi>ρ</mi>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <ci>Tr</ci>
     <apply>
      <ci>normal-⋅</ci>
      <ci>M</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>ρ</ci>
       <ci>A</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <ci>Tr</ci>
     <apply>
      <ci>normal-⋅</ci>
      <apply>
       <csymbol cd="latexml">tensor-product</csymbol>
       <ci>M</ci>
       <ci>I</ci>
      </apply>
      <ci>ρ</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \operatorname{Tr}(M\cdot\rho^{A})=\operatorname{Tr}(M\otimes I\cdot\rho).
  </annotation>
 </semantics>
</math>

</p>

<p>We see that this is satisfied if 

<math display="inline" id="Partial_trace:58">
 <semantics>
  <msup>
   <mi>ρ</mi>
   <mi>A</mi>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>ρ</ci>
    <ci>A</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \rho^{A}
  </annotation>
 </semantics>
</math>

 is as defined above via the partial trace. Furthermore it is the unique such operation.</p>

<p>Let <em>T(H)</em> be the <a href="Banach_space" title="wikilink">Banach space</a> of trace-class operators on the Hilbert space <em>H</em>. It can be easily checked that the partial trace, viewed as a map</p>

<p>

<math display="block" id="Partial_trace:59">
 <semantics>
  <mrow>
   <msub>
    <mo>Tr</mo>
    <mi>B</mi>
   </msub>
   <mo>:</mo>
   <mrow>
    <mrow>
     <mi>T</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <msub>
        <mi>H</mi>
        <mi>A</mi>
       </msub>
       <mo>⊗</mo>
       <msub>
        <mi>H</mi>
        <mi>B</mi>
       </msub>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>→</mo>
    <mrow>
     <mi>T</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <msub>
       <mi>H</mi>
       <mi>A</mi>
      </msub>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-:</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>Tr</ci>
     <ci>B</ci>
    </apply>
    <apply>
     <ci>normal-→</ci>
     <apply>
      <times></times>
      <ci>T</ci>
      <apply>
       <csymbol cd="latexml">tensor-product</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>H</ci>
        <ci>A</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>H</ci>
        <ci>B</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <ci>T</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>H</ci>
       <ci>A</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \operatorname{Tr}_{B}:T(H_{A}\otimes H_{B})\rightarrow T(H_{A})
  </annotation>
 </semantics>
</math>

 is completely positive and trace-preserving.</p>

<p>The partial trace map as given above induces a dual map 

<math display="inline" id="Partial_trace:60">
 <semantics>
  <msubsup>
   <mo>Tr</mo>
   <mi>B</mi>
   <mo>*</mo>
  </msubsup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>Tr</ci>
     <ci>B</ci>
    </apply>
    <times></times>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \operatorname{Tr}_{B}^{*}
  </annotation>
 </semantics>
</math>

 between the <a href="C*-algebra" title="wikilink">C*-algebras</a> of bounded operators on 

<math display="inline" id="Partial_trace:61">
 <semantics>
  <msub>
   <mpadded lspace="2.8pt" width="+2.8pt">
    <mi>H</mi>
   </mpadded>
   <mi>A</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>H</ci>
    <ci>A</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \;H_{A}
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Partial_trace:62">
 <semantics>
  <mrow>
   <msub>
    <mi>H</mi>
    <mi>A</mi>
   </msub>
   <mo>⊗</mo>
   <msub>
    <mi>H</mi>
    <mi>B</mi>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">tensor-product</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>H</ci>
     <ci>A</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>H</ci>
     <ci>B</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   H_{A}\otimes H_{B}
  </annotation>
 </semantics>
</math>

 given by</p>

<p>

<math display="block" id="Partial_trace:63">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <msubsup>
      <mo>Tr</mo>
      <mi>B</mi>
      <mo>*</mo>
     </msubsup>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>A</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mi>A</mi>
     <mo>⊗</mo>
     <mi>I</mi>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>Tr</ci>
       <ci>B</ci>
      </apply>
      <times></times>
     </apply>
     <ci>A</ci>
    </apply>
    <apply>
     <csymbol cd="latexml">tensor-product</csymbol>
     <ci>A</ci>
     <ci>I</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \operatorname{Tr}_{B}^{*}(A)=A\otimes I.
  </annotation>
 </semantics>
</math>

 

<math display="inline" id="Partial_trace:64">
 <semantics>
  <msubsup>
   <mo>Tr</mo>
   <mi>B</mi>
   <mo>*</mo>
  </msubsup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>Tr</ci>
     <ci>B</ci>
    </apply>
    <times></times>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \operatorname{Tr}_{B}^{*}
  </annotation>
 </semantics>
</math>

 maps observables to observables and is the <a href="Heisenberg_picture" title="wikilink">Heisenberg picture</a> representation of 

<math display="inline" id="Partial_trace:65">
 <semantics>
  <msub>
   <mo>Tr</mo>
   <mi>B</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>Tr</ci>
    <ci>B</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \operatorname{Tr}_{B}
  </annotation>
 </semantics>
</math>

.</p>
<h3 id="comparison-with-classical-case">Comparison with classical case</h3>

<p>Suppose instead of quantum mechanical systems, the two systems <em>A</em> and <em>B</em> are classical. The space of observables for each system are then abelian C*-algebras. These are of the form <em>C</em>(<em>X</em>) and <em>C</em>(<em>Y</em>) respectively for compact spaces <em>X</em>, <em>Y</em>. The state space of the composite system is simply</p>

<p>

<math display="block" id="Partial_trace:66">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mrow>
      <mrow>
       <mi>C</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>X</mi>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
      <mo>⊗</mo>
      <mi>C</mi>
     </mrow>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>Y</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mi>C</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mi>X</mi>
       <mo>×</mo>
       <mi>Y</mi>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="latexml">tensor-product</csymbol>
      <apply>
       <times></times>
       <ci>C</ci>
       <ci>X</ci>
      </apply>
      <ci>C</ci>
     </apply>
     <ci>Y</ci>
    </apply>
    <apply>
     <times></times>
     <ci>C</ci>
     <apply>
      <times></times>
      <ci>X</ci>
      <ci>Y</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   C(X)\otimes C(Y)=C(X\times Y).
  </annotation>
 </semantics>
</math>

</p>

<p>A state on the composite system is a positive element ρ of the dual of C(<em>X</em> × <em>Y</em>), which by the <a href="Riesz-Markov_theorem" title="wikilink">Riesz-Markov theorem</a> corresponds to a regular Borel measure on <em>X</em> × <em>Y</em>. The corresponding reduced state is obtained by projecting the measure ρ to <em>X</em>. Thus the partial trace is the quantum mechanical equivalent of this operation.</p>

<p>"</p>

<p><a href="Category:Linear_algebra" title="wikilink">Category:Linear algebra</a> <a href="Category:Functional_analysis" title="wikilink">Category:Functional analysis</a></p>
</body>
</html>

<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="83">Lagrange's four-square theorem</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Lagrange's four-square theorem</h1>
<hr/>

<p><strong>Lagrange's four-square theorem</strong>, also known as <strong>Bachet's conjecture</strong>, states that every <a href="natural_number" title="wikilink">natural number</a> can be represented as the sum of four integer <a href="square_number" title="wikilink">squares</a>.</p>

<p>

<math display="block" id="Lagrange's_four-square_theorem:0">
 <semantics>
  <mrow>
   <mi>p</mi>
   <mo>=</mo>
   <mrow>
    <msubsup>
     <mi>a</mi>
     <mn>0</mn>
     <mn>2</mn>
    </msubsup>
    <mo>+</mo>
    <msubsup>
     <mi>a</mi>
     <mn>1</mn>
     <mn>2</mn>
    </msubsup>
    <mo>+</mo>
    <msubsup>
     <mi>a</mi>
     <mn>2</mn>
     <mn>2</mn>
    </msubsup>
    <mo>+</mo>
    <msubsup>
     <mi>a</mi>
     <mn>3</mn>
     <mn>2</mn>
    </msubsup>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>p</ci>
    <apply>
     <plus></plus>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>a</ci>
       <cn type="integer">0</cn>
      </apply>
      <cn type="integer">2</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>a</ci>
       <cn type="integer">1</cn>
      </apply>
      <cn type="integer">2</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>a</ci>
       <cn type="integer">2</cn>
      </apply>
      <cn type="integer">2</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>a</ci>
       <cn type="integer">3</cn>
      </apply>
      <cn type="integer">2</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p=a_{0}^{2}+a_{1}^{2}+a_{2}^{2}+a_{3}^{2}
  </annotation>
 </semantics>
</math>

</p>

<p>where the four numbers 

<math display="inline" id="Lagrange's_four-square_theorem:1">
 <semantics>
  <mrow>
   <msub>
    <mi>a</mi>
    <mn>0</mn>
   </msub>
   <mo>,</mo>
   <msub>
    <mi>a</mi>
    <mn>1</mn>
   </msub>
   <mo>,</mo>
   <msub>
    <mi>a</mi>
    <mn>2</mn>
   </msub>
   <mo>,</mo>
   <msub>
    <mi>a</mi>
    <mn>3</mn>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <list>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>a</ci>
     <cn type="integer">0</cn>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>a</ci>
     <cn type="integer">1</cn>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>a</ci>
     <cn type="integer">2</cn>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>a</ci>
     <cn type="integer">3</cn>
    </apply>
   </list>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a_{0},a_{1},a_{2},a_{3}
  </annotation>
 </semantics>
</math>

 are integers. For illustration, 3, 31 and 310 can be represented as the sum of four squares as follows:</p>

<p>

<math display="inline" id="Lagrange's_four-square_theorem:2">
 <semantics>
  <mn>3</mn>
  <annotation-xml encoding="MathML-Content">
   <cn type="integer">3</cn>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle 3
  </annotation>
 </semantics>
</math>


</p>

<p>This theorem was proved by <a href="Joseph_Louis_Lagrange" title="wikilink">Joseph Louis Lagrange</a> in 1770.</p>
<h2 id="historical-development">Historical development</h2>

<p>From examples given in the <em><a class="uri" href="Arithmetica" title="wikilink">Arithmetica</a></em> it is clear that <a class="uri" href="Diophantus" title="wikilink">Diophantus</a> was aware of the theorem. This book was translated in 1621 into Latin by <a href="Claude_Gaspard_Bachet_de_Méziriac" title="wikilink">Bachet (Claude Gaspard Bachet de Méziriac)</a>, who stated the theorem in the notes of his translation. But the theorem was not proved until 1770 by Lagrange.<a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a></p>

<p><a href="Adrien-Marie_Legendre" title="wikilink">Adrien-Marie Legendre</a> completed the theorem in 1797–8 with his <a href="Legendre's_three-square_theorem" title="wikilink">three-square theorem</a>, by proving that a positive integer can be expressed as the sum of three squares if and only if it is not of the form 

<math display="inline" id="Lagrange's_four-square_theorem:3">
 <semantics>
  <mrow>
   <msup>
    <mn>4</mn>
    <mi>k</mi>
   </msup>
   <mrow>
    <mo stretchy="false">(</mo>
    <mrow>
     <mrow>
      <mn>8</mn>
      <mi>m</mi>
     </mrow>
     <mo>+</mo>
     <mn>7</mn>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <cn type="integer">4</cn>
     <ci>k</ci>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <cn type="integer">8</cn>
      <ci>m</ci>
     </apply>
     <cn type="integer">7</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   4^{k}(8m+7)
  </annotation>
 </semantics>
</math>

 for integers 

<math display="inline" id="Lagrange's_four-square_theorem:4">
 <semantics>
  <mi>k</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>k</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   k
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Lagrange's_four-square_theorem:5">
 <semantics>
  <mi>m</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>m</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   m
  </annotation>
 </semantics>
</math>

. Later, in 1834, <a href="Carl_Gustav_Jakob_Jacobi" title="wikilink">Carl Gustav Jakob Jacobi</a> discovered a simple formula for the number of representations of an integer as the sum of four squares with his own <a href="Jacobi's_four-square_theorem" title="wikilink">four-square theorem</a>.</p>

<p>The formula is also linked to <a href="Descartes'_theorem" title="wikilink">Descartes' theorem</a> of four "kissing circles", which involves the sum of the squares of the curvatures of four circles. This is also linked to <a href="Apollonian_gasket" title="wikilink">Apollonian gaskets</a>, which were more recently related to the <a href="Ramanujan–Petersson_conjecture" title="wikilink">Ramanujan–Petersson conjecture</a>.<a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a></p>
<h2 id="the-classical-proof">The classical proof</h2>

<p>Several very similar modern versions<a class="footnoteRef" href="#fn3" id="fnref3"><sup>3</sup></a><a class="footnoteRef" href="#fn4" id="fnref4"><sup>4</sup></a><a class="footnoteRef" href="#fn5" id="fnref5"><sup>5</sup></a> of Lagrange's proof are easy to find in the literature. The proof below is a slightly simplified version, in which the cases for which <em>m</em> is even or odd do not require separate arguments.</p>

<p>It is sufficient to prove the theorem for every odd prime number <em>p</em>. This immediately follows from <a href="Euler's_four-square_identity" title="wikilink">Euler's four-square identity</a> (and from the fact that the theorem is true for the numbers 1 and 2).</p>

<p>The residues of <em>a</em><sup>2</sup> modulo <em>p</em> are distinct for every <em>a</em> between 0 and (<em>p</em> − 1)/2 (included). To see this, take some <em>a</em> and define <em>c</em> as <em>a</em><sup>2</sup> mod <em>p</em>. <em>a</em> is a root of the polynomial <em>x</em><sup>2</sup> − <em>c</em> over the field <a href="Finite_field" title="wikilink">

<math display="inline" id="Lagrange's_four-square_theorem:6">
 <semantics>
  <mrow>
   <mrow>
    <mi>Z</mi>
    <mo>/</mo>
    <mi>p</mi>
   </mrow>
   <mi>Z</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <divide></divide>
     <ci>Z</ci>
     <ci>p</ci>
    </apply>
    <ci>Z</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Z/pZ
  </annotation>
 </semantics>
</math>

</a>. So is <em>p</em> − <em>a</em> (which is different from <em>a</em>). In a field <em>K</em>, any polynomial of degree <em>n</em> has at most <em>n</em> distinct roots, so there are no other <em>a</em> with this property, in particular not among 0 to (<em>p</em> − 1)/2.</p>

<p>Contingently, for <em>b</em> taking integral values between 0 and (<em>p</em> − 1)/2 (included), the −<em>b</em><sup>2</sup> − 1 are distinct. By the pigeonhole principle, there are <em>a</em> and <em>b</em> in this range, for which <em>a</em><sup>2</sup> and −<em>b</em><sup>2</sup> − 1 are congruent modulo p, that is for which</p>
<center>

<p><em>a</em><sup>2</sup> + <em>b</em><sup>2</sup> + 1<sup>2</sup> + 0<sup>2</sup> = <em>np</em> ,</p>
</center>

<p>with 0 1<sup>2</sup> + <em>x</em><sub>2</sub><sup>2</sup> + <em>x</em><sub>3</sub><sup>2</sup> + <em>x</em><sub>4</sub><sup>2</sup> (we have just shown that there is some <em>m</em> (namely <em>n</em>) with this property, so there is a least one). We show by contradiction that <em>m</em> equals 1: supposing it is not the case, we prove the existence of a positive integer <em>r</em> less than <em>m</em>, for which <em>rp</em> is also the sum of four squares (this is in the spirit of the <a href="proof_by_infinite_descent" title="wikilink">infinite descent</a><ref>Here the argument is a direct <a href="proof_by_contradiction" title="wikilink">proof by contradiction</a>. With the initial assumption that m&gt;2, m<p, <em="">some</p,></ref></p></body></html>="" (not="" an="" argument="" be="" become="" could="" descent="" fermat. method of Fermat).

<p>For this purpose, we consider for each <em>x</em><sub><em>i</em></sub> the <em>y</em><sub><em>i</em></sub> which is in the same residue class modulo <em>m</em> and between (–<em>m</em> + 1)/2 and <em>m</em>/2 (included). It follows that <em>y</em><sub>1</sub><sup>2</sup> + <em>y</em><sub>2</sub><sup>2</sup> + <em>y</em><sub>3</sub><sup>2</sup> + <em>y</em><sub>4</sub><sup>2</sup> = <em>mr</em>, for some positive integer <em>r</em> less than <em>m</em>.</p>

<p>Finally, another appeal to Euler's four-square identity shows that <em>mpmr</em> = <em>z</em><sub>1</sub><sup>2</sup> + <em>z</em><sub>2</sub><sup>2</sup> + <em>z</em><sub>3</sub><sup>2</sup> + <em>z</em><sub>4</sub><sup>2</sup>, where each <em>z</em><sub><em>i</em></sub> is divisible by <em>m</em> (indeed, since each <em>x</em><sub><em>i</em></sub> is congruent to his corresponding <em>y</em><sub><em>i</em></sub>, <em>z</em><sub>1</sub> is congruent modulo <em>m</em> to <em>y</em><sub>1</sub><sup>2</sup> + <em>y</em><sub>2</sub><sup>2</sup> + <em>y</em><sub>3</sub><sup>2</sup> + <em>y</em><sub>4</sub><sup>2</sup> = <em>m</em> <em>r</em>; for the same reason the other <em>z</em><sub><em>i</em></sub> are also divisible by <em>m</em>). It follows that, for <em>w</em><sub>i</sub> = <em>z</em><sub><em>i</em></sub>/<em>m</em>, <em>w</em><sub>1</sub><sup>2</sup> + <em>w</em><sub>2</sub><sup>2</sup> + <em>w</em><sub>3</sub><sup>2</sup> + <em>w</em><sub>4</sub><sup>2</sup> = <em>rp</em>, and this is in contradiction with the minimality of <em>m</em>.</p>
<h2 id="proof-using-the-hurwitz-integers">Proof using the Hurwitz integers</h2>

<p>One of the ways to prove the theorem relies on <a href="Hurwitz_quaternion" title="wikilink">Hurwitz quaternions</a>, which are the analog of <a href="integer" title="wikilink">integers</a> for <a href="quaternion" title="wikilink">quaternions</a>.<a class="footnoteRef" href="#fn6" id="fnref6"><sup>6</sup></a> The Hurwitz quaternions consist of all quaternions with integer components and all quaternions with <a class="uri" href="half-integer" title="wikilink">half-integer</a> components. These two sets can be combined into a single formula</p>

<p>

<math display="block" id="Lagrange's_four-square_theorem:7">
 <semantics>
  <mrow>
   <mi>α</mi>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mfrac>
      <mn>1</mn>
      <mn>2</mn>
     </mfrac>
     <msub>
      <mi>E</mi>
      <mn>0</mn>
     </msub>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mn>1</mn>
       <mo>+</mo>
       <mi>𝐢</mi>
       <mo>+</mo>
       <mi>𝐣</mi>
       <mo>+</mo>
       <mi>𝐤</mi>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>+</mo>
    <mrow>
     <msub>
      <mi>E</mi>
      <mn>1</mn>
     </msub>
     <mi>𝐢</mi>
    </mrow>
    <mo>+</mo>
    <mrow>
     <msub>
      <mi>E</mi>
      <mn>2</mn>
     </msub>
     <mi>𝐣</mi>
    </mrow>
    <mo>+</mo>
    <mrow>
     <msub>
      <mi>E</mi>
      <mn>3</mn>
     </msub>
     <mi>𝐤</mi>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <msub>
     <mi>a</mi>
     <mn>0</mn>
    </msub>
    <mo>+</mo>
    <mrow>
     <msub>
      <mi>a</mi>
      <mn>1</mn>
     </msub>
     <mi>𝐢</mi>
    </mrow>
    <mo>+</mo>
    <mrow>
     <msub>
      <mi>a</mi>
      <mn>2</mn>
     </msub>
     <mi>𝐣</mi>
    </mrow>
    <mo>+</mo>
    <mrow>
     <msub>
      <mi>a</mi>
      <mn>3</mn>
     </msub>
     <mi>𝐤</mi>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <ci>α</ci>
     <apply>
      <plus></plus>
      <apply>
       <times></times>
       <apply>
        <divide></divide>
        <cn type="integer">1</cn>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>E</ci>
        <cn type="integer">0</cn>
       </apply>
       <apply>
        <plus></plus>
        <cn type="integer">1</cn>
        <ci>𝐢</ci>
        <ci>𝐣</ci>
        <ci>𝐤</ci>
       </apply>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>E</ci>
        <cn type="integer">1</cn>
       </apply>
       <ci>𝐢</ci>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>E</ci>
        <cn type="integer">2</cn>
       </apply>
       <ci>𝐣</ci>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>E</ci>
        <cn type="integer">3</cn>
       </apply>
       <ci>𝐤</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <plus></plus>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>a</ci>
       <cn type="integer">0</cn>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>a</ci>
        <cn type="integer">1</cn>
       </apply>
       <ci>𝐢</ci>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>a</ci>
        <cn type="integer">2</cn>
       </apply>
       <ci>𝐣</ci>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>a</ci>
        <cn type="integer">3</cn>
       </apply>
       <ci>𝐤</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \alpha=\frac{1}{2}E_{0}(1+\mathbf{i}+\mathbf{j}+\mathbf{k})+E_{1}\mathbf{i}+E_%
{2}\mathbf{j}+E_{3}\mathbf{k}=a_{0}+a_{1}\mathbf{i}+a_{2}\mathbf{j}+a_{3}%
\mathbf{k}
  </annotation>
 </semantics>
</math>

</p>

<p>where 

<math display="inline" id="Lagrange's_four-square_theorem:8">
 <semantics>
  <mrow>
   <msub>
    <mi>E</mi>
    <mn>0</mn>
   </msub>
   <mo>,</mo>
   <msub>
    <mi>E</mi>
    <mn>1</mn>
   </msub>
   <mo>,</mo>
   <msub>
    <mi>E</mi>
    <mn>2</mn>
   </msub>
   <mo>,</mo>
   <msub>
    <mi>E</mi>
    <mn>3</mn>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <list>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>E</ci>
     <cn type="integer">0</cn>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>E</ci>
     <cn type="integer">1</cn>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>E</ci>
     <cn type="integer">2</cn>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>E</ci>
     <cn type="integer">3</cn>
    </apply>
   </list>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   E_{0},E_{1},E_{2},E_{3}
  </annotation>
 </semantics>
</math>

 are integers. Thus, the quaternion components 

<math display="inline" id="Lagrange's_four-square_theorem:9">
 <semantics>
  <mrow>
   <msub>
    <mi>a</mi>
    <mn>0</mn>
   </msub>
   <mo>,</mo>
   <msub>
    <mi>a</mi>
    <mn>1</mn>
   </msub>
   <mo>,</mo>
   <msub>
    <mi>a</mi>
    <mn>2</mn>
   </msub>
   <mo>,</mo>
   <msub>
    <mi>a</mi>
    <mn>3</mn>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <list>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>a</ci>
     <cn type="integer">0</cn>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>a</ci>
     <cn type="integer">1</cn>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>a</ci>
     <cn type="integer">2</cn>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>a</ci>
     <cn type="integer">3</cn>
    </apply>
   </list>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a_{0},a_{1},a_{2},a_{3}
  </annotation>
 </semantics>
</math>

 are either all integers or all half-integers, depending on whether 

<math display="inline" id="Lagrange's_four-square_theorem:10">
 <semantics>
  <msub>
   <mi>E</mi>
   <mn>0</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>E</ci>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   E_{0}
  </annotation>
 </semantics>
</math>

 is even or odd, respectively. The set of Hurwitz quaternions forms a <a href="ring_(mathematics)" title="wikilink">ring</a>; that is to say, the sum or product of any two Hurwitz quaternions is likewise a Hurwitz quaternion.</p>

<p>The <a href="field_norm" title="wikilink">(arithmetic, or field) norm</a> 

<math display="inline" id="Lagrange's_four-square_theorem:11">
 <semantics>
  <mrow>
   <mi mathvariant="normal">N</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>α</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>normal-N</ci>
    <ci>α</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathrm{N}(\alpha)
  </annotation>
 </semantics>
</math>

 of a rational quaternion 

<math display="inline" id="Lagrange's_four-square_theorem:12">
 <semantics>
  <mi>α</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>α</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \alpha
  </annotation>
 </semantics>
</math>

 is the nonnegative <a href="rational_number" title="wikilink">rational number</a></p>

<p>

<math display="block" id="Lagrange's_four-square_theorem:13">
 <semantics>
  <mrow>
   <mrow>
    <mi mathvariant="normal">N</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>α</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mi>α</mi>
    <mover accent="true">
     <mi>α</mi>
     <mo stretchy="false">¯</mo>
    </mover>
   </mrow>
   <mo>=</mo>
   <mrow>
    <msubsup>
     <mi>a</mi>
     <mn>0</mn>
     <mn>2</mn>
    </msubsup>
    <mo>+</mo>
    <msubsup>
     <mi>a</mi>
     <mn>1</mn>
     <mn>2</mn>
    </msubsup>
    <mo>+</mo>
    <msubsup>
     <mi>a</mi>
     <mn>2</mn>
     <mn>2</mn>
    </msubsup>
    <mo>+</mo>
    <msubsup>
     <mi>a</mi>
     <mn>3</mn>
     <mn>2</mn>
    </msubsup>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <times></times>
      <ci>normal-N</ci>
      <ci>α</ci>
     </apply>
     <apply>
      <times></times>
      <ci>α</ci>
      <apply>
       <ci>normal-¯</ci>
       <ci>α</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <plus></plus>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>a</ci>
        <cn type="integer">0</cn>
       </apply>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>a</ci>
        <cn type="integer">1</cn>
       </apply>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>a</ci>
        <cn type="integer">2</cn>
       </apply>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>a</ci>
        <cn type="integer">3</cn>
       </apply>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathrm{N}(\alpha)=\alpha\bar{\alpha}=a_{0}^{2}+a_{1}^{2}+a_{2}^{2}+a_{3}^{2}
  </annotation>
 </semantics>
</math>

</p>

<p>where 

<math display="inline" id="Lagrange's_four-square_theorem:14">
 <semantics>
  <mrow>
   <mover accent="true">
    <mi>α</mi>
    <mo stretchy="false">¯</mo>
   </mover>
   <mo>=</mo>
   <mrow>
    <msub>
     <mi>a</mi>
     <mn>0</mn>
    </msub>
    <mo>-</mo>
    <mrow>
     <msub>
      <mi>a</mi>
      <mn>1</mn>
     </msub>
     <mi>𝐢</mi>
    </mrow>
    <mo>-</mo>
    <mrow>
     <msub>
      <mi>a</mi>
      <mn>2</mn>
     </msub>
     <mi>𝐣</mi>
    </mrow>
    <mo>-</mo>
    <mrow>
     <msub>
      <mi>a</mi>
      <mn>3</mn>
     </msub>
     <mi>𝐤</mi>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <ci>normal-¯</ci>
     <ci>α</ci>
    </apply>
    <apply>
     <minus></minus>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>a</ci>
      <cn type="integer">0</cn>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>a</ci>
       <cn type="integer">1</cn>
      </apply>
      <ci>𝐢</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>a</ci>
       <cn type="integer">2</cn>
      </apply>
      <ci>𝐣</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>a</ci>
       <cn type="integer">3</cn>
      </apply>
      <ci>𝐤</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \bar{\alpha}=a_{0}-a_{1}\mathbf{i}-a_{2}\mathbf{j}-a_{3}\mathbf{k}
  </annotation>
 </semantics>
</math>

 is the <a href="quaternion#Conjugation,_the_norm,_and_division" title="wikilink">conjugate</a> of 

<math display="inline" id="Lagrange's_four-square_theorem:15">
 <semantics>
  <mi>α</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>α</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \alpha
  </annotation>
 </semantics>
</math>

. Note that the norm of a Hurwitz quaternion is always an integer. (If the coefficients are half-integers, then their squares are of the form 

<math display="inline" id="Lagrange's_four-square_theorem:16">
 <semantics>
  <mrow>
   <mrow>
    <mfrac>
     <mn>1</mn>
     <mn>4</mn>
    </mfrac>
    <mo>+</mo>
    <mi>n</mi>
   </mrow>
   <mo>:</mo>
   <mrow>
    <mi>n</mi>
    <mo>∈</mo>
    <mi>ℤ</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-:</ci>
    <apply>
     <plus></plus>
     <apply>
      <divide></divide>
      <cn type="integer">1</cn>
      <cn type="integer">4</cn>
     </apply>
     <ci>n</ci>
    </apply>
    <apply>
     <in></in>
     <ci>n</ci>
     <ci>ℤ</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \tfrac{1}{4}+n:n\in\mathbb{Z}
  </annotation>
 </semantics>
</math>

, and the sum of four such numbers is an integer.)</p>

<p>Since quaternion multiplication is associative, and real numbers commute with other quaternions, the norm of a product of quaternions equals the product of the norms:</p>

<p>

<math display="block" id="Lagrange's_four-square_theorem:17">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi mathvariant="normal">N</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mi>α</mi>
       <mi>β</mi>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mi>α</mi>
     <mi>β</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mover accent="true">
       <mrow>
        <mi>α</mi>
        <mi>β</mi>
       </mrow>
       <mo>¯</mo>
      </mover>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mi>α</mi>
     <mi>β</mi>
     <mover accent="true">
      <mi>β</mi>
      <mo stretchy="false">¯</mo>
     </mover>
     <mover accent="true">
      <mi>α</mi>
      <mo stretchy="false">¯</mo>
     </mover>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mi>α</mi>
     <mi mathvariant="normal">N</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>β</mi>
      <mo stretchy="false">)</mo>
     </mrow>
     <mover accent="true">
      <mi>α</mi>
      <mo stretchy="false">¯</mo>
     </mover>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mi>α</mi>
     <mover accent="true">
      <mi>α</mi>
      <mo stretchy="false">¯</mo>
     </mover>
     <mi mathvariant="normal">N</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>β</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mi mathvariant="normal">N</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>α</mi>
      <mo stretchy="false">)</mo>
     </mrow>
     <mi mathvariant="normal">N</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>β</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <times></times>
      <ci>normal-N</ci>
      <apply>
       <times></times>
       <ci>α</ci>
       <ci>β</ci>
      </apply>
     </apply>
     <apply>
      <times></times>
      <ci>α</ci>
      <ci>β</ci>
      <apply>
       <ci>normal-¯</ci>
       <apply>
        <times></times>
        <ci>α</ci>
        <ci>β</ci>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <ci>α</ci>
      <ci>β</ci>
      <apply>
       <ci>normal-¯</ci>
       <ci>β</ci>
      </apply>
      <apply>
       <ci>normal-¯</ci>
       <ci>α</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <ci>α</ci>
      <ci>normal-N</ci>
      <ci>β</ci>
      <apply>
       <ci>normal-¯</ci>
       <ci>α</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <ci>α</ci>
      <apply>
       <ci>normal-¯</ci>
       <ci>α</ci>
      </apply>
      <ci>normal-N</ci>
      <ci>β</ci>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <ci>normal-N</ci>
      <ci>α</ci>
      <ci>normal-N</ci>
      <ci>β</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathrm{N}(\alpha\beta)=\alpha\beta(\overline{\alpha\beta})=\alpha\beta\bar{%
\beta}\bar{\alpha}=\alpha\mathrm{N}(\beta)\bar{\alpha}=\alpha\bar{\alpha}%
\mathrm{N}(\beta)=\mathrm{N}(\alpha)\mathrm{N}(\beta).
  </annotation>
 </semantics>
</math>

</p>

<p>For any 

<math display="inline" id="Lagrange's_four-square_theorem:18">
 <semantics>
  <mrow>
   <mi>α</mi>
   <mo>≠</mo>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <neq></neq>
    <ci>α</ci>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \alpha\neq 0
  </annotation>
 </semantics>
</math>

, 

<math display="inline" id="Lagrange's_four-square_theorem:19">
 <semantics>
  <mrow>
   <msup>
    <mi>α</mi>
    <mrow>
     <mo>-</mo>
     <mn>1</mn>
    </mrow>
   </msup>
   <mo>=</mo>
   <mrow>
    <mover accent="true">
     <mi>α</mi>
     <mo stretchy="false">¯</mo>
    </mover>
    <mi mathvariant="normal">N</mi>
    <msup>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>α</mi>
      <mo stretchy="false">)</mo>
     </mrow>
     <mrow>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </msup>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>α</ci>
     <apply>
      <minus></minus>
      <cn type="integer">1</cn>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <ci>normal-¯</ci>
      <ci>α</ci>
     </apply>
     <ci>normal-N</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>α</ci>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \alpha^{-1}=\bar{\alpha}\mathrm{N}(\alpha)^{-1}
  </annotation>
 </semantics>
</math>

. It follows easily that 

<math display="inline" id="Lagrange's_four-square_theorem:20">
 <semantics>
  <mi>α</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>α</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \alpha
  </annotation>
 </semantics>
</math>

 is a unit in the ring of Hurwitz quaternions if and only if 

<math display="inline" id="Lagrange's_four-square_theorem:21">
 <semantics>
  <mrow>
   <mrow>
    <mi mathvariant="normal">N</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>α</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>normal-N</ci>
     <ci>α</ci>
    </apply>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathrm{N}(\alpha)=1
  </annotation>
 </semantics>
</math>

.</p>

<p>The proof of the main theorem begins by reduction to the case of prime numbers. <a href="Euler's_four-square_identity" title="wikilink">Euler's four-square identity</a> implies that if Langrange's four-square theorem holds for two numbers, it holds for the product of the two numbers. Since any natural number can be factored into powers of primes, it suffices to prove the theorem for prime numbers. It is true for 

<math display="inline" id="Lagrange's_four-square_theorem:22">
 <semantics>
  <mrow>
   <mn>2</mn>
   <mo>=</mo>
   <mrow>
    <msup>
     <mn>1</mn>
     <mn>2</mn>
    </msup>
    <mo>+</mo>
    <msup>
     <mn>1</mn>
     <mn>2</mn>
    </msup>
    <mo>+</mo>
    <msup>
     <mn>0</mn>
     <mn>2</mn>
    </msup>
    <mo>+</mo>
    <msup>
     <mn>0</mn>
     <mn>2</mn>
    </msup>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <cn type="integer">2</cn>
    <apply>
     <plus></plus>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <cn type="integer">1</cn>
      <cn type="integer">2</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <cn type="integer">1</cn>
      <cn type="integer">2</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <cn type="integer">0</cn>
      <cn type="integer">2</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <cn type="integer">0</cn>
      <cn type="integer">2</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   2=1^{2}+1^{2}+0^{2}+0^{2}
  </annotation>
 </semantics>
</math>

. To show this for an odd prime integer 

<math display="inline" id="Lagrange's_four-square_theorem:23">
 <semantics>
  <mi>p</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>p</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p
  </annotation>
 </semantics>
</math>

, represent it as a quaternion 

<math display="inline" id="Lagrange's_four-square_theorem:24">
 <semantics>
  <mrow>
   <mo stretchy="false">(</mo>
   <mi>p</mi>
   <mo>,</mo>
   <mn>0</mn>
   <mo>,</mo>
   <mn>0</mn>
   <mo>,</mo>
   <mn>0</mn>
   <mo stretchy="false">)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <vector>
    <ci>p</ci>
    <cn type="integer">0</cn>
    <cn type="integer">0</cn>
    <cn type="integer">0</cn>
   </vector>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (p,0,0,0)
  </annotation>
 </semantics>
</math>

 and assume for now (as we shall show later) that it is not a Hurwitz <a href="irreducible_element" title="wikilink">irreducible</a>; that is, it can be factored into two non-unit Hurwitz quaternions</p>

<p>

<math display="block" id="Lagrange's_four-square_theorem:25">
 <semantics>
  <mrow>
   <mrow>
    <mi>p</mi>
    <mo>=</mo>
    <mrow>
     <mi>α</mi>
     <mi>β</mi>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>p</ci>
    <apply>
     <times></times>
     <ci>α</ci>
     <ci>β</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p=\alpha\beta.
  </annotation>
 </semantics>
</math>

</p>

<p>The norms of 

<math display="inline" id="Lagrange's_four-square_theorem:26">
 <semantics>
  <mrow>
   <mi>p</mi>
   <mo>,</mo>
   <mi>α</mi>
   <mo>,</mo>
   <mi>β</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <list>
    <ci>p</ci>
    <ci>α</ci>
    <ci>β</ci>
   </list>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p,\alpha,\beta
  </annotation>
 </semantics>
</math>

 are integers such that</p>

<p>

<math display="block" id="Lagrange's_four-square_theorem:27">
 <semantics>
  <mrow>
   <mrow>
    <mi mathvariant="normal">N</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>p</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <msup>
    <mi>p</mi>
    <mn>2</mn>
   </msup>
   <mo>=</mo>
   <mrow>
    <mi mathvariant="normal">N</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>α</mi>
      <mi>β</mi>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mi mathvariant="normal">N</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>α</mi>
     <mo stretchy="false">)</mo>
    </mrow>
    <mi mathvariant="normal">N</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>β</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <times></times>
      <ci>normal-N</ci>
      <ci>p</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>p</ci>
      <cn type="integer">2</cn>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <ci>normal-N</ci>
      <apply>
       <times></times>
       <ci>α</ci>
       <ci>β</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <ci>normal-N</ci>
      <ci>α</ci>
      <ci>normal-N</ci>
      <ci>β</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathrm{N}(p)=p^{2}=\mathrm{N}(\alpha\beta)=\mathrm{N}(\alpha)\mathrm{N}(\beta)
  </annotation>
 </semantics>
</math>

</p>

<p>and 

<math display="inline" id="Lagrange's_four-square_theorem:28">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi mathvariant="normal">N</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>α</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>,</mo>
    <mrow>
     <mi mathvariant="normal">N</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>β</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>></mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <gt></gt>
    <list>
     <apply>
      <times></times>
      <ci>normal-N</ci>
      <ci>α</ci>
     </apply>
     <apply>
      <times></times>
      <ci>normal-N</ci>
      <ci>β</ci>
     </apply>
    </list>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathrm{N}(\alpha),\mathrm{N}(\beta)>1
  </annotation>
 </semantics>
</math>

. This shows that both 

<math display="inline" id="Lagrange's_four-square_theorem:29">
 <semantics>
  <mrow>
   <mi mathvariant="normal">N</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>α</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>normal-N</ci>
    <ci>α</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathrm{N}(\alpha)
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Lagrange's_four-square_theorem:30">
 <semantics>
  <mrow>
   <mi mathvariant="normal">N</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>β</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>normal-N</ci>
    <ci>β</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathrm{N}(\beta)
  </annotation>
 </semantics>
</math>

 are equal to 

<math display="inline" id="Lagrange's_four-square_theorem:31">
 <semantics>
  <mi>p</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>p</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p
  </annotation>
 </semantics>
</math>

 (since they are integers), and 

<math display="inline" id="Lagrange's_four-square_theorem:32">
 <semantics>
  <mi>p</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>p</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p
  </annotation>
 </semantics>
</math>

 is the sum of four squares</p>

<p>

<math display="block" id="Lagrange's_four-square_theorem:33">
 <semantics>
  <mrow>
   <mrow>
    <mi>p</mi>
    <mo>=</mo>
    <mrow>
     <mi mathvariant="normal">N</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>α</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <msubsup>
      <mi>a</mi>
      <mn>0</mn>
      <mn>2</mn>
     </msubsup>
     <mo>+</mo>
     <msubsup>
      <mi>a</mi>
      <mn>1</mn>
      <mn>2</mn>
     </msubsup>
     <mo>+</mo>
     <msubsup>
      <mi>a</mi>
      <mn>2</mn>
      <mn>2</mn>
     </msubsup>
     <mo>+</mo>
     <msubsup>
      <mi>a</mi>
      <mn>3</mn>
      <mn>2</mn>
     </msubsup>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <ci>p</ci>
     <apply>
      <times></times>
      <ci>normal-N</ci>
      <ci>α</ci>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <plus></plus>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>a</ci>
        <cn type="integer">0</cn>
       </apply>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>a</ci>
        <cn type="integer">1</cn>
       </apply>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>a</ci>
        <cn type="integer">2</cn>
       </apply>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>a</ci>
        <cn type="integer">3</cn>
       </apply>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p=\mathrm{N}(\alpha)=a_{0}^{2}+a_{1}^{2}+a_{2}^{2}+a_{3}^{2}.
  </annotation>
 </semantics>
</math>

</p>

<p>If it happens that the 

<math display="inline" id="Lagrange's_four-square_theorem:34">
 <semantics>
  <mi>α</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>α</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \alpha
  </annotation>
 </semantics>
</math>

 chosen has half-integer coefficients, it can be replaced by another Hurwitz quaternion. Choose 

<math display="inline" id="Lagrange's_four-square_theorem:35">
 <semantics>
  <mrow>
   <mi>ω</mi>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mrow>
       <mo>±</mo>
       <mn>1</mn>
      </mrow>
      <mo>±</mo>
      <mi>𝐢</mi>
      <mo>±</mo>
      <mi>𝐣</mi>
      <mo>±</mo>
      <mi>𝐤</mi>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
    <mo>/</mo>
    <mn>2</mn>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>ω</ci>
    <apply>
     <divide></divide>
     <apply>
      <csymbol cd="latexml">plus-or-minus</csymbol>
      <apply>
       <csymbol cd="latexml">plus-or-minus</csymbol>
       <cn type="integer">1</cn>
      </apply>
      <ci>𝐢</ci>
      <ci>𝐣</ci>
      <ci>𝐤</ci>
     </apply>
     <cn type="integer">2</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \omega=(\pm 1\pm\mathbf{i}\pm\mathbf{j}\pm\mathbf{k})/2
  </annotation>
 </semantics>
</math>

 in such a way that 

<math display="inline" id="Lagrange's_four-square_theorem:36">
 <semantics>
  <mrow>
   <mi>γ</mi>
   <mo>≡</mo>
   <mrow>
    <mi>ω</mi>
    <mo>+</mo>
    <mi>α</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <equivalent></equivalent>
    <ci>γ</ci>
    <apply>
     <plus></plus>
     <ci>ω</ci>
     <ci>α</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \gamma\equiv\omega+\alpha
  </annotation>
 </semantics>
</math>

 has even integer coefficients. Then</p>

<p>

<math display="block" id="Lagrange's_four-square_theorem:37">
 <semantics>
  <mrow>
   <mrow>
    <mi>p</mi>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mover accent="true">
        <mi>γ</mi>
        <mo stretchy="false">¯</mo>
       </mover>
       <mo>-</mo>
       <mover accent="true">
        <mi>ω</mi>
        <mo stretchy="false">¯</mo>
       </mover>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <mi>ω</mi>
     <mover accent="true">
      <mi>ω</mi>
      <mo stretchy="false">¯</mo>
     </mover>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mi>γ</mi>
       <mo>-</mo>
       <mi>ω</mi>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mrow>
        <mover accent="true">
         <mi>γ</mi>
         <mo stretchy="false">¯</mo>
        </mover>
        <mi>ω</mi>
       </mrow>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mrow>
        <mover accent="true">
         <mi>ω</mi>
         <mo stretchy="false">¯</mo>
        </mover>
        <mi>γ</mi>
       </mrow>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <ci>p</ci>
     <apply>
      <times></times>
      <apply>
       <minus></minus>
       <apply>
        <ci>normal-¯</ci>
        <ci>γ</ci>
       </apply>
       <apply>
        <ci>normal-¯</ci>
        <ci>ω</ci>
       </apply>
      </apply>
      <ci>ω</ci>
      <apply>
       <ci>normal-¯</ci>
       <ci>ω</ci>
      </apply>
      <apply>
       <minus></minus>
       <ci>γ</ci>
       <ci>ω</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <apply>
       <minus></minus>
       <apply>
        <times></times>
        <apply>
         <ci>normal-¯</ci>
         <ci>γ</ci>
        </apply>
        <ci>ω</ci>
       </apply>
       <cn type="integer">1</cn>
      </apply>
      <apply>
       <minus></minus>
       <apply>
        <times></times>
        <apply>
         <ci>normal-¯</ci>
         <ci>ω</ci>
        </apply>
        <ci>γ</ci>
       </apply>
       <cn type="integer">1</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p=(\bar{\gamma}-\bar{\omega})\omega\bar{\omega}(\gamma-\omega)=(\bar{\gamma}%
\omega-1)(\bar{\omega}\gamma-1).
  </annotation>
 </semantics>
</math>

</p>

<p>Since 

<math display="inline" id="Lagrange's_four-square_theorem:38">
 <semantics>
  <mi>γ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>γ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \gamma
  </annotation>
 </semantics>
</math>

 has even integer coefficients, 

<math display="inline" id="Lagrange's_four-square_theorem:39">
 <semantics>
  <mrow>
   <mo stretchy="false">(</mo>
   <mrow>
    <mrow>
     <mover accent="true">
      <mi>ω</mi>
      <mo stretchy="false">¯</mo>
     </mover>
     <mi>γ</mi>
    </mrow>
    <mo>-</mo>
    <mn>1</mn>
   </mrow>
   <mo stretchy="false">)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <minus></minus>
    <apply>
     <times></times>
     <apply>
      <ci>normal-¯</ci>
      <ci>ω</ci>
     </apply>
     <ci>γ</ci>
    </apply>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (\bar{\omega}\gamma-1)
  </annotation>
 </semantics>
</math>

 will have integer coefficients and can be used instead of the original 

<math display="inline" id="Lagrange's_four-square_theorem:40">
 <semantics>
  <mi>α</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>α</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \alpha
  </annotation>
 </semantics>
</math>

 to give a representation of 

<math display="inline" id="Lagrange's_four-square_theorem:41">
 <semantics>
  <mi>p</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>p</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p
  </annotation>
 </semantics>
</math>

 as the sum of four squares.</p>

<p>As for showing that 

<math display="inline" id="Lagrange's_four-square_theorem:42">
 <semantics>
  <mi>p</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>p</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p
  </annotation>
 </semantics>
</math>

 is not a Hurwitz irreducible, <a href="Joseph_Louis_Lagrange" title="wikilink">Lagrange</a> proved that any odd prime 

<math display="inline" id="Lagrange's_four-square_theorem:43">
 <semantics>
  <mi>p</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>p</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p
  </annotation>
 </semantics>
</math>

 divides at least one number of the form 

<math display="inline" id="Lagrange's_four-square_theorem:44">
 <semantics>
  <mrow>
   <mi>u</mi>
   <mo>=</mo>
   <mrow>
    <mn>1</mn>
    <mo>+</mo>
    <msup>
     <mi>l</mi>
     <mn>2</mn>
    </msup>
    <mo>+</mo>
    <msup>
     <mi>m</mi>
     <mn>2</mn>
    </msup>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>u</ci>
    <apply>
     <plus></plus>
     <cn type="integer">1</cn>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>l</ci>
      <cn type="integer">2</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>m</ci>
      <cn type="integer">2</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   u=1+l^{2}+m^{2}
  </annotation>
 </semantics>
</math>

, where 

<math display="inline" id="Lagrange's_four-square_theorem:45">
 <semantics>
  <mi>l</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>l</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   l
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Lagrange's_four-square_theorem:46">
 <semantics>
  <mi>m</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>m</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   m
  </annotation>
 </semantics>
</math>

 are integers.<a class="footnoteRef" href="#fn7" id="fnref7"><sup>7</sup></a> This can be seen as follows: since 

<math display="inline" id="Lagrange's_four-square_theorem:47">
 <semantics>
  <mi>p</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>p</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p
  </annotation>
 </semantics>
</math>

 is prime, 

<math display="inline" id="Lagrange's_four-square_theorem:48">
 <semantics>
  <mrow>
   <msup>
    <mi>a</mi>
    <mn>2</mn>
   </msup>
   <mo>≡</mo>
   <mrow>
    <msup>
     <mi>b</mi>
     <mn>2</mn>
    </msup>
    <mspace width="veryverythickmathspace">
    </mspace>
    <mrow>
     <mo lspace="8.1pt" stretchy="false">(</mo>
     <mrow>
      <mo>mod</mo>
      <mi>p</mi>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <equivalent></equivalent>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>a</ci>
     <cn type="integer">2</cn>
    </apply>
    <apply>
     <csymbol cd="latexml">annotated</csymbol>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>b</ci>
      <cn type="integer">2</cn>
     </apply>
     <apply>
      <ci>pmod</ci>
      <ci>p</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a^{2}\equiv b^{2}\;\;(\mathop{{\rm mod}}p)
  </annotation>
 </semantics>
</math>

 can hold for integers 

<math display="inline" id="Lagrange's_four-square_theorem:49">
 <semantics>
  <mrow>
   <mi>a</mi>
   <mo>,</mo>
   <mi>b</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <list>
    <ci>a</ci>
    <ci>b</ci>
   </list>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a,b
  </annotation>
 </semantics>
</math>

, only when 

<math display="inline" id="Lagrange's_four-square_theorem:50">
 <semantics>
  <mrow>
   <mi>a</mi>
   <mo>≡</mo>
   <mrow>
    <mrow>
     <mo>±</mo>
     <mi>b</mi>
    </mrow>
    <mspace width="veryverythickmathspace">
    </mspace>
    <mrow>
     <mo lspace="8.1pt" stretchy="false">(</mo>
     <mrow>
      <mo>mod</mo>
      <mi>p</mi>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <equivalent></equivalent>
    <ci>a</ci>
    <apply>
     <csymbol cd="latexml">annotated</csymbol>
     <apply>
      <csymbol cd="latexml">plus-or-minus</csymbol>
      <ci>b</ci>
     </apply>
     <apply>
      <ci>pmod</ci>
      <ci>p</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a\equiv\pm b\;\;(\mathop{{\rm mod}}p)
  </annotation>
 </semantics>
</math>

. Thus, the set 

<math display="inline" id="Lagrange's_four-square_theorem:51">
 <semantics>
  <mrow>
   <mi>X</mi>
   <mo>=</mo>
   <mrow>
    <mo stretchy="false">{</mo>
    <msup>
     <mn>0</mn>
     <mn>2</mn>
    </msup>
    <mo>,</mo>
    <msup>
     <mn>1</mn>
     <mn>2</mn>
    </msup>
    <mo>,</mo>
    <mi mathvariant="normal">…</mi>
    <mo>,</mo>
    <msup>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mi>p</mi>
         <mo>-</mo>
         <mn>1</mn>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
       <mo>/</mo>
       <mn>2</mn>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <mn>2</mn>
    </msup>
    <mo stretchy="false">}</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>X</ci>
    <set>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <cn type="integer">0</cn>
      <cn type="integer">2</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <cn type="integer">1</cn>
      <cn type="integer">2</cn>
     </apply>
     <ci>normal-…</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <divide></divide>
       <apply>
        <minus></minus>
        <ci>p</ci>
        <cn type="integer">1</cn>
       </apply>
       <cn type="integer">2</cn>
      </apply>
      <cn type="integer">2</cn>
     </apply>
    </set>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   X=\{0^{2},1^{2},\dots,((p-1)/2)^{2}\}
  </annotation>
 </semantics>
</math>

 of squares contains 

<math display="inline" id="Lagrange's_four-square_theorem:52">
 <semantics>
  <mrow>
   <mrow>
    <mo stretchy="false">(</mo>
    <mrow>
     <mi>p</mi>
     <mo>+</mo>
     <mn>1</mn>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>/</mo>
   <mn>2</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <divide></divide>
    <apply>
     <plus></plus>
     <ci>p</ci>
     <cn type="integer">1</cn>
    </apply>
    <cn type="integer">2</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (p+1)/2
  </annotation>
 </semantics>
</math>

 distinct <a href="modular_arithmetic#Congruence_classes" title="wikilink">residues</a> modulo 

<math display="inline" id="Lagrange's_four-square_theorem:53">
 <semantics>
  <mi>p</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>p</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p
  </annotation>
 </semantics>
</math>

. Likewise, 

<math display="inline" id="Lagrange's_four-square_theorem:54">
 <semantics>
  <mrow>
   <mi>Y</mi>
   <mo>=</mo>
   <mrow>
    <mo stretchy="false">{</mo>
    <mrow>
     <mo>-</mo>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mn>1</mn>
       <mo>+</mo>
       <mi>x</mi>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>:</mo>
    <mrow>
     <mi>x</mi>
     <mo>∈</mo>
     <mi>X</mi>
    </mrow>
    <mo stretchy="false">}</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>Y</ci>
    <apply>
     <csymbol cd="latexml">conditional-set</csymbol>
     <apply>
      <minus></minus>
      <apply>
       <plus></plus>
       <cn type="integer">1</cn>
       <ci>x</ci>
      </apply>
     </apply>
     <apply>
      <in></in>
      <ci>x</ci>
      <ci>X</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Y=\{-(1+x):x\in X\}
  </annotation>
 </semantics>
</math>

 contains 

<math display="inline" id="Lagrange's_four-square_theorem:55">
 <semantics>
  <mrow>
   <mrow>
    <mo stretchy="false">(</mo>
    <mrow>
     <mi>p</mi>
     <mo>+</mo>
     <mn>1</mn>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>/</mo>
   <mn>2</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <divide></divide>
    <apply>
     <plus></plus>
     <ci>p</ci>
     <cn type="integer">1</cn>
    </apply>
    <cn type="integer">2</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (p+1)/2
  </annotation>
 </semantics>
</math>

 residues. Since there are only 

<math display="inline" id="Lagrange's_four-square_theorem:56">
 <semantics>
  <mi>p</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>p</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p
  </annotation>
 </semantics>
</math>

 residues in total, and 

<math display="inline" id="Lagrange's_four-square_theorem:57">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mo stretchy="false">|</mo>
     <mi>X</mi>
     <mo stretchy="false">|</mo>
    </mrow>
    <mo>+</mo>
    <mrow>
     <mo stretchy="false">|</mo>
     <mi>Y</mi>
     <mo stretchy="false">|</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mi>p</mi>
    <mo>+</mo>
    <mn>1</mn>
   </mrow>
   <mo>></mo>
   <mi>p</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <plus></plus>
      <apply>
       <abs></abs>
       <ci>X</ci>
      </apply>
      <apply>
       <abs></abs>
       <ci>Y</ci>
      </apply>
     </apply>
     <apply>
      <plus></plus>
      <ci>p</ci>
      <cn type="integer">1</cn>
     </apply>
    </apply>
    <apply>
     <gt></gt>
     <share href="#.cmml">
     </share>
     <ci>p</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   |X|+|Y|=p+1>p
  </annotation>
 </semantics>
</math>

, the sets 

<math display="inline" id="Lagrange's_four-square_theorem:58">
 <semantics>
  <mi>X</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>X</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   X
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Lagrange's_four-square_theorem:59">
 <semantics>
  <mi>Y</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>Y</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Y
  </annotation>
 </semantics>
</math>

 must intersect.</p>

<p>The number 

<math display="inline" id="Lagrange's_four-square_theorem:60">
 <semantics>
  <mi>u</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>u</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   u
  </annotation>
 </semantics>
</math>

 can be factored in Hurwitz quaternions:</p>

<p>

<math display="block" id="Lagrange's_four-square_theorem:61">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mn>1</mn>
     <mo>+</mo>
     <msup>
      <mi>l</mi>
      <mn>2</mn>
     </msup>
     <mo>+</mo>
     <msup>
      <mi>m</mi>
      <mn>2</mn>
     </msup>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mn>1</mn>
       <mo>+</mo>
       <mrow>
        <mpadded width="+2.8pt">
         <mi>l</mi>
        </mpadded>
        <mi>𝐢</mi>
       </mrow>
       <mo>+</mo>
       <mrow>
        <mpadded width="+2.8pt">
         <mi>m</mi>
        </mpadded>
        <mi>𝐣</mi>
       </mrow>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mn>1</mn>
       <mo>-</mo>
       <mrow>
        <mpadded width="+2.8pt">
         <mi>l</mi>
        </mpadded>
        <mi>𝐢</mi>
       </mrow>
       <mo>-</mo>
       <mrow>
        <mpadded width="+2.8pt">
         <mi>m</mi>
        </mpadded>
        <mi>𝐣</mi>
       </mrow>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <plus></plus>
     <cn type="integer">1</cn>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>l</ci>
      <cn type="integer">2</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>m</ci>
      <cn type="integer">2</cn>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <plus></plus>
      <cn type="integer">1</cn>
      <apply>
       <times></times>
       <ci>l</ci>
       <ci>𝐢</ci>
      </apply>
      <apply>
       <times></times>
       <ci>m</ci>
       <ci>𝐣</ci>
      </apply>
     </apply>
     <apply>
      <minus></minus>
      <cn type="integer">1</cn>
      <apply>
       <times></times>
       <ci>l</ci>
       <ci>𝐢</ci>
      </apply>
      <apply>
       <times></times>
       <ci>m</ci>
       <ci>𝐣</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   1+l^{2}+m^{2}=(1+l\;\mathbf{i}+m\;\mathbf{j})(1-l\;\mathbf{i}-m\;\mathbf{j}).
  </annotation>
 </semantics>
</math>

</p>

<p>The norm on Hurwitz quaternions satisfies a form of the <a href="Euclidean_domain" title="wikilink">Euclidean</a> property: for any quaternion 

<math display="inline" id="Lagrange's_four-square_theorem:62">
 <semantics>
  <mrow>
   <mi>α</mi>
   <mo>=</mo>
   <mrow>
    <msub>
     <mi>a</mi>
     <mn>0</mn>
    </msub>
    <mo>+</mo>
    <mrow>
     <msub>
      <mi>a</mi>
      <mn>1</mn>
     </msub>
     <mi>𝐢</mi>
    </mrow>
    <mo>+</mo>
    <mrow>
     <msub>
      <mi>a</mi>
      <mn>2</mn>
     </msub>
     <mi>𝐣</mi>
    </mrow>
    <mo>+</mo>
    <mrow>
     <msub>
      <mi>a</mi>
      <mn>3</mn>
     </msub>
     <mi>𝐤</mi>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>α</ci>
    <apply>
     <plus></plus>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>a</ci>
      <cn type="integer">0</cn>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>a</ci>
       <cn type="integer">1</cn>
      </apply>
      <ci>𝐢</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>a</ci>
       <cn type="integer">2</cn>
      </apply>
      <ci>𝐣</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>a</ci>
       <cn type="integer">3</cn>
      </apply>
      <ci>𝐤</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \alpha=a_{0}+a_{1}\mathbf{i}+a_{2}\mathbf{j}+a_{3}\mathbf{k}
  </annotation>
 </semantics>
</math>

 with rational coefficients we can choose a Hurwitz quaternion 

<math display="inline" id="Lagrange's_four-square_theorem:63">
 <semantics>
  <mrow>
   <mi>β</mi>
   <mo>=</mo>
   <mrow>
    <msub>
     <mi>b</mi>
     <mn>0</mn>
    </msub>
    <mo>+</mo>
    <mrow>
     <msub>
      <mi>b</mi>
      <mn>1</mn>
     </msub>
     <mi>𝐢</mi>
    </mrow>
    <mo>+</mo>
    <mrow>
     <msub>
      <mi>b</mi>
      <mn>2</mn>
     </msub>
     <mi>𝐣</mi>
    </mrow>
    <mo>+</mo>
    <mrow>
     <msub>
      <mi>b</mi>
      <mn>3</mn>
     </msub>
     <mi>𝐤</mi>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>β</ci>
    <apply>
     <plus></plus>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>b</ci>
      <cn type="integer">0</cn>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>b</ci>
       <cn type="integer">1</cn>
      </apply>
      <ci>𝐢</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>b</ci>
       <cn type="integer">2</cn>
      </apply>
      <ci>𝐣</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>b</ci>
       <cn type="integer">3</cn>
      </apply>
      <ci>𝐤</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \beta=b_{0}+b_{1}\mathbf{i}+b_{2}\mathbf{j}+b_{3}\mathbf{k}
  </annotation>
 </semantics>
</math>

 so that 

<math display="inline" id="Lagrange's_four-square_theorem:64">
 <semantics>
  <mrow>
   <mrow>
    <mi mathvariant="normal">N</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>α</mi>
      <mo>-</mo>
      <mi>β</mi>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo><</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <lt></lt>
    <apply>
     <times></times>
     <ci>normal-N</ci>
     <apply>
      <minus></minus>
      <ci>α</ci>
      <ci>β</ci>
     </apply>
    </apply>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathrm{N}(\alpha-\beta)<1
  </annotation>
 </semantics>
</math>

 by first choosing 

<math display="inline" id="Lagrange's_four-square_theorem:65">
 <semantics>
  <msub>
   <mi>b</mi>
   <mn>0</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>b</ci>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   b_{0}
  </annotation>
 </semantics>
</math>

 so that 

<math display="inline" id="Lagrange's_four-square_theorem:66">
 <semantics>
  <mrow>
   <mrow>
    <mo stretchy="false">|</mo>
    <mrow>
     <msub>
      <mi>a</mi>
      <mn>0</mn>
     </msub>
     <mo>-</mo>
     <msub>
      <mi>b</mi>
      <mn>0</mn>
     </msub>
    </mrow>
    <mo stretchy="false">|</mo>
   </mrow>
   <mo>≤</mo>
   <mrow>
    <mn>1</mn>
    <mo>/</mo>
    <mn>4</mn>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <leq></leq>
    <apply>
     <abs></abs>
     <apply>
      <minus></minus>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>a</ci>
       <cn type="integer">0</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>b</ci>
       <cn type="integer">0</cn>
      </apply>
     </apply>
    </apply>
    <apply>
     <divide></divide>
     <cn type="integer">1</cn>
     <cn type="integer">4</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   |a_{0}-b_{0}|\leq 1/4
  </annotation>
 </semantics>
</math>

 and then 

<math display="inline" id="Lagrange's_four-square_theorem:67">
 <semantics>
  <mrow>
   <msub>
    <mi>b</mi>
    <mn>1</mn>
   </msub>
   <mo>,</mo>
   <msub>
    <mi>b</mi>
    <mn>2</mn>
   </msub>
   <mo>,</mo>
   <msub>
    <mi>b</mi>
    <mn>3</mn>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <list>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>b</ci>
     <cn type="integer">1</cn>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>b</ci>
     <cn type="integer">2</cn>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>b</ci>
     <cn type="integer">3</cn>
    </apply>
   </list>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   b_{1},b_{2},b_{3}
  </annotation>
 </semantics>
</math>

 so that 

<math display="inline" id="Lagrange's_four-square_theorem:68">
 <semantics>
  <mrow>
   <mrow>
    <mo stretchy="false">|</mo>
    <mrow>
     <msub>
      <mi>a</mi>
      <mi>i</mi>
     </msub>
     <mo>-</mo>
     <msub>
      <mi>b</mi>
      <mi>i</mi>
     </msub>
    </mrow>
    <mo stretchy="false">|</mo>
   </mrow>
   <mo>≤</mo>
   <mrow>
    <mn>1</mn>
    <mo>/</mo>
    <mn>2</mn>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <leq></leq>
    <apply>
     <abs></abs>
     <apply>
      <minus></minus>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>a</ci>
       <ci>i</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>b</ci>
       <ci>i</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <divide></divide>
     <cn type="integer">1</cn>
     <cn type="integer">2</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   |a_{i}-b_{i}|\leq 1/2
  </annotation>
 </semantics>
</math>

 for 

<math display="inline" id="Lagrange's_four-square_theorem:69">
 <semantics>
  <mrow>
   <mi>i</mi>
   <mo>=</mo>
   <mrow>
    <mn>1</mn>
    <mo>,</mo>
    <mn>2</mn>
    <mo>,</mo>
    <mn>3</mn>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>i</ci>
    <list>
     <cn type="integer">1</cn>
     <cn type="integer">2</cn>
     <cn type="integer">3</cn>
    </list>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   i=1,2,3
  </annotation>
 </semantics>
</math>

. Then we obtain</p>

<p>

<math display="inline" id="Lagrange's_four-square_theorem:70">
 <semantics>
  <mrow>
   <mi mathvariant="normal">N</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mrow>
     <mi>α</mi>
     <mo>-</mo>
     <mi>β</mi>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>normal-N</ci>
    <apply>
     <minus></minus>
     <ci>α</ci>
     <ci>β</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle\mathrm{N}(\alpha-\beta)
  </annotation>
 </semantics>
</math>


</p>

<p>It follows that for any Hurwitz quaternions 

<math display="inline" id="Lagrange's_four-square_theorem:71">
 <semantics>
  <mrow>
   <mi>α</mi>
   <mo>,</mo>
   <mi>β</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <list>
    <ci>α</ci>
    <ci>β</ci>
   </list>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \alpha,\beta
  </annotation>
 </semantics>
</math>

 with 

<math display="inline" id="Lagrange's_four-square_theorem:72">
 <semantics>
  <mrow>
   <mi>α</mi>
   <mo>≠</mo>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <neq></neq>
    <ci>α</ci>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \alpha\neq 0
  </annotation>
 </semantics>
</math>

, there exists a Hurwitz quaternion 

<math display="inline" id="Lagrange's_four-square_theorem:73">
 <semantics>
  <mi>γ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>γ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \gamma
  </annotation>
 </semantics>
</math>

 such that</p>

<p>

<math display="block" id="Lagrange's_four-square_theorem:74">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi mathvariant="normal">N</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mi>β</mi>
       <mo>-</mo>
       <mrow>
        <mi>α</mi>
        <mi>γ</mi>
       </mrow>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo><</mo>
    <mrow>
     <mi mathvariant="normal">N</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>α</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <lt></lt>
    <apply>
     <times></times>
     <ci>normal-N</ci>
     <apply>
      <minus></minus>
      <ci>β</ci>
      <apply>
       <times></times>
       <ci>α</ci>
       <ci>γ</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <times></times>
     <ci>normal-N</ci>
     <ci>α</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathrm{N}(\beta-\alpha\gamma)<\mathrm{N}(\alpha).
  </annotation>
 </semantics>
</math>

</p>

<p>The ring 

<math display="inline" id="Lagrange's_four-square_theorem:75">
 <semantics>
  <mi>H</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>H</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   H
  </annotation>
 </semantics>
</math>

 of Hurwitz quaternions is not commutative, hence it is not an actual Euclidean domain, and it does not have <a href="unique_factorization_domain" title="wikilink">unique factorization</a> in the usual sense. Nevertheless, the property above implies that every right <a href="ideal_(ring_theory)" title="wikilink">ideal</a> is <a href="principal_ideal" title="wikilink">principal</a>. Thus, there is a Hurwitz quaternion 

<math display="inline" id="Lagrange's_four-square_theorem:76">
 <semantics>
  <mi>α</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>α</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \alpha
  </annotation>
 </semantics>
</math>

 such that</p>

<p>

<math display="block" id="Lagrange's_four-square_theorem:77">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>α</mi>
     <mi>H</mi>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mi>p</mi>
      <mi>H</mi>
     </mrow>
     <mo>+</mo>
     <mrow>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mn>1</mn>
        <mo>-</mo>
        <mrow>
         <mpadded width="+2.8pt">
          <mi>l</mi>
         </mpadded>
         <mi>𝐢</mi>
        </mrow>
        <mo>-</mo>
        <mrow>
         <mpadded width="+2.8pt">
          <mi>m</mi>
         </mpadded>
         <mi>𝐣</mi>
        </mrow>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
      <mi>H</mi>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>α</ci>
     <ci>H</ci>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <ci>p</ci>
      <ci>H</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
       <apply>
        <times></times>
        <ci>l</ci>
        <ci>𝐢</ci>
       </apply>
       <apply>
        <times></times>
        <ci>m</ci>
        <ci>𝐣</ci>
       </apply>
      </apply>
      <ci>H</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \alpha H=pH+(1-l\;\mathbf{i}-m\;\mathbf{j})H.
  </annotation>
 </semantics>
</math>

</p>

<p>In particular, 

<math display="inline" id="Lagrange's_four-square_theorem:78">
 <semantics>
  <mrow>
   <mi>p</mi>
   <mo>=</mo>
   <mrow>
    <mi>α</mi>
    <mi>β</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>p</ci>
    <apply>
     <times></times>
     <ci>α</ci>
     <ci>β</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p=\alpha\beta
  </annotation>
 </semantics>
</math>

 for some Hurwitz quaternion 

<math display="inline" id="Lagrange's_four-square_theorem:79">
 <semantics>
  <mi>β</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>β</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \beta
  </annotation>
 </semantics>
</math>

. If 

<math display="inline" id="Lagrange's_four-square_theorem:80">
 <semantics>
  <mi>β</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>β</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \beta
  </annotation>
 </semantics>
</math>

 were a unit, 

<math display="inline" id="Lagrange's_four-square_theorem:81">
 <semantics>
  <mrow>
   <mn>1</mn>
   <mo>-</mo>
   <mrow>
    <mpadded width="+2.8pt">
     <mi>l</mi>
    </mpadded>
    <mi>𝐢</mi>
   </mrow>
   <mo>-</mo>
   <mrow>
    <mpadded width="+2.8pt">
     <mi>m</mi>
    </mpadded>
    <mi>𝐣</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <minus></minus>
    <cn type="integer">1</cn>
    <apply>
     <times></times>
     <ci>l</ci>
     <ci>𝐢</ci>
    </apply>
    <apply>
     <times></times>
     <ci>m</ci>
     <ci>𝐣</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   1-l\;\mathbf{i}-m\;\mathbf{j}
  </annotation>
 </semantics>
</math>

 would be a multiple of 

<math display="inline" id="Lagrange's_four-square_theorem:82">
 <semantics>
  <mi>p</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>p</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p
  </annotation>
 </semantics>
</math>

, however this is impossible as 

<math display="inline" id="Lagrange's_four-square_theorem:83">
 <semantics>
  <mrow>
   <mrow>
    <mn>1</mn>
    <mo>/</mo>
    <mi>p</mi>
   </mrow>
   <mo>-</mo>
   <mrow>
    <mrow>
     <mi>l</mi>
     <mo>/</mo>
     <mpadded width="+2.8pt">
      <mi>p</mi>
     </mpadded>
    </mrow>
    <mi>𝐢</mi>
   </mrow>
   <mo>-</mo>
   <mrow>
    <mrow>
     <mi>m</mi>
     <mo>/</mo>
     <mpadded width="+2.8pt">
      <mi>p</mi>
     </mpadded>
    </mrow>
    <mi>𝐣</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <minus></minus>
    <apply>
     <divide></divide>
     <cn type="integer">1</cn>
     <ci>p</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <divide></divide>
      <ci>l</ci>
      <ci>p</ci>
     </apply>
     <ci>𝐢</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <divide></divide>
      <ci>m</ci>
      <ci>p</ci>
     </apply>
     <ci>𝐣</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   1/p-l/p\;\mathbf{i}-m/p\;\mathbf{j}
  </annotation>
 </semantics>
</math>

 is not a Hurwitz quaternion for 

<math display="inline" id="Lagrange's_four-square_theorem:84">
 <semantics>
  <mrow>
   <mi>p</mi>
   <mo>></mo>
   <mn>2</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <gt></gt>
    <ci>p</ci>
    <cn type="integer">2</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p>2
  </annotation>
 </semantics>
</math>

. Similarly, if 

<math display="inline" id="Lagrange's_four-square_theorem:85">
 <semantics>
  <mi>α</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>α</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \alpha
  </annotation>
 </semantics>
</math>

 were a unit, we would have</p>

<p>

<math display="block" id="Lagrange's_four-square_theorem:86">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mn>1</mn>
      <mo>+</mo>
      <mrow>
       <mpadded width="+2.8pt">
        <mi>l</mi>
       </mpadded>
       <mi>𝐢</mi>
      </mrow>
      <mo>+</mo>
      <mrow>
       <mpadded width="+2.8pt">
        <mi>m</mi>
       </mpadded>
       <mi>𝐣</mi>
      </mrow>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
    <mi>H</mi>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mn>1</mn>
       <mo>+</mo>
       <mrow>
        <mpadded width="+2.8pt">
         <mi>l</mi>
        </mpadded>
        <mi>𝐢</mi>
       </mrow>
       <mo>+</mo>
       <mrow>
        <mpadded width="+2.8pt">
         <mi>m</mi>
        </mpadded>
        <mi>𝐣</mi>
       </mrow>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <mi>p</mi>
     <mi>H</mi>
    </mrow>
    <mo>+</mo>
    <mrow>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mn>1</mn>
       <mo>+</mo>
       <mrow>
        <mpadded width="+2.8pt">
         <mi>l</mi>
        </mpadded>
        <mi>𝐢</mi>
       </mrow>
       <mo>+</mo>
       <mrow>
        <mpadded width="+2.8pt">
         <mi>m</mi>
        </mpadded>
        <mi>𝐣</mi>
       </mrow>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mn>1</mn>
       <mo>-</mo>
       <mrow>
        <mpadded width="+2.8pt">
         <mi>l</mi>
        </mpadded>
        <mi>𝐢</mi>
       </mrow>
       <mo>-</mo>
       <mrow>
        <mpadded width="+2.8pt">
         <mi>m</mi>
        </mpadded>
        <mi>𝐣</mi>
       </mrow>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <mi>H</mi>
    </mrow>
   </mrow>
   <mo>⊆</mo>
   <mrow>
    <mi>p</mi>
    <mi>H</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <times></times>
      <apply>
       <plus></plus>
       <cn type="integer">1</cn>
       <apply>
        <times></times>
        <ci>l</ci>
        <ci>𝐢</ci>
       </apply>
       <apply>
        <times></times>
        <ci>m</ci>
        <ci>𝐣</ci>
       </apply>
      </apply>
      <ci>H</ci>
     </apply>
     <apply>
      <plus></plus>
      <apply>
       <times></times>
       <apply>
        <plus></plus>
        <cn type="integer">1</cn>
        <apply>
         <times></times>
         <ci>l</ci>
         <ci>𝐢</ci>
        </apply>
        <apply>
         <times></times>
         <ci>m</ci>
         <ci>𝐣</ci>
        </apply>
       </apply>
       <ci>p</ci>
       <ci>H</ci>
      </apply>
      <apply>
       <times></times>
       <apply>
        <plus></plus>
        <cn type="integer">1</cn>
        <apply>
         <times></times>
         <ci>l</ci>
         <ci>𝐢</ci>
        </apply>
        <apply>
         <times></times>
         <ci>m</ci>
         <ci>𝐣</ci>
        </apply>
       </apply>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
        <apply>
         <times></times>
         <ci>l</ci>
         <ci>𝐢</ci>
        </apply>
        <apply>
         <times></times>
         <ci>m</ci>
         <ci>𝐣</ci>
        </apply>
       </apply>
       <ci>H</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <subset></subset>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <ci>p</ci>
      <ci>H</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (1+l\;\mathbf{i}+m\;\mathbf{j})H=(1+l\;\mathbf{i}+m\;\mathbf{j})pH+(1+l\;%
\mathbf{i}+m\;\mathbf{j})(1-l\;\mathbf{i}-m\;\mathbf{j})H\subseteq pH
  </annotation>
 </semantics>
</math>

</p>

<p>so 

<math display="inline" id="Lagrange's_four-square_theorem:87">
 <semantics>
  <mi>p</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>p</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p
  </annotation>
 </semantics>
</math>

 divides 

<math display="inline" id="Lagrange's_four-square_theorem:88">
 <semantics>
  <mrow>
   <mn>1</mn>
   <mo>+</mo>
   <mrow>
    <mpadded width="+2.8pt">
     <mi>l</mi>
    </mpadded>
    <mi>𝐢</mi>
   </mrow>
   <mo>+</mo>
   <mrow>
    <mpadded width="+2.8pt">
     <mi>m</mi>
    </mpadded>
    <mi>𝐣</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <plus></plus>
    <cn type="integer">1</cn>
    <apply>
     <times></times>
     <ci>l</ci>
     <ci>𝐢</ci>
    </apply>
    <apply>
     <times></times>
     <ci>m</ci>
     <ci>𝐣</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   1+l\;\mathbf{i}+m\;\mathbf{j}
  </annotation>
 </semantics>
</math>

, which again contradicts the fact that 

<math display="inline" id="Lagrange's_four-square_theorem:89">
 <semantics>
  <mrow>
   <mrow>
    <mn>1</mn>
    <mo>/</mo>
    <mi>p</mi>
   </mrow>
   <mo>-</mo>
   <mrow>
    <mrow>
     <mi>l</mi>
     <mo>/</mo>
     <mpadded width="+2.8pt">
      <mi>p</mi>
     </mpadded>
    </mrow>
    <mi>𝐢</mi>
   </mrow>
   <mo>-</mo>
   <mrow>
    <mrow>
     <mi>m</mi>
     <mo>/</mo>
     <mpadded width="+2.8pt">
      <mi>p</mi>
     </mpadded>
    </mrow>
    <mi>𝐣</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <minus></minus>
    <apply>
     <divide></divide>
     <cn type="integer">1</cn>
     <ci>p</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <divide></divide>
      <ci>l</ci>
      <ci>p</ci>
     </apply>
     <ci>𝐢</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <divide></divide>
      <ci>m</ci>
      <ci>p</ci>
     </apply>
     <ci>𝐣</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   1/p-l/p\;\mathbf{i}-m/p\;\mathbf{j}
  </annotation>
 </semantics>
</math>

 is not a Hurwitz quaternion. Thus, 

<math display="inline" id="Lagrange's_four-square_theorem:90">
 <semantics>
  <mi>p</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>p</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p
  </annotation>
 </semantics>
</math>

 is not Hurwitz irreducible, as claimed.</p>
<h2 id="generalizations">Generalizations</h2>

<p>Lagrange's four-square theorem is a special case of the <a href="Fermat_polygonal_number_theorem" title="wikilink">Fermat polygonal number theorem</a> and <a href="Waring's_problem" title="wikilink">Waring's problem</a>. Another possible generalisation is the following problem: Given <a href="natural_number" title="wikilink">natural numbers</a> 

<math display="inline" id="Lagrange's_four-square_theorem:91">
 <semantics>
  <mrow>
   <mi>a</mi>
   <mo>,</mo>
   <mi>b</mi>
   <mo>,</mo>
   <mi>c</mi>
   <mo>,</mo>
   <mi>d</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <list>
    <ci>a</ci>
    <ci>b</ci>
    <ci>c</ci>
    <ci>d</ci>
   </list>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a,b,c,d
  </annotation>
 </semantics>
</math>

, can we solve</p>

<p>

<math display="block" id="Lagrange's_four-square_theorem:92">
 <semantics>
  <mrow>
   <mi>n</mi>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mi>a</mi>
     <msubsup>
      <mi>x</mi>
      <mn>1</mn>
      <mn>2</mn>
     </msubsup>
    </mrow>
    <mo>+</mo>
    <mrow>
     <mi>b</mi>
     <msubsup>
      <mi>x</mi>
      <mn>2</mn>
      <mn>2</mn>
     </msubsup>
    </mrow>
    <mo>+</mo>
    <mrow>
     <mi>c</mi>
     <msubsup>
      <mi>x</mi>
      <mn>3</mn>
      <mn>2</mn>
     </msubsup>
    </mrow>
    <mo>+</mo>
    <mrow>
     <mi>d</mi>
     <msubsup>
      <mi>x</mi>
      <mn>4</mn>
      <mn>2</mn>
     </msubsup>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>n</ci>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <ci>a</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <cn type="integer">1</cn>
       </apply>
       <cn type="integer">2</cn>
      </apply>
     </apply>
     <apply>
      <times></times>
      <ci>b</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <cn type="integer">2</cn>
       </apply>
       <cn type="integer">2</cn>
      </apply>
     </apply>
     <apply>
      <times></times>
      <ci>c</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <cn type="integer">3</cn>
       </apply>
       <cn type="integer">2</cn>
      </apply>
     </apply>
     <apply>
      <times></times>
      <ci>d</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <cn type="integer">4</cn>
       </apply>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n=ax_{1}^{2}+bx_{2}^{2}+cx_{3}^{2}+dx_{4}^{2}
  </annotation>
 </semantics>
</math>

</p>

<p>for all positive integers 

<math display="inline" id="Lagrange's_four-square_theorem:93">
 <semantics>
  <mi>n</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>n</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n
  </annotation>
 </semantics>
</math>

 in integers 

<math display="inline" id="Lagrange's_four-square_theorem:94">
 <semantics>
  <mrow>
   <msub>
    <mi>x</mi>
    <mn>1</mn>
   </msub>
   <mo>,</mo>
   <msub>
    <mi>x</mi>
    <mn>2</mn>
   </msub>
   <mo>,</mo>
   <msub>
    <mi>x</mi>
    <mn>3</mn>
   </msub>
   <mo>,</mo>
   <msub>
    <mi>x</mi>
    <mn>4</mn>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <list>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>x</ci>
     <cn type="integer">1</cn>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>x</ci>
     <cn type="integer">2</cn>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>x</ci>
     <cn type="integer">3</cn>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>x</ci>
     <cn type="integer">4</cn>
    </apply>
   </list>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x_{1},x_{2},x_{3},x_{4}
  </annotation>
 </semantics>
</math>

? The case 

<math display="inline" id="Lagrange's_four-square_theorem:95">
 <semantics>
  <mrow>
   <mi>a</mi>
   <mo>=</mo>
   <mi>b</mi>
   <mo>=</mo>
   <mi>c</mi>
   <mo>=</mo>
   <mi>d</mi>
   <mo>=</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <ci>a</ci>
     <ci>b</ci>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <ci>c</ci>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <ci>d</ci>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <cn type="integer">1</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a=b=c=d=1
  </annotation>
 </semantics>
</math>

 is answered in the positive by Lagrange's four-square theorem. The general solution was given by <a class="uri" href="Ramanujan" title="wikilink">Ramanujan</a>. He proved that if we assume, without loss of generality, that 

<math display="inline" id="Lagrange's_four-square_theorem:96">
 <semantics>
  <mrow>
   <mi>a</mi>
   <mo>≤</mo>
   <mi>b</mi>
   <mo>≤</mo>
   <mi>c</mi>
   <mo>≤</mo>
   <mi>d</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <leq></leq>
     <ci>a</ci>
     <ci>b</ci>
    </apply>
    <apply>
     <leq></leq>
     <share href="#.cmml">
     </share>
     <ci>c</ci>
    </apply>
    <apply>
     <leq></leq>
     <share href="#.cmml">
     </share>
     <ci>d</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a\leq b\leq c\leq d
  </annotation>
 </semantics>
</math>

 then there are exactly 54 possible choices for 

<math display="inline" id="Lagrange's_four-square_theorem:97">
 <semantics>
  <mrow>
   <mi>a</mi>
   <mo>,</mo>
   <mi>b</mi>
   <mo>,</mo>
   <mi>c</mi>
   <mo>,</mo>
   <mi>d</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <list>
    <ci>a</ci>
    <ci>b</ci>
    <ci>c</ci>
    <ci>d</ci>
   </list>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a,b,c,d
  </annotation>
 </semantics>
</math>

 such that the problem is solvable in integers 

<math display="inline" id="Lagrange's_four-square_theorem:98">
 <semantics>
  <mrow>
   <msub>
    <mi>x</mi>
    <mn>1</mn>
   </msub>
   <mo>,</mo>
   <msub>
    <mi>x</mi>
    <mn>2</mn>
   </msub>
   <mo>,</mo>
   <msub>
    <mi>x</mi>
    <mn>3</mn>
   </msub>
   <mo>,</mo>
   <msub>
    <mi>x</mi>
    <mn>4</mn>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <list>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>x</ci>
     <cn type="integer">1</cn>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>x</ci>
     <cn type="integer">2</cn>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>x</ci>
     <cn type="integer">3</cn>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>x</ci>
     <cn type="integer">4</cn>
    </apply>
   </list>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x_{1},x_{2},x_{3},x_{4}
  </annotation>
 </semantics>
</math>

 for all 

<math display="inline" id="Lagrange's_four-square_theorem:99">
 <semantics>
  <mi>n</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>n</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n
  </annotation>
 </semantics>
</math>

. (Ramanujan listed a 55th possibility 

<math display="inline" id="Lagrange's_four-square_theorem:100">
 <semantics>
  <mrow>
   <mrow>
    <mi>a</mi>
    <mo>=</mo>
    <mn>1</mn>
   </mrow>
   <mo>,</mo>
   <mrow>
    <mrow>
     <mi>b</mi>
     <mo>=</mo>
     <mn>2</mn>
    </mrow>
    <mo>,</mo>
    <mrow>
     <mrow>
      <mi>c</mi>
      <mo>=</mo>
      <mn>5</mn>
     </mrow>
     <mo>,</mo>
     <mrow>
      <mi>d</mi>
      <mo>=</mo>
      <mn>5</mn>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <eq></eq>
     <ci>a</ci>
     <cn type="integer">1</cn>
    </apply>
    <apply>
     <csymbol cd="ambiguous">formulae-sequence</csymbol>
     <apply>
      <eq></eq>
      <ci>b</ci>
      <cn type="integer">2</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">formulae-sequence</csymbol>
      <apply>
       <eq></eq>
       <ci>c</ci>
       <cn type="integer">5</cn>
      </apply>
      <apply>
       <eq></eq>
       <ci>d</ci>
       <cn type="integer">5</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a=1,b=2,c=5,d=5
  </annotation>
 </semantics>
</math>

, but in this case the problem is not solvable if 

<math display="inline" id="Lagrange's_four-square_theorem:101">
 <semantics>
  <mrow>
   <mi>n</mi>
   <mo>=</mo>
   <mn>15</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>n</ci>
    <cn type="integer">15</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n=15
  </annotation>
 </semantics>
</math>

.<a class="footnoteRef" href="#fn8" id="fnref8"><sup>8</sup></a>)</p>
<h2 id="algorithms">Algorithms</h2>

<p><a href="Michael_O._Rabin" title="wikilink">Michael O. Rabin</a> and <a href="Jeffrey_Shallit" title="wikilink">Jeffrey Shallit</a><a class="footnoteRef" href="#fn9" id="fnref9"><sup>9</sup></a> have found <a href="randomized_algorithm" title="wikilink">randomized</a> <a href="polynomial-time_algorithm" title="wikilink">polynomial-time algorithms</a> for computing a single representation 

<math display="inline" id="Lagrange's_four-square_theorem:102">
 <semantics>
  <mrow>
   <mi>n</mi>
   <mo>=</mo>
   <mrow>
    <msubsup>
     <mi>x</mi>
     <mn>1</mn>
     <mn>2</mn>
    </msubsup>
    <mo>+</mo>
    <msubsup>
     <mi>x</mi>
     <mn>2</mn>
     <mn>2</mn>
    </msubsup>
    <mo>+</mo>
    <msubsup>
     <mi>x</mi>
     <mn>3</mn>
     <mn>2</mn>
    </msubsup>
    <mo>+</mo>
    <msubsup>
     <mi>x</mi>
     <mn>4</mn>
     <mn>2</mn>
    </msubsup>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>n</ci>
    <apply>
     <plus></plus>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <cn type="integer">1</cn>
      </apply>
      <cn type="integer">2</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <cn type="integer">2</cn>
      </apply>
      <cn type="integer">2</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <cn type="integer">3</cn>
      </apply>
      <cn type="integer">2</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <cn type="integer">4</cn>
      </apply>
      <cn type="integer">2</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n=x_{1}^{2}+x_{2}^{2}+x_{3}^{2}+x_{4}^{2}
  </annotation>
 </semantics>
</math>

 for a given integer 

<math display="inline" id="Lagrange's_four-square_theorem:103">
 <semantics>
  <mi>n</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>n</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n
  </annotation>
 </semantics>
</math>

, in expected running time 

<math display="inline" id="Lagrange's_four-square_theorem:104">
 <semantics>
  <mrow>
   <mi mathvariant="normal">O</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msup>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mi>log</mi>
       <mi>n</mi>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <mn>2</mn>
    </msup>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>normal-O</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <log></log>
      <ci>n</ci>
     </apply>
     <cn type="integer">2</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathrm{O}((\log n)^{2})
  </annotation>
 </semantics>
</math>

.</p>
<h2 id="number-of-representations">Number of representations</h2>

<p>The number of representations of a natural number <em>n</em> as the sum of four squares is denoted by <em>r</em><sub>4</sub>(<em>n</em>). <a href="Jacobi's_four-square_theorem" title="wikilink">Jacobi's four-square theorem</a> states that this is eight times the sum of the <a href="divisor" title="wikilink">divisors</a> of <em>n</em> if <em>n</em> is odd and 24 times the sum of the odd divisors of <em>n</em> if <em>n</em> is even (see <a href="divisor_function" title="wikilink">divisor function</a>), i.e.</p>

<p>

<math display="block" id="Lagrange's_four-square_theorem:105">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>r</mi>
     <mn>4</mn>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>n</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mo>{</mo>
    <mtable displaystyle="true">
     <mtr>
      <mtd columnalign="left">
       <mrow>
        <mn>8</mn>
        <mrow>
         <mstyle displaystyle="false">
          <munder>
           <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
           <mrow>
            <mi>m</mi>
            <mo>∣</mo>
            <mi>n</mi>
           </mrow>
          </munder>
         </mstyle>
         <mi>m</mi>
        </mrow>
       </mrow>
      </mtd>
      <mtd columnalign="left">
       <mrow>
        <mtext>if</mtext>
        <mi>n</mi>
        <mtext>is odd</mtext>
       </mrow>
      </mtd>
     </mtr>
     <mtr>
      <mtd columnalign="left">
       <mrow>
        <mn>24</mn>
        <mrow>
         <mstyle displaystyle="false">
          <munder>
           <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
           <mtable>
            <mtr>
             <mtd columnalign="center">
              <mrow>
               <mi mathsize="70%" stretchy="false">m</mi>
               <mo mathsize="70%" stretchy="false">|</mo>
               <mi mathsize="70%" stretchy="false">n</mi>
              </mrow>
             </mtd>
            </mtr>
            <mtr>
             <mtd columnalign="center">
              <mrow>
               <mi mathsize="70%" stretchy="false">m</mi>
               <mtext>odd</mtext>
              </mrow>
             </mtd>
            </mtr>
           </mtable>
          </munder>
         </mstyle>
         <mi>m</mi>
        </mrow>
       </mrow>
      </mtd>
      <mtd columnalign="left">
       <mrow>
        <mrow>
         <mtext>if</mtext>
         <mi>n</mi>
         <mtext>is even</mtext>
        </mrow>
        <mo>.</mo>
       </mrow>
      </mtd>
     </mtr>
    </mtable>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>r</ci>
      <cn type="integer">4</cn>
     </apply>
     <ci>n</ci>
    </apply>
    <apply>
     <csymbol cd="latexml">cases</csymbol>
     <apply>
      <times></times>
      <cn type="integer">8</cn>
      <apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <cerror>
         <csymbol cd="ambiguous">fragments</csymbol>
         <csymbol cd="unknown">m</csymbol>
         <ci>normal-∣</ci>
         <csymbol cd="unknown">n</csymbol>
        </cerror>
       </apply>
       <ci>m</ci>
      </apply>
     </apply>
     <apply>
      <times></times>
      <mtext>if</mtext>
      <ci>n</ci>
      <mtext>is odd</mtext>
     </apply>
     <apply>
      <times></times>
      <cn type="integer">24</cn>
      <apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <matrix>
         <matrixrow>
          <cerror>
           <csymbol cd="ambiguous">fragments</csymbol>
           <csymbol cd="unknown">m</csymbol>
           <ci>normal-|</ci>
           <csymbol cd="unknown">n</csymbol>
          </cerror>
         </matrixrow>
         <matrixrow>
          <apply>
           <times></times>
           <ci>m</ci>
           <mtext>odd</mtext>
          </apply>
         </matrixrow>
        </matrix>
       </apply>
       <ci>m</ci>
      </apply>
     </apply>
     <apply>
      <times></times>
      <mtext>if</mtext>
      <ci>n</ci>
      <mtext>is even</mtext>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   r_{4}(n)=\begin{cases}8\sum\limits_{m\mid n}m&\text{if }n\text{ is odd}\\
24\sum\limits_{\begin{smallmatrix}m|n\\
m\text{ odd}\end{smallmatrix}}m&\text{if }n\text{ is even}.\end{cases}
  </annotation>
 </semantics>
</math>

</p>

<p>Equivalently, it is eight times the sum of all its divisors which are not divisible by 4, i.e.</p>

<p>

<math display="block" id="Lagrange's_four-square_theorem:106">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <msub>
      <mi>r</mi>
      <mn>4</mn>
     </msub>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>n</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mn>8</mn>
     <mrow>
      <munder>
       <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
       <mrow>
        <mpadded width="+1.7pt">
         <mi>m</mi>
        </mpadded>
        <mo>:</mo>
        <mn>4</mn>
        <mo>∤</mo>
        <mi>m</mi>
        <mo>∣</mo>
        <mi>n</mi>
       </mrow>
      </munder>
      <mi>m</mi>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>r</ci>
      <cn type="integer">4</cn>
     </apply>
     <ci>n</ci>
    </apply>
    <apply>
     <times></times>
     <cn type="integer">8</cn>
     <apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <cerror>
        <csymbol cd="ambiguous">fragments</csymbol>
        <csymbol cd="unknown">m</csymbol>
        <ci>normal-:</ci>
        <cn type="float">4</cn>
        <csymbol cd="latexml">not-divides</csymbol>
        <csymbol cd="unknown">m</csymbol>
        <ci>normal-∣</ci>
        <csymbol cd="unknown">n</csymbol>
       </cerror>
      </apply>
      <ci>m</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   r_{4}(n)=8\sum_{m\,:\,4\nmid m\mid n}m.
  </annotation>
 </semantics>
</math>

</p>

<p>We may also write this as</p>

<p>

<math display="block" id="Lagrange's_four-square_theorem:107">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <msub>
      <mi>r</mi>
      <mn>4</mn>
     </msub>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>n</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mn>8</mn>
      <mi>σ</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>n</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo>-</mo>
     <mrow>
      <mn>32</mn>
      <mi>σ</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mi>n</mi>
        <mo>/</mo>
        <mn>4</mn>
       </mrow>
       <mo rspace="7.5pt" stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>r</ci>
      <cn type="integer">4</cn>
     </apply>
     <ci>n</ci>
    </apply>
    <apply>
     <minus></minus>
     <apply>
      <times></times>
      <cn type="integer">8</cn>
      <ci>σ</ci>
      <ci>n</ci>
     </apply>
     <apply>
      <times></times>
      <cn type="integer">32</cn>
      <ci>σ</ci>
      <apply>
       <divide></divide>
       <ci>n</ci>
       <cn type="integer">4</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   r_{4}(n)=8\sigma(n)-32\sigma(n/4)\ ,
  </annotation>
 </semantics>
</math>

</p>

<p>where the second term is to be taken as zero if <em>n</em> is not divisible by 4. In particular, for a <a href="prime_number" title="wikilink">prime number</a> <em>p</em> we have the explicit formula <em>r</em><sub>4</sub>(<em>p</em>) = 8(<em>p</em> + 1).<a class="footnoteRef" href="#fn10" id="fnref10"><sup>10</sup></a></p>

<p>Some values of <em>r</em><sub>4</sub>(<em>n</em>) occurs infinitely often as <em>r</em><sub>4</sub>(<em>n</em>) = <em>r</em><sub>4</sub>(2<sup><em>m</em></sup><em>n</em>) whenever <em>n</em> is even. The values of <em>r</em><sub>4</sub>(<em>n</em>)/<em>n</em> can be arbitrarily large: indeed, <em>r</em><sub>4</sub>(<em>n</em>)/<em>n</em> is infinitely often larger than 8 √ log <em>n</em>.<a class="footnoteRef" href="#fn11" id="fnref11"><sup>11</sup></a></p>
<h2 id="uniqueness">Uniqueness</h2>

<p>The sequence of positive integers which have only one representation as a sum of four squares (up to order) is:</p>
<dl>
<dd>1, 2, 3, 5, 6, 7, 8, 11, 14, 15, 23, 24, 32, 56, 96, 128, 224, 384, 512, 896 ... .
</dd>
</dl>

<p>These integers consist of the seven odd numbers 1, 3, 5, 7, 11, 15, 23 and all numbers of the form 

<math display="inline" id="Lagrange's_four-square_theorem:108">
 <semantics>
  <mrow>
   <mrow>
    <mn>2</mn>
    <mrow>
     <mo stretchy="false">(</mo>
     <msup>
      <mn>4</mn>
      <mi>k</mi>
     </msup>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>,</mo>
   <mrow>
    <mn>6</mn>
    <mrow>
     <mo stretchy="false">(</mo>
     <msup>
      <mn>4</mn>
      <mi>k</mi>
     </msup>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <list>
    <apply>
     <times></times>
     <cn type="integer">2</cn>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <cn type="integer">4</cn>
      <ci>k</ci>
     </apply>
    </apply>
    <apply>
     <times></times>
     <cn type="integer">6</cn>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <cn type="integer">4</cn>
      <ci>k</ci>
     </apply>
    </apply>
   </list>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   2(4^{k}),6(4^{k})
  </annotation>
 </semantics>
</math>

 or 

<math display="inline" id="Lagrange's_four-square_theorem:109">
 <semantics>
  <mrow>
   <mn>14</mn>
   <mrow>
    <mo stretchy="false">(</mo>
    <msup>
     <mn>4</mn>
     <mi>k</mi>
    </msup>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <cn type="integer">14</cn>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <cn type="integer">4</cn>
     <ci>k</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   14(4^{k})
  </annotation>
 </semantics>
</math>

.</p>

<p>The sequence of positive integers which cannot be represented as a sum of four <em>non-zero</em> squares is:</p>
<dl>
<dd>1, 2, 3, 5, 6, 8, 9, 11, 14, 17, 24, 29, 32, 41, 56, 96, 128, 224, 384, 512, 896 ... .
</dd>
</dl>

<p>These integers consist of the eight odd numbers 1, 3, 5, 9, 11, 17, 29, 41 and all numbers of the form 

<math display="inline" id="Lagrange's_four-square_theorem:110">
 <semantics>
  <mrow>
   <mrow>
    <mn>2</mn>
    <mrow>
     <mo stretchy="false">(</mo>
     <msup>
      <mn>4</mn>
      <mi>k</mi>
     </msup>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>,</mo>
   <mrow>
    <mn>6</mn>
    <mrow>
     <mo stretchy="false">(</mo>
     <msup>
      <mn>4</mn>
      <mi>k</mi>
     </msup>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <list>
    <apply>
     <times></times>
     <cn type="integer">2</cn>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <cn type="integer">4</cn>
      <ci>k</ci>
     </apply>
    </apply>
    <apply>
     <times></times>
     <cn type="integer">6</cn>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <cn type="integer">4</cn>
      <ci>k</ci>
     </apply>
    </apply>
   </list>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   2(4^{k}),6(4^{k})
  </annotation>
 </semantics>
</math>

 or 

<math display="inline" id="Lagrange's_four-square_theorem:111">
 <semantics>
  <mrow>
   <mn>14</mn>
   <mrow>
    <mo stretchy="false">(</mo>
    <msup>
     <mn>4</mn>
     <mi>k</mi>
    </msup>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <cn type="integer">14</cn>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <cn type="integer">4</cn>
     <ci>k</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   14(4^{k})
  </annotation>
 </semantics>
</math>

.</p>
<h2 id="see-also">See also</h2>
<ul>
<li><a href="Fermat's_theorem_on_sums_of_two_squares" title="wikilink">Fermat's theorem on sums of two squares</a></li>
<li><a href="Legendre's_three-square_theorem" title="wikilink">Legendre's three-square theorem</a></li>
<li><a href="15_and_290_theorems" title="wikilink">15 and 290 theorems</a></li>
</ul>
<h2 id="references">References</h2>
<h2 id="external-links">External links</h2>
<ul>
<li><a href="http://planetmath.org/encyclopedia/ProofOfLagrangesFourSquareTheorem.html">Proof at PlanetMath.org</a></li>
<li><a href="http://www.alpertron.com.ar/4SQUARES.HTM">Another proof</a></li>
<li><a href="http://www.alpertron.com.ar/FSQUARES.HTM">an applet decomposing numbers as sums of four squares</a></li>
</ul>

<p>"</p>

<p><a href="Category:Additive_number_theory" title="wikilink">Category:Additive number theory</a> <a href="Category:Theorems_in_number_theory" title="wikilink">Category:Theorems in number theory</a> <a href="Category:Articles_containing_proofs" title="wikilink">Category:Articles containing proofs</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1"><a href="#fnref1">↩</a></li>
<li id="fn2"><a href="http://www.youtube.com/watch?v=1GtOMVcfjJ0">The Ramanujan Conjecture and some Diophantine Equations</a>, Peter Sarnak, lecture at Tata Institute of Fundamental Research, of the ICTS lecture series. Bangalore, 2013 via youtube.<a href="#fnref2">↩</a></li>
<li id="fn3">Theorems 166 to 169 in: <a href="Edmund_Landau" title="wikilink">E. Landau</a>, <em>Vorlesungen über Zahlentheorie</em>, New York, Chelsea, 1927. Second edition translated into English by Jacob E. Goodman, Providence RH, Chelsea, 1958.<a href="#fnref3">↩</a></li>
<li id="fn4">Theorem 369 in: G.H. Hardy and E.M. Wright, <em>An introduction to the theory of numbers</em>, Oxford, Clarendon Press 1938.<a href="#fnref4">↩</a></li>
<li id="fn5">Paragraph 5.7 in: Ivan Niven and Herbert S. Zuckerman, <em>An introduction to the theory of numbers</em>, John Wiley and Sons 1960.<a href="#fnref5">↩</a></li>
<li id="fn6"><a href="#fnref6">↩</a></li>
<li id="fn7"></li>
<li id="fn8">Myung-Hwan Kim <a href="http://icms.kaist.ac.kr/mathnet/kms_tex/974363.pdf">REPRESENTATIONS OF BINARY FORMS BY QUINARY QUADRATIC FORMS</a><a href="#fnref8">↩</a></li>
<li id="fn9">M. O. Rabin, J. O. Shallit, <em>Randomized Algorithms in Number Theory</em>, Communications on Pure and Applied Mathematics 39 (1986), no. S1, pp. S239–S256. <a href="#fnref9">↩</a></li>
<li id="fn10"><a href="#fnref10">↩</a></li>
<li id="fn11">Williams (2011) p.119<a href="#fnref11">↩</a></li>
</ol>
</section>



<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="1339">Five-point stencil</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Five-point stencil</h1>
<hr/>

<p> In <a href="numerical_analysis" title="wikilink">numerical analysis</a>, given a <a href="square_grid" title="wikilink">square grid</a> in one or two dimensions, the <strong>five-point stencil</strong> of a point in the grid is made up of the point itself together with its four "neighbors". It is used to write <a href="finite_difference" title="wikilink">finite difference</a> approximations to <a href="derivative" title="wikilink">derivatives</a> at grid points. It is an example for <a href="numerical_differentiation" title="wikilink">numerical differentiation</a>.</p>
<h2 id="one-dimension">One dimension</h2>

<p>In one dimension, if the spacing between points in the grid is <em>h</em>, then the five-point stencil of a point <em>x</em> in the grid is</p>

<p>

<math display="block" id="Five-point_stencil:0">
 <semantics>
  <mrow>
   <mrow>
    <mo lspace="7.5pt" stretchy="false">{</mo>
    <mrow>
     <mi>x</mi>
     <mo>-</mo>
     <mrow>
      <mn>2</mn>
      <mi>h</mi>
     </mrow>
    </mrow>
    <mo>,</mo>
    <mrow>
     <mi>x</mi>
     <mo>-</mo>
     <mi>h</mi>
    </mrow>
    <mo>,</mo>
    <mi>x</mi>
    <mo>,</mo>
    <mrow>
     <mi>x</mi>
     <mo>+</mo>
     <mi>h</mi>
    </mrow>
    <mo>,</mo>
    <mrow>
     <mi>x</mi>
     <mo>+</mo>
     <mrow>
      <mn>2</mn>
      <mi>h</mi>
     </mrow>
    </mrow>
    <mo stretchy="false">}</mo>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <set>
    <apply>
     <minus></minus>
     <ci>x</ci>
     <apply>
      <times></times>
      <cn type="integer">2</cn>
      <ci>h</ci>
     </apply>
    </apply>
    <apply>
     <minus></minus>
     <ci>x</ci>
     <ci>h</ci>
    </apply>
    <ci>x</ci>
    <apply>
     <plus></plus>
     <ci>x</ci>
     <ci>h</ci>
    </apply>
    <apply>
     <plus></plus>
     <ci>x</ci>
     <apply>
      <times></times>
      <cn type="integer">2</cn>
      <ci>h</ci>
     </apply>
    </apply>
   </set>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \ \{x-2h,x-h,x,x+h,x+2h\}.
  </annotation>
 </semantics>
</math>

</p>
<h3 id="first-derivative">First derivative</h3>

<p>The first derivative of a <a href="function_(mathematics)" title="wikilink">function</a> ƒ of a <a href="real_number" title="wikilink">real</a> variable at a point <em>x</em> can be approximated using a five-point stencil as</p>

<p>

<math display="block" id="Five-point_stencil:1">
 <semantics>
  <mrow>
   <mrow>
    <msup>
     <mi>f</mi>
     <mo>′</mo>
    </msup>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>x</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>≈</mo>
   <mfrac>
    <mrow>
     <mrow>
      <mrow>
       <mrow>
        <mo>-</mo>
        <mrow>
         <mi>f</mi>
         <mrow>
          <mo stretchy="false">(</mo>
          <mrow>
           <mi>x</mi>
           <mo>+</mo>
           <mrow>
            <mn>2</mn>
            <mi>h</mi>
           </mrow>
          </mrow>
          <mo stretchy="false">)</mo>
         </mrow>
        </mrow>
       </mrow>
       <mo>+</mo>
       <mrow>
        <mn>8</mn>
        <mi>f</mi>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <mi>x</mi>
          <mo>+</mo>
          <mi>h</mi>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
      </mrow>
      <mo>-</mo>
      <mrow>
       <mn>8</mn>
       <mi>f</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mi>x</mi>
         <mo>-</mo>
         <mi>h</mi>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
     </mrow>
     <mo>+</mo>
     <mrow>
      <mi>f</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mi>x</mi>
        <mo>-</mo>
        <mrow>
         <mn>2</mn>
         <mi>h</mi>
        </mrow>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mrow>
    <mrow>
     <mn>12</mn>
     <mi>h</mi>
    </mrow>
   </mfrac>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <approx></approx>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>f</ci>
      <ci>normal-′</ci>
     </apply>
     <ci>x</ci>
    </apply>
    <apply>
     <divide></divide>
     <apply>
      <plus></plus>
      <apply>
       <minus></minus>
       <apply>
        <plus></plus>
        <apply>
         <minus></minus>
         <apply>
          <times></times>
          <ci>f</ci>
          <apply>
           <plus></plus>
           <ci>x</ci>
           <apply>
            <times></times>
            <cn type="integer">2</cn>
            <ci>h</ci>
           </apply>
          </apply>
         </apply>
        </apply>
        <apply>
         <times></times>
         <cn type="integer">8</cn>
         <ci>f</ci>
         <apply>
          <plus></plus>
          <ci>x</ci>
          <ci>h</ci>
         </apply>
        </apply>
       </apply>
       <apply>
        <times></times>
        <cn type="integer">8</cn>
        <ci>f</ci>
        <apply>
         <minus></minus>
         <ci>x</ci>
         <ci>h</ci>
        </apply>
       </apply>
      </apply>
      <apply>
       <times></times>
       <ci>f</ci>
       <apply>
        <minus></minus>
        <ci>x</ci>
        <apply>
         <times></times>
         <cn type="integer">2</cn>
         <ci>h</ci>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <cn type="integer">12</cn>
      <ci>h</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f^{\prime}(x)\approx\frac{-f(x+2h)+8f(x+h)-8f(x-h)+f(x-2h)}{12h}
  </annotation>
 </semantics>
</math>

</p>
<h4 id="obtaining-the-formula">Obtaining the formula</h4>

<p>This formula can be obtained by writing out the four <a href="Taylor_series" title="wikilink">Taylor series</a> of ƒ(<em>x</em> ± <em>h</em>) and ƒ(<em>x</em> ± 2<em>h</em>) up to terms of <em>h</em><sup> 3</sup> (or up to terms of <em>h</em><sup> 5</sup> to get an error estimation as well) and solving this system of four equations to get ƒ<sup> ′</sup>(<em>x</em>). Actually, we have at points <em>x</em> + <em>h</em> and <em>x</em> − <em>h</em>:</p>

<p>

<math display="block" id="Five-point_stencil:2">
 <semantics>
  <mrow>
   <mi>f</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>x</mi>
    <mo>±</mo>
    <mi>h</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>=</mo>
   <mi>f</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>x</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>±</mo>
   <mi>h</mi>
   <msup>
    <mi>f</mi>
    <mo>′</mo>
   </msup>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>x</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>+</mo>
   <mfrac>
    <msup>
     <mi>h</mi>
     <mn>2</mn>
    </msup>
    <mn>2</mn>
   </mfrac>
   <msup>
    <mi>f</mi>
    <mi>′′</mi>
   </msup>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>x</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>±</mo>
   <mfrac>
    <msup>
     <mi>h</mi>
     <mn>3</mn>
    </msup>
    <mn>6</mn>
   </mfrac>
   <msup>
    <mi>f</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mn>3</mn>
     <mo stretchy="false">)</mo>
    </mrow>
   </msup>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>x</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>+</mo>
   <msub>
    <mi>O</mi>
    <mrow>
     <mn>1</mn>
     <mo>±</mo>
    </mrow>
   </msub>
   <mrow>
    <mo stretchy="false">(</mo>
    <msup>
     <mi>h</mi>
     <mn>4</mn>
    </msup>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>.</mo>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>E</mi>
     <mrow>
      <mn>1</mn>
      <mo>±</mo>
     </mrow>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">f</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">x</csymbol>
     <csymbol cd="latexml">plus-or-minus</csymbol>
     <csymbol cd="unknown">h</csymbol>
     <ci>normal-)</ci>
    </cerror>
    <eq></eq>
    <csymbol cd="unknown">f</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">x</csymbol>
     <ci>normal-)</ci>
    </cerror>
    <csymbol cd="latexml">plus-or-minus</csymbol>
    <csymbol cd="unknown">h</csymbol>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>f</ci>
     <ci>normal-′</ci>
    </apply>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">x</csymbol>
     <ci>normal-)</ci>
    </cerror>
    <plus></plus>
    <apply>
     <divide></divide>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>h</ci>
      <cn type="integer">2</cn>
     </apply>
     <cn type="integer">2</cn>
    </apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>f</ci>
     <ci>′′</ci>
    </apply>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">x</csymbol>
     <ci>normal-)</ci>
    </cerror>
    <csymbol cd="latexml">plus-or-minus</csymbol>
    <apply>
     <divide></divide>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>h</ci>
      <cn type="integer">3</cn>
     </apply>
     <cn type="integer">6</cn>
    </apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>f</ci>
     <cn type="integer">3</cn>
    </apply>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">x</csymbol>
     <ci>normal-)</ci>
    </cerror>
    <plus></plus>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>O</ci>
     <apply>
      <csymbol cd="latexml">limit-from</csymbol>
      <cn type="integer">1</cn>
      <csymbol cd="latexml">plus-or-minus</csymbol>
     </apply>
    </apply>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>h</ci>
      <cn type="integer">4</cn>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <ci>normal-.</ci>
    <ci>italic-</ci>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>E</ci>
      <apply>
       <csymbol cd="latexml">limit-from</csymbol>
       <cn type="integer">1</cn>
       <csymbol cd="latexml">plus-or-minus</csymbol>
      </apply>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <ci>normal-.</ci>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f(x\pm h)=f(x)\pm hf^{\prime}(x)+\frac{h^{2}}{2}f^{\prime\prime}(x)\pm\frac{h^%
{3}}{6}f^{(3)}(x)+O_{1\pm}(h^{4}).\qquad(E_{1\pm}).
  </annotation>
 </semantics>
</math>

</p>

<p>Evaluating (<em>E</em><sub> 1+</sub>) − (<em>E</em><sub> 1−</sub>) gives us</p>

<p>

<math display="block" id="Five-point_stencil:3">
 <semantics>
  <mrow>
   <mi>f</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>x</mi>
    <mo>+</mo>
    <mi>h</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>-</mo>
   <mi>f</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>x</mi>
    <mo>-</mo>
    <mi>h</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>=</mo>
   <mn>2</mn>
   <mi>h</mi>
   <msup>
    <mi>f</mi>
    <mo>′</mo>
   </msup>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>x</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>+</mo>
   <mfrac>
    <msup>
     <mi>h</mi>
     <mn>3</mn>
    </msup>
    <mn>3</mn>
   </mfrac>
   <msup>
    <mi>f</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mn>3</mn>
     <mo stretchy="false">)</mo>
    </mrow>
   </msup>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>x</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>+</mo>
   <msub>
    <mi>O</mi>
    <mn>1</mn>
   </msub>
   <mrow>
    <mo stretchy="false">(</mo>
    <msup>
     <mi>h</mi>
     <mn>4</mn>
    </msup>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>.</mo>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>E</mi>
     <mn>1</mn>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">f</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">x</csymbol>
     <plus></plus>
     <csymbol cd="unknown">h</csymbol>
     <ci>normal-)</ci>
    </cerror>
    <minus></minus>
    <csymbol cd="unknown">f</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">x</csymbol>
     <minus></minus>
     <csymbol cd="unknown">h</csymbol>
     <ci>normal-)</ci>
    </cerror>
    <eq></eq>
    <cn type="integer">2</cn>
    <csymbol cd="unknown">h</csymbol>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>f</ci>
     <ci>normal-′</ci>
    </apply>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">x</csymbol>
     <ci>normal-)</ci>
    </cerror>
    <plus></plus>
    <apply>
     <divide></divide>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>h</ci>
      <cn type="integer">3</cn>
     </apply>
     <cn type="integer">3</cn>
    </apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>f</ci>
     <cn type="integer">3</cn>
    </apply>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">x</csymbol>
     <ci>normal-)</ci>
    </cerror>
    <plus></plus>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>O</ci>
     <cn type="integer">1</cn>
    </apply>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>h</ci>
      <cn type="integer">4</cn>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <ci>normal-.</ci>
    <ci>italic-</ci>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>E</ci>
      <cn type="integer">1</cn>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <ci>normal-.</ci>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f(x+h)-f(x-h)=2hf^{\prime}(x)+\frac{h^{3}}{3}f^{(3)}(x)+O_{1}(h^{4}).\qquad(E_%
{1}).
  </annotation>
 </semantics>
</math>

</p>

<p>Note that the residual term O<sub>1</sub>(<em>h</em><sup> 4</sup>) should be of the order of <em>h</em><sup> 5</sup> instead of <em>h</em><sup> 4</sup> because if the terms of <em>h</em><sup> 4</sup> had been written out in (<em>E</em><sub> 1+</sub>) and (<em>E</em><sub> 1−</sub>), it can be seen that they would have canceled each other out by ƒ(<em>x</em> + <em>h</em>) − ƒ(<em>x</em> − <em>h</em>). But for this calculation, it is left like that since the order of error estimation is not treated here (cf below).</p>

<p>Similarly, we have</p>

<p>

<math display="block" id="Five-point_stencil:4">
 <semantics>
  <mrow>
   <mi>f</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>x</mi>
    <mo>±</mo>
    <mn>2</mn>
    <mi>h</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>=</mo>
   <mi>f</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>x</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>±</mo>
   <mn>2</mn>
   <mi>h</mi>
   <msup>
    <mi>f</mi>
    <mo>′</mo>
   </msup>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>x</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>+</mo>
   <mn>2</mn>
   <msup>
    <mi>h</mi>
    <mn>2</mn>
   </msup>
   <msup>
    <mi>f</mi>
    <mi>′′</mi>
   </msup>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>x</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>±</mo>
   <mfrac>
    <mrow>
     <mn>4</mn>
     <msup>
      <mi>h</mi>
      <mn>3</mn>
     </msup>
    </mrow>
    <mn>3</mn>
   </mfrac>
   <msup>
    <mi>f</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mn>3</mn>
     <mo stretchy="false">)</mo>
    </mrow>
   </msup>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>x</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>+</mo>
   <msub>
    <mi>O</mi>
    <mrow>
     <mn>2</mn>
     <mo>±</mo>
    </mrow>
   </msub>
   <mrow>
    <mo stretchy="false">(</mo>
    <msup>
     <mi>h</mi>
     <mn>4</mn>
    </msup>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>.</mo>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>E</mi>
     <mrow>
      <mn>2</mn>
      <mo>±</mo>
     </mrow>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">f</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">x</csymbol>
     <csymbol cd="latexml">plus-or-minus</csymbol>
     <cn type="integer">2</cn>
     <csymbol cd="unknown">h</csymbol>
     <ci>normal-)</ci>
    </cerror>
    <eq></eq>
    <csymbol cd="unknown">f</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">x</csymbol>
     <ci>normal-)</ci>
    </cerror>
    <csymbol cd="latexml">plus-or-minus</csymbol>
    <cn type="integer">2</cn>
    <csymbol cd="unknown">h</csymbol>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>f</ci>
     <ci>normal-′</ci>
    </apply>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">x</csymbol>
     <ci>normal-)</ci>
    </cerror>
    <plus></plus>
    <cn type="integer">2</cn>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>h</ci>
     <cn type="integer">2</cn>
    </apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>f</ci>
     <ci>′′</ci>
    </apply>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">x</csymbol>
     <ci>normal-)</ci>
    </cerror>
    <csymbol cd="latexml">plus-or-minus</csymbol>
    <apply>
     <divide></divide>
     <apply>
      <times></times>
      <cn type="integer">4</cn>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>h</ci>
       <cn type="integer">3</cn>
      </apply>
     </apply>
     <cn type="integer">3</cn>
    </apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>f</ci>
     <cn type="integer">3</cn>
    </apply>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">x</csymbol>
     <ci>normal-)</ci>
    </cerror>
    <plus></plus>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>O</ci>
     <apply>
      <csymbol cd="latexml">limit-from</csymbol>
      <cn type="integer">2</cn>
      <csymbol cd="latexml">plus-or-minus</csymbol>
     </apply>
    </apply>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>h</ci>
      <cn type="integer">4</cn>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <ci>normal-.</ci>
    <ci>italic-</ci>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>E</ci>
      <apply>
       <csymbol cd="latexml">limit-from</csymbol>
       <cn type="integer">2</cn>
       <csymbol cd="latexml">plus-or-minus</csymbol>
      </apply>
     </apply>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f(x\pm 2h)=f(x)\pm 2hf^{\prime}(x)+2h^{2}f^{\prime\prime}(x)\pm\frac{4h^{3}}{3%
}f^{(3)}(x)+O_{2\pm}(h^{4}).\qquad(E_{2\pm})
  </annotation>
 </semantics>
</math>

</p>

<p>and 

<math display="inline" id="Five-point_stencil:5">
 <semantics>
  <mrow>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>E</mi>
     <mrow>
      <mn>2</mn>
      <mo>+</mo>
     </mrow>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>-</mo>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>E</mi>
     <mrow>
      <mn>2</mn>
      <mo>-</mo>
     </mrow>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <minus></minus>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>E</ci>
     <apply>
      <csymbol cd="latexml">limit-from</csymbol>
      <cn type="integer">2</cn>
      <plus></plus>
     </apply>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>E</ci>
     <apply>
      <csymbol cd="latexml">limit-from</csymbol>
      <cn type="integer">2</cn>
      <minus></minus>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (E_{2+})-(E_{2-})
  </annotation>
 </semantics>
</math>

 gives us</p>

<p>

<math display="block" id="Five-point_stencil:6">
 <semantics>
  <mrow>
   <mi>f</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>x</mi>
    <mo>+</mo>
    <mn>2</mn>
    <mi>h</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>-</mo>
   <mi>f</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>x</mi>
    <mo>-</mo>
    <mn>2</mn>
    <mi>h</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>=</mo>
   <mn>4</mn>
   <mi>h</mi>
   <msup>
    <mi>f</mi>
    <mo>′</mo>
   </msup>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>x</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>+</mo>
   <mfrac>
    <mrow>
     <mn>8</mn>
     <msup>
      <mi>h</mi>
      <mn>3</mn>
     </msup>
    </mrow>
    <mn>3</mn>
   </mfrac>
   <msup>
    <mi>f</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mn>3</mn>
     <mo stretchy="false">)</mo>
    </mrow>
   </msup>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>x</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>+</mo>
   <msub>
    <mi>O</mi>
    <mn>2</mn>
   </msub>
   <mrow>
    <mo stretchy="false">(</mo>
    <msup>
     <mi>h</mi>
     <mn>4</mn>
    </msup>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>.</mo>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>E</mi>
     <mn>2</mn>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">f</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">x</csymbol>
     <plus></plus>
     <cn type="integer">2</cn>
     <csymbol cd="unknown">h</csymbol>
     <ci>normal-)</ci>
    </cerror>
    <minus></minus>
    <csymbol cd="unknown">f</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">x</csymbol>
     <minus></minus>
     <cn type="integer">2</cn>
     <csymbol cd="unknown">h</csymbol>
     <ci>normal-)</ci>
    </cerror>
    <eq></eq>
    <cn type="integer">4</cn>
    <csymbol cd="unknown">h</csymbol>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>f</ci>
     <ci>normal-′</ci>
    </apply>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">x</csymbol>
     <ci>normal-)</ci>
    </cerror>
    <plus></plus>
    <apply>
     <divide></divide>
     <apply>
      <times></times>
      <cn type="integer">8</cn>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>h</ci>
       <cn type="integer">3</cn>
      </apply>
     </apply>
     <cn type="integer">3</cn>
    </apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>f</ci>
     <cn type="integer">3</cn>
    </apply>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">x</csymbol>
     <ci>normal-)</ci>
    </cerror>
    <plus></plus>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>O</ci>
     <cn type="integer">2</cn>
    </apply>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>h</ci>
      <cn type="integer">4</cn>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <ci>normal-.</ci>
    <ci>italic-</ci>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>E</ci>
      <cn type="integer">2</cn>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <ci>normal-.</ci>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f(x+2h)-f(x-2h)=4hf^{\prime}(x)+\frac{8h^{3}}{3}f^{(3)}(x)+O_{2}(h^{4}).\qquad%
(E_{2}).
  </annotation>
 </semantics>
</math>

</p>

<p>In order to eliminate the terms of ƒ<sup> (3)</sup>(<em>x</em>), calculate 8 × (<em>E</em><sub>1</sub>) − (<em>E</em><sub>2</sub>)</p>

<p>

<math display="block" id="Five-point_stencil:7">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mrow>
      <mn>8</mn>
      <mi>f</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mi>x</mi>
        <mo>+</mo>
        <mi>h</mi>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo>-</mo>
     <mrow>
      <mn>8</mn>
      <mi>f</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mi>x</mi>
        <mo>-</mo>
        <mi>h</mi>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo>-</mo>
     <mrow>
      <mi>f</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mi>x</mi>
        <mo>+</mo>
        <mrow>
         <mn>2</mn>
         <mi>h</mi>
        </mrow>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mrow>
    <mo>+</mo>
    <mrow>
     <mi>f</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mi>x</mi>
       <mo>-</mo>
       <mrow>
        <mn>2</mn>
        <mi>h</mi>
       </mrow>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mn>12</mn>
     <mi>h</mi>
     <msup>
      <mi>f</mi>
      <mo>′</mo>
     </msup>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>x</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>+</mo>
    <mrow>
     <mi>O</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <msup>
       <mi>h</mi>
       <mn>4</mn>
      </msup>
      <mo rspace="4.2pt" stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <plus></plus>
     <apply>
      <minus></minus>
      <apply>
       <times></times>
       <cn type="integer">8</cn>
       <ci>f</ci>
       <apply>
        <plus></plus>
        <ci>x</ci>
        <ci>h</ci>
       </apply>
      </apply>
      <apply>
       <times></times>
       <cn type="integer">8</cn>
       <ci>f</ci>
       <apply>
        <minus></minus>
        <ci>x</ci>
        <ci>h</ci>
       </apply>
      </apply>
      <apply>
       <times></times>
       <ci>f</ci>
       <apply>
        <plus></plus>
        <ci>x</ci>
        <apply>
         <times></times>
         <cn type="integer">2</cn>
         <ci>h</ci>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <ci>f</ci>
      <apply>
       <minus></minus>
       <ci>x</ci>
       <apply>
        <times></times>
        <cn type="integer">2</cn>
        <ci>h</ci>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <cn type="integer">12</cn>
      <ci>h</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>f</ci>
       <ci>normal-′</ci>
      </apply>
      <ci>x</ci>
     </apply>
     <apply>
      <times></times>
      <ci>O</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>h</ci>
       <cn type="integer">4</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   8f(x+h)-8f(x-h)-f(x+2h)+f(x-2h)=12hf^{\prime}(x)+O(h^{4})\,
  </annotation>
 </semantics>
</math>

</p>

<p>thus giving the formula as above. Note: the coefficients of f in this formula, (8, -8,-1,1), represent a specific example of the more general <a href="Savitzky-Golay_filter" title="wikilink">Savitzky-Golay filter</a></p>
<h4 id="estimated-error">Estimated error</h4>

<p>The error in this approximation is of <a href="Landau_notation" title="wikilink">order</a> <em>h</em><sup> 4</sup>. That can be seen from the expansion</p>

<p>

<math display="block" id="Five-point_stencil:8">
 <semantics>
  <mrow>
   <mfrac>
    <mrow>
     <mrow>
      <mrow>
       <mrow>
        <mo>-</mo>
        <mrow>
         <mi>f</mi>
         <mrow>
          <mo stretchy="false">(</mo>
          <mrow>
           <mi>x</mi>
           <mo>+</mo>
           <mrow>
            <mn>2</mn>
            <mi>h</mi>
           </mrow>
          </mrow>
          <mo stretchy="false">)</mo>
         </mrow>
        </mrow>
       </mrow>
       <mo>+</mo>
       <mrow>
        <mn>8</mn>
        <mi>f</mi>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <mi>x</mi>
          <mo>+</mo>
          <mi>h</mi>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
      </mrow>
      <mo>-</mo>
      <mrow>
       <mn>8</mn>
       <mi>f</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mi>x</mi>
         <mo>-</mo>
         <mi>h</mi>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
     </mrow>
     <mo>+</mo>
     <mrow>
      <mi>f</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mi>x</mi>
        <mo>-</mo>
        <mrow>
         <mn>2</mn>
         <mi>h</mi>
        </mrow>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mrow>
    <mrow>
     <mn>12</mn>
     <mi>h</mi>
    </mrow>
   </mfrac>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mrow>
      <msup>
       <mi>f</mi>
       <mo>′</mo>
      </msup>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>x</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo>-</mo>
     <mrow>
      <mfrac>
       <mn>1</mn>
       <mn>30</mn>
      </mfrac>
      <msup>
       <mi>f</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mn>5</mn>
        <mo stretchy="false">)</mo>
       </mrow>
      </msup>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>x</mi>
       <mo stretchy="false">)</mo>
      </mrow>
      <msup>
       <mi>h</mi>
       <mn>4</mn>
      </msup>
     </mrow>
    </mrow>
    <mo>+</mo>
    <mrow>
     <mi>O</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <msup>
       <mi>h</mi>
       <mn>5</mn>
      </msup>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <divide></divide>
     <apply>
      <plus></plus>
      <apply>
       <minus></minus>
       <apply>
        <plus></plus>
        <apply>
         <minus></minus>
         <apply>
          <times></times>
          <ci>f</ci>
          <apply>
           <plus></plus>
           <ci>x</ci>
           <apply>
            <times></times>
            <cn type="integer">2</cn>
            <ci>h</ci>
           </apply>
          </apply>
         </apply>
        </apply>
        <apply>
         <times></times>
         <cn type="integer">8</cn>
         <ci>f</ci>
         <apply>
          <plus></plus>
          <ci>x</ci>
          <ci>h</ci>
         </apply>
        </apply>
       </apply>
       <apply>
        <times></times>
        <cn type="integer">8</cn>
        <ci>f</ci>
        <apply>
         <minus></minus>
         <ci>x</ci>
         <ci>h</ci>
        </apply>
       </apply>
      </apply>
      <apply>
       <times></times>
       <ci>f</ci>
       <apply>
        <minus></minus>
        <ci>x</ci>
        <apply>
         <times></times>
         <cn type="integer">2</cn>
         <ci>h</ci>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <cn type="integer">12</cn>
      <ci>h</ci>
     </apply>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <minus></minus>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>f</ci>
        <ci>normal-′</ci>
       </apply>
       <ci>x</ci>
      </apply>
      <apply>
       <times></times>
       <apply>
        <divide></divide>
        <cn type="integer">1</cn>
        <cn type="integer">30</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>f</ci>
        <cn type="integer">5</cn>
       </apply>
       <ci>x</ci>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>h</ci>
        <cn type="integer">4</cn>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <ci>O</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>h</ci>
       <cn type="integer">5</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \frac{-f(x+2h)+8f(x+h)-8f(x-h)+f(x-2h)}{12h}=f^{\prime}(x)-\frac{1}{30}f^{(5)}%
(x)h^{4}+O(h^{5})
  </annotation>
 </semantics>
</math>

 <a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a></p>

<p>which can be obtained by expanding the left-hand side in a <a href="Taylor_series" title="wikilink">Taylor series</a>. Alternatively, apply <a href="Richardson_extrapolation" title="wikilink">Richardson extrapolation</a> to the <a href="central_difference" title="wikilink">central difference</a> approximation to 

<math display="inline" id="Five-point_stencil:9">
 <semantics>
  <mrow>
   <msup>
    <mi>f</mi>
    <mo>′</mo>
   </msup>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>x</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>f</ci>
     <ci>normal-′</ci>
    </apply>
    <ci>x</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f^{\prime}(x)
  </annotation>
 </semantics>
</math>

 on grids with spacing 2<em>h</em> and <em>h</em>.</p>
<h3 id="higher-derivatives">Higher derivatives</h3>

<p>The centered difference formulas for five-point stencils approximating second, third, and fourth derivatives are</p>

<p>

<math display="block" id="Five-point_stencil:10">
 <semantics>
  <mrow>
   <mrow>
    <msup>
     <mi>f</mi>
     <mi>′′</mi>
    </msup>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>x</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>≈</mo>
   <mfrac>
    <mrow>
     <mrow>
      <mrow>
       <mrow>
        <mrow>
         <mo>-</mo>
         <mrow>
          <mi>f</mi>
          <mrow>
           <mo stretchy="false">(</mo>
           <mrow>
            <mi>x</mi>
            <mo>+</mo>
            <mrow>
             <mn>2</mn>
             <mi>h</mi>
            </mrow>
           </mrow>
           <mo stretchy="false">)</mo>
          </mrow>
         </mrow>
        </mrow>
        <mo>+</mo>
        <mrow>
         <mn>16</mn>
         <mi>f</mi>
         <mrow>
          <mo stretchy="false">(</mo>
          <mrow>
           <mi>x</mi>
           <mo>+</mo>
           <mi>h</mi>
          </mrow>
          <mo stretchy="false">)</mo>
         </mrow>
        </mrow>
       </mrow>
       <mo>-</mo>
       <mrow>
        <mn>30</mn>
        <mi>f</mi>
        <mrow>
         <mo stretchy="false">(</mo>
         <mi>x</mi>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
      </mrow>
      <mo>+</mo>
      <mrow>
       <mn>16</mn>
       <mi>f</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mi>x</mi>
         <mo>-</mo>
         <mi>h</mi>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
     </mrow>
     <mo>-</mo>
     <mrow>
      <mi>f</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mi>x</mi>
        <mo>-</mo>
        <mrow>
         <mn>2</mn>
         <mi>h</mi>
        </mrow>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mrow>
    <mrow>
     <mn>12</mn>
     <msup>
      <mi>h</mi>
      <mn>2</mn>
     </msup>
    </mrow>
   </mfrac>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <approx></approx>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>f</ci>
      <ci>′′</ci>
     </apply>
     <ci>x</ci>
    </apply>
    <apply>
     <divide></divide>
     <apply>
      <minus></minus>
      <apply>
       <plus></plus>
       <apply>
        <minus></minus>
        <apply>
         <plus></plus>
         <apply>
          <minus></minus>
          <apply>
           <times></times>
           <ci>f</ci>
           <apply>
            <plus></plus>
            <ci>x</ci>
            <apply>
             <times></times>
             <cn type="integer">2</cn>
             <ci>h</ci>
            </apply>
           </apply>
          </apply>
         </apply>
         <apply>
          <times></times>
          <cn type="integer">16</cn>
          <ci>f</ci>
          <apply>
           <plus></plus>
           <ci>x</ci>
           <ci>h</ci>
          </apply>
         </apply>
        </apply>
        <apply>
         <times></times>
         <cn type="integer">30</cn>
         <ci>f</ci>
         <ci>x</ci>
        </apply>
       </apply>
       <apply>
        <times></times>
        <cn type="integer">16</cn>
        <ci>f</ci>
        <apply>
         <minus></minus>
         <ci>x</ci>
         <ci>h</ci>
        </apply>
       </apply>
      </apply>
      <apply>
       <times></times>
       <ci>f</ci>
       <apply>
        <minus></minus>
        <ci>x</ci>
        <apply>
         <times></times>
         <cn type="integer">2</cn>
         <ci>h</ci>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <cn type="integer">12</cn>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>h</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f^{\prime\prime}(x)\approx\frac{-f(x+2h)+16f(x+h)-30f(x)+16f(x-h)-f(x-2h)}{12h%
^{2}}
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Five-point_stencil:11">
 <semantics>
  <mrow>
   <mrow>
    <msup>
     <mi>f</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mn>3</mn>
      <mo stretchy="false">)</mo>
     </mrow>
    </msup>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>x</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>≈</mo>
   <mfrac>
    <mrow>
     <mrow>
      <mrow>
       <mrow>
        <mi>f</mi>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <mi>x</mi>
          <mo>+</mo>
          <mrow>
           <mn>2</mn>
           <mi>h</mi>
          </mrow>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
       <mo>-</mo>
       <mrow>
        <mn>2</mn>
        <mi>f</mi>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <mi>x</mi>
          <mo>+</mo>
          <mi>h</mi>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
      </mrow>
      <mo>+</mo>
      <mrow>
       <mn>2</mn>
       <mi>f</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mi>x</mi>
         <mo>-</mo>
         <mi>h</mi>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
     </mrow>
     <mo>-</mo>
     <mrow>
      <mi>f</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mi>x</mi>
        <mo>-</mo>
        <mrow>
         <mn>2</mn>
         <mi>h</mi>
        </mrow>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mrow>
    <mrow>
     <mn>2</mn>
     <msup>
      <mi>h</mi>
      <mn>3</mn>
     </msup>
    </mrow>
   </mfrac>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <approx></approx>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>f</ci>
      <cn type="integer">3</cn>
     </apply>
     <ci>x</ci>
    </apply>
    <apply>
     <divide></divide>
     <apply>
      <minus></minus>
      <apply>
       <plus></plus>
       <apply>
        <minus></minus>
        <apply>
         <times></times>
         <ci>f</ci>
         <apply>
          <plus></plus>
          <ci>x</ci>
          <apply>
           <times></times>
           <cn type="integer">2</cn>
           <ci>h</ci>
          </apply>
         </apply>
        </apply>
        <apply>
         <times></times>
         <cn type="integer">2</cn>
         <ci>f</ci>
         <apply>
          <plus></plus>
          <ci>x</ci>
          <ci>h</ci>
         </apply>
        </apply>
       </apply>
       <apply>
        <times></times>
        <cn type="integer">2</cn>
        <ci>f</ci>
        <apply>
         <minus></minus>
         <ci>x</ci>
         <ci>h</ci>
        </apply>
       </apply>
      </apply>
      <apply>
       <times></times>
       <ci>f</ci>
       <apply>
        <minus></minus>
        <ci>x</ci>
        <apply>
         <times></times>
         <cn type="integer">2</cn>
         <ci>h</ci>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <cn type="integer">2</cn>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>h</ci>
       <cn type="integer">3</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f^{(3)}(x)\approx\frac{f(x+2h)-2f(x+h)+2f(x-h)-f(x-2h)}{2h^{3}}
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Five-point_stencil:12">
 <semantics>
  <mrow>
   <mrow>
    <msup>
     <mi>f</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mn>4</mn>
      <mo stretchy="false">)</mo>
     </mrow>
    </msup>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>x</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>≈</mo>
   <mfrac>
    <mrow>
     <mrow>
      <mrow>
       <mrow>
        <mrow>
         <mi>f</mi>
         <mrow>
          <mo stretchy="false">(</mo>
          <mrow>
           <mi>x</mi>
           <mo>+</mo>
           <mrow>
            <mn>2</mn>
            <mi>h</mi>
           </mrow>
          </mrow>
          <mo stretchy="false">)</mo>
         </mrow>
        </mrow>
        <mo>-</mo>
        <mrow>
         <mn>4</mn>
         <mi>f</mi>
         <mrow>
          <mo stretchy="false">(</mo>
          <mrow>
           <mi>x</mi>
           <mo>+</mo>
           <mi>h</mi>
          </mrow>
          <mo stretchy="false">)</mo>
         </mrow>
        </mrow>
       </mrow>
       <mo>+</mo>
       <mrow>
        <mn>6</mn>
        <mi>f</mi>
        <mrow>
         <mo stretchy="false">(</mo>
         <mi>x</mi>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
      </mrow>
      <mo>-</mo>
      <mrow>
       <mn>4</mn>
       <mi>f</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mi>x</mi>
         <mo>-</mo>
         <mi>h</mi>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
     </mrow>
     <mo>+</mo>
     <mrow>
      <mi>f</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mi>x</mi>
        <mo>-</mo>
        <mrow>
         <mn>2</mn>
         <mi>h</mi>
        </mrow>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mrow>
    <msup>
     <mi>h</mi>
     <mn>4</mn>
    </msup>
   </mfrac>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <approx></approx>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>f</ci>
      <cn type="integer">4</cn>
     </apply>
     <ci>x</ci>
    </apply>
    <apply>
     <divide></divide>
     <apply>
      <plus></plus>
      <apply>
       <minus></minus>
       <apply>
        <plus></plus>
        <apply>
         <minus></minus>
         <apply>
          <times></times>
          <ci>f</ci>
          <apply>
           <plus></plus>
           <ci>x</ci>
           <apply>
            <times></times>
            <cn type="integer">2</cn>
            <ci>h</ci>
           </apply>
          </apply>
         </apply>
         <apply>
          <times></times>
          <cn type="integer">4</cn>
          <ci>f</ci>
          <apply>
           <plus></plus>
           <ci>x</ci>
           <ci>h</ci>
          </apply>
         </apply>
        </apply>
        <apply>
         <times></times>
         <cn type="integer">6</cn>
         <ci>f</ci>
         <ci>x</ci>
        </apply>
       </apply>
       <apply>
        <times></times>
        <cn type="integer">4</cn>
        <ci>f</ci>
        <apply>
         <minus></minus>
         <ci>x</ci>
         <ci>h</ci>
        </apply>
       </apply>
      </apply>
      <apply>
       <times></times>
       <ci>f</ci>
       <apply>
        <minus></minus>
        <ci>x</ci>
        <apply>
         <times></times>
         <cn type="integer">2</cn>
         <ci>h</ci>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>h</ci>
      <cn type="integer">4</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f^{(4)}(x)\approx\frac{f(x+2h)-4f(x+h)+6f(x)-4f(x-h)+f(x-2h)}{h^{4}}
  </annotation>
 </semantics>
</math>

</p>
<h4 id="estimated-errors">Estimated errors</h4>

<p>The errors in these approximations are <em>O</em>(<em>h</em><sup> 4</sup>), <em>O</em>(<em>h</em><sup> 2</sup>) and <em>O</em>(<em>h</em><sup> 2</sup>) respectively.<a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a></p>
<h2 id="relationship-to-lagrange-interpolating-polynomials">Relationship to Lagrange interpolating polynomials</h2>

<p>As an alternative to deriving the finite difference weights from the Taylor series, they may be obtained by differentiating the <a href="Lagrange_polynomial" title="wikilink">Lagrange polynomials</a></p>

<p>

<math display="block" id="Five-point_stencil:13">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <msub>
      <mi mathvariant="normal">ℓ</mi>
      <mi>j</mi>
     </msub>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>ξ</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <munderover>
      <mo largeop="true" movablelimits="false" symmetric="true">∏</mo>
      <mrow>
       <mrow>
        <mi>i</mi>
        <mo>=</mo>
        <mn>0</mn>
       </mrow>
       <mo rspace="4.2pt">,</mo>
       <mrow>
        <mi>i</mi>
        <mo>≠</mo>
        <mi>j</mi>
       </mrow>
      </mrow>
      <mi>k</mi>
     </munderover>
     <mfrac>
      <mrow>
       <mi>ξ</mi>
       <mo>-</mo>
       <msub>
        <mi>x</mi>
        <mi>i</mi>
       </msub>
      </mrow>
      <mrow>
       <msub>
        <mi>x</mi>
        <mi>j</mi>
       </msub>
       <mo>-</mo>
       <msub>
        <mi>x</mi>
        <mi>i</mi>
       </msub>
      </mrow>
     </mfrac>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>normal-ℓ</ci>
      <ci>j</ci>
     </apply>
     <ci>ξ</ci>
    </apply>
    <apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <csymbol cd="latexml">product</csymbol>
       <apply>
        <csymbol cd="ambiguous">formulae-sequence</csymbol>
        <apply>
         <eq></eq>
         <ci>i</ci>
         <cn type="integer">0</cn>
        </apply>
        <apply>
         <neq></neq>
         <ci>i</ci>
         <ci>j</ci>
        </apply>
       </apply>
      </apply>
      <ci>k</ci>
     </apply>
     <apply>
      <divide></divide>
      <apply>
       <minus></minus>
       <ci>ξ</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <ci>i</ci>
       </apply>
      </apply>
      <apply>
       <minus></minus>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <ci>j</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <ci>i</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \ell_{j}(\xi)=\prod_{i=0,\,i\neq j}^{k}\frac{\xi-x_{i}}{x_{j}-x_{i}},
  </annotation>
 </semantics>
</math>

</p>

<p>where the interpolation points are</p>

<p>

<math display="block" id="Five-point_stencil:14">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <msub>
      <mi>x</mi>
      <mn>0</mn>
     </msub>
     <mo>=</mo>
     <mrow>
      <mi>x</mi>
      <mo>-</mo>
      <mrow>
       <mn>2</mn>
       <mi>h</mi>
      </mrow>
     </mrow>
    </mrow>
    <mo rspace="12.5pt">,</mo>
    <mrow>
     <mrow>
      <msub>
       <mi>x</mi>
       <mn>1</mn>
      </msub>
      <mo>=</mo>
      <mrow>
       <mi>x</mi>
       <mo>-</mo>
       <mi>h</mi>
      </mrow>
     </mrow>
     <mo rspace="12.5pt">,</mo>
     <mrow>
      <mrow>
       <msub>
        <mi>x</mi>
        <mn>2</mn>
       </msub>
       <mo>=</mo>
       <mi>x</mi>
      </mrow>
      <mo rspace="12.5pt">,</mo>
      <mrow>
       <mrow>
        <msub>
         <mi>x</mi>
         <mn>3</mn>
        </msub>
        <mo>=</mo>
        <mrow>
         <mi>x</mi>
         <mo>+</mo>
         <mi>h</mi>
        </mrow>
       </mrow>
       <mo rspace="12.5pt">,</mo>
       <mrow>
        <msub>
         <mi>x</mi>
         <mn>4</mn>
        </msub>
        <mo>=</mo>
        <mrow>
         <mi>x</mi>
         <mo>+</mo>
         <mrow>
          <mn>2</mn>
          <mi>h</mi>
         </mrow>
        </mrow>
       </mrow>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <cn type="integer">0</cn>
     </apply>
     <apply>
      <minus></minus>
      <ci>x</ci>
      <apply>
       <times></times>
       <cn type="integer">2</cn>
       <ci>h</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <csymbol cd="ambiguous">formulae-sequence</csymbol>
     <apply>
      <eq></eq>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <cn type="integer">1</cn>
      </apply>
      <apply>
       <minus></minus>
       <ci>x</ci>
       <ci>h</ci>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">formulae-sequence</csymbol>
      <apply>
       <eq></eq>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <cn type="integer">2</cn>
       </apply>
       <ci>x</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">formulae-sequence</csymbol>
       <apply>
        <eq></eq>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>x</ci>
         <cn type="integer">3</cn>
        </apply>
        <apply>
         <plus></plus>
         <ci>x</ci>
         <ci>h</ci>
        </apply>
       </apply>
       <apply>
        <eq></eq>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>x</ci>
         <cn type="integer">4</cn>
        </apply>
        <apply>
         <plus></plus>
         <ci>x</ci>
         <apply>
          <times></times>
          <cn type="integer">2</cn>
          <ci>h</ci>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x_{0}=x-2h,\quad x_{1}=x-h,\quad x_{2}=x,\quad x_{3}=x+h,\quad x_{4}=x+2h.
  </annotation>
 </semantics>
</math>

</p>

<p>Then, the quartic polynomial 

<math display="inline" id="Five-point_stencil:15">
 <semantics>
  <mrow>
   <msub>
    <mi>p</mi>
    <mn>4</mn>
   </msub>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>x</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>p</ci>
     <cn type="integer">4</cn>
    </apply>
    <ci>x</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p_{4}(x)
  </annotation>
 </semantics>
</math>

 interpolating ƒ(<em>x</em>) at these five points is</p>

<p>

<math display="block" id="Five-point_stencil:16">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>p</mi>
     <mn>4</mn>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>x</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <munderover>
     <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
     <mrow>
      <mi>j</mi>
      <mo>=</mo>
      <mn>0</mn>
     </mrow>
     <mn>4</mn>
    </munderover>
    <mrow>
     <mi>f</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <msub>
       <mi>x</mi>
       <mi>j</mi>
      </msub>
      <mo stretchy="false">)</mo>
     </mrow>
     <msub>
      <mi mathvariant="normal">ℓ</mi>
      <mi>j</mi>
     </msub>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>x</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>p</ci>
      <cn type="integer">4</cn>
     </apply>
     <ci>x</ci>
    </apply>
    <apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <apply>
        <eq></eq>
        <ci>j</ci>
        <cn type="integer">0</cn>
       </apply>
      </apply>
      <cn type="integer">4</cn>
     </apply>
     <apply>
      <times></times>
      <ci>f</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <ci>j</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>normal-ℓ</ci>
       <ci>j</ci>
      </apply>
      <ci>x</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p_{4}(x)=\sum\limits_{j=0}^{4}f(x_{j})\ell_{j}(x)
  </annotation>
 </semantics>
</math>

</p>

<p>and its derivative is</p>

<p>

<math display="block" id="Five-point_stencil:17">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <msubsup>
      <mi>p</mi>
      <mn>4</mn>
      <mo>′</mo>
     </msubsup>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>x</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <munderover>
      <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
      <mrow>
       <mi>j</mi>
       <mo>=</mo>
       <mn>0</mn>
      </mrow>
      <mn>4</mn>
     </munderover>
     <mrow>
      <mi>f</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <msub>
        <mi>x</mi>
        <mi>j</mi>
       </msub>
       <mo stretchy="false">)</mo>
      </mrow>
      <msubsup>
       <mi mathvariant="normal">ℓ</mi>
       <mi>j</mi>
       <mo>′</mo>
      </msubsup>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>x</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>p</ci>
       <cn type="integer">4</cn>
      </apply>
      <ci>normal-′</ci>
     </apply>
     <ci>x</ci>
    </apply>
    <apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <apply>
        <eq></eq>
        <ci>j</ci>
        <cn type="integer">0</cn>
       </apply>
      </apply>
      <cn type="integer">4</cn>
     </apply>
     <apply>
      <times></times>
      <ci>f</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <ci>j</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>normal-ℓ</ci>
        <ci>normal-′</ci>
       </apply>
       <ci>j</ci>
      </apply>
      <ci>x</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p_{4}^{\prime}(x)=\sum\limits_{j=0}^{4}f(x_{j})\ell^{\prime}_{j}(x).
  </annotation>
 </semantics>
</math>

</p>

<p>So, the finite difference approximation of ƒ<sup> ′</sup>(<em>x</em>) at the middle point <em>x</em> = <em>x</em><sub>2</sub> is</p>

<p>

<math display="block" id="Five-point_stencil:18">
 <semantics>
  <mrow>
   <mrow>
    <msup>
     <mi>f</mi>
     <mo>′</mo>
    </msup>
    <mrow>
     <mo stretchy="false">(</mo>
     <msub>
      <mi>x</mi>
      <mn>2</mn>
     </msub>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <msubsup>
      <mi mathvariant="normal">ℓ</mi>
      <mn>0</mn>
      <mo>′</mo>
     </msubsup>
     <mrow>
      <mo stretchy="false">(</mo>
      <msub>
       <mi>x</mi>
       <mn>2</mn>
      </msub>
      <mo stretchy="false">)</mo>
     </mrow>
     <mi>f</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <msub>
       <mi>x</mi>
       <mn>0</mn>
      </msub>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>+</mo>
    <mrow>
     <msubsup>
      <mi mathvariant="normal">ℓ</mi>
      <mn>1</mn>
      <mo>′</mo>
     </msubsup>
     <mrow>
      <mo stretchy="false">(</mo>
      <msub>
       <mi>x</mi>
       <mn>2</mn>
      </msub>
      <mo stretchy="false">)</mo>
     </mrow>
     <mi>f</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <msub>
       <mi>x</mi>
       <mn>1</mn>
      </msub>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>+</mo>
    <mrow>
     <msubsup>
      <mi mathvariant="normal">ℓ</mi>
      <mn>2</mn>
      <mo>′</mo>
     </msubsup>
     <mrow>
      <mo stretchy="false">(</mo>
      <msub>
       <mi>x</mi>
       <mn>2</mn>
      </msub>
      <mo stretchy="false">)</mo>
     </mrow>
     <mi>f</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <msub>
       <mi>x</mi>
       <mn>2</mn>
      </msub>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>+</mo>
    <mrow>
     <msubsup>
      <mi mathvariant="normal">ℓ</mi>
      <mn>3</mn>
      <mo>′</mo>
     </msubsup>
     <mrow>
      <mo stretchy="false">(</mo>
      <msub>
       <mi>x</mi>
       <mn>2</mn>
      </msub>
      <mo stretchy="false">)</mo>
     </mrow>
     <mi>f</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <msub>
       <mi>x</mi>
       <mn>3</mn>
      </msub>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>+</mo>
    <mrow>
     <msubsup>
      <mi mathvariant="normal">ℓ</mi>
      <mn>4</mn>
      <mo>′</mo>
     </msubsup>
     <mrow>
      <mo stretchy="false">(</mo>
      <msub>
       <mi>x</mi>
       <mn>2</mn>
      </msub>
      <mo stretchy="false">)</mo>
     </mrow>
     <mi>f</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <msub>
       <mi>x</mi>
       <mn>4</mn>
      </msub>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>+</mo>
    <mrow>
     <mi>O</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <msup>
       <mi>h</mi>
       <mn>4</mn>
      </msup>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>f</ci>
      <ci>normal-′</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <cn type="integer">2</cn>
     </apply>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>normal-ℓ</ci>
        <cn type="integer">0</cn>
       </apply>
       <ci>normal-′</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <cn type="integer">2</cn>
      </apply>
      <ci>f</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <cn type="integer">0</cn>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>normal-ℓ</ci>
        <cn type="integer">1</cn>
       </apply>
       <ci>normal-′</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <cn type="integer">2</cn>
      </apply>
      <ci>f</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>normal-ℓ</ci>
        <cn type="integer">2</cn>
       </apply>
       <ci>normal-′</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <cn type="integer">2</cn>
      </apply>
      <ci>f</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>normal-ℓ</ci>
        <cn type="integer">3</cn>
       </apply>
       <ci>normal-′</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <cn type="integer">2</cn>
      </apply>
      <ci>f</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <cn type="integer">3</cn>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>normal-ℓ</ci>
        <cn type="integer">4</cn>
       </apply>
       <ci>normal-′</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <cn type="integer">2</cn>
      </apply>
      <ci>f</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <cn type="integer">4</cn>
      </apply>
     </apply>
     <apply>
      <times></times>
      <ci>O</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>h</ci>
       <cn type="integer">4</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f^{\prime}(x_{2})=\ell_{0}^{\prime}(x_{2})f(x_{0})+\ell_{1}^{\prime}(x_{2})f(x%
_{1})+\ell_{2}^{\prime}(x_{2})f(x_{2})+\ell_{3}^{\prime}(x_{2})f(x_{3})+\ell_{%
4}^{\prime}(x_{2})f(x_{4})+O(h^{4})
  </annotation>
 </semantics>
</math>

</p>

<p>Evaluating the derivatives of the five Lagrange polynomials at <em>x</em>=<em>x</em><sub>2</sub> gives the same weights as above. This method can be more flexible as the extension to a non-uniform grid is quite straightforward.</p>
<h2 id="two-dimensions">Two dimensions</h2>

<p>In two dimensions, if for example the size of the squares in the grid is <em>h</em> by <em>h</em>, the five point stencil of a point (<em>x</em>, <em>y</em>) in the grid is</p>

<p>

<math display="block" id="Five-point_stencil:19">
 <semantics>
  <mrow>
   <mrow>
    <mo stretchy="false">{</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>x</mi>
      <mo>-</mo>
      <mi>h</mi>
     </mrow>
     <mo>,</mo>
     <mi>y</mi>
     <mo stretchy="false">)</mo>
    </mrow>
    <mo>,</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>x</mi>
     <mo>,</mo>
     <mi>y</mi>
     <mo stretchy="false">)</mo>
    </mrow>
    <mo>,</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>x</mi>
      <mo>+</mo>
      <mi>h</mi>
     </mrow>
     <mo>,</mo>
     <mi>y</mi>
     <mo stretchy="false">)</mo>
    </mrow>
    <mo>,</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>x</mi>
     <mo>,</mo>
     <mrow>
      <mi>y</mi>
      <mo>-</mo>
      <mi>h</mi>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
    <mo>,</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>x</mi>
     <mo>,</mo>
     <mrow>
      <mi>y</mi>
      <mo>+</mo>
      <mi>h</mi>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
    <mo stretchy="false">}</mo>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <set>
    <interval closure="open">
     <apply>
      <minus></minus>
      <ci>x</ci>
      <ci>h</ci>
     </apply>
     <ci>y</ci>
    </interval>
    <interval closure="open">
     <ci>x</ci>
     <ci>y</ci>
    </interval>
    <interval closure="open">
     <apply>
      <plus></plus>
      <ci>x</ci>
      <ci>h</ci>
     </apply>
     <ci>y</ci>
    </interval>
    <interval closure="open">
     <ci>x</ci>
     <apply>
      <minus></minus>
      <ci>y</ci>
      <ci>h</ci>
     </apply>
    </interval>
    <interval closure="open">
     <ci>x</ci>
     <apply>
      <plus></plus>
      <ci>y</ci>
      <ci>h</ci>
     </apply>
    </interval>
   </set>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \{(x-h,y),(x,y),(x+h,y),(x,y-h),(x,y+h)\},\,
  </annotation>
 </semantics>
</math>

 forming a pattern that is also called a <a class="uri" href="quincunx" title="wikilink">quincunx</a>. This stencil is often used to approximate the <a class="uri" href="Laplacian" title="wikilink">Laplacian</a> of a function of two variables:</p>

<p>

<math display="block" id="Five-point_stencil:20">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi mathvariant="normal">Δ</mi>
     <mi>f</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>x</mi>
      <mo>,</mo>
      <mi>y</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>≈</mo>
    <mfrac>
     <mrow>
      <mrow>
       <mrow>
        <mi>f</mi>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <mi>x</mi>
          <mo>-</mo>
          <mi>h</mi>
         </mrow>
         <mo>,</mo>
         <mi>y</mi>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
       <mo>+</mo>
       <mrow>
        <mi>f</mi>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <mi>x</mi>
          <mo>+</mo>
          <mi>h</mi>
         </mrow>
         <mo>,</mo>
         <mi>y</mi>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
       <mo>+</mo>
       <mrow>
        <mi>f</mi>
        <mrow>
         <mo stretchy="false">(</mo>
         <mi>x</mi>
         <mo>,</mo>
         <mrow>
          <mi>y</mi>
          <mo>-</mo>
          <mi>h</mi>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
       <mo>+</mo>
       <mrow>
        <mi>f</mi>
        <mrow>
         <mo stretchy="false">(</mo>
         <mi>x</mi>
         <mo>,</mo>
         <mrow>
          <mi>y</mi>
          <mo>+</mo>
          <mi>h</mi>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
      </mrow>
      <mo>-</mo>
      <mrow>
       <mn>4</mn>
       <mi>f</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>x</mi>
        <mo>,</mo>
        <mi>y</mi>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
     </mrow>
     <msup>
      <mi>h</mi>
      <mn>2</mn>
     </msup>
    </mfrac>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <approx></approx>
    <apply>
     <times></times>
     <ci>normal-Δ</ci>
     <ci>f</ci>
     <interval closure="open">
      <ci>x</ci>
      <ci>y</ci>
     </interval>
    </apply>
    <apply>
     <divide></divide>
     <apply>
      <minus></minus>
      <apply>
       <plus></plus>
       <apply>
        <times></times>
        <ci>f</ci>
        <interval closure="open">
         <apply>
          <minus></minus>
          <ci>x</ci>
          <ci>h</ci>
         </apply>
         <ci>y</ci>
        </interval>
       </apply>
       <apply>
        <times></times>
        <ci>f</ci>
        <interval closure="open">
         <apply>
          <plus></plus>
          <ci>x</ci>
          <ci>h</ci>
         </apply>
         <ci>y</ci>
        </interval>
       </apply>
       <apply>
        <times></times>
        <ci>f</ci>
        <interval closure="open">
         <ci>x</ci>
         <apply>
          <minus></minus>
          <ci>y</ci>
          <ci>h</ci>
         </apply>
        </interval>
       </apply>
       <apply>
        <times></times>
        <ci>f</ci>
        <interval closure="open">
         <ci>x</ci>
         <apply>
          <plus></plus>
          <ci>y</ci>
          <ci>h</ci>
         </apply>
        </interval>
       </apply>
      </apply>
      <apply>
       <times></times>
       <cn type="integer">4</cn>
       <ci>f</ci>
       <interval closure="open">
        <ci>x</ci>
        <ci>y</ci>
       </interval>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>h</ci>
      <cn type="integer">2</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Delta f(x,y)\approx\frac{f(x-h,y)+f(x+h,y)+f(x,y-h)+f(x,y+h)-4f(x,y)}{h^{2}}.
  </annotation>
 </semantics>
</math>

</p>

<p>The error in this approximation is <em>O</em>(<em>h</em><sup> 2</sup>),<a class="footnoteRef" href="#fn3" id="fnref3"><sup>3</sup></a> which may be explained as follows:</p>

<p>From the 3 point stencils for the second derivative of a function with respect to x and y:</p>

<p>

<math display="inline" id="Five-point_stencil:21">
 <semantics>
  <mtable>
   <mtr>
    <mtd columnalign="left">
     <mrow>
      <mfrac>
       <mrow>
        <msup>
         <mo>∂</mo>
         <mn>2</mn>
        </msup>
        <mi>f</mi>
       </mrow>
       <mrow>
        <mo>∂</mo>
        <msup>
         <mi>x</mi>
         <mn>2</mn>
        </msup>
       </mrow>
      </mfrac>
      <mo>=</mo>
      <mrow>
       <mrow>
        <mfrac>
         <mrow>
          <mrow>
           <mrow>
            <mi>f</mi>
            <mrow>
             <mo>(</mo>
             <mrow>
              <mi>x</mi>
              <mo>+</mo>
              <mrow>
               <mi mathvariant="normal">Δ</mi>
               <mi>x</mi>
              </mrow>
             </mrow>
             <mo>,</mo>
             <mi>y</mi>
             <mo>)</mo>
            </mrow>
           </mrow>
           <mo>+</mo>
           <mrow>
            <mi>f</mi>
            <mrow>
             <mo>(</mo>
             <mrow>
              <mi>x</mi>
              <mo>-</mo>
              <mrow>
               <mi mathvariant="normal">Δ</mi>
               <mi>x</mi>
              </mrow>
             </mrow>
             <mo>,</mo>
             <mi>y</mi>
             <mo>)</mo>
            </mrow>
           </mrow>
          </mrow>
          <mo>-</mo>
          <mrow>
           <mn>2</mn>
           <mi>f</mi>
           <mrow>
            <mo stretchy="false">(</mo>
            <mi>x</mi>
            <mo>,</mo>
            <mi>y</mi>
            <mo stretchy="false">)</mo>
           </mrow>
          </mrow>
         </mrow>
         <mrow>
          <mi mathvariant="normal">Δ</mi>
          <msup>
           <mi>x</mi>
           <mn>2</mn>
          </msup>
         </mrow>
        </mfrac>
        <mo>-</mo>
        <mrow>
         <mn>2</mn>
         <mfrac>
          <mrow>
           <msup>
            <mi>f</mi>
            <mrow>
             <mo stretchy="false">(</mo>
             <mn>4</mn>
             <mo stretchy="false">)</mo>
            </mrow>
           </msup>
           <mrow>
            <mo stretchy="false">(</mo>
            <mi>x</mi>
            <mo>,</mo>
            <mi>y</mi>
            <mo stretchy="false">)</mo>
           </mrow>
          </mrow>
          <mrow>
           <mn>4</mn>
           <mo lspace="0pt" rspace="3.5pt">!</mo>
          </mrow>
         </mfrac>
         <mi mathvariant="normal">Δ</mi>
         <msup>
          <mi>x</mi>
          <mn>2</mn>
         </msup>
        </mrow>
       </mrow>
       <mo>+</mo>
       <mi mathvariant="normal">⋯</mi>
      </mrow>
     </mrow>
    </mtd>
   </mtr>
  </mtable>
  <annotation-xml encoding="MathML-Content">
   <matrix>
    <matrixrow>
     <apply>
      <eq></eq>
      <apply>
       <divide></divide>
       <apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <partialdiff></partialdiff>
         <cn type="integer">2</cn>
        </apply>
        <ci>f</ci>
       </apply>
       <apply>
        <partialdiff></partialdiff>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>x</ci>
         <cn type="integer">2</cn>
        </apply>
       </apply>
      </apply>
      <apply>
       <plus></plus>
       <apply>
        <minus></minus>
        <apply>
         <divide></divide>
         <apply>
          <minus></minus>
          <apply>
           <plus></plus>
           <apply>
            <times></times>
            <ci>f</ci>
            <interval closure="open">
             <apply>
              <plus></plus>
              <ci>x</ci>
              <apply>
               <times></times>
               <ci>normal-Δ</ci>
               <ci>x</ci>
              </apply>
             </apply>
             <ci>y</ci>
            </interval>
           </apply>
           <apply>
            <times></times>
            <ci>f</ci>
            <interval closure="open">
             <apply>
              <minus></minus>
              <ci>x</ci>
              <apply>
               <times></times>
               <ci>normal-Δ</ci>
               <ci>x</ci>
              </apply>
             </apply>
             <ci>y</ci>
            </interval>
           </apply>
          </apply>
          <apply>
           <times></times>
           <cn type="integer">2</cn>
           <ci>f</ci>
           <interval closure="open">
            <ci>x</ci>
            <ci>y</ci>
           </interval>
          </apply>
         </apply>
         <apply>
          <times></times>
          <ci>normal-Δ</ci>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <ci>x</ci>
           <cn type="integer">2</cn>
          </apply>
         </apply>
        </apply>
        <apply>
         <times></times>
         <cn type="integer">2</cn>
         <apply>
          <divide></divide>
          <apply>
           <times></times>
           <apply>
            <csymbol cd="ambiguous">superscript</csymbol>
            <ci>f</ci>
            <cn type="integer">4</cn>
           </apply>
           <interval closure="open">
            <ci>x</ci>
            <ci>y</ci>
           </interval>
          </apply>
          <apply>
           <factorial></factorial>
           <cn type="integer">4</cn>
          </apply>
         </apply>
         <ci>normal-Δ</ci>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>x</ci>
          <cn type="integer">2</cn>
         </apply>
        </apply>
       </apply>
       <ci>normal-⋯</ci>
      </apply>
     </apply>
    </matrixrow>
   </matrix>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \begin{array}[]{l}\frac{\partial^{2}f}{\partial x^{2}}=\frac{f\left(x+\Delta x%
,y\right)+f\left(x-\Delta x,y\right)-2f(x,y)}{\Delta x^{2}}-2\frac{f^{(4)}(x,y%
)}{4!}\Delta x^{2}+\cdots\end{array}
  </annotation>
 </semantics>
</math>

 

<math display="inline" id="Five-point_stencil:22">
 <semantics>
  <mtable>
   <mtr>
    <mtd columnalign="left">
     <mrow>
      <mfrac>
       <mrow>
        <msup>
         <mo>∂</mo>
         <mn>2</mn>
        </msup>
        <mi>f</mi>
       </mrow>
       <mrow>
        <mo>∂</mo>
        <msup>
         <mi>y</mi>
         <mn>2</mn>
        </msup>
       </mrow>
      </mfrac>
      <mo>=</mo>
      <mrow>
       <mrow>
        <mfrac>
         <mrow>
          <mrow>
           <mrow>
            <mi>f</mi>
            <mrow>
             <mo>(</mo>
             <mi>x</mi>
             <mo>,</mo>
             <mrow>
              <mi>y</mi>
              <mo>+</mo>
              <mrow>
               <mi mathvariant="normal">Δ</mi>
               <mi>y</mi>
              </mrow>
             </mrow>
             <mo>)</mo>
            </mrow>
           </mrow>
           <mo>+</mo>
           <mrow>
            <mi>f</mi>
            <mrow>
             <mo>(</mo>
             <mi>x</mi>
             <mo>,</mo>
             <mrow>
              <mi>y</mi>
              <mo>-</mo>
              <mrow>
               <mi mathvariant="normal">Δ</mi>
               <mi>y</mi>
              </mrow>
             </mrow>
             <mo>)</mo>
            </mrow>
           </mrow>
          </mrow>
          <mo>-</mo>
          <mrow>
           <mn>2</mn>
           <mi>f</mi>
           <mrow>
            <mo stretchy="false">(</mo>
            <mi>x</mi>
            <mo>,</mo>
            <mi>y</mi>
            <mo stretchy="false">)</mo>
           </mrow>
          </mrow>
         </mrow>
         <mrow>
          <mi mathvariant="normal">Δ</mi>
          <msup>
           <mi>y</mi>
           <mn>2</mn>
          </msup>
         </mrow>
        </mfrac>
        <mo>-</mo>
        <mrow>
         <mn>2</mn>
         <mfrac>
          <mrow>
           <msup>
            <mi>f</mi>
            <mrow>
             <mo stretchy="false">(</mo>
             <mn>4</mn>
             <mo stretchy="false">)</mo>
            </mrow>
           </msup>
           <mrow>
            <mo stretchy="false">(</mo>
            <mi>x</mi>
            <mo>,</mo>
            <mi>y</mi>
            <mo stretchy="false">)</mo>
           </mrow>
          </mrow>
          <mrow>
           <mn>4</mn>
           <mo lspace="0pt" rspace="3.5pt">!</mo>
          </mrow>
         </mfrac>
         <mi mathvariant="normal">Δ</mi>
         <msup>
          <mi>y</mi>
          <mn>2</mn>
         </msup>
        </mrow>
       </mrow>
       <mo>+</mo>
       <mi mathvariant="normal">⋯</mi>
      </mrow>
     </mrow>
    </mtd>
   </mtr>
  </mtable>
  <annotation-xml encoding="MathML-Content">
   <matrix>
    <matrixrow>
     <apply>
      <eq></eq>
      <apply>
       <divide></divide>
       <apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <partialdiff></partialdiff>
         <cn type="integer">2</cn>
        </apply>
        <ci>f</ci>
       </apply>
       <apply>
        <partialdiff></partialdiff>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>y</ci>
         <cn type="integer">2</cn>
        </apply>
       </apply>
      </apply>
      <apply>
       <plus></plus>
       <apply>
        <minus></minus>
        <apply>
         <divide></divide>
         <apply>
          <minus></minus>
          <apply>
           <plus></plus>
           <apply>
            <times></times>
            <ci>f</ci>
            <interval closure="open">
             <ci>x</ci>
             <apply>
              <plus></plus>
              <ci>y</ci>
              <apply>
               <times></times>
               <ci>normal-Δ</ci>
               <ci>y</ci>
              </apply>
             </apply>
            </interval>
           </apply>
           <apply>
            <times></times>
            <ci>f</ci>
            <interval closure="open">
             <ci>x</ci>
             <apply>
              <minus></minus>
              <ci>y</ci>
              <apply>
               <times></times>
               <ci>normal-Δ</ci>
               <ci>y</ci>
              </apply>
             </apply>
            </interval>
           </apply>
          </apply>
          <apply>
           <times></times>
           <cn type="integer">2</cn>
           <ci>f</ci>
           <interval closure="open">
            <ci>x</ci>
            <ci>y</ci>
           </interval>
          </apply>
         </apply>
         <apply>
          <times></times>
          <ci>normal-Δ</ci>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <ci>y</ci>
           <cn type="integer">2</cn>
          </apply>
         </apply>
        </apply>
        <apply>
         <times></times>
         <cn type="integer">2</cn>
         <apply>
          <divide></divide>
          <apply>
           <times></times>
           <apply>
            <csymbol cd="ambiguous">superscript</csymbol>
            <ci>f</ci>
            <cn type="integer">4</cn>
           </apply>
           <interval closure="open">
            <ci>x</ci>
            <ci>y</ci>
           </interval>
          </apply>
          <apply>
           <factorial></factorial>
           <cn type="integer">4</cn>
          </apply>
         </apply>
         <ci>normal-Δ</ci>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>y</ci>
          <cn type="integer">2</cn>
         </apply>
        </apply>
       </apply>
       <ci>normal-⋯</ci>
      </apply>
     </apply>
    </matrixrow>
   </matrix>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \begin{array}[]{l}\frac{\partial^{2}f}{\partial y^{2}}=\frac{f\left(x,y+\Delta
y%
\right)+f\left(x,y-\Delta y\right)-2f(x,y)}{\Delta y^{2}}-2\frac{f^{(4)}(x,y)}%
{4!}\Delta y^{2}+\cdots\end{array}
  </annotation>
 </semantics>
</math>

</p>

<p>If we assume 

<math display="inline" id="Five-point_stencil:23">
 <semantics>
  <mrow>
   <mrow>
    <mi mathvariant="normal">Δ</mi>
    <mi>x</mi>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mi mathvariant="normal">Δ</mi>
    <mi>y</mi>
   </mrow>
   <mo>=</mo>
   <mi>h</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <times></times>
      <ci>normal-Δ</ci>
      <ci>x</ci>
     </apply>
     <apply>
      <times></times>
      <ci>normal-Δ</ci>
      <ci>y</ci>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <ci>h</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Delta x=\Delta y=h
  </annotation>
 </semantics>
</math>

:</p>

<p>

<math display="inline" id="Five-point_stencil:24">
 <semantics>
  <mtable>
   <mtr>
    <mtd columnalign="left">
     <mrow>
      <msup>
       <mo>∇</mo>
       <mn>2</mn>
      </msup>
      <mi>f</mi>
     </mrow>
    </mtd>
    <mtd columnalign="left">
     <mrow>
      <mi></mi>
      <mo>=</mo>
      <mrow>
       <mfrac>
        <mrow>
         <msup>
          <mo>∂</mo>
          <mn>2</mn>
         </msup>
         <mi>f</mi>
        </mrow>
        <mrow>
         <mo>∂</mo>
         <msup>
          <mi>x</mi>
          <mn>2</mn>
         </msup>
        </mrow>
       </mfrac>
       <mo>+</mo>
       <mfrac>
        <mrow>
         <msup>
          <mo>∂</mo>
          <mn>2</mn>
         </msup>
         <mi>f</mi>
        </mrow>
        <mrow>
         <mo>∂</mo>
         <msup>
          <mi>y</mi>
          <mn>2</mn>
         </msup>
        </mrow>
       </mfrac>
      </mrow>
     </mrow>
    </mtd>
   </mtr>
   <mtr>
    <mtd></mtd>
    <mtd columnalign="left">
     <mrow>
      <mi></mi>
      <mo>=</mo>
      <mrow>
       <mrow>
        <mfrac>
         <mrow>
          <mrow>
           <mrow>
            <mi>f</mi>
            <mrow>
             <mo>(</mo>
             <mrow>
              <mi>x</mi>
              <mo>+</mo>
              <mi>h</mi>
             </mrow>
             <mo>,</mo>
             <mi>y</mi>
             <mo>)</mo>
            </mrow>
           </mrow>
           <mo>+</mo>
           <mrow>
            <mi>f</mi>
            <mrow>
             <mo>(</mo>
             <mrow>
              <mi>x</mi>
              <mo>-</mo>
              <mi>h</mi>
             </mrow>
             <mo>,</mo>
             <mi>y</mi>
             <mo>)</mo>
            </mrow>
           </mrow>
           <mo>+</mo>
           <mrow>
            <mi>f</mi>
            <mrow>
             <mo>(</mo>
             <mi>x</mi>
             <mo>,</mo>
             <mrow>
              <mi>y</mi>
              <mo>+</mo>
              <mi>h</mi>
             </mrow>
             <mo>)</mo>
            </mrow>
           </mrow>
           <mo>+</mo>
           <mrow>
            <mi>f</mi>
            <mrow>
             <mo>(</mo>
             <mi>x</mi>
             <mo>,</mo>
             <mrow>
              <mi>y</mi>
              <mo>-</mo>
              <mi>h</mi>
             </mrow>
             <mo>)</mo>
            </mrow>
           </mrow>
          </mrow>
          <mo>-</mo>
          <mrow>
           <mn>4</mn>
           <mi>f</mi>
           <mrow>
            <mo stretchy="false">(</mo>
            <mi>x</mi>
            <mo>,</mo>
            <mi>y</mi>
            <mo stretchy="false">)</mo>
           </mrow>
          </mrow>
         </mrow>
         <msup>
          <mi>h</mi>
          <mn>2</mn>
         </msup>
        </mfrac>
        <mo>-</mo>
        <mrow>
         <mn>4</mn>
         <mfrac>
          <mrow>
           <msup>
            <mi>f</mi>
            <mrow>
             <mo stretchy="false">(</mo>
             <mn>4</mn>
             <mo stretchy="false">)</mo>
            </mrow>
           </msup>
           <mrow>
            <mo stretchy="false">(</mo>
            <mi>x</mi>
            <mo>,</mo>
            <mi>y</mi>
            <mo stretchy="false">)</mo>
           </mrow>
          </mrow>
          <mrow>
           <mn>4</mn>
           <mo lspace="0pt" rspace="3.5pt">!</mo>
          </mrow>
         </mfrac>
         <msup>
          <mi>h</mi>
          <mn>2</mn>
         </msup>
        </mrow>
       </mrow>
       <mo>+</mo>
       <mi mathvariant="normal">⋯</mi>
      </mrow>
     </mrow>
    </mtd>
   </mtr>
   <mtr>
    <mtd></mtd>
    <mtd columnalign="left">
     <mrow>
      <mi></mi>
      <mo>=</mo>
      <mrow>
       <mfrac>
        <mrow>
         <mrow>
          <mrow>
           <mi>f</mi>
           <mrow>
            <mo>(</mo>
            <mrow>
             <mi>x</mi>
             <mo>+</mo>
             <mi>h</mi>
            </mrow>
            <mo>,</mo>
            <mi>y</mi>
            <mo>)</mo>
           </mrow>
          </mrow>
          <mo>+</mo>
          <mrow>
           <mi>f</mi>
           <mrow>
            <mo>(</mo>
            <mrow>
             <mi>x</mi>
             <mo>-</mo>
             <mi>h</mi>
            </mrow>
            <mo>,</mo>
            <mi>y</mi>
            <mo>)</mo>
           </mrow>
          </mrow>
          <mo>+</mo>
          <mrow>
           <mi>f</mi>
           <mrow>
            <mo>(</mo>
            <mi>x</mi>
            <mo>,</mo>
            <mrow>
             <mi>y</mi>
             <mo>+</mo>
             <mi>h</mi>
            </mrow>
            <mo>)</mo>
           </mrow>
          </mrow>
          <mo>+</mo>
          <mrow>
           <mi>f</mi>
           <mrow>
            <mo>(</mo>
            <mi>x</mi>
            <mo>,</mo>
            <mrow>
             <mi>y</mi>
             <mo>-</mo>
             <mi>h</mi>
            </mrow>
            <mo>)</mo>
           </mrow>
          </mrow>
         </mrow>
         <mo>-</mo>
         <mrow>
          <mn>4</mn>
          <mi>f</mi>
          <mrow>
           <mo stretchy="false">(</mo>
           <mi>x</mi>
           <mo>,</mo>
           <mi>y</mi>
           <mo stretchy="false">)</mo>
          </mrow>
         </mrow>
        </mrow>
        <msup>
         <mi>h</mi>
         <mn>2</mn>
        </msup>
       </mfrac>
       <mo>+</mo>
       <mrow>
        <mi>O</mi>
        <mrow>
         <mo>(</mo>
         <msup>
          <mi>h</mi>
          <mn>2</mn>
         </msup>
         <mo>)</mo>
        </mrow>
       </mrow>
      </mrow>
     </mrow>
    </mtd>
   </mtr>
  </mtable>
  <annotation-xml encoding="MathML-Content">
   <matrix>
    <matrixrow>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>normal-∇</ci>
       <cn type="integer">2</cn>
      </apply>
      <ci>f</ci>
     </apply>
     <apply>
      <eq></eq>
      <csymbol cd="latexml">absent</csymbol>
      <apply>
       <plus></plus>
       <apply>
        <divide></divide>
        <apply>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <partialdiff></partialdiff>
          <cn type="integer">2</cn>
         </apply>
         <ci>f</ci>
        </apply>
        <apply>
         <partialdiff></partialdiff>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>x</ci>
          <cn type="integer">2</cn>
         </apply>
        </apply>
       </apply>
       <apply>
        <divide></divide>
        <apply>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <partialdiff></partialdiff>
          <cn type="integer">2</cn>
         </apply>
         <ci>f</ci>
        </apply>
        <apply>
         <partialdiff></partialdiff>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>y</ci>
          <cn type="integer">2</cn>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </matrixrow>
    <matrixrow>
     <cerror>
      <csymbol cd="ambiguous">missing-subexpression</csymbol>
     </cerror>
     <apply>
      <eq></eq>
      <csymbol cd="latexml">absent</csymbol>
      <apply>
       <plus></plus>
       <apply>
        <minus></minus>
        <apply>
         <divide></divide>
         <apply>
          <minus></minus>
          <apply>
           <plus></plus>
           <apply>
            <times></times>
            <ci>f</ci>
            <interval closure="open">
             <apply>
              <plus></plus>
              <ci>x</ci>
              <ci>h</ci>
             </apply>
             <ci>y</ci>
            </interval>
           </apply>
           <apply>
            <times></times>
            <ci>f</ci>
            <interval closure="open">
             <apply>
              <minus></minus>
              <ci>x</ci>
              <ci>h</ci>
             </apply>
             <ci>y</ci>
            </interval>
           </apply>
           <apply>
            <times></times>
            <ci>f</ci>
            <interval closure="open">
             <ci>x</ci>
             <apply>
              <plus></plus>
              <ci>y</ci>
              <ci>h</ci>
             </apply>
            </interval>
           </apply>
           <apply>
            <times></times>
            <ci>f</ci>
            <interval closure="open">
             <ci>x</ci>
             <apply>
              <minus></minus>
              <ci>y</ci>
              <ci>h</ci>
             </apply>
            </interval>
           </apply>
          </apply>
          <apply>
           <times></times>
           <cn type="integer">4</cn>
           <ci>f</ci>
           <interval closure="open">
            <ci>x</ci>
            <ci>y</ci>
           </interval>
          </apply>
         </apply>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>h</ci>
          <cn type="integer">2</cn>
         </apply>
        </apply>
        <apply>
         <times></times>
         <cn type="integer">4</cn>
         <apply>
          <divide></divide>
          <apply>
           <times></times>
           <apply>
            <csymbol cd="ambiguous">superscript</csymbol>
            <ci>f</ci>
            <cn type="integer">4</cn>
           </apply>
           <interval closure="open">
            <ci>x</ci>
            <ci>y</ci>
           </interval>
          </apply>
          <apply>
           <factorial></factorial>
           <cn type="integer">4</cn>
          </apply>
         </apply>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>h</ci>
          <cn type="integer">2</cn>
         </apply>
        </apply>
       </apply>
       <ci>normal-⋯</ci>
      </apply>
     </apply>
    </matrixrow>
    <matrixrow>
     <cerror>
      <csymbol cd="ambiguous">missing-subexpression</csymbol>
     </cerror>
     <apply>
      <eq></eq>
      <csymbol cd="latexml">absent</csymbol>
      <apply>
       <plus></plus>
       <apply>
        <divide></divide>
        <apply>
         <minus></minus>
         <apply>
          <plus></plus>
          <apply>
           <times></times>
           <ci>f</ci>
           <interval closure="open">
            <apply>
             <plus></plus>
             <ci>x</ci>
             <ci>h</ci>
            </apply>
            <ci>y</ci>
           </interval>
          </apply>
          <apply>
           <times></times>
           <ci>f</ci>
           <interval closure="open">
            <apply>
             <minus></minus>
             <ci>x</ci>
             <ci>h</ci>
            </apply>
            <ci>y</ci>
           </interval>
          </apply>
          <apply>
           <times></times>
           <ci>f</ci>
           <interval closure="open">
            <ci>x</ci>
            <apply>
             <plus></plus>
             <ci>y</ci>
             <ci>h</ci>
            </apply>
           </interval>
          </apply>
          <apply>
           <times></times>
           <ci>f</ci>
           <interval closure="open">
            <ci>x</ci>
            <apply>
             <minus></minus>
             <ci>y</ci>
             <ci>h</ci>
            </apply>
           </interval>
          </apply>
         </apply>
         <apply>
          <times></times>
          <cn type="integer">4</cn>
          <ci>f</ci>
          <interval closure="open">
           <ci>x</ci>
           <ci>y</ci>
          </interval>
         </apply>
        </apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>h</ci>
         <cn type="integer">2</cn>
        </apply>
       </apply>
       <apply>
        <times></times>
        <ci>O</ci>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>h</ci>
         <cn type="integer">2</cn>
        </apply>
       </apply>
      </apply>
     </apply>
    </matrixrow>
   </matrix>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \begin{array}[]{ll}\nabla^{2}f&=\frac{\partial^{2}f}{\partial x^{2}}+\frac{%
\partial^{2}f}{\partial y^{2}}\\
&=\frac{f\left(x+h,y\right)+f\left(x-h,y\right)+f\left(x,y+h\right)+f\left(x,y%
-h\right)-4f(x,y)}{h^{2}}-4\frac{f^{(4)}(x,y)}{4!}h^{2}+\cdots\\
&=\frac{f\left(x+h,y\right)+f\left(x-h,y\right)+f\left(x,y+h\right)+f\left(x,y%
-h\right)-4f(x,y)}{h^{2}}+O\left(h^{2}\right)\\
\end{array}
  </annotation>
 </semantics>
</math>

</p>
<h2 id="see-also">See also</h2>
<ul>
<li><a href="Stencil_(numerical_analysis)" title="wikilink">Stencil (numerical analysis)</a></li>
<li><a href="Stencil_jumping" title="wikilink">Stencil jumping</a></li>
<li><a href="Finite_difference_coefficients" title="wikilink">Finite difference coefficients</a></li>
</ul>
<h2 id="references">References</h2>
<ul>
<li>

<p>. Ninth printing. Table 25.2.</p></li>
</ul>

<p>"</p>

<p><a href="Category:Numerical_differential_equations" title="wikilink">Category:Numerical differential equations</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1">Abramowitz &amp; Stegun, Table 25.2<a href="#fnref1">↩</a></li>
<li id="fn2"></li>
<li id="fn3">Abramowitz &amp; Stegun, 25.3.30<a href="#fnref3">↩</a></li>
</ol>
</section>
</body>
</html>

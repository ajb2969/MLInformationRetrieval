<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="1082">Partial-matching Meet-in-the-Middle attack</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Partial-matching Meet-in-the-Middle attack</h1>
<hr/>

<p>Partial-matching is a technique that can be used with a <a href="Meet-in-the-middle_attack" title="wikilink">MITM attack</a>. Partial-matching is where the intermediate values of the MITM attack, 

<math display="inline" id="Partial-matching_Meet-in-the-Middle_attack:0">
 <semantics>
  <mi>i</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>i</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   i
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Partial-matching_Meet-in-the-Middle_attack:1">
 <semantics>
  <mi>j</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>j</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   j
  </annotation>
 </semantics>
</math>

, computed from the plaintext and ciphertext, are matched on only a few select bits, instead of on the complete state.</p>
<h2 id="uses">Uses</h2>

<p>A limitation with MITM attacks is the amount of intermediate values that needs to be stored. In order to compare the intermediate values 

<math display="inline" id="Partial-matching_Meet-in-the-Middle_attack:2">
 <semantics>
  <mi>i</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>i</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   i
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Partial-matching_Meet-in-the-Middle_attack:3">
 <semantics>
  <mi>j</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>j</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   j
  </annotation>
 </semantics>
</math>

, all 

<math display="inline" id="Partial-matching_Meet-in-the-Middle_attack:4">
 <semantics>
  <mi>i</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>i</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   i
  </annotation>
 </semantics>
</math>

's need to be computed and stored first, before each computed 

<math display="inline" id="Partial-matching_Meet-in-the-Middle_attack:5">
 <semantics>
  <mi>j</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>j</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   j
  </annotation>
 </semantics>
</math>

 can be compared against them. If the two subciphers identified by the MITM attack both has a sufficiently large subkey, then an unfeasible amount of intermediate values need to be stored. While there are techniques such as cycle detection algorithms<a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a> that allows one to perform a MITM attack without storing either all values of 

<math display="inline" id="Partial-matching_Meet-in-the-Middle_attack:6">
 <semantics>
  <mi>i</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>i</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   i
  </annotation>
 </semantics>
</math>

 or 

<math display="inline" id="Partial-matching_Meet-in-the-Middle_attack:7">
 <semantics>
  <mi>j</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>j</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   j
  </annotation>
 </semantics>
</math>

, these techniques requires that the subciphers of the MITM attack are symmetric. Thus it is a solution that allows one to perform a MITM attack in a situation, where the subkeys are of a cardinality just large enough to make the amount of temporary values that need to be stored infeasible. While this allows one to store more temporary values, its use is still limited, as it only allows one to perform a MITM attack on a subcipher with a few more bits. As an example: If only 1/8 of the intermediate value is stored, then the subkey needs only be 3 bits larger, before the same amount of memory is required anyway, since 

<math display="inline" id="Partial-matching_Meet-in-the-Middle_attack:8">
 <semantics>
  <mrow>
   <msup>
    <mn>2</mn>
    <mrow>
     <mo>-</mo>
     <mn>3</mn>
    </mrow>
   </msup>
   <mo>=</mo>
   <mrow>
    <mn>1</mn>
    <mo>/</mo>
    <mn>8</mn>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <cn type="integer">2</cn>
     <apply>
      <minus></minus>
      <cn type="integer">3</cn>
     </apply>
    </apply>
    <apply>
     <divide></divide>
     <cn type="integer">1</cn>
     <cn type="integer">8</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   2^{-3}=1/8
  </annotation>
 </semantics>
</math>

</p>

<p>A in most cases far more useful feature provided by partial-matching in MITM attacks, is the ability to compare intermediate values computed at different rounds in the attacked cipher. If the diffusion in each round of the cipher is low enough, it might be possible over a span of rounds to find bits in the intermediate states that has not changed with a probability of 1. These bits in the intermediate states can still be compared.</p>

<p>The disadvantage for both of these uses, is that there will be more false positives for key candidates, which needs to be tested. As a rule, the chance for a false positive is given by the probability 

<math display="inline" id="Partial-matching_Meet-in-the-Middle_attack:9">
 <semantics>
  <msup>
   <mn>2</mn>
   <mrow>
    <mo>-</mo>
    <mrow>
     <mo stretchy="false">|</mo>
     <mi>i</mi>
     <mo stretchy="false">|</mo>
    </mrow>
   </mrow>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <cn type="integer">2</cn>
    <apply>
     <minus></minus>
     <apply>
      <abs></abs>
      <ci>i</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   2^{-|i|}
  </annotation>
 </semantics>
</math>

, where 

<math display="inline" id="Partial-matching_Meet-in-the-Middle_attack:10">
 <semantics>
  <mrow>
   <mo stretchy="false">|</mo>
   <mi>i</mi>
   <mo stretchy="false">|</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <abs></abs>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   |i|
  </annotation>
 </semantics>
</math>

 is the amount of matched bits.</p>
<h2 id="example">Example</h2>

<p><em>For a step-by-step example of the complete attack on KTANTAN,<a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a> see the example on the <a href="3-Subset_Meet-in-the-Middle_attack" title="wikilink">3-subset MITM</a> page. This example only deals with the part that needs partial-matching.</em> What is useful to know is that KTANTAN is a 254 round blockcipher, where each round uses 2 bits from the 80-bit key.</p>

<p>In the 3-subset attack on the KTANTAN family of ciphers, it was necessary to utilize partial-matching in order to stage the attack. Partial-matching was needed, because the intermediate values of the plain- and ciphertext in the MITM attack, were computed at the end of round 111 and at the start of round 131, respectively. Since they had a span of 20 rounds between them, they could not be compared directly.</p>

<p>The authors of the attack, however, identified some useful characteristics of KTANTAN that held with a probability of 1. Due to the low diffusion per round in KTANTAN (the security is in the number of rounds), they found out by computing forwards from round 111 and backwards from round 131 that at round 127, 8 bits from both intermediate states would remain unchanged. (It was 8 bits at round 127 for KTANTAN32. It was 10 bits at round 123 and 47 bits at round 131 for KTANTAN48 and KTANTAN64, respectively). by only comparing the 8 bits of each intermediate value, the authors was able to orchestrate a MITM attack on the cipher, despite there being 20 rounds between the two subciphers.</p>

<p>Using partial-matching increased the amount of false positives, but nothing that noticeably increased the complexity of the attack.</p>
<h2 id="notes">Notes</h2>

<p>"</p>

<p><a href="Category:Cryptographic_attacks" title="wikilink">Category:Cryptographic attacks</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1"><a href="Cycle_detection" title="wikilink">Cycle detection</a><a href="#fnref1">↩</a></li>
<li id="fn2">Andrey Bogdanov and Christian Rechberger. <a href="http://eprint.iacr.org/2010/532.pdf">"A 3-Subset Meet-in-the-Middle Attack: Cryptanalysis of the Lightweight Block Cipher KTANTAN"</a><a href="#fnref2">↩</a></li>
</ol>
</section>
</body>
</html>

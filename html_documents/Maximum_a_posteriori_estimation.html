<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="1461">Maximum a posteriori estimation</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Maximum a posteriori estimation</h1>
<hr/>

<p>In <a href="Bayesian_statistics" title="wikilink">Bayesian statistics</a>, a <strong>maximum a posteriori probability (MAP) estimate</strong> is a <a href="mode_(statistics)" title="wikilink">mode</a> of the <a href="posterior_distribution" title="wikilink">posterior distribution</a>. The MAP can be used to obtain a <a href="point_estimation" title="wikilink">point estimate</a> of an unobserved quantity on the basis of empirical data. It is closely related to <a href="Ronald_Fisher" title="wikilink">Fisher</a>'s method of <a href="maximum_likelihood" title="wikilink">maximum likelihood</a> (ML), but employs an augmented <a href="optimization_(mathematics)" title="wikilink">optimization objective</a> which incorporates a <a href="prior_distribution" title="wikilink">prior distribution</a> over the quantity one wants to estimate. MAP estimation can therefore be seen as a <a href="regularization_(mathematics)" title="wikilink">regularization</a> of ML estimation.</p>
<h2 id="description">Description</h2>

<p>Assume that we want to estimate an unobserved population parameter 

<math display="inline" id="Maximum_a_posteriori_estimation:0">
 <semantics>
  <mi>Œ∏</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>Œ∏</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \theta
  </annotation>
 </semantics>
</math>

 on the basis of observations 

<math display="inline" id="Maximum_a_posteriori_estimation:1">
 <semantics>
  <mi>x</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>x</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x
  </annotation>
 </semantics>
</math>

. Let 

<math display="inline" id="Maximum_a_posteriori_estimation:2">
 <semantics>
  <mi>f</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>f</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f
  </annotation>
 </semantics>
</math>

 be the <a href="sampling_distribution" title="wikilink">sampling distribution</a> of 

<math display="inline" id="Maximum_a_posteriori_estimation:3">
 <semantics>
  <mi>x</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>x</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x
  </annotation>
 </semantics>
</math>

, so that 

<math display="inline" id="Maximum_a_posteriori_estimation:4">
 <semantics>
  <mrow>
   <mi>f</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>x</mi>
    <mo stretchy="false">|</mo>
    <mi>Œ∏</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">f</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">x</csymbol>
     <ci>normal-|</ci>
     <csymbol cd="unknown">Œ∏</csymbol>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f(x|\theta)
  </annotation>
 </semantics>
</math>

 is the probability of 

<math display="inline" id="Maximum_a_posteriori_estimation:5">
 <semantics>
  <mi>x</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>x</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x
  </annotation>
 </semantics>
</math>

 when the underlying population parameter is 

<math display="inline" id="Maximum_a_posteriori_estimation:6">
 <semantics>
  <mi>Œ∏</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>Œ∏</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \theta
  </annotation>
 </semantics>
</math>

. Then the function:</p>

<p>

<math display="block" id="Maximum_a_posteriori_estimation:7">
 <semantics>
  <mrow>
   <mi>Œ∏</mi>
   <mo>‚Ü¶</mo>
   <mi>f</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>x</mi>
    <mo stretchy="false">|</mo>
    <mi>Œ∏</mi>
    <mo rspace="0.8pt" stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">Œ∏</csymbol>
    <csymbol cd="latexml">maps-to</csymbol>
    <csymbol cd="unknown">f</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">x</csymbol>
     <ci>normal-|</ci>
     <csymbol cd="unknown">Œ∏</csymbol>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \theta\mapsto f(x|\theta)\!
  </annotation>
 </semantics>
</math>

</p>

<p>is known as the <a href="likelihood_function" title="wikilink">likelihood function</a> and the estimate:</p>

<p>

<math display="block" id="Maximum_a_posteriori_estimation:8">
 <semantics>
  <mrow>
   <msub>
    <mover accent="true">
     <mi>Œ∏</mi>
     <mo stretchy="false">^</mo>
    </mover>
    <mi>ML</mi>
   </msub>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>x</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>=</mo>
   <mpadded width="+5pt">
    <munder accentunder="true">
     <mrow>
      <mpadded width="+1.7pt">
       <mi>arg</mi>
      </mpadded>
      <mi>max</mi>
     </mrow>
     <mo>ùúÉ</mo>
    </munder>
   </mpadded>
   <mi>f</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>x</mi>
    <mo stretchy="false">|</mo>
    <mi>Œ∏</mi>
    <mo rspace="0.8pt" stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <ci>normal-^</ci>
      <ci>Œ∏</ci>
     </apply>
     <ci>ML</ci>
    </apply>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">x</csymbol>
     <ci>normal-)</ci>
    </cerror>
    <eq></eq>
    <apply>
     <ci>Œ∏</ci>
     <apply>
      <times></times>
      <ci>arg</ci>
      <ci>max</ci>
     </apply>
    </apply>
    <csymbol cd="unknown">f</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">x</csymbol>
     <ci>normal-|</ci>
     <csymbol cd="unknown">Œ∏</csymbol>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \hat{\theta}_{\mathrm{ML}}(x)=\underset{\theta}{\operatorname{arg\,max}}\ f(x|%
\theta)\!
  </annotation>
 </semantics>
</math>

</p>

<p>is the maximum likelihood estimate of 

<math display="inline" id="Maximum_a_posteriori_estimation:9">
 <semantics>
  <mi>Œ∏</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>Œ∏</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \theta
  </annotation>
 </semantics>
</math>

.</p>

<p>Now assume that a prior distribution 

<math display="inline" id="Maximum_a_posteriori_estimation:10">
 <semantics>
  <mi>g</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>g</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   g
  </annotation>
 </semantics>
</math>

 over 

<math display="inline" id="Maximum_a_posteriori_estimation:11">
 <semantics>
  <mi>Œ∏</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>Œ∏</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \theta
  </annotation>
 </semantics>
</math>

 exists. This allows us to treat 

<math display="inline" id="Maximum_a_posteriori_estimation:12">
 <semantics>
  <mi>Œ∏</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>Œ∏</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \theta
  </annotation>
 </semantics>
</math>

 as a <a href="random_variable" title="wikilink">random variable</a> as in <a href="Bayesian_statistics" title="wikilink">Bayesian statistics</a>. Then the <a href="posterior_distribution" title="wikilink">posterior distribution</a> of 

<math display="inline" id="Maximum_a_posteriori_estimation:13">
 <semantics>
  <mi>Œ∏</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>Œ∏</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \theta
  </annotation>
 </semantics>
</math>

 is as follows:</p>

<p>

<math display="block" id="Maximum_a_posteriori_estimation:14">
 <semantics>
  <mrow>
   <mi>Œ∏</mi>
   <mo>‚Ü¶</mo>
   <mi>f</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>Œ∏</mi>
    <mo stretchy="false">|</mo>
    <mi>x</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>=</mo>
   <mpadded width="-1.7pt">
    <mfrac>
     <mrow>
      <mi>f</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>x</mi>
       <mo stretchy="false">|</mo>
       <mi>Œ∏</mi>
       <mo rspace="4.2pt" stretchy="false">)</mo>
      </mrow>
      <mi>g</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>Œ∏</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mrow>
      <mstyle displaystyle="true">
       <msub>
        <mo largeop="true" symmetric="true">‚à´</mo>
        <mrow>
         <mi>œë</mi>
         <mo>‚àà</mo>
         <mi mathvariant="normal">Œò</mi>
        </mrow>
       </msub>
      </mstyle>
      <mi>f</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>x</mi>
       <mo stretchy="false">|</mo>
       <mi>œë</mi>
       <mo rspace="4.2pt" stretchy="false">)</mo>
      </mrow>
      <mi>g</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>œë</mi>
       <mo rspace="4.2pt" stretchy="false">)</mo>
      </mrow>
      <mi>d</mi>
      <mi>œë</mi>
     </mrow>
    </mfrac>
   </mpadded>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">Œ∏</csymbol>
    <csymbol cd="latexml">maps-to</csymbol>
    <csymbol cd="unknown">f</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">Œ∏</csymbol>
     <ci>normal-|</ci>
     <csymbol cd="unknown">x</csymbol>
     <ci>normal-)</ci>
    </cerror>
    <eq></eq>
    <apply>
     <divide></divide>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <csymbol cd="unknown">f</csymbol>
      <cerror>
       <csymbol cd="ambiguous">fragments</csymbol>
       <ci>normal-(</ci>
       <csymbol cd="unknown">x</csymbol>
       <ci>normal-|</ci>
       <csymbol cd="unknown">Œ∏</csymbol>
       <ci>normal-)</ci>
      </cerror>
      <csymbol cd="unknown">g</csymbol>
      <cerror>
       <csymbol cd="ambiguous">fragments</csymbol>
       <ci>normal-(</ci>
       <csymbol cd="unknown">Œ∏</csymbol>
       <ci>normal-)</ci>
      </cerror>
     </cerror>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <int></int>
       <apply>
        <in></in>
        <ci>œë</ci>
        <ci>normal-Œò</ci>
       </apply>
      </apply>
      <csymbol cd="unknown">f</csymbol>
      <cerror>
       <csymbol cd="ambiguous">fragments</csymbol>
       <ci>normal-(</ci>
       <csymbol cd="unknown">x</csymbol>
       <ci>normal-|</ci>
       <csymbol cd="unknown">œë</csymbol>
       <ci>normal-)</ci>
      </cerror>
      <csymbol cd="unknown">g</csymbol>
      <cerror>
       <csymbol cd="ambiguous">fragments</csymbol>
       <ci>normal-(</ci>
       <csymbol cd="unknown">œë</csymbol>
       <ci>normal-)</ci>
      </cerror>
      <csymbol cd="unknown">d</csymbol>
      <csymbol cd="unknown">œë</csymbol>
     </cerror>
    </apply>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \theta\mapsto f(\theta|x)=\frac{f(x|\theta)\,g(\theta)}{\displaystyle\int_{%
\vartheta\in\Theta}f(x|\vartheta)\,g(\vartheta)\,d\vartheta}\!
  </annotation>
 </semantics>
</math>

</p>

<p>where 

<math display="inline" id="Maximum_a_posteriori_estimation:15">
 <semantics>
  <mi>g</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>g</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   g
  </annotation>
 </semantics>
</math>

 is density function of 

<math display="inline" id="Maximum_a_posteriori_estimation:16">
 <semantics>
  <mi>Œ∏</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>Œ∏</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \theta
  </annotation>
 </semantics>
</math>

, 

<math display="inline" id="Maximum_a_posteriori_estimation:17">
 <semantics>
  <mi mathvariant="normal">Œò</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>normal-Œò</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Theta
  </annotation>
 </semantics>
</math>

 is the domain of 

<math display="inline" id="Maximum_a_posteriori_estimation:18">
 <semantics>
  <mi>g</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>g</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   g
  </annotation>
 </semantics>
</math>

. This is a straightforward application of <a href="Bayes'_theorem" title="wikilink">Bayes' theorem</a>.</p>

<p>The method of maximum a posterior estimation then estimates 

<math display="inline" id="Maximum_a_posteriori_estimation:19">
 <semantics>
  <mi>Œ∏</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>Œ∏</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \theta
  </annotation>
 </semantics>
</math>

 as the <a href="mode_(statistics)" title="wikilink">mode</a> of the posterior distribution of this random variable:</p>

<p>

<math display="block" id="Maximum_a_posteriori_estimation:20">
 <semantics>
  <mrow>
   <msub>
    <mover accent="true">
     <mi>Œ∏</mi>
     <mo stretchy="false">^</mo>
    </mover>
    <mi>MAP</mi>
   </msub>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>x</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>=</mo>
   <mpadded width="+5pt">
    <munder accentunder="true">
     <mrow>
      <mpadded width="+1.7pt">
       <mi>arg</mi>
      </mpadded>
      <mi>max</mi>
     </mrow>
     <mo>ùúÉ</mo>
    </munder>
   </mpadded>
   <mfrac>
    <mrow>
     <mi>f</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>x</mi>
      <mo stretchy="false">|</mo>
      <mi>Œ∏</mi>
      <mo rspace="4.2pt" stretchy="false">)</mo>
     </mrow>
     <mi>g</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>Œ∏</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mrow>
     <mstyle displaystyle="true">
      <msub>
       <mo largeop="true" symmetric="true">‚à´</mo>
       <mi>œë</mi>
      </msub>
     </mstyle>
     <mi>f</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>x</mi>
      <mo stretchy="false">|</mo>
      <mi>œë</mi>
      <mo rspace="4.2pt" stretchy="false">)</mo>
     </mrow>
     <mi>g</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>œë</mi>
      <mo rspace="4.2pt" stretchy="false">)</mo>
     </mrow>
     <mi>d</mi>
     <mi>œë</mi>
    </mrow>
   </mfrac>
   <mo>=</mo>
   <mpadded width="+5pt">
    <munder accentunder="true">
     <mrow>
      <mpadded width="+1.7pt">
       <mi>arg</mi>
      </mpadded>
      <mi>max</mi>
     </mrow>
     <mo>ùúÉ</mo>
    </munder>
   </mpadded>
   <mi>f</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>x</mi>
    <mo stretchy="false">|</mo>
    <mi>Œ∏</mi>
    <mo rspace="4.2pt" stretchy="false">)</mo>
   </mrow>
   <mi>g</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>Œ∏</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo rspace="0.8pt">.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <ci>normal-^</ci>
      <ci>Œ∏</ci>
     </apply>
     <ci>MAP</ci>
    </apply>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">x</csymbol>
     <ci>normal-)</ci>
    </cerror>
    <eq></eq>
    <apply>
     <ci>Œ∏</ci>
     <apply>
      <times></times>
      <ci>arg</ci>
      <ci>max</ci>
     </apply>
    </apply>
    <apply>
     <divide></divide>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <csymbol cd="unknown">f</csymbol>
      <cerror>
       <csymbol cd="ambiguous">fragments</csymbol>
       <ci>normal-(</ci>
       <csymbol cd="unknown">x</csymbol>
       <ci>normal-|</ci>
       <csymbol cd="unknown">Œ∏</csymbol>
       <ci>normal-)</ci>
      </cerror>
      <csymbol cd="unknown">g</csymbol>
      <cerror>
       <csymbol cd="ambiguous">fragments</csymbol>
       <ci>normal-(</ci>
       <csymbol cd="unknown">Œ∏</csymbol>
       <ci>normal-)</ci>
      </cerror>
     </cerror>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <int></int>
       <ci>œë</ci>
      </apply>
      <csymbol cd="unknown">f</csymbol>
      <cerror>
       <csymbol cd="ambiguous">fragments</csymbol>
       <ci>normal-(</ci>
       <csymbol cd="unknown">x</csymbol>
       <ci>normal-|</ci>
       <csymbol cd="unknown">œë</csymbol>
       <ci>normal-)</ci>
      </cerror>
      <csymbol cd="unknown">g</csymbol>
      <cerror>
       <csymbol cd="ambiguous">fragments</csymbol>
       <ci>normal-(</ci>
       <csymbol cd="unknown">œë</csymbol>
       <ci>normal-)</ci>
      </cerror>
      <csymbol cd="unknown">d</csymbol>
      <csymbol cd="unknown">œë</csymbol>
     </cerror>
    </apply>
    <eq></eq>
    <apply>
     <ci>Œ∏</ci>
     <apply>
      <times></times>
      <ci>arg</ci>
      <ci>max</ci>
     </apply>
    </apply>
    <csymbol cd="unknown">f</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">x</csymbol>
     <ci>normal-|</ci>
     <csymbol cd="unknown">Œ∏</csymbol>
     <ci>normal-)</ci>
    </cerror>
    <csymbol cd="unknown">g</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">Œ∏</csymbol>
     <ci>normal-)</ci>
    </cerror>
    <ci>normal-.</ci>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \hat{\theta}_{\mathrm{MAP}}(x)=\underset{\theta}{\operatorname{arg\,max}}\ %
\frac{f(x|\theta)\,g(\theta)}{\displaystyle\int_{\vartheta}f(x|\vartheta)\,g(%
\vartheta)\,d\vartheta}=\underset{\theta}{\operatorname{arg\,max}}\ f(x|\theta%
)\,g(\theta).\!
  </annotation>
 </semantics>
</math>

</p>

<p>The denominator of the posterior distribution (so-called <a href="Partition_function_(mathematics)" title="wikilink">partition function</a>) does not depend on 

<math display="inline" id="Maximum_a_posteriori_estimation:21">
 <semantics>
  <mi>Œ∏</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>Œ∏</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \theta
  </annotation>
 </semantics>
</math>

 and therefore plays no role in the optimization. Observe that the MAP estimate of 

<math display="inline" id="Maximum_a_posteriori_estimation:22">
 <semantics>
  <mi>Œ∏</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>Œ∏</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \theta
  </annotation>
 </semantics>
</math>

 coincides with the ML estimate when the prior 

<math display="inline" id="Maximum_a_posteriori_estimation:23">
 <semantics>
  <mi>g</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>g</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   g
  </annotation>
 </semantics>
</math>

 is uniform (that is, a <a href="constant_function" title="wikilink">constant function</a>). And when the loss function is of the form:</p>

<p>

<math display="inline" id="Maximum_a_posteriori_estimation:24">
 <semantics>
  <mi>Œ∏</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>Œ∏</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \theta
  </annotation>
 </semantics>
</math>

 goes to 0, the sequence of <a href="Bayes_estimator" title="wikilink">Bayes estimators</a> approaches the MAP estimator, provided that the distribution of 

<math display="inline" id="Maximum_a_posteriori_estimation:25">
 <semantics>
  <mi>Œ∏</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>Œ∏</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \theta
  </annotation>
 </semantics>
</math>

 is unimodal. But generally a MAP estimator is not a <a href="Bayes_estimator" title="wikilink">Bayes estimator</a> unless 

<math display="inline" id="Maximum_a_posteriori_estimation:26">
 <semantics>
  <mi>x</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>x</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x
  </annotation>
 </semantics>
</math>

 is <a href="discrete_random_variable" title="wikilink">discrete</a>.</p>
<h2 id="computation">Computation</h2>

<p>MAP estimates can be computed in several ways:</p>
<ol>
<li>Analytically, when the mode(s) of the posterior distribution can be given in <a href="closed-form_solution" title="wikilink">closed form</a>. This is the case when <a href="conjugate_prior" title="wikilink">conjugate priors</a> are used.</li>
<li>Via <a href="numerical_analysis" title="wikilink">numerical</a> <a href="optimization_(mathematics)" title="wikilink">optimization</a> such as the <a href="conjugate_gradient_method" title="wikilink">conjugate gradient method</a> or <a href="Newton's_method_in_optimization" title="wikilink">Newton's method</a>. This usually requires first or second <a href="derivative" title="wikilink">derivatives</a>, which have to be evaluated analytically or numerically.</li>
<li>Via a modification of an <a href="expectation-maximization_algorithm" title="wikilink">expectation-maximization algorithm</a>. This does not require derivatives of the posterior density.</li>
<li>Via a <a href="Monte_Carlo_method" title="wikilink">Monte Carlo method</a> using <a href="simulated_annealing" title="wikilink">simulated annealing</a></li>
</ol>
<h2 id="criticism">Criticism</h2>

<p>While MAP estimation is a limit of Bayes estimators (under the 0-1 loss function), it is not very representative of Bayesian methods in general. This is because MAP estimates are point estimates, whereas Bayesian methods are characterized by the use of distributions to summarize data and draw inferences: thus, Bayesian methods tend to report the posterior <a class="uri" href="mean" title="wikilink">mean</a> or <a class="uri" href="median" title="wikilink">median</a> instead, together with <a href="credible_interval" title="wikilink">credible intervals</a>. This is both because these estimators are optimal under squared-error and linear-error loss respectively - which are more representative of typical <a href="loss_function" title="wikilink">loss functions</a> - and because the posterior distribution may not have a simple analytic form: in this case, the distribution can be simulated using <a href="Markov_chain_Monte_Carlo" title="wikilink">Markov chain Monte Carlo</a> techniques, while optimization to find its mode(s) may be difficult or impossible.</p>
<figure><b>(Figure)</b>
<figcaption>An example of a density of a <a href="bimodal_distribution" title="wikilink">bimodal distribution</a> in which the highest mode is uncharacteristic of the majority of the distribution</figcaption>
</figure>

<p>In many types of models, such as <a href="mixture_model" title="wikilink">mixture models</a>, the posterior may be <a href="Bimodal_distribution" title="wikilink">multi-modal</a>. In such a case, the usual recommendation is that one should choose the highest mode: this is not always feasible (<a href="global_optimization" title="wikilink">global optimization</a> is a difficult problem), nor in some cases even possible (such as when <a href="identifiability_condition" title="wikilink">identifiability</a> issues arise). Furthermore, the highest mode may be uncharacteristic of the majority of the posterior.</p>

<p>Finally, unlike ML estimators, the MAP estimate is not <a href="Parametrization#Parametrization_invariance" title="wikilink">invariant under reparameterization</a>. Switching from one parameterization to another involves introducing a Jacobian that impacts on the location of the maximum.<a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a></p>

<p>As an example of the difference between Bayes estimators mentioned above (mean and median estimators) and using an MAP estimate, consider the case where there is a need to classify inputs 

<math display="inline" id="Maximum_a_posteriori_estimation:27">
 <semantics>
  <msub>
   <mi>h</mi>
   <mn>1</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>h</ci>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   h_{1}
  </annotation>
 </semantics>
</math>

 as either positive or negative (for example, loans as risky or safe). Suppose there are just three possible hypotheses about the correct method of classification 

<math display="inline" id="Maximum_a_posteriori_estimation:28">
 <semantics>
  <msub>
   <mi>h</mi>
   <mn>2</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>h</ci>
    <cn type="integer">2</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   h_{2}
  </annotation>
 </semantics>
</math>

, 

<math display="inline" id="Maximum_a_posteriori_estimation:29">
 <semantics>
  <msub>
   <mi>h</mi>
   <mn>3</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>h</ci>
    <cn type="integer">3</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   h_{3}
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Maximum_a_posteriori_estimation:30">
 <semantics>
  <mi>x</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>x</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x
  </annotation>
 </semantics>
</math>

 with posteriors 0.4, 0.3 and 0.3 respectively. Suppose given a new instance, 

<math display="inline" id="Maximum_a_posteriori_estimation:31">
 <semantics>
  <msub>
   <mi>h</mi>
   <mn>1</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>h</ci>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   h_{1}
  </annotation>
 </semantics>
</math>

, 

<math display="inline" id="Maximum_a_posteriori_estimation:32">
 <semantics>
  <msub>
   <mi>h</mi>
   <mn>1</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>h</ci>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   h_{1}
  </annotation>
 </semantics>
</math>

 classifies it as positive, whereas the other two classify it as negative. Using the MAP estimate for the correct classifier 

<math display="inline" id="Maximum_a_posteriori_estimation:33">
 <semantics>
  <mi>x</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>x</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x
  </annotation>
 </semantics>
</math>

, 

<math display="inline" id="Maximum_a_posteriori_estimation:34">
 <semantics>
  <mi>x</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>x</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x
  </annotation>
 </semantics>
</math>

 is classified as positive, whereas the Bayes estimators would average over all hypotheses and classify 

<math display="inline" id="Maximum_a_posteriori_estimation:35">
 <semantics>
  <mrow>
   <mo stretchy="false">(</mo>
   <msub>
    <mi>x</mi>
    <mn>1</mn>
   </msub>
   <mo>,</mo>
   <mi mathvariant="normal">‚Ä¶</mi>
   <mo>,</mo>
   <msub>
    <mi>x</mi>
    <mi>n</mi>
   </msub>
   <mo stretchy="false">)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <vector>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>x</ci>
     <cn type="integer">1</cn>
    </apply>
    <ci>normal-‚Ä¶</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>x</ci>
     <ci>n</ci>
    </apply>
   </vector>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (x_{1},\dots,x_{n})
  </annotation>
 </semantics>
</math>

 as negative.</p>
<h2 id="example">Example</h2>

<p>Suppose that we are given a sequence 

<math display="inline" id="Maximum_a_posteriori_estimation:36">
 <semantics>
  <mrow>
   <mi>N</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>Œº</mi>
    <mo>,</mo>
    <msubsup>
     <mi>œÉ</mi>
     <mi>v</mi>
     <mn>2</mn>
    </msubsup>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>N</ci>
    <interval closure="open">
     <ci>Œº</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>œÉ</ci>
       <ci>v</ci>
      </apply>
      <cn type="integer">2</cn>
     </apply>
    </interval>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   N(\mu,\sigma_{v}^{2})
  </annotation>
 </semantics>
</math>

 of <a class="uri" href="IID" title="wikilink">IID</a> 

<math display="inline" id="Maximum_a_posteriori_estimation:37">
 <semantics>
  <mi>Œº</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>Œº</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mu
  </annotation>
 </semantics>
</math>

 <a href="random_variable" title="wikilink">random variables</a> and an a priori distribution of 

<math display="inline" id="Maximum_a_posteriori_estimation:38">
 <semantics>
  <mrow>
   <mi>N</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>Œº</mi>
     <mn>0</mn>
    </msub>
    <mo>,</mo>
    <msubsup>
     <mi>œÉ</mi>
     <mi>m</mi>
     <mn>2</mn>
    </msubsup>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>N</ci>
    <interval closure="open">
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>Œº</ci>
      <cn type="integer">0</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>œÉ</ci>
       <ci>m</ci>
      </apply>
      <cn type="integer">2</cn>
     </apply>
    </interval>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   N(\mu_{0},\sigma_{m}^{2})
  </annotation>
 </semantics>
</math>

 is given by 

<math display="inline" id="Maximum_a_posteriori_estimation:39">
 <semantics>
  <mi>Œº</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>Œº</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mu
  </annotation>
 </semantics>
</math>

. We wish to find the MAP estimate of 

<math display="block" id="Maximum_a_posteriori_estimation:40">
 <semantics>
  <mrow>
   <mi>f</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>Œº</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mi>f</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>x</mi>
    <mo stretchy="false">|</mo>
    <mi>Œº</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>=</mo>
   <mi>œÄ</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>Œº</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mi>L</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>Œº</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>=</mo>
   <mfrac>
    <mn>1</mn>
    <mrow>
     <msqrt>
      <mrow>
       <mn>2</mn>
       <mi>œÄ</mi>
      </mrow>
     </msqrt>
     <msub>
      <mi>œÉ</mi>
      <mi>m</mi>
     </msub>
    </mrow>
   </mfrac>
   <mi>exp</mi>
   <mrow>
    <mo>(</mo>
    <mo>-</mo>
    <mfrac>
     <mn>1</mn>
     <mn>2</mn>
    </mfrac>
    <msup>
     <mrow>
      <mo>(</mo>
      <mfrac>
       <mrow>
        <mi>Œº</mi>
        <mo>-</mo>
        <msub>
         <mi>Œº</mi>
         <mn>0</mn>
        </msub>
       </mrow>
       <msub>
        <mi>œÉ</mi>
        <mi>m</mi>
       </msub>
      </mfrac>
      <mo>)</mo>
     </mrow>
     <mn>2</mn>
    </msup>
    <mo>)</mo>
   </mrow>
   <munderover>
    <mo largeop="true" movablelimits="false" symmetric="true">‚àè</mo>
    <mrow>
     <mi>j</mi>
     <mo>=</mo>
     <mn>1</mn>
    </mrow>
    <mi>n</mi>
   </munderover>
   <mfrac>
    <mn>1</mn>
    <mrow>
     <msqrt>
      <mrow>
       <mn>2</mn>
       <mi>œÄ</mi>
      </mrow>
     </msqrt>
     <msub>
      <mi>œÉ</mi>
      <mi>v</mi>
     </msub>
    </mrow>
   </mfrac>
   <mi>exp</mi>
   <mrow>
    <mo>(</mo>
    <mo>-</mo>
    <mfrac>
     <mn>1</mn>
     <mn>2</mn>
    </mfrac>
    <msup>
     <mrow>
      <mo>(</mo>
      <mfrac>
       <mrow>
        <msub>
         <mi>x</mi>
         <mi>j</mi>
        </msub>
        <mo>-</mo>
        <mi>Œº</mi>
       </mrow>
       <msub>
        <mi>œÉ</mi>
        <mi>v</mi>
       </msub>
      </mfrac>
      <mo>)</mo>
     </mrow>
     <mn>2</mn>
    </msup>
    <mo>)</mo>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">f</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">Œº</csymbol>
     <ci>normal-)</ci>
    </cerror>
    <csymbol cd="unknown">f</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">x</csymbol>
     <ci>normal-|</ci>
     <csymbol cd="unknown">Œº</csymbol>
     <ci>normal-)</ci>
    </cerror>
    <eq></eq>
    <csymbol cd="unknown">œÄ</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">Œº</csymbol>
     <ci>normal-)</ci>
    </cerror>
    <csymbol cd="unknown">L</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">Œº</csymbol>
     <ci>normal-)</ci>
    </cerror>
    <eq></eq>
    <apply>
     <divide></divide>
     <cn type="integer">1</cn>
     <apply>
      <times></times>
      <apply>
       <root></root>
       <apply>
        <times></times>
        <cn type="integer">2</cn>
        <ci>œÄ</ci>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>œÉ</ci>
       <ci>m</ci>
      </apply>
     </apply>
    </apply>
    <exp></exp>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <minus></minus>
     <apply>
      <divide></divide>
      <cn type="integer">1</cn>
      <cn type="integer">2</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <cerror>
       <csymbol cd="ambiguous">fragments</csymbol>
       <ci>normal-(</ci>
       <apply>
        <divide></divide>
        <apply>
         <minus></minus>
         <ci>Œº</ci>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>Œº</ci>
          <cn type="integer">0</cn>
         </apply>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>œÉ</ci>
         <ci>m</ci>
        </apply>
       </apply>
       <ci>normal-)</ci>
      </cerror>
      <cn type="integer">2</cn>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <csymbol cd="latexml">product</csymbol>
      <apply>
       <eq></eq>
       <ci>j</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <ci>n</ci>
    </apply>
    <apply>
     <divide></divide>
     <cn type="integer">1</cn>
     <apply>
      <times></times>
      <apply>
       <root></root>
       <apply>
        <times></times>
        <cn type="integer">2</cn>
        <ci>œÄ</ci>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>œÉ</ci>
       <ci>v</ci>
      </apply>
     </apply>
    </apply>
    <exp></exp>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <minus></minus>
     <apply>
      <divide></divide>
      <cn type="integer">1</cn>
      <cn type="integer">2</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <cerror>
       <csymbol cd="ambiguous">fragments</csymbol>
       <ci>normal-(</ci>
       <apply>
        <divide></divide>
        <apply>
         <minus></minus>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>x</ci>
          <ci>j</ci>
         </apply>
         <ci>Œº</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>œÉ</ci>
         <ci>v</ci>
        </apply>
       </apply>
       <ci>normal-)</ci>
      </cerror>
      <cn type="integer">2</cn>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <ci>normal-,</ci>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f(\mu)f(x|\mu)=\pi(\mu)L(\mu)=\frac{1}{\sqrt{2\pi}\sigma_{m}}\exp\left(-\frac{%
1}{2}\left(\frac{\mu-\mu_{0}}{\sigma_{m}}\right)^{2}\right)\prod_{j=1}^{n}%
\frac{1}{\sqrt{2\pi}\sigma_{v}}\exp\left(-\frac{1}{2}\left(\frac{x_{j}-\mu}{%
\sigma_{v}}\right)^{2}\right),
  </annotation>
 </semantics>
</math>

.</p>

<p>The function to be maximized is then given by</p>

<p>

<math display="inline" id="Maximum_a_posteriori_estimation:41">
 <semantics>
  <mi>Œº</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>Œº</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mu
  </annotation>
 </semantics>
</math>

</p>

<p>which is equivalent to minimizing the following function of 

<math display="block" id="Maximum_a_posteriori_estimation:42">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <munderover>
      <mo largeop="true" movablelimits="false" symmetric="true">‚àë</mo>
      <mrow>
       <mi>j</mi>
       <mo>=</mo>
       <mn>1</mn>
      </mrow>
      <mi>n</mi>
     </munderover>
     <msup>
      <mrow>
       <mo>(</mo>
       <mfrac>
        <mrow>
         <msub>
          <mi>x</mi>
          <mi>j</mi>
         </msub>
         <mo>-</mo>
         <mi>Œº</mi>
        </mrow>
        <msub>
         <mi>œÉ</mi>
         <mi>v</mi>
        </msub>
       </mfrac>
       <mo>)</mo>
      </mrow>
      <mn>2</mn>
     </msup>
    </mrow>
    <mo>+</mo>
    <msup>
     <mrow>
      <mo>(</mo>
      <mfrac>
       <mrow>
        <mi>Œº</mi>
        <mo>-</mo>
        <msub>
         <mi>Œº</mi>
         <mn>0</mn>
        </msub>
       </mrow>
       <msub>
        <mi>œÉ</mi>
        <mi>m</mi>
       </msub>
      </mfrac>
      <mo>)</mo>
     </mrow>
     <mn>2</mn>
    </msup>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <plus></plus>
    <apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <apply>
        <eq></eq>
        <ci>j</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <ci>n</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <divide></divide>
       <apply>
        <minus></minus>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>x</ci>
         <ci>j</ci>
        </apply>
        <ci>Œº</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>œÉ</ci>
        <ci>v</ci>
       </apply>
      </apply>
      <cn type="integer">2</cn>
     </apply>
    </apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <divide></divide>
      <apply>
       <minus></minus>
       <ci>Œº</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>Œº</ci>
        <cn type="integer">0</cn>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>œÉ</ci>
       <ci>m</ci>
      </apply>
     </apply>
     <cn type="integer">2</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \sum_{j=1}^{n}\left(\frac{x_{j}-\mu}{\sigma_{v}}\right)^{2}+\left(\frac{\mu-%
\mu_{0}}{\sigma_{m}}\right)^{2}.
  </annotation>
 </semantics>
</math>

:</p>

<p>

<math display="block" id="Maximum_a_posteriori_estimation:43">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mover accent="true">
      <mi>Œº</mi>
      <mo stretchy="false">^</mo>
     </mover>
     <mrow>
      <mi>M</mi>
      <mi>A</mi>
      <mi>P</mi>
     </mrow>
    </msub>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mfrac>
       <mrow>
        <mi>n</mi>
        <msubsup>
         <mi>œÉ</mi>
         <mi>m</mi>
         <mn>2</mn>
        </msubsup>
       </mrow>
       <mrow>
        <mrow>
         <mi>n</mi>
         <msubsup>
          <mi>œÉ</mi>
          <mi>m</mi>
          <mn>2</mn>
         </msubsup>
        </mrow>
        <mo>+</mo>
        <msubsup>
         <mi>œÉ</mi>
         <mi>v</mi>
         <mn>2</mn>
        </msubsup>
       </mrow>
      </mfrac>
      <mrow>
       <mo>(</mo>
       <mrow>
        <mfrac>
         <mn>1</mn>
         <mi>n</mi>
        </mfrac>
        <mrow>
         <munderover>
          <mo largeop="true" movablelimits="false" symmetric="true">‚àë</mo>
          <mrow>
           <mi>j</mi>
           <mo>=</mo>
           <mn>1</mn>
          </mrow>
          <mi>n</mi>
         </munderover>
         <msub>
          <mi>x</mi>
          <mi>j</mi>
         </msub>
        </mrow>
       </mrow>
       <mo>)</mo>
      </mrow>
     </mrow>
     <mo>+</mo>
     <mrow>
      <mfrac>
       <msubsup>
        <mi>œÉ</mi>
        <mi>v</mi>
        <mn>2</mn>
       </msubsup>
       <mrow>
        <mrow>
         <mi>n</mi>
         <msubsup>
          <mi>œÉ</mi>
          <mi>m</mi>
          <mn>2</mn>
         </msubsup>
        </mrow>
        <mo>+</mo>
        <msubsup>
         <mi>œÉ</mi>
         <mi>v</mi>
         <mn>2</mn>
        </msubsup>
       </mrow>
      </mfrac>
      <msub>
       <mi>Œº</mi>
       <mn>0</mn>
      </msub>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <ci>normal-^</ci>
      <ci>Œº</ci>
     </apply>
     <apply>
      <times></times>
      <ci>M</ci>
      <ci>A</ci>
      <ci>P</ci>
     </apply>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <apply>
        <times></times>
        <ci>n</ci>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>œÉ</ci>
          <ci>m</ci>
         </apply>
         <cn type="integer">2</cn>
        </apply>
       </apply>
       <apply>
        <plus></plus>
        <apply>
         <times></times>
         <ci>n</ci>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>œÉ</ci>
           <ci>m</ci>
          </apply>
          <cn type="integer">2</cn>
         </apply>
        </apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>œÉ</ci>
          <ci>v</ci>
         </apply>
         <cn type="integer">2</cn>
        </apply>
       </apply>
      </apply>
      <apply>
       <times></times>
       <apply>
        <divide></divide>
        <cn type="integer">1</cn>
        <ci>n</ci>
       </apply>
       <apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <sum></sum>
          <apply>
           <eq></eq>
           <ci>j</ci>
           <cn type="integer">1</cn>
          </apply>
         </apply>
         <ci>n</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>x</ci>
         <ci>j</ci>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>œÉ</ci>
         <ci>v</ci>
        </apply>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <plus></plus>
        <apply>
         <times></times>
         <ci>n</ci>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>œÉ</ci>
           <ci>m</ci>
          </apply>
          <cn type="integer">2</cn>
         </apply>
        </apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>œÉ</ci>
          <ci>v</ci>
         </apply>
         <cn type="integer">2</cn>
        </apply>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>Œº</ci>
       <cn type="integer">0</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \hat{\mu}_{MAP}=\frac{n\sigma_{m}^{2}}{n\sigma_{m}^{2}+\sigma_{v}^{2}}\left(%
\frac{1}{n}\sum_{j=1}^{n}x_{j}\right)+\frac{\sigma_{v}^{2}}{n\sigma_{m}^{2}+%
\sigma_{v}^{2}}\mu_{0}.
  </annotation>
 </semantics>
</math>

</p>

<p>Thus, we see that the <strong>MAP estimator</strong> for Œº is given by</p>

<p>

<math display="inline" id="Maximum_a_posteriori_estimation:44">
 <semantics>
  <mrow>
   <msub>
    <mi>œÉ</mi>
    <mi>m</mi>
   </msub>
   <mo>‚Üí</mo>
   <mi mathvariant="normal">‚àû</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-‚Üí</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>œÉ</ci>
     <ci>m</ci>
    </apply>
    <infinity></infinity>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \sigma_{m}\to\infty
  </annotation>
 </semantics>
</math>

</p>

<p>which turns out to be a linear interpolation between the prior mean and the sample mean weighted by their respective covariances.</p>

<p>The case of 

<math display="inline" id="Maximum_a_posteriori_estimation:45">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mover accent="true">
      <mi>Œº</mi>
      <mo stretchy="false">^</mo>
     </mover>
     <mrow>
      <mi>M</mi>
      <mi>A</mi>
      <mi>P</mi>
     </mrow>
    </msub>
    <mo>‚Üí</mo>
    <msub>
     <mover accent="true">
      <mi>Œº</mi>
      <mo stretchy="false">^</mo>
     </mover>
     <mrow>
      <mi>M</mi>
      <mi>L</mi>
     </mrow>
    </msub>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-‚Üí</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <ci>normal-^</ci>
      <ci>Œº</ci>
     </apply>
     <apply>
      <times></times>
      <ci>M</ci>
      <ci>A</ci>
      <ci>P</ci>
     </apply>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <ci>normal-^</ci>
      <ci>Œº</ci>
     </apply>
     <apply>
      <times></times>
      <ci>M</ci>
      <ci>L</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \hat{\mu}_{MAP}\to\hat{\mu}_{ML}.
  </annotation>
 </semantics>
</math>

 is called a non-informative prior and leads to an ill-defined a priori probability distribution; in this case <span class="LaTeX">$\hat{\mu}_{MAP} \to \hat{\mu}_{ML}.$</span> </p>
<h2 id="references">References</h2>
<ul>
<li>M. DeGroot, <em>Optimal Statistical Decisions</em>, McGraw-Hill, (1970).</li>
<li>Harold W. Sorenson, (1980) "Parameter Estimation: Principles and Problems", Marcel Dekker.</li>
</ul>

<p>"</p>

<p><a href="Category:Estimation_theory" title="wikilink">Category:Estimation theory</a> <a href="Category:Bayesian_inference" title="wikilink">Category:Bayesian inference</a> <a href="Category:Statistical_theory" title="wikilink">Category:Statistical theory</a> <a href="Category:Logic_and_statistics" title="wikilink">Category:Logic and statistics</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1"><a href="#fnref1">‚Ü©</a></li>
</ol>
</section>
</body>
</html>

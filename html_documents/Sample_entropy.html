<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="136">Sample entropy</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Sample entropy</h1>
<hr/>

<p><strong>Sample entropy</strong> (SampEn) is a modification of <a href="approximate_entropy" title="wikilink">approximate entropy</a> (ApEn), used extensively for assessing the complexity of a physiological time-series signal, thereby diagnosing diseased state.<a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a> Unlike ApEn, SampEn shows good traits such as data length independence and trouble-free implementation. Also, there is a small computational difference: In ApEn, the comparison between the template vector (see below) and the rest of the vectors also includes comparison with itself. This guarantees that probabilities 

<math display="inline" id="Sample_entropy:0">
 <semantics>
  <mrow>
   <msubsup>
    <mi>C</mi>
    <mi>i</mi>
    <mrow>
     <mi mathvariant="normal">′</mi>
     <mi>m</mi>
    </mrow>
   </msubsup>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>r</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>C</ci>
      <ci>i</ci>
     </apply>
     <list>
      <ci>normal-′</ci>
      <ci>m</ci>
     </list>
    </apply>
    <ci>r</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   C_{i}^{\prime m}(r)
  </annotation>
 </semantics>
</math>

 are never zero. Consequently, it is always possible to take a logarithm of probabilities. Because template comparisons with itself lower ApEn values, the signals are interpreted to be more regular than they actually are. These self-matches are not included in SampEn.</p>

<p>There is a multiscale version of SampEn as well, suggested by Costa and others.<a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a></p>
<h2 id="definition">Definition</h2>

<p>Like <a href="approximate_entropy" title="wikilink">approximate entropy</a> (ApEn), <strong>Sample entropy</strong> (<strong>SampEn</strong>) is a measure of <a class="uri" href="complexity" title="wikilink">complexity</a> <a href="http://ajpheart.physiology.org/content/278/6/H2039.full">1</a>. But it does not include self-similar patterns as ApEn does. For a given <a class="uri" href="embedding" title="wikilink">embedding</a> <a class="uri" href="dimension" title="wikilink">dimension</a> 

<math display="inline" id="Sample_entropy:1">
 <semantics>
  <mi>m</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>m</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   m
  </annotation>
 </semantics>
</math>

, <a href="tolerance_interval" title="wikilink">tolerance</a> 

<math display="inline" id="Sample_entropy:2">
 <semantics>
  <mi>r</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>r</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   r
  </annotation>
 </semantics>
</math>

 and number of <a href="data_points" title="wikilink">data points</a> 

<math display="inline" id="Sample_entropy:3">
 <semantics>
  <mi>N</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>N</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   N
  </annotation>
 </semantics>
</math>

, SampEn is the negative <a class="uri" href="logarithm" title="wikilink">logarithm</a> of the <a class="uri" href="probability" title="wikilink">probability</a> that if two sets of <a class="uri" href="simultaneous" title="wikilink">simultaneous</a> data points of length 

<math display="inline" id="Sample_entropy:4">
 <semantics>
  <mi>m</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>m</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   m
  </annotation>
 </semantics>
</math>

 have distance 

<math display="inline" id="Sample_entropy:5">
 <semantics>
  <mrow>
   <mi></mi>
   <mo><</mo>
   <mi>r</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <lt></lt>
    <csymbol cd="latexml">absent</csymbol>
    <ci>r</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   <r
  </annotation>
 </semantics>
</math>

 then two sets of simultaneous data points of length 

<math display="inline" id="Sample_entropy:6">
 <semantics>
  <mrow>
   <mi>m</mi>
   <mo>+</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <plus></plus>
    <ci>m</ci>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   m+1
  </annotation>
 </semantics>
</math>

 also have distance 

<math display="inline" id="Sample_entropy:7">
 <semantics>
  <mrow>
   <mi></mi>
   <mo><</mo>
   <mi>r</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <lt></lt>
    <csymbol cd="latexml">absent</csymbol>
    <ci>r</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   <r
  </annotation>
 </semantics>
</math>

. And we represent it by 

<math display="inline" id="Sample_entropy:8">
 <semantics>
  <mrow>
   <mi>S</mi>
   <mi>a</mi>
   <mi>m</mi>
   <mi>p</mi>
   <mi>E</mi>
   <mi>n</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>m</mi>
    <mo>,</mo>
    <mi>r</mi>
    <mo>,</mo>
    <mi>N</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>S</ci>
    <ci>a</ci>
    <ci>m</ci>
    <ci>p</ci>
    <ci>E</ci>
    <ci>n</ci>
    <vector>
     <ci>m</ci>
     <ci>r</ci>
     <ci>N</ci>
    </vector>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   SampEn(m,r,N)
  </annotation>
 </semantics>
</math>

 (or by 

<math display="inline" id="Sample_entropy:9">
 <semantics>
  <mrow>
   <mi>S</mi>
   <mi>a</mi>
   <mi>m</mi>
   <mi>p</mi>
   <mi>E</mi>
   <mi>n</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>m</mi>
    <mo>,</mo>
    <mi>r</mi>
    <mo>,</mo>
    <mi>τ</mi>
    <mo>,</mo>
    <mi>N</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>S</ci>
    <ci>a</ci>
    <ci>m</ci>
    <ci>p</ci>
    <ci>E</ci>
    <ci>n</ci>
    <vector>
     <ci>m</ci>
     <ci>r</ci>
     <ci>τ</ci>
     <ci>N</ci>
    </vector>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   SampEn(m,r,\tau,N)
  </annotation>
 </semantics>
</math>

 including sampling time 

<math display="inline" id="Sample_entropy:10">
 <semantics>
  <mi>τ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>τ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \tau
  </annotation>
 </semantics>
</math>

).</p>

<p>Now assume we have a <a class="uri" href="time-series" title="wikilink">time-series</a> data set of length 

<math display="inline" id="Sample_entropy:11">
 <semantics>
  <mrow>
   <mi>N</mi>
   <mo>=</mo>
   <mrow>
    <mo stretchy="false">{</mo>
    <msub>
     <mi>x</mi>
     <mn>1</mn>
    </msub>
    <mo>,</mo>
    <msub>
     <mi>x</mi>
     <mn>2</mn>
    </msub>
    <mo>,</mo>
    <msub>
     <mi>x</mi>
     <mn>3</mn>
    </msub>
    <mo>,</mo>
    <mi mathvariant="normal">…</mi>
    <mo>,</mo>
    <msub>
     <mi>x</mi>
     <mi>N</mi>
    </msub>
    <mo stretchy="false">}</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>N</ci>
    <set>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <cn type="integer">1</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <cn type="integer">2</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <cn type="integer">3</cn>
     </apply>
     <ci>normal-…</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <ci>N</ci>
     </apply>
    </set>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   N={\{x_{1},x_{2},x_{3},...,x_{N}\}}
  </annotation>
 </semantics>
</math>

 with a constant time interval 

<math display="inline" id="Sample_entropy:12">
 <semantics>
  <mi>τ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>τ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \tau
  </annotation>
 </semantics>
</math>

. We define a template <a href="vector_(mathematics_and_physics)" title="wikilink">vector</a> of length 

<math display="inline" id="Sample_entropy:13">
 <semantics>
  <mi>m</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>m</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   m
  </annotation>
 </semantics>
</math>

, such that 

<math display="inline" id="Sample_entropy:14">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>X</mi>
     <mi>m</mi>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>i</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mo stretchy="false">{</mo>
    <msub>
     <mi>x</mi>
     <mi>i</mi>
    </msub>
    <mo>,</mo>
    <msub>
     <mi>x</mi>
     <mrow>
      <mi>i</mi>
      <mo>+</mo>
      <mn>1</mn>
     </mrow>
    </msub>
    <mo>,</mo>
    <msub>
     <mi>x</mi>
     <mrow>
      <mi>i</mi>
      <mo>+</mo>
      <mn>2</mn>
     </mrow>
    </msub>
    <mo>,</mo>
    <mi mathvariant="normal">…</mi>
    <mo>,</mo>
    <msub>
     <mi>x</mi>
     <mrow>
      <mrow>
       <mi>i</mi>
       <mo>+</mo>
       <mi>m</mi>
      </mrow>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </msub>
    <mo stretchy="false">}</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>X</ci>
      <ci>m</ci>
     </apply>
     <ci>i</ci>
    </apply>
    <set>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <ci>i</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <apply>
       <plus></plus>
       <ci>i</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <apply>
       <plus></plus>
       <ci>i</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
     <ci>normal-…</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <apply>
       <minus></minus>
       <apply>
        <plus></plus>
        <ci>i</ci>
        <ci>m</ci>
       </apply>
       <cn type="integer">1</cn>
      </apply>
     </apply>
    </set>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   X_{m}(i)={\{x_{i},x_{i+1},x_{i+2},...,x_{i+m-1}\}}
  </annotation>
 </semantics>
</math>

 and the distance function 

<math display="inline" id="Sample_entropy:15">
 <semantics>
  <mrow>
   <mi>d</mi>
   <mrow>
    <mo stretchy="false">[</mo>
    <mrow>
     <msub>
      <mi>X</mi>
      <mi>m</mi>
     </msub>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>i</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>,</mo>
    <mrow>
     <msub>
      <mi>X</mi>
      <mi>m</mi>
     </msub>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>j</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo stretchy="false">]</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>d</ci>
    <interval closure="closed">
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>X</ci>
       <ci>m</ci>
      </apply>
      <ci>i</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>X</ci>
       <ci>m</ci>
      </apply>
      <ci>j</ci>
     </apply>
    </interval>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   d[X_{m}(i),X_{m}(j)]
  </annotation>
 </semantics>
</math>

 (i≠j) is to be the <a href="Chebyshev_distance" title="wikilink">Chebyshev distance</a> (but it could be any distance function, including <a href="Euclidean_distance" title="wikilink">Euclidean</a> distance). We count the number of vector pairs in template vectors of length 

<math display="inline" id="Sample_entropy:16">
 <semantics>
  <mi>m</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>m</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   m
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Sample_entropy:17">
 <semantics>
  <mrow>
   <mi>m</mi>
   <mo>+</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <plus></plus>
    <ci>m</ci>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   m+1
  </annotation>
 </semantics>
</math>

 having 

<math display="inline" id="Sample_entropy:18">
 <semantics>
  <mrow>
   <mrow>
    <mi>d</mi>
    <mrow>
     <mo stretchy="false">[</mo>
     <mrow>
      <msub>
       <mi>X</mi>
       <mi>m</mi>
      </msub>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>i</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo>,</mo>
     <mrow>
      <msub>
       <mi>X</mi>
       <mi>m</mi>
      </msub>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>j</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo stretchy="false">]</mo>
    </mrow>
   </mrow>
   <mo><</mo>
   <mi>r</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <lt></lt>
    <apply>
     <times></times>
     <ci>d</ci>
     <interval closure="closed">
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>X</ci>
        <ci>m</ci>
       </apply>
       <ci>i</ci>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>X</ci>
        <ci>m</ci>
       </apply>
       <ci>j</ci>
      </apply>
     </interval>
    </apply>
    <ci>r</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   d[X_{m}(i),X_{m}(j)]<r
  </annotation>
 </semantics>
</math>

 and denote it by 

<math display="inline" id="Sample_entropy:19">
 <semantics>
  <mi>B</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>B</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   B
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Sample_entropy:20">
 <semantics>
  <mi>A</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>A</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A
  </annotation>
 </semantics>
</math>

 respectively. We define the sample entropy to be</p>

<p>

<math display="block" id="Sample_entropy:21">
 <semantics>
  <mrow>
   <mrow>
    <mi>S</mi>
    <mi>a</mi>
    <mi>m</mi>
    <mi>p</mi>
    <mi>E</mi>
    <mi>n</mi>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mo>-</mo>
    <mrow>
     <mi>log</mi>
     <mfrac>
      <mi>A</mi>
      <mi>B</mi>
     </mfrac>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>S</ci>
     <ci>a</ci>
     <ci>m</ci>
     <ci>p</ci>
     <ci>E</ci>
     <ci>n</ci>
    </apply>
    <apply>
     <minus></minus>
     <apply>
      <log></log>
      <apply>
       <divide></divide>
       <ci>A</ci>
       <ci>B</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   SampEn=-\log{A\over B}
  </annotation>
 </semantics>
</math>

</p>

<p>Where,</p>

<p>

<math display="inline" id="Sample_entropy:22">
 <semantics>
  <mi>A</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>A</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A
  </annotation>
 </semantics>
</math>

 = no of template vector pairs having 

<math display="inline" id="Sample_entropy:23">
 <semantics>
  <mrow>
   <mrow>
    <mi>d</mi>
    <mrow>
     <mo stretchy="false">[</mo>
     <mrow>
      <msub>
       <mi>X</mi>
       <mrow>
        <mi>m</mi>
        <mo>+</mo>
        <mn>1</mn>
       </mrow>
      </msub>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>i</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo>,</mo>
     <mrow>
      <msub>
       <mi>X</mi>
       <mrow>
        <mi>m</mi>
        <mo>+</mo>
        <mn>1</mn>
       </mrow>
      </msub>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>j</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo stretchy="false">]</mo>
    </mrow>
   </mrow>
   <mo><</mo>
   <mi>r</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <lt></lt>
    <apply>
     <times></times>
     <ci>d</ci>
     <interval closure="closed">
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>X</ci>
        <apply>
         <plus></plus>
         <ci>m</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <ci>i</ci>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>X</ci>
        <apply>
         <plus></plus>
         <ci>m</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <ci>j</ci>
      </apply>
     </interval>
    </apply>
    <ci>r</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   d[X_{m+1}(i),X_{m+1}(j)]<r
  </annotation>
 </semantics>
</math>

 of length 

<math display="inline" id="Sample_entropy:24">
 <semantics>
  <mrow>
   <mi>m</mi>
   <mo>+</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <plus></plus>
    <ci>m</ci>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   m+1
  </annotation>
 </semantics>
</math>

 

<math display="inline" id="Sample_entropy:25">
 <semantics>
  <mi>B</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>B</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   B
  </annotation>
 </semantics>
</math>

 = no of template vector pairs having 

<math display="inline" id="Sample_entropy:26">
 <semantics>
  <mrow>
   <mrow>
    <mi>d</mi>
    <mrow>
     <mo stretchy="false">[</mo>
     <mrow>
      <msub>
       <mi>X</mi>
       <mi>m</mi>
      </msub>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>i</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo>,</mo>
     <mrow>
      <msub>
       <mi>X</mi>
       <mi>m</mi>
      </msub>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>j</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo stretchy="false">]</mo>
    </mrow>
   </mrow>
   <mo><</mo>
   <mi>r</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <lt></lt>
    <apply>
     <times></times>
     <ci>d</ci>
     <interval closure="closed">
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>X</ci>
        <ci>m</ci>
       </apply>
       <ci>i</ci>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>X</ci>
        <ci>m</ci>
       </apply>
       <ci>j</ci>
      </apply>
     </interval>
    </apply>
    <ci>r</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   d[X_{m}(i),X_{m}(j)]<r
  </annotation>
 </semantics>
</math>

 of length 

<math display="inline" id="Sample_entropy:27">
 <semantics>
  <mi>m</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>m</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   m
  </annotation>
 </semantics>
</math>

</p>

<p>It is clear from the definition that 

<math display="inline" id="Sample_entropy:28">
 <semantics>
  <mi>A</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>A</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A
  </annotation>
 </semantics>
</math>

 will always have a value smaller or equal to 

<math display="inline" id="Sample_entropy:29">
 <semantics>
  <mi>B</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>B</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   B
  </annotation>
 </semantics>
</math>

. Therefore, 

<math display="inline" id="Sample_entropy:30">
 <semantics>
  <mrow>
   <mi>S</mi>
   <mi>a</mi>
   <mi>m</mi>
   <mi>p</mi>
   <mi>E</mi>
   <mi>n</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>m</mi>
    <mo>,</mo>
    <mi>r</mi>
    <mo>,</mo>
    <mi>τ</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>S</ci>
    <ci>a</ci>
    <ci>m</ci>
    <ci>p</ci>
    <ci>E</ci>
    <ci>n</ci>
    <vector>
     <ci>m</ci>
     <ci>r</ci>
     <ci>τ</ci>
    </vector>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   SampEn(m,r,\tau)
  </annotation>
 </semantics>
</math>

 will be always either be zero or positive value. A smaller value of 

<math display="inline" id="Sample_entropy:31">
 <semantics>
  <mrow>
   <mi>S</mi>
   <mi>a</mi>
   <mi>m</mi>
   <mi>p</mi>
   <mi>E</mi>
   <mi>n</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>S</ci>
    <ci>a</ci>
    <ci>m</ci>
    <ci>p</ci>
    <ci>E</ci>
    <ci>n</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   SampEn
  </annotation>
 </semantics>
</math>

 also indicates more self-similarity in data set or less noise.</p>

<p>Generally we take the value of 

<math display="inline" id="Sample_entropy:32">
 <semantics>
  <mi>m</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>m</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   m
  </annotation>
 </semantics>
</math>

 to be 

<math display="inline" id="Sample_entropy:33">
 <semantics>
  <mn>2</mn>
  <annotation-xml encoding="MathML-Content">
   <cn type="integer">2</cn>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   2
  </annotation>
 </semantics>
</math>

 and the value of 

<math display="inline" id="Sample_entropy:34">
 <semantics>
  <mi>r</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>r</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   r
  </annotation>
 </semantics>
</math>

 to be 

<math display="inline" id="Sample_entropy:35">
 <semantics>
  <mrow>
   <mrow>
    <mn>0.2</mn>
    <mo>×</mo>
    <mi>s</mi>
   </mrow>
   <mi>t</mi>
   <mi>d</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <times></times>
     <cn type="float">0.2</cn>
     <ci>s</ci>
    </apply>
    <ci>t</ci>
    <ci>d</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   0.2\times std
  </annotation>
 </semantics>
</math>

. Where std stands for <a href="standard_deviation" title="wikilink">standard deviation</a> which should be taken over a very large dataset. For instance, the r value of 6 ms is appropriate for sample entropy calculations of heart rate intervals, since this corresponds to 

<math display="inline" id="Sample_entropy:36">
 <semantics>
  <mrow>
   <mrow>
    <mn>0.2</mn>
    <mo>×</mo>
    <mi>s</mi>
   </mrow>
   <mi>t</mi>
   <mi>d</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <times></times>
     <cn type="float">0.2</cn>
     <ci>s</ci>
    </apply>
    <ci>t</ci>
    <ci>d</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   0.2\times std
  </annotation>
 </semantics>
</math>

 for a very large population.</p>
<h2 id="multiscale-sampen">Multiscale SampEn</h2>

<p>The definition mentioned above is a special case of multi scale sampEn with 

<math display="inline" id="Sample_entropy:37">
 <semantics>
  <mrow>
   <mi>δ</mi>
   <mo>=</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>δ</ci>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \delta=1
  </annotation>
 </semantics>
</math>

,where 

<math display="inline" id="Sample_entropy:38">
 <semantics>
  <mi>δ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>δ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \delta
  </annotation>
 </semantics>
</math>

 is called skipping parameter. In multiscale SampEn template vectors are defined with a certain interval between its each element specified by the value of 

<math display="inline" id="Sample_entropy:39">
 <semantics>
  <mi>δ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>δ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \delta
  </annotation>
 </semantics>
</math>

. And modified template vector is defined as 

<math display="inline" id="Sample_entropy:40">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>X</mi>
     <mrow>
      <mi>m</mi>
      <mo>,</mo>
      <mi>δ</mi>
     </mrow>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>i</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <msub>
     <mi>x</mi>
     <mi>i</mi>
    </msub>
    <mo>,</mo>
    <msub>
     <mi>x</mi>
     <mrow>
      <mi>i</mi>
      <mo>+</mo>
      <mi>δ</mi>
     </mrow>
    </msub>
    <mo>,</mo>
    <msub>
     <mi>x</mi>
     <mrow>
      <mi>i</mi>
      <mo>+</mo>
      <mrow>
       <mn>2</mn>
       <mo>×</mo>
       <mi>δ</mi>
      </mrow>
     </mrow>
    </msub>
    <mo>,</mo>
    <mi mathvariant="normal">…</mi>
    <mo>,</mo>
    <msub>
     <mi>x</mi>
     <mrow>
      <mi>i</mi>
      <mo>+</mo>
      <mrow>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mi>m</mi>
         <mo>-</mo>
         <mn>1</mn>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
       <mo>×</mo>
       <mi>δ</mi>
      </mrow>
     </mrow>
    </msub>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>X</ci>
      <list>
       <ci>m</ci>
       <ci>δ</ci>
      </list>
     </apply>
     <ci>i</ci>
    </apply>
    <list>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <ci>i</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <apply>
       <plus></plus>
       <ci>i</ci>
       <ci>δ</ci>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <apply>
       <plus></plus>
       <ci>i</ci>
       <apply>
        <times></times>
        <cn type="integer">2</cn>
        <ci>δ</ci>
       </apply>
      </apply>
     </apply>
     <ci>normal-…</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <apply>
       <plus></plus>
       <ci>i</ci>
       <apply>
        <times></times>
        <apply>
         <minus></minus>
         <ci>m</ci>
         <cn type="integer">1</cn>
        </apply>
        <ci>δ</ci>
       </apply>
      </apply>
     </apply>
    </list>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   X_{m,\delta}(i)={x_{i},x_{i+\delta},x_{i+2\times\delta},...,x_{i+(m-1)\times%
\delta}}
  </annotation>
 </semantics>
</math>

 and sampEn can be written as 

<math display="inline" id="Sample_entropy:41">
 <semantics>
  <mrow>
   <mrow>
    <mi>S</mi>
    <mi>a</mi>
    <mi>m</mi>
    <mi>p</mi>
    <mi>E</mi>
    <mi>n</mi>
    <mrow>
     <mo>(</mo>
     <mi>m</mi>
     <mo>,</mo>
     <mi>r</mi>
     <mo>,</mo>
     <mi>δ</mi>
     <mo>)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mo>-</mo>
    <mrow>
     <mi>log</mi>
     <mfrac>
      <msub>
       <mi>A</mi>
       <mi>δ</mi>
      </msub>
      <msub>
       <mi>B</mi>
       <mi>δ</mi>
      </msub>
     </mfrac>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>S</ci>
     <ci>a</ci>
     <ci>m</ci>
     <ci>p</ci>
     <ci>E</ci>
     <ci>n</ci>
     <vector>
      <ci>m</ci>
      <ci>r</ci>
      <ci>δ</ci>
     </vector>
    </apply>
    <apply>
     <minus></minus>
     <apply>
      <log></log>
      <apply>
       <divide></divide>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>A</ci>
        <ci>δ</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>B</ci>
        <ci>δ</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   SampEn\left(m,r,\delta\right)=-\log{A_{\delta}\over B_{\delta}}
  </annotation>
 </semantics>
</math>

 And we calculate 

<math display="inline" id="Sample_entropy:42">
 <semantics>
  <msub>
   <mi>A</mi>
   <mi>δ</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>A</ci>
    <ci>δ</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A_{\delta}
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Sample_entropy:43">
 <semantics>
  <msub>
   <mi>B</mi>
   <mi>δ</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>B</ci>
    <ci>δ</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   B_{\delta}
  </annotation>
 </semantics>
</math>

 like before.</p>
<h2 id="implementation">Implementation</h2>

<p>Sample entropy can be implemented easily in many different programming languages. An example written in MatLab can be found <a href="http://www.mathworks.com/matlabcentral/fileexchange/35784-sample-entropy">here</a>.</p>
<h2 id="references">References</h2>

<p>"</p>

<p><a href="Category:Time_series_analysis" title="wikilink">Category:Time series analysis</a> <a class="uri" href="Category:Entropy" title="wikilink">Category:Entropy</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1"><a href="#fnref1">↩</a></li>
<li id="fn2"><a href="#fnref2">↩</a></li>
</ol>
</section>
</body>
</html>

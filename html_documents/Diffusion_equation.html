<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="57">Diffusion equation</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Diffusion equation</h1>
<hr/>

<p>The <strong>diffusion equation</strong> is a <a href="partial_differential_equation" title="wikilink">partial differential equation</a> which describes density dynamics in a material undergoing <a class="uri" href="diffusion" title="wikilink">diffusion</a>. It is also used to describe processes exhibiting diffusive-like behaviour, for instance the 'diffusion' of <a class="uri" href="alleles" title="wikilink">alleles</a> in a population in <a href="population_genetics" title="wikilink">population genetics</a>.</p>
<h2 id="statement">Statement</h2>

<p>The equation is usually written as:</p>

<p>where <em>Ï•</em>(<strong>r</strong>, <em>t</em>) is the <a class="uri" href="density" title="wikilink">density</a> of the diffusing material at location <strong>r</strong> and time <em>t</em> and <em>D</em>(<em>Ï•</em>, <strong>r</strong>) is the collective <a href="diffusion_coefficient" title="wikilink">diffusion coefficient</a> for density <em>Ï•</em> at location <strong>r</strong>; and âˆ‡ represents the vector <a href="differential_operator" title="wikilink">differential operator</a> <a class="uri" href="del" title="wikilink">del</a>. If the diffusion coefficient depends on the density then the equation is nonlinear, otherwise it is linear.</p>

<p>More generally, when <em>D</em> is a symmetric <a href="positive_definite_matrix" title="wikilink">positive definite matrix</a>, the equation describes <a href="Anisotropy" title="wikilink">anisotropic</a> diffusion, which is written (for three dimensional diffusion) as:</p>

<p>If <em>D</em> is constant, then the equation reduces to the following <a href="linear_differential_equation" title="wikilink">linear differential equation</a>:</p>

<p>

<math display="block" id="Diffusion_equation:0">
 <semantics>
  <mrow>
   <mrow>
    <mfrac>
     <mrow>
      <mrow>
       <mo>âˆ‚</mo>
       <mi>Ï•</mi>
      </mrow>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>ğ«</mi>
       <mo>,</mo>
       <mi>t</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mrow>
      <mo>âˆ‚</mo>
      <mi>t</mi>
     </mrow>
    </mfrac>
    <mo>=</mo>
    <mrow>
     <mi>D</mi>
     <mrow>
      <msup>
       <mo>âˆ‡</mo>
       <mn>2</mn>
      </msup>
      <mi>Ï•</mi>
     </mrow>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>ğ«</mi>
      <mo>,</mo>
      <mi>t</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <divide></divide>
     <apply>
      <times></times>
      <apply>
       <partialdiff></partialdiff>
       <ci>Ï•</ci>
      </apply>
      <interval closure="open">
       <ci>ğ«</ci>
       <ci>t</ci>
      </interval>
     </apply>
     <apply>
      <partialdiff></partialdiff>
      <ci>t</ci>
     </apply>
    </apply>
    <apply>
     <times></times>
     <ci>D</ci>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>normal-âˆ‡</ci>
       <cn type="integer">2</cn>
      </apply>
      <ci>Ï•</ci>
     </apply>
     <interval closure="open">
      <ci>ğ«</ci>
      <ci>t</ci>
     </interval>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \frac{\partial\phi(\mathbf{r},t)}{\partial t}=D\nabla^{2}\phi(\mathbf{r},t),
  </annotation>
 </semantics>
</math>

</p>

<p>also called the <a href="heat_equation" title="wikilink">heat equation</a>.</p>
<h2 id="historical-origin">Historical origin</h2>

<p>The <a href="Fick's_law_of_diffusion" title="wikilink">particle diffusion equation</a> was originally derived by <a href="Adolf_Fick" title="wikilink">Adolf Fick</a> in 1855.<a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a></p>
<h2 id="derivation">Derivation</h2>

<p>The diffusion equation can be trivially derived from the <a href="continuity_equation" title="wikilink">continuity equation</a>, which states that a change in density in any part of the system is due to inflow and outflow of material into and out of that part of the system. Effectively, no material is created or destroyed:</p>

<p>

<math display="block" id="Diffusion_equation:1">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mfrac>
      <mrow>
       <mo>âˆ‚</mo>
       <mi>Ï•</mi>
      </mrow>
      <mrow>
       <mo>âˆ‚</mo>
       <mi>t</mi>
      </mrow>
     </mfrac>
     <mo>+</mo>
     <mrow>
      <mo>âˆ‡</mo>
      <mo>â‹…</mo>
      <mi>ğ£</mi>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mn>0</mn>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <plus></plus>
     <apply>
      <divide></divide>
      <apply>
       <partialdiff></partialdiff>
       <ci>Ï•</ci>
      </apply>
      <apply>
       <partialdiff></partialdiff>
       <ci>t</ci>
      </apply>
     </apply>
     <apply>
      <ci>normal-â‹…</ci>
      <ci>normal-âˆ‡</ci>
      <ci>ğ£</ci>
     </apply>
    </apply>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \frac{\partial\phi}{\partial t}+\nabla\cdot\mathbf{j}=0,
  </annotation>
 </semantics>
</math>

</p>

<p>where <strong>j</strong> is the flux of the diffusing material. The diffusion equation can be obtained easily from this when combined with the phenomenological <a href="Fick's_law" title="wikilink">Fick's first law</a>, which states that the flux of the diffusing material in any part of the system is proportional to the local density gradient:</p>

<p>

<math display="block" id="Diffusion_equation:2">
 <semantics>
  <mrow>
   <mrow>
    <mi>ğ£</mi>
    <mo>=</mo>
    <mrow>
     <mo>-</mo>
     <mrow>
      <mi>D</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>Ï•</mi>
       <mo>,</mo>
       <mi>ğ«</mi>
       <mo rspace="4.2pt" stretchy="false">)</mo>
      </mrow>
      <mrow>
       <mo>âˆ‡</mo>
       <mi>Ï•</mi>
      </mrow>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>ğ«</mi>
       <mo>,</mo>
       <mi>t</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>ğ£</ci>
    <apply>
     <minus></minus>
     <apply>
      <times></times>
      <ci>D</ci>
      <interval closure="open">
       <ci>Ï•</ci>
       <ci>ğ«</ci>
      </interval>
      <apply>
       <ci>normal-âˆ‡</ci>
       <ci>Ï•</ci>
      </apply>
      <interval closure="open">
       <ci>ğ«</ci>
       <ci>t</ci>
      </interval>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{j}=-D(\phi,\mathbf{r})\,\nabla\phi(\mathbf{r},t).
  </annotation>
 </semantics>
</math>

</p>

<p>If drift must be taken into account, the <a href="Smoluchowski_equation" title="wikilink">Smoluchowski equation</a> provides an appropriate generalization.</p>
<h2 id="discretization">Discretization</h2>

<p>The diffusion equation is continuous in both space and time. One may discretize space, time, or both space and time, which arise in application. Discretizing time alone just corresponds to taking time slices of the continuous system, and no new phenomena arise. In discretizing space alone, the <a href="Green's_function" title="wikilink">Green's function</a> becomes the <a href="discrete_Gaussian_kernel" title="wikilink">discrete Gaussian kernel</a>, rather than the continuous <a href="Gaussian_kernel" title="wikilink">Gaussian kernel</a>. In discretizing both time and space, one obtains the <a href="random_walk" title="wikilink">random walk</a>.</p>
<h2 id="discretization-image">Discretization (Image)</h2>

<p>The <a href="product_rule" title="wikilink">product rule</a> is used to rewrite the anisotropic tensor diffusion equation, in standard discretization schemes. Because direct discretization of the diffusion equation with only first order spatial central differences leads to checkerboard artifacts. The rewritten diffusion equation used in image filtering:</p>

<p>

<math display="inline" id="Diffusion_equation:3">
 <semantics>
  <mrow>
   <mfrac>
    <mrow>
     <mrow>
      <mo>âˆ‚</mo>
      <mi>Ï•</mi>
     </mrow>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>ğ«</mi>
      <mo>,</mo>
      <mi>t</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mrow>
     <mo>âˆ‚</mo>
     <mi>t</mi>
    </mrow>
   </mfrac>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mrow>
      <mo>âˆ‡</mo>
      <mo>â‹…</mo>
      <mrow>
       <mo>[</mo>
       <mrow>
        <mi>D</mi>
        <mrow>
         <mo stretchy="false">(</mo>
         <mi>Ï•</mi>
         <mo>,</mo>
         <mi>ğ«</mi>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
       <mo>]</mo>
      </mrow>
     </mrow>
     <mrow>
      <mo>âˆ‡</mo>
      <mi>Ï•</mi>
     </mrow>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>ğ«</mi>
      <mo>,</mo>
      <mi>t</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>+</mo>
    <mrow>
     <mi>tr</mi>
     <mrow>
      <mo maxsize="160%" minsize="160%">[</mo>
      <mrow>
       <mi>D</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>Ï•</mi>
        <mo>,</mo>
        <mi>ğ«</mi>
        <mo stretchy="false">)</mo>
       </mrow>
       <mrow>
        <mo maxsize="120%" minsize="120%">(</mo>
        <mrow>
         <mrow>
          <mrow>
           <mo>âˆ‡</mo>
           <msup>
            <mo>âˆ‡</mo>
            <mi>T</mi>
           </msup>
          </mrow>
          <mi>Ï•</mi>
         </mrow>
         <mrow>
          <mo stretchy="false">(</mo>
          <mi>ğ«</mi>
          <mo>,</mo>
          <mi>t</mi>
          <mo stretchy="false">)</mo>
         </mrow>
        </mrow>
        <mo maxsize="120%" minsize="120%">)</mo>
       </mrow>
      </mrow>
      <mo maxsize="160%" minsize="160%">]</mo>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <divide></divide>
     <apply>
      <times></times>
      <apply>
       <partialdiff></partialdiff>
       <ci>Ï•</ci>
      </apply>
      <interval closure="open">
       <ci>ğ«</ci>
       <ci>t</ci>
      </interval>
     </apply>
     <apply>
      <partialdiff></partialdiff>
      <ci>t</ci>
     </apply>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <apply>
       <ci>normal-â‹…</ci>
       <ci>normal-âˆ‡</ci>
       <apply>
        <csymbol cd="latexml">delimited-[]</csymbol>
        <apply>
         <times></times>
         <ci>D</ci>
         <interval closure="open">
          <ci>Ï•</ci>
          <ci>ğ«</ci>
         </interval>
        </apply>
       </apply>
      </apply>
      <apply>
       <ci>normal-âˆ‡</ci>
       <ci>Ï•</ci>
      </apply>
      <interval closure="open">
       <ci>ğ«</ci>
       <ci>t</ci>
      </interval>
     </apply>
     <apply>
      <times></times>
      <ci>tr</ci>
      <apply>
       <csymbol cd="latexml">delimited-[]</csymbol>
       <apply>
        <times></times>
        <ci>D</ci>
        <interval closure="open">
         <ci>Ï•</ci>
         <ci>ğ«</ci>
        </interval>
        <apply>
         <times></times>
         <apply>
          <apply>
           <ci>normal-âˆ‡</ci>
           <apply>
            <csymbol cd="ambiguous">superscript</csymbol>
            <ci>normal-âˆ‡</ci>
            <ci>T</ci>
           </apply>
          </apply>
          <ci>Ï•</ci>
         </apply>
         <interval closure="open">
          <ci>ğ«</ci>
          <ci>t</ci>
         </interval>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \frac{\partial\phi(\mathbf{r},t)}{\partial t}=\nabla\cdot\left[D(\phi,\mathbf{%
r})\right]\nabla\phi(\mathbf{r},t)+{\rm tr}\Big[D(\phi,\mathbf{r})\big(\nabla%
\nabla^{T}\phi(\mathbf{r},t)\big)\Big]
  </annotation>
 </semantics>
</math>


</p>

<p>where "tr" denotes the <a href="Trace_(linear_algebra)" title="wikilink">trace</a> of the 2nd rank <a class="uri" href="tensor" title="wikilink">tensor</a>, and superscript "<em>T</em>" denotes <a class="uri" href="transpose" title="wikilink">transpose</a>, in which in image filtering <em>D</em>(<em>Ï•</em>, <strong>r</strong>) are symmetric matrices constructed from the <a class="uri" href="eigenvectors" title="wikilink">eigenvectors</a> of the image <a href="structure_tensor" title="wikilink">structure tensors</a> . The spatial derivatives can then be approximated by two first order and a second order central <a href="finite_difference" title="wikilink">finite differences</a>. The resulting diffusion algorithm can be written as an image <a class="uri" href="convolution" title="wikilink">convolution</a> with a varying kernel (stencil) of size 3 Ã— 3 in 2D and 3 Ã— 3 Ã— 3 in 3D.</p>
<h2 id="see-also">See also</h2>
<ul>
<li><a href="Continuity_equation" title="wikilink">Continuity equation</a></li>
<li><a href="Heat_equation" title="wikilink">Heat equation</a></li>
<li><a href="Fokker-Planck_equation" title="wikilink">Fokker-Planck equation</a></li>
<li><a href="Fick's_law_of_diffusion" title="wikilink">Fick's law of diffusion</a>: <a href="Fick's_law_of_diffusion#Second_law" title="wikilink">Fick's Second Law</a></li>
<li><a href="Maxwell-Stefan_equation" title="wikilink">Maxwell-Stefan equation</a></li>
<li><a href="Radiative_transfer_equation_and_diffusion_theory_for_photon_transport_in_biological_tissue" title="wikilink">Radiative transfer equation and diffusion theory for photon transport in biological tissue</a></li>
<li><a href="Numerical_solution_of_the_convectionâ€“diffusion_equation" title="wikilink">Numerical solution of the convectionâ€“diffusion equation</a></li>
</ul>
<h2 id="references">References</h2>
<references>
</references>

<p>2. Carslaw, H. S. and Jager, J. C. (1959). Conduction of Heat in Solids. Oxford: Clarendon Press</p>

<p>3. Crank, J. (1956). The Mathematics of Diffusion. Oxford: Clarendon Press</p>

<p>4. Thambynayagam, R. K. M (2011). The Diffusion Handbook: Applied Solutions for Engineers: McGraw-Hill</p>
<h2 id="external-links">External links</h2>
<ul>
<li><a href="http://www.ee.byu.edu/cleanroom/DopConCalc.phtml">Diffusion Calculator for Impurities &amp; Dopants in Silicon</a></li>
<li><a href="http://dl.dropbox.com/u/46147408/tutorials/diffusion.pdf">A tutorial on the theory behind and solution of the Diffusion Equation.</a></li>
<li><a href="http://dragon.unideb.hu/~zerdelyi/Diffusion-on-the-nanoscale/index.html">Classical and nanoscale diffusion (with figures and animations)</a></li>
</ul>

<p><a href="it:Leggi_di_Fick" title="wikilink">it:Leggi di Fick</a>"</p>

<p><a class="uri" href="Category:Diffusion" title="wikilink">Category:Diffusion</a> <a href="Category:Partial_differential_equations" title="wikilink">Category:Partial differential equations</a> <a href="Category:Parabolic_partial_differential_equations" title="wikilink">Category:Parabolic partial differential equations</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1">A. Fick, <em>Ueber Diffusion</em>, Pogg. Ann. Phys. Chem. 170 (4. Reihe 94), 59-86 (1855).<a href="#fnref1">â†©</a></li>
</ol>
</section>
</body>
</html>

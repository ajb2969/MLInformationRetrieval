<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="192">Plane wave expansion method</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Plane wave expansion method</h1>
<hr/>

<p><strong>Plane wave expansion method</strong> (PWE) refers to a computational technique in <a class="uri" href="electromagnetics" title="wikilink">electromagnetics</a> to solve the <a href="Maxwell's_equations" title="wikilink">Maxwell's equations</a> by formulating an <a class="uri" href="eigenvalue" title="wikilink">eigenvalue</a> problem out of the equation. This method is popular among the <a href="photonic_crystal" title="wikilink">photonic crystal</a> community as a method of solving for the <a href="band_structure" title="wikilink">band structure</a> (dispersion relation) of specific photonic crystal geometries. PWE is traceable to the analytical formulations, and is useful in calculating modal solutions of Maxwell's equations over an inhomogeneous or periodic geometry. It is specifically tuned to solve problems in a time-harmonic forms, with <a href="Dispersion_(optics)" title="wikilink">non-dispersive</a> media.</p>
<h2 id="principles">Principles</h2>

<p><a href="Plane_wave" title="wikilink">Plane waves</a> are solutions to the homogeneous <a href="Helmholtz_equation" title="wikilink">Helmholtz equation</a>, and form a basis to represent fields in the periodic media. PWE as applied to photonic crystals as described is primarily sourced from Dr. Danner's tutorial.<a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a></p>

<p>The electric or magnetic fields are expanded for each field component in terms of the <a href="Fourier_series" title="wikilink">Fourier series</a> components along the reciprocal lattice vector. Similarly, the dielectric permittivity (which is periodic along reciprocal lattice vector for photonic crystals) is also expanded through Fourier series components.</p>

<p>

<math display="block" id="Plane_wave_expansion_method:0">
 <semantics>
  <mrow>
   <mfrac>
    <mn>1</mn>
    <msub>
     <mi>ϵ</mi>
     <mi>r</mi>
    </msub>
   </mfrac>
   <mo>=</mo>
   <mrow>
    <munderover>
     <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
     <mrow>
      <mi>m</mi>
      <mo>=</mo>
      <mrow>
       <mo>-</mo>
       <mi mathvariant="normal">∞</mi>
      </mrow>
     </mrow>
     <mrow>
      <mo>+</mo>
      <mi mathvariant="normal">∞</mi>
     </mrow>
    </munderover>
    <mrow>
     <msubsup>
      <mi>K</mi>
      <mi>m</mi>
      <msub>
       <mi>ϵ</mi>
       <mi>r</mi>
      </msub>
     </msubsup>
     <msup>
      <mi>e</mi>
      <mrow>
       <mrow>
        <mo>-</mo>
        <mrow>
         <mi>i</mi>
         <mover accent="true">
          <mi>G</mi>
          <mo stretchy="false">→</mo>
         </mover>
        </mrow>
       </mrow>
       <mo>.</mo>
       <mover accent="true">
        <mi>r</mi>
        <mo stretchy="false">→</mo>
       </mover>
      </mrow>
     </msup>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <divide></divide>
     <cn type="integer">1</cn>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>ϵ</ci>
      <ci>r</ci>
     </apply>
    </apply>
    <apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <apply>
        <eq></eq>
        <ci>m</ci>
        <apply>
         <minus></minus>
         <infinity></infinity>
        </apply>
       </apply>
      </apply>
      <apply>
       <plus></plus>
       <infinity></infinity>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>K</ci>
        <ci>m</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>ϵ</ci>
        <ci>r</ci>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>e</ci>
       <apply>
        <csymbol cd="ambiguous">formulae-sequence</csymbol>
        <apply>
         <minus></minus>
         <apply>
          <times></times>
          <ci>i</ci>
          <apply>
           <ci>normal-→</ci>
           <ci>G</ci>
          </apply>
         </apply>
        </apply>
        <apply>
         <ci>normal-→</ci>
         <ci>r</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \frac{1}{\epsilon_{r}}=\sum_{m=-\infty}^{+\infty}K_{m}^{\epsilon_{r}}e^{-i\vec%
{G}.\vec{r}}
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Plane_wave_expansion_method:1">
 <semantics>
  <mrow>
   <mrow>
    <mi>E</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>ω</mi>
     <mo>,</mo>
     <mover accent="true">
      <mi>r</mi>
      <mo stretchy="false">→</mo>
     </mover>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <munderover>
     <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
     <mrow>
      <mi>n</mi>
      <mo>=</mo>
      <mrow>
       <mo>-</mo>
       <mi mathvariant="normal">∞</mi>
      </mrow>
     </mrow>
     <mrow>
      <mo>+</mo>
      <mi mathvariant="normal">∞</mi>
     </mrow>
    </munderover>
    <mrow>
     <msubsup>
      <mi>K</mi>
      <mi>n</mi>
      <msub>
       <mi>E</mi>
       <mi>y</mi>
      </msub>
     </msubsup>
     <msup>
      <mi>e</mi>
      <mrow>
       <mrow>
        <mo>-</mo>
        <mrow>
         <mi>i</mi>
         <mover accent="true">
          <mi>G</mi>
          <mo stretchy="false">→</mo>
         </mover>
        </mrow>
       </mrow>
       <mo>.</mo>
       <mover accent="true">
        <mi>r</mi>
        <mo stretchy="false">→</mo>
       </mover>
      </mrow>
     </msup>
     <msup>
      <mi>e</mi>
      <mrow>
       <mo>-</mo>
       <mrow>
        <mi>i</mi>
        <mover accent="true">
         <mi>k</mi>
         <mo stretchy="false">→</mo>
        </mover>
        <mover accent="true">
         <mi>r</mi>
         <mo stretchy="false">→</mo>
        </mover>
       </mrow>
      </mrow>
     </msup>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>E</ci>
     <interval closure="open">
      <ci>ω</ci>
      <apply>
       <ci>normal-→</ci>
       <ci>r</ci>
      </apply>
     </interval>
    </apply>
    <apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <apply>
        <eq></eq>
        <ci>n</ci>
        <apply>
         <minus></minus>
         <infinity></infinity>
        </apply>
       </apply>
      </apply>
      <apply>
       <plus></plus>
       <infinity></infinity>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>K</ci>
        <ci>n</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>E</ci>
        <ci>y</ci>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>e</ci>
       <apply>
        <csymbol cd="ambiguous">formulae-sequence</csymbol>
        <apply>
         <minus></minus>
         <apply>
          <times></times>
          <ci>i</ci>
          <apply>
           <ci>normal-→</ci>
           <ci>G</ci>
          </apply>
         </apply>
        </apply>
        <apply>
         <ci>normal-→</ci>
         <ci>r</ci>
        </apply>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>e</ci>
       <apply>
        <minus></minus>
        <apply>
         <times></times>
         <ci>i</ci>
         <apply>
          <ci>normal-→</ci>
          <ci>k</ci>
         </apply>
         <apply>
          <ci>normal-→</ci>
          <ci>r</ci>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   E(\omega,\vec{r})=\sum_{n=-\infty}^{+\infty}K_{n}^{E_{y}}e^{-i\vec{G}.\vec{r}}%
e^{-i\vec{k}\vec{r}}
  </annotation>
 </semantics>
</math>

</p>

<p>with the Fourier series coefficients being the K numbers subscripted by m, n respectively, and the reciprocal lattice <a href="Vector_(mathematics_and_physics)" title="wikilink">vector</a> given by 

<math display="inline" id="Plane_wave_expansion_method:2">
 <semantics>
  <mover accent="true">
   <mi>G</mi>
   <mo stretchy="false">→</mo>
  </mover>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-→</ci>
    <ci>G</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \vec{G}
  </annotation>
 </semantics>
</math>

. In real modeling, the range of components considered will be reduced to just 

<math display="inline" id="Plane_wave_expansion_method:3">
 <semantics>
  <mrow>
   <mo>±</mo>
   <mrow>
    <mi>N</mi>
    <mi>m</mi>
    <mi>a</mi>
    <mi>x</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">plus-or-minus</csymbol>
    <apply>
     <times></times>
     <ci>N</ci>
     <ci>m</ci>
     <ci>a</ci>
     <ci>x</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \pm Nmax
  </annotation>
 </semantics>
</math>

 instead of the ideal, infinite wave.</p>

<p>Using these expansions in any of the curl-curl relations like,</p>

<p>

<math display="block" id="Plane_wave_expansion_method:4">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mrow>
      <mfrac>
       <mn>1</mn>
       <mrow>
        <mi>ϵ</mi>
        <mrow>
         <mo stretchy="false">(</mo>
         <mover accent="true">
          <mi>r</mi>
          <mo stretchy="false">→</mo>
         </mover>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
      </mfrac>
      <mo>∇</mo>
     </mrow>
     <mo>×</mo>
     <mo>∇</mo>
     <mo>×</mo>
     <mi>E</mi>
    </mrow>
    <mrow>
     <mo stretchy="false">(</mo>
     <mover accent="true">
      <mi>r</mi>
      <mo stretchy="false">→</mo>
     </mover>
     <mo>,</mo>
     <mi>ω</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <msup>
     <mrow>
      <mo>(</mo>
      <mfrac>
       <mi>ω</mi>
       <mi>c</mi>
      </mfrac>
      <mo>)</mo>
     </mrow>
     <mn>2</mn>
    </msup>
    <mi>E</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mover accent="true">
      <mi>r</mi>
      <mo stretchy="false">→</mo>
     </mover>
     <mo>,</mo>
     <mi>ω</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <times></times>
      <apply>
       <times></times>
       <apply>
        <divide></divide>
        <cn type="integer">1</cn>
        <apply>
         <times></times>
         <ci>ϵ</ci>
         <apply>
          <ci>normal-→</ci>
          <ci>r</ci>
         </apply>
        </apply>
       </apply>
       <ci>normal-∇</ci>
      </apply>
      <ci>normal-∇</ci>
      <ci>E</ci>
     </apply>
     <interval closure="open">
      <apply>
       <ci>normal-→</ci>
       <ci>r</ci>
      </apply>
      <ci>ω</ci>
     </interval>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <divide></divide>
       <ci>ω</ci>
       <ci>c</ci>
      </apply>
      <cn type="integer">2</cn>
     </apply>
     <ci>E</ci>
     <interval closure="open">
      <apply>
       <ci>normal-→</ci>
       <ci>r</ci>
      </apply>
      <ci>ω</ci>
     </interval>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \frac{1}{\epsilon(\vec{r})}\nabla\times\nabla\times E(\vec{r},\omega)=\left(%
\frac{\omega}{c}\right)^{2}E(\vec{r},\omega)
  </annotation>
 </semantics>
</math>

</p>

<p>and simplifying under assumptions of a source free, linear, and non-dispersive region we obtain the <a href="eigen_value" title="wikilink">eigen value</a> relations which can be solved.</p>
<h2 id="example-for-1d-case">Example for 1D case</h2>

<p>For a y-polarized z-propagating electric wave, incident on a 1D-DBR periodic in only z-direction and homogeneous along x,y, with a lattice period of a. We then have the following simplified relations:</p>
<figure><b>(Figure)</b>
<figcaption>Band structure of a 1D Photonic Crystal, DBR air-core calculated using plane wave expansion technique with 101 planewaves, for d/a=0.8, and dielectric contrast of 12.250.</figcaption>
</figure>

<p>

<math display="block" id="Plane_wave_expansion_method:5">
 <semantics>
  <mrow>
   <mfrac>
    <mn>1</mn>
    <msub>
     <mi>ϵ</mi>
     <mi>r</mi>
    </msub>
   </mfrac>
   <mo>=</mo>
   <mrow>
    <munderover>
     <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
     <mrow>
      <mi>m</mi>
      <mo>=</mo>
      <mrow>
       <mo>-</mo>
       <mi mathvariant="normal">∞</mi>
      </mrow>
     </mrow>
     <mrow>
      <mo>+</mo>
      <mi mathvariant="normal">∞</mi>
     </mrow>
    </munderover>
    <mrow>
     <msubsup>
      <mi>K</mi>
      <mi>m</mi>
      <msub>
       <mi>ϵ</mi>
       <mi>r</mi>
      </msub>
     </msubsup>
     <msup>
      <mi>e</mi>
      <mrow>
       <mo>-</mo>
       <mrow>
        <mi>i</mi>
        <mfrac>
         <mrow>
          <mn>2</mn>
          <mi>π</mi>
          <mi>m</mi>
         </mrow>
         <mi>a</mi>
        </mfrac>
        <mi>z</mi>
       </mrow>
      </mrow>
     </msup>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <divide></divide>
     <cn type="integer">1</cn>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>ϵ</ci>
      <ci>r</ci>
     </apply>
    </apply>
    <apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <apply>
        <eq></eq>
        <ci>m</ci>
        <apply>
         <minus></minus>
         <infinity></infinity>
        </apply>
       </apply>
      </apply>
      <apply>
       <plus></plus>
       <infinity></infinity>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>K</ci>
        <ci>m</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>ϵ</ci>
        <ci>r</ci>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>e</ci>
       <apply>
        <minus></minus>
        <apply>
         <times></times>
         <ci>i</ci>
         <apply>
          <divide></divide>
          <apply>
           <times></times>
           <cn type="integer">2</cn>
           <ci>π</ci>
           <ci>m</ci>
          </apply>
          <ci>a</ci>
         </apply>
         <ci>z</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \frac{1}{\epsilon_{r}}=\sum_{m=-\infty}^{+\infty}K_{m}^{\epsilon_{r}}e^{-i%
\frac{2\pi m}{a}z}
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Plane_wave_expansion_method:6">
 <semantics>
  <mrow>
   <mrow>
    <mi>E</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>ω</mi>
     <mo>,</mo>
     <mover accent="true">
      <mi>r</mi>
      <mo stretchy="false">→</mo>
     </mover>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <munderover>
     <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
     <mrow>
      <mi>n</mi>
      <mo>=</mo>
      <mrow>
       <mo>-</mo>
       <mi mathvariant="normal">∞</mi>
      </mrow>
     </mrow>
     <mrow>
      <mo>+</mo>
      <mi mathvariant="normal">∞</mi>
     </mrow>
    </munderover>
    <mrow>
     <msubsup>
      <mi>K</mi>
      <mi>n</mi>
      <msub>
       <mi>E</mi>
       <mi>y</mi>
      </msub>
     </msubsup>
     <msup>
      <mi>e</mi>
      <mrow>
       <mo>-</mo>
       <mrow>
        <mi>i</mi>
        <mfrac>
         <mrow>
          <mn>2</mn>
          <mi>π</mi>
          <mi>n</mi>
         </mrow>
         <mi>a</mi>
        </mfrac>
        <mi>z</mi>
       </mrow>
      </mrow>
     </msup>
     <msup>
      <mi>e</mi>
      <mrow>
       <mo>-</mo>
       <mrow>
        <mi>i</mi>
        <mover accent="true">
         <mi>k</mi>
         <mo stretchy="false">→</mo>
        </mover>
        <mover accent="true">
         <mi>r</mi>
         <mo stretchy="false">→</mo>
        </mover>
       </mrow>
      </mrow>
     </msup>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>E</ci>
     <interval closure="open">
      <ci>ω</ci>
      <apply>
       <ci>normal-→</ci>
       <ci>r</ci>
      </apply>
     </interval>
    </apply>
    <apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <apply>
        <eq></eq>
        <ci>n</ci>
        <apply>
         <minus></minus>
         <infinity></infinity>
        </apply>
       </apply>
      </apply>
      <apply>
       <plus></plus>
       <infinity></infinity>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>K</ci>
        <ci>n</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>E</ci>
        <ci>y</ci>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>e</ci>
       <apply>
        <minus></minus>
        <apply>
         <times></times>
         <ci>i</ci>
         <apply>
          <divide></divide>
          <apply>
           <times></times>
           <cn type="integer">2</cn>
           <ci>π</ci>
           <ci>n</ci>
          </apply>
          <ci>a</ci>
         </apply>
         <ci>z</ci>
        </apply>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>e</ci>
       <apply>
        <minus></minus>
        <apply>
         <times></times>
         <ci>i</ci>
         <apply>
          <ci>normal-→</ci>
          <ci>k</ci>
         </apply>
         <apply>
          <ci>normal-→</ci>
          <ci>r</ci>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   E(\omega,\vec{r})=\sum_{n=-\infty}^{+\infty}K_{n}^{E_{y}}e^{-i\frac{2\pi n}{a}%
z}e^{-i\vec{k}\vec{r}}
  </annotation>
 </semantics>
</math>

</p>

<p>The constitutive eigen equation we finally have to solve becomes,</p>

<p>

<math display="block" id="Plane_wave_expansion_method:7">
 <semantics>
  <mrow>
   <mrow>
    <munder>
     <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
     <mi>n</mi>
    </munder>
    <mrow>
     <mrow>
      <mo>(</mo>
      <mrow>
       <mfrac>
        <mrow>
         <mn>2</mn>
         <mi>π</mi>
         <mi>n</mi>
        </mrow>
        <mi>a</mi>
       </mfrac>
       <mo>+</mo>
       <msub>
        <mi>k</mi>
        <mi>z</mi>
       </msub>
      </mrow>
      <mo>)</mo>
     </mrow>
     <mrow>
      <mo>(</mo>
      <mrow>
       <mfrac>
        <mrow>
         <mn>2</mn>
         <mi>π</mi>
         <mi>m</mi>
        </mrow>
        <mi>a</mi>
       </mfrac>
       <mo>+</mo>
       <msub>
        <mi>k</mi>
        <mi>z</mi>
       </msub>
      </mrow>
      <mo>)</mo>
     </mrow>
     <msubsup>
      <mi>K</mi>
      <mrow>
       <mi>m</mi>
       <mo>-</mo>
       <mi>n</mi>
      </mrow>
      <msub>
       <mi>ϵ</mi>
       <mi>r</mi>
      </msub>
     </msubsup>
     <msubsup>
      <mi>K</mi>
      <mi>n</mi>
      <msub>
       <mi>E</mi>
       <mi>y</mi>
      </msub>
     </msubsup>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mfrac>
     <msup>
      <mi>ω</mi>
      <mn>2</mn>
     </msup>
     <msup>
      <mi>c</mi>
      <mn>2</mn>
     </msup>
    </mfrac>
    <msubsup>
     <mi>K</mi>
     <mi>m</mi>
     <msub>
      <mi>E</mi>
      <mi>y</mi>
     </msub>
    </msubsup>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <sum></sum>
      <ci>n</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <plus></plus>
       <apply>
        <divide></divide>
        <apply>
         <times></times>
         <cn type="integer">2</cn>
         <ci>π</ci>
         <ci>n</ci>
        </apply>
        <ci>a</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>k</ci>
        <ci>z</ci>
       </apply>
      </apply>
      <apply>
       <plus></plus>
       <apply>
        <divide></divide>
        <apply>
         <times></times>
         <cn type="integer">2</cn>
         <ci>π</ci>
         <ci>m</ci>
        </apply>
        <ci>a</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>k</ci>
        <ci>z</ci>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>K</ci>
        <apply>
         <minus></minus>
         <ci>m</ci>
         <ci>n</ci>
        </apply>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>ϵ</ci>
        <ci>r</ci>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>K</ci>
        <ci>n</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>E</ci>
        <ci>y</ci>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <divide></divide>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>ω</ci>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>c</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>K</ci>
       <ci>m</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>E</ci>
       <ci>y</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \sum_{n}{\left(\frac{2\pi n}{a}+k_{z}\right)\left(\frac{2\pi m}{a}+k_{z}\right%
)K_{m-n}^{\epsilon_{r}}K_{n}^{E_{y}}}=\frac{\omega^{2}}{c^{2}}K_{m}^{E_{y}}
  </annotation>
 </semantics>
</math>

</p>

<p>This can be solved by building a matrix for the terms in the left hand side, and finding its eigen value and vectors. The eigen values correspond to the modal solutions, while the corresponding magnetic or electric fields themselves can be plotted using the Fourier expansions. The <a class="uri" href="coefficients" title="wikilink">coefficients</a> of the field harmonics are obtained from the specific eigen vectors.</p>

<p>The resulting band-structure obtained through the eigen modes of this structure are shown to the right.</p>
<h3 id="example-code">Example code</h3>

<p>We can use the following code in <a class="uri" href="Matlab" title="wikilink">Matlab</a> or <a href="GNU_Octave" title="wikilink">GNU Octave</a> to compute the same band structure,</p>
<pre><code><nowiki>
%
% solve the DBR photonic band structure for a simple
% 1D DBR. air-spacing d, periodicity a, i.e, a &gt; d,
% we assume an infinite stack of 1D alternating eps_r|air layers
% y-polarized, z-directed plane wave incident on the stack
% periodic in the z-direction; 
%

%parameters
d=8; %air gap
a=10; %total periodicity
d_over_a = d/a;
eps_r =12.2500; %dielectric constant, like GaAs,

% max F.S coefs for representing E field, and Eps(r), are
Mmax=50;

% Q matrix is non-symmetric in this case, Qij != Qji
% Qmn = (2*pi*n + Kz)^2*Km-n
% Kn = delta_n / eps_r + (1 - 1/eps_r)(d/a)sinc(pi.n.d/a)
% here n runs from -Mmax to + Mmax,

freqs=[];
for Kz=-pi/a:pi/(10*a):+pi/a
Q=zeros(2*Mmax + 1);
for x=1:2*Mmax+1
    for y=1:2*Mmax+1
        X=x-Mmax;
        Y=y-Mmax;
        kn=(1 -1/eps_r)*d_over_a.*sinc((X-Y).*d_over_a) + ((X-Y)==0)*1/eps_r;
        Q(x,y)=(2*pi*Y/a + Kz).^2*kn;
    end
end

fprintf('Kz = %g\n',Kz)
omega_c=eig(Q);
omega_c=sort(sqrt(omega_c));%important step.
freqs=[freqs; omega_c.'];
end

close()
figure()
hold on
idx=1;

for idx=1:length(-pi/a:pi/(10*a):+pi/a)
    plot(-pi/a:pi/(10*a):+pi/a,freqs(:,idx),'.-')
end
    
hold off
xlabel('Kz')
ylabel('omega/c')
title(sprintf('PBG of 1D DBR with d/a=%g, Epsr=%g',d/a,eps_r))
</nowiki></code></pre>
<h2 id="advantages">Advantages</h2>

<p>PWE expansions are rigorous solutions. PWE is extremely well suited to the modal solution problem. Large size problems can be solved using iterative techniques like <a href="Conjugate_gradient_method" title="wikilink">Conjugate gradient method</a>. For both generalized and normal eigen value problems, just a few band-index plots in the band-structure diagrams are required, usually lying on the <a href="brillouin_zone_edges" title="wikilink">brillouin zone edges</a>. This corresponds to eigen modes solutions using iterative techniques, as opposed to diagonalization of the entire matrix.</p>

<p>The PWEM is highly efficient for calculating modes in periodic dielectric structures. Being a Fourier space method, it suffers from the <a href="Gibbs_phenomenon" title="wikilink">Gibbs phenomenon</a> and slow convergence in some configuration when fast Fourier factorization is not used. It is the method of choice for calculating the band structure of photonic crystals. It is not easy to understand at first, but it is easy to implement.</p>
<h2 id="disadvantages">Disadvantages</h2>

<p>Sometimes spurious modes appear. Large problems scaled as <em>O(n<sup>3</sup>)</em>, with the number of the plane waves (n) used in the problem. This is both time consuming and complex in memory requirements.</p>

<p>Alternatives include Order-N spectral method, and methods using <a href="Finite-difference_time-domain" title="wikilink">Finite-difference time-domain</a> (FDTD) which are simpler, and model transients.</p>

<p>If implemented correctly, spurious solutions are avoided. It is less efficient when index contrast is high or when metals are incorporated. It cannot be used for scattering analysis.</p>

<p>Being a Fourier-space method, Gibbs phenomenon affects the method's accuracy. This is particularly problematic for devices with high dielectric contrast.</p>
<h2 id="see-also">See also</h2>
<ul>
<li><a href="Photonic_crystal" title="wikilink">Photonic crystal</a></li>
<li><a href="Computational_electromagnetics" title="wikilink">Computational electromagnetics</a></li>
<li><a href="Finite-difference_time-domain_method" title="wikilink">Finite-difference time-domain method</a></li>
<li><a href="Finite_element_method" title="wikilink">Finite element method</a></li>
<li><a href="Maxwell's_equations" title="wikilink">Maxwell's equations</a></li>
<li>See Chapter 5 in <a href="http://etd.fcla.edu/CF/CFE0001159/Rumpf_Raymond_C_200608_PhD.pdf">Design and Optimization of Nano-Optical Elements by Coupling Fabrication to Optical Behavior</a></li>
<li><a href="http://emlab.utep.edu/ee5390cem.htm">Plane Wave Expansion Method (See and listen to lectures 17 and 18)</a></li>
<li><a href="http://emlab.utep.edu/pdfs/Poster_PWEM.pdf">EM Lab Poster on PWEM</a></li>
</ul>
<h2 id="references">References</h2>
<references>
</references>

<p>"</p>

<p><a href="Category:Computational_science" title="wikilink">Category:Computational science</a> <a class="uri" href="Category:Electrodynamics" title="wikilink">Category:Electrodynamics</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1"><a class="uri" href="http://www.ece.nus.edu.sg/stfpage/eleadj/planewave.htm">http://www.ece.nus.edu.sg/stfpage/eleadj/planewave.htm</a><a href="#fnref1">↩</a></li>
</ol>
</section>
</body>
</html>

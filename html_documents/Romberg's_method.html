<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="23">Romberg's method</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Romberg's method</h1>
<style>
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
<style>
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
  </style>
</body></html>
<body>
<hr/>

<p>In <a href="numerical_analysis" title="wikilink">numerical analysis</a>, <strong>Romberg's method</strong>  is used to estimate the <a href="Integral" title="wikilink">definite integral</a></p>

<p>

<math display="block" id="Romberg's_method:0">
 <semantics>
  <mrow>
   <msubsup>
    <mo largeop="true" symmetric="true">∫</mo>
    <mi>a</mi>
    <mi>b</mi>
   </msubsup>
   <mrow>
    <mi>f</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>x</mi>
     <mo rspace="4.2pt" stretchy="false">)</mo>
    </mrow>
    <mi>d</mi>
    <mi>x</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <int></int>
      <ci>a</ci>
     </apply>
     <ci>b</ci>
    </apply>
    <apply>
     <times></times>
     <ci>f</ci>
     <ci>x</ci>
     <ci>d</ci>
     <ci>x</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \int_{a}^{b}f(x)\,dx
  </annotation>
 </semantics>
</math>

</p>

<p>by applying <a href="Richardson_extrapolation" title="wikilink">Richardson extrapolation</a>  repeatedly on the <a href="trapezium_rule" title="wikilink">trapezium rule</a> or the <a href="rectangle_rule" title="wikilink">rectangle rule</a> (midpoint rule). The estimates generate a triangular array. Romberg's method is a <a href="Newton–Cotes_formulas" title="wikilink">Newton–Cotes formula</a> – it evaluates the integrand at equally spaced points. The integrand must have continuous derivatives, though fairly good results may be obtained if only a few derivatives exist. If it is possible to evaluate the integrand at unequally spaced points, then other methods such as <a href="Gaussian_quadrature" title="wikilink">Gaussian quadrature</a> and <a href="Clenshaw–Curtis_quadrature" title="wikilink">Clenshaw–Curtis quadrature</a> are generally more accurate.</p>

<p>The method is named after  (1909–2003), who published the method in 1955.</p>
<h2 id="method">Method</h2>

<p>The method can be defined inductively</p>

<p>

<math display="block" id="Romberg's_method:1">
 <semantics>
  <mrow>
   <mrow>
    <mi>R</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mn>0</mn>
     <mo>,</mo>
     <mn>0</mn>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mfrac>
     <mn>1</mn>
     <mn>2</mn>
    </mfrac>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>b</mi>
      <mo>-</mo>
      <mi>a</mi>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mrow>
       <mi>f</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>a</mi>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
      <mo>+</mo>
      <mrow>
       <mi>f</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>b</mi>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>R</ci>
     <interval closure="open">
      <cn type="integer">0</cn>
      <cn type="integer">0</cn>
     </interval>
    </apply>
    <apply>
     <times></times>
     <apply>
      <divide></divide>
      <cn type="integer">1</cn>
      <cn type="integer">2</cn>
     </apply>
     <apply>
      <minus></minus>
      <ci>b</ci>
      <ci>a</ci>
     </apply>
     <apply>
      <plus></plus>
      <apply>
       <times></times>
       <ci>f</ci>
       <ci>a</ci>
      </apply>
      <apply>
       <times></times>
       <ci>f</ci>
       <ci>b</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   R(0,0)=\frac{1}{2}(b-a)(f(a)+f(b))
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Romberg's_method:2">
 <semantics>
  <mrow>
   <mrow>
    <mi>R</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>n</mi>
     <mo>,</mo>
     <mn>0</mn>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mfrac>
      <mn>1</mn>
      <mn>2</mn>
     </mfrac>
     <mi>R</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mi>n</mi>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
      <mo>,</mo>
      <mn>0</mn>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>+</mo>
    <mrow>
     <msub>
      <mi>h</mi>
      <mi>n</mi>
     </msub>
     <mrow>
      <munderover>
       <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
       <mrow>
        <mi>k</mi>
        <mo>=</mo>
        <mn>1</mn>
       </mrow>
       <msup>
        <mn>2</mn>
        <mrow>
         <mi>n</mi>
         <mo>-</mo>
         <mn>1</mn>
        </mrow>
       </msup>
      </munderover>
      <mrow>
       <mi>f</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mi>a</mi>
         <mo>+</mo>
         <mrow>
          <mrow>
           <mo stretchy="false">(</mo>
           <mrow>
            <mrow>
             <mn>2</mn>
             <mi>k</mi>
            </mrow>
            <mo>-</mo>
            <mn>1</mn>
           </mrow>
           <mo stretchy="false">)</mo>
          </mrow>
          <msub>
           <mi>h</mi>
           <mi>n</mi>
          </msub>
         </mrow>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>R</ci>
     <interval closure="open">
      <ci>n</ci>
      <cn type="integer">0</cn>
     </interval>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <cn type="integer">2</cn>
      </apply>
      <ci>R</ci>
      <interval closure="open">
       <apply>
        <minus></minus>
        <ci>n</ci>
        <cn type="integer">1</cn>
       </apply>
       <cn type="integer">0</cn>
      </interval>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>h</ci>
       <ci>n</ci>
      </apply>
      <apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <sum></sum>
         <apply>
          <eq></eq>
          <ci>k</ci>
          <cn type="integer">1</cn>
         </apply>
        </apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <cn type="integer">2</cn>
         <apply>
          <minus></minus>
          <ci>n</ci>
          <cn type="integer">1</cn>
         </apply>
        </apply>
       </apply>
       <apply>
        <times></times>
        <ci>f</ci>
        <apply>
         <plus></plus>
         <ci>a</ci>
         <apply>
          <times></times>
          <apply>
           <minus></minus>
           <apply>
            <times></times>
            <cn type="integer">2</cn>
            <ci>k</ci>
           </apply>
           <cn type="integer">1</cn>
          </apply>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>h</ci>
           <ci>n</ci>
          </apply>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   R(n,0)=\frac{1}{2}R(n-1,0)+h_{n}\sum_{k=1}^{2^{n-1}}f(a+(2k-1)h_{n})
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Romberg's_method:3">
 <semantics>
  <mrow>
   <mrow>
    <mi>R</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>n</mi>
     <mo>,</mo>
     <mi>m</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mi>R</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>n</mi>
      <mo>,</mo>
      <mrow>
       <mi>m</mi>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>+</mo>
    <mrow>
     <mfrac>
      <mn>1</mn>
      <mrow>
       <msup>
        <mn>4</mn>
        <mi>m</mi>
       </msup>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
     </mfrac>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mrow>
        <mi>R</mi>
        <mrow>
         <mo stretchy="false">(</mo>
         <mi>n</mi>
         <mo>,</mo>
         <mrow>
          <mi>m</mi>
          <mo>-</mo>
          <mn>1</mn>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
       <mo>-</mo>
       <mrow>
        <mi>R</mi>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <mi>n</mi>
          <mo>-</mo>
          <mn>1</mn>
         </mrow>
         <mo>,</mo>
         <mrow>
          <mi>m</mi>
          <mo>-</mo>
          <mn>1</mn>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>R</ci>
     <interval closure="open">
      <ci>n</ci>
      <ci>m</ci>
     </interval>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <ci>R</ci>
      <interval closure="open">
       <ci>n</ci>
       <apply>
        <minus></minus>
        <ci>m</ci>
        <cn type="integer">1</cn>
       </apply>
      </interval>
     </apply>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <apply>
        <minus></minus>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <cn type="integer">4</cn>
         <ci>m</ci>
        </apply>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <apply>
       <minus></minus>
       <apply>
        <times></times>
        <ci>R</ci>
        <interval closure="open">
         <ci>n</ci>
         <apply>
          <minus></minus>
          <ci>m</ci>
          <cn type="integer">1</cn>
         </apply>
        </interval>
       </apply>
       <apply>
        <times></times>
        <ci>R</ci>
        <interval closure="open">
         <apply>
          <minus></minus>
          <ci>n</ci>
          <cn type="integer">1</cn>
         </apply>
         <apply>
          <minus></minus>
          <ci>m</ci>
          <cn type="integer">1</cn>
         </apply>
        </interval>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   R(n,m)=R(n,m-1)+\frac{1}{4^{m}-1}(R(n,m-1)-R(n-1,m-1))
  </annotation>
 </semantics>
</math>

</p>

<p>or</p>

<p>

<math display="block" id="Romberg's_method:4">
 <semantics>
  <mrow>
   <mrow>
    <mi>R</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>n</mi>
     <mo>,</mo>
     <mi>m</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mfrac>
     <mn>1</mn>
     <mrow>
      <msup>
       <mn>4</mn>
       <mi>m</mi>
      </msup>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </mfrac>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mrow>
       <msup>
        <mn>4</mn>
        <mi>m</mi>
       </msup>
       <mi>R</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>n</mi>
        <mo>,</mo>
        <mrow>
         <mi>m</mi>
         <mo>-</mo>
         <mn>1</mn>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
      <mo>-</mo>
      <mrow>
       <mi>R</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mi>n</mi>
         <mo>-</mo>
         <mn>1</mn>
        </mrow>
        <mo>,</mo>
        <mrow>
         <mi>m</mi>
         <mo>-</mo>
         <mn>1</mn>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>R</ci>
     <interval closure="open">
      <ci>n</ci>
      <ci>m</ci>
     </interval>
    </apply>
    <apply>
     <times></times>
     <apply>
      <divide></divide>
      <cn type="integer">1</cn>
      <apply>
       <minus></minus>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <cn type="integer">4</cn>
        <ci>m</ci>
       </apply>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <apply>
      <minus></minus>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <cn type="integer">4</cn>
        <ci>m</ci>
       </apply>
       <ci>R</ci>
       <interval closure="open">
        <ci>n</ci>
        <apply>
         <minus></minus>
         <ci>m</ci>
         <cn type="integer">1</cn>
        </apply>
       </interval>
      </apply>
      <apply>
       <times></times>
       <ci>R</ci>
       <interval closure="open">
        <apply>
         <minus></minus>
         <ci>n</ci>
         <cn type="integer">1</cn>
        </apply>
        <apply>
         <minus></minus>
         <ci>m</ci>
         <cn type="integer">1</cn>
        </apply>
       </interval>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   R(n,m)=\frac{1}{4^{m}-1}(4^{m}R(n,m-1)-R(n-1,m-1))
  </annotation>
 </semantics>
</math>

</p>

<p>where</p>

<p>

<math display="block" id="Romberg's_method:5">
 <semantics>
  <mrow>
   <mi>n</mi>
   <mo>≥</mo>
   <mpadded width="+1.7pt">
    <mi>m</mi>
   </mpadded>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <geq></geq>
    <ci>n</ci>
    <ci>m</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n\geq m\,
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Romberg's_method:6">
 <semantics>
  <mrow>
   <mi>m</mi>
   <mo>≥</mo>
   <mpadded width="+1.7pt">
    <mn>1</mn>
   </mpadded>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <geq></geq>
    <ci>m</ci>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   m\geq 1\,
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Romberg's_method:7">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>h</mi>
     <mi>n</mi>
    </msub>
    <mo>=</mo>
    <mfrac>
     <mrow>
      <mi>b</mi>
      <mo>-</mo>
      <mi>a</mi>
     </mrow>
     <msup>
      <mn>2</mn>
      <mi>n</mi>
     </msup>
    </mfrac>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>h</ci>
     <ci>n</ci>
    </apply>
    <apply>
     <divide></divide>
     <apply>
      <minus></minus>
      <ci>b</ci>
      <ci>a</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <cn type="integer">2</cn>
      <ci>n</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   h_{n}=\frac{b-a}{2^{n}}.
  </annotation>
 </semantics>
</math>

</p>

<p>In <a href="big_O_notation" title="wikilink">big O notation</a>, the error for <em>R</em>(<em>n</em>, <em>m</em>) is :</p>

<p>

<math display="block" id="Romberg's_method:8">
 <semantics>
  <mrow>
   <mrow>
    <mi>O</mi>
    <mrow>
     <mo>(</mo>
     <msubsup>
      <mi>h</mi>
      <mi>n</mi>
      <mrow>
       <mrow>
        <mn>2</mn>
        <mi>m</mi>
       </mrow>
       <mo>+</mo>
       <mn>2</mn>
      </mrow>
     </msubsup>
     <mo>)</mo>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>O</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>h</ci>
      <ci>n</ci>
     </apply>
     <apply>
      <plus></plus>
      <apply>
       <times></times>
       <cn type="integer">2</cn>
       <ci>m</ci>
      </apply>
      <cn type="integer">2</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   O\left(h_{n}^{2m+2}\right).\,
  </annotation>
 </semantics>
</math>

</p>

<p>The zeroeth extrapolation, <em>R</em>(<em>n</em>, 0), is equivalent to the <a href="trapezoidal_rule" title="wikilink">trapezoidal rule</a> with 2<sup><em>n</em></sup> + 1 points; the first extrapolation, <em>R</em>(<em>n</em>, 1), is equivalent to <a href="Simpson's_rule" title="wikilink">Simpson's rule</a> with 2<sup><em>n</em></sup> + 1 points. The second extrapolation, <em>R</em>(<em>n</em>, 2), is equivalent to <a href="Boole's_rule" title="wikilink">Boole's rule</a> with 2<sup><em>n</em></sup> + 1 points. Further extrapolations differ from Newton Cotes formulas. In particular further Romberg extrapolations expand on Boole's rule in very slight ways, modifying weights into ratios similar as in Boole's rule. In contrast, further Newton Cotes methods produce increasingly differing weights, eventually leading to large positive and negative weights. This is indicative of how large degree interpolating polynomial Newton Cotes methods fail to converge for many integrals, while Romberg integration is more stable.</p>

<p>When function evaluations are expensive, it may be preferable to replace the polynomial interpolation of Richardson with the rational interpolation proposed by .</p>
<h2 id="a-geometric-example">A geometric example</h2>

<p>To estimate the area under a curve the trapezoid rule is applied first to one-piece, then two, then four, and so on.</p>

<p> </p>

<p>After trapezoid rule estimates are obtained <a href="Richardson_extrapolation" title="wikilink">Richardson extrapolation</a> is applied</p>
<ul>
<li>For the first iteration the two piece and one piece estimates are used in the formula (4 X (more accurate) - (less accurate))/3 The same formula is then used to compare the four piece and the two piece estimate, and likewise for the higher estimates</li>
</ul>
<ul>
<li>For the second iteration the values of the first iteration are used in the formula (16(more accurate)-less accurate)/15</li>
</ul>
<ul>
<li>The third iteration uses the next power of 4: (64 (More accurate) - less accurate)/63 on the values derived by the second iteration.</li>
</ul>
<ul>
<li>The pattern is continued until there is one estimate.</li>
</ul>
<table>
<tbody>
<tr class="odd">
<td style="text-align: left;">
<p><strong>Number of pieces</strong></p></td>
<td style="text-align: left;">
<p><strong>Trapezoid estimates</strong></p></td>
<td style="text-align: left;">
<p><strong>First iteration</strong></p></td>
<td style="text-align: left;">
<p>'''second iteration</p></td>
<td style="text-align: left;">
<p><strong>third iteration</strong></p></td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;">
<p><strong>(4MA-LA)/3</strong>*</p></td>
<td style="text-align: left;">
<p><strong>(16MA-LA)/15</strong></p></td>
<td style="text-align: left;">
<p><strong>(64MA-LA)/63</strong></p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>1</p></td>
<td style="text-align: left;">
<p>0</p></td>
<td style="text-align: left;">
<p>(4*480-0)/3 = 640</p></td>
<td style="text-align: left;">
<p>(16*880-640)/15 =896</p></td>
<td style="text-align: left;">
<p>(64*1015.11-896)/63 = 1017.002</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>2</p></td>
<td style="text-align: left;">
<p>480</p></td>
<td style="text-align: left;">
<p>(4*780-480)/3 = 880</p></td>
<td style="text-align: left;">
<p>(16*1006.67-880)/15 = 1015.11..</p></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>4</p></td>
<td style="text-align: left;">
<p>780</p></td>
<td style="text-align: left;">
<p>(4*950-780)/3 =1006.666..</p></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>8</p></td>
<td style="text-align: left;">
<p>950</p></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
</tr>
<tr class="even">
</tr>
</tbody>
</table>
<ul>
<li>MA stands for more accurate, LA stands for less accurate</li>
</ul>
<h2 id="example">Example</h2>

<p>As an example, the <a href="Gaussian_function" title="wikilink">Gaussian function</a> is integrated from 0 to 1, i.e. the <a href="error_function" title="wikilink">error function</a> erf(1) ≈ 0.842700792949715. The triangular array is calculated row by row and calculation is terminated if the two last entries in the last row differ less than 10<sup>−8</sup>.</p>
<pre><code><nowiki>
 0.77174333
 0.82526296  0.84310283
 0.83836778  0.84273605  0.84271160
 0.84161922  0.84270304  0.84270083  0.84270066
 0.84243051  0.84270093  0.84270079  0.84270079  0.84270079
</nowiki></code></pre>

<p>The result in the lower right corner of the triangular array is accurate to the digits shown. It is remarkable that this result is derived from the less accurate approximations obtained by the trapezium rule in the first column of the triangular array.</p>
<h2 id="implementation">Implementation</h2>

<p>Here is an example of a computer implementation of the Romberg method (in the <a href="C_programming_language" title="wikilink">C programming language</a>). It needs one vector and one variable, as well as a sub-routine Trap:</p>
<div class="sourceCode"><pre class="sourceCode c"><code class="sourceCode c"> <span class="ot">#include <stdio.h></stdio.h></span>
 <span class="ot">#include <stdlib.h></stdlib.h></span>
 <span class="ot">#include <math.h> </math.h></span>

<span class="dt">int</span> main()
{   
    <span class="dt">const</span> <span class="dt">int</span> MAX = <span class="dv">6</span>;
    <span class="dt">double</span> s[MAX];
    <span class="dt">int</span> i,k;
    <span class="dt">double</span> var ;
    <span class="kw">for</span> (i = <span class="dv">1</span>; i&lt; MAX; i++)
        s[i] = <span class="dv">1</span>;
 
    <span class="kw">for</span> (k=<span class="dv">1</span>; k&lt; MAX; k++)
    {
        <span class="kw">for</span> (i=<span class="dv">1</span>; i &lt;=k; i++)
        {
            <span class="kw">if</span> (i==<span class="dv">1</span>)
            {
                var = s[i];
                s[i] = Trap(<span class="dv">0</span>, <span class="dv">1</span>, pow(<span class="dv">2</span>, k<span class="dv">-1</span>));     <span class="co">// sub-routine Trap</span>
            }                                       <span class="co">// integrated from 0 and 1</span>
                                                    <span class="co">/* pow() is the number of subdivisions*/</span>
            <span class="kw">else</span>
            {
                s[k]= ( pow(<span class="dv">4</span> , i<span class="dv">-1</span>)*s[i<span class="dv">-1</span>]-var )/(pow(<span class="dv">4</span>, i<span class="dv">-1</span>) - <span class="dv">1</span>); 
                                                                 
                var = s[i];
                s[i]= s[k];  
            }
            printf (<span class="st">"  %f  "</span>, s[i]);
        }
        printf (<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>);
    }

    <span class="kw">return</span> <span class="dv">0</span>;
}
</code></pre></div></body>
<h2 id="references">References</h2>
<ul>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
</ul>
<h2 id="external-links">External links</h2>
<ul>
<li>[<a class="uri" href="http://www.mathworks.com/matlabcentral/fileexchange/loadFile.do?objectId=34&amp;objectType">http://www.mathworks.com/matlabcentral/fileexchange/loadFile.do?objectId=34&amp;objectType;</a>;=file ROMBINT] – code for <a class="uri" href="MATLAB" title="wikilink">MATLAB</a> (author: Martin Kacenak)</li>
<li><a href="http://math.fullerton.edu/mathews/n2003/RombergMod.html">Module for Romberg integration</a></li>
<li><a href="http://www.hvks.com/Numerical/webintegration.html">Free online integration tool using Romberg, Fox–Romberg, Gauss–Legendre and other numerical methods</a></li>
</ul>

<p>"</p>

<p><a href="Category:Numerical_integration_(quadrature)" title="wikilink">Category:Numerical integration (quadrature)</a> <a href="Category:Articles_with_example_C_code" title="wikilink">Category:Articles with example C code</a></p>



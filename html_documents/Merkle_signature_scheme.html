<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="1322">Merkle signature scheme</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Merkle signature scheme</h1>
<hr/>

<p>The <strong>Merkle signature scheme</strong> is a <a href="Digital_signature" title="wikilink">digital signature scheme</a> based on <a href="Merkle_tree" title="wikilink">hash trees</a> (also called Merkle trees) and one-time signatures such as the <a href="Lamport_signature" title="wikilink">Lamport signature</a> scheme. It was developed by <a href="Ralph_Merkle" title="wikilink">Ralph Merkle</a> in the late 1970s and is an alternative to traditional digital signatures such as the <a href="Digital_Signature_Algorithm" title="wikilink">Digital Signature Algorithm</a> or <a href="RSA_(algorithm)" title="wikilink">RSA</a>.</p>

<p>The advantage of the Merkle Signature Scheme is that it is believed to be resistant against <a href="quantum_computer" title="wikilink">quantum computer</a> algorithms. The traditional public key algorithms, such as RSA and ELGamal would become insecure in case an effective quantum computer can be built (due to <a href="Shor's_algorithm" title="wikilink">Shor's algorithm</a>). The Merkle Signature Scheme however only depends on the existence of secure <a href="hash_function" title="wikilink">hash functions</a>. This makes the Merkle Signature Scheme very adjustable and resistant to quantum computing.</p>
<h2 id="key-generation">Key generation</h2>

<p> The Merkle Signature Scheme can be used to sign a limited number of messages with one public key 

<math display="inline" id="Merkle_signature_scheme:0">
 <semantics>
  <mrow>
   <mi>p</mi>
   <mi>u</mi>
   <mi>b</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>p</ci>
    <ci>u</ci>
    <ci>b</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   pub
  </annotation>
 </semantics>
</math>

. The number of possible messages must be a power of two, so we denote the possible number of messages as 

<math display="inline" id="Merkle_signature_scheme:1">
 <semantics>
  <mrow>
   <mi>N</mi>
   <mo>=</mo>
   <msup>
    <mn>2</mn>
    <mi>n</mi>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>N</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <cn type="integer">2</cn>
     <ci>n</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   N=2^{n}
  </annotation>
 </semantics>
</math>

.</p>

<p>The first step of generating the public key 

<math display="inline" id="Merkle_signature_scheme:2">
 <semantics>
  <mrow>
   <mi>p</mi>
   <mi>u</mi>
   <mi>b</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>p</ci>
    <ci>u</ci>
    <ci>b</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   pub
  </annotation>
 </semantics>
</math>

 is to generate the public keys 

<math display="inline" id="Merkle_signature_scheme:3">
 <semantics>
  <msub>
   <mi>X</mi>
   <mi>i</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>X</ci>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   X_{i}
  </annotation>
 </semantics>
</math>

 and private keys 

<math display="inline" id="Merkle_signature_scheme:4">
 <semantics>
  <msub>
   <mi>Y</mi>
   <mi>i</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>Y</ci>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Y_{i}
  </annotation>
 </semantics>
</math>

 of 

<math display="inline" id="Merkle_signature_scheme:5">
 <semantics>
  <msup>
   <mn>2</mn>
   <mi>n</mi>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <cn type="integer">2</cn>
    <ci>n</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   2^{n}
  </annotation>
 </semantics>
</math>

 one-time signatures. For each public key 

<math display="inline" id="Merkle_signature_scheme:6">
 <semantics>
  <msub>
   <mi>X</mi>
   <mi>i</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>X</ci>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   X_{i}
  </annotation>
 </semantics>
</math>

, with 

<math display="inline" id="Merkle_signature_scheme:7">
 <semantics>
  <mrow>
   <mn>1</mn>
   <mo>≤</mo>
   <mi>i</mi>
   <mo>≤</mo>
   <msup>
    <mn>2</mn>
    <mi>n</mi>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <leq></leq>
     <cn type="integer">1</cn>
     <ci>i</ci>
    </apply>
    <apply>
     <leq></leq>
     <share href="#.cmml">
     </share>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <cn type="integer">2</cn>
      <ci>n</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   1\leq i\leq 2^{n}
  </annotation>
 </semantics>
</math>

, a hash value 

<math display="inline" id="Merkle_signature_scheme:8">
 <semantics>
  <mrow>
   <msub>
    <mi>h</mi>
    <mi>i</mi>
   </msub>
   <mo>=</mo>
   <msub>
    <mi>X</mi>
    <mi>i</mi>
   </msub>
   <mo>=</mo>
   <mrow>
    <mi>H</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <msub>
      <mi>Y</mi>
      <mi>i</mi>
     </msub>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>h</ci>
      <ci>i</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>X</ci>
      <ci>i</ci>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <ci>H</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>Y</ci>
       <ci>i</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   h_{i}=X_{i}=H(Y_{i})
  </annotation>
 </semantics>
</math>

 is computed. With these hash values 

<math display="inline" id="Merkle_signature_scheme:9">
 <semantics>
  <msub>
   <mi>h</mi>
   <mi>i</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>h</ci>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   h_{i}
  </annotation>
 </semantics>
</math>

 a <a href="Merkle_tree" title="wikilink">hash tree</a> is built.</p>

<p>Each node of the tree is represented as 

<math display="inline" id="Merkle_signature_scheme:10">
 <semantics>
  <msub>
   <mi>a</mi>
   <mrow>
    <mi>i</mi>
    <mo>,</mo>
    <mi>j</mi>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>a</ci>
    <list>
     <ci>i</ci>
     <ci>j</ci>
    </list>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a_{i,j}
  </annotation>
 </semantics>
</math>

, where 

<math display="inline" id="Merkle_signature_scheme:11">
 <semantics>
  <mi>i</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>i</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   i
  </annotation>
 </semantics>
</math>

 denotes the height of the node and 

<math display="inline" id="Merkle_signature_scheme:12">
 <semantics>
  <mi>j</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>j</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   j
  </annotation>
 </semantics>
</math>

 denotes the left-to-right position of the node. The height of a node is defined as the distance from the node to a leaf. Hence, a leaf of the tree has height 

<math display="inline" id="Merkle_signature_scheme:13">
 <semantics>
  <mrow>
   <mi>i</mi>
   <mo>=</mo>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>i</ci>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   i=0
  </annotation>
 </semantics>
</math>

 and the root has height 

<math display="inline" id="Merkle_signature_scheme:14">
 <semantics>
  <mrow>
   <mi>i</mi>
   <mo>=</mo>
   <mi>n</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>i</ci>
    <ci>n</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   i=n
  </annotation>
 </semantics>
</math>

. Nodes with the same height are numbered from left to right, so 

<math display="inline" id="Merkle_signature_scheme:15">
 <semantics>
  <msub>
   <mi>a</mi>
   <mrow>
    <mi>i</mi>
    <mo>,</mo>
    <mn>0</mn>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>a</ci>
    <list>
     <ci>i</ci>
     <cn type="integer">0</cn>
    </list>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a_{i,0}
  </annotation>
 </semantics>
</math>

 is the leftmost node of level 

<math display="inline" id="Merkle_signature_scheme:16">
 <semantics>
  <mi>i</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>i</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   i
  </annotation>
 </semantics>
</math>

.</p>

<p>In the Merkle Tree the hash values 

<math display="inline" id="Merkle_signature_scheme:17">
 <semantics>
  <msub>
   <mi>h</mi>
   <mi>i</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>h</ci>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   h_{i}
  </annotation>
 </semantics>
</math>

 are the leaves of a binary tree, so that 

<math display="inline" id="Merkle_signature_scheme:18">
 <semantics>
  <mrow>
   <msub>
    <mi>h</mi>
    <mi>i</mi>
   </msub>
   <mo>=</mo>
   <msub>
    <mi>a</mi>
    <mrow>
     <mn>0</mn>
     <mo>,</mo>
     <mi>i</mi>
    </mrow>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>h</ci>
     <ci>i</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>a</ci>
     <list>
      <cn type="integer">0</cn>
      <ci>i</ci>
     </list>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   h_{i}=a_{0,i}
  </annotation>
 </semantics>
</math>

. Each inner node of the tree is the hash value of the concatenation of its two children. For example 

<math display="inline" id="Merkle_signature_scheme:19">
 <semantics>
  <mrow>
   <msub>
    <mi>a</mi>
    <mrow>
     <mn>1</mn>
     <mo>,</mo>
     <mn>0</mn>
    </mrow>
   </msub>
   <mo>=</mo>
   <mi>H</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>a</mi>
     <mrow>
      <mn>0</mn>
      <mo>,</mo>
      <mn>0</mn>
     </mrow>
    </msub>
    <mo stretchy="false">|</mo>
    <mo stretchy="false">|</mo>
    <msub>
     <mi>a</mi>
     <mrow>
      <mn>0</mn>
      <mo>,</mo>
      <mn>1</mn>
     </mrow>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>a</ci>
     <list>
      <cn type="integer">1</cn>
      <cn type="integer">0</cn>
     </list>
    </apply>
    <eq></eq>
    <csymbol cd="unknown">H</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>a</ci>
      <list>
       <cn type="integer">0</cn>
       <cn type="integer">0</cn>
      </list>
     </apply>
     <ci>normal-|</ci>
     <ci>normal-|</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>a</ci>
      <list>
       <cn type="integer">0</cn>
       <cn type="integer">1</cn>
      </list>
     </apply>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a_{1,0}=H(a_{0,0}||a_{0,1})
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Merkle_signature_scheme:20">
 <semantics>
  <mrow>
   <msub>
    <mi>a</mi>
    <mrow>
     <mn>2</mn>
     <mo>,</mo>
     <mn>0</mn>
    </mrow>
   </msub>
   <mo>=</mo>
   <mi>H</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>a</mi>
     <mrow>
      <mn>1</mn>
      <mo>,</mo>
      <mn>0</mn>
     </mrow>
    </msub>
    <mo stretchy="false">|</mo>
    <mo stretchy="false">|</mo>
    <msub>
     <mi>a</mi>
     <mrow>
      <mn>1</mn>
      <mo>,</mo>
      <mn>1</mn>
     </mrow>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>a</ci>
     <list>
      <cn type="integer">2</cn>
      <cn type="integer">0</cn>
     </list>
    </apply>
    <eq></eq>
    <csymbol cd="unknown">H</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>a</ci>
      <list>
       <cn type="integer">1</cn>
       <cn type="integer">0</cn>
      </list>
     </apply>
     <ci>normal-|</ci>
     <ci>normal-|</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>a</ci>
      <list>
       <cn type="integer">1</cn>
       <cn type="integer">1</cn>
      </list>
     </apply>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a_{2,0}=H(a_{1,0}||a_{1,1})
  </annotation>
 </semantics>
</math>

.</p>

<p>In this way, a tree with 

<math display="inline" id="Merkle_signature_scheme:21">
 <semantics>
  <msup>
   <mn>2</mn>
   <mi>n</mi>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <cn type="integer">2</cn>
    <ci>n</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   2^{n}
  </annotation>
 </semantics>
</math>

 leaves and 

<math display="inline" id="Merkle_signature_scheme:22">
 <semantics>
  <mrow>
   <msup>
    <mn>2</mn>
    <mrow>
     <mi>n</mi>
     <mo>+</mo>
     <mn>1</mn>
    </mrow>
   </msup>
   <mo>-</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <minus></minus>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <cn type="integer">2</cn>
     <apply>
      <plus></plus>
      <ci>n</ci>
      <cn type="integer">1</cn>
     </apply>
    </apply>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   2^{n+1}-1
  </annotation>
 </semantics>
</math>

 nodes is built. The root of the tree, 

<math display="inline" id="Merkle_signature_scheme:23">
 <semantics>
  <msub>
   <mi>a</mi>
   <mrow>
    <mi>n</mi>
    <mo>,</mo>
    <mn>0</mn>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>a</ci>
    <list>
     <ci>n</ci>
     <cn type="integer">0</cn>
    </list>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a_{n,0}
  </annotation>
 </semantics>
</math>

, is the public key 

<math display="inline" id="Merkle_signature_scheme:24">
 <semantics>
  <mrow>
   <mi>p</mi>
   <mi>u</mi>
   <mi>b</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>p</ci>
    <ci>u</ci>
    <ci>b</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   pub
  </annotation>
 </semantics>
</math>

 of the Merkle Signature Scheme.</p>
<h2 id="signature-generation">Signature generation</h2>

<p> To sign a message 

<math display="inline" id="Merkle_signature_scheme:25">
 <semantics>
  <mi>M</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>M</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   M
  </annotation>
 </semantics>
</math>

 with the Merkle Signature Scheme, the message 

<math display="inline" id="Merkle_signature_scheme:26">
 <semantics>
  <mi>M</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>M</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   M
  </annotation>
 </semantics>
</math>

 is signed with a one-time signature scheme, resulting in a signature 

<math display="inline" id="Merkle_signature_scheme:27">
 <semantics>
  <mrow>
   <mi>s</mi>
   <mi>i</mi>
   <msup>
    <mi>g</mi>
    <mo>′</mo>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>s</ci>
    <ci>i</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>g</ci>
     <ci>normal-′</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   sig^{\prime}
  </annotation>
 </semantics>
</math>

, first. This is done, by using one of the public and private key pairs 

<math display="inline" id="Merkle_signature_scheme:28">
 <semantics>
  <mrow>
   <mo stretchy="false">(</mo>
   <msub>
    <mi>X</mi>
    <mi>i</mi>
   </msub>
   <mo>,</mo>
   <msub>
    <mi>Y</mi>
    <mi>i</mi>
   </msub>
   <mo>,</mo>
   <mo stretchy="false">)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <ci>normal-(</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>X</ci>
     <ci>i</ci>
    </apply>
    <ci>normal-,</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>Y</ci>
     <ci>i</ci>
    </apply>
    <ci>normal-,</ci>
    <ci>normal-)</ci>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (X_{i},Y_{i},)
  </annotation>
 </semantics>
</math>

. [Need to define computation of 

<math display="inline" id="Merkle_signature_scheme:29">
 <semantics>
  <mrow>
   <mi>s</mi>
   <mi>i</mi>
   <msup>
    <mi>g</mi>
    <mo>′</mo>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>s</ci>
    <ci>i</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>g</ci>
     <ci>normal-′</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   sig^{\prime}
  </annotation>
 </semantics>
</math>

]</p>

<p>The corresponding leaf of the hash tree to a one-time public key 

<math display="inline" id="Merkle_signature_scheme:30">
 <semantics>
  <msub>
   <mi>X</mi>
   <mi>i</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>X</ci>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   X_{i}
  </annotation>
 </semantics>
</math>

 is 

<math display="inline" id="Merkle_signature_scheme:31">
 <semantics>
  <mrow>
   <msub>
    <mi>a</mi>
    <mrow>
     <mn>0</mn>
     <mo>,</mo>
     <mi>i</mi>
    </mrow>
   </msub>
   <mo>=</mo>
   <mrow>
    <mi>H</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <msub>
      <mi>X</mi>
      <mi>i</mi>
     </msub>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>a</ci>
     <list>
      <cn type="integer">0</cn>
      <ci>i</ci>
     </list>
    </apply>
    <apply>
     <times></times>
     <ci>H</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>X</ci>
      <ci>i</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a_{0,i}=H(X_{i})
  </annotation>
 </semantics>
</math>

. We call the path in the hash tree from 

<math display="inline" id="Merkle_signature_scheme:32">
 <semantics>
  <msub>
   <mi>a</mi>
   <mrow>
    <mn>0</mn>
    <mo>,</mo>
    <mi>i</mi>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>a</ci>
    <list>
     <cn type="integer">0</cn>
     <ci>i</ci>
    </list>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a_{0,i}
  </annotation>
 </semantics>
</math>

 to the root 

<math display="inline" id="Merkle_signature_scheme:33">
 <semantics>
  <mi>A</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>A</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A
  </annotation>
 </semantics>
</math>

. The path 

<math display="inline" id="Merkle_signature_scheme:34">
 <semantics>
  <mi>A</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>A</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A
  </annotation>
 </semantics>
</math>

 consists of 

<math display="inline" id="Merkle_signature_scheme:35">
 <semantics>
  <mrow>
   <mi>n</mi>
   <mo>+</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <plus></plus>
    <ci>n</ci>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n+1
  </annotation>
 </semantics>
</math>

 nodes, 

<math display="inline" id="Merkle_signature_scheme:36">
 <semantics>
  <mrow>
   <msub>
    <mi>A</mi>
    <mn>0</mn>
   </msub>
   <mo>,</mo>
   <mrow>
    <mi mathvariant="normal">…</mi>
    <msub>
     <mi>A</mi>
     <mi>n</mi>
    </msub>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <list>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>A</ci>
     <cn type="integer">0</cn>
    </apply>
    <apply>
     <times></times>
     <ci>normal-…</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>A</ci>
      <ci>n</ci>
     </apply>
    </apply>
   </list>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A_{0},...A_{n}
  </annotation>
 </semantics>
</math>

, with 

<math display="inline" id="Merkle_signature_scheme:37">
 <semantics>
  <mrow>
   <msub>
    <mi>A</mi>
    <mn>0</mn>
   </msub>
   <mo>=</mo>
   <msub>
    <mi>a</mi>
    <mrow>
     <mn>0</mn>
     <mo>,</mo>
     <mi>i</mi>
    </mrow>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>A</ci>
     <cn type="integer">0</cn>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>a</ci>
     <list>
      <cn type="integer">0</cn>
      <ci>i</ci>
     </list>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A_{0}=a_{0,i}
  </annotation>
 </semantics>
</math>

 being the leaf and 

<math display="inline" id="Merkle_signature_scheme:38">
 <semantics>
  <mrow>
   <msub>
    <mi>A</mi>
    <mi>n</mi>
   </msub>
   <mo>=</mo>
   <msub>
    <mi>a</mi>
    <mrow>
     <mi>n</mi>
     <mo>,</mo>
     <mn>0</mn>
    </mrow>
   </msub>
   <mo>=</mo>
   <mrow>
    <mi>p</mi>
    <mi>u</mi>
    <mi>b</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>A</ci>
      <ci>n</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>a</ci>
      <list>
       <ci>n</ci>
       <cn type="integer">0</cn>
      </list>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <ci>p</ci>
      <ci>u</ci>
      <ci>b</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A_{n}=a_{n,0}=pub
  </annotation>
 </semantics>
</math>

 being the root of the tree. To compute this path 

<math display="inline" id="Merkle_signature_scheme:39">
 <semantics>
  <mi>A</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>A</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A
  </annotation>
 </semantics>
</math>

, we need every child of the nodes 

<math display="inline" id="Merkle_signature_scheme:40">
 <semantics>
  <mrow>
   <msub>
    <mi>A</mi>
    <mn>1</mn>
   </msub>
   <mo>,</mo>
   <mi mathvariant="normal">…</mi>
   <mo>,</mo>
   <msub>
    <mi>A</mi>
    <mi>n</mi>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <list>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>A</ci>
     <cn type="integer">1</cn>
    </apply>
    <ci>normal-…</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>A</ci>
     <ci>n</ci>
    </apply>
   </list>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A_{1},...,A_{n}
  </annotation>
 </semantics>
</math>

. We know that 

<math display="inline" id="Merkle_signature_scheme:41">
 <semantics>
  <msub>
   <mi>A</mi>
   <mi>i</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>A</ci>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A_{i}
  </annotation>
 </semantics>
</math>

 is a child of 

<math display="inline" id="Merkle_signature_scheme:42">
 <semantics>
  <msub>
   <mi>A</mi>
   <mrow>
    <mi>i</mi>
    <mo>+</mo>
    <mn>1</mn>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>A</ci>
    <apply>
     <plus></plus>
     <ci>i</ci>
     <cn type="integer">1</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A_{i+1}
  </annotation>
 </semantics>
</math>

. To calculate the next node 

<math display="inline" id="Merkle_signature_scheme:43">
 <semantics>
  <msub>
   <mi>A</mi>
   <mrow>
    <mi>i</mi>
    <mo>+</mo>
    <mn>1</mn>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>A</ci>
    <apply>
     <plus></plus>
     <ci>i</ci>
     <cn type="integer">1</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A_{i+1}
  </annotation>
 </semantics>
</math>

 of the path 

<math display="inline" id="Merkle_signature_scheme:44">
 <semantics>
  <mi>A</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>A</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A
  </annotation>
 </semantics>
</math>

, we need to know both children of 

<math display="inline" id="Merkle_signature_scheme:45">
 <semantics>
  <msub>
   <mi>A</mi>
   <mrow>
    <mi>i</mi>
    <mo>+</mo>
    <mn>1</mn>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>A</ci>
    <apply>
     <plus></plus>
     <ci>i</ci>
     <cn type="integer">1</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A_{i+1}
  </annotation>
 </semantics>
</math>

. So we need the brother node of 

<math display="inline" id="Merkle_signature_scheme:46">
 <semantics>
  <msub>
   <mi>A</mi>
   <mi>i</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>A</ci>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A_{i}
  </annotation>
 </semantics>
</math>

. We call this node 

<math display="inline" id="Merkle_signature_scheme:47">
 <semantics>
  <mrow>
   <mi>a</mi>
   <mi>u</mi>
   <mi>t</mi>
   <msub>
    <mi>h</mi>
    <mi>i</mi>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>a</ci>
    <ci>u</ci>
    <ci>t</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>h</ci>
     <ci>i</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   auth_{i}
  </annotation>
 </semantics>
</math>

, so that 

<math display="inline" id="Merkle_signature_scheme:48">
 <semantics>
  <mrow>
   <msub>
    <mi>A</mi>
    <mrow>
     <mi>i</mi>
     <mo>+</mo>
     <mn>1</mn>
    </mrow>
   </msub>
   <mo>=</mo>
   <mi>H</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>A</mi>
     <mi>i</mi>
    </msub>
    <mo stretchy="false">|</mo>
    <mo stretchy="false">|</mo>
    <mi>a</mi>
    <mi>u</mi>
    <mi>t</mi>
    <msub>
     <mi>h</mi>
     <mi>i</mi>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>A</ci>
     <apply>
      <plus></plus>
      <ci>i</ci>
      <cn type="integer">1</cn>
     </apply>
    </apply>
    <eq></eq>
    <csymbol cd="unknown">H</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>A</ci>
      <ci>i</ci>
     </apply>
     <ci>normal-|</ci>
     <ci>normal-|</ci>
     <csymbol cd="unknown">a</csymbol>
     <csymbol cd="unknown">u</csymbol>
     <csymbol cd="unknown">t</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>h</ci>
      <ci>i</ci>
     </apply>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A_{i+1}=H(A_{i}||auth_{i})
  </annotation>
 </semantics>
</math>

. Hence, 

<math display="inline" id="Merkle_signature_scheme:49">
 <semantics>
  <mi>n</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>n</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n
  </annotation>
 </semantics>
</math>

 nodes 

<math display="inline" id="Merkle_signature_scheme:50">
 <semantics>
  <mrow>
   <mrow>
    <mi>a</mi>
    <mi>u</mi>
    <mi>t</mi>
    <msub>
     <mi>h</mi>
     <mn>0</mn>
    </msub>
   </mrow>
   <mo>,</mo>
   <mi mathvariant="normal">…</mi>
   <mo>,</mo>
   <mrow>
    <mi>a</mi>
    <mi>u</mi>
    <mi>t</mi>
    <msub>
     <mi>h</mi>
     <mrow>
      <mi>n</mi>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </msub>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <list>
    <apply>
     <times></times>
     <ci>a</ci>
     <ci>u</ci>
     <ci>t</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>h</ci>
      <cn type="integer">0</cn>
     </apply>
    </apply>
    <ci>normal-…</ci>
    <apply>
     <times></times>
     <ci>a</ci>
     <ci>u</ci>
     <ci>t</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>h</ci>
      <apply>
       <minus></minus>
       <ci>n</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
    </apply>
   </list>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   auth_{0},...,auth_{n-1}
  </annotation>
 </semantics>
</math>

 are needed, to compute every node of the path 

<math display="inline" id="Merkle_signature_scheme:51">
 <semantics>
  <mi>A</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>A</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A
  </annotation>
 </semantics>
</math>

. We now calculate and save these nodes 

<math display="inline" id="Merkle_signature_scheme:52">
 <semantics>
  <mrow>
   <mrow>
    <mi>a</mi>
    <mi>u</mi>
    <mi>t</mi>
    <msub>
     <mi>h</mi>
     <mn>0</mn>
    </msub>
   </mrow>
   <mo>,</mo>
   <mi mathvariant="normal">…</mi>
   <mo>,</mo>
   <mrow>
    <mi>a</mi>
    <mi>u</mi>
    <mi>t</mi>
    <msub>
     <mi>h</mi>
     <mrow>
      <mi>n</mi>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </msub>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <list>
    <apply>
     <times></times>
     <ci>a</ci>
     <ci>u</ci>
     <ci>t</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>h</ci>
      <cn type="integer">0</cn>
     </apply>
    </apply>
    <ci>normal-…</ci>
    <apply>
     <times></times>
     <ci>a</ci>
     <ci>u</ci>
     <ci>t</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>h</ci>
      <apply>
       <minus></minus>
       <ci>n</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
    </apply>
   </list>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   auth_{0},...,auth_{n-1}
  </annotation>
 </semantics>
</math>

.</p>

<p>These nodes, plus the one-time signature 

<math display="inline" id="Merkle_signature_scheme:53">
 <semantics>
  <mrow>
   <mi>s</mi>
   <mi>i</mi>
   <msup>
    <mi>g</mi>
    <mo>′</mo>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>s</ci>
    <ci>i</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>g</ci>
     <ci>normal-′</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   sig^{\prime}
  </annotation>
 </semantics>
</math>

 of 

<math display="inline" id="Merkle_signature_scheme:54">
 <semantics>
  <mi>M</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>M</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   M
  </annotation>
 </semantics>
</math>

 is the signature 

<math display="inline" id="Merkle_signature_scheme:55">
 <semantics>
  <mrow>
   <mrow>
    <mi>s</mi>
    <mi>i</mi>
    <mi>g</mi>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mo stretchy="false">(</mo>
    <mrow>
     <mi>s</mi>
     <mi>i</mi>
     <msup>
      <mi>g</mi>
      <mo>′</mo>
     </msup>
     <mrow>
      <mo fence="true">||</mo>
      <mrow>
       <mi>a</mi>
       <mi>u</mi>
       <mi>t</mi>
       <msub>
        <mi>h</mi>
        <mn>0</mn>
       </msub>
      </mrow>
      <mo fence="true">||</mo>
     </mrow>
     <mi>a</mi>
     <mi>u</mi>
     <mi>t</mi>
     <msub>
      <mi>h</mi>
      <mn>1</mn>
     </msub>
     <mrow>
      <mo fence="true">||</mo>
      <mi mathvariant="normal">…</mi>
      <mo fence="true">||</mo>
     </mrow>
     <mi>a</mi>
     <mi>u</mi>
     <mi>t</mi>
     <msub>
      <mi>h</mi>
      <mrow>
       <mi>n</mi>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
     </msub>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>s</ci>
     <ci>i</ci>
     <ci>g</ci>
    </apply>
    <apply>
     <times></times>
     <ci>s</ci>
     <ci>i</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>g</ci>
      <ci>normal-′</ci>
     </apply>
     <apply>
      <csymbol cd="latexml">norm</csymbol>
      <apply>
       <times></times>
       <ci>a</ci>
       <ci>u</ci>
       <ci>t</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>h</ci>
        <cn type="integer">0</cn>
       </apply>
      </apply>
     </apply>
     <ci>a</ci>
     <ci>u</ci>
     <ci>t</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>h</ci>
      <cn type="integer">1</cn>
     </apply>
     <apply>
      <csymbol cd="latexml">norm</csymbol>
      <ci>normal-…</ci>
     </apply>
     <ci>a</ci>
     <ci>u</ci>
     <ci>t</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>h</ci>
      <apply>
       <minus></minus>
       <ci>n</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   sig=(sig^{\prime}||auth_{0}||auth_{1}||...||auth_{n-1})
  </annotation>
 </semantics>
</math>

 of the Merkle Signature Scheme. An example of an authentication path is illustrated in the figure on the right.</p>
<h2 id="signature-verification">Signature verification</h2>

<p>The receiver knows the public key 

<math display="inline" id="Merkle_signature_scheme:56">
 <semantics>
  <mrow>
   <mi>p</mi>
   <mi>u</mi>
   <mi>b</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>p</ci>
    <ci>u</ci>
    <ci>b</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   pub
  </annotation>
 </semantics>
</math>

, the message 

<math display="inline" id="Merkle_signature_scheme:57">
 <semantics>
  <mi>M</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>M</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   M
  </annotation>
 </semantics>
</math>

, and the signature 

<math display="inline" id="Merkle_signature_scheme:58">
 <semantics>
  <mrow>
   <mrow>
    <mi>s</mi>
    <mi>i</mi>
    <mi>g</mi>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mo stretchy="false">(</mo>
    <mrow>
     <mi>s</mi>
     <mi>i</mi>
     <msup>
      <mi>g</mi>
      <mo>′</mo>
     </msup>
     <mrow>
      <mo fence="true">||</mo>
      <mrow>
       <mi>a</mi>
       <mi>u</mi>
       <mi>t</mi>
       <msub>
        <mi>h</mi>
        <mn>0</mn>
       </msub>
      </mrow>
      <mo fence="true">||</mo>
     </mrow>
     <mi>a</mi>
     <mi>u</mi>
     <mi>t</mi>
     <msub>
      <mi>h</mi>
      <mn>1</mn>
     </msub>
     <mrow>
      <mo fence="true">||</mo>
      <mi mathvariant="normal">…</mi>
      <mo fence="true">||</mo>
     </mrow>
     <mi>a</mi>
     <mi>u</mi>
     <mi>t</mi>
     <msub>
      <mi>h</mi>
      <mrow>
       <mi>n</mi>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
     </msub>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>s</ci>
     <ci>i</ci>
     <ci>g</ci>
    </apply>
    <apply>
     <times></times>
     <ci>s</ci>
     <ci>i</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>g</ci>
      <ci>normal-′</ci>
     </apply>
     <apply>
      <csymbol cd="latexml">norm</csymbol>
      <apply>
       <times></times>
       <ci>a</ci>
       <ci>u</ci>
       <ci>t</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>h</ci>
        <cn type="integer">0</cn>
       </apply>
      </apply>
     </apply>
     <ci>a</ci>
     <ci>u</ci>
     <ci>t</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>h</ci>
      <cn type="integer">1</cn>
     </apply>
     <apply>
      <csymbol cd="latexml">norm</csymbol>
      <ci>normal-…</ci>
     </apply>
     <ci>a</ci>
     <ci>u</ci>
     <ci>t</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>h</ci>
      <apply>
       <minus></minus>
       <ci>n</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   sig=(sig^{\prime}||auth_{0}||auth_{1}||...||auth_{n-1})
  </annotation>
 </semantics>
</math>

. At first, the receiver verifies the one-time signature 

<math display="inline" id="Merkle_signature_scheme:59">
 <semantics>
  <mrow>
   <mi>s</mi>
   <mi>i</mi>
   <msup>
    <mi>g</mi>
    <mo>′</mo>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>s</ci>
    <ci>i</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>g</ci>
     <ci>normal-′</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   sig^{\prime}
  </annotation>
 </semantics>
</math>

 of the message 

<math display="inline" id="Merkle_signature_scheme:60">
 <semantics>
  <mi>M</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>M</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   M
  </annotation>
 </semantics>
</math>

. If 

<math display="inline" id="Merkle_signature_scheme:61">
 <semantics>
  <mrow>
   <mi>s</mi>
   <mi>i</mi>
   <msup>
    <mi>g</mi>
    <mo>′</mo>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>s</ci>
    <ci>i</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>g</ci>
     <ci>normal-′</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   sig^{\prime}
  </annotation>
 </semantics>
</math>

 is a valid signature of 

<math display="inline" id="Merkle_signature_scheme:62">
 <semantics>
  <mi>M</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>M</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   M
  </annotation>
 </semantics>
</math>

, the receiver computes 

<math display="inline" id="Merkle_signature_scheme:63">
 <semantics>
  <mrow>
   <msub>
    <mi>A</mi>
    <mn>0</mn>
   </msub>
   <mo>=</mo>
   <mrow>
    <mi>H</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <msub>
      <mi>X</mi>
      <mi>i</mi>
     </msub>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>A</ci>
     <cn type="integer">0</cn>
    </apply>
    <apply>
     <times></times>
     <ci>H</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>X</ci>
      <ci>i</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A_{0}=H(X_{i})
  </annotation>
 </semantics>
</math>

 by hashing the public key of the one-time signature. For 

<math display="inline" id="Merkle_signature_scheme:64">
 <semantics>
  <mrow>
   <mi>j</mi>
   <mo>=</mo>
   <mn>1</mn>
   <mo>,</mo>
   <mo>.</mo>
   <mo>.</mo>
   <mo>,</mo>
   <mi>n</mi>
   <mo>-</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">j</csymbol>
    <eq></eq>
    <cn type="integer">1</cn>
    <ci>normal-,</ci>
    <ci>normal-.</ci>
    <ci>normal-.</ci>
    <ci>normal-,</ci>
    <csymbol cd="unknown">n</csymbol>
    <minus></minus>
    <cn type="integer">1</cn>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   j=1,..,n-1
  </annotation>
 </semantics>
</math>

, the nodes of 

<math display="inline" id="Merkle_signature_scheme:65">
 <semantics>
  <msub>
   <mi>A</mi>
   <mi>j</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>A</ci>
    <ci>j</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A_{j}
  </annotation>
 </semantics>
</math>

 of the path 

<math display="inline" id="Merkle_signature_scheme:66">
 <semantics>
  <mi>A</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>A</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A
  </annotation>
 </semantics>
</math>

 are computed with 

<math display="inline" id="Merkle_signature_scheme:67">
 <semantics>
  <mrow>
   <msub>
    <mi>A</mi>
    <mi>j</mi>
   </msub>
   <mo>=</mo>
   <mi>H</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>A</mi>
     <mrow>
      <mi>j</mi>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </msub>
    <mo stretchy="false">|</mo>
    <mo stretchy="false">|</mo>
    <mi>a</mi>
    <mi>u</mi>
    <mi>t</mi>
    <msub>
     <mi>h</mi>
     <mrow>
      <mi>j</mi>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>A</ci>
     <ci>j</ci>
    </apply>
    <eq></eq>
    <csymbol cd="unknown">H</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>A</ci>
      <apply>
       <minus></minus>
       <ci>j</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <ci>normal-|</ci>
     <ci>normal-|</ci>
     <csymbol cd="unknown">a</csymbol>
     <csymbol cd="unknown">u</csymbol>
     <csymbol cd="unknown">t</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>h</ci>
      <apply>
       <minus></minus>
       <ci>j</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A_{j}=H(A_{j-1}||auth_{j-1})
  </annotation>
 </semantics>
</math>

. If 

<math display="inline" id="Merkle_signature_scheme:68">
 <semantics>
  <msub>
   <mi>A</mi>
   <mi>n</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>A</ci>
    <ci>n</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A_{n}
  </annotation>
 </semantics>
</math>

 equals the public key 

<math display="inline" id="Merkle_signature_scheme:69">
 <semantics>
  <mrow>
   <mi>p</mi>
   <mi>u</mi>
   <mi>b</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>p</ci>
    <ci>u</ci>
    <ci>b</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   pub
  </annotation>
 </semantics>
</math>

 of the merkle signature scheme, the signature is valid.</p>
<h2 id="references">References</h2>
<ul>
<li>G. Becker. "Merkle Signature Schemes, Merkle Trees and Their Cryptanalysis", seminar 'Post Quantum Cryptology' at the Ruhr-University Bochum, Germany.</li>
<li>E. Dahmen, M. Dring, E. Klintsevich, J. Buchmann, L.C. Coronado Garca. "CMSS - an improved merkle signature scheme". Progress in Cryptology - Indocrypt 2006, 2006.</li>
<li>E. Klintsevich, K. Okeya, C.Vuillaume, J. Buchmann, E.Dahmen. "Merkle signatures with virtually unlimited signature capacity". 5th International Conference on Applied Cryptography and Network Security - ACNS07, 2007.</li>
<li>Ralph Merkle. "Secrecy, authentication and public key systems / A certified digital signature". Ph.D. dissertation, Dept. of Electrical Engineering, Stanford University, 1979. <a href="http://www.merkle.com/papers/Thesis1979.pdf">1</a></li>
<li>S. Micali, M. Jakobsson, T. Leighton, M. Szydlo. "Fractal merkle tree representation and traversal". RSA-CT 03, 2003</li>
</ul>
<h2 id="external-links">External links</h2>
<ul>
<li><a href="http://www.emc.com/emc-plus/rsa-labs/historical/recent-improvements-efficient-use-merkle-trees.htm">Efficient Use of Merkle Trees</a> - <a href="RSA_Security" title="wikilink">RSA labs</a> explanation of the original purpose of Merkle trees + Lamport signatures, as an efficient one-time signature scheme.</li>
</ul>

<p>"</p>

<p><a href="Category:Digital_signature_schemes" title="wikilink">Category:Digital signature schemes</a> <a href="Category:Hash-based_cryptography" title="wikilink">Category:Hash-based cryptography</a></p>
</body>
</html>

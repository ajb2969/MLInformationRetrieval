<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="1203">Linear least squares (mathematics)</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Linear least squares (mathematics)</h1>
<style>
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
<style>
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
  </style>
</body></html>
<body>
<hr/>

<p>In <a class="uri" href="statistics" title="wikilink">statistics</a> and <a class="uri" href="mathematics" title="wikilink">mathematics</a>, <strong>linear least squares</strong> is an approach fitting a <a href="mathematical_model" title="wikilink">mathematical</a> or <a href="statistical_model" title="wikilink">statistical model</a> to <a class="uri" href="data" title="wikilink">data</a> in cases where the idealized value provided by the model for any data point is expressed linearly in terms of the unknown <a href="parameter" title="wikilink">parameters</a> of the model. The resulting fitted model can be used to <a href="descriptive_statistics" title="wikilink">summarize</a> the data, to <a href="prediction" title="wikilink">predict</a> unobserved values from the same system, and to understand the mechanisms that may underlie the system.</p>

<p>Mathematically, linear least squares is the problem of approximately solving an <a href="overdetermined_system" title="wikilink">overdetermined system</a> of linear equations, where the best approximation is defined as that which minimizes the sum of squared differences between the data values and their corresponding modeled values. The approach is called "linear" least squares since the assumed function is linear in the parameters to be estimated. Linear least squares problems are <a href="Convex_function" title="wikilink">convex</a> and have a <a href="closed-form_expression" title="wikilink">closed-form solution</a> that is unique, provided that the number of data points used for fitting equals or exceeds the number of unknown parameters, except in special degenerate situations. In contrast, <a href="non-linear_least_squares" title="wikilink">non-linear least squares</a> problems generally must be solved by an <a href="iterative_method" title="wikilink">iterative procedure</a>, and the problems can be non-convex with multiple optima for the objective function. If prior distributions are available, then even an underdetermined system can be solved using the <a href="Minimum_mean_square_error" title="wikilink">Bayesian MMSE estimator</a>.</p>

<p>In statistics, linear least squares problems correspond to a particularly important type of <a href="statistical_model" title="wikilink">statistical model</a> called <a href="linear_regression" title="wikilink">linear regression</a> which arises as a particular form of <a href="regression_analysis" title="wikilink">regression analysis</a>. One basic form of such a model is an <a href="ordinary_least_squares" title="wikilink">ordinary least squares</a> model. The present article concentrates on the mathematical aspects of linear least squares problems, with discussion of the formulation and interpretation of statistical regression models and <a href="statistical_inference" title="wikilink">statistical inferences</a> related to these being dealt with in the articles just mentioned. See <a href="outline_of_regression_analysis" title="wikilink">outline of regression analysis</a> for an outline of the topic.</p>
<h2 id="example">Example</h2>
<figure><b>(Figure)</b>
<figcaption>A plot of the data points (in red), the least squares line of best fit (in blue), and the residuals (in green).</figcaption>
</figure>

<p>As a result of an experiment, four 

<math display="inline" id="Linear_least_squares_(mathematics):0">
 <semantics>
  <mrow>
   <mo stretchy="false">(</mo>
   <mi>x</mi>
   <mo>,</mo>
   <mi>y</mi>
   <mo stretchy="false">)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <interval closure="open">
    <ci>x</ci>
    <ci>y</ci>
   </interval>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (x,y)
  </annotation>
 </semantics>
</math>

 data points were obtained, 

<math display="inline" id="Linear_least_squares_(mathematics):1">
 <semantics>
  <mrow>
   <mrow>
    <mo stretchy="false">(</mo>
    <mn>1</mn>
    <mo>,</mo>
    <mn>6</mn>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <interval closure="open">
    <cn type="integer">1</cn>
    <cn type="integer">6</cn>
   </interval>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (1,6),
  </annotation>
 </semantics>
</math>

 

<math display="inline" id="Linear_least_squares_(mathematics):2">
 <semantics>
  <mrow>
   <mrow>
    <mo stretchy="false">(</mo>
    <mn>2</mn>
    <mo>,</mo>
    <mn>5</mn>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <interval closure="open">
    <cn type="integer">2</cn>
    <cn type="integer">5</cn>
   </interval>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (2,5),
  </annotation>
 </semantics>
</math>

 

<math display="inline" id="Linear_least_squares_(mathematics):3">
 <semantics>
  <mrow>
   <mrow>
    <mo stretchy="false">(</mo>
    <mn>3</mn>
    <mo>,</mo>
    <mn>7</mn>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <interval closure="open">
    <cn type="integer">3</cn>
    <cn type="integer">7</cn>
   </interval>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (3,7),
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Linear_least_squares_(mathematics):4">
 <semantics>
  <mrow>
   <mo stretchy="false">(</mo>
   <mn>4</mn>
   <mo>,</mo>
   <mn>10</mn>
   <mo stretchy="false">)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <interval closure="open">
    <cn type="integer">4</cn>
    <cn type="integer">10</cn>
   </interval>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (4,10)
  </annotation>
 </semantics>
</math>

 (shown in red in the picture on the right). We hope to find a line 

<math display="inline" id="Linear_least_squares_(mathematics):5">
 <semantics>
  <mrow>
   <mi>y</mi>
   <mo>=</mo>
   <mrow>
    <msub>
     <mi>β</mi>
     <mn>1</mn>
    </msub>
    <mo>+</mo>
    <mrow>
     <msub>
      <mi>β</mi>
      <mn>2</mn>
     </msub>
     <mi>x</mi>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>y</ci>
    <apply>
     <plus></plus>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>β</ci>
      <cn type="integer">1</cn>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>β</ci>
       <cn type="integer">2</cn>
      </apply>
      <ci>x</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   y=\beta_{1}+\beta_{2}x
  </annotation>
 </semantics>
</math>

 that best fits these four points. In other words, we would like to find the numbers 

<math display="inline" id="Linear_least_squares_(mathematics):6">
 <semantics>
  <msub>
   <mi>β</mi>
   <mn>1</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>β</ci>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \beta_{1}
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Linear_least_squares_(mathematics):7">
 <semantics>
  <msub>
   <mi>β</mi>
   <mn>2</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>β</ci>
    <cn type="integer">2</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \beta_{2}
  </annotation>
 </semantics>
</math>

 that approximately solve the overdetermined linear system</p>

<p>

<math display="inline" id="Linear_least_squares_(mathematics):8">
 <semantics>
  <mrow>
   <msub>
    <mi>β</mi>
    <mn>1</mn>
   </msub>
   <mo>+</mo>
   <mrow>
    <mn>1</mn>
    <msub>
     <mi>β</mi>
     <mn>2</mn>
    </msub>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <plus></plus>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>β</ci>
     <cn type="integer">1</cn>
    </apply>
    <apply>
     <times></times>
     <cn type="integer">1</cn>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>β</ci>
      <cn type="integer">2</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle\beta_{1}+1\beta_{2}
  </annotation>
 </semantics>
</math>


 of four equations in two unknowns in some "best" sense.</p>

<p>The "error", at each point, between the curve fit and the data is the difference between the right- and left-hand sides of the equations above. The <a href="least_squares" title="wikilink">least squares</a> approach to solving this problem is to try to make as small as possible the sum of the squares of these errors; that is, to find the <a href="maxima_and_minima" title="wikilink">minimum</a> of the function</p>

<p>

<math display="inline" id="Linear_least_squares_(mathematics):9">
 <semantics>
  <mrow>
   <mrow>
    <mi>S</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <msub>
      <mi>β</mi>
      <mn>1</mn>
     </msub>
     <mo>,</mo>
     <msub>
      <mi>β</mi>
      <mn>2</mn>
     </msub>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mi></mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>S</ci>
     <interval closure="open">
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>β</ci>
       <cn type="integer">1</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>β</ci>
       <cn type="integer">2</cn>
      </apply>
     </interval>
    </apply>
    <csymbol cd="latexml">absent</csymbol>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle S(\beta_{1},\beta_{2})=
  </annotation>
 </semantics>
</math>


</p>

<p>The minimum is determined by calculating the <a href="partial_derivative" title="wikilink">partial derivatives</a> of 

<math display="inline" id="Linear_least_squares_(mathematics):10">
 <semantics>
  <mrow>
   <mi>S</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>β</mi>
     <mn>1</mn>
    </msub>
    <mo>,</mo>
    <msub>
     <mi>β</mi>
     <mn>2</mn>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>S</ci>
    <interval closure="open">
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>β</ci>
      <cn type="integer">1</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>β</ci>
      <cn type="integer">2</cn>
     </apply>
    </interval>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   S(\beta_{1},\beta_{2})
  </annotation>
 </semantics>
</math>

 with respect to 

<math display="inline" id="Linear_least_squares_(mathematics):11">
 <semantics>
  <msub>
   <mi>β</mi>
   <mn>1</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>β</ci>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \beta_{1}
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Linear_least_squares_(mathematics):12">
 <semantics>
  <msub>
   <mi>β</mi>
   <mn>2</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>β</ci>
    <cn type="integer">2</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \beta_{2}
  </annotation>
 </semantics>
</math>

 and setting them to zero</p>

<p>

<math display="block" id="Linear_least_squares_(mathematics):13">
 <semantics>
  <mrow>
   <mfrac>
    <mrow>
     <mo>∂</mo>
     <mi>S</mi>
    </mrow>
    <mrow>
     <mo>∂</mo>
     <msub>
      <mi>β</mi>
      <mn>1</mn>
     </msub>
    </mrow>
   </mfrac>
   <mo>=</mo>
   <mn>0</mn>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mrow>
      <mn>8</mn>
      <msub>
       <mi>β</mi>
       <mn>1</mn>
      </msub>
     </mrow>
     <mo>+</mo>
     <mrow>
      <mn>20</mn>
      <msub>
       <mi>β</mi>
       <mn>2</mn>
      </msub>
     </mrow>
    </mrow>
    <mo>-</mo>
    <mn>56</mn>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <divide></divide>
      <apply>
       <partialdiff></partialdiff>
       <ci>S</ci>
      </apply>
      <apply>
       <partialdiff></partialdiff>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>β</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
     </apply>
     <cn type="integer">0</cn>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <minus></minus>
      <apply>
       <plus></plus>
       <apply>
        <times></times>
        <cn type="integer">8</cn>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>β</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <apply>
        <times></times>
        <cn type="integer">20</cn>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>β</ci>
         <cn type="integer">2</cn>
        </apply>
       </apply>
      </apply>
      <cn type="integer">56</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \frac{\partial S}{\partial\beta_{1}}=0=8\beta_{1}+20\beta_{2}-56
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Linear_least_squares_(mathematics):14">
 <semantics>
  <mrow>
   <mfrac>
    <mrow>
     <mo>∂</mo>
     <mi>S</mi>
    </mrow>
    <mrow>
     <mo>∂</mo>
     <msub>
      <mi>β</mi>
      <mn>2</mn>
     </msub>
    </mrow>
   </mfrac>
   <mo>=</mo>
   <mn>0</mn>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mrow>
      <mn>20</mn>
      <msub>
       <mi>β</mi>
       <mn>1</mn>
      </msub>
     </mrow>
     <mo>+</mo>
     <mrow>
      <mn>60</mn>
      <msub>
       <mi>β</mi>
       <mn>2</mn>
      </msub>
     </mrow>
    </mrow>
    <mo>-</mo>
    <mn>154.</mn>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <divide></divide>
      <apply>
       <partialdiff></partialdiff>
       <ci>S</ci>
      </apply>
      <apply>
       <partialdiff></partialdiff>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>β</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
     </apply>
     <cn type="integer">0</cn>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <minus></minus>
      <apply>
       <plus></plus>
       <apply>
        <times></times>
        <cn type="integer">20</cn>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>β</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <apply>
        <times></times>
        <cn type="integer">60</cn>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>β</ci>
         <cn type="integer">2</cn>
        </apply>
       </apply>
      </apply>
      <cn type="float">154.</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \frac{\partial S}{\partial\beta_{2}}=0=20\beta_{1}+60\beta_{2}-154.
  </annotation>
 </semantics>
</math>

</p>

<p>This results in a system of two equations in two unknowns, called the normal equations, which give, when solved</p>

<p>

<math display="block" id="Linear_least_squares_(mathematics):15">
 <semantics>
  <mrow>
   <msub>
    <mi>β</mi>
    <mn>1</mn>
   </msub>
   <mo>=</mo>
   <mn>3.5</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>β</ci>
     <cn type="integer">1</cn>
    </apply>
    <cn type="float">3.5</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \beta_{1}=3.5
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Linear_least_squares_(mathematics):16">
 <semantics>
  <mrow>
   <msub>
    <mi>β</mi>
    <mn>2</mn>
   </msub>
   <mo>=</mo>
   <mn>1.4</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>β</ci>
     <cn type="integer">2</cn>
    </apply>
    <cn type="float">1.4</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \beta_{2}=1.4
  </annotation>
 </semantics>
</math>

</p>

<p>and the equation 

<math display="inline" id="Linear_least_squares_(mathematics):17">
 <semantics>
  <mrow>
   <mi>y</mi>
   <mo>=</mo>
   <mrow>
    <mn>3.5</mn>
    <mo>+</mo>
    <mrow>
     <mn>1.4</mn>
     <mi>x</mi>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>y</ci>
    <apply>
     <plus></plus>
     <cn type="float">3.5</cn>
     <apply>
      <times></times>
      <cn type="float">1.4</cn>
      <ci>x</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   y=3.5+1.4x
  </annotation>
 </semantics>
</math>

 of the line of best fit. The <a href="residual_(statistics)" title="wikilink">residuals</a>, that is, the discrepancies between the 

<math display="inline" id="Linear_least_squares_(mathematics):18">
 <semantics>
  <mi>y</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>y</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   y
  </annotation>
 </semantics>
</math>

 values from the experiment and the 

<math display="inline" id="Linear_least_squares_(mathematics):19">
 <semantics>
  <mi>y</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>y</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   y
  </annotation>
 </semantics>
</math>

 values calculated using the line of best fit are then found to be 

<math display="inline" id="Linear_least_squares_(mathematics):20">
 <semantics>
  <mrow>
   <mn>1.1</mn>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cn type="float">1.1</cn>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   1.1,
  </annotation>
 </semantics>
</math>

 

<math display="inline" id="Linear_least_squares_(mathematics):21">
 <semantics>
  <mrow>
   <mrow>
    <mo>-</mo>
    <mn>1.3</mn>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <minus></minus>
    <cn type="float">1.3</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   -1.3,
  </annotation>
 </semantics>
</math>

 

<math display="inline" id="Linear_least_squares_(mathematics):22">
 <semantics>
  <mrow>
   <mrow>
    <mo>-</mo>
    <mn>0.7</mn>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <minus></minus>
    <cn type="float">0.7</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   -0.7,
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Linear_least_squares_(mathematics):23">
 <semantics>
  <mn>0.9</mn>
  <annotation-xml encoding="MathML-Content">
   <cn type="float">0.9</cn>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   0.9
  </annotation>
 </semantics>
</math>

 (see the picture on the right). The minimum value of the sum of squares of the residuals is 

<math display="inline" id="Linear_least_squares_(mathematics):24">
 <semantics>
  <mrow>
   <mrow>
    <mi>S</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mn>3.5</mn>
     <mo>,</mo>
     <mn>1.4</mn>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <msup>
     <mn>1.1</mn>
     <mn>2</mn>
    </msup>
    <mo>+</mo>
    <msup>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mo>-</mo>
       <mn>1.3</mn>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <mn>2</mn>
    </msup>
    <mo>+</mo>
    <msup>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mo>-</mo>
       <mn>0.7</mn>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <mn>2</mn>
    </msup>
    <mo>+</mo>
    <msup>
     <mn>0.9</mn>
     <mn>2</mn>
    </msup>
   </mrow>
   <mo>=</mo>
   <mn>4.2.</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <times></times>
      <ci>S</ci>
      <interval closure="open">
       <cn type="float">3.5</cn>
       <cn type="float">1.4</cn>
      </interval>
     </apply>
     <apply>
      <plus></plus>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <cn type="float">1.1</cn>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <minus></minus>
        <cn type="float">1.3</cn>
       </apply>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <minus></minus>
        <cn type="float">0.7</cn>
       </apply>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <cn type="float">0.9</cn>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <cn type="float">4.2.</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   S(3.5,1.4)=1.1^{2}+(-1.3)^{2}+(-0.7)^{2}+0.9^{2}=4.2.
  </annotation>
 </semantics>
</math>

</p>
<h3 id="using-a-quadratic-model">Using a quadratic model</h3>
<figure><b>(Figure)</b>
<figcaption>The result of fitting a quadratic function 

<math display="inline" id="Linear_least_squares_(mathematics):25">
 <semantics>
  <mrow>
   <mi>y</mi>
   <mo>=</mo>
   <mrow>
    <msub>
     <mi>β</mi>
     <mn>1</mn>
    </msub>
    <mo>+</mo>
    <mrow>
     <msub>
      <mi>β</mi>
      <mn>2</mn>
     </msub>
     <mi>x</mi>
    </mrow>
    <mo>+</mo>
    <mrow>
     <msub>
      <mi>β</mi>
      <mn>3</mn>
     </msub>
     <mpadded width="+1.7pt">
      <msup>
       <mi>x</mi>
       <mn>2</mn>
      </msup>
     </mpadded>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>y</ci>
    <apply>
     <plus></plus>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>β</ci>
      <cn type="integer">1</cn>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>β</ci>
       <cn type="integer">2</cn>
      </apply>
      <ci>x</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>β</ci>
       <cn type="integer">3</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>x</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   y=\beta_{1}+\beta_{2}x+\beta_{3}x^{2}\,
  </annotation>
 </semantics>
</math>

 (in blue) through a set of data points 

<math display="inline" id="Linear_least_squares_(mathematics):26">
 <semantics>
  <mrow>
   <mo stretchy="false">(</mo>
   <msub>
    <mi>x</mi>
    <mi>i</mi>
   </msub>
   <mo>,</mo>
   <msub>
    <mi>y</mi>
    <mi>i</mi>
   </msub>
   <mo stretchy="false">)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <interval closure="open">
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>x</ci>
     <ci>i</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>y</ci>
     <ci>i</ci>
    </apply>
   </interval>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (x_{i},y_{i})
  </annotation>
 </semantics>
</math>

 (in red). In linear least squares the function need not be linear in the argument 

<math display="inline" id="Linear_least_squares_(mathematics):27">
 <semantics>
  <mrow>
   <mi>x</mi>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <ci>x</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x,
  </annotation>
 </semantics>
</math>

 but only in the parameters 

<math display="inline" id="Linear_least_squares_(mathematics):28">
 <semantics>
  <msub>
   <mi>β</mi>
   <mi>j</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>β</ci>
    <ci>j</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \beta_{j}
  </annotation>
 </semantics>
</math>

 that are determined to give the best fit.</figcaption>
</figure>

<p>Importantly, in "linear least squares", we are not restricted to using a line as the model as in the above example. For instance, we could have chosen the restricted quadratic model 

<math display="inline" id="Linear_least_squares_(mathematics):29">
 <semantics>
  <mrow>
   <mi>y</mi>
   <mo>=</mo>
   <mrow>
    <msub>
     <mi>β</mi>
     <mn>1</mn>
    </msub>
    <msup>
     <mi>x</mi>
     <mn>2</mn>
    </msup>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>y</ci>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>β</ci>
      <cn type="integer">1</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>x</ci>
      <cn type="integer">2</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   y=\beta_{1}x^{2}
  </annotation>
 </semantics>
</math>

. This model is still linear in the 

<math display="inline" id="Linear_least_squares_(mathematics):30">
 <semantics>
  <msub>
   <mi>β</mi>
   <mn>1</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>β</ci>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \beta_{1}
  </annotation>
 </semantics>
</math>

 parameter, so we can still perform the same analysis, constructing a system of equations from the data points:</p>

<p>

<math display="inline" id="Linear_least_squares_(mathematics):31">
 <semantics>
  <mn>6</mn>
  <annotation-xml encoding="MathML-Content">
   <cn type="integer">6</cn>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle 6
  </annotation>
 </semantics>
</math>


</p>

<p>The partial derivatives with respect to the parameters (this time there is only one) are again computed and set to 0:</p>

<p>

<math display="inline" id="Linear_least_squares_(mathematics):32">
 <semantics>
  <mrow>
   <mfrac>
    <mrow>
     <mo>∂</mo>
     <mi>S</mi>
    </mrow>
    <mrow>
     <mo>∂</mo>
     <msub>
      <mi>β</mi>
      <mn>1</mn>
     </msub>
    </mrow>
   </mfrac>
   <mo>=</mo>
   <mn>0</mn>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mn>708</mn>
     <msub>
      <mi>β</mi>
      <mn>1</mn>
     </msub>
    </mrow>
    <mo>-</mo>
    <mn>498</mn>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <divide></divide>
      <apply>
       <partialdiff></partialdiff>
       <ci>S</ci>
      </apply>
      <apply>
       <partialdiff></partialdiff>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>β</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
     </apply>
     <cn type="integer">0</cn>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <minus></minus>
      <apply>
       <times></times>
       <cn type="integer">708</cn>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>β</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <cn type="integer">498</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \frac{\partial S}{\partial\beta_{1}}=0=708\beta_{1}-498
  </annotation>
 </semantics>
</math>

</p>

<p>and solved</p>

<p>

<math display="inline" id="Linear_least_squares_(mathematics):33">
 <semantics>
  <mrow>
   <msub>
    <mi>β</mi>
    <mn>1</mn>
   </msub>
   <mo>=</mo>
   <mn>.703</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>β</ci>
     <cn type="integer">1</cn>
    </apply>
    <cn type="float">.703</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \beta_{1}=.703
  </annotation>
 </semantics>
</math>

</p>

<p>leading to the resulting best fit model 

<math display="inline" id="Linear_least_squares_(mathematics):34">
 <semantics>
  <mrow>
   <mi>y</mi>
   <mo>=</mo>
   <mrow>
    <mn>.703</mn>
    <msup>
     <mi>x</mi>
     <mn>2</mn>
    </msup>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>y</ci>
    <apply>
     <times></times>
     <cn type="float">.703</cn>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>x</ci>
      <cn type="integer">2</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   y=.703x^{2}
  </annotation>
 </semantics>
</math>

</p>
<h2 id="the-general-problem">The general problem</h2>

<p>Consider an <a href="overdetermined_system" title="wikilink">overdetermined system</a></p>

<p>

<math display="block" id="Linear_least_squares_(mathematics):35">
 <semantics>
  <mrow>
   <munderover>
    <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
    <mrow>
     <mi>j</mi>
     <mo>=</mo>
     <mn>1</mn>
    </mrow>
    <mi>n</mi>
   </munderover>
   <msub>
    <mi>X</mi>
    <mrow>
     <mi>i</mi>
     <mi>j</mi>
    </mrow>
   </msub>
   <msub>
    <mi>β</mi>
    <mi>j</mi>
   </msub>
   <mo>=</mo>
   <msub>
    <mi>y</mi>
    <mi>i</mi>
   </msub>
   <mo rspace="7.5pt">,</mo>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>i</mi>
    <mo>=</mo>
    <mn>1</mn>
    <mo>,</mo>
    <mn>2</mn>
    <mo>,</mo>
    <mi mathvariant="normal">…</mi>
    <mo>,</mo>
    <mi>m</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <sum></sum>
      <apply>
       <eq></eq>
       <ci>j</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <ci>n</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>X</ci>
     <apply>
      <times></times>
      <ci>i</ci>
      <ci>j</ci>
     </apply>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>β</ci>
     <ci>j</ci>
    </apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>y</ci>
     <ci>i</ci>
    </apply>
    <ci>normal-,</ci>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">i</csymbol>
     <eq></eq>
     <cn type="integer">1</cn>
     <ci>normal-,</ci>
     <cn type="integer">2</cn>
     <ci>normal-,</ci>
     <ci>normal-…</ci>
     <ci>normal-,</ci>
     <csymbol cd="unknown">m</csymbol>
     <ci>normal-)</ci>
    </cerror>
    <ci>normal-,</ci>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \sum_{j=1}^{n}X_{ij}\beta_{j}=y_{i},\ (i=1,2,\dots,m),
  </annotation>
 </semantics>
</math>

</p>

<p>of <em>m</em> <a href="linear_equation" title="wikilink">linear equations</a> in <em>n</em> unknown <a class="uri" href="coefficients" title="wikilink">coefficients</a>, <em>β</em><sub>1</sub>,<em>β</em><sub>2</sub>,…,<em>β</em><sub><em>n</em></sub>, with <em>m</em> &gt; <em>n</em>. This can be written in <a href="matrix_(mathematics)" title="wikilink">matrix</a> form as</p>

<p>

<math display="block" id="Linear_least_squares_(mathematics):36">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>𝐗</mi>
     <mi>𝜷</mi>
    </mrow>
    <mo>=</mo>
    <mi>𝐲</mi>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>𝐗</ci>
     <ci>𝜷</ci>
    </apply>
    <ci>𝐲</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{X}\boldsymbol{\beta}=\mathbf{y},
  </annotation>
 </semantics>
</math>

</p>

<p>where</p>

<p>

<math display="block" id="Linear_least_squares_(mathematics):37">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>𝐗</mi>
     <mo>=</mo>
     <mrow>
      <mo>[</mo>
      <mtable displaystyle="true">
       <mtr>
        <mtd columnalign="center">
         <msub>
          <mi>X</mi>
          <mn>11</mn>
         </msub>
        </mtd>
        <mtd columnalign="center">
         <msub>
          <mi>X</mi>
          <mn>12</mn>
         </msub>
        </mtd>
        <mtd columnalign="center">
         <mi mathvariant="normal">⋯</mi>
        </mtd>
        <mtd columnalign="center">
         <msub>
          <mi>X</mi>
          <mrow>
           <mn>1</mn>
           <mi>n</mi>
          </mrow>
         </msub>
        </mtd>
       </mtr>
       <mtr>
        <mtd columnalign="center">
         <msub>
          <mi>X</mi>
          <mn>21</mn>
         </msub>
        </mtd>
        <mtd columnalign="center">
         <msub>
          <mi>X</mi>
          <mn>22</mn>
         </msub>
        </mtd>
        <mtd columnalign="center">
         <mi mathvariant="normal">⋯</mi>
        </mtd>
        <mtd columnalign="center">
         <msub>
          <mi>X</mi>
          <mrow>
           <mn>2</mn>
           <mi>n</mi>
          </mrow>
         </msub>
        </mtd>
       </mtr>
       <mtr>
        <mtd columnalign="center">
         <mi mathvariant="normal">⋮</mi>
        </mtd>
        <mtd columnalign="center">
         <mi mathvariant="normal">⋮</mi>
        </mtd>
        <mtd columnalign="center">
         <mi mathvariant="normal">⋱</mi>
        </mtd>
        <mtd columnalign="center">
         <mi mathvariant="normal">⋮</mi>
        </mtd>
       </mtr>
       <mtr>
        <mtd columnalign="center">
         <msub>
          <mi>X</mi>
          <mrow>
           <mi>m</mi>
           <mn>1</mn>
          </mrow>
         </msub>
        </mtd>
        <mtd columnalign="center">
         <msub>
          <mi>X</mi>
          <mrow>
           <mi>m</mi>
           <mn>2</mn>
          </mrow>
         </msub>
        </mtd>
        <mtd columnalign="center">
         <mi mathvariant="normal">⋯</mi>
        </mtd>
        <mtd columnalign="center">
         <msub>
          <mi>X</mi>
          <mrow>
           <mi>m</mi>
           <mi>n</mi>
          </mrow>
         </msub>
        </mtd>
       </mtr>
      </mtable>
      <mo>]</mo>
     </mrow>
    </mrow>
    <mo rspace="22.5pt">,</mo>
    <mrow>
     <mrow>
      <mi>𝜷</mi>
      <mo>=</mo>
      <mrow>
       <mo>[</mo>
       <mtable displaystyle="true">
        <mtr>
         <mtd columnalign="center">
          <msub>
           <mi>β</mi>
           <mn>1</mn>
          </msub>
         </mtd>
        </mtr>
        <mtr>
         <mtd columnalign="center">
          <msub>
           <mi>β</mi>
           <mn>2</mn>
          </msub>
         </mtd>
        </mtr>
        <mtr>
         <mtd columnalign="center">
          <mi mathvariant="normal">⋮</mi>
         </mtd>
        </mtr>
        <mtr>
         <mtd columnalign="center">
          <msub>
           <mi>β</mi>
           <mi>n</mi>
          </msub>
         </mtd>
        </mtr>
       </mtable>
       <mo>]</mo>
      </mrow>
     </mrow>
     <mo rspace="22.5pt">,</mo>
     <mrow>
      <mi>𝐲</mi>
      <mo>=</mo>
      <mrow>
       <mo>[</mo>
       <mtable displaystyle="true">
        <mtr>
         <mtd columnalign="center">
          <msub>
           <mi>y</mi>
           <mn>1</mn>
          </msub>
         </mtd>
        </mtr>
        <mtr>
         <mtd columnalign="center">
          <msub>
           <mi>y</mi>
           <mn>2</mn>
          </msub>
         </mtd>
        </mtr>
        <mtr>
         <mtd columnalign="center">
          <mi mathvariant="normal">⋮</mi>
         </mtd>
        </mtr>
        <mtr>
         <mtd columnalign="center">
          <msub>
           <mi>y</mi>
           <mi>m</mi>
          </msub>
         </mtd>
        </mtr>
       </mtable>
       <mo>]</mo>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <eq></eq>
     <ci>𝐗</ci>
     <matrix>
      <matrixrow>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>X</ci>
        <cn type="integer">11</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>X</ci>
        <cn type="integer">12</cn>
       </apply>
       <ci>normal-⋯</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>X</ci>
        <apply>
         <times></times>
         <cn type="integer">1</cn>
         <ci>n</ci>
        </apply>
       </apply>
      </matrixrow>
      <matrixrow>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>X</ci>
        <cn type="integer">21</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>X</ci>
        <cn type="integer">22</cn>
       </apply>
       <ci>normal-⋯</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>X</ci>
        <apply>
         <times></times>
         <cn type="integer">2</cn>
         <ci>n</ci>
        </apply>
       </apply>
      </matrixrow>
      <matrixrow>
       <ci>normal-⋮</ci>
       <ci>normal-⋮</ci>
       <ci>normal-⋱</ci>
       <ci>normal-⋮</ci>
      </matrixrow>
      <matrixrow>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>X</ci>
        <apply>
         <times></times>
         <ci>m</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>X</ci>
        <apply>
         <times></times>
         <ci>m</ci>
         <cn type="integer">2</cn>
        </apply>
       </apply>
       <ci>normal-⋯</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>X</ci>
        <apply>
         <times></times>
         <ci>m</ci>
         <ci>n</ci>
        </apply>
       </apply>
      </matrixrow>
     </matrix>
    </apply>
    <apply>
     <csymbol cd="ambiguous">formulae-sequence</csymbol>
     <apply>
      <eq></eq>
      <ci>𝜷</ci>
      <matrix>
       <matrixrow>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>β</ci>
         <cn type="integer">1</cn>
        </apply>
       </matrixrow>
       <matrixrow>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>β</ci>
         <cn type="integer">2</cn>
        </apply>
       </matrixrow>
       <matrixrow>
        <ci>normal-⋮</ci>
       </matrixrow>
       <matrixrow>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>β</ci>
         <ci>n</ci>
        </apply>
       </matrixrow>
      </matrix>
     </apply>
     <apply>
      <eq></eq>
      <ci>𝐲</ci>
      <matrix>
       <matrixrow>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>y</ci>
         <cn type="integer">1</cn>
        </apply>
       </matrixrow>
       <matrixrow>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>y</ci>
         <cn type="integer">2</cn>
        </apply>
       </matrixrow>
       <matrixrow>
        <ci>normal-⋮</ci>
       </matrixrow>
       <matrixrow>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>y</ci>
         <ci>m</ci>
        </apply>
       </matrixrow>
      </matrix>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{X}=\begin{bmatrix}X_{11}&X_{12}&\cdots&X_{1n}\\
X_{21}&X_{22}&\cdots&X_{2n}\\
\vdots&\vdots&\ddots&\vdots\\
X_{m1}&X_{m2}&\cdots&X_{mn}\end{bmatrix},\qquad\boldsymbol{\beta}=\begin{%
bmatrix}\beta_{1}\\
\beta_{2}\\
\vdots\\
\beta_{n}\end{bmatrix},\qquad\mathbf{y}=\begin{bmatrix}y_{1}\\
y_{2}\\
\vdots\\
y_{m}\end{bmatrix}.
  </annotation>
 </semantics>
</math>

</p>

<p>Such a system usually has no solution, so the goal is instead to find the coefficients <strong><em>β</em></strong> which fit the equations "best," in the sense of solving the <a href="Quadratic_form_(statistics)" title="wikilink">quadratic</a> <a href="Mathematical_optimization" title="wikilink">minimization</a> problem</p>

<p>

<math display="block" id="Linear_least_squares_(mathematics):38">
 <semantics>
  <mrow>
   <mrow>
    <mover accent="true">
     <mi>𝜷</mi>
     <mo stretchy="false">^</mo>
    </mover>
    <mo>=</mo>
    <mrow>
     <mpadded width="+1.7pt">
      <munder accentunder="true">
       <mrow>
        <mpadded width="+1.7pt">
         <mi>arg</mi>
        </mpadded>
        <mi>min</mi>
       </mrow>
       <mo>𝜷</mo>
      </munder>
     </mpadded>
     <mi>S</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>𝜷</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <ci>normal-^</ci>
     <ci>𝜷</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <ci>𝜷</ci>
      <apply>
       <times></times>
       <ci>arg</ci>
       <ci>min</ci>
      </apply>
     </apply>
     <ci>S</ci>
     <ci>𝜷</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \hat{\boldsymbol{\beta}}=\underset{\boldsymbol{\beta}}{\operatorname{arg\,min}%
}\,S(\boldsymbol{\beta}),
  </annotation>
 </semantics>
</math>

</p>

<p>where the objective function <em>S</em> is given by</p>

<p>

<math display="block" id="Linear_least_squares_(mathematics):39">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>S</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>𝜷</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <munderover>
      <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
      <mrow>
       <mi>i</mi>
       <mo>=</mo>
       <mn>1</mn>
      </mrow>
      <mi>m</mi>
     </munderover>
     <msup>
      <mrow>
       <mo fence="true" maxsize="120%" minsize="120%">|</mo>
       <mrow>
        <msub>
         <mi>y</mi>
         <mi>i</mi>
        </msub>
        <mo>-</mo>
        <mrow>
         <munderover>
          <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
          <mrow>
           <mi>j</mi>
           <mo>=</mo>
           <mn>1</mn>
          </mrow>
          <mi>n</mi>
         </munderover>
         <mrow>
          <msub>
           <mi>X</mi>
           <mrow>
            <mi>i</mi>
            <mi>j</mi>
           </mrow>
          </msub>
          <msub>
           <mi>β</mi>
           <mi>j</mi>
          </msub>
         </mrow>
        </mrow>
       </mrow>
       <mo fence="true" maxsize="120%" minsize="120%">|</mo>
      </mrow>
      <mn>2</mn>
     </msup>
    </mrow>
    <mo>=</mo>
    <msup>
     <mrow>
      <mo fence="true" maxsize="120%" minsize="120%">∥</mo>
      <mrow>
       <mi>𝐲</mi>
       <mo>-</mo>
       <mrow>
        <mi>𝐗</mi>
        <mi>𝜷</mi>
       </mrow>
      </mrow>
      <mo fence="true" maxsize="120%" minsize="120%">∥</mo>
     </mrow>
     <mn>2</mn>
    </msup>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <times></times>
      <ci>S</ci>
      <ci>𝜷</ci>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <apply>
         <eq></eq>
         <ci>i</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <ci>m</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <abs></abs>
        <apply>
         <minus></minus>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>y</ci>
          <ci>i</ci>
         </apply>
         <apply>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <sum></sum>
            <apply>
             <eq></eq>
             <ci>j</ci>
             <cn type="integer">1</cn>
            </apply>
           </apply>
           <ci>n</ci>
          </apply>
          <apply>
           <times></times>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <ci>X</ci>
            <apply>
             <times></times>
             <ci>i</ci>
             <ci>j</ci>
            </apply>
           </apply>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <ci>β</ci>
            <ci>j</ci>
           </apply>
          </apply>
         </apply>
        </apply>
       </apply>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="latexml">norm</csymbol>
       <apply>
        <minus></minus>
        <ci>𝐲</ci>
        <apply>
         <times></times>
         <ci>𝐗</ci>
         <ci>𝜷</ci>
        </apply>
       </apply>
      </apply>
      <cn type="integer">2</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   S(\boldsymbol{\beta})=\sum_{i=1}^{m}\bigl|y_{i}-\sum_{j=1}^{n}X_{ij}\beta_{j}%
\bigr|^{2}=\bigl\|\mathbf{y}-\mathbf{X}\boldsymbol{\beta}\bigr\|^{2}.
  </annotation>
 </semantics>
</math>

</p>

<p>A justification for choosing this criterion is given in <a href="#Properties_of_the_least-squares_estimators" title="wikilink">properties</a> below. This minimization problem has a unique solution, provided that the <em>n</em> columns of the matrix <em>X</em> are <a href="linearly_independent" title="wikilink">linearly independent</a>, given by solving the <a href="normal_equations" title="wikilink">normal equations</a></p>

<p>

<math display="block" id="Linear_least_squares_(mathematics):40">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <msup>
        <mi>𝐗</mi>
        <mi mathvariant="normal">T</mi>
       </msup>
       <mi>𝐗</mi>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <mover accent="true">
      <mi>𝜷</mi>
      <mo stretchy="false">^</mo>
     </mover>
    </mrow>
    <mo>=</mo>
    <mrow>
     <msup>
      <mi>𝐗</mi>
      <mi mathvariant="normal">T</mi>
     </msup>
     <mi>𝐲</mi>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>𝐗</ci>
       <ci>normal-T</ci>
      </apply>
      <ci>𝐗</ci>
     </apply>
     <apply>
      <ci>normal-^</ci>
      <ci>𝜷</ci>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>𝐗</ci>
      <ci>normal-T</ci>
     </apply>
     <ci>𝐲</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (\mathbf{X}^{\rm T}\mathbf{X})\hat{\boldsymbol{\beta}}=\mathbf{X}^{\rm T}%
\mathbf{y}.
  </annotation>
 </semantics>
</math>

</p>

<p>The matrix 

<math display="inline" id="Linear_least_squares_(mathematics):41">
 <semantics>
  <mrow>
   <msup>
    <mi>𝐗</mi>
    <mi mathvariant="normal">T</mi>
   </msup>
   <mi>𝐗</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>𝐗</ci>
     <ci>normal-T</ci>
    </apply>
    <ci>𝐗</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{X}^{\rm T}\mathbf{X}
  </annotation>
 </semantics>
</math>

 is known as the <a href="Gramian_matrix" title="wikilink">Gramian matrix</a> of 

<math display="inline" id="Linear_least_squares_(mathematics):42">
 <semantics>
  <mi>𝐗</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>𝐗</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{X}
  </annotation>
 </semantics>
</math>

, which possesses several nice properties such as being a <a href="positive_semi-definite_matrix" title="wikilink">positive semi-definite matrix</a>.</p>

<p>Following is one generalized example which shows how to find a best fit line using least squares method (in two dimension). Later, a MATLAB code implementation of the same is also written which can help one visualize graphically.</p>

<p>Let us consider 3 points (x<sub>1</sub>,y<sub>1</sub>), (x<sub>2</sub>,y<sub>2</sub>) and (x<sub>3</sub>,y<sub>3</sub>) in a two dimensional frame. Now, assume that the best fit line is in the form: y = C + Dx. Substituting the three points in this equation will give us three equations.</p>

<p>These three equations can be written in the form of a matrix equation of the type <strong>Ax</strong>=<strong>b</strong>. Projection of matrix A on b gives us x. This can be represented by the formula :</p>

<p>

<math display="block" id="Linear_least_squares_(mathematics):43">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <msup>
        <mi>𝐀</mi>
        <mi mathvariant="normal">T</mi>
       </msup>
       <mi>𝐀</mi>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <mover accent="true">
      <mi>𝜷</mi>
      <mo stretchy="false">^</mo>
     </mover>
    </mrow>
    <mo>=</mo>
    <mrow>
     <msup>
      <mi>𝐀</mi>
      <mi mathvariant="normal">T</mi>
     </msup>
     <mi>𝐲</mi>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>𝐀</ci>
       <ci>normal-T</ci>
      </apply>
      <ci>𝐀</ci>
     </apply>
     <apply>
      <ci>normal-^</ci>
      <ci>𝜷</ci>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>𝐀</ci>
      <ci>normal-T</ci>
     </apply>
     <ci>𝐲</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (\mathbf{A}^{\rm T}\mathbf{A})\hat{\boldsymbol{\beta}}=\mathbf{A}^{\rm T}%
\mathbf{y}.
  </annotation>
 </semantics>
</math>

</p>

<p>We get beta from this expression; i.e. 

<math display="inline" id="Linear_least_squares_(mathematics):44">
 <semantics>
  <mover accent="true">
   <mi>𝜷</mi>
   <mo stretchy="false">^</mo>
  </mover>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-^</ci>
    <ci>𝜷</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \hat{\boldsymbol{\beta}}
  </annotation>
 </semantics>
</math>

 is x. Hence, this follows that we have obtained C and D of the equation <strong>y = C + Dx</strong>. Hence, the best fit line obtained.</p>

<p>Matlab code implementation for better understanding in visuals:</p>

<p><code>1 %MATLAB code for finding the best fit line using least squares method</code><br/>
<code>2 x=input('enter a')                      %input in the form of matrix, rows contain points</code><br/>
<code>3     a=[1,x(1,1);1,x(2,1);1,x(3,1)]          %forming A of Ax=b</code><br/>
<code>4     b=[x(1,2);x(2,2);x(3,2)]                %forming b of Ax=b</code><br/>
<code>5     yy=inv(transpose(a)*a)*transpose(a)*b   %computing projection of matrix A on b, giving x</code><br/>
<code>6 %plotting the best fit line</code><br/>
<code>7   xx=linspace(1,10,50);</code><br/>
<code>8   y=yy(1)+yy(2)*xx;</code><br/>
<code>9   plot(xx,y)</code><br/>
<code>10     %plotting the points(data) for which we found the best fit line</code><br/>
<code>11 hold on</code><br/>
<code>12    plot(x(2,1),x(2,2),'x')</code><br/>
<code>13 hold on</code><br/>
<code>14    plot(x(1,1),x(1,2),'x')</code><br/>
<code>15 hold on</code><br/>
<code>16    plot(x(3,1),x(3,2),'x')</code><br/>
<code>17 hold off</code></p>

<p>Python code using the same variable naming as the Matlab code:</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="im">import</span> numpy <span class="im">as</span> np
<span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt

x <span class="op">=</span> np.random.rand(<span class="dv">3</span>, <span class="dv">2</span>) <span class="op">*</span> <span class="dv">10</span>
a <span class="op">=</span> np.matrix([ [<span class="dv">1</span>,x[<span class="dv">0</span>][<span class="dv">0</span>]], [<span class="dv">1</span>,x[<span class="dv">1</span>][<span class="dv">0</span>]], [<span class="dv">1</span>,x[<span class="dv">2</span>][<span class="dv">0</span>]] ])
b <span class="op">=</span> np.matrix([ [x[<span class="dv">0</span>][<span class="dv">1</span>]], [x[<span class="dv">1</span>][<span class="dv">1</span>]], [x[<span class="dv">2</span>][<span class="dv">1</span>]] ])
yy <span class="op">=</span> (a.T <span class="op">*</span> a).I <span class="op">*</span> a.T <span class="op">*</span> b
xx <span class="op">=</span> np.linspace(<span class="dv">1</span>, <span class="dv">10</span>, <span class="dv">50</span>)
y <span class="op">=</span> np.array(yy[<span class="dv">0</span>] <span class="op">+</span> yy[<span class="dv">1</span>] <span class="op">*</span> xx)

plt.figure(<span class="dv">1</span>)
plt.plot(xx, y.T, color<span class="op">=</span><span class="st">'r'</span>)
plt.scatter([x[<span class="dv">0</span>][<span class="dv">0</span>], x[<span class="dv">1</span>][<span class="dv">0</span>], x[<span class="dv">2</span>][<span class="dv">0</span>] ], [x[<span class="dv">0</span>][<span class="dv">1</span>], x[<span class="dv">1</span>][<span class="dv">1</span>], x[<span class="dv">2</span>][<span class="dv">1</span>] ]) 
plt.show()</code></pre></div>
<h2 id="derivation-of-the-normal-equations">Derivation of the normal equations</h2>

<p>Define the 

<math display="inline" id="Linear_least_squares_(mathematics):45">
 <semantics>
  <mi>i</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>i</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   i
  </annotation>
 </semantics>
</math>

th <strong>residual</strong> to be</p>

<p>

<math display="block" id="Linear_least_squares_(mathematics):46">
 <semantics>
  <mrow>
   <msub>
    <mi>r</mi>
    <mi>i</mi>
   </msub>
   <mo>=</mo>
   <mrow>
    <msub>
     <mi>y</mi>
     <mi>i</mi>
    </msub>
    <mo>-</mo>
    <mrow>
     <munderover>
      <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
      <mrow>
       <mi>j</mi>
       <mo>=</mo>
       <mn>1</mn>
      </mrow>
      <mi>n</mi>
     </munderover>
     <mrow>
      <msub>
       <mi>X</mi>
       <mrow>
        <mi>i</mi>
        <mi>j</mi>
       </mrow>
      </msub>
      <msub>
       <mi>β</mi>
       <mi>j</mi>
      </msub>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>r</ci>
     <ci>i</ci>
    </apply>
    <apply>
     <minus></minus>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <ci>i</ci>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <apply>
         <eq></eq>
         <ci>j</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <ci>n</ci>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>X</ci>
        <apply>
         <times></times>
         <ci>i</ci>
         <ci>j</ci>
        </apply>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>β</ci>
        <ci>j</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   r_{i}=y_{i}-\sum_{j=1}^{n}X_{ij}\beta_{j}
  </annotation>
 </semantics>
</math>

.</p>

<p>Then 

<math display="inline" id="Linear_least_squares_(mathematics):47">
 <semantics>
  <mi>S</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>S</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   S
  </annotation>
 </semantics>
</math>

 can be rewritten</p>

<p>

<math display="block" id="Linear_least_squares_(mathematics):48">
 <semantics>
  <mrow>
   <mrow>
    <mi>S</mi>
    <mo>=</mo>
    <mrow>
     <munderover>
      <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
      <mrow>
       <mi>i</mi>
       <mo>=</mo>
       <mn>1</mn>
      </mrow>
      <mi>m</mi>
     </munderover>
     <msubsup>
      <mi>r</mi>
      <mi>i</mi>
      <mn>2</mn>
     </msubsup>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>S</ci>
    <apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <apply>
        <eq></eq>
        <ci>i</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <ci>m</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>r</ci>
       <ci>i</ci>
      </apply>
      <cn type="integer">2</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   S=\sum_{i=1}^{m}r_{i}^{2}.
  </annotation>
 </semantics>
</math>

</p>

<p><em>S</em> is <a href="Maxima_and_minima" title="wikilink">minimized</a> when its gradient vector is zero. (This follows by definition: if the gradient vector is not zero, there is a direction in which we can move to minimize it further - see <a href="maxima_and_minima" title="wikilink">maxima and minima</a>.) The elements of the gradient vector are the partial derivatives of <em>S</em> with respect to the parameters:</p>

<p>

<math display="block" id="Linear_least_squares_(mathematics):49">
 <semantics>
  <mrow>
   <mfrac>
    <mrow>
     <mo>∂</mo>
     <mi>S</mi>
    </mrow>
    <mrow>
     <mo>∂</mo>
     <msub>
      <mi>β</mi>
      <mi>j</mi>
     </msub>
    </mrow>
   </mfrac>
   <mo>=</mo>
   <mn>2</mn>
   <munderover>
    <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
    <mrow>
     <mi>i</mi>
     <mo>=</mo>
     <mn>1</mn>
    </mrow>
    <mi>m</mi>
   </munderover>
   <msub>
    <mi>r</mi>
    <mi>i</mi>
   </msub>
   <mpadded width="+5pt">
    <mfrac>
     <mrow>
      <mo>∂</mo>
      <msub>
       <mi>r</mi>
       <mi>i</mi>
      </msub>
     </mrow>
     <mrow>
      <mo>∂</mo>
      <msub>
       <mi>β</mi>
       <mi>j</mi>
      </msub>
     </mrow>
    </mfrac>
   </mpadded>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>j</mi>
    <mo>=</mo>
    <mn>1</mn>
    <mo>,</mo>
    <mn>2</mn>
    <mo>,</mo>
    <mi mathvariant="normal">…</mi>
    <mo>,</mo>
    <mi>n</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <apply>
     <divide></divide>
     <apply>
      <partialdiff></partialdiff>
      <ci>S</ci>
     </apply>
     <apply>
      <partialdiff></partialdiff>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>β</ci>
       <ci>j</ci>
      </apply>
     </apply>
    </apply>
    <eq></eq>
    <cn type="integer">2</cn>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <sum></sum>
      <apply>
       <eq></eq>
       <ci>i</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <ci>m</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>r</ci>
     <ci>i</ci>
    </apply>
    <apply>
     <divide></divide>
     <apply>
      <partialdiff></partialdiff>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>r</ci>
       <ci>i</ci>
      </apply>
     </apply>
     <apply>
      <partialdiff></partialdiff>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>β</ci>
       <ci>j</ci>
      </apply>
     </apply>
    </apply>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">j</csymbol>
     <eq></eq>
     <cn type="integer">1</cn>
     <ci>normal-,</ci>
     <cn type="integer">2</cn>
     <ci>normal-,</ci>
     <ci>normal-…</ci>
     <ci>normal-,</ci>
     <csymbol cd="unknown">n</csymbol>
     <ci>normal-)</ci>
    </cerror>
    <ci>normal-.</ci>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \frac{\partial S}{\partial\beta_{j}}=2\sum_{i=1}^{m}r_{i}\frac{\partial r_{i}}%
{\partial\beta_{j}}\ (j=1,2,\dots,n).
  </annotation>
 </semantics>
</math>

</p>

<p>The derivatives are</p>

<p>

<math display="block" id="Linear_least_squares_(mathematics):50">
 <semantics>
  <mrow>
   <mrow>
    <mfrac>
     <mrow>
      <mo>∂</mo>
      <msub>
       <mi>r</mi>
       <mi>i</mi>
      </msub>
     </mrow>
     <mrow>
      <mo>∂</mo>
      <msub>
       <mi>β</mi>
       <mi>j</mi>
      </msub>
     </mrow>
    </mfrac>
    <mo>=</mo>
    <mrow>
     <mo>-</mo>
     <msub>
      <mi>X</mi>
      <mrow>
       <mi>i</mi>
       <mi>j</mi>
      </mrow>
     </msub>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <divide></divide>
     <apply>
      <partialdiff></partialdiff>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>r</ci>
       <ci>i</ci>
      </apply>
     </apply>
     <apply>
      <partialdiff></partialdiff>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>β</ci>
       <ci>j</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <minus></minus>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>X</ci>
      <apply>
       <times></times>
       <ci>i</ci>
       <ci>j</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \frac{\partial r_{i}}{\partial\beta_{j}}=-X_{ij}.
  </annotation>
 </semantics>
</math>

</p>

<p>Substitution of the expressions for the residuals and the derivatives into the gradient equations gives</p>

<p>

<math display="block" id="Linear_least_squares_(mathematics):51">
 <semantics>
  <mrow>
   <mfrac>
    <mrow>
     <mo>∂</mo>
     <mi>S</mi>
    </mrow>
    <mrow>
     <mo>∂</mo>
     <msub>
      <mi>β</mi>
      <mi>j</mi>
     </msub>
    </mrow>
   </mfrac>
   <mo>=</mo>
   <mn>2</mn>
   <munderover>
    <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
    <mrow>
     <mi>i</mi>
     <mo>=</mo>
     <mn>1</mn>
    </mrow>
    <mi>m</mi>
   </munderover>
   <mrow>
    <mo>(</mo>
    <msub>
     <mi>y</mi>
     <mi>i</mi>
    </msub>
    <mo>-</mo>
    <munderover>
     <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
     <mrow>
      <mi>k</mi>
      <mo>=</mo>
      <mn>1</mn>
     </mrow>
     <mi>n</mi>
    </munderover>
    <msub>
     <mi>X</mi>
     <mrow>
      <mi>i</mi>
      <mi>k</mi>
     </mrow>
    </msub>
    <msub>
     <mi>β</mi>
     <mi>k</mi>
    </msub>
    <mo>)</mo>
   </mrow>
   <mrow>
    <mo stretchy="false">(</mo>
    <mo>-</mo>
    <msub>
     <mi>X</mi>
     <mrow>
      <mi>i</mi>
      <mi>j</mi>
     </mrow>
    </msub>
    <mo rspace="7.5pt" stretchy="false">)</mo>
   </mrow>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>j</mi>
    <mo>=</mo>
    <mn>1</mn>
    <mo>,</mo>
    <mn>2</mn>
    <mo>,</mo>
    <mi mathvariant="normal">…</mi>
    <mo>,</mo>
    <mi>n</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <apply>
     <divide></divide>
     <apply>
      <partialdiff></partialdiff>
      <ci>S</ci>
     </apply>
     <apply>
      <partialdiff></partialdiff>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>β</ci>
       <ci>j</ci>
      </apply>
     </apply>
    </apply>
    <eq></eq>
    <cn type="integer">2</cn>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <sum></sum>
      <apply>
       <eq></eq>
       <ci>i</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <ci>m</ci>
    </apply>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <ci>i</ci>
     </apply>
     <minus></minus>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <apply>
        <eq></eq>
        <ci>k</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <ci>n</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>X</ci>
      <apply>
       <times></times>
       <ci>i</ci>
       <ci>k</ci>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>β</ci>
      <ci>k</ci>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <minus></minus>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>X</ci>
      <apply>
       <times></times>
       <ci>i</ci>
       <ci>j</ci>
      </apply>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">j</csymbol>
     <eq></eq>
     <cn type="integer">1</cn>
     <ci>normal-,</ci>
     <cn type="integer">2</cn>
     <ci>normal-,</ci>
     <ci>normal-…</ci>
     <ci>normal-,</ci>
     <csymbol cd="unknown">n</csymbol>
     <ci>normal-)</ci>
    </cerror>
    <ci>normal-.</ci>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \frac{\partial S}{\partial\beta_{j}}=2\sum_{i=1}^{m}\left(y_{i}-\sum_{k=1}^{n}%
X_{ik}\beta_{k}\right)(-X_{ij})\ (j=1,2,\dots,n).
  </annotation>
 </semantics>
</math>

</p>

<p>Thus if 

<math display="inline" id="Linear_least_squares_(mathematics):52">
 <semantics>
  <mover accent="true">
   <mi>β</mi>
   <mo stretchy="false">^</mo>
  </mover>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-^</ci>
    <ci>β</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \hat{\beta}
  </annotation>
 </semantics>
</math>

 minimizes <em>S</em>, we have</p>

<p>

<math display="block" id="Linear_least_squares_(mathematics):53">
 <semantics>
  <mrow>
   <mn>2</mn>
   <munderover>
    <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
    <mrow>
     <mi>i</mi>
     <mo>=</mo>
     <mn>1</mn>
    </mrow>
    <mi>m</mi>
   </munderover>
   <mrow>
    <mo>(</mo>
    <msub>
     <mi>y</mi>
     <mi>i</mi>
    </msub>
    <mo>-</mo>
    <munderover>
     <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
     <mrow>
      <mi>k</mi>
      <mo>=</mo>
      <mn>1</mn>
     </mrow>
     <mi>n</mi>
    </munderover>
    <msub>
     <mi>X</mi>
     <mrow>
      <mi>i</mi>
      <mi>k</mi>
     </mrow>
    </msub>
    <msub>
     <mover accent="true">
      <mi>β</mi>
      <mo stretchy="false">^</mo>
     </mover>
     <mi>k</mi>
    </msub>
    <mo>)</mo>
   </mrow>
   <mrow>
    <mo stretchy="false">(</mo>
    <mo>-</mo>
    <msub>
     <mi>X</mi>
     <mrow>
      <mi>i</mi>
      <mi>j</mi>
     </mrow>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>=</mo>
   <mpadded width="+5pt">
    <mn>0</mn>
   </mpadded>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>j</mi>
    <mo>=</mo>
    <mn>1</mn>
    <mo>,</mo>
    <mn>2</mn>
    <mo>,</mo>
    <mi mathvariant="normal">…</mi>
    <mo>,</mo>
    <mi>n</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <cn type="integer">2</cn>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <sum></sum>
      <apply>
       <eq></eq>
       <ci>i</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <ci>m</ci>
    </apply>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <ci>i</ci>
     </apply>
     <minus></minus>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <apply>
        <eq></eq>
        <ci>k</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <ci>n</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>X</ci>
      <apply>
       <times></times>
       <ci>i</ci>
       <ci>k</ci>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <ci>normal-^</ci>
       <ci>β</ci>
      </apply>
      <ci>k</ci>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <minus></minus>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>X</ci>
      <apply>
       <times></times>
       <ci>i</ci>
       <ci>j</ci>
      </apply>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <eq></eq>
    <cn type="integer">0</cn>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">j</csymbol>
     <eq></eq>
     <cn type="integer">1</cn>
     <ci>normal-,</ci>
     <cn type="integer">2</cn>
     <ci>normal-,</ci>
     <ci>normal-…</ci>
     <ci>normal-,</ci>
     <csymbol cd="unknown">n</csymbol>
     <ci>normal-)</ci>
    </cerror>
    <ci>normal-.</ci>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   2\sum_{i=1}^{m}\left(y_{i}-\sum_{k=1}^{n}X_{ik}\hat{\beta}_{k}\right)(-X_{ij})%
=0\ (j=1,2,\dots,n).
  </annotation>
 </semantics>
</math>

</p>

<p>Upon rearrangement, we obtain the <strong>normal equations</strong>:</p>

<p>

<math display="block" id="Linear_least_squares_(mathematics):54">
 <semantics>
  <mrow>
   <munderover>
    <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
    <mrow>
     <mi>i</mi>
     <mo>=</mo>
     <mn>1</mn>
    </mrow>
    <mi>m</mi>
   </munderover>
   <munderover>
    <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
    <mrow>
     <mi>k</mi>
     <mo>=</mo>
     <mn>1</mn>
    </mrow>
    <mi>n</mi>
   </munderover>
   <msub>
    <mi>X</mi>
    <mrow>
     <mi>i</mi>
     <mi>j</mi>
    </mrow>
   </msub>
   <msub>
    <mi>X</mi>
    <mrow>
     <mi>i</mi>
     <mi>k</mi>
    </mrow>
   </msub>
   <msub>
    <mover accent="true">
     <mi>β</mi>
     <mo stretchy="false">^</mo>
    </mover>
    <mi>k</mi>
   </msub>
   <mo>=</mo>
   <munderover>
    <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
    <mrow>
     <mi>i</mi>
     <mo>=</mo>
     <mn>1</mn>
    </mrow>
    <mi>m</mi>
   </munderover>
   <msub>
    <mi>X</mi>
    <mrow>
     <mi>i</mi>
     <mi>j</mi>
    </mrow>
   </msub>
   <mpadded width="+5pt">
    <msub>
     <mi>y</mi>
     <mi>i</mi>
    </msub>
   </mpadded>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>j</mi>
    <mo>=</mo>
    <mn>1</mn>
    <mo>,</mo>
    <mn>2</mn>
    <mo>,</mo>
    <mi mathvariant="normal">…</mi>
    <mo>,</mo>
    <mi>n</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <sum></sum>
      <apply>
       <eq></eq>
       <ci>i</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <ci>m</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <sum></sum>
      <apply>
       <eq></eq>
       <ci>k</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <ci>n</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>X</ci>
     <apply>
      <times></times>
      <ci>i</ci>
      <ci>j</ci>
     </apply>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>X</ci>
     <apply>
      <times></times>
      <ci>i</ci>
      <ci>k</ci>
     </apply>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <ci>normal-^</ci>
      <ci>β</ci>
     </apply>
     <ci>k</ci>
    </apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <sum></sum>
      <apply>
       <eq></eq>
       <ci>i</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <ci>m</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>X</ci>
     <apply>
      <times></times>
      <ci>i</ci>
      <ci>j</ci>
     </apply>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>y</ci>
     <ci>i</ci>
    </apply>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">j</csymbol>
     <eq></eq>
     <cn type="integer">1</cn>
     <ci>normal-,</ci>
     <cn type="integer">2</cn>
     <ci>normal-,</ci>
     <ci>normal-…</ci>
     <ci>normal-,</ci>
     <csymbol cd="unknown">n</csymbol>
     <ci>normal-)</ci>
    </cerror>
    <ci>normal-.</ci>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \sum_{i=1}^{m}\sum_{k=1}^{n}X_{ij}X_{ik}\hat{\beta}_{k}=\sum_{i=1}^{m}X_{ij}y_%
{i}\ (j=1,2,\dots,n).
  </annotation>
 </semantics>
</math>

</p>

<p>The normal equations are written in matrix notation as</p>

<p>

<math display="block" id="Linear_least_squares_(mathematics):55">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <msup>
       <mi>𝐗</mi>
       <mi mathvariant="normal">T</mi>
      </msup>
      <mi>𝐗</mi>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
    <mover accent="true">
     <mi>𝜷</mi>
     <mo stretchy="false">^</mo>
    </mover>
   </mrow>
   <mo>=</mo>
   <mrow>
    <msup>
     <mi>𝐗</mi>
     <mi mathvariant="normal">T</mi>
    </msup>
    <mi>𝐲</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>𝐗</ci>
       <ci>normal-T</ci>
      </apply>
      <ci>𝐗</ci>
     </apply>
     <apply>
      <ci>normal-^</ci>
      <ci>𝜷</ci>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>𝐗</ci>
      <ci>normal-T</ci>
     </apply>
     <ci>𝐲</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (\mathbf{X}^{\mathrm{T}}\mathbf{X})\hat{\boldsymbol{\beta}}=\mathbf{X}^{%
\mathrm{T}}\mathbf{y}
  </annotation>
 </semantics>
</math>

 (where <em>X</em><sup>T</sup> is the <a href="matrix_transpose" title="wikilink">matrix transpose</a> of <em>X</em>).</p>

<p>The solution of the normal equations yields the vector 

<math display="inline" id="Linear_least_squares_(mathematics):56">
 <semantics>
  <mover accent="true">
   <mi>𝜷</mi>
   <mo stretchy="false">^</mo>
  </mover>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-^</ci>
    <ci>𝜷</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \hat{\boldsymbol{\beta}}
  </annotation>
 </semantics>
</math>

 of the optimal parameter values.</p>
<h3 id="derivation-directly-in-terms-of-matrices">Derivation directly in terms of matrices</h3>

<p>The normal equations can be derived directly from a matrix representation of the problem as follows. The objective is to minimize</p>

<p>

<math display="block" id="Linear_least_squares_(mathematics):57">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>S</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>𝜷</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <msup>
     <mrow>
      <mo fence="true" maxsize="120%" minsize="120%">∥</mo>
      <mrow>
       <mi>𝐲</mi>
       <mo>-</mo>
       <mrow>
        <mi>𝐗</mi>
        <mi>𝜷</mi>
       </mrow>
      </mrow>
      <mo fence="true" maxsize="120%" minsize="120%">∥</mo>
     </mrow>
     <mn>2</mn>
    </msup>
    <mo>=</mo>
    <mrow>
     <msup>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mi>𝐲</mi>
        <mo>-</mo>
        <mrow>
         <mi>𝐗</mi>
         <mi>𝜷</mi>
        </mrow>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
      <mi mathvariant="normal">T</mi>
     </msup>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mi>𝐲</mi>
       <mo>-</mo>
       <mrow>
        <mi>𝐗</mi>
        <mi>𝜷</mi>
       </mrow>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mrow>
       <msup>
        <mi>𝐲</mi>
        <mi mathvariant="normal">T</mi>
       </msup>
       <mi>𝐲</mi>
      </mrow>
      <mo>-</mo>
      <mrow>
       <msup>
        <mi>𝜷</mi>
        <mi mathvariant="normal">T</mi>
       </msup>
       <msup>
        <mi>𝐗</mi>
        <mi mathvariant="normal">T</mi>
       </msup>
       <mi>𝐲</mi>
      </mrow>
      <mo>-</mo>
      <mrow>
       <msup>
        <mi>𝐲</mi>
        <mi mathvariant="normal">T</mi>
       </msup>
       <mi>𝐗</mi>
       <mi>𝜷</mi>
      </mrow>
     </mrow>
     <mo>+</mo>
     <mrow>
      <msup>
       <mi>𝜷</mi>
       <mi mathvariant="normal">T</mi>
      </msup>
      <msup>
       <mi>𝐗</mi>
       <mi mathvariant="normal">T</mi>
      </msup>
      <mi>𝐗</mi>
      <mi>𝜷</mi>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <times></times>
      <ci>S</ci>
      <ci>𝜷</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="latexml">norm</csymbol>
       <apply>
        <minus></minus>
        <ci>𝐲</ci>
        <apply>
         <times></times>
         <ci>𝐗</ci>
         <ci>𝜷</ci>
        </apply>
       </apply>
      </apply>
      <cn type="integer">2</cn>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <minus></minus>
        <ci>𝐲</ci>
        <apply>
         <times></times>
         <ci>𝐗</ci>
         <ci>𝜷</ci>
        </apply>
       </apply>
       <ci>normal-T</ci>
      </apply>
      <apply>
       <minus></minus>
       <ci>𝐲</ci>
       <apply>
        <times></times>
        <ci>𝐗</ci>
        <ci>𝜷</ci>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <plus></plus>
      <apply>
       <minus></minus>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>𝐲</ci>
         <ci>normal-T</ci>
        </apply>
        <ci>𝐲</ci>
       </apply>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>𝜷</ci>
         <ci>normal-T</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>𝐗</ci>
         <ci>normal-T</ci>
        </apply>
        <ci>𝐲</ci>
       </apply>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>𝐲</ci>
         <ci>normal-T</ci>
        </apply>
        <ci>𝐗</ci>
        <ci>𝜷</ci>
       </apply>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>𝜷</ci>
        <ci>normal-T</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>𝐗</ci>
        <ci>normal-T</ci>
       </apply>
       <ci>𝐗</ci>
       <ci>𝜷</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   S(\boldsymbol{\beta})=\bigl\|\mathbf{y}-\mathbf{X}\boldsymbol{\beta}\bigr\|^{2%
}=(\mathbf{y}-\mathbf{X}\boldsymbol{\beta})^{\rm T}(\mathbf{y}-\mathbf{X}%
\boldsymbol{\beta})=\mathbf{y}^{\rm T}\mathbf{y}-\boldsymbol{\beta}^{\rm T}%
\mathbf{X}^{\rm T}\mathbf{y}-\mathbf{y}^{\rm T}\mathbf{X}\boldsymbol{\beta}+%
\boldsymbol{\beta}^{\rm T}\mathbf{X}^{\rm T}\mathbf{X}\boldsymbol{\beta}.
  </annotation>
 </semantics>
</math>

</p>

<p>Note that 

<math display="block" id="Linear_least_squares_(mathematics):58">
 <semantics>
  <mrow>
   <msup>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <msup>
       <mi>𝜷</mi>
       <mi mathvariant="normal">T</mi>
      </msup>
      <msup>
       <mi>𝐗</mi>
       <mi mathvariant="normal">T</mi>
      </msup>
      <mi>𝐲</mi>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
    <mi mathvariant="normal">T</mi>
   </msup>
   <mo>=</mo>
   <mrow>
    <msup>
     <mi>𝐲</mi>
     <mi mathvariant="normal">T</mi>
    </msup>
    <mi>𝐗</mi>
    <mi>𝜷</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>𝜷</ci>
       <ci>normal-T</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>𝐗</ci>
       <ci>normal-T</ci>
      </apply>
      <ci>𝐲</ci>
     </apply>
     <ci>normal-T</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>𝐲</ci>
      <ci>normal-T</ci>
     </apply>
     <ci>𝐗</ci>
     <ci>𝜷</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (\boldsymbol{\beta}^{\rm T}\mathbf{X}^{\rm T}\mathbf{y})^{\rm T}=\mathbf{y}^{%
\rm T}\mathbf{X}\boldsymbol{\beta}
  </annotation>
 </semantics>
</math>

 has the dimension 1x1 (the number of columns of 

<math display="inline" id="Linear_least_squares_(mathematics):59">
 <semantics>
  <mi>𝐲</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>𝐲</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{y}
  </annotation>
 </semantics>
</math>

), so it is a scalar and equal to its own transpose, hence 

<math display="inline" id="Linear_least_squares_(mathematics):60">
 <semantics>
  <mrow>
   <mrow>
    <msup>
     <mi>𝜷</mi>
     <mi mathvariant="normal">T</mi>
    </msup>
    <msup>
     <mi>𝐗</mi>
     <mi mathvariant="normal">T</mi>
    </msup>
    <mi>𝐲</mi>
   </mrow>
   <mo>=</mo>
   <mrow>
    <msup>
     <mi>𝐲</mi>
     <mi mathvariant="normal">T</mi>
    </msup>
    <mi>𝐗</mi>
    <mi>𝜷</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>𝜷</ci>
      <ci>normal-T</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>𝐗</ci>
      <ci>normal-T</ci>
     </apply>
     <ci>𝐲</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>𝐲</ci>
      <ci>normal-T</ci>
     </apply>
     <ci>𝐗</ci>
     <ci>𝜷</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \boldsymbol{\beta}^{\rm T}\mathbf{X}^{\rm T}\mathbf{y}=\mathbf{y}^{\rm T}%
\mathbf{X}\boldsymbol{\beta}
  </annotation>
 </semantics>
</math>

 and the quantity to minimize becomes</p>

<p>

<math display="block" id="Linear_least_squares_(mathematics):61">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>S</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>𝜷</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mrow>
       <msup>
        <mi>𝐲</mi>
        <mi mathvariant="normal">T</mi>
       </msup>
       <mi>𝐲</mi>
      </mrow>
      <mo>-</mo>
      <mrow>
       <mn>2</mn>
       <msup>
        <mi>𝜷</mi>
        <mi mathvariant="normal">T</mi>
       </msup>
       <msup>
        <mi>𝐗</mi>
        <mi mathvariant="normal">T</mi>
       </msup>
       <mi>𝐲</mi>
      </mrow>
     </mrow>
     <mo>+</mo>
     <mrow>
      <msup>
       <mi>𝜷</mi>
       <mi mathvariant="normal">T</mi>
      </msup>
      <msup>
       <mi>𝐗</mi>
       <mi mathvariant="normal">T</mi>
      </msup>
      <mi>𝐗</mi>
      <mi>𝜷</mi>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>S</ci>
     <ci>𝜷</ci>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <minus></minus>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>𝐲</ci>
        <ci>normal-T</ci>
       </apply>
       <ci>𝐲</ci>
      </apply>
      <apply>
       <times></times>
       <cn type="integer">2</cn>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>𝜷</ci>
        <ci>normal-T</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>𝐗</ci>
        <ci>normal-T</ci>
       </apply>
       <ci>𝐲</ci>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>𝜷</ci>
       <ci>normal-T</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>𝐗</ci>
       <ci>normal-T</ci>
      </apply>
      <ci>𝐗</ci>
      <ci>𝜷</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   S(\boldsymbol{\beta})=\mathbf{y}^{\rm T}\mathbf{y}-2\boldsymbol{\beta}^{\rm T}%
\mathbf{X}^{\rm T}\mathbf{y}+\boldsymbol{\beta}^{\rm T}\mathbf{X}^{\rm T}%
\mathbf{X}\boldsymbol{\beta}.
  </annotation>
 </semantics>
</math>

</p>

<p><a href="Matrix_differentiation#Scalar-by-vector" title="wikilink">Differentiating</a> this with respect to 

<math display="inline" id="Linear_least_squares_(mathematics):62">
 <semantics>
  <mi>𝜷</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>𝜷</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \boldsymbol{\beta}
  </annotation>
 </semantics>
</math>

 and equating to zero to satisfy the first-order conditions gives</p>

<p>

<math display="block" id="Linear_least_squares_(mathematics):63">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mrow>
      <mo>-</mo>
      <mrow>
       <msup>
        <mi>𝐗</mi>
        <mi mathvariant="normal">T</mi>
       </msup>
       <mi>𝐲</mi>
      </mrow>
     </mrow>
     <mo>+</mo>
     <mrow>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <msup>
         <mi>𝐗</mi>
         <mi mathvariant="normal">T</mi>
        </msup>
        <mi>𝐗</mi>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
      <mi>𝜷</mi>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mn>0</mn>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <plus></plus>
     <apply>
      <minus></minus>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>𝐗</ci>
        <ci>normal-T</ci>
       </apply>
       <ci>𝐲</ci>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>𝐗</ci>
        <ci>normal-T</ci>
       </apply>
       <ci>𝐗</ci>
      </apply>
      <ci>𝜷</ci>
     </apply>
    </apply>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   -\mathbf{X}^{\rm T}\mathbf{y}+(\mathbf{X}^{\rm T}\mathbf{X}){\boldsymbol{\beta%
}}=0,
  </annotation>
 </semantics>
</math>

</p>

<p>which is equivalent to the above-given normal equations. A sufficient condition for satisfaction of the second-order conditions for a minimum is that 

<math display="inline" id="Linear_least_squares_(mathematics):64">
 <semantics>
  <mi>𝐗</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>𝐗</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{X}
  </annotation>
 </semantics>
</math>

 have full column rank, in which case 

<math display="inline" id="Linear_least_squares_(mathematics):65">
 <semantics>
  <mrow>
   <msup>
    <mi>𝐗</mi>
    <mi mathvariant="normal">T</mi>
   </msup>
   <mi>𝐗</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>𝐗</ci>
     <ci>normal-T</ci>
    </apply>
    <ci>𝐗</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{X}^{\rm T}\mathbf{X}
  </annotation>
 </semantics>
</math>

 is <a href="Positive_definite_matrix" title="wikilink">positive definite</a>.</p>
<h3 id="derivation-without-calculus">Derivation without calculus</h3>

<p>When 

<math display="inline" id="Linear_least_squares_(mathematics):66">
 <semantics>
  <mrow>
   <msup>
    <mi>𝐗</mi>
    <mi mathvariant="normal">T</mi>
   </msup>
   <mi>𝐗</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>𝐗</ci>
     <ci>normal-T</ci>
    </apply>
    <ci>𝐗</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{X}^{\rm T}\mathbf{X}
  </annotation>
 </semantics>
</math>

 is positive definite, the formula for the minimizing value of 

<math display="inline" id="Linear_least_squares_(mathematics):67">
 <semantics>
  <mi>𝜷</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>𝜷</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \boldsymbol{\beta}
  </annotation>
 </semantics>
</math>

 can be derived without the use of derivatives. The quantity</p>

<p>

<math display="block" id="Linear_least_squares_(mathematics):68">
 <semantics>
  <mrow>
   <mrow>
    <mi>S</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>𝜷</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mrow>
      <msup>
       <mi>𝐲</mi>
       <mi mathvariant="normal">T</mi>
      </msup>
      <mi>𝐲</mi>
     </mrow>
     <mo>-</mo>
     <mrow>
      <mn>2</mn>
      <msup>
       <mi>𝜷</mi>
       <mi mathvariant="normal">T</mi>
      </msup>
      <msup>
       <mi>𝐗</mi>
       <mi mathvariant="normal">T</mi>
      </msup>
      <mi>𝐲</mi>
     </mrow>
    </mrow>
    <mo>+</mo>
    <mrow>
     <msup>
      <mi>𝜷</mi>
      <mi mathvariant="normal">T</mi>
     </msup>
     <msup>
      <mi>𝐗</mi>
      <mi mathvariant="normal">T</mi>
     </msup>
     <mi>𝐗</mi>
     <mi>𝜷</mi>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>S</ci>
     <ci>𝜷</ci>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <minus></minus>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>𝐲</ci>
        <ci>normal-T</ci>
       </apply>
       <ci>𝐲</ci>
      </apply>
      <apply>
       <times></times>
       <cn type="integer">2</cn>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>𝜷</ci>
        <ci>normal-T</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>𝐗</ci>
        <ci>normal-T</ci>
       </apply>
       <ci>𝐲</ci>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>𝜷</ci>
       <ci>normal-T</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>𝐗</ci>
       <ci>normal-T</ci>
      </apply>
      <ci>𝐗</ci>
      <ci>𝜷</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   S(\boldsymbol{\beta})=\mathbf{y}^{\rm T}\mathbf{y}-2\boldsymbol{\beta}^{\rm T}%
\mathbf{X}^{\rm T}\mathbf{y}+\boldsymbol{\beta}^{\rm T}\mathbf{X}^{\rm T}%
\mathbf{X}\boldsymbol{\beta}
  </annotation>
 </semantics>
</math>

</p>

<p>can be written as</p>

<p>

<math display="block" id="Linear_least_squares_(mathematics):69">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mrow>
      <mo stretchy="false">⟨</mo>
      <mi>𝜷</mi>
      <mo>,</mo>
      <mi>𝜷</mi>
      <mo stretchy="false">⟩</mo>
     </mrow>
     <mo>-</mo>
     <mrow>
      <mn>2</mn>
      <mrow>
       <mo stretchy="false">⟨</mo>
       <mi>𝜷</mi>
       <mo>,</mo>
       <mrow>
        <msup>
         <mrow>
          <mo stretchy="false">(</mo>
          <mrow>
           <msup>
            <mi>𝐗</mi>
            <mi mathvariant="normal">T</mi>
           </msup>
           <mi>𝐗</mi>
          </mrow>
          <mo stretchy="false">)</mo>
         </mrow>
         <mrow>
          <mo>-</mo>
          <mn>1</mn>
         </mrow>
        </msup>
        <msup>
         <mi>𝐗</mi>
         <mi mathvariant="normal">T</mi>
        </msup>
        <mi>𝐲</mi>
       </mrow>
       <mo stretchy="false">⟩</mo>
      </mrow>
     </mrow>
    </mrow>
    <mo>+</mo>
    <mrow>
     <mo stretchy="false">⟨</mo>
     <mrow>
      <msup>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <msup>
          <mi>𝐗</mi>
          <mi mathvariant="normal">T</mi>
         </msup>
         <mi>𝐗</mi>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
       <mrow>
        <mo>-</mo>
        <mn>1</mn>
       </mrow>
      </msup>
      <msup>
       <mi>𝐗</mi>
       <mi mathvariant="normal">T</mi>
      </msup>
      <mi>𝐲</mi>
     </mrow>
     <mo>,</mo>
     <mrow>
      <msup>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <msup>
          <mi>𝐗</mi>
          <mi mathvariant="normal">T</mi>
         </msup>
         <mi>𝐗</mi>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
       <mrow>
        <mo>-</mo>
        <mn>1</mn>
       </mrow>
      </msup>
      <msup>
       <mi>𝐗</mi>
       <mi mathvariant="normal">T</mi>
      </msup>
      <mi>𝐲</mi>
     </mrow>
     <mo stretchy="false">⟩</mo>
    </mrow>
    <mo>+</mo>
    <mi>C</mi>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <plus></plus>
    <apply>
     <minus></minus>
     <list>
      <ci>𝜷</ci>
      <ci>𝜷</ci>
     </list>
     <apply>
      <times></times>
      <cn type="integer">2</cn>
      <list>
       <ci>𝜷</ci>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <times></times>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <ci>𝐗</ci>
           <ci>normal-T</ci>
          </apply>
          <ci>𝐗</ci>
         </apply>
         <apply>
          <minus></minus>
          <cn type="integer">1</cn>
         </apply>
        </apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>𝐗</ci>
         <ci>normal-T</ci>
        </apply>
        <ci>𝐲</ci>
       </apply>
      </list>
     </apply>
    </apply>
    <list>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>𝐗</ci>
         <ci>normal-T</ci>
        </apply>
        <ci>𝐗</ci>
       </apply>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>𝐗</ci>
       <ci>normal-T</ci>
      </apply>
      <ci>𝐲</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>𝐗</ci>
         <ci>normal-T</ci>
        </apply>
        <ci>𝐗</ci>
       </apply>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>𝐗</ci>
       <ci>normal-T</ci>
      </apply>
      <ci>𝐲</ci>
     </apply>
    </list>
    <ci>C</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \langle\boldsymbol{\beta},\boldsymbol{\beta}\rangle-2\langle\boldsymbol{\beta}%
,(\mathbf{X}^{\rm T}\mathbf{X})^{-1}\mathbf{X}^{\rm T}\mathbf{y}\rangle+%
\langle(\mathbf{X}^{\rm T}\mathbf{X})^{-1}\mathbf{X}^{\rm T}\mathbf{y},(%
\mathbf{X}^{\rm T}\mathbf{X})^{-1}\mathbf{X}^{\rm T}\mathbf{y}\rangle+C,
  </annotation>
 </semantics>
</math>

</p>

<p>where 

<math display="inline" id="Linear_least_squares_(mathematics):70">
 <semantics>
  <mi>C</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>C</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   C
  </annotation>
 </semantics>
</math>

 depends only on 

<math display="inline" id="Linear_least_squares_(mathematics):71">
 <semantics>
  <mi>𝐲</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>𝐲</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{y}
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Linear_least_squares_(mathematics):72">
 <semantics>
  <mi>𝐗</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>𝐗</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{X}
  </annotation>
 </semantics>
</math>

, and 

<math display="inline" id="Linear_least_squares_(mathematics):73">
 <semantics>
  <mrow>
   <mo stretchy="false">⟨</mo>
   <mo>⋅</mo>
   <mo>,</mo>
   <mo>⋅</mo>
   <mo stretchy="false">⟩</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <list>
    <ci>normal-⋅</ci>
    <ci>normal-⋅</ci>
   </list>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \langle\cdot,\cdot\rangle
  </annotation>
 </semantics>
</math>

 is the <a href="Dot_product" title="wikilink">inner product</a> defined by</p>

<p>

<math display="block" id="Linear_least_squares_(mathematics):74">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mo stretchy="false">⟨</mo>
     <mi>x</mi>
     <mo>,</mo>
     <mi>y</mi>
     <mo stretchy="false">⟩</mo>
    </mrow>
    <mo>=</mo>
    <mrow>
     <msup>
      <mi>x</mi>
      <mi mathvariant="normal">T</mi>
     </msup>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <msup>
        <mi>𝐗</mi>
        <mi mathvariant="normal">T</mi>
       </msup>
       <mi>𝐗</mi>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <mi>y</mi>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <list>
     <ci>x</ci>
     <ci>y</ci>
    </list>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>x</ci>
      <ci>normal-T</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>𝐗</ci>
       <ci>normal-T</ci>
      </apply>
      <ci>𝐗</ci>
     </apply>
     <ci>y</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \langle x,y\rangle=x^{\rm T}(\mathbf{X}^{\rm T}\mathbf{X})y.
  </annotation>
 </semantics>
</math>

</p>

<p>It follows that 

<math display="inline" id="Linear_least_squares_(mathematics):75">
 <semantics>
  <mrow>
   <mi>S</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>𝜷</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>S</ci>
    <ci>𝜷</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   S(\boldsymbol{\beta})
  </annotation>
 </semantics>
</math>

 is equal to</p>

<p>

<math display="block" id="Linear_least_squares_(mathematics):76">
 <semantics>
  <mrow>
   <mrow>
    <mo stretchy="false">⟨</mo>
    <mrow>
     <mi>𝜷</mi>
     <mo>-</mo>
     <mrow>
      <msup>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <msup>
          <mi>𝐗</mi>
          <mi mathvariant="normal">T</mi>
         </msup>
         <mi>𝐗</mi>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
       <mrow>
        <mo>-</mo>
        <mn>1</mn>
       </mrow>
      </msup>
      <msup>
       <mi>𝐗</mi>
       <mi mathvariant="normal">T</mi>
      </msup>
      <mi>𝐲</mi>
     </mrow>
    </mrow>
    <mo>,</mo>
    <mrow>
     <mi>𝜷</mi>
     <mo>-</mo>
     <mrow>
      <msup>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <msup>
          <mi>𝐗</mi>
          <mi mathvariant="normal">T</mi>
         </msup>
         <mi>𝐗</mi>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
       <mrow>
        <mo>-</mo>
        <mn>1</mn>
       </mrow>
      </msup>
      <msup>
       <mi>𝐗</mi>
       <mi mathvariant="normal">T</mi>
      </msup>
      <mi>𝐲</mi>
     </mrow>
    </mrow>
    <mo stretchy="false">⟩</mo>
   </mrow>
   <mo>+</mo>
   <mi>C</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <plus></plus>
    <list>
     <apply>
      <minus></minus>
      <ci>𝜷</ci>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <times></times>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>𝐗</ci>
          <ci>normal-T</ci>
         </apply>
         <ci>𝐗</ci>
        </apply>
        <apply>
         <minus></minus>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>𝐗</ci>
        <ci>normal-T</ci>
       </apply>
       <ci>𝐲</ci>
      </apply>
     </apply>
     <apply>
      <minus></minus>
      <ci>𝜷</ci>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <times></times>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>𝐗</ci>
          <ci>normal-T</ci>
         </apply>
         <ci>𝐗</ci>
        </apply>
        <apply>
         <minus></minus>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>𝐗</ci>
        <ci>normal-T</ci>
       </apply>
       <ci>𝐲</ci>
      </apply>
     </apply>
    </list>
    <ci>C</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \langle\boldsymbol{\beta}-(\mathbf{X}^{\rm T}\mathbf{X})^{-1}\mathbf{X}^{\rm T%
}\mathbf{y},\boldsymbol{\beta}-(\mathbf{X}^{\rm T}\mathbf{X})^{-1}\mathbf{X}^{%
\rm T}\mathbf{y}\rangle+C
  </annotation>
 </semantics>
</math>

</p>

<p>and therefore minimized exactly when</p>

<p>

<math display="block" id="Linear_least_squares_(mathematics):77">
 <semantics>
  <mrow>
   <mrow>
    <mi>𝜷</mi>
    <mo>-</mo>
    <mrow>
     <msup>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <msup>
         <mi>𝐗</mi>
         <mi mathvariant="normal">T</mi>
        </msup>
        <mi>𝐗</mi>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
      <mrow>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
     </msup>
     <msup>
      <mi>𝐗</mi>
      <mi mathvariant="normal">T</mi>
     </msup>
     <mi>𝐲</mi>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mn>0.</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <minus></minus>
     <ci>𝜷</ci>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>𝐗</ci>
         <ci>normal-T</ci>
        </apply>
        <ci>𝐗</ci>
       </apply>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>𝐗</ci>
       <ci>normal-T</ci>
      </apply>
      <ci>𝐲</ci>
     </apply>
    </apply>
    <cn type="float">0.</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \boldsymbol{\beta}-(\mathbf{X}^{\rm T}\mathbf{X})^{-1}\mathbf{X}^{\rm T}%
\mathbf{y}=0.
  </annotation>
 </semantics>
</math>

</p>
<h2 id="computation">Computation</h2>

<p>A general approach to the least squares problem 

<math display="inline" id="Linear_least_squares_(mathematics):78">
 <semantics>
  <mrow>
   <mo lspace="4.2pt" rspace="4.2pt">min</mo>
   <msup>
    <mrow>
     <mo mathsize="120%" stretchy="false">∥</mo>
     <mrow>
      <mi>𝐲</mi>
      <mo>-</mo>
      <mrow>
       <mi>X</mi>
       <mi>𝜷</mi>
      </mrow>
     </mrow>
     <mo mathsize="120%" stretchy="false">∥</mo>
    </mrow>
    <mn>2</mn>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>min</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="latexml">norm</csymbol>
      <apply>
       <minus></minus>
       <ci>𝐲</ci>
       <apply>
        <times></times>
        <ci>X</ci>
        <ci>𝜷</ci>
       </apply>
      </apply>
     </apply>
     <cn type="integer">2</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \operatorname{\,min}\,\big\|\mathbf{y}-X\boldsymbol{\beta}\big\|^{2}
  </annotation>
 </semantics>
</math>

 can be described as follows. Suppose that we can find an <em>n</em> by <em>m</em> matrix <strong>S</strong> such that <strong>XS</strong> is an <a href="Linear_projection" title="wikilink">orthogonal projection</a> onto the image of <strong>X</strong>. Then a solution to our minimization problem is given by</p>

<p>

<math display="block" id="Linear_least_squares_(mathematics):79">
 <semantics>
  <mrow>
   <mi>𝜷</mi>
   <mo>=</mo>
   <mrow>
    <mi>S</mi>
    <mi>𝐲</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>𝜷</ci>
    <apply>
     <times></times>
     <ci>S</ci>
     <ci>𝐲</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \boldsymbol{\beta}=S\mathbf{y}
  </annotation>
 </semantics>
</math>

</p>

<p>simply because</p>

<p>

<math display="block" id="Linear_least_squares_(mathematics):80">
 <semantics>
  <mrow>
   <mrow>
    <mi>X</mi>
    <mi>𝜷</mi>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mi>X</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>S</mi>
      <mi>𝐲</mi>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>X</mi>
      <mi>S</mi>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
    <mi>𝐲</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <times></times>
      <ci>X</ci>
      <ci>𝜷</ci>
     </apply>
     <apply>
      <times></times>
      <ci>X</ci>
      <apply>
       <times></times>
       <ci>S</ci>
       <ci>𝐲</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <apply>
       <times></times>
       <ci>X</ci>
       <ci>S</ci>
      </apply>
      <ci>𝐲</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   X\boldsymbol{\beta}=X(S\mathbf{y})=(XS)\mathbf{y}
  </annotation>
 </semantics>
</math>

</p>

<p>is exactly a sought for orthogonal projection of 

<math display="inline" id="Linear_least_squares_(mathematics):81">
 <semantics>
  <mi>𝐲</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>𝐲</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{y}
  </annotation>
 </semantics>
</math>

 onto an image of <strong>X</strong> (<a href="#Properties_of_the_least-squares_estimators" title="wikilink">see the picture below</a> and note that as explained in the <a href="#Properties_of_the_least-squares_estimators" title="wikilink">next section</a> the image of <strong>X</strong> is just a subspace generated by column vectors of <strong>X</strong>). A few popular ways to find such a matrix <em>S</em> are described below.</p>
<h3 id="inverting-the-matrix-of-the-normal-equations-or-the-gramian-matrix-in-short">Inverting the matrix of the normal equations (Or the <a href="Gramian_matrix" title="wikilink">Gramian matrix</a>, in short)</h3>

<p>The algebraic solution of the normal equations can be written as</p>

<p>

<math display="block" id="Linear_least_squares_(mathematics):82">
 <semantics>
  <mrow>
   <mover accent="true">
    <mi>𝜷</mi>
    <mo stretchy="false">^</mo>
   </mover>
   <mo>=</mo>
   <mrow>
    <msup>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <msup>
        <mi>𝐗</mi>
        <mi mathvariant="normal">T</mi>
       </msup>
       <mi>𝐗</mi>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <mrow>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </msup>
    <msup>
     <mi>𝐗</mi>
     <mi mathvariant="normal">T</mi>
    </msup>
    <mi>𝐲</mi>
   </mrow>
   <mo>=</mo>
   <mrow>
    <msup>
     <mi>𝐗</mi>
     <mo>+</mo>
    </msup>
    <mi>𝐲</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <ci>normal-^</ci>
      <ci>𝜷</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>𝐗</ci>
         <ci>normal-T</ci>
        </apply>
        <ci>𝐗</ci>
       </apply>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>𝐗</ci>
       <ci>normal-T</ci>
      </apply>
      <ci>𝐲</ci>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>𝐗</ci>
       <plus></plus>
      </apply>
      <ci>𝐲</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \hat{\boldsymbol{\beta}}=(\mathbf{X}^{\rm T}\mathbf{X})^{-1}\mathbf{X}^{\rm T}%
\mathbf{y}=\mathbf{X}^{+}\mathbf{y}
  </annotation>
 </semantics>
</math>

</p>

<p>where <em>X</em> <sup>+</sup> is the <a href="Moore–Penrose_pseudoinverse" title="wikilink">Moore–Penrose pseudoinverse</a> of <em>X</em>. Although this equation is correct, and can work in many applications, it is not computationally efficient to invert the normal equations matrix. An exception occurs in <a href="numerical_smoothing_and_differentiation" title="wikilink">numerical smoothing and differentiation</a> where an analytical expression is required.</p>

<p>If the matrix <em>X</em><sup>T</sup><em>X</em> is <a href="Condition_number" title="wikilink">well-conditioned</a> and <a href="Positive-definite_matrix" title="wikilink">positive definite</a>, implying that it has full <a href="rank_(linear_algebra)" title="wikilink">rank</a>, the normal equations can be solved directly by using the <a href="Cholesky_decomposition" title="wikilink">Cholesky decomposition</a> <em>R</em><sup>T</sup><em>R</em>, where <em>R</em> is an upper <a href="triangular_matrix" title="wikilink">triangular matrix</a>, giving:</p>

<p>

<math display="block" id="Linear_least_squares_(mathematics):83">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <msup>
      <mi>R</mi>
      <mi mathvariant="normal">T</mi>
     </msup>
     <mi>R</mi>
     <mover accent="true">
      <mi>𝜷</mi>
      <mo stretchy="false">^</mo>
     </mover>
    </mrow>
    <mo>=</mo>
    <mrow>
     <msup>
      <mi>X</mi>
      <mi mathvariant="normal">T</mi>
     </msup>
     <mi>𝐲</mi>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>R</ci>
      <ci>normal-T</ci>
     </apply>
     <ci>R</ci>
     <apply>
      <ci>normal-^</ci>
      <ci>𝜷</ci>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>X</ci>
      <ci>normal-T</ci>
     </apply>
     <ci>𝐲</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   R^{\rm T}R\hat{\boldsymbol{\beta}}=X^{\rm T}\mathbf{y}.
  </annotation>
 </semantics>
</math>

</p>

<p>The solution is obtained in two stages, a <a href="forward_substitution" title="wikilink">forward substitution</a> step, solving for <strong>z</strong>:</p>

<p>

<math display="block" id="Linear_least_squares_(mathematics):84">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <msup>
      <mi>R</mi>
      <mi mathvariant="normal">T</mi>
     </msup>
     <mi>𝐳</mi>
    </mrow>
    <mo>=</mo>
    <mrow>
     <msup>
      <mi>X</mi>
      <mi mathvariant="normal">T</mi>
     </msup>
     <mi>𝐲</mi>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>R</ci>
      <ci>normal-T</ci>
     </apply>
     <ci>𝐳</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>X</ci>
      <ci>normal-T</ci>
     </apply>
     <ci>𝐲</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   R^{\rm T}\mathbf{z}=X^{\rm T}\mathbf{y},
  </annotation>
 </semantics>
</math>

</p>

<p>followed by a backward substitution, solving for 

<math display="inline" id="Linear_least_squares_(mathematics):85">
 <semantics>
  <mover accent="true">
   <mi>𝜷</mi>
   <mo stretchy="false">^</mo>
  </mover>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-^</ci>
    <ci>𝜷</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \hat{\boldsymbol{\beta}}
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Linear_least_squares_(mathematics):86">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>R</mi>
     <mover accent="true">
      <mi>𝜷</mi>
      <mo stretchy="false">^</mo>
     </mover>
    </mrow>
    <mo>=</mo>
    <mi>𝐳</mi>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>R</ci>
     <apply>
      <ci>normal-^</ci>
      <ci>𝜷</ci>
     </apply>
    </apply>
    <ci>𝐳</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   R\hat{\boldsymbol{\beta}}=\mathbf{z}.
  </annotation>
 </semantics>
</math>

</p>

<p>Both substitutions are facilitated by the triangular nature of <em>R</em>.</p>

<p>See <a href="linear_regression#Example" title="wikilink">example of linear regression</a> for a worked-out numerical example with three parameters.</p>
<h3 id="orthogonal-decomposition-methods">Orthogonal decomposition methods</h3>

<p>Orthogonal decomposition methods of solving the least squares problem are slower than the normal equations method but are more <a href="Numerical_stability" title="wikilink">numerically stable</a> because they avoid forming the product <em>X</em><sup>T</sup><em>X</em>.</p>

<p>The residuals are written in matrix notation as</p>

<p>

<math display="block" id="Linear_least_squares_(mathematics):87">
 <semantics>
  <mrow>
   <mrow>
    <mi>𝐫</mi>
    <mo>=</mo>
    <mrow>
     <mi>𝐲</mi>
     <mo>-</mo>
     <mrow>
      <mi>X</mi>
      <mover accent="true">
       <mi>𝜷</mi>
       <mo stretchy="false">^</mo>
      </mover>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>𝐫</ci>
    <apply>
     <minus></minus>
     <ci>𝐲</ci>
     <apply>
      <times></times>
      <ci>X</ci>
      <apply>
       <ci>normal-^</ci>
       <ci>𝜷</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{r}=\mathbf{y}-X\hat{\boldsymbol{\beta}}.
  </annotation>
 </semantics>
</math>

</p>

<p>The matrix <em>X</em> is subjected to an orthogonal decomposition, e.g., the <a href="QR_decomposition" title="wikilink">QR decomposition</a> as follows.</p>

<p>

<math display="block" id="Linear_least_squares_(mathematics):88">
 <semantics>
  <mrow>
   <mi>X</mi>
   <mo>=</mo>
   <mrow>
    <mi>Q</mi>
    <mi>R</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>X</ci>
    <apply>
     <times></times>
     <ci>Q</ci>
     <ci>R</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   X=QR
  </annotation>
 </semantics>
</math>

, where <em>Q</em> is an <em>m</em>×<em>n</em> <a href="orthogonal_matrix" title="wikilink">orthogonal matrix</a> (<em>Q</em><sup>T</sup><em>Q=I</em>) and <em>R</em> is an <em>n</em>×<em>n</em> upper triangular matrix with 

<math display="inline" id="Linear_least_squares_(mathematics):89">
 <semantics>
  <mrow>
   <msub>
    <mi>r</mi>
    <mrow>
     <mi>i</mi>
     <mi>i</mi>
    </mrow>
   </msub>
   <mo>></mo>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <gt></gt>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>r</ci>
     <apply>
      <times></times>
      <ci>i</ci>
      <ci>i</ci>
     </apply>
    </apply>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   r_{ii}>0
  </annotation>
 </semantics>
</math>

.</p>

<p>The residual vector is left-multiplied by <em>Q</em><sup>T</sup>.</p>

<p>

<math display="block" id="Linear_least_squares_(mathematics):90">
 <semantics>
  <mrow>
   <mrow>
    <msup>
     <mi>Q</mi>
     <mi mathvariant="normal">T</mi>
    </msup>
    <mi>𝐫</mi>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <msup>
      <mi>Q</mi>
      <mi mathvariant="normal">T</mi>
     </msup>
     <mi>𝐲</mi>
    </mrow>
    <mo>-</mo>
    <mrow>
     <mrow>
      <mo>(</mo>
      <mrow>
       <msup>
        <mi>Q</mi>
        <mi mathvariant="normal">T</mi>
       </msup>
       <mi>Q</mi>
      </mrow>
      <mo>)</mo>
     </mrow>
     <mi>R</mi>
     <mover accent="true">
      <mi>𝜷</mi>
      <mo stretchy="false">^</mo>
     </mover>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mo>[</mo>
    <mtable displaystyle="true">
     <mtr>
      <mtd columnalign="center">
       <mrow>
        <msub>
         <mrow>
          <mo>(</mo>
          <mrow>
           <msup>
            <mi>Q</mi>
            <mi mathvariant="normal">T</mi>
           </msup>
           <mi>𝐲</mi>
          </mrow>
          <mo>)</mo>
         </mrow>
         <mi>n</mi>
        </msub>
        <mo>-</mo>
        <mrow>
         <mi>R</mi>
         <mover accent="true">
          <mi>𝜷</mi>
          <mo stretchy="false">^</mo>
         </mover>
        </mrow>
       </mrow>
      </mtd>
     </mtr>
     <mtr>
      <mtd columnalign="center">
       <msub>
        <mrow>
         <mo>(</mo>
         <mrow>
          <msup>
           <mi>Q</mi>
           <mi mathvariant="normal">T</mi>
          </msup>
          <mi>𝐲</mi>
         </mrow>
         <mo>)</mo>
        </mrow>
        <mrow>
         <mi>m</mi>
         <mo>-</mo>
         <mi>n</mi>
        </mrow>
       </msub>
      </mtd>
     </mtr>
    </mtable>
    <mo>]</mo>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mo>[</mo>
    <mtable displaystyle="true">
     <mtr>
      <mtd columnalign="center">
       <mi>𝐮</mi>
      </mtd>
     </mtr>
     <mtr>
      <mtd columnalign="center">
       <mi>𝐯</mi>
      </mtd>
     </mtr>
    </mtable>
    <mo>]</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>Q</ci>
       <ci>normal-T</ci>
      </apply>
      <ci>𝐫</ci>
     </apply>
     <apply>
      <minus></minus>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>Q</ci>
        <ci>normal-T</ci>
       </apply>
       <ci>𝐲</ci>
      </apply>
      <apply>
       <times></times>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>Q</ci>
         <ci>normal-T</ci>
        </apply>
        <ci>Q</ci>
       </apply>
       <ci>R</ci>
       <apply>
        <ci>normal-^</ci>
        <ci>𝜷</ci>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <matrix>
      <matrixrow>
       <apply>
        <minus></minus>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <apply>
          <times></times>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <ci>Q</ci>
           <ci>normal-T</ci>
          </apply>
          <ci>𝐲</ci>
         </apply>
         <ci>n</ci>
        </apply>
        <apply>
         <times></times>
         <ci>R</ci>
         <apply>
          <ci>normal-^</ci>
          <ci>𝜷</ci>
         </apply>
        </apply>
       </apply>
      </matrixrow>
      <matrixrow>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <apply>
         <times></times>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>Q</ci>
          <ci>normal-T</ci>
         </apply>
         <ci>𝐲</ci>
        </apply>
        <apply>
         <minus></minus>
         <ci>m</ci>
         <ci>n</ci>
        </apply>
       </apply>
      </matrixrow>
     </matrix>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <matrix>
      <matrixrow>
       <ci>𝐮</ci>
      </matrixrow>
      <matrixrow>
       <ci>𝐯</ci>
      </matrixrow>
     </matrix>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Q^{\rm T}\mathbf{r}=Q^{\rm T}\mathbf{y}-\left(Q^{\rm T}Q\right)R\hat{%
\boldsymbol{\beta}}=\begin{bmatrix}\left(Q^{\rm T}\mathbf{y}\right)_{n}-R\hat{%
\boldsymbol{\beta}}\\
\left(Q^{\rm T}\mathbf{y}\right)_{m-n}\end{bmatrix}=\begin{bmatrix}\mathbf{u}%
\\
\mathbf{v}\end{bmatrix}
  </annotation>
 </semantics>
</math>

</p>

<p>Because <em>Q</em> is <a href="orthogonal_matrix" title="wikilink">orthogonal</a>, the sum of squares of the residuals, <em>s</em>, may be written as:</p>

<p>

<math display="block" id="Linear_least_squares_(mathematics):91">
 <semantics>
  <mrow>
   <mi>s</mi>
   <mo>=</mo>
   <msup>
    <mrow>
     <mo>∥</mo>
     <mi>𝐫</mi>
     <mo>∥</mo>
    </mrow>
    <mn>2</mn>
   </msup>
   <mo>=</mo>
   <mrow>
    <msup>
     <mi>𝐫</mi>
     <mi mathvariant="normal">T</mi>
    </msup>
    <mi>𝐫</mi>
   </mrow>
   <mo>=</mo>
   <mrow>
    <msup>
     <mi>𝐫</mi>
     <mi mathvariant="normal">T</mi>
    </msup>
    <mi>Q</mi>
    <msup>
     <mi>Q</mi>
     <mi mathvariant="normal">T</mi>
    </msup>
    <mi>𝐫</mi>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <msup>
      <mi>𝐮</mi>
      <mi mathvariant="normal">T</mi>
     </msup>
     <mi>𝐮</mi>
    </mrow>
    <mo>+</mo>
    <mrow>
     <msup>
      <mi>𝐯</mi>
      <mi mathvariant="normal">T</mi>
     </msup>
     <mi>𝐯</mi>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <ci>s</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="latexml">norm</csymbol>
       <ci>𝐫</ci>
      </apply>
      <cn type="integer">2</cn>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>𝐫</ci>
       <ci>normal-T</ci>
      </apply>
      <ci>𝐫</ci>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>𝐫</ci>
       <ci>normal-T</ci>
      </apply>
      <ci>Q</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>Q</ci>
       <ci>normal-T</ci>
      </apply>
      <ci>𝐫</ci>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <plus></plus>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>𝐮</ci>
        <ci>normal-T</ci>
       </apply>
       <ci>𝐮</ci>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>𝐯</ci>
        <ci>normal-T</ci>
       </apply>
       <ci>𝐯</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   s=\|\mathbf{r}\|^{2}=\mathbf{r}^{\rm T}\mathbf{r}=\mathbf{r}^{\rm T}QQ^{\rm T}%
\mathbf{r}=\mathbf{u}^{\rm T}\mathbf{u}+\mathbf{v}^{\rm T}\mathbf{v}
  </annotation>
 </semantics>
</math>

 Since <strong>v</strong> doesn't depend on <strong><em>β</em></strong>, the minimum value of <em>s</em> is attained when the upper block, <strong>u</strong>, is zero. Therefore the parameters are found by solving:</p>

<p>

<math display="block" id="Linear_least_squares_(mathematics):92">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>R</mi>
     <mover accent="true">
      <mi>𝜷</mi>
      <mo stretchy="false">^</mo>
     </mover>
    </mrow>
    <mo>=</mo>
    <msub>
     <mrow>
      <mo>(</mo>
      <mrow>
       <msup>
        <mi>Q</mi>
        <mi mathvariant="normal">T</mi>
       </msup>
       <mi>𝐲</mi>
      </mrow>
      <mo>)</mo>
     </mrow>
     <mi>n</mi>
    </msub>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>R</ci>
     <apply>
      <ci>normal-^</ci>
      <ci>𝜷</ci>
     </apply>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>Q</ci>
       <ci>normal-T</ci>
      </apply>
      <ci>𝐲</ci>
     </apply>
     <ci>n</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   R\hat{\boldsymbol{\beta}}=\left(Q^{\rm T}\mathbf{y}\right)_{n}.
  </annotation>
 </semantics>
</math>

 These equations are easily solved as <em>R</em> is upper triangular.</p>

<p>An alternative decomposition of <em>X</em> is the <a href="singular_value_decomposition" title="wikilink">singular value decomposition</a> (SVD)<a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a></p>

<p>

<math display="block" id="Linear_least_squares_(mathematics):93">
 <semantics>
  <mrow>
   <mi>X</mi>
   <mo>=</mo>
   <mrow>
    <mi>U</mi>
    <mi mathvariant="normal">Σ</mi>
    <msup>
     <mi>V</mi>
     <mi mathvariant="normal">T</mi>
    </msup>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>X</ci>
    <apply>
     <times></times>
     <ci>U</ci>
     <ci>normal-Σ</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>V</ci>
      <ci>normal-T</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   X=U\Sigma V^{\rm T}
  </annotation>
 </semantics>
</math>

,</p>

<p>where <em>U</em> is <em>m</em> by <em>m</em> orthogonal matrix, <em>V</em> is <em>n</em> by <em>n</em> orthogonal matrix and 

<math display="inline" id="Linear_least_squares_(mathematics):94">
 <semantics>
  <mi mathvariant="normal">Σ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>normal-Σ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Sigma
  </annotation>
 </semantics>
</math>

 is an <em>m</em> by <em>n</em> matrix with all its elements outside of the main diagonal equal to <em>0</em>. The <a class="uri" href="pseudoinverse" title="wikilink">pseudoinverse</a> of 

<math display="inline" id="Linear_least_squares_(mathematics):95">
 <semantics>
  <mi mathvariant="normal">Σ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>normal-Σ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Sigma
  </annotation>
 </semantics>
</math>

 is easily obtained by inverting its non-zero diagonal elements and transposing. Hence,</p>

<p>

<math display="block" id="Linear_least_squares_(mathematics):96">
 <semantics>
  <mrow>
   <mrow>
    <msup>
     <mi>𝐗𝐗</mi>
     <mo>+</mo>
    </msup>
    <mo>=</mo>
    <mrow>
     <mi>U</mi>
     <mi mathvariant="normal">Σ</mi>
     <msup>
      <mi>V</mi>
      <mi mathvariant="normal">T</mi>
     </msup>
     <mi>V</mi>
     <msup>
      <mi mathvariant="normal">Σ</mi>
      <mo>+</mo>
     </msup>
     <msup>
      <mi>U</mi>
      <mi mathvariant="normal">T</mi>
     </msup>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mi>U</mi>
     <mi>P</mi>
     <msup>
      <mi>U</mi>
      <mi mathvariant="normal">T</mi>
     </msup>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>𝐗𝐗</ci>
      <plus></plus>
     </apply>
     <apply>
      <times></times>
      <ci>U</ci>
      <ci>normal-Σ</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>V</ci>
       <ci>normal-T</ci>
      </apply>
      <ci>V</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>normal-Σ</ci>
       <plus></plus>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>U</ci>
       <ci>normal-T</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <ci>U</ci>
      <ci>P</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>U</ci>
       <ci>normal-T</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{X}\mathbf{X}^{+}=U\Sigma V^{\rm T}V\Sigma^{+}U^{\rm T}=UPU^{\rm T},
  </annotation>
 </semantics>
</math>

</p>

<p>where <em>P</em> is obtained from 

<math display="inline" id="Linear_least_squares_(mathematics):97">
 <semantics>
  <mi mathvariant="normal">Σ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>normal-Σ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Sigma
  </annotation>
 </semantics>
</math>

 by replacing its non-zero diagonal elements with ones. Since 

<math display="inline" id="Linear_least_squares_(mathematics):98">
 <semantics>
  <mrow>
   <msup>
    <mrow>
     <mo stretchy="false">(</mo>
     <msup>
      <mi>𝐗𝐗</mi>
      <mo>+</mo>
     </msup>
     <mo stretchy="false">)</mo>
    </mrow>
    <mo>*</mo>
   </msup>
   <mo>=</mo>
   <msup>
    <mi>𝐗𝐗</mi>
    <mo>+</mo>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>𝐗𝐗</ci>
      <plus></plus>
     </apply>
     <times></times>
    </apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>𝐗𝐗</ci>
     <plus></plus>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (\mathbf{X}\mathbf{X}^{+})^{*}=\mathbf{X}\mathbf{X}^{+}
  </annotation>
 </semantics>
</math>

 (the property of pseudoinverse), the matrix 

<math display="inline" id="Linear_least_squares_(mathematics):99">
 <semantics>
  <mrow>
   <mi>U</mi>
   <mi>P</mi>
   <msup>
    <mi>U</mi>
    <mi mathvariant="normal">T</mi>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>U</ci>
    <ci>P</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>U</ci>
     <ci>normal-T</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   UPU^{\rm T}
  </annotation>
 </semantics>
</math>

 is an orthogonal projection onto the image (column-space) of <em>X</em>. In accordance with a general approach described in the introduction above (find <strong>XS</strong> which is an orthogonal projection),</p>

<p>

<math display="block" id="Linear_least_squares_(mathematics):100">
 <semantics>
  <mrow>
   <mi>S</mi>
   <mo>=</mo>
   <msup>
    <mi>𝐗</mi>
    <mo>+</mo>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>S</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>𝐗</ci>
     <plus></plus>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   S=\mathbf{X}^{+}
  </annotation>
 </semantics>
</math>

,</p>

<p>and thus,</p>

<p>

<math display="block" id="Linear_least_squares_(mathematics):101">
 <semantics>
  <mrow>
   <mi>β</mi>
   <mo>=</mo>
   <mrow>
    <mi>V</mi>
    <msup>
     <mi mathvariant="normal">Σ</mi>
     <mo>+</mo>
    </msup>
    <msup>
     <mi>U</mi>
     <mi mathvariant="normal">T</mi>
    </msup>
    <mi>𝐲</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>β</ci>
    <apply>
     <times></times>
     <ci>V</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>normal-Σ</ci>
      <plus></plus>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>U</ci>
      <ci>normal-T</ci>
     </apply>
     <ci>𝐲</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \beta=V\Sigma^{+}U^{\rm T}\mathbf{y}
  </annotation>
 </semantics>
</math>

</p>

<p>is a solution of a least squares problem. This method is the most computationally intensive, but is particularly useful if the normal equations matrix, <em>X</em><sup>T</sup><em>X</em>, is very ill-conditioned (i.e. if its <a href="condition_number" title="wikilink">condition number</a> multiplied by the machine's relative <a href="round-off_error" title="wikilink">round-off error</a> is appreciably large). In that case, including the smallest <a href="singular_value" title="wikilink">singular values</a> in the inversion merely adds numerical noise to the solution. This can be cured with the truncated SVD approach, giving a more stable and exact answer, by explicitly setting to zero all singular values below a certain threshold and so ignoring them, a process closely related to <a href="factor_analysis" title="wikilink">factor analysis</a>.</p>
<h2 id="properties-of-the-least-squares-estimators">Properties of the least-squares estimators</h2>

<p> The gradient equations at the minimum can be written as</p>

<p>

<math display="block" id="Linear_least_squares_(mathematics):102">
 <semantics>
  <mrow>
   <mrow>
    <msup>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mi>𝐲</mi>
       <mo>-</mo>
       <mrow>
        <mi>X</mi>
        <mover accent="true">
         <mi>𝜷</mi>
         <mo stretchy="false">^</mo>
        </mover>
       </mrow>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <mi mathvariant="normal">T</mi>
    </msup>
    <mi>X</mi>
   </mrow>
   <mo>=</mo>
   <mn>0.</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <minus></minus>
       <ci>𝐲</ci>
       <apply>
        <times></times>
        <ci>X</ci>
        <apply>
         <ci>normal-^</ci>
         <ci>𝜷</ci>
        </apply>
       </apply>
      </apply>
      <ci>normal-T</ci>
     </apply>
     <ci>X</ci>
    </apply>
    <cn type="float">0.</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (\mathbf{y}-X\hat{\boldsymbol{\beta}})^{\rm T}X=0.
  </annotation>
 </semantics>
</math>

</p>

<p>A geometrical interpretation of these equations is that the vector of residuals, 

<math display="inline" id="Linear_least_squares_(mathematics):103">
 <semantics>
  <mrow>
   <mi>𝐲</mi>
   <mo>-</mo>
   <mrow>
    <mi>X</mi>
    <mover accent="true">
     <mi>𝜷</mi>
     <mo stretchy="false">^</mo>
    </mover>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <minus></minus>
    <ci>𝐲</ci>
    <apply>
     <times></times>
     <ci>X</ci>
     <apply>
      <ci>normal-^</ci>
      <ci>𝜷</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{y}-X\hat{\boldsymbol{\beta}}
  </annotation>
 </semantics>
</math>

 is orthogonal to the <a href="column_space" title="wikilink">column space</a> of <em>X</em>, since the dot product 

<math display="inline" id="Linear_least_squares_(mathematics):104">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>𝐲</mi>
      <mo>-</mo>
      <mrow>
       <mi>X</mi>
       <mover accent="true">
        <mi>𝜷</mi>
        <mo stretchy="false">^</mo>
       </mover>
      </mrow>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
    <mo>⋅</mo>
    <mi>X</mi>
   </mrow>
   <mi>𝐯</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <ci>normal-⋅</ci>
     <apply>
      <minus></minus>
      <ci>𝐲</ci>
      <apply>
       <times></times>
       <ci>X</ci>
       <apply>
        <ci>normal-^</ci>
        <ci>𝜷</ci>
       </apply>
      </apply>
     </apply>
     <ci>X</ci>
    </apply>
    <ci>𝐯</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (\mathbf{y}-X\hat{\boldsymbol{\beta}})\cdot X\mathbf{v}
  </annotation>
 </semantics>
</math>

 is equal to zero for <em>any</em> conformal vector, <strong>v</strong>. This means that 

<math display="inline" id="Linear_least_squares_(mathematics):105">
 <semantics>
  <mrow>
   <mi>𝐲</mi>
   <mo>-</mo>
   <mrow>
    <mi>X</mi>
    <mover accent="true">
     <mi>𝜷</mi>
     <mo mathvariant="bold" stretchy="false">^</mo>
    </mover>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <minus></minus>
    <ci>𝐲</ci>
    <apply>
     <times></times>
     <ci>X</ci>
     <apply>
      <ci>bold-^</ci>
      <ci>𝜷</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{y}-X\boldsymbol{\hat{\beta}}
  </annotation>
 </semantics>
</math>

 is the shortest of all possible vectors 

<math display="inline" id="Linear_least_squares_(mathematics):106">
 <semantics>
  <mrow>
   <mi>𝐲</mi>
   <mo>-</mo>
   <mrow>
    <mi>X</mi>
    <mi>𝜷</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <minus></minus>
    <ci>𝐲</ci>
    <apply>
     <times></times>
     <ci>X</ci>
     <ci>𝜷</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{y}-X\boldsymbol{\beta}
  </annotation>
 </semantics>
</math>

, that is, the variance of the residuals is the minimum possible. This is illustrated at the right.</p>

<p>Introducing 

<math display="inline" id="Linear_least_squares_(mathematics):107">
 <semantics>
  <mover accent="true">
   <mi>𝜸</mi>
   <mo stretchy="false">^</mo>
  </mover>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-^</ci>
    <ci>𝜸</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \hat{\boldsymbol{\gamma}}
  </annotation>
 </semantics>
</math>

 and a matrix <em>K</em> with the assumption that a matrix 

<math display="inline" id="Linear_least_squares_(mathematics):108">
 <semantics>
  <mrow>
   <mo stretchy="false">[</mo>
   <mrow>
    <mpadded width="+5pt">
     <mi>X</mi>
    </mpadded>
    <mi>K</mi>
   </mrow>
   <mo stretchy="false">]</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">delimited-[]</csymbol>
    <apply>
     <times></times>
     <ci>X</ci>
     <ci>K</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   [X\ K]
  </annotation>
 </semantics>
</math>

 is non-singular and <em>K</em><sup>T</sup> <em>X</em> = 0 (cf. <a href="Linear_projection#Orthogonal_projections" title="wikilink">Orthogonal projections</a>), the residual vector should satisfy the following equation:</p>

<p>

<math display="block" id="Linear_least_squares_(mathematics):109">
 <semantics>
  <mrow>
   <mrow>
    <mover accent="true">
     <mi>𝐫</mi>
     <mo stretchy="false">^</mo>
    </mover>
    <mo>≜</mo>
    <mrow>
     <mi>𝐲</mi>
     <mo>-</mo>
     <mrow>
      <mi>X</mi>
      <mover accent="true">
       <mi>𝜷</mi>
       <mo stretchy="false">^</mo>
      </mover>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mi>K</mi>
     <mover accent="true">
      <mi>𝜸</mi>
      <mo stretchy="false">^</mo>
     </mover>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <ci>normal-≜</ci>
     <apply>
      <ci>normal-^</ci>
      <ci>𝐫</ci>
     </apply>
     <apply>
      <minus></minus>
      <ci>𝐲</ci>
      <apply>
       <times></times>
       <ci>X</ci>
       <apply>
        <ci>normal-^</ci>
        <ci>𝜷</ci>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <ci>K</ci>
      <apply>
       <ci>normal-^</ci>
       <ci>𝜸</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \hat{\mathbf{r}}\triangleq\mathbf{y}-X\hat{\boldsymbol{\beta}}=K\hat{{%
\boldsymbol{\gamma}}}.
  </annotation>
 </semantics>
</math>

 The equation and solution of linear least squares are thus described as follows:</p>

<p>

<math display="block" id="Linear_least_squares_(mathematics):110">
 <semantics>
  <mrow>
   <mrow>
    <mi>𝐲</mi>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mo>[</mo>
      <mtable displaystyle="true">
       <mtr>
        <mtd columnalign="center">
         <mi>X</mi>
        </mtd>
        <mtd columnalign="center">
         <mi>K</mi>
        </mtd>
       </mtr>
      </mtable>
      <mo>]</mo>
     </mrow>
     <mrow>
      <mo>(</mo>
      <mtable displaystyle="true">
       <mtr>
        <mtd columnalign="center">
         <mover accent="true">
          <mi>𝜷</mi>
          <mo stretchy="false">^</mo>
         </mover>
        </mtd>
       </mtr>
       <mtr>
        <mtd columnalign="center">
         <mover accent="true">
          <mi>𝜸</mi>
          <mo stretchy="false">^</mo>
         </mover>
        </mtd>
       </mtr>
      </mtable>
      <mo>)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>𝐲</ci>
    <apply>
     <times></times>
     <matrix>
      <matrixrow>
       <ci>X</ci>
       <ci>K</ci>
      </matrixrow>
     </matrix>
     <matrix>
      <matrixrow>
       <apply>
        <ci>normal-^</ci>
        <ci>𝜷</ci>
       </apply>
      </matrixrow>
      <matrixrow>
       <apply>
        <ci>normal-^</ci>
        <ci>𝜸</ci>
       </apply>
      </matrixrow>
     </matrix>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{y}=\begin{bmatrix}X&K\end{bmatrix}\begin{pmatrix}\hat{\boldsymbol{%
\beta}}\\
\hat{\boldsymbol{\gamma}}\end{pmatrix},
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Linear_least_squares_(mathematics):111">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mo>(</mo>
     <mtable displaystyle="true">
      <mtr>
       <mtd columnalign="center">
        <mover accent="true">
         <mi>𝜷</mi>
         <mo stretchy="false">^</mo>
        </mover>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mover accent="true">
         <mi>𝜸</mi>
         <mo stretchy="false">^</mo>
        </mover>
       </mtd>
      </mtr>
     </mtable>
     <mo>)</mo>
    </mrow>
    <mo>=</mo>
    <mrow>
     <msup>
      <mrow>
       <mo>[</mo>
       <mtable displaystyle="true">
        <mtr>
         <mtd columnalign="center">
          <mi>X</mi>
         </mtd>
         <mtd columnalign="center">
          <mi>K</mi>
         </mtd>
        </mtr>
       </mtable>
       <mo>]</mo>
      </mrow>
      <mrow>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
     </msup>
     <mi>𝐲</mi>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mo>[</mo>
      <mtable displaystyle="true">
       <mtr>
        <mtd columnalign="center">
         <mrow>
          <msup>
           <mrow>
            <mo stretchy="false">(</mo>
            <mrow>
             <msup>
              <mi>X</mi>
              <mi mathvariant="normal">T</mi>
             </msup>
             <mi>X</mi>
            </mrow>
            <mo stretchy="false">)</mo>
           </mrow>
           <mrow>
            <mo>-</mo>
            <mn>1</mn>
           </mrow>
          </msup>
          <msup>
           <mi>X</mi>
           <mi mathvariant="normal">T</mi>
          </msup>
         </mrow>
        </mtd>
       </mtr>
       <mtr>
        <mtd columnalign="center">
         <mrow>
          <msup>
           <mrow>
            <mo stretchy="false">(</mo>
            <mrow>
             <msup>
              <mi>K</mi>
              <mi mathvariant="normal">T</mi>
             </msup>
             <mi>K</mi>
            </mrow>
            <mo stretchy="false">)</mo>
           </mrow>
           <mrow>
            <mo>-</mo>
            <mn>1</mn>
           </mrow>
          </msup>
          <msup>
           <mi>K</mi>
           <mi mathvariant="normal">T</mi>
          </msup>
         </mrow>
        </mtd>
       </mtr>
      </mtable>
      <mo>]</mo>
     </mrow>
     <mi>𝐲</mi>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <matrix>
      <matrixrow>
       <apply>
        <ci>normal-^</ci>
        <ci>𝜷</ci>
       </apply>
      </matrixrow>
      <matrixrow>
       <apply>
        <ci>normal-^</ci>
        <ci>𝜸</ci>
       </apply>
      </matrixrow>
     </matrix>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <matrix>
        <matrixrow>
         <ci>X</ci>
         <ci>K</ci>
        </matrixrow>
       </matrix>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <ci>𝐲</ci>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <matrix>
       <matrixrow>
        <apply>
         <times></times>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <apply>
           <times></times>
           <apply>
            <csymbol cd="ambiguous">superscript</csymbol>
            <ci>X</ci>
            <ci>normal-T</ci>
           </apply>
           <ci>X</ci>
          </apply>
          <apply>
           <minus></minus>
           <cn type="integer">1</cn>
          </apply>
         </apply>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>X</ci>
          <ci>normal-T</ci>
         </apply>
        </apply>
       </matrixrow>
       <matrixrow>
        <apply>
         <times></times>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <apply>
           <times></times>
           <apply>
            <csymbol cd="ambiguous">superscript</csymbol>
            <ci>K</ci>
            <ci>normal-T</ci>
           </apply>
           <ci>K</ci>
          </apply>
          <apply>
           <minus></minus>
           <cn type="integer">1</cn>
          </apply>
         </apply>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>K</ci>
          <ci>normal-T</ci>
         </apply>
        </apply>
       </matrixrow>
      </matrix>
      <ci>𝐲</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \begin{pmatrix}\hat{\boldsymbol{\beta}}\\
\hat{\boldsymbol{\gamma}}\end{pmatrix}=\begin{bmatrix}X&K\end{bmatrix}^{-1}%
\mathbf{y}=\begin{bmatrix}(X^{\rm T}X)^{-1}X^{\rm T}\\
(K^{\rm T}K)^{-1}K^{\rm T}\end{bmatrix}\mathbf{y}.
  </annotation>
 </semantics>
</math>

</p>

<p>If the experimental errors, 

<math display="inline" id="Linear_least_squares_(mathematics):112">
 <semantics>
  <mpadded width="+1.7pt">
   <mi>ϵ</mi>
  </mpadded>
  <annotation-xml encoding="MathML-Content">
   <ci>ϵ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \epsilon\,
  </annotation>
 </semantics>
</math>

, are uncorrelated, have a mean of zero and a constant variance, 

<math display="inline" id="Linear_least_squares_(mathematics):113">
 <semantics>
  <mi>σ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>σ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \sigma
  </annotation>
 </semantics>
</math>

, the <a href="Gauss-Markov_theorem" title="wikilink">Gauss-Markov theorem</a> states that the least-squares estimator, 

<math display="inline" id="Linear_least_squares_(mathematics):114">
 <semantics>
  <mover accent="true">
   <mi>𝜷</mi>
   <mo stretchy="false">^</mo>
  </mover>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-^</ci>
    <ci>𝜷</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \hat{\boldsymbol{\beta}}
  </annotation>
 </semantics>
</math>

, has the minimum variance of all estimators that are linear combinations of the observations. In this sense it is the best, or optimal, estimator of the parameters. Note particularly that this property is independent of the statistical <a href="distribution_function" title="wikilink">distribution function</a> of the errors. In other words, <em>the distribution function of the errors need not be a <a href="normal_distribution" title="wikilink">normal distribution</a></em>. However, for some probability distributions, there is no guarantee that the least-squares solution is even possible given the observations; still, in such cases it is the best estimator that is both linear and unbiased.</p>

<p>For example, it is easy to show that the <a href="arithmetic_mean" title="wikilink">arithmetic mean</a> of a set of measurements of a quantity is the least-squares estimator of the value of that quantity. If the conditions of the Gauss-Markov theorem apply, the arithmetic mean is optimal, whatever the distribution of errors of the measurements might be.</p>

<p>However, in the case that the experimental errors do belong to a normal distribution, the least-squares estimator is also a <a href="maximum_likelihood" title="wikilink">maximum likelihood</a> estimator.<a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a></p>

<p>These properties underpin the use of the method of least squares for all types of data fitting, even when the assumptions are not strictly valid.</p>
<h3 id="limitations">Limitations</h3>

<p>An assumption underlying the treatment given above is that the independent variable, <em>x</em>, is free of error. In practice, the errors on the measurements of the independent variable are usually much smaller than the errors on the dependent variable and can therefore be ignored. When this is not the case, <a href="total_least_squares" title="wikilink">total least squares</a> or more generally <a href="errors-in-variables_models" title="wikilink">errors-in-variables models</a>, or <em>rigorous least squares</em>, should be used. This can be done by adjusting the weighting scheme to take into account errors on both the dependent and independent variables and then following the standard procedure.<a class="footnoteRef" href="#fn3" id="fnref3"><sup>3</sup></a><a class="footnoteRef" href="#fn4" id="fnref4"><sup>4</sup></a></p>

<p>In some cases the (weighted) normal equations matrix <em>X</em><sup>T</sup><em>X</em> is <a class="uri" href="ill-conditioned" title="wikilink">ill-conditioned</a>. When fitting polynomials the normal equations matrix is a <a href="Vandermonde_matrix" title="wikilink">Vandermonde matrix</a>. Vandermonde matrices become increasingly ill-conditioned as the order of the matrix increases. In these cases, the least squares estimate amplifies the measurement noise and may be grossly inaccurate. Various <a href="regularization_(mathematics)" title="wikilink">regularization</a> techniques can be applied in such cases, the most common of which is called <a href="Tikhonov_regularization" title="wikilink">ridge regression</a>. If further information about the parameters is known, for example, a range of possible values of 

<math display="inline" id="Linear_least_squares_(mathematics):115">
 <semantics>
  <mover accent="true">
   <mi>𝜷</mi>
   <mo stretchy="false">^</mo>
  </mover>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-^</ci>
    <ci>𝜷</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{\hat{\boldsymbol{\beta}}}
  </annotation>
 </semantics>
</math>

, then various techniques can be used to increase the stability of the solution. For example, see <a href="#Constrained_linear_least_squares" title="wikilink">constrained least squares</a>.</p>

<p>Another drawback of the least squares estimator is the fact that the norm of the residuals, 

<math display="inline" id="Linear_least_squares_(mathematics):116">
 <semantics>
  <mrow>
   <mo>∥</mo>
   <mrow>
    <mi>𝐲</mi>
    <mo>-</mo>
    <mrow>
     <mi>X</mi>
     <mover accent="true">
      <mi>𝜷</mi>
      <mo stretchy="false">^</mo>
     </mover>
    </mrow>
   </mrow>
   <mo>∥</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">norm</csymbol>
    <apply>
     <minus></minus>
     <ci>𝐲</ci>
     <apply>
      <times></times>
      <ci>X</ci>
      <apply>
       <ci>normal-^</ci>
       <ci>𝜷</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \|\mathbf{y}-X\hat{\boldsymbol{\beta}}\|
  </annotation>
 </semantics>
</math>

 is minimized, whereas in some cases one is truly interested in obtaining small error in the parameter 

<math display="inline" id="Linear_least_squares_(mathematics):117">
 <semantics>
  <mover accent="true">
   <mi>𝜷</mi>
   <mo stretchy="false">^</mo>
  </mover>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-^</ci>
    <ci>𝜷</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{\hat{\boldsymbol{\beta}}}
  </annotation>
 </semantics>
</math>

, e.g., a small value of 

<math display="inline" id="Linear_least_squares_(mathematics):118">
 <semantics>
  <mrow>
   <mo>∥</mo>
   <mrow>
    <mi>𝜷</mi>
    <mo>-</mo>
    <mover accent="true">
     <mi>𝜷</mi>
     <mo stretchy="false">^</mo>
    </mover>
   </mrow>
   <mo>∥</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">norm</csymbol>
    <apply>
     <minus></minus>
     <ci>𝜷</ci>
     <apply>
      <ci>normal-^</ci>
      <ci>𝜷</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \|{\boldsymbol{\beta}}-\hat{\boldsymbol{\beta}}\|
  </annotation>
 </semantics>
</math>

. However, since the true parameter 

<math display="inline" id="Linear_least_squares_(mathematics):119">
 <semantics>
  <mi>𝜷</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>𝜷</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   {\boldsymbol{\beta}}
  </annotation>
 </semantics>
</math>

 is necessarily unknown, this quantity cannot be directly minimized. If a <a href="prior_probability" title="wikilink">prior probability</a> on 

<math display="inline" id="Linear_least_squares_(mathematics):120">
 <semantics>
  <mover accent="true">
   <mi>𝜷</mi>
   <mo stretchy="false">^</mo>
  </mover>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-^</ci>
    <ci>𝜷</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \hat{\boldsymbol{\beta}}
  </annotation>
 </semantics>
</math>

 is known, then a <a href="Minimum_mean_square_error" title="wikilink">Bayes estimator</a> can be used to minimize the <a href="mean_squared_error" title="wikilink">mean squared error</a>, 

<math display="inline" id="Linear_least_squares_(mathematics):121">
 <semantics>
  <mrow>
   <mi>E</mi>
   <mrow>
    <mo>{</mo>
    <msup>
     <mrow>
      <mo>∥</mo>
      <mrow>
       <mi>𝜷</mi>
       <mo>-</mo>
       <mover accent="true">
        <mi>𝜷</mi>
        <mo stretchy="false">^</mo>
       </mover>
      </mrow>
      <mo>∥</mo>
     </mrow>
     <mn>2</mn>
    </msup>
    <mo>}</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>E</ci>
    <set>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="latexml">norm</csymbol>
       <apply>
        <minus></minus>
        <ci>𝜷</ci>
        <apply>
         <ci>normal-^</ci>
         <ci>𝜷</ci>
        </apply>
       </apply>
      </apply>
      <cn type="integer">2</cn>
     </apply>
    </set>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   E\left\{\|{\boldsymbol{\beta}}-\hat{\boldsymbol{\beta}}\|^{2}\right\}
  </annotation>
 </semantics>
</math>

. The least squares method is often applied when no prior is known. Surprisingly, when several parameters are being estimated jointly, better estimators can be constructed, an effect known as <a href="Stein's_phenomenon" title="wikilink">Stein's phenomenon</a>. For example, if the measurement error is <a href="Normal_distribution" title="wikilink">Gaussian</a>, several estimators are known which <a href="dominating_decision_rule" title="wikilink">dominate</a>, or outperform, the least squares technique; the best known of these is the <a href="James–Stein_estimator" title="wikilink">James–Stein estimator</a>. This is an example of more general <a href="shrinkage_estimator" title="wikilink">shrinkage estimators</a> that have been applied to regression problems.</p>
<h2 id="weighted-linear-least-squares">Weighted linear least squares</h2>

<p>In some cases the observations may be weighted—for example, they may not be equally reliable. In this case, one can minimize the weighted sum of squares:</p>

<p>

<math display="block" id="Linear_least_squares_(mathematics):122">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mpadded width="+1.7pt">
      <munder accentunder="true">
       <mrow>
        <mpadded width="+1.7pt">
         <mi>arg</mi>
        </mpadded>
        <mi>min</mi>
       </mrow>
       <mo>𝜷</mo>
      </munder>
     </mpadded>
     <mrow>
      <munderover>
       <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
       <mrow>
        <mi>i</mi>
        <mo>=</mo>
        <mn>1</mn>
       </mrow>
       <mi>m</mi>
      </munderover>
      <mrow>
       <msub>
        <mi>w</mi>
        <mi>i</mi>
       </msub>
       <msup>
        <mrow>
         <mo>|</mo>
         <mrow>
          <msub>
           <mi>y</mi>
           <mi>i</mi>
          </msub>
          <mo>-</mo>
          <mrow>
           <munderover>
            <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
            <mrow>
             <mi>j</mi>
             <mo>=</mo>
             <mn>1</mn>
            </mrow>
            <mi>n</mi>
           </munderover>
           <mrow>
            <msub>
             <mi>X</mi>
             <mrow>
              <mi>i</mi>
              <mi>j</mi>
             </mrow>
            </msub>
            <msub>
             <mi>β</mi>
             <mi>j</mi>
            </msub>
           </mrow>
          </mrow>
         </mrow>
         <mo>|</mo>
        </mrow>
        <mn>2</mn>
       </msup>
      </mrow>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mpadded width="+1.7pt">
      <munder accentunder="true">
       <mrow>
        <mpadded width="+1.7pt">
         <mi>arg</mi>
        </mpadded>
        <mi>min</mi>
       </mrow>
       <mo>𝜷</mo>
      </munder>
     </mpadded>
     <msup>
      <mrow>
       <mo mathsize="120%" stretchy="false">∥</mo>
       <mrow>
        <msup>
         <mi>W</mi>
         <mrow>
          <mn>1</mn>
          <mo>/</mo>
          <mn>2</mn>
         </mrow>
        </msup>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <mi>𝐲</mi>
          <mo>-</mo>
          <mrow>
           <mi>X</mi>
           <mi>𝜷</mi>
          </mrow>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
       <mo mathsize="120%" stretchy="false">∥</mo>
      </mrow>
      <mn>2</mn>
     </msup>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <ci>𝜷</ci>
      <apply>
       <times></times>
       <ci>arg</ci>
       <ci>min</ci>
      </apply>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <apply>
         <eq></eq>
         <ci>i</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <ci>m</ci>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>w</ci>
        <ci>i</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <abs></abs>
         <apply>
          <minus></minus>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>y</ci>
           <ci>i</ci>
          </apply>
          <apply>
           <apply>
            <csymbol cd="ambiguous">superscript</csymbol>
            <apply>
             <csymbol cd="ambiguous">subscript</csymbol>
             <sum></sum>
             <apply>
              <eq></eq>
              <ci>j</ci>
              <cn type="integer">1</cn>
             </apply>
            </apply>
            <ci>n</ci>
           </apply>
           <apply>
            <times></times>
            <apply>
             <csymbol cd="ambiguous">subscript</csymbol>
             <ci>X</ci>
             <apply>
              <times></times>
              <ci>i</ci>
              <ci>j</ci>
             </apply>
            </apply>
            <apply>
             <csymbol cd="ambiguous">subscript</csymbol>
             <ci>β</ci>
             <ci>j</ci>
            </apply>
           </apply>
          </apply>
         </apply>
        </apply>
        <cn type="integer">2</cn>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <ci>𝜷</ci>
      <apply>
       <times></times>
       <ci>arg</ci>
       <ci>min</ci>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="latexml">norm</csymbol>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>W</ci>
         <apply>
          <divide></divide>
          <cn type="integer">1</cn>
          <cn type="integer">2</cn>
         </apply>
        </apply>
        <apply>
         <minus></minus>
         <ci>𝐲</ci>
         <apply>
          <times></times>
          <ci>X</ci>
          <ci>𝜷</ci>
         </apply>
        </apply>
       </apply>
      </apply>
      <cn type="integer">2</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \underset{\boldsymbol{\beta}}{\operatorname{arg\,min}}\,\sum_{i=1}^{m}w_{i}%
\left|y_{i}-\sum_{j=1}^{n}X_{ij}\beta_{j}\right|^{2}=\underset{\boldsymbol{%
\beta}}{\operatorname{arg\,min}}\,\big\|W^{1/2}(\mathbf{y}-X\boldsymbol{\beta}%
)\big\|^{2}.
  </annotation>
 </semantics>
</math>

</p>

<p>where <em>w</em><sub><em>i</em></sub> &gt; 0 is the weight of the <em>i</em>th observation, and <em>W</em> is the <a href="diagonal_matrix" title="wikilink">diagonal matrix</a> of such weights.</p>

<p>The weights should, ideally, be equal to the <a href="multiplicative_inverse" title="wikilink">reciprocal</a> of the <a class="uri" href="variance" title="wikilink">variance</a> of the measurement.<a class="footnoteRef" href="#fn5" id="fnref5"><sup>5</sup></a> <a class="footnoteRef" href="#fn6" id="fnref6"><sup>6</sup></a> The normal equations are then:</p>

<p>

<math display="block" id="Linear_least_squares_(mathematics):123">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mrow>
      <mo>(</mo>
      <mrow>
       <msup>
        <mi>X</mi>
        <mi mathvariant="normal">T</mi>
       </msup>
       <mi>W</mi>
       <mi>X</mi>
      </mrow>
      <mo>)</mo>
     </mrow>
     <mover accent="true">
      <mi>𝜷</mi>
      <mo stretchy="false">^</mo>
     </mover>
    </mrow>
    <mo>=</mo>
    <mrow>
     <msup>
      <mi>X</mi>
      <mi mathvariant="normal">T</mi>
     </msup>
     <mi>W</mi>
     <mi>𝐲</mi>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>X</ci>
       <ci>normal-T</ci>
      </apply>
      <ci>W</ci>
      <ci>X</ci>
     </apply>
     <apply>
      <ci>normal-^</ci>
      <ci>𝜷</ci>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>X</ci>
      <ci>normal-T</ci>
     </apply>
     <ci>W</ci>
     <ci>𝐲</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \left(X^{\rm T}WX\right)\hat{\boldsymbol{\beta}}=X^{\rm T}W\mathbf{y}.
  </annotation>
 </semantics>
</math>

</p>

<p>This method is used in <a href="iteratively_reweighted_least_squares" title="wikilink">iteratively reweighted least squares</a>.</p>
<h3 id="parameter-errors-and-correlation">Parameter errors and correlation</h3>

<p>The estimated parameter values are linear combinations of the observed values</p>

<p>

<math display="block" id="Linear_least_squares_(mathematics):124">
 <semantics>
  <mrow>
   <mrow>
    <mover accent="true">
     <mi>𝜷</mi>
     <mo stretchy="false">^</mo>
    </mover>
    <mo>=</mo>
    <mrow>
     <msup>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <msup>
         <mi>X</mi>
         <mi mathvariant="normal">T</mi>
        </msup>
        <mi>W</mi>
        <mi>X</mi>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
      <mrow>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
     </msup>
     <msup>
      <mi>X</mi>
      <mi mathvariant="normal">T</mi>
     </msup>
     <mi>W</mi>
     <mi>𝐲</mi>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <ci>normal-^</ci>
     <ci>𝜷</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>X</ci>
        <ci>normal-T</ci>
       </apply>
       <ci>W</ci>
       <ci>X</ci>
      </apply>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>X</ci>
      <ci>normal-T</ci>
     </apply>
     <ci>W</ci>
     <ci>𝐲</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \hat{\boldsymbol{\beta}}=(X^{\rm T}WX)^{-1}X^{\rm T}W\mathbf{y}.\,
  </annotation>
 </semantics>
</math>

</p>

<p>Therefore an expression for the residuals (i.e., the <em>estimated</em> errors in the observations) can be obtained by <a href="error_propagation" title="wikilink">error propagation</a> from the errors in the observations. Let the <a href="variance-covariance_matrix" title="wikilink">variance-covariance matrix</a> for the observations be denoted by <em>M</em> and that of the parameters by <em>M<sup>β</sup></em>. Then,</p>

<p>

<math display="block" id="Linear_least_squares_(mathematics):125">
 <semantics>
  <mrow>
   <mrow>
    <msup>
     <mi>M</mi>
     <mi>β</mi>
    </msup>
    <mo>=</mo>
    <mrow>
     <msup>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <msup>
         <mi>X</mi>
         <mi mathvariant="normal">T</mi>
        </msup>
        <mi>W</mi>
        <mi>X</mi>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
      <mrow>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
     </msup>
     <msup>
      <mi>X</mi>
      <mi mathvariant="normal">T</mi>
     </msup>
     <mi>W</mi>
     <mi>M</mi>
     <msup>
      <mi>W</mi>
      <mi mathvariant="normal">T</mi>
     </msup>
     <mi>X</mi>
     <msup>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <msup>
         <mi>X</mi>
         <mi mathvariant="normal">T</mi>
        </msup>
        <msup>
         <mi>W</mi>
         <mi mathvariant="normal">T</mi>
        </msup>
        <mi>X</mi>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
      <mrow>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
     </msup>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>M</ci>
     <ci>β</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>X</ci>
        <ci>normal-T</ci>
       </apply>
       <ci>W</ci>
       <ci>X</ci>
      </apply>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>X</ci>
      <ci>normal-T</ci>
     </apply>
     <ci>W</ci>
     <ci>M</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>W</ci>
      <ci>normal-T</ci>
     </apply>
     <ci>X</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>X</ci>
        <ci>normal-T</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>W</ci>
        <ci>normal-T</ci>
       </apply>
       <ci>X</ci>
      </apply>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   M^{\beta}=(X^{\rm T}WX)^{-1}X^{\rm T}WMW^{\rm T}X(X^{\rm T}W^{\rm T}X)^{-1}.
  </annotation>
 </semantics>
</math>

</p>

<p>When <em>W</em> = <em>M</em><sup> −1</sup> this simplifies to</p>

<p>

<math display="block" id="Linear_least_squares_(mathematics):126">
 <semantics>
  <mrow>
   <mrow>
    <msup>
     <mi>M</mi>
     <mi>β</mi>
    </msup>
    <mo>=</mo>
    <msup>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <msup>
        <mi>X</mi>
        <mi mathvariant="normal">T</mi>
       </msup>
       <mi>W</mi>
       <mi>X</mi>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <mrow>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </msup>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>M</ci>
     <ci>β</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>X</ci>
       <ci>normal-T</ci>
      </apply>
      <ci>W</ci>
      <ci>X</ci>
     </apply>
     <apply>
      <minus></minus>
      <cn type="integer">1</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   M^{\beta}=(X^{\rm T}WX)^{-1}.
  </annotation>
 </semantics>
</math>

</p>

<p>When unit weights are used (<em>W</em> = <em>I</em>) it is implied that the experimental errors are uncorrelated and all equal: <em>M</em> = <em>σ</em><sup>2</sup><em>I</em>, where <em>σ</em><sup>2</sup> is the variance of an observation, and <em>I</em> is the <a href="identity_matrix" title="wikilink">identity matrix</a>. In this case <em>σ</em><sup>2</sup> is approximated by 

<math display="inline" id="Linear_least_squares_(mathematics):127">
 <semantics>
  <mfrac>
   <mi>S</mi>
   <mrow>
    <mi>m</mi>
    <mo>-</mo>
    <mi>n</mi>
   </mrow>
  </mfrac>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <divide></divide>
    <ci>S</ci>
    <apply>
     <minus></minus>
     <ci>m</ci>
     <ci>n</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \frac{S}{m-n}
  </annotation>
 </semantics>
</math>

, where <em>S</em> is the minimum value of the objective function</p>

<p>

<math display="block" id="Linear_least_squares_(mathematics):128">
 <semantics>
  <mrow>
   <mrow>
    <msup>
     <mi>M</mi>
     <mi>β</mi>
    </msup>
    <mo>=</mo>
    <mrow>
     <mfrac>
      <mi>S</mi>
      <mrow>
       <mi>m</mi>
       <mo>-</mo>
       <mi>n</mi>
      </mrow>
     </mfrac>
     <msup>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <msup>
         <mi>X</mi>
         <mi mathvariant="normal">T</mi>
        </msup>
        <mi>X</mi>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
      <mrow>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
     </msup>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>M</ci>
     <ci>β</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <divide></divide>
      <ci>S</ci>
      <apply>
       <minus></minus>
       <ci>m</ci>
       <ci>n</ci>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>X</ci>
        <ci>normal-T</ci>
       </apply>
       <ci>X</ci>
      </apply>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   M^{\beta}=\frac{S}{m-n}(X^{\rm T}X)^{-1}.
  </annotation>
 </semantics>
</math>

</p>

<p>The denominator, <em>m</em> − <em>n</em>, is the number of <a href="Degrees_of_freedom_(statistics)" title="wikilink">degrees of freedom</a>; see <a href="Degrees_of_freedom_(statistics)#Effective_degrees_of_freedom" title="wikilink">effective degrees of freedom</a> for generalizations for the case of correlated observations. In all cases, the <a class="uri" href="variance" title="wikilink">variance</a> of the parameter 

<math display="inline" id="Linear_least_squares_(mathematics):129">
 <semantics>
  <msub>
   <mi>β</mi>
   <mi>i</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>β</ci>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \beta_{i}
  </annotation>
 </semantics>
</math>

 is given by 

<math display="inline" id="Linear_least_squares_(mathematics):130">
 <semantics>
  <msubsup>
   <mi>M</mi>
   <mrow>
    <mi>i</mi>
    <mi>i</mi>
   </mrow>
   <mi>β</mi>
  </msubsup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>M</ci>
     <ci>β</ci>
    </apply>
    <apply>
     <times></times>
     <ci>i</ci>
     <ci>i</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   M^{\beta}_{ii}
  </annotation>
 </semantics>
</math>

 and the <a class="uri" href="covariance" title="wikilink">covariance</a> between parameters 

<math display="inline" id="Linear_least_squares_(mathematics):131">
 <semantics>
  <msub>
   <mi>β</mi>
   <mi>i</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>β</ci>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \beta_{i}
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Linear_least_squares_(mathematics):132">
 <semantics>
  <msub>
   <mi>β</mi>
   <mi>j</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>β</ci>
    <ci>j</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \beta_{j}
  </annotation>
 </semantics>
</math>

 is given by 

<math display="inline" id="Linear_least_squares_(mathematics):133">
 <semantics>
  <msubsup>
   <mi>M</mi>
   <mrow>
    <mi>i</mi>
    <mi>j</mi>
   </mrow>
   <mi>β</mi>
  </msubsup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>M</ci>
     <ci>β</ci>
    </apply>
    <apply>
     <times></times>
     <ci>i</ci>
     <ci>j</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   M^{\beta}_{ij}
  </annotation>
 </semantics>
</math>

. <a href="Standard_deviation" title="wikilink">Standard deviation</a> is the square root of variance, and the correlation coefficient is given by 

<math display="inline" id="Linear_least_squares_(mathematics):134">
 <semantics>
  <mrow>
   <msub>
    <mi>ρ</mi>
    <mrow>
     <mi>i</mi>
     <mi>j</mi>
    </mrow>
   </msub>
   <mo>=</mo>
   <mrow>
    <msubsup>
     <mi>M</mi>
     <mrow>
      <mi>i</mi>
      <mi>j</mi>
     </mrow>
     <mi>β</mi>
    </msubsup>
    <mo>/</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <msub>
       <mi>σ</mi>
       <mi>i</mi>
      </msub>
      <msub>
       <mi>σ</mi>
       <mi>j</mi>
      </msub>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>ρ</ci>
     <apply>
      <times></times>
      <ci>i</ci>
      <ci>j</ci>
     </apply>
    </apply>
    <apply>
     <divide></divide>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>M</ci>
       <ci>β</ci>
      </apply>
      <apply>
       <times></times>
       <ci>i</ci>
       <ci>j</ci>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>σ</ci>
       <ci>i</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>σ</ci>
       <ci>j</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \rho_{ij}=M^{\beta}_{ij}/(\sigma_{i}\sigma_{j})
  </annotation>
 </semantics>
</math>

. These error estimates reflect only <a href="random_errors" title="wikilink">random errors</a> in the measurements. The true uncertainty in the parameters is larger due to the presence of <a href="systematic_errors" title="wikilink">systematic errors</a> which, by definition, cannot be quantified. Note that even though the observations may be un-correlated, the parameters are typically <a href="Pearson_product-moment_correlation_coefficient" title="wikilink">correlated</a>.</p>
<h3 id="parameter-confidence-limits">Parameter confidence limits</h3>

<p>It is often <em>assumed</em>, for want of any concrete evidence but often appealing to the <a href="central_limit_theorem" title="wikilink">central limit theorem</a> -- see <a href="Normal_distribution#Occurrence" title="wikilink">Normal distribution#Occurrence</a> -- that the error on each observation belongs to a <a href="normal_distribution" title="wikilink">normal distribution</a> with a mean of zero and standard deviation 

<math display="inline" id="Linear_least_squares_(mathematics):135">
 <semantics>
  <mi>σ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>σ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \sigma
  </annotation>
 </semantics>
</math>

. Under that assumption the following probabilities can be derived for a single scalar parameter estimate in terms of its estimated standard error 

<math display="inline" id="Linear_least_squares_(mathematics):136">
 <semantics>
  <mrow>
   <mi>s</mi>
   <msub>
    <mi>e</mi>
    <mi>β</mi>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>s</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>e</ci>
     <ci>β</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   se_{\beta}
  </annotation>
 </semantics>
</math>

 (given <a href="Ordinary_least_squares#Large_sample_properties" title="wikilink">here</a>):</p>
<dl>
<dd>68% that the interval 

<math display="inline" id="Linear_least_squares_(mathematics):137">
 <semantics>
  <mrow>
   <mover accent="true">
    <mi>β</mi>
    <mo stretchy="false">^</mo>
   </mover>
   <mo>±</mo>
   <mrow>
    <mi>s</mi>
    <msub>
     <mi>e</mi>
     <mi>β</mi>
    </msub>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">plus-or-minus</csymbol>
    <apply>
     <ci>normal-^</ci>
     <ci>β</ci>
    </apply>
    <apply>
     <times></times>
     <ci>s</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>e</ci>
      <ci>β</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \hat{\beta}\pm se_{\beta}
  </annotation>
 </semantics>
</math>

 encompasses the true coefficient value
</dd>
<dd>95% that the interval 

<math display="inline" id="Linear_least_squares_(mathematics):138">
 <semantics>
  <mrow>
   <mover accent="true">
    <mi>β</mi>
    <mo stretchy="false">^</mo>
   </mover>
   <mo>±</mo>
   <mrow>
    <mn>2</mn>
    <mi>s</mi>
    <msub>
     <mi>e</mi>
     <mi>β</mi>
    </msub>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">plus-or-minus</csymbol>
    <apply>
     <ci>normal-^</ci>
     <ci>β</ci>
    </apply>
    <apply>
     <times></times>
     <cn type="integer">2</cn>
     <ci>s</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>e</ci>
      <ci>β</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \hat{\beta}\pm 2se_{\beta}
  </annotation>
 </semantics>
</math>

 encompasses the true coefficient value
</dd>
<dd>99% that the interval 

<math display="inline" id="Linear_least_squares_(mathematics):139">
 <semantics>
  <mrow>
   <mover accent="true">
    <mi>β</mi>
    <mo stretchy="false">^</mo>
   </mover>
   <mo>±</mo>
   <mrow>
    <mn>2.5</mn>
    <mi>s</mi>
    <msub>
     <mi>e</mi>
     <mi>β</mi>
    </msub>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">plus-or-minus</csymbol>
    <apply>
     <ci>normal-^</ci>
     <ci>β</ci>
    </apply>
    <apply>
     <times></times>
     <cn type="float">2.5</cn>
     <ci>s</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>e</ci>
      <ci>β</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \hat{\beta}\pm 2.5se_{\beta}
  </annotation>
 </semantics>
</math>

 encompasses the true coefficient value
</dd>
</dl>

<p>The assumption is not unreasonable when <em>m</em> &gt;&gt; <em>n</em>. If the experimental errors are normally distributed the parameters will belong to a <a href="Student's_t-distribution" title="wikilink">Student's t-distribution</a> with <em>m</em> − <em>n</em> <a href="Degrees_of_freedom_(statistics)" title="wikilink">degrees of freedom</a>. When <em>m</em> &gt;&gt; <em>n</em> Student's t-distribution approximates a normal distribution. Note, however, that these confidence limits cannot take systematic error into account. Also, parameter errors should be quoted to one significant figure only, as they are subject to <a href="sampling_error" title="wikilink">sampling error</a>.<a class="footnoteRef" href="#fn7" id="fnref7"><sup>7</sup></a></p>

<p>When the number of observations is relatively small, <a href="Chebychev's_inequality" title="wikilink">Chebychev's inequality</a> can be used for an upper bound on probabilities, regardless of any assumptions about the distribution of experimental errors: the maximum probabilities that a parameter will be more than 1, 2 or 3 standard deviations away from its expectation value are 100%, 25% and 11% respectively.</p>
<h3 id="residual-values-and-correlation">Residual values and correlation</h3>

<p>The <a href="errors_and_residuals_in_statistics" title="wikilink">residuals</a> are related to the observations by</p>

<p>

<math display="block" id="Linear_least_squares_(mathematics):140">
 <semantics>
  <mrow>
   <mover accent="true">
    <mi>𝐫</mi>
    <mo stretchy="false">^</mo>
   </mover>
   <mo>=</mo>
   <mrow>
    <mi>𝐲</mi>
    <mo>-</mo>
    <mrow>
     <mi>X</mi>
     <mover accent="true">
      <mi>𝜷</mi>
      <mo stretchy="false">^</mo>
     </mover>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mi>𝐲</mi>
    <mo>-</mo>
    <mrow>
     <mi>H</mi>
     <mi>𝐲</mi>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>I</mi>
      <mo>-</mo>
      <mi>H</mi>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
    <mi>𝐲</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <ci>normal-^</ci>
      <ci>𝐫</ci>
     </apply>
     <apply>
      <minus></minus>
      <ci>𝐲</ci>
      <apply>
       <times></times>
       <ci>X</ci>
       <apply>
        <ci>normal-^</ci>
        <ci>𝜷</ci>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <minus></minus>
      <ci>𝐲</ci>
      <apply>
       <times></times>
       <ci>H</ci>
       <ci>𝐲</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <apply>
       <minus></minus>
       <ci>I</ci>
       <ci>H</ci>
      </apply>
      <ci>𝐲</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{\hat{r}}=\mathbf{y}-X\hat{\boldsymbol{\beta}}=\mathbf{y}-H\mathbf{y}=(%
I-H)\mathbf{y}
  </annotation>
 </semantics>
</math>

</p>

<p>where <em>H</em> is the <a href="idempotent_matrix" title="wikilink">idempotent matrix</a> known as the <a href="hat_matrix" title="wikilink">hat matrix</a>:</p>

<p>

<math display="block" id="Linear_least_squares_(mathematics):141">
 <semantics>
  <mrow>
   <mi>H</mi>
   <mo>=</mo>
   <mrow>
    <mi>X</mi>
    <msup>
     <mrow>
      <mo>(</mo>
      <mrow>
       <msup>
        <mi>X</mi>
        <mi mathvariant="normal">T</mi>
       </msup>
       <mi>W</mi>
       <mi>X</mi>
      </mrow>
      <mo>)</mo>
     </mrow>
     <mrow>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </msup>
    <msup>
     <mi>X</mi>
     <mi mathvariant="normal">T</mi>
    </msup>
    <mi>W</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>H</ci>
    <apply>
     <times></times>
     <ci>X</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>X</ci>
        <ci>normal-T</ci>
       </apply>
       <ci>W</ci>
       <ci>X</ci>
      </apply>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>X</ci>
      <ci>normal-T</ci>
     </apply>
     <ci>W</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   H=X\left(X^{\rm T}WX\right)^{-1}X^{\rm T}W
  </annotation>
 </semantics>
</math>

</p>

<p>and <em>I</em> is the <a href="identity_matrix" title="wikilink">identity matrix</a>. The variance-covariance matrix of the residuals, <strong>M<sup>r</sup></strong> is given by</p>

<p>

<math display="block" id="Linear_least_squares_(mathematics):142">
 <semantics>
  <mrow>
   <mrow>
    <msup>
     <mi>M</mi>
     <mi>𝐫</mi>
    </msup>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mo>(</mo>
      <mrow>
       <mi>I</mi>
       <mo>-</mo>
       <mi>H</mi>
      </mrow>
      <mo>)</mo>
     </mrow>
     <mi>M</mi>
     <msup>
      <mrow>
       <mo>(</mo>
       <mrow>
        <mi>I</mi>
        <mo>-</mo>
        <mi>H</mi>
       </mrow>
       <mo>)</mo>
      </mrow>
      <mi mathvariant="normal">T</mi>
     </msup>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>M</ci>
     <ci>𝐫</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <minus></minus>
      <ci>I</ci>
      <ci>H</ci>
     </apply>
     <ci>M</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <minus></minus>
       <ci>I</ci>
       <ci>H</ci>
      </apply>
      <ci>normal-T</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   M^{\mathbf{r}}=\left(I-H\right)M\left(I-H\right)^{\rm T}.
  </annotation>
 </semantics>
</math>

</p>

<p>Thus the residuals are correlated, even if the observations are not.</p>

<p>When 

<math display="inline" id="Linear_least_squares_(mathematics):143">
 <semantics>
  <mrow>
   <mi>W</mi>
   <mo>=</mo>
   <msup>
    <mi>M</mi>
    <mrow>
     <mo>-</mo>
     <mn>1</mn>
    </mrow>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>W</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>M</ci>
     <apply>
      <minus></minus>
      <cn type="integer">1</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   W=M^{-1}
  </annotation>
 </semantics>
</math>

,</p>

<p>

<math display="block" id="Linear_least_squares_(mathematics):144">
 <semantics>
  <mrow>
   <mrow>
    <msup>
     <mi>M</mi>
     <mi>𝐫</mi>
    </msup>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mo>(</mo>
      <mrow>
       <mi>I</mi>
       <mo>-</mo>
       <mi>H</mi>
      </mrow>
      <mo>)</mo>
     </mrow>
     <mi>M</mi>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>M</ci>
     <ci>𝐫</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <minus></minus>
      <ci>I</ci>
      <ci>H</ci>
     </apply>
     <ci>M</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   M^{\mathbf{r}}=\left(I-H\right)M.
  </annotation>
 </semantics>
</math>

</p>

<p>The sum of residual values is equal to zero whenever the model function contains a constant term. Left-multiply the expression for the residuals by <em>X</em><sup>T</sup>:</p>

<p>

<math display="block" id="Linear_least_squares_(mathematics):145">
 <semantics>
  <mrow>
   <mrow>
    <msup>
     <mi>X</mi>
     <mi mathvariant="normal">T</mi>
    </msup>
    <mover accent="true">
     <mi>𝐫</mi>
     <mo stretchy="false">^</mo>
    </mover>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <msup>
      <mi>X</mi>
      <mi mathvariant="normal">T</mi>
     </msup>
     <mi>𝐲</mi>
    </mrow>
    <mo>-</mo>
    <mrow>
     <msup>
      <mi>X</mi>
      <mi mathvariant="normal">T</mi>
     </msup>
     <mi>X</mi>
     <mover accent="true">
      <mi>𝜷</mi>
      <mo stretchy="false">^</mo>
     </mover>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <msup>
      <mi>X</mi>
      <mi mathvariant="normal">T</mi>
     </msup>
     <mi>𝐲</mi>
    </mrow>
    <mo>-</mo>
    <mrow>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <msup>
        <mi>X</mi>
        <mi mathvariant="normal">T</mi>
       </msup>
       <mi>X</mi>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <msup>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <msup>
         <mi>X</mi>
         <mi mathvariant="normal">T</mi>
        </msup>
        <mi>X</mi>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
      <mrow>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
     </msup>
     <msup>
      <mi>X</mi>
      <mi mathvariant="normal">T</mi>
     </msup>
     <mi>𝐲</mi>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mn>𝟎</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>X</ci>
       <ci>normal-T</ci>
      </apply>
      <apply>
       <ci>normal-^</ci>
       <ci>𝐫</ci>
      </apply>
     </apply>
     <apply>
      <minus></minus>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>X</ci>
        <ci>normal-T</ci>
       </apply>
       <ci>𝐲</ci>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>X</ci>
        <ci>normal-T</ci>
       </apply>
       <ci>X</ci>
       <apply>
        <ci>normal-^</ci>
        <ci>𝜷</ci>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <minus></minus>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>X</ci>
        <ci>normal-T</ci>
       </apply>
       <ci>𝐲</ci>
      </apply>
      <apply>
       <times></times>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>X</ci>
         <ci>normal-T</ci>
        </apply>
        <ci>X</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <times></times>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>X</ci>
          <ci>normal-T</ci>
         </apply>
         <ci>X</ci>
        </apply>
        <apply>
         <minus></minus>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>X</ci>
        <ci>normal-T</ci>
       </apply>
       <ci>𝐲</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <cn type="integer">0</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   X^{\rm T}\hat{\mathbf{r}}=X^{\rm T}\mathbf{y}-X^{\rm T}X\hat{\boldsymbol{\beta%
}}=X^{\rm T}\mathbf{y}-(X^{\rm T}X)(X^{\rm T}X)^{-1}X^{\rm T}\mathbf{y}=%
\mathbf{0}
  </annotation>
 </semantics>
</math>

</p>

<p>Say, for example, that the first term of the model is a constant, so that 

<math display="inline" id="Linear_least_squares_(mathematics):146">
 <semantics>
  <mrow>
   <msub>
    <mi>X</mi>
    <mrow>
     <mi>i</mi>
     <mn>1</mn>
    </mrow>
   </msub>
   <mo>=</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>X</ci>
     <apply>
      <times></times>
      <ci>i</ci>
      <cn type="integer">1</cn>
     </apply>
    </apply>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   X_{i1}=1
  </annotation>
 </semantics>
</math>

 for all <em>i</em>. In that case it follows that</p>

<p>

<math display="block" id="Linear_least_squares_(mathematics):147">
 <semantics>
  <mrow>
   <mrow>
    <munderover>
     <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
     <mi>i</mi>
     <mi>m</mi>
    </munderover>
    <mrow>
     <msub>
      <mi>X</mi>
      <mrow>
       <mi>i</mi>
       <mn>1</mn>
      </mrow>
     </msub>
     <msub>
      <mover accent="true">
       <mi>r</mi>
       <mo stretchy="false">^</mo>
      </mover>
      <mi>i</mi>
     </msub>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <munderover>
     <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
     <mi>i</mi>
     <mi>m</mi>
    </munderover>
    <msub>
     <mover accent="true">
      <mi>r</mi>
      <mo stretchy="false">^</mo>
     </mover>
     <mi>i</mi>
    </msub>
   </mrow>
   <mo>=</mo>
   <mn>0.</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <ci>i</ci>
       </apply>
       <ci>m</ci>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>X</ci>
        <apply>
         <times></times>
         <ci>i</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <apply>
         <ci>normal-^</ci>
         <ci>r</ci>
        </apply>
        <ci>i</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <ci>i</ci>
       </apply>
       <ci>m</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <apply>
        <ci>normal-^</ci>
        <ci>r</ci>
       </apply>
       <ci>i</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <cn type="float">0.</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \sum_{i}^{m}X_{i1}\hat{r}_{i}=\sum_{i}^{m}\hat{r}_{i}=0.
  </annotation>
 </semantics>
</math>

</p>

<p>Thus, in the <a href="#Motivational_example" title="wikilink">motivational example</a>, above, the fact that the sum of residual values is equal to zero it is not accidental but is a consequence of the presence of the constant term, α, in the model.</p>

<p>If experimental error follows a <a href="normal_distribution" title="wikilink">normal distribution</a>, then, because of the linear relationship between residuals and observations, so should residuals,<a class="footnoteRef" href="#fn8" id="fnref8"><sup>8</sup></a> but since the observations are only a sample of the population of all possible observations, the residuals should belong to a <a href="Student's_t-distribution" title="wikilink">Student's t-distribution</a>. <a href="Studentized_residual" title="wikilink">Studentized residuals</a> are useful in making a statistical test for an <a class="uri" href="outlier" title="wikilink">outlier</a> when a particular residual appears to be excessively large.</p>
<h2 id="objective-function">Objective function</h2>

<p>The optimal value of the objective function, found by substituting in the optimal expression for the coefficient vector, can be written as</p>

<p>

<math display="block" id="Linear_least_squares_(mathematics):148">
 <semantics>
  <mrow>
   <mrow>
    <mi>S</mi>
    <mo>=</mo>
    <mrow>
     <msup>
      <mi>𝐲</mi>
      <mi mathvariant="normal">T</mi>
     </msup>
     <msup>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mi>I</mi>
        <mo>-</mo>
        <mi>H</mi>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
      <mi mathvariant="normal">T</mi>
     </msup>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mi>I</mi>
       <mo>-</mo>
       <mi>H</mi>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <mi>𝐲</mi>
    </mrow>
    <mo>=</mo>
    <mrow>
     <msup>
      <mi>𝐲</mi>
      <mi mathvariant="normal">T</mi>
     </msup>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mi>I</mi>
       <mo>-</mo>
       <mi>H</mi>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <mi>𝐲</mi>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <ci>S</ci>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>𝐲</ci>
       <ci>normal-T</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <minus></minus>
        <ci>I</ci>
        <ci>H</ci>
       </apply>
       <ci>normal-T</ci>
      </apply>
      <apply>
       <minus></minus>
       <ci>I</ci>
       <ci>H</ci>
      </apply>
      <ci>𝐲</ci>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>𝐲</ci>
       <ci>normal-T</ci>
      </apply>
      <apply>
       <minus></minus>
       <ci>I</ci>
       <ci>H</ci>
      </apply>
      <ci>𝐲</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   S=\mathbf{y}^{\rm T}(I-H)^{\rm T}(I-H)\mathbf{y}=\mathbf{y}^{\rm T}(I-H)%
\mathbf{y},
  </annotation>
 </semantics>
</math>

</p>

<p>the latter equality holding since (<em>I</em> – <em>H</em>) is symmetric and idempotent. It can be shown from this<a class="footnoteRef" href="#fn9" id="fnref9"><sup>9</sup></a> that under an appropriate assignment of weights the <a href="expected_value" title="wikilink">expected value</a> of <em>S</em> is <em>m-n</em>. If instead unit weights are assumed, the expected value of <em>S</em> is 

<math display="inline" id="Linear_least_squares_(mathematics):149">
 <semantics>
  <mrow>
   <mrow>
    <mo stretchy="false">(</mo>
    <mrow>
     <mi>m</mi>
     <mo>-</mo>
     <mi>n</mi>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
   <msup>
    <mi>σ</mi>
    <mn>2</mn>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <minus></minus>
     <ci>m</ci>
     <ci>n</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>σ</ci>
     <cn type="integer">2</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (m-n)\sigma^{2}
  </annotation>
 </semantics>
</math>

, where 

<math display="inline" id="Linear_least_squares_(mathematics):150">
 <semantics>
  <msup>
   <mi>σ</mi>
   <mn>2</mn>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>σ</ci>
    <cn type="integer">2</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \sigma^{2}
  </annotation>
 </semantics>
</math>

 is the variance of each observation.</p>

<p>If it is assumed that the residuals belong to a normal distribution, the objective function, being a sum of weighted squared residuals, will belong to a <a href="Chi-squared_distribution" title="wikilink">chi-squared (

<math display="inline" id="Linear_least_squares_(mathematics):151">
 <semantics>
  <msup>
   <mi>χ</mi>
   <mn>2</mn>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>χ</ci>
    <cn type="integer">2</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \chi^{2}
  </annotation>
 </semantics>
</math>

) distribution</a> with <em>m-n</em> <a href="Degrees_of_freedom_(statistics)" title="wikilink">degrees of freedom</a>. Some illustrative percentile values of 

<math display="inline" id="Linear_least_squares_(mathematics):152">
 <semantics>
  <msup>
   <mi>χ</mi>
   <mn>2</mn>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>χ</ci>
    <cn type="integer">2</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \chi^{2}
  </annotation>
 </semantics>
</math>

 are given in the following table.<a class="footnoteRef" href="#fn10" id="fnref10"><sup>10</sup></a></p>
<dl>
<dd>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">
<p>m-n</p></th>
<th style="text-align: left;">
<p>

<math display="inline" id="Linear_least_squares_(mathematics):153">
 <semantics>
  <msubsup>
   <mi>χ</mi>
   <mn>0.50</mn>
   <mn>2</mn>
  </msubsup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>χ</ci>
     <cn type="integer">2</cn>
    </apply>
    <cn type="float">0.50</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \chi^{2}_{0.50}
  </annotation>
 </semantics>
</math>

</p></th>
<th style="text-align: left;">
<p>

<math display="inline" id="Linear_least_squares_(mathematics):154">
 <semantics>
  <msubsup>
   <mi>χ</mi>
   <mn>0.95</mn>
   <mn>2</mn>
  </msubsup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>χ</ci>
     <cn type="integer">2</cn>
    </apply>
    <cn type="float">0.95</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \chi^{2}_{0.95}
  </annotation>
 </semantics>
</math>

</p></th>
<th style="text-align: left;">
<p>

<math display="inline" id="Linear_least_squares_(mathematics):155">
 <semantics>
  <msubsup>
   <mi>χ</mi>
   <mn>0.99</mn>
   <mn>2</mn>
  </msubsup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>χ</ci>
     <cn type="integer">2</cn>
    </apply>
    <cn type="float">0.99</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \chi^{2}_{0.99}
  </annotation>
 </semantics>
</math>

</p></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">
<p>10</p></td>
<td style="text-align: left;">
<p>9.34</p></td>
<td style="text-align: left;">
<p>18.3</p></td>
<td style="text-align: left;">
<p>23.2</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>25</p></td>
<td style="text-align: left;">
<p>24.3</p></td>
<td style="text-align: left;">
<p>37.7</p></td>
<td style="text-align: left;">
<p>44.3</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>100</p></td>
<td style="text-align: left;">
<p>99.3</p></td>
<td style="text-align: left;">
<p>124</p></td>
<td style="text-align: left;">
<p>136</p></td>
</tr>
</tbody>
</table>
</dd>
</dl>

<p>These values can be used for a statistical criterion as to the <a class="uri" href="goodness-of-fit" title="wikilink">goodness-of-fit</a>. When unit weights are used, the numbers should be divided by the variance of an observation.</p>
<h2 id="constrained-linear-least-squares">Constrained linear least squares</h2>

<p>Often it is of interest to solve a linear least squares problem with an additional constraint on the solution. With constrained linear least squares, the original equation</p>

<p>

<math display="block" id="Linear_least_squares_(mathematics):156">
 <semantics>
  <mrow>
   <mrow>
    <mi>𝐗</mi>
    <mi>𝜷</mi>
   </mrow>
   <mo>=</mo>
   <mi>𝐲</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>𝐗</ci>
     <ci>𝜷</ci>
    </apply>
    <ci>𝐲</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{X}\boldsymbol{\beta}=\mathbf{y}
  </annotation>
 </semantics>
</math>

</p>

<p>must be satisfied (in the least squares sense) while also ensuring that some other property of 

<math display="inline" id="Linear_least_squares_(mathematics):157">
 <semantics>
  <mi>𝜷</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>𝜷</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \boldsymbol{\beta}
  </annotation>
 </semantics>
</math>

 is maintained. There are often special purpose algorithms for solving such problems efficiently. Some examples of constraints are given below:</p>
<ul>
<li><a href="Constrained_generalized_inverse" title="wikilink">Equality constrained</a> least squares: the elements of 

<math display="inline" id="Linear_least_squares_(mathematics):158">
 <semantics>
  <mi>𝜷</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>𝜷</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \boldsymbol{\beta}
  </annotation>
 </semantics>
</math>

 must exactly satisfy 

<math display="inline" id="Linear_least_squares_(mathematics):159">
 <semantics>
  <mrow>
   <mrow>
    <mi>𝐋</mi>
    <mi>𝜷</mi>
   </mrow>
   <mo>=</mo>
   <mi>𝐝</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>𝐋</ci>
     <ci>𝜷</ci>
    </apply>
    <ci>𝐝</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{L}\boldsymbol{\beta}=\mathbf{d}
  </annotation>
 </semantics>
</math>

</li>
<li><a href="Tikhonov_regularization" title="wikilink">Regularized</a> least squares: the elements of 

<math display="inline" id="Linear_least_squares_(mathematics):160">
 <semantics>
  <mi>𝜷</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>𝜷</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \boldsymbol{\beta}
  </annotation>
 </semantics>
</math>

 must satisfy 

<math display="inline" id="Linear_least_squares_(mathematics):161">
 <semantics>
  <mrow>
   <mrow>
    <mo>∥</mo>
    <mrow>
     <mrow>
      <mi>𝐋</mi>
      <mi>𝜷</mi>
     </mrow>
     <mo>-</mo>
     <mi>𝐝</mi>
    </mrow>
    <mo>∥</mo>
   </mrow>
   <mo>≤</mo>
   <mi>ρ</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <leq></leq>
    <apply>
     <csymbol cd="latexml">norm</csymbol>
     <apply>
      <minus></minus>
      <apply>
       <times></times>
       <ci>𝐋</ci>
       <ci>𝜷</ci>
      </apply>
      <ci>𝐝</ci>
     </apply>
    </apply>
    <ci>ρ</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \|\mathbf{L}\boldsymbol{\beta}-\mathbf{d}\|\leq\rho
  </annotation>
 </semantics>
</math>

</li>
<li><a href="Non-negative_least_squares" title="wikilink">Non-negative least squares</a> (NNLS): The vector 

<math display="inline" id="Linear_least_squares_(mathematics):162">
 <semantics>
  <mi>𝜷</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>𝜷</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \boldsymbol{\beta}
  </annotation>
 </semantics>
</math>

 satisfies the <a href="ordered_vector_space" title="wikilink">vector inequality</a> 

<math display="inline" id="Linear_least_squares_(mathematics):163">
 <semantics>
  <mrow>
   <mi>𝜷</mi>
   <mo>≥</mo>
   <mn>𝟎</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <geq></geq>
    <ci>𝜷</ci>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \boldsymbol{\beta}\geq\boldsymbol{0}
  </annotation>
 </semantics>
</math>

 that is defined componentwise --- that is, each component must be either positive or zero.</li>
<li>Box-constrained least squares: The vector 

<math display="inline" id="Linear_least_squares_(mathematics):164">
 <semantics>
  <mi>𝜷</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>𝜷</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \boldsymbol{\beta}
  </annotation>
 </semantics>
</math>

 satisfies the <a href="ordered_vector_space" title="wikilink">vector inequalities</a> 

<math display="inline" id="Linear_least_squares_(mathematics):165">
 <semantics>
  <mrow>
   <mrow>
    <mi>𝒍</mi>
    <mi>𝒃</mi>
   </mrow>
   <mo>≤</mo>
   <mi>𝜷</mi>
   <mo>≤</mo>
   <mrow>
    <mi>𝒖</mi>
    <mi>𝒃</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <leq></leq>
     <apply>
      <times></times>
      <ci>𝒍</ci>
      <ci>𝒃</ci>
     </apply>
     <ci>𝜷</ci>
    </apply>
    <apply>
     <leq></leq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <ci>𝒖</ci>
      <ci>𝒃</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \boldsymbol{lb}\leq\boldsymbol{\beta}\leq\boldsymbol{ub}
  </annotation>
 </semantics>
</math>

, each of which is defined componentwise.</li>
<li>Integer constrained least squares: all elements of 

<math display="inline" id="Linear_least_squares_(mathematics):166">
 <semantics>
  <mi>𝜷</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>𝜷</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \boldsymbol{\beta}
  </annotation>
 </semantics>
</math>

 must be <a class="uri" href="integer" title="wikilink">integer</a> (instead of <a href="real_number" title="wikilink">real numbers</a>).</li>
<li>Phase constrained least squares: all elements of 

<math display="inline" id="Linear_least_squares_(mathematics):167">
 <semantics>
  <mi>𝜷</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>𝜷</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \boldsymbol{\beta}
  </annotation>
 </semantics>
</math>

 must have the same <a href="Arg_(mathematics)" title="wikilink">phase</a> (or must be real rather than <a href="complex_numbers" title="wikilink">complex numbers</a>, i.e. phase = 0).</li>
</ul>

<p>When the constraint only applies to some of the variables, the mixed problem may be solved using <strong>separable least squares</strong> by letting 

<math display="inline" id="Linear_least_squares_(mathematics):168">
 <semantics>
  <mrow>
   <mi>𝐗</mi>
   <mo>=</mo>
   <mrow>
    <mo stretchy="false">[</mo>
    <mrow>
     <msub>
      <mi>𝐗</mi>
      <mn>𝟏</mn>
     </msub>
     <msub>
      <mi>𝐗</mi>
      <mn>𝟐</mn>
     </msub>
    </mrow>
    <mo stretchy="false">]</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>𝐗</ci>
    <apply>
     <csymbol cd="latexml">delimited-[]</csymbol>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>𝐗</ci>
       <cn type="integer">1</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>𝐗</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{X}=[\mathbf{X_{1}}\mathbf{X_{2}}]
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Linear_least_squares_(mathematics):169">
 <semantics>
  <mrow>
   <msup>
    <mi>β</mi>
    <mi mathvariant="normal">T</mi>
   </msup>
   <mo>=</mo>
   <mrow>
    <mo stretchy="false">[</mo>
    <mrow>
     <mmultiscripts>
      <mi>β</mi>
      <mn>𝟏</mn>
      <none></none>
      <none></none>
      <mi mathvariant="normal">T</mi>
     </mmultiscripts>
     <mmultiscripts>
      <mi>β</mi>
      <mn>𝟐</mn>
      <none></none>
      <none></none>
      <mi mathvariant="normal">T</mi>
     </mmultiscripts>
    </mrow>
    <mo stretchy="false">]</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>β</ci>
     <ci>normal-T</ci>
    </apply>
    <apply>
     <csymbol cd="latexml">delimited-[]</csymbol>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>β</ci>
        <cn type="integer">1</cn>
       </apply>
       <ci>normal-T</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>β</ci>
        <cn type="integer">2</cn>
       </apply>
       <ci>normal-T</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{\beta}^{\rm T}=[\mathbf{\beta_{1}}^{\rm T}\mathbf{\beta_{2}}^{\rm T}]
  </annotation>
 </semantics>
</math>

 represent the unconstrained (1) and constrained (2) components. Then substituting the least squares solution for 

<math display="inline" id="Linear_least_squares_(mathematics):170">
 <semantics>
  <msub>
   <mi>β</mi>
   <mn>𝟏</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>β</ci>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{\beta_{1}}
  </annotation>
 </semantics>
</math>

, i.e.</p>

<p>

<math display="block" id="Linear_least_squares_(mathematics):171">
 <semantics>
  <mrow>
   <mover accent="true">
    <msub>
     <mi>𝜷</mi>
     <mn>𝟏</mn>
    </msub>
    <mo stretchy="false">^</mo>
   </mover>
   <mo>=</mo>
   <mrow>
    <mmultiscripts>
     <mi>𝐗</mi>
     <mn>𝟏</mn>
     <none></none>
     <none></none>
     <mo>+</mo>
    </mmultiscripts>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>𝐲</mi>
      <mo>-</mo>
      <mrow>
       <msub>
        <mi>𝐗</mi>
        <mn>𝟐</mn>
       </msub>
       <msub>
        <mi>𝜷</mi>
        <mn>𝟐</mn>
       </msub>
      </mrow>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <ci>normal-^</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>𝜷</ci>
      <cn type="integer">1</cn>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>𝐗</ci>
       <cn type="integer">1</cn>
      </apply>
      <plus></plus>
     </apply>
     <apply>
      <minus></minus>
      <ci>𝐲</ci>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>𝐗</ci>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>𝜷</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \hat{\boldsymbol{\beta_{1}}}=\mathbf{X_{1}}^{+}(\mathbf{y}-\mathbf{X_{2}}%
\boldsymbol{\beta_{2}})
  </annotation>
 </semantics>
</math>

</p>

<p>back into the original expression gives (following some rearrangement) an equation that can be solved as a purely constrained problem in 

<math display="inline" id="Linear_least_squares_(mathematics):172">
 <semantics>
  <msub>
   <mi>β</mi>
   <mn>𝟐</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>β</ci>
    <cn type="integer">2</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{\beta_{2}}
  </annotation>
 </semantics>
</math>

.</p>

<p>

<math display="block" id="Linear_least_squares_(mathematics):173">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>𝐏𝐗</mi>
     <mn>𝟐</mn>
    </msub>
    <msub>
     <mi>𝜷</mi>
     <mn>𝟐</mn>
    </msub>
   </mrow>
   <mo>=</mo>
   <mi>𝐏𝐲</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>𝐏𝐗</ci>
      <cn type="integer">2</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>𝜷</ci>
      <cn type="integer">2</cn>
     </apply>
    </apply>
    <ci>𝐏𝐲</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{P}\mathbf{X_{2}}\boldsymbol{\beta_{2}}=\mathbf{P}\mathbf{y}
  </annotation>
 </semantics>
</math>

</p>

<p>where 

<math display="inline" id="Linear_least_squares_(mathematics):174">
 <semantics>
  <mrow>
   <mi>𝐏</mi>
   <mo>:=</mo>
   <mrow>
    <mi>𝐈</mi>
    <mo>-</mo>
    <mrow>
     <msub>
      <mi>𝐗</mi>
      <mn>𝟏</mn>
     </msub>
     <mmultiscripts>
      <mi>𝐗</mi>
      <mn>𝟏</mn>
      <none></none>
      <none></none>
      <mo>+</mo>
     </mmultiscripts>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">assign</csymbol>
    <ci>𝐏</ci>
    <apply>
     <minus></minus>
     <ci>𝐈</ci>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>𝐗</ci>
       <cn type="integer">1</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>𝐗</ci>
        <cn type="integer">1</cn>
       </apply>
       <plus></plus>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{P}:=\mathbf{I}-\mathbf{X_{1}}\mathbf{X_{1}}^{+}
  </annotation>
 </semantics>
</math>

 is a <a href="projection_matrix" title="wikilink">projection matrix</a>. Following the constrained estimation of 

<math display="inline" id="Linear_least_squares_(mathematics):175">
 <semantics>
  <mover accent="true">
   <msub>
    <mi>𝜷</mi>
    <mn>𝟐</mn>
   </msub>
   <mo stretchy="false">^</mo>
  </mover>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-^</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>𝜷</ci>
     <cn type="integer">2</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \hat{\boldsymbol{\beta_{2}}}
  </annotation>
 </semantics>
</math>

 the vector 

<math display="inline" id="Linear_least_squares_(mathematics):176">
 <semantics>
  <mover accent="true">
   <msub>
    <mi>𝜷</mi>
    <mn>𝟏</mn>
   </msub>
   <mo stretchy="false">^</mo>
  </mover>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-^</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>𝜷</ci>
     <cn type="integer">1</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \hat{\boldsymbol{\beta_{1}}}
  </annotation>
 </semantics>
</math>

 is obtained from the expression above.</p>
<h2 id="typical-uses-and-applications">Typical uses and applications</h2>
<ul>
<li><a href="Polynomial_regression" title="wikilink">Polynomial fitting</a>: models are <a href="polynomial" title="wikilink">polynomials</a> in an independent variable, <em>x</em>:
<ul>
<li>Straight line

<math display="block" id="Linear_least_squares_(mathematics):177">
 <semantics>
  <mrow>
   <mrow>
    <mi>f</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>x</mi>
     <mo>,</mo>
     <mi>𝜷</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <msub>
     <mi>β</mi>
     <mn>1</mn>
    </msub>
    <mo>+</mo>
    <mrow>
     <msub>
      <mi>β</mi>
      <mn>2</mn>
     </msub>
     <mi>x</mi>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>f</ci>
     <interval closure="open">
      <ci>x</ci>
      <ci>𝜷</ci>
     </interval>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>β</ci>
      <cn type="integer">1</cn>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>β</ci>
       <cn type="integer">2</cn>
      </apply>
      <ci>x</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f(x,\boldsymbol{\beta})=\beta_{1}+\beta_{2}x
  </annotation>
 </semantics>
</math>

.<a class="footnoteRef" href="#fn11" id="fnref11"><sup>11</sup></a></li>
<li>Quadratic

<math display="block" id="Linear_least_squares_(mathematics):178">
 <semantics>
  <mrow>
   <mrow>
    <mi>f</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>x</mi>
     <mo>,</mo>
     <mi>𝜷</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <msub>
     <mi>β</mi>
     <mn>1</mn>
    </msub>
    <mo>+</mo>
    <mrow>
     <msub>
      <mi>β</mi>
      <mn>2</mn>
     </msub>
     <mi>x</mi>
    </mrow>
    <mo>+</mo>
    <mrow>
     <msub>
      <mi>β</mi>
      <mn>3</mn>
     </msub>
     <msup>
      <mi>x</mi>
      <mn>2</mn>
     </msup>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>f</ci>
     <interval closure="open">
      <ci>x</ci>
      <ci>𝜷</ci>
     </interval>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>β</ci>
      <cn type="integer">1</cn>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>β</ci>
       <cn type="integer">2</cn>
      </apply>
      <ci>x</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>β</ci>
       <cn type="integer">3</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>x</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f(x,\boldsymbol{\beta})=\beta_{1}+\beta_{2}x+\beta_{3}x^{2}
  </annotation>
 </semantics>
</math>

.</li>
<li>Cubic, quartic and higher polynomials. For <a href="polynomial_regression" title="wikilink">regression with high-order polynomials</a>, the use of <a href="orthogonal_polynomials" title="wikilink">orthogonal polynomials</a> is recommended.<a class="footnoteRef" href="#fn12" id="fnref12"><sup>12</sup></a></li>
</ul></li>
<li><a href="Numerical_smoothing_and_differentiation" title="wikilink">Numerical smoothing and differentiation</a> — this is an application of polynomial fitting.</li>
<li>Multinomials in more than one independent variable, including surface fitting</li>
<li>Curve fitting with <a href="B-spline" title="wikilink">B-splines</a> <a class="footnoteRef" href="#fn13" id="fnref13"><sup>13</sup></a></li>
<li><a class="uri" href="Chemometrics" title="wikilink">Chemometrics</a>, <a href="Calibration_curve" title="wikilink">Calibration curve</a>, <a href="Standard_addition" title="wikilink">Standard addition</a>, <a href="Gran_plot" title="wikilink">Gran plot</a>, <a href="Beer-Lambert_law#Chemical_analysis" title="wikilink">analysis of mixtures</a></li>
</ul>
<h3 id="uses-in-data-fitting">Uses in data fitting</h3>

<p>The primary application of linear least squares is in <a href="data_fitting" title="wikilink">data fitting</a>. Given a set of <em>m</em> data points 

<math display="inline" id="Linear_least_squares_(mathematics):179">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>y</mi>
     <mn>1</mn>
    </msub>
    <mo>,</mo>
    <msub>
     <mi>y</mi>
     <mn>2</mn>
    </msub>
    <mo>,</mo>
    <mi mathvariant="normal">…</mi>
    <mo>,</mo>
    <msub>
     <mi>y</mi>
     <mi>m</mi>
    </msub>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <list>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>y</ci>
     <cn type="integer">1</cn>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>y</ci>
     <cn type="integer">2</cn>
    </apply>
    <ci>normal-…</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>y</ci>
     <ci>m</ci>
    </apply>
   </list>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   y_{1},y_{2},\dots,y_{m},
  </annotation>
 </semantics>
</math>

 consisting of experimentally measured values taken at <em>m</em> values 

<math display="inline" id="Linear_least_squares_(mathematics):180">
 <semantics>
  <mrow>
   <msub>
    <mi>x</mi>
    <mn>1</mn>
   </msub>
   <mo>,</mo>
   <msub>
    <mi>x</mi>
    <mn>2</mn>
   </msub>
   <mo>,</mo>
   <mi mathvariant="normal">…</mi>
   <mo>,</mo>
   <msub>
    <mi>x</mi>
    <mi>m</mi>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <list>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>x</ci>
     <cn type="integer">1</cn>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>x</ci>
     <cn type="integer">2</cn>
    </apply>
    <ci>normal-…</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>x</ci>
     <ci>m</ci>
    </apply>
   </list>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x_{1},x_{2},\dots,x_{m}
  </annotation>
 </semantics>
</math>

 of an independent variable (

<math display="inline" id="Linear_least_squares_(mathematics):181">
 <semantics>
  <msub>
   <mi>x</mi>
   <mi>i</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>x</ci>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x_{i}
  </annotation>
 </semantics>
</math>

 may be scalar or vector quantities), and given a model function 

<math display="inline" id="Linear_least_squares_(mathematics):182">
 <semantics>
  <mrow>
   <mrow>
    <mi>y</mi>
    <mo>=</mo>
    <mrow>
     <mi>f</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>x</mi>
      <mo>,</mo>
      <mi>𝜷</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>y</ci>
    <apply>
     <times></times>
     <ci>f</ci>
     <interval closure="open">
      <ci>x</ci>
      <ci>𝜷</ci>
     </interval>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   y=f(x,\boldsymbol{\beta}),
  </annotation>
 </semantics>
</math>

 with 

<math display="inline" id="Linear_least_squares_(mathematics):183">
 <semantics>
  <mrow>
   <mrow>
    <mi>𝜷</mi>
    <mo>=</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <msub>
      <mi>β</mi>
      <mn>1</mn>
     </msub>
     <mo>,</mo>
     <msub>
      <mi>β</mi>
      <mn>2</mn>
     </msub>
     <mo>,</mo>
     <mi mathvariant="normal">…</mi>
     <mo>,</mo>
     <msub>
      <mi>β</mi>
      <mi>n</mi>
     </msub>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>𝜷</ci>
    <vector>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>β</ci>
      <cn type="integer">1</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>β</ci>
      <cn type="integer">2</cn>
     </apply>
     <ci>normal-…</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>β</ci>
      <ci>n</ci>
     </apply>
    </vector>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \boldsymbol{\beta}=(\beta_{1},\beta_{2},\dots,\beta_{n}),
  </annotation>
 </semantics>
</math>

 it is desired to find the parameters 

<math display="inline" id="Linear_least_squares_(mathematics):184">
 <semantics>
  <msub>
   <mi>β</mi>
   <mi>j</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>β</ci>
    <ci>j</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \beta_{j}
  </annotation>
 </semantics>
</math>

 such that the model function "best" fits the data. In linear least squares, linearity is meant to be with respect to parameters 

<math display="inline" id="Linear_least_squares_(mathematics):185">
 <semantics>
  <mrow>
   <msub>
    <mi>β</mi>
    <mi>j</mi>
   </msub>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>β</ci>
    <ci>j</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \beta_{j},
  </annotation>
 </semantics>
</math>

 so</p>

<p>

<math display="block" id="Linear_least_squares_(mathematics):186">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>f</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>x</mi>
      <mo>,</mo>
      <mi>𝜷</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <munderover>
      <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
      <mrow>
       <mi>j</mi>
       <mo>=</mo>
       <mn>1</mn>
      </mrow>
      <mi>n</mi>
     </munderover>
     <mrow>
      <msub>
       <mi>β</mi>
       <mi>j</mi>
      </msub>
      <msub>
       <mi>ϕ</mi>
       <mi>j</mi>
      </msub>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>x</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>f</ci>
     <interval closure="open">
      <ci>x</ci>
      <ci>𝜷</ci>
     </interval>
    </apply>
    <apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <apply>
        <eq></eq>
        <ci>j</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <ci>n</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>β</ci>
       <ci>j</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>ϕ</ci>
       <ci>j</ci>
      </apply>
      <ci>x</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f(x,\boldsymbol{\beta})=\sum_{j=1}^{n}\beta_{j}\phi_{j}(x).
  </annotation>
 </semantics>
</math>

</p>

<p>Here, the functions 

<math display="inline" id="Linear_least_squares_(mathematics):187">
 <semantics>
  <msub>
   <mi>ϕ</mi>
   <mi>j</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>ϕ</ci>
    <ci>j</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \phi_{j}
  </annotation>
 </semantics>
</math>

 may be <strong>nonlinear</strong> with respect to the variable <strong>x</strong>.</p>

<p>Ideally, the model function fits the data exactly, so</p>

<p>

<math display="block" id="Linear_least_squares_(mathematics):188">
 <semantics>
  <mrow>
   <msub>
    <mi>y</mi>
    <mi>i</mi>
   </msub>
   <mo>=</mo>
   <mrow>
    <mi>f</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <msub>
      <mi>x</mi>
      <mi>i</mi>
     </msub>
     <mo>,</mo>
     <mi>𝜷</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>y</ci>
     <ci>i</ci>
    </apply>
    <apply>
     <times></times>
     <ci>f</ci>
     <interval closure="open">
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <ci>i</ci>
      </apply>
      <ci>𝜷</ci>
     </interval>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   y_{i}=f(x_{i},\boldsymbol{\beta})
  </annotation>
 </semantics>
</math>

</p>

<p>for all 

<math display="inline" id="Linear_least_squares_(mathematics):189">
 <semantics>
  <mrow>
   <mrow>
    <mi>i</mi>
    <mo>=</mo>
    <mrow>
     <mn>1</mn>
     <mo>,</mo>
     <mn>2</mn>
     <mo>,</mo>
     <mi mathvariant="normal">…</mi>
     <mo>,</mo>
     <mi>m</mi>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>i</ci>
    <list>
     <cn type="integer">1</cn>
     <cn type="integer">2</cn>
     <ci>normal-…</ci>
     <ci>m</ci>
    </list>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   i=1,2,\dots,m.
  </annotation>
 </semantics>
</math>

 This is usually not possible in practice, as there are more data points than there are parameters to be determined. The approach chosen then is to find the minimal possible value of the sum of squares of the <a href="residual_(statistics)" title="wikilink">residuals</a></p>

<p>

<math display="block" id="Linear_least_squares_(mathematics):190">
 <semantics>
  <mrow>
   <msub>
    <mi>r</mi>
    <mi>i</mi>
   </msub>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>𝜷</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>=</mo>
   <msub>
    <mi>y</mi>
    <mi>i</mi>
   </msub>
   <mo>-</mo>
   <mi>f</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>x</mi>
     <mi>i</mi>
    </msub>
    <mo>,</mo>
    <mi>𝜷</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo rspace="7.5pt">,</mo>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>i</mi>
    <mo>=</mo>
    <mn>1</mn>
    <mo>,</mo>
    <mn>2</mn>
    <mo>,</mo>
    <mi mathvariant="normal">…</mi>
    <mo>,</mo>
    <mi>m</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>r</ci>
     <ci>i</ci>
    </apply>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">β</csymbol>
     <ci>normal-)</ci>
    </cerror>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>y</ci>
     <ci>i</ci>
    </apply>
    <minus></minus>
    <csymbol cd="unknown">f</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <ci>i</ci>
     </apply>
     <ci>normal-,</ci>
     <csymbol cd="unknown">β</csymbol>
     <ci>normal-)</ci>
    </cerror>
    <ci>normal-,</ci>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">i</csymbol>
     <eq></eq>
     <cn type="integer">1</cn>
     <ci>normal-,</ci>
     <cn type="integer">2</cn>
     <ci>normal-,</ci>
     <ci>normal-…</ci>
     <ci>normal-,</ci>
     <csymbol cd="unknown">m</csymbol>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   r_{i}(\boldsymbol{\beta})=y_{i}-f(x_{i},\boldsymbol{\beta}),\ (i=1,2,\dots,m)
  </annotation>
 </semantics>
</math>

 so to minimize the function</p>

<p>

<math display="block" id="Linear_least_squares_(mathematics):191">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>S</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>𝜷</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <munderover>
      <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
      <mrow>
       <mi>i</mi>
       <mo>=</mo>
       <mn>1</mn>
      </mrow>
      <mi>m</mi>
     </munderover>
     <mrow>
      <msubsup>
       <mi>r</mi>
       <mi>i</mi>
       <mn>2</mn>
      </msubsup>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>𝜷</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>S</ci>
     <ci>𝜷</ci>
    </apply>
    <apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <apply>
        <eq></eq>
        <ci>i</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <ci>m</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>r</ci>
        <ci>i</ci>
       </apply>
       <cn type="integer">2</cn>
      </apply>
      <ci>𝜷</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   S(\boldsymbol{\beta})=\sum_{i=1}^{m}r_{i}^{2}(\boldsymbol{\beta}).
  </annotation>
 </semantics>
</math>

</p>

<p>After substituting for 

<math display="inline" id="Linear_least_squares_(mathematics):192">
 <semantics>
  <msub>
   <mi>r</mi>
   <mi>i</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>r</ci>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   r_{i}
  </annotation>
 </semantics>
</math>

 and then for 

<math display="inline" id="Linear_least_squares_(mathematics):193">
 <semantics>
  <mi>f</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>f</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f
  </annotation>
 </semantics>
</math>

, this minimization problem becomes the quadratic minimization problem above with</p>

<p>

<math display="block" id="Linear_least_squares_(mathematics):194">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>X</mi>
     <mrow>
      <mi>i</mi>
      <mi>j</mi>
     </mrow>
    </msub>
    <mo>=</mo>
    <mrow>
     <msub>
      <mi>ϕ</mi>
      <mi>j</mi>
     </msub>
     <mrow>
      <mo stretchy="false">(</mo>
      <msub>
       <mi>x</mi>
       <mi>i</mi>
      </msub>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>X</ci>
     <apply>
      <times></times>
      <ci>i</ci>
      <ci>j</ci>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>ϕ</ci>
      <ci>j</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <ci>i</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   X_{ij}=\phi_{j}(x_{i}),
  </annotation>
 </semantics>
</math>

</p>

<p>and the best fit can be found by solving the normal equations.</p>
<h2 id="further-discussion">Further discussion</h2>

<p>The <em>numerical methods for linear least squares</em> are important because <a href="linear_regression" title="wikilink">linear regression</a> models are among the most important types of model, both as formal <a href="statistical_model" title="wikilink">statistical models</a> and for exploration of data-sets. The majority of <a href="Comparison_of_statistical_packages" title="wikilink">statistical computer packages</a> contain facilities for regression analysis that make use of linear least squares computations. Hence it is appropriate that considerable effort has been devoted to the task of ensuring that these computations are undertaken efficiently and with due regard to <a href="round-off_error" title="wikilink">round-off error</a>.</p>

<p>Individual statistical analyses are seldom undertaken in isolation, but rather are part of a sequence of investigatory steps. Some of the topics involved in considering numerical methods for linear least squares relate to this point. Thus important topics can be</p>
<ul>
<li>Computations where a number of similar, and often <a href="Statistical_model#Nested_models" title="wikilink">nested</a>, models are considered for the same data-set. That is, where models with the same <a href="dependent_variable" title="wikilink">dependent variable</a> but different sets of <a href="independent_variables" title="wikilink">independent variables</a> are to be considered, for essentially the same set of data-points.</li>
<li>Computations for analyses that occur in a sequence, as the number of data-points increases.</li>
<li>Special considerations for very extensive data-sets.</li>
</ul>

<p>Fitting of linear models by least squares often, but not always, arise in the context of <a href="statistical_analysis" title="wikilink">statistical analysis</a>. It can therefore be important that considerations of computation efficiency for such problems extend to all of the auxiliary quantities required for such analyses, and are not restricted to the formal solution of the <a href="linear_least_squares_(mathematics)" title="wikilink">linear least squares</a> problem.</p>
<h3 id="rounding-errors">Rounding errors</h3>

<p>Matrix calculations, like any other, are affected by <a href="rounding_error" title="wikilink">rounding errors</a>. An early summary of these effects, regarding the choice of computation methods for matrix inversion, was provided by Wilkinson.<a class="footnoteRef" href="#fn14" id="fnref14"><sup>14</sup></a></p>
<h2 id="see-also">See also</h2>
<ul>
<li><a href="Line-line_intersection#Nearest_point_to_non-intersecting_lines" title="wikilink">Line-line intersection#Nearest point to non-intersecting lines</a>, an application</li>
</ul>
<h2 id="references">References</h2>
<h2 id="further-reading">Further reading</h2>
<ul>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
</ul>
<h2 id="external-links">External links</h2>
<ul>
<li><a href="http://mathworld.wolfram.com/LeastSquaresFitting.html">Least Squares Fitting – From MathWorld</a></li>
<li><a href="http://mathworld.wolfram.com/LeastSquaresFittingPolynomial.html">Least Squares Fitting-Polynomial – From MathWorld</a></li>
</ul>

<p><a class="uri" href="af:Kleinste-kwadratemetode" title="wikilink">af:Kleinste-kwadratemetode</a> <a href="cs:Metoda_nejmenších_čtverců" title="wikilink">cs:Metoda nejmenších čtverců</a> <a href="de:Methode_der_kleinsten_Quadrate" title="wikilink">de:Methode der kleinsten Quadrate</a> <a href="es:Mínimos_cuadrados" title="wikilink">es:Mínimos cuadrados</a> <a href="fr:Méthode_des_moindres_carrés" title="wikilink">fr:Méthode des moindres carrés</a> <a href="gl:Mínimos_cadrados" title="wikilink">gl:Mínimos cadrados</a> <a href="gl:Mínimos_cadrados_lineais" title="wikilink">gl:Mínimos cadrados lineais</a> <a href="it:Minimi_Quadrati" title="wikilink">it:Minimi Quadrati</a> <a href="he:שיטת_הריבועים_הפחותים" title="wikilink">he:שיטת הריבועים הפחותים</a> <a href="la:Methodus_quadratorum_minimorum" title="wikilink">la:Methodus quadratorum minimorum</a> <a href="hu:Legkisebb_négyzetek_módszere" title="wikilink">hu:Legkisebb négyzetek módszere</a> <a class="uri" href="nl:Kleinste-kwadratenmethode" title="wikilink">nl:Kleinste-kwadratenmethode</a> <a class="uri" href="ja:最小二乗法" title="wikilink">ja:最小二乗法</a> <a href="pl:Metoda_najmniejszych_kwadratów" title="wikilink">pl:Metoda najmniejszych kwadratów</a> <a href="pt:Método_dos_mínimos_quadrados" title="wikilink">pt:Método dos mínimos quadrados</a> <a href="ru:Метод_наименьших_квадратов" title="wikilink">ru:Метод наименьших квадратов</a> <a href="su:Kuadrat_leutik" title="wikilink">su:Kuadrat leutik</a> <a href="uk:Метод_найменших_квадратів" title="wikilink">uk:Метод найменших квадратів</a> <a href="fi:Pienimmän_neliösumman_menetelmä" title="wikilink">fi:Pienimmän neliösumman menetelmä</a> <a class="uri" href="sv:Minstakvadratmetoden" title="wikilink">sv:Minstakvadratmetoden</a> <a href="tr:En_küçük_kareler_yöntemi" title="wikilink">tr:En küçük kareler yöntemi</a> <a href="ur:لکیری_اقل_مربعات" title="wikilink">ur:لکیری اقل مربعات</a> <a href="vi:Bình_phương_tối_thiểu" title="wikilink">vi:Bình phương tối thiểu</a> <a href="vi:Bình_phương_tối_thiểu_tuyến_tính" title="wikilink">vi:Bình phương tối thiểu tuyến tính</a> <a class="uri" href="zh:最小二乘法" title="wikilink">zh:最小二乘法</a>"</p>

<p><a href="Category:Regression_analysis" title="wikilink">Category:Regression analysis</a> <a href="Category:Computational_statistics" title="wikilink">Category:Computational statistics</a> <a href="Category:Numerical_linear_algebra" title="wikilink">Category:Numerical linear algebra</a> <a href="Category:Least_squares" title="wikilink">Category:Least squares</a> <a href="Category:Articles_with_example_MATLAB/Octave_code" title="wikilink">Category:Articles with example MATLAB/Octave code</a> <a href="Category:Articles_with_example_Python_code" title="wikilink">Category:Articles with example Python code</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1"><a href="#fnref1">↩</a></li>
<li id="fn2"><a href="#fnref2">↩</a></li>
<li id="fn3"><a href="#fnref3">↩</a></li>
<li id="fn4"><a href="#fnref4">↩</a></li>
<li id="fn5">This implies that the observations are uncorrelated. If the observations are <a class="uri" href="correlated" title="wikilink">correlated</a>, the expression 

<math display="inline" id="Linear_least_squares_(mathematics):195">
 <semantics>
  <mrow>
   <mi>S</mi>
   <mo>=</mo>
   <mrow>
    <msub>
     <mo largeop="true" symmetric="true">∑</mo>
     <mi>k</mi>
    </msub>
    <mrow>
     <msub>
      <mo largeop="true" symmetric="true">∑</mo>
      <mi>j</mi>
     </msub>
     <mrow>
      <msub>
       <mi>r</mi>
       <mi>k</mi>
      </msub>
      <msub>
       <mi>W</mi>
       <mrow>
        <mi>k</mi>
        <mi>j</mi>
       </mrow>
      </msub>
      <mpadded width="+1.7pt">
       <msub>
        <mi>r</mi>
        <mi>j</mi>
       </msub>
      </mpadded>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>S</ci>
    <apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <sum></sum>
      <ci>k</ci>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <ci>j</ci>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>r</ci>
        <ci>k</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>W</ci>
        <apply>
         <times></times>
         <ci>k</ci>
         <ci>j</ci>
        </apply>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>r</ci>
        <ci>j</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \textstyle S=\sum_{k}\sum_{j}r_{k}W_{kj}r_{j}\,
  </annotation>
 </semantics>
</math>

 applies. In this case the weight matrix should ideally be equal to the inverse of the <a href="variance-covariance_matrix" title="wikilink">variance-covariance matrix</a> of the observations.<a href="#fnref5">↩</a></li>
<li id="fn6">, chapter 3<a href="#fnref6">↩</a></li>
<li id="fn7"><a href="#fnref7">↩</a></li>
<li id="fn8"><a href="#fnref8">↩</a></li>
<li id="fn9"><a href="#fnref9">↩</a></li>
<li id="fn10"><a href="#fnref10">↩</a></li>
<li id="fn11"><a href="#fnref11">↩</a></li>
<li id="fn12"><a href="#fnref12">↩</a></li>
<li id="fn13"></li>
<li id="fn14">Wilkinson, J.H. (1963) "Chapter 3: Matrix Computations", <em>Rounding Errors in Algebraic Processes</em>, London: Her Majesty's Stationery Office (National Physical Laboratory, Notes in Applied Science, No.32)<a href="#fnref14">↩</a></li>
</ol>
</section>
</body>


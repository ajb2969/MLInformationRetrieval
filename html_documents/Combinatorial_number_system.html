<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="1710">Combinatorial number system</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Combinatorial number system</h1>
<hr>In [[mathematics]], and in particular in [[combinatorics]], the '''combinatorial number system''' of degree ''k'' (for some positive integer ''k''), also referred to as '''com<style>
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
<style>
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
  </style>
</hr></body></html>
<body>

<p>binadics''', is a correspondence between <a href="natural_number" title="wikilink">natural numbers</a> (taken to include 0) <em>N</em> and <em>k</em>-<a href="combination" title="wikilink">combinations</a>, represented as <a href="strictly_decreasing" title="wikilink">strictly decreasing</a> sequences <em>c</em><sub><em>k</em></sub> &gt; ... &gt; <em>c</em><sub>2</sub> &gt; <em>c</em><sub>1</sub> ≥ 0. Since the latter are strings of numbers, one can view this as a kind of <a href="numeral_system" title="wikilink">numeral system</a> for representing <em>N</em>, although the main utility is representing a <em>k</em>-combination by <em>N</em> rather than the other way around. Distinct numbers correspond to distinct <em>k</em>-combinations, and produce them in <a href="lexicographic_order" title="wikilink">lexicographic order</a>; moreover the numbers less than 

<math display="inline" id="Combinatorial_number_system:0">
 <semantics>
  <mrow>
   <mo>(</mo>
   <mstyle scriptlevel="+1">
    <mtable columnspacing="0.4em" rowspacing="0.2ex">
     <mtr>
      <mtd>
       <mi>n</mi>
      </mtd>
     </mtr>
     <mtr>
      <mtd>
       <mi>k</mi>
      </mtd>
     </mtr>
    </mtable>
   </mstyle>
   <mo>)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">binomial</csymbol>
    <ci>n</ci>
    <ci>k</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   {\textstyle\left({{n}\atop{k}}\right)}
  </annotation>
 </semantics>
</math>

 correspond to all <em>k</em>-combinations of }. The correspondence does not depend on the size <em>n</em> of the set that the <em>k</em>-combinations are taken from, so it can be interpreted as a map from <strong>N</strong> to the <em>k</em>-combinations taken from <strong>N</strong>; in this view the correspondence is a <a href="bijective_map" title="wikilink">bijection</a>.</p>

<p>The number <em>N</em> corresponding to (<em>c</em><sub><em>k</em></sub>,...,<em>c</em><sub>2</sub>,<em>c</em><sub>1</sub>) is given by</p>

<p>

<math display="block" id="Combinatorial_number_system:1">
 <semantics>
  <mrow>
   <mrow>
    <mi>N</mi>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mo>(</mo>
      <mtable columnspacing="0.4em" rowspacing="0.2ex">
       <mtr>
        <mtd>
         <msub>
          <mi>c</mi>
          <mi>k</mi>
         </msub>
        </mtd>
       </mtr>
       <mtr>
        <mtd>
         <mi>k</mi>
        </mtd>
       </mtr>
      </mtable>
      <mo>)</mo>
     </mrow>
     <mo>+</mo>
     <mi mathvariant="normal">⋯</mi>
     <mo>+</mo>
     <mrow>
      <mo>(</mo>
      <mtable columnspacing="0.4em" rowspacing="0.2ex">
       <mtr>
        <mtd>
         <msub>
          <mi>c</mi>
          <mn>2</mn>
         </msub>
        </mtd>
       </mtr>
       <mtr>
        <mtd>
         <mn>2</mn>
        </mtd>
       </mtr>
      </mtable>
      <mo>)</mo>
     </mrow>
     <mo>+</mo>
     <mrow>
      <mo>(</mo>
      <mtable columnspacing="0.4em" rowspacing="0.2ex">
       <mtr>
        <mtd>
         <msub>
          <mi>c</mi>
          <mn>1</mn>
         </msub>
        </mtd>
       </mtr>
       <mtr>
        <mtd>
         <mn>1</mn>
        </mtd>
       </mtr>
      </mtable>
      <mo>)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>N</ci>
    <apply>
     <plus></plus>
     <apply>
      <csymbol cd="latexml">binomial</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>c</ci>
       <ci>k</ci>
      </apply>
      <ci>k</ci>
     </apply>
     <ci>normal-⋯</ci>
     <apply>
      <csymbol cd="latexml">binomial</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>c</ci>
       <cn type="integer">2</cn>
      </apply>
      <cn type="integer">2</cn>
     </apply>
     <apply>
      <csymbol cd="latexml">binomial</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>c</ci>
       <cn type="integer">1</cn>
      </apply>
      <cn type="integer">1</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   N={\left({{c_{k}}\atop{k}}\right)}+\cdots+{\left({{c_{2}}\atop{2}}\right)}+{%
\left({{c_{1}}\atop{1}}\right)}.
  </annotation>
 </semantics>
</math>

</p>

<p>The fact that a unique sequence so corresponds to any number <em>N</em> was observed by <a href="Derrick_Henry_Lehmer" title="wikilink">D.H. Lehmer</a>.<a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a> Indeed a <a href="greedy_algorithm" title="wikilink">greedy algorithm</a> finds the <em>k</em>-combination corresponding to <em>N</em>: take <em>c</em><sub><em>k</em></sub> maximal with 

<math display="inline" id="Combinatorial_number_system:2">
 <semantics>
  <mrow>
   <mrow>
    <mo>(</mo>
    <mstyle scriptlevel="+1">
     <mtable columnspacing="0.4em" rowspacing="0.2ex">
      <mtr>
       <mtd>
        <msub>
         <mi>c</mi>
         <mi>k</mi>
        </msub>
       </mtd>
      </mtr>
      <mtr>
       <mtd>
        <mi>k</mi>
       </mtd>
      </mtr>
     </mtable>
    </mstyle>
    <mo>)</mo>
   </mrow>
   <mo>≤</mo>
   <mi>N</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <leq></leq>
    <apply>
     <csymbol cd="latexml">binomial</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>c</ci>
      <ci>k</ci>
     </apply>
     <ci>k</ci>
    </apply>
    <ci>N</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   {\textstyle\left({{c_{k}}\atop{k}}\right)}\leq N
  </annotation>
 </semantics>
</math>

, then take <em>c</em><sub><em>k</em> − 1</sub> maximal with 

<math display="inline" id="Combinatorial_number_system:3">
 <semantics>
  <mrow>
   <mrow>
    <mo>(</mo>
    <mstyle scriptlevel="+1">
     <mtable columnspacing="0.4em" rowspacing="0.2ex">
      <mtr>
       <mtd>
        <msub>
         <mi>c</mi>
         <mrow>
          <mi>k</mi>
          <mo>-</mo>
          <mn>1</mn>
         </mrow>
        </msub>
       </mtd>
      </mtr>
      <mtr>
       <mtd>
        <mrow>
         <mi>k</mi>
         <mo>-</mo>
         <mn>1</mn>
        </mrow>
       </mtd>
      </mtr>
     </mtable>
    </mstyle>
    <mo>)</mo>
   </mrow>
   <mo>≤</mo>
   <mrow>
    <mi>N</mi>
    <mo>-</mo>
    <mrow>
     <mo>(</mo>
     <mstyle scriptlevel="+1">
      <mtable columnspacing="0.4em" rowspacing="0.2ex">
       <mtr>
        <mtd>
         <msub>
          <mi>c</mi>
          <mi>k</mi>
         </msub>
        </mtd>
       </mtr>
       <mtr>
        <mtd>
         <mi>k</mi>
        </mtd>
       </mtr>
      </mtable>
     </mstyle>
     <mo>)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <leq></leq>
    <apply>
     <csymbol cd="latexml">binomial</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>c</ci>
      <apply>
       <minus></minus>
       <ci>k</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <apply>
      <minus></minus>
      <ci>k</ci>
      <cn type="integer">1</cn>
     </apply>
    </apply>
    <apply>
     <minus></minus>
     <ci>N</ci>
     <apply>
      <csymbol cd="latexml">binomial</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>c</ci>
       <ci>k</ci>
      </apply>
      <ci>k</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   {\textstyle\left({{c_{k-1}}\atop{k-1}}\right)}\leq N-{\textstyle\left({{c_{k}}%
\atop{k}}\right)}
  </annotation>
 </semantics>
</math>

, and so forth. Finding the number <em>N</em>, using the formula above, from the <em>k</em>-combination (<em>c</em><sub><em>k</em></sub>,...,<em>c</em><sub>2</sub>,<em>c</em><sub>1</sub>) is also known as "ranking", and the opposite operation (given by the greedy algorithm) as "unranking"; these operations are known by those names in most <a href="Computer_algebra_system" title="wikilink">Computer algebra systems</a>, and in computational mathematics.<a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a><a class="footnoteRef" href="#fn3" id="fnref3"><sup>3</sup></a></p>

<p>The originally used term "combinatorial representation of integers" is shortened to "combinatorial number system" by <a href="Donald_Ervin_Knuth" title="wikilink">Knuth</a>,<a class="footnoteRef" href="#fn4" id="fnref4"><sup>4</sup></a> who also gives a much older reference;<a class="footnoteRef" href="#fn5" id="fnref5"><sup>5</sup></a> the term "combinadic" is introduced by James McCaffrey <a class="footnoteRef" href="#fn6" id="fnref6"><sup>6</sup></a> (without reference to previous terminology or work).</p>

<p>Unlike the <a href="factorial_number_system" title="wikilink">factorial number system</a>, the combinatorial number system of degree <em>k</em> is not a <a href="mixed_radix" title="wikilink">mixed radix</a> system: the part 

<math display="inline" id="Combinatorial_number_system:4">
 <semantics>
  <mrow>
   <mo>(</mo>
   <mstyle scriptlevel="+1">
    <mtable columnspacing="0.4em" rowspacing="0.2ex">
     <mtr>
      <mtd>
       <msub>
        <mi>c</mi>
        <mi>i</mi>
       </msub>
      </mtd>
     </mtr>
     <mtr>
      <mtd>
       <mi>i</mi>
      </mtd>
     </mtr>
    </mtable>
   </mstyle>
   <mo>)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">binomial</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>c</ci>
     <ci>i</ci>
    </apply>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   {\textstyle\left({{c_{i}}\atop{i}}\right)}
  </annotation>
 </semantics>
</math>

 of the number <em>N</em> represented by a "digit" <em>c</em><sub><em>i</em></sub> is not obtained from it by simply multiplying by a place value.</p>

<p>The main application of the combinatorial number system is that it allows rapid computation of the <em>k</em>-combination that is at a given position in the lexicographic ordering, without having to explicitly list the <em>k</em>-combinations preceding it; this allows for instance random generation of <em>k</em>-combinations of a given set. Enumeration of <em>k</em>-combinations has many applications, among which <a href="software_testing" title="wikilink">software testing</a>, <a href="sampling_(statistics)" title="wikilink">sampling</a>, <a href="quality_control" title="wikilink">quality control</a>, and the analysis of <a class="uri" href="lottery" title="wikilink">lottery</a> games.</p>
<h2 id="ordering-combinations">Ordering combinations</h2>

<p>A <em>k</em>-combination of a set <em>S</em> is a subset of <em>S</em> with <em>k</em> (distinct) elements. The main purpose of the combinatorial number system is to provide a representation, each by a single number, of all 

<math display="inline" id="Combinatorial_number_system:5">
 <semantics>
  <mrow>
   <mo>(</mo>
   <mstyle scriptlevel="+1">
    <mtable columnspacing="0.4em" rowspacing="0.2ex">
     <mtr>
      <mtd>
       <mi>n</mi>
      </mtd>
     </mtr>
     <mtr>
      <mtd>
       <mi>k</mi>
      </mtd>
     </mtr>
    </mtable>
   </mstyle>
   <mo>)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">binomial</csymbol>
    <ci>n</ci>
    <ci>k</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   {\textstyle\left({{n}\atop{k}}\right)}
  </annotation>
 </semantics>
</math>

 possible <em>k</em>-combinations of a set <em>S</em> of <em>n</em> elements. Choosing, for any <em>n</em>, } as such a set, it can be arranged that the representation of a given <em>k</em>-combination <em>C</em> is independent of the value of <em>n</em> (although <em>n</em> must of course be sufficiently large); in other words considering <em>C</em> as a subset of a larger set by increasing <em>n</em> will not change the number that represents <em>C</em>. Thus for the combinatorial number system one just considers <em>C</em> as a <em>k</em>-combination of the set <strong>N</strong> of all natural numbers, without explicitly mentioning <em>n</em>.</p>

<p>In order to ensure that the numbers representing the <em>k</em>-combinations of } are less than those representing <em>k</em>-combinations not contained in }, the <em>k</em>-combinations must be ordered in such a way that their largest elements are compared first. The most natural ordering that has this property is <a href="lexicographic_order" title="wikilink">lexicographic ordering</a> of the <em>decreasing</em> sequence of their elements. So comparing the 5-combinations <em>C</em> = {0,3,4,6,9} and <em>C</em>' = {0,1,3,7,9}, one has that <em>C</em> comes before <em>C</em>', since they have the same largest part 9, but the next largest part 6 of <em>C</em> is less than the next largest part 7 of <em>C</em>'; the sequences compared lexicographically are (9,6,4,3,0) and (9,7,3,1,0). Another way to describe this ordering is view combinations as describing the <em>k</em> raised bits in the binary representation of a number, so that <em>C</em> = {<em>c</em><sub>1</sub>,...,<em>c</em><sub><em>k</em></sub>} describes the number</p>

<p>

<math display="block" id="Combinatorial_number_system:6">
 <semantics>
  <mrow>
   <msup>
    <mn>2</mn>
    <msub>
     <mi>c</mi>
     <mn>1</mn>
    </msub>
   </msup>
   <mo>+</mo>
   <msup>
    <mn>2</mn>
    <msub>
     <mi>c</mi>
     <mn>2</mn>
    </msub>
   </msup>
   <mo>+</mo>
   <mi mathvariant="normal">⋯</mi>
   <mo>+</mo>
   <msup>
    <mn>2</mn>
    <msub>
     <mi>c</mi>
     <mi>k</mi>
    </msub>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <plus></plus>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <cn type="integer">2</cn>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>c</ci>
      <cn type="integer">1</cn>
     </apply>
    </apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <cn type="integer">2</cn>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>c</ci>
      <cn type="integer">2</cn>
     </apply>
    </apply>
    <ci>normal-⋯</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <cn type="integer">2</cn>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>c</ci>
      <ci>k</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   2^{c_{1}}+2^{c_{2}}+\cdots+2^{c_{k}}
  </annotation>
 </semantics>
</math>

 (this associates distinct numbers to <em>all</em> finite sets of natural numbers); then comparison of <em>k</em>-combinations can be done by comparing the associated binary numbers. In the example <em>C</em> and <em>C</em>' correspond to numbers 1001011001<sub>2</sub> = 601<sub>10</sub> and 1010001011<sub>2</sub> = 651<sub>10</sub>, which again shows that <em>C</em> comes before <em>C</em>'. This number is not however the one one wants to represent the <em>k</em>-combination with, since many binary numbers have a number of raised bits different from <em>k</em>; one wants to find the relative position of <em>C</em> in the ordered list of (only) <em>k</em>-combinations.</p>
<h2 id="place-of-a-combination-in-the-ordering">Place of a combination in the ordering</h2>

<p>The number associated in the combinatorial number system of degree <em>k</em> to a <em>k</em>-combination <em>C</em> is the number of <em>k</em>-combinations strictly less than <em>C</em> in the given ordering. This number can be computed from <em>C</em> = { <em>c</em><sub><em>k</em></sub>, ..., <em>c</em><sub>2</sub>, <em>c</em><sub>1</sub> } with <em>c</em><sub><em>k</em></sub> &gt; ... &gt; <em>c</em><sub>2</sub> &gt; <em>c</em><sub>1</sub> as follows. From the definition of the ordering it follows that for each <em>k</em>-combination <em>S</em> strictly less than <em>C</em>, there is a unique index <em>i</em> such that <em>c</em><sub><em>i</em></sub> is absent from <em>S</em>, while <em>c</em><sub><em>k</em></sub>, ..., <em>c</em><sub><em>i</em>+1</sub> are present in <em>S</em>, and no other value larger than <em>c</em><sub><em>i</em></sub> is. One can therefore group those <em>k</em>-combinations <em>S</em> according to the possible values 1, 2, ..., <em>k</em> of <em>i</em>, and count each group separately. For a given value of <em>i</em> one must include <em>c</em><sub><em>k</em></sub>, ..., <em>c</em><sub><em>i</em>+1</sub> in <em>S</em>, and the remaining <em>i</em> elements of <em>S</em> must be chosen from the <em>c</em><sub><em>i</em></sub> non-negative integers strictly less than <em>c</em><sub><em>i</em></sub>; moreover any such choice will result in a <em>k</em>-combinations <em>S</em> strictly less than <em>C</em>. The number of possible choices is 

<math display="inline" id="Combinatorial_number_system:7">
 <semantics>
  <mrow>
   <mo>(</mo>
   <mstyle scriptlevel="+1">
    <mtable columnspacing="0.4em" rowspacing="0.2ex">
     <mtr>
      <mtd>
       <msub>
        <mi>c</mi>
        <mi>i</mi>
       </msub>
      </mtd>
     </mtr>
     <mtr>
      <mtd>
       <mi>i</mi>
      </mtd>
     </mtr>
    </mtable>
   </mstyle>
   <mo>)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">binomial</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>c</ci>
     <ci>i</ci>
    </apply>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   {\textstyle\left({{c_{i}}\atop{i}}\right)}
  </annotation>
 </semantics>
</math>

, which is therefore the number of combinations in group <em>i</em>; the total number of <em>k</em>-combinations strictly less than <em>C</em> then is</p>

<p>

<math display="block" id="Combinatorial_number_system:8">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mo>(</mo>
     <mtable columnspacing="0.4em" rowspacing="0.2ex">
      <mtr>
       <mtd>
        <msub>
         <mi>c</mi>
         <mn>1</mn>
        </msub>
       </mtd>
      </mtr>
      <mtr>
       <mtd>
        <mn>1</mn>
       </mtd>
      </mtr>
     </mtable>
     <mo>)</mo>
    </mrow>
    <mo>+</mo>
    <mrow>
     <mo>(</mo>
     <mtable columnspacing="0.4em" rowspacing="0.2ex">
      <mtr>
       <mtd>
        <msub>
         <mi>c</mi>
         <mn>2</mn>
        </msub>
       </mtd>
      </mtr>
      <mtr>
       <mtd>
        <mn>2</mn>
       </mtd>
      </mtr>
     </mtable>
     <mo>)</mo>
    </mrow>
    <mo>+</mo>
    <mi mathvariant="normal">⋯</mi>
    <mo>+</mo>
    <mrow>
     <mo>(</mo>
     <mtable columnspacing="0.4em" rowspacing="0.2ex">
      <mtr>
       <mtd>
        <msub>
         <mi>c</mi>
         <mi>k</mi>
        </msub>
       </mtd>
      </mtr>
      <mtr>
       <mtd>
        <mi>k</mi>
       </mtd>
      </mtr>
     </mtable>
     <mo>)</mo>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <plus></plus>
    <apply>
     <csymbol cd="latexml">binomial</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>c</ci>
      <cn type="integer">1</cn>
     </apply>
     <cn type="integer">1</cn>
    </apply>
    <apply>
     <csymbol cd="latexml">binomial</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>c</ci>
      <cn type="integer">2</cn>
     </apply>
     <cn type="integer">2</cn>
    </apply>
    <ci>normal-⋯</ci>
    <apply>
     <csymbol cd="latexml">binomial</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>c</ci>
      <ci>k</ci>
     </apply>
     <ci>k</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   {\left({{c_{1}}\atop{1}}\right)}+{\left({{c_{2}}\atop{2}}\right)}+\cdots+{%
\left({{c_{k}}\atop{k}}\right)},
  </annotation>
 </semantics>
</math>

 and this is the index (starting from 0) of <em>C</em> in the ordered list of <em>k</em>-combinations. Obviously there is for every <em>N</em> ∈ <strong>N</strong> exactly one <em>k</em>-combination at index <em>N</em> in the list (supposing <em>k</em> ≥ 1, since the list is then infinite), so the above argument proves that every <em>N</em> can be written in exactly one way as a sum of <em>k</em> binomial coefficients of the given form.</p>
<h2 id="finding-the-k-combination-for-a-given-number">Finding the <em>k</em>-combination for a given number</h2>

<p>The given formula allows finding the place in the lexicographic ordering of a given <em>k</em>-combination immediately. The reverse process of finding the <em>k</em>-combination at a given place <em>N</em> requires somewhat more work, but is straightforward nonetheless. By the definition of the lexicographic ordering, two <em>k</em>-combinations that differ in their largest element <em>c</em><sub><em>k</em></sub> will be ordered according to the comparison of those largest elements, from which it follows that all combinations with a fixed value of their largest element are contiguous in the list. Moreover the smallest combination with <em>c</em><sub><em>k</em></sub> as largest element is 

<math display="inline" id="Combinatorial_number_system:9">
 <semantics>
  <mrow>
   <mo>(</mo>
   <mstyle scriptlevel="+1">
    <mtable columnspacing="0.4em" rowspacing="0.2ex">
     <mtr>
      <mtd>
       <msub>
        <mi>c</mi>
        <mi>k</mi>
       </msub>
      </mtd>
     </mtr>
     <mtr>
      <mtd>
       <mi>k</mi>
      </mtd>
     </mtr>
    </mtable>
   </mstyle>
   <mo>)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">binomial</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>c</ci>
     <ci>k</ci>
    </apply>
    <ci>k</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   {\textstyle\left({{c_{k}}\atop{k}}\right)}
  </annotation>
 </semantics>
</math>

, and it has <em>c</em><sub><em>i</em></sub> = <em>i</em> − 1 for all <em>i</em> \tbinom{c_k}k are zero). Therefore <em>c</em><sub><em>k</em></sub> is the largest number such that 

<math display="inline" id="Combinatorial_number_system:10">
 <semantics>
  <mrow>
   <mrow>
    <mo>(</mo>
    <mstyle scriptlevel="+1">
     <mtable columnspacing="0.4em" rowspacing="0.2ex">
      <mtr>
       <mtd>
        <msub>
         <mi>c</mi>
         <mi>k</mi>
        </msub>
       </mtd>
      </mtr>
      <mtr>
       <mtd>
        <mi>k</mi>
       </mtd>
      </mtr>
     </mtable>
    </mstyle>
    <mo>)</mo>
   </mrow>
   <mo>≤</mo>
   <mi>N</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <leq></leq>
    <apply>
     <csymbol cd="latexml">binomial</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>c</ci>
      <ci>k</ci>
     </apply>
     <ci>k</ci>
    </apply>
    <ci>N</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   {\textstyle\left({{c_{k}}\atop{k}}\right)}\leq N
  </annotation>
 </semantics>
</math>

. If <em>k</em> &gt; 1 the remaining elements of the <em>k</em>-combination form the -combination corresponding to the number 

<math display="inline" id="Combinatorial_number_system:11">
 <semantics>
  <mrow>
   <mi>N</mi>
   <mo>-</mo>
   <mrow>
    <mo>(</mo>
    <mstyle scriptlevel="+1">
     <mtable columnspacing="0.4em" rowspacing="0.2ex">
      <mtr>
       <mtd>
        <msub>
         <mi>c</mi>
         <mi>k</mi>
        </msub>
       </mtd>
      </mtr>
      <mtr>
       <mtd>
        <mi>k</mi>
       </mtd>
      </mtr>
     </mtable>
    </mstyle>
    <mo>)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <minus></minus>
    <ci>N</ci>
    <apply>
     <csymbol cd="latexml">binomial</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>c</ci>
      <ci>k</ci>
     </apply>
     <ci>k</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   N-{\textstyle\left({{c_{k}}\atop{k}}\right)}
  </annotation>
 </semantics>
</math>

 in the combinatorial number system of degree , and can therefore be found by continuing in the same way for 

<math display="inline" id="Combinatorial_number_system:12">
 <semantics>
  <mrow>
   <mi>N</mi>
   <mo>-</mo>
   <mrow>
    <mo>(</mo>
    <mstyle scriptlevel="+1">
     <mtable columnspacing="0.4em" rowspacing="0.2ex">
      <mtr>
       <mtd>
        <msub>
         <mi>c</mi>
         <mi>k</mi>
        </msub>
       </mtd>
      </mtr>
      <mtr>
       <mtd>
        <mi>k</mi>
       </mtd>
      </mtr>
     </mtable>
    </mstyle>
    <mo>)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <minus></minus>
    <ci>N</ci>
    <apply>
     <csymbol cd="latexml">binomial</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>c</ci>
      <ci>k</ci>
     </apply>
     <ci>k</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   N-{\textstyle\left({{c_{k}}\atop{k}}\right)}
  </annotation>
 </semantics>
</math>

 and  instead of <em>N</em> and <em>k</em>.</p>
<h3 id="example">Example</h3>

<p>Suppose one wants to determine the 5-combination at position 72. The successive values of 

<math display="inline" id="Combinatorial_number_system:13">
 <semantics>
  <mrow>
   <mo>(</mo>
   <mstyle scriptlevel="+1">
    <mtable columnspacing="0.4em" rowspacing="0.2ex">
     <mtr>
      <mtd>
       <mi>n</mi>
      </mtd>
     </mtr>
     <mtr>
      <mtd>
       <mn>5</mn>
      </mtd>
     </mtr>
    </mtable>
   </mstyle>
   <mo>)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">binomial</csymbol>
    <ci>n</ci>
    <cn type="integer">5</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   {\textstyle\left({{n}\atop{5}}\right)}
  </annotation>
 </semantics>
</math>

 for <em>n</em> = 4, 5, 6, ... are 0, 1, 6, 21, 56, 126, 252, ..., of which the largest one not exceeding 72 is 56, for <em>n</em> = 8. Therefore <em>c</em><sub>5</sub> = 8, and the remaining elements form the 4-combination at position . The successive values of 

<math display="inline" id="Combinatorial_number_system:14">
 <semantics>
  <mrow>
   <mo>(</mo>
   <mstyle scriptlevel="+1">
    <mtable columnspacing="0.4em" rowspacing="0.2ex">
     <mtr>
      <mtd>
       <mi>n</mi>
      </mtd>
     </mtr>
     <mtr>
      <mtd>
       <mn>4</mn>
      </mtd>
     </mtr>
    </mtable>
   </mstyle>
   <mo>)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">binomial</csymbol>
    <ci>n</ci>
    <cn type="integer">4</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   {\textstyle\left({{n}\atop{4}}\right)}
  </annotation>
 </semantics>
</math>

 for <em>n</em> = 3, 4, 5, ... are 0, 1, 5, 15, 35, ..., of which the largest one not exceeding 16 is 15, for <em>n</em> = 6, so <em>c</em><sub>4</sub> = 6. Continuing similarly to search for a 3-combination at position  one finds <em>c</em><sub>3</sub> = 3, which uses up the final unit; this establishes 

<math display="inline" id="Combinatorial_number_system:15">
 <semantics>
  <mrow>
   <mn>72</mn>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mo>(</mo>
     <mstyle scriptlevel="+1">
      <mtable columnspacing="0.4em" rowspacing="0.2ex">
       <mtr>
        <mtd>
         <mn>8</mn>
        </mtd>
       </mtr>
       <mtr>
        <mtd>
         <mn>5</mn>
        </mtd>
       </mtr>
      </mtable>
     </mstyle>
     <mo>)</mo>
    </mrow>
    <mo>+</mo>
    <mrow>
     <mo>(</mo>
     <mstyle scriptlevel="+1">
      <mtable columnspacing="0.4em" rowspacing="0.2ex">
       <mtr>
        <mtd>
         <mn>6</mn>
        </mtd>
       </mtr>
       <mtr>
        <mtd>
         <mn>4</mn>
        </mtd>
       </mtr>
      </mtable>
     </mstyle>
     <mo>)</mo>
    </mrow>
    <mo>+</mo>
    <mrow>
     <mo>(</mo>
     <mstyle scriptlevel="+1">
      <mtable columnspacing="0.4em" rowspacing="0.2ex">
       <mtr>
        <mtd>
         <mn>3</mn>
        </mtd>
       </mtr>
       <mtr>
        <mtd>
         <mn>3</mn>
        </mtd>
       </mtr>
      </mtable>
     </mstyle>
     <mo>)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <cn type="integer">72</cn>
    <apply>
     <plus></plus>
     <apply>
      <csymbol cd="latexml">binomial</csymbol>
      <cn type="integer">8</cn>
      <cn type="integer">5</cn>
     </apply>
     <apply>
      <csymbol cd="latexml">binomial</csymbol>
      <cn type="integer">6</cn>
      <cn type="integer">4</cn>
     </apply>
     <apply>
      <csymbol cd="latexml">binomial</csymbol>
      <cn type="integer">3</cn>
      <cn type="integer">3</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   72={\textstyle\left({{8}\atop{5}}\right)}+{\textstyle\left({{6}\atop{4}}\right%
)}+{\textstyle\left({{3}\atop{3}}\right)}
  </annotation>
 </semantics>
</math>

, and the remaining values <em>c</em><sub><em>i</em></sub> will be the maximal ones with 

<math display="inline" id="Combinatorial_number_system:16">
 <semantics>
  <mrow>
   <mrow>
    <mo>(</mo>
    <mstyle scriptlevel="+1">
     <mtable columnspacing="0.4em" rowspacing="0.2ex">
      <mtr>
       <mtd>
        <msub>
         <mi>c</mi>
         <mi>i</mi>
        </msub>
       </mtd>
      </mtr>
      <mtr>
       <mtd>
        <mi>i</mi>
       </mtd>
      </mtr>
     </mtable>
    </mstyle>
    <mo>)</mo>
   </mrow>
   <mo>=</mo>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="latexml">binomial</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>c</ci>
      <ci>i</ci>
     </apply>
     <ci>i</ci>
    </apply>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   {\textstyle\left({{c_{i}}\atop{i}}\right)}=0
  </annotation>
 </semantics>
</math>

, namely <mtpl> <em>i</em> − 1}}</mtpl>. Thus we have found the 5-combination }.</p>
<h3 id="national-lottery-example-in-excel">National Lottery Example in Excel</h3>

<p>For each lottery combination COMBIN(49,6) after sorting (C1<c2<c3<c4<c5<c6) #num!="" $="" (a2:a50)="" (b1:g1)="" (vertically="" 0="" 0.="" 1="" 10381232.="" 13983816.="" 14.="" 3,6,15,17,18,35="" 49="" 49-35="" 49-x="" 6="" 6.="" 9366819,962598,46376,4960,465,14.="" <source="" a="" actual="" adding="" alone.="" also="" always="" and="" are="" argument="" ascending="" ball="" be="" becomes="" between="" bit="" bottom).="" british="" by="" can="" case="" cell="" column="" column.="" combin="" combin($a2,b$1)="" combin(49,6)="" combin(49,6)-1="" combin(49-15,4),="" combin(49-17,3),="" combin(49-18,2),="" combin(49-3,6),="" combin(49-35,1)="" combin(49-6,5),="" combin(49-c1,6)+combin(49-c2,5)+combin(49-c3,4)+combin(49-c4,3)+combin(49-c5,2)+combin(49-c6,1).="" convert="" corner.="" could="" descending="" do="" does="" each="" engineering="" equal="" excel="" exists="" fill="" find="" for="" formula="" formulas="" found="" from="" function="" get="" growing="" have="" heading="" headings="" if="" in="" index="" instead="" into="" is="" isnumber="" it="" label="" labels="" lang="avisynth" left="" less="" let's="" like="" list="" lottery="" make="" match="" maximum="" means="" n="" national="" need="" not="" note="" now="" number="" number.="" numbers="" of="" one="" or="" order="" particular="" position="" possible="" provided="" put="" readability.="" references="" replace="" result="" resulting="" results="" results.="" return="" reverse="" row="" should="" show="" signs="" solver="" something="" starting="" statements="" subtraction="" suppose="" sure="" table="" taken="" than="" that="" the="" their="" them.="" then="" these="" this:="" to="" top="" trickier.="" under="" up="" use="" values="" values,="" want="" where="" which="" will="" with="" would="" you="" you'd="" zeros.=""></c2<c3<c4<c5<c6)></p>

<p><code>   6   5   4   3   2   1</code></p>

<p>1 0 0 0 0 0 1 2 0 0 0 0 1 2 3 0 0 0 1 3 3 4 0 0 1 4 6 4 5 0 1 5 10 10 5 6 1 6 15 20 15 6 7 7 21 35 35 21 7 8 28 56 70 56 28 8 9 84 126 126 84 36 9 10 210 252 210 120 45 10 11 462 462 330 165 55 11 12 924 792 495 220 66 12 ... 49 13983816 1906884 211876 18424 1176 49  Now if you create a new row of six cells and fill them with formulas which would find the largest values in each column which are less than or equal to position number in question: The first cell with =INDEX(B2:B50,MATCH(10381232,B2:B50)), the rest of the cells with</p>
<pre class="avisynth"><code>INDEX(C2:C50,MATCH(10381232-SUM(of previous cells),C2:C50))
...
INDEX(G2:G50,MATCH(10381232-SUM(of previous cells),G2:G50))</code></pre>

<p>This would present you with a row of values you have already seen 9366819,962598,46376,4960,465,14 Now in a next row first cell write =49-MATCH(10381232,B2:B50) and similarly</p>
<pre class="avisynth"><code>=49-MATCH(10381232-9366819,C2:C50)
...
=49-MATCH(10381232-9366819-962598-46376-4960-465,G2:G50)</code></pre>

<p>Again use the references to cells instead of actual values. You should be presented with original ball numbers of 3,6,15,17,18,35.</p>

<p>Now you can generate a fresh Lottery number combination from single =randbetween(1,combin(49,6)) or you could look at the list position numbers of earlier results to see if there is a trend.</p>
<h2 id="applications">Applications</h2>

<p>One could use the combinatorial number system to list or traverse all <em>k</em>-combinations of a given finite set, but this is a very inefficient way to do that. Indeed, given some <em>k</em>-combination it is much easier to find the next combination in lexicographic ordering directly than to convert a number to a <em>k</em>-combination by the method indicated above. To find the next combination, find the smallest <em>i</em> ≥ 2 for which <em>c</em><sub><em>i</em></sub> ≥ <em>c</em><sub><em>i−1</em></sub>+2 (if there is no such <em>i</em>, take <em>i</em> = <em>k</em>+1); then increase <em>c</em><sub><em>i</em>−1</sub> by one and set all <em>c</em><sub><em>j</em></sub> with  to their minimal value . If the <em>k</em>-combination is represented by its <a href="characteristic_vector" title="wikilink">characteristic vector</a>, that is as a binary value with <em>k</em> bits 1, then the next such value can be computed without any loop using bitwise arithmetic: the following function will advance <code>x</code> to that value or return <code>false</code>:</p>
<div class="sourceCode"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span class="co">// find next k-combination</span>
<span class="dt">bool</span> next_combination(<span class="dt">unsigned</span> <span class="dt">long</span>&amp; x) <span class="co">// assume x has form x'01^a10^b in binary</span>
{
  <span class="dt">unsigned</span> <span class="dt">long</span> u = x &amp; -x; <span class="co">// extract rightmost bit 1; u =  0'00^a10^b</span>
  <span class="dt">unsigned</span> <span class="dt">long</span> v = u + x; <span class="co">// set last non-trailing bit 0, and clear to the right; v=x'10^a00^b</span>
  <span class="kw">if</span> (v==<span class="dv">0</span>) <span class="co">// then overflow in v, or x==0</span>
    <span class="kw">return</span> <span class="kw">false</span>; <span class="co">// signal that next k-combination cannot be represented</span>
  x = v +(((v^x)/u)&gt;&gt;<span class="dv">2</span>); <span class="co">// v^x = 0'11^a10^b, (v^x)/u = 0'0^b1^{a+2}, and x ← x'100^b1^a</span>
  <span class="kw">return</span> <span class="kw">true</span>; <span class="co">// successful completion</span>
}</code></pre></div>

<p>This is called <a href="Bill_Gosper" title="wikilink">Gosper</a>'s hack;<a class="footnoteRef" href="#fn7" id="fnref7"><sup>7</sup></a> corresponding <a href="assembly_code" title="wikilink">assembly code</a> was described as item 175 in <a class="uri" href="HAKMEM" title="wikilink">HAKMEM</a>.</p>

<p>On the other hand the possibility to directly generate the <em>k</em>-combination at index <em>N</em> has useful applications. Notably, it allows generating a random <em>k</em>-combination of an <em>n</em>-element set using a random integer <em>N</em> with 

<math display="inline" id="Combinatorial_number_system:17">
 <semantics>
  <mrow>
   <mn>0</mn>
   <mo>≤</mo>
   <mi>N</mi>
   <mo><</mo>
   <mrow>
    <mo>(</mo>
    <mstyle scriptlevel="+1">
     <mtable columnspacing="0.4em" rowspacing="0.2ex">
      <mtr>
       <mtd>
        <mi>n</mi>
       </mtd>
      </mtr>
      <mtr>
       <mtd>
        <mi>k</mi>
       </mtd>
      </mtr>
     </mtable>
    </mstyle>
    <mo>)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <leq></leq>
     <cn type="integer">0</cn>
     <ci>N</ci>
    </apply>
    <apply>
     <lt></lt>
     <share href="#.cmml">
     </share>
     <apply>
      <csymbol cd="latexml">binomial</csymbol>
      <ci>n</ci>
      <ci>k</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   0\leq N<{\textstyle\left({{n}\atop{k}}\right)}
  </annotation>
 </semantics>
</math>

, simply by converting that number to the corresponding <em>k</em>-combination. If a computer program needs to maintain a table with information about every <em>k</em>-combination of a given finite set, the computation of the index <em>N</em> associated with a combination will allow the table to be accessed without searching.</p>
<h2 id="see-also">See also</h2>
<ul>
<li><a href="Factorial_number_system" title="wikilink">Factorial number system</a> (also called factoradics)</li>
<li><a href="Mixed_Radix#Primorial_number_system" title="wikilink">Primorial number system</a></li>
</ul>
<h2 id="references">References</h2>
<references>
</references>

<p>"</p>

<p><a class="uri" href="Category:Combinatorics" title="wikilink">Category:Combinatorics</a> <a href="Category:Factorial_and_binomial_topics" title="wikilink">Category:Factorial and binomial topics</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1"><em>Applied Combinatorial Mathematics</em>, Ed. E. F. Beckenbach (1964), pp.27−30.<a href="#fnref1">↩</a></li>
<li id="fn2"><a class="uri" href="http://www.site.uottawa.ca/~lucia/courses/5165-09/GenCombObj.pdf">http://www.site.uottawa.ca/~lucia/courses/5165-09/GenCombObj.pdf</a><a href="#fnref2">↩</a></li>
<li id="fn3"><a class="uri" href="http://www.sagemath.org/doc/reference/sage/combinat/subset.html">http://www.sagemath.org/doc/reference/sage/combinat/subset.html</a><a href="#fnref3">↩</a></li>
<li id="fn4">.<a href="#fnref4">↩</a></li>
<li id="fn5"><a href="#fnref5">↩</a></li>
<li id="fn6"><a href="#fnref6">↩</a></li>
<li id="fn7"><a href="#fnref7">↩</a></li>
</ol>
</section>
</body>


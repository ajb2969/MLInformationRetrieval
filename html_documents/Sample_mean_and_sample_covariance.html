<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="845">Sample mean and sample covariance</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Sample mean and sample covariance</h1>
<hr/>

<p>The <strong>sample mean</strong> or <strong>empirical mean</strong> and the <strong>sample covariance</strong> are <a href="statistic" title="wikilink">statistics</a> computed from a collection of data on one or more <a href="random_variables" title="wikilink">random variables</a>. The sample mean is a <a href="vector_(mathematics)" title="wikilink">vector</a> each of whose elements is the sample mean of one of the random variablesthat is, each of whose elements is the <a href="arithmetic_average" title="wikilink">arithmetic average</a> of the observed values of one of the variables. The sample covariance matrix is a square <a href="Matrix_(mathematics)" title="wikilink">matrix</a> whose <em>i, j</em> element is the sample covariance (an estimate of the population covariance) between the sets of observed values of two of the variables and whose <em>i, i</em> element is the sample variance of the observed values of one of the variables. If only one variable has had values observed, then the sample mean is a single number (the arithmetic average of the observed values of that variable) and the sample covariance matrix is also simply a single value (the sample variance of the observed values of that variable).</p>
<h2 id="sample-mean">Sample mean</h2>

<p>Let 

<math display="inline" id="Sample_mean_and_sample_covariance:0">
 <semantics>
  <msub>
   <mi>x</mi>
   <mrow>
    <mi>i</mi>
    <mi>j</mi>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>x</ci>
    <apply>
     <times></times>
     <ci>i</ci>
     <ci>j</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x_{ij}
  </annotation>
 </semantics>
</math>

 be the <em>i</em><sup>th</sup> independently drawn observation (<em>i=1,...,N</em>) on the <em>j</em><sup>th</sup> random variable (<em>j=1,...,K</em>). These observations can be arranged into <em>N</em> column vectors, each with <em>K</em> entries, with the <em>K</em> ×1 column vector giving the <em>i</em><sup>th</sup> observations of all variables being denoted 

<math display="inline" id="Sample_mean_and_sample_covariance:1">
 <semantics>
  <msub>
   <mi>𝐱</mi>
   <mi>i</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>𝐱</ci>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{x}_{i}
  </annotation>
 </semantics>
</math>

 (<em>i=1,...,N</em>).</p>

<p>The <strong>sample mean vector</strong> 

<math display="inline" id="Sample_mean_and_sample_covariance:2">
 <semantics>
  <mover accent="true">
   <mi>𝐱</mi>
   <mo stretchy="false">¯</mo>
  </mover>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-¯</ci>
    <ci>𝐱</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{\bar{x}}
  </annotation>
 </semantics>
</math>

 is a column vector whose <em>j</em><sup>th</sup> element 

<math display="inline" id="Sample_mean_and_sample_covariance:3">
 <semantics>
  <msub>
   <mover accent="true">
    <mi>x</mi>
    <mo stretchy="false">¯</mo>
   </mover>
   <mi>j</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <apply>
     <ci>normal-¯</ci>
     <ci>x</ci>
    </apply>
    <ci>j</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \bar{x}_{j}
  </annotation>
 </semantics>
</math>


 is the average value of the <em>N</em> observations of the <em>j</em><sup>th</sup> variable:</p>

<p>

<math display="block" id="Sample_mean_and_sample_covariance:4">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <msub>
      <mover accent="true">
       <mi>x</mi>
       <mo stretchy="false">¯</mo>
      </mover>
      <mi>j</mi>
     </msub>
     <mo>=</mo>
     <mrow>
      <mfrac>
       <mn>1</mn>
       <mi>N</mi>
      </mfrac>
      <mrow>
       <munderover>
        <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
        <mrow>
         <mi>i</mi>
         <mo>=</mo>
         <mn>1</mn>
        </mrow>
        <mi>N</mi>
       </munderover>
       <msub>
        <mi>x</mi>
        <mrow>
         <mi>i</mi>
         <mi>j</mi>
        </mrow>
       </msub>
      </mrow>
     </mrow>
    </mrow>
    <mo rspace="12.5pt">,</mo>
    <mrow>
     <mi>j</mi>
     <mo>=</mo>
     <mrow>
      <mn>1</mn>
      <mo>,</mo>
      <mi mathvariant="normal">…</mi>
      <mo>,</mo>
      <mi>K</mi>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <ci>normal-¯</ci>
       <ci>x</ci>
      </apply>
      <ci>j</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <ci>N</ci>
      </apply>
      <apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <sum></sum>
         <apply>
          <eq></eq>
          <ci>i</ci>
          <cn type="integer">1</cn>
         </apply>
        </apply>
        <ci>N</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <apply>
         <times></times>
         <ci>i</ci>
         <ci>j</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <ci>j</ci>
     <list>
      <cn type="integer">1</cn>
      <ci>normal-…</ci>
      <ci>K</ci>
     </list>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \bar{x}_{j}=\frac{1}{N}\sum_{i=1}^{N}x_{ij},\quad j=1,\ldots,K.
  </annotation>
 </semantics>
</math>

</p>

<p>Thus, the sample mean vector contains the average of the observations for each variable, and is written</p>

<p>

<math display="block" id="Sample_mean_and_sample_covariance:5">
 <semantics>
  <mrow>
   <mrow>
    <mover accent="true">
     <mi>𝐱</mi>
     <mo stretchy="false">¯</mo>
    </mover>
    <mo>=</mo>
    <mrow>
     <mfrac>
      <mn>1</mn>
      <mi>N</mi>
     </mfrac>
     <mrow>
      <munderover>
       <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
       <mrow>
        <mi>i</mi>
        <mo>=</mo>
        <mn>1</mn>
       </mrow>
       <mi>N</mi>
      </munderover>
      <msub>
       <mi>𝐱</mi>
       <mi>i</mi>
      </msub>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <ci>normal-¯</ci>
     <ci>𝐱</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <divide></divide>
      <cn type="integer">1</cn>
      <ci>N</ci>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <apply>
         <eq></eq>
         <ci>i</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <ci>N</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>𝐱</ci>
       <ci>i</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{\bar{x}}=\frac{1}{N}\sum_{i=1}^{N}\mathbf{x}_{i}.
  </annotation>
 </semantics>
</math>

</p>
<h2 id="sample-covariance">Sample covariance</h2>

<p>The <strong>sample covariance matrix</strong> is a <em>K</em>-by-<em>K</em> <a href="Matrix_(mathematics)" title="wikilink">matrix</a> 

<math display="inline" id="Sample_mean_and_sample_covariance:6">
 <semantics>
  <mrow>
   <mi>𝐐</mi>
   <mo>=</mo>
   <mrow>
    <mo>[</mo>
    <msub>
     <mi>q</mi>
     <mrow>
      <mi>j</mi>
      <mi>k</mi>
     </mrow>
    </msub>
    <mo>]</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>𝐐</ci>
    <apply>
     <csymbol cd="latexml">delimited-[]</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>q</ci>
      <apply>
       <times></times>
       <ci>j</ci>
       <ci>k</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \textstyle\mathbf{Q}=\left[q_{jk}\right]
  </annotation>
 </semantics>
</math>

 with entries</p>

<p>

<math display="block" id="Sample_mean_and_sample_covariance:7">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>q</mi>
     <mrow>
      <mi>j</mi>
      <mi>k</mi>
     </mrow>
    </msub>
    <mo>=</mo>
    <mrow>
     <mfrac>
      <mn>1</mn>
      <mrow>
       <mi>N</mi>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
     </mfrac>
     <mrow>
      <munderover>
       <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
       <mrow>
        <mi>i</mi>
        <mo>=</mo>
        <mn>1</mn>
       </mrow>
       <mi>N</mi>
      </munderover>
      <mrow>
       <mrow>
        <mo>(</mo>
        <mrow>
         <msub>
          <mi>x</mi>
          <mrow>
           <mi>i</mi>
           <mi>j</mi>
          </mrow>
         </msub>
         <mo>-</mo>
         <msub>
          <mover accent="true">
           <mi>x</mi>
           <mo stretchy="false">¯</mo>
          </mover>
          <mi>j</mi>
         </msub>
        </mrow>
        <mo>)</mo>
       </mrow>
       <mrow>
        <mo>(</mo>
        <mrow>
         <msub>
          <mi>x</mi>
          <mrow>
           <mi>i</mi>
           <mi>k</mi>
          </mrow>
         </msub>
         <mo>-</mo>
         <msub>
          <mover accent="true">
           <mi>x</mi>
           <mo stretchy="false">¯</mo>
          </mover>
          <mi>k</mi>
         </msub>
        </mrow>
        <mo>)</mo>
       </mrow>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>q</ci>
     <apply>
      <times></times>
      <ci>j</ci>
      <ci>k</ci>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <divide></divide>
      <cn type="integer">1</cn>
      <apply>
       <minus></minus>
       <ci>N</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <apply>
         <eq></eq>
         <ci>i</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <ci>N</ci>
      </apply>
      <apply>
       <times></times>
       <apply>
        <minus></minus>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>x</ci>
         <apply>
          <times></times>
          <ci>i</ci>
          <ci>j</ci>
         </apply>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <apply>
          <ci>normal-¯</ci>
          <ci>x</ci>
         </apply>
         <ci>j</ci>
        </apply>
       </apply>
       <apply>
        <minus></minus>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>x</ci>
         <apply>
          <times></times>
          <ci>i</ci>
          <ci>k</ci>
         </apply>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <apply>
          <ci>normal-¯</ci>
          <ci>x</ci>
         </apply>
         <ci>k</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   q_{jk}=\frac{1}{N-1}\sum_{i=1}^{N}\left(x_{ij}-\bar{x}_{j}\right)\left(x_{ik}-%
\bar{x}_{k}\right),
  </annotation>
 </semantics>
</math>

</p>

<p>where 

<math display="inline" id="Sample_mean_and_sample_covariance:8">
 <semantics>
  <msub>
   <mi>q</mi>
   <mrow>
    <mi>j</mi>
    <mi>k</mi>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>q</ci>
    <apply>
     <times></times>
     <ci>j</ci>
     <ci>k</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   q_{jk}
  </annotation>
 </semantics>
</math>


 is an estimate of the <a class="uri" href="covariance" title="wikilink">covariance</a> between the 

<math display="inline" id="Sample_mean_and_sample_covariance:9">
 <semantics>
  <mi>j</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>j</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   j
  </annotation>
 </semantics>
</math>

<sup>th</sup> variable and the 

<math display="inline" id="Sample_mean_and_sample_covariance:10">
 <semantics>
  <mi>k</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>k</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   k
  </annotation>
 </semantics>
</math>

<sup>th</sup> variable of the population underlying the data. In terms of the observation vectors, the sample covariance is</p>

<p>

<math display="block" id="Sample_mean_and_sample_covariance:11">
 <semantics>
  <mrow>
   <mrow>
    <mi>𝐐</mi>
    <mo>=</mo>
    <mrow>
     <mfrac>
      <mn>1</mn>
      <mrow>
       <mi>N</mi>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
     </mfrac>
     <mrow>
      <munderover>
       <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
       <mrow>
        <mi>i</mi>
        <mo>=</mo>
        <mn>1</mn>
       </mrow>
       <mi>N</mi>
      </munderover>
      <mrow>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <msub>
          <mi>𝐱</mi>
          <mi>i</mi>
         </msub>
         <mo>-</mo>
         <mover accent="true">
          <mi>𝐱</mi>
          <mo stretchy="false">¯</mo>
         </mover>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
       <msup>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <msub>
           <mi>𝐱</mi>
           <mi>i</mi>
          </msub>
          <mo>-</mo>
          <mover accent="true">
           <mi>𝐱</mi>
           <mo stretchy="false">¯</mo>
          </mover>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
        <mi mathvariant="normal">T</mi>
       </msup>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>𝐐</ci>
    <apply>
     <times></times>
     <apply>
      <divide></divide>
      <cn type="integer">1</cn>
      <apply>
       <minus></minus>
       <ci>N</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <apply>
         <eq></eq>
         <ci>i</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <ci>N</ci>
      </apply>
      <apply>
       <times></times>
       <apply>
        <minus></minus>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>𝐱</ci>
         <ci>i</ci>
        </apply>
        <apply>
         <ci>normal-¯</ci>
         <ci>𝐱</ci>
        </apply>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <minus></minus>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>𝐱</ci>
          <ci>i</ci>
         </apply>
         <apply>
          <ci>normal-¯</ci>
          <ci>𝐱</ci>
         </apply>
        </apply>
        <ci>normal-T</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{Q}={1\over{N-1}}\sum_{i=1}^{N}(\mathbf{x}_{i}-\mathbf{\bar{x}})(%
\mathbf{x}_{i}-\mathbf{\bar{x}})^{\mathrm{T}},
  </annotation>
 </semantics>
</math>

</p>

<p>Alternatively, arranging the observation vectors as the columns of a matrix, so that</p>

<p>

<math display="block" id="Sample_mean_and_sample_covariance:12">
 <semantics>
  <mrow>
   <mi>𝐅</mi>
   <mo>=</mo>
   <mrow>
    <mo>[</mo>
    <mtable displaystyle="true">
     <mtr>
      <mtd columnalign="center">
       <msub>
        <mi>𝐱</mi>
        <mn>1</mn>
       </msub>
      </mtd>
      <mtd columnalign="center">
       <msub>
        <mi>𝐱</mi>
        <mn>2</mn>
       </msub>
      </mtd>
      <mtd columnalign="center">
       <mi mathvariant="normal">…</mi>
      </mtd>
      <mtd columnalign="center">
       <msub>
        <mi>𝐱</mi>
        <mi>N</mi>
       </msub>
      </mtd>
     </mtr>
    </mtable>
    <mo>]</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>𝐅</ci>
    <matrix>
     <matrixrow>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>𝐱</ci>
       <cn type="integer">1</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>𝐱</ci>
       <cn type="integer">2</cn>
      </apply>
      <ci>normal-…</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>𝐱</ci>
       <ci>N</ci>
      </apply>
     </matrixrow>
    </matrix>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{F}=\begin{bmatrix}\mathbf{x}_{1}&\mathbf{x}_{2}&\dots&\mathbf{x}_{N}%
\end{bmatrix}
  </annotation>
 </semantics>
</math>

, which is a matrix of <em>K</em> rows and <em>N</em> columns. Here, the sample covariance matrix can be computed as</p>

<p>

<math display="block" id="Sample_mean_and_sample_covariance:13">
 <semantics>
  <mrow>
   <mi>𝐐</mi>
   <mo>=</mo>
   <mrow>
    <mfrac>
     <mn>1</mn>
     <mrow>
      <mi>N</mi>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </mfrac>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>𝐅</mi>
      <mo>-</mo>
      <mrow>
       <mover accent="true">
        <mi>𝐱</mi>
        <mo stretchy="false">¯</mo>
       </mover>
       <msubsup>
        <mn mathvariant="bold">1</mn>
        <mi>N</mi>
        <mi mathvariant="normal">T</mi>
       </msubsup>
      </mrow>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
    <msup>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mi>𝐅</mi>
       <mo>-</mo>
       <mrow>
        <mover accent="true">
         <mi>𝐱</mi>
         <mo stretchy="false">¯</mo>
        </mover>
        <msubsup>
         <mn mathvariant="bold">1</mn>
         <mi>N</mi>
         <mi mathvariant="normal">T</mi>
        </msubsup>
       </mrow>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <mi mathvariant="normal">T</mi>
    </msup>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>𝐐</ci>
    <apply>
     <times></times>
     <apply>
      <divide></divide>
      <cn type="integer">1</cn>
      <apply>
       <minus></minus>
       <ci>N</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <apply>
      <minus></minus>
      <ci>𝐅</ci>
      <apply>
       <times></times>
       <apply>
        <ci>normal-¯</ci>
        <ci>𝐱</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <cn type="float">1</cn>
         <ci>N</ci>
        </apply>
        <ci>normal-T</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <minus></minus>
       <ci>𝐅</ci>
       <apply>
        <times></times>
        <apply>
         <ci>normal-¯</ci>
         <ci>𝐱</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <cn type="float">1</cn>
          <ci>N</ci>
         </apply>
         <ci>normal-T</ci>
        </apply>
       </apply>
      </apply>
      <ci>normal-T</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{Q}=\frac{1}{N-1}(\mathbf{F}-\mathbf{\bar{x}}\,\mathbf{1}_{N}^{\mathrm{%
T}})(\mathbf{F}-\mathbf{\bar{x}}\,\mathbf{1}_{N}^{\mathrm{T}})^{\mathrm{T}}
  </annotation>
 </semantics>
</math>

, where 

<math display="inline" id="Sample_mean_and_sample_covariance:14">
 <semantics>
  <msub>
   <mn>𝟏</mn>
   <mi>N</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <cn type="integer">1</cn>
    <ci>N</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{1}_{N}
  </annotation>
 </semantics>
</math>

 is an <em>N</em> by 

<math display="inline" id="Sample_mean_and_sample_covariance:15">
 <semantics>
  <mn>1</mn>
  <annotation-xml encoding="MathML-Content">
   <cn type="integer">1</cn>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   1
  </annotation>
 </semantics>
</math>

 vector of ones. If the observations are arranged as rows instead of columns, so 

<math display="inline" id="Sample_mean_and_sample_covariance:16">
 <semantics>
  <mover accent="true">
   <mi>𝐱</mi>
   <mo stretchy="false">¯</mo>
  </mover>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-¯</ci>
    <ci>𝐱</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{\bar{x}}
  </annotation>
 </semantics>
</math>

 is now a 1×<em>K</em> row vector and 

<math display="inline" id="Sample_mean_and_sample_covariance:17">
 <semantics>
  <mrow>
   <mi>𝐌</mi>
   <mo>=</mo>
   <msup>
    <mi>𝐅</mi>
    <mi mathvariant="normal">T</mi>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>𝐌</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>𝐅</ci>
     <ci>normal-T</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{M}=\mathbf{F}^{\mathrm{T}}
  </annotation>
 </semantics>
</math>

 is an <em>N</em>×<em>K</em> matrix whose column <em>j</em> is the vector of <em>N</em> observations on variable <em>j</em>, then applying transposes in the appropriate places yields</p>

<p>

<math display="block" id="Sample_mean_and_sample_covariance:18">
 <semantics>
  <mrow>
   <mrow>
    <mi>𝐐</mi>
    <mo>=</mo>
    <mrow>
     <mfrac>
      <mn>1</mn>
      <mrow>
       <mi>N</mi>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
     </mfrac>
     <msup>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mi>𝐌</mi>
        <mo>-</mo>
        <mrow>
         <msub>
          <mn>𝟏</mn>
          <mi>N</mi>
         </msub>
         <mover accent="true">
          <mi>𝐱</mi>
          <mo stretchy="false">¯</mo>
         </mover>
        </mrow>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
      <mi mathvariant="normal">T</mi>
     </msup>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mi>𝐌</mi>
       <mo>-</mo>
       <mrow>
        <msub>
         <mn>𝟏</mn>
         <mi>N</mi>
        </msub>
        <mover accent="true">
         <mi>𝐱</mi>
         <mo stretchy="false">¯</mo>
        </mover>
       </mrow>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>𝐐</ci>
    <apply>
     <times></times>
     <apply>
      <divide></divide>
      <cn type="integer">1</cn>
      <apply>
       <minus></minus>
       <ci>N</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <minus></minus>
       <ci>𝐌</ci>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <cn type="integer">1</cn>
         <ci>N</ci>
        </apply>
        <apply>
         <ci>normal-¯</ci>
         <ci>𝐱</ci>
        </apply>
       </apply>
      </apply>
      <ci>normal-T</ci>
     </apply>
     <apply>
      <minus></minus>
      <ci>𝐌</ci>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <cn type="integer">1</cn>
        <ci>N</ci>
       </apply>
       <apply>
        <ci>normal-¯</ci>
        <ci>𝐱</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{Q}=\frac{1}{N-1}(\mathbf{M}-\mathbf{1}_{N}\mathbf{\bar{x}})^{\mathrm{T%
}}(\mathbf{M}-\mathbf{1}_{N}\mathbf{\bar{x}}).
  </annotation>
 </semantics>
</math>

</p>
<h2 id="discussion">Discussion</h2>

<p>The sample mean and the sample covariance matrix are <a href="Bias_of_an_estimator" title="wikilink">unbiased estimates</a> of the <a class="uri" href="mean" title="wikilink">mean</a> and the <a href="covariance_matrix" title="wikilink">covariance matrix</a> of the <a href="random_vector" title="wikilink">random vector</a> 

<math display="inline" id="Sample_mean_and_sample_covariance:19">
 <semantics>
  <mi>𝐗</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>𝐗</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \textstyle\mathbf{X}
  </annotation>
 </semantics>
</math>

, a row vector whose <em>j</em><sup>th</sup> element (<em>j = 1, ..., K</em>) is one of the random variables.<a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a> The sample covariance matrix has 

<math display="inline" id="Sample_mean_and_sample_covariance:20">
 <semantics>
  <mrow>
   <mi>N</mi>
   <mo>-</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <minus></minus>
    <ci>N</ci>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \textstyle N-1
  </annotation>
 </semantics>
</math>

 in the denominator rather than 

<math display="inline" id="Sample_mean_and_sample_covariance:21">
 <semantics>
  <mi>N</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>N</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \textstyle N
  </annotation>
 </semantics>
</math>

 due to a variant of <a href="Bessel's_correction" title="wikilink">Bessel's correction</a>: In short, the sample covariance relies on the difference between each observation and the sample mean, but the sample mean is slightly correlated with each observation since it is defined in terms of all observations. If the population mean 

<math display="inline" id="Sample_mean_and_sample_covariance:22">
 <semantics>
  <mrow>
   <mo>E</mo>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>𝐗</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-E</ci>
    <ci>𝐗</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \operatorname{E}(\mathbf{X})
  </annotation>
 </semantics>
</math>

 is known, the analogous unbiased estimate</p>

<p>

<math display="block" id="Sample_mean_and_sample_covariance:23">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>q</mi>
     <mrow>
      <mi>j</mi>
      <mi>k</mi>
     </mrow>
    </msub>
    <mo>=</mo>
    <mrow>
     <mfrac>
      <mn>1</mn>
      <mi>N</mi>
     </mfrac>
     <mrow>
      <munderover>
       <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
       <mrow>
        <mi>i</mi>
        <mo>=</mo>
        <mn>1</mn>
       </mrow>
       <mi>N</mi>
      </munderover>
      <mrow>
       <mrow>
        <mo>(</mo>
        <mrow>
         <msub>
          <mi>x</mi>
          <mrow>
           <mi>i</mi>
           <mi>j</mi>
          </mrow>
         </msub>
         <mo>-</mo>
         <mrow>
          <mo>E</mo>
          <mrow>
           <mo stretchy="false">(</mo>
           <msub>
            <mi>X</mi>
            <mi>j</mi>
           </msub>
           <mo stretchy="false">)</mo>
          </mrow>
         </mrow>
        </mrow>
        <mo>)</mo>
       </mrow>
       <mrow>
        <mo>(</mo>
        <mrow>
         <msub>
          <mi>x</mi>
          <mrow>
           <mi>i</mi>
           <mi>k</mi>
          </mrow>
         </msub>
         <mo>-</mo>
         <mrow>
          <mo>E</mo>
          <mrow>
           <mo stretchy="false">(</mo>
           <msub>
            <mi>X</mi>
            <mi>k</mi>
           </msub>
           <mo stretchy="false">)</mo>
          </mrow>
         </mrow>
        </mrow>
        <mo>)</mo>
       </mrow>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>q</ci>
     <apply>
      <times></times>
      <ci>j</ci>
      <ci>k</ci>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <divide></divide>
      <cn type="integer">1</cn>
      <ci>N</ci>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <apply>
         <eq></eq>
         <ci>i</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <ci>N</ci>
      </apply>
      <apply>
       <times></times>
       <apply>
        <minus></minus>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>x</ci>
         <apply>
          <times></times>
          <ci>i</ci>
          <ci>j</ci>
         </apply>
        </apply>
        <apply>
         <ci>normal-E</ci>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>X</ci>
          <ci>j</ci>
         </apply>
        </apply>
       </apply>
       <apply>
        <minus></minus>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>x</ci>
         <apply>
          <times></times>
          <ci>i</ci>
          <ci>k</ci>
         </apply>
        </apply>
        <apply>
         <ci>normal-E</ci>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>X</ci>
          <ci>k</ci>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   q_{jk}=\frac{1}{N}\sum_{i=1}^{N}\left(x_{ij}-\operatorname{E}(X_{j})\right)%
\left(x_{ik}-\operatorname{E}(X_{k})\right),
  </annotation>
 </semantics>
</math>

</p>

<p>using the population mean, has 

<math display="inline" id="Sample_mean_and_sample_covariance:24">
 <semantics>
  <mi>N</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>N</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \textstyle N
  </annotation>
 </semantics>
</math>

 in the denominator. This is an example of why in probability and statistics it is essential to distinguish between <a href="random_variable" title="wikilink">random variables</a> (upper case letters) and <a href="Realization_(probability)" title="wikilink">realizations</a> of the random variables (lower case letters).</p>

<p>The <a href="maximum_likelihood" title="wikilink">maximum likelihood</a> <a href="Estimation_of_covariance_matrices" title="wikilink">estimate of the covariance</a></p>

<p>

<math display="block" id="Sample_mean_and_sample_covariance:25">
 <semantics>
  <mrow>
   <msub>
    <mi>q</mi>
    <mrow>
     <mi>j</mi>
     <mi>k</mi>
    </mrow>
   </msub>
   <mo>=</mo>
   <mrow>
    <mfrac>
     <mn>1</mn>
     <mi>N</mi>
    </mfrac>
    <mrow>
     <munderover>
      <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
      <mrow>
       <mi>i</mi>
       <mo>=</mo>
       <mn>1</mn>
      </mrow>
      <mi>N</mi>
     </munderover>
     <mrow>
      <mrow>
       <mo>(</mo>
       <mrow>
        <msub>
         <mi>x</mi>
         <mrow>
          <mi>i</mi>
          <mi>j</mi>
         </mrow>
        </msub>
        <mo>-</mo>
        <msub>
         <mover accent="true">
          <mi>x</mi>
          <mo stretchy="false">¯</mo>
         </mover>
         <mi>j</mi>
        </msub>
       </mrow>
       <mo>)</mo>
      </mrow>
      <mrow>
       <mo>(</mo>
       <mrow>
        <msub>
         <mi>x</mi>
         <mrow>
          <mi>i</mi>
          <mi>k</mi>
         </mrow>
        </msub>
        <mo>-</mo>
        <msub>
         <mover accent="true">
          <mi>x</mi>
          <mo stretchy="false">¯</mo>
         </mover>
         <mi>k</mi>
        </msub>
       </mrow>
       <mo>)</mo>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>q</ci>
     <apply>
      <times></times>
      <ci>j</ci>
      <ci>k</ci>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <divide></divide>
      <cn type="integer">1</cn>
      <ci>N</ci>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <apply>
         <eq></eq>
         <ci>i</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <ci>N</ci>
      </apply>
      <apply>
       <times></times>
       <apply>
        <minus></minus>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>x</ci>
         <apply>
          <times></times>
          <ci>i</ci>
          <ci>j</ci>
         </apply>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <apply>
          <ci>normal-¯</ci>
          <ci>x</ci>
         </apply>
         <ci>j</ci>
        </apply>
       </apply>
       <apply>
        <minus></minus>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>x</ci>
         <apply>
          <times></times>
          <ci>i</ci>
          <ci>k</ci>
         </apply>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <apply>
          <ci>normal-¯</ci>
          <ci>x</ci>
         </apply>
         <ci>k</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   q_{jk}=\frac{1}{N}\sum_{i=1}^{N}\left(x_{ij}-\bar{x}_{j}\right)\left(x_{ik}-%
\bar{x}_{k}\right)
  </annotation>
 </semantics>
</math>

</p>

<p>for the <a href="Gaussian_distribution" title="wikilink">Gaussian distribution</a> case has <em>N</em> in the denominator as well. The ratio of 1/<em>N</em> to 1/(<em>N</em> − 1) approaches 1 for large <em>N</em>, so the maximum likelihood estimate approximately equals the unbiased estimate when the sample is large.</p>
<h2 id="variance-of-the-sample-mean">Variance of the sample mean</h2>

<p>For each random variable, the sample mean is a good <a class="uri" href="estimator" title="wikilink">estimator</a> of the population mean, where a "good" estimator is defined as being efficient and unbiased. Of course the estimator will likely not be the true value of the <a href="Statistical_population" title="wikilink">population</a> mean since different samples drawn from the same distribution will give different sample means and hence different estimates of the true mean. Thus the sample mean is a <a href="random_variable" title="wikilink">random variable</a>, not a constant, and consequently has its own distribution. For a random sample of <em>N</em> observations on the <em>j</em><sup>th</sup> random variable, the sample mean's distribution itself has mean equal to the population mean 

<math display="inline" id="Sample_mean_and_sample_covariance:26">
 <semantics>
  <mrow>
   <mi>E</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>X</mi>
     <mi>j</mi>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>E</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>X</ci>
     <ci>j</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   E(X_{j})
  </annotation>
 </semantics>
</math>

 and variance equal to 

<math display="inline" id="Sample_mean_and_sample_covariance:27">
 <semantics>
  <mrow>
   <mfrac>
    <msubsup>
     <mi>σ</mi>
     <mi>j</mi>
     <mn>2</mn>
    </msubsup>
    <mi>N</mi>
   </mfrac>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <divide></divide>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>σ</ci>
      <cn type="integer">2</cn>
     </apply>
     <ci>j</ci>
    </apply>
    <ci>N</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \frac{\sigma^{2}_{j}}{N},
  </annotation>
 </semantics>
</math>

 where 

<math display="inline" id="Sample_mean_and_sample_covariance:28">
 <semantics>
  <msubsup>
   <mi>σ</mi>
   <mi>j</mi>
   <mn>2</mn>
  </msubsup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>σ</ci>
     <cn type="integer">2</cn>
    </apply>
    <ci>j</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \sigma^{2}_{j}
  </annotation>
 </semantics>
</math>


 is the variance of the random variable <em>X</em><sub>j</sub>.</p>
<h2 id="weighted-samples">Weighted samples</h2>

<p>In a weighted sample, each vector 

<math display="inline" id="Sample_mean_and_sample_covariance:29">
 <semantics>
  <msub>
   <mtext>𝐱</mtext>
   <mi>i</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <mtext>x</mtext>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \textstyle\textbf{x}_{i}
  </annotation>
 </semantics>
</math>

 (each set of single observations on each of the <em>K</em> random variables) is assigned a weight 

<math display="inline" id="Sample_mean_and_sample_covariance:30">
 <semantics>
  <mrow>
   <msub>
    <mi>w</mi>
    <mi>i</mi>
   </msub>
   <mo>≥</mo>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <geq></geq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>w</ci>
     <ci>i</ci>
    </apply>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \textstyle w_{i}\geq 0
  </annotation>
 </semantics>
</math>

. Without loss of generality, assume that the weights are <a href="Normalizing_constant" title="wikilink">normalized</a>:</p>

<p>

<math display="block" id="Sample_mean_and_sample_covariance:31">
 <semantics>
  <mrow>
   <mrow>
    <munderover>
     <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
     <mrow>
      <mi>i</mi>
      <mo>=</mo>
      <mn>1</mn>
     </mrow>
     <mi>N</mi>
    </munderover>
    <msub>
     <mi>w</mi>
     <mi>i</mi>
    </msub>
   </mrow>
   <mo>=</mo>
   <mn>1.</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <apply>
        <eq></eq>
        <ci>i</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <ci>N</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>w</ci>
      <ci>i</ci>
     </apply>
    </apply>
    <cn type="float">1.</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \sum_{i=1}^{N}w_{i}=1.
  </annotation>
 </semantics>
</math>

</p>

<p>(If they are not, divide the weights by their sum). Then the <a href="weighted_mean" title="wikilink">weighted mean</a> vector 

<math display="inline" id="Sample_mean_and_sample_covariance:32">
 <semantics>
  <mover accent="true">
   <mi>𝐱</mi>
   <mo stretchy="false">¯</mo>
  </mover>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-¯</ci>
    <ci>𝐱</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \textstyle\mathbf{\bar{x}}
  </annotation>
 </semantics>
</math>

 is given by</p>

<p>

<math display="block" id="Sample_mean_and_sample_covariance:33">
 <semantics>
  <mrow>
   <mrow>
    <mover accent="true">
     <mi>𝐱</mi>
     <mo stretchy="false">¯</mo>
    </mover>
    <mo>=</mo>
    <mrow>
     <munderover>
      <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
      <mrow>
       <mi>i</mi>
       <mo>=</mo>
       <mn>1</mn>
      </mrow>
      <mi>N</mi>
     </munderover>
     <mrow>
      <msub>
       <mi>w</mi>
       <mi>i</mi>
      </msub>
      <msub>
       <mi>𝐱</mi>
       <mi>i</mi>
      </msub>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <ci>normal-¯</ci>
     <ci>𝐱</ci>
    </apply>
    <apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <apply>
        <eq></eq>
        <ci>i</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <ci>N</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>w</ci>
       <ci>i</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>𝐱</ci>
       <ci>i</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{\bar{x}}=\sum_{i=1}^{N}w_{i}\mathbf{x}_{i}.
  </annotation>
 </semantics>
</math>

</p>

<p>and the elements 

<math display="inline" id="Sample_mean_and_sample_covariance:34">
 <semantics>
  <msub>
   <mi>q</mi>
   <mrow>
    <mi>j</mi>
    <mi>k</mi>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>q</ci>
    <apply>
     <times></times>
     <ci>j</ci>
     <ci>k</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   q_{jk}
  </annotation>
 </semantics>
</math>

 of the weighted covariance matrix 

<math display="inline" id="Sample_mean_and_sample_covariance:35">
 <semantics>
  <mi>𝐐</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>𝐐</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \textstyle\mathbf{Q}
  </annotation>
 </semantics>
</math>

 are <a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a></p>

<p>

<math display="block" id="Sample_mean_and_sample_covariance:36">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>q</mi>
     <mrow>
      <mi>j</mi>
      <mi>k</mi>
     </mrow>
    </msub>
    <mo>=</mo>
    <mrow>
     <mfrac>
      <mrow>
       <msubsup>
        <mo largeop="true" symmetric="true">∑</mo>
        <mrow>
         <mi>i</mi>
         <mo>=</mo>
         <mn>1</mn>
        </mrow>
        <mi>N</mi>
       </msubsup>
       <msub>
        <mi>w</mi>
        <mi>i</mi>
       </msub>
      </mrow>
      <mrow>
       <msup>
        <mrow>
         <mo>(</mo>
         <mrow>
          <msubsup>
           <mo largeop="true" symmetric="true">∑</mo>
           <mrow>
            <mi>i</mi>
            <mo>=</mo>
            <mn>1</mn>
           </mrow>
           <mi>N</mi>
          </msubsup>
          <msub>
           <mi>w</mi>
           <mi>i</mi>
          </msub>
         </mrow>
         <mo>)</mo>
        </mrow>
        <mn>2</mn>
       </msup>
       <mo>-</mo>
       <mrow>
        <msubsup>
         <mo largeop="true" symmetric="true">∑</mo>
         <mrow>
          <mi>i</mi>
          <mo>=</mo>
          <mn>1</mn>
         </mrow>
         <mi>N</mi>
        </msubsup>
        <msubsup>
         <mi>w</mi>
         <mi>i</mi>
         <mn>2</mn>
        </msubsup>
       </mrow>
      </mrow>
     </mfrac>
     <mrow>
      <munderover>
       <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
       <mrow>
        <mi>i</mi>
        <mo>=</mo>
        <mn>1</mn>
       </mrow>
       <mi>N</mi>
      </munderover>
      <mrow>
       <msub>
        <mi>w</mi>
        <mi>i</mi>
       </msub>
       <mrow>
        <mo>(</mo>
        <mrow>
         <msub>
          <mi>x</mi>
          <mrow>
           <mi>i</mi>
           <mi>j</mi>
          </mrow>
         </msub>
         <mo>-</mo>
         <msub>
          <mover accent="true">
           <mi>x</mi>
           <mo stretchy="false">¯</mo>
          </mover>
          <mi>j</mi>
         </msub>
        </mrow>
        <mo>)</mo>
       </mrow>
       <mrow>
        <mo>(</mo>
        <mrow>
         <msub>
          <mi>x</mi>
          <mrow>
           <mi>i</mi>
           <mi>k</mi>
          </mrow>
         </msub>
         <mo>-</mo>
         <msub>
          <mover accent="true">
           <mi>x</mi>
           <mo stretchy="false">¯</mo>
          </mover>
          <mi>k</mi>
         </msub>
        </mrow>
        <mo>)</mo>
       </mrow>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>q</ci>
     <apply>
      <times></times>
      <ci>j</ci>
      <ci>k</ci>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <divide></divide>
      <apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <sum></sum>
         <apply>
          <eq></eq>
          <ci>i</ci>
          <cn type="integer">1</cn>
         </apply>
        </apply>
        <ci>N</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>w</ci>
        <ci>i</ci>
       </apply>
      </apply>
      <apply>
       <minus></minus>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <sum></sum>
           <apply>
            <eq></eq>
            <ci>i</ci>
            <cn type="integer">1</cn>
           </apply>
          </apply>
          <ci>N</ci>
         </apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>w</ci>
          <ci>i</ci>
         </apply>
        </apply>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <sum></sum>
          <apply>
           <eq></eq>
           <ci>i</ci>
           <cn type="integer">1</cn>
          </apply>
         </apply>
         <ci>N</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>w</ci>
          <ci>i</ci>
         </apply>
         <cn type="integer">2</cn>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <apply>
         <eq></eq>
         <ci>i</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <ci>N</ci>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>w</ci>
        <ci>i</ci>
       </apply>
       <apply>
        <minus></minus>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>x</ci>
         <apply>
          <times></times>
          <ci>i</ci>
          <ci>j</ci>
         </apply>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <apply>
          <ci>normal-¯</ci>
          <ci>x</ci>
         </apply>
         <ci>j</ci>
        </apply>
       </apply>
       <apply>
        <minus></minus>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>x</ci>
         <apply>
          <times></times>
          <ci>i</ci>
          <ci>k</ci>
         </apply>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <apply>
          <ci>normal-¯</ci>
          <ci>x</ci>
         </apply>
         <ci>k</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   q_{jk}=\frac{\sum_{i=1}^{N}w_{i}}{\left(\sum_{i=1}^{N}w_{i}\right)^{2}-\sum_{i%
=1}^{N}w_{i}^{2}}\sum_{i=1}^{N}w_{i}\left(x_{ij}-\bar{x}_{j}\right)\left(x_{ik%
}-\bar{x}_{k}\right).
  </annotation>
 </semantics>
</math>

</p>

<p>If all weights are the same, 

<math display="inline" id="Sample_mean_and_sample_covariance:37">
 <semantics>
  <mrow>
   <msub>
    <mi>w</mi>
    <mi>i</mi>
   </msub>
   <mo>=</mo>
   <mrow>
    <mn>1</mn>
    <mo>/</mo>
    <mi>N</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>w</ci>
     <ci>i</ci>
    </apply>
    <apply>
     <divide></divide>
     <cn type="integer">1</cn>
     <ci>N</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \textstyle w_{i}=1/N
  </annotation>
 </semantics>
</math>

, the weighted mean and covariance reduce to the sample mean and covariance above.</p>
<h2 id="criticism">Criticism</h2>

<p>The sample mean and sample covariance are widely used in statistics and applications, and are extremely common measures of <a href="Location_parameter" title="wikilink">location</a> and <a href="statistical_dispersion" title="wikilink">dispersion</a>, respectively, likely the most common: they are easily calculated and possess desirable characteristics.</p>

<p>However, they suffer from certain drawbacks; notably, they are not <a href="robust_statistics" title="wikilink">robust statistics</a>, meaning that they are sensitive to <a class="uri" href="outliers" title="wikilink">outliers</a>. As robustness is often a desired trait, particularly in real-world applications, robust alternatives may prove desirable, notably <a class="uri" href="quantile" title="wikilink">quantile</a>-based statistics such the <a href="sample_median" title="wikilink">sample median</a> for location,<a class="footnoteRef" href="#fn3" id="fnref3"><sup>3</sup></a> and <a href="interquartile_range" title="wikilink">interquartile range</a> (IQR) for dispersion. Other alternatives include <a href="Trimmed_estimator" title="wikilink">trimming</a> and <a class="uri" href="Winsorising" title="wikilink">Winsorising</a>, as in the <a href="trimmed_mean" title="wikilink">trimmed mean</a> and the <a href="Winsorized_mean" title="wikilink">Winsorized mean</a>.</p>
<h2 id="see-also">See also</h2>
<ul>
<li><a href="Unbiased_estimation_of_standard_deviation" title="wikilink">Unbiased estimation of standard deviation</a></li>
<li><a href="Estimation_of_covariance_matrices" title="wikilink">Estimation of covariance matrices</a></li>
<li><a href="Scatter_matrix" title="wikilink">Scatter matrix</a></li>
</ul>
<h2 id="references">References</h2>
<references>
</references>

<p>"</p>

<p><a href="Category:Covariance_and_correlation" title="wikilink">Category:Covariance and correlation</a> <a href="Category:Estimation_for_specific_parameters" title="wikilink">Category:Estimation for specific parameters</a> <a href="Category:Summary_statistics" title="wikilink">Category:Summary statistics</a> <a class="uri" href="Category:Matrices" title="wikilink">Category:Matrices</a> <a class="uri" href="Category:U-statistics" title="wikilink">Category:U-statistics</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1"><a href="#fnref1">↩</a></li>
<li id="fn2">Mark Galassi, Jim Davies, James Theiler, Brian Gough, Gerard Jungman, Michael Booth, and Fabrice Rossi. <a href="https://www.gnu.org/software/gsl/manual">GNU Scientific Library - Reference manual, Version 1.15</a>, 2011. <a href="https://www.gnu.org/software/gsl/manual/html_node/Weighted-Samples.html">Sec. 21.7 Weighted Samples</a><a href="#fnref2">↩</a></li>
<li id="fn3"><a href="http://www.edge.org/q2008/q08_16.html#kosko">The World Question Center 2006: The Sample Mean</a>, <a href="Bart_Kosko" title="wikilink">Bart Kosko</a><a href="#fnref3">↩</a></li>
</ol>
</section>
</body>
</html>

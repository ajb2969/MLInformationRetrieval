<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="810">Instrumental variable</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Instrumental variable</h1>
<hr/>

<p>In <a class="uri" href="statistics" title="wikilink">statistics</a>, <a class="uri" href="econometrics" title="wikilink">econometrics</a>, <a class="uri" href="epidemiology" title="wikilink">epidemiology</a> and related disciplines, the method of <strong>instrumental variables</strong> (<strong>IV</strong>) is used to estimate <a href="Causal_inference" title="wikilink">causal relationships</a> when <a href="controlled_experiment" title="wikilink">controlled experiments</a> are not feasible or when a treatment is not successfully delivered to every unit in a randomized experiment.<a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a></p>

<p>Instrumental variable methods allow <a href="consistent_estimator" title="wikilink">consistent</a> estimation when the <a href="dependent_and_independent_variables" title="wikilink">explanatory variables</a> (covariates) are <a href="correlation" title="wikilink">correlated</a> with the <a href="errors_and_residuals_in_statistics" title="wikilink">error terms</a> of a <a href="regression_analysis" title="wikilink">regression</a> relationship. Such correlation may occur when the dependent variable causes at least one of the <a href="covariate" title="wikilink">covariates</a> ("reverse" causation), when there are relevant explanatory variables which are omitted from the model, or when the covariates are subject to measurement error. In this situation, ordinary <a href="linear_regression" title="wikilink">linear regression</a> generally produces biased and inconsistent estimates.<a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a> However, if an <em>instrument</em> is available, consistent estimates may still be obtained. An instrument is a variable that does not itself belong in the explanatory equation and is correlated with the <a href="endogeneity_(econometrics)" title="wikilink">endogenous</a> explanatory variables, conditional on the other covariates. In linear models, there are two main requirements for using an IV:</p>
<ul>
<li>The instrument must be correlated with the endogenous explanatory variables, conditional on the other covariates.</li>
<li>The instrument cannot be correlated with the error term in the explanatory equation (conditional on the other covariates), that is, the instrument cannot suffer from the same problem as the original predicting variable.</li>
</ul>
<h2 id="definitions">Definitions</h2>

<p>The theory of instrumental variables was first derived by <a href="Philip_Green_Wright" title="wikilink">Philip G. Wright</a>, possibly in co-authorship with his son <a href="Sewall_Wright" title="wikilink">Sewall Wright</a>, in his 1928 book <em>The Tariff on Animal and Vegetable Oils</em>.<a class="footnoteRef" href="#fn3" id="fnref3"><sup>3</sup></a><a class="footnoteRef" href="#fn4" id="fnref4"><sup>4</sup></a> Traditionally,<a class="footnoteRef" href="#fn5" id="fnref5"><sup>5</sup></a> an instrumental variable is defined as a variable <em>Z</em> that is correlated with the independent variable <em>X</em> and uncorrelated with the "error term" U in the equation</p>

<p>

<math display="block" id="Instrumental_variable:0">
 <semantics>
  <mrow>
   <mi>Y</mi>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mi>β</mi>
     <mi>X</mi>
    </mrow>
    <mo>+</mo>
    <mpadded width="+1.7pt">
     <mi>U</mi>
    </mpadded>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>Y</ci>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <ci>β</ci>
      <ci>X</ci>
     </apply>
     <ci>U</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Y=\beta X+U\,
  </annotation>
 </semantics>
</math>

</p>

<p>However, this definition suffers from ambiguities in concepts such as "error term" and "independent variable," and has led to confusion as to the meaning of the equation itself, which was wrongly labeled "regression."<a class="footnoteRef" href="#fn6" id="fnref6"><sup>6</sup></a></p>

<p>General definitions of instrumental variables, using counterfactual and graphical formalism, were given by Pearl (2000; p. 248).<a class="footnoteRef" href="#fn7" id="fnref7"><sup>7</sup></a> The graphical definition requires that <em>Z</em> satisfy the following conditions:</p>

<p>

<math display="block" id="Instrumental_variable:1">
 <semantics>
  <mrow>
   <msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>Z</mi>
     <mo rspace="0pt">⟂</mo>
     <mo>⟂</mo>
     <mi>Y</mi>
     <mo stretchy="false">)</mo>
    </mrow>
    <msub>
     <mi>G</mi>
     <mover accent="true">
      <mi>X</mi>
      <mo>¯</mo>
     </mover>
    </msub>
   </msub>
   <msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>Z</mi>
     <mpadded width="-1.7pt">
      <menclose notation="updiagonalstrike">
       <mspace width="-1.7pt">
       </mspace>
      </menclose>
     </mpadded>
     <mo rspace="0pt">⟂</mo>
     <mo>⟂</mo>
     <mi>X</mi>
     <mo stretchy="false">)</mo>
    </mrow>
    <mi>G</mi>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <ci>normal-(</ci>
      <csymbol cd="unknown">Z</csymbol>
      <csymbol cd="latexml">perpendicular-to</csymbol>
      <csymbol cd="latexml">perpendicular-to</csymbol>
      <csymbol cd="unknown">Y</csymbol>
      <ci>normal-)</ci>
     </cerror>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>G</ci>
      <apply>
       <ci>normal-¯</ci>
       <ci>X</ci>
      </apply>
     </apply>
    </apply>
    <ci>italic-</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <ci>normal-(</ci>
      <csymbol cd="unknown">Z</csymbol>
      <apply>
       <not></not>
      </apply>
      <csymbol cd="latexml">perpendicular-to</csymbol>
      <csymbol cd="latexml">perpendicular-to</csymbol>
      <csymbol cd="unknown">X</csymbol>
      <ci>normal-)</ci>
     </cerror>
     <ci>G</ci>
    </apply>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (Z\perp\!\!\!\perp Y)_{G_{\overline{X}}}\qquad(Z\not\!\!{\perp\!\!\!\perp}X)_{G}
  </annotation>
 </semantics>
</math>

</p>

<p>where 

<math display="inline" id="Instrumental_variable:2">
 <semantics>
  <mrow>
   <mi></mi>
   <mo rspace="0pt">⟂</mo>
   <mo>⟂</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">perpendicular-to</csymbol>
    <csymbol cd="latexml">absent</csymbol>
    <csymbol cd="latexml">perpendicular-to</csymbol>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \perp\!\!\!\perp
  </annotation>
 </semantics>
</math>

 stands for <em>d</em>-separation<a class="footnoteRef" href="#fn8" id="fnref8"><sup>8</sup></a>[What is <em>d</em>-separation?] and 

<math display="inline" id="Instrumental_variable:3">
 <semantics>
  <msub>
   <mi>G</mi>
   <mover accent="true">
    <mi>X</mi>
    <mo>¯</mo>
   </mover>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>G</ci>
    <apply>
     <ci>normal-¯</ci>
     <ci>X</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   G_{\overline{X}}
  </annotation>
 </semantics>
</math>


 stands for the graph [The nature of the graphs involved is not explained here.] in which all arrows entering <em>X</em> are cut off.</p>

<p>The counterfactual definition requires that <em>Z</em> satisfies</p>

<p>

<math display="block" id="Instrumental_variable:4">
 <semantics>
  <mrow>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>Z</mi>
    <mo rspace="0pt">⟂</mo>
    <mo>⟂</mo>
    <msub>
     <mi>Y</mi>
     <mi>x</mi>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>Z</mi>
    <mpadded width="-1.7pt">
     <menclose notation="updiagonalstrike">
      <mspace width="-1.7pt">
      </mspace>
     </menclose>
    </mpadded>
    <mo rspace="0pt">⟂</mo>
    <mo>⟂</mo>
    <mi>X</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">Z</csymbol>
     <csymbol cd="latexml">perpendicular-to</csymbol>
     <csymbol cd="latexml">perpendicular-to</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>Y</ci>
      <ci>x</ci>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <ci>italic-</ci>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">Z</csymbol>
     <apply>
      <not></not>
     </apply>
     <csymbol cd="latexml">perpendicular-to</csymbol>
     <csymbol cd="latexml">perpendicular-to</csymbol>
     <csymbol cd="unknown">X</csymbol>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (Z\perp\!\!\!\perp Y_{x})\qquad(Z\not\!\!{\perp\!\!\!\perp}X)
  </annotation>
 </semantics>
</math>

</p>

<p>where <em>Y</em><sub><em>x</em></sub> stands for the value that <em>Y</em> would attain had <em>X</em> been <em>x</em> and 

<math display="inline" id="Instrumental_variable:5">
 <semantics>
  <mrow>
   <mi></mi>
   <mo rspace="0pt">⟂</mo>
   <mo>⟂</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">perpendicular-to</csymbol>
    <csymbol cd="latexml">absent</csymbol>
    <csymbol cd="latexml">perpendicular-to</csymbol>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \perp\!\!\!\perp
  </annotation>
 </semantics>
</math>

 stands for independence.</p>

<p>If there are additional covariates <em>W</em> then the above definitions are modified so that <em>Z</em> qualifies as an instrument if the given criteria hold conditional on <em>W</em>.</p>

<p>The essence of Pearl's definition is:</p>
<ol>
<li>The equations of interest are "structural," not "regression."</li>
<li>The error term <em>U</em> stands for all exogenous factors that affect <em>Y</em> when <em>X</em> is held constant.</li>
<li>The instrument <em>Z</em> should be independent of <em>U.</em></li>
<li>The instrument <em>Z</em> should not affect <em>Y</em> when <em>X</em> is held constant (exclusion restriction).</li>
<li>The instrument <em>Z</em> should not be independent of <em>X.</em></li>
</ol>

<p>These conditions do not rely on specific functional form of the equations and are applicable therefore to nonlinear equations, where <em>U</em> can be non-additive (see Non-parametric analysis). They are also applicable to a system of multiple equations, in which <em>X</em> (and other factors) affect <em>Y</em> through several intermediate variables. Note that an instrumental variable need not be a cause of <em>X</em>; a proxy of such cause may also be used, if it satisfies conditions 1-5.<a class="footnoteRef" href="#fn9" id="fnref9"><sup>9</sup></a> Note also that the exclusion restriction (condition 4) is redundant; it follows from conditions 2 and 3.</p>
<h2 id="example">Example</h2>

<p>Informally, in attempting to estimate the causal effect of some variable <em>x</em> on another <em>y</em>, an instrument is a third variable <em>z</em> which affects <em>y</em> only through its effect on <em>x</em>. For example, suppose a researcher wishes to estimate the causal effect of smoking on general health.<a class="footnoteRef" href="#fn10" id="fnref10"><sup>10</sup></a> Correlation between health and smoking does not imply that smoking causes poor health because other variables may affect both health and smoking, or because health may affect smoking in addition to smoking causing health problems. It is at best difficult and expensive to conduct controlled experiments on smoking status in the general population. The researcher may proceed to attempt to estimate the causal effect of smoking on health from observational data by using time series on the tax rate for tobacco products as an instrument for smoking in a causal analysis. If tobacco taxes and state of health are correlated then this may be viewed as evidence that smoking causes changes in health.</p>

<p>Because demonstrating that the third variable <em>z</em> is causally related to <em>y</em> <em>exclusively</em> via <em>x</em> is an experimental impossibility, and because the same limitations that prevent an experiment to determine if there is a causal relationship between <em>x</em> and <em>y</em> will normally also prevent experiments determining if there is a causal relationship between <em>z</em> and <em>y</em> (assumed to be mediated through <em>x</em>), correlational data is the only type of evidence that analysis by instrumental variable can provide, and causal inference is not justified. The use of an instrumental variable produces additional evidence of a statistical relationship (in this case between <em>z</em> and <em>y</em>), without providing evidence of what type of relationship it is, and without providing direct evidence for the type of relationship between <em>x</em> and <em>y</em>.</p>
<h2 id="applications">Applications</h2>

<p>IV methods are commonly used to estimate causal effects in contexts in which controlled experiments are not available. Credibility of the estimates hinges on the selection of suitable instruments. Good instruments are often created by policy changes. For example, the cancellation of a federal student-aid scholarship program may reveal the effects of aid on some students' outcomes. Other <a href="natural_experiment" title="wikilink">natural and quasi-natural experiments</a> of various types are commonly exploited, for example, Miguel, Satyanath, and Sergenti (2004) use weather shocks to identify the effect of changes in economic growth (i.e., declines) on civil conflict.<a class="footnoteRef" href="#fn11" id="fnref11"><sup>11</sup></a> <a href="Joshua_Angrist" title="wikilink">Angrist</a> and <a href="Alan_Krueger" title="wikilink">Krueger</a> (2001) present a survey of the history and uses of instrumental variable techniques.<a class="footnoteRef" href="#fn12" id="fnref12"><sup>12</sup></a></p>
<h2 id="selecting-suitable-instruments">Selecting suitable instruments</h2>

<p>Since <em>U</em> is unobserved, the requirement that <em>Z</em> be independent of <em>U</em> cannot be inferred from data and must instead be determined from the model structure, i.e., the data-generating process. <a href="Causal_graphs" title="wikilink">Causal graphs</a> are a representation of this structure, and the <a href="instrumental_variable#Definitions" title="wikilink">graphical definition</a> given above can be used to quickly determine whether a variable <em>Z</em> qualifies as an instrumental variable given a set of covariates <em>W</em>. To see how, consider the following example.</p>

<p> </p>

<p>Suppose that we wish to estimate the effect of a university tutoring program on GPA at a university where the dormitories to which students are assigned is random. The relationship between attending the tutoring program and GPA may be confounded by a number of factors. Students that attend the tutoring program may care more about their grades or may be struggling with their work. (This confounding is depicted in the Figures 1-3 on the right through the bidirected arc between Tutoring Program and GPA.) Given that students are assigned to dormitories at random, the proximity of the student's dorm to the tutoring program is a natural candidate for being an instrumental variable. However, what if the tutoring program is located in the college library? Proximity may also cause students to spend more time at the library, which in turn improves their GPA (see Figure 1). Using the causal graph depicted in the Figure 2, we see that Proximity does not qualify as an instrumental variable because it is d-connected to GPA through the path Proximity 

<math display="inline" id="Instrumental_variable:6">
 <semantics>
  <mo>→</mo>
  <annotation-xml encoding="MathML-Content">
   <ci>normal-→</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \rightarrow
  </annotation>
 </semantics>
</math>

 Library Hours 

<math display="inline" id="Instrumental_variable:7">
 <semantics>
  <mo>→</mo>
  <annotation-xml encoding="MathML-Content">
   <ci>normal-→</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \rightarrow
  </annotation>
 </semantics>
</math>

 GPA in 

<math display="inline" id="Instrumental_variable:8">
 <semantics>
  <msub>
   <mi>G</mi>
   <mover accent="true">
    <mi>X</mi>
    <mo>¯</mo>
   </mover>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>G</ci>
    <apply>
     <ci>normal-¯</ci>
     <ci>X</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   G_{\overline{X}}
  </annotation>
 </semantics>
</math>


. However, if we control for Library Hours by adding it as a covariate then Proximity becomes an instrumental variable since Proximity is d-separated from GPA given Library Hours in 

<math display="inline" id="Instrumental_variable:9">
 <semantics>
  <msub>
   <mi>G</mi>
   <mover accent="true">
    <mi>X</mi>
    <mo>¯</mo>
   </mover>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>G</ci>
    <apply>
     <ci>normal-¯</ci>
     <ci>X</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   G_{\overline{X}}
  </annotation>
 </semantics>
</math>

. Now, suppose that we notice that a student's "natural ability" affects his or her number of hours in the library as well as his or her GPA, as in Figure 3. Using the causal graph, we see that Library Hours is a collider and conditioning on it opens the path Proximity 

<math display="inline" id="Instrumental_variable:10">
 <semantics>
  <mo>→</mo>
  <annotation-xml encoding="MathML-Content">
   <ci>normal-→</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \rightarrow
  </annotation>
 </semantics>
</math>

 Library Hours 

<math display="inline" id="Instrumental_variable:11">
 <semantics>
  <mo>↔</mo>
  <annotation-xml encoding="MathML-Content">
   <ci>normal-↔</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \leftrightarrow
  </annotation>
 </semantics>
</math>

 GPA. As a result, Proximity cannot be used as an instrumental variable. Finally, suppose that Library Hours does not actually affect GPA because students who do not study in the library simply study elsewhere, as in Figure 4. In this case, controlling for Library Hours still opens a spurious path from Proximity to GPA. However, if we do not control for Library Hours and remove it as a covariate then Proximity can again be used an instrumental variable.</p>
<h2 id="estimation">Estimation</h2>

<p>Suppose the data are generated by a process of the form</p>

<p>

<math display="block" id="Instrumental_variable:12">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>y</mi>
     <mi>i</mi>
    </msub>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mi>β</mi>
      <msub>
       <mi>x</mi>
       <mi>i</mi>
      </msub>
     </mrow>
     <mo>+</mo>
     <msub>
      <mi>ε</mi>
      <mi>i</mi>
     </msub>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>y</ci>
     <ci>i</ci>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <ci>β</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <ci>i</ci>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>ε</ci>
      <ci>i</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   y_{i}=\beta x_{i}+\varepsilon_{i},
  </annotation>
 </semantics>
</math>

</p>

<p>where</p>
<ul>
<li><em>i</em> indexes observations,</li>
<li>

<math display="inline" id="Instrumental_variable:13">
 <semantics>
  <msub>
   <mi>y</mi>
   <mi>i</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>y</ci>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   y_{i}
  </annotation>
 </semantics>
</math>


 is the dependent variable,</li>
<li>

<math display="inline" id="Instrumental_variable:14">
 <semantics>
  <msub>
   <mi>x</mi>
   <mi>i</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>x</ci>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x_{i}
  </annotation>
 </semantics>
</math>

 is an independent variable,</li>
<li>

<math display="inline" id="Instrumental_variable:15">
 <semantics>
  <msub>
   <mi>ε</mi>
   <mi>i</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>ε</ci>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \varepsilon_{i}
  </annotation>
 </semantics>
</math>

 is an unobserved error term representing all causes of 

<math display="inline" id="Instrumental_variable:16">
 <semantics>
  <msub>
   <mi>y</mi>
   <mi>i</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>y</ci>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   y_{i}
  </annotation>
 </semantics>
</math>

 other than 

<math display="inline" id="Instrumental_variable:17">
 <semantics>
  <msub>
   <mi>x</mi>
   <mi>i</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>x</ci>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x_{i}
  </annotation>
 </semantics>
</math>

, and</li>
<li>

<math display="inline" id="Instrumental_variable:18">
 <semantics>
  <mi>β</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>β</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \beta
  </annotation>
 </semantics>
</math>


 is an unobserved scalar parameter.</li>
</ul>

<p>The parameter 

<math display="inline" id="Instrumental_variable:19">
 <semantics>
  <mi>β</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>β</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \beta
  </annotation>
 </semantics>
</math>

 is the causal effect on 

<math display="inline" id="Instrumental_variable:20">
 <semantics>
  <msub>
   <mi>y</mi>
   <mi>i</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>y</ci>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   y_{i}
  </annotation>
 </semantics>
</math>

 of a one unit change in 

<math display="inline" id="Instrumental_variable:21">
 <semantics>
  <msub>
   <mi>x</mi>
   <mi>i</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>x</ci>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x_{i}
  </annotation>
 </semantics>
</math>

, holding all other causes of 

<math display="inline" id="Instrumental_variable:22">
 <semantics>
  <msub>
   <mi>y</mi>
   <mi>i</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>y</ci>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   y_{i}
  </annotation>
 </semantics>
</math>

 constant. The econometric goal is to estimate 

<math display="inline" id="Instrumental_variable:23">
 <semantics>
  <mi>β</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>β</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \beta
  </annotation>
 </semantics>
</math>


. For simplicity's sake assume the draws of 

<math display="inline" id="Instrumental_variable:24">
 <semantics>
  <mi>ε</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>ε</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \varepsilon
  </annotation>
 </semantics>
</math>

 are uncorrelated and that they are drawn from distributions with the same <a class="uri" href="variance" title="wikilink">variance</a>, that is, that the errors are serially uncorrelated and <a class="uri" href="homoskedastic" title="wikilink">homoskedastic</a>.</p>

<p>Suppose also that a regression model of nominally the same form is proposed. Given a random sample of <em>T</em> observations from this process, the <a href="least_squares" title="wikilink">ordinary least squares</a> estimator is</p>

<p>

<math display="block" id="Instrumental_variable:25">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mover accent="true">
      <mi>β</mi>
      <mo>^</mo>
     </mover>
     <mi>OLS</mi>
    </msub>
    <mo>=</mo>
    <mfrac>
     <mrow>
      <msup>
       <mi>x</mi>
       <mi mathvariant="normal">T</mi>
      </msup>
      <mi>y</mi>
     </mrow>
     <mrow>
      <msup>
       <mi>x</mi>
       <mi mathvariant="normal">T</mi>
      </msup>
      <mi>x</mi>
     </mrow>
    </mfrac>
    <mo>=</mo>
    <mfrac>
     <mrow>
      <msup>
       <mi>x</mi>
       <mi mathvariant="normal">T</mi>
      </msup>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mrow>
         <mi>x</mi>
         <mi>β</mi>
        </mrow>
        <mo>+</mo>
        <mi>ε</mi>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mrow>
      <msup>
       <mi>x</mi>
       <mi mathvariant="normal">T</mi>
      </msup>
      <mi>x</mi>
     </mrow>
    </mfrac>
    <mo>=</mo>
    <mrow>
     <mi>β</mi>
     <mo>+</mo>
     <mfrac>
      <mrow>
       <msup>
        <mi>x</mi>
        <mi mathvariant="normal">T</mi>
       </msup>
       <mi>ε</mi>
      </mrow>
      <mrow>
       <msup>
        <mi>x</mi>
        <mi mathvariant="normal">T</mi>
       </msup>
       <mi>x</mi>
      </mrow>
     </mfrac>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <ci>normal-^</ci>
       <ci>β</ci>
      </apply>
      <ci>OLS</ci>
     </apply>
     <apply>
      <divide></divide>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>x</ci>
        <ci>normal-T</ci>
       </apply>
       <ci>y</ci>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>x</ci>
        <ci>normal-T</ci>
       </apply>
       <ci>x</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <divide></divide>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>x</ci>
        <ci>normal-T</ci>
       </apply>
       <apply>
        <plus></plus>
        <apply>
         <times></times>
         <ci>x</ci>
         <ci>β</ci>
        </apply>
        <ci>ε</ci>
       </apply>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>x</ci>
        <ci>normal-T</ci>
       </apply>
       <ci>x</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <plus></plus>
      <ci>β</ci>
      <apply>
       <divide></divide>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>x</ci>
         <ci>normal-T</ci>
        </apply>
        <ci>ε</ci>
       </apply>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>x</ci>
         <ci>normal-T</ci>
        </apply>
        <ci>x</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \widehat{\beta}_{\mathrm{OLS}}=\frac{x^{\mathrm{T}}y}{x^{\mathrm{T}}x}=\frac{x%
^{\mathrm{T}}(x\beta+\varepsilon)}{x^{\mathrm{T}}x}=\beta+\frac{x^{\mathrm{T}}%
\varepsilon}{x^{\mathrm{T}}x}.
  </annotation>
 </semantics>
</math>

</p>

<p>where <em>x</em>, <em>y</em> and 

<math display="inline" id="Instrumental_variable:26">
 <semantics>
  <mi>ε</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>ε</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \varepsilon
  </annotation>
 </semantics>
</math>

 denote column vectors of length <em>T</em>. When <em>x</em> and 

<math display="inline" id="Instrumental_variable:27">
 <semantics>
  <mi>ε</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>ε</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \varepsilon
  </annotation>
 </semantics>
</math>

 are <a href="correlation" title="wikilink">uncorrelated</a>, under certain regularity conditions the second term has an expected value conditional on <em>x</em> of zero and converges to zero in the limit, so the estimator is <a href="estimator_bias" title="wikilink">unbiased</a> and consistent. When <em>x</em> and the other unmeasured, causal variables collapsed into the 

<math display="inline" id="Instrumental_variable:28">
 <semantics>
  <mi>ε</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>ε</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \varepsilon
  </annotation>
 </semantics>
</math>

 term are correlated, however, the OLS estimator is generally biased and inconsistent for β. In this case, it is valid to use the estimates to predict values of <em>y</em> given values of <em>x</em>, but the estimate does not recover the causal effect of <em>x</em> on <em>y</em>.</p>

<p>An instrumental variable <em>z</em> is one that is correlated with the independent variable but not with the <a href="errors_and_residuals_in_statistics" title="wikilink">error</a> term. Using the <a href="method_of_moments_(statistics)" title="wikilink">method of moments</a>, take expectations conditional on <em>z</em> to find</p>

<p>

<math display="block" id="Instrumental_variable:29">
 <semantics>
  <mrow>
   <mi>E</mi>
   <mrow>
    <mo stretchy="false">[</mo>
    <mi>y</mi>
    <mo>∣</mo>
    <mi>z</mi>
    <mo stretchy="false">]</mo>
   </mrow>
   <mo>=</mo>
   <mi>β</mi>
   <mi>E</mi>
   <mrow>
    <mo stretchy="false">[</mo>
    <mi>x</mi>
    <mo>∣</mo>
    <mi>z</mi>
    <mo stretchy="false">]</mo>
   </mrow>
   <mo>+</mo>
   <mi>E</mi>
   <mrow>
    <mo stretchy="false">[</mo>
    <mi>ε</mi>
    <mo>∣</mo>
    <mi>z</mi>
    <mo stretchy="false">]</mo>
   </mrow>
   <mo rspace="4.2pt">.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">E</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-[</ci>
     <csymbol cd="unknown">y</csymbol>
     <ci>normal-∣</ci>
     <csymbol cd="unknown">z</csymbol>
     <ci>normal-]</ci>
    </cerror>
    <eq></eq>
    <csymbol cd="unknown">β</csymbol>
    <csymbol cd="unknown">E</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-[</ci>
     <csymbol cd="unknown">x</csymbol>
     <ci>normal-∣</ci>
     <csymbol cd="unknown">z</csymbol>
     <ci>normal-]</ci>
    </cerror>
    <plus></plus>
    <csymbol cd="unknown">E</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-[</ci>
     <csymbol cd="unknown">ε</csymbol>
     <ci>normal-∣</ci>
     <csymbol cd="unknown">z</csymbol>
     <ci>normal-]</ci>
    </cerror>
    <ci>normal-.</ci>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   E[y\mid z]=\beta E[x\mid z]+E[\varepsilon\mid z].\,
  </annotation>
 </semantics>
</math>

</p>

<p>The second term on the right-hand side is zero by assumption. Solve for 

<math display="inline" id="Instrumental_variable:30">
 <semantics>
  <mi>β</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>β</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \beta
  </annotation>
 </semantics>
</math>

 and write the resulting expression in terms of sample moments,</p>

<p>

<math display="block" id="Instrumental_variable:31">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mover accent="true">
      <mi>β</mi>
      <mo>^</mo>
     </mover>
     <mi>IV</mi>
    </msub>
    <mo>=</mo>
    <mfrac>
     <mrow>
      <msup>
       <mi>z</mi>
       <mi mathvariant="normal">T</mi>
      </msup>
      <mi>y</mi>
     </mrow>
     <mrow>
      <msup>
       <mi>z</mi>
       <mi mathvariant="normal">T</mi>
      </msup>
      <mi>x</mi>
     </mrow>
    </mfrac>
    <mo>=</mo>
    <mrow>
     <mi>β</mi>
     <mo>+</mo>
     <mfrac>
      <mrow>
       <msup>
        <mi>z</mi>
        <mi mathvariant="normal">T</mi>
       </msup>
       <mi>ε</mi>
      </mrow>
      <mrow>
       <msup>
        <mi>z</mi>
        <mi mathvariant="normal">T</mi>
       </msup>
       <mi>x</mi>
      </mrow>
     </mfrac>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <ci>normal-^</ci>
       <ci>β</ci>
      </apply>
      <ci>IV</ci>
     </apply>
     <apply>
      <divide></divide>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>z</ci>
        <ci>normal-T</ci>
       </apply>
       <ci>y</ci>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>z</ci>
        <ci>normal-T</ci>
       </apply>
       <ci>x</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <plus></plus>
      <ci>β</ci>
      <apply>
       <divide></divide>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>z</ci>
         <ci>normal-T</ci>
        </apply>
        <ci>ε</ci>
       </apply>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>z</ci>
         <ci>normal-T</ci>
        </apply>
        <ci>x</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \widehat{\beta}_{\mathrm{IV}}=\frac{z^{\mathrm{T}}y}{z^{\mathrm{T}}x}=\beta+%
\frac{z^{\mathrm{T}}\varepsilon}{z^{\mathrm{T}}x}.\,
  </annotation>
 </semantics>
</math>

</p>

<p>When <em>z</em> and 

<math display="inline" id="Instrumental_variable:32">
 <semantics>
  <mi>ε</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>ε</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \varepsilon
  </annotation>
 </semantics>
</math>

 are uncorrelated, the final term, under certain regularity conditions, approaches zero in the limit, providing a consistent estimator. Put another way, the causal effect of <em>x</em> on <em>y</em> can be consistently estimated from these data even though <em>x</em> is not randomly assigned through experimental methods.</p>

<p>The approach generalizes to a model with multiple explanatory variables. Suppose <em>X</em> is the <em>T × K</em> matrix of explanatory variables resulting from <em>T</em> observations on <em>K</em> variables. Let <em>Z</em> be a <em>T × K</em> matrix of instruments. Then it can be shown that the estimator</p>

<p>

<math display="block" id="Instrumental_variable:33">
 <semantics>
  <mrow>
   <msub>
    <mover accent="true">
     <mi>β</mi>
     <mo>^</mo>
    </mover>
    <mi>IV</mi>
   </msub>
   <mo>=</mo>
   <mrow>
    <msup>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <msup>
        <mi>Z</mi>
        <mi mathvariant="normal">T</mi>
       </msup>
       <mi>X</mi>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <mrow>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </msup>
    <msup>
     <mi>Z</mi>
     <mi mathvariant="normal">T</mi>
    </msup>
    <mpadded width="+1.7pt">
     <mi>y</mi>
    </mpadded>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <ci>normal-^</ci>
      <ci>β</ci>
     </apply>
     <ci>IV</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>Z</ci>
        <ci>normal-T</ci>
       </apply>
       <ci>X</ci>
      </apply>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>Z</ci>
      <ci>normal-T</ci>
     </apply>
     <ci>y</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \widehat{\beta}_{\mathrm{IV}}=(Z^{\mathrm{T}}X)^{-1}Z^{\mathrm{T}}y\,
  </annotation>
 </semantics>
</math>

</p>

<p>is consistent under a multivariate generalization of the conditions discussed above. If there are more instruments than there are covariates in the equation of interest so that <em>Z</em> is a <em>T × M</em> matrix with <em>M &gt; K</em>, the <a href="generalized_method_of_moments" title="wikilink">generalized method of moments</a> (GMM) can be used and the resulting IV estimator is</p>

<p>

<math display="block" id="Instrumental_variable:34">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mover accent="true">
      <mi>β</mi>
      <mo>^</mo>
     </mover>
     <mi>GMM</mi>
    </msub>
    <mo>=</mo>
    <mrow>
     <msup>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <msup>
         <mi>X</mi>
         <mi mathvariant="normal">T</mi>
        </msup>
        <msub>
         <mi>P</mi>
         <mi>Z</mi>
        </msub>
        <mi>X</mi>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
      <mrow>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
     </msup>
     <msup>
      <mi>X</mi>
      <mi mathvariant="normal">T</mi>
     </msup>
     <msub>
      <mi>P</mi>
      <mi>Z</mi>
     </msub>
     <mi>y</mi>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <ci>normal-^</ci>
      <ci>β</ci>
     </apply>
     <ci>GMM</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>X</ci>
        <ci>normal-T</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>P</ci>
        <ci>Z</ci>
       </apply>
       <ci>X</ci>
      </apply>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>X</ci>
      <ci>normal-T</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>P</ci>
      <ci>Z</ci>
     </apply>
     <ci>y</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \widehat{\beta}_{\mathrm{GMM}}=(X^{\mathrm{T}}P_{Z}X)^{-1}X^{\mathrm{T}}P_{Z}y,
  </annotation>
 </semantics>
</math>

</p>

<p>where 

<math display="inline" id="Instrumental_variable:35">
 <semantics>
  <mrow>
   <msub>
    <mi>P</mi>
    <mi>Z</mi>
   </msub>
   <mo>=</mo>
   <mrow>
    <mi>Z</mi>
    <msup>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <msup>
        <mi>Z</mi>
        <mi mathvariant="normal">T</mi>
       </msup>
       <mi>Z</mi>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <mrow>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </msup>
    <msup>
     <mi>Z</mi>
     <mi mathvariant="normal">T</mi>
    </msup>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>P</ci>
     <ci>Z</ci>
    </apply>
    <apply>
     <times></times>
     <ci>Z</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>Z</ci>
        <ci>normal-T</ci>
       </apply>
       <ci>Z</ci>
      </apply>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>Z</ci>
      <ci>normal-T</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   P_{Z}=Z(Z^{\mathrm{T}}Z)^{-1}Z^{\mathrm{T}}
  </annotation>
 </semantics>
</math>

.</p>

<p>Note that the second expression collapses to the first when the number of instruments is equal to the number of covariates in the equation of interest (just-identified case).</p>

<p><mtpl></mtpl> Developing the 

<math display="inline" id="Instrumental_variable:36">
 <semantics>
  <msub>
   <mi>β</mi>
   <mrow>
    <mi>G</mi>
    <mi>M</mi>
    <mi>M</mi>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>β</ci>
    <apply>
     <times></times>
     <ci>G</ci>
     <ci>M</ci>
     <ci>M</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \beta_{GMM}
  </annotation>
 </semantics>
</math>

 expression:</p>

<p>

<math display="block" id="Instrumental_variable:37">
 <semantics>
  <mrow>
   <msub>
    <mover accent="true">
     <mi>β</mi>
     <mo>^</mo>
    </mover>
    <mi>GMM</mi>
   </msub>
   <mo>=</mo>
   <mrow>
    <msup>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <msup>
        <mi>X</mi>
        <mi mathvariant="normal">T</mi>
       </msup>
       <mi>Z</mi>
       <msup>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <msup>
           <mi>Z</mi>
           <mi mathvariant="normal">T</mi>
          </msup>
          <mi>Z</mi>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
        <mrow>
         <mo>-</mo>
         <mn>1</mn>
        </mrow>
       </msup>
       <msup>
        <mi>Z</mi>
        <mi mathvariant="normal">T</mi>
       </msup>
       <mi>X</mi>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <mrow>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </msup>
    <msup>
     <mi>X</mi>
     <mi mathvariant="normal">T</mi>
    </msup>
    <mi>Z</mi>
    <msup>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <msup>
        <mi>Z</mi>
        <mi mathvariant="normal">T</mi>
       </msup>
       <mi>Z</mi>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <mrow>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </msup>
    <msup>
     <mi>Z</mi>
     <mi mathvariant="normal">T</mi>
    </msup>
    <mi>y</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <ci>normal-^</ci>
      <ci>β</ci>
     </apply>
     <ci>GMM</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>X</ci>
        <ci>normal-T</ci>
       </apply>
       <ci>Z</ci>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <times></times>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>Z</ci>
          <ci>normal-T</ci>
         </apply>
         <ci>Z</ci>
        </apply>
        <apply>
         <minus></minus>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>Z</ci>
        <ci>normal-T</ci>
       </apply>
       <ci>X</ci>
      </apply>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>X</ci>
      <ci>normal-T</ci>
     </apply>
     <ci>Z</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>Z</ci>
        <ci>normal-T</ci>
       </apply>
       <ci>Z</ci>
      </apply>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>Z</ci>
      <ci>normal-T</ci>
     </apply>
     <ci>y</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \widehat{\beta}_{\mathrm{GMM}}=(X^{\mathrm{T}}Z(Z^{\mathrm{T}}Z)^{-1}Z^{%
\mathrm{T}}X)^{-1}X^{\mathrm{T}}Z(Z^{\mathrm{T}}Z)^{-1}Z^{\mathrm{T}}y
  </annotation>
 </semantics>
</math>

</p>

<p>In the just-identified case, we have as many instruments as covariates, so that the dimension of X is the same of Z. Hence, 

<math display="inline" id="Instrumental_variable:38">
 <semantics>
  <mrow>
   <mrow>
    <msup>
     <mi>X</mi>
     <mi mathvariant="normal">T</mi>
    </msup>
    <mi>Z</mi>
   </mrow>
   <mo>,</mo>
   <mrow>
    <msup>
     <mi>Z</mi>
     <mi mathvariant="normal">T</mi>
    </msup>
    <mi>Z</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <list>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>X</ci>
      <ci>normal-T</ci>
     </apply>
     <ci>Z</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>Z</ci>
      <ci>normal-T</ci>
     </apply>
     <ci>Z</ci>
    </apply>
   </list>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   X^{\mathrm{T}}Z,Z^{\mathrm{T}}Z
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Instrumental_variable:39">
 <semantics>
  <mrow>
   <msup>
    <mi>Z</mi>
    <mi mathvariant="normal">T</mi>
   </msup>
   <mi>X</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>Z</ci>
     <ci>normal-T</ci>
    </apply>
    <ci>X</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Z^{\mathrm{T}}X
  </annotation>
 </semantics>
</math>

 are all squared matrices of the same dimension. We can expand the inverse, using the fact that, for any invertible <em>n</em>-by-<em>n</em> matrices <strong>A</strong> and <strong>B</strong>, (<strong>AB</strong>)<sup>−1</sup> = <strong>B</strong><sup>−1</sup><strong>A</strong><sup>−1</sup> (see <a href="Invertible_matrix#Properties" title="wikilink">Invertible matrix#Properties</a>):</p>

<p>

<math display="inline" id="Instrumental_variable:40">
 <semantics>
  <msub>
   <mover accent="true">
    <mi>β</mi>
    <mo>^</mo>
   </mover>
   <mi>GMM</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <apply>
     <ci>normal-^</ci>
     <ci>β</ci>
    </apply>
    <ci>GMM</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle\widehat{\beta}_{\mathrm{GMM}}
  </annotation>
 </semantics>
</math>


 Reference: see Davidson and Mackinnnon (1993)<a class="footnoteRef" href="#fn13" id="fnref13"><sup>13</sup></a> </p>
<h2 id="interpretation-as-two-stage-least-squares">Interpretation as two-stage least squares</h2>

<p>One computational method which can be used to calculate IV estimates is two-stage least-squares (2SLS or TSLS). In the first stage, each explanatory variable that is an endogenous covariate in the equation of interest is regressed on all of the exogenous variables in the model, including both exogenous covariates in the equation of interest and the excluded instruments. The predicted values from these regressions are obtained.</p>

<p><strong>Stage 1:</strong> Regress each column of <strong>X</strong> on <strong>Z</strong>, (

<math display="inline" id="Instrumental_variable:41">
 <semantics>
  <mrow>
   <mi>X</mi>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mi>Z</mi>
     <mi>δ</mi>
    </mrow>
    <mo>+</mo>
    <mtext>errors</mtext>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>X</ci>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <ci>Z</ci>
      <ci>δ</ci>
     </apply>
     <mtext>errors</mtext>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   X=Z\delta+\text{errors}
  </annotation>
 </semantics>
</math>

)</p>

<p>

<math display="block" id="Instrumental_variable:42">
 <semantics>
  <mrow>
   <mrow>
    <mover accent="true">
     <mi>δ</mi>
     <mo>^</mo>
    </mover>
    <mo>=</mo>
    <mrow>
     <msup>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <msup>
         <mi>Z</mi>
         <mi mathvariant="normal">T</mi>
        </msup>
        <mi>Z</mi>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
      <mrow>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
     </msup>
     <msup>
      <mi>Z</mi>
      <mi mathvariant="normal">T</mi>
     </msup>
     <mi>X</mi>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <ci>normal-^</ci>
     <ci>δ</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>Z</ci>
        <ci>normal-T</ci>
       </apply>
       <ci>Z</ci>
      </apply>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>Z</ci>
      <ci>normal-T</ci>
     </apply>
     <ci>X</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \widehat{\delta}=(Z^{\mathrm{T}}Z)^{-1}Z^{\mathrm{T}}X,\,
  </annotation>
 </semantics>
</math>

</p>

<p>and save the predicted values:</p>

<p>

<math display="block" id="Instrumental_variable:43">
 <semantics>
  <mrow>
   <mrow>
    <mover accent="true">
     <mi>X</mi>
     <mo>^</mo>
    </mover>
    <mo>=</mo>
    <mrow>
     <mi>Z</mi>
     <mover accent="true">
      <mi>δ</mi>
      <mo>^</mo>
     </mover>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mi>Z</mi>
     <msup>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <msup>
         <mi>Z</mi>
         <mi mathvariant="normal">T</mi>
        </msup>
        <mi>Z</mi>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
      <mrow>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
     </msup>
     <msup>
      <mi>Z</mi>
      <mi mathvariant="normal">T</mi>
     </msup>
     <mi>X</mi>
    </mrow>
    <mo>=</mo>
    <mrow>
     <msub>
      <mi>P</mi>
      <mi>Z</mi>
     </msub>
     <mi>X</mi>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <ci>normal-^</ci>
      <ci>X</ci>
     </apply>
     <apply>
      <times></times>
      <ci>Z</ci>
      <apply>
       <ci>normal-^</ci>
       <ci>δ</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <ci>Z</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>Z</ci>
         <ci>normal-T</ci>
        </apply>
        <ci>Z</ci>
       </apply>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>Z</ci>
       <ci>normal-T</ci>
      </apply>
      <ci>X</ci>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>P</ci>
       <ci>Z</ci>
      </apply>
      <ci>X</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \widehat{X}=Z\widehat{\delta}=Z(Z^{\mathrm{T}}Z)^{-1}Z^{\mathrm{T}}X=P_{Z}X.\,
  </annotation>
 </semantics>
</math>

</p>

<p>In the second stage, the regression of interest is estimated as usual, except that in this stage each endogenous covariate is replaced with the predicted values from the first stage.</p>

<p><strong>Stage 2:</strong> Regress <strong>Y</strong> on the predicted values from the first stage:</p>

<p>

<math display="block" id="Instrumental_variable:44">
 <semantics>
  <mrow>
   <mrow>
    <mi>Y</mi>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mover accent="true">
       <mi>X</mi>
       <mo>^</mo>
      </mover>
      <mi>β</mi>
     </mrow>
     <mo>+</mo>
     <mi>noise</mi>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>Y</ci>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <apply>
       <ci>normal-^</ci>
       <ci>X</ci>
      </apply>
      <ci>β</ci>
     </apply>
     <ci>noise</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Y=\widehat{X}\beta+\mathrm{noise}.\,
  </annotation>
 </semantics>
</math>

</p>

<p>Which gives:</p>

<p>

<math display="block" id="Instrumental_variable:45">
 <semantics>
  <mrow>
   <msub>
    <mi>β</mi>
    <mrow>
     <mn>2</mn>
     <mi>S</mi>
     <mi>L</mi>
     <mi>S</mi>
    </mrow>
   </msub>
   <mo>=</mo>
   <mrow>
    <msup>
     <mrow>
      <mo>(</mo>
      <mrow>
       <msup>
        <mi>X</mi>
        <mi mathvariant="normal">T</mi>
       </msup>
       <msub>
        <mi>P</mi>
        <mi>Z</mi>
       </msub>
       <mi>X</mi>
      </mrow>
      <mo>)</mo>
     </mrow>
     <mrow>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </msup>
    <msup>
     <mi>X</mi>
     <mi mathvariant="normal">T</mi>
    </msup>
    <msub>
     <mi>P</mi>
     <mi>Z</mi>
    </msub>
    <mi>Y</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>β</ci>
     <apply>
      <times></times>
      <cn type="integer">2</cn>
      <ci>S</ci>
      <ci>L</ci>
      <ci>S</ci>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>X</ci>
        <ci>normal-T</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>P</ci>
        <ci>Z</ci>
       </apply>
       <ci>X</ci>
      </apply>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>X</ci>
      <ci>normal-T</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>P</ci>
      <ci>Z</ci>
     </apply>
     <ci>Y</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \beta_{2SLS}=\left(X^{\mathrm{T}}P_{Z}X\right)^{-1}X^{\mathrm{T}}P_{Z}Y
  </annotation>
 </semantics>
</math>

  Note that the usual OLS estimator is

<math display="block" id="Instrumental_variable:46">
 <semantics>
  <mrow>
   <msup>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <msup>
       <mover accent="true">
        <mi>X</mi>
        <mo>^</mo>
       </mover>
       <mi mathvariant="normal">T</mi>
      </msup>
      <mover accent="true">
       <mi>X</mi>
       <mo>^</mo>
      </mover>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
    <mrow>
     <mo>-</mo>
     <mn>1</mn>
    </mrow>
   </msup>
   <msup>
    <mover accent="true">
     <mi>X</mi>
     <mo>^</mo>
    </mover>
    <mi mathvariant="normal">T</mi>
   </msup>
   <mi>Y</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <ci>normal-^</ci>
        <ci>X</ci>
       </apply>
       <ci>normal-T</ci>
      </apply>
      <apply>
       <ci>normal-^</ci>
       <ci>X</ci>
      </apply>
     </apply>
     <apply>
      <minus></minus>
      <cn type="integer">1</cn>
     </apply>
    </apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <ci>normal-^</ci>
      <ci>X</ci>
     </apply>
     <ci>normal-T</ci>
    </apply>
    <ci>Y</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (\widehat{X}^{\mathrm{T}}\widehat{X})^{-1}\widehat{X}^{\mathrm{T}}Y
  </annotation>
 </semantics>
</math>

. Replacing 

<math display="inline" id="Instrumental_variable:47">
 <semantics>
  <mrow>
   <mover accent="true">
    <mi>X</mi>
    <mo>^</mo>
   </mover>
   <mo>=</mo>
   <mrow>
    <msub>
     <mi>P</mi>
     <mi>Z</mi>
    </msub>
    <mi>X</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <ci>normal-^</ci>
     <ci>X</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>P</ci>
      <ci>Z</ci>
     </apply>
     <ci>X</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \widehat{X}=P_{Z}X
  </annotation>
 </semantics>
</math>

 and noting that 

<math display="inline" id="Instrumental_variable:48">
 <semantics>
  <msub>
   <mi>P</mi>
   <mi>Z</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>P</ci>
    <ci>Z</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   P_{Z}
  </annotation>
 </semantics>
</math>

 is a symmetric and <a href="Idempotence" title="wikilink">idempotent</a> matrix, so that 

<math display="inline" id="Instrumental_variable:49">
 <semantics>
  <mrow>
   <mrow>
    <msubsup>
     <mi>P</mi>
     <mi>Z</mi>
     <mi mathvariant="normal">T</mi>
    </msubsup>
    <msub>
     <mi>P</mi>
     <mi>Z</mi>
    </msub>
   </mrow>
   <mo>=</mo>
   <mrow>
    <msub>
     <mi>P</mi>
     <mi>Z</mi>
    </msub>
    <msub>
     <mi>P</mi>
     <mi>Z</mi>
    </msub>
   </mrow>
   <mo>=</mo>
   <msub>
    <mi>P</mi>
    <mi>Z</mi>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>P</ci>
        <ci>Z</ci>
       </apply>
       <ci>normal-T</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>P</ci>
       <ci>Z</ci>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>P</ci>
       <ci>Z</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>P</ci>
       <ci>Z</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>P</ci>
      <ci>Z</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   P_{Z}^{\mathrm{T}}P_{Z}=P_{Z}P_{Z}=P_{Z}
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Instrumental_variable:50">
 <semantics>
  <mrow>
   <msub>
    <mi>β</mi>
    <mrow>
     <mn>2</mn>
     <mi>S</mi>
     <mi>L</mi>
     <mi>S</mi>
    </mrow>
   </msub>
   <mo>=</mo>
   <mrow>
    <msup>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <msup>
        <mover accent="true">
         <mi>X</mi>
         <mo>^</mo>
        </mover>
        <mi mathvariant="normal">T</mi>
       </msup>
       <mover accent="true">
        <mi>X</mi>
        <mo>^</mo>
       </mover>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <mrow>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </msup>
    <msup>
     <mover accent="true">
      <mi>X</mi>
      <mo>^</mo>
     </mover>
     <mi mathvariant="normal">T</mi>
    </msup>
    <mi>Y</mi>
   </mrow>
   <mo>=</mo>
   <mrow>
    <msup>
     <mrow>
      <mo>(</mo>
      <mrow>
       <msup>
        <mi>X</mi>
        <mi mathvariant="normal">T</mi>
       </msup>
       <msubsup>
        <mi>P</mi>
        <mi>Z</mi>
        <mi mathvariant="normal">T</mi>
       </msubsup>
       <msub>
        <mi>P</mi>
        <mi>Z</mi>
       </msub>
       <mi>X</mi>
      </mrow>
      <mo>)</mo>
     </mrow>
     <mrow>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </msup>
    <msup>
     <mi>X</mi>
     <mi mathvariant="normal">T</mi>
    </msup>
    <msubsup>
     <mi>P</mi>
     <mi>Z</mi>
     <mi mathvariant="normal">T</mi>
    </msubsup>
    <mi>Y</mi>
   </mrow>
   <mo>=</mo>
   <mrow>
    <msup>
     <mrow>
      <mo>(</mo>
      <mrow>
       <msup>
        <mi>X</mi>
        <mi mathvariant="normal">T</mi>
       </msup>
       <msub>
        <mi>P</mi>
        <mi>Z</mi>
       </msub>
       <mi>X</mi>
      </mrow>
      <mo>)</mo>
     </mrow>
     <mrow>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </msup>
    <msup>
     <mi>X</mi>
     <mi mathvariant="normal">T</mi>
    </msup>
    <msub>
     <mi>P</mi>
     <mi>Z</mi>
    </msub>
    <mi>Y</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>β</ci>
      <apply>
       <times></times>
       <cn type="integer">2</cn>
       <ci>S</ci>
       <ci>L</ci>
       <ci>S</ci>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <ci>normal-^</ci>
          <ci>X</ci>
         </apply>
         <ci>normal-T</ci>
        </apply>
        <apply>
         <ci>normal-^</ci>
         <ci>X</ci>
        </apply>
       </apply>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <ci>normal-^</ci>
        <ci>X</ci>
       </apply>
       <ci>normal-T</ci>
      </apply>
      <ci>Y</ci>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>X</ci>
         <ci>normal-T</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>P</ci>
          <ci>Z</ci>
         </apply>
         <ci>normal-T</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>P</ci>
         <ci>Z</ci>
        </apply>
        <ci>X</ci>
       </apply>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>X</ci>
       <ci>normal-T</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>P</ci>
        <ci>Z</ci>
       </apply>
       <ci>normal-T</ci>
      </apply>
      <ci>Y</ci>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>X</ci>
         <ci>normal-T</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>P</ci>
         <ci>Z</ci>
        </apply>
        <ci>X</ci>
       </apply>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>X</ci>
       <ci>normal-T</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>P</ci>
       <ci>Z</ci>
      </apply>
      <ci>Y</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \beta_{2SLS}=(\widehat{X}^{\mathrm{T}}\widehat{X})^{-1}\widehat{X}^{\mathrm{T}%
}Y=\left(X^{\mathrm{T}}P_{Z}^{\mathrm{T}}P_{Z}X\right)^{-1}X^{\mathrm{T}}P_{Z}%
^{\mathrm{T}}Y=\left(X^{\mathrm{T}}P_{Z}X\right)^{-1}X^{\mathrm{T}}P_{Z}Y
  </annotation>
 </semantics>
</math>

 </p>

<p>The resulting estimator of 

<math display="inline" id="Instrumental_variable:51">
 <semantics>
  <mi>β</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>β</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \beta
  </annotation>
 </semantics>
</math>

 is numerically identical to the expression displayed above. A small correction must be made to the sum-of-squared residuals in the second-stage fitted model in order that the covariance matrix of 

<math display="inline" id="Instrumental_variable:52">
 <semantics>
  <mi>β</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>β</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \beta
  </annotation>
 </semantics>
</math>

 is calculated correctly.</p>
<h2 id="identification">Identification</h2>

<p>In the instrumental variable regression, if we have multiple endogenous regressors 

<math display="inline" id="Instrumental_variable:53">
 <semantics>
  <mrow>
   <msub>
    <mi>x</mi>
    <mn>1</mn>
   </msub>
   <mi mathvariant="normal">…</mi>
   <msub>
    <mi>x</mi>
    <mi>k</mi>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>x</ci>
     <cn type="integer">1</cn>
    </apply>
    <ci>normal-…</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>x</ci>
     <ci>k</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x_{1}\dots x_{k}
  </annotation>
 </semantics>
</math>

 and multiple instruments 

<math display="inline" id="Instrumental_variable:54">
 <semantics>
  <mrow>
   <msub>
    <mi>z</mi>
    <mn>1</mn>
   </msub>
   <mi mathvariant="normal">…</mi>
   <msub>
    <mi>z</mi>
    <mi>m</mi>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>z</ci>
     <cn type="integer">1</cn>
    </apply>
    <ci>normal-…</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>z</ci>
     <ci>m</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   z_{1}\dots z_{m}
  </annotation>
 </semantics>
</math>

 the coefficients on the endogenous regressors 

<math display="inline" id="Instrumental_variable:55">
 <semantics>
  <mrow>
   <msub>
    <mi>β</mi>
    <mn>1</mn>
   </msub>
   <mi mathvariant="normal">…</mi>
   <msub>
    <mi>β</mi>
    <mi>k</mi>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>β</ci>
     <cn type="integer">1</cn>
    </apply>
    <ci>normal-…</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>β</ci>
     <ci>k</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \beta_{1}\dots\beta_{k}
  </annotation>
 </semantics>
</math>

are said to be:</p>

<p><a href="Identifiability" title="wikilink">Exactly identified</a> if <em>m</em> = <em>k</em>.<br/>
<strong>Overidentified</strong> if <em>m</em> &gt; <em>k</em>.<br/>
<a href="Parameter_identification_problem" title="wikilink">Underidentified</a> if <em>m</em> Z can still be defined through the equations:</p>

<p>

<math display="block" id="Instrumental_variable:56">
 <semantics>
  <mrow>
   <mi>x</mi>
   <mo>=</mo>
   <mrow>
    <mi>g</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>z</mi>
     <mo>,</mo>
     <mi>u</mi>
     <mo rspace="4.2pt" stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>x</ci>
    <apply>
     <times></times>
     <ci>g</ci>
     <interval closure="open">
      <ci>z</ci>
      <ci>u</ci>
     </interval>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x=g(z,u)\,
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Instrumental_variable:57">
 <semantics>
  <mrow>
   <mi>y</mi>
   <mo>=</mo>
   <mrow>
    <mi>f</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>x</mi>
     <mo>,</mo>
     <mi>u</mi>
     <mo rspace="4.2pt" stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>y</ci>
    <apply>
     <times></times>
     <ci>f</ci>
     <interval closure="open">
      <ci>x</ci>
      <ci>u</ci>
     </interval>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   y=f(x,u)\,
  </annotation>
 </semantics>
</math>

</p>

<p>where 

<math display="inline" id="Instrumental_variable:58">
 <semantics>
  <mi>f</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>f</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Instrumental_variable:59">
 <semantics>
  <mi>g</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>g</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   g
  </annotation>
 </semantics>
</math>

 are two arbitrary functions and 

<math display="inline" id="Instrumental_variable:60">
 <semantics>
  <mi>Z</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>Z</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Z
  </annotation>
 </semantics>
</math>

 is independent of 

<math display="inline" id="Instrumental_variable:61">
 <semantics>
  <mi>U</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>U</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   U
  </annotation>
 </semantics>
</math>

. Unlike linear models, however, measurements of 

<math display="inline" id="Instrumental_variable:62">
 <semantics>
  <mrow>
   <mi>Z</mi>
   <mo>,</mo>
   <mi>X</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <list>
    <ci>Z</ci>
    <ci>X</ci>
   </list>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Z,X
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Instrumental_variable:63">
 <semantics>
  <mi>Y</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>Y</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Y
  </annotation>
 </semantics>
</math>

 do not allow for the identification of the average causal effect of 

<math display="inline" id="Instrumental_variable:64">
 <semantics>
  <mi>X</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>X</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   X
  </annotation>
 </semantics>
</math>

 on 

<math display="inline" id="Instrumental_variable:65">
 <semantics>
  <mi>Y</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>Y</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Y
  </annotation>
 </semantics>
</math>

, denoted ACE</p>

<p>

<math display="block" id="Instrumental_variable:66">
 <semantics>
  <mrow>
   <mrow>
    <mtext>ACE</mtext>
    <mo>=</mo>
    <mrow>
     <mi>Pr</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>y</mi>
      <mo>∣</mo>
      <mrow>
       <mtext>do</mtext>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>x</mi>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <msub>
      <mo>E</mo>
      <mi>u</mi>
     </msub>
     <mrow>
      <mo stretchy="false">[</mo>
      <mrow>
       <mi>f</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>x</mi>
        <mo>,</mo>
        <mi>u</mi>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
      <mo stretchy="false">]</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <mtext>ACE</mtext>
     <apply>
      <ci>Pr</ci>
      <ci>y</ci>
      <apply>
       <times></times>
       <mtext>do</mtext>
       <ci>x</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>normal-E</ci>
       <ci>u</ci>
      </apply>
      <apply>
       <times></times>
       <ci>f</ci>
       <interval closure="open">
        <ci>x</ci>
        <ci>u</ci>
       </interval>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \text{ACE}=\Pr(y\mid\text{do}(x))=\operatorname{E}_{u}[f(x,u)].
  </annotation>
 </semantics>
</math>

 Balke and Pearl [1997] derived tight bounds on ACE and showed that these can provide valuable information on the sign and size of ACE.<a class="footnoteRef" href="#fn14" id="fnref14"><sup>14</sup></a></p>

<p>In linear analysis, there is no test to falsify the assumption the 

<math display="inline" id="Instrumental_variable:67">
 <semantics>
  <mi>Z</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>Z</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Z
  </annotation>
 </semantics>
</math>

 is instrumental relative to the pair 

<math display="inline" id="Instrumental_variable:68">
 <semantics>
  <mrow>
   <mo stretchy="false">(</mo>
   <mi>X</mi>
   <mo>,</mo>
   <mi>Y</mi>
   <mo stretchy="false">)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <interval closure="open">
    <ci>X</ci>
    <ci>Y</ci>
   </interval>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (X,Y)
  </annotation>
 </semantics>
</math>

. This is not the case when 

<math display="inline" id="Instrumental_variable:69">
 <semantics>
  <mi>X</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>X</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   X
  </annotation>
 </semantics>
</math>

 is discrete. Pearl (2000) has shown that, for all 

<math display="inline" id="Instrumental_variable:70">
 <semantics>
  <mi>f</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>f</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Instrumental_variable:71">
 <semantics>
  <mi>g</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>g</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   g
  </annotation>
 </semantics>
</math>

, the following constraint, called "Instrumental Inequality" must hold whenever 

<math display="inline" id="Instrumental_variable:72">
 <semantics>
  <mi>Z</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>Z</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Z
  </annotation>
 </semantics>
</math>

 satisfies the two equations above:<a class="footnoteRef" href="#fn15" id="fnref15"><sup>15</sup></a></p>

<p>

<math display="block" id="Instrumental_variable:73">
 <semantics>
  <mrow>
   <mrow>
    <munder>
     <mi>max</mi>
     <mi>x</mi>
    </munder>
    <mrow>
     <munder>
      <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
      <mi>y</mi>
     </munder>
     <mrow>
      <mo stretchy="false">[</mo>
      <mrow>
       <munder>
        <mi>max</mi>
        <mi>z</mi>
       </munder>
       <mrow>
        <mi>Pr</mi>
        <mrow>
         <mo stretchy="false">(</mo>
         <mi>y</mi>
         <mo>,</mo>
         <mi>x</mi>
         <mo>∣</mo>
         <mi>z</mi>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
      </mrow>
      <mo stretchy="false">]</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>≤</mo>
   <mn>1.</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <leq></leq>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <max></max>
      <ci>x</ci>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <ci>y</ci>
      </apply>
      <apply>
       <csymbol cd="latexml">delimited-[]</csymbol>
       <apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <max></max>
         <ci>z</ci>
        </apply>
        <apply>
         <ci>Pr</ci>
         <ci>y</ci>
         <ci>x</ci>
         <ci>z</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
    <cn type="float">1.</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \max_{x}\sum_{y}[\max_{z}\Pr(y,x\mid z)]\leq 1.
  </annotation>
 </semantics>
</math>

</p>
<h2 id="on-the-interpretation-of-iv-estimates">On the interpretation of IV estimates</h2>

<p>The exposition above assumes that the causal effect of interest does not vary across observations, that is, that 

<math display="inline" id="Instrumental_variable:74">
 <semantics>
  <mi>β</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>β</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \beta
  </annotation>
 </semantics>
</math>

 is a constant. Generally, different subjects will respond in different ways to changes in the "treatment" <em>x</em>. When this possibility is recognized, the average effect in the population of a change in <em>x</em> on <em>y</em> may differ from the effect in a given subpopulation. For example, the average effect of a job training program may substantially differ across the group of people who actually receive the training and the group which chooses not to receive training. For these reasons, IV methods invoke implicit assumptions on behavioral response, or more generally assumptions over the correlation between the response to treatment and propensity to receive treatment.<a class="footnoteRef" href="#fn16" id="fnref16"><sup>16</sup></a></p>

<p>The standard IV estimator can recover local average treatment effects (LATE) rather than <a href="average_treatment_effects" title="wikilink">average treatment effects</a> (ATE).<a class="footnoteRef" href="#fn17" id="fnref17"><sup>17</sup></a> Imbens and Angrist (1994) demonstrate that the linear IV estimate can be interpreted under weak conditions as a weighted average of local average treatment effects, where the weights depend on the elasticity of the endogenous regressor to changes in the instrumental variables. Roughly, that means that the effect of a variable is only revealed for the subpopulations affected by the observed changes in the instruments, and that subpopulations which respond most to changes in the instruments will have the largest effects on the magnitude of the IV estimate.</p>

<p>For example, if a researcher uses presence of a land-grant college as an instrument for college education in an earnings regression, she identifies the effect of college on earnings in the subpopulation which would obtain a college degree if a college is present but which would not obtain a degree if a college is not present. This empirical approach does not, without further assumptions, tell the researcher anything about the effect of college among people who would either always or never get a college degree regardless of whether a local college exists.</p>
<h2 id="potential-problems">Potential problems</h2>

<p>Instrumental variables estimates are generally inconsistent if the instruments are correlated with the error term in the equation of interest. Another problem is caused by the selection of "weak" instruments, instruments that are poor predictors of the endogenous question predictor in the first-stage equation.<a class="footnoteRef" href="#fn18" id="fnref18"><sup>18</sup></a> In this case, the prediction of the question predictor by the instrument will be poor and the predicted values will have very little variation. Consequently, they are unlikely to have much success in predicting the ultimate outcome when they are used to replace the question predictor in the second-stage equation.</p>

<p>In the context of the smoking and health example discussed above, tobacco taxes are weak instruments for smoking if smoking status is largely unresponsive to changes in taxes. If higher taxes do not induce people to quit smoking (or not start smoking), then variation in tax rates tells us nothing about the effect of smoking on health. If taxes affect health through channels other than through their effect on smoking, then the instruments are invalid and the instrumental variables approach may yield misleading results. For example, places and times with relatively health-conscious populations may both implement high tobacco taxes and exhibit better health even holding smoking rates constant, so we would observe a correlation between health and tobacco taxes even if it were the case that smoking has no effect on health. In this case, we would be mistaken to infer a causal effect of smoking on health from the observed correlation between tobacco taxes and health.</p>
<h2 id="sampling-properties-and-hypothesis-testing">Sampling properties and hypothesis testing</h2>

<p>When the covariates are exogenous, the small-sample properties of the OLS estimator can be derived in a straightforward manner by calculating moments of the estimator conditional on <em>X</em>. When some of the covariates are endogenous so that instrumental variables estimation is implemented, simple expressions for the moments of the estimator cannot be so obtained. Generally, instrumental variables estimators only have desirable asymptotic, not finite sample, properties, and inference is based on asymptotic approximations to the sampling distribution of the estimator. Even when the instruments are uncorrelated with the error in the equation of interest and when the instruments are not weak, the finite sample properties of the instrumental variables estimator may be poor. For example, exactly identified models produce finite sample estimators with no moments, so the estimator can be said to be neither biased nor unbiased, the nominal size of test statistics may be substantially distorted, and the estimates may commonly be far away from the true value of the parameter.<a class="footnoteRef" href="#fn19" id="fnref19"><sup>19</sup></a></p>
<h2 id="testing-instrument-strength-and-overidentifying-restrictions">Testing instrument strength and overidentifying restrictions</h2>

<p>The strength of the instruments can be directly assessed because both the endogenous covariates and the instruments are observable.<a class="footnoteRef" href="#fn20" id="fnref20"><sup>20</sup></a> A common rule of thumb for models with one endogenous regressor is: the <a href="F-test" title="wikilink">F-statistic</a> against the <a href="Null_hypothesis" title="wikilink">null</a> that the excluded instruments are irrelevant in the first-stage regression should be larger than 10.</p>

<p>The assumption that the instruments are not correlated with the error term in the equation of interest is not testable in exactly identified models. If the model is overidentified, there is information available which may be used to test this assumption. The most common test of these <em>overidentifying restrictions</em>, called the <a href="Sargan_test" title="wikilink">Sargan test</a>, is based on the observation that the residuals should be uncorrelated with the set of exogenous variables if the instruments are truly exogenous. The Sargan test statistic can be calculated as 

<math display="inline" id="Instrumental_variable:75">
 <semantics>
  <mrow>
   <mi>T</mi>
   <msup>
    <mi>R</mi>
    <mn>2</mn>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>T</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>R</ci>
     <cn type="integer">2</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   TR^{2}
  </annotation>
 </semantics>
</math>

 (the number of observations multiplied by the <a href="coefficient_of_determination" title="wikilink">coefficient of determination</a>) from the OLS regression of the residuals onto the set of exogenous variables. This statistic will be asymptotically chi-squared with <em>m</em> − <em>k</em> degrees of freedom under the null that the error term is uncorrelated with the instruments.</p>
<h2 id="references">References</h2>
<h2 id="further-reading">Further reading</h2>
<ul>
<li></li>
<li></li>
<li></li>
</ul>
<h2 id="external-links">External links</h2>
<ul>
<li><a href="http://www.urban.org/toolkit/data-methods/instrumental.cfm">Layman's explanation</a> of instrumental variables.</li>
<li><a href="http://emlab.berkeley.edu/users/mcfadden/e240b_f01/ch4.pdf">Chapter</a> from <a href="Daniel_McFadden" title="wikilink">Daniel McFadden</a>'s textbook</li>
<li>

<p>by <a href="Mark_Thoma" title="wikilink">Mark Thoma</a>.</p></li>
<li>

<p>by Mark Thoma</p></li>
</ul>

<p>"</p>

<p><a href="Category:Regression_analysis" title="wikilink">Category:Regression analysis</a> <a href="Category:Simultaneous_equation_methods_(econometrics)" title="wikilink">Category:Simultaneous equation methods (econometrics)</a> <a href="Category:Mathematical_and_quantitative_methods_(economics)" title="wikilink">Category:Mathematical and quantitative methods (economics)</a> <a class="uri" href="Category:Econometrics" title="wikilink">Category:Econometrics</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1"><a href="#fnref1">↩</a></li>
<li id="fn2"><a href="#fnref2">↩</a></li>
<li id="fn3"><a href="#fnref3">↩</a></li>
<li id="fn4"><a href="#fnref4">↩</a></li>
<li id="fn5"><a href="#fnref5">↩</a></li>
<li id="fn6"><a href="#fnref6">↩</a></li>
<li id="fn7"><a href="#fnref7">↩</a></li>
<li id="fn8"><a href="#fnref8">↩</a></li>
<li id="fn9"></li>
<li id="fn10"><a href="#fnref10">↩</a></li>
<li id="fn11"><a href="#fnref11">↩</a></li>
<li id="fn12"><a href="#fnref12">↩</a></li>
<li id="fn13"><a href="#fnref13">↩</a></li>
<li id="fn14"><a href="#fnref14">↩</a></li>
<li id="fn15"></li>
<li id="fn16"><a href="#fnref16">↩</a></li>
<li id="fn17"></li>
<li id="fn18"><a href="#fnref18">↩</a></li>
<li id="fn19"><a href="#fnref19">↩</a></li>
<li id="fn20"><a href="#fnref20">↩</a></li>
</ol>
</section>
</body>
</html>

<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="1822">Statistical ensemble (mathematical physics)</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Statistical ensemble (mathematical physics)</h1>
<hr/>

<p>In <a href="mathematical_physics" title="wikilink">mathematical physics</a>, especially as introduced into <a href="statistical_mechanics" title="wikilink">statistical mechanics</a> and <a class="uri" href="thermodynamics" title="wikilink">thermodynamics</a> by <a href="Willard_Gibbs" title="wikilink">J. Willard Gibbs</a> in 1902, an <strong>ensemble</strong> (also <strong>statistical ensemble</strong>) is an idealization consisting of a large number of virtual copies (sometimes infinitely many) of a <a class="uri" href="system" title="wikilink">system</a>, considered all at once, each of which represents a possible state that the real system might be in. In other words, a statistical ensemble is a probability distribution for the state of the system.<a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a></p>

<p>A <strong>thermodynamic ensemble</strong> is a specific variety of statistical ensemble that, among other properties, is in statistical equilibrium (defined below), and is used to derive the properties of <a href="thermodynamic_system" title="wikilink">thermodynamic systems</a> from the laws of classical or quantum mechanics.<a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a><a class="footnoteRef" href="#fn3" id="fnref3"><sup>3</sup></a></p>

<p>This article treats the notion of ensembles in a mathematically rigorous fashion, although relevant physical aspects will be mentioned.</p>
<h2 id="physical-considerations">Physical considerations</h2>

<p>The ensemble formalises the notion that an experimenter repeating an experiment again and again under the same macroscopic conditions, but unable to control the microscopic details, may expect to observe a range of different outcomes.</p>

<p>The notional size of ensembles in thermodynamics, statistical mechanics and <a href="quantum_statistical_mechanics" title="wikilink">quantum statistical mechanics</a> can be very large indeed, to include every possible <a href="microstate_(statistical_mechanics)" title="wikilink">microscopic state</a> the system could be in, consistent with its observed <a class="uri" href="macroscopic" title="wikilink">macroscopic</a> properties. But for important physical cases it can be possible to calculate averages directly over the whole of the thermodynamic ensemble, to obtain explicit formulas for many of the thermodynamic quantities of interest, often in terms of the appropriate <a href="partition_function_(mathematics)" title="wikilink">partition function</a> (see below). Some of these results are presented in the <a href="statistical_mechanics" title="wikilink">statistical mechanics</a> article.</p>

<p>The concept of an equilibrium or stationary ensemble is crucial to some applications of statistical ensembles. Although a mechanical system certainly evolves over time, the ensemble does not necessarily have to evolve. In fact, the ensemble will not evolve if it equally contains all past and future phases of the system. Such a statistical ensemble, that does not change over time, is called <em>stationary</em> or said to be in <em>statistical equilibrium</em>.<a class="footnoteRef" href="#fn4" id="fnref4"><sup>4</sup></a></p>
<h3 id="note-on-terminology">Note on terminology</h3>
<ul>
<li>The word "ensemble" is also used for a smaller set of possibilities <a href="sample_(statistics)" title="wikilink">sampled</a> from the full set of possible states. For example, a collection of <a href="random_walk" title="wikilink">walkers</a> in a <a href="Markov_chain_Monte_Carlo" title="wikilink">Markov chain Monte Carlo</a> iteration is called an ensemble in some literature.</li>
</ul>
<ul>
<li>The term "ensemble" is often used in physics and physics-influenced literature. In <a href="probability_theory" title="wikilink">probability theory</a> literature the term <a href="probability_space" title="wikilink">probability space</a> is more prevalent.</li>
</ul>
<h2 id="principal-ensembles-of-statistical-thermodynamics">Principal ensembles of statistical thermodynamics</h2>

<p>The study of thermodynamics is concerned with systems which appear to human perception to be "static" (despite the motion of their internal parts), and which can be described simply by a set of macroscopically observable variables. These systems can be described by statistical ensembles that depend on a few observable parameters, and which are in statistical equilibrium. Gibbs noted that different macroscopic constraints lead to different types of ensembles, with particular statistical characteristics. Three important thermodynamic ensembles were defined by Gibbs:<a class="footnoteRef" href="#fn5" id="fnref5"><sup>5</sup></a></p>
<ul>
<li><a href="Microcanonical_ensemble" title="wikilink">Microcanonical ensemble</a> or <em>NVE</em> ensemble—a statistical ensemble where the total energy of the system and the number of particles in the system are each fixed to particular values; each of the members of the ensemble are required to have the same total energy and particle number. The system must remain totally isolated (unable to exchange energy or particles with its environment) in order to stay in statistical equilibrium.<a class="footnoteRef" href="#fn6" id="fnref6"><sup>6</sup></a></li>
</ul>
<ul>
<li><a href="Canonical_ensemble" title="wikilink">Canonical ensemble</a> or <em>NVT</em> ensemble—a statistical ensemble where the energy is not known exactly but the number of particles is fixed. In place of energy, the <a class="uri" href="temperature" title="wikilink">temperature</a> is specified. The canonical ensemble is appropriate for describing a closed system which is in, or has been in, weak thermal contact with a heat bath. In order to be in statistical equilibrium the system must remain totally closed (unable to exchange particles with its environment), and may come into weak thermal contact with other systems that are described by ensembles with the same temperature.<a class="footnoteRef" href="#fn7" id="fnref7"><sup>7</sup></a></li>
</ul>
<ul>
<li><a href="Grand_canonical_ensemble" title="wikilink">Grand canonical ensemble</a> or <em>µVT</em> ensemble—a statistical ensemble where neither the energy nor particle number are fixed. In their place, the temperature and <a href="chemical_potential" title="wikilink">chemical potential</a> are specified. The grand canonical ensemble is appropriate for describing an open system: one which is in, or has been in, weak contact with a reservoir (thermal contact, chemical contact, radiative contact, electrical contact, etc.). The ensemble remains in statistical equilibrium if the system comes into weak contact with other systems that are described by ensembles with the same temperature and chemical potential.<a class="footnoteRef" href="#fn8" id="fnref8"><sup>8</sup></a></li>
</ul>

<p>The calculations that can be made over each of these ensembles are explored further in their respective articles. Other thermodynamic ensembles can be also defined, corresponding to different physical requirements, for which analogous formulae can often similarly be derived.</p>
<h2 id="representations-for-statistical-ensembles-in-statistical-mechanics">Representations for statistical ensembles in statistical mechanics</h2>

<p>The precise mathematical expression for a statistical ensemble has a distinct form depending on the type of mechanics under consideration (quantum or classical). In each case the ensemble is a probability distribution over microstates, but the notion of a "microstate" is considerably different. In quantum mechanics, a set of <a href="Hilbert_space" title="wikilink">Hilbert space</a> basis vectors can be used as microstates, however the ensemble might also include superpositions of these microstates. In classical mechanics, the ensemble is instead written as a probability distribution in <a href="phase_space" title="wikilink">phase space</a>; the microstates are the result of partitioning phase space into equal-sized units, although the size of these units can be chosen somewhat arbitrarily.</p>
<h3 id="requirements-for-representations">Requirements for representations</h3>

<p>Putting aside for the moment the question of how statistical ensembles are generated <a href="operational_definition" title="wikilink">operationally</a>, we should be able to perform the following two operations on ensembles <em>A</em>, <em>B</em> of the same system:</p>
<ul>
<li>Test whether <em>A</em>, <em>B</em> are statistically equivalent.</li>
</ul>
<ul>
<li>If <em>p</em> is a real number such that 0 &lt; <em>p</em> &lt; 1, then produce a new ensemble by probabilistic sampling from <em>A</em> with probability <em>p</em> and from <em>B</em> with probability <em>1 – p</em>.</li>
</ul>

<p>Under certain conditions therefore, <a href="equivalence_class" title="wikilink">equivalence classes</a> of statistical ensembles have the structure of a convex set.</p>
<h3 id="quantum-mechanical">Quantum mechanical</h3>

<p>A statistical ensemble in quantum mechanics is most often represented by a <a href="density_matrix" title="wikilink">density matrix</a>, denoted by 

<math display="inline" id="Statistical_ensemble_(mathematical_physics):0">
 <semantics>
  <mi>ρ̂</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>ρ̂</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   ρ̂
  </annotation>
 </semantics>
</math>

. The density matrix provides a fully general tool that can incorporate both quantum uncertainties (due to superposition) and classical uncertainties (due to lack of knowledge), in a consistent manner. Any physical observable 

<math display="inline" id="Statistical_ensemble_(mathematical_physics):1">
 <semantics>
  <mi>X</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>X</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   X
  </annotation>
 </semantics>
</math>

 in quantum mechanics can be written as an operator, 

<math display="inline" id="Statistical_ensemble_(mathematical_physics):2">
 <semantics>
  <mi>X̂</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>X̂</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   X̂
  </annotation>
 </semantics>
</math>

. The expectation value of this operator is given by a <a href="trace_(linear_algebra)" title="wikilink">trace</a>:</p>

<p>

<math display="block" id="Statistical_ensemble_(mathematical_physics):3">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mo stretchy="false">⟨</mo>
     <mi>X</mi>
     <mo stretchy="false">⟩</mo>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mo>Tr</mo>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mover accent="true">
        <mi>X</mi>
        <mo stretchy="false">^</mo>
       </mover>
       <mi>ρ</mi>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="latexml">delimited-⟨⟩</csymbol>
     <ci>X</ci>
    </apply>
    <apply>
     <ci>Tr</ci>
     <apply>
      <times></times>
      <apply>
       <ci>normal-^</ci>
       <ci>X</ci>
      </apply>
      <ci>ρ</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \langle X\rangle=\operatorname{Tr}(\hat{X}\rho).
  </annotation>
 </semantics>
</math>

 This can be used to evaluate averages (operator 

<math display="inline" id="Statistical_ensemble_(mathematical_physics):4">
 <semantics>
  <mi>X̂</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>X̂</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   X̂
  </annotation>
 </semantics>
</math>

), <a href="variance" title="wikilink">variances</a> (using operator <mtpl></mtpl>), <a href="covariance" title="wikilink">covariances</a> (using operator 

<math display="inline" id="Statistical_ensemble_(mathematical_physics):5">
 <semantics>
  <mrow>
   <mi>X̂</mi>
   <mi>Ŷ</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>X̂</ci>
    <ci>Ŷ</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   X̂Ŷ
  </annotation>
 </semantics>
</math>

), etc. The density matrix must always have a trace of 1: 

<math display="inline" id="Statistical_ensemble_(mathematical_physics):6">
 <semantics>
  <mrow>
   <mrow>
    <mi>T</mi>
    <mi>r</mi>
    <mi>ρ̂</mi>
   </mrow>
   <mo>=</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>T</ci>
     <ci>r</ci>
     <ci>ρ̂</ci>
    </apply>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Trρ̂=1
  </annotation>
 </semantics>
</math>

 (this essentially is the condition that the probabilities must add up to one).</p>

<p>In general, the ensemble evolves over time according to the <a href="von_Neumann_equation" title="wikilink">von Neumann equation</a>.</p>

<p>Equilibrium ensembles (those that do not evolve over time, 

<math display="inline" id="Statistical_ensemble_(mathematical_physics):7">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mrow>
      <mi>d</mi>
      <mi>ρ̂</mi>
     </mrow>
     <mo>/</mo>
     <mi>d</mi>
    </mrow>
    <mi>t</mi>
   </mrow>
   <mo>=</mo>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <divide></divide>
      <apply>
       <times></times>
       <ci>d</ci>
       <ci>ρ̂</ci>
      </apply>
      <ci>d</ci>
     </apply>
     <ci>t</ci>
    </apply>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   dρ̂/dt=0
  </annotation>
 </semantics>
</math>

) can be written solely as a function of conserved variables. For example, the <a href="microcanonical_ensemble" title="wikilink">microcanonical ensemble</a> and <a href="canonical_ensemble" title="wikilink">canonical ensemble</a> are functions strictly of the total energy, which is measured by the total energy operator 

<math display="inline" id="Statistical_ensemble_(mathematical_physics):8">
 <semantics>
  <mi>Ĥ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>Ĥ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Ĥ
  </annotation>
 </semantics>
</math>

 (Hamiltonian). The grand canonical ensemble is further a function of the particle number, measured by the total particle number operator 

<math display="inline" id="Statistical_ensemble_(mathematical_physics):9">
 <semantics>
  <mi>N̂</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>N̂</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   N̂
  </annotation>
 </semantics>
</math>

. Such equilibrium ensembles are a <a href="diagonal_matrix" title="wikilink">diagonal matrix</a> in the orthogonal basis of states that simultaneously diagonalize each conserved variable. In <a href="bra–ket_notation" title="wikilink">bra–ket notation</a>, the density matrix is</p>

<p>

<math display="block" id="Statistical_ensemble_(mathematical_physics):10">
 <semantics>
  <mrow>
   <mover accent="true">
    <mi>ρ</mi>
    <mo stretchy="false">^</mo>
   </mover>
   <mo>=</mo>
   <mrow>
    <munder>
     <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
     <mi>i</mi>
    </munder>
    <mrow>
     <msub>
      <mi>P</mi>
      <mi>i</mi>
     </msub>
     <mrow>
      <mo fence="true" stretchy="false">|</mo>
      <msub>
       <mi>ψ</mi>
       <mi>i</mi>
      </msub>
      <mo stretchy="false">⟩</mo>
     </mrow>
     <mrow>
      <mo stretchy="false">⟨</mo>
      <msub>
       <mi>ψ</mi>
       <mi>i</mi>
      </msub>
      <mo fence="true" stretchy="false">|</mo>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <ci>normal-^</ci>
     <ci>ρ</ci>
    </apply>
    <apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <sum></sum>
      <ci>i</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>P</ci>
       <ci>i</ci>
      </apply>
      <apply>
       <csymbol cd="latexml">ket</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>ψ</ci>
        <ci>i</ci>
       </apply>
      </apply>
      <apply>
       <csymbol cd="latexml">bra</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>ψ</ci>
        <ci>i</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \hat{\rho}=\sum_{i}P_{i}|\psi_{i}\rangle\langle\psi_{i}|
  </annotation>
 </semantics>
</math>

 where the <mtpl><em>ψ</em><sub><em>i</em></sub>⟩}}</mtpl>, indexed by 

<math display="inline" id="Statistical_ensemble_(mathematical_physics):11">
 <semantics>
  <mi>i</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>i</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   i
  </annotation>
 </semantics>
</math>

, are the complete and orthogonal basis. In other words, these states can be considered to be the microstates in quantum mechanics, and the density matrix encodes a probability distribution over these microstates. (Note that in other bases, the density matrix is not necessarily diagonal.)</p>
<h3 id="classical-mechanical">Classical mechanical</h3>
<figure><b>(Figure)</b>
<figcaption>Evolution of an ensemble of <a href="Hamiltonian_mechanics" title="wikilink">classical</a> systems in <a href="phase_space" title="wikilink">phase space</a> (top). Each system consists of one massive particle in a one-dimensional <a href="potential_well" title="wikilink">potential well</a> (red curve, lower figure). The initially compact ensemble becomes swirled up over time.</figcaption>
</figure>

<p>In classical mechanics, an ensemble is represented by a probability density function defined over the system's <a href="phase_space" title="wikilink">phase space</a>.<a class="footnoteRef" href="#fn9" id="fnref9"><sup>9</sup></a> While an individual system evolves according to <a href="Hamilton's_equations" title="wikilink">Hamilton's equations</a>, the density function (the ensemble) evolves over time according to <a href="Liouville's_theorem_(Hamiltonian)" title="wikilink">Liouville's equation</a>.</p>

<p>In a <a href="Hamiltonian_mechanics" title="wikilink">mechanical system</a> with a defined number of parts, the phase space has 

<math display="inline" id="Statistical_ensemble_(mathematical_physics):12">
 <semantics>
  <mi>n</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>n</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n
  </annotation>
 </semantics>
</math>

 <a href="generalized_coordinates" title="wikilink">generalized coordinates</a> called <mtpl></mtpl>, and 

<math display="inline" id="Statistical_ensemble_(mathematical_physics):13">
 <semantics>
  <mi>n</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>n</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n
  </annotation>
 </semantics>
</math>

 associated <a href="canonical_momentum" title="wikilink">canonical momenta</a> called <mtpl></mtpl>. The ensemble is then represented by a <a href="joint_probability_density_function" title="wikilink">joint probability density function</a> <mtpl></mtpl>.</p>

<p>If the number of parts in the system is allowed to vary among the systems in the ensemble (as in a grand ensemble where the number of particles is a random quantity), then it is a probability distribution over an extended phase space that includes further variables such as particle numbers <mtpl></mtpl> (first kind of particle), <mtpl></mtpl> (second kind of particle), and so on up to <mtpl></mtpl> (the last kind of particle; 

<math display="inline" id="Statistical_ensemble_(mathematical_physics):14">
 <semantics>
  <mi>s</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>s</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   s
  </annotation>
 </semantics>
</math>

 is how many different kinds of particles there are). The ensemble is then represented by a <a href="joint_probability_density_function" title="wikilink">joint probability density function</a> <mtpl></mtpl>. The number of coordinates 

<math display="inline" id="Statistical_ensemble_(mathematical_physics):15">
 <semantics>
  <mi>n</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>n</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n
  </annotation>
 </semantics>
</math>

 varies with the numbers of particles.</p>

<p>Any mechanical quantity 

<math display="inline" id="Statistical_ensemble_(mathematical_physics):16">
 <semantics>
  <mi>X</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>X</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   X
  </annotation>
 </semantics>
</math>

 can be written as a function of the system's phase. The expectation value of any such quantity is given by an integral over the entire phase space of this quantity weighted by 

<math display="inline" id="Statistical_ensemble_(mathematical_physics):17">
 <semantics>
  <mi>ρ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>ρ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   ρ
  </annotation>
 </semantics>
</math>

:</p>

<p>

<math display="block" id="Statistical_ensemble_(mathematical_physics):18">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mo stretchy="false">⟨</mo>
     <mi>X</mi>
     <mo stretchy="false">⟩</mo>
    </mrow>
    <mo>=</mo>
    <mrow>
     <munderover>
      <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
      <mrow>
       <msub>
        <mi>N</mi>
        <mn>1</mn>
       </msub>
       <mo>=</mo>
       <mn>0</mn>
      </mrow>
      <mi mathvariant="normal">∞</mi>
     </munderover>
     <mrow>
      <mi mathvariant="normal">…</mi>
      <mrow>
       <munderover>
        <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
        <mrow>
         <msub>
          <mi>N</mi>
          <mi>s</mi>
         </msub>
         <mo>=</mo>
         <mn>0</mn>
        </mrow>
        <mi mathvariant="normal">∞</mi>
       </munderover>
       <mrow>
        <mo largeop="true" symmetric="true">∫</mo>
        <mrow>
         <mi mathvariant="normal">…</mi>
         <mrow>
          <mo largeop="true" symmetric="true">∫</mo>
          <mrow>
           <mi>ρ</mi>
           <mpadded width="+1.7pt">
            <mi>X</mi>
           </mpadded>
           <mi>d</mi>
           <msub>
            <mi>p</mi>
            <mn>1</mn>
           </msub>
           <mi mathvariant="normal">…</mi>
           <mi>d</mi>
           <msub>
            <mi>q</mi>
            <mi>n</mi>
           </msub>
          </mrow>
         </mrow>
        </mrow>
       </mrow>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="latexml">delimited-⟨⟩</csymbol>
     <ci>X</ci>
    </apply>
    <apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <apply>
        <eq></eq>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>N</ci>
         <cn type="integer">1</cn>
        </apply>
        <cn type="integer">0</cn>
       </apply>
      </apply>
      <infinity></infinity>
     </apply>
     <apply>
      <times></times>
      <ci>normal-…</ci>
      <apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <sum></sum>
         <apply>
          <eq></eq>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>N</ci>
           <ci>s</ci>
          </apply>
          <cn type="integer">0</cn>
         </apply>
        </apply>
        <infinity></infinity>
       </apply>
       <apply>
        <int></int>
        <apply>
         <times></times>
         <ci>normal-…</ci>
         <apply>
          <int></int>
          <apply>
           <times></times>
           <ci>ρ</ci>
           <ci>X</ci>
           <ci>d</ci>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <ci>p</ci>
            <cn type="integer">1</cn>
           </apply>
           <ci>normal-…</ci>
           <ci>d</ci>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <ci>q</ci>
            <ci>n</ci>
           </apply>
          </apply>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \langle X\rangle=\sum_{N_{1}=0}^{\infty}\ldots\sum_{N_{s}=0}^{\infty}\int%
\ldots\int\rho X\,dp_{1}\ldots dq_{n}.
  </annotation>
 </semantics>
</math>

 The condition of probability normalization applies, requiring</p>

<p>

<math display="block" id="Statistical_ensemble_(mathematical_physics):19">
 <semantics>
  <mrow>
   <mrow>
    <munderover>
     <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
     <mrow>
      <msub>
       <mi>N</mi>
       <mn>1</mn>
      </msub>
      <mo>=</mo>
      <mn>0</mn>
     </mrow>
     <mi mathvariant="normal">∞</mi>
    </munderover>
    <mrow>
     <mi mathvariant="normal">…</mi>
     <mrow>
      <munderover>
       <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
       <mrow>
        <msub>
         <mi>N</mi>
         <mi>s</mi>
        </msub>
        <mo>=</mo>
        <mn>0</mn>
       </mrow>
       <mi mathvariant="normal">∞</mi>
      </munderover>
      <mrow>
       <mo largeop="true" symmetric="true">∫</mo>
       <mrow>
        <mi mathvariant="normal">…</mi>
        <mrow>
         <mo largeop="true" symmetric="true">∫</mo>
         <mrow>
          <mpadded width="+1.7pt">
           <mi>ρ</mi>
          </mpadded>
          <mi>d</mi>
          <msub>
           <mi>p</mi>
           <mn>1</mn>
          </msub>
          <mi mathvariant="normal">…</mi>
          <mi>d</mi>
          <msub>
           <mi>q</mi>
           <mi>n</mi>
          </msub>
         </mrow>
        </mrow>
       </mrow>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mn>1.</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <apply>
        <eq></eq>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>N</ci>
         <cn type="integer">1</cn>
        </apply>
        <cn type="integer">0</cn>
       </apply>
      </apply>
      <infinity></infinity>
     </apply>
     <apply>
      <times></times>
      <ci>normal-…</ci>
      <apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <sum></sum>
         <apply>
          <eq></eq>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>N</ci>
           <ci>s</ci>
          </apply>
          <cn type="integer">0</cn>
         </apply>
        </apply>
        <infinity></infinity>
       </apply>
       <apply>
        <int></int>
        <apply>
         <times></times>
         <ci>normal-…</ci>
         <apply>
          <int></int>
          <apply>
           <times></times>
           <ci>ρ</ci>
           <ci>d</ci>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <ci>p</ci>
            <cn type="integer">1</cn>
           </apply>
           <ci>normal-…</ci>
           <ci>d</ci>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <ci>q</ci>
            <ci>n</ci>
           </apply>
          </apply>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
    <cn type="float">1.</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \sum_{N_{1}=0}^{\infty}\ldots\sum_{N_{s}=0}^{\infty}\int\ldots\int\rho\,dp_{1}%
\ldots dq_{n}=1.
  </annotation>
 </semantics>
</math>

</p>

<p>Phase space is a continuous space containing an infinite number of distinct physical states within any small region. In order to connect the probability <em>density</em> in phase space to a probability <em>distribution</em> over microstates, it is necessary to somehow partition the phase space into blocks that are distributed representing the different states of the system in a fair way. It turns out that the correct way to do this simply results in equal-sized blocks of canonical phase space, and so a microstate in classical mechanics is an extended region in the phase space of canonical coordinates that has a particular volume.<a class="footnoteRef" href="#fn10" id="fnref10"><sup>10</sup></a> In particular, the probability density function in phase space, 

<math display="inline" id="Statistical_ensemble_(mathematical_physics):20">
 <semantics>
  <mi>ρ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>ρ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   ρ
  </annotation>
 </semantics>
</math>

, is related to the probability distribution over microstates, 

<math display="inline" id="Statistical_ensemble_(mathematical_physics):21">
 <semantics>
  <mi>P</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>P</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   P
  </annotation>
 </semantics>
</math>

 by a factor</p>

<p>

<math display="block" id="Statistical_ensemble_(mathematical_physics):22">
 <semantics>
  <mrow>
   <mrow>
    <mi>ρ</mi>
    <mo>=</mo>
    <mrow>
     <mfrac>
      <mn>1</mn>
      <mrow>
       <msup>
        <mi>h</mi>
        <mi>n</mi>
       </msup>
       <mi>C</mi>
      </mrow>
     </mfrac>
     <mi>P</mi>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>ρ</ci>
    <apply>
     <times></times>
     <apply>
      <divide></divide>
      <cn type="integer">1</cn>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>h</ci>
        <ci>n</ci>
       </apply>
       <ci>C</ci>
      </apply>
     </apply>
     <ci>P</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \rho=\frac{1}{h^{n}C}P,
  </annotation>
 </semantics>
</math>

 where</p>
<ul>
<li>

<math display="inline" id="Statistical_ensemble_(mathematical_physics):23">
 <semantics>
  <mi>h</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>h</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   h
  </annotation>
 </semantics>
</math>

 is an arbitrary but predetermined constant with the units of 

<math display="inline" id="Statistical_ensemble_(mathematical_physics):24">
 <semantics>
  <mrow>
   <mi>e</mi>
   <mi>n</mi>
   <mi>e</mi>
   <mi>r</mi>
   <mi>g</mi>
   <mi>y</mi>
   <mi mathvariant="normal">×</mi>
   <mi>t</mi>
   <mi>i</mi>
   <mi>m</mi>
   <mi>e</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>e</ci>
    <ci>n</ci>
    <ci>e</ci>
    <ci>r</ci>
    <ci>g</ci>
    <ci>y</ci>
    <ci>normal-×</ci>
    <ci>t</ci>
    <ci>i</ci>
    <ci>m</ci>
    <ci>e</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   energy×time
  </annotation>
 </semantics>
</math>

, setting the extent of the microstate and providing correct dimensions to 

<math display="inline" id="Statistical_ensemble_(mathematical_physics):25">
 <semantics>
  <mi>ρ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>ρ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   ρ
  </annotation>
 </semantics>
</math>

.<a class="footnoteRef" href="#fn11" id="fnref11"><sup>11</sup></a></li>
<li>

<math display="inline" id="Statistical_ensemble_(mathematical_physics):26">
 <semantics>
  <mi>C</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>C</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   C
  </annotation>
 </semantics>
</math>

 is an overcounting correction factor (see below), generally dependent on the number of particles and similar concerns.</li>
</ul>

<p>Since 

<math display="inline" id="Statistical_ensemble_(mathematical_physics):27">
 <semantics>
  <mi>h</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>h</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   h
  </annotation>
 </semantics>
</math>

 can be chosen arbitrarily, the notional size of a microstate is also arbitrary. Still, the value of 

<math display="inline" id="Statistical_ensemble_(mathematical_physics):28">
 <semantics>
  <mi>h</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>h</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   h
  </annotation>
 </semantics>
</math>

 influences the offsets of quantities such as entropy and chemical potential, and so it is important to be consistent with the value of 

<math display="inline" id="Statistical_ensemble_(mathematical_physics):29">
 <semantics>
  <mi>h</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>h</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   h
  </annotation>
 </semantics>
</math>

 when comparing different systems.</p>
<h4 id="correcting-overcounting-in-phase-space">Correcting overcounting in phase space</h4>

<p>Typically, the phase space contains duplicates of the same physical state in multiple distinct locations. This is a consequence of the way that a physical state is encoded into mathematical coordinates; the simplest choice of coordinate system often allows a state to be encoded in multiple ways. An example of this is a gas of identical particles whose state is written in terms of the particles' individual positions and momenta: when two particles are exchanged, the resulting point in phase space is different, and yet it corresponds to an identical physical state of the system. It is important in statistical mechanics (a theory about physical states) to recognize that the phase space is just a mathematical construction, and to not naively overcount actual physical states when integrating over phase space. Overcounting can cause serious problems:</p>
<ul>
<li>Dependence of derived quantities (such as entropy and chemical potential) on the choice of coordinate system, since one coordinate system might show more or less overcounting than another.<a class="footnoteRef" href="#fn12" id="fnref12"><sup>12</sup></a></li>
<li>Erroneous conclusions that are inconsistent with physical experience, as in the <a href="mixing_paradox" title="wikilink">mixing paradox</a>.<a class="footnoteRef" href="#fn13" id="fnref13"><sup>13</sup></a></li>
<li>Foundational issues in defining the <a href="chemical_potential" title="wikilink">chemical potential</a> and the <a href="grand_canonical_ensemble" title="wikilink">grand canonical ensemble</a>.<a class="footnoteRef" href="#fn14" id="fnref14"><sup>14</sup></a></li>
</ul>

<p>It is in general difficult to find a coordinate system that uniquely encodes each physical state. As a result, it is usually necessary to use a coordinate system with multiple copies of each state, and then to recognize and remove the overcounting.</p>

<p>A crude way to remove the overcounting would be to manually define a subregion of phase space that includes each physical state only once, and then exclude all other parts of phase space. In a gas, for example, one could include only those phases where the particles' 

<math display="inline" id="Statistical_ensemble_(mathematical_physics):30">
 <semantics>
  <mi>x</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>x</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x
  </annotation>
 </semantics>
</math>

 coordinates are sorted in ascending order. While this would solve the problem, the resulting integral over phase space would be tedious to perform due to its unusual boundary shape. (In this case, the factor 

<math display="inline" id="Statistical_ensemble_(mathematical_physics):31">
 <semantics>
  <mi>C</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>C</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   C
  </annotation>
 </semantics>
</math>

 introduced above would be set to 

<math display="inline" id="Statistical_ensemble_(mathematical_physics):32">
 <semantics>
  <mrow>
   <mi>C</mi>
   <mo>=</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>C</ci>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   C=1
  </annotation>
 </semantics>
</math>

, and the integral would be restricted to the selected subregion of phase space.)</p>

<p>A simpler way to correct the overcounting is to integrate over all phase space, but to reduce the weight of each phase in order to exactly compensate the overcounting. This is accomplished by the factor 

<math display="inline" id="Statistical_ensemble_(mathematical_physics):33">
 <semantics>
  <mi>C</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>C</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   C
  </annotation>
 </semantics>
</math>

 introduced above, which is a whole number that represents how many ways a physical state can be represented in phase space. Its value does not vary with the continuous canonical coordinates,<a class="footnoteRef" href="#fn15" id="fnref15"><sup>15</sup></a> so overcounting can be corrected simply by integrating over the full range of canonical coordinates, then dividing the result by the overcounting factor. However, 

<math display="inline" id="Statistical_ensemble_(mathematical_physics):34">
 <semantics>
  <mi>C</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>C</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   C
  </annotation>
 </semantics>
</math>

 does vary strongly with discrete variables such as numbers of particles, and so it must be applied before summing over particle numbers.</p>

<p>As mentioned above, the classic example of this overcounting is for a fluid system containing various kinds of particles, where any two particles of the same kind are indistinguishable and exchangeable. When the state is written in terms of the particles' individual positions and momenta, then the overcounting related to the exchange of identical particles is corrected by using<a class="footnoteRef" href="#fn16" id="fnref16"><sup>16</sup></a></p>

<p>

<math display="block" id="Statistical_ensemble_(mathematical_physics):35">
 <semantics>
  <mrow>
   <mrow>
    <mi>C</mi>
    <mo>=</mo>
    <mrow>
     <mrow>
      <msub>
       <mi>N</mi>
       <mn>1</mn>
      </msub>
      <mo lspace="0pt" rspace="3.5pt">!</mo>
     </mrow>
     <mrow>
      <msub>
       <mi>N</mi>
       <mn>2</mn>
      </msub>
      <mo lspace="0pt" rspace="3.5pt">!</mo>
     </mrow>
     <mi mathvariant="normal">…</mi>
     <mrow>
      <msub>
       <mi>N</mi>
       <mi>s</mi>
      </msub>
      <mo lspace="0pt" rspace="3.5pt">!</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>C</ci>
    <apply>
     <times></times>
     <apply>
      <factorial></factorial>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>N</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <apply>
      <factorial></factorial>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>N</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
     <ci>normal-…</ci>
     <apply>
      <factorial></factorial>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>N</ci>
       <ci>s</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   C=N_{1}!N_{2}!\ldots N_{s}!.
  </annotation>
 </semantics>
</math>

 This is known as "correct Boltzmann counting".</p>
<h2 id="ensembles-in-statistics">Ensembles in statistics</h2>
<dl>
<dd>
</dd>
</dl>

<p>The formulation of statistical ensembles used in physics has now been widely adopted in other fields, in part because it has been recognized that the <a href="canonical_ensemble" title="wikilink">canonical ensemble</a> or <a href="Gibbs_measure" title="wikilink">Gibbs measure</a> serves to maximize the entropy of a system, subject to a set of constraints: this is the <a href="principle_of_maximum_entropy" title="wikilink">principle of maximum entropy</a>. This principle has now been widely applied to problems in <a class="uri" href="linguistics" title="wikilink">linguistics</a>, <a class="uri" href="robotics" title="wikilink">robotics</a>, and the like.</p>

<p>In addition, statistical ensembles in physics are often built on a <a href="principle_of_locality" title="wikilink">principle of locality</a>: that all interactions are only between neighboring atoms or nearby molecules. Thus, for example, <a href="lattice_model_(physics)" title="wikilink">lattice models</a>, such as the <a href="Ising_model" title="wikilink">Ising model</a>, model <a class="uri" href="ferromagnetic" title="wikilink">ferromagnetic</a> materials by means of nearest-neighbor interactions between spins. The statistical formulation of the principle of locality is now seen to be a form of the <a href="Markov_property" title="wikilink">Markov property</a> in the broad sense; nearest neighbors are now <a href="Markov_blanket" title="wikilink">Markov blankets</a>. Thus, the general notion of a statistical ensemble with nearest-neighbor interactions leads to <a href="Markov_random_field" title="wikilink">Markov random fields</a>, which again find broad applicability; for example in <a href="Hopfield_network" title="wikilink">Hopfield networks</a>.</p>
<h2 id="operational-interpretation">Operational interpretation</h2>

<p>In the discussion given so far, while rigorous, we have taken for granted that the notion of an ensemble is valid a priori, as is commonly done in physical context. What has not been shown is that the ensemble <em>itself</em> (not the consequent results) is a precisely defined object mathematically. For instance,</p>
<ul>
<li>It is not clear where this <em>very large set of systems</em> exists (for example, is it a <a href="gas_in_a_box" title="wikilink"><em>gas</em> of particles inside a container</a>?)</li>
</ul>
<ul>
<li>It is not clear how to physically generate an ensemble.</li>
</ul>

<p>In this section we attempt to partially answer this question.</p>

<p>Suppose we have a <em>preparation procedure</em> for a system in a physics lab: For example, the procedure might involve a physical apparatus and some protocols for manipulating the apparatus. As a result of this preparation procedure some system is produced and maintained in isolation for some small period of time. By repeating this laboratory preparation procedure we obtain a sequence of systems <em>X</em><sub>1</sub>, <em>X</em><sub>2</sub>, ....,<em>X</em><sub><em>k</em></sub>, which in our mathematical idealization, we assume is an <a href="Infinity" title="wikilink">infinite</a> sequence of systems. The systems are similar in that they were all produced in the same way. This infinite sequence is an ensemble.</p>

<p>In a laboratory setting, each one of these prepped systems might be used as input for <em>one</em> subsequent <em>testing procedure</em>. Again, the testing procedure involves a physical apparatus and some protocols; as a result of the testing procedure we obtain a <em>yes</em> or <em>no</em> answer. Given a testing procedure <em>E</em> applied to each prepared system, we obtain a sequence of values Meas (<em>E</em>, <em>X</em><sub>1</sub>), Meas (<em>E</em>, <em>X</em><sub>2</sub>), ...., Meas (<em>E</em>, <em>X</em><sub><em>k</em></sub>). Each one of these values is a 0 (or no) or a 1 (yes).</p>

<p>Assume the following time average exists:</p>

<p>

<math display="block" id="Statistical_ensemble_(mathematical_physics):36">
 <semantics>
  <mrow>
   <mrow>
    <mi>σ</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>E</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <munder>
     <mo movablelimits="false">lim</mo>
     <mrow>
      <mi>N</mi>
      <mo>→</mo>
      <mi mathvariant="normal">∞</mi>
     </mrow>
    </munder>
    <mrow>
     <mfrac>
      <mn>1</mn>
      <mi>N</mi>
     </mfrac>
     <mrow>
      <munderover>
       <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
       <mrow>
        <mi>k</mi>
        <mo>=</mo>
        <mn>1</mn>
       </mrow>
       <mi>N</mi>
      </munderover>
      <mrow>
       <mo>Meas</mo>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>E</mi>
        <mo>,</mo>
        <msub>
         <mi>X</mi>
         <mi>k</mi>
        </msub>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>σ</ci>
     <ci>E</ci>
    </apply>
    <apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <limit></limit>
      <apply>
       <ci>normal-→</ci>
       <ci>N</ci>
       <infinity></infinity>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <ci>N</ci>
      </apply>
      <apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <sum></sum>
         <apply>
          <eq></eq>
          <ci>k</ci>
          <cn type="integer">1</cn>
         </apply>
        </apply>
        <ci>N</ci>
       </apply>
       <apply>
        <ci>Meas</ci>
        <ci>E</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>X</ci>
         <ci>k</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \sigma(E)=\lim_{N\rightarrow\infty}\frac{1}{N}\sum_{k=1}^{N}\operatorname{Meas%
}(E,X_{k})
  </annotation>
 </semantics>
</math>

 For quantum mechanical systems, an important assumption made in the <a href="quantum_logic" title="wikilink">quantum logic</a> approach to quantum mechanics is the identification of <em>yes-no</em> questions to the lattice of closed subspaces of a Hilbert space. With some additional technical assumptions one can then infer that states are given by density operators <em>S</em> so that:</p>

<p>

<math display="block" id="Statistical_ensemble_(mathematical_physics):37">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>σ</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>E</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mo>Tr</mo>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mi>E</mi>
       <mi>S</mi>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>σ</ci>
     <ci>E</ci>
    </apply>
    <apply>
     <ci>Tr</ci>
     <apply>
      <times></times>
      <ci>E</ci>
      <ci>S</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \sigma(E)=\operatorname{Tr}(ES).
  </annotation>
 </semantics>
</math>

</p>

<p>We see this reflects the definition of quantum states in general: A quantum state is a mapping from the observables to their expectation values.</p>
<h2 id="see-also">See also</h2>
<ul>
<li><a href="density_matrix" title="wikilink">density matrix</a></li>
<li><a href="ensemble_(fluid_mechanics)" title="wikilink">ensemble (fluid mechanics)</a></li>
<li><a href="phase_space" title="wikilink">phase space</a></li>
<li><a href="Liouville's_theorem_(Hamiltonian)" title="wikilink">Liouville's theorem (Hamiltonian)</a></li>
<li><a href="ensemble_average" title="wikilink">ensemble average</a></li>
<li><a href="replication_(statistics)" title="wikilink">replication (statistics)</a></li>
</ul>
<h2 id="notes">Notes</h2>
<h2 id="references">References</h2>

<p>"</p>

<p><a href="Category:Concepts_in_physics" title="wikilink">Category:Concepts in physics</a> <a href="Category:Statistical_ensembles" title="wikilink"> </a> <a href="Category:Philosophy_of_thermal_and_statistical_physics" title="wikilink">Category:Philosophy of thermal and statistical physics</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1"><a href="#fnref1">↩</a></li>
<li id="fn2"><a href="#fnref2">↩</a></li>
<li id="fn3"><a href="#fnref3">↩</a></li>
<li id="fn4"></li>
<li id="fn5"></li>
<li id="fn6"></li>
<li id="fn7"></li>
<li id="fn8"></li>
<li id="fn9"></li>
<li id="fn10">This equal-volume partitioning is a consequence of <a href="Liouville's_theorem_(Hamiltonian)" title="wikilink">Liouville's theorem</a>, i. e., the principle of conservation of extension in canonical phase space for Hamiltonian mechanics. This can also be demonstrated starting with the conception of an ensemble as a multitude of systems. See Gibbs' <em>Elementary Principles</em>, Chapter I.<a href="#fnref10">↩</a></li>
<li id="fn11">(Historical note) Gibbs' original ensemble effectively set 

<math display="inline" id="Statistical_ensemble_(mathematical_physics):38">
 <semantics>
  <mrow>
   <mi>h</mi>
   <mo>=</mo>
   <mrow>
    <mn>1</mn>
    <mi>e</mi>
    <mi>n</mi>
    <mi>e</mi>
    <mi>r</mi>
    <mi>g</mi>
    <mi>y</mi>
    <mi>u</mi>
    <mi>n</mi>
    <mi>i</mi>
    <mi>t</mi>
    <mi>t</mi>
    <mi mathvariant="normal">×</mi>
    <mi mathvariant="normal">×</mi>
    <mi>t</mi>
    <mi>i</mi>
    <mi>m</mi>
    <mi>e</mi>
    <mi>u</mi>
    <mi>n</mi>
    <mi>i</mi>
    <mi>t</mi>
    <mi>t</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>h</ci>
    <apply>
     <times></times>
     <cn type="integer">1</cn>
     <ci>e</ci>
     <ci>n</ci>
     <ci>e</ci>
     <ci>r</ci>
     <ci>g</ci>
     <ci>y</ci>
     <ci>u</ci>
     <ci>n</ci>
     <ci>i</ci>
     <ci>t</ci>
     <ci>t</ci>
     <ci>normal-×</ci>
     <ci>normal-×</ci>
     <ci>t</ci>
     <ci>i</ci>
     <ci>m</ci>
     <ci>e</ci>
     <ci>u</ci>
     <ci>n</ci>
     <ci>i</ci>
     <ci>t</ci>
     <ci>t</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   h=1energyunitt××timeunitt
  </annotation>
 </semantics>
</math>

, leading to unit-dependence in the values of some thermodynamic quantities like entropy and chemical potential. Since the advent of quantum mechanics, 

<math display="inline" id="Statistical_ensemble_(mathematical_physics):39">
 <semantics>
  <mi>h</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>h</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   h
  </annotation>
 </semantics>
</math>

 is often taken to be equal to <a href="Planck's_constant" title="wikilink">Planck's constant</a> in order to obtain a semiclassical correspondence with quantum mechanics.<a href="#fnref11">↩</a></li>
<li id="fn12">In some cases the overcounting error is benign. An example is the <a href="Charts_on_SO(3)" title="wikilink">choice of coordinate system used for representing orientations of three-dimensional objects</a>. A simple encoding is the <a class="uri" href="3-sphere" title="wikilink">3-sphere</a> (e. g., unit <a href="quaternion" title="wikilink">quaternions</a>) which is a <a href="double_covering_group" title="wikilink">double cover</a>—each physical orientation can be encoded in two ways. If this encoding is used without correcting the overcounting, then the entropy will be higher by 

<math display="inline" id="Statistical_ensemble_(mathematical_physics):40">
 <semantics>
  <mrow>
   <mi>k</mi>
   <mi>l</mi>
   <mi>o</mi>
   <mi>g</mi>
   <mn>2</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>k</ci>
    <ci>l</ci>
    <ci>o</ci>
    <ci>g</ci>
    <cn type="integer">2</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   klog2
  </annotation>
 </semantics>
</math>

 per rotatable object and the chemical potential lower by 

<math display="inline" id="Statistical_ensemble_(mathematical_physics):41">
 <semantics>
  <mrow>
   <mi>k</mi>
   <mi>T</mi>
   <mi>l</mi>
   <mi>o</mi>
   <mi>g</mi>
   <mn>2</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>k</ci>
    <ci>T</ci>
    <ci>l</ci>
    <ci>o</ci>
    <ci>g</ci>
    <cn type="integer">2</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   kTlog2
  </annotation>
 </semantics>
</math>

. This does not actually lead to any observable error since it only causes unobservable offsets.<a href="#fnref12">↩</a></li>
<li id="fn13"></li>
<li id="fn14"></li>
<li id="fn15">Technically, there are some phases where the permutation of particles does not even yield a distinct specific phase: for example, two similar particles can share the exact same trajectory, internal state, etc.. However, in classical mechanics these phases only make up an infinitesimal fraction of the phase space (they have <a href="measure_(mathematics)" title="wikilink">measure</a> zero) and so they do not contribute to any volume integral in phase space.<a href="#fnref15">↩</a></li>
<li id="fn16"></li>
</ol>
</section>
</body>
</html>

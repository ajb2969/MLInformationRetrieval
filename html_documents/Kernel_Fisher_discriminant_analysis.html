<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="1648">Kernel Fisher discriminant analysis</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Kernel Fisher discriminant analysis</h1>
<hr>In [[statistics]], '''kernel Fisher discriminant analysis (KFD)''',<ref name="flda">{{cite journal|last=Mika|first=S |author2=Rätsch, G. |author3=Weston, J. |author4=Schölkopf, B. |author5=Müller, KR|title=F
<p>isher discriminant analysis with kernels|journal=Neural Networks for Signal Processing|year=1999|volume=IX|pages=41-48|doi=10.1109/NNSP.1999.788121}} also known as <strong>generalized discriminant analysis</strong><a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a> and <strong>kernel discriminant analysis</strong>,<a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a> is a kernelized version of <a href="linear_discriminant_analysis" title="wikilink">linear discriminant analysis</a>. It is named after <a href="Ronald_Fisher" title="wikilink">Ronald Fisher</a>. Using the <a href="kernel_trick" title="wikilink">kernel trick</a>, LDA is implicitly performed in a new feature space, which allows non-linear mappings to be learned.</p>
<h2 id="linear-discriminant-analysis">Linear discriminant analysis</h2>

<p>Intuitively, the idea of LDA is to find a projection where class separation is maximized. Given two sets of labeled data, 

<math display="inline" id="Kernel_Fisher_discriminant_analysis:0">
 <semantics>
  <msub>
   <mi>𝐂</mi>
   <mn>1</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>𝐂</ci>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{C}_{1}
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Kernel_Fisher_discriminant_analysis:1">
 <semantics>
  <msub>
   <mi>𝐂</mi>
   <mn>2</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>𝐂</ci>
    <cn type="integer">2</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{C}_{2}
  </annotation>
 </semantics>
</math>

, define the class means 

<math display="inline" id="Kernel_Fisher_discriminant_analysis:2">
 <semantics>
  <msub>
   <mi>𝐦</mi>
   <mn>1</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>𝐦</ci>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{m}_{1}
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Kernel_Fisher_discriminant_analysis:3">
 <semantics>
  <msub>
   <mi>𝐦</mi>
   <mn>2</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>𝐦</ci>
    <cn type="integer">2</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{m}_{2}
  </annotation>
 </semantics>
</math>


 to be</p>

<p>

<math display="block" id="Kernel_Fisher_discriminant_analysis:4">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>𝐦</mi>
     <mi>i</mi>
    </msub>
    <mo>=</mo>
    <mrow>
     <mfrac>
      <mn>1</mn>
      <msub>
       <mi>l</mi>
       <mi>i</mi>
      </msub>
     </mfrac>
     <mrow>
      <munderover>
       <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
       <mrow>
        <mi>n</mi>
        <mo>=</mo>
        <mn>1</mn>
       </mrow>
       <msub>
        <mi>l</mi>
        <mi>i</mi>
       </msub>
      </munderover>
      <msubsup>
       <mi>𝐱</mi>
       <mi>n</mi>
       <mi>i</mi>
      </msubsup>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>𝐦</ci>
     <ci>i</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <divide></divide>
      <cn type="integer">1</cn>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>l</ci>
       <ci>i</ci>
      </apply>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <apply>
         <eq></eq>
         <ci>n</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>l</ci>
        <ci>i</ci>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>𝐱</ci>
        <ci>n</ci>
       </apply>
       <ci>i</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{m}_{i}=\frac{1}{l_{i}}\sum_{n=1}^{l_{i}}\mathbf{x}_{n}^{i},
  </annotation>
 </semantics>
</math>

</p>

<p>where 

<math display="inline" id="Kernel_Fisher_discriminant_analysis:5">
 <semantics>
  <msub>
   <mi>l</mi>
   <mi>i</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>l</ci>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   l_{i}
  </annotation>
 </semantics>
</math>

 is the number of examples of class 

<math display="inline" id="Kernel_Fisher_discriminant_analysis:6">
 <semantics>
  <msub>
   <mi>𝐂</mi>
   <mi>i</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>𝐂</ci>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{C}_{i}
  </annotation>
 </semantics>
</math>

. The goal of linear discriminant analysis is to give a large separation of the class means while also keeping the in-class variance small.<a class="footnoteRef" href="#fn3" id="fnref3"><sup>3</sup></a> This is formulated as maximizing</p>

<p>

<math display="block" id="Kernel_Fisher_discriminant_analysis:7">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>J</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>𝐰</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mfrac>
     <mrow>
      <msup>
       <mi>𝐰</mi>
       <mtext>T</mtext>
      </msup>
      <msub>
       <mi>𝐒</mi>
       <mi>B</mi>
      </msub>
      <mi>𝐰</mi>
     </mrow>
     <mrow>
      <msup>
       <mi>𝐰</mi>
       <mtext>T</mtext>
      </msup>
      <msub>
       <mi>𝐒</mi>
       <mi>W</mi>
      </msub>
      <mi>𝐰</mi>
     </mrow>
    </mfrac>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>J</ci>
     <ci>𝐰</ci>
    </apply>
    <apply>
     <divide></divide>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>𝐰</ci>
       <mtext>T</mtext>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>𝐒</ci>
       <ci>B</ci>
      </apply>
      <ci>𝐰</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>𝐰</ci>
       <mtext>T</mtext>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>𝐒</ci>
       <ci>W</ci>
      </apply>
      <ci>𝐰</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   J(\mathbf{w})=\frac{\mathbf{w}^{\text{T}}\mathbf{S}_{B}\mathbf{w}}{\mathbf{w}^%
{\text{T}}\mathbf{S}_{W}\mathbf{w}},
  </annotation>
 </semantics>
</math>

</p>

<p>where 

<math display="inline" id="Kernel_Fisher_discriminant_analysis:8">
 <semantics>
  <msub>
   <mi>𝐒</mi>
   <mi>B</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>𝐒</ci>
    <ci>B</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{S}_{B}
  </annotation>
 </semantics>
</math>


 is the between-class covariance matrix and 

<math display="inline" id="Kernel_Fisher_discriminant_analysis:9">
 <semantics>
  <msub>
   <mi>𝐒</mi>
   <mi>W</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>𝐒</ci>
    <ci>W</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{S}_{W}
  </annotation>
 </semantics>
</math>

 is the total within-class covariance matrix:</p>

<p>

<math display="inline" id="Kernel_Fisher_discriminant_analysis:10">
 <semantics>
  <msub>
   <mi>𝐒</mi>
   <mi>B</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>𝐒</ci>
    <ci>B</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle\mathbf{S}_{B}
  </annotation>
 </semantics>
</math>


</p>

<p>Differentiating 

<math display="inline" id="Kernel_Fisher_discriminant_analysis:11">
 <semantics>
  <mrow>
   <mi>J</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>𝐰</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>J</ci>
    <ci>𝐰</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   J(\mathbf{w})
  </annotation>
 </semantics>
</math>

 with respect to 

<math display="inline" id="Kernel_Fisher_discriminant_analysis:12">
 <semantics>
  <mi>𝐰</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>𝐰</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{w}
  </annotation>
 </semantics>
</math>

, setting equal to zero, and rearranging gives</p>

<p>

<math display="block" id="Kernel_Fisher_discriminant_analysis:13">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <msup>
        <mi>𝐰</mi>
        <mtext>T</mtext>
       </msup>
       <msub>
        <mi>𝐒</mi>
        <mi>B</mi>
       </msub>
       <mi>𝐰</mi>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <msub>
      <mi>𝐒</mi>
      <mi>W</mi>
     </msub>
     <mi>𝐰</mi>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <msup>
        <mi>𝐰</mi>
        <mtext>T</mtext>
       </msup>
       <msub>
        <mi>𝐒</mi>
        <mi>W</mi>
       </msub>
       <mi>𝐰</mi>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <msub>
      <mi>𝐒</mi>
      <mi>B</mi>
     </msub>
     <mi>𝐰</mi>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>𝐰</ci>
       <mtext>T</mtext>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>𝐒</ci>
       <ci>B</ci>
      </apply>
      <ci>𝐰</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>𝐒</ci>
      <ci>W</ci>
     </apply>
     <ci>𝐰</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>𝐰</ci>
       <mtext>T</mtext>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>𝐒</ci>
       <ci>W</ci>
      </apply>
      <ci>𝐰</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>𝐒</ci>
      <ci>B</ci>
     </apply>
     <ci>𝐰</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (\mathbf{w}^{\text{T}}\mathbf{S}_{B}\mathbf{w})\mathbf{S}_{W}\mathbf{w}=(%
\mathbf{w}^{\text{T}}\mathbf{S}_{W}\mathbf{w})\mathbf{S}_{B}\mathbf{w}.
  </annotation>
 </semantics>
</math>

</p>

<p>Since we only care about the direction of 

<math display="inline" id="Kernel_Fisher_discriminant_analysis:14">
 <semantics>
  <mi>𝐰</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>𝐰</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{w}
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Kernel_Fisher_discriminant_analysis:15">
 <semantics>
  <mrow>
   <msub>
    <mi>𝐒</mi>
    <mi>B</mi>
   </msub>
   <mi>𝐰</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>𝐒</ci>
     <ci>B</ci>
    </apply>
    <ci>𝐰</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{S}_{B}\mathbf{w}
  </annotation>
 </semantics>
</math>

 has the same direction as 

<math display="inline" id="Kernel_Fisher_discriminant_analysis:16">
 <semantics>
  <mrow>
   <mo stretchy="false">(</mo>
   <mrow>
    <msub>
     <mi>𝐦</mi>
     <mn>2</mn>
    </msub>
    <mo>-</mo>
    <msub>
     <mi>𝐦</mi>
     <mn>1</mn>
    </msub>
   </mrow>
   <mo stretchy="false">)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <minus></minus>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>𝐦</ci>
     <cn type="integer">2</cn>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>𝐦</ci>
     <cn type="integer">1</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (\mathbf{m}_{2}-\mathbf{m}_{1})
  </annotation>
 </semantics>
</math>

 , 

<math display="inline" id="Kernel_Fisher_discriminant_analysis:17">
 <semantics>
  <mrow>
   <msub>
    <mi>𝐒</mi>
    <mi>B</mi>
   </msub>
   <mi>𝐰</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>𝐒</ci>
     <ci>B</ci>
    </apply>
    <ci>𝐰</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{S}_{B}\mathbf{w}
  </annotation>
 </semantics>
</math>

 can be replaced by 

<math display="inline" id="Kernel_Fisher_discriminant_analysis:18">
 <semantics>
  <mrow>
   <mo stretchy="false">(</mo>
   <mrow>
    <msub>
     <mi>𝐦</mi>
     <mn>2</mn>
    </msub>
    <mo>-</mo>
    <msub>
     <mi>𝐦</mi>
     <mn>1</mn>
    </msub>
   </mrow>
   <mo stretchy="false">)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <minus></minus>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>𝐦</ci>
     <cn type="integer">2</cn>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>𝐦</ci>
     <cn type="integer">1</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (\mathbf{m}_{2}-\mathbf{m}_{1})
  </annotation>
 </semantics>
</math>

 and we can drop the scalars 

<math display="inline" id="Kernel_Fisher_discriminant_analysis:19">
 <semantics>
  <mrow>
   <mo stretchy="false">(</mo>
   <mrow>
    <msup>
     <mi>𝐰</mi>
     <mtext>T</mtext>
    </msup>
    <msub>
     <mi>𝐒</mi>
     <mi>B</mi>
    </msub>
    <mi>𝐰</mi>
   </mrow>
   <mo stretchy="false">)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>𝐰</ci>
     <mtext>T</mtext>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>𝐒</ci>
     <ci>B</ci>
    </apply>
    <ci>𝐰</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (\mathbf{w}^{\text{T}}\mathbf{S}_{B}\mathbf{w})
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Kernel_Fisher_discriminant_analysis:20">
 <semantics>
  <mrow>
   <mo stretchy="false">(</mo>
   <mrow>
    <msup>
     <mi>𝐰</mi>
     <mtext>T</mtext>
    </msup>
    <msub>
     <mi>𝐒</mi>
     <mi>W</mi>
    </msub>
    <mi>𝐰</mi>
   </mrow>
   <mo stretchy="false">)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>𝐰</ci>
     <mtext>T</mtext>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>𝐒</ci>
     <ci>W</ci>
    </apply>
    <ci>𝐰</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (\mathbf{w}^{\text{T}}\mathbf{S}_{W}\mathbf{w})
  </annotation>
 </semantics>
</math>

 to give</p>

<p>

<math display="block" id="Kernel_Fisher_discriminant_analysis:21">
 <semantics>
  <mrow>
   <mrow>
    <mi>𝐰</mi>
    <mo>∝</mo>
    <mrow>
     <msubsup>
      <mi>𝐒</mi>
      <mi>W</mi>
      <mrow>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
     </msubsup>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <msub>
        <mi>𝐦</mi>
        <mn>2</mn>
       </msub>
       <mo>-</mo>
       <msub>
        <mi>𝐦</mi>
        <mn>1</mn>
       </msub>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">proportional-to</csymbol>
    <ci>𝐰</ci>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>𝐒</ci>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <ci>W</ci>
     </apply>
     <apply>
      <minus></minus>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>𝐦</ci>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>𝐦</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{w}\propto\mathbf{S}^{-1}_{W}(\mathbf{m}_{2}-\mathbf{m}_{1}).
  </annotation>
 </semantics>
</math>

</p>
<h2 id="kernel-trick-with-lda">Kernel trick with LDA</h2>

<p>To extend LDA to non-linear mappings, the data can be mapped to a new feature space, 

<math display="inline" id="Kernel_Fisher_discriminant_analysis:22">
 <semantics>
  <mi>F</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>F</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   F
  </annotation>
 </semantics>
</math>

, via some function 

<math display="inline" id="Kernel_Fisher_discriminant_analysis:23">
 <semantics>
  <mi>ϕ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>ϕ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \phi
  </annotation>
 </semantics>
</math>

. In this new feature space, the function that needs to be maximized is<a class="footnoteRef" href="#fn4" id="fnref4"><sup>4</sup></a></p>

<p>

<math display="block" id="Kernel_Fisher_discriminant_analysis:24">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>J</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>𝐰</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mfrac>
     <mrow>
      <msup>
       <mi>𝐰</mi>
       <mtext>T</mtext>
      </msup>
      <msubsup>
       <mi>𝐒</mi>
       <mi>B</mi>
       <mi>ϕ</mi>
      </msubsup>
      <mi>𝐰</mi>
     </mrow>
     <mrow>
      <msup>
       <mi>𝐰</mi>
       <mtext>T</mtext>
      </msup>
      <msubsup>
       <mi>𝐒</mi>
       <mi>W</mi>
       <mi>ϕ</mi>
      </msubsup>
      <mi>𝐰</mi>
     </mrow>
    </mfrac>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>J</ci>
     <ci>𝐰</ci>
    </apply>
    <apply>
     <divide></divide>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>𝐰</ci>
       <mtext>T</mtext>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>𝐒</ci>
        <ci>B</ci>
       </apply>
       <ci>ϕ</ci>
      </apply>
      <ci>𝐰</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>𝐰</ci>
       <mtext>T</mtext>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>𝐒</ci>
        <ci>W</ci>
       </apply>
       <ci>ϕ</ci>
      </apply>
      <ci>𝐰</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   J(\mathbf{w})=\frac{\mathbf{w}^{\text{T}}\mathbf{S}_{B}^{\phi}\mathbf{w}}{%
\mathbf{w}^{\text{T}}\mathbf{S}_{W}^{\phi}\mathbf{w}},
  </annotation>
 </semantics>
</math>

</p>

<p>where</p>

<p>

<math display="inline" id="Kernel_Fisher_discriminant_analysis:25">
 <semantics>
  <msubsup>
   <mi>𝐒</mi>
   <mi>B</mi>
   <mi>ϕ</mi>
  </msubsup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>𝐒</ci>
     <ci>B</ci>
    </apply>
    <ci>ϕ</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle\mathbf{S}_{B}^{\phi}
  </annotation>
 </semantics>
</math>


</p>

<p>and</p>

<p>

<math display="block" id="Kernel_Fisher_discriminant_analysis:26">
 <semantics>
  <mrow>
   <mrow>
    <msubsup>
     <mi>𝐦</mi>
     <mi>i</mi>
     <mi>ϕ</mi>
    </msubsup>
    <mo>=</mo>
    <mrow>
     <mfrac>
      <mn>1</mn>
      <msub>
       <mi>l</mi>
       <mi>i</mi>
      </msub>
     </mfrac>
     <mrow>
      <munderover>
       <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
       <mrow>
        <mi>j</mi>
        <mo>=</mo>
        <mn>1</mn>
       </mrow>
       <msub>
        <mi>l</mi>
        <mi>i</mi>
       </msub>
      </munderover>
      <mrow>
       <mi>ϕ</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <msubsup>
         <mi>𝐱</mi>
         <mi>j</mi>
         <mi>i</mi>
        </msubsup>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>𝐦</ci>
      <ci>i</ci>
     </apply>
     <ci>ϕ</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <divide></divide>
      <cn type="integer">1</cn>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>l</ci>
       <ci>i</ci>
      </apply>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <apply>
         <eq></eq>
         <ci>j</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>l</ci>
        <ci>i</ci>
       </apply>
      </apply>
      <apply>
       <times></times>
       <ci>ϕ</ci>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>𝐱</ci>
         <ci>j</ci>
        </apply>
        <ci>i</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{m}_{i}^{\phi}=\frac{1}{l_{i}}\sum_{j=1}^{l_{i}}\phi(\mathbf{x}_{j}^{i}).
  </annotation>
 </semantics>
</math>

</p>

<p>Further, note that 

<math display="inline" id="Kernel_Fisher_discriminant_analysis:27">
 <semantics>
  <mrow>
   <mi>𝐰</mi>
   <mo>∈</mo>
   <mi>F</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <in></in>
    <ci>𝐰</ci>
    <ci>F</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{w}\in F
  </annotation>
 </semantics>
</math>

. Explicitly computing the mappings 

<math display="inline" id="Kernel_Fisher_discriminant_analysis:28">
 <semantics>
  <mrow>
   <mi>ϕ</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>𝐱</mi>
     <mi>i</mi>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>ϕ</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>𝐱</ci>
     <ci>i</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \phi(\mathbf{x}_{i})
  </annotation>
 </semantics>
</math>

 and then performing LDA can be computationally expensive, and in many cases intractable. For example, 

<math display="inline" id="Kernel_Fisher_discriminant_analysis:29">
 <semantics>
  <mi>F</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>F</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   F
  </annotation>
 </semantics>
</math>

 may be infinitely dimensional. Thus, rather than explicitly mapping the data to 

<math display="inline" id="Kernel_Fisher_discriminant_analysis:30">
 <semantics>
  <mi>F</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>F</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   F
  </annotation>
 </semantics>
</math>

, the data can be implicitly embedded by rewriting the algorithm in terms of <a href="dot_product" title="wikilink">dot products</a> and using the <a href="kernel_trick" title="wikilink">kernel trick</a> in which the dot product in the new feature space is replaced by a kernel function, 

<math display="inline" id="Kernel_Fisher_discriminant_analysis:31">
 <semantics>
  <mrow>
   <mrow>
    <mi>k</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>𝐱</mi>
     <mo>,</mo>
     <mi>𝐲</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mrow>
      <mi>ϕ</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>𝐱</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo>⋅</mo>
     <mi>ϕ</mi>
    </mrow>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>𝐲</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>k</ci>
     <interval closure="open">
      <ci>𝐱</ci>
      <ci>𝐲</ci>
     </interval>
    </apply>
    <apply>
     <times></times>
     <apply>
      <ci>normal-⋅</ci>
      <apply>
       <times></times>
       <ci>ϕ</ci>
       <ci>𝐱</ci>
      </apply>
      <ci>ϕ</ci>
     </apply>
     <ci>𝐲</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   k(\mathbf{x},\mathbf{y})=\phi(\mathbf{x})\cdot\phi(\mathbf{y})
  </annotation>
 </semantics>
</math>

.</p>

<p>LDA can be reformulated in terms of dot products by first noting that 

<math display="inline" id="Kernel_Fisher_discriminant_analysis:32">
 <semantics>
  <mi>𝐰</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>𝐰</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{w}
  </annotation>
 </semantics>
</math>

 will have an expansion of the form<a class="footnoteRef" href="#fn5" id="fnref5"><sup>5</sup></a></p>

<p>

<math display="block" id="Kernel_Fisher_discriminant_analysis:33">
 <semantics>
  <mrow>
   <mrow>
    <mi>𝐰</mi>
    <mo>=</mo>
    <mrow>
     <munderover>
      <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
      <mrow>
       <mi>i</mi>
       <mo>=</mo>
       <mn>1</mn>
      </mrow>
      <mi>l</mi>
     </munderover>
     <mrow>
      <msub>
       <mi>α</mi>
       <mi>i</mi>
      </msub>
      <mi>ϕ</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <msub>
        <mi>𝐱</mi>
        <mi>i</mi>
       </msub>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>𝐰</ci>
    <apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <apply>
        <eq></eq>
        <ci>i</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <ci>l</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>α</ci>
       <ci>i</ci>
      </apply>
      <ci>ϕ</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>𝐱</ci>
       <ci>i</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{w}=\sum_{i=1}^{l}\alpha_{i}\phi(\mathbf{x}_{i}).
  </annotation>
 </semantics>
</math>

 Then note that</p>

<p>

<math display="block" id="Kernel_Fisher_discriminant_analysis:34">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <msup>
      <mi>𝐰</mi>
      <mtext>T</mtext>
     </msup>
     <msubsup>
      <mi>𝐦</mi>
      <mi>i</mi>
      <mi>ϕ</mi>
     </msubsup>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mfrac>
      <mn>1</mn>
      <msub>
       <mi>l</mi>
       <mi>i</mi>
      </msub>
     </mfrac>
     <mrow>
      <munderover>
       <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
       <mrow>
        <mi>j</mi>
        <mo>=</mo>
        <mn>1</mn>
       </mrow>
       <mi>l</mi>
      </munderover>
      <mrow>
       <munderover>
        <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
        <mrow>
         <mi>k</mi>
         <mo>=</mo>
         <mn>1</mn>
        </mrow>
        <msub>
         <mi>l</mi>
         <mi>i</mi>
        </msub>
       </munderover>
       <mrow>
        <msub>
         <mi>α</mi>
         <mi>j</mi>
        </msub>
        <mi>k</mi>
        <mrow>
         <mo stretchy="false">(</mo>
         <msub>
          <mi>𝐱</mi>
          <mi>j</mi>
         </msub>
         <mo>,</mo>
         <msubsup>
          <mi>𝐱</mi>
          <mi>k</mi>
          <mi>i</mi>
         </msubsup>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
      </mrow>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <msup>
      <mi>α</mi>
      <mtext>T</mtext>
     </msup>
     <msub>
      <mi>𝐌</mi>
      <mi>i</mi>
     </msub>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>𝐰</ci>
       <mtext>T</mtext>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>𝐦</ci>
        <ci>i</ci>
       </apply>
       <ci>ϕ</ci>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>l</ci>
        <ci>i</ci>
       </apply>
      </apply>
      <apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <sum></sum>
         <apply>
          <eq></eq>
          <ci>j</ci>
          <cn type="integer">1</cn>
         </apply>
        </apply>
        <ci>l</ci>
       </apply>
       <apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <sum></sum>
          <apply>
           <eq></eq>
           <ci>k</ci>
           <cn type="integer">1</cn>
          </apply>
         </apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>l</ci>
          <ci>i</ci>
         </apply>
        </apply>
        <apply>
         <times></times>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>α</ci>
          <ci>j</ci>
         </apply>
         <ci>k</ci>
         <interval closure="open">
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>𝐱</ci>
           <ci>j</ci>
          </apply>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <ci>𝐱</ci>
            <ci>k</ci>
           </apply>
           <ci>i</ci>
          </apply>
         </interval>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>α</ci>
       <mtext>T</mtext>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>𝐌</ci>
       <ci>i</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{w}^{\text{T}}\mathbf{m}_{i}^{\phi}=\frac{1}{l_{i}}\sum_{j=1}^{l}\sum_{%
k=1}^{l_{i}}\alpha_{j}k(\mathbf{x}_{j},\mathbf{x}_{k}^{i})=\mathbf{\alpha}^{%
\text{T}}\mathbf{M}_{i},
  </annotation>
 </semantics>
</math>

</p>

<p>where</p>

<p>

<math display="block" id="Kernel_Fisher_discriminant_analysis:35">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mrow>
      <mo stretchy="false">(</mo>
      <msub>
       <mi>𝐌</mi>
       <mi>i</mi>
      </msub>
      <mo stretchy="false">)</mo>
     </mrow>
     <mi>j</mi>
    </msub>
    <mo>=</mo>
    <mrow>
     <mfrac>
      <mn>1</mn>
      <msub>
       <mi>l</mi>
       <mi>i</mi>
      </msub>
     </mfrac>
     <mrow>
      <munderover>
       <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
       <mrow>
        <mi>k</mi>
        <mo>=</mo>
        <mn>1</mn>
       </mrow>
       <msub>
        <mi>l</mi>
        <mi>i</mi>
       </msub>
      </munderover>
      <mrow>
       <mi>k</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <msub>
         <mi>𝐱</mi>
         <mi>j</mi>
        </msub>
        <mo>,</mo>
        <msubsup>
         <mi>𝐱</mi>
         <mi>k</mi>
         <mi>i</mi>
        </msubsup>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>𝐌</ci>
      <ci>i</ci>
     </apply>
     <ci>j</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <divide></divide>
      <cn type="integer">1</cn>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>l</ci>
       <ci>i</ci>
      </apply>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <apply>
         <eq></eq>
         <ci>k</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>l</ci>
        <ci>i</ci>
       </apply>
      </apply>
      <apply>
       <times></times>
       <ci>k</ci>
       <interval closure="open">
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>𝐱</ci>
         <ci>j</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>𝐱</ci>
          <ci>k</ci>
         </apply>
         <ci>i</ci>
        </apply>
       </interval>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (\mathbf{M}_{i})_{j}=\frac{1}{l_{i}}\sum_{k=1}^{l_{i}}k(\mathbf{x}_{j},\mathbf%
{x}_{k}^{i}).
  </annotation>
 </semantics>
</math>

</p>

<p>The numerator of 

<math display="inline" id="Kernel_Fisher_discriminant_analysis:36">
 <semantics>
  <mrow>
   <mi>J</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>𝐰</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>J</ci>
    <ci>𝐰</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   J(\mathbf{w})
  </annotation>
 </semantics>
</math>

 can then be written as:</p>

<p>

<math display="inline" id="Kernel_Fisher_discriminant_analysis:37">
 <semantics>
  <mrow>
   <msup>
    <mi>𝐰</mi>
    <mtext>T</mtext>
   </msup>
   <msubsup>
    <mi>𝐒</mi>
    <mi>B</mi>
    <mi>ϕ</mi>
   </msubsup>
   <mi>𝐰</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>𝐰</ci>
     <mtext>T</mtext>
    </apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>𝐒</ci>
      <ci>B</ci>
     </apply>
     <ci>ϕ</ci>
    </apply>
    <ci>𝐰</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle\mathbf{w}^{\text{T}}\mathbf{S}_{B}^{\phi}\mathbf{w}
  </annotation>
 </semantics>
</math>


 where 

<math display="inline" id="Kernel_Fisher_discriminant_analysis:38">
 <semantics>
  <mrow>
   <mi>𝐌</mi>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <msub>
       <mi>𝐌</mi>
       <mn>2</mn>
      </msub>
      <mo>-</mo>
      <msub>
       <mi>𝐌</mi>
       <mn>1</mn>
      </msub>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
    <msup>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <msub>
        <mi>𝐌</mi>
        <mn>2</mn>
       </msub>
       <mo>-</mo>
       <msub>
        <mi>𝐌</mi>
        <mn>1</mn>
       </msub>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <mtext>T</mtext>
    </msup>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>𝐌</ci>
    <apply>
     <times></times>
     <apply>
      <minus></minus>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>𝐌</ci>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>𝐌</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <minus></minus>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>𝐌</ci>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>𝐌</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <mtext>T</mtext>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{M}=(\mathbf{M}_{2}-\mathbf{M}_{1})(\mathbf{M}_{2}-\mathbf{M}_{1})^{%
\text{T}}
  </annotation>
 </semantics>
</math>

. Similarly, the denominator can be written as</p>

<p>

<math display="block" id="Kernel_Fisher_discriminant_analysis:39">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <msup>
      <mi>𝐰</mi>
      <mtext>T</mtext>
     </msup>
     <msubsup>
      <mi>𝐒</mi>
      <mi>W</mi>
      <mi>ϕ</mi>
     </msubsup>
     <mi>𝐰</mi>
    </mrow>
    <mo>=</mo>
    <mrow>
     <msup>
      <mi>α</mi>
      <mtext>T</mtext>
     </msup>
     <mi>𝐍</mi>
     <mi>α</mi>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>𝐰</ci>
      <mtext>T</mtext>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>𝐒</ci>
       <ci>W</ci>
      </apply>
      <ci>ϕ</ci>
     </apply>
     <ci>𝐰</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>α</ci>
      <mtext>T</mtext>
     </apply>
     <ci>𝐍</ci>
     <ci>α</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{w}^{\text{T}}\mathbf{S}_{W}^{\phi}\mathbf{w}=\mathbf{\alpha}^{\text{T}%
}\mathbf{N}\mathbf{\alpha},
  </annotation>
 </semantics>
</math>

</p>

<p>where</p>

<p>

<math display="block" id="Kernel_Fisher_discriminant_analysis:40">
 <semantics>
  <mrow>
   <mrow>
    <mi>𝐍</mi>
    <mo>=</mo>
    <mrow>
     <munder>
      <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
      <mrow>
       <mi>j</mi>
       <mo>=</mo>
       <mrow>
        <mn>1</mn>
        <mo>,</mo>
        <mn>2</mn>
       </mrow>
      </mrow>
     </munder>
     <mrow>
      <msub>
       <mi>𝐊</mi>
       <mi>j</mi>
      </msub>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mi>𝐈</mi>
        <mo>-</mo>
        <msub>
         <mn>𝟏</mn>
         <msub>
          <mi>l</mi>
          <mi>j</mi>
         </msub>
        </msub>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
      <msubsup>
       <mi>𝐊</mi>
       <mi>j</mi>
       <mtext>T</mtext>
      </msubsup>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>𝐍</ci>
    <apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <sum></sum>
      <apply>
       <eq></eq>
       <ci>j</ci>
       <list>
        <cn type="integer">1</cn>
        <cn type="integer">2</cn>
       </list>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>𝐊</ci>
       <ci>j</ci>
      </apply>
      <apply>
       <minus></minus>
       <ci>𝐈</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <cn type="integer">1</cn>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>l</ci>
         <ci>j</ci>
        </apply>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>𝐊</ci>
        <ci>j</ci>
       </apply>
       <mtext>T</mtext>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{N}=\sum_{j=1,2}\mathbf{K}_{j}(\mathbf{I}-\mathbf{1}_{l_{j}})\mathbf{K}%
_{j}^{\text{T}},
  </annotation>
 </semantics>
</math>

</p>

<p>with the 

<math display="inline" id="Kernel_Fisher_discriminant_analysis:41">
 <semantics>
  <mrow>
   <msup>
    <mi>n</mi>
    <mtext>th</mtext>
   </msup>
   <mo>,</mo>
   <msup>
    <mi>m</mi>
    <mtext>th</mtext>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <list>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>n</ci>
     <mtext>th</mtext>
    </apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>m</ci>
     <mtext>th</mtext>
    </apply>
   </list>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n^{\text{th}},m^{\text{th}}
  </annotation>
 </semantics>
</math>

 component of 

<math display="inline" id="Kernel_Fisher_discriminant_analysis:42">
 <semantics>
  <msub>
   <mi>𝐊</mi>
   <mi>j</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>𝐊</ci>
    <ci>j</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{K}_{j}
  </annotation>
 </semantics>
</math>

 defined as 

<math display="inline" id="Kernel_Fisher_discriminant_analysis:43">
 <semantics>
  <mrow>
   <mi>k</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>𝐱</mi>
     <mi>n</mi>
    </msub>
    <mo>,</mo>
    <msubsup>
     <mi>𝐱</mi>
     <mi>m</mi>
     <mi>j</mi>
    </msubsup>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>k</ci>
    <interval closure="open">
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>𝐱</ci>
      <ci>n</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>𝐱</ci>
       <ci>m</ci>
      </apply>
      <ci>j</ci>
     </apply>
    </interval>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   k(\mathbf{x}_{n},\mathbf{x}_{m}^{j})
  </annotation>
 </semantics>
</math>

, 

<math display="inline" id="Kernel_Fisher_discriminant_analysis:44">
 <semantics>
  <mi>𝐈</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>𝐈</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{I}
  </annotation>
 </semantics>
</math>

 is the identity matrix, and 

<math display="inline" id="Kernel_Fisher_discriminant_analysis:45">
 <semantics>
  <msub>
   <mn>𝟏</mn>
   <msub>
    <mi>l</mi>
    <mi>j</mi>
   </msub>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <cn type="integer">1</cn>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>l</ci>
     <ci>j</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{1}_{l_{j}}
  </annotation>
 </semantics>
</math>

 the matrix with all entries equal to 

<math display="inline" id="Kernel_Fisher_discriminant_analysis:46">
 <semantics>
  <mrow>
   <mn>1</mn>
   <mo>/</mo>
   <msub>
    <mi>l</mi>
    <mi>j</mi>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <divide></divide>
    <cn type="integer">1</cn>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>l</ci>
     <ci>j</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   1/l_{j}
  </annotation>
 </semantics>
</math>

. This identity can be derived by starting out with the expression for 

<math display="inline" id="Kernel_Fisher_discriminant_analysis:47">
 <semantics>
  <mrow>
   <msup>
    <mi>𝐰</mi>
    <mtext>T</mtext>
   </msup>
   <msubsup>
    <mi>𝐒</mi>
    <mi>W</mi>
    <mi>ϕ</mi>
   </msubsup>
   <mi>𝐰</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>𝐰</ci>
     <mtext>T</mtext>
    </apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>𝐒</ci>
      <ci>W</ci>
     </apply>
     <ci>ϕ</ci>
    </apply>
    <ci>𝐰</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{w}^{\text{T}}\mathbf{S}_{W}^{\phi}\mathbf{w}
  </annotation>
 </semantics>
</math>

 and using the expansion of 

<math display="inline" id="Kernel_Fisher_discriminant_analysis:48">
 <semantics>
  <mi>𝐰</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>𝐰</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{w}
  </annotation>
 </semantics>
</math>

 and the definitions of 

<math display="inline" id="Kernel_Fisher_discriminant_analysis:49">
 <semantics>
  <msubsup>
   <mi>𝐒</mi>
   <mi>W</mi>
   <mi>ϕ</mi>
  </msubsup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>𝐒</ci>
     <ci>W</ci>
    </apply>
    <ci>ϕ</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{S}_{W}^{\phi}
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Kernel_Fisher_discriminant_analysis:50">
 <semantics>
  <msubsup>
   <mi>𝐦</mi>
   <mi>i</mi>
   <mi>ϕ</mi>
  </msubsup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>𝐦</ci>
     <ci>i</ci>
    </apply>
    <ci>ϕ</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{m}_{i}^{\phi}
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="inline" id="Kernel_Fisher_discriminant_analysis:51">
 <semantics>
  <mrow>
   <msup>
    <mi>𝐰</mi>
    <mtext>T</mtext>
   </msup>
   <msubsup>
    <mi>𝐒</mi>
    <mi>W</mi>
    <mi>ϕ</mi>
   </msubsup>
   <mi>𝐰</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>𝐰</ci>
     <mtext>T</mtext>
    </apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>𝐒</ci>
      <ci>W</ci>
     </apply>
     <ci>ϕ</ci>
    </apply>
    <ci>𝐰</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle\mathbf{w}^{\text{T}}\mathbf{S}_{W}^{\phi}\mathbf{w}
  </annotation>
 </semantics>
</math>


</p>

<p>With these equations for the numerator and denominator of 

<math display="inline" id="Kernel_Fisher_discriminant_analysis:52">
 <semantics>
  <mrow>
   <mi>J</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>𝐰</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>J</ci>
    <ci>𝐰</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   J(\mathbf{w})
  </annotation>
 </semantics>
</math>

, the equation for 

<math display="inline" id="Kernel_Fisher_discriminant_analysis:53">
 <semantics>
  <mi>J</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>J</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   J
  </annotation>
 </semantics>
</math>

 can be rewritten as</p>

<p>

<math display="block" id="Kernel_Fisher_discriminant_analysis:54">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>J</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>α</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mfrac>
     <mrow>
      <msup>
       <mi>α</mi>
       <mtext>T</mtext>
      </msup>
      <mi>𝐌</mi>
      <mi>α</mi>
     </mrow>
     <mrow>
      <msup>
       <mi>α</mi>
       <mtext>T</mtext>
      </msup>
      <mi>𝐍</mi>
      <mi>α</mi>
     </mrow>
    </mfrac>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>J</ci>
     <ci>α</ci>
    </apply>
    <apply>
     <divide></divide>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>α</ci>
       <mtext>T</mtext>
      </apply>
      <ci>𝐌</ci>
      <ci>α</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>α</ci>
       <mtext>T</mtext>
      </apply>
      <ci>𝐍</ci>
      <ci>α</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   J(\mathbf{\alpha})=\frac{\mathbf{\alpha}^{\text{T}}\mathbf{M}\mathbf{\alpha}}{%
\mathbf{\alpha}^{\text{T}}\mathbf{N}\mathbf{\alpha}}.
  </annotation>
 </semantics>
</math>

</p>

<p>Then, differentiating and setting equal to zero gives</p>

<p>

<math display="block" id="Kernel_Fisher_discriminant_analysis:55">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <msup>
        <mi>α</mi>
        <mtext>T</mtext>
       </msup>
       <mi>𝐌</mi>
       <mi>α</mi>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <mi>𝐍</mi>
     <mi>α</mi>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <msup>
        <mi>α</mi>
        <mtext>T</mtext>
       </msup>
       <mi>𝐍</mi>
       <mi>α</mi>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <mi>𝐌</mi>
     <mi>α</mi>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>α</ci>
       <mtext>T</mtext>
      </apply>
      <ci>𝐌</ci>
      <ci>α</ci>
     </apply>
     <ci>𝐍</ci>
     <ci>α</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>α</ci>
       <mtext>T</mtext>
      </apply>
      <ci>𝐍</ci>
      <ci>α</ci>
     </apply>
     <ci>𝐌</ci>
     <ci>α</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (\mathbf{\alpha}^{\text{T}}\mathbf{M}\mathbf{\alpha})\mathbf{N}\mathbf{\alpha}%
=(\mathbf{\alpha}^{\text{T}}\mathbf{N}\mathbf{\alpha})\mathbf{M}\mathbf{\alpha}.
  </annotation>
 </semantics>
</math>

</p>

<p>Since only the direction of 

<math display="inline" id="Kernel_Fisher_discriminant_analysis:56">
 <semantics>
  <mi>𝐰</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>𝐰</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{w}
  </annotation>
 </semantics>
</math>

, and hence the direction of 

<math display="inline" id="Kernel_Fisher_discriminant_analysis:57">
 <semantics>
  <mi>α</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>α</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{\alpha}
  </annotation>
 </semantics>
</math>

, matters, the above can be solved for 

<math display="inline" id="Kernel_Fisher_discriminant_analysis:58">
 <semantics>
  <mi>α</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>α</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{\alpha}
  </annotation>
 </semantics>
</math>

 as</p>

<p>

<math display="block" id="Kernel_Fisher_discriminant_analysis:59">
 <semantics>
  <mrow>
   <mrow>
    <mi>α</mi>
    <mo>=</mo>
    <mrow>
     <msup>
      <mi>𝐍</mi>
      <mrow>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
     </msup>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <msub>
        <mi>𝐌</mi>
        <mn>2</mn>
       </msub>
       <mo>-</mo>
       <msub>
        <mi>𝐌</mi>
        <mn>1</mn>
       </msub>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>α</ci>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>𝐍</ci>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <apply>
      <minus></minus>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>𝐌</ci>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>𝐌</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{\alpha}=\mathbf{N}^{-1}(\mathbf{M}_{2}-\mathbf{M}_{1}).
  </annotation>
 </semantics>
</math>

</p>

<p>Note that in practice, 

<math display="inline" id="Kernel_Fisher_discriminant_analysis:60">
 <semantics>
  <mi>𝐍</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>𝐍</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{N}
  </annotation>
 </semantics>
</math>

 is usually singular and so a multiple of the identity is added to it <a class="footnoteRef" href="#fn6" id="fnref6"><sup>6</sup></a></p>

<p>

<math display="block" id="Kernel_Fisher_discriminant_analysis:61">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>𝐍</mi>
     <mi>ϵ</mi>
    </msub>
    <mo>=</mo>
    <mrow>
     <mi>𝐍</mi>
     <mo>+</mo>
     <mrow>
      <mi>ϵ</mi>
      <mi>𝐈</mi>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>𝐍</ci>
     <ci>ϵ</ci>
    </apply>
    <apply>
     <plus></plus>
     <ci>𝐍</ci>
     <apply>
      <times></times>
      <ci>ϵ</ci>
      <ci>𝐈</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{N}_{\epsilon}=\mathbf{N}+\epsilon\mathbf{I}.
  </annotation>
 </semantics>
</math>

</p>

<p>Given the solution for 

<math display="inline" id="Kernel_Fisher_discriminant_analysis:62">
 <semantics>
  <mi>α</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>α</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{\alpha}
  </annotation>
 </semantics>
</math>

, the projection of a new data point is given by<a class="footnoteRef" href="#fn7" id="fnref7"><sup>7</sup></a></p>

<p>

<math display="block" id="Kernel_Fisher_discriminant_analysis:63">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>y</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>𝐱</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mrow>
       <mi>𝐰</mi>
       <mo>⋅</mo>
       <mi>ϕ</mi>
      </mrow>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>𝐱</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
    <mo>=</mo>
    <mrow>
     <munderover>
      <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
      <mrow>
       <mi>i</mi>
       <mo>=</mo>
       <mn>1</mn>
      </mrow>
      <mi>l</mi>
     </munderover>
     <mrow>
      <msub>
       <mi>α</mi>
       <mi>i</mi>
      </msub>
      <mi>k</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <msub>
        <mi>𝐱</mi>
        <mi>i</mi>
       </msub>
       <mo>,</mo>
       <mi>𝐱</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <times></times>
      <ci>y</ci>
      <ci>𝐱</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <ci>normal-⋅</ci>
       <ci>𝐰</ci>
       <ci>ϕ</ci>
      </apply>
      <ci>𝐱</ci>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <apply>
         <eq></eq>
         <ci>i</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <ci>l</ci>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>α</ci>
        <ci>i</ci>
       </apply>
       <ci>k</ci>
       <interval closure="open">
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>𝐱</ci>
         <ci>i</ci>
        </apply>
        <ci>𝐱</ci>
       </interval>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   y(\mathbf{x})=(\mathbf{w}\cdot\phi(\mathbf{x}))=\sum_{i=1}^{l}\alpha_{i}k(%
\mathbf{x}_{i},\mathbf{x}).
  </annotation>
 </semantics>
</math>

</p>
<h2 id="multi-class-kfd">Multi-class KFD</h2>

<p>The extension to cases where there are more than two classes is relatively straightforward.<a class="footnoteRef" href="#fn8" id="fnref8"><sup>8</sup></a><a class="footnoteRef" href="#fn9" id="fnref9"><sup>9</sup></a><a class="footnoteRef" href="#fn10" id="fnref10"><sup>10</sup></a> Let 

<math display="inline" id="Kernel_Fisher_discriminant_analysis:64">
 <semantics>
  <mi>c</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>c</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   c
  </annotation>
 </semantics>
</math>

 be the number of classes. Then multi-class KFD involves projecting the data into a 

<math display="inline" id="Kernel_Fisher_discriminant_analysis:65">
 <semantics>
  <mrow>
   <mo stretchy="false">(</mo>
   <mrow>
    <mi>c</mi>
    <mo>-</mo>
    <mn>1</mn>
   </mrow>
   <mo stretchy="false">)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <minus></minus>
    <ci>c</ci>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (c-1)
  </annotation>
 </semantics>
</math>

-dimensional space using 

<math display="inline" id="Kernel_Fisher_discriminant_analysis:66">
 <semantics>
  <mrow>
   <mo stretchy="false">(</mo>
   <mrow>
    <mi>c</mi>
    <mo>-</mo>
    <mn>1</mn>
   </mrow>
   <mo stretchy="false">)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <minus></minus>
    <ci>c</ci>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (c-1)
  </annotation>
 </semantics>
</math>

 discriminant functions</p>

<p>

<math display="block" id="Kernel_Fisher_discriminant_analysis:67">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>y</mi>
     <mi>i</mi>
    </msub>
    <mo>=</mo>
    <mrow>
     <msubsup>
      <mi>𝐰</mi>
      <mi>i</mi>
      <mtext>T</mtext>
     </msubsup>
     <mi>ϕ</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>𝐱</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mrow>
    <mi>i</mi>
    <mo>=</mo>
    <mrow>
     <mn>1</mn>
     <mo>,</mo>
     <mi mathvariant="normal">…</mi>
     <mo>,</mo>
     <mrow>
      <mi>c</mi>
      <mo>-</mo>
      <mn>1.</mn>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <ci>i</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>𝐰</ci>
        <ci>i</ci>
       </apply>
       <mtext>T</mtext>
      </apply>
      <ci>ϕ</ci>
      <ci>𝐱</ci>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <ci>i</ci>
     <list>
      <cn type="integer">1</cn>
      <ci>normal-…</ci>
      <apply>
       <minus></minus>
       <ci>c</ci>
       <cn type="float">1.</cn>
      </apply>
     </list>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   y_{i}=\mathbf{w}_{i}^{\text{T}}\phi(\mathbf{x})\qquad i=1,\ldots,c-1.
  </annotation>
 </semantics>
</math>

</p>

<p>This can be written in matrix notation</p>

<p>

<math display="block" id="Kernel_Fisher_discriminant_analysis:68">
 <semantics>
  <mrow>
   <mrow>
    <mi>𝐲</mi>
    <mo>=</mo>
    <mrow>
     <msup>
      <mi>𝐖</mi>
      <mtext>T</mtext>
     </msup>
     <mi>ϕ</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>𝐱</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>𝐲</ci>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>𝐖</ci>
      <mtext>T</mtext>
     </apply>
     <ci>ϕ</ci>
     <ci>𝐱</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{y}=\mathbf{W}^{\text{T}}\phi(\mathbf{x}),
  </annotation>
 </semantics>
</math>

</p>

<p>where the 

<math display="inline" id="Kernel_Fisher_discriminant_analysis:69">
 <semantics>
  <msub>
   <mi>𝐰</mi>
   <mi>i</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>𝐰</ci>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{w}_{i}
  </annotation>
 </semantics>
</math>

 are the columns of 

<math display="inline" id="Kernel_Fisher_discriminant_analysis:70">
 <semantics>
  <mi>𝐖</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>𝐖</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{W}
  </annotation>
 </semantics>
</math>

.<a class="footnoteRef" href="#fn11" id="fnref11"><sup>11</sup></a> Further, the between-class covariance matrix is now</p>

<p>

<math display="block" id="Kernel_Fisher_discriminant_analysis:71">
 <semantics>
  <mrow>
   <mrow>
    <msubsup>
     <mi>𝐒</mi>
     <mi>B</mi>
     <mi>ϕ</mi>
    </msubsup>
    <mo>=</mo>
    <mrow>
     <munderover>
      <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
      <mrow>
       <mi>i</mi>
       <mo>=</mo>
       <mn>1</mn>
      </mrow>
      <mi>c</mi>
     </munderover>
     <mrow>
      <msub>
       <mi>l</mi>
       <mi>i</mi>
      </msub>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <msubsup>
         <mi>𝐦</mi>
         <mi>i</mi>
         <mi>ϕ</mi>
        </msubsup>
        <mo>-</mo>
        <msup>
         <mi>𝐦</mi>
         <mi>ϕ</mi>
        </msup>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
      <msup>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <msubsup>
          <mi>𝐦</mi>
          <mi>i</mi>
          <mi>ϕ</mi>
         </msubsup>
         <mo>-</mo>
         <msup>
          <mi>𝐦</mi>
          <mi>ϕ</mi>
         </msup>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
       <mtext>T</mtext>
      </msup>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>𝐒</ci>
      <ci>B</ci>
     </apply>
     <ci>ϕ</ci>
    </apply>
    <apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <apply>
        <eq></eq>
        <ci>i</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <ci>c</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>l</ci>
       <ci>i</ci>
      </apply>
      <apply>
       <minus></minus>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>𝐦</ci>
         <ci>i</ci>
        </apply>
        <ci>ϕ</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>𝐦</ci>
        <ci>ϕ</ci>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <minus></minus>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>𝐦</ci>
          <ci>i</ci>
         </apply>
         <ci>ϕ</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>𝐦</ci>
         <ci>ϕ</ci>
        </apply>
       </apply>
       <mtext>T</mtext>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{S}_{B}^{\phi}=\sum_{i=1}^{c}l_{i}(\mathbf{m}_{i}^{\phi}-\mathbf{m}^{%
\phi})(\mathbf{m}_{i}^{\phi}-\mathbf{m}^{\phi})^{\text{T}},
  </annotation>
 </semantics>
</math>

</p>

<p>where 

<math display="inline" id="Kernel_Fisher_discriminant_analysis:72">
 <semantics>
  <msup>
   <mi>𝐦</mi>
   <mi>ϕ</mi>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>𝐦</ci>
    <ci>ϕ</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{m}^{\phi}
  </annotation>
 </semantics>
</math>

 is the mean of all the data in the new feature space. The within-class covariance matrix is</p>

<p>

<math display="block" id="Kernel_Fisher_discriminant_analysis:73">
 <semantics>
  <mrow>
   <mrow>
    <msubsup>
     <mi>𝐒</mi>
     <mi>W</mi>
     <mi>ϕ</mi>
    </msubsup>
    <mo>=</mo>
    <mrow>
     <munderover>
      <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
      <mrow>
       <mi>i</mi>
       <mo>=</mo>
       <mn>1</mn>
      </mrow>
      <mi>c</mi>
     </munderover>
     <mrow>
      <munderover>
       <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
       <mrow>
        <mi>n</mi>
        <mo>=</mo>
        <mn>1</mn>
       </mrow>
       <msub>
        <mi>l</mi>
        <mi>i</mi>
       </msub>
      </munderover>
      <mrow>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mrow>
          <mi>ϕ</mi>
          <mrow>
           <mo stretchy="false">(</mo>
           <msubsup>
            <mi>𝐱</mi>
            <mi>n</mi>
            <mi>i</mi>
           </msubsup>
           <mo stretchy="false">)</mo>
          </mrow>
         </mrow>
         <mo>-</mo>
         <msubsup>
          <mi>𝐦</mi>
          <mi>i</mi>
          <mi>ϕ</mi>
         </msubsup>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
       <msup>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <mrow>
           <mi>ϕ</mi>
           <mrow>
            <mo stretchy="false">(</mo>
            <msubsup>
             <mi>𝐱</mi>
             <mi>n</mi>
             <mi>i</mi>
            </msubsup>
            <mo stretchy="false">)</mo>
           </mrow>
          </mrow>
          <mo>-</mo>
          <msubsup>
           <mi>𝐦</mi>
           <mi>i</mi>
           <mi>ϕ</mi>
          </msubsup>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
        <mtext>T</mtext>
       </msup>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>𝐒</ci>
      <ci>W</ci>
     </apply>
     <ci>ϕ</ci>
    </apply>
    <apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <apply>
        <eq></eq>
        <ci>i</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <ci>c</ci>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <apply>
         <eq></eq>
         <ci>n</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>l</ci>
        <ci>i</ci>
       </apply>
      </apply>
      <apply>
       <times></times>
       <apply>
        <minus></minus>
        <apply>
         <times></times>
         <ci>ϕ</ci>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>𝐱</ci>
           <ci>n</ci>
          </apply>
          <ci>i</ci>
         </apply>
        </apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>𝐦</ci>
          <ci>i</ci>
         </apply>
         <ci>ϕ</ci>
        </apply>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <minus></minus>
         <apply>
          <times></times>
          <ci>ϕ</ci>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <ci>𝐱</ci>
            <ci>n</ci>
           </apply>
           <ci>i</ci>
          </apply>
         </apply>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>𝐦</ci>
           <ci>i</ci>
          </apply>
          <ci>ϕ</ci>
         </apply>
        </apply>
        <mtext>T</mtext>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{S}_{W}^{\phi}=\sum_{i=1}^{c}\sum_{n=1}^{l_{i}}(\phi(\mathbf{x}_{n}^{i}%
)-\mathbf{m}_{i}^{\phi})(\phi(\mathbf{x}_{n}^{i})-\mathbf{m}_{i}^{\phi})^{%
\text{T}},
  </annotation>
 </semantics>
</math>

</p>

<p>The solution is now obtained by maximizing</p>

<p>

<math display="block" id="Kernel_Fisher_discriminant_analysis:74">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>J</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>𝐖</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mfrac>
     <mrow>
      <mo>|</mo>
      <mrow>
       <msup>
        <mi>𝐖</mi>
        <mtext>T</mtext>
       </msup>
       <msubsup>
        <mi>𝐒</mi>
        <mi>B</mi>
        <mi>ϕ</mi>
       </msubsup>
       <mi>𝐖</mi>
      </mrow>
      <mo>|</mo>
     </mrow>
     <mrow>
      <mo>|</mo>
      <mrow>
       <msup>
        <mi>𝐖</mi>
        <mtext>T</mtext>
       </msup>
       <msubsup>
        <mi>𝐒</mi>
        <mi>W</mi>
        <mi>ϕ</mi>
       </msubsup>
       <mi>𝐖</mi>
      </mrow>
      <mo>|</mo>
     </mrow>
    </mfrac>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>J</ci>
     <ci>𝐖</ci>
    </apply>
    <apply>
     <divide></divide>
     <apply>
      <abs></abs>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>𝐖</ci>
        <mtext>T</mtext>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>𝐒</ci>
         <ci>B</ci>
        </apply>
        <ci>ϕ</ci>
       </apply>
       <ci>𝐖</ci>
      </apply>
     </apply>
     <apply>
      <abs></abs>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>𝐖</ci>
        <mtext>T</mtext>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>𝐒</ci>
         <ci>W</ci>
        </apply>
        <ci>ϕ</ci>
       </apply>
       <ci>𝐖</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   J(\mathbf{W})=\frac{\left|\mathbf{W}^{\text{T}}\mathbf{S}_{B}^{\phi}\mathbf{W}%
\right|}{\left|\mathbf{W}^{\text{T}}\mathbf{S}_{W}^{\phi}\mathbf{W}\right|}.
  </annotation>
 </semantics>
</math>

</p>

<p>The kernel trick can again be used and the goal of multi-class KFD becomes<a class="footnoteRef" href="#fn12" id="fnref12"><sup>12</sup></a></p>

<p>

<math display="block" id="Kernel_Fisher_discriminant_analysis:75">
 <semantics>
  <mrow>
   <mrow>
    <msup>
     <mi>𝐀</mi>
     <mo>*</mo>
    </msup>
    <mo>=</mo>
    <munder accentunder="true">
     <mo>argmax</mo>
     <mo>𝐀</mo>
    </munder>
    <mo>=</mo>
    <mfrac>
     <mrow>
      <mo>|</mo>
      <mrow>
       <msup>
        <mi>𝐀</mi>
        <mtext>T</mtext>
       </msup>
       <mi>𝐌𝐀</mi>
      </mrow>
      <mo>|</mo>
     </mrow>
     <mrow>
      <mo>|</mo>
      <mrow>
       <msup>
        <mi>𝐀</mi>
        <mtext>T</mtext>
       </msup>
       <mi>𝐍𝐀</mi>
      </mrow>
      <mo>|</mo>
     </mrow>
    </mfrac>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>𝐀</ci>
      <times></times>
     </apply>
     <apply>
      <ci>𝐀</ci>
      <ci>argmax</ci>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <divide></divide>
      <apply>
       <abs></abs>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>𝐀</ci>
         <mtext>T</mtext>
        </apply>
        <ci>𝐌𝐀</ci>
       </apply>
      </apply>
      <apply>
       <abs></abs>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>𝐀</ci>
         <mtext>T</mtext>
        </apply>
        <ci>𝐍𝐀</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{A}^{*}=\underset{\mathbf{A}}{\operatorname{argmax}}=\frac{\left|%
\mathbf{A}^{\text{T}}\mathbf{M}\mathbf{A}\right|}{\left|\mathbf{A}^{\text{T}}%
\mathbf{N}\mathbf{A}\right|},
  </annotation>
 </semantics>
</math>

</p>

<p>where 

<math display="inline" id="Kernel_Fisher_discriminant_analysis:76">
 <semantics>
  <mrow>
   <mi>A</mi>
   <mo>=</mo>
   <mrow>
    <mo stretchy="false">[</mo>
    <msub>
     <mi>α</mi>
     <mn>1</mn>
    </msub>
    <mo>,</mo>
    <mi mathvariant="normal">…</mi>
    <mo>,</mo>
    <msub>
     <mi>α</mi>
     <mrow>
      <mi>c</mi>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </msub>
    <mo stretchy="false">]</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>A</ci>
    <list>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>α</ci>
      <cn type="integer">1</cn>
     </apply>
     <ci>normal-…</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>α</ci>
      <apply>
       <minus></minus>
       <ci>c</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
    </list>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A=[\mathbf{\alpha}_{1},\ldots,\mathbf{\alpha}_{c-1}]
  </annotation>
 </semantics>
</math>

 and</p>

<p>

<math display="inline" id="Kernel_Fisher_discriminant_analysis:77">
 <semantics>
  <mi>M</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>M</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle M
  </annotation>
 </semantics>
</math>


</p>

<p>The 

<math display="inline" id="Kernel_Fisher_discriminant_analysis:78">
 <semantics>
  <msub>
   <mi>𝐌</mi>
   <mi>i</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>𝐌</ci>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{M}_{i}
  </annotation>
 </semantics>
</math>

 are defined as in the above section and 

<math display="inline" id="Kernel_Fisher_discriminant_analysis:79">
 <semantics>
  <msub>
   <mi>𝐌</mi>
   <mo>*</mo>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>𝐌</ci>
    <times></times>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{M}_{*}
  </annotation>
 </semantics>
</math>

 is defined as</p>

<p>

<math display="block" id="Kernel_Fisher_discriminant_analysis:80">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mrow>
      <mo stretchy="false">(</mo>
      <msub>
       <mi>𝐌</mi>
       <mo>*</mo>
      </msub>
      <mo stretchy="false">)</mo>
     </mrow>
     <mi>j</mi>
    </msub>
    <mo>=</mo>
    <mrow>
     <mfrac>
      <mn>1</mn>
      <mi>l</mi>
     </mfrac>
     <mrow>
      <munderover>
       <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
       <mrow>
        <mi>k</mi>
        <mo>=</mo>
        <mn>1</mn>
       </mrow>
       <mi>l</mi>
      </munderover>
      <mrow>
       <mi>k</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <msub>
         <mi>𝐱</mi>
         <mi>j</mi>
        </msub>
        <mo>,</mo>
        <msub>
         <mi>𝐱</mi>
         <mi>k</mi>
        </msub>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>𝐌</ci>
      <times></times>
     </apply>
     <ci>j</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <divide></divide>
      <cn type="integer">1</cn>
      <ci>l</ci>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <apply>
         <eq></eq>
         <ci>k</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <ci>l</ci>
      </apply>
      <apply>
       <times></times>
       <ci>k</ci>
       <interval closure="open">
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>𝐱</ci>
         <ci>j</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>𝐱</ci>
         <ci>k</ci>
        </apply>
       </interval>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (\mathbf{M}_{*})_{j}=\frac{1}{l}\sum_{k=1}^{l}k(\mathbf{x}_{j},\mathbf{x}_{k}).
  </annotation>
 </semantics>
</math>

 

<math display="inline" id="Kernel_Fisher_discriminant_analysis:81">
 <semantics>
  <msup>
   <mi>𝐀</mi>
   <mo>*</mo>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>𝐀</ci>
    <times></times>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{A}^{*}
  </annotation>
 </semantics>
</math>

 can then be computed by finding the 

<math display="inline" id="Kernel_Fisher_discriminant_analysis:82">
 <semantics>
  <mrow>
   <mo stretchy="false">(</mo>
   <mrow>
    <mi>c</mi>
    <mo>-</mo>
    <mn>1</mn>
   </mrow>
   <mo stretchy="false">)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <minus></minus>
    <ci>c</ci>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (c-1)
  </annotation>
 </semantics>
</math>

 leading eigenvectors of 

<math display="inline" id="Kernel_Fisher_discriminant_analysis:83">
 <semantics>
  <mrow>
   <msup>
    <mi>𝐍</mi>
    <mrow>
     <mo>-</mo>
     <mn>1</mn>
    </mrow>
   </msup>
   <mi>𝐌</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>𝐍</ci>
     <apply>
      <minus></minus>
      <cn type="integer">1</cn>
     </apply>
    </apply>
    <ci>𝐌</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{N}^{-1}\mathbf{M}
  </annotation>
 </semantics>
</math>

.<a class="footnoteRef" href="#fn13" id="fnref13"><sup>13</sup></a> Furthermore, the projection of a new input, 

<math display="inline" id="Kernel_Fisher_discriminant_analysis:84">
 <semantics>
  <msub>
   <mi>𝐱</mi>
   <mi>t</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>𝐱</ci>
    <ci>t</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{x}_{t}
  </annotation>
 </semantics>
</math>

, is given by<a class="footnoteRef" href="#fn14" id="fnref14"><sup>14</sup></a></p>

<p>

<math display="block" id="Kernel_Fisher_discriminant_analysis:85">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>𝐲</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <msub>
       <mi>𝐱</mi>
       <mi>t</mi>
      </msub>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <msup>
      <mrow>
       <mo>(</mo>
       <msup>
        <mi>𝐀</mi>
        <mo>*</mo>
       </msup>
       <mo>)</mo>
      </mrow>
      <mtext>T</mtext>
     </msup>
     <msub>
      <mi>𝐊</mi>
      <mi>t</mi>
     </msub>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>𝐲</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>𝐱</ci>
      <ci>t</ci>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>𝐀</ci>
       <times></times>
      </apply>
      <mtext>T</mtext>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>𝐊</ci>
      <ci>t</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{y}(\mathbf{x}_{t})=\left(\mathbf{A}^{*}\right)^{\text{T}}\mathbf{K}_{t},
  </annotation>
 </semantics>
</math>

</p>

<p>where the 

<math display="inline" id="Kernel_Fisher_discriminant_analysis:86">
 <semantics>
  <msup>
   <mi>i</mi>
   <mrow>
    <mi>t</mi>
    <mi>h</mi>
   </mrow>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>i</ci>
    <apply>
     <times></times>
     <ci>t</ci>
     <ci>h</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   i^{th}
  </annotation>
 </semantics>
</math>

 component of 

<math display="inline" id="Kernel_Fisher_discriminant_analysis:87">
 <semantics>
  <msub>
   <mi>𝐊</mi>
   <mi>t</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>𝐊</ci>
    <ci>t</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{K}_{t}
  </annotation>
 </semantics>
</math>

 is given by 

<math display="inline" id="Kernel_Fisher_discriminant_analysis:88">
 <semantics>
  <mrow>
   <mi>k</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>𝐱</mi>
     <mi>i</mi>
    </msub>
    <mo>,</mo>
    <msub>
     <mi>𝐱</mi>
     <mi>t</mi>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>k</ci>
    <interval closure="open">
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>𝐱</ci>
      <ci>i</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>𝐱</ci>
      <ci>t</ci>
     </apply>
    </interval>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   k(\mathbf{x}_{i},\mathbf{x}_{t})
  </annotation>
 </semantics>
</math>

.</p>
<h2 id="classification-using-kfd">Classification using KFD</h2>

<p>In both two-class and multi-class KFD, the class label of a new input can be assigned as<a class="footnoteRef" href="#fn15" id="fnref15"><sup>15</sup></a></p>

<p>

<math display="block" id="Kernel_Fisher_discriminant_analysis:89">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>f</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>𝐱</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mi>a</mi>
     <mi>r</mi>
     <mi>g</mi>
     <mrow>
      <munder>
       <mi>min</mi>
       <mi>j</mi>
      </munder>
      <mi>D</mi>
     </mrow>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mi>𝐲</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>𝐱</mi>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
      <mo>,</mo>
      <msub>
       <mover accent="true">
        <mi>𝐲</mi>
        <mo stretchy="false">¯</mo>
       </mover>
       <mi>j</mi>
      </msub>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>f</ci>
     <ci>𝐱</ci>
    </apply>
    <apply>
     <times></times>
     <ci>a</ci>
     <ci>r</ci>
     <ci>g</ci>
     <apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <min></min>
       <ci>j</ci>
      </apply>
      <ci>D</ci>
     </apply>
     <interval closure="open">
      <apply>
       <times></times>
       <ci>𝐲</ci>
       <ci>𝐱</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <apply>
        <ci>normal-¯</ci>
        <ci>𝐲</ci>
       </apply>
       <ci>j</ci>
      </apply>
     </interval>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f(\mathbf{x})=arg\min_{j}D(\mathbf{y}(\mathbf{x}),\bar{\mathbf{y}}_{j}),
  </annotation>
 </semantics>
</math>

</p>

<p>where 

<math display="inline" id="Kernel_Fisher_discriminant_analysis:90">
 <semantics>
  <msub>
   <mover accent="true">
    <mi>𝐲</mi>
    <mo stretchy="false">¯</mo>
   </mover>
   <mi>j</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <apply>
     <ci>normal-¯</ci>
     <ci>𝐲</ci>
    </apply>
    <ci>j</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \bar{\mathbf{y}}_{j}
  </annotation>
 </semantics>
</math>

 is the projected mean for class 

<math display="inline" id="Kernel_Fisher_discriminant_analysis:91">
 <semantics>
  <mi>j</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>j</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   j
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Kernel_Fisher_discriminant_analysis:92">
 <semantics>
  <mrow>
   <mi>D</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mo>⋅</mo>
    <mo>,</mo>
    <mo>⋅</mo>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>D</ci>
    <interval closure="open">
     <ci>normal-⋅</ci>
     <ci>normal-⋅</ci>
    </interval>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   D(\cdot,\cdot)
  </annotation>
 </semantics>
</math>

 is a distance function.</p>
<h2 id="applications">Applications</h2>

<p>Kernel discriminant analysis has been used in a variety of applications. These include:</p>
<ul>
<li><a href="Face_recognition" title="wikilink">Face recognition</a><a class="footnoteRef" href="#fn16" id="fnref16"><sup>16</sup></a><a class="footnoteRef" href="#fn17" id="fnref17"><sup>17</sup></a><a class="footnoteRef" href="#fn18" id="fnref18"><sup>18</sup></a> and detection<a class="footnoteRef" href="#fn19" id="fnref19"><sup>19</sup></a><a class="footnoteRef" href="#fn20" id="fnref20"><sup>20</sup></a></li>
<li>Hand-written digit recognition<a class="footnoteRef" href="#fn21" id="fnref21"><sup>21</sup></a><a class="footnoteRef" href="#fn22" id="fnref22"><sup>22</sup></a></li>
<li>Palmprint recognition<a class="footnoteRef" href="#fn23" id="fnref23"><sup>23</sup></a></li>
<li>Classification of malignant and benign cluster microcalcifications<a class="footnoteRef" href="#fn24" id="fnref24"><sup>24</sup></a></li>
<li>Seed classification<a class="footnoteRef" href="#fn25" id="fnref25"><sup>25</sup></a></li>
</ul>
<h2 id="see-also">See also</h2>
<ul>
<li><a href="Factor_analysis" title="wikilink">Factor analysis</a></li>
<li><a href="Kernel_principal_component_analysis" title="wikilink">Kernel principal component analysis</a></li>
<li><a href="Kernel_trick" title="wikilink">Kernel trick</a></li>
<li><a href="Linear_discriminant_analysis" title="wikilink">Linear discriminant analysis</a></li>
</ul>
<h2 id="references">References</h2>
<h2 id="external-links">External links</h2>
<ul>
<li><a href="http://homepages.inf.ed.ac.uk/rbf/CVonline/LOCAL_COPIES/LI1/kda/index.html">Kernel Discriminant Analysis</a> - This site gives a high level explanation of KFD.</li>
<li><a href="http://crsouza.blogspot.com/2010/01/kernel-discriminant-analysis-in-c.html">Kernel Discriminant Analysis in C#</a> - C# code to perform KFD.</li>
<li><a href="http://homepage.tudelft.nl/19j49/Matlab_Toolbox_for_Dimensionality_Reduction.html">Matlab Toolbox for Dimensionality Reduction</a> - Includes a method for performing KFD.</li>
<li><a href="http://www.codeproject.com/KB/recipes/handwriting-kda.aspx">Handwriting Recognition using Kernel Discriminant Analysis</a> - C# code that demonstrates handwritten digit recognition using KFD.</li>
</ul>

<p>"</p>

<p><a href="Category:Multivariate_statistics" title="wikilink">Category:Multivariate statistics</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1"><a href="#fnref1">↩</a></li>
<li id="fn2"><a href="#fnref2">↩</a></li>
<li id="fn3"><a href="#fnref3">↩</a></li>
<li id="fn4"></li>
<li id="fn5"><a href="#fnref5">↩</a></li>
<li id="fn6"></li>
<li id="fn7"></li>
<li id="fn8"></li>
<li id="fn9"><a href="#fnref9">↩</a></li>
<li id="fn10"><a href="#fnref10">↩</a></li>
<li id="fn11"></li>
<li id="fn12"></li>
<li id="fn13"></li>
<li id="fn14"></li>
<li id="fn15"></li>
<li id="fn16"></li>
<li id="fn17"><a href="#fnref17">↩</a></li>
<li id="fn18"><a href="#fnref18">↩</a></li>
<li id="fn19"><a href="#fnref19">↩</a></li>
<li id="fn20"><a href="#fnref20">↩</a></li>
<li id="fn21"></li>
<li id="fn22"><a href="#fnref22">↩</a></li>
<li id="fn23"><a href="#fnref23">↩</a></li>
<li id="fn24"><a href="#fnref24">↩</a></li>
<li id="fn25"></li>
</ol>
</section>
</ref></hr></body>
</html>

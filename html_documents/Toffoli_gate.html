<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="209">Toffoli gate</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Toffoli gate</h1>
<hr/>
<figure><b>(Figure)</b>
<figcaption>Circuit representation of Toffoli gate</figcaption>
</figure>

<p>In <a href="logic_circuits" title="wikilink">logic circuits</a>, the <strong>Toffoli gate</strong> (also <strong>CCNOT gate</strong>), invented by <a href="Tommaso_Toffoli" title="wikilink">Tommaso Toffoli</a>, is a universal <a href="Reversible_computing" title="wikilink">reversible</a> <a href="logic_gate" title="wikilink">logic gate</a>, which means that any reversible circuit can be constructed from Toffoli gates. It is also known as the "controlled-controlled-not" gate, which describes its action. It has 3-bit inputs and outputs; if the first two bits are set, it inverts the third bit, otherwise all bits stay the same.</p>
<h2 id="background">Background</h2>

<p>A <a href="logic_gate" title="wikilink">logic gate</a> <em>L</em> is reversible if, for any output <em>y</em>, there is a unique input <em>x</em> such that applying <em>L</em>(<em>x</em>) = <em>y</em>. If a gate <em>L</em> is reversible, there is an inverse gate <em>L</em>′ which maps <em>y</em> to <em>x</em> for which <em>L</em>′(<em>y</em>) = <em>x</em>. From common logic gates, NOT is reversible, as can be seen from its truthtable below.</p>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">
<p>INPUT</p></th>
<th style="text-align: left;">
<p>OUTPUT</p></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">
<p>0</p></td>
<td style="text-align: left;">
<p>1</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>1</p></td>
<td style="text-align: left;">
<p>0</p></td>
</tr>
</tbody>
</table>

<p>The common AND gate is not reversible however. The inputs 00, 01 and 10 are all mapped to the output 0.</p>

<p>Reversible gates have been studied since the 1960s. The original motivation was that reversible gates dissipate less heat (or, in principle, no heat). In a normal gate, input states are lost, since less information is present in the output than was present at the input. This loss of information loses energy to the surrounding area as heat, because of <a href="entropy" title="wikilink">thermodynamic entropy</a>. Another way to understand this is that charges on a circuit are grounded and thus flow away, taking a small quantity of energy with them when they change state. A reversible gate only moves the states around, and since no information is lost, energy is conserved.</p>

<p>More recent motivation comes from <a href="quantum_computing" title="wikilink">quantum computing</a>. <a href="Quantum_mechanics" title="wikilink">Quantum mechanics</a> requires the transformations to be reversible but allows more general states of the computation (<a href="Superposition_principle" title="wikilink">superpositions</a>). Thus, the reversible gates form a subset of gates allowed by quantum mechanics and, if we can compute something reversibly, we can also compute it on a quantum computer.</p>
<h2 id="universality-and-toffoli-gate">Universality and Toffoli gate</h2>

<p>Any reversible gate must have the same number of input and output bits, by the <a href="pigeonhole_principle" title="wikilink">pigeonhole principle</a>. For one input bit, there are two possible <a href="Reversible_computing" title="wikilink">reversible</a> gates. One of them is NOT. The other is the identity gate which maps its input to the output unchanged. For two input bits, the only non-trivial gate is the <a href="controlled_NOT_gate" title="wikilink">controlled NOT gate</a> which XORs the first bit to the second bit and leaves the first bit unchanged.</p>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">
<p>Truth table</p></th>
<th style="text-align: left;">
<p><a href="Permutation_matrix" title="wikilink">Permutation matrix</a> form</p></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><table>
<thead>
<tr class="header">
<th style="text-align: left;">
<p>INPUT</p></th>
<th style="text-align: left;">
<p>OUTPUT</p></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">
<p> 0 </p></td>
<td style="text-align: left;">
<p> 0 </p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>0</p></td>
<td style="text-align: left;">
<p>1</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>1</p></td>
<td style="text-align: left;">
<p>0</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>1</p></td>
<td style="text-align: left;">
<p>1</p></td>
</tr>
</tbody>
</table></td>
<td style="text-align: left;">
<p>

<math display="inline" id="Toffoli_gate:0">
 <semantics>
  <mrow>
   <mo>[</mo>
   <mtable>
    <mtr>
     <mtd columnalign="center">
      <mn>1</mn>
     </mtd>
     <mtd columnalign="center">
      <mn>0</mn>
     </mtd>
     <mtd columnalign="center">
      <mn>0</mn>
     </mtd>
     <mtd columnalign="center">
      <mn>0</mn>
     </mtd>
    </mtr>
    <mtr>
     <mtd columnalign="center">
      <mn>0</mn>
     </mtd>
     <mtd columnalign="center">
      <mn>1</mn>
     </mtd>
     <mtd columnalign="center">
      <mn>0</mn>
     </mtd>
     <mtd columnalign="center">
      <mn>0</mn>
     </mtd>
    </mtr>
    <mtr>
     <mtd columnalign="center">
      <mn>0</mn>
     </mtd>
     <mtd columnalign="center">
      <mn>0</mn>
     </mtd>
     <mtd columnalign="center">
      <mn>0</mn>
     </mtd>
     <mtd columnalign="center">
      <mn>1</mn>
     </mtd>
    </mtr>
    <mtr>
     <mtd columnalign="center">
      <mn>0</mn>
     </mtd>
     <mtd columnalign="center">
      <mn>0</mn>
     </mtd>
     <mtd columnalign="center">
      <mn>1</mn>
     </mtd>
     <mtd columnalign="center">
      <mn>0</mn>
     </mtd>
    </mtr>
   </mtable>
   <mo>]</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <matrix>
    <matrixrow>
     <cn type="integer">1</cn>
     <cn type="integer">0</cn>
     <cn type="integer">0</cn>
     <cn type="integer">0</cn>
    </matrixrow>
    <matrixrow>
     <cn type="integer">0</cn>
     <cn type="integer">1</cn>
     <cn type="integer">0</cn>
     <cn type="integer">0</cn>
    </matrixrow>
    <matrixrow>
     <cn type="integer">0</cn>
     <cn type="integer">0</cn>
     <cn type="integer">0</cn>
     <cn type="integer">1</cn>
    </matrixrow>
    <matrixrow>
     <cn type="integer">0</cn>
     <cn type="integer">0</cn>
     <cn type="integer">1</cn>
     <cn type="integer">0</cn>
    </matrixrow>
   </matrix>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \begin{bmatrix}1&0&0&0\\
0&1&0&0\\
0&0&0&1\\
0&0&1&0\\
\end{bmatrix}
  </annotation>
 </semantics>
</math>

</p></td>
</tr>
</tbody>
</table>

<p>Unfortunately, there are reversible functions that cannot be computed using just those gates. In other words, the set consisting of NOT and XOR gates is not <a href="functional_completeness" title="wikilink">universal</a>. If we want to compute an arbitrary function using reversible gates, we need another gate. One possibility is the <strong>Toffoli gate</strong>, proposed in 1980 by Toffoli.<a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a></p>

<p>This gate has 3-bit inputs and outputs. If the first two bits are set, it flips the third bit. The following is a table of the input and output bits:</p>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">
<p>Truth table</p></th>
<th style="text-align: left;">
<p>Permutation matrix form</p></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><table>
<thead>
<tr class="header">
<th style="text-align: left;">
<p>INPUT</p></th>
<th style="text-align: left;">
<p>OUTPUT</p></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">
<p> 0 </p></td>
<td style="text-align: left;">
<p> 0 </p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>0</p></td>
<td style="text-align: left;">
<p>0</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>0</p></td>
<td style="text-align: left;">
<p>1</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>0</p></td>
<td style="text-align: left;">
<p>1</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>1</p></td>
<td style="text-align: left;">
<p>0</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>1</p></td>
<td style="text-align: left;">
<p>0</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>1</p></td>
<td style="text-align: left;">
<p>1</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>1</p></td>
<td style="text-align: left;">
<p>1</p></td>
</tr>
</tbody>
</table></td>
<td style="text-align: left;">
<p>

<math display="inline" id="Toffoli_gate:1">
 <semantics>
  <mrow>
   <mo>[</mo>
   <mtable>
    <mtr>
     <mtd columnalign="center">
      <mn>1</mn>
     </mtd>
     <mtd columnalign="center">
      <mn>0</mn>
     </mtd>
     <mtd columnalign="center">
      <mn>0</mn>
     </mtd>
     <mtd columnalign="center">
      <mn>0</mn>
     </mtd>
     <mtd columnalign="center">
      <mn>0</mn>
     </mtd>
     <mtd columnalign="center">
      <mn>0</mn>
     </mtd>
     <mtd columnalign="center">
      <mn>0</mn>
     </mtd>
     <mtd columnalign="center">
      <mn>0</mn>
     </mtd>
    </mtr>
    <mtr>
     <mtd columnalign="center">
      <mn>0</mn>
     </mtd>
     <mtd columnalign="center">
      <mn>1</mn>
     </mtd>
     <mtd columnalign="center">
      <mn>0</mn>
     </mtd>
     <mtd columnalign="center">
      <mn>0</mn>
     </mtd>
     <mtd columnalign="center">
      <mn>0</mn>
     </mtd>
     <mtd columnalign="center">
      <mn>0</mn>
     </mtd>
     <mtd columnalign="center">
      <mn>0</mn>
     </mtd>
     <mtd columnalign="center">
      <mn>0</mn>
     </mtd>
    </mtr>
    <mtr>
     <mtd columnalign="center">
      <mn>0</mn>
     </mtd>
     <mtd columnalign="center">
      <mn>0</mn>
     </mtd>
     <mtd columnalign="center">
      <mn>1</mn>
     </mtd>
     <mtd columnalign="center">
      <mn>0</mn>
     </mtd>
     <mtd columnalign="center">
      <mn>0</mn>
     </mtd>
     <mtd columnalign="center">
      <mn>0</mn>
     </mtd>
     <mtd columnalign="center">
      <mn>0</mn>
     </mtd>
     <mtd columnalign="center">
      <mn>0</mn>
     </mtd>
    </mtr>
    <mtr>
     <mtd columnalign="center">
      <mn>0</mn>
     </mtd>
     <mtd columnalign="center">
      <mn>0</mn>
     </mtd>
     <mtd columnalign="center">
      <mn>0</mn>
     </mtd>
     <mtd columnalign="center">
      <mn>1</mn>
     </mtd>
     <mtd columnalign="center">
      <mn>0</mn>
     </mtd>
     <mtd columnalign="center">
      <mn>0</mn>
     </mtd>
     <mtd columnalign="center">
      <mn>0</mn>
     </mtd>
     <mtd columnalign="center">
      <mn>0</mn>
     </mtd>
    </mtr>
    <mtr>
     <mtd columnalign="center">
      <mn>0</mn>
     </mtd>
     <mtd columnalign="center">
      <mn>0</mn>
     </mtd>
     <mtd columnalign="center">
      <mn>0</mn>
     </mtd>
     <mtd columnalign="center">
      <mn>0</mn>
     </mtd>
     <mtd columnalign="center">
      <mn>1</mn>
     </mtd>
     <mtd columnalign="center">
      <mn>0</mn>
     </mtd>
     <mtd columnalign="center">
      <mn>0</mn>
     </mtd>
     <mtd columnalign="center">
      <mn>0</mn>
     </mtd>
    </mtr>
    <mtr>
     <mtd columnalign="center">
      <mn>0</mn>
     </mtd>
     <mtd columnalign="center">
      <mn>0</mn>
     </mtd>
     <mtd columnalign="center">
      <mn>0</mn>
     </mtd>
     <mtd columnalign="center">
      <mn>0</mn>
     </mtd>
     <mtd columnalign="center">
      <mn>0</mn>
     </mtd>
     <mtd columnalign="center">
      <mn>1</mn>
     </mtd>
     <mtd columnalign="center">
      <mn>0</mn>
     </mtd>
     <mtd columnalign="center">
      <mn>0</mn>
     </mtd>
    </mtr>
    <mtr>
     <mtd columnalign="center">
      <mn>0</mn>
     </mtd>
     <mtd columnalign="center">
      <mn>0</mn>
     </mtd>
     <mtd columnalign="center">
      <mn>0</mn>
     </mtd>
     <mtd columnalign="center">
      <mn>0</mn>
     </mtd>
     <mtd columnalign="center">
      <mn>0</mn>
     </mtd>
     <mtd columnalign="center">
      <mn>0</mn>
     </mtd>
     <mtd columnalign="center">
      <mn>0</mn>
     </mtd>
     <mtd columnalign="center">
      <mn>1</mn>
     </mtd>
    </mtr>
    <mtr>
     <mtd columnalign="center">
      <mn>0</mn>
     </mtd>
     <mtd columnalign="center">
      <mn>0</mn>
     </mtd>
     <mtd columnalign="center">
      <mn>0</mn>
     </mtd>
     <mtd columnalign="center">
      <mn>0</mn>
     </mtd>
     <mtd columnalign="center">
      <mn>0</mn>
     </mtd>
     <mtd columnalign="center">
      <mn>0</mn>
     </mtd>
     <mtd columnalign="center">
      <mn>1</mn>
     </mtd>
     <mtd columnalign="center">
      <mn>0</mn>
     </mtd>
    </mtr>
   </mtable>
   <mo>]</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <matrix>
    <matrixrow>
     <cn type="integer">1</cn>
     <cn type="integer">0</cn>
     <cn type="integer">0</cn>
     <cn type="integer">0</cn>
     <cn type="integer">0</cn>
     <cn type="integer">0</cn>
     <cn type="integer">0</cn>
     <cn type="integer">0</cn>
    </matrixrow>
    <matrixrow>
     <cn type="integer">0</cn>
     <cn type="integer">1</cn>
     <cn type="integer">0</cn>
     <cn type="integer">0</cn>
     <cn type="integer">0</cn>
     <cn type="integer">0</cn>
     <cn type="integer">0</cn>
     <cn type="integer">0</cn>
    </matrixrow>
    <matrixrow>
     <cn type="integer">0</cn>
     <cn type="integer">0</cn>
     <cn type="integer">1</cn>
     <cn type="integer">0</cn>
     <cn type="integer">0</cn>
     <cn type="integer">0</cn>
     <cn type="integer">0</cn>
     <cn type="integer">0</cn>
    </matrixrow>
    <matrixrow>
     <cn type="integer">0</cn>
     <cn type="integer">0</cn>
     <cn type="integer">0</cn>
     <cn type="integer">1</cn>
     <cn type="integer">0</cn>
     <cn type="integer">0</cn>
     <cn type="integer">0</cn>
     <cn type="integer">0</cn>
    </matrixrow>
    <matrixrow>
     <cn type="integer">0</cn>
     <cn type="integer">0</cn>
     <cn type="integer">0</cn>
     <cn type="integer">0</cn>
     <cn type="integer">1</cn>
     <cn type="integer">0</cn>
     <cn type="integer">0</cn>
     <cn type="integer">0</cn>
    </matrixrow>
    <matrixrow>
     <cn type="integer">0</cn>
     <cn type="integer">0</cn>
     <cn type="integer">0</cn>
     <cn type="integer">0</cn>
     <cn type="integer">0</cn>
     <cn type="integer">1</cn>
     <cn type="integer">0</cn>
     <cn type="integer">0</cn>
    </matrixrow>
    <matrixrow>
     <cn type="integer">0</cn>
     <cn type="integer">0</cn>
     <cn type="integer">0</cn>
     <cn type="integer">0</cn>
     <cn type="integer">0</cn>
     <cn type="integer">0</cn>
     <cn type="integer">0</cn>
     <cn type="integer">1</cn>
    </matrixrow>
    <matrixrow>
     <cn type="integer">0</cn>
     <cn type="integer">0</cn>
     <cn type="integer">0</cn>
     <cn type="integer">0</cn>
     <cn type="integer">0</cn>
     <cn type="integer">0</cn>
     <cn type="integer">1</cn>
     <cn type="integer">0</cn>
    </matrixrow>
   </matrix>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \begin{bmatrix}1&0&0&0&0&0&0&0\\
0&1&0&0&0&0&0&0\\
0&0&1&0&0&0&0&0\\
0&0&0&1&0&0&0&0\\
0&0&0&0&1&0&0&0\\
0&0&0&0&0&1&0&0\\
0&0&0&0&0&0&0&1\\
0&0&0&0&0&0&1&0\\
\end{bmatrix}
  </annotation>
 </semantics>
</math>

</p></td>
</tr>
</tbody>
</table>

<p>It can be also described as mapping bits a, b and c to a, b and c XOR (a AND b).</p>

<p>The Toffoli gate is universal; this means that for any <a href="Boolean_function" title="wikilink">Boolean function</a> <em>f</em>(<em>x</em><sub>1</sub>, <em>x</em><sub>2</sub>, ..., <em>x</em><sub><em>m</em></sub>), there is a circuit consisting of Toffoli gates which takes <em>x</em><sub>1</sub>, <em>x</em><sub>2</sub>, ..., <em>x</em><sub><em>m</em></sub> and some extra bits set to 0 or 1 and outputs <em>x</em><sub>1</sub>, <em>x</em><sub>2</sub>, ..., <em>x</em><sub><em>m</em></sub>, <em>f</em>(<em>x</em><sub>1</sub>, <em>x</em><sub>2</sub>, ..., <em>x</em><sub><em>m</em></sub>), and some extra bits (called garbage). Essentially, this means that one can use Toffoli gates to build systems that will perform any desired Boolean function computation in a reversible manner.</p>
<h2 id="related-logic-gates">Related logic gates</h2>
<figure><b>(Figure)</b>
<figcaption>Fredkin &amp; Toffoli billiard ball model for gates</figcaption>
</figure>
<ul>
<li>The <a href="Fredkin_gate" title="wikilink">Fredkin gate</a> is a reversible 3-bit gate that swaps the last two bits if the first bit is 1; a controlled-swap operation.</li>
</ul>
<ul>
<li>The <em>n</em>-bit Toffoli gate is a generalization of Toffoli gate. It takes <em>n</em> bits <em>x</em><sub>1</sub>, <em>x</em><sub>2</sub>, ..., <em>x</em><sub><em>n</em></sub> as inputs and outputs <em>n</em> bits. The first <em>n</em>−1 output bits are just <em>x</em><sub>1</sub>, ..., <em>x</em><sub><em>n</em>−1</sub>. The last output bit is (<em>x</em><sub>1</sub> AND ... AND <em>x</em><sub><em>n</em>−1</sub>) XOR <em>x</em><sub><em>n</em></sub>.</li>
<li>The Toffoli gate can be realized by five two-<a class="uri" href="qubit" title="wikilink">qubit</a> <a href="quantum_gate" title="wikilink">quantum gates</a>.<a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a></li>
</ul>
<ul>
<li>This gate is one of the reversible-gate cases that can be modeled with <a href="billiard_ball" title="wikilink">billiard balls</a> (see <a href="Billiard-ball_computer" title="wikilink">Billiard-ball computer</a>). The billiard ball modeling was introduced by Fredkin and Toffoli.<a class="footnoteRef" href="#fn3" id="fnref3"><sup>3</sup></a> An example of how the collisions are used to model an electronic gate is shown in the figure.</li>
</ul>
<h2 id="relation-to-quantum-computing">Relation to quantum computing</h2>

<p>Any reversible gate can be implemented on a <a href="quantum_computer" title="wikilink">quantum computer</a>, and hence the Toffoli gate is also a quantum operator. However, the Toffoli gate can not be used for universal quantum computation, though it does mean that a quantum computer can implement all possible classical computations. The Toffoli gate has to be implemented along with some inherently quantum gate(s) in order to be universal for quantum computation. In fact, any single-qubit gate with real coefficients that can create a nontrivial quantum state suffices.<a class="footnoteRef" href="#fn4" id="fnref4"><sup>4</sup></a> A <a href="quantum_mechanics" title="wikilink">quantum mechanics</a>-based Toffoli gate has been successfully realized in January 2009 at the University of Innsbruck, Austria.<a class="footnoteRef" href="#fn5" id="fnref5"><sup>5</sup></a></p>
<h2 id="see-also">See also</h2>
<ul>
<li><a href="Fredkin_gate" title="wikilink">Fredkin gate</a></li>
<li><a href="Reversible_computing" title="wikilink">Reversible computing</a></li>
<li><a href="Quantum_computing" title="wikilink">Quantum computing</a></li>
<li><a href="Quantum_gate" title="wikilink">Quantum gate</a></li>
<li><a href="Quantum_programming" title="wikilink">Quantum programming</a></li>
</ul>
<h2 id="references">References</h2>
<references>
</references>

<p>"</p>

<p><a href="Category:Logic_gates" title="wikilink">Category:Logic gates</a> <a href="Category:Quantum_gates" title="wikilink">Category:Quantum gates</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1">Technical Report MIT/LCS/TM-151 (1980) and an adapted and condensed version: <a href="#fnref1">↩</a></li>
<li id="fn2"><a href="#fnref2">↩</a></li>
<li id="fn3"><a href="#fnref3">↩</a></li>
<li id="fn4"><a href="#fnref4">↩</a></li>
<li id="fn5"><a href="#fnref5">↩</a></li>
</ol>
</section>
</body>
</html>

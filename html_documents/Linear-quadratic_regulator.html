<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="232">Linear-quadratic regulator</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Linear-quadratic regulator</h1>
<hr/>

<p>The theory of <a href="optimal_control" title="wikilink">optimal control</a> is concerned with operating a <a href="dynamic_system" title="wikilink">dynamic system</a> at minimum cost. The case where the system dynamics are described by a set of <a href="linear_differential_equation" title="wikilink">linear differential equations</a> and the cost is described by a <a href="quadratic_polynomial" title="wikilink">quadratic</a> <a href="functional_(mathematics)" title="wikilink">function</a> is called the LQ problem. One of the main results in the theory is that the solution is provided by the <strong>linear-quadratic regulator (LQR)</strong>, a feedback controller whose equations are given below. The LQR is an important part of the solution to the <a href="Linear-quadratic-Gaussian_control" title="wikilink">LQG (Linear-Quadratic-Gaussian) problem</a>. Like the LQR problem itself, the LQG problem is one of the most fundamental problems in <a href="control_theory" title="wikilink">control theory</a>.</p>
<h2 id="general-description">General description</h2>

<p>This means that the settings of a (regulating) controller governing either a machine or process (like an airplane or chemical reactor) are found by using a mathematical algorithm that minimizes a cost function with weighting factors supplied by a human (engineer). The "cost" (function) is often defined as a sum of the deviations of key measurements from their desired values. In effect this algorithm finds those controller settings that minimize the undesired deviations, like deviations from desired altitude or process temperature. Often the magnitude of the control action itself is included in this sum so as to keep the energy expended by the control action itself limited.</p>

<p>In effect, the LQR algorithm takes care of the tedious work done by the control systems engineer in optimizing the controller. However, the engineer still needs to specify the weighting factors and compare the results with the specified design goals. Often this means that controller synthesis will still be an iterative process where the engineer judges the produced "optimal" controllers through simulation and then adjusts the weighting factors to get a controller more in line with the specified design goals.</p>

<p>The LQR algorithm is, at its core, just an automated way of finding an appropriate <a href="state_space_(controls)" title="wikilink">state-feedback controller</a>. As such it is not uncommon to find that control engineers prefer alternative methods like <a href="full_state_feedback" title="wikilink">full state feedback</a> (also known as pole placement) to find a controller over the use of the LQR algorithm. With these the engineer has a much clearer linkage between adjusted parameters and the resulting changes in controller behavior. Difficulty in finding the right weighting factors limits the application of the LQR based controller synthesis.</p>
<h2 id="finite-horizon-continuous-time-lqr">Finite-horizon, continuous-time LQR</h2>

<p>For a continuous-time linear system, defined on 

<math display="inline" id="Linear-quadratic_regulator:0">
 <semantics>
  <mrow>
   <mi>t</mi>
   <mo>∈</mo>
   <mrow>
    <mo stretchy="false">[</mo>
    <msub>
     <mi>t</mi>
     <mn>0</mn>
    </msub>
    <mo>,</mo>
    <msub>
     <mi>t</mi>
     <mn>1</mn>
    </msub>
    <mo stretchy="false">]</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <in></in>
    <ci>t</ci>
    <interval closure="closed">
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>t</ci>
      <cn type="integer">0</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>t</ci>
      <cn type="integer">1</cn>
     </apply>
    </interval>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   t\in[t_{0},t_{1}]
  </annotation>
 </semantics>
</math>

, described by</p>

<p>

<math display="block" id="Linear-quadratic_regulator:1">
 <semantics>
  <mrow>
   <mover accent="true">
    <mi>x</mi>
    <mo>˙</mo>
   </mover>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mi>A</mi>
     <mi>x</mi>
    </mrow>
    <mo>+</mo>
    <mrow>
     <mi>B</mi>
     <mi>u</mi>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <ci>normal-˙</ci>
     <ci>x</ci>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <ci>A</ci>
      <ci>x</ci>
     </apply>
     <apply>
      <times></times>
      <ci>B</ci>
      <ci>u</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \dot{x}=Ax+Bu
  </annotation>
 </semantics>
</math>

</p>

<p>with a quadratic cost function defined as</p>

<p>

<math display="block" id="Linear-quadratic_regulator:2">
 <semantics>
  <mrow>
   <mi>J</mi>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mfrac>
      <mn>1</mn>
      <mn>2</mn>
     </mfrac>
     <msup>
      <mi>x</mi>
      <mi>T</mi>
     </msup>
     <mrow>
      <mo stretchy="false">(</mo>
      <msub>
       <mi>t</mi>
       <mn>1</mn>
      </msub>
      <mo stretchy="false">)</mo>
     </mrow>
     <mi>F</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <msub>
       <mi>t</mi>
       <mn>1</mn>
      </msub>
      <mo stretchy="false">)</mo>
     </mrow>
     <mi>x</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <msub>
       <mi>t</mi>
       <mn>1</mn>
      </msub>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>+</mo>
    <mrow>
     <munderover>
      <mo largeop="true" movablelimits="false" symmetric="true">∫</mo>
      <msub>
       <mi>t</mi>
       <mn>0</mn>
      </msub>
      <msub>
       <mi>t</mi>
       <mn>1</mn>
      </msub>
     </munderover>
     <mrow>
      <mrow>
       <mo>(</mo>
       <mrow>
        <mrow>
         <msup>
          <mi>x</mi>
          <mi>T</mi>
         </msup>
         <mi>Q</mi>
         <mi>x</mi>
        </mrow>
        <mo>+</mo>
        <mrow>
         <msup>
          <mi>u</mi>
          <mi>T</mi>
         </msup>
         <mi>R</mi>
         <mi>u</mi>
        </mrow>
        <mo>+</mo>
        <mrow>
         <mn>2</mn>
         <msup>
          <mi>x</mi>
          <mi>T</mi>
         </msup>
         <mi>N</mi>
         <mi>u</mi>
        </mrow>
       </mrow>
       <mo>)</mo>
      </mrow>
      <mi>d</mi>
      <mi>t</mi>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>J</ci>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>x</ci>
       <ci>T</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>t</ci>
       <cn type="integer">1</cn>
      </apply>
      <ci>F</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>t</ci>
       <cn type="integer">1</cn>
      </apply>
      <ci>x</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>t</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <int></int>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>t</ci>
         <cn type="integer">0</cn>
        </apply>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>t</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <apply>
       <times></times>
       <apply>
        <plus></plus>
        <apply>
         <times></times>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>x</ci>
          <ci>T</ci>
         </apply>
         <ci>Q</ci>
         <ci>x</ci>
        </apply>
        <apply>
         <times></times>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>u</ci>
          <ci>T</ci>
         </apply>
         <ci>R</ci>
         <ci>u</ci>
        </apply>
        <apply>
         <times></times>
         <cn type="integer">2</cn>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>x</ci>
          <ci>T</ci>
         </apply>
         <ci>N</ci>
         <ci>u</ci>
        </apply>
       </apply>
       <ci>d</ci>
       <ci>t</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   J=\frac{1}{2}x^{T}(t_{1})F(t_{1})x(t_{1})+\int\limits_{t_{0}}^{t_{1}}\left(x^{%
T}Qx+u^{T}Ru+2x^{T}Nu\right)dt
  </annotation>
 </semantics>
</math>

</p>

<p>the feedback control law that minimizes the value of the cost is</p>

<p>

<math display="block" id="Linear-quadratic_regulator:3">
 <semantics>
  <mrow>
   <mi>u</mi>
   <mo>=</mo>
   <mrow>
    <mo>-</mo>
    <mrow>
     <mi>K</mi>
     <mpadded width="+1.7pt">
      <mi>x</mi>
     </mpadded>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>u</ci>
    <apply>
     <minus></minus>
     <apply>
      <times></times>
      <ci>K</ci>
      <ci>x</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   u=-Kx\,
  </annotation>
 </semantics>
</math>

</p>

<p>where 

<math display="inline" id="Linear-quadratic_regulator:4">
 <semantics>
  <mi>K</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>K</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   K
  </annotation>
 </semantics>
</math>

 is given by</p>

<p>

<math display="block" id="Linear-quadratic_regulator:5">
 <semantics>
  <mrow>
   <mi>K</mi>
   <mo>=</mo>
   <mrow>
    <msup>
     <mi>R</mi>
     <mrow>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </msup>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mrow>
       <msup>
        <mi>B</mi>
        <mi>T</mi>
       </msup>
       <mi>P</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>t</mi>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
      <mo>+</mo>
      <msup>
       <mi>N</mi>
       <mi>T</mi>
      </msup>
     </mrow>
     <mo rspace="4.2pt" stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>K</ci>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>R</ci>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <apply>
      <plus></plus>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>B</ci>
        <ci>T</ci>
       </apply>
       <ci>P</ci>
       <ci>t</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>N</ci>
       <ci>T</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   K=R^{-1}(B^{T}P(t)+N^{T})\,
  </annotation>
 </semantics>
</math>

</p>

<p>and 

<math display="inline" id="Linear-quadratic_regulator:6">
 <semantics>
  <mi>P</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>P</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   P
  </annotation>
 </semantics>
</math>

 is found by solving the continuous time <a href="Riccati_differential_equation" title="wikilink">Riccati differential equation</a>.</p>

<p>

<math display="block" id="Linear-quadratic_regulator:7">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mrow>
      <mrow>
       <msup>
        <mi>A</mi>
        <mi>T</mi>
       </msup>
       <mi>P</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>t</mi>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
      <mo>+</mo>
      <mrow>
       <mi>P</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>t</mi>
        <mo stretchy="false">)</mo>
       </mrow>
       <mi>A</mi>
      </mrow>
     </mrow>
     <mo>-</mo>
     <mrow>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mrow>
         <mi>P</mi>
         <mrow>
          <mo stretchy="false">(</mo>
          <mi>t</mi>
          <mo stretchy="false">)</mo>
         </mrow>
         <mi>B</mi>
        </mrow>
        <mo>+</mo>
        <mi>N</mi>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
      <msup>
       <mi>R</mi>
       <mrow>
        <mo>-</mo>
        <mn>1</mn>
       </mrow>
      </msup>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mrow>
         <msup>
          <mi>B</mi>
          <mi>T</mi>
         </msup>
         <mi>P</mi>
         <mrow>
          <mo stretchy="false">(</mo>
          <mi>t</mi>
          <mo stretchy="false">)</mo>
         </mrow>
        </mrow>
        <mo>+</mo>
        <msup>
         <mi>N</mi>
         <mi>T</mi>
        </msup>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mrow>
    <mo>+</mo>
    <mi>Q</mi>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mo>-</mo>
    <mrow>
     <mover accent="true">
      <mi>P</mi>
      <mo>˙</mo>
     </mover>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>t</mi>
      <mo rspace="4.2pt" stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <plus></plus>
     <apply>
      <minus></minus>
      <apply>
       <plus></plus>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>A</ci>
         <ci>T</ci>
        </apply>
        <ci>P</ci>
        <ci>t</ci>
       </apply>
       <apply>
        <times></times>
        <ci>P</ci>
        <ci>t</ci>
        <ci>A</ci>
       </apply>
      </apply>
      <apply>
       <times></times>
       <apply>
        <plus></plus>
        <apply>
         <times></times>
         <ci>P</ci>
         <ci>t</ci>
         <ci>B</ci>
        </apply>
        <ci>N</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>R</ci>
        <apply>
         <minus></minus>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <apply>
        <plus></plus>
        <apply>
         <times></times>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>B</ci>
          <ci>T</ci>
         </apply>
         <ci>P</ci>
         <ci>t</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>N</ci>
         <ci>T</ci>
        </apply>
       </apply>
      </apply>
     </apply>
     <ci>Q</ci>
    </apply>
    <apply>
     <minus></minus>
     <apply>
      <times></times>
      <apply>
       <ci>normal-˙</ci>
       <ci>P</ci>
      </apply>
      <ci>t</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A^{T}P(t)+P(t)A-(P(t)B+N)R^{-1}(B^{T}P(t)+N^{T})+Q=-\dot{P}(t)\,
  </annotation>
 </semantics>
</math>

</p>

<p>with the boundary condition</p>

<p>

<math display="block" id="Linear-quadratic_regulator:8">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>P</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <msub>
       <mi>t</mi>
       <mn>1</mn>
      </msub>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mi>F</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <msub>
       <mi>t</mi>
       <mn>1</mn>
      </msub>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>P</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>t</ci>
      <cn type="integer">1</cn>
     </apply>
    </apply>
    <apply>
     <times></times>
     <ci>F</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>t</ci>
      <cn type="integer">1</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   P(t_{1})=F(t_{1}).
  </annotation>
 </semantics>
</math>

</p>

<p>The first order conditions for J<sub>min</sub> are</p>

<p><strong>(i) State equation</strong></p>

<p>

<math display="block" id="Linear-quadratic_regulator:9">
 <semantics>
  <mrow>
   <mover accent="true">
    <mi>x</mi>
    <mo>˙</mo>
   </mover>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mi>A</mi>
     <mi>x</mi>
    </mrow>
    <mo>+</mo>
    <mrow>
     <mi>B</mi>
     <mi>u</mi>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <ci>normal-˙</ci>
     <ci>x</ci>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <ci>A</ci>
      <ci>x</ci>
     </apply>
     <apply>
      <times></times>
      <ci>B</ci>
      <ci>u</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \dot{x}=Ax+Bu
  </annotation>
 </semantics>
</math>

</p>

<p><strong>(ii) <a href="Costate_equations" title="wikilink"> Co-state equation</a></strong></p>

<p>

<math display="block" id="Linear-quadratic_regulator:10">
 <semantics>
  <mrow>
   <mrow>
    <mo>-</mo>
    <mover accent="true">
     <mi>λ</mi>
     <mo>˙</mo>
    </mover>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mi>Q</mi>
     <mi>x</mi>
    </mrow>
    <mo>+</mo>
    <mrow>
     <mi>N</mi>
     <mi>u</mi>
    </mrow>
    <mo>+</mo>
    <mrow>
     <msup>
      <mi>A</mi>
      <mi>T</mi>
     </msup>
     <mi>λ</mi>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <minus></minus>
     <apply>
      <ci>normal-˙</ci>
      <ci>λ</ci>
     </apply>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <ci>Q</ci>
      <ci>x</ci>
     </apply>
     <apply>
      <times></times>
      <ci>N</ci>
      <ci>u</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>A</ci>
       <ci>T</ci>
      </apply>
      <ci>λ</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   -\dot{\lambda}=Qx+Nu+A^{T}\lambda
  </annotation>
 </semantics>
</math>

</p>

<p><strong>(iii) Stationary equation</strong></p>

<p>

<math display="block" id="Linear-quadratic_regulator:11">
 <semantics>
  <mrow>
   <mn>0</mn>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mi>R</mi>
     <mi>u</mi>
    </mrow>
    <mo>+</mo>
    <mrow>
     <msup>
      <mi>N</mi>
      <mi>T</mi>
     </msup>
     <mi>x</mi>
    </mrow>
    <mo>+</mo>
    <mrow>
     <msup>
      <mi>B</mi>
      <mi>T</mi>
     </msup>
     <mi>λ</mi>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <cn type="integer">0</cn>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <ci>R</ci>
      <ci>u</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>N</ci>
       <ci>T</ci>
      </apply>
      <ci>x</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>B</ci>
       <ci>T</ci>
      </apply>
      <ci>λ</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   0=Ru+N^{T}x+B^{T}\lambda
  </annotation>
 </semantics>
</math>

</p>

<p><strong>(iv) Boundary conditions</strong></p>

<p>

<math display="block" id="Linear-quadratic_regulator:12">
 <semantics>
  <mrow>
   <mrow>
    <mi>x</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <msub>
      <mi>t</mi>
      <mn>0</mn>
     </msub>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <msub>
    <mi>x</mi>
    <mn>0</mn>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>x</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>t</ci>
      <cn type="integer">0</cn>
     </apply>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>x</ci>
     <cn type="integer">0</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x(t_{0})=x_{0}
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Linear-quadratic_regulator:13">
 <semantics>
  <mrow>
   <mrow>
    <mi>λ</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <msub>
      <mi>t</mi>
      <mn>1</mn>
     </msub>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mi>F</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <msub>
      <mi>t</mi>
      <mn>1</mn>
     </msub>
     <mo stretchy="false">)</mo>
    </mrow>
    <mi>x</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <msub>
      <mi>t</mi>
      <mn>1</mn>
     </msub>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>λ</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>t</ci>
      <cn type="integer">1</cn>
     </apply>
    </apply>
    <apply>
     <times></times>
     <ci>F</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>t</ci>
      <cn type="integer">1</cn>
     </apply>
     <ci>x</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>t</ci>
      <cn type="integer">1</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \lambda(t_{1})=F(t_{1})x(t_{1})
  </annotation>
 </semantics>
</math>

</p>
<h2 id="infinite-horizon-continuous-time-lqr">Infinite-horizon, continuous-time LQR</h2>

<p>For a continuous-time linear system described by</p>

<p>

<math display="block" id="Linear-quadratic_regulator:14">
 <semantics>
  <mrow>
   <mover accent="true">
    <mi>x</mi>
    <mo>˙</mo>
   </mover>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mi>A</mi>
     <mi>x</mi>
    </mrow>
    <mo>+</mo>
    <mrow>
     <mi>B</mi>
     <mi>u</mi>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <ci>normal-˙</ci>
     <ci>x</ci>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <ci>A</ci>
      <ci>x</ci>
     </apply>
     <apply>
      <times></times>
      <ci>B</ci>
      <ci>u</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \dot{x}=Ax+Bu
  </annotation>
 </semantics>
</math>

</p>

<p>with a cost functional defined as</p>

<p>

<math display="block" id="Linear-quadratic_regulator:15">
 <semantics>
  <mrow>
   <mi>J</mi>
   <mo>=</mo>
   <mrow>
    <msubsup>
     <mo largeop="true" symmetric="true">∫</mo>
     <mn>0</mn>
     <mi mathvariant="normal">∞</mi>
    </msubsup>
    <mrow>
     <mrow>
      <mo>(</mo>
      <mrow>
       <mrow>
        <msup>
         <mi>x</mi>
         <mi>T</mi>
        </msup>
        <mi>Q</mi>
        <mi>x</mi>
       </mrow>
       <mo>+</mo>
       <mrow>
        <msup>
         <mi>u</mi>
         <mi>T</mi>
        </msup>
        <mi>R</mi>
        <mi>u</mi>
       </mrow>
       <mo>+</mo>
       <mrow>
        <mn>2</mn>
        <msup>
         <mi>x</mi>
         <mi>T</mi>
        </msup>
        <mi>N</mi>
        <mi>u</mi>
       </mrow>
      </mrow>
      <mo>)</mo>
     </mrow>
     <mi>d</mi>
     <mi>t</mi>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>J</ci>
    <apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <int></int>
       <cn type="integer">0</cn>
      </apply>
      <infinity></infinity>
     </apply>
     <apply>
      <times></times>
      <apply>
       <plus></plus>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>x</ci>
         <ci>T</ci>
        </apply>
        <ci>Q</ci>
        <ci>x</ci>
       </apply>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>u</ci>
         <ci>T</ci>
        </apply>
        <ci>R</ci>
        <ci>u</ci>
       </apply>
       <apply>
        <times></times>
        <cn type="integer">2</cn>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>x</ci>
         <ci>T</ci>
        </apply>
        <ci>N</ci>
        <ci>u</ci>
       </apply>
      </apply>
      <ci>d</ci>
      <ci>t</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   J=\int_{0}^{\infty}\left(x^{T}Qx+u^{T}Ru+2x^{T}Nu\right)dt
  </annotation>
 </semantics>
</math>

</p>

<p>the feedback control law that minimizes the value of the cost is</p>

<p>

<math display="block" id="Linear-quadratic_regulator:16">
 <semantics>
  <mrow>
   <mi>u</mi>
   <mo>=</mo>
   <mrow>
    <mo>-</mo>
    <mrow>
     <mi>K</mi>
     <mpadded width="+1.7pt">
      <mi>x</mi>
     </mpadded>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>u</ci>
    <apply>
     <minus></minus>
     <apply>
      <times></times>
      <ci>K</ci>
      <ci>x</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   u=-Kx\,
  </annotation>
 </semantics>
</math>

</p>

<p>where 

<math display="inline" id="Linear-quadratic_regulator:17">
 <semantics>
  <mi>K</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>K</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   K
  </annotation>
 </semantics>
</math>

 is given by</p>

<p>

<math display="block" id="Linear-quadratic_regulator:18">
 <semantics>
  <mrow>
   <mi>K</mi>
   <mo>=</mo>
   <mrow>
    <msup>
     <mi>R</mi>
     <mrow>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </msup>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mrow>
       <msup>
        <mi>B</mi>
        <mi>T</mi>
       </msup>
       <mi>P</mi>
      </mrow>
      <mo>+</mo>
      <msup>
       <mi>N</mi>
       <mi>T</mi>
      </msup>
     </mrow>
     <mo rspace="4.2pt" stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>K</ci>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>R</ci>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <apply>
      <plus></plus>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>B</ci>
        <ci>T</ci>
       </apply>
       <ci>P</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>N</ci>
       <ci>T</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   K=R^{-1}(B^{T}P+N^{T})\,
  </annotation>
 </semantics>
</math>

</p>

<p>and 

<math display="inline" id="Linear-quadratic_regulator:19">
 <semantics>
  <mi>P</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>P</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   P
  </annotation>
 </semantics>
</math>

 is found by solving the continuous time <a href="algebraic_Riccati_equation" title="wikilink">algebraic Riccati equation</a></p>

<p>

<math display="block" id="Linear-quadratic_regulator:20">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mrow>
      <mrow>
       <msup>
        <mi>A</mi>
        <mi>T</mi>
       </msup>
       <mi>P</mi>
      </mrow>
      <mo>+</mo>
      <mrow>
       <mi>P</mi>
       <mi>A</mi>
      </mrow>
     </mrow>
     <mo>-</mo>
     <mrow>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mrow>
         <mi>P</mi>
         <mi>B</mi>
        </mrow>
        <mo>+</mo>
        <mi>N</mi>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
      <msup>
       <mi>R</mi>
       <mrow>
        <mo>-</mo>
        <mn>1</mn>
       </mrow>
      </msup>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mrow>
         <msup>
          <mi>B</mi>
          <mi>T</mi>
         </msup>
         <mi>P</mi>
        </mrow>
        <mo>+</mo>
        <msup>
         <mi>N</mi>
         <mi>T</mi>
        </msup>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mrow>
    <mo>+</mo>
    <mi>Q</mi>
   </mrow>
   <mo>=</mo>
   <mpadded width="+1.7pt">
    <mn>0</mn>
   </mpadded>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <plus></plus>
     <apply>
      <minus></minus>
      <apply>
       <plus></plus>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>A</ci>
         <ci>T</ci>
        </apply>
        <ci>P</ci>
       </apply>
       <apply>
        <times></times>
        <ci>P</ci>
        <ci>A</ci>
       </apply>
      </apply>
      <apply>
       <times></times>
       <apply>
        <plus></plus>
        <apply>
         <times></times>
         <ci>P</ci>
         <ci>B</ci>
        </apply>
        <ci>N</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>R</ci>
        <apply>
         <minus></minus>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <apply>
        <plus></plus>
        <apply>
         <times></times>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>B</ci>
          <ci>T</ci>
         </apply>
         <ci>P</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>N</ci>
         <ci>T</ci>
        </apply>
       </apply>
      </apply>
     </apply>
     <ci>Q</ci>
    </apply>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A^{T}P+PA-(PB+N)R^{-1}(B^{T}P+N^{T})+Q=0\,
  </annotation>
 </semantics>
</math>

</p>

<p>This can be also written as</p>

<p>

<math display="block" id="Linear-quadratic_regulator:21">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mrow>
      <mrow>
       <msup>
        <mi class="ltx_font_mathcaligraphic">𝒜</mi>
        <mi>T</mi>
       </msup>
       <mi>P</mi>
      </mrow>
      <mo>+</mo>
      <mrow>
       <mi>P</mi>
       <mi class="ltx_font_mathcaligraphic">𝒜</mi>
      </mrow>
     </mrow>
     <mo>-</mo>
     <mrow>
      <mi>P</mi>
      <mi>B</mi>
      <msup>
       <mi>R</mi>
       <mrow>
        <mo>-</mo>
        <mn>1</mn>
       </mrow>
      </msup>
      <msup>
       <mi>B</mi>
       <mi>T</mi>
      </msup>
      <mi>P</mi>
     </mrow>
    </mrow>
    <mo>+</mo>
    <mi class="ltx_font_mathcaligraphic">𝒬</mi>
   </mrow>
   <mo>=</mo>
   <mpadded width="+1.7pt">
    <mn>0</mn>
   </mpadded>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <plus></plus>
     <apply>
      <minus></minus>
      <apply>
       <plus></plus>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>𝒜</ci>
         <ci>T</ci>
        </apply>
        <ci>P</ci>
       </apply>
       <apply>
        <times></times>
        <ci>P</ci>
        <ci>𝒜</ci>
       </apply>
      </apply>
      <apply>
       <times></times>
       <ci>P</ci>
       <ci>B</ci>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>R</ci>
        <apply>
         <minus></minus>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>B</ci>
        <ci>T</ci>
       </apply>
       <ci>P</ci>
      </apply>
     </apply>
     <ci>𝒬</ci>
    </apply>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathcal{A}^{T}P+P\mathcal{A}-PBR^{-1}B^{T}P+\mathcal{Q}=0\,
  </annotation>
 </semantics>
</math>

</p>

<p>with</p>

<p>

<math display="block" id="Linear-quadratic_regulator:22">
 <semantics>
  <mrow>
   <mrow>
    <mi class="ltx_font_mathcaligraphic">𝒜</mi>
    <mo>=</mo>
    <mrow>
     <mi>A</mi>
     <mo>-</mo>
     <mrow>
      <mi>B</mi>
      <msup>
       <mi>R</mi>
       <mrow>
        <mo>-</mo>
        <mn>1</mn>
       </mrow>
      </msup>
      <msup>
       <mi>N</mi>
       <mi>T</mi>
      </msup>
     </mrow>
    </mrow>
   </mrow>
   <mrow>
    <mi class="ltx_font_mathcaligraphic">𝒬</mi>
    <mo>=</mo>
    <mrow>
     <mi>Q</mi>
     <mo>-</mo>
     <mrow>
      <mi>N</mi>
      <msup>
       <mi>R</mi>
       <mrow>
        <mo>-</mo>
        <mn>1</mn>
       </mrow>
      </msup>
      <mpadded width="+1.7pt">
       <msup>
        <mi>N</mi>
        <mi>T</mi>
       </msup>
      </mpadded>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <eq></eq>
     <ci>𝒜</ci>
     <apply>
      <minus></minus>
      <ci>A</ci>
      <apply>
       <times></times>
       <ci>B</ci>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>R</ci>
        <apply>
         <minus></minus>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>N</ci>
        <ci>T</ci>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <ci>𝒬</ci>
     <apply>
      <minus></minus>
      <ci>Q</ci>
      <apply>
       <times></times>
       <ci>N</ci>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>R</ci>
        <apply>
         <minus></minus>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>N</ci>
        <ci>T</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathcal{A}=A-BR^{-1}N^{T}\qquad\mathcal{Q}=Q-NR^{-1}N^{T}\,
  </annotation>
 </semantics>
</math>

</p>
<h2 id="finite-horizon-discrete-time-lqr">Finite-horizon, discrete-time LQR</h2>

<p>For a discrete-time linear system described by <a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a></p>

<p>

<math display="block" id="Linear-quadratic_regulator:23">
 <semantics>
  <mrow>
   <msub>
    <mi>x</mi>
    <mrow>
     <mi>k</mi>
     <mo>+</mo>
     <mn>1</mn>
    </mrow>
   </msub>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mi>A</mi>
     <msub>
      <mi>x</mi>
      <mi>k</mi>
     </msub>
    </mrow>
    <mo>+</mo>
    <mrow>
     <mi>B</mi>
     <mpadded width="+1.7pt">
      <msub>
       <mi>u</mi>
       <mi>k</mi>
      </msub>
     </mpadded>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>x</ci>
     <apply>
      <plus></plus>
      <ci>k</ci>
      <cn type="integer">1</cn>
     </apply>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <ci>A</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <ci>k</ci>
      </apply>
     </apply>
     <apply>
      <times></times>
      <ci>B</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>u</ci>
       <ci>k</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x_{k+1}=Ax_{k}+Bu_{k}\,
  </annotation>
 </semantics>
</math>

</p>

<p>with a performance index defined as</p>

<p>

<math display="block" id="Linear-quadratic_regulator:24">
 <semantics>
  <mrow>
   <mi>J</mi>
   <mo>=</mo>
   <mrow>
    <munderover>
     <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
     <mrow>
      <mi>k</mi>
      <mo>=</mo>
      <mn>0</mn>
     </mrow>
     <mi>N</mi>
    </munderover>
    <mrow>
     <mo>(</mo>
     <mrow>
      <mrow>
       <msubsup>
        <mi>x</mi>
        <mi>k</mi>
        <mi>T</mi>
       </msubsup>
       <mi>Q</mi>
       <msub>
        <mi>x</mi>
        <mi>k</mi>
       </msub>
      </mrow>
      <mo>+</mo>
      <mrow>
       <msubsup>
        <mi>u</mi>
        <mi>k</mi>
        <mi>T</mi>
       </msubsup>
       <mi>R</mi>
       <msub>
        <mi>u</mi>
        <mi>k</mi>
       </msub>
      </mrow>
      <mo>+</mo>
      <mrow>
       <mn>2</mn>
       <msubsup>
        <mi>x</mi>
        <mi>k</mi>
        <mi>T</mi>
       </msubsup>
       <mi>N</mi>
       <msub>
        <mi>u</mi>
        <mi>k</mi>
       </msub>
      </mrow>
     </mrow>
     <mo>)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>J</ci>
    <apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <apply>
        <eq></eq>
        <ci>k</ci>
        <cn type="integer">0</cn>
       </apply>
      </apply>
      <ci>N</ci>
     </apply>
     <apply>
      <plus></plus>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>x</ci>
         <ci>k</ci>
        </apply>
        <ci>T</ci>
       </apply>
       <ci>Q</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <ci>k</ci>
       </apply>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>u</ci>
         <ci>k</ci>
        </apply>
        <ci>T</ci>
       </apply>
       <ci>R</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>u</ci>
        <ci>k</ci>
       </apply>
      </apply>
      <apply>
       <times></times>
       <cn type="integer">2</cn>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>x</ci>
         <ci>k</ci>
        </apply>
        <ci>T</ci>
       </apply>
       <ci>N</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>u</ci>
        <ci>k</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   J=\sum\limits_{k=0}^{N}\left(x_{k}^{T}Qx_{k}+u_{k}^{T}Ru_{k}+2x_{k}^{T}Nu_{k}\right)
  </annotation>
 </semantics>
</math>

</p>

<p>the optimal control sequence minimizing the performance index is given by</p>

<p>

<math display="block" id="Linear-quadratic_regulator:25">
 <semantics>
  <mrow>
   <msub>
    <mi>u</mi>
    <mi>k</mi>
   </msub>
   <mo>=</mo>
   <mrow>
    <mo>-</mo>
    <mrow>
     <msub>
      <mi>F</mi>
      <mi>k</mi>
     </msub>
     <mpadded width="+1.7pt">
      <msub>
       <mi>x</mi>
       <mi>k</mi>
      </msub>
     </mpadded>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>u</ci>
     <ci>k</ci>
    </apply>
    <apply>
     <minus></minus>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>F</ci>
       <ci>k</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <ci>k</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   u_{k}=-F_{k}x_{k}\,
  </annotation>
 </semantics>
</math>

</p>

<p>where</p>

<p>

<math display="block" id="Linear-quadratic_regulator:26">
 <semantics>
  <mrow>
   <msub>
    <mi>F</mi>
    <mi>k</mi>
   </msub>
   <mo>=</mo>
   <mrow>
    <msup>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mi>R</mi>
       <mo>+</mo>
       <mrow>
        <msup>
         <mi>B</mi>
         <mi>T</mi>
        </msup>
        <msub>
         <mi>P</mi>
         <mi>k</mi>
        </msub>
        <mi>B</mi>
       </mrow>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <mrow>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </msup>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mrow>
       <msup>
        <mi>B</mi>
        <mi>T</mi>
       </msup>
       <msub>
        <mi>P</mi>
        <mi>k</mi>
       </msub>
       <mi>A</mi>
      </mrow>
      <mo>+</mo>
      <msup>
       <mi>N</mi>
       <mi>T</mi>
      </msup>
     </mrow>
     <mo rspace="4.2pt" stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>F</ci>
     <ci>k</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <plus></plus>
       <ci>R</ci>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>B</ci>
         <ci>T</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>P</ci>
         <ci>k</ci>
        </apply>
        <ci>B</ci>
       </apply>
      </apply>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <apply>
      <plus></plus>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>B</ci>
        <ci>T</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>P</ci>
        <ci>k</ci>
       </apply>
       <ci>A</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>N</ci>
       <ci>T</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   F_{k}=(R+B^{T}P_{k}B)^{-1}(B^{T}P_{k}A+N^{T})\,
  </annotation>
 </semantics>
</math>

</p>

<p>and 

<math display="inline" id="Linear-quadratic_regulator:27">
 <semantics>
  <msub>
   <mi>P</mi>
   <mi>k</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>P</ci>
    <ci>k</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   P_{k}
  </annotation>
 </semantics>
</math>

 is found iteratively backwards in time by the dynamic Riccati equation</p>

<p>

<math display="block" id="Linear-quadratic_regulator:28">
 <semantics>
  <mrow>
   <msub>
    <mi>P</mi>
    <mrow>
     <mi>k</mi>
     <mo>-</mo>
     <mn>1</mn>
    </mrow>
   </msub>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mrow>
      <msup>
       <mi>A</mi>
       <mi>T</mi>
      </msup>
      <msub>
       <mi>P</mi>
       <mi>k</mi>
      </msub>
      <mi>A</mi>
     </mrow>
     <mo>-</mo>
     <mrow>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mrow>
         <msup>
          <mi>A</mi>
          <mi>T</mi>
         </msup>
         <msub>
          <mi>P</mi>
          <mi>k</mi>
         </msub>
         <mi>B</mi>
        </mrow>
        <mo>+</mo>
        <mi>N</mi>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
      <msup>
       <mrow>
        <mo>(</mo>
        <mrow>
         <mi>R</mi>
         <mo>+</mo>
         <mrow>
          <msup>
           <mi>B</mi>
           <mi>T</mi>
          </msup>
          <msub>
           <mi>P</mi>
           <mi>k</mi>
          </msub>
          <mi>B</mi>
         </mrow>
        </mrow>
        <mo>)</mo>
       </mrow>
       <mrow>
        <mo>-</mo>
        <mn>1</mn>
       </mrow>
      </msup>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mrow>
         <msup>
          <mi>B</mi>
          <mi>T</mi>
         </msup>
         <msub>
          <mi>P</mi>
          <mi>k</mi>
         </msub>
         <mi>A</mi>
        </mrow>
        <mo>+</mo>
        <msup>
         <mi>N</mi>
         <mi>T</mi>
        </msup>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mrow>
    <mo>+</mo>
    <mi>Q</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>P</ci>
     <apply>
      <minus></minus>
      <ci>k</ci>
      <cn type="integer">1</cn>
     </apply>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <minus></minus>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>A</ci>
        <ci>T</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>P</ci>
        <ci>k</ci>
       </apply>
       <ci>A</ci>
      </apply>
      <apply>
       <times></times>
       <apply>
        <plus></plus>
        <apply>
         <times></times>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>A</ci>
          <ci>T</ci>
         </apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>P</ci>
          <ci>k</ci>
         </apply>
         <ci>B</ci>
        </apply>
        <ci>N</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <plus></plus>
         <ci>R</ci>
         <apply>
          <times></times>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <ci>B</ci>
           <ci>T</ci>
          </apply>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>P</ci>
           <ci>k</ci>
          </apply>
          <ci>B</ci>
         </apply>
        </apply>
        <apply>
         <minus></minus>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <apply>
        <plus></plus>
        <apply>
         <times></times>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>B</ci>
          <ci>T</ci>
         </apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>P</ci>
          <ci>k</ci>
         </apply>
         <ci>A</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>N</ci>
         <ci>T</ci>
        </apply>
       </apply>
      </apply>
     </apply>
     <ci>Q</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   P_{k-1}=A^{T}P_{k}A-(A^{T}P_{k}B+N)\left(R+B^{T}P_{k}B\right)^{-1}(B^{T}P_{k}A%
+N^{T})+Q
  </annotation>
 </semantics>
</math>

</p>

<p>from terminal condition 

<math display="inline" id="Linear-quadratic_regulator:29">
 <semantics>
  <mrow>
   <msub>
    <mi>P</mi>
    <mi>N</mi>
   </msub>
   <mo>=</mo>
   <mi>Q</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>P</ci>
     <ci>N</ci>
    </apply>
    <ci>Q</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   P_{N}=Q
  </annotation>
 </semantics>
</math>

. Note that 

<math display="inline" id="Linear-quadratic_regulator:30">
 <semantics>
  <msub>
   <mi>u</mi>
   <mi>N</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>u</ci>
    <ci>N</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   u_{N}
  </annotation>
 </semantics>
</math>

 is not defined, since 

<math display="inline" id="Linear-quadratic_regulator:31">
 <semantics>
  <mi>x</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>x</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x
  </annotation>
 </semantics>
</math>

 is driven to its final state 

<math display="inline" id="Linear-quadratic_regulator:32">
 <semantics>
  <msub>
   <mi>x</mi>
   <mi>N</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>x</ci>
    <ci>N</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x_{N}
  </annotation>
 </semantics>
</math>

 by 

<math display="inline" id="Linear-quadratic_regulator:33">
 <semantics>
  <mrow>
   <mrow>
    <mi>A</mi>
    <msub>
     <mi>x</mi>
     <mrow>
      <mi>N</mi>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </msub>
   </mrow>
   <mo>+</mo>
   <mrow>
    <mi>B</mi>
    <msub>
     <mi>u</mi>
     <mrow>
      <mi>N</mi>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </msub>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <plus></plus>
    <apply>
     <times></times>
     <ci>A</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <apply>
       <minus></minus>
       <ci>N</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
    </apply>
    <apply>
     <times></times>
     <ci>B</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>u</ci>
      <apply>
       <minus></minus>
       <ci>N</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Ax_{N-1}+Bu_{N-1}
  </annotation>
 </semantics>
</math>

.</p>
<h2 id="infinite-horizon-discrete-time-lqr">Infinite-horizon, discrete-time LQR</h2>

<p>For a discrete-time linear system described by</p>

<p>

<math display="block" id="Linear-quadratic_regulator:34">
 <semantics>
  <mrow>
   <msub>
    <mi>x</mi>
    <mrow>
     <mi>k</mi>
     <mo>+</mo>
     <mn>1</mn>
    </mrow>
   </msub>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mi>A</mi>
     <msub>
      <mi>x</mi>
      <mi>k</mi>
     </msub>
    </mrow>
    <mo>+</mo>
    <mrow>
     <mi>B</mi>
     <mpadded width="+1.7pt">
      <msub>
       <mi>u</mi>
       <mi>k</mi>
      </msub>
     </mpadded>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>x</ci>
     <apply>
      <plus></plus>
      <ci>k</ci>
      <cn type="integer">1</cn>
     </apply>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <ci>A</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <ci>k</ci>
      </apply>
     </apply>
     <apply>
      <times></times>
      <ci>B</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>u</ci>
       <ci>k</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x_{k+1}=Ax_{k}+Bu_{k}\,
  </annotation>
 </semantics>
</math>

</p>

<p>with a performance index defined as</p>

<p>

<math display="block" id="Linear-quadratic_regulator:35">
 <semantics>
  <mrow>
   <mi>J</mi>
   <mo>=</mo>
   <mrow>
    <munderover>
     <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
     <mrow>
      <mi>k</mi>
      <mo>=</mo>
      <mn>0</mn>
     </mrow>
     <mi mathvariant="normal">∞</mi>
    </munderover>
    <mrow>
     <mo>(</mo>
     <mrow>
      <mrow>
       <msubsup>
        <mi>x</mi>
        <mi>k</mi>
        <mi>T</mi>
       </msubsup>
       <mi>Q</mi>
       <msub>
        <mi>x</mi>
        <mi>k</mi>
       </msub>
      </mrow>
      <mo>+</mo>
      <mrow>
       <msubsup>
        <mi>u</mi>
        <mi>k</mi>
        <mi>T</mi>
       </msubsup>
       <mi>R</mi>
       <msub>
        <mi>u</mi>
        <mi>k</mi>
       </msub>
      </mrow>
      <mo>+</mo>
      <mrow>
       <mn>2</mn>
       <msubsup>
        <mi>x</mi>
        <mi>k</mi>
        <mi>T</mi>
       </msubsup>
       <mi>N</mi>
       <msub>
        <mi>u</mi>
        <mi>k</mi>
       </msub>
      </mrow>
     </mrow>
     <mo>)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>J</ci>
    <apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <apply>
        <eq></eq>
        <ci>k</ci>
        <cn type="integer">0</cn>
       </apply>
      </apply>
      <infinity></infinity>
     </apply>
     <apply>
      <plus></plus>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>x</ci>
         <ci>k</ci>
        </apply>
        <ci>T</ci>
       </apply>
       <ci>Q</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <ci>k</ci>
       </apply>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>u</ci>
         <ci>k</ci>
        </apply>
        <ci>T</ci>
       </apply>
       <ci>R</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>u</ci>
        <ci>k</ci>
       </apply>
      </apply>
      <apply>
       <times></times>
       <cn type="integer">2</cn>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>x</ci>
         <ci>k</ci>
        </apply>
        <ci>T</ci>
       </apply>
       <ci>N</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>u</ci>
        <ci>k</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   J=\sum\limits_{k=0}^{\infty}\left(x_{k}^{T}Qx_{k}+u_{k}^{T}Ru_{k}+2x_{k}^{T}Nu%
_{k}\right)
  </annotation>
 </semantics>
</math>

</p>

<p>the optimal control sequence minimizing the performance index is given by</p>

<p>

<math display="block" id="Linear-quadratic_regulator:36">
 <semantics>
  <mrow>
   <msub>
    <mi>u</mi>
    <mi>k</mi>
   </msub>
   <mo>=</mo>
   <mrow>
    <mo>-</mo>
    <mrow>
     <mi>F</mi>
     <mpadded width="+1.7pt">
      <msub>
       <mi>x</mi>
       <mi>k</mi>
      </msub>
     </mpadded>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>u</ci>
     <ci>k</ci>
    </apply>
    <apply>
     <minus></minus>
     <apply>
      <times></times>
      <ci>F</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <ci>k</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   u_{k}=-Fx_{k}\,
  </annotation>
 </semantics>
</math>

</p>

<p>where</p>

<p>

<math display="block" id="Linear-quadratic_regulator:37">
 <semantics>
  <mrow>
   <mi>F</mi>
   <mo>=</mo>
   <mrow>
    <msup>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mi>R</mi>
       <mo>+</mo>
       <mrow>
        <msup>
         <mi>B</mi>
         <mi>T</mi>
        </msup>
        <mi>P</mi>
        <mi>B</mi>
       </mrow>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <mrow>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </msup>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mrow>
       <msup>
        <mi>B</mi>
        <mi>T</mi>
       </msup>
       <mi>P</mi>
       <mi>A</mi>
      </mrow>
      <mo>+</mo>
      <msup>
       <mi>N</mi>
       <mi>T</mi>
      </msup>
     </mrow>
     <mo rspace="4.2pt" stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>F</ci>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <plus></plus>
       <ci>R</ci>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>B</ci>
         <ci>T</ci>
        </apply>
        <ci>P</ci>
        <ci>B</ci>
       </apply>
      </apply>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <apply>
      <plus></plus>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>B</ci>
        <ci>T</ci>
       </apply>
       <ci>P</ci>
       <ci>A</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>N</ci>
       <ci>T</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   F=(R+B^{T}PB)^{-1}(B^{T}PA+N^{T})\,
  </annotation>
 </semantics>
</math>

</p>

<p>and 

<math display="inline" id="Linear-quadratic_regulator:38">
 <semantics>
  <mi>P</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>P</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   P
  </annotation>
 </semantics>
</math>

 is the unique positive definite solution to the discrete time <a href="algebraic_Riccati_equation" title="wikilink">algebraic Riccati equation</a> (DARE)</p>

<p>

<math display="block" id="Linear-quadratic_regulator:39">
 <semantics>
  <mrow>
   <mi>P</mi>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mrow>
      <msup>
       <mi>A</mi>
       <mi>T</mi>
      </msup>
      <mi>P</mi>
      <mi>A</mi>
     </mrow>
     <mo>-</mo>
     <mrow>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mrow>
         <msup>
          <mi>A</mi>
          <mi>T</mi>
         </msup>
         <mi>P</mi>
         <mi>B</mi>
        </mrow>
        <mo>+</mo>
        <mi>N</mi>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
      <msup>
       <mrow>
        <mo>(</mo>
        <mrow>
         <mi>R</mi>
         <mo>+</mo>
         <mrow>
          <msup>
           <mi>B</mi>
           <mi>T</mi>
          </msup>
          <mi>P</mi>
          <mi>B</mi>
         </mrow>
        </mrow>
        <mo>)</mo>
       </mrow>
       <mrow>
        <mo>-</mo>
        <mn>1</mn>
       </mrow>
      </msup>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mrow>
         <msup>
          <mi>B</mi>
          <mi>T</mi>
         </msup>
         <mi>P</mi>
         <mi>A</mi>
        </mrow>
        <mo>+</mo>
        <msup>
         <mi>N</mi>
         <mi>T</mi>
        </msup>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mrow>
    <mo>+</mo>
    <mi>Q</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>P</ci>
    <apply>
     <plus></plus>
     <apply>
      <minus></minus>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>A</ci>
        <ci>T</ci>
       </apply>
       <ci>P</ci>
       <ci>A</ci>
      </apply>
      <apply>
       <times></times>
       <apply>
        <plus></plus>
        <apply>
         <times></times>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>A</ci>
          <ci>T</ci>
         </apply>
         <ci>P</ci>
         <ci>B</ci>
        </apply>
        <ci>N</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <plus></plus>
         <ci>R</ci>
         <apply>
          <times></times>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <ci>B</ci>
           <ci>T</ci>
          </apply>
          <ci>P</ci>
          <ci>B</ci>
         </apply>
        </apply>
        <apply>
         <minus></minus>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <apply>
        <plus></plus>
        <apply>
         <times></times>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>B</ci>
          <ci>T</ci>
         </apply>
         <ci>P</ci>
         <ci>A</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>N</ci>
         <ci>T</ci>
        </apply>
       </apply>
      </apply>
     </apply>
     <ci>Q</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   P=A^{T}PA-(A^{T}PB+N)\left(R+B^{T}PB\right)^{-1}(B^{T}PA+N^{T})+Q
  </annotation>
 </semantics>
</math>

.</p>

<p>This can be also written as</p>

<p>

<math display="block" id="Linear-quadratic_regulator:40">
 <semantics>
  <mrow>
   <mi>P</mi>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mrow>
      <msup>
       <mi class="ltx_font_mathcaligraphic">𝒜</mi>
       <mi>T</mi>
      </msup>
      <mi>P</mi>
      <mi class="ltx_font_mathcaligraphic">𝒜</mi>
     </mrow>
     <mo>-</mo>
     <mrow>
      <msup>
       <mi class="ltx_font_mathcaligraphic">𝒜</mi>
       <mi>T</mi>
      </msup>
      <mi>P</mi>
      <mi>B</mi>
      <msup>
       <mrow>
        <mo>(</mo>
        <mrow>
         <mi>R</mi>
         <mo>+</mo>
         <mrow>
          <msup>
           <mi>B</mi>
           <mi>T</mi>
          </msup>
          <mi>P</mi>
          <mi>B</mi>
         </mrow>
        </mrow>
        <mo>)</mo>
       </mrow>
       <mrow>
        <mo>-</mo>
        <mn>1</mn>
       </mrow>
      </msup>
      <msup>
       <mi>B</mi>
       <mi>T</mi>
      </msup>
      <mi>P</mi>
      <mi class="ltx_font_mathcaligraphic">𝒜</mi>
     </mrow>
    </mrow>
    <mo>+</mo>
    <mi class="ltx_font_mathcaligraphic">𝒬</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>P</ci>
    <apply>
     <plus></plus>
     <apply>
      <minus></minus>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>𝒜</ci>
        <ci>T</ci>
       </apply>
       <ci>P</ci>
       <ci>𝒜</ci>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>𝒜</ci>
        <ci>T</ci>
       </apply>
       <ci>P</ci>
       <ci>B</ci>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <plus></plus>
         <ci>R</ci>
         <apply>
          <times></times>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <ci>B</ci>
           <ci>T</ci>
          </apply>
          <ci>P</ci>
          <ci>B</ci>
         </apply>
        </apply>
        <apply>
         <minus></minus>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>B</ci>
        <ci>T</ci>
       </apply>
       <ci>P</ci>
       <ci>𝒜</ci>
      </apply>
     </apply>
     <ci>𝒬</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   P=\mathcal{A}^{T}P\mathcal{A}-\mathcal{A}^{T}PB\left(R+B^{T}PB\right)^{-1}B^{T%
}P\mathcal{A}+\mathcal{Q}
  </annotation>
 </semantics>
</math>

</p>

<p>with</p>

<p>

<math display="block" id="Linear-quadratic_regulator:41">
 <semantics>
  <mrow>
   <mrow>
    <mi class="ltx_font_mathcaligraphic">𝒜</mi>
    <mo>=</mo>
    <mrow>
     <mi>A</mi>
     <mo>-</mo>
     <mrow>
      <mi>B</mi>
      <msup>
       <mi>R</mi>
       <mrow>
        <mo>-</mo>
        <mn>1</mn>
       </mrow>
      </msup>
      <msup>
       <mi>N</mi>
       <mi>T</mi>
      </msup>
     </mrow>
    </mrow>
   </mrow>
   <mrow>
    <mi class="ltx_font_mathcaligraphic">𝒬</mi>
    <mo>=</mo>
    <mrow>
     <mi>Q</mi>
     <mo>-</mo>
     <mrow>
      <mi>N</mi>
      <msup>
       <mi>R</mi>
       <mrow>
        <mo>-</mo>
        <mn>1</mn>
       </mrow>
      </msup>
      <msup>
       <mi>N</mi>
       <mi>T</mi>
      </msup>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <eq></eq>
     <ci>𝒜</ci>
     <apply>
      <minus></minus>
      <ci>A</ci>
      <apply>
       <times></times>
       <ci>B</ci>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>R</ci>
        <apply>
         <minus></minus>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>N</ci>
        <ci>T</ci>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <ci>𝒬</ci>
     <apply>
      <minus></minus>
      <ci>Q</ci>
      <apply>
       <times></times>
       <ci>N</ci>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>R</ci>
        <apply>
         <minus></minus>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>N</ci>
        <ci>T</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathcal{A}=A-BR^{-1}N^{T}\qquad\mathcal{Q}=Q-NR^{-1}N^{T}
  </annotation>
 </semantics>
</math>

.</p>

<p>Note that one way to solve the algebraic Riccati equation is by iterating the dynamic Riccati equation of the finite-horizon case until it converges.</p>
<h2 id="references">References</h2>
<references>
</references>

<p>:*</p>

<p>:*</p>
<h2 id="external-links">External links</h2>
<ul>
<li><a href="http://www.mathworks.com/help/toolbox/control/ref/lqr.html">MATLAB function for Linear Quadratic Regulator design</a></li>
<li><a href="http://reference.wolfram.com/mathematica/ref/LQRegulatorGains.html">Mathematica function for Linear Quadratic Regulator design</a></li>
</ul>

<p>"</p>

<p><a href="Category:Optimal_control" title="wikilink">Category:Optimal control</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1"><a href="#fnref1">↩</a></li>
</ol>
</section>
</body>
</html>

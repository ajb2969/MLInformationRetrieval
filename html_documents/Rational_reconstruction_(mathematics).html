<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="549">Rational reconstruction (mathematics)</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Rational reconstruction (mathematics)</h1>
<hr/>

<p>In mathematics, <strong>rational reconstruction</strong> is a method that allows one to recover a rational number from its value modulo an integer. If a problem with a rational solution 

<math display="inline" id="Rational_reconstruction_(mathematics):0">
 <semantics>
  <mfrac>
   <mi>r</mi>
   <mi>s</mi>
  </mfrac>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <divide></divide>
    <ci>r</ci>
    <ci>s</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \frac{r}{s}
  </annotation>
 </semantics>
</math>

 is considered modulo a number <em>m</em>, one will obtain the number 

<math display="inline" id="Rational_reconstruction_(mathematics):1">
 <semantics>
  <mrow>
   <mi>n</mi>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mi>r</mi>
     <mo>×</mo>
     <msup>
      <mi>s</mi>
      <mrow>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
     </msup>
    </mrow>
    <mspace width="veryverythickmathspace">
    </mspace>
    <mrow>
     <mo lspace="8.1pt" stretchy="false">(</mo>
     <mrow>
      <mo>mod</mo>
      <mi>m</mi>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>n</ci>
    <apply>
     <csymbol cd="latexml">annotated</csymbol>
     <apply>
      <times></times>
      <ci>r</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>s</ci>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
       </apply>
      </apply>
     </apply>
     <apply>
      <ci>pmod</ci>
      <ci>m</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n=r\times s^{-1}\;\;(\mathop{{\rm mod}}m)
  </annotation>
 </semantics>
</math>

. If |<em>r</em>|  2<em>ND</em> using the <a href="Euclidean_algorithm" title="wikilink">Euclidean algorithm</a>, as follows. <a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a></p>

<p>One puts 

<math display="inline" id="Rational_reconstruction_(mathematics):2">
 <semantics>
  <mrow>
   <mi>v</mi>
   <mo>=</mo>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>m</mi>
    <mo>,</mo>
    <mn>0</mn>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>v</ci>
    <interval closure="open">
     <ci>m</ci>
     <cn type="integer">0</cn>
    </interval>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   v=(m,0)
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Rational_reconstruction_(mathematics):3">
 <semantics>
  <mrow>
   <mi>w</mi>
   <mo>=</mo>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>n</mi>
    <mo>,</mo>
    <mn>1</mn>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>w</ci>
    <interval closure="open">
     <ci>n</ci>
     <cn type="integer">1</cn>
    </interval>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   w=(n,1)
  </annotation>
 </semantics>
</math>


. One then repeats the following steps until the first component of <em>w</em> becomes 

<math display="inline" id="Rational_reconstruction_(mathematics):4">
 <semantics>
  <mrow>
   <mi></mi>
   <mo>≤</mo>
   <mi>N</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <leq></leq>
    <csymbol cd="latexml">absent</csymbol>
    <ci>N</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \leq N
  </annotation>
 </semantics>
</math>

. Put 

<math display="inline" id="Rational_reconstruction_(mathematics):5">
 <semantics>
  <mrow>
   <mi>q</mi>
   <mo>=</mo>
   <mrow>
    <mo>⌊</mo>
    <mfrac>
     <msub>
      <mi>v</mi>
      <mn>1</mn>
     </msub>
     <msub>
      <mi>w</mi>
      <mn>1</mn>
     </msub>
    </mfrac>
    <mo>⌋</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>q</ci>
    <apply>
     <floor></floor>
     <apply>
      <divide></divide>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>v</ci>
       <cn type="integer">1</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>w</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   q=\left\lfloor{\frac{v_{1}}{w_{1}}}\right\rfloor
  </annotation>
 </semantics>
</math>

, put <em>z</em> = <em>v</em> − <em>qw</em>. The new <em>v</em> and <em>w</em> are then obtained by putting <em>v</em> = <em>w</em> and <em>w</em> = <em>z</em>.</p>

<p>Then with <em>w</em> such that 

<math display="inline" id="Rational_reconstruction_(mathematics):6">
 <semantics>
  <mrow>
   <msub>
    <mi>w</mi>
    <mn>1</mn>
   </msub>
   <mo>≤</mo>
   <mi>N</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <leq></leq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>w</ci>
     <cn type="integer">1</cn>
    </apply>
    <ci>N</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   w_{1}\leq N
  </annotation>
 </semantics>
</math>

, one makes the second component positive by putting <em>w</em> = −<em>w</em> if 

<math display="inline" id="Rational_reconstruction_(mathematics):7">
 <semantics>
  <mrow>
   <msub>
    <mi>w</mi>
    <mn>2</mn>
   </msub>
   <mo><</mo>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <lt></lt>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>w</ci>
     <cn type="integer">2</cn>
    </apply>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   w_{2}<0
  </annotation>
 </semantics>
</math>

. If 

<math display="inline" id="Rational_reconstruction_(mathematics):8">
 <semantics>
  <mfrac>
   <mi>r</mi>
   <mi>s</mi>
  </mfrac>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <divide></divide>
    <ci>r</ci>
    <ci>s</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \frac{r}{s}
  </annotation>
 </semantics>
</math>


, then the fraction 

<math display="inline" id="Rational_reconstruction_(mathematics):9">
 <semantics>
  <mrow>
   <mi>r</mi>
   <mo>=</mo>
   <msub>
    <mi>w</mi>
    <mn>1</mn>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>r</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>w</ci>
     <cn type="integer">1</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   r=w_{1}
  </annotation>
 </semantics>
</math>

 exists and 

<math display="inline" id="Rational_reconstruction_(mathematics):10">
 <semantics>
  <mrow>
   <mi>s</mi>
   <mo>=</mo>
   <msub>
    <mi>w</mi>
    <mn>2</mn>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>s</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>w</ci>
     <cn type="integer">2</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   s=w_{2}
  </annotation>
 </semantics>
</math>

 and <span class="LaTeX">$s = w_{2}$</span>, else no such fraction exists.</p>
<h2 id="references">References</h2>
<references>
</references>

<p>"</p>

<p><a href="Category:Number_theory" title="wikilink">Category:Number theory</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1">P. S. Wang, <em>a p-adic algorithm for univariate partial fractions</em>, Proceedings of SYMSAC ´81, ACM Press, 212 (1981); P. S. Wang, M. J. T. Guy, and J. H. Davenport, <em>p-adic reconstruction of rational numbers</em>, SIGSAM Bulletin <strong>16</strong> (1982).<a href="#fnref1">↩</a></li>
</ol>
</section>
</body>
</html>

<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="1178">Mixed logit</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Mixed logit</h1>
<hr/>

<p><strong>Mixed logit</strong> is a fully general statistical model for examining <a href="Discrete_Choice" title="wikilink">discrete choices</a>. The motivation for the mixed logit model arises from the limitations of the standard <a href="Discrete_Choice#F._Logit_with_variables_that_vary_over_alternatives_(also_called_conditional_logit)" title="wikilink">logit</a> model. The standard logit model has three primary limitations, which mixed logit solves: "It [Mixed Logit] obviates the three limitations of standard logit by allowing for random taste variation, unrestricted substitution patterns, and correlation in unobserved factors over time."<a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a> Mixed logit can also utilize any distribution for the random coefficients, unlike probit which is limited to the normal distribution. It has been shown that a mixed logit model can approximate to any degree of accuracy any true random utility model of discrete choice, given an appropriate specification of variables and distribution of coefficients."<a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a> The following discussion draws from <a href="http://eml.berkeley.edu/books/choice2nd/Ch06_p134-150.pdf">Ch. 6</a> of <a href="http://eml.berkeley.edu/books/choice2.html">Discrete Choice Methods with Simulation</a>, by <a href="Kenneth_E._Train" title="wikilink">Kenneth Train</a> (<a href="Cambridge_University_Press" title="wikilink">Cambridge University Press</a>), to which the reader is referred for more details and citations. See also the article on <a href="discrete_choice" title="wikilink">discrete choice</a> for information on how the mixed logit relates to discrete choice analysis in general and to other specific types of choice models.</p>
<h2 id="random-taste-variation">Random taste variation</h2>

<p>The standard logit model's "taste" cofficients, or 

<math display="inline" id="Mixed_logit:0">
 <semantics>
  <mi>β</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>β</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \beta
  </annotation>
 </semantics>
</math>

's, are fixed, which means the 

<math display="inline" id="Mixed_logit:1">
 <semantics>
  <mi>β</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>β</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \beta
  </annotation>
 </semantics>
</math>

's are the same for everyone. Mixed logit has different 

<math display="inline" id="Mixed_logit:2">
 <semantics>
  <mi>β</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>β</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \beta
  </annotation>
 </semantics>
</math>

's for each person (i.e., each decision maker.)</p>

<p>In the standard logit model, the utility of person n for alternative i is:</p>

<p>

<math display="block" id="Mixed_logit:3">
 <semantics>
  <mrow>
   <msub>
    <mi>U</mi>
    <mrow>
     <mi>n</mi>
     <mi>i</mi>
    </mrow>
   </msub>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mi>β</mi>
     <msub>
      <mi>x</mi>
      <mrow>
       <mi>n</mi>
       <mi>i</mi>
      </mrow>
     </msub>
    </mrow>
    <mo>+</mo>
    <msub>
     <mi>ε</mi>
     <mrow>
      <mi>n</mi>
      <mi>i</mi>
     </mrow>
    </msub>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>U</ci>
     <apply>
      <times></times>
      <ci>n</ci>
      <ci>i</ci>
     </apply>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <ci>β</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <apply>
        <times></times>
        <ci>n</ci>
        <ci>i</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>ε</ci>
      <apply>
       <times></times>
       <ci>n</ci>
       <ci>i</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   U_{ni}=\beta x_{ni}+\varepsilon_{ni}
  </annotation>
 </semantics>
</math>

</p>

<p>with</p>

<p>

<math display="block" id="Mixed_logit:4">
 <semantics>
  <msub>
   <mi>ε</mi>
   <mrow>
    <mi>n</mi>
    <mi>i</mi>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>ε</ci>
    <apply>
     <times></times>
     <ci>n</ci>
     <ci>i</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \varepsilon_{ni}
  </annotation>
 </semantics>
</math>

 ~ iid extreme value</p>

<p>For the mixed logit model, this specification is generalized by allowing 

<math display="inline" id="Mixed_logit:5">
 <semantics>
  <msub>
   <mi>β</mi>
   <mi>n</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>β</ci>
    <ci>n</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \beta_{n}
  </annotation>
 </semantics>
</math>

 to be random. The utility of person n for alternative i in the mixed logit model is:</p>

<p>

<math display="block" id="Mixed_logit:6">
 <semantics>
  <mrow>
   <msub>
    <mi>U</mi>
    <mrow>
     <mi>n</mi>
     <mi>i</mi>
    </mrow>
   </msub>
   <mo>=</mo>
   <mrow>
    <mrow>
     <msub>
      <mi>β</mi>
      <mi>n</mi>
     </msub>
     <msub>
      <mi>x</mi>
      <mrow>
       <mi>n</mi>
       <mi>i</mi>
      </mrow>
     </msub>
    </mrow>
    <mo>+</mo>
    <msub>
     <mi>ε</mi>
     <mrow>
      <mi>n</mi>
      <mi>i</mi>
     </mrow>
    </msub>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>U</ci>
     <apply>
      <times></times>
      <ci>n</ci>
      <ci>i</ci>
     </apply>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>β</ci>
       <ci>n</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <apply>
        <times></times>
        <ci>n</ci>
        <ci>i</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>ε</ci>
      <apply>
       <times></times>
       <ci>n</ci>
       <ci>i</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   U_{ni}=\beta_{n}x_{ni}+\varepsilon_{ni}
  </annotation>
 </semantics>
</math>

</p>

<p>with</p>

<p>

<math display="block" id="Mixed_logit:7">
 <semantics>
  <msub>
   <mi>ε</mi>
   <mrow>
    <mi>n</mi>
    <mi>i</mi>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>ε</ci>
    <apply>
     <times></times>
     <ci>n</ci>
     <ci>i</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \varepsilon_{ni}
  </annotation>
 </semantics>
</math>

 ~ iid extreme value</p>

<p>

<math display="block" id="Mixed_logit:8">
 <semantics>
  <mrow>
   <msub>
    <mpadded lspace="10pt" width="+10pt">
     <mi>β</mi>
    </mpadded>
    <mi>n</mi>
   </msub>
   <mo>∼</mo>
   <mi>f</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>β</mi>
    <mo stretchy="false">|</mo>
    <mi>θ</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>β</ci>
     <ci>n</ci>
    </apply>
    <csymbol cd="latexml">similar-to</csymbol>
    <csymbol cd="unknown">f</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">β</csymbol>
     <ci>normal-|</ci>
     <csymbol cd="unknown">θ</csymbol>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \quad\beta_{n}\sim f(\beta|\theta)
  </annotation>
 </semantics>
</math>

</p>

<p>where <em>θ</em> are the parameters of the distribution of 

<math display="inline" id="Mixed_logit:9">
 <semantics>
  <msub>
   <mi>β</mi>
   <mi>n</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>β</ci>
    <ci>n</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \beta_{n}
  </annotation>
 </semantics>
</math>

's over the population, such as the mean and variance of 

<math display="inline" id="Mixed_logit:10">
 <semantics>
  <msub>
   <mi>β</mi>
   <mi>n</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>β</ci>
    <ci>n</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \beta_{n}
  </annotation>
 </semantics>
</math>

.</p>

<p>Conditional on 

<math display="inline" id="Mixed_logit:11">
 <semantics>
  <msub>
   <mi>β</mi>
   <mi>n</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>β</ci>
    <ci>n</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \beta_{n}
  </annotation>
 </semantics>
</math>

, the probability that person n chooses alternative i is the standard logit formula:</p>

<p>

<math display="block" id="Mixed_logit:12">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>L</mi>
     <mrow>
      <mi>n</mi>
      <mi>i</mi>
     </mrow>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <msub>
      <mi>β</mi>
      <mi>n</mi>
     </msub>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mfrac>
    <msup>
     <mi>e</mi>
     <mrow>
      <msub>
       <mi>β</mi>
       <mi>n</mi>
      </msub>
      <msub>
       <mi>X</mi>
       <mrow>
        <mi>n</mi>
        <mi>i</mi>
       </mrow>
      </msub>
     </mrow>
    </msup>
    <mrow>
     <msub>
      <mo largeop="true" symmetric="true">∑</mo>
      <mi>j</mi>
     </msub>
     <msup>
      <mi>e</mi>
      <mrow>
       <msub>
        <mi>β</mi>
        <mi>n</mi>
       </msub>
       <msub>
        <mi>X</mi>
        <mrow>
         <mi>n</mi>
         <mi>j</mi>
        </mrow>
       </msub>
      </mrow>
     </msup>
    </mrow>
   </mfrac>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>L</ci>
      <apply>
       <times></times>
       <ci>n</ci>
       <ci>i</ci>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>β</ci>
      <ci>n</ci>
     </apply>
    </apply>
    <apply>
     <divide></divide>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>e</ci>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>β</ci>
        <ci>n</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>X</ci>
        <apply>
         <times></times>
         <ci>n</ci>
         <ci>i</ci>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <ci>j</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>e</ci>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>β</ci>
         <ci>n</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>X</ci>
         <apply>
          <times></times>
          <ci>n</ci>
          <ci>j</ci>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   L_{ni}(\beta_{n})=\frac{e^{\beta_{n}X_{ni}}}{\sum_{j}e^{\beta_{n}X_{nj}}}
  </annotation>
 </semantics>
</math>

 However, since 

<math display="inline" id="Mixed_logit:13">
 <semantics>
  <msub>
   <mi>β</mi>
   <mi>n</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>β</ci>
    <ci>n</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \beta_{n}
  </annotation>
 </semantics>
</math>


 is random and not known, the (unconditional) choice probability is the integral of this logit formula over the density of 

<math display="inline" id="Mixed_logit:14">
 <semantics>
  <msub>
   <mi>β</mi>
   <mi>n</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>β</ci>
    <ci>n</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \beta_{n}
  </annotation>
 </semantics>
</math>

.</p>

<p>

<math display="block" id="Mixed_logit:15">
 <semantics>
  <mrow>
   <msub>
    <mi>P</mi>
    <mrow>
     <mi>n</mi>
     <mi>i</mi>
    </mrow>
   </msub>
   <mo>=</mo>
   <mo largeop="true" symmetric="true">∫</mo>
   <msub>
    <mi>L</mi>
    <mrow>
     <mi>n</mi>
     <mi>i</mi>
    </mrow>
   </msub>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>β</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mi>f</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>β</mi>
    <mo stretchy="false">|</mo>
    <mi>θ</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mi>d</mi>
   <mi>β</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>P</ci>
     <apply>
      <times></times>
      <ci>n</ci>
      <ci>i</ci>
     </apply>
    </apply>
    <eq></eq>
    <int></int>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>L</ci>
     <apply>
      <times></times>
      <ci>n</ci>
      <ci>i</ci>
     </apply>
    </apply>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">β</csymbol>
     <ci>normal-)</ci>
    </cerror>
    <csymbol cd="unknown">f</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">β</csymbol>
     <ci>normal-|</ci>
     <csymbol cd="unknown">θ</csymbol>
     <ci>normal-)</ci>
    </cerror>
    <csymbol cd="unknown">d</csymbol>
    <csymbol cd="unknown">β</csymbol>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   P_{ni}=\int L_{ni}(\beta)f(\beta|\theta)d\beta
  </annotation>
 </semantics>
</math>

</p>

<p>This model is also called the random coefficient logit model since 

<math display="inline" id="Mixed_logit:16">
 <semantics>
  <msub>
   <mi>β</mi>
   <mi>n</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>β</ci>
    <ci>n</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \beta_{n}
  </annotation>
 </semantics>
</math>

 is a random variable. It allows the slopes of utility (i.e., the marginal utility) to be random, which is an extension of the <a href="random_effects_model" title="wikilink">random effects model</a> where only the intercept was stochastic.</p>

<p>Any <a href="probability_density_function" title="wikilink">probability density function</a> can be specified for the distribution of the coefficients in the population, i.e., for 

<math display="inline" id="Mixed_logit:17">
 <semantics>
  <mrow>
   <mi>f</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>β</mi>
    <mo stretchy="false">|</mo>
    <mi>θ</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">f</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">β</csymbol>
     <ci>normal-|</ci>
     <csymbol cd="unknown">θ</csymbol>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f(\beta|\theta)
  </annotation>
 </semantics>
</math>

. The most widely used distribution is normal, mainly for its simplicity. For coefficients that take the same sign for all people, such as a price coefficient that is necessarily negative or the coefficient of a desirable attribute, distributions with support on only one side of zero, like the lognormal, are used.<a class="footnoteRef" href="#fn3" id="fnref3"><sup>3</sup></a><a class="footnoteRef" href="#fn4" id="fnref4"><sup>4</sup></a> When coefficients cannot logically be unboundedly large or small, then bounded distributions are often used, such as the 

<math display="inline" id="Mixed_logit:18">
 <semantics>
  <msub>
   <mi>S</mi>
   <mi>b</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>S</ci>
    <ci>b</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   S_{b}
  </annotation>
 </semantics>
</math>


 or triangular distributions.</p>
<h2 id="unrestricted-substitution-patterns">Unrestricted substitution patterns</h2>

<p>The mixed logit model can represent general substitution pattern because it does not exhibit logit's restrictive <a href="independence_of_irrelevant_alternatives" title="wikilink">independence of irrelevant alternatives</a> (IIA) property. The percentage change in the probability for one alternative given a percentage change in the <em>m</em>th attribute of another alternative is</p>

<p>

<math display="block" id="Mixed_logit:19">
 <semantics>
  <mrow>
   <msub>
    <mi>E</mi>
    <mrow>
     <mi>n</mi>
     <mi>i</mi>
     <msubsup>
      <mi>x</mi>
      <mrow>
       <mi>n</mi>
       <mi>j</mi>
      </mrow>
      <mi>m</mi>
     </msubsup>
    </mrow>
   </msub>
   <mo>=</mo>
   <mrow>
    <mo>-</mo>
    <mrow>
     <mfrac>
      <msubsup>
       <mi>x</mi>
       <mrow>
        <mi>n</mi>
        <mi>j</mi>
       </mrow>
       <mi>m</mi>
      </msubsup>
      <msub>
       <mi>P</mi>
       <mrow>
        <mi>n</mi>
        <mi>i</mi>
       </mrow>
      </msub>
     </mfrac>
     <mrow>
      <mo largeop="true" symmetric="true">∫</mo>
      <mrow>
       <msup>
        <mi>β</mi>
        <mi>m</mi>
       </msup>
       <msub>
        <mi>L</mi>
        <mrow>
         <mi>n</mi>
         <mi>i</mi>
        </mrow>
       </msub>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>β</mi>
        <mo stretchy="false">)</mo>
       </mrow>
       <msub>
        <mi>L</mi>
        <mrow>
         <mi>n</mi>
         <mi>j</mi>
        </mrow>
       </msub>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>β</mi>
        <mo stretchy="false">)</mo>
       </mrow>
       <mi>f</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>β</mi>
        <mo stretchy="false">)</mo>
       </mrow>
       <mi>d</mi>
       <mi>β</mi>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mo>-</mo>
    <mrow>
     <msubsup>
      <mi>x</mi>
      <mrow>
       <mi>n</mi>
       <mi>j</mi>
      </mrow>
      <mi>m</mi>
     </msubsup>
     <mrow>
      <mo largeop="true" symmetric="true">∫</mo>
      <mrow>
       <msup>
        <mi>β</mi>
        <mi>m</mi>
       </msup>
       <msub>
        <mi>L</mi>
        <mrow>
         <mi>n</mi>
         <mi>j</mi>
        </mrow>
       </msub>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>β</mi>
        <mo stretchy="false">)</mo>
       </mrow>
       <mfrac>
        <mrow>
         <msub>
          <mi>L</mi>
          <mrow>
           <mi>n</mi>
           <mi>i</mi>
          </mrow>
         </msub>
         <mrow>
          <mo stretchy="false">(</mo>
          <mi>β</mi>
          <mo stretchy="false">)</mo>
         </mrow>
        </mrow>
        <msub>
         <mi>P</mi>
         <mrow>
          <mi>n</mi>
          <mi>i</mi>
         </mrow>
        </msub>
       </mfrac>
       <mi>f</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>β</mi>
        <mo stretchy="false">)</mo>
       </mrow>
       <mi>d</mi>
       <mi>β</mi>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>E</ci>
      <apply>
       <times></times>
       <ci>n</ci>
       <ci>i</ci>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>x</ci>
         <apply>
          <times></times>
          <ci>n</ci>
          <ci>j</ci>
         </apply>
        </apply>
        <ci>m</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <minus></minus>
      <apply>
       <times></times>
       <apply>
        <divide></divide>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>x</ci>
          <apply>
           <times></times>
           <ci>n</ci>
           <ci>j</ci>
          </apply>
         </apply>
         <ci>m</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>P</ci>
         <apply>
          <times></times>
          <ci>n</ci>
          <ci>i</ci>
         </apply>
        </apply>
       </apply>
       <apply>
        <int></int>
        <apply>
         <times></times>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>β</ci>
          <ci>m</ci>
         </apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>L</ci>
          <apply>
           <times></times>
           <ci>n</ci>
           <ci>i</ci>
          </apply>
         </apply>
         <ci>β</ci>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>L</ci>
          <apply>
           <times></times>
           <ci>n</ci>
           <ci>j</ci>
          </apply>
         </apply>
         <ci>β</ci>
         <ci>f</ci>
         <ci>β</ci>
         <ci>d</ci>
         <ci>β</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <minus></minus>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>x</ci>
         <apply>
          <times></times>
          <ci>n</ci>
          <ci>j</ci>
         </apply>
        </apply>
        <ci>m</ci>
       </apply>
       <apply>
        <int></int>
        <apply>
         <times></times>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>β</ci>
          <ci>m</ci>
         </apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>L</ci>
          <apply>
           <times></times>
           <ci>n</ci>
           <ci>j</ci>
          </apply>
         </apply>
         <ci>β</ci>
         <apply>
          <divide></divide>
          <apply>
           <times></times>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <ci>L</ci>
            <apply>
             <times></times>
             <ci>n</ci>
             <ci>i</ci>
            </apply>
           </apply>
           <ci>β</ci>
          </apply>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>P</ci>
           <apply>
            <times></times>
            <ci>n</ci>
            <ci>i</ci>
           </apply>
          </apply>
         </apply>
         <ci>f</ci>
         <ci>β</ci>
         <ci>d</ci>
         <ci>β</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   E_{nix_{nj}^{m}}=-\frac{x_{nj}^{m}}{P_{ni}}\int\beta^{m}L_{ni}(\beta)L_{nj}(%
\beta)f(\beta)d\beta=-x_{nj}^{m}\int\beta^{m}L_{nj}(\beta)\frac{L_{ni}(\beta)}%
{P_{ni}}f(\beta)d\beta
  </annotation>
 </semantics>
</math>

</p>

<p>where <em>β</em> <sup><em>m</em></sup> is the <em>m</em>th element of 

<math display="inline" id="Mixed_logit:20">
 <semantics>
  <mi>β</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>β</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \beta
  </annotation>
 </semantics>
</math>

.<a class="footnoteRef" href="#fn5" id="fnref5"><sup>5</sup></a> It can be seen from this formula that "A ten-percent reduction for one alternative need not imply (as with logit) a ten-percent reduction in each other alternative."<a class="footnoteRef" href="#fn6" id="fnref6"><sup>6</sup></a> The relative percentages depend on correlation between the likelihood that respondent n will choose alternative i, <em>L <sub>ni</sub></em>, and the likelihood that respondent n will choose alternative j, <em>L <sub>nj</sub></em>, over various draws of <em>β</em>.</p>
<h2 id="correlation-in-unobserved-factors-over-time">Correlation in unobserved factors over time</h2>

<p>Standard logit does not take into account any unobserved factors that persist over time for a given decision maker. This can be a problem if you are using panel data, which represent repeated choices over time. By applying a standard logit model to panel data you are making the assumption that the unobserved factors that affect a person's choice are new every time the person makes the choice. That is a very unlikely assumption. To take into account both random taste variation and correlation in unobserved factors over time, the utility for respondent n for alternative i at time t is specified as follows:</p>

<p>

<math display="block" id="Mixed_logit:21">
 <semantics>
  <mrow>
   <msub>
    <mi>U</mi>
    <mrow>
     <mi>n</mi>
     <mi>i</mi>
     <mi>t</mi>
    </mrow>
   </msub>
   <mo>=</mo>
   <mrow>
    <mrow>
     <msub>
      <mi>β</mi>
      <mi>n</mi>
     </msub>
     <msub>
      <mi>X</mi>
      <mrow>
       <mi>n</mi>
       <mi>i</mi>
       <mi>t</mi>
      </mrow>
     </msub>
    </mrow>
    <mo>+</mo>
    <msub>
     <mi>ε</mi>
     <mrow>
      <mi>n</mi>
      <mi>i</mi>
      <mi>t</mi>
     </mrow>
    </msub>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>U</ci>
     <apply>
      <times></times>
      <ci>n</ci>
      <ci>i</ci>
      <ci>t</ci>
     </apply>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>β</ci>
       <ci>n</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>X</ci>
       <apply>
        <times></times>
        <ci>n</ci>
        <ci>i</ci>
        <ci>t</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>ε</ci>
      <apply>
       <times></times>
       <ci>n</ci>
       <ci>i</ci>
       <ci>t</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   U_{nit}=\beta_{n}X_{nit}+\varepsilon_{nit}
  </annotation>
 </semantics>
</math>

</p>

<p>where the subscript t is the time dimension. We still make the logit assumption which is that 

<math display="inline" id="Mixed_logit:22">
 <semantics>
  <mi>ε</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>ε</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \varepsilon
  </annotation>
 </semantics>
</math>

 is i.i.d extreme value. That means that 

<math display="inline" id="Mixed_logit:23">
 <semantics>
  <mi>ε</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>ε</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \varepsilon
  </annotation>
 </semantics>
</math>


 is independent over time, people, and alternatives. 

<math display="inline" id="Mixed_logit:24">
 <semantics>
  <mi>ε</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>ε</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \varepsilon
  </annotation>
 </semantics>
</math>

 is essentially just white noise. However, correlation over time and over alternatives arises from the common effect of the 

<math display="inline" id="Mixed_logit:25">
 <semantics>
  <mi>β</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>β</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \beta
  </annotation>
 </semantics>
</math>

's, which enter utility in each time period and each alternative.</p>

<p>To examine the correlation explicitly, assume that the <em>β</em> 's are normally distributed with mean 

<math display="inline" id="Mixed_logit:26">
 <semantics>
  <mover accent="true">
   <mi>β</mi>
   <mo stretchy="false">¯</mo>
  </mover>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-¯</ci>
    <ci>β</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \bar{\beta}
  </annotation>
 </semantics>
</math>

 and variance 

<math display="inline" id="Mixed_logit:27">
 <semantics>
  <msup>
   <mi>σ</mi>
   <mn>2</mn>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>σ</ci>
    <cn type="integer">2</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \sigma^{2}
  </annotation>
 </semantics>
</math>

. Then the <a class="uri" href="utility" title="wikilink">utility</a> equation becomes:</p>

<p>

<math display="block" id="Mixed_logit:28">
 <semantics>
  <mrow>
   <msub>
    <mi>U</mi>
    <mrow>
     <mi>n</mi>
     <mi>i</mi>
     <mi>t</mi>
    </mrow>
   </msub>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mover accent="true">
        <mi>β</mi>
        <mo stretchy="false">¯</mo>
       </mover>
       <mo>+</mo>
       <mrow>
        <mi>σ</mi>
        <msub>
         <mi>η</mi>
         <mi>n</mi>
        </msub>
       </mrow>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <msub>
      <mi>X</mi>
      <mrow>
       <mi>n</mi>
       <mi>i</mi>
       <mi>t</mi>
      </mrow>
     </msub>
    </mrow>
    <mo>+</mo>
    <msub>
     <mi>ε</mi>
     <mrow>
      <mi>n</mi>
      <mi>i</mi>
      <mi>t</mi>
     </mrow>
    </msub>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>U</ci>
     <apply>
      <times></times>
      <ci>n</ci>
      <ci>i</ci>
      <ci>t</ci>
     </apply>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <apply>
       <plus></plus>
       <apply>
        <ci>normal-¯</ci>
        <ci>β</ci>
       </apply>
       <apply>
        <times></times>
        <ci>σ</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>η</ci>
         <ci>n</ci>
        </apply>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>X</ci>
       <apply>
        <times></times>
        <ci>n</ci>
        <ci>i</ci>
        <ci>t</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>ε</ci>
      <apply>
       <times></times>
       <ci>n</ci>
       <ci>i</ci>
       <ci>t</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   U_{nit}=(\bar{\beta}+\sigma\eta_{n})X_{nit}+\varepsilon_{nit}
  </annotation>
 </semantics>
</math>

</p>

<p>and <em>η</em> is a draw from the standard normal density. Rearranging, the equation becomes:</p>

<p>

<math display="block" id="Mixed_logit:29">
 <semantics>
  <mrow>
   <msub>
    <mi>U</mi>
    <mrow>
     <mi>n</mi>
     <mi>i</mi>
     <mi>t</mi>
    </mrow>
   </msub>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mover accent="true">
      <mi>β</mi>
      <mo stretchy="false">¯</mo>
     </mover>
     <msub>
      <mi>X</mi>
      <mrow>
       <mi>n</mi>
       <mi>i</mi>
       <mi>t</mi>
      </mrow>
     </msub>
    </mrow>
    <mo>+</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mrow>
       <mi>σ</mi>
       <msub>
        <mi>η</mi>
        <mi>n</mi>
       </msub>
       <msub>
        <mi>X</mi>
        <mrow>
         <mi>n</mi>
         <mi>i</mi>
         <mi>t</mi>
        </mrow>
       </msub>
      </mrow>
      <mo>+</mo>
      <msub>
       <mi>ε</mi>
       <mrow>
        <mi>n</mi>
        <mi>i</mi>
        <mi>t</mi>
       </mrow>
      </msub>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>U</ci>
     <apply>
      <times></times>
      <ci>n</ci>
      <ci>i</ci>
      <ci>t</ci>
     </apply>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <apply>
       <ci>normal-¯</ci>
       <ci>β</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>X</ci>
       <apply>
        <times></times>
        <ci>n</ci>
        <ci>i</ci>
        <ci>t</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <plus></plus>
      <apply>
       <times></times>
       <ci>σ</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>η</ci>
        <ci>n</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>X</ci>
        <apply>
         <times></times>
         <ci>n</ci>
         <ci>i</ci>
         <ci>t</ci>
        </apply>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>ε</ci>
       <apply>
        <times></times>
        <ci>n</ci>
        <ci>i</ci>
        <ci>t</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   U_{nit}=\bar{\beta}X_{nit}+(\sigma\eta_{n}X_{nit}+\varepsilon_{nit})
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Mixed_logit:30">
 <semantics>
  <mrow>
   <msub>
    <mi>U</mi>
    <mrow>
     <mi>n</mi>
     <mi>i</mi>
     <mi>t</mi>
    </mrow>
   </msub>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mover accent="true">
      <mi>β</mi>
      <mo stretchy="false">¯</mo>
     </mover>
     <msub>
      <mi>X</mi>
      <mrow>
       <mi>n</mi>
       <mi>i</mi>
       <mi>t</mi>
      </mrow>
     </msub>
    </mrow>
    <mo>+</mo>
    <msub>
     <mi>e</mi>
     <mrow>
      <mi>n</mi>
      <mi>i</mi>
      <mi>t</mi>
     </mrow>
    </msub>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>U</ci>
     <apply>
      <times></times>
      <ci>n</ci>
      <ci>i</ci>
      <ci>t</ci>
     </apply>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <apply>
       <ci>normal-¯</ci>
       <ci>β</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>X</ci>
       <apply>
        <times></times>
        <ci>n</ci>
        <ci>i</ci>
        <ci>t</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>e</ci>
      <apply>
       <times></times>
       <ci>n</ci>
       <ci>i</ci>
       <ci>t</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   U_{nit}=\bar{\beta}X_{nit}+e_{nit}
  </annotation>
 </semantics>
</math>

</p>

<p>where the unobserved factors are collected in 

<math display="inline" id="Mixed_logit:31">
 <semantics>
  <mrow>
   <msub>
    <mi>e</mi>
    <mrow>
     <mi>n</mi>
     <mi>i</mi>
     <mi>t</mi>
    </mrow>
   </msub>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mi>σ</mi>
     <msub>
      <mi>η</mi>
      <mi>n</mi>
     </msub>
     <msub>
      <mi>X</mi>
      <mrow>
       <mi>n</mi>
       <mi>i</mi>
       <mi>t</mi>
      </mrow>
     </msub>
    </mrow>
    <mo>+</mo>
    <msub>
     <mi>ε</mi>
     <mrow>
      <mi>n</mi>
      <mi>i</mi>
      <mi>t</mi>
     </mrow>
    </msub>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>e</ci>
     <apply>
      <times></times>
      <ci>n</ci>
      <ci>i</ci>
      <ci>t</ci>
     </apply>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <ci>σ</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>η</ci>
       <ci>n</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>X</ci>
       <apply>
        <times></times>
        <ci>n</ci>
        <ci>i</ci>
        <ci>t</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>ε</ci>
      <apply>
       <times></times>
       <ci>n</ci>
       <ci>i</ci>
       <ci>t</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   e_{nit}=\sigma\eta_{n}X_{nit}+\varepsilon_{nit}
  </annotation>
 </semantics>
</math>

. Of the unobserved factors, 

<math display="inline" id="Mixed_logit:32">
 <semantics>
  <msub>
   <mi>ε</mi>
   <mrow>
    <mi>n</mi>
    <mi>i</mi>
    <mi>t</mi>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>ε</ci>
    <apply>
     <times></times>
     <ci>n</ci>
     <ci>i</ci>
     <ci>t</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \varepsilon_{nit}
  </annotation>
 </semantics>
</math>

 is independent over time, and 

<math display="inline" id="Mixed_logit:33">
 <semantics>
  <mrow>
   <mi>σ</mi>
   <msub>
    <mi>η</mi>
    <mi>n</mi>
   </msub>
   <msub>
    <mi>X</mi>
    <mrow>
     <mi>n</mi>
     <mi>i</mi>
     <mi>t</mi>
    </mrow>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>σ</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>η</ci>
     <ci>n</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>X</ci>
     <apply>
      <times></times>
      <ci>n</ci>
      <ci>i</ci>
      <ci>t</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \sigma\eta_{n}X_{nit}
  </annotation>
 </semantics>
</math>


 is not independent over time or alternatives.</p>

<p>Then the covariance between alternatives 

<math display="inline" id="Mixed_logit:34">
 <semantics>
  <mi>i</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>i</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   i
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Mixed_logit:35">
 <semantics>
  <mi>j</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>j</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   j
  </annotation>
 </semantics>
</math>

 is,</p>

<p>

<math display="block" id="Mixed_logit:36">
 <semantics>
  <mrow>
   <mrow>
    <mi>C</mi>
    <mi>o</mi>
    <mi>v</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <msub>
      <mi>e</mi>
      <mrow>
       <mi>n</mi>
       <mi>i</mi>
       <mi>t</mi>
      </mrow>
     </msub>
     <mo>,</mo>
     <msub>
      <mi>e</mi>
      <mrow>
       <mi>n</mi>
       <mi>j</mi>
       <mi>t</mi>
      </mrow>
     </msub>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <msup>
     <mi>σ</mi>
     <mn>2</mn>
    </msup>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <msub>
       <mi>X</mi>
       <mrow>
        <mi>n</mi>
        <mi>i</mi>
        <mi>t</mi>
       </mrow>
      </msub>
      <msub>
       <mi>X</mi>
       <mrow>
        <mi>n</mi>
        <mi>j</mi>
        <mi>t</mi>
       </mrow>
      </msub>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>C</ci>
     <ci>o</ci>
     <ci>v</ci>
     <interval closure="open">
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>e</ci>
       <apply>
        <times></times>
        <ci>n</ci>
        <ci>i</ci>
        <ci>t</ci>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>e</ci>
       <apply>
        <times></times>
        <ci>n</ci>
        <ci>j</ci>
        <ci>t</ci>
       </apply>
      </apply>
     </interval>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>σ</ci>
      <cn type="integer">2</cn>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>X</ci>
       <apply>
        <times></times>
        <ci>n</ci>
        <ci>i</ci>
        <ci>t</ci>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>X</ci>
       <apply>
        <times></times>
        <ci>n</ci>
        <ci>j</ci>
        <ci>t</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Cov(e_{nit},e_{njt})=\sigma^{2}(X_{nit}X_{njt})
  </annotation>
 </semantics>
</math>

</p>

<p>and the covariance between time 

<math display="inline" id="Mixed_logit:37">
 <semantics>
  <mi>t</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>t</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   t
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Mixed_logit:38">
 <semantics>
  <mi>q</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>q</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   q
  </annotation>
 </semantics>
</math>


 is</p>

<p>

<math display="block" id="Mixed_logit:39">
 <semantics>
  <mrow>
   <mrow>
    <mi>C</mi>
    <mi>o</mi>
    <mi>v</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <msub>
      <mi>e</mi>
      <mrow>
       <mi>n</mi>
       <mi>i</mi>
       <mi>t</mi>
      </mrow>
     </msub>
     <mo>,</mo>
     <msub>
      <mi>e</mi>
      <mrow>
       <mi>n</mi>
       <mi>i</mi>
       <mi>q</mi>
      </mrow>
     </msub>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <msup>
     <mi>σ</mi>
     <mn>2</mn>
    </msup>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <msub>
       <mi>X</mi>
       <mrow>
        <mi>n</mi>
        <mi>i</mi>
        <mi>t</mi>
       </mrow>
      </msub>
      <msub>
       <mi>X</mi>
       <mrow>
        <mi>n</mi>
        <mi>i</mi>
        <mi>q</mi>
       </mrow>
      </msub>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>C</ci>
     <ci>o</ci>
     <ci>v</ci>
     <interval closure="open">
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>e</ci>
       <apply>
        <times></times>
        <ci>n</ci>
        <ci>i</ci>
        <ci>t</ci>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>e</ci>
       <apply>
        <times></times>
        <ci>n</ci>
        <ci>i</ci>
        <ci>q</ci>
       </apply>
      </apply>
     </interval>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>σ</ci>
      <cn type="integer">2</cn>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>X</ci>
       <apply>
        <times></times>
        <ci>n</ci>
        <ci>i</ci>
        <ci>t</ci>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>X</ci>
       <apply>
        <times></times>
        <ci>n</ci>
        <ci>i</ci>
        <ci>q</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Cov(e_{nit},e_{niq})=\sigma^{2}(X_{nit}X_{niq})
  </annotation>
 </semantics>
</math>

</p>

<p>By specifying the X's appropriately, one can obtain any pattern of covariance over time and alternatives.</p>

<p>Conditional on 

<math display="inline" id="Mixed_logit:40">
 <semantics>
  <msub>
   <mi>β</mi>
   <mi>n</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>β</ci>
    <ci>n</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \beta_{n}
  </annotation>
 </semantics>
</math>

, the probability of the sequence of choices by a person is simply the product of the logit probability of each individual choice by that person:</p>

<p>

<math display="block" id="Mixed_logit:41">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>L</mi>
     <mi>n</mi>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <msub>
      <mi>β</mi>
      <mi>n</mi>
     </msub>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <munder>
     <mo largeop="true" movablelimits="false" symmetric="true">∏</mo>
     <mi>t</mi>
    </munder>
    <mfrac>
     <msup>
      <mi>e</mi>
      <mrow>
       <msub>
        <mi>β</mi>
        <mi>n</mi>
       </msub>
       <msub>
        <mi>X</mi>
        <mrow>
         <mi>n</mi>
         <mi>i</mi>
         <mi>t</mi>
        </mrow>
       </msub>
      </mrow>
     </msup>
     <mrow>
      <msub>
       <mo largeop="true" symmetric="true">∑</mo>
       <mi>j</mi>
      </msub>
      <msup>
       <mi>e</mi>
       <mrow>
        <msub>
         <mi>β</mi>
         <mi>n</mi>
        </msub>
        <msub>
         <mi>X</mi>
         <mrow>
          <mi>n</mi>
          <mi>j</mi>
          <mi>t</mi>
         </mrow>
        </msub>
       </mrow>
      </msup>
     </mrow>
    </mfrac>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>L</ci>
      <ci>n</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>β</ci>
      <ci>n</ci>
     </apply>
    </apply>
    <apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <csymbol cd="latexml">product</csymbol>
      <ci>t</ci>
     </apply>
     <apply>
      <divide></divide>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>e</ci>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>β</ci>
         <ci>n</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>X</ci>
         <apply>
          <times></times>
          <ci>n</ci>
          <ci>i</ci>
          <ci>t</ci>
         </apply>
        </apply>
       </apply>
      </apply>
      <apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <ci>j</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>e</ci>
        <apply>
         <times></times>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>β</ci>
          <ci>n</ci>
         </apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>X</ci>
          <apply>
           <times></times>
           <ci>n</ci>
           <ci>j</ci>
           <ci>t</ci>
          </apply>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   L_{n}(\beta_{n})=\prod_{t}\frac{e^{\beta_{n}X_{nit}}}{\sum_{j}e^{\beta_{n}X_{%
njt}}}
  </annotation>
 </semantics>
</math>

</p>

<p>since 

<math display="inline" id="Mixed_logit:42">
 <semantics>
  <msub>
   <mi>ε</mi>
   <mrow>
    <mi>n</mi>
    <mi>i</mi>
    <mi>t</mi>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>ε</ci>
    <apply>
     <times></times>
     <ci>n</ci>
     <ci>i</ci>
     <ci>t</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \varepsilon_{nit}
  </annotation>
 </semantics>
</math>

 is independent over time. Then the (unconditional) probability of the sequence of choices is simply the integral of this product of logits over the density of 

<math display="inline" id="Mixed_logit:43">
 <semantics>
  <mi>β</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>β</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \beta
  </annotation>
 </semantics>
</math>


.</p>

<p>

<math display="block" id="Mixed_logit:44">
 <semantics>
  <mrow>
   <msub>
    <mi>P</mi>
    <mrow>
     <mi>n</mi>
     <mi>i</mi>
    </mrow>
   </msub>
   <mo>=</mo>
   <mo largeop="true" symmetric="true">∫</mo>
   <msub>
    <mi>L</mi>
    <mi>n</mi>
   </msub>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>β</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mi>f</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>β</mi>
    <mo stretchy="false">|</mo>
    <mi>θ</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mi>d</mi>
   <mi>β</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>P</ci>
     <apply>
      <times></times>
      <ci>n</ci>
      <ci>i</ci>
     </apply>
    </apply>
    <eq></eq>
    <int></int>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>L</ci>
     <ci>n</ci>
    </apply>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">β</csymbol>
     <ci>normal-)</ci>
    </cerror>
    <csymbol cd="unknown">f</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">β</csymbol>
     <ci>normal-|</ci>
     <csymbol cd="unknown">θ</csymbol>
     <ci>normal-)</ci>
    </cerror>
    <csymbol cd="unknown">d</csymbol>
    <csymbol cd="unknown">β</csymbol>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   P_{ni}=\int L_{n}(\beta)f(\beta|\theta)d\beta
  </annotation>
 </semantics>
</math>

</p>
<h2 id="simulation">Simulation</h2>

<p>Unfortunately there is no closed form for the integral that enters the choice probability, and so the researcher must simulate P<sub>n</sub>. Fortunately for the researcher, simulating P<sub>n</sub> can be very simple. There are four basic steps to follow</p>

<p>1. Take a draw from the probability density function that you specified for the 'taste' coefficients. That is, take a draw from 

<math display="inline" id="Mixed_logit:45">
 <semantics>
  <mrow>
   <mi>f</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>β</mi>
    <mo stretchy="false">|</mo>
    <mi>θ</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">f</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">β</csymbol>
     <ci>normal-|</ci>
     <csymbol cd="unknown">θ</csymbol>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f(\beta|\theta)
  </annotation>
 </semantics>
</math>

 and label the draw 

<math display="inline" id="Mixed_logit:46">
 <semantics>
  <msup>
   <mi>β</mi>
   <mi>r</mi>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>β</ci>
    <ci>r</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \beta^{r}
  </annotation>
 </semantics>
</math>

, for 

<math display="inline" id="Mixed_logit:47">
 <semantics>
  <mrow>
   <mi>r</mi>
   <mo>=</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>r</ci>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   r=1
  </annotation>
 </semantics>
</math>

 representing the first draw.</p>

<p>2. Calculate 

<math display="inline" id="Mixed_logit:48">
 <semantics>
  <mrow>
   <msub>
    <mi>L</mi>
    <mi>n</mi>
   </msub>
   <mrow>
    <mo stretchy="false">(</mo>
    <msup>
     <mi>β</mi>
     <mi>r</mi>
    </msup>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>L</ci>
     <ci>n</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>β</ci>
     <ci>r</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   L_{n}(\beta^{r})
  </annotation>
 </semantics>
</math>


. (The conditional probability.)</p>

<p>3. Repeat many times, for 

<math display="inline" id="Mixed_logit:49">
 <semantics>
  <mrow>
   <mi>r</mi>
   <mo>=</mo>
   <mrow>
    <mn>2</mn>
    <mo>,</mo>
    <mi mathvariant="normal">…</mi>
    <mo>,</mo>
    <mi>R</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>r</ci>
    <list>
     <cn type="integer">2</cn>
     <ci>normal-…</ci>
     <ci>R</ci>
    </list>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   r=2,...,R
  </annotation>
 </semantics>
</math>

.</p>

<p>4. Average the results</p>

<p>Then the formula for the simulation look like the following,</p>

<p>

<math display="inline" id="Mixed_logit:50">
 <semantics>
  <mrow>
   <msub>
    <mover accent="true">
     <mi>P</mi>
     <mo stretchy="false">~</mo>
    </mover>
    <mrow>
     <mi>n</mi>
     <mi>i</mi>
    </mrow>
   </msub>
   <mo>=</mo>
   <mfrac>
    <mrow>
     <mstyle displaystyle="false">
      <msub>
       <mo largeop="true" symmetric="true">∑</mo>
       <mi>r</mi>
      </msub>
     </mstyle>
     <mrow>
      <msub>
       <mi>L</mi>
       <mi>n</mi>
      </msub>
      <mrow>
       <mo stretchy="false">(</mo>
       <msup>
        <mi>β</mi>
        <mi>r</mi>
       </msup>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mrow>
    <mi>R</mi>
   </mfrac>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <ci>normal-~</ci>
      <ci>P</ci>
     </apply>
     <apply>
      <times></times>
      <ci>n</ci>
      <ci>i</ci>
     </apply>
    </apply>
    <apply>
     <divide></divide>
     <apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <ci>r</ci>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>L</ci>
        <ci>n</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>β</ci>
        <ci>r</ci>
       </apply>
      </apply>
     </apply>
     <ci>R</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \tilde{P}_{ni}=\frac{\sum_{r}L_{n}(\beta^{r})}{R}
  </annotation>
 </semantics>
</math>

</p>

<p>where R is the total number of draws taken from the distribution, and r is one draw.</p>

<p>Once this is done you will have a value for the probability of each alternative i for each respondent n.</p>
<h2 id="references">References</h2>

<p>"</p>

<p><a href="Category:Statistical_models" title="wikilink">Category:Statistical models</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1"><a href="http://eml.berkeley.edu/books/choice2nd/Ch06_p134-150.pdf">Train, K. (2003) Discrete Choice Methods with Simulation</a><a href="#fnref1">↩</a></li>
<li id="fn2"><a href="Daniel_McFadden" title="wikilink">McFadden, D.</a> and <a href="Kenneth_E._Train" title="wikilink">Train, K.</a> (2000). “<a href="http://elsa.berkeley.edu/wp/mcfadden1198/mcfadden1198.pdf">Mixed MNL Models for Discrete Response</a>,” Journal of Applied Econometrics, Vol. 15, No. 5, pp. 447-470,<a href="#fnref2">↩</a></li>
<li id="fn3">David Revelt and <a href="Kenneth_E._Train" title="wikilink">Train, K</a> (1998). "<a href="http://www.jstor.org/stable/pdfplus/2646846.pdf">Mixed Logit with Repeated Choices: Households' Choices of Appliance Efficiency Level</a>," Review of Economics and Statistics, Vol. 80, No. 4, pp. 647-657<a href="#fnref3">↩</a></li>
<li id="fn4"><a href="Kenneth_E._Train" title="wikilink">Train, K</a> (1998)."<a href="http://citeseerx.ist.psu.edu/viewdoc/summary?doi=10.1.1.27.4879">Recreation Demand Models with Taste Variation</a>," Land Economics, Vol. 74, No. 2, pp. 230-239.<a href="#fnref4">↩</a></li>
<li id="fn5">Train, Kenneth<a href="#fnref5">↩</a></li>
<li id="fn6"></li>
</ol>
</section>
</body>
</html>

<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="536">Fortune's algorithm</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Fortune's algorithm</h1>
<hr/>

<p> <strong>Fortune's algorithm</strong> is a <a href="sweep_line_algorithm" title="wikilink">sweep line algorithm</a> for generating a <a href="Voronoi_diagram" title="wikilink">Voronoi diagram</a> from a set of points in a plane using <a href="Big_O_notation" title="wikilink">O</a>(<em>n</em> log <em>n</em>) time and O(<em>n</em>) space.<a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a><a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a> It was originally published by <a href="Steven_Fortune" title="wikilink">Steven Fortune</a> in 1986 in his paper "A sweepline algorithm for Voronoi diagrams."<a class="footnoteRef" href="#fn3" id="fnref3"><sup>3</sup></a></p>
<h2 id="algorithm-description">Algorithm description</h2>

<p>The algorithm maintains both a <a href="sweep_line" title="wikilink">sweep line</a> and a <em>beach line</em>, which both move through the plane as the algorithm progresses. The sweep line is a straight line, which we may by convention assume to be vertical and moving left to right across the plane. At any time during the algorithm, the input points left of the sweep line will have been incorporated into the Voronoi diagram, while the points right of the sweep line will not have been considered yet. The beach line is not a line, but a complicated, <a class="uri" href="piecewise" title="wikilink">piecewise</a> curve to the left of the sweep line, composed of pieces of <a href="parabola" title="wikilink">parabolas</a>; it divides the portion of the plane within which the Voronoi diagram can be known, regardless of what other points might be right of the sweep line, from the rest of the plane. For each point left of the sweep line, one can define a parabola of points equidistant from that point and from the sweep line; the beach line is the boundary of the union of these parabolas. As the sweep line progresses, the vertices of the beach line, at which two parabolas cross, trace out the edges of the Voronoi diagram. The beach line progresses by keeping each parabola base exactly half way between the points initially swept over with the sweep line, and the new position of the sweep line.</p>

<p>The algorithm maintains as data structures a <a href="binary_search_tree" title="wikilink">binary search tree</a> describing the combinatorial structure of the beach line, and a <a href="priority_queue" title="wikilink">priority queue</a> listing potential future events that could change the beach line structure. These events include the addition of another parabola to the beach line (when the sweep line crosses another input point) and the removal of a curve from the beach line (when the sweep line becomes tangent to a circle through some three input points whose parabolas form consecutive segments of the beach line). Each such event may be prioritized by the <em>x</em>-coordinate of the sweep line at the point the event occurs. The algorithm itself then consists of repeatedly removing the next event from the priority queue, finding the changes the event causes in the beach line, and updating the data structures.</p>

<p>As there are O(<em>n</em>) events to process (each being associated with some feature of the Voronoi diagram) and O(log <em>n</em>) time to process an event (each consisting of a constant number of binary search tree and priority queue operations) the total time is O(<em>n</em> log <em>n</em>).</p>
<h3 id="pseudocode">Pseudocode</h3>

<p><a class="uri" href="Pseudocode" title="wikilink">Pseudocode</a> description of the algorithm.<a class="footnoteRef" href="#fn4" id="fnref4"><sup>4</sup></a></p>

<p><code>let </code>

<math display="inline" id="Fortune's_algorithm:0">
 <semantics>
  <mrow>
   <mi></mi>
   <mo>*</mo>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>z</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <csymbol cd="latexml">absent</csymbol>
    <ci>z</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   *(z)
  </annotation>
 </semantics>
</math>

<code> be the transformation </code>

<math display="inline" id="Fortune's_algorithm:1">
 <semantics>
  <mrow>
   <mo>*</mo>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>z</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>z</mi>
     <mi>x</mi>
    </msub>
    <mo>,</mo>
    <msub>
     <mi>z</mi>
     <mi>y</mi>
    </msub>
    <mo>+</mo>
    <mi>d</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>z</mi>
     <mo stretchy="false">)</mo>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <times></times>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">z</csymbol>
     <ci>normal-)</ci>
    </cerror>
    <eq></eq>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>z</ci>
      <ci>x</ci>
     </apply>
     <ci>normal-,</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>z</ci>
      <ci>y</ci>
     </apply>
     <plus></plus>
     <csymbol cd="unknown">d</csymbol>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <ci>normal-(</ci>
      <csymbol cd="unknown">z</csymbol>
      <ci>normal-)</ci>
     </cerror>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   *(z)=(z_{x},z_{y}+d(z))
  </annotation>
 </semantics>
</math>

<code>,</code><br/>
<code>  where </code>

<math display="inline" id="Fortune's_algorithm:2">
 <semantics>
  <mrow>
   <mi>d</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>z</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>d</ci>
    <ci>z</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   d(z)
  </annotation>
 </semantics>
</math>

<code> is the Euclidean distance between </code>

<math display="inline" id="Fortune's_algorithm:3">
 <semantics>
  <mi>z</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>z</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   z
  </annotation>
 </semantics>
</math>


<code> and the nearest site</code><br/>
<code>let </code>

<math display="inline" id="Fortune's_algorithm:4">
 <semantics>
  <mi>T</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>T</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   T
  </annotation>
 </semantics>
</math>

<code> be the "beach line"</code><br/>
<code>let </code>

<math display="inline" id="Fortune's_algorithm:5">
 <semantics>
  <msub>
   <mi>R</mi>
   <mi>p</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>R</ci>
    <ci>p</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   R_{p}
  </annotation>
 </semantics>
</math>

<code> be the region covered by site </code>

<math display="inline" id="Fortune's_algorithm:6">
 <semantics>
  <mi>p</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>p</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p
  </annotation>
 </semantics>
</math>

<code>.</code><br/>
<code>let </code>

<math display="inline" id="Fortune's_algorithm:7">
 <semantics>
  <msub>
   <mi>C</mi>
   <mrow>
    <mi>p</mi>
    <mi>q</mi>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>C</ci>
    <apply>
     <times></times>
     <ci>p</ci>
     <ci>q</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   C_{pq}
  </annotation>
 </semantics>
</math>

<code> be the boundary ray between sites </code>

<math display="inline" id="Fortune's_algorithm:8">
 <semantics>
  <mi>p</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>p</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p
  </annotation>
 </semantics>
</math>


<code> and </code>

<math display="inline" id="Fortune's_algorithm:9">
 <semantics>
  <mi>q</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>q</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   q
  </annotation>
 </semantics>
</math>

<code>.</code><br/>
<code>let </code>

<math display="inline" id="Fortune's_algorithm:10">
 <semantics>
  <mrow>
   <msub>
    <mi>p</mi>
    <mn>1</mn>
   </msub>
   <mo>,</mo>
   <msub>
    <mi>p</mi>
    <mn>2</mn>
   </msub>
   <mo>,</mo>
   <mi mathvariant="normal">…</mi>
   <mo>,</mo>
   <msub>
    <mi>p</mi>
    <mi>m</mi>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <list>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>p</ci>
     <cn type="integer">1</cn>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>p</ci>
     <cn type="integer">2</cn>
    </apply>
    <ci>normal-…</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>p</ci>
     <ci>m</ci>
    </apply>
   </list>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p_{1},p_{2},...,p_{m}
  </annotation>
 </semantics>
</math>

<code> be the sites with minimal </code>

<math display="inline" id="Fortune's_algorithm:11">
 <semantics>
  <mi>y</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>y</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   y
  </annotation>
 </semantics>
</math>

<code>-coordinate, ordered by </code>

<math display="inline" id="Fortune's_algorithm:12">
 <semantics>
  <mi>x</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>x</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x
  </annotation>
 </semantics>
</math>

<code>-coordinate</code><br/>


<math display="inline" id="Fortune's_algorithm:13">
 <semantics>
  <mrow>
   <mi>Q</mi>
   <mo>←</mo>
   <mrow>
    <mrow>
     <mi>S</mi>
     <mo>-</mo>
     <msub>
      <mi>p</mi>
      <mn>1</mn>
     </msub>
    </mrow>
    <mo>,</mo>
    <msub>
     <mi>p</mi>
     <mn>2</mn>
    </msub>
    <mo>,</mo>
    <mi mathvariant="normal">…</mi>
    <mo>,</mo>
    <msub>
     <mi>p</mi>
     <mi>m</mi>
    </msub>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-←</ci>
    <ci>Q</ci>
    <list>
     <apply>
      <minus></minus>
      <ci>S</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>p</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>p</ci>
      <cn type="integer">2</cn>
     </apply>
     <ci>normal-…</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>p</ci>
      <ci>m</ci>
     </apply>
    </list>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Q\leftarrow S-{p_{1},p_{2},...,p_{m}}
  </annotation>
 </semantics>
</math>


<br/>
<code>create initial vertical boundary rays </code>

<math display="inline" id="Fortune's_algorithm:14">
 <semantics>
  <mrow>
   <msubsup>
    <mi>C</mi>
    <mrow>
     <msub>
      <mi>p</mi>
      <mn>1</mn>
     </msub>
     <mo>,</mo>
     <msub>
      <mi>p</mi>
      <mn>2</mn>
     </msub>
    </mrow>
    <mn>0</mn>
   </msubsup>
   <mo>,</mo>
   <msubsup>
    <mi>C</mi>
    <mrow>
     <msub>
      <mi>p</mi>
      <mn>2</mn>
     </msub>
     <mo>,</mo>
     <msub>
      <mi>p</mi>
      <mn>3</mn>
     </msub>
    </mrow>
    <mn>0</mn>
   </msubsup>
   <mo>,</mo>
   <mrow>
    <mi mathvariant="normal">…</mi>
    <msubsup>
     <mi>C</mi>
     <mrow>
      <msub>
       <mi>p</mi>
       <mrow>
        <mi>m</mi>
        <mo>-</mo>
        <mn>1</mn>
       </mrow>
      </msub>
      <mo>,</mo>
      <msub>
       <mi>p</mi>
       <mi>m</mi>
      </msub>
     </mrow>
     <mn>0</mn>
    </msubsup>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <list>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>C</ci>
      <list>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>p</ci>
        <cn type="integer">1</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>p</ci>
        <cn type="integer">2</cn>
       </apply>
      </list>
     </apply>
     <cn type="integer">0</cn>
    </apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>C</ci>
      <list>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>p</ci>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>p</ci>
        <cn type="integer">3</cn>
       </apply>
      </list>
     </apply>
     <cn type="integer">0</cn>
    </apply>
    <apply>
     <times></times>
     <ci>normal-…</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>C</ci>
       <list>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>p</ci>
         <apply>
          <minus></minus>
          <ci>m</ci>
          <cn type="integer">1</cn>
         </apply>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>p</ci>
         <ci>m</ci>
        </apply>
       </list>
      </apply>
      <cn type="integer">0</cn>
     </apply>
    </apply>
   </list>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   C_{p_{1},p_{2}}^{0},C_{p_{2},p_{3}}^{0},...C_{p_{m-1},p_{m}}^{0}
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="inline" id="Fortune's_algorithm:15">
 <semantics>
  <mrow>
   <mi>T</mi>
   <mo>←</mo>
   <mo>*</mo>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>R</mi>
     <msub>
      <mi>p</mi>
      <mn>1</mn>
     </msub>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>,</mo>
   <msubsup>
    <mi>C</mi>
    <mrow>
     <msub>
      <mi>p</mi>
      <mn>1</mn>
     </msub>
     <mo>,</mo>
     <msub>
      <mi>p</mi>
      <mn>2</mn>
     </msub>
    </mrow>
    <mn>0</mn>
   </msubsup>
   <mo>,</mo>
   <mo>*</mo>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>R</mi>
     <msub>
      <mi>p</mi>
      <mn>2</mn>
     </msub>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>,</mo>
   <msubsup>
    <mi>C</mi>
    <mrow>
     <msub>
      <mi>p</mi>
      <mn>2</mn>
     </msub>
     <mo>,</mo>
     <msub>
      <mi>p</mi>
      <mn>3</mn>
     </msub>
    </mrow>
    <mn>0</mn>
   </msubsup>
   <mo>,</mo>
   <mi mathvariant="normal">…</mi>
   <mo>,</mo>
   <mo>*</mo>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>R</mi>
     <msub>
      <mi>p</mi>
      <mrow>
       <mi>m</mi>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
     </msub>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>,</mo>
   <msubsup>
    <mi>C</mi>
    <mrow>
     <msub>
      <mi>p</mi>
      <mrow>
       <mi>m</mi>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
     </msub>
     <mo>,</mo>
     <msub>
      <mi>p</mi>
      <mi>m</mi>
     </msub>
    </mrow>
    <mn>0</mn>
   </msubsup>
   <mo>,</mo>
   <mo>*</mo>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>R</mi>
     <msub>
      <mi>p</mi>
      <mi>m</mi>
     </msub>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">T</csymbol>
    <ci>normal-←</ci>
    <times></times>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>R</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>p</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <ci>normal-,</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>C</ci>
      <list>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>p</ci>
        <cn type="integer">1</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>p</ci>
        <cn type="integer">2</cn>
       </apply>
      </list>
     </apply>
     <cn type="integer">0</cn>
    </apply>
    <ci>normal-,</ci>
    <times></times>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>R</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>p</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <ci>normal-,</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>C</ci>
      <list>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>p</ci>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>p</ci>
        <cn type="integer">3</cn>
       </apply>
      </list>
     </apply>
     <cn type="integer">0</cn>
    </apply>
    <ci>normal-,</ci>
    <ci>normal-…</ci>
    <ci>normal-,</ci>
    <times></times>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>R</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>p</ci>
       <apply>
        <minus></minus>
        <ci>m</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <ci>normal-,</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>C</ci>
      <list>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>p</ci>
        <apply>
         <minus></minus>
         <ci>m</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>p</ci>
        <ci>m</ci>
       </apply>
      </list>
     </apply>
     <cn type="integer">0</cn>
    </apply>
    <ci>normal-,</ci>
    <times></times>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>R</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>p</ci>
       <ci>m</ci>
      </apply>
     </apply>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   T\leftarrow*(R_{p_{1}}),C_{p_{1},p_{2}}^{0},*(R_{p_{2}}),C_{p_{2},p_{3}}^{0},.%
..,*(R_{p_{m-1}}),C_{p_{m-1},p_{m}}^{0},*(R_{p_{m}})
  </annotation>
 </semantics>
</math>

</p>

<p><strong><code>while</code> <code>not</code></strong><code> IsEmpty(</code>

<math display="inline" id="Fortune's_algorithm:16">
 <semantics>
  <mi>Q</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>Q</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Q
  </annotation>
 </semantics>
</math>

<code>) </code><strong><code>do</code></strong><br/>
<code>    </code>

<math display="inline" id="Fortune's_algorithm:17">
 <semantics>
  <mi>p</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>p</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p
  </annotation>
 </semantics>
</math>

<code> ← DeleteMin(</code>

<math display="inline" id="Fortune's_algorithm:18">
 <semantics>
  <mi>Q</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>Q</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Q
  </annotation>
 </semantics>
</math>


<code>)</code><br/>
<code>    </code><strong><code>case</code></strong><code> </code>

<math display="inline" id="Fortune's_algorithm:19">
 <semantics>
  <mi>p</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>p</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p
  </annotation>
 </semantics>
</math>

<code> of</code><br/>
<code>    </code>

<math display="inline" id="Fortune's_algorithm:20">
 <semantics>
  <mi>p</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>p</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p
  </annotation>
 </semantics>
</math>

<code> is a site in </code>

<math display="inline" id="Fortune's_algorithm:21">
 <semantics>
  <mrow>
   <mi></mi>
   <mo>*</mo>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>V</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <csymbol cd="latexml">absent</csymbol>
    <ci>V</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   *(V)
  </annotation>
 </semantics>
</math>

<code>:</code><br/>
<code>        find the occurrence of a region </code>

<math display="inline" id="Fortune's_algorithm:22">
 <semantics>
  <mrow>
   <mi></mi>
   <mo>*</mo>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>R</mi>
     <mi>q</mi>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <csymbol cd="latexml">absent</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>R</ci>
     <ci>q</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   *(R_{q})
  </annotation>
 </semantics>
</math>

<code> in </code>

<math display="inline" id="Fortune's_algorithm:23">
 <semantics>
  <mi>T</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>T</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   T
  </annotation>
 </semantics>
</math>


<code> containing </code>

<math display="inline" id="Fortune's_algorithm:24">
 <semantics>
  <mi>p</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>p</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p
  </annotation>
 </semantics>
</math>

<code>,</code><br/>
<code>          bracketed by </code>

<math display="inline" id="Fortune's_algorithm:25">
 <semantics>
  <msub>
   <mi>C</mi>
   <mrow>
    <mi>r</mi>
    <mi>q</mi>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>C</ci>
    <apply>
     <times></times>
     <ci>r</ci>
     <ci>q</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   C_{rq}
  </annotation>
 </semantics>
</math>

<code> on the left and </code>

<math display="inline" id="Fortune's_algorithm:26">
 <semantics>
  <msub>
   <mi>C</mi>
   <mrow>
    <mi>q</mi>
    <mi>s</mi>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>C</ci>
    <apply>
     <times></times>
     <ci>q</ci>
     <ci>s</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   C_{qs}
  </annotation>
 </semantics>
</math>

<code> on the right</code><br/>
<code>        create new boundary rays </code>

<math display="inline" id="Fortune's_algorithm:27">
 <semantics>
  <msubsup>
   <mi>C</mi>
   <mrow>
    <mi>p</mi>
    <mi>q</mi>
   </mrow>
   <mo>-</mo>
  </msubsup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>C</ci>
     <apply>
      <times></times>
      <ci>p</ci>
      <ci>q</ci>
     </apply>
    </apply>
    <minus></minus>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   C_{pq}^{-}
  </annotation>
 </semantics>
</math>

<code> and </code>

<math display="inline" id="Fortune's_algorithm:28">
 <semantics>
  <msubsup>
   <mi>C</mi>
   <mrow>
    <mi>p</mi>
    <mi>q</mi>
   </mrow>
   <mo>+</mo>
  </msubsup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>C</ci>
     <apply>
      <times></times>
      <ci>p</ci>
      <ci>q</ci>
     </apply>
    </apply>
    <plus></plus>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   C_{pq}^{+}
  </annotation>
 </semantics>
</math>


<code> with bases </code>

<math display="inline" id="Fortune's_algorithm:29">
 <semantics>
  <mi>p</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>p</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p
  </annotation>
 </semantics>
</math>

<br/>
<code>        replace </code>

<math display="inline" id="Fortune's_algorithm:30">
 <semantics>
  <mrow>
   <mi></mi>
   <mo>*</mo>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>R</mi>
     <mi>q</mi>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <csymbol cd="latexml">absent</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>R</ci>
     <ci>q</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   *(R_{q})
  </annotation>
 </semantics>
</math>

<code> with </code>

<math display="inline" id="Fortune's_algorithm:31">
 <semantics>
  <mrow>
   <mo>*</mo>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>R</mi>
     <mi>q</mi>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>,</mo>
   <msubsup>
    <mi>C</mi>
    <mrow>
     <mi>p</mi>
     <mi>q</mi>
    </mrow>
    <mo>-</mo>
   </msubsup>
   <mo>,</mo>
   <mo>*</mo>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>R</mi>
     <mi>p</mi>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>,</mo>
   <msubsup>
    <mi>C</mi>
    <mrow>
     <mi>p</mi>
     <mi>q</mi>
    </mrow>
    <mo>+</mo>
   </msubsup>
   <mo>,</mo>
   <mo>*</mo>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>R</mi>
     <mi>q</mi>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <times></times>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>R</ci>
      <ci>q</ci>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <ci>normal-,</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>C</ci>
      <apply>
       <times></times>
       <ci>p</ci>
       <ci>q</ci>
      </apply>
     </apply>
     <minus></minus>
    </apply>
    <ci>normal-,</ci>
    <times></times>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>R</ci>
      <ci>p</ci>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <ci>normal-,</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>C</ci>
      <apply>
       <times></times>
       <ci>p</ci>
       <ci>q</ci>
      </apply>
     </apply>
     <plus></plus>
    </apply>
    <ci>normal-,</ci>
    <times></times>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>R</ci>
      <ci>q</ci>
     </apply>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   *(R_{q}),C_{pq}^{-},*(R_{p}),C_{pq}^{+},*(R_{q})
  </annotation>
 </semantics>
</math>

<code> in </code>

<math display="inline" id="Fortune's_algorithm:32">
 <semantics>
  <mi>T</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>T</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   T
  </annotation>
 </semantics>
</math>

<br/>
<code>        delete from </code>

<math display="inline" id="Fortune's_algorithm:33">
 <semantics>
  <mi>Q</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>Q</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Q
  </annotation>
 </semantics>
</math>


<code> any intersection between </code>

<math display="inline" id="Fortune's_algorithm:34">
 <semantics>
  <msub>
   <mi>C</mi>
   <mrow>
    <mi>r</mi>
    <mi>q</mi>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>C</ci>
    <apply>
     <times></times>
     <ci>r</ci>
     <ci>q</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   C_{rq}
  </annotation>
 </semantics>
</math>

<code> and </code>

<math display="inline" id="Fortune's_algorithm:35">
 <semantics>
  <msub>
   <mi>C</mi>
   <mrow>
    <mi>q</mi>
    <mi>s</mi>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>C</ci>
    <apply>
     <times></times>
     <ci>q</ci>
     <ci>s</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   C_{qs}
  </annotation>
 </semantics>
</math>

<br/>
<code>        insert into </code>

<math display="inline" id="Fortune's_algorithm:36">
 <semantics>
  <mi>Q</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>Q</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Q
  </annotation>
 </semantics>
</math>

<code> any intersection between </code>

<math display="inline" id="Fortune's_algorithm:37">
 <semantics>
  <msub>
   <mi>C</mi>
   <mrow>
    <mi>r</mi>
    <mi>q</mi>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>C</ci>
    <apply>
     <times></times>
     <ci>r</ci>
     <ci>q</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   C_{rq}
  </annotation>
 </semantics>
</math>

<code> and </code>

<math display="inline" id="Fortune's_algorithm:38">
 <semantics>
  <msubsup>
   <mi>C</mi>
   <mrow>
    <mi>p</mi>
    <mi>q</mi>
   </mrow>
   <mo>-</mo>
  </msubsup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>C</ci>
     <apply>
      <times></times>
      <ci>p</ci>
      <ci>q</ci>
     </apply>
    </apply>
    <minus></minus>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   C_{pq}^{-}
  </annotation>
 </semantics>
</math>


<br/>
<code>        insert into </code>

<math display="inline" id="Fortune's_algorithm:39">
 <semantics>
  <mi>Q</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>Q</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Q
  </annotation>
 </semantics>
</math>

<code> any intersection between </code>

<math display="inline" id="Fortune's_algorithm:40">
 <semantics>
  <msubsup>
   <mi>C</mi>
   <mrow>
    <mi>p</mi>
    <mi>q</mi>
   </mrow>
   <mo>+</mo>
  </msubsup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>C</ci>
     <apply>
      <times></times>
      <ci>p</ci>
      <ci>q</ci>
     </apply>
    </apply>
    <plus></plus>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   C_{pq}^{+}
  </annotation>
 </semantics>
</math>

<code> and </code>

<math display="inline" id="Fortune's_algorithm:41">
 <semantics>
  <msub>
   <mi>C</mi>
   <mrow>
    <mi>q</mi>
    <mi>s</mi>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>C</ci>
    <apply>
     <times></times>
     <ci>q</ci>
     <ci>s</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   C_{qs}
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="inline" id="Fortune's_algorithm:42">
 <semantics>
  <mi>p</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>p</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p
  </annotation>
 </semantics>
</math>

 is a Voronoi vertex in 

<math display="inline" id="Fortune's_algorithm:43">
 <semantics>
  <mrow>
   <mi></mi>
   <mo>*</mo>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>V</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <csymbol cd="latexml">absent</csymbol>
    <ci>V</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   *(V)
  </annotation>
 </semantics>
</math>


:</p>

<p><code>        let </code>

<math display="inline" id="Fortune's_algorithm:44">
 <semantics>
  <mi>p</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>p</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p
  </annotation>
 </semantics>
</math>

<code> be the intersection of </code>

<math display="inline" id="Fortune's_algorithm:45">
 <semantics>
  <msub>
   <mi>C</mi>
   <mrow>
    <mi>q</mi>
    <mi>r</mi>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>C</ci>
    <apply>
     <times></times>
     <ci>q</ci>
     <ci>r</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   C_{qr}
  </annotation>
 </semantics>
</math>

<code> on the left and </code>

<math display="inline" id="Fortune's_algorithm:46">
 <semantics>
  <msub>
   <mi>C</mi>
   <mrow>
    <mi>r</mi>
    <mi>s</mi>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>C</ci>
    <apply>
     <times></times>
     <ci>r</ci>
     <ci>s</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   C_{rs}
  </annotation>
 </semantics>
</math>

<code> on the right</code><br/>
<code>        let </code>

<math display="inline" id="Fortune's_algorithm:47">
 <semantics>
  <msub>
   <mi>C</mi>
   <mrow>
    <mi>u</mi>
    <mi>q</mi>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>C</ci>
    <apply>
     <times></times>
     <ci>u</ci>
     <ci>q</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   C_{uq}
  </annotation>
 </semantics>
</math>

<code> be the left neighbor of </code>

<math display="inline" id="Fortune's_algorithm:48">
 <semantics>
  <msub>
   <mi>C</mi>
   <mrow>
    <mi>q</mi>
    <mi>r</mi>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>C</ci>
    <apply>
     <times></times>
     <ci>q</ci>
     <ci>r</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   C_{qr}
  </annotation>
 </semantics>
</math>


<code> and</code><br/>
<code>          let </code>

<math display="inline" id="Fortune's_algorithm:49">
 <semantics>
  <msub>
   <mi>C</mi>
   <mrow>
    <mi>s</mi>
    <mi>v</mi>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>C</ci>
    <apply>
     <times></times>
     <ci>s</ci>
     <ci>v</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   C_{sv}
  </annotation>
 </semantics>
</math>

<code> be the right neighbor of </code>

<math display="inline" id="Fortune's_algorithm:50">
 <semantics>
  <msub>
   <mi>C</mi>
   <mrow>
    <mi>r</mi>
    <mi>s</mi>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>C</ci>
    <apply>
     <times></times>
     <ci>r</ci>
     <ci>s</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   C_{rs}
  </annotation>
 </semantics>
</math>

<code> in </code>

<math display="inline" id="Fortune's_algorithm:51">
 <semantics>
  <mi>T</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>T</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   T
  </annotation>
 </semantics>
</math>

<br/>
<code>        create a new boundary ray </code>

<math display="inline" id="Fortune's_algorithm:52">
 <semantics>
  <msubsup>
   <mi>C</mi>
   <mrow>
    <mi>q</mi>
    <mi>s</mi>
   </mrow>
   <mn>0</mn>
  </msubsup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>C</ci>
     <apply>
      <times></times>
      <ci>q</ci>
      <ci>s</ci>
     </apply>
    </apply>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   C_{qs}^{0}
  </annotation>
 </semantics>
</math>

<code> if </code>

<math display="inline" id="Fortune's_algorithm:53">
 <semantics>
  <mrow>
   <msub>
    <mi>q</mi>
    <mi>y</mi>
   </msub>
   <mo>=</mo>
   <msub>
    <mi>s</mi>
    <mi>y</mi>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>q</ci>
     <ci>y</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>s</ci>
     <ci>y</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   q_{y}=s_{y}
  </annotation>
 </semantics>
</math>


<code>,</code><br/>
<code>          or create </code>

<math display="inline" id="Fortune's_algorithm:54">
 <semantics>
  <msubsup>
   <mi>C</mi>
   <mrow>
    <mi>q</mi>
    <mi>s</mi>
   </mrow>
   <mo>+</mo>
  </msubsup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>C</ci>
     <apply>
      <times></times>
      <ci>q</ci>
      <ci>s</ci>
     </apply>
    </apply>
    <plus></plus>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   C_{qs}^{+}
  </annotation>
 </semantics>
</math>

<code> if </code>

<math display="inline" id="Fortune's_algorithm:55">
 <semantics>
  <mi>p</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>p</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p
  </annotation>
 </semantics>
</math>

<code> is right of the higher of </code>

<math display="inline" id="Fortune's_algorithm:56">
 <semantics>
  <mi>q</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>q</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   q
  </annotation>
 </semantics>
</math>

<code> and </code>

<math display="inline" id="Fortune's_algorithm:57">
 <semantics>
  <mi>s</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>s</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   s
  </annotation>
 </semantics>
</math>

<code>,</code><br/>
<code>          otherwise create </code>

<math display="inline" id="Fortune's_algorithm:58">
 <semantics>
  <msubsup>
   <mi>C</mi>
   <mrow>
    <mi>q</mi>
    <mi>s</mi>
   </mrow>
   <mo>-</mo>
  </msubsup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>C</ci>
     <apply>
      <times></times>
      <ci>q</ci>
      <ci>s</ci>
     </apply>
    </apply>
    <minus></minus>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   C_{qs}^{-}
  </annotation>
 </semantics>
</math>


<br/>
<code>        replace </code>

<math display="inline" id="Fortune's_algorithm:59">
 <semantics>
  <mrow>
   <msub>
    <mi>C</mi>
    <mrow>
     <mi>q</mi>
     <mi>r</mi>
    </mrow>
   </msub>
   <mo>,</mo>
   <mo>*</mo>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>R</mi>
     <mi>r</mi>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>,</mo>
   <msub>
    <mi>C</mi>
    <mrow>
     <mi>r</mi>
     <mi>s</mi>
    </mrow>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>C</ci>
     <apply>
      <times></times>
      <ci>q</ci>
      <ci>r</ci>
     </apply>
    </apply>
    <ci>normal-,</ci>
    <times></times>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>R</ci>
      <ci>r</ci>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <ci>normal-,</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>C</ci>
     <apply>
      <times></times>
      <ci>r</ci>
      <ci>s</ci>
     </apply>
    </apply>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   C_{qr},*(R_{r}),C_{rs}
  </annotation>
 </semantics>
</math>

<code> with newly created </code>

<math display="inline" id="Fortune's_algorithm:60">
 <semantics>
  <msub>
   <mi>C</mi>
   <mrow>
    <mi>q</mi>
    <mi>s</mi>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>C</ci>
    <apply>
     <times></times>
     <ci>q</ci>
     <ci>s</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   C_{qs}
  </annotation>
 </semantics>
</math>

<code> in </code>

<math display="inline" id="Fortune's_algorithm:61">
 <semantics>
  <mi>T</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>T</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   T
  </annotation>
 </semantics>
</math>

<br/>
<code>        delete from </code>

<math display="inline" id="Fortune's_algorithm:62">
 <semantics>
  <mi>Q</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>Q</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Q
  </annotation>
 </semantics>
</math>

<code> any intersection between </code>

<math display="inline" id="Fortune's_algorithm:63">
 <semantics>
  <msub>
   <mi>C</mi>
   <mrow>
    <mi>u</mi>
    <mi>q</mi>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>C</ci>
    <apply>
     <times></times>
     <ci>u</ci>
     <ci>q</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   C_{uq}
  </annotation>
 </semantics>
</math>


<code> and </code>

<math display="inline" id="Fortune's_algorithm:64">
 <semantics>
  <msub>
   <mi>C</mi>
   <mrow>
    <mi>q</mi>
    <mi>r</mi>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>C</ci>
    <apply>
     <times></times>
     <ci>q</ci>
     <ci>r</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   C_{qr}
  </annotation>
 </semantics>
</math>

<br/>
<code>        delete from </code>

<math display="inline" id="Fortune's_algorithm:65">
 <semantics>
  <mi>Q</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>Q</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Q
  </annotation>
 </semantics>
</math>

<code> any intersection between </code>

<math display="inline" id="Fortune's_algorithm:66">
 <semantics>
  <msub>
   <mi>C</mi>
   <mrow>
    <mi>r</mi>
    <mi>s</mi>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>C</ci>
    <apply>
     <times></times>
     <ci>r</ci>
     <ci>s</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   C_{rs}
  </annotation>
 </semantics>
</math>

<code> and </code>

<math display="inline" id="Fortune's_algorithm:67">
 <semantics>
  <msub>
   <mi>C</mi>
   <mrow>
    <mi>s</mi>
    <mi>v</mi>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>C</ci>
    <apply>
     <times></times>
     <ci>s</ci>
     <ci>v</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   C_{sv}
  </annotation>
 </semantics>
</math>

<br/>
<code>        insert into </code>

<math display="inline" id="Fortune's_algorithm:68">
 <semantics>
  <mi>Q</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>Q</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Q
  </annotation>
 </semantics>
</math>


<code> any intersection between </code>

<math display="inline" id="Fortune's_algorithm:69">
 <semantics>
  <msub>
   <mi>C</mi>
   <mrow>
    <mi>u</mi>
    <mi>q</mi>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>C</ci>
    <apply>
     <times></times>
     <ci>u</ci>
     <ci>q</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   C_{uq}
  </annotation>
 </semantics>
</math>

<code> and </code>

<math display="inline" id="Fortune's_algorithm:70">
 <semantics>
  <msub>
   <mi>C</mi>
   <mrow>
    <mi>q</mi>
    <mi>s</mi>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>C</ci>
    <apply>
     <times></times>
     <ci>q</ci>
     <ci>s</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   C_{qs}
  </annotation>
 </semantics>
</math>

<br/>
<code>        insert into </code>

<math display="inline" id="Fortune's_algorithm:71">
 <semantics>
  <mi>Q</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>Q</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Q
  </annotation>
 </semantics>
</math>

<code> any intersection between </code>

<math display="inline" id="Fortune's_algorithm:72">
 <semantics>
  <msub>
   <mi>C</mi>
   <mrow>
    <mi>q</mi>
    <mi>s</mi>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>C</ci>
    <apply>
     <times></times>
     <ci>q</ci>
     <ci>s</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   C_{qs}
  </annotation>
 </semantics>
</math>

<code> and </code>

<math display="inline" id="Fortune's_algorithm:73">
 <semantics>
  <msub>
   <mi>C</mi>
   <mrow>
    <mi>s</mi>
    <mi>v</mi>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>C</ci>
    <apply>
     <times></times>
     <ci>s</ci>
     <ci>v</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   C_{sv}
  </annotation>
 </semantics>
</math>


<br/>
<code>        record </code>

<math display="inline" id="Fortune's_algorithm:74">
 <semantics>
  <mi>p</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>p</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p
  </annotation>
 </semantics>
</math>

<code> as the summit of </code>

<math display="inline" id="Fortune's_algorithm:75">
 <semantics>
  <msub>
   <mi>C</mi>
   <mrow>
    <mi>q</mi>
    <mi>r</mi>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>C</ci>
    <apply>
     <times></times>
     <ci>q</ci>
     <ci>r</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   C_{qr}
  </annotation>
 </semantics>
</math>

<code> and </code>

<math display="inline" id="Fortune's_algorithm:76">
 <semantics>
  <msub>
   <mi>C</mi>
   <mrow>
    <mi>r</mi>
    <mi>s</mi>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>C</ci>
    <apply>
     <times></times>
     <ci>r</ci>
     <ci>s</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   C_{rs}
  </annotation>
 </semantics>
</math>

<code> and the base of </code>

<math display="inline" id="Fortune's_algorithm:77">
 <semantics>
  <msub>
   <mi>C</mi>
   <mrow>
    <mi>q</mi>
    <mi>s</mi>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>C</ci>
    <apply>
     <times></times>
     <ci>q</ci>
     <ci>s</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   C_{qs}
  </annotation>
 </semantics>
</math>

<br/>
<code>        output the boundary segments </code>

<math display="inline" id="Fortune's_algorithm:78">
 <semantics>
  <msub>
   <mi>C</mi>
   <mrow>
    <mi>q</mi>
    <mi>r</mi>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>C</ci>
    <apply>
     <times></times>
     <ci>q</ci>
     <ci>r</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   C_{qr}
  </annotation>
 </semantics>
</math>


<code> and </code>

<math display="inline" id="Fortune's_algorithm:79">
 <semantics>
  <msub>
   <mi>C</mi>
   <mrow>
    <mi>r</mi>
    <mi>s</mi>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>C</ci>
    <apply>
     <times></times>
     <ci>r</ci>
     <ci>s</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   C_{rs}
  </annotation>
 </semantics>
</math>

<br/>
<code>    </code><strong><code>endcase</code></strong><br/>
<strong><code>endwhile</code></strong><br/>
<code>output the remaining boundary rays in </code>

<math display="inline" id="Fortune's_algorithm:80">
 <semantics>
  <mi>T</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>T</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   T
  </annotation>
 </semantics>
</math>

</p>
<h2 id="weighted-sites-and-disks">Weighted sites and disks</h2>

<p>As Fortune describes in <a class="footnoteRef" href="#fn5" id="fnref5"><sup>5</sup></a> a modified version of the sweepline algorithm can be used to construct an additively weighted Voronoi diagram, in which the distance to each site is offset by the weight of the site; this may equivalently be viewed as a Voronoi diagram of a set of disks, centered at the sites with radius equal to the weight of the site.</p>

<p>Weighted sites may be used to control the areas of the Voronoi cells when using Voronoi diagrams to construct <a href="treemap" title="wikilink">treemaps</a>. In an additively weighted Voronoi diagram, the bisector between sites is in general a hyperbola, in contrast to unweighted Voronoi diagrams and <a href="power_diagram" title="wikilink">power diagrams</a> of disks for which it is a straight line.</p>
<h2 id="references">References</h2>
<h2 id="external-links">External links</h2>
<ul>
<li><a href="http://ect.bell-labs.com/who/sjf/voronoi.tar">Steven Fortune's C implementation</a></li>
<li><a href="http://skynet.ie/~sos/mapviewer/voronoi.php">Fortune's Voronoi algorithm implemented in C++</a></li>
<li><a href="https://github.com/gorhill/Javascript-Voronoi">Fortune's algorithm implemented in JavaScript</a></li>
</ul>

<p>"</p>

<p><a href="Category:Computational_geometry" title="wikilink">Category:Computational geometry</a> <a href="Category:Articles_with_example_pseudocode" title="wikilink">Category:Articles with example pseudocode</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1"> Section 7.2: Computing the Voronoi Diagram: pp.151–160.<a href="#fnref1">↩</a></li>
<li id="fn2">.<a href="#fnref2">↩</a></li>
<li id="fn3">Steven Fortune. A sweepline algorithm for Voronoi diagrams. <em>Proceedings of the second annual symposium on Computational geometry</em>. Yorktown Heights, New York, United States, pp.313–322. 1986. ISBN 0-89791-194-6. <a href="http://portal.acm.org/citation.cfm?id=10549">ACM Digital Library</a><a href="http://www.springerlink.com/content/n88186tl165168rw/">SpringerLink</a><a href="#fnref3">↩</a></li>
<li id="fn4">.<a href="#fnref4">↩</a></li>
<li id="fn5"></li>
</ol>
</section>
</body>
</html>

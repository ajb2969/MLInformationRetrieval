<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="1507">Szemerédi–Trotter theorem</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Szemerédi–Trotter theorem</h1>
<hr/>

<p>The <strong>Szemerédi–Trotter theorem</strong> is a <a href="mathematics" title="wikilink">mathematical</a> result in the field of <a href="combinatorial_geometry" title="wikilink">combinatorial geometry</a>. It asserts that given 

<math display="inline" id="Szemerédi–Trotter_theorem:0">
<semantics>
<mi>n</mi>
<annotation-xml encoding="MathML-Content">
<ci>n</ci>
</annotation-xml>
<annotation encoding="application/x-tex">
   n
  </annotation>
</semantics>
</math>

 points and 

<math display="inline" id="Szemerédi–Trotter_theorem:1">
<semantics>
<mi>m</mi>
<annotation-xml encoding="MathML-Content">
<ci>m</ci>
</annotation-xml>
<annotation encoding="application/x-tex">
   m
  </annotation>
</semantics>
</math>

 lines in the plane, the number of <a href="Incidence_(geometry)" title="wikilink">incidences</a> (i.e. the number of point-line pairs, such that the point lies on the line) is</p>

<p>
<math display="block" id="Szemerédi–Trotter_theorem:2">
<semantics>
<mrow>
<mrow>
<mi>O</mi>
<mrow>
<mo>(</mo>
<mrow>
<mrow>
<msup>
<mi>n</mi>
<mfrac>
<mn>2</mn>
<mn>3</mn>
</mfrac>
</msup>
<msup>
<mi>m</mi>
<mfrac>
<mn>2</mn>
<mn>3</mn>
</mfrac>
</msup>
</mrow>
<mo>+</mo>
<mi>n</mi>
<mo>+</mo>
<mi>m</mi>
</mrow>
<mo>)</mo>
</mrow>
</mrow>
<mo>,</mo>
</mrow>
<annotation-xml encoding="MathML-Content">
<apply>
<times></times>
<ci>O</ci>
<apply>
<plus></plus>
<apply>
<times></times>
<apply>
<csymbol cd="ambiguous">superscript</csymbol>
<ci>n</ci>
<apply>
<divide></divide>
<cn type="integer">2</cn>
<cn type="integer">3</cn>
</apply>
</apply>
<apply>
<csymbol cd="ambiguous">superscript</csymbol>
<ci>m</ci>
<apply>
<divide></divide>
<cn type="integer">2</cn>
<cn type="integer">3</cn>
</apply>
</apply>
</apply>
<ci>n</ci>
<ci>m</ci>
</apply>
</apply>
</annotation-xml>
<annotation encoding="application/x-tex">
   O\left(n^{\frac{2}{3}}m^{\frac{2}{3}}+n+m\right),
  </annotation>
</semantics>
</math>
</p>

<p>this bound cannot be improved, except in terms of the implicit constants.</p>

<p>An equivalent formulation of the theorem is the following. Given 

<math display="inline" id="Szemerédi–Trotter_theorem:3">
<semantics>
<mi>n</mi>
<annotation-xml encoding="MathML-Content">
<ci>n</ci>
</annotation-xml>
<annotation encoding="application/x-tex">
   n
  </annotation>
</semantics>
</math>


 points and an integer 

<math display="inline" id="Szemerédi–Trotter_theorem:4">
<semantics>
<mrow>
<mi>k</mi>
<mo>&gt;</mo>
<mn>2</mn>
</mrow>
<annotation-xml encoding="MathML-Content">
<apply>
<gt></gt>
<ci>k</ci>
<cn type="integer">2</cn>
</apply>
</annotation-xml>
<annotation encoding="application/x-tex">
   k&gt;2
  </annotation>
</semantics>
</math>

, the number of lines which pass through at least 

<math display="inline" id="Szemerédi–Trotter_theorem:5">
<semantics>
<mi>k</mi>
<annotation-xml encoding="MathML-Content">
<ci>k</ci>
</annotation-xml>
<annotation encoding="application/x-tex">
   k
  </annotation>
</semantics>
</math>

 of the points is</p>

<p>
<math display="block" id="Szemerédi–Trotter_theorem:6">
<semantics>
<mrow>
<mrow>
<mi>O</mi>
<mrow>
<mo>(</mo>
<mrow>
<mfrac>
<msup>
<mi>n</mi>
<mn>2</mn>
</msup>
<msup>
<mi>k</mi>
<mn>3</mn>
</msup>
</mfrac>
<mo>+</mo>
<mfrac>
<mi>n</mi>
<mi>k</mi>
</mfrac>
</mrow>
<mo>)</mo>
</mrow>
</mrow>
<mo>.</mo>
</mrow>
<annotation-xml encoding="MathML-Content">
<apply>
<times></times>
<ci>O</ci>
<apply>
<plus></plus>
<apply>
<divide></divide>
<apply>
<csymbol cd="ambiguous">superscript</csymbol>
<ci>n</ci>
<cn type="integer">2</cn>
</apply>
<apply>
<csymbol cd="ambiguous">superscript</csymbol>
<ci>k</ci>
<cn type="integer">3</cn>
</apply>
</apply>
<apply>
<divide></divide>
<ci>n</ci>
<ci>k</ci>
</apply>
</apply>
</apply>
</annotation-xml>
<annotation encoding="application/x-tex">
   O\left(\frac{n^{2}}{k^{3}}+\frac{n}{k}\right).
  </annotation>
</semantics>
</math>
</p>

<p>The original proof of <a href="Endre_Szemerédi" title="wikilink">Szemerédi</a> and <a href="William_T._Trotter" title="wikilink">Trotter</a><a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a> was somewhat complicated, using a combinatorial technique known as <em><a href="cell_decomposition" title="wikilink">cell decomposition</a></em>. Later, Székely discovered a much simpler proof using the <a href="Crossing_number_(graph_theory)#The_crossing_number_inequality" title="wikilink">crossing number inequality</a> for <a href="Graph_(mathematics)" title="wikilink">graphs</a>.<a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a> (See below.)</p>

<p>The Szemerédi–Trotter theorem has a number of consequences, including <a href="Beck's_theorem_(geometry)" title="wikilink">Beck's theorem</a> in <a href="incidence_geometry" title="wikilink">incidence geometry</a>.</p>
<h2 id="proof-of-the-first-formulation">Proof of the first formulation</h2>

<p>We may discard the lines which contain two or fewer of the points, as they can contribute at most 

<math display="inline" id="Szemerédi–Trotter_theorem:7">
<semantics>
<mrow>
<mn>2</mn>
<mi>m</mi>
</mrow>
<annotation-xml encoding="MathML-Content">
<apply>
<times></times>
<cn type="integer">2</cn>
<ci>m</ci>
</apply>
</annotation-xml>
<annotation encoding="application/x-tex">
   2m
  </annotation>
</semantics>
</math>

 incidences to the total number. Thus we may assume that every line contains at least three of the points.</p>

<p>If a line contains 

<math display="inline" id="Szemerédi–Trotter_theorem:8">
<semantics>
<mi>k</mi>
<annotation-xml encoding="MathML-Content">
<ci>k</ci>
</annotation-xml>
<annotation encoding="application/x-tex">
   k
  </annotation>
</semantics>
</math>


 points, then it will contain 

<math display="inline" id="Szemerédi–Trotter_theorem:9">
<semantics>
<mrow>
<mi>k</mi>
<mi mathvariant="normal">−</mi>
<mn>1</mn>
</mrow>
<annotation-xml encoding="MathML-Content">
<apply>
<times></times>
<ci>k</ci>
<ci>normal-−</ci>
<cn type="integer">1</cn>
</apply>
</annotation-xml>
<annotation encoding="application/x-tex">
   k−1
  </annotation>
</semantics>
</math>

 line segments which connect two of the 

<math display="inline" id="Szemerédi–Trotter_theorem:10">
<semantics>
<mi>n</mi>
<annotation-xml encoding="MathML-Content">
<ci>n</ci>
</annotation-xml>
<annotation encoding="application/x-tex">
   n
  </annotation>
</semantics>
</math>

 points. In particular it will contain at least <em>k</em>/2 such line segments, since we have assumed 

<math display="inline" id="Szemerédi–Trotter_theorem:11">
<semantics>
<mrow>
<mi>k</mi>
<mi mathvariant="normal">≥</mi>
<mn>3</mn>
</mrow>
<annotation-xml encoding="MathML-Content">
<apply>
<times></times>
<ci>k</ci>
<ci>normal-≥</ci>
<cn type="integer">3</cn>
</apply>
</annotation-xml>
<annotation encoding="application/x-tex">
   k≥3
  </annotation>
</semantics>
</math>

. Adding this up over all of the 

<math display="inline" id="Szemerédi–Trotter_theorem:12">
<semantics>
<mi>m</mi>
<annotation-xml encoding="MathML-Content">
<ci>m</ci>
</annotation-xml>
<annotation encoding="application/x-tex">
   m
  </annotation>
</semantics>
</math>

 lines, we see that the number of line segments obtained in this manner is at least half of the total number of incidences. Thus if we let 

<math display="inline" id="Szemerédi–Trotter_theorem:13">
<semantics>
<mi>e</mi>
<annotation-xml encoding="MathML-Content">
<ci>e</ci>
</annotation-xml>
<annotation encoding="application/x-tex">
   e
  </annotation>
</semantics>
</math>


 be the number of such line segments, it will suffice to show that</p>

<p>
<math display="block" id="Szemerédi–Trotter_theorem:14">
<semantics>
<mrow>
<mrow>
<mi>e</mi>
<mo>=</mo>
<mrow>
<mi>O</mi>
<mrow>
<mo>(</mo>
<mrow>
<mrow>
<msup>
<mi>n</mi>
<mfrac>
<mn>2</mn>
<mn>3</mn>
</mfrac>
</msup>
<msup>
<mi>m</mi>
<mfrac>
<mn>2</mn>
<mn>3</mn>
</mfrac>
</msup>
</mrow>
<mo>+</mo>
<mi>n</mi>
<mo>+</mo>
<mi>m</mi>
</mrow>
<mo>)</mo>
</mrow>
</mrow>
</mrow>
<mo>.</mo>
</mrow>
<annotation-xml encoding="MathML-Content">
<apply>
<eq></eq>
<ci>e</ci>
<apply>
<times></times>
<ci>O</ci>
<apply>
<plus></plus>
<apply>
<times></times>
<apply>
<csymbol cd="ambiguous">superscript</csymbol>
<ci>n</ci>
<apply>
<divide></divide>
<cn type="integer">2</cn>
<cn type="integer">3</cn>
</apply>
</apply>
<apply>
<csymbol cd="ambiguous">superscript</csymbol>
<ci>m</ci>
<apply>
<divide></divide>
<cn type="integer">2</cn>
<cn type="integer">3</cn>
</apply>
</apply>
</apply>
<ci>n</ci>
<ci>m</ci>
</apply>
</apply>
</apply>
</annotation-xml>
<annotation encoding="application/x-tex">
   e=O\left(n^{\frac{2}{3}}m^{\frac{2}{3}}+n+m\right).
  </annotation>
</semantics>
</math>
</p>

<p>Now consider the <a href="Graph_(mathematics)" title="wikilink">graph</a> formed by using the 

<math display="inline" id="Szemerédi–Trotter_theorem:15">
<semantics>
<mi>n</mi>
<annotation-xml encoding="MathML-Content">
<ci>n</ci>
</annotation-xml>
<annotation encoding="application/x-tex">
   n
  </annotation>
</semantics>
</math>

 points as vertices, and the <em>e</em> line segments as edges. Since all of the line segments lie on one of 

<math display="inline" id="Szemerédi–Trotter_theorem:16">
<semantics>
<mi>m</mi>
<annotation-xml encoding="MathML-Content">
<ci>m</ci>
</annotation-xml>
<annotation encoding="application/x-tex">
   m
  </annotation>
</semantics>
</math>

 lines, and any two lines intersect in at most one point, the <a href="Crossing_number_(graph_theory)" title="wikilink">crossing number</a> of this graph is at most <mtpl></mtpl>. Applying the <a href="Crossing_number_(graph_theory)#The_crossing_number_inequality" title="wikilink">crossing number inequality</a> we thus conclude that either 

<math display="inline" id="Szemerédi–Trotter_theorem:17">
<semantics>
<mrow>
<mi>e</mi>
<mi mathvariant="normal">≤</mi>
<mn>7.5</mn>
<mi>n</mi>
</mrow>
<annotation-xml encoding="MathML-Content">
<apply>
<times></times>
<ci>e</ci>
<ci>normal-≤</ci>
<cn type="float">7.5</cn>
<ci>n</ci>
</apply>
</annotation-xml>
<annotation encoding="application/x-tex">
   e≤7.5n
  </annotation>
</semantics>
</math>

, or that <mtpl></mtpl>. In either case <mtpl></mtpl> and we obtain the desired bound</p>

<p>
<math display="block" id="Szemerédi–Trotter_theorem:18">
<semantics>
<mrow>
<mrow>
<mi>e</mi>
<mo>=</mo>
<mrow>
<mi>O</mi>
<mrow>
<mo>(</mo>
<mrow>
<mrow>
<msup>
<mi>n</mi>
<mfrac>
<mn>2</mn>
<mn>3</mn>
</mfrac>
</msup>
<msup>
<mi>m</mi>
<mfrac>
<mn>2</mn>
<mn>3</mn>
</mfrac>
</msup>
</mrow>
<mo>+</mo>
<mi>n</mi>
<mo>+</mo>
<mi>m</mi>
</mrow>
<mo>)</mo>
</mrow>
</mrow>
</mrow>
<mo>.</mo>
</mrow>
<annotation-xml encoding="MathML-Content">
<apply>
<eq></eq>
<ci>e</ci>
<apply>
<times></times>
<ci>O</ci>
<apply>
<plus></plus>
<apply>
<times></times>
<apply>
<csymbol cd="ambiguous">superscript</csymbol>
<ci>n</ci>
<apply>
<divide></divide>
<cn type="integer">2</cn>
<cn type="integer">3</cn>
</apply>
</apply>
<apply>
<csymbol cd="ambiguous">superscript</csymbol>
<ci>m</ci>
<apply>
<divide></divide>
<cn type="integer">2</cn>
<cn type="integer">3</cn>
</apply>
</apply>
</apply>
<ci>n</ci>
<ci>m</ci>
</apply>
</apply>
</apply>
</annotation-xml>
<annotation encoding="application/x-tex">
   e=O\left(n^{\frac{2}{3}}m^{\frac{2}{3}}+n+m\right).
  </annotation>
</semantics>
</math>
</p>
<h2 id="proof-of-the-second-formulation">Proof of the second formulation</h2>

<p>Since every pair of points can be connected by at most one line, there can be at most 

<math display="inline" id="Szemerédi–Trotter_theorem:19">
<semantics>
<mrow>
<mrow>
<mi>n</mi>
<mrow>
<mo stretchy="false">(</mo>
<mrow>
<mi>n</mi>
<mi mathvariant="normal">−</mi>
<mn>1</mn>
</mrow>
<mo stretchy="false">)</mo>
</mrow>
</mrow>
<mo>/</mo>
<mn>2</mn>
</mrow>
<annotation-xml encoding="MathML-Content">
<apply>
<divide></divide>
<apply>
<times></times>
<ci>n</ci>
<apply>
<times></times>
<ci>n</ci>
<ci>normal-−</ci>
<cn type="integer">1</cn>
</apply>
</apply>
<cn type="integer">2</cn>
</apply>
</annotation-xml>
<annotation encoding="application/x-tex">
   n(n−1)/2
  </annotation>
</semantics>
</math>

 lines which can connect at 

<math display="inline" id="Szemerédi–Trotter_theorem:20">
<semantics>
<mi>k</mi>
<annotation-xml encoding="MathML-Content">
<ci>k</ci>
</annotation-xml>
<annotation encoding="application/x-tex">
   k
  </annotation>
</semantics>
</math>

 or more points, since 

<math display="inline" id="Szemerédi–Trotter_theorem:21">
<semantics>
<mrow>
<mi>k</mi>
<mi mathvariant="normal">≥</mi>
<mn>2</mn>
</mrow>
<annotation-xml encoding="MathML-Content">
<apply>
<times></times>
<ci>k</ci>
<ci>normal-≥</ci>
<cn type="integer">2</cn>
</apply>
</annotation-xml>
<annotation encoding="application/x-tex">
   k≥2
  </annotation>
</semantics>
</math>

. This bound will prove the theorem when 

<math display="inline" id="Szemerédi–Trotter_theorem:22">
<semantics>
<mi>k</mi>
<annotation-xml encoding="MathML-Content">
<ci>k</ci>
</annotation-xml>
<annotation encoding="application/x-tex">
   k
  </annotation>
</semantics>
</math>

 is small (e.g. if 

<math display="inline" id="Szemerédi–Trotter_theorem:23">
<semantics>
<mrow>
<mi>k</mi>
<mi mathvariant="normal">≤</mi>
<mi>C</mi>
</mrow>
<annotation-xml encoding="MathML-Content">
<apply>
<times></times>
<ci>k</ci>
<ci>normal-≤</ci>
<ci>C</ci>
</apply>
</annotation-xml>
<annotation encoding="application/x-tex">
   k≤C
  </annotation>
</semantics>
</math>


 for some absolute constant 

<math display="inline" id="Szemerédi–Trotter_theorem:24">
<semantics>
<mi>C</mi>
<annotation-xml encoding="MathML-Content">
<ci>C</ci>
</annotation-xml>
<annotation encoding="application/x-tex">
   C
  </annotation>
</semantics>
</math>

). Thus, we need only consider the case when 

<math display="inline" id="Szemerédi–Trotter_theorem:25">
<semantics>
<mi>k</mi>
<annotation-xml encoding="MathML-Content">
<ci>k</ci>
</annotation-xml>
<annotation encoding="application/x-tex">
   k
  </annotation>
</semantics>
</math>

 is large, say 

<math display="inline" id="Szemerédi–Trotter_theorem:26">
<semantics>
<mrow>
<mi>k</mi>
<mi mathvariant="normal">≥</mi>
<mi>C</mi>
</mrow>
<annotation-xml encoding="MathML-Content">
<apply>
<times></times>
<ci>k</ci>
<ci>normal-≥</ci>
<ci>C</ci>
</apply>
</annotation-xml>
<annotation encoding="application/x-tex">
   k≥C
  </annotation>
</semantics>
</math>

.</p>

<p>Suppose that there are <em>m</em> lines that each contain at least 

<math display="inline" id="Szemerédi–Trotter_theorem:27">
<semantics>
<mi>k</mi>
<annotation-xml encoding="MathML-Content">
<ci>k</ci>
</annotation-xml>
<annotation encoding="application/x-tex">
   k
  </annotation>
</semantics>
</math>

 points. These lines generate at least 

<math display="inline" id="Szemerédi–Trotter_theorem:28">
<semantics>
<mrow>
<mi>m</mi>
<mi>k</mi>
</mrow>
<annotation-xml encoding="MathML-Content">
<apply>
<times></times>
<ci>m</ci>
<ci>k</ci>
</apply>
</annotation-xml>
<annotation encoding="application/x-tex">
   mk
  </annotation>
</semantics>
</math>


 incidences, and so by the first formulation of the Szemerédi–Trotter theorem, we have</p>

<p>
<math display="block" id="Szemerédi–Trotter_theorem:29">
<semantics>
<mrow>
<mrow>
<mrow>
<mi>m</mi>
<mi>k</mi>
</mrow>
<mo>=</mo>
<mrow>
<mi>O</mi>
<mrow>
<mo>(</mo>
<mrow>
<mrow>
<msup>
<mi>n</mi>
<mfrac>
<mn>2</mn>
<mn>3</mn>
</mfrac>
</msup>
<msup>
<mi>m</mi>
<mfrac>
<mn>2</mn>
<mn>3</mn>
</mfrac>
</msup>
</mrow>
<mo>+</mo>
<mi>n</mi>
<mo>+</mo>
<mi>m</mi>
</mrow>
<mo>)</mo>
</mrow>
</mrow>
</mrow>
<mo>,</mo>
</mrow>
<annotation-xml encoding="MathML-Content">
<apply>
<eq></eq>
<apply>
<times></times>
<ci>m</ci>
<ci>k</ci>
</apply>
<apply>
<times></times>
<ci>O</ci>
<apply>
<plus></plus>
<apply>
<times></times>
<apply>
<csymbol cd="ambiguous">superscript</csymbol>
<ci>n</ci>
<apply>
<divide></divide>
<cn type="integer">2</cn>
<cn type="integer">3</cn>
</apply>
</apply>
<apply>
<csymbol cd="ambiguous">superscript</csymbol>
<ci>m</ci>
<apply>
<divide></divide>
<cn type="integer">2</cn>
<cn type="integer">3</cn>
</apply>
</apply>
</apply>
<ci>n</ci>
<ci>m</ci>
</apply>
</apply>
</apply>
</annotation-xml>
<annotation encoding="application/x-tex">
   mk=O\left(n^{\frac{2}{3}}m^{\frac{2}{3}}+n+m\right),
  </annotation>
</semantics>
</math>
</p>

<p>and so at least one of the statements 

<math display="inline" id="Szemerédi–Trotter_theorem:30">
<semantics>
<mrow>
<mrow>
<mrow>
<mi>m</mi>
<mi>k</mi>
</mrow>
<mo>=</mo>
<mrow>
<mi>O</mi>
<mrow>
<mo stretchy="false">(</mo>
<mrow>
<msup>
<mi>n</mi>
<mrow>
<mn>2</mn>
<mo>/</mo>
<mn>3</mn>
</mrow>
</msup>
<msup>
<mi>m</mi>
<mrow>
<mn>2</mn>
<mo>/</mo>
<mn>3</mn>
</mrow>
</msup>
</mrow>
<mo stretchy="false">)</mo>
</mrow>
</mrow>
</mrow>
<mo>,</mo>
<mrow>
<mrow>
<mi>m</mi>
<mi>k</mi>
</mrow>
<mo>=</mo>
<mrow>
<mi>O</mi>
<mrow>
<mo stretchy="false">(</mo>
<mi>n</mi>
<mo stretchy="false">)</mo>
</mrow>
</mrow>
</mrow>
</mrow>
<annotation-xml encoding="MathML-Content">
<apply>
<csymbol cd="ambiguous">formulae-sequence</csymbol>
<apply>
<eq></eq>
<apply>
<times></times>
<ci>m</ci>
<ci>k</ci>
</apply>
<apply>
<times></times>
<ci>O</ci>
<apply>
<times></times>
<apply>
<csymbol cd="ambiguous">superscript</csymbol>
<ci>n</ci>
<apply>
<divide></divide>
<cn type="integer">2</cn>
<cn type="integer">3</cn>
</apply>
</apply>
<apply>
<csymbol cd="ambiguous">superscript</csymbol>
<ci>m</ci>
<apply>
<divide></divide>
<cn type="integer">2</cn>
<cn type="integer">3</cn>
</apply>
</apply>
</apply>
</apply>
</apply>
<apply>
<eq></eq>
<apply>
<times></times>
<ci>m</ci>
<ci>k</ci>
</apply>
<apply>
<times></times>
<ci>O</ci>
<ci>n</ci>
</apply>
</apply>
</apply>
</annotation-xml>
<annotation encoding="application/x-tex">
   mk=O(n^{2/3}m^{2/3}),mk=O(n)
  </annotation>
</semantics>
</math>

, or 

<math display="inline" id="Szemerédi–Trotter_theorem:31">
<semantics>
<mrow>
<mrow>
<mi>m</mi>
<mi>k</mi>
</mrow>
<mo>=</mo>
<mrow>
<mi>O</mi>
<mrow>
<mo stretchy="false">(</mo>
<mi>m</mi>
<mo stretchy="false">)</mo>
</mrow>
</mrow>
</mrow>
<annotation-xml encoding="MathML-Content">
<apply>
<eq></eq>
<apply>
<times></times>
<ci>m</ci>
<ci>k</ci>
</apply>
<apply>
<times></times>
<ci>O</ci>
<ci>m</ci>
</apply>
</apply>
</annotation-xml>
<annotation encoding="application/x-tex">
   mk=O(m)
  </annotation>
</semantics>
</math>

 is true. The third possibility is ruled out since 

<math display="inline" id="Szemerédi–Trotter_theorem:32">
<semantics>
<mi>k</mi>
<annotation-xml encoding="MathML-Content">
<ci>k</ci>
</annotation-xml>
<annotation encoding="application/x-tex">
   k
  </annotation>
</semantics>
</math>

 was assumed to be large, so we are left with the first two. But in either of these two cases, some elementary algebra will give the bound 

<math display="inline" id="Szemerédi–Trotter_theorem:33">
<semantics>
<mrow>
<mi>m</mi>
<mo>=</mo>
<mrow>
<mi>O</mi>
<mrow>
<mo stretchy="false">(</mo>
<mrow>
<mrow>
<msup>
<mi>n</mi>
<mn>2</mn>
</msup>
<mo>/</mo>
<msup>
<mi>k</mi>
<mn>3</mn>
</msup>
</mrow>
<mo>+</mo>
<mrow>
<mi>n</mi>
<mo>/</mo>
<mi>k</mi>
</mrow>
</mrow>
<mo stretchy="false">)</mo>
</mrow>
</mrow>
</mrow>
<annotation-xml encoding="MathML-Content">
<apply>
<eq></eq>
<ci>m</ci>
<apply>
<times></times>
<ci>O</ci>
<apply>
<plus></plus>
<apply>
<divide></divide>
<apply>
<csymbol cd="ambiguous">superscript</csymbol>
<ci>n</ci>
<cn type="integer">2</cn>
</apply>
<apply>
<csymbol cd="ambiguous">superscript</csymbol>
<ci>k</ci>
<cn type="integer">3</cn>
</apply>
</apply>
<apply>
<divide></divide>
<ci>n</ci>
<ci>k</ci>
</apply>
</apply>
</apply>
</apply>
</annotation-xml>
<annotation encoding="application/x-tex">
   m=O(n^{2}/k^{3}+n/k)
  </annotation>
</semantics>
</math>


 as desired.</p>
<h2 id="optimality">Optimality</h2>

<p>Except for its constant, the Szemerédi–Trotter incidence bound cannot be improved. To see this, consider for any positive integer <mtpl></mtpl> a set of points on the integer <a href="Lattice_(group)" title="wikilink">lattice</a></p>

<p>
<math display="block" id="Szemerédi–Trotter_theorem:34">
<semantics>
<mrow>
<mrow>
<mi>P</mi>
<mo>=</mo>
<mrow>
<mo>{</mo>
<mrow>
<mrow>
<mo stretchy="false">(</mo>
<mi>a</mi>
<mo>,</mo>
<mi>b</mi>
<mo stretchy="false">)</mo>
</mrow>
<mo>∈</mo>
<mpadded width="+5pt">
<msup>
<mi>𝐙</mi>
<mn>2</mn>
</msup>
</mpadded>
</mrow>
<mo>:</mo>
<mrow>
<mrow>
<mn>1</mn>
<mo>≤</mo>
<mi>a</mi>
<mo>≤</mo>
<mi>N</mi>
</mrow>
<mo>;</mo>
<mrow>
<mn>1</mn>
<mo>≤</mo>
<mi>b</mi>
<mo>≤</mo>
<mrow>
<mn>2</mn>
<msup>
<mi>N</mi>
<mn>2</mn>
</msup>
</mrow>
</mrow>
</mrow>
<mo>}</mo>
</mrow>
</mrow>
<mo>,</mo>
</mrow>
<annotation-xml encoding="MathML-Content">
<apply>
<eq></eq>
<ci>P</ci>
<apply>
<csymbol cd="latexml">conditional-set</csymbol>
<apply>
<in></in>
<interval closure="open">
<ci>a</ci>
<ci>b</ci>
</interval>
<apply>
<csymbol cd="ambiguous">superscript</csymbol>
<ci>𝐙</ci>
<cn type="integer">2</cn>
</apply>
</apply>
<apply>
<csymbol cd="ambiguous">formulae-sequence</csymbol>
<apply>
<and></and>
<apply>
<leq></leq>
<cn type="float">1</cn>
<ci>a</ci>
</apply>
<apply>
<leq></leq>
<share href="#.cmml">
</share>
<ci>N</ci>
</apply>
</apply>
<apply>
<and></and>
<apply>
<leq></leq>
<cn type="integer">1</cn>
<ci>b</ci>
</apply>
<apply>
<leq></leq>
<share href="#.cmml">
</share>
<apply>
<times></times>
<cn type="integer">2</cn>
<apply>
<csymbol cd="ambiguous">superscript</csymbol>
<ci>N</ci>
<cn type="integer">2</cn>
</apply>
</apply>
</apply>
</apply>
</apply>
</apply>
</apply>
</annotation-xml>
<annotation encoding="application/x-tex">
   P=\left\{(a,b)\in\mathbf{Z}^{2}\ :\ 1\leq a\leq N;1\leq b\leq 2N^{2}\right\},
  </annotation>
</semantics>
</math>
</p>

<p>and a set of lines</p>

<p>
<math display="block" id="Szemerédi–Trotter_theorem:35">
<semantics>
<mrow>
<mrow>
<mi>L</mi>
<mo>=</mo>
<mrow>
<mo>{</mo>
<mrow>
<mo stretchy="false">(</mo>
<mi>x</mi>
<mo>,</mo>
<mrow>
<mrow>
<mi>m</mi>
<mi>x</mi>
</mrow>
<mo>+</mo>
<mi>b</mi>
</mrow>
<mo rspace="7.5pt" stretchy="false">)</mo>
</mrow>
<mo rspace="7.5pt">:</mo>
<mrow>
<mrow>
<mrow>
<mi>m</mi>
<mo>,</mo>
<mi>b</mi>
</mrow>
<mo>∈</mo>
<mi>𝐙</mi>
</mrow>
<mo>;</mo>
<mrow>
<mn>1</mn>
<mo>≤</mo>
<mi>m</mi>
<mo>≤</mo>
<mi>N</mi>
</mrow>
<mo>;</mo>
<mrow>
<mn>1</mn>
<mo>≤</mo>
<mi>b</mi>
<mo>≤</mo>
<msup>
<mi>N</mi>
<mn>2</mn>
</msup>
</mrow>
</mrow>
<mo>}</mo>
</mrow>
</mrow>
<mo>.</mo>
</mrow>
<annotation-xml encoding="MathML-Content">
<apply>
<eq></eq>
<ci>L</ci>
<apply>
<csymbol cd="latexml">conditional-set</csymbol>
<interval closure="open">
<ci>x</ci>
<apply>
<plus></plus>
<apply>
<times></times>
<ci>m</ci>
<ci>x</ci>
</apply>
<ci>b</ci>
</apply>
</interval>
<apply>
<csymbol cd="ambiguous">formulae-sequence</csymbol>
<apply>
<in></in>
<list>
<ci>m</ci>
<ci>b</ci>
</list>
<ci>𝐙</ci>
</apply>
<apply>
<and></and>
<apply>
<leq></leq>
<cn type="integer">1</cn>
<ci>m</ci>
</apply>
<apply>
<leq></leq>
<share href="#.cmml">
</share>
<ci>N</ci>
</apply>
</apply>
<apply>
<and></and>
<apply>
<leq></leq>
<cn type="integer">1</cn>
<ci>b</ci>
</apply>
<apply>
<leq></leq>
<share href="#.cmml">
</share>
<apply>
<csymbol cd="ambiguous">superscript</csymbol>
<ci>N</ci>
<cn type="integer">2</cn>
</apply>
</apply>
</apply>
</apply>
</apply>
</apply>
</annotation-xml>
<annotation encoding="application/x-tex">
   L=\left\{(x,mx+b)\ :\ m,b\in\mathbf{Z};1\leq m\leq N;1\leq b\leq N^{2}\right\}.
  </annotation>
</semantics>
</math>
</p>

<p>Clearly, 

<math display="inline" id="Szemerédi–Trotter_theorem:36">
<semantics>
<mrow>
<mrow>
<mo stretchy="false">|</mo>
<mi>P</mi>
<mo stretchy="false">|</mo>
</mrow>
<mo>=</mo>
<mrow>
<mn>2</mn>
<msup>
<mi>N</mi>
<mn>3</mn>
</msup>
</mrow>
</mrow>
<annotation-xml encoding="MathML-Content">
<apply>
<eq></eq>
<apply>
<abs></abs>
<ci>P</ci>
</apply>
<apply>
<times></times>
<cn type="integer">2</cn>
<apply>
<csymbol cd="ambiguous">superscript</csymbol>
<ci>N</ci>
<cn type="integer">3</cn>
</apply>
</apply>
</apply>
</annotation-xml>
<annotation encoding="application/x-tex">
   |P|=2N^{3}
  </annotation>
</semantics>
</math>

 and 

<math display="inline" id="Szemerédi–Trotter_theorem:37">
<semantics>
<mrow>
<mrow>
<mo stretchy="false">|</mo>
<mi>L</mi>
<mo stretchy="false">|</mo>
</mrow>
<mo>=</mo>
<msup>
<mi>N</mi>
<mn>3</mn>
</msup>
</mrow>
<annotation-xml encoding="MathML-Content">
<apply>
<eq></eq>
<apply>
<abs></abs>
<ci>L</ci>
</apply>
<apply>
<csymbol cd="ambiguous">superscript</csymbol>
<ci>N</ci>
<cn type="integer">3</cn>
</apply>
</apply>
</annotation-xml>
<annotation encoding="application/x-tex">
   |L|=N^{3}
  </annotation>
</semantics>
</math>

. Since each line is incident to 

<math display="inline" id="Szemerédi–Trotter_theorem:38">
<semantics>
<mi>N</mi>
<annotation-xml encoding="MathML-Content">
<ci>N</ci>
</annotation-xml>
<annotation encoding="application/x-tex">
   N
  </annotation>
</semantics>
</math>


 points (i.e., once for each 

<math display="inline" id="Szemerédi–Trotter_theorem:39">
<semantics>
<mrow>
<mi>x</mi>
<mo>∈</mo>
<mrow>
<mo stretchy="false">{</mo>
<mn>1</mn>
<mo>,</mo>
<mi mathvariant="normal">⋯</mi>
<mo>,</mo>
<mi>N</mi>
<mo stretchy="false">}</mo>
</mrow>
</mrow>
<annotation-xml encoding="MathML-Content">
<apply>
<in></in>
<ci>x</ci>
<set>
<cn type="integer">1</cn>
<ci>normal-⋯</ci>
<ci>N</ci>
</set>
</apply>
</annotation-xml>
<annotation encoding="application/x-tex">
   x\in\{1,\cdots,N\}
  </annotation>
</semantics>
</math>

), the number of incidences is 

<math display="inline" id="Szemerédi–Trotter_theorem:40">
<semantics>
<msup>
<mi>N</mi>
<mn>4</mn>
</msup>
<annotation-xml encoding="MathML-Content">
<apply>
<csymbol cd="ambiguous">superscript</csymbol>
<ci>N</ci>
<cn type="integer">4</cn>
</apply>
</annotation-xml>
<annotation encoding="application/x-tex">
   N^{4}
  </annotation>
</semantics>
</math>

 which matches the upper bound.<a class="footnoteRef" href="#fn3" id="fnref3"><sup>3</sup></a></p>
<h2 id="generalization-to">Generalization to <mtpl></mtpl></h2>

<p>One generalization of this result to arbitrary dimension, <mtpl></mtpl>, was found by Agarwal and Aronov.<a class="footnoteRef" href="#fn4" id="fnref4"><sup>4</sup></a> Given a set of 

<math display="inline" id="Szemerédi–Trotter_theorem:41">
<semantics>
<mi>n</mi>
<annotation-xml encoding="MathML-Content">
<ci>n</ci>
</annotation-xml>
<annotation encoding="application/x-tex">
   n
  </annotation>
</semantics>
</math>

 points, 

<math display="inline" id="Szemerédi–Trotter_theorem:42">
<semantics>
<mi>S</mi>
<annotation-xml encoding="MathML-Content">
<ci>S</ci>
</annotation-xml>
<annotation encoding="application/x-tex">
   S
  </annotation>
</semantics>
</math>

, and the set of 

<math display="inline" id="Szemerédi–Trotter_theorem:43">
<semantics>
<mi>m</mi>
<annotation-xml encoding="MathML-Content">
<ci>m</ci>
</annotation-xml>
<annotation encoding="application/x-tex">
   m
  </annotation>
</semantics>
</math>


 hyperplanes, 

<math display="inline" id="Szemerédi–Trotter_theorem:44">
<semantics>
<mi>H</mi>
<annotation-xml encoding="MathML-Content">
<ci>H</ci>
</annotation-xml>
<annotation encoding="application/x-tex">
   H
  </annotation>
</semantics>
</math>

, which are each spanned by 

<math display="inline" id="Szemerédi–Trotter_theorem:45">
<semantics>
<mi>S</mi>
<annotation-xml encoding="MathML-Content">
<ci>S</ci>
</annotation-xml>
<annotation encoding="application/x-tex">
   S
  </annotation>
</semantics>
</math>

, the number of incidences between 

<math display="inline" id="Szemerédi–Trotter_theorem:46">
<semantics>
<mi>S</mi>
<annotation-xml encoding="MathML-Content">
<ci>S</ci>
</annotation-xml>
<annotation encoding="application/x-tex">
   S
  </annotation>
</semantics>
</math>

 and 

<math display="inline" id="Szemerédi–Trotter_theorem:47">
<semantics>
<mi>H</mi>
<annotation-xml encoding="MathML-Content">
<ci>H</ci>
</annotation-xml>
<annotation encoding="application/x-tex">
   H
  </annotation>
</semantics>
</math>

 is bounded above by</p>

<p>
<math display="block" id="Szemerédi–Trotter_theorem:48">
<semantics>
<mrow>
<mrow>
<mi>O</mi>
<mrow>
<mo>(</mo>
<mrow>
<mrow>
<msup>
<mi>m</mi>
<mfrac>
<mn>2</mn>
<mn>3</mn>
</mfrac>
</msup>
<msup>
<mi>n</mi>
<mfrac>
<mi>d</mi>
<mn>3</mn>
</mfrac>
</msup>
</mrow>
<mo>+</mo>
<msup>
<mi>n</mi>
<mrow>
<mi>d</mi>
<mo>-</mo>
<mn>1</mn>
</mrow>
</msup>
</mrow>
<mo>)</mo>
</mrow>
</mrow>
<mo>.</mo>
</mrow>
<annotation-xml encoding="MathML-Content">
<apply>
<times></times>
<ci>O</ci>
<apply>
<plus></plus>
<apply>
<times></times>
<apply>
<csymbol cd="ambiguous">superscript</csymbol>
<ci>m</ci>
<apply>
<divide></divide>
<cn type="integer">2</cn>
<cn type="integer">3</cn>
</apply>
</apply>
<apply>
<csymbol cd="ambiguous">superscript</csymbol>
<ci>n</ci>
<apply>
<divide></divide>
<ci>d</ci>
<cn type="integer">3</cn>
</apply>
</apply>
</apply>
<apply>
<csymbol cd="ambiguous">superscript</csymbol>
<ci>n</ci>
<apply>
<minus></minus>
<ci>d</ci>
<cn type="integer">1</cn>
</apply>
</apply>
</apply>
</apply>
</annotation-xml>
<annotation encoding="application/x-tex">
   O\left(m^{\frac{2}{3}}n^{\frac{d}{3}}+n^{d-1}\right).
  </annotation>
</semantics>
</math>
</p>

<p>Equivalently, the number of hyperplanes in 

<math display="inline" id="Szemerédi–Trotter_theorem:49">
<semantics>
<mi>H</mi>
<annotation-xml encoding="MathML-Content">
<ci>H</ci>
</annotation-xml>
<annotation encoding="application/x-tex">
   H
  </annotation>
</semantics>
</math>

 containing 

<math display="inline" id="Szemerédi–Trotter_theorem:50">
<semantics>
<mi>k</mi>
<annotation-xml encoding="MathML-Content">
<ci>k</ci>
</annotation-xml>
<annotation encoding="application/x-tex">
   k
  </annotation>
</semantics>
</math>

 or more points is bounded above by</p>

<p>
<math display="block" id="Szemerédi–Trotter_theorem:51">
<semantics>
<mrow>
<mrow>
<mi>O</mi>
<mrow>
<mo>(</mo>
<mrow>
<mfrac>
<msup>
<mi>n</mi>
<mi>d</mi>
</msup>
<msup>
<mi>k</mi>
<mn>3</mn>
</msup>
</mfrac>
<mo>+</mo>
<mfrac>
<msup>
<mi>n</mi>
<mrow>
<mi>d</mi>
<mo>-</mo>
<mn>1</mn>
</mrow>
</msup>
<mi>k</mi>
</mfrac>
</mrow>
<mo>)</mo>
</mrow>
</mrow>
<mo>.</mo>
</mrow>
<annotation-xml encoding="MathML-Content">
<apply>
<times></times>
<ci>O</ci>
<apply>
<plus></plus>
<apply>
<divide></divide>
<apply>
<csymbol cd="ambiguous">superscript</csymbol>
<ci>n</ci>
<ci>d</ci>
</apply>
<apply>
<csymbol cd="ambiguous">superscript</csymbol>
<ci>k</ci>
<cn type="integer">3</cn>
</apply>
</apply>
<apply>
<divide></divide>
<apply>
<csymbol cd="ambiguous">superscript</csymbol>
<ci>n</ci>
<apply>
<minus></minus>
<ci>d</ci>
<cn type="integer">1</cn>
</apply>
</apply>
<ci>k</ci>
</apply>
</apply>
</apply>
</annotation-xml>
<annotation encoding="application/x-tex">
   O\left(\frac{n^{d}}{k^{3}}+\frac{n^{d-1}}{k}\right).
  </annotation>
</semantics>
</math>
</p>

<p>A construction due to Edelsbrunner shows this bound to be asymptotically optimal.<a class="footnoteRef" href="#fn5" id="fnref5"><sup>5</sup></a></p>

<p><a href="József_Solymosi" title="wikilink">Solymosi</a> and <a href="Terence_Tao" title="wikilink">Tao</a> obtained near sharp upper bounds for the number of incidences between points and algebraic varieties in higher dimensions. Their proof uses the <a href="Polynomial_Ham_Sandwich_Theorem" title="wikilink">Polynomial Ham Sandwich Theorem</a>.<a class="footnoteRef" href="#fn6" id="fnref6"><sup>6</sup></a></p>
<h2 id="references">References</h2>

<p>"</p>

<p><a href="Category:Euclidean_plane_geometry" title="wikilink">Category:Euclidean plane geometry</a> <a href="Category:Theorems_in_discrete_geometry" title="wikilink">Category:Theorems in discrete geometry</a> <a href="Category:Theorems_in_combinatorics" title="wikilink">Category:Theorems in combinatorics</a> <a href="Category:Articles_containing_proofs" title="wikilink">Category:Articles containing proofs</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1"><a href="#fnref1">↩</a></li>
<li id="fn2"><a href="#fnref2">↩</a></li>
<li id="fn3"><a href="#fnref3">↩</a></li>
<li id="fn4"><a href="#fnref4">↩</a></li>
<li id="fn5"><a href="#fnref5">↩</a></li>
<li id="fn6"><a href="#fnref6">↩</a></li>
</ol>
</section>
</body>
</html>

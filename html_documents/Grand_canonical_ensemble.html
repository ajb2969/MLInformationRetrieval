<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="1758">Grand canonical ensemble</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Grand canonical ensemble</h1>
<hr/>

<p>In <a href="statistical_mechanics" title="wikilink">statistical mechanics</a>, a <strong>grand canonical ensemble</strong> is the <a href="statistical_ensemble_(mathematical_physics)" title="wikilink">statistical ensemble</a> that is used to represent the possible states of a mechanical system of particles that is being maintained in <a href="thermodynamic_equilibrium" title="wikilink">thermodynamic equilibrium</a> (thermal and chemical) with a reservoir.<a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a> The system is said to be open in the sense that the system can exchange energy and particles with a reservoir, so that various possible states of the system can differ in both their total energy and total number of particles. The system's volume, shape, and other external coordinates are kept the same in all possible states of the system.</p>

<p>The thermodynamic variables of the grand canonical ensemble are <a href="chemical_potential" title="wikilink">chemical potential</a> (symbol: 

<math display="inline" id="Grand_canonical_ensemble:0">
 <semantics>
  <mi mathvariant="normal">µ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>normal-µ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   µ
  </annotation>
 </semantics>
</math>

) and <a href="absolute_temperature" title="wikilink">absolute temperature</a> (symbol: 

<math display="inline" id="Grand_canonical_ensemble:1">
 <semantics>
  <mi>T</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>T</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   T
  </annotation>
 </semantics>
</math>

). The ensemble is also dependent on mechanical variables such as volume (symbol: 

<math display="inline" id="Grand_canonical_ensemble:2">
 <semantics>
  <mi>V</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>V</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   V
  </annotation>
 </semantics>
</math>

) which influence the nature of the system's internal states. This ensemble is therefore sometimes called the <em>' 

<math display="inline" id="Grand_canonical_ensemble:3">
 <semantics>
  <mrow>
   <mi mathvariant="normal">µ</mi>
   <mi>V</mi>
   <mi>T</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>normal-µ</ci>
    <ci>V</ci>
    <ci>T</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   µVT
  </annotation>
 </semantics>
</math>

 ensemble</em>', as each of these three quantities are constants of the ensemble.</p>
<h2 id="basics">Basics</h2>

<p>In simple terms, the grand canonical ensemble assigns a probability 

<math display="inline" id="Grand_canonical_ensemble:4">
 <semantics>
  <mi>P</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>P</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   P
  </annotation>
 </semantics>
</math>

 to each distinct <a href="microstate_(statistical_mechanics)" title="wikilink">microstate</a> given by the following exponential:</p>

<p>

<math display="block" id="Grand_canonical_ensemble:5">
 <semantics>
  <mrow>
   <mrow>
    <mi>P</mi>
    <mo>=</mo>
    <msup>
     <mi>e</mi>
     <mfrac>
      <mrow>
       <mrow>
        <mi mathvariant="normal">Ω</mi>
        <mo>+</mo>
        <mrow>
         <mi>μ</mi>
         <mi>N</mi>
        </mrow>
       </mrow>
       <mo>-</mo>
       <mi>E</mi>
      </mrow>
      <mrow>
       <mi>k</mi>
       <mi>T</mi>
      </mrow>
     </mfrac>
    </msup>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>P</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>e</ci>
     <apply>
      <divide></divide>
      <apply>
       <minus></minus>
       <apply>
        <plus></plus>
        <ci>normal-Ω</ci>
        <apply>
         <times></times>
         <ci>μ</ci>
         <ci>N</ci>
        </apply>
       </apply>
       <ci>E</ci>
      </apply>
      <apply>
       <times></times>
       <ci>k</ci>
       <ci>T</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   P=e^{\frac{\Omega+\mu N-E}{kT}},
  </annotation>
 </semantics>
</math>

 where 

<math display="inline" id="Grand_canonical_ensemble:6">
 <semantics>
  <mi>N</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>N</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   N
  </annotation>
 </semantics>
</math>

 is the number of particles in the microstate and 

<math display="inline" id="Grand_canonical_ensemble:7">
 <semantics>
  <mi>E</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>E</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   E
  </annotation>
 </semantics>
</math>

 is the total energy of the microstate. 

<math display="inline" id="Grand_canonical_ensemble:8">
 <semantics>
  <mi>k</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>k</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   k
  </annotation>
 </semantics>
</math>

 is <a href="Boltzmann's_constant" title="wikilink">Boltzmann's constant</a>.</p>

<p>The number 

<math display="inline" id="Grand_canonical_ensemble:9">
 <semantics>
  <mi mathvariant="normal">Ω</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>normal-Ω</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Ω
  </annotation>
 </semantics>
</math>

 is known as the <a href="grand_potential" title="wikilink">grand potential</a> and is constant for the ensemble. However, the probabilities and 

<math display="inline" id="Grand_canonical_ensemble:10">
 <semantics>
  <mi mathvariant="normal">Ω</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>normal-Ω</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Ω
  </annotation>
 </semantics>
</math>

 will vary if different 

<math display="inline" id="Grand_canonical_ensemble:11">
 <semantics>
  <mrow>
   <mi mathvariant="normal">µ</mi>
   <mo>,</mo>
   <mi>V</mi>
   <mo>,</mo>
   <mi>T</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <list>
    <ci>normal-µ</ci>
    <ci>V</ci>
    <ci>T</ci>
   </list>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   µ,V,T
  </annotation>
 </semantics>
</math>

 are selected. The grand potential 

<math display="inline" id="Grand_canonical_ensemble:12">
 <semantics>
  <mi mathvariant="normal">Ω</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>normal-Ω</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Ω
  </annotation>
 </semantics>
</math>

 serves two roles: to provide a normalization factor for the probability distribution (the probabilities, over the complete set of microstates, must add up to one); and, many important ensemble averages can be directly calculated from the function 

<math display="inline" id="Grand_canonical_ensemble:13">
 <semantics>
  <mrow>
   <mi mathvariant="normal">Ω</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi mathvariant="normal">µ</mi>
    <mo>,</mo>
    <mi>V</mi>
    <mo>,</mo>
    <mi>T</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>normal-Ω</ci>
    <vector>
     <ci>normal-µ</ci>
     <ci>V</ci>
     <ci>T</ci>
    </vector>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Ω(µ,V,T)
  </annotation>
 </semantics>
</math>

.</p>

<p>In the case where more than one kind of particle is allowed to vary in number, the probability expression generalizes to</p>

<p>

<math display="block" id="Grand_canonical_ensemble:14">
 <semantics>
  <mrow>
   <mrow>
    <mi>P</mi>
    <mo>=</mo>
    <msup>
     <mi>e</mi>
     <mfrac>
      <mrow>
       <mrow>
        <mi mathvariant="normal">Ω</mi>
        <mo>+</mo>
        <mrow>
         <msub>
          <mi>μ</mi>
          <mn>1</mn>
         </msub>
         <msub>
          <mi>N</mi>
          <mn>1</mn>
         </msub>
        </mrow>
        <mo>+</mo>
        <mrow>
         <msub>
          <mi>μ</mi>
          <mn>2</mn>
         </msub>
         <msub>
          <mi>N</mi>
          <mn>2</mn>
         </msub>
        </mrow>
        <mo>+</mo>
        <mi mathvariant="normal">…</mi>
        <mo>+</mo>
        <mrow>
         <msub>
          <mi>μ</mi>
          <mi>s</mi>
         </msub>
         <msub>
          <mi>N</mi>
          <mi>s</mi>
         </msub>
        </mrow>
       </mrow>
       <mo>-</mo>
       <mi>E</mi>
      </mrow>
      <mrow>
       <mi>k</mi>
       <mi>T</mi>
      </mrow>
     </mfrac>
    </msup>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>P</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>e</ci>
     <apply>
      <divide></divide>
      <apply>
       <minus></minus>
       <apply>
        <plus></plus>
        <ci>normal-Ω</ci>
        <apply>
         <times></times>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>μ</ci>
          <cn type="integer">1</cn>
         </apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>N</ci>
          <cn type="integer">1</cn>
         </apply>
        </apply>
        <apply>
         <times></times>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>μ</ci>
          <cn type="integer">2</cn>
         </apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>N</ci>
          <cn type="integer">2</cn>
         </apply>
        </apply>
        <ci>normal-…</ci>
        <apply>
         <times></times>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>μ</ci>
          <ci>s</ci>
         </apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>N</ci>
          <ci>s</ci>
         </apply>
        </apply>
       </apply>
       <ci>E</ci>
      </apply>
      <apply>
       <times></times>
       <ci>k</ci>
       <ci>T</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   P=e^{\frac{\Omega+\mu_{1}N_{1}+\mu_{2}N_{2}+\ldots+\mu_{s}N_{s}-E}{kT}},
  </annotation>
 </semantics>
</math>

 where <mtpl></mtpl> is the chemical potential for the first kind of particles, <mtpl></mtpl> is the number of that kind of particle in the microstate, <mtpl></mtpl> is the chemical potential for the second kind of particles and so on (

<math display="inline" id="Grand_canonical_ensemble:15">
 <semantics>
  <mi>s</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>s</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   s
  </annotation>
 </semantics>
</math>

 is the number of distinct kinds of particles). However, these particle numbers should be defined carefully (see the <a href="#Requirement_of_particle_number_conservation" title="wikilink">note on particle number conservation</a> below).</p>

<p>Grand ensembles are apt for use when describing systems such as the <a href="electron" title="wikilink">electrons</a> in a <a href="Electrical_conductor" title="wikilink">conductor</a>, or the <a class="uri" href="photons" title="wikilink">photons</a> in a cavity, where the shape is fixed but the energy and number of particles can easily fluctuate due to contact with a reservoir (e.g., an electrical ground or a <a href="black_body" title="wikilink">dark surface</a>, in these cases). The grand canonical ensemble provides a natural setting for an exact derivation of the <a href="Fermi–Dirac_statistics" title="wikilink">Fermi–Dirac statistics</a> or <a href="Bose–Einstein_statistics" title="wikilink">Bose–Einstein statistics</a> for a system of non-interacting quantum particles (see examples below).</p>
<dl>
<dt>Note on formulation</dt>
<dd>An alternative formulation for the same concept writes the probability as 

<math display="inline" id="Grand_canonical_ensemble:16">
 <semantics>
  <mrow>
   <mi>P</mi>
   <mo>=</mo>
   <mrow>
    <mfrac>
     <mn>1</mn>
     <mi class="ltx_font_mathcaligraphic">𝒵</mi>
    </mfrac>
    <msup>
     <mi>e</mi>
     <mrow>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mrow>
         <mi>μ</mi>
         <mi>N</mi>
        </mrow>
        <mo>-</mo>
        <mi>E</mi>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
      <mo>/</mo>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mi>k</mi>
        <mi>T</mi>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </msup>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>P</ci>
    <apply>
     <times></times>
     <apply>
      <divide></divide>
      <cn type="integer">1</cn>
      <ci>𝒵</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>e</ci>
      <apply>
       <divide></divide>
       <apply>
        <minus></minus>
        <apply>
         <times></times>
         <ci>μ</ci>
         <ci>N</ci>
        </apply>
        <ci>E</ci>
       </apply>
       <apply>
        <times></times>
        <ci>k</ci>
        <ci>T</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \textstyle P=\frac{1}{\mathcal{Z}}e^{(\mu N-E)/(kT)}
  </annotation>
 </semantics>
</math>

, using the <a href="Partition_function_(statistical_mechanics)" title="wikilink">grand partition function</a> 

<math display="inline" id="Grand_canonical_ensemble:17">
 <semantics>
  <mrow>
   <mi class="ltx_font_mathcaligraphic">𝒵</mi>
   <mo>=</mo>
   <msup>
    <mi>e</mi>
    <mrow>
     <mo>-</mo>
     <mrow>
      <mi mathvariant="normal">Ω</mi>
      <mo>/</mo>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mi>k</mi>
        <mi>T</mi>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mrow>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>𝒵</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>e</ci>
     <apply>
      <minus></minus>
      <apply>
       <divide></divide>
       <ci>normal-Ω</ci>
       <apply>
        <times></times>
        <ci>k</ci>
        <ci>T</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \textstyle\mathcal{Z}=e^{-\Omega/(kT)}
  </annotation>
 </semantics>
</math>

 rather than the grand potential. The equations in this article (in terms of grand potential) may be restated in terms of the grand partition function by simple mathematical manipulations.
</dd>
</dl>
<h2 id="applicability">Applicability</h2>

<p>The grand canonical ensemble is the ensemble that describes the possible states of an isolated system that is in thermal and chemical equilibrium with a reservoir (the derivation proceeds along lines analogous to the heat bath derivation of the normal <a href="canonical_ensemble" title="wikilink">canonical ensemble</a>, and can be found in Reif<a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a>). The grand canonical ensemble applies to systems of any size, small or large; it is only necessary to assume that the reservoir with which it is in contact is much larger (i.e., to take the <a href="macroscopic_limit" title="wikilink">macroscopic limit</a>).</p>

<p>The condition that the system is isolated is necessary in order to ensure it has well-defined thermodynamic quantities and evolution.<a class="footnoteRef" href="#fn3" id="fnref3"><sup>3</sup></a> In practice, however, it is desirable to apply the grand canonical ensemble to describe systems that are in direct contact with the reservoir, since it is that contact that ensures the equilibrium. The use of the grand canonical ensemble in these cases is usually justified either 1) by assuming that the contact is weak, or 2) by incorporating a part of the reservoir connection into the system under analysis, so that the connection's influence on the region of interest is correctly modelled.</p>

<p>Another case in which the grand canonical ensemble appears is when considering a system that is large and thermodynamic (a system that is "in equilibrium with itself"). Even if the exact conditions of the system do not actually allow for variations in energy or particle number, the grand canonical ensemble can be used to simplify calculations of some thermodynamic properties. The reason for this is that various thermodynamic ensembles (<a href="microcanonical_ensemble" title="wikilink">microcanonical</a>, <a href="canonical_ensemble" title="wikilink">canonical</a>) become equivalent in some aspects to the grand canonical ensemble, once the system is very large.<a class="footnoteRef" href="#fn4" id="fnref4"><sup>4</sup></a> Of course, for small systems, the different ensembles are no longer equivalent even in the mean. As a result, the grand canonical ensemble can be highly inaccurate when applied to small systems of fixed particle number, such as atomic nuclei.<a class="footnoteRef" href="#fn5" id="fnref5"><sup>5</sup></a></p>
<h2 id="properties-of-the-grand-ensemble">Properties of the grand ensemble</h2>
<h2 id="grand-potential-ensemble-averages-and-exact-differentials">Grand potential, ensemble averages, and exact differentials</h2>

<p>The partial derivatives of the function <mtpl></mtpl> give important grand canonical ensemble average quantities:<a class="footnoteRef" href="#fn6" id="fnref6"><sup>6</sup></a><a class="footnoteRef" href="#fn7" id="fnref7"><sup>7</sup></a> </p>

<p><em>Exact differential</em>: From the above expressions, it can be seen that the function 

<math display="inline" id="Grand_canonical_ensemble:18">
 <semantics>
  <mi mathvariant="normal">Ω</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>normal-Ω</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Ω
  </annotation>
 </semantics>
</math>

 has the <a href="exact_differential" title="wikilink">exact differential</a></p>

<p>

<math display="block" id="Grand_canonical_ensemble:19">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>d</mi>
     <mi mathvariant="normal">Ω</mi>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mo>-</mo>
      <mrow>
       <mi>S</mi>
       <mi>d</mi>
       <mi>T</mi>
      </mrow>
     </mrow>
     <mo>-</mo>
     <mrow>
      <mrow>
       <mo stretchy="false">⟨</mo>
       <msub>
        <mi>N</mi>
        <mn>1</mn>
       </msub>
       <mo stretchy="false">⟩</mo>
      </mrow>
      <mi>d</mi>
      <msub>
       <mi>μ</mi>
       <mn>1</mn>
      </msub>
      <mi mathvariant="normal">…</mi>
     </mrow>
     <mo>-</mo>
     <mrow>
      <mrow>
       <mo stretchy="false">⟨</mo>
       <msub>
        <mi>N</mi>
        <mi>s</mi>
       </msub>
       <mo stretchy="false">⟩</mo>
      </mrow>
      <mi>d</mi>
      <msub>
       <mi>μ</mi>
       <mi>s</mi>
      </msub>
     </mrow>
     <mo>-</mo>
     <mrow>
      <mrow>
       <mo stretchy="false">⟨</mo>
       <mi>p</mi>
       <mo stretchy="false">⟩</mo>
      </mrow>
      <mi>d</mi>
      <mi>V</mi>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>d</ci>
     <ci>normal-Ω</ci>
    </apply>
    <apply>
     <minus></minus>
     <apply>
      <minus></minus>
      <apply>
       <times></times>
       <ci>S</ci>
       <ci>d</ci>
       <ci>T</ci>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="latexml">delimited-⟨⟩</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>N</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <ci>d</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>μ</ci>
       <cn type="integer">1</cn>
      </apply>
      <ci>normal-…</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="latexml">delimited-⟨⟩</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>N</ci>
        <ci>s</ci>
       </apply>
      </apply>
      <ci>d</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>μ</ci>
       <ci>s</ci>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="latexml">delimited-⟨⟩</csymbol>
       <ci>p</ci>
      </apply>
      <ci>d</ci>
      <ci>V</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   d\Omega=-SdT-\langle N_{1}\rangle d\mu_{1}\ldots-\langle N_{s}\rangle d\mu_{s}%
-\langle p\rangle dV.
  </annotation>
 </semantics>
</math>

</p>

<p><em>First law of thermodynamics</em>: Substituting the above relationship for 

<math display="inline" id="Grand_canonical_ensemble:20">
 <semantics>
  <mrow>
   <mi mathvariant="normal">⟨</mi>
   <mi>E</mi>
   <mi mathvariant="normal">⟩</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>normal-⟨</ci>
    <ci>E</ci>
    <ci>normal-⟩</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   ⟨E⟩
  </annotation>
 </semantics>
</math>

 into the exact differential of 

<math display="inline" id="Grand_canonical_ensemble:21">
 <semantics>
  <mi mathvariant="normal">Ω</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>normal-Ω</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Ω
  </annotation>
 </semantics>
</math>

, an equation similar to the <a href="first_law_of_thermodynamics" title="wikilink">first law of thermodynamics</a> is found, except with average signs on some of the quantities:<a class="footnoteRef" href="#fn8" id="fnref8"><sup>8</sup></a></p>

<p>

<math display="block" id="Grand_canonical_ensemble:22">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>d</mi>
     <mrow>
      <mo stretchy="false">⟨</mo>
      <mi>E</mi>
      <mo stretchy="false">⟩</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mrow>
       <mi>T</mi>
       <mi>d</mi>
       <mi>S</mi>
      </mrow>
      <mo>+</mo>
      <mrow>
       <msub>
        <mi>μ</mi>
        <mn>1</mn>
       </msub>
       <mi>d</mi>
       <mrow>
        <mo stretchy="false">⟨</mo>
        <msub>
         <mi>N</mi>
         <mn>1</mn>
        </msub>
        <mo stretchy="false">⟩</mo>
       </mrow>
       <mi mathvariant="normal">…</mi>
      </mrow>
      <mo>+</mo>
      <mrow>
       <msub>
        <mi>μ</mi>
        <mi>s</mi>
       </msub>
       <mi>d</mi>
       <mrow>
        <mo stretchy="false">⟨</mo>
        <msub>
         <mi>N</mi>
         <mi>s</mi>
        </msub>
        <mo stretchy="false">⟩</mo>
       </mrow>
      </mrow>
     </mrow>
     <mo>-</mo>
     <mrow>
      <mrow>
       <mo stretchy="false">⟨</mo>
       <mi>p</mi>
       <mo stretchy="false">⟩</mo>
      </mrow>
      <mi>d</mi>
      <mi>V</mi>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>d</ci>
     <apply>
      <csymbol cd="latexml">delimited-⟨⟩</csymbol>
      <ci>E</ci>
     </apply>
    </apply>
    <apply>
     <minus></minus>
     <apply>
      <plus></plus>
      <apply>
       <times></times>
       <ci>T</ci>
       <ci>d</ci>
       <ci>S</ci>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>μ</ci>
        <cn type="integer">1</cn>
       </apply>
       <ci>d</ci>
       <apply>
        <csymbol cd="latexml">delimited-⟨⟩</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>N</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <ci>normal-…</ci>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>μ</ci>
        <ci>s</ci>
       </apply>
       <ci>d</ci>
       <apply>
        <csymbol cd="latexml">delimited-⟨⟩</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>N</ci>
         <ci>s</ci>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="latexml">delimited-⟨⟩</csymbol>
       <ci>p</ci>
      </apply>
      <ci>d</ci>
      <ci>V</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   d\langle E\rangle=TdS+\mu_{1}d\langle N_{1}\rangle\ldots+\mu_{s}d\langle N_{s}%
\rangle-\langle p\rangle dV.
  </annotation>
 </semantics>
</math>

</p>

<p><em><a href="Thermal_fluctuations" title="wikilink">Thermodynamic fluctuations</a></em>: The <a href="variance" title="wikilink">variances</a> in energy and particle numbers are<a class="footnoteRef" href="#fn9" id="fnref9"><sup>9</sup></a><a class="footnoteRef" href="#fn10" id="fnref10"><sup>10</sup></a></p>

<p>

<math display="block" id="Grand_canonical_ensemble:23">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mrow>
      <mo stretchy="false">⟨</mo>
      <msup>
       <mi>E</mi>
       <mn>2</mn>
      </msup>
      <mo stretchy="false">⟩</mo>
     </mrow>
     <mo>-</mo>
     <msup>
      <mrow>
       <mo stretchy="false">⟨</mo>
       <mi>E</mi>
       <mo stretchy="false">⟩</mo>
      </mrow>
      <mn>2</mn>
     </msup>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mi>k</mi>
      <msup>
       <mi>T</mi>
       <mn>2</mn>
      </msup>
      <mfrac>
       <mrow>
        <mo>∂</mo>
        <mrow>
         <mo stretchy="false">⟨</mo>
         <mi>E</mi>
         <mo stretchy="false">⟩</mo>
        </mrow>
       </mrow>
       <mrow>
        <mo>∂</mo>
        <mi>T</mi>
       </mrow>
      </mfrac>
     </mrow>
     <mo>+</mo>
     <mrow>
      <mi>k</mi>
      <mi>T</mi>
      <msub>
       <mi>μ</mi>
       <mn>1</mn>
      </msub>
      <mfrac>
       <mrow>
        <mo>∂</mo>
        <mrow>
         <mo stretchy="false">⟨</mo>
         <mi>E</mi>
         <mo stretchy="false">⟩</mo>
        </mrow>
       </mrow>
       <mrow>
        <mo>∂</mo>
        <msub>
         <mi>μ</mi>
         <mn>1</mn>
        </msub>
       </mrow>
      </mfrac>
     </mrow>
     <mo>+</mo>
     <mrow>
      <mi>k</mi>
      <mi>T</mi>
      <msub>
       <mi>μ</mi>
       <mn>2</mn>
      </msub>
      <mfrac>
       <mrow>
        <mo>∂</mo>
        <mrow>
         <mo stretchy="false">⟨</mo>
         <mi>E</mi>
         <mo stretchy="false">⟩</mo>
        </mrow>
       </mrow>
       <mrow>
        <mo>∂</mo>
        <msub>
         <mi>μ</mi>
         <mn>2</mn>
        </msub>
       </mrow>
      </mfrac>
     </mrow>
     <mo>+</mo>
     <mi mathvariant="normal">…</mi>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <minus></minus>
     <apply>
      <csymbol cd="latexml">delimited-⟨⟩</csymbol>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>E</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="latexml">delimited-⟨⟩</csymbol>
       <ci>E</ci>
      </apply>
      <cn type="integer">2</cn>
     </apply>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <ci>k</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>T</ci>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <divide></divide>
       <apply>
        <partialdiff></partialdiff>
        <ci>E</ci>
       </apply>
       <apply>
        <partialdiff></partialdiff>
        <ci>T</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <ci>k</ci>
      <ci>T</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>μ</ci>
       <cn type="integer">1</cn>
      </apply>
      <apply>
       <divide></divide>
       <apply>
        <partialdiff></partialdiff>
        <ci>E</ci>
       </apply>
       <apply>
        <partialdiff></partialdiff>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>μ</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <ci>k</ci>
      <ci>T</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>μ</ci>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <divide></divide>
       <apply>
        <partialdiff></partialdiff>
        <ci>E</ci>
       </apply>
       <apply>
        <partialdiff></partialdiff>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>μ</ci>
         <cn type="integer">2</cn>
        </apply>
       </apply>
      </apply>
     </apply>
     <ci>normal-…</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \langle E^{2}\rangle-\langle E\rangle^{2}=kT^{2}\frac{\partial\langle E\rangle%
}{\partial T}+kT\mu_{1}\frac{\partial\langle E\rangle}{\partial\mu_{1}}+kT\mu_%
{2}\frac{\partial\langle E\rangle}{\partial\mu_{2}}+\ldots,
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Grand_canonical_ensemble:24">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mrow>
      <mo stretchy="false">⟨</mo>
      <msubsup>
       <mi>N</mi>
       <mn>1</mn>
       <mn>2</mn>
      </msubsup>
      <mo stretchy="false">⟩</mo>
     </mrow>
     <mo>-</mo>
     <msup>
      <mrow>
       <mo stretchy="false">⟨</mo>
       <msub>
        <mi>N</mi>
        <mn>1</mn>
       </msub>
       <mo stretchy="false">⟩</mo>
      </mrow>
      <mn>2</mn>
     </msup>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mi>k</mi>
     <mi>T</mi>
     <mfrac>
      <mrow>
       <mo>∂</mo>
       <mrow>
        <mo stretchy="false">⟨</mo>
        <msub>
         <mi>N</mi>
         <mn>1</mn>
        </msub>
        <mo stretchy="false">⟩</mo>
       </mrow>
      </mrow>
      <mrow>
       <mo>∂</mo>
       <msub>
        <mi>μ</mi>
        <mn>1</mn>
       </msub>
      </mrow>
     </mfrac>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <minus></minus>
     <apply>
      <csymbol cd="latexml">delimited-⟨⟩</csymbol>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>N</ci>
        <cn type="integer">1</cn>
       </apply>
       <cn type="integer">2</cn>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="latexml">delimited-⟨⟩</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>N</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <cn type="integer">2</cn>
     </apply>
    </apply>
    <apply>
     <times></times>
     <ci>k</ci>
     <ci>T</ci>
     <apply>
      <divide></divide>
      <apply>
       <partialdiff></partialdiff>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>N</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <apply>
       <partialdiff></partialdiff>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>μ</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \langle N_{1}^{2}\rangle-\langle N_{1}\rangle^{2}=kT\frac{\partial\langle N_{1%
}\rangle}{\partial\mu_{1}}.
  </annotation>
 </semantics>
</math>

</p>

<p><em>Correlations in fluctuations</em>: The <a href="covariance" title="wikilink">covariances</a> of particle numbers and energy are<a class="footnoteRef" href="#fn11" id="fnref11"><sup>11</sup></a></p>

<p>

<math display="block" id="Grand_canonical_ensemble:25">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mrow>
      <mo stretchy="false">⟨</mo>
      <mrow>
       <msub>
        <mi>N</mi>
        <mn>1</mn>
       </msub>
       <msub>
        <mi>N</mi>
        <mn>2</mn>
       </msub>
      </mrow>
      <mo stretchy="false">⟩</mo>
     </mrow>
     <mo>-</mo>
     <mrow>
      <mrow>
       <mo stretchy="false">⟨</mo>
       <msub>
        <mi>N</mi>
        <mn>1</mn>
       </msub>
       <mo stretchy="false">⟩</mo>
      </mrow>
      <mrow>
       <mo stretchy="false">⟨</mo>
       <msub>
        <mi>N</mi>
        <mn>2</mn>
       </msub>
       <mo stretchy="false">⟩</mo>
      </mrow>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mi>k</mi>
     <mi>T</mi>
     <mfrac>
      <mrow>
       <mo>∂</mo>
       <mrow>
        <mo stretchy="false">⟨</mo>
        <msub>
         <mi>N</mi>
         <mn>2</mn>
        </msub>
        <mo stretchy="false">⟩</mo>
       </mrow>
      </mrow>
      <mrow>
       <mo>∂</mo>
       <msub>
        <mi>μ</mi>
        <mn>1</mn>
       </msub>
      </mrow>
     </mfrac>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mi>k</mi>
     <mi>T</mi>
     <mfrac>
      <mrow>
       <mo>∂</mo>
       <mrow>
        <mo stretchy="false">⟨</mo>
        <msub>
         <mi>N</mi>
         <mn>1</mn>
        </msub>
        <mo stretchy="false">⟩</mo>
       </mrow>
      </mrow>
      <mrow>
       <mo>∂</mo>
       <msub>
        <mi>μ</mi>
        <mn>2</mn>
       </msub>
      </mrow>
     </mfrac>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <minus></minus>
      <apply>
       <csymbol cd="latexml">delimited-⟨⟩</csymbol>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>N</ci>
         <cn type="integer">1</cn>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>N</ci>
         <cn type="integer">2</cn>
        </apply>
       </apply>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="latexml">delimited-⟨⟩</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>N</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <apply>
        <csymbol cd="latexml">delimited-⟨⟩</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>N</ci>
         <cn type="integer">2</cn>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <ci>k</ci>
      <ci>T</ci>
      <apply>
       <divide></divide>
       <apply>
        <partialdiff></partialdiff>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>N</ci>
         <cn type="integer">2</cn>
        </apply>
       </apply>
       <apply>
        <partialdiff></partialdiff>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>μ</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <ci>k</ci>
      <ci>T</ci>
      <apply>
       <divide></divide>
       <apply>
        <partialdiff></partialdiff>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>N</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <apply>
        <partialdiff></partialdiff>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>μ</ci>
         <cn type="integer">2</cn>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \langle N_{1}N_{2}\rangle-\langle N_{1}\rangle\langle N_{2}\rangle=kT\frac{%
\partial\langle N_{2}\rangle}{\partial\mu_{1}}=kT\frac{\partial\langle N_{1}%
\rangle}{\partial\mu_{2}}.
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Grand_canonical_ensemble:26">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mrow>
      <mo stretchy="false">⟨</mo>
      <mrow>
       <msub>
        <mi>N</mi>
        <mn>1</mn>
       </msub>
       <mi>E</mi>
      </mrow>
      <mo stretchy="false">⟩</mo>
     </mrow>
     <mo>-</mo>
     <mrow>
      <mrow>
       <mo stretchy="false">⟨</mo>
       <msub>
        <mi>N</mi>
        <mn>1</mn>
       </msub>
       <mo stretchy="false">⟩</mo>
      </mrow>
      <mrow>
       <mo stretchy="false">⟨</mo>
       <mi>E</mi>
       <mo stretchy="false">⟩</mo>
      </mrow>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mi>k</mi>
     <mi>T</mi>
     <mfrac>
      <mrow>
       <mo>∂</mo>
       <mrow>
        <mo stretchy="false">⟨</mo>
        <mi>E</mi>
        <mo stretchy="false">⟩</mo>
       </mrow>
      </mrow>
      <mrow>
       <mo>∂</mo>
       <msub>
        <mi>μ</mi>
        <mn>1</mn>
       </msub>
      </mrow>
     </mfrac>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <minus></minus>
     <apply>
      <csymbol cd="latexml">delimited-⟨⟩</csymbol>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>N</ci>
        <cn type="integer">1</cn>
       </apply>
       <ci>E</ci>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="latexml">delimited-⟨⟩</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>N</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <apply>
       <csymbol cd="latexml">delimited-⟨⟩</csymbol>
       <ci>E</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <times></times>
     <ci>k</ci>
     <ci>T</ci>
     <apply>
      <divide></divide>
      <apply>
       <partialdiff></partialdiff>
       <ci>E</ci>
      </apply>
      <apply>
       <partialdiff></partialdiff>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>μ</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \langle N_{1}E\rangle-\langle N_{1}\rangle\langle E\rangle=kT\frac{\partial%
\langle E\rangle}{\partial\mu_{1}},
  </annotation>
 </semantics>
</math>

</p>
<h2 id="example-ensembles">Example ensembles</h2>

<p>The usefulness of the grand canonical ensemble is illustrated in the examples below. In each case the grand potential is calculated on the basis of the relationship</p>

<p>

<math display="block" id="Grand_canonical_ensemble:27">
 <semantics>
  <mrow>
   <mi mathvariant="normal">Ω</mi>
   <mo>=</mo>
   <mrow>
    <mo>-</mo>
    <mrow>
     <mi>k</mi>
     <mi>T</mi>
     <mrow>
      <mi>ln</mi>
      <mrow>
       <mo maxsize="160%" minsize="160%">(</mo>
       <mrow>
        <munder>
         <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
         <mi>microstates</mi>
        </munder>
        <msup>
         <mi>e</mi>
         <mfrac>
          <mrow>
           <mrow>
            <mi>μ</mi>
            <mi>N</mi>
           </mrow>
           <mo>-</mo>
           <mi>E</mi>
          </mrow>
          <mrow>
           <mi>k</mi>
           <mi>T</mi>
          </mrow>
         </mfrac>
        </msup>
       </mrow>
       <mo maxsize="160%" minsize="160%">)</mo>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>normal-Ω</ci>
    <apply>
     <minus></minus>
     <apply>
      <times></times>
      <ci>k</ci>
      <ci>T</ci>
      <apply>
       <ln></ln>
       <apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <sum></sum>
         <ci>microstates</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>e</ci>
         <apply>
          <divide></divide>
          <apply>
           <minus></minus>
           <apply>
            <times></times>
            <ci>μ</ci>
            <ci>N</ci>
           </apply>
           <ci>E</ci>
          </apply>
          <apply>
           <times></times>
           <ci>k</ci>
           <ci>T</ci>
          </apply>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Omega=-kT\ln\Big(\sum_{\rm microstates}e^{\frac{\mu N-E}{kT}}\Big)
  </annotation>
 </semantics>
</math>

 which is required for the microstates' probabilities to add up to 1.</p>
<h3 id="statistics-of-noninteracting-particles">Statistics of noninteracting particles</h3>
<h4 id="bosons-and-fermions-quantum">Bosons and fermions (quantum)</h4>

<p>In the special case of a quantum system of many <em>non-interacting</em> particles, the thermodynamics are simple to compute.<a class="footnoteRef" href="#fn12" id="fnref12"><sup>12</sup></a> Since the particles are non-interacting, one can compute a series of single-particle <a href="stationary_state" title="wikilink">stationary states</a>, each which represent a separable part that can be included into the total quantum state of the system. For now let us refer to these single-particle stationary states as <em>orbitals</em> (to avoid confusing these "states" with the total many-body state), with the provision that each possible internal particle property (<a href="electron_spin" title="wikilink">spin</a> or <a href="polarization_(waves)" title="wikilink">polarization</a>) counts as a separate orbital. Each orbital may be occupied by a particle (or particles), or may be empty.</p>

<p>Since the particles are non-interacting, we may take the viewpoint that <em>each orbital forms a separate thermodynamic system</em>. Thus each orbital is a grand canonical ensemble unto itself, one so simple that its statistics can be immediately derived here. Focusing on just one orbital, the total energy for a <a href="microstate_(statistical_mechanics)" title="wikilink">microstate</a> of 

<math display="inline" id="Grand_canonical_ensemble:28">
 <semantics>
  <mi>N</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>N</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   N
  </annotation>
 </semantics>
</math>

 particles in this orbital will be 

<math display="inline" id="Grand_canonical_ensemble:29">
 <semantics>
  <mrow>
   <mi>N</mi>
   <mi>ϵ</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>N</ci>
    <ci>ϵ</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Nϵ
  </annotation>
 </semantics>
</math>

, where 

<math display="inline" id="Grand_canonical_ensemble:30">
 <semantics>
  <mi>ϵ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>ϵ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   ϵ
  </annotation>
 </semantics>
</math>

 is the characteristic energy level of that orbital. , or 

<math display="inline" id="Grand_canonical_ensemble:31">
 <semantics>
  <mrow>
   <mi>N</mi>
   <mo>=</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>N</ci>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   N=1
  </annotation>
 </semantics>
</math>

 with <mtpl> <em>ϵ</em>}}</mtpl>, leading to a two-term series</p>

<p>

<math display="inline" id="Grand_canonical_ensemble:32">
 <semantics>
  <mi mathvariant="normal">Ω</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>normal-Ω</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle\Omega
  </annotation>
 </semantics>
</math>


 |2= For bosons, 

<math display="inline" id="Grand_canonical_ensemble:33">
 <semantics>
  <mi>N</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>N</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   N
  </annotation>
 </semantics>
</math>

 may be any nonnegative integer and each value of 

<math display="inline" id="Grand_canonical_ensemble:34">
 <semantics>
  <mi>N</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>N</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   N
  </annotation>
 </semantics>
</math>

 counts as one microstate due to the <a href="Identical_particles" title="wikilink">indistinguishability of particles</a>, leading to a <a href="geometric_series" title="wikilink">geometric series</a>:</p>

<p>

<math display="inline" id="Grand_canonical_ensemble:35">
 <semantics>
  <mi mathvariant="normal">Ω</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>normal-Ω</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle\Omega
  </annotation>
 </semantics>
</math>


 }} In each case the value 

<math display="inline" id="Grand_canonical_ensemble:36">
 <semantics>
  <mrow>
   <mrow>
    <mo stretchy="false">⟨</mo>
    <mi>N</mi>
    <mo stretchy="false">⟩</mo>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mo>-</mo>
    <mfrac>
     <mrow>
      <mo>∂</mo>
      <mi mathvariant="normal">Ω</mi>
     </mrow>
     <mrow>
      <mo>∂</mo>
      <mi>μ</mi>
     </mrow>
    </mfrac>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="latexml">delimited-⟨⟩</csymbol>
     <ci>N</ci>
    </apply>
    <apply>
     <minus></minus>
     <apply>
      <divide></divide>
      <apply>
       <partialdiff></partialdiff>
       <ci>normal-Ω</ci>
      </apply>
      <apply>
       <partialdiff></partialdiff>
       <ci>μ</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \scriptstyle\langle N\rangle=-\tfrac{\partial\Omega}{\partial\mu}
  </annotation>
 </semantics>
</math>

 gives the thermodynamic average number of particles on the orbital: the <a href="Fermi–Dirac_distribution" title="wikilink">Fermi–Dirac distribution</a> for fermions, and the <a href="Bose–Einstein_distribution" title="wikilink">Bose–Einstein distribution</a> for bosons.</p>
<h4 id="indistinguishable-classical-particles">Indistinguishable classical particles</h4>

<p>In classical mechanics it is also possible to consider indistinguishable particles (in fact, indistinguishability is a prerequisite for defining a chemical potential in a consistent manner; all particles of a given kind must be interchangeable<a class="footnoteRef" href="#fn13" id="fnref13"><sup>13</sup></a>). We again consider placing multiple particles of the same kind into the same microstate of single-particle phase space, which we again call an "orbital". However, compared to quantum mechanics, the classical case is complicated by the fact that a microstate in classical mechanics does not refer to a single point in phase space but rather to an extended region in phase space: one microstate contains an infinite number of states, all distinct but of similar character. As a result, when multiple particles are placed into the same orbital, the overall collection of the particles (in the system phase space) does not count as one whole microstate but rather only a <em>fraction</em> of a microstate, because identical states (formed by permutation of identical particles) should not be overcounted. The overcounting correction factor is the <a class="uri" href="factorial" title="wikilink">factorial</a> of the number of particles.</p>

<p>The statistics in this case take the form of an exponential power series</p>

<p>

<math display="inline" id="Grand_canonical_ensemble:37">
 <semantics>
  <mi mathvariant="normal">Ω</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>normal-Ω</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle\Omega
  </annotation>
 </semantics>
</math>


 the value 

<math display="inline" id="Grand_canonical_ensemble:38">
 <semantics>
  <mrow>
   <mrow>
    <mo stretchy="false">⟨</mo>
    <mi>N</mi>
    <mo stretchy="false">⟩</mo>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mo>-</mo>
    <mfrac>
     <mrow>
      <mo>∂</mo>
      <mi mathvariant="normal">Ω</mi>
     </mrow>
     <mrow>
      <mo>∂</mo>
      <mi>μ</mi>
     </mrow>
    </mfrac>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="latexml">delimited-⟨⟩</csymbol>
     <ci>N</ci>
    </apply>
    <apply>
     <minus></minus>
     <apply>
      <divide></divide>
      <apply>
       <partialdiff></partialdiff>
       <ci>normal-Ω</ci>
      </apply>
      <apply>
       <partialdiff></partialdiff>
       <ci>μ</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \scriptstyle\langle N\rangle=-\tfrac{\partial\Omega}{\partial\mu}
  </annotation>
 </semantics>
</math>

 corresponding to <a href="Maxwell–Boltzmann_statistics" title="wikilink">Maxwell–Boltzmann statistics</a>.</p>
<h3 id="ionization-of-an-isolated-atom">Ionization of an isolated atom</h3>
<figure><b>(Figure)</b>
<figcaption>Surface ionization effect in a vaporized <a class="uri" href="cesium" title="wikilink">cesium</a> atom at 1500 K, calculated using the method in this section (also including <a href="Degeneracy_(quantum_mechanics)" title="wikilink">degeneracy</a>). Y-axis: average number of electrons; the atom is neutral when it has 55 electrons. X-axis: energy variable, which is equal to the surface <a href="work_function" title="wikilink">work function</a>.</figcaption>
</figure>

<p>The grand canonical ensemble can be used to predict whether an atom prefers to be in a neutral state or ionized state. An atom is able to exist in ionized states with more or fewer electrons compared to neutral. As shown below, ionized states may be thermodynamically preferred depending on the environment. Consider a simplified model where the atom can be in a neutral state or in one of two ionized states (a detailed calculation also includes the degeneracy factors of the states<a class="footnoteRef" href="#fn14" id="fnref14"><sup>14</sup></a>):</p>
<ul>
<li>charge neutral state, with <mtpl></mtpl> electrons and energy <mtpl></mtpl>.</li>
<li>an <a class="uri" href="oxidized" title="wikilink">oxidized</a> state (<mtpl></mtpl> electrons) with energy <mtpl></mtpl></li>
<li>a <a href="redox" title="wikilink">reduced</a> state (<mtpl></mtpl> electrons) with energy <mtpl></mtpl></li>
</ul>

<p>Here <mtpl></mtpl> and <mtpl></mtpl> are the atom's <a href="ionization_energy" title="wikilink">ionization energy</a> and <a href="electron_affinity" title="wikilink">electron affinity</a>, respectively; 

<math display="inline" id="Grand_canonical_ensemble:39">
 <semantics>
  <mi>ϕ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>ϕ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   ϕ
  </annotation>
 </semantics>
</math>

 is the local <a href="electrostatic_potential" title="wikilink">electrostatic potential</a> in the vacuum nearby the atom, and 

<math display="inline" id="Grand_canonical_ensemble:40">
 <semantics>
  <mrow>
   <mi mathvariant="normal">−</mi>
   <mi>q</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>normal-−</ci>
    <ci>q</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   −q
  </annotation>
 </semantics>
</math>

 is the <a href="electron_charge" title="wikilink">electron charge</a>.</p>

<p>The grand potential in this case is thus determined by</p>

<p>

<math display="inline" id="Grand_canonical_ensemble:41">
 <semantics>
  <mi mathvariant="normal">Ω</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>normal-Ω</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle\Omega
  </annotation>
 </semantics>
</math>


</p>

<p>The quantity 

<math display="inline" id="Grand_canonical_ensemble:42">
 <semantics>
  <mrow>
   <mi mathvariant="normal">−</mi>
   <mi>q</mi>
   <mi>ϕ</mi>
   <mi mathvariant="normal">−</mi>
   <mi mathvariant="normal">µ</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>normal-−</ci>
    <ci>q</ci>
    <ci>ϕ</ci>
    <ci>normal-−</ci>
    <ci>normal-µ</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   −qϕ−µ
  </annotation>
 </semantics>
</math>

 is critical in this case, for determining the balance between the various states. This value is determined by the environment around the atom.</p>

<p>If one of these atoms is placed into a vacuum box, then 

<math display="inline" id="Grand_canonical_ensemble:43">
 <semantics>
  <mrow>
   <mrow>
    <mi mathvariant="normal">−</mi>
    <mi>q</mi>
    <mi>ϕ</mi>
    <mi mathvariant="normal">−</mi>
    <mi mathvariant="normal">µ</mi>
   </mrow>
   <mo>=</mo>
   <mi>W</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>normal-−</ci>
     <ci>q</ci>
     <ci>ϕ</ci>
     <ci>normal-−</ci>
     <ci>normal-µ</ci>
    </apply>
    <ci>W</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   −qϕ−µ=W
  </annotation>
 </semantics>
</math>

, the <a href="work_function" title="wikilink">work function</a> of the box lining material. Comparing the tables of <a href="work_function" title="wikilink">work function</a> for various solid materials with the tables of <a href="electron_affinity" title="wikilink">electron affinity</a> and <a href="ionization_energy" title="wikilink">ionization energy</a> for atomic species, it is clear that many combinations would result in a neutral atom, however some specific combinations would result in the atom preferring an ionized state: e.g., a <a class="uri" href="halogen" title="wikilink">halogen</a> atom in a <a class="uri" href="ytterbium" title="wikilink">ytterbium</a> box, or a <a class="uri" href="cesium" title="wikilink">cesium</a> atom in a <a class="uri" href="tungsten" title="wikilink">tungsten</a> box. At room temperature this situation is not stable since the atom tends to <a class="uri" href="adsorb" title="wikilink">adsorb</a> to the exposed lining of the box instead of floating freely. At high temperatures, however, the atoms are evaporated from the surface in ionic form; this spontaneous <a href="surface_ionization" title="wikilink">surface ionization</a> effect has been used as a cesium <a href="ion_source" title="wikilink">ion source</a>.<a class="footnoteRef" href="#fn15" id="fnref15"><sup>15</sup></a></p>

<p>At room temperature, this example finds application in <a href="semiconductor" title="wikilink">semiconductors</a>, where the ionization of an <a class="uri" href="dopant" title="wikilink">dopant</a> atom is well described by this ensemble.<a class="footnoteRef" href="#fn16" id="fnref16"><sup>16</sup></a> In the semiconductor, the <a href="conduction_band" title="wikilink">conduction band</a> edge <mtpl></mtpl> plays the role of the vacuum energy level (replacing 

<math display="inline" id="Grand_canonical_ensemble:44">
 <semantics>
  <mrow>
   <mi mathvariant="normal">−</mi>
   <mi>q</mi>
   <mi>ϕ</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>normal-−</ci>
    <ci>q</ci>
    <ci>ϕ</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   −qϕ
  </annotation>
 </semantics>
</math>

), and 

<math display="inline" id="Grand_canonical_ensemble:45">
 <semantics>
  <mi mathvariant="normal">µ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>normal-µ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   µ
  </annotation>
 </semantics>
</math>

 is known as the <a href="Fermi_level" title="wikilink">Fermi level</a>. Of course, the ionization energy and electron affinity of the dopant atom are strongly modified relative to their vacuum values. A typical donor dopant in silicon, phosphorus, has <mtpl> 45 meV}}</mtpl>;<a class="footnoteRef" href="#fn17" id="fnref17"><sup>17</sup></a> the value of <mtpl></mtpl> in the intrinsic silicon is initially about 

<math display="inline" id="Grand_canonical_ensemble:46">
 <semantics>
  <mrow>
   <mn>600</mn>
   <mi>m</mi>
   <mi>e</mi>
   <mi>V</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <cn type="integer">600</cn>
    <ci>m</ci>
    <ci>e</ci>
    <ci>V</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   600meV
  </annotation>
 </semantics>
</math>

, guaranteeing the ionization of the dopant. The value of <mtpl></mtpl> depends strongly on electrostatics, however, so under some circumstances it is possible to de-ionize the dopant.</p>
<h2 id="meaning-of-chemical-potential-generalized-particle-number">Meaning of chemical potential, generalized "particle number"</h2>

<p>In order for a particle number to have an associated chemical potential, it must be conserved during the internal dynamics of the system, and only able to change when the system exchanges particles with an external reservoir.</p>

<p>If the particles can be created out of energy during the dynamics of the system, then an associated 

<math display="inline" id="Grand_canonical_ensemble:47">
 <semantics>
  <mrow>
   <mi mathvariant="normal">µ</mi>
   <mi>N</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>normal-µ</ci>
    <ci>N</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   µN
  </annotation>
 </semantics>
</math>

 term must not appear in the probability expression for the grand canonical ensemble. In effect, this is the same as requiring that 

<math display="inline" id="Grand_canonical_ensemble:48">
 <semantics>
  <mrow>
   <mi mathvariant="normal">µ</mi>
   <mo>=</mo>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>normal-µ</ci>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   µ=0
  </annotation>
 </semantics>
</math>

 for that kind of particle. Such is the case for <a href="black-body_radiation" title="wikilink">photons in a black cavity</a>, whose number regularly change due to absorption and emission on the cavity walls. (On the other hand, photons in a highly reflective cavity can be conserved and caused to have a nonzero 

<math display="inline" id="Grand_canonical_ensemble:49">
 <semantics>
  <mi mathvariant="normal">µ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>normal-µ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   µ
  </annotation>
 </semantics>
</math>

.<a class="footnoteRef" href="#fn18" id="fnref18"><sup>18</sup></a>)</p>

<p>In some cases the number of particles is not conserved and the 

<math display="inline" id="Grand_canonical_ensemble:50">
 <semantics>
  <mi>N</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>N</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   N
  </annotation>
 </semantics>
</math>

 represents a more abstract conserved quantity:</p>
<ul>
<li><em>Chemical reactions</em>: Chemical reactions can convert one type of molecule to another; if reactions occur then the <mtpl></mtpl> must be defined such that they do not change during the chemical reaction.</li>
<li><em>High energy particle physics</em>: Ordinary particles can be spawned out of pure energy, if a corresponding <a class="uri" href="antiparticle" title="wikilink">antiparticle</a> is created. If this sort of process is allowed, then neither the number of particles nor antiparticles are conserved. Instead, 

<math display="inline" id="Grand_canonical_ensemble:51">
 <semantics>
  <mrow>
   <mi>N</mi>
   <mo>=</mo>
   <mrow>
    <mo stretchy="false">(</mo>
    <mrow>
     <mrow>
      <mi>p</mi>
      <mi>a</mi>
      <mi>r</mi>
      <mi>t</mi>
      <mi>i</mi>
      <mi>c</mi>
      <mi>l</mi>
      <mi>e</mi>
      <mi>n</mi>
      <mi>u</mi>
      <mi>m</mi>
      <mi>b</mi>
      <mi>e</mi>
      <mi>r</mi>
     </mrow>
     <mo>-</mo>
     <mrow>
      <mi>a</mi>
      <mi>n</mi>
      <mi>t</mi>
      <mi>i</mi>
      <mi>p</mi>
      <mi>a</mi>
      <mi>r</mi>
      <mi>t</mi>
      <mi>i</mi>
      <mi>c</mi>
      <mi>l</mi>
      <mi>e</mi>
      <mi>n</mi>
      <mi>u</mi>
      <mi>m</mi>
      <mi>b</mi>
      <mi>e</mi>
      <mi>r</mi>
     </mrow>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>N</ci>
    <apply>
     <minus></minus>
     <apply>
      <times></times>
      <ci>p</ci>
      <ci>a</ci>
      <ci>r</ci>
      <ci>t</ci>
      <ci>i</ci>
      <ci>c</ci>
      <ci>l</ci>
      <ci>e</ci>
      <ci>n</ci>
      <ci>u</ci>
      <ci>m</ci>
      <ci>b</ci>
      <ci>e</ci>
      <ci>r</ci>
     </apply>
     <apply>
      <times></times>
      <ci>a</ci>
      <ci>n</ci>
      <ci>t</ci>
      <ci>i</ci>
      <ci>p</ci>
      <ci>a</ci>
      <ci>r</ci>
      <ci>t</ci>
      <ci>i</ci>
      <ci>c</ci>
      <ci>l</ci>
      <ci>e</ci>
      <ci>n</ci>
      <ci>u</ci>
      <ci>m</ci>
      <ci>b</ci>
      <ci>e</ci>
      <ci>r</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   N=(particlenumber-antiparticlenumber)
  </annotation>
 </semantics>
</math>

 is conserved.<a class="footnoteRef" href="#fn19" id="fnref19"><sup>19</sup></a><a class="footnoteRef" href="#fn20" id="fnref20"><sup>20</sup></a> As particle energies increase, there are more possibilities to convert between particle types, and so there are fewer numbers that are truly conserved. At the very highest energies the only conserved numbers are <a href="electric_charge" title="wikilink">electric charge</a>, <a href="weak_isospin" title="wikilink">weak isospin</a>, and <a href="B_−_L" title="wikilink">baryon number − lepton number</a>.</li>
</ul>

<p>On the other hand, in some cases a single kind of particle may have multiple conserved numbers:</p>
<ul>
<li><em>Closed compartments</em>: In a system composed of multiple compartments that share energy but do not share particles, it is possible to set the chemical potentials separately for each compartment. For example, a <a class="uri" href="capacitor" title="wikilink">capacitor</a> is composed of two isolated conductors and is charged by applying a difference in <a href="electron_chemical_potential" title="wikilink">electron chemical potential</a>.</li>
<li><em>Slow equilibration</em>: In some quasi-equilibrium situations it is possible to have two distinct populations of the same kind of particle in the same location, which are each equilibrated internally but not with each other. Though not strictly in equilibrium, it may be useful to name quasi-equilibrium chemical potentials which can differ among the different populations. Examples: (<a href="semiconductor_physics" title="wikilink">semiconductor physics</a>) distinct <a href="quasi-Fermi_level" title="wikilink">quasi-Fermi levels</a> (electron chemical potentials) in the <a href="conduction_band" title="wikilink">conduction band</a> and <a href="valence_band" title="wikilink">valence band</a>; (<a href="spintronic" title="wikilink">spintronics</a>) distinct spin-up and spin-down chemical potentials; (<a href="cryogenic" title="wikilink">cryogenics</a>) distinct <a class="uri" href="parahydrogen" title="wikilink">parahydrogen</a> and <a class="uri" href="orthohydrogen" title="wikilink">orthohydrogen</a> chemical potentials.</li>
</ul>
<h2 id="precise-expressions-for-the-ensemble">Precise expressions for the ensemble</h2>

<p>The precise mathematical expression for statistical ensembles has a distinct form depending on the type of mechanics under consideration (quantum or classical), as the notion of a "microstate" is considerably different. In quantum mechanics, the grand canonical ensemble affords a simple description since diagonalization provides a set of distinct <a href="microstate_(statistical_mechanics)" title="wikilink">microstates</a> of a system, each with well-defined energy and particle number. The classical mechanical case is more complex as it involves not stationary states but instead an integral over canonical <a href="phase_space" title="wikilink">phase space</a>.</p>
<h3 id="quantum-mechanical">Quantum mechanical</h3>

<p>A statistical ensemble in quantum mechanics is represented by a <a href="density_matrix" title="wikilink">density matrix</a>, denoted by 

<math display="inline" id="Grand_canonical_ensemble:52">
 <semantics>
  <mi>ρ̂</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>ρ̂</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   ρ̂
  </annotation>
 </semantics>
</math>

. The grand canonical ensemble is the density matrix</p>

<p>

<math display="block" id="Grand_canonical_ensemble:53">
 <semantics>
  <mrow>
   <mrow>
    <mover accent="true">
     <mi>ρ</mi>
     <mo stretchy="false">^</mo>
    </mover>
    <mo>=</mo>
    <mrow>
     <mi>exp</mi>
     <mrow>
      <mo maxsize="120%" minsize="120%">(</mo>
      <mrow>
       <mstyle displaystyle="false">
        <mfrac>
         <mn>1</mn>
         <mrow>
          <mi>k</mi>
          <mi>T</mi>
         </mrow>
        </mfrac>
       </mstyle>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mrow>
          <mi mathvariant="normal">Ω</mi>
          <mo>+</mo>
          <mrow>
           <msub>
            <mi>μ</mi>
            <mn>1</mn>
           </msub>
           <msub>
            <mover accent="true">
             <mi>N</mi>
             <mo stretchy="false">^</mo>
            </mover>
            <mn>1</mn>
           </msub>
          </mrow>
          <mo>+</mo>
          <mi mathvariant="normal">…</mi>
          <mo>+</mo>
          <mrow>
           <msub>
            <mi>μ</mi>
            <mi>s</mi>
           </msub>
           <msub>
            <mover accent="true">
             <mi>N</mi>
             <mo stretchy="false">^</mo>
            </mover>
            <mi>s</mi>
           </msub>
          </mrow>
         </mrow>
         <mo>-</mo>
         <mover accent="true">
          <mi>H</mi>
          <mo stretchy="false">^</mo>
         </mover>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
      <mo maxsize="120%" minsize="120%">)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <ci>normal-^</ci>
     <ci>ρ</ci>
    </apply>
    <apply>
     <exp></exp>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <apply>
        <times></times>
        <ci>k</ci>
        <ci>T</ci>
       </apply>
      </apply>
      <apply>
       <minus></minus>
       <apply>
        <plus></plus>
        <ci>normal-Ω</ci>
        <apply>
         <times></times>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>μ</ci>
          <cn type="integer">1</cn>
         </apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <apply>
           <ci>normal-^</ci>
           <ci>N</ci>
          </apply>
          <cn type="integer">1</cn>
         </apply>
        </apply>
        <ci>normal-…</ci>
        <apply>
         <times></times>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>μ</ci>
          <ci>s</ci>
         </apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <apply>
           <ci>normal-^</ci>
           <ci>N</ci>
          </apply>
          <ci>s</ci>
         </apply>
        </apply>
       </apply>
       <apply>
        <ci>normal-^</ci>
        <ci>H</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \hat{\rho}=\exp\big(\tfrac{1}{kT}(\Omega+\mu_{1}\hat{N}_{1}+\ldots+\mu_{s}\hat%
{N}_{s}-\hat{H})\big),
  </annotation>
 </semantics>
</math>

 where 

<math display="inline" id="Grand_canonical_ensemble:54">
 <semantics>
  <mi>Ĥ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>Ĥ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Ĥ
  </annotation>
 </semantics>
</math>

 is the system's total energy operator (<a href="Hamiltonian_(quantum_mechanics)" title="wikilink">Hamiltonian</a>), <mtpl></mtpl> is the system's total <a href="particle_number_operator" title="wikilink">particle number operator</a> for particles of type 1, <mtpl></mtpl> is the total <a href="particle_number_operator" title="wikilink">particle number operator</a> for particles of type 2, and so on. 

<math display="inline" id="Grand_canonical_ensemble:55">
 <semantics>
  <mrow>
   <mi>e</mi>
   <mi>x</mi>
   <mi>p</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>e</ci>
    <ci>x</ci>
    <ci>p</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   exp
  </annotation>
 </semantics>
</math>

 is the <a href="matrix_exponential" title="wikilink">matrix exponential</a> operator. The grand potential 

<math display="inline" id="Grand_canonical_ensemble:56">
 <semantics>
  <mi mathvariant="normal">Ω</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>normal-Ω</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Ω
  </annotation>
 </semantics>
</math>

 is determined by the probability normalization condition that the density matrix has a <a href="trace_(linear_algebra)" title="wikilink">trace</a> of one, 

<math display="inline" id="Grand_canonical_ensemble:57">
 <semantics>
  <mrow>
   <mrow>
    <mi>T</mi>
    <mi>r</mi>
    <mi>ρ̂</mi>
   </mrow>
   <mo>=</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>T</ci>
     <ci>r</ci>
     <ci>ρ̂</ci>
    </apply>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Trρ̂=1
  </annotation>
 </semantics>
</math>

:</p>

<p>

<math display="block" id="Grand_canonical_ensemble:58">
 <semantics>
  <mrow>
   <mrow>
    <msup>
     <mi>e</mi>
     <mrow>
      <mo>-</mo>
      <mfrac>
       <mi mathvariant="normal">Ω</mi>
       <mrow>
        <mi>k</mi>
        <mi>T</mi>
       </mrow>
      </mfrac>
     </mrow>
    </msup>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mo>Tr</mo>
      <mi>exp</mi>
     </mrow>
     <mrow>
      <mo maxsize="120%" minsize="120%">(</mo>
      <mrow>
       <mstyle displaystyle="false">
        <mfrac>
         <mn>1</mn>
         <mrow>
          <mi>k</mi>
          <mi>T</mi>
         </mrow>
        </mfrac>
       </mstyle>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mrow>
          <mrow>
           <msub>
            <mi>μ</mi>
            <mn>1</mn>
           </msub>
           <msub>
            <mover accent="true">
             <mi>N</mi>
             <mo stretchy="false">^</mo>
            </mover>
            <mn>1</mn>
           </msub>
          </mrow>
          <mo>+</mo>
          <mi mathvariant="normal">…</mi>
          <mo>+</mo>
          <mrow>
           <msub>
            <mi>μ</mi>
            <mi>s</mi>
           </msub>
           <msub>
            <mover accent="true">
             <mi>N</mi>
             <mo stretchy="false">^</mo>
            </mover>
            <mi>s</mi>
           </msub>
          </mrow>
         </mrow>
         <mo>-</mo>
         <mover accent="true">
          <mi>H</mi>
          <mo stretchy="false">^</mo>
         </mover>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
      <mo maxsize="120%" minsize="120%">)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>e</ci>
     <apply>
      <minus></minus>
      <apply>
       <divide></divide>
       <ci>normal-Ω</ci>
       <apply>
        <times></times>
        <ci>k</ci>
        <ci>T</ci>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <apply>
      <ci>Tr</ci>
      <exp></exp>
     </apply>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <apply>
        <times></times>
        <ci>k</ci>
        <ci>T</ci>
       </apply>
      </apply>
      <apply>
       <minus></minus>
       <apply>
        <plus></plus>
        <apply>
         <times></times>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>μ</ci>
          <cn type="integer">1</cn>
         </apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <apply>
           <ci>normal-^</ci>
           <ci>N</ci>
          </apply>
          <cn type="integer">1</cn>
         </apply>
        </apply>
        <ci>normal-…</ci>
        <apply>
         <times></times>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>μ</ci>
          <ci>s</ci>
         </apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <apply>
           <ci>normal-^</ci>
           <ci>N</ci>
          </apply>
          <ci>s</ci>
         </apply>
        </apply>
       </apply>
       <apply>
        <ci>normal-^</ci>
        <ci>H</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   e^{-\frac{\Omega}{kT}}=\operatorname{Tr}\exp\big(\tfrac{1}{kT}(\mu_{1}\hat{N}_%
{1}+\ldots+\mu_{s}\hat{N}_{s}-\hat{H})\big).
  </annotation>
 </semantics>
</math>

</p>

<p>Note that for the grand ensemble, the basis states of the operators 

<math display="inline" id="Grand_canonical_ensemble:59">
 <semantics>
  <mi>Ĥ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>Ĥ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Ĥ
  </annotation>
 </semantics>
</math>

, <mtpl></mtpl>, etc. are all states with <em>multiple particles</em> in <a href="Fock_space" title="wikilink">Fock space</a>, and the density matrix is defined on the same basis. Since the energy and particle numbers are all separately conserved, these operators are mutually commuting.</p>

<p>The grand canonical ensemble can alternatively be written in a simple form using <a href="bra–ket_notation" title="wikilink">bra–ket notation</a>, since it is possible (given the mutually commuting nature of the energy and particle number operators) to find a complete <a href="simultaneous_diagonalization" title="wikilink">basis of simultaneous eigenstates</a> <mtpl><em>ψ</em><sub><em>i</em></sub>⟩}}</mtpl>, indexed by 

<math display="inline" id="Grand_canonical_ensemble:60">
 <semantics>
  <mi>i</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>i</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   i
  </annotation>
 </semantics>
</math>

, where <mtpl><em>ψ</em><sub><em>i</em></sub>⟩ {{=}} <em>E</em><sub><em>i</em></sub>{{!}}<em>ψ</em><sub><em>i</em></sub>⟩}}</mtpl>, <mtpl><em>ψ</em><sub><em>i</em></sub>⟩ {{=}} <em>N</em><sub>1,<em>i</em></sub>{{!}}<em>ψ</em><sub><em>i</em></sub>⟩}}</mtpl>, and so on. Given such an eigenbasis, the grand canonical ensemble is simply</p>

<p>

<math display="block" id="Grand_canonical_ensemble:61">
 <semantics>
  <mrow>
   <mover accent="true">
    <mi>ρ</mi>
    <mo stretchy="false">^</mo>
   </mover>
   <mo>=</mo>
   <mrow>
    <munder>
     <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
     <mi>i</mi>
    </munder>
    <mrow>
     <msup>
      <mi>e</mi>
      <mfrac>
       <mrow>
        <mrow>
         <mi mathvariant="normal">Ω</mi>
         <mo>+</mo>
         <mrow>
          <msub>
           <mi>μ</mi>
           <mn>1</mn>
          </msub>
          <msub>
           <mi>N</mi>
           <mrow>
            <mn>1</mn>
            <mo>,</mo>
            <mi>i</mi>
           </mrow>
          </msub>
         </mrow>
         <mo>+</mo>
         <mi mathvariant="normal">…</mi>
         <mo>+</mo>
         <mrow>
          <msub>
           <mi>μ</mi>
           <mi>s</mi>
          </msub>
          <msub>
           <mi>N</mi>
           <mrow>
            <mi>s</mi>
            <mo>,</mo>
            <mi>i</mi>
           </mrow>
          </msub>
         </mrow>
        </mrow>
        <mo>-</mo>
        <msub>
         <mi>E</mi>
         <mi>i</mi>
        </msub>
       </mrow>
       <mrow>
        <mi>k</mi>
        <mi>T</mi>
       </mrow>
      </mfrac>
     </msup>
     <mrow>
      <mo fence="true" stretchy="false">|</mo>
      <msub>
       <mi>ψ</mi>
       <mi>i</mi>
      </msub>
      <mo stretchy="false">⟩</mo>
     </mrow>
     <mrow>
      <mo stretchy="false">⟨</mo>
      <msub>
       <mi>ψ</mi>
       <mi>i</mi>
      </msub>
      <mo fence="true" stretchy="false">|</mo>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <ci>normal-^</ci>
     <ci>ρ</ci>
    </apply>
    <apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <sum></sum>
      <ci>i</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>e</ci>
       <apply>
        <divide></divide>
        <apply>
         <minus></minus>
         <apply>
          <plus></plus>
          <ci>normal-Ω</ci>
          <apply>
           <times></times>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <ci>μ</ci>
            <cn type="integer">1</cn>
           </apply>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <ci>N</ci>
            <list>
             <cn type="integer">1</cn>
             <ci>i</ci>
            </list>
           </apply>
          </apply>
          <ci>normal-…</ci>
          <apply>
           <times></times>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <ci>μ</ci>
            <ci>s</ci>
           </apply>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <ci>N</ci>
            <list>
             <ci>s</ci>
             <ci>i</ci>
            </list>
           </apply>
          </apply>
         </apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>E</ci>
          <ci>i</ci>
         </apply>
        </apply>
        <apply>
         <times></times>
         <ci>k</ci>
         <ci>T</ci>
        </apply>
       </apply>
      </apply>
      <apply>
       <csymbol cd="latexml">ket</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>ψ</ci>
        <ci>i</ci>
       </apply>
      </apply>
      <apply>
       <csymbol cd="latexml">bra</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>ψ</ci>
        <ci>i</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \hat{\rho}=\sum_{i}e^{\frac{\Omega+\mu_{1}N_{1,i}+\ldots+\mu_{s}N_{s,i}-E_{i}}%
{kT}}|\psi_{i}\rangle\langle\psi_{i}|
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Grand_canonical_ensemble:62">
 <semantics>
  <mrow>
   <mrow>
    <msup>
     <mi>e</mi>
     <mrow>
      <mo>-</mo>
      <mfrac>
       <mi mathvariant="normal">Ω</mi>
       <mrow>
        <mi>k</mi>
        <mi>T</mi>
       </mrow>
      </mfrac>
     </mrow>
    </msup>
    <mo>=</mo>
    <mrow>
     <munder>
      <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
      <mi>i</mi>
     </munder>
     <msup>
      <mi>e</mi>
      <mfrac>
       <mrow>
        <mrow>
         <mrow>
          <msub>
           <mi>μ</mi>
           <mn>1</mn>
          </msub>
          <msub>
           <mi>N</mi>
           <mrow>
            <mn>1</mn>
            <mo>,</mo>
            <mi>i</mi>
           </mrow>
          </msub>
         </mrow>
         <mo>+</mo>
         <mi mathvariant="normal">…</mi>
         <mo>+</mo>
         <mrow>
          <msub>
           <mi>μ</mi>
           <mi>s</mi>
          </msub>
          <msub>
           <mi>N</mi>
           <mrow>
            <mi>s</mi>
            <mo>,</mo>
            <mi>i</mi>
           </mrow>
          </msub>
         </mrow>
        </mrow>
        <mo>-</mo>
        <msub>
         <mi>E</mi>
         <mi>i</mi>
        </msub>
       </mrow>
       <mrow>
        <mi>k</mi>
        <mi>T</mi>
       </mrow>
      </mfrac>
     </msup>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>e</ci>
     <apply>
      <minus></minus>
      <apply>
       <divide></divide>
       <ci>normal-Ω</ci>
       <apply>
        <times></times>
        <ci>k</ci>
        <ci>T</ci>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <sum></sum>
      <ci>i</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>e</ci>
      <apply>
       <divide></divide>
       <apply>
        <minus></minus>
        <apply>
         <plus></plus>
         <apply>
          <times></times>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>μ</ci>
           <cn type="integer">1</cn>
          </apply>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>N</ci>
           <list>
            <cn type="integer">1</cn>
            <ci>i</ci>
           </list>
          </apply>
         </apply>
         <ci>normal-…</ci>
         <apply>
          <times></times>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>μ</ci>
           <ci>s</ci>
          </apply>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>N</ci>
           <list>
            <ci>s</ci>
            <ci>i</ci>
           </list>
          </apply>
         </apply>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>E</ci>
         <ci>i</ci>
        </apply>
       </apply>
       <apply>
        <times></times>
        <ci>k</ci>
        <ci>T</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   e^{-\frac{\Omega}{kT}}=\sum_{i}e^{\frac{\mu_{1}N_{1,i}+\ldots+\mu_{s}N_{s,i}-E%
_{i}}{kT}}.
  </annotation>
 </semantics>
</math>

 where the sum is over the complete set of states with state 

<math display="inline" id="Grand_canonical_ensemble:63">
 <semantics>
  <mi>i</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>i</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   i
  </annotation>
 </semantics>
</math>

 having <mtpl></mtpl> total energy, <mtpl></mtpl> particles of type 1, <mtpl></mtpl> particles of type 2, and so on.</p>
<h3 id="classical-mechanical">Classical mechanical</h3>

<p>In classical mechanics, a grand ensemble is instead represented by a <a href="joint_probability_density_function" title="wikilink">joint probability density function</a> defined over multiple <a href="phase_space" title="wikilink">phase spaces</a> of varying dimensions, <mtpl></mtpl>, where the <mtpl></mtpl> and <mtpl></mtpl> are the <a href="canonical_coordinates" title="wikilink">canonical coordinates</a> (generalized momenta and generalized coordinates) of the system's internal degrees of freedom. The expression for the grand canonical ensemble is somewhat more delicate than the <a href="canonical_ensemble" title="wikilink">canonical ensemble</a> since:<a class="footnoteRef" href="#fn21" id="fnref21"><sup>21</sup></a></p>
<ul>
<li>The number of particles and thus the number of coordinates 

<math display="inline" id="Grand_canonical_ensemble:64">
 <semantics>
  <mi>n</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>n</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n
  </annotation>
 </semantics>
</math>

 varies between the different phase spaces, and,</li>
<li>it is vital to consider whether permuting similar particles counts as a distinct state or not.</li>
</ul>

<p>In a system of particles, the number of degrees of freedom 

<math display="inline" id="Grand_canonical_ensemble:65">
 <semantics>
  <mi>n</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>n</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n
  </annotation>
 </semantics>
</math>

 depends on the number of particles in a way that depends on the physical situation. For example, in a three-dimensional gas of monoatoms 

<math display="inline" id="Grand_canonical_ensemble:66">
 <semantics>
  <mrow>
   <mi>n</mi>
   <mo>=</mo>
   <mrow>
    <mn>3</mn>
    <mi>N</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>n</ci>
    <apply>
     <times></times>
     <cn type="integer">3</cn>
     <ci>N</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n=3N
  </annotation>
 </semantics>
</math>

, however in molecular gases there will also be rotational and vibrational degrees of freedom.</p>

<p>The probability density function for the grand canonical ensemble is:</p>

<p>

<math display="block" id="Grand_canonical_ensemble:67">
 <semantics>
  <mrow>
   <mrow>
    <mi>ρ</mi>
    <mo>=</mo>
    <mrow>
     <mfrac>
      <mn>1</mn>
      <mrow>
       <msup>
        <mi>h</mi>
        <mi>n</mi>
       </msup>
       <mi>C</mi>
      </mrow>
     </mfrac>
     <msup>
      <mi>e</mi>
      <mfrac>
       <mrow>
        <mrow>
         <mi mathvariant="normal">Ω</mi>
         <mo>+</mo>
         <mrow>
          <msub>
           <mi>μ</mi>
           <mn>1</mn>
          </msub>
          <msub>
           <mi>N</mi>
           <mn>1</mn>
          </msub>
         </mrow>
         <mo>+</mo>
         <mi mathvariant="normal">…</mi>
         <mo>+</mo>
         <mrow>
          <msub>
           <mi>μ</mi>
           <mi>s</mi>
          </msub>
          <msub>
           <mi>N</mi>
           <mi>s</mi>
          </msub>
         </mrow>
        </mrow>
        <mo>-</mo>
        <mi>E</mi>
       </mrow>
       <mrow>
        <mi>k</mi>
        <mi>T</mi>
       </mrow>
      </mfrac>
     </msup>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>ρ</ci>
    <apply>
     <times></times>
     <apply>
      <divide></divide>
      <cn type="integer">1</cn>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>h</ci>
        <ci>n</ci>
       </apply>
       <ci>C</ci>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>e</ci>
      <apply>
       <divide></divide>
       <apply>
        <minus></minus>
        <apply>
         <plus></plus>
         <ci>normal-Ω</ci>
         <apply>
          <times></times>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>μ</ci>
           <cn type="integer">1</cn>
          </apply>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>N</ci>
           <cn type="integer">1</cn>
          </apply>
         </apply>
         <ci>normal-…</ci>
         <apply>
          <times></times>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>μ</ci>
           <ci>s</ci>
          </apply>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>N</ci>
           <ci>s</ci>
          </apply>
         </apply>
        </apply>
        <ci>E</ci>
       </apply>
       <apply>
        <times></times>
        <ci>k</ci>
        <ci>T</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \rho=\frac{1}{h^{n}C}e^{\frac{\Omega+\mu_{1}N_{1}+\ldots+\mu_{s}N_{s}-E}{kT}},
  </annotation>
 </semantics>
</math>

 where</p>
<ul>
<li>

<math display="inline" id="Grand_canonical_ensemble:68">
 <semantics>
  <mi>E</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>E</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   E
  </annotation>
 </semantics>
</math>

 is the energy of the system, a function of the phase <mtpl></mtpl>,</li>
<li>

<math display="inline" id="Grand_canonical_ensemble:69">
 <semantics>
  <mi>h</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>h</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   h
  </annotation>
 </semantics>
</math>

 is an arbitrary but predetermined constant with the units of 

<math display="inline" id="Grand_canonical_ensemble:70">
 <semantics>
  <mrow>
   <mi>e</mi>
   <mi>n</mi>
   <mi>e</mi>
   <mi>r</mi>
   <mi>g</mi>
   <mi>y</mi>
   <mi mathvariant="normal">×</mi>
   <mi>t</mi>
   <mi>i</mi>
   <mi>m</mi>
   <mi>e</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>e</ci>
    <ci>n</ci>
    <ci>e</ci>
    <ci>r</ci>
    <ci>g</ci>
    <ci>y</ci>
    <ci>normal-×</ci>
    <ci>t</ci>
    <ci>i</ci>
    <ci>m</ci>
    <ci>e</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   energy×time
  </annotation>
 </semantics>
</math>

, setting the extent of one microstate and providing correct dimensions to 

<math display="inline" id="Grand_canonical_ensemble:71">
 <semantics>
  <mi>ρ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>ρ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   ρ
  </annotation>
 </semantics>
</math>

.<a class="footnoteRef" href="#fn22" id="fnref22"><sup>22</sup></a></li>
<li>

<math display="inline" id="Grand_canonical_ensemble:72">
 <semantics>
  <mi>C</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>C</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   C
  </annotation>
 </semantics>
</math>

 is an overcounting correction factor (see below), a function of <mtpl></mtpl>.</li>
</ul>

<p>Again, the value of 

<math display="inline" id="Grand_canonical_ensemble:73">
 <semantics>
  <mi mathvariant="normal">Ω</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>normal-Ω</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Ω
  </annotation>
 </semantics>
</math>

 is determined by demanding that 

<math display="inline" id="Grand_canonical_ensemble:74">
 <semantics>
  <mi>ρ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>ρ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   ρ
  </annotation>
 </semantics>
</math>

 is a normalized probability density function:</p>

<p>

<math display="block" id="Grand_canonical_ensemble:75">
 <semantics>
  <mrow>
   <msup>
    <mi>e</mi>
    <mrow>
     <mo>-</mo>
     <mfrac>
      <mi mathvariant="normal">Ω</mi>
      <mrow>
       <mi>k</mi>
       <mi>T</mi>
      </mrow>
     </mfrac>
    </mrow>
   </msup>
   <mo>=</mo>
   <mrow>
    <munderover>
     <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
     <mrow>
      <msub>
       <mi>N</mi>
       <mn>1</mn>
      </msub>
      <mo>=</mo>
      <mn>0</mn>
     </mrow>
     <mi mathvariant="normal">∞</mi>
    </munderover>
    <mrow>
     <mi mathvariant="normal">…</mi>
     <mrow>
      <munderover>
       <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
       <mrow>
        <msub>
         <mi>N</mi>
         <mi>s</mi>
        </msub>
        <mo>=</mo>
        <mn>0</mn>
       </mrow>
       <mi mathvariant="normal">∞</mi>
      </munderover>
      <mrow>
       <mo largeop="true" symmetric="true">∫</mo>
       <mrow>
        <mi mathvariant="normal">…</mi>
        <mrow>
         <mo largeop="true" symmetric="true">∫</mo>
         <mrow>
          <mfrac>
           <mn>1</mn>
           <mrow>
            <msup>
             <mi>h</mi>
             <mi>n</mi>
            </msup>
            <mi>C</mi>
           </mrow>
          </mfrac>
          <mpadded width="+1.7pt">
           <msup>
            <mi>e</mi>
            <mfrac>
             <mrow>
              <mrow>
               <mrow>
                <msub>
                 <mi>μ</mi>
                 <mn>1</mn>
                </msub>
                <msub>
                 <mi>N</mi>
                 <mn>1</mn>
                </msub>
               </mrow>
               <mo>+</mo>
               <mi mathvariant="normal">…</mi>
               <mo>+</mo>
               <mrow>
                <msub>
                 <mi>μ</mi>
                 <mi>s</mi>
                </msub>
                <msub>
                 <mi>N</mi>
                 <mi>s</mi>
                </msub>
               </mrow>
              </mrow>
              <mo>-</mo>
              <mi>E</mi>
             </mrow>
             <mrow>
              <mi>k</mi>
              <mi>T</mi>
             </mrow>
            </mfrac>
           </msup>
          </mpadded>
          <mi>d</mi>
          <msub>
           <mi>p</mi>
           <mn>1</mn>
          </msub>
          <mi mathvariant="normal">…</mi>
          <mi>d</mi>
          <msub>
           <mi>q</mi>
           <mi>n</mi>
          </msub>
         </mrow>
        </mrow>
       </mrow>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>e</ci>
     <apply>
      <minus></minus>
      <apply>
       <divide></divide>
       <ci>normal-Ω</ci>
       <apply>
        <times></times>
        <ci>k</ci>
        <ci>T</ci>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <apply>
        <eq></eq>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>N</ci>
         <cn type="integer">1</cn>
        </apply>
        <cn type="integer">0</cn>
       </apply>
      </apply>
      <infinity></infinity>
     </apply>
     <apply>
      <times></times>
      <ci>normal-…</ci>
      <apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <sum></sum>
         <apply>
          <eq></eq>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>N</ci>
           <ci>s</ci>
          </apply>
          <cn type="integer">0</cn>
         </apply>
        </apply>
        <infinity></infinity>
       </apply>
       <apply>
        <int></int>
        <apply>
         <times></times>
         <ci>normal-…</ci>
         <apply>
          <int></int>
          <apply>
           <times></times>
           <apply>
            <divide></divide>
            <cn type="integer">1</cn>
            <apply>
             <times></times>
             <apply>
              <csymbol cd="ambiguous">superscript</csymbol>
              <ci>h</ci>
              <ci>n</ci>
             </apply>
             <ci>C</ci>
            </apply>
           </apply>
           <apply>
            <csymbol cd="ambiguous">superscript</csymbol>
            <ci>e</ci>
            <apply>
             <divide></divide>
             <apply>
              <minus></minus>
              <apply>
               <plus></plus>
               <apply>
                <times></times>
                <apply>
                 <csymbol cd="ambiguous">subscript</csymbol>
                 <ci>μ</ci>
                 <cn type="integer">1</cn>
                </apply>
                <apply>
                 <csymbol cd="ambiguous">subscript</csymbol>
                 <ci>N</ci>
                 <cn type="integer">1</cn>
                </apply>
               </apply>
               <ci>normal-…</ci>
               <apply>
                <times></times>
                <apply>
                 <csymbol cd="ambiguous">subscript</csymbol>
                 <ci>μ</ci>
                 <ci>s</ci>
                </apply>
                <apply>
                 <csymbol cd="ambiguous">subscript</csymbol>
                 <ci>N</ci>
                 <ci>s</ci>
                </apply>
               </apply>
              </apply>
              <ci>E</ci>
             </apply>
             <apply>
              <times></times>
              <ci>k</ci>
              <ci>T</ci>
             </apply>
            </apply>
           </apply>
           <ci>d</ci>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <ci>p</ci>
            <cn type="integer">1</cn>
           </apply>
           <ci>normal-…</ci>
           <ci>d</ci>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <ci>q</ci>
            <ci>n</ci>
           </apply>
          </apply>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   e^{-\frac{\Omega}{kT}}=\sum_{N_{1}=0}^{\infty}\ldots\sum_{N_{s}=0}^{\infty}%
\int\ldots\int\frac{1}{h^{n}C}e^{\frac{\mu_{1}N_{1}+\ldots+\mu_{s}N_{s}-E}{kT}%
}\,dp_{1}\ldots dq_{n}
  </annotation>
 </semantics>
</math>

 This integral is taken over the entire available <a href="phase_space" title="wikilink">phase space</a> for the given numbers of particles.</p>
<h4 id="overcounting-correction">Overcounting correction</h4>

<p>A well-known problem in the statistical mechanics of fluids (gases, liquids, plasmas) is how to treat particles that are similar or identical in nature: should they be regarded as distinguishable or not? In the system's equation of motion each particle is forever tracked as a distinguishable entity, and yet there are also valid states of the system where the positions of each particle have simply been swapped: these states are represented at different places in phase space, yet would seem to be equivalent.</p>

<p>If the permutations of similar particles are regarded to count as distinct states, then the factor 

<math display="inline" id="Grand_canonical_ensemble:76">
 <semantics>
  <mi>C</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>C</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   C
  </annotation>
 </semantics>
</math>

 above is simply 

<math display="inline" id="Grand_canonical_ensemble:77">
 <semantics>
  <mrow>
   <mi>C</mi>
   <mo>=</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>C</ci>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   C=1
  </annotation>
 </semantics>
</math>

. From this point of view, ensembles include every permuted state as a separate microstate. Although appearing benign at first, this leads to a problem of severely non-extensive entropy in the canonical ensemble, known today as the <a href="Gibbs_paradox" title="wikilink">Gibbs paradox</a>. In the grand canonical ensemble a further logical inconsistency occurs: the number of distinguishable permutations depends not only on how many particles are in the system, but also on how many particles are in the reservoir (since the system may exchange particles with a reservoir). In this case the entropy and chemical potential are non-extensive but also badly defined, depending on a parameter (reservoir size) that should be irrelevant.</p>

<p>To solve these issues it is necessary that the exchange of two similar particles (within the system, or between the system and reservoir) must not be regarded as giving a distinct state of the system.<a class="footnoteRef" href="#fn23" id="fnref23"><sup>23</sup></a><a class="footnoteRef" href="#fn24" id="fnref24"><sup>24</sup></a> In order to incorporate this fact, integrals are still carried over full phase space but the result is divided by</p>

<p>

<math display="block" id="Grand_canonical_ensemble:78">
 <semantics>
  <mrow>
   <mrow>
    <mi>C</mi>
    <mo>=</mo>
    <mrow>
     <mrow>
      <msub>
       <mi>N</mi>
       <mn>1</mn>
      </msub>
      <mo lspace="0pt" rspace="3.5pt">!</mo>
     </mrow>
     <mrow>
      <msub>
       <mi>N</mi>
       <mn>2</mn>
      </msub>
      <mo lspace="0pt" rspace="3.5pt">!</mo>
     </mrow>
     <mi mathvariant="normal">…</mi>
     <mrow>
      <msub>
       <mi>N</mi>
       <mi>s</mi>
      </msub>
      <mo lspace="0pt" rspace="3.5pt">!</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>C</ci>
    <apply>
     <times></times>
     <apply>
      <factorial></factorial>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>N</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <apply>
      <factorial></factorial>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>N</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
     <ci>normal-…</ci>
     <apply>
      <factorial></factorial>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>N</ci>
       <ci>s</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   C=N_{1}!N_{2}!\ldots N_{s}!,
  </annotation>
 </semantics>
</math>

 which is the number of different permutations possible. The division by 

<math display="inline" id="Grand_canonical_ensemble:79">
 <semantics>
  <mi>C</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>C</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   C
  </annotation>
 </semantics>
</math>

 neatly corrects the overcounting that occurs in the integral over all phase space.</p>

<p>It is of course possible to include distinguishable <em>types</em> of particles in the grand canonical ensemble—each distinguishable type 

<math display="inline" id="Grand_canonical_ensemble:80">
 <semantics>
  <mi>i</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>i</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   i
  </annotation>
 </semantics>
</math>

 is tracked by a separate particle counter 

<math display="inline" id="Grand_canonical_ensemble:81">
 <semantics>
  <msub>
   <mi>N</mi>
   <mi>i</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>N</ci>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   N_{i}
  </annotation>
 </semantics>
</math>

 and chemical potential 

<math display="inline" id="Grand_canonical_ensemble:82">
 <semantics>
  <msub>
   <mi>μ</mi>
   <mi>i</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>μ</ci>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mu_{i}
  </annotation>
 </semantics>
</math>

. As a result, the only consistent way to include "fully distinguishable" particles in the grand canonical ensemble is to consider every possible distinguishable type of those particles, and to track each and every possible type with a separate particle counter and separate chemical potential.</p>
<h2 id="shortcoming">Shortcoming</h2>

<p>Grand canonical ensemble has a fictitious surface at the boundaries of the volume. This surface is a surface of the surrounding hard body and is inherited from the <a href="canonical_ensemble" title="wikilink">canonical ensemble</a>. Therefore, strictly speaking, GCE should be called the <em>' 

<math display="inline" id="Grand_canonical_ensemble:83">
 <semantics>
  <mrow>
   <mi mathvariant="normal">µ</mi>
   <mi>V</mi>
   <mi>A</mi>
   <mi>T</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>normal-µ</ci>
    <ci>V</ci>
    <ci>A</ci>
    <ci>T</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   µVAT
  </annotation>
 </semantics>
</math>

</em>' ensemble, where <em>A</em> is the area of the surrounding surface. This disadvantage is overcome in the <a href="open_statistical_ensemble" title="wikilink">open statistical ensemble</a>.</p>
<h2 id="notes">Notes</h2>
<h2 id="references">References</h2>

<p>"</p>

<p><a href="Category:Statistical_ensembles" title="wikilink">Category:Statistical ensembles</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1"><a href="#fnref1">↩</a></li>
<li id="fn2"><a href="#fnref2">↩</a></li>
<li id="fn3"></li>
<li id="fn4">To quote Reif, "For purposes of calculating mean values of physical quantities, it makes no noticeable difference whether a macroscopic system is isolated, or in contact with a reservoir with which it can only exchange energy, or in contact with a reservoir with which it can exchange both energy and particles. [...] In some problems where the constraint of a fixed number of particles is cumbersome, one can thus readily circumvent the complication by approximating the actual situation with [...] the grand canonical distribution."<a href="#fnref4">↩</a></li>
<li id="fn5"><a href="#fnref5">↩</a></li>
<li id="fn6"></li>
<li id="fn7"><a class="uri" href="http://www.theory.physics.manchester.ac.uk/~judith/stat_therm/node87.html">http://www.theory.physics.manchester.ac.uk/~judith/stat_therm/node87.html</a><a href="#fnref7">↩</a></li>
<li id="fn8"></li>
<li id="fn9"><a class="uri" href="https://math.temple.edu/~prisebor/statisticalmechanics.pdf">https://math.temple.edu/~prisebor/statisticalmechanics.pdf</a><a href="#fnref9">↩</a></li>
<li id="fn10"><a class="uri" href="http://micro.stanford.edu/~caiwei/me334/Chap9_NPT_Grand_Canonical_Ensemble_v04.pdf">http://micro.stanford.edu/~caiwei/me334/Chap9_NPT_Grand_Canonical_Ensemble_v04.pdf</a><a href="#fnref10">↩</a></li>
<li id="fn11"></li>
<li id="fn12"><a href="#fnref12">↩</a></li>
<li id="fn13"></li>
<li id="fn14"><a href="#fnref14">↩</a></li>
<li id="fn15"><a href="#fnref15">↩</a></li>
<li id="fn16"></li>
<li id="fn17"><a class="uri" href="http://www.iue.tuwien.ac.at/phd/wittmann/node7.html">http://www.iue.tuwien.ac.at/phd/wittmann/node7.html</a><a href="#fnref17">↩</a></li>
<li id="fn18"><a href="#fnref18">↩</a></li>
<li id="fn19"><a class="uri" href="http://arxiv.org/abs/hep-th/9604039v1">http://arxiv.org/abs/hep-th/9604039v1</a><a href="#fnref19">↩</a></li>
<li id="fn20">Of course, very high temperatures are required for significant thermal generation of particle-antiparticle pairs, e.g., of order 10<sup>9</sup> K for electron-positron creation, and so this process is not a concern for everyday thermodynamics.<a href="#fnref20">↩</a></li>
<li id="fn21"></li>
<li id="fn22">(Historical note) Gibbs' original ensemble effectively set 

<math display="inline" id="Grand_canonical_ensemble:84">
 <semantics>
  <mrow>
   <mi>h</mi>
   <mo>=</mo>
   <mrow>
    <mn>1</mn>
    <mi>e</mi>
    <mi>n</mi>
    <mi>e</mi>
    <mi>r</mi>
    <mi>g</mi>
    <mi>y</mi>
    <mi>u</mi>
    <mi>n</mi>
    <mi>i</mi>
    <mi>t</mi>
    <mi>t</mi>
    <mi mathvariant="normal">×</mi>
    <mi mathvariant="normal">×</mi>
    <mi>t</mi>
    <mi>i</mi>
    <mi>m</mi>
    <mi>e</mi>
    <mi>u</mi>
    <mi>n</mi>
    <mi>i</mi>
    <mi>t</mi>
    <mi>t</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>h</ci>
    <apply>
     <times></times>
     <cn type="integer">1</cn>
     <ci>e</ci>
     <ci>n</ci>
     <ci>e</ci>
     <ci>r</ci>
     <ci>g</ci>
     <ci>y</ci>
     <ci>u</ci>
     <ci>n</ci>
     <ci>i</ci>
     <ci>t</ci>
     <ci>t</ci>
     <ci>normal-×</ci>
     <ci>normal-×</ci>
     <ci>t</ci>
     <ci>i</ci>
     <ci>m</ci>
     <ci>e</ci>
     <ci>u</ci>
     <ci>n</ci>
     <ci>i</ci>
     <ci>t</ci>
     <ci>t</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   h=1energyunitt××timeunitt
  </annotation>
 </semantics>
</math>

, leading to unit-dependence in the values of some thermodynamic quantities like entropy and chemical potential. Since the advent of quantum mechanics, 

<math display="inline" id="Grand_canonical_ensemble:85">
 <semantics>
  <mi>h</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>h</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   h
  </annotation>
 </semantics>
</math>

 is often taken to be equal to <a href="Planck's_constant" title="wikilink">Planck's constant</a> in order to obtain a semiclassical correspondence with quantum mechanics.<a href="#fnref22">↩</a></li>
<li id="fn23"></li>
<li id="fn24">This can be compared to the <a href="canonical_ensemble" title="wikilink">canonical ensemble</a> where it is optional to consider particles as distinguishable; this only gives 

<math display="inline" id="Grand_canonical_ensemble:86">
 <semantics>
  <mi>N</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>N</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   N
  </annotation>
 </semantics>
</math>

-dependent error in entropy, which is unobservable as long as 

<math display="inline" id="Grand_canonical_ensemble:87">
 <semantics>
  <mi>N</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>N</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   N
  </annotation>
 </semantics>
</math>

 is kept constant. In general, however, there is no such freedom: "when the number of particles in a system is to be treated as variable, the average index of probability for phases generically defined corresponds to entropy." (Gibbs).<a href="#fnref24">↩</a></li>
</ol>
</section>
</body>
</html>

<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="14">M-tree</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>M-tree</h1>
<hr/>

<p><strong>M-trees</strong> are <a href="tree_data_structure" title="wikilink">tree data structures</a> that are similar to <a href="R-tree" title="wikilink">R-trees</a> and <a href="B-tree" title="wikilink">B-trees</a>. It is constructed using a <a href="Metric_(mathematics)" title="wikilink">metric</a> and relies on the <a href="triangle_inequality" title="wikilink">triangle inequality</a> for efficient range and <a href="k-nearest_neighbor_algorithm" title="wikilink">k-NN</a> queries. While M-trees can perform well in many conditions, the tree can also have large overlap and there is no clear strategy on how to best avoid overlap. In addition, it can only be used for <a href="distance_function" title="wikilink">distance functions</a> that satisfy the triangle inequality, while many advanced dissimilarity functions used in <a href="information_retrieval" title="wikilink">information retrieval</a> do not satisfy this.<a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a></p>
<h2 id="overview">Overview</h2>
<figure><b>(Figure)</b>
<figcaption>2D M-Tree visualized using <a href="Environment_for_DeveLoping_KDD-Applications_Supported_by_Index-Structures" title="wikilink">ELKI</a>. Due to the axis scales, the spheres appear ellipsoidal. Every blue sphere (leaf) is contained in a red sphere (directory nodes). Leaves overlap, but not too much.</figcaption>
</figure>

<p>As in any Tree-based data structure, the M-Tree is composed of Nodes and Leaves. In each node there is a data object that identifies it uniquely and a pointer to a sub-tree where its children reside. Every leaf has several data objects. For each node there is a radius 

<math display="inline" id="M-tree:0">
 <semantics>
  <mi>r</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>r</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   r
  </annotation>
 </semantics>
</math>

 that defines a Ball in the desired metric space. Thus, every node 

<math display="inline" id="M-tree:1">
 <semantics>
  <mi>n</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>n</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n
  </annotation>
 </semantics>
</math>

 and leaf 

<math display="inline" id="M-tree:2">
 <semantics>
  <mi>l</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>l</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   l
  </annotation>
 </semantics>
</math>

 residing in a particular node 

<math display="inline" id="M-tree:3">
 <semantics>
  <mi>N</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>N</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   N
  </annotation>
 </semantics>
</math>

 is at most distance 

<math display="inline" id="M-tree:4">
 <semantics>
  <mi>r</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>r</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   r
  </annotation>
 </semantics>
</math>

 from 

<math display="inline" id="M-tree:5">
 <semantics>
  <mi>N</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>N</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   N
  </annotation>
 </semantics>
</math>

, and every node 

<math display="inline" id="M-tree:6">
 <semantics>
  <mi>n</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>n</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n
  </annotation>
 </semantics>
</math>

 and leaf 

<math display="inline" id="M-tree:7">
 <semantics>
  <mi>l</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>l</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   l
  </annotation>
 </semantics>
</math>

 with node parent 

<math display="inline" id="M-tree:8">
 <semantics>
  <mi>N</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>N</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   N
  </annotation>
 </semantics>
</math>

 keep the distance from it.</p>
<h2 id="m-tree-construction">M-Tree construction</h2>
<h3 id="components">Components</h3>

<p>An M-Tree has these components and sub-components:</p>
<ol>
<li>Non-leaf nodes
<ol>
<li>A set of routing objects N<sub><em>RO</em></sub>.</li>
<li>Pointer to Node's parent object O<sub><em>p</em></sub>.</li>
</ol></li>
<li>Leaf nodes
<ol>
<li>A set of objects N<sub><em>O</em></sub>.</li>
<li>Pointer to Node's parent object O<sub><em>p</em></sub>.</li>
</ol></li>
<li>Routing Object
<ol>
<li>(Feature value of) routing object O<sub><em>r</em></sub>.</li>
<li>Covering radius r(O<sub><em>r</em></sub>).</li>
<li>Pointer to covering tree T(O<sub><em>r</em></sub>).</li>
<li>Distance of O<sub><em>r</em></sub> from its parent object d(O<sub><em>r</em></sub>,P(O<sub><em>r</em></sub>))</li>
</ol></li>
<li>Object
<ol>
<li>(Feature value of the) object O<sub><em>j</em></sub>.</li>
<li>Object identifier oid(O<sub><em>j</em></sub>).</li>
<li>Distance of O<sub><em>j</em></sub> from its parent object d(O<sub><em>j</em></sub>,P(O<sub><em>j</em></sub>))</li>
</ol></li>
</ol>
<h3 id="insert">Insert</h3>

<p>The main idea is first to find a leaf node 

<math display="inline" id="M-tree:9">
 <semantics>
  <mi>N</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>N</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   N
  </annotation>
 </semantics>
</math>

 where the new object 

<math display="inline" id="M-tree:10">
 <semantics>
  <mi>O</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>O</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   O
  </annotation>
 </semantics>
</math>

 belongs. If 

<math display="inline" id="M-tree:11">
 <semantics>
  <mi>N</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>N</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   N
  </annotation>
 </semantics>
</math>

 is not full then just attach it to 

<math display="inline" id="M-tree:12">
 <semantics>
  <mi>N</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>N</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   N
  </annotation>
 </semantics>
</math>

. If 

<math display="inline" id="M-tree:13">
 <semantics>
  <mi>N</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>N</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   N
  </annotation>
 </semantics>
</math>

 is full then invoke a method to split 

<math display="inline" id="M-tree:14">
 <semantics>
  <mi>N</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>N</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   N
  </annotation>
 </semantics>
</math>

. The algorithm is as follows:</p>

<p><code>  Input: Node </code>

<math display="inline" id="M-tree:15">
 <semantics>
  <mi>N</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>N</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   N
  </annotation>
 </semantics>
</math>

<code>  of M-Tree </code>

<math display="inline" id="M-tree:16">
 <semantics>
  <mrow>
   <mi>M</mi>
   <mi>T</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>M</ci>
    <ci>T</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   MT
  </annotation>
 </semantics>
</math>

<code>, Entry </code>

<math display="inline" id="M-tree:17">
 <semantics>
  <msub>
   <mi>O</mi>
   <mi>n</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>O</ci>
    <ci>n</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   O_{n}
  </annotation>
 </semantics>
</math>

<br/>
<code>  Output: A new instance of </code>

<math display="inline" id="M-tree:18">
 <semantics>
  <mrow>
   <mi>M</mi>
   <mi>T</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>M</ci>
    <ci>T</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   MT
  </annotation>
 </semantics>
</math>

<code> containing all entries in original </code>

<math display="inline" id="M-tree:19">
 <semantics>
  <mrow>
   <mi>M</mi>
   <mi>T</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>M</ci>
    <ci>T</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   MT
  </annotation>
 </semantics>
</math>

<code> plus </code>

<math display="inline" id="M-tree:20">
 <semantics>
  <msub>
   <mi>O</mi>
   <mi>n</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>O</ci>
    <ci>n</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   O_{n}
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="inline" id="M-tree:21">
 <semantics>
  <msub>
   <mi>N</mi>
   <mi>e</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>N</ci>
    <ci>e</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   N_{e}
  </annotation>
 </semantics>
</math>

 ← 

<math display="inline" id="M-tree:22">
 <semantics>
  <mi>N</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>N</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   N
  </annotation>
 </semantics>
</math>

's routing objects or objects</p>

<p><code>  </code><strong><code>if</code></strong><code> </code>

<math display="inline" id="M-tree:23">
 <semantics>
  <mi>N</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>N</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   N
  </annotation>
 </semantics>
</math>

<code> is not a leaf </code><strong><code>then</code></strong><br/>
<code>  {</code><br/>
<code>       /*Look for entries that the new object fits into*/</code><br/>
<code>       let </code>

<math display="inline" id="M-tree:24">
 <semantics>
  <msub>
   <mi>N</mi>
   <mrow>
    <mi>i</mi>
    <mi>n</mi>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>N</ci>
    <apply>
     <times></times>
     <ci>i</ci>
     <ci>n</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   N_{in}
  </annotation>
 </semantics>
</math>

<code> be routing objects from </code>

<math display="inline" id="M-tree:25">
 <semantics>
  <msub>
   <mi>N</mi>
   <mi>e</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>N</ci>
    <ci>e</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   N_{e}
  </annotation>
 </semantics>
</math>

<code>'s set of routing objects </code>

<math display="inline" id="M-tree:26">
 <semantics>
  <msub>
   <mi>N</mi>
   <mrow>
    <mi>R</mi>
    <mi>O</mi>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>N</ci>
    <apply>
     <times></times>
     <ci>R</ci>
     <ci>O</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   N_{RO}
  </annotation>
 </semantics>
</math>

<code> such that </code>

<math display="inline" id="M-tree:27">
 <semantics>
  <mrow>
   <mrow>
    <mi>d</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <msub>
      <mi>O</mi>
      <mi>r</mi>
     </msub>
     <mo>,</mo>
     <msub>
      <mi>O</mi>
      <mi>n</mi>
     </msub>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>≤</mo>
   <mrow>
    <mi>r</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <msub>
      <mi>O</mi>
      <mi>r</mi>
     </msub>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <leq></leq>
    <apply>
     <times></times>
     <ci>d</ci>
     <interval closure="open">
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>O</ci>
       <ci>r</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>O</ci>
       <ci>n</ci>
      </apply>
     </interval>
    </apply>
    <apply>
     <times></times>
     <ci>r</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>O</ci>
      <ci>r</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   d(O_{r},O_{n})<=r(O_{r})
  </annotation>
 </semantics>
</math>

<br/>
<code>       </code><strong><code>if</code></strong><code> </code>

<math display="inline" id="M-tree:28">
 <semantics>
  <msub>
   <mi>N</mi>
   <mrow>
    <mi>i</mi>
    <mi>n</mi>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>N</ci>
    <apply>
     <times></times>
     <ci>i</ci>
     <ci>n</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   N_{in}
  </annotation>
 </semantics>
</math>

<code> is not empty </code><strong><code>then</code></strong><br/>
<code>       {</code><br/>
<code>          /*If there are one or more entry, then look for an entry such that is closer to the new object*/</code><br/>
<code>          </code>

<math display="inline" id="M-tree:29">
 <semantics>
  <mrow>
   <msubsup>
    <mi>O</mi>
    <mi>r</mi>
    <mo>*</mo>
   </msubsup>
   <mo>=</mo>
   <mrow>
    <mrow>
     <msub>
      <mi>min</mi>
      <mrow>
       <msub>
        <mi>O</mi>
        <mi>r</mi>
       </msub>
       <mo>∈</mo>
       <msub>
        <mi>N</mi>
        <mrow>
         <mi>i</mi>
         <mi>n</mi>
        </mrow>
       </msub>
      </mrow>
     </msub>
     <mi>d</mi>
    </mrow>
    <mrow>
     <mo stretchy="false">(</mo>
     <msub>
      <mi>O</mi>
      <mi>r</mi>
     </msub>
     <mo>,</mo>
     <msub>
      <mi>O</mi>
      <mi>n</mi>
     </msub>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>O</ci>
      <ci>r</ci>
     </apply>
     <times></times>
    </apply>
    <apply>
     <times></times>
     <apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <min></min>
       <apply>
        <in></in>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>O</ci>
         <ci>r</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>N</ci>
         <apply>
          <times></times>
          <ci>i</ci>
          <ci>n</ci>
         </apply>
        </apply>
       </apply>
      </apply>
      <ci>d</ci>
     </apply>
     <interval closure="open">
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>O</ci>
       <ci>r</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>O</ci>
       <ci>n</ci>
      </apply>
     </interval>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   O_{r}^{*}=\min_{O_{r}\in N_{in}}d(O_{r},O_{n})
  </annotation>
 </semantics>
</math>

<br/>
<code>       }</code><br/>
<code>       </code><strong><code>else</code></strong><br/>
<code>       {</code><br/>
<code>          /*If there are no such entry, then look for an object with minimal distance from */ </code><br/>
<code>          /*its covering radius's edge to the new object*/</code><br/>
<code>          </code>

<math display="inline" id="M-tree:30">
 <semantics>
  <mrow>
   <msubsup>
    <mi>O</mi>
    <mi>r</mi>
    <mo>*</mo>
   </msubsup>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mrow>
      <msub>
       <mi>min</mi>
       <mrow>
        <msub>
         <mi>O</mi>
         <mi>r</mi>
        </msub>
        <mo>∈</mo>
        <msub>
         <mi>N</mi>
         <mrow>
          <mi>i</mi>
          <mi>n</mi>
         </mrow>
        </msub>
       </mrow>
      </msub>
      <mi>d</mi>
     </mrow>
     <mrow>
      <mo stretchy="false">(</mo>
      <msub>
       <mi>O</mi>
       <mi>r</mi>
      </msub>
      <mo>,</mo>
      <msub>
       <mi>O</mi>
       <mi>n</mi>
      </msub>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>-</mo>
    <mrow>
     <mi>r</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <msub>
       <mi>O</mi>
       <mi>r</mi>
      </msub>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>O</ci>
      <ci>r</ci>
     </apply>
     <times></times>
    </apply>
    <apply>
     <minus></minus>
     <apply>
      <times></times>
      <apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <min></min>
        <apply>
         <in></in>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>O</ci>
          <ci>r</ci>
         </apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>N</ci>
          <apply>
           <times></times>
           <ci>i</ci>
           <ci>n</ci>
          </apply>
         </apply>
        </apply>
       </apply>
       <ci>d</ci>
      </apply>
      <interval closure="open">
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>O</ci>
        <ci>r</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>O</ci>
        <ci>n</ci>
       </apply>
      </interval>
     </apply>
     <apply>
      <times></times>
      <ci>r</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>O</ci>
       <ci>r</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   O_{r}^{*}=\min_{O_{r}\in N_{in}}d(O_{r},O_{n})-r(O_{r})
  </annotation>
 </semantics>
</math>

<br/>
<code>          /*Upgrade the new radii of the entry*/</code><br/>
<code>          </code>

<math display="inline" id="M-tree:31">
 <semantics>
  <mrow>
   <mi>r</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msubsup>
     <mi>O</mi>
     <mi>r</mi>
     <mo>*</mo>
    </msubsup>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>r</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>O</ci>
      <ci>r</ci>
     </apply>
     <times></times>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   r(O_{r}^{*})
  </annotation>
 </semantics>
</math>

<code> = </code>

<math display="inline" id="M-tree:32">
 <semantics>
  <mrow>
   <mi>d</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msubsup>
     <mi>O</mi>
     <mi>r</mi>
     <mo>*</mo>
    </msubsup>
    <mo>,</mo>
    <msub>
     <mi>O</mi>
     <mi>n</mi>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>d</ci>
    <interval closure="open">
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>O</ci>
       <ci>r</ci>
      </apply>
      <times></times>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>O</ci>
      <ci>n</ci>
     </apply>
    </interval>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   d(O_{r}^{*},O_{n})
  </annotation>
 </semantics>
</math>

<br/>
<code>       }</code><br/>
<code>       /*Continue inserting in the next level*/</code><br/>
<code>       return insert(</code>

<math display="inline" id="M-tree:33">
 <semantics>
  <mrow>
   <mi>T</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msubsup>
     <mi>O</mi>
     <mi>r</mi>
     <mo>*</mo>
    </msubsup>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>T</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>O</ci>
      <ci>r</ci>
     </apply>
     <times></times>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   T(O_{r}^{*})
  </annotation>
 </semantics>
</math>

<code>, </code>

<math display="inline" id="M-tree:34">
 <semantics>
  <msub>
   <mi>O</mi>
   <mi>n</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>O</ci>
    <ci>n</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   O_{n}
  </annotation>
 </semantics>
</math>

<code>);</code><br/>
<code>  </code><strong><code>else</code></strong><br/>
<code>  {</code><br/>
<code>       /*If the node has capacity then just insert the new object*/</code><br/>
<code>       </code><strong><code>if</code></strong><code> </code>

<math display="inline" id="M-tree:35">
 <semantics>
  <mi>N</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>N</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   N
  </annotation>
 </semantics>
</math>

<code> is not full </code><strong><code>then</code></strong><br/>
<code>       {  store(</code>

<math display="inline" id="M-tree:36">
 <semantics>
  <mi>N</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>N</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   N
  </annotation>
 </semantics>
</math>

<code>, </code>

<math display="inline" id="M-tree:37">
 <semantics>
  <msub>
   <mi>O</mi>
   <mi>n</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>O</ci>
    <ci>n</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   O_{n}
  </annotation>
 </semantics>
</math>

<code>)   }</code><br/>
<code>       /*The node is at full capacity, then it is needed to do a new split in this level*/</code><br/>
<code>       </code><strong><code>else</code></strong><br/>
<code>       {  split(</code>

<math display="inline" id="M-tree:38">
 <semantics>
  <mi>N</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>N</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   N
  </annotation>
 </semantics>
</math>

<code>, </code>

<math display="inline" id="M-tree:39">
 <semantics>
  <msub>
   <mi>O</mi>
   <mi>n</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>O</ci>
    <ci>n</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   O_{n}
  </annotation>
 </semantics>
</math>

<code>) }</code><br/>
<code>  }</code></p>
<h3 id="split">Split</h3>

<p>If the split method arrives to the root of the tree, then it choose two routing objects from 

<math display="inline" id="M-tree:40">
 <semantics>
  <mi>N</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>N</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   N
  </annotation>
 </semantics>
</math>

, and creates two new nodes containing all the objects in original 

<math display="inline" id="M-tree:41">
 <semantics>
  <mi>N</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>N</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   N
  </annotation>
 </semantics>
</math>

, and store them into the new root. If split methods arrives to a node 

<math display="inline" id="M-tree:42">
 <semantics>
  <mi>N</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>N</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   N
  </annotation>
 </semantics>
</math>

 that is not the root of the tree, the method choose two new routing objects from 

<math display="inline" id="M-tree:43">
 <semantics>
  <mi>N</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>N</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   N
  </annotation>
 </semantics>
</math>

, re-arrange every routing object in 

<math display="inline" id="M-tree:44">
 <semantics>
  <mi>N</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>N</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   N
  </annotation>
 </semantics>
</math>

 in two new nodes 

<math display="inline" id="M-tree:45">
 <semantics>
  <msub>
   <mi>N</mi>
   <mn>1</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>N</ci>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   N_{1}
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="M-tree:46">
 <semantics>
  <msub>
   <mi>N</mi>
   <mn>2</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>N</ci>
    <cn type="integer">2</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   N_{2}
  </annotation>
 </semantics>
</math>

, and store these new nodes in the parent node 

<math display="inline" id="M-tree:47">
 <semantics>
  <msub>
   <mi>N</mi>
   <mi>p</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>N</ci>
    <ci>p</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   N_{p}
  </annotation>
 </semantics>
</math>

 of original 

<math display="inline" id="M-tree:48">
 <semantics>
  <mi>N</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>N</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   N
  </annotation>
 </semantics>
</math>

. The split must be repeated if 

<math display="inline" id="M-tree:49">
 <semantics>
  <msub>
   <mi>N</mi>
   <mi>p</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>N</ci>
    <ci>p</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   N_{p}
  </annotation>
 </semantics>
</math>

 has not enough capacity to store 

<math display="inline" id="M-tree:50">
 <semantics>
  <msub>
   <mi>N</mi>
   <mn>2</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>N</ci>
    <cn type="integer">2</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   N_{2}
  </annotation>
 </semantics>
</math>

. The algorithm is as follow:</p>

<p><code>  Input: Node </code>

<math display="inline" id="M-tree:51">
 <semantics>
  <mi>N</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>N</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   N
  </annotation>
 </semantics>
</math>

<code>  of M-Tree </code>

<math display="inline" id="M-tree:52">
 <semantics>
  <mrow>
   <mi>M</mi>
   <mi>T</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>M</ci>
    <ci>T</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   MT
  </annotation>
 </semantics>
</math>

<code>, Entry </code>

<math display="inline" id="M-tree:53">
 <semantics>
  <msub>
   <mi>O</mi>
   <mi>n</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>O</ci>
    <ci>n</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   O_{n}
  </annotation>
 </semantics>
</math>

<br/>
<code>  Output: A new instance of </code>

<math display="inline" id="M-tree:54">
 <semantics>
  <mrow>
   <mi>M</mi>
   <mi>T</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>M</ci>
    <ci>T</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   MT
  </annotation>
 </semantics>
</math>

<code> containing a new partition.</code></p>

<p><code>  /*The new routing objects are now all those in the node plus the new routing object*/</code><br/>
<code>  let be </code>

<math display="inline" id="M-tree:55">
 <semantics>
  <mrow>
   <mi>N</mi>
   <mi>N</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>N</ci>
    <ci>N</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   NN
  </annotation>
 </semantics>
</math>

<code> entries of </code>

<math display="inline" id="M-tree:56">
 <semantics>
  <mrow>
   <mi>N</mi>
   <mo>∪</mo>
   <mi>O</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <union></union>
    <ci>N</ci>
    <ci>O</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   N\cup O
  </annotation>
 </semantics>
</math>

<br/>
<code>  </code><strong><code>if</code></strong><code> </code>

<math display="inline" id="M-tree:57">
 <semantics>
  <mi>N</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>N</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   N
  </annotation>
 </semantics>
</math>

<code> is not the root </code><strong><code>then</code></strong><br/>
<code>  {</code><br/>
<code>     /*Get the parent node and the parent routing object*/</code><br/>
<code>     let </code>

<math display="inline" id="M-tree:58">
 <semantics>
  <msub>
   <mi>O</mi>
   <mi>p</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>O</ci>
    <ci>p</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   O_{p}
  </annotation>
 </semantics>
</math>

<code> be the parent routing object of </code>

<math display="inline" id="M-tree:59">
 <semantics>
  <mi>N</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>N</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   N
  </annotation>
 </semantics>
</math>

<br/>
<code>     let </code>

<math display="inline" id="M-tree:60">
 <semantics>
  <msub>
   <mi>N</mi>
   <mi>p</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>N</ci>
    <ci>p</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   N_{p}
  </annotation>
 </semantics>
</math>

<code> be the parent node of </code>

<math display="inline" id="M-tree:61">
 <semantics>
  <mi>N</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>N</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   N
  </annotation>
 </semantics>
</math>

<br/>
<code>  }</code><br/>
<code>  /*This node will contain part of the objects of the node to be split*/</code><br/>
<code>  Create a new node </code>

<math display="inline" id="M-tree:62">
 <semantics>
  <msup>
   <mi>N</mi>
   <mo>′</mo>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>N</ci>
    <ci>normal-′</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   N^{\prime}
  </annotation>
 </semantics>
</math>

<br/>
<code>  /*Promote two routing objects from the node to be split, to be new routing objects*/</code><br/>
<code>  Create new objects </code>

<math display="inline" id="M-tree:63">
 <semantics>
  <msub>
   <mi>O</mi>
   <mrow>
    <mi>p</mi>
    <mn>1</mn>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>O</ci>
    <apply>
     <times></times>
     <ci>p</ci>
     <cn type="integer">1</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   O_{p1}
  </annotation>
 </semantics>
</math>

<code> and </code>

<math display="inline" id="M-tree:64">
 <semantics>
  <msub>
   <mi>O</mi>
   <mrow>
    <mi>p</mi>
    <mn>2</mn>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>O</ci>
    <apply>
     <times></times>
     <ci>p</ci>
     <cn type="integer">2</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   O_{p2}
  </annotation>
 </semantics>
</math>

<code>.</code><br/>
<code>  Promote(</code>

<math display="inline" id="M-tree:65">
 <semantics>
  <mi>N</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>N</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   N
  </annotation>
 </semantics>
</math>

<code>, </code>

<math display="inline" id="M-tree:66">
 <semantics>
  <msub>
   <mi>O</mi>
   <mrow>
    <mi>p</mi>
    <mn>1</mn>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>O</ci>
    <apply>
     <times></times>
     <ci>p</ci>
     <cn type="integer">1</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   O_{p1}
  </annotation>
 </semantics>
</math>

<code>, </code>

<math display="inline" id="M-tree:67">
 <semantics>
  <msub>
   <mi>O</mi>
   <mrow>
    <mi>p</mi>
    <mn>2</mn>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>O</ci>
    <apply>
     <times></times>
     <ci>p</ci>
     <cn type="integer">2</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   O_{p2}
  </annotation>
 </semantics>
</math>

<code>)</code><br/>
<code>  /*Choose which objects from the node being split will act as new routing objects*/</code><br/>
<code>  Partition(</code>

<math display="inline" id="M-tree:68">
 <semantics>
  <mi>N</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>N</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   N
  </annotation>
 </semantics>
</math>

<code>, </code>

<math display="inline" id="M-tree:69">
 <semantics>
  <msub>
   <mi>O</mi>
   <mrow>
    <mi>p</mi>
    <mn>1</mn>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>O</ci>
    <apply>
     <times></times>
     <ci>p</ci>
     <cn type="integer">1</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   O_{p1}
  </annotation>
 </semantics>
</math>

<code>, </code>

<math display="inline" id="M-tree:70">
 <semantics>
  <msub>
   <mi>O</mi>
   <mrow>
    <mi>p</mi>
    <mn>2</mn>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>O</ci>
    <apply>
     <times></times>
     <ci>p</ci>
     <cn type="integer">2</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   O_{p2}
  </annotation>
 </semantics>
</math>

<code>, </code>

<math display="inline" id="M-tree:71">
 <semantics>
  <msub>
   <mi>N</mi>
   <mn>1</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>N</ci>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   N_{1}
  </annotation>
 </semantics>
</math>

<code>, </code>

<math display="inline" id="M-tree:72">
 <semantics>
  <msub>
   <mi>N</mi>
   <mn>2</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>N</ci>
    <cn type="integer">2</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   N_{2}
  </annotation>
 </semantics>
</math>

<code>)</code><br/>
<code>  /*Store entries in each new routing object*/</code><br/>
<code>  Store </code>

<math display="inline" id="M-tree:73">
 <semantics>
  <msub>
   <mi>N</mi>
   <mn>1</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>N</ci>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   N_{1}
  </annotation>
 </semantics>
</math>

<code>'s entries in </code>

<math display="inline" id="M-tree:74">
 <semantics>
  <mi>N</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>N</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   N
  </annotation>
 </semantics>
</math>

<code> and </code>

<math display="inline" id="M-tree:75">
 <semantics>
  <msub>
   <mi>N</mi>
   <mn>2</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>N</ci>
    <cn type="integer">2</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   N_{2}
  </annotation>
 </semantics>
</math>

<code>'s entries in </code>

<math display="inline" id="M-tree:76">
 <semantics>
  <msup>
   <mi>N</mi>
   <mo>′</mo>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>N</ci>
    <ci>normal-′</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   N^{\prime}
  </annotation>
 </semantics>
</math>

<br/>
<code>  </code><strong><code>if</code></strong><code> </code>

<math display="inline" id="M-tree:77">
 <semantics>
  <mi>N</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>N</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   N
  </annotation>
 </semantics>
</math>

<code> is the current root </code><strong><code>then</code></strong><br/>
<code>  {</code><br/>
<code>      /*Create a new node and set it as new root and store the new routing objects*/</code><br/>
<code>      Create a new root node </code>

<math display="inline" id="M-tree:78">
 <semantics>
  <msub>
   <mi>N</mi>
   <mi>p</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>N</ci>
    <ci>p</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   N_{p}
  </annotation>
 </semantics>
</math>

<br/>
<code>      Store </code>

<math display="inline" id="M-tree:79">
 <semantics>
  <msub>
   <mi>O</mi>
   <mrow>
    <mi>p</mi>
    <mn>1</mn>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>O</ci>
    <apply>
     <times></times>
     <ci>p</ci>
     <cn type="integer">1</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   O_{p1}
  </annotation>
 </semantics>
</math>

<code> and </code>

<math display="inline" id="M-tree:80">
 <semantics>
  <msub>
   <mi>O</mi>
   <mrow>
    <mi>p</mi>
    <mn>2</mn>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>O</ci>
    <apply>
     <times></times>
     <ci>p</ci>
     <cn type="integer">2</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   O_{p2}
  </annotation>
 </semantics>
</math>

<code> in </code>

<math display="inline" id="M-tree:81">
 <semantics>
  <msub>
   <mi>N</mi>
   <mi>p</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>N</ci>
    <ci>p</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   N_{p}
  </annotation>
 </semantics>
</math>

<br/>
<code>  }</code><br/>
<code>  </code><strong><code>else</code></strong><br/>
<code>  {</code><br/>
<code>      /*Now use the parent rouing object to store one of the new objects*/</code><br/>
<code>      Replace entry </code>

<math display="inline" id="M-tree:82">
 <semantics>
  <msub>
   <mi>O</mi>
   <mi>p</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>O</ci>
    <ci>p</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   O_{p}
  </annotation>
 </semantics>
</math>

<code> with entry </code>

<math display="inline" id="M-tree:83">
 <semantics>
  <msub>
   <mi>O</mi>
   <mrow>
    <mi>p</mi>
    <mn>1</mn>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>O</ci>
    <apply>
     <times></times>
     <ci>p</ci>
     <cn type="integer">1</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   O_{p1}
  </annotation>
 </semantics>
</math>

<code> in </code>

<math display="inline" id="M-tree:84">
 <semantics>
  <msub>
   <mi>N</mi>
   <mi>p</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>N</ci>
    <ci>p</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   N_{p}
  </annotation>
 </semantics>
</math>

<br/>
<code>      </code><strong><code>if</code></strong><code> </code>

<math display="inline" id="M-tree:85">
 <semantics>
  <msub>
   <mi>N</mi>
   <mi>p</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>N</ci>
    <ci>p</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   N_{p}
  </annotation>
 </semantics>
</math>

<code> is no full </code><strong><code>then</code></strong><br/>
<code>      {</code><br/>
<code>          /*The second routing object is stored in the parent only if it has free capacity*/</code><br/>
<code>          Store </code>

<math display="inline" id="M-tree:86">
 <semantics>
  <msub>
   <mi>O</mi>
   <mrow>
    <mi>p</mi>
    <mn>2</mn>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>O</ci>
    <apply>
     <times></times>
     <ci>p</ci>
     <cn type="integer">2</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   O_{p2}
  </annotation>
 </semantics>
</math>

<code> in </code>

<math display="inline" id="M-tree:87">
 <semantics>
  <msub>
   <mi>N</mi>
   <mi>p</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>N</ci>
    <ci>p</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   N_{p}
  </annotation>
 </semantics>
</math>

<br/>
<code>      }</code><br/>
<code>      </code><strong><code>else</code></strong><br/>
<code>      {</code><br/>
<code>           /*If there is no free capacity then split the level up*/</code><br/>
<code>           split(</code>

<math display="inline" id="M-tree:88">
 <semantics>
  <msub>
   <mi>N</mi>
   <mi>p</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>N</ci>
    <ci>p</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   N_{p}
  </annotation>
 </semantics>
</math>

<code>, </code>

<math display="inline" id="M-tree:89">
 <semantics>
  <msub>
   <mi>O</mi>
   <mrow>
    <mi>p</mi>
    <mn>2</mn>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>O</ci>
    <apply>
     <times></times>
     <ci>p</ci>
     <cn type="integer">2</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   O_{p2}
  </annotation>
 </semantics>
</math>

<code>)</code><br/>
<code>      }</code><br/>
<code>  }</code></p>
<h2 id="m-tree-queries">M-Tree Queries</h2>
<h3 id="range-query">Range Query</h3>

<p>A range query is where a minimum similarity/maximum distance value is speciﬁed. For a given query object Q ∈ D and a maximum search distance r(Q), the range query <strong>range</strong>(Q, r(Q)) selects all the indexed objects Oj such that d(Oj, Q) ≤ r(Q).<a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a></p>

<p>Algorithm RangeSearch starts from the root node and recursively traverses all the paths which cannot be excluded from leading to qualifying objects.  Input: Node 

<math display="inline" id="M-tree:90">
 <semantics>
  <mi>N</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>N</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   N
  </annotation>
 </semantics>
</math>

 of M-Tree <code>MT</code>, 

<math display="inline" id="M-tree:91">
 <semantics>
  <mi>Q</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>Q</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Q
  </annotation>
 </semantics>
</math>

: query object, 

<math display="inline" id="M-tree:92">
 <semantics>
  <mrow>
   <mi>r</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>Q</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>r</ci>
    <ci>Q</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   r(Q)
  </annotation>
 </semantics>
</math>

: search radius</p>

<p>Output: all the DB objects such that 

<math display="inline" id="M-tree:93">
 <semantics>
  <mrow>
   <mrow>
    <mi>d</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>O</mi>
      <mi>j</mi>
     </mrow>
     <mo>,</mo>
     <mi>Q</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>≤</mo>
   <mrow>
    <mi>r</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>Q</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <leq></leq>
    <apply>
     <times></times>
     <ci>d</ci>
     <interval closure="open">
      <apply>
       <times></times>
       <ci>O</ci>
       <ci>j</ci>
      </apply>
      <ci>Q</ci>
     </interval>
    </apply>
    <apply>
     <times></times>
     <ci>r</ci>
     <ci>Q</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   d(Oj,Q)\leq r(Q)
  </annotation>
 </semantics>
</math>

</p>

<p><code>{ </code><br/>
<code>  </code><strong><code>let</code></strong><code> </code>

<math display="inline" id="M-tree:94">
 <semantics>
  <msub>
   <mi>O</mi>
   <mi>p</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>O</ci>
    <ci>p</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   O_{p}
  </annotation>
 </semantics>
</math>

<code> </code><strong><code>be</code></strong><code> the parent object of node </code>

<math display="inline" id="M-tree:95">
 <semantics>
  <mi>N</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>N</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   N
  </annotation>
 </semantics>
</math>

<code>;</code><br/>
<br/>
<code>  </code><strong><code>if</code></strong><code> </code>

<math display="inline" id="M-tree:96">
 <semantics>
  <mi>N</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>N</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   N
  </annotation>
 </semantics>
</math>

<code> </code><strong><code>is</code> <code>not</code></strong><code> a leaf </code><strong><code>then</code></strong><code> { </code><br/>
<code>    </code><strong><code>for</code> <code>each</code></strong><code> </code><u><code>entry</code></u><code>(</code>

<math display="inline" id="M-tree:97">
 <semantics>
  <msub>
   <mi>O</mi>
   <mi>r</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>O</ci>
    <ci>r</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   O_{r}
  </annotation>
 </semantics>
</math>

<code>) </code><strong><code>in</code></strong><code> N </code><strong><code>do</code></strong><code> {</code><br/>
<code>          </code><strong><code>if</code></strong><code> </code>

<math display="inline" id="M-tree:98">
 <semantics>
  <mrow>
   <mrow>
    <mo stretchy="false">|</mo>
    <mrow>
     <mrow>
      <mi>d</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <msub>
        <mi>O</mi>
        <mi>p</mi>
       </msub>
       <mo>,</mo>
       <mi>Q</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo>-</mo>
     <mrow>
      <mi>d</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <msub>
        <mi>O</mi>
        <mi>r</mi>
       </msub>
       <mo>,</mo>
       <msub>
        <mi>O</mi>
        <mi>p</mi>
       </msub>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mrow>
    <mo stretchy="false">|</mo>
   </mrow>
   <mo>≤</mo>
   <mrow>
    <mrow>
     <mi>r</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>Q</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>+</mo>
    <mrow>
     <mi>r</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <msub>
       <mi>O</mi>
       <mi>r</mi>
      </msub>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <leq></leq>
    <apply>
     <abs></abs>
     <apply>
      <minus></minus>
      <apply>
       <times></times>
       <ci>d</ci>
       <interval closure="open">
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>O</ci>
         <ci>p</ci>
        </apply>
        <ci>Q</ci>
       </interval>
      </apply>
      <apply>
       <times></times>
       <ci>d</ci>
       <interval closure="open">
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>O</ci>
         <ci>r</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>O</ci>
         <ci>p</ci>
        </apply>
       </interval>
      </apply>
     </apply>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <ci>r</ci>
      <ci>Q</ci>
     </apply>
     <apply>
      <times></times>
      <ci>r</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>O</ci>
       <ci>r</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   |d(O_{p},Q)-d(O_{r},O_{p})|\leq r(Q)+r(O_{r})
  </annotation>
 </semantics>
</math>

<code> </code><strong><code>then</code></strong><code> { </code><br/>
<code>            Compute </code>

<math display="inline" id="M-tree:99">
 <semantics>
  <mrow>
   <mi>d</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>O</mi>
     <mi>r</mi>
    </msub>
    <mo>,</mo>
    <mi>Q</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>d</ci>
    <interval closure="open">
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>O</ci>
      <ci>r</ci>
     </apply>
     <ci>Q</ci>
    </interval>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   d(O_{r},Q)
  </annotation>
 </semantics>
</math>

<code>;</code><br/>
<code>            </code><strong><code>if</code></strong><code> </code>

<math display="inline" id="M-tree:100">
 <semantics>
  <mrow>
   <mrow>
    <mi>d</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <msub>
      <mi>O</mi>
      <mi>r</mi>
     </msub>
     <mo>,</mo>
     <mi>Q</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>≤</mo>
   <mrow>
    <mrow>
     <mi>r</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>Q</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>+</mo>
    <mrow>
     <mi>r</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <msub>
       <mi>O</mi>
       <mi>r</mi>
      </msub>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <leq></leq>
    <apply>
     <times></times>
     <ci>d</ci>
     <interval closure="open">
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>O</ci>
       <ci>r</ci>
      </apply>
      <ci>Q</ci>
     </interval>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <ci>r</ci>
      <ci>Q</ci>
     </apply>
     <apply>
      <times></times>
      <ci>r</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>O</ci>
       <ci>r</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   d(O_{r},Q)\leq r(Q)+r(O_{r})
  </annotation>
 </semantics>
</math>

<code> </code><strong><code>then</code></strong><br/>
<code>              </code><u><code>RangeSearch</code></u><code>(*ptr(</code>

<math display="inline" id="M-tree:101">
 <semantics>
  <mrow>
   <mi>T</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>O</mi>
     <mi>r</mi>
    </msub>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">T</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>O</ci>
      <ci>r</ci>
     </apply>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   T(O_{r}
  </annotation>
 </semantics>
</math>

<code>)),</code>

<math display="inline" id="M-tree:102">
 <semantics>
  <mi>Q</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>Q</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Q
  </annotation>
 </semantics>
</math>

<code>,</code>

<math display="inline" id="M-tree:103">
 <semantics>
  <mrow>
   <mi>r</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>Q</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>r</ci>
    <ci>Q</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   r(Q)
  </annotation>
 </semantics>
</math>

<code>); </code><br/>
<code>          }</code><br/>
<code>    }</code><br/>
<code>  }</code><br/>
<code>  </code><strong><code>else</code></strong><code> { </code><br/>
<code>    </code><strong><code>for</code> <code>each</code></strong><code> </code><u><code>entry</code></u><code>(</code>

<math display="inline" id="M-tree:104">
 <semantics>
  <msub>
   <mi>O</mi>
   <mi>j</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>O</ci>
    <ci>j</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   O_{j}
  </annotation>
 </semantics>
</math>

<code>) </code><strong><code>in</code></strong><code> </code>

<math display="inline" id="M-tree:105">
 <semantics>
  <mi>N</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>N</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   N
  </annotation>
 </semantics>
</math>

<code> </code><strong><code>do</code></strong><code> {</code><br/>
<code>          </code><strong><code>if</code></strong><code> </code>

<math display="inline" id="M-tree:106">
 <semantics>
  <mrow>
   <mrow>
    <mo stretchy="false">|</mo>
    <mrow>
     <mrow>
      <mi>d</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <msub>
        <mi>O</mi>
        <mi>p</mi>
       </msub>
       <mo>,</mo>
       <mi>Q</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo>-</mo>
     <mrow>
      <mi>d</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <msub>
        <mi>O</mi>
        <mi>j</mi>
       </msub>
       <mo>,</mo>
       <msub>
        <mi>O</mi>
        <mi>p</mi>
       </msub>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mrow>
    <mo stretchy="false">|</mo>
   </mrow>
   <mo>≤</mo>
   <mrow>
    <mi>r</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>Q</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <leq></leq>
    <apply>
     <abs></abs>
     <apply>
      <minus></minus>
      <apply>
       <times></times>
       <ci>d</ci>
       <interval closure="open">
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>O</ci>
         <ci>p</ci>
        </apply>
        <ci>Q</ci>
       </interval>
      </apply>
      <apply>
       <times></times>
       <ci>d</ci>
       <interval closure="open">
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>O</ci>
         <ci>j</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>O</ci>
         <ci>p</ci>
        </apply>
       </interval>
      </apply>
     </apply>
    </apply>
    <apply>
     <times></times>
     <ci>r</ci>
     <ci>Q</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   |d(O_{p},Q)-d(O_{j},O_{p})|\leq r(Q)
  </annotation>
 </semantics>
</math>

<code> </code><strong><code>then</code></strong><code> { </code><br/>
<code>            Compute </code>

<math display="inline" id="M-tree:107">
 <semantics>
  <mrow>
   <mi>d</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>O</mi>
     <mi>j</mi>
    </msub>
    <mo>,</mo>
    <mi>Q</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>d</ci>
    <interval closure="open">
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>O</ci>
      <ci>j</ci>
     </apply>
     <ci>Q</ci>
    </interval>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   d(O_{j},Q)
  </annotation>
 </semantics>
</math>

<code>;</code><br/>
<code>            </code><strong><code>if</code></strong><code> </code>

<math display="inline" id="M-tree:108">
 <semantics>
  <mrow>
   <mi>d</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>O</mi>
     <mi>j</mi>
    </msub>
    <mo>,</mo>
    <mi>Q</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>d</ci>
    <interval closure="open">
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>O</ci>
      <ci>j</ci>
     </apply>
     <ci>Q</ci>
    </interval>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   d(O_{j},Q)
  </annotation>
 </semantics>
</math>

<code> ≤ </code>

<math display="inline" id="M-tree:109">
 <semantics>
  <mrow>
   <mi>r</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>Q</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>r</ci>
    <ci>Q</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   r(Q)
  </annotation>
 </semantics>
</math>

<code> </code><strong><code>then</code></strong><br/>
<code>              add </code>

<math display="inline" id="M-tree:110">
 <semantics>
  <mrow>
   <mi>o</mi>
   <mi>i</mi>
   <mi>d</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>O</mi>
     <mi>j</mi>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>o</ci>
    <ci>i</ci>
    <ci>d</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>O</ci>
     <ci>j</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   oid(O_{j})
  </annotation>
 </semantics>
</math>

<code> to the result; </code><br/>
<code>          }</code><br/>
<code>    }</code><br/>
<code>  }</code><br/>
<code>}</code></p>

<p>

<math display="inline" id="M-tree:111">
 <semantics>
  <mrow>
   <mi>o</mi>
   <mi>i</mi>
   <mi>d</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>O</mi>
     <mi>j</mi>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>o</ci>
    <ci>i</ci>
    <ci>d</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>O</ci>
     <ci>j</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   oid(O_{j})
  </annotation>
 </semantics>
</math>

 is the identiﬁer of the object which resides on a separate data ﬁle.</p>

<p>

<math display="inline" id="M-tree:112">
 <semantics>
  <mrow>
   <mi>T</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>O</mi>
     <mi>r</mi>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>T</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>O</ci>
     <ci>r</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   T(O_{r})
  </annotation>
 </semantics>
</math>

 is a sub-tree – the covering tree of 

<math display="inline" id="M-tree:113">
 <semantics>
  <msub>
   <mi>O</mi>
   <mi>r</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>O</ci>
    <ci>r</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   O_{r}
  </annotation>
 </semantics>
</math>

</p>
<h3 id="k-nn-queries">k-NN queries</h3>

<p>K Nearest Neighbor (k-NN) query takes the cardinality of the input set as an input parameter. For a given query object Q ∈ D and an integer k ≥ 1, the k-NN query NN(Q, k) selects the k indexed objects which have the shortest distance from Q, according to the distance function d. <a class="footnoteRef" href="#fn3" id="fnref3"><sup>3</sup></a> </p>
<h2 id="see-also">See also</h2>
<ul>
<li><a href="Segment_tree" title="wikilink">Segment tree</a></li>
<li><a href="Interval_tree" title="wikilink">Interval tree</a> - A degenerate R-Tree for 1 dimension (usually time).</li>
<li><a href="Bounding_volume_hierarchy" title="wikilink">Bounding volume hierarchy</a></li>
<li><a href="Spatial_index" title="wikilink">Spatial index</a></li>
<li><a class="uri" href="GiST" title="wikilink">GiST</a></li>
</ul>
<h2 id="references">References</h2>

<p>"</p>

<p><a href="Category:Trees_(data_structures)" title="wikilink">Category:Trees (data structures)</a> <a href="Category:Database_index_techniques" title="wikilink">Category:Database index techniques</a> <a href="Category:Geometric_data_structures" title="wikilink">Category:Geometric data structures</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1"><a href="#fnref1">↩</a></li>
<li id="fn2"><a href="#fnref2">↩</a></li>
<li id="fn3"></li>
</ol>
</section>
</body>
</html>

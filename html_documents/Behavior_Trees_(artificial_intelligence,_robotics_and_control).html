<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="1102">Behavior Trees (artificial intelligence, robotics and control)</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Behavior Trees (artificial intelligence, robotics and control)</h1>
<hr/>

<p>A <strong>Behavior Tree</strong> (BT) is a <a href="mathematical_model" title="wikilink">mathematical model</a> of <a href="Automated_planning_and_scheduling" title="wikilink">plan</a> execution used in <a href="computer_science" title="wikilink">computer science</a>, <a class="uri" href="robotics" title="wikilink">robotics</a> and <a href="control_systems" title="wikilink">control systems</a>. They describe switchings between a finite set of tasks in a modular fashion. Their strength comes from their ability to create very complex tasks composed of simple tasks, without worrying how the simple tasks are implemented. BTs present some similarities to <a href="State_machine" title="wikilink">hierarchical state machines</a> with the key difference that the main building block of a behavior is a task rather than a state. Its ease of human understanding make BTs less error prone and very popular in the game developer community.</p>
<figure><b>(Figure)</b>
<figcaption> BT modelling the search and grasp plan of a two-armed robot.</figcaption>
</figure>
<h2 id="background">Background</h2>

<p>BTs originates from the computer game industry as a powerful tool to provide the artificial intelligence of <a href="non-player_character" title="wikilink">non-player characters</a> (NPCs).<a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a><a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a><a class="footnoteRef" href="#fn3" id="fnref3"><sup>3</sup></a><a class="footnoteRef" href="#fn4" id="fnref4"><sup>4</sup></a> They have been extensively used in high profile video games such as <a href="Halo_(series)" title="wikilink">Halo</a>, <a href="BioShock_(series)" title="wikilink">Bioshock</a>, and <a href="Spore_(2008_video_game)" title="wikilink">Spore</a>. Recent works propose BTs as a multi-mission control framework for <a href="Unmanned_aerial_vehicle" title="wikilink">UAV</a>, complex robots, robotic manipulation, and multi-robot systems.<a class="footnoteRef" href="#fn5" id="fnref5"><sup>5</sup></a><a class="footnoteRef" href="#fn6" id="fnref6"><sup>6</sup></a><a class="footnoteRef" href="#fn7" id="fnref7"><sup>7</sup></a><a class="footnoteRef" href="#fn8" id="fnref8"><sup>8</sup></a><a class="footnoteRef" href="#fn9" id="fnref9"><sup>9</sup></a><a class="footnoteRef" href="#fn10" id="fnref10"><sup>10</sup></a></p>
<h2 id="key-concepts">Key concepts</h2>

<p>BT is graphical represented as a directed <a href="Tree_(set_theory)" title="wikilink">tree</a> in which the nodes are classified as root, control flow nodes, or execution nodes (tasks). For each pair of connected nodes the outgoing node is called parent and the incoming node is called child. The root has no parents and exactly one child, the control flow nodes have one parent and at least one child, and the execution nodes have one parent and no children. Graphically, the children of a control flow node are placed below it, ordered from left to right.<a class="footnoteRef" href="#fn11" id="fnref11"><sup>11</sup></a></p>

<p>The execution of a BT starts from the root which sends ticks with a certain frequency to its child. A tick is an enabling signal that allows the execution of a child. When the execution of a node in the BT is allowed, it returns to the parent a status <strong>running</strong> if its execution has not finished yet, <strong>success</strong> if it has achieved its goal, or <strong>failure</strong> otherwise.</p>
<h3 id="control-flow-node">Control flow node</h3>

<p>A control flow node is used to control the subtasks of which it is composed. A control flow node may be either a selector (fallback) node or a sequence node. They run each of their subtasks in turn. When a subtask is completed and returns its status (success or failure), the control flow node decides whether to execute the next subtask or not.</p>
<h4 id="selector-fallback-node">Selector (fallback) node</h4>
<figure><b>(Figure)</b>
<figcaption>Figure I. Graphical representation of a fallback composition of N tasks.</figcaption>
</figure>

<p>Fallback nodes are used to find and execute the first child that does not fail. A fallback node will return immediately with a status code of success or running when one of its children returns success or running (see Figure I and the pseudocode below). The children are ticked in order of importance, from left to right.</p>

<p>In pseudocode, the algorithm for a fallback composition is:</p>

<p><code>1 </code><strong><code>for</code></strong><code> i from 1 to n </code><strong><code>do</code></strong><br/>
<code>2     childstatus ← Tick(child(i))</code><br/>
<code>3     </code><strong><code>if</code></strong><code> childstatus = running</code><br/>
<code>4        </code><strong><code>return</code></strong><code> running</code><br/>
<code>5     </code><strong><code>else</code> <code>if</code></strong><code> childstatus = success</code><br/>
<code>6        </code><strong><code>return</code></strong><code> success</code><br/>
<code>7 </code><strong><code>end</code></strong><br/>
<code>8 </code><strong><code>return</code></strong><code> failure</code></p>
<h4 id="sequence-node">Sequence node</h4>

<p> Sequence nodes are used to find and execute the first child that has not yet succeeded. A sequence node will return immediately with a status code of failure or running when one of its children returns failure or running (see Figure II and the pseudocode below). The children are ticked in order, from left to right.</p>

<p>In pseudocode, the algorithm for a sequence composition is:</p>

<p><code>1 </code><strong><code>for</code></strong><code> i from 1 to n </code><strong><code>do</code></strong><br/>
<code>2     childstatus ← Tick(child(i))</code><br/>
<code>3     </code><strong><code>if</code></strong><code> childstatus = running</code><br/>
<code>4        </code><strong><code>return</code></strong><code> running</code><br/>
<code>5     </code><strong><code>else</code> <code>if</code></strong><code> childstatus = failure</code><br/>
<code>6        </code><strong><code>return</code></strong><code> failure</code><br/>
<code>7 </code><strong><code>end</code></strong><br/>
<code>8 </code><strong><code>return</code></strong><code> success</code></p>
<h2 id="mathematical-definition">Mathematical definition</h2>

<p>BT are defined as three-tuple.<a class="footnoteRef" href="#fn12" id="fnref12"><sup>12</sup></a> 

<math display="inline" id="Behavior_Trees_(artificial_intelligence,_robotics_and_control):0">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>T</mi>
     <mi>i</mi>
    </msub>
    <mo>=</mo>
    <mrow>
     <mo stretchy="false">{</mo>
     <msub>
      <mi>f</mi>
      <mi>i</mi>
     </msub>
     <mo>,</mo>
     <msub>
      <mi>r</mi>
      <mi>i</mi>
     </msub>
     <mo>,</mo>
     <mrow>
      <mi mathvariant="normal">Δ</mi>
      <mi>t</mi>
     </mrow>
     <mo stretchy="false">}</mo>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>T</ci>
     <ci>i</ci>
    </apply>
    <set>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>f</ci>
      <ci>i</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>r</ci>
      <ci>i</ci>
     </apply>
     <apply>
      <times></times>
      <ci>normal-Δ</ci>
      <ci>t</ci>
     </apply>
    </set>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   T_{i}=\{f_{i},r_{i},\Delta t\},
  </annotation>
 </semantics>
</math>

</p>

<p>where 

<math display="inline" id="Behavior_Trees_(artificial_intelligence,_robotics_and_control):1">
 <semantics>
  <mrow>
   <mi>i</mi>
   <mo>∈</mo>
   <mi>ℕ</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <in></in>
    <ci>i</ci>
    <ci>ℕ</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   i\in\mathbb{N}
  </annotation>
 </semantics>
</math>

 is the index of the tree, 

<math display="inline" id="Behavior_Trees_(artificial_intelligence,_robotics_and_control):2">
 <semantics>
  <mrow>
   <msub>
    <mi>f</mi>
    <mi>i</mi>
   </msub>
   <mo>:</mo>
   <mrow>
    <msup>
     <mi>ℝ</mi>
     <mi>n</mi>
    </msup>
    <mo>→</mo>
    <msup>
     <mi>ℝ</mi>
     <mi>n</mi>
    </msup>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-:</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>f</ci>
     <ci>i</ci>
    </apply>
    <apply>
     <ci>normal-→</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>ℝ</ci>
      <ci>n</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>ℝ</ci>
      <ci>n</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f_{i}:\mathbb{R}^{n}\rightarrow\mathbb{R}^{n}
  </annotation>
 </semantics>
</math>

 is a vector field representing the right hand side of an ordinary difference equation, 

<math display="inline" id="Behavior_Trees_(artificial_intelligence,_robotics_and_control):3">
 <semantics>
  <mrow>
   <mi mathvariant="normal">Δ</mi>
   <mi>t</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>normal-Δ</ci>
    <ci>t</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Delta t
  </annotation>
 </semantics>
</math>

 is a time step and 

<math display="inline" id="Behavior_Trees_(artificial_intelligence,_robotics_and_control):4">
 <semantics>
  <mrow>
   <msub>
    <mi>r</mi>
    <mi>i</mi>
   </msub>
   <mo>:</mo>
   <mrow>
    <msup>
     <mi>ℝ</mi>
     <mi>n</mi>
    </msup>
    <mo>→</mo>
    <mrow>
     <mo stretchy="false">{</mo>
     <msub>
      <mi>R</mi>
      <mi>i</mi>
     </msub>
     <mo>,</mo>
     <msub>
      <mi>S</mi>
      <mi>i</mi>
     </msub>
     <mo>,</mo>
     <msub>
      <mi>F</mi>
      <mi>i</mi>
     </msub>
     <mo stretchy="false">}</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-:</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>r</ci>
     <ci>i</ci>
    </apply>
    <apply>
     <ci>normal-→</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>ℝ</ci>
      <ci>n</ci>
     </apply>
     <set>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>R</ci>
       <ci>i</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>S</ci>
       <ci>i</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>F</ci>
       <ci>i</ci>
      </apply>
     </set>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   r_{i}:\mathbb{R}^{n}\rightarrow\{R_{i},S_{i},F_{i}\}
  </annotation>
 </semantics>
</math>

 is the return status, that can be equal to either Running 

<math display="inline" id="Behavior_Trees_(artificial_intelligence,_robotics_and_control):5">
 <semantics>
  <msub>
   <mi>R</mi>
   <mi>i</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>R</ci>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   R_{i}
  </annotation>
 </semantics>
</math>

, Success 

<math display="inline" id="Behavior_Trees_(artificial_intelligence,_robotics_and_control):6">
 <semantics>
  <msub>
   <mi>S</mi>
   <mi>i</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>S</ci>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   S_{i}
  </annotation>
 </semantics>
</math>

, or Failure 

<math display="inline" id="Behavior_Trees_(artificial_intelligence,_robotics_and_control):7">
 <semantics>
  <msub>
   <mi>F</mi>
   <mi>i</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>F</ci>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   F_{i}
  </annotation>
 </semantics>
</math>

.</p>

<p><strong>Note</strong>: A task is degenerate BT with no parent and no child.</p>
<h3 id="behavior-tree-execution">Behavior Tree execution</h3>

<p>The execution of a BT is described by the following standard ordinary difference equations:</p>

<p>

<math display="inline" id="Behavior_Trees_(artificial_intelligence,_robotics_and_control):8">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>x</mi>
     <mrow>
      <mi>k</mi>
      <mo>+</mo>
      <mi>t</mi>
     </mrow>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <msub>
      <mi>t</mi>
      <mrow>
       <mi>k</mi>
       <mo>+</mo>
       <mn>1</mn>
      </mrow>
     </msub>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <msub>
     <mi>f</mi>
     <mi>i</mi>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <msub>
       <mi>x</mi>
       <mi>k</mi>
      </msub>
      <mrow>
       <mo stretchy="false">(</mo>
       <msub>
        <mi>t</mi>
        <mi>k</mi>
       </msub>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <apply>
       <plus></plus>
       <ci>k</ci>
       <ci>t</ci>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>t</ci>
      <apply>
       <plus></plus>
       <ci>k</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>f</ci>
      <ci>i</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <ci>k</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>t</ci>
       <ci>k</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x_{k+t}(t_{k+1})=f_{i}(x_{k}(t_{k}))
  </annotation>
 </semantics>
</math>

 

<math display="inline" id="Behavior_Trees_(artificial_intelligence,_robotics_and_control):9">
 <semantics>
  <mrow>
   <msub>
    <mi>t</mi>
    <mrow>
     <mi>k</mi>
     <mo>+</mo>
     <mn>1</mn>
    </mrow>
   </msub>
   <mo>=</mo>
   <mrow>
    <msub>
     <mi>t</mi>
     <mi>k</mi>
    </msub>
    <mo>+</mo>
    <mrow>
     <mi mathvariant="normal">Δ</mi>
     <mi>t</mi>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>t</ci>
     <apply>
      <plus></plus>
      <ci>k</ci>
      <cn type="integer">1</cn>
     </apply>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>t</ci>
      <ci>k</ci>
     </apply>
     <apply>
      <times></times>
      <ci>normal-Δ</ci>
      <ci>t</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   t_{k+1}=t_{k}+\Delta t
  </annotation>
 </semantics>
</math>

</p>

<p>where 

<math display="inline" id="Behavior_Trees_(artificial_intelligence,_robotics_and_control):10">
 <semantics>
  <mrow>
   <mi>k</mi>
   <mo>∈</mo>
   <mi>ℕ</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <in></in>
    <ci>k</ci>
    <ci>ℕ</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   k\in\mathbb{N}
  </annotation>
 </semantics>
</math>

 represent the discrete time, and 

<math display="inline" id="Behavior_Trees_(artificial_intelligence,_robotics_and_control):11">
 <semantics>
  <mrow>
   <mi>x</mi>
   <mo>∈</mo>
   <msup>
    <mi>ℝ</mi>
    <mi>n</mi>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <in></in>
    <ci>x</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>ℝ</ci>
     <ci>n</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x\in\mathbb{R}^{n}
  </annotation>
 </semantics>
</math>

 is the state space of the system modelled by the Behvavior Tree.</p>
<h3 id="fallback-composition">Fallback composition</h3>

<p>Two BTs 

<math display="inline" id="Behavior_Trees_(artificial_intelligence,_robotics_and_control):12">
 <semantics>
  <msub>
   <mi>T</mi>
   <mi>i</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>T</ci>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   T_{i}
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Behavior_Trees_(artificial_intelligence,_robotics_and_control):13">
 <semantics>
  <msub>
   <mi>T</mi>
   <mi>j</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>T</ci>
    <ci>j</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   T_{j}
  </annotation>
 </semantics>
</math>

 can be composed into a more complex BT 

<math display="inline" id="Behavior_Trees_(artificial_intelligence,_robotics_and_control):14">
 <semantics>
  <msub>
   <mi>T</mi>
   <mn>0</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>T</ci>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   T_{0}
  </annotation>
 </semantics>
</math>

 using a Fallback operator.</p>

<p>

<math display="inline" id="Behavior_Trees_(artificial_intelligence,_robotics_and_control):15">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>T</mi>
     <mn>0</mn>
    </msub>
    <mo>=</mo>
    <mrow>
     <mtext>fallback</mtext>
     <mrow>
      <mo stretchy="false">(</mo>
      <msub>
       <mi>T</mi>
       <mi>i</mi>
      </msub>
      <mo>,</mo>
      <msub>
       <mi>T</mi>
       <mi>j</mi>
      </msub>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>T</ci>
     <cn type="integer">0</cn>
    </apply>
    <apply>
     <times></times>
     <mtext>fallback</mtext>
     <interval closure="open">
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>T</ci>
       <ci>i</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>T</ci>
       <ci>j</ci>
      </apply>
     </interval>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   T_{0}=\mbox{fallback}(T_{i},T_{j}).
  </annotation>
 </semantics>
</math>

</p>

<p>Then return status 

<math display="inline" id="Behavior_Trees_(artificial_intelligence,_robotics_and_control):16">
 <semantics>
  <msub>
   <mi>r</mi>
   <mn>0</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>r</ci>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   r_{0}
  </annotation>
 </semantics>
</math>

 and the vector field 

<math display="inline" id="Behavior_Trees_(artificial_intelligence,_robotics_and_control):17">
 <semantics>
  <msub>
   <mi>f</mi>
   <mn>0</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>f</ci>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f_{0}
  </annotation>
 </semantics>
</math>

 associated with 

<math display="inline" id="Behavior_Trees_(artificial_intelligence,_robotics_and_control):18">
 <semantics>
  <msub>
   <mi>T</mi>
   <mn>0</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>T</ci>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   T_{0}
  </annotation>
 </semantics>
</math>

 are defined as follows:</p>

<p>

<math display="inline" id="Behavior_Trees_(artificial_intelligence,_robotics_and_control):19">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>r</mi>
     <mn>0</mn>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <msub>
      <mi>x</mi>
      <mi>k</mi>
     </msub>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mo>{</mo>
    <mtable>
     <mtr>
      <mtd columnalign="left">
       <mrow>
        <msub>
         <mi>r</mi>
         <mi>j</mi>
        </msub>
        <mrow>
         <mo stretchy="false">(</mo>
         <msub>
          <mi>x</mi>
          <mi>k</mi>
         </msub>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
      </mtd>
      <mtd columnalign="left">
       <mrow>
        <mrow>
         <mtext>if</mtext>
         <msub>
          <mi>x</mi>
          <mi>k</mi>
         </msub>
        </mrow>
        <mo>∈</mo>
        <msub>
         <mi class="ltx_font_mathcaligraphic">ℱ</mi>
         <mn>1</mn>
        </msub>
       </mrow>
      </mtd>
     </mtr>
     <mtr>
      <mtd columnalign="left">
       <mrow>
        <msub>
         <mi>r</mi>
         <mi>i</mi>
        </msub>
        <mrow>
         <mo stretchy="false">(</mo>
         <msub>
          <mi>x</mi>
          <mi>k</mi>
         </msub>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
      </mtd>
      <mtd columnalign="left">
       <mrow>
        <mtext>otherwise</mtext>
        <mo>.</mo>
       </mrow>
      </mtd>
     </mtr>
    </mtable>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>r</ci>
      <cn type="integer">0</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <ci>k</ci>
     </apply>
    </apply>
    <apply>
     <csymbol cd="latexml">cases</csymbol>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>r</ci>
       <ci>j</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <ci>k</ci>
      </apply>
     </apply>
     <apply>
      <in></in>
      <apply>
       <times></times>
       <mtext>if</mtext>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <ci>k</ci>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>ℱ</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>r</ci>
       <ci>i</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <ci>k</ci>
      </apply>
     </apply>
     <mtext>otherwise</mtext>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   r_{0}(x_{k})=\begin{cases}r_{j}(x_{k})&\text{ if }x_{k}\in\mathcal{F}_{1}\\
r_{i}(x_{k})&\text{ otherwise }.\end{cases}
  </annotation>
 </semantics>
</math>

 

<math display="inline" id="Behavior_Trees_(artificial_intelligence,_robotics_and_control):20">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>f</mi>
     <mn>0</mn>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <msub>
      <mi>x</mi>
      <mi>k</mi>
     </msub>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mo>{</mo>
    <mtable>
     <mtr>
      <mtd columnalign="left">
       <mrow>
        <msub>
         <mi>f</mi>
         <mi>j</mi>
        </msub>
        <mrow>
         <mo stretchy="false">(</mo>
         <msub>
          <mi>x</mi>
          <mi>k</mi>
         </msub>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
      </mtd>
      <mtd columnalign="left">
       <mrow>
        <mrow>
         <mtext>if</mtext>
         <msub>
          <mi>x</mi>
          <mi>k</mi>
         </msub>
        </mrow>
        <mo>∈</mo>
        <msub>
         <mi class="ltx_font_mathcaligraphic">ℱ</mi>
         <mn>1</mn>
        </msub>
       </mrow>
      </mtd>
     </mtr>
     <mtr>
      <mtd columnalign="left">
       <mrow>
        <msub>
         <mi>f</mi>
         <mi>i</mi>
        </msub>
        <mrow>
         <mo stretchy="false">(</mo>
         <msub>
          <mi>x</mi>
          <mi>k</mi>
         </msub>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
      </mtd>
      <mtd columnalign="left">
       <mrow>
        <mtext>otherwise</mtext>
        <mo>.</mo>
       </mrow>
      </mtd>
     </mtr>
    </mtable>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>f</ci>
      <cn type="integer">0</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <ci>k</ci>
     </apply>
    </apply>
    <apply>
     <csymbol cd="latexml">cases</csymbol>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>f</ci>
       <ci>j</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <ci>k</ci>
      </apply>
     </apply>
     <apply>
      <in></in>
      <apply>
       <times></times>
       <mtext>if</mtext>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <ci>k</ci>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>ℱ</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>f</ci>
       <ci>i</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <ci>k</ci>
      </apply>
     </apply>
     <mtext>otherwise</mtext>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f_{0}(x_{k})=\begin{cases}f_{j}(x_{k})&\text{ if }x_{k}\in\mathcal{F}_{1}\\
f_{i}(x_{k})&\text{ otherwise }.\end{cases}
  </annotation>
 </semantics>
</math>

</p>
<h3 id="sequence-composition">Sequence composition</h3>

<p>Two BTs 

<math display="inline" id="Behavior_Trees_(artificial_intelligence,_robotics_and_control):21">
 <semantics>
  <msub>
   <mi>T</mi>
   <mi>i</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>T</ci>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   T_{i}
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Behavior_Trees_(artificial_intelligence,_robotics_and_control):22">
 <semantics>
  <msub>
   <mi>T</mi>
   <mi>j</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>T</ci>
    <ci>j</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   T_{j}
  </annotation>
 </semantics>
</math>

 can be composed into a more complex BT 

<math display="inline" id="Behavior_Trees_(artificial_intelligence,_robotics_and_control):23">
 <semantics>
  <msub>
   <mi>T</mi>
   <mn>0</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>T</ci>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   T_{0}
  </annotation>
 </semantics>
</math>

 using a Sequence operator.</p>

<p>

<math display="inline" id="Behavior_Trees_(artificial_intelligence,_robotics_and_control):24">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>T</mi>
     <mn>0</mn>
    </msub>
    <mo>=</mo>
    <mrow>
     <mtext>sequence</mtext>
     <mrow>
      <mo stretchy="false">(</mo>
      <msub>
       <mi>T</mi>
       <mi>i</mi>
      </msub>
      <mo>,</mo>
      <msub>
       <mi>T</mi>
       <mi>j</mi>
      </msub>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>T</ci>
     <cn type="integer">0</cn>
    </apply>
    <apply>
     <times></times>
     <mtext>sequence</mtext>
     <interval closure="open">
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>T</ci>
       <ci>i</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>T</ci>
       <ci>j</ci>
      </apply>
     </interval>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   T_{0}=\mbox{sequence}(T_{i},T_{j}).
  </annotation>
 </semantics>
</math>

</p>

<p>Then return status 

<math display="inline" id="Behavior_Trees_(artificial_intelligence,_robotics_and_control):25">
 <semantics>
  <msub>
   <mi>r</mi>
   <mn>0</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>r</ci>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   r_{0}
  </annotation>
 </semantics>
</math>

 and the vector field 

<math display="inline" id="Behavior_Trees_(artificial_intelligence,_robotics_and_control):26">
 <semantics>
  <msub>
   <mi>f</mi>
   <mn>0</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>f</ci>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f_{0}
  </annotation>
 </semantics>
</math>

 associated with 

<math display="inline" id="Behavior_Trees_(artificial_intelligence,_robotics_and_control):27">
 <semantics>
  <msub>
   <mi>T</mi>
   <mn>0</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>T</ci>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   T_{0}
  </annotation>
 </semantics>
</math>

 are defined as follows:</p>

<p>

<math display="inline" id="Behavior_Trees_(artificial_intelligence,_robotics_and_control):28">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>r</mi>
     <mn>0</mn>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <msub>
      <mi>x</mi>
      <mi>k</mi>
     </msub>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mo>{</mo>
    <mtable>
     <mtr>
      <mtd columnalign="left">
       <mrow>
        <msub>
         <mi>r</mi>
         <mi>j</mi>
        </msub>
        <mrow>
         <mo stretchy="false">(</mo>
         <msub>
          <mi>x</mi>
          <mi>k</mi>
         </msub>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
      </mtd>
      <mtd columnalign="left">
       <mrow>
        <mrow>
         <mtext>if</mtext>
         <msub>
          <mi>x</mi>
          <mi>k</mi>
         </msub>
        </mrow>
        <mo>∈</mo>
        <msub>
         <mi class="ltx_font_mathcaligraphic">𝒮</mi>
         <mn>1</mn>
        </msub>
       </mrow>
      </mtd>
     </mtr>
     <mtr>
      <mtd columnalign="left">
       <mrow>
        <msub>
         <mi>r</mi>
         <mi>i</mi>
        </msub>
        <mrow>
         <mo stretchy="false">(</mo>
         <msub>
          <mi>x</mi>
          <mi>k</mi>
         </msub>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
      </mtd>
      <mtd columnalign="left">
       <mrow>
        <mtext>otherwise</mtext>
        <mo>.</mo>
       </mrow>
      </mtd>
     </mtr>
    </mtable>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>r</ci>
      <cn type="integer">0</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <ci>k</ci>
     </apply>
    </apply>
    <apply>
     <csymbol cd="latexml">cases</csymbol>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>r</ci>
       <ci>j</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <ci>k</ci>
      </apply>
     </apply>
     <apply>
      <in></in>
      <apply>
       <times></times>
       <mtext>if</mtext>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <ci>k</ci>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>𝒮</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>r</ci>
       <ci>i</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <ci>k</ci>
      </apply>
     </apply>
     <mtext>otherwise</mtext>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   r_{0}(x_{k})=\begin{cases}r_{j}(x_{k})&\text{ if }x_{k}\in\mathcal{S}_{1}\\
r_{i}(x_{k})&\text{ otherwise }.\end{cases}
  </annotation>
 </semantics>
</math>

 

<math display="inline" id="Behavior_Trees_(artificial_intelligence,_robotics_and_control):29">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>f</mi>
     <mn>0</mn>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <msub>
      <mi>x</mi>
      <mi>k</mi>
     </msub>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mo>{</mo>
    <mtable>
     <mtr>
      <mtd columnalign="left">
       <mrow>
        <msub>
         <mi>f</mi>
         <mi>j</mi>
        </msub>
        <mrow>
         <mo stretchy="false">(</mo>
         <msub>
          <mi>x</mi>
          <mi>k</mi>
         </msub>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
      </mtd>
      <mtd columnalign="left">
       <mrow>
        <mrow>
         <mtext>if</mtext>
         <msub>
          <mi>x</mi>
          <mi>k</mi>
         </msub>
        </mrow>
        <mo>∈</mo>
        <msub>
         <mi class="ltx_font_mathcaligraphic">𝒮</mi>
         <mn>1</mn>
        </msub>
       </mrow>
      </mtd>
     </mtr>
     <mtr>
      <mtd columnalign="left">
       <mrow>
        <msub>
         <mi>f</mi>
         <mi>i</mi>
        </msub>
        <mrow>
         <mo stretchy="false">(</mo>
         <msub>
          <mi>x</mi>
          <mi>k</mi>
         </msub>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
      </mtd>
      <mtd columnalign="left">
       <mrow>
        <mtext>otherwise</mtext>
        <mo>.</mo>
       </mrow>
      </mtd>
     </mtr>
    </mtable>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>f</ci>
      <cn type="integer">0</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <ci>k</ci>
     </apply>
    </apply>
    <apply>
     <csymbol cd="latexml">cases</csymbol>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>f</ci>
       <ci>j</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <ci>k</ci>
      </apply>
     </apply>
     <apply>
      <in></in>
      <apply>
       <times></times>
       <mtext>if</mtext>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <ci>k</ci>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>𝒮</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>f</ci>
       <ci>i</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <ci>k</ci>
      </apply>
     </apply>
     <mtext>otherwise</mtext>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f_{0}(x_{k})=\begin{cases}f_{j}(x_{k})&\text{ if }x_{k}\in\mathcal{S}_{1}\\
f_{i}(x_{k})&\text{ otherwise }.\end{cases}
  </annotation>
 </semantics>
</math>

</p>
<h2 id="see-also">See also</h2>
<ul>
<li><a href="Hybrid_system" title="wikilink">Hybrid system</a></li>
</ul>
<h2 id="references">References</h2>

<p>"</p>

<p><a href="Category:Automata_theory" title="wikilink">Category:Automata theory</a> <a href="Category:Models_of_computation" title="wikilink">Category:Models of computation</a> <a href="Category:Digital_electronics" title="wikilink">Category:Digital electronics</a> <a href="Category:Artificial_intelligence" title="wikilink">Category:Artificial intelligence</a> <a href="Category:Robot_control" title="wikilink">Category:Robot control</a> <a href="Category:Automated_planning_and_scheduling" title="wikilink">Category:Automated planning and scheduling</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1">Isla D. 2005. <a href="http://www.researchgate.net/publication/246356425_Handling_Complexity_in_the_Halo_2_AI">Handling complexity in the Halo 2 AI. In Game Developers Conference (Vol. 12)</a><a href="#fnref1">↩</a></li>
<li id="fn2">Champandard A. 2007. <a href="http://aigamedev.com/open/article/bt-overview/">Understanding BTs. AiGameDev. com, 6</a><a href="#fnref2">↩</a></li>
<li id="fn3">Isla D. 2008. Halo 3-building a better battle. In Game Developers Conference. 2008.<a href="#fnref3">↩</a></li>
<li id="fn4">Lim, C. U., Baumgarten, R., &amp; Colton, S. 2010. <a href="https://blog.itu.dk/GAES-E2013/files/2013/09/lim_evogames10.pdf">Evolving behaviour trees for the commercial game DEFCON. In Applications of Evolutionary Computation, pp. 100-110. Springer Berlin Heidelberg, 2010.</a><a href="#fnref4">↩</a></li>
<li id="fn5">Ögren, Petter. <a href="http://www.cas.kth.se/~petter/Publications/ogren2012bt.pdf">"Increasing Modularity of UAV Control Systems using Computer Game BTs." In AIAA Guidance, Navigation and Control Conference, Minneapolis, Minnesota, pp. 13-16. 2012.</a><a href="#fnref5">↩</a></li>
<li id="fn6">Colledanchise, Michele, Marzinotto Alejandro, and Ögren Petter.<a href="http://www.csc.kth.se/~miccol/Michele_Colledanchise/Publications_files/ICRA14_cmo_final.pdf">"Performance Analysis of Stochastic BTs." In Robotics and Automation (ICRA), 2014 IEEE International Conference on. 2014.</a><a href="#fnref6">↩</a></li>
<li id="fn7">Marzinotto, Alejandro, Colledanchise Michele, Smith Christian, and Ögren Petter. <a href="http://www.csc.kth.se/~miccol/Michele_Colledanchise/Publications_files/2013_ICRA_mcko.pdf">"Towards a Unified BTs Framework for Robot Control." In Robotics and Automation (ICRA), 2014 IEEE International Conference on. 2014.</a><a href="#fnref7">↩</a></li>
<li id="fn8">Klöckner, Andreas. "Interfacing BTs with the World Using Description Logic." In AIAA Guidance, Navigation and Control Conference, Boston, MA. 2013.<a href="#fnref8">↩</a></li>
<li id="fn9">Klöckner, Andreas. "Behavior Trees for UAV Mission Management." In GI-Jahrestagung, pp. 57-68. 2013.<a href="#fnref9">↩</a></li>
<li id="fn10">Bagnell, J. Andrew, Felipe Cavalcanti, Lei Cui, Thomas Galluzzo, Martial Hebert, Moslem Kazemi, Matthew Klingensmith et al. "An integrated system for autonomous robotics manipulation." In Intelligent Robots and Systems (IROS), 2012 IEEE/RSJ International Conference on, pp. 2955-2962. IEEE, 2012.<a href="#fnref10">↩</a></li>
<li id="fn11">craft ai 2015. <a href="http://www.craft.ai/blog/bt-101-behavior-trees-grammar-basics/">BT 101 – Behavior Trees grammar basics</a><a href="#fnref11">↩</a></li>
<li id="fn12">Colledanchise Michele, and Ögren Petter.<a href="http://www.csc.kth.se/~miccol/Michele_Colledanchise/Publications_files/IROS14_CO.pdf">"How Behavior Trees Modularize Robustness and Safety in Hybrid Systems." In Intelligent Robots and Systems (IROS), 2014 IEEE/RSJ International Conference on, IEEE, 2014.</a><a href="#fnref12">↩</a></li>
</ol>
</section>
</body>
</html>

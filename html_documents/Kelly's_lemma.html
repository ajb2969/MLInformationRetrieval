<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="1221">Kelly's lemma</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Kelly's lemma</h1>
<hr>In [[probability theory]], '''Kelly's lemma'''
<p><code>states that for a stationary </code><a href="continuous_time_Markov_chain" title="wikilink"><code>continuous</code> <code>time</code> <code>Markov</code> <code>chain</code></a><code>, a process defined as the time-reversed process has the same stationary distribution as the forward-time process.</code><a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a><code> The theorem is named after </code><a href="Frank_Kelly_(mathematician)" title="wikilink"><code>Frank</code> <code>Kelly</code></a><code>.</code><a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a><a class="footnoteRef" href="#fn3" id="fnref3"><sup>3</sup></a><a class="footnoteRef" href="#fn4" id="fnref4"><sup>4</sup></a><a class="footnoteRef" href="#fn5" id="fnref5"><sup>5</sup></a></p>
<h2 id="statement">Statement</h2>

<p>For a continuous time Markov chain with state space <em>S</em> and <a href="transition_rate_matrix" title="wikilink">transition rate matrix</a> <em>Q</em> (with elements <em>q</em><sub><em>ij</em></sub>) if we can find a set of numbers <em>q</em>'<sub><em>ij</em></sub> and <em>π</em><sub><em>i</em></sub> summing to 1 where<a class="footnoteRef" href="#fn6" id="fnref6"><sup>6</sup></a></p>
<dl>
<dd><dl>
<dd><math>\begin{align}
</math></dd>
</dl>
</dd>
</dl>

<p><code> \sum_{j \neq i} \pi_i q'_{ij} &amp;= \sum_{j \neq i} q_{ij} \quad \forall i\in S\\</code><br/>
<code> \pi_i q_{ij} &amp;= \pi_jq_{ji}' \quad \forall i,j \in S</code></p>

<p>\end{align} then <em>q</em>'<sub><em>ij</em></sub> are the rates for the reversed process and <em>π</em><sub><em>i</em></sub> are the stationary distribution for both processes.</p>
<h3 id="proof">Proof</h3>

<p>Given the assumptions made on the <em>q</em><sub><em>ij</em></sub> and <em>π</em><sub><em>i</em></sub> we can see</p>
<dl>
<dd><dl>
<dd>

<math display="inline" id="Kelly's_lemma:0">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mo largeop="true" symmetric="true">∑</mo>
     <mrow>
      <mi>i</mi>
      <mo>≠</mo>
      <mi>j</mi>
     </mrow>
    </msub>
    <mrow>
     <msub>
      <mi>π</mi>
      <mi>i</mi>
     </msub>
     <msub>
      <mi>q</mi>
      <mrow>
       <mi>i</mi>
       <mi>j</mi>
      </mrow>
     </msub>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <msub>
     <mo largeop="true" symmetric="true">∑</mo>
     <mrow>
      <mi>i</mi>
      <mo>≠</mo>
      <mi>j</mi>
     </mrow>
    </msub>
    <mrow>
     <msub>
      <mi>π</mi>
      <mi>j</mi>
     </msub>
     <msubsup>
      <mi>q</mi>
      <mrow>
       <mi>j</mi>
       <mi>i</mi>
      </mrow>
      <mo>′</mo>
     </msubsup>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <msub>
     <mi>π</mi>
     <mi>j</mi>
    </msub>
    <mrow>
     <msub>
      <mo largeop="true" symmetric="true">∑</mo>
      <mrow>
       <mi>i</mi>
       <mo>≠</mo>
       <mi>j</mi>
      </mrow>
     </msub>
     <msub>
      <mi>q</mi>
      <mrow>
       <mi>j</mi>
       <mi>i</mi>
      </mrow>
     </msub>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mo>-</mo>
    <mrow>
     <msub>
      <mi>π</mi>
      <mi>j</mi>
     </msub>
     <msub>
      <mi>q</mi>
      <mrow>
       <mi>j</mi>
       <mi>j</mi>
      </mrow>
     </msub>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <apply>
        <neq></neq>
        <ci>i</ci>
        <ci>j</ci>
       </apply>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>π</ci>
        <ci>i</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>q</ci>
        <apply>
         <times></times>
         <ci>i</ci>
         <ci>j</ci>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <apply>
        <neq></neq>
        <ci>i</ci>
        <ci>j</ci>
       </apply>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>π</ci>
        <ci>j</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>q</ci>
         <ci>normal-′</ci>
        </apply>
        <apply>
         <times></times>
         <ci>j</ci>
         <ci>i</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>π</ci>
       <ci>j</ci>
      </apply>
      <apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <apply>
         <neq></neq>
         <ci>i</ci>
         <ci>j</ci>
        </apply>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>q</ci>
        <apply>
         <times></times>
         <ci>j</ci>
         <ci>i</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <minus></minus>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>π</ci>
        <ci>j</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>q</ci>
        <apply>
         <times></times>
         <ci>j</ci>
         <ci>j</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \sum_{i\neq j}\pi_{i}q_{ij}=\sum_{i\neq j}\pi_{j}q^{\prime}_{ji}=\pi_{j}\sum_{%
i\neq j}q_{ji}=-\pi_{j}q_{jj}
  </annotation>
 </semantics>
</math>


</dd>
</dl>
</dd>
</dl>

<p>so the <a href="global_balance_equation" title="wikilink">global balance equations</a> are satisfied and the <em>π</em><sub><em>i</em></sub> are a stationary distribution for both processes.</p>
<h2 id="references">References</h2>

<p>"</p>

<p><a href="Category:Stochastic_processes" title="wikilink">Category:Stochastic processes</a> <a href="Category:Queueing_theory" title="wikilink">Category:Queueing theory</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1"><a href="#fnref1">↩</a></li>
<li id="fn2"><a href="#fnref2">↩</a></li>
<li id="fn3"><a href="#fnref3">↩</a></li>
<li id="fn4"><a href="#fnref4">↩</a></li>
<li id="fn5"><a href="#fnref5">↩</a></li>
<li id="fn6"></li>
</ol>
</section>
</hr></body>
</html>

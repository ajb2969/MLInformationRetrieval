<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title offset="1846">Functional derivative</title>
   <script type="text/javascript"
      src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js">
    </script>
</head>
<body>
<h1>Functional derivative</h1>
<hr/>
<p>In the <a href="calculus_of_variations" title="wikilink">calculus of variations</a>, a field of <a href="mathematical_analysis" title="wikilink">mathematical analysis</a>, the <strong>functional derivative</strong> (or <strong>variational derivative</strong>)<a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a> relates a change in a <a href="Functional_(mathematics)" title="wikilink">functional</a> to a change in a <a href="Function_(mathematics)" title="wikilink">function</a> that the functional depends on.</p>
<p>In the calculus of variations, functionals are usually expressed in terms of an <a class="uri" href="integral" title="wikilink">integral</a> of functions, their <a href="Argument_of_a_function" title="wikilink">arguments</a>, and their <a href="derivative" title="wikilink">derivatives</a>. In an integrand <span class="LaTeX">$L$</span> of a functional, if a function <span class="LaTeX">$f$</span> is varied by adding to it another function <span class="LaTeX">$δf$</span> that is arbitrarily small, and the resulting integrand is expanded in powers of <span class="LaTeX">$δf$</span>, the coefficient of <span class="LaTeX">$δf$</span> in the first order term is called the functional derivative.</p>
<p>For example, consider the functional</p>
<p><span class="LaTeX">$$J[f] = \int \limits_a^b L[ \, x, f(x), f \, '(x) \, ] \, dx \ ,$$</span> where <span class="LaTeX">$f ′( x ) ≡ df/dx$</span>. If <span class="LaTeX">$f$</span> is varied by adding to it a function <span class="LaTeX">$δf$</span>, and the resulting integrand <span class="LaTeX">$L ( x, f +δf, f +δf f ′)$</span> is expanded in powers of <span class="LaTeX">$δf$</span>, then the change in the value of <span class="LaTeX">$J$</span> to first order in <span class="LaTeX">$δf$</span> can be expressed as follows:<a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a><a class="footnoteRef" href="#fn3" id="fnref3"><sup>3</sup></a></p>
<p><span class="LaTeX">$$\delta J = \int_a^b  \frac{\delta J}{\delta f(x)} {\delta f(x)} \, dx \, .$$</span> The coefficient of <span class="LaTeX">$δf(x)$</span>, denoted as <span class="LaTeX">$δJ / δf(x)$</span>, is called the <strong>functional derivative</strong> of <span class="LaTeX">$J$</span> with respect to <span class="LaTeX">$f$</span> at the point <span class="LaTeX">$x$</span>.<a class="footnoteRef" href="#fn4" id="fnref4"><sup>4</sup></a> For this example functional, the functional derivative is the left hand side of the <a href="Calculus_of_variations#Euler.E2.80.93Lagrange_equation" title="wikilink">Euler-Lagrange equation</a>,<a class="footnoteRef" href="#fn5" id="fnref5"><sup>5</sup></a></p>
<p><span class="LaTeX">$$\frac{\delta J}{\delta f(x)} = \frac{\part L}{\part f} -\frac{d}{dx} \frac{\part L}{\part f'} \, .$$</span></p>
<h2 id="definition">Definition</h2>
<p>In this section, the functional derivative is defined. Then the functional differential is defined in terms of the functional derivative.</p>
<h3 id="functional-derivative">Functional derivative</h3>
<p>Given a <a class="uri" href="manifold" title="wikilink">manifold</a> <span class="LaTeX">$M$</span> representing (<a href="continuous_function_(topology)" title="wikilink">continuous</a>/<a href="smooth_function" title="wikilink">smooth</a>/with certain <a href="boundary_condition" title="wikilink">boundary conditions</a>/etc.) functions <span class="LaTeX">$ρ$</span> and a <a href="functional_(mathematics)" title="wikilink">functional</a> <span class="LaTeX">$F$</span> defined as</p>
<p><span class="LaTeX">$$F\colon M \rightarrow \mathbb{R} \quad \mbox{or} \quad F\colon M \rightarrow \mathbb{C} \, ,$$</span></p>
<p>the <strong>functional derivative</strong> of <span class="LaTeX">$F$</span><em>ρ</em>], denoted <span class="LaTeX">$δF/δρ$</span>, is defined by<a class="footnoteRef" href="#fn6" id="fnref6"><sup>6</sup></a></p>
<p><span class="LaTeX">$$\begin{align}
 \int \frac{\delta F}{\delta\rho}(x) \phi(x) \; dx 
&= \lim_{\varepsilon\to 0}\frac{F[\rho+\varepsilon \phi]-F[\rho]}{\varepsilon} \\
&= \left [ \frac{d}{d\epsilon}F[\rho+\epsilon \phi]\right ]_{\epsilon=0},
\end{align}$$</span></p>
<p>where <span class="LaTeX">$ϕ$</span> is an arbitrary function. The quantity <span class="LaTeX">$εϕ$</span> is called the variation of <span class="LaTeX">$ρ$</span>. In other words,</p>
<p><span class="LaTeX">$$\phi \mapsto \left [ \frac{d}{d\epsilon}F[\rho+\epsilon \phi]\right ]_{\epsilon=0}$$</span></p>
<p>is a linear functional, so by the <a href="Riesz_representation_theorem" title="wikilink">Riesz representation theorem</a>, this functional is given by integration against some <a href="measure_(mathematics)" title="wikilink">measure</a>. Then <span class="LaTeX">$δF / δρ$</span> is defined to be the <a href="Radon–Nikodym_derivative" title="wikilink">Radon–Nikodym derivative</a> of this measure.</p>
<p>We think of the function <span class="LaTeX">$δF / δρ$</span> as the gradient of <span class="LaTeX">$F$</span> at the point <span class="LaTeX">$ρ$</span> and</p>
<p><span class="LaTeX">$$\int \frac{\delta F}{\delta\rho}(x) \phi(x) \; dx$$</span> as the directional derivative at point <span class="LaTeX">$ρ$</span> in the direction of <span class="LaTeX">$ϕ$</span>. Then analogous to vector calculus, the inner product with the gradient gives the directional derivative.</p>
<h3 id="functional-differential">Functional differential</h3>
<p>The differential (or variation or first variation) of the functional <span class="LaTeX">$F$</span>[<em>ρ</em>] is,<a class="footnoteRef" href="#fn7" id="fnref7"><sup>7</sup></a> <a class="footnoteRef" href="#fn8" id="fnref8"><sup>8</sup></a></p>
<p><span class="LaTeX">$$\delta F (\rho, \phi)= \int   \frac {\delta F} {\delta \rho}(x) \ \phi(x)   \ dx \ ,$$</span> Heuristically, <span class="LaTeX">$ϕ$</span> is the change in <span class="LaTeX">$ρ$</span>, so we 'formally' have <span class="LaTeX">$ϕ = δρ$</span>, and then this is similar in form to the <a href="total_differential" title="wikilink">total differential</a> of a function <mtpl></mtpl>,</p>
<p><span class="LaTeX">$$dF =   \sum_{i=1} ^n  \frac {\partial F} {\partial \rho_i} \ d\rho_i  \ ,$$</span> where <mtpl></mtpl> are independent variables. Comparing the last two equations, the functional derivative <span class="LaTeX">$δF / δρ ( x )$</span> has a role similar to that of the partial derivative <mtpl></mtpl>, where the variable of integration <span class="LaTeX">$x$</span> is like a continuous version of the summation index <span class="LaTeX">$i$</span>.<a class="footnoteRef" href="#fn9" id="fnref9"><sup>9</sup></a></p>
<h3 id="formal-description">Formal description</h3>
<p>The definition of a functional derivative may be made more mathematically precise and formal by defining the <a href="topological_vector_space" title="wikilink">space of functions</a> more carefully. For example, when the space of functions is a <a href="Banach_space" title="wikilink">Banach space</a>, the functional derivative becomes known as the <a href="Fréchet_derivative" title="wikilink">Fréchet derivative</a>, while one uses the <a href="Gâteaux_derivative" title="wikilink">Gâteaux derivative</a> on more general <a href="locally_convex_space" title="wikilink">locally convex spaces</a>. Note that the well-known <a href="Hilbert_space" title="wikilink">Hilbert spaces</a> are special cases of <a href="Banach_space" title="wikilink">Banach spaces</a>. The more formal treatment allows many theorems from ordinary <a class="uri" href="calculus" title="wikilink">calculus</a> and <a href="Mathematical_analysis" title="wikilink">analysis</a> to be generalized to corresponding theorems in <a href="functional_analysis" title="wikilink">functional analysis</a>, as well as numerous new theorems to be stated.</p>
<h2 id="properties">Properties</h2>
<p>Like the derivative of a function, the functional derivative satisfies the following properties, where <span class="LaTeX">$F$</span>[<em>ρ</em>] and <span class="LaTeX">$G$</span>[<em>ρ</em>] are functionals:</p>
<ul>
<li>Linearity:<a class="footnoteRef" href="#fn10" id="fnref10"><sup>10</sup></a></li>
</ul>
<p><span class="LaTeX">$$\frac{\delta(\lambda F + \mu G)[\rho ]}{\delta \rho(x)} = \lambda \frac{\delta F[\rho]}{\delta \rho(x)} + \mu \frac{\delta G[\rho]}{\delta \rho(x)},$$</span> where <span class="LaTeX">$λ , μ$</span> are constants.</p>
<ul>
<li>Product rule:<a class="footnoteRef" href="#fn11" id="fnref11"><sup>11</sup></a></li>
</ul>
<p><span class="LaTeX">$$\frac{\delta(FG)[\rho]}{\delta \rho(x)} = \frac{\delta F[\rho]}{\delta \rho(x)} G[\rho] + F[\rho] \frac{\delta G[\rho]}{\delta \rho(x)} \, ,$$</span></p>
<ul>
<li>Chain rules:</li>
</ul>
<dl>
<dd>If <span class="LaTeX">$F$</span> and <span class="LaTeX">$G$</span> are functionals, then<a class="footnoteRef" href="#fn12" id="fnref12"><sup>12</sup></a>
</dd>
<dd><span class="LaTeX">$\displaystyle\frac{\delta F[G[\rho]] }{\delta\rho(y)}  = \int dx \frac{\delta F[G(\rho)]}{\delta G[\rho(x) ]} \ \frac {\delta G[\rho]} {\delta\rho(y)} \ .$</span>
</dd>
<dd>If <span class="LaTeX">$G$</span> is an ordinary differentiable function <span class="LaTeX">$g$</span>, then this reduces to<a class="footnoteRef" href="#fn13" id="fnref13"><sup>13</sup></a>
</dd>
<dd><span class="LaTeX">$\displaystyle\frac{\delta F[g(\rho)] }{\delta\rho(y)}  = \frac{\delta F[g(\rho)]}{\delta g[\rho(x) ]} \ \frac {dg(\rho)} {d\rho(y)} \ .$</span>
</dd>
</dl>
<h2 id="determining-functional-derivatives">Determining functional derivatives</h2>
<p>We give a formula to determine functional derivatives for a common class of functionals that can be written as the integral of a function and its derivatives. This is a generalization of the <a href="Euler–Lagrange_equation" title="wikilink">Euler–Lagrange equation</a>: indeed, the functional derivative was introduced in <a class="uri" href="physics" title="wikilink">physics</a> within the derivation of the <a href="Joseph-Louis_Lagrange" title="wikilink">Lagrange</a> equation of the second kind from the <a href="principle_of_least_action" title="wikilink">principle of least action</a> in <a href="Lagrangian_mechanics" title="wikilink">Lagrangian mechanics</a> (18th century). The first three examples below are taken from <a href="density_functional_theory" title="wikilink">density functional theory</a> (20th century), the fourth from <a href="statistical_mechanics" title="wikilink">statistical mechanics</a> (19th century).</p>
<h3 id="formula">Formula</h3>
<p>Given a functional</p>
<p><span class="LaTeX">$$F[\rho] = \int f( \boldsymbol{r}, \rho(\boldsymbol{r}), \nabla\rho(\boldsymbol{r}) )\, d\boldsymbol{r},$$</span> and a function <span class="LaTeX">$ϕ$</span>(<strong><span class="LaTeX">$r$</span></strong>) that vanishes on the boundary of the region of integration, from a previous section <a href="Functional_derivative#Definition" title="wikilink">Definition</a>,</p>
<p><span class="LaTeX">$$\begin{align}
\int \frac{\delta F}{\delta\rho(\boldsymbol{r})} \, \phi(\boldsymbol{r}) \, d\boldsymbol{r}  
&  = \left [ \frac{d}{d\varepsilon} \int f( \boldsymbol{r}, \rho + \varepsilon \phi, \nabla\rho+\varepsilon\nabla\phi )\, d\boldsymbol{r} \right ]_{\varepsilon=0} \\
&  = \int \left( \frac{\partial f}{\partial\rho} \, \phi + \frac{\partial f}{\partial\nabla\rho} \cdot \nabla\phi \right) d\boldsymbol{r} \\
&  = \int \left[ \frac{\partial f}{\partial\rho} \, \phi + \nabla \cdot \left( \frac{\partial f}{\partial\nabla\rho} \, \phi \right) - \left( \nabla \cdot \frac{\partial f}{\partial\nabla\rho} \right) \phi \right] d\boldsymbol{r} \\
&  = \int \left[ \frac{\partial f}{\partial\rho} \, \phi - \left( \nabla \cdot \frac{\partial f}{\partial\nabla\rho} \right) \phi \right] d\boldsymbol{r} \\
&  = \int \left( \frac{\partial f}{\partial\rho} -  \nabla \cdot \frac{\partial f}{\partial\nabla\rho} \right) \phi(\boldsymbol{r}) \ d\boldsymbol{r} \, .
\end{align}$$</span></p>
<p>The second line is obtained using the <a href="total_derivative" title="wikilink">total derivative</a>, where <span class="LaTeX">$∂f / ∂∇$</span><em>ρ</em> is a <a href="Matrix_calculus#Scalar-by-vector" title="wikilink">derivative of a scalar with respect to a vector</a>.<ref group="Note">For a three-dimensional cartesian coordinate system,</ref></p>
<p><span class="LaTeX">$$\begin{align}
\frac{\partial f}{\partial\nabla\rho} =   \frac{\partial f}{\partial\rho_x}  \mathbf{\hat{i}}   + \frac{\partial f}{\partial\rho_y}  \mathbf{\hat{j}} + \frac{\partial f}{\partial\rho_z}  \mathbf{\hat{k}}\, ,  \qquad 
& \text{where} \ \rho_x = \frac{\partial \rho}{\partial x}\, ,  \ \rho_y = \frac{\partial \rho}{\partial y}\, , \ \rho_z = \frac{\partial \rho}{\partial z}\, \\
& \text{and} \ \ \mathbf{\hat{i}}, \ \mathbf{\hat{j}}, \ \mathbf{\hat{k}} \ \ \text {are unit vectors along the x, y, z axes.}
\end{align}$$</span> The third line was obtained by use of a <a href="Divergence#Properties" title="wikilink">product rule for divergence</a>. The fourth line was obtained using the <a href="divergence_theorem" title="wikilink">divergence theorem</a> and the condition that <span class="LaTeX">$ϕ = 0$</span> on the boundary of the region of integration. Since <span class="LaTeX">$ϕ$</span> is also an arbitrary function, applying the <a href="fundamental_lemma_of_calculus_of_variations" title="wikilink">fundamental lemma of calculus of variations</a> to the last line, the functional derivative is</p>
<dl>
<dd><div latex="" style='<MTPL>

<p></MTPL>; width:20em; margin:.3em"></p>
<center>
<p><math></p>
</dd>
</dl>
<p>\frac{\delta F}{\delta\rho(\boldsymbol{r})} = \frac{\partial f}{\partial\rho} - \nabla \cdot \frac{\partial f}{\partial\nabla\rho} </math></p>
</center>
</div>
<p>where <em>ρ</em> = <em>ρ</em>(<strong><span class='>$r$) and <span class="LaTeX">$f = f ( \mathbf{ r } $</span>, <em>ρ</em>, ∇<em>ρ</em>). This formula is for the case of the functional form given by <span class="LaTeX">$F$</span>[<em>ρ</em>] at the beginning of this section. For other functional forms, the definition of the functional derivative can be used as the starting point for its determination. (See the example <a href="Functional_derivative#Coulomb_potential_energy_functional" title="wikilink">Coulomb potential energy functional</a>.)
<p>The above equation for the functional derivative can be generalized to the case that includes higher dimensions and higher order derivatives. The functional would be,</p>
<p><span class="LaTeX">$$F[\rho(\boldsymbol{r})] = \int f( \boldsymbol{r}, \rho(\boldsymbol{r}), \nabla\rho(\boldsymbol{r}), \nabla^{(2)}\rho(\boldsymbol{r}), \dots, \nabla^{(N)}\rho(\boldsymbol{r}))\, d\boldsymbol{r},$$</span></p>
<p>where the vector <mtpl></mtpl>, and <mtpl></mtpl> is a tensor whose <mtpl></mtpl> components are partial derivative operators of order <span class="LaTeX">$i$</span>,</p>
<p><span class="LaTeX">$$\left [ \nabla^{(i)} \right ]_{\alpha_1 \alpha_2 \cdots \alpha_i} = \frac {\partial^{\, i}} {\partial r_{\alpha_1}  \partial r_{\alpha_2} \cdots \partial r_{\alpha_i} } \qquad \qquad \text{where} \quad  \alpha_1, \alpha_2, \cdots, \alpha_i = 1, 2, \cdots , n \ .$$</span><ref group="Note">For example, for the case of three dimensions (<span class="LaTeX">$n = 3$</span>) and second order derivatives (<span class="LaTeX">$i = 2$</span>), the tensor <mtpl></mtpl> has components,</ref></p>
<p><span class="LaTeX">$$\left [ \nabla^{(2)} \right ]_{\alpha \beta} = \frac {\partial^{\,2}} {\partial r_{\alpha} \, \partial r_{\beta}} \qquad \qquad \text{where} \quad \alpha, \beta = 1, 2, 3 \, .$$</span></p>
<p>An analogous application of the definition of the functional derivative yields</p>
<p><span class="LaTeX">$$\begin{align}
\frac{\delta F[\rho]}{\delta \rho} &{} = \frac{\partial f}{\partial\rho} - \nabla \cdot \frac{\partial f}{\partial(\nabla\rho)} + \nabla^{(2)} \cdot \frac{\partial f}{\partial\left(\nabla^{(2)}\rho\right)} + \dots + (-1)^N \nabla^{(N)} \cdot \frac{\partial f}{\partial\left(\nabla^{(N)}\rho\right)} \\
&{} =   \frac{\partial f}{\partial\rho} + \sum_{i=1}^N (-1)^{i}\nabla^{(i)} \cdot \frac{\partial f}{\partial\left(\nabla^{(i)}\rho\right)} \ .
\end{align}$$</span></p>
<p>In the last two equations, the <mtpl></mtpl> components of the tensor <span class="LaTeX">$\frac{\partial f}{\partial\left(\nabla^{(i)}\rho\right)}$</span> are partial derivatives of <span class="LaTeX">$f$</span> with respect to partial derivatives of <em>ρ</em>,</p>
<p><span class="LaTeX">$$\left [ \frac {\partial f} {\partial \left (\nabla^{(i)}\rho \right ) } \right ]_{\alpha_1 \alpha_2 \cdots \alpha_i} = \frac {\partial f} {\partial \rho_{\alpha_1 \alpha_2 \cdots \alpha_i} } \qquad \qquad \text{where} \quad \rho_{\alpha_1 \alpha_2 \cdots \alpha_i} \equiv \frac {\partial^{\, i}\rho} {\partial r_{\alpha_1} \, \partial r_{\alpha_2} \cdots \partial r_{\alpha_i} }   \ ,$$</span></p>
<p>and the tensor scalar product is,</p>
<p><span class="LaTeX">$$\nabla^{(i)} \cdot \frac{\partial f}{\partial\left(\nabla^{(i)}\rho\right)} = \sum_{\alpha_1, \alpha_2, \cdots, \alpha_i = 1}^n \ \frac {\partial^{\, i} } {\partial r_{\alpha_1} \, \partial r_{\alpha_2} \cdots \partial r_{\alpha_i} }  \ \frac {\partial f} {\partial \rho_{\alpha_1 \alpha_2 \cdots \alpha_i} }   \  .$$</span> <ref group="Note">For example, for the case <span class="LaTeX">$n = 3$</span> and <span class="LaTeX">$i = 2$</span>, the tensor scalar product is,</ref></p>
<p><span class="LaTeX">$$\nabla^{(2)} \cdot \frac{\partial f}{\partial\left(\nabla^{(2)}\rho\right)} = \sum_{\alpha, \beta = 1}^3 \ \frac {\partial^{\, 2} } {\partial r_{\alpha} \, \partial r_{\beta} }  \ \frac {\partial f} {\partial \rho_{\alpha \beta} }    \qquad \text{where} \ \ \rho_{\alpha \beta} \equiv \frac {\partial^{\, 2}\rho} {\partial r_{\alpha} \, \partial r_{\beta} } \ .$$</span></p>
<h3 id="examples">Examples</h3>
<h4 id="thomasfermi-kinetic-energy-functional">Thomas–Fermi kinetic energy functional</h4>
<p>The <a href="Thomas–Fermi_model" title="wikilink">Thomas–Fermi model</a> of 1927 used a kinetic energy functional for a noninteracting uniform <a href="free_electron_model" title="wikilink">electron gas</a> in a first attempt of <a href="density-functional_theory" title="wikilink">density-functional theory</a> of electronic structure:</p>
<p><span class="LaTeX">$$T_\mathrm{TF}[\rho] = C_\mathrm{F} \int \rho^{5/3}(\mathbf{r}) \, d\mathbf{r} \, .$$</span> Since the integrand of <mtpl></mtpl>[<em>ρ</em>] does not involve derivatives of <em>ρ</em><span class="LaTeX">$( \mathbf{ r } )$</span>, the functional derivative of <mtpl></mtpl>[<em>ρ</em>] is,<a class="footnoteRef" href="#fn14" id="fnref14"><sup>14</sup></a></p>
<p><span class="LaTeX">$$\begin{align}
\frac{\delta T_{\mathrm{TF}}}{\delta \rho (\boldsymbol{r}) } 
& = C_\mathrm{F} \frac{\partial \rho^{5/3}(\mathbf{r})}{\partial \rho(\mathbf{r})}  \\
& = \frac{5}{3} C_\mathrm{F}  \rho^{2/3}(\mathbf{r}) \, .
\end{align}$$</span></p>
<h4 id="coulomb-potential-energy-functional">Coulomb potential energy functional</h4>
<p>For the <strong>electron-nucleus potential</strong>, Thomas and Fermi employed the <a href="Coulomb's_law" title="wikilink">Coulomb</a> potential energy functional</p>
<p><span class="LaTeX">$$V[\rho] =  \int \frac{\rho(\boldsymbol{r})}{|\boldsymbol{r}|} \ d\boldsymbol{r}.$$</span></p>
<p>Applying the definition of functional derivative,</p>
<p><span class="LaTeX">$$\begin{align}
\int \frac{\delta V}{\delta \rho(\boldsymbol{r})} \ \phi(\boldsymbol{r}) \ d\boldsymbol{r} 
& {} = \left [ \frac{d}{d\varepsilon}  \int \frac{\rho(\boldsymbol{r}) + \varepsilon \phi(\boldsymbol{r})}{|\boldsymbol{r}|} \ d\boldsymbol{r} \right ]_{\varepsilon=0} \\
& {} =  \int  \frac {1} {|\boldsymbol{r}|} \, \phi(\boldsymbol{r}) \ d\boldsymbol{r} \, .
\end{align}$$</span> So,</p>
<p><span class="LaTeX">$$\frac{\delta V}{\delta \rho(\boldsymbol{r})} = \frac{1}{|\boldsymbol{r}|} \ .$$</span></p>
<p>For the classical part of the <strong>electron-electron interaction</strong>, Thomas and Fermi employed the <a href="Coulomb's_law" title="wikilink">Coulomb</a> potential energy functional</p>
<p><span class="LaTeX">$$J[\rho] = \frac{1}{2}\iint \frac{\rho(\mathbf{r}) \rho(\mathbf{r}')}{\vert \mathbf{r}-\mathbf{r}' \vert}\, d\mathbf{r} d\mathbf{r}' \, .$$</span> From the <a href="Functional_derivative#Functional_derivative" title="wikilink">definition of the functional derivative</a>,</p>
<p><span class="LaTeX">$$\begin{align}
\int \frac{\delta J}{\delta\rho(\boldsymbol{r})} \phi(\boldsymbol{r})d\boldsymbol{r}  
& {} = \left [ \frac {d \ }{d\epsilon} \, J[\rho + \epsilon\phi] \right ]_{\epsilon = 0} \\
& {} = \left [ \frac {d \ }{d\epsilon} \, \left ( \frac{1}{2}\iint \frac {[\rho(\boldsymbol{r}) + \epsilon \phi(\boldsymbol{r})] \,  [\rho(\boldsymbol{r}') + \epsilon \phi(\boldsymbol{r}')]  }{\vert \boldsymbol{r}-\boldsymbol{r}' \vert}\, d\boldsymbol{r} d\boldsymbol{r}'  \right ) \right ]_{\epsilon = 0} \\
& {} =  \frac{1}{2}\iint \frac {\rho(\boldsymbol{r}') \phi(\boldsymbol{r})  }{\vert \boldsymbol{r}-\boldsymbol{r}' \vert}\, d\boldsymbol{r} d\boldsymbol{r}' +
            \frac{1}{2}\iint \frac {\rho(\boldsymbol{r}) \phi(\boldsymbol{r}')  }{\vert \boldsymbol{r}-\boldsymbol{r}' \vert}\, d\boldsymbol{r} d\boldsymbol{r}'   \\
\end{align}$$</span> The first and second terms on the right hand side of the last equation are equal, since <span class="LaTeX">$\mathbf{ r } $</span> and <span class="LaTeX">$\mathbf{ r′ } $</span> in the second term can be interchanged without changing the value of the integral. Therefore,</p>
<p><span class="LaTeX">$$\int \frac{\delta J}{\delta\rho(\boldsymbol{r})} \phi(\boldsymbol{r})d\boldsymbol{r} = \int \left ( \int \frac {\rho(\boldsymbol{r}') }{\vert \boldsymbol{r}-\boldsymbol{r}' \vert} d\boldsymbol{r}' \right )  \phi(\boldsymbol{r}) d\boldsymbol{r}$$</span> and the functional derivative of the electron-electron coulomb potential energy functional <span class="LaTeX">$J$</span>[<em>ρ</em>] is,<a class="footnoteRef" href="#fn15" id="fnref15"><sup>15</sup></a></p>
<p><span class="LaTeX">$$\frac{\delta J}{\delta\rho(\boldsymbol{r})} = \int \frac {\rho(\boldsymbol{r}') }{\vert \boldsymbol{r}-\boldsymbol{r}' \vert} d\boldsymbol{r}' \, .$$</span></p>
<p>The second functional derivative is</p>
<p><span class="LaTeX">$$\frac{\delta^2 J[\rho]}{\delta \rho(\mathbf{r}')\delta\rho(\mathbf{r})}  = \frac{\partial}{\partial \rho(\mathbf{r}')} \left ( \frac{\rho(\mathbf{r}')}{\vert \mathbf{r}-\mathbf{r}' \vert} \right ) = \frac{1}{\vert \mathbf{r}-\mathbf{r}' \vert}.$$</span></p>
<h4 id="weizsäcker-kinetic-energy-functional">Weizsäcker kinetic energy functional</h4>
<p>In 1935 <a href="Carl_Friedrich_von_Weizsacker" title="wikilink">von Weizsäcker</a> proposed to add a gradient correction to the Thomas-Fermi kinetic energy functional to make it suit better a molecular electron cloud:</p>
<p><span class="LaTeX">$$T_\mathrm{W}[\rho] = \frac{1}{8} \int \frac{\nabla\rho(\mathbf{r}) \cdot \nabla\rho(\mathbf{r})}{ \rho(\mathbf{r}) } d\mathbf{r} =  \int t_\mathrm{W} \ d\mathbf{r} \, ,$$</span> where</p>
<p><span class="LaTeX">$$t_\mathrm{W} \equiv  \frac{1}{8}  \frac{\nabla\rho \cdot \nabla\rho}{ \rho } \qquad \text{and} \ \ \rho = \rho(\boldsymbol{r}) \ .$$</span> Using a previously derived <a href="Functional_derivative#Formula" title="wikilink">formula</a> for the functional derivative,</p>
<p><span class="LaTeX">$$\begin{align}
\frac{\delta T_\mathrm{W}}{\delta \rho(\boldsymbol{r})} 
& = \frac{\partial t_\mathrm{W}}{\partial \rho} - \nabla\cdot\frac{\partial t_\mathrm{W}}{\partial \nabla \rho} \\
& = -\frac{1}{8}\frac{\nabla\rho \cdot \nabla\rho}{\rho^2} - \left ( \frac {1}{4} \frac {\nabla^2\rho} {\rho} -  \frac {1}{4} \frac {\nabla\rho \cdot \nabla\rho} {\rho^2} \right ) \qquad \text{where} \ \ \nabla^2 = \nabla \cdot \nabla \ ,
\end{align}$$</span> and the result is,<a class="footnoteRef" href="#fn16" id="fnref16"><sup>16</sup></a></p>
<p><span class="LaTeX">$$\frac{\delta T_\mathrm{W}}{\delta \rho(\boldsymbol{r})} =  \ \ \, \frac{1}{8}\frac{\nabla\rho \cdot \nabla\rho}{\rho^2} - \frac{1}{4}\frac{\nabla^2\rho}{\rho} \ .$$</span></p>
<h4 id="entropy">Entropy</h4>
<p>The <a href="information_entropy" title="wikilink">entropy</a> of a discrete <a href="random_variable" title="wikilink">random variable</a> is a functional of the <a href="probability_mass_function" title="wikilink">probability mass function</a>.</p>
<p><span class="LaTeX">$$\begin{align}
H[p(x)] = -\sum_x p(x) \log p(x)
\end{align}$$</span> Thus,</p>
<p><span class="LaTeX">$$\begin{align}
\sum_x \frac{\delta H}{\delta p(x)} \, \phi(x) 
& {} = \left[ \frac{d}{d\epsilon} H[p(x) + \epsilon\phi(x)] \right]_{\epsilon=0}\\
& {} = \left [- \, \frac{d}{d\varepsilon}  \sum_x \, [p(x) + \varepsilon\phi(x)] \ \log [p(x) + \varepsilon\phi(x)] \right]_{\varepsilon=0} \\
& {} = \displaystyle -\sum_x \, [1+\log p(x)] \ \phi(x) \, .
\end{align}$$</span></p>
<p>Thus,</p>
<p><span class="LaTeX">$$\frac{\delta H}{\delta p(x)} = -1-\log p(x).$$</span></p>
<h4 id="exponential">Exponential</h4>
<p>Let</p>
<p><span class="LaTeX">$$F[\varphi(x)]= e^{\int \varphi(x) g(x)dx}.$$</span></p>
<p>Using the delta function as a test function,</p>
<p><span class="LaTeX">$$\begin{align}
\frac{\delta F[\varphi(x)]}{\delta \varphi(y)} 
& {} = \lim_{\varepsilon\to 0}\frac{F[\varphi(x)+\varepsilon\delta(x-y)]-F[\varphi(x)]}{\varepsilon}\\
& {} = \lim_{\varepsilon\to 0}\frac{e^{\int (\varphi(x)+\varepsilon\delta(x-y)) g(x)dx}-e^{\int \varphi(x) g(x)dx}}{\varepsilon}\\
& {} = e^{\int \varphi(x) g(x)dx}\lim_{\varepsilon\to 0}\frac{e^{\varepsilon \int \delta(x-y) g(x)dx}-1}{\varepsilon}\\
& {} = e^{\int \varphi(x) g(x)dx}\lim_{\varepsilon\to 0}\frac{e^{\varepsilon g(y)}-1}{\varepsilon}\\
& {} = e^{\int \varphi(x) g(x)dx}g(y).
\end{align}$$</span></p>
<p>Thus,</p>
<p><span class="LaTeX">$$\frac{\delta F[\varphi(x)]}{\delta \varphi(y)} = g(y) F[\varphi(x)].$$</span></p>
<p>This is particularly useful in calculating the <a href="Correlation_function_(quantum_field_theory)" title="wikilink">correlation functions</a> from the <a href="Partition_function_(quantum_field_theory)" title="wikilink">partition function</a> in <a href="quantum_field_theory" title="wikilink">quantum field theory</a>.</p>
<h4 id="functional-derivative-of-a-function">Functional derivative of a function</h4>
<p>A function can be written in the form of an integral like a functional. For example,</p>
<p><span class="LaTeX">$$\rho(\boldsymbol{r}) = F[\rho] = \int \rho(\boldsymbol{r}') \delta(\boldsymbol{r}-\boldsymbol{r}')\, d\boldsymbol{r}'.$$</span> Since the integrand does not depend on derivatives of <em>ρ</em>, the functional derivative of <em>ρ</em><span class="LaTeX">$( \mathbf{ r } )$</span> is,</p>
<p><span class="LaTeX">$$\begin{align} 
\frac {\delta \rho(\boldsymbol{r})} {\delta\rho(\boldsymbol{r}')} \equiv \frac {\delta F} {\delta\rho(\boldsymbol{r}')} 
& = \frac{\partial \ \ }{\partial \rho(\boldsymbol{r}')} \, [\rho(\boldsymbol{r}') \delta(\boldsymbol{r}-\boldsymbol{r}')] \\
& = \delta(\boldsymbol{r}-\boldsymbol{r}').
\end{align}$$</span></p>
<h2 id="using-the-delta-function-as-a-test-function">Using the delta function as a test function</h2>
<p>In physics, it's common to use the <a href="Dirac_delta_function" title="wikilink">Dirac delta function</a> <span class="LaTeX">$\delta(x-y)$</span> in place of a generic test function <span class="LaTeX">$\phi(x)$</span>, for yielding the functional derivative at the point <span class="LaTeX">$y$</span> (this is a point of the whole functional derivative as a <a href="partial_derivative" title="wikilink">partial derivative</a> is a component of the gradient):<a class="footnoteRef" href="#fn17" id="fnref17"><sup>17</sup></a></p>
<p><span class="LaTeX">$$\frac{\delta F[\rho(x)]}{\delta \rho(y)}=\lim_{\varepsilon\to 0}\frac{F[\rho(x)+\varepsilon\delta(x-y)]-F[\rho(x)]}{\varepsilon}.$$</span></p>
<p>This works in cases when <span class="LaTeX">$F[\rho(x)+\varepsilon f(x)]$</span> formally can be expanded as a series (or at least up to first order) in <span class="LaTeX">$\varepsilon$</span>. The formula is however not mathematically rigorous, since <span class="LaTeX">$F[\rho(x)+\varepsilon\delta(x-y)]$</span> is usually not even defined.</p>
<p>The definition given in a previous section is based on a relationship that holds for all test functions <span class="LaTeX">$ϕ$</span>, so one might think that it should hold also when <span class="LaTeX">$ϕ$</span> is chosen to be a specific function such as the <a href="Dirac_delta_function" title="wikilink">delta function</a>. However, the latter is not a valid test function.</p>
<p>In the definition, the functional derivative describes how the functional <span class="LaTeX">$F[\varphi(x)]$</span> changes as a result of a small change in the entire function <span class="LaTeX">$\varphi(x)$</span>. The particular form of the change in <span class="LaTeX">$\varphi(x)$</span> is not specified, but it should stretch over the whole interval on which <span class="LaTeX">$x$</span> is defined. Employing the particular form of the perturbation given by the delta function has the meaning that <span class="LaTeX">$\varphi(x)$</span> is varied only in the point <span class="LaTeX">$y$</span>. Except for this point, there is no variation in <span class="LaTeX">$\varphi(x)$</span>.</p>
<h2 id="notes">Notes</h2>
<h2 id="footnotes">Footnotes</h2>
<h2 id="references">References</h2>
<ul>
<li>
<p>.</p></li>
<li>
<p>.</p></li>
<li>
<p>.</p></li>
<li>
<p>.</p></li>
<li>
<p>.</p></li>
<li></li>
</ul>
<h2 id="external-links">External links</h2>
<ul>
<li></li>
</ul>
<p>"</p>
<p><a href="Category:Differential_calculus" title="wikilink">Category:Differential calculus</a> <a href="Category:Topological_vector_spaces" title="wikilink">Category:Topological vector spaces</a> <a href="Category:Differential_operators" title="wikilink">Category:Differential operators</a> <a href="Category:Calculus_of_variations" title="wikilink">Category:Calculus of variations</a> <a href="Category:Variational_analysis" title="wikilink">Category:Variational analysis</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1"><a href="#fnref1">↩</a></li>
<li id="fn2"></li>
<li id="fn3">According to , this notation is customary in <a href="Physics" title="wikilink">physical</a> literature.<a href="#fnref3">↩</a></li>
<li id="fn4">.<a href="#fnref4">↩</a></li>
<li id="fn5"><a href="#fnref5">↩</a></li>
<li id="fn6">.<a href="#fnref6">↩</a></li>
<li id="fn7">.<a href="#fnref7">↩</a></li>
<li id="fn8">Called <em>differential</em> in , <em>variation</em> or <em>first variation</em> in , and <em>variation</em> or <em>differential</em> in .<a href="#fnref8">↩</a></li>
<li id="fn9"></li>
<li id="fn10">.<a href="#fnref10">↩</a></li>
<li id="fn11">.<a href="#fnref11">↩</a></li>
<li id="fn12">.<a href="#fnref12">↩</a></li>
<li id="fn13">.<a href="#fnref13">↩</a></li>
<li id="fn14">.<a href="#fnref14">↩</a></li>
<li id="fn15">.<a href="#fnref15">↩</a></li>
<li id="fn16">.<a href="#fnref16">↩</a></li>
<li id="fn17"><a href="#fnref17">↩</a></li>
</ol>
</section>
</div></dd></dl></body>
</html>

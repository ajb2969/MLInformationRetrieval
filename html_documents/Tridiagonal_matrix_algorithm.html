<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="1067">Tridiagonal matrix algorithm</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Tridiagonal matrix algorithm</h1>
<style>
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
<style>
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
  </style>
</body></html>
<body>
<hr/>

<p>In <a href="numerical_linear_algebra" title="wikilink">numerical linear algebra</a>, the <strong>tridiagonal matrix algorithm</strong>, also known as the <strong>Thomas algorithm</strong> (named after <a href="Llewellyn_Thomas" title="wikilink">Llewellyn Thomas</a>), is a simplified form of <a href="Gaussian_elimination" title="wikilink">Gaussian elimination</a> that can be used to solve <a href="Tridiagonal_matrix" title="wikilink">tridiagonal systems of equations</a>. A tridiagonal system for <em>n</em> unknowns may be written as</p>

<p>

<math display="block" id="Tridiagonal_matrix_algorithm:0">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mrow>
      <msub>
       <mi>a</mi>
       <mi>i</mi>
      </msub>
      <msub>
       <mi>x</mi>
       <mrow>
        <mi>i</mi>
        <mo>-</mo>
        <mn>1</mn>
       </mrow>
      </msub>
     </mrow>
     <mo>+</mo>
     <mrow>
      <msub>
       <mi>b</mi>
       <mi>i</mi>
      </msub>
      <msub>
       <mi>x</mi>
       <mi>i</mi>
      </msub>
     </mrow>
     <mo>+</mo>
     <mrow>
      <msub>
       <mi>c</mi>
       <mi>i</mi>
      </msub>
      <msub>
       <mi>x</mi>
       <mrow>
        <mi>i</mi>
        <mo>+</mo>
        <mn>1</mn>
       </mrow>
      </msub>
     </mrow>
    </mrow>
    <mo>=</mo>
    <msub>
     <mi>d</mi>
     <mi>i</mi>
    </msub>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>a</ci>
       <ci>i</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <apply>
        <minus></minus>
        <ci>i</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>b</ci>
       <ci>i</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <ci>i</ci>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>c</ci>
       <ci>i</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <apply>
        <plus></plus>
        <ci>i</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>d</ci>
     <ci>i</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a_{i}x_{i-1}+b_{i}x_{i}+c_{i}x_{i+1}=d_{i},\,\!
  </annotation>
 </semantics>
</math>

 where 

<math display="inline" id="Tridiagonal_matrix_algorithm:1">
 <semantics>
  <mrow>
   <msub>
    <mi>a</mi>
    <mn>1</mn>
   </msub>
   <mo>=</mo>
   <mpadded width="+1.7pt">
    <mn>0</mn>
   </mpadded>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>a</ci>
     <cn type="integer">1</cn>
    </apply>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a_{1}=0\,
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Tridiagonal_matrix_algorithm:2">
 <semantics>
  <mrow>
   <msub>
    <mi>c</mi>
    <mi>n</mi>
   </msub>
   <mo>=</mo>
   <mpadded width="+1.7pt">
    <mn>0</mn>
   </mpadded>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>c</ci>
     <ci>n</ci>
    </apply>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   c_{n}=0\,
  </annotation>
 </semantics>
</math>

.</p>

<p>

<math display="block" id="Tridiagonal_matrix_algorithm:3">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mrow>
      <mo>[</mo>
      <mtable displaystyle="true">
       <mtr>
        <mtd columnalign="center">
         <msub>
          <mi>b</mi>
          <mn>1</mn>
         </msub>
        </mtd>
        <mtd columnalign="center">
         <msub>
          <mi>c</mi>
          <mn>1</mn>
         </msub>
        </mtd>
        <mtd columnalign="center">
         <mi></mi>
        </mtd>
        <mtd columnalign="center">
         <mi></mi>
        </mtd>
        <mtd columnalign="center">
         <mn>0</mn>
        </mtd>
       </mtr>
       <mtr>
        <mtd columnalign="center">
         <msub>
          <mi>a</mi>
          <mn>2</mn>
         </msub>
        </mtd>
        <mtd columnalign="center">
         <msub>
          <mi>b</mi>
          <mn>2</mn>
         </msub>
        </mtd>
        <mtd columnalign="center">
         <msub>
          <mi>c</mi>
          <mn>2</mn>
         </msub>
        </mtd>
        <mtd columnalign="center">
         <mi></mi>
        </mtd>
        <mtd columnalign="center">
         <mi></mi>
        </mtd>
       </mtr>
       <mtr>
        <mtd columnalign="center">
         <mi></mi>
        </mtd>
        <mtd columnalign="center">
         <msub>
          <mi>a</mi>
          <mn>3</mn>
         </msub>
        </mtd>
        <mtd columnalign="center">
         <msub>
          <mi>b</mi>
          <mn>3</mn>
         </msub>
        </mtd>
        <mtd columnalign="center">
         <mi mathvariant="normal">⋱</mi>
        </mtd>
        <mtd columnalign="center">
         <mi></mi>
        </mtd>
       </mtr>
       <mtr>
        <mtd columnalign="center">
         <mi></mi>
        </mtd>
        <mtd columnalign="center">
         <mi></mi>
        </mtd>
        <mtd columnalign="center">
         <mi mathvariant="normal">⋱</mi>
        </mtd>
        <mtd columnalign="center">
         <mi mathvariant="normal">⋱</mi>
        </mtd>
        <mtd columnalign="center">
         <msub>
          <mi>c</mi>
          <mrow>
           <mi>n</mi>
           <mo>-</mo>
           <mn>1</mn>
          </mrow>
         </msub>
        </mtd>
       </mtr>
       <mtr>
        <mtd columnalign="center">
         <mn>0</mn>
        </mtd>
        <mtd columnalign="center">
         <mi></mi>
        </mtd>
        <mtd columnalign="center">
         <mi></mi>
        </mtd>
        <mtd columnalign="center">
         <msub>
          <mi>a</mi>
          <mi>n</mi>
         </msub>
        </mtd>
        <mtd columnalign="center">
         <msub>
          <mi>b</mi>
          <mi>n</mi>
         </msub>
        </mtd>
       </mtr>
      </mtable>
      <mo>]</mo>
     </mrow>
     <mrow>
      <mo>[</mo>
      <mtable displaystyle="true">
       <mtr>
        <mtd columnalign="center">
         <msub>
          <mi>x</mi>
          <mn>1</mn>
         </msub>
        </mtd>
       </mtr>
       <mtr>
        <mtd columnalign="center">
         <msub>
          <mi>x</mi>
          <mn>2</mn>
         </msub>
        </mtd>
       </mtr>
       <mtr>
        <mtd columnalign="center">
         <msub>
          <mi>x</mi>
          <mn>3</mn>
         </msub>
        </mtd>
       </mtr>
       <mtr>
        <mtd columnalign="center">
         <mi mathvariant="normal">⋮</mi>
        </mtd>
       </mtr>
       <mtr>
        <mtd columnalign="center">
         <msub>
          <mi>x</mi>
          <mi>n</mi>
         </msub>
        </mtd>
       </mtr>
      </mtable>
      <mo>]</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mo>[</mo>
     <mtable displaystyle="true">
      <mtr>
       <mtd columnalign="center">
        <msub>
         <mi>d</mi>
         <mn>1</mn>
        </msub>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <msub>
         <mi>d</mi>
         <mn>2</mn>
        </msub>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <msub>
         <mi>d</mi>
         <mn>3</mn>
        </msub>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mi mathvariant="normal">⋮</mi>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <msub>
         <mi>d</mi>
         <mi>n</mi>
        </msub>
       </mtd>
      </mtr>
     </mtable>
     <mo>]</mo>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <matrix>
      <matrixrow>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>b</ci>
        <cn type="integer">1</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>c</ci>
        <cn type="integer">1</cn>
       </apply>
       <csymbol cd="latexml">absent</csymbol>
       <csymbol cd="latexml">absent</csymbol>
       <cn type="integer">0</cn>
      </matrixrow>
      <matrixrow>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>a</ci>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>b</ci>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>c</ci>
        <cn type="integer">2</cn>
       </apply>
       <csymbol cd="latexml">absent</csymbol>
       <csymbol cd="latexml">absent</csymbol>
      </matrixrow>
      <matrixrow>
       <csymbol cd="latexml">absent</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>a</ci>
        <cn type="integer">3</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>b</ci>
        <cn type="integer">3</cn>
       </apply>
       <ci>normal-⋱</ci>
       <csymbol cd="latexml">absent</csymbol>
      </matrixrow>
      <matrixrow>
       <csymbol cd="latexml">absent</csymbol>
       <csymbol cd="latexml">absent</csymbol>
       <ci>normal-⋱</ci>
       <ci>normal-⋱</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>c</ci>
        <apply>
         <minus></minus>
         <ci>n</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
      </matrixrow>
      <matrixrow>
       <cn type="integer">0</cn>
       <csymbol cd="latexml">absent</csymbol>
       <csymbol cd="latexml">absent</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>a</ci>
        <ci>n</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>b</ci>
        <ci>n</ci>
       </apply>
      </matrixrow>
     </matrix>
     <matrix>
      <matrixrow>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <cn type="integer">1</cn>
       </apply>
      </matrixrow>
      <matrixrow>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <cn type="integer">2</cn>
       </apply>
      </matrixrow>
      <matrixrow>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <cn type="integer">3</cn>
       </apply>
      </matrixrow>
      <matrixrow>
       <ci>normal-⋮</ci>
      </matrixrow>
      <matrixrow>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <ci>n</ci>
       </apply>
      </matrixrow>
     </matrix>
    </apply>
    <matrix>
     <matrixrow>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>d</ci>
       <cn type="integer">1</cn>
      </apply>
     </matrixrow>
     <matrixrow>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>d</ci>
       <cn type="integer">2</cn>
      </apply>
     </matrixrow>
     <matrixrow>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>d</ci>
       <cn type="integer">3</cn>
      </apply>
     </matrixrow>
     <matrixrow>
      <ci>normal-⋮</ci>
     </matrixrow>
     <matrixrow>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>d</ci>
       <ci>n</ci>
      </apply>
     </matrixrow>
    </matrix>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \begin{bmatrix}{b_{1}}&{c_{1}}&&&{0}\\
{a_{2}}&{b_{2}}&{c_{2}}&&\\
&{a_{3}}&{b_{3}}&\ddots&\\
&&\ddots&\ddots&{c_{n-1}}\\
{0}&&&{a_{n}}&{b_{n}}\\
\end{bmatrix}\begin{bmatrix}{x_{1}}\\
{x_{2}}\\
{x_{3}}\\
\vdots\\
{x_{n}}\\
\end{bmatrix}=\begin{bmatrix}{d_{1}}\\
{d_{2}}\\
{d_{3}}\\
\vdots\\
{d_{n}}\\
\end{bmatrix}.
  </annotation>
 </semantics>
</math>

</p>

<p>For such systems, the solution can be obtained in 

<math display="inline" id="Tridiagonal_matrix_algorithm:4">
 <semantics>
  <mrow>
   <mi>O</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>n</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>O</ci>
    <ci>n</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   O(n)
  </annotation>
 </semantics>
</math>

 operations instead of 

<math display="inline" id="Tridiagonal_matrix_algorithm:5">
 <semantics>
  <mrow>
   <mi>O</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msup>
     <mi>n</mi>
     <mn>3</mn>
    </msup>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>O</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>n</ci>
     <cn type="integer">3</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   O(n^{3})
  </annotation>
 </semantics>
</math>

 required by <a href="Gaussian_elimination" title="wikilink">Gaussian elimination</a>. A first sweep eliminates the 

<math display="inline" id="Tridiagonal_matrix_algorithm:6">
 <semantics>
  <msub>
   <mi>a</mi>
   <mi>i</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>a</ci>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a_{i}
  </annotation>
 </semantics>
</math>

's, and then an (abbreviated) backward substitution produces the solution. Examples of such matrices commonly arise from the discretization of 1D <a href="Poisson_equation" title="wikilink">Poisson equation</a> (e.g., the 1D <a href="Heat_equation" title="wikilink">diffusion problem</a>) and natural cubic <a href="spline_interpolation" title="wikilink">spline interpolation</a>; similar systems of matrices arise in <a href="tight_binding" title="wikilink">tight binding physics</a> or <a href="nearest_neighbor" title="wikilink">nearest neighbor</a> effects models.</p>

<p>Thomas' algorithm is not <a href="numerical_stability" title="wikilink">stable</a> in general, but is so in several special cases, such as when the matrix is <a href="diagonally_dominant" title="wikilink">diagonally dominant</a> or <a href="symmetric_positive_definite" title="wikilink">symmetric positive definite</a>;<a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a><a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a> for a more precise characterization of stability of Thomas' algorithm, see Higham Theorem 9.12.<a class="footnoteRef" href="#fn3" id="fnref3"><sup>3</sup></a> If stability is required in the general case, <a href="Gaussian_elimination" title="wikilink">Gaussian elimination</a> with <a href="partial_pivoting" title="wikilink">partial pivoting</a> (GEPP) is recommended instead.<a class="footnoteRef" href="#fn4" id="fnref4"><sup>4</sup></a></p>
<h2 id="method">Method</h2>

<p>The forward sweep consists of modifying the coefficients as follows, denoting the new modified coefficients with primes:</p>

<p>

<math display="block" id="Tridiagonal_matrix_algorithm:7">
 <semantics>
  <mrow>
   <msubsup>
    <mi>c</mi>
    <mi>i</mi>
    <mo>′</mo>
   </msubsup>
   <mo>=</mo>
   <mpadded width="+1.7pt">
    <mrow>
     <mo>{</mo>
     <mtable displaystyle="true">
      <mtr>
       <mtd columnalign="left">
        <mtable displaystyle="true">
         <mtr>
          <mtd columnalign="left">
           <mfrac>
            <msub>
             <mi>c</mi>
             <mi>i</mi>
            </msub>
            <msub>
             <mi>b</mi>
             <mi>i</mi>
            </msub>
           </mfrac>
          </mtd>
          <mtd columnalign="center">
           <mrow>
            <mi></mi>
            <mo>;</mo>
           </mrow>
          </mtd>
          <mtd columnalign="left">
           <mrow>
            <mi>i</mi>
            <mo>=</mo>
            <mn>1</mn>
           </mrow>
          </mtd>
         </mtr>
         <mtr>
          <mtd columnalign="left">
           <mfrac>
            <msub>
             <mi>c</mi>
             <mi>i</mi>
            </msub>
            <mrow>
             <msub>
              <mi>b</mi>
              <mi>i</mi>
             </msub>
             <mo>-</mo>
             <mrow>
              <msub>
               <mi>a</mi>
               <mi>i</mi>
              </msub>
              <msubsup>
               <mi>c</mi>
               <mrow>
                <mi>i</mi>
                <mo>-</mo>
                <mn>1</mn>
               </mrow>
               <mo>′</mo>
              </msubsup>
             </mrow>
            </mrow>
           </mfrac>
          </mtd>
          <mtd columnalign="center">
           <mrow>
            <mi></mi>
            <mo>;</mo>
           </mrow>
          </mtd>
          <mtd columnalign="left">
           <mrow>
            <mi>i</mi>
            <mo>=</mo>
            <mrow>
             <mn>2</mn>
             <mo>,</mo>
             <mn>3</mn>
             <mo>,</mo>
             <mi mathvariant="normal">…</mi>
             <mo>,</mo>
             <mrow>
              <mi>n</mi>
              <mo>-</mo>
              <mn>1</mn>
             </mrow>
            </mrow>
           </mrow>
          </mtd>
         </mtr>
        </mtable>
       </mtd>
       <mtd></mtd>
      </mtr>
     </mtable>
    </mrow>
   </mpadded>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>c</ci>
      <ci>normal-′</ci>
     </apply>
     <ci>i</ci>
    </apply>
    <apply>
     <csymbol cd="latexml">cases</csymbol>
     <matrix>
      <matrixrow>
       <apply>
        <csymbol cd="latexml">continued-fraction</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>c</ci>
         <ci>i</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>b</ci>
         <ci>i</ci>
        </apply>
       </apply>
       <csymbol cd="latexml">absent</csymbol>
       <apply>
        <eq></eq>
        <ci>i</ci>
        <cn type="integer">1</cn>
       </apply>
      </matrixrow>
      <matrixrow>
       <apply>
        <csymbol cd="latexml">continued-fraction</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>c</ci>
         <ci>i</ci>
        </apply>
        <apply>
         <minus></minus>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>b</ci>
          <ci>i</ci>
         </apply>
         <apply>
          <times></times>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>a</ci>
           <ci>i</ci>
          </apply>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <apply>
            <csymbol cd="ambiguous">superscript</csymbol>
            <ci>c</ci>
            <ci>normal-′</ci>
           </apply>
           <apply>
            <minus></minus>
            <ci>i</ci>
            <cn type="integer">1</cn>
           </apply>
          </apply>
         </apply>
        </apply>
       </apply>
       <csymbol cd="latexml">absent</csymbol>
       <apply>
        <eq></eq>
        <ci>i</ci>
        <list>
         <cn type="integer">2</cn>
         <cn type="integer">3</cn>
         <ci>normal-…</ci>
         <apply>
          <minus></minus>
          <ci>n</ci>
          <cn type="integer">1</cn>
         </apply>
        </list>
       </apply>
      </matrixrow>
     </matrix>
     <mtext>otherwise</mtext>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   c^{\prime}_{i}=\begin{cases}\begin{array}[]{lcl}\cfrac{c_{i}}{b_{i}}&;&i=1\\
\cfrac{c_{i}}{b_{i}-a_{i}c^{\prime}_{i-1}}&;&i=2,3,\dots,n-1\\
\end{array}\end{cases}\,
  </annotation>
 </semantics>
</math>

</p>

<p>and</p>

<p>

<math display="block" id="Tridiagonal_matrix_algorithm:8">
 <semantics>
  <mrow>
   <msubsup>
    <mi>d</mi>
    <mi>i</mi>
    <mo>′</mo>
   </msubsup>
   <mo>=</mo>
   <mpadded width="+1.7pt">
    <mrow>
     <mo>{</mo>
     <mtable displaystyle="true">
      <mtr>
       <mtd columnalign="left">
        <mtable displaystyle="true">
         <mtr>
          <mtd columnalign="left">
           <mfrac>
            <msub>
             <mi>d</mi>
             <mi>i</mi>
            </msub>
            <msub>
             <mi>b</mi>
             <mi>i</mi>
            </msub>
           </mfrac>
          </mtd>
          <mtd columnalign="center">
           <mrow>
            <mi></mi>
            <mo>;</mo>
           </mrow>
          </mtd>
          <mtd columnalign="left">
           <mrow>
            <mi>i</mi>
            <mo>=</mo>
            <mn>1</mn>
           </mrow>
          </mtd>
         </mtr>
         <mtr>
          <mtd columnalign="left">
           <mfrac>
            <mrow>
             <msub>
              <mi>d</mi>
              <mi>i</mi>
             </msub>
             <mo>-</mo>
             <mrow>
              <msub>
               <mi>a</mi>
               <mi>i</mi>
              </msub>
              <msubsup>
               <mi>d</mi>
               <mrow>
                <mi>i</mi>
                <mo>-</mo>
                <mn>1</mn>
               </mrow>
               <mo>′</mo>
              </msubsup>
             </mrow>
            </mrow>
            <mrow>
             <msub>
              <mi>b</mi>
              <mi>i</mi>
             </msub>
             <mo>-</mo>
             <mrow>
              <msub>
               <mi>a</mi>
               <mi>i</mi>
              </msub>
              <msubsup>
               <mi>c</mi>
               <mrow>
                <mi>i</mi>
                <mo>-</mo>
                <mn>1</mn>
               </mrow>
               <mo>′</mo>
              </msubsup>
             </mrow>
            </mrow>
           </mfrac>
          </mtd>
          <mtd columnalign="center">
           <mrow>
            <mi></mi>
            <mo>;</mo>
           </mrow>
          </mtd>
          <mtd columnalign="left">
           <mrow>
            <mrow>
             <mi>i</mi>
             <mo>=</mo>
             <mrow>
              <mn>2</mn>
              <mo>,</mo>
              <mn>3</mn>
              <mo>,</mo>
              <mi mathvariant="normal">…</mi>
              <mo>,</mo>
              <mi>n</mi>
             </mrow>
            </mrow>
            <mo>.</mo>
           </mrow>
          </mtd>
         </mtr>
        </mtable>
       </mtd>
       <mtd></mtd>
      </mtr>
     </mtable>
    </mrow>
   </mpadded>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>d</ci>
      <ci>normal-′</ci>
     </apply>
     <ci>i</ci>
    </apply>
    <apply>
     <csymbol cd="latexml">cases</csymbol>
     <matrix>
      <matrixrow>
       <apply>
        <csymbol cd="latexml">continued-fraction</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>d</ci>
         <ci>i</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>b</ci>
         <ci>i</ci>
        </apply>
       </apply>
       <csymbol cd="latexml">absent</csymbol>
       <apply>
        <eq></eq>
        <ci>i</ci>
        <cn type="integer">1</cn>
       </apply>
      </matrixrow>
      <matrixrow>
       <apply>
        <csymbol cd="latexml">continued-fraction</csymbol>
        <apply>
         <minus></minus>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>d</ci>
          <ci>i</ci>
         </apply>
         <apply>
          <times></times>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>a</ci>
           <ci>i</ci>
          </apply>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <apply>
            <csymbol cd="ambiguous">superscript</csymbol>
            <ci>d</ci>
            <ci>normal-′</ci>
           </apply>
           <apply>
            <minus></minus>
            <ci>i</ci>
            <cn type="integer">1</cn>
           </apply>
          </apply>
         </apply>
        </apply>
        <apply>
         <minus></minus>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>b</ci>
          <ci>i</ci>
         </apply>
         <apply>
          <times></times>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>a</ci>
           <ci>i</ci>
          </apply>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <apply>
            <csymbol cd="ambiguous">superscript</csymbol>
            <ci>c</ci>
            <ci>normal-′</ci>
           </apply>
           <apply>
            <minus></minus>
            <ci>i</ci>
            <cn type="integer">1</cn>
           </apply>
          </apply>
         </apply>
        </apply>
       </apply>
       <csymbol cd="latexml">absent</csymbol>
       <apply>
        <eq></eq>
        <ci>i</ci>
        <list>
         <cn type="integer">2</cn>
         <cn type="integer">3</cn>
         <ci>normal-…</ci>
         <ci>n</ci>
        </list>
       </apply>
      </matrixrow>
     </matrix>
     <mtext>otherwise</mtext>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   d^{\prime}_{i}=\begin{cases}\begin{array}[]{lcl}\cfrac{d_{i}}{b_{i}}&;&i=1\\
\cfrac{d_{i}-a_{i}d^{\prime}_{i-1}}{b_{i}-a_{i}c^{\prime}_{i-1}}&;&i=2,3,\dots%
,n.\\
\end{array}\end{cases}\,
  </annotation>
 </semantics>
</math>

</p>

<p>The solution is then obtained by back substitution:</p>

<p>

<math display="block" id="Tridiagonal_matrix_algorithm:9">
 <semantics>
  <mrow>
   <msub>
    <mi>x</mi>
    <mi>n</mi>
   </msub>
   <mo>=</mo>
   <mpadded width="+1.7pt">
    <msubsup>
     <mi>d</mi>
     <mi>n</mi>
     <mo>′</mo>
    </msubsup>
   </mpadded>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>x</ci>
     <ci>n</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>d</ci>
      <ci>normal-′</ci>
     </apply>
     <ci>n</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x_{n}=d^{\prime}_{n}\,
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Tridiagonal_matrix_algorithm:10">
 <semantics>
  <mrow>
   <msub>
    <mi>x</mi>
    <mi>i</mi>
   </msub>
   <mo>=</mo>
   <msubsup>
    <mi>d</mi>
    <mi>i</mi>
    <mo>′</mo>
   </msubsup>
   <mo>-</mo>
   <msubsup>
    <mi>c</mi>
    <mi>i</mi>
    <mo>′</mo>
   </msubsup>
   <msub>
    <mi>x</mi>
    <mrow>
     <mi>i</mi>
     <mo>+</mo>
     <mn>1</mn>
    </mrow>
   </msub>
   <mo rspace="7.5pt">;</mo>
   <mi>i</mi>
   <mo>=</mo>
   <mi>n</mi>
   <mo>-</mo>
   <mn>1</mn>
   <mo>,</mo>
   <mi>n</mi>
   <mo>-</mo>
   <mn>2</mn>
   <mo>,</mo>
   <mi mathvariant="normal">…</mi>
   <mo>,</mo>
   <mn>1.</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>x</ci>
     <ci>i</ci>
    </apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>d</ci>
      <ci>normal-′</ci>
     </apply>
     <ci>i</ci>
    </apply>
    <minus></minus>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>c</ci>
      <ci>normal-′</ci>
     </apply>
     <ci>i</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>x</ci>
     <apply>
      <plus></plus>
      <ci>i</ci>
      <cn type="integer">1</cn>
     </apply>
    </apply>
    <ci>italic-</ci>
    <ci>normal-;</ci>
    <csymbol cd="unknown">i</csymbol>
    <eq></eq>
    <csymbol cd="unknown">n</csymbol>
    <minus></minus>
    <cn type="integer">1</cn>
    <ci>normal-,</ci>
    <csymbol cd="unknown">n</csymbol>
    <minus></minus>
    <cn type="integer">2</cn>
    <ci>normal-,</ci>
    <ci>normal-…</ci>
    <ci>normal-,</ci>
    <cn type="float">1.</cn>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x_{i}=d^{\prime}_{i}-c^{\prime}_{i}x_{i+1}\qquad;\ i=n-1,n-2,\ldots,1.
  </annotation>
 </semantics>
</math>

</p>
<h2 id="algorithm-programmatic">Algorithm (programmatic)</h2>

<p>The following is an example of the implementation of this algorithm in the C programming language.</p>
<div class="sourceCode"><pre class="sourceCode c"><code class="sourceCode c"><span class="co">/*</span>
<span class="co">* tridiagonal: Thomas' algorithm implementation</span>
<span class="co">*Inputs: a,b,c are L,D,U vectors respectively</span>
<span class="co">*        d is coefficient vector; is overwritten with solution vector</span>
<span class="co">*        len is length of b et d</span>
<span class="co">*Outputs: Returns 0 (if you want to signal an error at some point, return something else)</span>
<span class="co">*         As above, d is overwritten with answer vector.</span>
<span class="co">*         a,b also modified.</span>
<span class="co">*Note: For simplicity's sake b is overwritten with successive denominators (see Method above);</span>
<span class="co">*      it isn't hard to change this if you so wish</span>
<span class="co">*Note 2: We don't check for diagonal dominance, etc.; </span>
<span class="co">*        this is not guaranteed stable</span>
<span class="co">*/</span>
<span class="dt">int</span> tridiagonal (<span class="dt">double</span> *c, <span class="dt">double</span> *b, <span class="dt">double</span> *a, <span class="dt">double</span> *d, <span class="dt">int</span> len)
{
    <span class="dt">int</span> i;
    
   <span class="co">/*Forward sweep*/</span>
    *a /= *b;
    <span class="kw">for</span>(i=<span class="dv">1</span>;i<len<span class="dv">-1</len<span></code></pre></div></body>;i++) *backward=<span class="st">""</span> -=<span class="st">"(d[i-1]*a[i-1]);"</span> ==<span class="st">""</span> =b[i];=<span class="st">""</span> a[i]=<span class="st">""</span> b[i]=<span class="st">""</span> b[len<span class="dv">-1</span>]=<span class="st">""</span> b[len<span class="dv">-1</span>];=<span class="st">""</span> d[i]=<span class="st">""</span> d[len<span class="dv">-1</span>]=<span class="st">""</span> <span class="kw">for</span>(i=<span class="st">"len-2;i"</span> sweep*=<span class="st">""</span> {=<span class="st">""</span> }=<span class="st">""</span>&gt;=<span class="dv">0</span>;i--)
    {
        d[i] -= (d[i<span class="dv">+1</span>]*c[i]);
        d[i] /= b[i];
    }
    <span class="kw">return</span> <span class="dv">0</span>;
    
}
-1;i++)&gt;
<h2 id="derivation">Derivation</h2>

<p>The derivation of the tridiagonal matrix algorithm involves manually performing some specialized <a href="Gaussian_elimination" title="wikilink">Gaussian elimination</a> in a generic manner.</p>

<p>Suppose that the unknowns are 

<math display="inline" id="Tridiagonal_matrix_algorithm:11">
 <semantics>
  <mrow>
   <msub>
    <mi>x</mi>
    <mn>1</mn>
   </msub>
   <mo>,</mo>
   <mi mathvariant="normal">…</mi>
   <mo>,</mo>
   <msub>
    <mi>x</mi>
    <mi>n</mi>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <list>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>x</ci>
     <cn type="integer">1</cn>
    </apply>
    <ci>normal-…</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>x</ci>
     <ci>n</ci>
    </apply>
   </list>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x_{1},\ldots,x_{n}
  </annotation>
 </semantics>
</math>

, and that the equations to be solved are:</p>

<p>

<math display="inline" id="Tridiagonal_matrix_algorithm:12">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>b</mi>
     <mn>1</mn>
    </msub>
    <msub>
     <mi>x</mi>
     <mn>1</mn>
    </msub>
   </mrow>
   <mo>+</mo>
   <mrow>
    <msub>
     <mi>c</mi>
     <mn>1</mn>
    </msub>
    <msub>
     <mi>x</mi>
     <mn>2</mn>
    </msub>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <plus></plus>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>b</ci>
      <cn type="integer">1</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <cn type="integer">1</cn>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>c</ci>
      <cn type="integer">1</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <cn type="integer">2</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle b_{1}x_{1}+c_{1}x_{2}
  </annotation>
 </semantics>
</math>


</p>

<p>Consider modifying the second (

<math display="inline" id="Tridiagonal_matrix_algorithm:13">
 <semantics>
  <mrow>
   <mi>i</mi>
   <mo>=</mo>
   <mn>2</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>i</ci>
    <cn type="integer">2</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   i=2
  </annotation>
 </semantics>
</math>

) equation with the first equation as follows:</p>

<p>

<math display="block" id="Tridiagonal_matrix_algorithm:14">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mo stretchy="false">(</mo>
     <mtext>equation 2</mtext>
     <mo stretchy="false">)</mo>
    </mrow>
    <mo>⋅</mo>
    <msub>
     <mi>b</mi>
     <mn>1</mn>
    </msub>
   </mrow>
   <mo>-</mo>
   <mrow>
    <mrow>
     <mo stretchy="false">(</mo>
     <mtext>equation 1</mtext>
     <mo stretchy="false">)</mo>
    </mrow>
    <mo>⋅</mo>
    <msub>
     <mi>a</mi>
     <mn>2</mn>
    </msub>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <minus></minus>
    <apply>
     <ci>normal-⋅</ci>
     <mtext>equation 2</mtext>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>b</ci>
      <cn type="integer">1</cn>
     </apply>
    </apply>
    <apply>
     <ci>normal-⋅</ci>
     <mtext>equation 1</mtext>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>a</ci>
      <cn type="integer">2</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (\mbox{equation 2})\cdot b_{1}-(\mbox{equation 1})\cdot a_{2}
  </annotation>
 </semantics>
</math>

</p>

<p>which would give:</p>

<p>

<math display="block" id="Tridiagonal_matrix_algorithm:15">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mrow>
        <msub>
         <mi>a</mi>
         <mn>2</mn>
        </msub>
        <msub>
         <mi>x</mi>
         <mn>1</mn>
        </msub>
       </mrow>
       <mo>+</mo>
       <mrow>
        <msub>
         <mi>b</mi>
         <mn>2</mn>
        </msub>
        <msub>
         <mi>x</mi>
         <mn>2</mn>
        </msub>
       </mrow>
       <mo>+</mo>
       <mrow>
        <msub>
         <mi>c</mi>
         <mn>2</mn>
        </msub>
        <msub>
         <mi>x</mi>
         <mn>3</mn>
        </msub>
       </mrow>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <msub>
      <mi>b</mi>
      <mn>1</mn>
     </msub>
    </mrow>
    <mo>-</mo>
    <mrow>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mrow>
        <msub>
         <mi>b</mi>
         <mn>1</mn>
        </msub>
        <msub>
         <mi>x</mi>
         <mn>1</mn>
        </msub>
       </mrow>
       <mo>+</mo>
       <mrow>
        <msub>
         <mi>c</mi>
         <mn>1</mn>
        </msub>
        <msub>
         <mi>x</mi>
         <mn>2</mn>
        </msub>
       </mrow>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <msub>
      <mi>a</mi>
      <mn>2</mn>
     </msub>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <msub>
      <mi>d</mi>
      <mn>2</mn>
     </msub>
     <msub>
      <mi>b</mi>
      <mn>1</mn>
     </msub>
    </mrow>
    <mo>-</mo>
    <mrow>
     <msub>
      <mi>d</mi>
      <mn>1</mn>
     </msub>
     <mpadded width="+1.7pt">
      <msub>
       <mi>a</mi>
       <mn>2</mn>
      </msub>
     </mpadded>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <minus></minus>
     <apply>
      <times></times>
      <apply>
       <plus></plus>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>a</ci>
         <cn type="integer">2</cn>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>x</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>b</ci>
         <cn type="integer">2</cn>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>x</ci>
         <cn type="integer">2</cn>
        </apply>
       </apply>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>c</ci>
         <cn type="integer">2</cn>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>x</ci>
         <cn type="integer">3</cn>
        </apply>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>b</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <plus></plus>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>b</ci>
         <cn type="integer">1</cn>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>x</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>c</ci>
         <cn type="integer">1</cn>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>x</ci>
         <cn type="integer">2</cn>
        </apply>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>a</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
    <apply>
     <minus></minus>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>d</ci>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>b</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>d</ci>
       <cn type="integer">1</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>a</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (a_{2}x_{1}+b_{2}x_{2}+c_{2}x_{3})b_{1}-(b_{1}x_{1}+c_{1}x_{2})a_{2}=d_{2}b_{1%
}-d_{1}a_{2}\,
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Tridiagonal_matrix_algorithm:16">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mrow>
        <msub>
         <mi>b</mi>
         <mn>2</mn>
        </msub>
        <msub>
         <mi>b</mi>
         <mn>1</mn>
        </msub>
       </mrow>
       <mo>-</mo>
       <mrow>
        <msub>
         <mi>c</mi>
         <mn>1</mn>
        </msub>
        <msub>
         <mi>a</mi>
         <mn>2</mn>
        </msub>
       </mrow>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <msub>
      <mi>x</mi>
      <mn>2</mn>
     </msub>
    </mrow>
    <mo>+</mo>
    <mrow>
     <msub>
      <mi>c</mi>
      <mn>2</mn>
     </msub>
     <msub>
      <mi>b</mi>
      <mn>1</mn>
     </msub>
     <msub>
      <mi>x</mi>
      <mn>3</mn>
     </msub>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <msub>
      <mi>d</mi>
      <mn>2</mn>
     </msub>
     <msub>
      <mi>b</mi>
      <mn>1</mn>
     </msub>
    </mrow>
    <mo>-</mo>
    <mrow>
     <msub>
      <mi>d</mi>
      <mn>1</mn>
     </msub>
     <mpadded width="+1.7pt">
      <msub>
       <mi>a</mi>
       <mn>2</mn>
      </msub>
     </mpadded>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <apply>
       <minus></minus>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>b</ci>
         <cn type="integer">2</cn>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>b</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>c</ci>
         <cn type="integer">1</cn>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>a</ci>
         <cn type="integer">2</cn>
        </apply>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>c</ci>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>b</ci>
       <cn type="integer">1</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <cn type="integer">3</cn>
      </apply>
     </apply>
    </apply>
    <apply>
     <minus></minus>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>d</ci>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>b</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>d</ci>
       <cn type="integer">1</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>a</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (b_{2}b_{1}-c_{1}a_{2})x_{2}+c_{2}b_{1}x_{3}=d_{2}b_{1}-d_{1}a_{2}\,
  </annotation>
 </semantics>
</math>

</p>

<p>and the effect is that 

<math display="inline" id="Tridiagonal_matrix_algorithm:17">
 <semantics>
  <msub>
   <mi>x</mi>
   <mn>1</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>x</ci>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x_{1}
  </annotation>
 </semantics>
</math>

 has been eliminated from the second equation. Using a similar tactic with the <strong>modified</strong> second equation on the third equation yields:</p>

<p>

<math display="block" id="Tridiagonal_matrix_algorithm:18">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mrow>
        <msub>
         <mi>a</mi>
         <mn>3</mn>
        </msub>
        <msub>
         <mi>x</mi>
         <mn>2</mn>
        </msub>
       </mrow>
       <mo>+</mo>
       <mrow>
        <msub>
         <mi>b</mi>
         <mn>3</mn>
        </msub>
        <msub>
         <mi>x</mi>
         <mn>3</mn>
        </msub>
       </mrow>
       <mo>+</mo>
       <mrow>
        <msub>
         <mi>c</mi>
         <mn>3</mn>
        </msub>
        <msub>
         <mi>x</mi>
         <mn>4</mn>
        </msub>
       </mrow>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mrow>
        <msub>
         <mi>b</mi>
         <mn>2</mn>
        </msub>
        <msub>
         <mi>b</mi>
         <mn>1</mn>
        </msub>
       </mrow>
       <mo>-</mo>
       <mrow>
        <msub>
         <mi>c</mi>
         <mn>1</mn>
        </msub>
        <msub>
         <mi>a</mi>
         <mn>2</mn>
        </msub>
       </mrow>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>-</mo>
    <mrow>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mrow>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <mrow>
           <msub>
            <mi>b</mi>
            <mn>2</mn>
           </msub>
           <msub>
            <mi>b</mi>
            <mn>1</mn>
           </msub>
          </mrow>
          <mo>-</mo>
          <mrow>
           <msub>
            <mi>c</mi>
            <mn>1</mn>
           </msub>
           <msub>
            <mi>a</mi>
            <mn>2</mn>
           </msub>
          </mrow>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
        <msub>
         <mi>x</mi>
         <mn>2</mn>
        </msub>
       </mrow>
       <mo>+</mo>
       <mrow>
        <msub>
         <mi>c</mi>
         <mn>2</mn>
        </msub>
        <msub>
         <mi>b</mi>
         <mn>1</mn>
        </msub>
        <msub>
         <mi>x</mi>
         <mn>3</mn>
        </msub>
       </mrow>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <msub>
      <mi>a</mi>
      <mn>3</mn>
     </msub>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <msub>
      <mi>d</mi>
      <mn>3</mn>
     </msub>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mrow>
        <msub>
         <mi>b</mi>
         <mn>2</mn>
        </msub>
        <msub>
         <mi>b</mi>
         <mn>1</mn>
        </msub>
       </mrow>
       <mo>-</mo>
       <mrow>
        <msub>
         <mi>c</mi>
         <mn>1</mn>
        </msub>
        <msub>
         <mi>a</mi>
         <mn>2</mn>
        </msub>
       </mrow>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>-</mo>
    <mrow>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mrow>
        <msub>
         <mi>d</mi>
         <mn>2</mn>
        </msub>
        <msub>
         <mi>b</mi>
         <mn>1</mn>
        </msub>
       </mrow>
       <mo>-</mo>
       <mrow>
        <msub>
         <mi>d</mi>
         <mn>1</mn>
        </msub>
        <msub>
         <mi>a</mi>
         <mn>2</mn>
        </msub>
       </mrow>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <mpadded width="+1.7pt">
      <msub>
       <mi>a</mi>
       <mn>3</mn>
      </msub>
     </mpadded>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <minus></minus>
     <apply>
      <times></times>
      <apply>
       <plus></plus>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>a</ci>
         <cn type="integer">3</cn>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>x</ci>
         <cn type="integer">2</cn>
        </apply>
       </apply>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>b</ci>
         <cn type="integer">3</cn>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>x</ci>
         <cn type="integer">3</cn>
        </apply>
       </apply>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>c</ci>
         <cn type="integer">3</cn>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>x</ci>
         <cn type="integer">4</cn>
        </apply>
       </apply>
      </apply>
      <apply>
       <minus></minus>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>b</ci>
         <cn type="integer">2</cn>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>b</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>c</ci>
         <cn type="integer">1</cn>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>a</ci>
         <cn type="integer">2</cn>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <plus></plus>
       <apply>
        <times></times>
        <apply>
         <minus></minus>
         <apply>
          <times></times>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>b</ci>
           <cn type="integer">2</cn>
          </apply>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>b</ci>
           <cn type="integer">1</cn>
          </apply>
         </apply>
         <apply>
          <times></times>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>c</ci>
           <cn type="integer">1</cn>
          </apply>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>a</ci>
           <cn type="integer">2</cn>
          </apply>
         </apply>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>x</ci>
         <cn type="integer">2</cn>
        </apply>
       </apply>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>c</ci>
         <cn type="integer">2</cn>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>b</ci>
         <cn type="integer">1</cn>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>x</ci>
         <cn type="integer">3</cn>
        </apply>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>a</ci>
       <cn type="integer">3</cn>
      </apply>
     </apply>
    </apply>
    <apply>
     <minus></minus>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>d</ci>
       <cn type="integer">3</cn>
      </apply>
      <apply>
       <minus></minus>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>b</ci>
         <cn type="integer">2</cn>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>b</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>c</ci>
         <cn type="integer">1</cn>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>a</ci>
         <cn type="integer">2</cn>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <minus></minus>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>d</ci>
         <cn type="integer">2</cn>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>b</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>d</ci>
         <cn type="integer">1</cn>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>a</ci>
         <cn type="integer">2</cn>
        </apply>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>a</ci>
       <cn type="integer">3</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (a_{3}x_{2}+b_{3}x_{3}+c_{3}x_{4})(b_{2}b_{1}-c_{1}a_{2})-((b_{2}b_{1}-c_{1}a_%
{2})x_{2}+c_{2}b_{1}x_{3})a_{3}=d_{3}(b_{2}b_{1}-c_{1}a_{2})-(d_{2}b_{1}-d_{1}%
a_{2})a_{3}\,
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Tridiagonal_matrix_algorithm:19">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mrow>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mrow>
         <msub>
          <mi>b</mi>
          <mn>3</mn>
         </msub>
         <mrow>
          <mo stretchy="false">(</mo>
          <mrow>
           <mrow>
            <msub>
             <mi>b</mi>
             <mn>2</mn>
            </msub>
            <msub>
             <mi>b</mi>
             <mn>1</mn>
            </msub>
           </mrow>
           <mo>-</mo>
           <mrow>
            <msub>
             <mi>c</mi>
             <mn>1</mn>
            </msub>
            <msub>
             <mi>a</mi>
             <mn>2</mn>
            </msub>
           </mrow>
          </mrow>
          <mo stretchy="false">)</mo>
         </mrow>
        </mrow>
        <mo>-</mo>
        <mrow>
         <msub>
          <mi>c</mi>
          <mn>2</mn>
         </msub>
         <msub>
          <mi>b</mi>
          <mn>1</mn>
         </msub>
         <msub>
          <mi>a</mi>
          <mn>3</mn>
         </msub>
        </mrow>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
      <msub>
       <mi>x</mi>
       <mn>3</mn>
      </msub>
     </mrow>
     <mo>+</mo>
     <mrow>
      <msub>
       <mi>c</mi>
       <mn>3</mn>
      </msub>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mrow>
         <msub>
          <mi>b</mi>
          <mn>2</mn>
         </msub>
         <msub>
          <mi>b</mi>
          <mn>1</mn>
         </msub>
        </mrow>
        <mo>-</mo>
        <mrow>
         <msub>
          <mi>c</mi>
          <mn>1</mn>
         </msub>
         <msub>
          <mi>a</mi>
          <mn>2</mn>
         </msub>
        </mrow>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
      <msub>
       <mi>x</mi>
       <mn>4</mn>
      </msub>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mrow>
      <msub>
       <mi>d</mi>
       <mn>3</mn>
      </msub>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mrow>
         <msub>
          <mi>b</mi>
          <mn>2</mn>
         </msub>
         <msub>
          <mi>b</mi>
          <mn>1</mn>
         </msub>
        </mrow>
        <mo>-</mo>
        <mrow>
         <msub>
          <mi>c</mi>
          <mn>1</mn>
         </msub>
         <msub>
          <mi>a</mi>
          <mn>2</mn>
         </msub>
        </mrow>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo>-</mo>
     <mrow>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mrow>
         <msub>
          <mi>d</mi>
          <mn>2</mn>
         </msub>
         <msub>
          <mi>b</mi>
          <mn>1</mn>
         </msub>
        </mrow>
        <mo>-</mo>
        <mrow>
         <msub>
          <mi>d</mi>
          <mn>1</mn>
         </msub>
         <msub>
          <mi>a</mi>
          <mn>2</mn>
         </msub>
        </mrow>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
      <msub>
       <mi>a</mi>
       <mn>3</mn>
      </msub>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <apply>
       <minus></minus>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>b</ci>
         <cn type="integer">3</cn>
        </apply>
        <apply>
         <minus></minus>
         <apply>
          <times></times>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>b</ci>
           <cn type="integer">2</cn>
          </apply>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>b</ci>
           <cn type="integer">1</cn>
          </apply>
         </apply>
         <apply>
          <times></times>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>c</ci>
           <cn type="integer">1</cn>
          </apply>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>a</ci>
           <cn type="integer">2</cn>
          </apply>
         </apply>
        </apply>
       </apply>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>c</ci>
         <cn type="integer">2</cn>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>b</ci>
         <cn type="integer">1</cn>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>a</ci>
         <cn type="integer">3</cn>
        </apply>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <cn type="integer">3</cn>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>c</ci>
       <cn type="integer">3</cn>
      </apply>
      <apply>
       <minus></minus>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>b</ci>
         <cn type="integer">2</cn>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>b</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>c</ci>
         <cn type="integer">1</cn>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>a</ci>
         <cn type="integer">2</cn>
        </apply>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <cn type="integer">4</cn>
      </apply>
     </apply>
    </apply>
    <apply>
     <minus></minus>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>d</ci>
       <cn type="integer">3</cn>
      </apply>
      <apply>
       <minus></minus>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>b</ci>
         <cn type="integer">2</cn>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>b</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>c</ci>
         <cn type="integer">1</cn>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>a</ci>
         <cn type="integer">2</cn>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <minus></minus>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>d</ci>
         <cn type="integer">2</cn>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>b</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>d</ci>
         <cn type="integer">1</cn>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>a</ci>
         <cn type="integer">2</cn>
        </apply>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>a</ci>
       <cn type="integer">3</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (b_{3}(b_{2}b_{1}-c_{1}a_{2})-c_{2}b_{1}a_{3})x_{3}+c_{3}(b_{2}b_{1}-c_{1}a_{2%
})x_{4}=d_{3}(b_{2}b_{1}-c_{1}a_{2})-(d_{2}b_{1}-d_{1}a_{2})a_{3}.\,
  </annotation>
 </semantics>
</math>

</p>

<p>This time 

<math display="inline" id="Tridiagonal_matrix_algorithm:20">
 <semantics>
  <msub>
   <mi>x</mi>
   <mn>2</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>x</ci>
    <cn type="integer">2</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x_{2}
  </annotation>
 </semantics>
</math>

 was eliminated. If this procedure is repeated until the 

<math display="inline" id="Tridiagonal_matrix_algorithm:21">
 <semantics>
  <msup>
   <mi>n</mi>
   <mrow>
    <mi>t</mi>
    <mi>h</mi>
   </mrow>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>n</ci>
    <apply>
     <times></times>
     <ci>t</ci>
     <ci>h</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n^{th}
  </annotation>
 </semantics>
</math>

 row; the (modified) 

<math display="inline" id="Tridiagonal_matrix_algorithm:22">
 <semantics>
  <msup>
   <mi>n</mi>
   <mrow>
    <mi>t</mi>
    <mi>h</mi>
   </mrow>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>n</ci>
    <apply>
     <times></times>
     <ci>t</ci>
     <ci>h</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n^{th}
  </annotation>
 </semantics>
</math>

 equation will involve only one unknown, 

<math display="inline" id="Tridiagonal_matrix_algorithm:23">
 <semantics>
  <msub>
   <mi>x</mi>
   <mi>n</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>x</ci>
    <ci>n</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x_{n}
  </annotation>
 </semantics>
</math>

. This may be solved for and then used to solve the 

<math display="inline" id="Tridiagonal_matrix_algorithm:24">
 <semantics>
  <msup>
   <mrow>
    <mo stretchy="false">(</mo>
    <mrow>
     <mi>n</mi>
     <mo>-</mo>
     <mn>1</mn>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
   <mrow>
    <mi>t</mi>
    <mi>h</mi>
   </mrow>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <apply>
     <minus></minus>
     <ci>n</ci>
     <cn type="integer">1</cn>
    </apply>
    <apply>
     <times></times>
     <ci>t</ci>
     <ci>h</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (n-1)^{th}
  </annotation>
 </semantics>
</math>

 equation, and so on until all of the unknowns are solved for.</p>

<p>Clearly, the coefficients on the modified equations get more and more complicated if stated explicitly. By examining the procedure, the modified coefficients (notated with tildes) may instead be defined recursively:</p>

<p>

<math display="block" id="Tridiagonal_matrix_algorithm:25">
 <semantics>
  <mrow>
   <msub>
    <mover accent="true">
     <mi>a</mi>
     <mo stretchy="false">~</mo>
    </mover>
    <mi>i</mi>
   </msub>
   <mo>=</mo>
   <mpadded width="+1.7pt">
    <mn>0</mn>
   </mpadded>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <ci>normal-~</ci>
      <ci>a</ci>
     </apply>
     <ci>i</ci>
    </apply>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \tilde{a}_{i}=0\,
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Tridiagonal_matrix_algorithm:26">
 <semantics>
  <mrow>
   <msub>
    <mover accent="true">
     <mi>b</mi>
     <mo stretchy="false">~</mo>
    </mover>
    <mn>1</mn>
   </msub>
   <mo>=</mo>
   <mpadded width="+1.7pt">
    <msub>
     <mi>b</mi>
     <mn>1</mn>
    </msub>
   </mpadded>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <ci>normal-~</ci>
      <ci>b</ci>
     </apply>
     <cn type="integer">1</cn>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>b</ci>
     <cn type="integer">1</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \tilde{b}_{1}=b_{1}\,
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Tridiagonal_matrix_algorithm:27">
 <semantics>
  <mrow>
   <msub>
    <mover accent="true">
     <mi>b</mi>
     <mo stretchy="false">~</mo>
    </mover>
    <mi>i</mi>
   </msub>
   <mo>=</mo>
   <mrow>
    <mrow>
     <msub>
      <mi>b</mi>
      <mi>i</mi>
     </msub>
     <msub>
      <mover accent="true">
       <mi>b</mi>
       <mo stretchy="false">~</mo>
      </mover>
      <mrow>
       <mi>i</mi>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
     </msub>
    </mrow>
    <mo>-</mo>
    <mrow>
     <msub>
      <mover accent="true">
       <mi>c</mi>
       <mo stretchy="false">~</mo>
      </mover>
      <mrow>
       <mi>i</mi>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
     </msub>
     <mpadded width="+1.7pt">
      <msub>
       <mi>a</mi>
       <mi>i</mi>
      </msub>
     </mpadded>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <ci>normal-~</ci>
      <ci>b</ci>
     </apply>
     <ci>i</ci>
    </apply>
    <apply>
     <minus></minus>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>b</ci>
       <ci>i</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <apply>
        <ci>normal-~</ci>
        <ci>b</ci>
       </apply>
       <apply>
        <minus></minus>
        <ci>i</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <apply>
        <ci>normal-~</ci>
        <ci>c</ci>
       </apply>
       <apply>
        <minus></minus>
        <ci>i</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>a</ci>
       <ci>i</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \tilde{b}_{i}=b_{i}\tilde{b}_{i-1}-\tilde{c}_{i-1}a_{i}\,
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Tridiagonal_matrix_algorithm:28">
 <semantics>
  <mrow>
   <msub>
    <mover accent="true">
     <mi>c</mi>
     <mo stretchy="false">~</mo>
    </mover>
    <mn>1</mn>
   </msub>
   <mo>=</mo>
   <mpadded width="+1.7pt">
    <msub>
     <mi>c</mi>
     <mn>1</mn>
    </msub>
   </mpadded>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <ci>normal-~</ci>
      <ci>c</ci>
     </apply>
     <cn type="integer">1</cn>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>c</ci>
     <cn type="integer">1</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \tilde{c}_{1}=c_{1}\,
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Tridiagonal_matrix_algorithm:29">
 <semantics>
  <mrow>
   <msub>
    <mover accent="true">
     <mi>c</mi>
     <mo stretchy="false">~</mo>
    </mover>
    <mi>i</mi>
   </msub>
   <mo>=</mo>
   <mrow>
    <msub>
     <mi>c</mi>
     <mi>i</mi>
    </msub>
    <mpadded width="+1.7pt">
     <msub>
      <mover accent="true">
       <mi>b</mi>
       <mo stretchy="false">~</mo>
      </mover>
      <mrow>
       <mi>i</mi>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
     </msub>
    </mpadded>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <ci>normal-~</ci>
      <ci>c</ci>
     </apply>
     <ci>i</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>c</ci>
      <ci>i</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <ci>normal-~</ci>
       <ci>b</ci>
      </apply>
      <apply>
       <minus></minus>
       <ci>i</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \tilde{c}_{i}=c_{i}\tilde{b}_{i-1}\,
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Tridiagonal_matrix_algorithm:30">
 <semantics>
  <mrow>
   <msub>
    <mover accent="true">
     <mi>d</mi>
     <mo stretchy="false">~</mo>
    </mover>
    <mn>1</mn>
   </msub>
   <mo>=</mo>
   <mpadded width="+1.7pt">
    <msub>
     <mi>d</mi>
     <mn>1</mn>
    </msub>
   </mpadded>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <ci>normal-~</ci>
      <ci>d</ci>
     </apply>
     <cn type="integer">1</cn>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>d</ci>
     <cn type="integer">1</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \tilde{d}_{1}=d_{1}\,
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Tridiagonal_matrix_algorithm:31">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mover accent="true">
      <mi>d</mi>
      <mo stretchy="false">~</mo>
     </mover>
     <mi>i</mi>
    </msub>
    <mo>=</mo>
    <mrow>
     <mrow>
      <msub>
       <mi>d</mi>
       <mi>i</mi>
      </msub>
      <msub>
       <mover accent="true">
        <mi>b</mi>
        <mo stretchy="false">~</mo>
       </mover>
       <mrow>
        <mi>i</mi>
        <mo>-</mo>
        <mn>1</mn>
       </mrow>
      </msub>
     </mrow>
     <mo>-</mo>
     <mrow>
      <msub>
       <mover accent="true">
        <mi>d</mi>
        <mo stretchy="false">~</mo>
       </mover>
       <mrow>
        <mi>i</mi>
        <mo>-</mo>
        <mn>1</mn>
       </mrow>
      </msub>
      <msub>
       <mi>a</mi>
       <mi>i</mi>
      </msub>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <ci>normal-~</ci>
      <ci>d</ci>
     </apply>
     <ci>i</ci>
    </apply>
    <apply>
     <minus></minus>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>d</ci>
       <ci>i</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <apply>
        <ci>normal-~</ci>
        <ci>b</ci>
       </apply>
       <apply>
        <minus></minus>
        <ci>i</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <apply>
        <ci>normal-~</ci>
        <ci>d</ci>
       </apply>
       <apply>
        <minus></minus>
        <ci>i</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>a</ci>
       <ci>i</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \tilde{d}_{i}=d_{i}\tilde{b}_{i-1}-\tilde{d}_{i-1}a_{i}.\,
  </annotation>
 </semantics>
</math>

</p>

<p>To further hasten the solution process, 

<math display="inline" id="Tridiagonal_matrix_algorithm:32">
 <semantics>
  <msub>
   <mover accent="true">
    <mi>b</mi>
    <mo stretchy="false">~</mo>
   </mover>
   <mi>i</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <apply>
     <ci>normal-~</ci>
     <ci>b</ci>
    </apply>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \tilde{b}_{i}
  </annotation>
 </semantics>
</math>

 may be divided out (if there's no division by zero risk), the newer modified coefficients notated with a prime will be:</p>

<p>

<math display="block" id="Tridiagonal_matrix_algorithm:33">
 <semantics>
  <mrow>
   <msubsup>
    <mi>a</mi>
    <mi>i</mi>
    <mo>′</mo>
   </msubsup>
   <mo>=</mo>
   <mpadded width="+1.7pt">
    <mn>0</mn>
   </mpadded>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>a</ci>
      <ci>normal-′</ci>
     </apply>
     <ci>i</ci>
    </apply>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a^{\prime}_{i}=0\,
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Tridiagonal_matrix_algorithm:34">
 <semantics>
  <mrow>
   <msubsup>
    <mi>b</mi>
    <mi>i</mi>
    <mo>′</mo>
   </msubsup>
   <mo>=</mo>
   <mpadded width="+1.7pt">
    <mn>1</mn>
   </mpadded>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>b</ci>
      <ci>normal-′</ci>
     </apply>
     <ci>i</ci>
    </apply>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   b^{\prime}_{i}=1\,
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Tridiagonal_matrix_algorithm:35">
 <semantics>
  <mrow>
   <msubsup>
    <mi>c</mi>
    <mn>1</mn>
    <mo>′</mo>
   </msubsup>
   <mo>=</mo>
   <mpadded width="+1.7pt">
    <mfrac>
     <msub>
      <mi>c</mi>
      <mn>1</mn>
     </msub>
     <msub>
      <mi>b</mi>
      <mn>1</mn>
     </msub>
    </mfrac>
   </mpadded>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>c</ci>
      <ci>normal-′</ci>
     </apply>
     <cn type="integer">1</cn>
    </apply>
    <apply>
     <divide></divide>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>c</ci>
      <cn type="integer">1</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>b</ci>
      <cn type="integer">1</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   c^{\prime}_{1}=\frac{c_{1}}{b_{1}}\,
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Tridiagonal_matrix_algorithm:36">
 <semantics>
  <mrow>
   <msubsup>
    <mi>c</mi>
    <mi>i</mi>
    <mo>′</mo>
   </msubsup>
   <mo>=</mo>
   <mpadded width="+1.7pt">
    <mfrac>
     <msub>
      <mi>c</mi>
      <mi>i</mi>
     </msub>
     <mrow>
      <msub>
       <mi>b</mi>
       <mi>i</mi>
      </msub>
      <mo>-</mo>
      <mrow>
       <msubsup>
        <mi>c</mi>
        <mrow>
         <mi>i</mi>
         <mo>-</mo>
         <mn>1</mn>
        </mrow>
        <mo>′</mo>
       </msubsup>
       <msub>
        <mi>a</mi>
        <mi>i</mi>
       </msub>
      </mrow>
     </mrow>
    </mfrac>
   </mpadded>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>c</ci>
      <ci>normal-′</ci>
     </apply>
     <ci>i</ci>
    </apply>
    <apply>
     <divide></divide>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>c</ci>
      <ci>i</ci>
     </apply>
     <apply>
      <minus></minus>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>b</ci>
       <ci>i</ci>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>c</ci>
         <ci>normal-′</ci>
        </apply>
        <apply>
         <minus></minus>
         <ci>i</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>a</ci>
        <ci>i</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   c^{\prime}_{i}=\frac{c_{i}}{b_{i}-c^{\prime}_{i-1}a_{i}}\,
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Tridiagonal_matrix_algorithm:37">
 <semantics>
  <mrow>
   <msubsup>
    <mi>d</mi>
    <mn>1</mn>
    <mo>′</mo>
   </msubsup>
   <mo>=</mo>
   <mpadded width="+1.7pt">
    <mfrac>
     <msub>
      <mi>d</mi>
      <mn>1</mn>
     </msub>
     <msub>
      <mi>b</mi>
      <mn>1</mn>
     </msub>
    </mfrac>
   </mpadded>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>d</ci>
      <ci>normal-′</ci>
     </apply>
     <cn type="integer">1</cn>
    </apply>
    <apply>
     <divide></divide>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>d</ci>
      <cn type="integer">1</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>b</ci>
      <cn type="integer">1</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   d^{\prime}_{1}=\frac{d_{1}}{b_{1}}\,
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Tridiagonal_matrix_algorithm:38">
 <semantics>
  <mrow>
   <mrow>
    <msubsup>
     <mi>d</mi>
     <mi>i</mi>
     <mo>′</mo>
    </msubsup>
    <mo>=</mo>
    <mfrac>
     <mrow>
      <msub>
       <mi>d</mi>
       <mi>i</mi>
      </msub>
      <mo>-</mo>
      <mrow>
       <msubsup>
        <mi>d</mi>
        <mrow>
         <mi>i</mi>
         <mo>-</mo>
         <mn>1</mn>
        </mrow>
        <mo>′</mo>
       </msubsup>
       <msub>
        <mi>a</mi>
        <mi>i</mi>
       </msub>
      </mrow>
     </mrow>
     <mrow>
      <msub>
       <mi>b</mi>
       <mi>i</mi>
      </msub>
      <mo>-</mo>
      <mrow>
       <msubsup>
        <mi>c</mi>
        <mrow>
         <mi>i</mi>
         <mo>-</mo>
         <mn>1</mn>
        </mrow>
        <mo>′</mo>
       </msubsup>
       <msub>
        <mi>a</mi>
        <mi>i</mi>
       </msub>
      </mrow>
     </mrow>
    </mfrac>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>d</ci>
      <ci>normal-′</ci>
     </apply>
     <ci>i</ci>
    </apply>
    <apply>
     <divide></divide>
     <apply>
      <minus></minus>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>d</ci>
       <ci>i</ci>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>d</ci>
         <ci>normal-′</ci>
        </apply>
        <apply>
         <minus></minus>
         <ci>i</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>a</ci>
        <ci>i</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <minus></minus>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>b</ci>
       <ci>i</ci>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>c</ci>
         <ci>normal-′</ci>
        </apply>
        <apply>
         <minus></minus>
         <ci>i</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>a</ci>
        <ci>i</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   d^{\prime}_{i}=\frac{d_{i}-d^{\prime}_{i-1}a_{i}}{b_{i}-c^{\prime}_{i-1}a_{i}}.\,
  </annotation>
 </semantics>
</math>

</p>

<p>This gives the following system with the same unknowns and coefficients defined in terms of the original ones above:</p>

<p>

<math display="block" id="Tridiagonal_matrix_algorithm:39">
 <semantics>
  <mpadded width="+1.7pt">
   <mtable displaystyle="true">
    <mtr>
     <mtd columnalign="left">
      <mrow>
       <mrow>
        <mrow>
         <msubsup>
          <mi>b</mi>
          <mi>i</mi>
          <mo>′</mo>
         </msubsup>
         <msub>
          <mi>x</mi>
          <mi>i</mi>
         </msub>
        </mrow>
        <mo>+</mo>
        <mrow>
         <msubsup>
          <mi>c</mi>
          <mi>i</mi>
          <mo>′</mo>
         </msubsup>
         <msub>
          <mi>x</mi>
          <mrow>
           <mi>i</mi>
           <mo>+</mo>
           <mn>1</mn>
          </mrow>
         </msub>
        </mrow>
       </mrow>
       <mo>=</mo>
       <msubsup>
        <mi>d</mi>
        <mi>i</mi>
        <mo>′</mo>
       </msubsup>
      </mrow>
     </mtd>
     <mtd columnalign="center">
      <mrow>
       <mi></mi>
       <mo>;</mo>
      </mrow>
     </mtd>
     <mtd columnalign="left">
      <mrow>
       <mpadded lspace="5pt" width="+5pt">
        <mi>i</mi>
       </mpadded>
       <mo>=</mo>
       <mrow>
        <mn>1</mn>
        <mo>,</mo>
        <mi mathvariant="normal">…</mi>
        <mo>,</mo>
        <mrow>
         <mi>n</mi>
         <mo>-</mo>
         <mn>1</mn>
        </mrow>
       </mrow>
      </mrow>
     </mtd>
    </mtr>
    <mtr>
     <mtd columnalign="left">
      <mrow>
       <mrow>
        <msubsup>
         <mi>b</mi>
         <mi>n</mi>
         <mo>′</mo>
        </msubsup>
        <msub>
         <mi>x</mi>
         <mi>n</mi>
        </msub>
       </mrow>
       <mo>=</mo>
       <msubsup>
        <mi>d</mi>
        <mi>n</mi>
        <mo>′</mo>
       </msubsup>
      </mrow>
     </mtd>
     <mtd columnalign="center">
      <mrow>
       <mi></mi>
       <mo>;</mo>
      </mrow>
     </mtd>
     <mtd columnalign="left">
      <mrow>
       <mrow>
        <mpadded lspace="5pt" width="+5pt">
         <mi>i</mi>
        </mpadded>
        <mo>=</mo>
        <mi>n</mi>
       </mrow>
       <mo>.</mo>
      </mrow>
     </mtd>
    </mtr>
   </mtable>
  </mpadded>
  <annotation-xml encoding="MathML-Content">
   <matrix>
    <matrixrow>
     <apply>
      <eq></eq>
      <apply>
       <plus></plus>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>b</ci>
          <ci>normal-′</ci>
         </apply>
         <ci>i</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>x</ci>
         <ci>i</ci>
        </apply>
       </apply>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>c</ci>
          <ci>normal-′</ci>
         </apply>
         <ci>i</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>x</ci>
         <apply>
          <plus></plus>
          <ci>i</ci>
          <cn type="integer">1</cn>
         </apply>
        </apply>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>d</ci>
        <ci>normal-′</ci>
       </apply>
       <ci>i</ci>
      </apply>
     </apply>
     <csymbol cd="latexml">absent</csymbol>
     <apply>
      <eq></eq>
      <ci>i</ci>
      <list>
       <cn type="integer">1</cn>
       <ci>normal-…</ci>
       <apply>
        <minus></minus>
        <ci>n</ci>
        <cn type="integer">1</cn>
       </apply>
      </list>
     </apply>
    </matrixrow>
    <matrixrow>
     <apply>
      <eq></eq>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>b</ci>
         <ci>normal-′</ci>
        </apply>
        <ci>n</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <ci>n</ci>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>d</ci>
        <ci>normal-′</ci>
       </apply>
       <ci>n</ci>
      </apply>
     </apply>
     <csymbol cd="latexml">absent</csymbol>
     <apply>
      <eq></eq>
      <ci>i</ci>
      <ci>n</ci>
     </apply>
    </matrixrow>
   </matrix>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \begin{array}[]{lcl}b^{\prime}_{i}x_{i}+c^{\prime}_{i}x_{i+1}=d^{\prime}_{i}&;%
&\ i=1,\ldots,n-1\\
b^{\prime}_{n}x_{n}=d^{\prime}_{n}&;&\ i=n.\\
\end{array}\,
  </annotation>
 </semantics>
</math>

</p>

<p>The last equation involves only one unknown. Solving it in turn reduces the next last equation to one unknown, so that this backward substitution can be used to find all of the unknowns:</p>

<p>

<math display="block" id="Tridiagonal_matrix_algorithm:40">
 <semantics>
  <mrow>
   <msub>
    <mi>x</mi>
    <mi>n</mi>
   </msub>
   <mo>=</mo>
   <mrow>
    <msubsup>
     <mi>d</mi>
     <mi>n</mi>
     <mo>′</mo>
    </msubsup>
    <mo>/</mo>
    <mpadded width="+1.7pt">
     <msubsup>
      <mi>b</mi>
      <mi>n</mi>
      <mo>′</mo>
     </msubsup>
    </mpadded>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>x</ci>
     <ci>n</ci>
    </apply>
    <apply>
     <divide></divide>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>d</ci>
       <ci>normal-′</ci>
      </apply>
      <ci>n</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>b</ci>
       <ci>normal-′</ci>
      </apply>
      <ci>n</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x_{n}=d^{\prime}_{n}/b^{\prime}_{n}\,
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Tridiagonal_matrix_algorithm:41">
 <semantics>
  <mrow>
   <msub>
    <mi>x</mi>
    <mi>i</mi>
   </msub>
   <mo>=</mo>
   <mrow>
    <mo stretchy="false">(</mo>
    <msubsup>
     <mi>d</mi>
     <mi>i</mi>
     <mo>′</mo>
    </msubsup>
    <mo>-</mo>
    <msubsup>
     <mi>c</mi>
     <mi>i</mi>
     <mo>′</mo>
    </msubsup>
    <msub>
     <mi>x</mi>
     <mrow>
      <mi>i</mi>
      <mo>+</mo>
      <mn>1</mn>
     </mrow>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>/</mo>
   <msubsup>
    <mi>b</mi>
    <mi>i</mi>
    <mo>′</mo>
   </msubsup>
   <mo rspace="7.5pt">;</mo>
   <mi>i</mi>
   <mo>=</mo>
   <mi>n</mi>
   <mo>-</mo>
   <mn>1</mn>
   <mo>,</mo>
   <mi>n</mi>
   <mo>-</mo>
   <mn>2</mn>
   <mo>,</mo>
   <mi mathvariant="normal">…</mi>
   <mo>,</mo>
   <mn>1.</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>x</ci>
     <ci>i</ci>
    </apply>
    <eq></eq>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>d</ci>
       <ci>normal-′</ci>
      </apply>
      <ci>i</ci>
     </apply>
     <minus></minus>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>c</ci>
       <ci>normal-′</ci>
      </apply>
      <ci>i</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <apply>
       <plus></plus>
       <ci>i</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <divide></divide>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>b</ci>
      <ci>normal-′</ci>
     </apply>
     <ci>i</ci>
    </apply>
    <ci>italic-</ci>
    <ci>normal-;</ci>
    <csymbol cd="unknown">i</csymbol>
    <eq></eq>
    <csymbol cd="unknown">n</csymbol>
    <minus></minus>
    <cn type="integer">1</cn>
    <ci>normal-,</ci>
    <csymbol cd="unknown">n</csymbol>
    <minus></minus>
    <cn type="integer">2</cn>
    <ci>normal-,</ci>
    <ci>normal-…</ci>
    <ci>normal-,</ci>
    <cn type="float">1.</cn>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x_{i}=(d^{\prime}_{i}-c^{\prime}_{i}x_{i+1})/b^{\prime}_{i}\qquad;\ i=n-1,n-2,%
\ldots,1.
  </annotation>
 </semantics>
</math>

</p>
<h2 id="variants">Variants</h2>

<p>In some situations, particularly those involving <a href="periodic_boundary_conditions" title="wikilink">periodic boundary conditions</a>, a slightly perturbed form of the tridiagonal system may need to be solved:</p>

<p>

<math display="inline" id="Tridiagonal_matrix_algorithm:42">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>a</mi>
     <mn>1</mn>
    </msub>
    <msub>
     <mi>x</mi>
     <mi>n</mi>
    </msub>
   </mrow>
   <mo>+</mo>
   <mrow>
    <msub>
     <mi>b</mi>
     <mn>1</mn>
    </msub>
    <msub>
     <mi>x</mi>
     <mn>1</mn>
    </msub>
   </mrow>
   <mo>+</mo>
   <mrow>
    <msub>
     <mi>c</mi>
     <mn>1</mn>
    </msub>
    <msub>
     <mi>x</mi>
     <mn>2</mn>
    </msub>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <plus></plus>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>a</ci>
      <cn type="integer">1</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <ci>n</ci>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>b</ci>
      <cn type="integer">1</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <cn type="integer">1</cn>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>c</ci>
      <cn type="integer">1</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <cn type="integer">2</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle a_{1}x_{n}+b_{1}x_{1}+c_{1}x_{2}
  </annotation>
 </semantics>
</math>


</p>

<p>In this case, we can make use of the <a href="Sherman-Morrison_formula" title="wikilink">Sherman-Morrison formula</a> to avoid the additional operations of Gaussian elimination and still use the Thomas algorithm. The method requires solving a modified non-cyclic version of the system for both the input and a sparse corrective vector, and then combining the solutions. This can be done efficiently if both solutions are computed at once, as the forward portion of the pure tridiagonal matrix algorithm can be shared.</p>

<p>In other situations, the system of equations may be <strong>block tridiagonal</strong> (see <a href="block_matrix" title="wikilink">block matrix</a>), with smaller submatrices arranged as the individual elements in the above matrix system(e.g., the 2D <a href="Poisson_equation_discretized_into_block_tridiagonal" title="wikilink">Poisson problem</a>). Simplified forms of Gaussian elimination have been developed for these situations.</p>

<p>The textbook <em>Numerical Mathematics</em> by Quarteroni, Sacco and Saleri, lists a modified version of the algorithm which avoids some of the divisions (using instead multiplications), which is beneficial on some computer architectures.</p>
<h2 id="references">References</h2>
<ul>
<li></li>
<li></li>
<li></li>
</ul>
<h2 id="external-links">External links</h2>
<ul>
<li><a href="http://www.water.tkk.fi/wr/kurssit/Yhd-12.122/www_book/sgh_422b.htm">Example with VBA code</a></li>
</ul>

<p>"</p>

<p><a href="Category:Numerical_linear_algebra" title="wikilink">Category:Numerical linear algebra</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1"><a href="#fnref1">↩</a></li>
<li id="fn2"></li>
<li id="fn3"><a href="#fnref3">↩</a></li>
<li id="fn4"><a href="#fnref4">↩</a></li>
</ol>
</section>



<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="374">Canonical correlation</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Canonical correlation</h1>
<hr>In [[statistics
<p>]], <strong>canonical-correlation analysis</strong> (<strong>CCA</strong>) is a way of making sense of <a href="cross-covariance_matrix" title="wikilink">cross-covariance matrices</a>. If we have two vectors <em>X</em> = (<em>X</em><sub>1</sub>, ..., <em>X</em><sub><em>n</em></sub>) and <em>Y</em> = (<em>Y</em><sub>1</sub>, ..., <em>Y</em><sub><em>m</em></sub>) of <a href="random_variable" title="wikilink">random variables</a>, and there are <a href="correlation" title="wikilink">correlations</a> among the variables, then canonical-correlation analysis will find linear combinations of the <em>X</em><sub><em>i</em></sub> and <em>Y</em><sub><em>j</em></sub> which have maximum correlation with each other.<a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a> T. R. Knapp notes "virtually all of the commonly encountered <a href="parametric_statistics" title="wikilink">parametric tests</a> of significance can be treated as special cases of canonical-correlation analysis, which is the general procedure for investigating the relationships between two sets of variables."<a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a> The method was first introduced by <a href="Harold_Hotelling" title="wikilink">Harold Hotelling</a> in 1936.<a class="footnoteRef" href="#fn3" id="fnref3"><sup>3</sup></a></p>
<h2 id="definition">Definition</h2>

<p>Given two <a href="column_vectors" title="wikilink">column vectors</a> 

<math display="inline" id="Canonical_correlation:0">
 <semantics>
  <mrow>
   <mi>X</mi>
   <mo>=</mo>
   <msup>
    <mrow>
     <mo stretchy="false">(</mo>
     <msub>
      <mi>x</mi>
      <mn>1</mn>
     </msub>
     <mo>,</mo>
     <mi mathvariant="normal">…</mi>
     <mo>,</mo>
     <msub>
      <mi>x</mi>
      <mi>n</mi>
     </msub>
     <mo stretchy="false">)</mo>
    </mrow>
    <mo>′</mo>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>X</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <vector>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <cn type="integer">1</cn>
      </apply>
      <ci>normal-…</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <ci>n</ci>
      </apply>
     </vector>
     <ci>normal-′</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   X=(x_{1},\dots,x_{n})^{\prime}
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Canonical_correlation:1">
 <semantics>
  <mrow>
   <mi>Y</mi>
   <mo>=</mo>
   <msup>
    <mrow>
     <mo stretchy="false">(</mo>
     <msub>
      <mi>y</mi>
      <mn>1</mn>
     </msub>
     <mo>,</mo>
     <mi mathvariant="normal">…</mi>
     <mo>,</mo>
     <msub>
      <mi>y</mi>
      <mi>m</mi>
     </msub>
     <mo stretchy="false">)</mo>
    </mrow>
    <mo>′</mo>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>Y</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <vector>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>y</ci>
       <cn type="integer">1</cn>
      </apply>
      <ci>normal-…</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>y</ci>
       <ci>m</ci>
      </apply>
     </vector>
     <ci>normal-′</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Y=(y_{1},\dots,y_{m})^{\prime}
  </annotation>
 </semantics>
</math>

 of <a href="random_variable" title="wikilink">random variables</a> with <a href="Wikt:finite" title="wikilink">finite</a> <a href="second_moments" title="wikilink">second moments</a>, one may define the <a class="uri" href="cross-covariance" title="wikilink">cross-covariance</a> 

<math display="inline" id="Canonical_correlation:2">
 <semantics>
  <mrow>
   <msub>
    <mi mathvariant="normal">Σ</mi>
    <mrow>
     <mi>X</mi>
     <mi>Y</mi>
    </mrow>
   </msub>
   <mo>=</mo>
   <mrow>
    <mo>cov</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>X</mi>
     <mo>,</mo>
     <mi>Y</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>normal-Σ</ci>
     <apply>
      <times></times>
      <ci>X</ci>
      <ci>Y</ci>
     </apply>
    </apply>
    <apply>
     <ci>cov</ci>
     <ci>X</ci>
     <ci>Y</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Sigma_{XY}=\operatorname{cov}(X,Y)
  </annotation>
 </semantics>
</math>

 to be the 

<math display="inline" id="Canonical_correlation:3">
 <semantics>
  <mrow>
   <mi>n</mi>
   <mo>×</mo>
   <mi>m</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>n</ci>
    <ci>m</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n\times m
  </annotation>
 </semantics>
</math>

 <a href="matrix_(mathematics)" title="wikilink">matrix</a> whose 

<math display="inline" id="Canonical_correlation:4">
 <semantics>
  <mrow>
   <mo stretchy="false">(</mo>
   <mi>i</mi>
   <mo>,</mo>
   <mi>j</mi>
   <mo stretchy="false">)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <interval closure="open">
    <ci>i</ci>
    <ci>j</ci>
   </interval>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (i,j)
  </annotation>
 </semantics>
</math>


 entry is the <a class="uri" href="covariance" title="wikilink">covariance</a> 

<math display="inline" id="Canonical_correlation:5">
 <semantics>
  <mrow>
   <mo>cov</mo>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>x</mi>
     <mi>i</mi>
    </msub>
    <mo>,</mo>
    <msub>
     <mi>y</mi>
     <mi>j</mi>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>cov</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>x</ci>
     <ci>i</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>y</ci>
     <ci>j</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \operatorname{cov}(x_{i},y_{j})
  </annotation>
 </semantics>
</math>

. In practice, we would estimate the covariance matrix based on sampled data from 

<math display="inline" id="Canonical_correlation:6">
 <semantics>
  <mi>X</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>X</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   X
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Canonical_correlation:7">
 <semantics>
  <mi>Y</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>Y</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Y
  </annotation>
 </semantics>
</math>

 (i.e. from a pair of data matrices).</p>

<p>Canonical-correlation analysis seeks vectors 

<math display="inline" id="Canonical_correlation:8">
 <semantics>
  <mi>a</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>a</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Canonical_correlation:9">
 <semantics>
  <mi>b</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>b</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   b
  </annotation>
 </semantics>
</math>


 such that the random variables 

<math display="inline" id="Canonical_correlation:10">
 <semantics>
  <mrow>
   <msup>
    <mi>a</mi>
    <mo>′</mo>
   </msup>
   <mi>X</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>a</ci>
     <ci>normal-′</ci>
    </apply>
    <ci>X</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a^{\prime}X
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Canonical_correlation:11">
 <semantics>
  <mrow>
   <msup>
    <mi>b</mi>
    <mo>′</mo>
   </msup>
   <mi>Y</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>b</ci>
     <ci>normal-′</ci>
    </apply>
    <ci>Y</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   b^{\prime}Y
  </annotation>
 </semantics>
</math>

 maximize the <a class="uri" href="correlation" title="wikilink">correlation</a> 

<math display="inline" id="Canonical_correlation:12">
 <semantics>
  <mrow>
   <mi>ρ</mi>
   <mo>=</mo>
   <mrow>
    <mo>corr</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <msup>
       <mi>a</mi>
       <mo>′</mo>
      </msup>
      <mi>X</mi>
     </mrow>
     <mo>,</mo>
     <mrow>
      <msup>
       <mi>b</mi>
       <mo>′</mo>
      </msup>
      <mi>Y</mi>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>ρ</ci>
    <apply>
     <ci>corr</ci>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>a</ci>
       <ci>normal-′</ci>
      </apply>
      <ci>X</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>b</ci>
       <ci>normal-′</ci>
      </apply>
      <ci>Y</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \rho=\operatorname{corr}(a^{\prime}X,b^{\prime}Y)
  </annotation>
 </semantics>
</math>

. The random variables 

<math display="inline" id="Canonical_correlation:13">
 <semantics>
  <mrow>
   <mi>U</mi>
   <mo>=</mo>
   <mrow>
    <msup>
     <mi>a</mi>
     <mo>′</mo>
    </msup>
    <mi>X</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>U</ci>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>a</ci>
      <ci>normal-′</ci>
     </apply>
     <ci>X</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   U=a^{\prime}X
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Canonical_correlation:14">
 <semantics>
  <mrow>
   <mi>V</mi>
   <mo>=</mo>
   <mrow>
    <msup>
     <mi>b</mi>
     <mo>′</mo>
    </msup>
    <mi>Y</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>V</ci>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>b</ci>
      <ci>normal-′</ci>
     </apply>
     <ci>Y</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   V=b^{\prime}Y
  </annotation>
 </semantics>
</math>


 are the <strong><em>first pair of canonical variables</em></strong>. Then one seeks vectors maximizing the same correlation subject to the constraint that they are to be uncorrelated with the first pair of canonical variables; this gives the <strong><em>second pair of canonical variables</em></strong>. This procedure may be continued up to 

<math display="inline" id="Canonical_correlation:15">
 <semantics>
  <mrow>
   <mi>min</mi>
   <mrow>
    <mo stretchy="false">{</mo>
    <mi>m</mi>
    <mo>,</mo>
    <mi>n</mi>
    <mo stretchy="false">}</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <min></min>
    <ci>m</ci>
    <ci>n</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \min\{m,n\}
  </annotation>
 </semantics>
</math>

 times.</p>
<h2 id="computation">Computation</h2>
<h3 id="derivation">Derivation</h3>

<p>Let 

<math display="inline" id="Canonical_correlation:16">
 <semantics>
  <mrow>
   <msub>
    <mi mathvariant="normal">Σ</mi>
    <mrow>
     <mi>X</mi>
     <mi>X</mi>
    </mrow>
   </msub>
   <mo>=</mo>
   <mrow>
    <mo>cov</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>X</mi>
     <mo>,</mo>
     <mi>X</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>normal-Σ</ci>
     <apply>
      <times></times>
      <ci>X</ci>
      <ci>X</ci>
     </apply>
    </apply>
    <apply>
     <ci>cov</ci>
     <ci>X</ci>
     <ci>X</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Sigma_{XX}=\operatorname{cov}(X,X)
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Canonical_correlation:17">
 <semantics>
  <mrow>
   <msub>
    <mi mathvariant="normal">Σ</mi>
    <mrow>
     <mi>Y</mi>
     <mi>Y</mi>
    </mrow>
   </msub>
   <mo>=</mo>
   <mrow>
    <mo>cov</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>Y</mi>
     <mo>,</mo>
     <mi>Y</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>normal-Σ</ci>
     <apply>
      <times></times>
      <ci>Y</ci>
      <ci>Y</ci>
     </apply>
    </apply>
    <apply>
     <ci>cov</ci>
     <ci>Y</ci>
     <ci>Y</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Sigma_{YY}=\operatorname{cov}(Y,Y)
  </annotation>
 </semantics>
</math>

. The parameter to maximize is</p>

<p>

<math display="block" id="Canonical_correlation:18">
 <semantics>
  <mrow>
   <mrow>
    <mi>ρ</mi>
    <mo>=</mo>
    <mfrac>
     <mrow>
      <msup>
       <mi>a</mi>
       <mo>′</mo>
      </msup>
      <msub>
       <mi mathvariant="normal">Σ</mi>
       <mrow>
        <mi>X</mi>
        <mi>Y</mi>
       </mrow>
      </msub>
      <mi>b</mi>
     </mrow>
     <mrow>
      <msqrt>
       <mrow>
        <msup>
         <mi>a</mi>
         <mo>′</mo>
        </msup>
        <msub>
         <mi mathvariant="normal">Σ</mi>
         <mrow>
          <mi>X</mi>
          <mi>X</mi>
         </mrow>
        </msub>
        <mi>a</mi>
       </mrow>
      </msqrt>
      <msqrt>
       <mrow>
        <msup>
         <mi>b</mi>
         <mo>′</mo>
        </msup>
        <msub>
         <mi mathvariant="normal">Σ</mi>
         <mrow>
          <mi>Y</mi>
          <mi>Y</mi>
         </mrow>
        </msub>
        <mi>b</mi>
       </mrow>
      </msqrt>
     </mrow>
    </mfrac>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>ρ</ci>
    <apply>
     <divide></divide>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>a</ci>
       <ci>normal-′</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>normal-Σ</ci>
       <apply>
        <times></times>
        <ci>X</ci>
        <ci>Y</ci>
       </apply>
      </apply>
      <ci>b</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <root></root>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>a</ci>
         <ci>normal-′</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>normal-Σ</ci>
         <apply>
          <times></times>
          <ci>X</ci>
          <ci>X</ci>
         </apply>
        </apply>
        <ci>a</ci>
       </apply>
      </apply>
      <apply>
       <root></root>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>b</ci>
         <ci>normal-′</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>normal-Σ</ci>
         <apply>
          <times></times>
          <ci>Y</ci>
          <ci>Y</ci>
         </apply>
        </apply>
        <ci>b</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \rho=\frac{a^{\prime}\Sigma_{XY}b}{\sqrt{a^{\prime}\Sigma_{XX}a}\sqrt{b^{%
\prime}\Sigma_{YY}b}}.
  </annotation>
 </semantics>
</math>

</p>

<p>The first step is to define a <a href="change_of_basis" title="wikilink">change of basis</a> and define</p>

<p>

<math display="block" id="Canonical_correlation:19">
 <semantics>
  <mrow>
   <mrow>
    <mi>c</mi>
    <mo>=</mo>
    <mrow>
     <msubsup>
      <mi mathvariant="normal">Σ</mi>
      <mrow>
       <mi>X</mi>
       <mi>X</mi>
      </mrow>
      <mrow>
       <mn>1</mn>
       <mo>/</mo>
       <mn>2</mn>
      </mrow>
     </msubsup>
     <mi>a</mi>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>c</ci>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>normal-Σ</ci>
       <apply>
        <times></times>
        <ci>X</ci>
        <ci>X</ci>
       </apply>
      </apply>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <cn type="integer">2</cn>
      </apply>
     </apply>
     <ci>a</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   c=\Sigma_{XX}^{1/2}a,
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Canonical_correlation:20">
 <semantics>
  <mrow>
   <mrow>
    <mi>d</mi>
    <mo>=</mo>
    <mrow>
     <msubsup>
      <mi mathvariant="normal">Σ</mi>
      <mrow>
       <mi>Y</mi>
       <mi>Y</mi>
      </mrow>
      <mrow>
       <mn>1</mn>
       <mo>/</mo>
       <mn>2</mn>
      </mrow>
     </msubsup>
     <mi>b</mi>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>d</ci>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>normal-Σ</ci>
       <apply>
        <times></times>
        <ci>Y</ci>
        <ci>Y</ci>
       </apply>
      </apply>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <cn type="integer">2</cn>
      </apply>
     </apply>
     <ci>b</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   d=\Sigma_{YY}^{1/2}b.
  </annotation>
 </semantics>
</math>

</p>

<p>And thus we have</p>

<p>

<math display="block" id="Canonical_correlation:21">
 <semantics>
  <mrow>
   <mrow>
    <mi>ρ</mi>
    <mo>=</mo>
    <mfrac>
     <mrow>
      <msup>
       <mi>c</mi>
       <mo>′</mo>
      </msup>
      <msubsup>
       <mi mathvariant="normal">Σ</mi>
       <mrow>
        <mi>X</mi>
        <mi>X</mi>
       </mrow>
       <mrow>
        <mo>-</mo>
        <mrow>
         <mn>1</mn>
         <mo>/</mo>
         <mn>2</mn>
        </mrow>
       </mrow>
      </msubsup>
      <msub>
       <mi mathvariant="normal">Σ</mi>
       <mrow>
        <mi>X</mi>
        <mi>Y</mi>
       </mrow>
      </msub>
      <msubsup>
       <mi mathvariant="normal">Σ</mi>
       <mrow>
        <mi>Y</mi>
        <mi>Y</mi>
       </mrow>
       <mrow>
        <mo>-</mo>
        <mrow>
         <mn>1</mn>
         <mo>/</mo>
         <mn>2</mn>
        </mrow>
       </mrow>
      </msubsup>
      <mi>d</mi>
     </mrow>
     <mrow>
      <msqrt>
       <mrow>
        <msup>
         <mi>c</mi>
         <mo>′</mo>
        </msup>
        <mi>c</mi>
       </mrow>
      </msqrt>
      <msqrt>
       <mrow>
        <msup>
         <mi>d</mi>
         <mo>′</mo>
        </msup>
        <mi>d</mi>
       </mrow>
      </msqrt>
     </mrow>
    </mfrac>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>ρ</ci>
    <apply>
     <divide></divide>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>c</ci>
       <ci>normal-′</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>normal-Σ</ci>
        <apply>
         <times></times>
         <ci>X</ci>
         <ci>X</ci>
        </apply>
       </apply>
       <apply>
        <minus></minus>
        <apply>
         <divide></divide>
         <cn type="integer">1</cn>
         <cn type="integer">2</cn>
        </apply>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>normal-Σ</ci>
       <apply>
        <times></times>
        <ci>X</ci>
        <ci>Y</ci>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>normal-Σ</ci>
        <apply>
         <times></times>
         <ci>Y</ci>
         <ci>Y</ci>
        </apply>
       </apply>
       <apply>
        <minus></minus>
        <apply>
         <divide></divide>
         <cn type="integer">1</cn>
         <cn type="integer">2</cn>
        </apply>
       </apply>
      </apply>
      <ci>d</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <root></root>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>c</ci>
         <ci>normal-′</ci>
        </apply>
        <ci>c</ci>
       </apply>
      </apply>
      <apply>
       <root></root>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>d</ci>
         <ci>normal-′</ci>
        </apply>
        <ci>d</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \rho=\frac{c^{\prime}\Sigma_{XX}^{-1/2}\Sigma_{XY}\Sigma_{YY}^{-1/2}d}{\sqrt{c%
^{\prime}c}\sqrt{d^{\prime}d}}.
  </annotation>
 </semantics>
</math>

</p>

<p>By the <a href="Cauchy-Schwarz_inequality" title="wikilink">Cauchy-Schwarz inequality</a>, we have</p>

<p>

<math display="block" id="Canonical_correlation:22">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mrow>
      <mo>(</mo>
      <mrow>
       <msup>
        <mi>c</mi>
        <mo>′</mo>
       </msup>
       <msubsup>
        <mi mathvariant="normal">Σ</mi>
        <mrow>
         <mi>X</mi>
         <mi>X</mi>
        </mrow>
        <mrow>
         <mo>-</mo>
         <mrow>
          <mn>1</mn>
          <mo>/</mo>
          <mn>2</mn>
         </mrow>
        </mrow>
       </msubsup>
       <msub>
        <mi mathvariant="normal">Σ</mi>
        <mrow>
         <mi>X</mi>
         <mi>Y</mi>
        </mrow>
       </msub>
       <msubsup>
        <mi mathvariant="normal">Σ</mi>
        <mrow>
         <mi>Y</mi>
         <mi>Y</mi>
        </mrow>
        <mrow>
         <mo>-</mo>
         <mrow>
          <mn>1</mn>
          <mo>/</mo>
          <mn>2</mn>
         </mrow>
        </mrow>
       </msubsup>
      </mrow>
      <mo>)</mo>
     </mrow>
     <mi>d</mi>
    </mrow>
    <mo>≤</mo>
    <mrow>
     <msup>
      <mrow>
       <mo>(</mo>
       <mrow>
        <msup>
         <mi>c</mi>
         <mo>′</mo>
        </msup>
        <msubsup>
         <mi mathvariant="normal">Σ</mi>
         <mrow>
          <mi>X</mi>
          <mi>X</mi>
         </mrow>
         <mrow>
          <mo>-</mo>
          <mrow>
           <mn>1</mn>
           <mo>/</mo>
           <mn>2</mn>
          </mrow>
         </mrow>
        </msubsup>
        <msub>
         <mi mathvariant="normal">Σ</mi>
         <mrow>
          <mi>X</mi>
          <mi>Y</mi>
         </mrow>
        </msub>
        <msubsup>
         <mi mathvariant="normal">Σ</mi>
         <mrow>
          <mi>Y</mi>
          <mi>Y</mi>
         </mrow>
         <mrow>
          <mo>-</mo>
          <mrow>
           <mn>1</mn>
           <mo>/</mo>
           <mn>2</mn>
          </mrow>
         </mrow>
        </msubsup>
        <msubsup>
         <mi mathvariant="normal">Σ</mi>
         <mrow>
          <mi>Y</mi>
          <mi>Y</mi>
         </mrow>
         <mrow>
          <mo>-</mo>
          <mrow>
           <mn>1</mn>
           <mo>/</mo>
           <mn>2</mn>
          </mrow>
         </mrow>
        </msubsup>
        <msub>
         <mi mathvariant="normal">Σ</mi>
         <mrow>
          <mi>Y</mi>
          <mi>X</mi>
         </mrow>
        </msub>
        <msubsup>
         <mi mathvariant="normal">Σ</mi>
         <mrow>
          <mi>X</mi>
          <mi>X</mi>
         </mrow>
         <mrow>
          <mo>-</mo>
          <mrow>
           <mn>1</mn>
           <mo>/</mo>
           <mn>2</mn>
          </mrow>
         </mrow>
        </msubsup>
        <mi>c</mi>
       </mrow>
       <mo>)</mo>
      </mrow>
      <mrow>
       <mn>1</mn>
       <mo>/</mo>
       <mn>2</mn>
      </mrow>
     </msup>
     <msup>
      <mrow>
       <mo>(</mo>
       <mrow>
        <msup>
         <mi>d</mi>
         <mo>′</mo>
        </msup>
        <mi>d</mi>
       </mrow>
       <mo>)</mo>
      </mrow>
      <mrow>
       <mn>1</mn>
       <mo>/</mo>
       <mn>2</mn>
      </mrow>
     </msup>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <leq></leq>
    <apply>
     <times></times>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>c</ci>
       <ci>normal-′</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>normal-Σ</ci>
        <apply>
         <times></times>
         <ci>X</ci>
         <ci>X</ci>
        </apply>
       </apply>
       <apply>
        <minus></minus>
        <apply>
         <divide></divide>
         <cn type="integer">1</cn>
         <cn type="integer">2</cn>
        </apply>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>normal-Σ</ci>
       <apply>
        <times></times>
        <ci>X</ci>
        <ci>Y</ci>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>normal-Σ</ci>
        <apply>
         <times></times>
         <ci>Y</ci>
         <ci>Y</ci>
        </apply>
       </apply>
       <apply>
        <minus></minus>
        <apply>
         <divide></divide>
         <cn type="integer">1</cn>
         <cn type="integer">2</cn>
        </apply>
       </apply>
      </apply>
     </apply>
     <ci>d</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>c</ci>
        <ci>normal-′</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>normal-Σ</ci>
         <apply>
          <times></times>
          <ci>X</ci>
          <ci>X</ci>
         </apply>
        </apply>
        <apply>
         <minus></minus>
         <apply>
          <divide></divide>
          <cn type="integer">1</cn>
          <cn type="integer">2</cn>
         </apply>
        </apply>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>normal-Σ</ci>
        <apply>
         <times></times>
         <ci>X</ci>
         <ci>Y</ci>
        </apply>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>normal-Σ</ci>
         <apply>
          <times></times>
          <ci>Y</ci>
          <ci>Y</ci>
         </apply>
        </apply>
        <apply>
         <minus></minus>
         <apply>
          <divide></divide>
          <cn type="integer">1</cn>
          <cn type="integer">2</cn>
         </apply>
        </apply>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>normal-Σ</ci>
         <apply>
          <times></times>
          <ci>Y</ci>
          <ci>Y</ci>
         </apply>
        </apply>
        <apply>
         <minus></minus>
         <apply>
          <divide></divide>
          <cn type="integer">1</cn>
          <cn type="integer">2</cn>
         </apply>
        </apply>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>normal-Σ</ci>
        <apply>
         <times></times>
         <ci>Y</ci>
         <ci>X</ci>
        </apply>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>normal-Σ</ci>
         <apply>
          <times></times>
          <ci>X</ci>
          <ci>X</ci>
         </apply>
        </apply>
        <apply>
         <minus></minus>
         <apply>
          <divide></divide>
          <cn type="integer">1</cn>
          <cn type="integer">2</cn>
         </apply>
        </apply>
       </apply>
       <ci>c</ci>
      </apply>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <cn type="integer">2</cn>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>d</ci>
        <ci>normal-′</ci>
       </apply>
       <ci>d</ci>
      </apply>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \left(c^{\prime}\Sigma_{XX}^{-1/2}\Sigma_{XY}\Sigma_{YY}^{-1/2}\right)d\leq%
\left(c^{\prime}\Sigma_{XX}^{-1/2}\Sigma_{XY}\Sigma_{YY}^{-1/2}\Sigma_{YY}^{-1%
/2}\Sigma_{YX}\Sigma_{XX}^{-1/2}c\right)^{1/2}\left(d^{\prime}d\right)^{1/2},
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Canonical_correlation:23">
 <semantics>
  <mrow>
   <mrow>
    <mi>ρ</mi>
    <mo>≤</mo>
    <mfrac>
     <msup>
      <mrow>
       <mo>(</mo>
       <mrow>
        <msup>
         <mi>c</mi>
         <mo>′</mo>
        </msup>
        <msubsup>
         <mi mathvariant="normal">Σ</mi>
         <mrow>
          <mi>X</mi>
          <mi>X</mi>
         </mrow>
         <mrow>
          <mo>-</mo>
          <mrow>
           <mn>1</mn>
           <mo>/</mo>
           <mn>2</mn>
          </mrow>
         </mrow>
        </msubsup>
        <msub>
         <mi mathvariant="normal">Σ</mi>
         <mrow>
          <mi>X</mi>
          <mi>Y</mi>
         </mrow>
        </msub>
        <msubsup>
         <mi mathvariant="normal">Σ</mi>
         <mrow>
          <mi>Y</mi>
          <mi>Y</mi>
         </mrow>
         <mrow>
          <mo>-</mo>
          <mn>1</mn>
         </mrow>
        </msubsup>
        <msub>
         <mi mathvariant="normal">Σ</mi>
         <mrow>
          <mi>Y</mi>
          <mi>X</mi>
         </mrow>
        </msub>
        <msubsup>
         <mi mathvariant="normal">Σ</mi>
         <mrow>
          <mi>X</mi>
          <mi>X</mi>
         </mrow>
         <mrow>
          <mo>-</mo>
          <mrow>
           <mn>1</mn>
           <mo>/</mo>
           <mn>2</mn>
          </mrow>
         </mrow>
        </msubsup>
        <mi>c</mi>
       </mrow>
       <mo>)</mo>
      </mrow>
      <mrow>
       <mn>1</mn>
       <mo>/</mo>
       <mn>2</mn>
      </mrow>
     </msup>
     <msup>
      <mrow>
       <mo>(</mo>
       <mrow>
        <msup>
         <mi>c</mi>
         <mo>′</mo>
        </msup>
        <mi>c</mi>
       </mrow>
       <mo>)</mo>
      </mrow>
      <mrow>
       <mn>1</mn>
       <mo>/</mo>
       <mn>2</mn>
      </mrow>
     </msup>
    </mfrac>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <leq></leq>
    <ci>ρ</ci>
    <apply>
     <divide></divide>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>c</ci>
        <ci>normal-′</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>normal-Σ</ci>
         <apply>
          <times></times>
          <ci>X</ci>
          <ci>X</ci>
         </apply>
        </apply>
        <apply>
         <minus></minus>
         <apply>
          <divide></divide>
          <cn type="integer">1</cn>
          <cn type="integer">2</cn>
         </apply>
        </apply>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>normal-Σ</ci>
        <apply>
         <times></times>
         <ci>X</ci>
         <ci>Y</ci>
        </apply>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>normal-Σ</ci>
         <apply>
          <times></times>
          <ci>Y</ci>
          <ci>Y</ci>
         </apply>
        </apply>
        <apply>
         <minus></minus>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>normal-Σ</ci>
        <apply>
         <times></times>
         <ci>Y</ci>
         <ci>X</ci>
        </apply>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>normal-Σ</ci>
         <apply>
          <times></times>
          <ci>X</ci>
          <ci>X</ci>
         </apply>
        </apply>
        <apply>
         <minus></minus>
         <apply>
          <divide></divide>
          <cn type="integer">1</cn>
          <cn type="integer">2</cn>
         </apply>
        </apply>
       </apply>
       <ci>c</ci>
      </apply>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <cn type="integer">2</cn>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>c</ci>
        <ci>normal-′</ci>
       </apply>
       <ci>c</ci>
      </apply>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \rho\leq\frac{\left(c^{\prime}\Sigma_{XX}^{-1/2}\Sigma_{XY}\Sigma_{YY}^{-1}%
\Sigma_{YX}\Sigma_{XX}^{-1/2}c\right)^{1/2}}{\left(c^{\prime}c\right)^{1/2}}.
  </annotation>
 </semantics>
</math>

</p>

<p>There is equality if the vectors 

<math display="inline" id="Canonical_correlation:24">
 <semantics>
  <mi>d</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>d</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   d
  </annotation>
 </semantics>
</math>


 and 

<math display="inline" id="Canonical_correlation:25">
 <semantics>
  <mrow>
   <msubsup>
    <mi mathvariant="normal">Σ</mi>
    <mrow>
     <mi>Y</mi>
     <mi>Y</mi>
    </mrow>
    <mrow>
     <mo>-</mo>
     <mrow>
      <mn>1</mn>
      <mo>/</mo>
      <mn>2</mn>
     </mrow>
    </mrow>
   </msubsup>
   <msub>
    <mi mathvariant="normal">Σ</mi>
    <mrow>
     <mi>Y</mi>
     <mi>X</mi>
    </mrow>
   </msub>
   <msubsup>
    <mi mathvariant="normal">Σ</mi>
    <mrow>
     <mi>X</mi>
     <mi>X</mi>
    </mrow>
    <mrow>
     <mo>-</mo>
     <mrow>
      <mn>1</mn>
      <mo>/</mo>
      <mn>2</mn>
     </mrow>
    </mrow>
   </msubsup>
   <mi>c</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>normal-Σ</ci>
      <apply>
       <times></times>
       <ci>Y</ci>
       <ci>Y</ci>
      </apply>
     </apply>
     <apply>
      <minus></minus>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>normal-Σ</ci>
     <apply>
      <times></times>
      <ci>Y</ci>
      <ci>X</ci>
     </apply>
    </apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>normal-Σ</ci>
      <apply>
       <times></times>
       <ci>X</ci>
       <ci>X</ci>
      </apply>
     </apply>
     <apply>
      <minus></minus>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
    <ci>c</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Sigma_{YY}^{-1/2}\Sigma_{YX}\Sigma_{XX}^{-1/2}c
  </annotation>
 </semantics>
</math>

 are collinear. In addition, the maximum of correlation is attained if 

<math display="inline" id="Canonical_correlation:26">
 <semantics>
  <mi>c</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>c</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   c
  </annotation>
 </semantics>
</math>

 is the <a class="uri" href="eigenvector" title="wikilink">eigenvector</a> with the maximum eigenvalue for the matrix 

<math display="inline" id="Canonical_correlation:27">
 <semantics>
  <mrow>
   <msubsup>
    <mi mathvariant="normal">Σ</mi>
    <mrow>
     <mi>X</mi>
     <mi>X</mi>
    </mrow>
    <mrow>
     <mo>-</mo>
     <mrow>
      <mn>1</mn>
      <mo>/</mo>
      <mn>2</mn>
     </mrow>
    </mrow>
   </msubsup>
   <msub>
    <mi mathvariant="normal">Σ</mi>
    <mrow>
     <mi>X</mi>
     <mi>Y</mi>
    </mrow>
   </msub>
   <msubsup>
    <mi mathvariant="normal">Σ</mi>
    <mrow>
     <mi>Y</mi>
     <mi>Y</mi>
    </mrow>
    <mrow>
     <mo>-</mo>
     <mn>1</mn>
    </mrow>
   </msubsup>
   <msub>
    <mi mathvariant="normal">Σ</mi>
    <mrow>
     <mi>Y</mi>
     <mi>X</mi>
    </mrow>
   </msub>
   <msubsup>
    <mi mathvariant="normal">Σ</mi>
    <mrow>
     <mi>X</mi>
     <mi>X</mi>
    </mrow>
    <mrow>
     <mo>-</mo>
     <mrow>
      <mn>1</mn>
      <mo>/</mo>
      <mn>2</mn>
     </mrow>
    </mrow>
   </msubsup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>normal-Σ</ci>
      <apply>
       <times></times>
       <ci>X</ci>
       <ci>X</ci>
      </apply>
     </apply>
     <apply>
      <minus></minus>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>normal-Σ</ci>
     <apply>
      <times></times>
      <ci>X</ci>
      <ci>Y</ci>
     </apply>
    </apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>normal-Σ</ci>
      <apply>
       <times></times>
       <ci>Y</ci>
       <ci>Y</ci>
      </apply>
     </apply>
     <apply>
      <minus></minus>
      <cn type="integer">1</cn>
     </apply>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>normal-Σ</ci>
     <apply>
      <times></times>
      <ci>Y</ci>
      <ci>X</ci>
     </apply>
    </apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>normal-Σ</ci>
      <apply>
       <times></times>
       <ci>X</ci>
       <ci>X</ci>
      </apply>
     </apply>
     <apply>
      <minus></minus>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Sigma_{XX}^{-1/2}\Sigma_{XY}\Sigma_{YY}^{-1}\Sigma_{YX}\Sigma_{XX}^{-1/2}
  </annotation>
 </semantics>
</math>

 (see <a href="Rayleigh_quotient" title="wikilink">Rayleigh quotient</a>). The subsequent pairs are found by using <a class="uri" href="eigenvalues" title="wikilink">eigenvalues</a> of decreasing magnitudes. Orthogonality is guaranteed by the symmetry of the correlation matrices.</p>
<h3 id="solution">Solution</h3>

<p>The solution is therefore:</p>
<ul>
<li>

<math display="inline" id="Canonical_correlation:28">
 <semantics>
  <mi>c</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>c</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   c
  </annotation>
 </semantics>
</math>

 is an eigenvector of 

<math display="inline" id="Canonical_correlation:29">
 <semantics>
  <mrow>
   <msubsup>
    <mi mathvariant="normal">Σ</mi>
    <mrow>
     <mi>X</mi>
     <mi>X</mi>
    </mrow>
    <mrow>
     <mo>-</mo>
     <mrow>
      <mn>1</mn>
      <mo>/</mo>
      <mn>2</mn>
     </mrow>
    </mrow>
   </msubsup>
   <msub>
    <mi mathvariant="normal">Σ</mi>
    <mrow>
     <mi>X</mi>
     <mi>Y</mi>
    </mrow>
   </msub>
   <msubsup>
    <mi mathvariant="normal">Σ</mi>
    <mrow>
     <mi>Y</mi>
     <mi>Y</mi>
    </mrow>
    <mrow>
     <mo>-</mo>
     <mn>1</mn>
    </mrow>
   </msubsup>
   <msub>
    <mi mathvariant="normal">Σ</mi>
    <mrow>
     <mi>Y</mi>
     <mi>X</mi>
    </mrow>
   </msub>
   <msubsup>
    <mi mathvariant="normal">Σ</mi>
    <mrow>
     <mi>X</mi>
     <mi>X</mi>
    </mrow>
    <mrow>
     <mo>-</mo>
     <mrow>
      <mn>1</mn>
      <mo>/</mo>
      <mn>2</mn>
     </mrow>
    </mrow>
   </msubsup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>normal-Σ</ci>
      <apply>
       <times></times>
       <ci>X</ci>
       <ci>X</ci>
      </apply>
     </apply>
     <apply>
      <minus></minus>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>normal-Σ</ci>
     <apply>
      <times></times>
      <ci>X</ci>
      <ci>Y</ci>
     </apply>
    </apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>normal-Σ</ci>
      <apply>
       <times></times>
       <ci>Y</ci>
       <ci>Y</ci>
      </apply>
     </apply>
     <apply>
      <minus></minus>
      <cn type="integer">1</cn>
     </apply>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>normal-Σ</ci>
     <apply>
      <times></times>
      <ci>Y</ci>
      <ci>X</ci>
     </apply>
    </apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>normal-Σ</ci>
      <apply>
       <times></times>
       <ci>X</ci>
       <ci>X</ci>
      </apply>
     </apply>
     <apply>
      <minus></minus>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Sigma_{XX}^{-1/2}\Sigma_{XY}\Sigma_{YY}^{-1}\Sigma_{YX}\Sigma_{XX}^{-1/2}
  </annotation>
 </semantics>
</math>


</li>
<li>

<math display="inline" id="Canonical_correlation:30">
 <semantics>
  <mi>d</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>d</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   d
  </annotation>
 </semantics>
</math>

 is proportional to 

<math display="inline" id="Canonical_correlation:31">
 <semantics>
  <mrow>
   <msubsup>
    <mi mathvariant="normal">Σ</mi>
    <mrow>
     <mi>Y</mi>
     <mi>Y</mi>
    </mrow>
    <mrow>
     <mo>-</mo>
     <mrow>
      <mn>1</mn>
      <mo>/</mo>
      <mn>2</mn>
     </mrow>
    </mrow>
   </msubsup>
   <msub>
    <mi mathvariant="normal">Σ</mi>
    <mrow>
     <mi>Y</mi>
     <mi>X</mi>
    </mrow>
   </msub>
   <msubsup>
    <mi mathvariant="normal">Σ</mi>
    <mrow>
     <mi>X</mi>
     <mi>X</mi>
    </mrow>
    <mrow>
     <mo>-</mo>
     <mrow>
      <mn>1</mn>
      <mo>/</mo>
      <mn>2</mn>
     </mrow>
    </mrow>
   </msubsup>
   <mi>c</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>normal-Σ</ci>
      <apply>
       <times></times>
       <ci>Y</ci>
       <ci>Y</ci>
      </apply>
     </apply>
     <apply>
      <minus></minus>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>normal-Σ</ci>
     <apply>
      <times></times>
      <ci>Y</ci>
      <ci>X</ci>
     </apply>
    </apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>normal-Σ</ci>
      <apply>
       <times></times>
       <ci>X</ci>
       <ci>X</ci>
      </apply>
     </apply>
     <apply>
      <minus></minus>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
    <ci>c</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Sigma_{YY}^{-1/2}\Sigma_{YX}\Sigma_{XX}^{-1/2}c
  </annotation>
 </semantics>
</math>

</li>
</ul>

<p>Reciprocally, there is also:</p>
<ul>
<li>

<math display="inline" id="Canonical_correlation:32">
 <semantics>
  <mi>d</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>d</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   d
  </annotation>
 </semantics>
</math>

 is an eigenvector of 

<math display="inline" id="Canonical_correlation:33">
 <semantics>
  <mrow>
   <msubsup>
    <mi mathvariant="normal">Σ</mi>
    <mrow>
     <mi>Y</mi>
     <mi>Y</mi>
    </mrow>
    <mrow>
     <mo>-</mo>
     <mrow>
      <mn>1</mn>
      <mo>/</mo>
      <mn>2</mn>
     </mrow>
    </mrow>
   </msubsup>
   <msub>
    <mi mathvariant="normal">Σ</mi>
    <mrow>
     <mi>Y</mi>
     <mi>X</mi>
    </mrow>
   </msub>
   <msubsup>
    <mi mathvariant="normal">Σ</mi>
    <mrow>
     <mi>X</mi>
     <mi>X</mi>
    </mrow>
    <mrow>
     <mo>-</mo>
     <mn>1</mn>
    </mrow>
   </msubsup>
   <msub>
    <mi mathvariant="normal">Σ</mi>
    <mrow>
     <mi>X</mi>
     <mi>Y</mi>
    </mrow>
   </msub>
   <msubsup>
    <mi mathvariant="normal">Σ</mi>
    <mrow>
     <mi>Y</mi>
     <mi>Y</mi>
    </mrow>
    <mrow>
     <mo>-</mo>
     <mrow>
      <mn>1</mn>
      <mo>/</mo>
      <mn>2</mn>
     </mrow>
    </mrow>
   </msubsup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>normal-Σ</ci>
      <apply>
       <times></times>
       <ci>Y</ci>
       <ci>Y</ci>
      </apply>
     </apply>
     <apply>
      <minus></minus>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>normal-Σ</ci>
     <apply>
      <times></times>
      <ci>Y</ci>
      <ci>X</ci>
     </apply>
    </apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>normal-Σ</ci>
      <apply>
       <times></times>
       <ci>X</ci>
       <ci>X</ci>
      </apply>
     </apply>
     <apply>
      <minus></minus>
      <cn type="integer">1</cn>
     </apply>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>normal-Σ</ci>
     <apply>
      <times></times>
      <ci>X</ci>
      <ci>Y</ci>
     </apply>
    </apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>normal-Σ</ci>
      <apply>
       <times></times>
       <ci>Y</ci>
       <ci>Y</ci>
      </apply>
     </apply>
     <apply>
      <minus></minus>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Sigma_{YY}^{-1/2}\Sigma_{YX}\Sigma_{XX}^{-1}\Sigma_{XY}\Sigma_{YY}^{-1/2}
  </annotation>
 </semantics>
</math>

</li>
<li>

<math display="inline" id="Canonical_correlation:34">
 <semantics>
  <mi>c</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>c</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   c
  </annotation>
 </semantics>
</math>


 is proportional to 

<math display="inline" id="Canonical_correlation:35">
 <semantics>
  <mrow>
   <msubsup>
    <mi mathvariant="normal">Σ</mi>
    <mrow>
     <mi>X</mi>
     <mi>X</mi>
    </mrow>
    <mrow>
     <mo>-</mo>
     <mrow>
      <mn>1</mn>
      <mo>/</mo>
      <mn>2</mn>
     </mrow>
    </mrow>
   </msubsup>
   <msub>
    <mi mathvariant="normal">Σ</mi>
    <mrow>
     <mi>X</mi>
     <mi>Y</mi>
    </mrow>
   </msub>
   <msubsup>
    <mi mathvariant="normal">Σ</mi>
    <mrow>
     <mi>Y</mi>
     <mi>Y</mi>
    </mrow>
    <mrow>
     <mo>-</mo>
     <mrow>
      <mn>1</mn>
      <mo>/</mo>
      <mn>2</mn>
     </mrow>
    </mrow>
   </msubsup>
   <mi>d</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>normal-Σ</ci>
      <apply>
       <times></times>
       <ci>X</ci>
       <ci>X</ci>
      </apply>
     </apply>
     <apply>
      <minus></minus>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>normal-Σ</ci>
     <apply>
      <times></times>
      <ci>X</ci>
      <ci>Y</ci>
     </apply>
    </apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>normal-Σ</ci>
      <apply>
       <times></times>
       <ci>Y</ci>
       <ci>Y</ci>
      </apply>
     </apply>
     <apply>
      <minus></minus>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
    <ci>d</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Sigma_{XX}^{-1/2}\Sigma_{XY}\Sigma_{YY}^{-1/2}d
  </annotation>
 </semantics>
</math>

</li>
</ul>

<p>Reversing the change of coordinates, we have that</p>
<ul>
<li>

<math display="inline" id="Canonical_correlation:36">
 <semantics>
  <mi>a</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>a</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a
  </annotation>
 </semantics>
</math>

 is an eigenvector of 

<math display="inline" id="Canonical_correlation:37">
 <semantics>
  <mrow>
   <msubsup>
    <mi mathvariant="normal">Σ</mi>
    <mrow>
     <mi>X</mi>
     <mi>X</mi>
    </mrow>
    <mrow>
     <mo>-</mo>
     <mn>1</mn>
    </mrow>
   </msubsup>
   <msub>
    <mi mathvariant="normal">Σ</mi>
    <mrow>
     <mi>X</mi>
     <mi>Y</mi>
    </mrow>
   </msub>
   <msubsup>
    <mi mathvariant="normal">Σ</mi>
    <mrow>
     <mi>Y</mi>
     <mi>Y</mi>
    </mrow>
    <mrow>
     <mo>-</mo>
     <mn>1</mn>
    </mrow>
   </msubsup>
   <msub>
    <mi mathvariant="normal">Σ</mi>
    <mrow>
     <mi>Y</mi>
     <mi>X</mi>
    </mrow>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>normal-Σ</ci>
      <apply>
       <times></times>
       <ci>X</ci>
       <ci>X</ci>
      </apply>
     </apply>
     <apply>
      <minus></minus>
      <cn type="integer">1</cn>
     </apply>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>normal-Σ</ci>
     <apply>
      <times></times>
      <ci>X</ci>
      <ci>Y</ci>
     </apply>
    </apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>normal-Σ</ci>
      <apply>
       <times></times>
       <ci>Y</ci>
       <ci>Y</ci>
      </apply>
     </apply>
     <apply>
      <minus></minus>
      <cn type="integer">1</cn>
     </apply>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>normal-Σ</ci>
     <apply>
      <times></times>
      <ci>Y</ci>
      <ci>X</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Sigma_{XX}^{-1}\Sigma_{XY}\Sigma_{YY}^{-1}\Sigma_{YX}
  </annotation>
 </semantics>
</math>

</li>
<li>

<math display="inline" id="Canonical_correlation:38">
 <semantics>
  <mi>b</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>b</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   b
  </annotation>
 </semantics>
</math>

 is an eigenvector of 

<math display="inline" id="Canonical_correlation:39">
 <semantics>
  <mrow>
   <msubsup>
    <mi mathvariant="normal">Σ</mi>
    <mrow>
     <mi>Y</mi>
     <mi>Y</mi>
    </mrow>
    <mrow>
     <mo>-</mo>
     <mn>1</mn>
    </mrow>
   </msubsup>
   <msub>
    <mi mathvariant="normal">Σ</mi>
    <mrow>
     <mi>Y</mi>
     <mi>X</mi>
    </mrow>
   </msub>
   <msubsup>
    <mi mathvariant="normal">Σ</mi>
    <mrow>
     <mi>X</mi>
     <mi>X</mi>
    </mrow>
    <mrow>
     <mo>-</mo>
     <mn>1</mn>
    </mrow>
   </msubsup>
   <msub>
    <mi mathvariant="normal">Σ</mi>
    <mrow>
     <mi>X</mi>
     <mi>Y</mi>
    </mrow>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>normal-Σ</ci>
      <apply>
       <times></times>
       <ci>Y</ci>
       <ci>Y</ci>
      </apply>
     </apply>
     <apply>
      <minus></minus>
      <cn type="integer">1</cn>
     </apply>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>normal-Σ</ci>
     <apply>
      <times></times>
      <ci>Y</ci>
      <ci>X</ci>
     </apply>
    </apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>normal-Σ</ci>
      <apply>
       <times></times>
       <ci>X</ci>
       <ci>X</ci>
      </apply>
     </apply>
     <apply>
      <minus></minus>
      <cn type="integer">1</cn>
     </apply>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>normal-Σ</ci>
     <apply>
      <times></times>
      <ci>X</ci>
      <ci>Y</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Sigma_{YY}^{-1}\Sigma_{YX}\Sigma_{XX}^{-1}\Sigma_{XY}
  </annotation>
 </semantics>
</math>


</li>
<li>

<math display="inline" id="Canonical_correlation:40">
 <semantics>
  <mi>a</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>a</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a
  </annotation>
 </semantics>
</math>

 is proportional to 

<math display="inline" id="Canonical_correlation:41">
 <semantics>
  <mrow>
   <msubsup>
    <mi mathvariant="normal">Σ</mi>
    <mrow>
     <mi>X</mi>
     <mi>X</mi>
    </mrow>
    <mrow>
     <mo>-</mo>
     <mn>1</mn>
    </mrow>
   </msubsup>
   <msub>
    <mi mathvariant="normal">Σ</mi>
    <mrow>
     <mi>X</mi>
     <mi>Y</mi>
    </mrow>
   </msub>
   <mi>b</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>normal-Σ</ci>
      <apply>
       <times></times>
       <ci>X</ci>
       <ci>X</ci>
      </apply>
     </apply>
     <apply>
      <minus></minus>
      <cn type="integer">1</cn>
     </apply>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>normal-Σ</ci>
     <apply>
      <times></times>
      <ci>X</ci>
      <ci>Y</ci>
     </apply>
    </apply>
    <ci>b</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Sigma_{XX}^{-1}\Sigma_{XY}b
  </annotation>
 </semantics>
</math>

</li>
<li>

<math display="inline" id="Canonical_correlation:42">
 <semantics>
  <mi>b</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>b</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   b
  </annotation>
 </semantics>
</math>

 is proportional to 

<math display="inline" id="Canonical_correlation:43">
 <semantics>
  <mrow>
   <msubsup>
    <mi mathvariant="normal">Σ</mi>
    <mrow>
     <mi>Y</mi>
     <mi>Y</mi>
    </mrow>
    <mrow>
     <mo>-</mo>
     <mn>1</mn>
    </mrow>
   </msubsup>
   <msub>
    <mi mathvariant="normal">Σ</mi>
    <mrow>
     <mi>Y</mi>
     <mi>X</mi>
    </mrow>
   </msub>
   <mi>a</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>normal-Σ</ci>
      <apply>
       <times></times>
       <ci>Y</ci>
       <ci>Y</ci>
      </apply>
     </apply>
     <apply>
      <minus></minus>
      <cn type="integer">1</cn>
     </apply>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>normal-Σ</ci>
     <apply>
      <times></times>
      <ci>Y</ci>
      <ci>X</ci>
     </apply>
    </apply>
    <ci>a</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Sigma_{YY}^{-1}\Sigma_{YX}a
  </annotation>
 </semantics>
</math>

</li>
</ul>

<p>The canonical variables are defined by:</p>

<p>

<math display="block" id="Canonical_correlation:44">
 <semantics>
  <mrow>
   <mi>U</mi>
   <mo>=</mo>
   <mrow>
    <msup>
     <mi>c</mi>
     <mo>′</mo>
    </msup>
    <msubsup>
     <mi mathvariant="normal">Σ</mi>
     <mrow>
      <mi>X</mi>
      <mi>X</mi>
     </mrow>
     <mrow>
      <mo>-</mo>
      <mrow>
       <mn>1</mn>
       <mo>/</mo>
       <mn>2</mn>
      </mrow>
     </mrow>
    </msubsup>
    <mi>X</mi>
   </mrow>
   <mo>=</mo>
   <mrow>
    <msup>
     <mi>a</mi>
     <mo>′</mo>
    </msup>
    <mi>X</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <ci>U</ci>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>c</ci>
       <ci>normal-′</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>normal-Σ</ci>
        <apply>
         <times></times>
         <ci>X</ci>
         <ci>X</ci>
        </apply>
       </apply>
       <apply>
        <minus></minus>
        <apply>
         <divide></divide>
         <cn type="integer">1</cn>
         <cn type="integer">2</cn>
        </apply>
       </apply>
      </apply>
      <ci>X</ci>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>a</ci>
       <ci>normal-′</ci>
      </apply>
      <ci>X</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   U=c^{\prime}\Sigma_{XX}^{-1/2}X=a^{\prime}X
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Canonical_correlation:45">
 <semantics>
  <mrow>
   <mi>V</mi>
   <mo>=</mo>
   <mrow>
    <msup>
     <mi>d</mi>
     <mo>′</mo>
    </msup>
    <msubsup>
     <mi mathvariant="normal">Σ</mi>
     <mrow>
      <mi>Y</mi>
      <mi>Y</mi>
     </mrow>
     <mrow>
      <mo>-</mo>
      <mrow>
       <mn>1</mn>
       <mo>/</mo>
       <mn>2</mn>
      </mrow>
     </mrow>
    </msubsup>
    <mi>Y</mi>
   </mrow>
   <mo>=</mo>
   <mrow>
    <msup>
     <mi>b</mi>
     <mo>′</mo>
    </msup>
    <mi>Y</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <ci>V</ci>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>d</ci>
       <ci>normal-′</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>normal-Σ</ci>
        <apply>
         <times></times>
         <ci>Y</ci>
         <ci>Y</ci>
        </apply>
       </apply>
       <apply>
        <minus></minus>
        <apply>
         <divide></divide>
         <cn type="integer">1</cn>
         <cn type="integer">2</cn>
        </apply>
       </apply>
      </apply>
      <ci>Y</ci>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>b</ci>
       <ci>normal-′</ci>
      </apply>
      <ci>Y</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   V=d^{\prime}\Sigma_{YY}^{-1/2}Y=b^{\prime}Y
  </annotation>
 </semantics>
</math>

</p>
<h3 id="implementation">Implementation</h3>

<p>CCA can be computed using <a href="singular_value_decomposition" title="wikilink">singular value decomposition</a> on a correlation matrix.<a class="footnoteRef" href="#fn4" id="fnref4"><sup>4</sup></a> It is available as a function in<a class="footnoteRef" href="#fn5" id="fnref5"><sup>5</sup></a></p>
<ul>
<li><a class="uri" href="MATLAB" title="wikilink">MATLAB</a> as <a href="http://www.mathworks.co.uk/help/stats/canoncorr.html">canoncorr</a></li>
<li><a href="R_(programming_language)" title="wikilink">R</a> as <a href="http://stat.ethz.ch/R-manual/R-devel/library/stats/html/cancor.html">cancor</a> or in <a href="http://factominer.free.fr/">FactoMineR</a></li>
<li><a href="SAS_language" title="wikilink">SAS</a> as <a href="http://support.sas.com/documentation/cdl/en/statug/63033/HTML/default/viewer.htm#statug_cancorr_sect005.htm">proc cancorr</a></li>
<li><a class="uri" href="Scikit-Learn" title="wikilink">Scikit-Learn</a>, <a href="Python_(programming_language)" title="wikilink">Python</a> as <a href="http://scikit-learn.org/stable/modules/cross_decomposition.html">Cross decomposition</a></li>
</ul>
<h2 id="hypothesis-testing">Hypothesis testing</h2>

<p>Each row can be tested for significance with the following method. Since the correlations are sorted, saying that row 

<math display="inline" id="Canonical_correlation:46">
 <semantics>
  <mi>i</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>i</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   i
  </annotation>
 </semantics>
</math>

 is zero implies all further correlations are also zero. If we have 

<math display="inline" id="Canonical_correlation:47">
 <semantics>
  <mi>p</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>p</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p
  </annotation>
 </semantics>
</math>

 independent observations in a sample and 

<math display="inline" id="Canonical_correlation:48">
 <semantics>
  <msub>
   <mover accent="true">
    <mi>ρ</mi>
    <mo>^</mo>
   </mover>
   <mi>i</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <apply>
     <ci>normal-^</ci>
     <ci>ρ</ci>
    </apply>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \widehat{\rho}_{i}
  </annotation>
 </semantics>
</math>

 is the estimated correlation for 

<math display="inline" id="Canonical_correlation:49">
 <semantics>
  <mrow>
   <mi>i</mi>
   <mo>=</mo>
   <mrow>
    <mn>1</mn>
    <mo>,</mo>
    <mi mathvariant="normal">…</mi>
    <mo>,</mo>
    <mrow>
     <mi>min</mi>
     <mrow>
      <mo stretchy="false">{</mo>
      <mi>m</mi>
      <mo>,</mo>
      <mi>n</mi>
      <mo stretchy="false">}</mo>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>i</ci>
    <list>
     <cn type="integer">1</cn>
     <ci>normal-…</ci>
     <apply>
      <min></min>
      <ci>m</ci>
      <ci>n</ci>
     </apply>
    </list>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   i=1,\dots,\min\{m,n\}
  </annotation>
 </semantics>
</math>


. For the 

<math display="inline" id="Canonical_correlation:50">
 <semantics>
  <mi>i</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>i</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   i
  </annotation>
 </semantics>
</math>

th row, the test statistic is:</p>

<p>

<math display="block" id="Canonical_correlation:51">
 <semantics>
  <mrow>
   <mrow>
    <msup>
     <mi>χ</mi>
     <mn>2</mn>
    </msup>
    <mo>=</mo>
    <mrow>
     <mo>-</mo>
     <mrow>
      <mrow>
       <mo>(</mo>
       <mrow>
        <mi>p</mi>
        <mo>-</mo>
        <mn>1</mn>
        <mo>-</mo>
        <mrow>
         <mfrac>
          <mn>1</mn>
          <mn>2</mn>
         </mfrac>
         <mrow>
          <mo stretchy="false">(</mo>
          <mrow>
           <mi>m</mi>
           <mo>+</mo>
           <mi>n</mi>
           <mo>+</mo>
           <mn>1</mn>
          </mrow>
          <mo stretchy="false">)</mo>
         </mrow>
        </mrow>
       </mrow>
       <mo>)</mo>
      </mrow>
      <mi>ln</mi>
      <mrow>
       <munderover>
        <mo largeop="true" movablelimits="false" symmetric="true">∏</mo>
        <mrow>
         <mi>j</mi>
         <mo>=</mo>
         <mi>i</mi>
        </mrow>
        <mrow>
         <mi>min</mi>
         <mrow>
          <mo stretchy="false">{</mo>
          <mi>m</mi>
          <mo>,</mo>
          <mi>n</mi>
          <mo stretchy="false">}</mo>
         </mrow>
        </mrow>
       </munderover>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mn>1</mn>
         <mo>-</mo>
         <msubsup>
          <mover accent="true">
           <mi>ρ</mi>
           <mo>^</mo>
          </mover>
          <mi>j</mi>
          <mn>2</mn>
         </msubsup>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>χ</ci>
     <cn type="integer">2</cn>
    </apply>
    <apply>
     <minus></minus>
     <apply>
      <times></times>
      <apply>
       <minus></minus>
       <ci>p</ci>
       <cn type="integer">1</cn>
       <apply>
        <times></times>
        <apply>
         <divide></divide>
         <cn type="integer">1</cn>
         <cn type="integer">2</cn>
        </apply>
        <apply>
         <plus></plus>
         <ci>m</ci>
         <ci>n</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
      </apply>
      <ln></ln>
      <apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <csymbol cd="latexml">product</csymbol>
         <apply>
          <eq></eq>
          <ci>j</ci>
          <ci>i</ci>
         </apply>
        </apply>
        <apply>
         <min></min>
         <ci>m</ci>
         <ci>n</ci>
        </apply>
       </apply>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <apply>
           <ci>normal-^</ci>
           <ci>ρ</ci>
          </apply>
          <ci>j</ci>
         </apply>
         <cn type="integer">2</cn>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \chi^{2}=-\left(p-1-\frac{1}{2}(m+n+1)\right)\ln\prod_{j=i}^{\min\{m,n\}}(1-%
\widehat{\rho}_{j}^{2}),
  </annotation>
 </semantics>
</math>

</p>

<p>which is asymptotically distributed as a <a href="chi-squared_distribution" title="wikilink">chi-squared</a> with 

<math display="inline" id="Canonical_correlation:52">
 <semantics>
  <mrow>
   <mrow>
    <mo stretchy="false">(</mo>
    <mrow>
     <mrow>
      <mi>m</mi>
      <mo>-</mo>
      <mi>i</mi>
     </mrow>
     <mo>+</mo>
     <mn>1</mn>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
   <mrow>
    <mo stretchy="false">(</mo>
    <mrow>
     <mrow>
      <mi>n</mi>
      <mo>-</mo>
      <mi>i</mi>
     </mrow>
     <mo>+</mo>
     <mn>1</mn>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <plus></plus>
     <apply>
      <minus></minus>
      <ci>m</ci>
      <ci>i</ci>
     </apply>
     <cn type="integer">1</cn>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <minus></minus>
      <ci>n</ci>
      <ci>i</ci>
     </apply>
     <cn type="integer">1</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (m-i+1)(n-i+1)
  </annotation>
 </semantics>
</math>

 <a href="degrees_of_freedom_(statistics)" title="wikilink">degrees of freedom</a> for large 

<math display="inline" id="Canonical_correlation:53">
 <semantics>
  <mi>p</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>p</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p
  </annotation>
 </semantics>
</math>

.<a class="footnoteRef" href="#fn6" id="fnref6"><sup>6</sup></a> Since all the correlations from 

<math display="inline" id="Canonical_correlation:54">
 <semantics>
  <mrow>
   <mi>min</mi>
   <mrow>
    <mo stretchy="false">{</mo>
    <mi>m</mi>
    <mo>,</mo>
    <mi>n</mi>
    <mo stretchy="false">}</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <min></min>
    <ci>m</ci>
    <ci>n</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \min\{m,n\}
  </annotation>
 </semantics>
</math>


 to 

<math display="inline" id="Canonical_correlation:55">
 <semantics>
  <mi>p</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>p</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p
  </annotation>
 </semantics>
</math>

 are logically zero (and estimated that way also) the product for the terms after this point is irrelevant.</p>
<h2 id="practical-uses">Practical uses</h2>

<p>A typical use for canonical correlation in the experimental context is to take two sets of variables and see what is common amongst the two sets. For example in psychological testing, you could take two well established multidimensional <a href="personality_tests" title="wikilink">personality tests</a> such as the <a href="Minnesota_Multiphasic_Personality_Inventory" title="wikilink">Minnesota Multiphasic Personality Inventory</a> (MMPI-2) and the <a href="Neuroticism_Extraversion_Openness_Personality_Inventory" title="wikilink">NEO</a>. By seeing how the MMPI-2 factors relate to the NEO factors, you could gain insight into what dimensions were common between the tests and how much variance was shared. For example you might find that an <a href="Extraversion_and_introversion" title="wikilink">extraversion</a> or <a class="uri" href="neuroticism" title="wikilink">neuroticism</a> dimension accounted for a substantial amount of shared variance between the two tests.</p>

<p>One can also use canonical-correlation analysis to produce a model equation which relates two sets of variables, for example a set of performance measures and a set of explanatory variables, or a set of outputs and set of inputs. Constraint restrictions can be imposed on such a model to ensure it reflects theoretical requirements or intuitively obvious conditions. This type of model is known as a maximum correlation model.<a class="footnoteRef" href="#fn7" id="fnref7"><sup>7</sup></a></p>

<p>Visualization of the results of canonical correlation is usually through bar plots of the coefficients of the two sets of variables for the pairs of canonical variates showing significant correlation. Some authors suggest that they are best visualized by plotting them as heliographs, a circular format with ray like bars, with each half representing the two sets of variables.<a class="footnoteRef" href="#fn8" id="fnref8"><sup>8</sup></a></p>
<h2 id="examples">Examples</h2>

<p>Let 

<math display="inline" id="Canonical_correlation:56">
 <semantics>
  <mrow>
   <mi>X</mi>
   <mo>=</mo>
   <msub>
    <mi>x</mi>
    <mn>1</mn>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>X</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>x</ci>
     <cn type="integer">1</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   X=x_{1}
  </annotation>
 </semantics>
</math>

 with zero <a href="expected_value" title="wikilink">expected value</a>, i.e., 

<math display="inline" id="Canonical_correlation:57">
 <semantics>
  <mrow>
   <mrow>
    <mo>E</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>X</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <ci>normal-E</ci>
     <ci>X</ci>
    </apply>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \operatorname{E}(X)=0
  </annotation>
 </semantics>
</math>

. If 

<math display="inline" id="Canonical_correlation:58">
 <semantics>
  <mrow>
   <mi>Y</mi>
   <mo>=</mo>
   <mi>X</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>Y</ci>
    <ci>X</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Y=X
  </annotation>
 </semantics>
</math>

, i.e., 

<math display="inline" id="Canonical_correlation:59">
 <semantics>
  <mi>X</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>X</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   X
  </annotation>
 </semantics>
</math>


 and 

<math display="inline" id="Canonical_correlation:60">
 <semantics>
  <mi>Y</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>Y</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Y
  </annotation>
 </semantics>
</math>

 are perfectly correlated, then, e.g., 

<math display="inline" id="Canonical_correlation:61">
 <semantics>
  <mrow>
   <mi>a</mi>
   <mo>=</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>a</ci>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a=1
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Canonical_correlation:62">
 <semantics>
  <mrow>
   <mi>b</mi>
   <mo>=</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>b</ci>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   b=1
  </annotation>
 </semantics>
</math>

, so that the first (and only in this example) pair of canonical variables is 

<math display="inline" id="Canonical_correlation:63">
 <semantics>
  <mrow>
   <mi>U</mi>
   <mo>=</mo>
   <mi>X</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>U</ci>
    <ci>X</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   U=X
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Canonical_correlation:64">
 <semantics>
  <mrow>
   <mi>V</mi>
   <mo>=</mo>
   <mi>Y</mi>
   <mo>=</mo>
   <mi>X</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <ci>V</ci>
     <ci>Y</ci>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <ci>X</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   V=Y=X
  </annotation>
 </semantics>
</math>


. If 

<math display="inline" id="Canonical_correlation:65">
 <semantics>
  <mrow>
   <mi>Y</mi>
   <mo>=</mo>
   <mrow>
    <mo>-</mo>
    <mi>X</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>Y</ci>
    <apply>
     <minus></minus>
     <ci>X</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Y=-X
  </annotation>
 </semantics>
</math>

, i.e., 

<math display="inline" id="Canonical_correlation:66">
 <semantics>
  <mi>X</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>X</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   X
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Canonical_correlation:67">
 <semantics>
  <mi>Y</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>Y</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Y
  </annotation>
 </semantics>
</math>

 are perfectly anticorrelated, then, e.g., 

<math display="inline" id="Canonical_correlation:68">
 <semantics>
  <mrow>
   <mi>a</mi>
   <mo>=</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>a</ci>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a=1
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Canonical_correlation:69">
 <semantics>
  <mrow>
   <mi>b</mi>
   <mo>=</mo>
   <mrow>
    <mo>-</mo>
    <mn>1</mn>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>b</ci>
    <apply>
     <minus></minus>
     <cn type="integer">1</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   b=-1
  </annotation>
 </semantics>
</math>


, so that the first (and only in this example) pair of canonical variables is 

<math display="inline" id="Canonical_correlation:70">
 <semantics>
  <mrow>
   <mi>U</mi>
   <mo>=</mo>
   <mi>X</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>U</ci>
    <ci>X</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   U=X
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Canonical_correlation:71">
 <semantics>
  <mrow>
   <mi>V</mi>
   <mo>=</mo>
   <mrow>
    <mo>-</mo>
    <mi>Y</mi>
   </mrow>
   <mo>=</mo>
   <mi>X</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <ci>V</ci>
     <apply>
      <minus></minus>
      <ci>Y</ci>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <ci>X</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   V=-Y=X
  </annotation>
 </semantics>
</math>

. We notice that in both cases 

<math display="inline" id="Canonical_correlation:72">
 <semantics>
  <mrow>
   <mi>U</mi>
   <mo>=</mo>
   <mi>V</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>U</ci>
    <ci>V</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   U=V
  </annotation>
 </semantics>
</math>

, which illustrates that the canonical-correlation analysis treats correlated and anticorrelated variables similarly.</p>
<h2 id="connection-to-principal-angles">Connection to principal angles</h2>

<p>Assuming that 

<math display="inline" id="Canonical_correlation:73">
 <semantics>
  <mrow>
   <mi>X</mi>
   <mo>=</mo>
   <msup>
    <mrow>
     <mo stretchy="false">(</mo>
     <msub>
      <mi>x</mi>
      <mn>1</mn>
     </msub>
     <mo>,</mo>
     <mi mathvariant="normal">…</mi>
     <mo>,</mo>
     <msub>
      <mi>x</mi>
      <mi>n</mi>
     </msub>
     <mo stretchy="false">)</mo>
    </mrow>
    <mo>′</mo>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>X</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <vector>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <cn type="integer">1</cn>
      </apply>
      <ci>normal-…</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <ci>n</ci>
      </apply>
     </vector>
     <ci>normal-′</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   X=(x_{1},\dots,x_{n})^{\prime}
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Canonical_correlation:74">
 <semantics>
  <mrow>
   <mi>Y</mi>
   <mo>=</mo>
   <msup>
    <mrow>
     <mo stretchy="false">(</mo>
     <msub>
      <mi>y</mi>
      <mn>1</mn>
     </msub>
     <mo>,</mo>
     <mi mathvariant="normal">…</mi>
     <mo>,</mo>
     <msub>
      <mi>y</mi>
      <mi>m</mi>
     </msub>
     <mo stretchy="false">)</mo>
    </mrow>
    <mo>′</mo>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>Y</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <vector>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>y</ci>
       <cn type="integer">1</cn>
      </apply>
      <ci>normal-…</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>y</ci>
       <ci>m</ci>
      </apply>
     </vector>
     <ci>normal-′</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Y=(y_{1},\dots,y_{m})^{\prime}
  </annotation>
 </semantics>
</math>


 have zero <a href="expected_value" title="wikilink">expected values</a>, i.e., 

<math display="inline" id="Canonical_correlation:75">
 <semantics>
  <mrow>
   <mrow>
    <mo>E</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>X</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mo>E</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>Y</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <ci>normal-E</ci>
      <ci>X</ci>
     </apply>
     <apply>
      <ci>normal-E</ci>
      <ci>Y</ci>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <cn type="integer">0</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \operatorname{E}(X)=\operatorname{E}(Y)=0
  </annotation>
 </semantics>
</math>

, their <a class="uri" href="covariance" title="wikilink">covariance</a> matrices 

<math display="inline" id="Canonical_correlation:76">
 <semantics>
  <mrow>
   <msub>
    <mi mathvariant="normal">Σ</mi>
    <mrow>
     <mi>X</mi>
     <mi>X</mi>
    </mrow>
   </msub>
   <mo>=</mo>
   <mrow>
    <mo>Cov</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>X</mi>
     <mo>,</mo>
     <mi>X</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mo>E</mo>
    <mrow>
     <mo stretchy="false">[</mo>
     <mrow>
      <mi>X</mi>
      <msup>
       <mi>X</mi>
       <mo>′</mo>
      </msup>
     </mrow>
     <mo stretchy="false">]</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>normal-Σ</ci>
      <apply>
       <times></times>
       <ci>X</ci>
       <ci>X</ci>
      </apply>
     </apply>
     <apply>
      <ci>Cov</ci>
      <ci>X</ci>
      <ci>X</ci>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <ci>normal-E</ci>
      <apply>
       <times></times>
       <ci>X</ci>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>X</ci>
        <ci>normal-′</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Sigma_{XX}=\operatorname{Cov}(X,X)=\operatorname{E}[XX^{\prime}]
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Canonical_correlation:77">
 <semantics>
  <mrow>
   <msub>
    <mi mathvariant="normal">Σ</mi>
    <mrow>
     <mi>Y</mi>
     <mi>Y</mi>
    </mrow>
   </msub>
   <mo>=</mo>
   <mrow>
    <mo>Cov</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>Y</mi>
     <mo>,</mo>
     <mi>Y</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mo>E</mo>
    <mrow>
     <mo stretchy="false">[</mo>
     <mrow>
      <mi>Y</mi>
      <msup>
       <mi>Y</mi>
       <mo>′</mo>
      </msup>
     </mrow>
     <mo stretchy="false">]</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>normal-Σ</ci>
      <apply>
       <times></times>
       <ci>Y</ci>
       <ci>Y</ci>
      </apply>
     </apply>
     <apply>
      <ci>Cov</ci>
      <ci>Y</ci>
      <ci>Y</ci>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <ci>normal-E</ci>
      <apply>
       <times></times>
       <ci>Y</ci>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>Y</ci>
        <ci>normal-′</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Sigma_{YY}=\operatorname{Cov}(Y,Y)=\operatorname{E}[YY^{\prime}]
  </annotation>
 </semantics>
</math>

 can be viewed as <a href="Gram_matrix" title="wikilink">Gram matrices</a> in an <a href="inner_product" title="wikilink">inner product</a> for the entries of 

<math display="inline" id="Canonical_correlation:78">
 <semantics>
  <mi>X</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>X</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   X
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Canonical_correlation:79">
 <semantics>
  <mi>Y</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>Y</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Y
  </annotation>
 </semantics>
</math>


, correspondingly. In this interpretation, the random variables, entries 

<math display="inline" id="Canonical_correlation:80">
 <semantics>
  <msub>
   <mi>x</mi>
   <mi>i</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>x</ci>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x_{i}
  </annotation>
 </semantics>
</math>

 of 

<math display="inline" id="Canonical_correlation:81">
 <semantics>
  <mi>X</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>X</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   X
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Canonical_correlation:82">
 <semantics>
  <msub>
   <mi>y</mi>
   <mi>j</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>y</ci>
    <ci>j</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   y_{j}
  </annotation>
 </semantics>
</math>

 of 

<math display="inline" id="Canonical_correlation:83">
 <semantics>
  <mi>Y</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>Y</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Y
  </annotation>
 </semantics>
</math>

 are treated as elements of a vector space with an inner product given by the <a class="uri" href="covariance" title="wikilink">covariance</a> 

<math display="inline" id="Canonical_correlation:84">
 <semantics>
  <mrow>
   <mo>cov</mo>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>x</mi>
     <mi>i</mi>
    </msub>
    <mo>,</mo>
    <msub>
     <mi>y</mi>
     <mi>j</mi>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>cov</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>x</ci>
     <ci>i</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>y</ci>
     <ci>j</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \operatorname{cov}(x_{i},y_{j})
  </annotation>
 </semantics>
</math>


, see <a class="uri" href="Covariance#Relationship_to_inner_products" title="wikilink">Covariance#Relationship_to_inner_products</a>.</p>

<p>The definition of the canonical variables 

<math display="inline" id="Canonical_correlation:85">
 <semantics>
  <mi>U</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>U</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   U
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Canonical_correlation:86">
 <semantics>
  <mi>V</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>V</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   V
  </annotation>
 </semantics>
</math>

 is then equivalent to the definition of <a href="principal_angles" title="wikilink">principal vectors</a> for the pair of subspaces spanned by the entries of 

<math display="inline" id="Canonical_correlation:87">
 <semantics>
  <mi>X</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>X</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   X
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Canonical_correlation:88">
 <semantics>
  <mi>Y</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>Y</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Y
  </annotation>
 </semantics>
</math>

 with respect to this <a href="inner_product" title="wikilink">inner product</a>. The canonical correlations 

<math display="inline" id="Canonical_correlation:89">
 <semantics>
  <mrow>
   <mo>corr</mo>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>U</mi>
    <mo>,</mo>
    <mi>V</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>corr</ci>
    <ci>U</ci>
    <ci>V</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \operatorname{corr}(U,V)
  </annotation>
 </semantics>
</math>


 is equal to the <a class="uri" href="cosine" title="wikilink">cosine</a> of <a href="principal_angles" title="wikilink">principal angles</a>.</p>
<h2 id="see-also">See also</h2>
<ul>
<li><a href="Generalized_Canonical_Correlation" title="wikilink">Generalized Canonical Correlation</a></li>
<li><a href="Multilinear_subspace_learning" title="wikilink">Multilinear subspace learning</a></li>
<li><a href="RV_coefficient" title="wikilink">RV coefficient</a></li>
<li><a href="Principal_angles" title="wikilink">Principal angles</a></li>
<li><a href="Principal_component_analysis" title="wikilink">Principal component analysis</a></li>
<li><a href="Regularized_canonical_correlation_analysis" title="wikilink">Regularized canonical correlation analysis</a></li>
<li><a href="Singular_value_decomposition" title="wikilink">Singular value decomposition</a></li>
<li><a href="Partial_least_squares_regression" title="wikilink">Partial least squares regression</a></li>
</ul>
<h2 id="references">References</h2>
<h2 id="external-links">External links</h2>
<ul>
<li></li>
<li><a href="http://mpra.ub.uni-muenchen.de/12796/">A note on the ordinal canonical-correlation analysis of two sets of ranking scores</a> (Also provides a FORTRAN program)- in J. of Quantitative Economics 7(2), 2009, pp. 173-199</li>
<li><a href="http://ssrn.com/abstract=1331886">Representation-Constrained Canonical Correlation Analysis: A Hybridization of Canonical Correlation and Principal Component Analyses</a> (Also provides a FORTRAN program)- in J. of Applied Economic Sciences 4(1), 2009, pp. 115-124</li>
</ul>

<p>"</p>

<p><a href="Category:Covariance_and_correlation" title="wikilink">Category:Covariance and correlation</a> <a href="Category:Multivariate_statistics" title="wikilink">Category:Multivariate statistics</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1"><a href="#fnref1">↩</a></li>
<li id="fn2"><a href="#fnref2">↩</a></li>
<li id="fn3"><a href="#fnref3">↩</a></li>
<li id="fn4"><a href="#fnref4">↩</a></li>
<li id="fn5"><a href="#fnref5">↩</a></li>
<li id="fn6"><a href="#fnref6">↩</a></li>
<li id="fn7"><a href="#fnref7">↩</a></li>
<li id="fn8"><a href="#fnref8">↩</a></li>
</ol>
</section>
</hr></body>
</html>

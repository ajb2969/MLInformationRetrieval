<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="490">Hidden Field Equations</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Hidden Field Equations</h1>
<hr/>

<p><strong>Hidden Fields Equations (HFE)</strong> is a <a href="public_key" title="wikilink">public key</a> <a class="uri" href="cryptosystem" title="wikilink">cryptosystem</a> which was introduced at <a class="uri" href="Eurocrypt" title="wikilink">Eurocrypt</a> in 1996 and proposed by  <a href=":fr:Jacques_Patarin" title="wikilink">Jacques Patarin</a> following the idea of the <a href="Matsumoto_zeta_function" title="wikilink">Matsumoto</a> and <a class="uri" href="Imai" title="wikilink">Imai</a> system. HFE is also known as HFE trapdoor function. It is based on <a class="uri" href="polynomials" title="wikilink">polynomials</a> over <a href="finite_fields" title="wikilink">finite fields</a> 

<math display="inline" id="Hidden_Field_Equations:0">
 <semantics>
  <msub>
   <mi>𝔽</mi>
   <mi>q</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>𝔽</ci>
    <ci>q</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbb{F}_{q}
  </annotation>
 </semantics>
</math>

 of different size to disguise the relationship between the <a href="private_key" title="wikilink">private key</a> and <a href="public_key" title="wikilink">public key</a>. HFE is in fact a family which consists of basic HFE and combinatorial versions of HFE. The HFE family of cryptosystems is based on the hardness of the problem of finding solutions to a system of multivariate <a href="quadratic_equations" title="wikilink">quadratic equations</a> (the so-called MQ problem) since it uses private <a href="affine_transformations" title="wikilink">affine transformations</a> to hide the extension field and the private <a class="uri" href="polynomials" title="wikilink">polynomials</a>. Hidden Field Equations also have been used to construct digital signature schemes, e.g. Quartz and Sflash.<a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a></p>
<h2 id="mathematical-background">Mathematical background</h2>

<p>One of the central notions to understand how Hidden Field Equations work is to see that for two extension fields 

<math display="inline" id="Hidden_Field_Equations:1">
 <semantics>
  <msub>
   <mi>𝔽</mi>
   <msup>
    <mi>q</mi>
    <mi>n</mi>
   </msup>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>𝔽</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>q</ci>
     <ci>n</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbb{F}_{q^{n}}
  </annotation>
 </semantics>
</math>

 

<math display="inline" id="Hidden_Field_Equations:2">
 <semantics>
  <msub>
   <mi>𝔽</mi>
   <msup>
    <mi>q</mi>
    <mi>m</mi>
   </msup>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>𝔽</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>q</ci>
     <ci>m</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbb{F}_{q^{m}}
  </annotation>
 </semantics>
</math>

 over the same base field 

<math display="inline" id="Hidden_Field_Equations:3">
 <semantics>
  <msub>
   <mi>𝔽</mi>
   <mi>q</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>𝔽</ci>
    <ci>q</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbb{F}_{q}
  </annotation>
 </semantics>
</math>


 one can interpret a system of 

<math display="inline" id="Hidden_Field_Equations:4">
 <semantics>
  <mi>m</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>m</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   m
  </annotation>
 </semantics>
</math>

 multivariate <a class="uri" href="polynomials" title="wikilink">polynomials</a> in 

<math display="inline" id="Hidden_Field_Equations:5">
 <semantics>
  <mi>n</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>n</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n
  </annotation>
 </semantics>
</math>

 variables over 

<math display="inline" id="Hidden_Field_Equations:6">
 <semantics>
  <msub>
   <mi>𝔽</mi>
   <mi>q</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>𝔽</ci>
    <ci>q</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbb{F}_{q}
  </annotation>
 </semantics>
</math>

 as a function 

<math display="inline" id="Hidden_Field_Equations:7">
 <semantics>
  <mrow>
   <msub>
    <mi>𝔽</mi>
    <msup>
     <mi>q</mi>
     <mi>n</mi>
    </msup>
   </msub>
   <mo>→</mo>
   <msub>
    <mi>𝔽</mi>
    <msup>
     <mi>q</mi>
     <mi>m</mi>
    </msup>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-→</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>𝔽</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>q</ci>
      <ci>n</ci>
     </apply>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>𝔽</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>q</ci>
      <ci>m</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbb{F}_{q^{n}}\to\mathbb{F}_{q^{m}}
  </annotation>
 </semantics>
</math>

 by using a suitable <a href="basis_(linear_algebra)" title="wikilink">basis</a> of 

<math display="inline" id="Hidden_Field_Equations:8">
 <semantics>
  <msub>
   <mi>𝔽</mi>
   <msup>
    <mi>q</mi>
    <mi>n</mi>
   </msup>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>𝔽</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>q</ci>
     <ci>n</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbb{F}_{q^{n}}
  </annotation>
 </semantics>
</math>


 over 

<math display="inline" id="Hidden_Field_Equations:9">
 <semantics>
  <msub>
   <mi>𝔽</mi>
   <mi>q</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>𝔽</ci>
    <ci>q</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbb{F}_{q}
  </annotation>
 </semantics>
</math>

. In almost all applications the polynomials are quadratic, i.e. they have degree 2.<a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a> We start with the simplest kind of polynomials, namely monomials, and show how they lead to quadratic systems of equations.</p>

<p>Let us consider a <a href="finite_fields" title="wikilink">finite field</a> 

<math display="inline" id="Hidden_Field_Equations:10">
 <semantics>
  <msub>
   <mi>𝔽</mi>
   <mi>q</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>𝔽</ci>
    <ci>q</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbb{F}_{q}
  </annotation>
 </semantics>
</math>

, where 

<math display="inline" id="Hidden_Field_Equations:11">
 <semantics>
  <mi>q</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>q</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   q
  </annotation>
 </semantics>
</math>

 is a power of 2, and an extension field 

<math display="inline" id="Hidden_Field_Equations:12">
 <semantics>
  <mi>K</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>K</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   K
  </annotation>
 </semantics>
</math>

. Let 

<math display="inline" id="Hidden_Field_Equations:13">
 <semantics>
  <mrow>
   <msub>
    <mi>β</mi>
    <mn>1</mn>
   </msub>
   <mo>,</mo>
   <mi mathvariant="normal">…</mi>
   <mo>,</mo>
   <msub>
    <mi>β</mi>
    <mi>n</mi>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <list>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>β</ci>
     <cn type="integer">1</cn>
    </apply>
    <ci>normal-…</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>β</ci>
     <ci>n</ci>
    </apply>
   </list>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \beta_{1},...,\beta_{n}
  </annotation>
 </semantics>
</math>


 to be a <a href="basis_(linear_algebra)" title="wikilink">basis</a> of 

<math display="inline" id="Hidden_Field_Equations:14">
 <semantics>
  <mi>K</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>K</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   K
  </annotation>
 </semantics>
</math>

 as an 

<math display="inline" id="Hidden_Field_Equations:15">
 <semantics>
  <msub>
   <mi>𝔽</mi>
   <mi>q</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>𝔽</ci>
    <ci>q</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbb{F}_{q}
  </annotation>
 </semantics>
</math>

 <a href="vector_space" title="wikilink">vector space</a>. Let 

<math display="inline" id="Hidden_Field_Equations:16">
 <semantics>
  <mi>θ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>θ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \theta
  </annotation>
 </semantics>
</math>

 for some 

<math display="inline" id="Hidden_Field_Equations:17">
 <semantics>
  <mrow>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>h</mi>
    <mo>,</mo>
    <mrow>
     <msup>
      <mi>q</mi>
      <mi>n</mi>
     </msup>
     <mo>-</mo>
     <mn>1</mn>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>=</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <interval closure="open">
     <ci>h</ci>
     <apply>
      <minus></minus>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>q</ci>
       <ci>n</ci>
      </apply>
      <cn type="integer">1</cn>
     </apply>
    </interval>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (h,q^{n}-1)=1
  </annotation>
 </semantics>
</math>

 and <a href="Greatest_common_divisor_of_two_polynomials" title="wikilink">gcd</a>

<math display="inline" id="Hidden_Field_Equations:18">
 <semantics>
  <mrow>
   <mi>u</mi>
   <mo>∈</mo>
   <msub>
    <mi>𝔽</mi>
    <msup>
     <mi>q</mi>
     <mi>n</mi>
    </msup>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <in></in>
    <ci>u</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>𝔽</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>q</ci>
      <ci>n</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   u\in\mathbb{F}_{q^{n}}
  </annotation>
 </semantics>
</math>


 and take a random element 

<math display="inline" id="Hidden_Field_Equations:19">
 <semantics>
  <mi>u</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>u</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   u
  </annotation>
 </semantics>
</math>

. We represent 

<math display="inline" id="Hidden_Field_Equations:20">
 <semantics>
  <mrow>
   <mi>u</mi>
   <mo>=</mo>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>u</mi>
     <mn>1</mn>
    </msub>
    <mo>,</mo>
    <mi mathvariant="normal">…</mi>
    <mo>,</mo>
    <msub>
     <mi>u</mi>
     <mi>n</mi>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>u</ci>
    <vector>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>u</ci>
      <cn type="integer">1</cn>
     </apply>
     <ci>normal-…</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>u</ci>
      <ci>n</ci>
     </apply>
    </vector>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   u=(u_{1},...,u_{n})
  </annotation>
 </semantics>
</math>

 with respect to the basis as 

<math display="inline" id="Hidden_Field_Equations:21">
 <semantics>
  <mrow>
   <mi>v</mi>
   <mo>∈</mo>
   <msub>
    <mi>𝔽</mi>
    <msup>
     <mi>q</mi>
     <mi>n</mi>
    </msup>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <in></in>
    <ci>v</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>𝔽</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>q</ci>
      <ci>n</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   v\in\mathbb{F}_{q^{n}}
  </annotation>
 </semantics>
</math>

. Define 

<math display="block" id="Hidden_Field_Equations:22">
 <semantics>
  <mrow>
   <mi>v</mi>
   <mo>=</mo>
   <mrow>
    <mrow>
     <msup>
      <mi>u</mi>
      <msup>
       <mi>q</mi>
       <mi>θ</mi>
      </msup>
     </msup>
     <mi>u</mi>
    </mrow>
    <mrow>
     <mo stretchy="false">(</mo>
     <mn>1</mn>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>v</ci>
    <list>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>u</ci>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>q</ci>
        <ci>θ</ci>
       </apply>
      </apply>
      <ci>u</ci>
     </apply>
     <cn type="integer">1</cn>
    </list>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   v=u^{q^{\theta}}u\ \ \ \ (1)
  </annotation>
 </semantics>
</math>

 by</p>

<p>

<math display="inline" id="Hidden_Field_Equations:23">
 <semantics>
  <mrow>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>h</mi>
    <mo>,</mo>
    <mrow>
     <msup>
      <mi>q</mi>
      <mi>n</mi>
     </msup>
     <mo>-</mo>
     <mn>1</mn>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>=</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <interval closure="open">
     <ci>h</ci>
     <apply>
      <minus></minus>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>q</ci>
       <ci>n</ci>
      </apply>
      <cn type="integer">1</cn>
     </apply>
    </interval>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (h,q^{n}-1)=1
  </annotation>
 </semantics>
</math>


</p>

<p>The condition <a href="Greatest_common_divisor_of_two_polynomials" title="wikilink">gcd</a>

<math display="inline" id="Hidden_Field_Equations:24">
 <semantics>
  <mrow>
   <mi>u</mi>
   <mo>→</mo>
   <msup>
    <mi>u</mi>
    <mi>h</mi>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-→</ci>
    <ci>u</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>u</ci>
     <ci>h</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   u\to u^{h}
  </annotation>
 </semantics>
</math>

 is equivalent to requiring that the map 

<math display="inline" id="Hidden_Field_Equations:25">
 <semantics>
  <mi>K</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>K</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   K
  </annotation>
 </semantics>
</math>

 on 

<math display="inline" id="Hidden_Field_Equations:26">
 <semantics>
  <mrow>
   <mi>u</mi>
   <mo>→</mo>
   <msup>
    <mi>u</mi>
    <msup>
     <mi>h</mi>
     <mo>′</mo>
    </msup>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-→</ci>
    <ci>u</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>u</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>h</ci>
      <ci>normal-′</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   u\to u^{h^{\prime}}
  </annotation>
 </semantics>
</math>

 is one to one and its inverse is the map 

<math display="inline" id="Hidden_Field_Equations:27">
 <semantics>
  <msup>
   <mi>h</mi>
   <mo>′</mo>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>h</ci>
    <ci>normal-′</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   h^{\prime}
  </annotation>
 </semantics>
</math>

 where 

<math display="inline" id="Hidden_Field_Equations:28">
 <semantics>
  <mrow>
   <mpadded width="+5pt">
    <mi>h</mi>
   </mpadded>
   <mo lspace="2.5pt" rspace="2.5pt">mod</mo>
   <mrow>
    <msup>
     <mi>q</mi>
     <mi>n</mi>
    </msup>
    <mo>-</mo>
    <mn>1</mn>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">modulo</csymbol>
    <ci>h</ci>
    <apply>
     <minus></minus>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>q</ci>
      <ci>n</ci>
     </apply>
     <cn type="integer">1</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   h\ \bmod q^{n}-1
  </annotation>
 </semantics>
</math>


 is the multiplicative inverse of 

<math display="inline" id="Hidden_Field_Equations:29">
 <semantics>
  <mrow>
   <mi>n</mi>
   <mo>×</mo>
   <mi>n</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>n</ci>
    <ci>n</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n\times n
  </annotation>
 </semantics>
</math>

. Choose two secret affine transformation, i.e. two invertible 

<math display="inline" id="Hidden_Field_Equations:30">
 <semantics>
  <mrow>
   <mi>S</mi>
   <mo>=</mo>
   <mrow>
    <mo stretchy="false">{</mo>
    <msub>
     <mi>S</mi>
     <mrow>
      <mi>i</mi>
      <mi>j</mi>
     </mrow>
    </msub>
    <mo stretchy="false">}</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>S</ci>
    <set>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>S</ci>
      <apply>
       <times></times>
       <ci>i</ci>
       <ci>j</ci>
      </apply>
     </apply>
    </set>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   S=\{S_{ij}\}
  </annotation>
 </semantics>
</math>

 matrices 

<math display="inline" id="Hidden_Field_Equations:31">
 <semantics>
  <mrow>
   <mi>T</mi>
   <mo>=</mo>
   <mrow>
    <mo stretchy="false">{</mo>
    <msub>
     <mi>T</mi>
     <mrow>
      <mi>i</mi>
      <mi>j</mi>
     </mrow>
    </msub>
    <mo stretchy="false">}</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>T</ci>
    <set>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>T</ci>
      <apply>
       <times></times>
       <ci>i</ci>
       <ci>j</ci>
      </apply>
     </apply>
    </set>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   T=\{T_{ij}\}
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Hidden_Field_Equations:32">
 <semantics>
  <msub>
   <mi>𝔽</mi>
   <mi>q</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>𝔽</ci>
    <ci>q</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbb{F}_{q}
  </annotation>
 </semantics>
</math>

 with entries in 

<math display="inline" id="Hidden_Field_Equations:33">
 <semantics>
  <mrow>
   <mi>c</mi>
   <mo>=</mo>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>c</mi>
     <mn>1</mn>
    </msub>
    <mo>,</mo>
    <mi mathvariant="normal">…</mi>
    <mo>,</mo>
    <msub>
     <mi>c</mi>
     <mi>n</mi>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>c</ci>
    <vector>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>c</ci>
      <cn type="integer">1</cn>
     </apply>
     <ci>normal-…</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>c</ci>
      <ci>n</ci>
     </apply>
    </vector>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   c=(c_{1},...,c_{n})
  </annotation>
 </semantics>
</math>


 and two vectors 

<math display="inline" id="Hidden_Field_Equations:34">
 <semantics>
  <mrow>
   <mi>d</mi>
   <mo>=</mo>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>d</mi>
     <mn>1</mn>
    </msub>
    <mo>,</mo>
    <mi mathvariant="normal">…</mi>
    <mo>,</mo>
    <msub>
     <mi>d</mi>
     <mi>n</mi>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>d</ci>
    <vector>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>d</ci>
      <cn type="integer">1</cn>
     </apply>
     <ci>normal-…</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>d</ci>
      <ci>n</ci>
     </apply>
    </vector>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   d=(d_{1},...,d_{n})
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Hidden_Field_Equations:35">
 <semantics>
  <mi>n</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>n</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n
  </annotation>
 </semantics>
</math>

 of length 

<math display="inline" id="Hidden_Field_Equations:36">
 <semantics>
  <msub>
   <mi>𝔽</mi>
   <mi>q</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>𝔽</ci>
    <ci>q</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbb{F}_{q}
  </annotation>
 </semantics>
</math>

 over 

<math display="inline" id="Hidden_Field_Equations:37">
 <semantics>
  <mi>x</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>x</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x
  </annotation>
 </semantics>
</math>

 and define 

<math display="inline" id="Hidden_Field_Equations:38">
 <semantics>
  <mi>y</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>y</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   y
  </annotation>
 </semantics>
</math>


 and 

<math display="block" id="Hidden_Field_Equations:39">
 <semantics>
  <mrow>
   <mrow>
    <mi>u</mi>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mi>S</mi>
      <mi>x</mi>
     </mrow>
     <mo>+</mo>
     <mi>c</mi>
    </mrow>
   </mrow>
   <mrow>
    <mi>v</mi>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mrow>
       <mi>T</mi>
       <mi>y</mi>
      </mrow>
      <mo>+</mo>
      <mi>d</mi>
     </mrow>
     <mrow>
      <mo stretchy="false">(</mo>
      <mn>2</mn>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <eq></eq>
     <ci>u</ci>
     <apply>
      <plus></plus>
      <apply>
       <times></times>
       <ci>S</ci>
       <ci>x</ci>
      </apply>
      <ci>c</ci>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <ci>v</ci>
     <list>
      <apply>
       <plus></plus>
       <apply>
        <times></times>
        <ci>T</ci>
        <ci>y</ci>
       </apply>
       <ci>d</ci>
      </apply>
      <cn type="integer">2</cn>
     </list>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   u=Sx+c\ \ \ \ v=Ty+d\ \ \ \ (2)
  </annotation>
 </semantics>
</math>

 via:</p>

<p>

<math display="inline" id="Hidden_Field_Equations:40">
 <semantics>
  <mrow>
   <msup>
    <mi>A</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>k</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </msup>
   <mo>=</mo>
   <msubsup>
    <mi>a</mi>
    <mrow>
     <mi>i</mi>
     <mi>j</mi>
    </mrow>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>k</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </msubsup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>A</ci>
     <ci>k</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>a</ci>
      <apply>
       <times></times>
       <ci>i</ci>
       <ci>j</ci>
      </apply>
     </apply>
     <ci>k</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A^{(k)}={a_{ij}^{(k)}}
  </annotation>
 </semantics>
</math>

</p>

<p>Let 

<math display="inline" id="Hidden_Field_Equations:41">
 <semantics>
  <mrow>
   <msub>
    <mi>β</mi>
    <mn>1</mn>
   </msub>
   <mo>,</mo>
   <mi mathvariant="normal">…</mi>
   <mo>,</mo>
   <msub>
    <mi>β</mi>
    <mi>n</mi>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <list>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>β</ci>
     <cn type="integer">1</cn>
    </apply>
    <ci>normal-…</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>β</ci>
     <ci>n</ci>
    </apply>
   </list>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \beta_{1},...,\beta_{n}
  </annotation>
 </semantics>
</math>

 be the matrix of linear transformation in the basis 

<math display="block" id="Hidden_Field_Equations:42">
 <semantics>
  <mrow>
   <mrow>
    <msubsup>
     <mi>β</mi>
     <mi>i</mi>
     <msup>
      <mi>q</mi>
      <mi>k</mi>
     </msup>
    </msubsup>
    <mo>=</mo>
    <mrow>
     <munderover>
      <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
      <mrow>
       <mi>j</mi>
       <mo>=</mo>
       <mn>1</mn>
      </mrow>
      <mi>n</mi>
     </munderover>
     <mrow>
      <msubsup>
       <mi>a</mi>
       <mrow>
        <mi>i</mi>
        <mi>j</mi>
       </mrow>
       <mi>k</mi>
      </msubsup>
      <msub>
       <mi>β</mi>
       <mi>j</mi>
      </msub>
     </mrow>
    </mrow>
   </mrow>
   <mo rspace="12.5pt">,</mo>
   <mrow>
    <msubsup>
     <mi>a</mi>
     <mrow>
      <mi>i</mi>
      <mi>j</mi>
     </mrow>
     <mi>k</mi>
    </msubsup>
    <mo>∈</mo>
    <msub>
     <mi>𝔽</mi>
     <mi>q</mi>
    </msub>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>β</ci>
       <ci>i</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>q</ci>
       <ci>k</ci>
      </apply>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <apply>
         <eq></eq>
         <ci>j</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <ci>n</ci>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>a</ci>
         <apply>
          <times></times>
          <ci>i</ci>
          <ci>j</ci>
         </apply>
        </apply>
        <ci>k</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>β</ci>
        <ci>j</ci>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <in></in>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>a</ci>
       <apply>
        <times></times>
        <ci>i</ci>
        <ci>j</ci>
       </apply>
      </apply>
      <ci>k</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>𝔽</ci>
      <ci>q</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \beta_{i}^{q^{k}}=\sum_{j=1}^{n}a_{ij}^{k}\beta_{j},\ \ a_{ij}^{k}\in\mathbb{F%
}_{q}
  </annotation>
 </semantics>
</math>

 such that</p>

<p>

<math display="inline" id="Hidden_Field_Equations:43">
 <semantics>
  <mrow>
   <mrow>
    <mn>1</mn>
    <mo>≤</mo>
    <mi>i</mi>
   </mrow>
   <mo>,</mo>
   <mrow>
    <mi>k</mi>
    <mo>≤</mo>
    <mi>n</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <leq></leq>
     <cn type="integer">1</cn>
     <ci>i</ci>
    </apply>
    <apply>
     <leq></leq>
     <ci>k</ci>
     <ci>n</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   1\leq i,k\leq n
  </annotation>
 </semantics>
</math>


</p>

<p>for 

<math display="block" id="Hidden_Field_Equations:44">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <msub>
      <mi>β</mi>
      <mi>i</mi>
     </msub>
     <msub>
      <mi>β</mi>
      <mi>j</mi>
     </msub>
    </mrow>
    <mo>=</mo>
    <mrow>
     <munderover>
      <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
      <mrow>
       <mi>l</mi>
       <mo>=</mo>
       <mn>1</mn>
      </mrow>
      <mi>n</mi>
     </munderover>
     <mrow>
      <msub>
       <mi>m</mi>
       <mrow>
        <mi>i</mi>
        <mi>j</mi>
        <mi>l</mi>
       </mrow>
      </msub>
      <msub>
       <mi>β</mi>
       <mi>l</mi>
      </msub>
     </mrow>
    </mrow>
   </mrow>
   <mo rspace="12.5pt">,</mo>
   <mrow>
    <msub>
     <mi>m</mi>
     <mrow>
      <mi>i</mi>
      <mi>j</mi>
      <mi>l</mi>
     </mrow>
    </msub>
    <mo>∈</mo>
    <msub>
     <mi>𝔽</mi>
     <mi>q</mi>
    </msub>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <eq></eq>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>β</ci>
       <ci>i</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>β</ci>
       <ci>j</ci>
      </apply>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <apply>
         <eq></eq>
         <ci>l</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <ci>n</ci>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>m</ci>
        <apply>
         <times></times>
         <ci>i</ci>
         <ci>j</ci>
         <ci>l</ci>
        </apply>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>β</ci>
        <ci>l</ci>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <in></in>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>m</ci>
      <apply>
       <times></times>
       <ci>i</ci>
       <ci>j</ci>
       <ci>l</ci>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>𝔽</ci>
      <ci>q</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \beta_{i}\beta_{j}=\sum_{l=1}^{n}m_{ijl}\beta_{l},\ \ m_{ijl}\in\mathbb{F}_{q}
  </annotation>
 </semantics>
</math>

. Write all products of basis elements in terms of the basis, i.e.:</p>

<p>

<math display="inline" id="Hidden_Field_Equations:45">
 <semantics>
  <mrow>
   <mrow>
    <mn>1</mn>
    <mo>≤</mo>
    <mi>i</mi>
   </mrow>
   <mo>,</mo>
   <mrow>
    <mi>j</mi>
    <mo>≤</mo>
    <mi>n</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <leq></leq>
     <cn type="integer">1</cn>
     <ci>i</ci>
    </apply>
    <apply>
     <leq></leq>
     <ci>j</ci>
     <ci>n</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   1\leq i,j\leq n
  </annotation>
 </semantics>
</math>

</p>

<p>for each 

<math display="inline" id="Hidden_Field_Equations:46">
 <semantics>
  <mi>n</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>n</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n
  </annotation>
 </semantics>
</math>

. The system of 

<math display="inline" id="Hidden_Field_Equations:47">
 <semantics>
  <msub>
   <mi>v</mi>
   <mi>i</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>v</ci>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   v_{i}
  </annotation>
 </semantics>
</math>

 equations which is explicit in the 

<math display="inline" id="Hidden_Field_Equations:48">
 <semantics>
  <msub>
   <mi>u</mi>
   <mi>j</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>u</ci>
    <ci>j</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   u_{j}
  </annotation>
 </semantics>
</math>


 and quadratic in the 

<math display="inline" id="Hidden_Field_Equations:49">
 <semantics>
  <msub>
   <mi>β</mi>
   <mi>i</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>β</ci>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \beta_{i}
  </annotation>
 </semantics>
</math>

 can be obtain by expanding (1) and equating to zero the coefficients of the 

<math display="inline" id="Hidden_Field_Equations:50">
 <semantics>
  <mrow>
   <msub>
    <mi>u</mi>
    <mi>j</mi>
   </msub>
   <mo>,</mo>
   <msub>
    <mi>v</mi>
    <mi>i</mi>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <list>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>u</ci>
     <ci>j</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>v</ci>
     <ci>i</ci>
    </apply>
   </list>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   u_{j},v_{i}
  </annotation>
 </semantics>
</math>

. By using the affine relations in (2) to replace the 

<math display="inline" id="Hidden_Field_Equations:51">
 <semantics>
  <mrow>
   <msub>
    <mi>x</mi>
    <mi>k</mi>
   </msub>
   <mo>,</mo>
   <msub>
    <mi>y</mi>
    <mi>l</mi>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <list>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>x</ci>
     <ci>k</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>y</ci>
     <ci>l</ci>
    </apply>
   </list>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x_{k},y_{l}
  </annotation>
 </semantics>
</math>

 with 

<math display="inline" id="Hidden_Field_Equations:52">
 <semantics>
  <mi>n</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>n</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n
  </annotation>
 </semantics>
</math>

, the system of 

<math display="inline" id="Hidden_Field_Equations:53">
 <semantics>
  <msub>
   <mi>y</mi>
   <mi>l</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>y</ci>
    <ci>l</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   y_{l}
  </annotation>
 </semantics>
</math>


 equations is <a class="uri" href="linear" title="wikilink">linear</a> in the 

<math display="inline" id="Hidden_Field_Equations:54">
 <semantics>
  <msub>
   <mi>x</mi>
   <mi>k</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>x</ci>
    <ci>k</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x_{k}
  </annotation>
 </semantics>
</math>

 and of degree 2 in the 

<math display="inline" id="Hidden_Field_Equations:55">
 <semantics>
  <mi>n</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>n</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n
  </annotation>
 </semantics>
</math>

. Applying <a href="linear_algebra" title="wikilink">linear algebra</a> it will give 

<math display="inline" id="Hidden_Field_Equations:56">
 <semantics>
  <msub>
   <mi>y</mi>
   <mi>l</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>y</ci>
    <ci>l</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   y_{l}
  </annotation>
 </semantics>
</math>

 explicit equations, one for each 

<math display="inline" id="Hidden_Field_Equations:57">
 <semantics>
  <msub>
   <mi>x</mi>
   <mi>k</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>x</ci>
    <ci>k</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x_{k}
  </annotation>
 </semantics>
</math>

 as polynomials of degree 2 in the 

<math display="inline" id="Hidden_Field_Equations:58">
 <semantics>
  <mi>P</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>P</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   P
  </annotation>
 </semantics>
</math>


.<a class="footnoteRef" href="#fn3" id="fnref3"><sup>3</sup></a></p>
<h2 id="multivariate-cryptosystem">Multivariate cryptosystem</h2>

<p>The basic idea of the HFE family of using this as a multivariate <a class="uri" href="cryptosystem" title="wikilink">cryptosystem</a> is to build the secret key starting from a <a class="uri" href="polynomial" title="wikilink">polynomial</a> 

<math display="inline" id="Hidden_Field_Equations:59">
 <semantics>
  <mi>x</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>x</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x
  </annotation>
 </semantics>
</math>

 in one unknown 

<math display="inline" id="Hidden_Field_Equations:60">
 <semantics>
  <msub>
   <mi>𝔽</mi>
   <msup>
    <mi>q</mi>
    <mi>n</mi>
   </msup>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>𝔽</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>q</ci>
     <ci>n</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbb{F}_{q^{n}}
  </annotation>
 </semantics>
</math>

 over some <a href="finite_field" title="wikilink">finite field</a> 

<math display="inline" id="Hidden_Field_Equations:61">
 <semantics>
  <mrow>
   <mi>q</mi>
   <mo>=</mo>
   <mn>2</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>q</ci>
    <cn type="integer">2</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   q=2
  </annotation>
 </semantics>
</math>

 (normally value 

<math display="inline" id="Hidden_Field_Equations:62">
 <semantics>
  <msub>
   <mi>𝔽</mi>
   <msup>
    <mi>q</mi>
    <mi>n</mi>
   </msup>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>𝔽</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>q</ci>
     <ci>n</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbb{F}_{q^{n}}
  </annotation>
 </semantics>
</math>

 is used). This <a class="uri" href="polynomial" title="wikilink">polynomial</a> can be easily inverted over 

<math display="inline" id="Hidden_Field_Equations:63">
 <semantics>
  <mrow>
   <mrow>
    <mi>P</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>x</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mi>y</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>P</ci>
     <ci>x</ci>
    </apply>
    <ci>y</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   P(x)=y
  </annotation>
 </semantics>
</math>


, i.e. it is feasible to find any solutions to the equation 

<math display="inline" id="Hidden_Field_Equations:64">
 <semantics>
  <mi>P</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>P</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   P
  </annotation>
 </semantics>
</math>

 when such solution exist. The secret transformation either <a class="uri" href="decryption" title="wikilink">decryption</a> and/or <a href="Digital_signature" title="wikilink">signature</a> is based on this inversion. As explained above 

<math display="inline" id="Hidden_Field_Equations:65">
 <semantics>
  <mi>n</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>n</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n
  </annotation>
 </semantics>
</math>

 can be identified with a system of 

<math display="inline" id="Hidden_Field_Equations:66">
 <semantics>
  <mrow>
   <mo stretchy="false">(</mo>
   <msub>
    <mi>p</mi>
    <mn>1</mn>
   </msub>
   <mo>,</mo>
   <mi mathvariant="normal">…</mi>
   <mo>,</mo>
   <msub>
    <mi>p</mi>
    <mi>n</mi>
   </msub>
   <mo stretchy="false">)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <vector>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>p</ci>
     <cn type="integer">1</cn>
    </apply>
    <ci>normal-…</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>p</ci>
     <ci>n</ci>
    </apply>
   </vector>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (p_{1},...,p_{n})
  </annotation>
 </semantics>
</math>

 equations 

<math display="inline" id="Hidden_Field_Equations:67">
 <semantics>
  <mrow>
   <mo stretchy="false">(</mo>
   <msub>
    <mi>p</mi>
    <mn>1</mn>
   </msub>
   <mo>,</mo>
   <mi mathvariant="normal">…</mi>
   <mo>,</mo>
   <msub>
    <mi>p</mi>
    <mi>n</mi>
   </msub>
   <mo stretchy="false">)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <vector>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>p</ci>
     <cn type="integer">1</cn>
    </apply>
    <ci>normal-…</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>p</ci>
     <ci>n</ci>
    </apply>
   </vector>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (p_{1},...,p_{n})
  </annotation>
 </semantics>
</math>

 using a fixed basis. To build a <a class="uri" href="cryptosystem" title="wikilink">cryptosystem</a> the <a class="uri" href="polynomial" title="wikilink">polynomial</a> 

<math display="inline" id="Hidden_Field_Equations:68">
 <semantics>
  <msub>
   <mi>𝔽</mi>
   <msup>
    <mi>q</mi>
    <mi>n</mi>
   </msup>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>𝔽</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>q</ci>
     <ci>n</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbb{F}_{q^{n}}
  </annotation>
 </semantics>
</math>


 must be transformed so that the public information hides the original structure and prevents inversion. This is done by viewing the <a href="finite_fields" title="wikilink">finite fields</a> 

<math display="inline" id="Hidden_Field_Equations:69">
 <semantics>
  <msub>
   <mi>𝔽</mi>
   <mi>q</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>𝔽</ci>
    <ci>q</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbb{F}_{q}
  </annotation>
 </semantics>
</math>

 as a <a href="vector_space" title="wikilink">vector space</a> over 

<math display="inline" id="Hidden_Field_Equations:70">
 <semantics>
  <mi>S</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>S</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   S
  </annotation>
 </semantics>
</math>

 and by choosing two linear <a href="affine_transformation" title="wikilink">affine transformations</a> 

<math display="inline" id="Hidden_Field_Equations:71">
 <semantics>
  <mi>T</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>T</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   T
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Hidden_Field_Equations:72">
 <semantics>
  <mrow>
   <mo stretchy="false">(</mo>
   <mi>S</mi>
   <mo>,</mo>
   <mi>P</mi>
   <mo>,</mo>
   <mi>T</mi>
   <mo stretchy="false">)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <vector>
    <ci>S</ci>
    <ci>P</ci>
    <ci>T</ci>
   </vector>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (S,P,T)
  </annotation>
 </semantics>
</math>

. The triplet 

<math display="inline" id="Hidden_Field_Equations:73">
 <semantics>
  <mi>P</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>P</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   P
  </annotation>
 </semantics>
</math>


 constitute the private key. The private <a class="uri" href="polynomial" title="wikilink">polynomial</a> 

<math display="inline" id="Hidden_Field_Equations:74">
 <semantics>
  <msub>
   <mi>𝔽</mi>
   <msup>
    <mi>q</mi>
    <mi>n</mi>
   </msup>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>𝔽</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>q</ci>
     <ci>n</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbb{F}_{q^{n}}
  </annotation>
 </semantics>
</math>

 is defined over 

<math display="inline" id="Hidden_Field_Equations:75">
 <semantics>
  <mrow>
   <mo stretchy="false">(</mo>
   <msub>
    <mi>p</mi>
    <mn>1</mn>
   </msub>
   <mo>,</mo>
   <mi mathvariant="normal">…</mi>
   <mo>,</mo>
   <msub>
    <mi>p</mi>
    <mi>n</mi>
   </msub>
   <mo stretchy="false">)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <vector>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>p</ci>
     <cn type="integer">1</cn>
    </apply>
    <ci>normal-…</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>p</ci>
     <ci>n</ci>
    </apply>
   </vector>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (p_{1},...,p_{n})
  </annotation>
 </semantics>
</math>

.<a class="footnoteRef" href="#fn4" id="fnref4"><sup>4</sup></a><a class="footnoteRef" href="#fn5" id="fnref5"><sup>5</sup></a> The public key is 

<math display="inline" id="Hidden_Field_Equations:76">
 <semantics>
  <mrow>
   <mo stretchy="false">(</mo>
   <mi>S</mi>
   <mo>,</mo>
   <mi>P</mi>
   <mo>,</mo>
   <mi>T</mi>
   <mo stretchy="false">)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <vector>
    <ci>S</ci>
    <ci>P</ci>
    <ci>T</ci>
   </vector>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (S,P,T)
  </annotation>
 </semantics>
</math>

. Below is the diagram for MQ-trapdoor 

<math display="block" id="Hidden_Field_Equations:77">
 <semantics>
  <mrow>
   <mrow>
    <mtext>input</mtext>
    <mi>x</mi>
   </mrow>
   <mo>→</mo>
   <mi>x</mi>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mo stretchy="false">(</mo>
     <msub>
      <mi>x</mi>
      <mn>1</mn>
     </msub>
     <mo>,</mo>
     <mi mathvariant="normal">…</mi>
     <mo>,</mo>
     <msub>
      <mi>x</mi>
      <mi>n</mi>
     </msub>
     <mo stretchy="false">)</mo>
    </mrow>
    <mover accent="true">
     <mo>→</mo>
     <mrow>
      <mtext>secret</mtext>
      <mo>:</mo>
      <mi>S</mi>
     </mrow>
    </mover>
    <msup>
     <mi>x</mi>
     <mo>′</mo>
    </msup>
    <mover accent="true">
     <mo>→</mo>
     <mrow>
      <mtext>secret</mtext>
      <mo>:</mo>
      <mi>P</mi>
     </mrow>
    </mover>
    <msup>
     <mi>y</mi>
     <mo>′</mo>
    </msup>
    <mover accent="true">
     <mo>→</mo>
     <mrow>
      <mtext>secret</mtext>
      <mo>:</mo>
      <mi>T</mi>
     </mrow>
    </mover>
    <mtext>output</mtext>
    <mi>y</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <ci>normal-→</ci>
     <apply>
      <times></times>
      <mtext>input</mtext>
      <ci>x</ci>
     </apply>
     <ci>x</ci>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <vector>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <cn type="integer">1</cn>
       </apply>
       <ci>normal-…</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <ci>n</ci>
       </apply>
      </vector>
      <apply>
       <apply>
        <ci>normal-:</ci>
        <mtext>secret</mtext>
        <ci>S</ci>
       </apply>
       <ci>normal-→</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>x</ci>
       <ci>normal-′</ci>
      </apply>
      <apply>
       <apply>
        <ci>normal-:</ci>
        <mtext>secret</mtext>
        <ci>P</ci>
       </apply>
       <ci>normal-→</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>y</ci>
       <ci>normal-′</ci>
      </apply>
      <apply>
       <apply>
        <ci>normal-:</ci>
        <mtext>secret</mtext>
        <ci>T</ci>
       </apply>
       <ci>normal-→</ci>
      </apply>
      <mtext>output</mtext>
      <ci>y</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \text{input}x\to x=(x_{1},...,x_{n})\overset{\text{secret}:S}{\to}x^{\prime}%
\overset{\text{secret}:P}{\to}y^{\prime}\overset{\text{secret}:T}{\to}\text{%
output}y
  </annotation>
 </semantics>
</math>

 in HFE</p>

<p>

<math display="inline" id="Hidden_Field_Equations:78">
 <semantics>
  <mi>P</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>P</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   P
  </annotation>
 </semantics>
</math>


</p>
<h2 id="hfe-polynomial">HFE polynomial</h2>

<p>The private <a class="uri" href="polynomial" title="wikilink">polynomial</a> 

<math display="inline" id="Hidden_Field_Equations:79">
 <semantics>
  <mi>d</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>d</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   d
  </annotation>
 </semantics>
</math>

 with degree 

<math display="inline" id="Hidden_Field_Equations:80">
 <semantics>
  <msub>
   <mi>𝔽</mi>
   <msup>
    <mi>q</mi>
    <mi>n</mi>
   </msup>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>𝔽</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>q</ci>
     <ci>n</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbb{F}_{q^{n}}
  </annotation>
 </semantics>
</math>

 over 

<math display="inline" id="Hidden_Field_Equations:81">
 <semantics>
  <mrow>
   <msub>
    <mi>𝔽</mi>
    <msup>
     <mi>q</mi>
     <mi>n</mi>
    </msup>
   </msub>
   <mrow>
    <mo stretchy="false">[</mo>
    <mi>x</mi>
    <mo stretchy="false">]</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>𝔽</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>q</ci>
      <ci>n</ci>
     </apply>
    </apply>
    <apply>
     <csymbol cd="latexml">delimited-[]</csymbol>
     <ci>x</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbb{F}_{q^{n}}[x]
  </annotation>
 </semantics>
</math>

 is an element of 

<math display="inline" id="Hidden_Field_Equations:82">
 <semantics>
  <mi>P</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>P</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   P
  </annotation>
 </semantics>
</math>

. If the terms of <a class="uri" href="polynomial" title="wikilink">polynomial</a> 

<math display="inline" id="Hidden_Field_Equations:83">
 <semantics>
  <msub>
   <mi>𝔽</mi>
   <mi>q</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>𝔽</ci>
    <ci>q</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbb{F}_{q}
  </annotation>
 </semantics>
</math>


 have at most <a href="quadratic_polynomial" title="wikilink">quadratic</a> terms over 

<math display="inline" id="Hidden_Field_Equations:84">
 <semantics>
  <mi>P</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>P</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   P
  </annotation>
 </semantics>
</math>

 then it will keep the public polynomial small.<a class="footnoteRef" href="#fn6" id="fnref6"><sup>6</sup></a> The case that 

<math display="inline" id="Hidden_Field_Equations:85">
 <semantics>
  <msup>
   <mi>x</mi>
   <mrow>
    <msup>
     <mi>q</mi>
     <msub>
      <mi>s</mi>
      <mi>i</mi>
     </msub>
    </msup>
    <mo>+</mo>
    <msup>
     <mi>q</mi>
     <msub>
      <mi>t</mi>
      <mi>i</mi>
     </msub>
    </msup>
   </mrow>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>x</ci>
    <apply>
     <plus></plus>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>q</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>s</ci>
       <ci>i</ci>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>q</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>t</ci>
       <ci>i</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x^{q^{s_{i}}+q^{t_{i}}}
  </annotation>
 </semantics>
</math>

 consists of monomials of the form 

<math display="inline" id="Hidden_Field_Equations:86">
 <semantics>
  <mi>q</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>q</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   q
  </annotation>
 </semantics>
</math>

, i.e. with 2 powers of 

<math display="inline" id="Hidden_Field_Equations:87">
 <semantics>
  <mi>P</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>P</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   P
  </annotation>
 </semantics>
</math>

 in the exponent is the basic version of <strong>HFE</strong>, i.e. 

<math display="block" id="Hidden_Field_Equations:88">
 <semantics>
  <mrow>
   <mrow>
    <mi>P</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>x</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
    <mrow>
     <msub>
      <mi>c</mi>
      <mi>i</mi>
     </msub>
     <msup>
      <mi>x</mi>
      <mrow>
       <msup>
        <mi>q</mi>
        <msub>
         <mi>s</mi>
         <mi>i</mi>
        </msub>
       </msup>
       <mo>+</mo>
       <msup>
        <mi>q</mi>
        <msub>
         <mi>t</mi>
         <mi>i</mi>
        </msub>
       </msup>
      </mrow>
     </msup>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>P</ci>
     <ci>x</ci>
    </apply>
    <apply>
     <sum></sum>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>c</ci>
       <ci>i</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>x</ci>
       <apply>
        <plus></plus>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>q</ci>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>s</ci>
          <ci>i</ci>
         </apply>
        </apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>q</ci>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>t</ci>
          <ci>i</ci>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   P(x)=\sum c_{i}x^{q^{s_{i}}+q^{t_{i}}}
  </annotation>
 </semantics>
</math>

 is chosen as</p>

<p>

<math display="inline" id="Hidden_Field_Equations:89">
 <semantics>
  <mi>d</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>d</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   d
  </annotation>
 </semantics>
</math>

</p>

<p>The degree 

<math display="inline" id="Hidden_Field_Equations:90">
 <semantics>
  <mi>d</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>d</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   d
  </annotation>
 </semantics>
</math>

 of the <a class="uri" href="polynomial" title="wikilink">polynomial</a> is also known as security parameter and the bigger its value the better for security since the resulting set of quadratic equations resembles a randomly chosen set of quadratic equations. On the other side large 

<math display="inline" id="Hidden_Field_Equations:91">
 <semantics>
  <mi>P</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>P</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   P
  </annotation>
 </semantics>
</math>

 slows down the deciphering. Since 

<math display="inline" id="Hidden_Field_Equations:92">
 <semantics>
  <mi>d</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>d</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   d
  </annotation>
 </semantics>
</math>

 is a <a class="uri" href="polynomial" title="wikilink">polynomial</a> of degree at most 

<math display="inline" id="Hidden_Field_Equations:93">
 <semantics>
  <mi>P</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>P</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   P
  </annotation>
 </semantics>
</math>


 the inverse of 

<math display="inline" id="Hidden_Field_Equations:94">
 <semantics>
  <msup>
   <mi>P</mi>
   <mrow>
    <mo>-</mo>
    <mn>1</mn>
   </mrow>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>P</ci>
    <apply>
     <minus></minus>
     <cn type="integer">1</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   P^{-1}
  </annotation>
 </semantics>
</math>

, denoted by 

<math display="inline" id="Hidden_Field_Equations:95">
 <semantics>
  <mrow>
   <msup>
    <mi>d</mi>
    <mn>2</mn>
   </msup>
   <msup>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>ln</mi>
      <mi>d</mi>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
    <mrow>
     <mi>O</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mn>1</mn>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </msup>
   <msup>
    <mi>n</mi>
    <mn>2</mn>
   </msup>
   <msub>
    <mi>𝔽</mi>
    <mi>q</mi>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>d</ci>
     <cn type="integer">2</cn>
    </apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <ln></ln>
      <ci>d</ci>
     </apply>
     <apply>
      <times></times>
      <ci>O</ci>
      <cn type="integer">1</cn>
     </apply>
    </apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>n</ci>
     <cn type="integer">2</cn>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>𝔽</ci>
     <ci>q</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   d^{2}(\ln d)^{O(1)}n^{2}\mathbb{F}_{q}
  </annotation>
 </semantics>
</math>

 can be computed in 

<math display="inline" id="Hidden_Field_Equations:96">
 <semantics>
  <mi>n</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>n</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n
  </annotation>
 </semantics>
</math>

 operations.<a class="footnoteRef" href="#fn7" id="fnref7"><sup>7</sup></a></p>
<h2 id="encryption-and-decryption">Encryption and decryption</h2>

<p>The public key is given by the 

<math display="inline" id="Hidden_Field_Equations:97">
 <semantics>
  <mrow>
   <mo stretchy="false">(</mo>
   <msub>
    <mi>p</mi>
    <mn>1</mn>
   </msub>
   <mo>,</mo>
   <mi mathvariant="normal">…</mi>
   <mo>,</mo>
   <msub>
    <mi>p</mi>
    <mi>n</mi>
   </msub>
   <mo stretchy="false">)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <vector>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>p</ci>
     <cn type="integer">1</cn>
    </apply>
    <ci>normal-…</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>p</ci>
     <ci>n</ci>
    </apply>
   </vector>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (p_{1},...,p_{n})
  </annotation>
 </semantics>
</math>

 multivariate polynomials 

<math display="inline" id="Hidden_Field_Equations:98">
 <semantics>
  <msub>
   <mi>𝔽</mi>
   <mi>q</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>𝔽</ci>
    <ci>q</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbb{F}_{q}
  </annotation>
 </semantics>
</math>


 over 

<math display="inline" id="Hidden_Field_Equations:99">
 <semantics>
  <mi>M</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>M</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   M
  </annotation>
 </semantics>
</math>

. It is thus necessary to transfer the message 

<math display="inline" id="Hidden_Field_Equations:100">
 <semantics>
  <mrow>
   <msub>
    <mi>𝔽</mi>
    <msup>
     <mi>q</mi>
     <mi>n</mi>
    </msup>
   </msub>
   <mo>→</mo>
   <msubsup>
    <mi>𝔽</mi>
    <mi>q</mi>
    <mi>n</mi>
   </msubsup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-→</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>𝔽</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>q</ci>
      <ci>n</ci>
     </apply>
    </apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>𝔽</ci>
      <ci>q</ci>
     </apply>
     <ci>n</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbb{F}_{q^{n}}\to\mathbb{F}_{q}^{n}
  </annotation>
 </semantics>
</math>

 from 

<math display="inline" id="Hidden_Field_Equations:101">
 <semantics>
  <mi>M</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>M</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   M
  </annotation>
 </semantics>
</math>

 in order to encrypt it, i.e. we assume that 

<math display="inline" id="Hidden_Field_Equations:102">
 <semantics>
  <mrow>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>x</mi>
     <mn>1</mn>
    </msub>
    <mo>,</mo>
    <mi mathvariant="normal">…</mi>
    <mo>,</mo>
    <msub>
     <mi>x</mi>
     <mi>n</mi>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>∈</mo>
   <msubsup>
    <mi>𝔽</mi>
    <mi>q</mi>
    <mi>n</mi>
   </msubsup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <in></in>
    <vector>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <cn type="integer">1</cn>
     </apply>
     <ci>normal-…</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <ci>n</ci>
     </apply>
    </vector>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>𝔽</ci>
      <ci>q</ci>
     </apply>
     <ci>n</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (x_{1},...,x_{n})\in\mathbb{F}_{q}^{n}
  </annotation>
 </semantics>
</math>

 is a vector 

<math display="inline" id="Hidden_Field_Equations:103">
 <semantics>
  <mi>M</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>M</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   M
  </annotation>
 </semantics>
</math>


. To encrypt message 

<math display="inline" id="Hidden_Field_Equations:104">
 <semantics>
  <msub>
   <mi>p</mi>
   <mi>i</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>p</ci>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p_{i}
  </annotation>
 </semantics>
</math>

 we evaluate each 

<math display="inline" id="Hidden_Field_Equations:105">
 <semantics>
  <mrow>
   <mo stretchy="false">(</mo>
   <msub>
    <mi>x</mi>
    <mn>1</mn>
   </msub>
   <mo>,</mo>
   <mi mathvariant="normal">…</mi>
   <mo>,</mo>
   <msub>
    <mi>x</mi>
    <mi>n</mi>
   </msub>
   <mo stretchy="false">)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <vector>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>x</ci>
     <cn type="integer">1</cn>
    </apply>
    <ci>normal-…</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>x</ci>
     <ci>n</ci>
    </apply>
   </vector>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (x_{1},...,x_{n})
  </annotation>
 </semantics>
</math>

 at 

<math display="inline" id="Hidden_Field_Equations:106">
 <semantics>
  <mrow>
   <mrow>
    <mo stretchy="false">(</mo>
    <mrow>
     <msub>
      <mi>p</mi>
      <mn>1</mn>
     </msub>
     <mrow>
      <mo stretchy="false">(</mo>
      <msub>
       <mi>x</mi>
       <mn>1</mn>
      </msub>
      <mo>,</mo>
      <mi mathvariant="normal">…</mi>
      <mo>,</mo>
      <msub>
       <mi>x</mi>
       <mi>n</mi>
      </msub>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>,</mo>
    <mrow>
     <msub>
      <mi>p</mi>
      <mn>2</mn>
     </msub>
     <mrow>
      <mo stretchy="false">(</mo>
      <msub>
       <mi>x</mi>
       <mn>1</mn>
      </msub>
      <mo>,</mo>
      <mi mathvariant="normal">…</mi>
      <mo>,</mo>
      <msub>
       <mi>x</mi>
       <mi>n</mi>
      </msub>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>,</mo>
    <mi mathvariant="normal">…</mi>
    <mo>,</mo>
    <mrow>
     <msub>
      <mi>p</mi>
      <mi>n</mi>
     </msub>
     <mrow>
      <mo stretchy="false">(</mo>
      <msub>
       <mi>x</mi>
       <mn>1</mn>
      </msub>
      <mo>,</mo>
      <mi mathvariant="normal">…</mi>
      <mo>,</mo>
      <msub>
       <mi>x</mi>
       <mi>n</mi>
      </msub>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>∈</mo>
   <msubsup>
    <mi>𝔽</mi>
    <mi>q</mi>
    <mi>n</mi>
   </msubsup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <in></in>
    <vector>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>p</ci>
       <cn type="integer">1</cn>
      </apply>
      <vector>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <cn type="integer">1</cn>
       </apply>
       <ci>normal-…</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <ci>n</ci>
       </apply>
      </vector>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>p</ci>
       <cn type="integer">2</cn>
      </apply>
      <vector>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <cn type="integer">1</cn>
       </apply>
       <ci>normal-…</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <ci>n</ci>
       </apply>
      </vector>
     </apply>
     <ci>normal-…</ci>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>p</ci>
       <ci>n</ci>
      </apply>
      <vector>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <cn type="integer">1</cn>
       </apply>
       <ci>normal-…</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <ci>n</ci>
       </apply>
      </vector>
     </apply>
    </vector>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>𝔽</ci>
      <ci>q</ci>
     </apply>
     <ci>n</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (p_{1}(x_{1},...,x_{n}),p_{2}(x_{1},...,x_{n}),...,p_{n}(x_{1},...,x_{n}))\in%
\mathbb{F}_{q}^{n}
  </annotation>
 </semantics>
</math>

. The ciphertext is 

<math display="inline" id="Hidden_Field_Equations:107">
 <semantics>
  <mrow>
   <mi>S</mi>
   <mo>,</mo>
   <mi>T</mi>
   <mo>,</mo>
   <mi>P</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <list>
    <ci>S</ci>
    <ci>T</ci>
    <ci>P</ci>
   </list>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   S,T,P
  </annotation>
 </semantics>
</math>

.</p>

<p>To understand decryption let us express encryption in terms of 

<math display="inline" id="Hidden_Field_Equations:108">
 <semantics>
  <msub>
   <mi>p</mi>
   <mi>i</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>p</ci>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p_{i}
  </annotation>
 </semantics>
</math>


. Note that these are <em>not</em> available to the sender. By evaluating the 

<math display="inline" id="Hidden_Field_Equations:109">
 <semantics>
  <mi>S</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>S</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   S
  </annotation>
 </semantics>
</math>

 at the message we first apply 

<math display="inline" id="Hidden_Field_Equations:110">
 <semantics>
  <msup>
   <mi>x</mi>
   <mo>′</mo>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>x</ci>
    <ci>normal-′</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x^{\prime}
  </annotation>
 </semantics>
</math>

, resulting in 

<math display="inline" id="Hidden_Field_Equations:111">
 <semantics>
  <msup>
   <mi>x</mi>
   <mo>′</mo>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>x</ci>
    <ci>normal-′</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x^{\prime}
  </annotation>
 </semantics>
</math>

. At this point 

<math display="inline" id="Hidden_Field_Equations:112">
 <semantics>
  <mrow>
   <mrow>
    <mi>𝔽</mi>
    <msup>
     <mi>q</mi>
     <mi>n</mi>
    </msup>
   </mrow>
   <mo>→</mo>
   <msub>
    <mi>𝔽</mi>
    <msup>
     <mi>q</mi>
     <mi>n</mi>
    </msup>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-→</ci>
    <apply>
     <times></times>
     <ci>𝔽</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>q</ci>
      <ci>n</ci>
     </apply>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>𝔽</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>q</ci>
      <ci>n</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbb{F}{q^{n}}\to\mathbb{F}_{q^{n}}
  </annotation>
 </semantics>
</math>

 is transferred from 

<math display="inline" id="Hidden_Field_Equations:113">
 <semantics>
  <mi>P</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>P</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   P
  </annotation>
 </semantics>
</math>


 so we can apply the private polynomial 

<math display="inline" id="Hidden_Field_Equations:114">
 <semantics>
  <msub>
   <mi>𝔽</mi>
   <msup>
    <mi>q</mi>
    <mi>n</mi>
   </msup>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>𝔽</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>q</ci>
     <ci>n</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbb{F}_{q^{n}}
  </annotation>
 </semantics>
</math>

 which is over 

<math display="inline" id="Hidden_Field_Equations:115">
 <semantics>
  <mrow>
   <msup>
    <mi>y</mi>
    <mo>′</mo>
   </msup>
   <mo>∈</mo>
   <msub>
    <mi>𝔽</mi>
    <msup>
     <mi>q</mi>
     <mi>n</mi>
    </msup>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <in></in>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>y</ci>
     <ci>normal-′</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>𝔽</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>q</ci>
      <ci>n</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   y^{\prime}\in\mathbb{F}_{q^{n}}
  </annotation>
 </semantics>
</math>

 and this result is denoted by 

<math display="inline" id="Hidden_Field_Equations:116">
 <semantics>
  <msup>
   <mi>y</mi>
   <mo>′</mo>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>y</ci>
    <ci>normal-′</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   y^{\prime}
  </annotation>
 </semantics>
</math>

. Once again, 

<math display="inline" id="Hidden_Field_Equations:117">
 <semantics>
  <mrow>
   <mo stretchy="false">(</mo>
   <msubsup>
    <mi>y</mi>
    <mn>1</mn>
    <mo>′</mo>
   </msubsup>
   <mo>,</mo>
   <mi mathvariant="normal">…</mi>
   <mo>,</mo>
   <msubsup>
    <mi>y</mi>
    <mi>n</mi>
    <mo>′</mo>
   </msubsup>
   <mo stretchy="false">)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <vector>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <cn type="integer">1</cn>
     </apply>
     <ci>normal-′</ci>
    </apply>
    <ci>normal-…</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <ci>n</ci>
     </apply>
     <ci>normal-′</ci>
    </apply>
   </vector>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (y_{1}^{\prime},...,y_{n}^{\prime})
  </annotation>
 </semantics>
</math>

 is transferred to the vector 

<math display="inline" id="Hidden_Field_Equations:118">
 <semantics>
  <mi>T</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>T</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   T
  </annotation>
 </semantics>
</math>


 and the transformation 

<math display="inline" id="Hidden_Field_Equations:119">
 <semantics>
  <mrow>
   <mi>y</mi>
   <mo>∈</mo>
   <msub>
    <mi>𝔽</mi>
    <msup>
     <mi>q</mi>
     <mi>n</mi>
    </msup>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <in></in>
    <ci>y</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>𝔽</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>q</ci>
      <ci>n</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   y\in\mathbb{F}_{q^{n}}
  </annotation>
 </semantics>
</math>

 is applied and the final output 

<math display="inline" id="Hidden_Field_Equations:120">
 <semantics>
  <mrow>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>y</mi>
     <mn>1</mn>
    </msub>
    <mo>,</mo>
    <mi mathvariant="normal">…</mi>
    <mo>,</mo>
    <msub>
     <mi>y</mi>
     <mi>n</mi>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>∈</mo>
   <msubsup>
    <mi>𝔽</mi>
    <mi>q</mi>
    <mi>n</mi>
   </msubsup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <in></in>
    <vector>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <cn type="integer">1</cn>
     </apply>
     <ci>normal-…</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <ci>n</ci>
     </apply>
    </vector>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>𝔽</ci>
      <ci>q</ci>
     </apply>
     <ci>n</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (y_{1},...,y_{n})\in\mathbb{F}_{q}^{n}
  </annotation>
 </semantics>
</math>

 is produced from 

<math display="inline" id="Hidden_Field_Equations:121">
 <semantics>
  <mi>y</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>y</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   y
  </annotation>
 </semantics>
</math>

.</p>

<p>To decrypt 

<math display="inline" id="Hidden_Field_Equations:122">
 <semantics>
  <mrow>
   <mo stretchy="false">(</mo>
   <mi>S</mi>
   <mo>,</mo>
   <mi>P</mi>
   <mo>,</mo>
   <mi>T</mi>
   <mo stretchy="false">)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <vector>
    <ci>S</ci>
    <ci>P</ci>
    <ci>T</ci>
   </vector>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (S,P,T)
  </annotation>
 </semantics>
</math>

, the above steps are done in reverse order. This is possible if the private key 

<math display="inline" id="Hidden_Field_Equations:123">
 <semantics>
  <mi>S</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>S</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   S
  </annotation>
 </semantics>
</math>


 is known. The crucial step in the deciphering is not the inversion of 

<math display="inline" id="Hidden_Field_Equations:124">
 <semantics>
  <mi>T</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>T</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   T
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Hidden_Field_Equations:125">
 <semantics>
  <mrow>
   <mrow>
    <mi>P</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <msup>
      <mi>x</mi>
      <mo>′</mo>
     </msup>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <msup>
    <mi>y</mi>
    <mo>′</mo>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>P</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>x</ci>
      <ci>normal-′</ci>
     </apply>
    </apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>y</ci>
     <ci>normal-′</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   P(x^{\prime})=y^{\prime}
  </annotation>
 </semantics>
</math>

 but rather the computations of the solution of 

<math display="inline" id="Hidden_Field_Equations:126">
 <semantics>
  <mi>P</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>P</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   P
  </annotation>
 </semantics>
</math>

. Since 

<math display="inline" id="Hidden_Field_Equations:127">
 <semantics>
  <mrow>
   <msup>
    <mi>X</mi>
    <mo>′</mo>
   </msup>
   <mo>=</mo>
   <mrow>
    <mo stretchy="false">(</mo>
    <msubsup>
     <mi>x</mi>
     <mn>1</mn>
     <mo>′</mo>
    </msubsup>
    <mo>,</mo>
    <mi mathvariant="normal">…</mi>
    <mo>,</mo>
    <msubsup>
     <mi>x</mi>
     <mi>d</mi>
     <mo>′</mo>
    </msubsup>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>∈</mo>
   <msub>
    <mi>𝔽</mi>
    <msup>
     <mi>q</mi>
     <mi>n</mi>
    </msup>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>X</ci>
      <ci>normal-′</ci>
     </apply>
     <vector>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <cn type="integer">1</cn>
       </apply>
       <ci>normal-′</ci>
      </apply>
      <ci>normal-…</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <ci>d</ci>
       </apply>
       <ci>normal-′</ci>
      </apply>
     </vector>
    </apply>
    <apply>
     <in></in>
     <share href="#.cmml">
     </share>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>𝔽</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>q</ci>
       <ci>n</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   X^{\prime}=(x_{1}^{\prime},...,x_{d}^{\prime})\in\mathbb{F}_{q^{n}}
  </annotation>
 </semantics>
</math>

 is not necessary a bijection, one may find more than one solution to this inversion (there exist at most d different solutions 

<math display="inline" id="Hidden_Field_Equations:128">
 <semantics>
  <mi>P</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>P</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   P
  </annotation>
 </semantics>
</math>


 since 

<math display="inline" id="Hidden_Field_Equations:129">
 <semantics>
  <mi>r</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>r</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   r
  </annotation>
 </semantics>
</math>

 is a polynomial of degree d). The redundancy denoted as 

<math display="inline" id="Hidden_Field_Equations:130">
 <semantics>
  <mi>M</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>M</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   M
  </annotation>
 </semantics>
</math>

 is added at the first step to the message 

<math display="inline" id="Hidden_Field_Equations:131">
 <semantics>
  <mi>M</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>M</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   M
  </annotation>
 </semantics>
</math>

 in order to select the right 

<math display="inline" id="Hidden_Field_Equations:132">
 <semantics>
  <msup>
   <mi>X</mi>
   <mo>′</mo>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>X</ci>
    <ci>normal-′</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   X^{\prime}
  </annotation>
 </semantics>
</math>

 from the set of solutions 

<math display="block" id="Hidden_Field_Equations:133">
 <semantics>
  <mrow>
   <mi>M</mi>
   <mover accent="true">
    <mo>→</mo>
    <mrow>
     <mo>+</mo>
     <mi>r</mi>
    </mrow>
   </mover>
   <mi>x</mi>
   <mover accent="true">
    <mo>→</mo>
    <mrow>
     <mtext>secret</mtext>
     <mo>:</mo>
     <mi>S</mi>
    </mrow>
   </mover>
   <msup>
    <mi>x</mi>
    <mo>′</mo>
   </msup>
   <mover accent="true">
    <mo>→</mo>
    <mrow>
     <mtext>secret</mtext>
     <mo>:</mo>
     <mi>P</mi>
    </mrow>
   </mover>
   <msup>
    <mi>y</mi>
    <mo>′</mo>
   </msup>
   <mover accent="true">
    <mo>→</mo>
    <mrow>
     <mtext>secret</mtext>
     <mo>:</mo>
     <mi>T</mi>
    </mrow>
   </mover>
   <mi>y</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>M</ci>
    <apply>
     <apply>
      <plus></plus>
      <ci>r</ci>
     </apply>
     <ci>normal-→</ci>
    </apply>
    <ci>x</ci>
    <apply>
     <apply>
      <ci>normal-:</ci>
      <mtext>secret</mtext>
      <ci>S</ci>
     </apply>
     <ci>normal-→</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>x</ci>
     <ci>normal-′</ci>
    </apply>
    <apply>
     <apply>
      <ci>normal-:</ci>
      <mtext>secret</mtext>
      <ci>P</ci>
     </apply>
     <ci>normal-→</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>y</ci>
     <ci>normal-′</ci>
    </apply>
    <apply>
     <apply>
      <ci>normal-:</ci>
      <mtext>secret</mtext>
      <ci>T</ci>
     </apply>
     <ci>normal-→</ci>
    </apply>
    <ci>y</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   M\overset{+r}{\to}x\overset{\text{secret}:S}{\to}x^{\prime}\overset{\text{%
secret}:P}{\to}y^{\prime}\overset{\text{secret}:T}{\to}y
  </annotation>
 </semantics>
</math>

.<a class="footnoteRef" href="#fn8" id="fnref8"><sup>8</sup></a><a class="footnoteRef" href="#fn9" id="fnref9"><sup>9</sup></a><a class="footnoteRef" href="#fn10" id="fnref10"><sup>10</sup></a> The diagram below shows the basic HFE for encryption.</p>

<p>

<math display="inline" id="Hidden_Field_Equations:134">
 <semantics>
  <mi>f</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>f</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f
  </annotation>
 </semantics>
</math>

</p>
<h2 id="hfe-variations">HFE variations</h2>

<p>Hidden Field Equations has four basic variations namely <strong>+,-,v and f</strong> and it is possible to combine them in various way. The basic principle is the following:</p>
<dl>
<dd>01. The <strong>+</strong> sign consists of linearity mixing of the public equations with some random equations.
</dd>
<dd>02. The <strong>-</strong> sign is due to <a href="Adi_Shamir" title="wikilink">Adi Shamir</a> and intends to remove the redundancy 'r' of the public equations.
</dd>
<dd>03. The <strong>f</strong> sign consists of fixing some 

<math display="inline" id="Hidden_Field_Equations:135">
 <semantics>
  <msub>
   <mi>𝔽</mi>
   <msup>
    <mi>q</mi>
    <mi>n</mi>
   </msup>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>𝔽</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>q</ci>
     <ci>n</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbb{F}_{q^{n}}
  </annotation>
 </semantics>
</math>

 input variables of the public key.
</dd>
<dd>04. The <strong>v</strong> sign is defined as a construction and sometimes quite complex such that the inverse of the function can be found only if some v of the variables called vinegar variables are fixed. This idea is due to Jacques Patarin.
</dd>
</dl>

<p>The operations above preserve to some extent the trapdoor solvability of the function.</p>

<p>HFE- and HFEv are very useful in signature schemes as they prevent from slowing down the signature generation and also enhance the overall security of HFE whereas for <a class="uri" href="encryption" title="wikilink">encryption</a> both HFE- and HFEv will lead to a rather slow <a class="uri" href="decryption" title="wikilink">decryption</a> process so neither too many equations can be removed (HFE-) nor too many variables should be added (HFEv). Both HFE- and HFEv were used to obtain Quartz.</p>

<p>For encryption, the situation is better with HFE+ since the <a class="uri" href="decryption" title="wikilink">decryption</a> process takes the same amount of time, however the public key has more equations than variables.<a class="footnoteRef" href="#fn11" id="fnref11"><sup>11</sup></a><a class="footnoteRef" href="#fn12" id="fnref12"><sup>12</sup></a></p>
<h2 id="hfe-attacks">HFE attacks</h2>

<p>There are two famous recent attacks on HFE:</p>

<p>Recover the Private Key (Shamir-Kipnis): The key point of this attack is to recover the private key as sparse univariate polynomials over the extension field <span class="LaTeX">$\mathbb{F}_{q^n}$</span>. The attack only works for basic HFE and fails for all its variations.</p>

<p>Fast Gröbner Bases (Faugere): The idea of Faugere's attacks is to use fast algorithm to compute a <a href="Gröbner_basis" title="wikilink">Gröbner basis</a> of the system of polynomial equations. Faugere broke the HFE challenge 1 in 96 hours in 2002 and in 2003 Faugere and <a href="Antoine_Joux" title="wikilink">Joux</a> worked together on the security of HFE.<a class="footnoteRef" href="#fn13" id="fnref13"><sup>13</sup></a></p>
<h2 id="references">References</h2>
<ul>
<li><a href="http://eprint.iacr.org/2002/138">Nicolas T. Courtouis, Magnus Daum and Patrick Felke, On the Security of HFE, HFEv- and Quartz</a></li>
<li><a href="http://www.win.tue.nl/~asidoren/HFE2004.pdf">Andrey Sidorenko, Hidden Field Equations, EIDMA Seminar 2004 Technische Universiteit Eindhoven</a></li>
<li>Yvo G. Desmet, Public Key Cryptography-PKC 2003, ISBN 3-540-00324-X</li>
</ul>

<p>"</p>

<p><a href="Category:Public-key_encryption_schemes" title="wikilink">Category:Public-key encryption schemes</a> <a href="Category:Finite_fields" title="wikilink">Category:Finite fields</a> <a href="Category:Multivariate_cryptography" title="wikilink">Category:Multivariate cryptography</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1"><a href="http://eprint.iacr.org/2001/029.pdf">Christopher Wolf and Bart Preneel, Asymmetric Cryptography: Hidden Field Equations</a><a href="#fnref1">↩</a></li>
<li id="fn2"><a href="http://eprint.iacr.org/2001/029.pdf">Nicolas T. Courtois On Multivariate Signature-only public key cryptosystems</a><a href="#fnref2">↩</a></li>
<li id="fn3"><a href="http://eprint.iacr.org/2003/061.pdf">Ilia Toli Hidden Polynomial Cryptosystems</a><a href="#fnref3">↩</a></li>
<li id="fn4"></li>
<li id="fn5"><a href="http://www.ssi.gouv.fr/fr/sciences/fichiers/lcr/fajo03.pdf">Jean Charles Faugere and Antoine Joux, Algebraic Cryptanalysis of Hidden Field Equations (HFE) Cryptosystems Using Grobner Bases</a><a href="#fnref5">↩</a></li>
<li id="fn6"></li>
<li id="fn7">Nicolas T. Courtois, "The Security of Hidden Field Equations"<a href="#fnref7">↩</a></li>
<li id="fn8"></li>
<li id="fn9"></li>
<li id="fn10"><a href="http://www.cryptosystem.net/hfe.pdf">Jacques Patarin, Hidden Field Equations (HFE) and Isomorphic Polynomial (IP): two new families of asymmetric algorithm</a><a href="#fnref10">↩</a></li>
<li id="fn11"></li>
<li id="fn12"></li>
<li id="fn13"></li>
</ol>
</section>
</body>
</html>

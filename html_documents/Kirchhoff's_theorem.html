<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="201">Kirchhoff's theorem</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Kirchhoff's theorem</h1>
<hr/>

<p>In the <a href="mathematics" title="wikilink">mathematical</a> field of <a href="graph_theory" title="wikilink">graph theory</a> <strong>Kirchhoff's theorem</strong> or <strong>Kirchhoff's matrix tree theorem</strong> named after <a href="Gustav_Kirchhoff" title="wikilink">Gustav Kirchhoff</a> is a theorem about the number of <a href="spanning_tree_(mathematics)" title="wikilink">spanning trees</a> in a <a href="Graph_(mathematics)" title="wikilink">graph</a>, showing that this number can be computed in <a href="polynomial_time" title="wikilink">polynomial time</a> as the <a class="uri" href="determinant" title="wikilink">determinant</a> of a <a href="Matrix_(mathematics)" title="wikilink">matrix</a> derived from the graph. It is a generalization of <a href="Cayley's_formula" title="wikilink">Cayley's formula</a> which provides the number of spanning trees in a <a href="complete_graph" title="wikilink">complete graph</a>.</p>

<p>Kirchhoff's theorem relies on the notion of the <a href="Laplacian_matrix" title="wikilink">Laplacian matrix</a> of a graph that is equal to the difference between the graph's <a href="degree_matrix" title="wikilink">degree matrix</a> (a diagonal matrix with vertex degrees on the diagonals) and its <a href="adjacency_matrix" title="wikilink">adjacency matrix</a> (a (0,1)-matrix with 1's at places corresponding to entries where the vertices are adjacent and 0's otherwise).</p>

<p>For a given connected graph <em>G</em> with <em>n</em> labeled <a href="vertex_(graph_theory)" title="wikilink">vertices</a>, let <em>λ</em><sub>1</sub>, <em>λ</em><sub>2</sub>, ..., <em>λ<sub>n</sub></em><sub>−1</sub> be the non-zero <a class="uri" href="eigenvalues" title="wikilink">eigenvalues</a> of its Laplacian matrix. Then the number of spanning trees of <em>G</em> is</p>

<p>

<math display="block" id="Kirchhoff's_theorem:0">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>t</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>G</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mfrac>
      <mn>1</mn>
      <mi>n</mi>
     </mfrac>
     <msub>
      <mi>λ</mi>
      <mn>1</mn>
     </msub>
     <msub>
      <mi>λ</mi>
      <mn>2</mn>
     </msub>
     <mi mathvariant="normal">⋯</mi>
     <mpadded width="+1.7pt">
      <msub>
       <mi>λ</mi>
       <mrow>
        <mi>n</mi>
        <mo>-</mo>
        <mn>1</mn>
       </mrow>
      </msub>
     </mpadded>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>t</ci>
     <ci>G</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <divide></divide>
      <cn type="integer">1</cn>
      <ci>n</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>λ</ci>
      <cn type="integer">1</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>λ</ci>
      <cn type="integer">2</cn>
     </apply>
     <ci>normal-⋯</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>λ</ci>
      <apply>
       <minus></minus>
       <ci>n</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   t(G)=\frac{1}{n}\lambda_{1}\lambda_{2}\cdots\lambda_{n-1}\,.
  </annotation>
 </semantics>
</math>

</p>

<p>Equivalently the number of spanning trees is equal to <em>any</em> cofactor of the Laplacian matrix of <em>G</em>.</p>
<h2 id="an-example-using-the-matrix-tree-theorem">An example using the matrix-tree theorem</h2>
<figure><b>(Figure)</b>
<figcaption>The Matrix-Tree Theorem can be used to compute the number of labeled spanning trees of this graph.</figcaption>
</figure>

<p>First, construct the <a href="Laplacian_matrix" title="wikilink">Laplacian matrix</a> <em>Q</em> for the example kite graph <em>G</em> (see image at right):</p>

<p>

<math display="block" id="Kirchhoff's_theorem:1">
 <semantics>
  <mrow>
   <mrow>
    <mi>Q</mi>
    <mo>=</mo>
    <mrow>
     <mo>[</mo>
     <mtable displaystyle="true">
      <mtr>
       <mtd columnalign="right">
        <mn>2</mn>
       </mtd>
       <mtd columnalign="right">
        <mrow>
         <mo>-</mo>
         <mn>1</mn>
        </mrow>
       </mtd>
       <mtd columnalign="right">
        <mrow>
         <mo>-</mo>
         <mn>1</mn>
        </mrow>
       </mtd>
       <mtd columnalign="right">
        <mn>0</mn>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="right">
        <mrow>
         <mo>-</mo>
         <mn>1</mn>
        </mrow>
       </mtd>
       <mtd columnalign="right">
        <mn>3</mn>
       </mtd>
       <mtd columnalign="right">
        <mrow>
         <mo>-</mo>
         <mn>1</mn>
        </mrow>
       </mtd>
       <mtd columnalign="right">
        <mrow>
         <mo>-</mo>
         <mn>1</mn>
        </mrow>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="right">
        <mrow>
         <mo>-</mo>
         <mn>1</mn>
        </mrow>
       </mtd>
       <mtd columnalign="right">
        <mrow>
         <mo>-</mo>
         <mn>1</mn>
        </mrow>
       </mtd>
       <mtd columnalign="right">
        <mn>3</mn>
       </mtd>
       <mtd columnalign="right">
        <mrow>
         <mo>-</mo>
         <mn>1</mn>
        </mrow>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="right">
        <mn>0</mn>
       </mtd>
       <mtd columnalign="right">
        <mrow>
         <mo>-</mo>
         <mn>1</mn>
        </mrow>
       </mtd>
       <mtd columnalign="right">
        <mrow>
         <mo>-</mo>
         <mn>1</mn>
        </mrow>
       </mtd>
       <mtd columnalign="right">
        <mn>2</mn>
       </mtd>
      </mtr>
     </mtable>
     <mo>]</mo>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>Q</ci>
    <apply>
     <csymbol cd="latexml">delimited-[]</csymbol>
     <matrix>
      <matrixrow>
       <cn type="integer">2</cn>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
       </apply>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
       </apply>
       <cn type="integer">0</cn>
      </matrixrow>
      <matrixrow>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
       </apply>
       <cn type="integer">3</cn>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
       </apply>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
       </apply>
      </matrixrow>
      <matrixrow>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
       </apply>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
       </apply>
       <cn type="integer">3</cn>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
       </apply>
      </matrixrow>
      <matrixrow>
       <cn type="integer">0</cn>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
       </apply>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
       </apply>
       <cn type="integer">2</cn>
      </matrixrow>
     </matrix>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Q=\left[\begin{array}[]{rrrr}2&-1&-1&0\\
-1&3&-1&-1\\
-1&-1&3&-1\\
0&-1&-1&2\end{array}\right].
  </annotation>
 </semantics>
</math>

</p>

<p>Next, construct a matrix <em>Q<sup>*</sup></em> by deleting any row and any column from <em>Q</em>. For example, deleting row 1 and column 1 yields</p>

<p>

<math display="block" id="Kirchhoff's_theorem:2">
 <semantics>
  <mrow>
   <mrow>
    <msup>
     <mi>Q</mi>
     <mo>∗</mo>
    </msup>
    <mo>=</mo>
    <mrow>
     <mo>[</mo>
     <mtable displaystyle="true">
      <mtr>
       <mtd columnalign="right">
        <mn>3</mn>
       </mtd>
       <mtd columnalign="right">
        <mrow>
         <mo>-</mo>
         <mn>1</mn>
        </mrow>
       </mtd>
       <mtd columnalign="right">
        <mrow>
         <mo>-</mo>
         <mn>1</mn>
        </mrow>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="right">
        <mrow>
         <mo>-</mo>
         <mn>1</mn>
        </mrow>
       </mtd>
       <mtd columnalign="right">
        <mn>3</mn>
       </mtd>
       <mtd columnalign="right">
        <mrow>
         <mo>-</mo>
         <mn>1</mn>
        </mrow>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="right">
        <mrow>
         <mo>-</mo>
         <mn>1</mn>
        </mrow>
       </mtd>
       <mtd columnalign="right">
        <mrow>
         <mo>-</mo>
         <mn>1</mn>
        </mrow>
       </mtd>
       <mtd columnalign="right">
        <mn>2</mn>
       </mtd>
      </mtr>
     </mtable>
     <mo>]</mo>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>Q</ci>
     <ci>normal-∗</ci>
    </apply>
    <apply>
     <csymbol cd="latexml">delimited-[]</csymbol>
     <matrix>
      <matrixrow>
       <cn type="integer">3</cn>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
       </apply>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
       </apply>
      </matrixrow>
      <matrixrow>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
       </apply>
       <cn type="integer">3</cn>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
       </apply>
      </matrixrow>
      <matrixrow>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
       </apply>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
       </apply>
       <cn type="integer">2</cn>
      </matrixrow>
     </matrix>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Q^{\ast}=\left[\begin{array}[]{rrr}3&-1&-1\\
-1&3&-1\\
-1&-1&2\end{array}\right].
  </annotation>
 </semantics>
</math>

</p>

<p>Finally, take the <a class="uri" href="determinant" title="wikilink">determinant</a> of <em>Q<sup>*</sup></em> to obtain <em>t(G)</em>, which is 8 for the kite graph. (Notice <em>t(G)</em> is the <em>(1,1)</em>-cofactor of <em>Q</em> in this example.)</p>
<h2 id="proof-outline">Proof outline</h2>

<p>First notice that the Laplacian has the property that the sum of its entries across any row and any column is 0. Thus we can transform any minor into any other minor by adding rows and columns, switching them, and multiplying a row or a column by −1. Thus the cofactors are the same up to sign, and it can be verified that, in fact, they have the same sign.</p>

<p>We proceed to show that the determinant of the minor <em>M<sub>11</sub></em> counts the number of spanning trees. Let <em>n</em> be the number of vertices of the graph, and <em>m</em> the number of its edges. The incidence matrix 

<math display="inline" id="Kirchhoff's_theorem:3">
 <semantics>
  <mi>E</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>E</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   E
  </annotation>
 </semantics>
</math>

 is an <em>n</em>-by-<em>m</em> matrix, which may be defined as follows: suppose that (<em>i</em>, <em>j</em>) is the <em>k</em>th edge of the graph, and that <em>i</em> ik'' = <em>1</em>, <em>E<sub>jk</sub> = −1</em>, and all other entries in column <em>k</em> are 0 (see oriented <a href="Incidence_matrix" title="wikilink">Incidence matrix</a> for understanding this modified incidence matrix E). For the preceding example (with <em>n</em> = 4 and <em>m</em> = 5):</p>

<p>

<math display="block" id="Kirchhoff's_theorem:4">
 <semantics>
  <mrow>
   <mrow>
    <mi>E</mi>
    <mo>=</mo>
    <mrow>
     <mo>[</mo>
     <mtable displaystyle="true">
      <mtr>
       <mtd columnalign="center">
        <mn>1</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>1</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mrow>
         <mo>-</mo>
         <mn>1</mn>
        </mrow>
       </mtd>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>1</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>1</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
       <mtd columnalign="center">
        <mrow>
         <mo>-</mo>
         <mn>1</mn>
        </mrow>
       </mtd>
       <mtd columnalign="center">
        <mrow>
         <mo>-</mo>
         <mn>1</mn>
        </mrow>
       </mtd>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>1</mn>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
       <mtd columnalign="center">
        <mrow>
         <mo>-</mo>
         <mn>1</mn>
        </mrow>
       </mtd>
       <mtd columnalign="center">
        <mrow>
         <mo>-</mo>
         <mn>1</mn>
        </mrow>
       </mtd>
      </mtr>
     </mtable>
     <mo>]</mo>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>E</ci>
    <matrix>
     <matrixrow>
      <cn type="integer">1</cn>
      <cn type="integer">1</cn>
      <cn type="integer">0</cn>
      <cn type="integer">0</cn>
      <cn type="integer">0</cn>
     </matrixrow>
     <matrixrow>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
      </apply>
      <cn type="integer">0</cn>
      <cn type="integer">1</cn>
      <cn type="integer">1</cn>
      <cn type="integer">0</cn>
     </matrixrow>
     <matrixrow>
      <cn type="integer">0</cn>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
      </apply>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
      </apply>
      <cn type="integer">0</cn>
      <cn type="integer">1</cn>
     </matrixrow>
     <matrixrow>
      <cn type="integer">0</cn>
      <cn type="integer">0</cn>
      <cn type="integer">0</cn>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
      </apply>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
      </apply>
     </matrixrow>
    </matrix>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   E=\begin{bmatrix}1&1&0&0&0\\
-1&0&1&1&0\\
0&-1&-1&0&1\\
0&0&0&-1&-1\\
\end{bmatrix}.
  </annotation>
 </semantics>
</math>

</p>

<p>Recall that the Laplacian <em>L</em> can be factored into the product of the <a href="incidence_matrix" title="wikilink">incidence matrix</a> and its transpose, i.e., <em>L</em> = <em>EE</em><sup>T</sup>. Furthermore, let <em>F</em> be the matrix <em>E</em> with its first row deleted, so that <em>FF</em><sup>T</sup> = <em>M<sub>11</sub></em>.</p>

<p>Now the <a href="Cauchy-Binet_formula" title="wikilink">Cauchy-Binet formula</a> allows us to write</p>

<p>

<math display="block" id="Kirchhoff's_theorem:5">
 <semantics>
  <mrow>
   <mrow>
    <mo movablelimits="false">det</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <msub>
      <mi>M</mi>
      <mn>11</mn>
     </msub>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <munder>
     <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
     <mi>S</mi>
    </munder>
    <mrow>
     <mo movablelimits="false">det</mo>
     <mrow>
      <mrow>
       <mo stretchy="false">(</mo>
       <msub>
        <mi>F</mi>
        <mi>S</mi>
       </msub>
       <mo stretchy="false">)</mo>
      </mrow>
      <mrow>
       <mo movablelimits="false">det</mo>
       <mrow>
        <mo stretchy="false">(</mo>
        <msubsup>
         <mi>F</mi>
         <mi>S</mi>
         <mi>T</mi>
        </msubsup>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <munder>
     <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
     <mi>S</mi>
    </munder>
    <mrow>
     <mo movablelimits="false">det</mo>
     <msup>
      <mrow>
       <mo stretchy="false">(</mo>
       <msub>
        <mi>F</mi>
        <mi>S</mi>
       </msub>
       <mo stretchy="false">)</mo>
      </mrow>
      <mn>2</mn>
     </msup>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <determinant></determinant>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>M</ci>
       <cn type="integer">11</cn>
      </apply>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <ci>S</ci>
      </apply>
      <apply>
       <determinant></determinant>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>F</ci>
         <ci>S</ci>
        </apply>
        <apply>
         <determinant></determinant>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <ci>F</ci>
           <ci>T</ci>
          </apply>
          <ci>S</ci>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <ci>S</ci>
      </apply>
      <apply>
       <determinant></determinant>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>F</ci>
         <ci>S</ci>
        </apply>
        <cn type="integer">2</cn>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \det(M_{11})=\sum_{S}\det(F_{S})\det(F^{T}_{S})=\sum_{S}\det(F_{S})^{2}
  </annotation>
 </semantics>
</math>

</p>

<p>where <em>S</em> ranges across subsets of [<em>m</em>] of size <em>n</em> − 1, and <em>F<sub>S</sub></em> denotes the (<em>n</em> − 1)-by-(<em>n</em> − 1) matrix whose columns are those of <em>F</em> with index in <em>S</em>. Then every <em>S</em> specifies <em>n</em> − 1 edges of the original graph, and it can be shown that those edges induce a spanning tree iff the determinant of <em>F<sub>S</sub></em> is +1 or −1, and that they do not induce a spanning tree iff the determinant is 0. This completes the proof.</p>
<h2 id="particular-cases-and-generalizations">Particular cases and generalizations</h2>
<h3 id="cayleys-formula">Cayley's formula</h3>

<p><a href="Cayley's_formula" title="wikilink">Cayley's formula</a> follows from Kirchhoff's theorem as a special case, since every vector with 1 in one place, −1 in another place, and 0 elsewhere is an eigenvector of the Laplacian matrix of the complete graph, with the corresponding eigenvalue being <em>n</em>. These vectors together span a space of dimension <em>n</em> − 1, so there are no other non-zero eigenvalues.</p>

<p>Alternatively, note that as Cayley's formula counts the number of distinct labeled trees of a complete graph <em>K<sub>n</sub></em> we need to compute any cofactor of the Laplacian matrix of <em>K<sub>n</sub></em>. The Laplacian matrix in this case is</p>

<p>

<math display="block" id="Kirchhoff's_theorem:6">
 <semantics>
  <mrow>
   <mrow>
    <mo>[</mo>
    <mtable displaystyle="true">
     <mtr>
      <mtd columnalign="center">
       <mrow>
        <mi>n</mi>
        <mo>-</mo>
        <mn>1</mn>
       </mrow>
      </mtd>
      <mtd columnalign="center">
       <mrow>
        <mo>-</mo>
        <mn>1</mn>
       </mrow>
      </mtd>
      <mtd columnalign="center">
       <mi mathvariant="normal">⋯</mi>
      </mtd>
      <mtd columnalign="center">
       <mrow>
        <mo>-</mo>
        <mn>1</mn>
       </mrow>
      </mtd>
     </mtr>
     <mtr>
      <mtd columnalign="center">
       <mrow>
        <mo>-</mo>
        <mn>1</mn>
       </mrow>
      </mtd>
      <mtd columnalign="center">
       <mrow>
        <mi>n</mi>
        <mo>-</mo>
        <mn>1</mn>
       </mrow>
      </mtd>
      <mtd columnalign="center">
       <mi mathvariant="normal">⋯</mi>
      </mtd>
      <mtd columnalign="center">
       <mrow>
        <mo>-</mo>
        <mn>1</mn>
       </mrow>
      </mtd>
     </mtr>
     <mtr>
      <mtd columnalign="center">
       <mi mathvariant="normal">⋮</mi>
      </mtd>
      <mtd columnalign="center">
       <mi mathvariant="normal">⋮</mi>
      </mtd>
      <mtd columnalign="center">
       <mi mathvariant="normal">⋱</mi>
      </mtd>
      <mtd columnalign="center">
       <mi mathvariant="normal">⋮</mi>
      </mtd>
     </mtr>
     <mtr>
      <mtd columnalign="center">
       <mrow>
        <mo>-</mo>
        <mn>1</mn>
       </mrow>
      </mtd>
      <mtd columnalign="center">
       <mrow>
        <mo>-</mo>
        <mn>1</mn>
       </mrow>
      </mtd>
      <mtd columnalign="center">
       <mi mathvariant="normal">⋯</mi>
      </mtd>
      <mtd columnalign="center">
       <mrow>
        <mi>n</mi>
        <mo>-</mo>
        <mn>1</mn>
       </mrow>
      </mtd>
     </mtr>
    </mtable>
    <mo>]</mo>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <matrix>
    <matrixrow>
     <apply>
      <minus></minus>
      <ci>n</ci>
      <cn type="integer">1</cn>
     </apply>
     <apply>
      <minus></minus>
      <cn type="integer">1</cn>
     </apply>
     <ci>normal-⋯</ci>
     <apply>
      <minus></minus>
      <cn type="integer">1</cn>
     </apply>
    </matrixrow>
    <matrixrow>
     <apply>
      <minus></minus>
      <cn type="integer">1</cn>
     </apply>
     <apply>
      <minus></minus>
      <ci>n</ci>
      <cn type="integer">1</cn>
     </apply>
     <ci>normal-⋯</ci>
     <apply>
      <minus></minus>
      <cn type="integer">1</cn>
     </apply>
    </matrixrow>
    <matrixrow>
     <ci>normal-⋮</ci>
     <ci>normal-⋮</ci>
     <ci>normal-⋱</ci>
     <ci>normal-⋮</ci>
    </matrixrow>
    <matrixrow>
     <apply>
      <minus></minus>
      <cn type="integer">1</cn>
     </apply>
     <apply>
      <minus></minus>
      <cn type="integer">1</cn>
     </apply>
     <ci>normal-⋯</ci>
     <apply>
      <minus></minus>
      <ci>n</ci>
      <cn type="integer">1</cn>
     </apply>
    </matrixrow>
   </matrix>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \begin{bmatrix}n-1&-1&\cdots&-1\\
-1&n-1&\cdots&-1\\
\vdots&\vdots&\ddots&\vdots\\
-1&-1&\cdots&n-1\\
\end{bmatrix}.
  </annotation>
 </semantics>
</math>

</p>

<p>Any cofactor of the above matrix is <em>n<sup>n</sup></em><sup>−2</sup>, which is Cayley's formula.</p>
<h3 id="kirchhoffs-theorem-for-multigraphs">Kirchhoff's theorem for multigraphs</h3>

<p>Kirchhoff's theorem holds for <a href="multigraph" title="wikilink">multigraphs</a> as well; the matrix <em>Q</em> is modified as follows:</p>
<ul>
<li>The entry <em>q<sub>i,j</sub></em> equals −<em>m</em>, where <em>m</em> is the number of edges between <em>i</em> and <em>j</em>;</li>
<li>when counting the degree of a vertex, all <a href="loop_(graph_theory)" title="wikilink">loops</a> are excluded.</li>
</ul>
<h3 id="explicit-enumeration-of-spanning-trees">Explicit enumeration of spanning trees</h3>

<p>Kirchhoff's theorem can be strengthened by altering the definition of the Laplacian matrix. Rather than merely counting edges emanating from each vertex or connecting a pair of vertices, label each edge with an <a href="Indeterminate_(variable)" title="wikilink">indeterminant</a> and let the (<em>i</em>, <em>j</em>)-th entry of the modified Laplacian matrix be the sum over the indeterminants corresponding to edges between the <em>i</em>-th and <em>j</em>-th vertices when <em>i</em> does not equal <em>j</em>, and the negative sum over all indeterminants corresponding to edges emanating from the <em>i</em>-th vertex when <em>i</em> equals <em>j</em>.</p>

<p>The determinant above is then a <a href="homogeneous_polynomial" title="wikilink">homogeneous polynomial</a> (the Kirchhoff polynomial) in the indeterminants corresponding to the edges of the graph. After collecting terms and performing all possible cancellations, each <a class="uri" href="monomial" title="wikilink">monomial</a> in the resulting expression represents a spanning tree consisting of the edges corresponding to the indeterminants appearing in that monomial. In this way, one can obtain explicit enumeration of all the spanning trees of the graph simply by computing the determinant.</p>
<h3 id="matroids">Matroids</h3>

<p>The spanning trees of a graph form the bases of a <a href="graphic_matroid" title="wikilink">graphic matroid</a>, so Kirchhoff's theorem provides a formula to count the number of bases in a graphic matroid. The same method may also be used to count the number of bases in <a href="regular_matroid" title="wikilink">regular matroids</a>, a generalization of the graphic matroids .</p>
<h3 id="kirchhoffs-theorem-for-directed-multigraphs">Kirchhoff's theorem for directed multigraphs</h3>

<p>Kirchhoff's theorem can be modified to count the number of oriented spanning trees in directed multigraphs. The matrix <em>Q</em> is constructed as follows:</p>
<ul>
<li>The entry <em>q<sub>i,j</sub></em> for distinct <em>i</em> and <em>j</em> equals −<em>m</em>, where <em>m</em> is the number of edges from <em>i</em> to <em>j</em>;</li>
<li>The entry <em>q<sub>i,i</sub></em> equals the outdegree of <em>i</em> minus the number of loops at <em>i</em>.</li>
</ul>

<p>The number of oriented spanning trees rooted at a vertex <em>i</em> is the determinant of the matrix gotten by removing the <em>i</em>th row and column of <em>Q</em>.</p>
<h2 id="see-also">See also</h2>
<ul>
<li><a href="Prüfer_sequences" title="wikilink">Prüfer sequences</a></li>
<li><a href="Minimum_spanning_tree" title="wikilink">Minimum spanning tree</a></li>
<li><a href="List_of_graph_theory_topics#Trees" title="wikilink">List of topics related to trees</a></li>
</ul>
<h2 id="references">References</h2>
<ul>
<li>

<p>.</p></li>
<li>

<p>.</p></li>
<li>

<p>.</p></li>
<li></li>
</ul>
<h2 id="external-links">External links</h2>
<ul>
<li><a href="http://www.math.fau.edu/locke/Graphmat.htm">A proof of Kirchhoff's theorem</a></li>
<li><a href="http://www.math.ku.edu/~jmartin/mc2004/graph1.pdf">A discussion on the theorem and similar results</a></li>
</ul>

<p>"</p>

<p><a href="Category:Algebraic_graph_theory" title="wikilink">Category:Algebraic graph theory</a> <a href="Category:Spanning_tree" title="wikilink">Category:Spanning tree</a> <a href="Category:Theorems_in_graph_theory" title="wikilink">Category:Theorems in graph theory</a></p>
</body>
</html>

<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="498">Fenwick tree</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Fenwick tree</h1>
<hr>A '''Fenwick tree''' or '''binary indexed tree''' is a data s
<p>tructure providing efficient methods for calculation and manipulation of the <a href="prefix_sum" title="wikilink">prefix sums</a> of a table of values. It was proposed by <a href="Peter_Fenwick_(computer_scientist)" title="wikilink">Peter Fenwick</a> in 1994.<a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a> Fenwick trees primarily solve the problem of balancing prefix sum calculation efficiency with element modification efficiency. The efficiency of these operations comes as a trade-off - greater efficiency in prefix sum calculation is achieved by pre-calculating values, but as more values are pre-calculated more must be re-calculated upon any modification to the underlying value table. Fenwick trees both calculate prefix sums and modify the table in 

<math display="inline" id="Fenwick_tree:0">
 <semantics>
  <mrow>
   <mi>O</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mrow>
     <mi>log</mi>
     <mi>n</mi>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>O</ci>
    <apply>
     <log></log>
     <ci>n</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   O(\log n)
  </annotation>
 </semantics>
</math>

 time, where 

<math display="inline" id="Fenwick_tree:1">
 <semantics>
  <mi>n</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>n</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n
  </annotation>
 </semantics>
</math>

 is the size of the table.</p>
<h2 id="description">Description</h2>

<p>Given a table of elements, it is sometimes desirable to calculate the <a href="running_total" title="wikilink">running total</a> of values up to each index according to some <a href="Associative_property" title="wikilink">associative</a> <a href="binary_operation" title="wikilink">binary operation</a> (addition on integers, for example). Fenwick trees provide a method to query the running total at any index, in addition to allowing changes to the underlying value table and having all further queries reflect those changes. Although Fenwick trees are <a href="Tree_(data_structure)" title="wikilink">trees</a> in concept, in practice they are implemented using a flat array analogous to implementations of a <a href="binary_heap" title="wikilink">binary heap</a>. Given an index in the array representing a vertex, the index of a vertex's parent or child is calculated through <a href="bitwise_operation" title="wikilink">bitwise operations</a> on the <a href="Binary_numeral_system" title="wikilink">binary</a> representation of its index. Each index contains the pre-calculated sum of a section of the table, and by combining that sum with section sums encountered during an upward traversal to the root, the prefix sum is calculated. When a table value is modified, all section sums which contain the modified value are in turn modified during a similar traversal of the tree. The section sums are defined in such a way that queries and modifications to the table are executed in asymptotically equivalent time - 

<math display="inline" id="Fenwick_tree:2">
 <semantics>
  <mrow>
   <mi>O</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mrow>
     <mi>log</mi>
     <mi>n</mi>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>O</ci>
    <apply>
     <log></log>
     <ci>n</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   O(\log n)
  </annotation>
 </semantics>
</math>

 in the worst case.</p>

<p>The initial process of building the Fenwick tree over a table of values runs in 

<math display="inline" id="Fenwick_tree:3">
 <semantics>
  <mrow>
   <mi>O</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mrow>
     <mi>n</mi>
     <mrow>
      <mi>log</mi>
      <mi>n</mi>
     </mrow>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>O</ci>
    <apply>
     <times></times>
     <ci>n</ci>
     <apply>
      <log></log>
      <ci>n</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   O(n\log n)
  </annotation>
 </semantics>
</math>

 time. Other efficient operations include locating the index of a value if all values are positive, or all indices with a given value if all values are non-negative. Also supported is the scaling of all values by a constant factor in 

<math display="inline" id="Fenwick_tree:4">
 <semantics>
  <mrow>
   <mi>O</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>n</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>O</ci>
    <ci>n</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   O(n)
  </annotation>
 </semantics>
</math>

 time. The sum of an arbitrary subarray can also be calculated by subtracting the prefix sum before its start point from the prefix sum at its end point.</p>
<h2 id="applications">Applications</h2>

<p>Fenwick trees are used to implement the <a href="arithmetic_coding" title="wikilink">arithmetic coding</a> algorithm. Development of operations it supports were primarily motivated by use in that case.</p>

<p>Using a Fenwick tree it is very easy to generate the cumulative sum table. From this cumulative sum table it is possible to calculate the summation of the frequencies in a certain range in order of 

<math display="inline" id="Fenwick_tree:5">
 <semantics>
  <mrow>
   <mi>O</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mrow>
     <mi>log</mi>
     <mi>n</mi>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>O</ci>
    <apply>
     <log></log>
     <ci>n</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   O(\log n)
  </annotation>
 </semantics>
</math>

.</p>

<p>Fenwick tree can also be used to update and query subarrays in multidimensional arrays with complexity 

<math display="inline" id="Fenwick_tree:6">
 <semantics>
  <mrow>
   <mi>O</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mrow>
     <msup>
      <mn>2</mn>
      <mi>d</mi>
     </msup>
     <mrow>
      <msup>
       <mi>log</mi>
       <mi>d</mi>
      </msup>
      <mi>n</mi>
     </mrow>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>O</ci>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <cn type="integer">2</cn>
      <ci>d</ci>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <log></log>
       <ci>d</ci>
      </apply>
      <ci>n</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   O(2^{d}\log^{d}n)
  </annotation>
 </semantics>
</math>

, where d is number of dimensions and n is the number of elements along each dimension. <a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a> </p>
<h2 id="see-also">See also</h2>
<ul>
<li><a href="Order_statistic_tree" title="wikilink">Order statistic tree</a></li>
<li><a href="Prefix_sums" title="wikilink">Prefix sums</a></li>
<li><a href="Segment_tree" title="wikilink">Segment tree</a></li>
</ul>
<h2 id="references">References</h2>
<references>
</references>
<h2 id="external-links">External links</h2>
<ul>
<li>[<a class="uri" href="http://www.topcoder.com/tc?module=Static&amp;d1">http://www.topcoder.com/tc?module=Static&amp;d1;</a>;=tutorials&amp;d2;=binaryIndexedTrees A tutorial on Fenwick Trees on TopCoder]</li>
<li><a href="http://www.algorithmist.com/index.php/Fenwick_tree">An article on Fenwick Trees on Algorithmist</a></li>
<li><a href="http://michaelnielsen.org/polymath1/index.php?title=Updating_partial_sums_with_Fenwick_tree">An entry on Fenwick Trees on Polymath wiki</a></li>
<li><a href="http://cs.stackexchange.com/questions/10538/">1</a></li>
</ul>

<p>"</p>

<p><a href="Category:Trees_(data_structures)" title="wikilink">Category:Trees (data structures)</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1"><a href="#fnref1">↩</a></li>
<li id="fn2"><a href="#fnref2">↩</a></li>
</ol>
</section>
</hr></body>
</html>

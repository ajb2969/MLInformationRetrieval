<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="930">Sakai–Kasahara scheme</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Sakai–Kasahara scheme</h1>
<hr>The '''Sakai–Kasahara scheme''', also known as the Sakai-Kasahara Key Encryption algorithm ('''SAKKE'''), is an [[Identity based encryption]] system proposed by Ryuichi Sakai and Masao Kasahara in 2003.<ref>{{cite journal|last1=Sakai|first1=Ryuichi|l
<p>ast2=Kasahara|first2=Masao|title=ID Based cryptosystems with pairing on elliptic curve|journal=Cryptography ePrint Archive|year=2003|volume=2003/054|url=<a class="uri" href="https://eprint.iacr.org/2003/054.pdf">https://eprint.iacr.org/2003/054.pdf</a>}} Alongside the <a class="uri" href="Boneh-Franklin" title="wikilink">Boneh-Franklin</a> scheme, this is one of a small number of commercially implemented <a href="identity-based_encryption" title="wikilink">identity-based encryption</a> schemes. It is an application of <a href="Pairing#Pairings_in_cryptography" title="wikilink">pairings</a> over <a href="elliptic_curves" title="wikilink">elliptic curves</a> and <a href="finite_fields" title="wikilink">finite fields</a>. A security proof for the algorithm was produced in 2005 by Chen and Cheng.<a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a> SAKKE is described in <a class="uri" href="IETF" title="wikilink">IETF</a> <a href="Request_for_Comments" title="wikilink">RFC</a> 6508.<a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a></p>

<p>As an specific method for <a href="identity-based_encryption" title="wikilink">identity-based encryption</a> (IBE), the primary use case is to allow anyone to encrypt a message to a user when the sender only knows the public identity (e.g. email address) of the user. In this way, this scheme removes the requirement for users to share public certificates for the purpose of encryption.</p>
<h2 id="description-of-scheme">Description of Scheme</h2>

<p>The Sakai–Kasahara scheme allows the encryption of a message 

<math display="inline" id="Sakai–Kasahara_scheme:0">
 <semantics>
  <mi>𝕄</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>𝕄</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbb{M}
  </annotation>
 </semantics>
</math>

 to an receiver with a specific identity, 

<math display="inline" id="Sakai–Kasahara_scheme:1">
 <semantics>
  <msub>
   <mi>I</mi>
   <mi>U</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>I</ci>
    <ci>U</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \textstyle I_{U}
  </annotation>
 </semantics>
</math>

. Only the entity with the private key, 

<math display="inline" id="Sakai–Kasahara_scheme:2">
 <semantics>
  <msub>
   <mi>K</mi>
   <mi>U</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>K</ci>
    <ci>U</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \textstyle K_{U}
  </annotation>
 </semantics>
</math>

, associated to the identity, 

<math display="inline" id="Sakai–Kasahara_scheme:3">
 <semantics>
  <msub>
   <mi>I</mi>
   <mi>U</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>I</ci>
    <ci>U</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \textstyle I_{U}
  </annotation>
 </semantics>
</math>

, will be capable of decrypting the message.</p>

<p>As part of the scheme, both the sender and receiver must trust a Private Key Generator (PKG), also known as a Key Management Server (KMS). The purpose of the PKG is to create the receiver's private key, 

<math display="inline" id="Sakai–Kasahara_scheme:4">
 <semantics>
  <msub>
   <mi>K</mi>
   <mi>U</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>K</ci>
    <ci>U</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \textstyle K_{U}
  </annotation>
 </semantics>
</math>

, associated to the receiver's identity, 

<math display="inline" id="Sakai–Kasahara_scheme:5">
 <semantics>
  <msub>
   <mi>I</mi>
   <mi>U</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>I</ci>
    <ci>U</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \textstyle I_{U}
  </annotation>
 </semantics>
</math>

. The PKG must securely deliver the identity-specific private key to the receiver, and PKG-specific public parameter, 

<math display="inline" id="Sakai–Kasahara_scheme:6">
 <semantics>
  <mi>Z</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>Z</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \textstyle Z
  </annotation>
 </semantics>
</math>

, to all parties. These distribution processes are not considered as part of the definition of this cryptographic scheme.</p>
<h3 id="preliminaries">Preliminaries</h3>

<p>The scheme uses two multiplicative groups 

<math display="inline" id="Sakai–Kasahara_scheme:7">
 <semantics>
  <mi>E</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>E</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \textstyle E
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Sakai–Kasahara_scheme:8">
 <semantics>
  <mi>G</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>G</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \textstyle G
  </annotation>
 </semantics>
</math>

. It is assumed:</p>
<ul>
<li>The <a href="Diffie-Hellman_problem" title="wikilink">Diffie-Hellman problem</a> is hard in 

<math display="inline" id="Sakai–Kasahara_scheme:9">
 <semantics>
  <mi>E</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>E</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \textstyle E
  </annotation>
 </semantics>
</math>

. Meaning that given two members of the group 

<math display="inline" id="Sakai–Kasahara_scheme:10">
 <semantics>
  <mi>P</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>P</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \textstyle P
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Sakai–Kasahara_scheme:11">
 <semantics>
  <mi>Q</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>Q</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \textstyle Q
  </annotation>
 </semantics>
</math>

, it is hard to find 

<math display="inline" id="Sakai–Kasahara_scheme:12">
 <semantics>
  <mi>x</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>x</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \textstyle x
  </annotation>
 </semantics>
</math>

 such that 

<math display="inline" id="Sakai–Kasahara_scheme:13">
 <semantics>
  <mrow>
   <mrow>
    <mo stretchy="false">[</mo>
    <mi>x</mi>
    <mo stretchy="false">]</mo>
   </mrow>
   <mo>.</mo>
   <mrow>
    <mi>P</mi>
    <mo>=</mo>
    <mi>Q</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <csymbol cd="latexml">delimited-[]</csymbol>
     <ci>x</ci>
    </apply>
    <apply>
     <eq></eq>
     <ci>P</ci>
     <ci>Q</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \textstyle[x].P=Q
  </annotation>
 </semantics>
</math>

.</li>
<li>The <a href="Diffie-Hellman_problem" title="wikilink">Diffie-Hellman problem</a> is hard in 

<math display="inline" id="Sakai–Kasahara_scheme:14">
 <semantics>
  <mi>G</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>G</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \textstyle G
  </annotation>
 </semantics>
</math>

. Meaning that given two members of the group 

<math display="inline" id="Sakai–Kasahara_scheme:15">
 <semantics>
  <mi>g</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>g</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   g
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Sakai–Kasahara_scheme:16">
 <semantics>
  <mi>t</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>t</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   t
  </annotation>
 </semantics>
</math>

, it is hard to find 

<math display="inline" id="Sakai–Kasahara_scheme:17">
 <semantics>
  <mi>x</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>x</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \textstyle x
  </annotation>
 </semantics>
</math>

 such that 

<math display="inline" id="Sakai–Kasahara_scheme:18">
 <semantics>
  <mrow>
   <msup>
    <mi>g</mi>
    <mi>x</mi>
   </msup>
   <mo>=</mo>
   <mi>t</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>g</ci>
     <ci>x</ci>
    </apply>
    <ci>t</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \textstyle g^{x}=t
  </annotation>
 </semantics>
</math>

.</li>
<li>There is a bilinear map, a Tate-Lichtenbaum <a href="Pairing#Pairings_in_cryptography" title="wikilink">pairing</a>, 

<math display="inline" id="Sakai–Kasahara_scheme:19">
 <semantics>
  <mrow>
   <mi>e</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mo>,</mo>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">e</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <ci>normal-,</ci>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \textstyle e(,)
  </annotation>
 </semantics>
</math>

 from E to G. This means that for 

<math display="inline" id="Sakai–Kasahara_scheme:20">
 <semantics>
  <mi>P</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>P</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \textstyle P
  </annotation>
 </semantics>
</math>

 a member of 

<math display="inline" id="Sakai–Kasahara_scheme:21">
 <semantics>
  <mi>E</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>E</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \textstyle E
  </annotation>
 </semantics>
</math>

 and for 

<math display="inline" id="Sakai–Kasahara_scheme:22">
 <semantics>
  <mrow>
   <mi>g</mi>
   <mo>=</mo>
   <mrow>
    <mi>e</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>P</mi>
     <mo>,</mo>
     <mi>P</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>g</ci>
    <apply>
     <times></times>
     <ci>e</ci>
     <interval closure="open">
      <ci>P</ci>
      <ci>P</ci>
     </interval>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \textstyle g=e(P,P)
  </annotation>
 </semantics>
</math>

 a member of 

<math display="inline" id="Sakai–Kasahara_scheme:23">
 <semantics>
  <mi>G</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>G</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \textstyle G
  </annotation>
 </semantics>
</math>

:</li>
</ul>
<dl>
<dd><dl>
<dd>

<math display="inline" id="Sakai–Kasahara_scheme:24">
 <semantics>
  <mrow>
   <mi>e</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>P</mi>
    <mo>,</mo>
    <mrow>
     <mo stretchy="false">[</mo>
     <mi>x</mi>
     <mo stretchy="false">]</mo>
    </mrow>
    <mo>.</mo>
    <mi>P</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>=</mo>
   <mi>e</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mrow>
     <mo stretchy="false">[</mo>
     <mi>x</mi>
     <mo stretchy="false">]</mo>
    </mrow>
    <mo>.</mo>
    <mi>P</mi>
    <mo>,</mo>
    <mi>P</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>=</mo>
   <mi>e</mi>
   <msup>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>P</mi>
     <mo>,</mo>
     <mi>P</mi>
     <mo stretchy="false">)</mo>
    </mrow>
    <mi>x</mi>
   </msup>
   <mo>=</mo>
   <msup>
    <mi>g</mi>
    <mi>x</mi>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">e</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">P</csymbol>
     <ci>normal-,</ci>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <ci>normal-[</ci>
      <csymbol cd="unknown">x</csymbol>
      <ci>normal-]</ci>
     </cerror>
     <ci>normal-.</ci>
     <csymbol cd="unknown">P</csymbol>
     <ci>normal-)</ci>
    </cerror>
    <eq></eq>
    <csymbol cd="unknown">e</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <ci>normal-[</ci>
      <csymbol cd="unknown">x</csymbol>
      <ci>normal-]</ci>
     </cerror>
     <ci>normal-.</ci>
     <csymbol cd="unknown">P</csymbol>
     <ci>normal-,</ci>
     <csymbol cd="unknown">P</csymbol>
     <ci>normal-)</ci>
    </cerror>
    <eq></eq>
    <csymbol cd="unknown">e</csymbol>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <ci>normal-(</ci>
      <csymbol cd="unknown">P</csymbol>
      <ci>normal-,</ci>
      <csymbol cd="unknown">P</csymbol>
      <ci>normal-)</ci>
     </cerror>
     <ci>x</ci>
    </apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>g</ci>
     <ci>x</ci>
    </apply>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \textstyle e(P,[x].P)=e([x].P,P)=e(P,P)^{x}=g^{x}
  </annotation>
 </semantics>
</math>


</dd>
</dl>
</dd>
</dl>

<p>Frequently, 

<math display="inline" id="Sakai–Kasahara_scheme:25">
 <semantics>
  <mi>E</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>E</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \textstyle E
  </annotation>
 </semantics>
</math>

 is a supersingular <a href="elliptic_curve" title="wikilink">elliptic curve</a>, such as 

<math display="inline" id="Sakai–Kasahara_scheme:26">
 <semantics>
  <mrow>
   <mi>E</mi>
   <mo>:</mo>
   <mrow>
    <msup>
     <mi>y</mi>
     <mn>2</mn>
    </msup>
    <mo>=</mo>
    <mrow>
     <msup>
      <mi>x</mi>
      <mn>3</mn>
     </msup>
     <mo>-</mo>
     <mrow>
      <mn>3</mn>
      <mi>x</mi>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-:</ci>
    <ci>E</ci>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>y</ci>
      <cn type="integer">2</cn>
     </apply>
     <apply>
      <minus></minus>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>x</ci>
       <cn type="integer">3</cn>
      </apply>
      <apply>
       <times></times>
       <cn type="integer">3</cn>
       <ci>x</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \textstyle E:y^{2}=x^{3}-3x
  </annotation>
 </semantics>
</math>

 (over a finite field of prime order 

<math display="inline" id="Sakai–Kasahara_scheme:27">
 <semantics>
  <mi>p</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>p</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \textstyle p
  </annotation>
 </semantics>
</math>

). A generator 

<math display="inline" id="Sakai–Kasahara_scheme:28">
 <semantics>
  <mi>P</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>P</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \textstyle P
  </annotation>
 </semantics>
</math>

 of prime order 

<math display="inline" id="Sakai–Kasahara_scheme:29">
 <semantics>
  <mi>q</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>q</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \textstyle q
  </annotation>
 </semantics>
</math>

 is chosen in 

<math display="inline" id="Sakai–Kasahara_scheme:30">
 <semantics>
  <mi>E</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>E</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \textstyle E
  </annotation>
 </semantics>
</math>

. The group 

<math display="inline" id="Sakai–Kasahara_scheme:31">
 <semantics>
  <mi>G</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>G</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \textstyle G
  </annotation>
 </semantics>
</math>

 is the image due to the pairing of the group generated by 

<math display="inline" id="Sakai–Kasahara_scheme:32">
 <semantics>
  <mi>P</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>P</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \textstyle P
  </annotation>
 </semantics>
</math>

 (in the extension field of degree 2 of the finite field of order p).</p>

<p>Two <a href="hash_function" title="wikilink">hash functions</a> are also required, 

<math display="inline" id="Sakai–Kasahara_scheme:33">
 <semantics>
  <msub>
   <mi>H</mi>
   <mn>1</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>H</ci>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \textstyle H_{1}
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Sakai–Kasahara_scheme:34">
 <semantics>
  <msub>
   <mi>H</mi>
   <mn>2</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>H</ci>
    <cn type="integer">2</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \textstyle H_{2}
  </annotation>
 </semantics>
</math>

. 

<math display="inline" id="Sakai–Kasahara_scheme:35">
 <semantics>
  <msub>
   <mi>H</mi>
   <mn>1</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>H</ci>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \textstyle H_{1}
  </annotation>
 </semantics>
</math>

 outputs a positive integer, 

<math display="inline" id="Sakai–Kasahara_scheme:36">
 <semantics>
  <mi>x</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>x</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \textstyle x
  </annotation>
 </semantics>
</math>

, such that 

<math display="inline" id="Sakai–Kasahara_scheme:37">
 <semantics>
  <mi>n</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>n</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \textstyle n
  </annotation>
 </semantics>
</math>

 outputs 

<math display="inline" id="Sakai–Kasahara_scheme:38">
 <semantics>
  <mi>n</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>n</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \textstyle n
  </annotation>
 </semantics>
</math>

 bits, where 

<math display="inline" id="Sakai–Kasahara_scheme:39">
 <semantics>
  <mi>𝕄</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>𝕄</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbb{M}
  </annotation>
 </semantics>
</math>

 is the length of the message 

<math display="inline" id="Sakai–Kasahara_scheme:40">
 <semantics>
  <mi>z</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>z</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \textstyle z
  </annotation>
 </semantics>
</math>

.</p>
<h3 id="key-generation">Key Generation</h3>

<p>The PKG has a master secret 

<math display="inline" id="Sakai–Kasahara_scheme:41">
 <semantics>
  <mi>E</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>E</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \textstyle E
  </annotation>
 </semantics>
</math>

 where 

<math display="inline" id="Sakai–Kasahara_scheme:42">
 <semantics>
  <msub>
   <mi>K</mi>
   <mi>U</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>K</ci>
    <ci>U</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \textstyle K_{U}
  </annotation>
 </semantics>
</math>

 which is a point on 

<math display="inline" id="Sakai–Kasahara_scheme:43">
 <semantics>
  <mrow>
   <mi>I</mi>
   <msub>
    <mi>D</mi>
    <mi>U</mi>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>I</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>D</ci>
     <ci>U</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \textstyle ID_{U}
  </annotation>
 </semantics>
</math>

. The PKG generates the private key, 

<math display="inline" id="Sakai–Kasahara_scheme:44">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>K</mi>
     <mi>U</mi>
    </msub>
    <mo>=</mo>
    <mrow>
     <mo stretchy="false">[</mo>
     <mfrac>
      <mn>1</mn>
      <mrow>
       <mi>z</mi>
       <mo>+</mo>
       <mrow>
        <msub>
         <mi>H</mi>
         <mn>1</mn>
        </msub>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <mi>I</mi>
          <msub>
           <mi>D</mi>
           <mi>U</mi>
          </msub>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
      </mrow>
     </mfrac>
     <mo stretchy="false">]</mo>
    </mrow>
   </mrow>
   <mo>.</mo>
   <mi>P</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>K</ci>
      <ci>U</ci>
     </apply>
     <apply>
      <csymbol cd="latexml">delimited-[]</csymbol>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <apply>
        <plus></plus>
        <ci>z</ci>
        <apply>
         <times></times>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>H</ci>
          <cn type="integer">1</cn>
         </apply>
         <apply>
          <times></times>
          <ci>I</ci>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>D</ci>
           <ci>U</ci>
          </apply>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
    <ci>P</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \textstyle K_{U}=[\frac{1}{z+H_{1}(ID_{U})}].P
  </annotation>
 </semantics>
</math>

, for the user with identity 

<math display="inline" id="Sakai–Kasahara_scheme:45">
 <semantics>
  <mi>𝕄</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>𝕄</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbb{M}
  </annotation>
 </semantics>
</math>

 as follows:</p>
<dl>
<dd><dl>
<dd>

<math display="inline" id="Sakai–Kasahara_scheme:46">
 <semantics>
  <mrow>
   <mi>I</mi>
   <msub>
    <mi>D</mi>
    <mi>U</mi>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>I</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>D</ci>
     <ci>U</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \textstyle ID_{U}
  </annotation>
 </semantics>
</math>


</dd>
</dl>
</dd>
</dl>
<h3 id="encryption">Encryption</h3>

<p>To encrypt a non-repeating message 

<math display="inline" id="Sakai–Kasahara_scheme:47">
 <semantics>
  <mi>Z</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>Z</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \textstyle Z
  </annotation>
 </semantics>
</math>

, the sender requires receiver's identity, 

<math display="block" id="Sakai–Kasahara_scheme:48">
 <semantics>
  <mrow>
   <mrow>
    <mi>i</mi>
    <mi>d</mi>
   </mrow>
   <mo>=</mo>
   <mrow>
    <msub>
     <mi>H</mi>
     <mn>1</mn>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>I</mi>
      <msub>
       <mi>D</mi>
       <mi>U</mi>
      </msub>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>i</ci>
     <ci>d</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>H</ci>
      <cn type="integer">1</cn>
     </apply>
     <apply>
      <times></times>
      <ci>I</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>D</ci>
       <ci>U</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \textstyle id=H_{1}(ID_{U})
  </annotation>
 </semantics>
</math>

 and the public PGK value 

<math display="inline" id="Sakai–Kasahara_scheme:49">
 <semantics>
  <mi>r</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>r</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \textstyle r
  </annotation>
 </semantics>
</math>

. The sender performs the following operation.</p>
<ol>
<li>Create

<math display="inline" id="Sakai–Kasahara_scheme:50">
 <semantics>
  <mrow>
   <mi>r</mi>
   <mo>=</mo>
   <msub>
    <mi>H</mi>
    <mn>1</mn>
   </msub>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>𝕄</mi>
    <mo stretchy="false">|</mo>
    <mo stretchy="false">|</mo>
    <mi>i</mi>
    <mi>d</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">r</csymbol>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>H</ci>
     <cn type="integer">1</cn>
    </apply>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">M</csymbol>
     <ci>normal-|</ci>
     <ci>normal-|</ci>
     <csymbol cd="unknown">i</csymbol>
     <csymbol cd="unknown">d</csymbol>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \textstyle r=H_{1}(\mathbb{M}||id)
  </annotation>
 </semantics>
</math>

</li>
<li>The sender generates 

<math display="inline" id="Sakai–Kasahara_scheme:51">
 <semantics>
  <mi>R</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>R</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \textstyle R
  </annotation>
 </semantics>
</math>

 using 

<math display="inline" id="Sakai–Kasahara_scheme:52">
 <semantics>
  <mi>E</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>E</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \textstyle E
  </annotation>
 </semantics>
</math>

</li>
<li>Generate the point 

<math display="inline" id="Sakai–Kasahara_scheme:53">
 <semantics>
  <mrow>
   <mi>R</mi>
   <mo>=</mo>
   <mrow>
    <mo stretchy="false">[</mo>
    <mi>r</mi>
    <mo stretchy="false">]</mo>
   </mrow>
   <mo>.</mo>
   <mrow>
    <mo stretchy="false">(</mo>
    <mrow>
     <mo stretchy="false">[</mo>
     <mi>i</mi>
     <mi>d</mi>
     <mo stretchy="false">]</mo>
    </mrow>
    <mo>.</mo>
    <mi>P</mi>
    <mo>+</mo>
    <mi>Z</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">R</csymbol>
    <eq></eq>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-[</ci>
     <csymbol cd="unknown">r</csymbol>
     <ci>normal-]</ci>
    </cerror>
    <ci>normal-.</ci>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <ci>normal-[</ci>
      <csymbol cd="unknown">i</csymbol>
      <csymbol cd="unknown">d</csymbol>
      <ci>normal-]</ci>
     </cerror>
     <ci>normal-.</ci>
     <csymbol cd="unknown">P</csymbol>
     <plus></plus>
     <csymbol cd="unknown">Z</csymbol>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \textstyle R=[r].([id].P+Z)
  </annotation>
 </semantics>
</math>

 in 

<math display="inline" id="Sakai–Kasahara_scheme:54">
 <semantics>
  <mrow>
   <mi>S</mi>
   <mo>=</mo>
   <mrow>
    <mi>𝕄</mi>
    <mo>⊕</mo>
    <mrow>
     <msub>
      <mi>H</mi>
      <mn>2</mn>
     </msub>
     <mrow>
      <mo stretchy="false">(</mo>
      <msup>
       <mi>g</mi>
       <mi>r</mi>
      </msup>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>S</ci>
    <apply>
     <csymbol cd="latexml">direct-sum</csymbol>
     <ci>𝕄</ci>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>H</ci>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>g</ci>
       <ci>r</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \textstyle S=\mathbb{M}\oplus H_{2}(g^{r})
  </annotation>
 </semantics>
</math>

:
<dl>
<dd><dl>
<dd>

<math display="block" id="Sakai–Kasahara_scheme:55">
 <semantics>
  <mrow>
   <mo stretchy="false">(</mo>
   <mi>R</mi>
   <mo>,</mo>
   <mi>S</mi>
   <mo stretchy="false">)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <interval closure="open">
    <ci>R</ci>
    <ci>S</ci>
   </interval>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \textstyle(R,S)
  </annotation>
 </semantics>
</math>


</dd>
</dl>
</dd>
</dl></li>
<li>Create the masked message:
<dl>
<dd><dl>
<dd>

<math display="inline" id="Sakai–Kasahara_scheme:56">
 <semantics>
  <mrow>
   <mi>I</mi>
   <msub>
    <mi>D</mi>
    <mi>U</mi>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>I</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>D</ci>
     <ci>U</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \textstyle ID_{U}
  </annotation>
 </semantics>
</math>


</dd>
</dl>
</dd>
</dl></li>
<li>The encrypted output is

<math display="inline" id="Sakai–Kasahara_scheme:57">
 <semantics>
  <msub>
   <mi>K</mi>
   <mi>U</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>K</ci>
    <ci>U</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \textstyle K_{U}
  </annotation>
 </semantics>
</math>

</li>
</ol>

<p>Note that messages may not repeat, as a repeated message to the same identity results in a repeated ciphertext. There is an extension to the protocol should messages potentially repeat.</p>
<h3 id="decryption">Decryption</h3>

<p>To decrypt a message encrypted to 

<math display="inline" id="Sakai–Kasahara_scheme:58">
 <semantics>
  <mi>Z</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>Z</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \textstyle Z
  </annotation>
 </semantics>
</math>

, the receiver requires the private key, 

<math display="inline" id="Sakai–Kasahara_scheme:59">
 <semantics>
  <mrow>
   <mrow>
    <mi>i</mi>
    <mi>d</mi>
   </mrow>
   <mo>=</mo>
   <mrow>
    <msub>
     <mi>H</mi>
     <mn>1</mn>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>I</mi>
      <msub>
       <mi>D</mi>
       <mi>U</mi>
      </msub>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>i</ci>
     <ci>d</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>H</ci>
      <cn type="integer">1</cn>
     </apply>
     <apply>
      <times></times>
      <ci>I</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>D</ci>
       <ci>U</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \textstyle id=H_{1}(ID_{U})
  </annotation>
 </semantics>
</math>

 from the PKG and the public value 

<math display="block" id="Sakai–Kasahara_scheme:60">
 <semantics>
  <mrow>
   <mo stretchy="false">(</mo>
   <mi>R</mi>
   <mo>,</mo>
   <mi>S</mi>
   <mo stretchy="false">)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <interval closure="open">
    <ci>R</ci>
    <ci>S</ci>
   </interval>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \textstyle(R,S)
  </annotation>
 </semantics>
</math>

. The decryption procedure is as follows:</p>
<ol>
<li>Compute 

<math display="inline" id="Sakai–Kasahara_scheme:61">
 <semantics>
  <mrow>
   <mi>w</mi>
   <mo>=</mo>
   <mrow>
    <mi>e</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>R</mi>
     <mo>,</mo>
     <msub>
      <mi>K</mi>
      <mi>U</mi>
     </msub>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>w</ci>
    <apply>
     <times></times>
     <ci>e</ci>
     <interval closure="open">
      <ci>R</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>K</ci>
       <ci>U</ci>
      </apply>
     </interval>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \textstyle w=e(R,K_{U})
  </annotation>
 </semantics>
</math>

</li>
<li>Receive the encrypted message

<math display="inline" id="Sakai–Kasahara_scheme:62">
 <semantics>
  <mrow>
   <mi>𝕄</mi>
   <mo>=</mo>
   <mrow>
    <mi>S</mi>
    <mo>⊕</mo>
    <mrow>
     <msub>
      <mi>H</mi>
      <mn>2</mn>
     </msub>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>w</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>𝕄</ci>
    <apply>
     <csymbol cd="latexml">direct-sum</csymbol>
     <ci>S</ci>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>H</ci>
       <cn type="integer">2</cn>
      </apply>
      <ci>w</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \textstyle\mathbb{M}=S\oplus H_{2}(w)
  </annotation>
 </semantics>
</math>

.</li>
<li>Compute:
<dl>
<dd><dl>
<dd>

<math display="inline" id="Sakai–Kasahara_scheme:63">
 <semantics>
  <mrow>
   <mi>r</mi>
   <mo>=</mo>
   <msub>
    <mi>H</mi>
    <mn>1</mn>
   </msub>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>𝕄</mi>
    <mo stretchy="false">|</mo>
    <mo stretchy="false">|</mo>
    <mi>i</mi>
    <mi>d</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">r</csymbol>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>H</ci>
     <cn type="integer">1</cn>
    </apply>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">M</csymbol>
     <ci>normal-|</ci>
     <ci>normal-|</ci>
     <csymbol cd="unknown">i</csymbol>
     <csymbol cd="unknown">d</csymbol>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \textstyle r=H_{1}(\mathbb{M}||id)
  </annotation>
 </semantics>
</math>


</dd>
</dl>
</dd>
</dl></li>
<li>Extract the message:
<dl>
<dd><dl>
<dd>

<math display="inline" id="Sakai–Kasahara_scheme:64">
 <semantics>
  <mrow>
   <mrow>
    <mo stretchy="false">[</mo>
    <mi>r</mi>
    <mo stretchy="false">]</mo>
   </mrow>
   <mo>.</mo>
   <mrow>
    <mo stretchy="false">(</mo>
    <mrow>
     <mo stretchy="false">[</mo>
     <mi>i</mi>
     <mi>d</mi>
     <mo stretchy="false">]</mo>
    </mrow>
    <mo>.</mo>
    <mi>P</mi>
    <mo>+</mo>
    <mi>Z</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>≡</mo>
   <mi>R</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-[</ci>
     <csymbol cd="unknown">r</csymbol>
     <ci>normal-]</ci>
    </cerror>
    <ci>normal-.</ci>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <ci>normal-[</ci>
      <csymbol cd="unknown">i</csymbol>
      <csymbol cd="unknown">d</csymbol>
      <ci>normal-]</ci>
     </cerror>
     <ci>normal-.</ci>
     <csymbol cd="unknown">P</csymbol>
     <plus></plus>
     <csymbol cd="unknown">Z</csymbol>
     <ci>normal-)</ci>
    </cerror>
    <equivalent></equivalent>
    <csymbol cd="unknown">R</csymbol>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \textstyle[r].([id].P+Z)\equiv R
  </annotation>
 </semantics>
</math>


</dd>
</dl>
</dd>
</dl></li>
<li>To verify the message, compute 

<math display="block" id="Sakai–Kasahara_scheme:65">
 <semantics>
  <mrow>
   <mi>w</mi>
   <mo>=</mo>
   <mi>e</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>R</mi>
    <mo>,</mo>
    <msub>
     <mi>K</mi>
     <mi>U</mi>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>=</mo>
   <mi>e</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mrow>
     <mo stretchy="false">[</mo>
     <mi>r</mi>
     <mo stretchy="false">]</mo>
    </mrow>
    <mo>.</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mo stretchy="false">[</mo>
      <mi>i</mi>
      <mi>d</mi>
      <mo stretchy="false">]</mo>
     </mrow>
     <mo>.</mo>
     <mi>P</mi>
     <mo>+</mo>
     <mi>Z</mi>
     <mo stretchy="false">)</mo>
    </mrow>
    <mo>,</mo>
    <msub>
     <mi>K</mi>
     <mi>U</mi>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>=</mo>
   <mi>e</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mrow>
     <mo stretchy="false">[</mo>
     <mi>r</mi>
     <mo stretchy="false">]</mo>
    </mrow>
    <mo>.</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mo stretchy="false">[</mo>
      <mi>i</mi>
      <mi>d</mi>
      <mo stretchy="false">]</mo>
     </mrow>
     <mo>.</mo>
     <mi>P</mi>
     <mo>+</mo>
     <mrow>
      <mo stretchy="false">[</mo>
      <mi>z</mi>
      <mo stretchy="false">]</mo>
     </mrow>
     <mo>.</mo>
     <mi>P</mi>
     <mo stretchy="false">)</mo>
    </mrow>
    <mo>,</mo>
    <msub>
     <mi>K</mi>
     <mi>U</mi>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>=</mo>
   <mi>e</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mrow>
     <mo stretchy="false">[</mo>
     <mi>r</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>i</mi>
      <mi>d</mi>
      <mo>+</mo>
      <mi>z</mi>
      <mo stretchy="false">)</mo>
     </mrow>
     <mo stretchy="false">]</mo>
    </mrow>
    <mo>.</mo>
    <mi>P</mi>
    <mo>,</mo>
    <msub>
     <mi>K</mi>
     <mi>U</mi>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">w</csymbol>
    <eq></eq>
    <csymbol cd="unknown">e</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">R</csymbol>
     <ci>normal-,</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>K</ci>
      <ci>U</ci>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <eq></eq>
    <csymbol cd="unknown">e</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <ci>normal-[</ci>
      <csymbol cd="unknown">r</csymbol>
      <ci>normal-]</ci>
     </cerror>
     <ci>normal-.</ci>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <ci>normal-(</ci>
      <cerror>
       <csymbol cd="ambiguous">fragments</csymbol>
       <ci>normal-[</ci>
       <csymbol cd="unknown">i</csymbol>
       <csymbol cd="unknown">d</csymbol>
       <ci>normal-]</ci>
      </cerror>
      <ci>normal-.</ci>
      <csymbol cd="unknown">P</csymbol>
      <plus></plus>
      <csymbol cd="unknown">Z</csymbol>
      <ci>normal-)</ci>
     </cerror>
     <ci>normal-,</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>K</ci>
      <ci>U</ci>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <eq></eq>
    <csymbol cd="unknown">e</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <ci>normal-[</ci>
      <csymbol cd="unknown">r</csymbol>
      <ci>normal-]</ci>
     </cerror>
     <ci>normal-.</ci>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <ci>normal-(</ci>
      <cerror>
       <csymbol cd="ambiguous">fragments</csymbol>
       <ci>normal-[</ci>
       <csymbol cd="unknown">i</csymbol>
       <csymbol cd="unknown">d</csymbol>
       <ci>normal-]</ci>
      </cerror>
      <ci>normal-.</ci>
      <csymbol cd="unknown">P</csymbol>
      <plus></plus>
      <cerror>
       <csymbol cd="ambiguous">fragments</csymbol>
       <ci>normal-[</ci>
       <csymbol cd="unknown">z</csymbol>
       <ci>normal-]</ci>
      </cerror>
      <ci>normal-.</ci>
      <csymbol cd="unknown">P</csymbol>
      <ci>normal-)</ci>
     </cerror>
     <ci>normal-,</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>K</ci>
      <ci>U</ci>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <eq></eq>
    <csymbol cd="unknown">e</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <ci>normal-[</ci>
      <csymbol cd="unknown">r</csymbol>
      <cerror>
       <csymbol cd="ambiguous">fragments</csymbol>
       <ci>normal-(</ci>
       <csymbol cd="unknown">i</csymbol>
       <csymbol cd="unknown">d</csymbol>
       <plus></plus>
       <csymbol cd="unknown">z</csymbol>
       <ci>normal-)</ci>
      </cerror>
      <ci>normal-]</ci>
     </cerror>
     <ci>normal-.</ci>
     <csymbol cd="unknown">P</csymbol>
     <ci>normal-,</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>K</ci>
      <ci>U</ci>
     </apply>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \textstyle w=e(R,K_{U})=e([r].([id].P+Z),K_{U})=e([r].([id].P+[z].P),K_{U})=e(%
[r(id+z)].P,K_{U})
  </annotation>
 </semantics>
</math>

, and only accept the message if:
<dl>
<dd><dl>
<dd>

<math display="block" id="Sakai–Kasahara_scheme:66">
 <semantics>
  <mrow>
   <mi>w</mi>
   <mo>=</mo>
   <mi>e</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mrow>
     <mo stretchy="false">[</mo>
     <mi>r</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>i</mi>
      <mi>d</mi>
      <mo>+</mo>
      <mi>z</mi>
      <mo stretchy="false">)</mo>
     </mrow>
     <mo stretchy="false">]</mo>
    </mrow>
    <mo>.</mo>
    <mi>P</mi>
    <mo>,</mo>
    <msub>
     <mi>K</mi>
     <mi>U</mi>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>=</mo>
   <mi>e</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mrow>
     <mo stretchy="false">[</mo>
     <mi>r</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>i</mi>
      <mi>d</mi>
      <mo>+</mo>
      <mi>z</mi>
      <mo stretchy="false">)</mo>
     </mrow>
     <mo stretchy="false">]</mo>
    </mrow>
    <mo>.</mo>
    <mi>P</mi>
    <mo>,</mo>
    <mrow>
     <mo stretchy="false">[</mo>
     <mstyle displaystyle="false">
      <mfrac>
       <mn>1</mn>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mrow>
          <mi>i</mi>
          <mi>d</mi>
         </mrow>
         <mo>+</mo>
         <mi>z</mi>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
      </mfrac>
     </mstyle>
     <mo stretchy="false">]</mo>
    </mrow>
    <mo>.</mo>
    <mi>P</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>=</mo>
   <mi>e</mi>
   <msup>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>P</mi>
     <mo>,</mo>
     <mi>P</mi>
     <mo stretchy="false">)</mo>
    </mrow>
    <mfrac>
     <mrow>
      <mi>r</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mrow>
         <mi>i</mi>
         <mi>d</mi>
        </mrow>
        <mo>+</mo>
        <mi>z</mi>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mrow>
        <mi>i</mi>
        <mi>d</mi>
       </mrow>
       <mo>+</mo>
       <mi>z</mi>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mfrac>
   </msup>
   <mo>=</mo>
   <msup>
    <mi>g</mi>
    <mi>r</mi>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">w</csymbol>
    <eq></eq>
    <csymbol cd="unknown">e</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <ci>normal-[</ci>
      <csymbol cd="unknown">r</csymbol>
      <cerror>
       <csymbol cd="ambiguous">fragments</csymbol>
       <ci>normal-(</ci>
       <csymbol cd="unknown">i</csymbol>
       <csymbol cd="unknown">d</csymbol>
       <plus></plus>
       <csymbol cd="unknown">z</csymbol>
       <ci>normal-)</ci>
      </cerror>
      <ci>normal-]</ci>
     </cerror>
     <ci>normal-.</ci>
     <csymbol cd="unknown">P</csymbol>
     <ci>normal-,</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>K</ci>
      <ci>U</ci>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <eq></eq>
    <csymbol cd="unknown">e</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <ci>normal-[</ci>
      <csymbol cd="unknown">r</csymbol>
      <cerror>
       <csymbol cd="ambiguous">fragments</csymbol>
       <ci>normal-(</ci>
       <csymbol cd="unknown">i</csymbol>
       <csymbol cd="unknown">d</csymbol>
       <plus></plus>
       <csymbol cd="unknown">z</csymbol>
       <ci>normal-)</ci>
      </cerror>
      <ci>normal-]</ci>
     </cerror>
     <ci>normal-.</ci>
     <csymbol cd="unknown">P</csymbol>
     <ci>normal-,</ci>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <ci>normal-[</ci>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <apply>
        <plus></plus>
        <apply>
         <times></times>
         <ci>i</ci>
         <ci>d</ci>
        </apply>
        <ci>z</ci>
       </apply>
      </apply>
      <ci>normal-]</ci>
     </cerror>
     <ci>normal-.</ci>
     <csymbol cd="unknown">P</csymbol>
     <ci>normal-)</ci>
    </cerror>
    <eq></eq>
    <csymbol cd="unknown">e</csymbol>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <ci>normal-(</ci>
      <csymbol cd="unknown">P</csymbol>
      <ci>normal-,</ci>
      <csymbol cd="unknown">P</csymbol>
      <ci>normal-)</ci>
     </cerror>
     <apply>
      <divide></divide>
      <apply>
       <times></times>
       <ci>r</ci>
       <apply>
        <plus></plus>
        <apply>
         <times></times>
         <ci>i</ci>
         <ci>d</ci>
        </apply>
        <ci>z</ci>
       </apply>
      </apply>
      <apply>
       <plus></plus>
       <apply>
        <times></times>
        <ci>i</ci>
        <ci>d</ci>
       </apply>
       <ci>z</ci>
      </apply>
     </apply>
    </apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>g</ci>
     <ci>r</ci>
    </apply>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \textstyle w=e([r(id+z)].P,K_{U})=e([r(id+z)].P,[\frac{1}{(id+z)}].P)=e(P,P)^{%
\frac{r(id+z)}{(id+z)}}=g^{r}
  </annotation>
 </semantics>
</math>


</dd>
</dl>
</dd>
</dl></li>
</ol>
<h3 id="demonstration-of-algorithmic-correctness">Demonstration of Algorithmic Correctness</h3>

<p>The following equations demonstrate the correctness of the algorithm:</p>

<p>

<math display="block" id="Sakai–Kasahara_scheme:67">
 <semantics>
  <mrow>
   <mrow>
    <mi>S</mi>
    <mo>⊕</mo>
    <mrow>
     <msub>
      <mi>H</mi>
      <mn>2</mn>
     </msub>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>w</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>𝕄</mi>
      <mo>⊕</mo>
      <mrow>
       <msub>
        <mi>H</mi>
        <mn>2</mn>
       </msub>
       <mrow>
        <mo stretchy="false">(</mo>
        <msup>
         <mi>g</mi>
         <mi>r</mi>
        </msup>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
    <mo>⊕</mo>
    <mrow>
     <msub>
      <mi>H</mi>
      <mn>2</mn>
     </msub>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>w</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mi>𝕄</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="latexml">direct-sum</csymbol>
      <ci>S</ci>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>H</ci>
        <cn type="integer">2</cn>
       </apply>
       <ci>w</ci>
      </apply>
     </apply>
     <apply>
      <csymbol cd="latexml">direct-sum</csymbol>
      <apply>
       <csymbol cd="latexml">direct-sum</csymbol>
       <ci>𝕄</ci>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>H</ci>
         <cn type="integer">2</cn>
        </apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>g</ci>
         <ci>r</ci>
        </apply>
       </apply>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>H</ci>
        <cn type="integer">2</cn>
       </apply>
       <ci>w</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <ci>𝕄</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \textstyle S\oplus H_{2}(w)=(\mathbb{M}\oplus H_{2}(g^{r}))\oplus H_{2}(w)=%
\mathbb{M}
  </annotation>
 </semantics>
</math>

 By the bilinear property of the map:</p>

<p><span class="LaTeX">$$\textstyle w = e([r(id+z)].P,K_U)= e([r(id+z)].P,[\frac{1}{(id+z)}].P) = e(P,P)^{\frac{r(id+z)}{(id+z)}} = g^r$$</span> As a result:</p>

<p><span class="LaTeX">$$\textstyle  S \oplus H_2(w) = (\mathbb{M} \oplus H_2(g^r)) \oplus H_2(w) = \mathbb{M}$$</span></p>
<h2 id="standardisation">Standardisation</h2>

<p>There are two standards relating to this protocol:</p>
<ul>
<li>Initial standardisation of scheme was begun by IEEE in 2006.<a class="footnoteRef" href="#fn3" id="fnref3"><sup>3</sup></a></li>
<li>The scheme was standardised by the IETF in 2012 within RFC 6508. The scheme is used as part of the MIKEY-SAKKE protocol, defined in RFC 6509.</li>
</ul>
<h2 id="cryptographic-libraries-and-implementations">Cryptographic Libraries and Implementations</h2>

<p>The scheme is part of the MIRACL cryptographic library.</p>
<h2 id="see-also">See also</h2>
<ul>
<li><a href="ID-based_encryption" title="wikilink">ID-based encryption</a></li>
</ul>
<h2 id="references">References</h2>

<p>"</p>

<p><a href="Category:Public-key_encryption_schemes" title="wikilink">Category:Public-key encryption schemes</a> <a href="Category:Pairing-based_cryptography" title="wikilink">Category:Pairing-based cryptography</a> <a href="Category:Identity-based_cryptography" title="wikilink">Category:Identity-based cryptography</a> <a href="Category:Elliptic_curve_cryptography" title="wikilink">Category:Elliptic curve cryptography</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1"><a href="#fnref1">↩</a></li>
<li id="fn2"><a href="#fnref2">↩</a></li>
<li id="fn3"><a href="#fnref3">↩</a></li>
</ol>
</section>
</ref></hr></body>
</html>

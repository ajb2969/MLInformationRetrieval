<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="837">Covariance matrix</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Covariance matrix</h1>
<hr/>
<figure><b>(Figure)</b>
<figcaption>A <a href="multivariate_Gaussian_distribution" title="wikilink">bivariate Gaussian probability density function</a> centered at (0, 0), with covariance matrix [ 1.00, 0.50 ; 0.50, 1.00 ]. </figcaption>
</figure>
<figure><b>(Figure)</b>
<figcaption>Sample points from a <a href="multivariate_Gaussian_distribution" title="wikilink">multivariate Gaussian distribution</a> with a standard deviation of 3 in roughly the lower left-upper right direction and of 1 in the orthogonal direction. Because the <em>x</em> and <em>y</em> components co-vary, the variances of <em>x</em> and <em>y</em> do not fully describe the distribution. A 2√ó2 covariance matrix is needed; the directions of the arrows correspond to the eigenvectors of this covariance matrix and their lengths to the square roots of the <a class="uri" href="eigenvalues" title="wikilink">eigenvalues</a>.</figcaption>
</figure>

<p>In <a href="probability_theory" title="wikilink">probability theory</a> and <a class="uri" href="statistics" title="wikilink">statistics</a>, a <strong>covariance matrix</strong> (also known as <strong>dispersion matrix</strong> or <strong>variance‚Äìcovariance matrix</strong>) is a <a href="Matrix_(mathematics)" title="wikilink">matrix</a> whose element in the <em>i</em>, <em>j</em> position is the <a class="uri" href="covariance" title="wikilink">covariance</a> between the <em>i</em>¬†<sup>th</sup> and <em>j</em>¬†<sup>th</sup> elements of a <a href="random_vector" title="wikilink">random vector</a> (that is, of a <a href="Euclidean_vector" title="wikilink">vector</a> of <a href="random_variable" title="wikilink">random variables</a>). Each element of the vector is a <a href="Scalar_(mathematics)" title="wikilink">scalar</a> random variable, either with a finite number of observed empirical values or with a finite or infinite number of potential values specified by a theoretical <a href="joint_probability_distribution" title="wikilink">joint probability distribution</a> of all the random variables.</p>

<p>Intuitively, the covariance matrix generalizes the notion of <a class="uri" href="variance" title="wikilink">variance</a> to multiple dimensions. As an example, the variation in a collection of random points in two-dimensional space cannot be characterized fully by a single number, nor would the variances in the <em>x</em> and <em>y</em> directions contain all of the necessary information; a 2√ó2 matrix would be necessary to fully characterize the two-dimensional variation.</p>

<p>Because the covariance of the <em>i</em> <sup>th</sup> random variable with itself is simply that random variable's variance, each element on the <a href="principal_diagonal" title="wikilink">principal diagonal</a> of the covariance matrix is the variance of one of the random variables. Because the covariance of the <em>i</em> <sup>th</sup> random variable with the <em>j</em> <sup>th</sup> one is the same thing as the covariance of the <em>j</em> <sup>th</sup> random variable with the <em>i</em> <sup>th</sup> one, every covariance matrix is <a href="symmetric_matrix" title="wikilink">symmetric</a>. In addition, every covariance matrix is <a href="positive_semi-definite_matrix" title="wikilink">positive semi-definite</a>.</p>
<h2 id="definition">Definition</h2>

<p>Throughout this article, boldfaced unsubscripted <strong>X</strong> and <strong>Y</strong> are used to refer to random vectors, and unboldfaced subscripted X<sub>i</sub> and Y<sub>i</sub> are used to refer to random scalars.</p>

<p>If the entries in the <a href="column_vector" title="wikilink">column vector</a></p>

<p>

<math display="block" id="Covariance_matrix:0">
 <semantics>
  <mrow>
   <mi>ùêó</mi>
   <mo>=</mo>
   <mrow>
    <mo>[</mo>
    <mtable displaystyle="true">
     <mtr>
      <mtd columnalign="center">
       <msub>
        <mi>X</mi>
        <mn>1</mn>
       </msub>
      </mtd>
     </mtr>
     <mtr>
      <mtd columnalign="center">
       <mi mathvariant="normal">‚ãÆ</mi>
      </mtd>
     </mtr>
     <mtr>
      <mtd columnalign="center">
       <msub>
        <mi>X</mi>
        <mi>n</mi>
       </msub>
      </mtd>
     </mtr>
    </mtable>
    <mo>]</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>ùêó</ci>
    <matrix>
     <matrixrow>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>X</ci>
       <cn type="integer">1</cn>
      </apply>
     </matrixrow>
     <matrixrow>
      <ci>normal-‚ãÆ</ci>
     </matrixrow>
     <matrixrow>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>X</ci>
       <ci>n</ci>
      </apply>
     </matrixrow>
    </matrix>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{X}=\begin{bmatrix}X_{1}\\
\vdots\\
X_{n}\end{bmatrix}
  </annotation>
 </semantics>
</math>

</p>

<p>are <a href="random_variable" title="wikilink">random variables</a>, each with finite <a class="uri" href="variance" title="wikilink">variance</a>, then the covariance matrix Œ£ is the matrix whose (<em>i</em>,¬†<em>j</em>) entry is the <a class="uri" href="covariance" title="wikilink">covariance</a></p>

<p>

<math display="block" id="Covariance_matrix:1">
 <semantics>
  <mrow>
   <msub>
    <mi mathvariant="normal">Œ£</mi>
    <mrow>
     <mi>i</mi>
     <mi>j</mi>
    </mrow>
   </msub>
   <mo>=</mo>
   <mrow>
    <mi>cov</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <msub>
      <mi>X</mi>
      <mi>i</mi>
     </msub>
     <mo>,</mo>
     <msub>
      <mi>X</mi>
      <mi>j</mi>
     </msub>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mi mathvariant="normal">E</mi>
    <mrow>
     <mo>[</mo>
     <mtable displaystyle="true">
      <mtr>
       <mtd columnalign="center">
        <mrow>
         <mrow>
          <mo stretchy="false">(</mo>
          <mrow>
           <msub>
            <mi>X</mi>
            <mi>i</mi>
           </msub>
           <mo>-</mo>
           <msub>
            <mi>Œº</mi>
            <mi>i</mi>
           </msub>
          </mrow>
          <mo stretchy="false">)</mo>
         </mrow>
         <mrow>
          <mo stretchy="false">(</mo>
          <mrow>
           <msub>
            <mi>X</mi>
            <mi>j</mi>
           </msub>
           <mo>-</mo>
           <msub>
            <mi>Œº</mi>
            <mi>j</mi>
           </msub>
          </mrow>
          <mo stretchy="false">)</mo>
         </mrow>
        </mrow>
       </mtd>
      </mtr>
     </mtable>
     <mo>]</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>normal-Œ£</ci>
      <apply>
       <times></times>
       <ci>i</ci>
       <ci>j</ci>
      </apply>
     </apply>
     <apply>
      <times></times>
      <ci>cov</ci>
      <interval closure="open">
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>X</ci>
        <ci>i</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>X</ci>
        <ci>j</ci>
       </apply>
      </interval>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <ci>normal-E</ci>
      <matrix>
       <matrixrow>
        <apply>
         <times></times>
         <apply>
          <minus></minus>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>X</ci>
           <ci>i</ci>
          </apply>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>Œº</ci>
           <ci>i</ci>
          </apply>
         </apply>
         <apply>
          <minus></minus>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>X</ci>
           <ci>j</ci>
          </apply>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>Œº</ci>
           <ci>j</ci>
          </apply>
         </apply>
        </apply>
       </matrixrow>
      </matrix>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Sigma_{ij}=\mathrm{cov}(X_{i},X_{j})=\mathrm{E}\begin{bmatrix}(X_{i}-\mu_{i})%
(X_{j}-\mu_{j})\end{bmatrix}
  </annotation>
 </semantics>
</math>

</p>

<p>where</p>

<p>

<math display="block" id="Covariance_matrix:2">
 <semantics>
  <mrow>
   <msub>
    <mi>Œº</mi>
    <mi>i</mi>
   </msub>
   <mo>=</mo>
   <mrow>
    <mi mathvariant="normal">E</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <msub>
      <mi>X</mi>
      <mi>i</mi>
     </msub>
     <mo rspace="4.2pt" stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>Œº</ci>
     <ci>i</ci>
    </apply>
    <apply>
     <times></times>
     <ci>normal-E</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>X</ci>
      <ci>i</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mu_{i}=\mathrm{E}(X_{i})\,
  </annotation>
 </semantics>
</math>

</p>

<p>is the <a href="expected_value" title="wikilink">expected value</a> of the <em>i</em>th entry in the vector <strong>X</strong>. In other words,</p>

<p>

<math display="block" id="Covariance_matrix:3">
 <semantics>
  <mrow>
   <mrow>
    <mi mathvariant="normal">Œ£</mi>
    <mo>=</mo>
    <mrow>
     <mo>[</mo>
     <mtable displaystyle="true">
      <mtr>
       <mtd columnalign="center">
        <mrow>
         <mi mathvariant="normal">E</mi>
         <mrow>
          <mo stretchy="false">[</mo>
          <mrow>
           <mrow>
            <mo stretchy="false">(</mo>
            <mrow>
             <msub>
              <mi>X</mi>
              <mn>1</mn>
             </msub>
             <mo>-</mo>
             <msub>
              <mi>Œº</mi>
              <mn>1</mn>
             </msub>
            </mrow>
            <mo stretchy="false">)</mo>
           </mrow>
           <mrow>
            <mo stretchy="false">(</mo>
            <mrow>
             <msub>
              <mi>X</mi>
              <mn>1</mn>
             </msub>
             <mo>-</mo>
             <msub>
              <mi>Œº</mi>
              <mn>1</mn>
             </msub>
            </mrow>
            <mo stretchy="false">)</mo>
           </mrow>
          </mrow>
          <mo stretchy="false">]</mo>
         </mrow>
        </mrow>
       </mtd>
       <mtd columnalign="center">
        <mrow>
         <mi mathvariant="normal">E</mi>
         <mrow>
          <mo stretchy="false">[</mo>
          <mrow>
           <mrow>
            <mo stretchy="false">(</mo>
            <mrow>
             <msub>
              <mi>X</mi>
              <mn>1</mn>
             </msub>
             <mo>-</mo>
             <msub>
              <mi>Œº</mi>
              <mn>1</mn>
             </msub>
            </mrow>
            <mo stretchy="false">)</mo>
           </mrow>
           <mrow>
            <mo stretchy="false">(</mo>
            <mrow>
             <msub>
              <mi>X</mi>
              <mn>2</mn>
             </msub>
             <mo>-</mo>
             <msub>
              <mi>Œº</mi>
              <mn>2</mn>
             </msub>
            </mrow>
            <mo stretchy="false">)</mo>
           </mrow>
          </mrow>
          <mo stretchy="false">]</mo>
         </mrow>
        </mrow>
       </mtd>
       <mtd columnalign="center">
        <mi mathvariant="normal">‚ãØ</mi>
       </mtd>
       <mtd columnalign="center">
        <mrow>
         <mi mathvariant="normal">E</mi>
         <mrow>
          <mo stretchy="false">[</mo>
          <mrow>
           <mrow>
            <mo stretchy="false">(</mo>
            <mrow>
             <msub>
              <mi>X</mi>
              <mn>1</mn>
             </msub>
             <mo>-</mo>
             <msub>
              <mi>Œº</mi>
              <mn>1</mn>
             </msub>
            </mrow>
            <mo stretchy="false">)</mo>
           </mrow>
           <mrow>
            <mo stretchy="false">(</mo>
            <mrow>
             <msub>
              <mi>X</mi>
              <mi>n</mi>
             </msub>
             <mo>-</mo>
             <msub>
              <mi>Œº</mi>
              <mi>n</mi>
             </msub>
            </mrow>
            <mo stretchy="false">)</mo>
           </mrow>
          </mrow>
          <mo stretchy="false">]</mo>
         </mrow>
        </mrow>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mi></mi>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mrow>
         <mi mathvariant="normal">E</mi>
         <mrow>
          <mo stretchy="false">[</mo>
          <mrow>
           <mrow>
            <mo stretchy="false">(</mo>
            <mrow>
             <msub>
              <mi>X</mi>
              <mn>2</mn>
             </msub>
             <mo>-</mo>
             <msub>
              <mi>Œº</mi>
              <mn>2</mn>
             </msub>
            </mrow>
            <mo stretchy="false">)</mo>
           </mrow>
           <mrow>
            <mo stretchy="false">(</mo>
            <mrow>
             <msub>
              <mi>X</mi>
              <mn>1</mn>
             </msub>
             <mo>-</mo>
             <msub>
              <mi>Œº</mi>
              <mn>1</mn>
             </msub>
            </mrow>
            <mo stretchy="false">)</mo>
           </mrow>
          </mrow>
          <mo stretchy="false">]</mo>
         </mrow>
        </mrow>
       </mtd>
       <mtd columnalign="center">
        <mrow>
         <mi mathvariant="normal">E</mi>
         <mrow>
          <mo stretchy="false">[</mo>
          <mrow>
           <mrow>
            <mo stretchy="false">(</mo>
            <mrow>
             <msub>
              <mi>X</mi>
              <mn>2</mn>
             </msub>
             <mo>-</mo>
             <msub>
              <mi>Œº</mi>
              <mn>2</mn>
             </msub>
            </mrow>
            <mo stretchy="false">)</mo>
           </mrow>
           <mrow>
            <mo stretchy="false">(</mo>
            <mrow>
             <msub>
              <mi>X</mi>
              <mn>2</mn>
             </msub>
             <mo>-</mo>
             <msub>
              <mi>Œº</mi>
              <mn>2</mn>
             </msub>
            </mrow>
            <mo stretchy="false">)</mo>
           </mrow>
          </mrow>
          <mo stretchy="false">]</mo>
         </mrow>
        </mrow>
       </mtd>
       <mtd columnalign="center">
        <mi mathvariant="normal">‚ãØ</mi>
       </mtd>
       <mtd columnalign="center">
        <mrow>
         <mi mathvariant="normal">E</mi>
         <mrow>
          <mo stretchy="false">[</mo>
          <mrow>
           <mrow>
            <mo stretchy="false">(</mo>
            <mrow>
             <msub>
              <mi>X</mi>
              <mn>2</mn>
             </msub>
             <mo>-</mo>
             <msub>
              <mi>Œº</mi>
              <mn>2</mn>
             </msub>
            </mrow>
            <mo stretchy="false">)</mo>
           </mrow>
           <mrow>
            <mo stretchy="false">(</mo>
            <mrow>
             <msub>
              <mi>X</mi>
              <mi>n</mi>
             </msub>
             <mo>-</mo>
             <msub>
              <mi>Œº</mi>
              <mi>n</mi>
             </msub>
            </mrow>
            <mo stretchy="false">)</mo>
           </mrow>
          </mrow>
          <mo stretchy="false">]</mo>
         </mrow>
        </mrow>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mi></mi>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mi mathvariant="normal">‚ãÆ</mi>
       </mtd>
       <mtd columnalign="center">
        <mi mathvariant="normal">‚ãÆ</mi>
       </mtd>
       <mtd columnalign="center">
        <mi mathvariant="normal">‚ã±</mi>
       </mtd>
       <mtd columnalign="center">
        <mi mathvariant="normal">‚ãÆ</mi>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mi></mi>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mrow>
         <mi mathvariant="normal">E</mi>
         <mrow>
          <mo stretchy="false">[</mo>
          <mrow>
           <mrow>
            <mo stretchy="false">(</mo>
            <mrow>
             <msub>
              <mi>X</mi>
              <mi>n</mi>
             </msub>
             <mo>-</mo>
             <msub>
              <mi>Œº</mi>
              <mi>n</mi>
             </msub>
            </mrow>
            <mo stretchy="false">)</mo>
           </mrow>
           <mrow>
            <mo stretchy="false">(</mo>
            <mrow>
             <msub>
              <mi>X</mi>
              <mn>1</mn>
             </msub>
             <mo>-</mo>
             <msub>
              <mi>Œº</mi>
              <mn>1</mn>
             </msub>
            </mrow>
            <mo stretchy="false">)</mo>
           </mrow>
          </mrow>
          <mo stretchy="false">]</mo>
         </mrow>
        </mrow>
       </mtd>
       <mtd columnalign="center">
        <mrow>
         <mi mathvariant="normal">E</mi>
         <mrow>
          <mo stretchy="false">[</mo>
          <mrow>
           <mrow>
            <mo stretchy="false">(</mo>
            <mrow>
             <msub>
              <mi>X</mi>
              <mi>n</mi>
             </msub>
             <mo>-</mo>
             <msub>
              <mi>Œº</mi>
              <mi>n</mi>
             </msub>
            </mrow>
            <mo stretchy="false">)</mo>
           </mrow>
           <mrow>
            <mo stretchy="false">(</mo>
            <mrow>
             <msub>
              <mi>X</mi>
              <mn>2</mn>
             </msub>
             <mo>-</mo>
             <msub>
              <mi>Œº</mi>
              <mn>2</mn>
             </msub>
            </mrow>
            <mo stretchy="false">)</mo>
           </mrow>
          </mrow>
          <mo stretchy="false">]</mo>
         </mrow>
        </mrow>
       </mtd>
       <mtd columnalign="center">
        <mi mathvariant="normal">‚ãØ</mi>
       </mtd>
       <mtd columnalign="center">
        <mrow>
         <mi mathvariant="normal">E</mi>
         <mrow>
          <mo stretchy="false">[</mo>
          <mrow>
           <mrow>
            <mo stretchy="false">(</mo>
            <mrow>
             <msub>
              <mi>X</mi>
              <mi>n</mi>
             </msub>
             <mo>-</mo>
             <msub>
              <mi>Œº</mi>
              <mi>n</mi>
             </msub>
            </mrow>
            <mo stretchy="false">)</mo>
           </mrow>
           <mrow>
            <mo stretchy="false">(</mo>
            <mrow>
             <msub>
              <mi>X</mi>
              <mi>n</mi>
             </msub>
             <mo>-</mo>
             <msub>
              <mi>Œº</mi>
              <mi>n</mi>
             </msub>
            </mrow>
            <mo stretchy="false">)</mo>
           </mrow>
          </mrow>
          <mo stretchy="false">]</mo>
         </mrow>
        </mrow>
       </mtd>
      </mtr>
     </mtable>
     <mo>]</mo>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>normal-Œ£</ci>
    <matrix>
     <matrixrow>
      <apply>
       <times></times>
       <ci>normal-E</ci>
       <apply>
        <csymbol cd="latexml">delimited-[]</csymbol>
        <apply>
         <times></times>
         <apply>
          <minus></minus>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>X</ci>
           <cn type="integer">1</cn>
          </apply>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>Œº</ci>
           <cn type="integer">1</cn>
          </apply>
         </apply>
         <apply>
          <minus></minus>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>X</ci>
           <cn type="integer">1</cn>
          </apply>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>Œº</ci>
           <cn type="integer">1</cn>
          </apply>
         </apply>
        </apply>
       </apply>
      </apply>
      <apply>
       <times></times>
       <ci>normal-E</ci>
       <apply>
        <csymbol cd="latexml">delimited-[]</csymbol>
        <apply>
         <times></times>
         <apply>
          <minus></minus>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>X</ci>
           <cn type="integer">1</cn>
          </apply>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>Œº</ci>
           <cn type="integer">1</cn>
          </apply>
         </apply>
         <apply>
          <minus></minus>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>X</ci>
           <cn type="integer">2</cn>
          </apply>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>Œº</ci>
           <cn type="integer">2</cn>
          </apply>
         </apply>
        </apply>
       </apply>
      </apply>
      <ci>normal-‚ãØ</ci>
      <apply>
       <times></times>
       <ci>normal-E</ci>
       <apply>
        <csymbol cd="latexml">delimited-[]</csymbol>
        <apply>
         <times></times>
         <apply>
          <minus></minus>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>X</ci>
           <cn type="integer">1</cn>
          </apply>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>Œº</ci>
           <cn type="integer">1</cn>
          </apply>
         </apply>
         <apply>
          <minus></minus>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>X</ci>
           <ci>n</ci>
          </apply>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>Œº</ci>
           <ci>n</ci>
          </apply>
         </apply>
        </apply>
       </apply>
      </apply>
     </matrixrow>
     <matrixrow>
      <csymbol cd="latexml">absent</csymbol>
     </matrixrow>
     <matrixrow>
      <apply>
       <times></times>
       <ci>normal-E</ci>
       <apply>
        <csymbol cd="latexml">delimited-[]</csymbol>
        <apply>
         <times></times>
         <apply>
          <minus></minus>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>X</ci>
           <cn type="integer">2</cn>
          </apply>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>Œº</ci>
           <cn type="integer">2</cn>
          </apply>
         </apply>
         <apply>
          <minus></minus>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>X</ci>
           <cn type="integer">1</cn>
          </apply>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>Œº</ci>
           <cn type="integer">1</cn>
          </apply>
         </apply>
        </apply>
       </apply>
      </apply>
      <apply>
       <times></times>
       <ci>normal-E</ci>
       <apply>
        <csymbol cd="latexml">delimited-[]</csymbol>
        <apply>
         <times></times>
         <apply>
          <minus></minus>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>X</ci>
           <cn type="integer">2</cn>
          </apply>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>Œº</ci>
           <cn type="integer">2</cn>
          </apply>
         </apply>
         <apply>
          <minus></minus>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>X</ci>
           <cn type="integer">2</cn>
          </apply>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>Œº</ci>
           <cn type="integer">2</cn>
          </apply>
         </apply>
        </apply>
       </apply>
      </apply>
      <ci>normal-‚ãØ</ci>
      <apply>
       <times></times>
       <ci>normal-E</ci>
       <apply>
        <csymbol cd="latexml">delimited-[]</csymbol>
        <apply>
         <times></times>
         <apply>
          <minus></minus>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>X</ci>
           <cn type="integer">2</cn>
          </apply>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>Œº</ci>
           <cn type="integer">2</cn>
          </apply>
         </apply>
         <apply>
          <minus></minus>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>X</ci>
           <ci>n</ci>
          </apply>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>Œº</ci>
           <ci>n</ci>
          </apply>
         </apply>
        </apply>
       </apply>
      </apply>
     </matrixrow>
     <matrixrow>
      <csymbol cd="latexml">absent</csymbol>
     </matrixrow>
     <matrixrow>
      <ci>normal-‚ãÆ</ci>
      <ci>normal-‚ãÆ</ci>
      <ci>normal-‚ã±</ci>
      <ci>normal-‚ãÆ</ci>
     </matrixrow>
     <matrixrow>
      <csymbol cd="latexml">absent</csymbol>
     </matrixrow>
     <matrixrow>
      <apply>
       <times></times>
       <ci>normal-E</ci>
       <apply>
        <csymbol cd="latexml">delimited-[]</csymbol>
        <apply>
         <times></times>
         <apply>
          <minus></minus>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>X</ci>
           <ci>n</ci>
          </apply>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>Œº</ci>
           <ci>n</ci>
          </apply>
         </apply>
         <apply>
          <minus></minus>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>X</ci>
           <cn type="integer">1</cn>
          </apply>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>Œº</ci>
           <cn type="integer">1</cn>
          </apply>
         </apply>
        </apply>
       </apply>
      </apply>
      <apply>
       <times></times>
       <ci>normal-E</ci>
       <apply>
        <csymbol cd="latexml">delimited-[]</csymbol>
        <apply>
         <times></times>
         <apply>
          <minus></minus>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>X</ci>
           <ci>n</ci>
          </apply>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>Œº</ci>
           <ci>n</ci>
          </apply>
         </apply>
         <apply>
          <minus></minus>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>X</ci>
           <cn type="integer">2</cn>
          </apply>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>Œº</ci>
           <cn type="integer">2</cn>
          </apply>
         </apply>
        </apply>
       </apply>
      </apply>
      <ci>normal-‚ãØ</ci>
      <apply>
       <times></times>
       <ci>normal-E</ci>
       <apply>
        <csymbol cd="latexml">delimited-[]</csymbol>
        <apply>
         <times></times>
         <apply>
          <minus></minus>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>X</ci>
           <ci>n</ci>
          </apply>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>Œº</ci>
           <ci>n</ci>
          </apply>
         </apply>
         <apply>
          <minus></minus>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>X</ci>
           <ci>n</ci>
          </apply>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>Œº</ci>
           <ci>n</ci>
          </apply>
         </apply>
        </apply>
       </apply>
      </apply>
     </matrixrow>
    </matrix>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Sigma=\begin{bmatrix}\mathrm{E}[(X_{1}-\mu_{1})(X_{1}-\mu_{1})]&\mathrm{E}[(X%
_{1}-\mu_{1})(X_{2}-\mu_{2})]&\cdots&\mathrm{E}[(X_{1}-\mu_{1})(X_{n}-\mu_{n})%
]\\
\\
\mathrm{E}[(X_{2}-\mu_{2})(X_{1}-\mu_{1})]&\mathrm{E}[(X_{2}-\mu_{2})(X_{2}-%
\mu_{2})]&\cdots&\mathrm{E}[(X_{2}-\mu_{2})(X_{n}-\mu_{n})]\\
\\
\vdots&\vdots&\ddots&\vdots\\
\\
\mathrm{E}[(X_{n}-\mu_{n})(X_{1}-\mu_{1})]&\mathrm{E}[(X_{n}-\mu_{n})(X_{2}-%
\mu_{2})]&\cdots&\mathrm{E}[(X_{n}-\mu_{n})(X_{n}-\mu_{n})]\end{bmatrix}.
  </annotation>
 </semantics>
</math>

</p>

<p>The inverse of this matrix, 

<math display="inline" id="Covariance_matrix:4">
 <semantics>
  <msup>
   <mi mathvariant="normal">Œ£</mi>
   <mrow>
    <mo>-</mo>
    <mn>1</mn>
   </mrow>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>normal-Œ£</ci>
    <apply>
     <minus></minus>
     <cn type="integer">1</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Sigma^{-1}
  </annotation>
 </semantics>
</math>

 is the <strong>inverse covariance matrix</strong>, also known as the <strong>concentration matrix</strong> or <strong>precision matrix</strong>;<a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a> see <a href="precision_(statistics)" title="wikilink">precision (statistics)</a>. The elements of the precision matrix have an interpretation in terms of <a href="partial_correlation" title="wikilink">partial correlations</a> and <a href="partial_variance" title="wikilink">partial variances</a>.</p>
<h3 id="generalization-of-the-variance">Generalization of the variance</h3>

<p>The definition above is equivalent to the matrix equality</p>

<p>

<math display="block" id="Covariance_matrix:5">
 <semantics>
  <mrow>
   <mi mathvariant="normal">Œ£</mi>
   <mo>=</mo>
   <mrow>
    <mi mathvariant="normal">E</mi>
    <mrow>
     <mo>[</mo>
     <mrow>
      <mrow>
       <mo>(</mo>
       <mrow>
        <mi>ùêó</mi>
        <mo>-</mo>
        <mrow>
         <mi mathvariant="normal">E</mi>
         <mrow>
          <mo stretchy="false">[</mo>
          <mi>ùêó</mi>
          <mo stretchy="false">]</mo>
         </mrow>
        </mrow>
       </mrow>
       <mo>)</mo>
      </mrow>
      <msup>
       <mrow>
        <mo>(</mo>
        <mrow>
         <mi>ùêó</mi>
         <mo>-</mo>
         <mrow>
          <mi mathvariant="normal">E</mi>
          <mrow>
           <mo stretchy="false">[</mo>
           <mi>ùêó</mi>
           <mo stretchy="false">]</mo>
          </mrow>
         </mrow>
        </mrow>
        <mo>)</mo>
       </mrow>
       <mi mathvariant="normal">T</mi>
      </msup>
     </mrow>
     <mo>]</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>normal-Œ£</ci>
    <apply>
     <times></times>
     <ci>normal-E</ci>
     <apply>
      <csymbol cd="latexml">delimited-[]</csymbol>
      <apply>
       <times></times>
       <apply>
        <minus></minus>
        <ci>ùêó</ci>
        <apply>
         <times></times>
         <ci>normal-E</ci>
         <apply>
          <csymbol cd="latexml">delimited-[]</csymbol>
          <ci>ùêó</ci>
         </apply>
        </apply>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <minus></minus>
         <ci>ùêó</ci>
         <apply>
          <times></times>
          <ci>normal-E</ci>
          <apply>
           <csymbol cd="latexml">delimited-[]</csymbol>
           <ci>ùêó</ci>
          </apply>
         </apply>
        </apply>
        <ci>normal-T</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Sigma=\mathrm{E}\left[\left(\mathbf{X}-\mathrm{E}[\mathbf{X}]\right)\left(%
\mathbf{X}-\mathrm{E}[\mathbf{X}]\right)^{\rm T}\right]
  </annotation>
 </semantics>
</math>

</p>

<p>This form can be seen as a generalization of the scalar-valued <a class="uri" href="variance" title="wikilink">variance</a> to higher dimensions. Recall that for a scalar-valued random variable <em>X</em></p>

<p>

<math display="block" id="Covariance_matrix:6">
 <semantics>
  <mrow>
   <mrow>
    <msup>
     <mi>œÉ</mi>
     <mn>2</mn>
    </msup>
    <mo>=</mo>
    <mrow>
     <mi>var</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>X</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mi mathvariant="normal">E</mi>
     <mrow>
      <mo stretchy="false">[</mo>
      <msup>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mi>X</mi>
         <mo>-</mo>
         <mrow>
          <mi mathvariant="normal">E</mi>
          <mrow>
           <mo stretchy="false">(</mo>
           <mi>X</mi>
           <mo stretchy="false">)</mo>
          </mrow>
         </mrow>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
       <mn>2</mn>
      </msup>
      <mo stretchy="false">]</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mi mathvariant="normal">E</mi>
     <mrow>
      <mo stretchy="false">[</mo>
      <mrow>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mi>X</mi>
         <mo>-</mo>
         <mrow>
          <mi mathvariant="normal">E</mi>
          <mrow>
           <mo stretchy="false">(</mo>
           <mi>X</mi>
           <mo stretchy="false">)</mo>
          </mrow>
         </mrow>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
       <mo>‚ãÖ</mo>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mi>X</mi>
         <mo>-</mo>
         <mrow>
          <mi mathvariant="normal">E</mi>
          <mrow>
           <mo stretchy="false">(</mo>
           <mi>X</mi>
           <mo stretchy="false">)</mo>
          </mrow>
         </mrow>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
      <mo stretchy="false">]</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>œÉ</ci>
      <cn type="integer">2</cn>
     </apply>
     <apply>
      <times></times>
      <ci>var</ci>
      <ci>X</ci>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <ci>normal-E</ci>
      <apply>
       <csymbol cd="latexml">delimited-[]</csymbol>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <minus></minus>
         <ci>X</ci>
         <apply>
          <times></times>
          <ci>normal-E</ci>
          <ci>X</ci>
         </apply>
        </apply>
        <cn type="integer">2</cn>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <ci>normal-E</ci>
      <apply>
       <csymbol cd="latexml">delimited-[]</csymbol>
       <apply>
        <ci>normal-‚ãÖ</ci>
        <apply>
         <minus></minus>
         <ci>X</ci>
         <apply>
          <times></times>
          <ci>normal-E</ci>
          <ci>X</ci>
         </apply>
        </apply>
        <apply>
         <minus></minus>
         <ci>X</ci>
         <apply>
          <times></times>
          <ci>normal-E</ci>
          <ci>X</ci>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \sigma^{2}=\mathrm{var}(X)=\mathrm{E}[(X-\mathrm{E}(X))^{2}]=\mathrm{E}[(X-%
\mathrm{E}(X))\cdot(X-\mathrm{E}(X))].\,
  </annotation>
 </semantics>
</math>

</p>

<p>Indeed, the entries on the diagonal of the covariance matrix 

<math display="inline" id="Covariance_matrix:7">
 <semantics>
  <mi mathvariant="normal">Œ£</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>normal-Œ£</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Sigma
  </annotation>
 </semantics>
</math>

 are the variances of each element of the vector 

<math display="inline" id="Covariance_matrix:8">
 <semantics>
  <mi>ùêó</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>ùêó</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{X}
  </annotation>
 </semantics>
</math>

.</p>
<h3 id="correlation-matrix">Correlation matrix</h3>

<p>A quantity closely related to the covariance matrix is the correlation matrix, the matrix of <a href="Pearson_product-moment_correlation_coefficient" title="wikilink">Pearson product-moment correlation coefficients</a> between each of the random variables in the random vector 

<math display="inline" id="Covariance_matrix:9">
 <semantics>
  <mi>ùêó</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>ùêó</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{X}
  </annotation>
 </semantics>
</math>

, which can be written</p>

<p>

<math display="block" id="Covariance_matrix:10">
 <semantics>
  <mrow>
   <mrow>
    <mtext>corr</mtext>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>ùêó</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mpadded width="+1.7pt">
     <msup>
      <mrow>
       <mo>(</mo>
       <mrow>
        <mtext>diag</mtext>
        <mrow>
         <mo stretchy="false">(</mo>
         <mi mathvariant="normal">Œ£</mi>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
       <mo>)</mo>
      </mrow>
      <mrow>
       <mo>-</mo>
       <mfrac>
        <mn>1</mn>
        <mn>2</mn>
       </mfrac>
      </mrow>
     </msup>
    </mpadded>
    <mpadded width="+1.7pt">
     <mi mathvariant="normal">Œ£</mi>
    </mpadded>
    <msup>
     <mrow>
      <mo>(</mo>
      <mrow>
       <mtext>diag</mtext>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi mathvariant="normal">Œ£</mi>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
      <mo>)</mo>
     </mrow>
     <mrow>
      <mo>-</mo>
      <mfrac>
       <mn>1</mn>
       <mn>2</mn>
      </mfrac>
     </mrow>
    </msup>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <mtext>corr</mtext>
     <ci>ùêó</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <times></times>
       <mtext>diag</mtext>
       <ci>normal-Œ£</ci>
      </apply>
      <apply>
       <minus></minus>
       <apply>
        <divide></divide>
        <cn type="integer">1</cn>
        <cn type="integer">2</cn>
       </apply>
      </apply>
     </apply>
     <ci>normal-Œ£</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <times></times>
       <mtext>diag</mtext>
       <ci>normal-Œ£</ci>
      </apply>
      <apply>
       <minus></minus>
       <apply>
        <divide></divide>
        <cn type="integer">1</cn>
        <cn type="integer">2</cn>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \text{corr}(\mathbf{X})=\left(\text{diag}(\Sigma)\right)^{-\frac{1}{2}}\,%
\Sigma\,\left(\text{diag}(\Sigma)\right)^{-\frac{1}{2}}
  </annotation>
 </semantics>
</math>

 where 

<math display="inline" id="Covariance_matrix:11">
 <semantics>
  <mrow>
   <mtext>diag</mtext>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi mathvariant="normal">Œ£</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <mtext>diag</mtext>
    <ci>normal-Œ£</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \text{diag}(\Sigma)
  </annotation>
 </semantics>
</math>

 is the matrix of the diagonal elements of 

<math display="inline" id="Covariance_matrix:12">
 <semantics>
  <mi mathvariant="normal">Œ£</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>normal-Œ£</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Sigma
  </annotation>
 </semantics>
</math>

 (i.e., a <a href="diagonal_matrix" title="wikilink">diagonal matrix</a> of the variances of 

<math display="inline" id="Covariance_matrix:13">
 <semantics>
  <msub>
   <mi>X</mi>
   <mi>i</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>X</ci>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   X_{i}
  </annotation>
 </semantics>
</math>

 for 

<math display="inline" id="Covariance_matrix:14">
 <semantics>
  <mrow>
   <mi>i</mi>
   <mo>=</mo>
   <mrow>
    <mn>1</mn>
    <mo>,</mo>
    <mi mathvariant="normal">‚Ä¶</mi>
    <mo>,</mo>
    <mi>n</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>i</ci>
    <list>
     <cn type="integer">1</cn>
     <ci>normal-‚Ä¶</ci>
     <ci>n</ci>
    </list>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   i=1,\dots,n
  </annotation>
 </semantics>
</math>

).</p>

<p>Equivalently, the correlation matrix can be seen as the covariance matrix of the <a href="standardized_variable" title="wikilink">standardized random variables</a> 

<math display="inline" id="Covariance_matrix:15">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>X</mi>
     <mi>i</mi>
    </msub>
    <mo>/</mo>
    <mi>œÉ</mi>
   </mrow>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>X</mi>
     <mi>i</mi>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <divide></divide>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>X</ci>
      <ci>i</ci>
     </apply>
     <ci>œÉ</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>X</ci>
     <ci>i</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   X_{i}/\sigma(X_{i})
  </annotation>
 </semantics>
</math>

 for 

<math display="inline" id="Covariance_matrix:16">
 <semantics>
  <mrow>
   <mi>i</mi>
   <mo>=</mo>
   <mrow>
    <mn>1</mn>
    <mo>,</mo>
    <mi mathvariant="normal">‚Ä¶</mi>
    <mo>,</mo>
    <mi>n</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>i</ci>
    <list>
     <cn type="integer">1</cn>
     <ci>normal-‚Ä¶</ci>
     <ci>n</ci>
    </list>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   i=1,\dots,n
  </annotation>
 </semantics>
</math>

.</p>

<p>Each element on the principal diagonal of a correlation matrix is the correlation of a random variable with itself, which always equals 1. Each off-diagonal element is between 1 and ‚Äì1 inclusive.</p>
<h2 id="conflicting-nomenclatures-and-notations">Conflicting nomenclatures and notations</h2>

<p>Nomenclatures differ. Some statisticians, following the probabilist <a href="William_Feller" title="wikilink">William Feller</a>, call the matrix 

<math display="inline" id="Covariance_matrix:17">
 <semantics>
  <mi mathvariant="normal">Œ£</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>normal-Œ£</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Sigma
  </annotation>
 </semantics>
</math>

 the <strong>variance</strong> of the random vector 

<math display="inline" id="Covariance_matrix:18">
 <semantics>
  <mi>X</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>X</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   X
  </annotation>
 </semantics>
</math>

, because it is the natural generalization to higher dimensions of the 1-dimensional variance. Others call it the <strong>covariance matrix</strong>, because it is the matrix of covariances between the scalar components of the vector 

<math display="inline" id="Covariance_matrix:19">
 <semantics>
  <mi>X</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>X</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   X
  </annotation>
 </semantics>
</math>

. Thus</p>

<p>

<math display="block" id="Covariance_matrix:20">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mo>var</mo>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>ùêó</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mo>cov</mo>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>ùêó</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mi mathvariant="normal">E</mi>
     <mrow>
      <mo>[</mo>
      <mrow>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mi>ùêó</mi>
         <mo>-</mo>
         <mrow>
          <mi mathvariant="normal">E</mi>
          <mrow>
           <mo stretchy="false">[</mo>
           <mi>ùêó</mi>
           <mo stretchy="false">]</mo>
          </mrow>
         </mrow>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
       <msup>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <mi>ùêó</mi>
          <mo>-</mo>
          <mrow>
           <mi mathvariant="normal">E</mi>
           <mrow>
            <mo stretchy="false">[</mo>
            <mi>ùêó</mi>
            <mo stretchy="false">]</mo>
           </mrow>
          </mrow>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
        <mi mathvariant="normal">T</mi>
       </msup>
      </mrow>
      <mo>]</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <ci>var</ci>
      <ci>ùêó</ci>
     </apply>
     <apply>
      <ci>cov</ci>
      <ci>ùêó</ci>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <ci>normal-E</ci>
      <apply>
       <csymbol cd="latexml">delimited-[]</csymbol>
       <apply>
        <times></times>
        <apply>
         <minus></minus>
         <ci>ùêó</ci>
         <apply>
          <times></times>
          <ci>normal-E</ci>
          <apply>
           <csymbol cd="latexml">delimited-[]</csymbol>
           <ci>ùêó</ci>
          </apply>
         </apply>
        </apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <minus></minus>
          <ci>ùêó</ci>
          <apply>
           <times></times>
           <ci>normal-E</ci>
           <apply>
            <csymbol cd="latexml">delimited-[]</csymbol>
            <ci>ùêó</ci>
           </apply>
          </apply>
         </apply>
         <ci>normal-T</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \operatorname{var}(\mathbf{X})=\operatorname{cov}(\mathbf{X})=\mathrm{E}\left[%
(\mathbf{X}-\mathrm{E}[\mathbf{X}])(\mathbf{X}-\mathrm{E}[\mathbf{X}])^{\rm T}%
\right].
  </annotation>
 </semantics>
</math>

</p>

<p>However, the notation for the <a class="uri" href="cross-covariance" title="wikilink">cross-covariance</a> <em>between</em> two vectors is standard:</p>

<p>

<math display="block" id="Covariance_matrix:21">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mo>cov</mo>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>ùêó</mi>
      <mo>,</mo>
      <mi>ùêò</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mi mathvariant="normal">E</mi>
     <mrow>
      <mo>[</mo>
      <mrow>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mi>ùêó</mi>
         <mo>-</mo>
         <mrow>
          <mi mathvariant="normal">E</mi>
          <mrow>
           <mo stretchy="false">[</mo>
           <mi>ùêó</mi>
           <mo stretchy="false">]</mo>
          </mrow>
         </mrow>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
       <msup>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <mi>ùêò</mi>
          <mo>-</mo>
          <mrow>
           <mi mathvariant="normal">E</mi>
           <mrow>
            <mo stretchy="false">[</mo>
            <mi>ùêò</mi>
            <mo stretchy="false">]</mo>
           </mrow>
          </mrow>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
        <mi mathvariant="normal">T</mi>
       </msup>
      </mrow>
      <mo>]</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <ci>cov</ci>
     <ci>ùêó</ci>
     <ci>ùêò</ci>
    </apply>
    <apply>
     <times></times>
     <ci>normal-E</ci>
     <apply>
      <csymbol cd="latexml">delimited-[]</csymbol>
      <apply>
       <times></times>
       <apply>
        <minus></minus>
        <ci>ùêó</ci>
        <apply>
         <times></times>
         <ci>normal-E</ci>
         <apply>
          <csymbol cd="latexml">delimited-[]</csymbol>
          <ci>ùêó</ci>
         </apply>
        </apply>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <minus></minus>
         <ci>ùêò</ci>
         <apply>
          <times></times>
          <ci>normal-E</ci>
          <apply>
           <csymbol cd="latexml">delimited-[]</csymbol>
           <ci>ùêò</ci>
          </apply>
         </apply>
        </apply>
        <ci>normal-T</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \operatorname{cov}(\mathbf{X},\mathbf{Y})=\mathrm{E}\left[(\mathbf{X}-\mathrm{%
E}[\mathbf{X}])(\mathbf{Y}-\mathrm{E}[\mathbf{Y}])^{\rm T}\right].
  </annotation>
 </semantics>
</math>

</p>

<p>The var notation is found in William Feller's two-volume book <em>An Introduction to Probability Theory and Its Applications</em>,<a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a> but both forms are quite standard and there is no ambiguity between them.</p>

<p>The matrix 

<math display="inline" id="Covariance_matrix:22">
 <semantics>
  <mi mathvariant="normal">Œ£</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>normal-Œ£</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Sigma
  </annotation>
 </semantics>
</math>

 is also often called the variance-covariance matrix since the diagonal terms are in fact variances.</p>
<h2 id="properties">Properties</h2>

<p>For 

<math display="inline" id="Covariance_matrix:23">
 <semantics>
  <mrow>
   <mi mathvariant="normal">Œ£</mi>
   <mo>=</mo>
   <mrow>
    <mi mathvariant="normal">E</mi>
    <mrow>
     <mo>[</mo>
     <mrow>
      <mrow>
       <mo>(</mo>
       <mrow>
        <mi>ùêó</mi>
        <mo>-</mo>
        <mrow>
         <mi mathvariant="normal">E</mi>
         <mrow>
          <mo stretchy="false">[</mo>
          <mi>ùêó</mi>
          <mo stretchy="false">]</mo>
         </mrow>
        </mrow>
       </mrow>
       <mo>)</mo>
      </mrow>
      <msup>
       <mrow>
        <mo>(</mo>
        <mrow>
         <mi>ùêó</mi>
         <mo>-</mo>
         <mrow>
          <mi mathvariant="normal">E</mi>
          <mrow>
           <mo stretchy="false">[</mo>
           <mi>ùêó</mi>
           <mo stretchy="false">]</mo>
          </mrow>
         </mrow>
        </mrow>
        <mo>)</mo>
       </mrow>
       <mi mathvariant="normal">T</mi>
      </msup>
     </mrow>
     <mo>]</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>normal-Œ£</ci>
    <apply>
     <times></times>
     <ci>normal-E</ci>
     <apply>
      <csymbol cd="latexml">delimited-[]</csymbol>
      <apply>
       <times></times>
       <apply>
        <minus></minus>
        <ci>ùêó</ci>
        <apply>
         <times></times>
         <ci>normal-E</ci>
         <apply>
          <csymbol cd="latexml">delimited-[]</csymbol>
          <ci>ùêó</ci>
         </apply>
        </apply>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <minus></minus>
         <ci>ùêó</ci>
         <apply>
          <times></times>
          <ci>normal-E</ci>
          <apply>
           <csymbol cd="latexml">delimited-[]</csymbol>
           <ci>ùêó</ci>
          </apply>
         </apply>
        </apply>
        <ci>normal-T</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Sigma=\mathrm{E}\left[\left(\mathbf{X}-\mathrm{E}[\mathbf{X}]\right)\left(%
\mathbf{X}-\mathrm{E}[\mathbf{X}]\right)^{\rm T}\right]
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Covariance_matrix:24">
 <semantics>
  <mrow>
   <mi>ùùÅ</mi>
   <mo>=</mo>
   <mrow>
    <mi mathvariant="normal">E</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mtext>ùêó</mtext>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>ùùÅ</ci>
    <apply>
     <times></times>
     <ci>normal-E</ci>
     <mtext>X</mtext>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \boldsymbol{\mu}=\mathrm{E}(\textbf{X})
  </annotation>
 </semantics>
</math>

, where <strong>X</strong> is a random <em>p</em>-dimensional variable and <strong>Y</strong> a random <em>q</em>-dimensional variable, the following basic properties apply:<a class="footnoteRef" href="#fn3" id="fnref3"><sup>3</sup></a></p>
<ol>
<li>

<math display="inline" id="Covariance_matrix:25">
 <semantics>
  <mrow>
   <mi mathvariant="normal">Œ£</mi>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mi mathvariant="normal">E</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <msup>
       <mi>ùêóùêó</mi>
       <mi mathvariant="normal">T</mi>
      </msup>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>-</mo>
    <mrow>
     <mi>ùùÅ</mi>
     <msup>
      <mi>ùùÅ</mi>
      <mi mathvariant="normal">T</mi>
     </msup>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>normal-Œ£</ci>
    <apply>
     <minus></minus>
     <apply>
      <times></times>
      <ci>normal-E</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>ùêóùêó</ci>
       <ci>normal-T</ci>
      </apply>
     </apply>
     <apply>
      <times></times>
      <ci>ùùÅ</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>ùùÅ</ci>
       <ci>normal-T</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Sigma=\mathrm{E}(\mathbf{XX^{\rm T}})-\boldsymbol{\mu}\boldsymbol{\mu}^{\rm T}
  </annotation>
 </semantics>
</math>

</li>
<li>

<math display="inline" id="Covariance_matrix:26">
 <semantics>
  <mpadded width="+1.7pt">
   <mi mathvariant="normal">Œ£</mi>
  </mpadded>
  <annotation-xml encoding="MathML-Content">
   <ci>normal-Œ£</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Sigma\,
  </annotation>
 </semantics>
</math>

 is <a href="Positive-semidefinite_matrix" title="wikilink">positive-semidefinite</a> and <a href="symmetric_matrix" title="wikilink">symmetric</a>.</li>
<li>

<math display="inline" id="Covariance_matrix:27">
 <semantics>
  <mrow>
   <mrow>
    <mo>cov</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>ùêÄùêó</mi>
      <mo>+</mo>
      <mi>ùêö</mi>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mpadded width="+1.7pt">
     <mi>ùêÄ</mi>
    </mpadded>
    <mrow>
     <mrow>
      <mo>cov</mo>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>ùêó</mi>
       <mo rspace="4.2pt" stretchy="false">)</mo>
      </mrow>
     </mrow>
     <msup>
      <mi>ùêÄ</mi>
      <mi mathvariant="normal">T</mi>
     </msup>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <ci>cov</ci>
     <apply>
      <plus></plus>
      <ci>ùêÄùêó</ci>
      <ci>ùêö</ci>
     </apply>
    </apply>
    <apply>
     <times></times>
     <ci>ùêÄ</ci>
     <apply>
      <apply>
       <ci>cov</ci>
       <ci>ùêó</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>ùêÄ</ci>
       <ci>normal-T</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \operatorname{cov}(\mathbf{AX}+\mathbf{a})=\mathbf{A}\,\operatorname{cov}(%
\mathbf{X})\,\mathbf{A^{\rm T}}
  </annotation>
 </semantics>
</math>

</li>
<li>

<math display="inline" id="Covariance_matrix:28">
 <semantics>
  <mrow>
   <mo>cov</mo>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>ùêó</mi>
    <mo>,</mo>
    <mi>ùêò</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>=</mo>
   <mo>cov</mo>
   <msup>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>ùêò</mi>
     <mo>,</mo>
     <mi>ùêó</mi>
     <mo stretchy="false">)</mo>
    </mrow>
    <mi mathvariant="normal">T</mi>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <ci>cov</ci>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">X</csymbol>
     <ci>normal-,</ci>
     <csymbol cd="unknown">Y</csymbol>
     <ci>normal-)</ci>
    </cerror>
    <eq></eq>
    <ci>cov</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <ci>normal-(</ci>
      <csymbol cd="unknown">Y</csymbol>
      <ci>normal-,</ci>
      <csymbol cd="unknown">X</csymbol>
      <ci>normal-)</ci>
     </cerror>
     <ci>normal-T</ci>
    </apply>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \operatorname{cov}(\mathbf{X},\mathbf{Y})=\operatorname{cov}(\mathbf{Y},%
\mathbf{X})^{\rm T}
  </annotation>
 </semantics>
</math>

</li>
<li>

<math display="inline" id="Covariance_matrix:29">
 <semantics>
  <mrow>
   <mrow>
    <mo>cov</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <msub>
       <mi>ùêó</mi>
       <mn>1</mn>
      </msub>
      <mo>+</mo>
      <msub>
       <mi>ùêó</mi>
       <mn>2</mn>
      </msub>
     </mrow>
     <mo>,</mo>
     <mi>ùêò</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mo>cov</mo>
     <mrow>
      <mo stretchy="false">(</mo>
      <msub>
       <mi>ùêó</mi>
       <mn>1</mn>
      </msub>
      <mo>,</mo>
      <mi>ùêò</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>+</mo>
    <mrow>
     <mo>cov</mo>
     <mrow>
      <mo stretchy="false">(</mo>
      <msub>
       <mi>ùêó</mi>
       <mn>2</mn>
      </msub>
      <mo>,</mo>
      <mi>ùêò</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <ci>cov</ci>
     <apply>
      <plus></plus>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>ùêó</ci>
       <cn type="integer">1</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>ùêó</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
     <ci>ùêò</ci>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <ci>cov</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>ùêó</ci>
       <cn type="integer">1</cn>
      </apply>
      <ci>ùêò</ci>
     </apply>
     <apply>
      <ci>cov</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>ùêó</ci>
       <cn type="integer">2</cn>
      </apply>
      <ci>ùêò</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \operatorname{cov}(\mathbf{X}_{1}+\mathbf{X}_{2},\mathbf{Y})=\operatorname{cov%
}(\mathbf{X}_{1},\mathbf{Y})+\operatorname{cov}(\mathbf{X}_{2},\mathbf{Y})
  </annotation>
 </semantics>
</math>

</li>
<li>If <em>p</em> = <em>q</em>, then 

<math display="inline" id="Covariance_matrix:30">
 <semantics>
  <mrow>
   <mrow>
    <mo>var</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>ùêó</mi>
      <mo>+</mo>
      <mi>ùêò</mi>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mo>var</mo>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>ùêó</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>+</mo>
    <mrow>
     <mo>cov</mo>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>ùêó</mi>
      <mo>,</mo>
      <mi>ùêò</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>+</mo>
    <mrow>
     <mo>cov</mo>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>ùêò</mi>
      <mo>,</mo>
      <mi>ùêó</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>+</mo>
    <mrow>
     <mo>var</mo>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>ùêò</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <ci>var</ci>
     <apply>
      <plus></plus>
      <ci>ùêó</ci>
      <ci>ùêò</ci>
     </apply>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <ci>var</ci>
      <ci>ùêó</ci>
     </apply>
     <apply>
      <ci>cov</ci>
      <ci>ùêó</ci>
      <ci>ùêò</ci>
     </apply>
     <apply>
      <ci>cov</ci>
      <ci>ùêò</ci>
      <ci>ùêó</ci>
     </apply>
     <apply>
      <ci>var</ci>
      <ci>ùêò</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \operatorname{var}(\mathbf{X}+\mathbf{Y})=\operatorname{var}(\mathbf{X})+%
\operatorname{cov}(\mathbf{X},\mathbf{Y})+\operatorname{cov}(\mathbf{Y},%
\mathbf{X})+\operatorname{var}(\mathbf{Y})
  </annotation>
 </semantics>
</math>

</li>
<li>

<math display="inline" id="Covariance_matrix:31">
 <semantics>
  <mrow>
   <mrow>
    <mo>cov</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>ùêÄùêó</mi>
      <mo>+</mo>
      <mi>ùêö</mi>
     </mrow>
     <mo>,</mo>
     <mrow>
      <mrow>
       <msup>
        <mi>ùêÅ</mi>
        <mi mathvariant="normal">T</mi>
       </msup>
       <mi>ùêò</mi>
      </mrow>
      <mo>+</mo>
      <mi>ùêõ</mi>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mpadded width="+1.7pt">
     <mi>ùêÄ</mi>
    </mpadded>
    <mrow>
     <mo>cov</mo>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>ùêó</mi>
      <mo>,</mo>
      <mi>ùêò</mi>
      <mo rspace="4.2pt" stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mi>ùêÅ</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <ci>cov</ci>
     <apply>
      <plus></plus>
      <ci>ùêÄùêó</ci>
      <ci>ùêö</ci>
     </apply>
     <apply>
      <plus></plus>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>ùêÅ</ci>
        <ci>normal-T</ci>
       </apply>
       <ci>ùêò</ci>
      </apply>
      <ci>ùêõ</ci>
     </apply>
    </apply>
    <apply>
     <times></times>
     <ci>ùêÄ</ci>
     <apply>
      <ci>cov</ci>
      <ci>ùêó</ci>
      <ci>ùêò</ci>
     </apply>
     <ci>ùêÅ</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \operatorname{cov}(\mathbf{AX}+\mathbf{a},\mathbf{B}^{\rm T}\mathbf{Y}+\mathbf%
{b})=\mathbf{A}\,\operatorname{cov}(\mathbf{X},\mathbf{Y})\,\mathbf{B}
  </annotation>
 </semantics>
</math>

</li>
<li>If 

<math display="inline" id="Covariance_matrix:32">
 <semantics>
  <mi>ùêó</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>ùêó</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{X}
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Covariance_matrix:33">
 <semantics>
  <mi>ùêò</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>ùêò</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{Y}
  </annotation>
 </semantics>
</math>

 are independent or uncorrelated, then 

<math display="inline" id="Covariance_matrix:34">
 <semantics>
  <mrow>
   <mrow>
    <mo>cov</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>ùêó</mi>
     <mo>,</mo>
     <mi>ùêò</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mn>ùüé</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <ci>cov</ci>
     <ci>ùêó</ci>
     <ci>ùêò</ci>
    </apply>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \operatorname{cov}(\mathbf{X},\mathbf{Y})=\mathbf{0}
  </annotation>
 </semantics>
</math>

</li>
</ol>

<p>where 

<math display="inline" id="Covariance_matrix:35">
 <semantics>
  <mrow>
   <mi>ùêó</mi>
   <mo>,</mo>
   <msub>
    <mi>ùêó</mi>
    <mn>1</mn>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <list>
    <ci>ùêó</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>ùêó</ci>
     <cn type="integer">1</cn>
    </apply>
   </list>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{X},\mathbf{X}_{1}
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Covariance_matrix:36">
 <semantics>
  <msub>
   <mi>ùêó</mi>
   <mn>2</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>ùêó</ci>
    <cn type="integer">2</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{X}_{2}
  </annotation>
 </semantics>
</math>

 are random <em>p</em>√ó1 vectors, 

<math display="inline" id="Covariance_matrix:37">
 <semantics>
  <mi>ùêò</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>ùêò</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{Y}
  </annotation>
 </semantics>
</math>

 is a random <em>q</em>√ó1 vector, 

<math display="inline" id="Covariance_matrix:38">
 <semantics>
  <mi>ùêö</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>ùêö</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{a}
  </annotation>
 </semantics>
</math>

 is a <em>q</em>√ó1 vector, 

<math display="inline" id="Covariance_matrix:39">
 <semantics>
  <mi>ùêõ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>ùêõ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{b}
  </annotation>
 </semantics>
</math>

 is a <em>p</em>√ó1 vector, and 

<math display="inline" id="Covariance_matrix:40">
 <semantics>
  <mi>ùêÄ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>ùêÄ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{A}
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Covariance_matrix:41">
 <semantics>
  <mi>ùêÅ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>ùêÅ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{B}
  </annotation>
 </semantics>
</math>

 are <em>q</em>√ó<em>p</em> matrices.</p>

<p>This covariance matrix is a useful tool in many different areas. From it a <a href="transformation_matrix" title="wikilink">transformation matrix</a> can be derived, called a <a href="whitening_transformation" title="wikilink">whitening transformation</a>, that allows one to completely decorrelate the data or, from a different point of view, to find an optimal basis for representing the data in a compact way (see <a href="Rayleigh_quotient" title="wikilink">Rayleigh quotient</a> for a formal proof and additional properties of covariance matrices). This is called <a href="principal_components_analysis" title="wikilink">principal components analysis</a> (PCA) and the <a href="Karhunen-Lo√®ve_transform" title="wikilink">Karhunen-Lo√®ve transform</a> (KL-transform).</p>
<h3 id="block-matrices">Block matrices</h3>

<p>The joint mean 

<math display="inline" id="Covariance_matrix:42">
 <semantics>
  <msub>
   <mi>ùùÅ</mi>
   <mrow>
    <mi>X</mi>
    <mo>,</mo>
    <mi>Y</mi>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>ùùÅ</ci>
    <list>
     <ci>X</ci>
     <ci>Y</ci>
    </list>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \boldsymbol{\mu}_{X,Y}
  </annotation>
 </semantics>
</math>

 and joint covariance matrix 

<math display="inline" id="Covariance_matrix:43">
 <semantics>
  <msub>
   <mi>ùö∫</mi>
   <mrow>
    <mi>X</mi>
    <mo>,</mo>
    <mi>Y</mi>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>ùö∫</ci>
    <list>
     <ci>X</ci>
     <ci>Y</ci>
    </list>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \boldsymbol{\Sigma}_{X,Y}
  </annotation>
 </semantics>
</math>

 of 

<math display="inline" id="Covariance_matrix:44">
 <semantics>
  <mi>ùëø</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>ùëø</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \boldsymbol{X}
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Covariance_matrix:45">
 <semantics>
  <mi>ùíÄ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>ùíÄ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \boldsymbol{Y}
  </annotation>
 </semantics>
</math>

 can be written in block form</p>

<p>

<math display="block" id="Covariance_matrix:46">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>ùùÅ</mi>
     <mrow>
      <mi>X</mi>
      <mo>,</mo>
      <mi>Y</mi>
     </mrow>
    </msub>
    <mo>=</mo>
    <mrow>
     <mo>[</mo>
     <mtable displaystyle="true">
      <mtr>
       <mtd columnalign="center">
        <msub>
         <mi>ùùÅ</mi>
         <mi>X</mi>
        </msub>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <msub>
         <mi>ùùÅ</mi>
         <mi>Y</mi>
        </msub>
       </mtd>
      </mtr>
     </mtable>
     <mo>]</mo>
    </mrow>
   </mrow>
   <mo rspace="22.5pt">,</mo>
   <mrow>
    <msub>
     <mi>ùö∫</mi>
     <mrow>
      <mi>X</mi>
      <mo>,</mo>
      <mi>Y</mi>
     </mrow>
    </msub>
    <mo>=</mo>
    <mrow>
     <mo>[</mo>
     <mtable displaystyle="true">
      <mtr>
       <mtd columnalign="center">
        <msub>
         <mi>ùö∫</mi>
         <mi>ùëãùëã</mi>
        </msub>
       </mtd>
       <mtd columnalign="center">
        <msub>
         <mi>ùö∫</mi>
         <mi>ùëãùëå</mi>
        </msub>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <msub>
         <mi>ùö∫</mi>
         <mi>ùëåùëã</mi>
        </msub>
       </mtd>
       <mtd columnalign="center">
        <msub>
         <mi>ùö∫</mi>
         <mi>ùëåùëå</mi>
        </msub>
       </mtd>
      </mtr>
     </mtable>
     <mo>]</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>ùùÅ</ci>
      <list>
       <ci>X</ci>
       <ci>Y</ci>
      </list>
     </apply>
     <matrix>
      <matrixrow>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>ùùÅ</ci>
        <ci>X</ci>
       </apply>
      </matrixrow>
      <matrixrow>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>ùùÅ</ci>
        <ci>Y</ci>
       </apply>
      </matrixrow>
     </matrix>
    </apply>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>ùö∫</ci>
      <list>
       <ci>X</ci>
       <ci>Y</ci>
      </list>
     </apply>
     <matrix>
      <matrixrow>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>ùö∫</ci>
        <ci>ùëãùëã</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>ùö∫</ci>
        <ci>ùëãùëå</ci>
       </apply>
      </matrixrow>
      <matrixrow>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>ùö∫</ci>
        <ci>ùëåùëã</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>ùö∫</ci>
        <ci>ùëåùëå</ci>
       </apply>
      </matrixrow>
     </matrix>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \boldsymbol{\mu}_{X,Y}=\begin{bmatrix}\boldsymbol{\mu}_{X}\\
\boldsymbol{\mu}_{Y}\end{bmatrix},\qquad\boldsymbol{\Sigma}_{X,Y}=\begin{%
bmatrix}\boldsymbol{\Sigma}_{\mathit{XX}}&\boldsymbol{\Sigma}_{\mathit{XY}}\\
\boldsymbol{\Sigma}_{\mathit{YX}}&\boldsymbol{\Sigma}_{\mathit{YY}}\end{bmatrix}
  </annotation>
 </semantics>
</math>

</p>

<p>where 

<math display="inline" id="Covariance_matrix:47">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <msub>
      <mi>ùö∫</mi>
      <mrow>
       <mi>X</mi>
       <mi>X</mi>
      </mrow>
     </msub>
     <mo>=</mo>
     <mrow>
      <mtext>var</mtext>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>ùëø</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mrow>
    <mo>,</mo>
    <mrow>
     <msub>
      <mi>ùö∫</mi>
      <mrow>
       <mi>Y</mi>
       <mi>Y</mi>
      </mrow>
     </msub>
     <mo>=</mo>
     <mrow>
      <mtext>var</mtext>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>ùíÄ</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>ùö∫</ci>
      <apply>
       <times></times>
       <ci>X</ci>
       <ci>X</ci>
      </apply>
     </apply>
     <apply>
      <times></times>
      <mtext>var</mtext>
      <ci>ùëø</ci>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>ùö∫</ci>
      <apply>
       <times></times>
       <ci>Y</ci>
       <ci>Y</ci>
      </apply>
     </apply>
     <apply>
      <times></times>
      <mtext>var</mtext>
      <ci>ùíÄ</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \boldsymbol{\Sigma}_{XX}=\mbox{var}(\boldsymbol{X}),\boldsymbol{\Sigma}_{YY}=%
\mbox{var}(\boldsymbol{Y}),
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Covariance_matrix:48">
 <semantics>
  <mrow>
   <msub>
    <mi>ùö∫</mi>
    <mrow>
     <mi>X</mi>
     <mi>Y</mi>
    </mrow>
   </msub>
   <mo>=</mo>
   <msubsup>
    <mi>ùö∫</mi>
    <mi>ùëåùëã</mi>
    <mi>T</mi>
   </msubsup>
   <mo>=</mo>
   <mrow>
    <mtext>cov</mtext>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>ùëø</mi>
     <mo>,</mo>
     <mi>ùíÄ</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>ùö∫</ci>
      <apply>
       <times></times>
       <ci>X</ci>
       <ci>Y</ci>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>ùö∫</ci>
       <ci>T</ci>
      </apply>
      <ci>ùëåùëã</ci>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <mtext>cov</mtext>
      <interval closure="open">
       <ci>ùëø</ci>
       <ci>ùíÄ</ci>
      </interval>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \boldsymbol{\Sigma}_{XY}=\boldsymbol{\Sigma}^{T}_{\mathit{YX}}=\mbox{cov}(%
\boldsymbol{X},\boldsymbol{Y})
  </annotation>
 </semantics>
</math>

.</p>

<p>

<math display="inline" id="Covariance_matrix:49">
 <semantics>
  <msub>
   <mi>ùö∫</mi>
   <mrow>
    <mi>X</mi>
    <mi>X</mi>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>ùö∫</ci>
    <apply>
     <times></times>
     <ci>X</ci>
     <ci>X</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \boldsymbol{\Sigma}_{XX}
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Covariance_matrix:50">
 <semantics>
  <msub>
   <mi>ùö∫</mi>
   <mrow>
    <mi>Y</mi>
    <mi>Y</mi>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>ùö∫</ci>
    <apply>
     <times></times>
     <ci>Y</ci>
     <ci>Y</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \boldsymbol{\Sigma}_{YY}
  </annotation>
 </semantics>
</math>

 can be identified as the variance matrices of the <a href="marginal_distribution" title="wikilink">marginal distributions</a> for 

<math display="inline" id="Covariance_matrix:51">
 <semantics>
  <mi>ùëø</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>ùëø</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \boldsymbol{X}
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Covariance_matrix:52">
 <semantics>
  <mi>ùíÄ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>ùíÄ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \boldsymbol{Y}
  </annotation>
 </semantics>
</math>

 respectively.</p>

<p>If 

<math display="inline" id="Covariance_matrix:53">
 <semantics>
  <mi>ùëø</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>ùëø</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \boldsymbol{X}
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Covariance_matrix:54">
 <semantics>
  <mi>ùíÄ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>ùíÄ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \boldsymbol{Y}
  </annotation>
 </semantics>
</math>

 are <a href="Multivariate_normal_distribution" title="wikilink">jointly normally distributed</a>,</p>

<p>

<math display="block" id="Covariance_matrix:55">
 <semantics>
  <mrow>
   <mrow>
    <mi>ùíô</mi>
    <mo>,</mo>
    <mi>ùíö</mi>
   </mrow>
   <mo rspace="7.5pt">‚àº</mo>
   <mrow>
    <mi class="ltx_font_mathcaligraphic">ùí©</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <msub>
      <mi>ùùÅ</mi>
      <mrow>
       <mi>X</mi>
       <mo>,</mo>
       <mi>Y</mi>
      </mrow>
     </msub>
     <mo>,</mo>
     <msub>
      <mi>ùö∫</mi>
      <mrow>
       <mi>X</mi>
       <mo>,</mo>
       <mi>Y</mi>
      </mrow>
     </msub>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">similar-to</csymbol>
    <list>
     <ci>ùíô</ci>
     <ci>ùíö</ci>
    </list>
    <apply>
     <times></times>
     <ci>ùí©</ci>
     <interval closure="open">
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>ùùÅ</ci>
       <list>
        <ci>X</ci>
        <ci>Y</ci>
       </list>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>ùö∫</ci>
       <list>
        <ci>X</ci>
        <ci>Y</ci>
       </list>
      </apply>
     </interval>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \boldsymbol{x},\boldsymbol{y}\sim\ \mathcal{N}(\boldsymbol{\mu}_{X,Y},%
\boldsymbol{\Sigma}_{X,Y})
  </annotation>
 </semantics>
</math>

, then the <a href="conditional_distribution" title="wikilink">conditional distribution</a> for 

<math display="inline" id="Covariance_matrix:56">
 <semantics>
  <mi>ùíÄ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>ùíÄ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \boldsymbol{Y}
  </annotation>
 </semantics>
</math>

 given 

<math display="inline" id="Covariance_matrix:57">
 <semantics>
  <mi>ùëø</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>ùëø</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \boldsymbol{X}
  </annotation>
 </semantics>
</math>

 is given by</p>

<p>

<math display="block" id="Covariance_matrix:58">
 <semantics>
  <mrow>
   <mi>ùíö</mi>
   <mo stretchy="false">|</mo>
   <mi>ùíô</mi>
   <mo rspace="7.5pt">‚àº</mo>
   <mi class="ltx_font_mathcaligraphic">ùí©</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>ùùÅ</mi>
     <mrow>
      <mi>Y</mi>
      <mo stretchy="false">|</mo>
      <mi>X</mi>
     </mrow>
    </msub>
    <mo>,</mo>
    <msub>
     <mi>ùö∫</mi>
     <mrow>
      <mi>Y</mi>
      <mo stretchy="false">|</mo>
      <mi>X</mi>
     </mrow>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">y</csymbol>
    <ci>normal-|</ci>
    <csymbol cd="unknown">x</csymbol>
    <csymbol cd="latexml">similar-to</csymbol>
    <csymbol cd="unknown">N</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>ùùÅ</ci>
      <cerror>
       <csymbol cd="ambiguous">fragments</csymbol>
       <csymbol cd="unknown">Y</csymbol>
       <ci>normal-|</ci>
       <csymbol cd="unknown">X</csymbol>
      </cerror>
     </apply>
     <ci>normal-,</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>ùö∫</ci>
      <cerror>
       <csymbol cd="ambiguous">fragments</csymbol>
       <csymbol cd="unknown">Y</csymbol>
       <ci>normal-|</ci>
       <csymbol cd="unknown">X</csymbol>
      </cerror>
     </apply>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \boldsymbol{y}|\boldsymbol{x}\sim\ \mathcal{N}(\boldsymbol{\mu}_{Y|X},%
\boldsymbol{\Sigma}_{Y|X})
  </annotation>
 </semantics>
</math>

,<a class="footnoteRef" href="#fn4" id="fnref4"><sup>4</sup></a> defined by <a href="conditional_mean" title="wikilink">conditional mean</a></p>

<p>

<math display="block" id="Covariance_matrix:59">
 <semantics>
  <mrow>
   <msub>
    <mi>ùùÅ</mi>
    <mrow>
     <mi>Y</mi>
     <mo stretchy="false">|</mo>
     <mi>X</mi>
    </mrow>
   </msub>
   <mo>=</mo>
   <mrow>
    <msub>
     <mi>ùùÅ</mi>
     <mi>Y</mi>
    </msub>
    <mo>+</mo>
    <mrow>
     <msub>
      <mi>ùö∫</mi>
      <mrow>
       <mi>Y</mi>
       <mi>X</mi>
      </mrow>
     </msub>
     <msubsup>
      <mi>ùö∫</mi>
      <mrow>
       <mi>X</mi>
       <mi>X</mi>
      </mrow>
      <mrow>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
     </msubsup>
     <mrow>
      <mo>(</mo>
      <mrow>
       <mi>ùê±</mi>
       <mo>-</mo>
       <msub>
        <mi>ùùÅ</mi>
        <mi>X</mi>
       </msub>
      </mrow>
      <mo>)</mo>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>ùùÅ</ci>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <csymbol cd="unknown">Y</csymbol>
      <ci>normal-|</ci>
      <csymbol cd="unknown">X</csymbol>
     </cerror>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>ùùÅ</ci>
      <ci>Y</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>ùö∫</ci>
       <apply>
        <times></times>
        <ci>Y</ci>
        <ci>X</ci>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>ùö∫</ci>
        <apply>
         <times></times>
         <ci>X</ci>
         <ci>X</ci>
        </apply>
       </apply>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <apply>
       <minus></minus>
       <ci>ùê±</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>ùùÅ</ci>
        <ci>X</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \boldsymbol{\mu}_{Y|X}=\boldsymbol{\mu}_{Y}+\boldsymbol{\Sigma}_{YX}%
\boldsymbol{\Sigma}_{XX}^{-1}\left(\mathbf{x}-\boldsymbol{\mu}_{X}\right)
  </annotation>
 </semantics>
</math>

</p>

<p>and <a href="conditional_variance" title="wikilink">conditional variance</a></p>

<p>

<math display="block" id="Covariance_matrix:60">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>ùö∫</mi>
     <mrow>
      <mi>Y</mi>
      <mo stretchy="false">|</mo>
      <mi>X</mi>
     </mrow>
    </msub>
    <mo>=</mo>
    <mrow>
     <msub>
      <mi>ùö∫</mi>
      <mrow>
       <mi>Y</mi>
       <mi>Y</mi>
      </mrow>
     </msub>
     <mo>-</mo>
     <mrow>
      <msub>
       <mi>ùö∫</mi>
       <mi>ùëåùëã</mi>
      </msub>
      <msubsup>
       <mi>ùö∫</mi>
       <mi>ùëãùëã</mi>
       <mrow>
        <mo>-</mo>
        <mn>1</mn>
       </mrow>
      </msubsup>
      <msub>
       <mi>ùö∫</mi>
       <mi>ùëãùëå</mi>
      </msub>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>ùö∫</ci>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <csymbol cd="unknown">Y</csymbol>
      <ci>normal-|</ci>
      <csymbol cd="unknown">X</csymbol>
     </cerror>
    </apply>
    <apply>
     <minus></minus>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>ùö∫</ci>
      <apply>
       <times></times>
       <ci>Y</ci>
       <ci>Y</ci>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>ùö∫</ci>
       <ci>ùëåùëã</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>ùö∫</ci>
        <ci>ùëãùëã</ci>
       </apply>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>ùö∫</ci>
       <ci>ùëãùëå</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \boldsymbol{\Sigma}_{Y|X}=\boldsymbol{\Sigma}_{YY}-\boldsymbol{\Sigma}_{%
\mathit{YX}}\boldsymbol{\Sigma}_{\mathit{XX}}^{-1}\boldsymbol{\Sigma}_{\mathit%
{XY}}.
  </annotation>
 </semantics>
</math>

</p>

<p>The matrix <strong>Œ£</strong><sub>YX</sub><strong>Œ£</strong><sub>XX</sub><sup>‚àí1</sup> is known as the matrix of <a href="regression_analysis" title="wikilink">regression</a> coefficients, while in linear algebra <strong>Œ£</strong><sub>Y|X</sub> is the <a href="Schur_complement" title="wikilink">Schur complement</a> of <strong>Œ£</strong><sub>XX</sub> in <strong>Œ£</strong><sub>X,Y</sub></p>

<p>The matrix of regression coefficients may often be given in transpose form, <strong>Œ£</strong><sub>XX</sub><sup>‚àí1</sup><strong>Œ£</strong><sub>XY</sub>, suitable for post-multiplying a row vector of explanatory variables <strong><em>x</em></strong><sup>T</sup> rather than pre-multiplying a column vector <strong><em>x</em></strong>. In this form they correspond to the coefficients obtained by inverting the matrix of the <a href="normal_equations" title="wikilink">normal equations</a> of <a href="ordinary_least_squares" title="wikilink">ordinary least squares</a> (OLS).</p>
<h2 id="as-a-linear-operator">As a linear operator</h2>

<p>Applied to one vector, the covariance matrix maps a linear combination, <strong>c</strong>, of the random variables, <strong>X</strong>, onto a vector of covariances with those variables

<math display="block" id="Covariance_matrix:61">
 <semantics>
  <mrow>
   <mrow>
    <msup>
     <mi>ùêú</mi>
     <mi mathvariant="normal">T</mi>
    </msup>
    <mi mathvariant="normal">Œ£</mi>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mo>cov</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <msup>
       <mi>ùêú</mi>
       <mi mathvariant="normal">T</mi>
      </msup>
      <mi>ùêó</mi>
     </mrow>
     <mo>,</mo>
     <mi>ùêó</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>ùêú</ci>
      <ci>normal-T</ci>
     </apply>
     <ci>normal-Œ£</ci>
    </apply>
    <apply>
     <ci>cov</ci>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>ùêú</ci>
       <ci>normal-T</ci>
      </apply>
      <ci>ùêó</ci>
     </apply>
     <ci>ùêó</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{c}^{\rm T}\Sigma=\operatorname{cov}(\mathbf{c}^{\rm T}\mathbf{X},%
\mathbf{X})
  </annotation>
 </semantics>
</math>

. Treated as a <a href="bilinear_form" title="wikilink">bilinear form</a>, it yields the covariance between the two linear combinations

<math display="block" id="Covariance_matrix:62">
 <semantics>
  <mrow>
   <mrow>
    <msup>
     <mi>ùêù</mi>
     <mi mathvariant="normal">T</mi>
    </msup>
    <mi mathvariant="normal">Œ£</mi>
    <mi>ùêú</mi>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mo>cov</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <msup>
       <mi>ùêù</mi>
       <mi mathvariant="normal">T</mi>
      </msup>
      <mi>ùêó</mi>
     </mrow>
     <mo>,</mo>
     <mrow>
      <msup>
       <mi>ùêú</mi>
       <mi mathvariant="normal">T</mi>
      </msup>
      <mi>ùêó</mi>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>ùêù</ci>
      <ci>normal-T</ci>
     </apply>
     <ci>normal-Œ£</ci>
     <ci>ùêú</ci>
    </apply>
    <apply>
     <ci>cov</ci>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>ùêù</ci>
       <ci>normal-T</ci>
      </apply>
      <ci>ùêó</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>ùêú</ci>
       <ci>normal-T</ci>
      </apply>
      <ci>ùêó</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{d}^{\rm T}\Sigma\mathbf{c}=\operatorname{cov}(\mathbf{d}^{\rm T}%
\mathbf{X},\mathbf{c}^{\rm T}\mathbf{X})
  </annotation>
 </semantics>
</math>

. The variance of a linear combination is then 

<math display="inline" id="Covariance_matrix:63">
 <semantics>
  <mrow>
   <msup>
    <mi>ùêú</mi>
    <mi mathvariant="normal">T</mi>
   </msup>
   <mi mathvariant="normal">Œ£</mi>
   <mi>ùêú</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>ùêú</ci>
     <ci>normal-T</ci>
    </apply>
    <ci>normal-Œ£</ci>
    <ci>ùêú</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{c}^{\rm T}\Sigma\mathbf{c}
  </annotation>
 </semantics>
</math>

, its covariance with itself.</p>

<p>Similarly, the (pseudo-)inverse covariance matrix provides an inner product, 

<math display="inline" id="Covariance_matrix:64">
 <semantics>
  <mrow>
   <mo stretchy="false">‚ü®</mo>
   <mrow>
    <mi>c</mi>
    <mo>-</mo>
    <mi>Œº</mi>
   </mrow>
   <mo fence="true" stretchy="false">|</mo>
   <msup>
    <mi mathvariant="normal">Œ£</mi>
    <mo>+</mo>
   </msup>
   <mo fence="true" stretchy="false">|</mo>
   <mrow>
    <mi>c</mi>
    <mo>-</mo>
    <mi>Œº</mi>
   </mrow>
   <mo stretchy="false">‚ü©</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">quantum-operator-product</csymbol>
    <apply>
     <minus></minus>
     <ci>c</ci>
     <ci>Œº</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>normal-Œ£</ci>
     <plus></plus>
    </apply>
    <apply>
     <minus></minus>
     <ci>c</ci>
     <ci>Œº</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \langle c-\mu|\Sigma^{+}|c-\mu\rangle
  </annotation>
 </semantics>
</math>

 which induces the <a href="Mahalanobis_distance" title="wikilink">Mahalanobis distance</a>, a measure of the "unlikelihood" of <em>c</em>.</p>
<h2 id="which-matrices-are-covariance-matrices">Which matrices are covariance matrices?</h2>

<p>From the identity just above, let 

<math display="inline" id="Covariance_matrix:65">
 <semantics>
  <mi>ùêõ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>ùêõ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{b}
  </annotation>
 </semantics>
</math>

 be a 

<math display="inline" id="Covariance_matrix:66">
 <semantics>
  <mrow>
   <mo stretchy="false">(</mo>
   <mrow>
    <mi>p</mi>
    <mo>√ó</mo>
    <mn>1</mn>
   </mrow>
   <mo stretchy="false">)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>p</ci>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (p\times 1)
  </annotation>
 </semantics>
</math>


 real-valued vector, then</p>

<p>

<math display="block" id="Covariance_matrix:67">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mo>var</mo>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <msup>
        <mi>ùêõ</mi>
        <mi mathvariant="normal">T</mi>
       </msup>
       <mi>ùêó</mi>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <msup>
      <mi>ùêõ</mi>
      <mi mathvariant="normal">T</mi>
     </msup>
     <mrow>
      <mrow>
       <mo>var</mo>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>ùêó</mi>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
      <mi>ùêõ</mi>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <ci>var</ci>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>ùêõ</ci>
       <ci>normal-T</ci>
      </apply>
      <ci>ùêó</ci>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>ùêõ</ci>
      <ci>normal-T</ci>
     </apply>
     <apply>
      <apply>
       <ci>var</ci>
       <ci>ùêó</ci>
      </apply>
      <ci>ùêõ</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \operatorname{var}(\mathbf{b}^{\rm T}\mathbf{X})=\mathbf{b}^{\rm T}%
\operatorname{var}(\mathbf{X})\mathbf{b},\,
  </annotation>
 </semantics>
</math>

</p>

<p>which must always be nonnegative since it is the <a href="variance#Properties" title="wikilink">variance</a> of a real-valued random variable. From the symmetry of the covariance matrix's definition it follows that only a <a href="positive-semidefinite_matrix" title="wikilink">positive-semidefinite matrix</a> can be a covariance matrix. Conversely, every symmetric positive semi-definite matrix is a covariance matrix. To see this, suppose <strong>M</strong> is a <em>p</em>√ó<em>p</em> positive-semidefinite matrix. From the finite-dimensional case of the <a href="spectral_theorem" title="wikilink">spectral theorem</a>, it follows that <strong>M</strong> has a nonnegative symmetric <a href="Square_root_of_a_matrix" title="wikilink">square root</a>, that can be denoted by <strong>M</strong><sup>1/2</sup>. Let 

<math display="inline" id="Covariance_matrix:68">
 <semantics>
  <mi>ùêó</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>ùêó</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{X}
  </annotation>
 </semantics>
</math>

 be any <em>p</em>√ó1 column vector-valued random variable whose covariance matrix is the <em>p</em>√ó<em>p</em> identity matrix. Then</p>

<p>

<math display="block" id="Covariance_matrix:69">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mo>var</mo>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <msup>
        <mi>ùêå</mi>
        <mrow>
         <mn>1</mn>
         <mo>/</mo>
         <mn>2</mn>
        </mrow>
       </msup>
       <mi>ùêó</mi>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <msup>
      <mi>ùêå</mi>
      <mrow>
       <mn>1</mn>
       <mo>/</mo>
       <mn>2</mn>
      </mrow>
     </msup>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mo>var</mo>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>ùêó</mi>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <msup>
      <mi>ùêå</mi>
      <mrow>
       <mn>1</mn>
       <mo>/</mo>
       <mn>2</mn>
      </mrow>
     </msup>
    </mrow>
    <mo>=</mo>
    <mi>ùêå</mi>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <ci>var</ci>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>ùêå</ci>
        <apply>
         <divide></divide>
         <cn type="integer">1</cn>
         <cn type="integer">2</cn>
        </apply>
       </apply>
       <ci>ùêó</ci>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>ùêå</ci>
       <apply>
        <divide></divide>
        <cn type="integer">1</cn>
        <cn type="integer">2</cn>
       </apply>
      </apply>
      <apply>
       <ci>var</ci>
       <ci>ùêó</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>ùêå</ci>
       <apply>
        <divide></divide>
        <cn type="integer">1</cn>
        <cn type="integer">2</cn>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <ci>ùêå</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \operatorname{var}(\mathbf{M}^{1/2}\mathbf{X})=\mathbf{M}^{1/2}(\operatorname{%
var}(\mathbf{X}))\mathbf{M}^{1/2}=\mathbf{M}.\,
  </annotation>
 </semantics>
</math>

</p>
<h2 id="how-to-find-a-valid-correlation-matrix">How to find a valid correlation matrix</h2>

<p>In some applications (e.g., building data models from only partially observed data) one wants to find the "nearest" correlation matrix to a given symmetric matrix (e.g., of observed covariances). In 2002, Higham<a class="footnoteRef" href="#fn5" id="fnref5"><sup>5</sup></a> formalized the notion of nearness using a weighted <a href="Frobenius_norm" title="wikilink">Frobenius norm</a> and provided a method for computing the nearest correlation matrix.</p>
<h2 id="complex-random-vectors">Complex random vectors</h2>

<p>The <a href="Variance#Generalizations" title="wikilink">variance</a> of a <a href="complex_number" title="wikilink">complex</a> scalar-valued random variable with expected value Œº is conventionally defined using <a href="complex_conjugation" title="wikilink">complex conjugation</a>:</p>

<p>

<math display="block" id="Covariance_matrix:70">
 <semantics>
  <mrow>
   <mrow>
    <mo>var</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>z</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mo>E</mo>
    <mrow>
     <mo>[</mo>
     <mrow>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mi>z</mi>
        <mo>-</mo>
        <mi>Œº</mi>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
      <msup>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mi>z</mi>
         <mo>-</mo>
         <mi>Œº</mi>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
       <mo>*</mo>
      </msup>
     </mrow>
     <mo>]</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <ci>var</ci>
     <ci>z</ci>
    </apply>
    <apply>
     <ci>normal-E</ci>
     <apply>
      <times></times>
      <apply>
       <minus></minus>
       <ci>z</ci>
       <ci>Œº</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <minus></minus>
        <ci>z</ci>
        <ci>Œº</ci>
       </apply>
       <times></times>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \operatorname{var}(z)=\operatorname{E}\left[(z-\mu)(z-\mu)^{*}\right]
  </annotation>
 </semantics>
</math>

</p>

<p>where the complex conjugate of a complex number 

<math display="inline" id="Covariance_matrix:71">
 <semantics>
  <mi>z</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>z</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   z
  </annotation>
 </semantics>
</math>

 is denoted 

<math display="inline" id="Covariance_matrix:72">
 <semantics>
  <msup>
   <mi>z</mi>
   <mo>*</mo>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>z</ci>
    <times></times>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   z^{*}
  </annotation>
 </semantics>
</math>

; thus the variance of a complex number is a real number.</p>

<p>If 

<math display="inline" id="Covariance_matrix:73">
 <semantics>
  <mi>Z</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>Z</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Z
  </annotation>
 </semantics>
</math>

 is a column-vector of complex-valued random variables, then the <a href="conjugate_transpose" title="wikilink">conjugate transpose</a> is formed by <em>both</em> transposing and conjugating. In the following expression, the product of a vector with its conjugate transpose results in a square matrix, as its expectation:</p>

<p>

<math display="block" id="Covariance_matrix:74">
 <semantics>
  <mrow>
   <mrow>
    <mo>E</mo>
    <mrow>
     <mo>[</mo>
     <mrow>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mi>Z</mi>
        <mo>-</mo>
        <mi>Œº</mi>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
      <msup>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mi>Z</mi>
         <mo>-</mo>
         <mi>Œº</mi>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
       <mo>‚Ä†</mo>
      </msup>
     </mrow>
     <mo>]</mo>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-E</ci>
    <apply>
     <times></times>
     <apply>
      <minus></minus>
      <ci>Z</ci>
      <ci>Œº</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <minus></minus>
       <ci>Z</ci>
       <ci>Œº</ci>
      </apply>
      <ci>normal-‚Ä†</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \operatorname{E}\left[(Z-\mu)(Z-\mu)^{\dagger}\right],
  </annotation>
 </semantics>
</math>

</p>

<p>where 

<math display="inline" id="Covariance_matrix:75">
 <semantics>
  <msup>
   <mi>Z</mi>
   <mo>‚Ä†</mo>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>Z</ci>
    <ci>normal-‚Ä†</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Z^{\dagger}
  </annotation>
 </semantics>
</math>

 denotes the conjugate transpose, which is applicable to the scalar case since the transpose of a scalar is still a scalar. The matrix so obtained will be <a href="Hermitian_matrix" title="wikilink">Hermitian</a> <a href="Positive-semidefinite_matrix" title="wikilink">positive-semidefinite</a>,<a class="footnoteRef" href="#fn6" id="fnref6"><sup>6</sup></a> with real numbers in the main diagonal and complex numbers off-diagonal.</p>
<h2 id="estimation">Estimation</h2>

<p>If 

<math display="inline" id="Covariance_matrix:76">
 <semantics>
  <msub>
   <mi>ùêå</mi>
   <mi>ùêó</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>ùêå</ci>
    <ci>ùêó</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{M}_{\mathbf{X}}
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Covariance_matrix:77">
 <semantics>
  <msub>
   <mi>ùêå</mi>
   <mi>ùêò</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>ùêå</ci>
    <ci>ùêò</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{M}_{\mathbf{Y}}
  </annotation>
 </semantics>
</math>

 are centred <a href="Data_matrix_(multivariate_statistics)" title="wikilink">data matrices</a> of dimension <em>n</em>-by-<em>p</em> and <em>n-by-q</em> respectively, i.e. with <em>n</em> rows of observations of <em>p</em> and <em>q</em> columns of variables, from which the column means have been subtracted, then, if the column means were estimated from the data, sample correlation matrices 

<math display="inline" id="Covariance_matrix:78">
 <semantics>
  <msub>
   <mi>ùêê</mi>
   <mi>ùêó</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>ùêê</ci>
    <ci>ùêó</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{Q}_{\mathbf{X}}
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Covariance_matrix:79">
 <semantics>
  <msub>
   <mi>ùêê</mi>
   <mi>ùêóùêò</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>ùêê</ci>
    <ci>ùêóùêò</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{Q}_{\mathbf{XY}}
  </annotation>
 </semantics>
</math>

 can be defined to be</p>

<p>

<math display="block" id="Covariance_matrix:80">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>ùêê</mi>
     <mi>ùêó</mi>
    </msub>
    <mo>=</mo>
    <mrow>
     <mfrac>
      <mn>1</mn>
      <mrow>
       <mi>n</mi>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
     </mfrac>
     <msubsup>
      <mi>ùêå</mi>
      <mi>ùêó</mi>
      <mi>T</mi>
     </msubsup>
     <msub>
      <mi>ùêå</mi>
      <mi>ùêó</mi>
     </msub>
    </mrow>
   </mrow>
   <mo rspace="22.5pt">,</mo>
   <mrow>
    <msub>
     <mi>ùêê</mi>
     <mi>ùêóùêò</mi>
    </msub>
    <mo>=</mo>
    <mrow>
     <mfrac>
      <mn>1</mn>
      <mrow>
       <mi>n</mi>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
     </mfrac>
     <msubsup>
      <mi>ùêå</mi>
      <mi>ùêó</mi>
      <mi>T</mi>
     </msubsup>
     <msub>
      <mi>ùêå</mi>
      <mi>ùêò</mi>
     </msub>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>ùêê</ci>
      <ci>ùêó</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <apply>
        <minus></minus>
        <ci>n</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>ùêå</ci>
        <ci>ùêó</ci>
       </apply>
       <ci>T</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>ùêå</ci>
       <ci>ùêó</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>ùêê</ci>
      <ci>ùêóùêò</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <apply>
        <minus></minus>
        <ci>n</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>ùêå</ci>
        <ci>ùêó</ci>
       </apply>
       <ci>T</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>ùêå</ci>
       <ci>ùêò</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{Q}_{\mathbf{X}}=\frac{1}{n-1}\mathbf{M}_{\mathbf{X}}^{T}\mathbf{M}_{%
\mathbf{X}},\qquad\mathbf{Q}_{\mathbf{XY}}=\frac{1}{n-1}\mathbf{M}_{\mathbf{X}%
}^{T}\mathbf{M}_{\mathbf{Y}}
  </annotation>
 </semantics>
</math>

 or, if the column means were known a-priori,</p>

<p>

<math display="block" id="Covariance_matrix:81">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>ùêê</mi>
     <mi>ùêó</mi>
    </msub>
    <mo>=</mo>
    <mrow>
     <mfrac>
      <mn>1</mn>
      <mi>n</mi>
     </mfrac>
     <msubsup>
      <mi>ùêå</mi>
      <mi>ùêó</mi>
      <mi>T</mi>
     </msubsup>
     <msub>
      <mi>ùêå</mi>
      <mi>ùêó</mi>
     </msub>
    </mrow>
   </mrow>
   <mo rspace="22.5pt">,</mo>
   <mrow>
    <msub>
     <mi>ùêê</mi>
     <mi>ùêóùêò</mi>
    </msub>
    <mo>=</mo>
    <mrow>
     <mfrac>
      <mn>1</mn>
      <mi>n</mi>
     </mfrac>
     <msubsup>
      <mi>ùêå</mi>
      <mi>ùêó</mi>
      <mi>T</mi>
     </msubsup>
     <msub>
      <mi>ùêå</mi>
      <mi>ùêò</mi>
     </msub>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>ùêê</ci>
      <ci>ùêó</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <ci>n</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>ùêå</ci>
        <ci>ùêó</ci>
       </apply>
       <ci>T</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>ùêå</ci>
       <ci>ùêó</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>ùêê</ci>
      <ci>ùêóùêò</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <ci>n</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>ùêå</ci>
        <ci>ùêó</ci>
       </apply>
       <ci>T</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>ùêå</ci>
       <ci>ùêò</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{Q}_{\mathbf{X}}=\frac{1}{n}\mathbf{M}_{\mathbf{X}}^{T}\mathbf{M}_{%
\mathbf{X}},\qquad\mathbf{Q}_{\mathbf{XY}}=\frac{1}{n}\mathbf{M}_{\mathbf{X}}^%
{T}\mathbf{M}_{\mathbf{Y}}
  </annotation>
 </semantics>
</math>

</p>

<p>These empirical sample correlation matrices are the most straightforward and most often used estimators for the correlation matrices, but other estimators also exist, including regularised or shrinkage estimators, which may have better properties.</p>
<h2 id="as-a-parameter-of-a-distribution">As a parameter of a distribution</h2>

<p>If a vector of <em>n</em> possibly correlated random variables is <a href="Multivariate_normal_distribution" title="wikilink">jointly normally distributed</a>, or more generally <a href="Elliptical_distribution" title="wikilink">elliptically distributed</a>, then its <a href="probability_density_function" title="wikilink">probability density function</a> can be expressed in terms of the covariance matrix.</p>
<h2 id="applications">Applications</h2>
<h3 id="in-financial-economics">In financial economics</h3>

<p>The covariance matrix plays a key role in <a href="financial_economics" title="wikilink">financial economics</a>, especially in <a href="Modern_portfolio_theory" title="wikilink">portfolio theory</a> and its <a href="mutual_fund_separation_theorem" title="wikilink">mutual fund separation theorem</a> and in the <a href="capital_asset_pricing_model" title="wikilink">capital asset pricing model</a>. The matrix of covariances among various assets' returns is used to determine, under certain assumptions, the relative amounts of different assets that investors should (in a <a href="Normative_economics" title="wikilink">normative analysis</a>) or are predicted to (in a <a href="Positive_economics" title="wikilink">positive analysis</a>) choose to hold in a context of <a href="Diversification_(finance)" title="wikilink">diversification</a>.</p>
<h2 id="see-also">See also</h2>
<ul>
<li><a href="Covariance_mapping" title="wikilink">Covariance mapping</a></li>
<li><a href="Multivariate_statistics" title="wikilink">Multivariate statistics</a></li>
<li><a href="Gramian_matrix" title="wikilink">Gramian matrix</a></li>
<li><a href="Eigenvalue_decomposition" title="wikilink">Eigenvalue decomposition</a></li>
<li><a href="Quadratic_form_(statistics)" title="wikilink">Quadratic form (statistics)</a></li>
</ul>
<h2 id="references">References</h2>
<h2 id="further-reading">Further reading</h2>
<ul>
<li></li>
<li></li>
<li></li>
</ul>

<p>"</p>

<p><a href="Category:Covariance_and_correlation" title="wikilink">Category:Covariance and correlation</a> <a class="uri" href="Category:Matrices" title="wikilink">Category:Matrices</a> <a href="Category:Summary_statistics" title="wikilink">Category:Summary statistics</a> <a href="Category:Data_analysis" title="wikilink">Category:Data analysis</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1"><a href="#fnref1">‚Ü©</a></li>
<li id="fn2"><a href="#fnref2">‚Ü©</a></li>
<li id="fn3"><a href="#fnref3">‚Ü©</a></li>
<li id="fn4"><a href="#fnref4">‚Ü©</a></li>
<li id="fn5"><a href="#fnref5">‚Ü©</a></li>
<li id="fn6"><a href="#fnref6">‚Ü©</a></li>
</ol>
</section>
</body>
</html>

<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="77">Lucas–Lehmer primality test</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Lucas–Lehmer primality test</h1>
<hr/>

<p>In <a class="uri" href="mathematics" title="wikilink">mathematics</a>, the <strong>Lucas–Lehmer test</strong> (<strong>LLT</strong>) is a <a href="primality_test" title="wikilink">primality test</a> for <a href="Mersenne_prime" title="wikilink">Mersenne numbers</a>. The test was originally developed by <a href="Édouard_Lucas" title="wikilink">Édouard Lucas</a> in 1856<a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a> and subsequently improved by Lucas in 1878 and <a href="Derrick_Henry_Lehmer" title="wikilink">Derrick Henry Lehmer</a> in the 1930s.</p>
<h2 id="the-test">The test</h2>

<p>The Lucas–Lehmer test works as follows. Let <em>M</em><sub><em>p</em></sub> = 2<sup><em>p</em></sup> − 1 be the Mersenne number to test with <em>p</em> an <a href="odd_prime" title="wikilink">odd prime</a>. The primality of <em>p</em> can be efficiently checked with a simple algorithm like <a href="trial_division" title="wikilink">trial division</a> since <em>p</em> is exponentially smaller than <em>M</em><sub><em>p</em></sub>. Define a sequence 

<math display="inline" id="Lucas–Lehmer_primality_test:0">
 <semantics>
  <mrow>
   <mo stretchy="false">{</mo>
   <msub>
    <mi>s</mi>
    <mi>i</mi>
   </msub>
   <mo stretchy="false">}</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <set>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>s</ci>
     <ci>i</ci>
    </apply>
   </set>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \{s_{i}\}
  </annotation>
 </semantics>
</math>

 for all <em>i</em> ≥ 0 by</p>

<p>

<math display="block" id="Lucas–Lehmer_primality_test:1">
 <semantics>
  <mrow>
   <msub>
    <mi>s</mi>
    <mi>i</mi>
   </msub>
   <mo>=</mo>
   <mrow>
    <mo>{</mo>
    <mtable displaystyle="true">
     <mtr>
      <mtd columnalign="left">
       <mn>4</mn>
      </mtd>
      <mtd columnalign="left">
       <mrow>
        <mrow>
         <mrow>
          <mtext>if</mtext>
          <mi>i</mi>
         </mrow>
         <mo>=</mo>
         <mn>0</mn>
        </mrow>
        <mo>;</mo>
       </mrow>
      </mtd>
     </mtr>
     <mtr>
      <mtd columnalign="left">
       <mrow>
        <msubsup>
         <mi>s</mi>
         <mrow>
          <mi>i</mi>
          <mo>-</mo>
          <mn>1</mn>
         </mrow>
         <mn>2</mn>
        </msubsup>
        <mo>-</mo>
        <mn>2</mn>
       </mrow>
      </mtd>
      <mtd columnalign="left">
       <mtext>otherwise.</mtext>
      </mtd>
     </mtr>
    </mtable>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>s</ci>
     <ci>i</ci>
    </apply>
    <apply>
     <csymbol cd="latexml">cases</csymbol>
     <cn type="integer">4</cn>
     <apply>
      <eq></eq>
      <apply>
       <times></times>
       <mtext>if</mtext>
       <ci>i</ci>
      </apply>
      <cn type="integer">0</cn>
     </apply>
     <apply>
      <minus></minus>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>s</ci>
        <apply>
         <minus></minus>
         <ci>i</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <cn type="integer">2</cn>
      </apply>
      <cn type="integer">2</cn>
     </apply>
     <mtext>otherwise.</mtext>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   s_{i}=\begin{cases}4&\text{if }i=0;\\
s_{i-1}^{2}-2&\text{otherwise.}\end{cases}
  </annotation>
 </semantics>
</math>

</p>

<p>The first few terms of this sequence are 4, 14, 194, 37634, ... . Then <em>M</em><sub><em>p</em></sub> is prime if and only if</p>

<p>

<math display="block" id="Lucas–Lehmer_primality_test:2">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>s</mi>
     <mrow>
      <mi>p</mi>
      <mo>-</mo>
      <mn>2</mn>
     </mrow>
    </msub>
    <mo>≡</mo>
    <mrow>
     <mn>0</mn>
     <mspace width="veryverythickmathspace">
     </mspace>
     <mrow>
      <mo lspace="8.1pt" stretchy="false">(</mo>
      <mrow>
       <mo>mod</mo>
       <msub>
        <mi>M</mi>
        <mi>p</mi>
       </msub>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <equivalent></equivalent>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>s</ci>
     <apply>
      <minus></minus>
      <ci>p</ci>
      <cn type="integer">2</cn>
     </apply>
    </apply>
    <apply>
     <csymbol cd="latexml">annotated</csymbol>
     <cn type="integer">0</cn>
     <apply>
      <ci>pmod</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>M</ci>
       <ci>p</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   s_{p-2}\equiv 0\;\;(\mathop{{\rm mod}}M_{p}).
  </annotation>
 </semantics>
</math>

 The number <em>s</em><sub><em>p</em> − 2</sub> mod <em>M</em><sub><em>p</em></sub> is called the <strong>Lucas–Lehmer residue</strong> of <em>p</em>. (Some authors equivalently set <em>s</em><sub>1</sub> = 4 and test <em>s</em><sub><em>p</em>−1</sub> mod <em>M</em><sub><em>p</em></sub>). In <a class="uri" href="pseudocode" title="wikilink">pseudocode</a>, the test might be written as</p>

<p><code>''// Determine if M</code><sub><em><code>p</code></em></sub><code> = 2</code><sup><em><code>p</code></em></sup><code> − 1 is prime</code><br/>
<strong><code>Lucas–Lehmer</code></strong><code>(p)</code><br/>
<code>    </code><strong><code>var</code></strong><code> s = 4</code><br/>
<code>    </code><strong><code>var</code></strong><code> M = 2</code><sup><em><code>p</code></em></sup><code> − 1</code><br/>
<code>    </code><strong><code>repeat</code></strong><code> p − 2 times:</code><br/>
<code>        s = ((s × s) − 2) mod M</code><br/>
<code>    </code><strong><code>if</code></strong><code> s = 0 </code><strong><code>return</code></strong><code> PRIME </code><strong><code>else</code></strong><code> </code><strong><code>return</code></strong><code> COMPOSITE</code></p>

<p>Performing the <code>mod M</code> at each iteration ensures that all intermediate results are at most <em>p</em> bits (otherwise the number of bits would double each iteration). The same strategy is used in <a href="modular_exponentiation" title="wikilink">modular exponentiation</a>.</p>
<h2 id="time-complexity">Time complexity</h2>

<p>In the algorithm as written above, there are two expensive operations during each iteration: the multiplication <code>s × s</code>, and the <code>mod M</code> operation. The <code>mod M</code> operation can be made particularly efficient on standard binary computers by observing that</p>

<p>

<math display="block" id="Lucas–Lehmer_primality_test:3">
 <semantics>
  <mrow>
   <mrow>
    <mi>k</mi>
    <mo>≡</mo>
    <mrow>
     <mrow>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mpadded width="+1.7pt">
         <mi>k</mi>
        </mpadded>
        <mo lspace="2.5pt" rspace="2.5pt">mod</mo>
        <msup>
         <mn>2</mn>
         <mi>n</mi>
        </msup>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
      <mo>+</mo>
      <mrow>
       <mo stretchy="false">⌊</mo>
       <mrow>
        <mi>k</mi>
        <mo>/</mo>
        <msup>
         <mn>2</mn>
         <mi>n</mi>
        </msup>
       </mrow>
       <mo stretchy="false">⌋</mo>
      </mrow>
     </mrow>
     <mspace width="veryverythickmathspace">
     </mspace>
     <mrow>
      <mo lspace="8.1pt" stretchy="false">(</mo>
      <mrow>
       <mo>mod</mo>
       <mrow>
        <msup>
         <mn>2</mn>
         <mi>n</mi>
        </msup>
        <mo>-</mo>
        <mn>1</mn>
       </mrow>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <equivalent></equivalent>
    <ci>k</ci>
    <apply>
     <csymbol cd="latexml">annotated</csymbol>
     <apply>
      <plus></plus>
      <apply>
       <csymbol cd="latexml">modulo</csymbol>
       <ci>k</ci>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <cn type="float">2</cn>
        <ci>n</ci>
       </apply>
      </apply>
      <apply>
       <floor></floor>
       <apply>
        <divide></divide>
        <ci>k</ci>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <cn type="integer">2</cn>
         <ci>n</ci>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <ci>pmod</ci>
      <apply>
       <minus></minus>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <cn type="integer">2</cn>
        <ci>n</ci>
       </apply>
       <cn type="integer">1</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   k\equiv(k\,\bmod\,2^{n})+\lfloor k/2^{n}\rfloor\;\;(\mathop{{\rm mod}}2^{n}-1).
  </annotation>
 </semantics>
</math>

</p>

<p>This says that the least significant <em>n</em> bits of <em>k</em> plus the remaining bits of <em>k</em> are equivalent to <em>k</em> modulo 2<sup><em>n</em></sup>−1. This equivalence can be used repeatedly until at most <em>n</em> bits remain. In this way, the remainder after dividing <em>k</em> by the Mersenne number 2<sup><em>n</em></sup>−1 is computed without using division. For example,</p>
<table>
<tbody>
<tr class="odd">
<td style="text-align: left;">
<p>916 mod 2<sup>5</sup>−1</p></td>
<td style="text-align: left;">
<p>=</p></td>
<td style="text-align: left;">
<p>1110010100<sub>2</sub> mod 2<sup>5</sup>−1</p></td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">
<p>=</p></td>
<td style="text-align: left;">
<p>11100<sub>2</sub> + 10100<sub>2</sub> mod 2<sup>5</sup>−1</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">
<p>=</p></td>
<td style="text-align: left;">
<p>110000<sub>2</sub> mod 2<sup>5</sup>−1</p></td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">
<p>=</p></td>
<td style="text-align: left;">
<p>1<sub>2</sub> + 10000<sub>2</sub> mod 2<sup>5</sup>−1</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">
<p>=</p></td>
<td style="text-align: left;">
<p>10001<sub>2</sub> mod 2<sup>5</sup>−1</p></td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">
<p>=</p></td>
<td style="text-align: left;">
<p>10001<sub>2</sub></p></td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">
<p>=</p></td>
<td style="text-align: left;">
<p>17.</p></td>
</tr>
</tbody>
</table>

<p>Moreover, since <code>s × s</code> will never exceed M<sup>2</sup> 2p, this simple technique converges in at most 1 <em>p</em>-bit addition (and possibly a carry from the <em>p</em>th bit to the 1st bit), which can be done in linear time. This algorithm has a small exceptional case. It will produce 2<sup><em>n</em></sup>−1 for a multiple of the modulus rather than the correct value of 0. However, this case is easy to detect and correct.</p>

<p>With the modulus out of the way, the asymptotic complexity of the algorithm only depends on the <a href="multiplication_algorithm" title="wikilink">multiplication algorithm</a> used to square <em>s</em> at each step. The simple "grade-school" algorithm for multiplication requires <a href="big_O_notation" title="wikilink">O</a>(<em>p</em><sup>2</sup>) bit-level or word-level operations to square a <em>p</em>-bit number. Since this happens O(<em>p</em>) times, the total time complexity is O(<em>p</em><sup>3</sup>). A more efficient multiplication algorithm is the <a href="Schönhage–Strassen_algorithm" title="wikilink">Schönhage–Strassen algorithm</a>, which is based on the <a href="Fast_Fourier_transform" title="wikilink">Fast Fourier transform</a>. It only requires O(<em>p</em> log <em>p</em> log log <em>p</em>) time to square a <em>p</em>-bit number. This reduces the complexity to O(<em>p</em><sup>2</sup> log <em>p</em> log log <em>p</em>) or Õ(<em>p</em><sup>2</sup>).<a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a> Currently the most efficient known multiplication algorithm, <a href="Fürer's_algorithm" title="wikilink">Fürer's algorithm</a>, only needs 

<math display="inline" id="Lucas–Lehmer_primality_test:4">
 <semantics>
  <mrow>
   <mi>p</mi>
   <mrow>
    <mi>log</mi>
    <mrow>
     <mi>p</mi>
     <msup>
      <mn>2</mn>
      <mrow>
       <mi>O</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <msup>
          <mi>log</mi>
          <mo>*</mo>
         </msup>
         <mi>p</mi>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
     </msup>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>p</ci>
    <apply>
     <log></log>
     <apply>
      <times></times>
      <ci>p</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <cn type="float">2</cn>
       <apply>
        <times></times>
        <ci>O</ci>
        <apply>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <log></log>
          <times></times>
         </apply>
         <ci>p</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p\log p\ 2^{O(\log^{*}p)}
  </annotation>
 </semantics>
</math>

 time to multiply two <em>p</em>-bit numbers.</p>

<p>By comparison, the most efficient randomized primality test for general integers, the <a href="Miller–Rabin_primality_test" title="wikilink">Miller–Rabin primality test</a>, requires O(<em>k</em> <em>n</em><sup>2</sup> log <em>n</em> log log <em>n</em>) bit operations using FFT multiplication for an <em>n</em>-digit number, where <em>k</em> is the number of iterations and is related to the error rate. For constant <em>k</em>, this is in the same complexity class as the Lucas-Lehmer test. In practice however, the cost of doing many iterations and other differences leads to worse performance for Miller–Rabin. The most efficient deterministic primality test for any <em>n</em>-digit number, the <a href="AKS_primality_test" title="wikilink">AKS primality test</a>, requires Õ(n<sup>6</sup>) bit operations in its best known variant and is dramatically slower in practice.</p>
<h2 id="examples">Examples</h2>

<p>The Mersenne number M<sub>3</sub> = 7 is prime. The Lucas–Lehmer test verifies this as follows. Initially <em>s</em> is set to 4 and then is updated 3−2 = 1 time:</p>
<ul>
<li>s ← ((4 × 4) − 2) mod 7 = 0.</li>
</ul>

<p>Since the final value of <em>s</em> is 0, the conclusion is that M<sub>3</sub> is prime.</p>

<p>On the other hand, M<sub>11</sub> = 2047 = 23 × 89 is not prime. Again, <em>s</em> is set to 4 but is now updated 11−2 = 9 times:</p>
<ul>
<li>s ← ((4 × 4) − 2) mod 2047 = 14</li>
<li>s ← ((14 × 14) − 2) mod 2047 = 194</li>
<li>s ← ((194 × 194) − 2) mod 2047 = 788</li>
<li>s ← ((788 × 788) − 2) mod 2047 = 701</li>
<li>s ← ((701 × 701) − 2) mod 2047 = 119</li>
<li>s ← ((119 × 119) − 2) mod 2047 = 1877</li>
<li>s ← ((1877 × 1877) − 2) mod 2047 = 240</li>
<li>s ← ((240 × 240) − 2) mod 2047 = 282</li>
<li>s ← ((282 × 282) − 2) mod 2047 = 1736</li>
</ul>

<p>Since the final value of <em>s</em> is not 0, the conclusion is that M<sub>11</sub> = 2047 is not prime. Although M<sub>11</sub> = 2047 has nontrivial factors, the Lucas–Lehmer test gives no indication about what they might be.</p>
<h2 id="proof-of-correctness">Proof of correctness</h2>

<p>The proof of correctness for this test presented here is simpler than the original proof given by Lehmer. Recall the definition</p>

<p>

<math display="block" id="Lucas–Lehmer_primality_test:5">
 <semantics>
  <mrow>
   <msub>
    <mi>s</mi>
    <mi>i</mi>
   </msub>
   <mo>=</mo>
   <mrow>
    <mo>{</mo>
    <mtable displaystyle="true">
     <mtr>
      <mtd columnalign="left">
       <mn>4</mn>
      </mtd>
      <mtd columnalign="left">
       <mrow>
        <mrow>
         <mrow>
          <mtext>if</mtext>
          <mi>i</mi>
         </mrow>
         <mo>=</mo>
         <mn>0</mn>
        </mrow>
        <mo>;</mo>
       </mrow>
      </mtd>
     </mtr>
     <mtr>
      <mtd columnalign="left">
       <mrow>
        <msubsup>
         <mi>s</mi>
         <mrow>
          <mi>i</mi>
          <mo>-</mo>
          <mn>1</mn>
         </mrow>
         <mn>2</mn>
        </msubsup>
        <mo>-</mo>
        <mn>2</mn>
       </mrow>
      </mtd>
      <mtd columnalign="left">
       <mtext>otherwise.</mtext>
      </mtd>
     </mtr>
    </mtable>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>s</ci>
     <ci>i</ci>
    </apply>
    <apply>
     <csymbol cd="latexml">cases</csymbol>
     <cn type="integer">4</cn>
     <apply>
      <eq></eq>
      <apply>
       <times></times>
       <mtext>if</mtext>
       <ci>i</ci>
      </apply>
      <cn type="integer">0</cn>
     </apply>
     <apply>
      <minus></minus>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>s</ci>
        <apply>
         <minus></minus>
         <ci>i</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <cn type="integer">2</cn>
      </apply>
      <cn type="integer">2</cn>
     </apply>
     <mtext>otherwise.</mtext>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   s_{i}=\begin{cases}4&\text{if }i=0;\\
s_{i-1}^{2}-2&\text{otherwise.}\end{cases}
  </annotation>
 </semantics>
</math>

 The goal is to show that <em>M</em><sub><em>p</em></sub> is prime <a class="uri" href="iff" title="wikilink">iff</a> 

<math display="inline" id="Lucas–Lehmer_primality_test:6">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>s</mi>
     <mrow>
      <mi>p</mi>
      <mo>-</mo>
      <mn>2</mn>
     </mrow>
    </msub>
    <mo>≡</mo>
    <mrow>
     <mn>0</mn>
     <mspace width="veryverythickmathspace">
     </mspace>
     <mrow>
      <mo lspace="8.1pt" stretchy="false">(</mo>
      <mrow>
       <mo>mod</mo>
       <msub>
        <mi>M</mi>
        <mi>p</mi>
       </msub>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <equivalent></equivalent>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>s</ci>
     <apply>
      <minus></minus>
      <ci>p</ci>
      <cn type="integer">2</cn>
     </apply>
    </apply>
    <apply>
     <csymbol cd="latexml">annotated</csymbol>
     <cn type="integer">0</cn>
     <apply>
      <ci>pmod</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>M</ci>
       <ci>p</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   s_{p-2}\equiv 0\;\;(\mathop{{\rm mod}}M_{p}).
  </annotation>
 </semantics>
</math>

</p>

<p>The sequence 

<math display="inline" id="Lucas–Lehmer_primality_test:7">
 <semantics>
  <mrow>
   <mo stretchy="false">⟨</mo>
   <msub>
    <mi>s</mi>
    <mi>i</mi>
   </msub>
   <mo stretchy="false">⟩</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">delimited-⟨⟩</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>s</ci>
     <ci>i</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   {\langle}s_{i}{\rangle}
  </annotation>
 </semantics>
</math>

 is a <a href="recurrence_relation" title="wikilink">recurrence relation</a> with a <a href="closed-form_solution" title="wikilink">closed-form solution</a>. Let 

<math display="inline" id="Lucas–Lehmer_primality_test:8">
 <semantics>
  <mrow>
   <mi>ω</mi>
   <mo>=</mo>
   <mrow>
    <mn>2</mn>
    <mo>+</mo>
    <msqrt>
     <mn>3</mn>
    </msqrt>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>ω</ci>
    <apply>
     <plus></plus>
     <cn type="integer">2</cn>
     <apply>
      <root></root>
      <cn type="integer">3</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \omega=2+\sqrt{3}
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Lucas–Lehmer_primality_test:9">
 <semantics>
  <mrow>
   <mover accent="true">
    <mi>ω</mi>
    <mo stretchy="false">¯</mo>
   </mover>
   <mo>=</mo>
   <mrow>
    <mn>2</mn>
    <mo>-</mo>
    <msqrt>
     <mn>3</mn>
    </msqrt>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <ci>normal-¯</ci>
     <ci>ω</ci>
    </apply>
    <apply>
     <minus></minus>
     <cn type="integer">2</cn>
     <apply>
      <root></root>
      <cn type="integer">3</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \bar{\omega}=2-\sqrt{3}
  </annotation>
 </semantics>
</math>

. It then follows by <a href="mathematical_induction" title="wikilink">induction</a> that 

<math display="inline" id="Lucas–Lehmer_primality_test:10">
 <semantics>
  <mrow>
   <msub>
    <mi>s</mi>
    <mi>i</mi>
   </msub>
   <mo>=</mo>
   <mrow>
    <msup>
     <mi>ω</mi>
     <msup>
      <mn>2</mn>
      <mi>i</mi>
     </msup>
    </msup>
    <mo>+</mo>
    <msup>
     <mover accent="true">
      <mi>ω</mi>
      <mo stretchy="false">¯</mo>
     </mover>
     <msup>
      <mn>2</mn>
      <mi>i</mi>
     </msup>
    </msup>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>s</ci>
     <ci>i</ci>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>ω</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <cn type="integer">2</cn>
       <ci>i</ci>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <ci>normal-¯</ci>
       <ci>ω</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <cn type="integer">2</cn>
       <ci>i</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   s_{i}=\omega^{2^{i}}+\bar{\omega}^{2^{i}}
  </annotation>
 </semantics>
</math>

 for all <em>i</em>:</p>

<p>

<math display="block" id="Lucas–Lehmer_primality_test:11">
 <semantics>
  <mrow>
   <msub>
    <mi>s</mi>
    <mn>0</mn>
   </msub>
   <mo>=</mo>
   <mrow>
    <msup>
     <mi>ω</mi>
     <msup>
      <mn>2</mn>
      <mn>0</mn>
     </msup>
    </msup>
    <mo>+</mo>
    <msup>
     <mover accent="true">
      <mi>ω</mi>
      <mo stretchy="false">¯</mo>
     </mover>
     <msup>
      <mn>2</mn>
      <mn>0</mn>
     </msup>
    </msup>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mo>(</mo>
     <mrow>
      <mn>2</mn>
      <mo>+</mo>
      <msqrt>
       <mn>3</mn>
      </msqrt>
     </mrow>
     <mo>)</mo>
    </mrow>
    <mo>+</mo>
    <mrow>
     <mo>(</mo>
     <mrow>
      <mn>2</mn>
      <mo>-</mo>
      <msqrt>
       <mn>3</mn>
      </msqrt>
     </mrow>
     <mo>)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mn>4</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>s</ci>
      <cn type="integer">0</cn>
     </apply>
     <apply>
      <plus></plus>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>ω</ci>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <cn type="integer">2</cn>
        <cn type="integer">0</cn>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <ci>normal-¯</ci>
        <ci>ω</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <cn type="integer">2</cn>
        <cn type="integer">0</cn>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <plus></plus>
      <apply>
       <plus></plus>
       <cn type="integer">2</cn>
       <apply>
        <root></root>
        <cn type="integer">3</cn>
       </apply>
      </apply>
      <apply>
       <minus></minus>
       <cn type="integer">2</cn>
       <apply>
        <root></root>
        <cn type="integer">3</cn>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <cn type="integer">4</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   s_{0}=\omega^{2^{0}}+\bar{\omega}^{2^{0}}=\left(2+\sqrt{3}\right)+\left(2-%
\sqrt{3}\right)=4
  </annotation>
 </semantics>
</math>

 and</p>

<p>

<math display="inline" id="Lucas–Lehmer_primality_test:12">
 <semantics>
  <msub>
   <mi>s</mi>
   <mi>n</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>s</ci>
    <ci>n</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle s_{n}
  </annotation>
 </semantics>
</math>


 The last step uses 

<math display="inline" id="Lucas–Lehmer_primality_test:13">
 <semantics>
  <mrow>
   <mrow>
    <mi>ω</mi>
    <mover accent="true">
     <mi>ω</mi>
     <mo stretchy="false">¯</mo>
    </mover>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mo>(</mo>
     <mrow>
      <mn>2</mn>
      <mo>+</mo>
      <msqrt>
       <mn>3</mn>
      </msqrt>
     </mrow>
     <mo>)</mo>
    </mrow>
    <mrow>
     <mo>(</mo>
     <mrow>
      <mn>2</mn>
      <mo>-</mo>
      <msqrt>
       <mn>3</mn>
      </msqrt>
     </mrow>
     <mo>)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mn>1.</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <times></times>
      <ci>ω</ci>
      <apply>
       <ci>normal-¯</ci>
       <ci>ω</ci>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <plus></plus>
       <cn type="integer">2</cn>
       <apply>
        <root></root>
        <cn type="integer">3</cn>
       </apply>
      </apply>
      <apply>
       <minus></minus>
       <cn type="integer">2</cn>
       <apply>
        <root></root>
        <cn type="integer">3</cn>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <cn type="float">1.</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \omega\bar{\omega}=\left(2+\sqrt{3}\right)\left(2-\sqrt{3}\right)=1.
  </annotation>
 </semantics>
</math>

 This closed form is used in both the proof of sufficiency and the proof of necessity.</p>
<h3 id="sufficiency">Sufficiency</h3>

<p>The goal is to show that 

<math display="inline" id="Lucas–Lehmer_primality_test:14">
 <semantics>
  <mrow>
   <msub>
    <mi>s</mi>
    <mrow>
     <mi>p</mi>
     <mo>-</mo>
     <mn>2</mn>
    </mrow>
   </msub>
   <mo>≡</mo>
   <mrow>
    <mn>0</mn>
    <mspace width="veryverythickmathspace">
    </mspace>
    <mrow>
     <mo lspace="8.1pt" stretchy="false">(</mo>
     <mrow>
      <mo>mod</mo>
      <msub>
       <mi>M</mi>
       <mi>p</mi>
      </msub>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <equivalent></equivalent>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>s</ci>
     <apply>
      <minus></minus>
      <ci>p</ci>
      <cn type="integer">2</cn>
     </apply>
    </apply>
    <apply>
     <csymbol cd="latexml">annotated</csymbol>
     <cn type="integer">0</cn>
     <apply>
      <ci>pmod</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>M</ci>
       <ci>p</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   s_{p-2}\equiv 0\;\;(\mathop{{\rm mod}}M_{p})
  </annotation>
 </semantics>
</math>

 implies that 

<math display="inline" id="Lucas–Lehmer_primality_test:15">
 <semantics>
  <msub>
   <mi>M</mi>
   <mi>p</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>M</ci>
    <ci>p</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   M_{p}
  </annotation>
 </semantics>
</math>

 is prime. What follows is a straightforward proof exploiting elementary <a href="group_theory" title="wikilink">group theory</a> given by J. W. Bruce<a class="footnoteRef" href="#fn3" id="fnref3"><sup>3</sup></a> as related by Jason Wojciechowski.<a class="footnoteRef" href="#fn4" id="fnref4"><sup>4</sup></a></p>

<p>Suppose 

<math display="inline" id="Lucas–Lehmer_primality_test:16">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>s</mi>
     <mrow>
      <mi>p</mi>
      <mo>-</mo>
      <mn>2</mn>
     </mrow>
    </msub>
    <mo>≡</mo>
    <mrow>
     <mn>0</mn>
     <mspace width="veryverythickmathspace">
     </mspace>
     <mrow>
      <mo lspace="8.1pt" stretchy="false">(</mo>
      <mrow>
       <mo>mod</mo>
       <msub>
        <mi>M</mi>
        <mi>p</mi>
       </msub>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <equivalent></equivalent>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>s</ci>
     <apply>
      <minus></minus>
      <ci>p</ci>
      <cn type="integer">2</cn>
     </apply>
    </apply>
    <apply>
     <csymbol cd="latexml">annotated</csymbol>
     <cn type="integer">0</cn>
     <apply>
      <ci>pmod</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>M</ci>
       <ci>p</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   s_{p-2}\equiv 0\;\;(\mathop{{\rm mod}}M_{p}).
  </annotation>
 </semantics>
</math>

 Then</p>

<p>

<math display="block" id="Lucas–Lehmer_primality_test:17">
 <semantics>
  <mrow>
   <mrow>
    <msup>
     <mi>ω</mi>
     <msup>
      <mn>2</mn>
      <mrow>
       <mi>p</mi>
       <mo>-</mo>
       <mn>2</mn>
      </mrow>
     </msup>
    </msup>
    <mo>+</mo>
    <msup>
     <mover accent="true">
      <mi>ω</mi>
      <mo stretchy="false">¯</mo>
     </mover>
     <msup>
      <mn>2</mn>
      <mrow>
       <mi>p</mi>
       <mo>-</mo>
       <mn>2</mn>
      </mrow>
     </msup>
    </msup>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mi>k</mi>
    <msub>
     <mi>M</mi>
     <mi>p</mi>
    </msub>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <plus></plus>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>ω</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <cn type="integer">2</cn>
       <apply>
        <minus></minus>
        <ci>p</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <ci>normal-¯</ci>
       <ci>ω</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <cn type="integer">2</cn>
       <apply>
        <minus></minus>
        <ci>p</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <times></times>
     <ci>k</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>M</ci>
      <ci>p</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \omega^{2^{p-2}}+\bar{\omega}^{2^{p-2}}=kM_{p}
  </annotation>
 </semantics>
</math>

 for some integer <em>k</em>, so</p>

<p>

<math display="block" id="Lucas–Lehmer_primality_test:18">
 <semantics>
  <mrow>
   <mrow>
    <msup>
     <mi>ω</mi>
     <msup>
      <mn>2</mn>
      <mrow>
       <mi>p</mi>
       <mo>-</mo>
       <mn>2</mn>
      </mrow>
     </msup>
    </msup>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mi>k</mi>
      <msub>
       <mi>M</mi>
       <mi>p</mi>
      </msub>
     </mrow>
     <mo>-</mo>
     <msup>
      <mover accent="true">
       <mi>ω</mi>
       <mo stretchy="false">¯</mo>
      </mover>
      <msup>
       <mn>2</mn>
       <mrow>
        <mi>p</mi>
        <mo>-</mo>
        <mn>2</mn>
       </mrow>
      </msup>
     </msup>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>ω</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <cn type="integer">2</cn>
      <apply>
       <minus></minus>
       <ci>p</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
    <apply>
     <minus></minus>
     <apply>
      <times></times>
      <ci>k</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>M</ci>
       <ci>p</ci>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <ci>normal-¯</ci>
       <ci>ω</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <cn type="integer">2</cn>
       <apply>
        <minus></minus>
        <ci>p</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \omega^{2^{p-2}}=kM_{p}-\bar{\omega}^{2^{p-2}}.
  </annotation>
 </semantics>
</math>

 Multiplying by 

<math display="inline" id="Lucas–Lehmer_primality_test:19">
 <semantics>
  <msup>
   <mi>ω</mi>
   <msup>
    <mn>2</mn>
    <mrow>
     <mi>p</mi>
     <mo>-</mo>
     <mn>2</mn>
    </mrow>
   </msup>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>ω</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <cn type="integer">2</cn>
     <apply>
      <minus></minus>
      <ci>p</ci>
      <cn type="integer">2</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \omega^{2^{p-2}}
  </annotation>
 </semantics>
</math>

 gives</p>

<p>

<math display="block" id="Lucas–Lehmer_primality_test:20">
 <semantics>
  <mrow>
   <mrow>
    <msup>
     <mrow>
      <mo>(</mo>
      <msup>
       <mi>ω</mi>
       <msup>
        <mn>2</mn>
        <mrow>
         <mi>p</mi>
         <mo>-</mo>
         <mn>2</mn>
        </mrow>
       </msup>
      </msup>
      <mo>)</mo>
     </mrow>
     <mn>2</mn>
    </msup>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mi>k</mi>
      <msub>
       <mi>M</mi>
       <mi>p</mi>
      </msub>
      <msup>
       <mi>ω</mi>
       <msup>
        <mn>2</mn>
        <mrow>
         <mi>p</mi>
         <mo>-</mo>
         <mn>2</mn>
        </mrow>
       </msup>
      </msup>
     </mrow>
     <mo>-</mo>
     <msup>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mi>ω</mi>
        <mover accent="true">
         <mi>ω</mi>
         <mo stretchy="false">¯</mo>
        </mover>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
      <msup>
       <mn>2</mn>
       <mrow>
        <mi>p</mi>
        <mo>-</mo>
        <mn>2</mn>
       </mrow>
      </msup>
     </msup>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>ω</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <cn type="integer">2</cn>
       <apply>
        <minus></minus>
        <ci>p</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
     </apply>
     <cn type="integer">2</cn>
    </apply>
    <apply>
     <minus></minus>
     <apply>
      <times></times>
      <ci>k</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>M</ci>
       <ci>p</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>ω</ci>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <cn type="integer">2</cn>
        <apply>
         <minus></minus>
         <ci>p</ci>
         <cn type="integer">2</cn>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <times></times>
       <ci>ω</ci>
       <apply>
        <ci>normal-¯</ci>
        <ci>ω</ci>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <cn type="integer">2</cn>
       <apply>
        <minus></minus>
        <ci>p</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \left(\omega^{2^{p-2}}\right)^{2}=kM_{p}\omega^{2^{p-2}}-(\omega\bar{\omega})^%
{2^{p-2}}.
  </annotation>
 </semantics>
</math>

 Thus,</p>

<p>

<math display="block" id="Lucas–Lehmer_primality_test:21">
 <semantics>
  <mrow>
   <msup>
    <mi>ω</mi>
    <msup>
     <mn>2</mn>
     <mrow>
      <mi>p</mi>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </msup>
   </msup>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mrow>
      <mi>k</mi>
      <msub>
       <mi>M</mi>
       <mi>p</mi>
      </msub>
      <msup>
       <mi>ω</mi>
       <msup>
        <mn>2</mn>
        <mrow>
         <mi>p</mi>
         <mo>-</mo>
         <mn>2</mn>
        </mrow>
       </msup>
      </msup>
     </mrow>
     <mo>-</mo>
     <mn>1.</mn>
    </mrow>
    <mrow>
     <mo stretchy="false">(</mo>
     <mn>1</mn>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>ω</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <cn type="integer">2</cn>
      <apply>
       <minus></minus>
       <ci>p</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
    </apply>
    <list>
     <apply>
      <minus></minus>
      <apply>
       <times></times>
       <ci>k</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>M</ci>
        <ci>p</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>ω</ci>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <cn type="integer">2</cn>
         <apply>
          <minus></minus>
          <ci>p</ci>
          <cn type="integer">2</cn>
         </apply>
        </apply>
       </apply>
      </apply>
      <cn type="float">1.</cn>
     </apply>
     <cn type="integer">1</cn>
    </list>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \omega^{2^{p-1}}=kM_{p}\omega^{2^{p-2}}-1.\qquad\qquad(1)
  </annotation>
 </semantics>
</math>

</p>

<p>For a contradiction, suppose <em>M</em><sub><em>p</em></sub> is composite, and let <em>q</em> be the smallest prime factor of <em>M</em><sub><em>p</em></sub>. Mersenne numbers are odd, so <em>q</em> &gt; 2. Informally,<a class="footnoteRef" href="#fn5" id="fnref5"><sup>5</sup></a> let 

<math display="inline" id="Lucas–Lehmer_primality_test:22">
 <semantics>
  <msub>
   <mi>ℤ</mi>
   <mi>q</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>ℤ</ci>
    <ci>q</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbb{Z}_{q}
  </annotation>
 </semantics>
</math>

 be the integers modulo <em>q</em>, and let 

<math display="inline" id="Lucas–Lehmer_primality_test:23">
 <semantics>
  <mrow>
   <mrow>
    <mi>X</mi>
    <mo>=</mo>
    <mrow>
     <mo>{</mo>
     <mrow>
      <mi>a</mi>
      <mo>+</mo>
      <mrow>
       <mi>b</mi>
       <msqrt>
        <mn>3</mn>
       </msqrt>
      </mrow>
     </mrow>
     <mo>∣</mo>
     <mrow>
      <mrow>
       <mi>a</mi>
       <mo>,</mo>
       <mi>b</mi>
      </mrow>
      <mo>∈</mo>
      <msub>
       <mi>ℤ</mi>
       <mi>q</mi>
      </msub>
     </mrow>
     <mo>}</mo>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>X</ci>
    <apply>
     <csymbol cd="latexml">conditional-set</csymbol>
     <apply>
      <plus></plus>
      <ci>a</ci>
      <apply>
       <times></times>
       <ci>b</ci>
       <apply>
        <root></root>
        <cn type="integer">3</cn>
       </apply>
      </apply>
     </apply>
     <apply>
      <in></in>
      <list>
       <ci>a</ci>
       <ci>b</ci>
      </list>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>ℤ</ci>
       <ci>q</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   X=\left\{a+b\sqrt{3}\mid a,b\in\mathbb{Z}_{q}\right\}.
  </annotation>
 </semantics>
</math>

 Multiplication in 

<math display="inline" id="Lucas–Lehmer_primality_test:24">
 <semantics>
  <mi>X</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>X</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   X
  </annotation>
 </semantics>
</math>

 is defined as</p>

<p>

<math display="block" id="Lucas–Lehmer_primality_test:25">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mrow>
      <mo>(</mo>
      <mrow>
       <mi>a</mi>
       <mo>+</mo>
       <mrow>
        <msqrt>
         <mn>3</mn>
        </msqrt>
        <mi>b</mi>
       </mrow>
      </mrow>
      <mo>)</mo>
     </mrow>
     <mrow>
      <mo>(</mo>
      <mrow>
       <mi>c</mi>
       <mo>+</mo>
       <mrow>
        <msqrt>
         <mn>3</mn>
        </msqrt>
        <mi>d</mi>
       </mrow>
      </mrow>
      <mo>)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mo stretchy="false">[</mo>
      <mrow>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mrow>
          <mi>a</mi>
          <mi>c</mi>
         </mrow>
         <mo>+</mo>
         <mrow>
          <mn>3</mn>
          <mi>b</mi>
          <mi>d</mi>
         </mrow>
        </mrow>
        <mo rspace="4.2pt" stretchy="false">)</mo>
       </mrow>
       <mo lspace="2.5pt" rspace="4.2pt">mod</mo>
       <mi>q</mi>
      </mrow>
      <mo stretchy="false">]</mo>
     </mrow>
     <mo>+</mo>
     <mrow>
      <msqrt>
       <mn>3</mn>
      </msqrt>
      <mrow>
       <mo stretchy="false">[</mo>
       <mrow>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <mrow>
           <mi>a</mi>
           <mi>d</mi>
          </mrow>
          <mo>+</mo>
          <mrow>
           <mi>b</mi>
           <mi>c</mi>
          </mrow>
         </mrow>
         <mo rspace="4.2pt" stretchy="false">)</mo>
        </mrow>
        <mo lspace="2.5pt" rspace="4.2pt">mod</mo>
        <mi>q</mi>
       </mrow>
       <mo stretchy="false">]</mo>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <plus></plus>
      <ci>a</ci>
      <apply>
       <times></times>
       <apply>
        <root></root>
        <cn type="integer">3</cn>
       </apply>
       <ci>b</ci>
      </apply>
     </apply>
     <apply>
      <plus></plus>
      <ci>c</ci>
      <apply>
       <times></times>
       <apply>
        <root></root>
        <cn type="integer">3</cn>
       </apply>
       <ci>d</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <csymbol cd="latexml">delimited-[]</csymbol>
      <apply>
       <csymbol cd="latexml">modulo</csymbol>
       <apply>
        <plus></plus>
        <apply>
         <times></times>
         <ci>a</ci>
         <ci>c</ci>
        </apply>
        <apply>
         <times></times>
         <cn type="integer">3</cn>
         <ci>b</ci>
         <ci>d</ci>
        </apply>
       </apply>
       <ci>q</ci>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <root></root>
       <cn type="integer">3</cn>
      </apply>
      <apply>
       <csymbol cd="latexml">delimited-[]</csymbol>
       <apply>
        <csymbol cd="latexml">modulo</csymbol>
        <apply>
         <plus></plus>
         <apply>
          <times></times>
          <ci>a</ci>
          <ci>d</ci>
         </apply>
         <apply>
          <times></times>
          <ci>b</ci>
          <ci>c</ci>
         </apply>
        </apply>
        <ci>q</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \left(a+\sqrt{3}b\right)\left(c+\sqrt{3}d\right)=[(ac+3bd)\,\bmod\,q]+\sqrt{3}%
[(ad+bc)\,\bmod\,q].
  </annotation>
 </semantics>
</math>

</p>

<p>Clearly, this multiplication is closed, i.e. the product of numbers from <em>X</em> is itself in <em>X</em>. The size of <em>X</em> is denoted by 

<math display="inline" id="Lucas–Lehmer_primality_test:26">
 <semantics>
  <mrow>
   <mrow>
    <mo stretchy="false">|</mo>
    <mi>X</mi>
    <mo stretchy="false">|</mo>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <abs></abs>
    <ci>X</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   |X|.
  </annotation>
 </semantics>
</math>

</p>

<p>Since <em>q</em> &gt; 2, it follows that 

<math display="inline" id="Lucas–Lehmer_primality_test:27">
 <semantics>
  <mi>ω</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>ω</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \omega
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Lucas–Lehmer_primality_test:28">
 <semantics>
  <mover accent="true">
   <mi>ω</mi>
   <mo stretchy="false">¯</mo>
  </mover>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-¯</ci>
    <ci>ω</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \bar{\omega}
  </annotation>
 </semantics>
</math>

 are in <em>X</em>.<a class="footnoteRef" href="#fn6" id="fnref6"><sup>6</sup></a> The subset of elements in <em>X</em> with inverses forms a group, which is denoted by <em>X</em>* and has size 

<math display="inline" id="Lucas–Lehmer_primality_test:29">
 <semantics>
  <mrow>
   <mrow>
    <mo stretchy="false">|</mo>
    <msup>
     <mi>X</mi>
     <mo>*</mo>
    </msup>
    <mo stretchy="false">|</mo>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <abs></abs>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>X</ci>
     <times></times>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   |X^{*}|.
  </annotation>
 </semantics>
</math>

 One element in <em>X</em> that does not have an inverse is 0, so 

<math display="inline" id="Lucas–Lehmer_primality_test:30">
 <semantics>
  <mrow>
   <mrow>
    <mo stretchy="false">|</mo>
    <msup>
     <mi>X</mi>
     <mo>*</mo>
    </msup>
    <mo stretchy="false">|</mo>
   </mrow>
   <mo>≤</mo>
   <mrow>
    <mrow>
     <mo stretchy="false">|</mo>
     <mi>X</mi>
     <mo stretchy="false">|</mo>
    </mrow>
    <mo>-</mo>
    <mn>1</mn>
   </mrow>
   <mo>=</mo>
   <mrow>
    <msup>
     <mi>q</mi>
     <mn>2</mn>
    </msup>
    <mo>-</mo>
    <mn>1.</mn>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <leq></leq>
     <apply>
      <abs></abs>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>X</ci>
       <times></times>
      </apply>
     </apply>
     <apply>
      <minus></minus>
      <apply>
       <abs></abs>
       <ci>X</ci>
      </apply>
      <cn type="integer">1</cn>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <minus></minus>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>q</ci>
       <cn type="integer">2</cn>
      </apply>
      <cn type="float">1.</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   |X^{*}|\leq|X|-1=q^{2}-1.
  </annotation>
 </semantics>
</math>

</p>

<p>Now 

<math display="inline" id="Lucas–Lehmer_primality_test:31">
 <semantics>
  <mrow>
   <msub>
    <mi>M</mi>
    <mi>p</mi>
   </msub>
   <mo>≡</mo>
   <mrow>
    <mn>0</mn>
    <mspace width="veryverythickmathspace">
    </mspace>
    <mrow>
     <mo lspace="8.1pt" stretchy="false">(</mo>
     <mrow>
      <mo>mod</mo>
      <mi>q</mi>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <equivalent></equivalent>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>M</ci>
     <ci>p</ci>
    </apply>
    <apply>
     <csymbol cd="latexml">annotated</csymbol>
     <cn type="integer">0</cn>
     <apply>
      <ci>pmod</ci>
      <ci>q</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   M_{p}\equiv 0\;\;(\mathop{{\rm mod}}q)
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Lucas–Lehmer_primality_test:32">
 <semantics>
  <mrow>
   <mi>ω</mi>
   <mo>∈</mo>
   <mi>X</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <in></in>
    <ci>ω</ci>
    <ci>X</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \omega\in X
  </annotation>
 </semantics>
</math>

, so</p>

<p>

<math display="block" id="Lucas–Lehmer_primality_test:33">
 <semantics>
  <mrow>
   <mrow>
    <mi>k</mi>
    <msub>
     <mi>M</mi>
     <mi>p</mi>
    </msub>
    <msup>
     <mi>ω</mi>
     <msup>
      <mn>2</mn>
      <mrow>
       <mi>p</mi>
       <mo>-</mo>
       <mn>2</mn>
      </mrow>
     </msup>
    </msup>
   </mrow>
   <mo>=</mo>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>k</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>M</ci>
      <ci>p</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>ω</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <cn type="integer">2</cn>
       <apply>
        <minus></minus>
        <ci>p</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
     </apply>
    </apply>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   kM_{p}\omega^{2^{p-2}}=0
  </annotation>
 </semantics>
</math>

 in <em>X</em>. Then by equation (1),</p>

<p>

<math display="block" id="Lucas–Lehmer_primality_test:34">
 <semantics>
  <mrow>
   <msup>
    <mi>ω</mi>
    <msup>
     <mn>2</mn>
     <mrow>
      <mi>p</mi>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </msup>
   </msup>
   <mo>=</mo>
   <mrow>
    <mo>-</mo>
    <mn>1</mn>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>ω</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <cn type="integer">2</cn>
      <apply>
       <minus></minus>
       <ci>p</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
    </apply>
    <apply>
     <minus></minus>
     <cn type="integer">1</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \omega^{2^{p-1}}=-1
  </annotation>
 </semantics>
</math>

 in <em>X</em>, and squaring both sides gives</p>

<p>

<math display="block" id="Lucas–Lehmer_primality_test:35">
 <semantics>
  <mrow>
   <msup>
    <mi>ω</mi>
    <msup>
     <mn>2</mn>
     <mi>p</mi>
    </msup>
   </msup>
   <mo>=</mo>
   <mn>1.</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>ω</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <cn type="integer">2</cn>
      <ci>p</ci>
     </apply>
    </apply>
    <cn type="float">1.</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \omega^{2^{p}}=1.
  </annotation>
 </semantics>
</math>

 Thus 

<math display="inline" id="Lucas–Lehmer_primality_test:36">
 <semantics>
  <mi>ω</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>ω</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \omega
  </annotation>
 </semantics>
</math>

 lies in <em>X</em>* and has inverse 

<math display="inline" id="Lucas–Lehmer_primality_test:37">
 <semantics>
  <mrow>
   <msup>
    <mi>ω</mi>
    <mrow>
     <msup>
      <mn>2</mn>
      <mi>p</mi>
     </msup>
     <mo>-</mo>
     <mn>1</mn>
    </mrow>
   </msup>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>ω</ci>
    <apply>
     <minus></minus>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <cn type="integer">2</cn>
      <ci>p</ci>
     </apply>
     <cn type="integer">1</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \omega^{2^{p}-1}.
  </annotation>
 </semantics>
</math>

 Furthermore the <a href="order_(group_theory)" title="wikilink">order</a> of 

<math display="inline" id="Lucas–Lehmer_primality_test:38">
 <semantics>
  <mi>ω</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>ω</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \omega
  </annotation>
 </semantics>
</math>

 divides 

<math display="inline" id="Lucas–Lehmer_primality_test:39">
 <semantics>
  <mrow>
   <msup>
    <mn>2</mn>
    <mi>p</mi>
   </msup>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <cn type="integer">2</cn>
    <ci>p</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   2^{p}.
  </annotation>
 </semantics>
</math>

 However 

<math display="inline" id="Lucas–Lehmer_primality_test:40">
 <semantics>
  <mrow>
   <msup>
    <mi>ω</mi>
    <msup>
     <mn>2</mn>
     <mrow>
      <mi>p</mi>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </msup>
   </msup>
   <mo>≠</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <neq></neq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>ω</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <cn type="integer">2</cn>
      <apply>
       <minus></minus>
       <ci>p</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
    </apply>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \omega^{2^{p-1}}\neq 1
  </annotation>
 </semantics>
</math>

, so the order does not divide 

<math display="inline" id="Lucas–Lehmer_primality_test:41">
 <semantics>
  <mrow>
   <msup>
    <mn>2</mn>
    <mrow>
     <mi>p</mi>
     <mo>-</mo>
     <mn>1</mn>
    </mrow>
   </msup>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <cn type="integer">2</cn>
    <apply>
     <minus></minus>
     <ci>p</ci>
     <cn type="integer">1</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   2^{p-1}.
  </annotation>
 </semantics>
</math>

 Thus, the order is exactly 

<math display="inline" id="Lucas–Lehmer_primality_test:42">
 <semantics>
  <mrow>
   <msup>
    <mn>2</mn>
    <mi>p</mi>
   </msup>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <cn type="integer">2</cn>
    <ci>p</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   2^{p}.
  </annotation>
 </semantics>
</math>

</p>

<p>The order of an element is at most the order (size) of the group, so</p>

<p>

<math display="block" id="Lucas–Lehmer_primality_test:43">
 <semantics>
  <mrow>
   <mrow>
    <msup>
     <mn>2</mn>
     <mi>p</mi>
    </msup>
    <mo>≤</mo>
    <mrow>
     <mo stretchy="false">|</mo>
     <msup>
      <mi>X</mi>
      <mo>*</mo>
     </msup>
     <mo stretchy="false">|</mo>
    </mrow>
    <mo>≤</mo>
    <mrow>
     <msup>
      <mi>q</mi>
      <mn>2</mn>
     </msup>
     <mo>-</mo>
     <mn>1</mn>
    </mrow>
    <mo><</mo>
    <msup>
     <mi>q</mi>
     <mn>2</mn>
    </msup>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <leq></leq>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <cn type="integer">2</cn>
      <ci>p</ci>
     </apply>
     <apply>
      <abs></abs>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>X</ci>
       <times></times>
      </apply>
     </apply>
    </apply>
    <apply>
     <leq></leq>
     <share href="#.cmml">
     </share>
     <apply>
      <minus></minus>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>q</ci>
       <cn type="integer">2</cn>
      </apply>
      <cn type="integer">1</cn>
     </apply>
    </apply>
    <apply>
     <lt></lt>
     <share href="#.cmml">
     </share>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>q</ci>
      <cn type="integer">2</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   2^{p}\leq|X^{*}|\leq q^{2}-1<q^{2}.
  </annotation>
 </semantics>
</math>

 But <em>q</em> is the smallest prime factor of the composite 

<math display="inline" id="Lucas–Lehmer_primality_test:44">
 <semantics>
  <msub>
   <mi>M</mi>
   <mi>p</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>M</ci>
    <ci>p</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   M_{p}
  </annotation>
 </semantics>
</math>

, so</p>

<p>

<math display="block" id="Lucas–Lehmer_primality_test:45">
 <semantics>
  <mrow>
   <msup>
    <mi>q</mi>
    <mn>2</mn>
   </msup>
   <mo>≤</mo>
   <msub>
    <mi>M</mi>
    <mi>p</mi>
   </msub>
   <mo>=</mo>
   <mrow>
    <msup>
     <mn>2</mn>
     <mi>p</mi>
    </msup>
    <mo>-</mo>
    <mn>1.</mn>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <leq></leq>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>q</ci>
      <cn type="integer">2</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>M</ci>
      <ci>p</ci>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <minus></minus>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <cn type="integer">2</cn>
       <ci>p</ci>
      </apply>
      <cn type="float">1.</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   q^{2}\leq M_{p}=2^{p}-1.
  </annotation>
 </semantics>
</math>

 This yields the contradiction 

<math display="inline" id="Lucas–Lehmer_primality_test:46">
 <semantics>
  <mrow>
   <msup>
    <mn>2</mn>
    <mi>p</mi>
   </msup>
   <mo><</mo>
   <mrow>
    <msup>
     <mn>2</mn>
     <mi>p</mi>
    </msup>
    <mo>-</mo>
    <mn>1</mn>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <lt></lt>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <cn type="integer">2</cn>
     <ci>p</ci>
    </apply>
    <apply>
     <minus></minus>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <cn type="integer">2</cn>
      <ci>p</ci>
     </apply>
     <cn type="integer">1</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   2^{p}<2^{p}-1
  </annotation>
 </semantics>
</math>

. Therefore 

<math display="inline" id="Lucas–Lehmer_primality_test:47">
 <semantics>
  <msub>
   <mi>M</mi>
   <mi>p</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>M</ci>
    <ci>p</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   M_{p}
  </annotation>
 </semantics>
</math>

 is prime.</p>
<h3 id="necessity">Necessity</h3>

<p>In the other direction, the goal is to show that the primality of 

<math display="inline" id="Lucas–Lehmer_primality_test:48">
 <semantics>
  <msub>
   <mi>M</mi>
   <mi>p</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>M</ci>
    <ci>p</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   M_{p}
  </annotation>
 </semantics>
</math>

 implies 

<math display="inline" id="Lucas–Lehmer_primality_test:49">
 <semantics>
  <mrow>
   <msub>
    <mi>s</mi>
    <mrow>
     <mi>p</mi>
     <mo>-</mo>
     <mn>2</mn>
    </mrow>
   </msub>
   <mo>≡</mo>
   <mrow>
    <mn>0</mn>
    <mspace width="veryverythickmathspace">
    </mspace>
    <mrow>
     <mo lspace="8.1pt" stretchy="false">(</mo>
     <mrow>
      <mo>mod</mo>
      <msub>
       <mi>M</mi>
       <mi>p</mi>
      </msub>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <equivalent></equivalent>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>s</ci>
     <apply>
      <minus></minus>
      <ci>p</ci>
      <cn type="integer">2</cn>
     </apply>
    </apply>
    <apply>
     <csymbol cd="latexml">annotated</csymbol>
     <cn type="integer">0</cn>
     <apply>
      <ci>pmod</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>M</ci>
       <ci>p</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   s_{p-2}\equiv 0\;\;(\mathop{{\rm mod}}M_{p})
  </annotation>
 </semantics>
</math>

. The following simplified proof is by Öystein J. R. Ödseth.<a class="footnoteRef" href="#fn7" id="fnref7"><sup>7</sup></a></p>

<p>Since 

<math display="inline" id="Lucas–Lehmer_primality_test:50">
 <semantics>
  <mrow>
   <mrow>
    <msup>
     <mn>2</mn>
     <mi>p</mi>
    </msup>
    <mo>-</mo>
    <mn>1</mn>
   </mrow>
   <mo>≡</mo>
   <mrow>
    <mn>7</mn>
    <mspace width="veryverythickmathspace">
    </mspace>
    <mrow>
     <mo lspace="8.1pt" stretchy="false">(</mo>
     <mrow>
      <mo>mod</mo>
      <mn>12</mn>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <equivalent></equivalent>
    <apply>
     <minus></minus>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <cn type="integer">2</cn>
      <ci>p</ci>
     </apply>
     <cn type="integer">1</cn>
    </apply>
    <apply>
     <csymbol cd="latexml">annotated</csymbol>
     <cn type="integer">7</cn>
     <apply>
      <ci>pmod</ci>
      <cn type="integer">12</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   2^{p}-1\equiv 7\;\;(\mathop{{\rm mod}}12)
  </annotation>
 </semantics>
</math>

 for odd 

<math display="inline" id="Lucas–Lehmer_primality_test:51">
 <semantics>
  <mrow>
   <mi>p</mi>
   <mo>></mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <gt></gt>
    <ci>p</ci>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p>1
  </annotation>
 </semantics>
</math>

, it follows from <a href="Legendre_symbol#Properties_of_the_Legendre_symbol" title="wikilink">properties of the Legendre symbol</a> that 

<math display="inline" id="Lucas–Lehmer_primality_test:52">
 <semantics>
  <mrow>
   <mrow>
    <mo stretchy="false">(</mo>
    <mn>3</mn>
    <mo stretchy="false">|</mo>
    <msub>
     <mi>M</mi>
     <mi>p</mi>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>=</mo>
   <mo>-</mo>
   <mn>1.</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <cn type="integer">3</cn>
     <ci>normal-|</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>M</ci>
      <ci>p</ci>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <eq></eq>
    <minus></minus>
    <cn type="float">1.</cn>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (3|M_{p})=-1.
  </annotation>
 </semantics>
</math>

 This means that 3 is a <a href="quadratic_nonresidue" title="wikilink">quadratic nonresidue</a> modulo 

<math display="inline" id="Lucas–Lehmer_primality_test:53">
 <semantics>
  <mrow>
   <msub>
    <mi>M</mi>
    <mi>p</mi>
   </msub>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>M</ci>
    <ci>p</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   M_{p}.
  </annotation>
 </semantics>
</math>

 By <a href="Euler's_criterion" title="wikilink">Euler's criterion</a>, this is equivalent to</p>

<p>

<math display="block" id="Lucas–Lehmer_primality_test:54">
 <semantics>
  <mrow>
   <mrow>
    <msup>
     <mn>3</mn>
     <mfrac>
      <mrow>
       <msub>
        <mi>M</mi>
        <mi>p</mi>
       </msub>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
      <mn>2</mn>
     </mfrac>
    </msup>
    <mo>≡</mo>
    <mrow>
     <mrow>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
     <mspace width="veryverythickmathspace">
     </mspace>
     <mrow>
      <mo lspace="8.1pt" stretchy="false">(</mo>
      <mrow>
       <mo>mod</mo>
       <msub>
        <mi>M</mi>
        <mi>p</mi>
       </msub>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <equivalent></equivalent>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <cn type="integer">3</cn>
     <apply>
      <divide></divide>
      <apply>
       <minus></minus>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>M</ci>
        <ci>p</ci>
       </apply>
       <cn type="integer">1</cn>
      </apply>
      <cn type="integer">2</cn>
     </apply>
    </apply>
    <apply>
     <csymbol cd="latexml">annotated</csymbol>
     <apply>
      <minus></minus>
      <cn type="integer">1</cn>
     </apply>
     <apply>
      <ci>pmod</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>M</ci>
       <ci>p</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   3^{\frac{M_{p}-1}{2}}\equiv-1\;\;(\mathop{{\rm mod}}M_{p}).
  </annotation>
 </semantics>
</math>

</p>

<p>In contrast, 2 is a <a href="quadratic_residue" title="wikilink">quadratic residue</a> modulo 

<math display="inline" id="Lucas–Lehmer_primality_test:55">
 <semantics>
  <msub>
   <mi>M</mi>
   <mi>p</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>M</ci>
    <ci>p</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   M_{p}
  </annotation>
 </semantics>
</math>

 since 

<math display="inline" id="Lucas–Lehmer_primality_test:56">
 <semantics>
  <mrow>
   <msup>
    <mn>2</mn>
    <mi>p</mi>
   </msup>
   <mo>≡</mo>
   <mrow>
    <mn>1</mn>
    <mspace width="veryverythickmathspace">
    </mspace>
    <mrow>
     <mo lspace="8.1pt" stretchy="false">(</mo>
     <mrow>
      <mo>mod</mo>
      <msub>
       <mi>M</mi>
       <mi>p</mi>
      </msub>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <equivalent></equivalent>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <cn type="integer">2</cn>
     <ci>p</ci>
    </apply>
    <apply>
     <csymbol cd="latexml">annotated</csymbol>
     <cn type="integer">1</cn>
     <apply>
      <ci>pmod</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>M</ci>
       <ci>p</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   2^{p}\equiv 1\;\;(\mathop{{\rm mod}}M_{p})
  </annotation>
 </semantics>
</math>

 and so 

<math display="inline" id="Lucas–Lehmer_primality_test:57">
 <semantics>
  <mrow>
   <mrow>
    <mn>2</mn>
    <mo>≡</mo>
    <msup>
     <mn>2</mn>
     <mrow>
      <mi>p</mi>
      <mo>+</mo>
      <mn>1</mn>
     </mrow>
    </msup>
    <mo>=</mo>
    <mrow>
     <msup>
      <mrow>
       <mo>(</mo>
       <msup>
        <mn>2</mn>
        <mfrac>
         <mrow>
          <mi>p</mi>
          <mo>+</mo>
          <mn>1</mn>
         </mrow>
         <mn>2</mn>
        </mfrac>
       </msup>
       <mo>)</mo>
      </mrow>
      <mn>2</mn>
     </msup>
     <mspace width="veryverythickmathspace">
     </mspace>
     <mrow>
      <mo lspace="8.1pt" stretchy="false">(</mo>
      <mrow>
       <mo>mod</mo>
       <msub>
        <mi>M</mi>
        <mi>p</mi>
       </msub>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <equivalent></equivalent>
     <cn type="integer">2</cn>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <cn type="integer">2</cn>
      <apply>
       <plus></plus>
       <ci>p</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <csymbol cd="latexml">annotated</csymbol>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <cn type="integer">2</cn>
        <apply>
         <divide></divide>
         <apply>
          <plus></plus>
          <ci>p</ci>
          <cn type="integer">1</cn>
         </apply>
         <cn type="integer">2</cn>
        </apply>
       </apply>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <ci>pmod</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>M</ci>
        <ci>p</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   2\equiv 2^{p+1}=\left(2^{\frac{p+1}{2}}\right)^{2}\;\;(\mathop{{\rm mod}}M_{p}).
  </annotation>
 </semantics>
</math>

 This time, Euler's criterion gives</p>

<p>

<math display="block" id="Lucas–Lehmer_primality_test:58">
 <semantics>
  <mrow>
   <mrow>
    <msup>
     <mn>2</mn>
     <mfrac>
      <mrow>
       <msub>
        <mi>M</mi>
        <mi>p</mi>
       </msub>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
      <mn>2</mn>
     </mfrac>
    </msup>
    <mo>≡</mo>
    <mrow>
     <mn>1</mn>
     <mspace width="veryverythickmathspace">
     </mspace>
     <mrow>
      <mo lspace="8.1pt" stretchy="false">(</mo>
      <mrow>
       <mo>mod</mo>
       <msub>
        <mi>M</mi>
        <mi>p</mi>
       </msub>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <equivalent></equivalent>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <cn type="integer">2</cn>
     <apply>
      <divide></divide>
      <apply>
       <minus></minus>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>M</ci>
        <ci>p</ci>
       </apply>
       <cn type="integer">1</cn>
      </apply>
      <cn type="integer">2</cn>
     </apply>
    </apply>
    <apply>
     <csymbol cd="latexml">annotated</csymbol>
     <cn type="integer">1</cn>
     <apply>
      <ci>pmod</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>M</ci>
       <ci>p</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   2^{\frac{M_{p}-1}{2}}\equiv 1\;\;(\mathop{{\rm mod}}M_{p}).
  </annotation>
 </semantics>
</math>

</p>

<p>Combining these two equivalence relations yields</p>

<p>

<math display="block" id="Lucas–Lehmer_primality_test:59">
 <semantics>
  <mrow>
   <mrow>
    <msup>
     <mn>24</mn>
     <mfrac>
      <mrow>
       <msub>
        <mi>M</mi>
        <mi>p</mi>
       </msub>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
      <mn>2</mn>
     </mfrac>
    </msup>
    <mo>≡</mo>
    <mrow>
     <msup>
      <mrow>
       <mo>(</mo>
       <msup>
        <mn>2</mn>
        <mfrac>
         <mrow>
          <msub>
           <mi>M</mi>
           <mi>p</mi>
          </msub>
          <mo>-</mo>
          <mn>1</mn>
         </mrow>
         <mn>2</mn>
        </mfrac>
       </msup>
       <mo>)</mo>
      </mrow>
      <mn>3</mn>
     </msup>
     <mrow>
      <mo>(</mo>
      <msup>
       <mn>3</mn>
       <mfrac>
        <mrow>
         <msub>
          <mi>M</mi>
          <mi>p</mi>
         </msub>
         <mo>-</mo>
         <mn>1</mn>
        </mrow>
        <mn>2</mn>
       </mfrac>
      </msup>
      <mo>)</mo>
     </mrow>
    </mrow>
    <mo>≡</mo>
    <mrow>
     <msup>
      <mrow>
       <mo stretchy="false">(</mo>
       <mn>1</mn>
       <mo stretchy="false">)</mo>
      </mrow>
      <mn>3</mn>
     </msup>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>≡</mo>
    <mrow>
     <mrow>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
     <mspace width="veryverythickmathspace">
     </mspace>
     <mrow>
      <mo lspace="8.1pt" stretchy="false">(</mo>
      <mrow>
       <mo>mod</mo>
       <msub>
        <mi>M</mi>
        <mi>p</mi>
       </msub>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <equivalent></equivalent>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <cn type="integer">24</cn>
      <apply>
       <divide></divide>
       <apply>
        <minus></minus>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>M</ci>
         <ci>p</ci>
        </apply>
        <cn type="integer">1</cn>
       </apply>
       <cn type="integer">2</cn>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <cn type="integer">2</cn>
        <apply>
         <divide></divide>
         <apply>
          <minus></minus>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>M</ci>
           <ci>p</ci>
          </apply>
          <cn type="integer">1</cn>
         </apply>
         <cn type="integer">2</cn>
        </apply>
       </apply>
       <cn type="integer">3</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <cn type="integer">3</cn>
       <apply>
        <divide></divide>
        <apply>
         <minus></minus>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>M</ci>
          <ci>p</ci>
         </apply>
         <cn type="integer">1</cn>
        </apply>
        <cn type="integer">2</cn>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <equivalent></equivalent>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <cn type="integer">1</cn>
       <cn type="integer">3</cn>
      </apply>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
      </apply>
     </apply>
    </apply>
    <apply>
     <equivalent></equivalent>
     <share href="#.cmml">
     </share>
     <apply>
      <csymbol cd="latexml">annotated</csymbol>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
      </apply>
      <apply>
       <ci>pmod</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>M</ci>
        <ci>p</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   24^{\frac{M_{p}-1}{2}}\equiv\left(2^{\frac{M_{p}-1}{2}}\right)^{3}\left(3^{%
\frac{M_{p}-1}{2}}\right)\equiv(1)^{3}(-1)\equiv-1\;\;(\mathop{{\rm mod}}M_{p}).
  </annotation>
 </semantics>
</math>

</p>

<p>Let 

<math display="inline" id="Lucas–Lehmer_primality_test:60">
 <semantics>
  <mrow>
   <mi>σ</mi>
   <mo>=</mo>
   <mrow>
    <mn>2</mn>
    <msqrt>
     <mn>3</mn>
    </msqrt>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>σ</ci>
    <apply>
     <times></times>
     <cn type="integer">2</cn>
     <apply>
      <root></root>
      <cn type="integer">3</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \sigma=2\sqrt{3}
  </annotation>
 </semantics>
</math>

, and define <em>X</em> as before as the ring 

<math display="inline" id="Lucas–Lehmer_primality_test:61">
 <semantics>
  <mrow>
   <mrow>
    <mi>X</mi>
    <mo>=</mo>
    <mrow>
     <mo stretchy="false">{</mo>
     <mrow>
      <mi>a</mi>
      <mo>+</mo>
      <mrow>
       <mi>b</mi>
       <msqrt>
        <mn>3</mn>
       </msqrt>
      </mrow>
     </mrow>
     <mo>∣</mo>
     <mrow>
      <mrow>
       <mi>a</mi>
       <mo>,</mo>
       <mi>b</mi>
      </mrow>
      <mo>∈</mo>
      <msub>
       <mi>ℤ</mi>
       <msub>
        <mi>M</mi>
        <mi>p</mi>
       </msub>
      </msub>
     </mrow>
     <mo stretchy="false">}</mo>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>X</ci>
    <apply>
     <csymbol cd="latexml">conditional-set</csymbol>
     <apply>
      <plus></plus>
      <ci>a</ci>
      <apply>
       <times></times>
       <ci>b</ci>
       <apply>
        <root></root>
        <cn type="integer">3</cn>
       </apply>
      </apply>
     </apply>
     <apply>
      <in></in>
      <list>
       <ci>a</ci>
       <ci>b</ci>
      </list>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>ℤ</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>M</ci>
        <ci>p</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   X=\{a+b\sqrt{3}\mid a,b\in\mathbb{Z}_{M_{p}}\}.
  </annotation>
 </semantics>
</math>

 Then in the ring <em>X</em>, it follows that</p>

<p>

<math display="inline" id="Lucas–Lehmer_primality_test:62">
 <semantics>
  <msup>
   <mrow>
    <mo stretchy="false">(</mo>
    <mrow>
     <mn>6</mn>
     <mo>+</mo>
     <mi>σ</mi>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
   <msub>
    <mi>M</mi>
    <mi>p</mi>
   </msub>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <apply>
     <plus></plus>
     <cn type="integer">6</cn>
     <ci>σ</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>M</ci>
     <ci>p</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle(6+\sigma)^{M_{p}}
  </annotation>
 </semantics>
</math>


</p>

<p>where the first equality uses the <a href="Proofs_of_Fermat's_little_theorem#Proof_using_the_binomial_theorem" title="wikilink">Binomial Theorem in a finite field</a>, which is</p>

<p>

<math display="block" id="Lucas–Lehmer_primality_test:63">
 <semantics>
  <mrow>
   <msup>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>x</mi>
      <mo>+</mo>
      <mi>y</mi>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
    <msub>
     <mi>M</mi>
     <mi>p</mi>
    </msub>
   </msup>
   <mo>≡</mo>
   <mrow>
    <mrow>
     <msup>
      <mi>x</mi>
      <msub>
       <mi>M</mi>
       <mi>p</mi>
      </msub>
     </msup>
     <mo>+</mo>
     <msup>
      <mi>y</mi>
      <msub>
       <mi>M</mi>
       <mi>p</mi>
      </msub>
     </msup>
    </mrow>
    <mspace width="veryverythickmathspace">
    </mspace>
    <mrow>
     <mo lspace="8.1pt" stretchy="false">(</mo>
     <mrow>
      <mo>mod</mo>
      <msub>
       <mi>M</mi>
       <mi>p</mi>
      </msub>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <equivalent></equivalent>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <plus></plus>
      <ci>x</ci>
      <ci>y</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>M</ci>
      <ci>p</ci>
     </apply>
    </apply>
    <apply>
     <csymbol cd="latexml">annotated</csymbol>
     <apply>
      <plus></plus>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>x</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>M</ci>
        <ci>p</ci>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>y</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>M</ci>
        <ci>p</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <ci>pmod</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>M</ci>
       <ci>p</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (x+y)^{M_{p}}\equiv x^{M_{p}}+y^{M_{p}}\;\;(\mathop{{\rm mod}}M_{p})
  </annotation>
 </semantics>
</math>

,</p>

<p>and the second equality uses <a href="Fermat's_little_theorem" title="wikilink">Fermat's little theorem</a>, which is</p>

<p>

<math display="block" id="Lucas–Lehmer_primality_test:64">
 <semantics>
  <mrow>
   <msup>
    <mi>a</mi>
    <msub>
     <mi>M</mi>
     <mi>p</mi>
    </msub>
   </msup>
   <mo>≡</mo>
   <mrow>
    <mi>a</mi>
    <mspace width="veryverythickmathspace">
    </mspace>
    <mrow>
     <mo lspace="8.1pt" stretchy="false">(</mo>
     <mrow>
      <mo>mod</mo>
      <msub>
       <mi>M</mi>
       <mi>p</mi>
      </msub>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <equivalent></equivalent>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>a</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>M</ci>
      <ci>p</ci>
     </apply>
    </apply>
    <apply>
     <csymbol cd="latexml">annotated</csymbol>
     <ci>a</ci>
     <apply>
      <ci>pmod</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>M</ci>
       <ci>p</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a^{M_{p}}\equiv a\;\;(\mathop{{\rm mod}}M_{p})
  </annotation>
 </semantics>
</math>

</p>

<p>for any integer <em>a</em>. The value of 

<math display="inline" id="Lucas–Lehmer_primality_test:65">
 <semantics>
  <mi>σ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>σ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \sigma
  </annotation>
 </semantics>
</math>

 was chosen so that 

<math display="inline" id="Lucas–Lehmer_primality_test:66">
 <semantics>
  <mrow>
   <mrow>
    <mi>ω</mi>
    <mo>=</mo>
    <mfrac>
     <msup>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mn>6</mn>
        <mo>+</mo>
        <mi>σ</mi>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
      <mn>2</mn>
     </msup>
     <mn>24</mn>
    </mfrac>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>ω</ci>
    <apply>
     <divide></divide>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <plus></plus>
       <cn type="integer">6</cn>
       <ci>σ</ci>
      </apply>
      <cn type="integer">2</cn>
     </apply>
     <cn type="integer">24</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \omega=\frac{(6+\sigma)^{2}}{24}.
  </annotation>
 </semantics>
</math>

 Consequently, this can be used to compute 

<math display="inline" id="Lucas–Lehmer_primality_test:67">
 <semantics>
  <msup>
   <mi>ω</mi>
   <mfrac>
    <mrow>
     <msub>
      <mi>M</mi>
      <mi>p</mi>
     </msub>
     <mo>+</mo>
     <mn>1</mn>
    </mrow>
    <mn>2</mn>
   </mfrac>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>ω</ci>
    <apply>
     <divide></divide>
     <apply>
      <plus></plus>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>M</ci>
       <ci>p</ci>
      </apply>
      <cn type="integer">1</cn>
     </apply>
     <cn type="integer">2</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \omega^{\frac{M_{p}+1}{2}}
  </annotation>
 </semantics>
</math>

 in the ring <em>X</em> as</p>

<p>

<math display="inline" id="Lucas–Lehmer_primality_test:68">
 <semantics>
  <msup>
   <mi>ω</mi>
   <mfrac>
    <mrow>
     <msub>
      <mi>M</mi>
      <mi>p</mi>
     </msub>
     <mo>+</mo>
     <mn>1</mn>
    </mrow>
    <mn>2</mn>
   </mfrac>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>ω</ci>
    <apply>
     <divide></divide>
     <apply>
      <plus></plus>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>M</ci>
       <ci>p</ci>
      </apply>
      <cn type="integer">1</cn>
     </apply>
     <cn type="integer">2</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle\omega^{\frac{M_{p}+1}{2}}
  </annotation>
 </semantics>
</math>


</p>

<p>All that remains is to multiply both sides of this equation by 

<math display="inline" id="Lucas–Lehmer_primality_test:69">
 <semantics>
  <msup>
   <mover accent="true">
    <mi>ω</mi>
    <mo stretchy="false">¯</mo>
   </mover>
   <mfrac>
    <mrow>
     <msub>
      <mi>M</mi>
      <mi>p</mi>
     </msub>
     <mo>+</mo>
     <mn>1</mn>
    </mrow>
    <mn>4</mn>
   </mfrac>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <apply>
     <ci>normal-¯</ci>
     <ci>ω</ci>
    </apply>
    <apply>
     <divide></divide>
     <apply>
      <plus></plus>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>M</ci>
       <ci>p</ci>
      </apply>
      <cn type="integer">1</cn>
     </apply>
     <cn type="integer">4</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \bar{\omega}^{\frac{M_{p}+1}{4}}
  </annotation>
 </semantics>
</math>

 and use 

<math display="inline" id="Lucas–Lehmer_primality_test:70">
 <semantics>
  <mrow>
   <mrow>
    <mi>ω</mi>
    <mover accent="true">
     <mi>ω</mi>
     <mo stretchy="false">¯</mo>
    </mover>
   </mrow>
   <mo>=</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>ω</ci>
     <apply>
      <ci>normal-¯</ci>
      <ci>ω</ci>
     </apply>
    </apply>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \omega\bar{\omega}=1
  </annotation>
 </semantics>
</math>


, which gives</p>

<p>

<math display="inline" id="Lucas–Lehmer_primality_test:71">
 <semantics>
  <mrow>
   <msup>
    <mi>ω</mi>
    <mfrac>
     <mrow>
      <msub>
       <mi>M</mi>
       <mi>p</mi>
      </msub>
      <mo>+</mo>
      <mn>1</mn>
     </mrow>
     <mn>2</mn>
    </mfrac>
   </msup>
   <msup>
    <mover accent="true">
     <mi>ω</mi>
     <mo stretchy="false">¯</mo>
    </mover>
    <mfrac>
     <mrow>
      <msub>
       <mi>M</mi>
       <mi>p</mi>
      </msub>
      <mo>+</mo>
      <mn>1</mn>
     </mrow>
     <mn>4</mn>
    </mfrac>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>ω</ci>
     <apply>
      <divide></divide>
      <apply>
       <plus></plus>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>M</ci>
        <ci>p</ci>
       </apply>
       <cn type="integer">1</cn>
      </apply>
      <cn type="integer">2</cn>
     </apply>
    </apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <ci>normal-¯</ci>
      <ci>ω</ci>
     </apply>
     <apply>
      <divide></divide>
      <apply>
       <plus></plus>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>M</ci>
        <ci>p</ci>
       </apply>
       <cn type="integer">1</cn>
      </apply>
      <cn type="integer">4</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle\omega^{\frac{M_{p}+1}{2}}\bar{\omega}^{\frac{M_{p}+1}{4}}
  </annotation>
 </semantics>
</math>


</p>

<p>Since 

<math display="inline" id="Lucas–Lehmer_primality_test:72">
 <semantics>
  <msub>
   <mi>s</mi>
   <mrow>
    <mi>p</mi>
    <mo>-</mo>
    <mn>2</mn>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>s</ci>
    <apply>
     <minus></minus>
     <ci>p</ci>
     <cn type="integer">2</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   s_{p-2}
  </annotation>
 </semantics>
</math>

 is 0 in <em>X</em>, it is also 0 modulo 

<math display="inline" id="Lucas–Lehmer_primality_test:73">
 <semantics>
  <mrow>
   <msub>
    <mi>M</mi>
    <mi>p</mi>
   </msub>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>M</ci>
    <ci>p</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   M_{p}.
  </annotation>
 </semantics>
</math>

</p>
<h2 id="applications">Applications</h2>

<p>The Lucas–Lehmer test is the primality test used by the <a href="Great_Internet_Mersenne_Prime_Search" title="wikilink">Great Internet Mersenne Prime Search</a> to locate large primes. This search has been successful in locating many of the largest primes known to date.<a class="footnoteRef" href="#fn8" id="fnref8"><sup>8</sup></a> The test is considered valuable because it can provably test a large set of very large numbers for primality within an affordable amount of time. In contrast, the equivalently fast <a href="Pépin's_test" title="wikilink">Pépin's test</a> for any <a href="Fermat_number" title="wikilink">Fermat number</a> can only be used on a much smaller set of very large numbers before reaching computational limits.</p>
<h2 id="see-also">See also</h2>
<ul>
<li><a href="Mersenne's_conjecture" title="wikilink">Mersenne's conjecture</a></li>
<li><a href="Lucas–Lehmer–Riesel_test" title="wikilink">Lucas–Lehmer–Riesel test</a></li>
<li><a class="uri" href="GIMPS" title="wikilink">GIMPS</a></li>
</ul>
<h2 id="notes">Notes</h2>
<references group="note">
</references>
<h2 id="references">References</h2>
<ul>
<li></li>
</ul>
<h2 id="external-links">External links</h2>
<ul>
<li></li>
<li><a href="http://www.mersenne.org">GIMPS (The Great Internet Mersenne Prime Search)</a></li>
<li><a href="http://arxiv.org/abs/0705.3664">A proof of Lucas–Lehmer–Reix test (for Fermat numbers)</a></li>
<li><a href="http://www.mersennewiki.org/index.php/Lucas-Lehmer_Test">Lucas–Lehmer test</a> at MersenneWiki</li>
</ul>

<p>"</p>

<p><a href="Category:Primality_tests" title="wikilink">Category:Primality tests</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1"><a href="http://primes.utm.edu/notes/by_year.html">The Largest Known Prime by Year: A Brief History</a><a href="#fnref1">↩</a></li>
<li id="fn2"><mtpl></mtpl><a href="#fnref2">↩</a></li>
<li id="fn3"><a href="#fnref3">↩</a></li>
<li id="fn4">Jason Wojciechowski. <a href="http://web.archive.org/web/20110722232101/http://wonka.hampshire.edu/~jason/math/smithnum/project.ps">Mersenne Primes, An Introduction and Overview</a>. 2003.<a href="#fnref4">↩</a></li>
<li id="fn5">Formally, let 

<math display="inline" id="Lucas–Lehmer_primality_test:74">
 <semantics>
  <mrow>
   <msub>
    <mi>ℤ</mi>
    <mi>q</mi>
   </msub>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mi>ℤ</mi>
     <mo>/</mo>
     <mi>q</mi>
    </mrow>
    <mi>ℤ</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>ℤ</ci>
     <ci>q</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <divide></divide>
      <ci>ℤ</ci>
      <ci>q</ci>
     </apply>
     <ci>ℤ</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbb{Z}_{q}=\mathbb{Z}/q\mathbb{Z}
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Lucas–Lehmer_primality_test:75">
 <semantics>
  <mrow>
   <mi>X</mi>
   <mo>=</mo>
   <mrow>
    <mrow>
     <msub>
      <mi>ℤ</mi>
      <mi>q</mi>
     </msub>
     <mrow>
      <mo stretchy="false">[</mo>
      <mi>T</mi>
      <mo stretchy="false">]</mo>
     </mrow>
    </mrow>
    <mo>/</mo>
    <mrow>
     <mo stretchy="false">⟨</mo>
     <mrow>
      <msup>
       <mi>T</mi>
       <mn>2</mn>
      </msup>
      <mo>-</mo>
      <mn>3</mn>
     </mrow>
     <mo stretchy="false">⟩</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>X</ci>
    <apply>
     <divide></divide>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>ℤ</ci>
       <ci>q</ci>
      </apply>
      <apply>
       <csymbol cd="latexml">delimited-[]</csymbol>
       <ci>T</ci>
      </apply>
     </apply>
     <apply>
      <csymbol cd="latexml">delimited-⟨⟩</csymbol>
      <apply>
       <minus></minus>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>T</ci>
        <cn type="integer">2</cn>
       </apply>
       <cn type="integer">3</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   X=\mathbb{Z}_{q}[T]/\langle T^{2}-3\rangle
  </annotation>
 </semantics>
</math>

.<a href="#fnref5">↩</a></li>
<li id="fn6">Formally, 

<math display="inline" id="Lucas–Lehmer_primality_test:76">
 <semantics>
  <mrow>
   <mi>ω</mi>
   <mo>+</mo>
   <mrow>
    <mo stretchy="false">⟨</mo>
    <mrow>
     <msup>
      <mi>T</mi>
      <mn>2</mn>
     </msup>
     <mo>-</mo>
     <mn>3</mn>
    </mrow>
    <mo stretchy="false">⟩</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <plus></plus>
    <ci>ω</ci>
    <apply>
     <csymbol cd="latexml">delimited-⟨⟩</csymbol>
     <apply>
      <minus></minus>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>T</ci>
       <cn type="integer">2</cn>
      </apply>
      <cn type="integer">3</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \omega+\langle T^{2}-3\rangle
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Lucas–Lehmer_primality_test:77">
 <semantics>
  <mrow>
   <mover accent="true">
    <mi>ω</mi>
    <mo stretchy="false">¯</mo>
   </mover>
   <mo>+</mo>
   <mrow>
    <mo stretchy="false">⟨</mo>
    <mrow>
     <msup>
      <mi>T</mi>
      <mn>2</mn>
     </msup>
     <mo>-</mo>
     <mn>3</mn>
    </mrow>
    <mo stretchy="false">⟩</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <plus></plus>
    <apply>
     <ci>normal-¯</ci>
     <ci>ω</ci>
    </apply>
    <apply>
     <csymbol cd="latexml">delimited-⟨⟩</csymbol>
     <apply>
      <minus></minus>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>T</ci>
       <cn type="integer">2</cn>
      </apply>
      <cn type="integer">3</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \bar{\omega}+\langle T^{2}-3\rangle
  </annotation>
 </semantics>
</math>

 are in <em>X</em>. By abuse of language 

<math display="inline" id="Lucas–Lehmer_primality_test:78">
 <semantics>
  <mi>ω</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>ω</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \omega
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Lucas–Lehmer_primality_test:79">
 <semantics>
  <mover accent="true">
   <mi>ω</mi>
   <mo stretchy="false">¯</mo>
  </mover>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-¯</ci>
    <ci>ω</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \bar{\omega}
  </annotation>
 </semantics>
</math>

 are identified with their images in <em>X</em> under the natural ring homomorphism from 

<math display="inline" id="Lucas–Lehmer_primality_test:80">
 <semantics>
  <mrow>
   <mi>ℤ</mi>
   <mrow>
    <mo stretchy="false">[</mo>
    <msqrt>
     <mn>3</mn>
    </msqrt>
    <mo stretchy="false">]</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>ℤ</ci>
    <apply>
     <csymbol cd="latexml">delimited-[]</csymbol>
     <apply>
      <root></root>
      <cn type="integer">3</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbb{Z}[\sqrt{3}]
  </annotation>
 </semantics>
</math>

 to <em>X</em> which sends 

<math display="inline" id="Lucas–Lehmer_primality_test:81">
 <semantics>
  <msqrt>
   <mn>3</mn>
  </msqrt>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <root></root>
    <cn type="integer">3</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \sqrt{3}
  </annotation>
 </semantics>
</math>

 to <em>T</em>.<a href="#fnref6">↩</a></li>
<li id="fn7">Öystein J. R. Ödseth. <a href="http://www.uib.no/People/nmaoy/papers/luc.pdf">A note on primality tests for N = h · 2<sup>n</sup> − 1</a>. Department of Mathematics, University of Bergen.<a href="#fnref7">↩</a></li>
<li id="fn8"><a href="http://primes.utm.edu/largest.html#biggest">The "Top Ten" Record Primes</a>, <a href="The_Prime_Pages" title="wikilink">The Prime Pages</a><a href="#fnref8">↩</a></li>
</ol>
</section>
</body>
</html>

<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="868">Necklace (combinatorics)</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Necklace (combinatorics)</h1>
<hr/>

<p>    In <a class="uri" href="combinatorics" title="wikilink">combinatorics</a>, a <em>k</em>-ary <strong>necklace</strong> of length <em>n</em> is an <a href="equivalence_class" title="wikilink">equivalence class</a> of <em>n</em>-character <a href="string_(computer_science)#Formal_theory" title="wikilink">strings</a> over an <a href="alphabet_(computer_science)" title="wikilink">alphabet</a> of size <em>k</em>, taking all <a href="circular_shift" title="wikilink">rotations</a> as equivalent. It represents a structure with <em>n</em> circularly connected beads of up to <em>k</em> different colors.</p>

<p>A <em>k</em>-ary <strong>bracelet</strong>, also referred to as a <strong>turnover</strong> (or <strong>free</strong>) <strong>necklace</strong>, is a necklace such that strings may also be equivalent under reflection. That is, given two strings, if each is the reverse of the other then they belong to the same equivalence class. For this reason, a necklace might also be called a <strong>fixed necklace</strong> to distinguish it from a turnover necklace.</p>

<p>Technically, one may classify a necklace as an <a href="orbit_(group_theory)" title="wikilink">orbit</a> of the <a href="group_action" title="wikilink">action</a> of the <a href="cyclic_group" title="wikilink">cyclic group</a> on <em>n</em>-character strings, and a bracelet as an orbit of the <a href="dihedral_group" title="wikilink">dihedral group</a>'s action.</p>
<h2 id="equivalence-classes">Equivalence classes</h2>
<h3 id="number-of-necklaces">Number of necklaces</h3>

<p>There are</p>

<p>

<math display="block" id="Necklace_(combinatorics):0">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>N</mi>
     <mi>k</mi>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>n</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mfrac>
     <mn>1</mn>
     <mi>n</mi>
    </mfrac>
    <mrow>
     <munder>
      <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
      <mrow>
       <mi>d</mi>
       <mo>∣</mo>
       <mi>n</mi>
      </mrow>
     </munder>
     <mrow>
      <mi>φ</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>d</mi>
       <mo stretchy="false">)</mo>
      </mrow>
      <msup>
       <mi>k</mi>
       <mrow>
        <mi>n</mi>
        <mo>/</mo>
        <mi>d</mi>
       </mrow>
      </msup>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>N</ci>
      <ci>k</ci>
     </apply>
     <ci>n</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <divide></divide>
      <cn type="integer">1</cn>
      <ci>n</ci>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <cerror>
        <csymbol cd="ambiguous">fragments</csymbol>
        <csymbol cd="unknown">d</csymbol>
        <ci>normal-∣</ci>
        <csymbol cd="unknown">n</csymbol>
       </cerror>
      </apply>
      <apply>
       <times></times>
       <ci>φ</ci>
       <ci>d</ci>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>k</ci>
        <apply>
         <divide></divide>
         <ci>n</ci>
         <ci>d</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   N_{k}(n)={1\over n}\sum_{d\mid n}\varphi(d)k^{n/d}
  </annotation>
 </semantics>
</math>

</p>

<p>different <em>k</em>-ary necklaces of length <em>n</em>, where φ is the <a href="Euler's_totient_function" title="wikilink">Euler's totient function</a>.<a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a></p>
<h3 id="number-of-bracelets">Number of bracelets</h3>

<p>There are</p>

<p>

<math display="block" id="Necklace_(combinatorics):1">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>B</mi>
     <mi>k</mi>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>n</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mo>{</mo>
    <mtable displaystyle="true">
     <mtr>
      <mtd columnalign="left">
       <mrow>
        <mrow>
         <mstyle displaystyle="false">
          <mfrac>
           <mn>1</mn>
           <mn>2</mn>
          </mfrac>
         </mstyle>
         <msub>
          <mi>N</mi>
          <mi>k</mi>
         </msub>
         <mrow>
          <mo stretchy="false">(</mo>
          <mi>n</mi>
          <mo stretchy="false">)</mo>
         </mrow>
        </mrow>
        <mo>+</mo>
        <mrow>
         <mstyle displaystyle="false">
          <mfrac>
           <mn>1</mn>
           <mn>4</mn>
          </mfrac>
         </mstyle>
         <mrow>
          <mo stretchy="false">(</mo>
          <mrow>
           <mi>k</mi>
           <mo>+</mo>
           <mn>1</mn>
          </mrow>
          <mo stretchy="false">)</mo>
         </mrow>
         <msup>
          <mi>k</mi>
          <mrow>
           <mi>n</mi>
           <mo>/</mo>
           <mn>2</mn>
          </mrow>
         </msup>
        </mrow>
       </mrow>
      </mtd>
      <mtd columnalign="left">
       <mrow>
        <mtext>if</mtext>
        <mi>n</mi>
        <mtext>is even</mtext>
       </mrow>
      </mtd>
     </mtr>
     <mtr>
      <mtd columnalign="left">
       <mi></mi>
      </mtd>
      <mtd></mtd>
     </mtr>
     <mtr>
      <mtd columnalign="left">
       <mrow>
        <mrow>
         <mstyle displaystyle="false">
          <mfrac>
           <mn>1</mn>
           <mn>2</mn>
          </mfrac>
         </mstyle>
         <msub>
          <mi>N</mi>
          <mi>k</mi>
         </msub>
         <mrow>
          <mo stretchy="false">(</mo>
          <mi>n</mi>
          <mo stretchy="false">)</mo>
         </mrow>
        </mrow>
        <mo>+</mo>
        <mrow>
         <mstyle displaystyle="false">
          <mfrac>
           <mn>1</mn>
           <mn>2</mn>
          </mfrac>
         </mstyle>
         <msup>
          <mi>k</mi>
          <mrow>
           <mrow>
            <mo stretchy="false">(</mo>
            <mrow>
             <mi>n</mi>
             <mo>+</mo>
             <mn>1</mn>
            </mrow>
            <mo stretchy="false">)</mo>
           </mrow>
           <mo>/</mo>
           <mn>2</mn>
          </mrow>
         </msup>
        </mrow>
       </mrow>
      </mtd>
      <mtd columnalign="left">
       <mrow>
        <mtext>if</mtext>
        <mi>n</mi>
        <mtext>is odd</mtext>
       </mrow>
      </mtd>
     </mtr>
    </mtable>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>B</ci>
      <ci>k</ci>
     </apply>
     <ci>n</ci>
    </apply>
    <apply>
     <csymbol cd="latexml">cases</csymbol>
     <apply>
      <plus></plus>
      <apply>
       <times></times>
       <apply>
        <divide></divide>
        <cn type="integer">1</cn>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>N</ci>
        <ci>k</ci>
       </apply>
       <ci>n</ci>
      </apply>
      <apply>
       <times></times>
       <apply>
        <divide></divide>
        <cn type="integer">1</cn>
        <cn type="integer">4</cn>
       </apply>
       <apply>
        <plus></plus>
        <ci>k</ci>
        <cn type="integer">1</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>k</ci>
        <apply>
         <divide></divide>
         <ci>n</ci>
         <cn type="integer">2</cn>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <mtext>if</mtext>
      <ci>n</ci>
      <mtext>is even</mtext>
     </apply>
     <csymbol cd="latexml">absent</csymbol>
     <mtext>otherwise</mtext>
     <apply>
      <plus></plus>
      <apply>
       <times></times>
       <apply>
        <divide></divide>
        <cn type="integer">1</cn>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>N</ci>
        <ci>k</ci>
       </apply>
       <ci>n</ci>
      </apply>
      <apply>
       <times></times>
       <apply>
        <divide></divide>
        <cn type="integer">1</cn>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>k</ci>
        <apply>
         <divide></divide>
         <apply>
          <plus></plus>
          <ci>n</ci>
          <cn type="integer">1</cn>
         </apply>
         <cn type="integer">2</cn>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <mtext>if</mtext>
      <ci>n</ci>
      <mtext>is odd</mtext>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   B_{k}(n)=\begin{cases}{1\over 2}N_{k}(n)+{1\over 4}(k+1)k^{n/2}&\text{if }n%
\text{ is even}\\
\\
{1\over 2}N_{k}(n)+{1\over 2}k^{(n+1)/2}&\text{if }n\text{ is odd}\end{cases}
  </annotation>
 </semantics>
</math>

 different <em>k</em>-ary bracelets of length <em>n</em>, where <em>N</em><sub><em>k</em></sub>(<em>n</em>) is the number of <em>k</em>-ary necklaces of length <em>n</em>.</p>
<h2 id="examples">Examples</h2>
<h3 id="necklace-example">Necklace example</h3>

<p>If there are <em>n</em> beads, all distinct, on a necklace joined at the ends, then the number of distinct orderings on the necklace, after allowing for rotations, is <em>n</em>!/<em>n</em>, for <em>n</em> &gt; 0. This may also be expressed as (<em>n</em> − 1)!. This number is less than the general case, which lacks the requirement that each bead must be distinct.</p>

<p>An intuitive justification for this can be given. If there is a line of <em>n</em> distinct objects ("beads"), the number of combinations would be <em>n</em>!. If the ends are joined together, the number of combinations are divided by <em>n</em>, as it is possible to rotate the string of <em>n</em> beads into <em>n</em> positions.</p>
<h3 id="bracelet-example">Bracelet example</h3>

<p>If there are <em>n</em> beads, all distinct, on a bracelet joined at the ends, then the number of distinct orderings on the bracelet, after allowing for rotations and reflection, is <em>n</em>!/(2<em>n</em>), for <em>n</em> &gt; 2. Note that this number is less than the general case of <em>B<sub>n</sub></em>(<em>n</em>), which lacks the requirement that each bead must be distinct.</p>

<p>To explain this, one may begin with the count for a necklace. This number can be further divided by 2, because it is also possible to flip the bracelet over.</p>
<h2 id="aperiodic-necklaces">Aperiodic necklaces</h2>

<p>An <strong>aperiodic necklace</strong> of length <em>n</em> is an <a href="equivalence_class" title="wikilink">equivalence class</a> of size <em>n</em>, i.e., no two distinct rotations of a necklace from such class are equal.</p>

<p>According to <a href="Moreau's_necklace-counting_function" title="wikilink">Moreau's necklace-counting function</a>, there are</p>

<p>

<math display="block" id="Necklace_(combinatorics):2">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>M</mi>
     <mi>k</mi>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>n</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mfrac>
     <mn>1</mn>
     <mi>n</mi>
    </mfrac>
    <mrow>
     <munder>
      <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
      <mrow>
       <mi>d</mi>
       <mo>∣</mo>
       <mi>n</mi>
      </mrow>
     </munder>
     <mrow>
      <mi>μ</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>d</mi>
       <mo stretchy="false">)</mo>
      </mrow>
      <msup>
       <mi>k</mi>
       <mrow>
        <mi>n</mi>
        <mo>/</mo>
        <mi>d</mi>
       </mrow>
      </msup>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>M</ci>
      <ci>k</ci>
     </apply>
     <ci>n</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <divide></divide>
      <cn type="integer">1</cn>
      <ci>n</ci>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <cerror>
        <csymbol cd="ambiguous">fragments</csymbol>
        <csymbol cd="unknown">d</csymbol>
        <ci>normal-∣</ci>
        <csymbol cd="unknown">n</csymbol>
       </cerror>
      </apply>
      <apply>
       <times></times>
       <ci>μ</ci>
       <ci>d</ci>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>k</ci>
        <apply>
         <divide></divide>
         <ci>n</ci>
         <ci>d</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   M_{k}(n)={1\over n}\sum_{d\mid n}\mu(d)k^{n/d}
  </annotation>
 </semantics>
</math>

 different <em>k</em>-ary aperiodic necklaces of length <em>n</em>, where <em>μ</em> is the <a href="Möbius_function" title="wikilink">Möbius function</a>.</p>

<p>Each aperiodic necklace contains a single <a href="Lyndon_word" title="wikilink">Lyndon word</a> so that Lyndon words form <a href="Equivalence_Class_Representative" title="wikilink">representatives</a> of aperiodic necklaces.</p>
<h2 id="products-of-necklaces">Products of Necklaces</h2>

<p>The limit of the product of the numbers of fixed necklaces of length <em>n</em> composed of <em>k</em> types of beads:</p>

<p>

<math display="block" id="Necklace_(combinatorics):3">
 <semantics>
  <mrow>
   <mrow>
    <munder>
     <mo movablelimits="false">lim</mo>
     <mrow>
      <mi>n</mi>
      <mo>→</mo>
      <mi mathvariant="normal">∞</mi>
     </mrow>
    </munder>
    <mrow>
     <munderover>
      <mo largeop="true" movablelimits="false" symmetric="true">∏</mo>
      <mrow>
       <mi>n</mi>
       <mo>=</mo>
       <mn>1</mn>
      </mrow>
      <mi>n</mi>
     </munderover>
     <mrow>
      <msub>
       <mi>N</mi>
       <mi>k</mi>
      </msub>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>n</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mfrac>
     <msup>
      <mi>k</mi>
      <mi>n</mi>
     </msup>
     <mrow>
      <mi>n</mi>
      <mo lspace="0pt" rspace="3.5pt">!</mo>
     </mrow>
    </mfrac>
    <mn>1</mn>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mn>1</mn>
      <mo>+</mo>
      <mi>X</mi>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mn>1</mn>
      <mo>+</mo>
      <mi>X</mi>
      <mo>+</mo>
      <msup>
       <mi>X</mi>
       <mn>2</mn>
      </msup>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
    <mi mathvariant="normal">⋯</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mn>1</mn>
      <mo>+</mo>
      <mi>X</mi>
      <mo>+</mo>
      <msup>
       <mi>X</mi>
       <mn>2</mn>
      </msup>
      <mo>+</mo>
      <mi mathvariant="normal">⋯</mi>
      <mo>+</mo>
      <msup>
       <mi>X</mi>
       <mrow>
        <mi>n</mi>
        <mo>-</mo>
        <mn>1</mn>
       </mrow>
      </msup>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <limit></limit>
      <apply>
       <ci>normal-→</ci>
       <ci>n</ci>
       <infinity></infinity>
      </apply>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <csymbol cd="latexml">product</csymbol>
        <apply>
         <eq></eq>
         <ci>n</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <ci>n</ci>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>N</ci>
        <ci>k</ci>
       </apply>
       <ci>n</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <divide></divide>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>k</ci>
       <ci>n</ci>
      </apply>
      <apply>
       <factorial></factorial>
       <ci>n</ci>
      </apply>
     </apply>
     <cn type="integer">1</cn>
     <apply>
      <plus></plus>
      <cn type="integer">1</cn>
      <ci>X</ci>
     </apply>
     <apply>
      <plus></plus>
      <cn type="integer">1</cn>
      <ci>X</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>X</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
     <ci>normal-⋯</ci>
     <apply>
      <plus></plus>
      <cn type="integer">1</cn>
      <ci>X</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>X</ci>
       <cn type="integer">2</cn>
      </apply>
      <ci>normal-⋯</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>X</ci>
       <apply>
        <minus></minus>
        <ci>n</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \lim_{n\to\infty}\prod_{n=1}^{n}N_{k}(n)=\frac{k^{n}}{n!}1(1+X)(1+X+X^{2})%
\cdots(1+X+X^{2}+\cdots+X^{n-1})
  </annotation>
 </semantics>
</math>

,</p>

<p>where the coefficient of 

<math display="inline" id="Necklace_(combinatorics):4">
 <semantics>
  <msup>
   <mi>X</mi>
   <mi>k</mi>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>X</ci>
    <ci>k</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   X^{k}
  </annotation>
 </semantics>
</math>

 in the expansion of the product</p>

<p>

<math display="block" id="Necklace_(combinatorics):5">
 <semantics>
  <mrow>
   <mrow>
    <munderover>
     <mo largeop="true" movablelimits="false" symmetric="true">∏</mo>
     <mrow>
      <mi>m</mi>
      <mo>=</mo>
      <mn>1</mn>
     </mrow>
     <mi>n</mi>
    </munderover>
    <mrow>
     <munderover>
      <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
      <mrow>
       <mi>i</mi>
       <mo>=</mo>
       <mn>0</mn>
      </mrow>
      <mrow>
       <mi>m</mi>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
     </munderover>
     <msup>
      <mi>X</mi>
      <mi>i</mi>
     </msup>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mn>1</mn>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mn>1</mn>
      <mo>+</mo>
      <mi>X</mi>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mn>1</mn>
      <mo>+</mo>
      <mi>X</mi>
      <mo>+</mo>
      <msup>
       <mi>X</mi>
       <mn>2</mn>
      </msup>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
    <mi mathvariant="normal">⋯</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mn>1</mn>
      <mo>+</mo>
      <mi>X</mi>
      <mo>+</mo>
      <msup>
       <mi>X</mi>
       <mn>2</mn>
      </msup>
      <mo>+</mo>
      <mi mathvariant="normal">⋯</mi>
      <mo>+</mo>
      <msup>
       <mi>X</mi>
       <mrow>
        <mi>n</mi>
        <mo>-</mo>
        <mn>1</mn>
       </mrow>
      </msup>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <csymbol cd="latexml">product</csymbol>
       <apply>
        <eq></eq>
        <ci>m</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <ci>n</ci>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <apply>
         <eq></eq>
         <ci>i</ci>
         <cn type="integer">0</cn>
        </apply>
       </apply>
       <apply>
        <minus></minus>
        <ci>m</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>X</ci>
       <ci>i</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <times></times>
     <cn type="integer">1</cn>
     <apply>
      <plus></plus>
      <cn type="integer">1</cn>
      <ci>X</ci>
     </apply>
     <apply>
      <plus></plus>
      <cn type="integer">1</cn>
      <ci>X</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>X</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
     <ci>normal-⋯</ci>
     <apply>
      <plus></plus>
      <cn type="integer">1</cn>
      <ci>X</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>X</ci>
       <cn type="integer">2</cn>
      </apply>
      <ci>normal-⋯</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>X</ci>
       <apply>
        <minus></minus>
        <ci>n</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \prod_{m=1}^{n}\sum_{i=0}^{m-1}X^{i}=1(1+X)(1+X+X^{2})\cdots(1+X+X^{2}+\cdots+%
X^{n-1})
  </annotation>
 </semantics>
</math>

</p>

<p>presents the number of <a class="uri" href="permutations" title="wikilink">permutations</a> of <em>n</em> with <em>k</em> <a href="Inversion_(discrete_mathematics)" title="wikilink">inversions</a>, expressed by a Mahonian number:  (See Gaichenkov link)</p>
<h2 id="see-also">See also</h2>
<ul>
<li><a href="Lyndon_word" title="wikilink">Lyndon word</a></li>
<li><a href="Inversion_(discrete_mathematics)" title="wikilink">Inversion (discrete mathematics)</a></li>
<li><a href="Necklace_problem" title="wikilink">Necklace problem</a></li>
<li><a href="Necklace_splitting_problem" title="wikilink">Necklace splitting problem</a></li>
<li><a class="uri" href="Permutation" title="wikilink">Permutation</a></li>
<li><a href="Proofs_of_Fermat's_little_theorem#Proof_by_counting_necklaces" title="wikilink">Proofs of Fermat's little theorem#Proof by counting necklaces</a></li>
<li><a href="Forte_number" title="wikilink">Forte number</a>, a representation of binary bracelets of length 12 used in <a href="atonal_music" title="wikilink">atonal music</a>.</li>
</ul>
<h2 id="references">References</h2>
<h2 id="external-links">External links</h2>
<ul>
<li></li>
<li><a href="http://www.theory.csc.uvic.ca/~cos/inf/neck/NecklaceInfo.html">Info on necklaces, Lyndon words, De Bruijn sequences</a></li>
</ul>

<p>"</p>

<p><a href="Category:Combinatorics_on_words" title="wikilink">Category:Combinatorics on words</a> <a href="Category:Enumerative_combinatorics" title="wikilink">Category:Enumerative combinatorics</a> <a href="Category:Articles_with_images_not_understandable_by_color_blind_users" title="wikilink">Category:Articles with images not understandable by color blind users</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1"><a class="uri" href="http://mathworld.wolfram.com/Necklace.html">http://mathworld.wolfram.com/Necklace.html</a><a href="#fnref1">↩</a></li>
</ol>
</section>
</body>
</html>

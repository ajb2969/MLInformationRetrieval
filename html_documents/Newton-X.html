<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="1389">Newton-X</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Newton-X</h1>
<hr/>

<p>Newton-X<a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a><a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a> is a general program for <a href="molecular_dynamics" title="wikilink">molecular dynamics</a> simulations beyond the <a href="Born-Oppenheimer_approximation" title="wikilink">Born-Oppenheimer approximation</a>. It has been primarily used for simulations of <a href="Ultrafast_molecular_process" title="wikilink">ultrafast processes</a> (<a class="uri" href="femtosecond" title="wikilink">femtosecond</a> to <a class="uri" href="picosecond" title="wikilink">picosecond</a> time scale) in photoexcited molecules. It has also been used for simulation of band envelops of <a href="Absorption_spectroscopy" title="wikilink">absorption</a> and <a href="Emission_spectrum_(fluorescence_spectroscopy)" title="wikilink">emission</a> spectra.</p>

<p><strong>Newton-X</strong> uses the trajectory <a href="surface_hopping" title="wikilink">surface hopping</a> method, a semi-classical approximation in which the nuclei are treated classically by <a href="Newtonian_dynamics" title="wikilink">Newtonian dynamics</a>, while the electrons are treated as a quantum subsystem via a local approximation of the <a href="Time-dependent_Schr√∂dinger_equation" title="wikilink">Time-dependent Schr√∂dinger Equation</a>. Nonadiabatic effects (the spread of the nuclear <a href="wave_packet" title="wikilink">wave packet</a> between several states) are recovered by a stochastic algorithm, which allows individual trajectories to change between different <a href="Potential_energy_surface" title="wikilink">potential energy states</a> during the dynamics.</p>
<h2 id="capabilities">Capabilities</h2>

<p>Newton-X is designed as a platform to perform all steps of the nonadiabatic dynamics simulations, from the initial conditions generation, through trajectories computation, to the statistical analysis of the results. It works interfaced to a number of <a href="Quantum_chemistry_computer_programs" title="wikilink">electronic structure programs</a> available for <a href="computational_chemistry" title="wikilink">computational chemistry</a>, including <a href="GAUSSIAN" title="wikilink">Gaussian</a>, <a href="TURBOMOLE" title="wikilink">Turbomole</a>, <a href="GAMESS_(US)" title="wikilink">Gamess</a>, and <a href="COLUMBUS" title="wikilink">Columbus</a>. Its modular development allows to create new interfaces and integrate new methods. Users‚Äô new developments are encouraged and are in due course included into the main branch of the program.</p>

<p><a href="Vibronic_coupling" title="wikilink">Nonadiabatic couplings</a>, the central quantity in nonadiabatic simulations, can be either provided by a third-party program or computed by Newton-X. When computed by Newton-X, it is done with a numerical approximation based on overlap of <a href="wavefunctions" title="wikilink">electronic wavefunctions</a> obtained in sequential time steps. A local diabatization method is also available to provide couplings in the case of weak nonadiabatic interactions.<a class="footnoteRef" href="#fn3" id="fnref3"><sup>3</sup></a></p>

<p>Hybrid combination of methods is possible in Newton-X. Forces computed with different methods for different atomic subsets can be linearly combined to generate the final force driving the dynamics. These hybrid forces may, for instance, be combined into the popular electrostatic-embedding quantum-mechanical/molecular-mechanical method (<a class="uri" href="QM/MM" title="wikilink">QM/MM</a>). Important options for <a href="QM/MM" title="wikilink">QM/MM simulations</a>, such as link atoms, boundaries, and thermostats are available as well.</p>

<p>As part of the initial conditions module, Newton-X can simulate absorption and emission spectra, using the Nuclear Ensemble approach,<a class="footnoteRef" href="#fn4" id="fnref4"><sup>4</sup></a> which provides full spectral widths and absolute intensities.</p>
<figure><b>(Figure)</b>
<figcaption>Basic execution sections of Newton-X.</figcaption>
</figure>
<h3 id="methods-and-interfaces-to-third-party-programs">Methods and Interfaces to Third-Party Programs</h3>

<p>Newton-X can simulate <a href="Surface_hopping" title="wikilink">surface-hopping dynamics</a> with the following programs and quantum-chemical methods:</p>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">
<p><a href="Quantum_chemistry_computer_programs" title="wikilink">Third-Party Program</a></p></th>
<th style="text-align: left;">
<p><a href="Quantum_chemistry" title="wikilink">Methods</a></p></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">
<p><a href="COLUMBUS" title="wikilink">Columbus</a></p></td>
<td style="text-align: left;">
<p><a class="uri" href="MCSCF" title="wikilink">MCSCF</a>, <a class="uri" href="MRCI" title="wikilink">MRCI</a></p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p><a href="TURBOMOLE" title="wikilink">Turbomole</a></p></td>
<td style="text-align: left;">
<p><a class="uri" href="TDDFT" title="wikilink">TDDFT</a>, <a href="Coupled_cluster" title="wikilink">CC2</a>, ADC(2)</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p><a href="Gaussian_(software)" title="wikilink">Gaussian</a></p></td>
<td style="text-align: left;">
<p><a class="uri" href="MCSCF" title="wikilink">MCSCF</a>, <a class="uri" href="TDDFT" title="wikilink">TDDFT</a>, TDA</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p><a href="GAMESS_(US)" title="wikilink">Gamess</a></p></td>
<td style="text-align: left;">
<p><a class="uri" href="MCSCF" title="wikilink">MCSCF</a></p></td>
</tr>
</tbody>
</table>
<h3 id="nonadiabatic-couplings">Nonadiabatic Couplings</h3>

<p>The <a href="surface_hopping" title="wikilink">surface hopping probability</a> depends on the values of the <a href="Vibronic_coupling" title="wikilink">nonadiabatic couplings</a> between electronic states.</p>

<p>Newton-X can either compute nonadiabatic couplings during the dynamics or read them from an interfaced third-party program. The computation of the couplings in Newton-X is done by finite differences, following the <a href="Sharon_Hammes-Schiffer" title="wikilink">Hammes-Schiffer</a>-<a href="John_C._Tully" title="wikilink">Tully</a> approach.<a class="footnoteRef" href="#fn5" id="fnref5"><sup>5</sup></a> In this approach, the key quantity for computation of the surface hopping probability, the <a href="inner_product" title="wikilink">inner product</a> between the nonadiabatic couplings (<strong>œÑ</strong><sub>LM</sub>) and the nuclear velocities (<strong>v</strong>) at time <em>t</em>, is given by</p>

<p>

<math display="inline" id="Newton-X:0">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>ùùâ</mi>
     <mrow>
      <mi>L</mi>
      <mi>M</mi>
     </mrow>
    </msub>
    <mo>‚ãÖ</mo>
    <mi>ùêØ</mi>
   </mrow>
   <mo>‚âà</mo>
   <mrow>
    <mfrac>
     <mn>1</mn>
     <mrow>
      <mn>4</mn>
      <mi mathvariant="normal">Œî</mi>
      <mi>t</mi>
     </mrow>
    </mfrac>
    <mrow>
     <mo>(</mo>
     <mrow>
      <mrow>
       <mrow>
        <mn>3</mn>
        <msub>
         <mi>S</mi>
         <mrow>
          <mi>L</mi>
          <mi>M</mi>
         </mrow>
        </msub>
        <mrow>
         <mo stretchy="false">(</mo>
         <mi>t</mi>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
       <mo>-</mo>
       <mrow>
        <mn>3</mn>
        <msub>
         <mi>S</mi>
         <mrow>
          <mi>M</mi>
          <mi>L</mi>
         </mrow>
        </msub>
        <mrow>
         <mo stretchy="false">(</mo>
         <mi>t</mi>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
       <mo>-</mo>
       <mrow>
        <msub>
         <mi>S</mi>
         <mrow>
          <mi>L</mi>
          <mi>M</mi>
         </mrow>
        </msub>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <mi>t</mi>
          <mo>-</mo>
          <mrow>
           <mi mathvariant="normal">Œî</mi>
           <mi>t</mi>
          </mrow>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
      </mrow>
      <mo>+</mo>
      <mrow>
       <msub>
        <mi>S</mi>
        <mrow>
         <mi>M</mi>
         <mi>L</mi>
        </mrow>
       </msub>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mi>t</mi>
         <mo>-</mo>
         <mrow>
          <mi mathvariant="normal">Œî</mi>
          <mi>t</mi>
         </mrow>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
     </mrow>
     <mo>)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <approx></approx>
    <apply>
     <ci>normal-‚ãÖ</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>ùùâ</ci>
      <apply>
       <times></times>
       <ci>L</ci>
       <ci>M</ci>
      </apply>
     </apply>
     <ci>ùêØ</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <divide></divide>
      <cn type="integer">1</cn>
      <apply>
       <times></times>
       <cn type="integer">4</cn>
       <ci>normal-Œî</ci>
       <ci>t</ci>
      </apply>
     </apply>
     <apply>
      <plus></plus>
      <apply>
       <minus></minus>
       <apply>
        <times></times>
        <cn type="integer">3</cn>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>S</ci>
         <apply>
          <times></times>
          <ci>L</ci>
          <ci>M</ci>
         </apply>
        </apply>
        <ci>t</ci>
       </apply>
       <apply>
        <times></times>
        <cn type="integer">3</cn>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>S</ci>
         <apply>
          <times></times>
          <ci>M</ci>
          <ci>L</ci>
         </apply>
        </apply>
        <ci>t</ci>
       </apply>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>S</ci>
         <apply>
          <times></times>
          <ci>L</ci>
          <ci>M</ci>
         </apply>
        </apply>
        <apply>
         <minus></minus>
         <ci>t</ci>
         <apply>
          <times></times>
          <ci>normal-Œî</ci>
          <ci>t</ci>
         </apply>
        </apply>
       </apply>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>S</ci>
        <apply>
         <times></times>
         <ci>M</ci>
         <ci>L</ci>
        </apply>
       </apply>
       <apply>
        <minus></minus>
        <ci>t</ci>
        <apply>
         <times></times>
         <ci>normal-Œî</ci>
         <ci>t</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \boldsymbol{\tau}_{LM}\cdot\mathbf{v}\approx\frac{1}{4\Delta t}\left(3S_{LM}(t%
)-3S_{ML}(t)-S_{LM}(t-\Delta t)+S_{ML}(t-\Delta t)\right)
  </annotation>
 </semantics>
</math>

,</p>

<p>where the terms 

<math display="inline" id="Newton-X:1">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>S</mi>
     <mrow>
      <mi>L</mi>
      <mi>M</mi>
     </mrow>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>t</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>‚â°</mo>
   <mrow>
    <mo>‚ü®</mo>
    <mrow>
     <msub>
      <mi mathvariant="normal">Œ®</mi>
      <mi>L</mi>
     </msub>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mi>t</mi>
       <mo>-</mo>
       <mrow>
        <mi mathvariant="normal">Œî</mi>
        <mi>t</mi>
       </mrow>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>‚à£</mo>
    <mrow>
     <msub>
      <mi mathvariant="normal">Œ®</mi>
      <mi>M</mi>
     </msub>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>t</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>‚ü©</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <equivalent></equivalent>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>S</ci>
      <apply>
       <times></times>
       <ci>L</ci>
       <ci>M</ci>
      </apply>
     </apply>
     <ci>t</ci>
    </apply>
    <apply>
     <csymbol cd="latexml">inner-product</csymbol>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>normal-Œ®</ci>
       <ci>L</ci>
      </apply>
      <apply>
       <minus></minus>
       <ci>t</ci>
       <apply>
        <times></times>
        <ci>normal-Œî</ci>
        <ci>t</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>normal-Œ®</ci>
       <ci>M</ci>
      </apply>
      <ci>t</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   S_{LM}(t)\equiv\left\langle\Psi_{L}(t-\Delta t)\mid\Psi_{M}(t)\right\rangle
  </annotation>
 </semantics>
</math>

 are <a class="uri" href="wavefunction" title="wikilink">wavefunction</a> overlaps between states L and M in different time steps.</p>

<p>This method can be generally used for any electronic-structure method, provided that a <a href="configuration_interaction" title="wikilink">configuration interaction</a> representation of the electronic wavefunction can be worked out. In Newton-X, it is used with a number of quantum-chemical methods, including <a class="uri" href="MCSCF" title="wikilink">MCSCF</a> (Multiconfigurational Self-Consistent Field), <a class="uri" href="MRCI" title="wikilink">MRCI</a> (Multi-Reference Configuration Interaction), <a href="Coupled_cluster" title="wikilink">CC2</a> (Coupled Cluster to Approximated Second Order), ADC(2) (Algebraic Diagrammatic Construction to Second Order), <a class="uri" href="TDDFT" title="wikilink">TDDFT</a> (Time-Dependent Density Functional Theory), and TDA (Tamm-Dankov Approximation). In the case of MCSCF and MRCI, the configuration interaction coefficients are directly used for computation of couplings. For the other methods, the <a href="linear_response" title="wikilink">linear-response amplitudes</a> are used as the coefficients of a configuration interaction wavefunction with single excitations.</p>
<h3 id="spectrum-simulations">Spectrum Simulations</h3>

<p>Newton-X simulates absorption and emission spectra using the Nuclear Ensemble approach.<a class="footnoteRef" href="#fn6" id="fnref6"><sup>6</sup></a> In this approach, an ensemble of nuclear geometries is built in the initial state and the transition energies and transition moments to the other states are computed for each geometry in the ensemble. A convolution of the results provides spectral widths and absolute intensities.</p>

<p>In the Nuclear Ensemble approach, the <a href="absorption_cross_section" title="wikilink">photoabsorption cross section</a> for a molecule initially in the ground state and being excited with photoenergy <em>E</em> into <em>N<sub>fs</sub></em> final electronic states is given by</p>

<p>

<math display="inline" id="Newton-X:2">
 <semantics>
  <mrow>
   <mrow>
    <mi>œÉ</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>E</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mfrac>
     <mrow>
      <mi>œÄ</mi>
      <msup>
       <mi>e</mi>
       <mn>2</mn>
      </msup>
      <mi mathvariant="normal">‚Ñè</mi>
     </mrow>
     <mrow>
      <mn>2</mn>
      <mi>m</mi>
      <mi>c</mi>
      <msub>
       <mi>œµ</mi>
       <mn>0</mn>
      </msub>
      <msub>
       <mi>n</mi>
       <mi>r</mi>
      </msub>
      <mi>E</mi>
     </mrow>
    </mfrac>
    <mrow>
     <msubsup>
      <mo largeop="true" symmetric="true">‚àë</mo>
      <mi>n</mi>
      <msub>
       <mi>N</mi>
       <mrow>
        <mi>f</mi>
        <mi>s</mi>
       </mrow>
      </msub>
     </msubsup>
     <mrow>
      <mfrac>
       <mn>1</mn>
       <msub>
        <mi>N</mi>
        <mi>p</mi>
       </msub>
      </mfrac>
      <mrow>
       <msubsup>
        <mo largeop="true" symmetric="true">‚àë</mo>
        <mi>l</mi>
        <msub>
         <mi>N</mi>
         <mi>p</mi>
        </msub>
       </msubsup>
       <mrow>
        <mi mathvariant="normal">Œî</mi>
        <msub>
         <mi>E</mi>
         <mrow>
          <mn>0</mn>
          <mo>,</mo>
          <mi>n</mi>
         </mrow>
        </msub>
        <mrow>
         <mo stretchy="false">(</mo>
         <msub>
          <mi>ùêë</mi>
          <mi>l</mi>
         </msub>
         <mo stretchy="false">)</mo>
        </mrow>
        <msub>
         <mi>f</mi>
         <mrow>
          <mn>0</mn>
          <mo>,</mo>
          <mi>n</mi>
         </mrow>
        </msub>
        <mrow>
         <mo stretchy="false">(</mo>
         <msub>
          <mi>ùêë</mi>
          <mi>l</mi>
         </msub>
         <mo stretchy="false">)</mo>
        </mrow>
        <mi>g</mi>
        <mrow>
         <mo>(</mo>
         <mrow>
          <mi>E</mi>
          <mo>-</mo>
          <mrow>
           <mi mathvariant="normal">Œî</mi>
           <msub>
            <mi>E</mi>
            <mrow>
             <mn>0</mn>
             <mo>,</mo>
             <mi>n</mi>
            </mrow>
           </msub>
           <mrow>
            <mo stretchy="false">(</mo>
            <msub>
             <mi>ùêë</mi>
             <mi>l</mi>
            </msub>
            <mo stretchy="false">)</mo>
           </mrow>
          </mrow>
         </mrow>
         <mo>,</mo>
         <mi>Œ¥</mi>
         <mo>)</mo>
        </mrow>
       </mrow>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>œÉ</ci>
     <ci>E</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <divide></divide>
      <apply>
       <times></times>
       <ci>œÄ</ci>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>e</ci>
        <cn type="integer">2</cn>
       </apply>
       <csymbol cd="latexml">Planck-constant-over-2-pi</csymbol>
      </apply>
      <apply>
       <times></times>
       <cn type="integer">2</cn>
       <ci>m</ci>
       <ci>c</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>œµ</ci>
        <cn type="integer">0</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>n</ci>
        <ci>r</ci>
       </apply>
       <ci>E</ci>
      </apply>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <ci>n</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>N</ci>
        <apply>
         <times></times>
         <ci>f</ci>
         <ci>s</ci>
        </apply>
       </apply>
      </apply>
      <apply>
       <times></times>
       <apply>
        <divide></divide>
        <cn type="integer">1</cn>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>N</ci>
         <ci>p</ci>
        </apply>
       </apply>
       <apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <sum></sum>
          <ci>l</ci>
         </apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>N</ci>
          <ci>p</ci>
         </apply>
        </apply>
        <apply>
         <times></times>
         <ci>normal-Œî</ci>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>E</ci>
          <list>
           <cn type="integer">0</cn>
           <ci>n</ci>
          </list>
         </apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>ùêë</ci>
          <ci>l</ci>
         </apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>f</ci>
          <list>
           <cn type="integer">0</cn>
           <ci>n</ci>
          </list>
         </apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>ùêë</ci>
          <ci>l</ci>
         </apply>
         <ci>g</ci>
         <interval closure="open">
          <apply>
           <minus></minus>
           <ci>E</ci>
           <apply>
            <times></times>
            <ci>normal-Œî</ci>
            <apply>
             <csymbol cd="ambiguous">subscript</csymbol>
             <ci>E</ci>
             <list>
              <cn type="integer">0</cn>
              <ci>n</ci>
             </list>
            </apply>
            <apply>
             <csymbol cd="ambiguous">subscript</csymbol>
             <ci>ùêë</ci>
             <ci>l</ci>
            </apply>
           </apply>
          </apply>
          <ci>Œ¥</ci>
         </interval>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \sigma(E)=\frac{\pi e^{2}\hbar}{2mc\epsilon_{0}n_{r}E}\sum_{n}^{N_{fs}}\frac{1%
}{N_{p}}\sum_{l}^{N_{p}}\Delta E_{0,n}(\mathbf{R}_{l})f_{0,n}(\mathbf{R}_{l})g%
\left(E-\Delta E_{0,n}(\mathbf{R}_{l}),\delta\right)
  </annotation>
 </semantics>
</math>

,</p>

<p>where <em>e</em> is the <a href="elementary_charge" title="wikilink">elementary charge</a>, ƒß is the <a href="reduced_Planck_constant" title="wikilink">reduced Planck constant</a>, <em>m</em> is the <a href="electron_mass" title="wikilink">electron mass</a>, <em>c</em> is the <a href="speed_of_light" title="wikilink">speed of light</a>, Œµ<sub>0</sub> is the <a href="vacuum_permittivity" title="wikilink">vacuum permittivity</a>, and <em>n<sub>r</sub></em> is the <a href="refractive_index" title="wikilink">refractive index</a> of the medium. The first summation runs over all target states and the second summation runs over all <em>N<sub>p</sub></em> points in the nuclear ensemble. Each point in the ensemble has nuclear geometry <strong>R</strong><em><sub>p</sub></em>, transition energy Œî<em>E<sub>0,n</sub></em>, and oscillator strength <em>f<sub>0,n</sub></em> (for a transition from the ground state into state <em>n</em>). <em>g</em> is a normalized Gaussian function with width <em>Œ¥</em> given by</p>

<p>

<math display="inline" id="Newton-X:3">
 <semantics>
  <mrow>
   <mrow>
    <mi>g</mi>
    <mrow>
     <mo>(</mo>
     <mrow>
      <mi>E</mi>
      <mo>-</mo>
      <mrow>
       <mi mathvariant="normal">Œî</mi>
       <msub>
        <mi>E</mi>
        <mrow>
         <mn>0</mn>
         <mo>,</mo>
         <mi>n</mi>
        </mrow>
       </msub>
      </mrow>
     </mrow>
     <mo>,</mo>
     <mi>Œ¥</mi>
     <mo>)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mfrac>
     <mn>1</mn>
     <msup>
      <mrow>
       <mo>(</mo>
       <mrow>
        <mn>2</mn>
        <mi>œÄ</mi>
        <msup>
         <mrow>
          <mo stretchy="false">(</mo>
          <mrow>
           <mi>Œ¥</mi>
           <mo>/</mo>
           <mn>2</mn>
          </mrow>
          <mo stretchy="false">)</mo>
         </mrow>
         <mn>2</mn>
        </msup>
       </mrow>
       <mo>)</mo>
      </mrow>
      <mrow>
       <mn>1</mn>
       <mo>/</mo>
       <mn>2</mn>
      </mrow>
     </msup>
    </mfrac>
    <mi>e</mi>
    <mi>x</mi>
    <mi>p</mi>
    <mrow>
     <mo>(</mo>
     <mfrac>
      <mrow>
       <mo>-</mo>
       <msup>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <mi>E</mi>
          <mo>-</mo>
          <mrow>
           <mi mathvariant="normal">Œî</mi>
           <msub>
            <mi>E</mi>
            <mrow>
             <mn>0</mn>
             <mo>,</mo>
             <mi>n</mi>
            </mrow>
           </msub>
          </mrow>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
        <mn>2</mn>
       </msup>
      </mrow>
      <mrow>
       <mn>2</mn>
       <msup>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <mi>Œ¥</mi>
          <mo>/</mo>
          <mn>2</mn>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
        <mn>2</mn>
       </msup>
      </mrow>
     </mfrac>
     <mo>)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>g</ci>
     <interval closure="open">
      <apply>
       <minus></minus>
       <ci>E</ci>
       <apply>
        <times></times>
        <ci>normal-Œî</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>E</ci>
         <list>
          <cn type="integer">0</cn>
          <ci>n</ci>
         </list>
        </apply>
       </apply>
      </apply>
      <ci>Œ¥</ci>
     </interval>
    </apply>
    <apply>
     <times></times>
     <apply>
      <divide></divide>
      <cn type="integer">1</cn>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <times></times>
        <cn type="integer">2</cn>
        <ci>œÄ</ci>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <divide></divide>
          <ci>Œ¥</ci>
          <cn type="integer">2</cn>
         </apply>
         <cn type="integer">2</cn>
        </apply>
       </apply>
       <apply>
        <divide></divide>
        <cn type="integer">1</cn>
        <cn type="integer">2</cn>
       </apply>
      </apply>
     </apply>
     <ci>e</ci>
     <ci>x</ci>
     <ci>p</ci>
     <apply>
      <divide></divide>
      <apply>
       <minus></minus>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <minus></minus>
         <ci>E</ci>
         <apply>
          <times></times>
          <ci>normal-Œî</ci>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>E</ci>
           <list>
            <cn type="integer">0</cn>
            <ci>n</ci>
           </list>
          </apply>
         </apply>
        </apply>
        <cn type="integer">2</cn>
       </apply>
      </apply>
      <apply>
       <times></times>
       <cn type="integer">2</cn>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <divide></divide>
         <ci>Œ¥</ci>
         <cn type="integer">2</cn>
        </apply>
        <cn type="integer">2</cn>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   g\left(E-\Delta E_{0,n},\delta\right)=\frac{1}{\left(2\pi(\delta/2)^{2}\right)%
^{1/2}}exp\left(\frac{-(E-\Delta E_{0,n})^{2}}{2(\delta/2)^{2}}\right)
  </annotation>
 </semantics>
</math>

.</p>

<p>For emission, the differential emission rate is given by</p>

<p>

<math display="inline" id="Newton-X:4">
 <semantics>
  <mrow>
   <mrow>
    <mi mathvariant="normal">Œì</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>E</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mfrac>
     <mrow>
      <msup>
       <mi>e</mi>
       <mn>2</mn>
      </msup>
      <msubsup>
       <mi>n</mi>
       <mi>r</mi>
       <mn>3</mn>
      </msubsup>
     </mrow>
     <mrow>
      <mn>2</mn>
      <mi>œÄ</mi>
      <mi mathvariant="normal">‚Ñè</mi>
      <mi>m</mi>
      <msup>
       <mi>c</mi>
       <mn>3</mn>
      </msup>
      <msub>
       <mi>œµ</mi>
       <mn>0</mn>
      </msub>
     </mrow>
    </mfrac>
    <mfrac>
     <mn>1</mn>
     <msub>
      <mi>N</mi>
      <mi>p</mi>
     </msub>
    </mfrac>
    <mrow>
     <msubsup>
      <mo largeop="true" symmetric="true">‚àë</mo>
      <mi>l</mi>
      <msub>
       <mi>N</mi>
       <mi>p</mi>
      </msub>
     </msubsup>
     <mrow>
      <mi mathvariant="normal">Œî</mi>
      <msub>
       <mi>E</mi>
       <mrow>
        <mn>1</mn>
        <mo>,</mo>
        <mn>0</mn>
       </mrow>
      </msub>
      <msup>
       <mrow>
        <mo stretchy="false">(</mo>
        <msub>
         <mi>ùêë</mi>
         <mi>l</mi>
        </msub>
        <mo stretchy="false">)</mo>
       </mrow>
       <mn>2</mn>
      </msup>
      <mrow>
       <mo>|</mo>
       <mrow>
        <msub>
         <mi>f</mi>
         <mrow>
          <mn>1</mn>
          <mo>,</mo>
          <mn>0</mn>
         </mrow>
        </msub>
        <mrow>
         <mo stretchy="false">(</mo>
         <msub>
          <mi>ùêë</mi>
          <mi>l</mi>
         </msub>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
       <mo>|</mo>
      </mrow>
      <mi>g</mi>
      <mrow>
       <mo>(</mo>
       <mrow>
        <mi>E</mi>
        <mo>-</mo>
        <mrow>
         <mi mathvariant="normal">Œî</mi>
         <msub>
          <mi>E</mi>
          <mrow>
           <mn>1</mn>
           <mo>,</mo>
           <mn>0</mn>
          </mrow>
         </msub>
         <mrow>
          <mo stretchy="false">(</mo>
          <msub>
           <mi>ùêë</mi>
           <mi>l</mi>
          </msub>
          <mo stretchy="false">)</mo>
         </mrow>
        </mrow>
       </mrow>
       <mo>,</mo>
       <mi>Œ¥</mi>
       <mo>)</mo>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>normal-Œì</ci>
     <ci>E</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <divide></divide>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>e</ci>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>n</ci>
         <ci>r</ci>
        </apply>
        <cn type="integer">3</cn>
       </apply>
      </apply>
      <apply>
       <times></times>
       <cn type="integer">2</cn>
       <ci>œÄ</ci>
       <csymbol cd="latexml">Planck-constant-over-2-pi</csymbol>
       <ci>m</ci>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>c</ci>
        <cn type="integer">3</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>œµ</ci>
        <cn type="integer">0</cn>
       </apply>
      </apply>
     </apply>
     <apply>
      <divide></divide>
      <cn type="integer">1</cn>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>N</ci>
       <ci>p</ci>
      </apply>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <ci>l</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>N</ci>
        <ci>p</ci>
       </apply>
      </apply>
      <apply>
       <times></times>
       <ci>normal-Œî</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>E</ci>
        <list>
         <cn type="integer">1</cn>
         <cn type="integer">0</cn>
        </list>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>ùêë</ci>
         <ci>l</ci>
        </apply>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <abs></abs>
        <apply>
         <times></times>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>f</ci>
          <list>
           <cn type="integer">1</cn>
           <cn type="integer">0</cn>
          </list>
         </apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>ùêë</ci>
          <ci>l</ci>
         </apply>
        </apply>
       </apply>
       <ci>g</ci>
       <interval closure="open">
        <apply>
         <minus></minus>
         <ci>E</ci>
         <apply>
          <times></times>
          <ci>normal-Œî</ci>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>E</ci>
           <list>
            <cn type="integer">1</cn>
            <cn type="integer">0</cn>
           </list>
          </apply>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>ùêë</ci>
           <ci>l</ci>
          </apply>
         </apply>
        </apply>
        <ci>Œ¥</ci>
       </interval>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Gamma(E)=\frac{e^{2}n_{r}^{3}}{2\pi\hbar mc^{3}\epsilon_{0}}\frac{1}{N_{p}}%
\sum_{l}^{N_{p}}\Delta E_{1,0}(\mathbf{R}_{l})^{2}\left|f_{1,0}(\mathbf{R}_{l}%
)\right|g\left(E-\Delta E_{1,0}(\mathbf{R}_{l}),\delta\right)
  </annotation>
 </semantics>
</math>

.</p>

<p>In both absorption and emission, the nuclear ensemble can be sampled either from a dynamics simulation or from a <a href="Wigner_quasiprobability_distribution" title="wikilink">Wigner distribution</a>.</p>
<h2 id="development-and-credits">Development and Credits</h2>

<p>The development of Newton-X started in 2005 at the Institute for the Theoretical Chemistry of the University of Vienna. It was designed by Mario Barbatti in collaboration with Hans Lischka. The original code used and expanded routines written by Giovanni Granucci and Maurizio Persico from the University of Pisa.<a class="footnoteRef" href="#fn7" id="fnref7"><sup>7</sup></a></p>

<p>A modulus for computation of <a href="Vibronic_coupling" title="wikilink">nonadiabatic couplings</a> based on finite differences of either <a class="uri" href="MCSCF" title="wikilink">MCSCF</a> or <a class="uri" href="MRCI" title="wikilink">MRCI</a> wavefunctions was implemented by Jiri Pittner (J. Heyrovsky Institute)<a class="footnoteRef" href="#fn8" id="fnref8"><sup>8</sup></a> and later adapted to work with <a class="uri" href="TDDFT" title="wikilink">TDDFT</a>.<a class="footnoteRef" href="#fn9" id="fnref9"><sup>9</sup></a> A modulus for <a class="uri" href="QM/MM" title="wikilink">QM/MM</a> dynamics was developed by Matthias Ruckenbauer.<a class="footnoteRef" href="#fn10" id="fnref10"><sup>10</sup></a> Felix Plasser implemented the local diabatization method and dynamics based on CC2 and ADC(2).<a class="footnoteRef" href="#fn11" id="fnref11"><sup>11</sup></a> Rachel Crespo-Otero extended the <a class="uri" href="TDDFT" title="wikilink">TDDFT</a> and TDA capabilities.<a class="footnoteRef" href="#fn12" id="fnref12"><sup>12</sup></a> An interface to Gamess was added by Aaron West and Theresa Windus (Iowa State University).<a class="footnoteRef" href="#fn13" id="fnref13"><sup>13</sup></a></p>

<p>Mario Barbatti coordinates new program developments, their integration into the official version, and the Newton-X distribution.</p>
<h2 id="distribution-and-training">Distribution and Training</h2>

<p>Newton-X is distributed free of charges for academic usage and with open source. The original paper<a class="footnoteRef" href="#fn14" id="fnref14"><sup>14</sup></a> describing the program had been cited 190 times by December 22, 2014, according to <a href="Google_Scholar" title="wikilink">Google Scholar</a>.</p>

<p>Newton-X counts with a <a href="http://www.newtonx.org">comprehensive documentation</a> and a <a href="https://groups.google.com/forum/?fromgroups#!forum/newtonx">public discussion forum</a>. A <a href="http://www.newtonx.org">tutorial</a> is also available on line, showing how to use the main features of the program step-by-step. Examples of simulations are shown at a <a href="https://www.youtube.com/user/mbarbatti">YouTube channel</a>. The program itself is distributed with a collection of input and output files of several worked-out examples.</p>

<p>A number of workshops on nonadiabatic simulations using Newton-X have been organized in Vienna (2008), Rio de Janeiro (2009), Sao Carlos (2011), Chiang Mai (2011), and Jeddah (2014).<a class="footnoteRef" href="#fn15" id="fnref15"><sup>15</sup></a></p>
<h2 id="program-philosophy-and-architecture">Program Philosophy and Architecture</h2>

<p>A main concept guiding the Newton-X development is that the program should be simple to use, but still providing as many options as possible to customize the jobs. This is achieved by a series of input tools that guide the user through the program options, providing context-dependent variable values always that possible.</p>
<figure><b>(Figure)</b>
<figcaption>Files and directories tree in Newton-X.</figcaption>
</figure>

<p>Newton-X is written as a combination of independent programs. The coordinated execution of these programs is done by drivers written in <a class="uri" href="Perl" title="wikilink">Perl</a>, while the programs dealing with integration of the dynamics and other mathematical aspects are written in <a href="Fortran_90" title="wikilink">Fortran 90</a> and <a href="C_(programming_language)" title="wikilink">C</a>. Memory is <a href="Dynamic_allocation" title="wikilink">dynamically allocated</a> and there are no formal limits for most of variables, such as number of atoms or states.</p>

<p>Newton-X works in a two-level <a class="uri" href="parallelization" title="wikilink">parallelization</a>: the first level is a trivial parallelization given by the Independent-Trajectories approach used by the program. Complete sets of input files are redundantly written to allow each trajectory to be executed independently. They can be easily merged for final analysis in a later step. In a second level, Newton-X takes advantage of the parallelization of the third-party programs with which it is interfaced. Thus, a Newton-X simulation using the interface with Gaussian program can be first distributed over a cluster in terms of independent trajectories and each trajectory runs parallelized version of Gaussian.</p>

<p>Starting with version (1.3, 2013), Newton-X uses meta-codes to control the dynamics simulation behavior. Based on a series of initial instructions provided by the user, new codes are automatically written and executed on-the-fly. These codes allow, for instance, checking specific conditions to terminate the simulations.</p>
<h2 id="drawbacks">Drawbacks</h2>

<p>To keep a modular architecture for easy inclusion of new algorithms, Newton-X is organized as a series of independent programs connected by general program drivers. For this reason, a large amount of <a class="uri" href="input/output" title="wikilink">input/output</a> is required during the program's execution, reducing its efficiency. When dynamics is based on <a href="Ab_initio_quantum_chemistry_methods" title="wikilink">ab initio</a> methods, this is normally not a problem, as the time bottleneck is in the electronic structure calculation. Low efficiency due to input/output can, however, be relevant with <a href="Semiempirical_quantum_chemistry_method" title="wikilink">semiempirical</a> methods.</p>

<p>Other problems with the current implementation are the lack of parallelization of the code, especially of the couplings computation, and the restriction of the program to Linux systems.</p>
<h2 id="references">References</h2>
<h2 id="external-links">External links</h2>
<ul>
<li><a href="http://www.newtonx.org">Newton-X webpage</a></li>
<li><a href="https://groups.google.com/forum/?fromgroups#!forum/newtonx">Discussion forum</a></li>
</ul>

<p>"</p>

<p><a href="Category:Computational_chemistry_software" title="wikilink">Category:Computational chemistry software</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1"><a href="#fnref1">‚Ü©</a></li>
<li id="fn2"><a href="#fnref2">‚Ü©</a></li>
<li id="fn3"><a href="#fnref3">‚Ü©</a></li>
<li id="fn4"><a href="#fnref4">‚Ü©</a></li>
<li id="fn5"><a href="#fnref5">‚Ü©</a></li>
<li id="fn6"></li>
<li id="fn7"></li>
<li id="fn8"><a href="#fnref8">‚Ü©</a></li>
<li id="fn9"><a href="#fnref9">‚Ü©</a></li>
<li id="fn10"><a href="#fnref10">‚Ü©</a></li>
<li id="fn11"></li>
<li id="fn12"></li>
<li id="fn13"><a href="#fnref13">‚Ü©</a></li>
<li id="fn14"></li>
<li id="fn15"><a href="#fnref15">‚Ü©</a></li>
</ol>
</section>
</body>
</html>

<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="86">Undersampling</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Undersampling</h1>
<hr/>

<p> </p>

<p>In <a href="signal_processing" title="wikilink">signal processing</a>, <strong>undersampling</strong> or <strong>bandpass sampling</strong> is a technique where one <a href="Sampling_(signal_processing)" title="wikilink">samples</a> a <a class="uri" href="bandpass" title="wikilink">bandpass</a>-filtered signal at a <a href="sample_rate" title="wikilink">sample rate</a> below its <a href="Nyquist_rate" title="wikilink">Nyquist rate</a> (twice the upper <a href="cutoff_frequency" title="wikilink">cutoff frequency</a>), but is still able to reconstruct the signal.</p>

<p>When one undersamples a bandpass signal, the samples are indistinguishable from the samples of a low-frequency <a href="aliasing" title="wikilink">alias</a> of the high-frequency signal. Such sampling is also known as bandpass sampling, harmonic sampling, IF sampling, and direct IF-to-digital conversion.<a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a></p>
<h2 id="description">Description</h2>

<p>The <a href="Fourier_transform" title="wikilink">Fourier transforms</a> of real-valued functions are symmetrical around the 0 <a href="Hertz" title="wikilink">Hz</a> axis. After sampling, only a <a href="periodic_summation" title="wikilink">periodic summation</a> of the Fourier transform (called <a href="discrete-time_Fourier_transform" title="wikilink">discrete-time Fourier transform</a>) is still available. The individual, frequency-shifted copies of the original transform are called <em>aliases</em>. The frequency offset between adjacent aliases is the sampling-rate, denoted by <em>f<sub>s</sub></em>. When the aliases are mutually exclusive (spectrally), the original transform and the original continuous function, or a frequency-shifted version of it (if desired), can be recovered from the samples. The first and third graphs of Figure 1 depict a <a class="uri" href="baseband" title="wikilink">baseband</a> spectrum before and after being sampled at a rate that completely separates the aliases.</p>

<p>The second graph of Figure 1 depicts the frequency profile of a bandpass function occupying the band (<em>A</em>, <em>A</em>+<em>B</em>) (shaded blue) and its mirror image (shaded beige). The condition for a non-destructive sample rate is that the aliases of both bands do not overlap when shifted by all integer multiples of <em>f<sub>s</sub></em>. The fourth graph depicts the spectral result of sampling at the same rate as the baseband function. The rate was chosen by finding the lowest rate that is an integer sub-multiple of <em>A</em> and also satisfies the baseband <a href="Nyquist_rate" title="wikilink">Nyquist criterion</a>: <em>f<sub>s</sub></em> &gt; 2<em>B</em>.  Consequently, the bandpass function has effectively been converted to baseband. All the other rates that avoid overlap are given by these more general criteria, where <em>A</em> and <em>A</em>+<em>B</em> are replaced by <em>f<sub>L</sub></em> and <em>f<sub>H</sub></em>, respectively<strong>:</strong><a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a><a class="footnoteRef" href="#fn3" id="fnref3"><sup>3</sup></a></p>

<p>

<math display="block" id="Undersampling:0">
 <semantics>
  <mrow>
   <mfrac>
    <mrow>
     <mn>2</mn>
     <msub>
      <mi>f</mi>
      <mi>H</mi>
     </msub>
    </mrow>
    <mi>n</mi>
   </mfrac>
   <mo>≤</mo>
   <msub>
    <mi>f</mi>
    <mi>s</mi>
   </msub>
   <mo>≤</mo>
   <mfrac>
    <mrow>
     <mn>2</mn>
     <msub>
      <mi>f</mi>
      <mi>L</mi>
     </msub>
    </mrow>
    <mrow>
     <mi>n</mi>
     <mo>-</mo>
     <mn>1</mn>
    </mrow>
   </mfrac>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <leq></leq>
     <apply>
      <divide></divide>
      <apply>
       <times></times>
       <cn type="integer">2</cn>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>f</ci>
        <ci>H</ci>
       </apply>
      </apply>
      <ci>n</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>f</ci>
      <ci>s</ci>
     </apply>
    </apply>
    <apply>
     <leq></leq>
     <share href="#.cmml">
     </share>
     <apply>
      <divide></divide>
      <apply>
       <times></times>
       <cn type="integer">2</cn>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>f</ci>
        <ci>L</ci>
       </apply>
      </apply>
      <apply>
       <minus></minus>
       <ci>n</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \frac{2f_{H}}{n}\leq f_{s}\leq\frac{2f_{L}}{n-1}
  </annotation>
 </semantics>
</math>

, for any integer <em>n</em> satisfying

<math display="block" id="Undersampling:1">
 <semantics>
  <mrow>
   <mn>1</mn>
   <mo>≤</mo>
   <mi>n</mi>
   <mo>≤</mo>
   <mrow>
    <mo>⌊</mo>
    <mfrac>
     <msub>
      <mi>f</mi>
      <mi>H</mi>
     </msub>
     <mrow>
      <msub>
       <mi>f</mi>
       <mi>H</mi>
      </msub>
      <mo>-</mo>
      <msub>
       <mi>f</mi>
       <mi>L</mi>
      </msub>
     </mrow>
    </mfrac>
    <mo>⌋</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <leq></leq>
     <cn type="integer">1</cn>
     <ci>n</ci>
    </apply>
    <apply>
     <leq></leq>
     <share href="#.cmml">
     </share>
     <apply>
      <floor></floor>
      <apply>
       <divide></divide>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>f</ci>
        <ci>H</ci>
       </apply>
       <apply>
        <minus></minus>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>f</ci>
         <ci>H</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>f</ci>
         <ci>L</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   1\leq n\leq\left\lfloor\frac{f_{H}}{f_{H}-f_{L}}\right\rfloor
  </annotation>
 </semantics>
</math>

</p>

<p>The highest <em>n</em> for which the condition is satisfied leads to the lowest possible sampling rates.</p>

<p>Important signals of this sort include a radio's intermediate-frequency (IF), radio-frequency (RF) signal, and the individual <em>channels</em> of a <a href="Filter_bank#FFT_filter_banks" title="wikilink">filter bank</a>.</p>

<p>If <em>n</em> &gt; 1, then the conditions result in what is sometimes referred to as <em>undersampling</em>, <em>bandpass sampling</em>, or using a sampling rate less than the Nyquist rate (2<em>f<sub>H</sub></em>). For the case of a given sampling frequency, simpler formulae for the constraints on the signal's spectral band are given below.</p>

<p> </p>
<dl>
<dd><strong>Example:</strong> Consider <a href="FM_radio" title="wikilink">FM radio</a> to illustrate the idea of undersampling.
</dd>
</dl>
<dl>
<dd>In the US, FM radio operates on the frequency band from <em>f<sub>L</sub></em> = 88 <a href="megahertz" title="wikilink">MHz</a> to <em>f<sub>H</sub></em> = 108 MHz. The bandwidth is given by
</dd>
</dl>
<dl>
<dd><dl>
<dd>

<math display="inline" id="Undersampling:2">
 <semantics>
  <mrow>
   <mi>W</mi>
   <mo>=</mo>
   <mrow>
    <msub>
     <mi>f</mi>
     <mi>H</mi>
    </msub>
    <mo>-</mo>
    <msub>
     <mi>f</mi>
     <mi>L</mi>
    </msub>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mpadded width="+5pt">
      <mn>108</mn>
     </mpadded>
     <mi>MHz</mi>
    </mrow>
    <mo>-</mo>
    <mrow>
     <mpadded width="+5pt">
      <mn>88</mn>
     </mpadded>
     <mi>MHz</mi>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mpadded width="+5pt">
     <mn>20</mn>
    </mpadded>
    <mi>MHz</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <ci>W</ci>
     <apply>
      <minus></minus>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>f</ci>
       <ci>H</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>f</ci>
       <ci>L</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <minus></minus>
      <apply>
       <times></times>
       <cn type="integer">108</cn>
       <ci>MHz</ci>
      </apply>
      <apply>
       <times></times>
       <cn type="integer">88</cn>
       <ci>MHz</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <cn type="integer">20</cn>
      <ci>MHz</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   W=f_{H}-f_{L}=108\ \mathrm{MHz}-88\ \mathrm{MHz}=20\ \mathrm{MHz}
  </annotation>
 </semantics>
</math>


</dd>
</dl>
</dd>
</dl>
<dl>
<dd>The sampling conditions are satisfied for

<p>

<math display="block" id="Undersampling:3">
 <semantics>
  <mrow>
   <mn>1</mn>
   <mo>≤</mo>
   <mi>n</mi>
   <mo>≤</mo>
   <mrow>
    <mo stretchy="false">⌊</mo>
    <mn>5.4</mn>
    <mo stretchy="false">⌋</mo>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mo>⌊</mo>
    <mfrac>
     <mrow>
      <mpadded width="+5pt">
       <mn>108</mn>
      </mpadded>
      <mi>MHz</mi>
     </mrow>
     <mrow>
      <mpadded width="+5pt">
       <mn>20</mn>
      </mpadded>
      <mi>MHz</mi>
     </mrow>
    </mfrac>
    <mo>⌋</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <leq></leq>
     <cn type="integer">1</cn>
     <ci>n</ci>
    </apply>
    <apply>
     <leq></leq>
     <share href="#.cmml">
     </share>
     <apply>
      <floor></floor>
      <cn type="float">5.4</cn>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <floor></floor>
      <apply>
       <divide></divide>
       <apply>
        <times></times>
        <cn type="integer">108</cn>
        <ci>MHz</ci>
       </apply>
       <apply>
        <times></times>
        <cn type="integer">20</cn>
        <ci>MHz</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   1\leq n\leq\lfloor 5.4\rfloor=\left\lfloor{108\ \mathrm{MHz}\over 20\ \mathrm{%
MHz}}\right\rfloor
  </annotation>
 </semantics>
</math>

</p>
</dd>
</dl>
<dl>
<dd>Therefore, <em>n</em> can be 1, 2, 3, 4, or 5.
</dd>
</dl>
<dl>
<dd>The value <em>n</em> = 5 gives the lowest sampling frequencies interval <math>43.2\ \mathrm{MHz}<f_\mathrm{s} (higher="" 108–110="" 2="" 2.5="" 86.4–88="" <="" a="" and="" between="" but="" case,="" fits="" in="" is="" lower="" math="" mhz="" mhz).="" of="" rate="" sampling="" scenario="" signal="" spectrum="" than="" the="" this="" times="" undersampling.=""></f_\mathrm{s}></math></dd>
</dl>
<dl>
<dd>A lower value of <em>n</em> will also lead to a useful sampling rate. For example, using <em>n</em> = 4, the FM band spectrum fits easily between 1.5 and 2.0 times the sampling rate, for a sampling rate near 56 MHz (multiples of the Nyquist frequency being 28, 56, 84, 112, etc.). See the illustrations at the right.
</dd>
</dl>
<dl>
<dd>When undersampling a real-world signal, the sampling circuit must be fast enough to capture the highest signal frequency of interest. Theoretically, each sample should be taken during an infinitesimally short interval, but this is not practically feasible. Instead, the sampling of the signal should be made in a short enough interval that it can represent the instantaneous value of the signal with the highest frequency. This means that in the FM radio example above, the sampling circuit must be able to capture a signal with a frequency of 108 MHz, not 43.2 MHz. Thus, the sampling frequency may be only a little bit greater than 43.2 MHz, but the input bandwidth of the system must be at least 108 MHz. Similarly, the accuracy of the sampling timing, or <a href="aperture_uncertainty" title="wikilink">aperture uncertainty</a> of the sampler, frequently the <a href="analog-to-digital_converter" title="wikilink">analog-to-digital converter</a>, must be appropriate for the frequencies being sampled 108MHz, not the lower sample rate.
</dd>
</dl>
<dl>
<dd>If the sampling theorem is interpreted as requiring twice the highest frequency, then the required sampling rate would be assumed to be greater than the <em>Nyquist rate</em> 216 MHz. While this does satisfy the last condition on the sampling rate, it is grossly oversampled.
</dd>
</dl>
<dl>
<dd>Note that if a band is sampled with <em>n</em> &gt; 1, then a <a href="band-pass_filter" title="wikilink">band-pass filter</a> is required for the <a href="anti-aliasing_filter" title="wikilink">anti-aliasing filter</a>, instead of a lowpass filter.
</dd>
</dl>

<p>As we have seen, the normal baseband condition for reversible sampling is that <em>X</em>(<em>f</em>) = 0 outside the interval<strong>:</strong>   

<math display="inline" id="Undersampling:4">
 <semantics>
  <mrow>
   <mrow>
    <mo>(</mo>
    <mrow>
     <mo>-</mo>
     <mrow>
      <mstyle scriptlevel="+1">
       <mfrac>
        <mn>1</mn>
        <mn>2</mn>
       </mfrac>
      </mstyle>
      <msub>
       <mi>f</mi>
       <mi mathvariant="normal">s</mi>
      </msub>
     </mrow>
    </mrow>
    <mo>,</mo>
    <mrow>
     <mstyle scriptlevel="+1">
      <mfrac>
       <mn>1</mn>
       <mn>2</mn>
      </mfrac>
     </mstyle>
     <msub>
      <mi>f</mi>
      <mi mathvariant="normal">s</mi>
     </msub>
    </mrow>
    <mo>)</mo>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <interval closure="open">
    <apply>
     <minus></minus>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>f</ci>
       <ci>normal-s</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <divide></divide>
      <cn type="integer">1</cn>
      <cn type="integer">2</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>f</ci>
      <ci>normal-s</ci>
     </apply>
    </apply>
   </interval>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \scriptstyle\left(-\frac{1}{2}f_{\mathrm{s}},\frac{1}{2}f_{\mathrm{s}}\right),
  </annotation>
 </semantics>
</math>

</p>

<p>and the reconstructive interpolation function, or lowpass filter impulse response, is  

<math display="inline" id="Undersampling:5">
 <semantics>
  <mrow>
   <mrow>
    <mo>sinc</mo>
    <mrow>
     <mo>(</mo>
     <mrow>
      <mi>t</mi>
      <mo>/</mo>
      <mi>T</mi>
     </mrow>
     <mo>)</mo>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>sinc</ci>
    <apply>
     <divide></divide>
     <ci>t</ci>
     <ci>T</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \scriptstyle\operatorname{sinc}\left(t/T\right).
  </annotation>
 </semantics>
</math>

</p>

<p>To accommodate undersampling, the bandpass condition is that <em>X</em>(<em>f</em>) = 0 outside the union of open positive and negative frequency bands</p>
<dl>
<dd><dl>
<dd><math>
</math></dd>
</dl>
</dd>
</dl>

<p><code>   \left(-\frac{n}2f_\mathrm{s},-\frac{n-1}2f_\mathrm{s}\right)</code><br/>
<code>   \cup\left(\frac{n-1}2f_\mathrm{s},\frac{n}2f_\mathrm{s}\right)</code><br/>
<code> </code><code> for some positive integer </code>

<math display="inline" id="Undersampling:6">
 <semantics>
  <mpadded width="+1.7pt">
   <mi>n</mi>
  </mpadded>
  <annotation-xml encoding="MathML-Content">
   <ci>n</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n\,
  </annotation>
 </semantics>
</math>

<code>.</code></p>
<dl>
<dd><dl>
<dd>which includes the normal baseband condition as case <em>n</em> = 1 (except that where the intervals come together at 0 frequency, they can be closed).
</dd>
</dl>
</dd>
</dl>

<p>The corresponding interpolation function is the bandpass filter given by this difference of lowpass impulse responses<strong>:</strong></p>
<dl>
<dd><dl>
<dd>

<math display="inline" id="Undersampling:7">
 <semantics>
  <mrow>
   <mrow>
    <mi>n</mi>
    <mrow>
     <mo>sinc</mo>
     <mrow>
      <mo>(</mo>
      <mfrac>
       <mrow>
        <mi>n</mi>
        <mi>t</mi>
       </mrow>
       <mi>T</mi>
      </mfrac>
      <mo>)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>-</mo>
   <mrow>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>n</mi>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
    <mrow>
     <mo>sinc</mo>
     <mrow>
      <mo>(</mo>
      <mfrac>
       <mrow>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <mi>n</mi>
          <mo>-</mo>
          <mn>1</mn>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
        <mi>t</mi>
       </mrow>
       <mi>T</mi>
      </mfrac>
      <mo>)</mo>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <minus></minus>
    <apply>
     <times></times>
     <ci>n</ci>
     <apply>
      <ci>sinc</ci>
      <apply>
       <divide></divide>
       <apply>
        <times></times>
        <ci>n</ci>
        <ci>t</ci>
       </apply>
       <ci>T</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <minus></minus>
      <ci>n</ci>
      <cn type="integer">1</cn>
     </apply>
     <apply>
      <ci>sinc</ci>
      <apply>
       <divide></divide>
       <apply>
        <times></times>
        <apply>
         <minus></minus>
         <ci>n</ci>
         <cn type="integer">1</cn>
        </apply>
        <ci>t</ci>
       </apply>
       <ci>T</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n\operatorname{sinc}\left(\frac{nt}{T}\right)-(n-1)\operatorname{sinc}\left(%
\frac{(n-1)t}{T}\right)
  </annotation>
 </semantics>
</math>

.
</dd>
</dl>
</dd>
</dl>

<p>On the other hand, reconstruction is not usually the goal with sampled IF or RF signals. Rather, the sample sequence can be treated as ordinary samples of the signal frequency-shifted to near baseband, and digital demodulation can proceed on that basis, recognizing the spectrum mirroring when <em>n</em> is even.</p>

<p>Further generalizations of undersampling for the case of signals with multiple bands are possible, and signals over multidimensional domains (space or space-time) and have been worked out in detail by <a href="Igor_Kluvánek" title="wikilink">Igor Kluvánek</a>.</p>
<h2 id="see-also">See also</h2>
<ul>
<li><a href="Drizzle_(image_processing)" title="wikilink">Drizzle (image processing)</a></li>
</ul>
<h2 id="references">References</h2>

<p>"</p>

<p><a href="Category:Signal_processing" title="wikilink">Category:Signal processing</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1"><a href="#fnref1">↩</a></li>
<li id="fn2"><a href="#fnref2">↩</a></li>
<li id="fn3"><a href="#fnref3">↩</a></li>
</ol>
</section>
</body>
</html>

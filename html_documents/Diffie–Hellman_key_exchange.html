<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="253">Diffie–Hellman key exchange</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Diffie–Hellman key exchange</h1>
<hr/>

<p><strong>Diffie–Hellman key exchange</strong> (<strong>D–H</strong>) <ref group="nb">Synonyms of Diffie–Hellman key exchange include:</ref></p>
<ul>
<li>Diffie-Hellman-Merkle key exchange</li>
<li>Diffie–Hellman key agreement</li>
<li>Diffie–Hellman key establishment</li>
<li>Diffie–Hellman key negotiation</li>
<li>Exponential key exchange</li>
<li>Diffie–Hellman protocol</li>
<li>Diffie–Hellman handshake is a specific method of securely exchanging <a href="Key_(cryptography)" title="wikilink">cryptographic keys</a> over a public channel and was one of the first <a href="public-key_cryptography" title="wikilink">public-key protocols</a> as originally conceptualized by <a href="Ralph_Merkle" title="wikilink">Ralph Merkle</a>.<a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a><a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a> D–H is one of the earliest practical examples of public <a href="key_exchange" title="wikilink">key exchange</a> implemented within the field of <a class="uri" href="cryptography" title="wikilink">cryptography</a>. The Diffie–Hellman key exchange method allows two parties that have no prior knowledge of each other to jointly establish a <a href="shared_secret" title="wikilink">shared secret</a> key over an <a href="Data_security" title="wikilink">insecure</a> <a href="Channel_(communications)" title="wikilink">channel</a>. This key can then be used to encrypt subsequent communications using a <a href="symmetric_key" title="wikilink">symmetric key</a> <a class="uri" href="cipher" title="wikilink">cipher</a>.</li>
</ul>

<p>The scheme was first published by <a href="Whitfield_Diffie" title="wikilink">Whitfield Diffie</a> and <a href="Martin_Hellman" title="wikilink">Martin Hellman</a> in 1976.<a class="footnoteRef" href="#fn3" id="fnref3"><sup>3</sup></a> By 1975, <a href="James_H._Ellis" title="wikilink">James H. Ellis</a>,<a class="footnoteRef" href="#fn4" id="fnref4"><sup>4</sup></a> <a href="Clifford_Cocks" title="wikilink">Clifford Cocks</a> and <a href="Malcolm_J._Williamson" title="wikilink">Malcolm J. Williamson</a> within <a href="Government_Communications_Headquarters" title="wikilink">GCHQ</a>, the British signals intelligence agency, had also shown how public-key cryptography could be achieved; however, their work was kept secret until 1997.<a class="footnoteRef" href="#fn5" id="fnref5"><sup>5</sup></a></p>

<p>Although Diffie–Hellman key agreement itself is a non-authenticated <a href="key-agreement_protocol" title="wikilink">key-agreement protocol</a>, it provides the basis for a variety of authenticated protocols, and is used to provide <a href="perfect_forward_secrecy" title="wikilink">perfect forward secrecy</a> in <a href="Transport_Layer_Security" title="wikilink">Transport Layer Security</a>'s <a href="ephemeral_key" title="wikilink">ephemeral</a> modes (referred to as EDH or DHE depending on the cipher suite).</p>

<p>The method was followed shortly afterwards by <a href="RSA_(algorithm)" title="wikilink">RSA</a>, an implementation of <a href="public-key_cryptography" title="wikilink">public-key cryptography</a> using asymmetric algorithms.</p>

<p>,<a class="footnoteRef" href="#fn6" id="fnref6"><sup>6</sup></a> from 1977, is now expired and describes the now public domain algorithm. It credits Hellman, Diffie, and Merkle as inventors.</p>
<h2 id="name">Name</h2>

<p>In 2002, Hellman suggested the algorithm be called <strong>Diffie–Hellman–Merkle key exchange</strong> in recognition of <a href="Ralph_Merkle" title="wikilink">Ralph Merkle</a>'s contribution to the invention of <a href="public-key_cryptography" title="wikilink">public-key cryptography</a> (Hellman, 2002), writing:</p>
<blockquote>

<p>The system...has since become known as Diffie–Hellman key exchange. While that system was first described in a paper by Diffie and me, it is a public key distribution system, a concept developed by Merkle, and hence should be called 'Diffie–Hellman–Merkle key exchange' if names are to be associated with it. I hope this small pulpit might help in that endeavor to recognize Merkle's equal contribution to the invention of public key cryptography.<a class="footnoteRef" href="#fn7" id="fnref7"><sup>7</sup></a></p>
</blockquote>
<h2 id="description">Description</h2>

<p> Diffie–Hellman establishes a shared secret that can be used for secret communications while exchanging data over a public network. The following diagram illustrates the general idea of the key exchange by using colors instead of a very large number. The crucial part of the process is that <a href="Alice_and_Bob" title="wikilink">Alice and Bob</a> exchange their secret colors in a mix only. Finally this generates an identical key that is computationally difficult (impossible for modern <a class="uri" href="supercomputers" title="wikilink">supercomputers</a> to do in a reasonable amount of time) to reverse for another party that might have been listening in on them. Alice and Bob now use this common secret to encrypt and decrypt their sent and received data. The starting color (yellow) is arbitrary, but is agreed on in advance by Alice and Bob, and does not need to be secret.</p>
<h3 id="cryptographic-explanation">Cryptographic explanation</h3>

<p>The simplest and the original implementation of the protocol uses the <a href="Multiplicative_group_of_integers_modulo_n" title="wikilink">multiplicative group of integers modulo</a> <em>p</em>, where <em>p</em> is <a href="prime_number" title="wikilink">prime</a>, and <em>g</em> is a <a href="primitive_root_modulo_n" title="wikilink">primitive root</a> modulo <em>p</em>. Here is an example of the protocol, with non-secret values in <span style="color:blue">blue</span>, and secret values in<strong><span style="color:red"> red</span></strong>.</p>
<ol>
<li><a href="Alice_and_Bob" title="wikilink">Alice and Bob</a> agree to use a modulus <em><span style="color:blue">p</span></em> = <span style="color:blue">23</span> and base <em><span style="color:blue">g</span></em> = <span style="color:blue">5</span> (which is a <a href="Primitive_root_modulo_n" title="wikilink">primitive root modulo</a> 23).</li>
<li>Alice chooses a secret integer <strong><em><span style="color:red">a</span></em></strong> = <strong><span style="color:red">6</span></strong>, then sends Bob <em><span style="color:blue">A</span></em> = <em><span style="color:blue">g</span><sup><strong><span style="color:red">a</span></strong></sup></em> mod <em><span style="color:blue">p</span></em>
<ul>
<li><em><span style="color:blue">A</span></em> = <span style="color:blue">5</span><sup><strong><span style="color:red">6</span></strong></sup> mod <span style="color:blue">23</span> = <span style="color:blue">8</span></li>
</ul></li>
<li>Bob chooses a secret integer <strong><em><span style="color:red">b</span></em></strong> = <strong><span style="color:red">15</span></strong>, then sends Alice <em><span style="color:blue">B</span></em> = <em><span style="color:blue">g</span><sup><strong><span style="color:red">b</span></strong></sup></em> mod <em><span style="color:blue">p</span></em>
<ul>
<li><em><span style="color:blue">B</span></em> = <span style="color:blue">5</span><sup><strong><span style="color:red">15</span></strong></sup> mod <span style="color:blue">23</span> = <span style="color:blue">19</span></li>
</ul></li>
<li>Alice computes <strong><em><span style="color:red">s</span></em></strong> = <em><span style="color:blue">B</span><sup><strong><span style="color:red">a</span></strong></sup></em> mod <em><span style="color:blue">p</span></em>
<ul>
<li><strong><em><span style="color:red">s</span></em></strong> = <span style="color:blue">19</span><sup><strong><span style="color:red">6</span></strong></sup> mod <span style="color:blue">23</span> = <strong><span style="color:red">2</span></strong></li>
</ul></li>
<li>Bob computes <strong><em><span style="color:red">s</span></em></strong> = <em><span style="color:blue">A</span><sup><strong><span style="color:red">b</span></strong></sup></em> mod <em><span style="color:blue">p</span></em>
<ul>
<li><strong><em><span style="color:red">s</span></em></strong> = <span style="color:blue">8</span><sup><strong><span style="color:red">15</span></strong></sup> mod <span style="color:blue">23</span> = <strong><span style="color:red">2</span></strong></li>
</ul></li>
<li>Alice and Bob now share a secret (the number <strong><span style="color:red">2</span></strong>).</li>
</ol>

<p>Both Alice and Bob have arrived at the same value, because (<em>g<sup>a</sup></em>)<em><sup>b</sup></em>—for Bob, this is <em>8<sup>15</sup></em> mod <em>23</em> = (<em>g<sup>a</sup></em> mod <em>p</em>)<em><sup>b</sup></em> mod <em>p</em> = (<em>g<sup>a</sup></em>)<em><sup>b</sup></em> mod <em>p</em>—and (<em>g<sup>b</sup></em>)<em><sup>a</sup></em> are equal mod <em>p</em>. Note that only <em>a</em>, <em>b</em>, and <em>(g<sup>ab</sup></em> mod <em>p</em> = <em>g<sup>ba</sup></em> mod <em>p)</em> are kept secret. All the other values – <em>p</em>, <em>g</em>, <em>g<sup>a</sup></em> mod <em>p</em>, and <em>g<sup>b</sup></em> mod <em>p</em> – are sent in the clear. Once Alice and Bob compute the shared secret they can use it as an encryption key, known only to them, for sending messages across the same open communications channel.</p>

<p>Of course, much larger values of <em>a</em>, <em>b</em>, and <em>p</em> would be needed to make this example secure, since there are only 23 possible results of <em>n</em> mod 23. However, if <em>p</em> is a prime of at least 300 digits, and <em>a</em> and <em>b</em> are at least 100 digits long, then even the fastest modern computers cannot find <em>a</em> given only <em>g</em>, <em>p</em> and <em>g<sup>a</sup></em> mod <em>p</em>. Such a problem is called the <a href="discrete_logarithm_problem" title="wikilink">discrete logarithm problem</a>. The computation of <em>g<sup>a</sup></em> mod <em>p</em> is known as <a href="modular_exponentiation" title="wikilink">modular exponentiation</a> and can be done efficiently even for large numbers. Note that <em>g</em> need not be large at all, and in practice is usually a small integer (like 2, 3, ...).</p>
<h3 id="generalization-to-finite-cyclic-groups">Generalization to finite cyclic groups</h3>

<p>Here's a more general description of the protocol,</p>
<ol>
<li>Alice and Bob agree on a finite <a href="cyclic_group" title="wikilink">cyclic group</a> <em>G</em> and a <a href="Generating_set_of_a_group" title="wikilink">generating</a> element <em>g</em> in <em>G</em>. (This is usually done long before the rest of the protocol; <em>g</em> is assumed to be known by all attackers.) We will write the group <em>G</em> multiplicatively.</li>
<li>Alice picks a random <a href="natural_number" title="wikilink">natural number</a> <em>a</em> and sends <em>g<sup>a</sup></em> to Bob.</li>
<li>Bob picks a random natural number <em>b</em> and sends <em>g<sup>b</sup></em> to Alice.</li>
<li>Alice computes (<em>g<sup>b</sup></em>)<em><sup>a</sup></em>.</li>
<li>Bob computes (<em>g<sup>a</sup></em>)<em><sup>b</sup></em>.</li>
</ol>

<p>Both Alice and Bob are now in possession of the group element <em>g<sup>ab</sup></em>, which can serve as the shared secret key.</p>
<h3 id="secrecy-chart">Secrecy chart</h3>

<p>The chart below depicts who knows what, again with non-secret values in <span style="color:blue">blue</span>, and secret values in<strong><span style="color:red"> red</span></strong>. Here Eve is an <a class="uri" href="eavesdropper" title="wikilink">eavesdropper</a>—she watches what is sent between Alice and Bob, but she does not alter the contents of their communications.</p>
<ul>
<li><em><span style="color:blue">g</span></em> = public (prime) base, known to Alice, Bob, and Eve. <em><span style="color:blue">g</span></em> = <span style="color:blue">5</span></li>
<li><em><span style="color:blue">p</span></em> = public (prime) modulus, known to Alice, Bob, and Eve. <em><span style="color:blue">p</span></em> = <span style="color:blue">23</span></li>
</ul>
<ul>
<li><strong><em><span style="color:red">a</span></em></strong> = Alice's private key, known only to Alice. <strong><em><span style="color:red">a</span></em></strong> = <strong><span style="color:red">6</span></strong></li>
<li><strong><em><span style="color:red">b</span></em></strong> = Bob's private key known only to Bob. <strong><em><span style="color:red">b</span></em></strong> = <strong><span style="color:red">15</span></strong></li>
</ul>
<ul>
<li><em><span style="color:blue">A</span></em> = Alice's public key, known to Alice, Bob, and Eve. <em><span style="color:blue">A</span></em> = <em><span style="color:blue">g</span><sup><strong><span style="color:red">a</span></strong></sup></em> mod <em><span style="color:blue">p</span></em> = <span style="color:blue">8</span></li>
<li><em><span style="color:blue">B</span></em> = Bob's public key, known to Alice, Bob, and Eve. <em><span style="color:blue">B</span></em> = <em><span style="color:blue">g</span><sup><strong><span style="color:red">b</span></strong></sup></em> mod <em><span style="color:blue">p</span></em> = <span style="color:blue">19</span></li>
</ul>
<table>
<tbody>
<tr class="odd">
<td style="text-align: left;"><table>
<tbody>
<tr class="odd">
<td style="text-align: left;">
<p>Alice</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>Known</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p><em><span style="color:blue">p</span></em> = <span style="color:blue">23</span></p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p><em><span style="color:blue">g</span></em> = <span style="color:blue">5</span></p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p><strong><em><span style="color:red">a</span></em></strong> = <strong><span style="color:red">6</span></strong></p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p><em><span style="color:blue">A</span></em> = <span style="color:blue">5</span><sup><strong><span style="color:red">a</span></strong></sup> mod <span style="color:blue">23</span></p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p><em><span style="color:blue">A</span></em> = <span style="color:blue">5</span><sup><strong><span style="color:red">6</span></strong></sup> mod <span style="color:blue">23</span> = <span style="color:blue">8</span></p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p><strong><em><span style="color:blue">B</span></em></strong> = <strong><span style="color:blue">19</span></strong></p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p><strong>''<span style="color:red">s</span></strong>'' = <span style="color:blue">B</span><sup><strong><span style="color:red">a</span></strong></sup> mod <span style="color:blue">23</span>'''</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p><strong><em><span style="color:red">s</span></em></strong> = <span style="color:blue">19</span><sup><strong><em><span style="color:red">6</span></em></strong></sup> mod <span style="color:blue">23</span> = <strong><span style="color:red">2</span></strong></p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p><strong><em><span style="color:red">s</span></em></strong> = <strong><span style="color:red">2</span></strong></p></td>
</tr>
</tbody>
</table></td>
<td style="text-align: left;"><table>
<tbody>
<tr class="odd">
<td style="text-align: left;">
<p>Bob</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>Known</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p><em><span style="color:blue">p</span></em> = <span style="color:blue">23</span></p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p><em><span style="color:blue">g</span></em> = <span style="color:blue">5</span></p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p><strong><em><span style="color:red">b</span></em></strong> = <strong><span style="color:red">15</span></strong></p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p><em><span style="color:blue">B</span></em> = <span style="color:blue">5</span><sup><strong><em><span style="color:red">b</span></em></strong></sup> mod <span style="color:blue">23</span></p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p><em><span style="color:blue">B</span></em> = <span style="color:blue">5</span><sup><strong><span style="color:red">15</span></strong></sup> mod <span style="color:blue">23</span> = <span style="color:blue">19</span></p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p><strong><em><span style="color:blue">A</span></em></strong> = <strong><span style="color:blue">8</span></strong></p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p><strong>''<span style="color:red">s</span></strong>'' = <span style="color:blue">A</span><sup><strong><span style="color:red">b</span></strong></sup> mod <span style="color:blue">23</span>'''</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p><strong><em><span style="color:red">s</span></em></strong> = <span style="color:blue">8</span><sup><strong><em><span style="color:red">15</span></em></strong></sup> mod <span style="color:blue">23</span> = <strong><span style="color:red">2</span></strong></p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p><strong><em><span style="color:red">s</span></em></strong> = <strong><span style="color:red">2</span></strong></p></td>
</tr>
</tbody>
</table></td>
<td style="text-align: left;"><table>
<tbody>
<tr class="odd">
<td style="text-align: left;">
<p>Eve</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>Known</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p><em><span style="color:blue">p</span></em> = <span style="color:blue">23</span></p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p><em><span style="color:blue">g</span></em> = <span style="color:blue">5</span></p></td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p><em><span style="color:blue">A</span></em> = <span style="color:blue">8</span></p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p><em><span style="color:blue">B</span></em> = <span style="color:blue">19</span></p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p><strong><em><span style="color:red">s</span></em></strong> = <span style="color:blue">19</span><sup><strong><em><span style="color:red">a</span></em></strong></sup> mod <span style="color:blue">23</span> = <span style="color:blue">8</span><sup><strong><em><span style="color:red">b</span></em></strong></sup> mod <span style="color:blue">23</span></p></td>
</tr>
</tbody>
</table></td>
</tr>
</tbody>
</table>
<ul>
<li>Now <strong><em><span style="color:red">s</span></em></strong>, the shared secret key and it is known to both Alice and Bob, but <em>not</em> to Eve.</li>
</ul>

<p>Note: It should be difficult for Alice to solve for Bob's private key or for Bob to solve for Alice's private key. If it is not difficult for Alice to solve for Bob's private key (or vice versa), Eve may simply substitute her own private / public key pair, plug Bob's public key into her private key, produce a fake shared secret key, and solve for Bob's private key (and use that to solve for the shared secret key. Eve may attempt to choose a public / private key pair that will make it easy for her to solve for Bob's private key). Another demonstration of Diffie-Hellman (also using numbers too small for practical use) is given here <a class="footnoteRef" href="#fn8" id="fnref8"><sup>8</sup></a></p>
<h2 id="operation-with-more-than-two-parties">Operation with more than two parties</h2>

<p>Diffie–Hellman key agreement is not limited to negotiating a key shared by only two participants. Any number of users can take part in an agreement by performing iterations of the agreement protocol and exchanging intermediate data (which does not itself need to be kept secret). For example, Alice, Bob, and Carol could participate in a Diffie–Hellman agreement as follows, with all operations taken to be modulo 

<math display="inline" id="Diffie–Hellman_key_exchange:0">
 <semantics>
  <mi>p</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>p</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p
  </annotation>
 </semantics>
</math>

:</p>
<ol>
<li>The parties agree on the algorithm parameters 

<math display="inline" id="Diffie–Hellman_key_exchange:1">
 <semantics>
  <mi>p</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>p</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Diffie–Hellman_key_exchange:2">
 <semantics>
  <mi>g</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>g</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   g
  </annotation>
 </semantics>
</math>

.</li>
<li>The parties generate their private keys, named 

<math display="inline" id="Diffie–Hellman_key_exchange:3">
 <semantics>
  <mi>a</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>a</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a
  </annotation>
 </semantics>
</math>

, 

<math display="inline" id="Diffie–Hellman_key_exchange:4">
 <semantics>
  <mi>b</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>b</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   b
  </annotation>
 </semantics>
</math>

, and 

<math display="inline" id="Diffie–Hellman_key_exchange:5">
 <semantics>
  <mi>c</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>c</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   c
  </annotation>
 </semantics>
</math>

.</li>
<li>Alice computes 

<math display="inline" id="Diffie–Hellman_key_exchange:6">
 <semantics>
  <msup>
   <mi>g</mi>
   <mi>a</mi>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>g</ci>
    <ci>a</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   g^{a}
  </annotation>
 </semantics>
</math>

 and sends it to Bob.</li>
<li>Bob computes 

<math display="inline" id="Diffie–Hellman_key_exchange:7">
 <semantics>
  <mrow>
   <msup>
    <mrow>
     <mo stretchy="false">(</mo>
     <msup>
      <mi>g</mi>
      <mi>a</mi>
     </msup>
     <mo stretchy="false">)</mo>
    </mrow>
    <mi>b</mi>
   </msup>
   <mo>=</mo>
   <msup>
    <mi>g</mi>
    <mrow>
     <mi>a</mi>
     <mi>b</mi>
    </mrow>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>g</ci>
      <ci>a</ci>
     </apply>
     <ci>b</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>g</ci>
     <apply>
      <times></times>
      <ci>a</ci>
      <ci>b</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (g^{a})^{b}=g^{ab}
  </annotation>
 </semantics>
</math>

 and sends it to Carol.</li>
<li>Carol computes 

<math display="inline" id="Diffie–Hellman_key_exchange:8">
 <semantics>
  <mrow>
   <msup>
    <mrow>
     <mo stretchy="false">(</mo>
     <msup>
      <mi>g</mi>
      <mrow>
       <mi>a</mi>
       <mi>b</mi>
      </mrow>
     </msup>
     <mo stretchy="false">)</mo>
    </mrow>
    <mi>c</mi>
   </msup>
   <mo>=</mo>
   <msup>
    <mi>g</mi>
    <mrow>
     <mi>a</mi>
     <mi>b</mi>
     <mi>c</mi>
    </mrow>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>g</ci>
      <apply>
       <times></times>
       <ci>a</ci>
       <ci>b</ci>
      </apply>
     </apply>
     <ci>c</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>g</ci>
     <apply>
      <times></times>
      <ci>a</ci>
      <ci>b</ci>
      <ci>c</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (g^{ab})^{c}=g^{abc}
  </annotation>
 </semantics>
</math>

 and uses it as her secret.</li>
<li>Bob computes 

<math display="inline" id="Diffie–Hellman_key_exchange:9">
 <semantics>
  <msup>
   <mi>g</mi>
   <mi>b</mi>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>g</ci>
    <ci>b</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   g^{b}
  </annotation>
 </semantics>
</math>

 and sends it to Carol.</li>
<li>Carol computes 

<math display="inline" id="Diffie–Hellman_key_exchange:10">
 <semantics>
  <mrow>
   <msup>
    <mrow>
     <mo stretchy="false">(</mo>
     <msup>
      <mi>g</mi>
      <mi>b</mi>
     </msup>
     <mo stretchy="false">)</mo>
    </mrow>
    <mi>c</mi>
   </msup>
   <mo>=</mo>
   <msup>
    <mi>g</mi>
    <mrow>
     <mi>b</mi>
     <mi>c</mi>
    </mrow>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>g</ci>
      <ci>b</ci>
     </apply>
     <ci>c</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>g</ci>
     <apply>
      <times></times>
      <ci>b</ci>
      <ci>c</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (g^{b})^{c}=g^{bc}
  </annotation>
 </semantics>
</math>

 and sends it to Alice.</li>
<li>Alice computes 

<math display="inline" id="Diffie–Hellman_key_exchange:11">
 <semantics>
  <mrow>
   <msup>
    <mrow>
     <mo stretchy="false">(</mo>
     <msup>
      <mi>g</mi>
      <mrow>
       <mi>b</mi>
       <mi>c</mi>
      </mrow>
     </msup>
     <mo stretchy="false">)</mo>
    </mrow>
    <mi>a</mi>
   </msup>
   <mo>=</mo>
   <msup>
    <mi>g</mi>
    <mrow>
     <mi>b</mi>
     <mi>c</mi>
     <mi>a</mi>
    </mrow>
   </msup>
   <mo>=</mo>
   <msup>
    <mi>g</mi>
    <mrow>
     <mi>a</mi>
     <mi>b</mi>
     <mi>c</mi>
    </mrow>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>g</ci>
       <apply>
        <times></times>
        <ci>b</ci>
        <ci>c</ci>
       </apply>
      </apply>
      <ci>a</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>g</ci>
      <apply>
       <times></times>
       <ci>b</ci>
       <ci>c</ci>
       <ci>a</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>g</ci>
      <apply>
       <times></times>
       <ci>a</ci>
       <ci>b</ci>
       <ci>c</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (g^{bc})^{a}=g^{bca}=g^{abc}
  </annotation>
 </semantics>
</math>

 and uses it as her secret.</li>
<li>Carol computes 

<math display="inline" id="Diffie–Hellman_key_exchange:12">
 <semantics>
  <msup>
   <mi>g</mi>
   <mi>c</mi>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>g</ci>
    <ci>c</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   g^{c}
  </annotation>
 </semantics>
</math>

 and sends it to Alice.</li>
<li>Alice computes 

<math display="inline" id="Diffie–Hellman_key_exchange:13">
 <semantics>
  <mrow>
   <msup>
    <mrow>
     <mo stretchy="false">(</mo>
     <msup>
      <mi>g</mi>
      <mi>c</mi>
     </msup>
     <mo stretchy="false">)</mo>
    </mrow>
    <mi>a</mi>
   </msup>
   <mo>=</mo>
   <msup>
    <mi>g</mi>
    <mrow>
     <mi>c</mi>
     <mi>a</mi>
    </mrow>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>g</ci>
      <ci>c</ci>
     </apply>
     <ci>a</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>g</ci>
     <apply>
      <times></times>
      <ci>c</ci>
      <ci>a</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (g^{c})^{a}=g^{ca}
  </annotation>
 </semantics>
</math>

 and sends it to Bob.</li>
<li>Bob computes 

<math display="inline" id="Diffie–Hellman_key_exchange:14">
 <semantics>
  <mrow>
   <msup>
    <mrow>
     <mo stretchy="false">(</mo>
     <msup>
      <mi>g</mi>
      <mrow>
       <mi>c</mi>
       <mi>a</mi>
      </mrow>
     </msup>
     <mo stretchy="false">)</mo>
    </mrow>
    <mi>b</mi>
   </msup>
   <mo>=</mo>
   <msup>
    <mi>g</mi>
    <mrow>
     <mi>c</mi>
     <mi>a</mi>
     <mi>b</mi>
    </mrow>
   </msup>
   <mo>=</mo>
   <msup>
    <mi>g</mi>
    <mrow>
     <mi>a</mi>
     <mi>b</mi>
     <mi>c</mi>
    </mrow>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>g</ci>
       <apply>
        <times></times>
        <ci>c</ci>
        <ci>a</ci>
       </apply>
      </apply>
      <ci>b</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>g</ci>
      <apply>
       <times></times>
       <ci>c</ci>
       <ci>a</ci>
       <ci>b</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>g</ci>
      <apply>
       <times></times>
       <ci>a</ci>
       <ci>b</ci>
       <ci>c</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (g^{ca})^{b}=g^{cab}=g^{abc}
  </annotation>
 </semantics>
</math>

 and uses it as his secret.</li>
</ol>

<p>An eavesdropper has been able to see 

<math display="inline" id="Diffie–Hellman_key_exchange:15">
 <semantics>
  <msup>
   <mi>g</mi>
   <mi>a</mi>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>g</ci>
    <ci>a</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   g^{a}
  </annotation>
 </semantics>
</math>

, 

<math display="inline" id="Diffie–Hellman_key_exchange:16">
 <semantics>
  <msup>
   <mi>g</mi>
   <mi>b</mi>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>g</ci>
    <ci>b</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   g^{b}
  </annotation>
 </semantics>
</math>

, 

<math display="inline" id="Diffie–Hellman_key_exchange:17">
 <semantics>
  <msup>
   <mi>g</mi>
   <mi>c</mi>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>g</ci>
    <ci>c</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   g^{c}
  </annotation>
 </semantics>
</math>

, 

<math display="inline" id="Diffie–Hellman_key_exchange:18">
 <semantics>
  <msup>
   <mi>g</mi>
   <mrow>
    <mi>a</mi>
    <mi>b</mi>
   </mrow>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>g</ci>
    <apply>
     <times></times>
     <ci>a</ci>
     <ci>b</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   g^{ab}
  </annotation>
 </semantics>
</math>

, 

<math display="inline" id="Diffie–Hellman_key_exchange:19">
 <semantics>
  <msup>
   <mi>g</mi>
   <mrow>
    <mi>a</mi>
    <mi>c</mi>
   </mrow>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>g</ci>
    <apply>
     <times></times>
     <ci>a</ci>
     <ci>c</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   g^{ac}
  </annotation>
 </semantics>
</math>

, and 

<math display="inline" id="Diffie–Hellman_key_exchange:20">
 <semantics>
  <msup>
   <mi>g</mi>
   <mrow>
    <mi>b</mi>
    <mi>c</mi>
   </mrow>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>g</ci>
    <apply>
     <times></times>
     <ci>b</ci>
     <ci>c</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   g^{bc}
  </annotation>
 </semantics>
</math>

, but cannot use any combination of these to reproduce 

<math display="inline" id="Diffie–Hellman_key_exchange:21">
 <semantics>
  <msup>
   <mi>g</mi>
   <mrow>
    <mi>a</mi>
    <mi>b</mi>
    <mi>c</mi>
   </mrow>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>g</ci>
    <apply>
     <times></times>
     <ci>a</ci>
     <ci>b</ci>
     <ci>c</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   g^{abc}
  </annotation>
 </semantics>
</math>

.</p>

<p>To extend this mechanism to larger groups, two basic principles must be followed:</p>
<ul>
<li>Starting with an “empty” key consisting only of 

<math display="inline" id="Diffie–Hellman_key_exchange:22">
 <semantics>
  <mi>g</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>g</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   g
  </annotation>
 </semantics>
</math>

, the secret is made by raising the current value to every participant’s private exponent once, in any order (the first such exponentiation yields the participant’s own public key).</li>
<li>Any intermediate value (having up to 

<math display="inline" id="Diffie–Hellman_key_exchange:23">
 <semantics>
  <mrow>
   <mi>N</mi>
   <mo>-</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <minus></minus>
    <ci>N</ci>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   N-1
  </annotation>
 </semantics>
</math>

 exponents applied, where 

<math display="inline" id="Diffie–Hellman_key_exchange:24">
 <semantics>
  <mi>N</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>N</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   N
  </annotation>
 </semantics>
</math>

 is the number of participants in the group) may be revealed publicly, but the final value (having had all 

<math display="inline" id="Diffie–Hellman_key_exchange:25">
 <semantics>
  <mi>N</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>N</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   N
  </annotation>
 </semantics>
</math>

 exponents applied) constitutes the shared secret and hence must never be revealed publicly. Thus, each user must obtain their copy of the secret by applying their own private key last (otherwise there would be no way for the last contributor to communicate the final key to its recipient, as that last contributor would have turned the key into the very secret the group wished to protect).</li>
</ul>

<p>These principles leave open various options for choosing in which order participants contribute to keys. The simplest and most obvious solution is to arrange the 

<math display="inline" id="Diffie–Hellman_key_exchange:26">
 <semantics>
  <mi>N</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>N</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   N
  </annotation>
 </semantics>
</math>

 participants in a circle and have 

<math display="inline" id="Diffie–Hellman_key_exchange:27">
 <semantics>
  <mi>N</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>N</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   N
  </annotation>
 </semantics>
</math>

 keys rotate around the circle, until eventually every key has been contributed to by all 

<math display="inline" id="Diffie–Hellman_key_exchange:28">
 <semantics>
  <mi>N</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>N</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   N
  </annotation>
 </semantics>
</math>

 participants (ending with its owner) and each participant has contributed to 

<math display="inline" id="Diffie–Hellman_key_exchange:29">
 <semantics>
  <mi>N</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>N</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   N
  </annotation>
 </semantics>
</math>

 keys (ending with their own). However, this requires that every participant perform 

<math display="inline" id="Diffie–Hellman_key_exchange:30">
 <semantics>
  <mi>N</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>N</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   N
  </annotation>
 </semantics>
</math>

 modular exponentiations.</p>

<p>By choosing a more optimal order, and relying on the fact that keys can be duplicated, it is possible to reduce the number of modular exponentiations performed by each participant to 

<math display="inline" id="Diffie–Hellman_key_exchange:31">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>log</mi>
     <mn>2</mn>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>N</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>+</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <plus></plus>
    <apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <log></log>
      <cn type="integer">2</cn>
     </apply>
     <ci>N</ci>
    </apply>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \log_{2}(N)+1
  </annotation>
 </semantics>
</math>

 using a divide-and-conquer-style approach, given here for eight participants:</p>
<ol>
<li>Participants A, B, C, and D each perform one exponentiation, yielding 

<math display="inline" id="Diffie–Hellman_key_exchange:32">
 <semantics>
  <msup>
   <mi>g</mi>
   <mrow>
    <mi>a</mi>
    <mi>b</mi>
    <mi>c</mi>
    <mi>d</mi>
   </mrow>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>g</ci>
    <apply>
     <times></times>
     <ci>a</ci>
     <ci>b</ci>
     <ci>c</ci>
     <ci>d</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   g^{abcd}
  </annotation>
 </semantics>
</math>

; this value is sent to E, F, G, and H. In return, participants A, B, C, and D receive 

<math display="inline" id="Diffie–Hellman_key_exchange:33">
 <semantics>
  <msup>
   <mi>g</mi>
   <mrow>
    <mi>e</mi>
    <mi>f</mi>
    <mi>g</mi>
    <mi>h</mi>
   </mrow>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>g</ci>
    <apply>
     <times></times>
     <ci>e</ci>
     <ci>f</ci>
     <ci>g</ci>
     <ci>h</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   g^{efgh}
  </annotation>
 </semantics>
</math>

.</li>
<li>Participants A and B each perform one exponentiation, yielding 

<math display="inline" id="Diffie–Hellman_key_exchange:34">
 <semantics>
  <msup>
   <mi>g</mi>
   <mrow>
    <mi>e</mi>
    <mi>f</mi>
    <mi>g</mi>
    <mi>h</mi>
    <mi>a</mi>
    <mi>b</mi>
   </mrow>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>g</ci>
    <apply>
     <times></times>
     <ci>e</ci>
     <ci>f</ci>
     <ci>g</ci>
     <ci>h</ci>
     <ci>a</ci>
     <ci>b</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   g^{efghab}
  </annotation>
 </semantics>
</math>

, which they send to C and D, while C and D do the same, yielding 

<math display="inline" id="Diffie–Hellman_key_exchange:35">
 <semantics>
  <msup>
   <mi>g</mi>
   <mrow>
    <mi>e</mi>
    <mi>f</mi>
    <mi>g</mi>
    <mi>h</mi>
    <mi>c</mi>
    <mi>d</mi>
   </mrow>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>g</ci>
    <apply>
     <times></times>
     <ci>e</ci>
     <ci>f</ci>
     <ci>g</ci>
     <ci>h</ci>
     <ci>c</ci>
     <ci>d</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   g^{efghcd}
  </annotation>
 </semantics>
</math>

, which they send to A and B.</li>
<li>Participant A performs an exponentiation, yielding 

<math display="inline" id="Diffie–Hellman_key_exchange:36">
 <semantics>
  <msup>
   <mi>g</mi>
   <mrow>
    <mi>e</mi>
    <mi>f</mi>
    <mi>g</mi>
    <mi>h</mi>
    <mi>c</mi>
    <mi>d</mi>
    <mi>a</mi>
   </mrow>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>g</ci>
    <apply>
     <times></times>
     <ci>e</ci>
     <ci>f</ci>
     <ci>g</ci>
     <ci>h</ci>
     <ci>c</ci>
     <ci>d</ci>
     <ci>a</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   g^{efghcda}
  </annotation>
 </semantics>
</math>

, which it sends to B; similarly, B sends 

<math display="inline" id="Diffie–Hellman_key_exchange:37">
 <semantics>
  <msup>
   <mi>g</mi>
   <mrow>
    <mi>e</mi>
    <mi>f</mi>
    <mi>g</mi>
    <mi>h</mi>
    <mi>c</mi>
    <mi>d</mi>
    <mi>b</mi>
   </mrow>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>g</ci>
    <apply>
     <times></times>
     <ci>e</ci>
     <ci>f</ci>
     <ci>g</ci>
     <ci>h</ci>
     <ci>c</ci>
     <ci>d</ci>
     <ci>b</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   g^{efghcdb}
  </annotation>
 </semantics>
</math>

 to A. C and D do similarly.</li>
<li>Participant A performs one final exponentiation, yielding the secret 

<math display="inline" id="Diffie–Hellman_key_exchange:38">
 <semantics>
  <mrow>
   <msup>
    <mi>g</mi>
    <mrow>
     <mi>e</mi>
     <mi>f</mi>
     <mi>g</mi>
     <mi>h</mi>
     <mi>c</mi>
     <mi>d</mi>
     <mi>b</mi>
     <mi>a</mi>
    </mrow>
   </msup>
   <mo>=</mo>
   <msup>
    <mi>g</mi>
    <mrow>
     <mi>a</mi>
     <mi>b</mi>
     <mi>c</mi>
     <mi>d</mi>
     <mi>e</mi>
     <mi>f</mi>
     <mi>g</mi>
     <mi>h</mi>
    </mrow>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>g</ci>
     <apply>
      <times></times>
      <ci>e</ci>
      <ci>f</ci>
      <ci>g</ci>
      <ci>h</ci>
      <ci>c</ci>
      <ci>d</ci>
      <ci>b</ci>
      <ci>a</ci>
     </apply>
    </apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>g</ci>
     <apply>
      <times></times>
      <ci>a</ci>
      <ci>b</ci>
      <ci>c</ci>
      <ci>d</ci>
      <ci>e</ci>
      <ci>f</ci>
      <ci>g</ci>
      <ci>h</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   g^{efghcdba}=g^{abcdefgh}
  </annotation>
 </semantics>
</math>

, while B does the same to get 

<math display="inline" id="Diffie–Hellman_key_exchange:39">
 <semantics>
  <mrow>
   <msup>
    <mi>g</mi>
    <mrow>
     <mi>e</mi>
     <mi>f</mi>
     <mi>g</mi>
     <mi>h</mi>
     <mi>c</mi>
     <mi>d</mi>
     <mi>a</mi>
     <mi>b</mi>
    </mrow>
   </msup>
   <mo>=</mo>
   <msup>
    <mi>g</mi>
    <mrow>
     <mi>a</mi>
     <mi>b</mi>
     <mi>c</mi>
     <mi>d</mi>
     <mi>e</mi>
     <mi>f</mi>
     <mi>g</mi>
     <mi>h</mi>
    </mrow>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>g</ci>
     <apply>
      <times></times>
      <ci>e</ci>
      <ci>f</ci>
      <ci>g</ci>
      <ci>h</ci>
      <ci>c</ci>
      <ci>d</ci>
      <ci>a</ci>
      <ci>b</ci>
     </apply>
    </apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>g</ci>
     <apply>
      <times></times>
      <ci>a</ci>
      <ci>b</ci>
      <ci>c</ci>
      <ci>d</ci>
      <ci>e</ci>
      <ci>f</ci>
      <ci>g</ci>
      <ci>h</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   g^{efghcdab}=g^{abcdefgh}
  </annotation>
 </semantics>
</math>

; again, C and D do similarly.</li>
<li>Participants E through H simultaneously perform the same operations using 

<math display="inline" id="Diffie–Hellman_key_exchange:40">
 <semantics>
  <msup>
   <mi>g</mi>
   <mrow>
    <mi>a</mi>
    <mi>b</mi>
    <mi>c</mi>
    <mi>d</mi>
   </mrow>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>g</ci>
    <apply>
     <times></times>
     <ci>a</ci>
     <ci>b</ci>
     <ci>c</ci>
     <ci>d</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   g^{abcd}
  </annotation>
 </semantics>
</math>

 as their starting point.</li>
</ol>

<p>Once this operation has been completed all participants will possess the secret 

<math display="inline" id="Diffie–Hellman_key_exchange:41">
 <semantics>
  <msup>
   <mi>g</mi>
   <mrow>
    <mi>a</mi>
    <mi>b</mi>
    <mi>c</mi>
    <mi>d</mi>
    <mi>e</mi>
    <mi>f</mi>
    <mi>g</mi>
    <mi>h</mi>
   </mrow>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>g</ci>
    <apply>
     <times></times>
     <ci>a</ci>
     <ci>b</ci>
     <ci>c</ci>
     <ci>d</ci>
     <ci>e</ci>
     <ci>f</ci>
     <ci>g</ci>
     <ci>h</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   g^{abcdefgh}
  </annotation>
 </semantics>
</math>

, but each participant will have performed only four modular exponentiations, rather than the eight implied by a simple circular arrangement.</p>
<h2 id="security">Security</h2>

<p>The protocol is considered secure against eavesdroppers if <em>G</em> and <em>g</em> are chosen properly. The eavesdropper ("<a href="Alice_and_Bob" title="wikilink">Eve</a>") would have to solve the <a href="Diffie–Hellman_problem" title="wikilink">Diffie–Hellman problem</a> to obtain <em>g</em><sup><em>ab</em></sup>. This is currently considered difficult. An efficient algorithm to solve the <a href="discrete_logarithm_problem" title="wikilink">discrete logarithm problem</a> would make it easy to compute <em>a</em> or <em>b</em> and solve the Diffie–Hellman problem, making this and many other public key cryptosystems insecure. Fields of small characteristic may be less secure.<a class="footnoteRef" href="#fn9" id="fnref9"><sup>9</sup></a></p>

<p>The <a href="Glossary_of_group_theory" title="wikilink">order</a> of <em>G</em> should have a large prime factor to prevent use of the <a href="Pohlig–Hellman_algorithm" title="wikilink">Pohlig–Hellman algorithm</a> to obtain <em>a</em> or <em>b</em>. For this reason, a <a href="Sophie_Germain_prime" title="wikilink">Sophie Germain prime</a> <em>q</em> is sometimes used to calculate , called a <a href="safe_prime" title="wikilink">safe prime</a>, since the order of <em>G</em> is then only divisible by 2 and <em>q</em>. <em>g</em> is then sometimes chosen to generate the order <em>q</em> subgroup of <em>G</em>, rather than <em>G</em>, so that the <a href="Legendre_symbol" title="wikilink">Legendre symbol</a> of <em>g<sup>a</sup></em> never reveals the low order bit of <em>a</em>. A protocol using such a choice is for example <a href="Internet_Key_Exchange" title="wikilink">IKEv2</a>.<a class="footnoteRef" href="#fn10" id="fnref10"><sup>10</sup></a></p>

<p><em>g</em> is often a small integer such as 2. Because of the <a href="random_self-reducibility" title="wikilink">random self-reducibility</a> of the discrete logarithm problem a small <em>g</em> is equally secure as any other generator of the same group.</p>

<p>If Alice and Bob use <a href="random_number_generator" title="wikilink">random number generators</a> whose outputs are not completely random and can be predicted to some extent, then Eve's task is much easier.</p>

<p>In the original description, the Diffie–Hellman exchange by itself does not provide <a class="uri" href="authentication" title="wikilink">authentication</a> of the communicating parties and is thus vulnerable to a <a href="man-in-the-middle_attack" title="wikilink">man-in-the-middle attack</a>. <a href="Alice_and_Bob" title="wikilink">Mallory</a> may establish two distinct key exchanges, one with Alice and the other with Bob, effectively masquerading as Alice to Bob, and vice versa, allowing her to decrypt, then re-encrypt, the messages passed between them. Note that Mallory must continue to be in the middle, transferring messages every time Alice and Bob communicate. If she is ever absent, her previous presence is then revealed to Alice and Bob. They will know that all of their private conversations had been intercepted and decoded by someone in the channel.</p>

<p>A method to authenticate the communicating parties to each other is generally needed to prevent this type of attack. Variants of Diffie–Hellman, such as <a href="Station-to-Station_protocol" title="wikilink">STS protocol</a>, may be used instead to avoid these types of attacks.</p>
<h2 id="other-uses">Other uses</h2>
<h3 id="encryption">Encryption</h3>

<p>Public key encryption schemes based on the Diffie–Hellman key exchange have been proposed. The first such scheme is the <a href="ElGamal_encryption" title="wikilink">ElGamal encryption</a>. A more modern variant is the <a href="Integrated_Encryption_Scheme" title="wikilink">Integrated Encryption Scheme</a>.</p>
<h3 id="forward-secrecy">Forward secrecy</h3>

<p>Protocols that achieve <a href="forward_secrecy" title="wikilink">forward secrecy</a> generate new key pairs for each <a href="session_(computer_science)" title="wikilink">session</a> and discard them at the end of the session. The Diffie–Hellman key exchange is a frequent choice for such protocols, because of its fast key generation.</p>
<h3 id="password-authenticated-key-agreement">Password-authenticated key agreement</h3>

<p>When Alice and Bob share a password, they may use a <a href="password-authenticated_key_agreement" title="wikilink">password-authenticated key agreement</a> (PK) form of Diffie–Hellman to prevent man-in-the-middle attacks. One simple scheme is to compare the <a href="Cryptographic_hash_function" title="wikilink">hash</a> of <strong>s</strong> concatenated with the password calculated independently on both ends of channel. A feature of these schemes is that an attacker can only test one specific password on each iteration with the other party, and so the system provides good security with relatively weak passwords. This approach is described in <a class="uri" href="ITU-T" title="wikilink">ITU-T</a> Recommendation <a class="uri" href="X.1035" title="wikilink">X.1035</a>, which is used by the <a class="uri" href="G.hn" title="wikilink">G.hn</a> home networking standard.</p>
<h3 id="public-key">Public key</h3>

<p>It is also possible to use Diffie–Hellman as part of a <a href="public_key_infrastructure" title="wikilink">public key infrastructure</a>, allowing Bob to encrypt a message so that only Alice will be able to decrypt it, with no prior communication between them other than Bob having trusted knowledge of Alice's public key. Alice's public key is 

<math display="inline" id="Diffie–Hellman_key_exchange:42">
 <semantics>
  <mrow>
   <mo stretchy="false">(</mo>
   <mrow>
    <msup>
     <mi>g</mi>
     <mi>a</mi>
    </msup>
    <mo lspace="2.5pt" rspace="2.5pt">mod</mo>
    <mi>p</mi>
   </mrow>
   <mo>,</mo>
   <mi>g</mi>
   <mo>,</mo>
   <mi>p</mi>
   <mo stretchy="false">)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <vector>
    <apply>
     <csymbol cd="latexml">modulo</csymbol>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>g</ci>
      <ci>a</ci>
     </apply>
     <ci>p</ci>
    </apply>
    <ci>g</ci>
    <ci>p</ci>
   </vector>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (g^{a}\bmod{p},g,p)
  </annotation>
 </semantics>
</math>

. To send her a message, Bob chooses a random <em>b</em> and then sends Alice 

<math display="inline" id="Diffie–Hellman_key_exchange:43">
 <semantics>
  <mrow>
   <msup>
    <mi>g</mi>
    <mi>b</mi>
   </msup>
   <mo lspace="2.5pt" rspace="2.5pt">mod</mo>
   <mi>p</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">modulo</csymbol>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>g</ci>
     <ci>b</ci>
    </apply>
    <ci>p</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   g^{b}\bmod p
  </annotation>
 </semantics>
</math>

 (un-encrypted) together with the message encrypted with symmetric key 

<math display="inline" id="Diffie–Hellman_key_exchange:44">
 <semantics>
  <mrow>
   <msup>
    <mrow>
     <mo stretchy="false">(</mo>
     <msup>
      <mi>g</mi>
      <mi>a</mi>
     </msup>
     <mo stretchy="false">)</mo>
    </mrow>
    <mi>b</mi>
   </msup>
   <mo lspace="2.5pt" rspace="2.5pt">mod</mo>
   <mi>p</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">modulo</csymbol>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>g</ci>
      <ci>a</ci>
     </apply>
     <ci>b</ci>
    </apply>
    <ci>p</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (g^{a})^{b}\bmod{p}
  </annotation>
 </semantics>
</math>

. Only Alice can determine the symmetric key and hence decrypt the message because only she has <em>a</em> (the private key). A pre-shared public key also prevents man-in-the-middle attacks.</p>

<p>In practice, Diffie–Hellman is not used in this way, with <a href="RSA_(algorithm)" title="wikilink">RSA</a> being the dominant public key algorithm. This is largely for historical and commercial reasons, namely that <a href="RSA_(security_firm)" title="wikilink">RSA Security</a> created a certificate authority for key signing that became <a class="uri" href="Verisign" title="wikilink">Verisign</a>. Diffie–Hellman cannot be used to sign certificates. However, the <a href="ElGamal_signature_scheme" title="wikilink">ElGamal</a> and <a href="Digital_Signature_Algorithm" title="wikilink">DSA</a> signature algorithms are mathematically related to it, as well as <a class="uri" href="MQV" title="wikilink">MQV</a>, <a href="Station-to-Station_protocol" title="wikilink">STS</a> and the <a href="Internet_key_exchange" title="wikilink">IKE</a> component of the <a class="uri" href="IPsec" title="wikilink">IPsec</a> protocol suite for securing <a href="Internet_Protocol" title="wikilink">Internet Protocol</a> communications.</p>
<h3 id="cryptocurrency">Cryptocurrency</h3>

<p>The sender can produce only the public part of the key, whereas only the receiver can compute the private part. Because of that, the receiver is the only one who can release the funds after the transaction is committed. They need to perform a single-formula check on each transactions to establish if it belongs to them. This process involves their private key, therefore no third party can perform this check and discover the link between the one-time key generated by the sender and the receiver's unique public address. </p>
<h2 id="see-also">See also</h2>
<ul>
<li><a href="Key_exchange" title="wikilink">Key exchange</a></li>
<li><a href="Portal:Cryptography" title="wikilink">Cryptography portal</a></li>
<li><a href="Modular_arithmetic" title="wikilink">Modular arithmetic</a></li>
<li><a href="Elliptic_curve_Diffie–Hellman" title="wikilink">Elliptic curve Diffie–Hellman</a></li>
<li><a href="Public-key_cryptography" title="wikilink">Public-key cryptography</a></li>
<li><a href="ElGamal_encryption" title="wikilink">ElGamal encryption</a></li>
<li><a href="Diffie–Hellman_problem" title="wikilink">Diffie–Hellman problem</a></li>
<li><a class="uri" href="MQV" title="wikilink">MQV</a></li>
<li><a href="Password-authenticated_key_agreement" title="wikilink">Password-authenticated key agreement</a></li>
<li><a href="Secure_Remote_Password_Protocol" title="wikilink">Secure Remote Password Protocol</a></li>
<li><a href="Supersingular_Isogeny_Key_Exchange" title="wikilink">Supersingular Isogeny Key Exchange</a></li>
<li><a href="Logjam_(computer_security)" title="wikilink">Logjam vulnerability</a></li>
</ul>
<h2 id="notes">Notes</h2>
<references group="nb">
</references>
<h2 id="references">References</h2>
<ul>
<li>Dieter Gollmann (2006). <em>Computer Security Second Edition</em> West Sussex, England: John Wiley &amp; Sons, Ltd.</li>
<li><a href="http://www.cesg.gov.uk/publications/Documents/secenc.pdf">Non-Secret Encryption Using a Finite Field</a> MJ Williamson, January 21, 1974.</li>
<li><a href="http://www.fi.muni.cz/usr/matyas/lecture/paper3.pdf">Thoughts on Cheaper Non-Secret Encryption</a> MJ Williamson, August 10, 1976.</li>
<li><a href="http://cryptocellar.web.cern.ch/cryptocellar/cesg/ellis.pdf">The History of Non-Secret Encryption</a> <a href="James_H._Ellis" title="wikilink">JH Ellis</a> 1987 (28K PDF file) (<a href="http://www.jya.com/ellisdoc.htm">HTML version</a>)</li>
<li><a href="http://cr.yp.to/bib/1988/diffie.pdf">The First Ten Years of Public-Key Cryptography</a> Whitfield Diffie, Proceedings of the IEEE, vol. 76, no. 5, May 1988, pp: 560–577 (1.9MB PDF file)</li>
<li><a href="Alfred_Menezes" title="wikilink">Menezes, Alfred</a>; <a href="Paul_van_Oorschot" title="wikilink">van Oorschot, Paul</a>; <a href="Scott_Vanstone" title="wikilink">Vanstone, Scott</a> (1997). <em><a href="Handbook_of_Applied_Cryptography" title="wikilink">Handbook of Applied Cryptography</a></em> Boca Raton, Florida: CRC Press. ISBN 0-8493-8523-7. (<a href="http://www.cacr.math.uwaterloo.ca/hac/">Available online</a>)</li>
<li><a href="Simon_Singh" title="wikilink">Singh, Simon</a> (1999) <em><a href="The_Code_Book:_the_evolution_of_secrecy_from_Mary_Queen_of_Scots_to_quantum_cryptography" title="wikilink">The Code Book: the evolution of secrecy from Mary Queen of Scots to quantum cryptography</a></em> New York: Doubleday ISBN 0-385-49531-5</li>
<li><a href="http://dx.doi.org/10.1109/MCOM.2002.1006971">An Overview of Public Key Cryptography</a> Martin E. Hellman, IEEE Communications Magazine, May 2002, pp:42–49. (123kB PDF file)</li>
</ul>
<h2 id="external-links">External links</h2>
<ul>
<li><a href="http://purl.umn.edu/107353">Oral history interview with Martin Hellman</a>, <a href="Charles_Babbage_Institute" title="wikilink">Charles Babbage Institute</a>, University of Minnesota. Leading cryptography scholar <a href="Martin_Hellman" title="wikilink">Martin Hellman</a> discusses the circumstances and fundamental insights of his invention of <a href="public_key_cryptography" title="wikilink">public key cryptography</a> with collaborators <a href="Whitfield_Diffie" title="wikilink">Whitfield Diffie</a> and <a href="Ralph_Merkle" title="wikilink">Ralph Merkle</a> at Stanford University in the mid-1970s.</li>
<li>RFC 2631 – <em>Diffie–Hellman Key Agreement Method</em> E. Rescorla June 1999.</li>
<li><a href="https://web.archive.org/web/20040903080553/http://csrc.nist.gov/CryptoToolkit/kms/summary-x9-42.pdf">Summary of ANSI X9.42: Agreement of Symmetric Keys Using Discrete Logarithm Cryptography</a> (64K PDF file) (<a href="http://www.rsasecurity.com/rsalabs/node.asp?id=2306">Description of ANSI 9 Standards</a>)</li>
<li>[<a class="uri" href="http://docs.google.com/viewer?a=v&amp;pid">http://docs.google.com/viewer?a=v&amp;pid;</a>;=sites&amp;srcid;=bmV0aXAuY29tfGhvbWV8Z3g6NTA2NTM0YmNhZjRhZDYzZQ Diffie–Hellman Key Exchange – A Non-Mathematician’s Explanation] by Keith Palmgren</li>
<li>[<a class="uri" href="https://metacpan.org/module/Crypt">https://metacpan.org/module/Crypt</a>::DH Crypt::DH] <a class="uri" href="Perl" title="wikilink">Perl</a> module from <a class="uri" href="CPAN" title="wikilink">CPAN</a></li>
<li><a href="http://ds9a.nl/tmp/dh.html">Hands-on Diffie–Hellman demonstration</a></li>
<li><a href="http://oldpiewiki.yoonkn.com/cgi-bin/moin.cgi/DiffieHellmanKeyExchange">C implementation using GNU Multiple Precision Arithmetic Library</a></li>
<li><a href="http://www.cypherspace.org/adam/rsa/perl-dh.html">Diffie Hellman in 2 lines of Perl</a> (using <a href="dc_(computer_program)" title="wikilink">dc</a>)</li>
<li><a href="http://code.google.com/p/sacct/">Smart Account Management (SAcct)</a> (using DH key exchange to derive session key)</li>
<li><a href="https://www.youtube.com/watch?v=YEBfamv-_do">Diffie-Hellman Key Exchange</a> - A YouTube video by <a href="Khan_Academy" title="wikilink">Khan Academy</a> faculty member Brit Cruise</li>
<li><a href="http://video.google.com/videoplay?docid=8991737124862867507">Talk by Martin Hellman in 2007, Google video</a> (broken link)</li>
</ul>

<p>"</p>

<p><a href="Category:Key-agreement_protocols" title="wikilink">Category:Key-agreement protocols</a> <a href="Category:Public-key_cryptography" title="wikilink">Category:Public-key cryptography</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1"><a href="#fnref1">↩</a></li>
<li id="fn2"></li>
<li id="fn3"><a href="#fnref3">↩</a></li>
<li id="fn4"><a href="#fnref4">↩</a></li>
<li id="fn5"><a href="#fnref5">↩</a></li>
<li id="fn6"><a href="#fnref6">↩</a></li>
<li id="fn7"><a href="http://www.comsoc.org/livepubs/ci1/public/anniv/pdfs/hellman.pdf">IEEE Communications Magazine Homepage | IEEE Communications Society</a>. Comsoc.org. Retrieved on 2013-10-29.<a href="#fnref7">↩</a></li>
<li id="fn8"><a class="uri" href="http://buchananweb.co.uk/security02.aspx">http://buchananweb.co.uk/security02.aspx</a><a href="#fnref8">↩</a></li>
<li id="fn9">A Heuristic Quasi-Polynomial Algorithm for Discrete Logarithm in Finite Fields of Small Characteristic," Razvan Barbulescu, Pierrick Gaudry, Antoine Joux, Emmanuel Thomé, Advances in Cryptology – EUROCRYPT 2014, Lecture Notes in Computer Science, Volume 8441, 2014, pp 1-16.<a href="#fnref9">↩</a></li>
<li id="fn10"><a href="#fnref10">↩</a></li>
</ol>
</section>
</body>
</html>

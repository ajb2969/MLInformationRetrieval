<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="1027">Luke's variational principle</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Luke's variational principle</h1>
<hr/>

<p>In <a href="fluid_dynamics" title="wikilink">fluid dynamics</a>, <strong>Luke's variational principle</strong> is a <a class="uri" href="Lagrangian" title="wikilink">Lagrangian</a> <a href="Calculus_of_variations" title="wikilink">variational</a> description of the motion of <a href="ocean_surface_wave" title="wikilink">surface waves</a> on a <a class="uri" href="fluid" title="wikilink">fluid</a> with a <a href="free_surface" title="wikilink">free surface</a>, under the action of <a href="Earth's_gravity" title="wikilink">gravity</a>. This principle is named after J.C. Luke, who published it in 1967.<a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a> This variational principle is for <a class="uri" href="incompressible" title="wikilink">incompressible</a> and <a class="uri" href="inviscid" title="wikilink">inviscid</a> <a href="potential_flow" title="wikilink">potential flows</a>, and is used to derive approximate wave models like the so-called <a href="mild-slope_equation" title="wikilink">mild-slope equation</a>,<a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a> or using the <a href="averaged_Lagrangian" title="wikilink">averaged Lagrangian</a> approach for wave propagation in inhomogeneous media.<a class="footnoteRef" href="#fn3" id="fnref3"><sup>3</sup></a></p>

<p>Luke's Lagrangian formulation can also be recast into a <a href="Hamiltonian_mechanics" title="wikilink">Hamiltonian</a> formulation in terms of the surface elevation and velocity potential at the free surface.<a class="footnoteRef" href="#fn4" id="fnref4"><sup>4</sup></a><a class="footnoteRef" href="#fn5" id="fnref5"><sup>5</sup></a><a class="footnoteRef" href="#fn6" id="fnref6"><sup>6</sup></a> This is often used when modelling the <a href="spectral_density" title="wikilink">spectral density</a> evolution of the free-surface in a <a href="sea_state" title="wikilink">sea state</a>, sometimes called <a href="wave_turbulence" title="wikilink">wave turbulence</a>.</p>

<p>Both the Lagrangian and Hamiltonian formulations can be extended to include <a href="surface_tension" title="wikilink">surface tension</a> effects.</p>
<h2 id="lukes-lagrangian">Luke's Lagrangian</h2>

<p>Luke's <a class="uri" href="Lagrangian" title="wikilink">Lagrangian</a> formulation is for <a class="uri" href="non-linear" title="wikilink">non-linear</a> surface gravity waves on an—<a class="uri" href="incompressible" title="wikilink">incompressible</a>, <a class="uri" href="irrotational" title="wikilink">irrotational</a> and <a href="viscosity" title="wikilink">inviscid</a>—<a href="potential_flow" title="wikilink">potential flow</a>.</p>

<p>The relevant ingredients, needed in order to describe this flow, are:</p>
<ul>
<li><em>Φ</em>(<strong><em>x</em></strong>,<em>z</em>,<em>t</em>) is the <a href="velocity_potential" title="wikilink">velocity potential</a>,</li>
<li><em>ρ</em> is the fluid <a class="uri" href="density" title="wikilink">density</a>,</li>
<li><em>g</em> is the acceleration by the <a href="Earth's_gravity" title="wikilink">Earth's gravity</a>,</li>
<li><strong><em>x</em></strong> is the horizontal coordinate vector with components <em>x</em> and <em>y</em>,</li>
<li><em>x</em> and <em>y</em> are the horizontal coordinates,</li>
<li><em>z</em> is the vertical coordinate,</li>
<li><em>t</em> is time, and</li>
<li>∇ is the horizontal <a class="uri" href="gradient" title="wikilink">gradient</a> operator, so ∇<em>Φ</em> is the horizontal <a href="flow_velocity" title="wikilink">flow velocity</a> consisting of ∂<em>Φ</em>/∂<em>x</em> and ∂<em>Φ</em>/∂<em>y</em>,</li>
<li><em>V</em>(<em>t</em>) is the time-dependent fluid domain with free surface.</li>
</ul>

<p>The Lagrangian 

<math display="inline" id="Luke's_variational_principle:0">
 <semantics>
  <mi class="ltx_font_mathcaligraphic">ℒ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>ℒ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathcal{L}
  </annotation>
 </semantics>
</math>

, as given by Luke, is:</p>

<p>

<math display="block" id="Luke's_variational_principle:1">
 <semantics>
  <mrow>
   <mrow>
    <mi class="ltx_font_mathcaligraphic">ℒ</mi>
    <mo>=</mo>
    <mrow>
     <mo>-</mo>
     <mrow>
      <msubsup>
       <mo largeop="true" symmetric="true">∫</mo>
       <msub>
        <mi>t</mi>
        <mn>0</mn>
       </msub>
       <msub>
        <mi>t</mi>
        <mn>1</mn>
       </msub>
      </msubsup>
      <mrow>
       <mrow>
        <mo>{</mo>
        <mrow>
         <msub>
          <mo largeop="true" symmetric="true">∭</mo>
          <mrow>
           <mi>V</mi>
           <mrow>
            <mo stretchy="false">(</mo>
            <mi>t</mi>
            <mo stretchy="false">)</mo>
           </mrow>
          </mrow>
         </msub>
         <mrow>
          <mi>ρ</mi>
          <mrow>
           <mo>[</mo>
           <mrow>
            <mfrac>
             <mrow>
              <mo>∂</mo>
              <mi mathvariant="normal">Φ</mi>
             </mrow>
             <mrow>
              <mo>∂</mo>
              <mi>t</mi>
             </mrow>
            </mfrac>
            <mo>+</mo>
            <mrow>
             <mfrac>
              <mn>1</mn>
              <mn>2</mn>
             </mfrac>
             <msup>
              <mrow>
               <mo>|</mo>
               <mrow>
                <mo mathvariant="bold">∇</mo>
                <mi mathvariant="normal">Φ</mi>
               </mrow>
               <mo>|</mo>
              </mrow>
              <mn>2</mn>
             </msup>
            </mrow>
            <mo>+</mo>
            <mrow>
             <mfrac>
              <mn>1</mn>
              <mn>2</mn>
             </mfrac>
             <msup>
              <mrow>
               <mo>(</mo>
               <mfrac>
                <mrow>
                 <mo>∂</mo>
                 <mi mathvariant="normal">Φ</mi>
                </mrow>
                <mrow>
                 <mo>∂</mo>
                 <mi>z</mi>
                </mrow>
               </mfrac>
               <mo>)</mo>
              </mrow>
              <mn>2</mn>
             </msup>
            </mrow>
            <mo>+</mo>
            <mrow>
             <mpadded width="+1.7pt">
              <mi>g</mi>
             </mpadded>
             <mi>z</mi>
            </mrow>
           </mrow>
           <mo rspace="5.3pt">]</mo>
          </mrow>
          <mtext>d</mtext>
          <mpadded width="+2.8pt">
           <mi>x</mi>
          </mpadded>
          <mtext>d</mtext>
          <mpadded width="+2.8pt">
           <mi>y</mi>
          </mpadded>
          <mtext>d</mtext>
          <mpadded width="+2.8pt">
           <mi>z</mi>
          </mpadded>
         </mrow>
        </mrow>
        <mo rspace="5.3pt">}</mo>
       </mrow>
       <mtext>d</mtext>
       <mi>t</mi>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>ℒ</ci>
    <apply>
     <minus></minus>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <int></int>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>t</ci>
         <cn type="integer">0</cn>
        </apply>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>t</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <apply>
       <times></times>
       <set>
        <apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <csymbol cd="latexml">triple-integral</csymbol>
          <apply>
           <times></times>
           <ci>V</ci>
           <ci>t</ci>
          </apply>
         </apply>
         <apply>
          <times></times>
          <ci>ρ</ci>
          <apply>
           <csymbol cd="latexml">delimited-[]</csymbol>
           <apply>
            <plus></plus>
            <apply>
             <divide></divide>
             <apply>
              <partialdiff></partialdiff>
              <ci>normal-Φ</ci>
             </apply>
             <apply>
              <partialdiff></partialdiff>
              <ci>t</ci>
             </apply>
            </apply>
            <apply>
             <times></times>
             <apply>
              <divide></divide>
              <cn type="integer">1</cn>
              <cn type="integer">2</cn>
             </apply>
             <apply>
              <csymbol cd="ambiguous">superscript</csymbol>
              <apply>
               <abs></abs>
               <apply>
                <ci>bold-∇</ci>
                <ci>normal-Φ</ci>
               </apply>
              </apply>
              <cn type="integer">2</cn>
             </apply>
            </apply>
            <apply>
             <times></times>
             <apply>
              <divide></divide>
              <cn type="integer">1</cn>
              <cn type="integer">2</cn>
             </apply>
             <apply>
              <csymbol cd="ambiguous">superscript</csymbol>
              <apply>
               <divide></divide>
               <apply>
                <partialdiff></partialdiff>
                <ci>normal-Φ</ci>
               </apply>
               <apply>
                <partialdiff></partialdiff>
                <ci>z</ci>
               </apply>
              </apply>
              <cn type="integer">2</cn>
             </apply>
            </apply>
            <apply>
             <times></times>
             <ci>g</ci>
             <ci>z</ci>
            </apply>
           </apply>
          </apply>
          <mtext>d</mtext>
          <ci>x</ci>
          <mtext>d</mtext>
          <ci>y</ci>
          <mtext>d</mtext>
          <ci>z</ci>
         </apply>
        </apply>
       </set>
       <mtext>d</mtext>
       <ci>t</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathcal{L}=-\int_{t_{0}}^{t_{1}}\left\{\iiint_{V(t)}\rho\left[\frac{\partial%
\Phi}{\partial t}+\frac{1}{2}\left|\boldsymbol{\nabla}\Phi\right|^{2}+\frac{1}%
{2}\left(\frac{\partial\Phi}{\partial z}\right)^{2}+g\,z\right]\;\text{d}x\;%
\text{d}y\;\text{d}z\;\right\}\;\text{d}t.
  </annotation>
 </semantics>
</math>

</p>

<p>From <a href="Bernoulli's_principle" title="wikilink">Bernoulli's principle</a>, this Lagrangian can be seen to be the <a class="uri" href="integral" title="wikilink">integral</a> of the fluid <a class="uri" href="pressure" title="wikilink">pressure</a> over the whole time-dependent fluid domain <em>V</em>(<em>t</em>). This is in agreement with the variational principles for inviscid flow without a free surface, found by <a href="Harry_Bateman" title="wikilink">Harry Bateman</a>.<a class="footnoteRef" href="#fn7" id="fnref7"><sup>7</sup></a></p>

<p><a href="Calculus_of_variations" title="wikilink">Variation</a> with respect to the velocity potential <em>Φ</em>(<strong><em>x<strong><em>,</em>z<em>,</em>t'') and free-moving surfaces like <em>z</em>=<em>η</em>(</strong></em>x</strong><em>,</em>t'') results in the <a href="Laplace_equation" title="wikilink">Laplace equation</a> for the potential in the fluid interior and all required <a href="boundary_conditions" title="wikilink">boundary conditions</a>: <a class="uri" href="kinematic" title="wikilink">kinematic</a> boundary conditions on all fluid boundaries and <a href="dynamics_(mechanics)" title="wikilink">dynamic</a> boundary conditions on free surfaces.<a class="footnoteRef" href="#fn8" id="fnref8"><sup>8</sup></a> This may also include moving wavemaker walls and ship motion.</p>

<p>For the case of a horizontally unbounded domain with the free fluid surface at <em>z</em>=<em>η</em>(<strong><em>x<strong><em>,</em>t'') and a fixed bed at <em>z</em>=−<em>h</em>(</strong></em>x</strong>''), Luke's variational principle results in the Lagrangian:</p>

<p>

<math display="block" id="Luke's_variational_principle:2">
 <semantics>
  <mrow>
   <mrow>
    <mi class="ltx_font_mathcaligraphic">ℒ</mi>
    <mo>=</mo>
    <mrow>
     <mo rspace="4.2pt">-</mo>
     <mrow>
      <msubsup>
       <mo largeop="true" symmetric="true">∫</mo>
       <msub>
        <mi>t</mi>
        <mn>0</mn>
       </msub>
       <msub>
        <mi>t</mi>
        <mn>1</mn>
       </msub>
      </msubsup>
      <mrow>
       <mo largeop="true" symmetric="true">∬</mo>
       <mrow>
        <mrow>
         <mo>{</mo>
         <mrow>
          <mrow>
           <msubsup>
            <mo largeop="true" symmetric="true">∫</mo>
            <mrow>
             <mo>-</mo>
             <mrow>
              <mi>h</mi>
              <mrow>
               <mo stretchy="false">(</mo>
               <mi>𝒙</mi>
               <mo stretchy="false">)</mo>
              </mrow>
             </mrow>
            </mrow>
            <mrow>
             <mi>η</mi>
             <mrow>
              <mo stretchy="false">(</mo>
              <mi>𝒙</mi>
              <mo>,</mo>
              <mi>t</mi>
              <mo stretchy="false">)</mo>
             </mrow>
            </mrow>
           </msubsup>
           <mrow>
            <mpadded width="+1.7pt">
             <mi>ρ</mi>
            </mpadded>
            <mrow>
             <mo>[</mo>
             <mrow>
              <mfrac>
               <mrow>
                <mo>∂</mo>
                <mi mathvariant="normal">Φ</mi>
               </mrow>
               <mrow>
                <mo>∂</mo>
                <mi>t</mi>
               </mrow>
              </mfrac>
              <mo rspace="4.2pt">+</mo>
              <mrow>
               <mfrac>
                <mn>1</mn>
                <mn>2</mn>
               </mfrac>
               <msup>
                <mrow>
                 <mo>|</mo>
                 <mrow>
                  <mo mathvariant="bold">∇</mo>
                  <mi mathvariant="normal">Φ</mi>
                 </mrow>
                 <mo>|</mo>
                </mrow>
                <mn>2</mn>
               </msup>
              </mrow>
              <mo rspace="4.2pt">+</mo>
              <mrow>
               <mfrac>
                <mn>1</mn>
                <mn>2</mn>
               </mfrac>
               <msup>
                <mrow>
                 <mo>(</mo>
                 <mfrac>
                  <mrow>
                   <mo>∂</mo>
                   <mi mathvariant="normal">Φ</mi>
                  </mrow>
                  <mrow>
                   <mo>∂</mo>
                   <mi>z</mi>
                  </mrow>
                 </mfrac>
                 <mo>)</mo>
                </mrow>
                <mn>2</mn>
               </msup>
              </mrow>
             </mrow>
             <mo rspace="5.3pt">]</mo>
            </mrow>
            <mtext>d</mtext>
            <mpadded width="+2.8pt">
             <mi>z</mi>
            </mpadded>
           </mrow>
          </mrow>
          <mo rspace="4.2pt">+</mo>
          <mrow>
           <mpadded width="+1.7pt">
            <mfrac>
             <mn>1</mn>
             <mn>2</mn>
            </mfrac>
           </mpadded>
           <mpadded width="+1.7pt">
            <mi>ρ</mi>
           </mpadded>
           <mpadded width="+1.7pt">
            <mi>g</mi>
           </mpadded>
           <msup>
            <mi>η</mi>
            <mn>2</mn>
           </msup>
          </mrow>
         </mrow>
         <mo rspace="5.3pt">}</mo>
        </mrow>
        <mtext>d</mtext>
        <mpadded width="+2.8pt">
         <mi>𝒙</mi>
        </mpadded>
        <mtext>d</mtext>
        <mi>t</mi>
       </mrow>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>ℒ</ci>
    <apply>
     <minus></minus>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <int></int>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>t</ci>
         <cn type="integer">0</cn>
        </apply>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>t</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <apply>
       <csymbol cd="latexml">double-integral</csymbol>
       <apply>
        <times></times>
        <set>
         <apply>
          <plus></plus>
          <apply>
           <apply>
            <csymbol cd="ambiguous">superscript</csymbol>
            <apply>
             <csymbol cd="ambiguous">subscript</csymbol>
             <int></int>
             <apply>
              <minus></minus>
              <apply>
               <times></times>
               <ci>h</ci>
               <ci>𝒙</ci>
              </apply>
             </apply>
            </apply>
            <apply>
             <times></times>
             <ci>η</ci>
             <interval closure="open">
              <ci>𝒙</ci>
              <ci>t</ci>
             </interval>
            </apply>
           </apply>
           <apply>
            <times></times>
            <ci>ρ</ci>
            <apply>
             <csymbol cd="latexml">delimited-[]</csymbol>
             <apply>
              <plus></plus>
              <apply>
               <divide></divide>
               <apply>
                <partialdiff></partialdiff>
                <ci>normal-Φ</ci>
               </apply>
               <apply>
                <partialdiff></partialdiff>
                <ci>t</ci>
               </apply>
              </apply>
              <apply>
               <times></times>
               <apply>
                <divide></divide>
                <cn type="integer">1</cn>
                <cn type="integer">2</cn>
               </apply>
               <apply>
                <csymbol cd="ambiguous">superscript</csymbol>
                <apply>
                 <abs></abs>
                 <apply>
                  <ci>bold-∇</ci>
                  <ci>normal-Φ</ci>
                 </apply>
                </apply>
                <cn type="integer">2</cn>
               </apply>
              </apply>
              <apply>
               <times></times>
               <apply>
                <divide></divide>
                <cn type="integer">1</cn>
                <cn type="integer">2</cn>
               </apply>
               <apply>
                <csymbol cd="ambiguous">superscript</csymbol>
                <apply>
                 <divide></divide>
                 <apply>
                  <partialdiff></partialdiff>
                  <ci>normal-Φ</ci>
                 </apply>
                 <apply>
                  <partialdiff></partialdiff>
                  <ci>z</ci>
                 </apply>
                </apply>
                <cn type="integer">2</cn>
               </apply>
              </apply>
             </apply>
            </apply>
            <mtext>d</mtext>
            <ci>z</ci>
           </apply>
          </apply>
          <apply>
           <times></times>
           <apply>
            <divide></divide>
            <cn type="integer">1</cn>
            <cn type="integer">2</cn>
           </apply>
           <ci>ρ</ci>
           <ci>g</ci>
           <apply>
            <csymbol cd="ambiguous">superscript</csymbol>
            <ci>η</ci>
            <cn type="integer">2</cn>
           </apply>
          </apply>
         </apply>
        </set>
        <mtext>d</mtext>
        <ci>𝒙</ci>
        <mtext>d</mtext>
        <ci>t</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathcal{L}=-\,\int_{t_{0}}^{t_{1}}\iint\left\{\int_{-h(\boldsymbol{x})}^{\eta%
(\boldsymbol{x},t)}\rho\,\left[\frac{\partial\Phi}{\partial t}+\,\frac{1}{2}%
\left|\boldsymbol{\nabla}\Phi\right|^{2}+\,\frac{1}{2}\left(\frac{\partial\Phi%
}{\partial z}\right)^{2}\right]\;\text{d}z\;+\,\frac{1}{2}\,\rho\,g\,\eta^{2}%
\right\}\;\text{d}\boldsymbol{x}\;\text{d}t.
  </annotation>
 </semantics>
</math>

</p>

<p>The bed-level term proportional to <em>h</em><sup>2</sup> in the potential energy has been neglected, since it is a constant and does not contribute in the variations. Below, Luke's variational principle is used to arrive at the flow equations for non-linear surface gravity waves on a potential flow.</p>
<h3 id="derivation-of-the-flow-equations-resulting-from-lukes-variational-principle">Derivation of the flow equations resulting from Luke's variational principle</h3>

<p>The variation 

<math display="inline" id="Luke's_variational_principle:3">
 <semantics>
  <mrow>
   <mrow>
    <mi>δ</mi>
    <mi class="ltx_font_mathcaligraphic">ℒ</mi>
   </mrow>
   <mo>=</mo>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>δ</ci>
     <ci>ℒ</ci>
    </apply>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \delta\mathcal{L}=0
  </annotation>
 </semantics>
</math>

 in the Lagrangian with respect to variations in the velocity potential <em>Φ</em>(<strong><em>x<strong><em>,</em>z<em>,</em>t''), as well as with respect to the surface elevation <em>η</em>(</strong></em>x</strong><em>,</em>t''), have to be zero. We consider both variations subsequently.</p>
<h4 id="variation-with-respect-to-the-velocity-potential">Variation with respect to the velocity potential</h4>

<p>Consider a small variation <em>δΦ</em> in the velocity potential <em>Φ</em>.<a class="footnoteRef" href="#fn9" id="fnref9"><sup>9</sup></a> Then the resulting variation in the Lagrangian is:</p>

<p>

<math display="inline" id="Luke's_variational_principle:4">
 <semantics>
  <mrow>
   <msub>
    <mi>δ</mi>
    <mi mathvariant="normal">Φ</mi>
   </msub>
   <mi class="ltx_font_mathcaligraphic">ℒ</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>δ</ci>
     <ci>normal-Φ</ci>
    </apply>
    <ci>ℒ</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle\delta_{\Phi}\mathcal{L}
  </annotation>
 </semantics>
</math>


</p>

<p>Using <a href="Leibniz_integral_rule" title="wikilink">Leibniz integral rule</a>, this becomes, in case of constant density <em>ρ</em>:<a class="footnoteRef" href="#fn10" id="fnref10"><sup>10</sup></a></p>

<p>

<math display="inline" id="Luke's_variational_principle:5">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>δ</mi>
     <mi mathvariant="normal">Φ</mi>
    </msub>
    <mpadded width="+1.7pt">
     <mi class="ltx_font_mathcaligraphic">ℒ</mi>
    </mpadded>
   </mrow>
   <mo>=</mo>
   <mi></mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>δ</ci>
      <ci>normal-Φ</ci>
     </apply>
     <ci>ℒ</ci>
    </apply>
    <csymbol cd="latexml">absent</csymbol>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle\delta_{\Phi}\mathcal{L}\,=
  </annotation>
 </semantics>
</math>


</p>

<p>The first integral on the right-hand side integrates out to the boundaries, in <strong><em>x</em></strong> and <em>t</em>, of the integration domain and is zero since the variations <em>δΦ</em> are taken to be zero at these boundaries. For variations <em>δΦ</em> which are zero at the free surface and the bed, the second integral remains, which is only zero for arbitrary <em>δΦ</em> in the fluid interior if there the <a href="Laplace_equation" title="wikilink">Laplace equation</a> holds:</p>

<p>

<math display="block" id="Luke's_variational_principle:6">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mrow>
      <mi mathvariant="normal">Δ</mi>
      <mpadded width="+1.7pt">
       <mi mathvariant="normal">Φ</mi>
      </mpadded>
     </mrow>
     <mo>=</mo>
     <mn>0</mn>
    </mrow>
    <mrow>
     <mrow>
      <mtext>for</mtext>
      <mo>-</mo>
      <mrow>
       <mi>h</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>𝒙</mi>
        <mo rspace="4.2pt" stretchy="false">)</mo>
       </mrow>
      </mrow>
     </mrow>
     <mo rspace="4.2pt"><</mo>
     <mpadded width="+1.7pt">
      <mi>z</mi>
     </mpadded>
     <mo rspace="4.2pt"><</mo>
     <mrow>
      <mi>η</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>𝒙</mi>
       <mo>,</mo>
       <mi>t</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <eq></eq>
     <apply>
      <times></times>
      <ci>normal-Δ</ci>
      <ci>normal-Φ</ci>
     </apply>
     <cn type="float">0</cn>
    </apply>
    <apply>
     <and></and>
     <apply>
      <lt></lt>
      <apply>
       <minus></minus>
       <mtext>for</mtext>
       <apply>
        <times></times>
        <ci>h</ci>
        <ci>𝒙</ci>
       </apply>
      </apply>
      <ci>z</ci>
     </apply>
     <apply>
      <lt></lt>
      <share href="#.cmml">
      </share>
      <apply>
       <times></times>
       <ci>η</ci>
       <interval closure="open">
        <ci>𝒙</ci>
        <ci>t</ci>
       </interval>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Delta\Phi\,=\,0\qquad\text{ for }-h(\boldsymbol{x})\,<\,z\,<\,\eta(%
\boldsymbol{x},t),
  </annotation>
 </semantics>
</math>

</p>

<p>with Δ=∇·∇ + ∂<sup>2</sup>/∂<em>z</em><sup>2</sup> the <a href="Laplace_operator" title="wikilink">Laplace operator</a>.</p>

<p>If variations <em>δΦ</em> are considered which are only non-zero at the free surface, only the third integral remains, giving rise to the kinematic free-surface boundary condition:</p>

<p>

<math display="block" id="Luke's_variational_principle:7">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mrow>
      <mrow>
       <mpadded width="+1.7pt">
        <mfrac>
         <mrow>
          <mo>∂</mo>
          <mi>η</mi>
         </mrow>
         <mrow>
          <mo>∂</mo>
          <mi>t</mi>
         </mrow>
        </mfrac>
       </mpadded>
       <mo rspace="4.2pt">+</mo>
       <mrow>
        <mrow>
         <mo mathvariant="bold">∇</mo>
         <mi mathvariant="normal">Φ</mi>
        </mrow>
        <mo>⋅</mo>
        <mrow>
         <mo mathvariant="bold">∇</mo>
         <mpadded width="+1.7pt">
          <mi>η</mi>
         </mpadded>
        </mrow>
       </mrow>
      </mrow>
      <mo rspace="4.2pt">-</mo>
      <mpadded width="+1.7pt">
       <mfrac>
        <mrow>
         <mo>∂</mo>
         <mi mathvariant="normal">Φ</mi>
        </mrow>
        <mrow>
         <mo>∂</mo>
         <mi>z</mi>
        </mrow>
       </mfrac>
      </mpadded>
     </mrow>
     <mo>=</mo>
     <mn>0.</mn>
    </mrow>
    <mrow>
     <mrow>
      <mtext>at</mtext>
      <mpadded width="+1.7pt">
       <mi>z</mi>
      </mpadded>
     </mrow>
     <mo rspace="4.2pt">=</mo>
     <mrow>
      <mi>η</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>𝒙</mi>
       <mo>,</mo>
       <mi>t</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <eq></eq>
     <apply>
      <minus></minus>
      <apply>
       <plus></plus>
       <apply>
        <divide></divide>
        <apply>
         <partialdiff></partialdiff>
         <ci>η</ci>
        </apply>
        <apply>
         <partialdiff></partialdiff>
         <ci>t</ci>
        </apply>
       </apply>
       <apply>
        <ci>normal-⋅</ci>
        <apply>
         <ci>bold-∇</ci>
         <ci>normal-Φ</ci>
        </apply>
        <apply>
         <ci>bold-∇</ci>
         <ci>η</ci>
        </apply>
       </apply>
      </apply>
      <apply>
       <divide></divide>
       <apply>
        <partialdiff></partialdiff>
        <ci>normal-Φ</ci>
       </apply>
       <apply>
        <partialdiff></partialdiff>
        <ci>z</ci>
       </apply>
      </apply>
     </apply>
     <cn type="float">0.</cn>
    </apply>
    <apply>
     <eq></eq>
     <apply>
      <times></times>
      <mtext>at</mtext>
      <ci>z</ci>
     </apply>
     <apply>
      <times></times>
      <ci>η</ci>
      <interval closure="open">
       <ci>𝒙</ci>
       <ci>t</ci>
      </interval>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \frac{\partial\eta}{\partial t}\,+\,\boldsymbol{\nabla}\Phi\cdot\boldsymbol{%
\nabla}\eta\,-\,\frac{\partial\Phi}{\partial z}\,=\,0.\qquad\text{ at }z\,=\,%
\eta(\boldsymbol{x},t).
  </annotation>
 </semantics>
</math>

</p>

<p>Similarly, variations <em>δΦ</em> only non-zero at the bottom <em>z</em> = -<em>h</em> result in the kinematic bed condition:</p>

<p>

<math display="block" id="Luke's_variational_principle:8">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mrow>
      <mrow>
       <mrow>
        <mo mathvariant="bold">∇</mo>
        <mi mathvariant="normal">Φ</mi>
       </mrow>
       <mo>⋅</mo>
       <mrow>
        <mo mathvariant="bold">∇</mo>
        <mpadded width="+1.7pt">
         <mi>h</mi>
        </mpadded>
       </mrow>
      </mrow>
      <mo rspace="4.2pt">+</mo>
      <mpadded width="+1.7pt">
       <mfrac>
        <mrow>
         <mo>∂</mo>
         <mi mathvariant="normal">Φ</mi>
        </mrow>
        <mrow>
         <mo>∂</mo>
         <mi>z</mi>
        </mrow>
       </mfrac>
      </mpadded>
     </mrow>
     <mo>=</mo>
     <mn>0</mn>
    </mrow>
    <mrow>
     <mrow>
      <mtext>at</mtext>
      <mpadded width="+1.7pt">
       <mi>z</mi>
      </mpadded>
     </mrow>
     <mo rspace="4.2pt">=</mo>
     <mrow>
      <mo>-</mo>
      <mrow>
       <mi>h</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>𝒙</mi>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <eq></eq>
     <apply>
      <plus></plus>
      <apply>
       <ci>normal-⋅</ci>
       <apply>
        <ci>bold-∇</ci>
        <ci>normal-Φ</ci>
       </apply>
       <apply>
        <ci>bold-∇</ci>
        <ci>h</ci>
       </apply>
      </apply>
      <apply>
       <divide></divide>
       <apply>
        <partialdiff></partialdiff>
        <ci>normal-Φ</ci>
       </apply>
       <apply>
        <partialdiff></partialdiff>
        <ci>z</ci>
       </apply>
      </apply>
     </apply>
     <cn type="float">0</cn>
    </apply>
    <apply>
     <eq></eq>
     <apply>
      <times></times>
      <mtext>at</mtext>
      <ci>z</ci>
     </apply>
     <apply>
      <minus></minus>
      <apply>
       <times></times>
       <ci>h</ci>
       <ci>𝒙</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \boldsymbol{\nabla}\Phi\cdot\boldsymbol{\nabla}h\,+\,\frac{\partial\Phi}{%
\partial z}\,=\,0\qquad\text{ at }z\,=\,-h(\boldsymbol{x}).
  </annotation>
 </semantics>
</math>

</p>
<h4 id="variation-with-respect-to-the-surface-elevation">Variation with respect to the surface elevation</h4>

<p>Considering the variation of the Lagrangian with respect to small changes <em>δη</em> gives:</p>

<p>

<math display="block" id="Luke's_variational_principle:9">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>δ</mi>
     <mi>η</mi>
    </msub>
    <mpadded width="+1.7pt">
     <mi class="ltx_font_mathcaligraphic">ℒ</mi>
    </mpadded>
   </mrow>
   <mo rspace="4.2pt">=</mo>
   <mrow>
    <mrow>
     <mi class="ltx_font_mathcaligraphic">ℒ</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi mathvariant="normal">Φ</mi>
      <mo>,</mo>
      <mrow>
       <mi>η</mi>
       <mo>+</mo>
       <mrow>
        <mi>δ</mi>
        <mi>η</mi>
       </mrow>
      </mrow>
      <mo rspace="4.2pt" stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo rspace="4.2pt">-</mo>
    <mrow>
     <mi class="ltx_font_mathcaligraphic">ℒ</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi mathvariant="normal">Φ</mi>
      <mo>,</mo>
      <mi>η</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo rspace="4.2pt">=</mo>
   <mrow>
    <mo rspace="4.2pt">-</mo>
    <mrow>
     <msubsup>
      <mo largeop="true" symmetric="true">∫</mo>
      <msub>
       <mi>t</mi>
       <mn>0</mn>
      </msub>
      <msub>
       <mi>t</mi>
       <mn>1</mn>
      </msub>
     </msubsup>
     <mrow>
      <mo largeop="true" symmetric="true">∬</mo>
      <mrow>
       <mpadded width="+2.8pt">
        <msub>
         <mrow>
          <mo>[</mo>
          <mrow>
           <mpadded width="+1.7pt">
            <mi>ρ</mi>
           </mpadded>
           <mi>δ</mi>
           <mpadded width="+1.7pt">
            <mi>η</mi>
           </mpadded>
           <mrow>
            <mo>(</mo>
            <mrow>
             <mfrac>
              <mrow>
               <mo>∂</mo>
               <mi mathvariant="normal">Φ</mi>
              </mrow>
              <mrow>
               <mo>∂</mo>
               <mi>t</mi>
              </mrow>
             </mfrac>
             <mo rspace="4.2pt">+</mo>
             <mrow>
              <mpadded width="+1.7pt">
               <mfrac>
                <mn>1</mn>
                <mn>2</mn>
               </mfrac>
              </mpadded>
              <mpadded width="+1.7pt">
               <msup>
                <mrow>
                 <mo>|</mo>
                 <mrow>
                  <mo mathvariant="bold">∇</mo>
                  <mi mathvariant="normal">Φ</mi>
                 </mrow>
                 <mo>|</mo>
                </mrow>
                <mn>2</mn>
               </msup>
              </mpadded>
             </mrow>
             <mo rspace="4.2pt">+</mo>
             <mrow>
              <mpadded width="+1.7pt">
               <mfrac>
                <mn>1</mn>
                <mn>2</mn>
               </mfrac>
              </mpadded>
              <msup>
               <mrow>
                <mo>(</mo>
                <mfrac>
                 <mrow>
                  <mo>∂</mo>
                  <mi mathvariant="normal">Φ</mi>
                 </mrow>
                 <mrow>
                  <mo>∂</mo>
                  <mi>z</mi>
                 </mrow>
                </mfrac>
                <mo>)</mo>
               </mrow>
               <mn>2</mn>
              </msup>
             </mrow>
             <mo rspace="4.2pt">+</mo>
             <mrow>
              <mpadded width="+1.7pt">
               <mi>g</mi>
              </mpadded>
              <mi>η</mi>
             </mrow>
            </mrow>
            <mo rspace="4.2pt">)</mo>
           </mrow>
          </mrow>
          <mo>]</mo>
         </mrow>
         <mrow>
          <mi>z</mi>
          <mo>=</mo>
          <mrow>
           <mi>η</mi>
           <mrow>
            <mo stretchy="false">(</mo>
            <mi>𝒙</mi>
            <mo>,</mo>
            <mi>t</mi>
            <mo stretchy="false">)</mo>
           </mrow>
          </mrow>
         </mrow>
        </msub>
       </mpadded>
       <mtext>d</mtext>
       <mpadded width="+2.8pt">
        <mi>𝒙</mi>
       </mpadded>
       <mtext>d</mtext>
       <mpadded width="+1.7pt">
        <mi>t</mi>
       </mpadded>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mn>0.</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>δ</ci>
       <ci>η</ci>
      </apply>
      <ci>ℒ</ci>
     </apply>
     <apply>
      <minus></minus>
      <apply>
       <times></times>
       <ci>ℒ</ci>
       <interval closure="open">
        <ci>normal-Φ</ci>
        <apply>
         <plus></plus>
         <ci>η</ci>
         <apply>
          <times></times>
          <ci>δ</ci>
          <ci>η</ci>
         </apply>
        </apply>
       </interval>
      </apply>
      <apply>
       <times></times>
       <ci>ℒ</ci>
       <interval closure="open">
        <ci>normal-Φ</ci>
        <ci>η</ci>
       </interval>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <minus></minus>
      <apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <int></int>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>t</ci>
          <cn type="integer">0</cn>
         </apply>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>t</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <apply>
        <csymbol cd="latexml">double-integral</csymbol>
        <apply>
         <times></times>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <apply>
           <csymbol cd="latexml">delimited-[]</csymbol>
           <apply>
            <times></times>
            <ci>ρ</ci>
            <ci>δ</ci>
            <ci>η</ci>
            <apply>
             <plus></plus>
             <apply>
              <divide></divide>
              <apply>
               <partialdiff></partialdiff>
               <ci>normal-Φ</ci>
              </apply>
              <apply>
               <partialdiff></partialdiff>
               <ci>t</ci>
              </apply>
             </apply>
             <apply>
              <times></times>
              <apply>
               <divide></divide>
               <cn type="integer">1</cn>
               <cn type="integer">2</cn>
              </apply>
              <apply>
               <csymbol cd="ambiguous">superscript</csymbol>
               <apply>
                <abs></abs>
                <apply>
                 <ci>bold-∇</ci>
                 <ci>normal-Φ</ci>
                </apply>
               </apply>
               <cn type="integer">2</cn>
              </apply>
             </apply>
             <apply>
              <times></times>
              <apply>
               <divide></divide>
               <cn type="integer">1</cn>
               <cn type="integer">2</cn>
              </apply>
              <apply>
               <csymbol cd="ambiguous">superscript</csymbol>
               <apply>
                <divide></divide>
                <apply>
                 <partialdiff></partialdiff>
                 <ci>normal-Φ</ci>
                </apply>
                <apply>
                 <partialdiff></partialdiff>
                 <ci>z</ci>
                </apply>
               </apply>
               <cn type="integer">2</cn>
              </apply>
             </apply>
             <apply>
              <times></times>
              <ci>g</ci>
              <ci>η</ci>
             </apply>
            </apply>
           </apply>
          </apply>
          <apply>
           <eq></eq>
           <ci>z</ci>
           <apply>
            <times></times>
            <ci>η</ci>
            <interval closure="open">
             <ci>𝒙</ci>
             <ci>t</ci>
            </interval>
           </apply>
          </apply>
         </apply>
         <mtext>d</mtext>
         <ci>𝒙</ci>
         <mtext>d</mtext>
         <ci>t</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <cn type="float">0.</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \delta_{\eta}\mathcal{L}\,=\,\mathcal{L}(\Phi,\eta+\delta\eta)\,-\,\mathcal{L}%
(\Phi,\eta)=\,-\,\int_{t_{0}}^{t_{1}}\iint\left[\rho\,\delta\eta\,\left(\frac{%
\partial\Phi}{\partial t}+\,\frac{1}{2}\,\left|\boldsymbol{\nabla}\Phi\right|^%
{2}\,+\,\frac{1}{2}\,\left(\frac{\partial\Phi}{\partial z}\right)^{2}+\,g\,%
\eta\right)\,\right]_{z=\eta(\boldsymbol{x},t)}\;\text{d}\boldsymbol{x}\;\text%
{d}t\,=\,0.
  </annotation>
 </semantics>
</math>

</p>

<p>This has to be zero for arbitrary <em>δη</em>, giving rise to the dynamic boundary condition at the free surface:</p>

<p>

<math display="block" id="Luke's_variational_principle:10">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mrow>
      <mfrac>
       <mrow>
        <mo>∂</mo>
        <mi mathvariant="normal">Φ</mi>
       </mrow>
       <mrow>
        <mo>∂</mo>
        <mi>t</mi>
       </mrow>
      </mfrac>
      <mo rspace="4.2pt">+</mo>
      <mrow>
       <mpadded width="+1.7pt">
        <mfrac>
         <mn>1</mn>
         <mn>2</mn>
        </mfrac>
       </mpadded>
       <mpadded width="+1.7pt">
        <msup>
         <mrow>
          <mo>|</mo>
          <mrow>
           <mo mathvariant="bold">∇</mo>
           <mi mathvariant="normal">Φ</mi>
          </mrow>
          <mo>|</mo>
         </mrow>
         <mn>2</mn>
        </msup>
       </mpadded>
      </mrow>
      <mo rspace="4.2pt">+</mo>
      <mrow>
       <mpadded width="+1.7pt">
        <mfrac>
         <mn>1</mn>
         <mn>2</mn>
        </mfrac>
       </mpadded>
       <msup>
        <mrow>
         <mo>(</mo>
         <mfrac>
          <mrow>
           <mo>∂</mo>
           <mi mathvariant="normal">Φ</mi>
          </mrow>
          <mrow>
           <mo>∂</mo>
           <mi>z</mi>
          </mrow>
         </mfrac>
         <mo>)</mo>
        </mrow>
        <mn>2</mn>
       </msup>
      </mrow>
      <mo rspace="4.2pt">+</mo>
      <mrow>
       <mpadded width="+1.7pt">
        <mi>g</mi>
       </mpadded>
       <mpadded width="+1.7pt">
        <mi>η</mi>
       </mpadded>
      </mrow>
     </mrow>
     <mo>=</mo>
     <mn>0</mn>
    </mrow>
    <mrow>
     <mrow>
      <mtext>at</mtext>
      <mpadded width="+1.7pt">
       <mi>z</mi>
      </mpadded>
     </mrow>
     <mo rspace="4.2pt">=</mo>
     <mrow>
      <mi>η</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>𝒙</mi>
       <mo>,</mo>
       <mi>t</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <eq></eq>
     <apply>
      <plus></plus>
      <apply>
       <divide></divide>
       <apply>
        <partialdiff></partialdiff>
        <ci>normal-Φ</ci>
       </apply>
       <apply>
        <partialdiff></partialdiff>
        <ci>t</ci>
       </apply>
      </apply>
      <apply>
       <times></times>
       <apply>
        <divide></divide>
        <cn type="integer">1</cn>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <abs></abs>
         <apply>
          <ci>bold-∇</ci>
          <ci>normal-Φ</ci>
         </apply>
        </apply>
        <cn type="integer">2</cn>
       </apply>
      </apply>
      <apply>
       <times></times>
       <apply>
        <divide></divide>
        <cn type="integer">1</cn>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <divide></divide>
         <apply>
          <partialdiff></partialdiff>
          <ci>normal-Φ</ci>
         </apply>
         <apply>
          <partialdiff></partialdiff>
          <ci>z</ci>
         </apply>
        </apply>
        <cn type="integer">2</cn>
       </apply>
      </apply>
      <apply>
       <times></times>
       <ci>g</ci>
       <ci>η</ci>
      </apply>
     </apply>
     <cn type="float">0</cn>
    </apply>
    <apply>
     <eq></eq>
     <apply>
      <times></times>
      <mtext>at</mtext>
      <ci>z</ci>
     </apply>
     <apply>
      <times></times>
      <ci>η</ci>
      <interval closure="open">
       <ci>𝒙</ci>
       <ci>t</ci>
      </interval>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \frac{\partial\Phi}{\partial t}+\,\frac{1}{2}\,\left|\boldsymbol{\nabla}\Phi%
\right|^{2}\,+\,\frac{1}{2}\,\left(\frac{\partial\Phi}{\partial z}\right)^{2}+%
\,g\,\eta\,=\,0\qquad\text{ at }z\,=\,\eta(\boldsymbol{x},t).
  </annotation>
 </semantics>
</math>

</p>

<p>This is the <a href="Bernoulli's_principle" title="wikilink">Bernoulli equation</a> for unsteady potential flow, applied at the free surface, and with the pressure above the free surface being a constant — which constant pressure is taken equal to zero for simplicity.</p>
<h2 id="hamiltonian-formulation">Hamiltonian formulation</h2>

<p>The <a href="Hamiltonian_mechanics" title="wikilink">Hamiltonian</a> structure of surface gravity waves on a potential flow was discovered by <a href="Vladimir_E._Zakharov" title="wikilink">Vladimir E. Zakharov</a> in 1968, and rediscovered independently by <a href="Lambertus_Johannes_Folkert_Broer" title="wikilink">Bert Broer</a> and <a href="John_W._Miles" title="wikilink">John Miles</a>:<a class="footnoteRef" href="#fn11" id="fnref11"><sup>11</sup></a><a class="footnoteRef" href="#fn12" id="fnref12"><sup>12</sup></a><a class="footnoteRef" href="#fn13" id="fnref13"><sup>13</sup></a></p>

<p>

<math display="inline" id="Luke's_variational_principle:11">
 <semantics>
  <mrow>
   <mpadded width="+1.7pt">
    <mi>ρ</mi>
   </mpadded>
   <mstyle displaystyle="true">
    <mfrac>
     <mrow>
      <mo>∂</mo>
      <mi>η</mi>
     </mrow>
     <mrow>
      <mo>∂</mo>
      <mi>t</mi>
     </mrow>
    </mfrac>
   </mstyle>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>ρ</ci>
    <apply>
     <divide></divide>
     <apply>
      <partialdiff></partialdiff>
      <ci>η</ci>
     </apply>
     <apply>
      <partialdiff></partialdiff>
      <ci>t</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle\rho\,\frac{\partial\eta}{\partial t}
  </annotation>
 </semantics>
</math>


</p>

<p>where the surface elevation <em>η</em> and surface potential <em>φ</em> — which is the potential <em>Φ</em> at the free surface <em>z</em>=<em>η</em>(<strong><em>x</em></strong>,<em>t</em>) — are the <a href="canonical_coordinates" title="wikilink">canonical variables</a>. The Hamiltonian 

<math display="inline" id="Luke's_variational_principle:12">
 <semantics>
  <mrow>
   <mi class="ltx_font_mathcaligraphic">ℋ</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>φ</mi>
    <mo>,</mo>
    <mi>η</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>ℋ</ci>
    <interval closure="open">
     <ci>φ</ci>
     <ci>η</ci>
    </interval>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathcal{H}(\varphi,\eta)
  </annotation>
 </semantics>
</math>

 is the sum of the <a href="kinetic_energy" title="wikilink">kinetic</a> and <a href="potential_energy" title="wikilink">potential energy</a> of the fluid:</p>

<p>

<math display="block" id="Luke's_variational_principle:13">
 <semantics>
  <mrow>
   <mrow>
    <mpadded width="+1.7pt">
     <mi class="ltx_font_mathcaligraphic">ℋ</mi>
    </mpadded>
    <mo rspace="4.2pt">=</mo>
    <mrow>
     <mo largeop="true" symmetric="true">∬</mo>
     <mrow>
      <mrow>
       <mo>{</mo>
       <mrow>
        <mrow>
         <msubsup>
          <mo largeop="true" symmetric="true">∫</mo>
          <mrow>
           <mo>-</mo>
           <mrow>
            <mi>h</mi>
            <mrow>
             <mo stretchy="false">(</mo>
             <mi>𝒙</mi>
             <mo stretchy="false">)</mo>
            </mrow>
           </mrow>
          </mrow>
          <mrow>
           <mi>η</mi>
           <mrow>
            <mo stretchy="false">(</mo>
            <mi>𝒙</mi>
            <mo>,</mo>
            <mi>t</mi>
            <mo stretchy="false">)</mo>
           </mrow>
          </mrow>
         </msubsup>
         <mrow>
          <mpadded width="+1.7pt">
           <mfrac>
            <mn>1</mn>
            <mn>2</mn>
           </mfrac>
          </mpadded>
          <mpadded width="+1.7pt">
           <mi>ρ</mi>
          </mpadded>
          <mrow>
           <mo>[</mo>
           <mrow>
            <mpadded width="+1.7pt">
             <msup>
              <mrow>
               <mo>|</mo>
               <mrow>
                <mo mathvariant="bold">∇</mo>
                <mi mathvariant="normal">Φ</mi>
               </mrow>
               <mo>|</mo>
              </mrow>
              <mn>2</mn>
             </msup>
            </mpadded>
            <mo rspace="4.2pt">+</mo>
            <msup>
             <mrow>
              <mo>(</mo>
              <mfrac>
               <mrow>
                <mo>∂</mo>
                <mi mathvariant="normal">Φ</mi>
               </mrow>
               <mrow>
                <mo>∂</mo>
                <mi>z</mi>
               </mrow>
              </mfrac>
              <mo>)</mo>
             </mrow>
             <mn>2</mn>
            </msup>
           </mrow>
           <mo rspace="4.2pt">]</mo>
          </mrow>
          <mtext>d</mtext>
          <mpadded width="+1.7pt">
           <mi>z</mi>
          </mpadded>
         </mrow>
        </mrow>
        <mo rspace="4.2pt">+</mo>
        <mrow>
         <mpadded width="+1.7pt">
          <mfrac>
           <mn>1</mn>
           <mn>2</mn>
          </mfrac>
         </mpadded>
         <mpadded width="+1.7pt">
          <mi>ρ</mi>
         </mpadded>
         <mpadded width="+1.7pt">
          <mi>g</mi>
         </mpadded>
         <msup>
          <mi>η</mi>
          <mn>2</mn>
         </msup>
        </mrow>
       </mrow>
       <mo rspace="5.3pt">}</mo>
      </mrow>
      <mtext>d</mtext>
      <mi>𝒙</mi>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>ℋ</ci>
    <apply>
     <csymbol cd="latexml">double-integral</csymbol>
     <apply>
      <times></times>
      <set>
       <apply>
        <plus></plus>
        <apply>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <int></int>
           <apply>
            <minus></minus>
            <apply>
             <times></times>
             <ci>h</ci>
             <ci>𝒙</ci>
            </apply>
           </apply>
          </apply>
          <apply>
           <times></times>
           <ci>η</ci>
           <interval closure="open">
            <ci>𝒙</ci>
            <ci>t</ci>
           </interval>
          </apply>
         </apply>
         <apply>
          <times></times>
          <apply>
           <divide></divide>
           <cn type="integer">1</cn>
           <cn type="integer">2</cn>
          </apply>
          <ci>ρ</ci>
          <apply>
           <csymbol cd="latexml">delimited-[]</csymbol>
           <apply>
            <plus></plus>
            <apply>
             <csymbol cd="ambiguous">superscript</csymbol>
             <apply>
              <abs></abs>
              <apply>
               <ci>bold-∇</ci>
               <ci>normal-Φ</ci>
              </apply>
             </apply>
             <cn type="integer">2</cn>
            </apply>
            <apply>
             <csymbol cd="ambiguous">superscript</csymbol>
             <apply>
              <divide></divide>
              <apply>
               <partialdiff></partialdiff>
               <ci>normal-Φ</ci>
              </apply>
              <apply>
               <partialdiff></partialdiff>
               <ci>z</ci>
              </apply>
             </apply>
             <cn type="integer">2</cn>
            </apply>
           </apply>
          </apply>
          <mtext>d</mtext>
          <ci>z</ci>
         </apply>
        </apply>
        <apply>
         <times></times>
         <apply>
          <divide></divide>
          <cn type="integer">1</cn>
          <cn type="integer">2</cn>
         </apply>
         <ci>ρ</ci>
         <ci>g</ci>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>η</ci>
          <cn type="integer">2</cn>
         </apply>
        </apply>
       </apply>
      </set>
      <mtext>d</mtext>
      <ci>𝒙</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathcal{H}\,=\,\iint\left\{\int_{-h(\boldsymbol{x})}^{\eta(\boldsymbol{x},t)}%
\frac{1}{2}\,\rho\,\left[\left|\boldsymbol{\nabla}\Phi\right|^{2}\,+\,\left(%
\frac{\partial\Phi}{\partial z}\right)^{2}\right]\,\text{d}z\,+\,\frac{1}{2}\,%
\rho\,g\,\eta^{2}\right\}\;\text{d}\boldsymbol{x}.
  </annotation>
 </semantics>
</math>

</p>

<p>The additional constraint is that the flow in the fluid domain has to satisfy <a href="Laplace's_equation" title="wikilink">Laplace's equation</a> with appropriate boundary condition at the bottom <em>z</em>=-<em>h</em>(<strong><em>x</em></strong>) and that the potential at the free surface <em>z</em>=<em>η</em> is equal to <em>φ</em>

<math display="block" id="Luke's_variational_principle:14">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mrow>
      <mi>δ</mi>
      <mi class="ltx_font_mathcaligraphic">ℋ</mi>
     </mrow>
     <mo>/</mo>
     <mi>δ</mi>
    </mrow>
    <mpadded width="+1.7pt">
     <mi mathvariant="normal">Φ</mi>
    </mpadded>
   </mrow>
   <mo>=</mo>
   <mn>0.</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <divide></divide>
      <apply>
       <times></times>
       <ci>δ</ci>
       <ci>ℋ</ci>
      </apply>
      <ci>δ</ci>
     </apply>
     <ci>normal-Φ</ci>
    </apply>
    <cn type="float">0.</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \delta\mathcal{H}/\delta\Phi\,=\,0.
  </annotation>
 </semantics>
</math>

</p>
<h3 id="relation-with-lagrangian-formulation">Relation with Lagrangian formulation</h3>

<p>The Hamiltonian formulation can be derived from Luke's Lagrangian description by using <a href="Leibniz_integral_rule" title="wikilink">Leibniz integral rule</a> on the integral of ∂<em>Φ</em>/∂<em>t</em>:<a class="footnoteRef" href="#fn14" id="fnref14"><sup>14</sup></a></p>

<p>

<math display="block" id="Luke's_variational_principle:15">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi class="ltx_font_mathcaligraphic">ℒ</mi>
     <mi>H</mi>
    </msub>
    <mo>=</mo>
    <mrow>
     <msubsup>
      <mo largeop="true" symmetric="true">∫</mo>
      <msub>
       <mi>t</mi>
       <mn>0</mn>
      </msub>
      <msub>
       <mi>t</mi>
       <mn>1</mn>
      </msub>
     </msubsup>
     <mrow>
      <mo largeop="true" symmetric="true">∬</mo>
      <mrow>
       <mrow>
        <mo>{</mo>
        <mrow>
         <mrow>
          <mi>φ</mi>
          <mrow>
           <mo stretchy="false">(</mo>
           <mi>𝒙</mi>
           <mo>,</mo>
           <mi>t</mi>
           <mo rspace="4.2pt" stretchy="false">)</mo>
          </mrow>
          <mpadded width="+1.7pt">
           <mfrac>
            <mrow>
             <mrow>
              <mo>∂</mo>
              <mi>η</mi>
             </mrow>
             <mrow>
              <mo stretchy="false">(</mo>
              <mi>𝒙</mi>
              <mo>,</mo>
              <mi>t</mi>
              <mo stretchy="false">)</mo>
             </mrow>
            </mrow>
            <mrow>
             <mo>∂</mo>
             <mi>t</mi>
            </mrow>
           </mfrac>
          </mpadded>
         </mrow>
         <mo rspace="4.2pt">-</mo>
         <mrow>
          <mi>H</mi>
          <mrow>
           <mo stretchy="false">(</mo>
           <mi>φ</mi>
           <mo>,</mo>
           <mi>η</mi>
           <mo>;</mo>
           <mi>𝒙</mi>
           <mo>,</mo>
           <mi>t</mi>
           <mo stretchy="false">)</mo>
          </mrow>
         </mrow>
        </mrow>
        <mo rspace="5.3pt">}</mo>
       </mrow>
       <mtext>d</mtext>
       <mpadded width="+2.8pt">
        <mi>𝒙</mi>
       </mpadded>
       <mtext>d</mtext>
       <mi>t</mi>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>ℒ</ci>
     <ci>H</ci>
    </apply>
    <apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <int></int>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>t</ci>
        <cn type="integer">0</cn>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>t</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <apply>
      <csymbol cd="latexml">double-integral</csymbol>
      <apply>
       <times></times>
       <set>
        <apply>
         <minus></minus>
         <apply>
          <times></times>
          <ci>φ</ci>
          <interval closure="open">
           <ci>𝒙</ci>
           <ci>t</ci>
          </interval>
          <apply>
           <divide></divide>
           <apply>
            <times></times>
            <apply>
             <partialdiff></partialdiff>
             <ci>η</ci>
            </apply>
            <interval closure="open">
             <ci>𝒙</ci>
             <ci>t</ci>
            </interval>
           </apply>
           <apply>
            <partialdiff></partialdiff>
            <ci>t</ci>
           </apply>
          </apply>
         </apply>
         <apply>
          <times></times>
          <ci>H</ci>
          <vector>
           <ci>φ</ci>
           <ci>η</ci>
           <ci>𝒙</ci>
           <ci>t</ci>
          </vector>
         </apply>
        </apply>
       </set>
       <mtext>d</mtext>
       <ci>𝒙</ci>
       <mtext>d</mtext>
       <ci>t</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathcal{L}_{H}=\int_{t_{0}}^{t_{1}}\iint\left\{\varphi(\boldsymbol{x},t)\,%
\frac{\partial\eta(\boldsymbol{x},t)}{\partial t}\,-\,H(\varphi,\eta;%
\boldsymbol{x},t)\right\}\;\text{d}\boldsymbol{x}\;\text{d}t,
  </annotation>
 </semantics>
</math>

</p>

<p>with 

<math display="inline" id="Luke's_variational_principle:16">
 <semantics>
  <mrow>
   <mrow>
    <mi>φ</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>𝒙</mi>
     <mo>,</mo>
     <mi>t</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mi mathvariant="normal">Φ</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>𝒙</mi>
     <mo>,</mo>
     <mrow>
      <mi>η</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>𝒙</mi>
       <mo>,</mo>
       <mi>t</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo>,</mo>
     <mi>t</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>φ</ci>
     <interval closure="open">
      <ci>𝒙</ci>
      <ci>t</ci>
     </interval>
    </apply>
    <apply>
     <times></times>
     <ci>normal-Φ</ci>
     <vector>
      <ci>𝒙</ci>
      <apply>
       <times></times>
       <ci>η</ci>
       <interval closure="open">
        <ci>𝒙</ci>
        <ci>t</ci>
       </interval>
      </apply>
      <ci>t</ci>
     </vector>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \varphi(\boldsymbol{x},t)=\Phi(\boldsymbol{x},\eta(\boldsymbol{x},t),t)
  </annotation>
 </semantics>
</math>

 the value of the velocity potential at the free surface, and 

<math display="inline" id="Luke's_variational_principle:17">
 <semantics>
  <mrow>
   <mi>H</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>φ</mi>
    <mo>,</mo>
    <mi>η</mi>
    <mo>;</mo>
    <mi>𝒙</mi>
    <mo>,</mo>
    <mi>t</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>H</ci>
    <vector>
     <ci>φ</ci>
     <ci>η</ci>
     <ci>𝒙</ci>
     <ci>t</ci>
    </vector>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   H(\varphi,\eta;\boldsymbol{x},t)
  </annotation>
 </semantics>
</math>

 the Hamiltonian density — sum of the kinetic and potential energy density — and related to the Hamiltonian as:</p>

<p>

<math display="block" id="Luke's_variational_principle:18">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi class="ltx_font_mathcaligraphic">ℋ</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>φ</mi>
      <mo>,</mo>
      <mi>η</mi>
      <mo rspace="4.2pt" stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo rspace="4.2pt">=</mo>
    <mrow>
     <mo largeop="true" symmetric="true">∬</mo>
     <mrow>
      <mi>H</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>φ</mi>
       <mo>,</mo>
       <mi>η</mi>
       <mo>;</mo>
       <mi>𝒙</mi>
       <mo>,</mo>
       <mi>t</mi>
       <mo rspace="5.3pt" stretchy="false">)</mo>
      </mrow>
      <mtext>d</mtext>
      <mi>𝒙</mi>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>ℋ</ci>
     <interval closure="open">
      <ci>φ</ci>
      <ci>η</ci>
     </interval>
    </apply>
    <apply>
     <csymbol cd="latexml">double-integral</csymbol>
     <apply>
      <times></times>
      <ci>H</ci>
      <vector>
       <ci>φ</ci>
       <ci>η</ci>
       <ci>𝒙</ci>
       <ci>t</ci>
      </vector>
      <mtext>d</mtext>
      <ci>𝒙</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathcal{H}(\varphi,\eta)\,=\,\iint H(\varphi,\eta;\boldsymbol{x},t)\;\text{d}%
\boldsymbol{x}.
  </annotation>
 </semantics>
</math>

</p>

<p>The Hamiltonian density is written in terms of the surface potential using <a href="Green's_identities" title="wikilink">Green's third identity</a> on the kinetic energy:<a class="footnoteRef" href="#fn15" id="fnref15"><sup>15</sup></a></p>

<p>

<math display="block" id="Luke's_variational_principle:19">
 <semantics>
  <mrow>
   <mrow>
    <mpadded width="+1.7pt">
     <mi>H</mi>
    </mpadded>
    <mo rspace="4.2pt">=</mo>
    <mrow>
     <mrow>
      <mpadded width="+1.7pt">
       <mfrac>
        <mn>1</mn>
        <mn>2</mn>
       </mfrac>
      </mpadded>
      <mpadded width="+1.7pt">
       <mi>ρ</mi>
      </mpadded>
      <mpadded width="+5.6pt">
       <msqrt>
        <mrow>
         <mpadded width="+1.7pt">
          <mn>1</mn>
         </mpadded>
         <mo rspace="4.2pt">+</mo>
         <msup>
          <mrow>
           <mo>|</mo>
           <mrow>
            <mo mathvariant="bold">∇</mo>
            <mi>η</mi>
           </mrow>
           <mo>|</mo>
          </mrow>
          <mn>2</mn>
         </msup>
        </mrow>
       </msqrt>
      </mpadded>
      <mpadded width="+1.7pt">
       <mi>φ</mi>
      </mpadded>
      <mrow>
       <mo maxsize="120%" minsize="120%">(</mo>
       <mrow>
        <mi>D</mi>
        <mrow>
         <mo stretchy="false">(</mo>
         <mi>η</mi>
         <mo rspace="5.3pt" stretchy="false">)</mo>
        </mrow>
        <mi>φ</mi>
       </mrow>
       <mo maxsize="120%" minsize="120%" rspace="4.2pt">)</mo>
      </mrow>
     </mrow>
     <mo rspace="4.2pt">+</mo>
     <mrow>
      <mpadded width="+1.7pt">
       <mfrac>
        <mn>1</mn>
        <mn>2</mn>
       </mfrac>
      </mpadded>
      <mpadded width="+1.7pt">
       <mi>ρ</mi>
      </mpadded>
      <mpadded width="+1.7pt">
       <mi>g</mi>
      </mpadded>
      <msup>
       <mi>η</mi>
       <mn>2</mn>
      </msup>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>H</ci>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <cn type="integer">2</cn>
      </apply>
      <ci>ρ</ci>
      <apply>
       <root></root>
       <apply>
        <plus></plus>
        <cn type="integer">1</cn>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <abs></abs>
          <apply>
           <ci>bold-∇</ci>
           <ci>η</ci>
          </apply>
         </apply>
         <cn type="integer">2</cn>
        </apply>
       </apply>
      </apply>
      <ci>φ</ci>
      <apply>
       <times></times>
       <ci>D</ci>
       <ci>η</ci>
       <ci>φ</ci>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <cn type="integer">2</cn>
      </apply>
      <ci>ρ</ci>
      <ci>g</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>η</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   H\,=\,\frac{1}{2}\,\rho\,\sqrt{1\,+\,\left|\boldsymbol{\nabla}\eta\right|^{2}}%
\;\;\varphi\,\bigl(D(\eta)\;\varphi\bigr)\,+\,\frac{1}{2}\,\rho\,g\,\eta^{2},
  </annotation>
 </semantics>
</math>

</p>

<p>where <em>D</em>(<em>η</em>) <em>φ</em> is equal to the <a href="Surface_normal" title="wikilink">normal</a> derivative of ∂<em>Φ</em>/∂<em>n</em> at the free surface. Because of the linearity of the Laplace equation — valid in the fluid interior and depending on the boundary condition at the bed <em>z</em>=-<em>h</em> and free surface <em>z</em>=<em>η</em> — the normal derivative ∂<em>Φ</em>/∂<em>n</em> is a <em>linear</em> function of the surface potential <em>φ</em>, but depends non-linear on the surface elevation <em>η</em>. This is expressed by the <a href="Poincaré–Steklov_operator" title="wikilink">Dirichlet-to-Neumann</a> operator <em>D</em>(<em>η</em>), acting linearly on <em>φ</em>.</p>

<p>The Hamiltonian density can also be written as:<a class="footnoteRef" href="#fn16" id="fnref16"><sup>16</sup></a></p>

<p>

<math display="block" id="Luke's_variational_principle:20">
 <semantics>
  <mrow>
   <mrow>
    <mpadded width="+1.7pt">
     <mi>H</mi>
    </mpadded>
    <mo rspace="4.2pt">=</mo>
    <mrow>
     <mrow>
      <mpadded width="+1.7pt">
       <mfrac>
        <mn>1</mn>
        <mn>2</mn>
       </mfrac>
      </mpadded>
      <mpadded width="+1.7pt">
       <mi>ρ</mi>
      </mpadded>
      <mpadded width="+1.7pt">
       <mi>φ</mi>
      </mpadded>
      <mrow>
       <mo maxsize="160%" minsize="160%">[</mo>
       <mrow>
        <mrow>
         <mpadded width="+1.7pt">
          <mi>w</mi>
         </mpadded>
         <mrow>
          <mo>(</mo>
          <mrow>
           <mpadded width="+1.7pt">
            <mn>1</mn>
           </mpadded>
           <mo rspace="4.2pt">+</mo>
           <msup>
            <mrow>
             <mo>|</mo>
             <mrow>
              <mo mathvariant="bold">∇</mo>
              <mi>η</mi>
             </mrow>
             <mo>|</mo>
            </mrow>
            <mn>2</mn>
           </msup>
          </mrow>
          <mo>)</mo>
         </mrow>
        </mrow>
        <mo rspace="4.2pt">-</mo>
        <mrow>
         <mrow>
          <mo mathvariant="bold">∇</mo>
          <mi>η</mi>
         </mrow>
         <mo>⋅</mo>
         <mrow>
          <mo mathvariant="bold" rspace="4.2pt">∇</mo>
          <mi>φ</mi>
         </mrow>
        </mrow>
       </mrow>
       <mo maxsize="160%" minsize="160%" rspace="4.2pt">]</mo>
      </mrow>
     </mrow>
     <mo rspace="4.2pt">+</mo>
     <mrow>
      <mpadded width="+1.7pt">
       <mfrac>
        <mn>1</mn>
        <mn>2</mn>
       </mfrac>
      </mpadded>
      <mpadded width="+1.7pt">
       <mi>ρ</mi>
      </mpadded>
      <mpadded width="+1.7pt">
       <mi>g</mi>
      </mpadded>
      <msup>
       <mi>η</mi>
       <mn>2</mn>
      </msup>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>H</ci>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <cn type="integer">2</cn>
      </apply>
      <ci>ρ</ci>
      <ci>φ</ci>
      <apply>
       <csymbol cd="latexml">delimited-[]</csymbol>
       <apply>
        <minus></minus>
        <apply>
         <times></times>
         <ci>w</ci>
         <apply>
          <plus></plus>
          <cn type="integer">1</cn>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <apply>
            <abs></abs>
            <apply>
             <ci>bold-∇</ci>
             <ci>η</ci>
            </apply>
           </apply>
           <cn type="integer">2</cn>
          </apply>
         </apply>
        </apply>
        <apply>
         <ci>normal-⋅</ci>
         <apply>
          <ci>bold-∇</ci>
          <ci>η</ci>
         </apply>
         <apply>
          <ci>bold-∇</ci>
          <ci>φ</ci>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <cn type="integer">2</cn>
      </apply>
      <ci>ρ</ci>
      <ci>g</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>η</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   H\,=\,\frac{1}{2}\,\rho\,\varphi\,\Bigl[w\,\left(1\,+\,\left|\boldsymbol{%
\nabla}\eta\right|^{2}\right)-\,\boldsymbol{\nabla}\eta\cdot\boldsymbol{\nabla%
}\,\varphi\Bigr]\,+\,\frac{1}{2}\,\rho\,g\,\eta^{2},
  </annotation>
 </semantics>
</math>

</p>

<p>with <em>w</em>(<strong><em>x</em></strong>,<em>t</em>) = ∂<em>Φ</em>/∂<em>z</em> the vertical velocity at the free surface <em>z</em> = <em>η</em>. Also <em>w</em> is a <em>linear</em> function of the surface potential <em>φ</em> through the Laplace equation, but <em>w</em> depends non-linear on the surface elevation <em>η</em>:<a class="footnoteRef" href="#fn17" id="fnref17"><sup>17</sup></a></p>

<p>

<math display="block" id="Luke's_variational_principle:21">
 <semantics>
  <mrow>
   <mrow>
    <mpadded width="+1.7pt">
     <mi>w</mi>
    </mpadded>
    <mo rspace="4.2pt">=</mo>
    <mrow>
     <mi>W</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>η</mi>
      <mo rspace="4.2pt" stretchy="false">)</mo>
     </mrow>
     <mi>φ</mi>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>w</ci>
    <apply>
     <times></times>
     <ci>W</ci>
     <ci>η</ci>
     <ci>φ</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   w\,=\,W(\eta)\,\varphi,
  </annotation>
 </semantics>
</math>

</p>

<p>with <em>W</em> operating linear on <em>φ</em>, but being non-linear in <em>η</em>. As a result, the Hamiltonian is a quadratic <a href="functional_(mathematics)" title="wikilink">functional</a> of the surface potential <em>φ</em>. Also the potential energy part of the Hamiltonian is quadratic. The source of non-linearity in surface gravity waves is through the kinetic energy depending non-linear on the free surface shape <em>η</em>.<a class="footnoteRef" href="#fn18" id="fnref18"><sup>18</sup></a></p>

<p>Further ∇<em>φ</em> is not to be mistaken for the horizontal velocity ∇<em>Φ</em> at the free surface:</p>

<p>

<math display="block" id="Luke's_variational_principle:22">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mo mathvariant="bold">∇</mo>
     <mpadded width="+1.7pt">
      <mi>φ</mi>
     </mpadded>
    </mrow>
    <mo rspace="4.2pt">=</mo>
    <mrow>
     <mrow>
      <mo mathvariant="bold">∇</mo>
      <mi mathvariant="normal">Φ</mi>
     </mrow>
     <mrow>
      <mo maxsize="120%" minsize="120%">(</mo>
      <mi>𝒙</mi>
      <mo>,</mo>
      <mrow>
       <mi>η</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>𝒙</mi>
        <mo>,</mo>
        <mi>t</mi>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
      <mo>,</mo>
      <mi>t</mi>
      <mo maxsize="120%" minsize="120%" rspace="4.2pt">)</mo>
     </mrow>
    </mrow>
    <mo rspace="4.2pt">=</mo>
    <mpadded width="+1.7pt">
     <msub>
      <mrow>
       <mo>[</mo>
       <mrow>
        <mrow>
         <mo mathvariant="bold">∇</mo>
         <mpadded width="+1.7pt">
          <mi mathvariant="normal">Φ</mi>
         </mpadded>
        </mrow>
        <mo rspace="4.2pt">+</mo>
        <mrow>
         <mpadded width="+1.7pt">
          <mfrac>
           <mrow>
            <mo>∂</mo>
            <mi mathvariant="normal">Φ</mi>
           </mrow>
           <mrow>
            <mo>∂</mo>
            <mi>z</mi>
           </mrow>
          </mfrac>
         </mpadded>
         <mrow>
          <mo mathvariant="bold">∇</mo>
          <mi>η</mi>
         </mrow>
        </mrow>
       </mrow>
       <mo>]</mo>
      </mrow>
      <mrow>
       <mi>z</mi>
       <mo>=</mo>
       <mrow>
        <mi>η</mi>
        <mrow>
         <mo stretchy="false">(</mo>
         <mi>𝒙</mi>
         <mo>,</mo>
         <mi>t</mi>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
      </mrow>
     </msub>
    </mpadded>
    <mo rspace="4.2pt">=</mo>
    <mrow>
     <mpadded width="+1.7pt">
      <msub>
       <mrow>
        <mo maxsize="160%" minsize="160%">[</mo>
        <mrow>
         <mo mathvariant="bold">∇</mo>
         <mi mathvariant="normal">Φ</mi>
        </mrow>
        <mo maxsize="160%" minsize="160%">]</mo>
       </mrow>
       <mrow>
        <mi>z</mi>
        <mo>=</mo>
        <mrow>
         <mi>η</mi>
         <mrow>
          <mo stretchy="false">(</mo>
          <mi>𝒙</mi>
          <mo>,</mo>
          <mi>t</mi>
          <mo stretchy="false">)</mo>
         </mrow>
        </mrow>
       </mrow>
      </msub>
     </mpadded>
     <mo rspace="4.2pt">+</mo>
     <mrow>
      <mpadded width="+1.7pt">
       <mi>w</mi>
      </mpadded>
      <mrow>
       <mo mathvariant="bold">∇</mo>
       <mi>η</mi>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <ci>bold-∇</ci>
      <ci>φ</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <ci>bold-∇</ci>
       <ci>normal-Φ</ci>
      </apply>
      <vector>
       <ci>𝒙</ci>
       <apply>
        <times></times>
        <ci>η</ci>
        <interval closure="open">
         <ci>𝒙</ci>
         <ci>t</ci>
        </interval>
       </apply>
       <ci>t</ci>
      </vector>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <csymbol cd="latexml">delimited-[]</csymbol>
       <apply>
        <plus></plus>
        <apply>
         <ci>bold-∇</ci>
         <ci>normal-Φ</ci>
        </apply>
        <apply>
         <times></times>
         <apply>
          <divide></divide>
          <apply>
           <partialdiff></partialdiff>
           <ci>normal-Φ</ci>
          </apply>
          <apply>
           <partialdiff></partialdiff>
           <ci>z</ci>
          </apply>
         </apply>
         <apply>
          <ci>bold-∇</ci>
          <ci>η</ci>
         </apply>
        </apply>
       </apply>
      </apply>
      <apply>
       <eq></eq>
       <ci>z</ci>
       <apply>
        <times></times>
        <ci>η</ci>
        <interval closure="open">
         <ci>𝒙</ci>
         <ci>t</ci>
        </interval>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <plus></plus>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <apply>
        <csymbol cd="latexml">delimited-[]</csymbol>
        <apply>
         <ci>bold-∇</ci>
         <ci>normal-Φ</ci>
        </apply>
       </apply>
       <apply>
        <eq></eq>
        <ci>z</ci>
        <apply>
         <times></times>
         <ci>η</ci>
         <interval closure="open">
          <ci>𝒙</ci>
          <ci>t</ci>
         </interval>
        </apply>
       </apply>
      </apply>
      <apply>
       <times></times>
       <ci>w</ci>
       <apply>
        <ci>bold-∇</ci>
        <ci>η</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \boldsymbol{\nabla}\varphi\,=\,\boldsymbol{\nabla}\Phi\bigl(\boldsymbol{x},%
\eta(\boldsymbol{x},t),t\bigr)\,=\,\left[\boldsymbol{\nabla}\Phi\,+\,\frac{%
\partial\Phi}{\partial z}\,\boldsymbol{\nabla}\eta\right]_{z=\eta(\boldsymbol{%
x},t)}\,=\,\Bigl[\boldsymbol{\nabla}\Phi\Bigr]_{z=\eta(\boldsymbol{x},t)}\,+\,%
w\,\boldsymbol{\nabla}\eta.
  </annotation>
 </semantics>
</math>

</p>

<p>Taking the variations of the Lagrangian 

<math display="inline" id="Luke's_variational_principle:23">
 <semantics>
  <msub>
   <mi class="ltx_font_mathcaligraphic">ℒ</mi>
   <mi>H</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>ℒ</ci>
    <ci>H</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathcal{L}_{H}
  </annotation>
 </semantics>
</math>

 with respect to the canonical variables 

<math display="inline" id="Luke's_variational_principle:24">
 <semantics>
  <mrow>
   <mi>φ</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>𝒙</mi>
    <mo>,</mo>
    <mi>t</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>φ</ci>
    <interval closure="open">
     <ci>𝒙</ci>
     <ci>t</ci>
    </interval>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \varphi(\boldsymbol{x},t)
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Luke's_variational_principle:25">
 <semantics>
  <mrow>
   <mi>η</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>𝒙</mi>
    <mo>,</mo>
    <mi>t</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>η</ci>
    <interval closure="open">
     <ci>𝒙</ci>
     <ci>t</ci>
    </interval>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \eta(\boldsymbol{x},t)
  </annotation>
 </semantics>
</math>

 gives:</p>

<p>

<math display="inline" id="Luke's_variational_principle:26">
 <semantics>
  <mrow>
   <mpadded width="+1.7pt">
    <mi>ρ</mi>
   </mpadded>
   <mstyle displaystyle="true">
    <mfrac>
     <mrow>
      <mo>∂</mo>
      <mi>η</mi>
     </mrow>
     <mrow>
      <mo>∂</mo>
      <mi>t</mi>
     </mrow>
    </mfrac>
   </mstyle>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>ρ</ci>
    <apply>
     <divide></divide>
     <apply>
      <partialdiff></partialdiff>
      <ci>η</ci>
     </apply>
     <apply>
      <partialdiff></partialdiff>
      <ci>t</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle\rho\,\frac{\partial\eta}{\partial t}
  </annotation>
 </semantics>
</math>


</p>

<p>provided in the fluid interior <em>Φ</em> satisfies the Laplace equation, Δ<em>Φ</em>=0, as well as the bottom boundary condition at <em>z</em>=-<em>h</em> and <em>Φ</em>=<em>φ</em> at the free surface.</p>
<h2 id="references-and-notes">References and notes</h2>

<p>"</p>

<p><a href="Category:Fluid_dynamics" title="wikilink">Category:Fluid dynamics</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1"><a href="#fnref1">↩</a></li>
<li id="fn2"><a href="#fnref2">↩</a></li>
<li id="fn3"><a href="#fnref3">↩</a></li>
<li id="fn4"> Originally appeared in <em><a href="Zhurnal_Prildadnoi_Mekhaniki_i_Tekhnicheskoi_Fiziki" title="wikilink">Zhurnal Prildadnoi Mekhaniki i Tekhnicheskoi Fiziki</a></em> <strong>9</strong>(2): 86–94, 1968.<a href="#fnref4">↩</a></li>
<li id="fn5"><a href="#fnref5">↩</a></li>
<li id="fn6"><a href="#fnref6">↩</a></li>
<li id="fn7"><a href="#fnref7">↩</a></li>
<li id="fn8"><a href="#fnref8">↩</a></li>
<li id="fn9"></li>
<li id="fn10"></li>
<li id="fn11"></li>
<li id="fn12"></li>
<li id="fn13"></li>
<li id="fn14"></li>
<li id="fn15"><a href="#fnref15">↩</a></li>
<li id="fn16"></li>
<li id="fn17"></li>
<li id="fn18"></li>
</ol>
</section>
</body>
</html>

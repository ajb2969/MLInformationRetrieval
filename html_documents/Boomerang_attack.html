<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="203">Boomerang attack</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Boomerang attack</h1>
<hr/>

<p> In <a class="uri" href="cryptography" title="wikilink">cryptography</a>, the <strong>boomerang attack</strong> is a method for the <a class="uri" href="cryptanalysis" title="wikilink">cryptanalysis</a> of <a href="block_cipher" title="wikilink">block ciphers</a> based on <a href="differential_cryptanalysis" title="wikilink">differential cryptanalysis</a>. The attack was published in 1999 by <a href="David_A._Wagner" title="wikilink">David Wagner</a>, who used it to break the <a class="uri" href="COCONUT98" title="wikilink">COCONUT98</a> cipher.</p>

<p>The boomerang attack has allowed new avenues of attack for many ciphers previously deemed safe from differential cryptanalysis.</p>

<p>Refinements on the boomerang attack have been published: the <strong>amplified boomerang attack</strong>, then the <strong>rectangle attack</strong>.</p>
<h2 id="the-attack">The attack</h2>

<p>The boomerang attack is based on <a href="differential_cryptanalysis" title="wikilink">differential cryptanalysis</a>. In differential cryptanalysis, an attacker exploits how differences in the input to a cipher (the plaintext) can affect the resultant difference at the output (the ciphertext). A high-probability "differential" (that is, an input difference that will produce a likely output difference) is needed that covers all, or nearly all, of the cipher. The boomerang attack allows differentials to be used which cover only part of the cipher.</p>

<p>The attack attempts to generate a so-called "quartet" structure at a point halfway through the cipher. For this purpose, say that the encryption action, <em>E</em>, of the cipher can be split into two consecutive stages, <em>E</em><sub>0</sub> and <em>E</em><sub>1</sub>, so that <em>E(M)</em> = <em>E</em><sub>1</sub>(<em>E</em><sub>0</sub>(M)), where <em>M</em> is some plaintext message. Suppose we have two differentials for the two stages; say,</p>

<p>

<math display="block" id="Boomerang_attack:0">
 <semantics>
  <mrow>
   <mi mathvariant="normal">Δ</mi>
   <mo>→</mo>
   <msup>
    <mi mathvariant="normal">Δ</mi>
    <mo>*</mo>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-→</ci>
    <ci>normal-Δ</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>normal-Δ</ci>
     <times></times>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Delta\to\Delta^{*}
  </annotation>
 </semantics>
</math>

 for <em>E</em><sub>0</sub>, and</p>

<p>

<math display="block" id="Boomerang_attack:1">
 <semantics>
  <mrow>
   <mo>∇</mo>
   <mo>→</mo>
   <msup>
    <mo>∇</mo>
    <mo>*</mo>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-→</ci>
    <ci>normal-∇</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>normal-∇</ci>
     <times></times>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \nabla\to\nabla^{*}
  </annotation>
 </semantics>
</math>

 for <em>E</em><sub>1</sub><sup>−1</sup> (the decryption action of <em>E</em><sub>1</sub>).</p>

<p>The basic attack proceeds as follows:</p>
<ul>
<li>Choose a random plaintext 

<math display="inline" id="Boomerang_attack:2">
 <semantics>
  <mi>P</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>P</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   P
  </annotation>
 </semantics>
</math>

 and calculate 

<math display="inline" id="Boomerang_attack:3">
 <semantics>
  <mrow>
   <msup>
    <mi>P</mi>
    <mo>′</mo>
   </msup>
   <mo>=</mo>
   <mrow>
    <mi>P</mi>
    <mo>⊕</mo>
    <mi mathvariant="normal">Δ</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>P</ci>
     <ci>normal-′</ci>
    </apply>
    <apply>
     <csymbol cd="latexml">direct-sum</csymbol>
     <ci>P</ci>
     <ci>normal-Δ</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   P^{\prime}=P\oplus\Delta
  </annotation>
 </semantics>
</math>

.</li>
<li>Request the encryptions of 

<math display="inline" id="Boomerang_attack:4">
 <semantics>
  <mi>P</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>P</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   P
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Boomerang_attack:5">
 <semantics>
  <msup>
   <mi>P</mi>
   <mo>′</mo>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>P</ci>
    <ci>normal-′</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   P^{\prime}
  </annotation>
 </semantics>
</math>

 to obtain 

<math display="inline" id="Boomerang_attack:6">
 <semantics>
  <mrow>
   <mi>C</mi>
   <mo>=</mo>
   <mrow>
    <mi>E</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>P</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>C</ci>
    <apply>
     <times></times>
     <ci>E</ci>
     <ci>P</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   C=E(P)
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Boomerang_attack:7">
 <semantics>
  <mrow>
   <msup>
    <mi>C</mi>
    <mo>′</mo>
   </msup>
   <mo>=</mo>
   <mrow>
    <mi>E</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <msup>
      <mi>P</mi>
      <mo>′</mo>
     </msup>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>C</ci>
     <ci>normal-′</ci>
    </apply>
    <apply>
     <times></times>
     <ci>E</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>P</ci>
      <ci>normal-′</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   C^{\prime}=E(P^{\prime})
  </annotation>
 </semantics>
</math>

</li>
<li>Calculate 

<math display="inline" id="Boomerang_attack:8">
 <semantics>
  <mrow>
   <mi>D</mi>
   <mo>=</mo>
   <mrow>
    <mi>C</mi>
    <mo>⊕</mo>
    <mo>∇</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>D</ci>
    <apply>
     <csymbol cd="latexml">direct-sum</csymbol>
     <ci>C</ci>
     <ci>normal-∇</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   D=C\oplus\nabla
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Boomerang_attack:9">
 <semantics>
  <mrow>
   <msup>
    <mi>D</mi>
    <mo>′</mo>
   </msup>
   <mo>=</mo>
   <mrow>
    <msup>
     <mi>C</mi>
     <mo>′</mo>
    </msup>
    <mo>⊕</mo>
    <mo>∇</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>D</ci>
     <ci>normal-′</ci>
    </apply>
    <apply>
     <csymbol cd="latexml">direct-sum</csymbol>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>C</ci>
      <ci>normal-′</ci>
     </apply>
     <ci>normal-∇</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   D^{\prime}=C^{\prime}\oplus\nabla
  </annotation>
 </semantics>
</math>

</li>
<li>Request the decryptions of 

<math display="inline" id="Boomerang_attack:10">
 <semantics>
  <mi>D</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>D</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   D
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Boomerang_attack:11">
 <semantics>
  <msup>
   <mi>D</mi>
   <mo>′</mo>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>D</ci>
    <ci>normal-′</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   D^{\prime}
  </annotation>
 </semantics>
</math>

 to obtain 

<math display="inline" id="Boomerang_attack:12">
 <semantics>
  <mrow>
   <mi>Q</mi>
   <mo>=</mo>
   <mrow>
    <msup>
     <mi>E</mi>
     <mrow>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </msup>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>D</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>Q</ci>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>E</ci>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <ci>D</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Q=E^{-1}(D)
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Boomerang_attack:13">
 <semantics>
  <mrow>
   <msup>
    <mi>Q</mi>
    <mo>′</mo>
   </msup>
   <mo>=</mo>
   <mrow>
    <msup>
     <mi>E</mi>
     <mrow>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </msup>
    <mrow>
     <mo stretchy="false">(</mo>
     <msup>
      <mi>D</mi>
      <mo>′</mo>
     </msup>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>Q</ci>
     <ci>normal-′</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>E</ci>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>D</ci>
      <ci>normal-′</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Q^{\prime}=E^{-1}(D^{\prime})
  </annotation>
 </semantics>
</math>

</li>
<li>Compare 

<math display="inline" id="Boomerang_attack:14">
 <semantics>
  <mi>Q</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>Q</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Q
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Boomerang_attack:15">
 <semantics>
  <msup>
   <mi>Q</mi>
   <mo>′</mo>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>Q</ci>
    <ci>normal-′</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Q^{\prime}
  </annotation>
 </semantics>
</math>

; when the differentials hold, 

<math display="inline" id="Boomerang_attack:16">
 <semantics>
  <mrow>
   <mrow>
    <mi>Q</mi>
    <mo>⊕</mo>
    <msup>
     <mi>Q</mi>
     <mo>′</mo>
    </msup>
   </mrow>
   <mo>=</mo>
   <mi mathvariant="normal">Δ</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="latexml">direct-sum</csymbol>
     <ci>Q</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>Q</ci>
      <ci>normal-′</ci>
     </apply>
    </apply>
    <ci>normal-Δ</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Q\oplus Q^{\prime}=\Delta
  </annotation>
 </semantics>
</math>

.</li>
</ul>
<h2 id="application-to-specific-ciphers">Application to specific ciphers</h2>

<p>One attack on <a href="KASUMI_(block_cipher)" title="wikilink">KASUMI</a>, a block cipher used in <a class="uri" href="3GPP" title="wikilink">3GPP</a>, is a related-key rectangle attack which breaks the full eight rounds of the cipher faster than exhaustive search (Biham et al., 2005). The attack requires 2<sup>54.6</sup> chosen plaintexts, each of which has been encrypted under one of four related keys, and has a time complexity equivalent to 2<sup>76.1</sup> KASUMI encryptions.</p>
<h2 id="references">References</h2>
<ul>
<li>

<p><a href="http://www.cs.berkeley.edu/~daw/papers/boomerang-fse99-slides.ps">(Slides in PostScript)</a></p></li>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
</ul>
<h2 id="external-links">External links</h2>
<ul>
<li><a href="http://www.quadibloc.com/crypto/co4512.htm">Boomerang attack</a> — explained by John Savard</li>
<li><a href="http://www.ma.huji.ac.il/~nkeller">Nathan Keller's homepage</a></li>
</ul>

<p>"</p>

<p><a href="Category:Cryptographic_attacks" title="wikilink">Category:Cryptographic attacks</a></p>
</body>
</html>

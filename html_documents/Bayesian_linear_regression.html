<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="1556">Bayesian linear regression</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Bayesian linear regression</h1>
<hr/>

<p>In <a class="uri" href="statistics" title="wikilink">statistics</a>, <strong>Bayesian linear regression</strong> is an approach to <a href="linear_regression" title="wikilink">linear regression</a> in which the statistical analysis is undertaken within the context of <a href="Bayesian_inference" title="wikilink">Bayesian inference</a>. When the regression model has <a href="errors_and_residuals_in_statistics" title="wikilink">errors</a> that have a <a href="normal_distribution" title="wikilink">normal distribution</a>, and if a particular form of <a href="prior_distribution" title="wikilink">prior distribution</a> is assumed, explicit results are available for the <a href="posterior_probability_distribution" title="wikilink">posterior probability distributions</a> of the model's parameters.</p>
<h2 id="model-setup">Model setup</h2>

<p>Consider a standard <a href="linear_regression" title="wikilink">linear regression</a> problem, in which for 

<math display="inline" id="Bayesian_linear_regression:0">
 <semantics>
  <mrow>
   <mi>i</mi>
   <mo>=</mo>
   <mrow>
    <mn>1</mn>
    <mo>,</mo>
    <mi mathvariant="normal">…</mi>
    <mo>,</mo>
    <mi>n</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>i</ci>
    <list>
     <cn type="integer">1</cn>
     <ci>normal-…</ci>
     <ci>n</ci>
    </list>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   i=1,...,n
  </annotation>
 </semantics>
</math>

 we specify the <a href="conditional_probability" title="wikilink">conditional distribution</a> of <em>

<math display="inline" id="Bayesian_linear_regression:1">
 <semantics>
  <msub>
   <mi>y</mi>
   <mi>i</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>y</ci>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   y_{i}
  </annotation>
 </semantics>
</math>

</em> given a <em>

<math display="inline" id="Bayesian_linear_regression:2">
 <semantics>
  <mrow>
   <mi>k</mi>
   <mo>×</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>k</ci>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   k\times 1
  </annotation>
 </semantics>
</math>

</em> predictor vector <em>

<math display="inline" id="Bayesian_linear_regression:3">
 <semantics>
  <msub>
   <mi>𝐱</mi>
   <mi>i</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>𝐱</ci>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{x}_{i}
  </annotation>
 </semantics>
</math>

</em>:</p>

<p>

<math display="block" id="Bayesian_linear_regression:4">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>y</mi>
     <mi>i</mi>
    </msub>
    <mo>=</mo>
    <mrow>
     <mrow>
      <msubsup>
       <mi>𝐱</mi>
       <mi>i</mi>
       <mi mathvariant="normal">T</mi>
      </msubsup>
      <mi>𝜷</mi>
     </mrow>
     <mo>+</mo>
     <msub>
      <mi>ϵ</mi>
      <mi>i</mi>
     </msub>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>y</ci>
     <ci>i</ci>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>𝐱</ci>
        <ci>i</ci>
       </apply>
       <ci>normal-T</ci>
      </apply>
      <ci>𝜷</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>ϵ</ci>
      <ci>i</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   y_{i}=\mathbf{x}_{i}^{\rm T}\boldsymbol{\beta}+\epsilon_{i},
  </annotation>
 </semantics>
</math>

</p>

<p>where <em>

<math display="inline" id="Bayesian_linear_regression:5">
 <semantics>
  <mi>𝜷</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>𝜷</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \boldsymbol{\beta}
  </annotation>
 </semantics>
</math>

</em> is a <em>

<math display="inline" id="Bayesian_linear_regression:6">
 <semantics>
  <mrow>
   <mi>k</mi>
   <mo>×</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>k</ci>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   k\times 1
  </annotation>
 </semantics>
</math>

</em> vector, and the 

<math display="inline" id="Bayesian_linear_regression:7">
 <semantics>
  <msub>
   <mi>ϵ</mi>
   <mi>i</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>ϵ</ci>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \epsilon_{i}
  </annotation>
 </semantics>
</math>

 are <a href="i.i.d." title="wikilink">independent and identical</a> <a href="normally_distributed" title="wikilink">normally distributed</a> random variables:</p>

<p>

<math display="block" id="Bayesian_linear_regression:8">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>ϵ</mi>
     <mi>i</mi>
    </msub>
    <mo>∼</mo>
    <mrow>
     <mi>N</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mn>0</mn>
      <mo>,</mo>
      <msup>
       <mi>σ</mi>
       <mn>2</mn>
      </msup>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">similar-to</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>ϵ</ci>
     <ci>i</ci>
    </apply>
    <apply>
     <times></times>
     <ci>N</ci>
     <interval closure="open">
      <cn type="integer">0</cn>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>σ</ci>
       <cn type="integer">2</cn>
      </apply>
     </interval>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \epsilon_{i}\sim N(0,\sigma^{2}).
  </annotation>
 </semantics>
</math>

</p>

<p>This corresponds to the following <a href="likelihood_function" title="wikilink">likelihood function</a>:</p>

<p>

<math display="block" id="Bayesian_linear_regression:9">
 <semantics>
  <mrow>
   <mi>ρ</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>𝐲</mi>
    <mo stretchy="false">|</mo>
    <mi>𝐗</mi>
    <mo>,</mo>
    <mi>𝜷</mi>
    <mo>,</mo>
    <msup>
     <mi>σ</mi>
     <mn>2</mn>
    </msup>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>∝</mo>
   <msup>
    <mrow>
     <mo stretchy="false">(</mo>
     <msup>
      <mi>σ</mi>
      <mn>2</mn>
     </msup>
     <mo stretchy="false">)</mo>
    </mrow>
    <mrow>
     <mo>-</mo>
     <mrow>
      <mi>n</mi>
      <mo>/</mo>
      <mn>2</mn>
     </mrow>
    </mrow>
   </msup>
   <mi>exp</mi>
   <mrow>
    <mo>(</mo>
    <mo>-</mo>
    <mfrac>
     <mn>1</mn>
     <mrow>
      <mn>2</mn>
      <msup>
       <mi>σ</mi>
       <mn>2</mn>
      </msup>
     </mrow>
    </mfrac>
    <msup>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>𝐲</mi>
      <mo>-</mo>
      <mi>𝐗</mi>
      <mi>𝜷</mi>
      <mo stretchy="false">)</mo>
     </mrow>
     <mi mathvariant="normal">T</mi>
    </msup>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>𝐲</mi>
     <mo>-</mo>
     <mi>𝐗</mi>
     <mi>𝜷</mi>
     <mo stretchy="false">)</mo>
    </mrow>
    <mo>)</mo>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">ρ</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">y</csymbol>
     <ci>normal-|</ci>
     <csymbol cd="unknown">X</csymbol>
     <ci>normal-,</ci>
     <csymbol cd="unknown">β</csymbol>
     <ci>normal-,</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>σ</ci>
      <cn type="integer">2</cn>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <csymbol cd="latexml">proportional-to</csymbol>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <ci>normal-(</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>σ</ci>
       <cn type="integer">2</cn>
      </apply>
      <ci>normal-)</ci>
     </cerror>
     <apply>
      <minus></minus>
      <apply>
       <divide></divide>
       <ci>n</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
    <exp></exp>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <minus></minus>
     <apply>
      <divide></divide>
      <cn type="integer">1</cn>
      <apply>
       <times></times>
       <cn type="integer">2</cn>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>σ</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <cerror>
       <csymbol cd="ambiguous">fragments</csymbol>
       <ci>normal-(</ci>
       <csymbol cd="unknown">y</csymbol>
       <minus></minus>
       <csymbol cd="unknown">X</csymbol>
       <csymbol cd="unknown">β</csymbol>
       <ci>normal-)</ci>
      </cerror>
      <ci>normal-T</ci>
     </apply>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <ci>normal-(</ci>
      <csymbol cd="unknown">y</csymbol>
      <minus></minus>
      <csymbol cd="unknown">X</csymbol>
      <csymbol cd="unknown">β</csymbol>
      <ci>normal-)</ci>
     </cerror>
     <ci>normal-)</ci>
    </cerror>
    <ci>normal-.</ci>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \rho(\mathbf{y}|\mathbf{X},\boldsymbol{\beta},\sigma^{2})\propto(\sigma^{2})^{%
-n/2}\exp\left(-\frac{1}{2{\sigma}^{2}}(\mathbf{y}-\mathbf{X}\boldsymbol{\beta%
})^{\rm T}(\mathbf{y}-\mathbf{X}\boldsymbol{\beta})\right).
  </annotation>
 </semantics>
</math>

</p>

<p>The <a href="ordinary_least_squares" title="wikilink">ordinary least squares</a> solution is to estimate the coefficient vector using the <a href="Moore-Penrose_pseudoinverse" title="wikilink">Moore-Penrose pseudoinverse</a>:</p>

<p>

<math display="block" id="Bayesian_linear_regression:10">
 <semantics>
  <mrow>
   <mover accent="true">
    <mi>𝜷</mi>
    <mo stretchy="false">^</mo>
   </mover>
   <mo>=</mo>
   <mrow>
    <msup>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <msup>
        <mi>𝐗</mi>
        <mi mathvariant="normal">T</mi>
       </msup>
       <mi>𝐗</mi>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <mrow>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </msup>
    <msup>
     <mi>𝐗</mi>
     <mi mathvariant="normal">T</mi>
    </msup>
    <mi>𝐲</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <ci>normal-^</ci>
     <ci>𝜷</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>𝐗</ci>
        <ci>normal-T</ci>
       </apply>
       <ci>𝐗</ci>
      </apply>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>𝐗</ci>
      <ci>normal-T</ci>
     </apply>
     <ci>𝐲</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \hat{\boldsymbol{\beta}}=(\mathbf{X}^{\rm T}\mathbf{X})^{-1}\mathbf{X}^{\rm T}%
\mathbf{y}
  </annotation>
 </semantics>
</math>

</p>

<p>where 

<math display="inline" id="Bayesian_linear_regression:11">
 <semantics>
  <mi>𝐗</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>𝐗</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{X}
  </annotation>
 </semantics>
</math>

 is the <em>

<math display="inline" id="Bayesian_linear_regression:12">
 <semantics>
  <mrow>
   <mi>n</mi>
   <mo>×</mo>
   <mi>k</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>n</ci>
    <ci>k</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n\times k
  </annotation>
 </semantics>
</math>

</em> <a href="design_matrix" title="wikilink">design matrix</a>, each row of which is a predictor vector 

<math display="inline" id="Bayesian_linear_regression:13">
 <semantics>
  <msubsup>
   <mi>𝐱</mi>
   <mi>i</mi>
   <mi mathvariant="normal">T</mi>
  </msubsup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>𝐱</ci>
     <ci>i</ci>
    </apply>
    <ci>normal-T</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{x}_{i}^{\rm T}
  </annotation>
 </semantics>
</math>

; and 

<math display="inline" id="Bayesian_linear_regression:14">
 <semantics>
  <mi>𝐲</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>𝐲</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{y}
  </annotation>
 </semantics>
</math>

 is the column 

<math display="inline" id="Bayesian_linear_regression:15">
 <semantics>
  <mi>n</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>n</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n
  </annotation>
 </semantics>
</math>

-vector 

<math display="inline" id="Bayesian_linear_regression:16">
 <semantics>
  <msup>
   <mrow>
    <mo stretchy="false">[</mo>
    <mrow>
     <mpadded width="+2.8pt">
      <msub>
       <mi>y</mi>
       <mn>1</mn>
      </msub>
     </mpadded>
     <mpadded width="+2.8pt">
      <mi mathvariant="normal">⋯</mi>
     </mpadded>
     <msub>
      <mi>y</mi>
      <mi>n</mi>
     </msub>
    </mrow>
    <mo stretchy="false">]</mo>
   </mrow>
   <mi mathvariant="normal">T</mi>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <apply>
     <csymbol cd="latexml">delimited-[]</csymbol>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>y</ci>
       <cn type="integer">1</cn>
      </apply>
      <ci>normal-⋯</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>y</ci>
       <ci>n</ci>
      </apply>
     </apply>
    </apply>
    <ci>normal-T</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   [y_{1}\;\cdots\;y_{n}]^{\rm T}
  </annotation>
 </semantics>
</math>

.</p>

<p>This is a <a class="uri" href="frequentist" title="wikilink">frequentist</a> approach, and it assumes that there are enough measurements to say something meaningful about 

<math display="inline" id="Bayesian_linear_regression:17">
 <semantics>
  <mi>𝜷</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>𝜷</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \boldsymbol{\beta}
  </annotation>
 </semantics>
</math>

. In the <a href="Bayesian_inference" title="wikilink">Bayesian</a> approach, the data are supplemented with additional information in the form of a <a href="prior_probability_distribution" title="wikilink">prior probability distribution</a>. The prior belief about the parameters is combined with the data's likelihood function according to <a href="Bayes_theorem" title="wikilink">Bayes theorem</a> to yield the <a href="posterior_probability" title="wikilink">posterior belief</a> about the parameters 

<math display="inline" id="Bayesian_linear_regression:18">
 <semantics>
  <mi>𝜷</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>𝜷</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \boldsymbol{\beta}
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Bayesian_linear_regression:19">
 <semantics>
  <mi>σ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>σ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \sigma
  </annotation>
 </semantics>
</math>

. The prior can take different functional forms depending on the domain and the information that is available a priori.</p>
<h2 id="with-conjugate-priors">With conjugate priors</h2>
<h3 id="conjugate-prior-distribution">Conjugate prior distribution</h3>

<p>For an arbitrary prior distribution, there may be no analytical solution for the <a href="posterior_distribution" title="wikilink">posterior distribution</a>. In this section, we will consider a so-called <a href="conjugate_prior" title="wikilink">conjugate prior</a> for which the posterior distribution can be derived analytically.</p>

<p>A prior 

<math display="inline" id="Bayesian_linear_regression:20">
 <semantics>
  <mrow>
   <mi>ρ</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>𝜷</mi>
    <mo>,</mo>
    <msup>
     <mi>σ</mi>
     <mn>2</mn>
    </msup>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>ρ</ci>
    <interval closure="open">
     <ci>𝜷</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>σ</ci>
      <cn type="integer">2</cn>
     </apply>
    </interval>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \rho(\boldsymbol{\beta},\sigma^{2})
  </annotation>
 </semantics>
</math>

 is <a href="conjugate_prior" title="wikilink">conjugate</a> to this likelihood function if it has the same functional form with respect to 

<math display="inline" id="Bayesian_linear_regression:21">
 <semantics>
  <mi>𝜷</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>𝜷</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \boldsymbol{\beta}
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Bayesian_linear_regression:22">
 <semantics>
  <mi>σ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>σ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \sigma
  </annotation>
 </semantics>
</math>

. Since the log-likelihood is quadratic in 

<math display="inline" id="Bayesian_linear_regression:23">
 <semantics>
  <mi>𝜷</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>𝜷</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \boldsymbol{\beta}
  </annotation>
 </semantics>
</math>

, the log-likelihood is re-written such that the likelihood becomes normal in 

<math display="inline" id="Bayesian_linear_regression:24">
 <semantics>
  <mrow>
   <mo stretchy="false">(</mo>
   <mrow>
    <mi>𝜷</mi>
    <mo>-</mo>
    <mover accent="true">
     <mi>𝜷</mi>
     <mo stretchy="false">^</mo>
    </mover>
   </mrow>
   <mo stretchy="false">)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <minus></minus>
    <ci>𝜷</ci>
    <apply>
     <ci>normal-^</ci>
     <ci>𝜷</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (\boldsymbol{\beta}-\hat{\boldsymbol{\beta}})
  </annotation>
 </semantics>
</math>

. Write</p>

<p>

<math display="inline" id="Bayesian_linear_regression:25">
 <semantics>
  <mrow>
   <msup>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>𝐲</mi>
      <mo>-</mo>
      <mrow>
       <mi>𝐗</mi>
       <mi>𝜷</mi>
      </mrow>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
    <mi mathvariant="normal">T</mi>
   </msup>
   <mrow>
    <mo stretchy="false">(</mo>
    <mrow>
     <mi>𝐲</mi>
     <mo>-</mo>
     <mrow>
      <mi>𝐗</mi>
      <mi>𝜷</mi>
     </mrow>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <minus></minus>
      <ci>𝐲</ci>
      <apply>
       <times></times>
       <ci>𝐗</ci>
       <ci>𝜷</ci>
      </apply>
     </apply>
     <ci>normal-T</ci>
    </apply>
    <apply>
     <minus></minus>
     <ci>𝐲</ci>
     <apply>
      <times></times>
      <ci>𝐗</ci>
      <ci>𝜷</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle(\mathbf{y}-\mathbf{X}\boldsymbol{\beta})^{\rm T}(\mathbf{y}-%
\mathbf{X}\boldsymbol{\beta})
  </annotation>
 </semantics>
</math>


</p>

<p>The likelihood is now re-written as</p>

<p>

<math display="inline" id="Bayesian_linear_regression:26">
 <semantics>
  <mrow>
   <mi>ρ</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>𝐲</mi>
    <mo stretchy="false">|</mo>
    <mi>𝐗</mi>
    <mo>,</mo>
    <mi>𝜷</mi>
    <mo>,</mo>
    <msup>
     <mi>σ</mi>
     <mn>2</mn>
    </msup>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">ρ</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">y</csymbol>
     <ci>normal-|</ci>
     <csymbol cd="unknown">X</csymbol>
     <ci>normal-,</ci>
     <csymbol cd="unknown">β</csymbol>
     <ci>normal-,</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>σ</ci>
      <cn type="integer">2</cn>
     </apply>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle\rho(\mathbf{y}|\mathbf{X},\boldsymbol{\beta},\sigma^{2})
  </annotation>
 </semantics>
</math>


</p>

<p>where</p>

<p>

<math display="block" id="Bayesian_linear_regression:27">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mrow>
      <mi>v</mi>
      <msup>
       <mi>s</mi>
       <mn>2</mn>
      </msup>
     </mrow>
     <mo>=</mo>
     <mrow>
      <msup>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mi>𝐲</mi>
         <mo>-</mo>
         <mrow>
          <mi>𝐗</mi>
          <mover accent="true">
           <mi>𝜷</mi>
           <mo stretchy="false">^</mo>
          </mover>
         </mrow>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
       <mi mathvariant="normal">T</mi>
      </msup>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mi>𝐲</mi>
        <mo>-</mo>
        <mrow>
         <mi>𝐗</mi>
         <mover accent="true">
          <mi>𝜷</mi>
          <mo stretchy="false">^</mo>
         </mover>
        </mrow>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mrow>
    <mo>,</mo>
    <mrow>
     <mrow>
      <mpadded width="+2.8pt">
       <mtext>and</mtext>
      </mpadded>
      <mi>v</mi>
     </mrow>
     <mo>=</mo>
     <mrow>
      <mi>n</mi>
      <mo>-</mo>
      <mi>k</mi>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <eq></eq>
     <apply>
      <times></times>
      <ci>v</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>s</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <minus></minus>
        <ci>𝐲</ci>
        <apply>
         <times></times>
         <ci>𝐗</ci>
         <apply>
          <ci>normal-^</ci>
          <ci>𝜷</ci>
         </apply>
        </apply>
       </apply>
       <ci>normal-T</ci>
      </apply>
      <apply>
       <minus></minus>
       <ci>𝐲</ci>
       <apply>
        <times></times>
        <ci>𝐗</ci>
        <apply>
         <ci>normal-^</ci>
         <ci>𝜷</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <apply>
      <times></times>
      <mtext>and</mtext>
      <ci>v</ci>
     </apply>
     <apply>
      <minus></minus>
      <ci>n</ci>
      <ci>k</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   vs^{2}=(\mathbf{y}-\mathbf{X}\hat{\boldsymbol{\beta}})^{\rm T}(\mathbf{y}-%
\mathbf{X}\hat{\boldsymbol{\beta}}),\text{and}\;v=n-k,
  </annotation>
 </semantics>
</math>

</p>

<p>where 

<math display="inline" id="Bayesian_linear_regression:28">
 <semantics>
  <mi>k</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>k</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   k
  </annotation>
 </semantics>
</math>

 is the number of regression coefficients.</p>

<p>This suggests a form for the prior:</p>

<p>

<math display="block" id="Bayesian_linear_regression:29">
 <semantics>
  <mrow>
   <mi>ρ</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>𝜷</mi>
    <mo>,</mo>
    <msup>
     <mi>σ</mi>
     <mn>2</mn>
    </msup>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>=</mo>
   <mi>ρ</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msup>
     <mi>σ</mi>
     <mn>2</mn>
    </msup>
    <mo stretchy="false">)</mo>
   </mrow>
   <mi>ρ</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>𝜷</mi>
    <mo stretchy="false">|</mo>
    <msup>
     <mi>σ</mi>
     <mn>2</mn>
    </msup>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">ρ</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">β</csymbol>
     <ci>normal-,</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>σ</ci>
      <cn type="integer">2</cn>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <eq></eq>
    <csymbol cd="unknown">ρ</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>σ</ci>
      <cn type="integer">2</cn>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <csymbol cd="unknown">ρ</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">β</csymbol>
     <ci>normal-|</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>σ</ci>
      <cn type="integer">2</cn>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <ci>normal-,</ci>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \rho(\boldsymbol{\beta},\sigma^{2})=\rho(\sigma^{2})\rho(\boldsymbol{\beta}|%
\sigma^{2}),
  </annotation>
 </semantics>
</math>

</p>

<p>where 

<math display="inline" id="Bayesian_linear_regression:30">
 <semantics>
  <mrow>
   <mi>ρ</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msup>
     <mi>σ</mi>
     <mn>2</mn>
    </msup>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>ρ</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>σ</ci>
     <cn type="integer">2</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \rho(\sigma^{2})
  </annotation>
 </semantics>
</math>

 is an <a href="inverse-gamma_distribution" title="wikilink">inverse-gamma distribution</a></p>

<p>

<math display="block" id="Bayesian_linear_regression:31">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>ρ</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <msup>
       <mi>σ</mi>
       <mn>2</mn>
      </msup>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>∝</mo>
    <mrow>
     <msup>
      <mrow>
       <mo stretchy="false">(</mo>
       <msup>
        <mi>σ</mi>
        <mn>2</mn>
       </msup>
       <mo stretchy="false">)</mo>
      </mrow>
      <mrow>
       <mo>-</mo>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mrow>
          <msub>
           <mi>v</mi>
           <mn>0</mn>
          </msub>
          <mo>/</mo>
          <mn>2</mn>
         </mrow>
         <mo>+</mo>
         <mn>1</mn>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
     </msup>
     <mrow>
      <mi>exp</mi>
      <mrow>
       <mo>(</mo>
       <mrow>
        <mo>-</mo>
        <mfrac>
         <mrow>
          <msub>
           <mi>v</mi>
           <mn>0</mn>
          </msub>
          <msubsup>
           <mi>s</mi>
           <mn>0</mn>
           <mn>2</mn>
          </msubsup>
         </mrow>
         <mrow>
          <mn>2</mn>
          <msup>
           <mi>σ</mi>
           <mn>2</mn>
          </msup>
         </mrow>
        </mfrac>
       </mrow>
       <mo>)</mo>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">proportional-to</csymbol>
    <apply>
     <times></times>
     <ci>ρ</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>σ</ci>
      <cn type="integer">2</cn>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>σ</ci>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <minus></minus>
       <apply>
        <plus></plus>
        <apply>
         <divide></divide>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>v</ci>
          <cn type="integer">0</cn>
         </apply>
         <cn type="integer">2</cn>
        </apply>
        <cn type="integer">1</cn>
       </apply>
      </apply>
     </apply>
     <apply>
      <exp></exp>
      <apply>
       <minus></minus>
       <apply>
        <divide></divide>
        <apply>
         <times></times>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>v</ci>
          <cn type="integer">0</cn>
         </apply>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>s</ci>
           <cn type="integer">0</cn>
          </apply>
          <cn type="integer">2</cn>
         </apply>
        </apply>
        <apply>
         <times></times>
         <cn type="integer">2</cn>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>σ</ci>
          <cn type="integer">2</cn>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \rho(\sigma^{2})\propto(\sigma^{2})^{-(v_{0}/2+1)}\exp\left(-\frac{v_{0}s_{0}^%
{2}}{2{\sigma}^{2}}\right).
  </annotation>
 </semantics>
</math>

</p>

<p>In the notation introduced in the <a href="inverse-gamma_distribution" title="wikilink">inverse-gamma distribution</a> article, this is the density of an 

<math display="inline" id="Bayesian_linear_regression:32">
 <semantics>
  <mrow>
   <mtext>Inv-Gamma</mtext>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>a</mi>
     <mn>0</mn>
    </msub>
    <mo>,</mo>
    <msub>
     <mi>b</mi>
     <mn>0</mn>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <mtext>Inv-Gamma</mtext>
    <interval closure="open">
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>a</ci>
      <cn type="integer">0</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>b</ci>
      <cn type="integer">0</cn>
     </apply>
    </interval>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \text{Inv-Gamma}(a_{0},b_{0})
  </annotation>
 </semantics>
</math>

 distribution with 

<math display="inline" id="Bayesian_linear_regression:33">
 <semantics>
  <mrow>
   <msub>
    <mi>a</mi>
    <mn>0</mn>
   </msub>
   <mo>=</mo>
   <mrow>
    <msub>
     <mi>v</mi>
     <mn>0</mn>
    </msub>
    <mo>/</mo>
    <mn>2</mn>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>a</ci>
     <cn type="integer">0</cn>
    </apply>
    <apply>
     <divide></divide>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>v</ci>
      <cn type="integer">0</cn>
     </apply>
     <cn type="integer">2</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a_{0}=v_{0}/2
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Bayesian_linear_regression:34">
 <semantics>
  <mrow>
   <msub>
    <mi>b</mi>
    <mn>0</mn>
   </msub>
   <mo>=</mo>
   <mrow>
    <mfrac>
     <mn>1</mn>
     <mn>2</mn>
    </mfrac>
    <msub>
     <mi>v</mi>
     <mn>0</mn>
    </msub>
    <msubsup>
     <mi>s</mi>
     <mn>0</mn>
     <mn>2</mn>
    </msubsup>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>b</ci>
     <cn type="integer">0</cn>
    </apply>
    <apply>
     <times></times>
     <apply>
      <divide></divide>
      <cn type="integer">1</cn>
      <cn type="integer">2</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>v</ci>
      <cn type="integer">0</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>s</ci>
       <cn type="integer">0</cn>
      </apply>
      <cn type="integer">2</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   b_{0}=\frac{1}{2}v_{0}s_{0}^{2}
  </annotation>
 </semantics>
</math>

 with 

<math display="inline" id="Bayesian_linear_regression:35">
 <semantics>
  <msub>
   <mi>v</mi>
   <mn>0</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>v</ci>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   v_{0}
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Bayesian_linear_regression:36">
 <semantics>
  <msubsup>
   <mi>s</mi>
   <mn>0</mn>
   <mn>2</mn>
  </msubsup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>s</ci>
     <cn type="integer">0</cn>
    </apply>
    <cn type="integer">2</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   s_{0}^{2}
  </annotation>
 </semantics>
</math>

 as the prior values of 

<math display="inline" id="Bayesian_linear_regression:37">
 <semantics>
  <mi>v</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>v</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   v
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Bayesian_linear_regression:38">
 <semantics>
  <msup>
   <mi>s</mi>
   <mn>2</mn>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>s</ci>
    <cn type="integer">2</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   s^{2}
  </annotation>
 </semantics>
</math>

, respectively. Equivalently, it can also be described as a <a href="scaled_inverse_chi-squared_distribution" title="wikilink">scaled inverse chi-squared distribution</a>, 

<math display="inline" id="Bayesian_linear_regression:39">
 <semantics>
  <mrow>
   <mrow>
    <mtext>Scale-inv-</mtext>
    <msup>
     <mi>χ</mi>
     <mn>2</mn>
    </msup>
    <mrow>
     <mo stretchy="false">(</mo>
     <msub>
      <mi>v</mi>
      <mn>0</mn>
     </msub>
     <mo>,</mo>
     <msubsup>
      <mi>s</mi>
      <mn>0</mn>
      <mn>2</mn>
     </msubsup>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <mtext>Scale-inv-</mtext>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>χ</ci>
     <cn type="integer">2</cn>
    </apply>
    <interval closure="open">
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>v</ci>
      <cn type="integer">0</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>s</ci>
       <cn type="integer">0</cn>
      </apply>
      <cn type="integer">2</cn>
     </apply>
    </interval>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mbox{Scale-inv-}\chi^{2}(v_{0},s_{0}^{2}).
  </annotation>
 </semantics>
</math>

.</p>

<p>Further the conditional prior density 

<math display="inline" id="Bayesian_linear_regression:40">
 <semantics>
  <mrow>
   <mi>ρ</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>𝜷</mi>
    <mo stretchy="false">|</mo>
    <msup>
     <mi>σ</mi>
     <mn>2</mn>
    </msup>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">ρ</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">β</csymbol>
     <ci>normal-|</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>σ</ci>
      <cn type="integer">2</cn>
     </apply>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \rho(\boldsymbol{\beta}|\sigma^{2})
  </annotation>
 </semantics>
</math>

 is a <a href="normal_distribution" title="wikilink">normal distribution</a>,</p>

<p>

<math display="block" id="Bayesian_linear_regression:41">
 <semantics>
  <mrow>
   <mi>ρ</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>𝜷</mi>
    <mo stretchy="false">|</mo>
    <msup>
     <mi>σ</mi>
     <mn>2</mn>
    </msup>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>∝</mo>
   <msup>
    <mrow>
     <mo stretchy="false">(</mo>
     <msup>
      <mi>σ</mi>
      <mn>2</mn>
     </msup>
     <mo stretchy="false">)</mo>
    </mrow>
    <mrow>
     <mo>-</mo>
     <mrow>
      <mi>k</mi>
      <mo>/</mo>
      <mn>2</mn>
     </mrow>
    </mrow>
   </msup>
   <mi>exp</mi>
   <mrow>
    <mo>(</mo>
    <mo>-</mo>
    <mfrac>
     <mn>1</mn>
     <mrow>
      <mn>2</mn>
      <msup>
       <mi>σ</mi>
       <mn>2</mn>
      </msup>
     </mrow>
    </mfrac>
    <msup>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>𝜷</mi>
      <mo>-</mo>
      <msub>
       <mi>𝝁</mi>
       <mn>0</mn>
      </msub>
      <mo stretchy="false">)</mo>
     </mrow>
     <mi mathvariant="normal">T</mi>
    </msup>
    <msub>
     <mi>𝚲</mi>
     <mn>0</mn>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>𝜷</mi>
     <mo>-</mo>
     <msub>
      <mi>𝝁</mi>
      <mn>0</mn>
     </msub>
     <mo stretchy="false">)</mo>
    </mrow>
    <mo>)</mo>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">ρ</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">β</csymbol>
     <ci>normal-|</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>σ</ci>
      <cn type="integer">2</cn>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <csymbol cd="latexml">proportional-to</csymbol>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <ci>normal-(</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>σ</ci>
       <cn type="integer">2</cn>
      </apply>
      <ci>normal-)</ci>
     </cerror>
     <apply>
      <minus></minus>
      <apply>
       <divide></divide>
       <ci>k</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
    <exp></exp>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <minus></minus>
     <apply>
      <divide></divide>
      <cn type="integer">1</cn>
      <apply>
       <times></times>
       <cn type="integer">2</cn>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>σ</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <cerror>
       <csymbol cd="ambiguous">fragments</csymbol>
       <ci>normal-(</ci>
       <csymbol cd="unknown">β</csymbol>
       <minus></minus>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>𝝁</ci>
        <cn type="integer">0</cn>
       </apply>
       <ci>normal-)</ci>
      </cerror>
      <ci>normal-T</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>𝚲</ci>
      <cn type="integer">0</cn>
     </apply>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <ci>normal-(</ci>
      <csymbol cd="unknown">β</csymbol>
      <minus></minus>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>𝝁</ci>
       <cn type="integer">0</cn>
      </apply>
      <ci>normal-)</ci>
     </cerror>
     <ci>normal-)</ci>
    </cerror>
    <ci>normal-.</ci>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \rho(\boldsymbol{\beta}|\sigma^{2})\propto(\sigma^{2})^{-k/2}\exp\left(-\frac{%
1}{2{\sigma}^{2}}(\boldsymbol{\beta}-\boldsymbol{\mu}_{0})^{\rm T}\mathbf{%
\Lambda}_{0}(\boldsymbol{\beta}-\boldsymbol{\mu}_{0})\right).
  </annotation>
 </semantics>
</math>

</p>

<p>In the notation of the <a href="normal_distribution" title="wikilink">normal distribution</a>, the conditional prior distribution is 

<math display="inline" id="Bayesian_linear_regression:42">
 <semantics>
  <mrow>
   <mrow>
    <mi class="ltx_font_mathcaligraphic">𝒩</mi>
    <mrow>
     <mo>(</mo>
     <msub>
      <mi>𝝁</mi>
      <mn>0</mn>
     </msub>
     <mo>,</mo>
     <mrow>
      <msup>
       <mi>σ</mi>
       <mn>2</mn>
      </msup>
      <msubsup>
       <mi>𝚲</mi>
       <mn>0</mn>
       <mrow>
        <mo>-</mo>
        <mn>1</mn>
       </mrow>
      </msubsup>
     </mrow>
     <mo>)</mo>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>𝒩</ci>
    <interval closure="open">
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>𝝁</ci>
      <cn type="integer">0</cn>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>σ</ci>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>𝚲</ci>
        <cn type="integer">0</cn>
       </apply>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
       </apply>
      </apply>
     </apply>
    </interval>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathcal{N}\left(\boldsymbol{\mu}_{0},\sigma^{2}\mathbf{\Lambda}_{0}^{-1}%
\right).
  </annotation>
 </semantics>
</math>

</p>
<h3 id="posterior-distribution">Posterior distribution</h3>

<p>With the prior now specified, the posterior distribution can be expressed as</p>

<p>

<math display="block" id="Bayesian_linear_regression:43">
 <semantics>
  <mrow>
   <mi>ρ</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>𝜷</mi>
    <mo>,</mo>
    <msup>
     <mi>σ</mi>
     <mn>2</mn>
    </msup>
    <mo stretchy="false">|</mo>
    <mi>𝐲</mi>
    <mo>,</mo>
    <mi>𝐗</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>∝</mo>
   <mi>ρ</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>𝐲</mi>
    <mo stretchy="false">|</mo>
    <mi>𝐗</mi>
    <mo>,</mo>
    <mi>𝜷</mi>
    <mo>,</mo>
    <msup>
     <mi>σ</mi>
     <mn>2</mn>
    </msup>
    <mo stretchy="false">)</mo>
   </mrow>
   <mi>ρ</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>𝜷</mi>
    <mo stretchy="false">|</mo>
    <msup>
     <mi>σ</mi>
     <mn>2</mn>
    </msup>
    <mo stretchy="false">)</mo>
   </mrow>
   <mi>ρ</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msup>
     <mi>σ</mi>
     <mn>2</mn>
    </msup>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">ρ</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">β</csymbol>
     <ci>normal-,</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>σ</ci>
      <cn type="integer">2</cn>
     </apply>
     <ci>normal-|</ci>
     <csymbol cd="unknown">y</csymbol>
     <ci>normal-,</ci>
     <csymbol cd="unknown">X</csymbol>
     <ci>normal-)</ci>
    </cerror>
    <csymbol cd="latexml">proportional-to</csymbol>
    <csymbol cd="unknown">ρ</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">y</csymbol>
     <ci>normal-|</ci>
     <csymbol cd="unknown">X</csymbol>
     <ci>normal-,</ci>
     <csymbol cd="unknown">β</csymbol>
     <ci>normal-,</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>σ</ci>
      <cn type="integer">2</cn>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <csymbol cd="unknown">ρ</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">β</csymbol>
     <ci>normal-|</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>σ</ci>
      <cn type="integer">2</cn>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <csymbol cd="unknown">ρ</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>σ</ci>
      <cn type="integer">2</cn>
     </apply>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \rho(\boldsymbol{\beta},\sigma^{2}|\mathbf{y},\mathbf{X})\propto\rho(\mathbf{y%
}|\mathbf{X},\boldsymbol{\beta},\sigma^{2})\rho(\boldsymbol{\beta}|\sigma^{2})%
\rho(\sigma^{2})
  </annotation>
 </semantics>
</math>

</p>
<dl>
<dd><dl>
<dd>

<math display="inline" id="Bayesian_linear_regression:44">
 <semantics>
  <mrow>
   <mi></mi>
   <mo>∝</mo>
   <mrow>
    <msup>
     <mrow>
      <mo stretchy="false">(</mo>
      <msup>
       <mi>σ</mi>
       <mn>2</mn>
      </msup>
      <mo stretchy="false">)</mo>
     </mrow>
     <mrow>
      <mo>-</mo>
      <mrow>
       <mi>n</mi>
       <mo>/</mo>
       <mn>2</mn>
      </mrow>
     </mrow>
    </msup>
    <mrow>
     <mi>exp</mi>
     <mrow>
      <mo>(</mo>
      <mrow>
       <mo>-</mo>
       <mrow>
        <mfrac>
         <mn>1</mn>
         <mrow>
          <mn>2</mn>
          <msup>
           <mi>σ</mi>
           <mn>2</mn>
          </msup>
         </mrow>
        </mfrac>
        <msup>
         <mrow>
          <mo stretchy="false">(</mo>
          <mrow>
           <mi>𝐲</mi>
           <mo>-</mo>
           <mrow>
            <mi>𝐗</mi>
            <mi>𝜷</mi>
           </mrow>
          </mrow>
          <mo stretchy="false">)</mo>
         </mrow>
         <mi mathvariant="normal">T</mi>
        </msup>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <mi>𝐲</mi>
          <mo>-</mo>
          <mrow>
           <mi>𝐗</mi>
           <mi>𝜷</mi>
          </mrow>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
      </mrow>
      <mo>)</mo>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">proportional-to</csymbol>
    <csymbol cd="latexml">absent</csymbol>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>σ</ci>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <minus></minus>
       <apply>
        <divide></divide>
        <ci>n</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
     </apply>
     <apply>
      <exp></exp>
      <apply>
       <minus></minus>
       <apply>
        <times></times>
        <apply>
         <divide></divide>
         <cn type="integer">1</cn>
         <apply>
          <times></times>
          <cn type="integer">2</cn>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <ci>σ</ci>
           <cn type="integer">2</cn>
          </apply>
         </apply>
        </apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <minus></minus>
          <ci>𝐲</ci>
          <apply>
           <times></times>
           <ci>𝐗</ci>
           <ci>𝜷</ci>
          </apply>
         </apply>
         <ci>normal-T</ci>
        </apply>
        <apply>
         <minus></minus>
         <ci>𝐲</ci>
         <apply>
          <times></times>
          <ci>𝐗</ci>
          <ci>𝜷</ci>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \propto(\sigma^{2})^{-n/2}\exp\left(-\frac{1}{2{\sigma}^{2}}(\mathbf{y}-%
\mathbf{X}\boldsymbol{\beta})^{\rm T}(\mathbf{y}-\mathbf{X}\boldsymbol{\beta})\right)
  </annotation>
 </semantics>
</math>


</dd>
</dl>
</dd>
</dl>
<dl>
<dd><dl>
<dd>

<math display="inline" id="Bayesian_linear_regression:45">
 <semantics>
  <mrow>
   <mi></mi>
   <mo>×</mo>
   <mrow>
    <msup>
     <mrow>
      <mo stretchy="false">(</mo>
      <msup>
       <mi>σ</mi>
       <mn>2</mn>
      </msup>
      <mo stretchy="false">)</mo>
     </mrow>
     <mrow>
      <mo>-</mo>
      <mrow>
       <mi>k</mi>
       <mo>/</mo>
       <mn>2</mn>
      </mrow>
     </mrow>
    </msup>
    <mrow>
     <mi>exp</mi>
     <mrow>
      <mo>(</mo>
      <mrow>
       <mo>-</mo>
       <mrow>
        <mfrac>
         <mn>1</mn>
         <mrow>
          <mn>2</mn>
          <msup>
           <mi>σ</mi>
           <mn>2</mn>
          </msup>
         </mrow>
        </mfrac>
        <msup>
         <mrow>
          <mo stretchy="false">(</mo>
          <mrow>
           <mi>𝜷</mi>
           <mo>-</mo>
           <msub>
            <mi>𝝁</mi>
            <mn>0</mn>
           </msub>
          </mrow>
          <mo stretchy="false">)</mo>
         </mrow>
         <mi mathvariant="normal">T</mi>
        </msup>
        <msub>
         <mi>𝚲</mi>
         <mn>0</mn>
        </msub>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <mi>𝜷</mi>
          <mo>-</mo>
          <msub>
           <mi>𝝁</mi>
           <mn>0</mn>
          </msub>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
      </mrow>
      <mo>)</mo>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <csymbol cd="latexml">absent</csymbol>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>σ</ci>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <minus></minus>
       <apply>
        <divide></divide>
        <ci>k</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
     </apply>
     <apply>
      <exp></exp>
      <apply>
       <minus></minus>
       <apply>
        <times></times>
        <apply>
         <divide></divide>
         <cn type="integer">1</cn>
         <apply>
          <times></times>
          <cn type="integer">2</cn>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <ci>σ</ci>
           <cn type="integer">2</cn>
          </apply>
         </apply>
        </apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <minus></minus>
          <ci>𝜷</ci>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>𝝁</ci>
           <cn type="integer">0</cn>
          </apply>
         </apply>
         <ci>normal-T</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>𝚲</ci>
         <cn type="integer">0</cn>
        </apply>
        <apply>
         <minus></minus>
         <ci>𝜷</ci>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>𝝁</ci>
          <cn type="integer">0</cn>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \times(\sigma^{2})^{-k/2}\exp\left(-\frac{1}{2{\sigma}^{2}}(\boldsymbol{\beta}%
-\boldsymbol{\mu}_{0})^{\rm T}\boldsymbol{\Lambda}_{0}(\boldsymbol{\beta}-%
\boldsymbol{\mu}_{0})\right)
  </annotation>
 </semantics>
</math>


</dd>
</dl>
</dd>
</dl>
<dl>
<dd><dl>
<dd>

<math display="inline" id="Bayesian_linear_regression:46">
 <semantics>
  <mrow>
   <mrow>
    <mi></mi>
    <mo>×</mo>
    <mrow>
     <msup>
      <mrow>
       <mo stretchy="false">(</mo>
       <msup>
        <mi>σ</mi>
        <mn>2</mn>
       </msup>
       <mo stretchy="false">)</mo>
      </mrow>
      <mrow>
       <mo>-</mo>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <msub>
          <mi>a</mi>
          <mn>0</mn>
         </msub>
         <mo>+</mo>
         <mn>1</mn>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
     </msup>
     <mrow>
      <mi>exp</mi>
      <mrow>
       <mo>(</mo>
       <mrow>
        <mo>-</mo>
        <mfrac>
         <msub>
          <mi>b</mi>
          <mn>0</mn>
         </msub>
         <msup>
          <mi>σ</mi>
          <mn>2</mn>
         </msup>
        </mfrac>
       </mrow>
       <mo>)</mo>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <csymbol cd="latexml">absent</csymbol>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>σ</ci>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <minus></minus>
       <apply>
        <plus></plus>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>a</ci>
         <cn type="integer">0</cn>
        </apply>
        <cn type="integer">1</cn>
       </apply>
      </apply>
     </apply>
     <apply>
      <exp></exp>
      <apply>
       <minus></minus>
       <apply>
        <divide></divide>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>b</ci>
         <cn type="integer">0</cn>
        </apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>σ</ci>
         <cn type="integer">2</cn>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \times(\sigma^{2})^{-(a_{0}+1)}\exp\left(-\frac{b_{0}}{{\sigma}^{2}}\right).
  </annotation>
 </semantics>
</math>


</dd>
</dl>
</dd>
</dl>

<p>With some re-arrangement,<a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a> the posterior can be re-written so that the posterior mean 

<math display="inline" id="Bayesian_linear_regression:47">
 <semantics>
  <msub>
   <mi>𝝁</mi>
   <mi>n</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>𝝁</ci>
    <ci>n</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \boldsymbol{\mu}_{n}
  </annotation>
 </semantics>
</math>

 of the parameter vector 

<math display="inline" id="Bayesian_linear_regression:48">
 <semantics>
  <mi>𝜷</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>𝜷</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \boldsymbol{\beta}
  </annotation>
 </semantics>
</math>

 can be expressed in terms of the least squares estimator 

<math display="inline" id="Bayesian_linear_regression:49">
 <semantics>
  <mover accent="true">
   <mi>𝜷</mi>
   <mo stretchy="false">^</mo>
  </mover>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-^</ci>
    <ci>𝜷</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \hat{\boldsymbol{\beta}}
  </annotation>
 </semantics>
</math>

 and the prior mean 

<math display="inline" id="Bayesian_linear_regression:50">
 <semantics>
  <msub>
   <mi>𝝁</mi>
   <mn>0</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>𝝁</ci>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \boldsymbol{\mu}_{0}
  </annotation>
 </semantics>
</math>

, with the strength of the prior indicated by the prior precision matrix 

<math display="inline" id="Bayesian_linear_regression:51">
 <semantics>
  <msub>
   <mi>𝚲</mi>
   <mn>0</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>𝚲</ci>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \boldsymbol{\Lambda}_{0}
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Bayesian_linear_regression:52">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>𝝁</mi>
     <mi>n</mi>
    </msub>
    <mo>=</mo>
    <mrow>
     <msup>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mrow>
         <msup>
          <mi>𝐗</mi>
          <mi mathvariant="normal">T</mi>
         </msup>
         <mi>𝐗</mi>
        </mrow>
        <mo>+</mo>
        <msub>
         <mi>𝚲</mi>
         <mn>0</mn>
        </msub>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
      <mrow>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
     </msup>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mrow>
        <msup>
         <mi>𝐗</mi>
         <mi mathvariant="normal">T</mi>
        </msup>
        <mi>𝐗</mi>
        <mover accent="true">
         <mi>𝜷</mi>
         <mo stretchy="false">^</mo>
        </mover>
       </mrow>
       <mo>+</mo>
       <mrow>
        <msub>
         <mi>𝚲</mi>
         <mn>0</mn>
        </msub>
        <msub>
         <mi>𝝁</mi>
         <mn>0</mn>
        </msub>
       </mrow>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>𝝁</ci>
     <ci>n</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <plus></plus>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>𝐗</ci>
         <ci>normal-T</ci>
        </apply>
        <ci>𝐗</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>𝚲</ci>
        <cn type="integer">0</cn>
       </apply>
      </apply>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <apply>
      <plus></plus>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>𝐗</ci>
        <ci>normal-T</ci>
       </apply>
       <ci>𝐗</ci>
       <apply>
        <ci>normal-^</ci>
        <ci>𝜷</ci>
       </apply>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>𝚲</ci>
        <cn type="integer">0</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>𝝁</ci>
        <cn type="integer">0</cn>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \boldsymbol{\mu}_{n}=(\mathbf{X}^{\rm T}\mathbf{X}+\boldsymbol{\Lambda}_{0})^{%
-1}(\mathbf{X}^{\rm T}\mathbf{X}\hat{\boldsymbol{\beta}}+\boldsymbol{\Lambda}_%
{0}\boldsymbol{\mu}_{0}).
  </annotation>
 </semantics>
</math>

</p>

<p>To justify that 

<math display="inline" id="Bayesian_linear_regression:53">
 <semantics>
  <msub>
   <mi>𝝁</mi>
   <mi>n</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>𝝁</ci>
    <ci>n</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \boldsymbol{\mu}_{n}
  </annotation>
 </semantics>
</math>

 is indeed the posterior mean, the quadratic terms in the exponential can be re-arranged as a <a href="quadratic_form_(statistics)" title="wikilink">quadratic form</a> in 

<math display="inline" id="Bayesian_linear_regression:54">
 <semantics>
  <mrow>
   <mi>𝜷</mi>
   <mo>-</mo>
   <msub>
    <mi>𝝁</mi>
    <mi>n</mi>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <minus></minus>
    <ci>𝜷</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>𝝁</ci>
     <ci>n</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \boldsymbol{\beta}-\boldsymbol{\mu}_{n}
  </annotation>
 </semantics>
</math>

.<a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a></p>

<p>

<math display="block" id="Bayesian_linear_regression:55">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <msup>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mi>𝐲</mi>
        <mo>-</mo>
        <mrow>
         <mi>𝐗</mi>
         <mi>𝜷</mi>
        </mrow>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
      <mi mathvariant="normal">T</mi>
     </msup>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mi>𝐲</mi>
       <mo>-</mo>
       <mrow>
        <mi>𝐗</mi>
        <mi>𝜷</mi>
       </mrow>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>+</mo>
    <mrow>
     <msup>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mi>𝜷</mi>
        <mo>-</mo>
        <msub>
         <mi>𝝁</mi>
         <mn>0</mn>
        </msub>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
      <mi mathvariant="normal">T</mi>
     </msup>
     <msub>
      <mi>𝚲</mi>
      <mn>0</mn>
     </msub>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mi>𝜷</mi>
       <mo>-</mo>
       <msub>
        <mi>𝝁</mi>
        <mn>0</mn>
       </msub>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mi></mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <minus></minus>
        <ci>𝐲</ci>
        <apply>
         <times></times>
         <ci>𝐗</ci>
         <ci>𝜷</ci>
        </apply>
       </apply>
       <ci>normal-T</ci>
      </apply>
      <apply>
       <minus></minus>
       <ci>𝐲</ci>
       <apply>
        <times></times>
        <ci>𝐗</ci>
        <ci>𝜷</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <minus></minus>
        <ci>𝜷</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>𝝁</ci>
         <cn type="integer">0</cn>
        </apply>
       </apply>
       <ci>normal-T</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>𝚲</ci>
       <cn type="integer">0</cn>
      </apply>
      <apply>
       <minus></minus>
       <ci>𝜷</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>𝝁</ci>
        <cn type="integer">0</cn>
       </apply>
      </apply>
     </apply>
    </apply>
    <csymbol cd="latexml">absent</csymbol>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (\mathbf{y}-\mathbf{X}\boldsymbol{\beta})^{\rm T}(\mathbf{y}-\mathbf{X}%
\boldsymbol{\beta})+(\boldsymbol{\beta}-\boldsymbol{\mu}_{0})^{\rm T}%
\boldsymbol{\Lambda}_{0}(\boldsymbol{\beta}-\boldsymbol{\mu}_{0})=
  </annotation>
 </semantics>
</math>

</p>
<dl>
<dd><dl>
<dd>

<math display="inline" id="Bayesian_linear_regression:56">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mrow>
      <mrow>
       <msup>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <mi>𝜷</mi>
          <mo>-</mo>
          <msub>
           <mi>𝝁</mi>
           <mi>n</mi>
          </msub>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
        <mi mathvariant="normal">T</mi>
       </msup>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mrow>
          <msup>
           <mi>𝐗</mi>
           <mi mathvariant="normal">T</mi>
          </msup>
          <mi>𝐗</mi>
         </mrow>
         <mo>+</mo>
         <msub>
          <mi>𝚲</mi>
          <mn>0</mn>
         </msub>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mi>𝜷</mi>
         <mo>-</mo>
         <msub>
          <mi>𝝁</mi>
          <mi>n</mi>
         </msub>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
      <mo>+</mo>
      <mrow>
       <msup>
        <mi>𝐲</mi>
        <mi mathvariant="normal">T</mi>
       </msup>
       <mi>𝐲</mi>
      </mrow>
     </mrow>
     <mo>-</mo>
     <mrow>
      <msubsup>
       <mi>𝝁</mi>
       <mi>n</mi>
       <mi mathvariant="normal">T</mi>
      </msubsup>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mrow>
         <msup>
          <mi>𝐗</mi>
          <mi mathvariant="normal">T</mi>
         </msup>
         <mi>𝐗</mi>
        </mrow>
        <mo>+</mo>
        <msub>
         <mi>𝚲</mi>
         <mn>0</mn>
        </msub>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
      <msub>
       <mi>𝝁</mi>
       <mi>n</mi>
      </msub>
     </mrow>
    </mrow>
    <mo>+</mo>
    <mrow>
     <msubsup>
      <mi>𝝁</mi>
      <mn>0</mn>
      <mi mathvariant="normal">T</mi>
     </msubsup>
     <msub>
      <mi>𝚲</mi>
      <mn>0</mn>
     </msub>
     <msub>
      <mi>𝝁</mi>
      <mn>0</mn>
     </msub>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <plus></plus>
    <apply>
     <minus></minus>
     <apply>
      <plus></plus>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <minus></minus>
         <ci>𝜷</ci>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>𝝁</ci>
          <ci>n</ci>
         </apply>
        </apply>
        <ci>normal-T</ci>
       </apply>
       <apply>
        <plus></plus>
        <apply>
         <times></times>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>𝐗</ci>
          <ci>normal-T</ci>
         </apply>
         <ci>𝐗</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>𝚲</ci>
         <cn type="integer">0</cn>
        </apply>
       </apply>
       <apply>
        <minus></minus>
        <ci>𝜷</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>𝝁</ci>
         <ci>n</ci>
        </apply>
       </apply>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>𝐲</ci>
        <ci>normal-T</ci>
       </apply>
       <ci>𝐲</ci>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>𝝁</ci>
        <ci>n</ci>
       </apply>
       <ci>normal-T</ci>
      </apply>
      <apply>
       <plus></plus>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>𝐗</ci>
         <ci>normal-T</ci>
        </apply>
        <ci>𝐗</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>𝚲</ci>
        <cn type="integer">0</cn>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>𝝁</ci>
       <ci>n</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>𝝁</ci>
       <cn type="integer">0</cn>
      </apply>
      <ci>normal-T</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>𝚲</ci>
      <cn type="integer">0</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>𝝁</ci>
      <cn type="integer">0</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (\boldsymbol{\beta}-\boldsymbol{\mu}_{n})^{\rm T}(\mathbf{X}^{\rm T}\mathbf{X}%
+\boldsymbol{\Lambda}_{0})(\boldsymbol{\beta}-\boldsymbol{\mu}_{n})+\mathbf{y}%
^{\rm T}\mathbf{y}-\boldsymbol{\mu}_{n}^{\rm T}(\mathbf{X}^{\rm T}\mathbf{X}+%
\boldsymbol{\Lambda}_{0})\boldsymbol{\mu}_{n}+\boldsymbol{\mu}_{0}^{\rm T}%
\boldsymbol{\Lambda}_{0}\boldsymbol{\mu}_{0}.
  </annotation>
 </semantics>
</math>


</dd>
</dl>
</dd>
</dl>

<p>Now the posterior can be expressed as a <a href="normal_distribution" title="wikilink">normal distribution</a> times an <a href="inverse-gamma_distribution" title="wikilink">inverse-gamma distribution</a>:</p>

<p>

<math display="block" id="Bayesian_linear_regression:57">
 <semantics>
  <mrow>
   <mi>ρ</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>𝜷</mi>
    <mo>,</mo>
    <msup>
     <mi>σ</mi>
     <mn>2</mn>
    </msup>
    <mo stretchy="false">|</mo>
    <mi>𝐲</mi>
    <mo>,</mo>
    <mi>𝐗</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>∝</mo>
   <msup>
    <mrow>
     <mo stretchy="false">(</mo>
     <msup>
      <mi>σ</mi>
      <mn>2</mn>
     </msup>
     <mo stretchy="false">)</mo>
    </mrow>
    <mrow>
     <mo>-</mo>
     <mrow>
      <mi>k</mi>
      <mo>/</mo>
      <mn>2</mn>
     </mrow>
    </mrow>
   </msup>
   <mi>exp</mi>
   <mrow>
    <mo>(</mo>
    <mo>-</mo>
    <mfrac>
     <mn>1</mn>
     <mrow>
      <mn>2</mn>
      <msup>
       <mi>σ</mi>
       <mn>2</mn>
      </msup>
     </mrow>
    </mfrac>
    <msup>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>𝜷</mi>
      <mo>-</mo>
      <msub>
       <mi>𝝁</mi>
       <mi>n</mi>
      </msub>
      <mo stretchy="false">)</mo>
     </mrow>
     <mi mathvariant="normal">T</mi>
    </msup>
    <mrow>
     <mo stretchy="false">(</mo>
     <msup>
      <mi>𝐗</mi>
      <mi mathvariant="normal">T</mi>
     </msup>
     <mi>𝐗</mi>
     <mo>+</mo>
     <msub>
      <mi>𝚲</mi>
      <mn>0</mn>
     </msub>
     <mo stretchy="false">)</mo>
    </mrow>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>𝜷</mi>
     <mo>-</mo>
     <msub>
      <mi>𝝁</mi>
      <mi>n</mi>
     </msub>
     <mo stretchy="false">)</mo>
    </mrow>
    <mo>)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">ρ</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">β</csymbol>
     <ci>normal-,</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>σ</ci>
      <cn type="integer">2</cn>
     </apply>
     <ci>normal-|</ci>
     <csymbol cd="unknown">y</csymbol>
     <ci>normal-,</ci>
     <csymbol cd="unknown">X</csymbol>
     <ci>normal-)</ci>
    </cerror>
    <csymbol cd="latexml">proportional-to</csymbol>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <ci>normal-(</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>σ</ci>
       <cn type="integer">2</cn>
      </apply>
      <ci>normal-)</ci>
     </cerror>
     <apply>
      <minus></minus>
      <apply>
       <divide></divide>
       <ci>k</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
    <exp></exp>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <minus></minus>
     <apply>
      <divide></divide>
      <cn type="integer">1</cn>
      <apply>
       <times></times>
       <cn type="integer">2</cn>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>σ</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <cerror>
       <csymbol cd="ambiguous">fragments</csymbol>
       <ci>normal-(</ci>
       <csymbol cd="unknown">β</csymbol>
       <minus></minus>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>𝝁</ci>
        <ci>n</ci>
       </apply>
       <ci>normal-)</ci>
      </cerror>
      <ci>normal-T</ci>
     </apply>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <ci>normal-(</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>𝐗</ci>
       <ci>normal-T</ci>
      </apply>
      <csymbol cd="unknown">X</csymbol>
      <plus></plus>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>𝚲</ci>
       <cn type="integer">0</cn>
      </apply>
      <ci>normal-)</ci>
     </cerror>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <ci>normal-(</ci>
      <csymbol cd="unknown">β</csymbol>
      <minus></minus>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>𝝁</ci>
       <ci>n</ci>
      </apply>
      <ci>normal-)</ci>
     </cerror>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \rho(\boldsymbol{\beta},\sigma^{2}|\mathbf{y},\mathbf{X})\propto(\sigma^{2})^{%
-k/2}\exp\left(-\frac{1}{2{\sigma}^{2}}(\boldsymbol{\beta}-\boldsymbol{\mu}_{n%
})^{\rm T}(\mathbf{X}^{\rm T}\mathbf{X}+\mathbf{\Lambda}_{0})(\boldsymbol{%
\beta}-\boldsymbol{\mu}_{n})\right)
  </annotation>
 </semantics>
</math>

</p>
<dl>
<dd><dl>
<dd>

<math display="inline" id="Bayesian_linear_regression:58">
 <semantics>
  <mrow>
   <mrow>
    <mi></mi>
    <mo>×</mo>
    <mrow>
     <msup>
      <mrow>
       <mo stretchy="false">(</mo>
       <msup>
        <mi>σ</mi>
        <mn>2</mn>
       </msup>
       <mo stretchy="false">)</mo>
      </mrow>
      <mrow>
       <mrow>
        <mo>-</mo>
        <mrow>
         <mrow>
          <mo stretchy="false">(</mo>
          <mrow>
           <mi>n</mi>
           <mo>+</mo>
           <mrow>
            <mn>2</mn>
            <msub>
             <mi>a</mi>
             <mn>0</mn>
            </msub>
           </mrow>
          </mrow>
          <mo stretchy="false">)</mo>
         </mrow>
         <mo>/</mo>
         <mn>2</mn>
        </mrow>
       </mrow>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
     </msup>
     <mrow>
      <mi>exp</mi>
      <mrow>
       <mo>(</mo>
       <mrow>
        <mo>-</mo>
        <mfrac>
         <mrow>
          <mrow>
           <mrow>
            <mrow>
             <mn>2</mn>
             <msub>
              <mi>b</mi>
              <mn>0</mn>
             </msub>
            </mrow>
            <mo>+</mo>
            <mrow>
             <msup>
              <mi>𝐲</mi>
              <mi mathvariant="normal">T</mi>
             </msup>
             <mi>𝐲</mi>
            </mrow>
           </mrow>
           <mo>-</mo>
           <mrow>
            <msubsup>
             <mi>𝝁</mi>
             <mi>n</mi>
             <mi mathvariant="normal">T</mi>
            </msubsup>
            <mrow>
             <mo stretchy="false">(</mo>
             <mrow>
              <mrow>
               <msup>
                <mi>𝐗</mi>
                <mi mathvariant="normal">T</mi>
               </msup>
               <mi>𝐗</mi>
              </mrow>
              <mo>+</mo>
              <msub>
               <mi>𝚲</mi>
               <mn>0</mn>
              </msub>
             </mrow>
             <mo stretchy="false">)</mo>
            </mrow>
            <msub>
             <mi>𝝁</mi>
             <mi>n</mi>
            </msub>
           </mrow>
          </mrow>
          <mo>+</mo>
          <mrow>
           <msubsup>
            <mi>𝝁</mi>
            <mn>0</mn>
            <mi mathvariant="normal">T</mi>
           </msubsup>
           <msub>
            <mi>𝚲</mi>
            <mn>0</mn>
           </msub>
           <msub>
            <mi>𝝁</mi>
            <mn>0</mn>
           </msub>
          </mrow>
         </mrow>
         <mrow>
          <mn>2</mn>
          <msup>
           <mi>σ</mi>
           <mn>2</mn>
          </msup>
         </mrow>
        </mfrac>
       </mrow>
       <mo>)</mo>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <csymbol cd="latexml">absent</csymbol>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>σ</ci>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <minus></minus>
       <apply>
        <minus></minus>
        <apply>
         <divide></divide>
         <apply>
          <plus></plus>
          <ci>n</ci>
          <apply>
           <times></times>
           <cn type="integer">2</cn>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <ci>a</ci>
            <cn type="integer">0</cn>
           </apply>
          </apply>
         </apply>
         <cn type="integer">2</cn>
        </apply>
       </apply>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <apply>
      <exp></exp>
      <apply>
       <minus></minus>
       <apply>
        <divide></divide>
        <apply>
         <plus></plus>
         <apply>
          <minus></minus>
          <apply>
           <plus></plus>
           <apply>
            <times></times>
            <cn type="integer">2</cn>
            <apply>
             <csymbol cd="ambiguous">subscript</csymbol>
             <ci>b</ci>
             <cn type="integer">0</cn>
            </apply>
           </apply>
           <apply>
            <times></times>
            <apply>
             <csymbol cd="ambiguous">superscript</csymbol>
             <ci>𝐲</ci>
             <ci>normal-T</ci>
            </apply>
            <ci>𝐲</ci>
           </apply>
          </apply>
          <apply>
           <times></times>
           <apply>
            <csymbol cd="ambiguous">superscript</csymbol>
            <apply>
             <csymbol cd="ambiguous">subscript</csymbol>
             <ci>𝝁</ci>
             <ci>n</ci>
            </apply>
            <ci>normal-T</ci>
           </apply>
           <apply>
            <plus></plus>
            <apply>
             <times></times>
             <apply>
              <csymbol cd="ambiguous">superscript</csymbol>
              <ci>𝐗</ci>
              <ci>normal-T</ci>
             </apply>
             <ci>𝐗</ci>
            </apply>
            <apply>
             <csymbol cd="ambiguous">subscript</csymbol>
             <ci>𝚲</ci>
             <cn type="integer">0</cn>
            </apply>
           </apply>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <ci>𝝁</ci>
            <ci>n</ci>
           </apply>
          </apply>
         </apply>
         <apply>
          <times></times>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <ci>𝝁</ci>
            <cn type="integer">0</cn>
           </apply>
           <ci>normal-T</ci>
          </apply>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>𝚲</ci>
           <cn type="integer">0</cn>
          </apply>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>𝝁</ci>
           <cn type="integer">0</cn>
          </apply>
         </apply>
        </apply>
        <apply>
         <times></times>
         <cn type="integer">2</cn>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>σ</ci>
          <cn type="integer">2</cn>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \times(\sigma^{2})^{-(n+2a_{0})/2-1}\exp\left(-\frac{2b_{0}+\mathbf{y}^{\rm T}%
\mathbf{y}-\boldsymbol{\mu}_{n}^{\rm T}(\mathbf{X}^{\rm T}\mathbf{X}+%
\boldsymbol{\Lambda}_{0})\boldsymbol{\mu}_{n}+\boldsymbol{\mu}_{0}^{\rm T}%
\boldsymbol{\Lambda}_{0}\boldsymbol{\mu}_{0}}{2{\sigma}^{2}}\right).
  </annotation>
 </semantics>
</math>


</dd>
</dl>
</dd>
</dl>

<p>Therefore the posterior distribution can be parametrized as follows.</p>

<p>

<math display="block" id="Bayesian_linear_regression:59">
 <semantics>
  <mrow>
   <mi>ρ</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>𝜷</mi>
    <mo>,</mo>
    <msup>
     <mi>σ</mi>
     <mn>2</mn>
    </msup>
    <mo stretchy="false">|</mo>
    <mi>𝐲</mi>
    <mo>,</mo>
    <mi>𝐗</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>∝</mo>
   <mi>ρ</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>𝜷</mi>
    <mo stretchy="false">|</mo>
    <msup>
     <mi>σ</mi>
     <mn>2</mn>
    </msup>
    <mo>,</mo>
    <mi>𝐲</mi>
    <mo>,</mo>
    <mi>𝐗</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mi>ρ</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msup>
     <mi>σ</mi>
     <mn>2</mn>
    </msup>
    <mo stretchy="false">|</mo>
    <mi>𝐲</mi>
    <mo>,</mo>
    <mi>𝐗</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">ρ</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">β</csymbol>
     <ci>normal-,</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>σ</ci>
      <cn type="integer">2</cn>
     </apply>
     <ci>normal-|</ci>
     <csymbol cd="unknown">y</csymbol>
     <ci>normal-,</ci>
     <csymbol cd="unknown">X</csymbol>
     <ci>normal-)</ci>
    </cerror>
    <csymbol cd="latexml">proportional-to</csymbol>
    <csymbol cd="unknown">ρ</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">β</csymbol>
     <ci>normal-|</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>σ</ci>
      <cn type="integer">2</cn>
     </apply>
     <ci>normal-,</ci>
     <csymbol cd="unknown">y</csymbol>
     <ci>normal-,</ci>
     <csymbol cd="unknown">X</csymbol>
     <ci>normal-)</ci>
    </cerror>
    <csymbol cd="unknown">ρ</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>σ</ci>
      <cn type="integer">2</cn>
     </apply>
     <ci>normal-|</ci>
     <csymbol cd="unknown">y</csymbol>
     <ci>normal-,</ci>
     <csymbol cd="unknown">X</csymbol>
     <ci>normal-)</ci>
    </cerror>
    <ci>normal-,</ci>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \rho(\boldsymbol{\beta},\sigma^{2}|\mathbf{y},\mathbf{X})\propto\rho(%
\boldsymbol{\beta}|\sigma^{2},\mathbf{y},\mathbf{X})\rho(\sigma^{2}|\mathbf{y}%
,\mathbf{X}),
  </annotation>
 </semantics>
</math>

</p>

<p>where the two factors correspond to the densities of 

<math display="inline" id="Bayesian_linear_regression:60">
 <semantics>
  <mrow>
   <mi class="ltx_font_mathcaligraphic">𝒩</mi>
   <mrow>
    <mo>(</mo>
    <msub>
     <mi>𝝁</mi>
     <mi>n</mi>
    </msub>
    <mo>,</mo>
    <mrow>
     <msup>
      <mi>σ</mi>
      <mn>2</mn>
     </msup>
     <msubsup>
      <mi>𝚲</mi>
      <mi>n</mi>
      <mrow>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
     </msubsup>
    </mrow>
    <mo rspace="4.2pt">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>𝒩</ci>
    <interval closure="open">
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>𝝁</ci>
      <ci>n</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>σ</ci>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>𝚲</ci>
        <ci>n</ci>
       </apply>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
       </apply>
      </apply>
     </apply>
    </interval>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathcal{N}\left(\boldsymbol{\mu}_{n},\sigma^{2}\boldsymbol{\Lambda}_{n}^{-1}%
\right)\,
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Bayesian_linear_regression:61">
 <semantics>
  <mrow>
   <mtext>Inv-Gamma</mtext>
   <mrow>
    <mo>(</mo>
    <msub>
     <mi>a</mi>
     <mi>n</mi>
    </msub>
    <mo>,</mo>
    <msub>
     <mi>b</mi>
     <mi>n</mi>
    </msub>
    <mo>)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <mtext>Inv-Gamma</mtext>
    <interval closure="open">
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>a</ci>
      <ci>n</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>b</ci>
      <ci>n</ci>
     </apply>
    </interval>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \text{Inv-Gamma}\left(a_{n},b_{n}\right)
  </annotation>
 </semantics>
</math>

 distributions, with the parameters of these given by</p>

<p>

<math display="block" id="Bayesian_linear_regression:62">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <msub>
      <mi>𝚲</mi>
      <mi>n</mi>
     </msub>
     <mo>=</mo>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mrow>
        <msup>
         <mi>𝐗</mi>
         <mi mathvariant="normal">T</mi>
        </msup>
        <mi>𝐗</mi>
       </mrow>
       <mo>+</mo>
       <msub>
        <mi>𝚲</mi>
        <mn>0</mn>
       </msub>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo rspace="12.5pt">,</mo>
    <mrow>
     <msub>
      <mi>𝝁</mi>
      <mi>n</mi>
     </msub>
     <mo>=</mo>
     <mrow>
      <msup>
       <mrow>
        <mo stretchy="false">(</mo>
        <msub>
         <mi>𝚲</mi>
         <mi>n</mi>
        </msub>
        <mo stretchy="false">)</mo>
       </mrow>
       <mrow>
        <mo>-</mo>
        <mn>1</mn>
       </mrow>
      </msup>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mrow>
         <msup>
          <mi>𝐗</mi>
          <mi mathvariant="normal">T</mi>
         </msup>
         <mi>𝐗</mi>
         <mover accent="true">
          <mi>𝜷</mi>
          <mo stretchy="false">^</mo>
         </mover>
        </mrow>
        <mo>+</mo>
        <mrow>
         <msub>
          <mi>𝚲</mi>
          <mn>0</mn>
         </msub>
         <msub>
          <mi>𝝁</mi>
          <mn>0</mn>
         </msub>
        </mrow>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>𝚲</ci>
      <ci>n</ci>
     </apply>
     <apply>
      <plus></plus>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>𝐗</ci>
        <ci>normal-T</ci>
       </apply>
       <ci>𝐗</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>𝚲</ci>
       <cn type="integer">0</cn>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>𝝁</ci>
      <ci>n</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>𝚲</ci>
        <ci>n</ci>
       </apply>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <apply>
       <plus></plus>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>𝐗</ci>
         <ci>normal-T</ci>
        </apply>
        <ci>𝐗</ci>
        <apply>
         <ci>normal-^</ci>
         <ci>𝜷</ci>
        </apply>
       </apply>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>𝚲</ci>
         <cn type="integer">0</cn>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>𝝁</ci>
         <cn type="integer">0</cn>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \boldsymbol{\Lambda}_{n}=(\mathbf{X}^{\rm T}\mathbf{X}+\mathbf{\Lambda}_{0}),%
\quad\boldsymbol{\mu}_{n}=(\boldsymbol{\Lambda}_{n})^{-1}(\mathbf{X}^{\rm T}%
\mathbf{X}\hat{\boldsymbol{\beta}}+\boldsymbol{\Lambda}_{0}\boldsymbol{\mu}_{0%
}),
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Bayesian_linear_regression:63">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <msub>
      <mi>a</mi>
      <mi>n</mi>
     </msub>
     <mo>=</mo>
     <mrow>
      <msub>
       <mi>a</mi>
       <mn>0</mn>
      </msub>
      <mo>+</mo>
      <mfrac>
       <mi>n</mi>
       <mn>2</mn>
      </mfrac>
     </mrow>
    </mrow>
    <mo rspace="22.5pt">,</mo>
    <mrow>
     <msub>
      <mi>b</mi>
      <mi>n</mi>
     </msub>
     <mo>=</mo>
     <mrow>
      <msub>
       <mi>b</mi>
       <mn>0</mn>
      </msub>
      <mo>+</mo>
      <mrow>
       <mfrac>
        <mn>1</mn>
        <mn>2</mn>
       </mfrac>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mrow>
          <mrow>
           <msup>
            <mi>𝐲</mi>
            <mi mathvariant="normal">T</mi>
           </msup>
           <mi>𝐲</mi>
          </mrow>
          <mo>+</mo>
          <mrow>
           <msubsup>
            <mi>𝝁</mi>
            <mn>0</mn>
            <mi mathvariant="normal">T</mi>
           </msubsup>
           <msub>
            <mi>𝚲</mi>
            <mn>0</mn>
           </msub>
           <msub>
            <mi>𝝁</mi>
            <mn>0</mn>
           </msub>
          </mrow>
         </mrow>
         <mo>-</mo>
         <mrow>
          <msubsup>
           <mi>𝝁</mi>
           <mi>n</mi>
           <mi mathvariant="normal">T</mi>
          </msubsup>
          <msub>
           <mi>𝚲</mi>
           <mi>n</mi>
          </msub>
          <msub>
           <mi>𝝁</mi>
           <mi>n</mi>
          </msub>
         </mrow>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>a</ci>
      <ci>n</ci>
     </apply>
     <apply>
      <plus></plus>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>a</ci>
       <cn type="integer">0</cn>
      </apply>
      <apply>
       <divide></divide>
       <ci>n</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>b</ci>
      <ci>n</ci>
     </apply>
     <apply>
      <plus></plus>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>b</ci>
       <cn type="integer">0</cn>
      </apply>
      <apply>
       <times></times>
       <apply>
        <divide></divide>
        <cn type="integer">1</cn>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <minus></minus>
        <apply>
         <plus></plus>
         <apply>
          <times></times>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <ci>𝐲</ci>
           <ci>normal-T</ci>
          </apply>
          <ci>𝐲</ci>
         </apply>
         <apply>
          <times></times>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <ci>𝝁</ci>
            <cn type="integer">0</cn>
           </apply>
           <ci>normal-T</ci>
          </apply>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>𝚲</ci>
           <cn type="integer">0</cn>
          </apply>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>𝝁</ci>
           <cn type="integer">0</cn>
          </apply>
         </apply>
        </apply>
        <apply>
         <times></times>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>𝝁</ci>
           <ci>n</ci>
          </apply>
          <ci>normal-T</ci>
         </apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>𝚲</ci>
          <ci>n</ci>
         </apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>𝝁</ci>
          <ci>n</ci>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a_{n}=a_{0}+\frac{n}{2},\qquad b_{n}=b_{0}+\frac{1}{2}(\mathbf{y}^{\rm T}%
\mathbf{y}+\boldsymbol{\mu}_{0}^{\rm T}\boldsymbol{\Lambda}_{0}\boldsymbol{\mu%
}_{0}-\boldsymbol{\mu}_{n}^{\rm T}\boldsymbol{\Lambda}_{n}\boldsymbol{\mu}_{n}).
  </annotation>
 </semantics>
</math>

</p>

<p>This can be interpreted as Bayesian learning where the parameters are updated according to the following equations.</p>

<p>

<math display="block" id="Bayesian_linear_regression:64">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>𝝁</mi>
     <mi>n</mi>
    </msub>
    <mo>=</mo>
    <mrow>
     <msup>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mrow>
         <msup>
          <mi>𝐗</mi>
          <mi mathvariant="normal">T</mi>
         </msup>
         <mi>𝐗</mi>
        </mrow>
        <mo>+</mo>
        <msub>
         <mi>𝚲</mi>
         <mn>0</mn>
        </msub>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
      <mrow>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
     </msup>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mrow>
        <msub>
         <mi>𝚲</mi>
         <mn>0</mn>
        </msub>
        <msub>
         <mi>𝝁</mi>
         <mn>0</mn>
        </msub>
       </mrow>
       <mo>+</mo>
       <mrow>
        <msup>
         <mi>𝐗</mi>
         <mi mathvariant="normal">T</mi>
        </msup>
        <mi>𝐗</mi>
        <mover accent="true">
         <mi>𝜷</mi>
         <mo stretchy="false">^</mo>
        </mover>
       </mrow>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <msup>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mrow>
         <msup>
          <mi>𝐗</mi>
          <mi mathvariant="normal">T</mi>
         </msup>
         <mi>𝐗</mi>
        </mrow>
        <mo>+</mo>
        <msub>
         <mi>𝚲</mi>
         <mn>0</mn>
        </msub>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
      <mrow>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
     </msup>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mrow>
        <msub>
         <mi>𝚲</mi>
         <mn>0</mn>
        </msub>
        <msub>
         <mi>𝝁</mi>
         <mn>0</mn>
        </msub>
       </mrow>
       <mo>+</mo>
       <mrow>
        <msup>
         <mi>𝐗</mi>
         <mi mathvariant="normal">T</mi>
        </msup>
        <mi>𝐲</mi>
       </mrow>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>𝝁</ci>
      <ci>n</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <plus></plus>
        <apply>
         <times></times>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>𝐗</ci>
          <ci>normal-T</ci>
         </apply>
         <ci>𝐗</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>𝚲</ci>
         <cn type="integer">0</cn>
        </apply>
       </apply>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <apply>
       <plus></plus>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>𝚲</ci>
         <cn type="integer">0</cn>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>𝝁</ci>
         <cn type="integer">0</cn>
        </apply>
       </apply>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>𝐗</ci>
         <ci>normal-T</ci>
        </apply>
        <ci>𝐗</ci>
        <apply>
         <ci>normal-^</ci>
         <ci>𝜷</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <plus></plus>
        <apply>
         <times></times>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>𝐗</ci>
          <ci>normal-T</ci>
         </apply>
         <ci>𝐗</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>𝚲</ci>
         <cn type="integer">0</cn>
        </apply>
       </apply>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <apply>
       <plus></plus>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>𝚲</ci>
         <cn type="integer">0</cn>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>𝝁</ci>
         <cn type="integer">0</cn>
        </apply>
       </apply>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>𝐗</ci>
         <ci>normal-T</ci>
        </apply>
        <ci>𝐲</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \boldsymbol{\mu}_{n}=(\mathbf{X}^{\rm T}\mathbf{X}+\boldsymbol{\Lambda}_{0})^{%
-1}(\boldsymbol{\Lambda}_{0}\boldsymbol{\mu}_{0}+\mathbf{X}^{\rm T}\mathbf{X}%
\hat{\boldsymbol{\beta}})=(\mathbf{X}^{\rm T}\mathbf{X}+\boldsymbol{\Lambda}_{%
0})^{-1}(\boldsymbol{\Lambda}_{0}\boldsymbol{\mu}_{0}+\mathbf{X}^{\rm T}%
\mathbf{y}),
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Bayesian_linear_regression:65">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>𝚲</mi>
     <mi>n</mi>
    </msub>
    <mo>=</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mrow>
       <msup>
        <mi>𝐗</mi>
        <mi mathvariant="normal">T</mi>
       </msup>
       <mi>𝐗</mi>
      </mrow>
      <mo>+</mo>
      <msub>
       <mi>𝚲</mi>
       <mn>0</mn>
      </msub>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>𝚲</ci>
     <ci>n</ci>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>𝐗</ci>
       <ci>normal-T</ci>
      </apply>
      <ci>𝐗</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>𝚲</ci>
      <cn type="integer">0</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \boldsymbol{\Lambda}_{n}=(\mathbf{X}^{\rm T}\mathbf{X}+\boldsymbol{\Lambda}_{0%
}),
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Bayesian_linear_regression:66">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>a</mi>
     <mi>n</mi>
    </msub>
    <mo>=</mo>
    <mrow>
     <msub>
      <mi>a</mi>
      <mn>0</mn>
     </msub>
     <mo>+</mo>
     <mfrac>
      <mi>n</mi>
      <mn>2</mn>
     </mfrac>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>a</ci>
     <ci>n</ci>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>a</ci>
      <cn type="integer">0</cn>
     </apply>
     <apply>
      <divide></divide>
      <ci>n</ci>
      <cn type="integer">2</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a_{n}=a_{0}+\frac{n}{2},
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Bayesian_linear_regression:67">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>b</mi>
     <mi>n</mi>
    </msub>
    <mo>=</mo>
    <mrow>
     <msub>
      <mi>b</mi>
      <mn>0</mn>
     </msub>
     <mo>+</mo>
     <mrow>
      <mfrac>
       <mn>1</mn>
       <mn>2</mn>
      </mfrac>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mrow>
         <mrow>
          <msup>
           <mi>𝐲</mi>
           <mi mathvariant="normal">T</mi>
          </msup>
          <mi>𝐲</mi>
         </mrow>
         <mo>+</mo>
         <mrow>
          <msubsup>
           <mi>𝝁</mi>
           <mn>0</mn>
           <mi mathvariant="normal">T</mi>
          </msubsup>
          <msub>
           <mi>𝚲</mi>
           <mn>0</mn>
          </msub>
          <msub>
           <mi>𝝁</mi>
           <mn>0</mn>
          </msub>
         </mrow>
        </mrow>
        <mo>-</mo>
        <mrow>
         <msubsup>
          <mi>𝝁</mi>
          <mi>n</mi>
          <mi mathvariant="normal">T</mi>
         </msubsup>
         <msub>
          <mi>𝚲</mi>
          <mi>n</mi>
         </msub>
         <msub>
          <mi>𝝁</mi>
          <mi>n</mi>
         </msub>
        </mrow>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>b</ci>
     <ci>n</ci>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>b</ci>
      <cn type="integer">0</cn>
     </apply>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <minus></minus>
       <apply>
        <plus></plus>
        <apply>
         <times></times>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>𝐲</ci>
          <ci>normal-T</ci>
         </apply>
         <ci>𝐲</ci>
        </apply>
        <apply>
         <times></times>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>𝝁</ci>
           <cn type="integer">0</cn>
          </apply>
          <ci>normal-T</ci>
         </apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>𝚲</ci>
          <cn type="integer">0</cn>
         </apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>𝝁</ci>
          <cn type="integer">0</cn>
         </apply>
        </apply>
       </apply>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>𝝁</ci>
          <ci>n</ci>
         </apply>
         <ci>normal-T</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>𝚲</ci>
         <ci>n</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>𝝁</ci>
         <ci>n</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   b_{n}=b_{0}+\frac{1}{2}(\mathbf{y}^{\rm T}\mathbf{y}+\boldsymbol{\mu}_{0}^{\rm
T%
}\boldsymbol{\Lambda}_{0}\boldsymbol{\mu}_{0}-\boldsymbol{\mu}_{n}^{\rm T}%
\boldsymbol{\Lambda}_{n}\boldsymbol{\mu}_{n}).
  </annotation>
 </semantics>
</math>

</p>
<h3 id="model-evidence">Model evidence</h3>

<p>The <a href="model_evidence" title="wikilink">model evidence</a> 

<math display="inline" id="Bayesian_linear_regression:68">
 <semantics>
  <mrow>
   <mi>p</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>𝐲</mi>
    <mo stretchy="false">|</mo>
    <mi>m</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">p</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">y</csymbol>
     <ci>normal-|</ci>
     <csymbol cd="unknown">m</csymbol>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p(\mathbf{y}|m)
  </annotation>
 </semantics>
</math>

 is the probability of the data given the model 

<math display="inline" id="Bayesian_linear_regression:69">
 <semantics>
  <mi>m</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>m</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   m
  </annotation>
 </semantics>
</math>

. It is also known as the <a href="marginal_likelihood" title="wikilink">marginal likelihood</a>, and as the prior predictive density. Here, the model is defined by the likelihood function 

<math display="inline" id="Bayesian_linear_regression:70">
 <semantics>
  <mrow>
   <mi>p</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>𝐲</mi>
    <mo stretchy="false">|</mo>
    <mi>𝐗</mi>
    <mo>,</mo>
    <mi>𝜷</mi>
    <mo>,</mo>
    <mi>σ</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">p</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">y</csymbol>
     <ci>normal-|</ci>
     <csymbol cd="unknown">X</csymbol>
     <ci>normal-,</ci>
     <csymbol cd="unknown">β</csymbol>
     <ci>normal-,</ci>
     <csymbol cd="unknown">σ</csymbol>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p(\mathbf{y}|\mathbf{X},\boldsymbol{\beta},\sigma)
  </annotation>
 </semantics>
</math>

 and the prior distribution on the parameters, i.e. 

<math display="inline" id="Bayesian_linear_regression:71">
 <semantics>
  <mrow>
   <mi>p</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>𝜷</mi>
    <mo>,</mo>
    <mi>σ</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>p</ci>
    <interval closure="open">
     <ci>𝜷</ci>
     <ci>σ</ci>
    </interval>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p(\boldsymbol{\beta},\sigma)
  </annotation>
 </semantics>
</math>

. The model evidence captures in a single number how well such a model explains the observations. The model evidence of the Bayesian linear regression model presented in this section can be used to compare competing linear models by <a href="Bayesian_model_comparison" title="wikilink">Bayesian model comparison</a>. These models may differ in the number and values of the predictor variables as well as in their priors on the model parameters. Model complexity is already taken into account by the model evidence, because it marginalizes out the parameters by integrating 

<math display="inline" id="Bayesian_linear_regression:72">
 <semantics>
  <mrow>
   <mi>p</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>𝐲</mi>
    <mo>,</mo>
    <mi>𝜷</mi>
    <mo>,</mo>
    <mi>σ</mi>
    <mo stretchy="false">|</mo>
    <mi>𝐗</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">p</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">y</csymbol>
     <ci>normal-,</ci>
     <csymbol cd="unknown">β</csymbol>
     <ci>normal-,</ci>
     <csymbol cd="unknown">σ</csymbol>
     <ci>normal-|</ci>
     <csymbol cd="unknown">X</csymbol>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p(\mathbf{y},\boldsymbol{\beta},\sigma|\mathbf{X})
  </annotation>
 </semantics>
</math>

 over all possible values of 

<math display="inline" id="Bayesian_linear_regression:73">
 <semantics>
  <mi>𝜷</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>𝜷</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \boldsymbol{\beta}
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Bayesian_linear_regression:74">
 <semantics>
  <mi>σ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>σ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \sigma
  </annotation>
 </semantics>
</math>

.</p>

<p>

<math display="block" id="Bayesian_linear_regression:75">
 <semantics>
  <mrow>
   <mi>p</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>𝐲</mi>
    <mo stretchy="false">|</mo>
    <mi>m</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>=</mo>
   <mo largeop="true" symmetric="true">∫</mo>
   <mi>p</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>𝐲</mi>
    <mo stretchy="false">|</mo>
    <mi>𝐗</mi>
    <mo>,</mo>
    <mi>𝜷</mi>
    <mo>,</mo>
    <mi>σ</mi>
    <mo rspace="4.2pt" stretchy="false">)</mo>
   </mrow>
   <mi>p</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>𝜷</mi>
    <mo>,</mo>
    <mi>σ</mi>
    <mo rspace="4.2pt" stretchy="false">)</mo>
   </mrow>
   <mi>d</mi>
   <mpadded width="+1.7pt">
    <mi>𝜷</mi>
   </mpadded>
   <mi>d</mi>
   <mi>σ</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">p</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">y</csymbol>
     <ci>normal-|</ci>
     <csymbol cd="unknown">m</csymbol>
     <ci>normal-)</ci>
    </cerror>
    <eq></eq>
    <int></int>
    <csymbol cd="unknown">p</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">y</csymbol>
     <ci>normal-|</ci>
     <csymbol cd="unknown">X</csymbol>
     <ci>normal-,</ci>
     <csymbol cd="unknown">β</csymbol>
     <ci>normal-,</ci>
     <csymbol cd="unknown">σ</csymbol>
     <ci>normal-)</ci>
    </cerror>
    <csymbol cd="unknown">p</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">β</csymbol>
     <ci>normal-,</ci>
     <csymbol cd="unknown">σ</csymbol>
     <ci>normal-)</ci>
    </cerror>
    <csymbol cd="unknown">d</csymbol>
    <csymbol cd="unknown">β</csymbol>
    <csymbol cd="unknown">d</csymbol>
    <csymbol cd="unknown">σ</csymbol>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p(\mathbf{y}|m)=\int p(\mathbf{y}|\mathbf{X},\boldsymbol{\beta},\sigma)\,p(%
\boldsymbol{\beta},\sigma)\,d\boldsymbol{\beta}\,d\sigma
  </annotation>
 </semantics>
</math>

 This integral can be computed analytically and the solution is given in the following equation.<a class="footnoteRef" href="#fn3" id="fnref3"><sup>3</sup></a></p>

<p>

<math display="block" id="Bayesian_linear_regression:76">
 <semantics>
  <mrow>
   <mi>p</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>𝐲</mi>
    <mo stretchy="false">|</mo>
    <mi>m</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>=</mo>
   <mfrac>
    <mn>1</mn>
    <msup>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mn>2</mn>
       <mi>π</mi>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <mrow>
      <mi>n</mi>
      <mo>/</mo>
      <mn>2</mn>
     </mrow>
    </msup>
   </mfrac>
   <msqrt>
    <mfrac>
     <mrow>
      <mo>det</mo>
      <mrow>
       <mo stretchy="false">(</mo>
       <msub>
        <mi>𝚲</mi>
        <mn>0</mn>
       </msub>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mrow>
      <mo>det</mo>
      <mrow>
       <mo stretchy="false">(</mo>
       <msub>
        <mi>𝚲</mi>
        <mi>n</mi>
       </msub>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mfrac>
   </msqrt>
   <mo>⋅</mo>
   <mfrac>
    <msubsup>
     <mi>b</mi>
     <mn>0</mn>
     <msub>
      <mi>a</mi>
      <mn>0</mn>
     </msub>
    </msubsup>
    <msubsup>
     <mi>b</mi>
     <mi>n</mi>
     <msub>
      <mi>a</mi>
      <mi>n</mi>
     </msub>
    </msubsup>
   </mfrac>
   <mo>⋅</mo>
   <mfrac>
    <mrow>
     <mi mathvariant="normal">Γ</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <msub>
       <mi>a</mi>
       <mi>n</mi>
      </msub>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mrow>
     <mi mathvariant="normal">Γ</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <msub>
       <mi>a</mi>
       <mn>0</mn>
      </msub>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mfrac>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">p</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">y</csymbol>
     <ci>normal-|</ci>
     <csymbol cd="unknown">m</csymbol>
     <ci>normal-)</ci>
    </cerror>
    <eq></eq>
    <apply>
     <divide></divide>
     <cn type="integer">1</cn>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <times></times>
       <cn type="integer">2</cn>
       <ci>π</ci>
      </apply>
      <apply>
       <divide></divide>
       <ci>n</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
    <apply>
     <root></root>
     <apply>
      <divide></divide>
      <apply>
       <determinant></determinant>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>𝚲</ci>
        <cn type="integer">0</cn>
       </apply>
      </apply>
      <apply>
       <determinant></determinant>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>𝚲</ci>
        <ci>n</ci>
       </apply>
      </apply>
     </apply>
    </apply>
    <ci>normal-⋅</ci>
    <apply>
     <divide></divide>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>b</ci>
       <cn type="integer">0</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>a</ci>
       <cn type="integer">0</cn>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>b</ci>
       <ci>n</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>a</ci>
       <ci>n</ci>
      </apply>
     </apply>
    </apply>
    <ci>normal-⋅</ci>
    <apply>
     <divide></divide>
     <apply>
      <times></times>
      <ci>normal-Γ</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>a</ci>
       <ci>n</ci>
      </apply>
     </apply>
     <apply>
      <times></times>
      <ci>normal-Γ</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>a</ci>
       <cn type="integer">0</cn>
      </apply>
     </apply>
    </apply>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p(\mathbf{y}|m)=\frac{1}{(2\pi)^{n/2}}\sqrt{\frac{\det(\boldsymbol{\Lambda}_{0%
})}{\det(\boldsymbol{\Lambda}_{n})}}\cdot\frac{b_{0}^{a_{0}}}{b_{n}^{a_{n}}}%
\cdot\frac{\Gamma(a_{n})}{\Gamma(a_{0})}
  </annotation>
 </semantics>
</math>

</p>

<p>Here 

<math display="inline" id="Bayesian_linear_regression:77">
 <semantics>
  <mi mathvariant="normal">Γ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>normal-Γ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Gamma
  </annotation>
 </semantics>
</math>

 denotes the <a href="gamma_function" title="wikilink">gamma function</a>. Because we have chosen a conjugate prior, the marginal likelihood can also be easily computed by evaluating the following equality for arbitrary values of 

<math display="inline" id="Bayesian_linear_regression:78">
 <semantics>
  <mi>𝜷</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>𝜷</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \boldsymbol{\beta}
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Bayesian_linear_regression:79">
 <semantics>
  <mi>σ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>σ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \sigma
  </annotation>
 </semantics>
</math>

.</p>

<p>

<math display="block" id="Bayesian_linear_regression:80">
 <semantics>
  <mrow>
   <mi>p</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>𝐲</mi>
    <mo stretchy="false">|</mo>
    <mi>m</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>=</mo>
   <mfrac>
    <mrow>
     <mi>p</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>𝜷</mi>
      <mo>,</mo>
      <mi>σ</mi>
      <mo stretchy="false">|</mo>
      <mi>m</mi>
      <mo rspace="4.2pt" stretchy="false">)</mo>
     </mrow>
     <mi>p</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>𝐲</mi>
      <mo stretchy="false">|</mo>
      <mi>𝐗</mi>
      <mo>,</mo>
      <mi>𝜷</mi>
      <mo>,</mo>
      <mi>σ</mi>
      <mo>,</mo>
      <mi>m</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mrow>
     <mi>p</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>𝜷</mi>
      <mo>,</mo>
      <mi>σ</mi>
      <mo stretchy="false">|</mo>
      <mi>𝐲</mi>
      <mo>,</mo>
      <mi>𝐗</mi>
      <mo>,</mo>
      <mi>m</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mfrac>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">p</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">y</csymbol>
     <ci>normal-|</ci>
     <csymbol cd="unknown">m</csymbol>
     <ci>normal-)</ci>
    </cerror>
    <eq></eq>
    <apply>
     <divide></divide>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <csymbol cd="unknown">p</csymbol>
      <cerror>
       <csymbol cd="ambiguous">fragments</csymbol>
       <ci>normal-(</ci>
       <csymbol cd="unknown">β</csymbol>
       <ci>normal-,</ci>
       <csymbol cd="unknown">σ</csymbol>
       <ci>normal-|</ci>
       <csymbol cd="unknown">m</csymbol>
       <ci>normal-)</ci>
      </cerror>
      <csymbol cd="unknown">p</csymbol>
      <cerror>
       <csymbol cd="ambiguous">fragments</csymbol>
       <ci>normal-(</ci>
       <csymbol cd="unknown">y</csymbol>
       <ci>normal-|</ci>
       <csymbol cd="unknown">X</csymbol>
       <ci>normal-,</ci>
       <csymbol cd="unknown">β</csymbol>
       <ci>normal-,</ci>
       <csymbol cd="unknown">σ</csymbol>
       <ci>normal-,</ci>
       <csymbol cd="unknown">m</csymbol>
       <ci>normal-)</ci>
      </cerror>
     </cerror>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <csymbol cd="unknown">p</csymbol>
      <cerror>
       <csymbol cd="ambiguous">fragments</csymbol>
       <ci>normal-(</ci>
       <csymbol cd="unknown">β</csymbol>
       <ci>normal-,</ci>
       <csymbol cd="unknown">σ</csymbol>
       <ci>normal-|</ci>
       <csymbol cd="unknown">y</csymbol>
       <ci>normal-,</ci>
       <csymbol cd="unknown">X</csymbol>
       <ci>normal-,</ci>
       <csymbol cd="unknown">m</csymbol>
       <ci>normal-)</ci>
      </cerror>
     </cerror>
    </apply>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p(\mathbf{y}|m)=\frac{p(\boldsymbol{\beta},\sigma|m)\,p(\mathbf{y}|\mathbf{X},%
\boldsymbol{\beta},\sigma,m)}{p(\boldsymbol{\beta},\sigma|\mathbf{y},\mathbf{X%
},m)}
  </annotation>
 </semantics>
</math>

 Note that this equation is nothing but a re-arrangement of <a href="Bayes_theorem" title="wikilink">Bayes theorem</a>. Inserting the formulas for the prior, the likelihood, and the posterior and simplifying the resulting expression leads to the analytic expression given above.</p>
<h2 id="other-cases">Other cases</h2>

<p>In general, it may be impossible or impractical to derive the posterior distribution analytically. However, it is possible to approximate the posterior by an <a href="approximate_Bayesian_computation" title="wikilink">approximate Bayesian inference</a> method such as <a href="Monte_Carlo_sampling" title="wikilink">Monte Carlo sampling</a><a class="footnoteRef" href="#fn4" id="fnref4"><sup>4</sup></a> or <a href="variational_Bayes" title="wikilink">variational Bayes</a>.</p>

<p>The special case 

<math display="inline" id="Bayesian_linear_regression:81">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>𝝁</mi>
     <mn>0</mn>
    </msub>
    <mo>=</mo>
    <mn>0</mn>
   </mrow>
   <mo>,</mo>
   <mrow>
    <msub>
     <mi>𝚲</mi>
     <mn>0</mn>
    </msub>
    <mo>=</mo>
    <mrow>
     <mi>c</mi>
     <mi>𝐈</mi>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>𝝁</ci>
      <cn type="integer">0</cn>
     </apply>
     <cn type="integer">0</cn>
    </apply>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>𝚲</ci>
      <cn type="integer">0</cn>
     </apply>
     <apply>
      <times></times>
      <ci>c</ci>
      <ci>𝐈</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \boldsymbol{\mu}_{0}=0,\mathbf{\Lambda}_{0}=c\mathbf{I}
  </annotation>
 </semantics>
</math>

 is called <a href="ridge_regression" title="wikilink">ridge regression</a>.</p>

<p>A similar analysis can be performed for the general case of the multivariate regression and part of this provides for Bayesian <a href="estimation_of_covariance_matrices" title="wikilink">estimation of covariance matrices</a>: see <a href="Bayesian_multivariate_linear_regression" title="wikilink">Bayesian multivariate linear regression</a>.</p>
<h2 id="see-also">See also</h2>
<ul>
<li><a href="Bayes_linear_statistics" title="wikilink">Bayes linear statistics</a></li>
<li><a href="Tikhonov_regularization" title="wikilink">Tikhonov regularization</a></li>
</ul>
<h2 id="notes">Notes</h2>
<references>
</references>
<h2 id="references">References</h2>
<ul>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
<li>Thomas P. Minka (2001) <a href="http://research.microsoft.com/~minka/papers/linear.html"><em>Bayesian Linear Regression</em></a>, Microsoft research web page</li>
</ul>
<h2 id="external-links">External links</h2>
<ul>
<li><a href="b:en:R_Programming/Linear_Models#Bayesian_estimation" title="wikilink">Bayesian estimation of linear models (R programming wikibook)</a>. Bayesian linear regression as implemented in <a href="R_(programming_language)" title="wikilink">R</a>.</li>
</ul>

<p>"</p>

<p><a href="Category:Bayesian_inference" title="wikilink">Linear regression</a> <a href="Category:Regression_analysis" title="wikilink">Category:Regression analysis</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1">The intermediate steps of this computation can be found in O'Hagan (1994) at the beginning of the chapter on Linear models.<a href="#fnref1">↩</a></li>
<li id="fn2">The intermediate steps are in Fahrmeir et al. (2009) on page 188.<a href="#fnref2">↩</a></li>
<li id="fn3">The intermediate steps of this computation can be found in O'Hagan (1994) on page 257.<a href="#fnref3">↩</a></li>
<li id="fn4">Carlin and Louis(2008) and Gelman, et al. (2003) explain how to use sampling methods for Bayesian linear regression.<a href="#fnref4">↩</a></li>
</ol>
</section>
</body>
</html>

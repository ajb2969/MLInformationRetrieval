<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="1633">Financial correlation</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Financial correlation</h1>
<hr/>

<p><strong>Financial correlations</strong> measure the relationship between the changes of two or more financial variables in time. For example, the prices of <a href="equity_(finance)" title="wikilink">equity stocks</a> and fixed interest bonds often move in opposite directions: when investors sell stocks, they often use the proceeds to buy bonds and vice versa. In this case, stocks and bonds are negatively correlated. Financial correlations play a key role in modern finance. Under the <a href="capital_asset_pricing_model" title="wikilink">capital asset pricing model</a>, CAPM (a model recognised by a Nobel prize), an increase in diversification increases the return/risk ratio. Diversification is synonymous with inverse correlation: the lower the correlation between the constituent holdings, (preferably negative), the lower the risk of holding the combined portfolio. Measures of risk include <a href="value_at_risk" title="wikilink">value at risk</a> VAR, <a href="expected_shortfall" title="wikilink">expected shortfall</a> ES, and <a href="enterprise_risk_management" title="wikilink">enterprise risk management</a> ERM.</p>
<h2 id="financial-correlation-and-the-pearson-product-moment-correlation-coefficient">Financial correlation and the Pearson product-moment correlation coefficient</h2>

<p>There are several statistical measures of the degree of financial correlations. The <a href="Pearson_product-moment_correlation_coefficient" title="wikilink">Pearson product-moment correlation coefficient</a> is sometimes applied to finance correlations. However, the limitations of Pearson correlation approach in finance are evident. First, linear dependencies as assessed by the Pearson correlation coefficient do not appear often in finance. Second, linear correlation measures are only natural dependence measures if the joint distribution of the variables is elliptical. However, only few financial distributions such as the multivariate normal distribution and the multivariate student-t distribution are special cases of elliptical distributions, for which linear correlation measure can be meaningfully interpreted. Third, a zero Pearson product-moment correlation coefficient does not necessarily mean independence, because only the two first moments are considered. For example, 

<math display="inline" id="Financial_correlation:0">
 <semantics>
  <mrow>
   <mi>Y</mi>
   <mo>=</mo>
   <msup>
    <mi>X</mi>
    <mn>2</mn>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>Y</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>X</ci>
     <cn type="integer">2</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Y=X^{2}
  </annotation>
 </semantics>
</math>

 (<em>y</em> ≠ 0) will lead to Pearson correlation coefficient of zero, which is arguably misleading.<a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a> Since the Pearson approach is unsatisfactory to model financial correlations, <a href="quantitative_analyst" title="wikilink">quantitative analysts</a>, (quants) have developed specific financial correlation measures.</p>
<h2 id="financial-correlation-measures">Financial correlation measures</h2>
<h3 id="correlation-brownian-motions">Correlation Brownian motions</h3>

<p><a href="Steven_L._Heston" title="wikilink">Steven Heston</a> applied a correlation approach<a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a> to negatively correlate stochastic stock returns 

<math display="inline" id="Financial_correlation:1">
 <semantics>
  <mfrac>
   <mrow>
    <mi>d</mi>
    <mi>S</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>t</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mrow>
    <mi>S</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>t</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mfrac>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <divide></divide>
    <apply>
     <times></times>
     <ci>d</ci>
     <ci>S</ci>
     <ci>t</ci>
    </apply>
    <apply>
     <times></times>
     <ci>S</ci>
     <ci>t</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \frac{dS(t)}{S(t)}
  </annotation>
 </semantics>
</math>

 and stochastic volatility 

<math display="inline" id="Financial_correlation:2">
 <semantics>
  <mrow>
   <mpadded lspace="5pt" width="+5pt">
    <mi>σ</mi>
   </mpadded>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>t</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>σ</ci>
    <ci>t</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \ \sigma(t)
  </annotation>
 </semantics>
</math>

. The core equations of the original <a href="Heston_model" title="wikilink">Heston model</a> are the two <a href="stochastic_differential_equations" title="wikilink">stochastic differential equations</a>, SDEs</p>

<p>

<math display="block" id="Financial_correlation:3">
 <semantics>
  <mrow>
   <mfrac>
    <mrow>
     <mi>d</mi>
     <mi>S</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>t</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mrow>
     <mi>S</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>t</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mfrac>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mpadded width="+1.7pt">
      <mi>μ</mi>
     </mpadded>
     <mi>d</mi>
     <mi>t</mi>
    </mrow>
    <mo>+</mo>
    <mrow>
     <mi>σ</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>t</mi>
      <mo rspace="4.2pt" stretchy="false">)</mo>
     </mrow>
     <mi>d</mi>
     <msub>
      <mi>z</mi>
      <mn>1</mn>
     </msub>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>t</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <divide></divide>
     <apply>
      <times></times>
      <ci>d</ci>
      <ci>S</ci>
      <ci>t</ci>
     </apply>
     <apply>
      <times></times>
      <ci>S</ci>
      <ci>t</ci>
     </apply>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <ci>μ</ci>
      <ci>d</ci>
      <ci>t</ci>
     </apply>
     <apply>
      <times></times>
      <ci>σ</ci>
      <ci>t</ci>
      <ci>d</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>z</ci>
       <cn type="integer">1</cn>
      </apply>
      <ci>t</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \frac{dS(t)}{S(t)}=\mu\,dt+\sigma(t)\,dz_{1}(t)
  </annotation>
 </semantics>
</math>

 (1)</p>

<p>and</p>

<p>

<math display="block" id="Financial_correlation:4">
 <semantics>
  <mrow>
   <mrow>
    <mi>d</mi>
    <msup>
     <mi>σ</mi>
     <mn>2</mn>
    </msup>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>t</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mi>g</mi>
     <mrow>
      <mo stretchy="false">[</mo>
      <mrow>
       <msubsup>
        <mi>σ</mi>
        <mi>L</mi>
        <mn>2</mn>
       </msubsup>
       <mo>-</mo>
       <mrow>
        <msup>
         <mi>σ</mi>
         <mn>2</mn>
        </msup>
        <mrow>
         <mo stretchy="false">(</mo>
         <mi>t</mi>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
      </mrow>
      <mo rspace="4.2pt" stretchy="false">]</mo>
     </mrow>
     <mi>d</mi>
     <mi>t</mi>
    </mrow>
    <mo>+</mo>
    <mrow>
     <mi>ξ</mi>
     <mi>σ</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>t</mi>
      <mo rspace="4.2pt" stretchy="false">)</mo>
     </mrow>
     <mi>d</mi>
     <msub>
      <mi>z</mi>
      <mn>2</mn>
     </msub>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>t</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>d</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>σ</ci>
      <cn type="integer">2</cn>
     </apply>
     <ci>t</ci>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <ci>g</ci>
      <apply>
       <csymbol cd="latexml">delimited-[]</csymbol>
       <apply>
        <minus></minus>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>σ</ci>
          <ci>L</ci>
         </apply>
         <cn type="integer">2</cn>
        </apply>
        <apply>
         <times></times>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>σ</ci>
          <cn type="integer">2</cn>
         </apply>
         <ci>t</ci>
        </apply>
       </apply>
      </apply>
      <ci>d</ci>
      <ci>t</ci>
     </apply>
     <apply>
      <times></times>
      <ci>ξ</ci>
      <ci>σ</ci>
      <ci>t</ci>
      <ci>d</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>z</ci>
       <cn type="integer">2</cn>
      </apply>
      <ci>t</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   d\sigma^{2}(t)=g[\sigma_{L}^{2}-\sigma^{2}(t)]\,dt+\xi\sigma(t)\,dz_{2}(t)
  </annotation>
 </semantics>
</math>

 (2)</p>

<p>where S is the underlying stock, 

<math display="inline" id="Financial_correlation:5">
 <semantics>
  <mpadded lspace="5pt" width="+5pt">
   <mi>μ</mi>
  </mpadded>
  <annotation-xml encoding="MathML-Content">
   <ci>μ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \ \mu
  </annotation>
 </semantics>
</math>

 is the expected growth rate of 

<math display="inline" id="Financial_correlation:6">
 <semantics>
  <mi>S</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>S</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   S
  </annotation>
 </semantics>
</math>

, and 

<math display="inline" id="Financial_correlation:7">
 <semantics>
  <mrow>
   <mpadded lspace="5pt" width="+5pt">
    <mi>σ</mi>
   </mpadded>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>t</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>σ</ci>
    <ci>t</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \ \sigma(t)
  </annotation>
 </semantics>
</math>

 is the stochastic volatility of 

<math display="inline" id="Financial_correlation:8">
 <semantics>
  <mi>S</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>S</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   S
  </annotation>
 </semantics>
</math>

 at time t. In equation (2), g is the mean reversion rate (gravity), which pulls the variance 

<math display="inline" id="Financial_correlation:9">
 <semantics>
  <mrow>
   <msup>
    <mpadded lspace="5pt" width="+5pt">
     <mi>σ</mi>
    </mpadded>
    <mn>2</mn>
   </msup>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>t</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>σ</ci>
     <cn type="integer">2</cn>
    </apply>
    <ci>t</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \ \sigma^{2}(t)
  </annotation>
 </semantics>
</math>

 to its long term mean 

<math display="inline" id="Financial_correlation:10">
 <semantics>
  <msubsup>
   <mi>σ</mi>
   <mi>L</mi>
   <mn>2</mn>
  </msubsup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>σ</ci>
     <ci>L</ci>
    </apply>
    <cn type="integer">2</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \sigma_{L}^{2}
  </annotation>
 </semantics>
</math>

, and 

<math display="inline" id="Financial_correlation:11">
 <semantics>
  <mpadded lspace="5pt" width="+5pt">
   <mi>ξ</mi>
  </mpadded>
  <annotation-xml encoding="MathML-Content">
   <ci>ξ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \ \xi
  </annotation>
 </semantics>
</math>

 is the volatility of the volatility σ(t). dz(t) is the standard <a href="Brownian_motion" title="wikilink">Brownian motion</a>, i.e. 

<math display="inline" id="Financial_correlation:12">
 <semantics>
  <mrow>
   <mrow>
    <mi>d</mi>
    <mi>z</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>t</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <msub>
     <mi>ε</mi>
     <mi>t</mi>
    </msub>
    <msqrt>
     <mrow>
      <mi>d</mi>
      <mi>t</mi>
     </mrow>
    </msqrt>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>d</ci>
     <ci>z</ci>
     <ci>t</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>ε</ci>
      <ci>t</ci>
     </apply>
     <apply>
      <root></root>
      <apply>
       <times></times>
       <ci>d</ci>
       <ci>t</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   dz(t)=\varepsilon_{t}\sqrt{dt}
  </annotation>
 </semantics>
</math>

, 

<math display="inline" id="Financial_correlation:13">
 <semantics>
  <msub>
   <mpadded lspace="5pt" width="+5pt">
    <mi>ε</mi>
   </mpadded>
   <mi>t</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>ε</ci>
    <ci>t</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \ \varepsilon_{t}
  </annotation>
 </semantics>
</math>

 is <a href="Independent_and_identically_distributed_random_variables" title="wikilink">i.i.d.</a>, in particular 

<math display="inline" id="Financial_correlation:14">
 <semantics>
  <msub>
   <mi>ε</mi>
   <mi>t</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>ε</ci>
    <ci>t</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \varepsilon_{t}
  </annotation>
 </semantics>
</math>

 is a random drawing from a standardized normal distribution n~(0,1). In equation (1), the underlying 

<math display="inline" id="Financial_correlation:15">
 <semantics>
  <mi>S</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>S</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   S
  </annotation>
 </semantics>
</math>

 follows the standard geometric Brownian motion, which is also applied in <a href="Black–Scholes_model" title="wikilink">Black–Scholes–Merton model</a>, which however assumes constant volatility. The correlation between the stochastic processes (1) and (2) is introduced by correlating the two Brownian motions 

<math display="inline" id="Financial_correlation:16">
 <semantics>
  <mrow>
   <mi>d</mi>
   <msub>
    <mi>z</mi>
    <mn>1</mn>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>d</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>z</ci>
     <cn type="integer">1</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   dz_{1}
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Financial_correlation:17">
 <semantics>
  <mrow>
   <mi>d</mi>
   <msub>
    <mi>z</mi>
    <mn>2</mn>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>d</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>z</ci>
     <cn type="integer">2</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   dz_{2}
  </annotation>
 </semantics>
</math>

. The instantaneous correlation 

<math display="inline" id="Financial_correlation:18">
 <semantics>
  <mpadded lspace="5pt" width="+5pt">
   <mi>ρ</mi>
  </mpadded>
  <annotation-xml encoding="MathML-Content">
   <ci>ρ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \ \rho
  </annotation>
 </semantics>
</math>

 between the Brownian motions is</p>

<p>

<math display="block" id="Financial_correlation:19">
 <semantics>
  <mrow>
   <mrow>
    <mo>Corr</mo>
    <mrow>
     <mo stretchy="false">[</mo>
     <mrow>
      <mi>d</mi>
      <msub>
       <mi>z</mi>
       <mn>1</mn>
      </msub>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>t</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo>,</mo>
     <mrow>
      <mi>d</mi>
      <msub>
       <mi>z</mi>
       <mn>2</mn>
      </msub>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>t</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo stretchy="false">]</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mpadded width="+1.7pt">
     <mi>ρ</mi>
    </mpadded>
    <mi>d</mi>
    <mi>t</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <ci>Corr</ci>
     <apply>
      <times></times>
      <ci>d</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>z</ci>
       <cn type="integer">1</cn>
      </apply>
      <ci>t</ci>
     </apply>
     <apply>
      <times></times>
      <ci>d</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>z</ci>
       <cn type="integer">2</cn>
      </apply>
      <ci>t</ci>
     </apply>
    </apply>
    <apply>
     <times></times>
     <ci>ρ</ci>
     <ci>d</ci>
     <ci>t</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \operatorname{Corr}[dz_{1}(t),dz_{2}(t)]=\rho\,dt
  </annotation>
 </semantics>
</math>

 (3).</p>

<p>The definition (3) can be conveniently modeled with the identity</p>

<p>

<math display="block" id="Financial_correlation:20">
 <semantics>
  <mrow>
   <mrow>
    <mi>d</mi>
    <msub>
     <mi>z</mi>
     <mn>1</mn>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>t</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <msqrt>
      <mi>ρ</mi>
     </msqrt>
     <mi>d</mi>
     <msub>
      <mi>z</mi>
      <mn>2</mn>
     </msub>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>t</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>+</mo>
    <mrow>
     <mpadded width="+1.7pt">
      <msqrt>
       <mrow>
        <mn>1</mn>
        <mo>-</mo>
        <mi>ρ</mi>
       </mrow>
      </msqrt>
     </mpadded>
     <mi>d</mi>
     <msub>
      <mi>z</mi>
      <mn>3</mn>
     </msub>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>t</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>d</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>z</ci>
      <cn type="integer">1</cn>
     </apply>
     <ci>t</ci>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <apply>
       <root></root>
       <ci>ρ</ci>
      </apply>
      <ci>d</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>z</ci>
       <cn type="integer">2</cn>
      </apply>
      <ci>t</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <root></root>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
        <ci>ρ</ci>
       </apply>
      </apply>
      <ci>d</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>z</ci>
       <cn type="integer">3</cn>
      </apply>
      <ci>t</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   dz_{1}(t)=\sqrt{\rho}dz_{2}(t)+\sqrt{1-\rho}\,dz_{3}(t)
  </annotation>
 </semantics>
</math>

 (4)</p>

<p>where 

<math display="inline" id="Financial_correlation:21">
 <semantics>
  <mrow>
   <mi>d</mi>
   <msub>
    <mi>z</mi>
    <mn>2</mn>
   </msub>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>t</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>d</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>z</ci>
     <cn type="integer">2</cn>
    </apply>
    <ci>t</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   dz_{2}(t)
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Financial_correlation:22">
 <semantics>
  <mrow>
   <mi>d</mi>
   <msub>
    <mi>z</mi>
    <mn>3</mn>
   </msub>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>t</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>d</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>z</ci>
     <cn type="integer">3</cn>
    </apply>
    <ci>t</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   dz_{3}(t)
  </annotation>
 </semantics>
</math>

 are independent, and 

<math display="inline" id="Financial_correlation:23">
 <semantics>
  <mrow>
   <mi>d</mi>
   <mi>z</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>t</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>d</ci>
    <ci>z</ci>
    <ci>t</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   dz(t)
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Financial_correlation:24">
 <semantics>
  <mrow>
   <mi>d</mi>
   <mi>z</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msup>
     <mi>t</mi>
     <mo>′</mo>
    </msup>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>d</ci>
    <ci>z</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>t</ci>
     <ci>normal-′</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   dz(t^{\prime})
  </annotation>
 </semantics>
</math>

 are independent, t ≠ t’.</p>

<p>The Cointelation SDE<a class="footnoteRef" href="#fn3" id="fnref3"><sup>3</sup></a> connects the SDE's above to the concept of mean reversion and drift which are usually concepts that are misunderstood<a class="footnoteRef" href="#fn4" id="fnref4"><sup>4</sup></a> by practitioners.</p>
<h3 id="the-binomial-correlation-coefficient">The binomial correlation coefficient</h3>

<p>A further financial correlation measure,  is the binomial correlation approach of Lucas (1995).<a class="footnoteRef" href="#fn5" id="fnref5"><sup>5</sup></a> We define the binomial events 

<math display="inline" id="Financial_correlation:25">
 <semantics>
  <mrow>
   <msub>
    <mn>1</mn>
    <mi>X</mi>
   </msub>
   <mo>=</mo>
   <msub>
    <mn>1</mn>
    <mrow>
     <mo stretchy="false">{</mo>
     <msub>
      <mi>τ</mi>
      <mi>X</mi>
     </msub>
     <mo>≤</mo>
     <mi>T</mi>
     <mo stretchy="false">}</mo>
    </mrow>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <cn type="integer">1</cn>
     <ci>X</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <cn type="integer">1</cn>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <ci>normal-{</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>τ</ci>
       <ci>X</ci>
      </apply>
      <leq></leq>
      <csymbol cd="unknown">T</csymbol>
      <ci>normal-}</ci>
     </cerror>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   1_{X}=1_{\{\tau_{X}\leq T\}}
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Financial_correlation:26">
 <semantics>
  <mrow>
   <msub>
    <mn>1</mn>
    <mi>Y</mi>
   </msub>
   <mo>=</mo>
   <msub>
    <mn>1</mn>
    <mrow>
     <mo stretchy="false">{</mo>
     <msub>
      <mi>τ</mi>
      <mi>Y</mi>
     </msub>
     <mo>≤</mo>
     <mi>T</mi>
     <mo stretchy="false">}</mo>
    </mrow>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <cn type="integer">1</cn>
     <ci>Y</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <cn type="integer">1</cn>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <ci>normal-{</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>τ</ci>
       <ci>Y</ci>
      </apply>
      <leq></leq>
      <csymbol cd="unknown">T</csymbol>
      <ci>normal-}</ci>
     </cerror>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   1_{Y}=1_{\{\tau_{Y}\leq T\}}
  </annotation>
 </semantics>
</math>

 where 

<math display="inline" id="Financial_correlation:27">
 <semantics>
  <msub>
   <mi>τ</mi>
   <mi>X</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>τ</ci>
    <ci>X</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \tau_{X}
  </annotation>
 </semantics>
</math>

 is the default time of entity 

<math display="inline" id="Financial_correlation:28">
 <semantics>
  <mi>X</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>X</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   X
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Financial_correlation:29">
 <semantics>
  <msub>
   <mi>τ</mi>
   <mi>Y</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>τ</ci>
    <ci>Y</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \tau_{Y}
  </annotation>
 </semantics>
</math>

 is the default time of entity 

<math display="inline" id="Financial_correlation:30">
 <semantics>
  <mi>Y</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>Y</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Y
  </annotation>
 </semantics>
</math>

. Hence if entity 

<math display="inline" id="Financial_correlation:31">
 <semantics>
  <mi>X</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>X</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   X
  </annotation>
 </semantics>
</math>

 defaults before or at time 

<math display="inline" id="Financial_correlation:32">
 <semantics>
  <mi>T</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>T</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   T
  </annotation>
 </semantics>
</math>

, the random indicator variable 

<math display="inline" id="Financial_correlation:33">
 <semantics>
  <msub>
   <mn>1</mn>
   <mi>X</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <cn type="integer">1</cn>
    <ci>X</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   1_{X}
  </annotation>
 </semantics>
</math>

 will take the value in 1, and 0 otherwise. The same applies to 

<math display="inline" id="Financial_correlation:34">
 <semantics>
  <mi>Y</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>Y</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Y
  </annotation>
 </semantics>
</math>

. Furthermore, 

<math display="inline" id="Financial_correlation:35">
 <semantics>
  <mrow>
   <mi>P</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>X</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>P</ci>
    <ci>X</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   P(X)
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Financial_correlation:36">
 <semantics>
  <mrow>
   <mi>P</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>Y</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>P</ci>
    <ci>Y</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   P(Y)
  </annotation>
 </semantics>
</math>

 is the default probability of 

<math display="inline" id="Financial_correlation:37">
 <semantics>
  <mi>X</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>X</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   X
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Financial_correlation:38">
 <semantics>
  <mi>Y</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>Y</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Y
  </annotation>
 </semantics>
</math>

 respectively, and 

<math display="inline" id="Financial_correlation:39">
 <semantics>
  <mrow>
   <mi>P</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mrow>
     <mi>X</mi>
     <mi>Y</mi>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>P</ci>
    <apply>
     <times></times>
     <ci>X</ci>
     <ci>Y</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   P(XY)
  </annotation>
 </semantics>
</math>

 is the joint <a href="probability_of_default" title="wikilink">probability of default</a>. The standard deviation of a one-trial binomial event is 

<math display="inline" id="Financial_correlation:40">
 <semantics>
  <msqrt>
   <mrow>
    <mrow>
     <mi>P</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>X</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>-</mo>
    <msup>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mi>P</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>X</mi>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <mn>2</mn>
    </msup>
   </mrow>
  </msqrt>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <root></root>
    <apply>
     <minus></minus>
     <apply>
      <times></times>
      <ci>P</ci>
      <ci>X</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <times></times>
       <ci>P</ci>
       <ci>X</ci>
      </apply>
      <cn type="integer">2</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \sqrt{P(X)-(P(X))^{2}}
  </annotation>
 </semantics>
</math>

, where P is the probability of outcome X. Hence, we derive the joint default dependence coefficient of the binomial events 

<math display="inline" id="Financial_correlation:41">
 <semantics>
  <msub>
   <mn>1</mn>
   <mrow>
    <mo stretchy="false">{</mo>
    <msub>
     <mi>τ</mi>
     <mi>X</mi>
    </msub>
    <mo>≤</mo>
    <mi>T</mi>
    <mo stretchy="false">}</mo>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <cn type="integer">1</cn>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-{</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>τ</ci>
      <ci>X</ci>
     </apply>
     <leq></leq>
     <csymbol cd="unknown">T</csymbol>
     <ci>normal-}</ci>
    </cerror>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   1_{\{\tau_{X}\leq T\}}
  </annotation>
 </semantics>
</math>

and 

<math display="inline" id="Financial_correlation:42">
 <semantics>
  <msub>
   <mn>1</mn>
   <mrow>
    <mo stretchy="false">{</mo>
    <msub>
     <mi>τ</mi>
     <mi>Y</mi>
    </msub>
    <mo>≤</mo>
    <mi>T</mi>
    <mo stretchy="false">}</mo>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <cn type="integer">1</cn>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-{</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>τ</ci>
      <ci>Y</ci>
     </apply>
     <leq></leq>
     <csymbol cd="unknown">T</csymbol>
     <ci>normal-}</ci>
    </cerror>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   1_{\{\tau_{Y}\leq T\}}
  </annotation>
 </semantics>
</math>

 as</p>

<p>

<math display="block" id="Financial_correlation:43">
 <semantics>
  <mrow>
   <mrow>
    <mi>ρ</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <msub>
      <mn>1</mn>
      <mrow>
       <mo stretchy="false">{</mo>
       <msub>
        <mi>τ</mi>
        <mi>X</mi>
       </msub>
       <mo>≤</mo>
       <mi>T</mi>
       <mo stretchy="false">}</mo>
      </mrow>
     </msub>
     <mo>,</mo>
     <msub>
      <mn>1</mn>
      <mrow>
       <mo stretchy="false">{</mo>
       <msub>
        <mi>τ</mi>
        <mi>Y</mi>
       </msub>
       <mo>≤</mo>
       <mi>T</mi>
       <mo stretchy="false">}</mo>
      </mrow>
     </msub>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mfrac>
    <mrow>
     <mrow>
      <mi>P</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mi>X</mi>
        <mi>Y</mi>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo>-</mo>
     <mrow>
      <mi>P</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>X</mi>
       <mo stretchy="false">)</mo>
      </mrow>
      <mi>P</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>Y</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mrow>
    <mrow>
     <msqrt>
      <mrow>
       <mrow>
        <mi>P</mi>
        <mrow>
         <mo stretchy="false">(</mo>
         <mi>X</mi>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
       <mo>-</mo>
       <msup>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <mi>P</mi>
          <mrow>
           <mo stretchy="false">(</mo>
           <mi>X</mi>
           <mo stretchy="false">)</mo>
          </mrow>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
        <mn>2</mn>
       </msup>
      </mrow>
     </msqrt>
     <msqrt>
      <mrow>
       <mrow>
        <mi>P</mi>
        <mrow>
         <mo stretchy="false">(</mo>
         <mi>Y</mi>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
       <mo>-</mo>
       <msup>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <mi>P</mi>
          <mrow>
           <mo stretchy="false">(</mo>
           <mi>Y</mi>
           <mo stretchy="false">)</mo>
          </mrow>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
        <mn>2</mn>
       </msup>
      </mrow>
     </msqrt>
    </mrow>
   </mfrac>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>ρ</ci>
     <interval closure="open">
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <cn type="integer">1</cn>
       <cerror>
        <csymbol cd="ambiguous">fragments</csymbol>
        <ci>normal-{</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>τ</ci>
         <ci>X</ci>
        </apply>
        <leq></leq>
        <csymbol cd="unknown">T</csymbol>
        <ci>normal-}</ci>
       </cerror>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <cn type="integer">1</cn>
       <cerror>
        <csymbol cd="ambiguous">fragments</csymbol>
        <ci>normal-{</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>τ</ci>
         <ci>Y</ci>
        </apply>
        <leq></leq>
        <csymbol cd="unknown">T</csymbol>
        <ci>normal-}</ci>
       </cerror>
      </apply>
     </interval>
    </apply>
    <apply>
     <divide></divide>
     <apply>
      <minus></minus>
      <apply>
       <times></times>
       <ci>P</ci>
       <apply>
        <times></times>
        <ci>X</ci>
        <ci>Y</ci>
       </apply>
      </apply>
      <apply>
       <times></times>
       <ci>P</ci>
       <ci>X</ci>
       <ci>P</ci>
       <ci>Y</ci>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <root></root>
       <apply>
        <minus></minus>
        <apply>
         <times></times>
         <ci>P</ci>
         <ci>X</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <times></times>
          <ci>P</ci>
          <ci>X</ci>
         </apply>
         <cn type="integer">2</cn>
        </apply>
       </apply>
      </apply>
      <apply>
       <root></root>
       <apply>
        <minus></minus>
        <apply>
         <times></times>
         <ci>P</ci>
         <ci>Y</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <times></times>
          <ci>P</ci>
          <ci>Y</ci>
         </apply>
         <cn type="integer">2</cn>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \rho(1_{\{\tau_{X}\leq T\}},1_{\{\tau_{Y}\leq T\}})=\frac{P(XY)-P(X)P(Y)}{%
\sqrt{P(X)-(P(X))^{2}}\sqrt{P(Y)-(P(Y))^{2}}}
  </annotation>
 </semantics>
</math>

 (5). By construction, equation (5) can only model binomial events, for example default and no default. The binomial correlation approach of equation (5) is a limiting case of the Pearson correlation approach discussed in section 1. As a consequence, the significant shortcomings of the Pearson correlation approach for financial modeling apply also to the binomial correlation model.</p>
<h4 id="copula-correlations">Copula correlations</h4>

<p>A fairly recent, famous as well as infamous correlation approach applied in finance is the <a href="copula_(probability_theory)" title="wikilink">copula</a> approach. Copulas go back to <a href="Abe_Sklar" title="wikilink">Sklar</a> (1959).<a class="footnoteRef" href="#fn6" id="fnref6"><sup>6</sup></a> Copulas were introduced to finance by Vasicek (1987)<a class="footnoteRef" href="#fn7" id="fnref7"><sup>7</sup></a> and Li (2000).<a class="footnoteRef" href="#fn8" id="fnref8"><sup>8</sup></a></p>

<p>Copulas simplify statistical problems. They allow the joining of multiple univariate distributions to a single multivariate distribution. Formally, a copula function C transforms an n-dimensional function on the interval [0,1] into a unit-dimensional one:</p>

<p>

<math display="block" id="Financial_correlation:44">
 <semantics>
  <mrow>
   <mi>C</mi>
   <mo>:</mo>
   <mrow>
    <msup>
     <mrow>
      <mo stretchy="false">[</mo>
      <mn>0</mn>
      <mo>,</mo>
      <mn>1</mn>
      <mo stretchy="false">]</mo>
     </mrow>
     <mi>n</mi>
    </msup>
    <mo>→</mo>
    <mrow>
     <mo stretchy="false">[</mo>
     <mn>0</mn>
     <mo>,</mo>
     <mn>1</mn>
     <mo stretchy="false">]</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-:</ci>
    <ci>C</ci>
    <apply>
     <ci>normal-→</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <interval closure="closed">
       <cn type="integer">0</cn>
       <cn type="integer">1</cn>
      </interval>
      <ci>n</ci>
     </apply>
     <interval closure="closed">
      <cn type="integer">0</cn>
      <cn type="integer">1</cn>
     </interval>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   C:[0,1]^{n}\rightarrow[0,1]
  </annotation>
 </semantics>
</math>

 (6).</p>

<p>More explicitly, let 

<math display="inline" id="Financial_correlation:45">
 <semantics>
  <msub>
   <mi>u</mi>
   <mi>i</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>u</ci>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   u_{i}
  </annotation>
 </semantics>
</math>

 be a uniform random vector with 

<math display="inline" id="Financial_correlation:46">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>u</mi>
     <mi>i</mi>
    </msub>
    <mo>=</mo>
    <mrow>
     <msub>
      <mi>u</mi>
      <mn>1</mn>
     </msub>
     <mo>,</mo>
     <mi mathvariant="normal">…</mi>
     <mo>,</mo>
     <msub>
      <mi>u</mi>
      <mi>n</mi>
     </msub>
    </mrow>
   </mrow>
   <mo>,</mo>
   <mrow>
    <msub>
     <mi>u</mi>
     <mi>i</mi>
    </msub>
    <mo>∈</mo>
    <mrow>
     <mo stretchy="false">[</mo>
     <mn>0</mn>
     <mo>,</mo>
     <mn>1</mn>
     <mo stretchy="false">]</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>u</ci>
      <ci>i</ci>
     </apply>
     <list>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>u</ci>
       <cn type="integer">1</cn>
      </apply>
      <ci>normal-…</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>u</ci>
       <ci>n</ci>
      </apply>
     </list>
    </apply>
    <apply>
     <in></in>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>u</ci>
      <ci>i</ci>
     </apply>
     <interval closure="closed">
      <cn type="integer">0</cn>
      <cn type="integer">1</cn>
     </interval>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   u_{i}=u_{1},...,u_{n},u_{i}\in[0,1]
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Financial_correlation:47">
 <semantics>
  <mrow>
   <mi>i</mi>
   <mo>∈</mo>
   <mi>N</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <in></in>
    <ci>i</ci>
    <ci>N</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   i\in N
  </annotation>
 </semantics>
</math>

. Then there exists a copula function 

<math display="inline" id="Financial_correlation:48">
 <semantics>
  <mi>C</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>C</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   C
  </annotation>
 </semantics>
</math>

 such that</p>

<p>

<math display="block" id="Financial_correlation:49">
 <semantics>
  <mrow>
   <mrow>
    <mi>C</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <msub>
      <mi>u</mi>
      <mn>1</mn>
     </msub>
     <mo>,</mo>
     <mi mathvariant="normal">…</mi>
     <mo>,</mo>
     <msub>
      <mi>u</mi>
      <mi>n</mi>
     </msub>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mi>F</mi>
    <mrow>
     <mo stretchy="false">[</mo>
     <mrow>
      <msubsup>
       <mi>F</mi>
       <mn>1</mn>
       <mrow>
        <mo>-</mo>
        <mn>1</mn>
       </mrow>
      </msubsup>
      <mrow>
       <mo stretchy="false">(</mo>
       <msub>
        <mi>u</mi>
        <mn>1</mn>
       </msub>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo>,</mo>
     <mi mathvariant="normal">…</mi>
     <mo>,</mo>
     <mrow>
      <msubsup>
       <mi>F</mi>
       <mi>n</mi>
       <mrow>
        <mo>-</mo>
        <mn>1</mn>
       </mrow>
      </msubsup>
      <mrow>
       <mo stretchy="false">(</mo>
       <msub>
        <mi>u</mi>
        <mi>n</mi>
       </msub>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo stretchy="false">]</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>C</ci>
     <vector>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>u</ci>
       <cn type="integer">1</cn>
      </apply>
      <ci>normal-…</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>u</ci>
       <ci>n</ci>
      </apply>
     </vector>
    </apply>
    <apply>
     <times></times>
     <ci>F</ci>
     <list>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>F</ci>
         <cn type="integer">1</cn>
        </apply>
        <apply>
         <minus></minus>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>u</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <ci>normal-…</ci>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>F</ci>
         <ci>n</ci>
        </apply>
        <apply>
         <minus></minus>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>u</ci>
        <ci>n</ci>
       </apply>
      </apply>
     </list>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   C(u_{1},\ldots,u_{n})=F[F_{1}^{-1}(u_{1}),\ldots,F_{n}^{-1}(u_{n})]
  </annotation>
 </semantics>
</math>

 (7)</p>

<p>where F is the joint cumulative distribution function and 

<math display="inline" id="Financial_correlation:50">
 <semantics>
  <msub>
   <mpadded lspace="5pt" width="+5pt">
    <mi>F</mi>
   </mpadded>
   <mi>i</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>F</ci>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \ F_{i}
  </annotation>
 </semantics>
</math>

, <em>i</em> = 1, …, <em>n</em><sub><em>i</em></sub> are the univariate marginal distributions. 

<math display="inline" id="Financial_correlation:51">
 <semantics>
  <msubsup>
   <mi>F</mi>
   <mi>i</mi>
   <mrow>
    <mo>-</mo>
    <mn>1</mn>
   </mrow>
  </msubsup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>F</ci>
     <ci>i</ci>
    </apply>
    <apply>
     <minus></minus>
     <cn type="integer">1</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   F_{i}^{-1}
  </annotation>
 </semantics>
</math>

 is the inverse of 

<math display="inline" id="Financial_correlation:52">
 <semantics>
  <msub>
   <mpadded lspace="5pt" width="+5pt">
    <mi>F</mi>
   </mpadded>
   <mi>i</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>F</ci>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \ F_{i}
  </annotation>
 </semantics>
</math>

. If the marginal distributions 

<math display="inline" id="Financial_correlation:53">
 <semantics>
  <mrow>
   <msubsup>
    <mi>F</mi>
    <mi>i</mi>
    <mrow>
     <mo>-</mo>
     <mn>1</mn>
    </mrow>
   </msubsup>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>u</mi>
     <mi>i</mi>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>F</ci>
      <ci>i</ci>
     </apply>
     <apply>
      <minus></minus>
      <cn type="integer">1</cn>
     </apply>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>u</ci>
     <ci>i</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   F_{i}^{-1}(u_{i})
  </annotation>
 </semantics>
</math>

 are continuous, it follows that C is unique. For properties and proofs of equation (11), see Sklar (1959) and Nelsen (2006).<a class="footnoteRef" href="#fn9" id="fnref9"><sup>9</sup></a> Numerous types of copula functions exist. They can be broadly categorized in one-parameter copulas as the Gaussian copula, and the Archimedean copula, which comprise Gumbel, Clayton and Frank copulas. Often cited two-parameter copulas are student-t, Fréchet, and Marshall-Olkin. For an overview of these copulas, see Nelsen (2006).  for example in a <a href="collateralized_debt_obligation" title="wikilink">collateralized debt obligation</a>, CDO. This was first done by Li in 2006. He defined the uniform margins u<sub>i</sub> as cumulative default probabilities Q for entity i at a fixed time t, 

<math display="inline" id="Financial_correlation:54">
 <semantics>
  <mrow>
   <msub>
    <mi>Q</mi>
    <mi>i</mi>
   </msub>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>t</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>Q</ci>
     <ci>i</ci>
    </apply>
    <ci>t</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Q_{i}(t)
  </annotation>
 </semantics>
</math>

:</p>

<p>

<math display="block" id="Financial_correlation:55">
 <semantics>
  <mrow>
   <msub>
    <mpadded lspace="5pt" width="+5pt">
     <mi>u</mi>
    </mpadded>
    <mi>i</mi>
   </msub>
   <mo>=</mo>
   <mrow>
    <msub>
     <mi>Q</mi>
     <mi>i</mi>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>t</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>u</ci>
     <ci>i</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>Q</ci>
      <ci>i</ci>
     </apply>
     <ci>t</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \ u_{i}=Q_{i}(t)
  </annotation>
 </semantics>
</math>

 (8).</p>

<p>Hence, from equations (7) and (8) we derive the Gaussian default time copula CGD,</p>

<p>

<math display="block" id="Financial_correlation:56">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>C</mi>
     <mrow>
      <mi>G</mi>
      <mi>D</mi>
     </mrow>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <msub>
      <mi>u</mi>
      <mn>1</mn>
     </msub>
     <mo>,</mo>
     <mi mathvariant="normal">…</mi>
     <mo>,</mo>
     <msub>
      <mi>u</mi>
      <mi>n</mi>
     </msub>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <msub>
     <mi>M</mi>
     <mrow>
      <mi>n</mi>
      <mo>,</mo>
      <mi>R</mi>
     </mrow>
    </msub>
    <mrow>
     <mo stretchy="false">[</mo>
     <mrow>
      <msubsup>
       <mi>N</mi>
       <mn>1</mn>
       <mrow>
        <mo>-</mo>
        <mn>1</mn>
       </mrow>
      </msubsup>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <msub>
         <mi>Q</mi>
         <mn>1</mn>
        </msub>
        <mrow>
         <mo stretchy="false">(</mo>
         <mi>t</mi>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo>,</mo>
     <mi mathvariant="normal">…</mi>
     <mo>,</mo>
     <mrow>
      <msubsup>
       <mi>N</mi>
       <mi>n</mi>
       <mrow>
        <mo>-</mo>
        <mn>1</mn>
       </mrow>
      </msubsup>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <msub>
         <mi>Q</mi>
         <mi>n</mi>
        </msub>
        <mrow>
         <mo stretchy="false">(</mo>
         <mi>t</mi>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo stretchy="false">]</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>C</ci>
      <apply>
       <times></times>
       <ci>G</ci>
       <ci>D</ci>
      </apply>
     </apply>
     <vector>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>u</ci>
       <cn type="integer">1</cn>
      </apply>
      <ci>normal-…</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>u</ci>
       <ci>n</ci>
      </apply>
     </vector>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>M</ci>
      <list>
       <ci>n</ci>
       <ci>R</ci>
      </list>
     </apply>
     <list>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>N</ci>
         <cn type="integer">1</cn>
        </apply>
        <apply>
         <minus></minus>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>Q</ci>
         <cn type="integer">1</cn>
        </apply>
        <ci>t</ci>
       </apply>
      </apply>
      <ci>normal-…</ci>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>N</ci>
         <ci>n</ci>
        </apply>
        <apply>
         <minus></minus>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>Q</ci>
         <ci>n</ci>
        </apply>
        <ci>t</ci>
       </apply>
      </apply>
     </list>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   C_{GD}(u_{1},\ldots,u_{n})=M_{n,R}[N_{1}^{-1}(Q_{1}(t)),\ldots,N_{n}^{-1}(Q_{n%
}(t))]
  </annotation>
 </semantics>
</math>

 (9). In equation (9) the terms 

<math display="inline" id="Financial_correlation:57">
 <semantics>
  <msubsup>
   <mi>N</mi>
   <mi>i</mi>
   <mrow>
    <mo>-</mo>
    <mn>1</mn>
   </mrow>
  </msubsup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>N</ci>
     <ci>i</ci>
    </apply>
    <apply>
     <minus></minus>
     <cn type="integer">1</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   N_{i}^{-1}
  </annotation>
 </semantics>
</math>

 map the cumulative default probabilities Q of asset i for time t, 

<math display="inline" id="Financial_correlation:58">
 <semantics>
  <mrow>
   <msub>
    <mi>Q</mi>
    <mi>i</mi>
   </msub>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>t</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>Q</ci>
     <ci>i</ci>
    </apply>
    <ci>t</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Q_{i}(t)
  </annotation>
 </semantics>
</math>

, percentile to percentile to standard normal. The mapped standard normal marginal distributions 

<math display="inline" id="Financial_correlation:59">
 <semantics>
  <mrow>
   <msubsup>
    <mi>N</mi>
    <mi>i</mi>
    <mrow>
     <mo>-</mo>
     <mn>1</mn>
    </mrow>
   </msubsup>
   <msub>
    <mi>Q</mi>
    <mi>i</mi>
   </msub>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>t</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>N</ci>
      <ci>i</ci>
     </apply>
     <apply>
      <minus></minus>
      <cn type="integer">1</cn>
     </apply>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>Q</ci>
     <ci>i</ci>
    </apply>
    <ci>t</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   N_{i}^{-1}Q_{i}(t)
  </annotation>
 </semantics>
</math>

 are then joined to a single n-variate distribution 

<math display="inline" id="Financial_correlation:60">
 <semantics>
  <msub>
   <mi>M</mi>
   <mrow>
    <mi>n</mi>
    <mo>,</mo>
    <mi>R</mi>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>M</ci>
    <list>
     <ci>n</ci>
     <ci>R</ci>
    </list>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   M_{n,R}
  </annotation>
 </semantics>
</math>

 by applying the correlation structure of the multivariate normal distribution with correlation matrix R. The probability of n correlated defaults at time t is given by 

<math display="inline" id="Financial_correlation:61">
 <semantics>
  <msub>
   <mi>M</mi>
   <mrow>
    <mi>n</mi>
    <mo>,</mo>
    <mi>R</mi>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>M</ci>
    <list>
     <ci>n</ci>
     <ci>R</ci>
    </list>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   M_{n,R}
  </annotation>
 </semantics>
</math>

.</p>
<h4 id="copulae-and-the-200708-financial-crisis">Copulae and the 2007–08 financial crisis</h4>

<p>Numerous non-academic articles have been written demonizing the copula approach and blaming it for the 2007/2008 global financial crisis, see for example Salmon 2009,<a class="footnoteRef" href="#fn10" id="fnref10"><sup>10</sup></a> Jones 2009,<a class="footnoteRef" href="#fn11" id="fnref11"><sup>11</sup></a> and Lohr 2009.<a class="footnoteRef" href="#fn12" id="fnref12"><sup>12</sup></a> .</p>

<p>a) Tail dependence</p>

<p>In a crisis, financial correlations typically increase, see studies by Das, Duffie, Kapadia, and Saita (2007)<a class="footnoteRef" href="#fn13" id="fnref13"><sup>13</sup></a> and Duffie, Eckner, Horel and Saita (2009)<a class="footnoteRef" href="#fn14" id="fnref14"><sup>14</sup></a> and references therein. Hence it would be desirable to apply a correlation model with high co-movements in the lower tail of the joint distribution. It can be mathematically shown that the Gaussian copula has relative low tail dependence, as seen in the following scatter plots.</p>

<p><br/>
 Figure 1: Scatter plots of different copula models</p>

<p>As seen in Figure 1b, the student-t copula exhibits higher tail dependence and might be better suited to model financial correlations. Also, as seen in Figure 1c), the Gumbel copula exhibits high tail dependence especially for negative co-movements. Assuming that correlations increase when asset prices decrease, the Gumbel copula might also be a good correlation approach for financial modeling.</p>

<p>b) Calibration</p>

<p>A further criticism of the Gaussian copula is the difficulty to calibrate it to market prices. In practice, typically a single correlation parameter (not a correlation matrix) is used to model the default correlation between any two entities in a collateralized debt obligation, CDO. Conceptually this correlation parameter should be the same for the entire CDO portfolio. However, traders randomly alter the correlation parameter for different <a class="uri" href="tranches" title="wikilink">tranches</a>, in order to derive desired tranche spreads. Traders increase the correlation for ‘extreme’ tranches as the equity tranche or senior tranches, referred to as the correlation smile. This is similar to the often cited implied volatility smile in the Black–Scholes–Merton model. Here traders increase the implied volatility especially for out-of-the money puts, but also for out-of-the money calls to increase the option price.</p>

<p>c) Risk management</p>

<p>A further criticism of the Copula approach is that the copula model is static and consequently allows only limited risk management, see Finger (2009)<a class="footnoteRef" href="#fn15" id="fnref15"><sup>15</sup></a> or Donnelly and Embrechts (2010).<a class="footnoteRef" href="#fn16" id="fnref16"><sup>16</sup></a> The original copulas models of Vasicek (1987) and Li (2000) and several extensions of the model as Hull and White (2004)<a class="footnoteRef" href="#fn17" id="fnref17"><sup>17</sup></a> or Gregory and Laurent (2004)<a class="footnoteRef" href="#fn18" id="fnref18"><sup>18</sup></a> do have a one period time horizon, i.e. are static. In particular, there is no stochastic process for the critical underlying variables default intensity and default correlation. However, even in these early copula formulations, back testing and stress testing the variables for different time horizons can give valuable sensitivities, see Whetten and Adelson (2004)<a class="footnoteRef" href="#fn19" id="fnref19"><sup>19</sup></a> and Meissner, Hector, and. Rasmussen (2008).<a class="footnoteRef" href="#fn20" id="fnref20"><sup>20</sup></a> In addition, the copula variables can be made a function of time as in Hull, Predescu, and White (2005).<a class="footnoteRef" href="#fn21" id="fnref21"><sup>21</sup></a> This still does not create a fully dynamic stochastic process with drift and noise, which allows flexible hedging and risk management. The best solutions are truly dynamic copula frameworks, see section ‘Dynamic Copulas’ below.</p>
<h4 id="irrational-complacency">Irrational complacency</h4>

<p>Before the global 2007–08 financial crisis, numerous market participants trusted the copula model uncritically and naively. However, the 2007–08 crisis was less a matter of a particular correlation model, but rather an issue of "irrational complacency". In the extremely benign time period from 2003 to 2006, proper hedging, proper risk management and stress test results were largely ignored. The prime example is AIG’s London subsidiary, which had sold <a href="credit_default_swaps" title="wikilink">credit default swaps</a> and collateralized debt obligations in an amount of close to $500 billion without conducting any major hedging. For an insightful paper on inadequate risk management leading up to the crisis, see “A personal view of the crisis – Confessions of a Risk Manager” (The Economist 2008).<a class="footnoteRef" href="#fn22" id="fnref22"><sup>22</sup></a> In particular, if any credit correlation model is fed with benign input data as low default intensities and low default correlation, the risk output figures will be benign, ‘garbage in garbage out’ in modeling terminology.</p>
<h4 id="dynamic-copulas">Dynamic copulas</h4>

<p>A core enhancement of copula models are dynamic copulas, introduced by Albanese et al. (2005)<a class="footnoteRef" href="#fn23" id="fnref23"><sup>23</sup></a> and (2007).<a class="footnoteRef" href="#fn24" id="fnref24"><sup>24</sup></a> The "dynamic conditioning" approach models the evolution of multi-factor super-lattices, which correlate the return processes of each entity at each time step. Binomial dynamic copulas apply combinatorial methods to avoid Monte Carlo simulations. Richer dynamic Gaussian copulas apply Monte Carlo simulation and come at the cost of requiring powerful computer technology.</p>
<h3 id="conditionally-independent-default-cid-correlation-modeling">Conditionally independent default (CID) correlation modeling</h3>

<p>In order to avoid specifying the default correlation between each entity pair in a portfolio a factorization is often applied. This leads to conditionally independent default (CID) modeling. The most widely applied CID model is the one-factor Gaussian copula (OFGC) model. It was the de facto market model for pricing CDOs before the 2007/2008 global financial crisis. The core equation of the OFGC model<br/>


<math display="block" id="Financial_correlation:62">
 <semantics>
  <mrow>
   <msub>
    <mi>x</mi>
    <mi>i</mi>
   </msub>
   <mo>=</mo>
   <mrow>
    <mrow>
     <msqrt>
      <mi>ρ</mi>
     </msqrt>
     <mi>M</mi>
    </mrow>
    <mo>+</mo>
    <mrow>
     <msqrt>
      <mrow>
       <mn>1</mn>
       <mo>-</mo>
       <mi>ρ</mi>
      </mrow>
     </msqrt>
     <msub>
      <mi>Z</mi>
      <mi>i</mi>
     </msub>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>x</ci>
     <ci>i</ci>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <apply>
       <root></root>
       <ci>ρ</ci>
      </apply>
      <ci>M</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <root></root>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
        <ci>ρ</ci>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>Z</ci>
       <ci>i</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x_{i}=\sqrt{\rho}M+\sqrt{1-\rho}Z_{i}
  </annotation>
 </semantics>
</math>

 (10) where 

<math display="inline" id="Financial_correlation:63">
 <semantics>
  <mi>M</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>M</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   M
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Financial_correlation:64">
 <semantics>
  <msub>
   <mi>Z</mi>
   <mi>i</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>Z</ci>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Z_{i}
  </annotation>
 </semantics>
</math>

 are random drawings from n~(0,1) and 

<math display="inline" id="Financial_correlation:65">
 <semantics>
  <mrow>
   <mn>0</mn>
   <mo>≤</mo>
   <mi>ρ</mi>
   <mo>≤</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <leq></leq>
     <cn type="integer">0</cn>
     <ci>ρ</ci>
    </apply>
    <apply>
     <leq></leq>
     <share href="#.cmml">
     </share>
     <cn type="integer">1</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   0\leq\rho\leq 1
  </annotation>
 </semantics>
</math>

. As a result, the latent variable 

<math display="inline" id="Financial_correlation:66">
 <semantics>
  <msub>
   <mi>x</mi>
   <mi>i</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>x</ci>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x_{i}
  </annotation>
 </semantics>
</math>

, sometimes interpreted as the asset value of i, see Turc, Very, Benhamou and Alvarez et al. (2005),<a class="footnoteRef" href="#fn25" id="fnref25"><sup>25</sup></a> is also n~(0,1). The common factor 

<math display="inline" id="Financial_correlation:67">
 <semantics>
  <mi>M</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>M</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   M
  </annotation>
 </semantics>
</math>

 can be interpreted as the economic environment, possibly represented by the return of the S&amp;P; 500. 

<math display="inline" id="Financial_correlation:68">
 <semantics>
  <msub>
   <mi>Z</mi>
   <mi>i</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>Z</ci>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Z_{i}
  </annotation>
 </semantics>
</math>

 is the idiosyncratic component, the ‘strength’ of entity i, possibly measured by entity i’s stock price return. From equation (10) we see, that the correlation between entities i is modeled indirectly by conditioning the latent variable 

<math display="inline" id="Financial_correlation:69">
 <semantics>
  <msub>
   <mi>x</mi>
   <mi>i</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>x</ci>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x_{i}
  </annotation>
 </semantics>
</math>

 on the common factor 

<math display="inline" id="Financial_correlation:70">
 <semantics>
  <mi>M</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>M</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   M
  </annotation>
 </semantics>
</math>

. For example, for p =1, the latent variables of all entities 

<math display="inline" id="Financial_correlation:71">
 <semantics>
  <mrow>
   <mrow>
    <mi>i</mi>
    <mo>=</mo>
    <mrow>
     <mn>1</mn>
     <mo>,</mo>
     <mi mathvariant="normal">…</mi>
     <mo>,</mo>
     <mi>n</mi>
    </mrow>
   </mrow>
   <mo rspace="7.5pt">,</mo>
   <mrow>
    <msub>
     <mi>x</mi>
     <mi>i</mi>
    </msub>
    <mo>=</mo>
    <mi>M</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <eq></eq>
     <ci>i</ci>
     <list>
      <cn type="integer">1</cn>
      <ci>normal-…</ci>
      <ci>n</ci>
     </list>
    </apply>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <ci>i</ci>
     </apply>
     <ci>M</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   i=1,...,n,\ x_{i}=M
  </annotation>
 </semantics>
</math>

, so the 

<math display="inline" id="Financial_correlation:72">
 <semantics>
  <msub>
   <mi>x</mi>
   <mi>i</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>x</ci>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x_{i}
  </annotation>
 </semantics>
</math>

 are identical in each simulation. For p = 0, all latent variable for all entities 

<math display="inline" id="Financial_correlation:73">
 <semantics>
  <mrow>
   <mrow>
    <mi>i</mi>
    <mo>=</mo>
    <mrow>
     <mn>1</mn>
     <mo>,</mo>
     <mi mathvariant="normal">…</mi>
     <mo>,</mo>
     <mi>n</mi>
    </mrow>
   </mrow>
   <mo rspace="7.5pt">,</mo>
   <mrow>
    <msub>
     <mi>x</mi>
     <mi>i</mi>
    </msub>
    <mo>=</mo>
    <msub>
     <mi>Z</mi>
     <mi>i</mi>
    </msub>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <eq></eq>
     <ci>i</ci>
     <list>
      <cn type="integer">1</cn>
      <ci>normal-…</ci>
      <ci>n</ci>
     </list>
    </apply>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <ci>i</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>Z</ci>
      <ci>i</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   i=1,\ldots,n,\ x_{i}=Z_{i}
  </annotation>
 </semantics>
</math>

, hence the 

<math display="inline" id="Financial_correlation:74">
 <semantics>
  <msub>
   <mi>x</mi>
   <mi>i</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>x</ci>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x_{i}
  </annotation>
 </semantics>
</math>

 are independent. Importantly, once we fix the value of M, the defaults of the n entities are (conditionally on M) mutually independent.</p>

<p>As of 2010, the OFGC is the basis for credit risk management in <a href="Basel_II" title="wikilink">Basel II</a>. The benefits of the model are simplicity and intuition. One of the main shortcomings of the model is that traders when pricing CDOs randomly alter the correlation parameter for different CDO tranches to achieve desired tranche spreads. However conceptually, the correlation parameter should be identical for the whole portfolio.</p>
<h3 id="contagion-default-modeling">Contagion default modeling</h3>

<p>Contagion default modeling can be viewed as a variation of CID modeling. As discussed in section 2.3, in the CID framework, correlation is modeled by conditioning on a common market factor M, which impacts all entities to the same degree. The lower the random drawing for M, the higher is the default intensity of all entities (unless ρ = 0). Hence CID modeling can elucidate default clustering. In contrast, contagion approaches model the default intensity of an entity as a function of the default of another entity. Hence contagion default modeling incorporates counterparty risk, i.e. the direct impact of a defaulting entity on the default intensity of another entity. In particular, after a default of a particular entity, the default intensity of all assets in the portfolio increases. This default contagion then typically fades exponentially to non-contagious default intensity levels. See the papers of Davis and Lo (2001)<a class="footnoteRef" href="#fn26" id="fnref26"><sup>26</sup></a> and Jarrow and Yu (2001),<a class="footnoteRef" href="#fn27" id="fnref27"><sup>27</sup></a> who pioneered contagion default modeling.</p>
<h2 id="topdown-correlation-approaches">Top–down correlation approaches</h2>

<p>Within the credit correlation modeling framework, a fairly new correlation approach is top–down modeling. Here the evolution of the portfolio intensity distribution is derived directly, i.e. abstracting from the default intensities of individual entities. Top-down models are typically applied in practice if</p>
<ul>
<li>The default intensities of the individual entities are unavailable or unreliable.</li>
</ul>
<ul>
<li>The default intensities of the individual entities are unnecessary. This may be the case when evaluating a homogeneous portfolio such as an index of homogeneous entities.</li>
</ul>
<ul>
<li>The sheer size of a portfolio makes the modeling of individual default intensities problematic.</li>
</ul>

<p>Top–down models are typically more parsimonious, computationally efficient and can often be calibrated better to market prices than bottom–up models. Although seemingly important information such as the default intensities of individual entities is disregarded, a top-down model can typically better capture properties of the portfolio such as volatility or correlation smiles. In addition, the default information of individual entities can often be inferred by random thinning techniques, see Giesecke, Goldberg and Ding (2007)<a class="footnoteRef" href="#fn28" id="fnref28"><sup>28</sup></a> for details.</p>

<p>Within the top-down framework, Schönbucher (2006)<a class="footnoteRef" href="#fn29" id="fnref29"><sup>29</sup></a> creates a time-inhomogeneous <a href="Markov_chain" title="wikilink">Markov-chain</a> of transition rates. Default correlation is introduced by changes in the volatility of transition rates. For certain parameter constellations, higher volatility means faster transition to lower states as default, and as a consequence implies higher default correlation, and vice versa. Similarly, Hurd and Kuznetsov (2006a)<a class="footnoteRef" href="#fn30" id="fnref30"><sup>30</sup></a> and (2006b)<a class="footnoteRef" href="#fn31" id="fnref31"><sup>31</sup></a> induce correlation by a random change in the speed of time. A faster speed of time means faster transition to a lower state, possibly default, and as a result increases default correlation, and vice versa. For a comparative analysis of correlation approaches in finance, see Albanese, Li, Lobachevskiy, and Meissner (2010).<a class="footnoteRef" href="#fn32" id="fnref32"><sup>32</sup></a></p>
<h2 id="references">References</h2>

<p>"</p>

<p><a href="Category:Mathematical_finance" title="wikilink">Category:Mathematical finance</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1"><a href="#fnref1">↩</a></li>
<li id="fn2">Correlation Risk Modeling and Management: An Applied Guide. Gunter Meissner. Wiley 2014. [<a class="uri" href="http://books.google.com/books?id=GH5nAgAAQBAJ&amp;pg">http://books.google.com/books?id=GH5nAgAAQBAJ&amp;pg;</a>;=PT81&amp;lpg;=PT81&amp;dq;=Steven+Heston+correlation&amp;source;=bl&amp;ots;=CjE4vRam4M&amp;sig;=wcxHmgy0nvhWN95G5Y1dKZL4ZUU&amp;hl;=en&amp;sa;=X&amp;ei;=eLjSU7TBH4rgsATK4ICABA&amp;ved;=0CCwQ6AEwAg#v=onepage&amp;q;=Steven%20Heston&amp;f;=false]<a href="#fnref2">↩</a></li>
<li id="fn3"><a href="#fnref3">↩</a></li>
<li id="fn4"><a href="#fnref4">↩</a></li>
<li id="fn5"><a href="#fnref5">↩</a></li>
<li id="fn6"><a href="#fnref6">↩</a></li>
<li id="fn7"><a href="#fnref7">↩</a></li>
<li id="fn8"><a href="#fnref8">↩</a></li>
<li id="fn9"><a href="#fnref9">↩</a></li>
<li id="fn10"><a href="#fnref10">↩</a></li>
<li id="fn11"><a href="#fnref11">↩</a></li>
<li id="fn12"><a href="#fnref12">↩</a></li>
<li id="fn13"><a href="#fnref13">↩</a></li>
<li id="fn14"><a href="#fnref14">↩</a></li>
<li id="fn15"><a href="#fnref15">↩</a></li>
<li id="fn16"><a href="#fnref16">↩</a></li>
<li id="fn17"><a href="#fnref17">↩</a></li>
<li id="fn18"><a href="#fnref18">↩</a></li>
<li id="fn19"><a href="#fnref19">↩</a></li>
<li id="fn20"><a href="#fnref20">↩</a></li>
<li id="fn21"><a href="#fnref21">↩</a></li>
<li id="fn22"><a href="#fnref22">↩</a></li>
<li id="fn23"><a href="#fnref23">↩</a></li>
<li id="fn24"><a href="#fnref24">↩</a></li>
<li id="fn25"><a href="#fnref25">↩</a></li>
<li id="fn26"><a href="#fnref26">↩</a></li>
<li id="fn27"><a href="#fnref27">↩</a></li>
<li id="fn28"><a href="#fnref28">↩</a></li>
<li id="fn29"><a href="#fnref29">↩</a></li>
<li id="fn30"><a href="#fnref30">↩</a></li>
<li id="fn31"><a href="#fnref31">↩</a></li>
<li id="fn32"><a href="#fnref32">↩</a></li>
</ol>
</section>
</body>
</html>

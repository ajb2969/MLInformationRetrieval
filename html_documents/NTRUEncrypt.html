<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="1186">NTRUEncrypt</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>NTRUEncrypt</h1>
<hr/>

<p>The <strong>NTRUEncrypt</strong> <a href="public_key_cryptosystem" title="wikilink">public key cryptosystem</a>, also known as the <strong>NTRU encryption algorithm</strong>, is a <a href="Lattice-based_cryptography" title="wikilink">lattice-based</a> alternative to <a href="RSA_(algorithm)" title="wikilink">RSA</a> and <a href="Elliptic_curve_cryptography" title="wikilink">ECC</a> and is based on the <a href="Lattice_problems" title="wikilink">shortest vector problem</a> in a lattice (which is not known to be breakable using <a href="quantum_computers" title="wikilink">quantum computers</a>). Operations are based on objects in a truncated <a href="polynomial_ring" title="wikilink">polynomial ring</a> 

<math display="inline" id="NTRUEncrypt:0">
 <semantics>
  <mrow>
   <mpadded lspace="5pt" width="+5pt">
    <mi>R</mi>
   </mpadded>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mi>‚Ñ§</mi>
     <mrow>
      <mo stretchy="false">[</mo>
      <mi>X</mi>
      <mo stretchy="false">]</mo>
     </mrow>
    </mrow>
    <mo>/</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <msup>
       <mi>X</mi>
       <mi>N</mi>
      </msup>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>R</ci>
    <apply>
     <divide></divide>
     <apply>
      <times></times>
      <ci>‚Ñ§</ci>
      <apply>
       <csymbol cd="latexml">delimited-[]</csymbol>
       <ci>X</ci>
      </apply>
     </apply>
     <apply>
      <minus></minus>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>X</ci>
       <ci>N</ci>
      </apply>
      <cn type="integer">1</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \ R=\mathbb{Z}[X]/(X^{N}-1)
  </annotation>
 </semantics>
</math>

 with convolution multiplication and all polynomials in the ring have <a class="uri" href="integer" title="wikilink">integer</a> <a href="coefficient" title="wikilink">coefficients</a> and degree at most <em>N</em>-1:</p>

<p>

<math display="block" id="NTRUEncrypt:1">
 <semantics>
  <mrow>
   <mtext>ùêö</mtext>
   <mo>=</mo>
   <mrow>
    <msub>
     <mi>a</mi>
     <mn>0</mn>
    </msub>
    <mo>+</mo>
    <mrow>
     <msub>
      <mi>a</mi>
      <mn>1</mn>
     </msub>
     <mi>X</mi>
    </mrow>
    <mo>+</mo>
    <mrow>
     <msub>
      <mi>a</mi>
      <mn>2</mn>
     </msub>
     <msup>
      <mi>X</mi>
      <mn>2</mn>
     </msup>
    </mrow>
    <mo>+</mo>
    <mi mathvariant="normal">‚ãØ</mi>
    <mo>+</mo>
    <mrow>
     <msub>
      <mi>a</mi>
      <mrow>
       <mi>N</mi>
       <mo>-</mo>
       <mn>2</mn>
      </mrow>
     </msub>
     <msup>
      <mi>X</mi>
      <mrow>
       <mi>N</mi>
       <mo>-</mo>
       <mn>2</mn>
      </mrow>
     </msup>
    </mrow>
    <mo>+</mo>
    <mrow>
     <msub>
      <mi>a</mi>
      <mrow>
       <mi>N</mi>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
     </msub>
     <msup>
      <mi>X</mi>
      <mrow>
       <mi>N</mi>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
     </msup>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <mtext>a</mtext>
    <apply>
     <plus></plus>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>a</ci>
      <cn type="integer">0</cn>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>a</ci>
       <cn type="integer">1</cn>
      </apply>
      <ci>X</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>a</ci>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>X</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
     <ci>normal-‚ãØ</ci>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>a</ci>
       <apply>
        <minus></minus>
        <ci>N</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>X</ci>
       <apply>
        <minus></minus>
        <ci>N</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>a</ci>
       <apply>
        <minus></minus>
        <ci>N</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>X</ci>
       <apply>
        <minus></minus>
        <ci>N</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \textbf{a}=a_{0}+a_{1}X+a_{2}X^{2}+\cdots+a_{N-2}X^{N-2}+a_{N-1}X^{N-1}
  </annotation>
 </semantics>
</math>

</p>

<p>NTRU is actually a parameterised family of cryptosystems; each system is specified by three integer parameters (<em>N</em>, <em>p</em>, <em>q</em>) which represent the maximal degree 

<math display="inline" id="NTRUEncrypt:2">
 <semantics>
  <mrow>
   <mpadded lspace="5pt" width="+5pt">
    <mi>N</mi>
   </mpadded>
   <mo>-</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <minus></minus>
    <ci>N</ci>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \ N-1
  </annotation>
 </semantics>
</math>

 for all polynomials in the truncated ring <em>R</em>, a small modulus and a large modulus, respectively, where it is assumed that <em>N</em> is <a href="prime_number" title="wikilink">prime</a>, <em>q</em> is always larger than <em>p</em>, and <em>p</em> and <em>q</em> are <a class="uri" href="coprime" title="wikilink">coprime</a>; and four sets of polynomials 

<math display="inline" id="NTRUEncrypt:3">
 <semantics>
  <mrow>
   <msub>
    <mpadded lspace="5pt" width="+5pt">
     <mi class="ltx_font_mathcaligraphic">‚Ñí</mi>
    </mpadded>
    <mi>f</mi>
   </msub>
   <mo>,</mo>
   <msub>
    <mi class="ltx_font_mathcaligraphic">‚Ñí</mi>
    <mi>g</mi>
   </msub>
   <mo>,</mo>
   <msub>
    <mi class="ltx_font_mathcaligraphic">‚Ñí</mi>
    <mi>m</mi>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <list>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>‚Ñí</ci>
     <ci>f</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>‚Ñí</ci>
     <ci>g</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>‚Ñí</ci>
     <ci>m</ci>
    </apply>
   </list>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \ \mathcal{L}_{f},\mathcal{L}_{g},\mathcal{L}_{m}
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="NTRUEncrypt:4">
 <semantics>
  <msub>
   <mpadded lspace="5pt" width="+5pt">
    <mi class="ltx_font_mathcaligraphic">‚Ñí</mi>
   </mpadded>
   <mi>r</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>‚Ñí</ci>
    <ci>r</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \ \mathcal{L}_{r}
  </annotation>
 </semantics>
</math>

 (a polynomial part of the private key, a polynomial for generation of the public key, the message and a blinding value, respectively), all of degree at most 

<math display="inline" id="NTRUEncrypt:5">
 <semantics>
  <mrow>
   <mpadded lspace="5pt" width="+5pt">
    <mi>N</mi>
   </mpadded>
   <mo>-</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <minus></minus>
    <ci>N</ci>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \ N-1
  </annotation>
 </semantics>
</math>

.</p>

<p>It relies on the presumed difficulty of <a href="factorization" title="wikilink">factoring</a> certain polynomials in such rings into a quotient of two polynomials having very small coefficients. Breaking the cryptosystem is strongly related, though not equivalent, to the algorithmic problem of <a href="lattice_reduction" title="wikilink">lattice reduction</a> in certain <a href="lattice_(group)" title="wikilink">lattices</a>. Careful choice of parameters is necessary to thwart some published attacks.</p>

<p>Since both encryption and decryption use only simple polynomial multiplication, these operations are very fast compared to other asymmetric encryption schemes, such as RSA, <a href="ElGamal_encryption" title="wikilink">El Gamal</a> and <a href="elliptic_curve_cryptography" title="wikilink">elliptic curve cryptography</a>. However, NTRUEncrypt has not yet undergone a comparable amount of cryptographic analysis.</p>

<p>A related algorithm is the <a class="uri" href="NTRUSign" title="wikilink">NTRUSign</a> <a href="digital_signature" title="wikilink">digital signature</a> algorithm.</p>
<h2 id="history">History</h2>

<p>The NTRUEncrypt Public Key Cryptosystem is a relatively new cryptosystem. The first version of the system, which was simply called NTRU, was developed around 1996 by three mathematicians (, <a href="Jill_Pipher" title="wikilink">Jill Pipher</a>, and <a href="Joseph_H._Silverman" title="wikilink">Joseph H. Silverman</a>). In 1996 these mathematicians together with <a href="Daniel_Lieman" title="wikilink">Daniel Lieman</a> founded the <a href="NTRU_Cryptosystems,_Inc." title="wikilink">NTRU Cryptosystems, Inc.</a> and were given a <a href="http://grouper.ieee.org/groups/802/15/pub/Patent_Letters/15.3/ntru%2015.3.pdf">patent</a> on the cryptosystem.</p>

<p>During the last ten years people have been working on improving the cryptosystem. Since the first presentation of the cryptosystem, some changes were made to improve both the performance of the system and its security. Most performance improvements were focussed on speeding up the process. Up till 2005 literature can be found that describes the decryption failures of the NTRUEncrypt. As for security, since the first version of the NTRUEncrypt, new parameters have been introduced that seem secure for all currently known attacks and reasonable increase in computation power.</p>

<p>Now the system is fully accepted to IEEE P1363 standards under the specifications for lattice-based public-key cryptography (<a href="IEEE_P1363" title="wikilink">IEEE P1363.1</a>). Because of the speed of the NTRUEncrypt Public Key Cryptosystem (see <a class="uri" href="http://bench.cr.yp.to">http://bench.cr.yp.to</a> for benchmarking results) and its low memory use (see <a href="#Table_1:_Parameters" title="wikilink">below</a>), it can be used in applications such as mobile devices and <a href="Smart-card" title="wikilink">Smart-cards</a>. In April 2011, NTRUEncrypt was accepted as a X9.98 Standard, for use in the financial services industry.<a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a></p>
<h2 id="public-key-generation">Public key generation</h2>

<p>Sending a secret message from Alice to Bob requires the generation of a public and a private key. The public key is known by both Alice and Bob and the private key is only known by Bob. To generate the key pair two polynomials <strong>f</strong> and <strong>g</strong>, with degree at most 

<math display="inline" id="NTRUEncrypt:6">
 <semantics>
  <mrow>
   <mpadded lspace="5pt" width="+5pt">
    <mi>N</mi>
   </mpadded>
   <mo>-</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <minus></minus>
    <ci>N</ci>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \ N-1
  </annotation>
 </semantics>
</math>

 and with coefficients in {-1,0,1} are required. They can be considered as representations of the residue classes of polynomials modulo 

<math display="inline" id="NTRUEncrypt:7">
 <semantics>
  <mrow>
   <msup>
    <mpadded lspace="5pt" width="+5pt">
     <mi>X</mi>
    </mpadded>
    <mi>N</mi>
   </msup>
   <mo>-</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <minus></minus>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>X</ci>
     <ci>N</ci>
    </apply>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \ X^{N}-1
  </annotation>
 </semantics>
</math>

 in <em>R</em>. The polynomial 

<math display="inline" id="NTRUEncrypt:8">
 <semantics>
  <mrow>
   <mtext>ùêü</mtext>
   <mo>‚àà</mo>
   <msub>
    <mi>L</mi>
    <mi>f</mi>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <in></in>
    <mtext>f</mtext>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>L</ci>
     <ci>f</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \textbf{f}\in L_{f}
  </annotation>
 </semantics>
</math>

 must satisfy the additional requirement that the inverses modulo <em>q</em> and modulo <em>p</em> (computed using the <a href="Euclidean_algorithm" title="wikilink">Euclidean algorithm</a>) exist, which means that 

<math display="inline" id="NTRUEncrypt:9">
 <semantics>
  <mrow>
   <mrow>
    <mpadded lspace="5pt" width="+5pt">
     <mtext>ùêü</mtext>
    </mpadded>
    <mo>‚ãÖ</mo>
    <msub>
     <mtext>ùêü</mtext>
     <mi>p</mi>
    </msub>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mn>1</mn>
    <mspace width="veryverythickmathspace">
    </mspace>
    <mrow>
     <mo lspace="8.1pt" stretchy="false">(</mo>
     <mrow>
      <mo>mod</mo>
      <mi>p</mi>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <ci>normal-‚ãÖ</ci>
     <mtext>f</mtext>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <mtext>f</mtext>
      <ci>p</ci>
     </apply>
    </apply>
    <apply>
     <csymbol cd="latexml">annotated</csymbol>
     <cn type="integer">1</cn>
     <apply>
      <ci>pmod</ci>
      <ci>p</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \ \textbf{f}\cdot\textbf{f}_{p}=1\;\;(\mathop{{\rm mod}}p)
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="NTRUEncrypt:10">
 <semantics>
  <mrow>
   <mrow>
    <mpadded lspace="5pt" width="+5pt">
     <mtext>ùêü</mtext>
    </mpadded>
    <mo>‚ãÖ</mo>
    <msub>
     <mtext>ùêü</mtext>
     <mi>q</mi>
    </msub>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mn>1</mn>
    <mspace width="veryverythickmathspace">
    </mspace>
    <mrow>
     <mo lspace="8.1pt" stretchy="false">(</mo>
     <mrow>
      <mo>mod</mo>
      <mi>q</mi>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <ci>normal-‚ãÖ</ci>
     <mtext>f</mtext>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <mtext>f</mtext>
      <ci>q</ci>
     </apply>
    </apply>
    <apply>
     <csymbol cd="latexml">annotated</csymbol>
     <cn type="integer">1</cn>
     <apply>
      <ci>pmod</ci>
      <ci>q</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \ \textbf{f}\cdot\textbf{f}_{q}=1\;\;(\mathop{{\rm mod}}q)
  </annotation>
 </semantics>
</math>

 must hold. So when the chosen <strong>f</strong> is not invertible, Bob has to go back and try another <strong>f</strong>.</p>

<p>Both <strong>f</strong> and 

<math display="inline" id="NTRUEncrypt:11">
 <semantics>
  <msub>
   <mpadded lspace="5pt" width="+5pt">
    <mi>ùêü</mi>
   </mpadded>
   <mi>p</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>ùêü</ci>
    <ci>p</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \ \mathbf{f}_{p}
  </annotation>
 </semantics>
</math>

 are Bob‚Äôs private key. The public key <strong>h</strong> is generated computing the quantity</p>

<p>

<math display="block" id="NTRUEncrypt:12">
 <semantics>
  <mrow>
   <mrow>
    <mtext>ùê°</mtext>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mrow>
       <mi>p</mi>
       <msub>
        <mtext>ùêü</mtext>
        <mi>q</mi>
       </msub>
      </mrow>
      <mo>‚ãÖ</mo>
      <mtext>ùê†</mtext>
     </mrow>
     <mspace width="veryverythickmathspace">
     </mspace>
     <mrow>
      <mo lspace="8.1pt" stretchy="false">(</mo>
      <mrow>
       <mo>mod</mo>
       <mi>q</mi>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <mtext>h</mtext>
    <apply>
     <csymbol cd="latexml">annotated</csymbol>
     <apply>
      <ci>normal-‚ãÖ</ci>
      <apply>
       <times></times>
       <ci>p</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <mtext>f</mtext>
        <ci>q</ci>
       </apply>
      </apply>
      <mtext>g</mtext>
     </apply>
     <apply>
      <ci>pmod</ci>
      <ci>q</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \textbf{h}=p\textbf{f}_{q}\cdot\textbf{g}\;\;(\mathop{{\rm mod}}q).
  </annotation>
 </semantics>
</math>

</p>

<p><strong>Example</strong>: In this example the parameters (<em>N</em>, <em>p</em>, <em>q</em>) will have the values <em>N</em> = 11, <em>p</em> = 3 and <em>q</em> = 32 and therefore the polynomials <strong>f</strong> and <strong>g</strong> are of degree at most 10. The system parameters (<em>N</em>, <em>p</em>, <em>q</em>) are known to everybody. The polynomials are randomly chosen, so suppose they are represented by</p>

<p>

<math display="block" id="NTRUEncrypt:13">
 <semantics>
  <mrow>
   <mtext>ùêü</mtext>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mrow>
      <mrow>
       <mrow>
        <mo>-</mo>
        <mn>1</mn>
       </mrow>
       <mo>+</mo>
       <mi>X</mi>
       <mo>+</mo>
       <msup>
        <mi>X</mi>
        <mn>2</mn>
       </msup>
      </mrow>
      <mo>-</mo>
      <msup>
       <mi>X</mi>
       <mn>4</mn>
      </msup>
     </mrow>
     <mo>+</mo>
     <msup>
      <mi>X</mi>
      <mn>6</mn>
     </msup>
     <mo>+</mo>
     <msup>
      <mi>X</mi>
      <mn>9</mn>
     </msup>
    </mrow>
    <mo>-</mo>
    <msup>
     <mi>X</mi>
     <mn>10</mn>
    </msup>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <mtext>f</mtext>
    <apply>
     <minus></minus>
     <apply>
      <plus></plus>
      <apply>
       <minus></minus>
       <apply>
        <plus></plus>
        <apply>
         <minus></minus>
         <cn type="integer">1</cn>
        </apply>
        <ci>X</ci>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>X</ci>
         <cn type="integer">2</cn>
        </apply>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>X</ci>
        <cn type="integer">4</cn>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>X</ci>
       <cn type="integer">6</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>X</ci>
       <cn type="integer">9</cn>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>X</ci>
      <cn type="integer">10</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \textbf{f}=-1+X+X^{2}-X^{4}+X^{6}+X^{9}-X^{10}
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="NTRUEncrypt:14">
 <semantics>
  <mrow>
   <mtext>ùê†</mtext>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mrow>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
     <mo>+</mo>
     <msup>
      <mi>X</mi>
      <mn>2</mn>
     </msup>
     <mo>+</mo>
     <msup>
      <mi>X</mi>
      <mn>3</mn>
     </msup>
     <mo>+</mo>
     <msup>
      <mi>X</mi>
      <mn>5</mn>
     </msup>
    </mrow>
    <mo>-</mo>
    <msup>
     <mi>X</mi>
     <mn>8</mn>
    </msup>
    <mo>-</mo>
    <msup>
     <mi>X</mi>
     <mn>10</mn>
    </msup>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <mtext>g</mtext>
    <apply>
     <minus></minus>
     <apply>
      <plus></plus>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>X</ci>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>X</ci>
       <cn type="integer">3</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>X</ci>
       <cn type="integer">5</cn>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>X</ci>
      <cn type="integer">8</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>X</ci>
      <cn type="integer">10</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \textbf{g}=-1+X^{2}+X^{3}+X^{5}-X^{8}-X^{10}
  </annotation>
 </semantics>
</math>

</p>

<p>Using the Euclidean algorithm the inverse of <strong>f</strong> modulo <em>p</em> and modulo <em>q</em>, respectively, is computed</p>

<p>

<math display="block" id="NTRUEncrypt:15">
 <semantics>
  <mrow>
   <msub>
    <mtext>ùêü</mtext>
    <mi>p</mi>
   </msub>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mn>1</mn>
     <mo>+</mo>
     <mrow>
      <mn>2</mn>
      <mi>X</mi>
     </mrow>
     <mo>+</mo>
     <mrow>
      <mn>2</mn>
      <msup>
       <mi>X</mi>
       <mn>3</mn>
      </msup>
     </mrow>
     <mo>+</mo>
     <mrow>
      <mn>2</mn>
      <msup>
       <mi>X</mi>
       <mn>4</mn>
      </msup>
     </mrow>
     <mo>+</mo>
     <msup>
      <mi>X</mi>
      <mn>5</mn>
     </msup>
     <mo>+</mo>
     <mrow>
      <mn>2</mn>
      <msup>
       <mi>X</mi>
       <mn>7</mn>
      </msup>
     </mrow>
     <mo>+</mo>
     <msup>
      <mi>X</mi>
      <mn>8</mn>
     </msup>
     <mo>+</mo>
     <mrow>
      <mn>2</mn>
      <msup>
       <mi>X</mi>
       <mn>9</mn>
      </msup>
     </mrow>
    </mrow>
    <mspace width="veryverythickmathspace">
    </mspace>
    <mrow>
     <mo lspace="8.1pt" stretchy="false">(</mo>
     <mrow>
      <mo>mod</mo>
      <mn>3</mn>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <mtext>f</mtext>
     <ci>p</ci>
    </apply>
    <apply>
     <csymbol cd="latexml">annotated</csymbol>
     <apply>
      <plus></plus>
      <cn type="integer">1</cn>
      <apply>
       <times></times>
       <cn type="integer">2</cn>
       <ci>X</ci>
      </apply>
      <apply>
       <times></times>
       <cn type="integer">2</cn>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>X</ci>
        <cn type="integer">3</cn>
       </apply>
      </apply>
      <apply>
       <times></times>
       <cn type="integer">2</cn>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>X</ci>
        <cn type="integer">4</cn>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>X</ci>
       <cn type="integer">5</cn>
      </apply>
      <apply>
       <times></times>
       <cn type="integer">2</cn>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>X</ci>
        <cn type="integer">7</cn>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>X</ci>
       <cn type="integer">8</cn>
      </apply>
      <apply>
       <times></times>
       <cn type="integer">2</cn>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>X</ci>
        <cn type="integer">9</cn>
       </apply>
      </apply>
     </apply>
     <apply>
      <ci>pmod</ci>
      <cn type="integer">3</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \textbf{f}_{p}=1+2X+2X^{3}+2X^{4}+X^{5}+2X^{7}+X^{8}+2X^{9}\;\;(\mathop{{\rm
mod%
}}3)
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="NTRUEncrypt:16">
 <semantics>
  <mrow>
   <msub>
    <mtext>ùêü</mtext>
    <mi>q</mi>
   </msub>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mn>5</mn>
     <mo>+</mo>
     <mrow>
      <mn>9</mn>
      <mi>X</mi>
     </mrow>
     <mo>+</mo>
     <mrow>
      <mn>6</mn>
      <msup>
       <mi>X</mi>
       <mn>2</mn>
      </msup>
     </mrow>
     <mo>+</mo>
     <mrow>
      <mn>16</mn>
      <msup>
       <mi>X</mi>
       <mn>3</mn>
      </msup>
     </mrow>
     <mo>+</mo>
     <mrow>
      <mn>4</mn>
      <msup>
       <mi>X</mi>
       <mn>4</mn>
      </msup>
     </mrow>
     <mo>+</mo>
     <mrow>
      <mn>15</mn>
      <msup>
       <mi>X</mi>
       <mn>5</mn>
      </msup>
     </mrow>
     <mo>+</mo>
     <mrow>
      <mn>16</mn>
      <msup>
       <mi>X</mi>
       <mn>6</mn>
      </msup>
     </mrow>
     <mo>+</mo>
     <mrow>
      <mn>22</mn>
      <msup>
       <mi>X</mi>
       <mn>7</mn>
      </msup>
     </mrow>
     <mo>+</mo>
     <mrow>
      <mn>20</mn>
      <msup>
       <mi>X</mi>
       <mn>8</mn>
      </msup>
     </mrow>
     <mo>+</mo>
     <mrow>
      <mn>18</mn>
      <msup>
       <mi>X</mi>
       <mn>9</mn>
      </msup>
     </mrow>
     <mo>+</mo>
     <mrow>
      <mn>30</mn>
      <msup>
       <mi>X</mi>
       <mn>10</mn>
      </msup>
     </mrow>
    </mrow>
    <mspace width="veryverythickmathspace">
    </mspace>
    <mrow>
     <mo lspace="8.1pt" stretchy="false">(</mo>
     <mrow>
      <mo>mod</mo>
      <mn>32</mn>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <mtext>f</mtext>
     <ci>q</ci>
    </apply>
    <apply>
     <csymbol cd="latexml">annotated</csymbol>
     <apply>
      <plus></plus>
      <cn type="integer">5</cn>
      <apply>
       <times></times>
       <cn type="integer">9</cn>
       <ci>X</ci>
      </apply>
      <apply>
       <times></times>
       <cn type="integer">6</cn>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>X</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
      <apply>
       <times></times>
       <cn type="integer">16</cn>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>X</ci>
        <cn type="integer">3</cn>
       </apply>
      </apply>
      <apply>
       <times></times>
       <cn type="integer">4</cn>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>X</ci>
        <cn type="integer">4</cn>
       </apply>
      </apply>
      <apply>
       <times></times>
       <cn type="integer">15</cn>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>X</ci>
        <cn type="integer">5</cn>
       </apply>
      </apply>
      <apply>
       <times></times>
       <cn type="integer">16</cn>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>X</ci>
        <cn type="integer">6</cn>
       </apply>
      </apply>
      <apply>
       <times></times>
       <cn type="integer">22</cn>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>X</ci>
        <cn type="integer">7</cn>
       </apply>
      </apply>
      <apply>
       <times></times>
       <cn type="integer">20</cn>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>X</ci>
        <cn type="integer">8</cn>
       </apply>
      </apply>
      <apply>
       <times></times>
       <cn type="integer">18</cn>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>X</ci>
        <cn type="integer">9</cn>
       </apply>
      </apply>
      <apply>
       <times></times>
       <cn type="integer">30</cn>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>X</ci>
        <cn type="integer">10</cn>
       </apply>
      </apply>
     </apply>
     <apply>
      <ci>pmod</ci>
      <cn type="integer">32</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \textbf{f}_{q}=5+9X+6X^{2}+16X^{3}+4X^{4}+15X^{5}+16X^{6}+22X^{7}+20X^{8}+18X^%
{9}+30X^{10}\;\;(\mathop{{\rm mod}}32)
  </annotation>
 </semantics>
</math>

</p>

<p>Which creates the public key <strong>h</strong> (known to both Alice and Bob) computing the product</p>

<p>

<math display="block" id="NTRUEncrypt:17">
 <semantics>
  <mrow>
   <mtext>ùê°</mtext>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mrow>
      <mi>p</mi>
      <msub>
       <mtext>ùêü</mtext>
       <mi>q</mi>
      </msub>
     </mrow>
     <mo>‚ãÖ</mo>
     <mtext>ùê†</mtext>
    </mrow>
    <mspace width="veryverythickmathspace">
    </mspace>
    <mrow>
     <mo lspace="8.1pt" stretchy="false">(</mo>
     <mrow>
      <mo>mod</mo>
      <mn>32</mn>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mrow>
      <mrow>
       <mrow>
        <mrow>
         <mrow>
          <mrow>
           <mrow>
            <mn>8</mn>
            <mo>-</mo>
            <mrow>
             <mn>7</mn>
             <mi>X</mi>
            </mrow>
            <mo>-</mo>
            <mrow>
             <mn>10</mn>
             <msup>
              <mi>X</mi>
              <mn>2</mn>
             </msup>
            </mrow>
            <mo>-</mo>
            <mrow>
             <mn>12</mn>
             <msup>
              <mi>X</mi>
              <mn>3</mn>
             </msup>
            </mrow>
           </mrow>
           <mo>+</mo>
           <mrow>
            <mn>12</mn>
            <msup>
             <mi>X</mi>
             <mn>4</mn>
            </msup>
           </mrow>
          </mrow>
          <mo>-</mo>
          <mrow>
           <mn>8</mn>
           <msup>
            <mi>X</mi>
            <mn>5</mn>
           </msup>
          </mrow>
         </mrow>
         <mo>+</mo>
         <mrow>
          <mn>15</mn>
          <msup>
           <mi>X</mi>
           <mn>6</mn>
          </msup>
         </mrow>
        </mrow>
        <mo>-</mo>
        <mrow>
         <mn>13</mn>
         <msup>
          <mi>X</mi>
          <mn>7</mn>
         </msup>
        </mrow>
       </mrow>
       <mo>+</mo>
       <mrow>
        <mn>12</mn>
        <msup>
         <mi>X</mi>
         <mn>8</mn>
        </msup>
       </mrow>
      </mrow>
      <mo>-</mo>
      <mrow>
       <mn>13</mn>
       <msup>
        <mi>X</mi>
        <mn>9</mn>
       </msup>
      </mrow>
     </mrow>
     <mo>+</mo>
     <mrow>
      <mn>16</mn>
      <msup>
       <mi>X</mi>
       <mn>10</mn>
      </msup>
     </mrow>
    </mrow>
    <mspace width="veryverythickmathspace">
    </mspace>
    <mrow>
     <mo lspace="8.1pt" stretchy="false">(</mo>
     <mrow>
      <mo>mod</mo>
      <mn>32</mn>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <mtext>h</mtext>
     <apply>
      <csymbol cd="latexml">annotated</csymbol>
      <apply>
       <ci>normal-‚ãÖ</ci>
       <apply>
        <times></times>
        <ci>p</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <mtext>f</mtext>
         <ci>q</ci>
        </apply>
       </apply>
       <mtext>g</mtext>
      </apply>
      <apply>
       <ci>pmod</ci>
       <cn type="integer">32</cn>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <csymbol cd="latexml">annotated</csymbol>
      <apply>
       <plus></plus>
       <apply>
        <minus></minus>
        <apply>
         <plus></plus>
         <apply>
          <minus></minus>
          <apply>
           <plus></plus>
           <apply>
            <minus></minus>
            <apply>
             <plus></plus>
             <apply>
              <minus></minus>
              <cn type="integer">8</cn>
              <apply>
               <times></times>
               <cn type="integer">7</cn>
               <ci>X</ci>
              </apply>
              <apply>
               <times></times>
               <cn type="integer">10</cn>
               <apply>
                <csymbol cd="ambiguous">superscript</csymbol>
                <ci>X</ci>
                <cn type="integer">2</cn>
               </apply>
              </apply>
              <apply>
               <times></times>
               <cn type="integer">12</cn>
               <apply>
                <csymbol cd="ambiguous">superscript</csymbol>
                <ci>X</ci>
                <cn type="integer">3</cn>
               </apply>
              </apply>
             </apply>
             <apply>
              <times></times>
              <cn type="integer">12</cn>
              <apply>
               <csymbol cd="ambiguous">superscript</csymbol>
               <ci>X</ci>
               <cn type="integer">4</cn>
              </apply>
             </apply>
            </apply>
            <apply>
             <times></times>
             <cn type="integer">8</cn>
             <apply>
              <csymbol cd="ambiguous">superscript</csymbol>
              <ci>X</ci>
              <cn type="integer">5</cn>
             </apply>
            </apply>
           </apply>
           <apply>
            <times></times>
            <cn type="integer">15</cn>
            <apply>
             <csymbol cd="ambiguous">superscript</csymbol>
             <ci>X</ci>
             <cn type="integer">6</cn>
            </apply>
           </apply>
          </apply>
          <apply>
           <times></times>
           <cn type="integer">13</cn>
           <apply>
            <csymbol cd="ambiguous">superscript</csymbol>
            <ci>X</ci>
            <cn type="integer">7</cn>
           </apply>
          </apply>
         </apply>
         <apply>
          <times></times>
          <cn type="integer">12</cn>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <ci>X</ci>
           <cn type="integer">8</cn>
          </apply>
         </apply>
        </apply>
        <apply>
         <times></times>
         <cn type="integer">13</cn>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>X</ci>
          <cn type="integer">9</cn>
         </apply>
        </apply>
       </apply>
       <apply>
        <times></times>
        <cn type="integer">16</cn>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>X</ci>
         <cn type="integer">10</cn>
        </apply>
       </apply>
      </apply>
      <apply>
       <ci>pmod</ci>
       <cn type="integer">32</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \textbf{h}=p\textbf{f}_{q}\cdot\textbf{g}\;\;(\mathop{{\rm mod}}32)=8-7X-10X^{%
2}-12X^{3}+12X^{4}-8X^{5}+15X^{6}-13X^{7}+12X^{8}-13X^{9}+16X^{10}\;\;(\mathop%
{{\rm mod}}32)
  </annotation>
 </semantics>
</math>

</p>
<h2 id="encryption">Encryption</h2>

<p>Alice, who wants to send a secret message to Bob, puts her message in the form of a polynomial <strong>m</strong> with coefficients {-1,0,1}. In modern applications of the encryption, the message polynomial can be translated in a binary or ternary representation. After creating the message polynomial, Alice chooses randomly a polynomial <strong>r</strong> with small coefficients (not restricted to the set {-1,0,1}), that is meant to obscure the message.</p>

<p>With Bob‚Äôs public key <strong>h</strong> the encrypted message <strong>e</strong> is computed:</p>

<p>

<math display="block" id="NTRUEncrypt:18">
 <semantics>
  <mrow>
   <mtext>ùêû</mtext>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mrow>
      <mtext>ùê´</mtext>
      <mo>‚ãÖ</mo>
      <mtext>ùê°</mtext>
     </mrow>
     <mo>+</mo>
     <mtext>ùê¶</mtext>
    </mrow>
    <mspace width="veryverythickmathspace">
    </mspace>
    <mrow>
     <mo lspace="8.1pt" stretchy="false">(</mo>
     <mrow>
      <mo>mod</mo>
      <mi>q</mi>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <mtext>e</mtext>
    <apply>
     <csymbol cd="latexml">annotated</csymbol>
     <apply>
      <plus></plus>
      <apply>
       <ci>normal-‚ãÖ</ci>
       <mtext>r</mtext>
       <mtext>h</mtext>
      </apply>
      <mtext>m</mtext>
     </apply>
     <apply>
      <ci>pmod</ci>
      <ci>q</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \textbf{e}=\textbf{r}\cdot\textbf{h}+\textbf{m}\;\;(\mathop{{\rm mod}}q)
  </annotation>
 </semantics>
</math>

</p>

<p>This ciphertext hides Alice‚Äôs messages and can be sent safely to Bob.</p>

<p><strong>Example</strong>: Assume that Alice wants to send a message that can be written as polynomial</p>

<p>

<math display="block" id="NTRUEncrypt:19">
 <semantics>
  <mrow>
   <mtext>ùê¶</mtext>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mrow>
      <mrow>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
      <mo>+</mo>
      <msup>
       <mi>X</mi>
       <mn>3</mn>
      </msup>
     </mrow>
     <mo>-</mo>
     <msup>
      <mi>X</mi>
      <mn>4</mn>
     </msup>
     <mo>-</mo>
     <msup>
      <mi>X</mi>
      <mn>8</mn>
     </msup>
    </mrow>
    <mo>+</mo>
    <msup>
     <mi>X</mi>
     <mn>9</mn>
    </msup>
    <mo>+</mo>
    <msup>
     <mi>X</mi>
     <mn>10</mn>
    </msup>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <mtext>m</mtext>
    <apply>
     <plus></plus>
     <apply>
      <minus></minus>
      <apply>
       <plus></plus>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>X</ci>
        <cn type="integer">3</cn>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>X</ci>
       <cn type="integer">4</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>X</ci>
       <cn type="integer">8</cn>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>X</ci>
      <cn type="integer">9</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>X</ci>
      <cn type="integer">10</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \textbf{m}=-1+X^{3}-X^{4}-X^{8}+X^{9}+X^{10}
  </annotation>
 </semantics>
</math>

 and that the randomly chosen ‚Äòblinding value‚Äô can be expressed as</p>

<p>

<math display="block" id="NTRUEncrypt:20">
 <semantics>
  <mrow>
   <mtext>ùê´</mtext>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mrow>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
     <mo>+</mo>
     <msup>
      <mi>X</mi>
      <mn>2</mn>
     </msup>
     <mo>+</mo>
     <msup>
      <mi>X</mi>
      <mn>3</mn>
     </msup>
     <mo>+</mo>
     <msup>
      <mi>X</mi>
      <mn>4</mn>
     </msup>
    </mrow>
    <mo>-</mo>
    <msup>
     <mi>X</mi>
     <mn>5</mn>
    </msup>
    <mo>-</mo>
    <msup>
     <mi>X</mi>
     <mn>7</mn>
    </msup>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <mtext>r</mtext>
    <apply>
     <minus></minus>
     <apply>
      <plus></plus>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>X</ci>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>X</ci>
       <cn type="integer">3</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>X</ci>
       <cn type="integer">4</cn>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>X</ci>
      <cn type="integer">5</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>X</ci>
      <cn type="integer">7</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \textbf{r}=-1+X^{2}+X^{3}+X^{4}-X^{5}-X^{7}
  </annotation>
 </semantics>
</math>

</p>

<p>The ciphertext <strong>e</strong> that represents her encrypted message to Bob will look like</p>

<p>

<math display="block" id="NTRUEncrypt:21">
 <semantics>
  <mrow>
   <mtext>ùêû</mtext>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mrow>
      <mtext>ùê´</mtext>
      <mo>‚ãÖ</mo>
      <mtext>ùê°</mtext>
     </mrow>
     <mo>+</mo>
     <mtext>ùê¶</mtext>
    </mrow>
    <mspace width="veryverythickmathspace">
    </mspace>
    <mrow>
     <mo lspace="8.1pt" stretchy="false">(</mo>
     <mrow>
      <mo>mod</mo>
      <mn>32</mn>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mn>14</mn>
     <mo>+</mo>
     <mrow>
      <mn>11</mn>
      <mi>X</mi>
     </mrow>
     <mo>+</mo>
     <mrow>
      <mn>26</mn>
      <msup>
       <mi>X</mi>
       <mn>2</mn>
      </msup>
     </mrow>
     <mo>+</mo>
     <mrow>
      <mn>24</mn>
      <msup>
       <mi>X</mi>
       <mn>3</mn>
      </msup>
     </mrow>
     <mo>+</mo>
     <mrow>
      <mn>14</mn>
      <msup>
       <mi>X</mi>
       <mn>4</mn>
      </msup>
     </mrow>
     <mo>+</mo>
     <mrow>
      <mn>16</mn>
      <msup>
       <mi>X</mi>
       <mn>5</mn>
      </msup>
     </mrow>
     <mo>+</mo>
     <mrow>
      <mn>30</mn>
      <msup>
       <mi>X</mi>
       <mn>6</mn>
      </msup>
     </mrow>
     <mo>+</mo>
     <mrow>
      <mn>7</mn>
      <msup>
       <mi>X</mi>
       <mn>7</mn>
      </msup>
     </mrow>
     <mo>+</mo>
     <mrow>
      <mn>25</mn>
      <msup>
       <mi>X</mi>
       <mn>8</mn>
      </msup>
     </mrow>
     <mo>+</mo>
     <mrow>
      <mn>6</mn>
      <msup>
       <mi>X</mi>
       <mn>9</mn>
      </msup>
     </mrow>
     <mo>+</mo>
     <mrow>
      <mn>19</mn>
      <msup>
       <mi>X</mi>
       <mn>10</mn>
      </msup>
     </mrow>
    </mrow>
    <mspace width="veryverythickmathspace">
    </mspace>
    <mrow>
     <mo lspace="8.1pt" stretchy="false">(</mo>
     <mrow>
      <mo>mod</mo>
      <mn>32</mn>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <mtext>e</mtext>
     <apply>
      <csymbol cd="latexml">annotated</csymbol>
      <apply>
       <plus></plus>
       <apply>
        <ci>normal-‚ãÖ</ci>
        <mtext>r</mtext>
        <mtext>h</mtext>
       </apply>
       <mtext>m</mtext>
      </apply>
      <apply>
       <ci>pmod</ci>
       <cn type="integer">32</cn>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <csymbol cd="latexml">annotated</csymbol>
      <apply>
       <plus></plus>
       <cn type="integer">14</cn>
       <apply>
        <times></times>
        <cn type="integer">11</cn>
        <ci>X</ci>
       </apply>
       <apply>
        <times></times>
        <cn type="integer">26</cn>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>X</ci>
         <cn type="integer">2</cn>
        </apply>
       </apply>
       <apply>
        <times></times>
        <cn type="integer">24</cn>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>X</ci>
         <cn type="integer">3</cn>
        </apply>
       </apply>
       <apply>
        <times></times>
        <cn type="integer">14</cn>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>X</ci>
         <cn type="integer">4</cn>
        </apply>
       </apply>
       <apply>
        <times></times>
        <cn type="integer">16</cn>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>X</ci>
         <cn type="integer">5</cn>
        </apply>
       </apply>
       <apply>
        <times></times>
        <cn type="integer">30</cn>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>X</ci>
         <cn type="integer">6</cn>
        </apply>
       </apply>
       <apply>
        <times></times>
        <cn type="integer">7</cn>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>X</ci>
         <cn type="integer">7</cn>
        </apply>
       </apply>
       <apply>
        <times></times>
        <cn type="integer">25</cn>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>X</ci>
         <cn type="integer">8</cn>
        </apply>
       </apply>
       <apply>
        <times></times>
        <cn type="integer">6</cn>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>X</ci>
         <cn type="integer">9</cn>
        </apply>
       </apply>
       <apply>
        <times></times>
        <cn type="integer">19</cn>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>X</ci>
         <cn type="integer">10</cn>
        </apply>
       </apply>
      </apply>
      <apply>
       <ci>pmod</ci>
       <cn type="integer">32</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \textbf{e}=\textbf{r}\cdot\textbf{h}+\textbf{m}\;\;(\mathop{{\rm mod}}32)=14+1%
1X+26X^{2}+24X^{3}+14X^{4}+16X^{5}+30X^{6}+7X^{7}+25X^{8}+6X^{9}+19X^{10}\;\;(%
\mathop{{\rm mod}}32)
  </annotation>
 </semantics>
</math>

</p>
<h2 id="decryption">Decryption</h2>

<p>Anybody knowing <strong>r</strong> could compute the message <strong>m</strong>; so <strong>r</strong> must not be revealed by Alice. In addition to the publicly available information, Bob knows his own private key. Here is how he can obtain <strong>m</strong>: First he multiplies the encrypted message <strong>e</strong> and part of his private key <strong>f</strong></p>

<p>

<math display="block" id="NTRUEncrypt:22">
 <semantics>
  <mrow>
   <mtext>ùêö</mtext>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mtext>ùêü</mtext>
     <mo>‚ãÖ</mo>
     <mtext>ùêû</mtext>
    </mrow>
    <mspace width="veryverythickmathspace">
    </mspace>
    <mrow>
     <mo lspace="8.1pt" stretchy="false">(</mo>
     <mrow>
      <mo>mod</mo>
      <mi>q</mi>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <mtext>a</mtext>
    <apply>
     <csymbol cd="latexml">annotated</csymbol>
     <apply>
      <ci>normal-‚ãÖ</ci>
      <mtext>f</mtext>
      <mtext>e</mtext>
     </apply>
     <apply>
      <ci>pmod</ci>
      <ci>q</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \textbf{a}=\textbf{f}\cdot\textbf{e}\;\;(\mathop{{\rm mod}}q)
  </annotation>
 </semantics>
</math>

</p>

<p>By rewriting the polynomials, this equation is actually representing the following computation:</p>

<p>

<math display="block" id="NTRUEncrypt:23">
 <semantics>
  <mrow>
   <mtext>ùêö</mtext>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mtext>ùêü</mtext>
     <mo>‚ãÖ</mo>
     <mtext>ùêû</mtext>
    </mrow>
    <mspace width="veryverythickmathspace">
    </mspace>
    <mrow>
     <mo lspace="8.1pt" stretchy="false">(</mo>
     <mrow>
      <mo>mod</mo>
      <mi>q</mi>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <mtext>a</mtext>
    <apply>
     <csymbol cd="latexml">annotated</csymbol>
     <apply>
      <ci>normal-‚ãÖ</ci>
      <mtext>f</mtext>
      <mtext>e</mtext>
     </apply>
     <apply>
      <ci>pmod</ci>
      <ci>q</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \textbf{a}=\textbf{f}\cdot\textbf{e}\;\;(\mathop{{\rm mod}}q)
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="NTRUEncrypt:24">
 <semantics>
  <mrow>
   <mtext>ùêö</mtext>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mtext>ùêü</mtext>
     <mo>‚ãÖ</mo>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mrow>
        <mtext>ùê´</mtext>
        <mo>‚ãÖ</mo>
        <mtext>ùê°</mtext>
       </mrow>
       <mo>+</mo>
       <mtext>ùê¶</mtext>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mspace width="veryverythickmathspace">
    </mspace>
    <mrow>
     <mo lspace="8.1pt" stretchy="false">(</mo>
     <mrow>
      <mo>mod</mo>
      <mi>q</mi>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <mtext>a</mtext>
    <apply>
     <csymbol cd="latexml">annotated</csymbol>
     <apply>
      <ci>normal-‚ãÖ</ci>
      <mtext>f</mtext>
      <apply>
       <plus></plus>
       <apply>
        <ci>normal-‚ãÖ</ci>
        <mtext>r</mtext>
        <mtext>h</mtext>
       </apply>
       <mtext>m</mtext>
      </apply>
     </apply>
     <apply>
      <ci>pmod</ci>
      <ci>q</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \textbf{a}=\textbf{f}\cdot(\textbf{r}\cdot\textbf{h}+\textbf{m})\;\;(\mathop{{%
\rm mod}}q)
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="NTRUEncrypt:25">
 <semantics>
  <mrow>
   <mtext>ùêö</mtext>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mtext>ùêü</mtext>
     <mo>‚ãÖ</mo>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mrow>
        <mrow>
         <mrow>
          <mtext>ùê´</mtext>
          <mo>‚ãÖ</mo>
          <mi>p</mi>
         </mrow>
         <msub>
          <mtext>ùêü</mtext>
          <mi>q</mi>
         </msub>
        </mrow>
        <mo>‚ãÖ</mo>
        <mtext>ùê†</mtext>
       </mrow>
       <mo>+</mo>
       <mtext>ùê¶</mtext>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mspace width="veryverythickmathspace">
    </mspace>
    <mrow>
     <mo lspace="8.1pt" stretchy="false">(</mo>
     <mrow>
      <mo>mod</mo>
      <mi>q</mi>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <mtext>a</mtext>
    <apply>
     <csymbol cd="latexml">annotated</csymbol>
     <apply>
      <ci>normal-‚ãÖ</ci>
      <mtext>f</mtext>
      <apply>
       <plus></plus>
       <apply>
        <ci>normal-‚ãÖ</ci>
        <apply>
         <times></times>
         <apply>
          <ci>normal-‚ãÖ</ci>
          <mtext>r</mtext>
          <ci>p</ci>
         </apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <mtext>f</mtext>
          <ci>q</ci>
         </apply>
        </apply>
        <mtext>g</mtext>
       </apply>
       <mtext>m</mtext>
      </apply>
     </apply>
     <apply>
      <ci>pmod</ci>
      <ci>q</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \textbf{a}=\textbf{f}\cdot(\textbf{r}\cdot p\textbf{f}_{q}\cdot\textbf{g}+%
\textbf{m})\;\;(\mathop{{\rm mod}}q)
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="NTRUEncrypt:26">
 <semantics>
  <mrow>
   <mtext>ùêö</mtext>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mrow>
      <mrow>
       <mi>p</mi>
       <mtext>ùê´</mtext>
      </mrow>
      <mo>‚ãÖ</mo>
      <mtext>ùê†</mtext>
     </mrow>
     <mo>+</mo>
     <mrow>
      <mtext>ùêü</mtext>
      <mo>‚ãÖ</mo>
      <mtext>ùê¶</mtext>
     </mrow>
    </mrow>
    <mspace width="veryverythickmathspace">
    </mspace>
    <mrow>
     <mo lspace="8.1pt" stretchy="false">(</mo>
     <mrow>
      <mo>mod</mo>
      <mi>q</mi>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <mtext>a</mtext>
    <apply>
     <csymbol cd="latexml">annotated</csymbol>
     <apply>
      <plus></plus>
      <apply>
       <ci>normal-‚ãÖ</ci>
       <apply>
        <times></times>
        <ci>p</ci>
        <mtext>r</mtext>
       </apply>
       <mtext>g</mtext>
      </apply>
      <apply>
       <ci>normal-‚ãÖ</ci>
       <mtext>f</mtext>
       <mtext>m</mtext>
      </apply>
     </apply>
     <apply>
      <ci>pmod</ci>
      <ci>q</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \textbf{a}=p\textbf{r}\cdot\textbf{g}+\textbf{f}\cdot\textbf{m}\;\;(\mathop{{%
\rm mod}}q)
  </annotation>
 </semantics>
</math>

</p>

<p>Instead of choosing the coefficients of <strong>a</strong> between 0 and <em>q</em> ‚Äì 1 they are chosen in the interval [-<em>q</em>/2, <em>q</em>/2] to prevent that the original message may not be properly recovered since Alice chooses the coordinates of her message <strong>m</strong> in the interval [-<em>p</em>/2, <em>p</em>/2]. This implies that all coefficients of 

<math display="inline" id="NTRUEncrypt:27">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mpadded lspace="5pt" width="+5pt">
      <mi>p</mi>
     </mpadded>
     <mtext>ùê´</mtext>
    </mrow>
    <mo>‚ãÖ</mo>
    <mtext>ùê†</mtext>
   </mrow>
   <mo>+</mo>
   <mrow>
    <mtext>ùêü</mtext>
    <mo>‚ãÖ</mo>
    <mtext>ùê¶</mtext>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <plus></plus>
    <apply>
     <ci>normal-‚ãÖ</ci>
     <apply>
      <times></times>
      <ci>p</ci>
      <mtext>r</mtext>
     </apply>
     <mtext>g</mtext>
    </apply>
    <apply>
     <ci>normal-‚ãÖ</ci>
     <mtext>f</mtext>
     <mtext>m</mtext>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \ p\textbf{r}\cdot\textbf{g}+\textbf{f}\cdot\textbf{m}
  </annotation>
 </semantics>
</math>

 already lie within the interval [-<em>q</em>/2, <em>q</em>/2] because the polynomials <strong>r</strong>, <strong>g</strong>, <strong>f</strong> and <strong>m</strong> and prime <em>p</em> all have coefficients that are small compared to <em>q</em>. This means that all coefficients are left unchanged during reducing modulo <em>q</em> and that the original message may be recovered properly.</p>

<p>The next step will be to calculate <strong>a</strong> modulo <em>p</em>:</p>

<p>

<math display="block" id="NTRUEncrypt:28">
 <semantics>
  <mrow>
   <mtext>ùêõ</mtext>
   <mo>=</mo>
   <mrow>
    <mtext>ùêö</mtext>
    <mspace width="veryverythickmathspace">
    </mspace>
    <mrow>
     <mo lspace="8.1pt" stretchy="false">(</mo>
     <mrow>
      <mo>mod</mo>
      <mi>p</mi>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mtext>ùêü</mtext>
     <mo>‚ãÖ</mo>
     <mtext>ùê¶</mtext>
    </mrow>
    <mspace width="veryverythickmathspace">
    </mspace>
    <mrow>
     <mo lspace="8.1pt" stretchy="false">(</mo>
     <mrow>
      <mo>mod</mo>
      <mi>p</mi>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <mtext>b</mtext>
     <apply>
      <csymbol cd="latexml">annotated</csymbol>
      <mtext>a</mtext>
      <apply>
       <ci>pmod</ci>
       <ci>p</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <csymbol cd="latexml">annotated</csymbol>
      <apply>
       <ci>normal-‚ãÖ</ci>
       <mtext>f</mtext>
       <mtext>m</mtext>
      </apply>
      <apply>
       <ci>pmod</ci>
       <ci>p</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \textbf{b}=\textbf{a}\;\;(\mathop{{\rm mod}}p)=\textbf{f}\cdot\textbf{m}\;\;(%
\mathop{{\rm mod}}p)
  </annotation>
 </semantics>
</math>

 because 

<math display="inline" id="NTRUEncrypt:29">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mrow>
      <mpadded lspace="5pt" width="+5pt">
       <mi>p</mi>
      </mpadded>
      <mtext>ùê´</mtext>
     </mrow>
     <mo>‚ãÖ</mo>
     <mtext>ùê†</mtext>
    </mrow>
    <mspace width="veryverythickmathspace">
    </mspace>
    <mrow>
     <mo lspace="8.1pt" stretchy="false">(</mo>
     <mrow>
      <mo>mod</mo>
      <mi>p</mi>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="latexml">annotated</csymbol>
     <apply>
      <ci>normal-‚ãÖ</ci>
      <apply>
       <times></times>
       <ci>p</ci>
       <mtext>r</mtext>
      </apply>
      <mtext>g</mtext>
     </apply>
     <apply>
      <ci>pmod</ci>
      <ci>p</ci>
     </apply>
    </apply>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \ p\textbf{r}\cdot\textbf{g}\;\;(\mathop{{\rm mod}}p)=0
  </annotation>
 </semantics>
</math>

.</p>

<p>Knowing <strong>b</strong> Bob can use the other part of his private key 

<math display="inline" id="NTRUEncrypt:30">
 <semantics>
  <mrow>
   <mo lspace="7.5pt">(</mo>
   <msub>
    <mtext>ùêü</mtext>
    <mi>p</mi>
   </msub>
   <mo>)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <mtext>f</mtext>
    <ci>p</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \ \left(\textbf{f}_{p}\right)
  </annotation>
 </semantics>
</math>

 to recover Alice‚Äôs message by multiplication of <strong>b</strong> and 

<math display="inline" id="NTRUEncrypt:31">
 <semantics>
  <msub>
   <mpadded lspace="5pt" width="+5pt">
    <mtext>ùêü</mtext>
   </mpadded>
   <mi>p</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <mtext>f</mtext>
    <ci>p</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \ \textbf{f}_{p}
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="NTRUEncrypt:32">
 <semantics>
  <mrow>
   <mtext>ùêú</mtext>
   <mo>=</mo>
   <mrow>
    <msub>
     <mtext>ùêü</mtext>
     <mi>p</mi>
    </msub>
    <mo>‚ãÖ</mo>
    <mtext>ùêõ</mtext>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <msub>
      <mtext>ùêü</mtext>
      <mi>p</mi>
     </msub>
     <mo>‚ãÖ</mo>
     <mtext>ùêü</mtext>
     <mo>‚ãÖ</mo>
     <mtext>ùê¶</mtext>
    </mrow>
    <mspace width="veryverythickmathspace">
    </mspace>
    <mrow>
     <mo lspace="8.1pt" stretchy="false">(</mo>
     <mrow>
      <mo>mod</mo>
      <mi>p</mi>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <mtext>c</mtext>
     <apply>
      <ci>normal-‚ãÖ</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <mtext>f</mtext>
       <ci>p</ci>
      </apply>
      <mtext>b</mtext>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <csymbol cd="latexml">annotated</csymbol>
      <apply>
       <ci>normal-‚ãÖ</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <mtext>f</mtext>
        <ci>p</ci>
       </apply>
       <mtext>f</mtext>
       <mtext>m</mtext>
      </apply>
      <apply>
       <ci>pmod</ci>
       <ci>p</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \textbf{c}=\textbf{f}_{p}\cdot\textbf{b}=\textbf{f}_{p}\cdot\textbf{f}\cdot%
\textbf{m}\;\;(\mathop{{\rm mod}}p)
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="NTRUEncrypt:33">
 <semantics>
  <mrow>
   <mtext>ùêú</mtext>
   <mo>=</mo>
   <mrow>
    <mtext>ùê¶</mtext>
    <mspace width="veryverythickmathspace">
    </mspace>
    <mrow>
     <mo lspace="8.1pt" stretchy="false">(</mo>
     <mrow>
      <mo>mod</mo>
      <mi>p</mi>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <mtext>c</mtext>
    <apply>
     <csymbol cd="latexml">annotated</csymbol>
     <mtext>m</mtext>
     <apply>
      <ci>pmod</ci>
      <ci>p</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \textbf{c}=\textbf{m}\;\;(\mathop{{\rm mod}}p)
  </annotation>
 </semantics>
</math>

</p>

<p>because the property 

<math display="inline" id="NTRUEncrypt:34">
 <semantics>
  <mrow>
   <mrow>
    <mpadded lspace="5pt" width="+5pt">
     <mtext>ùêü</mtext>
    </mpadded>
    <mo>‚ãÖ</mo>
    <msub>
     <mtext>ùêü</mtext>
     <mi>p</mi>
    </msub>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mn>1</mn>
    <mspace width="veryverythickmathspace">
    </mspace>
    <mrow>
     <mo lspace="8.1pt" stretchy="false">(</mo>
     <mrow>
      <mo>mod</mo>
      <mi>p</mi>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <ci>normal-‚ãÖ</ci>
     <mtext>f</mtext>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <mtext>f</mtext>
      <ci>p</ci>
     </apply>
    </apply>
    <apply>
     <csymbol cd="latexml">annotated</csymbol>
     <cn type="integer">1</cn>
     <apply>
      <ci>pmod</ci>
      <ci>p</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \ \textbf{f}\cdot\textbf{f}_{p}=1\;\;(\mathop{{\rm mod}}p)
  </annotation>
 </semantics>
</math>

 was required for 

<math display="inline" id="NTRUEncrypt:35">
 <semantics>
  <msub>
   <mpadded lspace="5pt" width="+5pt">
    <mtext>ùêü</mtext>
   </mpadded>
   <mi>p</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <mtext>f</mtext>
    <ci>p</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \ \textbf{f}_{p}
  </annotation>
 </semantics>
</math>

.</p>

<p><strong>Example</strong>: The encrypted message <strong>e</strong> from Alice to Bob is multiplied with polynomial <strong>f</strong></p>

<p>

<math display="block" id="NTRUEncrypt:36">
 <semantics>
  <mrow>
   <mrow>
    <mtext>ùêö</mtext>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mtext>ùêü</mtext>
      <mo>‚ãÖ</mo>
      <mtext>ùêû</mtext>
     </mrow>
     <mspace width="veryverythickmathspace">
     </mspace>
     <mrow>
      <mo lspace="8.1pt" stretchy="false">(</mo>
      <mrow>
       <mo>mod</mo>
       <mn>32</mn>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mrow>
       <mrow>
        <mn>3</mn>
        <mo>-</mo>
        <mrow>
         <mn>7</mn>
         <mi>X</mi>
        </mrow>
        <mo>-</mo>
        <mrow>
         <mn>10</mn>
         <msup>
          <mi>X</mi>
          <mn>2</mn>
         </msup>
        </mrow>
        <mo>-</mo>
        <mrow>
         <mn>11</mn>
         <msup>
          <mi>X</mi>
          <mn>3</mn>
         </msup>
        </mrow>
       </mrow>
       <mo>+</mo>
       <mrow>
        <mn>10</mn>
        <msup>
         <mi>X</mi>
         <mn>4</mn>
        </msup>
       </mrow>
       <mo>+</mo>
       <mrow>
        <mn>7</mn>
        <msup>
         <mi>X</mi>
         <mn>5</mn>
        </msup>
       </mrow>
       <mo>+</mo>
       <mrow>
        <mn>6</mn>
        <msup>
         <mi>X</mi>
         <mn>6</mn>
        </msup>
       </mrow>
       <mo>+</mo>
       <mrow>
        <mn>7</mn>
        <msup>
         <mi>X</mi>
         <mn>7</mn>
        </msup>
       </mrow>
       <mo>+</mo>
       <mrow>
        <mn>5</mn>
        <msup>
         <mi>X</mi>
         <mn>8</mn>
        </msup>
       </mrow>
      </mrow>
      <mo>-</mo>
      <mrow>
       <mn>3</mn>
       <msup>
        <mi>X</mi>
        <mn>9</mn>
       </msup>
      </mrow>
      <mo>-</mo>
      <mrow>
       <mn>7</mn>
       <msup>
        <mi>X</mi>
        <mn>10</mn>
       </msup>
      </mrow>
     </mrow>
     <mspace width="veryverythickmathspace">
     </mspace>
     <mrow>
      <mo lspace="8.1pt" stretchy="false">(</mo>
      <mrow>
       <mo>mod</mo>
       <mn>32</mn>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <mtext>a</mtext>
     <apply>
      <csymbol cd="latexml">annotated</csymbol>
      <apply>
       <ci>normal-‚ãÖ</ci>
       <mtext>f</mtext>
       <mtext>e</mtext>
      </apply>
      <apply>
       <ci>pmod</ci>
       <cn type="integer">32</cn>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <csymbol cd="latexml">annotated</csymbol>
      <apply>
       <minus></minus>
       <apply>
        <plus></plus>
        <apply>
         <minus></minus>
         <cn type="integer">3</cn>
         <apply>
          <times></times>
          <cn type="integer">7</cn>
          <ci>X</ci>
         </apply>
         <apply>
          <times></times>
          <cn type="integer">10</cn>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <ci>X</ci>
           <cn type="integer">2</cn>
          </apply>
         </apply>
         <apply>
          <times></times>
          <cn type="integer">11</cn>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <ci>X</ci>
           <cn type="integer">3</cn>
          </apply>
         </apply>
        </apply>
        <apply>
         <times></times>
         <cn type="integer">10</cn>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>X</ci>
          <cn type="integer">4</cn>
         </apply>
        </apply>
        <apply>
         <times></times>
         <cn type="integer">7</cn>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>X</ci>
          <cn type="integer">5</cn>
         </apply>
        </apply>
        <apply>
         <times></times>
         <cn type="integer">6</cn>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>X</ci>
          <cn type="integer">6</cn>
         </apply>
        </apply>
        <apply>
         <times></times>
         <cn type="integer">7</cn>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>X</ci>
          <cn type="integer">7</cn>
         </apply>
        </apply>
        <apply>
         <times></times>
         <cn type="integer">5</cn>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>X</ci>
          <cn type="integer">8</cn>
         </apply>
        </apply>
       </apply>
       <apply>
        <times></times>
        <cn type="integer">3</cn>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>X</ci>
         <cn type="integer">9</cn>
        </apply>
       </apply>
       <apply>
        <times></times>
        <cn type="integer">7</cn>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>X</ci>
         <cn type="integer">10</cn>
        </apply>
       </apply>
      </apply>
      <apply>
       <ci>pmod</ci>
       <cn type="integer">32</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \textbf{a}=\textbf{f}\cdot\textbf{e}\;\;(\mathop{{\rm mod}}32)=3-7X-10X^{2}-11%
X^{3}+10X^{4}+7X^{5}+6X^{6}+7X^{7}+5X^{8}-3X^{9}-7X^{10}\;\;(\mathop{{\rm mod}%
}32),
  </annotation>
 </semantics>
</math>

 where Bob uses the interval [-<em>q</em>/2, <em>q</em>/2] instead of the interval [0, <em>q</em> ‚Äì 1] for the coefficients of polynomial <strong>a</strong> to prevent that the original message may not be recovered correctly.</p>

<p>Reducing the coefficients of <strong>a</strong> mod <em>p</em> results in</p>

<p>

<math display="block" id="NTRUEncrypt:37">
 <semantics>
  <mrow>
   <mtext>ùêõ</mtext>
   <mo>=</mo>
   <mrow>
    <mtext>ùêö</mtext>
    <mspace width="veryverythickmathspace">
    </mspace>
    <mrow>
     <mo lspace="8.1pt" stretchy="false">(</mo>
     <mrow>
      <mo>mod</mo>
      <mn>3</mn>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mrow>
      <mrow>
       <mrow>
        <mo>-</mo>
        <mi>X</mi>
       </mrow>
       <mo>-</mo>
       <msup>
        <mi>X</mi>
        <mn>2</mn>
       </msup>
      </mrow>
      <mo>+</mo>
      <msup>
       <mi>X</mi>
       <mn>3</mn>
      </msup>
      <mo>+</mo>
      <msup>
       <mi>X</mi>
       <mn>4</mn>
      </msup>
      <mo>+</mo>
      <msup>
       <mi>X</mi>
       <mn>5</mn>
      </msup>
      <mo>+</mo>
      <msup>
       <mi>X</mi>
       <mn>7</mn>
      </msup>
     </mrow>
     <mo>-</mo>
     <msup>
      <mi>X</mi>
      <mn>8</mn>
     </msup>
     <mo>-</mo>
     <msup>
      <mi>X</mi>
      <mn>10</mn>
     </msup>
    </mrow>
    <mspace width="veryverythickmathspace">
    </mspace>
    <mrow>
     <mo lspace="8.1pt" stretchy="false">(</mo>
     <mrow>
      <mo>mod</mo>
      <mn>3</mn>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <mtext>b</mtext>
     <apply>
      <csymbol cd="latexml">annotated</csymbol>
      <mtext>a</mtext>
      <apply>
       <ci>pmod</ci>
       <cn type="integer">3</cn>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <csymbol cd="latexml">annotated</csymbol>
      <apply>
       <minus></minus>
       <apply>
        <plus></plus>
        <apply>
         <minus></minus>
         <apply>
          <minus></minus>
          <ci>X</ci>
         </apply>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>X</ci>
          <cn type="integer">2</cn>
         </apply>
        </apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>X</ci>
         <cn type="integer">3</cn>
        </apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>X</ci>
         <cn type="integer">4</cn>
        </apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>X</ci>
         <cn type="integer">5</cn>
        </apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>X</ci>
         <cn type="integer">7</cn>
        </apply>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>X</ci>
        <cn type="integer">8</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>X</ci>
        <cn type="integer">10</cn>
       </apply>
      </apply>
      <apply>
       <ci>pmod</ci>
       <cn type="integer">3</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \textbf{b}=\textbf{a}\;\;(\mathop{{\rm mod}}3)=-X-X^{2}+X^{3}+X^{4}+X^{5}+X^{7%
}-X^{8}-X^{10}\;\;(\mathop{{\rm mod}}3)
  </annotation>
 </semantics>
</math>

 which equals 

<math display="inline" id="NTRUEncrypt:38">
 <semantics>
  <mrow>
   <mpadded lspace="5pt" width="+5pt">
    <mtext>ùêõ</mtext>
   </mpadded>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mtext>ùêü</mtext>
     <mo>‚ãÖ</mo>
     <mtext>ùê¶</mtext>
    </mrow>
    <mspace width="veryverythickmathspace">
    </mspace>
    <mrow>
     <mo lspace="8.1pt" stretchy="false">(</mo>
     <mrow>
      <mo>mod</mo>
      <mn>3</mn>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <mtext>b</mtext>
    <apply>
     <csymbol cd="latexml">annotated</csymbol>
     <apply>
      <ci>normal-‚ãÖ</ci>
      <mtext>f</mtext>
      <mtext>m</mtext>
     </apply>
     <apply>
      <ci>pmod</ci>
      <cn type="integer">3</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \ \textbf{b}=\textbf{f}\cdot\textbf{m}\;\;(\mathop{{\rm mod}}3)
  </annotation>
 </semantics>
</math>

.</p>

<p>In the last step the result is multiplied with 

<math display="inline" id="NTRUEncrypt:39">
 <semantics>
  <msub>
   <mpadded lspace="5pt" width="+5pt">
    <mtext>ùêü</mtext>
   </mpadded>
   <mi>p</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <mtext>f</mtext>
    <ci>p</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \ \textbf{f}_{p}
  </annotation>
 </semantics>
</math>

 from Bob‚Äôs private key to end up with the original message <strong>m</strong></p>

<p>

<math display="block" id="NTRUEncrypt:40">
 <semantics>
  <mrow>
   <mtext>ùêú</mtext>
   <mo>=</mo>
   <mrow>
    <msub>
     <mtext>ùêü</mtext>
     <mi>p</mi>
    </msub>
    <mo>‚ãÖ</mo>
    <mtext>ùêõ</mtext>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <msub>
      <mtext>ùêü</mtext>
      <mi>p</mi>
     </msub>
     <mo>‚ãÖ</mo>
     <mtext>ùêü</mtext>
     <mo>‚ãÖ</mo>
     <mtext>ùê¶</mtext>
    </mrow>
    <mspace width="veryverythickmathspace">
    </mspace>
    <mrow>
     <mo lspace="8.1pt" stretchy="false">(</mo>
     <mrow>
      <mo>mod</mo>
      <mn>3</mn>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mtext>ùê¶</mtext>
    <mspace width="veryverythickmathspace">
    </mspace>
    <mrow>
     <mo lspace="8.1pt" stretchy="false">(</mo>
     <mrow>
      <mo>mod</mo>
      <mn>3</mn>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <mtext>c</mtext>
     <apply>
      <ci>normal-‚ãÖ</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <mtext>f</mtext>
       <ci>p</ci>
      </apply>
      <mtext>b</mtext>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <csymbol cd="latexml">annotated</csymbol>
      <apply>
       <ci>normal-‚ãÖ</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <mtext>f</mtext>
        <ci>p</ci>
       </apply>
       <mtext>f</mtext>
       <mtext>m</mtext>
      </apply>
      <apply>
       <ci>pmod</ci>
       <cn type="integer">3</cn>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <csymbol cd="latexml">annotated</csymbol>
      <mtext>m</mtext>
      <apply>
       <ci>pmod</ci>
       <cn type="integer">3</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \textbf{c}=\textbf{f}_{p}\cdot\textbf{b}=\textbf{f}_{p}\cdot\textbf{f}\cdot%
\textbf{m}\;\;(\mathop{{\rm mod}}3)=\textbf{m}\;\;(\mathop{{\rm mod}}3)
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="NTRUEncrypt:41">
 <semantics>
  <mrow>
   <mtext>ùêú</mtext>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mrow>
      <mrow>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
      <mo>+</mo>
      <msup>
       <mi>X</mi>
       <mn>3</mn>
      </msup>
     </mrow>
     <mo>-</mo>
     <msup>
      <mi>X</mi>
      <mn>4</mn>
     </msup>
     <mo>-</mo>
     <msup>
      <mi>X</mi>
      <mn>8</mn>
     </msup>
    </mrow>
    <mo>+</mo>
    <msup>
     <mi>X</mi>
     <mn>9</mn>
    </msup>
    <mo>+</mo>
    <msup>
     <mi>X</mi>
     <mn>10</mn>
    </msup>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <mtext>c</mtext>
    <apply>
     <plus></plus>
     <apply>
      <minus></minus>
      <apply>
       <plus></plus>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>X</ci>
        <cn type="integer">3</cn>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>X</ci>
       <cn type="integer">4</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>X</ci>
       <cn type="integer">8</cn>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>X</ci>
      <cn type="integer">9</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>X</ci>
      <cn type="integer">10</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \textbf{c}=-1+X^{3}-X^{4}-X^{8}+X^{9}+X^{10}
  </annotation>
 </semantics>
</math>

 Which indeed is the original message Alice has sent to Bob!</p>
<h2 id="attacks">Attacks</h2>

<p>Since the proposal of NTRU several attacks on the NTRUEncrypt public key cryptosystem have been introduced. Most attacks are focused on making a total break by finding the secret key <strong>f</strong> instead of just recovering the message <strong>m</strong>. If <strong>f</strong> is known to have very few non-zero coefficients Eve can successfully mount a <a href="brute_force_attack" title="wikilink">brute force attack</a> by trying all values for <strong>f</strong>. When Eve wants to know whether <strong>f</strong>¬¥ is the secret key, she simply calculates 

<math display="inline" id="NTRUEncrypt:42">
 <semantics>
  <mrow>
   <mrow>
    <msup>
     <mpadded lspace="5pt" width="+5pt">
      <mtext>ùêü</mtext>
     </mpadded>
     <msup>
      <mi></mi>
      <mo>‚Ä≤</mo>
     </msup>
    </msup>
    <mo>‚ãÖ</mo>
    <mtext>ùê°</mtext>
   </mrow>
   <mspace width="veryverythickmathspace">
   </mspace>
   <mrow>
    <mo lspace="8.1pt" stretchy="false">(</mo>
    <mrow>
     <mo>mod</mo>
     <mi>q</mi>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">annotated</csymbol>
    <apply>
     <ci>normal-‚ãÖ</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <mtext>f</mtext>
      <apply>
       <ci>normal-‚Ä≤</ci>
      </apply>
     </apply>
     <mtext>h</mtext>
    </apply>
    <apply>
     <ci>pmod</ci>
     <ci>q</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \ \textbf{f}^{{}^{\prime}}\cdot\textbf{h}\;\;(\mathop{{\rm mod}}q)
  </annotation>
 </semantics>
</math>

. If it has small coefficients it might be the secret key <strong>f</strong>, and Eve can test if <strong>f</strong>¬¥ is the secret key by using it to decrypt a message she encrypted herself. Eve could also try values of <strong>g</strong> and test if 

<math display="inline" id="NTRUEncrypt:43">
 <semantics>
  <mrow>
   <mrow>
    <msup>
     <mpadded lspace="5pt" width="+5pt">
      <mtext>ùê†</mtext>
     </mpadded>
     <msup>
      <mi></mi>
      <mo>‚Ä≤</mo>
     </msup>
    </msup>
    <mo>‚ãÖ</mo>
    <msup>
     <mtext>ùê°</mtext>
     <mrow>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </msup>
   </mrow>
   <mspace width="veryverythickmathspace">
   </mspace>
   <mrow>
    <mo lspace="8.1pt" stretchy="false">(</mo>
    <mrow>
     <mo>mod</mo>
     <mi>q</mi>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">annotated</csymbol>
    <apply>
     <ci>normal-‚ãÖ</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <mtext>g</mtext>
      <apply>
       <ci>normal-‚Ä≤</ci>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <mtext>h</mtext>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
      </apply>
     </apply>
    </apply>
    <apply>
     <ci>pmod</ci>
     <ci>q</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \ \textbf{g}^{{}^{\prime}}\cdot\textbf{h}^{-1}\;\;(\mathop{{\rm mod}}q)
  </annotation>
 </semantics>
</math>

has small values.</p>

<p>It is possible to mount a <a href="meet-in-the-middle_attack" title="wikilink">meet-in-the-middle attack</a> which is more powerful. It can cut the search time by square root. The attack is based on the property that 

<math display="inline" id="NTRUEncrypt:44">
 <semantics>
  <mrow>
   <mrow>
    <mpadded lspace="5pt" width="+5pt">
     <mtext>ùêü</mtext>
    </mpadded>
    <mo>‚ãÖ</mo>
    <mtext>ùê°</mtext>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mtext>ùê†</mtext>
    <mspace width="veryverythickmathspace">
    </mspace>
    <mrow>
     <mo lspace="8.1pt" stretchy="false">(</mo>
     <mrow>
      <mo>mod</mo>
      <mi>q</mi>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <ci>normal-‚ãÖ</ci>
     <mtext>f</mtext>
     <mtext>h</mtext>
    </apply>
    <apply>
     <csymbol cd="latexml">annotated</csymbol>
     <mtext>g</mtext>
     <apply>
      <ci>pmod</ci>
      <ci>q</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \ \textbf{f}\cdot\textbf{h}=\textbf{g}\;\;(\mathop{{\rm mod}}q)
  </annotation>
 </semantics>
</math>

.</p>

<p>Eve wants to find 

<math display="inline" id="NTRUEncrypt:45">
 <semantics>
  <msub>
   <mpadded lspace="5pt" width="+5pt">
    <mtext>ùêü</mtext>
   </mpadded>
   <mn>1</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <mtext>f</mtext>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \ \textbf{f}_{1}
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="NTRUEncrypt:46">
 <semantics>
  <msub>
   <mpadded lspace="5pt" width="+5pt">
    <mtext>ùêü</mtext>
   </mpadded>
   <mn>2</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <mtext>f</mtext>
    <cn type="integer">2</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \ \textbf{f}_{2}
  </annotation>
 </semantics>
</math>

 such that 

<math display="inline" id="NTRUEncrypt:47">
 <semantics>
  <mrow>
   <mpadded lspace="5pt" width="+5pt">
    <mtext>ùêü</mtext>
   </mpadded>
   <mo>=</mo>
   <mrow>
    <msub>
     <mtext>ùêü</mtext>
     <mn>1</mn>
    </msub>
    <mo>+</mo>
    <msub>
     <mtext>ùêü</mtext>
     <mn>2</mn>
    </msub>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <mtext>f</mtext>
    <apply>
     <plus></plus>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <mtext>f</mtext>
      <cn type="integer">1</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <mtext>f</mtext>
      <cn type="integer">2</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \ \textbf{f}=\textbf{f}_{1}+\textbf{f}_{2}
  </annotation>
 </semantics>
</math>

 holds and such that they have the property</p>

<p>

<math display="block" id="NTRUEncrypt:48">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mo>(</mo>
     <mrow>
      <msub>
       <mtext>ùêü</mtext>
       <mn>1</mn>
      </msub>
      <mo>+</mo>
      <msub>
       <mtext>ùêü</mtext>
       <mn>2</mn>
      </msub>
     </mrow>
     <mo>)</mo>
    </mrow>
    <mo>‚ãÖ</mo>
    <mtext>ùê°</mtext>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mtext>ùê†</mtext>
    <mspace width="veryverythickmathspace">
    </mspace>
    <mrow>
     <mo lspace="8.1pt" stretchy="false">(</mo>
     <mrow>
      <mo>mod</mo>
      <mi>q</mi>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <ci>normal-‚ãÖ</ci>
     <apply>
      <plus></plus>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <mtext>f</mtext>
       <cn type="integer">1</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <mtext>f</mtext>
       <cn type="integer">2</cn>
      </apply>
     </apply>
     <mtext>h</mtext>
    </apply>
    <apply>
     <csymbol cd="latexml">annotated</csymbol>
     <mtext>g</mtext>
     <apply>
      <ci>pmod</ci>
      <ci>q</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \left(\textbf{f}_{1}+\textbf{f}_{2}\right)\cdot\textbf{h}=\textbf{g}\;\;(%
\mathop{{\rm mod}}q)
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="NTRUEncrypt:49">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mtext>ùêü</mtext>
     <mn>1</mn>
    </msub>
    <mo>‚ãÖ</mo>
    <mtext>ùê°</mtext>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mtext>ùê†</mtext>
     <mo>-</mo>
     <mrow>
      <msub>
       <mtext>ùêü</mtext>
       <mn>2</mn>
      </msub>
      <mo>‚ãÖ</mo>
      <mtext>ùê°</mtext>
     </mrow>
    </mrow>
    <mspace width="veryverythickmathspace">
    </mspace>
    <mrow>
     <mo lspace="8.1pt" stretchy="false">(</mo>
     <mrow>
      <mo>mod</mo>
      <mi>q</mi>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <ci>normal-‚ãÖ</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <mtext>f</mtext>
      <cn type="integer">1</cn>
     </apply>
     <mtext>h</mtext>
    </apply>
    <apply>
     <csymbol cd="latexml">annotated</csymbol>
     <apply>
      <minus></minus>
      <mtext>g</mtext>
      <apply>
       <ci>normal-‚ãÖ</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <mtext>f</mtext>
        <cn type="integer">2</cn>
       </apply>
       <mtext>h</mtext>
      </apply>
     </apply>
     <apply>
      <ci>pmod</ci>
      <ci>q</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \textbf{f}_{1}\cdot\textbf{h}=\textbf{g}-\textbf{f}_{2}\cdot\textbf{h}\;\;(%
\mathop{{\rm mod}}q)
  </annotation>
 </semantics>
</math>

</p>

<p>If <strong>f</strong> has <em>d</em> one‚Äôs and <em>N</em>-<em>d</em> zero‚Äôs, then Eve creates all possible 

<math display="inline" id="NTRUEncrypt:50">
 <semantics>
  <msub>
   <mpadded lspace="5pt" width="+5pt">
    <mtext>ùêü</mtext>
   </mpadded>
   <mn>1</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <mtext>f</mtext>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \ \textbf{f}_{1}
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="NTRUEncrypt:51">
 <semantics>
  <msub>
   <mpadded lspace="5pt" width="+5pt">
    <mtext>ùêü</mtext>
   </mpadded>
   <mn>2</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <mtext>f</mtext>
    <cn type="integer">2</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \ \textbf{f}_{2}
  </annotation>
 </semantics>
</math>

 in which they both have length 

<math display="inline" id="NTRUEncrypt:52">
 <semantics>
  <mrow>
   <mpadded lspace="5pt" width="+5pt">
    <mfrac>
     <mn>1</mn>
     <mn>2</mn>
    </mfrac>
   </mpadded>
   <mi>N</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <divide></divide>
     <cn type="integer">1</cn>
     <cn type="integer">2</cn>
    </apply>
    <ci>N</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \ \frac{1}{2}N
  </annotation>
 </semantics>
</math>

 (e.g. 

<math display="inline" id="NTRUEncrypt:53">
 <semantics>
  <msub>
   <mpadded lspace="5pt" width="+5pt">
    <mtext>ùêü</mtext>
   </mpadded>
   <mn>1</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <mtext>f</mtext>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \ \textbf{f}_{1}
  </annotation>
 </semantics>
</math>

 covers the 

<math display="inline" id="NTRUEncrypt:54">
 <semantics>
  <mrow>
   <mpadded lspace="5pt" width="+5pt">
    <mfrac>
     <mn>1</mn>
     <mn>2</mn>
    </mfrac>
   </mpadded>
   <mi>N</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <divide></divide>
     <cn type="integer">1</cn>
     <cn type="integer">2</cn>
    </apply>
    <ci>N</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \ \frac{1}{2}N
  </annotation>
 </semantics>
</math>

 lowest coefficients of <strong>f</strong> and 

<math display="inline" id="NTRUEncrypt:55">
 <semantics>
  <msub>
   <mpadded lspace="5pt" width="+5pt">
    <mtext>ùêü</mtext>
   </mpadded>
   <mn>2</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <mtext>f</mtext>
    <cn type="integer">2</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \ \textbf{f}_{2}
  </annotation>
 </semantics>
</math>

 the highest) with <em>d</em>/2 one‚Äôs. Then she computes 

<math display="inline" id="NTRUEncrypt:56">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mtext>ùêü</mtext>
     <mn>1</mn>
    </msub>
    <mo>‚ãÖ</mo>
    <mtext>ùê°</mtext>
   </mrow>
   <mspace width="veryverythickmathspace">
   </mspace>
   <mrow>
    <mo lspace="8.1pt" stretchy="false">(</mo>
    <mrow>
     <mo>mod</mo>
     <mi>q</mi>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">annotated</csymbol>
    <apply>
     <ci>normal-‚ãÖ</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <mtext>f</mtext>
      <cn type="integer">1</cn>
     </apply>
     <mtext>h</mtext>
    </apply>
    <apply>
     <ci>pmod</ci>
     <ci>q</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \textbf{f}_{1}\cdot\textbf{h}\;\;(\mathop{{\rm mod}}q)
  </annotation>
 </semantics>
</math>

 for all 

<math display="inline" id="NTRUEncrypt:57">
 <semantics>
  <msub>
   <mpadded lspace="5pt" width="+5pt">
    <mtext>ùêü</mtext>
   </mpadded>
   <mn>1</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <mtext>f</mtext>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \ \textbf{f}_{1}
  </annotation>
 </semantics>
</math>

 and orders them in bins based on the first k coordinates. After that she computes all 

<math display="inline" id="NTRUEncrypt:58">
 <semantics>
  <mrow>
   <mrow>
    <mo lspace="7.5pt">-</mo>
    <mrow>
     <msub>
      <mtext>ùêü</mtext>
      <mn>2</mn>
     </msub>
     <mo>‚ãÖ</mo>
     <mtext>ùê°</mtext>
    </mrow>
   </mrow>
   <mspace width="veryverythickmathspace">
   </mspace>
   <mrow>
    <mo lspace="8.1pt" stretchy="false">(</mo>
    <mrow>
     <mo>mod</mo>
     <mi>q</mi>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">annotated</csymbol>
    <apply>
     <minus></minus>
     <apply>
      <ci>normal-‚ãÖ</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <mtext>f</mtext>
       <cn type="integer">2</cn>
      </apply>
      <mtext>h</mtext>
     </apply>
    </apply>
    <apply>
     <ci>pmod</ci>
     <ci>q</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \ -\textbf{f}_{2}\cdot\textbf{h}\;\;(\mathop{{\rm mod}}q)
  </annotation>
 </semantics>
</math>

 and orders them in bins not only based on the first k coordinates, but also based on what happens if you add 1 to the first k coordinates. Then you check the bins that contain both 

<math display="inline" id="NTRUEncrypt:59">
 <semantics>
  <msub>
   <mpadded lspace="5pt" width="+5pt">
    <mtext>ùêü</mtext>
   </mpadded>
   <mn>1</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <mtext>f</mtext>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \ \textbf{f}_{1}
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="NTRUEncrypt:60">
 <semantics>
  <msub>
   <mpadded lspace="5pt" width="+5pt">
    <mtext>ùêü</mtext>
   </mpadded>
   <mn>2</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <mtext>f</mtext>
    <cn type="integer">2</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \ \textbf{f}_{2}
  </annotation>
 </semantics>
</math>

 and see if the property 

<math display="inline" id="NTRUEncrypt:61">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mpadded lspace="5pt" width="+5pt">
      <mtext>ùêü</mtext>
     </mpadded>
     <mn>1</mn>
    </msub>
    <mo>‚ãÖ</mo>
    <mtext>ùê°</mtext>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mtext>ùê†</mtext>
     <mo>-</mo>
     <mrow>
      <msub>
       <mtext>ùêü</mtext>
       <mn>2</mn>
      </msub>
      <mo>‚ãÖ</mo>
      <mtext>ùê°</mtext>
     </mrow>
    </mrow>
    <mspace width="veryverythickmathspace">
    </mspace>
    <mrow>
     <mo lspace="8.1pt" stretchy="false">(</mo>
     <mrow>
      <mo>mod</mo>
      <mi>q</mi>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <ci>normal-‚ãÖ</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <mtext>f</mtext>
      <cn type="integer">1</cn>
     </apply>
     <mtext>h</mtext>
    </apply>
    <apply>
     <csymbol cd="latexml">annotated</csymbol>
     <apply>
      <minus></minus>
      <mtext>g</mtext>
      <apply>
       <ci>normal-‚ãÖ</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <mtext>f</mtext>
        <cn type="integer">2</cn>
       </apply>
       <mtext>h</mtext>
      </apply>
     </apply>
     <apply>
      <ci>pmod</ci>
      <ci>q</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \ \textbf{f}_{1}\cdot\textbf{h}=\textbf{g}-\textbf{f}_{2}\cdot\textbf{h}\;\;(%
\mathop{{\rm mod}}q)
  </annotation>
 </semantics>
</math>

 holds.</p>

<p>The lattice reduction attack is one of the best known and one of the most practical methods to break the NTRUEncrypt. In a way it can be compared to the factorization of the modulus in RSA. The most used algorithm for the lattice reduction attack is the <a href="Lenstra-Lenstra-Lov√°sz_lattice_reduction_algorithm" title="wikilink">Lenstra-Lenstra-Lov√°sz algorithm</a>. Because the public key <strong>h</strong> contains both <strong>f</strong> and <strong>g</strong> one can try to obtain them from <strong>h</strong>. It is however too hard to find the secret key when the NTRUEncrypt parameters are chosen secure enough. The lattice reduction attack becomes harder if the dimension of the lattice gets bigger and the shortest vector gets longer.</p>

<p>The <a href="chosen_ciphertext_attack" title="wikilink">chosen ciphertext attack</a> is also a method which recovers the secret key <strong>f</strong> and thereby results in a total break. In this attack Eve tries to obtain her own message from the ciphertext and thereby tries to obtain the secret key. In this attack Eve doesn‚Äôt have any interaction with Bob.</p>

<p><strong>How it works</strong>:</p>

<p>First Eve creates a cipher text 

<math display="inline" id="NTRUEncrypt:62">
 <semantics>
  <mrow>
   <mpadded lspace="5pt" width="+5pt">
    <mtext>ùêû</mtext>
   </mpadded>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mi>c</mi>
     <mtext>ùê°</mtext>
    </mrow>
    <mo>+</mo>
    <mi>c</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <mtext>e</mtext>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <ci>c</ci>
      <mtext>h</mtext>
     </apply>
     <ci>c</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \ \textbf{e}=c\textbf{h}+c
  </annotation>
 </semantics>
</math>

 such that 

<math display="inline" id="NTRUEncrypt:63">
 <semantics>
  <mrow>
   <mrow>
    <mpadded lspace="5pt" width="+5pt">
     <mi>c</mi>
    </mpadded>
    <mo>=</mo>
    <mrow>
     <mn>0</mn>
     <mspace width="veryverythickmathspace">
     </mspace>
     <mrow>
      <mo lspace="8.1pt" stretchy="false">(</mo>
      <mrow>
       <mo>mod</mo>
       <mi>p</mi>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
   <mrow>
    <mi>c</mi>
    <mo><</mo>
    <mfrac>
     <mi>q</mi>
     <mn>2</mn>
    </mfrac>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <eq></eq>
     <ci>c</ci>
     <apply>
      <csymbol cd="latexml">annotated</csymbol>
      <cn type="integer">0</cn>
      <apply>
       <ci>pmod</ci>
       <ci>p</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <lt></lt>
     <ci>c</ci>
     <apply>
      <divide></divide>
      <ci>q</ci>
      <cn type="integer">2</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \ c=0\;\;(\mathop{{\rm mod}}p),c<\frac{q}{2}
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="NTRUEncrypt:64">
 <semantics>
  <mrow>
   <mrow>
    <mn>2</mn>
    <mi>c</mi>
   </mrow>
   <mo>></mo>
   <mfrac>
    <mi>q</mi>
    <mn>2</mn>
   </mfrac>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <gt></gt>
    <apply>
     <times></times>
     <cn type="float">2</cn>
     <ci>c</ci>
    </apply>
    <apply>
     <divide></divide>
     <ci>q</ci>
     <cn type="integer">2</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \ 2c>\frac{q}{2}
  </annotation>
 </semantics>
</math>

 When Eve writes down the steps to deciphers e (without actually calculating the values since she does not know f) she finds 

<math display="inline" id="NTRUEncrypt:65">
 <semantics>
  <mrow>
   <mpadded lspace="5pt" width="+5pt">
    <mtext>ùêö</mtext>
   </mpadded>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mtext>ùêü</mtext>
     <mo>‚ãÖ</mo>
     <mtext>ùêû</mtext>
    </mrow>
    <mspace width="veryverythickmathspace">
    </mspace>
    <mrow>
     <mo lspace="8.1pt" stretchy="false">(</mo>
     <mrow>
      <mo>mod</mo>
      <mi>q</mi>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <mtext>a</mtext>
    <apply>
     <csymbol cd="latexml">annotated</csymbol>
     <apply>
      <ci>normal-‚ãÖ</ci>
      <mtext>f</mtext>
      <mtext>e</mtext>
     </apply>
     <apply>
      <ci>pmod</ci>
      <ci>q</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \ \textbf{a}=\textbf{f}\cdot\textbf{e}\;\;(\mathop{{\rm mod}}q)
  </annotation>
 </semantics>
</math>

:</p>

<p>

<math display="block" id="NTRUEncrypt:66">
 <semantics>
  <mrow>
   <mtext>ùêö</mtext>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mtext>ùêü</mtext>
     <mrow>
      <mo>(</mo>
      <mrow>
       <mrow>
        <mi>c</mi>
        <mtext>ùê°</mtext>
       </mrow>
       <mo>+</mo>
       <mi>c</mi>
      </mrow>
      <mo>)</mo>
     </mrow>
    </mrow>
    <mspace width="veryverythickmathspace">
    </mspace>
    <mrow>
     <mo lspace="8.1pt" stretchy="false">(</mo>
     <mrow>
      <mo>mod</mo>
      <mi>q</mi>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <mtext>a</mtext>
    <apply>
     <csymbol cd="latexml">annotated</csymbol>
     <apply>
      <times></times>
      <mtext>f</mtext>
      <apply>
       <plus></plus>
       <apply>
        <times></times>
        <ci>c</ci>
        <mtext>h</mtext>
       </apply>
       <ci>c</ci>
      </apply>
     </apply>
     <apply>
      <ci>pmod</ci>
      <ci>q</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \textbf{a}=\textbf{f}\left(c\textbf{h}+c\right)\;\;(\mathop{{\rm mod}}q)
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="NTRUEncrypt:67">
 <semantics>
  <mrow>
   <mtext>ùêö</mtext>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mrow>
      <mi>c</mi>
      <mtext>ùê†</mtext>
     </mrow>
     <mo>+</mo>
     <mrow>
      <mi>c</mi>
      <mtext>ùêü</mtext>
     </mrow>
    </mrow>
    <mspace width="veryverythickmathspace">
    </mspace>
    <mrow>
     <mo lspace="8.1pt" stretchy="false">(</mo>
     <mrow>
      <mo>mod</mo>
      <mi>q</mi>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <mtext>a</mtext>
    <apply>
     <csymbol cd="latexml">annotated</csymbol>
     <apply>
      <plus></plus>
      <apply>
       <times></times>
       <ci>c</ci>
       <mtext>g</mtext>
      </apply>
      <apply>
       <times></times>
       <ci>c</ci>
       <mtext>f</mtext>
      </apply>
     </apply>
     <apply>
      <ci>pmod</ci>
      <ci>q</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \textbf{a}=c\textbf{g}+c\textbf{f}\;\;(\mathop{{\rm mod}}q)
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="NTRUEncrypt:68">
 <semantics>
  <mrow>
   <mtext>ùêö</mtext>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mrow>
      <mi>c</mi>
      <mtext>ùê†</mtext>
     </mrow>
     <mo>+</mo>
     <mrow>
      <mi>c</mi>
      <mtext>ùêü</mtext>
     </mrow>
    </mrow>
    <mo>-</mo>
    <mrow>
     <mi>q</mi>
     <mi>K</mi>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <mtext>a</mtext>
    <apply>
     <minus></minus>
     <apply>
      <plus></plus>
      <apply>
       <times></times>
       <ci>c</ci>
       <mtext>g</mtext>
      </apply>
      <apply>
       <times></times>
       <ci>c</ci>
       <mtext>f</mtext>
      </apply>
     </apply>
     <apply>
      <times></times>
      <ci>q</ci>
      <ci>K</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \textbf{a}=c\textbf{g}+c\textbf{f}-qK
  </annotation>
 </semantics>
</math>

</p>

<p>In which 

<math display="inline" id="NTRUEncrypt:69">
 <semantics>
  <mrow>
   <mpadded lspace="5pt" width="+5pt">
    <mi>K</mi>
   </mpadded>
   <mo>=</mo>
   <mrow>
    <mo largeop="true" symmetric="true">‚àë</mo>
    <mrow>
     <msub>
      <mi>k</mi>
      <mi>i</mi>
     </msub>
     <msup>
      <mi>x</mi>
      <mi>i</mi>
     </msup>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>K</ci>
    <apply>
     <sum></sum>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>k</ci>
       <ci>i</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>x</ci>
       <ci>i</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \ K=\sum k_{i}x^{i}
  </annotation>
 </semantics>
</math>

 such that</p>

<p>

<math display="block" id="NTRUEncrypt:70">
 <semantics>
  <mrow>
   <msub>
    <mi>k</mi>
    <mi>i</mi>
   </msub>
   <mo>=</mo>
   <mrow>
    <mo>{</mo>
    <mtable displaystyle="true">
     <mtr>
      <mtd columnalign="left">
       <mrow>
        <mn>1</mn>
        <mrow>
         <mpadded width="+5pt">
          <mtext>if the</mtext>
         </mpadded>
         <mpadded width="+5pt">
          <msup>
           <mi>i</mi>
           <mrow>
            <mi>t</mi>
            <mi>h</mi>
           </mrow>
          </msup>
         </mpadded>
         <mpadded width="+5pt">
          <mtext>coefficient of</mtext>
         </mpadded>
         <mpadded width="+5pt">
          <mtext>ùêü</mtext>
         </mpadded>
         <mpadded width="+5pt">
          <mtext>and</mtext>
         </mpadded>
         <mpadded width="+5pt">
          <mtext>ùê†</mtext>
         </mpadded>
         <mtext>is</mtext>
         <mn>1</mn>
        </mrow>
       </mrow>
      </mtd>
      <mtd></mtd>
     </mtr>
     <mtr>
      <mtd columnalign="left">
       <mrow>
        <mrow>
         <mo>-</mo>
         <mn>1</mn>
        </mrow>
        <mrow>
         <mrow>
          <mpadded width="+5pt">
           <mtext>if the</mtext>
          </mpadded>
          <mpadded width="+5pt">
           <msup>
            <mi>i</mi>
            <mrow>
             <mi>t</mi>
             <mi>h</mi>
            </mrow>
           </msup>
          </mpadded>
          <mpadded width="+5pt">
           <mtext>coefficient of</mtext>
          </mpadded>
          <mpadded width="+5pt">
           <mtext>ùêü</mtext>
          </mpadded>
          <mpadded width="+5pt">
           <mtext>and</mtext>
          </mpadded>
          <mpadded width="+5pt">
           <mtext>ùê†</mtext>
          </mpadded>
          <mpadded width="+5pt">
           <mtext>is</mtext>
          </mpadded>
         </mrow>
         <mo>-</mo>
         <mn>1</mn>
        </mrow>
       </mrow>
      </mtd>
      <mtd></mtd>
     </mtr>
     <mtr>
      <mtd columnalign="left">
       <mrow>
        <mn>0</mn>
        <mtext>Otherwise</mtext>
       </mrow>
      </mtd>
      <mtd></mtd>
     </mtr>
    </mtable>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>k</ci>
     <ci>i</ci>
    </apply>
    <apply>
     <csymbol cd="latexml">cases</csymbol>
     <list>
      <cn type="integer">1</cn>
      <apply>
       <times></times>
       <mtext>if the</mtext>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>i</ci>
        <apply>
         <times></times>
         <ci>t</ci>
         <ci>h</ci>
        </apply>
       </apply>
       <mtext>coefficient of</mtext>
       <mtext>f</mtext>
       <mtext>and</mtext>
       <mtext>g</mtext>
       <mtext>is</mtext>
       <cn type="float">1</cn>
      </apply>
     </list>
     <mtext>otherwise</mtext>
     <list>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
      </apply>
      <apply>
       <minus></minus>
       <apply>
        <times></times>
        <mtext>if the</mtext>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>i</ci>
         <apply>
          <times></times>
          <ci>t</ci>
          <ci>h</ci>
         </apply>
        </apply>
        <mtext>coefficient of</mtext>
        <mtext>f</mtext>
        <mtext>and</mtext>
        <mtext>g</mtext>
        <mtext>is</mtext>
       </apply>
       <cn type="integer">1</cn>
      </apply>
     </list>
     <mtext>otherwise</mtext>
     <list>
      <cn type="integer">0</cn>
      <mtext>Otherwise</mtext>
     </list>
     <mtext>otherwise</mtext>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   k_{i}=\begin{cases}1\ \ \qquad\text{if the}\ i^{th}\ \text{coefficient of}\ %
\textbf{f}\ \text{and}\ \textbf{g}\ \text{is}\ 1\\
-1\qquad\text{if the}\ i^{th}\ \text{coefficient of}\ \textbf{f}\ \text{and}\ %
\textbf{g}\ \text{is}\ -1\\
0\ \ \qquad\text{Otherwise}\end{cases}
  </annotation>
 </semantics>
</math>

</p>

<p><strong>Example</strong>:</p>

<p>

<math display="block" id="NTRUEncrypt:71">
 <semantics>
  <mrow>
   <mtext>ùêü</mtext>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mrow>
      <mrow>
       <mrow>
        <mo>-</mo>
        <mn>1</mn>
       </mrow>
       <mo>+</mo>
       <mi>X</mi>
       <mo>+</mo>
       <msup>
        <mi>X</mi>
        <mn>2</mn>
       </msup>
      </mrow>
      <mo>-</mo>
      <msup>
       <mi>X</mi>
       <mn>4</mn>
      </msup>
     </mrow>
     <mo>+</mo>
     <msup>
      <mi>X</mi>
      <mn>6</mn>
     </msup>
     <mo>+</mo>
     <msup>
      <mi>X</mi>
      <mn>9</mn>
     </msup>
    </mrow>
    <mo>-</mo>
    <msup>
     <mi>X</mi>
     <mn>10</mn>
    </msup>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <mtext>f</mtext>
    <apply>
     <minus></minus>
     <apply>
      <plus></plus>
      <apply>
       <minus></minus>
       <apply>
        <plus></plus>
        <apply>
         <minus></minus>
         <cn type="integer">1</cn>
        </apply>
        <ci>X</ci>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>X</ci>
         <cn type="integer">2</cn>
        </apply>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>X</ci>
        <cn type="integer">4</cn>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>X</ci>
       <cn type="integer">6</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>X</ci>
       <cn type="integer">9</cn>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>X</ci>
      <cn type="integer">10</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \textbf{f}=-1+X+X^{2}-X^{4}+X^{6}+X^{9}-X^{10}
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="NTRUEncrypt:72">
 <semantics>
  <mrow>
   <mtext>ùê†</mtext>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mrow>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
     <mo>+</mo>
     <msup>
      <mi>X</mi>
      <mn>2</mn>
     </msup>
     <mo>+</mo>
     <msup>
      <mi>X</mi>
      <mn>3</mn>
     </msup>
     <mo>+</mo>
     <msup>
      <mi>X</mi>
      <mn>5</mn>
     </msup>
    </mrow>
    <mo>-</mo>
    <msup>
     <mi>X</mi>
     <mn>8</mn>
    </msup>
    <mo>-</mo>
    <msup>
     <mi>X</mi>
     <mn>10</mn>
    </msup>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <mtext>g</mtext>
    <apply>
     <minus></minus>
     <apply>
      <plus></plus>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>X</ci>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>X</ci>
       <cn type="integer">3</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>X</ci>
       <cn type="integer">5</cn>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>X</ci>
      <cn type="integer">8</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>X</ci>
      <cn type="integer">10</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \textbf{g}=-1+X^{2}+X^{3}+X^{5}-X^{8}-X^{10}
  </annotation>
 </semantics>
</math>

</p>

<p>Then <em>K</em> becomes 

<math display="inline" id="NTRUEncrypt:73">
 <semantics>
  <mrow>
   <mpadded lspace="5pt" width="+5pt">
    <mi>K</mi>
   </mpadded>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mrow>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
     <mo>+</mo>
     <msup>
      <mi>X</mi>
      <mn>2</mn>
     </msup>
    </mrow>
    <mo>-</mo>
    <msup>
     <mi>X</mi>
     <mn>10</mn>
    </msup>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>K</ci>
    <apply>
     <minus></minus>
     <apply>
      <plus></plus>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>X</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>X</ci>
      <cn type="integer">10</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \ K=-1+X^{2}-X^{10}
  </annotation>
 </semantics>
</math>

.</p>

<p>Reducing the coefficients of polynomials <strong>a</strong> mod <em>p</em> really reduces the coefficients of 

<math display="inline" id="NTRUEncrypt:74">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mrow>
      <mpadded lspace="5pt" width="+5pt">
       <mi>c</mi>
      </mpadded>
      <mtext>ùê†</mtext>
     </mrow>
     <mo>+</mo>
     <mrow>
      <mi>c</mi>
      <mtext>ùêü</mtext>
     </mrow>
    </mrow>
    <mo>-</mo>
    <mrow>
     <mi>q</mi>
     <mi>K</mi>
    </mrow>
   </mrow>
   <mspace width="veryverythickmathspace">
   </mspace>
   <mrow>
    <mo lspace="8.1pt" stretchy="false">(</mo>
    <mrow>
     <mo>mod</mo>
     <mi>p</mi>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">annotated</csymbol>
    <apply>
     <minus></minus>
     <apply>
      <plus></plus>
      <apply>
       <times></times>
       <ci>c</ci>
       <mtext>g</mtext>
      </apply>
      <apply>
       <times></times>
       <ci>c</ci>
       <mtext>f</mtext>
      </apply>
     </apply>
     <apply>
      <times></times>
      <ci>q</ci>
      <ci>K</ci>
     </apply>
    </apply>
    <apply>
     <ci>pmod</ci>
     <ci>p</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \ c\textbf{g}+c\textbf{f}-qK\;\;(\mathop{{\rm mod}}p)
  </annotation>
 </semantics>
</math>

. After multiplication with 

<math display="inline" id="NTRUEncrypt:75">
 <semantics>
  <msub>
   <mpadded lspace="5pt" width="+5pt">
    <mtext>ùêü</mtext>
   </mpadded>
   <mi>p</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <mtext>f</mtext>
    <ci>p</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \ \textbf{f}_{p}
  </annotation>
 </semantics>
</math>

, Eve finds:</p>

<p>

<math display="block" id="NTRUEncrypt:76">
 <semantics>
  <mrow>
   <mtext>ùê¶</mtext>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mrow>
      <mrow>
       <mrow>
        <mi>c</mi>
        <msub>
         <mtext>ùêü</mtext>
         <mi>p</mi>
        </msub>
       </mrow>
       <mo>‚ãÖ</mo>
       <mtext>ùê†</mtext>
      </mrow>
      <mo>+</mo>
      <mrow>
       <mrow>
        <mi>c</mi>
        <msub>
         <mtext>ùêü</mtext>
         <mi>p</mi>
        </msub>
       </mrow>
       <mo>‚ãÖ</mo>
       <mtext>ùêü</mtext>
      </mrow>
     </mrow>
     <mo>-</mo>
     <mrow>
      <mrow>
       <mi>q</mi>
       <msub>
        <mtext>ùêü</mtext>
        <mi>p</mi>
       </msub>
      </mrow>
      <mo>‚ãÖ</mo>
      <mi>K</mi>
     </mrow>
    </mrow>
    <mspace width="veryverythickmathspace">
    </mspace>
    <mrow>
     <mo lspace="8.1pt" stretchy="false">(</mo>
     <mrow>
      <mo>mod</mo>
      <mi>p</mi>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <mtext>m</mtext>
    <apply>
     <csymbol cd="latexml">annotated</csymbol>
     <apply>
      <minus></minus>
      <apply>
       <plus></plus>
       <apply>
        <ci>normal-‚ãÖ</ci>
        <apply>
         <times></times>
         <ci>c</ci>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <mtext>f</mtext>
          <ci>p</ci>
         </apply>
        </apply>
        <mtext>g</mtext>
       </apply>
       <apply>
        <ci>normal-‚ãÖ</ci>
        <apply>
         <times></times>
         <ci>c</ci>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <mtext>f</mtext>
          <ci>p</ci>
         </apply>
        </apply>
        <mtext>f</mtext>
       </apply>
      </apply>
      <apply>
       <ci>normal-‚ãÖ</ci>
       <apply>
        <times></times>
        <ci>q</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <mtext>f</mtext>
         <ci>p</ci>
        </apply>
       </apply>
       <ci>K</ci>
      </apply>
     </apply>
     <apply>
      <ci>pmod</ci>
      <ci>p</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \textbf{m}=c\textbf{f}_{p}\cdot\textbf{g}+c\textbf{f}_{p}\cdot\textbf{f}-q%
\textbf{f}_{p}\cdot K\;\;(\mathop{{\rm mod}}p)
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="NTRUEncrypt:77">
 <semantics>
  <mrow>
   <mtext>ùê¶</mtext>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mrow>
      <mrow>
       <mi>c</mi>
       <mtext>ùê°</mtext>
      </mrow>
      <mo>+</mo>
      <mi>c</mi>
     </mrow>
     <mo>-</mo>
     <mrow>
      <mrow>
       <mi>q</mi>
       <msub>
        <mtext>ùêü</mtext>
        <mi>p</mi>
       </msub>
      </mrow>
      <mo>‚ãÖ</mo>
      <mi>K</mi>
     </mrow>
    </mrow>
    <mspace width="veryverythickmathspace">
    </mspace>
    <mrow>
     <mo lspace="8.1pt" stretchy="false">(</mo>
     <mrow>
      <mo>mod</mo>
      <mi>p</mi>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <mtext>m</mtext>
    <apply>
     <csymbol cd="latexml">annotated</csymbol>
     <apply>
      <minus></minus>
      <apply>
       <plus></plus>
       <apply>
        <times></times>
        <ci>c</ci>
        <mtext>h</mtext>
       </apply>
       <ci>c</ci>
      </apply>
      <apply>
       <ci>normal-‚ãÖ</ci>
       <apply>
        <times></times>
        <ci>q</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <mtext>f</mtext>
         <ci>p</ci>
        </apply>
       </apply>
       <ci>K</ci>
      </apply>
     </apply>
     <apply>
      <ci>pmod</ci>
      <ci>p</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \textbf{m}=c\textbf{h}+c-q\textbf{f}_{p}\cdot K\;\;(\mathop{{\rm mod}}p)
  </annotation>
 </semantics>
</math>

</p>

<p>Because c was chosen to be a multiple of <em>p</em>, <strong>m</strong> can be written as</p>

<p>

<math display="block" id="NTRUEncrypt:78">
 <semantics>
  <mrow>
   <mtext>ùê¶</mtext>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mo>-</mo>
     <mrow>
      <mrow>
       <mi>q</mi>
       <msub>
        <mtext>ùêü</mtext>
        <mi>p</mi>
       </msub>
      </mrow>
      <mo>‚ãÖ</mo>
      <mi>K</mi>
     </mrow>
    </mrow>
    <mspace width="veryverythickmathspace">
    </mspace>
    <mrow>
     <mo lspace="8.1pt" stretchy="false">(</mo>
     <mrow>
      <mo>mod</mo>
      <mi>p</mi>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <mtext>m</mtext>
    <apply>
     <csymbol cd="latexml">annotated</csymbol>
     <apply>
      <minus></minus>
      <apply>
       <ci>normal-‚ãÖ</ci>
       <apply>
        <times></times>
        <ci>q</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <mtext>f</mtext>
         <ci>p</ci>
        </apply>
       </apply>
       <ci>K</ci>
      </apply>
     </apply>
     <apply>
      <ci>pmod</ci>
      <ci>p</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \textbf{m}=-q\textbf{f}_{p}\cdot K\;\;(\mathop{{\rm mod}}p)
  </annotation>
 </semantics>
</math>

</p>

<p>Which means that 

<math display="inline" id="NTRUEncrypt:79">
 <semantics>
  <mrow>
   <mpadded lspace="5pt" width="+5pt">
    <mtext>ùêü</mtext>
   </mpadded>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mo>-</mo>
     <mrow>
      <mrow>
       <mi>q</mi>
       <mi>K</mi>
      </mrow>
      <mo>‚ãÖ</mo>
      <msup>
       <mtext>ùê¶</mtext>
       <mrow>
        <mo>-</mo>
        <mn>1</mn>
       </mrow>
      </msup>
     </mrow>
    </mrow>
    <mspace width="veryverythickmathspace">
    </mspace>
    <mrow>
     <mo lspace="8.1pt" stretchy="false">(</mo>
     <mrow>
      <mo>mod</mo>
      <mi>p</mi>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <mtext>f</mtext>
    <apply>
     <csymbol cd="latexml">annotated</csymbol>
     <apply>
      <minus></minus>
      <apply>
       <ci>normal-‚ãÖ</ci>
       <apply>
        <times></times>
        <ci>q</ci>
        <ci>K</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <mtext>m</mtext>
        <apply>
         <minus></minus>
         <cn type="integer">1</cn>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <ci>pmod</ci>
      <ci>p</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \ \textbf{f}=-qK\cdot\textbf{m}^{-1}\;\;(\mathop{{\rm mod}}p)
  </annotation>
 </semantics>
</math>

.</p>

<p>Now if <strong>f</strong> and <strong>g</strong> have few coefficients which are the same at the same factors, <em>K</em> has few non zero coefficients and is thereby small. By trying different values of <em>K</em> the attacker can recover <strong>f</strong>.</p>

<p>By encrypting and decrypting a message according to the NTRUEncrypt the attacker can check whether the function <strong>f</strong> is the correct secret key or not.</p>
<h2 id="security-and-performance-improvements">Security and performance improvements</h2>

<p>Using the latest suggested parameters (see <a href="#Table_1:_Parameters" title="wikilink">below</a>) the NTRUEncrypt public key cryptosystem is secure to most attacks. There continues however to be a struggle between performance and security. It is hard to improve the security without slowing down the speed, and vice versa.</p>

<p>One way to speed up the process without damaging the effectiveness of the algorithm, is to make some changes in the secret key <strong>f</strong>. First, construct <strong>f</strong> such that 

<math display="inline" id="NTRUEncrypt:80">
 <semantics>
  <mrow>
   <mpadded lspace="5pt" width="+5pt">
    <mtext>ùêü</mtext>
   </mpadded>
   <mo>=</mo>
   <mrow>
    <mn>1</mn>
    <mo>+</mo>
    <mrow>
     <mi>p</mi>
     <mtext>ùêÖ</mtext>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <mtext>f</mtext>
    <apply>
     <plus></plus>
     <cn type="integer">1</cn>
     <apply>
      <times></times>
      <ci>p</ci>
      <mtext>F</mtext>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \ \textbf{f}=1+p\textbf{F}
  </annotation>
 </semantics>
</math>

, in which <strong>F</strong> is a small polynomial (i.e. coefficients {-1,0, 1}). By constructing <strong>f</strong> this way, <strong>f</strong> is invertible mod <em>p</em>. In fact 

<math display="inline" id="NTRUEncrypt:81">
 <semantics>
  <mrow>
   <msup>
    <mpadded lspace="5pt" width="+5pt">
     <mtext>ùêü</mtext>
    </mpadded>
    <mrow>
     <mo>-</mo>
     <mn>1</mn>
    </mrow>
   </msup>
   <mo>=</mo>
   <mrow>
    <mn>1</mn>
    <mspace width="veryverythickmathspace">
    </mspace>
    <mrow>
     <mo lspace="8.1pt" stretchy="false">(</mo>
     <mrow>
      <mo>mod</mo>
      <mi>p</mi>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <mtext>f</mtext>
     <apply>
      <minus></minus>
      <cn type="integer">1</cn>
     </apply>
    </apply>
    <apply>
     <csymbol cd="latexml">annotated</csymbol>
     <cn type="integer">1</cn>
     <apply>
      <ci>pmod</ci>
      <ci>p</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \ \textbf{f}^{-1}=1\;\;(\mathop{{\rm mod}}p)
  </annotation>
 </semantics>
</math>

, which means that Bob does not have to actually calculate the inverse and that Bob does not have to conduct the second step of decryption. Therefore constructing <strong>f</strong> this way saves a lot of time but it does not affect the security of the NTRUEncrypt because it is only easier to find 

<math display="inline" id="NTRUEncrypt:82">
 <semantics>
  <msub>
   <mpadded lspace="5pt" width="+5pt">
    <mtext>ùêü</mtext>
   </mpadded>
   <mi>p</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <mtext>f</mtext>
    <ci>p</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \ \textbf{f}_{p}
  </annotation>
 </semantics>
</math>

 but <strong>f</strong> is still hard to recover. In this case <strong>f</strong> has coefficients different from -1, 0 or 1, because of the multiplication by <em>p</em>. But because Bob multiplies by <em>p</em> to generate the public key <strong>h</strong>, and later on reduces the ciphertext modulo <em>p</em>, this will not have an effect on the encryption method.</p>

<p>Second, <strong>f</strong> can be written as the product of multiple polynomials, such that the polynomials have many zero coefficients. This way fewer calculations have to be conducted.</p>

<p>In most commercial applications of the NTRUEncrypt, the parameter <em>N</em>=251 is used. To avoid lattice attacks, brute force attacks and meet-in-the-middle attacks, <strong>f</strong> and <strong>g</strong> should have about 72 non-zero coefficients.</p>

<p>According to the latest research <a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a> the following parameters are considered secure:</p>
<h3 id="table-1-parameters">Table 1: Parameters</h3>
<table>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: left;">
<p><strong>N</strong></p></th>
<th style="text-align: left;">
<p><strong>q</strong></p></th>
<th style="text-align: left;">
<p><strong>p</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">
<p>Moderate Security</p></td>
<td style="text-align: left;">
<p>167</p></td>
<td style="text-align: left;">
<p>128</p></td>
<td style="text-align: left;">
<p>3</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>Standard Security</p></td>
<td style="text-align: left;">
<p>251</p></td>
<td style="text-align: left;">
<p>128</p></td>
<td style="text-align: left;">
<p>3</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>High Security</p></td>
<td style="text-align: left;">
<p>347</p></td>
<td style="text-align: left;">
<p>128</p></td>
<td style="text-align: left;">
<p>3</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>Highest Security</p></td>
<td style="text-align: left;">
<p>503</p></td>
<td style="text-align: left;">
<p>256</p></td>
<td style="text-align: left;">
<p>3</p></td>
</tr>
</tbody>
</table>
<h2 id="references">References</h2>
<ul>
<li>Jaulmes, E. and Joux, A. A Chosen-Ciphertext Attack against NTRU. Lecture notes in computer science; Vol 1880. Proceedings of the 20th Annual International Cryptology Conference on Advances in Cryptography. pp.¬†20‚Äì35, 2000.</li>
<li>Jeffrey Hoffstein, Jill Pipher, Joseph H. Silverman. <a href="http://www.ntru.com/cryptolab/pdf/ANTS97.pdf">NTRU: A Ring Based Public Key Cryptosystem</a>. In Algorithmic Number Theory (ANTS III), Portland, OR, June 1998, J.P. Buhler (ed.), Lecture Notes in Computer Science 1423, Springer-Verlag, Berlin, 1998, 267-288.</li>
<li>Howgrave-Graham, N., Silverman, J.H. &amp; Whyte, W., <a href="http://www.ntru.com/cryptolab/pdf/NTRUTech004v2.pdf">Meet-In-The-Middle Attack on a NTRU Private Key</a>.</li>
<li>J. Hoffstein, J. Silverman. <a href="http://www.ntru.com/cryptolab/pdf/TECH_ARTICLE_OPT.pdf">Optimizations for NTRU</a>. Public-Key Cryptography and Computational Number Theory (Warsaw, September 11‚Äì15, 2000), DeGruyter, to appear.</li>
<li>A. C. Atici, L. Batina, J. Fan &amp; I. Verbauwhede. <a href="http://www.cosic.esat.kuleuven.be/publications/article-1122.pdf">Low-cost implementations of NTRU for pervasive security</a>.</li>
</ul>
<h2 id="external-links">External links</h2>
<ul>
<li><a href="https://www.securityinnovation.com/products/encryption-libraries/ntru-cryptography.html/">NTRU technical website</a></li>
<li><a href="http://grouper.ieee.org/groups/1363">The IEEE P1363 Home Page</a></li>
<li><a href="http://www.securityinnovation.com/">Security Innovation (acquired NTRU Cryptosystems, Inc.)</a></li>
<li><a href="http://tbuktu.github.io/ntru">Open Source BSD license implementation of NTRUEncrypt</a></li>
<li><a href="https://github.com/NTRUOpenSourceProject/ntru-crypto/">Open Source GPL v2 license of NTRUEncrypt</a></li>
<li><a href="https://wiki.strongswan.org/projects/strongswan/wiki/NTRU">strongSwan Open Source IPsec solution using NTRUEncrypt-based key exchange</a></li>
<li><a href="http://www.yassl.com/yaSSL/Home.html">- Embedded SSL Library offering cipher suites utilizing NTRU</a></li>
</ul>

<p>"</p>

<p><a href="Category:Public-key_encryption_schemes" title="wikilink">Category:Public-key encryption schemes</a> <a href="Category:Lattice-based_cryptography" title="wikilink">Category:Lattice-based cryptography</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1"><a href="http://www.businesswire.com/news/home/20110411005309/en/Security-Innovation%E2%80%99s-NTRUEncrypt-Adopted-X9-Standard-Data">http://www.businesswire.com/news/home/20110411005309/en/Security-Innovation%E2%80%99s-NTRUEncrypt-Adopted-X9-Standard-Data</a><a href="#fnref1">‚Ü©</a></li>
<li id="fn2"><a href="http://www.securityinnovation.com/security-lab/crypto/155.html">NTRU PKCS Parameters</a><a href="#fnref2">‚Ü©</a></li>
</ol>
</section>
</body>
</html>

<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="1470">Cipolla's algorithm</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Cipolla's algorithm</h1>
<hr/>

<p>In <a href="computational_number_theory" title="wikilink">computational number theory</a>, <strong>Cipolla's algorithm</strong> is a technique for solving a <a href="Congruence_relation" title="wikilink">congruence</a> of the form</p>

<p>

<math display="block" id="Cipolla's_algorithm:0">
 <semantics>
  <mrow>
   <mrow>
    <msup>
     <mi>x</mi>
     <mn>2</mn>
    </msup>
    <mo>‚â°</mo>
    <mrow>
     <mi>n</mi>
     <mspace width="veryverythickmathspace">
     </mspace>
     <mrow>
      <mo lspace="8.1pt" stretchy="false">(</mo>
      <mrow>
       <mo>mod</mo>
       <mi>p</mi>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <equivalent></equivalent>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>x</ci>
     <cn type="integer">2</cn>
    </apply>
    <apply>
     <csymbol cd="latexml">annotated</csymbol>
     <ci>n</ci>
     <apply>
      <ci>pmod</ci>
      <ci>p</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x^{2}\equiv n\;\;(\mathop{{\rm mod}}p).
  </annotation>
 </semantics>
</math>

</p>

<p>where 

<math display="inline" id="Cipolla's_algorithm:1">
 <semantics>
  <mrow>
   <mrow>
    <mi>x</mi>
    <mo>,</mo>
    <mi>n</mi>
   </mrow>
   <mo>‚àà</mo>
   <msub>
    <mi>ùêÖ</mi>
    <mi>p</mi>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <in></in>
    <list>
     <ci>x</ci>
     <ci>n</ci>
    </list>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>ùêÖ</ci>
     <ci>p</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x,n\in\mathbf{F}_{p}
  </annotation>
 </semantics>
</math>

, so <em>n</em> is the square of <em>x</em>, and where 

<math display="inline" id="Cipolla's_algorithm:2">
 <semantics>
  <mi>p</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>p</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p
  </annotation>
 </semantics>
</math>

 is an <a href="Parity_(mathematics)" title="wikilink">odd</a> <a href="Prime_number" title="wikilink">prime</a>. Here 

<math display="inline" id="Cipolla's_algorithm:3">
 <semantics>
  <msub>
   <mi>ùêÖ</mi>
   <mi>p</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>ùêÖ</ci>
    <ci>p</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{F}_{p}
  </annotation>
 </semantics>
</math>


 denotes the finite <a href="Field_(mathematics)" title="wikilink">field</a> with 

<math display="inline" id="Cipolla's_algorithm:4">
 <semantics>
  <mi>p</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>p</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p
  </annotation>
 </semantics>
</math>

 <a href="Element_(mathematics)" title="wikilink">elements</a>; 

<math display="inline" id="Cipolla's_algorithm:5">
 <semantics>
  <mrow>
   <mo stretchy="false">{</mo>
   <mn>0</mn>
   <mo>,</mo>
   <mn>1</mn>
   <mo>,</mo>
   <mi mathvariant="normal">‚Ä¶</mi>
   <mo>,</mo>
   <mrow>
    <mi>p</mi>
    <mo>-</mo>
    <mn>1</mn>
   </mrow>
   <mo stretchy="false">}</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <set>
    <cn type="integer">0</cn>
    <cn type="integer">1</cn>
    <ci>normal-‚Ä¶</ci>
    <apply>
     <minus></minus>
     <ci>p</ci>
     <cn type="integer">1</cn>
    </apply>
   </set>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \{0,1,\dots,p-1\}
  </annotation>
 </semantics>
</math>

. The <a class="uri" href="algorithm" title="wikilink">algorithm</a> is named after <a href="Michele_Cipolla" title="wikilink">Michele Cipolla</a>, an <a href="Italy" title="wikilink">Italian</a> <a href="Mathematics" title="wikilink">mathematician</a> who discovered it in the year 1907.</p>
<h2 id="the-algorithm">The algorithm</h2>

<p><strong>Inputs:</strong></p>
<ul>
<li>

<math display="inline" id="Cipolla's_algorithm:6">
 <semantics>
  <mi>p</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>p</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p
  </annotation>
 </semantics>
</math>

, an odd prime,</li>
<li>

<math display="inline" id="Cipolla's_algorithm:7">
 <semantics>
  <mrow>
   <mi>n</mi>
   <mo>‚àà</mo>
   <msub>
    <mi>ùêÖ</mi>
    <mi>p</mi>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <in></in>
    <ci>n</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>ùêÖ</ci>
     <ci>p</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n\in\mathbf{F}_{p}
  </annotation>
 </semantics>
</math>

, which is a square.</li>
</ul>

<p><strong>Outputs:</strong></p>
<ul>
<li>

<math display="inline" id="Cipolla's_algorithm:8">
 <semantics>
  <mrow>
   <mi>x</mi>
   <mo>‚àà</mo>
   <msub>
    <mi>ùêÖ</mi>
    <mi>p</mi>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <in></in>
    <ci>x</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>ùêÖ</ci>
     <ci>p</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x\in\mathbf{F}_{p}
  </annotation>
 </semantics>
</math>


, satisfying 

<math display="inline" id="Cipolla's_algorithm:9">
 <semantics>
  <mrow>
   <mrow>
    <msup>
     <mi>x</mi>
     <mn>2</mn>
    </msup>
    <mo>=</mo>
    <mi>n</mi>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>x</ci>
     <cn type="integer">2</cn>
    </apply>
    <ci>n</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x^{2}=n.
  </annotation>
 </semantics>
</math>

</li>
</ul>

<p>Step 1 is to find an 

<math display="inline" id="Cipolla's_algorithm:10">
 <semantics>
  <mrow>
   <mi>a</mi>
   <mo>‚àà</mo>
   <msub>
    <mi>ùêÖ</mi>
    <mi>p</mi>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <in></in>
    <ci>a</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>ùêÖ</ci>
     <ci>p</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a\in\mathbf{F}_{p}
  </annotation>
 </semantics>
</math>

 such that 

<math display="inline" id="Cipolla's_algorithm:11">
 <semantics>
  <mrow>
   <msup>
    <mi>a</mi>
    <mn>2</mn>
   </msup>
   <mo>-</mo>
   <mi>n</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <minus></minus>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>a</ci>
     <cn type="integer">2</cn>
    </apply>
    <ci>n</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a^{2}-n
  </annotation>
 </semantics>
</math>

 is not a square. There is no known algorithm for finding such an 

<math display="inline" id="Cipolla's_algorithm:12">
 <semantics>
  <mi>a</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>a</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a
  </annotation>
 </semantics>
</math>

, except the <a href="trial_and_error" title="wikilink">trial and error</a> method. Simply pick an 

<math display="inline" id="Cipolla's_algorithm:13">
 <semantics>
  <mi>a</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>a</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a
  </annotation>
 </semantics>
</math>


 and by computing the <a href="Legendre_symbol" title="wikilink">Legendre symbol</a> 

<math display="inline" id="Cipolla's_algorithm:14">
 <semantics>
  <mrow>
   <mo stretchy="false">(</mo>
   <msup>
    <mi>a</mi>
    <mn>2</mn>
   </msup>
   <mo>-</mo>
   <mi>n</mi>
   <mo stretchy="false">|</mo>
   <mi>p</mi>
   <mo stretchy="false">)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <ci>normal-(</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>a</ci>
     <cn type="integer">2</cn>
    </apply>
    <minus></minus>
    <csymbol cd="unknown">n</csymbol>
    <ci>normal-|</ci>
    <csymbol cd="unknown">p</csymbol>
    <ci>normal-)</ci>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (a^{2}-n|p)
  </annotation>
 </semantics>
</math>

 one can see whether 

<math display="inline" id="Cipolla's_algorithm:15">
 <semantics>
  <mi>a</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>a</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a
  </annotation>
 </semantics>
</math>

 satisfies the condition. The chance that a random 

<math display="inline" id="Cipolla's_algorithm:16">
 <semantics>
  <mi>a</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>a</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a
  </annotation>
 </semantics>
</math>

 will satisfy is 

<math display="inline" id="Cipolla's_algorithm:17">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>p</mi>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
    <mo>/</mo>
    <mn>2</mn>
   </mrow>
   <mi>p</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <divide></divide>
     <apply>
      <minus></minus>
      <ci>p</ci>
      <cn type="integer">1</cn>
     </apply>
     <cn type="integer">2</cn>
    </apply>
    <ci>p</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (p-1)/2p
  </annotation>
 </semantics>
</math>

. With 

<math display="inline" id="Cipolla's_algorithm:18">
 <semantics>
  <mi>p</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>p</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p
  </annotation>
 </semantics>
</math>


 large enough this is about 

<math display="inline" id="Cipolla's_algorithm:19">
 <semantics>
  <mrow>
   <mn>1</mn>
   <mo>/</mo>
   <mn>2</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <divide></divide>
    <cn type="integer">1</cn>
    <cn type="integer">2</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   1/2
  </annotation>
 </semantics>
</math>

.<a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a> Therefore, the expected number of trials before finding a suitable <em>a</em> is about 2.</p>

<p>Step 2 is to compute <em>x</em> by computing 

<math display="inline" id="Cipolla's_algorithm:20">
 <semantics>
  <mrow>
   <mi>x</mi>
   <mo>=</mo>
   <msup>
    <mrow>
     <mo>(</mo>
     <mrow>
      <mi>a</mi>
      <mo>+</mo>
      <msqrt>
       <mrow>
        <msup>
         <mi>a</mi>
         <mn>2</mn>
        </msup>
        <mo>-</mo>
        <mi>n</mi>
       </mrow>
      </msqrt>
     </mrow>
     <mo>)</mo>
    </mrow>
    <mrow>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mi>p</mi>
       <mo>+</mo>
       <mn>1</mn>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <mo>/</mo>
     <mn>2</mn>
    </mrow>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>x</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <plus></plus>
      <ci>a</ci>
      <apply>
       <root></root>
       <apply>
        <minus></minus>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>a</ci>
         <cn type="integer">2</cn>
        </apply>
        <ci>n</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <divide></divide>
      <apply>
       <plus></plus>
       <ci>p</ci>
       <cn type="integer">1</cn>
      </apply>
      <cn type="integer">2</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x=\left(a+\sqrt{a^{2}-n}\right)^{(p+1)/2}
  </annotation>
 </semantics>
</math>

 within the field 

<math display="inline" id="Cipolla's_algorithm:21">
 <semantics>
  <mrow>
   <msub>
    <mi>ùêÖ</mi>
    <msup>
     <mi>p</mi>
     <mn>2</mn>
    </msup>
   </msub>
   <mo>=</mo>
   <mrow>
    <msub>
     <mi>ùêÖ</mi>
     <mi>p</mi>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <msqrt>
      <mrow>
       <msup>
        <mi>a</mi>
        <mn>2</mn>
       </msup>
       <mo>-</mo>
       <mi>n</mi>
      </mrow>
     </msqrt>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>ùêÖ</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>p</ci>
      <cn type="integer">2</cn>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>ùêÖ</ci>
      <ci>p</ci>
     </apply>
     <apply>
      <root></root>
      <apply>
       <minus></minus>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>a</ci>
        <cn type="integer">2</cn>
       </apply>
       <ci>n</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{F}_{p^{2}}=\mathbf{F}_{p}(\sqrt{a^{2}-n})
  </annotation>
 </semantics>
</math>

. This <em>x</em> will be the one satisfying 

<math display="inline" id="Cipolla's_algorithm:22">
 <semantics>
  <mrow>
   <mrow>
    <msup>
     <mi>x</mi>
     <mn>2</mn>
    </msup>
    <mo>=</mo>
    <mi>n</mi>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>x</ci>
     <cn type="integer">2</cn>
    </apply>
    <ci>n</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x^{2}=n.
  </annotation>
 </semantics>
</math>

</p>

<p>If 

<math display="inline" id="Cipolla's_algorithm:23">
 <semantics>
  <mrow>
   <msup>
    <mi>x</mi>
    <mn>2</mn>
   </msup>
   <mo>=</mo>
   <mi>n</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>x</ci>
     <cn type="integer">2</cn>
    </apply>
    <ci>n</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x^{2}=n
  </annotation>
 </semantics>
</math>


, then 

<math display="inline" id="Cipolla's_algorithm:24">
 <semantics>
  <mrow>
   <msup>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mo>-</mo>
      <mi>x</mi>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
    <mn>2</mn>
   </msup>
   <mo>=</mo>
   <mi>n</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <minus></minus>
      <ci>x</ci>
     </apply>
     <cn type="integer">2</cn>
    </apply>
    <ci>n</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (-x)^{2}=n
  </annotation>
 </semantics>
</math>

 also holds. And since <em>p</em> is odd, 

<math display="inline" id="Cipolla's_algorithm:25">
 <semantics>
  <mrow>
   <mi>x</mi>
   <mo>‚â†</mo>
   <mrow>
    <mo>-</mo>
    <mi>x</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <neq></neq>
    <ci>x</ci>
    <apply>
     <minus></minus>
     <ci>x</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x\neq-x
  </annotation>
 </semantics>
</math>

. So whenever a solution <em>x</em> is found, there's always a second solution, <em>-x</em>.</p>
<h2 id="example">Example</h2>

<p>(Note: All elements before step two are considered as an element of 

<math display="inline" id="Cipolla's_algorithm:26">
 <semantics>
  <msub>
   <mi>ùêÖ</mi>
   <mn>13</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>ùêÖ</ci>
    <cn type="integer">13</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{F}_{13}
  </annotation>
 </semantics>
</math>

 and all elements in step two are considered as elements of 

<math display="inline" id="Cipolla's_algorithm:27">
 <semantics>
  <msub>
   <mi>ùêÖ</mi>
   <msup>
    <mn>13</mn>
    <mn>2</mn>
   </msup>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>ùêÖ</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <cn type="integer">13</cn>
     <cn type="integer">2</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{F}_{13^{2}}
  </annotation>
 </semantics>
</math>

).</p>

<p>Find all <em>x</em> such that 

<math display="inline" id="Cipolla's_algorithm:28">
 <semantics>
  <mrow>
   <msup>
    <mi>x</mi>
    <mn>2</mn>
   </msup>
   <mo>=</mo>
   <mn>10.</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>x</ci>
     <cn type="integer">2</cn>
    </apply>
    <cn type="float">10.</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x^{2}=10.
  </annotation>
 </semantics>
</math>


</p>

<p>Before applying the algorithm, it must be checked that 

<math display="inline" id="Cipolla's_algorithm:29">
 <semantics>
  <mn>10</mn>
  <annotation-xml encoding="MathML-Content">
   <cn type="integer">10</cn>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   10
  </annotation>
 </semantics>
</math>

 is indeed a square in 

<math display="inline" id="Cipolla's_algorithm:30">
 <semantics>
  <msub>
   <mi>ùêÖ</mi>
   <mn>13</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>ùêÖ</ci>
    <cn type="integer">13</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{F}_{13}
  </annotation>
 </semantics>
</math>

. Therefore, the Legendre symbol 

<math display="inline" id="Cipolla's_algorithm:31">
 <semantics>
  <mrow>
   <mo stretchy="false">(</mo>
   <mn>10</mn>
   <mo stretchy="false">|</mo>
   <mn>13</mn>
   <mo stretchy="false">)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <ci>normal-(</ci>
    <cn type="integer">10</cn>
    <ci>normal-|</ci>
    <cn type="integer">13</cn>
    <ci>normal-)</ci>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (10|13)
  </annotation>
 </semantics>
</math>

 has to be equal to 1. This can be computed using <a href="Euler's_criterion" title="wikilink">Euler's criterion</a>; 

<math display="inline" id="Cipolla's_algorithm:32">
 <semantics>
  <mrow>
   <mrow>
    <mo stretchy="false">(</mo>
    <mn>10</mn>
    <mo stretchy="false">|</mo>
    <mn>13</mn>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>‚â°</mo>
   <msup>
    <mn>10</mn>
    <mn>6</mn>
   </msup>
   <mo>‚â°</mo>
   <mn>1</mn>
   <mo lspace="2.5pt" rspace="2.5pt">mod</mo>
   <mn>13.</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <cn type="integer">10</cn>
     <ci>normal-|</ci>
     <cn type="integer">13</cn>
     <ci>normal-)</ci>
    </cerror>
    <equivalent></equivalent>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <cn type="integer">10</cn>
     <cn type="integer">6</cn>
    </apply>
    <equivalent></equivalent>
    <cn type="integer">1</cn>
    <csymbol cd="latexml">modulo</csymbol>
    <cn type="float">13.</cn>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (10|13)\equiv 10^{6}\equiv 1\bmod 13.
  </annotation>
 </semantics>
</math>

 This confirms 10 being a square and hence the algorithm can be applied.</p>
<ul>
<li>Step 1: Find an <em>a</em> such that 

<math display="inline" id="Cipolla's_algorithm:33">
 <semantics>
  <mrow>
   <msup>
    <mi>a</mi>
    <mn>2</mn>
   </msup>
   <mo>-</mo>
   <mi>n</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <minus></minus>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>a</ci>
     <cn type="integer">2</cn>
    </apply>
    <ci>n</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a^{2}-n
  </annotation>
 </semantics>
</math>


 is not a square. As stated, this has to be done by trial and error. Choose 

<math display="inline" id="Cipolla's_algorithm:34">
 <semantics>
  <mrow>
   <mi>a</mi>
   <mo>=</mo>
   <mn>2</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>a</ci>
    <cn type="integer">2</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a=2
  </annotation>
 </semantics>
</math>

. Then 

<math display="inline" id="Cipolla's_algorithm:35">
 <semantics>
  <mrow>
   <msup>
    <mi>a</mi>
    <mn>2</mn>
   </msup>
   <mo>-</mo>
   <mi>n</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <minus></minus>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>a</ci>
     <cn type="integer">2</cn>
    </apply>
    <ci>n</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a^{2}-n
  </annotation>
 </semantics>
</math>

 becomes 7. The Legendre symbol 

<math display="inline" id="Cipolla's_algorithm:36">
 <semantics>
  <mrow>
   <mo stretchy="false">(</mo>
   <mn>7</mn>
   <mo stretchy="false">|</mo>
   <mn>13</mn>
   <mo stretchy="false">)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <ci>normal-(</ci>
    <cn type="integer">7</cn>
    <ci>normal-|</ci>
    <cn type="integer">13</cn>
    <ci>normal-)</ci>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (7|13)
  </annotation>
 </semantics>
</math>

 has to be -1. Again this can be computed using Euler's criterion. 

<math display="inline" id="Cipolla's_algorithm:37">
 <semantics>
  <mrow>
   <msup>
    <mn>7</mn>
    <mn>6</mn>
   </msup>
   <mo>=</mo>
   <msup>
    <mn>343</mn>
    <mn>2</mn>
   </msup>
   <mo>‚â°</mo>
   <msup>
    <mn>5</mn>
    <mn>2</mn>
   </msup>
   <mo>‚â°</mo>
   <mn>25</mn>
   <mo>‚â°</mo>
   <mrow>
    <mrow>
     <mo>-</mo>
     <mn>1</mn>
    </mrow>
    <mo lspace="2.5pt" rspace="2.5pt">mod</mo>
    <mn>13.</mn>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <cn type="integer">7</cn>
      <cn type="integer">6</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <cn type="integer">343</cn>
      <cn type="integer">2</cn>
     </apply>
    </apply>
    <apply>
     <equivalent></equivalent>
     <share href="#.cmml">
     </share>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <cn type="integer">5</cn>
      <cn type="integer">2</cn>
     </apply>
    </apply>
    <apply>
     <equivalent></equivalent>
     <share href="#.cmml">
     </share>
     <cn type="integer">25</cn>
    </apply>
    <apply>
     <equivalent></equivalent>
     <share href="#.cmml">
     </share>
     <apply>
      <csymbol cd="latexml">modulo</csymbol>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
      </apply>
      <cn type="float">13.</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   7^{6}=343^{2}\equiv 5^{2}\equiv 25\equiv-1\bmod 13.
  </annotation>
 </semantics>
</math>

 So 

<math display="inline" id="Cipolla's_algorithm:38">
 <semantics>
  <mrow>
   <mi>a</mi>
   <mo>=</mo>
   <mn>2</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>a</ci>
    <cn type="integer">2</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a=2
  </annotation>
 </semantics>
</math>


 is a suitable choice for <em>a</em>.</li>
<li>Step 2: Compute 

<math display="inline" id="Cipolla's_algorithm:39">
 <semantics>
  <mrow>
   <mrow>
    <mi>x</mi>
    <mo>=</mo>
    <msup>
     <mrow>
      <mo>(</mo>
      <mrow>
       <mi>a</mi>
       <mo>+</mo>
       <msqrt>
        <mrow>
         <msup>
          <mi>a</mi>
          <mn>2</mn>
         </msup>
         <mo>-</mo>
         <mi>n</mi>
        </mrow>
       </msqrt>
      </mrow>
      <mo>)</mo>
     </mrow>
     <mrow>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mi>p</mi>
        <mo>+</mo>
        <mn>1</mn>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
      <mo>/</mo>
      <mn>2</mn>
     </mrow>
    </msup>
    <mo>=</mo>
    <msup>
     <mrow>
      <mo>(</mo>
      <mrow>
       <mn>2</mn>
       <mo>+</mo>
       <msqrt>
        <mrow>
         <mo>-</mo>
         <mn>6</mn>
        </mrow>
       </msqrt>
      </mrow>
      <mo>)</mo>
     </mrow>
     <mn>7</mn>
    </msup>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <ci>x</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <plus></plus>
       <ci>a</ci>
       <apply>
        <root></root>
        <apply>
         <minus></minus>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>a</ci>
          <cn type="integer">2</cn>
         </apply>
         <ci>n</ci>
        </apply>
       </apply>
      </apply>
      <apply>
       <divide></divide>
       <apply>
        <plus></plus>
        <ci>p</ci>
        <cn type="integer">1</cn>
       </apply>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <plus></plus>
       <cn type="integer">2</cn>
       <apply>
        <root></root>
        <apply>
         <minus></minus>
         <cn type="integer">6</cn>
        </apply>
       </apply>
      </apply>
      <cn type="integer">7</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x=\left(a+\sqrt{a^{2}-n}\right)^{(p+1)/2}=\left(2+\sqrt{-6}\right)^{7}.
  </annotation>
 </semantics>
</math>

</li>
</ul>

<p>

<math display="block" id="Cipolla's_algorithm:40">
 <semantics>
  <mrow>
   <mrow>
    <msup>
     <mrow>
      <mo>(</mo>
      <mrow>
       <mn>2</mn>
       <mo>+</mo>
       <msqrt>
        <mrow>
         <mo>-</mo>
         <mn>6</mn>
        </mrow>
       </msqrt>
      </mrow>
      <mo>)</mo>
     </mrow>
     <mn>2</mn>
    </msup>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mn>4</mn>
      <mo>+</mo>
      <mrow>
       <mn>4</mn>
       <msqrt>
        <mrow>
         <mo>-</mo>
         <mn>6</mn>
        </mrow>
       </msqrt>
      </mrow>
     </mrow>
     <mo>-</mo>
     <mn>6</mn>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mo>-</mo>
      <mn>2</mn>
     </mrow>
     <mo>+</mo>
     <mrow>
      <mn>4</mn>
      <msqrt>
       <mrow>
        <mo>-</mo>
        <mn>6</mn>
       </mrow>
      </msqrt>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <plus></plus>
       <cn type="integer">2</cn>
       <apply>
        <root></root>
        <apply>
         <minus></minus>
         <cn type="integer">6</cn>
        </apply>
       </apply>
      </apply>
      <cn type="integer">2</cn>
     </apply>
     <apply>
      <minus></minus>
      <apply>
       <plus></plus>
       <cn type="integer">4</cn>
       <apply>
        <times></times>
        <cn type="integer">4</cn>
        <apply>
         <root></root>
         <apply>
          <minus></minus>
          <cn type="integer">6</cn>
         </apply>
        </apply>
       </apply>
      </apply>
      <cn type="integer">6</cn>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <plus></plus>
      <apply>
       <minus></minus>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <times></times>
       <cn type="integer">4</cn>
       <apply>
        <root></root>
        <apply>
         <minus></minus>
         <cn type="integer">6</cn>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \left(2+\sqrt{-6}\right)^{2}=4+4\sqrt{-6}-6=-2+4\sqrt{-6}.
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Cipolla's_algorithm:41">
 <semantics>
  <mrow>
   <mrow>
    <msup>
     <mrow>
      <mo>(</mo>
      <mrow>
       <mn>2</mn>
       <mo>+</mo>
       <msqrt>
        <mrow>
         <mo>-</mo>
         <mn>6</mn>
        </mrow>
       </msqrt>
      </mrow>
      <mo>)</mo>
     </mrow>
     <mn>4</mn>
    </msup>
    <mo>=</mo>
    <msup>
     <mrow>
      <mo>(</mo>
      <mrow>
       <mrow>
        <mo>-</mo>
        <mn>2</mn>
       </mrow>
       <mo>+</mo>
       <mrow>
        <mn>4</mn>
        <msqrt>
         <mrow>
          <mo>-</mo>
          <mn>6</mn>
         </mrow>
        </msqrt>
       </mrow>
      </mrow>
      <mo>)</mo>
     </mrow>
     <mn>2</mn>
    </msup>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
     <mo>-</mo>
     <mrow>
      <mn>3</mn>
      <msqrt>
       <mrow>
        <mo>-</mo>
        <mn>6</mn>
       </mrow>
      </msqrt>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <plus></plus>
       <cn type="integer">2</cn>
       <apply>
        <root></root>
        <apply>
         <minus></minus>
         <cn type="integer">6</cn>
        </apply>
       </apply>
      </apply>
      <cn type="integer">4</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <plus></plus>
       <apply>
        <minus></minus>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <times></times>
        <cn type="integer">4</cn>
        <apply>
         <root></root>
         <apply>
          <minus></minus>
          <cn type="integer">6</cn>
         </apply>
        </apply>
       </apply>
      </apply>
      <cn type="integer">2</cn>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <minus></minus>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
      </apply>
      <apply>
       <times></times>
       <cn type="integer">3</cn>
       <apply>
        <root></root>
        <apply>
         <minus></minus>
         <cn type="integer">6</cn>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \left(2+\sqrt{-6}\right)^{4}=\left(-2+4\sqrt{-6}\right)^{2}=-1-3\sqrt{-6}.
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Cipolla's_algorithm:42">
 <semantics>
  <mrow>
   <mrow>
    <msup>
     <mrow>
      <mo>(</mo>
      <mrow>
       <mn>2</mn>
       <mo>+</mo>
       <msqrt>
        <mrow>
         <mo>-</mo>
         <mn>6</mn>
        </mrow>
       </msqrt>
      </mrow>
      <mo>)</mo>
     </mrow>
     <mn>6</mn>
    </msup>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mo>(</mo>
      <mrow>
       <mrow>
        <mo>-</mo>
        <mn>2</mn>
       </mrow>
       <mo>+</mo>
       <mrow>
        <mn>4</mn>
        <msqrt>
         <mrow>
          <mo>-</mo>
          <mn>6</mn>
         </mrow>
        </msqrt>
       </mrow>
      </mrow>
      <mo>)</mo>
     </mrow>
     <mrow>
      <mo>(</mo>
      <mrow>
       <mrow>
        <mo>-</mo>
        <mn>1</mn>
       </mrow>
       <mo>-</mo>
       <mrow>
        <mn>3</mn>
        <msqrt>
         <mrow>
          <mo>-</mo>
          <mn>6</mn>
         </mrow>
        </msqrt>
       </mrow>
      </mrow>
      <mo>)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mn>9</mn>
     <mo>+</mo>
     <mrow>
      <mn>2</mn>
      <msqrt>
       <mrow>
        <mo>-</mo>
        <mn>6</mn>
       </mrow>
      </msqrt>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <plus></plus>
       <cn type="integer">2</cn>
       <apply>
        <root></root>
        <apply>
         <minus></minus>
         <cn type="integer">6</cn>
        </apply>
       </apply>
      </apply>
      <cn type="integer">6</cn>
     </apply>
     <apply>
      <times></times>
      <apply>
       <plus></plus>
       <apply>
        <minus></minus>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <times></times>
        <cn type="integer">4</cn>
        <apply>
         <root></root>
         <apply>
          <minus></minus>
          <cn type="integer">6</cn>
         </apply>
        </apply>
       </apply>
      </apply>
      <apply>
       <minus></minus>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
       </apply>
       <apply>
        <times></times>
        <cn type="integer">3</cn>
        <apply>
         <root></root>
         <apply>
          <minus></minus>
          <cn type="integer">6</cn>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <plus></plus>
      <cn type="integer">9</cn>
      <apply>
       <times></times>
       <cn type="integer">2</cn>
       <apply>
        <root></root>
        <apply>
         <minus></minus>
         <cn type="integer">6</cn>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \left(2+\sqrt{-6}\right)^{6}=\left(-2+4\sqrt{-6}\right)\left(-1-3\sqrt{-6}%
\right)=9+2\sqrt{-6}.
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Cipolla's_algorithm:43">
 <semantics>
  <mrow>
   <msup>
    <mrow>
     <mo>(</mo>
     <mrow>
      <mn>2</mn>
      <mo>+</mo>
      <msqrt>
       <mrow>
        <mo>-</mo>
        <mn>6</mn>
       </mrow>
      </msqrt>
     </mrow>
     <mo>)</mo>
    </mrow>
    <mn>7</mn>
   </msup>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mo>(</mo>
     <mrow>
      <mn>9</mn>
      <mo>+</mo>
      <mrow>
       <mn>2</mn>
       <msqrt>
        <mrow>
         <mo>-</mo>
         <mn>6</mn>
        </mrow>
       </msqrt>
      </mrow>
     </mrow>
     <mo>)</mo>
    </mrow>
    <mrow>
     <mo>(</mo>
     <mrow>
      <mn>2</mn>
      <mo>+</mo>
      <msqrt>
       <mrow>
        <mo>-</mo>
        <mn>6</mn>
       </mrow>
      </msqrt>
     </mrow>
     <mo>)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mn>6.</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <plus></plus>
       <cn type="integer">2</cn>
       <apply>
        <root></root>
        <apply>
         <minus></minus>
         <cn type="integer">6</cn>
        </apply>
       </apply>
      </apply>
      <cn type="integer">7</cn>
     </apply>
     <apply>
      <times></times>
      <apply>
       <plus></plus>
       <cn type="integer">9</cn>
       <apply>
        <times></times>
        <cn type="integer">2</cn>
        <apply>
         <root></root>
         <apply>
          <minus></minus>
          <cn type="integer">6</cn>
         </apply>
        </apply>
       </apply>
      </apply>
      <apply>
       <plus></plus>
       <cn type="integer">2</cn>
       <apply>
        <root></root>
        <apply>
         <minus></minus>
         <cn type="integer">6</cn>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <cn type="float">6.</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \left(2+\sqrt{-6}\right)^{7}=\left(9+2\sqrt{-6}\right)\left(2+\sqrt{-6}\right)%
=6.
  </annotation>
 </semantics>
</math>

</p>

<p>So 

<math display="inline" id="Cipolla's_algorithm:44">
 <semantics>
  <mrow>
   <mi>x</mi>
   <mo>=</mo>
   <mn>6</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>x</ci>
    <cn type="integer">6</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x=6
  </annotation>
 </semantics>
</math>

 is a solution, as well as 

<math display="inline" id="Cipolla's_algorithm:45">
 <semantics>
  <mrow>
   <mi>x</mi>
   <mo>=</mo>
   <mrow>
    <mo>-</mo>
    <mn>6</mn>
   </mrow>
   <mo>=</mo>
   <mn>7.</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <ci>x</ci>
     <apply>
      <minus></minus>
      <cn type="integer">6</cn>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <cn type="float">7.</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x=-6=7.
  </annotation>
 </semantics>
</math>

 Indeed, 

<math display="inline" id="Cipolla's_algorithm:46">
 <semantics>
  <mrow>
   <msup>
    <mn>6</mn>
    <mn>2</mn>
   </msup>
   <mo>=</mo>
   <mn>36</mn>
   <mo>=</mo>
   <mn>10</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <cn type="float">6</cn>
      <cn type="integer">2</cn>
     </apply>
     <cn type="integer">36</cn>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <cn type="integer">10</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \ 6^{2}=36=10
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Cipolla's_algorithm:47">
 <semantics>
  <mrow>
   <msup>
    <mn>7</mn>
    <mn>2</mn>
   </msup>
   <mo>=</mo>
   <mn>49</mn>
   <mo>=</mo>
   <mn>10.</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <cn type="integer">7</cn>
      <cn type="integer">2</cn>
     </apply>
     <cn type="integer">49</cn>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <cn type="float">10.</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   7^{2}=49=10.
  </annotation>
 </semantics>
</math>

</p>
<h2 id="proof">Proof</h2>

<p>The first part of the proof is to verify that 

<math display="inline" id="Cipolla's_algorithm:48">
 <semantics>
  <mrow>
   <msub>
    <mi>ùêÖ</mi>
    <msup>
     <mi>p</mi>
     <mn>2</mn>
    </msup>
   </msub>
   <mo>=</mo>
   <mrow>
    <msub>
     <mi>ùêÖ</mi>
     <mi>p</mi>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <msqrt>
      <mrow>
       <msup>
        <mi>a</mi>
        <mn>2</mn>
       </msup>
       <mo>-</mo>
       <mi>n</mi>
      </mrow>
     </msqrt>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mo stretchy="false">{</mo>
    <mrow>
     <mi>x</mi>
     <mo>+</mo>
     <mrow>
      <mi>y</mi>
      <msqrt>
       <mrow>
        <msup>
         <mi>a</mi>
         <mn>2</mn>
        </msup>
        <mo>-</mo>
        <mi>n</mi>
       </mrow>
      </msqrt>
     </mrow>
    </mrow>
    <mo>:</mo>
    <mrow>
     <mrow>
      <mi>x</mi>
      <mo>,</mo>
      <mi>y</mi>
     </mrow>
     <mo>‚àà</mo>
     <msub>
      <mi>ùêÖ</mi>
      <mi>p</mi>
     </msub>
    </mrow>
    <mo stretchy="false">}</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>ùêÖ</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>p</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>ùêÖ</ci>
       <ci>p</ci>
      </apply>
      <apply>
       <root></root>
       <apply>
        <minus></minus>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>a</ci>
         <cn type="integer">2</cn>
        </apply>
        <ci>n</ci>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <csymbol cd="latexml">conditional-set</csymbol>
      <apply>
       <plus></plus>
       <ci>x</ci>
       <apply>
        <times></times>
        <ci>y</ci>
        <apply>
         <root></root>
         <apply>
          <minus></minus>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <ci>a</ci>
           <cn type="integer">2</cn>
          </apply>
          <ci>n</ci>
         </apply>
        </apply>
       </apply>
      </apply>
      <apply>
       <in></in>
       <list>
        <ci>x</ci>
        <ci>y</ci>
       </list>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>ùêÖ</ci>
        <ci>p</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{F}_{p^{2}}=\mathbf{F}_{p}(\sqrt{a^{2}-n})=\{x+y\sqrt{a^{2}-n}:x,y\in%
\mathbf{F}_{p}\}
  </annotation>
 </semantics>
</math>


 is indeed a field. For the sake of notation simplicity, 

<math display="inline" id="Cipolla's_algorithm:49">
 <semantics>
  <mi>œâ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>œâ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \omega
  </annotation>
 </semantics>
</math>

 is defined as 

<math display="inline" id="Cipolla's_algorithm:50">
 <semantics>
  <msqrt>
   <mrow>
    <msup>
     <mi>a</mi>
     <mn>2</mn>
    </msup>
    <mo>-</mo>
    <mi>n</mi>
   </mrow>
  </msqrt>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <root></root>
    <apply>
     <minus></minus>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>a</ci>
      <cn type="integer">2</cn>
     </apply>
     <ci>n</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \sqrt{a^{2}-n}
  </annotation>
 </semantics>
</math>

. Of course, 

<math display="inline" id="Cipolla's_algorithm:51">
 <semantics>
  <mrow>
   <msup>
    <mi>a</mi>
    <mn>2</mn>
   </msup>
   <mo>-</mo>
   <mi>n</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <minus></minus>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>a</ci>
     <cn type="integer">2</cn>
    </apply>
    <ci>n</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a^{2}-n
  </annotation>
 </semantics>
</math>

 is a quadratic non-residue, so there is no <a href="square_root" title="wikilink">square root</a> in 

<math display="inline" id="Cipolla's_algorithm:52">
 <semantics>
  <msub>
   <mi>ùêÖ</mi>
   <mi>p</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>ùêÖ</ci>
    <ci>p</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{F}_{p}
  </annotation>
 </semantics>
</math>

. This 

<math display="inline" id="Cipolla's_algorithm:53">
 <semantics>
  <mi>œâ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>œâ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \omega
  </annotation>
 </semantics>
</math>


 can roughly be seen as analogous to the complex number <a href="Imaginary_unit" title="wikilink">i</a>. The field arithmetic is quite obvious. <a class="uri" href="Addition" title="wikilink">Addition</a> is defined as</p>

<p>

<math display="block" id="Cipolla's_algorithm:54">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mo>(</mo>
     <mrow>
      <msub>
       <mi>x</mi>
       <mn>1</mn>
      </msub>
      <mo>+</mo>
      <mrow>
       <msub>
        <mi>y</mi>
        <mn>1</mn>
       </msub>
       <mi>œâ</mi>
      </mrow>
     </mrow>
     <mo>)</mo>
    </mrow>
    <mo>+</mo>
    <mrow>
     <mo>(</mo>
     <mrow>
      <msub>
       <mi>x</mi>
       <mn>2</mn>
      </msub>
      <mo>+</mo>
      <mrow>
       <msub>
        <mi>y</mi>
        <mn>2</mn>
       </msub>
       <mi>œâ</mi>
      </mrow>
     </mrow>
     <mo>)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mo>(</mo>
     <mrow>
      <msub>
       <mi>x</mi>
       <mn>1</mn>
      </msub>
      <mo>+</mo>
      <msub>
       <mi>x</mi>
       <mn>2</mn>
      </msub>
     </mrow>
     <mo>)</mo>
    </mrow>
    <mo>+</mo>
    <mrow>
     <mrow>
      <mo>(</mo>
      <mrow>
       <msub>
        <mi>y</mi>
        <mn>1</mn>
       </msub>
       <mo>+</mo>
       <msub>
        <mi>y</mi>
        <mn>2</mn>
       </msub>
      </mrow>
      <mo>)</mo>
     </mrow>
     <mi>œâ</mi>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <plus></plus>
     <apply>
      <plus></plus>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <cn type="integer">1</cn>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>y</ci>
        <cn type="integer">1</cn>
       </apply>
       <ci>œâ</ci>
      </apply>
     </apply>
     <apply>
      <plus></plus>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>y</ci>
        <cn type="integer">2</cn>
       </apply>
       <ci>œâ</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <plus></plus>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <cn type="integer">1</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <plus></plus>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>y</ci>
        <cn type="integer">1</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>y</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
      <ci>œâ</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \left(x_{1}+y_{1}\omega\right)+\left(x_{2}+y_{2}\omega\right)=\left(x_{1}+x_{2%
}\right)+\left(y_{1}+y_{2}\right)\omega
  </annotation>
 </semantics>
</math>

. <a class="uri" href="Multiplication" title="wikilink">Multiplication</a> is also defined as usual. With keeping in mind that 

<math display="inline" id="Cipolla's_algorithm:55">
 <semantics>
  <mrow>
   <msup>
    <mi>œâ</mi>
    <mn>2</mn>
   </msup>
   <mo>=</mo>
   <mrow>
    <msup>
     <mi>a</mi>
     <mn>2</mn>
    </msup>
    <mo>-</mo>
    <mi>n</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>œâ</ci>
     <cn type="integer">2</cn>
    </apply>
    <apply>
     <minus></minus>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>a</ci>
      <cn type="integer">2</cn>
     </apply>
     <ci>n</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \omega^{2}=a^{2}-n
  </annotation>
 </semantics>
</math>

, it becomes</p>

<p>

<math display="block" id="Cipolla's_algorithm:56">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mo>(</mo>
     <mrow>
      <msub>
       <mi>x</mi>
       <mn>1</mn>
      </msub>
      <mo>+</mo>
      <mrow>
       <msub>
        <mi>y</mi>
        <mn>1</mn>
       </msub>
       <mi>œâ</mi>
      </mrow>
     </mrow>
     <mo>)</mo>
    </mrow>
    <mrow>
     <mo>(</mo>
     <mrow>
      <msub>
       <mi>x</mi>
       <mn>2</mn>
      </msub>
      <mo>+</mo>
      <mrow>
       <msub>
        <mi>y</mi>
        <mn>2</mn>
       </msub>
       <mi>œâ</mi>
      </mrow>
     </mrow>
     <mo>)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <msub>
      <mi>x</mi>
      <mn>1</mn>
     </msub>
     <msub>
      <mi>x</mi>
      <mn>2</mn>
     </msub>
    </mrow>
    <mo>+</mo>
    <mrow>
     <msub>
      <mi>x</mi>
      <mn>1</mn>
     </msub>
     <msub>
      <mi>y</mi>
      <mn>2</mn>
     </msub>
     <mi>œâ</mi>
    </mrow>
    <mo>+</mo>
    <mrow>
     <msub>
      <mi>y</mi>
      <mn>1</mn>
     </msub>
     <msub>
      <mi>x</mi>
      <mn>2</mn>
     </msub>
     <mi>œâ</mi>
    </mrow>
    <mo>+</mo>
    <mrow>
     <msub>
      <mi>y</mi>
      <mn>1</mn>
     </msub>
     <msub>
      <mi>y</mi>
      <mn>2</mn>
     </msub>
     <msup>
      <mi>œâ</mi>
      <mn>2</mn>
     </msup>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mo>(</mo>
     <mrow>
      <mrow>
       <msub>
        <mi>x</mi>
        <mn>1</mn>
       </msub>
       <msub>
        <mi>x</mi>
        <mn>2</mn>
       </msub>
      </mrow>
      <mo>+</mo>
      <mrow>
       <msub>
        <mi>y</mi>
        <mn>1</mn>
       </msub>
       <msub>
        <mi>y</mi>
        <mn>2</mn>
       </msub>
       <mrow>
        <mo>(</mo>
        <mrow>
         <msup>
          <mi>a</mi>
          <mn>2</mn>
         </msup>
         <mo>-</mo>
         <mi>n</mi>
        </mrow>
        <mo>)</mo>
       </mrow>
      </mrow>
     </mrow>
     <mo>)</mo>
    </mrow>
    <mo>+</mo>
    <mrow>
     <mrow>
      <mo>(</mo>
      <mrow>
       <mrow>
        <msub>
         <mi>x</mi>
         <mn>1</mn>
        </msub>
        <msub>
         <mi>y</mi>
         <mn>2</mn>
        </msub>
       </mrow>
       <mo>+</mo>
       <mrow>
        <msub>
         <mi>y</mi>
         <mn>1</mn>
        </msub>
        <msub>
         <mi>x</mi>
         <mn>2</mn>
        </msub>
       </mrow>
      </mrow>
      <mo>)</mo>
     </mrow>
     <mi>œâ</mi>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <times></times>
      <apply>
       <plus></plus>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <cn type="integer">1</cn>
       </apply>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>y</ci>
         <cn type="integer">1</cn>
        </apply>
        <ci>œâ</ci>
       </apply>
      </apply>
      <apply>
       <plus></plus>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>y</ci>
         <cn type="integer">2</cn>
        </apply>
        <ci>œâ</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <plus></plus>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <cn type="integer">1</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <cn type="integer">1</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>y</ci>
        <cn type="integer">2</cn>
       </apply>
       <ci>œâ</ci>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>y</ci>
        <cn type="integer">1</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <cn type="integer">2</cn>
       </apply>
       <ci>œâ</ci>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>y</ci>
        <cn type="integer">1</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>y</ci>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>œâ</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <plus></plus>
      <apply>
       <plus></plus>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>x</ci>
         <cn type="integer">1</cn>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>x</ci>
         <cn type="integer">2</cn>
        </apply>
       </apply>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>y</ci>
         <cn type="integer">1</cn>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>y</ci>
         <cn type="integer">2</cn>
        </apply>
        <apply>
         <minus></minus>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>a</ci>
          <cn type="integer">2</cn>
         </apply>
         <ci>n</ci>
        </apply>
       </apply>
      </apply>
      <apply>
       <times></times>
       <apply>
        <plus></plus>
        <apply>
         <times></times>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>x</ci>
          <cn type="integer">1</cn>
         </apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>y</ci>
          <cn type="integer">2</cn>
         </apply>
        </apply>
        <apply>
         <times></times>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>y</ci>
          <cn type="integer">1</cn>
         </apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>x</ci>
          <cn type="integer">2</cn>
         </apply>
        </apply>
       </apply>
       <ci>œâ</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \left(x_{1}+y_{1}\omega\right)\left(x_{2}+y_{2}\omega\right)=x_{1}x_{2}+x_{1}y%
_{2}\omega+y_{1}x_{2}\omega+y_{1}y_{2}\omega^{2}=\left(x_{1}x_{2}+y_{1}y_{2}%
\left(a^{2}-n\right)\right)+\left(x_{1}y_{2}+y_{1}x_{2}\right)\omega
  </annotation>
 </semantics>
</math>

. Now the field properties have to be checked. The properties of closure under addition and multiplication, <a class="uri" href="associativity" title="wikilink">associativity</a>, <a class="uri" href="commutativity" title="wikilink">commutativity</a> and <a class="uri" href="distributivity" title="wikilink">distributivity</a> are easily seen. This is because in this case the field 

<math display="inline" id="Cipolla's_algorithm:57">
 <semantics>
  <msub>
   <mi>ùêÖ</mi>
   <msup>
    <mi>p</mi>
    <mn>2</mn>
   </msup>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>ùêÖ</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>p</ci>
     <cn type="integer">2</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{F}_{p^{2}}
  </annotation>
 </semantics>
</math>

 is somewhat equivalent to the field of <a href="complex_number" title="wikilink">complex numbers</a> (with 

<math display="inline" id="Cipolla's_algorithm:58">
 <semantics>
  <mi>œâ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>œâ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \omega
  </annotation>
 </semantics>
</math>


 being the analogon of <em>i</em>).<br/>
The additive <a href="Identity_element" title="wikilink">identity</a> is 

<math display="inline" id="Cipolla's_algorithm:59">
 <semantics>
  <mn>0</mn>
  <annotation-xml encoding="MathML-Content">
   <cn type="integer">0</cn>
  </annotation-xml>
 </semantics>
</math>

, more formal 

<math display="inline" id="Cipolla's_algorithm:60">
 <semantics>
  <mrow>
   <mn>0</mn>
   <mo>+</mo>
   <mrow>
    <mn>0</mn>
    <mi>œâ</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <plus></plus>
    <cn type="integer">0</cn>
    <apply>
     <times></times>
     <cn type="integer">0</cn>
     <ci>œâ</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   0+0\omega
  </annotation>
 </semantics>
</math>

: Let 

<math display="inline" id="Cipolla's_algorithm:61">
 <semantics>
  <mrow>
   <mi>Œ±</mi>
   <mo>‚àà</mo>
   <msub>
    <mi>ùêÖ</mi>
    <msup>
     <mi>p</mi>
     <mn>2</mn>
    </msup>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <in></in>
    <ci>Œ±</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>ùêÖ</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>p</ci>
      <cn type="integer">2</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \alpha\in\mathbf{F}_{p^{2}}
  </annotation>
 </semantics>
</math>

, then</p>

<p>

<math display="block" id="Cipolla's_algorithm:62">
 <semantics>
  <mrow>
   <mrow>
    <mi>Œ±</mi>
    <mo>+</mo>
    <mn>0</mn>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>x</mi>
      <mo>+</mo>
      <mrow>
       <mi>y</mi>
       <mi>œâ</mi>
      </mrow>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
    <mo>+</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mn>0</mn>
      <mo>+</mo>
      <mrow>
       <mn>0</mn>
       <mi>œâ</mi>
      </mrow>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>x</mi>
      <mo>+</mo>
      <mn>0</mn>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
    <mo>+</mo>
    <mrow>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mi>y</mi>
       <mo>+</mo>
       <mn>0</mn>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <mi>œâ</mi>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mi>x</mi>
    <mo>+</mo>
    <mrow>
     <mi>y</mi>
     <mi>œâ</mi>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mi>Œ±</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <plus></plus>
      <ci>Œ±</ci>
      <cn type="integer">0</cn>
     </apply>
     <apply>
      <plus></plus>
      <apply>
       <plus></plus>
       <ci>x</ci>
       <apply>
        <times></times>
        <ci>y</ci>
        <ci>œâ</ci>
       </apply>
      </apply>
      <apply>
       <plus></plus>
       <cn type="integer">0</cn>
       <apply>
        <times></times>
        <cn type="integer">0</cn>
        <ci>œâ</ci>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <plus></plus>
      <apply>
       <plus></plus>
       <ci>x</ci>
       <cn type="integer">0</cn>
      </apply>
      <apply>
       <times></times>
       <apply>
        <plus></plus>
        <ci>y</ci>
        <cn type="integer">0</cn>
       </apply>
       <ci>œâ</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <plus></plus>
      <ci>x</ci>
      <apply>
       <times></times>
       <ci>y</ci>
       <ci>œâ</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <ci>Œ±</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \alpha+0=(x+y\omega)+(0+0\omega)=(x+0)+(y+0)\omega=x+y\omega=\alpha
  </annotation>
 </semantics>
</math>

. The multiplicative identity is 

<math display="inline" id="Cipolla's_algorithm:63">
 <semantics>
  <mn>1</mn>
  <annotation-xml encoding="MathML-Content">
   <cn type="integer">1</cn>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   1
  </annotation>
 </semantics>
</math>


, or more formal 

<math display="inline" id="Cipolla's_algorithm:64">
 <semantics>
  <mrow>
   <mn>1</mn>
   <mo>+</mo>
   <mrow>
    <mn>0</mn>
    <mi>œâ</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <plus></plus>
    <cn type="integer">1</cn>
    <apply>
     <times></times>
     <cn type="integer">0</cn>
     <ci>œâ</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   1+0\omega
  </annotation>
 </semantics>
</math>

:</p>

<p>

<math display="block" id="Cipolla's_algorithm:65">
 <semantics>
  <mrow>
   <mrow>
    <mi>Œ±</mi>
    <mo>‚ãÖ</mo>
    <mn>1</mn>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>x</mi>
      <mo>+</mo>
      <mrow>
       <mi>y</mi>
       <mi>œâ</mi>
      </mrow>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mn>1</mn>
      <mo>+</mo>
      <mrow>
       <mn>0</mn>
       <mi>œâ</mi>
      </mrow>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mo>(</mo>
     <mrow>
      <mrow>
       <mi>x</mi>
       <mo>‚ãÖ</mo>
       <mn>1</mn>
      </mrow>
      <mo>+</mo>
      <mrow>
       <mrow>
        <mn>0</mn>
        <mo>‚ãÖ</mo>
        <mn>0</mn>
       </mrow>
       <mrow>
        <mo>(</mo>
        <mrow>
         <msup>
          <mi>n</mi>
          <mn>2</mn>
         </msup>
         <mo>-</mo>
         <mi>a</mi>
        </mrow>
        <mo>)</mo>
       </mrow>
      </mrow>
     </mrow>
     <mo>)</mo>
    </mrow>
    <mo>+</mo>
    <mrow>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mrow>
        <mi>x</mi>
        <mo>‚ãÖ</mo>
        <mn>0</mn>
       </mrow>
       <mo>+</mo>
       <mrow>
        <mn>1</mn>
        <mo>‚ãÖ</mo>
        <mi>x</mi>
       </mrow>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <mi>œâ</mi>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mi>x</mi>
    <mo>+</mo>
    <mrow>
     <mi>y</mi>
     <mi>œâ</mi>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mi>Œ±</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <ci>normal-‚ãÖ</ci>
      <ci>Œ±</ci>
      <cn type="integer">1</cn>
     </apply>
     <apply>
      <times></times>
      <apply>
       <plus></plus>
       <ci>x</ci>
       <apply>
        <times></times>
        <ci>y</ci>
        <ci>œâ</ci>
       </apply>
      </apply>
      <apply>
       <plus></plus>
       <cn type="integer">1</cn>
       <apply>
        <times></times>
        <cn type="integer">0</cn>
        <ci>œâ</ci>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <plus></plus>
      <apply>
       <plus></plus>
       <apply>
        <ci>normal-‚ãÖ</ci>
        <ci>x</ci>
        <cn type="integer">1</cn>
       </apply>
       <apply>
        <times></times>
        <apply>
         <ci>normal-‚ãÖ</ci>
         <cn type="integer">0</cn>
         <cn type="integer">0</cn>
        </apply>
        <apply>
         <minus></minus>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>n</ci>
          <cn type="integer">2</cn>
         </apply>
         <ci>a</ci>
        </apply>
       </apply>
      </apply>
      <apply>
       <times></times>
       <apply>
        <plus></plus>
        <apply>
         <ci>normal-‚ãÖ</ci>
         <ci>x</ci>
         <cn type="integer">0</cn>
        </apply>
        <apply>
         <ci>normal-‚ãÖ</ci>
         <cn type="integer">1</cn>
         <ci>x</ci>
        </apply>
       </apply>
       <ci>œâ</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <plus></plus>
      <ci>x</ci>
      <apply>
       <times></times>
       <ci>y</ci>
       <ci>œâ</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <ci>Œ±</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \alpha\cdot 1=(x+y\omega)(1+0\omega)=\left(x\cdot 1+0\cdot 0\left(n^{2}-a%
\right)\right)+(x\cdot 0+1\cdot x)\omega=x+y\omega=\alpha
  </annotation>
 </semantics>
</math>

. The only thing left for 

<math display="inline" id="Cipolla's_algorithm:66">
 <semantics>
  <msub>
   <mi>ùêÖ</mi>
   <msup>
    <mi>p</mi>
    <mn>2</mn>
   </msup>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>ùêÖ</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>p</ci>
     <cn type="integer">2</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{F}_{p^{2}}
  </annotation>
 </semantics>
</math>

 being a field is the existence of additive and multiplicative <a href="Inverse_element" title="wikilink">inverses</a>. It is easily seen that the additive inverse of 

<math display="inline" id="Cipolla's_algorithm:67">
 <semantics>
  <mrow>
   <mi>x</mi>
   <mo>+</mo>
   <mrow>
    <mi>y</mi>
    <mi>œâ</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <plus></plus>
    <ci>x</ci>
    <apply>
     <times></times>
     <ci>y</ci>
     <ci>œâ</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x+y\omega
  </annotation>
 </semantics>
</math>

 is 

<math display="inline" id="Cipolla's_algorithm:68">
 <semantics>
  <mrow>
   <mrow>
    <mo>-</mo>
    <mi>x</mi>
   </mrow>
   <mo>-</mo>
   <mrow>
    <mi>y</mi>
    <mi>œâ</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <minus></minus>
    <apply>
     <minus></minus>
     <ci>x</ci>
    </apply>
    <apply>
     <times></times>
     <ci>y</ci>
     <ci>œâ</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   -x-y\omega
  </annotation>
 </semantics>
</math>


, which is an element of 

<math display="inline" id="Cipolla's_algorithm:69">
 <semantics>
  <msub>
   <mi>ùêÖ</mi>
   <msup>
    <mi>p</mi>
    <mn>2</mn>
   </msup>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>ùêÖ</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>p</ci>
     <cn type="integer">2</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{F}_{p^{2}}
  </annotation>
 </semantics>
</math>

, because 

<math display="inline" id="Cipolla's_algorithm:70">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mo>-</mo>
     <mi>x</mi>
    </mrow>
    <mo>,</mo>
    <mrow>
     <mo>-</mo>
     <mi>y</mi>
    </mrow>
   </mrow>
   <mo>‚àà</mo>
   <msub>
    <mi>ùêÖ</mi>
    <mi>p</mi>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <in></in>
    <list>
     <apply>
      <minus></minus>
      <ci>x</ci>
     </apply>
     <apply>
      <minus></minus>
      <ci>y</ci>
     </apply>
    </list>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>ùêÖ</ci>
     <ci>p</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   -x,-y\in\mathbf{F}_{p}
  </annotation>
 </semantics>
</math>

. In fact, those are the additive inverse elements of <em>x</em> and <em>y</em>. For showing that every non-zero element 

<math display="inline" id="Cipolla's_algorithm:71">
 <semantics>
  <mi>Œ±</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>Œ±</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \alpha
  </annotation>
 </semantics>
</math>

 has a multiplicative inverse, write down 

<math display="inline" id="Cipolla's_algorithm:72">
 <semantics>
  <mrow>
   <mi>Œ±</mi>
   <mo>=</mo>
   <mrow>
    <msub>
     <mi>x</mi>
     <mn>1</mn>
    </msub>
    <mo>+</mo>
    <mrow>
     <msub>
      <mi>y</mi>
      <mn>1</mn>
     </msub>
     <mi>œâ</mi>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>Œ±</ci>
    <apply>
     <plus></plus>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <cn type="integer">1</cn>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>y</ci>
       <cn type="integer">1</cn>
      </apply>
      <ci>œâ</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \alpha=x_{1}+y_{1}\omega
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Cipolla's_algorithm:73">
 <semantics>
  <mrow>
   <msup>
    <mi>Œ±</mi>
    <mrow>
     <mo>-</mo>
     <mn>1</mn>
    </mrow>
   </msup>
   <mo>=</mo>
   <mrow>
    <msub>
     <mi>x</mi>
     <mn>2</mn>
    </msub>
    <mo>+</mo>
    <mrow>
     <msub>
      <mi>y</mi>
      <mn>2</mn>
     </msub>
     <mi>œâ</mi>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>Œ±</ci>
     <apply>
      <minus></minus>
      <cn type="integer">1</cn>
     </apply>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <cn type="integer">2</cn>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>y</ci>
       <cn type="integer">2</cn>
      </apply>
      <ci>œâ</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \alpha^{-1}=x_{2}+y_{2}\omega
  </annotation>
 </semantics>
</math>


. In other words,</p>

<p>

<math display="block" id="Cipolla's_algorithm:74">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <msub>
       <mi>x</mi>
       <mn>1</mn>
      </msub>
      <mo>+</mo>
      <mrow>
       <msub>
        <mi>y</mi>
        <mn>1</mn>
       </msub>
       <mi>œâ</mi>
      </mrow>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <msub>
       <mi>x</mi>
       <mn>2</mn>
      </msub>
      <mo>+</mo>
      <mrow>
       <msub>
        <mi>y</mi>
        <mn>2</mn>
       </msub>
       <mi>œâ</mi>
      </mrow>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mo>(</mo>
     <mrow>
      <mrow>
       <msub>
        <mi>x</mi>
        <mn>1</mn>
       </msub>
       <msub>
        <mi>x</mi>
        <mn>2</mn>
       </msub>
      </mrow>
      <mo>+</mo>
      <mrow>
       <msub>
        <mi>y</mi>
        <mn>1</mn>
       </msub>
       <msub>
        <mi>y</mi>
        <mn>2</mn>
       </msub>
       <mrow>
        <mo>(</mo>
        <mrow>
         <msup>
          <mi>n</mi>
          <mn>2</mn>
         </msup>
         <mo>-</mo>
         <mi>a</mi>
        </mrow>
        <mo>)</mo>
       </mrow>
      </mrow>
     </mrow>
     <mo>)</mo>
    </mrow>
    <mo>+</mo>
    <mrow>
     <mrow>
      <mo>(</mo>
      <mrow>
       <mrow>
        <msub>
         <mi>x</mi>
         <mn>1</mn>
        </msub>
        <msub>
         <mi>y</mi>
         <mn>2</mn>
        </msub>
       </mrow>
       <mo>+</mo>
       <mrow>
        <msub>
         <mi>y</mi>
         <mn>1</mn>
        </msub>
        <msub>
         <mi>x</mi>
         <mn>2</mn>
        </msub>
       </mrow>
      </mrow>
      <mo>)</mo>
     </mrow>
     <mi>œâ</mi>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <times></times>
      <apply>
       <plus></plus>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <cn type="integer">1</cn>
       </apply>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>y</ci>
         <cn type="integer">1</cn>
        </apply>
        <ci>œâ</ci>
       </apply>
      </apply>
      <apply>
       <plus></plus>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>y</ci>
         <cn type="integer">2</cn>
        </apply>
        <ci>œâ</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <plus></plus>
      <apply>
       <plus></plus>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>x</ci>
         <cn type="integer">1</cn>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>x</ci>
         <cn type="integer">2</cn>
        </apply>
       </apply>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>y</ci>
         <cn type="integer">1</cn>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>y</ci>
         <cn type="integer">2</cn>
        </apply>
        <apply>
         <minus></minus>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>n</ci>
          <cn type="integer">2</cn>
         </apply>
         <ci>a</ci>
        </apply>
       </apply>
      </apply>
      <apply>
       <times></times>
       <apply>
        <plus></plus>
        <apply>
         <times></times>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>x</ci>
          <cn type="integer">1</cn>
         </apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>y</ci>
          <cn type="integer">2</cn>
         </apply>
        </apply>
        <apply>
         <times></times>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>y</ci>
          <cn type="integer">1</cn>
         </apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>x</ci>
          <cn type="integer">2</cn>
         </apply>
        </apply>
       </apply>
       <ci>œâ</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <cn type="integer">1</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (x_{1}+y_{1}\omega)(x_{2}+y_{2}\omega)=\left(x_{1}x_{2}+y_{1}y_{2}\left(n^{2}-%
a\right)\right)+\left(x_{1}y_{2}+y_{1}x_{2}\right)\omega=1
  </annotation>
 </semantics>
</math>

. So the two equalities 

<math display="inline" id="Cipolla's_algorithm:75">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <msub>
      <mi>x</mi>
      <mn>1</mn>
     </msub>
     <msub>
      <mi>x</mi>
      <mn>2</mn>
     </msub>
    </mrow>
    <mo>+</mo>
    <mrow>
     <msub>
      <mi>y</mi>
      <mn>1</mn>
     </msub>
     <msub>
      <mi>y</mi>
      <mn>2</mn>
     </msub>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <msup>
        <mi>n</mi>
        <mn>2</mn>
       </msup>
       <mo>-</mo>
       <mi>a</mi>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <cn type="integer">1</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>y</ci>
       <cn type="integer">1</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>y</ci>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <minus></minus>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>n</ci>
        <cn type="integer">2</cn>
       </apply>
       <ci>a</ci>
      </apply>
     </apply>
    </apply>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x_{1}x_{2}+y_{1}y_{2}(n^{2}-a)=1
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Cipolla's_algorithm:76">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <msub>
      <mi>x</mi>
      <mn>1</mn>
     </msub>
     <msub>
      <mi>y</mi>
      <mn>2</mn>
     </msub>
    </mrow>
    <mo>+</mo>
    <mrow>
     <msub>
      <mi>y</mi>
      <mn>1</mn>
     </msub>
     <msub>
      <mi>x</mi>
      <mn>2</mn>
     </msub>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <cn type="integer">1</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>y</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>y</ci>
       <cn type="integer">1</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x_{1}y_{2}+y_{1}x_{2}=0
  </annotation>
 </semantics>
</math>

 must hold. Working out the details gives expressions for 

<math display="inline" id="Cipolla's_algorithm:77">
 <semantics>
  <msub>
   <mi>x</mi>
   <mn>2</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>x</ci>
    <cn type="integer">2</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x_{2}
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Cipolla's_algorithm:78">
 <semantics>
  <msub>
   <mi>y</mi>
   <mn>2</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>y</ci>
    <cn type="integer">2</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   y_{2}
  </annotation>
 </semantics>
</math>


, namely</p>

<p>

<math display="block" id="Cipolla's_algorithm:79">
 <semantics>
  <mrow>
   <msub>
    <mi>x</mi>
    <mn>2</mn>
   </msub>
   <mo>=</mo>
   <mrow>
    <mo>-</mo>
    <mrow>
     <msubsup>
      <mi>y</mi>
      <mn>1</mn>
      <mrow>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
     </msubsup>
     <msub>
      <mi>x</mi>
      <mn>1</mn>
     </msub>
     <msup>
      <mrow>
       <mo>(</mo>
       <mrow>
        <mrow>
         <msub>
          <mi>y</mi>
          <mn>1</mn>
         </msub>
         <mrow>
          <mo>(</mo>
          <mrow>
           <msup>
            <mi>n</mi>
            <mn>2</mn>
           </msup>
           <mo>-</mo>
           <mi>a</mi>
          </mrow>
          <mo>)</mo>
         </mrow>
        </mrow>
        <mo>-</mo>
        <mrow>
         <msubsup>
          <mi>x</mi>
          <mn>1</mn>
          <mn>2</mn>
         </msubsup>
         <msubsup>
          <mi>y</mi>
          <mn>1</mn>
          <mrow>
           <mo>-</mo>
           <mn>1</mn>
          </mrow>
         </msubsup>
        </mrow>
       </mrow>
       <mo>)</mo>
      </mrow>
      <mrow>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
     </msup>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>x</ci>
     <cn type="integer">2</cn>
    </apply>
    <apply>
     <minus></minus>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>y</ci>
        <cn type="integer">1</cn>
       </apply>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <cn type="integer">1</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <minus></minus>
        <apply>
         <times></times>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>y</ci>
          <cn type="integer">1</cn>
         </apply>
         <apply>
          <minus></minus>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <ci>n</ci>
           <cn type="integer">2</cn>
          </apply>
          <ci>a</ci>
         </apply>
        </apply>
        <apply>
         <times></times>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>x</ci>
           <cn type="integer">1</cn>
          </apply>
          <cn type="integer">2</cn>
         </apply>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>y</ci>
           <cn type="integer">1</cn>
          </apply>
          <apply>
           <minus></minus>
           <cn type="integer">1</cn>
          </apply>
         </apply>
        </apply>
       </apply>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x_{2}=-y_{1}^{-1}x_{1}\left(y_{1}\left(n^{2}-a\right)-x_{1}^{2}y_{1}^{-1}%
\right)^{-1}
  </annotation>
 </semantics>
</math>

,</p>

<p>

<math display="block" id="Cipolla's_algorithm:80">
 <semantics>
  <mrow>
   <msub>
    <mi>y</mi>
    <mn>2</mn>
   </msub>
   <mo>=</mo>
   <msup>
    <mrow>
     <mo>(</mo>
     <mrow>
      <mrow>
       <msub>
        <mi>y</mi>
        <mn>1</mn>
       </msub>
       <mrow>
        <mo>(</mo>
        <mrow>
         <msup>
          <mi>n</mi>
          <mn>2</mn>
         </msup>
         <mo>-</mo>
         <mi>a</mi>
        </mrow>
        <mo>)</mo>
       </mrow>
      </mrow>
      <mo>-</mo>
      <mrow>
       <msubsup>
        <mi>x</mi>
        <mn>1</mn>
        <mn>2</mn>
       </msubsup>
       <msubsup>
        <mi>y</mi>
        <mn>1</mn>
        <mrow>
         <mo>-</mo>
         <mn>1</mn>
        </mrow>
       </msubsup>
      </mrow>
     </mrow>
     <mo>)</mo>
    </mrow>
    <mrow>
     <mo>-</mo>
     <mn>1</mn>
    </mrow>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>y</ci>
     <cn type="integer">2</cn>
    </apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <minus></minus>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>y</ci>
        <cn type="integer">1</cn>
       </apply>
       <apply>
        <minus></minus>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>n</ci>
         <cn type="integer">2</cn>
        </apply>
        <ci>a</ci>
       </apply>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>x</ci>
         <cn type="integer">1</cn>
        </apply>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>y</ci>
         <cn type="integer">1</cn>
        </apply>
        <apply>
         <minus></minus>
         <cn type="integer">1</cn>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <minus></minus>
      <cn type="integer">1</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   y_{2}=\left(y_{1}\left(n^{2}-a\right)-x_{1}^{2}y_{1}^{-1}\right)^{-1}
  </annotation>
 </semantics>
</math>

. The inverse elements which are shown in the expressions of 

<math display="inline" id="Cipolla's_algorithm:81">
 <semantics>
  <msub>
   <mi>x</mi>
   <mn>2</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>x</ci>
    <cn type="integer">2</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x_{2}
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Cipolla's_algorithm:82">
 <semantics>
  <msub>
   <mi>y</mi>
   <mn>2</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>y</ci>
    <cn type="integer">2</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   y_{2}
  </annotation>
 </semantics>
</math>

 do exist, because these are all elements of 

<math display="inline" id="Cipolla's_algorithm:83">
 <semantics>
  <msub>
   <mi>ùêÖ</mi>
   <mi>p</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>ùêÖ</ci>
    <ci>p</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{F}_{p}
  </annotation>
 </semantics>
</math>


. This completes the first part of the proof, showing that 

<math display="inline" id="Cipolla's_algorithm:84">
 <semantics>
  <msub>
   <mi>ùêÖ</mi>
   <msup>
    <mi>p</mi>
    <mn>2</mn>
   </msup>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>ùêÖ</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>p</ci>
     <cn type="integer">2</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{F}_{p^{2}}
  </annotation>
 </semantics>
</math>

 is a field.</p>

<p>The second and middle part of the proof is showing that for every element 

<math display="inline" id="Cipolla's_algorithm:85">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>x</mi>
     <mo>+</mo>
     <mrow>
      <mi>y</mi>
      <mi>œâ</mi>
     </mrow>
    </mrow>
    <mo>‚àà</mo>
    <msub>
     <mi>ùêÖ</mi>
     <msup>
      <mi>p</mi>
      <mn>2</mn>
     </msup>
    </msub>
   </mrow>
   <mo>:</mo>
   <mrow>
    <msup>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mi>x</mi>
       <mo>+</mo>
       <mrow>
        <mi>y</mi>
        <mi>œâ</mi>
       </mrow>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <mi>p</mi>
    </msup>
    <mo>=</mo>
    <mrow>
     <mi>x</mi>
     <mo>-</mo>
     <mrow>
      <mi>y</mi>
      <mi>œâ</mi>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-:</ci>
    <apply>
     <in></in>
     <apply>
      <plus></plus>
      <ci>x</ci>
      <apply>
       <times></times>
       <ci>y</ci>
       <ci>œâ</ci>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>ùêÖ</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>p</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <plus></plus>
       <ci>x</ci>
       <apply>
        <times></times>
        <ci>y</ci>
        <ci>œâ</ci>
       </apply>
      </apply>
      <ci>p</ci>
     </apply>
     <apply>
      <minus></minus>
      <ci>x</ci>
      <apply>
       <times></times>
       <ci>y</ci>
       <ci>œâ</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x+y\omega\in\mathbf{F}_{p^{2}}:(x+y\omega)^{p}=x-y\omega
  </annotation>
 </semantics>
</math>

. By definition, 

<math display="inline" id="Cipolla's_algorithm:86">
 <semantics>
  <mrow>
   <msup>
    <mi>œâ</mi>
    <mn>2</mn>
   </msup>
   <mo>=</mo>
   <mrow>
    <msup>
     <mi>a</mi>
     <mn>2</mn>
    </msup>
    <mo>-</mo>
    <mi>n</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>œâ</ci>
     <cn type="integer">2</cn>
    </apply>
    <apply>
     <minus></minus>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>a</ci>
      <cn type="integer">2</cn>
     </apply>
     <ci>n</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \omega^{2}=a^{2}-n
  </annotation>
 </semantics>
</math>

 is not a square in 

<math display="inline" id="Cipolla's_algorithm:87">
 <semantics>
  <msub>
   <mi>ùêÖ</mi>
   <mi>p</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>ùêÖ</ci>
    <ci>p</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{F}_{p}
  </annotation>
 </semantics>
</math>

. Euler's criterion then says that</p>

<p>

<math display="block" id="Cipolla's_algorithm:88">
 <semantics>
  <mrow>
   <msup>
    <mi>œâ</mi>
    <mrow>
     <mi>p</mi>
     <mo>-</mo>
     <mn>1</mn>
    </mrow>
   </msup>
   <mo>=</mo>
   <msup>
    <mrow>
     <mo>(</mo>
     <msup>
      <mi>œâ</mi>
      <mn>2</mn>
     </msup>
     <mo>)</mo>
    </mrow>
    <mfrac>
     <mrow>
      <mi>p</mi>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
     <mn>2</mn>
    </mfrac>
   </msup>
   <mo>=</mo>
   <mrow>
    <mo>-</mo>
    <mn>1</mn>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>œâ</ci>
      <apply>
       <minus></minus>
       <ci>p</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>œâ</ci>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <divide></divide>
       <apply>
        <minus></minus>
        <ci>p</ci>
        <cn type="integer">1</cn>
       </apply>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <minus></minus>
      <cn type="integer">1</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \omega^{p-1}=\left(\omega^{2}\right)^{\frac{p-1}{2}}=-1
  </annotation>
 </semantics>
</math>

. Thus 

<math display="inline" id="Cipolla's_algorithm:89">
 <semantics>
  <mrow>
   <msup>
    <mi>œâ</mi>
    <mi>p</mi>
   </msup>
   <mo>=</mo>
   <mrow>
    <mo>-</mo>
    <mi>œâ</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>œâ</ci>
     <ci>p</ci>
    </apply>
    <apply>
     <minus></minus>
     <ci>œâ</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \omega^{p}=-\omega
  </annotation>
 </semantics>
</math>

. This, together with <a href="Fermat's_little_theorem" title="wikilink">Fermat's little theorem</a> (which says that 

<math display="inline" id="Cipolla's_algorithm:90">
 <semantics>
  <mrow>
   <msup>
    <mi>x</mi>
    <mi>p</mi>
   </msup>
   <mo>=</mo>
   <mi>x</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>x</ci>
     <ci>p</ci>
    </apply>
    <ci>x</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x^{p}=x
  </annotation>
 </semantics>
</math>

 for all 

<math display="inline" id="Cipolla's_algorithm:91">
 <semantics>
  <mrow>
   <mi>x</mi>
   <mo>‚àà</mo>
   <msub>
    <mi>ùêÖ</mi>
    <mi>p</mi>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <in></in>
    <ci>x</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>ùêÖ</ci>
     <ci>p</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x\in\mathbf{F}_{p}
  </annotation>
 </semantics>
</math>

) and the knowledge that in fields of <a href="Characteristic_(algebra)" title="wikilink">characteristic</a> <em>p</em> the equation 

<math display="inline" id="Cipolla's_algorithm:92">
 <semantics>
  <mrow>
   <msup>
    <mrow>
     <mo>(</mo>
     <mrow>
      <mi>a</mi>
      <mo>+</mo>
      <mi>b</mi>
     </mrow>
     <mo>)</mo>
    </mrow>
    <mi>p</mi>
   </msup>
   <mo>=</mo>
   <mrow>
    <msup>
     <mi>a</mi>
     <mi>p</mi>
    </msup>
    <mo>+</mo>
    <msup>
     <mi>b</mi>
     <mi>p</mi>
    </msup>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <plus></plus>
      <ci>a</ci>
      <ci>b</ci>
     </apply>
     <ci>p</ci>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>a</ci>
      <ci>p</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>b</ci>
      <ci>p</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \left(a+b\right)^{p}=a^{p}+b^{p}
  </annotation>
 </semantics>
</math>

 holds, shows the desired result</p>

<p>

<math display="block" id="Cipolla's_algorithm:93">
 <semantics>
  <mrow>
   <msup>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>x</mi>
      <mo>+</mo>
      <mrow>
       <mi>y</mi>
       <mi>œâ</mi>
      </mrow>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
    <mi>p</mi>
   </msup>
   <mo>=</mo>
   <mrow>
    <msup>
     <mi>x</mi>
     <mi>p</mi>
    </msup>
    <mo>+</mo>
    <mrow>
     <msup>
      <mi>y</mi>
      <mi>p</mi>
     </msup>
     <msup>
      <mi>œâ</mi>
      <mi>p</mi>
     </msup>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mi>x</mi>
    <mo>-</mo>
    <mrow>
     <mi>y</mi>
     <mi>œâ</mi>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <plus></plus>
       <ci>x</ci>
       <apply>
        <times></times>
        <ci>y</ci>
        <ci>œâ</ci>
       </apply>
      </apply>
      <ci>p</ci>
     </apply>
     <apply>
      <plus></plus>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>x</ci>
       <ci>p</ci>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>y</ci>
        <ci>p</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>œâ</ci>
        <ci>p</ci>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <minus></minus>
      <ci>x</ci>
      <apply>
       <times></times>
       <ci>y</ci>
       <ci>œâ</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (x+y\omega)^{p}=x^{p}+y^{p}\omega^{p}=x-y\omega
  </annotation>
 </semantics>
</math>

.</p>

<p>The third and last part of the proof is to show that if 

<math display="inline" id="Cipolla's_algorithm:94">
 <semantics>
  <mrow>
   <msub>
    <mi>x</mi>
    <mn>0</mn>
   </msub>
   <mo>=</mo>
   <msup>
    <mrow>
     <mo>(</mo>
     <mrow>
      <mi>a</mi>
      <mo>+</mo>
      <mi>œâ</mi>
     </mrow>
     <mo>)</mo>
    </mrow>
    <mfrac>
     <mrow>
      <mi>p</mi>
      <mo>+</mo>
      <mn>1</mn>
     </mrow>
     <mn>2</mn>
    </mfrac>
   </msup>
   <mo>‚àà</mo>
   <msub>
    <mi>ùêÖ</mi>
    <msup>
     <mi>p</mi>
     <mn>2</mn>
    </msup>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <cn type="integer">0</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <plus></plus>
       <ci>a</ci>
       <ci>œâ</ci>
      </apply>
      <apply>
       <divide></divide>
       <apply>
        <plus></plus>
        <ci>p</ci>
        <cn type="integer">1</cn>
       </apply>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
    <apply>
     <in></in>
     <share href="#.cmml">
     </share>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>ùêÖ</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>p</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x_{0}=\left(a+\omega\right)^{\frac{p+1}{2}}\in\mathbf{F}_{p^{2}}
  </annotation>
 </semantics>
</math>

, then 

<math display="inline" id="Cipolla's_algorithm:95">
 <semantics>
  <mrow>
   <msubsup>
    <mi>x</mi>
    <mn>0</mn>
    <mn>2</mn>
   </msubsup>
   <mo>=</mo>
   <mi>n</mi>
   <mo>‚àà</mo>
   <msub>
    <mi>ùêÖ</mi>
    <mi>p</mi>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <cn type="integer">0</cn>
      </apply>
      <cn type="integer">2</cn>
     </apply>
     <ci>n</ci>
    </apply>
    <apply>
     <in></in>
     <share href="#.cmml">
     </share>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>ùêÖ</ci>
      <ci>p</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x_{0}^{2}=n\in\mathbf{F}_{p}
  </annotation>
 </semantics>
</math>

.<br/>
Compute</p>

<p>

<math display="block" id="Cipolla's_algorithm:96">
 <semantics>
  <mrow>
   <msubsup>
    <mi>x</mi>
    <mn>0</mn>
    <mn>2</mn>
   </msubsup>
   <mo>=</mo>
   <msup>
    <mrow>
     <mo>(</mo>
     <mrow>
      <mi>a</mi>
      <mo>+</mo>
      <mi>œâ</mi>
     </mrow>
     <mo>)</mo>
    </mrow>
    <mrow>
     <mi>p</mi>
     <mo>+</mo>
     <mn>1</mn>
    </mrow>
   </msup>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>a</mi>
      <mo>+</mo>
      <mi>œâ</mi>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
    <msup>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mi>a</mi>
       <mo>+</mo>
       <mi>œâ</mi>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <mi>p</mi>
    </msup>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>a</mi>
      <mo>+</mo>
      <mi>œâ</mi>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>a</mi>
      <mo>-</mo>
      <mi>œâ</mi>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <msup>
     <mi>a</mi>
     <mn>2</mn>
    </msup>
    <mo>-</mo>
    <msup>
     <mi>œâ</mi>
     <mn>2</mn>
    </msup>
   </mrow>
   <mo>=</mo>
   <mrow>
    <msup>
     <mi>a</mi>
     <mn>2</mn>
    </msup>
    <mo>-</mo>
    <mrow>
     <mo>(</mo>
     <mrow>
      <msup>
       <mi>a</mi>
       <mn>2</mn>
      </msup>
      <mo>-</mo>
      <mi>n</mi>
     </mrow>
     <mo>)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mi>n</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <cn type="integer">0</cn>
      </apply>
      <cn type="integer">2</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <plus></plus>
       <ci>a</ci>
       <ci>œâ</ci>
      </apply>
      <apply>
       <plus></plus>
       <ci>p</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <apply>
       <plus></plus>
       <ci>a</ci>
       <ci>œâ</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <plus></plus>
        <ci>a</ci>
        <ci>œâ</ci>
       </apply>
       <ci>p</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <apply>
       <plus></plus>
       <ci>a</ci>
       <ci>œâ</ci>
      </apply>
      <apply>
       <minus></minus>
       <ci>a</ci>
       <ci>œâ</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <minus></minus>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>a</ci>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>œâ</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <minus></minus>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>a</ci>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <minus></minus>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>a</ci>
        <cn type="integer">2</cn>
       </apply>
       <ci>n</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <ci>n</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x_{0}^{2}=\left(a+\omega\right)^{p+1}=(a+\omega)(a+\omega)^{p}=(a+\omega)(a-%
\omega)=a^{2}-\omega^{2}=a^{2}-\left(a^{2}-n\right)=n
  </annotation>
 </semantics>
</math>

. Note that this computation took place in 

<math display="inline" id="Cipolla's_algorithm:97">
 <semantics>
  <msub>
   <mi>ùêÖ</mi>
   <msup>
    <mi>p</mi>
    <mn>2</mn>
   </msup>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>ùêÖ</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>p</ci>
     <cn type="integer">2</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{F}_{p^{2}}
  </annotation>
 </semantics>
</math>

, so this 

<math display="inline" id="Cipolla's_algorithm:98">
 <semantics>
  <mrow>
   <msub>
    <mi>x</mi>
    <mn>0</mn>
   </msub>
   <mo>‚àà</mo>
   <msub>
    <mi>ùêÖ</mi>
    <msup>
     <mi>p</mi>
     <mn>2</mn>
    </msup>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <in></in>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>x</ci>
     <cn type="integer">0</cn>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>ùêÖ</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>p</ci>
      <cn type="integer">2</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x_{0}\in\mathbf{F}_{p^{2}}
  </annotation>
 </semantics>
</math>


. But with <a href="Lagrange's_theorem_(number_theory)" title="wikilink">Lagrange's theorem</a>, stating that a non-zero <a href="Integer_polynomial" title="wikilink">polynomial</a> of degree <em>n</em> has at most <em>n</em> roots in any field <em>K</em>, and the knowledge that 

<math display="inline" id="Cipolla's_algorithm:99">
 <semantics>
  <mrow>
   <msup>
    <mi>x</mi>
    <mn>2</mn>
   </msup>
   <mo>-</mo>
   <mi>n</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <minus></minus>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>x</ci>
     <cn type="integer">2</cn>
    </apply>
    <ci>n</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x^{2}-n
  </annotation>
 </semantics>
</math>

 has 2 roots in 

<math display="inline" id="Cipolla's_algorithm:100">
 <semantics>
  <msub>
   <mi>ùêÖ</mi>
   <mi>p</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>ùêÖ</ci>
    <ci>p</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{F}_{p}
  </annotation>
 </semantics>
</math>

, these roots must be all of the roots in 

<math display="inline" id="Cipolla's_algorithm:101">
 <semantics>
  <msub>
   <mi>ùêÖ</mi>
   <msup>
    <mi>p</mi>
    <mn>2</mn>
   </msup>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>ùêÖ</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>p</ci>
     <cn type="integer">2</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{F}_{p^{2}}
  </annotation>
 </semantics>
</math>

. It was just shown that 

<math display="inline" id="Cipolla's_algorithm:102">
 <semantics>
  <msub>
   <mi>x</mi>
   <mn>0</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>x</ci>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x_{0}
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Cipolla's_algorithm:103">
 <semantics>
  <mrow>
   <mo>-</mo>
   <msub>
    <mi>x</mi>
    <mn>0</mn>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <minus></minus>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>x</ci>
     <cn type="integer">0</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   -x_{0}
  </annotation>
 </semantics>
</math>


 are roots of 

<math display="inline" id="Cipolla's_algorithm:104">
 <semantics>
  <mrow>
   <msup>
    <mi>x</mi>
    <mn>2</mn>
   </msup>
   <mo>-</mo>
   <mi>n</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <minus></minus>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>x</ci>
     <cn type="integer">2</cn>
    </apply>
    <ci>n</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x^{2}-n
  </annotation>
 </semantics>
</math>

 in 

<math display="inline" id="Cipolla's_algorithm:105">
 <semantics>
  <msub>
   <mi>ùêÖ</mi>
   <msup>
    <mi>p</mi>
    <mn>2</mn>
   </msup>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>ùêÖ</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>p</ci>
     <cn type="integer">2</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{F}_{p^{2}}
  </annotation>
 </semantics>
</math>

, so it must be that 

<math display="inline" id="Cipolla's_algorithm:106">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>x</mi>
     <mn>0</mn>
    </msub>
    <mo>,</mo>
    <mrow>
     <mo>-</mo>
     <msub>
      <mi>x</mi>
      <mn>0</mn>
     </msub>
    </mrow>
   </mrow>
   <mo>‚àà</mo>
   <msub>
    <mi>ùêÖ</mi>
    <mi>p</mi>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <in></in>
    <list>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <cn type="integer">0</cn>
     </apply>
     <apply>
      <minus></minus>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <cn type="integer">0</cn>
      </apply>
     </apply>
    </list>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>ùêÖ</ci>
     <ci>p</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x_{0},-x_{0}\in\mathbf{F}_{p}
  </annotation>
 </semantics>
</math>

.<a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a></p>
<h2 id="speed-of-the-algorithm">Speed of the algorithm</h2>

<p>After finding a suitable <em>a</em>, the number of operations required for the algorithm is 

<math display="inline" id="Cipolla's_algorithm:107">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mn>4</mn>
     <mi>m</mi>
    </mrow>
    <mo>+</mo>
    <mrow>
     <mn>2</mn>
     <mi>k</mi>
    </mrow>
   </mrow>
   <mo>-</mo>
   <mn>4</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <minus></minus>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <cn type="integer">4</cn>
      <ci>m</ci>
     </apply>
     <apply>
      <times></times>
      <cn type="integer">2</cn>
      <ci>k</ci>
     </apply>
    </apply>
    <cn type="integer">4</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   4m+2k-4
  </annotation>
 </semantics>
</math>

 multiplications, 

<math display="inline" id="Cipolla's_algorithm:108">
 <semantics>
  <mrow>
   <mrow>
    <mn>4</mn>
    <mi>m</mi>
   </mrow>
   <mo>-</mo>
   <mn>2</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <minus></minus>
    <apply>
     <times></times>
     <cn type="integer">4</cn>
     <ci>m</ci>
    </apply>
    <cn type="integer">2</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   4m-2
  </annotation>
 </semantics>
</math>


 sums, where <em>m</em> is the number of <a href="Numerical_digit" title="wikilink">digits</a> in the <a href="Binary_numeral_system" title="wikilink">binary representation</a> of <em>p</em> and <em>k</em> is the number of ones in this representation. To find <em>a</em> by trial and error, the expected number of computations of the Legendre symbol is 2. But one can be lucky with the first try and one may need more than 2 tries. In the field 

<math display="inline" id="Cipolla's_algorithm:109">
 <semantics>
  <msub>
   <mi>ùêÖ</mi>
   <msup>
    <mi>p</mi>
    <mn>2</mn>
   </msup>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>ùêÖ</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>p</ci>
     <cn type="integer">2</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{F}_{p^{2}}
  </annotation>
 </semantics>
</math>

, the following two equalities hold</p>

<p>

<math display="block" id="Cipolla's_algorithm:110">
 <semantics>
  <mrow>
   <mrow>
    <msup>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mi>x</mi>
       <mo>+</mo>
       <mrow>
        <mi>y</mi>
        <mi>œâ</mi>
       </mrow>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <mn>2</mn>
    </msup>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mo>(</mo>
      <mrow>
       <msup>
        <mi>x</mi>
        <mn>2</mn>
       </msup>
       <mo>+</mo>
       <mrow>
        <msup>
         <mi>y</mi>
         <mn>2</mn>
        </msup>
        <msup>
         <mi>œâ</mi>
         <mn>2</mn>
        </msup>
       </mrow>
      </mrow>
      <mo>)</mo>
     </mrow>
     <mo>+</mo>
     <mrow>
      <mrow>
       <mo>(</mo>
       <mrow>
        <msup>
         <mrow>
          <mo>(</mo>
          <mrow>
           <mi>x</mi>
           <mo>+</mo>
           <mi>y</mi>
          </mrow>
          <mo>)</mo>
         </mrow>
         <mn>2</mn>
        </msup>
        <mo>-</mo>
        <msup>
         <mi>x</mi>
         <mn>2</mn>
        </msup>
        <mo>-</mo>
        <msup>
         <mi>y</mi>
         <mn>2</mn>
        </msup>
       </mrow>
       <mo>)</mo>
      </mrow>
      <mi>œâ</mi>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <plus></plus>
      <ci>x</ci>
      <apply>
       <times></times>
       <ci>y</ci>
       <ci>œâ</ci>
      </apply>
     </apply>
     <cn type="integer">2</cn>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <plus></plus>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>x</ci>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>y</ci>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>œâ</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <minus></minus>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <plus></plus>
         <ci>x</ci>
         <ci>y</ci>
        </apply>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>x</ci>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>y</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
      <ci>œâ</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (x+y\omega)^{2}=\left(x^{2}+y^{2}\omega^{2}\right)+\left(\left(x+y\right)^{2}-%
x^{2}-y^{2}\right)\omega,
  </annotation>
 </semantics>
</math>

 where 

<math display="inline" id="Cipolla's_algorithm:111">
 <semantics>
  <mrow>
   <msup>
    <mi>œâ</mi>
    <mn>2</mn>
   </msup>
   <mo>=</mo>
   <mrow>
    <msup>
     <mi>a</mi>
     <mn>2</mn>
    </msup>
    <mo>-</mo>
    <mi>n</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>œâ</ci>
     <cn type="integer">2</cn>
    </apply>
    <apply>
     <minus></minus>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>a</ci>
      <cn type="integer">2</cn>
     </apply>
     <ci>n</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \omega^{2}=a^{2}-n
  </annotation>
 </semantics>
</math>

 is known in advance. This computation needs 4 multiplications and 4 sums.</p>

<p>

<math display="block" id="Cipolla's_algorithm:112">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <msup>
      <mrow>
       <mo>(</mo>
       <mrow>
        <mi>x</mi>
        <mo>+</mo>
        <mrow>
         <mi>y</mi>
         <mi>œâ</mi>
        </mrow>
       </mrow>
       <mo>)</mo>
      </mrow>
      <mn>2</mn>
     </msup>
     <mrow>
      <mo>(</mo>
      <mrow>
       <mi>c</mi>
       <mo>+</mo>
       <mi>œâ</mi>
      </mrow>
      <mo>)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mo>(</mo>
      <mrow>
       <mrow>
        <mi>c</mi>
        <mi>d</mi>
       </mrow>
       <mo>-</mo>
       <mrow>
        <mi>b</mi>
        <mrow>
         <mo>(</mo>
         <mrow>
          <mi>x</mi>
          <mo>+</mo>
          <mi>d</mi>
         </mrow>
         <mo>)</mo>
        </mrow>
       </mrow>
      </mrow>
      <mo>)</mo>
     </mrow>
     <mo>+</mo>
     <mrow>
      <mrow>
       <mo>(</mo>
       <mrow>
        <msup>
         <mi>d</mi>
         <mn>2</mn>
        </msup>
        <mo>-</mo>
        <mrow>
         <mi>b</mi>
         <mi>y</mi>
        </mrow>
       </mrow>
       <mo>)</mo>
      </mrow>
      <mi>œâ</mi>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <plus></plus>
       <ci>x</ci>
       <apply>
        <times></times>
        <ci>y</ci>
        <ci>œâ</ci>
       </apply>
      </apply>
      <cn type="integer">2</cn>
     </apply>
     <apply>
      <plus></plus>
      <ci>c</ci>
      <ci>œâ</ci>
     </apply>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <minus></minus>
      <apply>
       <times></times>
       <ci>c</ci>
       <ci>d</ci>
      </apply>
      <apply>
       <times></times>
       <ci>b</ci>
       <apply>
        <plus></plus>
        <ci>x</ci>
        <ci>d</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <minus></minus>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>d</ci>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <times></times>
        <ci>b</ci>
        <ci>y</ci>
       </apply>
      </apply>
      <ci>œâ</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \left(x+y\omega\right)^{2}\left(c+\omega\right)=\left(cd-b\left(x+d\right)%
\right)+\left(d^{2}-by\right)\omega,
  </annotation>
 </semantics>
</math>

 where 

<math display="inline" id="Cipolla's_algorithm:113">
 <semantics>
  <mrow>
   <mi>d</mi>
   <mo>=</mo>
   <mrow>
    <mo stretchy="false">(</mo>
    <mrow>
     <mi>x</mi>
     <mo>+</mo>
     <mrow>
      <mi>y</mi>
      <mi>c</mi>
     </mrow>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>d</ci>
    <apply>
     <plus></plus>
     <ci>x</ci>
     <apply>
      <times></times>
      <ci>y</ci>
      <ci>c</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   d=(x+yc)
  </annotation>
 </semantics>
</math>


 and 

<math display="inline" id="Cipolla's_algorithm:114">
 <semantics>
  <mrow>
   <mi>b</mi>
   <mo>=</mo>
   <mrow>
    <mi>n</mi>
    <mi>y</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>b</ci>
    <apply>
     <times></times>
     <ci>n</ci>
     <ci>y</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   b=ny
  </annotation>
 </semantics>
</math>

. This operation needs 6 multiplications and 4 sums.</p>

<p>Assuming that 

<math display="inline" id="Cipolla's_algorithm:115">
 <semantics>
  <mrow>
   <mrow>
    <mi>p</mi>
    <mo>‚â°</mo>
    <mrow>
     <mn>1</mn>
     <mspace width="veryverythickmathspace">
     </mspace>
     <mrow>
      <mo lspace="8.1pt" stretchy="false">(</mo>
      <mrow>
       <mo>mod</mo>
       <mn>4</mn>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <equivalent></equivalent>
    <ci>p</ci>
    <apply>
     <csymbol cd="latexml">annotated</csymbol>
     <cn type="integer">1</cn>
     <apply>
      <ci>pmod</ci>
      <cn type="integer">4</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p\equiv 1\;\;(\mathop{{\rm mod}}4),
  </annotation>
 </semantics>
</math>

 (in the case 

<math display="inline" id="Cipolla's_algorithm:116">
 <semantics>
  <mrow>
   <mi>p</mi>
   <mo>‚â°</mo>
   <mrow>
    <mn>3</mn>
    <mspace width="veryverythickmathspace">
    </mspace>
    <mrow>
     <mo lspace="8.1pt" stretchy="false">(</mo>
     <mrow>
      <mo>mod</mo>
      <mn>4</mn>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <equivalent></equivalent>
    <ci>p</ci>
    <apply>
     <csymbol cd="latexml">annotated</csymbol>
     <cn type="integer">3</cn>
     <apply>
      <ci>pmod</ci>
      <cn type="integer">4</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p\equiv 3\;\;(\mathop{{\rm mod}}4)
  </annotation>
 </semantics>
</math>

, the direct computation 

<math display="inline" id="Cipolla's_algorithm:117">
 <semantics>
  <mrow>
   <mi>x</mi>
   <mo>‚â°</mo>
   <mrow>
    <mo>¬±</mo>
    <msup>
     <mi>n</mi>
     <mfrac>
      <mrow>
       <mi>p</mi>
       <mo>+</mo>
       <mn>1</mn>
      </mrow>
      <mn>4</mn>
     </mfrac>
    </msup>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <equivalent></equivalent>
    <ci>x</ci>
    <apply>
     <csymbol cd="latexml">plus-or-minus</csymbol>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>n</ci>
      <apply>
       <divide></divide>
       <apply>
        <plus></plus>
        <ci>p</ci>
        <cn type="integer">1</cn>
       </apply>
       <cn type="integer">4</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x\equiv\pm n^{\frac{p+1}{4}}
  </annotation>
 </semantics>
</math>

 is much faster) the binary expression of 

<math display="inline" id="Cipolla's_algorithm:118">
 <semantics>
  <mrow>
   <mrow>
    <mo stretchy="false">(</mo>
    <mrow>
     <mi>p</mi>
     <mo>+</mo>
     <mn>1</mn>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>/</mo>
   <mn>2</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <divide></divide>
    <apply>
     <plus></plus>
     <ci>p</ci>
     <cn type="integer">1</cn>
    </apply>
    <cn type="integer">2</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (p+1)/2
  </annotation>
 </semantics>
</math>


 has 

<math display="inline" id="Cipolla's_algorithm:119">
 <semantics>
  <mrow>
   <mi>m</mi>
   <mo>-</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <minus></minus>
    <ci>m</ci>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   m-1
  </annotation>
 </semantics>
</math>

 digits, of which <em>k</em> are ones. So for computing a 

<math display="inline" id="Cipolla's_algorithm:120">
 <semantics>
  <mrow>
   <mrow>
    <mo stretchy="false">(</mo>
    <mrow>
     <mi>p</mi>
     <mo>+</mo>
     <mn>1</mn>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>/</mo>
   <mn>2</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <divide></divide>
    <apply>
     <plus></plus>
     <ci>p</ci>
     <cn type="integer">1</cn>
    </apply>
    <cn type="integer">2</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (p+1)/2
  </annotation>
 </semantics>
</math>

 power of 

<math display="inline" id="Cipolla's_algorithm:121">
 <semantics>
  <mrow>
   <mo>(</mo>
   <mrow>
    <mi>a</mi>
    <mo>+</mo>
    <mi>œâ</mi>
   </mrow>
   <mo>)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <plus></plus>
    <ci>a</ci>
    <ci>œâ</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \left(a+\omega\right)
  </annotation>
 </semantics>
</math>

, the first formula has to be used 

<math display="inline" id="Cipolla's_algorithm:122">
 <semantics>
  <mrow>
   <mi>n</mi>
   <mo>-</mo>
   <mi>k</mi>
   <mo>-</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <minus></minus>
    <ci>n</ci>
    <ci>k</ci>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n-k-1
  </annotation>
 </semantics>
</math>

 times and the second 

<math display="inline" id="Cipolla's_algorithm:123">
 <semantics>
  <mrow>
   <mi>k</mi>
   <mo>-</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <minus></minus>
    <ci>k</ci>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   k-1
  </annotation>
 </semantics>
</math>


 times.</p>

<p>For this, Cipolla's algorithm is better than the <a href="Tonelli-Shanks_algorithm" title="wikilink">Tonelli-Shanks algorithm</a> if and only if 

<math display="inline" id="Cipolla's_algorithm:124">
 <semantics>
  <mrow>
   <mrow>
    <mi>S</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>S</mi>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>></mo>
   <mrow>
    <mrow>
     <mn>8</mn>
     <mi>m</mi>
    </mrow>
    <mo>+</mo>
    <mn>20</mn>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <gt></gt>
    <apply>
     <times></times>
     <ci>S</ci>
     <apply>
      <minus></minus>
      <ci>S</ci>
      <cn type="integer">1</cn>
     </apply>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <cn type="integer">8</cn>
      <ci>m</ci>
     </apply>
     <cn type="integer">20</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   S(S-1)>8m+20
  </annotation>
 </semantics>
</math>

, with 

<math display="inline" id="Cipolla's_algorithm:125">
 <semantics>
  <msup>
   <mn>2</mn>
   <mi>S</mi>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <cn type="integer">2</cn>
    <ci>S</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   2^{S}
  </annotation>
 </semantics>
</math>

 being the maximum power of 2 which divides 

<math display="inline" id="Cipolla's_algorithm:126">
 <semantics>
  <mrow>
   <mi>p</mi>
   <mo>-</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <minus></minus>
    <ci>p</ci>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p-1
  </annotation>
 </semantics>
</math>

.<a class="footnoteRef" href="#fn3" id="fnref3"><sup>3</sup></a></p>
<h2 id="references">References</h2>
<references>
</references>
<ul>
<li>E. Bach, J.O. Shallit <em>Algorithmic Number Theory: Efficient algorithms</em> MIT Press, (1996)</li>
</ul>

<p>"</p>

<p><a href="Category:Modular_arithmetic" title="wikilink">Category:Modular arithmetic</a> <a href="Category:Number_theoretic_algorithms" title="wikilink">Category:Number theoretic algorithms</a> <a href="Category:Articles_containing_proofs" title="wikilink">Category:Articles containing proofs</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1">R. Crandall, C. Pomerance Prime Numbers: A Computational Perspective Springer-Verlag, (2001) p. 157<a href="#fnref1">‚Ü©</a></li>
<li id="fn2"><a href="http://people.math.gatech.edu/~mbaker/pdf/cipolla2011.pdf">M. Baker <em>Cipolla's Algorithm for finding square roots mod p</em></a><a href="#fnref2">‚Ü©</a></li>
<li id="fn3"><a href="http://www.springerlink.com/content/xgxe68edy03la96p/fulltext.pdf">Gonzalo Tornaria <em>Square roots modulo p</em></a><a href="#fnref3">‚Ü©</a></li>
</ol>
</section>
</body>
</html>

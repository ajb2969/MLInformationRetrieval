<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="787">Incidence matrix</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Incidence matrix</h1>
<hr/>

<p>In <a class="uri" href="mathematics" title="wikilink">mathematics</a>, an <strong>incidence matrix</strong> is a <a href="matrix_(mathematics)" title="wikilink">matrix</a> that shows the relationship between two classes of objects. If the first class is <em>X</em> and the second is <em>Y</em>, the matrix has one row for each element of <em>X</em> and one column for each element of <em>Y</em>. The entry in row <em>x</em> and column <em>y</em> is 1 if <em>x</em> and <em>y</em> are related (called <strong>incident</strong> in this context) and 0 if they are not. There are variations; see below.</p>
<h2 id="graph-theory">Graph theory</h2>

<p>Incidence matrices are mostly used in <a href="graph_theory" title="wikilink">graph theory</a>.</p>
<h3 id="undirected-and-directed-graphs">Undirected and directed graphs</h3>

<p> In <a href="graph_theory" title="wikilink">graph theory</a> an <a href="undirected_graph" title="wikilink">undirected graph</a> <em>G</em> has two kinds of incidence matrices: unoriented and oriented. The <strong>incidence matrix</strong> (or <strong>unoriented incidence matrix</strong>) of <em>G</em> is a <em>n</em> × <em>m</em> <a href="matrix_(math)" title="wikilink">matrix</a>
<math display="inline" id="Incidence_matrix:0">
<semantics>
<mrow>
<mo stretchy="false">(</mo>
<msub>
<mi>b</mi>
<mrow>
<mi>i</mi>
<mi>j</mi>
</mrow>
</msub>
<mo stretchy="false">)</mo>
</mrow>
<annotation-xml encoding="MathML-Content">
<apply>
<csymbol cd="ambiguous">subscript</csymbol>
<ci>b</ci>
<apply>
<times></times>
<ci>i</ci>
<ci>j</ci>
</apply>
</apply>
</annotation-xml>
<annotation encoding="application/x-tex">
   (b_{ij})
  </annotation>
</semantics>
</math>

, where <em>n</em> and <em>m</em> are the numbers of <a href="vertex_(graph_theory)" title="wikilink">vertices</a> and <a href="Edge_(graph_theory)" title="wikilink">edges</a> respectively, such that 

<math display="inline" id="Incidence_matrix:1">
<semantics>
<mrow>
<msub>
<mi>b</mi>
<mrow>
<mi>i</mi>
<mi>j</mi>
</mrow>
</msub>
<mo>=</mo>
<mn>1</mn>
</mrow>
<annotation-xml encoding="MathML-Content">
<apply>
<eq></eq>
<apply>
<csymbol cd="ambiguous">subscript</csymbol>
<ci>b</ci>
<apply>
<times></times>
<ci>i</ci>
<ci>j</ci>
</apply>
</apply>
<cn type="integer">1</cn>
</apply>
</annotation-xml>
<annotation encoding="application/x-tex">
   b_{ij}=1
  </annotation>
</semantics>
</math>

 if the vertex 

<math display="inline" id="Incidence_matrix:2">
<semantics>
<msub>
<mi>v</mi>
<mi>i</mi>
</msub>
<annotation-xml encoding="MathML-Content">
<apply>
<csymbol cd="ambiguous">subscript</csymbol>
<ci>v</ci>
<ci>i</ci>
</apply>
</annotation-xml>
<annotation encoding="application/x-tex">
   v_{i}
  </annotation>
</semantics>
</math>

 and edge 

<math display="inline" id="Incidence_matrix:3">
<semantics>
<msub>
<mi>x</mi>
<mi>j</mi>
</msub>
<annotation-xml encoding="MathML-Content">
<apply>
<csymbol cd="ambiguous">subscript</csymbol>
<ci>x</ci>
<ci>j</ci>
</apply>
</annotation-xml>
<annotation encoding="application/x-tex">
   x_{j}
  </annotation>
</semantics>
</math>

 are incident and 0 otherwise.</p>

<p>For example the incidence matrix of the undirected graph shown on the right is a matrix consisting of 4 rows (corresponding to the four vertices, 1-4) and 4 columns (corresponding to the four edges, e1-e4):</p>

<p>
<math display="block" id="Incidence_matrix:4">
<semantics>
<mrow>
<mo>(</mo>
<mtable displaystyle="true">
<mtr>
<mtd columnalign="center">
<mn>1</mn>
</mtd>
<mtd columnalign="center">
<mn>1</mn>
</mtd>
<mtd columnalign="center">
<mn>1</mn>
</mtd>
<mtd columnalign="center">
<mn>0</mn>
</mtd>
</mtr>
<mtr>
<mtd columnalign="center">
<mn>1</mn>
</mtd>
<mtd columnalign="center">
<mn>0</mn>
</mtd>
<mtd columnalign="center">
<mn>0</mn>
</mtd>
<mtd columnalign="center">
<mn>0</mn>
</mtd>
</mtr>
<mtr>
<mtd columnalign="center">
<mn>0</mn>
</mtd>
<mtd columnalign="center">
<mn>1</mn>
</mtd>
<mtd columnalign="center">
<mn>0</mn>
</mtd>
<mtd columnalign="center">
<mn>1</mn>
</mtd>
</mtr>
<mtr>
<mtd columnalign="center">
<mn>0</mn>
</mtd>
<mtd columnalign="center">
<mn>0</mn>
</mtd>
<mtd columnalign="center">
<mn>1</mn>
</mtd>
<mtd columnalign="center">
<mn>1</mn>
</mtd>
</mtr>
</mtable>
<mo>)</mo>
</mrow>
<annotation-xml encoding="MathML-Content">
<matrix>
<matrixrow>
<cn type="integer">1</cn>
<cn type="integer">1</cn>
<cn type="integer">1</cn>
<cn type="integer">0</cn>
</matrixrow>
<matrixrow>
<cn type="integer">1</cn>
<cn type="integer">0</cn>
<cn type="integer">0</cn>
<cn type="integer">0</cn>
</matrixrow>
<matrixrow>
<cn type="integer">0</cn>
<cn type="integer">1</cn>
<cn type="integer">0</cn>
<cn type="integer">1</cn>
</matrixrow>
<matrixrow>
<cn type="integer">0</cn>
<cn type="integer">0</cn>
<cn type="integer">1</cn>
<cn type="integer">1</cn>
</matrixrow>
</matrix>
</annotation-xml>
<annotation encoding="application/x-tex">
   \begin{pmatrix}1&amp;1&amp;1&amp;0\\
1&amp;0&amp;0&amp;0\\
0&amp;1&amp;0&amp;1\\
0&amp;0&amp;1&amp;1\\
\end{pmatrix}
  </annotation>
</semantics>
</math>

 If we look at the incidence matrix, we see that the sum of each column is equal to 2. This is because each edge has a vertex connected to each end.</p>

<p>The <strong>incidence matrix</strong> of a <a href="directed_graph" title="wikilink">directed graph</a> <em>D</em> is a <em>n</em> × <em>m</em> matrix 

<math display="inline" id="Incidence_matrix:5">
<semantics>
<mrow>
<mo stretchy="false">[</mo>
<msub>
<mi>b</mi>
<mrow>
<mi>i</mi>
<mi>j</mi>
</mrow>
</msub>
<mo stretchy="false">]</mo>
</mrow>
<annotation-xml encoding="MathML-Content">
<apply>
<csymbol cd="latexml">delimited-[]</csymbol>
<apply>
<csymbol cd="ambiguous">subscript</csymbol>
<ci>b</ci>
<apply>
<times></times>
<ci>i</ci>
<ci>j</ci>
</apply>
</apply>
</apply>
</annotation-xml>
<annotation encoding="application/x-tex">
   [b_{ij}]
  </annotation>
</semantics>
</math>

 where <em>n</em> and <em>m</em> are the number of vertices and edges respectively, such that 

<math display="inline" id="Incidence_matrix:6">
<semantics>
<mrow>
<msub>
<mi>b</mi>
<mrow>
<mi>i</mi>
<mi>j</mi>
</mrow>
</msub>
<mo>=</mo>
<mrow>
<mo>-</mo>
<mn>1</mn>
</mrow>
</mrow>
<annotation-xml encoding="MathML-Content">
<apply>
<eq></eq>
<apply>
<csymbol cd="ambiguous">subscript</csymbol>
<ci>b</ci>
<apply>
<times></times>
<ci>i</ci>
<ci>j</ci>
</apply>
</apply>
<apply>
<minus></minus>
<cn type="integer">1</cn>
</apply>
</apply>
</annotation-xml>
<annotation encoding="application/x-tex">
   b_{ij}=-1
  </annotation>
</semantics>
</math>

 if the edge 

<math display="inline" id="Incidence_matrix:7">
<semantics>
<msub>
<mi>x</mi>
<mi>j</mi>
</msub>
<annotation-xml encoding="MathML-Content">
<apply>
<csymbol cd="ambiguous">subscript</csymbol>
<ci>x</ci>
<ci>j</ci>
</apply>
</annotation-xml>
<annotation encoding="application/x-tex">
   x_{j}
  </annotation>
</semantics>
</math>

 leaves vertex 

<math display="inline" id="Incidence_matrix:8">
<semantics>
<msub>
<mi>v</mi>
<mi>i</mi>
</msub>
<annotation-xml encoding="MathML-Content">
<apply>
<csymbol cd="ambiguous">subscript</csymbol>
<ci>v</ci>
<ci>i</ci>
</apply>
</annotation-xml>
<annotation encoding="application/x-tex">
   v_{i}
  </annotation>
</semantics>
</math>

, 

<math display="inline" id="Incidence_matrix:9">
<semantics>
<mn>1</mn>
<annotation-xml encoding="MathML-Content">
<cn type="integer">1</cn>
</annotation-xml>
<annotation encoding="application/x-tex">
   1
  </annotation>
</semantics>
</math>

 if it enters vertex 

<math display="inline" id="Incidence_matrix:10">
<semantics>
<msub>
<mi>v</mi>
<mi>i</mi>
</msub>
<annotation-xml encoding="MathML-Content">
<apply>
<csymbol cd="ambiguous">subscript</csymbol>
<ci>v</ci>
<ci>i</ci>
</apply>
</annotation-xml>
<annotation encoding="application/x-tex">
   v_{i}
  </annotation>
</semantics>
</math>

 and 0 otherwise (Note that many authors use the opposite sign convention.).</p>

<p>An <strong>oriented incidence matrix</strong> of an undirected graph <em>G</em> is the incidence matrix, in the sense of directed graphs, of any <a href="Orientation_(graph_theory)" title="wikilink">orientation</a> of <em>G</em>. That is, in the column of edge <em>e</em>, there is one +1 in the row corresponding to one vertex of <em>e</em> and one −1 in the row corresponding to the other vertex of <em>e</em>, and all other rows have 0. The oriented incidence matrix is unique <a href="up_to" title="wikilink">up to</a> negation of any of the columns, since negating the entries of a column corresponds to reversing the orientation of an edge.</p>

<p>The oriented or unoriented incidence matrix of a graph <em>G</em> is related to the <a href="adjacency_matrix" title="wikilink">adjacency matrix</a> of its <a href="line_graph" title="wikilink">line graph</a> <em>L</em>(<em>G</em>) by the following theorem:</p>

<p>
<math display="block" id="Incidence_matrix:11">
<semantics>
<mrow>
<mrow>
<mi>A</mi>
<mrow>
<mo stretchy="false">(</mo>
<mrow>
<mi>L</mi>
<mrow>
<mo stretchy="false">(</mo>
<mi>G</mi>
<mo stretchy="false">)</mo>
</mrow>
</mrow>
<mo stretchy="false">)</mo>
</mrow>
</mrow>
<mo>=</mo>
<mrow>
<mrow>
<mi>B</mi>
<msup>
<mrow>
<mo stretchy="false">(</mo>
<mi>G</mi>
<mo stretchy="false">)</mo>
</mrow>
<mi>T</mi>
</msup>
<mi>B</mi>
<mrow>
<mo stretchy="false">(</mo>
<mi>G</mi>
<mo stretchy="false">)</mo>
</mrow>
</mrow>
<mo>-</mo>
<mrow>
<mn>2</mn>
<msub>
<mi>I</mi>
<mi>m</mi>
</msub>
</mrow>
</mrow>
</mrow>
<annotation-xml encoding="MathML-Content">
<apply>
<eq></eq>
<apply>
<times></times>
<ci>A</ci>
<apply>
<times></times>
<ci>L</ci>
<ci>G</ci>
</apply>
</apply>
<apply>
<minus></minus>
<apply>
<times></times>
<ci>B</ci>
<apply>
<csymbol cd="ambiguous">superscript</csymbol>
<ci>G</ci>
<ci>T</ci>
</apply>
<ci>B</ci>
<ci>G</ci>
</apply>
<apply>
<times></times>
<cn type="integer">2</cn>
<apply>
<csymbol cd="ambiguous">subscript</csymbol>
<ci>I</ci>
<ci>m</ci>
</apply>
</apply>
</apply>
</apply>
</annotation-xml>
<annotation encoding="application/x-tex">
   A(L(G))=B(G)^{T}B(G)-2I_{m}
  </annotation>
</semantics>
</math>
</p>

<p>where 

<math display="inline" id="Incidence_matrix:12">
<semantics>
<mrow>
<mi>A</mi>
<mrow>
<mo stretchy="false">(</mo>
<mrow>
<mi>L</mi>
<mrow>
<mo stretchy="false">(</mo>
<mi>G</mi>
<mo stretchy="false">)</mo>
</mrow>
</mrow>
<mo stretchy="false">)</mo>
</mrow>
</mrow>
<annotation-xml encoding="MathML-Content">
<apply>
<times></times>
<ci>A</ci>
<apply>
<times></times>
<ci>L</ci>
<ci>G</ci>
</apply>
</apply>
</annotation-xml>
<annotation encoding="application/x-tex">
   A(L(G))
  </annotation>
</semantics>
</math>

 is the adjacency matrix of the line graph of <em>G</em>, <em>B</em>(<em>G</em>) is the incidence matrix, and 

<math display="inline" id="Incidence_matrix:13">
<semantics>
<msub>
<mi>I</mi>
<mi>m</mi>
</msub>
<annotation-xml encoding="MathML-Content">
<apply>
<csymbol cd="ambiguous">subscript</csymbol>
<ci>I</ci>
<ci>m</ci>
</apply>
</annotation-xml>
<annotation encoding="application/x-tex">
   I_{m}
  </annotation>
</semantics>
</math>

 is the <a href="identity_matrix" title="wikilink">identity matrix</a> of dimension m.</p>

<p>The discrete <a href="Kirchhoff_matrix" title="wikilink">Laplacian</a> (or Kirchhoff matrix) is obtained from the oriented incidence matrix <em>B</em>(<em>G</em>) by the formula</p>

<p>
<math display="block" id="Incidence_matrix:14">
<semantics>
<mrow>
<mrow>
<mi>B</mi>
<mrow>
<mo stretchy="false">(</mo>
<mi>G</mi>
<mo stretchy="false">)</mo>
</mrow>
<mi>B</mi>
<msup>
<mrow>
<mo stretchy="false">(</mo>
<mi>G</mi>
<mo stretchy="false">)</mo>
</mrow>
<mi>T</mi>
</msup>
</mrow>
<mo>.</mo>
</mrow>
<annotation-xml encoding="MathML-Content">
<apply>
<times></times>
<ci>B</ci>
<ci>G</ci>
<ci>B</ci>
<apply>
<csymbol cd="ambiguous">superscript</csymbol>
<ci>G</ci>
<ci>T</ci>
</apply>
</apply>
</annotation-xml>
<annotation encoding="application/x-tex">
   B(G)B(G)^{T}.
  </annotation>
</semantics>
</math>
</p>

<p>The integral <a href="cycle_space" title="wikilink">cycle space</a> of a graph is equal to the <a href="null_space" title="wikilink">null space</a> of its oriented incidence matrix, viewed as a matrix over the <a class="uri" href="integers" title="wikilink">integers</a> or <a href="real_numbers" title="wikilink">real</a> or <a href="complex_numbers" title="wikilink">complex numbers</a>. The binary cycle space is the null space of its oriented or unoriented incidence matrix, viewed as a matrix over the two-element <a href="field_(mathematics)" title="wikilink">field</a>.</p>
<h3 id="signed-and-bidirected-graphs">Signed and bidirected graphs</h3>

<p>The incidence matrix of a <a href="signed_graph" title="wikilink">signed graph</a> is a generalization of the oriented incidence matrix. It is the incidence matrix of any <a href="bidirected_graph" title="wikilink">bidirected graph</a> that orients the given signed graph. The column of a positive edge has a +1 in the row corresponding to one endpoint and a −1 in the row corresponding to the other endpoint, just like an edge in an ordinary (unsigned) graph. The column of a negative edge has either a +1 or a −1 in both rows. The line graph and Kirchhoff matrix properties generalize to signed graphs.</p>
<h3 id="multigraphs">Multigraphs</h3>

<p>The definitions of incidence matrix apply to graphs with <a href="loop_(graph_theory)" title="wikilink">loops</a> and <a href="multiple_edges" title="wikilink">multiple edges</a>. The column of an oriented incidence matrix that corresponds to a loop is all zero, unless the graph is signed and the loop is negative; then the column is all zero except for ±2 in the row of its incident vertex.</p>
<h3 id="hypergraphs">Hypergraphs</h3>

<p>Because the edges of ordinary graphs can only have two vertices (one at each end), the column of an incidence matrix for graphs can only have two non-zero entries. By contrast, a <a class="uri" href="hypergraph" title="wikilink">hypergraph</a> can have multiple vertices assigned to one edge; thus, a general matrix of non-negative integers describes a hypergraph.</p>
<h2 id="incidence-structures">Incidence structures</h2>

<p>The <strong>incidence matrix</strong> of an <a href="incidence_structure" title="wikilink">incidence structure</a> <em>C</em> is a <em>p</em> × <em>q</em> matrix 

<math display="inline" id="Incidence_matrix:15">
<semantics>
<mrow>
<mo stretchy="false">[</mo>
<msub>
<mi>b</mi>
<mrow>
<mi>i</mi>
<mi>j</mi>
</mrow>
</msub>
<mo stretchy="false">]</mo>
</mrow>
<annotation-xml encoding="MathML-Content">
<apply>
<csymbol cd="latexml">delimited-[]</csymbol>
<apply>
<csymbol cd="ambiguous">subscript</csymbol>
<ci>b</ci>
<apply>
<times></times>
<ci>i</ci>
<ci>j</ci>
</apply>
</apply>
</apply>
</annotation-xml>
<annotation encoding="application/x-tex">
   [b_{ij}]
  </annotation>
</semantics>
</math>

, where <em>p</em> and <em>q</em> are the number of <strong>points</strong> and <strong>lines</strong> respectively, such that 

<math display="inline" id="Incidence_matrix:16">
<semantics>
<mrow>
<msub>
<mi>b</mi>
<mrow>
<mi>i</mi>
<mi>j</mi>
</mrow>
</msub>
<mo>=</mo>
<mn>1</mn>
</mrow>
<annotation-xml encoding="MathML-Content">
<apply>
<eq></eq>
<apply>
<csymbol cd="ambiguous">subscript</csymbol>
<ci>b</ci>
<apply>
<times></times>
<ci>i</ci>
<ci>j</ci>
</apply>
</apply>
<cn type="integer">1</cn>
</apply>
</annotation-xml>
<annotation encoding="application/x-tex">
   b_{ij}=1
  </annotation>
</semantics>
</math>

 if the point 

<math display="inline" id="Incidence_matrix:17">
<semantics>
<msub>
<mi>p</mi>
<mi>i</mi>
</msub>
<annotation-xml encoding="MathML-Content">
<apply>
<csymbol cd="ambiguous">subscript</csymbol>
<ci>p</ci>
<ci>i</ci>
</apply>
</annotation-xml>
<annotation encoding="application/x-tex">
   p_{i}
  </annotation>
</semantics>
</math>

 and line 

<math display="inline" id="Incidence_matrix:18">
<semantics>
<msub>
<mi>L</mi>
<mi>j</mi>
</msub>
<annotation-xml encoding="MathML-Content">
<apply>
<csymbol cd="ambiguous">subscript</csymbol>
<ci>L</ci>
<ci>j</ci>
</apply>
</annotation-xml>
<annotation encoding="application/x-tex">
   L_{j}
  </annotation>
</semantics>
</math>

 are incident and 0 otherwise. In this case the incidence matrix is also a <a href="biadjacency_matrix" title="wikilink">biadjacency matrix</a> of the <a href="Levi_graph" title="wikilink">Levi graph</a> of the structure. As there is a <a class="uri" href="hypergraph" title="wikilink">hypergraph</a> for every Levi graph, and <em>vice versa</em>, the incidence matrix of an incidence structure describes a hypergraph.</p>
<h3 id="finite-geometries">Finite geometries</h3>

<p>An important example is a <a href="finite_geometry" title="wikilink">finite geometry</a>. For instance, in a finite plane, <em>X</em> is the set of points and <em>Y</em> is the set of lines. In a finite geometry of higher dimension, <em>X</em> could be the set of points and <em>Y</em> could be the set of subspaces of dimension one less than the dimension of <em>Y</em>; or <em>X</em> could be the set of all subspaces of one dimension <em>d</em> and <em>Y</em> the set of all subspaces of another dimension <em>e</em>.</p>
<h3 id="block-designs">Block designs</h3>

<p>Another example is a <a href="block_design" title="wikilink">block design</a>. Here <em>X</em> is a finite set of "points" and <em>Y</em> is a class of subsets of <em>X</em>, called "blocks", subject to rules that depend on the type of design. The incidence matrix is an important tool in the theory of block designs. For instance, it is used to prove the fundamental theorem of symmetric 2-designs, that the number of blocks equals the number of points.</p>
<h2 id="references">References</h2>
<ul>
<li>

<p>.</p></li>
<li><a href="Coxeter" title="wikilink">Coxeter, H.S.M.</a> <em><a href="Regular_Polytopes_(book)" title="wikilink">Regular Polytopes</a></em>, (3rd edition, 1973), Dover edition, ISBN 0-486-61480-8 (Section 9.2 Incidence matrices, pp. 166–171)</li>
<li>Jonathan L Gross, Jay Yellen, <em>Graph Theory and its applications</em>, second edition, 2006 (p 97, Incidence Matrices for undirect graphs; p 98, incidence matrices for digraphs)</li>
<li></li>
</ul>
<h2 id="see-also">See also</h2>

<p>"</p>

<p><a href="Category:Algebraic_graph_theory" title="wikilink">Category:Algebraic graph theory</a> <a class="uri" href="Category:Combinatorics" title="wikilink">Category:Combinatorics</a> <a class="uri" href="Category:Matrices" title="wikilink">Category:Matrices</a> <a href="Category:Graph_data_structures" title="wikilink">Category:Graph data structures</a></p>
</body>
</html>

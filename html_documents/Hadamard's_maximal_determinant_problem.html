<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="671">Hadamard's maximal determinant problem</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Hadamard's maximal determinant problem</h1>
<hr/>

<p><strong>Hadamard's maximal determinant problem</strong>, named after <a href="Jacques_Hadamard" title="wikilink">Jacques Hadamard</a>, asks for the largest <a class="uri" href="determinant" title="wikilink">determinant</a> of a <a href="matrix_(mathematics)" title="wikilink">matrix</a> with elements equal to 1 or −1. The analogous question for matrices with elements equal to 0 or 1 is equivalent since, as will be shown below, the maximal determinant of a {1,−1} matrix of size <em>n</em> is 2<sup><em>n</em>−1</sup> times the maximal determinant of a {0,1} matrix of size <em>n</em>−1. The problem was posed by Hadamard in the 1893 paper <a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a> in which he presented his famous <a href="Hadamard's_inequality" title="wikilink">determinant bound</a> and remains unsolved for matrices of general size. Hadamard's bound implies that {1, −1}-matrices of size <em>n</em> have determinant at most <em>n</em><sup><em>n</em>/2</sup>. Hadamard observed that a construction of <a href="James_Joseph_Sylvester" title="wikilink">Sylvester</a><a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a> produces examples of matrices that attain the bound when <em>n</em> is a power of 2, and produced examples of his own of sizes 12 and 20. He also showed that the bound is only attainable when <em>n</em> is equal to 1, 2, or a multiple of 4. Additional examples were later constructed by Scarpis and Paley and subsequently by many other authors. Such matrices are now known as <a href="Hadamard_matrices" title="wikilink">Hadamard matrices</a>. They have received intensive study.</p>

<p>Matrix sizes <em>n</em> for which <em>n</em> ≡ 1, 2, or 3 (mod 4) have received less attention. The earliest results are due to Barba, who tightened Hadamard's bound for <em>n</em> odd, and Williamson, who found the largest determinants for <em>n</em>=3, 5, 6, and 7. Some important results include</p>
<ul>
<li>tighter bounds, due to Barba, Ehlich, and Wojtas, for <em>n</em> ≡ 1, 2, or 3 (mod 4), which, however, are known not to be always attainable,</li>
<li>a few infinite sequences of matrices attaining the bounds for <em>n</em> ≡ 1 or 2 (mod 4),</li>
<li>a number of matrices attaining the bounds for specific <em>n</em> ≡ 1 or 2 (mod 4),</li>
<li>a number of matrices not attaining the bounds for specific <em>n</em> ≡ 1 or 3 (mod 4), but that have been proved by exhaustive computation to have maximal determinant.</li>
</ul>

<p>The <a href="design_of_experiments" title="wikilink">design of experiments</a> in <a class="uri" href="statistics" title="wikilink">statistics</a> makes use of {1, −1} matrices <em>X</em> (not necessarily square) for which the <a href="information_matrix" title="wikilink">information matrix</a> <em>X</em><sup>T</sup><em>X</em> has maximal determinant. (The notation <em>X</em><sup>T</sup> denotes the <a class="uri" href="transpose" title="wikilink">transpose</a> of <em>X</em>.) Such matrices are known as <a href="optimal_design" title="wikilink">D-optimal designs</a>.<a class="footnoteRef" href="#fn3" id="fnref3"><sup>3</sup></a> If <em>X</em> is a <a href="square_matrix" title="wikilink">square matrix</a>, it is known as a saturated D-optimal design.</p>
<h2 id="hadamard-matrices">Hadamard matrices</h2>

<p>Any two rows of an <em>n</em>×<em>n</em> Hadamard matrix are <a class="uri" href="orthogonal" title="wikilink">orthogonal</a>, which is impossible for a {1, −1} matrix when <em>n</em> is an <a href="odd_number" title="wikilink">odd number</a>. When <em>n</em> ≡ 2 (mod 4), two rows that are both orthogonal to a third row cannot be orthogonal to each other. Together, these statements imply that an <em>n</em>×<em>n</em> Hadamard matrix can exist only if <em>n</em> = 1, 2, or a multiple of 4. Hadamard matrices have been well studied, but it is not known whether a Hadamard matrix of size 4<em>k</em> exists for every <em>k</em> ≥ 1. The smallest <em>k</em> for which a 4<em>k</em>×4<em>k</em> Hadamard matrix is not known to exist is 167.</p>
<h2 id="equivalence-and-normalization-of-11-matrices">Equivalence and normalization of {1, −1} matrices</h2>

<p>Any of the following operations, when performed on a {1, −1} matrix <em>R</em>, changes the determinant of <em>R</em> only by a minus sign:</p>
<ul>
<li>Negation of a row.</li>
<li>Negation of a column.</li>
<li>Interchange of two rows.</li>
<li>Interchange of two columns.</li>
</ul>

<p>Two {1,−1} matrices, <em>R</em><sub>1</sub> and <em>R</em><sub>2</sub>, are considered <strong>equivalent</strong> if <em>R</em><sub>1</sub> can be converted to <em>R</em><sub>2</sub> by some sequence of the above operations. The determinants of equivalent matrices are equal, except possibly for a sign change, and it is often convenient to standardize <em>R</em> by means of negations and permutations of rows and columns. A {1, −1} matrix is <strong>normalized</strong> if all elements in its first row and column equal 1. When the size of a matrix is odd, it is sometimes useful to use a different normalization in which every row and column contains an even number of elements 1 and an odd number of elements −1. Either of these normalizations can be accomplished using the first two operations.</p>
<h2 id="connection-of-the-maximal-determinant-problems-for-11-and-01-matrices">Connection of the maximal determinant problems for {1, −1} and {0, 1} matrices</h2>

<p>There is a one-to-one map from the set of normalized <em>n</em>×<em>n</em> {1, −1} matrices to the set of (<em>n</em>−1)×(<em>n</em>-1) {0, 1} matrices under which the magnitude of the determinant is reduced by a factor of 2<sup>1−<em>n</em></sup>. This map consists of the following steps.</p>
<ol>
<li>Subtract row 1 of the {1, −1} matrix from rows 2 through <em>n</em>. (This does not change the determinant.)</li>
<li>Extract the (<em>n</em>−1)×(<em>n</em>−1) submatrix consisting of rows 2 through <em>n</em> and columns 2 through <em>n</em>. This matrix has elements 0 and −2. (The determinant of this submatrix is the same as that of the original matrix, as can be seen by performing a <a href="cofactor_expansion" title="wikilink">cofactor expansion</a> on column 1 of the matrix obtained in Step 1.)</li>
<li>Divide the submatrix by −2 to obtain a {0, 1} matrix. (This multiplies the determinant by (−2)<sup>1-<em>n</em></sup>.)</li>
</ol>

<p><strong>Example:</strong></p>

<p>

<math display="block" id="Hadamard's_maximal_determinant_problem:0">
 <semantics>
  <mrow>
   <mrow>
    <mo>[</mo>
    <mtable displaystyle="true">
     <mtr>
      <mtd columnalign="center">
       <mn>1</mn>
      </mtd>
      <mtd columnalign="center">
       <mn>1</mn>
      </mtd>
      <mtd columnalign="center">
       <mn>1</mn>
      </mtd>
      <mtd columnalign="center">
       <mn>1</mn>
      </mtd>
     </mtr>
     <mtr>
      <mtd columnalign="center">
       <mn>1</mn>
      </mtd>
      <mtd columnalign="center">
       <mrow>
        <mo>-</mo>
        <mn>1</mn>
       </mrow>
      </mtd>
      <mtd columnalign="center">
       <mrow>
        <mo>-</mo>
        <mn>1</mn>
       </mrow>
      </mtd>
      <mtd columnalign="center">
       <mn>1</mn>
      </mtd>
     </mtr>
     <mtr>
      <mtd columnalign="center">
       <mn>1</mn>
      </mtd>
      <mtd columnalign="center">
       <mn>1</mn>
      </mtd>
      <mtd columnalign="center">
       <mrow>
        <mo>-</mo>
        <mn>1</mn>
       </mrow>
      </mtd>
      <mtd columnalign="center">
       <mrow>
        <mo>-</mo>
        <mn>1</mn>
       </mrow>
      </mtd>
     </mtr>
     <mtr>
      <mtd columnalign="center">
       <mn>1</mn>
      </mtd>
      <mtd columnalign="center">
       <mrow>
        <mo>-</mo>
        <mn>1</mn>
       </mrow>
      </mtd>
      <mtd columnalign="center">
       <mn>1</mn>
      </mtd>
      <mtd columnalign="center">
       <mrow>
        <mo>-</mo>
        <mn>1</mn>
       </mrow>
      </mtd>
     </mtr>
    </mtable>
    <mo>]</mo>
   </mrow>
   <mo>→</mo>
   <mrow>
    <mo>[</mo>
    <mtable displaystyle="true">
     <mtr>
      <mtd class="ltx_border_r" columnalign="center">
       <mn>1</mn>
      </mtd>
      <mtd columnalign="center">
       <mn>1</mn>
      </mtd>
      <mtd columnalign="center">
       <mn>1</mn>
      </mtd>
      <mtd columnalign="center">
       <mn>1</mn>
      </mtd>
     </mtr>
     <mtr>
      <mtd class="ltx_border_r ltx_border_t" columnalign="center">
       <mn>0</mn>
      </mtd>
      <mtd class="ltx_border_t" columnalign="center">
       <mrow>
        <mo>-</mo>
        <mn>2</mn>
       </mrow>
      </mtd>
      <mtd class="ltx_border_t" columnalign="center">
       <mrow>
        <mo>-</mo>
        <mn>2</mn>
       </mrow>
      </mtd>
      <mtd class="ltx_border_t" columnalign="center">
       <mn>0</mn>
      </mtd>
     </mtr>
     <mtr>
      <mtd class="ltx_border_r" columnalign="center">
       <mn>0</mn>
      </mtd>
      <mtd columnalign="center">
       <mn>0</mn>
      </mtd>
      <mtd columnalign="center">
       <mrow>
        <mo>-</mo>
        <mn>2</mn>
       </mrow>
      </mtd>
      <mtd columnalign="center">
       <mrow>
        <mo>-</mo>
        <mn>2</mn>
       </mrow>
      </mtd>
     </mtr>
     <mtr>
      <mtd class="ltx_border_r" columnalign="center">
       <mn>0</mn>
      </mtd>
      <mtd columnalign="center">
       <mrow>
        <mo>-</mo>
        <mn>2</mn>
       </mrow>
      </mtd>
      <mtd columnalign="center">
       <mn>0</mn>
      </mtd>
      <mtd columnalign="center">
       <mrow>
        <mo>-</mo>
        <mn>2</mn>
       </mrow>
      </mtd>
     </mtr>
    </mtable>
    <mo>]</mo>
   </mrow>
   <mo>→</mo>
   <mrow>
    <mo>[</mo>
    <mtable displaystyle="true">
     <mtr>
      <mtd columnalign="center">
       <mrow>
        <mo>-</mo>
        <mn>2</mn>
       </mrow>
      </mtd>
      <mtd columnalign="center">
       <mrow>
        <mo>-</mo>
        <mn>2</mn>
       </mrow>
      </mtd>
      <mtd columnalign="center">
       <mn>0</mn>
      </mtd>
     </mtr>
     <mtr>
      <mtd columnalign="center">
       <mn>0</mn>
      </mtd>
      <mtd columnalign="center">
       <mrow>
        <mo>-</mo>
        <mn>2</mn>
       </mrow>
      </mtd>
      <mtd columnalign="center">
       <mrow>
        <mo>-</mo>
        <mn>2</mn>
       </mrow>
      </mtd>
     </mtr>
     <mtr>
      <mtd columnalign="center">
       <mrow>
        <mo>-</mo>
        <mn>2</mn>
       </mrow>
      </mtd>
      <mtd columnalign="center">
       <mn>0</mn>
      </mtd>
      <mtd columnalign="center">
       <mrow>
        <mo>-</mo>
        <mn>2</mn>
       </mrow>
      </mtd>
     </mtr>
    </mtable>
    <mo>]</mo>
   </mrow>
   <mo>→</mo>
   <mrow>
    <mo>[</mo>
    <mtable displaystyle="true">
     <mtr>
      <mtd columnalign="center">
       <mn>1</mn>
      </mtd>
      <mtd columnalign="center">
       <mn>1</mn>
      </mtd>
      <mtd columnalign="center">
       <mn>0</mn>
      </mtd>
     </mtr>
     <mtr>
      <mtd columnalign="center">
       <mn>0</mn>
      </mtd>
      <mtd columnalign="center">
       <mn>1</mn>
      </mtd>
      <mtd columnalign="center">
       <mn>1</mn>
      </mtd>
     </mtr>
     <mtr>
      <mtd columnalign="center">
       <mn>1</mn>
      </mtd>
      <mtd columnalign="center">
       <mn>0</mn>
      </mtd>
      <mtd columnalign="center">
       <mn>1</mn>
      </mtd>
     </mtr>
    </mtable>
    <mo>]</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <ci>normal-→</ci>
     <matrix>
      <matrixrow>
       <cn type="integer">1</cn>
       <cn type="integer">1</cn>
       <cn type="integer">1</cn>
       <cn type="integer">1</cn>
      </matrixrow>
      <matrixrow>
       <cn type="integer">1</cn>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
       </apply>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
       </apply>
       <cn type="integer">1</cn>
      </matrixrow>
      <matrixrow>
       <cn type="integer">1</cn>
       <cn type="integer">1</cn>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
       </apply>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
       </apply>
      </matrixrow>
      <matrixrow>
       <cn type="integer">1</cn>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
       </apply>
       <cn type="integer">1</cn>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
       </apply>
      </matrixrow>
     </matrix>
     <apply>
      <csymbol cd="latexml">delimited-[]</csymbol>
      <matrix>
       <matrixrow>
        <cn type="integer">1</cn>
        <cn type="integer">1</cn>
        <cn type="integer">1</cn>
        <cn type="integer">1</cn>
       </matrixrow>
       <matrixrow>
        <cn type="integer">0</cn>
        <apply>
         <minus></minus>
         <cn type="integer">2</cn>
        </apply>
        <apply>
         <minus></minus>
         <cn type="integer">2</cn>
        </apply>
        <cn type="integer">0</cn>
       </matrixrow>
       <matrixrow>
        <cn type="integer">0</cn>
        <cn type="integer">0</cn>
        <apply>
         <minus></minus>
         <cn type="integer">2</cn>
        </apply>
        <apply>
         <minus></minus>
         <cn type="integer">2</cn>
        </apply>
       </matrixrow>
       <matrixrow>
        <cn type="integer">0</cn>
        <apply>
         <minus></minus>
         <cn type="integer">2</cn>
        </apply>
        <cn type="integer">0</cn>
        <apply>
         <minus></minus>
         <cn type="integer">2</cn>
        </apply>
       </matrixrow>
      </matrix>
     </apply>
    </apply>
    <apply>
     <ci>normal-→</ci>
     <share href="#.cmml">
     </share>
     <matrix>
      <matrixrow>
       <apply>
        <minus></minus>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <minus></minus>
        <cn type="integer">2</cn>
       </apply>
       <cn type="integer">0</cn>
      </matrixrow>
      <matrixrow>
       <cn type="integer">0</cn>
       <apply>
        <minus></minus>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <minus></minus>
        <cn type="integer">2</cn>
       </apply>
      </matrixrow>
      <matrixrow>
       <apply>
        <minus></minus>
        <cn type="integer">2</cn>
       </apply>
       <cn type="integer">0</cn>
       <apply>
        <minus></minus>
        <cn type="integer">2</cn>
       </apply>
      </matrixrow>
     </matrix>
    </apply>
    <apply>
     <ci>normal-→</ci>
     <share href="#.cmml">
     </share>
     <matrix>
      <matrixrow>
       <cn type="integer">1</cn>
       <cn type="integer">1</cn>
       <cn type="integer">0</cn>
      </matrixrow>
      <matrixrow>
       <cn type="integer">0</cn>
       <cn type="integer">1</cn>
       <cn type="integer">1</cn>
      </matrixrow>
      <matrixrow>
       <cn type="integer">1</cn>
       <cn type="integer">0</cn>
       <cn type="integer">1</cn>
      </matrixrow>
     </matrix>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \begin{bmatrix}1&1&1&1\\
1&-1&-1&1\\
1&1&-1&-1\\
1&-1&1&-1\end{bmatrix}\rightarrow\left[\begin{array}[]{c|ccc}1&1&1&1\\
\hline 0&-2&-2&0\\
0&0&-2&-2\\
0&-2&0&-2\end{array}\right]\rightarrow\begin{bmatrix}-2&-2&0\\
0&-2&-2\\
-2&0&-2\end{bmatrix}\rightarrow\begin{bmatrix}1&1&0\\
0&1&1\\
1&0&1\end{bmatrix}
  </annotation>
 </semantics>
</math>

 In this example, the original matrix has determinant −16 and its image has determinant 2 = −16·(−2)<sup>−3</sup>.</p>

<p>Since the determinant of a {0, 1} matrix is an integer, the determinant of an <em>n</em>×<em>n</em> {1, −1} matrix is an integer multiple of 2<sup><em>n</em>−1</sup>.</p>
<h2 id="upper-bounds-on-the-maximal-determinant">Upper bounds on the maximal determinant</h2>
<h3 id="gram-matrix">Gram matrix</h3>

<p>Let <em>R</em> be an <em>n</em> by <em>n</em> {1, −1} matrix. The <strong>Gram matrix</strong> of <em>R</em> is defined to be the matrix <em>G</em> = <em>RR</em><sup>T</sup>. From this definition it follows that <em>G</em></p>
<ol>
<li>is an integer matrix,</li>
<li>is <a href="symmetric_matrix" title="wikilink">symmetric</a>,</li>
<li>is <a href="positive-definite_matrix" title="wikilink">positive-semidefinite</a>,</li>
<li>has constant diagonal whose value equals <em>n</em>.</li>
</ol>

<p>Negating rows of <em>R</em> or applying a permutation to them results in the same negations and permutation being applied both to the rows, and to the corresponding columns, of <em>G</em>. We may also define the matrix <em>G</em>′=<em>R</em><sup>T</sup><em>R</em>. The matrix <em>G</em> is the usual <a href="Gram_matrix" title="wikilink">Gram matrix</a> of a set of vectors, derived from the set of rows of <em>R</em>, while <em>G</em>′ is the Gram matrix derived from the set of columns of <em>R</em>. A matrix <em>R</em> for which <em>G</em> = <em>G</em>′ is a <a href="normal_matrix" title="wikilink">normal matrix</a>. Every known maximal-determinant matrix is equivalent to a normal matrix, but it is not known whether this is always the case.</p>
<h3 id="hadamards-bound-for-all-n">Hadamard's bound (for all <em>n</em>)</h3>

<p>Hadamard's bound can be derived by noting that |det <em>R</em>| = (det <em>G</em>)<sup>1/2</sup> ≤ (det <em>nI</em>)<sup>1/2</sup> = <em>n</em><sup><em>n</em>/2</sup>, which is a consequence of the observation that <em>nI</em>, where <em>I</em> is the <em>n</em> by <em>n</em> <a href="identity_matrix" title="wikilink">identity matrix</a>, is the unique matrix of maximal determinant among matrices satisfying properties 1–4. That det <em>R</em> must be an integer multiple of 2<sup><em>n</em>−1</sup> can be used to provide another demonstration that Hadamard's bound is not always attainable. When <em>n</em> is odd, the bound <em>n</em><sup><em>n</em>/2</sup> is either non-integer or odd, and is therefore unattainable except when <em>n</em> = 1. When <em>n</em> = 2<em>k</em> with <em>k</em> odd, the highest power of 2 dividing Hadamard's bound is 2<sup><em>k</em></sup> which is less than 2<sup><em>n</em>−1</sup> unless <em>n</em> = 2. Therefore Hadamard's bound is unattainable unless <em>n</em> = 1, 2, or a multiple of 4.</p>
<h3 id="barbas-bound-for-n-odd">Barba's bound for <em>n</em> odd</h3>

<p>When <em>n</em> is odd, property 1 for Gram matrices can be strengthened to</p>
<ol>
<li><em>G</em> is an odd-integer matrix.</li>
</ol>

<p>This allows a sharper upper bound<a class="footnoteRef" href="#fn4" id="fnref4"><sup>4</sup></a> to be derived: |det <em>R</em>| = (det <em>G</em>)<sup>1/2</sup> ≤ (det (<em>n</em>-1)<em>I</em>+<em>J</em>)<sup>1/2</sup> = (2<em>n</em>−1)<sup>1/2</sup>(<em>n</em>−1)<sup>(<em>n</em>−1)/2</sup>, where <em>J</em> is the all-one matrix. Here (<em>n</em>-1)<em>I</em>+<em>J</em> is the maximal-determinant matrix satisfying the modified property 1 and properties 2–4. It is unique up to multiplication of any set of rows and the corresponding set of columns by −1. The bound is not attainable unless 2<em>n</em>−1 is a perfect square, and is therefore never attainable when <em>n</em> ≡ 3 (mod 4).</p>
<h3 id="the-ehlichwojtas-bound-for-n2-mod-4">The Ehlich–Wojtas bound for <em>n</em> ≡ 2 (mod 4)</h3>

<p>When <em>n</em> is even, the set of rows of <em>R</em> can be partitioned into two subsets.</p>
<ul>
<li>Rows of <strong>even type</strong> contain an even number of elements 1 and an even number of elements −1.</li>
<li>Rows of <strong>odd type</strong> contain an odd number of elements 1 and an odd number of elements −1.</li>
</ul>

<p>The dot product of two rows of the same type is congruent to <em>n</em> (mod 4); the dot product of two rows of opposite type is congruent to <em>n</em>+2 (mod 4). When <em>n</em> ≡ 2 (mod 4), this implies that, by permuting rows of <em>R</em>, we may assume the <strong>standard form</strong>,</p>

<p>

<math display="block" id="Hadamard's_maximal_determinant_problem:1">
 <semantics>
  <mrow>
   <mrow>
    <mi>G</mi>
    <mo>=</mo>
    <mrow>
     <mo>[</mo>
     <mtable displaystyle="true">
      <mtr>
       <mtd columnalign="center">
        <mi>A</mi>
       </mtd>
       <mtd columnalign="center">
        <mi>B</mi>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <msup>
         <mi>B</mi>
         <mi mathvariant="normal">T</mi>
        </msup>
       </mtd>
       <mtd columnalign="center">
        <mi>D</mi>
       </mtd>
      </mtr>
     </mtable>
     <mo>]</mo>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>G</ci>
    <matrix>
     <matrixrow>
      <ci>A</ci>
      <ci>B</ci>
     </matrixrow>
     <matrixrow>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>B</ci>
       <ci>normal-T</ci>
      </apply>
      <ci>D</ci>
     </matrixrow>
    </matrix>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   G=\begin{bmatrix}A&B\\
B^{\mathrm{T}}&D\end{bmatrix},
  </annotation>
 </semantics>
</math>

 where <em>A</em> and <em>D</em> are symmetric integer matrices whose elements are congruent to 2 (mod 4) and <em>B</em> is a matrix whose elements are congruent to 0 (mod 4). In 1964, Ehlich<a class="footnoteRef" href="#fn5" id="fnref5"><sup>5</sup></a> and Wojtas<a class="footnoteRef" href="#fn6" id="fnref6"><sup>6</sup></a> independently showed that in the maximal determinant matrix of this form, <em>A</em> and <em>D</em> are both of size <em>n</em>/2 and equal to (<em>n</em>−2)<em>I</em>+2<em>J</em> while <em>B</em> is the zero matrix. This optimal form is unique up to multiplication of any set of rows and the corresponding set of columns by −1 and to simultaneous application of a permutation to rows and columns. This implies the bound det <em>R</em> ≤ (2<em>n</em>−2)(<em>n</em>−2)<sup>(<em>n</em>−2)/2</sup>. Ehlich showed that if <em>R</em> attains the bound, and if the rows and columns of <em>R</em> are permuted so that both <em>G</em> = <em>RR</em><sup>T</sup> and <em>G</em>′ = <em>R</em><sup>T</sup><em>R</em> have the standard form and are suitably normalized, then we may write</p>

<p>

<math display="block" id="Hadamard's_maximal_determinant_problem:2">
 <semantics>
  <mrow>
   <mi>R</mi>
   <mo>=</mo>
   <mrow>
    <mo>[</mo>
    <mtable displaystyle="true">
     <mtr>
      <mtd columnalign="center">
       <mi>W</mi>
      </mtd>
      <mtd columnalign="center">
       <mi>X</mi>
      </mtd>
     </mtr>
     <mtr>
      <mtd columnalign="center">
       <mi>Y</mi>
      </mtd>
      <mtd columnalign="center">
       <mi>Z</mi>
      </mtd>
     </mtr>
    </mtable>
    <mo>]</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>R</ci>
    <matrix>
     <matrixrow>
      <ci>W</ci>
      <ci>X</ci>
     </matrixrow>
     <matrixrow>
      <ci>Y</ci>
      <ci>Z</ci>
     </matrixrow>
    </matrix>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   R=\begin{bmatrix}W&X\\
Y&Z\end{bmatrix}
  </annotation>
 </semantics>
</math>

 where <em>W</em>, <em>X</em>, <em>Y</em>, and <em>Z</em> are (<em>n</em>/2)×(<em>n</em>/2) matrices with constant row and column sums <em>w</em>, <em>x</em>, <em>y</em>, and <em>z</em> that satisfy <em>z</em> = −<em>w</em>, <em>y</em> = <em>x</em>, and <em>w</em><sup>2</sup>+<em>x</em><sup>2</sup> = 2<em>n</em>−2. Hence the Ehlich–Wojtas bound is not attainable unless 2<em>n</em>−2 is expressible as the sum of two squares.</p>
<h3 id="ehlichs-bound-for-n3-mod-4">Ehlich's bound for <em>n</em> ≡ 3 (mod 4)</h3>

<p>When <em>n</em> is odd, then by using the freedom to multiply rows by −1, one may impose the condition that each row of <em>R</em> contain an even number of elements 1 and an odd number of elements −1. It can be shown that, if this normalization is assumed, then property 1 of <em>G</em> may be strengthened to</p>
<ol>
<li><em>G</em> is a matrix with integer elements congruent to <em>n</em> (mod 4).</li>
</ol>

<p>When <em>n</em> ≡ 1 (mod 4), the optimal form of Barba satisfies this stronger property, but when <em>n</em> ≡ 3 (mod 4), it does not. This means that the bound can be sharpened in the latter case. Ehlich<a class="footnoteRef" href="#fn7" id="fnref7"><sup>7</sup></a> showed that when <em>n</em> ≡ 3 (mod 4), the strengthened property 1 implies that the maximal-determinant form of <em>G</em> can be written as <em>B</em>−<em>J</em> where <em>J</em> is the all-one matrix and <em>B</em> is a <a href="block-diagonal_matrix" title="wikilink">block-diagonal matrix</a> whose diagonal blocks are of the form (<em>n</em>-3)<em>I</em>+4<em>J</em>. Moreover, he showed that in the optimal form, the number of blocks, <em>s</em>, depends on <em>n</em> as shown in the table below, and that each block either has size <em>r</em> or size <em>r+1</em> where 

<math display="inline" id="Hadamard's_maximal_determinant_problem:3">
 <semantics>
  <mrow>
   <mrow>
    <mi>r</mi>
    <mo>=</mo>
    <mrow>
     <mo stretchy="false">⌊</mo>
     <mrow>
      <mi>n</mi>
      <mo>/</mo>
      <mi>s</mi>
     </mrow>
     <mo stretchy="false">⌋</mo>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>r</ci>
    <apply>
     <floor></floor>
     <apply>
      <divide></divide>
      <ci>n</ci>
      <ci>s</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   r=\lfloor n/s\rfloor.
  </annotation>
 </semantics>
</math>


</p>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">
<p><em>n</em></p></th>
<th style="text-align: left;">
<p><em>s</em></p></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">
<p>3</p></td>
<td style="text-align: left;">
<p>3</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>7</p></td>
<td style="text-align: left;">
<p>5</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>11</p></td>
<td style="text-align: left;">
<p>5 or 6</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>15 − 59</p></td>
<td style="text-align: left;">
<p>6</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>≥ 63</p></td>
<td style="text-align: left;">
<p>7</p></td>
</tr>
</tbody>
</table>

<p>Except for <em>n</em>=11 where there are two possibilities, the optimal form is unique up to multiplication of any set of rows and the corresponding set of columns by −1 and to simultaneous application of a permutation to rows and columns. This optimal form leads to the bound</p>

<p>

<math display="block" id="Hadamard's_maximal_determinant_problem:4">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mo movablelimits="false">det</mo>
     <mi>R</mi>
    </mrow>
    <mo>≤</mo>
    <mrow>
     <msup>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mi>n</mi>
        <mo>-</mo>
        <mn>3</mn>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
      <mrow>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mi>n</mi>
         <mo>-</mo>
         <mi>s</mi>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
       <mo>/</mo>
       <mn>2</mn>
      </mrow>
     </msup>
     <msup>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mrow>
         <mi>n</mi>
         <mo>-</mo>
         <mn>3</mn>
        </mrow>
        <mo>+</mo>
        <mrow>
         <mn>4</mn>
         <mi>r</mi>
        </mrow>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
      <mrow>
       <mi>u</mi>
       <mo>/</mo>
       <mn>2</mn>
      </mrow>
     </msup>
     <msup>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mi>n</mi>
        <mo>+</mo>
        <mn>1</mn>
        <mo>+</mo>
        <mrow>
         <mn>4</mn>
         <mi>r</mi>
        </mrow>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
      <mrow>
       <mi>v</mi>
       <mo>/</mo>
       <mn>2</mn>
      </mrow>
     </msup>
     <msup>
      <mrow>
       <mo>[</mo>
       <mrow>
        <mn>1</mn>
        <mo>-</mo>
        <mfrac>
         <mrow>
          <mi>u</mi>
          <mi>r</mi>
         </mrow>
         <mrow>
          <mrow>
           <mi>n</mi>
           <mo>-</mo>
           <mn>3</mn>
          </mrow>
          <mo>+</mo>
          <mrow>
           <mn>4</mn>
           <mi>r</mi>
          </mrow>
         </mrow>
        </mfrac>
        <mo>-</mo>
        <mfrac>
         <mrow>
          <mi>v</mi>
          <mrow>
           <mo stretchy="false">(</mo>
           <mrow>
            <mi>r</mi>
            <mo>+</mo>
            <mn>1</mn>
           </mrow>
           <mo stretchy="false">)</mo>
          </mrow>
         </mrow>
         <mrow>
          <mi>n</mi>
          <mo>+</mo>
          <mn>1</mn>
          <mo>+</mo>
          <mrow>
           <mn>4</mn>
           <mi>r</mi>
          </mrow>
         </mrow>
        </mfrac>
       </mrow>
       <mo>]</mo>
      </mrow>
      <mrow>
       <mn>1</mn>
       <mo>/</mo>
       <mn>2</mn>
      </mrow>
     </msup>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <leq></leq>
    <apply>
     <determinant></determinant>
     <ci>R</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <minus></minus>
       <ci>n</ci>
       <cn type="integer">3</cn>
      </apply>
      <apply>
       <divide></divide>
       <apply>
        <minus></minus>
        <ci>n</ci>
        <ci>s</ci>
       </apply>
       <cn type="integer">2</cn>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <plus></plus>
       <apply>
        <minus></minus>
        <ci>n</ci>
        <cn type="integer">3</cn>
       </apply>
       <apply>
        <times></times>
        <cn type="integer">4</cn>
        <ci>r</ci>
       </apply>
      </apply>
      <apply>
       <divide></divide>
       <ci>u</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <plus></plus>
       <ci>n</ci>
       <cn type="integer">1</cn>
       <apply>
        <times></times>
        <cn type="integer">4</cn>
        <ci>r</ci>
       </apply>
      </apply>
      <apply>
       <divide></divide>
       <ci>v</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="latexml">delimited-[]</csymbol>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
        <apply>
         <divide></divide>
         <apply>
          <times></times>
          <ci>u</ci>
          <ci>r</ci>
         </apply>
         <apply>
          <plus></plus>
          <apply>
           <minus></minus>
           <ci>n</ci>
           <cn type="integer">3</cn>
          </apply>
          <apply>
           <times></times>
           <cn type="integer">4</cn>
           <ci>r</ci>
          </apply>
         </apply>
        </apply>
        <apply>
         <divide></divide>
         <apply>
          <times></times>
          <ci>v</ci>
          <apply>
           <plus></plus>
           <ci>r</ci>
           <cn type="integer">1</cn>
          </apply>
         </apply>
         <apply>
          <plus></plus>
          <ci>n</ci>
          <cn type="integer">1</cn>
          <apply>
           <times></times>
           <cn type="integer">4</cn>
           <ci>r</ci>
          </apply>
         </apply>
        </apply>
       </apply>
      </apply>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \det R\leq(n-3)^{(n-s)/2}(n-3+4r)^{u/2}(n+1+4r)^{v/2}\left[1-\frac{ur}{n-3+4r}%
-\frac{v(r+1)}{n+1+4r}\right]^{1/2},
  </annotation>
 </semantics>
</math>

 where <em>v</em> = <em>n</em>−<em>rs</em> is the number of blocks of size <em>r</em>+1 and <em>u</em> =<em>s</em>−<em>v</em> is the number of blocks of size <em>r</em>. Cohn<a class="footnoteRef" href="#fn8" id="fnref8"><sup>8</sup></a> analyzed the bound and determined that, apart from <em>n</em> = 3, it is an integer only for <em>n</em> = 112<em>t</em><sup>2</sup>±28<em>t</em>+7 for some positive integer <em>t</em>. Tamura<a class="footnoteRef" href="#fn9" id="fnref9"><sup>9</sup></a> derived additional restrictions on the attainability of the bound using the <a href="Hasse-Minkowski_theorem" title="wikilink">Hasse-Minkowski theorem</a> on the rational equivalence of quadratic forms, and showed that the smallest <em>n</em> &gt; 3 for which Ehlich's bound is conceivably attainable is 511.</p>
<h2 id="maximal-determinants-up-to-size-21">Maximal determinants up to size 21</h2>

<p>The maximal determinants of {1, −1} matrices up to size <em>n</em> = 21 are given in the following table.<a class="footnoteRef" href="#fn10" id="fnref10"><sup>10</sup></a> Size 22 is the smallest open case. In the table, <em>D</em>(<em>n</em>) represents the maximal determinant divided by 2<sup><em>n</em>−1</sup>. Equivalently, <em>D</em>(<em>n</em>) represents the maximal determinant of a {0, 1} matrix of size <em>n</em>−1.</p>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">
<p><em>n</em></p></th>
<th style="text-align: left;">
<p><em>D</em>(<em>n</em>)</p></th>
<th style="text-align: left;">
<p>Notes</p></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">
<p>1</p></td>
<td style="text-align: left;">
<p>1</p></td>
<td style="text-align: left;">
<p>Hadamard matrix</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>2</p></td>
<td style="text-align: left;">
<p>1</p></td>
<td style="text-align: left;">
<p>Hadamard matrix</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>3</p></td>
<td style="text-align: left;">
<p>1</p></td>
<td style="text-align: left;">
<p>Attains Ehlich bound</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>4</p></td>
<td style="text-align: left;">
<p>2</p></td>
<td style="text-align: left;">
<p>Hadamard matrix</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>5</p></td>
<td style="text-align: left;">
<p>3</p></td>
<td style="text-align: left;">
<p>Attains Barba bound; circulant matrix</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>6</p></td>
<td style="text-align: left;">
<p>5</p></td>
<td style="text-align: left;">
<p>Attains Ehlich–Wojtas bound</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>7</p></td>
<td style="text-align: left;">
<p>9</p></td>
<td style="text-align: left;">
<p>98.20% of Ehlich bound</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>8</p></td>
<td style="text-align: left;">
<p>32</p></td>
<td style="text-align: left;">
<p>Hadamard matrix</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>9</p></td>
<td style="text-align: left;">
<p>56</p></td>
<td style="text-align: left;">
<p>84.89% of Barba bound</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>10</p></td>
<td style="text-align: left;">
<p>144</p></td>
<td style="text-align: left;">
<p>Attains Ehlich–Wojtas bound</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>11</p></td>
<td style="text-align: left;">
<p>320</p></td>
<td style="text-align: left;">
<p>94.49% of Ehlich bound; three non-equivalent matrices</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>12</p></td>
<td style="text-align: left;">
<p>1458</p></td>
<td style="text-align: left;">
<p>Hadamard matrix</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>13</p></td>
<td style="text-align: left;">
<p>3645</p></td>
<td style="text-align: left;">
<p>Attains Barba bound; maximal-determinant matrix is {1,−1} incidence matrix of <a href="projective_plane" title="wikilink">projective plane</a> of order 3</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>14</p></td>
<td style="text-align: left;">
<p>9477</p></td>
<td style="text-align: left;">
<p>Attains Ehlich–Wojtas bound</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>15</p></td>
<td style="text-align: left;">
<p>25515</p></td>
<td style="text-align: left;">
<p>97.07% of Ehlich bound</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>16</p></td>
<td style="text-align: left;">
<p>131072</p></td>
<td style="text-align: left;">
<p>Hadamard matrix; five non-equivalent matrices</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>17</p></td>
<td style="text-align: left;">
<p>327680</p></td>
<td style="text-align: left;">
<p>87.04% of Barba bound; three non-equivalent matrices</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>18</p></td>
<td style="text-align: left;">
<p>1114112</p></td>
<td style="text-align: left;">
<p>Attains Ehlich–Wojtas bound; three non-equivalent matrices</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>19</p></td>
<td style="text-align: left;">
<p>3411968</p></td>
<td style="text-align: left;">
<p>Attains 97.50% of Ehlich bound; three non-equivalent matrices</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>20</p></td>
<td style="text-align: left;">
<p>19531250</p></td>
<td style="text-align: left;">
<p>Hadamard matrix; three non-equivalent matrices</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>21</p></td>
<td style="text-align: left;">
<p>56640625</p></td>
<td style="text-align: left;">
<p>90.58% of Barba bound; seven non-equivalent matrices</p></td>
</tr>
<tr class="even">
</tr>
</tbody>
</table>
<h2 id="references">References</h2>

<p>"</p>

<p><a href="Category:Design_theory" title="wikilink">Category:Design theory</a> <a class="uri" href="Category:Matrices" title="wikilink">Category:Matrices</a> <a href="Category:Unsolved_problems_in_mathematics" title="wikilink">Category:Unsolved problems in mathematics</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1"><a href="#fnref1">↩</a></li>
<li id="fn2"><a href="#fnref2">↩</a></li>
<li id="fn3"><a href="#fnref3">↩</a></li>
<li id="fn4">.<a href="#fnref4">↩</a></li>
<li id="fn5">.<a href="#fnref5">↩</a></li>
<li id="fn6">.<a href="#fnref6">↩</a></li>
<li id="fn7">.<a href="#fnref7">↩</a></li>
<li id="fn8">.<a href="#fnref8">↩</a></li>
<li id="fn9">.<a href="#fnref9">↩</a></li>
<li id="fn10"><a href="#fnref10">↩</a></li>
</ol>
</section>
</body>
</html>

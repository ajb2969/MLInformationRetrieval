<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="1703">Hybrid theory for photon transport in tissue</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Hybrid theory for photon transport in tissue</h1>
<hr/>

<p><strong>Hybrid Theory</strong> for photon transport in tissue uses the advantages and eliminates the deficiencies of both the <strong>Monte Carlo</strong> method and the <strong>Diffusion Theory</strong> for photon transport to model photons traveling through tissue both accurately and efficiently.</p>
<h2 id="mcml-monte-carlo-modeling-of-light-transportation-in-multi-layered-medium">MCML (Monte Carlo Modeling of Light Transportation in Multi-Layered Medium)</h2>

<p>The <a href="Monte_Carlo_method_for_photon_transport" title="wikilink">MCML</a> is a numerical way to simulate photon transport in biological tissue. Each photon packet follows a random walk with persistence, where the direction of each step dependent on the direction of the previous step. By averaging multiple independent random walks, MCML estimates the ensemble-averaged quantities such as reflectance, transmittance, absorption, and fluence.</p>

<p>Briefly, a packet of photon is first launched into the biological tissue. The parameters of photon transport, including the step size and deflection angle due to scattering, are determined by random sampling from probability distributions. A fraction of weight, determined by the scattering and absorption coefficients is deposited at the interaction site. The photon packet continues propagating until the weight left is smaller than a certain threshold. If this packet of photon hits the boundary during the propagation, it is either reflected or transmitted, determined by a pseudorandom number. Statistically sufficient numbers of photon packets must be simulated to obtain the expected values accurately.<a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a></p>

<p><strong>Advantages and Disadvantages</strong></p>

<p>This <a href="Monte_Carlo_method" title="wikilink">Monte Carlo method</a> is rigorous and flexible. However, because of its statistical nature, this method requires tracking a large number of photon packets, making it computationally expensive.</p>
<h2 id="diffusion-theory">Diffusion Theory</h2>

<p>The <a href="Radiative_transfer_equation_and_diffusion_theory_for_photon_transport_in_biological_tissue" title="wikilink">Diffusion Theory</a> is an approximation of the radiative transfer equation (RTE), and an analytical way to simulate photon transport. As such, it has the ability to model photon propagation through tissue quickly.</p>

<p>As an example, one way to attain a solution for a pencil beam that is vertically incident on a semi-infinite homogeneous scattering medium is by taking three approximation steps as follows:</p>
<ul>
<li>The anisotropically scattering medium is converted to an isotropically scattering medium. That is, the scattering coefficient is scaled by 

<math display="inline" id="Hybrid_theory_for_photon_transport_in_tissue:0">
 <semantics>
  <mrow>
   <mn>1</mn>
   <mo>-</mo>
   <mi>g</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <minus></minus>
    <cn type="integer">1</cn>
    <ci>g</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   1-g
  </annotation>
 </semantics>
</math>

, where 

<math display="inline" id="Hybrid_theory_for_photon_transport_in_tissue:1">
 <semantics>
  <mi>g</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>g</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   g
  </annotation>
 </semantics>
</math>

 is the anisotropy. The anisotropy 

<math display="inline" id="Hybrid_theory_for_photon_transport_in_tissue:2">
 <semantics>
  <mi>g</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>g</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   g
  </annotation>
 </semantics>
</math>

 is then set to zero;</li>
<li>The unit-power pencil beam is converted into an equivalent isotropic point source at a depth that is equal to the transport mean free path, with a power equal to the transport albedo;</li>
<li>The boundary effect of the scattering medium is removed by adding an image source to satisfy the boundary condition.<a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a></li>
</ul>

<p><strong>Advantages and Disadvantages</strong></p>

<p>Diffusion Theory is more computationally efficient than MCML. However, it is also less accurate than MCML near the source and boundaries.</p>
<h2 id="hybrid-theory">Hybrid Theory</h2>

<p>The Hybrid Theory combines the Diffusion Theory and the Monte Carlo method in order to increase accuracy near the source and boundaries while reducing computation time. In the previous example for the Diffusion Theory, a semi-infinite scattering medium with only one boundary was assumed. If the geometry is a slab, the second boundary must be taken into account. The fluence rate at the extrapolated boundaries must be approximately 0. Using an array of image sources fulfills this boundary condition. The extrapolated boundary is located at distance 

<math display="inline" id="Hybrid_theory_for_photon_transport_in_tissue:3">
 <semantics>
  <mrow>
   <msub>
    <mi>z</mi>
    <mi>b</mi>
   </msub>
   <mo>=</mo>
   <mrow>
    <mn>2</mn>
    <msub>
     <mi>C</mi>
     <mi>R</mi>
    </msub>
    <mi>D</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>z</ci>
     <ci>b</ci>
    </apply>
    <apply>
     <times></times>
     <cn type="integer">2</cn>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>C</ci>
      <ci>R</ci>
     </apply>
     <ci>D</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   z_{b}=2C_{R}D
  </annotation>
 </semantics>
</math>

. The 

<math display="inline" id="Hybrid_theory_for_photon_transport_in_tissue:4">
 <semantics>
  <mi>z</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>z</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   z
  </annotation>
 </semantics>
</math>

 coordinates for the source pairs are 

<math display="inline" id="Hybrid_theory_for_photon_transport_in_tissue:5">
 <semantics>
  <mrow>
   <msub>
    <mi>z</mi>
    <mrow>
     <mo>±</mo>
     <mi>i</mi>
    </mrow>
   </msub>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mrow>
      <mo>-</mo>
      <msub>
       <mi>z</mi>
       <mi>b</mi>
      </msub>
     </mrow>
     <mo>+</mo>
     <mrow>
      <mn>2</mn>
      <mi>i</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mi>d</mi>
        <mo>+</mo>
        <mrow>
         <mn>2</mn>
         <msub>
          <mi>z</mi>
          <mi>b</mi>
         </msub>
        </mrow>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mrow>
    <mo>±</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <msup>
       <mi>z</mi>
       <mo>′</mo>
      </msup>
      <mo>+</mo>
      <msub>
       <mi>z</mi>
       <mi>b</mi>
      </msub>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>z</ci>
     <apply>
      <csymbol cd="latexml">plus-or-minus</csymbol>
      <ci>i</ci>
     </apply>
    </apply>
    <apply>
     <csymbol cd="latexml">plus-or-minus</csymbol>
     <apply>
      <plus></plus>
      <apply>
       <minus></minus>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>z</ci>
        <ci>b</ci>
       </apply>
      </apply>
      <apply>
       <times></times>
       <cn type="integer">2</cn>
       <ci>i</ci>
       <apply>
        <plus></plus>
        <ci>d</ci>
        <apply>
         <times></times>
         <cn type="integer">2</cn>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>z</ci>
          <ci>b</ci>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <plus></plus>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>z</ci>
       <ci>normal-′</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>z</ci>
       <ci>b</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   z_{\pm i}=-z_{b}+2i(d+2z_{b})\pm(z^{\prime}+z_{b})
  </annotation>
 </semantics>
</math>

 where 

<math display="inline" id="Hybrid_theory_for_photon_transport_in_tissue:6">
 <semantics>
  <msup>
   <mi>z</mi>
   <msup>
    <mi></mi>
    <mo>′</mo>
   </msup>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>z</ci>
    <apply>
     <ci>normal-′</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   z^{^{\prime}}
  </annotation>
 </semantics>
</math>

 is the 

<math display="inline" id="Hybrid_theory_for_photon_transport_in_tissue:7">
 <semantics>
  <mi>z</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>z</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   z
  </annotation>
 </semantics>
</math>

 coordinate for the point source and 

<math display="inline" id="Hybrid_theory_for_photon_transport_in_tissue:8">
 <semantics>
  <mi>d</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>d</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   d
  </annotation>
 </semantics>
</math>

 is the slab thickness. Only 2-3 pairs are usually necessary to achieve good accuracy.</p>
<figure><b>(Figure)</b>
<figcaption>400 px|right|Figure 1: Slab geometry and Source pairs for Hybrid Theory</figcaption>
</figure>

<p>A Monte Carlo approach can be used to make up for the Diffusion Theory's inherently poor accuracy near the boundaries. As mentioned before, the Monte Carlo simulation is time consuming. When a photon packet is within a critical depth 

<math display="inline" id="Hybrid_theory_for_photon_transport_in_tissue:9">
 <semantics>
  <msub>
   <mi>z</mi>
   <mi>c</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>z</ci>
    <ci>c</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   z_{c}
  </annotation>
 </semantics>
</math>

 the Monte Carlo simulation tracks all packets but within the center region the photon packet is transformed to an isotropic source and subsequently treated with Diffusion Theory. Just like in the Monte Carlo simulation, any photon packet that gets reemitted is added to the diffuse reflectance 

<math display="inline" id="Hybrid_theory_for_photon_transport_in_tissue:10">
 <semantics>
  <msub>
   <mi>R</mi>
   <mrow>
    <mi>M</mi>
    <mi>C</mi>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>R</ci>
    <apply>
     <times></times>
     <ci>M</ci>
     <ci>C</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   R_{MC}
  </annotation>
 </semantics>
</math>

.</p>

<p>When a photon packet is scattered into the center zone 

<math display="inline" id="Hybrid_theory_for_photon_transport_in_tissue:11">
 <semantics>
  <mrow>
   <msub>
    <mi>z</mi>
    <mi>c</mi>
   </msub>
   <mo>≤</mo>
   <mi>z</mi>
   <mo>≤</mo>
   <mrow>
    <mo>-</mo>
    <msub>
     <mi>z</mi>
     <mi>c</mi>
    </msub>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <leq></leq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>z</ci>
      <ci>c</ci>
     </apply>
     <ci>z</ci>
    </apply>
    <apply>
     <leq></leq>
     <share href="#.cmml">
     </share>
     <apply>
      <minus></minus>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>z</ci>
       <ci>c</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   z_{c}\leq z\leq-z_{c}
  </annotation>
 </semantics>
</math>

, it is conditionally converted to an isotropic point source. The photon packet must still be in the center region after one transport mean free path 

<math display="inline" id="Hybrid_theory_for_photon_transport_in_tissue:12">
 <semantics>
  <msubsup>
   <mi>l</mi>
   <mi>t</mi>
   <mo>′</mo>
  </msubsup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>l</ci>
     <ci>t</ci>
    </apply>
    <ci>normal-′</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   l_{t}^{\prime}
  </annotation>
 </semantics>
</math>

 along the direction of the photon packet propagation for it to be converted to a point source, otherwise the Monte Carlo simulation continues. Before the conversion to an isotropic point source, the photon packet reduces its weight due to its interaction with the scattering medium. The resulting weight is recorded as a source function 

<math display="inline" id="Hybrid_theory_for_photon_transport_in_tissue:13">
 <semantics>
  <mrow>
   <mi>S</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>r</mi>
    <mo>,</mo>
    <mi>z</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>S</ci>
    <interval closure="open">
     <ci>r</ci>
     <ci>z</ci>
    </interval>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   S(r,z)
  </annotation>
 </semantics>
</math>

. This is the accumulated weight distribution which can be converted to relative source density function 

<math display="inline" id="Hybrid_theory_for_photon_transport_in_tissue:14">
 <semantics>
  <msub>
   <mi>S</mi>
   <mi>d</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>S</ci>
    <ci>d</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   S_{d}
  </annotation>
 </semantics>
</math>

 by:</p>

<p>

<math display="block" id="Hybrid_theory_for_photon_transport_in_tissue:15">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>S</mi>
     <mi>d</mi>
    </msub>
    <mrow>
     <mo stretchy="false">[</mo>
     <msub>
      <mi>i</mi>
      <mi>r</mi>
     </msub>
     <mo>,</mo>
     <msub>
      <mi>i</mi>
      <mi>z</mi>
     </msub>
     <mo stretchy="false">]</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mfrac>
    <mrow>
     <mi>S</mi>
     <mrow>
      <mo stretchy="false">[</mo>
      <msub>
       <mi>i</mi>
       <mi>r</mi>
      </msub>
      <mo>,</mo>
      <msub>
       <mi>i</mi>
       <mi>z</mi>
      </msub>
      <mo stretchy="false">]</mo>
     </mrow>
    </mrow>
    <mrow>
     <mi>N</mi>
     <mi mathvariant="normal">Δ</mi>
     <mi>V</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <msub>
       <mi>i</mi>
       <mi>r</mi>
      </msub>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mfrac>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>S</ci>
      <ci>d</ci>
     </apply>
     <interval closure="closed">
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>i</ci>
       <ci>r</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>i</ci>
       <ci>z</ci>
      </apply>
     </interval>
    </apply>
    <apply>
     <divide></divide>
     <apply>
      <times></times>
      <ci>S</ci>
      <interval closure="closed">
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>i</ci>
        <ci>r</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>i</ci>
        <ci>z</ci>
       </apply>
      </interval>
     </apply>
     <apply>
      <times></times>
      <ci>N</ci>
      <ci>normal-Δ</ci>
      <ci>V</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>i</ci>
       <ci>r</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   S_{d}[i_{r},i_{z}]=\frac{S[i_{r},i_{z}]}{N\Delta V(i_{r})}
  </annotation>
 </semantics>
</math>

 where 

<math display="inline" id="Hybrid_theory_for_photon_transport_in_tissue:16">
 <semantics>
  <mrow>
   <mi mathvariant="normal">Δ</mi>
   <mi>V</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>normal-Δ</ci>
    <ci>V</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Delta V
  </annotation>
 </semantics>
</math>

 is the grid volume and 

<math display="inline" id="Hybrid_theory_for_photon_transport_in_tissue:17">
 <semantics>
  <mi>N</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>N</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   N
  </annotation>
 </semantics>
</math>

 is the number of photon packets.</p>

<p>The additional diffuse reflectance 

<math display="inline" id="Hybrid_theory_for_photon_transport_in_tissue:18">
 <semantics>
  <msub>
   <mi>R</mi>
   <mrow>
    <mi>D</mi>
    <mi>T</mi>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>R</ci>
    <apply>
     <times></times>
     <ci>D</ci>
     <ci>T</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   R_{DT}
  </annotation>
 </semantics>
</math>

 from the sources is calculated as:</p>

<p>

<math display="block" id="Hybrid_theory_for_photon_transport_in_tissue:19">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>R</mi>
     <mrow>
      <mi>D</mi>
      <mi>T</mi>
     </mrow>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>r</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <msubsup>
     <mo largeop="true" symmetric="true">∫</mo>
     <mn>0</mn>
     <mi mathvariant="normal">∞</mi>
    </msubsup>
    <mrow>
     <msubsup>
      <mo largeop="true" symmetric="true">∫</mo>
      <mn>0</mn>
      <mi mathvariant="normal">∞</mi>
     </msubsup>
     <mrow>
      <msubsup>
       <mo largeop="true" symmetric="true">∫</mo>
       <mn>0</mn>
       <mrow>
        <mn>2</mn>
        <mi>π</mi>
       </mrow>
      </msubsup>
      <mrow>
       <msub>
        <mi>S</mi>
        <mi>d</mi>
       </msub>
       <mrow>
        <mo stretchy="false">(</mo>
        <msup>
         <mi>r</mi>
         <mo>′</mo>
        </msup>
        <mo>,</mo>
        <msup>
         <mi>z</mi>
         <mo>′</mo>
        </msup>
        <mo stretchy="false">)</mo>
       </mrow>
       <mi>R</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>r</mi>
        <mo>,</mo>
        <mn>0</mn>
        <mo>,</mo>
        <mn>0</mn>
        <mo>;</mo>
        <msup>
         <mi>r</mi>
         <mo>′</mo>
        </msup>
        <mo>,</mo>
        <msup>
         <mi>ϕ</mi>
         <mo>′</mo>
        </msup>
        <mo>,</mo>
        <msup>
         <mi>z</mi>
         <mo>′</mo>
        </msup>
        <mo stretchy="false">)</mo>
       </mrow>
       <msup>
        <mi>r</mi>
        <mo>′</mo>
       </msup>
       <mi>d</mi>
       <msup>
        <mi>ϕ</mi>
        <mo>′</mo>
       </msup>
       <mi>d</mi>
       <msup>
        <mi>r</mi>
        <mo>′</mo>
       </msup>
       <mi>d</mi>
       <msup>
        <mi>z</mi>
        <mo>′</mo>
       </msup>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>R</ci>
      <apply>
       <times></times>
       <ci>D</ci>
       <ci>T</ci>
      </apply>
     </apply>
     <ci>r</ci>
    </apply>
    <apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <int></int>
       <cn type="integer">0</cn>
      </apply>
      <infinity></infinity>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <int></int>
        <cn type="integer">0</cn>
       </apply>
       <infinity></infinity>
      </apply>
      <apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <int></int>
         <cn type="integer">0</cn>
        </apply>
        <apply>
         <times></times>
         <cn type="integer">2</cn>
         <ci>π</ci>
        </apply>
       </apply>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>S</ci>
         <ci>d</ci>
        </apply>
        <interval closure="open">
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>r</ci>
          <ci>normal-′</ci>
         </apply>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>z</ci>
          <ci>normal-′</ci>
         </apply>
        </interval>
        <ci>R</ci>
        <vector>
         <ci>r</ci>
         <cn type="integer">0</cn>
         <cn type="integer">0</cn>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>r</ci>
          <ci>normal-′</ci>
         </apply>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>ϕ</ci>
          <ci>normal-′</ci>
         </apply>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>z</ci>
          <ci>normal-′</ci>
         </apply>
        </vector>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>r</ci>
         <ci>normal-′</ci>
        </apply>
        <ci>d</ci>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>ϕ</ci>
         <ci>normal-′</ci>
        </apply>
        <ci>d</ci>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>r</ci>
         <ci>normal-′</ci>
        </apply>
        <ci>d</ci>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>z</ci>
         <ci>normal-′</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   R_{DT}(r)=\int_{0}^{\infty}\int_{0}^{\infty}\int_{0}^{2\pi}S_{d}(r^{\prime},z^%
{\prime})R(r,0,0;r^{\prime},\phi^{\prime},z^{\prime})r^{\prime}d\phi^{\prime}%
dr^{\prime}dz^{\prime}
  </annotation>
 </semantics>
</math>

 where 

<math display="inline" id="Hybrid_theory_for_photon_transport_in_tissue:20">
 <semantics>
  <mi>R</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>R</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   R
  </annotation>
 </semantics>
</math>

 is from the diffusion theory approximation for a slab and 

<math display="inline" id="Hybrid_theory_for_photon_transport_in_tissue:21">
 <semantics>
  <mi>ϕ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>ϕ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \phi
  </annotation>
 </semantics>
</math>

 is the azimuthal angle. The total diffuse reflectance would be 

<math display="inline" id="Hybrid_theory_for_photon_transport_in_tissue:22">
 <semantics>
  <msub>
   <mi>R</mi>
   <mrow>
    <mi>D</mi>
    <mi>T</mi>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>R</ci>
    <apply>
     <times></times>
     <ci>D</ci>
     <ci>T</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   R_{DT}
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Hybrid_theory_for_photon_transport_in_tissue:23">
 <semantics>
  <msub>
   <mi>R</mi>
   <mrow>
    <mi>M</mi>
    <mi>C</mi>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>R</ci>
    <apply>
     <times></times>
     <ci>M</ci>
     <ci>C</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   R_{MC}
  </annotation>
 </semantics>
</math>

 added together.<a class="footnoteRef" href="#fn3" id="fnref3"><sup>3</sup></a></p>
<h3 id="advantages-over-diffusion-theory-and-mcml">Advantages over Diffusion Theory and MCML</h3>

<p>A trade-off between simulation speed and accuracy exists; choosing a critical depth 

<math display="inline" id="Hybrid_theory_for_photon_transport_in_tissue:24">
 <semantics>
  <msub>
   <mi>z</mi>
   <mi>c</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>z</ci>
    <ci>c</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   z_{c}
  </annotation>
 </semantics>
</math>

 becomes the deciding factor for simulation speed with a deeper critical depth resulting in slower times due to packets needing to be tracked for a longer distance before the transition to diffusion theory.<a class="footnoteRef" href="#fn4" id="fnref4"><sup>4</sup></a></p>

<p>Advantages</p>
<ul>
<li>More accurate than the Diffusion Theory, especially near the source</li>
<li>Faster than the Monte Carlo method</li>
</ul>
<table>
<tbody>
<tr class="odd">
<td style="text-align: left;">
<p>User times for Monte Carlo (MC) method and Hybrid model (H) using IBM ThinkPad T43 with 1.86 GHz processor and 1.5 GB RAM</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>

<math display="inline" id="Hybrid_theory_for_photon_transport_in_tissue:25">
 <semantics>
  <msub>
   <mi>n</mi>
   <mrow>
    <mi>r</mi>
    <mi>e</mi>
    <mi>l</mi>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>n</ci>
    <apply>
     <times></times>
     <ci>r</ci>
     <ci>e</ci>
     <ci>l</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n_{rel}
  </annotation>
 </semantics>
</math>

</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>1.37</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>1.37</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>1.37</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>1.37</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>1.37</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>1.37</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>1</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>1</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>1</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>1</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>1</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>1</p></td>
</tr>
</tbody>
</table>
<center>

<p>Where 

<math display="inline" id="Hybrid_theory_for_photon_transport_in_tissue:26">
 <semantics>
  <msub>
   <mi>n</mi>
   <mrow>
    <mi>r</mi>
    <mi>e</mi>
    <mi>l</mi>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>n</ci>
    <apply>
     <times></times>
     <ci>r</ci>
     <ci>e</ci>
     <ci>l</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n_{rel}
  </annotation>
 </semantics>
</math>

 is the relative refraction coefficient, 

<math display="inline" id="Hybrid_theory_for_photon_transport_in_tissue:27">
 <semantics>
  <mi>d</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>d</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   d
  </annotation>
 </semantics>
</math>

 is the slab thickness, 

<math display="inline" id="Hybrid_theory_for_photon_transport_in_tissue:28">
 <semantics>
  <msub>
   <mi>μ</mi>
   <mi>a</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>μ</ci>
    <ci>a</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mu_{a}
  </annotation>
 </semantics>
</math>

 is the absorption coefficient, and 

<math display="inline" id="Hybrid_theory_for_photon_transport_in_tissue:29">
 <semantics>
  <mi>T</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>T</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   T
  </annotation>
 </semantics>
</math>

 is the user time.</p>
</center>
<h3 id="comparisons-between-theories">Comparisons Between Theories</h3>

<p>Image:Hb11.jpg|Comparisons between the Diffusion Theory and the Monte Carlo method in terms of the fluence in response to an isotropic point source. Image:Hb22.jpg|Relative errors between the Diffusion Theory and the Monte Carlo method.</p>

<p>Image:Hb33.JPG|Comparisons between the pure Monte Carlo method and the Hybrid Model in terms of the diffuse reflectance in response to a pencil beam. Image:Hb4.JPG|Relative errors between the pure Monte Carlo method and the Hybrid Model.</p>

<p>Image:Hb55.jpg|Diffuse reflectance of the Hybrid Model in response to a pencil beam when the critical depth is set to 0.01 cm, 0.03 cm, 0.05 cm and 0.1 cm. Image:Hb7.JPG|Relative errors with different critical depths for the Hybrid Model.</p>

<p>Image:Hb7.jpg|Comparisons between the Monte Carlo method and the Hybrid Model in terms of diffuse reflectance in response to a pencil beam when the critical depth is set to 0.1 cm. The absorption coefficient 

<math display="inline" id="Hybrid_theory_for_photon_transport_in_tissue:30">
 <semantics>
  <msub>
   <mi>μ</mi>
   <mi>a</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>μ</ci>
    <ci>a</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mu_{a}
  </annotation>
 </semantics>
</math>

 varies among 0.1, 1, and 10 

<math display="inline" id="Hybrid_theory_for_photon_transport_in_tissue:31">
 <semantics>
  <mrow>
   <mi>c</mi>
   <msup>
    <mi>m</mi>
    <mrow>
     <mo>-</mo>
     <mn>1</mn>
    </mrow>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>c</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>m</ci>
     <apply>
      <minus></minus>
      <cn type="integer">1</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   cm^{-1}
  </annotation>
 </semantics>
</math>

.</p>
<h2 id="references">References</h2>

<p>"</p>

<p><a href="Category:Scientific_simulation_software" title="wikilink">Category:Scientific simulation software</a> <a href="Category:Optical_software" title="wikilink">Category:Optical software</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1"><a href="#fnref1">↩</a></li>
<li id="fn2"></li>
<li id="fn3"></li>
<li id="fn4"><a href="#fnref4">↩</a></li>
</ol>
</section>
</body>
</html>

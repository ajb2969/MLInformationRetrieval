<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="844">Pell's equation</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Pell's equation</h1>
<hr/>

<p> <strong>Pell's equation</strong> (also called the <strong>Pell–Fermat equation</strong>) is any <a href="Diophantine_equation" title="wikilink">Diophantine equation</a> of the form</p>

<p>

<math display="block" id="Pell's_equation:0">
 <semantics>
  <mrow>
   <mrow>
    <msup>
     <mi>x</mi>
     <mn>2</mn>
    </msup>
    <mo>-</mo>
    <mrow>
     <mi>n</mi>
     <msup>
      <mi>y</mi>
      <mn>2</mn>
     </msup>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mpadded width="+1.7pt">
    <mn>1</mn>
   </mpadded>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <minus></minus>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>x</ci>
      <cn type="integer">2</cn>
     </apply>
     <apply>
      <times></times>
      <ci>n</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>y</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x^{2}-ny^{2}=1\,
  </annotation>
 </semantics>
</math>

</p>

<p>where <em>n</em> is a given positive <a href="Square_number" title="wikilink">nonsquare</a> <a class="uri" href="integer" title="wikilink">integer</a> and integer solutions are sought for <em>x</em> and <em>y</em>. In <a href="Cartesian_coordinates" title="wikilink">Cartesian coordinates</a>, the equation has the form of a <a class="uri" href="hyperbola" title="wikilink">hyperbola</a>; solutions occur wherever the curve passes through a point whose <em>x</em> and <em>y</em> coordinates are both integers, such as the <a href="Triviality_(mathematics)" title="wikilink">trivial solution</a> with <em>x</em> = 1 and <em>y</em> = 0. <a href="Joseph_Louis_Lagrange" title="wikilink">Joseph Louis Lagrange</a> proved that, as long as <em>n</em> is not a <a href="square_number" title="wikilink">perfect square</a>, Pell's equation has infinitely many distinct integer solutions. These solutions may be used to accurately <a href="Diophantine_approximation" title="wikilink">approximate</a> the <a href="square_root" title="wikilink">square root</a> of <em>n</em> by <a href="rational_number" title="wikilink">rational numbers</a> of the form <em>x/y</em>.</p>

<p>This equation was first studied extensively <a href="Indian_mathematics" title="wikilink">in India</a>, starting with <a class="uri" href="Brahmagupta" title="wikilink">Brahmagupta</a>, who developed the <a href="chakravala_method" title="wikilink"><em>chakravala</em> method</a> to solve Pell's equation and other quadratic indeterminate equations in his <a href="Brahmasphutasiddhanta" title="wikilink"><em>Brahma Sphuta Siddhanta</em></a> in 628, about a thousand years before Pell's time. His <em>Brahma Sphuta Siddhanta</em> was translated into <a class="uri" href="Arabic" title="wikilink">Arabic</a> in 773 and was subsequently translated into <a class="uri" href="Latin" title="wikilink">Latin</a> in 1126. <a href="Bhaskara_II" title="wikilink">Bhaskara II</a> in the 12th century and <a href="Narayana_Pandit" title="wikilink">Narayana Pandit</a> in the 14th century both found general solutions to Pell's equation and other quadratic indeterminate equations. Solutions to specific examples of the Pell equation, such as the <a href="Pell_number" title="wikilink">Pell numbers</a> arising from the equation with <em>n</em> = 2, had been known for much longer, since the time of <a class="uri" href="Pythagoras" title="wikilink">Pythagoras</a> in <a href="Greek_mathematics" title="wikilink">Greece</a> and to a similar date in India. The name of Pell's equation arose from <a href="Leonhard_Euler" title="wikilink">Leonhard Euler</a>'s mistakenly attributing <a href="Lord_Brouncker" title="wikilink">Lord Brouncker</a>'s solution of the equation to <a href="John_Pell" title="wikilink">John Pell</a>.<a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a></p>

<p>For a more detailed discussion of much of the material here, see Lenstra (2002) and Barbeau (2003).</p>
<h2 id="history">History</h2>

<p>As early as 400 BC in India and Greece, mathematicians studied the numbers arising from the <em>n</em> = 2 case of Pell's equation,</p>

<p>

<math display="block" id="Pell's_equation:1">
 <semantics>
  <mrow>
   <mrow>
    <msup>
     <mi>x</mi>
     <mn>2</mn>
    </msup>
    <mo>-</mo>
    <mrow>
     <mn>2</mn>
     <msup>
      <mi>y</mi>
      <mn>2</mn>
     </msup>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <minus></minus>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>x</ci>
      <cn type="integer">2</cn>
     </apply>
     <apply>
      <times></times>
      <cn type="integer">2</cn>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>y</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x^{2}-2y^{2}=1
  </annotation>
 </semantics>
</math>

 and from the closely related equation</p>

<p>

<math display="block" id="Pell's_equation:2">
 <semantics>
  <mrow>
   <mrow>
    <msup>
     <mi>x</mi>
     <mn>2</mn>
    </msup>
    <mo>-</mo>
    <mrow>
     <mn>2</mn>
     <msup>
      <mi>y</mi>
      <mn>2</mn>
     </msup>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mo>-</mo>
    <mn>1</mn>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <minus></minus>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>x</ci>
      <cn type="integer">2</cn>
     </apply>
     <apply>
      <times></times>
      <cn type="integer">2</cn>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>y</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
    <apply>
     <minus></minus>
     <cn type="integer">1</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x^{2}-2y^{2}=-1
  </annotation>
 </semantics>
</math>

</p>

<p>because of the connection of these equations to the square root of two.<a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a> Indeed, if <em>x</em> and <em>y</em> are positive integers satisfying this equation, then <em>x</em>/<em>y</em> is an approximation of √2. The numbers <em>x</em> and <em>y</em> appearing in these approximations, called <a href="Pell_number" title="wikilink">side and diameter numbers</a>, were known to the <a class="uri" href="Pythagoreans" title="wikilink">Pythagoreans</a>, and <a class="uri" href="Proclus" title="wikilink">Proclus</a> observed that in the opposite direction these numbers obeyed one of these two equations.<a class="footnoteRef" href="#fn3" id="fnref3"><sup>3</sup></a> Similarly, <a class="uri" href="Baudhayana" title="wikilink">Baudhayana</a> discovered that <em>x</em> = 17, <em>y</em> = 12 and <em>x</em> = 577, <em>y</em> = 408 are two solutions to the Pell equation, and that 17/12 and 577/408 are very close approximations to the square root of two.</p>

<p>Later, Archimedes approximated the square root of 3 by the rational number 1351/780. Although he did not explain his methods, this approximation may be obtained in the same way, as a solution to Pell's equation.<a class="footnoteRef" href="#fn4" id="fnref4"><sup>4</sup></a> <a href="Archimedes'_cattle_problem" title="wikilink">Archimedes' cattle problem</a> involves solving a Pellian equation, though it is unclear whether this problem is really due to Archimedes.</p>

<p>Around AD 250, <a class="uri" href="Diophantus" title="wikilink">Diophantus</a> considered the equation</p>

<p>

<math display="block" id="Pell's_equation:3">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mrow>
      <msup>
       <mi>a</mi>
       <mn>2</mn>
      </msup>
      <msup>
       <mi>x</mi>
       <mn>2</mn>
      </msup>
     </mrow>
     <mo>+</mo>
     <mi>c</mi>
    </mrow>
    <mo>=</mo>
    <msup>
     <mi>y</mi>
     <mn>2</mn>
    </msup>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>a</ci>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>x</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
     <ci>c</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>y</ci>
     <cn type="integer">2</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a^{2}x^{2}+c=y^{2},
  </annotation>
 </semantics>
</math>

 where <em>a</em> and <em>c</em> are fixed numbers and <em>x</em> and <em>y</em> are the variables to be solved for. This equation is different in form from Pell's equation but equivalent to it. Diophantus solved the equation for (<em>a</em>,<em>c</em>) equal to (1,1), (1,−1), (1,12), and (3,9). <a class="uri" href="Al-Karaji" title="wikilink">Al-Karaji</a>, a 10th-century Persian mathematician, worked on similar problems to Diophantus.</p>

<p>In Indian mathematics, <a class="uri" href="Brahmagupta" title="wikilink">Brahmagupta</a> discovered that</p>

<p>

<math display="block" id="Pell's_equation:4">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <msubsup>
       <mi>x</mi>
       <mn>1</mn>
       <mn>2</mn>
      </msubsup>
      <mo>-</mo>
      <mrow>
       <mi>N</mi>
       <msubsup>
        <mi>y</mi>
        <mn>1</mn>
        <mn>2</mn>
       </msubsup>
      </mrow>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <msubsup>
       <mi>x</mi>
       <mn>2</mn>
       <mn>2</mn>
      </msubsup>
      <mo>-</mo>
      <mrow>
       <mi>N</mi>
       <msubsup>
        <mi>y</mi>
        <mn>2</mn>
        <mn>2</mn>
       </msubsup>
      </mrow>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <msup>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mrow>
        <msub>
         <mi>x</mi>
         <mn>1</mn>
        </msub>
        <msub>
         <mi>x</mi>
         <mn>2</mn>
        </msub>
       </mrow>
       <mo>+</mo>
       <mrow>
        <mi>N</mi>
        <msub>
         <mi>y</mi>
         <mn>1</mn>
        </msub>
        <msub>
         <mi>y</mi>
         <mn>2</mn>
        </msub>
       </mrow>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <mn>2</mn>
    </msup>
    <mo>-</mo>
    <mrow>
     <mi>N</mi>
     <msup>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mrow>
         <msub>
          <mi>x</mi>
          <mn>1</mn>
         </msub>
         <msub>
          <mi>y</mi>
          <mn>2</mn>
         </msub>
        </mrow>
        <mo>+</mo>
        <mrow>
         <msub>
          <mi>x</mi>
          <mn>2</mn>
         </msub>
         <msub>
          <mi>y</mi>
          <mn>1</mn>
         </msub>
        </mrow>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
      <mn>2</mn>
     </msup>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <msup>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mrow>
        <msub>
         <mi>x</mi>
         <mn>1</mn>
        </msub>
        <msub>
         <mi>x</mi>
         <mn>2</mn>
        </msub>
       </mrow>
       <mo>-</mo>
       <mrow>
        <mi>N</mi>
        <msub>
         <mi>y</mi>
         <mn>1</mn>
        </msub>
        <msub>
         <mi>y</mi>
         <mn>2</mn>
        </msub>
       </mrow>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <mn>2</mn>
    </msup>
    <mo>-</mo>
    <mrow>
     <mi>N</mi>
     <msup>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mrow>
         <msub>
          <mi>x</mi>
          <mn>1</mn>
         </msub>
         <msub>
          <mi>y</mi>
          <mn>2</mn>
         </msub>
        </mrow>
        <mo>-</mo>
        <mrow>
         <msub>
          <mi>x</mi>
          <mn>2</mn>
         </msub>
         <msub>
          <mi>y</mi>
          <mn>1</mn>
         </msub>
        </mrow>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
      <mn>2</mn>
     </msup>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <times></times>
      <apply>
       <minus></minus>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>x</ci>
         <cn type="integer">1</cn>
        </apply>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <times></times>
        <ci>N</ci>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>y</ci>
          <cn type="integer">1</cn>
         </apply>
         <cn type="integer">2</cn>
        </apply>
       </apply>
      </apply>
      <apply>
       <minus></minus>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>x</ci>
         <cn type="integer">2</cn>
        </apply>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <times></times>
        <ci>N</ci>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>y</ci>
          <cn type="integer">2</cn>
         </apply>
         <cn type="integer">2</cn>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <minus></minus>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <plus></plus>
        <apply>
         <times></times>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>x</ci>
          <cn type="integer">1</cn>
         </apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>x</ci>
          <cn type="integer">2</cn>
         </apply>
        </apply>
        <apply>
         <times></times>
         <ci>N</ci>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>y</ci>
          <cn type="integer">1</cn>
         </apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>y</ci>
          <cn type="integer">2</cn>
         </apply>
        </apply>
       </apply>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <times></times>
       <ci>N</ci>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <plus></plus>
         <apply>
          <times></times>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>x</ci>
           <cn type="integer">1</cn>
          </apply>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>y</ci>
           <cn type="integer">2</cn>
          </apply>
         </apply>
         <apply>
          <times></times>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>x</ci>
           <cn type="integer">2</cn>
          </apply>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>y</ci>
           <cn type="integer">1</cn>
          </apply>
         </apply>
        </apply>
        <cn type="integer">2</cn>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <minus></minus>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <minus></minus>
        <apply>
         <times></times>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>x</ci>
          <cn type="integer">1</cn>
         </apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>x</ci>
          <cn type="integer">2</cn>
         </apply>
        </apply>
        <apply>
         <times></times>
         <ci>N</ci>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>y</ci>
          <cn type="integer">1</cn>
         </apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>y</ci>
          <cn type="integer">2</cn>
         </apply>
        </apply>
       </apply>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <times></times>
       <ci>N</ci>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <minus></minus>
         <apply>
          <times></times>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>x</ci>
           <cn type="integer">1</cn>
          </apply>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>y</ci>
           <cn type="integer">2</cn>
          </apply>
         </apply>
         <apply>
          <times></times>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>x</ci>
           <cn type="integer">2</cn>
          </apply>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>y</ci>
           <cn type="integer">1</cn>
          </apply>
         </apply>
        </apply>
        <cn type="integer">2</cn>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (x_{1}^{2}-Ny_{1}^{2})(x_{2}^{2}-Ny_{2}^{2})=(x_{1}x_{2}+Ny_{1}y_{2})^{2}-N(x_%
{1}y_{2}+x_{2}y_{1})^{2}=(x_{1}x_{2}-Ny_{1}y_{2})^{2}-N(x_{1}y_{2}-x_{2}y_{1})%
^{2}
  </annotation>
 </semantics>
</math>

 (see <a href="Brahmagupta's_identity" title="wikilink">Brahmagupta's identity</a>). Using this, he was able to "compose" triples 

<math display="inline" id="Pell's_equation:5">
 <semantics>
  <mrow>
   <mo stretchy="false">(</mo>
   <msub>
    <mi>x</mi>
    <mn>1</mn>
   </msub>
   <mo>,</mo>
   <msub>
    <mi>y</mi>
    <mn>1</mn>
   </msub>
   <mo>,</mo>
   <msub>
    <mi>k</mi>
    <mn>1</mn>
   </msub>
   <mo stretchy="false">)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <vector>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>x</ci>
     <cn type="integer">1</cn>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>y</ci>
     <cn type="integer">1</cn>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>k</ci>
     <cn type="integer">1</cn>
    </apply>
   </vector>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (x_{1},y_{1},k_{1})
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Pell's_equation:6">
 <semantics>
  <mrow>
   <mo stretchy="false">(</mo>
   <msub>
    <mi>x</mi>
    <mn>2</mn>
   </msub>
   <mo>,</mo>
   <msub>
    <mi>y</mi>
    <mn>2</mn>
   </msub>
   <mo>,</mo>
   <msub>
    <mi>k</mi>
    <mn>2</mn>
   </msub>
   <mo stretchy="false">)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <vector>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>x</ci>
     <cn type="integer">2</cn>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>y</ci>
     <cn type="integer">2</cn>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>k</ci>
     <cn type="integer">2</cn>
    </apply>
   </vector>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (x_{2},y_{2},k_{2})
  </annotation>
 </semantics>
</math>

 that were solutions of 

<math display="inline" id="Pell's_equation:7">
 <semantics>
  <mrow>
   <mrow>
    <msup>
     <mi>x</mi>
     <mn>2</mn>
    </msup>
    <mo>-</mo>
    <mrow>
     <mi>N</mi>
     <msup>
      <mi>y</mi>
      <mn>2</mn>
     </msup>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mi>k</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <minus></minus>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>x</ci>
      <cn type="integer">2</cn>
     </apply>
     <apply>
      <times></times>
      <ci>N</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>y</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
    <ci>k</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x^{2}-Ny^{2}=k
  </annotation>
 </semantics>
</math>

, to generate the new triple</p>

<p>

<math display="block" id="Pell's_equation:8">
 <semantics>
  <mrow>
   <mo stretchy="false">(</mo>
   <mrow>
    <mrow>
     <msub>
      <mi>x</mi>
      <mn>1</mn>
     </msub>
     <msub>
      <mi>x</mi>
      <mn>2</mn>
     </msub>
    </mrow>
    <mo>+</mo>
    <mrow>
     <mi>N</mi>
     <msub>
      <mi>y</mi>
      <mn>1</mn>
     </msub>
     <mpadded width="+1.7pt">
      <msub>
       <mi>y</mi>
       <mn>2</mn>
      </msub>
     </mpadded>
    </mrow>
   </mrow>
   <mo rspace="4.2pt">,</mo>
   <mrow>
    <mrow>
     <msub>
      <mi>x</mi>
      <mn>1</mn>
     </msub>
     <msub>
      <mi>y</mi>
      <mn>2</mn>
     </msub>
    </mrow>
    <mo>+</mo>
    <mrow>
     <msub>
      <mi>x</mi>
      <mn>2</mn>
     </msub>
     <mpadded width="+1.7pt">
      <msub>
       <mi>y</mi>
       <mn>1</mn>
      </msub>
     </mpadded>
    </mrow>
   </mrow>
   <mo rspace="4.2pt">,</mo>
   <mrow>
    <msub>
     <mi>k</mi>
     <mn>1</mn>
    </msub>
    <msub>
     <mi>k</mi>
     <mn>2</mn>
    </msub>
   </mrow>
   <mo stretchy="false">)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <vector>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <cn type="integer">1</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
     <apply>
      <times></times>
      <ci>N</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>y</ci>
       <cn type="integer">1</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>y</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <cn type="integer">1</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>y</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>y</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>k</ci>
      <cn type="integer">1</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>k</ci>
      <cn type="integer">2</cn>
     </apply>
    </apply>
   </vector>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (x_{1}x_{2}+Ny_{1}y_{2}\,,\,x_{1}y_{2}+x_{2}y_{1}\,,\,k_{1}k_{2})
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Pell's_equation:9">
 <semantics>
  <mrow>
   <mrow>
    <mo stretchy="false">(</mo>
    <mrow>
     <mrow>
      <msub>
       <mi>x</mi>
       <mn>1</mn>
      </msub>
      <msub>
       <mi>x</mi>
       <mn>2</mn>
      </msub>
     </mrow>
     <mo>-</mo>
     <mrow>
      <mi>N</mi>
      <msub>
       <mi>y</mi>
       <mn>1</mn>
      </msub>
      <mpadded width="+1.7pt">
       <msub>
        <mi>y</mi>
        <mn>2</mn>
       </msub>
      </mpadded>
     </mrow>
    </mrow>
    <mo rspace="4.2pt">,</mo>
    <mrow>
     <mrow>
      <msub>
       <mi>x</mi>
       <mn>1</mn>
      </msub>
      <msub>
       <mi>y</mi>
       <mn>2</mn>
      </msub>
     </mrow>
     <mo>-</mo>
     <mrow>
      <msub>
       <mi>x</mi>
       <mn>2</mn>
      </msub>
      <mpadded width="+1.7pt">
       <msub>
        <mi>y</mi>
        <mn>1</mn>
       </msub>
      </mpadded>
     </mrow>
    </mrow>
    <mo rspace="4.2pt">,</mo>
    <mrow>
     <msub>
      <mi>k</mi>
      <mn>1</mn>
     </msub>
     <msub>
      <mi>k</mi>
      <mn>2</mn>
     </msub>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <vector>
    <apply>
     <minus></minus>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <cn type="integer">1</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
     <apply>
      <times></times>
      <ci>N</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>y</ci>
       <cn type="integer">1</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>y</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
    <apply>
     <minus></minus>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <cn type="integer">1</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>y</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>y</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>k</ci>
      <cn type="integer">1</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>k</ci>
      <cn type="integer">2</cn>
     </apply>
    </apply>
   </vector>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (x_{1}x_{2}-Ny_{1}y_{2}\,,\,x_{1}y_{2}-x_{2}y_{1}\,,\,k_{1}k_{2}).
  </annotation>
 </semantics>
</math>


 Not only did this give a way to generate infinitely many solutions to 

<math display="inline" id="Pell's_equation:10">
 <semantics>
  <mrow>
   <mrow>
    <msup>
     <mi>x</mi>
     <mn>2</mn>
    </msup>
    <mo>-</mo>
    <mrow>
     <mi>N</mi>
     <msup>
      <mi>y</mi>
      <mn>2</mn>
     </msup>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <minus></minus>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>x</ci>
      <cn type="integer">2</cn>
     </apply>
     <apply>
      <times></times>
      <ci>N</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>y</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x^{2}-Ny^{2}=1
  </annotation>
 </semantics>
</math>

 starting with one solution, but also, by dividing such a composition by 

<math display="inline" id="Pell's_equation:11">
 <semantics>
  <mrow>
   <msub>
    <mi>k</mi>
    <mn>1</mn>
   </msub>
   <msub>
    <mi>k</mi>
    <mn>2</mn>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>k</ci>
     <cn type="integer">1</cn>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>k</ci>
     <cn type="integer">2</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   k_{1}k_{2}
  </annotation>
 </semantics>
</math>

, integer or "nearly integer" solutions could often be obtained. For instance, for 

<math display="inline" id="Pell's_equation:12">
 <semantics>
  <mrow>
   <mi>N</mi>
   <mo>=</mo>
   <mn>92</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>N</ci>
    <cn type="integer">92</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   N=92
  </annotation>
 </semantics>
</math>

, Brahmagupta composed the triple 

<math display="inline" id="Pell's_equation:13">
 <semantics>
  <mrow>
   <mo stretchy="false">(</mo>
   <mn>10</mn>
   <mo>,</mo>
   <mn>1</mn>
   <mo>,</mo>
   <mn>8</mn>
   <mo stretchy="false">)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <vector>
    <cn type="integer">10</cn>
    <cn type="integer">1</cn>
    <cn type="integer">8</cn>
   </vector>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (10,1,8)
  </annotation>
 </semantics>
</math>

 (since 

<math display="inline" id="Pell's_equation:14">
 <semantics>
  <mrow>
   <mrow>
    <msup>
     <mn>10</mn>
     <mn>2</mn>
    </msup>
    <mo>-</mo>
    <mrow>
     <mn>92</mn>
     <mrow>
      <mo stretchy="false">(</mo>
      <msup>
       <mn>1</mn>
       <mn>2</mn>
      </msup>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mn>8</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <minus></minus>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <cn type="integer">10</cn>
      <cn type="integer">2</cn>
     </apply>
     <apply>
      <times></times>
      <cn type="integer">92</cn>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <cn type="integer">1</cn>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
    <cn type="integer">8</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   10^{2}-92(1^{2})=8
  </annotation>
 </semantics>
</math>


) with itself to get the new triple 

<math display="inline" id="Pell's_equation:15">
 <semantics>
  <mrow>
   <mo stretchy="false">(</mo>
   <mn>192</mn>
   <mo>,</mo>
   <mn>20</mn>
   <mo>,</mo>
   <mn>64</mn>
   <mo stretchy="false">)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <vector>
    <cn type="integer">192</cn>
    <cn type="integer">20</cn>
    <cn type="integer">64</cn>
   </vector>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (192,20,64)
  </annotation>
 </semantics>
</math>

. Dividing throughout by 64 gave the triple 

<math display="inline" id="Pell's_equation:16">
 <semantics>
  <mrow>
   <mo stretchy="false">(</mo>
   <mn>24</mn>
   <mo>,</mo>
   <mrow>
    <mn>5</mn>
    <mo>/</mo>
    <mn>2</mn>
   </mrow>
   <mo>,</mo>
   <mn>1</mn>
   <mo stretchy="false">)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <vector>
    <cn type="integer">24</cn>
    <apply>
     <divide></divide>
     <cn type="integer">5</cn>
     <cn type="integer">2</cn>
    </apply>
    <cn type="integer">1</cn>
   </vector>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (24,5/2,1)
  </annotation>
 </semantics>
</math>

, which when composed with itself gave the desired integer solution 

<math display="inline" id="Pell's_equation:17">
 <semantics>
  <mrow>
   <mo stretchy="false">(</mo>
   <mn>1151</mn>
   <mo>,</mo>
   <mn>120</mn>
   <mo>,</mo>
   <mn>1</mn>
   <mo stretchy="false">)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <vector>
    <cn type="integer">1151</cn>
    <cn type="integer">120</cn>
    <cn type="integer">1</cn>
   </vector>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (1151,120,1)
  </annotation>
 </semantics>
</math>

. Brahmagupta solved many Pell equations with this method; in particular he showed how to obtain solutions starting from an integer solution of 

<math display="inline" id="Pell's_equation:18">
 <semantics>
  <mrow>
   <mrow>
    <msup>
     <mi>x</mi>
     <mn>2</mn>
    </msup>
    <mo>-</mo>
    <mrow>
     <mi>N</mi>
     <msup>
      <mi>y</mi>
      <mn>2</mn>
     </msup>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mi>k</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <minus></minus>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>x</ci>
      <cn type="integer">2</cn>
     </apply>
     <apply>
      <times></times>
      <ci>N</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>y</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
    <ci>k</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x^{2}-Ny^{2}=k
  </annotation>
 </semantics>
</math>

 for <em>k</em> = ±1, ±2, or ±4.<a class="footnoteRef" href="#fn5" id="fnref5"><sup>5</sup></a></p>

<p>The first general method for solving the Pell equation (for all <em>N</em>) was given by <a href="Bhaskara_II" title="wikilink">Bhaskara II</a> in 1150, extending the methods of Brahmagupta. Called the <a href="chakravala_method" title="wikilink">chakravala (cyclic) method</a>, it starts by composing any triple 

<math display="inline" id="Pell's_equation:19">
 <semantics>
  <mrow>
   <mo stretchy="false">(</mo>
   <mi>a</mi>
   <mo>,</mo>
   <mi>b</mi>
   <mo>,</mo>
   <mi>k</mi>
   <mo stretchy="false">)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <vector>
    <ci>a</ci>
    <ci>b</ci>
    <ci>k</ci>
   </vector>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (a,b,k)
  </annotation>
 </semantics>
</math>


 (that is, one which satisfies 

<math display="inline" id="Pell's_equation:20">
 <semantics>
  <mrow>
   <mrow>
    <msup>
     <mi>a</mi>
     <mn>2</mn>
    </msup>
    <mo>-</mo>
    <mrow>
     <mi>N</mi>
     <msup>
      <mi>b</mi>
      <mn>2</mn>
     </msup>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mi>k</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <minus></minus>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>a</ci>
      <cn type="integer">2</cn>
     </apply>
     <apply>
      <times></times>
      <ci>N</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>b</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
    <ci>k</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a^{2}-Nb^{2}=k
  </annotation>
 </semantics>
</math>

) with the trivial triple 

<math display="inline" id="Pell's_equation:21">
 <semantics>
  <mrow>
   <mo stretchy="false">(</mo>
   <mi>m</mi>
   <mo>,</mo>
   <mn>1</mn>
   <mo>,</mo>
   <mrow>
    <msup>
     <mi>m</mi>
     <mn>2</mn>
    </msup>
    <mo>-</mo>
    <mi>N</mi>
   </mrow>
   <mo stretchy="false">)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <vector>
    <ci>m</ci>
    <cn type="integer">1</cn>
    <apply>
     <minus></minus>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>m</ci>
      <cn type="integer">2</cn>
     </apply>
     <ci>N</ci>
    </apply>
   </vector>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (m,1,m^{2}-N)
  </annotation>
 </semantics>
</math>

 to get the triple 

<math display="inline" id="Pell's_equation:22">
 <semantics>
  <mrow>
   <mo stretchy="false">(</mo>
   <mrow>
    <mrow>
     <mi>a</mi>
     <mi>m</mi>
    </mrow>
    <mo>+</mo>
    <mrow>
     <mi>N</mi>
     <mi>b</mi>
    </mrow>
   </mrow>
   <mo>,</mo>
   <mrow>
    <mi>a</mi>
    <mo>+</mo>
    <mrow>
     <mi>b</mi>
     <mi>m</mi>
    </mrow>
   </mrow>
   <mo>,</mo>
   <mrow>
    <mi>k</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <msup>
       <mi>m</mi>
       <mn>2</mn>
      </msup>
      <mo>-</mo>
      <mi>N</mi>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo stretchy="false">)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <vector>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <ci>a</ci>
      <ci>m</ci>
     </apply>
     <apply>
      <times></times>
      <ci>N</ci>
      <ci>b</ci>
     </apply>
    </apply>
    <apply>
     <plus></plus>
     <ci>a</ci>
     <apply>
      <times></times>
      <ci>b</ci>
      <ci>m</ci>
     </apply>
    </apply>
    <apply>
     <times></times>
     <ci>k</ci>
     <apply>
      <minus></minus>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>m</ci>
       <cn type="integer">2</cn>
      </apply>
      <ci>N</ci>
     </apply>
    </apply>
   </vector>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (am+Nb,a+bm,k(m^{2}-N))
  </annotation>
 </semantics>
</math>

, which can be scaled down to</p>

<p>

<math display="block" id="Pell's_equation:23">
 <semantics>
  <mrow>
   <mrow>
    <mo>(</mo>
    <mpadded width="+1.7pt">
     <mfrac>
      <mrow>
       <mrow>
        <mi>a</mi>
        <mi>m</mi>
       </mrow>
       <mo>+</mo>
       <mrow>
        <mi>N</mi>
        <mi>b</mi>
       </mrow>
      </mrow>
      <mi>k</mi>
     </mfrac>
    </mpadded>
    <mo rspace="4.2pt">,</mo>
    <mpadded width="+1.7pt">
     <mfrac>
      <mrow>
       <mi>a</mi>
       <mo>+</mo>
       <mrow>
        <mi>b</mi>
        <mi>m</mi>
       </mrow>
      </mrow>
      <mi>k</mi>
     </mfrac>
    </mpadded>
    <mo rspace="4.2pt">,</mo>
    <mfrac>
     <mrow>
      <msup>
       <mi>m</mi>
       <mn>2</mn>
      </msup>
      <mo>-</mo>
      <mi>N</mi>
     </mrow>
     <mi>k</mi>
    </mfrac>
    <mo>)</mo>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <vector>
    <apply>
     <divide></divide>
     <apply>
      <plus></plus>
      <apply>
       <times></times>
       <ci>a</ci>
       <ci>m</ci>
      </apply>
      <apply>
       <times></times>
       <ci>N</ci>
       <ci>b</ci>
      </apply>
     </apply>
     <ci>k</ci>
    </apply>
    <apply>
     <divide></divide>
     <apply>
      <plus></plus>
      <ci>a</ci>
      <apply>
       <times></times>
       <ci>b</ci>
       <ci>m</ci>
      </apply>
     </apply>
     <ci>k</ci>
    </apply>
    <apply>
     <divide></divide>
     <apply>
      <minus></minus>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>m</ci>
       <cn type="integer">2</cn>
      </apply>
      <ci>N</ci>
     </apply>
     <ci>k</ci>
    </apply>
   </vector>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \left(\frac{am+Nb}{k}\,,\,\frac{a+bm}{k}\,,\,\frac{m^{2}-N}{k}\right).
  </annotation>
 </semantics>
</math>

</p>

<p>When <em>m</em> is chosen so that <em>(a+bm)/k</em> is an integer, so are the other two numbers in the triple. Among such <em>m</em>, the method chooses one that minimizes <em>(m²-N)/k</em>, and repeats the process. This method always terminates with a solution (proved by Lagrange in 1768). Bhaskara used it to give the solution <em>x</em>=1766319049, <em>y</em>=226153980 to the notorious <em>N</em> = 61 case.<a class="footnoteRef" href="#fn6" id="fnref6"><sup>6</sup></a></p>

<p>Several European mathematicians rediscovered how to solve Pell's equation in the 17th century, apparently unaware that it had been solved almost a thousand years earlier in India. <a class="uri" href="Fermat" title="wikilink">Fermat</a> found how to solve the equation and in a 1657 letter issued it as a challenge to English mathematicians. In a letter to Digby, <a href="Bernard_Frénicle_de_Bessy" title="wikilink">Bernard Frénicle de Bessy</a> said that Fermat found the smallest solution for <em>N</em> up to 150, and challenged <a href="John_Wallis" title="wikilink">John Wallis</a> to solve the cases <em>N</em> = 151 or 313. Both Wallis and <a href="Lord_Brouncker" title="wikilink">Lord Brouncker</a> gave solutions to these problems, though Wallis suggests in a letter that the solution was due to Brouncker.</p>

<p>Pell's connection with the equation is that he revised Thomas Branker's translation  of <a href="Johann_Rahn" title="wikilink">Johann Rahn</a>'s 1659 book "Teutsche Algebra" into English, with a discussion of Brouncker's solution of the equation. Euler mistakenly thought that this solution was due to Pell, as a result of which he named the equation after Pell.</p>

<p>The general theory of Pell's equation, based on <a href="continued_fractions" title="wikilink">continued fractions</a> and algebraic manipulations with numbers of the form 

<math display="inline" id="Pell's_equation:24">
 <semantics>
  <mrow>
   <mrow>
    <mi>P</mi>
    <mo>+</mo>
    <mrow>
     <mi>Q</mi>
     <msqrt>
      <mi>a</mi>
     </msqrt>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <plus></plus>
    <ci>P</ci>
    <apply>
     <times></times>
     <ci>Q</ci>
     <apply>
      <root></root>
      <ci>a</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   P+Q\sqrt{a},
  </annotation>
 </semantics>
</math>


 was developed by <a href="Joseph_Louis_Lagrange" title="wikilink">Lagrange</a> in 1766–1769.<a class="footnoteRef" href="#fn7" id="fnref7"><sup>7</sup></a></p>
<h2 id="solutions">Solutions</h2>
<h3 id="fundamental-solution-via-continued-fractions">Fundamental solution via continued fractions</h3>

<p>Let 

<math display="inline" id="Pell's_equation:25">
 <semantics>
  <mfrac>
   <msub>
    <mi>h</mi>
    <mi>i</mi>
   </msub>
   <msub>
    <mi>k</mi>
    <mi>i</mi>
   </msub>
  </mfrac>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <divide></divide>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>h</ci>
     <ci>i</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>k</ci>
     <ci>i</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \tfrac{h_{i}}{k_{i}}
  </annotation>
 </semantics>
</math>

 denote the sequence of <a href="Convergent_(continued_fraction)" title="wikilink">convergents</a> to the <a href="continued_fraction" title="wikilink">regular continued fraction</a> for 

<math display="inline" id="Pell's_equation:26">
 <semantics>
  <msqrt>
   <mi>n</mi>
  </msqrt>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <root></root>
    <ci>n</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \sqrt{n}
  </annotation>
 </semantics>
</math>

. This sequence is unique. Then the pair (<em>x</em><sub>1</sub>,<em>y</em><sub>1</sub>) solving Pell's equation and minimizing <em>x</em> satisfies <em>x</em><sub>1</sub> = <em>h<sub>i</sub></em> and <em>y</em><sub>1</sub> = <em>k<sub>i</sub></em> for some <em>i</em>. This pair is called the <em>fundamental solution</em>. Thus, the fundamental solution may be found by performing the continued fraction expansion and testing each successive convergent until a solution to Pell's equation is found.</p>

<p>As  describes, the time for finding the fundamental solution using the continued fraction method, with the aid of the <a href="Schönhage–Strassen_algorithm" title="wikilink">Schönhage–Strassen algorithm</a> for fast integer multiplication, is within a logarithmic factor of the solution size, the number of digits in the pair (<em>x</em><sub>1</sub>,<em>y</em><sub>1</sub>). However, this is not a <a href="polynomial_time_algorithm" title="wikilink">polynomial time algorithm</a> because the number of digits in the solution may be as large as √<em>n</em>, far larger than a polynomial in the number of digits in the input value <em>n</em> .</p>
<h3 id="additional-solutions-from-the-fundamental-solution">Additional solutions from the fundamental solution</h3>

<p>Once the fundamental solution is found, all remaining solutions may be calculated algebraically as</p>

<p>

<math display="block" id="Pell's_equation:27">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <msub>
      <mi>x</mi>
      <mi>k</mi>
     </msub>
     <mo>+</mo>
     <mrow>
      <msub>
       <mi>y</mi>
       <mi>k</mi>
      </msub>
      <msqrt>
       <mi>n</mi>
      </msqrt>
     </mrow>
    </mrow>
    <mo>=</mo>
    <msup>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <msub>
        <mi>x</mi>
        <mn>1</mn>
       </msub>
       <mo>+</mo>
       <mrow>
        <msub>
         <mi>y</mi>
         <mn>1</mn>
        </msub>
        <msqrt>
         <mi>n</mi>
        </msqrt>
       </mrow>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <mi>k</mi>
    </msup>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <plus></plus>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <ci>k</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>y</ci>
       <ci>k</ci>
      </apply>
      <apply>
       <root></root>
       <ci>n</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <plus></plus>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <cn type="integer">1</cn>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>y</ci>
        <cn type="integer">1</cn>
       </apply>
       <apply>
        <root></root>
        <ci>n</ci>
       </apply>
      </apply>
     </apply>
     <ci>k</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x_{k}+y_{k}\sqrt{n}=(x_{1}+y_{1}\sqrt{n})^{k}.
  </annotation>
 </semantics>
</math>

 Equivalently, we may calculate subsequent solutions via the <a href="recurrence_relation" title="wikilink">recurrence relations</a></p>

<p>

<math display="block" id="Pell's_equation:28">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>x</mi>
     <mrow>
      <mi>k</mi>
      <mo>+</mo>
      <mn>1</mn>
     </mrow>
    </msub>
    <mo>=</mo>
    <mrow>
     <mrow>
      <msub>
       <mi>x</mi>
       <mn>1</mn>
      </msub>
      <msub>
       <mi>x</mi>
       <mi>k</mi>
      </msub>
     </mrow>
     <mo>+</mo>
     <mrow>
      <mi>n</mi>
      <msub>
       <mi>y</mi>
       <mn>1</mn>
      </msub>
      <msub>
       <mi>y</mi>
       <mi>k</mi>
      </msub>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>x</ci>
     <apply>
      <plus></plus>
      <ci>k</ci>
      <cn type="integer">1</cn>
     </apply>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <cn type="integer">1</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <ci>k</ci>
      </apply>
     </apply>
     <apply>
      <times></times>
      <ci>n</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>y</ci>
       <cn type="integer">1</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>y</ci>
       <ci>k</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle x_{k+1}=x_{1}x_{k}+ny_{1}y_{k},
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Pell's_equation:29">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>y</mi>
     <mrow>
      <mi>k</mi>
      <mo>+</mo>
      <mn>1</mn>
     </mrow>
    </msub>
    <mo>=</mo>
    <mrow>
     <mrow>
      <msub>
       <mi>x</mi>
       <mn>1</mn>
      </msub>
      <msub>
       <mi>y</mi>
       <mi>k</mi>
      </msub>
     </mrow>
     <mo>+</mo>
     <mrow>
      <msub>
       <mi>y</mi>
       <mn>1</mn>
      </msub>
      <msub>
       <mi>x</mi>
       <mi>k</mi>
      </msub>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>y</ci>
     <apply>
      <plus></plus>
      <ci>k</ci>
      <cn type="integer">1</cn>
     </apply>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <cn type="integer">1</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>y</ci>
       <ci>k</ci>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>y</ci>
       <cn type="integer">1</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <ci>k</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle y_{k+1}=x_{1}y_{k}+y_{1}x_{k}.
  </annotation>
 </semantics>
</math>

</p>

<p>An alternative method to solving, once finding the first non-trivial solution, one could take the original equation 

<math display="inline" id="Pell's_equation:30">
 <semantics>
  <mrow>
   <mrow>
    <msup>
     <mi>x</mi>
     <mn>2</mn>
    </msup>
    <mo>-</mo>
    <mrow>
     <mi>n</mi>
     <msup>
      <mi>y</mi>
      <mn>2</mn>
     </msup>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <minus></minus>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>x</ci>
      <cn type="integer">2</cn>
     </apply>
     <apply>
      <times></times>
      <ci>n</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>y</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x^{2}-ny^{2}=1
  </annotation>
 </semantics>
</math>

 and factor the left hand side as a difference of squares, yielding 

<math display="inline" id="Pell's_equation:31">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>x</mi>
      <mo>+</mo>
      <mrow>
       <mi>y</mi>
       <msqrt>
        <mi>n</mi>
       </msqrt>
      </mrow>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>x</mi>
      <mo>-</mo>
      <mrow>
       <mi>y</mi>
       <msqrt>
        <mi>n</mi>
       </msqrt>
      </mrow>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mn>1.</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <plus></plus>
      <ci>x</ci>
      <apply>
       <times></times>
       <ci>y</ci>
       <apply>
        <root></root>
        <ci>n</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <minus></minus>
      <ci>x</ci>
      <apply>
       <times></times>
       <ci>y</ci>
       <apply>
        <root></root>
        <ci>n</ci>
       </apply>
      </apply>
     </apply>
    </apply>
    <cn type="float">1.</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (x+y\sqrt{n})(x-y\sqrt{n})=1.
  </annotation>
 </semantics>
</math>

 Once in this form, one can simply raise each side of the equation to the kth power, and recombining the factored form to a single difference statement. The solution 

<math display="inline" id="Pell's_equation:32">
 <semantics>
  <mi>s</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>s</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   s
  </annotation>
 </semantics>
</math>

 will be of the form 

<math display="inline" id="Pell's_equation:33">
 <semantics>
  <mrow>
   <mrow>
    <msup>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mi>x</mi>
       <mo>-</mo>
       <mi>s</mi>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <mi>k</mi>
    </msup>
    <mo>+</mo>
    <mrow>
     <mi>n</mi>
     <mo>⋅</mo>
     <msup>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mi>y</mi>
        <mo>-</mo>
        <mi>s</mi>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
      <mi>k</mi>
     </msup>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mn>1.</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <plus></plus>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <minus></minus>
       <ci>x</ci>
       <ci>s</ci>
      </apply>
      <ci>k</ci>
     </apply>
     <apply>
      <ci>normal-⋅</ci>
      <ci>n</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <minus></minus>
        <ci>y</ci>
        <ci>s</ci>
       </apply>
       <ci>k</ci>
      </apply>
     </apply>
    </apply>
    <cn type="float">1.</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (x-s)^{k}+n\cdot(y-s)^{k}=1.
  </annotation>
 </semantics>
</math>

</p>
<h3 id="concise-representation-and-faster-algorithms">Concise representation and faster algorithms</h3>

<p>Although writing out the fundamental solution (<em>x</em><sub>1</sub>,<em>y</em><sub>1</sub>) as a pair of binary numbers may require a large number of bits, it may in many cases be represented more compactly in the form</p>

<p>

<math display="block" id="Pell's_equation:34">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>x</mi>
     <mn>1</mn>
    </msub>
    <mo>+</mo>
    <mrow>
     <msub>
      <mi>y</mi>
      <mn>1</mn>
     </msub>
     <msqrt>
      <mi>n</mi>
     </msqrt>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <munderover>
     <mo largeop="true" movablelimits="false" symmetric="true">∏</mo>
     <mrow>
      <mi>i</mi>
      <mo>=</mo>
      <mn>1</mn>
     </mrow>
     <mi>t</mi>
    </munderover>
    <msup>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <msub>
        <mi>a</mi>
        <mi>i</mi>
       </msub>
       <mo>+</mo>
       <mrow>
        <msub>
         <mi>b</mi>
         <mi>i</mi>
        </msub>
        <msqrt>
         <mi>n</mi>
        </msqrt>
       </mrow>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <msub>
      <mi>c</mi>
      <mi>i</mi>
     </msub>
    </msup>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <plus></plus>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <cn type="integer">1</cn>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>y</ci>
       <cn type="integer">1</cn>
      </apply>
      <apply>
       <root></root>
       <ci>n</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <csymbol cd="latexml">product</csymbol>
       <apply>
        <eq></eq>
        <ci>i</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <ci>t</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <plus></plus>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>a</ci>
        <ci>i</ci>
       </apply>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>b</ci>
         <ci>i</ci>
        </apply>
        <apply>
         <root></root>
         <ci>n</ci>
        </apply>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>c</ci>
       <ci>i</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x_{1}+y_{1}\sqrt{n}=\prod_{i=1}^{t}(a_{i}+b_{i}\sqrt{n})^{c_{i}}
  </annotation>
 </semantics>
</math>

 using much smaller coefficients <em>a</em><sub><em>i</em></sub>, <em>b</em><sub><em>i</em></sub>, and <em>c</em><sub><em>i</em></sub>.</p>

<p>For instance, <a href="Archimedes'_cattle_problem" title="wikilink">Archimedes' cattle problem</a> may be solved using a Pell equation, the fundamental solution of which has 206545 digits if written out explicitly, the value is 776027140648...719455081800. However, instead of writing the solution as a pair of numbers, it may be written using the formula</p>

<p>

<math display="block" id="Pell's_equation:35">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <msub>
      <mi>x</mi>
      <mn>1</mn>
     </msub>
     <mo>+</mo>
     <mrow>
      <msub>
       <mi>y</mi>
       <mn>1</mn>
      </msub>
      <msqrt>
       <mi>n</mi>
      </msqrt>
     </mrow>
    </mrow>
    <mo>=</mo>
    <msup>
     <mi>u</mi>
     <mn>2329</mn>
    </msup>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <plus></plus>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <cn type="integer">1</cn>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>y</ci>
       <cn type="integer">1</cn>
      </apply>
      <apply>
       <root></root>
       <ci>n</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>u</ci>
     <cn type="integer">2329</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x_{1}+y_{1}\sqrt{n}=u^{2329},
  </annotation>
 </semantics>
</math>

 where</p>

<p>

<math display="block" id="Pell's_equation:36">
 <semantics>
  <mrow>
   <mi>u</mi>
   <mo>=</mo>
   <mrow>
    <msubsup>
     <mi>x</mi>
     <mn>1</mn>
     <mo>′</mo>
    </msubsup>
    <mo>+</mo>
    <mrow>
     <msubsup>
      <mi>y</mi>
      <mn>1</mn>
      <mo>′</mo>
     </msubsup>
     <mpadded width="+1.7pt">
      <msqrt>
       <mn>4729494</mn>
      </msqrt>
     </mpadded>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <msubsup>
     <mi>x</mi>
     <mn>1</mn>
     <mo>′</mo>
    </msubsup>
    <mo>+</mo>
    <mrow>
     <msubsup>
      <mi>y</mi>
      <mn>1</mn>
      <mo>′</mo>
     </msubsup>
     <mpadded width="+1.7pt">
      <msqrt>
       <mrow>
        <mn>609</mn>
        <mo>⋅</mo>
        <mn>7766</mn>
       </mrow>
      </msqrt>
     </mpadded>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <ci>u</ci>
     <apply>
      <plus></plus>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>x</ci>
        <ci>normal-′</ci>
       </apply>
       <cn type="integer">1</cn>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>y</ci>
         <ci>normal-′</ci>
        </apply>
        <cn type="integer">1</cn>
       </apply>
       <apply>
        <root></root>
        <cn type="integer">4729494</cn>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <plus></plus>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>x</ci>
        <ci>normal-′</ci>
       </apply>
       <cn type="integer">1</cn>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>y</ci>
         <ci>normal-′</ci>
        </apply>
        <cn type="integer">1</cn>
       </apply>
       <apply>
        <root></root>
        <apply>
         <ci>normal-⋅</ci>
         <cn type="integer">609</cn>
         <cn type="integer">7766</cn>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   u=x^{\prime}_{1}+y^{\prime}_{1}\sqrt{4729494}\,=x^{\prime}_{1}+y^{\prime}_{1}%
\sqrt{609\cdot 7766}\,
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Pell's_equation:37">
 <semantics>
  <msubsup>
   <mi>x</mi>
   <mn>1</mn>
   <mo>′</mo>
  </msubsup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>x</ci>
     <ci>normal-′</ci>
    </apply>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \scriptstyle x^{\prime}_{1}
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Pell's_equation:38">
 <semantics>
  <msubsup>
   <mi>y</mi>
   <mn>1</mn>
   <mo>′</mo>
  </msubsup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>y</ci>
     <ci>normal-′</ci>
    </apply>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \scriptstyle y^{\prime}_{1}
  </annotation>
 </semantics>
</math>

 only have 45 and 41 decimal digits, respectively. Alternatively, one may write even more concisely</p>

<p>

<math display="block" id="Pell's_equation:39">
 <semantics>
  <mrow>
   <mrow>
    <mi>u</mi>
    <mo>=</mo>
    <msup>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mrow>
        <mn>300426607914281713365</mn>
        <msqrt>
         <mn>609</mn>
        </msqrt>
       </mrow>
       <mo>+</mo>
       <mrow>
        <mn>84129507677858393258</mn>
        <msqrt>
         <mn>7766</mn>
        </msqrt>
       </mrow>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <mn>2</mn>
    </msup>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>u</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <plus></plus>
      <apply>
       <times></times>
       <cn type="integer">300426607914281713365</cn>
       <apply>
        <root></root>
        <cn type="integer">609</cn>
       </apply>
      </apply>
      <apply>
       <times></times>
       <cn type="integer">84129507677858393258</cn>
       <apply>
        <root></root>
        <cn type="integer">7766</cn>
       </apply>
      </apply>
     </apply>
     <cn type="integer">2</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   u=(300426607914281713365\sqrt{609}+84129507677858393258\sqrt{7766})^{2}.
  </annotation>
 </semantics>
</math>

 .</p>

<p>In fact, it is equivalent to solving the Pell equation 

<math display="inline" id="Pell's_equation:40">
 <semantics>
  <mrow>
   <mrow>
    <msup>
     <mi>x</mi>
     <mn>2</mn>
    </msup>
    <mo>-</mo>
    <mrow>
     <mn>410286423278424</mn>
     <msup>
      <mi>y</mi>
      <mn>2</mn>
     </msup>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <minus></minus>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>x</ci>
      <cn type="integer">2</cn>
     </apply>
     <apply>
      <times></times>
      <cn type="integer">410286423278424</cn>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>y</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x^{2}-410286423278424y^{2}=1
  </annotation>
 </semantics>
</math>

. (

<math display="inline" id="Pell's_equation:41">
 <semantics>
  <mrow>
   <msqrt>
    <mn>410286423278424</mn>
   </msqrt>
   <mo>=</mo>
   <mrow>
    <mn>9314</mn>
    <msqrt>
     <mn>4729494</mn>
    </msqrt>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <root></root>
     <cn type="integer">410286423278424</cn>
    </apply>
    <apply>
     <times></times>
     <cn type="integer">9314</cn>
     <apply>
      <root></root>
      <cn type="integer">4729494</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \sqrt{410286423278424}=9314\sqrt{4729494}
  </annotation>
 </semantics>
</math>

)</p>

<p>Methods related to the <a href="quadratic_sieve" title="wikilink">quadratic sieve</a> approach for <a href="integer_factorization" title="wikilink">integer factorization</a> may be used to collect relations between prime numbers in the number field generated by √<em>n</em>, and to combine these relations to find a product representation of this type. The resulting algorithm for solving Pell's equation is more efficient than the continued fraction method, though it still does not take polynomial time. Under the assumption of the <a href="generalized_Riemann_hypothesis" title="wikilink">generalized Riemann hypothesis</a>, it can be shown to take time</p>

<p>

<math display="block" id="Pell's_equation:42">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>exp</mi>
     <mi>O</mi>
    </mrow>
    <mrow>
     <mo stretchy="false">(</mo>
     <msqrt>
      <mrow>
       <mi>log</mi>
       <mrow>
        <mi>N</mi>
        <mrow>
         <mi>log</mi>
         <mrow>
          <mi>log</mi>
          <mi>N</mi>
         </mrow>
        </mrow>
       </mrow>
      </mrow>
     </msqrt>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <exp></exp>
     <ci>O</ci>
    </apply>
    <apply>
     <root></root>
     <apply>
      <log></log>
      <apply>
       <times></times>
       <ci>N</ci>
       <apply>
        <log></log>
        <apply>
         <log></log>
         <ci>N</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \exp O(\sqrt{\log N\log\log N}),
  </annotation>
 </semantics>
</math>

 where <em>N</em> = log <em>n</em> is the input size, similarly to the quadratic sieve .</p>
<h3 id="quantum-algorithms">Quantum algorithms</h3>

<p>showed that a <a href="quantum_computer" title="wikilink">quantum computer</a> can find a product representation, as described above, for the solution to Pell's equation in polynomial time. Hallgren's algorithm, which can be interpreted as an algorithm for finding the group of units of a real <a href="quadratic_number_field" title="wikilink">quadratic number field</a>, was extended to more general fields by .</p>
<h2 id="example">Example</h2>

<p>As an example, consider the instance of Pell's equation for <em>n</em> = 7; that is,</p>

<p>

<math display="block" id="Pell's_equation:43">
 <semantics>
  <mrow>
   <mrow>
    <msup>
     <mi>x</mi>
     <mn>2</mn>
    </msup>
    <mo>-</mo>
    <mrow>
     <mn>7</mn>
     <msup>
      <mi>y</mi>
      <mn>2</mn>
     </msup>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <minus></minus>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>x</ci>
      <cn type="integer">2</cn>
     </apply>
     <apply>
      <times></times>
      <cn type="integer">7</cn>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>y</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x^{2}-7y^{2}=1
  </annotation>
 </semantics>
</math>

 The sequence of convergents for the square root of seven are</p>
<dl>
<dd>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">
<p><em>h</em> / <em>k</em> (Convergent)</p></th>
<th style="text-align: left;">
<p><em>h</em><sup>2</sup> −7<em>k</em><sup>2</sup> (Pell-type approximation)</p></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">
<p>2 / 1</p></td>
<td style="text-align: left;">
<p>−3</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>3 / 1</p></td>
<td style="text-align: left;">
<p>+2</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>5 / 2</p></td>
<td style="text-align: left;">
<p>−3</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>8 / 3</p></td>
<td style="text-align: left;">
<p>+1</p></td>
</tr>
</tbody>
</table>
</dd>
</dl>

<p>Therefore, the fundamental solution is formed by the pair (8, 3). Applying the recurrence formula to this solution generates the infinite sequence of solutions</p>
<dl>
<dd>(1, 0); (8, 3); (127, 48); (2024, 765); (32257, 12192); (514088, 194307); (8193151, 3096720); (130576328, 49353213); ... (sequence  (<em>x</em>) and  (<em>y</em>) in <a class="uri" href="OEIS" title="wikilink">OEIS</a>)
</dd>
</dl>

<p>The smallest solution can be very large. For example, the smallest solution to 

<math display="inline" id="Pell's_equation:44">
 <semantics>
  <mrow>
   <mrow>
    <msup>
     <mi>x</mi>
     <mn>2</mn>
    </msup>
    <mo>-</mo>
    <mrow>
     <mn>313</mn>
     <msup>
      <mi>y</mi>
      <mn>2</mn>
     </msup>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <minus></minus>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>x</ci>
      <cn type="integer">2</cn>
     </apply>
     <apply>
      <times></times>
      <cn type="integer">313</cn>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>y</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x^{2}-313y^{2}=1
  </annotation>
 </semantics>
</math>


 is (32188120829134849, 1819380158564160), and this is the equation which Frenicle challenged Wallis to solve.<a class="footnoteRef" href="#fn8" id="fnref8"><sup>8</sup></a> Values of <em>n</em> such that the smallest solution of 

<math display="inline" id="Pell's_equation:45">
 <semantics>
  <mrow>
   <mrow>
    <msup>
     <mi>x</mi>
     <mn>2</mn>
    </msup>
    <mo>-</mo>
    <mrow>
     <mi>n</mi>
     <msup>
      <mi>y</mi>
      <mn>2</mn>
     </msup>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <minus></minus>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>x</ci>
      <cn type="integer">2</cn>
     </apply>
     <apply>
      <times></times>
      <ci>n</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>y</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x^{2}-ny^{2}=1
  </annotation>
 </semantics>
</math>

 sets a record are</p>
<dl>
<dd>1, 2, 5, 10, 13, 29, 46, 53, 61, 109, 181, 277, 397, 409, 421, 541, 661, 1021, 1069, 1381, 1549, 1621, 2389, 3061, 3469, 4621, 4789, 4909, 5581, 6301, 6829, 8269, 8941, 9949, ... 
</dd>
</dl>

<p>(For these records, see  (<em>x</em>), and  (<em>y</em>)).</p>
<h2 id="the-smallest-solution-of-pell-equations">The smallest solution of Pell equations</h2>

<p>The following is a list of the smallest solution to 

<math display="inline" id="Pell's_equation:46">
 <semantics>
  <mrow>
   <mrow>
    <msup>
     <mi>x</mi>
     <mn>2</mn>
    </msup>
    <mo>-</mo>
    <mrow>
     <mi>n</mi>
     <msup>
      <mi>y</mi>
      <mn>2</mn>
     </msup>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <minus></minus>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>x</ci>
      <cn type="integer">2</cn>
     </apply>
     <apply>
      <times></times>
      <ci>n</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>y</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x^{2}-ny^{2}=1
  </annotation>
 </semantics>
</math>

 with <em>n</em> ≤ 128. For square <em>n</em>, there are no solutions except (1, 0). (sequence  (<em>x</em>) and  (<em>y</em>) in <a class="uri" href="OEIS" title="wikilink">OEIS</a>, or  (<em>x</em>) and  (<em>y</em>) (for nonsquare <em>n</em>))</p>
<dl>
<dd>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">
<p><em>n</em></p></th>
<th style="text-align: left;">
<p><em>x</em></p></th>
<th style="text-align: left;">
<p><em>y</em></p></th>
<th style="text-align: left;">
<p><em>n</em></p></th>
<th style="text-align: left;">
<p><em>x</em></p></th>
<th style="text-align: left;">
<p><em>y</em></p></th>
<th style="text-align: left;">
<p><em>n</em></p></th>
<th style="text-align: left;">
<p><em>x</em></p></th>
<th style="text-align: left;">
<p><em>y</em></p></th>
<th style="text-align: left;">
<p><em>n</em></p></th>
<th style="text-align: left;">
<p><em>x</em></p></th>
<th style="text-align: left;">
<p><em>y</em></p></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">
<p>1</p></td>
</tr>
<tr class="even">
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>33</p></td>
<td style="text-align: left;">
<p>23</p></td>
<td style="text-align: left;">
<p>4</p></td>
<td style="text-align: left;">
<p>65</p></td>
<td style="text-align: left;">
<p>129</p></td>
<td style="text-align: left;">
<p>16</p></td>
<td style="text-align: left;">
<p>97</p></td>
<td style="text-align: left;">
<p>62809633</p></td>
<td style="text-align: left;">
<p>6377352</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>2</p></td>
<td style="text-align: left;">
<p>3</p></td>
<td style="text-align: left;">
<p>2</p></td>
<td style="text-align: left;">
<p>34</p></td>
<td style="text-align: left;">
<p>35</p></td>
<td style="text-align: left;">
<p>6</p></td>
<td style="text-align: left;">
<p>66</p></td>
<td style="text-align: left;">
<p>65</p></td>
<td style="text-align: left;">
<p>8</p></td>
<td style="text-align: left;">
<p>98</p></td>
<td style="text-align: left;">
<p>99</p></td>
<td style="text-align: left;">
<p>10</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>3</p></td>
<td style="text-align: left;">
<p>2</p></td>
<td style="text-align: left;">
<p>1</p></td>
<td style="text-align: left;">
<p>35</p></td>
<td style="text-align: left;">
<p>6</p></td>
<td style="text-align: left;">
<p>1</p></td>
<td style="text-align: left;">
<p>67</p></td>
<td style="text-align: left;">
<p>48842</p></td>
<td style="text-align: left;">
<p>5967</p></td>
<td style="text-align: left;">
<p>99</p></td>
<td style="text-align: left;">
<p>10</p></td>
<td style="text-align: left;">
<p>1</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>4</p></td>
</tr>
<tr class="odd">
</tr>
<tr class="even">
<td style="text-align: left;">
<p>36</p></td>
</tr>
<tr class="odd">
</tr>
<tr class="even">
<td style="text-align: left;">
<p>68</p></td>
<td style="text-align: left;">
<p>33</p></td>
<td style="text-align: left;">
<p>4</p></td>
<td style="text-align: left;">
<p>100</p></td>
</tr>
<tr class="odd">
</tr>
<tr class="even">
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>5</p></td>
<td style="text-align: left;">
<p>9</p></td>
<td style="text-align: left;">
<p>4</p></td>
<td style="text-align: left;">
<p>37</p></td>
<td style="text-align: left;">
<p>73</p></td>
<td style="text-align: left;">
<p>12</p></td>
<td style="text-align: left;">
<p>69</p></td>
<td style="text-align: left;">
<p>7775</p></td>
<td style="text-align: left;">
<p>936</p></td>
<td style="text-align: left;">
<p>101</p></td>
<td style="text-align: left;">
<p>201</p></td>
<td style="text-align: left;">
<p>20</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>6</p></td>
<td style="text-align: left;">
<p>5</p></td>
<td style="text-align: left;">
<p>2</p></td>
<td style="text-align: left;">
<p>38</p></td>
<td style="text-align: left;">
<p>37</p></td>
<td style="text-align: left;">
<p>6</p></td>
<td style="text-align: left;">
<p>70</p></td>
<td style="text-align: left;">
<p>251</p></td>
<td style="text-align: left;">
<p>30</p></td>
<td style="text-align: left;">
<p>102</p></td>
<td style="text-align: left;">
<p>101</p></td>
<td style="text-align: left;">
<p>10</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>7</p></td>
<td style="text-align: left;">
<p>8</p></td>
<td style="text-align: left;">
<p>3</p></td>
<td style="text-align: left;">
<p>39</p></td>
<td style="text-align: left;">
<p>25</p></td>
<td style="text-align: left;">
<p>4</p></td>
<td style="text-align: left;">
<p>71</p></td>
<td style="text-align: left;">
<p>3480</p></td>
<td style="text-align: left;">
<p>413</p></td>
<td style="text-align: left;">
<p>103</p></td>
<td style="text-align: left;">
<p>227528</p></td>
<td style="text-align: left;">
<p>22419</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>8</p></td>
<td style="text-align: left;">
<p>3</p></td>
<td style="text-align: left;">
<p>1</p></td>
<td style="text-align: left;">
<p>40</p></td>
<td style="text-align: left;">
<p>19</p></td>
<td style="text-align: left;">
<p>3</p></td>
<td style="text-align: left;">
<p>72</p></td>
<td style="text-align: left;">
<p>17</p></td>
<td style="text-align: left;">
<p>2</p></td>
<td style="text-align: left;">
<p>104</p></td>
<td style="text-align: left;">
<p>51</p></td>
<td style="text-align: left;">
<p>5</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>9</p></td>
</tr>
<tr class="even">
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>41</p></td>
<td style="text-align: left;">
<p>2049</p></td>
<td style="text-align: left;">
<p>320</p></td>
<td style="text-align: left;">
<p>73</p></td>
<td style="text-align: left;">
<p>2281249</p></td>
<td style="text-align: left;">
<p>267000</p></td>
<td style="text-align: left;">
<p>105</p></td>
<td style="text-align: left;">
<p>41</p></td>
<td style="text-align: left;">
<p>4</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>10</p></td>
<td style="text-align: left;">
<p>19</p></td>
<td style="text-align: left;">
<p>6</p></td>
<td style="text-align: left;">
<p>42</p></td>
<td style="text-align: left;">
<p>13</p></td>
<td style="text-align: left;">
<p>2</p></td>
<td style="text-align: left;">
<p>74</p></td>
<td style="text-align: left;">
<p>3699</p></td>
<td style="text-align: left;">
<p>430</p></td>
<td style="text-align: left;">
<p>106</p></td>
<td style="text-align: left;">
<p>32080051</p></td>
<td style="text-align: left;">
<p>3115890</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>11</p></td>
<td style="text-align: left;">
<p>10</p></td>
<td style="text-align: left;">
<p>3</p></td>
<td style="text-align: left;">
<p>43</p></td>
<td style="text-align: left;">
<p>3482</p></td>
<td style="text-align: left;">
<p>531</p></td>
<td style="text-align: left;">
<p>75</p></td>
<td style="text-align: left;">
<p>26</p></td>
<td style="text-align: left;">
<p>3</p></td>
<td style="text-align: left;">
<p>107</p></td>
<td style="text-align: left;">
<p>962</p></td>
<td style="text-align: left;">
<p>93</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>12</p></td>
<td style="text-align: left;">
<p>7</p></td>
<td style="text-align: left;">
<p>2</p></td>
<td style="text-align: left;">
<p>44</p></td>
<td style="text-align: left;">
<p>199</p></td>
<td style="text-align: left;">
<p>30</p></td>
<td style="text-align: left;">
<p>76</p></td>
<td style="text-align: left;">
<p>57799</p></td>
<td style="text-align: left;">
<p>6630</p></td>
<td style="text-align: left;">
<p>108</p></td>
<td style="text-align: left;">
<p>1351</p></td>
<td style="text-align: left;">
<p>130</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>13</p></td>
<td style="text-align: left;">
<p>649</p></td>
<td style="text-align: left;">
<p>180</p></td>
<td style="text-align: left;">
<p>45</p></td>
<td style="text-align: left;">
<p>161</p></td>
<td style="text-align: left;">
<p>24</p></td>
<td style="text-align: left;">
<p>77</p></td>
<td style="text-align: left;">
<p>351</p></td>
<td style="text-align: left;">
<p>40</p></td>
<td style="text-align: left;">
<p>109</p></td>
<td style="text-align: left;">
<p>158070671986249</p></td>
<td style="text-align: left;">
<p>15140424455100</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>14</p></td>
<td style="text-align: left;">
<p>15</p></td>
<td style="text-align: left;">
<p>4</p></td>
<td style="text-align: left;">
<p>46</p></td>
<td style="text-align: left;">
<p>24335</p></td>
<td style="text-align: left;">
<p>3588</p></td>
<td style="text-align: left;">
<p>78</p></td>
<td style="text-align: left;">
<p>53</p></td>
<td style="text-align: left;">
<p>6</p></td>
<td style="text-align: left;">
<p>110</p></td>
<td style="text-align: left;">
<p>21</p></td>
<td style="text-align: left;">
<p>2</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>15</p></td>
<td style="text-align: left;">
<p>4</p></td>
<td style="text-align: left;">
<p>1</p></td>
<td style="text-align: left;">
<p>47</p></td>
<td style="text-align: left;">
<p>48</p></td>
<td style="text-align: left;">
<p>7</p></td>
<td style="text-align: left;">
<p>79</p></td>
<td style="text-align: left;">
<p>80</p></td>
<td style="text-align: left;">
<p>9</p></td>
<td style="text-align: left;">
<p>111</p></td>
<td style="text-align: left;">
<p>295</p></td>
<td style="text-align: left;">
<p>28</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>16</p></td>
</tr>
<tr class="odd">
</tr>
<tr class="even">
<td style="text-align: left;">
<p>48</p></td>
<td style="text-align: left;">
<p>7</p></td>
<td style="text-align: left;">
<p>1</p></td>
<td style="text-align: left;">
<p>80</p></td>
<td style="text-align: left;">
<p>9</p></td>
<td style="text-align: left;">
<p>1</p></td>
<td style="text-align: left;">
<p>112</p></td>
<td style="text-align: left;">
<p>127</p></td>
<td style="text-align: left;">
<p>12</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>17</p></td>
<td style="text-align: left;">
<p>33</p></td>
<td style="text-align: left;">
<p>8</p></td>
<td style="text-align: left;">
<p>49</p></td>
</tr>
<tr class="even">
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>81</p></td>
</tr>
<tr class="even">
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>113</p></td>
<td style="text-align: left;">
<p>1204353</p></td>
<td style="text-align: left;">
<p>113296</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>18</p></td>
<td style="text-align: left;">
<p>17</p></td>
<td style="text-align: left;">
<p>4</p></td>
<td style="text-align: left;">
<p>50</p></td>
<td style="text-align: left;">
<p>99</p></td>
<td style="text-align: left;">
<p>14</p></td>
<td style="text-align: left;">
<p>82</p></td>
<td style="text-align: left;">
<p>163</p></td>
<td style="text-align: left;">
<p>18</p></td>
<td style="text-align: left;">
<p>114</p></td>
<td style="text-align: left;">
<p>1025</p></td>
<td style="text-align: left;">
<p>96</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>19</p></td>
<td style="text-align: left;">
<p>170</p></td>
<td style="text-align: left;">
<p>39</p></td>
<td style="text-align: left;">
<p>51</p></td>
<td style="text-align: left;">
<p>50</p></td>
<td style="text-align: left;">
<p>7</p></td>
<td style="text-align: left;">
<p>83</p></td>
<td style="text-align: left;">
<p>82</p></td>
<td style="text-align: left;">
<p>9</p></td>
<td style="text-align: left;">
<p>115</p></td>
<td style="text-align: left;">
<p>1126</p></td>
<td style="text-align: left;">
<p>105</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>20</p></td>
<td style="text-align: left;">
<p>9</p></td>
<td style="text-align: left;">
<p>2</p></td>
<td style="text-align: left;">
<p>52</p></td>
<td style="text-align: left;">
<p>649</p></td>
<td style="text-align: left;">
<p>90</p></td>
<td style="text-align: left;">
<p>84</p></td>
<td style="text-align: left;">
<p>55</p></td>
<td style="text-align: left;">
<p>6</p></td>
<td style="text-align: left;">
<p>116</p></td>
<td style="text-align: left;">
<p>9801</p></td>
<td style="text-align: left;">
<p>910</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>21</p></td>
<td style="text-align: left;">
<p>55</p></td>
<td style="text-align: left;">
<p>12</p></td>
<td style="text-align: left;">
<p>53</p></td>
<td style="text-align: left;">
<p>66249</p></td>
<td style="text-align: left;">
<p>9100</p></td>
<td style="text-align: left;">
<p>85</p></td>
<td style="text-align: left;">
<p>285769</p></td>
<td style="text-align: left;">
<p>30996</p></td>
<td style="text-align: left;">
<p>117</p></td>
<td style="text-align: left;">
<p>649</p></td>
<td style="text-align: left;">
<p>60</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>22</p></td>
<td style="text-align: left;">
<p>197</p></td>
<td style="text-align: left;">
<p>42</p></td>
<td style="text-align: left;">
<p>54</p></td>
<td style="text-align: left;">
<p>485</p></td>
<td style="text-align: left;">
<p>66</p></td>
<td style="text-align: left;">
<p>86</p></td>
<td style="text-align: left;">
<p>10405</p></td>
<td style="text-align: left;">
<p>1122</p></td>
<td style="text-align: left;">
<p>118</p></td>
<td style="text-align: left;">
<p>306917</p></td>
<td style="text-align: left;">
<p>28254</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>23</p></td>
<td style="text-align: left;">
<p>24</p></td>
<td style="text-align: left;">
<p>5</p></td>
<td style="text-align: left;">
<p>55</p></td>
<td style="text-align: left;">
<p>89</p></td>
<td style="text-align: left;">
<p>12</p></td>
<td style="text-align: left;">
<p>87</p></td>
<td style="text-align: left;">
<p>28</p></td>
<td style="text-align: left;">
<p>3</p></td>
<td style="text-align: left;">
<p>119</p></td>
<td style="text-align: left;">
<p>120</p></td>
<td style="text-align: left;">
<p>11</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>24</p></td>
<td style="text-align: left;">
<p>5</p></td>
<td style="text-align: left;">
<p>1</p></td>
<td style="text-align: left;">
<p>56</p></td>
<td style="text-align: left;">
<p>15</p></td>
<td style="text-align: left;">
<p>2</p></td>
<td style="text-align: left;">
<p>88</p></td>
<td style="text-align: left;">
<p>197</p></td>
<td style="text-align: left;">
<p>21</p></td>
<td style="text-align: left;">
<p>120</p></td>
<td style="text-align: left;">
<p>11</p></td>
<td style="text-align: left;">
<p>1</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>25</p></td>
</tr>
<tr class="even">
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>57</p></td>
<td style="text-align: left;">
<p>151</p></td>
<td style="text-align: left;">
<p>20</p></td>
<td style="text-align: left;">
<p>89</p></td>
<td style="text-align: left;">
<p>500001</p></td>
<td style="text-align: left;">
<p>53000</p></td>
<td style="text-align: left;">
<p>121</p></td>
</tr>
<tr class="even">
</tr>
<tr class="odd">
</tr>
<tr class="even">
<td style="text-align: left;">
<p>26</p></td>
<td style="text-align: left;">
<p>51</p></td>
<td style="text-align: left;">
<p>10</p></td>
<td style="text-align: left;">
<p>58</p></td>
<td style="text-align: left;">
<p>19603</p></td>
<td style="text-align: left;">
<p>2574</p></td>
<td style="text-align: left;">
<p>90</p></td>
<td style="text-align: left;">
<p>19</p></td>
<td style="text-align: left;">
<p>2</p></td>
<td style="text-align: left;">
<p>122</p></td>
<td style="text-align: left;">
<p>243</p></td>
<td style="text-align: left;">
<p>22</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>27</p></td>
<td style="text-align: left;">
<p>26</p></td>
<td style="text-align: left;">
<p>5</p></td>
<td style="text-align: left;">
<p>59</p></td>
<td style="text-align: left;">
<p>530</p></td>
<td style="text-align: left;">
<p>69</p></td>
<td style="text-align: left;">
<p>91</p></td>
<td style="text-align: left;">
<p>1574</p></td>
<td style="text-align: left;">
<p>165</p></td>
<td style="text-align: left;">
<p>123</p></td>
<td style="text-align: left;">
<p>122</p></td>
<td style="text-align: left;">
<p>11</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>28</p></td>
<td style="text-align: left;">
<p>127</p></td>
<td style="text-align: left;">
<p>24</p></td>
<td style="text-align: left;">
<p>60</p></td>
<td style="text-align: left;">
<p>31</p></td>
<td style="text-align: left;">
<p>4</p></td>
<td style="text-align: left;">
<p>92</p></td>
<td style="text-align: left;">
<p>1151</p></td>
<td style="text-align: left;">
<p>120</p></td>
<td style="text-align: left;">
<p>124</p></td>
<td style="text-align: left;">
<p>4620799</p></td>
<td style="text-align: left;">
<p>414960</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>29</p></td>
<td style="text-align: left;">
<p>9801</p></td>
<td style="text-align: left;">
<p>1820</p></td>
<td style="text-align: left;">
<p>61</p></td>
<td style="text-align: left;">
<p>1766319049</p></td>
<td style="text-align: left;">
<p>226153980</p></td>
<td style="text-align: left;">
<p>93</p></td>
<td style="text-align: left;">
<p>12151</p></td>
<td style="text-align: left;">
<p>1260</p></td>
<td style="text-align: left;">
<p>125</p></td>
<td style="text-align: left;">
<p>930249</p></td>
<td style="text-align: left;">
<p>83204</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>30</p></td>
<td style="text-align: left;">
<p>11</p></td>
<td style="text-align: left;">
<p>2</p></td>
<td style="text-align: left;">
<p>62</p></td>
<td style="text-align: left;">
<p>63</p></td>
<td style="text-align: left;">
<p>8</p></td>
<td style="text-align: left;">
<p>94</p></td>
<td style="text-align: left;">
<p>2143295</p></td>
<td style="text-align: left;">
<p>221064</p></td>
<td style="text-align: left;">
<p>126</p></td>
<td style="text-align: left;">
<p>449</p></td>
<td style="text-align: left;">
<p>40</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>31</p></td>
<td style="text-align: left;">
<p>1520</p></td>
<td style="text-align: left;">
<p>273</p></td>
<td style="text-align: left;">
<p>63</p></td>
<td style="text-align: left;">
<p>8</p></td>
<td style="text-align: left;">
<p>1</p></td>
<td style="text-align: left;">
<p>95</p></td>
<td style="text-align: left;">
<p>39</p></td>
<td style="text-align: left;">
<p>4</p></td>
<td style="text-align: left;">
<p>127</p></td>
<td style="text-align: left;">
<p>4730624</p></td>
<td style="text-align: left;">
<p>419775</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>32</p></td>
<td style="text-align: left;">
<p>17</p></td>
<td style="text-align: left;">
<p>3</p></td>
<td style="text-align: left;">
<p>64</p></td>
</tr>
<tr class="odd">
</tr>
<tr class="even">
<td style="text-align: left;">
<p>96</p></td>
<td style="text-align: left;">
<p>49</p></td>
<td style="text-align: left;">
<p>5</p></td>
<td style="text-align: left;">
<p>128</p></td>
<td style="text-align: left;">
<p>577</p></td>
<td style="text-align: left;">
<p>51</p></td>
</tr>
</tbody>
</table>
</dd>
</dl>
<h2 id="connections">Connections</h2>

<p>Pell's equation has connections to several other important subjects in mathematics.</p>
<h3 id="algebraic-number-theory">Algebraic number theory</h3>

<p>Pell's equation is closely related to the theory of <a href="algebraic_number" title="wikilink">algebraic numbers</a>, as the formula</p>

<p>

<math display="block" id="Pell's_equation:47">
 <semantics>
  <mrow>
   <mrow>
    <msup>
     <mi>x</mi>
     <mn>2</mn>
    </msup>
    <mo>-</mo>
    <mrow>
     <mi>n</mi>
     <msup>
      <mi>y</mi>
      <mn>2</mn>
     </msup>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>x</mi>
      <mo>+</mo>
      <mrow>
       <mi>y</mi>
       <msqrt>
        <mi>n</mi>
       </msqrt>
      </mrow>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>x</mi>
      <mo>-</mo>
      <mrow>
       <mi>y</mi>
       <msqrt>
        <mi>n</mi>
       </msqrt>
      </mrow>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <minus></minus>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>x</ci>
      <cn type="integer">2</cn>
     </apply>
     <apply>
      <times></times>
      <ci>n</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>y</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <plus></plus>
      <ci>x</ci>
      <apply>
       <times></times>
       <ci>y</ci>
       <apply>
        <root></root>
        <ci>n</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <minus></minus>
      <ci>x</ci>
      <apply>
       <times></times>
       <ci>y</ci>
       <apply>
        <root></root>
        <ci>n</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x^{2}-ny^{2}=(x+y\sqrt{n})(x-y\sqrt{n})
  </annotation>
 </semantics>
</math>

 is the <a href="Field_norm" title="wikilink">norm</a> for the <a href="Ring_(mathematics)" title="wikilink">ring</a> 

<math display="inline" id="Pell's_equation:48">
 <semantics>
  <mrow>
   <mi>ℤ</mi>
   <mrow>
    <mo stretchy="false">[</mo>
    <msqrt>
     <mi>n</mi>
    </msqrt>
    <mo stretchy="false">]</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>ℤ</ci>
    <apply>
     <csymbol cd="latexml">delimited-[]</csymbol>
     <apply>
      <root></root>
      <ci>n</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbb{Z}[\sqrt{n}]
  </annotation>
 </semantics>
</math>

 and for the closely related <a href="quadratic_field" title="wikilink">quadratic field</a> 

<math display="inline" id="Pell's_equation:49">
 <semantics>
  <mrow>
   <mi>ℚ</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msqrt>
     <mi>n</mi>
    </msqrt>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>ℚ</ci>
    <apply>
     <root></root>
     <ci>n</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbb{Q}(\sqrt{n})
  </annotation>
 </semantics>
</math>


. Thus, a pair of integers 

<math display="inline" id="Pell's_equation:50">
 <semantics>
  <mrow>
   <mo stretchy="false">(</mo>
   <mi>x</mi>
   <mo>,</mo>
   <mi>y</mi>
   <mo stretchy="false">)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <interval closure="open">
    <ci>x</ci>
    <ci>y</ci>
   </interval>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (x,y)
  </annotation>
 </semantics>
</math>

 solves Pell's equation if and only if 

<math display="inline" id="Pell's_equation:51">
 <semantics>
  <mrow>
   <mi>x</mi>
   <mo>+</mo>
   <mrow>
    <mi>y</mi>
    <msqrt>
     <mi>n</mi>
    </msqrt>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <plus></plus>
    <ci>x</ci>
    <apply>
     <times></times>
     <ci>y</ci>
     <apply>
      <root></root>
      <ci>n</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x+y\sqrt{n}
  </annotation>
 </semantics>
</math>

 is a <a href="Unit_(ring_theory)" title="wikilink">unit</a> with norm 1 in 

<math display="inline" id="Pell's_equation:52">
 <semantics>
  <mrow>
   <mi>ℤ</mi>
   <mrow>
    <mo stretchy="false">[</mo>
    <msqrt>
     <mi>n</mi>
    </msqrt>
    <mo stretchy="false">]</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>ℤ</ci>
    <apply>
     <csymbol cd="latexml">delimited-[]</csymbol>
     <apply>
      <root></root>
      <ci>n</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbb{Z}[\sqrt{n}]
  </annotation>
 </semantics>
</math>

. <a href="Dirichlet's_unit_theorem" title="wikilink">Dirichlet's unit theorem</a>, that all units of 

<math display="inline" id="Pell's_equation:53">
 <semantics>
  <mrow>
   <mi>ℤ</mi>
   <mrow>
    <mo stretchy="false">[</mo>
    <msqrt>
     <mi>n</mi>
    </msqrt>
    <mo stretchy="false">]</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>ℤ</ci>
    <apply>
     <csymbol cd="latexml">delimited-[]</csymbol>
     <apply>
      <root></root>
      <ci>n</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbb{Z}[\sqrt{n}]
  </annotation>
 </semantics>
</math>

 can be expressed as powers of a single <a href="Fundamental_unit_(number_theory)" title="wikilink">fundamental unit</a> (and multiplication by a sign), is an algebraic restatement of the fact that all solutions to the Pell equation can be generated from the fundamental solution. The fundamental unit can in general be found by solving a Pell-like equation but it does not always correspond directly to the fundamental solution of Pell's equation itself, because the fundamental unit may have norm −1 rather than 1 and its coefficients may be half integers rather than integers.</p>
<h3 id="chebyshev-polynomials">Chebyshev polynomials</h3>

<p>Demeyer (2007) mentions a connection between Pell's equation and the <a href="Chebyshev_polynomials" title="wikilink">Chebyshev polynomials</a>: If <em>T<sub>i</sub></em> (<em>x</em>) and <em>U<sub>i</sub></em> (<em>x</em>) are the Chebyshev polynomials of the first and second kind, respectively, then these polynomials satisfy a form of Pell's equation in any <a href="polynomial_ring" title="wikilink">polynomial ring</a> <em>R</em>[<em>x</em>], with <em>n</em> = <em>x</em><sup>2</sup> − 1:</p>

<p>

<math display="block" id="Pell's_equation:54">
 <semantics>
  <mrow>
   <mrow>
    <msubsup>
     <mi>T</mi>
     <mi>i</mi>
     <mn>2</mn>
    </msubsup>
    <mo>-</mo>
    <mrow>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <msup>
        <mi>x</mi>
        <mn>2</mn>
       </msup>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <msubsup>
      <mi>U</mi>
      <mrow>
       <mi>i</mi>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
      <mn>2</mn>
     </msubsup>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mpadded width="+1.7pt">
    <mn>1.</mn>
   </mpadded>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <minus></minus>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>T</ci>
       <ci>i</ci>
      </apply>
      <cn type="integer">2</cn>
     </apply>
     <apply>
      <times></times>
      <apply>
       <minus></minus>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>x</ci>
        <cn type="integer">2</cn>
       </apply>
       <cn type="integer">1</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>U</ci>
        <apply>
         <minus></minus>
         <ci>i</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
    <cn type="float">1.</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   T_{i}^{2}-(x^{2}-1)U_{i-1}^{2}=1.\,
  </annotation>
 </semantics>
</math>

</p>

<p>Thus, these polynomials can be generated by the standard technique for Pell equations of taking powers of a fundamental solution:</p>

<p>

<math display="block" id="Pell's_equation:55">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <msub>
      <mi>T</mi>
      <mi>i</mi>
     </msub>
     <mo>+</mo>
     <mrow>
      <msub>
       <mi>U</mi>
       <mrow>
        <mi>i</mi>
        <mo>-</mo>
        <mn>1</mn>
       </mrow>
      </msub>
      <msqrt>
       <mrow>
        <msup>
         <mi>x</mi>
         <mn>2</mn>
        </msup>
        <mo>-</mo>
        <mn>1</mn>
       </mrow>
      </msqrt>
     </mrow>
    </mrow>
    <mo>=</mo>
    <msup>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mi>x</mi>
       <mo>+</mo>
       <msqrt>
        <mrow>
         <msup>
          <mi>x</mi>
          <mn>2</mn>
         </msup>
         <mo>-</mo>
         <mn>1</mn>
        </mrow>
       </msqrt>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <mi>i</mi>
    </msup>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <plus></plus>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>T</ci>
      <ci>i</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>U</ci>
       <apply>
        <minus></minus>
        <ci>i</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <apply>
       <root></root>
       <apply>
        <minus></minus>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>x</ci>
         <cn type="integer">2</cn>
        </apply>
        <cn type="integer">1</cn>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <plus></plus>
      <ci>x</ci>
      <apply>
       <root></root>
       <apply>
        <minus></minus>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>x</ci>
         <cn type="integer">2</cn>
        </apply>
        <cn type="integer">1</cn>
       </apply>
      </apply>
     </apply>
     <ci>i</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   T_{i}+U_{i-1}\sqrt{x^{2}-1}=(x+\sqrt{x^{2}-1})^{i}.\,
  </annotation>
 </semantics>
</math>

</p>

<p>It may further be observed that, if (<em>x<sub>i</sub></em>,<em>y<sub>i</sub></em>) are the solutions to any integer Pell equation, then <em>x<sub>i</sub></em> = <em>T<sub>i</sub></em> (<em>x</em><sub>1</sub>) and <em>y<sub>i</sub></em> = <em>y</em><sub>1</sub><em>U</em><sub><em>i</em> − 1</sub>(<em>x</em><sub>1</sub>) (Barbeau, chapter 3).</p>
<h3 id="continued-fractions">Continued fractions</h3>

<p>A general development of solutions of Pell's equation 

<math display="inline" id="Pell's_equation:56">
 <semantics>
  <mrow>
   <mrow>
    <msup>
     <mi>x</mi>
     <mn>2</mn>
    </msup>
    <mo>-</mo>
    <mrow>
     <mi>n</mi>
     <msup>
      <mi>y</mi>
      <mn>2</mn>
     </msup>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <minus></minus>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>x</ci>
      <cn type="integer">2</cn>
     </apply>
     <apply>
      <times></times>
      <ci>n</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>y</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x^{2}-ny^{2}=1
  </annotation>
 </semantics>
</math>

 in terms of <a href="continued_fraction" title="wikilink">continued fractions</a> of 

<math display="inline" id="Pell's_equation:57">
 <semantics>
  <msqrt>
   <mi>n</mi>
  </msqrt>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <root></root>
    <ci>n</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \sqrt{n}
  </annotation>
 </semantics>
</math>

 can be presented, as the solutions <em>x</em> and <em>y</em> are approximates to the square root of <em>n</em> and thus are a special case of continued fraction approximations for <a href="quadratic_irrational" title="wikilink">quadratic irrationals</a>.</p>

<p>The relationship to the continued fractions implies that the solutions to Pell's equation form a <a class="uri" href="semigroup" title="wikilink">semigroup</a> subset of the <a href="modular_group" title="wikilink">modular group</a>. Thus, for example, if <em>p</em> and <em>q</em> satisfy Pell's equation, then</p>

<p>

<math display="block" id="Pell's_equation:58">
 <semantics>
  <mrow>
   <mo>(</mo>
   <mtable displaystyle="true">
    <mtr>
     <mtd columnalign="center">
      <mi>p</mi>
     </mtd>
     <mtd columnalign="center">
      <mi>q</mi>
     </mtd>
    </mtr>
    <mtr>
     <mtd columnalign="center">
      <mrow>
       <mi>n</mi>
       <mi>q</mi>
      </mrow>
     </mtd>
     <mtd columnalign="center">
      <mi>p</mi>
     </mtd>
    </mtr>
   </mtable>
   <mo>)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <matrix>
    <matrixrow>
     <ci>p</ci>
     <ci>q</ci>
    </matrixrow>
    <matrixrow>
     <apply>
      <times></times>
      <ci>n</ci>
      <ci>q</ci>
     </apply>
     <ci>p</ci>
    </matrixrow>
   </matrix>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \begin{pmatrix}p&q\\
nq&p\end{pmatrix}
  </annotation>
 </semantics>
</math>

</p>

<p>is a matrix of unit <a class="uri" href="determinant" title="wikilink">determinant</a>. Products of such matrices take exactly the same form, and thus all such products yield solutions to Pell's equation. This can be understood in part to arise from the fact that successive convergents of a continued fraction share the same property: If <em>p</em><sub><em>k</em>−1</sub>/<em>q</em><sub><em>k</em>−1</sub> and <em>p</em><sub><em>k</em></sub>/<em>q</em><sub><em>k</em></sub> are two successive convergents of a continued fraction, then the matrix</p>

<p>

<math display="block" id="Pell's_equation:59">
 <semantics>
  <mrow>
   <mo>(</mo>
   <mtable displaystyle="true">
    <mtr>
     <mtd columnalign="center">
      <msub>
       <mi>p</mi>
       <mrow>
        <mi>k</mi>
        <mo>-</mo>
        <mn>1</mn>
       </mrow>
      </msub>
     </mtd>
     <mtd columnalign="center">
      <msub>
       <mi>p</mi>
       <mi>k</mi>
      </msub>
     </mtd>
    </mtr>
    <mtr>
     <mtd columnalign="center">
      <msub>
       <mi>q</mi>
       <mrow>
        <mi>k</mi>
        <mo>-</mo>
        <mn>1</mn>
       </mrow>
      </msub>
     </mtd>
     <mtd columnalign="center">
      <msub>
       <mi>q</mi>
       <mi>k</mi>
      </msub>
     </mtd>
    </mtr>
   </mtable>
   <mo>)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <matrix>
    <matrixrow>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>p</ci>
      <apply>
       <minus></minus>
       <ci>k</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>p</ci>
      <ci>k</ci>
     </apply>
    </matrixrow>
    <matrixrow>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>q</ci>
      <apply>
       <minus></minus>
       <ci>k</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>q</ci>
      <ci>k</ci>
     </apply>
    </matrixrow>
   </matrix>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \begin{pmatrix}p_{k-1}&p_{k}\\
q_{k-1}&q_{k}\end{pmatrix}
  </annotation>
 </semantics>
</math>

</p>

<p>has determinant (−1)<sup><em>k</em></sup>.</p>

<p><a href="Størmer's_theorem" title="wikilink">Størmer's theorem</a> applies Pell equations to find pairs of consecutive <a href="smooth_number" title="wikilink">smooth numbers</a>. As part of this theory, <a href="Carl_Størmer" title="wikilink">Størmer</a> also investigated divisibility relations among solutions to Pell's equation; in particular, he showed that each solution other than the fundamental solution has a <a href="prime_factor" title="wikilink">prime factor</a> that does not divide <em>n</em>.</p>

<p>As Lenstra (2002) describes, Pell's equation can also be used to solve <a href="Archimedes'_cattle_problem" title="wikilink">Archimedes' cattle problem</a>.</p>
<h2 id="the-negative-pell-equation">The negative Pell equation</h2>

<p>The negative Pell equation is given by</p>

<p>

<math display="block" id="Pell's_equation:60">
 <semantics>
  <mrow>
   <mrow>
    <msup>
     <mi>x</mi>
     <mn>2</mn>
    </msup>
    <mo>-</mo>
    <mrow>
     <mi>n</mi>
     <msup>
      <mi>y</mi>
      <mn>2</mn>
     </msup>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mo>-</mo>
    <mn>1</mn>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <minus></minus>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>x</ci>
      <cn type="integer">2</cn>
     </apply>
     <apply>
      <times></times>
      <ci>n</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>y</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
    <apply>
     <minus></minus>
     <cn type="integer">1</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x^{2}-ny^{2}=-1
  </annotation>
 </semantics>
</math>

 (eq.1)</p>

<p>It has also been extensively studied; it can be solved by the same method of using continued fractions and will have solutions when the period of the continued fraction has odd length. However we do not know which roots have odd period lengths so we do not know when the negative Pell equation is solvable. But we can eliminate certain <em>n</em> since a necessary but not sufficient condition for solvability is that <em>n</em> is not divisible by a prime of form 4<em>m</em> + 3. Thus, for example, <em>x</em><sup>2</sup> − 3<em>py</em><sup>2</sup> = −1 is never solvable, but <em>x</em><sup>2</sup> − 5<em>py</em><sup>2</sup> = −1 may be, such as when <em>p</em> = 13 or 17 (of course, <em>p</em> needs to be with the form 4<em>m</em> + 1), though not when <em>p</em> = 41.</p>

<p>Numbers <em>n</em> for which <em>x</em><sup>2</sup> − <em>ny</em><sup>2</sup> = −1 is solvable are</p>
<dl>
<dd>1, 2, 5, 10, 13, 17, 26, 29, 37, 41, 50, 53, 58, 61, 65, 73, 74, 82, 85, 89, 97, 101, 106, 109, 113, 122, 125, 130, 137, 145, 149, 157, 170, 173, 181, 185, 193, 197, 202, 218, 226, 229, 233, 241, 250, ... 
</dd>
</dl>

<p>The solutions of <em>x</em> (while <em>n</em> is in this sequence) are listed in .</p>

<p>These <em>n</em>s are divisible neither by 4 nor by a prime of the form 4<em>m</em> + 3, but these conditions are not sufficient --- the <a class="uri" href="counterexamples" title="wikilink">counterexamples</a> are listed in , the first few such <em>n</em>s are 34, 146, 178, 194, 205, 221, 305, 377, 386, 410, 466, 482, ... In fact, <a href="if_and_only_if" title="wikilink">if and only if</a> the <a href="period_length" title="wikilink">period length</a> of the <a href="continued_fraction" title="wikilink">continued fraction</a> for 

<math display="inline" id="Pell's_equation:61">
 <semantics>
  <msqrt>
   <mi>n</mi>
  </msqrt>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <root></root>
    <ci>n</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \sqrt{n}
  </annotation>
 </semantics>
</math>

 () is <a href="odd_number" title="wikilink">odd</a>, then <em>x</em><sup>2</sup> − <em>ny</em><sup>2</sup> = −1 is solvable.</p>

<p>demonstrate that the proportion of square-free <em>n</em> divisible by <em>k</em> primes of the form 4<em>m</em> + 1 for which the negative Pell equation is solvable is at least 40%. If it does have a solution, then it can be shown that its fundamental solution leads to the fundamental one for the positive case by squaring both sides of eq. 1,</p>

<p>

<math display="block" id="Pell's_equation:62">
 <semantics>
  <mrow>
   <msup>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <msup>
       <mi>x</mi>
       <mn>2</mn>
      </msup>
      <mo>-</mo>
      <mrow>
       <mi>n</mi>
       <msup>
        <mi>y</mi>
        <mn>2</mn>
       </msup>
      </mrow>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
    <mn>2</mn>
   </msup>
   <mo>=</mo>
   <mpadded width="+1.7pt">
    <msup>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <mn>2</mn>
    </msup>
   </mpadded>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <minus></minus>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>x</ci>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <times></times>
       <ci>n</ci>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>y</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
     </apply>
     <cn type="integer">2</cn>
    </apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <minus></minus>
      <cn type="integer">1</cn>
     </apply>
     <cn type="integer">2</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (x^{2}-ny^{2})^{2}=(-1)^{2}\,
  </annotation>
 </semantics>
</math>

</p>

<p>to get,</p>

<p>

<math display="block" id="Pell's_equation:63">
 <semantics>
  <mrow>
   <mrow>
    <msup>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <msup>
        <mi>x</mi>
        <mn>2</mn>
       </msup>
       <mo>+</mo>
       <mrow>
        <mi>n</mi>
        <msup>
         <mi>y</mi>
         <mn>2</mn>
        </msup>
       </mrow>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <mn>2</mn>
    </msup>
    <mo>-</mo>
    <mrow>
     <mi>n</mi>
     <msup>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mn>2</mn>
        <mi>x</mi>
        <mi>y</mi>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
      <mn>2</mn>
     </msup>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mpadded width="+1.7pt">
    <mn>1.</mn>
   </mpadded>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <minus></minus>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <plus></plus>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>x</ci>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <times></times>
        <ci>n</ci>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>y</ci>
         <cn type="integer">2</cn>
        </apply>
       </apply>
      </apply>
      <cn type="integer">2</cn>
     </apply>
     <apply>
      <times></times>
      <ci>n</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <times></times>
        <cn type="integer">2</cn>
        <ci>x</ci>
        <ci>y</ci>
       </apply>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
    <cn type="float">1.</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (x^{2}+ny^{2})^{2}-n(2xy)^{2}=1.\,
  </annotation>
 </semantics>
</math>

</p>

<p>Or, since ny<sup>2</sup> = x<sup>2</sup> + 1 from eq.1, then,</p>

<p>

<math display="block" id="Pell's_equation:64">
 <semantics>
  <mrow>
   <mrow>
    <msup>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mrow>
        <mn>2</mn>
        <msup>
         <mi>x</mi>
         <mn>2</mn>
        </msup>
       </mrow>
       <mo>+</mo>
       <mn>1</mn>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <mn>2</mn>
    </msup>
    <mo>-</mo>
    <mrow>
     <mi>n</mi>
     <msup>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mn>2</mn>
        <mi>x</mi>
        <mi>y</mi>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
      <mn>2</mn>
     </msup>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mpadded width="+1.7pt">
    <mn>1</mn>
   </mpadded>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <minus></minus>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <plus></plus>
       <apply>
        <times></times>
        <cn type="integer">2</cn>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>x</ci>
         <cn type="integer">2</cn>
        </apply>
       </apply>
       <cn type="integer">1</cn>
      </apply>
      <cn type="integer">2</cn>
     </apply>
     <apply>
      <times></times>
      <ci>n</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <times></times>
        <cn type="integer">2</cn>
        <ci>x</ci>
        <ci>y</ci>
       </apply>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (2x^{2}+1)^{2}-n(2xy)^{2}=1\,
  </annotation>
 </semantics>
</math>

</p>

<p>showing that fundamental solutions to the positive case are bigger than those for the negative case.</p>
<h2 id="transformations">Transformations</h2>

<p>I. The related equation,</p>

<p>

<math display="block" id="Pell's_equation:65">
 <semantics>
  <mrow>
   <mrow>
    <msup>
     <mi>u</mi>
     <mn>2</mn>
    </msup>
    <mo>-</mo>
    <mrow>
     <mi>d</mi>
     <msup>
      <mi>v</mi>
      <mn>2</mn>
     </msup>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mo>±</mo>
    <mpadded width="+1.7pt">
     <mn>2</mn>
    </mpadded>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <minus></minus>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>u</ci>
      <cn type="integer">2</cn>
     </apply>
     <apply>
      <times></times>
      <ci>d</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>v</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
    <apply>
     <csymbol cd="latexml">plus-or-minus</csymbol>
     <cn type="integer">2</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   u^{2}-dv^{2}=\pm 2\,
  </annotation>
 </semantics>
</math>

 (eq.2)</p>

<p>can be used to find solutions to the positive Pell equation for certain <em>d</em>. <a href="Adrien-Marie_Legendre" title="wikilink">Legendre</a> proved that all primes of form <em>d</em> = 4<em>m</em> + 3 solve one case of eq.2, with the form 8<em>m</em> + 3 solving the negative, and 8<em>m</em> + 7 for the positive. Their fundamental solution then leads to the one for <em>x</em><sup>2</sup>−<em>dy</em><sup>2</sup> = 1. This can be shown by squaring both sides of eq. 2,</p>

<p>

<math display="block" id="Pell's_equation:66">
 <semantics>
  <mrow>
   <msup>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <msup>
       <mi>u</mi>
       <mn>2</mn>
      </msup>
      <mo>-</mo>
      <mrow>
       <mi>d</mi>
       <msup>
        <mi>v</mi>
        <mn>2</mn>
       </msup>
      </mrow>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
    <mn>2</mn>
   </msup>
   <mo>=</mo>
   <mpadded width="+1.7pt">
    <msup>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mo>±</mo>
       <mn>2</mn>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <mn>2</mn>
    </msup>
   </mpadded>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <minus></minus>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>u</ci>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <times></times>
       <ci>d</ci>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>v</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
     </apply>
     <cn type="integer">2</cn>
    </apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="latexml">plus-or-minus</csymbol>
      <cn type="integer">2</cn>
     </apply>
     <cn type="integer">2</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (u^{2}-dv^{2})^{2}=(\pm 2)^{2}\,
  </annotation>
 </semantics>
</math>

</p>

<p>to get,</p>

<p>

<math display="block" id="Pell's_equation:67">
 <semantics>
  <mrow>
   <mrow>
    <msup>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <msup>
        <mi>u</mi>
        <mn>2</mn>
       </msup>
       <mo>+</mo>
       <mrow>
        <mi>d</mi>
        <msup>
         <mi>v</mi>
         <mn>2</mn>
        </msup>
       </mrow>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <mn>2</mn>
    </msup>
    <mo>-</mo>
    <mrow>
     <mi>d</mi>
     <msup>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mn>2</mn>
        <mi>u</mi>
        <mi>v</mi>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
      <mn>2</mn>
     </msup>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mpadded width="+1.7pt">
    <mn>4.</mn>
   </mpadded>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <minus></minus>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <plus></plus>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>u</ci>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <times></times>
        <ci>d</ci>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>v</ci>
         <cn type="integer">2</cn>
        </apply>
       </apply>
      </apply>
      <cn type="integer">2</cn>
     </apply>
     <apply>
      <times></times>
      <ci>d</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <times></times>
        <cn type="integer">2</cn>
        <ci>u</ci>
        <ci>v</ci>
       </apply>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
    <cn type="float">4.</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (u^{2}+dv^{2})^{2}-d(2uv)^{2}=4.\,
  </annotation>
 </semantics>
</math>

</p>

<p>Since 

<math display="inline" id="Pell's_equation:68">
 <semantics>
  <mrow>
   <mrow>
    <mi>d</mi>
    <msup>
     <mi>v</mi>
     <mn>2</mn>
    </msup>
   </mrow>
   <mo>=</mo>
   <mrow>
    <msup>
     <mi>u</mi>
     <mn>2</mn>
    </msup>
    <mo>∓</mo>
    <mn>2</mn>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>d</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>v</ci>
      <cn type="integer">2</cn>
     </apply>
    </apply>
    <apply>
     <csymbol cd="latexml">minus-or-plus</csymbol>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>u</ci>
      <cn type="integer">2</cn>
     </apply>
     <cn type="integer">2</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   dv^{2}=u^{2}\mp 2
  </annotation>
 </semantics>
</math>

 from eq.2, then,</p>

<p>

<math display="block" id="Pell's_equation:69">
 <semantics>
  <mrow>
   <mrow>
    <msup>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mrow>
        <mn>2</mn>
        <msup>
         <mi>u</mi>
         <mn>2</mn>
        </msup>
       </mrow>
       <mo>∓</mo>
       <mn>2</mn>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <mn>2</mn>
    </msup>
    <mo>-</mo>
    <mrow>
     <mi>d</mi>
     <msup>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mn>2</mn>
        <mi>u</mi>
        <mi>v</mi>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
      <mn>2</mn>
     </msup>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mpadded width="+1.7pt">
    <mn>4</mn>
   </mpadded>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <minus></minus>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="latexml">minus-or-plus</csymbol>
       <apply>
        <times></times>
        <cn type="integer">2</cn>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>u</ci>
         <cn type="integer">2</cn>
        </apply>
       </apply>
       <cn type="integer">2</cn>
      </apply>
      <cn type="integer">2</cn>
     </apply>
     <apply>
      <times></times>
      <ci>d</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <times></times>
        <cn type="integer">2</cn>
        <ci>u</ci>
        <ci>v</ci>
       </apply>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
    <cn type="integer">4</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (2u^{2}\mp 2)^{2}-d(2uv)^{2}=4\,
  </annotation>
 </semantics>
</math>

</p>

<p>or simply,</p>

<p>

<math display="block" id="Pell's_equation:70">
 <semantics>
  <mrow>
   <mrow>
    <msup>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <msup>
        <mi>u</mi>
        <mn>2</mn>
       </msup>
       <mo>∓</mo>
       <mn>1</mn>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <mn>2</mn>
    </msup>
    <mo>-</mo>
    <mrow>
     <mi>d</mi>
     <msup>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mi>u</mi>
        <mi>v</mi>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
      <mn>2</mn>
     </msup>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mpadded width="+1.7pt">
    <mn>1</mn>
   </mpadded>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <minus></minus>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="latexml">minus-or-plus</csymbol>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>u</ci>
        <cn type="integer">2</cn>
       </apply>
       <cn type="integer">1</cn>
      </apply>
      <cn type="integer">2</cn>
     </apply>
     <apply>
      <times></times>
      <ci>d</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <times></times>
        <ci>u</ci>
        <ci>v</ci>
       </apply>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (u^{2}\mp 1)^{2}-d(uv)^{2}=1\,
  </annotation>
 </semantics>
</math>

</p>

<p>showing that fundamental solutions to eq.2 are smaller than eq.1. For example, u<sup>2</sup>-3v<sup>2</sup> = -2 is {<em>u</em>,<em>v</em>} = {1,1}, so <em>x</em><sup>2</sup> − 3<em>y</em><sup>2</sup> = 1 has {<em>x</em>,<em>y</em>} = {2,1}. On the other hand, <em>u</em><sup>2</sup> − 7<em>v</em><sup>2</sup> = 2 is {<em>u</em>,<em>v</em>} = {3,1}, so <em>x</em><sup>2</sup> − 7y<sup>2</sup> = 1 has {<em>x</em>,<em>y</em>} = {8,3}.</p>

<p>II. Another related equation,</p>

<p>

<math display="block" id="Pell's_equation:71">
 <semantics>
  <mrow>
   <mrow>
    <msup>
     <mi>u</mi>
     <mn>2</mn>
    </msup>
    <mo>-</mo>
    <mrow>
     <mi>d</mi>
     <msup>
      <mi>v</mi>
      <mn>2</mn>
     </msup>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mo>±</mo>
    <mpadded width="+1.7pt">
     <mn>4</mn>
    </mpadded>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <minus></minus>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>u</ci>
      <cn type="integer">2</cn>
     </apply>
     <apply>
      <times></times>
      <ci>d</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>v</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
    <apply>
     <csymbol cd="latexml">plus-or-minus</csymbol>
     <cn type="integer">4</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   u^{2}-dv^{2}=\pm 4\,
  </annotation>
 </semantics>
</math>

 (eq.3)</p>

<p>can also be used to find solutions to Pell equations for certain <em>d</em>, this time for the positive and negative case. For the following transformations,<a class="footnoteRef" href="#fn9" id="fnref9"><sup>9</sup></a> if fundamental {<em>u</em>,<em>v</em>} are both <a href="odd_number" title="wikilink">odd</a>, then it leads to fundamental {x,y}.</p>

<p>1. If u<sup>2</sup> − dv<sup>2</sup> = −4, and {x,y} = {(<em>u</em><sup>2</sup> + 3)<em>u</em>/2, (<em>u</em><sup>2</sup> + 1)<em>v</em>/2}, then <em>x</em><sup>2</sup> − <em>dy</em><sup>2</sup> = −1.</p>

<p>Ex. Let <em>d</em> = 13, then {<em>u</em>,<em>v</em>} = {3, 1} and {<em>x</em>,<em>y</em>} = {18, 5}.</p>

<p>2. If <em>u</em><sup>2</sup> − <em>dv</em><sup>2</sup> = 4, and {<em>x</em>,<em>y</em>} = {(<em>u</em><sup>2</sup> − 3)<em>u</em>/2, (<em>u</em><sup>2</sup> − 1)<em>v</em>/2}, then <em>x</em><sup>2</sup> − <em>dy</em><sup>2</sup> = 1.</p>

<p>Ex. Let <em>d</em> = 13, then {u,v} = {11, 3} and {x,y} = {649, 180}.</p>

<p>3. If <em>u</em><sup>2</sup> − <em>dv</em><sup>2</sup> = −4, and {<em>x</em>,<em>y</em>} = {(<em>u</em><sup>4</sup> + 4<em>u</em><sup>2</sup> + 1)(<em>u</em><sup>2</sup> + 2)/2, (<em>u</em><sup>2</sup> + 3)(<em>u</em><sup>2</sup> + 1)<em>uv</em>/2}, then <em>x</em><sup>2</sup> − <em>dy</em><sup>2</sup> = 1.</p>

<p>Ex. Let <em>d</em> = 61, then {<em>u</em>,<em>v</em>} = {39, 5} and {<em>x</em>,<em>y</em>} = {1766319049, 226153980}.</p>

<p>Especially for the last transformation, it can be seen how solutions to {<em>u</em>,<em>v</em>} are <em>much</em> smaller than {<em>x</em>,<em>y</em>}, since the latter are <a class="uri" href="sextic" title="wikilink">sextic</a> and <a class="uri" href="quintic" title="wikilink">quintic</a> polynomials in terms of <em>u</em>.</p>
<h2 id="notes">Notes</h2>
<references>
</references>
<h2 id="references">References</h2>
<ul>
<li>

<p>.</p></li>
<li></li>
<li>

<p>.</p></li>
<li>

<p>.</p></li>
<li>

<p>. Originally published 1977.</p></li>
<li>

<p>.</p></li>
<li>

<p>.</p></li>
<li>

<p>.</p></li>
<li></li>
<li>

<p>.</p></li>
<li>Wildberger, N.J., <em>Divine Proportions : Rational Trigonometry to Universal Geometry</em>, Wild Egg Books, Sydney, 2005.</li>
</ul>
<h2 id="further-reading">Further reading</h2>
<ul>
<li></li>
</ul>
<h2 id="external-links">External links</h2>
<ul>
<li></li>
<li><a href="http://www-groups.dcs.st-and.ac.uk/~history/HistTopics/Pell.html">Pell's equation</a></li>
<li><a href="http://math.fau.edu/richman/pell-m.htm">Pell equation solver (<em>n</em>&lt;10^8, can return the solution immediately)</a></li>
<li><a href="http://www.jakebakermaths.org.uk/maths/jshtmlpellsolverbigintegerv10.html">Pell equation solver (<em>n</em> has no upper limit)</a></li>
<li><a href="http://www.numbertheory.org/php/pell.html">Pell equation solver (<em>n</em>&lt;10^10, can also return the solution to x^2-ny^2 = +-1, +-2, +-3, and +-4)</a></li>
</ul>

<p>"</p>

<p><a href="Category:Diophantine_equations" title="wikilink">Category:Diophantine equations</a> <a href="Category:Continued_fractions" title="wikilink">Category:Continued fractions</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1">Lettre IX. Euler à Goldbach, dated 10 August 1750 in: P. H. Fuss, ed., <em>Correspondance Mathématique et Physique de Quelques Célèbres Géomètres du XVIIIeme Siècle</em> … (Mathematical and physical correspondence of some famous geometers of the 18th century), vol. 1, (St. Petersburg, Russia: 1843), pp. 35-39 ; see especially [<a class="uri" href="http://books.google.com/books?id=gf1OEXIQQgsC&amp;pg">http://books.google.com/books?id=gf1OEXIQQgsC&amp;pg;</a>;=PA37#v=onepage&amp;q;&amp;f;=false page 37.] From page 37: <em>"Pro hujusmodi quaestionibus solvendis excogitavit D. Pell Anglus peculiarem methodum in Wallisii operibus expositam."</em> (For solving such questions, the Englishman Dr. Pell devised a singular method [which is] shown in Wallis' works.)<a href="#fnref1">↩</a></li>
<li id="fn2"></li>
<li id="fn3"></li>
<li id="fn4">.<a href="#fnref4">↩</a></li>
<li id="fn5"><a href="#fnref5">↩</a></li>
<li id="fn6"></li>
<li id="fn7">"Solution d'un Problème d'Arithmétique", in <a href="http://gdz.sub.uni-goettingen.de/no_cache/dms/load/img/?IDDOC=41029">J.-A. Serret (Ed.), <em>Oeuvres de Lagrange</em>, vol. 1, pp. 671–731, 1867.</a><a href="#fnref7">↩</a></li>
<li id="fn8"><a href="http://primes.utm.edu/curios/page.php?short=313">Prime Curios!: 313</a><a href="#fnref8">↩</a></li>
<li id="fn9"><a href="http://sites.google.com/site/tpiezas/008">A Collection of Algebraic Identities: Pell Equations.</a><a href="#fnref9">↩</a></li>
</ol>
</section>
</body>
</html>

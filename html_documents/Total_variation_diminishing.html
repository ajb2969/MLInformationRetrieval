<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="501">Total variation diminishing</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Total variation diminishing</h1>
<hr/>

<p>In <a href="numerical_method" title="wikilink">numerical methods</a>, <strong>total variation diminishing (TVD)</strong> is a property of certain <a class="uri" href="discretization" title="wikilink">discretization</a> schemes used to solve <a href="hyperbolic_partial_differential_equation" title="wikilink">hyperbolic partial differential equations</a>. The most notable application of this method is in <a href="computational_fluid_dynamics" title="wikilink">computational fluid dynamics</a>. The concept of TVD was introduced by <a href="Ami_Harten" title="wikilink">Ami Harten</a>.<a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a></p>
<h2 id="model-equation">Model equation</h2>

<p>In systems described by <a href="partial_differential_equation" title="wikilink">partial differential equations</a>, such as the following hyperbolic <a href="advection_equation" title="wikilink">advection equation</a>,</p>

<p>

<math display="block" id="Total_variation_diminishing:0">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mfrac>
      <mtext>
       P
                          a
                          r
                          t
                           
                          I
                        
                        u
                      
                      
                        
                          I
                        
                        u
      </mtext>
      <mtext>
       P
                          a
                          r
                          t
                           
                          I
                          I
                        
                        t
                      
                      
                        
                          I
                          I
                        
                        t
      </mtext>
     </mfrac>
     <mo>+</mo>
     <mrow>
      <mi>a</mi>
      <mfrac>
       <mtext>
        P
                            a
                            r
                            t
                             
                            I
                            I
                            I
                          
                          u
                        
                        
                          
                            I
                            I
                            I
                          
                          u
       </mtext>
       <mtext>
        P
                            a
                            r
                            t
                             
                            I
                            V
                          
                          x
                        
                        
                          
                            I
                            V
                          
                          x
       </mtext>
      </mfrac>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mn>0</mn>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <plus></plus>
     <apply>
      <divide></divide>
      <mtext>
       P
                          a
                          r
                          t
                           
                          I
                        
                        u
                      
                      
                        
                          I
                        
                        u
      </mtext>
      <mtext>
       P
                          a
                          r
                          t
                           
                          I
                          I
                        
                        t
                      
                      
                        
                          I
                          I
                        
                        t
      </mtext>
     </apply>
     <apply>
      <times></times>
      <ci>a</ci>
      <apply>
       <divide></divide>
       <mtext>
        P
                            a
                            r
                            t
                             
                            I
                            I
                            I
                          
                          u
                        
                        
                          
                            I
                            I
                            I
                          
                          u
       </mtext>
       <mtext>
        P
                            a
                            r
                            t
                             
                            I
                            V
                          
                          x
                        
                        
                          
                            I
                            V
                          
                          x
       </mtext>
      </apply>
     </apply>
    </apply>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \frac{\@@section{part}{Pt1}{I}{Part~I}{{\@tag[][]{I}u}}{{\@tag[][]{Part~I}u}}}%
{\@@section{part}{Pt2}{II}{Part~II}{{\@tag[][]{II}t}}{{\@tag[][]{Part~II}t}}}+%
a\frac{\@@section{part}{Pt3}{III}{Part~III}{{\@tag[][]{III}u}}{{\@tag[][]{Part%
~III}u}}}{\@@section{part}{Pt4}{IV}{Part~IV}{{\@tag[][]{IV}x}}{{\@tag[][]{Part%
~IV}x}}}=0,
  </annotation>
 </semantics>
</math>

</p>

<p>the <a href="total_variation" title="wikilink">total variation</a> (TV) is given by,</p>

<p>

<math display="block" id="Total_variation_diminishing:1">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>T</mi>
     <mi>V</mi>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mo largeop="true" symmetric="true">∫</mo>
     <mrow>
      <mrow>
       <mo>|</mo>
       <mfrac>
        <mtext>
         P
                                a
                                r
                                t
                                 
                                V
                              
                              u
                            
                            
                              
                                V
                              
                              u
        </mtext>
        <mtext>
         P
                                a
                                r
                                t
                                 
                                V
                                I
                              
                              x
                            
                            
                              
                                V
                                I
                              
                              x
        </mtext>
       </mfrac>
       <mo>|</mo>
      </mrow>
      <mi>d</mi>
      <mi>x</mi>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>T</ci>
     <ci>V</ci>
    </apply>
    <apply>
     <int></int>
     <apply>
      <times></times>
      <apply>
       <abs></abs>
       <apply>
        <divide></divide>
        <mtext>
         P
                                a
                                r
                                t
                                 
                                V
                              
                              u
                            
                            
                              
                                V
                              
                              u
        </mtext>
        <mtext>
         P
                                a
                                r
                                t
                                 
                                V
                                I
                              
                              x
                            
                            
                              
                                V
                                I
                              
                              x
        </mtext>
       </apply>
      </apply>
      <ci>d</ci>
      <ci>x</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   TV=\int\left|\frac{\@@section{part}{Pt5}{V}{Part~V}{{\@tag[][]{V}u}}{{\@tag[][%
]{Part~V}u}}}{\@@section{part}{Pt6}{VI}{Part~VI}{{\@tag[][]{VI}x}}{{\@tag[][]{%
Part~VI}x}}}\right|dx,
  </annotation>
 </semantics>
</math>

</p>

<p>and the <a href="total_variation" title="wikilink">total variation</a> for the discrete case is,</p>

<p>

<math display="block" id="Total_variation_diminishing:2">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>T</mi>
     <mi>V</mi>
    </mrow>
    <mo>=</mo>
    <mrow>
     <munder>
      <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
      <mi>j</mi>
     </munder>
     <mrow>
      <mo>|</mo>
      <mrow>
       <msub>
        <mi>u</mi>
        <mrow>
         <mi>j</mi>
         <mo>+</mo>
         <mn>1</mn>
        </mrow>
       </msub>
       <mo>-</mo>
       <msub>
        <mi>u</mi>
        <mi>j</mi>
       </msub>
      </mrow>
      <mo>|</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>T</ci>
     <ci>V</ci>
    </apply>
    <apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <sum></sum>
      <ci>j</ci>
     </apply>
     <apply>
      <abs></abs>
      <apply>
       <minus></minus>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>u</ci>
        <apply>
         <plus></plus>
         <ci>j</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>u</ci>
        <ci>j</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   TV=\sum_{j}\left|u_{j+1}-u_{j}\right|.
  </annotation>
 </semantics>
</math>

</p>

<p>A numerical method is said to be <strong>total variation diminishing</strong> (TVD) if,</p>

<p>

<math display="block" id="Total_variation_diminishing:3">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>T</mi>
     <mi>V</mi>
     <mrow>
      <mo>(</mo>
      <msup>
       <mi>u</mi>
       <mrow>
        <mi>n</mi>
        <mo>+</mo>
        <mn>1</mn>
       </mrow>
      </msup>
      <mo>)</mo>
     </mrow>
    </mrow>
    <mo>≤</mo>
    <mrow>
     <mi>T</mi>
     <mi>V</mi>
     <mrow>
      <mo>(</mo>
      <msup>
       <mi>u</mi>
       <mi>n</mi>
      </msup>
      <mo>)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <leq></leq>
    <apply>
     <times></times>
     <ci>T</ci>
     <ci>V</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>u</ci>
      <apply>
       <plus></plus>
       <ci>n</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
    </apply>
    <apply>
     <times></times>
     <ci>T</ci>
     <ci>V</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>u</ci>
      <ci>n</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   TV\left(u^{n+1}\right)\leq TV\left(u^{n}\right).
  </annotation>
 </semantics>
</math>

</p>
<h2 id="characteristics">Characteristics</h2>

<p>A numerical scheme is said to be monotonicity preserving if the following properties are maintained:</p>
<ul>
<li>If 

<math display="inline" id="Total_variation_diminishing:4">
 <semantics>
  <msup>
   <mi>u</mi>
   <mi>n</mi>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>u</ci>
    <ci>n</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   u^{n}
  </annotation>
 </semantics>
</math>

 is monotonically increasing (or decreasing) in space, then so is 

<math display="inline" id="Total_variation_diminishing:5">
 <semantics>
  <msup>
   <mi>u</mi>
   <mrow>
    <mi>n</mi>
    <mo>+</mo>
    <mn>1</mn>
   </mrow>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>u</ci>
    <apply>
     <plus></plus>
     <ci>n</ci>
     <cn type="integer">1</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   u^{n+1}
  </annotation>
 </semantics>
</math>

.</li>
</ul>

<p>proved the following properties for a numerical scheme,</p>
<ul>
<li>A <a href="monotone_scheme" title="wikilink">monotone scheme</a> is TVD, and</li>
</ul>
<ul>
<li>A TVD scheme is <a href="Monotonic_function" title="wikilink">monotonicity</a> preserving.</li>
</ul>
<h2 id="application-in-cfd">Application in CFD</h2>

<p>In <a href="Computational_Fluid_Dynamics" title="wikilink">Computational Fluid Dynamics</a>, TVD scheme is employed to capture sharper shock predictions without any misleading oscillations when variation of field variable “Ø” is discontinuous. To capture the variation fine grids (∆x = very small) are needed and the computation becomes heavy and therefore uneconomic. The use of coarse grids with <a href="finite_difference" title="wikilink">central difference scheme</a>, <a href="upwind_scheme" title="wikilink">upwind scheme</a>, <a href="Hybrid_Difference_Scheme" title="wikilink">hybrid difference scheme</a>, and <a href="power_law_scheme" title="wikilink">power law scheme</a> gives false shock predictions. TVD scheme enables sharper shock predictions on coarse grids saving computation time and as the scheme preserves monotonicity there are no spurious oscillations in the solution.</p>
<h2 id="discretisation">Discretisation</h2>

<p>Consider the steady state one-dimensional convection diffusion equation,</p>

<p>

<math display="block" id="Total_variation_diminishing:6">
 <semantics>
  <mrow>
   <mrow>
    <mo>∇</mo>
    <mo>⋅</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>ρ</mi>
      <mi>𝐮</mi>
      <mi>ϕ</mi>
     </mrow>
     <mo rspace="4.2pt" stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mo>∇</mo>
     <mo>⋅</mo>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mi mathvariant="normal">Γ</mi>
       <mrow>
        <mo>∇</mo>
        <mi>ϕ</mi>
       </mrow>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>+</mo>
    <mpadded width="+2.8pt">
     <msub>
      <mi>S</mi>
      <mi>ϕ</mi>
     </msub>
    </mpadded>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <ci>normal-⋅</ci>
     <ci>normal-∇</ci>
     <apply>
      <times></times>
      <ci>ρ</ci>
      <ci>𝐮</ci>
      <ci>ϕ</ci>
     </apply>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <ci>normal-⋅</ci>
      <ci>normal-∇</ci>
      <apply>
       <times></times>
       <ci>normal-Γ</ci>
       <apply>
        <ci>normal-∇</ci>
        <ci>ϕ</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>S</ci>
      <ci>ϕ</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \nabla\cdot(\rho\mathbf{u}\phi)\,=\nabla\cdot(\Gamma\nabla\phi)+S_{\phi}\;
  </annotation>
 </semantics>
</math>

</p>

<p>Where, 

<math display="inline" id="Total_variation_diminishing:7">
 <semantics>
  <mi>ρ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>ρ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \rho
  </annotation>
 </semantics>
</math>

 is the density, 

<math display="inline" id="Total_variation_diminishing:8">
 <semantics>
  <mi>𝐮</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>𝐮</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{u}
  </annotation>
 </semantics>
</math>

 is the velocity vector, 

<math display="inline" id="Total_variation_diminishing:9">
 <semantics>
  <mi>ϕ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>ϕ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \phi
  </annotation>
 </semantics>
</math>

 is the property being transported, 

<math display="inline" id="Total_variation_diminishing:10">
 <semantics>
  <mi mathvariant="normal">Γ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>normal-Γ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Gamma
  </annotation>
 </semantics>
</math>

 is the coefficient of diffusion and 

<math display="inline" id="Total_variation_diminishing:11">
 <semantics>
  <msub>
   <mi>S</mi>
   <mi>ϕ</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>S</ci>
    <ci>ϕ</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   S_{\phi}
  </annotation>
 </semantics>
</math>

 is the source term responsible for generation of the property 

<math display="inline" id="Total_variation_diminishing:12">
 <semantics>
  <mi>ϕ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>ϕ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \phi
  </annotation>
 </semantics>
</math>

</p>

<p>Making the flux balance of this property about a control volume we get,</p>

<p>

<math display="block" id="Total_variation_diminishing:13">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mo largeop="true" symmetric="true">∫</mo>
     <mi>A</mi>
    </msub>
    <mrow>
     <mrow>
      <mi>𝐧</mi>
      <mo>⋅</mo>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mi>ρ</mi>
        <mi>𝐮</mi>
        <mi>ϕ</mi>
       </mrow>
       <mo rspace="4.2pt" stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mi>d</mi>
     <mi>A</mi>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <msub>
      <mo largeop="true" symmetric="true">∫</mo>
      <mi>A</mi>
     </msub>
     <mrow>
      <mrow>
       <mi>𝐧</mi>
       <mo>⋅</mo>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mi mathvariant="normal">Γ</mi>
         <mrow>
          <mo>∇</mo>
          <mi>ϕ</mi>
         </mrow>
        </mrow>
        <mo rspace="4.2pt" stretchy="false">)</mo>
       </mrow>
      </mrow>
      <mi>d</mi>
      <mi>A</mi>
     </mrow>
    </mrow>
    <mo>+</mo>
    <mrow>
     <msub>
      <mo largeop="true" symmetric="true">∫</mo>
      <mi>C</mi>
     </msub>
     <mrow>
      <mi>V</mi>
      <mpadded width="+1.7pt">
       <msub>
        <mi>S</mi>
        <mi>ϕ</mi>
       </msub>
      </mpadded>
      <mi>d</mi>
      <mi>V</mi>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <int></int>
      <ci>A</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <ci>normal-⋅</ci>
       <ci>𝐧</ci>
       <apply>
        <times></times>
        <ci>ρ</ci>
        <ci>𝐮</ci>
        <ci>ϕ</ci>
       </apply>
      </apply>
      <ci>d</ci>
      <ci>A</ci>
     </apply>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <int></int>
       <ci>A</ci>
      </apply>
      <apply>
       <times></times>
       <apply>
        <ci>normal-⋅</ci>
        <ci>𝐧</ci>
        <apply>
         <times></times>
         <ci>normal-Γ</ci>
         <apply>
          <ci>normal-∇</ci>
          <ci>ϕ</ci>
         </apply>
        </apply>
       </apply>
       <ci>d</ci>
       <ci>A</ci>
      </apply>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <int></int>
       <ci>C</ci>
      </apply>
      <apply>
       <times></times>
       <ci>V</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>S</ci>
        <ci>ϕ</ci>
       </apply>
       <ci>d</ci>
       <ci>V</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \int_{A}\mathbf{n}\cdot(\rho\mathbf{u}\phi)\,dA=\int_{A}\mathbf{n}\cdot(\Gamma%
\nabla\phi)\,dA+\int_{C}VS_{\phi}\,dV
  </annotation>
 </semantics>
</math>

 

<math display="inline" id="Total_variation_diminishing:14">
 <semantics>
  <mi></mi>
  <annotation-xml encoding="MathML-Content">
   <csymbol cd="latexml">absent</csymbol>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \;
  </annotation>
 </semantics>
</math>

</p>

<p>Here 

<math display="inline" id="Total_variation_diminishing:15">
 <semantics>
  <mi>𝐧</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>𝐧</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{n}
  </annotation>
 </semantics>
</math>

 is the normal to the surface of control volume.</p>

<p>Ignoring the source term, the equation further reduces to:</p>

<p>

<math display="block" id="Total_variation_diminishing:16">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mi>ρ</mi>
       <mi>𝐮</mi>
       <mi>ϕ</mi>
       <mi>A</mi>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <mi>r</mi>
    </msub>
    <mo>-</mo>
    <msub>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mi>ρ</mi>
       <mi>𝐮</mi>
       <mi>ϕ</mi>
       <mi>A</mi>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <mi>l</mi>
    </msub>
   </mrow>
   <mo>=</mo>
   <mrow>
    <msub>
     <mrow>
      <mo>(</mo>
      <mrow>
       <mi mathvariant="normal">Γ</mi>
       <mi>A</mi>
       <mfrac>
        <mrow>
         <mo>∂</mo>
         <mi>ϕ</mi>
        </mrow>
        <mrow>
         <mo>∂</mo>
         <mi>x</mi>
        </mrow>
       </mfrac>
      </mrow>
      <mo>)</mo>
     </mrow>
     <mi>r</mi>
    </msub>
    <mo>-</mo>
    <msub>
     <mrow>
      <mo>(</mo>
      <mrow>
       <mi mathvariant="normal">Γ</mi>
       <mi>A</mi>
       <mfrac>
        <mrow>
         <mo>∂</mo>
         <mi>ϕ</mi>
        </mrow>
        <mrow>
         <mo>∂</mo>
         <mi>x</mi>
        </mrow>
       </mfrac>
      </mrow>
      <mo>)</mo>
     </mrow>
     <mi>l</mi>
    </msub>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <minus></minus>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <times></times>
       <ci>ρ</ci>
       <ci>𝐮</ci>
       <ci>ϕ</ci>
       <ci>A</ci>
      </apply>
      <ci>r</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <times></times>
       <ci>ρ</ci>
       <ci>𝐮</ci>
       <ci>ϕ</ci>
       <ci>A</ci>
      </apply>
      <ci>l</ci>
     </apply>
    </apply>
    <apply>
     <minus></minus>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <times></times>
       <ci>normal-Γ</ci>
       <ci>A</ci>
       <apply>
        <divide></divide>
        <apply>
         <partialdiff></partialdiff>
         <ci>ϕ</ci>
        </apply>
        <apply>
         <partialdiff></partialdiff>
         <ci>x</ci>
        </apply>
       </apply>
      </apply>
      <ci>r</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <times></times>
       <ci>normal-Γ</ci>
       <ci>A</ci>
       <apply>
        <divide></divide>
        <apply>
         <partialdiff></partialdiff>
         <ci>ϕ</ci>
        </apply>
        <apply>
         <partialdiff></partialdiff>
         <ci>x</ci>
        </apply>
       </apply>
      </apply>
      <ci>l</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (\rho\mathbf{u}\phi A)_{r}-(\rho\mathbf{u}\phi A)_{l}=\left(\Gamma A\frac{%
\partial\phi}{\partial x}\right)_{r}-\left(\Gamma A\frac{\partial\phi}{%
\partial x}\right)_{l}
  </annotation>
 </semantics>
</math>

</p>
<figure><b>(Figure)</b>
<figcaption>A picture showing the control volume with velocities at the faces,nodes and the distance between them, where 'P' is the node at the center.</figcaption>
</figure>

<p>Assuming</p>

<p>

<math display="block" id="Total_variation_diminishing:17">
 <semantics>
  <mrow>
   <mfrac>
    <mrow>
     <mo>∂</mo>
     <mi>ϕ</mi>
    </mrow>
    <mrow>
     <mo>∂</mo>
     <mi>x</mi>
    </mrow>
   </mfrac>
   <mo>=</mo>
   <mfrac>
    <mrow>
     <mi>δ</mi>
     <mi>ϕ</mi>
    </mrow>
    <mrow>
     <mi>δ</mi>
     <mi>x</mi>
    </mrow>
   </mfrac>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <divide></divide>
     <apply>
      <partialdiff></partialdiff>
      <ci>ϕ</ci>
     </apply>
     <apply>
      <partialdiff></partialdiff>
      <ci>x</ci>
     </apply>
    </apply>
    <apply>
     <divide></divide>
     <apply>
      <times></times>
      <ci>δ</ci>
      <ci>ϕ</ci>
     </apply>
     <apply>
      <times></times>
      <ci>δ</ci>
      <ci>x</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \frac{\partial\phi}{\partial x}=\frac{\delta\phi}{\delta x}
  </annotation>
 </semantics>
</math>

 and</p>

<p>

<math display="block" id="Total_variation_diminishing:18">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>A</mi>
     <mi>r</mi>
    </msub>
    <mo>=</mo>
    <msub>
     <mi>A</mi>
     <mi>l</mi>
    </msub>
   </mrow>
   <mo>;</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>A</ci>
     <ci>r</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>A</ci>
     <ci>l</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A_{r}=A_{l};\,
  </annotation>
 </semantics>
</math>

</p>

<p>The equation reduces to</p>

<p>

<math display="block" id="Total_variation_diminishing:19">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <msub>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mi>ρ</mi>
        <mi>𝐮</mi>
        <mi>ϕ</mi>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
      <mi>r</mi>
     </msub>
     <mo>-</mo>
     <mpadded width="+1.7pt">
      <msub>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mi>ρ</mi>
         <mi>𝐮</mi>
         <mi>ϕ</mi>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
       <mi>l</mi>
      </msub>
     </mpadded>
    </mrow>
    <mo>=</mo>
    <mrow>
     <msub>
      <mrow>
       <mo>(</mo>
       <mrow>
        <mfrac>
         <mi mathvariant="normal">Γ</mi>
         <mrow>
          <mi>δ</mi>
          <mi>x</mi>
         </mrow>
        </mfrac>
        <mi>δ</mi>
        <mi>ϕ</mi>
       </mrow>
       <mo>)</mo>
      </mrow>
      <mi>r</mi>
     </msub>
     <mo>-</mo>
     <msub>
      <mrow>
       <mo>(</mo>
       <mrow>
        <mfrac>
         <mi mathvariant="normal">Γ</mi>
         <mrow>
          <mi>δ</mi>
          <mi>x</mi>
         </mrow>
        </mfrac>
        <mi>δ</mi>
        <mi>ϕ</mi>
       </mrow>
       <mo>)</mo>
      </mrow>
      <mi>l</mi>
     </msub>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <minus></minus>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <times></times>
       <ci>ρ</ci>
       <ci>𝐮</ci>
       <ci>ϕ</ci>
      </apply>
      <ci>r</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <times></times>
       <ci>ρ</ci>
       <ci>𝐮</ci>
       <ci>ϕ</ci>
      </apply>
      <ci>l</ci>
     </apply>
    </apply>
    <apply>
     <minus></minus>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <times></times>
       <apply>
        <divide></divide>
        <ci>normal-Γ</ci>
        <apply>
         <times></times>
         <ci>δ</ci>
         <ci>x</ci>
        </apply>
       </apply>
       <ci>δ</ci>
       <ci>ϕ</ci>
      </apply>
      <ci>r</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <times></times>
       <apply>
        <divide></divide>
        <ci>normal-Γ</ci>
        <apply>
         <times></times>
         <ci>δ</ci>
         <ci>x</ci>
        </apply>
       </apply>
       <ci>δ</ci>
       <ci>ϕ</ci>
      </apply>
      <ci>l</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (\rho\mathbf{u}\phi)_{r}-(\rho\mathbf{u}\phi)_{l}\,=\left(\frac{\Gamma}{\delta
x%
}\delta\phi\right)_{r}-\left(\frac{\Gamma}{\delta x}\delta\phi\right)_{l}.
  </annotation>
 </semantics>
</math>

</p>

<p>Say,</p>

<p>

<math display="block" id="Total_variation_diminishing:20">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <msub>
      <mi>F</mi>
      <mi>r</mi>
     </msub>
     <mo>=</mo>
     <msub>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mi>ρ</mi>
        <mi>𝐮</mi>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
      <mi>r</mi>
     </msub>
    </mrow>
    <mo>;</mo>
    <mrow>
     <mrow>
      <mtext>and</mtext>
      <msub>
       <mi>F</mi>
       <mi>l</mi>
      </msub>
     </mrow>
     <mo>=</mo>
     <msub>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mi>ρ</mi>
        <mi>𝐮</mi>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
      <mi>l</mi>
     </msub>
    </mrow>
   </mrow>
   <mo>;</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>F</ci>
      <ci>r</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <times></times>
       <ci>ρ</ci>
       <ci>𝐮</ci>
      </apply>
      <ci>r</ci>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <apply>
      <times></times>
      <mtext>and</mtext>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>F</ci>
       <ci>l</ci>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <times></times>
       <ci>ρ</ci>
       <ci>𝐮</ci>
      </apply>
      <ci>l</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   F_{r}=(\rho\mathbf{u})_{r};\text{ and }F_{l}=(\rho\mathbf{u})_{l};
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Total_variation_diminishing:21">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <msub>
      <mi>D</mi>
      <mi>l</mi>
     </msub>
     <mo>=</mo>
     <msub>
      <mrow>
       <mo>(</mo>
       <mfrac>
        <mi mathvariant="normal">Γ</mi>
        <mrow>
         <mi>δ</mi>
         <mi>x</mi>
        </mrow>
       </mfrac>
       <mo>)</mo>
      </mrow>
      <mi>l</mi>
     </msub>
    </mrow>
    <mo rspace="22.5pt">;</mo>
    <mrow>
     <msub>
      <mi>D</mi>
      <mi>r</mi>
     </msub>
     <mo>=</mo>
     <msub>
      <mrow>
       <mo>(</mo>
       <mfrac>
        <mi mathvariant="normal">Γ</mi>
        <mrow>
         <mi>δ</mi>
         <mi>x</mi>
        </mrow>
       </mfrac>
       <mo>)</mo>
      </mrow>
      <mi>r</mi>
     </msub>
    </mrow>
   </mrow>
   <mo>;</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>D</ci>
      <ci>l</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <divide></divide>
       <ci>normal-Γ</ci>
       <apply>
        <times></times>
        <ci>δ</ci>
        <ci>x</ci>
       </apply>
      </apply>
      <ci>l</ci>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>D</ci>
      <ci>r</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <divide></divide>
       <ci>normal-Γ</ci>
       <apply>
        <times></times>
        <ci>δ</ci>
        <ci>x</ci>
       </apply>
      </apply>
      <ci>r</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   D_{l}=\left(\frac{\Gamma}{\delta x}\right)_{l};\qquad D_{r}=\left(\frac{\Gamma%
}{\delta x}\right)_{r};
  </annotation>
 </semantics>
</math>

</p>

<p>From the figure:</p>

<p>

<math display="block" id="Total_variation_diminishing:22">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mrow>
      <mi>δ</mi>
      <msub>
       <mi>ϕ</mi>
       <mi>r</mi>
      </msub>
     </mrow>
     <mo>=</mo>
     <mrow>
      <msub>
       <mi>ϕ</mi>
       <mi>R</mi>
      </msub>
      <mo>-</mo>
      <msub>
       <mi>ϕ</mi>
       <mi>P</mi>
      </msub>
     </mrow>
    </mrow>
    <mo>;</mo>
    <mrow>
     <mrow>
      <mtext>and</mtext>
      <mi>δ</mi>
      <msub>
       <mi>x</mi>
       <mi>r</mi>
      </msub>
     </mrow>
     <mo>=</mo>
     <msub>
      <mi>x</mi>
      <mrow>
       <mi>P</mi>
       <mi>R</mi>
      </mrow>
     </msub>
    </mrow>
   </mrow>
   <mo>;</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <eq></eq>
     <apply>
      <times></times>
      <ci>δ</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>ϕ</ci>
       <ci>r</ci>
      </apply>
     </apply>
     <apply>
      <minus></minus>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>ϕ</ci>
       <ci>R</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>ϕ</ci>
       <ci>P</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <apply>
      <times></times>
      <mtext>and</mtext>
      <ci>δ</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <ci>r</ci>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <apply>
       <times></times>
       <ci>P</ci>
       <ci>R</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \delta\phi_{r}=\phi_{R}-\phi_{P};\text{ and }\delta x_{r}=x_{PR};
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Total_variation_diminishing:23">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mrow>
      <mi>δ</mi>
      <msub>
       <mi>ϕ</mi>
       <mi>l</mi>
      </msub>
     </mrow>
     <mo>=</mo>
     <mrow>
      <msub>
       <mi>ϕ</mi>
       <mi>P</mi>
      </msub>
      <mo>-</mo>
      <msub>
       <mi>ϕ</mi>
       <mi>L</mi>
      </msub>
     </mrow>
    </mrow>
    <mo>;</mo>
    <mrow>
     <mrow>
      <mtext>and</mtext>
      <mi>δ</mi>
      <msub>
       <mi>x</mi>
       <mi>l</mi>
      </msub>
     </mrow>
     <mo>=</mo>
     <msub>
      <mi>x</mi>
      <mrow>
       <mi>L</mi>
       <mi>P</mi>
      </mrow>
     </msub>
    </mrow>
   </mrow>
   <mo>;</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <eq></eq>
     <apply>
      <times></times>
      <ci>δ</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>ϕ</ci>
       <ci>l</ci>
      </apply>
     </apply>
     <apply>
      <minus></minus>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>ϕ</ci>
       <ci>P</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>ϕ</ci>
       <ci>L</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <apply>
      <times></times>
      <mtext>and</mtext>
      <ci>δ</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <ci>l</ci>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <apply>
       <times></times>
       <ci>L</ci>
       <ci>P</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \delta\phi_{l}=\phi_{P}-\phi_{L};\text{ and }\delta x_{l}=x_{LP};
  </annotation>
 </semantics>
</math>

</p>

<p>The equation becomes, 

<math display="inline" id="Total_variation_diminishing:24">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mrow>
      <msub>
       <mi>F</mi>
       <mi>r</mi>
      </msub>
      <msub>
       <mi>ϕ</mi>
       <mi>r</mi>
      </msub>
     </mrow>
     <mo>-</mo>
     <mrow>
      <msub>
       <mi>F</mi>
       <mi>l</mi>
      </msub>
      <msub>
       <mi>ϕ</mi>
       <mi>l</mi>
      </msub>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mrow>
      <msub>
       <mi>D</mi>
       <mi>r</mi>
      </msub>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <msub>
         <mi>ϕ</mi>
         <mi>R</mi>
        </msub>
        <mo>-</mo>
        <msub>
         <mi>ϕ</mi>
         <mi>P</mi>
        </msub>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo>-</mo>
     <mrow>
      <msub>
       <mi>D</mi>
       <mi>l</mi>
      </msub>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <msub>
         <mi>ϕ</mi>
         <mi>P</mi>
        </msub>
        <mo>-</mo>
        <msub>
         <mi>ϕ</mi>
         <mi>L</mi>
        </msub>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>;</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <minus></minus>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>F</ci>
       <ci>r</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>ϕ</ci>
       <ci>r</ci>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>F</ci>
       <ci>l</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>ϕ</ci>
       <ci>l</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <minus></minus>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>D</ci>
       <ci>r</ci>
      </apply>
      <apply>
       <minus></minus>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>ϕ</ci>
        <ci>R</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>ϕ</ci>
        <ci>P</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>D</ci>
       <ci>l</ci>
      </apply>
      <apply>
       <minus></minus>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>ϕ</ci>
        <ci>P</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>ϕ</ci>
        <ci>L</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   F_{r}\phi_{r}-F_{l}\phi_{l}=D_{r}(\phi_{R}-\phi_{P})-D_{l}(\phi_{P}-\phi_{L});
  </annotation>
 </semantics>
</math>

</p>

<p>Also the continuity equation has to be satisfied,</p>

<p>

<math display="block" id="Total_variation_diminishing:25">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mrow>
      <msub>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mi>ρ</mi>
         <mi>𝐮</mi>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
       <mi>r</mi>
      </msub>
      <mo>-</mo>
      <mpadded width="+1.7pt">
       <msub>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <mi>ρ</mi>
          <mi>𝐮</mi>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
        <mi>l</mi>
       </msub>
      </mpadded>
     </mrow>
     <mo>=</mo>
     <mn>0</mn>
    </mrow>
    <mo>;</mo>
    <mrow>
     <mrow>
      <mrow>
       <mrow>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <mi>O</mi>
          <mi>R</mi>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
        <msub>
         <mi>F</mi>
         <mi>r</mi>
        </msub>
       </mrow>
       <mo>-</mo>
       <msub>
        <mi>F</mi>
        <mi>l</mi>
       </msub>
      </mrow>
      <mo>=</mo>
      <mn>0</mn>
     </mrow>
     <mo>;</mo>
     <mrow>
      <mrow>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mi>O</mi>
         <mi>R</mi>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
       <msub>
        <mi>F</mi>
        <mi>r</mi>
       </msub>
      </mrow>
      <mo>=</mo>
      <msub>
       <mi>F</mi>
       <mi>l</mi>
      </msub>
      <mo>=</mo>
      <mi>F</mi>
     </mrow>
    </mrow>
   </mrow>
   <mo>;</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <eq></eq>
     <apply>
      <minus></minus>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <apply>
        <times></times>
        <ci>ρ</ci>
        <ci>𝐮</ci>
       </apply>
       <ci>r</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <apply>
        <times></times>
        <ci>ρ</ci>
        <ci>𝐮</ci>
       </apply>
       <ci>l</ci>
      </apply>
     </apply>
     <cn type="integer">0</cn>
    </apply>
    <apply>
     <csymbol cd="ambiguous">formulae-sequence</csymbol>
     <apply>
      <eq></eq>
      <apply>
       <minus></minus>
       <apply>
        <times></times>
        <apply>
         <times></times>
         <ci>O</ci>
         <ci>R</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>F</ci>
         <ci>r</ci>
        </apply>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>F</ci>
        <ci>l</ci>
       </apply>
      </apply>
      <cn type="integer">0</cn>
     </apply>
     <apply>
      <and></and>
      <apply>
       <eq></eq>
       <apply>
        <times></times>
        <apply>
         <times></times>
         <ci>O</ci>
         <ci>R</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>F</ci>
         <ci>r</ci>
        </apply>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>F</ci>
        <ci>l</ci>
       </apply>
      </apply>
      <apply>
       <eq></eq>
       <share href="#.cmml">
       </share>
       <ci>F</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (\rho\mathbf{u})_{r}-(\rho\mathbf{u})_{l}\,=0;(OR)F_{r}-F_{l}=0;(OR)F_{r}=F_{l%
}=F;
  </annotation>
 </semantics>
</math>

</p>

<p>Assuming diffusivity is a homogeneous property and equal grid spacing we can say</p>

<p>

<math display="block" id="Total_variation_diminishing:26">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi mathvariant="normal">Γ</mi>
     <mi>l</mi>
    </msub>
    <mo>=</mo>
    <msub>
     <mi mathvariant="normal">Γ</mi>
     <mi>r</mi>
    </msub>
   </mrow>
   <mo rspace="22.5pt">;</mo>
   <mrow>
    <mrow>
     <mi>δ</mi>
     <msub>
      <mi>x</mi>
      <mrow>
       <mi>L</mi>
       <mi>P</mi>
      </mrow>
     </msub>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mi>δ</mi>
     <msub>
      <mi>x</mi>
      <mrow>
       <mi>P</mi>
       <mi>R</mi>
      </mrow>
     </msub>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mi>δ</mi>
     <mi>x</mi>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>normal-Γ</ci>
      <ci>l</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>normal-Γ</ci>
      <ci>r</ci>
     </apply>
    </apply>
    <apply>
     <and></and>
     <apply>
      <eq></eq>
      <apply>
       <times></times>
       <ci>δ</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <apply>
         <times></times>
         <ci>L</ci>
         <ci>P</ci>
        </apply>
       </apply>
      </apply>
      <apply>
       <times></times>
       <ci>δ</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <apply>
         <times></times>
         <ci>P</ci>
         <ci>R</ci>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <eq></eq>
      <share href="#.cmml">
      </share>
      <apply>
       <times></times>
       <ci>δ</ci>
       <ci>x</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Gamma_{l}=\Gamma_{r};\qquad\delta x_{LP}=\delta x_{PR}=\delta x
  </annotation>
 </semantics>
</math>

</p>

<p>we get 

<math display="inline" id="Total_variation_diminishing:27">
 <semantics>
  <mrow>
   <msub>
    <mi>D</mi>
    <mi>l</mi>
   </msub>
   <mo>=</mo>
   <msub>
    <mi>D</mi>
    <mi>r</mi>
   </msub>
   <mo>=</mo>
   <mi>D</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>D</ci>
      <ci>l</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>D</ci>
      <ci>r</ci>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <ci>D</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   D_{l}=D_{r}=D
  </annotation>
 </semantics>
</math>

 The equation further reduces to 

<math display="inline" id="Total_variation_diminishing:28">
 <semantics>
  <mrow>
   <mrow>
    <mi>F</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <msub>
       <mi>ϕ</mi>
       <mi>r</mi>
      </msub>
      <mo>-</mo>
      <msub>
       <mi>ϕ</mi>
       <mi>l</mi>
      </msub>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mi>D</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mrow>
       <msub>
        <mi>ϕ</mi>
        <mi>R</mi>
       </msub>
       <mo>-</mo>
       <mrow>
        <mn>2</mn>
        <msub>
         <mi>ϕ</mi>
         <mi>P</mi>
        </msub>
       </mrow>
      </mrow>
      <mo>+</mo>
      <msub>
       <mi>ϕ</mi>
       <mi>L</mi>
      </msub>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>F</ci>
     <apply>
      <minus></minus>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>ϕ</ci>
       <ci>r</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>ϕ</ci>
       <ci>l</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <times></times>
     <ci>D</ci>
     <apply>
      <plus></plus>
      <apply>
       <minus></minus>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>ϕ</ci>
        <ci>R</ci>
       </apply>
       <apply>
        <times></times>
        <cn type="integer">2</cn>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>ϕ</ci>
         <ci>P</ci>
        </apply>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>ϕ</ci>
       <ci>L</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   F(\phi_{r}-\phi_{l})=D(\phi_{R}-2\phi_{P}+\phi_{L})
  </annotation>
 </semantics>
</math>

 This can be written as 

<math display="inline" id="Total_variation_diminishing:29">
 <semantics>
  <mrow>
   <mrow>
    <mi>P</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <msub>
       <mi>ϕ</mi>
       <mi>r</mi>
      </msub>
      <mo>-</mo>
      <msub>
       <mi>ϕ</mi>
       <mi>l</mi>
      </msub>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mo stretchy="false">(</mo>
    <mrow>
     <mrow>
      <msub>
       <mi>ϕ</mi>
       <mi>R</mi>
      </msub>
      <mo>-</mo>
      <mrow>
       <mn>2</mn>
       <msub>
        <mi>ϕ</mi>
        <mi>P</mi>
       </msub>
      </mrow>
     </mrow>
     <mo>+</mo>
     <msub>
      <mi>ϕ</mi>
      <mi>L</mi>
     </msub>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>P</ci>
     <apply>
      <minus></minus>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>ϕ</ci>
       <ci>r</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>ϕ</ci>
       <ci>l</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <minus></minus>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>ϕ</ci>
       <ci>R</ci>
      </apply>
      <apply>
       <times></times>
       <cn type="integer">2</cn>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>ϕ</ci>
        <ci>P</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>ϕ</ci>
      <ci>L</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   P(\phi_{r}-\phi_{l})=(\phi_{R}-2\phi_{P}+\phi_{L})
  </annotation>
 </semantics>
</math>

, where <em>P</em> is the <a href="Péclet_number" title="wikilink">Péclet number</a>.</p>

<p>

<math display="block" id="Total_variation_diminishing:30">
 <semantics>
  <mrow>
   <mrow>
    <mi>P</mi>
    <mo>=</mo>
    <mfrac>
     <mi>F</mi>
     <mi>D</mi>
    </mfrac>
    <mo>=</mo>
    <mfrac>
     <mrow>
      <mi>ρ</mi>
      <mi>𝐮</mi>
      <mi>δ</mi>
      <mi>x</mi>
     </mrow>
     <mi mathvariant="normal">Γ</mi>
    </mfrac>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <ci>P</ci>
     <apply>
      <divide></divide>
      <ci>F</ci>
      <ci>D</ci>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <divide></divide>
      <apply>
       <times></times>
       <ci>ρ</ci>
       <ci>𝐮</ci>
       <ci>δ</ci>
       <ci>x</ci>
      </apply>
      <ci>normal-Γ</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   P=\frac{F}{D}=\frac{\rho\mathbf{u}\delta x}{\Gamma}.
  </annotation>
 </semantics>
</math>

</p>
<h2 id="tvd-scheme">TVD scheme</h2>

<p>Total variation diminishing scheme<a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a><a class="footnoteRef" href="#fn3" id="fnref3"><sup>3</sup></a> makes an assumption for the values of 

<math display="inline" id="Total_variation_diminishing:31">
 <semantics>
  <msub>
   <mi>ϕ</mi>
   <mi>r</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>ϕ</ci>
    <ci>r</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \phi_{r}
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Total_variation_diminishing:32">
 <semantics>
  <msub>
   <mi>ϕ</mi>
   <mi>l</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>ϕ</ci>
    <ci>l</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \phi_{l}
  </annotation>
 </semantics>
</math>

 to be substituted in the discretized equation as follows:</p>

<p>

<math display="block" id="Total_variation_diminishing:33">
 <semantics>
  <mrow>
   <mrow>
    <mi>P</mi>
    <msub>
     <mi>ϕ</mi>
     <mi>r</mi>
    </msub>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mfrac>
      <mn>1</mn>
      <mn>2</mn>
     </mfrac>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mi>P</mi>
       <mo>+</mo>
       <mrow>
        <mo stretchy="false">|</mo>
        <mi>P</mi>
        <mo stretchy="false">|</mo>
       </mrow>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <mrow>
      <mo stretchy="false">[</mo>
      <mrow>
       <mrow>
        <msubsup>
         <mi>f</mi>
         <mi>r</mi>
         <mo>+</mo>
        </msubsup>
        <msub>
         <mi>ϕ</mi>
         <mi>R</mi>
        </msub>
       </mrow>
       <mo>+</mo>
       <mrow>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <mn>1</mn>
          <mo>-</mo>
          <msubsup>
           <mi>f</mi>
           <mi>r</mi>
           <mo>+</mo>
          </msubsup>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
        <msub>
         <mi>ϕ</mi>
         <mi>L</mi>
        </msub>
       </mrow>
      </mrow>
      <mo stretchy="false">]</mo>
     </mrow>
    </mrow>
    <mo>+</mo>
    <mrow>
     <mfrac>
      <mn>1</mn>
      <mn>2</mn>
     </mfrac>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mi>P</mi>
       <mo>-</mo>
       <mrow>
        <mo stretchy="false">|</mo>
        <mi>P</mi>
        <mo stretchy="false">|</mo>
       </mrow>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <mrow>
      <mo stretchy="false">[</mo>
      <mrow>
       <mrow>
        <msubsup>
         <mi>f</mi>
         <mi>r</mi>
         <mo>-</mo>
        </msubsup>
        <msub>
         <mi>ϕ</mi>
         <mi>P</mi>
        </msub>
       </mrow>
       <mo>+</mo>
       <mrow>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <mn>1</mn>
          <mo>-</mo>
          <msubsup>
           <mi>f</mi>
           <mi>r</mi>
           <mo>-</mo>
          </msubsup>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
        <msub>
         <mi>ϕ</mi>
         <mrow>
          <mi>R</mi>
          <mi>R</mi>
         </mrow>
        </msub>
       </mrow>
      </mrow>
      <mo stretchy="false">]</mo>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>P</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>ϕ</ci>
      <ci>r</ci>
     </apply>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <plus></plus>
       <ci>P</ci>
       <apply>
        <abs></abs>
        <ci>P</ci>
       </apply>
      </apply>
      <apply>
       <csymbol cd="latexml">delimited-[]</csymbol>
       <apply>
        <plus></plus>
        <apply>
         <times></times>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>f</ci>
           <ci>r</ci>
          </apply>
          <plus></plus>
         </apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>ϕ</ci>
          <ci>R</ci>
         </apply>
        </apply>
        <apply>
         <times></times>
         <apply>
          <minus></minus>
          <cn type="integer">1</cn>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <ci>f</ci>
            <ci>r</ci>
           </apply>
           <plus></plus>
          </apply>
         </apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>ϕ</ci>
          <ci>L</ci>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <minus></minus>
       <ci>P</ci>
       <apply>
        <abs></abs>
        <ci>P</ci>
       </apply>
      </apply>
      <apply>
       <csymbol cd="latexml">delimited-[]</csymbol>
       <apply>
        <plus></plus>
        <apply>
         <times></times>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>f</ci>
           <ci>r</ci>
          </apply>
          <minus></minus>
         </apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>ϕ</ci>
          <ci>P</ci>
         </apply>
        </apply>
        <apply>
         <times></times>
         <apply>
          <minus></minus>
          <cn type="integer">1</cn>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <ci>f</ci>
            <ci>r</ci>
           </apply>
           <minus></minus>
          </apply>
         </apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>ϕ</ci>
          <apply>
           <times></times>
           <ci>R</ci>
           <ci>R</ci>
          </apply>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   P\phi_{r}=\frac{1}{2}(P+|P|)[f_{r}^{+}\phi_{R}+(1-f_{r}^{+})\phi_{L}]+\frac{1}%
{2}(P-|P|)[f_{r}^{-}\phi_{P}+(1-f_{r}^{-})\phi_{RR}]
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Total_variation_diminishing:34">
 <semantics>
  <mrow>
   <mrow>
    <mi>P</mi>
    <msub>
     <mi>ϕ</mi>
     <mi>l</mi>
    </msub>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mfrac>
      <mn>1</mn>
      <mn>2</mn>
     </mfrac>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mi>P</mi>
       <mo>+</mo>
       <mrow>
        <mo stretchy="false">|</mo>
        <mi>P</mi>
        <mo stretchy="false">|</mo>
       </mrow>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <mrow>
      <mo stretchy="false">[</mo>
      <mrow>
       <mrow>
        <msubsup>
         <mi>f</mi>
         <mi>l</mi>
         <mo>+</mo>
        </msubsup>
        <msub>
         <mi>ϕ</mi>
         <mi>P</mi>
        </msub>
       </mrow>
       <mo>+</mo>
       <mrow>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <mn>1</mn>
          <mo>-</mo>
          <msubsup>
           <mi>f</mi>
           <mi>l</mi>
           <mo>+</mo>
          </msubsup>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
        <msub>
         <mi>ϕ</mi>
         <mrow>
          <mi>L</mi>
          <mi>L</mi>
         </mrow>
        </msub>
       </mrow>
      </mrow>
      <mo stretchy="false">]</mo>
     </mrow>
    </mrow>
    <mo>+</mo>
    <mrow>
     <mfrac>
      <mn>1</mn>
      <mn>2</mn>
     </mfrac>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mi>P</mi>
       <mo>-</mo>
       <mrow>
        <mo stretchy="false">|</mo>
        <mi>P</mi>
        <mo stretchy="false">|</mo>
       </mrow>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <mrow>
      <mo stretchy="false">[</mo>
      <mrow>
       <mrow>
        <msubsup>
         <mi>f</mi>
         <mi>l</mi>
         <mo>-</mo>
        </msubsup>
        <msub>
         <mi>ϕ</mi>
         <mi>L</mi>
        </msub>
       </mrow>
       <mo>+</mo>
       <mrow>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <mn>1</mn>
          <mo>-</mo>
          <msubsup>
           <mi>f</mi>
           <mi>l</mi>
           <mo>-</mo>
          </msubsup>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
        <msub>
         <mi>ϕ</mi>
         <mi>R</mi>
        </msub>
       </mrow>
      </mrow>
      <mo stretchy="false">]</mo>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>P</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>ϕ</ci>
      <ci>l</ci>
     </apply>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <plus></plus>
       <ci>P</ci>
       <apply>
        <abs></abs>
        <ci>P</ci>
       </apply>
      </apply>
      <apply>
       <csymbol cd="latexml">delimited-[]</csymbol>
       <apply>
        <plus></plus>
        <apply>
         <times></times>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>f</ci>
           <ci>l</ci>
          </apply>
          <plus></plus>
         </apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>ϕ</ci>
          <ci>P</ci>
         </apply>
        </apply>
        <apply>
         <times></times>
         <apply>
          <minus></minus>
          <cn type="integer">1</cn>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <ci>f</ci>
            <ci>l</ci>
           </apply>
           <plus></plus>
          </apply>
         </apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>ϕ</ci>
          <apply>
           <times></times>
           <ci>L</ci>
           <ci>L</ci>
          </apply>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <minus></minus>
       <ci>P</ci>
       <apply>
        <abs></abs>
        <ci>P</ci>
       </apply>
      </apply>
      <apply>
       <csymbol cd="latexml">delimited-[]</csymbol>
       <apply>
        <plus></plus>
        <apply>
         <times></times>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>f</ci>
           <ci>l</ci>
          </apply>
          <minus></minus>
         </apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>ϕ</ci>
          <ci>L</ci>
         </apply>
        </apply>
        <apply>
         <times></times>
         <apply>
          <minus></minus>
          <cn type="integer">1</cn>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <ci>f</ci>
            <ci>l</ci>
           </apply>
           <minus></minus>
          </apply>
         </apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>ϕ</ci>
          <ci>R</ci>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   P\phi_{l}=\frac{1}{2}(P+|P|)[f_{l}^{+}\phi_{P}+(1-f_{l}^{+})\phi_{LL}]+\frac{1%
}{2}(P-|P|)[f_{l}^{-}\phi_{L}+(1-f_{l}^{-})\phi_{R}]
  </annotation>
 </semantics>
</math>

</p>

<p>Where 

<math display="inline" id="Total_variation_diminishing:35">
 <semantics>
  <mi>P</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>P</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   P
  </annotation>
 </semantics>
</math>

 is the Peclet number and 

<math display="inline" id="Total_variation_diminishing:36">
 <semantics>
  <mi>f</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>f</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f
  </annotation>
 </semantics>
</math>

 is the weighing function to be determined from,</p>

<p>

<math display="block" id="Total_variation_diminishing:37">
 <semantics>
  <mrow>
   <mi>f</mi>
   <mo>=</mo>
   <mrow>
    <mi>f</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>ϵ</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mi>f</mi>
    <mfrac>
     <mrow>
      <msub>
       <mi>ϕ</mi>
       <mi>U</mi>
      </msub>
      <mo>-</mo>
      <msub>
       <mi>ϕ</mi>
       <mrow>
        <mi>U</mi>
        <mi>U</mi>
       </mrow>
      </msub>
     </mrow>
     <mrow>
      <msub>
       <mi>ϕ</mi>
       <mi>D</mi>
      </msub>
      <mo>-</mo>
      <msub>
       <mi>ϕ</mi>
       <mrow>
        <mi>U</mi>
        <mi>U</mi>
       </mrow>
      </msub>
     </mrow>
    </mfrac>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <ci>f</ci>
     <apply>
      <times></times>
      <ci>f</ci>
      <ci>ϵ</ci>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <ci>f</ci>
      <apply>
       <divide></divide>
       <apply>
        <minus></minus>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>ϕ</ci>
         <ci>U</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>ϕ</ci>
         <apply>
          <times></times>
          <ci>U</ci>
          <ci>U</ci>
         </apply>
        </apply>
       </apply>
       <apply>
        <minus></minus>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>ϕ</ci>
         <ci>D</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>ϕ</ci>
         <apply>
          <times></times>
          <ci>U</ci>
          <ci>U</ci>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f=f(\epsilon)=f\frac{\phi_{U}-\phi_{UU}}{\phi_{D}-\phi_{UU}}
  </annotation>
 </semantics>
</math>

</p>

<p>where U refers to upstream, UU refers to upstream of U and D refers to downstream.</p>

<p>Note that 

<math display="inline" id="Total_variation_diminishing:38">
 <semantics>
  <msup>
   <mi>f</mi>
   <mo>+</mo>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>f</ci>
    <plus></plus>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f^{+}
  </annotation>
 </semantics>
</math>

 is the weighing function when the flow is in positive direction i.e., from left to right and 

<math display="inline" id="Total_variation_diminishing:39">
 <semantics>
  <msup>
   <mi>f</mi>
   <mo>-</mo>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>f</ci>
    <minus></minus>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f^{-}
  </annotation>
 </semantics>
</math>

 is the weighing function when the flow is in the negative direction from right to left. So,</p>

<p>

<math display="inline" id="Total_variation_diminishing:40">
 <semantics>
  <mrow>
   <mrow>
    <msubsup>
     <mi>f</mi>
     <mi>r</mi>
     <mo>+</mo>
    </msubsup>
    <mtext>is a function of</mtext>
    <mstyle displaystyle="true">
     <mfrac>
      <mrow>
       <msub>
        <mi>ϕ</mi>
        <mi>P</mi>
       </msub>
       <mo>-</mo>
       <msub>
        <mi>ϕ</mi>
        <mi>L</mi>
       </msub>
      </mrow>
      <mrow>
       <msub>
        <mi>ϕ</mi>
        <mi>R</mi>
       </msub>
       <mo>-</mo>
       <msub>
        <mi>ϕ</mi>
        <mi>L</mi>
       </msub>
      </mrow>
     </mfrac>
    </mstyle>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>f</ci>
      <ci>r</ci>
     </apply>
     <plus></plus>
    </apply>
    <mtext>is a function of</mtext>
    <apply>
     <divide></divide>
     <apply>
      <minus></minus>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>ϕ</ci>
       <ci>P</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>ϕ</ci>
       <ci>L</ci>
      </apply>
     </apply>
     <apply>
      <minus></minus>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>ϕ</ci>
       <ci>R</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>ϕ</ci>
       <ci>L</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle f_{r}^{+}\text{ is a function of }\dfrac{\phi_{P}-\phi_{L}}{\phi%
_{R}-\phi_{L}}.
  </annotation>
 </semantics>
</math>


</p>

<p>If the flow is in positive direction then, peclet number 

<math display="inline" id="Total_variation_diminishing:41">
 <semantics>
  <mi>P</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>P</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   P
  </annotation>
 </semantics>
</math>

 is positive and the term 

<math display="inline" id="Total_variation_diminishing:42">
 <semantics>
  <mrow>
   <mrow>
    <mo stretchy="false">(</mo>
    <mrow>
     <mi>P</mi>
     <mo>-</mo>
     <mrow>
      <mo stretchy="false">|</mo>
      <mi>P</mi>
      <mo stretchy="false">|</mo>
     </mrow>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>=</mo>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <minus></minus>
     <ci>P</ci>
     <apply>
      <abs></abs>
      <ci>P</ci>
     </apply>
    </apply>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (P-|P|)=0
  </annotation>
 </semantics>
</math>

, so the function 

<math display="inline" id="Total_variation_diminishing:43">
 <semantics>
  <msup>
   <mi>f</mi>
   <mo>-</mo>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>f</ci>
    <minus></minus>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f^{-}
  </annotation>
 </semantics>
</math>

 won’t play any role in the assumption of Ør and Øl. Likewise when the flow is in negative direction, 

<math display="inline" id="Total_variation_diminishing:44">
 <semantics>
  <mi>P</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>P</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   P
  </annotation>
 </semantics>
</math>

 is negative and the term 

<math display="inline" id="Total_variation_diminishing:45">
 <semantics>
  <mrow>
   <mrow>
    <mo stretchy="false">(</mo>
    <mrow>
     <mi>P</mi>
     <mo>+</mo>
     <mrow>
      <mo stretchy="false">|</mo>
      <mi>P</mi>
      <mo stretchy="false">|</mo>
     </mrow>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>=</mo>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <plus></plus>
     <ci>P</ci>
     <apply>
      <abs></abs>
      <ci>P</ci>
     </apply>
    </apply>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (P+|P|)=0
  </annotation>
 </semantics>
</math>

, so the function 

<math display="inline" id="Total_variation_diminishing:46">
 <semantics>
  <msup>
   <mi>f</mi>
   <mo>+</mo>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>f</ci>
    <plus></plus>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f^{+}
  </annotation>
 </semantics>
</math>

 won’t play any role in the assumption of 

<math display="inline" id="Total_variation_diminishing:47">
 <semantics>
  <msub>
   <mi>ϕ</mi>
   <mi>r</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>ϕ</ci>
    <ci>r</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \phi_{r}
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Total_variation_diminishing:48">
 <semantics>
  <msub>
   <mi>ϕ</mi>
   <mi>r</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>ϕ</ci>
    <ci>r</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \phi_{r}
  </annotation>
 </semantics>
</math>

.</p>

<p>It therefore takes into account the values of property depending on the direction of flow and using the weighted functions tries to achieve monotonicity in the solution thereby producing results with no spurious shocks.</p>
<h2 id="limitations">Limitations</h2>

<p>Monotone schemes are attractive for solving engineering and scientific problems because they do not produce non-physical solutions. <a href="Godunov's_theorem" title="wikilink">Godunov's theorem</a> proves that linear schemes which preserve monotonicity are, at most, only first order accurate. Higher order linear schemes, although more accurate for smooth solutions, are not TVD and tend to introduce spurious oscillations (wiggles) where discontinuities or shocks arise. To overcome these drawbacks, various <a href="high-resolution_scheme" title="wikilink">high-resolution</a>, <a class="uri" href="non-linear" title="wikilink">non-linear</a> techniques have been developed, often using <a href="flux_limiter" title="wikilink">flux/slope limiters</a>.</p>
<h2 id="see-also">See also</h2>
<ul>
<li><a href="Flux_limiters" title="wikilink">Flux limiters</a></li>
<li><a href="Godunov's_theorem" title="wikilink">Godunov's theorem</a></li>
<li><a href="High-resolution_scheme" title="wikilink">High-resolution scheme</a></li>
<li><a href="MUSCL_scheme" title="wikilink">MUSCL scheme</a></li>
<li><a href="Sergei_K._Godunov" title="wikilink">Sergei K. Godunov</a></li>
<li><a href="Total_variation" title="wikilink">Total variation</a></li>
</ul>
<h2 id="references">References</h2>
<h2 id="further-reading">Further reading</h2>
<ul>
<li>Hirsch, C. (1990), <em>Numerical Computation of Internal and External Flows</em>, Vol 2, Wiley.</li>
<li>Laney, C. B. (1998), <em>Computational Gas Dynamics</em>, Cambridge University Press.</li>
<li>Toro, E. F. (1999), <em>Riemann Solvers and Numerical Methods for Fluid Dynamics</em>, Springer-Verlag.</li>
<li>Tannehill, J. C., <a href="Dale_A._Anderson" title="wikilink">Anderson, D. A.</a>, and Pletcher, R. H. (1997), <em>Computational Fluid Mechanics and Heat Transfer</em>, 2nd Ed., Taylor &amp; Francis.</li>
<li>Wesseling, P. (2001), <em>Principles of Computational Fluid Dynamics</em>, Springer-Verlag.</li>
<li>Anil W. Date <em>Introduction to Computational Fluid Dynamics</em>, Cambridge University Press.</li>
</ul>

<p>"</p>

<p><a href="Category:Numerical_differential_equations" title="wikilink">Category:Numerical differential equations</a> <a href="Category:Computational_fluid_dynamics" title="wikilink">Category:Computational fluid dynamics</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1"><a href="#fnref1">↩</a></li>
<li id="fn2"><a href="#fnref2">↩</a></li>
<li id="fn3"><a href="#fnref3">↩</a></li>
</ol>
</section>
</body>
</html>

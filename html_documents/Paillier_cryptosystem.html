<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="1180">Paillier cryptosystem</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Paillier cryptosystem</h1>
<hr/>

<p>The <strong>Paillier cryptosystem</strong>, named after and invented by <a href="Pascal_Paillier" title="wikilink">Pascal Paillier</a> in 1999, is a probabilistic <a href="asymmetric_algorithm" title="wikilink">asymmetric algorithm</a> for <a href="public_key_cryptography" title="wikilink">public key cryptography</a>. The problem of computing <em>n</em>-th residue classes is believed to be computationally difficult. The <a href="decisional_composite_residuosity_assumption" title="wikilink">decisional composite residuosity assumption</a> is the <a href="intractability_(complexity)" title="wikilink">intractability</a> hypothesis upon which this cryptosystem is based.</p>

<p>The scheme is an additive <a href="Homomorphic_encryption" title="wikilink">homomorphic</a> cryptosystem; this means that, given only the public-key and the encryption of 

<math display="inline" id="Paillier_cryptosystem:0">
 <semantics>
  <msub>
   <mi>m</mi>
   <mn>1</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>m</ci>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   m_{1}
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Paillier_cryptosystem:1">
 <semantics>
  <msub>
   <mi>m</mi>
   <mn>2</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>m</ci>
    <cn type="integer">2</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   m_{2}
  </annotation>
 </semantics>
</math>

, one can compute the encryption of 

<math display="inline" id="Paillier_cryptosystem:2">
 <semantics>
  <mrow>
   <msub>
    <mi>m</mi>
    <mn>1</mn>
   </msub>
   <mo>+</mo>
   <msub>
    <mi>m</mi>
    <mn>2</mn>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <plus></plus>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>m</ci>
     <cn type="integer">1</cn>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>m</ci>
     <cn type="integer">2</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   m_{1}+m_{2}
  </annotation>
 </semantics>
</math>

.</p>
<h2 id="algorithm">Algorithm</h2>

<p>The scheme works as follows:</p>
<h3 id="key-generation">Key generation</h3>
<ol>
<li>Choose two large <a href="prime_number" title="wikilink">prime numbers</a> <em>p</em> and <em>q</em> randomly and independently of each other such that 

<math display="inline" id="Paillier_cryptosystem:3">
 <semantics>
  <mrow>
   <mrow>
    <mi>gcd</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>p</mi>
      <mi>q</mi>
     </mrow>
     <mo>,</mo>
     <mrow>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mi>p</mi>
        <mo>-</mo>
        <mn>1</mn>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mi>q</mi>
        <mo>-</mo>
        <mn>1</mn>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <gcd></gcd>
     <apply>
      <times></times>
      <ci>p</ci>
      <ci>q</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <minus></minus>
       <ci>p</ci>
       <cn type="integer">1</cn>
      </apply>
      <apply>
       <minus></minus>
       <ci>q</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
    </apply>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \gcd(pq,(p-1)(q-1))=1
  </annotation>
 </semantics>
</math>

. This property is assured if both primes are of equal length.<a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a></li>
<li>Compute 

<math display="inline" id="Paillier_cryptosystem:4">
 <semantics>
  <mrow>
   <mi>n</mi>
   <mo>=</mo>
   <mrow>
    <mi>p</mi>
    <mi>q</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>n</ci>
    <apply>
     <times></times>
     <ci>p</ci>
     <ci>q</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n=pq
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Paillier_cryptosystem:5">
 <semantics>
  <mrow>
   <mi>λ</mi>
   <mo>=</mo>
   <mrow>
    <mo>lcm</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>p</mi>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
     <mo>,</mo>
     <mrow>
      <mi>q</mi>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>λ</ci>
    <apply>
     <ci>lcm</ci>
     <apply>
      <minus></minus>
      <ci>p</ci>
      <cn type="integer">1</cn>
     </apply>
     <apply>
      <minus></minus>
      <ci>q</ci>
      <cn type="integer">1</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \lambda=\operatorname{lcm}(p-1,q-1)
  </annotation>
 </semantics>
</math>

.</li>
<li>Select random integer 

<math display="inline" id="Paillier_cryptosystem:6">
 <semantics>
  <mi>g</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>g</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   g
  </annotation>
 </semantics>
</math>

 where 

<math display="inline" id="Paillier_cryptosystem:7">
 <semantics>
  <mrow>
   <mi>g</mi>
   <mo>∈</mo>
   <msubsup>
    <mi>ℤ</mi>
    <msup>
     <mi>n</mi>
     <mn>2</mn>
    </msup>
    <mo>*</mo>
   </msubsup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <in></in>
    <ci>g</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>ℤ</ci>
      <times></times>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>n</ci>
      <cn type="integer">2</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   g\in\mathbb{Z}^{*}_{n^{2}}
  </annotation>
 </semantics>
</math>

</li>
<li>Ensure 

<math display="inline" id="Paillier_cryptosystem:8">
 <semantics>
  <mi>n</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>n</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n
  </annotation>
 </semantics>
</math>

 divides the order of 

<math display="inline" id="Paillier_cryptosystem:9">
 <semantics>
  <mi>g</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>g</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   g
  </annotation>
 </semantics>
</math>

 by checking the existence of the following <a href="modular_multiplicative_inverse" title="wikilink">modular multiplicative inverse</a>

<math display="block" id="Paillier_cryptosystem:10">
 <semantics>
  <mrow>
   <mi>μ</mi>
   <mo>=</mo>
   <mrow>
    <msup>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mi>L</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <msup>
          <mi>g</mi>
          <mi>λ</mi>
         </msup>
         <mo lspace="2.5pt" rspace="2.5pt">mod</mo>
         <msup>
          <mi>n</mi>
          <mn>2</mn>
         </msup>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <mrow>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </msup>
    <mo lspace="2.5pt" rspace="2.5pt">mod</mo>
    <mi>n</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>μ</ci>
    <apply>
     <csymbol cd="latexml">modulo</csymbol>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <times></times>
       <ci>L</ci>
       <apply>
        <csymbol cd="latexml">modulo</csymbol>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>g</ci>
         <ci>λ</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>n</ci>
         <cn type="integer">2</cn>
        </apply>
       </apply>
      </apply>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <ci>n</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mu=(L(g^{\lambda}\bmod n^{2}))^{-1}\bmod n
  </annotation>
 </semantics>
</math>

,</li>
</ol>
<dl>
<dd>where function 

<math display="inline" id="Paillier_cryptosystem:11">
 <semantics>
  <mi>L</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>L</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   L
  </annotation>
 </semantics>
</math>

 is defined as 

<math display="inline" id="Paillier_cryptosystem:12">
 <semantics>
  <mrow>
   <mrow>
    <mi>L</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>u</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mfrac>
    <mrow>
     <mi>u</mi>
     <mo>-</mo>
     <mn>1</mn>
    </mrow>
    <mi>n</mi>
   </mfrac>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>L</ci>
     <ci>u</ci>
    </apply>
    <apply>
     <divide></divide>
     <apply>
      <minus></minus>
      <ci>u</ci>
      <cn type="integer">1</cn>
     </apply>
     <ci>n</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   L(u)=\frac{u-1}{n}
  </annotation>
 </semantics>
</math>

 .
<dl>
<dd>Note that the notation 

<math display="inline" id="Paillier_cryptosystem:13">
 <semantics>
  <mfrac>
   <mi>a</mi>
   <mi>b</mi>
  </mfrac>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <divide></divide>
    <ci>a</ci>
    <ci>b</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \frac{a}{b}
  </annotation>
 </semantics>
</math>

 does not denote the modular multiplication of 

<math display="inline" id="Paillier_cryptosystem:14">
 <semantics>
  <mi>a</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>a</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a
  </annotation>
 </semantics>
</math>

 times the <a href="modular_multiplicative_inverse" title="wikilink">modular multiplicative inverse</a> of 

<math display="inline" id="Paillier_cryptosystem:15">
 <semantics>
  <mi>b</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>b</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   b
  </annotation>
 </semantics>
</math>

 but rather the <a class="uri" href="quotient" title="wikilink">quotient</a> of 

<math display="inline" id="Paillier_cryptosystem:16">
 <semantics>
  <mi>a</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>a</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a
  </annotation>
 </semantics>
</math>

 divided by 

<math display="inline" id="Paillier_cryptosystem:17">
 <semantics>
  <mi>b</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>b</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   b
  </annotation>
 </semantics>
</math>

, i.e., the largest integer value 

<math display="inline" id="Paillier_cryptosystem:18">
 <semantics>
  <mrow>
   <mi>v</mi>
   <mo>≥</mo>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <geq></geq>
    <ci>v</ci>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   v\geq 0
  </annotation>
 </semantics>
</math>

 to satisfy the relation 

<math display="inline" id="Paillier_cryptosystem:19">
 <semantics>
  <mrow>
   <mi>a</mi>
   <mo>≥</mo>
   <mrow>
    <mi>v</mi>
    <mi>b</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <geq></geq>
    <ci>a</ci>
    <apply>
     <times></times>
     <ci>v</ci>
     <ci>b</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a\geq vb
  </annotation>
 </semantics>
</math>

.
</dd>
</dl>
</dd>
</dl>
<ul>
<li>The public (encryption) key is 

<math display="inline" id="Paillier_cryptosystem:20">
 <semantics>
  <mrow>
   <mo stretchy="false">(</mo>
   <mi>n</mi>
   <mo>,</mo>
   <mi>g</mi>
   <mo stretchy="false">)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <interval closure="open">
    <ci>n</ci>
    <ci>g</ci>
   </interval>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (n,g)
  </annotation>
 </semantics>
</math>

.</li>
<li>The private (decryption) key is 

<math display="inline" id="Paillier_cryptosystem:21">
 <semantics>
  <mrow>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>λ</mi>
    <mo>,</mo>
    <mi>μ</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <interval closure="open">
    <ci>λ</ci>
    <ci>μ</ci>
   </interval>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (\lambda,\mu).
  </annotation>
 </semantics>
</math>

</li>
</ul>

<p>If using p,q of equivalent length, a simpler variant of the above key generation steps would be to set 

<math display="inline" id="Paillier_cryptosystem:22">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>g</mi>
     <mo>=</mo>
     <mrow>
      <mi>n</mi>
      <mo>+</mo>
      <mn>1</mn>
     </mrow>
    </mrow>
    <mo>,</mo>
    <mrow>
     <mi>λ</mi>
     <mo>=</mo>
     <mrow>
      <mi>φ</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>n</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <eq></eq>
     <ci>g</ci>
     <apply>
      <plus></plus>
      <ci>n</ci>
      <cn type="integer">1</cn>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <ci>λ</ci>
     <apply>
      <times></times>
      <ci>φ</ci>
      <ci>n</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   g=n+1,\lambda=\varphi(n),
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Paillier_cryptosystem:23">
 <semantics>
  <mrow>
   <mi>μ</mi>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mi>φ</mi>
     <msup>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>n</mi>
       <mo stretchy="false">)</mo>
      </mrow>
      <mrow>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
     </msup>
    </mrow>
    <mo lspace="2.5pt" rspace="2.5pt">mod</mo>
    <mi>n</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>μ</ci>
    <apply>
     <csymbol cd="latexml">modulo</csymbol>
     <apply>
      <times></times>
      <ci>φ</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>n</ci>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
       </apply>
      </apply>
     </apply>
     <ci>n</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mu=\varphi(n)^{-1}\bmod n
  </annotation>
 </semantics>
</math>

, where 

<math display="inline" id="Paillier_cryptosystem:24">
 <semantics>
  <mrow>
   <mrow>
    <mi>φ</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>n</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>p</mi>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>q</mi>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>φ</ci>
     <ci>n</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <minus></minus>
      <ci>p</ci>
      <cn type="integer">1</cn>
     </apply>
     <apply>
      <minus></minus>
      <ci>q</ci>
      <cn type="integer">1</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \varphi(n)=(p-1)(q-1)
  </annotation>
 </semantics>
</math>

 .<a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a></p>
<h3 id="encryption">Encryption</h3>
<ol>
<li>Let 

<math display="inline" id="Paillier_cryptosystem:25">
 <semantics>
  <mi>m</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>m</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   m
  </annotation>
 </semantics>
</math>

 be a message to be encrypted where 

<math display="inline" id="Paillier_cryptosystem:26">
 <semantics>
  <mrow>
   <mi>m</mi>
   <mo>∈</mo>
   <msub>
    <mi>ℤ</mi>
    <mi>n</mi>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <in></in>
    <ci>m</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>ℤ</ci>
     <ci>n</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   m\in\mathbb{Z}_{n}
  </annotation>
 </semantics>
</math>

</li>
<li>Select random 

<math display="inline" id="Paillier_cryptosystem:27">
 <semantics>
  <mi>r</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>r</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   r
  </annotation>
 </semantics>
</math>

 where 

<math display="inline" id="Paillier_cryptosystem:28">
 <semantics>
  <mrow>
   <mi>r</mi>
   <mo>∈</mo>
   <msubsup>
    <mi>ℤ</mi>
    <mi>n</mi>
    <mo>*</mo>
   </msubsup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <in></in>
    <ci>r</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>ℤ</ci>
      <times></times>
     </apply>
     <ci>n</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   r\in\mathbb{Z}^{*}_{n}
  </annotation>
 </semantics>
</math>

</li>
<li>Compute ciphertext as

<math display="block" id="Paillier_cryptosystem:29">
 <semantics>
  <mrow>
   <mi>c</mi>
   <mo>=</mo>
   <mrow>
    <mrow>
     <msup>
      <mi>g</mi>
      <mi>m</mi>
     </msup>
     <mo>⋅</mo>
     <msup>
      <mi>r</mi>
      <mi>n</mi>
     </msup>
    </mrow>
    <mo lspace="2.5pt" rspace="2.5pt">mod</mo>
    <msup>
     <mi>n</mi>
     <mn>2</mn>
    </msup>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>c</ci>
    <apply>
     <csymbol cd="latexml">modulo</csymbol>
     <apply>
      <ci>normal-⋅</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>g</ci>
       <ci>m</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>r</ci>
       <ci>n</ci>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>n</ci>
      <cn type="integer">2</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   c=g^{m}\cdot r^{n}\bmod n^{2}
  </annotation>
 </semantics>
</math>

</li>
</ol>
<h3 id="decryption">Decryption</h3>
<ol>
<li>Let 

<math display="inline" id="Paillier_cryptosystem:30">
 <semantics>
  <mi>c</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>c</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   c
  </annotation>
 </semantics>
</math>

 be the ciphertext to decrypt, where 

<math display="inline" id="Paillier_cryptosystem:31">
 <semantics>
  <mrow>
   <mi>c</mi>
   <mo>∈</mo>
   <msubsup>
    <mi>ℤ</mi>
    <msup>
     <mi>n</mi>
     <mn>2</mn>
    </msup>
    <mo>*</mo>
   </msubsup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <in></in>
    <ci>c</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>ℤ</ci>
      <times></times>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>n</ci>
      <cn type="integer">2</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   c\in\mathbb{Z}^{*}_{n^{2}}
  </annotation>
 </semantics>
</math>

</li>
<li>Compute the plaintext message as

<math display="block" id="Paillier_cryptosystem:32">
 <semantics>
  <mrow>
   <mi>m</mi>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mrow>
      <mi>L</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <msup>
         <mi>c</mi>
         <mi>λ</mi>
        </msup>
        <mo lspace="2.5pt" rspace="2.5pt">mod</mo>
        <msup>
         <mi>n</mi>
         <mn>2</mn>
        </msup>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo>⋅</mo>
     <mi>μ</mi>
    </mrow>
    <mo lspace="2.5pt" rspace="2.5pt">mod</mo>
    <mi>n</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>m</ci>
    <apply>
     <csymbol cd="latexml">modulo</csymbol>
     <apply>
      <ci>normal-⋅</ci>
      <apply>
       <times></times>
       <ci>L</ci>
       <apply>
        <csymbol cd="latexml">modulo</csymbol>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>c</ci>
         <ci>λ</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>n</ci>
         <cn type="integer">2</cn>
        </apply>
       </apply>
      </apply>
      <ci>μ</ci>
     </apply>
     <ci>n</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   m=L(c^{\lambda}\bmod n^{2})\cdot\mu\bmod n
  </annotation>
 </semantics>
</math>

</li>
</ol>

<p>As the original <a href="http://www.cs.tau.ac.il/~fiat/crypt07/papers/Pai99pai.pdf">paper</a> points out, decryption is "essentially one exponentiation modulo 

<math display="inline" id="Paillier_cryptosystem:33">
 <semantics>
  <msup>
   <mi>n</mi>
   <mn>2</mn>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>n</ci>
    <cn type="integer">2</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n^{2}
  </annotation>
 </semantics>
</math>

."</p>
<h3 id="homomorphic-properties">Homomorphic properties</h3>

<p>A notable feature of the Paillier cryptosystem is its <a class="uri" href="homomorphic" title="wikilink">homomorphic</a> properties. As the encryption function is additively homomorphic, the following identities can be described:</p>
<ul>
<li><strong>Homomorphic addition of plaintexts</strong></li>
</ul>
<dl>
<dd>The product of two ciphertexts will decrypt to the sum of their corresponding plaintexts,
</dd>
</dl>
<dl>
<dd><dl>
<dd>

<math display="inline" id="Paillier_cryptosystem:34">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>D</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mrow>
        <mrow>
         <mrow>
          <mi>E</mi>
          <mrow>
           <mo stretchy="false">(</mo>
           <msub>
            <mi>m</mi>
            <mn>1</mn>
           </msub>
           <mo>,</mo>
           <msub>
            <mi>r</mi>
            <mn>1</mn>
           </msub>
           <mo stretchy="false">)</mo>
          </mrow>
         </mrow>
         <mo>⋅</mo>
         <mi>E</mi>
        </mrow>
        <mrow>
         <mo stretchy="false">(</mo>
         <msub>
          <mi>m</mi>
          <mn>2</mn>
         </msub>
         <mo>,</mo>
         <msub>
          <mi>r</mi>
          <mn>2</mn>
         </msub>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
       <mo lspace="2.5pt" rspace="2.5pt">mod</mo>
       <msup>
        <mi>n</mi>
        <mn>2</mn>
       </msup>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mrow>
      <msub>
       <mi>m</mi>
       <mn>1</mn>
      </msub>
      <mo>+</mo>
      <msub>
       <mi>m</mi>
       <mn>2</mn>
      </msub>
     </mrow>
     <mo lspace="2.5pt" rspace="2.5pt">mod</mo>
     <mi>n</mi>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>D</ci>
     <apply>
      <csymbol cd="latexml">modulo</csymbol>
      <apply>
       <times></times>
       <apply>
        <ci>normal-⋅</ci>
        <apply>
         <times></times>
         <ci>E</ci>
         <interval closure="open">
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>m</ci>
           <cn type="integer">1</cn>
          </apply>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>r</ci>
           <cn type="integer">1</cn>
          </apply>
         </interval>
        </apply>
        <ci>E</ci>
       </apply>
       <interval closure="open">
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>m</ci>
         <cn type="integer">2</cn>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>r</ci>
         <cn type="integer">2</cn>
        </apply>
       </interval>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>n</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
    <apply>
     <csymbol cd="latexml">modulo</csymbol>
     <apply>
      <plus></plus>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>m</ci>
       <cn type="integer">1</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>m</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
     <ci>n</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   D(E(m_{1},r_{1})\cdot E(m_{2},r_{2})\bmod n^{2})=m_{1}+m_{2}\bmod n.\,
  </annotation>
 </semantics>
</math>


</dd>
</dl>
</dd>
</dl>
<dl>
<dd>The product of a ciphertext with a plaintext raising g will decrypt to the sum of the corresponding plaintexts,
</dd>
</dl>
<dl>
<dd><dl>
<dd>

<math display="inline" id="Paillier_cryptosystem:35">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>D</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mrow>
        <mrow>
         <mi>E</mi>
         <mrow>
          <mo stretchy="false">(</mo>
          <msub>
           <mi>m</mi>
           <mn>1</mn>
          </msub>
          <mo>,</mo>
          <msub>
           <mi>r</mi>
           <mn>1</mn>
          </msub>
          <mo stretchy="false">)</mo>
         </mrow>
        </mrow>
        <mo>⋅</mo>
        <msup>
         <mi>g</mi>
         <msub>
          <mi>m</mi>
          <mn>2</mn>
         </msub>
        </msup>
       </mrow>
       <mo lspace="2.5pt" rspace="2.5pt">mod</mo>
       <msup>
        <mi>n</mi>
        <mn>2</mn>
       </msup>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mrow>
      <msub>
       <mi>m</mi>
       <mn>1</mn>
      </msub>
      <mo>+</mo>
      <msub>
       <mi>m</mi>
       <mn>2</mn>
      </msub>
     </mrow>
     <mo lspace="2.5pt" rspace="2.5pt">mod</mo>
     <mi>n</mi>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>D</ci>
     <apply>
      <csymbol cd="latexml">modulo</csymbol>
      <apply>
       <ci>normal-⋅</ci>
       <apply>
        <times></times>
        <ci>E</ci>
        <interval closure="open">
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>m</ci>
          <cn type="integer">1</cn>
         </apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>r</ci>
          <cn type="integer">1</cn>
         </apply>
        </interval>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>g</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>m</ci>
         <cn type="integer">2</cn>
        </apply>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>n</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
    <apply>
     <csymbol cd="latexml">modulo</csymbol>
     <apply>
      <plus></plus>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>m</ci>
       <cn type="integer">1</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>m</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
     <ci>n</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   D(E(m_{1},r_{1})\cdot g^{m_{2}}\bmod n^{2})=m_{1}+m_{2}\bmod n.\,
  </annotation>
 </semantics>
</math>


</dd>
</dl>
</dd>
</dl>
<ul>
<li><strong>Homomorphic multiplication of plaintexts</strong></li>
</ul>
<dl>
<dd>An encrypted plaintext raised to the power of another plaintext will decrypt to the product of the two plaintexts,
</dd>
</dl>
<dl>
<dd><dl>
<dd>

<math display="inline" id="Paillier_cryptosystem:36">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>D</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mrow>
        <mi>E</mi>
        <msup>
         <mrow>
          <mo stretchy="false">(</mo>
          <msub>
           <mi>m</mi>
           <mn>1</mn>
          </msub>
          <mo>,</mo>
          <msub>
           <mi>r</mi>
           <mn>1</mn>
          </msub>
          <mo stretchy="false">)</mo>
         </mrow>
         <msub>
          <mi>m</mi>
          <mn>2</mn>
         </msub>
        </msup>
       </mrow>
       <mo lspace="2.5pt" rspace="2.5pt">mod</mo>
       <msup>
        <mi>n</mi>
        <mn>2</mn>
       </msup>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mrow>
      <msub>
       <mi>m</mi>
       <mn>1</mn>
      </msub>
      <msub>
       <mi>m</mi>
       <mn>2</mn>
      </msub>
     </mrow>
     <mo lspace="2.5pt" rspace="2.5pt">mod</mo>
     <mi>n</mi>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>D</ci>
     <apply>
      <csymbol cd="latexml">modulo</csymbol>
      <apply>
       <times></times>
       <ci>E</ci>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <interval closure="open">
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>m</ci>
          <cn type="integer">1</cn>
         </apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>r</ci>
          <cn type="integer">1</cn>
         </apply>
        </interval>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>m</ci>
         <cn type="integer">2</cn>
        </apply>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>n</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
    <apply>
     <csymbol cd="latexml">modulo</csymbol>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>m</ci>
       <cn type="integer">1</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>m</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
     <ci>n</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   D(E(m_{1},r_{1})^{m_{2}}\bmod n^{2})=m_{1}m_{2}\bmod n,\,
  </annotation>
 </semantics>
</math>


</dd>
<dd>

<math display="inline" id="Paillier_cryptosystem:37">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>D</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mrow>
        <mi>E</mi>
        <msup>
         <mrow>
          <mo stretchy="false">(</mo>
          <msub>
           <mi>m</mi>
           <mn>2</mn>
          </msub>
          <mo>,</mo>
          <msub>
           <mi>r</mi>
           <mn>2</mn>
          </msub>
          <mo stretchy="false">)</mo>
         </mrow>
         <msub>
          <mi>m</mi>
          <mn>1</mn>
         </msub>
        </msup>
       </mrow>
       <mo lspace="2.5pt" rspace="2.5pt">mod</mo>
       <msup>
        <mi>n</mi>
        <mn>2</mn>
       </msup>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mrow>
      <msub>
       <mi>m</mi>
       <mn>1</mn>
      </msub>
      <msub>
       <mi>m</mi>
       <mn>2</mn>
      </msub>
     </mrow>
     <mo lspace="2.5pt" rspace="2.5pt">mod</mo>
     <mi>n</mi>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>D</ci>
     <apply>
      <csymbol cd="latexml">modulo</csymbol>
      <apply>
       <times></times>
       <ci>E</ci>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <interval closure="open">
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>m</ci>
          <cn type="integer">2</cn>
         </apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>r</ci>
          <cn type="integer">2</cn>
         </apply>
        </interval>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>m</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>n</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
    <apply>
     <csymbol cd="latexml">modulo</csymbol>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>m</ci>
       <cn type="integer">1</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>m</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
     <ci>n</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   D(E(m_{2},r_{2})^{m_{1}}\bmod n^{2})=m_{1}m_{2}\bmod n.\,
  </annotation>
 </semantics>
</math>


</dd>
</dl>
</dd>
</dl>
<dl>
<dd>More generally, an encrypted plaintext raised to a constant <em>k</em> will decrypt to the product of the plaintext and the constant,
</dd>
</dl>
<dl>
<dd><dl>
<dd>

<math display="inline" id="Paillier_cryptosystem:38">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>D</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mrow>
        <mi>E</mi>
        <msup>
         <mrow>
          <mo stretchy="false">(</mo>
          <msub>
           <mi>m</mi>
           <mn>1</mn>
          </msub>
          <mo>,</mo>
          <msub>
           <mi>r</mi>
           <mn>1</mn>
          </msub>
          <mo stretchy="false">)</mo>
         </mrow>
         <mi>k</mi>
        </msup>
       </mrow>
       <mo lspace="2.5pt" rspace="2.5pt">mod</mo>
       <msup>
        <mi>n</mi>
        <mn>2</mn>
       </msup>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mi>k</mi>
      <msub>
       <mi>m</mi>
       <mn>1</mn>
      </msub>
     </mrow>
     <mo lspace="2.5pt" rspace="2.5pt">mod</mo>
     <mi>n</mi>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>D</ci>
     <apply>
      <csymbol cd="latexml">modulo</csymbol>
      <apply>
       <times></times>
       <ci>E</ci>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <interval closure="open">
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>m</ci>
          <cn type="integer">1</cn>
         </apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>r</ci>
          <cn type="integer">1</cn>
         </apply>
        </interval>
        <ci>k</ci>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>n</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
    <apply>
     <csymbol cd="latexml">modulo</csymbol>
     <apply>
      <times></times>
      <ci>k</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>m</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <ci>n</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   D(E(m_{1},r_{1})^{k}\bmod n^{2})=km_{1}\bmod n.\,
  </annotation>
 </semantics>
</math>


</dd>
</dl>
</dd>
</dl>

<p>However, given the Paillier encryptions of two messages there is no known way to compute an encryption of the product of these messages without knowing the private key.</p>
<h3 id="background">Background</h3>

<p>Paillier cryptosystem exploits the fact that certain <a href="discrete_logarithms" title="wikilink">discrete logarithms</a> can be computed easily.</p>

<p>For example, by <a href="binomial_theorem" title="wikilink">binomial theorem</a>,</p>
<dl>
<dd><dl>
<dd>

<math display="inline" id="Paillier_cryptosystem:39">
 <semantics>
  <mrow>
   <msup>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mn>1</mn>
      <mo>+</mo>
      <mi>n</mi>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
    <mi>x</mi>
   </msup>
   <mo>=</mo>
   <mrow>
    <msubsup>
     <mo largeop="true" symmetric="true">∑</mo>
     <mrow>
      <mi>k</mi>
      <mo>=</mo>
      <mn>0</mn>
     </mrow>
     <mi>x</mi>
    </msubsup>
    <mrow>
     <mrow>
      <mo>(</mo>
      <mstyle scriptlevel="+1">
       <mtable columnspacing="0.4em" rowspacing="0.2ex">
        <mtr>
         <mtd>
          <mi>x</mi>
         </mtd>
        </mtr>
        <mtr>
         <mtd>
          <mi>k</mi>
         </mtd>
        </mtr>
       </mtable>
      </mstyle>
      <mo>)</mo>
     </mrow>
     <msup>
      <mi>n</mi>
      <mi>k</mi>
     </msup>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mn>1</mn>
    <mo>+</mo>
    <mrow>
     <mi>n</mi>
     <mi>x</mi>
    </mrow>
    <mo>+</mo>
    <mrow>
     <mrow>
      <mo>(</mo>
      <mstyle scriptlevel="+1">
       <mtable columnspacing="0.4em" rowspacing="0.2ex">
        <mtr>
         <mtd>
          <mi>x</mi>
         </mtd>
        </mtr>
        <mtr>
         <mtd>
          <mn>2</mn>
         </mtd>
        </mtr>
       </mtable>
      </mstyle>
      <mo>)</mo>
     </mrow>
     <msup>
      <mi>n</mi>
      <mn>2</mn>
     </msup>
    </mrow>
    <mo>+</mo>
    <mrow>
     <mtext>higher powers of</mtext>
     <mi>n</mi>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <plus></plus>
       <cn type="integer">1</cn>
       <ci>n</ci>
      </apply>
      <ci>x</ci>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <apply>
         <eq></eq>
         <ci>k</ci>
         <cn type="integer">0</cn>
        </apply>
       </apply>
       <ci>x</ci>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="latexml">binomial</csymbol>
        <ci>x</ci>
        <ci>k</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>n</ci>
        <ci>k</ci>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <plus></plus>
      <cn type="integer">1</cn>
      <apply>
       <times></times>
       <ci>n</ci>
       <ci>x</ci>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="latexml">binomial</csymbol>
        <ci>x</ci>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>n</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
      <apply>
       <times></times>
       <mtext>higher powers of</mtext>
       <ci>n</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (1+n)^{x}=\sum_{k=0}^{x}{x\choose k}n^{k}=1+nx+{x\choose 2}n^{2}+\text{higher %
powers of }n
  </annotation>
 </semantics>
</math>


</dd>
</dl>
</dd>
</dl>

<p>This indicates that:</p>
<dl>
<dd><dl>
<dd>

<math display="inline" id="Paillier_cryptosystem:40">
 <semantics>
  <mrow>
   <msup>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mn>1</mn>
      <mo>+</mo>
      <mi>n</mi>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
    <mi>x</mi>
   </msup>
   <mo>≡</mo>
   <mrow>
    <mrow>
     <mn>1</mn>
     <mo>+</mo>
     <mrow>
      <mi>n</mi>
      <mi>x</mi>
     </mrow>
    </mrow>
    <mspace width="veryverythickmathspace">
    </mspace>
    <mrow>
     <mo lspace="8.1pt" stretchy="false">(</mo>
     <mrow>
      <mo>mod</mo>
      <msup>
       <mi>n</mi>
       <mn>2</mn>
      </msup>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <equivalent></equivalent>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <plus></plus>
      <cn type="integer">1</cn>
      <ci>n</ci>
     </apply>
     <ci>x</ci>
    </apply>
    <apply>
     <csymbol cd="latexml">annotated</csymbol>
     <apply>
      <plus></plus>
      <cn type="integer">1</cn>
      <apply>
       <times></times>
       <ci>n</ci>
       <ci>x</ci>
      </apply>
     </apply>
     <apply>
      <ci>pmod</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>n</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (1+n)^{x}\equiv 1+nx\;\;(\mathop{{\rm mod}}n^{2})
  </annotation>
 </semantics>
</math>


</dd>
</dl>
</dd>
</dl>

<p>Therefore, if:</p>
<dl>
<dd><dl>
<dd>

<math display="inline" id="Paillier_cryptosystem:41">
 <semantics>
  <mrow>
   <mi>y</mi>
   <mo>=</mo>
   <mrow>
    <msup>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mn>1</mn>
       <mo>+</mo>
       <mi>n</mi>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <mi>x</mi>
    </msup>
    <mo lspace="2.5pt" rspace="2.5pt">mod</mo>
    <msup>
     <mi>n</mi>
     <mn>2</mn>
    </msup>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>y</ci>
    <apply>
     <csymbol cd="latexml">modulo</csymbol>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <plus></plus>
       <cn type="integer">1</cn>
       <ci>n</ci>
      </apply>
      <ci>x</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>n</ci>
      <cn type="integer">2</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   y=(1+n)^{x}\bmod n^{2}
  </annotation>
 </semantics>
</math>


</dd>
</dl>
</dd>
</dl>

<p>then</p>
<dl>
<dd><dl>
<dd>

<math display="inline" id="Paillier_cryptosystem:42">
 <semantics>
  <mrow>
   <mi>x</mi>
   <mo>≡</mo>
   <mrow>
    <mfrac>
     <mrow>
      <mi>y</mi>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
     <mi>n</mi>
    </mfrac>
    <mspace width="veryverythickmathspace">
    </mspace>
    <mrow>
     <mo lspace="8.1pt" stretchy="false">(</mo>
     <mrow>
      <mo>mod</mo>
      <mi>n</mi>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <equivalent></equivalent>
    <ci>x</ci>
    <apply>
     <csymbol cd="latexml">annotated</csymbol>
     <apply>
      <divide></divide>
      <apply>
       <minus></minus>
       <ci>y</ci>
       <cn type="integer">1</cn>
      </apply>
      <ci>n</ci>
     </apply>
     <apply>
      <ci>pmod</ci>
      <ci>n</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x\equiv\frac{y-1}{n}\;\;(\mathop{{\rm mod}}n)
  </annotation>
 </semantics>
</math>

.
</dd>
</dl>
</dd>
</dl>

<p>Thus:</p>
<dl>
<dd><dl>
<dd>

<math display="inline" id="Paillier_cryptosystem:43">
 <semantics>
  <mrow>
   <mrow>
    <mi>L</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <msup>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mn>1</mn>
         <mo>+</mo>
         <mi>n</mi>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
       <mi>x</mi>
      </msup>
      <mo lspace="2.5pt" rspace="2.5pt">mod</mo>
      <msup>
       <mi>n</mi>
       <mn>2</mn>
      </msup>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>≡</mo>
   <mrow>
    <mi>x</mi>
    <mspace width="veryverythickmathspace">
    </mspace>
    <mrow>
     <mo lspace="8.1pt" stretchy="false">(</mo>
     <mrow>
      <mo>mod</mo>
      <mi>n</mi>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <equivalent></equivalent>
    <apply>
     <times></times>
     <ci>L</ci>
     <apply>
      <csymbol cd="latexml">modulo</csymbol>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <plus></plus>
        <cn type="integer">1</cn>
        <ci>n</ci>
       </apply>
       <ci>x</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>n</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
    <apply>
     <csymbol cd="latexml">annotated</csymbol>
     <ci>x</ci>
     <apply>
      <ci>pmod</ci>
      <ci>n</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   L((1+n)^{x}\bmod n^{2})\equiv x\;\;(\mathop{{\rm mod}}n)
  </annotation>
 </semantics>
</math>

,
</dd>
</dl>
</dd>
<dd>where function 

<math display="inline" id="Paillier_cryptosystem:44">
 <semantics>
  <mi>L</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>L</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   L
  </annotation>
 </semantics>
</math>

 is defined as 

<math display="inline" id="Paillier_cryptosystem:45">
 <semantics>
  <mrow>
   <mrow>
    <mi>L</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>u</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mfrac>
    <mrow>
     <mi>u</mi>
     <mo>-</mo>
     <mn>1</mn>
    </mrow>
    <mi>n</mi>
   </mfrac>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>L</ci>
     <ci>u</ci>
    </apply>
    <apply>
     <divide></divide>
     <apply>
      <minus></minus>
      <ci>u</ci>
      <cn type="integer">1</cn>
     </apply>
     <ci>n</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   L(u)=\frac{u-1}{n}
  </annotation>
 </semantics>
</math>

 (quotient of integer division) and 

<math display="inline" id="Paillier_cryptosystem:46">
 <semantics>
  <mrow>
   <mi>x</mi>
   <mo>∈</mo>
   <msub>
    <mi>ℤ</mi>
    <mi>n</mi>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <in></in>
    <ci>x</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>ℤ</ci>
     <ci>n</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x\in\mathbb{Z}_{n}
  </annotation>
 </semantics>
</math>

.
</dd>
</dl>
<h3 id="semantic-security">Semantic security</h3>

<p>The original cryptosystem as shown above does provide <a href="semantic_security" title="wikilink">semantic security</a> against chosen-plaintext attacks (<a class="uri" href="IND-CPA" title="wikilink">IND-CPA</a>). The ability to successfully distinguish the challenge ciphertext essentially amounts to the ability to decide composite residuosity. The so-called <a href="decisional_composite_residuosity_assumption" title="wikilink">decisional composite residuosity assumption</a> (DCRA) is believed to be intractable.</p>

<p>Because of the aforementioned homomorphic properties however, the system is <a href="Malleability_(cryptography)" title="wikilink">malleable</a>, and therefore does not enjoy the highest echelon of semantic security that protects against adaptive chosen-ciphertext attacks (<a href="IND-CCA2#Indistinguishability_under_chosen_ciphertext_attack.2Fadaptive_chosen_ciphertext_attack_.28IND-CCA1.2C_IND-CCA2.29" title="wikilink">IND-CCA2</a>). Usually in cryptography the notion of malleability is not seen as an "advantage," but under certain applications such as secure electronic voting and threshold cryptosystems, this property may indeed be necessary.</p>

<p>Paillier and Pointcheval however went on to propose an improved cryptosystem that incorporates the combined hashing of message <em>m</em> with random <em>r</em>. Similar in intent to the <a href="Cramer–Shoup_cryptosystem" title="wikilink">Cramer–Shoup cryptosystem</a>, the hashing prevents an attacker, given only <em>c,</em> from being able to change <em>m</em> in a meaningful way. Through this adaptation the improved scheme can be shown to be <a href="IND-CCA2#Indistinguishability_under_chosen_ciphertext_attack.2Fadaptive_chosen_ciphertext_attack_.28IND-CCA1.2C_IND-CCA2.29" title="wikilink">IND-CCA2</a> secure in the <a href="random_oracle_model" title="wikilink">random oracle model</a>.</p>
<h3 id="applications">Applications</h3>
<ul>
<li><strong>Electronic voting</strong></li>
</ul>

<p>Semantic security is not the only consideration. There are situations under which malleability may be desirable. The above homomorphic properties can be utilized by secure electronic voting systems. Consider a simple binary ("for" or "against") vote. Let <em>m</em> voters cast a vote of either <em>1</em> (for) or <em>0</em> (against). Each voter encrypts their choice before casting their vote. The election official takes the sum of the <em>m</em> encrypted votes and then decrypts the result and obtains the value <em>n</em>, which is the sum of all the votes. The election official then knows that <em>n</em> people voted <em>for</em> and <em>m-n</em> people voted <em>against</em>. The role of the random <em>r</em> ensures that two equivalent votes will encrypt to the same value only with negligible likelihood, hence ensuring voter privacy.</p>
<ul>
<li><strong>Electronic cash</strong></li>
</ul>

<p>Another feature named in paper is the notion of self-<a href="Blinding_(cryptography)" title="wikilink">blinding</a>. This is the ability to change one ciphertext into another without changing the content of its decryption. This has application to the development of <a class="uri" href="ecash" title="wikilink">ecash</a>, an effort originally spearheaded by <a href="David_Chaum" title="wikilink">David Chaum</a>. Imagine paying for an item online without the vendor needing to know your credit card number, and hence your identity. The goal in both electronic cash and electronic voting, is to ensure the e-coin (likewise e-vote) is valid, while at the same time not disclosing the identity of the person with whom it is currently associated.</p>
<h2 id="see-also">See also</h2>
<ul>
<li>The <a href="Okamoto–Uchiyama_cryptosystem" title="wikilink">Okamoto–Uchiyama cryptosystem</a> as a historical antecedent of Paillier.</li>
<li>The <a href="Damgård–Jurik_cryptosystem" title="wikilink">Damgård–Jurik cryptosystem</a> is a generalization of Paillier.</li>
<li>The <a href="http://security.hsr.ch/msevote/paillier">Paillier cryptosystem interactive simulator</a> demonstrates a voting application.</li>
<li>An <a href="http://liris.cnrs.fr/~ohasan/pprs/paillierdemo/">interactive demo</a> of the Paillier cryptosystem.</li>
<li>A proof-of-concept <a href="https://github.com/mhe/jspaillier">Javascript implementation</a> of the Paillier cryptosystem with an <a href="http://mhe.github.io/jspaillier/">interactive demo</a>.</li>
<li>A <a href="http://www.youtube.com/watch?v=ZDnShu5V99s">googletechtalk video</a> on voting using cryptographic methods.</li>
</ul>
<h2 id="references">References</h2>
<ul>
<li></li>
<li></li>
<li></li>
<li>

<p></p></li>
</ul>
<h3 id="notes">Notes</h3>
<h2 id="external-links">External links</h2>
<ul>
<li><a href="http://code.google.com/p/thep/">The Homomorphic Encryption Project</a> implements the Paillier cryptosystem along with its homomorphic operations.</li>
<li><a href="https://github.com/secYOUre/Encounter">Encounter: an open-source library providing an implementation of Paillier cryptosystem and a cryptographic counters construction based on the same.</a></li>
<li><a href="https://github.com/nicta/python-paillier">python-paillier</a> a library for Partially Homomorphic Encryption in Python, including full support for floating point numbers.</li>
</ul>

<p>"</p>

<p><a href="Category:Public-key_encryption_schemes" title="wikilink">Category:Public-key encryption schemes</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1">Jonathan Katz, Yehuda Lindell, "Introduction to Modern Cryptography: Principles and Protocols," Chapman &amp; Hall/CRC, 2007<a href="#fnref1">↩</a></li>
<li id="fn2"></li>
</ol>
</section>
</body>
</html>

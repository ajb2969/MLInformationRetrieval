<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="1659">Trip distribution</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Trip distribution</h1>
<hr/>

<p><strong>Trip distribution</strong> (or <strong>destination choice</strong> or <strong>zonal interchange analysis</strong>), is the second component (after <a href="trip_generation" title="wikilink">trip generation</a>, but before <a href="mode_choice" title="wikilink">mode choice</a> and <a href="route_assignment" title="wikilink">route assignment</a>) in the traditional four-step <a href="transportation_forecasting" title="wikilink">transportation forecasting</a> model. This step matches tripmakers’ origins and destinations to develop a “trip table”, a matrix that displays the number of trips going from each origin to each destination. Historically, this component has been the least developed component of the <a href="transportation_planning_model" title="wikilink">transportation planning model</a>.</p>
<table>
<tbody>
<tr class="odd">
<td style="text-align: left;">
<p><em>Table: Illustrative trip table</em></p></td>
<td style="text-align: left;">
<p>Origin \ Destination</p></td>
<td style="text-align: left;">
<p>1</p></td>
<td style="text-align: left;">
<p>2</p></td>
<td style="text-align: left;">
<p>3</p></td>
<td style="text-align: left;">
<p>Z</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>1</p></td>
<td style="text-align: left;">
<p><em>T</em><sub>11</sub></p></td>
<td style="text-align: left;">
<p><em>T</em><sub>12</sub></p></td>
<td style="text-align: left;">
<p>T<sub>13</sub></p></td>
<td style="text-align: left;">
<p>T<sub>1Z</sub></p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>2</p></td>
<td style="text-align: left;">
<p><em>T</em><sub>21</sub></p></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>3</p></td>
<td style="text-align: left;">
<p><em>T</em><sub>31</sub></p></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>Z</p></td>
<td style="text-align: left;">
<p><em>T</em><sub>Z1</sub></p></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;">
<p><em>T</em><sub>ZZ</sub></p></td>
</tr>
<tr class="even">
</tr>
</tbody>
</table>

<p>Where: <em>T</em><sub> <em>ij</em></sub> = trips from origin <em>i</em> to destination <em>j</em>. Note that the practical value of trips on the diagonal, e.g. from zone 1 to zone 1, is zero since no intra-zonal trip occurs.</p>

<p>Work trip distribution is the way that travel demand models understand how people take jobs. There are trip distribution models for other (non-work) activities, which follow the same structure.</p>
<h2 id="history">History</h2>

<p>Over the years, modelers have used several different formulations of trip distribution. The first was the Fratar or Growth model (which did not differentiate trips by purpose). This structure extrapolated a base year trip table to the future based on growth, but took no account of changing spatial accessibility due to increased supply or changes in travel patterns and congestion. (Simple Growth factor model, Furness Model and Detroit model are models developed at the same time period)</p>

<p>The next models developed were the gravity model and the intervening opportunities model. The most widely used formulation is still the gravity model.</p>

<p>While studying traffic in <a href="Baltimore,_Maryland" title="wikilink">Baltimore, Maryland</a>, <a href="Alan_Voorhees" title="wikilink">Alan Voorhees</a> developed a mathematical formula to predict traffic patterns based on land use. This formula has been instrumental in the design of numerous transportation and public works projects around the world. He wrote "A General Theory of Traffic Movement," (Voorhees, 1956) which applied the gravity model to trip distribution, which translates <a href="trip_generation" title="wikilink">trips generated</a> in an area to a matrix that identifies the number of trips from each origin to each destination, which can then be loaded onto the network.</p>

<p>Evaluation of several model forms in the 1960s concluded that "the gravity model and intervening opportunity model proved of about equal reliability and utility in simulating the 1948 and 1955 trip distribution for Washington, D.C." (Heanue and Pyers 1966). The Fratar model was shown to have weakness in areas experiencing land use changes. As comparisons between the models showed that either could be calibrated equally well to match observed conditions, because of computational ease, gravity models became more widely spread than intervening opportunities models. Some theoretical problems with the intervening opportunities model were discussed by Whitaker and West (1968) concerning its inability to account for all trips generated in a zone which makes it more difficult to calibrate, although techniques for dealing with the limitations have been developed by Ruiter (1967).</p>

<p>With the development of <a class="uri" href="logit" title="wikilink">logit</a> and other discrete choice techniques, new, demographically disaggregate approaches to travel demand were attempted. By including variables other than travel time in determining the probability of making a trip, it is expected to have a better prediction of travel behavior. The <a href="Logistic_regression" title="wikilink">logit model</a> and gravity model have been shown by Wilson (1967) to be of essentially the same form as used in statistical mechanics, the entropy maximization model. The application of these models differs in concept in that the gravity model uses impedance by travel time, perhaps stratified by socioeconomic variables, in determining the probability of trip making, while a discrete choice approach brings those variables inside the utility or impedance function. Discrete choice models require more information to estimate and more computational time.</p>

<p>Ben-Akiva and Lerman (1985) have developed combination destination choice and <a href="transport_mode" title="wikilink">mode</a> choice models using a logit formulation for work and non-work trips. Because of computational intensity, these formulations tended to aggregate traffic zones into larger districts or rings in estimation. In current application, some models, including for instance the transportation planning model used in Portland, Oregon, use a logit formulation for destination choice. Allen (1984) used utilities from a logit based mode choice model in determining composite impedance for trip distribution. However, that approach, using mode choice log-sums implies that destination choice depends on the same variables as mode choice. Levinson and Kumar (1995) employ mode choice probabilities as a weighting factor and develop a specific impedance function or “f-curve” for each mode for work and non-work trip purposes.</p>
<h2 id="mathematics">Mathematics</h2>

<p>At this point in the transportation planning process, the information for zonal interchange analysis is organized in an origin-destination table. On the left is listed trips produced in each zone. Along the top are listed the zones, and for each zone we list its attraction. The table is <em>n</em> x <em>n</em>, where <em>n</em> = the number of zones.</p>

<p>Each cell in our table is to contain the number of trips from zone <em>i</em> to zone <em>j</em>. We do not have these within-cell numbers yet, although we have the row and column totals. With data organized this way, our task is to fill in the cells for tables headed <em>t</em> = 1 through say <em>t</em> = <em>n</em>.</p>

<p>Actually, from home interview travel survey data and attraction analysis we have the cell information for <em>t</em> = 1. The data are a sample, so we generalize the sample to the universe. The techniques used for zonal interchange analysis explore the empirical rule that fits the <em>t</em> = 1 data. That rule is then used to generate cell data for <em>t</em> = 2, <em>t</em> = 3, <em>t</em> = 4, etc., to <em>t</em> = <em>n</em>.</p>

<p>The first technique developed to model zonal interchange involves a model such as this:</p>

<p>

<math display="block" id="Trip_distribution:0">
 <semantics>
  <mrow>
   <msub>
    <mi>T</mi>
    <mrow>
     <mi>i</mi>
     <mi>j</mi>
    </mrow>
   </msub>
   <mo>=</mo>
   <mrow>
    <msub>
     <mi>T</mi>
     <mi>i</mi>
    </msub>
    <mfrac>
     <mrow>
      <msub>
       <mi>A</mi>
       <mi>j</mi>
      </msub>
      <mi>f</mi>
      <mrow>
       <mo>(</mo>
       <msub>
        <mi>C</mi>
        <mrow>
         <mi>i</mi>
         <mi>j</mi>
        </mrow>
       </msub>
       <mo>)</mo>
      </mrow>
      <msub>
       <mi>K</mi>
       <mrow>
        <mi>i</mi>
        <mi>j</mi>
       </mrow>
      </msub>
     </mrow>
     <mrow>
      <msubsup>
       <mo largeop="true" symmetric="true">∑</mo>
       <mrow>
        <mi>j</mi>
        <mo>=</mo>
        <mn>1</mn>
       </mrow>
       <mi>n</mi>
      </msubsup>
      <mrow>
       <msub>
        <mi>A</mi>
        <mi>j</mi>
       </msub>
       <mi>f</mi>
       <mrow>
        <mo>(</mo>
        <msub>
         <mi>C</mi>
         <mrow>
          <mi>i</mi>
          <mi>j</mi>
         </mrow>
        </msub>
        <mo>)</mo>
       </mrow>
       <msub>
        <mi>K</mi>
        <mrow>
         <mi>i</mi>
         <mi>j</mi>
        </mrow>
       </msub>
      </mrow>
     </mrow>
    </mfrac>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>T</ci>
     <apply>
      <times></times>
      <ci>i</ci>
      <ci>j</ci>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>T</ci>
      <ci>i</ci>
     </apply>
     <apply>
      <divide></divide>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>A</ci>
        <ci>j</ci>
       </apply>
       <ci>f</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>C</ci>
        <apply>
         <times></times>
         <ci>i</ci>
         <ci>j</ci>
        </apply>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>K</ci>
        <apply>
         <times></times>
         <ci>i</ci>
         <ci>j</ci>
        </apply>
       </apply>
      </apply>
      <apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <sum></sum>
         <apply>
          <eq></eq>
          <ci>j</ci>
          <cn type="integer">1</cn>
         </apply>
        </apply>
        <ci>n</ci>
       </apply>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>A</ci>
         <ci>j</ci>
        </apply>
        <ci>f</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>C</ci>
         <apply>
          <times></times>
          <ci>i</ci>
          <ci>j</ci>
         </apply>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>K</ci>
         <apply>
          <times></times>
          <ci>i</ci>
          <ci>j</ci>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   T_{ij}=T_{i}\frac{{A_{j}f\left({C_{ij}}\right)K_{ij}}}{{\sum_{j=1}^{n}{A_{j}f%
\left({C_{ij}}\right)K_{ij}}}}
  </annotation>
 </semantics>
</math>

</p>

<p>where:</p>
<ul>
<li>

<math display="inline" id="Trip_distribution:1">
 <semantics>
  <msub>
   <mi>T</mi>
   <mrow>
    <mi>i</mi>
    <mi>j</mi>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>T</ci>
    <apply>
     <times></times>
     <ci>i</ci>
     <ci>j</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   T_{ij}
  </annotation>
 </semantics>
</math>

 : trips from i to j.</li>
<li>

<math display="inline" id="Trip_distribution:2">
 <semantics>
  <msub>
   <mi>T</mi>
   <mi>i</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>T</ci>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   T_{i}
  </annotation>
 </semantics>
</math>

 : trips from i, as per our generation analysis</li>
<li>

<math display="inline" id="Trip_distribution:3">
 <semantics>
  <msub>
   <mi>A</mi>
   <mi>j</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>A</ci>
    <ci>j</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A_{j}
  </annotation>
 </semantics>
</math>

 : trips attracted to j, as per our generation analysis</li>
<li>

<math display="inline" id="Trip_distribution:4">
 <semantics>
  <mrow>
   <mi>f</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>C</mi>
     <mrow>
      <mi>i</mi>
      <mi>j</mi>
     </mrow>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>f</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>C</ci>
     <apply>
      <times></times>
      <ci>i</ci>
      <ci>j</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f(C_{ij})
  </annotation>
 </semantics>
</math>

 : <a href="travel_cost_friction" title="wikilink">travel cost friction</a> factor, say = 

<math display="inline" id="Trip_distribution:5">
 <semantics>
  <msubsup>
   <mi>C</mi>
   <mrow>
    <mi>i</mi>
    <mi>j</mi>
   </mrow>
   <mi>b</mi>
  </msubsup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>C</ci>
     <apply>
      <times></times>
      <ci>i</ci>
      <ci>j</ci>
     </apply>
    </apply>
    <ci>b</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   C_{ij}^{b}
  </annotation>
 </semantics>
</math>

</li>
<li>

<math display="inline" id="Trip_distribution:6">
 <semantics>
  <msub>
   <mi>K</mi>
   <mrow>
    <mi>i</mi>
    <mi>j</mi>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>K</ci>
    <apply>
     <times></times>
     <ci>i</ci>
     <ci>j</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   K_{ij}
  </annotation>
 </semantics>
</math>

 : Calibration parameter</li>
</ul>

<p>Zone <em>i</em> generates <em>T</em><sub> <em>i</em></sub> trips; how many will go to zone <em>j</em>? That depends on the attractiveness of <em>j</em> compared to the attractiveness of all places; attractiveness is tempered by the distance a zone is from zone <em>i</em>. We compute the fraction comparing <em>j</em> to all places and multiply <em>T</em><sub> ;<em>i</em></sub> by it.</p>

<p>The rule is often of a gravity form:</p>

<p>

<math display="block" id="Trip_distribution:7">
 <semantics>
  <mrow>
   <msub>
    <mi>T</mi>
    <mrow>
     <mi>i</mi>
     <mi>j</mi>
    </mrow>
   </msub>
   <mo>=</mo>
   <mrow>
    <mi>a</mi>
    <mfrac>
     <mrow>
      <msub>
       <mi>P</mi>
       <mi>i</mi>
      </msub>
      <msub>
       <mi>P</mi>
       <mi>j</mi>
      </msub>
     </mrow>
     <msubsup>
      <mi>C</mi>
      <mrow>
       <mi>i</mi>
       <mi>j</mi>
      </mrow>
      <mi>b</mi>
     </msubsup>
    </mfrac>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>T</ci>
     <apply>
      <times></times>
      <ci>i</ci>
      <ci>j</ci>
     </apply>
    </apply>
    <apply>
     <times></times>
     <ci>a</ci>
     <apply>
      <divide></divide>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>P</ci>
        <ci>i</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>P</ci>
        <ci>j</ci>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>C</ci>
        <apply>
         <times></times>
         <ci>i</ci>
         <ci>j</ci>
        </apply>
       </apply>
       <ci>b</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   T_{ij}=a\frac{{P_{i}P_{j}}}{{C_{ij}^{b}}}
  </annotation>
 </semantics>
</math>

</p>

<p>where:</p>
<ul>
<li>

<math display="inline" id="Trip_distribution:8">
 <semantics>
  <mrow>
   <msub>
    <mi>P</mi>
    <mi>i</mi>
   </msub>
   <mo>;</mo>
   <msub>
    <mi>P</mi>
    <mi>j</mi>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <list>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>P</ci>
     <ci>i</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>P</ci>
     <ci>j</ci>
    </apply>
   </list>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   P_{i};P_{j}
  </annotation>
 </semantics>
</math>

 : populations of <em>i</em> and <em>j</em></li>
<li>

<math display="inline" id="Trip_distribution:9">
 <semantics>
  <mrow>
   <mi>a</mi>
   <mo>;</mo>
   <mi>b</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <list>
    <ci>a</ci>
    <ci>b</ci>
   </list>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a;b
  </annotation>
 </semantics>
</math>

 : parameters</li>
</ul>

<p>But in the zonal interchange mode, we use numbers related to trip origins (<em>T</em><sub> ;<em>i</em></sub>) and trip destinations (<em>T</em><sub> ;<em>j</em></sub>) rather than populations.</p>

<p>There are lots of model forms because we may use weights and special calibration parameters, e.g., one could write say:</p>

<p>

<math display="block" id="Trip_distribution:10">
 <semantics>
  <mrow>
   <msub>
    <mi>T</mi>
    <mrow>
     <mi>i</mi>
     <mi>j</mi>
    </mrow>
   </msub>
   <mo>=</mo>
   <mrow>
    <mi>a</mi>
    <mfrac>
     <mrow>
      <msubsup>
       <mi>T</mi>
       <mi>i</mi>
       <mi>c</mi>
      </msubsup>
      <msubsup>
       <mi>T</mi>
       <mi>j</mi>
       <mi>d</mi>
      </msubsup>
     </mrow>
     <msubsup>
      <mi>C</mi>
      <mrow>
       <mi>i</mi>
       <mi>j</mi>
      </mrow>
      <mi>b</mi>
     </msubsup>
    </mfrac>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>T</ci>
     <apply>
      <times></times>
      <ci>i</ci>
      <ci>j</ci>
     </apply>
    </apply>
    <apply>
     <times></times>
     <ci>a</ci>
     <apply>
      <divide></divide>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>T</ci>
         <ci>i</ci>
        </apply>
        <ci>c</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>T</ci>
         <ci>j</ci>
        </apply>
        <ci>d</ci>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>C</ci>
        <apply>
         <times></times>
         <ci>i</ci>
         <ci>j</ci>
        </apply>
       </apply>
       <ci>b</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   T_{ij}=a\frac{{T_{i}^{c}T_{j}^{d}}}{{C_{ij}^{b}}}
  </annotation>
 </semantics>
</math>

</p>

<p>or</p>

<p>

<math display="block" id="Trip_distribution:11">
 <semantics>
  <mrow>
   <msub>
    <mi>T</mi>
    <mrow>
     <mi>i</mi>
     <mi>j</mi>
    </mrow>
   </msub>
   <mo>=</mo>
   <mfrac>
    <mrow>
     <mi>c</mi>
     <msub>
      <mi>T</mi>
      <mi>i</mi>
     </msub>
     <mi>d</mi>
     <msub>
      <mi>T</mi>
      <mi>j</mi>
     </msub>
    </mrow>
    <msubsup>
     <mi>C</mi>
     <mrow>
      <mi>i</mi>
      <mi>j</mi>
     </mrow>
     <mi>b</mi>
    </msubsup>
   </mfrac>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>T</ci>
     <apply>
      <times></times>
      <ci>i</ci>
      <ci>j</ci>
     </apply>
    </apply>
    <apply>
     <divide></divide>
     <apply>
      <times></times>
      <ci>c</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>T</ci>
       <ci>i</ci>
      </apply>
      <ci>d</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>T</ci>
       <ci>j</ci>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>C</ci>
       <apply>
        <times></times>
        <ci>i</ci>
        <ci>j</ci>
       </apply>
      </apply>
      <ci>b</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   T_{ij}=\frac{{cT_{i}dT_{j}}}{{C_{ij}^{b}}}
  </annotation>
 </semantics>
</math>

</p>

<p>where:</p>
<ul>
<li><em>a, b, c, d</em> are parameters</li>
<li>

<math display="inline" id="Trip_distribution:12">
 <semantics>
  <msub>
   <mi>C</mi>
   <mrow>
    <mi>i</mi>
    <mi>j</mi>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>C</ci>
    <apply>
     <times></times>
     <ci>i</ci>
     <ci>j</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   C_{ij}
  </annotation>
 </semantics>
</math>

 : travel cost (e.g. distance, money, time)</li>
<li>

<math display="inline" id="Trip_distribution:13">
 <semantics>
  <msub>
   <mi>T</mi>
   <mi>j</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>T</ci>
    <ci>j</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   T_{j}
  </annotation>
 </semantics>
</math>

 : inbound trips, destinations</li>
<li>

<math display="inline" id="Trip_distribution:14">
 <semantics>
  <msub>
   <mi>T</mi>
   <mi>i</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>T</ci>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   T_{i}
  </annotation>
 </semantics>
</math>

 : outbound trips, origin</li>
</ul>
<h2 id="gravity-model">Gravity model</h2>

<p>The gravity model illustrates the macroscopic relationships between places (say homes and workplaces). It has long been posited that the interaction between two locations declines with increasing (distance, time, and cost) between them, but is positively associated with the amount of activity at each location (Isard, 1956). In analogy with physics, Reilly (1929) formulated <a href="Reilly's_law_of_retail_gravitation" title="wikilink">Reilly's law of retail gravitation</a>, and <a href="J._Q._Stewart" title="wikilink">J. Q. Stewart</a> (1948) formulated definitions of <a href="demographic_gravitation" title="wikilink">demographic gravitation</a>, force, energy, and potential, now called accessibility (Hansen, 1959). The <a href="distance_decay" title="wikilink">distance decay</a> factor of 1/distance has been updated to a more comprehensive function of generalized cost, which is not necessarily linear - a negative exponential tends to be the preferred form. In analogy with Newton’s law of gravity, a gravity model is often used in transportation planning. The gravity model has been corroborated many times as a basic underlying aggregate relationship (Scott 1988, Cervero 1989, Levinson and Kumar 1995). The rate of decline of the interaction (called alternatively, the impedance or friction factor, or the utility or propensity function) has to be empirically measured, and varies by context. Limiting the usefulness of the gravity model is its aggregate nature. Though policy also operates at an aggregate level, more accurate analyses will retain the most detailed level of information as long as possible. While the gravity model is very successful in explaining the choice of a large number of individuals, the choice of any given individual varies greatly from the predicted value. As applied in an urban travel demand context, the disutilities are primarily time, distance, and cost, although discrete choice models with the application of more expansive utility expressions are sometimes used, as is stratification by income or vehicle ownership.</p>

<p>Mathematically, the gravity model often takes the form:</p>

<p>

<math display="block" id="Trip_distribution:15">
 <semantics>
  <mrow>
   <msub>
    <mi>T</mi>
    <mrow>
     <mi>i</mi>
     <mi>j</mi>
    </mrow>
   </msub>
   <mo>=</mo>
   <mrow>
    <msub>
     <mi>K</mi>
     <mi>i</mi>
    </msub>
    <msub>
     <mi>K</mi>
     <mi>j</mi>
    </msub>
    <msub>
     <mi>T</mi>
     <mi>i</mi>
    </msub>
    <msub>
     <mi>T</mi>
     <mi>j</mi>
    </msub>
    <mi>f</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <msub>
      <mi>C</mi>
      <mrow>
       <mi>i</mi>
       <mi>j</mi>
      </mrow>
     </msub>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>T</ci>
     <apply>
      <times></times>
      <ci>i</ci>
      <ci>j</ci>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>K</ci>
      <ci>i</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>K</ci>
      <ci>j</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>T</ci>
      <ci>i</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>T</ci>
      <ci>j</ci>
     </apply>
     <ci>f</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>C</ci>
      <apply>
       <times></times>
       <ci>i</ci>
       <ci>j</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   T_{ij}=K_{i}K_{j}T_{i}T_{j}f(C_{ij})
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Trip_distribution:16">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <munder>
      <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
      <mi>j</mi>
     </munder>
     <msub>
      <mi>T</mi>
      <mrow>
       <mi>i</mi>
       <mi>j</mi>
      </mrow>
     </msub>
    </mrow>
    <mo>=</mo>
    <msub>
     <mi>T</mi>
     <mi>i</mi>
    </msub>
   </mrow>
   <mo>,</mo>
   <mrow>
    <mrow>
     <munder>
      <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
      <mi>i</mi>
     </munder>
     <msub>
      <mi>T</mi>
      <mrow>
       <mi>i</mi>
       <mi>j</mi>
      </mrow>
     </msub>
    </mrow>
    <mo>=</mo>
    <msub>
     <mi>T</mi>
     <mi>j</mi>
    </msub>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <eq></eq>
     <apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <ci>j</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>T</ci>
       <apply>
        <times></times>
        <ci>i</ci>
        <ci>j</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>T</ci>
      <ci>i</ci>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <ci>i</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>T</ci>
       <apply>
        <times></times>
        <ci>i</ci>
        <ci>j</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>T</ci>
      <ci>j</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \sum_{j}{T_{ij}=T_{i}},\sum_{i}{T_{ij}=T_{j}}
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Trip_distribution:17">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>K</mi>
     <mi>i</mi>
    </msub>
    <mo>=</mo>
    <mfrac>
     <mn>1</mn>
     <mrow>
      <msub>
       <mo largeop="true" symmetric="true">∑</mo>
       <mi>j</mi>
      </msub>
      <mrow>
       <msub>
        <mi>K</mi>
        <mi>j</mi>
       </msub>
       <msub>
        <mi>T</mi>
        <mi>j</mi>
       </msub>
       <mi>f</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <msub>
         <mi>C</mi>
         <mrow>
          <mi>i</mi>
          <mi>j</mi>
         </mrow>
        </msub>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
     </mrow>
    </mfrac>
   </mrow>
   <mo>,</mo>
   <mrow>
    <msub>
     <mi>K</mi>
     <mi>j</mi>
    </msub>
    <mo>=</mo>
    <mfrac>
     <mn>1</mn>
     <mrow>
      <msub>
       <mo largeop="true" symmetric="true">∑</mo>
       <mi>i</mi>
      </msub>
      <mrow>
       <msub>
        <mi>K</mi>
        <mi>i</mi>
       </msub>
       <msub>
        <mi>T</mi>
        <mi>i</mi>
       </msub>
       <mi>f</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <msub>
         <mi>C</mi>
         <mrow>
          <mi>i</mi>
          <mi>j</mi>
         </mrow>
        </msub>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
     </mrow>
    </mfrac>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>K</ci>
      <ci>i</ci>
     </apply>
     <apply>
      <divide></divide>
      <cn type="integer">1</cn>
      <apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <ci>j</ci>
       </apply>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>K</ci>
         <ci>j</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>T</ci>
         <ci>j</ci>
        </apply>
        <ci>f</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>C</ci>
         <apply>
          <times></times>
          <ci>i</ci>
          <ci>j</ci>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>K</ci>
      <ci>j</ci>
     </apply>
     <apply>
      <divide></divide>
      <cn type="integer">1</cn>
      <apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <ci>i</ci>
       </apply>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>K</ci>
         <ci>i</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>T</ci>
         <ci>i</ci>
        </apply>
        <ci>f</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>C</ci>
         <apply>
          <times></times>
          <ci>i</ci>
          <ci>j</ci>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   K_{i}=\frac{1}{{\sum_{j}{K_{j}T_{j}f(C_{ij})}}},K_{j}=\frac{1}{{\sum_{i}{K_{i}%
T_{i}f(C_{ij})}}}
  </annotation>
 </semantics>
</math>

</p>

<p>where</p>
<ul>
<li>

<math display="inline" id="Trip_distribution:18">
 <semantics>
  <msub>
   <mi>T</mi>
   <mrow>
    <mi>i</mi>
    <mi>j</mi>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>T</ci>
    <apply>
     <times></times>
     <ci>i</ci>
     <ci>j</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   T_{ij}
  </annotation>
 </semantics>
</math>

 = Trips between origin <em>i</em> and destination <em>j</em></li>
<li>

<math display="inline" id="Trip_distribution:19">
 <semantics>
  <msub>
   <mi>T</mi>
   <mi>i</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>T</ci>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   T_{i}
  </annotation>
 </semantics>
</math>

 = Trips originating at <em>i</em></li>
<li>

<math display="inline" id="Trip_distribution:20">
 <semantics>
  <msub>
   <mi>T</mi>
   <mi>j</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>T</ci>
    <ci>j</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   T_{j}
  </annotation>
 </semantics>
</math>

 = Trips destined for <em>j</em></li>
<li>

<math display="inline" id="Trip_distribution:21">
 <semantics>
  <msub>
   <mi>C</mi>
   <mrow>
    <mi>i</mi>
    <mi>j</mi>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>C</ci>
    <apply>
     <times></times>
     <ci>i</ci>
     <ci>j</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   C_{ij}
  </annotation>
 </semantics>
</math>

 = travel cost between <em>i</em> and <em>j</em></li>
<li>

<math display="inline" id="Trip_distribution:22">
 <semantics>
  <mrow>
   <msub>
    <mi>K</mi>
    <mi>i</mi>
   </msub>
   <mo>,</mo>
   <msub>
    <mi>K</mi>
    <mi>j</mi>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <list>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>K</ci>
     <ci>i</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>K</ci>
     <ci>j</ci>
    </apply>
   </list>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   K_{i},K_{j}
  </annotation>
 </semantics>
</math>

 = balancing factors solved iteratively. See <a href="Iterative_proportional_fitting" title="wikilink">Iterative proportional fitting</a>.</li>
<li>

<math display="inline" id="Trip_distribution:23">
 <semantics>
  <mi>f</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>f</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f
  </annotation>
 </semantics>
</math>

 = distance decay factor, as in the accessibility model</li>
</ul>

<p>It is doubly constrained, in the sense that for any <em>i</em> the total number of trips from <em>i</em> predicted by the model always (mechanically, for any parameter values) equals the real total number of trips from <em>i</em>. Similarly, the total number of trips to <em>j</em> predicted by the model equals the real total number of trips to <em>j</em>, for any <em>j</em>.</p>
<h2 id="entropy-analysis">Entropy analysis</h2>

<p>Wilson (1970) gives us another way to think about zonal interchange problem. This section treats Wilson’s methodology to give a grasp of central ideas.</p>

<p>To start, consider some trips where we have seven people in origin zones commuting to seven jobs in destination zones. One configuration of such trips will be:</p>
<table>
<tbody>
<tr class="odd">
<td style="text-align: left;">
<p><strong>Table: Configuration of trips</strong></p></td>
<td style="text-align: left;">
<p>zone</p></td>
<td style="text-align: left;">
<p>1</p></td>
<td style="text-align: left;">
<p>2</p></td>
<td style="text-align: left;">
<p>3</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>1</p></td>
<td style="text-align: left;">
<p>2</p></td>
<td style="text-align: left;">
<p>1</p></td>
<td style="text-align: left;">
<p>1</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>2</p></td>
<td style="text-align: left;">
<p>0</p></td>
<td style="text-align: left;">
<p>2</p></td>
<td style="text-align: left;">
<p>1</p></td>
</tr>
<tr class="even">
</tr>
</tbody>
</table>

<p>

<math display="block" id="Trip_distribution:24">
 <semantics>
  <mrow>
   <mrow>
    <mi>w</mi>
    <mrow>
     <mo>(</mo>
     <msub>
      <mi>T</mi>
      <mrow>
       <mi>i</mi>
       <mi>j</mi>
      </mrow>
     </msub>
     <mo>)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mfrac>
    <mrow>
     <mn>7</mn>
     <mo lspace="0pt" rspace="3.5pt">!</mo>
    </mrow>
    <mrow>
     <mrow>
      <mn>2</mn>
      <mo lspace="0pt" rspace="3.5pt">!</mo>
     </mrow>
     <mrow>
      <mn>1</mn>
      <mo lspace="0pt" rspace="3.5pt">!</mo>
     </mrow>
     <mrow>
      <mn>1</mn>
      <mo lspace="0pt" rspace="3.5pt">!</mo>
     </mrow>
     <mrow>
      <mn>0</mn>
      <mo lspace="0pt" rspace="3.5pt">!</mo>
     </mrow>
     <mrow>
      <mn>2</mn>
      <mo lspace="0pt" rspace="3.5pt">!</mo>
     </mrow>
     <mrow>
      <mn>1</mn>
      <mo lspace="0pt" rspace="3.5pt">!</mo>
     </mrow>
    </mrow>
   </mfrac>
   <mo>=</mo>
   <mn>1260</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <times></times>
      <ci>w</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>T</ci>
       <apply>
        <times></times>
        <ci>i</ci>
        <ci>j</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <divide></divide>
      <apply>
       <factorial></factorial>
       <cn type="integer">7</cn>
      </apply>
      <apply>
       <times></times>
       <apply>
        <factorial></factorial>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <factorial></factorial>
        <cn type="integer">1</cn>
       </apply>
       <apply>
        <factorial></factorial>
        <cn type="integer">1</cn>
       </apply>
       <apply>
        <factorial></factorial>
        <cn type="integer">0</cn>
       </apply>
       <apply>
        <factorial></factorial>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <factorial></factorial>
        <cn type="integer">1</cn>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <cn type="integer">1260</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   w\left({T_{ij}}\right)=\frac{{7!}}{{2!1!1!0!2!1!}}=1260
  </annotation>
 </semantics>
</math>

</p>

<p>where 0! = 1.</p>

<p>That configuration can appear in 1,260 ways. We have calculated the number of ways that configuration of trips might have occurred, and to explain the calculation, let’s recall those coin tossing experiments talked about so much in elementary statistics.</p>

<p>The number of ways a two-sided coin can come up is 

<math display="inline" id="Trip_distribution:25">
 <semantics>
  <msup>
   <mn>2</mn>
   <mi>n</mi>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <cn type="integer">2</cn>
    <ci>n</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   2^{n}
  </annotation>
 </semantics>
</math>


, where n is the number of times we toss the coin. If we toss the coin once, it can come up heads or tails, 

<math display="inline" id="Trip_distribution:26">
 <semantics>
  <mrow>
   <msup>
    <mn>2</mn>
    <mn>1</mn>
   </msup>
   <mo>=</mo>
   <mn>2</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <cn type="integer">2</cn>
     <cn type="integer">1</cn>
    </apply>
    <cn type="integer">2</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   2^{1}=2
  </annotation>
 </semantics>
</math>

. If we toss it twice, it can come up HH, HT, TH, or TT, 4 ways, and 

<math display="inline" id="Trip_distribution:27">
 <semantics>
  <mrow>
   <msup>
    <mn>2</mn>
    <mn>2</mn>
   </msup>
   <mo>=</mo>
   <mn>4</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <cn type="integer">2</cn>
     <cn type="integer">2</cn>
    </apply>
    <cn type="integer">4</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   2^{2}=4
  </annotation>
 </semantics>
</math>

. To ask the specific question about, say, four coins coming up all heads, we calculate 

<math display="inline" id="Trip_distribution:28">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mn>4</mn>
     <mo lspace="0pt" rspace="3.5pt">!</mo>
    </mrow>
    <mo>/</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mrow>
       <mn>4</mn>
       <mo lspace="0pt" rspace="3.5pt">!</mo>
      </mrow>
      <mrow>
       <mn>0</mn>
       <mo lspace="0pt" rspace="3.5pt">!</mo>
      </mrow>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <divide></divide>
     <apply>
      <factorial></factorial>
      <cn type="integer">4</cn>
     </apply>
     <apply>
      <times></times>
      <apply>
       <factorial></factorial>
       <cn type="integer">4</cn>
      </apply>
      <apply>
       <factorial></factorial>
       <cn type="integer">0</cn>
      </apply>
     </apply>
    </apply>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   4!/(4!0!)=1
  </annotation>
 </semantics>
</math>

 . Two heads and two tails would be 

<math display="inline" id="Trip_distribution:29">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mn>4</mn>
     <mo lspace="0pt" rspace="3.5pt">!</mo>
    </mrow>
    <mo>/</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mrow>
       <mn>2</mn>
       <mo lspace="0pt" rspace="3.5pt">!</mo>
      </mrow>
      <mrow>
       <mn>2</mn>
       <mo lspace="0pt" rspace="3.5pt">!</mo>
      </mrow>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mn>6</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <divide></divide>
     <apply>
      <factorial></factorial>
      <cn type="integer">4</cn>
     </apply>
     <apply>
      <times></times>
      <apply>
       <factorial></factorial>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <factorial></factorial>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
    <cn type="integer">6</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   4!/(2!2!)=6
  </annotation>
 </semantics>
</math>

. We are solving the equation:</p>

<p>

<math display="block" id="Trip_distribution:30">
 <semantics>
  <mrow>
   <mi>w</mi>
   <mo>=</mo>
   <mfrac>
    <mrow>
     <mi>n</mi>
     <mo lspace="0pt" rspace="3.5pt">!</mo>
    </mrow>
    <mrow>
     <msubsup>
      <mo largeop="true" symmetric="true">∏</mo>
      <mrow>
       <mi>i</mi>
       <mo>=</mo>
       <mn>1</mn>
      </mrow>
      <mi>n</mi>
     </msubsup>
     <mrow>
      <msub>
       <mi>n</mi>
       <mi>i</mi>
      </msub>
      <mo lspace="0pt" rspace="3.5pt">!</mo>
     </mrow>
    </mrow>
   </mfrac>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>w</ci>
    <apply>
     <divide></divide>
     <apply>
      <factorial></factorial>
      <ci>n</ci>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <csymbol cd="latexml">product</csymbol>
        <apply>
         <eq></eq>
         <ci>i</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <ci>n</ci>
      </apply>
      <apply>
       <factorial></factorial>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>n</ci>
        <ci>i</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   w=\frac{{n!}}{{\prod_{i=1}^{n}{n_{i}!}}}
  </annotation>
 </semantics>
</math>

</p>

<p>An important point is that as <em>n</em> gets larger, our distribution gets more and more peaked, and it is more and more reasonable to think of a most likely state.</p>

<p>However, the notion of most likely state comes not from this thinking; it comes from statistical mechanics, a field well known to Wilson and not so well known to transportation planners. The result from statistical mechanics is that a descending series is most likely. Think about the way the energy from lights in the classroom is affecting the air in the classroom. If the effect resulted in an ascending series, many of the atoms and molecules would be affected a lot and a few would be affected a little. The descending series would have a lot affected not at all or not much and only a few affected very much. We could take a given level of energy and compute excitation levels in ascending and descending series. Using the formula above, we would compute the ways particular series could occur, and we would concluded that descending series dominate.</p>

<p>That is more-or-less <a href="Boltzmann's_Law" title="wikilink">Boltzmann's Law</a>,</p>

<p>

<math display="block" id="Trip_distribution:31">
 <semantics>
  <mrow>
   <msub>
    <mi>p</mi>
    <mi>j</mi>
   </msub>
   <mo>=</mo>
   <mrow>
    <msub>
     <mi>p</mi>
     <mn>0</mn>
    </msub>
    <msup>
     <mi>e</mi>
     <mrow>
      <mi>β</mi>
      <msub>
       <mi>e</mi>
       <mi>j</mi>
      </msub>
     </mrow>
    </msup>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>p</ci>
     <ci>j</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>p</ci>
      <cn type="integer">0</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>e</ci>
      <apply>
       <times></times>
       <ci>β</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>e</ci>
        <ci>j</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p_{j}=p_{0}e^{\beta e_{j}}
  </annotation>
 </semantics>
</math>

</p>

<p>That is, the particles at any particular excitation level <em>j</em> will be a negative exponential function of the particles in the ground state, 

<math display="inline" id="Trip_distribution:32">
 <semantics>
  <msub>
   <mi>p</mi>
   <mn>0</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>p</ci>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p_{0}
  </annotation>
 </semantics>
</math>

, the excitation level, 

<math display="inline" id="Trip_distribution:33">
 <semantics>
  <msub>
   <mi>e</mi>
   <mi>j</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>e</ci>
    <ci>j</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   e_{j}
  </annotation>
 </semantics>
</math>

, and a parameter 

<math display="inline" id="Trip_distribution:34">
 <semantics>
  <mi>β</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>β</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \beta
  </annotation>
 </semantics>
</math>

, which is a function of the (average) energy available to the particles in the system.</p>

<p>The two paragraphs above have to do with ensemble methods of calculation developed by Gibbs, a topic well beyond the reach of these notes.</p>

<p>Returning to our O-D matrix, note that we have not used as much information as we would have from an O and D survey and from our earlier work on trip generation. For the same travel pattern in the O-D matrix used before, we would have row and column totals, i.e.:</p>
<table>
<tbody>
<tr class="odd">
<td style="text-align: left;">
<p><strong>Table: Illustrative O-D Matrix with row and column totals</strong></p></td>
<td style="text-align: left;"></td>
<td style="text-align: left;">
<p>zone</p></td>
<td style="text-align: left;">
<p>1</p></td>
<td style="text-align: left;">
<p>2</p></td>
<td style="text-align: left;">
<p>3</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>zone</p></td>
<td style="text-align: left;">
<p><em>T<sub>i</sub> \T<sub>j</sub></em></p></td>
<td style="text-align: left;">
<p>2</p></td>
<td style="text-align: left;">
<p>3</p></td>
<td style="text-align: left;">
<p>2</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>1</p></td>
<td style="text-align: left;">
<p>4</p></td>
<td style="text-align: left;">
<p>2</p></td>
<td style="text-align: left;">
<p>1</p></td>
<td style="text-align: left;">
<p>1</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>2</p></td>
<td style="text-align: left;">
<p>3</p></td>
<td style="text-align: left;">
<p>0</p></td>
<td style="text-align: left;">
<p>2</p></td>
<td style="text-align: left;">
<p>1</p></td>
</tr>
<tr class="odd">
</tr>
</tbody>
</table>

<p>Consider the way the four folks might travel, 4!/(2!1!1!) = 12; consider three folks, 3!/(0!2!1!) = 3. All travel can be combined in 12*3 = 36 ways. The possible configuration of trips is, thus, seen to be much constrained by the column and row totals.</p>

<p>We put this point together with the earlier work with our matrix and the notion of most likely state to say that we want to</p>

<p>

<math display="block" id="Trip_distribution:35">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>max</mi>
     <mi>w</mi>
    </mrow>
    <mrow>
     <mo>(</mo>
     <msub>
      <mi>T</mi>
      <mrow>
       <mi>i</mi>
       <mi>j</mi>
      </mrow>
     </msub>
     <mo>)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mfrac>
    <mrow>
     <mi>T</mi>
     <mo lspace="0pt" rspace="3.5pt">!</mo>
    </mrow>
    <mrow>
     <msub>
      <mo largeop="true" symmetric="true">∏</mo>
      <mrow>
       <mi>i</mi>
       <mi>j</mi>
      </mrow>
     </msub>
     <mrow>
      <mi>T</mi>
      <mi>i</mi>
      <mrow>
       <mi>j</mi>
       <mo lspace="0pt" rspace="3.5pt">!</mo>
      </mrow>
     </mrow>
    </mrow>
   </mfrac>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <max></max>
      <ci>w</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>T</ci>
      <apply>
       <times></times>
       <ci>i</ci>
       <ci>j</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <divide></divide>
     <apply>
      <factorial></factorial>
      <ci>T</ci>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <csymbol cd="latexml">product</csymbol>
       <apply>
        <times></times>
        <ci>i</ci>
        <ci>j</ci>
       </apply>
      </apply>
      <apply>
       <times></times>
       <ci>T</ci>
       <ci>i</ci>
       <apply>
        <factorial></factorial>
        <ci>j</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \max w\left({T_{ij}}\right)=\frac{{T!}}{{\prod_{ij}{Tij!}}}
  </annotation>
 </semantics>
</math>

</p>

<p>subject to</p>

<p>

<math display="block" id="Trip_distribution:36">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <munder>
      <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
      <mi>j</mi>
     </munder>
     <msub>
      <mi>T</mi>
      <mrow>
       <mi>i</mi>
       <mi>j</mi>
      </mrow>
     </msub>
    </mrow>
    <mo>=</mo>
    <msub>
     <mi>T</mi>
     <mi>i</mi>
    </msub>
   </mrow>
   <mo>;</mo>
   <mrow>
    <mrow>
     <munder>
      <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
      <mi>i</mi>
     </munder>
     <msub>
      <mi>T</mi>
      <mrow>
       <mi>i</mi>
       <mi>j</mi>
      </mrow>
     </msub>
    </mrow>
    <mo>=</mo>
    <msub>
     <mi>T</mi>
     <mi>j</mi>
    </msub>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <eq></eq>
     <apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <ci>j</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>T</ci>
       <apply>
        <times></times>
        <ci>i</ci>
        <ci>j</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>T</ci>
      <ci>i</ci>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <ci>i</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>T</ci>
       <apply>
        <times></times>
        <ci>i</ci>
        <ci>j</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>T</ci>
      <ci>j</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \sum_{j}{T_{ij}=T_{i}};\sum_{i}{T_{ij}=T_{j}}
  </annotation>
 </semantics>
</math>

</p>

<p>where:</p>

<p>

<math display="block" id="Trip_distribution:37">
 <semantics>
  <mrow>
   <mi>T</mi>
   <mo>=</mo>
   <mrow>
    <munder>
     <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
     <mi>j</mi>
    </munder>
    <mrow>
     <munder>
      <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
      <mi>i</mi>
     </munder>
     <msub>
      <mi>T</mi>
      <mrow>
       <mi>i</mi>
       <mi>j</mi>
      </mrow>
     </msub>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <munder>
     <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
     <mi>i</mi>
    </munder>
    <msub>
     <mi>T</mi>
     <mi>i</mi>
    </msub>
   </mrow>
   <mo>=</mo>
   <mrow>
    <munder>
     <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
     <mi>j</mi>
    </munder>
    <msub>
     <mi>T</mi>
     <mi>j</mi>
    </msub>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <ci>T</ci>
     <apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <ci>j</ci>
      </apply>
      <apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <ci>i</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>T</ci>
        <apply>
         <times></times>
         <ci>i</ci>
         <ci>j</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <ci>i</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>T</ci>
       <ci>i</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <ci>j</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>T</ci>
       <ci>j</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   T=\sum_{j}{\sum_{i}{T_{ij}}}=\sum_{i}{T_{i}}=\sum_{j}{T_{j}}
  </annotation>
 </semantics>
</math>

</p>

<p>and this is the problem that we have solved above.</p>

<p>Wilson adds another consideration; he constrains the system to the amount of energy available (i.e., money), and we have the additional constraint,</p>

<p>

<math display="block" id="Trip_distribution:38">
 <semantics>
  <mrow>
   <mrow>
    <munder>
     <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
     <mi>i</mi>
    </munder>
    <mrow>
     <munder>
      <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
      <mi>j</mi>
     </munder>
     <mrow>
      <msub>
       <mi>T</mi>
       <mrow>
        <mi>i</mi>
        <mi>j</mi>
       </mrow>
      </msub>
      <msub>
       <mi>C</mi>
       <mrow>
        <mi>i</mi>
        <mi>j</mi>
       </mrow>
      </msub>
     </mrow>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mi>C</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <sum></sum>
      <ci>i</ci>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <ci>j</ci>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>T</ci>
        <apply>
         <times></times>
         <ci>i</ci>
         <ci>j</ci>
        </apply>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>C</ci>
        <apply>
         <times></times>
         <ci>i</ci>
         <ci>j</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
    <ci>C</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \sum_{i}{\sum_{j}{T_{ij}C_{ij}=C}}
  </annotation>
 </semantics>
</math>

</p>

<p>where <em>C</em> is the quantity of resources available and 

<math display="inline" id="Trip_distribution:39">
 <semantics>
  <msub>
   <mi>C</mi>
   <mrow>
    <mi>i</mi>
    <mi>j</mi>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>C</ci>
    <apply>
     <times></times>
     <ci>i</ci>
     <ci>j</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   C_{ij}
  </annotation>
 </semantics>
</math>

 is the travel cost from <em>i</em> to <em>j</em>.</p>

<p>The discussion thus far contains the central ideas in Wilson’s work, but we are not yet to the place where the reader will recognize the model as it is formulated by Wilson.</p>

<p>First, writing the 

<math display="inline" id="Trip_distribution:40">
 <semantics>
  <mi mathvariant="normal">Λ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>normal-Λ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Lambda
  </annotation>
 </semantics>
</math>

 function to be maximized using <a href="Lagrangian_multipliers" title="wikilink">Lagrangian multipliers</a>, we have:</p>

<p>

<math display="block" id="Trip_distribution:41">
 <semantics>
  <mrow>
   <mrow>
    <mi mathvariant="normal">Λ</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <msub>
      <mi>T</mi>
      <mrow>
       <mi>i</mi>
       <mi>j</mi>
      </mrow>
     </msub>
     <mo>,</mo>
     <msub>
      <mi>λ</mi>
      <mi>i</mi>
     </msub>
     <mo>,</mo>
     <msub>
      <mi>λ</mi>
      <mi>j</mi>
     </msub>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mfrac>
     <mrow>
      <mi>T</mi>
      <mo lspace="0pt" rspace="3.5pt">!</mo>
     </mrow>
     <mrow>
      <msub>
       <mo largeop="true" symmetric="true">∏</mo>
       <mrow>
        <mi>i</mi>
        <mi>j</mi>
       </mrow>
      </msub>
      <mrow>
       <mi>T</mi>
       <mi>i</mi>
       <mrow>
        <mi>j</mi>
        <mo lspace="0pt" rspace="3.5pt">!</mo>
       </mrow>
      </mrow>
     </mrow>
    </mfrac>
    <mo>+</mo>
    <mrow>
     <munder>
      <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
      <mi>i</mi>
     </munder>
     <mrow>
      <msub>
       <mi>λ</mi>
       <mi>i</mi>
      </msub>
      <mrow>
       <mo>(</mo>
       <mrow>
        <msub>
         <mi>T</mi>
         <mi>i</mi>
        </msub>
        <mo>-</mo>
        <mrow>
         <munder>
          <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
          <mi>j</mi>
         </munder>
         <msub>
          <mi>T</mi>
          <mrow>
           <mi>i</mi>
           <mi>j</mi>
          </mrow>
         </msub>
        </mrow>
       </mrow>
       <mo>)</mo>
      </mrow>
     </mrow>
    </mrow>
    <mo>+</mo>
    <mrow>
     <munder>
      <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
      <mi>j</mi>
     </munder>
     <mrow>
      <msub>
       <mi>λ</mi>
       <mi>j</mi>
      </msub>
      <mrow>
       <mo>(</mo>
       <mrow>
        <msub>
         <mi>T</mi>
         <mi>j</mi>
        </msub>
        <mo>-</mo>
        <mrow>
         <munder>
          <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
          <mi>i</mi>
         </munder>
         <msub>
          <mi>T</mi>
          <mrow>
           <mi>i</mi>
           <mi>j</mi>
          </mrow>
         </msub>
        </mrow>
       </mrow>
       <mo>)</mo>
      </mrow>
     </mrow>
    </mrow>
    <mo>+</mo>
    <mrow>
     <mi>β</mi>
     <mrow>
      <mo>(</mo>
      <mrow>
       <mi>C</mi>
       <mo>-</mo>
       <mrow>
        <munder>
         <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
         <mi>i</mi>
        </munder>
        <mrow>
         <munder>
          <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
          <mi>j</mi>
         </munder>
         <mrow>
          <msub>
           <mi>T</mi>
           <mrow>
            <mi>i</mi>
            <mi>j</mi>
           </mrow>
          </msub>
          <msub>
           <mi>C</mi>
           <mrow>
            <mi>i</mi>
            <mi>j</mi>
           </mrow>
          </msub>
         </mrow>
        </mrow>
       </mrow>
      </mrow>
      <mo>)</mo>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>normal-Λ</ci>
     <vector>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>T</ci>
       <apply>
        <times></times>
        <ci>i</ci>
        <ci>j</ci>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>λ</ci>
       <ci>i</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>λ</ci>
       <ci>j</ci>
      </apply>
     </vector>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <divide></divide>
      <apply>
       <factorial></factorial>
       <ci>T</ci>
      </apply>
      <apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <csymbol cd="latexml">product</csymbol>
        <apply>
         <times></times>
         <ci>i</ci>
         <ci>j</ci>
        </apply>
       </apply>
       <apply>
        <times></times>
        <ci>T</ci>
        <ci>i</ci>
        <apply>
         <factorial></factorial>
         <ci>j</ci>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <ci>i</ci>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>λ</ci>
        <ci>i</ci>
       </apply>
       <apply>
        <minus></minus>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>T</ci>
         <ci>i</ci>
        </apply>
        <apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <sum></sum>
          <ci>j</ci>
         </apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>T</ci>
          <apply>
           <times></times>
           <ci>i</ci>
           <ci>j</ci>
          </apply>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <ci>j</ci>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>λ</ci>
        <ci>j</ci>
       </apply>
       <apply>
        <minus></minus>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>T</ci>
         <ci>j</ci>
        </apply>
        <apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <sum></sum>
          <ci>i</ci>
         </apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>T</ci>
          <apply>
           <times></times>
           <ci>i</ci>
           <ci>j</ci>
          </apply>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <ci>β</ci>
      <apply>
       <minus></minus>
       <ci>C</ci>
       <apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <sum></sum>
         <ci>i</ci>
        </apply>
        <apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <sum></sum>
          <ci>j</ci>
         </apply>
         <apply>
          <times></times>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>T</ci>
           <apply>
            <times></times>
            <ci>i</ci>
            <ci>j</ci>
           </apply>
          </apply>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>C</ci>
           <apply>
            <times></times>
            <ci>i</ci>
            <ci>j</ci>
           </apply>
          </apply>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Lambda(T_{ij},\lambda_{i},\lambda_{j})=\frac{{T!}}{{\prod_{ij}{Tij!}}}+\sum_{%
i}{\lambda_{i}\left({T_{i}-\sum_{j}{T_{ij}}}\right)}+\sum_{j}{\lambda_{j}\left%
({T_{j}-\sum_{i}{T_{ij}}}\right)+\beta\left({C-\sum_{i}{\sum_{j}{T_{ij}C_{ij}}%
}}\right)}
  </annotation>
 </semantics>
</math>

</p>

<p>where 

<math display="inline" id="Trip_distribution:42">
 <semantics>
  <mrow>
   <msub>
    <mi>λ</mi>
    <mi>i</mi>
   </msub>
   <mo>,</mo>
   <msub>
    <mi>λ</mi>
    <mi>j</mi>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <list>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>λ</ci>
     <ci>i</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>λ</ci>
     <ci>j</ci>
    </apply>
   </list>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \lambda_{i},\lambda_{j}
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Trip_distribution:43">
 <semantics>
  <mi>β</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>β</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \beta
  </annotation>
 </semantics>
</math>

 are the Lagrange multipliers, 

<math display="inline" id="Trip_distribution:44">
 <semantics>
  <mi>β</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>β</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \beta
  </annotation>
 </semantics>
</math>

 having an energy sense.</p>

<p>Second, it is convenient to maximize the natural log (ln) rather than 

<math display="inline" id="Trip_distribution:45">
 <semantics>
  <mrow>
   <mi>w</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>T</mi>
     <mrow>
      <mi>i</mi>
      <mi>j</mi>
     </mrow>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>w</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>T</ci>
     <apply>
      <times></times>
      <ci>i</ci>
      <ci>j</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   w(T_{ij})
  </annotation>
 </semantics>
</math>

, for then we may use <a href="Stirling's_approximation" title="wikilink">Stirling's approximation</a>.</p>

<p>

<math display="block" id="Trip_distribution:46">
 <semantics>
  <mrow>
   <mrow>
    <mi>ln</mi>
    <mrow>
     <mi>N</mi>
     <mo lspace="0pt" rspace="3.5pt">!</mo>
    </mrow>
   </mrow>
   <mo>≈</mo>
   <mrow>
    <mrow>
     <mi>N</mi>
     <mrow>
      <mi>ln</mi>
      <mi>N</mi>
     </mrow>
    </mrow>
    <mo>-</mo>
    <mi>N</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <approx></approx>
    <apply>
     <ln></ln>
     <apply>
      <factorial></factorial>
      <ci>N</ci>
     </apply>
    </apply>
    <apply>
     <minus></minus>
     <apply>
      <times></times>
      <ci>N</ci>
      <apply>
       <ln></ln>
       <ci>N</ci>
      </apply>
     </apply>
     <ci>N</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \ln N!\approx N\ln N-N
  </annotation>
 </semantics>
</math>

</p>

<p>so</p>

<p>

<math display="block" id="Trip_distribution:47">
 <semantics>
  <mrow>
   <mfrac>
    <mrow>
     <mrow>
      <mo>∂</mo>
      <mi>ln</mi>
     </mrow>
     <mrow>
      <mi>N</mi>
      <mo lspace="0pt" rspace="3.5pt">!</mo>
     </mrow>
    </mrow>
    <mrow>
     <mo>∂</mo>
     <mi>N</mi>
    </mrow>
   </mfrac>
   <mo>≈</mo>
   <mrow>
    <mi>ln</mi>
    <mi>N</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <approx></approx>
    <apply>
     <divide></divide>
     <apply>
      <apply>
       <partialdiff></partialdiff>
       <ln></ln>
      </apply>
      <apply>
       <factorial></factorial>
       <ci>N</ci>
      </apply>
     </apply>
     <apply>
      <partialdiff></partialdiff>
      <ci>N</ci>
     </apply>
    </apply>
    <apply>
     <ln></ln>
     <ci>N</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \frac{{\partial\ln N!}}{{\partial N}}\approx\ln N
  </annotation>
 </semantics>
</math>

</p>

<p>Third, evaluating the maximum, we have</p>

<p>

<math display="block" id="Trip_distribution:48">
 <semantics>
  <mrow>
   <mfrac>
    <mrow>
     <mrow>
      <mo>∂</mo>
      <mi mathvariant="normal">Λ</mi>
     </mrow>
     <mrow>
      <mo stretchy="false">(</mo>
      <msub>
       <mi>T</mi>
       <mrow>
        <mi>i</mi>
        <mi>j</mi>
       </mrow>
      </msub>
      <mo>,</mo>
      <msub>
       <mi>λ</mi>
       <mi>i</mi>
      </msub>
      <mo>,</mo>
      <msub>
       <mi>λ</mi>
       <mi>j</mi>
      </msub>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mrow>
     <mo>∂</mo>
     <msub>
      <mi>T</mi>
      <mrow>
       <mi>i</mi>
       <mi>j</mi>
      </mrow>
     </msub>
    </mrow>
   </mfrac>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mo>-</mo>
     <mrow>
      <mi>ln</mi>
      <msub>
       <mi>T</mi>
       <mrow>
        <mi>i</mi>
        <mi>j</mi>
       </mrow>
      </msub>
     </mrow>
    </mrow>
    <mo>-</mo>
    <msub>
     <mi>λ</mi>
     <mi>i</mi>
    </msub>
    <mo>-</mo>
    <msub>
     <mi>λ</mi>
     <mi>j</mi>
    </msub>
    <mo>-</mo>
    <mrow>
     <mi>β</mi>
     <msub>
      <mi>C</mi>
      <mrow>
       <mi>i</mi>
       <mi>j</mi>
      </mrow>
     </msub>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <divide></divide>
      <apply>
       <times></times>
       <apply>
        <partialdiff></partialdiff>
        <ci>normal-Λ</ci>
       </apply>
       <vector>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>T</ci>
         <apply>
          <times></times>
          <ci>i</ci>
          <ci>j</ci>
         </apply>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>λ</ci>
         <ci>i</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>λ</ci>
         <ci>j</ci>
        </apply>
       </vector>
      </apply>
      <apply>
       <partialdiff></partialdiff>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>T</ci>
        <apply>
         <times></times>
         <ci>i</ci>
         <ci>j</ci>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <minus></minus>
      <apply>
       <minus></minus>
       <apply>
        <ln></ln>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>T</ci>
         <apply>
          <times></times>
          <ci>i</ci>
          <ci>j</ci>
         </apply>
        </apply>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>λ</ci>
       <ci>i</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>λ</ci>
       <ci>j</ci>
      </apply>
      <apply>
       <times></times>
       <ci>β</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>C</ci>
        <apply>
         <times></times>
         <ci>i</ci>
         <ci>j</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <cn type="integer">0</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \frac{{\partial\Lambda(T_{ij},\lambda_{i},\lambda_{j})}}{{\partial T_{ij}}}=-%
\ln T_{ij}-\lambda_{i}-\lambda_{j}-\beta C_{ij}=0
  </annotation>
 </semantics>
</math>

</p>

<p>with solution</p>

<p>

<math display="block" id="Trip_distribution:49">
 <semantics>
  <mrow>
   <mrow>
    <mi>ln</mi>
    <msub>
     <mi>T</mi>
     <mrow>
      <mi>i</mi>
      <mi>j</mi>
     </mrow>
    </msub>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mo>-</mo>
     <msub>
      <mi>λ</mi>
      <mi>i</mi>
     </msub>
    </mrow>
    <mo>-</mo>
    <msub>
     <mi>λ</mi>
     <mi>j</mi>
    </msub>
    <mo>-</mo>
    <mrow>
     <mi>β</mi>
     <msub>
      <mi>C</mi>
      <mrow>
       <mi>i</mi>
       <mi>j</mi>
      </mrow>
     </msub>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <ln></ln>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>T</ci>
      <apply>
       <times></times>
       <ci>i</ci>
       <ci>j</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <minus></minus>
     <apply>
      <minus></minus>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>λ</ci>
       <ci>i</ci>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>λ</ci>
      <ci>j</ci>
     </apply>
     <apply>
      <times></times>
      <ci>β</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>C</ci>
       <apply>
        <times></times>
        <ci>i</ci>
        <ci>j</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \ln T_{ij}=-\lambda_{i}-\lambda_{j}-\beta C_{ij}
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Trip_distribution:50">
 <semantics>
  <mrow>
   <msub>
    <mi>T</mi>
    <mrow>
     <mi>i</mi>
     <mi>j</mi>
    </mrow>
   </msub>
   <mo>=</mo>
   <msup>
    <mi>e</mi>
    <mrow>
     <mrow>
      <mo>-</mo>
      <msub>
       <mi>λ</mi>
       <mi>i</mi>
      </msub>
     </mrow>
     <mo>-</mo>
     <msub>
      <mi>λ</mi>
      <mi>j</mi>
     </msub>
     <mo>-</mo>
     <mrow>
      <mi>β</mi>
      <msub>
       <mi>C</mi>
       <mrow>
        <mi>i</mi>
        <mi>j</mi>
       </mrow>
      </msub>
     </mrow>
    </mrow>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>T</ci>
     <apply>
      <times></times>
      <ci>i</ci>
      <ci>j</ci>
     </apply>
    </apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>e</ci>
     <apply>
      <minus></minus>
      <apply>
       <minus></minus>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>λ</ci>
        <ci>i</ci>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>λ</ci>
       <ci>j</ci>
      </apply>
      <apply>
       <times></times>
       <ci>β</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>C</ci>
        <apply>
         <times></times>
         <ci>i</ci>
         <ci>j</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   T_{ij}=e^{-\lambda_{i}-\lambda_{j}-\beta C_{ij}}
  </annotation>
 </semantics>
</math>

</p>

<p>Finally, substituting this value of 

<math display="inline" id="Trip_distribution:51">
 <semantics>
  <msub>
   <mi>T</mi>
   <mrow>
    <mi>i</mi>
    <mi>j</mi>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>T</ci>
    <apply>
     <times></times>
     <ci>i</ci>
     <ci>j</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   T_{ij}
  </annotation>
 </semantics>
</math>

 back into our constraint equations, we have:</p>

<p>

<math display="block" id="Trip_distribution:52">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <munder>
      <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
      <mi>j</mi>
     </munder>
     <msup>
      <mi>e</mi>
      <mrow>
       <mrow>
        <mo>-</mo>
        <msub>
         <mi>λ</mi>
         <mi>i</mi>
        </msub>
       </mrow>
       <mo>-</mo>
       <msub>
        <mi>λ</mi>
        <mi>j</mi>
       </msub>
       <mo>-</mo>
       <mrow>
        <mi>β</mi>
        <msub>
         <mi>C</mi>
         <mrow>
          <mi>i</mi>
          <mi>j</mi>
         </mrow>
        </msub>
       </mrow>
      </mrow>
     </msup>
    </mrow>
    <mo>=</mo>
    <msub>
     <mi>T</mi>
     <mi>i</mi>
    </msub>
   </mrow>
   <mo>;</mo>
   <mrow>
    <mrow>
     <munder>
      <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
      <mi>i</mi>
     </munder>
     <msup>
      <mi>e</mi>
      <mrow>
       <mrow>
        <mo>-</mo>
        <msub>
         <mi>λ</mi>
         <mi>i</mi>
        </msub>
       </mrow>
       <mo>-</mo>
       <msub>
        <mi>λ</mi>
        <mi>j</mi>
       </msub>
       <mo>-</mo>
       <mrow>
        <mi>β</mi>
        <msub>
         <mi>C</mi>
         <mrow>
          <mi>i</mi>
          <mi>j</mi>
         </mrow>
        </msub>
       </mrow>
      </mrow>
     </msup>
    </mrow>
    <mo>=</mo>
    <msub>
     <mi>T</mi>
     <mi>j</mi>
    </msub>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <eq></eq>
     <apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <ci>j</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>e</ci>
       <apply>
        <minus></minus>
        <apply>
         <minus></minus>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>λ</ci>
          <ci>i</ci>
         </apply>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>λ</ci>
         <ci>j</ci>
        </apply>
        <apply>
         <times></times>
         <ci>β</ci>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>C</ci>
          <apply>
           <times></times>
           <ci>i</ci>
           <ci>j</ci>
          </apply>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>T</ci>
      <ci>i</ci>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <ci>i</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>e</ci>
       <apply>
        <minus></minus>
        <apply>
         <minus></minus>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>λ</ci>
          <ci>i</ci>
         </apply>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>λ</ci>
         <ci>j</ci>
        </apply>
        <apply>
         <times></times>
         <ci>β</ci>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>C</ci>
          <apply>
           <times></times>
           <ci>i</ci>
           <ci>j</ci>
          </apply>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>T</ci>
      <ci>j</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \sum_{j}{e^{-\lambda_{i}-\lambda_{j}-\beta C_{ij}}}=T_{i};\sum_{i}{e^{-\lambda%
_{i}-\lambda_{j}-\beta C_{ij}}}=T_{j}
  </annotation>
 </semantics>
</math>

</p>

<p>and, taking the constant multiples outside of the summation sign</p>

<p>

<math display="block" id="Trip_distribution:53">
 <semantics>
  <mrow>
   <mrow>
    <msup>
     <mi>e</mi>
     <mrow>
      <mo>-</mo>
      <msub>
       <mi>λ</mi>
       <mi>i</mi>
      </msub>
     </mrow>
    </msup>
    <mo>=</mo>
    <mfrac>
     <msub>
      <mi>T</mi>
      <mi>i</mi>
     </msub>
     <mrow>
      <msub>
       <mo largeop="true" symmetric="true">∑</mo>
       <mi>j</mi>
      </msub>
      <msup>
       <mi>e</mi>
       <mrow>
        <mrow>
         <mo>-</mo>
         <msub>
          <mi>λ</mi>
          <mi>j</mi>
         </msub>
        </mrow>
        <mo>-</mo>
        <mrow>
         <mi>β</mi>
         <msub>
          <mi>C</mi>
          <mrow>
           <mi>i</mi>
           <mi>j</mi>
          </mrow>
         </msub>
        </mrow>
       </mrow>
      </msup>
     </mrow>
    </mfrac>
   </mrow>
   <mo>;</mo>
   <mrow>
    <msup>
     <mi>e</mi>
     <mrow>
      <mo>-</mo>
      <msub>
       <mi>λ</mi>
       <mi>j</mi>
      </msub>
     </mrow>
    </msup>
    <mo>=</mo>
    <mfrac>
     <msub>
      <mi>T</mi>
      <mi>j</mi>
     </msub>
     <mrow>
      <msub>
       <mo largeop="true" symmetric="true">∑</mo>
       <mi>i</mi>
      </msub>
      <msup>
       <mi>e</mi>
       <mrow>
        <mrow>
         <mo>-</mo>
         <msub>
          <mi>λ</mi>
          <mi>i</mi>
         </msub>
        </mrow>
        <mo>-</mo>
        <mrow>
         <mi>β</mi>
         <msub>
          <mi>C</mi>
          <mrow>
           <mi>i</mi>
           <mi>j</mi>
          </mrow>
         </msub>
        </mrow>
       </mrow>
      </msup>
     </mrow>
    </mfrac>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>e</ci>
      <apply>
       <minus></minus>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>λ</ci>
        <ci>i</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <divide></divide>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>T</ci>
       <ci>i</ci>
      </apply>
      <apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <ci>j</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>e</ci>
        <apply>
         <minus></minus>
         <apply>
          <minus></minus>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>λ</ci>
           <ci>j</ci>
          </apply>
         </apply>
         <apply>
          <times></times>
          <ci>β</ci>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>C</ci>
           <apply>
            <times></times>
            <ci>i</ci>
            <ci>j</ci>
           </apply>
          </apply>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>e</ci>
      <apply>
       <minus></minus>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>λ</ci>
        <ci>j</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <divide></divide>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>T</ci>
       <ci>j</ci>
      </apply>
      <apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <ci>i</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>e</ci>
        <apply>
         <minus></minus>
         <apply>
          <minus></minus>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>λ</ci>
           <ci>i</ci>
          </apply>
         </apply>
         <apply>
          <times></times>
          <ci>β</ci>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>C</ci>
           <apply>
            <times></times>
            <ci>i</ci>
            <ci>j</ci>
           </apply>
          </apply>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   e^{-\lambda_{i}}=\frac{{T_{i}}}{{\sum_{j}{e^{-\lambda_{j}-\beta C_{ij}}}}};e^{%
-\lambda_{j}}=\frac{{T_{j}}}{{\sum_{i}{e^{-\lambda_{i}-\beta C_{ij}}}}}
  </annotation>
 </semantics>
</math>

</p>

<p>Let</p>

<p>

<math display="block" id="Trip_distribution:54">
 <semantics>
  <mrow>
   <mrow>
    <mfrac>
     <msup>
      <mi>e</mi>
      <mrow>
       <mo>-</mo>
       <msub>
        <mi>λ</mi>
        <mi>i</mi>
       </msub>
      </mrow>
     </msup>
     <msub>
      <mi>T</mi>
      <mi>i</mi>
     </msub>
    </mfrac>
    <mo>=</mo>
    <msub>
     <mi>A</mi>
     <mi>i</mi>
    </msub>
   </mrow>
   <mo>;</mo>
   <mrow>
    <mfrac>
     <msup>
      <mi>e</mi>
      <mrow>
       <mo>-</mo>
       <msub>
        <mi>λ</mi>
        <mi>j</mi>
       </msub>
      </mrow>
     </msup>
     <msub>
      <mi>T</mi>
      <mi>j</mi>
     </msub>
    </mfrac>
    <mo>=</mo>
    <msub>
     <mi>B</mi>
     <mi>j</mi>
    </msub>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <eq></eq>
     <apply>
      <divide></divide>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>e</ci>
       <apply>
        <minus></minus>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>λ</ci>
         <ci>i</ci>
        </apply>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>T</ci>
       <ci>i</ci>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>A</ci>
      <ci>i</ci>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <apply>
      <divide></divide>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>e</ci>
       <apply>
        <minus></minus>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>λ</ci>
         <ci>j</ci>
        </apply>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>T</ci>
       <ci>j</ci>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>B</ci>
      <ci>j</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \frac{{e^{-\lambda_{i}}}}{{T_{i}}}=A_{i};\frac{{e^{-\lambda_{j}}}}{{T_{j}}}=B_%
{j}
  </annotation>
 </semantics>
</math>

</p>

<p>we have</p>

<p>

<math display="block" id="Trip_distribution:55">
 <semantics>
  <mrow>
   <msub>
    <mi>T</mi>
    <mrow>
     <mi>i</mi>
     <mi>j</mi>
    </mrow>
   </msub>
   <mo>=</mo>
   <mrow>
    <msub>
     <mi>A</mi>
     <mi>i</mi>
    </msub>
    <msub>
     <mi>B</mi>
     <mi>j</mi>
    </msub>
    <msub>
     <mi>T</mi>
     <mi>i</mi>
    </msub>
    <msub>
     <mi>T</mi>
     <mi>j</mi>
    </msub>
    <msup>
     <mi>e</mi>
     <mrow>
      <mo>-</mo>
      <mrow>
       <mi>β</mi>
       <msub>
        <mi>C</mi>
        <mrow>
         <mi>i</mi>
         <mi>j</mi>
        </mrow>
       </msub>
      </mrow>
     </mrow>
    </msup>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>T</ci>
     <apply>
      <times></times>
      <ci>i</ci>
      <ci>j</ci>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>A</ci>
      <ci>i</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>B</ci>
      <ci>j</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>T</ci>
      <ci>i</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>T</ci>
      <ci>j</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>e</ci>
      <apply>
       <minus></minus>
       <apply>
        <times></times>
        <ci>β</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>C</ci>
         <apply>
          <times></times>
          <ci>i</ci>
          <ci>j</ci>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   T_{ij}=A_{i}B_{j}T_{i}T_{j}e^{-\beta C_{ij}}
  </annotation>
 </semantics>
</math>

</p>

<p>which says that the most probable distribution of trips has a gravity model form, 

<math display="inline" id="Trip_distribution:56">
 <semantics>
  <msub>
   <mi>T</mi>
   <mrow>
    <mi>i</mi>
    <mi>j</mi>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>T</ci>
    <apply>
     <times></times>
     <ci>i</ci>
     <ci>j</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   T_{ij}
  </annotation>
 </semantics>
</math>

 is proportional to trip origins and destinations. The constants 

<math display="inline" id="Trip_distribution:57">
 <semantics>
  <msub>
   <mi>A</mi>
   <mi>i</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>A</ci>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A_{i}
  </annotation>
 </semantics>
</math>

, 

<math display="inline" id="Trip_distribution:58">
 <semantics>
  <msub>
   <mi>B</mi>
   <mi>j</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>B</ci>
    <ci>j</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   B_{j}
  </annotation>
 </semantics>
</math>

, and 

<math display="inline" id="Trip_distribution:59">
 <semantics>
  <mi>β</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>β</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \beta
  </annotation>
 </semantics>
</math>

 ensure that constraints are met.</p>

<p>Turning now to computation, we have a large problem. First, we do not know the value of <em>C</em>, which earlier on we said had to do with the money available, it was a cost constraint. Consequently, we have to set 

<math display="inline" id="Trip_distribution:60">
 <semantics>
  <mi>β</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>β</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \beta
  </annotation>
 </semantics>
</math>

 to different values and then find the best set of values for 

<math display="inline" id="Trip_distribution:61">
 <semantics>
  <msub>
   <mi>A</mi>
   <mi>i</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>A</ci>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A_{i}
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Trip_distribution:62">
 <semantics>
  <msub>
   <mi>B</mi>
   <mi>j</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>B</ci>
    <ci>j</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   B_{j}
  </annotation>
 </semantics>
</math>

. We know what 

<math display="inline" id="Trip_distribution:63">
 <semantics>
  <mi>β</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>β</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \beta
  </annotation>
 </semantics>
</math>

 means – the greater the value of 

<math display="inline" id="Trip_distribution:64">
 <semantics>
  <mi>β</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>β</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \beta
  </annotation>
 </semantics>
</math>

, the less the cost of average distance traveled. (Compare 

<math display="inline" id="Trip_distribution:65">
 <semantics>
  <mi>β</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>β</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \beta
  </annotation>
 </semantics>
</math>

 in Boltzmann's Law noted earlier.) Second, the values of 

<math display="inline" id="Trip_distribution:66">
 <semantics>
  <msub>
   <mi>A</mi>
   <mi>i</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>A</ci>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A_{i}
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Trip_distribution:67">
 <semantics>
  <msub>
   <mi>B</mi>
   <mi>j</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>B</ci>
    <ci>j</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   B_{j}
  </annotation>
 </semantics>
</math>

 depend on each other. So for each value of 

<math display="inline" id="Trip_distribution:68">
 <semantics>
  <mi>β</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>β</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \beta
  </annotation>
 </semantics>
</math>

, we must use an iterative solution. There are computer programs to do this.</p>

<p>Wilson's method has been applied to the <a href="Lowry_model" title="wikilink">Lowry model</a>.</p>
<h2 id="issues">Issues</h2>

<p>One of the key drawbacks to the application of many early models was the inability to take account of congested travel time on the road network in determining the probability of making a trip between two locations. Although Wohl noted as early as 1963 research into the feedback mechanism or the “interdependencies among assigned or distributed volume, travel time (or travel ‘resistance’) and route or system capacity”, this work has yet to be widely adopted with rigorous tests of convergence, or with a so-called “equilibrium” or “combined” solution (Boyce et al. 1994). Haney (1972) suggests internal assumptions about travel time used to develop demand should be consistent with the output travel times of the route assignment of that demand. While small methodological inconsistencies are necessarily a problem for estimating base year conditions, forecasting becomes even more tenuous without an understanding of the feedback between supply and demand. Initially heuristic methods were developed by Irwin and Von Cube (as quoted in Florian et al. (1975) ) and others, and later formal mathematical programming techniques were established by Evans (1976).</p>

<p>A key point in analyzing feedback is the finding in earlier research by Levinson and Kumar (1994) that commuting times have remained stable over the past thirty years in the Washington Metropolitan Region, despite significant changes in household income, land use pattern, family structure, and labor force participation. Similar results have been found in the Twin Cities by Barnes and Davis (2000).</p>

<p>The stability of travel times and distribution curves over the past three decades gives a good basis for the application of aggregate trip distribution models for relatively long term forecasting. This is not to suggest that there exists a constant <a href="travel_time_budget" title="wikilink">travel time budget</a>.</p>
<h2 id="see-also">See also</h2>
<ul>
<li><a href="Environmental_impact_of_aviation" title="wikilink">Environmental impact of aviation</a></li>
<li><a href="Hypermobility_(travel)" title="wikilink">Hypermobility (travel)</a></li>
</ul>
<h2 id="references">References</h2>
<ul>
<li>Allen, B. 1984 Trip Distribution Using Composite Impedance Transportation Research Record 944 pp. 118–127</li>
<li>Barnes, G. and Davis, G. 2000. Understanding Urban Travel Demand: Problems, Solutions, and the Role of Forecasting, University of Minnesota Center for Transportation Studies: Transportation and Regional Growth Study</li>
<li>Ben-Akiva M. and Lerman S. 1985 Discrete Choice Analysis, MIT Press, Cambridge MA</li>
<li>Boyce, D., Lupa, M. and Zhang, Y.F. 1994 Introducing “Feedback” into the Four-Step Travel Forecasting Procedure vs. the Equilibrium Solution of a Combined Model presented at 73rd Annual Meeting of Transportation Research Board</li>
<li>Evans, Suzanne P. 1976 . Derivation and Analysis of Some Models for Combining Trip Distribution and Assignment. Transportation Research, Vol. 10, PP 37–57 1976</li>
<li>Florian M., Nguyen S., and Ferland J. 1975 On the Combined Distribution-Assignment of Traffic", Transportation Science, Vol. 9, pp. 43–53, 1975</li>
<li>Haney, D. 1972 Consistency in Transportation Demand and Evaluation Models, Highway Research Record 392, pp. 13–25 1972</li>
<li>Hansen, W. G. 1959. How accessibility shapes land use. <a href="Journal_of_the_American_Institute_of_Planners" title="wikilink">Journal of the American Institute of Planners</a>, 25(2), 73–76.</li>
<li>Heanue, Kevin E. and Pyers, Clyde E. 1966. A Comparative Evaluation of Trip Distribution Procedures,</li>
<li>Levinson, D. and A. Kumar 1994 The Rational Locator: Why Travel Times Have Remained Stable, Journal of the American Planning Association, 60:3 319–332</li>
<li>Levinson, D. and Kumar A. 1995. A Multi-modal Trip Distribution Model. Transportation Research Record #1466: 124–131.</li>
<li>Portland MPO Report to Federal Transit Administration on Transit Modeling</li>
<li>Reilly, W.J. (1929) “Methods for the Study of Retail Relationships” University of Texas Bulletin No 2944, Nov. 1929.</li>
<li>Reilly, W.J., 1931. The Law of Retail Gravitation, New York.</li>
<li>Ruiter, E. 1967 Improvements in Understanding, Calibrating, and Applying the Opportunity Model Highway Research Record No. 165 pp. 1–21</li>
<li>Stewart, J.Q. (1948) “Demographic Gravitation: Evidence and Application” Sociometry Vol. XI Feb.–May 1948 pp 31–58.</li>
<li>Stewart, J.Q., 1947. Empirical Mathematical Rules Concerning the Distribution and Equilibrium of Population, Geographical Review, Vol 37, 461–486.</li>
<li>Stewart, J.Q., 1950. Potential of Population and its Relationship to Marketing. In: Theory in Marketing, R. Cox and W. Alderson (Eds) ( Richard D. Irwin, Inc., Homewood, Illinois).</li>
<li>Stewart, J.Q., 1950. The Development of Social Physics, American Journal of Physics, Vol 18, 239–253</li>
<li>Voorhees, Alan M., 1956, "A General Theory of Traffic Movement," 1955 Proceedings, Institute of Traffic Engineers, New Haven, Connecticut.</li>
<li>Whitaker, R. and K. West 1968 The Intervening Opportunities Model: A Theoretical Consideration Highway Research Record 250 pp. 1–7</li>
<li>Wilson, A.G. A Statistical Theory of Spatial Distribution Models Transportation Research, Volume 1, pp. 253–269 1967</li>
<li>Wohl, M. 1963 Demand, Cost, Price and Capacity Relationships Applied to Travel Forecasting. Highway Research Record 38:40–54</li>
<li><a href="Zipf,_G._K." title="wikilink">Zipf, G. K.</a>, 1946. The Hypothesis on the Intercity Movement of Persons. American Sociological Review, vol. 11, Oct</li>
<li>Zipf, G. K., 1949. Human Behaviour and the Principle of Least Effort. Massachusetts</li>
</ul>
<h2 id="external-links">External links</h2>
<ul>
<li><a href="http://www.atsl.cee.vt.edu/tsam.htm">Transportation Systems Analysis Model</a> — TSAM is a nationwide transportation planning model to forecast intercity travel behavior in the United States.</li>
</ul>
<ul>
<li><a href="http://tdsi.gov.vn">Transport modeller in viet nam</a></li>
</ul>

<p>"</p>

<p><a href="Category:Transportation_planning" title="wikilink">Category:Transportation planning</a></p>
</body>
</html>

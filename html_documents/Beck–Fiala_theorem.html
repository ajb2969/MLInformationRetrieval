<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="1915">Beck–Fiala theorem</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Beck–Fiala theorem</h1>
<hr/>

<p>In mathematics, the <strong>Beck–Fiala theorem</strong> is a major theorem in <a href="discrepancy_theory" title="wikilink">discrepancy theory</a> due to <a href="József_Beck" title="wikilink">József Beck</a> and <a href="Tibor_Fiala" title="wikilink">Tibor Fiala</a>. Discrepancy is concerned with coloring elements of a ground set such that each set in a certain set system is as balanced as possible, i.e., has approximately the same number of elements of each color. The Beck–Fiala theorem is concerned with the case where each element doesn't appear many times across all sets. The theorem guarantees that if each element appears at most <em>t</em>, then the elements can be colored so that the imbalance is bounded by 2<em>t</em> − 1.</p>
<h2 id="statement">Statement</h2>

<p>Formally, given a universe</p>

<p>

<math display="block" id="Beck–Fiala_theorem:0">
 <semantics>
  <mrow>
   <mrow>
    <mo stretchy="false">[</mo>
    <mi>n</mi>
    <mo stretchy="false">]</mo>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mo stretchy="false">{</mo>
    <mn>1</mn>
    <mo>,</mo>
    <mi mathvariant="normal">…</mi>
    <mo>,</mo>
    <mi>n</mi>
    <mo stretchy="false">}</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="latexml">delimited-[]</csymbol>
     <ci>n</ci>
    </apply>
    <set>
     <cn type="integer">1</cn>
     <ci>normal-…</ci>
     <ci>n</ci>
    </set>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   [n]=\{1,\ldots,n\}
  </annotation>
 </semantics>
</math>

</p>

<p>and a collection of subsets</p>

<p>

<math display="block" id="Beck–Fiala_theorem:1">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>S</mi>
     <mn>1</mn>
    </msub>
    <mo>,</mo>
    <msub>
     <mi>S</mi>
     <mn>2</mn>
    </msub>
    <mo>,</mo>
    <mi mathvariant="normal">…</mi>
    <mo>,</mo>
    <msub>
     <mi>S</mi>
     <mi>m</mi>
    </msub>
   </mrow>
   <mo>⊆</mo>
   <mrow>
    <mo stretchy="false">[</mo>
    <mi>n</mi>
    <mo stretchy="false">]</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <subset></subset>
    <list>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>S</ci>
      <cn type="integer">1</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>S</ci>
      <cn type="integer">2</cn>
     </apply>
     <ci>normal-…</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>S</ci>
      <ci>m</ci>
     </apply>
    </list>
    <apply>
     <csymbol cd="latexml">delimited-[]</csymbol>
     <ci>n</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   S_{1},S_{2},\ldots,S_{m}\subseteq[n]
  </annotation>
 </semantics>
</math>

</p>

<p>such that for each 

<math display="inline" id="Beck–Fiala_theorem:2">
 <semantics>
  <mrow>
   <mi>i</mi>
   <mo>∈</mo>
   <mrow>
    <mo stretchy="false">[</mo>
    <mi>n</mi>
    <mo stretchy="false">]</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <in></in>
    <ci>i</ci>
    <apply>
     <csymbol cd="latexml">delimited-[]</csymbol>
     <ci>n</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   i\in[n]
  </annotation>
 </semantics>
</math>

,</p>

<p>

<math display="block" id="Beck–Fiala_theorem:3">
 <semantics>
  <mrow>
   <mo stretchy="false">|</mo>
   <mrow>
    <mo stretchy="false">{</mo>
    <mi>j</mi>
    <mo>;</mo>
    <mi>i</mi>
    <mo>∈</mo>
    <msub>
     <mi>S</mi>
     <mi>j</mi>
    </msub>
    <mo stretchy="false">}</mo>
   </mrow>
   <mo stretchy="false">|</mo>
   <mo>≤</mo>
   <mi>t</mi>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <ci>normal-|</ci>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-{</ci>
     <csymbol cd="unknown">j</csymbol>
     <ci>normal-;</ci>
     <csymbol cd="unknown">i</csymbol>
     <in></in>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>S</ci>
      <ci>j</ci>
     </apply>
     <ci>normal-}</ci>
    </cerror>
    <ci>normal-|</ci>
    <leq></leq>
    <csymbol cd="unknown">t</csymbol>
    <ci>normal-,</ci>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   |\{j;i\in S_{j}\}|\leq t,
  </annotation>
 </semantics>
</math>

</p>

<p>then one can find an assignment of</p>

<p>

<math display="block" id="Beck–Fiala_theorem:4">
 <semantics>
  <mrow>
   <mi>x</mi>
   <mo>:</mo>
   <mrow>
    <mrow>
     <mo stretchy="false">[</mo>
     <mi>n</mi>
     <mo stretchy="false">]</mo>
    </mrow>
    <mo>→</mo>
    <mrow>
     <mo stretchy="false">{</mo>
     <mrow>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
     <mo>,</mo>
     <mrow>
      <mo>+</mo>
      <mn>1</mn>
     </mrow>
     <mo stretchy="false">}</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-:</ci>
    <ci>x</ci>
    <apply>
     <ci>normal-→</ci>
     <apply>
      <csymbol cd="latexml">delimited-[]</csymbol>
      <ci>n</ci>
     </apply>
     <set>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
      </apply>
      <apply>
       <plus></plus>
       <cn type="integer">1</cn>
      </apply>
     </set>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x:[n]\rightarrow\{-1,+1\}
  </annotation>
 </semantics>
</math>

</p>

<p>such that</p>

<p>

<math display="block" id="Beck–Fiala_theorem:5">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mrow>
      <mi>x</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <msub>
        <mi>S</mi>
        <mi>j</mi>
       </msub>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo>≤</mo>
     <mrow>
      <mrow>
       <mn>2</mn>
       <mi>t</mi>
      </mrow>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </mrow>
    <mo>,</mo>
    <mrow>
     <mrow>
      <mo>∀</mo>
      <mrow>
       <mi>j</mi>
       <mtext>where</mtext>
       <mi>x</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <msub>
         <mi>S</mi>
         <mi>j</mi>
        </msub>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
     </mrow>
     <mo>:=</mo>
     <mrow>
      <munder>
       <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
       <mrow>
        <mi>i</mi>
        <mo>∈</mo>
        <msub>
         <mi>S</mi>
         <mi>j</mi>
        </msub>
       </mrow>
      </munder>
      <msub>
       <mi>x</mi>
       <mi>i</mi>
      </msub>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <leq></leq>
     <apply>
      <times></times>
      <ci>x</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>S</ci>
       <ci>j</ci>
      </apply>
     </apply>
     <apply>
      <minus></minus>
      <apply>
       <times></times>
       <cn type="integer">2</cn>
       <ci>t</ci>
      </apply>
      <cn type="integer">1</cn>
     </apply>
    </apply>
    <apply>
     <csymbol cd="latexml">assign</csymbol>
     <apply>
      <csymbol cd="latexml">for-all</csymbol>
      <apply>
       <times></times>
       <ci>j</ci>
       <mtext>where</mtext>
       <ci>x</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>S</ci>
        <ci>j</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <apply>
        <in></in>
        <ci>i</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>S</ci>
         <ci>j</ci>
        </apply>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <ci>i</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x(S_{j})\leq 2t-1,\forall j\text{ where }x(S_{j}):=\sum_{i\in S_{j}}x_{i}.
  </annotation>
 </semantics>
</math>

</p>
<h2 id="proof-sketch">Proof sketch</h2>

<p>The proof is based on a simple linear-algebraic argument. Start with 

<math display="inline" id="Beck–Fiala_theorem:6">
 <semantics>
  <mrow>
   <msub>
    <mi>x</mi>
    <mi>i</mi>
   </msub>
   <mo>=</mo>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>x</ci>
     <ci>i</ci>
    </apply>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x_{i}=0
  </annotation>
 </semantics>
</math>

 for all elements and call all variables active in the beginning.</p>

<p>Consider only sets with 

<math display="inline" id="Beck–Fiala_theorem:7">
 <semantics>
  <mrow>
   <mrow>
    <mo stretchy="false">|</mo>
    <msub>
     <mi>S</mi>
     <mi>j</mi>
    </msub>
    <mo stretchy="false">|</mo>
   </mrow>
   <mo>></mo>
   <mi>t</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <gt></gt>
    <apply>
     <abs></abs>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>S</ci>
      <ci>j</ci>
     </apply>
    </apply>
    <ci>t</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   |S_{j}|>t
  </annotation>
 </semantics>
</math>

. Since each element appears at most 

<math display="inline" id="Beck–Fiala_theorem:8">
 <semantics>
  <mi>t</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>t</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   t
  </annotation>
 </semantics>
</math>

 times in a set, there are less than 

<math display="inline" id="Beck–Fiala_theorem:9">
 <semantics>
  <mi>n</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>n</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n
  </annotation>
 </semantics>
</math>

 such sets. Now, enforce linear constraints 

<math display="inline" id="Beck–Fiala_theorem:10">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mo largeop="true" symmetric="true">∑</mo>
     <mrow>
      <mi>i</mi>
      <mo>∈</mo>
      <msub>
       <mi>S</mi>
       <mi>j</mi>
      </msub>
     </mrow>
    </msub>
    <msub>
     <mi>x</mi>
     <mi>i</mi>
    </msub>
   </mrow>
   <mo>=</mo>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <sum></sum>
      <apply>
       <in></in>
       <ci>i</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>S</ci>
        <ci>j</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <ci>i</ci>
     </apply>
    </apply>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \sum_{i\in S_{j}}x_{i}=0
  </annotation>
 </semantics>
</math>

 for them and since it is a non-trivial linear subspace of 

<math display="inline" id="Beck–Fiala_theorem:11">
 <semantics>
  <msup>
   <mi>𝐑</mi>
   <mi>n</mi>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>𝐑</ci>
    <ci>n</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{R}^{n}
  </annotation>
 </semantics>
</math>

 since there are less constraints then variables, there is a non-zero solution. Normalize this point and at least one value is either 

<math display="inline" id="Beck–Fiala_theorem:12">
 <semantics>
  <mrow>
   <mrow>
    <mo>+</mo>
    <mn>1</mn>
   </mrow>
   <mo>,</mo>
   <mrow>
    <mo>-</mo>
    <mn>1</mn>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <list>
    <apply>
     <plus></plus>
     <cn type="integer">1</cn>
    </apply>
    <apply>
     <minus></minus>
     <cn type="integer">1</cn>
    </apply>
   </list>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   +1,-1
  </annotation>
 </semantics>
</math>

. Set this value and inactivate this variable. Now, ignore the sets with less than 

<math display="inline" id="Beck–Fiala_theorem:13">
 <semantics>
  <mi>t</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>t</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   t
  </annotation>
 </semantics>
</math>

 active variables. And repeat the same procedure enforcing the linear constraints that the sum of active variables of each remaining set is still the same. By the same counting argument, there is a non-trivial solution, so one can take linear combinations of this with the original one until some element becomes 

<math display="inline" id="Beck–Fiala_theorem:14">
 <semantics>
  <mrow>
   <mrow>
    <mo>+</mo>
    <mn>1</mn>
   </mrow>
   <mo>,</mo>
   <mrow>
    <mo>-</mo>
    <mn>1</mn>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <list>
    <apply>
     <plus></plus>
     <cn type="integer">1</cn>
    </apply>
    <apply>
     <minus></minus>
     <cn type="integer">1</cn>
    </apply>
   </list>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   +1,-1
  </annotation>
 </semantics>
</math>

. Repeat until all variables are set.</p>

<p>Once a set is ignored, the sum of the values of its variables is zero and there are at most 

<math display="inline" id="Beck–Fiala_theorem:15">
 <semantics>
  <mi>t</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>t</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   t
  </annotation>
 </semantics>
</math>

 unset variables. The change in those can increase 

<math display="inline" id="Beck–Fiala_theorem:16">
 <semantics>
  <mrow>
   <mi>x</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>S</mi>
     <mi>j</mi>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>x</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>S</ci>
     <ci>j</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x(S_{j})
  </annotation>
 </semantics>
</math>

 to at most 

<math display="inline" id="Beck–Fiala_theorem:17">
 <semantics>
  <mrow>
   <mrow>
    <mn>2</mn>
    <mi>t</mi>
   </mrow>
   <mo>-</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <minus></minus>
    <apply>
     <times></times>
     <cn type="integer">2</cn>
     <ci>t</ci>
    </apply>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   2t-1
  </annotation>
 </semantics>
</math>

.</p>
<h2 id="references">References</h2>
<ul>
<li></li>
<li></li>
</ul>

<p>"</p>

<p><a href="Category:Mathematical_theorems" title="wikilink">Category:Mathematical theorems</a></p>
</body>
</html>

<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="552">Kubo formula</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Kubo formula</h1>
<hr/>

<p>The <strong>Kubo Formula</strong> is an equation which expresses the <a href="Linear_response_function" title="wikilink">linear response</a> of an observable quantity due to a time-dependent <a href="Perturbation_theory_(quantum_mechanics)" title="wikilink">perturbation</a>. Among the numerous applications of linear response formula, one can mention charge and spin susceptibilities of, for instance, electron systems due to external electric or magnetic fields. Responses to external mechanical forces or vibrations can also be calculated using the very same formula.</p>
<h2 id="the-general-kubo-formula">The general Kubo formula</h2>

<p>Consider a quantum system described by the (time independent) Hamiltonian 

<math display="inline" id="Kubo_formula:0">
 <semantics>
  <msub>
   <mi>H</mi>
   <mn>0</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>H</ci>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   H_{0}
  </annotation>
 </semantics>
</math>

. The expectation value of a physical quantity, described by the operator 

<math display="inline" id="Kubo_formula:1">
 <semantics>
  <mover accent="true">
   <mi>A</mi>
   <mo stretchy="false">^</mo>
  </mover>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-^</ci>
    <ci>A</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \hat{A}
  </annotation>
 </semantics>
</math>

, can be evaluated as:</p>
<dl>
<dd><dl>
<dd>

<math display="inline" id="Kubo_formula:2">
 <semantics>
  <mrow>
   <mrow>
    <mo stretchy="false">⟨</mo>
    <mover accent="true">
     <mi>A</mi>
     <mo stretchy="false">^</mo>
    </mover>
    <mo stretchy="false">⟩</mo>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mfrac>
     <mn>1</mn>
     <msub>
      <mi>Z</mi>
      <mn>0</mn>
     </msub>
    </mfrac>
    <mi>T</mi>
    <mi>r</mi>
    <mrow>
     <mo stretchy="false">[</mo>
     <mrow>
      <mover accent="true">
       <msub>
        <mi>ρ</mi>
        <mn>0</mn>
       </msub>
       <mo stretchy="false">^</mo>
      </mover>
      <mover accent="true">
       <mi>A</mi>
       <mo stretchy="false">^</mo>
      </mover>
     </mrow>
     <mo stretchy="false">]</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mfrac>
     <mn>1</mn>
     <msub>
      <mi>Z</mi>
      <mn>0</mn>
     </msub>
    </mfrac>
    <mrow>
     <msub>
      <mo largeop="true" symmetric="true">∑</mo>
      <mi>n</mi>
     </msub>
     <mrow>
      <mrow>
       <mo stretchy="false">⟨</mo>
       <mi>n</mi>
       <mo fence="true" stretchy="false">|</mo>
       <mover accent="true">
        <mi>A</mi>
        <mo stretchy="false">^</mo>
       </mover>
       <mo fence="true" stretchy="false">|</mo>
       <mi>n</mi>
       <mo stretchy="false">⟩</mo>
      </mrow>
      <msup>
       <mi>e</mi>
       <mrow>
        <mo>-</mo>
        <mrow>
         <mi>β</mi>
         <msub>
          <mi>E</mi>
          <mi>n</mi>
         </msub>
        </mrow>
       </mrow>
      </msup>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="latexml">delimited-⟨⟩</csymbol>
      <apply>
       <ci>normal-^</ci>
       <ci>A</ci>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>Z</ci>
        <cn type="integer">0</cn>
       </apply>
      </apply>
      <ci>T</ci>
      <ci>r</ci>
      <apply>
       <csymbol cd="latexml">delimited-[]</csymbol>
       <apply>
        <times></times>
        <apply>
         <ci>normal-^</ci>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>ρ</ci>
          <cn type="integer">0</cn>
         </apply>
        </apply>
        <apply>
         <ci>normal-^</ci>
         <ci>A</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>Z</ci>
        <cn type="integer">0</cn>
       </apply>
      </apply>
      <apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <ci>n</ci>
       </apply>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="latexml">quantum-operator-product</csymbol>
         <ci>n</ci>
         <apply>
          <ci>normal-^</ci>
          <ci>A</ci>
         </apply>
         <ci>n</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>e</ci>
         <apply>
          <minus></minus>
          <apply>
           <times></times>
           <ci>β</ci>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <ci>E</ci>
            <ci>n</ci>
           </apply>
          </apply>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \langle\hat{A}\rangle={1\over Z_{0}}Tr[\hat{\rho_{0}}\hat{A}]={1\over Z_{0}}%
\sum_{n}\langle n|\hat{A}|n\rangle e^{-\beta E_{n}}
  </annotation>
 </semantics>
</math>


</dd>
<dd>

<math display="inline" id="Kubo_formula:3">
 <semantics>
  <mrow>
   <mover accent="true">
    <msub>
     <mi>ρ</mi>
     <mn>0</mn>
    </msub>
    <mo stretchy="false">^</mo>
   </mover>
   <mo>=</mo>
   <msup>
    <mi>e</mi>
    <mrow>
     <mo>-</mo>
     <mrow>
      <mi>β</mi>
      <msub>
       <mover accent="true">
        <mi>H</mi>
        <mo stretchy="false">^</mo>
       </mover>
       <mn>0</mn>
      </msub>
     </mrow>
    </mrow>
   </msup>
   <mo>=</mo>
   <mrow>
    <msub>
     <mo largeop="true" symmetric="true">∑</mo>
     <mi>n</mi>
    </msub>
    <mrow>
     <mrow>
      <mo fence="true" stretchy="false">|</mo>
      <mi>n</mi>
      <mo stretchy="false">⟩</mo>
     </mrow>
     <mrow>
      <mo stretchy="false">⟨</mo>
      <mi>n</mi>
      <mo fence="true" stretchy="false">|</mo>
     </mrow>
     <msup>
      <mi>e</mi>
      <mrow>
       <mo>-</mo>
       <mrow>
        <mi>β</mi>
        <msub>
         <mi>E</mi>
         <mi>n</mi>
        </msub>
       </mrow>
      </mrow>
     </msup>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <ci>normal-^</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>ρ</ci>
       <cn type="integer">0</cn>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>e</ci>
      <apply>
       <minus></minus>
       <apply>
        <times></times>
        <ci>β</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <apply>
          <ci>normal-^</ci>
          <ci>H</ci>
         </apply>
         <cn type="integer">0</cn>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <ci>n</ci>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="latexml">ket</csymbol>
        <ci>n</ci>
       </apply>
       <apply>
        <csymbol cd="latexml">bra</csymbol>
        <ci>n</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>e</ci>
        <apply>
         <minus></minus>
         <apply>
          <times></times>
          <ci>β</ci>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>E</ci>
           <ci>n</ci>
          </apply>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \hat{\rho_{0}}=e^{-\beta\hat{H}_{0}}=\sum_{n}|n\rangle\langle n|e^{-\beta E_{n}}
  </annotation>
 </semantics>
</math>


</dd>
</dl>
</dd>
</dl>

<p>where 

<math display="inline" id="Kubo_formula:4">
 <semantics>
  <mrow>
   <msub>
    <mi>Z</mi>
    <mn>0</mn>
   </msub>
   <mo>=</mo>
   <mrow>
    <mi>T</mi>
    <mi>r</mi>
    <mrow>
     <mo stretchy="false">[</mo>
     <msub>
      <mover accent="true">
       <mi>ρ</mi>
       <mo stretchy="false">^</mo>
      </mover>
      <mn>0</mn>
     </msub>
     <mo stretchy="false">]</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>Z</ci>
     <cn type="integer">0</cn>
    </apply>
    <apply>
     <times></times>
     <ci>T</ci>
     <ci>r</ci>
     <apply>
      <csymbol cd="latexml">delimited-[]</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <apply>
        <ci>normal-^</ci>
        <ci>ρ</ci>
       </apply>
       <cn type="integer">0</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Z_{0}=Tr[\hat{\rho}_{0}]
  </annotation>
 </semantics>
</math>

 is the <a href="Partition_function_(statistical_mechanics)" title="wikilink">partition function</a>. Suppose now that just above some time 

<math display="inline" id="Kubo_formula:5">
 <semantics>
  <mrow>
   <mi>t</mi>
   <mo>=</mo>
   <msub>
    <mi>t</mi>
    <mn>0</mn>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>t</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>t</ci>
     <cn type="integer">0</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   t=t_{0}
  </annotation>
 </semantics>
</math>

 an external perturbation is applied to the system. The perturbation is described by an additional time dependence in the Hamiltonian

<math display="block" id="Kubo_formula:6">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mover accent="true">
      <mi>H</mi>
      <mo stretchy="false">^</mo>
     </mover>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>t</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <msub>
      <mover accent="true">
       <mi>H</mi>
       <mo stretchy="false">^</mo>
      </mover>
      <mn>0</mn>
     </msub>
     <mo>+</mo>
     <mrow>
      <mover accent="true">
       <mi>V</mi>
       <mo stretchy="false">^</mo>
      </mover>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>t</mi>
       <mo stretchy="false">)</mo>
      </mrow>
      <mi>θ</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mi>t</mi>
        <mo>-</mo>
        <msub>
         <mi>t</mi>
         <mn>0</mn>
        </msub>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <ci>normal-^</ci>
      <ci>H</ci>
     </apply>
     <ci>t</ci>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <ci>normal-^</ci>
       <ci>H</ci>
      </apply>
      <cn type="integer">0</cn>
     </apply>
     <apply>
      <times></times>
      <apply>
       <ci>normal-^</ci>
       <ci>V</ci>
      </apply>
      <ci>t</ci>
      <ci>θ</ci>
      <apply>
       <minus></minus>
       <ci>t</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>t</ci>
        <cn type="integer">0</cn>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \hat{H}(t)=\hat{H}_{0}+\hat{V}(t)\theta(t-t_{0}),
  </annotation>
 </semantics>
</math>

 where 

<math display="inline" id="Kubo_formula:7">
 <semantics>
  <mrow>
   <mi>θ</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>t</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>θ</ci>
    <ci>t</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \theta(t)
  </annotation>
 </semantics>
</math>

 is the <a href="Heaviside_function" title="wikilink">Heaviside function</a> ( = 1 for positive times, =0 otherwise) and 

<math display="inline" id="Kubo_formula:8">
 <semantics>
  <mrow>
   <mover accent="true">
    <mi>V</mi>
    <mo stretchy="false">^</mo>
   </mover>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>t</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <ci>normal-^</ci>
     <ci>V</ci>
    </apply>
    <ci>t</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \hat{V}(t)
  </annotation>
 </semantics>
</math>

 is hermitian and defined for all <em>t</em>, so that 

<math display="inline" id="Kubo_formula:9">
 <semantics>
  <mrow>
   <mover accent="true">
    <mi>H</mi>
    <mo stretchy="false">^</mo>
   </mover>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>t</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <ci>normal-^</ci>
     <ci>H</ci>
    </apply>
    <ci>t</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \hat{H}(t)
  </annotation>
 </semantics>
</math>

 has for positive 

<math display="inline" id="Kubo_formula:10">
 <semantics>
  <mrow>
   <mi>t</mi>
   <mo>-</mo>
   <msub>
    <mi>t</mi>
    <mn>0</mn>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <minus></minus>
    <ci>t</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>t</ci>
     <cn type="integer">0</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   t-t_{0}
  </annotation>
 </semantics>
</math>

 again a complete set of real eigenvalues 

<math display="inline" id="Kubo_formula:11">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>E</mi>
     <mi>n</mi>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>t</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>E</ci>
     <ci>n</ci>
    </apply>
    <ci>t</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   E_{n}(t).
  </annotation>
 </semantics>
</math>

 But these eigenvalues may change with time.</p>

<p>However, we can again find the time evolution of the <a href="density_matrix" title="wikilink">density matrix</a> 

<math display="inline" id="Kubo_formula:12">
 <semantics>
  <mrow>
   <mover accent="true">
    <mi>ρ</mi>
    <mo stretchy="false">^</mo>
   </mover>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>t</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <ci>normal-^</ci>
     <ci>ρ</ci>
    </apply>
    <ci>t</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \hat{\rho}(t)
  </annotation>
 </semantics>
</math>

 rsp. of the partition function 

<math display="inline" id="Kubo_formula:13">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>Z</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>t</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mi>T</mi>
     <mi>r</mi>
     <mrow>
      <mo stretchy="false">[</mo>
      <mrow>
       <mover accent="true">
        <mi>ρ</mi>
        <mo stretchy="false">^</mo>
       </mover>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>t</mi>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
      <mo stretchy="false">]</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>Z</ci>
     <ci>t</ci>
    </apply>
    <apply>
     <times></times>
     <ci>T</ci>
     <ci>r</ci>
     <apply>
      <csymbol cd="latexml">delimited-[]</csymbol>
      <apply>
       <times></times>
       <apply>
        <ci>normal-^</ci>
        <ci>ρ</ci>
       </apply>
       <ci>t</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Z(t)=Tr[\hat{\rho}(t)],
  </annotation>
 </semantics>
</math>

 to evaluate the expectation value of 

<math display="inline" id="Kubo_formula:14">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mo stretchy="false">⟨</mo>
     <mover accent="true">
      <mi>A</mi>
      <mo stretchy="false">^</mo>
     </mover>
     <mo stretchy="false">⟩</mo>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mrow>
       <mi>T</mi>
       <mi>r</mi>
       <mrow>
        <mo stretchy="false">[</mo>
        <mrow>
         <mover accent="true">
          <mi>ρ</mi>
          <mo stretchy="false">^</mo>
         </mover>
         <mrow>
          <mo stretchy="false">(</mo>
          <mi>t</mi>
          <mo rspace="4.2pt" stretchy="false">)</mo>
         </mrow>
         <mover accent="true">
          <mi>A</mi>
          <mo stretchy="false">^</mo>
         </mover>
        </mrow>
        <mo stretchy="false">]</mo>
       </mrow>
      </mrow>
      <mo>/</mo>
      <mi>T</mi>
     </mrow>
     <mi>r</mi>
     <mrow>
      <mo stretchy="false">[</mo>
      <mrow>
       <mover accent="true">
        <mi>ρ</mi>
        <mo stretchy="false">^</mo>
       </mover>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>t</mi>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
      <mo stretchy="false">]</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="latexml">delimited-⟨⟩</csymbol>
     <apply>
      <ci>normal-^</ci>
      <ci>A</ci>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <divide></divide>
      <apply>
       <times></times>
       <ci>T</ci>
       <ci>r</ci>
       <apply>
        <csymbol cd="latexml">delimited-[]</csymbol>
        <apply>
         <times></times>
         <apply>
          <ci>normal-^</ci>
          <ci>ρ</ci>
         </apply>
         <ci>t</ci>
         <apply>
          <ci>normal-^</ci>
          <ci>A</ci>
         </apply>
        </apply>
       </apply>
      </apply>
      <ci>T</ci>
     </apply>
     <ci>r</ci>
     <apply>
      <csymbol cd="latexml">delimited-[]</csymbol>
      <apply>
       <times></times>
       <apply>
        <ci>normal-^</ci>
        <ci>ρ</ci>
       </apply>
       <ci>t</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \langle\hat{A}\rangle=Tr[\hat{\rho}(t)\,\hat{A}]/Tr[\hat{\rho}(t)].
  </annotation>
 </semantics>
</math>

</p>

<p> The time dependence of the states 

<math display="inline" id="Kubo_formula:15">
 <semantics>
  <mrow>
   <mo fence="true" stretchy="false">|</mo>
   <mrow>
    <mi>n</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>t</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo stretchy="false">⟩</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">ket</csymbol>
    <apply>
     <times></times>
     <ci>n</ci>
     <ci>t</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   |n(t)\rangle
  </annotation>
 </semantics>
</math>

 is governed by the <a href="Schrödinger_equation" title="wikilink">Schrödinger equation</a> 

<math display="inline" id="Kubo_formula:16">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>i</mi>
     <msub>
      <mo>∂</mo>
      <mi>t</mi>
     </msub>
     <mrow>
      <mo fence="true" stretchy="false">|</mo>
      <mrow>
       <mi>n</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>t</mi>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
      <mo stretchy="false">⟩</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mover accent="true">
      <mi>H</mi>
      <mo stretchy="false">^</mo>
     </mover>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>t</mi>
      <mo stretchy="false">)</mo>
     </mrow>
     <mrow>
      <mo fence="true" stretchy="false">|</mo>
      <mrow>
       <mi>n</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>t</mi>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
      <mo stretchy="false">⟩</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>i</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <partialdiff></partialdiff>
      <ci>t</ci>
     </apply>
     <apply>
      <csymbol cd="latexml">ket</csymbol>
      <apply>
       <times></times>
       <ci>n</ci>
       <ci>t</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <ci>normal-^</ci>
      <ci>H</ci>
     </apply>
     <ci>t</ci>
     <apply>
      <csymbol cd="latexml">ket</csymbol>
      <apply>
       <times></times>
       <ci>n</ci>
       <ci>t</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   i\partial_{t}|n(t)\rangle=\hat{H}(t)|n(t)\rangle,
  </annotation>
 </semantics>
</math>

 which thus determines everything, corresponding of course to the <a href="Schrödinger_picture" title="wikilink">Schrödinger picture</a>. But since 

<math display="inline" id="Kubo_formula:17">
 <semantics>
  <mrow>
   <mover accent="true">
    <mi>V</mi>
    <mo stretchy="false">^</mo>
   </mover>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>t</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <ci>normal-^</ci>
     <ci>V</ci>
    </apply>
    <ci>t</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \hat{V}(t)
  </annotation>
 </semantics>
</math>

 is to be regarded as a small perturbation, it is convenient to now use instead the <a href="interaction_picture" title="wikilink">interaction picture</a> representation, 

<math display="inline" id="Kubo_formula:18">
 <semantics>
  <mrow>
   <mrow>
    <mo fence="true" stretchy="false">|</mo>
    <mrow>
     <mover accent="true">
      <mi>n</mi>
      <mo stretchy="false">^</mo>
     </mover>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>t</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo stretchy="false">⟩</mo>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">ket</csymbol>
    <apply>
     <times></times>
     <apply>
      <ci>normal-^</ci>
      <ci>n</ci>
     </apply>
     <ci>t</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   |\hat{n}(t)\rangle,
  </annotation>
 </semantics>
</math>

 in lowest nontrivial order. The time dependence in this representation is given by 

<math display="inline" id="Kubo_formula:19">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mo fence="true" stretchy="false">|</mo>
     <mrow>
      <mi>n</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>t</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo stretchy="false">⟩</mo>
    </mrow>
    <mo>=</mo>
    <mrow>
     <msup>
      <mi>e</mi>
      <mrow>
       <mo>-</mo>
       <mrow>
        <mi>i</mi>
        <msub>
         <mover accent="true">
          <mi>H</mi>
          <mo stretchy="false">^</mo>
         </mover>
         <mn>0</mn>
        </msub>
        <mi>t</mi>
       </mrow>
      </mrow>
     </msup>
     <mrow>
      <mo fence="true" stretchy="false">|</mo>
      <mrow>
       <mover accent="true">
        <mi>n</mi>
        <mo stretchy="false">^</mo>
       </mover>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>t</mi>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
      <mo stretchy="false">⟩</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <msup>
      <mi>e</mi>
      <mrow>
       <mo>-</mo>
       <mrow>
        <mi>i</mi>
        <msub>
         <mover accent="true">
          <mi>H</mi>
          <mo stretchy="false">^</mo>
         </mover>
         <mn>0</mn>
        </msub>
        <mi>t</mi>
       </mrow>
      </mrow>
     </msup>
     <mover accent="true">
      <mi>U</mi>
      <mo stretchy="false">^</mo>
     </mover>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>t</mi>
      <mo>,</mo>
      <msub>
       <mi>t</mi>
       <mn>0</mn>
      </msub>
      <mo stretchy="false">)</mo>
     </mrow>
     <mrow>
      <mo fence="true" stretchy="false">|</mo>
      <mrow>
       <mover accent="true">
        <mi>n</mi>
        <mo stretchy="false">^</mo>
       </mover>
       <mrow>
        <mo stretchy="false">(</mo>
        <msub>
         <mi>t</mi>
         <mn>0</mn>
        </msub>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
      <mo stretchy="false">⟩</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="latexml">ket</csymbol>
      <apply>
       <times></times>
       <ci>n</ci>
       <ci>t</ci>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>e</ci>
       <apply>
        <minus></minus>
        <apply>
         <times></times>
         <ci>i</ci>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <apply>
           <ci>normal-^</ci>
           <ci>H</ci>
          </apply>
          <cn type="integer">0</cn>
         </apply>
         <ci>t</ci>
        </apply>
       </apply>
      </apply>
      <apply>
       <csymbol cd="latexml">ket</csymbol>
       <apply>
        <times></times>
        <apply>
         <ci>normal-^</ci>
         <ci>n</ci>
        </apply>
        <ci>t</ci>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>e</ci>
       <apply>
        <minus></minus>
        <apply>
         <times></times>
         <ci>i</ci>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <apply>
           <ci>normal-^</ci>
           <ci>H</ci>
          </apply>
          <cn type="integer">0</cn>
         </apply>
         <ci>t</ci>
        </apply>
       </apply>
      </apply>
      <apply>
       <ci>normal-^</ci>
       <ci>U</ci>
      </apply>
      <interval closure="open">
       <ci>t</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>t</ci>
        <cn type="integer">0</cn>
       </apply>
      </interval>
      <apply>
       <csymbol cd="latexml">ket</csymbol>
       <apply>
        <times></times>
        <apply>
         <ci>normal-^</ci>
         <ci>n</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>t</ci>
         <cn type="integer">0</cn>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   |n(t)\rangle=e^{-i\hat{H}_{0}t}|\hat{n}(t)\rangle=e^{-i\hat{H}_{0}t}\hat{U}(t,%
t_{0})|\hat{n}(t_{0})\rangle,
  </annotation>
 </semantics>
</math>

 where by definition for all t and 

<math display="inline" id="Kubo_formula:20">
 <semantics>
  <msub>
   <mi>t</mi>
   <mn>0</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>t</ci>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   t_{0}
  </annotation>
 </semantics>
</math>

 it is

<math display="block" id="Kubo_formula:21">
 <semantics>
  <mrow>
   <mrow>
    <mo fence="true" stretchy="false">|</mo>
    <mrow>
     <mover accent="true">
      <mi>n</mi>
      <mo stretchy="false">^</mo>
     </mover>
     <mrow>
      <mo stretchy="false">(</mo>
      <msub>
       <mi>t</mi>
       <mn>0</mn>
      </msub>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo stretchy="false">⟩</mo>
   </mrow>
   <mo>=</mo>
   <mrow>
    <msup>
     <mi>e</mi>
     <mrow>
      <mi>i</mi>
      <msub>
       <mover accent="true">
        <mi>H</mi>
        <mo stretchy="false">^</mo>
       </mover>
       <mn>0</mn>
      </msub>
      <msub>
       <mi>t</mi>
       <mn>0</mn>
      </msub>
     </mrow>
    </msup>
    <mrow>
     <mo fence="true" stretchy="false">|</mo>
     <mrow>
      <mi>n</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <msub>
        <mi>t</mi>
        <mn>0</mn>
       </msub>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo stretchy="false">⟩</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="latexml">ket</csymbol>
     <apply>
      <times></times>
      <apply>
       <ci>normal-^</ci>
       <ci>n</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>t</ci>
       <cn type="integer">0</cn>
      </apply>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>e</ci>
      <apply>
       <times></times>
       <ci>i</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <apply>
         <ci>normal-^</ci>
         <ci>H</ci>
        </apply>
        <cn type="integer">0</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>t</ci>
        <cn type="integer">0</cn>
       </apply>
      </apply>
     </apply>
     <apply>
      <csymbol cd="latexml">ket</csymbol>
      <apply>
       <times></times>
       <ci>n</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>t</ci>
        <cn type="integer">0</cn>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   |\hat{n}(t_{0})\rangle=e^{i\hat{H}_{0}t_{0}}|n(t_{0})\rangle
  </annotation>
 </semantics>
</math>

</p>

<p>To linear order in 

<math display="inline" id="Kubo_formula:22">
 <semantics>
  <mrow>
   <mover accent="true">
    <mi>V</mi>
    <mo stretchy="false">^</mo>
   </mover>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>t</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <ci>normal-^</ci>
     <ci>V</ci>
    </apply>
    <ci>t</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \hat{V}(t)
  </annotation>
 </semantics>
</math>

, we have 

<math display="inline" id="Kubo_formula:23">
 <semantics>
  <mrow>
   <mrow>
    <mover accent="true">
     <mi>U</mi>
     <mo stretchy="false">^</mo>
    </mover>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>t</mi>
     <mo>,</mo>
     <msub>
      <mi>t</mi>
      <mn>0</mn>
     </msub>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mn>1</mn>
    <mo>-</mo>
    <mrow>
     <mi>i</mi>
     <mrow>
      <msubsup>
       <mo largeop="true" symmetric="true">∫</mo>
       <msub>
        <mi>t</mi>
        <mn>0</mn>
       </msub>
       <mi>t</mi>
      </msubsup>
      <mrow>
       <mi>d</mi>
       <msup>
        <mi>t</mi>
        <mo>′</mo>
       </msup>
       <mover accent="true">
        <mi>V</mi>
        <mo stretchy="false">^</mo>
       </mover>
       <mrow>
        <mo stretchy="false">(</mo>
        <msup>
         <mi>t</mi>
         <mo>′</mo>
        </msup>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <ci>normal-^</ci>
      <ci>U</ci>
     </apply>
     <interval closure="open">
      <ci>t</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>t</ci>
       <cn type="integer">0</cn>
      </apply>
     </interval>
    </apply>
    <apply>
     <minus></minus>
     <cn type="integer">1</cn>
     <apply>
      <times></times>
      <ci>i</ci>
      <apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <int></int>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>t</ci>
          <cn type="integer">0</cn>
         </apply>
        </apply>
        <ci>t</ci>
       </apply>
       <apply>
        <times></times>
        <ci>d</ci>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>t</ci>
         <ci>normal-′</ci>
        </apply>
        <apply>
         <ci>normal-^</ci>
         <ci>V</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>t</ci>
         <ci>normal-′</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \hat{U}(t,t_{0})=1-i\int_{t_{0}}^{t}dt^{\prime}\hat{V}(t^{\prime})
  </annotation>
 </semantics>
</math>

. Thus one obtains the expectation value of 

<math display="inline" id="Kubo_formula:24">
 <semantics>
  <mrow>
   <mover accent="true">
    <mi>A</mi>
    <mo stretchy="false">^</mo>
   </mover>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>t</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <ci>normal-^</ci>
     <ci>A</ci>
    </apply>
    <ci>t</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \hat{A}(t)
  </annotation>
 </semantics>
</math>

 up to linear order in the perturbation.</p>
<dl>
<dd><dl>
<dd><math>\begin{array}{rcl}
</math></dd>
</dl>
</dd>
</dl>

<p>\langle \hat{A}(t)\rangle &amp;=&amp; \langle \hat{A}\rangle_0-i\int_{t_0}^t dt'{1\over Z_0}\sum_n e^{-\beta E_n} \langle n (t_0)| \hat{A}(t)\hat{V}(t')- \hat{V}(t')\hat{A}(t) |n(t_0) \rangle\\ &amp;=&amp; \langle \hat{A}\rangle_0-i\int_{t_0}^t dt'\langle [\hat{A}(t),\hat{V}(t')]\rangle_0 \end{array}  The brackets 

<math display="inline" id="Kubo_formula:25">
 <semantics>
  <msub>
   <mrow>
    <mo stretchy="false">⟨</mo>
    <mo stretchy="false">⟩</mo>
   </mrow>
   <mn>0</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <list></list>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \langle\rangle_{0}
  </annotation>
 </semantics>
</math>

 mean an equilibrium average with respect to the Hamiltonian 

<math display="inline" id="Kubo_formula:26">
 <semantics>
  <mrow>
   <msub>
    <mi>H</mi>
    <mn>0</mn>
   </msub>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>H</ci>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   H_{0}.
  </annotation>
 </semantics>
</math>

 Therefore, although the result is of first order in the perturbation, it involves only the zeroth-order eigenfunctions, which is usually the case in perturbation theory and moves away all complications which otherwise might arise for 

<math display="inline" id="Kubo_formula:27">
 <semantics>
  <mrow>
   <mi>t</mi>
   <mo>></mo>
   <msub>
    <mi>t</mi>
    <mn>0</mn>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <gt></gt>
    <ci>t</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>t</ci>
     <cn type="integer">0</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   t>t_{0}
  </annotation>
 </semantics>
</math>

.</p>

<p>Here we have used an example, where the operators are bosonic operators, while for fermionic operators, the retarded functions are defined with anti-communtators instead of the usual (see <a href="Second_quantization" title="wikilink">Second quantization</a>)<a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a></p>
<h2 id="references">References</h2>

<p>"</p>

<p><a href="Category:Quantum_mechanics" title="wikilink">Category:Quantum mechanics</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1"><a href="#fnref1">↩</a></li>
</ol>
</section>
</body>
</html>

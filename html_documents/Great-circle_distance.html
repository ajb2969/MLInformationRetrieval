<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="493">Great-circle distance</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Great-circle distance</h1>
<hr/>

<p>The <strong>great-circle</strong> or <strong><a href="Great_Circle" title="wikilink">orthodromic</a> distance</strong> is the shortest <a class="uri" href="distance" title="wikilink">distance</a> between two <a href="Point_(geometry)" title="wikilink">points</a> on the surface of a <a class="uri" href="sphere" title="wikilink">sphere</a>, measured along the surface of the sphere (as opposed to a straight line through the sphere's interior). The distance between two points in <a href="Euclidean_space" title="wikilink">Euclidean space</a> is the length of a straight line between them, but on the sphere there are no straight lines. In <a href="non-Euclidean_geometry" title="wikilink">non-Euclidean geometry</a>, straight lines are replaced with <a href="geodesic" title="wikilink">geodesics</a>. Geodesics on the sphere are the <em><a href="great_circle" title="wikilink">great circles</a></em> (circles on the sphere whose centers coincide with the center of the sphere).</p>

<p>Through any two points on a sphere which are not <a href="antipodal_point" title="wikilink">directly opposite each other</a>, there is a unique great circle. The two points separate the great circle into two arcs. The length of the shorter arc is the great-circle distance between the points. A great circle endowed with such a distance is the <a href="Riemannian_circle" title="wikilink">Riemannian circle</a>.</p>

<p>Between two points which are directly opposite each other, called <em><a href="antipodal_point" title="wikilink">antipodal points</a></em>, there are infinitely many great circles, but all great circle arcs between antipodal points have the same length, i.e. half the <a class="uri" href="circumference" title="wikilink">circumference</a> of the circle, or 

<math display="inline" id="Great-circle_distance:0">
 <semantics>
  <mrow>
   <mi>π</mi>
   <mi>r</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>π</ci>
    <ci>r</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \pi r
  </annotation>
 </semantics>
</math>

, where <em>r</em> is the <a class="uri" href="radius" title="wikilink">radius</a> of the <a class="uri" href="sphere" title="wikilink">sphere</a>.</p>

<p>The Earth is nearly spherical (see <a href="Earth_radius" title="wikilink">Earth radius</a>) so great-circle distance formulas give the distance between points on the surface of the Earth (<em><a href="as_the_crow_flies" title="wikilink">as the crow flies</a></em>) correct to within 0.5% or so.<a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a></p>
<h2 id="formulas">Formulas</h2>

<p>Let 

<math display="inline" id="Great-circle_distance:1">
 <semantics>
  <mrow>
   <msub>
    <mi>ϕ</mi>
    <mn>1</mn>
   </msub>
   <mo>,</mo>
   <msub>
    <mi>λ</mi>
    <mn>1</mn>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <list>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>ϕ</ci>
     <cn type="integer">1</cn>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>λ</ci>
     <cn type="integer">1</cn>
    </apply>
   </list>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \phi_{1},\lambda_{1}
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Great-circle_distance:2">
 <semantics>
  <mrow>
   <msub>
    <mi>ϕ</mi>
    <mn>2</mn>
   </msub>
   <mo>,</mo>
   <msub>
    <mi>λ</mi>
    <mn>2</mn>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <list>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>ϕ</ci>
     <cn type="integer">2</cn>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>λ</ci>
     <cn type="integer">2</cn>
    </apply>
   </list>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \phi_{2},\lambda_{2}
  </annotation>
 </semantics>
</math>

 be the geographical <a class="uri" href="latitude" title="wikilink">latitude</a> and <a class="uri" href="longitude" title="wikilink">longitude</a> of two points 1 and 2, and 

<math display="inline" id="Great-circle_distance:3">
 <semantics>
  <mrow>
   <mrow>
    <mi mathvariant="normal">Δ</mi>
    <mi>ϕ</mi>
   </mrow>
   <mo>,</mo>
   <mrow>
    <mi mathvariant="normal">Δ</mi>
    <mi>λ</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <list>
    <apply>
     <times></times>
     <ci>normal-Δ</ci>
     <ci>ϕ</ci>
    </apply>
    <apply>
     <times></times>
     <ci>normal-Δ</ci>
     <ci>λ</ci>
    </apply>
   </list>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Delta\phi,\Delta\lambda
  </annotation>
 </semantics>
</math>


 their absolute differences; then 

<math display="inline" id="Great-circle_distance:4">
 <semantics>
  <mrow>
   <mi mathvariant="normal">Δ</mi>
   <mi>σ</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>normal-Δ</ci>
    <ci>σ</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Delta\sigma
  </annotation>
 </semantics>
</math>

, the <a href="central_angle" title="wikilink">central angle</a> between them, is given by the <a href="spherical_law_of_cosines" title="wikilink">spherical law of cosines</a>:</p>

<p>

<math display="block" id="Great-circle_distance:5">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi mathvariant="normal">Δ</mi>
     <mi>σ</mi>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mi>arccos</mi>
     <mrow>
      <mo maxsize="120%" minsize="120%">(</mo>
      <mrow>
       <mrow>
        <mrow>
         <mi>sin</mi>
         <msub>
          <mi>ϕ</mi>
          <mn>1</mn>
         </msub>
        </mrow>
        <mrow>
         <mi>sin</mi>
         <msub>
          <mi>ϕ</mi>
          <mn>2</mn>
         </msub>
        </mrow>
       </mrow>
       <mo>+</mo>
       <mrow>
        <mrow>
         <mi>cos</mi>
         <msub>
          <mi>ϕ</mi>
          <mn>1</mn>
         </msub>
        </mrow>
        <mrow>
         <mi>cos</mi>
         <msub>
          <mi>ϕ</mi>
          <mn>2</mn>
         </msub>
        </mrow>
        <mrow>
         <mi>cos</mi>
         <mrow>
          <mi mathvariant="normal">Δ</mi>
          <mi>λ</mi>
         </mrow>
        </mrow>
       </mrow>
      </mrow>
      <mo maxsize="120%" minsize="120%">)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>normal-Δ</ci>
     <ci>σ</ci>
    </apply>
    <apply>
     <arccos></arccos>
     <apply>
      <plus></plus>
      <apply>
       <times></times>
       <apply>
        <sin></sin>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>ϕ</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <apply>
        <sin></sin>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>ϕ</ci>
         <cn type="integer">2</cn>
        </apply>
       </apply>
      </apply>
      <apply>
       <times></times>
       <apply>
        <cos></cos>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>ϕ</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <apply>
        <cos></cos>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>ϕ</ci>
         <cn type="integer">2</cn>
        </apply>
       </apply>
       <apply>
        <cos></cos>
        <apply>
         <times></times>
         <ci>normal-Δ</ci>
         <ci>λ</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Delta\sigma=\arccos\bigl(\sin\phi_{1}\sin\phi_{2}+\cos\phi_{1}\cos\phi_{2}%
\cos\Delta\lambda\bigr).
  </annotation>
 </semantics>
</math>

</p>

<p>The distance <em>d</em>, i.e. the <a href="arc_length" title="wikilink">arc length</a>, for a sphere of radius <em>r</em> and 

<math display="inline" id="Great-circle_distance:6">
 <semantics>
  <mrow>
   <mi mathvariant="normal">Δ</mi>
   <mi>σ</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>normal-Δ</ci>
    <ci>σ</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Delta\sigma
  </annotation>
 </semantics>
</math>

 given in radians</p>

<p>

<math display="block" id="Great-circle_distance:7">
 <semantics>
  <mrow>
   <mrow>
    <mi>d</mi>
    <mo>=</mo>
    <mrow>
     <mpadded width="+1.7pt">
      <mi>r</mi>
     </mpadded>
     <mi mathvariant="normal">Δ</mi>
     <mi>σ</mi>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>d</ci>
    <apply>
     <times></times>
     <ci>r</ci>
     <ci>normal-Δ</ci>
     <ci>σ</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   d=r\,\Delta\sigma.
  </annotation>
 </semantics>
</math>

</p>
<h3 id="computational-formulas">Computational formulas</h3>

<p>On computer systems with low <a href="floating_point" title="wikilink">floating-point precision</a>, this formula can have large <a href="rounding_error" title="wikilink">rounding errors</a> if the distance is small (if the two points are a kilometer apart on the surface of the Earth, the cosine of the central angle comes out 0.99999999). For modern <a href="IEEE_754" title="wikilink">64-bit floating-point numbers</a>, the spherical law of cosines formula, given above, does not have serious rounding errors for distances larger than a few meters on the surface of the Earth.<a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a> The <a href="haversine_formula" title="wikilink">haversine formula</a> is <a href="Condition_number" title="wikilink">numerically better-conditioned</a> for small distances:<a class="footnoteRef" href="#fn3" id="fnref3"><sup>3</sup></a></p>

<p>

<math display="block" id="Great-circle_distance:8">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi mathvariant="normal">Δ</mi>
     <mi>σ</mi>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mn>2</mn>
     <mrow>
      <mi>arcsin</mi>
      <mrow>
       <mo>(</mo>
       <msqrt>
        <mrow>
         <mrow>
          <msup>
           <mi>sin</mi>
           <mn>2</mn>
          </msup>
          <mrow>
           <mo>(</mo>
           <mfrac>
            <mrow>
             <mi mathvariant="normal">Δ</mi>
             <mi>ϕ</mi>
            </mrow>
            <mn>2</mn>
           </mfrac>
           <mo>)</mo>
          </mrow>
         </mrow>
         <mo>+</mo>
         <mrow>
          <mrow>
           <mi>cos</mi>
           <msub>
            <mi>ϕ</mi>
            <mn>1</mn>
           </msub>
          </mrow>
          <mrow>
           <mi>cos</mi>
           <msub>
            <mi>ϕ</mi>
            <mn>2</mn>
           </msub>
          </mrow>
          <mrow>
           <msup>
            <mi>sin</mi>
            <mn>2</mn>
           </msup>
           <mrow>
            <mo>(</mo>
            <mfrac>
             <mrow>
              <mi mathvariant="normal">Δ</mi>
              <mi>λ</mi>
             </mrow>
             <mn>2</mn>
            </mfrac>
            <mo>)</mo>
           </mrow>
          </mrow>
         </mrow>
        </mrow>
       </msqrt>
       <mo>)</mo>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>normal-Δ</ci>
     <ci>σ</ci>
    </apply>
    <apply>
     <times></times>
     <cn type="integer">2</cn>
     <apply>
      <arcsin></arcsin>
      <apply>
       <root></root>
       <apply>
        <plus></plus>
        <apply>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <sin></sin>
          <cn type="integer">2</cn>
         </apply>
         <apply>
          <divide></divide>
          <apply>
           <times></times>
           <ci>normal-Δ</ci>
           <ci>ϕ</ci>
          </apply>
          <cn type="integer">2</cn>
         </apply>
        </apply>
        <apply>
         <times></times>
         <apply>
          <cos></cos>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>ϕ</ci>
           <cn type="integer">1</cn>
          </apply>
         </apply>
         <apply>
          <cos></cos>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>ϕ</ci>
           <cn type="integer">2</cn>
          </apply>
         </apply>
         <apply>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <sin></sin>
           <cn type="integer">2</cn>
          </apply>
          <apply>
           <divide></divide>
           <apply>
            <times></times>
            <ci>normal-Δ</ci>
            <ci>λ</ci>
           </apply>
           <cn type="integer">2</cn>
          </apply>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Delta\sigma=2\arcsin\left(\sqrt{\sin^{2}\left(\frac{\Delta\phi}{2}\right)+%
\cos{\phi_{1}}\cos{\phi_{2}}\sin^{2}\left(\frac{\Delta\lambda}{2}\right)}%
\right).\;\!
  </annotation>
 </semantics>
</math>

</p>

<p>Historically, the use of this formula was simplified by the availability of tables for the <a class="uri" href="haversine" title="wikilink">haversine</a> function: hav(<em>θ</em>) = sin<sup>2</sup>(<em>θ</em>/2).</p>

<p>Although this formula is accurate for most distances on a sphere, it too suffers from rounding errors for the special (and somewhat unusual) case of <a href="antipodal_point" title="wikilink">antipodal points</a> (on opposite ends of the sphere). A more complicated formula that is accurate for all distances is the following special case (a sphere, which is an ellipsoid with equal major and minor axes) of the <a href="Vincenty's_formulae" title="wikilink">Vincenty formula</a> (which more generally is a method to compute distances on ellipsoids):<a class="footnoteRef" href="#fn4" id="fnref4"><sup>4</sup></a></p>

<p>

<math display="block" id="Great-circle_distance:9">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi mathvariant="normal">Δ</mi>
     <mi>σ</mi>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mi>arctan</mi>
     <mrow>
      <mo>(</mo>
      <mfrac>
       <msqrt>
        <mrow>
         <msup>
          <mrow>
           <mo>(</mo>
           <mrow>
            <mrow>
             <mi>cos</mi>
             <msub>
              <mi>ϕ</mi>
              <mn>2</mn>
             </msub>
            </mrow>
            <mrow>
             <mi>sin</mi>
             <mrow>
              <mi mathvariant="normal">Δ</mi>
              <mi>λ</mi>
             </mrow>
            </mrow>
           </mrow>
           <mo>)</mo>
          </mrow>
          <mn>2</mn>
         </msup>
         <mo>+</mo>
         <msup>
          <mrow>
           <mo>(</mo>
           <mrow>
            <mrow>
             <mrow>
              <mi>cos</mi>
              <msub>
               <mi>ϕ</mi>
               <mn>1</mn>
              </msub>
             </mrow>
             <mrow>
              <mi>sin</mi>
              <msub>
               <mi>ϕ</mi>
               <mn>2</mn>
              </msub>
             </mrow>
            </mrow>
            <mo>-</mo>
            <mrow>
             <mrow>
              <mi>sin</mi>
              <msub>
               <mi>ϕ</mi>
               <mn>1</mn>
              </msub>
             </mrow>
             <mrow>
              <mi>cos</mi>
              <msub>
               <mi>ϕ</mi>
               <mn>2</mn>
              </msub>
             </mrow>
             <mrow>
              <mi>cos</mi>
              <mrow>
               <mi mathvariant="normal">Δ</mi>
               <mi>λ</mi>
              </mrow>
             </mrow>
            </mrow>
           </mrow>
           <mo>)</mo>
          </mrow>
          <mn>2</mn>
         </msup>
        </mrow>
       </msqrt>
       <mrow>
        <mrow>
         <mrow>
          <mi>sin</mi>
          <msub>
           <mi>ϕ</mi>
           <mn>1</mn>
          </msub>
         </mrow>
         <mrow>
          <mi>sin</mi>
          <msub>
           <mi>ϕ</mi>
           <mn>2</mn>
          </msub>
         </mrow>
        </mrow>
        <mo>+</mo>
        <mrow>
         <mrow>
          <mi>cos</mi>
          <msub>
           <mi>ϕ</mi>
           <mn>1</mn>
          </msub>
         </mrow>
         <mrow>
          <mi>cos</mi>
          <msub>
           <mi>ϕ</mi>
           <mn>2</mn>
          </msub>
         </mrow>
         <mrow>
          <mi>cos</mi>
          <mrow>
           <mi mathvariant="normal">Δ</mi>
           <mi>λ</mi>
          </mrow>
         </mrow>
        </mrow>
       </mrow>
      </mfrac>
      <mo>)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>normal-Δ</ci>
     <ci>σ</ci>
    </apply>
    <apply>
     <arctan></arctan>
     <apply>
      <divide></divide>
      <apply>
       <root></root>
       <apply>
        <plus></plus>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <times></times>
          <apply>
           <cos></cos>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <ci>ϕ</ci>
            <cn type="integer">2</cn>
           </apply>
          </apply>
          <apply>
           <sin></sin>
           <apply>
            <times></times>
            <ci>normal-Δ</ci>
            <ci>λ</ci>
           </apply>
          </apply>
         </apply>
         <cn type="integer">2</cn>
        </apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <minus></minus>
          <apply>
           <times></times>
           <apply>
            <cos></cos>
            <apply>
             <csymbol cd="ambiguous">subscript</csymbol>
             <ci>ϕ</ci>
             <cn type="integer">1</cn>
            </apply>
           </apply>
           <apply>
            <sin></sin>
            <apply>
             <csymbol cd="ambiguous">subscript</csymbol>
             <ci>ϕ</ci>
             <cn type="integer">2</cn>
            </apply>
           </apply>
          </apply>
          <apply>
           <times></times>
           <apply>
            <sin></sin>
            <apply>
             <csymbol cd="ambiguous">subscript</csymbol>
             <ci>ϕ</ci>
             <cn type="integer">1</cn>
            </apply>
           </apply>
           <apply>
            <cos></cos>
            <apply>
             <csymbol cd="ambiguous">subscript</csymbol>
             <ci>ϕ</ci>
             <cn type="integer">2</cn>
            </apply>
           </apply>
           <apply>
            <cos></cos>
            <apply>
             <times></times>
             <ci>normal-Δ</ci>
             <ci>λ</ci>
            </apply>
           </apply>
          </apply>
         </apply>
         <cn type="integer">2</cn>
        </apply>
       </apply>
      </apply>
      <apply>
       <plus></plus>
       <apply>
        <times></times>
        <apply>
         <sin></sin>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>ϕ</ci>
          <cn type="integer">1</cn>
         </apply>
        </apply>
        <apply>
         <sin></sin>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>ϕ</ci>
          <cn type="integer">2</cn>
         </apply>
        </apply>
       </apply>
       <apply>
        <times></times>
        <apply>
         <cos></cos>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>ϕ</ci>
          <cn type="integer">1</cn>
         </apply>
        </apply>
        <apply>
         <cos></cos>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>ϕ</ci>
          <cn type="integer">2</cn>
         </apply>
        </apply>
        <apply>
         <cos></cos>
         <apply>
          <times></times>
          <ci>normal-Δ</ci>
          <ci>λ</ci>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Delta\sigma=\arctan\left(\frac{\sqrt{\left(\cos\phi_{2}\sin\Delta\lambda%
\right)^{2}+\left(\cos\phi_{1}\sin\phi_{2}-\sin\phi_{1}\cos\phi_{2}\cos\Delta%
\lambda\right)^{2}}}{\sin\phi_{1}\sin\phi_{2}+\cos\phi_{1}\cos\phi_{2}\cos%
\Delta\lambda}\right).
  </annotation>
 </semantics>
</math>

</p>

<p>When programming a computer, one should use the <code>[[atan2]]()</code> function rather than the ordinary arctangent function (<code>atan()</code>), so that 

<math display="inline" id="Great-circle_distance:10">
 <semantics>
  <mrow>
   <mi mathvariant="normal">Δ</mi>
   <mi>σ</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>normal-Δ</ci>
    <ci>σ</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Delta\sigma
  </annotation>
 </semantics>
</math>

 is placed in the correct quadrant.</p>

<p>The determination of the great-circle distance is just part of the more general problem of <a href="great-circle_navigation" title="wikilink">great-circle navigation</a> which computes also the azimuths at the end points and intermediate way-points.</p>
<h3 id="vector-version">Vector version</h3>

<p>Another representation of similar formulas, but using <a href="n-vector" title="wikilink">normal vectors</a> instead of latitude/longitude to describe the positions, is found by means of 3D <a href="vector_calculus#Vector_operations" title="wikilink">vector algebra</a>, i.e. utilizing the <a href="dot_product" title="wikilink">dot product</a>, <a href="cross_product" title="wikilink">cross product</a>, or a combination:<a class="footnoteRef" href="#fn5" id="fnref5"><sup>5</sup></a></p>

<p>

<math display="block" id="Great-circle_distance:11">
 <semantics>
  <mtable displaystyle="true">
   <mtr>
    <mtd columnalign="right">
     <mrow>
      <mi mathvariant="normal">Δ</mi>
      <mi>σ</mi>
     </mrow>
    </mtd>
    <mtd columnalign="left">
     <mrow>
      <mi></mi>
      <mo>=</mo>
      <mrow>
       <mi>arccos</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <msub>
          <mi>𝐧</mi>
          <mn>1</mn>
         </msub>
         <mo>⋅</mo>
         <msub>
          <mi>𝐧</mi>
          <mn>2</mn>
         </msub>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
     </mrow>
    </mtd>
   </mtr>
   <mtr>
    <mtd columnalign="right">
     <mrow>
      <mi mathvariant="normal">Δ</mi>
      <mi>σ</mi>
     </mrow>
    </mtd>
    <mtd columnalign="left">
     <mrow>
      <mi></mi>
      <mo>=</mo>
      <mrow>
       <mi>arcsin</mi>
       <mrow>
        <mo>(</mo>
        <mrow>
         <mo>|</mo>
         <mrow>
          <msub>
           <mi>𝐧</mi>
           <mn>1</mn>
          </msub>
          <mo>×</mo>
          <msub>
           <mi>𝐧</mi>
           <mn>2</mn>
          </msub>
         </mrow>
         <mo>|</mo>
        </mrow>
        <mo>)</mo>
       </mrow>
      </mrow>
     </mrow>
    </mtd>
   </mtr>
   <mtr>
    <mtd columnalign="right">
     <mrow>
      <mi mathvariant="normal">Δ</mi>
      <mi>σ</mi>
     </mrow>
    </mtd>
    <mtd columnalign="left">
     <mrow>
      <mi></mi>
      <mo>=</mo>
      <mrow>
       <mi>arctan</mi>
       <mrow>
        <mo>(</mo>
        <mfrac>
         <mrow>
          <mo>|</mo>
          <mrow>
           <msub>
            <mi>𝐧</mi>
            <mn>1</mn>
           </msub>
           <mo>×</mo>
           <msub>
            <mi>𝐧</mi>
            <mn>2</mn>
           </msub>
          </mrow>
          <mo>|</mo>
         </mrow>
         <mrow>
          <msub>
           <mi>𝐧</mi>
           <mn>1</mn>
          </msub>
          <mo>⋅</mo>
          <msub>
           <mi>𝐧</mi>
           <mn>2</mn>
          </msub>
         </mrow>
        </mfrac>
        <mo>)</mo>
       </mrow>
      </mrow>
     </mrow>
    </mtd>
   </mtr>
  </mtable>
  <annotation-xml encoding="MathML-Content">
   <matrix>
    <matrixrow>
     <apply>
      <times></times>
      <ci>normal-Δ</ci>
      <ci>σ</ci>
     </apply>
     <apply>
      <eq></eq>
      <csymbol cd="latexml">absent</csymbol>
      <apply>
       <arccos></arccos>
       <apply>
        <ci>normal-⋅</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>𝐧</ci>
         <cn type="integer">1</cn>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>𝐧</ci>
         <cn type="integer">2</cn>
        </apply>
       </apply>
      </apply>
     </apply>
    </matrixrow>
    <matrixrow>
     <apply>
      <times></times>
      <ci>normal-Δ</ci>
      <ci>σ</ci>
     </apply>
     <apply>
      <eq></eq>
      <csymbol cd="latexml">absent</csymbol>
      <apply>
       <arcsin></arcsin>
       <apply>
        <abs></abs>
        <apply>
         <times></times>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>𝐧</ci>
          <cn type="integer">1</cn>
         </apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>𝐧</ci>
          <cn type="integer">2</cn>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </matrixrow>
    <matrixrow>
     <apply>
      <times></times>
      <ci>normal-Δ</ci>
      <ci>σ</ci>
     </apply>
     <apply>
      <eq></eq>
      <csymbol cd="latexml">absent</csymbol>
      <apply>
       <arctan></arctan>
       <apply>
        <divide></divide>
        <apply>
         <abs></abs>
         <apply>
          <times></times>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>𝐧</ci>
           <cn type="integer">1</cn>
          </apply>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>𝐧</ci>
           <cn type="integer">2</cn>
          </apply>
         </apply>
        </apply>
        <apply>
         <ci>normal-⋅</ci>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>𝐧</ci>
          <cn type="integer">1</cn>
         </apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>𝐧</ci>
          <cn type="integer">2</cn>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </matrixrow>
   </matrix>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \begin{aligned}\displaystyle\Delta\sigma&\displaystyle=\arccos(\mathbf{n}_{1}%
\cdot\mathbf{n}_{2})\\
\displaystyle\Delta\sigma&\displaystyle=\arcsin\left(\left|\mathbf{n}_{1}%
\times\mathbf{n}_{2}\right|\right)\\
\displaystyle\Delta\sigma&\displaystyle=\arctan\left(\frac{\left|\mathbf{n}_{1%
}\times\mathbf{n}_{2}\right|}{\mathbf{n}_{1}\cdot\mathbf{n}_{2}}\right)\\
\end{aligned}\,\!
  </annotation>
 </semantics>
</math>

</p>

<p>where 

<math display="inline" id="Great-circle_distance:12">
 <semantics>
  <msub>
   <mi>𝐧</mi>
   <mn>1</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>𝐧</ci>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{n}_{1}
  </annotation>
 </semantics>
</math>


 and 

<math display="inline" id="Great-circle_distance:13">
 <semantics>
  <msub>
   <mi>𝐧</mi>
   <mn>2</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>𝐧</ci>
    <cn type="integer">2</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{n}_{2}
  </annotation>
 </semantics>
</math>

 are the normals to the ellipsoid at the two positions 1 and 2. Similarly to the equations above based on latitude and longitude, the expression based on arctan is the only one that is well-conditioned <a href="Inverse_trigonometric_functions#Practical_considerations" title="wikilink">for all angles</a>.</p>
<h3 id="from-chord-length">From chord length</h3>

<p>A line through three-dimensional space between points of interest on a spherical Earth is the chord of the great circle between the points. The <a href="central_angle" title="wikilink">central angle</a> between the two points can be determined from the chord length. The great circle distance is proportional to the central angle.</p>

<p>The great circle chord length, 

<math display="inline" id="Great-circle_distance:14">
 <semantics>
  <msub>
   <mi>C</mi>
   <mi>h</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>C</ci>
    <ci>h</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   C_{h}\,\!
  </annotation>
 </semantics>
</math>

, may be calculated as follows for the corresponding unit sphere, by means of <a href="Cartesian_coordinate_system" title="wikilink">Cartesian subtraction</a>:</p>

<p>

<math display="inline" id="Great-circle_distance:15">
 <semantics>
  <mrow>
   <mi mathvariant="normal">Δ</mi>
   <mi>X</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>normal-Δ</ci>
    <ci>X</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle\Delta{X}
  </annotation>
 </semantics>
</math>


</p>

<p>The central angle is:</p>

<p>

<math display="block" id="Great-circle_distance:16">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi mathvariant="normal">Δ</mi>
     <mi>σ</mi>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mn>2</mn>
     <mrow>
      <mi>arcsin</mi>
      <mrow>
       <mo>(</mo>
       <mfrac>
        <mi>C</mi>
        <mn>2</mn>
       </mfrac>
       <mo>)</mo>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>normal-Δ</ci>
     <ci>σ</ci>
    </apply>
    <apply>
     <times></times>
     <cn type="integer">2</cn>
     <apply>
      <arcsin></arcsin>
      <apply>
       <divide></divide>
       <ci>C</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Delta\sigma=2\arcsin\left(\frac{C}{2}\right).
  </annotation>
 </semantics>
</math>

</p>

<p>The great circle distance is:</p>

<p>

<math display="block" id="Great-circle_distance:17">
 <semantics>
  <mrow>
   <mrow>
    <mi>d</mi>
    <mo>=</mo>
    <mrow>
     <mi>r</mi>
     <mi mathvariant="normal">Δ</mi>
     <mi>σ</mi>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>d</ci>
    <apply>
     <times></times>
     <ci>r</ci>
     <ci>normal-Δ</ci>
     <ci>σ</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   d=r\Delta\sigma.
  </annotation>
 </semantics>
</math>

 In this last formula, the central angle must be in <a class="uri" href="radians" title="wikilink">radians</a>. Alternatively, when working in <a href="nautical_mile" title="wikilink">nautical miles</a>, the distance may be calculated directly by converting the central angle in degrees to minutes (i.e. multiply by 60).</p>
<h2 id="radius-for-spherical-earth">Radius for spherical Earth</h2>

<p>The <a href="geoid" title="wikilink">shape of the Earth</a> closely resembles a flattened sphere (a <a class="uri" href="spheroid" title="wikilink">spheroid</a>) with equatorial radius 

<math display="inline" id="Great-circle_distance:18">
 <semantics>
  <mi>a</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>a</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a
  </annotation>
 </semantics>
</math>

 of 6378.137 km; distance 

<math display="inline" id="Great-circle_distance:19">
 <semantics>
  <mi>b</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>b</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   b
  </annotation>
 </semantics>
</math>

 from the center of the spheroid to each pole is 6356.752 km. When calculating the length of a short north-south line at the equator, the circle that best approximates that line has a radius of 

<math display="inline" id="Great-circle_distance:20">
 <semantics>
  <mrow>
   <msup>
    <mi>b</mi>
    <mn>2</mn>
   </msup>
   <mo>/</mo>
   <mi>a</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <divide></divide>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>b</ci>
     <cn type="integer">2</cn>
    </apply>
    <ci>a</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   b^{2}/a
  </annotation>
 </semantics>
</math>

 (which equals the meridian's <a href="Conic_section#Features" title="wikilink">semi-latus rectum</a>), or 6335.439 km, while the spheroid at the poles is best approximated by a sphere of radius 

<math display="inline" id="Great-circle_distance:21">
 <semantics>
  <mrow>
   <msup>
    <mi>a</mi>
    <mn>2</mn>
   </msup>
   <mo>/</mo>
   <mi>b</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <divide></divide>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>a</ci>
     <cn type="integer">2</cn>
    </apply>
    <ci>b</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a^{2}/b
  </annotation>
 </semantics>
</math>


, or 6399.594 km, a 1% difference. So as long as we're assuming a spherical Earth, any single formula for distance on the Earth is only guaranteed correct within 0.5% (though we can do better if our formula is only intended to apply to a limited area). A good choice<a class="footnoteRef" href="#fn6" id="fnref6"><sup>6</sup></a> for the radius is the <a href="Earth_radius#Mean_radius" title="wikilink">mean earth radius</a>, 

<math display="inline" id="Great-circle_distance:22">
 <semantics>
  <mrow>
   <msub>
    <mi>R</mi>
    <mn>1</mn>
   </msub>
   <mo>=</mo>
   <mrow>
    <mfrac>
     <mn>1</mn>
     <mn>3</mn>
    </mfrac>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mrow>
       <mn>2</mn>
       <mi>a</mi>
      </mrow>
      <mo>+</mo>
      <mi>b</mi>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>≈</mo>
   <mrow>
    <mpadded width="+1.7pt">
     <mn>6371</mn>
    </mpadded>
    <mi>km</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>R</ci>
      <cn type="integer">1</cn>
     </apply>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <cn type="integer">3</cn>
      </apply>
      <apply>
       <plus></plus>
       <apply>
        <times></times>
        <cn type="integer">2</cn>
        <ci>a</ci>
       </apply>
       <ci>b</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <approx></approx>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <cn type="integer">6371</cn>
      <ci>km</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   R_{1}=\frac{1}{3}(2a+b)\approx 6371\,\mathrm{km}
  </annotation>
 </semantics>
</math>

 (for the <a class="uri" href="WGS84" title="wikilink">WGS84</a> ellipsoid); in the limit of small flattening, this choice minimizes the mean square <a href="Relative_error#Definitions" title="wikilink">relative error</a> in the estimates for distance.</p>
<h2 id="see-also">See also</h2>
<ul>
<li><a href="Air_navigation" title="wikilink">Air navigation</a></li>
<li><a href="Central_angle" title="wikilink">Central angle</a></li>
<li><a class="uri" href="Circumnavigation" title="wikilink">Circumnavigation</a></li>
<li><a href="Flight_planning" title="wikilink">Flight planning</a></li>
<li><a class="uri" href="Geodesy" title="wikilink">Geodesy</a></li>
<li><a href="Geodesics_on_an_ellipsoid" title="wikilink">Geodesics on an ellipsoid</a></li>
<li><a href="Geodetic_system" title="wikilink">Geodetic system</a></li>
<li><a href="Geographical_distance" title="wikilink">Geographical distance</a></li>
<li><a href="Great-circle_navigation" title="wikilink">Great-circle navigation</a></li>
<li><a href="Haversine_formula" title="wikilink">Haversine formula</a></li>
<li><a href="Meridian_arc" title="wikilink">Meridian arc</a></li>
<li><a class="uri" href="Qibla" title="wikilink">Qibla</a></li>
<li><a href="Rhumb_line" title="wikilink">Rhumb line</a></li>
<li><a href="Spherical_Earth" title="wikilink">Spherical Earth</a></li>
<li><a href="Spherical_geometry" title="wikilink">Spherical geometry</a></li>
<li><a href="Spherical_trigonometry" title="wikilink">Spherical trigonometry</a></li>
</ul>
<h2 id="references">References</h2>
<h2 id="external-links">External links</h2>
<ul>
<li><a href="http://mathworld.wolfram.com/GreatCircle.html">GreatCircle</a> at <a class="uri" href="MathWorld" title="wikilink">MathWorld</a></li>
</ul>

<p>"</p>

<p><a href="Category:Metric_geometry" title="wikilink">Category:Metric geometry</a> <a href="Category:Spherical_trigonometry" title="wikilink">Category:Spherical trigonometry</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1"><a href="#fnref1">↩</a></li>
<li id="fn2"><a href="#fnref2">↩</a></li>
<li id="fn3">R.W. Sinnott, "Virtues of the Haversine", Sky and Telescope, vol. 68, no. 2, 1984, p. 159<a href="#fnref3">↩</a></li>
<li id="fn4"><a href="#fnref4">↩</a></li>
<li id="fn5"><a href="#fnref5">↩</a></li>
<li id="fn6"><a href="#fnref6">↩</a></li>
</ol>
</section>
</body>
</html>

<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="1935">Guard (computer science)</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Guard (computer science)</h1>
<style>
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
<style>
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
  </style>
</body></html>
<body>
<hr/>

<p>In computer programming, a <strong>guard</strong> is a <a href="Boolean_datatype" title="wikilink">boolean</a> <a href="expression_(programming)" title="wikilink">expression</a> that must evaluate to true if the program execution is to continue in the branch in question.</p>

<p>Regardless of which programming language is used, <strong>guard code</strong> is a check of integrity preconditions used to avoid errors during execution. A typical example is checking that a reference about to be processed be not null, which avoids null-pointer failures.</p>

<p>The term is used with specific meaning a.o. in <a href="Haskell_(programming_language)" title="wikilink">Haskell</a>, <a href="Clean_programming_language" title="wikilink">Clean</a>, <a href="Erlang_programming_language" title="wikilink">Erlang</a>, <a href="Occam_(programming_language)" title="wikilink">occam</a>, <a class="uri" href="Promela" title="wikilink">Promela</a>, <a class="uri" href="OCaml" title="wikilink">OCaml</a> and <a href="Scala_(programming_language)" title="wikilink">Scala</a> programming languages. In <a class="uri" href="Mathematica" title="wikilink">Mathematica</a>, guards are called <em>constraints</em>. Guards are the fundamental concept in <a href="Guarded_Command_Language" title="wikilink">Guarded Command Language</a>, a language in <a href="formal_methods" title="wikilink">formal methods</a>. Guards can be used to augment <a href="pattern_matching" title="wikilink">pattern matching</a> with the possibility to skip a pattern even if the structure matches. Boolean expressions in <a href="Conditional_(programming)" title="wikilink">conditional statements</a> usually also fit this definition of a guard although they are called <em>conditions</em>.</p>

<p>In the following Haskell example, the guards occur between each pair of "|" and "=":</p>
<div class="sourceCode"><pre class="sourceCode haskell"><code class="sourceCode haskell">f x
 <span class="fu">|</span> x <span class="fu">&gt;</span> <span class="dv">0</span> <span class="fu">=</span> <span class="dv">1</span>
 <span class="fu">|</span> otherwise <span class="fu">=</span> <span class="dv">0</span></code></pre></div>

<p>This is similar to the respective mathematical notation:</p>

<p>

<math display="inline" id="Guard_(computer_science):0">
 <semantics>
  <mrow>
   <mi>f</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>x</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mo>{</mo>
    <mtable>
     <mtr>
      <mtd columnalign="center">
       <mn>1</mn>
      </mtd>
      <mtd columnalign="center">
       <mrow>
        <mrow>
         <mtext>if</mtext>
         <mi>x</mi>
        </mrow>
        <mo>></mo>
        <mn>0</mn>
       </mrow>
      </mtd>
     </mtr>
     <mtr>
      <mtd columnalign="center">
       <mn>0</mn>
      </mtd>
      <mtd columnalign="center">
       <mtext>otherwise</mtext>
      </mtd>
     </mtr>
    </mtable>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">f</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">x</csymbol>
     <ci>normal-)</ci>
    </cerror>
    <eq></eq>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-{</ci>
     <matrix>
      <matrixrow>
       <cn type="integer">1</cn>
       <apply>
        <gt></gt>
        <apply>
         <times></times>
         <mtext>if</mtext>
         <ci>x</ci>
        </apply>
        <cn type="integer">0</cn>
       </apply>
      </matrixrow>
      <matrixrow>
       <cn type="integer">0</cn>
       <mtext>otherwise</mtext>
      </matrixrow>
     </matrix>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f(x)=\left\{\begin{matrix}1&\mbox{if }x>0\\
0&\mbox{otherwise}\end{matrix}\right.
  </annotation>
 </semantics>
</math>

</p>

<p>In this case the guards are in the "if" and "otherwise" clauses.</p>

<p>If there are several parallel guards, such as in the example above, they are normally tried in a top to bottom order and the branch of the first to pass is chosen. Guards in a list of cases are typically parallel.</p>

<p>However, in Haskell <a href="list_comprehension" title="wikilink">list comprehensions</a> the guards are in series, and if any of them fails, the list element is not produced. This would be the same as combining the separate guards with <a href="logical_conjunction" title="wikilink">logical AND</a>, except that there can be other list comprehension clauses among the guards.</p>
<h2 id="evolution">Evolution</h2>

<p>A simple conditional expression, already present in <a href="CPL_programming_language" title="wikilink">CPL</a> in 1963, has a guard on first sub-expression, and another sub-expression to use in case the first one cannot be used. Some common ways to write this:</p>

<p><code>(x&gt;0) -&gt; 1/x; 0</code><br/>
<code>x&gt;0 ? 1/x : 0</code></p>

<p>If the second sub-expression can be a further simple conditional expression, we can give more alternatives to try before the last <em>fall-through</em>:</p>

<p><code>(x&gt;0) -&gt; 1/x; (x</code><code> -1/x; 0</code></p>

<p>In 1966 <a class="uri" href="ISWIM" title="wikilink">ISWIM</a> had a form of conditional expression without an obligatory fall-through case, thus separating guard from the concept of choosing either-or. In the case of ISWIM, if none of the alternatives could be used, the value was to be <em>undefined</em>, which was defined to never compute into a value.</p>

<p><a href="SASL_programming_language" title="wikilink">SASL</a> (1976) was one of the first programming languages to use the term "guard". In the language, functions could have several definitions and the one to apply was chosen based on the guards that followed each definition:</p>
<div class="sourceCode"><pre class="sourceCode haskell"><code class="sourceCode haskell"> fac n <span class="fu">=</span> <span class="dv">1</span>, n <span class="fu">=</span> <span class="dv">0</span>
 <span class="fu">=</span> n <span class="fu">*</span> fac (n<span class="fu">-</span><span class="dv">1</span>), n <span class="fu">&gt;</span> <span class="dv">0</span></code></pre></div>
<h2 id="pattern-guard">Pattern guard</h2>

<p>In addition to a guard attached to a pattern, <strong>pattern guard</strong> can refer to the use of <a href="pattern_matching" title="wikilink">pattern matching</a> in the context of a guard. In effect, a match of the pattern is taken to mean pass. This meaning was introduced in a proposal for Haskell by <a href="Simon_Peyton_Jones" title="wikilink">Simon Peyton Jones</a> titled <a href="http://research.microsoft.com/Users/simonpj/Haskell/guards.html">A new view of guards</a> in April 1997 and was used in the implementation of the proposal. The feature provides the ability to use patterns in the guards of a pattern.</p>

<p>An example in extended Haskell:</p>
<div class="sourceCode"><pre class="sourceCode haskell"><code class="sourceCode haskell"> clunky env var1 var2
 <span class="fu">|</span> <span class="dt">Just</span> val1 <span class="ot">&lt;-</span> lookup env var1
 , <span class="dt">Just</span> val2 <span class="ot">&lt;-</span> lookup env var2
 <span class="fu">=</span> val1 <span class="fu">+</span> val2
 <span class="co">-- ...other equations for clunky...</span></code></pre></div>

<p>This would read: "Clunky for an environment and two variables, <em>in case the lookups of the variables from the environment produce values</em>, is the sum of the values. ..." As in <a href="list_comprehension" title="wikilink">list comprehensions</a>, the guards are in series, and if any of them fails the branch is not taken.</p>
<h2 id="see-also">See also</h2>
<ul>
<li><a href="Assertion_(computing)" title="wikilink">Assertion</a></li>
<li><a href="Logical_conditional" title="wikilink">Logical conditional</a></li>
<li><a href="Switch_statement" title="wikilink">Switch statement</a></li>
<li><a href="Iverson_bracket" title="wikilink">Iverson bracket</a></li>
<li><a href="Guarded_suspension" title="wikilink">Guarded suspension</a></li>
</ul>
<h2 id="references">References</h2>
<ul>
<li><a href="http://foldoc.org/guard">Guard</a> in <em>Free On-Line Dictionary of Computing - FOLDOC</em>, Denis Howe (editor).</li>
<li><em>The Haskell 98 Report</em>, chapter <a href="http://haskell.org/onlinereport/exps.html">3 Expressions</a>.</li>
<li><em>The Mathematica Book,</em> section <a href="http://documents.wolfram.com/mathematica/book/section-2.3.5">2.3.5 Putting Constraints on Patterns</a></li>
<li><em>The Glorious Glasgow Haskell Compilation System User's Guide</em>, Version 6.4, section <a href="http://www.haskell.org/ghc/docs/latest/html/users_guide/syntax-extns.html#pattern-guards">7.3.2. Pattern guards</a></li>
</ul>

<p>"</p>

<p><a href="Category:Conditional_constructs" title="wikilink">Category:Conditional constructs</a> <a href="Category:Formal_methods_terminology" title="wikilink">Category:Formal methods terminology</a> <a href="Category:Articles_with_example_Haskell_code" title="wikilink">Category:Articles with example Haskell code</a></p>
</body>


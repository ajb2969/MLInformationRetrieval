<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="1234">Shamir's Secret Sharing</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Shamir's Secret Sharing</h1>
<style>
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
<style>
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
  </style>
</body></html>
<body>
<hr/>

<p><strong>Shamir's Secret Sharing</strong> is an <a class="uri" href="algorithm" title="wikilink">algorithm</a> in <a class="uri" href="cryptography" title="wikilink">cryptography</a> created by <a href="Adi_Shamir" title="wikilink">Adi Shamir</a>. It is a form of <a href="secret_sharing" title="wikilink">secret sharing</a>, where a secret is divided into parts, giving each participant its own unique part, where some of the parts or all of them are needed in order to reconstruct the secret.</p>

<p>Counting on all participants to combine together the secret might be impractical, and therefore sometimes the <em>threshold scheme</em> is used where any 

<math display="inline" id="Shamir's_Secret_Sharing:0">
 <semantics>
  <mi>k</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>k</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   k
  </annotation>
 </semantics>
</math>

 of the parts are sufficient to reconstruct the original secret.</p>
<h2 id="mathematical-definition">Mathematical definition</h2>

<p>The goal is to divide secret 

<math display="inline" id="Shamir's_Secret_Sharing:1">
 <semantics>
  <mi>S</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>S</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   S
  </annotation>
 </semantics>
</math>

 (e.g., a <a class="uri" href="safe" title="wikilink">safe</a> combination) into 

<math display="inline" id="Shamir's_Secret_Sharing:2">
 <semantics>
  <mi>n</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>n</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n
  </annotation>
 </semantics>
</math>

 pieces of data 

<math display="inline" id="Shamir's_Secret_Sharing:3">
 <semantics>
  <mrow>
   <msub>
    <mi>S</mi>
    <mn>1</mn>
   </msub>
   <mo>,</mo>
   <mi mathvariant="normal">…</mi>
   <mo>,</mo>
   <msub>
    <mi>S</mi>
    <mi>n</mi>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <list>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>S</ci>
     <cn type="integer">1</cn>
    </apply>
    <ci>normal-…</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>S</ci>
     <ci>n</ci>
    </apply>
   </list>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   S_{1},\ldots,S_{n}
  </annotation>
 </semantics>
</math>


 in such a way that:</p>
<ol>
<li>Knowledge of any 

<math display="inline" id="Shamir's_Secret_Sharing:4">
 <semantics>
  <mi>k</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>k</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   k
  </annotation>
 </semantics>
</math>

 or more 

<math display="inline" id="Shamir's_Secret_Sharing:5">
 <semantics>
  <msub>
   <mi>S</mi>
   <mi>i</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>S</ci>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   S_{i}
  </annotation>
 </semantics>
</math>

 pieces makes 

<math display="inline" id="Shamir's_Secret_Sharing:6">
 <semantics>
  <mi>S</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>S</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   S
  </annotation>
 </semantics>
</math>

 easily computable.</li>
<li>Knowledge of any 

<math display="inline" id="Shamir's_Secret_Sharing:7">
 <semantics>
  <mrow>
   <mi>k</mi>
   <mo>-</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <minus></minus>
    <ci>k</ci>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   k-1
  </annotation>
 </semantics>
</math>

 or fewer 

<math display="inline" id="Shamir's_Secret_Sharing:8">
 <semantics>
  <msub>
   <mi>S</mi>
   <mi>i</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>S</ci>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   S_{i}
  </annotation>
 </semantics>
</math>


 pieces leaves 

<math display="inline" id="Shamir's_Secret_Sharing:9">
 <semantics>
  <mi>S</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>S</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   S
  </annotation>
 </semantics>
</math>

 completely undetermined (in the sense that all its possible values are equally likely).</li>
</ol>

<p>This scheme is called 

<math display="inline" id="Shamir's_Secret_Sharing:10">
 <semantics>
  <mrow>
   <mo>(</mo>
   <mi>k</mi>
   <mo>,</mo>
   <mi>n</mi>
   <mo>)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <interval closure="open">
    <ci>k</ci>
    <ci>n</ci>
   </interval>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \left(k,n\right)
  </annotation>
 </semantics>
</math>

 threshold scheme. If 

<math display="inline" id="Shamir's_Secret_Sharing:11">
 <semantics>
  <mrow>
   <mi>k</mi>
   <mo>=</mo>
   <mi>n</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>k</ci>
    <ci>n</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   k=n
  </annotation>
 </semantics>
</math>

 then all participants are required to reconstruct the secret.</p>
<h2 id="shamirs-secret-sharing-scheme">Shamir's secret-sharing scheme</h2>

<p> The essential idea of <a href="Adi_Shamir" title="wikilink">Adi Shamir</a>'s threshold scheme is that 2 <a href="Point_(geometry)" title="wikilink">points</a> are sufficient to define a <a href="Line_(geometry)" title="wikilink">line</a>, 3 points are sufficient to define a <a class="uri" href="parabola" title="wikilink">parabola</a>, 4 points to define a <a href="cubic_function" title="wikilink">cubic curve</a> and so forth. That is, it takes 

<math display="inline" id="Shamir's_Secret_Sharing:12">
 <semantics>
  <mi>k</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>k</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   k\,\!
  </annotation>
 </semantics>
</math>

 points to define a <a class="uri" href="polynomial" title="wikilink">polynomial</a> of <a href="Degree_of_a_polynomial" title="wikilink">degree</a> 

<math display="inline" id="Shamir's_Secret_Sharing:13">
 <semantics>
  <mrow>
   <mi>k</mi>
   <mo>-</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <minus></minus>
    <ci>k</ci>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   k-1\,\!
  </annotation>
 </semantics>
</math>


.</p>

<p>Suppose we want to use a 

<math display="inline" id="Shamir's_Secret_Sharing:14">
 <semantics>
  <mrow>
   <mo>(</mo>
   <mi>k</mi>
   <mo>,</mo>
   <mi>n</mi>
   <mo>)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <interval closure="open">
    <ci>k</ci>
    <ci>n</ci>
   </interval>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \left(k,n\right)\,\!
  </annotation>
 </semantics>
</math>

 threshold scheme to share our secret 

<math display="inline" id="Shamir's_Secret_Sharing:15">
 <semantics>
  <mi>S</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>S</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   S\,\!
  </annotation>
 </semantics>
</math>

, without loss of generality assumed to be an element in a <a href="finite_field" title="wikilink">finite field</a> 

<math display="inline" id="Shamir's_Secret_Sharing:16">
 <semantics>
  <mi>F</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>F</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   F
  </annotation>
 </semantics>
</math>

 of size 

<math display="inline" id="Shamir's_Secret_Sharing:17">
 <semantics>
  <mi>P</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>P</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   P
  </annotation>
 </semantics>
</math>

 where 

<math display="inline" id="Shamir's_Secret_Sharing:18">
 <semantics>
  <mrow>
   <mi>k</mi>
   <mo>-</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <minus></minus>
    <ci>k</ci>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   k-1\,\!
  </annotation>
 </semantics>
</math>


 is a prime number.</p>

<p>Choose at random 

<math display="inline" id="Shamir's_Secret_Sharing:19">
 <semantics>
  <mrow>
   <msub>
    <mi>a</mi>
    <mn>1</mn>
   </msub>
   <mo>,</mo>
   <mi mathvariant="normal">⋯</mi>
   <mo>,</mo>
   <msub>
    <mi>a</mi>
    <mrow>
     <mi>k</mi>
     <mo>-</mo>
     <mn>1</mn>
    </mrow>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <list>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>a</ci>
     <cn type="integer">1</cn>
    </apply>
    <ci>normal-⋯</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>a</ci>
     <apply>
      <minus></minus>
      <ci>k</ci>
      <cn type="integer">1</cn>
     </apply>
    </apply>
   </list>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a_{1},\cdots,a_{k-1}\,\!
  </annotation>
 </semantics>
</math>

 positive integers 

<math display="inline" id="Shamir's_Secret_Sharing:20">
 <semantics>
  <mrow>
   <mrow>
    <mi>f</mi>
    <mrow>
     <mo>(</mo>
     <mi>x</mi>
     <mo>)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <msub>
     <mi>a</mi>
     <mn>0</mn>
    </msub>
    <mo>+</mo>
    <mrow>
     <msub>
      <mi>a</mi>
      <mn>1</mn>
     </msub>
     <mi>x</mi>
    </mrow>
    <mo>+</mo>
    <mrow>
     <msub>
      <mi>a</mi>
      <mn>2</mn>
     </msub>
     <msup>
      <mi>x</mi>
      <mn>2</mn>
     </msup>
    </mrow>
    <mo>+</mo>
    <mrow>
     <msub>
      <mi>a</mi>
      <mn>3</mn>
     </msub>
     <msup>
      <mi>x</mi>
      <mn>3</mn>
     </msup>
    </mrow>
    <mo>+</mo>
    <mi mathvariant="normal">⋯</mi>
    <mo>+</mo>
    <mrow>
     <msub>
      <mi>a</mi>
      <mrow>
       <mi>k</mi>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
     </msub>
     <msup>
      <mi>x</mi>
      <mrow>
       <mi>k</mi>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
     </msup>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>f</ci>
     <ci>x</ci>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>a</ci>
      <cn type="integer">0</cn>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>a</ci>
       <cn type="integer">1</cn>
      </apply>
      <ci>x</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>a</ci>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>x</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>a</ci>
       <cn type="integer">3</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>x</ci>
       <cn type="integer">3</cn>
      </apply>
     </apply>
     <ci>normal-⋯</ci>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>a</ci>
       <apply>
        <minus></minus>
        <ci>k</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>x</ci>
       <apply>
        <minus></minus>
        <ci>k</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f\left(x\right)=a_{0}+a_{1}x+a_{2}x^{2}+a_{3}x^{3}+\cdots+a_{k-1}x^{k-1}\,\!
  </annotation>
 </semantics>
</math>

 with 

<math display="inline" id="Shamir's_Secret_Sharing:21">
 <semantics>
  <mi>n</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>n</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n\,\!
  </annotation>
 </semantics>
</math>

. Build the polynomial 

<math display="inline" id="Shamir's_Secret_Sharing:22">
 <semantics>
  <mrow>
   <mi>i</mi>
   <mo>=</mo>
   <mrow>
    <mn>1</mn>
    <mo>,</mo>
    <mi mathvariant="normal">⋯</mi>
    <mo>,</mo>
    <mi>n</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>i</ci>
    <list>
     <cn type="integer">1</cn>
     <ci>normal-⋯</ci>
     <ci>n</ci>
    </list>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   i=1,\cdots,n\,\!
  </annotation>
 </semantics>
</math>

. Let us construct any 

<math display="inline" id="Shamir's_Secret_Sharing:23">
 <semantics>
  <mrow>
   <mo>(</mo>
   <mi>i</mi>
   <mo>,</mo>
   <mrow>
    <mi>f</mi>
    <mrow>
     <mo>(</mo>
     <mi>i</mi>
     <mo>)</mo>
    </mrow>
   </mrow>
   <mo>)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <interval closure="open">
    <ci>i</ci>
    <apply>
     <times></times>
     <ci>f</ci>
     <ci>i</ci>
    </apply>
   </interval>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \left(i,f\left(i\right)\right)\,\!
  </annotation>
 </semantics>
</math>


 points out of it, for instance set 

<math display="inline" id="Shamir's_Secret_Sharing:24">
 <semantics>
  <mi>k</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>k</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   k\,\!
  </annotation>
 </semantics>
</math>

 to retrieve 

<math display="inline" id="Shamir's_Secret_Sharing:25">
 <semantics>
  <msub>
   <mi>a</mi>
   <mn>0</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>a</ci>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a_{0}\,\!
  </annotation>
 </semantics>
</math>

. Every participant is given a point (an integer input to the polynomial, and the corresponding integer output). Given any subset of 

<math display="inline" id="Shamir's_Secret_Sharing:26">
 <semantics>
  <mrow>
   <mo stretchy="false">(</mo>
   <mrow>
    <mi>S</mi>
    <mo>=</mo>
    <mn>1234</mn>
   </mrow>
   <mo stretchy="false">)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>S</ci>
    <cn type="integer">1234</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (S=1234)\,\!
  </annotation>
 </semantics>
</math>

 of these pairs, we can find the coefficients of the polynomial using <a href="curve_fitting" title="wikilink">interpolation</a>. The secret is the constant term 

<math display="inline" id="Shamir's_Secret_Sharing:27">
 <semantics>
  <mrow>
   <mo stretchy="false">(</mo>
   <mrow>
    <mi>n</mi>
    <mo>=</mo>
    <mn>6</mn>
   </mrow>
   <mo stretchy="false">)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>n</ci>
    <cn type="integer">6</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (n=6)\,\!
  </annotation>
 </semantics>
</math>

.</p>
<h2 id="usage">Usage</h2>
<h3 id="example">Example</h3>

<p>The following example illustrates the basic idea. Note, however, that calculations in the example are done using integer arithmetic rather than using <a href="finite_field_arithmetic" title="wikilink">finite field arithmetic</a>. Therefore the example below does not provide perfect secrecy and is not a true example of Shamir's scheme. So we'll explain this problem and show the right way to implement it (using finite field arithmetic).</p>
<h4 id="preparation">Preparation</h4>

<p>Suppose that our secret is 1234 

<math display="inline" id="Shamir's_Secret_Sharing:28">
 <semantics>
  <mrow>
   <mo stretchy="false">(</mo>
   <mrow>
    <mi>k</mi>
    <mo>=</mo>
    <mn>3</mn>
   </mrow>
   <mo stretchy="false">)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>k</ci>
    <cn type="integer">3</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (k=3)\,\!
  </annotation>
 </semantics>
</math>


.</p>

<p>We wish to divide the secret into 6 parts 

<math display="inline" id="Shamir's_Secret_Sharing:29">
 <semantics>
  <mrow>
   <mi>k</mi>
   <mo>-</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <minus></minus>
    <ci>k</ci>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   k-1
  </annotation>
 </semantics>
</math>

, where any subset of 3 parts 

<math display="inline" id="Shamir's_Secret_Sharing:30">
 <semantics>
  <mrow>
   <mo stretchy="false">(</mo>
   <mrow>
    <mrow>
     <msub>
      <mi>a</mi>
      <mn>1</mn>
     </msub>
     <mo>=</mo>
     <mn>166</mn>
    </mrow>
    <mo>;</mo>
    <mrow>
     <msub>
      <mi>a</mi>
      <mn>2</mn>
     </msub>
     <mo>=</mo>
     <mn>94</mn>
    </mrow>
   </mrow>
   <mo stretchy="false">)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>a</ci>
      <cn type="integer">1</cn>
     </apply>
     <cn type="integer">166</cn>
    </apply>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>a</ci>
      <cn type="integer">2</cn>
     </apply>
     <cn type="integer">94</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (a_{1}=166;a_{2}=94)\,\!
  </annotation>
 </semantics>
</math>

 is sufficient to reconstruct the secret. At random we obtain two (

<math display="inline" id="Shamir's_Secret_Sharing:31">
 <semantics>
  <mrow>
   <mrow>
    <mi>f</mi>
    <mrow>
     <mo>(</mo>
     <mi>x</mi>
     <mo>)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mn>1234</mn>
    <mo>+</mo>
    <mrow>
     <mn>166</mn>
     <mi>x</mi>
    </mrow>
    <mo>+</mo>
    <mrow>
     <mn>94</mn>
     <msup>
      <mi>x</mi>
      <mn>2</mn>
     </msup>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>f</ci>
     <ci>x</ci>
    </apply>
    <apply>
     <plus></plus>
     <cn type="integer">1234</cn>
     <apply>
      <times></times>
      <cn type="integer">166</cn>
      <ci>x</ci>
     </apply>
     <apply>
      <times></times>
      <cn type="integer">94</cn>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>x</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f\left(x\right)=1234+166x+94x^{2}\,\!
  </annotation>
 </semantics>
</math>

) numbers: 166 and 94.</p>

<p>

<math display="inline" id="Shamir's_Secret_Sharing:32">
 <semantics>
  <mrow>
   <msub>
    <mi>D</mi>
    <mrow>
     <mi>x</mi>
     <mo>-</mo>
     <mn>1</mn>
    </mrow>
   </msub>
   <mo>=</mo>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>x</mi>
    <mo>,</mo>
    <mrow>
     <mi>f</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>x</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>D</ci>
     <apply>
      <minus></minus>
      <ci>x</ci>
      <cn type="integer">1</cn>
     </apply>
    </apply>
    <interval closure="open">
     <ci>x</ci>
     <apply>
      <times></times>
      <ci>f</ci>
      <ci>x</ci>
     </apply>
    </interval>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   D_{x-1}=(x,f(x))
  </annotation>
 </semantics>
</math>

</p>

<p>Our polynomial to produce secret shares (points) is therefore:</p>

<p>

<math display="inline" id="Shamir's_Secret_Sharing:33">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>D</mi>
     <mn>0</mn>
    </msub>
    <mo>=</mo>
    <mrow>
     <mo>(</mo>
     <mn>1</mn>
     <mo>,</mo>
     <mn>1494</mn>
     <mo>)</mo>
    </mrow>
   </mrow>
   <mo>;</mo>
   <mrow>
    <mrow>
     <msub>
      <mi>D</mi>
      <mn>1</mn>
     </msub>
     <mo>=</mo>
     <mrow>
      <mo>(</mo>
      <mn>2</mn>
      <mo>,</mo>
      <mn>1942</mn>
      <mo>)</mo>
     </mrow>
    </mrow>
    <mo>;</mo>
    <mrow>
     <mrow>
      <msub>
       <mi>D</mi>
       <mn>2</mn>
      </msub>
      <mo>=</mo>
      <mrow>
       <mo>(</mo>
       <mn>3</mn>
       <mo>,</mo>
       <mn>2578</mn>
       <mo>)</mo>
      </mrow>
     </mrow>
     <mo>;</mo>
     <mrow>
      <mrow>
       <msub>
        <mi>D</mi>
        <mn>3</mn>
       </msub>
       <mo>=</mo>
       <mrow>
        <mo>(</mo>
        <mn>4</mn>
        <mo>,</mo>
        <mn>3402</mn>
        <mo>)</mo>
       </mrow>
      </mrow>
      <mo>;</mo>
      <mrow>
       <mrow>
        <msub>
         <mi>D</mi>
         <mn>4</mn>
        </msub>
        <mo>=</mo>
        <mrow>
         <mo>(</mo>
         <mn>5</mn>
         <mo>,</mo>
         <mn>4414</mn>
         <mo>)</mo>
        </mrow>
       </mrow>
       <mo>;</mo>
       <mrow>
        <msub>
         <mi>D</mi>
         <mn>5</mn>
        </msub>
        <mo>=</mo>
        <mrow>
         <mo>(</mo>
         <mn>6</mn>
         <mo>,</mo>
         <mn>5614</mn>
         <mo>)</mo>
        </mrow>
       </mrow>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>D</ci>
      <cn type="integer">0</cn>
     </apply>
     <interval closure="open">
      <cn type="integer">1</cn>
      <cn type="integer">1494</cn>
     </interval>
    </apply>
    <apply>
     <csymbol cd="ambiguous">formulae-sequence</csymbol>
     <apply>
      <eq></eq>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>D</ci>
       <cn type="integer">1</cn>
      </apply>
      <interval closure="open">
       <cn type="integer">2</cn>
       <cn type="integer">1942</cn>
      </interval>
     </apply>
     <apply>
      <csymbol cd="ambiguous">formulae-sequence</csymbol>
      <apply>
       <eq></eq>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>D</ci>
        <cn type="integer">2</cn>
       </apply>
       <interval closure="open">
        <cn type="integer">3</cn>
        <cn type="integer">2578</cn>
       </interval>
      </apply>
      <apply>
       <csymbol cd="ambiguous">formulae-sequence</csymbol>
       <apply>
        <eq></eq>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>D</ci>
         <cn type="integer">3</cn>
        </apply>
        <interval closure="open">
         <cn type="integer">4</cn>
         <cn type="integer">3402</cn>
        </interval>
       </apply>
       <apply>
        <csymbol cd="ambiguous">formulae-sequence</csymbol>
        <apply>
         <eq></eq>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>D</ci>
          <cn type="integer">4</cn>
         </apply>
         <interval closure="open">
          <cn type="integer">5</cn>
          <cn type="integer">4414</cn>
         </interval>
        </apply>
        <apply>
         <eq></eq>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>D</ci>
          <cn type="integer">5</cn>
         </apply>
         <interval closure="open">
          <cn type="integer">6</cn>
          <cn type="integer">5614</cn>
         </interval>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   D_{0}=\left(1,1494\right);D_{1}=\left(2,1942\right);D_{2}=\left(3,2578\right);%
D_{3}=\left(4,3402\right);D_{4}=\left(5,4414\right);D_{5}=\left(6,5614\right)\,\!
  </annotation>
 </semantics>
</math>


</p>

<p>We construct 6 points 

<math display="inline" id="Shamir's_Secret_Sharing:34">
 <semantics>
  <mi>x</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>x</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x\,\!
  </annotation>
 </semantics>
</math>

 from the polynomial:</p>

<p>

<math display="inline" id="Shamir's_Secret_Sharing:35">
 <semantics>
  <mrow>
   <mi>f</mi>
   <mrow>
    <mo>(</mo>
    <mi>x</mi>
    <mo>)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>f</ci>
    <ci>x</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f\left(x\right)\,\!
  </annotation>
 </semantics>
</math>

</p>

<p>We give each participant a different single point (both 

<math display="inline" id="Shamir's_Secret_Sharing:36">
 <semantics>
  <msub>
   <mi>D</mi>
   <mrow>
    <mi>x</mi>
    <mo>-</mo>
    <mn>1</mn>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>D</ci>
    <apply>
     <minus></minus>
     <ci>x</ci>
     <cn type="integer">1</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   D_{x-1}
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Shamir's_Secret_Sharing:37">
 <semantics>
  <msub>
   <mi>D</mi>
   <mi>x</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>D</ci>
    <ci>x</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   D_{x}
  </annotation>
 </semantics>
</math>

). Because we use 

<math display="inline" id="Shamir's_Secret_Sharing:38">
 <semantics>
  <mrow>
   <mo stretchy="false">(</mo>
   <mn>1</mn>
   <mo>,</mo>
   <mrow>
    <mi>f</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mn>1</mn>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo stretchy="false">)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <interval closure="open">
    <cn type="integer">1</cn>
    <apply>
     <times></times>
     <ci>f</ci>
     <cn type="integer">1</cn>
    </apply>
   </interval>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (1,f(1))
  </annotation>
 </semantics>
</math>


 instead of 

<math display="inline" id="Shamir's_Secret_Sharing:39">
 <semantics>
  <mrow>
   <mo stretchy="false">(</mo>
   <mn>0</mn>
   <mo>,</mo>
   <mrow>
    <mi>f</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mn>0</mn>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo stretchy="false">)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <interval closure="open">
    <cn type="integer">0</cn>
    <apply>
     <times></times>
     <ci>f</ci>
     <cn type="integer">0</cn>
    </apply>
   </interval>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (0,f(0))
  </annotation>
 </semantics>
</math>

 the points start from 

<math display="inline" id="Shamir's_Secret_Sharing:40">
 <semantics>
  <mrow>
   <mo stretchy="false">(</mo>
   <mn>0</mn>
   <mo>,</mo>
   <mrow>
    <mi>f</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mn>0</mn>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo stretchy="false">)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <interval closure="open">
    <cn type="integer">0</cn>
    <apply>
     <times></times>
     <ci>f</ci>
     <cn type="integer">0</cn>
    </apply>
   </interval>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (0,f(0))
  </annotation>
 </semantics>
</math>

 and not 

<math display="inline" id="Shamir's_Secret_Sharing:41">
 <semantics>
  <mrow>
   <mi>S</mi>
   <mo>=</mo>
   <mrow>
    <mi>f</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mn>0</mn>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>S</ci>
    <apply>
     <times></times>
     <ci>f</ci>
     <cn type="integer">0</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   S=f(0)
  </annotation>
 </semantics>
</math>

. This is necessary because if one would have 

<math display="inline" id="Shamir's_Secret_Sharing:42">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mo>(</mo>
     <msub>
      <mi>x</mi>
      <mn>0</mn>
     </msub>
     <mo>,</mo>
     <msub>
      <mi>y</mi>
      <mn>0</mn>
     </msub>
     <mo>)</mo>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mo>(</mo>
     <mn>2</mn>
     <mo>,</mo>
     <mn>1942</mn>
     <mo>)</mo>
    </mrow>
   </mrow>
   <mo>;</mo>
   <mrow>
    <mrow>
     <mrow>
      <mo>(</mo>
      <msub>
       <mi>x</mi>
       <mn>1</mn>
      </msub>
      <mo>,</mo>
      <msub>
       <mi>y</mi>
       <mn>1</mn>
      </msub>
      <mo>)</mo>
     </mrow>
     <mo>=</mo>
     <mrow>
      <mo>(</mo>
      <mn>4</mn>
      <mo>,</mo>
      <mn>3402</mn>
      <mo>)</mo>
     </mrow>
    </mrow>
    <mo>;</mo>
    <mrow>
     <mrow>
      <mo>(</mo>
      <msub>
       <mi>x</mi>
       <mn>2</mn>
      </msub>
      <mo>,</mo>
      <msub>
       <mi>y</mi>
       <mn>2</mn>
      </msub>
      <mo>)</mo>
     </mrow>
     <mo>=</mo>
     <mrow>
      <mo>(</mo>
      <mn>5</mn>
      <mo>,</mo>
      <mn>4414</mn>
      <mo>)</mo>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <eq></eq>
     <interval closure="open">
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <cn type="integer">0</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>y</ci>
       <cn type="integer">0</cn>
      </apply>
     </interval>
     <interval closure="open">
      <cn type="integer">2</cn>
      <cn type="integer">1942</cn>
     </interval>
    </apply>
    <apply>
     <csymbol cd="ambiguous">formulae-sequence</csymbol>
     <apply>
      <eq></eq>
      <interval closure="open">
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <cn type="integer">1</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>y</ci>
        <cn type="integer">1</cn>
       </apply>
      </interval>
      <interval closure="open">
       <cn type="integer">4</cn>
       <cn type="integer">3402</cn>
      </interval>
     </apply>
     <apply>
      <eq></eq>
      <interval closure="open">
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>y</ci>
        <cn type="integer">2</cn>
       </apply>
      </interval>
      <interval closure="open">
       <cn type="integer">5</cn>
       <cn type="integer">4414</cn>
      </interval>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \left(x_{0},y_{0}\right)=\left(2,1942\right);\left(x_{1},y_{1}\right)=\left(4,%
3402\right);\left(x_{2},y_{2}\right)=\left(5,4414\right)\,\!
  </annotation>
 </semantics>
</math>

 he would also know the secret (

<math display="inline" id="Shamir's_Secret_Sharing:43">
 <semantics>
  <mrow>
   <msub>
    <mi mathvariant="normal">ℓ</mi>
    <mn>0</mn>
   </msub>
   <mo>=</mo>
   <mrow>
    <mfrac>
     <mrow>
      <mi>x</mi>
      <mo>-</mo>
      <msub>
       <mi>x</mi>
       <mn>1</mn>
      </msub>
     </mrow>
     <mrow>
      <msub>
       <mi>x</mi>
       <mn>0</mn>
      </msub>
      <mo>-</mo>
      <msub>
       <mi>x</mi>
       <mn>1</mn>
      </msub>
     </mrow>
    </mfrac>
    <mo>⋅</mo>
    <mfrac>
     <mrow>
      <mi>x</mi>
      <mo>-</mo>
      <msub>
       <mi>x</mi>
       <mn>2</mn>
      </msub>
     </mrow>
     <mrow>
      <msub>
       <mi>x</mi>
       <mn>0</mn>
      </msub>
      <mo>-</mo>
      <msub>
       <mi>x</mi>
       <mn>2</mn>
      </msub>
     </mrow>
    </mfrac>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mfrac>
     <mrow>
      <mi>x</mi>
      <mo>-</mo>
      <mn>4</mn>
     </mrow>
     <mrow>
      <mn>2</mn>
      <mo>-</mo>
      <mn>4</mn>
     </mrow>
    </mfrac>
    <mo>⋅</mo>
    <mfrac>
     <mrow>
      <mi>x</mi>
      <mo>-</mo>
      <mn>5</mn>
     </mrow>
     <mrow>
      <mn>2</mn>
      <mo>-</mo>
      <mn>5</mn>
     </mrow>
    </mfrac>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mrow>
      <mfrac>
       <mn>1</mn>
       <mn>6</mn>
      </mfrac>
      <msup>
       <mi>x</mi>
       <mn>2</mn>
      </msup>
     </mrow>
     <mo>-</mo>
     <mrow>
      <mfrac>
       <mn>3</mn>
       <mn>2</mn>
      </mfrac>
      <mi>x</mi>
     </mrow>
    </mrow>
    <mo>+</mo>
    <mfrac>
     <mn>10</mn>
     <mn>3</mn>
    </mfrac>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>normal-ℓ</ci>
      <cn type="integer">0</cn>
     </apply>
     <apply>
      <ci>normal-⋅</ci>
      <apply>
       <divide></divide>
       <apply>
        <minus></minus>
        <ci>x</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>x</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <apply>
        <minus></minus>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>x</ci>
         <cn type="integer">0</cn>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>x</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
      </apply>
      <apply>
       <divide></divide>
       <apply>
        <minus></minus>
        <ci>x</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>x</ci>
         <cn type="integer">2</cn>
        </apply>
       </apply>
       <apply>
        <minus></minus>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>x</ci>
         <cn type="integer">0</cn>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>x</ci>
         <cn type="integer">2</cn>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <ci>normal-⋅</ci>
      <apply>
       <divide></divide>
       <apply>
        <minus></minus>
        <ci>x</ci>
        <cn type="integer">4</cn>
       </apply>
       <apply>
        <minus></minus>
        <cn type="integer">2</cn>
        <cn type="integer">4</cn>
       </apply>
      </apply>
      <apply>
       <divide></divide>
       <apply>
        <minus></minus>
        <ci>x</ci>
        <cn type="integer">5</cn>
       </apply>
       <apply>
        <minus></minus>
        <cn type="integer">2</cn>
        <cn type="integer">5</cn>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <plus></plus>
      <apply>
       <minus></minus>
       <apply>
        <times></times>
        <apply>
         <divide></divide>
         <cn type="integer">1</cn>
         <cn type="integer">6</cn>
        </apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>x</ci>
         <cn type="integer">2</cn>
        </apply>
       </apply>
       <apply>
        <times></times>
        <apply>
         <divide></divide>
         <cn type="integer">3</cn>
         <cn type="integer">2</cn>
        </apply>
        <ci>x</ci>
       </apply>
      </apply>
      <apply>
       <divide></divide>
       <cn type="integer">10</cn>
       <cn type="integer">3</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \ell_{0}=\frac{x-x_{1}}{x_{0}-x_{1}}\cdot\frac{x-x_{2}}{x_{0}-x_{2}}=\frac{x-4%
}{2-4}\cdot\frac{x-5}{2-5}=\frac{1}{6}x^{2}-\frac{3}{2}x+\frac{10}{3}\,\!
  </annotation>
 </semantics>
</math>


)</p>
<h4 id="reconstruction">Reconstruction</h4>

<p>In order to reconstruct the secret any 3 points will be enough.</p>

<p>Let us consider 

<math display="inline" id="Shamir's_Secret_Sharing:44">
 <semantics>
  <mrow>
   <msub>
    <mi mathvariant="normal">ℓ</mi>
    <mn>1</mn>
   </msub>
   <mo>=</mo>
   <mrow>
    <mfrac>
     <mrow>
      <mi>x</mi>
      <mo>-</mo>
      <msub>
       <mi>x</mi>
       <mn>0</mn>
      </msub>
     </mrow>
     <mrow>
      <msub>
       <mi>x</mi>
       <mn>1</mn>
      </msub>
      <mo>-</mo>
      <msub>
       <mi>x</mi>
       <mn>0</mn>
      </msub>
     </mrow>
    </mfrac>
    <mo>⋅</mo>
    <mfrac>
     <mrow>
      <mi>x</mi>
      <mo>-</mo>
      <msub>
       <mi>x</mi>
       <mn>2</mn>
      </msub>
     </mrow>
     <mrow>
      <msub>
       <mi>x</mi>
       <mn>1</mn>
      </msub>
      <mo>-</mo>
      <msub>
       <mi>x</mi>
       <mn>2</mn>
      </msub>
     </mrow>
    </mfrac>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mfrac>
     <mrow>
      <mi>x</mi>
      <mo>-</mo>
      <mn>2</mn>
     </mrow>
     <mrow>
      <mn>4</mn>
      <mo>-</mo>
      <mn>2</mn>
     </mrow>
    </mfrac>
    <mo>⋅</mo>
    <mfrac>
     <mrow>
      <mi>x</mi>
      <mo>-</mo>
      <mn>5</mn>
     </mrow>
     <mrow>
      <mn>4</mn>
      <mo>-</mo>
      <mn>5</mn>
     </mrow>
    </mfrac>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mrow>
      <mo>-</mo>
      <mrow>
       <mfrac>
        <mn>1</mn>
        <mn>2</mn>
       </mfrac>
       <msup>
        <mi>x</mi>
        <mn>2</mn>
       </msup>
      </mrow>
     </mrow>
     <mo>+</mo>
     <mrow>
      <mfrac>
       <mn>7</mn>
       <mn>2</mn>
      </mfrac>
      <mi>x</mi>
     </mrow>
    </mrow>
    <mo>-</mo>
    <mn>5</mn>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>normal-ℓ</ci>
      <cn type="integer">1</cn>
     </apply>
     <apply>
      <ci>normal-⋅</ci>
      <apply>
       <divide></divide>
       <apply>
        <minus></minus>
        <ci>x</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>x</ci>
         <cn type="integer">0</cn>
        </apply>
       </apply>
       <apply>
        <minus></minus>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>x</ci>
         <cn type="integer">1</cn>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>x</ci>
         <cn type="integer">0</cn>
        </apply>
       </apply>
      </apply>
      <apply>
       <divide></divide>
       <apply>
        <minus></minus>
        <ci>x</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>x</ci>
         <cn type="integer">2</cn>
        </apply>
       </apply>
       <apply>
        <minus></minus>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>x</ci>
         <cn type="integer">1</cn>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>x</ci>
         <cn type="integer">2</cn>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <ci>normal-⋅</ci>
      <apply>
       <divide></divide>
       <apply>
        <minus></minus>
        <ci>x</ci>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <minus></minus>
        <cn type="integer">4</cn>
        <cn type="integer">2</cn>
       </apply>
      </apply>
      <apply>
       <divide></divide>
       <apply>
        <minus></minus>
        <ci>x</ci>
        <cn type="integer">5</cn>
       </apply>
       <apply>
        <minus></minus>
        <cn type="integer">4</cn>
        <cn type="integer">5</cn>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <minus></minus>
      <apply>
       <plus></plus>
       <apply>
        <minus></minus>
        <apply>
         <times></times>
         <apply>
          <divide></divide>
          <cn type="integer">1</cn>
          <cn type="integer">2</cn>
         </apply>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>x</ci>
          <cn type="integer">2</cn>
         </apply>
        </apply>
       </apply>
       <apply>
        <times></times>
        <apply>
         <divide></divide>
         <cn type="integer">7</cn>
         <cn type="integer">2</cn>
        </apply>
        <ci>x</ci>
       </apply>
      </apply>
      <cn type="integer">5</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \ell_{1}=\frac{x-x_{0}}{x_{1}-x_{0}}\cdot\frac{x-x_{2}}{x_{1}-x_{2}}=\frac{x-2%
}{4-2}\cdot\frac{x-5}{4-5}=-\frac{1}{2}x^{2}+\frac{7}{2}x-5\,\!
  </annotation>
 </semantics>
</math>

.</p>

<p>We will compute <a href="Lagrange_polynomial" title="wikilink">Lagrange basis polynomials</a>:</p>

<p>

<math display="inline" id="Shamir's_Secret_Sharing:45">
 <semantics>
  <mrow>
   <msub>
    <mi mathvariant="normal">ℓ</mi>
    <mn>2</mn>
   </msub>
   <mo>=</mo>
   <mrow>
    <mfrac>
     <mrow>
      <mi>x</mi>
      <mo>-</mo>
      <msub>
       <mi>x</mi>
       <mn>0</mn>
      </msub>
     </mrow>
     <mrow>
      <msub>
       <mi>x</mi>
       <mn>2</mn>
      </msub>
      <mo>-</mo>
      <msub>
       <mi>x</mi>
       <mn>0</mn>
      </msub>
     </mrow>
    </mfrac>
    <mo>⋅</mo>
    <mfrac>
     <mrow>
      <mi>x</mi>
      <mo>-</mo>
      <msub>
       <mi>x</mi>
       <mn>1</mn>
      </msub>
     </mrow>
     <mrow>
      <msub>
       <mi>x</mi>
       <mn>2</mn>
      </msub>
      <mo>-</mo>
      <msub>
       <mi>x</mi>
       <mn>1</mn>
      </msub>
     </mrow>
    </mfrac>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mfrac>
     <mrow>
      <mi>x</mi>
      <mo>-</mo>
      <mn>2</mn>
     </mrow>
     <mrow>
      <mn>5</mn>
      <mo>-</mo>
      <mn>2</mn>
     </mrow>
    </mfrac>
    <mo>⋅</mo>
    <mfrac>
     <mrow>
      <mi>x</mi>
      <mo>-</mo>
      <mn>4</mn>
     </mrow>
     <mrow>
      <mn>5</mn>
      <mo>-</mo>
      <mn>4</mn>
     </mrow>
    </mfrac>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mrow>
      <mfrac>
       <mn>1</mn>
       <mn>3</mn>
      </mfrac>
      <msup>
       <mi>x</mi>
       <mn>2</mn>
      </msup>
     </mrow>
     <mo>-</mo>
     <mrow>
      <mn>2</mn>
      <mi>x</mi>
     </mrow>
    </mrow>
    <mo>+</mo>
    <mfrac>
     <mn>8</mn>
     <mn>3</mn>
    </mfrac>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>normal-ℓ</ci>
      <cn type="integer">2</cn>
     </apply>
     <apply>
      <ci>normal-⋅</ci>
      <apply>
       <divide></divide>
       <apply>
        <minus></minus>
        <ci>x</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>x</ci>
         <cn type="integer">0</cn>
        </apply>
       </apply>
       <apply>
        <minus></minus>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>x</ci>
         <cn type="integer">2</cn>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>x</ci>
         <cn type="integer">0</cn>
        </apply>
       </apply>
      </apply>
      <apply>
       <divide></divide>
       <apply>
        <minus></minus>
        <ci>x</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>x</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <apply>
        <minus></minus>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>x</ci>
         <cn type="integer">2</cn>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>x</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <ci>normal-⋅</ci>
      <apply>
       <divide></divide>
       <apply>
        <minus></minus>
        <ci>x</ci>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <minus></minus>
        <cn type="integer">5</cn>
        <cn type="integer">2</cn>
       </apply>
      </apply>
      <apply>
       <divide></divide>
       <apply>
        <minus></minus>
        <ci>x</ci>
        <cn type="integer">4</cn>
       </apply>
       <apply>
        <minus></minus>
        <cn type="integer">5</cn>
        <cn type="integer">4</cn>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <plus></plus>
      <apply>
       <minus></minus>
       <apply>
        <times></times>
        <apply>
         <divide></divide>
         <cn type="integer">1</cn>
         <cn type="integer">3</cn>
        </apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>x</ci>
         <cn type="integer">2</cn>
        </apply>
       </apply>
       <apply>
        <times></times>
        <cn type="integer">2</cn>
        <ci>x</ci>
       </apply>
      </apply>
      <apply>
       <divide></divide>
       <cn type="integer">8</cn>
       <cn type="integer">3</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \ell_{2}=\frac{x-x_{0}}{x_{2}-x_{0}}\cdot\frac{x-x_{1}}{x_{2}-x_{1}}=\frac{x-2%
}{5-2}\cdot\frac{x-4}{5-4}=\frac{1}{3}x^{2}-2x+\frac{8}{3}\,\!
  </annotation>
 </semantics>
</math>

 

<math display="inline" id="Shamir's_Secret_Sharing:46">
 <semantics>
  <mrow>
   <mrow>
    <mi>f</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>x</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <msubsup>
     <mo largeop="true" symmetric="true">∑</mo>
     <mrow>
      <mi>j</mi>
      <mo>=</mo>
      <mn>0</mn>
     </mrow>
     <mn>2</mn>
    </msubsup>
    <mrow>
     <mrow>
      <msub>
       <mi>y</mi>
       <mi>j</mi>
      </msub>
      <mo>⋅</mo>
      <msub>
       <mi mathvariant="normal">ℓ</mi>
       <mi>j</mi>
      </msub>
     </mrow>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>x</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>f</ci>
     <ci>x</ci>
    </apply>
    <apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <apply>
        <eq></eq>
        <ci>j</ci>
        <cn type="integer">0</cn>
       </apply>
      </apply>
      <cn type="integer">2</cn>
     </apply>
     <apply>
      <times></times>
      <apply>
       <ci>normal-⋅</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>y</ci>
        <ci>j</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>normal-ℓ</ci>
        <ci>j</ci>
       </apply>
      </apply>
      <ci>x</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f(x)=\sum_{j=0}^{2}y_{j}\cdot\ell_{j}(x)\,\!
  </annotation>
 </semantics>
</math>

 

<math display="inline" id="Shamir's_Secret_Sharing:47">
 <semantics>
  <mrow>
   <mi></mi>
   <mo>=</mo>
   <mrow>
    <mn>1234</mn>
    <mo>+</mo>
    <mrow>
     <mn>166</mn>
     <mi>x</mi>
    </mrow>
    <mo>+</mo>
    <mrow>
     <mn>94</mn>
     <msup>
      <mi>x</mi>
      <mn>2</mn>
     </msup>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <csymbol cd="latexml">absent</csymbol>
    <apply>
     <plus></plus>
     <cn type="integer">1234</cn>
     <apply>
      <times></times>
      <cn type="integer">166</cn>
      <ci>x</ci>
     </apply>
     <apply>
      <times></times>
      <cn type="integer">94</cn>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>x</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   =1234+166x+94x^{2}\,\!
  </annotation>
 </semantics>
</math>

</p>

<p>Therefore</p>

<p>

<math display="inline" id="Shamir's_Secret_Sharing:48">
 <semantics>
  <mrow>
   <mi>S</mi>
   <mo>=</mo>
   <mn>1234</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>S</ci>
    <cn type="integer">1234</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   S=1234\,\!
  </annotation>
 </semantics>
</math>


 

<math display="inline" id="Shamir's_Secret_Sharing:49">
 <semantics>
  <mi>S</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>S</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   S
  </annotation>
 </semantics>
</math>

</p>

<p>Recall that the secret is the free coefficient, which means that 

<math display="inline" id="Shamir's_Secret_Sharing:50">
 <semantics>
  <msub>
   <mi>D</mi>
   <mi>i</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>D</ci>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   D_{i}
  </annotation>
 </semantics>
</math>

, and we are done.</p>
<h5 id="problem">Problem</h5>

<p>Although this method works fine, there is a security problem: Eve wins a lot of information about 

<math display="inline" id="Shamir's_Secret_Sharing:51">
 <semantics>
  <mrow>
   <msub>
    <mi>D</mi>
    <mn>0</mn>
   </msub>
   <mo>=</mo>
   <mrow>
    <mo stretchy="false">(</mo>
    <mn>1</mn>
    <mo>,</mo>
    <mn>1494</mn>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>D</ci>
     <cn type="integer">0</cn>
    </apply>
    <interval closure="open">
     <cn type="integer">1</cn>
     <cn type="integer">1494</cn>
    </interval>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   D_{0}=(1,1494)
  </annotation>
 </semantics>
</math>

 with every 

<math display="inline" id="Shamir's_Secret_Sharing:52">
 <semantics>
  <mrow>
   <msub>
    <mi>D</mi>
    <mn>1</mn>
   </msub>
   <mo>=</mo>
   <mrow>
    <mo stretchy="false">(</mo>
    <mn>2</mn>
    <mo>,</mo>
    <mn>1942</mn>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>D</ci>
     <cn type="integer">1</cn>
    </apply>
    <interval closure="open">
     <cn type="integer">2</cn>
     <cn type="integer">1942</cn>
    </interval>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   D_{1}=(2,1942)
  </annotation>
 </semantics>
</math>

 that she finds.</p>

<p>Suppose that she finds the 2 points 

<math display="inline" id="Shamir's_Secret_Sharing:53">
 <semantics>
  <mrow>
   <mi>k</mi>
   <mo>=</mo>
   <mn>3</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>k</ci>
    <cn type="integer">3</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   k=3
  </annotation>
 </semantics>
</math>


 and 

<math display="inline" id="Shamir's_Secret_Sharing:54">
 <semantics>
  <mi>S</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>S</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   S
  </annotation>
 </semantics>
</math>

, she still doesn't have 

<math display="block" id="Shamir's_Secret_Sharing:55">
 <semantics>
  <mrow>
   <mrow>
    <mi>n</mi>
    <mo>=</mo>
    <mn>6</mn>
   </mrow>
   <mo>,</mo>
   <mrow>
    <mrow>
     <mi>k</mi>
     <mo>=</mo>
     <mn>3</mn>
    </mrow>
    <mo>,</mo>
    <mrow>
     <mrow>
      <mrow>
       <mi>f</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>x</mi>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
      <mo>=</mo>
      <mrow>
       <msub>
        <mi>a</mi>
        <mn>0</mn>
       </msub>
       <mo>+</mo>
       <mrow>
        <msub>
         <mi>a</mi>
         <mn>1</mn>
        </msub>
        <mi>x</mi>
       </mrow>
       <mo>+</mo>
       <mi mathvariant="normal">…</mi>
       <mo>+</mo>
       <mrow>
        <msub>
         <mi>a</mi>
         <mrow>
          <mi>k</mi>
          <mo>-</mo>
          <mn>1</mn>
         </mrow>
        </msub>
        <msup>
         <mi>x</mi>
         <mrow>
          <mi>k</mi>
          <mo>-</mo>
          <mn>1</mn>
         </mrow>
        </msup>
       </mrow>
      </mrow>
     </mrow>
     <mo>,</mo>
     <mrow>
      <mrow>
       <msub>
        <mi>a</mi>
        <mn>0</mn>
       </msub>
       <mo>=</mo>
       <mi>S</mi>
      </mrow>
      <mo>,</mo>
      <mrow>
       <msub>
        <mi>a</mi>
        <mi>i</mi>
       </msub>
       <mo>∈</mo>
       <mi>ℕ</mi>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <eq></eq>
     <ci>n</ci>
     <cn type="integer">6</cn>
    </apply>
    <apply>
     <csymbol cd="ambiguous">formulae-sequence</csymbol>
     <apply>
      <eq></eq>
      <ci>k</ci>
      <cn type="integer">3</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">formulae-sequence</csymbol>
      <apply>
       <eq></eq>
       <apply>
        <times></times>
        <ci>f</ci>
        <ci>x</ci>
       </apply>
       <apply>
        <plus></plus>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>a</ci>
         <cn type="integer">0</cn>
        </apply>
        <apply>
         <times></times>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>a</ci>
          <cn type="integer">1</cn>
         </apply>
         <ci>x</ci>
        </apply>
        <ci>normal-…</ci>
        <apply>
         <times></times>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>a</ci>
          <apply>
           <minus></minus>
           <ci>k</ci>
           <cn type="integer">1</cn>
          </apply>
         </apply>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>x</ci>
          <apply>
           <minus></minus>
           <ci>k</ci>
           <cn type="integer">1</cn>
          </apply>
         </apply>
        </apply>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">formulae-sequence</csymbol>
       <apply>
        <eq></eq>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>a</ci>
         <cn type="integer">0</cn>
        </apply>
        <ci>S</ci>
       </apply>
       <apply>
        <in></in>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>a</ci>
         <ci>i</ci>
        </apply>
        <ci>ℕ</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n=6,k=3,f(x)=a_{0}+a_{1}x+\dots+a_{k-1}x^{k-1},a_{0}=S,a_{i}\in\mathbb{N}
  </annotation>
 </semantics>
</math>

 points so in theory she shouldn't have won anymore info about 

<math display="inline" id="Shamir's_Secret_Sharing:56">
 <semantics>
  <mrow>
   <mi>S</mi>
   <mo>∈</mo>
   <mrow>
    <mo stretchy="false">[</mo>
    <mn>1046</mn>
    <mo>,</mo>
    <mn>1048</mn>
    <mo>,</mo>
    <mi mathvariant="normal">…</mi>
    <mo>,</mo>
    <mn>1342</mn>
    <mo>,</mo>
    <mn>1344</mn>
    <mo stretchy="false">]</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <in></in>
    <ci>S</ci>
    <list>
     <cn type="integer">1046</cn>
     <cn type="integer">1048</cn>
     <ci>normal-…</ci>
     <cn type="integer">1342</cn>
     <cn type="integer">1344</cn>
    </list>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   S\in[1046,1048,\dots,1342,1344]
  </annotation>
 </semantics>
</math>

. But she combines the info from the 2 points with the public info

<math display="inline" id="Shamir's_Secret_Sharing:57">
 <semantics>
  <mrow>
   <mrow>
    <mi>p</mi>
    <mo>∈</mo>
    <mi>ℙ</mi>
   </mrow>
   <mo>:</mo>
   <mrow>
    <mrow>
     <mi>p</mi>
     <mo>></mo>
     <mi>S</mi>
    </mrow>
    <mo>,</mo>
    <mrow>
     <mi>p</mi>
     <mo>></mo>
     <mi>n</mi>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-:</ci>
    <apply>
     <in></in>
     <ci>p</ci>
     <ci>ℙ</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">formulae-sequence</csymbol>
     <apply>
      <gt></gt>
      <ci>p</ci>
      <ci>S</ci>
     </apply>
     <apply>
      <gt></gt>
      <ci>p</ci>
      <ci>n</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p\in\mathbb{P}:p>S,p>n
  </annotation>
 </semantics>
</math>

 and she :  

<math display="inline" id="Shamir's_Secret_Sharing:58">
 <semantics>
  <mi>p</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>p</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p
  </annotation>
 </semantics>
</math>


. She now only has 150 numbers to guess from instead of an infinite number of natural numbers.</p>
<h4 id="solution">Solution</h4>

<p>This problem can be fixed by using finite field arithmetic in a field of size 

<math display="inline" id="Shamir's_Secret_Sharing:59">
 <semantics>
  <msub>
   <mi>a</mi>
   <mi>i</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>a</ci>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a_{i}
  </annotation>
 </semantics>
</math>

.</p>

<p>This is in practice only a small change, it just means that we should choose a prime 

<math display="inline" id="Shamir's_Secret_Sharing:60">
 <semantics>
  <mrow>
   <msub>
    <mi>a</mi>
    <mn>0</mn>
   </msub>
   <mo>=</mo>
   <mi>S</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>a</ci>
     <cn type="integer">0</cn>
    </apply>
    <ci>S</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a_{0}=S
  </annotation>
 </semantics>
</math>

 that is bigger than the number of participants and every 

<math display="inline" id="Shamir's_Secret_Sharing:61">
 <semantics>
  <mrow>
   <mo stretchy="false">(</mo>
   <mi>x</mi>
   <mo>,</mo>
   <mrow>
    <mrow>
     <mi>f</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>x</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mspace width="veryverythickmathspace">
    </mspace>
    <mrow>
     <mo lspace="8.1pt" stretchy="false">(</mo>
     <mrow>
      <mo>mod</mo>
      <mi>p</mi>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo stretchy="false">)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <interval closure="open">
    <ci>x</ci>
    <apply>
     <csymbol cd="latexml">annotated</csymbol>
     <apply>
      <times></times>
      <ci>f</ci>
      <ci>x</ci>
     </apply>
     <apply>
      <ci>pmod</ci>
      <ci>p</ci>
     </apply>
    </apply>
   </interval>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (x,f(x)\;\;(\mathop{{\rm mod}}p))
  </annotation>
 </semantics>
</math>

 (including 

<math display="inline" id="Shamir's_Secret_Sharing:62">
 <semantics>
  <mrow>
   <mo stretchy="false">(</mo>
   <mi>x</mi>
   <mo>,</mo>
   <mrow>
    <mi>f</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>x</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo stretchy="false">)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <interval closure="open">
    <ci>x</ci>
    <apply>
     <times></times>
     <ci>f</ci>
     <ci>x</ci>
    </apply>
   </interval>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (x,f(x))
  </annotation>
 </semantics>
</math>

) and we have to calculate the points as 

<math display="inline" id="Shamir's_Secret_Sharing:63">
 <semantics>
  <mi>p</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>p</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p
  </annotation>
 </semantics>
</math>


 instead of 

<math display="inline" id="Shamir's_Secret_Sharing:64">
 <semantics>
  <mi>p</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>p</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p
  </annotation>
 </semantics>
</math>

.</p>

<p>Since everyone who receives a point also has to know the value of 

<math display="inline" id="Shamir's_Secret_Sharing:65">
 <semantics>
  <mi>p</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>p</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p
  </annotation>
 </semantics>
</math>

 so it may be considered to be publicly known. Therefore, one should select a value for 

<math display="inline" id="Shamir's_Secret_Sharing:66">
 <semantics>
  <mrow>
   <mi>p</mi>
   <mo>></mo>
   <mi>S</mi>
   <mo>⇒</mo>
   <mi>S</mi>
   <mo>∈</mo>
   <mrow>
    <mo stretchy="false">[</mo>
    <mn>0</mn>
    <mo>,</mo>
    <mn>1</mn>
    <mo>,</mo>
    <mi mathvariant="normal">…</mi>
    <mo>,</mo>
    <mrow>
     <mi>p</mi>
     <mo>-</mo>
     <mn>2</mn>
    </mrow>
    <mo>,</mo>
    <mrow>
     <mi>p</mi>
     <mo>-</mo>
     <mn>1</mn>
    </mrow>
    <mo stretchy="false">]</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <gt></gt>
     <ci>p</ci>
     <ci>S</ci>
    </apply>
    <apply>
     <ci>normal-⇒</ci>
     <share href="#.cmml">
     </share>
     <ci>S</ci>
    </apply>
    <apply>
     <in></in>
     <share href="#.cmml">
     </share>
     <list>
      <cn type="integer">0</cn>
      <cn type="integer">1</cn>
      <ci>normal-…</ci>
      <apply>
       <minus></minus>
       <ci>p</ci>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <minus></minus>
       <ci>p</ci>
       <cn type="integer">1</cn>
      </apply>
     </list>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p>S\Rightarrow{}S\in{[0,1,\dots,p-2,p-1]}
  </annotation>
 </semantics>
</math>

 that is neither too low nor too high.</p>

<p>Low values of 

<math display="inline" id="Shamir's_Secret_Sharing:67">
 <semantics>
  <mi>p</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>p</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p
  </annotation>
 </semantics>
</math>

 are risky because Eve knows 

<math display="inline" id="Shamir's_Secret_Sharing:68">
 <semantics>
  <mi>S</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>S</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   S
  </annotation>
 </semantics>
</math>


, so the lower one sets 

<math display="inline" id="Shamir's_Secret_Sharing:69">
 <semantics>
  <mi>p</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>p</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p
  </annotation>
 </semantics>
</math>

, the lower the number of possible values Eve has to guess from to get 

<math display="inline" id="Shamir's_Secret_Sharing:70">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>f</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>x</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mspace width="veryverythickmathspace">
    </mspace>
    <mrow>
     <mo lspace="8.1pt" stretchy="false">(</mo>
     <mrow>
      <mo>mod</mo>
      <mi>p</mi>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mi>f</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>x</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="latexml">annotated</csymbol>
     <apply>
      <times></times>
      <ci>f</ci>
      <ci>x</ci>
     </apply>
     <apply>
      <ci>pmod</ci>
      <ci>p</ci>
     </apply>
    </apply>
    <apply>
     <times></times>
     <ci>f</ci>
     <ci>x</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f(x)\;\;(\mathop{{\rm mod}}p)=f(x)
  </annotation>
 </semantics>
</math>

.</p>

<p>High values of 

<math display="inline" id="Shamir's_Secret_Sharing:71">
 <semantics>
  <mi>p</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>p</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p
  </annotation>
 </semantics>
</math>

 are risky because Eve knows that the chance for 

<math display="inline" id="Shamir's_Secret_Sharing:72">
 <semantics>
  <mi>S</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>S</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   S
  </annotation>
 </semantics>
</math>

 increases with a higher 

<math display="inline" id="Shamir's_Secret_Sharing:73">
 <semantics>
  <mrow>
   <mi>p</mi>
   <mo>=</mo>
   <mn>1613</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>p</ci>
    <cn type="integer">1613</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p=1613
  </annotation>
 </semantics>
</math>


, and she can use the procedure from the original problem to guess 

<math display="inline" id="Shamir's_Secret_Sharing:74">
 <semantics>
  <mrow>
   <mrow>
    <mi>f</mi>
    <mrow>
     <mo>(</mo>
     <mi>x</mi>
     <mo>)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mn>1234</mn>
     <mo>+</mo>
     <mrow>
      <mn>166</mn>
      <mi>x</mi>
     </mrow>
     <mo>+</mo>
     <mrow>
      <mn>94</mn>
      <msup>
       <mi>x</mi>
       <mn>2</mn>
      </msup>
     </mrow>
    </mrow>
    <mo lspace="2.5pt" rspace="2.5pt">mod</mo>
    <mn>1613</mn>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>f</ci>
     <ci>x</ci>
    </apply>
    <apply>
     <csymbol cd="latexml">modulo</csymbol>
     <apply>
      <plus></plus>
      <cn type="integer">1234</cn>
      <apply>
       <times></times>
       <cn type="integer">166</cn>
       <ci>x</ci>
      </apply>
      <apply>
       <times></times>
       <cn type="integer">94</cn>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>x</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
     </apply>
     <cn type="integer">1613</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f\left(x\right)=1234+166x+94x^{2}\mod{1613}
  </annotation>
 </semantics>
</math>

 (although now, instead of being sure of the 150 possible values, they merely have an increased chance of being valid compared to the other natural numbers).</p>

<p>For this example we choose 

<math display="block" id="Shamir's_Secret_Sharing:75">
 <semantics>
  <mrow>
   <mrow>
    <mo>(</mo>
    <mn>1</mn>
    <mo>,</mo>
    <mn>1494</mn>
    <mo>)</mo>
   </mrow>
   <mo>;</mo>
   <mrow>
    <mo>(</mo>
    <mn>2</mn>
    <mo>,</mo>
    <mn>329</mn>
    <mo>)</mo>
   </mrow>
   <mo>;</mo>
   <mrow>
    <mo>(</mo>
    <mn>3</mn>
    <mo>,</mo>
    <mn>965</mn>
    <mo>)</mo>
   </mrow>
   <mo>;</mo>
   <mrow>
    <mo>(</mo>
    <mn>4</mn>
    <mo>,</mo>
    <mn>176</mn>
    <mo>)</mo>
   </mrow>
   <mo>;</mo>
   <mrow>
    <mo>(</mo>
    <mn>5</mn>
    <mo>,</mo>
    <mn>1188</mn>
    <mo>)</mo>
   </mrow>
   <mo>;</mo>
   <mrow>
    <mo>(</mo>
    <mn>6</mn>
    <mo>,</mo>
    <mn>775</mn>
    <mo>)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <list>
    <interval closure="open">
     <cn type="integer">1</cn>
     <cn type="integer">1494</cn>
    </interval>
    <interval closure="open">
     <cn type="integer">2</cn>
     <cn type="integer">329</cn>
    </interval>
    <interval closure="open">
     <cn type="integer">3</cn>
     <cn type="integer">965</cn>
    </interval>
    <interval closure="open">
     <cn type="integer">4</cn>
     <cn type="integer">176</cn>
    </interval>
    <interval closure="open">
     <cn type="integer">5</cn>
     <cn type="integer">1188</cn>
    </interval>
    <interval closure="open">
     <cn type="integer">6</cn>
     <cn type="integer">775</cn>
    </interval>
   </list>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \left(1,1494\right);\left(2,329\right);\left(3,965\right);\left(4,176\right);%
\left(5,1188\right);\left(6,775\right)
  </annotation>
 </semantics>
</math>

, so our polynomial becomes 

<math display="inline" id="Shamir's_Secret_Sharing:76">
 <semantics>
  <msub>
   <mi>D</mi>
   <mi>x</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>D</ci>
    <ci>x</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   D_{x}
  </annotation>
 </semantics>
</math>

 which gives the points

<math display="inline" id="Shamir's_Secret_Sharing:77">
 <semantics>
  <mi>k</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>k</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   k
  </annotation>
 </semantics>
</math>

</p>

<p>This time Eve doesn't win any info when she finds a 

<math display="inline" id="Shamir's_Secret_Sharing:78">
 <semantics>
  <mrow>
   <msub>
    <mi>D</mi>
    <mn>0</mn>
   </msub>
   <mo>=</mo>
   <mrow>
    <mo>(</mo>
    <mn>1</mn>
    <mo>,</mo>
    <mn>1494</mn>
    <mo>)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>D</ci>
     <cn type="integer">0</cn>
    </apply>
    <interval closure="open">
     <cn type="integer">1</cn>
     <cn type="integer">1494</cn>
    </interval>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   D_{0}=\left(1,1494\right)
  </annotation>
 </semantics>
</math>


 (until she has 

<math display="inline" id="Shamir's_Secret_Sharing:79">
 <semantics>
  <mrow>
   <msub>
    <mi>D</mi>
    <mn>1</mn>
   </msub>
   <mo>=</mo>
   <mrow>
    <mo>(</mo>
    <mn>2</mn>
    <mo>,</mo>
    <mn>329</mn>
    <mo>)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>D</ci>
     <cn type="integer">1</cn>
    </apply>
    <interval closure="open">
     <cn type="integer">2</cn>
     <cn type="integer">329</cn>
    </interval>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   D_{1}=\left(2,329\right)
  </annotation>
 </semantics>
</math>

 points).</p>

<p>Suppose again Eve again finds 

<math display="block" id="Shamir's_Secret_Sharing:80">
 <semantics>
  <mrow>
   <mrow>
    <mi>n</mi>
    <mo>=</mo>
    <mn>6</mn>
   </mrow>
   <mo>,</mo>
   <mrow>
    <mrow>
     <mi>k</mi>
     <mo>=</mo>
     <mn>3</mn>
    </mrow>
    <mo>,</mo>
    <mrow>
     <mrow>
      <mi>p</mi>
      <mo>=</mo>
      <mn>1613</mn>
     </mrow>
     <mo>,</mo>
     <mrow>
      <mrow>
       <mrow>
        <mi>f</mi>
        <mrow>
         <mo stretchy="false">(</mo>
         <mi>x</mi>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
       <mo>=</mo>
       <mrow>
        <mrow>
         <msub>
          <mi>a</mi>
          <mn>0</mn>
         </msub>
         <mo>+</mo>
         <mrow>
          <msub>
           <mi>a</mi>
           <mn>1</mn>
          </msub>
          <mi>x</mi>
         </mrow>
         <mo>+</mo>
         <mi mathvariant="normal">…</mi>
         <mo>+</mo>
         <mrow>
          <msub>
           <mi>a</mi>
           <mrow>
            <mi>k</mi>
            <mo>-</mo>
            <mn>1</mn>
           </mrow>
          </msub>
          <msup>
           <mi>x</mi>
           <mrow>
            <mi>k</mi>
            <mo>-</mo>
            <mn>1</mn>
           </mrow>
          </msup>
         </mrow>
        </mrow>
        <mo lspace="2.5pt" rspace="2.5pt">mod</mo>
        <mi>p</mi>
       </mrow>
      </mrow>
      <mo>,</mo>
      <mrow>
       <mrow>
        <msub>
         <mi>a</mi>
         <mn>0</mn>
        </msub>
        <mo>=</mo>
        <mi>S</mi>
       </mrow>
       <mo>,</mo>
       <mrow>
        <msub>
         <mi>a</mi>
         <mi>i</mi>
        </msub>
        <mo>∈</mo>
        <mi>ℕ</mi>
       </mrow>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <eq></eq>
     <ci>n</ci>
     <cn type="integer">6</cn>
    </apply>
    <apply>
     <csymbol cd="ambiguous">formulae-sequence</csymbol>
     <apply>
      <eq></eq>
      <ci>k</ci>
      <cn type="integer">3</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">formulae-sequence</csymbol>
      <apply>
       <eq></eq>
       <ci>p</ci>
       <cn type="integer">1613</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">formulae-sequence</csymbol>
       <apply>
        <eq></eq>
        <apply>
         <times></times>
         <ci>f</ci>
         <ci>x</ci>
        </apply>
        <apply>
         <csymbol cd="latexml">modulo</csymbol>
         <apply>
          <plus></plus>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>a</ci>
           <cn type="integer">0</cn>
          </apply>
          <apply>
           <times></times>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <ci>a</ci>
            <cn type="integer">1</cn>
           </apply>
           <ci>x</ci>
          </apply>
          <ci>normal-…</ci>
          <apply>
           <times></times>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <ci>a</ci>
            <apply>
             <minus></minus>
             <ci>k</ci>
             <cn type="integer">1</cn>
            </apply>
           </apply>
           <apply>
            <csymbol cd="ambiguous">superscript</csymbol>
            <ci>x</ci>
            <apply>
             <minus></minus>
             <ci>k</ci>
             <cn type="integer">1</cn>
            </apply>
           </apply>
          </apply>
         </apply>
         <ci>p</ci>
        </apply>
       </apply>
       <apply>
        <csymbol cd="ambiguous">formulae-sequence</csymbol>
        <apply>
         <eq></eq>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>a</ci>
          <cn type="integer">0</cn>
         </apply>
         <ci>S</ci>
        </apply>
        <apply>
         <in></in>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>a</ci>
          <ci>i</ci>
         </apply>
         <ci>ℕ</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n=6,k=3,p=1613,f(x)=a_{0}+a_{1}x+\dots+a_{k-1}x^{k-1}\mod{p},a_{0}=S,a_{i}\in%
\mathbb{N}
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Shamir's_Secret_Sharing:81">
 <semantics>
  <mrow>
   <mo stretchy="false">(</mo>
   <mrow>
    <msub>
     <mi>m</mi>
     <mn>1</mn>
    </msub>
    <mo>-</mo>
    <msub>
     <mi>m</mi>
     <mn>2</mn>
    </msub>
   </mrow>
   <mo stretchy="false">)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <minus></minus>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>m</ci>
     <cn type="integer">1</cn>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>m</ci>
     <cn type="integer">2</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (m_{1}-m_{2})
  </annotation>
 </semantics>
</math>

, this time the public info is

<math display="inline" id="Shamir's_Secret_Sharing:82">
 <semantics>
  <mrow>
   <msub>
    <mi>m</mi>
    <mn>2</mn>
   </msub>
   <mo>></mo>
   <msub>
    <mi>m</mi>
    <mn>1</mn>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <gt></gt>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>m</ci>
     <cn type="integer">2</cn>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>m</ci>
     <cn type="integer">1</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   m_{2}>m_{1}
  </annotation>
 </semantics>
</math>

 so she:  This time she can't stop because 

<math display="inline" id="Shamir's_Secret_Sharing:83">
 <semantics>
  <msub>
   <mi>a</mi>
   <mn>1</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>a</ci>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a_{1}
  </annotation>
 </semantics>
</math>


 could be any integer (even negative if 

<math display="inline" id="Shamir's_Secret_Sharing:84">
 <semantics>
  <mrow>
   <mo stretchy="false">[</mo>
   <mn>448</mn>
   <mo>,</mo>
   <mn>445</mn>
   <mo>,</mo>
   <mn>442</mn>
   <mo>,</mo>
   <mi mathvariant="normal">…</mi>
   <mo stretchy="false">]</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <list>
    <cn type="integer">448</cn>
    <cn type="integer">445</cn>
    <cn type="integer">442</cn>
    <ci>normal-…</ci>
   </list>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   [448,445,442,...]
  </annotation>
 </semantics>
</math>

) so there are an infinite amount of possible values for 

<math display="inline" id="Shamir's_Secret_Sharing:85">
 <semantics>
  <mn>1613</mn>
  <annotation-xml encoding="MathML-Content">
   <cn type="integer">1613</cn>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   1613
  </annotation>
 </semantics>
</math>

. She knows that 

<math display="inline" id="Shamir's_Secret_Sharing:86">
 <semantics>
  <mn>3</mn>
  <annotation-xml encoding="MathML-Content">
   <cn type="integer">3</cn>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   3
  </annotation>
 </semantics>
</math>

 always decreases by 3 so if 

<math display="inline" id="Shamir's_Secret_Sharing:87">
 <semantics>
  <mrow>
   <msub>
    <mi>a</mi>
    <mn>1</mn>
   </msub>
   <mo>∈</mo>
   <mrow>
    <mo stretchy="false">[</mo>
    <mn>1</mn>
    <mo>,</mo>
    <mn>4</mn>
    <mo>,</mo>
    <mn>7</mn>
    <mo>,</mo>
    <mi mathvariant="normal">…</mi>
    <mo stretchy="false">]</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <in></in>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>a</ci>
     <cn type="integer">1</cn>
    </apply>
    <list>
     <cn type="integer">1</cn>
     <cn type="integer">4</cn>
     <cn type="integer">7</cn>
     <ci>normal-…</ci>
    </list>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a_{1}\in[1,4,7,\dots]
  </annotation>
 </semantics>
</math>

 was divisible by 

<math display="inline" id="Shamir's_Secret_Sharing:88">
 <semantics>
  <mrow>
   <mo>(</mo>
   <mi>k</mi>
   <mo>,</mo>
   <mi>n</mi>
   <mo>)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <interval closure="open">
    <ci>k</ci>
    <ci>n</ci>
   </interval>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \left(k,n\right)\,\!
  </annotation>
 </semantics>
</math>


 she could conclude 

<math display="inline" id="Shamir's_Secret_Sharing:89">
 <semantics>
  <mi>k</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>k</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   k\,\!
  </annotation>
 </semantics>
</math>

 but because it's prime she can't even conclude that and so she didn't win any information.</p>
<h4 id="javascript-example">Javascript example</h4>
<div style="overflow:auto;">
<div class="sourceCode"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="kw">var</span> prime <span class="op">=</span> <span class="dv">257</span><span class="op">;</span>

<span class="co">/* Split number into the shares */</span>
<span class="kw">function</span> <span class="at">split</span>(number<span class="op">,</span> available<span class="op">,</span> needed) <span class="op">{</span>
    <span class="kw">var</span> coef <span class="op">=</span> [number<span class="op">,</span> <span class="dv">166</span><span class="op">,</span> <span class="dv">94</span>]<span class="op">,</span> x<span class="op">,</span> exp<span class="op">,</span> c<span class="op">,</span> accum<span class="op">,</span> shares <span class="op">=</span> []<span class="op">;</span>
    <span class="co">/* Normally, we use the line:</span>
<span class="co">     * for(c = 1, coef[0] = number; c &lt; needed; c++) coef[c] = Math.floor(Math.random() * (prime  - 1));</span>
<span class="co">     * where (prime - 1) is the maximum allowable value.</span>
<span class="co">     * However, to follow this example, we hardcode the values:</span>
<span class="co">     * coef = [number, 166, 94];</span>
<span class="co">     * For production, replace the hardcoded value with the random loop</span>
<span class="co">     * For each share that is requested to be available, run through the formula plugging the corresponding coefficient</span>
<span class="co">     * The result is f(x), where x is the byte we are sharing (in the example, 1234)</span>
<span class="co">     */</span>
    <span class="cf">for</span>(x <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> x <span class="op">&lt;=</span> available<span class="op">;</span> x<span class="op">++</span>) <span class="op">{</span>
        <span class="co">/* coef = [1234, 166, 94] which is 1234x^0 + 166x^1 + 94x^2 */</span>
        <span class="cf">for</span>(exp <span class="op">=</span> <span class="dv">1</span><span class="op">,</span> accum <span class="op">=</span> coef[<span class="dv">0</span>]<span class="op">;</span> exp <span class="op">&lt;</span> needed<span class="op">;</span> exp<span class="op">++</span>) accum <span class="op">=</span> (accum <span class="op">+</span> (coef[exp] <span class="op">*</span> (<span class="va">Math</span>.<span class="at">pow</span>(x<span class="op">,</span> exp) <span class="op">%</span> prime) <span class="op">%</span> prime)) <span class="op">%</span> prime<span class="op">;</span>
        <span class="co">/* Store values as (1, 132), (2, 66), (3, 188), (4, 241), (5, 225) (6, 140) */</span>
        shares[x <span class="op">-</span> <span class="dv">1</span>] <span class="op">=</span> [x<span class="op">,</span> accum]<span class="op">;</span>
    <span class="op">}</span>
    <span class="cf">return</span> shares<span class="op">;</span>
<span class="op">}</span>

<span class="co">/* Gives the decomposition of the gcd of a and b.  Returns [x,y,z] such that x = gcd(a,b) and y*a + z*b = x */</span>
<span class="kw">function</span> <span class="at">gcdD</span>(a<span class="op">,</span>b) <span class="op">{</span> 
    <span class="cf">if</span> (b <span class="op">==</span> <span class="dv">0</span>) <span class="cf">return</span> [a<span class="op">,</span> <span class="dv">1</span><span class="op">,</span> <span class="dv">0</span>]<span class="op">;</span> 
    <span class="cf">else</span> <span class="op">{</span> 
        <span class="kw">var</span> n <span class="op">=</span> <span class="va">Math</span>.<span class="at">floor</span>(a/b)<span class="op">,</span> c <span class="op">=</span> a <span class="op">%</span> b<span class="op">,</span> r <span class="op">=</span> <span class="at">gcdD</span>(b<span class="op">,</span>c)<span class="op">;</span> 
        <span class="cf">return</span> [r[<span class="dv">0</span>]<span class="op">,</span> r[<span class="dv">2</span>]<span class="op">,</span> r[<span class="dv">1</span>]<span class="op">-</span>r[<span class="dv">2</span>]<span class="op">*</span>n]<span class="op">;</span>
    <span class="op">}</span>
<span class="op">}</span>

<span class="co">/* Gives the multiplicative inverse of k mod prime.  In other words (k * modInverse(k)) % prime = 1 for all prime &gt; k &gt;= 1  */</span>
<span class="kw">function</span> <span class="at">modInverse</span>(k) <span class="op">{</span> 
    k <span class="op">=</span> k <span class="op">%</span> prime<span class="op">;</span>
    <span class="kw">var</span> r <span class="op">=</span> (k <span class="op">&lt;</span> <span class="dv">0</span>) <span class="op">?</span> <span class="op">-</span><span class="at">gcdD</span>(prime<span class="op">,-</span>k)[<span class="dv">2</span>] : <span class="at">gcdD</span>(prime<span class="op">,</span>k)[<span class="dv">2</span>]<span class="op">;</span>
    <span class="cf">return</span> (prime <span class="op">+</span> r) <span class="op">%</span> prime<span class="op">;</span>
<span class="op">}</span>

<span class="co">/* Join the shares into a number */</span>
<span class="kw">function</span> <span class="at">join</span>(shares) <span class="op">{</span>
    <span class="kw">var</span> accum<span class="op">,</span> count<span class="op">,</span> formula<span class="op">,</span> startposition<span class="op">,</span> nextposition<span class="op">,</span> value<span class="op">,</span> numerator<span class="op">,</span> denominator<span class="op">;</span>
    <span class="cf">for</span>(formula <span class="op">=</span> accum <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> formula <span class="op">&lt;</span> <span class="va">shares</span>.<span class="at">length</span><span class="op">;</span> formula<span class="op">++</span>) <span class="op">{</span>
        <span class="co">/* Multiply the numerator across the top and denominators across the bottom to do Lagrange's interpolation</span>
<span class="co">         * Result is x0(2), x1(4), x2(5) -&gt; -4*-5 and (2-4=-2)(2-5=-3), etc for l0, l1, l2...</span>
<span class="co">         */</span>
        <span class="cf">for</span>(count <span class="op">=</span> <span class="dv">0</span><span class="op">,</span> numerator <span class="op">=</span> denominator <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> count <span class="op">&lt;</span> <span class="va">shares</span>.<span class="at">length</span><span class="op">;</span> count<span class="op">++</span>) <span class="op">{</span>
            <span class="cf">if</span>(formula <span class="op">==</span> count) <span class="cf">continue</span><span class="op">;</span> <span class="co">// If not the same value</span>
            startposition <span class="op">=</span> shares[formula][<span class="dv">0</span>]<span class="op">;</span>
            nextposition <span class="op">=</span> shares[count][<span class="dv">0</span>]<span class="op">;</span>
            numerator <span class="op">=</span> (numerator <span class="op">*</span> <span class="op">-</span>nextposition) <span class="op">%</span> prime<span class="op">;</span>
            denominator <span class="op">=</span> (denominator <span class="op">*</span> (startposition <span class="op">-</span> nextposition)) <span class="op">%</span> prime<span class="op">;</span>
        <span class="op">}</span>
        value <span class="op">=</span> shares[formula][<span class="dv">1</span>]<span class="op">;</span>
        accum <span class="op">=</span> (prime <span class="op">+</span> accum <span class="op">+</span> (value <span class="op">*</span> numerator <span class="op">*</span> <span class="at">modInverse</span>(denominator))) <span class="op">%</span> prime<span class="op">;</span>
    <span class="op">}</span>
    <span class="cf">return</span> accum<span class="op">;</span>
<span class="op">}</span>

<span class="kw">var</span> sh <span class="op">=</span> <span class="at">split</span>(<span class="dv">129</span><span class="op">,</span> <span class="dv">6</span><span class="op">,</span> <span class="dv">3</span>) <span class="co">/* split the secret value 129 into 6 components - at least 3 of which will be needed to figure out the secret value */</span>
<span class="kw">var</span> newshares <span class="op">=</span> [sh[<span class="dv">1</span>]<span class="op">,</span> sh[<span class="dv">3</span>]<span class="op">,</span> sh[<span class="dv">4</span>]]<span class="op">;</span> <span class="co">/* pick any selection of 3 shared keys from sh */</span>

<span class="at">alert</span>(<span class="at">join</span>(newshares))<span class="op">;</span></code></pre></div>
</div>
<h2 id="properties">Properties</h2>

<p>Some of the useful properties of Shamir's 

<math display="inline" id="Shamir's_Secret_Sharing:90">
 <semantics>
  <msub>
   <mi>D</mi>
   <mi>i</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>D</ci>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   D_{i}\,\!
  </annotation>
 </semantics>
</math>

 threshold scheme are:</p>
<ol>
<li><strong>Secure</strong>: <a href="Information_theoretic_security" title="wikilink">Information theoretic security</a>.</li>
<li><strong>Minimal</strong>: The size of each piece does not exceed the size of the original data.</li>
<li><strong>Extensible</strong>: When <span class="LaTeX">$k\,\!$</span> is kept fixed, <span class="LaTeX">$D_i\,\!$</span> pieces can be dynamically added or deleted without affecting the other pieces.</li>
<li><strong>Dynamic</strong>: Security can be easily enhanced without changing the secret, but by changing the polynomial occasionally (keeping the same free term) and constructing new shares to the participants.</li>
<li><strong>Flexible</strong>: In organizations where hierarchy is important, we can supply each participant different number of pieces according to their importance inside the organization. For instance, the president can unlock the safe alone, whereas 3 secretaries are required together to unlock it.</li>
</ol>
<h2 id="see-also">See also</h2>
<ul>
<li><a href="Secret_sharing" title="wikilink">Secret sharing</a></li>
<li><a href="Lagrange_polynomial" title="wikilink">Lagrange polynomial</a></li>
<li><a href="Homomorphic_secret_sharing" title="wikilink">Homomorphic secret sharing</a> - A simplistic decentralized voting protocol.</li>
<li><a href="Two-man_rule" title="wikilink">Two-man rule</a></li>
<li><a href="Partial_Password" title="wikilink">Partial Password</a></li>
</ul>
<h2 id="references">References</h2>
<ul>
<li>

<p>.</p></li>
</ul>
<ul>
<li>

<p>.</p></li>
</ul>
<ul>
<li>

<p>.</p></li>
</ul>
<ul>
<li>

<p>.</p></li>
</ul>
<h2 id="external-links">External links</h2>
<ul>
<li><a href="https://github.com/amper5and/secrets.js">A proper Javascript implementation of Shamir's secret sharing scheme with open source (MIT) license</a></li>
<li><a href="http://point-at-infinity.org/ssss/">ssss: An open source (GPL) implementation of Shamir's Scheme</a> with <a href="http://point-at-infinity.org/ssss/demo.html">online demo</a></li>
<li><a href="http://charles.karney.info/misc/secret.html">An open source (GPL) perl implementation of Shamir's Secret Sharing</a></li>
<li><a href="http://sourceforge.net/projects/secretsharp/">Secret Sharp: An open source (GPL) implementation of Shamir's Scheme for windows</a></li>
<li><a href="http://www.christophedavid.org/w/c/w.php/Calculators/ShamirSecretSharing">Christophe David's web based implementation of Shamir's scheme 'How to share a Secret'</a></li>
<li><a href="http://sourceforge.net/projects/secretsharejava/">Shamir's Secret Sharing in Java : An open source (LGPL) implementation of Shamir's scheme in Java</a></li>
<li><a href="http://www.dis.uniroma1.it/~damore/sss/">An open source implementation of the Shamir's Secret Sharing as open Web application, augmented by additional security features</a></li>
<li><a href="http://www.digital-scurf.org/software/libgfshare">libgfshare: a secret sharing library in GF(2**8), opensource (MIT)</a></li>
<li><a href="http://www.asecuritysite.com/Encryption/shamir">Web implementation of Shamir's method</a></li>
<li><a href="https://github.com/Archistar/archistar-smc">Java library implementation of multiple secret sharing methods, opensource(LGPLv2)</a></li>
</ul>

<p>"</p>

<p><a href="Category:Secret_sharing" title="wikilink">Category:Secret sharing</a> <a href="Category:Information-theoretically_secure_algorithms" title="wikilink">Category:Information-theoretically secure algorithms</a></p>
</body>


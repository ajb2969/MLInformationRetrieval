<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title offset="1662">Coupon collector's problem</title>
   <script type="text/javascript"
      src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js">
    </script>
</head>
<body>
<h1>Coupon collector's problem</h1>
<hr/>
<p> In <a href="probability_theory" title="wikilink">probability theory</a>, the <strong>coupon collector's problem</strong> describes the "collect all coupons and win" contests. It asks the following question: Suppose that there is an <a href="urn_problem" title="wikilink">urn</a> of <em>n</em> different <a href="coupon" title="wikilink">coupons</a>, from which coupons are being collected, equally likely, with replacement. What is the probability that more than <em>t</em> sample trials are needed to collect all <em>n</em> coupons? An alternative statement is: Given <em>n</em> coupons, how many coupons do you expect you need to draw with replacement before having drawn each coupon at least once? The mathematical analysis of the problem reveals that the <a href="expected_value" title="wikilink">expected number</a> of trials needed grows as <span class="LaTeX">$\Theta(n\log(n))$</span>.<a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a> For example, when <em>n</em> = 50 it takes about 225<a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a> trials to collect all 50 coupons.</p>
<h2 id="understanding-the-problem">Understanding the problem</h2>
<p>The key to solving the problem is understanding that it takes very little time to collect the first few coupons. On the other hand, it takes a long time to collect the last few coupons. In fact, for 50 coupons, it takes on average 50 trials to collect the very last coupon after the other 49 coupons have been collected. This is why the expected time to collect all coupons is much longer than 50. The idea now is to split the total time into 50 intervals where the expected time can be calculated.</p>
<h2 id="answer">Answer</h2>
<p>The following table (click [show] to expand) gives the expected number of tries to get sets of 1 to 100 coupons.</p>
<table>
<thead>
<tr class="header">
<th style="text-align: left;"><p>Number<br/>
 of coupons,<br/>
<em>n</em></p></th>
<th style="text-align: left;"><p>Expected number<br/>
 of tries per coupon<br/>
 = <em>H<sub>n</sub></em></p></th>
<th style="text-align: left;"><p>Expected total<br/>
 number of tries,<br/>
<em>E</em> (<em>T</em> ) = ⌈<em>n H<sub>n</sub> </em>⌉</p></th>
<th style="text-align: left;"></th>
<th style="text-align: left;"><p>Number<br/>
 of coupons,<br/>
<em>n</em></p></th>
<th style="text-align: left;"><p>Expected number<br/>
 of tries per coupon<br/>
 = <em>H<sub>n</sub></em></p></th>
<th style="text-align: left;"><p>Expected total<br/>
 number of tries,<br/>
<em>E</em> (<em>T</em> ) = ⌈<em>n H<sub>n</sub> </em>⌉</p></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><p>1</p></td>
<td style="text-align: left;"><p>1      </p></td>
<td style="text-align: left;"><p>1</p></td>
<td style="text-align: left;"><p>51</p></td>
<td style="text-align: left;"><p>4.51881</p></td>
<td style="text-align: left;"><p>231</p></td>
</tr>
<tr class="even">
<td style="text-align: left;"><p>2</p></td>
<td style="text-align: left;"><p>1.5    </p></td>
<td style="text-align: left;"><p>3</p></td>
<td style="text-align: left;"><p>52</p></td>
<td style="text-align: left;"><p>4.53804</p></td>
<td style="text-align: left;"><p>236</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><p>3</p></td>
<td style="text-align: left;"><p>1.83333</p></td>
<td style="text-align: left;"><p>6</p></td>
<td style="text-align: left;"><p>53</p></td>
<td style="text-align: left;"><p>4.55691</p></td>
<td style="text-align: left;"><p>242</p></td>
</tr>
<tr class="even">
<td style="text-align: left;"><p>4</p></td>
<td style="text-align: left;"><p>2.08333</p></td>
<td style="text-align: left;"><p>9</p></td>
<td style="text-align: left;"><p>54</p></td>
<td style="text-align: left;"><p>4.57543</p></td>
<td style="text-align: left;"><p>248</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><p>5</p></td>
<td style="text-align: left;"><p>2.28333</p></td>
<td style="text-align: left;"><p>12</p></td>
<td style="text-align: left;"><p>55</p></td>
<td style="text-align: left;"><p>4.59361</p></td>
<td style="text-align: left;"><p>253</p></td>
</tr>
<tr class="even">
<td style="text-align: left;"><p>6</p></td>
<td style="text-align: left;"><p>2.45   </p></td>
<td style="text-align: left;"><p>15</p></td>
<td style="text-align: left;"><p>56</p></td>
<td style="text-align: left;"><p>4.61147</p></td>
<td style="text-align: left;"><p>259</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><p>7</p></td>
<td style="text-align: left;"><p>2.59286</p></td>
<td style="text-align: left;"><p>19</p></td>
<td style="text-align: left;"><p>57</p></td>
<td style="text-align: left;"><p>4.62901</p></td>
<td style="text-align: left;"><p>264</p></td>
</tr>
<tr class="even">
<td style="text-align: left;"><p>8</p></td>
<td style="text-align: left;"><p>2.71786</p></td>
<td style="text-align: left;"><p>22</p></td>
<td style="text-align: left;"><p>58</p></td>
<td style="text-align: left;"><p>4.64625</p></td>
<td style="text-align: left;"><p>270</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><p>9</p></td>
<td style="text-align: left;"><p>2.82897</p></td>
<td style="text-align: left;"><p>26</p></td>
<td style="text-align: left;"><p>59</p></td>
<td style="text-align: left;"><p>4.66320</p></td>
<td style="text-align: left;"><p>276</p></td>
</tr>
<tr class="even">
<td style="text-align: left;"><p>10</p></td>
<td style="text-align: left;"><p>2.92897</p></td>
<td style="text-align: left;"><p>30</p></td>
<td style="text-align: left;"><p>60</p></td>
<td style="text-align: left;"><p>4.67987</p></td>
<td style="text-align: left;"><p>281</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><p>11</p></td>
<td style="text-align: left;"><p>3.01988</p></td>
<td style="text-align: left;"><p>34</p></td>
<td style="text-align: left;"><p>61</p></td>
<td style="text-align: left;"><p>4.69626</p></td>
<td style="text-align: left;"><p>287</p></td>
</tr>
<tr class="even">
<td style="text-align: left;"><p>12</p></td>
<td style="text-align: left;"><p>3.10321</p></td>
<td style="text-align: left;"><p>38</p></td>
<td style="text-align: left;"><p>62</p></td>
<td style="text-align: left;"><p>4.71239</p></td>
<td style="text-align: left;"><p>293</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><p>13</p></td>
<td style="text-align: left;"><p>3.18013</p></td>
<td style="text-align: left;"><p>42</p></td>
<td style="text-align: left;"><p>63</p></td>
<td style="text-align: left;"><p>4.72827</p></td>
<td style="text-align: left;"><p>298</p></td>
</tr>
<tr class="even">
<td style="text-align: left;"><p>14</p></td>
<td style="text-align: left;"><p>3.25156</p></td>
<td style="text-align: left;"><p>46</p></td>
<td style="text-align: left;"><p>64</p></td>
<td style="text-align: left;"><p>4.74389</p></td>
<td style="text-align: left;"><p>304</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><p>15</p></td>
<td style="text-align: left;"><p>3.31823</p></td>
<td style="text-align: left;"><p>50</p></td>
<td style="text-align: left;"><p>65</p></td>
<td style="text-align: left;"><p>4.75928</p></td>
<td style="text-align: left;"><p>310</p></td>
</tr>
<tr class="even">
<td style="text-align: left;"><p>16</p></td>
<td style="text-align: left;"><p>3.38073</p></td>
<td style="text-align: left;"><p>55</p></td>
<td style="text-align: left;"><p>66</p></td>
<td style="text-align: left;"><p>4.77443</p></td>
<td style="text-align: left;"><p>316</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><p>17</p></td>
<td style="text-align: left;"><p>3.43955</p></td>
<td style="text-align: left;"><p>59</p></td>
<td style="text-align: left;"><p>67</p></td>
<td style="text-align: left;"><p>4.78935</p></td>
<td style="text-align: left;"><p>321</p></td>
</tr>
<tr class="even">
<td style="text-align: left;"><p>18</p></td>
<td style="text-align: left;"><p>3.49511</p></td>
<td style="text-align: left;"><p>63</p></td>
<td style="text-align: left;"><p>68</p></td>
<td style="text-align: left;"><p>4.80406</p></td>
<td style="text-align: left;"><p>327</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><p>19</p></td>
<td style="text-align: left;"><p>3.54774</p></td>
<td style="text-align: left;"><p>68</p></td>
<td style="text-align: left;"><p>69</p></td>
<td style="text-align: left;"><p>4.81855</p></td>
<td style="text-align: left;"><p>333</p></td>
</tr>
<tr class="even">
<td style="text-align: left;"><p>20</p></td>
<td style="text-align: left;"><p>3.59774</p></td>
<td style="text-align: left;"><p>72</p></td>
<td style="text-align: left;"><p>70</p></td>
<td style="text-align: left;"><p>4.83284</p></td>
<td style="text-align: left;"><p>339</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><p>21</p></td>
<td style="text-align: left;"><p>3.64536</p></td>
<td style="text-align: left;"><p>77</p></td>
<td style="text-align: left;"><p>71</p></td>
<td style="text-align: left;"><p>4.84692</p></td>
<td style="text-align: left;"><p>345</p></td>
</tr>
<tr class="even">
<td style="text-align: left;"><p>22</p></td>
<td style="text-align: left;"><p>3.69081</p></td>
<td style="text-align: left;"><p>82</p></td>
<td style="text-align: left;"><p>72</p></td>
<td style="text-align: left;"><p>4.86081</p></td>
<td style="text-align: left;"><p>350</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><p>23</p></td>
<td style="text-align: left;"><p>3.73429</p></td>
<td style="text-align: left;"><p>86</p></td>
<td style="text-align: left;"><p>73</p></td>
<td style="text-align: left;"><p>4.87451</p></td>
<td style="text-align: left;"><p>356</p></td>
</tr>
<tr class="even">
<td style="text-align: left;"><p>24</p></td>
<td style="text-align: left;"><p>3.77596</p></td>
<td style="text-align: left;"><p>91</p></td>
<td style="text-align: left;"><p>74</p></td>
<td style="text-align: left;"><p>4.88802</p></td>
<td style="text-align: left;"><p>362</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><p>25</p></td>
<td style="text-align: left;"><p>3.81596</p></td>
<td style="text-align: left;"><p>96</p></td>
<td style="text-align: left;"><p>75</p></td>
<td style="text-align: left;"><p>4.90136</p></td>
<td style="text-align: left;"><p>368</p></td>
</tr>
<tr class="even">
<td style="text-align: left;"><p>26</p></td>
<td style="text-align: left;"><p>3.85442</p></td>
<td style="text-align: left;"><p>101</p></td>
<td style="text-align: left;"><p>76</p></td>
<td style="text-align: left;"><p>4.91451</p></td>
<td style="text-align: left;"><p>374</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><p>27</p></td>
<td style="text-align: left;"><p>3.89146</p></td>
<td style="text-align: left;"><p>106</p></td>
<td style="text-align: left;"><p>77</p></td>
<td style="text-align: left;"><p>4.92750</p></td>
<td style="text-align: left;"><p>380</p></td>
</tr>
<tr class="even">
<td style="text-align: left;"><p>28</p></td>
<td style="text-align: left;"><p>3.92717</p></td>
<td style="text-align: left;"><p>110</p></td>
<td style="text-align: left;"><p>78</p></td>
<td style="text-align: left;"><p>4.94032</p></td>
<td style="text-align: left;"><p>386</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><p>29</p></td>
<td style="text-align: left;"><p>3.96165</p></td>
<td style="text-align: left;"><p>115</p></td>
<td style="text-align: left;"><p>79</p></td>
<td style="text-align: left;"><p>4.95298</p></td>
<td style="text-align: left;"><p>392</p></td>
</tr>
<tr class="even">
<td style="text-align: left;"><p>30</p></td>
<td style="text-align: left;"><p>3.99499</p></td>
<td style="text-align: left;"><p>120</p></td>
<td style="text-align: left;"><p>80</p></td>
<td style="text-align: left;"><p>4.96548</p></td>
<td style="text-align: left;"><p>398</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><p>31</p></td>
<td style="text-align: left;"><p>4.02725</p></td>
<td style="text-align: left;"><p>125</p></td>
<td style="text-align: left;"><p>81</p></td>
<td style="text-align: left;"><p>4.97782</p></td>
<td style="text-align: left;"><p>404</p></td>
</tr>
<tr class="even">
<td style="text-align: left;"><p>32</p></td>
<td style="text-align: left;"><p>4.05850</p></td>
<td style="text-align: left;"><p>130</p></td>
<td style="text-align: left;"><p>82</p></td>
<td style="text-align: left;"><p>4.99002</p></td>
<td style="text-align: left;"><p>410</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><p>33</p></td>
<td style="text-align: left;"><p>4.08880</p></td>
<td style="text-align: left;"><p>135</p></td>
<td style="text-align: left;"><p>83</p></td>
<td style="text-align: left;"><p>5.00207</p></td>
<td style="text-align: left;"><p>416</p></td>
</tr>
<tr class="even">
<td style="text-align: left;"><p>34</p></td>
<td style="text-align: left;"><p>4.11821</p></td>
<td style="text-align: left;"><p>141</p></td>
<td style="text-align: left;"><p>84</p></td>
<td style="text-align: left;"><p>5.01397</p></td>
<td style="text-align: left;"><p>422</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><p>35</p></td>
<td style="text-align: left;"><p>4.14678</p></td>
<td style="text-align: left;"><p>146</p></td>
<td style="text-align: left;"><p>85</p></td>
<td style="text-align: left;"><p>5.02574</p></td>
<td style="text-align: left;"><p>428</p></td>
</tr>
<tr class="even">
<td style="text-align: left;"><p>36</p></td>
<td style="text-align: left;"><p>4.17456</p></td>
<td style="text-align: left;"><p>151</p></td>
<td style="text-align: left;"><p>86</p></td>
<td style="text-align: left;"><p>5.03737</p></td>
<td style="text-align: left;"><p>434</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><p>37</p></td>
<td style="text-align: left;"><p>4.20159</p></td>
<td style="text-align: left;"><p>156</p></td>
<td style="text-align: left;"><p>87</p></td>
<td style="text-align: left;"><p>5.04886</p></td>
<td style="text-align: left;"><p>440</p></td>
</tr>
<tr class="even">
<td style="text-align: left;"><p>38</p></td>
<td style="text-align: left;"><p>4.22790</p></td>
<td style="text-align: left;"><p>161</p></td>
<td style="text-align: left;"><p>88</p></td>
<td style="text-align: left;"><p>5.06022</p></td>
<td style="text-align: left;"><p>446</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><p>39</p></td>
<td style="text-align: left;"><p>4.25354</p></td>
<td style="text-align: left;"><p>166</p></td>
<td style="text-align: left;"><p>89</p></td>
<td style="text-align: left;"><p>5.07146</p></td>
<td style="text-align: left;"><p>452</p></td>
</tr>
<tr class="even">
<td style="text-align: left;"><p>40</p></td>
<td style="text-align: left;"><p>4.27854</p></td>
<td style="text-align: left;"><p>172</p></td>
<td style="text-align: left;"><p>90</p></td>
<td style="text-align: left;"><p>5.08257</p></td>
<td style="text-align: left;"><p>458</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><p>41</p></td>
<td style="text-align: left;"><p>4.30293</p></td>
<td style="text-align: left;"><p>177</p></td>
<td style="text-align: left;"><p>91</p></td>
<td style="text-align: left;"><p>5.09356</p></td>
<td style="text-align: left;"><p>464</p></td>
</tr>
<tr class="even">
<td style="text-align: left;"><p>42</p></td>
<td style="text-align: left;"><p>4.32674</p></td>
<td style="text-align: left;"><p>182</p></td>
<td style="text-align: left;"><p>92</p></td>
<td style="text-align: left;"><p>5.10443</p></td>
<td style="text-align: left;"><p>470</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><p>43</p></td>
<td style="text-align: left;"><p>4.35000</p></td>
<td style="text-align: left;"><p>188</p></td>
<td style="text-align: left;"><p>93</p></td>
<td style="text-align: left;"><p>5.11518</p></td>
<td style="text-align: left;"><p>476</p></td>
</tr>
<tr class="even">
<td style="text-align: left;"><p>44</p></td>
<td style="text-align: left;"><p>4.37273</p></td>
<td style="text-align: left;"><p>193</p></td>
<td style="text-align: left;"><p>94</p></td>
<td style="text-align: left;"><p>5.12582</p></td>
<td style="text-align: left;"><p>482</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><p>45</p></td>
<td style="text-align: left;"><p>4.39495</p></td>
<td style="text-align: left;"><p>198</p></td>
<td style="text-align: left;"><p>95</p></td>
<td style="text-align: left;"><p>5.13635</p></td>
<td style="text-align: left;"><p>488</p></td>
</tr>
<tr class="even">
<td style="text-align: left;"><p>46</p></td>
<td style="text-align: left;"><p>4.41669</p></td>
<td style="text-align: left;"><p>204</p></td>
<td style="text-align: left;"><p>96</p></td>
<td style="text-align: left;"><p>5.14676</p></td>
<td style="text-align: left;"><p>495</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><p>47</p></td>
<td style="text-align: left;"><p>4.43796</p></td>
<td style="text-align: left;"><p>209</p></td>
<td style="text-align: left;"><p>97</p></td>
<td style="text-align: left;"><p>5.15707</p></td>
<td style="text-align: left;"><p>501</p></td>
</tr>
<tr class="even">
<td style="text-align: left;"><p>48</p></td>
<td style="text-align: left;"><p>4.45880</p></td>
<td style="text-align: left;"><p>215</p></td>
<td style="text-align: left;"><p>98</p></td>
<td style="text-align: left;"><p>5.16728</p></td>
<td style="text-align: left;"><p>507</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><p>49</p></td>
<td style="text-align: left;"><p>4.47921</p></td>
<td style="text-align: left;"><p>220</p></td>
<td style="text-align: left;"><p>99</p></td>
<td style="text-align: left;"><p>5.17738</p></td>
<td style="text-align: left;"><p>513</p></td>
</tr>
<tr class="even">
<td style="text-align: left;"><p>50</p></td>
<td style="text-align: left;"><p>4.49921</p></td>
<td style="text-align: left;"><p>225</p></td>
<td style="text-align: left;"><p>100</p></td>
<td style="text-align: left;"><p>5.18738</p></td>
<td style="text-align: left;"><p>519</p></td>
</tr>
</tbody>
</table>
<h2 id="solution">Solution</h2>
<h3 id="calculating-the-expectation">Calculating the expectation</h3>
<p>Let <em>T</em> be the time to collect all <em>n</em> coupons, and let <em>t<sub>i</sub></em> be the time to collect the <em>i</em>-th coupon after <em>i</em> − 1 coupons have been collected. Think of <em>T</em> and <em>t<sub>i</sub></em> as <a href="random_variable" title="wikilink">random variables</a>. Observe that the probability of collecting a <strong>new</strong> coupon given <em>i</em> − 1 coupons is <em>p<sub>i</sub></em> = (<em>n</em> − (<em>i</em> − 1))/<em>n</em>. Therefore, <em>t<sub>i</sub></em> has <a href="geometric_distribution" title="wikilink">geometric distribution</a> with expectation 1/<em>p<sub>i</sub></em>. By the <a href="Expected_value#Linearity" title="wikilink">linearity of expectations</a> we have:</p>
<p><span class="LaTeX">$$\begin{align}
\operatorname{E}(T)& = \operatorname{E}(t_1) + \operatorname{E}(t_2) + \cdots + \operatorname{E}(t_n) 
= \frac{1}{p_1} + \frac{1}{p_2} +  \cdots + \frac{1}{p_n} \\
& = \frac{n}{n} + \frac{n}{n-1} +  \cdots + \frac{n}{1}  = n \cdot \left(\frac{1}{1} + \frac{1}{2} + \cdots + \frac{1}{n}\right) \, = \, n \cdot H_n.
\end{align}$$</span></p>
<p>Here <em>H<sub>n</sub></em> is the <a href="harmonic_number" title="wikilink">harmonic number</a>. Using the <a class="uri" href="asymptotics" title="wikilink">asymptotics</a> of the harmonic numbers, we obtain:</p>
<p><span class="LaTeX">$$\operatorname{E}(T)  = n \cdot H_n = n \log n + \gamma n + \frac1{2} + o(1), \ \ 
\text{as}  \ n \to \infty,$$</span> where <span class="LaTeX">$\gamma \approx 0.5772156649$</span> is the <a href="Euler–Mascheroni_constant" title="wikilink">Euler–Mascheroni constant</a>.</p>
<p>Now one can use the <a href="Markov_inequality" title="wikilink">Markov inequality</a> to bound the desired probability:</p>
<p><span class="LaTeX">$$\operatorname{P}(T \geq c \, n H_n) \le \frac1c.$$</span></p>
<h3 id="calculating-the-variance">Calculating the variance</h3>
<p>Using the independence of random variables <em>t<sub>i</sub></em>, we obtain:</p>
<p><span class="LaTeX">$$\begin{align}
\operatorname{Var}(T)& = \operatorname{Var}(t_1) + \operatorname{Var}(t_2) + \cdots + \operatorname{Var}(t_n) \\ 
& = \frac{1-p_1}{p_1^2} + \frac{1-p_2}{p_2^2} +  \cdots + \frac{1-p_n}{p_n^2} \\
& < \left(\frac{n^2}{n^2} + \frac{n^2}{(n-1)^2} +  \cdots + \frac{n^2}{1^2}\right) \\
& < n^2 \cdot \left(\frac{1}{1^2} + \frac{1}{2^2} + \cdots + \frac{1}{n^2} \right) \\
& < n^2 \cdot \left(\frac{\pi^2}{6} - \frac{1}{n} + \frac{1}{2n^2}\right) \\
& < \frac{\pi^2}{6} n^2.
\end{align}$$</span></p>
<p>The <span class="LaTeX">$\pi^2/6$</span> is a value of the <a href="Riemann_zeta_function" title="wikilink">Riemann zeta function</a> (see <a href="Basel_problem" title="wikilink">Basel problem</a>).</p>
<p>Now one can use the <a href="Chebyshev_inequality" title="wikilink">Chebyshev inequality</a> to bound the desired probability:</p>
<p><span class="LaTeX">$$\operatorname{P}\left(|T- n H_n| \geq c\, n\right) \le \frac{\pi^2}{6c^2}.$$</span></p>
<h3 id="tail-estimates">Tail estimates</h3>
<p>A different upper bound can be derived from the following observation. Let <span class="LaTeX">${Z}_i^r$</span> denote the event that the <span class="LaTeX">$i$</span>-th coupon was not picked in the first <span class="LaTeX">$r$</span> trials. Then:</p>
<p><span class="LaTeX">$$\begin{align}
P\left [ {Z}_i^r \right ] = \left(1-\frac{1}{n}\right)^r \le e^{-r / n}
\end{align}$$</span></p>
<p>Thus, for <span class="LaTeX">$r = \beta n \log n$</span>, we have <span class="LaTeX">$P\left [ {Z}_i^r \right ] \le e^{(-\beta n \log n ) / n} = n^{-\beta}$</span>.</p>
<p><span class="LaTeX">$$\begin{align}
P\left [ T > \beta n \log n \right ] = P \left [    \bigcup_i {Z}_i^{\beta n \log n} \right ] \le n \cdot P [ {Z}_1^{\beta n \log n} ] \le n^{-\beta + 1}
\end{align}$$</span></p>
<h2 id="extensions-and-generalizations">Extensions and generalizations</h2>
<ul>
<li><a href="Paul_Erdős" title="wikilink">Paul Erdős</a> and <a href="Alfréd_Rényi" title="wikilink">Alfréd Rényi</a> proved the limit theorem for the distribution of <em>T</em>. This result is a further extension of previous bounds.</li>
</ul>
<dl>
<dd><dl>
<dd><math>
</math></dd>
</dl>
</dd>
</dl>
<p>\operatorname{P}(T </p>
<ul>
<li><a href="Donald_J._Newman" title="wikilink">Donald J. Newman</a> and <a href="Lawrence_Shepp" title="wikilink">Lawrence Shepp</a> found a generalization of the coupon collector's problem when <em>m</em> copies of each coupon needs to be collected. Let <em>T<sub>m</sub></em> be the first time <em>m</em> copies of each coupon are collected. They showed that the expectation in this case satisfies:</li>
</ul>
<dl>
<dd><dl>
<dd><math>
</math></dd>
</dl>
</dd>
</dl>
<p>\operatorname{E}(T_m) = n \log n + (m-1) n \log\log n + O(n), \ \ \text{as} \ n \to \infty. </p>
<dl>
<dd>Here <em>m</em> is fixed. When <em>m</em> = 1 we get the earlier formula for the expectation.
</dd>
</dl>
<ul>
<li>Common generalization, also due to Erdős and Rényi:</li>
</ul>
<dl>
<dd><dl>
<dd><math>
</math></dd>
</dl>
</dd>
</dl>
<p>\operatorname{P}(T_k </p>
<ul>
<li>In the general case of a nonuniform probability distribution, according to <a href="Philippe_Flajolet" title="wikilink">Philippe Flajolet</a>,</li>
</ul>
<dl>
<dd><dl>
<dd><math>
</math></dd>
</dl>
</dd>
</dl>
<p>E(T)=\int_0^\infty \big(1-\prod_{i=1}^n(1-e^{-p_it})\big)dt </p>
<h2 id="see-also">See also</h2>
<ul>
<li><a href="Watterson_estimator" title="wikilink">Watterson estimator</a></li>
<li><a href="Birthday_problem" title="wikilink">Birthday problem</a> - This is the problem of how many coupons must be drawn before seeing a duplicate.</li>
</ul>
<h2 id="notes">Notes</h2>
<h2 id="references">References</h2>
<ul>
<li>
<p>.</p></li>
<li>
<p>.</p></li>
<li>
<p>.</p></li>
<li></li>
<li>
<p>.</p></li>
<li>
<p>.</p></li>
<li>
<p>.</p></li>
</ul>
<h2 id="external-links">External links</h2>
<ul>
<li>"<a href="http://demonstrations.wolfram.com/CouponCollectorProblem/">Coupon Collector Problem</a>" by <a href="Ed_Pegg,_Jr." title="wikilink">Ed Pegg, Jr.</a>, the <a href="Wolfram_Demonstrations_Project" title="wikilink">Wolfram Demonstrations Project</a>. Mathematica package.</li>
<li><a href="http://www-stat.stanford.edu/~susan/surprise/Collector.html">Coupon Collector Problem</a>, a simple <a href="Java_applet" title="wikilink">Java applet</a>.</li>
<li><em><a href="http://www.math.rutgers.edu/~zeilberg/mamarim/mamarimhtml/coupon.html">How Many Singles, Doubles, Triples, Etc., Should The Coupon Collector Expect?</a></em>, a short note by <a href="Doron_Zeilberger" title="wikilink">Doron Zeilberger</a>.</li>
</ul>
<p>"</p>
<p><a href="Category:Articles_containing_proofs" title="wikilink">Category:Articles containing proofs</a> <a href="Category:Games_(probability)" title="wikilink">Category:Games (probability)</a> <a href="Category:Probability_theorems" title="wikilink">Category:Probability theorems</a> <a href="Category:Named_probability_problems" title="wikilink">Category:Named probability problems</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1">Here and throughout this article, "log" refers to the <a href="natural_logarithm" title="wikilink">natural logarithm</a> rather than a logarithm to some other base. The use of Θ here invokes <a href="big_O_notation" title="wikilink">big O notation</a>.<a href="#fnref1">↩</a></li>
<li id="fn2">E(50) = 50(1 + 1/2 + 1/3 + ... + 1/50) = 224.9603, the expected number of trials to collect all 50 coupons. The approximation <span class="LaTeX">$n\log n+\gamma n+1/2$</span> for this expected number gives in this case <span class="LaTeX">$50\log 50+50\gamma+1/2 \approx 195.6011+28.8608+0.5\approx 224.9619$</span>.<a href="#fnref2">↩</a></li>
</ol>
</section>
</body>
</html>

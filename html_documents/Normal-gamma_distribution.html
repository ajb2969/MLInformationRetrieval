<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="1211">Normal-gamma distribution</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Normal-gamma distribution</h1>
<hr/>

<p>{\Gamma(\alpha)\sqrt{2\pi}} \, \tau^{\alpha-\frac{1}{2}}\,e^{-\beta\tau}\,e^{ -\frac{ \lambda \tau (x- \mu)^2}{2}}|</p>

<p><code> cdf        =|</code><br/>
<code> mean       =</code><a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a><code> </code>

<math display="inline" id="Normal-gamma_distribution:0">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mo>E</mo>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>X</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mi>μ</mi>
   </mrow>
   <mo rspace="12.5pt">,</mo>
   <mrow>
    <mrow>
     <mo>E</mo>
     <mrow>
      <mo stretchy="false">(</mo>
      <merror class="ltx_ERROR undefined undefined">
       <mtext>\Tau</mtext>
      </merror>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mi>α</mi>
     <msup>
      <mi>β</mi>
      <mrow>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
     </msup>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <eq></eq>
     <apply>
      <ci>normal-E</ci>
      <ci>X</ci>
     </apply>
     <ci>μ</ci>
    </apply>
    <apply>
     <eq></eq>
     <apply>
      <ci>normal-E</ci>
      <mtext>\Tau</mtext>
     </apply>
     <apply>
      <times></times>
      <ci>α</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>β</ci>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \operatorname{E}(X)=\mu\,\!,\quad\operatorname{E}(\Tau)=\alpha\beta^{-1}
  </annotation>
 </semantics>
</math>

<code>  |</code><br/>
<code> median     =  |</code><br/>
<code> mode       = </code>

<math display="inline" id="Normal-gamma_distribution:1">
 <semantics>
  <mrow>
   <mo>(</mo>
   <mi>μ</mi>
   <mo>,</mo>
   <mfrac>
    <mrow>
     <mi>α</mi>
     <mo>-</mo>
     <mfrac>
      <mn>1</mn>
      <mn>2</mn>
     </mfrac>
    </mrow>
    <mi>β</mi>
   </mfrac>
   <mo>)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <interval closure="open">
    <ci>μ</ci>
    <apply>
     <divide></divide>
     <apply>
      <minus></minus>
      <ci>α</ci>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <cn type="integer">2</cn>
      </apply>
     </apply>
     <ci>β</ci>
    </apply>
   </interval>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \left(\mu,\frac{\alpha-\frac{1}{2}}{\beta}\right)
  </annotation>
 </semantics>
</math>

<code>|</code><br/>
<code> variance   =</code><a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a><code> </code>

<math display="inline" id="Normal-gamma_distribution:2">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mo>var</mo>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>X</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mfrac>
     <mi>β</mi>
     <mrow>
      <mi>λ</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mi>α</mi>
        <mo>-</mo>
        <mn>1</mn>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mfrac>
   </mrow>
   <mo rspace="12.5pt">,</mo>
   <mrow>
    <mrow>
     <mo>var</mo>
     <mrow>
      <mo stretchy="false">(</mo>
      <merror class="ltx_ERROR undefined undefined">
       <mtext>\Tau</mtext>
      </merror>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mi>α</mi>
     <msup>
      <mi>β</mi>
      <mrow>
       <mo>-</mo>
       <mn>2</mn>
      </mrow>
     </msup>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <eq></eq>
     <apply>
      <ci>var</ci>
      <ci>X</ci>
     </apply>
     <apply>
      <divide></divide>
      <ci>β</ci>
      <apply>
       <times></times>
       <ci>λ</ci>
       <apply>
        <minus></minus>
        <ci>α</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <apply>
      <ci>var</ci>
      <mtext>\Tau</mtext>
     </apply>
     <apply>
      <times></times>
      <ci>α</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>β</ci>
       <apply>
        <minus></minus>
        <cn type="integer">2</cn>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \operatorname{var}(X)=\frac{\beta}{\lambda(\alpha-1)},\quad\operatorname{var}(%
\Tau)=\alpha\beta^{-2}
  </annotation>
 </semantics>
</math>

<code> |</code><br/>
<code> skewness   =|</code><br/>
<code> kurtosis   =|</code><br/>
<code> entropy    =|</code><br/>
<code> mgf        =|</code><br/>
<code> char       =|</code></p>

<p>}} In <a href="probability_theory" title="wikilink">probability theory</a> and <a class="uri" href="statistics" title="wikilink">statistics</a>, the <strong>normal-gamma distribution</strong> (or <strong>Gaussian-gamma distribution</strong>) is a bivariate four-parameter family of continuous <a href="probability_distribution" title="wikilink">probability distributions</a>. It is the <a href="conjugate_prior" title="wikilink">conjugate prior</a> of a <a href="normal_distribution" title="wikilink">normal distribution</a> with unknown <a class="uri" href="mean" title="wikilink">mean</a> and <a href="Precision_(statistics)" title="wikilink">precision</a>.<a class="footnoteRef" href="#fn3" id="fnref3"><sup>3</sup></a></p>
<h2 id="definition">Definition</h2>

<p>For a pair of <a href="random_variable" title="wikilink">random variable</a>, (<em>X</em>,<em>T</em>), suppose that the <a href="conditional_distribution" title="wikilink">conditional distribution</a> of <em>X</em> given <em>T</em> is given by</p>

<p>

<math display="block" id="Normal-gamma_distribution:3">
 <semantics>
  <mrow>
   <mi>X</mi>
   <mo stretchy="false">|</mo>
   <mi>T</mi>
   <mo>∼</mo>
   <mi>N</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>μ</mi>
    <mo>,</mo>
    <mn>1</mn>
    <mo>/</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>λ</mi>
     <mi>T</mi>
     <mo stretchy="false">)</mo>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">X</csymbol>
    <ci>normal-|</ci>
    <csymbol cd="unknown">T</csymbol>
    <csymbol cd="latexml">similar-to</csymbol>
    <csymbol cd="unknown">N</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">μ</csymbol>
     <ci>normal-,</ci>
     <cn type="integer">1</cn>
     <divide></divide>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <ci>normal-(</ci>
      <csymbol cd="unknown">λ</csymbol>
      <csymbol cd="unknown">T</csymbol>
      <ci>normal-)</ci>
     </cerror>
     <ci>normal-)</ci>
    </cerror>
    <ci>normal-,</ci>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   X|T\sim N(\mu,1/(\lambda T))\,\!,
  </annotation>
 </semantics>
</math>

</p>

<p>meaning that the conditional distribution is a <a href="normal_distribution" title="wikilink">normal distribution</a> with <a class="uri" href="mean" title="wikilink">mean</a> 

<math display="inline" id="Normal-gamma_distribution:4">
 <semantics>
  <mi>μ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>μ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mu
  </annotation>
 </semantics>
</math>

 and <a href="precision_(statistics)" title="wikilink">precision</a> 

<math display="inline" id="Normal-gamma_distribution:5">
 <semantics>
  <mrow>
   <mi>λ</mi>
   <mi>T</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>λ</ci>
    <ci>T</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \lambda T
  </annotation>
 </semantics>
</math>

 — equivalently, with <a class="uri" href="variance" title="wikilink">variance</a> 

<math display="inline" id="Normal-gamma_distribution:6">
 <semantics>
  <mrow>
   <mrow>
    <mn>1</mn>
    <mo>/</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>λ</mi>
      <mi>T</mi>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <divide></divide>
    <cn type="integer">1</cn>
    <apply>
     <times></times>
     <ci>λ</ci>
     <ci>T</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   1/(\lambda T).
  </annotation>
 </semantics>
</math>

</p>

<p>Suppose also that the marginal distribution of <em>T</em> is given by</p>

<p>

<math display="block" id="Normal-gamma_distribution:7">
 <semantics>
  <mrow>
   <mi>T</mi>
   <mo stretchy="false">|</mo>
   <mi>α</mi>
   <mo>,</mo>
   <mi>β</mi>
   <mo>∼</mo>
   <mi>Gamma</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>α</mi>
    <mo>,</mo>
    <mi>β</mi>
    <mo rspace="0.8pt" stretchy="false">)</mo>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">T</csymbol>
    <ci>normal-|</ci>
    <csymbol cd="unknown">α</csymbol>
    <ci>normal-,</ci>
    <csymbol cd="unknown">β</csymbol>
    <csymbol cd="latexml">similar-to</csymbol>
    <csymbol cd="unknown">Gamma</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">α</csymbol>
     <ci>normal-,</ci>
     <csymbol cd="unknown">β</csymbol>
     <ci>normal-)</ci>
    </cerror>
    <ci>normal-,</ci>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   T|\alpha,\beta\sim\mathrm{Gamma}(\alpha,\beta)\!,
  </annotation>
 </semantics>
</math>

</p>

<p>where this means that <em>T</em> has a <a href="gamma_distribution" title="wikilink">gamma distribution</a>. Here λ, α and β are parameters of the joint distribution.</p>

<p>Then (<em>X</em>,<em>T</em>) has a normal-gamma distribution, and this is denoted by</p>

<p>

<math display="block" id="Normal-gamma_distribution:8">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>X</mi>
     <mo>,</mo>
     <mi>T</mi>
     <mo stretchy="false">)</mo>
    </mrow>
    <mo>∼</mo>
    <mrow>
     <mi>NormalGamma</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>μ</mi>
      <mo>,</mo>
      <mi>λ</mi>
      <mo>,</mo>
      <mi>α</mi>
      <mo>,</mo>
      <mi>β</mi>
      <mo rspace="0.8pt" stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">similar-to</csymbol>
    <interval closure="open">
     <ci>X</ci>
     <ci>T</ci>
    </interval>
    <apply>
     <times></times>
     <ci>NormalGamma</ci>
     <vector>
      <ci>μ</ci>
      <ci>λ</ci>
      <ci>α</ci>
      <ci>β</ci>
     </vector>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (X,T)\sim\mathrm{NormalGamma}(\mu,\lambda,\alpha,\beta)\!.
  </annotation>
 </semantics>
</math>

</p>
<h2 id="properties">Properties</h2>
<h3 id="probability-density-function">Probability density function</h3>

<p>The joint <a href="probability_density_function" title="wikilink">probability density function</a> of (<em>X</em>,<em>T</em>) is</p>

<p>

<math display="block" id="Normal-gamma_distribution:9">
 <semantics>
  <mrow>
   <mi>f</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>x</mi>
    <mo>,</mo>
    <mi>τ</mi>
    <mo stretchy="false">|</mo>
    <mi>μ</mi>
    <mo>,</mo>
    <mi>λ</mi>
    <mo>,</mo>
    <mi>α</mi>
    <mo>,</mo>
    <mi>β</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>=</mo>
   <mpadded width="+1.7pt">
    <mfrac>
     <mrow>
      <msup>
       <mi>β</mi>
       <mi>α</mi>
      </msup>
      <msqrt>
       <mi>λ</mi>
      </msqrt>
     </mrow>
     <mrow>
      <mi mathvariant="normal">Γ</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>α</mi>
       <mo stretchy="false">)</mo>
      </mrow>
      <msqrt>
       <mrow>
        <mn>2</mn>
        <mi>π</mi>
       </mrow>
      </msqrt>
     </mrow>
    </mfrac>
   </mpadded>
   <mpadded width="+1.7pt">
    <msup>
     <mi>τ</mi>
     <mrow>
      <mi>α</mi>
      <mo>-</mo>
      <mfrac>
       <mn>1</mn>
       <mn>2</mn>
      </mfrac>
     </mrow>
    </msup>
   </mpadded>
   <mpadded width="+1.7pt">
    <msup>
     <mi>e</mi>
     <mrow>
      <mo>-</mo>
      <mrow>
       <mi>β</mi>
       <mi>τ</mi>
      </mrow>
     </mrow>
    </msup>
   </mpadded>
   <msup>
    <mi>e</mi>
    <mrow>
     <mo>-</mo>
     <mfrac>
      <mrow>
       <mi>λ</mi>
       <mi>τ</mi>
       <msup>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <mi>x</mi>
          <mo>-</mo>
          <mi>μ</mi>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
        <mn>2</mn>
       </msup>
      </mrow>
      <mn>2</mn>
     </mfrac>
    </mrow>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">f</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">x</csymbol>
     <ci>normal-,</ci>
     <csymbol cd="unknown">τ</csymbol>
     <ci>normal-|</ci>
     <csymbol cd="unknown">μ</csymbol>
     <ci>normal-,</ci>
     <csymbol cd="unknown">λ</csymbol>
     <ci>normal-,</ci>
     <csymbol cd="unknown">α</csymbol>
     <ci>normal-,</ci>
     <csymbol cd="unknown">β</csymbol>
     <ci>normal-)</ci>
    </cerror>
    <eq></eq>
    <apply>
     <divide></divide>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>β</ci>
       <ci>α</ci>
      </apply>
      <apply>
       <root></root>
       <ci>λ</ci>
      </apply>
     </apply>
     <apply>
      <times></times>
      <ci>normal-Γ</ci>
      <ci>α</ci>
      <apply>
       <root></root>
       <apply>
        <times></times>
        <cn type="integer">2</cn>
        <ci>π</ci>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>τ</ci>
     <apply>
      <minus></minus>
      <ci>α</ci>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>e</ci>
     <apply>
      <minus></minus>
      <apply>
       <times></times>
       <ci>β</ci>
       <ci>τ</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>e</ci>
     <apply>
      <minus></minus>
      <apply>
       <divide></divide>
       <apply>
        <times></times>
        <ci>λ</ci>
        <ci>τ</ci>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <minus></minus>
          <ci>x</ci>
          <ci>μ</ci>
         </apply>
         <cn type="integer">2</cn>
        </apply>
       </apply>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f(x,\tau|\mu,\lambda,\alpha,\beta)=\frac{\beta^{\alpha}\sqrt{\lambda}}{\Gamma(%
\alpha)\sqrt{2\pi}}\,\tau^{\alpha-\frac{1}{2}}\,e^{-\beta\tau}\,e^{-\frac{%
\lambda\tau(x-\mu)^{2}}{2}}
  </annotation>
 </semantics>
</math>

</p>
<h3 id="marginal-distributions">Marginal distributions</h3>

<p>By construction, the <a href="marginal_distribution" title="wikilink">marginal distribution</a> over 

<math display="inline" id="Normal-gamma_distribution:10">
 <semantics>
  <mi>τ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>τ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \tau
  </annotation>
 </semantics>
</math>

 is a <a href="gamma_distribution" title="wikilink">gamma distribution</a>, and the <a href="conditional_distribution" title="wikilink">conditional distribution</a> over 

<math display="inline" id="Normal-gamma_distribution:11">
 <semantics>
  <mi>x</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>x</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x
  </annotation>
 </semantics>
</math>

 given 

<math display="inline" id="Normal-gamma_distribution:12">
 <semantics>
  <mi>τ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>τ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \tau
  </annotation>
 </semantics>
</math>

 is a <a href="Gaussian_distribution" title="wikilink">Gaussian distribution</a>. The <a href="marginal_distribution" title="wikilink">marginal distribution</a> over 

<math display="inline" id="Normal-gamma_distribution:13">
 <semantics>
  <mi>x</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>x</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x
  </annotation>
 </semantics>
</math>

 is a three-parameter non-standardized <a href="Student's_t-distribution" title="wikilink">Student's t-distribution</a> with parameters 

<math display="inline" id="Normal-gamma_distribution:14">
 <semantics>
  <mrow>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>ν</mi>
    <mo>,</mo>
    <mi>μ</mi>
    <mo>,</mo>
    <msup>
     <mi>σ</mi>
     <mn>2</mn>
    </msup>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mo stretchy="false">(</mo>
    <mrow>
     <mn>2</mn>
     <mi>α</mi>
    </mrow>
    <mo>,</mo>
    <mi>μ</mi>
    <mo>,</mo>
    <mrow>
     <mi>β</mi>
     <mo>/</mo>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mi>λ</mi>
       <mi>α</mi>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <vector>
     <ci>ν</ci>
     <ci>μ</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>σ</ci>
      <cn type="integer">2</cn>
     </apply>
    </vector>
    <vector>
     <apply>
      <times></times>
      <cn type="integer">2</cn>
      <ci>α</ci>
     </apply>
     <ci>μ</ci>
     <apply>
      <divide></divide>
      <ci>β</ci>
      <apply>
       <times></times>
       <ci>λ</ci>
       <ci>α</ci>
      </apply>
     </apply>
    </vector>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (\nu,\mu,\sigma^{2})=(2\alpha,\mu,\beta/(\lambda\alpha))
  </annotation>
 </semantics>
</math>

.</p>
<h3 id="exponential-family">Exponential family</h3>

<p>The normal-gamma distribution is a four-parameter <a href="exponential_family" title="wikilink">exponential family</a> with <a href="natural_parameters" title="wikilink">natural parameters</a> 

<math display="inline" id="Normal-gamma_distribution:15">
 <semantics>
  <mrow>
   <mrow>
    <mi>α</mi>
    <mo>-</mo>
    <mrow>
     <mn>1</mn>
     <mo>/</mo>
     <mn>2</mn>
    </mrow>
   </mrow>
   <mo>,</mo>
   <mrow>
    <mrow>
     <mo>-</mo>
     <mi>β</mi>
    </mrow>
    <mo>-</mo>
    <mrow>
     <mrow>
      <mi>λ</mi>
      <msup>
       <mi>μ</mi>
       <mn>2</mn>
      </msup>
     </mrow>
     <mo>/</mo>
     <mn>2</mn>
    </mrow>
   </mrow>
   <mo>,</mo>
   <mrow>
    <mi>λ</mi>
    <mi>μ</mi>
   </mrow>
   <mo>,</mo>
   <mrow>
    <mo>-</mo>
    <mrow>
     <mi>λ</mi>
     <mo>/</mo>
     <mn>2</mn>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <list>
    <apply>
     <minus></minus>
     <ci>α</ci>
     <apply>
      <divide></divide>
      <cn type="integer">1</cn>
      <cn type="integer">2</cn>
     </apply>
    </apply>
    <apply>
     <minus></minus>
     <apply>
      <minus></minus>
      <ci>β</ci>
     </apply>
     <apply>
      <divide></divide>
      <apply>
       <times></times>
       <ci>λ</ci>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>μ</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
      <cn type="integer">2</cn>
     </apply>
    </apply>
    <apply>
     <times></times>
     <ci>λ</ci>
     <ci>μ</ci>
    </apply>
    <apply>
     <minus></minus>
     <apply>
      <divide></divide>
      <ci>λ</ci>
      <cn type="integer">2</cn>
     </apply>
    </apply>
   </list>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \alpha-1/2,-\beta-\lambda\mu^{2}/2,\lambda\mu,-\lambda/2
  </annotation>
 </semantics>
</math>

 and <a href="natural_statistics" title="wikilink">natural statistics</a> 

<math display="inline" id="Normal-gamma_distribution:16">
 <semantics>
  <mrow>
   <mrow>
    <mi>ln</mi>
    <mi>τ</mi>
   </mrow>
   <mo>,</mo>
   <mi>τ</mi>
   <mo>,</mo>
   <mrow>
    <mi>τ</mi>
    <mi>x</mi>
   </mrow>
   <mo>,</mo>
   <mrow>
    <mi>τ</mi>
    <msup>
     <mi>x</mi>
     <mn>2</mn>
    </msup>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <list>
    <apply>
     <ln></ln>
     <ci>τ</ci>
    </apply>
    <ci>τ</ci>
    <apply>
     <times></times>
     <ci>τ</ci>
     <ci>x</ci>
    </apply>
    <apply>
     <times></times>
     <ci>τ</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>x</ci>
      <cn type="integer">2</cn>
     </apply>
    </apply>
   </list>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \ln\tau,\tau,\tau x,\tau x^{2}
  </annotation>
 </semantics>
</math>

.</p>
<h3 id="moments-of-the-natural-statistics">Moments of the natural statistics</h3>

<p>The following moments can be easily computed using the <a href="exponential_family#Moment_generating_function_of_the_sufficient_statistic" title="wikilink">moment generating function of the sufficient statistic</a>:</p>

<p>

<math display="block" id="Normal-gamma_distribution:17">
 <semantics>
  <mrow>
   <mrow>
    <mo>E</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>ln</mi>
      <mi>T</mi>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mi>ψ</mi>
     <mrow>
      <mo>(</mo>
      <mi>α</mi>
      <mo>)</mo>
     </mrow>
    </mrow>
    <mo>-</mo>
    <mrow>
     <mi>ln</mi>
     <mi>β</mi>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <ci>normal-E</ci>
     <apply>
      <ln></ln>
      <ci>T</ci>
     </apply>
    </apply>
    <apply>
     <minus></minus>
     <apply>
      <times></times>
      <ci>ψ</ci>
      <ci>α</ci>
     </apply>
     <apply>
      <ln></ln>
      <ci>β</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \operatorname{E}(\ln T)=\psi\left(\alpha\right)-\ln\beta
  </annotation>
 </semantics>
</math>

, where 

<math display="inline" id="Normal-gamma_distribution:18">
 <semantics>
  <mrow>
   <mi>ψ</mi>
   <mrow>
    <mo>(</mo>
    <mi>α</mi>
    <mo>)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>ψ</ci>
    <ci>α</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \psi\left(\alpha\right)
  </annotation>
 </semantics>
</math>

 is the <a href="digamma_function" title="wikilink">digamma function</a>,</p>

<p>

<math display="block" id="Normal-gamma_distribution:19">
 <semantics>
  <mrow>
   <mrow>
    <mo>E</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>T</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mfrac>
    <mi>α</mi>
    <mi>β</mi>
   </mfrac>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <ci>normal-E</ci>
     <ci>T</ci>
    </apply>
    <apply>
     <divide></divide>
     <ci>α</ci>
     <ci>β</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \operatorname{E}(T)=\frac{\alpha}{\beta}
  </annotation>
 </semantics>
</math>

,</p>

<p>

<math display="block" id="Normal-gamma_distribution:20">
 <semantics>
  <mrow>
   <mrow>
    <mo>E</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>T</mi>
      <mi>X</mi>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mi>μ</mi>
    <mfrac>
     <mi>α</mi>
     <mi>β</mi>
    </mfrac>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <ci>normal-E</ci>
     <apply>
      <times></times>
      <ci>T</ci>
      <ci>X</ci>
     </apply>
    </apply>
    <apply>
     <times></times>
     <ci>μ</ci>
     <apply>
      <divide></divide>
      <ci>α</ci>
      <ci>β</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \operatorname{E}(TX)=\mu\frac{\alpha}{\beta}
  </annotation>
 </semantics>
</math>

,</p>

<p>

<math display="block" id="Normal-gamma_distribution:21">
 <semantics>
  <mrow>
   <mrow>
    <mo>E</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>T</mi>
      <msup>
       <mi>X</mi>
       <mn>2</mn>
      </msup>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mfrac>
     <mn>1</mn>
     <mi>λ</mi>
    </mfrac>
    <mo>+</mo>
    <mrow>
     <msup>
      <mi>μ</mi>
      <mn>2</mn>
     </msup>
     <mfrac>
      <mi>α</mi>
      <mi>β</mi>
     </mfrac>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <ci>normal-E</ci>
     <apply>
      <times></times>
      <ci>T</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>X</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <divide></divide>
      <cn type="integer">1</cn>
      <ci>λ</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>μ</ci>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <divide></divide>
       <ci>α</ci>
       <ci>β</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \operatorname{E}(TX^{2})=\frac{1}{\lambda}+\mu^{2}\frac{\alpha}{\beta}
  </annotation>
 </semantics>
</math>

.</p>
<h3 id="scaling">Scaling</h3>

<p>If 

<math display="inline" id="Normal-gamma_distribution:22">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>X</mi>
     <mo>,</mo>
     <mi>T</mi>
     <mo stretchy="false">)</mo>
    </mrow>
    <mo>∼</mo>
    <mrow>
     <mi>NormalGamma</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>μ</mi>
      <mo>,</mo>
      <mi>λ</mi>
      <mo>,</mo>
      <mi>α</mi>
      <mo>,</mo>
      <mi>β</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">similar-to</csymbol>
    <interval closure="open">
     <ci>X</ci>
     <ci>T</ci>
    </interval>
    <apply>
     <times></times>
     <ci>NormalGamma</ci>
     <vector>
      <ci>μ</ci>
      <ci>λ</ci>
      <ci>α</ci>
      <ci>β</ci>
     </vector>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (X,T)\sim\mathrm{NormalGamma}(\mu,\lambda,\alpha,\beta),
  </annotation>
 </semantics>
</math>

 then for any <em>b</em> &gt; 0, (<em>bX</em>,<em>bT</em>) is distributed as 

<math display="inline" id="Normal-gamma_distribution:23">
 <semantics>
  <mrow>
   <mrow>
    <mi>NormalGamma</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>b</mi>
      <mi>μ</mi>
     </mrow>
     <mo>,</mo>
     <mi>λ</mi>
     <mo>,</mo>
     <mi>α</mi>
     <mo>,</mo>
     <mrow>
      <msup>
       <mi>b</mi>
       <mn>2</mn>
      </msup>
      <mi>β</mi>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>NormalGamma</ci>
    <vector>
     <apply>
      <times></times>
      <ci>b</ci>
      <ci>μ</ci>
     </apply>
     <ci>λ</ci>
     <ci>α</ci>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>b</ci>
       <cn type="integer">2</cn>
      </apply>
      <ci>β</ci>
     </apply>
    </vector>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   {\rm NormalGamma}(b\mu,\lambda,\alpha,b^{2}\beta).
  </annotation>
 </semantics>
</math>

</p>
<h2 id="posterior-distribution-of-the-parameters">Posterior distribution of the parameters</h2>

<p>Assume that <em>x</em> is distributed according to a normal distribution with unknown mean 

<math display="inline" id="Normal-gamma_distribution:24">
 <semantics>
  <mi>μ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>μ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mu
  </annotation>
 </semantics>
</math>

 and precision 

<math display="inline" id="Normal-gamma_distribution:25">
 <semantics>
  <mi>τ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>τ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \tau
  </annotation>
 </semantics>
</math>

.</p>

<p>

<math display="block" id="Normal-gamma_distribution:26">
 <semantics>
  <mrow>
   <mi>x</mi>
   <mo>∼</mo>
   <mrow>
    <mi class="ltx_font_mathcaligraphic">𝒩</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>μ</mi>
     <mo>,</mo>
     <msup>
      <mi>τ</mi>
      <mrow>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
     </msup>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">similar-to</csymbol>
    <ci>x</ci>
    <apply>
     <times></times>
     <ci>𝒩</ci>
     <interval closure="open">
      <ci>μ</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>τ</ci>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
       </apply>
      </apply>
     </interval>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x\sim\mathcal{N}(\mu,\tau^{-1})
  </annotation>
 </semantics>
</math>

 and that the prior distribution on 

<math display="inline" id="Normal-gamma_distribution:27">
 <semantics>
  <mi>μ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>μ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mu
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Normal-gamma_distribution:28">
 <semantics>
  <mi>τ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>τ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \tau
  </annotation>
 </semantics>
</math>

, 

<math display="inline" id="Normal-gamma_distribution:29">
 <semantics>
  <mrow>
   <mo stretchy="false">(</mo>
   <mi>μ</mi>
   <mo>,</mo>
   <mi>τ</mi>
   <mo stretchy="false">)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <interval closure="open">
    <ci>μ</ci>
    <ci>τ</ci>
   </interval>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (\mu,\tau)
  </annotation>
 </semantics>
</math>

, has a normal-gamma distribution</p>

<p>

<math display="block" id="Normal-gamma_distribution:30">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>μ</mi>
     <mo>,</mo>
     <mi>τ</mi>
     <mo stretchy="false">)</mo>
    </mrow>
    <mo>∼</mo>
    <mrow>
     <mtext>NormalGamma</mtext>
     <mrow>
      <mo stretchy="false">(</mo>
      <msub>
       <mi>μ</mi>
       <mn>0</mn>
      </msub>
      <mo>,</mo>
      <msub>
       <mi>λ</mi>
       <mn>0</mn>
      </msub>
      <mo>,</mo>
      <msub>
       <mi>α</mi>
       <mn>0</mn>
      </msub>
      <mo>,</mo>
      <msub>
       <mi>β</mi>
       <mn>0</mn>
      </msub>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">similar-to</csymbol>
    <interval closure="open">
     <ci>μ</ci>
     <ci>τ</ci>
    </interval>
    <apply>
     <times></times>
     <mtext>NormalGamma</mtext>
     <vector>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>μ</ci>
       <cn type="integer">0</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>λ</ci>
       <cn type="integer">0</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>α</ci>
       <cn type="integer">0</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>β</ci>
       <cn type="integer">0</cn>
      </apply>
     </vector>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (\mu,\tau)\sim\text{NormalGamma}(\mu_{0},\lambda_{0},\alpha_{0},\beta_{0}),
  </annotation>
 </semantics>
</math>

</p>

<p>for which the density <em>π</em> satisfies</p>

<p>

<math display="block" id="Normal-gamma_distribution:31">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>π</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>μ</mi>
      <mo>,</mo>
      <mi>τ</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>∝</mo>
    <mrow>
     <mpadded width="+1.7pt">
      <msup>
       <mi>τ</mi>
       <mrow>
        <msub>
         <mi>α</mi>
         <mn>0</mn>
        </msub>
        <mo>-</mo>
        <mfrac>
         <mn>1</mn>
         <mn>2</mn>
        </mfrac>
       </mrow>
      </msup>
     </mpadded>
     <mrow>
      <mi>exp</mi>
      <mrow>
       <mo stretchy="false">[</mo>
       <mrow>
        <mo>-</mo>
        <mrow>
         <msub>
          <mi>β</mi>
          <mn>0</mn>
         </msub>
         <mi>τ</mi>
        </mrow>
       </mrow>
       <mo rspace="4.2pt" stretchy="false">]</mo>
      </mrow>
     </mrow>
     <mrow>
      <mi>exp</mi>
      <mrow>
       <mo stretchy="false">[</mo>
       <mrow>
        <mo>-</mo>
        <mfrac>
         <mrow>
          <msub>
           <mi>λ</mi>
           <mn>0</mn>
          </msub>
          <mi>τ</mi>
          <msup>
           <mrow>
            <mo stretchy="false">(</mo>
            <mrow>
             <mi>μ</mi>
             <mo>-</mo>
             <msub>
              <mi>μ</mi>
              <mn>0</mn>
             </msub>
            </mrow>
            <mo stretchy="false">)</mo>
           </mrow>
           <mn>2</mn>
          </msup>
         </mrow>
         <mn>2</mn>
        </mfrac>
       </mrow>
       <mo stretchy="false">]</mo>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">proportional-to</csymbol>
    <apply>
     <times></times>
     <ci>π</ci>
     <interval closure="open">
      <ci>μ</ci>
      <ci>τ</ci>
     </interval>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>τ</ci>
      <apply>
       <minus></minus>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>α</ci>
        <cn type="integer">0</cn>
       </apply>
       <apply>
        <divide></divide>
        <cn type="integer">1</cn>
        <cn type="integer">2</cn>
       </apply>
      </apply>
     </apply>
     <apply>
      <exp></exp>
      <apply>
       <minus></minus>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>β</ci>
         <cn type="integer">0</cn>
        </apply>
        <ci>τ</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <exp></exp>
      <apply>
       <minus></minus>
       <apply>
        <divide></divide>
        <apply>
         <times></times>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>λ</ci>
          <cn type="integer">0</cn>
         </apply>
         <ci>τ</ci>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <apply>
           <minus></minus>
           <ci>μ</ci>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <ci>μ</ci>
            <cn type="integer">0</cn>
           </apply>
          </apply>
          <cn type="integer">2</cn>
         </apply>
        </apply>
        <cn type="integer">2</cn>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \pi(\mu,\tau)\propto\tau^{\alpha_{0}-\frac{1}{2}}\,\exp[{-\beta_{0}\tau}]\,%
\exp[{-\frac{\lambda_{0}\tau(\mu-\mu_{0})^{2}}{2}}].
  </annotation>
 </semantics>
</math>

</p>

<p>Given a dataset 

<math display="inline" id="Normal-gamma_distribution:32">
 <semantics>
  <mi>𝐗</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>𝐗</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{X}
  </annotation>
 </semantics>
</math>

, consisting of 

<math display="inline" id="Normal-gamma_distribution:33">
 <semantics>
  <mi>n</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>n</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n
  </annotation>
 </semantics>
</math>

 <a href="independent_and_identically_distributed_random_variables" title="wikilink">independent and identically distributed random variables</a> (i.i.d), 

<math display="inline" id="Normal-gamma_distribution:34">
 <semantics>
  <mrow>
   <mo stretchy="false">{</mo>
   <msub>
    <mi>x</mi>
    <mn>1</mn>
   </msub>
   <mo>,</mo>
   <mi mathvariant="normal">…</mi>
   <mo>,</mo>
   <msub>
    <mi>x</mi>
    <mi>n</mi>
   </msub>
   <mo stretchy="false">}</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <set>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>x</ci>
     <cn type="integer">1</cn>
    </apply>
    <ci>normal-…</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>x</ci>
     <ci>n</ci>
    </apply>
   </set>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \{x_{1},...,x_{n}\}
  </annotation>
 </semantics>
</math>

, the posterior distribution of 

<math display="inline" id="Normal-gamma_distribution:35">
 <semantics>
  <mi>μ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>μ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mu
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Normal-gamma_distribution:36">
 <semantics>
  <mi>τ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>τ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \tau
  </annotation>
 </semantics>
</math>

 given this dataset can be analytically determined by <a href="Bayes'_theorem" title="wikilink">Bayes' theorem</a>. Explicitly,</p>

<p>

<math display="block" id="Normal-gamma_distribution:37">
 <semantics>
  <mrow>
   <mi>𝐏</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>τ</mi>
    <mo>,</mo>
    <mi>μ</mi>
    <mo stretchy="false">|</mo>
    <mi>𝐗</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>∝</mo>
   <mi>𝐋</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>𝐗</mi>
    <mo stretchy="false">|</mo>
    <mi>τ</mi>
    <mo>,</mo>
    <mi>μ</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mi>π</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>τ</mi>
    <mo>,</mo>
    <mi>μ</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">P</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">τ</csymbol>
     <ci>normal-,</ci>
     <csymbol cd="unknown">μ</csymbol>
     <ci>normal-|</ci>
     <csymbol cd="unknown">X</csymbol>
     <ci>normal-)</ci>
    </cerror>
    <csymbol cd="latexml">proportional-to</csymbol>
    <csymbol cd="unknown">L</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">X</csymbol>
     <ci>normal-|</ci>
     <csymbol cd="unknown">τ</csymbol>
     <ci>normal-,</ci>
     <csymbol cd="unknown">μ</csymbol>
     <ci>normal-)</ci>
    </cerror>
    <csymbol cd="unknown">π</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">τ</csymbol>
     <ci>normal-,</ci>
     <csymbol cd="unknown">μ</csymbol>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{P}(\tau,\mu|\mathbf{X})\propto\mathbf{L}(\mathbf{X}|\tau,\mu)\pi(\tau,\mu)
  </annotation>
 </semantics>
</math>

, where 

<math display="inline" id="Normal-gamma_distribution:38">
 <semantics>
  <mi>𝐋</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>𝐋</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{L}
  </annotation>
 </semantics>
</math>

 is the likelihood of the data given the parameters.</p>

<p>Since the data are i.i.d, the likelihood of the entire dataset is equal to the product of the likelihoods of the individual data samples:</p>

<p>

<math display="block" id="Normal-gamma_distribution:39">
 <semantics>
  <mrow>
   <mi>𝐋</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>𝐗</mi>
    <mo stretchy="false">|</mo>
    <mi>τ</mi>
    <mo>,</mo>
    <mi>μ</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>=</mo>
   <munderover>
    <mo largeop="true" movablelimits="false" symmetric="true">∏</mo>
    <mrow>
     <mi>i</mi>
     <mo>=</mo>
     <mn>1</mn>
    </mrow>
    <mi>n</mi>
   </munderover>
   <mi>𝐋</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>x</mi>
     <mi>i</mi>
    </msub>
    <mo stretchy="false">|</mo>
    <mi>τ</mi>
    <mo>,</mo>
    <mi>μ</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">L</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">X</csymbol>
     <ci>normal-|</ci>
     <csymbol cd="unknown">τ</csymbol>
     <ci>normal-,</ci>
     <csymbol cd="unknown">μ</csymbol>
     <ci>normal-)</ci>
    </cerror>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <csymbol cd="latexml">product</csymbol>
      <apply>
       <eq></eq>
       <ci>i</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <ci>n</ci>
    </apply>
    <csymbol cd="unknown">L</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <ci>i</ci>
     </apply>
     <ci>normal-|</ci>
     <csymbol cd="unknown">τ</csymbol>
     <ci>normal-,</ci>
     <csymbol cd="unknown">μ</csymbol>
     <ci>normal-)</ci>
    </cerror>
    <ci>normal-.</ci>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{L}(\mathbf{X}|\tau,\mu)=\prod_{i=1}^{n}\mathbf{L}(x_{i}|\tau,\mu).
  </annotation>
 </semantics>
</math>

</p>

<p>This expression can be simplified as follows:</p>

<p>

<math display="inline" id="Normal-gamma_distribution:40">
 <semantics>
  <mrow>
   <mi>𝐋</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>𝐗</mi>
    <mo stretchy="false">|</mo>
    <mi>τ</mi>
    <mo>,</mo>
    <mi>μ</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">L</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">X</csymbol>
     <ci>normal-|</ci>
     <csymbol cd="unknown">τ</csymbol>
     <ci>normal-,</ci>
     <csymbol cd="unknown">μ</csymbol>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle\mathbf{L}(\mathbf{X}|\tau,\mu)
  </annotation>
 </semantics>
</math>


</p>

<p>where 

<math display="inline" id="Normal-gamma_distribution:41">
 <semantics>
  <mrow>
   <mover accent="true">
    <mi>x</mi>
    <mo stretchy="false">¯</mo>
   </mover>
   <mo>=</mo>
   <mrow>
    <mfrac>
     <mn>1</mn>
     <mi>n</mi>
    </mfrac>
    <mrow>
     <msubsup>
      <mo largeop="true" symmetric="true">∑</mo>
      <mrow>
       <mi>i</mi>
       <mo>=</mo>
       <mn>1</mn>
      </mrow>
      <mi>n</mi>
     </msubsup>
     <msub>
      <mi>x</mi>
      <mi>i</mi>
     </msub>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <ci>normal-¯</ci>
     <ci>x</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <divide></divide>
      <cn type="integer">1</cn>
      <ci>n</ci>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <apply>
         <eq></eq>
         <ci>i</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <ci>n</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <ci>i</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \bar{x}=\frac{1}{n}\sum_{i=1}^{n}x_{i}
  </annotation>
 </semantics>
</math>

, the mean of the data samples, and 

<math display="inline" id="Normal-gamma_distribution:42">
 <semantics>
  <mrow>
   <mi>s</mi>
   <mo>=</mo>
   <mrow>
    <mfrac>
     <mn>1</mn>
     <mi>n</mi>
    </mfrac>
    <mrow>
     <msubsup>
      <mo largeop="true" symmetric="true">∑</mo>
      <mrow>
       <mi>i</mi>
       <mo>=</mo>
       <mn>1</mn>
      </mrow>
      <mi>n</mi>
     </msubsup>
     <msup>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <msub>
         <mi>x</mi>
         <mi>i</mi>
        </msub>
        <mo>-</mo>
        <mover accent="true">
         <mi>x</mi>
         <mo stretchy="false">¯</mo>
        </mover>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
      <mn>2</mn>
     </msup>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>s</ci>
    <apply>
     <times></times>
     <apply>
      <divide></divide>
      <cn type="integer">1</cn>
      <ci>n</ci>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <apply>
         <eq></eq>
         <ci>i</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <ci>n</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <minus></minus>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>x</ci>
         <ci>i</ci>
        </apply>
        <apply>
         <ci>normal-¯</ci>
         <ci>x</ci>
        </apply>
       </apply>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   s=\frac{1}{n}\sum_{i=1}^{n}(x_{i}-\bar{x})^{2}
  </annotation>
 </semantics>
</math>

, the sample variance.</p>

<p>The posterior distribution of the parameters is proportional to the prior times the likelihood.</p>

<p>

<math display="inline" id="Normal-gamma_distribution:43">
 <semantics>
  <mrow>
   <mi>𝐏</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>τ</mi>
    <mo>,</mo>
    <mi>μ</mi>
    <mo stretchy="false">|</mo>
    <mi>𝐗</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">P</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">τ</csymbol>
     <ci>normal-,</ci>
     <csymbol cd="unknown">μ</csymbol>
     <ci>normal-|</ci>
     <csymbol cd="unknown">X</csymbol>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle\mathbf{P}(\tau,\mu|\mathbf{X})
  </annotation>
 </semantics>
</math>


</p>

<p>The final exponential term is simplified by completing the square.</p>

<p>

<math display="inline" id="Normal-gamma_distribution:44">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>λ</mi>
     <mn>0</mn>
    </msub>
    <msup>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mi>μ</mi>
       <mo>-</mo>
       <msub>
        <mi>μ</mi>
        <mn>0</mn>
       </msub>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <mn>2</mn>
    </msup>
   </mrow>
   <mo>+</mo>
   <mrow>
    <mi>n</mi>
    <msup>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mover accent="true">
        <mi>x</mi>
        <mo stretchy="false">¯</mo>
       </mover>
       <mo>-</mo>
       <mi>μ</mi>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <mn>2</mn>
    </msup>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <plus></plus>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>λ</ci>
      <cn type="integer">0</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <minus></minus>
       <ci>μ</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>μ</ci>
        <cn type="integer">0</cn>
       </apply>
      </apply>
      <cn type="integer">2</cn>
     </apply>
    </apply>
    <apply>
     <times></times>
     <ci>n</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <minus></minus>
       <apply>
        <ci>normal-¯</ci>
        <ci>x</ci>
       </apply>
       <ci>μ</ci>
      </apply>
      <cn type="integer">2</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle\lambda_{0}(\mu-\mu_{0})^{2}+n(\bar{x}-\mu)^{2}
  </annotation>
 </semantics>
</math>


</p>

<p>On inserting this back into the expression above,</p>

<p>

<math display="inline" id="Normal-gamma_distribution:45">
 <semantics>
  <mrow>
   <mi>𝐏</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>τ</mi>
    <mo>,</mo>
    <mi>μ</mi>
    <mo stretchy="false">|</mo>
    <mi>𝐗</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">P</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">τ</csymbol>
     <ci>normal-,</ci>
     <csymbol cd="unknown">μ</csymbol>
     <ci>normal-|</ci>
     <csymbol cd="unknown">X</csymbol>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle\mathbf{P}(\tau,\mu|\mathbf{X})
  </annotation>
 </semantics>
</math>


</p>

<p>This final expression is in exactly the same form as a Normal-Gamma distribution, i.e.,</p>

<p>

<math display="block" id="Normal-gamma_distribution:46">
 <semantics>
  <mrow>
   <mi>𝐏</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>τ</mi>
    <mo>,</mo>
    <mi>μ</mi>
    <mo stretchy="false">|</mo>
    <mi>𝐗</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>=</mo>
   <mtext>NormalGamma</mtext>
   <mrow>
    <mo>(</mo>
    <mfrac>
     <mrow>
      <mrow>
       <msub>
        <mi>λ</mi>
        <mn>0</mn>
       </msub>
       <msub>
        <mi>μ</mi>
        <mn>0</mn>
       </msub>
      </mrow>
      <mo>+</mo>
      <mrow>
       <mi>n</mi>
       <mover accent="true">
        <mi>x</mi>
        <mo stretchy="false">¯</mo>
       </mover>
      </mrow>
     </mrow>
     <mrow>
      <msub>
       <mi>λ</mi>
       <mn>0</mn>
      </msub>
      <mo>+</mo>
      <mi>n</mi>
     </mrow>
    </mfrac>
    <mo>,</mo>
    <msub>
     <mi>λ</mi>
     <mn>0</mn>
    </msub>
    <mo>+</mo>
    <mi>n</mi>
    <mo>,</mo>
    <msub>
     <mi>α</mi>
     <mn>0</mn>
    </msub>
    <mo>+</mo>
    <mfrac>
     <mi>n</mi>
     <mn>2</mn>
    </mfrac>
    <mo>,</mo>
    <msub>
     <mi>β</mi>
     <mn>0</mn>
    </msub>
    <mo>+</mo>
    <mfrac>
     <mn>1</mn>
     <mn>2</mn>
    </mfrac>
    <mrow>
     <mo>(</mo>
     <mi>n</mi>
     <mi>s</mi>
     <mo>+</mo>
     <mfrac>
      <mrow>
       <msub>
        <mi>λ</mi>
        <mn>0</mn>
       </msub>
       <mi>n</mi>
       <msup>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <mover accent="true">
           <mi>x</mi>
           <mo stretchy="false">¯</mo>
          </mover>
          <mo>-</mo>
          <msub>
           <mi>μ</mi>
           <mn>0</mn>
          </msub>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
        <mn>2</mn>
       </msup>
      </mrow>
      <mrow>
       <msub>
        <mi>λ</mi>
        <mn>0</mn>
       </msub>
       <mo>+</mo>
       <mi>n</mi>
      </mrow>
     </mfrac>
     <mo>)</mo>
    </mrow>
    <mo>)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">P</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">τ</csymbol>
     <ci>normal-,</ci>
     <csymbol cd="unknown">μ</csymbol>
     <ci>normal-|</ci>
     <csymbol cd="unknown">X</csymbol>
     <ci>normal-)</ci>
    </cerror>
    <eq></eq>
    <mtext>NormalGamma</mtext>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <divide></divide>
      <apply>
       <plus></plus>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>λ</ci>
         <cn type="integer">0</cn>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>μ</ci>
         <cn type="integer">0</cn>
        </apply>
       </apply>
       <apply>
        <times></times>
        <ci>n</ci>
        <apply>
         <ci>normal-¯</ci>
         <ci>x</ci>
        </apply>
       </apply>
      </apply>
      <apply>
       <plus></plus>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>λ</ci>
        <cn type="integer">0</cn>
       </apply>
       <ci>n</ci>
      </apply>
     </apply>
     <ci>normal-,</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>λ</ci>
      <cn type="integer">0</cn>
     </apply>
     <plus></plus>
     <csymbol cd="unknown">n</csymbol>
     <ci>normal-,</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>α</ci>
      <cn type="integer">0</cn>
     </apply>
     <plus></plus>
     <apply>
      <divide></divide>
      <ci>n</ci>
      <cn type="integer">2</cn>
     </apply>
     <ci>normal-,</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>β</ci>
      <cn type="integer">0</cn>
     </apply>
     <plus></plus>
     <apply>
      <divide></divide>
      <cn type="integer">1</cn>
      <cn type="integer">2</cn>
     </apply>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <ci>normal-(</ci>
      <csymbol cd="unknown">n</csymbol>
      <csymbol cd="unknown">s</csymbol>
      <plus></plus>
      <apply>
       <divide></divide>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>λ</ci>
         <cn type="integer">0</cn>
        </apply>
        <ci>n</ci>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <minus></minus>
          <apply>
           <ci>normal-¯</ci>
           <ci>x</ci>
          </apply>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>μ</ci>
           <cn type="integer">0</cn>
          </apply>
         </apply>
         <cn type="integer">2</cn>
        </apply>
       </apply>
       <apply>
        <plus></plus>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>λ</ci>
         <cn type="integer">0</cn>
        </apply>
        <ci>n</ci>
       </apply>
      </apply>
      <ci>normal-)</ci>
     </cerror>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{P}(\tau,\mu|\mathbf{X})=\text{NormalGamma}\left(\frac{\lambda_{0}\mu_{%
0}+n\bar{x}}{\lambda_{0}+n},\lambda_{0}+n,\alpha_{0}+\frac{n}{2},\beta_{0}+%
\frac{1}{2}\left(ns+\frac{\lambda_{0}n(\bar{x}-\mu_{0})^{2}}{\lambda_{0}+n}%
\right)\right)
  </annotation>
 </semantics>
</math>

</p>
<h3 id="interpretation-of-parameters">Interpretation of parameters</h3>

<p>The interpretation of parameters in terms of pseudo-observations is as follows:</p>
<ul>
<li>The new mean takes a weighted average of the old pseudo-mean and the observed mean, weighted by the number of associated (pseudo-)observations.</li>
<li>The precision was estimated from 

<math display="inline" id="Normal-gamma_distribution:47">
 <semantics>
  <mrow>
   <mn>2</mn>
   <mi>α</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <cn type="integer">2</cn>
    <ci>α</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   2\alpha
  </annotation>
 </semantics>
</math>

 pseudo-observations (i.e. possibly a different number of pseudo-observations, to allow the variance of the mean and precision to be controlled separately) with sample mean 

<math display="inline" id="Normal-gamma_distribution:48">
 <semantics>
  <mi>μ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>μ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mu
  </annotation>
 </semantics>
</math>

 and sample variance 

<math display="inline" id="Normal-gamma_distribution:49">
 <semantics>
  <mfrac>
   <mi>β</mi>
   <mi>α</mi>
  </mfrac>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <divide></divide>
    <ci>β</ci>
    <ci>α</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \frac{\beta}{\alpha}
  </annotation>
 </semantics>
</math>

 (i.e. with sum of <a href="squared_deviations" title="wikilink">squared deviations</a> 

<math display="inline" id="Normal-gamma_distribution:50">
 <semantics>
  <mrow>
   <mn>2</mn>
   <mi>β</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <cn type="integer">2</cn>
    <ci>β</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   2\beta
  </annotation>
 </semantics>
</math>

).</li>
<li>The posterior updates the number of pseudo-observations (

<math display="inline" id="Normal-gamma_distribution:51">
 <semantics>
  <msub>
   <mi>λ</mi>
   <mn>0</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>λ</ci>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \lambda_{0}
  </annotation>
 </semantics>
</math>

) simply by adding up the corresponding number of new observations (

<math display="inline" id="Normal-gamma_distribution:52">
 <semantics>
  <mi>n</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>n</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n
  </annotation>
 </semantics>
</math>

).</li>
<li>The new sum of squared deviations is computed by adding the previous respective sums of squared deviations. However, a third "interaction term" is needed because the two sets of squared deviations were computed with respect to different means, and hence the sum of the two underestimates the actual total squared deviation.</li>
</ul>

<p>As a consequence, if one has a prior mean of 

<math display="inline" id="Normal-gamma_distribution:53">
 <semantics>
  <msub>
   <mi>μ</mi>
   <mn>0</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>μ</ci>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mu_{0}
  </annotation>
 </semantics>
</math>

 from 

<math display="inline" id="Normal-gamma_distribution:54">
 <semantics>
  <msub>
   <mi>n</mi>
   <mi>μ</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>n</ci>
    <ci>μ</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n_{\mu}
  </annotation>
 </semantics>
</math>

 samples and a prior precision of 

<math display="inline" id="Normal-gamma_distribution:55">
 <semantics>
  <msub>
   <mi>τ</mi>
   <mn>0</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>τ</ci>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \tau_{0}
  </annotation>
 </semantics>
</math>

 from 

<math display="inline" id="Normal-gamma_distribution:56">
 <semantics>
  <msub>
   <mi>n</mi>
   <mi>τ</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>n</ci>
    <ci>τ</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n_{\tau}
  </annotation>
 </semantics>
</math>

 samples, the prior distribution over 

<math display="inline" id="Normal-gamma_distribution:57">
 <semantics>
  <mi>μ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>μ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mu
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Normal-gamma_distribution:58">
 <semantics>
  <mi>τ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>τ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \tau
  </annotation>
 </semantics>
</math>

 is</p>

<p>

<math display="block" id="Normal-gamma_distribution:59">
 <semantics>
  <mrow>
   <mi>𝐏</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>τ</mi>
    <mo>,</mo>
    <mi>μ</mi>
    <mo stretchy="false">|</mo>
    <mi>𝐗</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>=</mo>
   <mtext>NormalGamma</mtext>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>μ</mi>
     <mn>0</mn>
    </msub>
    <mo>,</mo>
    <msub>
     <mi>n</mi>
     <mi>μ</mi>
    </msub>
    <mo>,</mo>
    <mfrac>
     <msub>
      <mi>n</mi>
      <mi>τ</mi>
     </msub>
     <mn>2</mn>
    </mfrac>
    <mo>,</mo>
    <mfrac>
     <msub>
      <mi>n</mi>
      <mi>τ</mi>
     </msub>
     <mrow>
      <mn>2</mn>
      <msub>
       <mi>τ</mi>
       <mn>0</mn>
      </msub>
     </mrow>
    </mfrac>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">P</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">τ</csymbol>
     <ci>normal-,</ci>
     <csymbol cd="unknown">μ</csymbol>
     <ci>normal-|</ci>
     <csymbol cd="unknown">X</csymbol>
     <ci>normal-)</ci>
    </cerror>
    <eq></eq>
    <mtext>NormalGamma</mtext>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>μ</ci>
      <cn type="integer">0</cn>
     </apply>
     <ci>normal-,</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>n</ci>
      <ci>μ</ci>
     </apply>
     <ci>normal-,</ci>
     <apply>
      <divide></divide>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>n</ci>
       <ci>τ</ci>
      </apply>
      <cn type="integer">2</cn>
     </apply>
     <ci>normal-,</ci>
     <apply>
      <divide></divide>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>n</ci>
       <ci>τ</ci>
      </apply>
      <apply>
       <times></times>
       <cn type="integer">2</cn>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>τ</ci>
        <cn type="integer">0</cn>
       </apply>
      </apply>
     </apply>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{P}(\tau,\mu|\mathbf{X})=\text{NormalGamma}(\mu_{0},n_{\mu},\frac{n_{%
\tau}}{2},\frac{n_{\tau}}{2\tau_{0}})
  </annotation>
 </semantics>
</math>

</p>

<p>and after observing 

<math display="inline" id="Normal-gamma_distribution:60">
 <semantics>
  <mi>n</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>n</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n
  </annotation>
 </semantics>
</math>

 samples with mean 

<math display="inline" id="Normal-gamma_distribution:61">
 <semantics>
  <mi>μ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>μ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mu
  </annotation>
 </semantics>
</math>

 and variance 

<math display="inline" id="Normal-gamma_distribution:62">
 <semantics>
  <mi>s</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>s</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   s
  </annotation>
 </semantics>
</math>

, the posterior probability is</p>

<p>

<math display="block" id="Normal-gamma_distribution:63">
 <semantics>
  <mrow>
   <mi>𝐏</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>τ</mi>
    <mo>,</mo>
    <mi>μ</mi>
    <mo stretchy="false">|</mo>
    <mi>𝐗</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>=</mo>
   <mtext>NormalGamma</mtext>
   <mrow>
    <mo>(</mo>
    <mfrac>
     <mrow>
      <mrow>
       <msub>
        <mi>n</mi>
        <mi>μ</mi>
       </msub>
       <msub>
        <mi>μ</mi>
        <mn>0</mn>
       </msub>
      </mrow>
      <mo>+</mo>
      <mrow>
       <mi>n</mi>
       <mi>μ</mi>
      </mrow>
     </mrow>
     <mrow>
      <msub>
       <mi>n</mi>
       <mi>μ</mi>
      </msub>
      <mo>+</mo>
      <mi>n</mi>
     </mrow>
    </mfrac>
    <mo>,</mo>
    <msub>
     <mi>n</mi>
     <mi>μ</mi>
    </msub>
    <mo>+</mo>
    <mi>n</mi>
    <mo>,</mo>
    <mfrac>
     <mn>1</mn>
     <mn>2</mn>
    </mfrac>
    <mrow>
     <mo stretchy="false">(</mo>
     <msub>
      <mi>n</mi>
      <mi>τ</mi>
     </msub>
     <mo>+</mo>
     <mi>n</mi>
     <mo stretchy="false">)</mo>
    </mrow>
    <mo>,</mo>
    <mfrac>
     <mn>1</mn>
     <mn>2</mn>
    </mfrac>
    <mrow>
     <mo>(</mo>
     <mfrac>
      <msub>
       <mi>n</mi>
       <mi>τ</mi>
      </msub>
      <msub>
       <mi>τ</mi>
       <mn>0</mn>
      </msub>
     </mfrac>
     <mo>+</mo>
     <mi>n</mi>
     <mi>s</mi>
     <mo>+</mo>
     <mfrac>
      <mrow>
       <msub>
        <mi>n</mi>
        <mi>μ</mi>
       </msub>
       <mi>n</mi>
       <msup>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <mi>μ</mi>
          <mo>-</mo>
          <msub>
           <mi>μ</mi>
           <mn>0</mn>
          </msub>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
        <mn>2</mn>
       </msup>
      </mrow>
      <mrow>
       <msub>
        <mi>n</mi>
        <mi>μ</mi>
       </msub>
       <mo>+</mo>
       <mi>n</mi>
      </mrow>
     </mfrac>
     <mo>)</mo>
    </mrow>
    <mo>)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">P</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">τ</csymbol>
     <ci>normal-,</ci>
     <csymbol cd="unknown">μ</csymbol>
     <ci>normal-|</ci>
     <csymbol cd="unknown">X</csymbol>
     <ci>normal-)</ci>
    </cerror>
    <eq></eq>
    <mtext>NormalGamma</mtext>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <divide></divide>
      <apply>
       <plus></plus>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>n</ci>
         <ci>μ</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>μ</ci>
         <cn type="integer">0</cn>
        </apply>
       </apply>
       <apply>
        <times></times>
        <ci>n</ci>
        <ci>μ</ci>
       </apply>
      </apply>
      <apply>
       <plus></plus>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>n</ci>
        <ci>μ</ci>
       </apply>
       <ci>n</ci>
      </apply>
     </apply>
     <ci>normal-,</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>n</ci>
      <ci>μ</ci>
     </apply>
     <plus></plus>
     <csymbol cd="unknown">n</csymbol>
     <ci>normal-,</ci>
     <apply>
      <divide></divide>
      <cn type="integer">1</cn>
      <cn type="integer">2</cn>
     </apply>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <ci>normal-(</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>n</ci>
       <ci>τ</ci>
      </apply>
      <plus></plus>
      <csymbol cd="unknown">n</csymbol>
      <ci>normal-)</ci>
     </cerror>
     <ci>normal-,</ci>
     <apply>
      <divide></divide>
      <cn type="integer">1</cn>
      <cn type="integer">2</cn>
     </apply>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <ci>normal-(</ci>
      <apply>
       <divide></divide>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>n</ci>
        <ci>τ</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>τ</ci>
        <cn type="integer">0</cn>
       </apply>
      </apply>
      <plus></plus>
      <csymbol cd="unknown">n</csymbol>
      <csymbol cd="unknown">s</csymbol>
      <plus></plus>
      <apply>
       <divide></divide>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>n</ci>
         <ci>μ</ci>
        </apply>
        <ci>n</ci>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <minus></minus>
          <ci>μ</ci>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>μ</ci>
           <cn type="integer">0</cn>
          </apply>
         </apply>
         <cn type="integer">2</cn>
        </apply>
       </apply>
       <apply>
        <plus></plus>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>n</ci>
         <ci>μ</ci>
        </apply>
        <ci>n</ci>
       </apply>
      </apply>
      <ci>normal-)</ci>
     </cerror>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{P}(\tau,\mu|\mathbf{X})=\text{NormalGamma}\left(\frac{n_{\mu}\mu_{0}+n%
\mu}{n_{\mu}+n},n_{\mu}+n,\frac{1}{2}(n_{\tau}+n),\frac{1}{2}\left(\frac{n_{%
\tau}}{\tau_{0}}+ns+\frac{n_{\mu}n(\mu-\mu_{0})^{2}}{n_{\mu}+n}\right)\right)
  </annotation>
 </semantics>
</math>

</p>

<p>Note that in some programming languages, such as <a class="uri" href="Matlab" title="wikilink">Matlab</a>, the gamma distribution is implemented with the inverse definition of 

<math display="inline" id="Normal-gamma_distribution:64">
 <semantics>
  <mi>β</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>β</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \beta
  </annotation>
 </semantics>
</math>

, so the fourth argument of the Normal-Gamma distribution is 

<math display="inline" id="Normal-gamma_distribution:65">
 <semantics>
  <mrow>
   <mrow>
    <mn>2</mn>
    <msub>
     <mi>τ</mi>
     <mn>0</mn>
    </msub>
   </mrow>
   <mo>/</mo>
   <msub>
    <mi>n</mi>
    <mi>τ</mi>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <divide></divide>
    <apply>
     <times></times>
     <cn type="integer">2</cn>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>τ</ci>
      <cn type="integer">0</cn>
     </apply>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>n</ci>
     <ci>τ</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   2\tau_{0}/n_{\tau}
  </annotation>
 </semantics>
</math>

.</p>
<h2 id="generating-normal-gamma-random-variates">Generating normal-gamma random variates</h2>

<p>Generation of random variates is straightforward:</p>
<ol>
<li>Sample 

<math display="inline" id="Normal-gamma_distribution:66">
 <semantics>
  <mi>τ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>τ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \tau
  </annotation>
 </semantics>
</math>

 from a gamma distribution with parameters 

<math display="inline" id="Normal-gamma_distribution:67">
 <semantics>
  <mi>α</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>α</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \alpha
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Normal-gamma_distribution:68">
 <semantics>
  <mi>β</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>β</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \beta
  </annotation>
 </semantics>
</math>

</li>
<li>Sample 

<math display="inline" id="Normal-gamma_distribution:69">
 <semantics>
  <mi>x</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>x</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x
  </annotation>
 </semantics>
</math>

 from a normal distribution with mean 

<math display="inline" id="Normal-gamma_distribution:70">
 <semantics>
  <mi>μ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>μ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mu
  </annotation>
 </semantics>
</math>

 and variance 

<math display="inline" id="Normal-gamma_distribution:71">
 <semantics>
  <mrow>
   <mn>1</mn>
   <mo>/</mo>
   <mrow>
    <mo stretchy="false">(</mo>
    <mrow>
     <mi>λ</mi>
     <mi>τ</mi>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <divide></divide>
    <cn type="integer">1</cn>
    <apply>
     <times></times>
     <ci>λ</ci>
     <ci>τ</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   1/(\lambda\tau)
  </annotation>
 </semantics>
</math>

</li>
</ol>
<h2 id="related-distributions">Related distributions</h2>
<ul>
<li>The <a href="normal-inverse-gamma_distribution" title="wikilink">normal-inverse-gamma distribution</a> is essentially the same distribution parameterized by variance rather than precision</li>
<li>The <a href="normal-exponential-gamma_distribution" title="wikilink">normal-exponential-gamma distribution</a></li>
</ul>
<h2 id="notes">Notes</h2>
<h2 id="references">References</h2>
<ul>
<li>Bernardo, J.M.; Smith, A.F.M. (1993) <em>Bayesian Theory</em>, Wiley. ISBN 0-471-49464-X</li>
<li>Dearden et al. <a href="http://www.aaai.org/Papers/AAAI/1998/AAAI98-108.pdf">"Bayesian Q-learning"</a>, <em>Proceedings of the Fifteenth National Conference on Artificial Intelligence (AAAI-98)</em>, July 26–30, 1998, Madison, Wisconsin, USA.</li>
</ul>

<p>"</p>

<p><a href="Category:Multivariate_continuous_distributions" title="wikilink">Category:Multivariate continuous distributions</a> <a href="Category:Conjugate_prior_distributions" title="wikilink">Category:Conjugate prior distributions</a> <a href="Category:Normal_distribution" title="wikilink">Category:Normal distribution</a> <a href="Category:Probability_distributions" title="wikilink">Category:Probability distributions</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1"><code>Bernardo</code> <code>&amp;</code> <code>Smith</code> <code>(1993,</code> <code>p.434)</code><a href="#fnref1">↩</a></li>
<li id="fn2"></li>
<li id="fn3">Bernardo &amp; Smith (1993, pages 136, 268, 434)<a href="#fnref3">↩</a></li>
</ol>
</section>
</body>
</html>

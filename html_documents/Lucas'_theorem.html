<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="1768">Lucas' theorem</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Lucas' theorem</h1>
<hr/>

<p>In <a href="number_theory" title="wikilink">number theory</a>, <strong>Lucas's theorem</strong> expresses the <a class="uri" href="remainder" title="wikilink">remainder</a> of division of the <a href="binomial_coefficient" title="wikilink">binomial coefficient</a> 

<math display="inline" id="Lucas'_theorem:0">
 <semantics>
  <mrow>
   <mo>(</mo>
   <mstyle scriptlevel="+1">
    <mtable columnspacing="0.4em" rowspacing="0.2ex">
     <mtr>
      <mtd>
       <mi>m</mi>
      </mtd>
     </mtr>
     <mtr>
      <mtd>
       <mi>n</mi>
      </mtd>
     </mtr>
    </mtable>
   </mstyle>
   <mo>)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">binomial</csymbol>
    <ci>m</ci>
    <ci>n</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   {\textstyle\left({{m}\atop{n}}\right)}
  </annotation>
 </semantics>
</math>

 by a <a href="prime_number" title="wikilink">prime number</a> <em>p</em> in terms of the <a href="radix" title="wikilink">base</a> <em>p</em> expansions of the integers <em>m</em> and <em>n</em>.</p>

<p>Lucas's theorem first appeared in 1878 in papers by <a href="Édouard_Lucas" title="wikilink">Édouard Lucas</a>.<ref></ref></p>
<ul>
<li>

<p>(part 1);</p></li>
<li>

<p>(part 2);</p></li>
<li>

<p>(part 3)</p></li>
</ul>
<h2 id="formulation">Formulation</h2>

<p>For non-negative integers <em>m</em> and <em>n</em> and a prime <em>p</em>, the following <a href="modular_arithmetic" title="wikilink">congruence relation</a> holds:</p>

<p>

<math display="block" id="Lucas'_theorem:1">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mo>(</mo>
     <mtable columnspacing="0.4em" rowspacing="0.2ex">
      <mtr>
       <mtd>
        <mi>m</mi>
       </mtd>
      </mtr>
      <mtr>
       <mtd>
        <mi>n</mi>
       </mtd>
      </mtr>
     </mtable>
     <mo>)</mo>
    </mrow>
    <mo>≡</mo>
    <mrow>
     <mrow>
      <munderover>
       <mo largeop="true" movablelimits="false" symmetric="true">∏</mo>
       <mrow>
        <mi>i</mi>
        <mo>=</mo>
        <mn>0</mn>
       </mrow>
       <mi>k</mi>
      </munderover>
      <mrow>
       <mo>(</mo>
       <mtable columnspacing="0.4em" rowspacing="0.2ex">
        <mtr>
         <mtd>
          <msub>
           <mi>m</mi>
           <mi>i</mi>
          </msub>
         </mtd>
        </mtr>
        <mtr>
         <mtd>
          <msub>
           <mi>n</mi>
           <mi>i</mi>
          </msub>
         </mtd>
        </mtr>
       </mtable>
       <mo>)</mo>
      </mrow>
     </mrow>
     <mspace width="veryverythickmathspace">
     </mspace>
     <mrow>
      <mo lspace="8.1pt" stretchy="false">(</mo>
      <mrow>
       <mo>mod</mo>
       <mi>p</mi>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <equivalent></equivalent>
    <apply>
     <csymbol cd="latexml">binomial</csymbol>
     <ci>m</ci>
     <ci>n</ci>
    </apply>
    <apply>
     <csymbol cd="latexml">annotated</csymbol>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <csymbol cd="latexml">product</csymbol>
        <apply>
         <eq></eq>
         <ci>i</ci>
         <cn type="integer">0</cn>
        </apply>
       </apply>
       <ci>k</ci>
      </apply>
      <apply>
       <csymbol cd="latexml">binomial</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>m</ci>
        <ci>i</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>n</ci>
        <ci>i</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <ci>pmod</ci>
      <ci>p</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   {\left({{m}\atop{n}}\right)}\equiv\prod_{i=0}^{k}{\left({{m_{i}}\atop{n_{i}}}%
\right)}\;\;(\mathop{{\rm mod}}p),
  </annotation>
 </semantics>
</math>

 where</p>

<p>

<math display="block" id="Lucas'_theorem:2">
 <semantics>
  <mrow>
   <mrow>
    <mi>m</mi>
    <mo>=</mo>
    <mrow>
     <mrow>
      <msub>
       <mi>m</mi>
       <mi>k</mi>
      </msub>
      <msup>
       <mi>p</mi>
       <mi>k</mi>
      </msup>
     </mrow>
     <mo>+</mo>
     <mrow>
      <msub>
       <mi>m</mi>
       <mrow>
        <mi>k</mi>
        <mo>-</mo>
        <mn>1</mn>
       </mrow>
      </msub>
      <msup>
       <mi>p</mi>
       <mrow>
        <mi>k</mi>
        <mo>-</mo>
        <mn>1</mn>
       </mrow>
      </msup>
     </mrow>
     <mo>+</mo>
     <mi mathvariant="normal">⋯</mi>
     <mo>+</mo>
     <mrow>
      <msub>
       <mi>m</mi>
       <mn>1</mn>
      </msub>
      <mi>p</mi>
     </mrow>
     <mo>+</mo>
     <msub>
      <mi>m</mi>
      <mn>0</mn>
     </msub>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>m</ci>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>m</ci>
       <ci>k</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>p</ci>
       <ci>k</ci>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>m</ci>
       <apply>
        <minus></minus>
        <ci>k</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>p</ci>
       <apply>
        <minus></minus>
        <ci>k</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
     </apply>
     <ci>normal-⋯</ci>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>m</ci>
       <cn type="integer">1</cn>
      </apply>
      <ci>p</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>m</ci>
      <cn type="integer">0</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   m=m_{k}p^{k}+m_{k-1}p^{k-1}+\cdots+m_{1}p+m_{0},
  </annotation>
 </semantics>
</math>

 and</p>

<p>

<math display="block" id="Lucas'_theorem:3">
 <semantics>
  <mrow>
   <mi>n</mi>
   <mo>=</mo>
   <mrow>
    <mrow>
     <msub>
      <mi>n</mi>
      <mi>k</mi>
     </msub>
     <msup>
      <mi>p</mi>
      <mi>k</mi>
     </msup>
    </mrow>
    <mo>+</mo>
    <mrow>
     <msub>
      <mi>n</mi>
      <mrow>
       <mi>k</mi>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
     </msub>
     <msup>
      <mi>p</mi>
      <mrow>
       <mi>k</mi>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
     </msup>
    </mrow>
    <mo>+</mo>
    <mi mathvariant="normal">⋯</mi>
    <mo>+</mo>
    <mrow>
     <msub>
      <mi>n</mi>
      <mn>1</mn>
     </msub>
     <mi>p</mi>
    </mrow>
    <mo>+</mo>
    <msub>
     <mi>n</mi>
     <mn>0</mn>
    </msub>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>n</ci>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>n</ci>
       <ci>k</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>p</ci>
       <ci>k</ci>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>n</ci>
       <apply>
        <minus></minus>
        <ci>k</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>p</ci>
       <apply>
        <minus></minus>
        <ci>k</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
     </apply>
     <ci>normal-⋯</ci>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>n</ci>
       <cn type="integer">1</cn>
      </apply>
      <ci>p</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>n</ci>
      <cn type="integer">0</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n=n_{k}p^{k}+n_{k-1}p^{k-1}+\cdots+n_{1}p+n_{0}
  </annotation>
 </semantics>
</math>

 are the base <em>p</em> expansions of <em>m</em> and <em>n</em> respectively. This uses the convention that 

<math display="inline" id="Lucas'_theorem:4">
 <semantics>
  <mrow>
   <mo>(</mo>
   <mstyle scriptlevel="+1">
    <mtable columnspacing="0.4em" rowspacing="0.2ex">
     <mtr>
      <mtd>
       <mi>m</mi>
      </mtd>
     </mtr>
     <mtr>
      <mtd>
       <mi>n</mi>
      </mtd>
     </mtr>
    </mtable>
   </mstyle>
   <mo>)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">binomial</csymbol>
    <ci>m</ci>
    <ci>n</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   {\textstyle\left({{m}\atop{n}}\right)}
  </annotation>
 </semantics>
</math>

 = 0 if <em>m</em> \tbinom{m}{n} is divisible by a prime <em>p</em> if and only if at least one of the base <em>p</em> digits of <em>n</em> is greater than the corresponding digit of <em>m</em>.</p>
<h2 id="proof">Proof</h2>

<p>There are several ways to prove Lucas's theorem. We first give a combinatorial argument and then a proof based on generating functions.</p>

<p>Let <em>M</em> be a set with <em>m</em> elements, and divide it into <em>m<sub>i</sub></em> cycles of length <em>p<sup>i</sup></em> for the various values of <em>i</em>. Then each of these cycles can be rotated separately, so that a group <em>G</em> which is the Cartesian product of cyclic groups <em>C<sub>p<sup>i</sup></sub></em> acts on <em>M</em>. It thus also acts on subsets <em>N</em> of size <em>n</em>. Since the number of elements in <em>G</em> is a power of <em>p</em>, the same is true of any of its orbits. Thus in order to compute 

<math display="inline" id="Lucas'_theorem:5">
 <semantics>
  <mrow>
   <mo>(</mo>
   <mstyle scriptlevel="+1">
    <mtable columnspacing="0.4em" rowspacing="0.2ex">
     <mtr>
      <mtd>
       <mi>m</mi>
      </mtd>
     </mtr>
     <mtr>
      <mtd>
       <mi>n</mi>
      </mtd>
     </mtr>
    </mtable>
   </mstyle>
   <mo>)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">binomial</csymbol>
    <ci>m</ci>
    <ci>n</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   {\textstyle\left({{m}\atop{n}}\right)}
  </annotation>
 </semantics>
</math>

 modulo <em>p</em>, we only need to consider fixed points of this group action. The fixed points are those subsets <em>N</em> that are a union of some of the cycles. More precisely one can show by induction on <em>k</em>-<em>i</em>, that <em>N</em> must have exactly <em>n<sub>i</sub></em> cycles of size <em>p<sup>i</sup></em>. Thus the number of choices for <em>N</em> is exactly 

<math display="inline" id="Lucas'_theorem:6">
 <semantics>
  <mrow>
   <mrow>
    <msubsup>
     <mo largeop="true" symmetric="true">∏</mo>
     <mrow>
      <mi>i</mi>
      <mo>=</mo>
      <mn>0</mn>
     </mrow>
     <mi>k</mi>
    </msubsup>
    <mrow>
     <mo>(</mo>
     <mstyle scriptlevel="+1">
      <mtable columnspacing="0.4em" rowspacing="0.2ex">
       <mtr>
        <mtd>
         <msub>
          <mi>m</mi>
          <mi>i</mi>
         </msub>
        </mtd>
       </mtr>
       <mtr>
        <mtd>
         <msub>
          <mi>n</mi>
          <mi>i</mi>
         </msub>
        </mtd>
       </mtr>
      </mtable>
     </mstyle>
     <mo>)</mo>
    </mrow>
   </mrow>
   <mspace width="veryverythickmathspace">
   </mspace>
   <mrow>
    <mo lspace="8.1pt" stretchy="false">(</mo>
    <mrow>
     <mo>mod</mo>
     <mi>p</mi>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">annotated</csymbol>
    <apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <csymbol cd="latexml">product</csymbol>
       <apply>
        <eq></eq>
        <ci>i</ci>
        <cn type="integer">0</cn>
       </apply>
      </apply>
      <ci>k</ci>
     </apply>
     <apply>
      <csymbol cd="latexml">binomial</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>m</ci>
       <ci>i</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>n</ci>
       <ci>i</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <ci>pmod</ci>
     <ci>p</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \prod_{i=0}^{k}{\left({{m_{i}}\atop{n_{i}}}\right)}\;\;(\mathop{{\rm mod}}p)
  </annotation>
 </semantics>
</math>

.</p>

<p>Here is a proof based on generating functions, due to Nathan Fine.<a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a></p>

<p>If <em>p</em> is a prime and <em>n</em> is an integer with 1≤<em>n</em>≤<em>p</em>-1, then the numerator of the binomial coefficient</p>

<p>

<math display="block" id="Lucas'_theorem:7">
 <semantics>
  <mrow>
   <mrow>
    <mo>(</mo>
    <mtable columnspacing="0.4em" rowspacing="0.2ex">
     <mtr>
      <mtd>
       <mi>p</mi>
      </mtd>
     </mtr>
     <mtr>
      <mtd>
       <mi>n</mi>
      </mtd>
     </mtr>
    </mtable>
    <mo>)</mo>
   </mrow>
   <mo>=</mo>
   <mfrac>
    <mrow>
     <mrow>
      <mi>p</mi>
      <mo>⋅</mo>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mi>p</mi>
        <mo>-</mo>
        <mn>1</mn>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mi mathvariant="normal">⋯</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mrow>
        <mi>p</mi>
        <mo>-</mo>
        <mi>n</mi>
       </mrow>
       <mo>+</mo>
       <mn>1</mn>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mrow>
     <mrow>
      <mi>n</mi>
      <mo>⋅</mo>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mi>n</mi>
        <mo>-</mo>
        <mn>1</mn>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mi mathvariant="normal">⋯</mi>
     <mn>1</mn>
    </mrow>
   </mfrac>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="latexml">binomial</csymbol>
     <ci>p</ci>
     <ci>n</ci>
    </apply>
    <apply>
     <divide></divide>
     <apply>
      <times></times>
      <apply>
       <ci>normal-⋅</ci>
       <ci>p</ci>
       <apply>
        <minus></minus>
        <ci>p</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <ci>normal-⋯</ci>
      <apply>
       <plus></plus>
       <apply>
        <minus></minus>
        <ci>p</ci>
        <ci>n</ci>
       </apply>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <ci>normal-⋅</ci>
       <ci>n</ci>
       <apply>
        <minus></minus>
        <ci>n</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <ci>normal-⋯</ci>
      <cn type="integer">1</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   {\left({{p}\atop{n}}\right)}=\frac{p\cdot(p-1)\cdots(p-n+1)}{n\cdot(n-1)\cdots
1}
  </annotation>
 </semantics>
</math>

 is divisible by <em>p</em> but the denominator is not. Hence <em>p</em> divides 

<math display="inline" id="Lucas'_theorem:8">
 <semantics>
  <mrow>
   <mo>(</mo>
   <mstyle scriptlevel="+1">
    <mtable columnspacing="0.4em" rowspacing="0.2ex">
     <mtr>
      <mtd>
       <mi>p</mi>
      </mtd>
     </mtr>
     <mtr>
      <mtd>
       <mi>n</mi>
      </mtd>
     </mtr>
    </mtable>
   </mstyle>
   <mo>)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">binomial</csymbol>
    <ci>p</ci>
    <ci>n</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   {\textstyle\left({{p}\atop{n}}\right)}
  </annotation>
 </semantics>
</math>

. In terms of ordinary generating functions, this means that</p>

<p>

<math display="block" id="Lucas'_theorem:9">
 <semantics>
  <mrow>
   <mrow>
    <msup>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mn>1</mn>
       <mo>+</mo>
       <mi>X</mi>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <mi>p</mi>
    </msup>
    <mo>≡</mo>
    <mrow>
     <mn>1</mn>
     <mo>+</mo>
     <mrow>
      <msup>
       <mi>X</mi>
       <mi>p</mi>
      </msup>
      <mtext>mod</mtext>
      <mi>p</mi>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <equivalent></equivalent>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <plus></plus>
      <cn type="integer">1</cn>
      <ci>X</ci>
     </apply>
     <ci>p</ci>
    </apply>
    <apply>
     <plus></plus>
     <cn type="integer">1</cn>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>X</ci>
       <ci>p</ci>
      </apply>
      <mtext>mod</mtext>
      <ci>p</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (1+X)^{p}\equiv 1+X^{p}\text{ mod }p.
  </annotation>
 </semantics>
</math>

 Continuing by induction, we have for every nonnegative integer <em>i</em> that</p>

<p>

<math display="block" id="Lucas'_theorem:10">
 <semantics>
  <mrow>
   <mrow>
    <msup>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mn>1</mn>
       <mo>+</mo>
       <mi>X</mi>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <msup>
      <mi>p</mi>
      <mi>i</mi>
     </msup>
    </msup>
    <mo>≡</mo>
    <mrow>
     <mn>1</mn>
     <mo>+</mo>
     <mrow>
      <msup>
       <mi>X</mi>
       <msup>
        <mi>p</mi>
        <mi>i</mi>
       </msup>
      </msup>
      <mtext>mod</mtext>
      <mi>p</mi>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <equivalent></equivalent>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <plus></plus>
      <cn type="integer">1</cn>
      <ci>X</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>p</ci>
      <ci>i</ci>
     </apply>
    </apply>
    <apply>
     <plus></plus>
     <cn type="integer">1</cn>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>X</ci>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>p</ci>
        <ci>i</ci>
       </apply>
      </apply>
      <mtext>mod</mtext>
      <ci>p</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (1+X)^{p^{i}}\equiv 1+X^{p^{i}}\text{ mod }p.
  </annotation>
 </semantics>
</math>

</p>

<p>Now let <em>m</em> be a nonnegative integer, and let <em>p</em> be a prime. Write <em>m</em> in base <em>p</em>, so that 

<math display="inline" id="Lucas'_theorem:11">
 <semantics>
  <mrow>
   <mi>m</mi>
   <mo>=</mo>
   <mrow>
    <msubsup>
     <mo largeop="true" symmetric="true">∑</mo>
     <mrow>
      <mi>i</mi>
      <mo>=</mo>
      <mn>0</mn>
     </mrow>
     <mi>k</mi>
    </msubsup>
    <mrow>
     <msub>
      <mi>m</mi>
      <mi>i</mi>
     </msub>
     <msup>
      <mi>p</mi>
      <mi>i</mi>
     </msup>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>m</ci>
    <apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <apply>
        <eq></eq>
        <ci>i</ci>
        <cn type="integer">0</cn>
       </apply>
      </apply>
      <ci>k</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>m</ci>
       <ci>i</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>p</ci>
       <ci>i</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   m=\sum_{i=0}^{k}m_{i}p^{i}
  </annotation>
 </semantics>
</math>

 for some nonnegative integer <em>k</em> and integers <em>m</em><sub><em>i</em></sub> with 0 ≤ <em>m</em><sub><em>i</em></sub> ≤ <em>p</em>-1. Then</p>

<p>

<math display="inline" id="Lucas'_theorem:12">
 <semantics>
  <mrow>
   <mstyle displaystyle="true">
    <munderover>
     <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
     <mrow>
      <mi>n</mi>
      <mo>=</mo>
      <mn>0</mn>
     </mrow>
     <mi>m</mi>
    </munderover>
   </mstyle>
   <mrow>
    <mrow>
     <mo>(</mo>
     <mstyle displaystyle="true">
      <mtable columnspacing="0.4em" rowspacing="0.2ex">
       <mtr>
        <mtd>
         <mi>m</mi>
        </mtd>
       </mtr>
       <mtr>
        <mtd>
         <mi>n</mi>
        </mtd>
       </mtr>
      </mtable>
     </mstyle>
     <mo>)</mo>
    </mrow>
    <msup>
     <mi>X</mi>
     <mi>n</mi>
    </msup>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <sum></sum>
      <apply>
       <eq></eq>
       <ci>n</ci>
       <cn type="integer">0</cn>
      </apply>
     </apply>
     <ci>m</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="latexml">binomial</csymbol>
      <ci>m</ci>
      <ci>n</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>X</ci>
      <ci>n</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle\sum_{n=0}^{m}{\left({{m}\atop{n}}\right)}X^{n}
  </annotation>
 </semantics>
</math>


 where in the final product, <em>n</em><sub><em>i</em></sub> is digit <em>i</em> in the base <em>p</em> representation of <em>n</em>. This proves Lucas's theorem.</p>
<h2 id="variations-and-generalizations">Variations and generalizations</h2>
<ul>
<li>The largest integer <em>k</em> such that <em>p</em><sup><em>k</em></sup> divides the binomial coefficient 

<math display="inline" id="Lucas'_theorem:13">
 <semantics>
  <mrow>
   <mo>(</mo>
   <mstyle scriptlevel="+1">
    <mtable columnspacing="0.4em" rowspacing="0.2ex">
     <mtr>
      <mtd>
       <mi>m</mi>
      </mtd>
     </mtr>
     <mtr>
      <mtd>
       <mi>n</mi>
      </mtd>
     </mtr>
    </mtable>
   </mstyle>
   <mo>)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">binomial</csymbol>
    <ci>m</ci>
    <ci>n</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   {\textstyle\left({{m}\atop{n}}\right)}
  </annotation>
 </semantics>
</math>

 (or in other words, the <a href="p-adic_order" title="wikilink">valuation</a> of the binomial coefficient with respect to the prime <em>p</em>) is equal to the number of <a href="Carry_(arithmetic)" title="wikilink">carries</a> that occur when <em>n</em> and <em>m</em> − <em>n</em> are added in the <a href="Positional_notation#Base_of_the_numeral_system" title="wikilink">base <em>p</em></a>. (This result is known as <a href="Kummer's_theorem" title="wikilink">Kummer's theorem</a>.)</li>
<li><a href="Andrew_Granville" title="wikilink">Andrew Granville</a> has given a generalization of Lucas's theorem to the case of <em>p</em> being a power of prime.<a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a></li>
</ul>
<h2 id="references">References</h2>
<h2 id="external-links">External links</h2>
<ul>
<li></li>
<li><a href="http://arxiv.org/abs/1301.4250">Alternate Proof of Lucas'Theorem</a></li>
</ul>

<p>"</p>

<p><a href="Category:Articles_containing_proofs" title="wikilink">Category:Articles containing proofs</a> <a href="Category:Theorems_about_prime_numbers" title="wikilink">Category:Theorems about prime numbers</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1"><a href="#fnref1">↩</a></li>
<li id="fn2"><a href="#fnref2">↩</a></li>
</ol>
</section>
</body>
</html>

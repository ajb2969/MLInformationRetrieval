<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="1907">Savitzky–Golay filter</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Savitzky–Golay filter</h1>
<hr/>
<figure><b>(Figure)</b>
<figcaption>Animation showing smoothing being applied, passing through the data from left to right. The red line represents the local polynomial being used to fit a sub-set of the data. The smoothed values are shown as circles.</figcaption>
</figure>

<p>A <strong>Savitzky–Golay filter</strong> is a <a href="digital_filter" title="wikilink">digital filter</a> that can be applied to a set of <a href="digital_data" title="wikilink">digital data</a> points for the purpose of <a class="uri" href="smoothing" title="wikilink">smoothing</a> the data, that is, to increase the <a href="signal-to-noise_ratio" title="wikilink">signal-to-noise ratio</a> without greatly distorting the signal. This is achieved, in a process known as <a class="uri" href="convolution" title="wikilink">convolution</a>, by fitting successive sub-sets of adjacent data points with a low-degree <a class="uri" href="polynomial" title="wikilink">polynomial</a> by the method of <a href="linear_least_squares_(mathematics)" title="wikilink">linear least squares</a> . When the data points are equally spaced an <a href="analytical_solution" title="wikilink">analytical solution</a> to the least-squares equations can be found, in the form of a single set of "convolution coefficients" that can be applied to all data sub-sets, to give estimates of the smoothed signal, (or derivatives of the smoothed signal) at the central point of each sub-set. The method, based on established mathematical procedures,<a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a><a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a> was popularized by <a href="Abraham_Savitzky" title="wikilink">Abraham Savitzky</a> and <a href="Marcel_J._E._Golay" title="wikilink">Marcel J. E. Golay</a> who published tables of convolution coefficients for various polynomials and sub-set sizes in 1964.<a class="footnoteRef" href="#fn3" id="fnref3"><sup>3</sup></a><a class="footnoteRef" href="#fn4" id="fnref4"><sup>4</sup></a> Some errors in the tables have been corrected.<a class="footnoteRef" href="#fn5" id="fnref5"><sup>5</sup></a> The method has been extended for the treatment of 2- and 3-dimensional data.</p>

<p>Savitzky and Golay's paper is one of the most widely cited papers in the journal <a href="Analytical_Chemistry_(journal)" title="wikilink"><em>Analytical Chemistry</em></a><a class="footnoteRef" href="#fn6" id="fnref6"><sup>6</sup></a> and is classed by that journal as one of its "10 seminal papers" saying "it can be argued that the dawn of the computer-controlled analytical instrument can be traced to this article".<a class="footnoteRef" href="#fn7" id="fnref7"><sup>7</sup></a></p>
<h2 id="applications">Applications</h2>

<p>The data consists of a set of <em>n</em> {<em>x</em><sub><em>j</em></sub>, <em>y</em><sub><em>j</em></sub>} points (<em>j</em> = 1, ..., <em>n</em>), where <em>x</em> is an independent variable and <em>y</em><sub><em>j</em></sub> is an observed value. They are treated with a set of <em>m</em> convolution coefficients, <em>C</em><sub>i</sub> according to the expression</p>

<p>

<math display="block" id="Savitzky–Golay_filter:0">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>Y</mi>
     <mi>j</mi>
    </msub>
    <mo>=</mo>
    <mrow>
     <munderover>
      <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
      <mrow>
       <mi>i</mi>
       <mo>=</mo>
       <mrow>
        <mo>-</mo>
        <mrow>
         <mrow>
          <mo stretchy="false">(</mo>
          <mrow>
           <mi>m</mi>
           <mo>-</mo>
           <mn>1</mn>
          </mrow>
          <mo stretchy="false">)</mo>
         </mrow>
         <mo>/</mo>
         <mn>2</mn>
        </mrow>
       </mrow>
      </mrow>
      <mrow>
       <mi>i</mi>
       <mo>=</mo>
       <mrow>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <mi>m</mi>
          <mo>-</mo>
          <mn>1</mn>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
        <mo>/</mo>
        <mn>2</mn>
       </mrow>
      </mrow>
     </munderover>
     <mrow>
      <mpadded width="+1.7pt">
       <msub>
        <mi>C</mi>
        <mi>i</mi>
       </msub>
      </mpadded>
      <msub>
       <mi>y</mi>
       <mrow>
        <mi>j</mi>
        <mo>+</mo>
        <mi>i</mi>
       </mrow>
      </msub>
     </mrow>
    </mrow>
   </mrow>
   <mrow>
    <mfrac>
     <mrow>
      <mi>m</mi>
      <mo>+</mo>
      <mn>1</mn>
     </mrow>
     <mn>2</mn>
    </mfrac>
    <mo>≤</mo>
    <mi>j</mi>
    <mo>≤</mo>
    <mrow>
     <mi>n</mi>
     <mo>-</mo>
     <mfrac>
      <mrow>
       <mi>m</mi>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
      <mn>2</mn>
     </mfrac>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>Y</ci>
      <ci>j</ci>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <apply>
         <eq></eq>
         <ci>i</ci>
         <apply>
          <minus></minus>
          <apply>
           <divide></divide>
           <apply>
            <minus></minus>
            <ci>m</ci>
            <cn type="integer">1</cn>
           </apply>
           <cn type="integer">2</cn>
          </apply>
         </apply>
        </apply>
       </apply>
       <apply>
        <eq></eq>
        <ci>i</ci>
        <apply>
         <divide></divide>
         <apply>
          <minus></minus>
          <ci>m</ci>
          <cn type="integer">1</cn>
         </apply>
         <cn type="integer">2</cn>
        </apply>
       </apply>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>C</ci>
        <ci>i</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>y</ci>
        <apply>
         <plus></plus>
         <ci>j</ci>
         <ci>i</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <and></and>
     <apply>
      <leq></leq>
      <apply>
       <divide></divide>
       <apply>
        <plus></plus>
        <ci>m</ci>
        <cn type="integer">1</cn>
       </apply>
       <cn type="integer">2</cn>
      </apply>
      <ci>j</ci>
     </apply>
     <apply>
      <leq></leq>
      <share href="#.cmml">
      </share>
      <apply>
       <minus></minus>
       <ci>n</ci>
       <apply>
        <divide></divide>
        <apply>
         <minus></minus>
         <ci>m</ci>
         <cn type="integer">1</cn>
        </apply>
        <cn type="integer">2</cn>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Y_{j}=\sum_{i=-(m-1)/2}^{i=(m-1)/2}C_{i}\,y_{j+i}\qquad\frac{m+1}{2}\leq j\leq
n%
-\frac{m-1}{2}
  </annotation>
 </semantics>
</math>

 It is easy to apply this formula in a <a class="uri" href="spreadsheet" title="wikilink">spreadsheet</a>. Selected convolution coefficients are shown in the <a href="#Appendix" title="wikilink">tables, below</a>. For example, for smoothing by a 5-point quadratic polynomial, <em>m</em> = 5, <em>i</em> = −2, −1, 0, 1, 2 and the <em>j</em>th smoothed data point, <em>Y</em><sub>j</sub>, is given by</p>

<p>

<math display="block" id="Savitzky–Golay_filter:1">
 <semantics>
  <mrow>
   <msub>
    <mi>Y</mi>
    <mi>j</mi>
   </msub>
   <mo>=</mo>
   <mrow>
    <mfrac>
     <mn>1</mn>
     <mn>35</mn>
    </mfrac>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mrow>
       <mrow>
        <mo>-</mo>
        <mrow>
         <mn>3</mn>
         <mo>×</mo>
         <msub>
          <mi>y</mi>
          <mrow>
           <mi>j</mi>
           <mo>-</mo>
           <mn>2</mn>
          </mrow>
         </msub>
        </mrow>
       </mrow>
       <mo>+</mo>
       <mrow>
        <mn>12</mn>
        <mo>×</mo>
        <msub>
         <mi>y</mi>
         <mrow>
          <mi>j</mi>
          <mo>-</mo>
          <mn>1</mn>
         </mrow>
        </msub>
       </mrow>
       <mo>+</mo>
       <mrow>
        <mn>17</mn>
        <mo>×</mo>
        <msub>
         <mi>y</mi>
         <mi>j</mi>
        </msub>
       </mrow>
       <mo>+</mo>
       <mrow>
        <mn>12</mn>
        <mo>×</mo>
        <msub>
         <mi>y</mi>
         <mrow>
          <mi>j</mi>
          <mo>+</mo>
          <mn>1</mn>
         </mrow>
        </msub>
       </mrow>
      </mrow>
      <mo>-</mo>
      <mrow>
       <mn>3</mn>
       <mo>×</mo>
       <msub>
        <mi>y</mi>
        <mrow>
         <mi>j</mi>
         <mo>+</mo>
         <mn>2</mn>
        </mrow>
       </msub>
      </mrow>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>Y</ci>
     <ci>j</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <divide></divide>
      <cn type="integer">1</cn>
      <cn type="integer">35</cn>
     </apply>
     <apply>
      <minus></minus>
      <apply>
       <plus></plus>
       <apply>
        <minus></minus>
        <apply>
         <times></times>
         <cn type="integer">3</cn>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>y</ci>
          <apply>
           <minus></minus>
           <ci>j</ci>
           <cn type="integer">2</cn>
          </apply>
         </apply>
        </apply>
       </apply>
       <apply>
        <times></times>
        <cn type="integer">12</cn>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>y</ci>
         <apply>
          <minus></minus>
          <ci>j</ci>
          <cn type="integer">1</cn>
         </apply>
        </apply>
       </apply>
       <apply>
        <times></times>
        <cn type="integer">17</cn>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>y</ci>
         <ci>j</ci>
        </apply>
       </apply>
       <apply>
        <times></times>
        <cn type="integer">12</cn>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>y</ci>
         <apply>
          <plus></plus>
          <ci>j</ci>
          <cn type="integer">1</cn>
         </apply>
        </apply>
       </apply>
      </apply>
      <apply>
       <times></times>
       <cn type="integer">3</cn>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>y</ci>
        <apply>
         <plus></plus>
         <ci>j</ci>
         <cn type="integer">2</cn>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Y_{j}=\frac{1}{35}(-3\times y_{j-2}+12\times y_{j-1}+17\times y_{j}+12\times y%
_{j+1}-3\times y_{j+2})
  </annotation>
 </semantics>
</math>

,</p>

<p>where, <em>C</em><sub>−2</sub> = −3/35, <em>C</em><sub>−1</sub> = 12 / 35, etc. There are numerous applications of smoothing, which is performed primarily to make the data appear to be less noisy than it really is. The following are applications of numerical differentiation of data.<a class="footnoteRef" href="#fn8" id="fnref8"><sup>8</sup></a></p>

<p><br/>
</p>
<ol>
<li>Location of <a href="maxima_and_minima" title="wikilink">maxima and minima</a> in experimental data curves. This was the application that first motivated Savitzky.<a class="footnoteRef" href="#fn9" id="fnref9"><sup>9</sup></a> The first derivative of a function is zero at a maximum or minimum. The diagram shows data points belonging to a synthetic <a href="Cauchy_distribution" title="wikilink">Lorentzian</a> curve, with added noise (blue diamonds). Data are plotted on a scale of half width, relative to the peak maximum at zero. The smoothed curve (red line) and 1st. derivative (green) were calculated with 7-point cubic Savitzky–Golay filters. <a href="interpolation#linear_interpolation" title="wikilink">Linear interpolation</a> of the first derivative values at positions either side of the zero-crossing gives the position of the peak maximum. 3rd. derivatives can also be used for this purpose.</li>
<li>Location of an end-point in a <a href="titration_curve" title="wikilink">titration curve</a>. An end-point is an <a href="inflection_point" title="wikilink">inflection point</a> where the second derivative of the function is zero.<a class="footnoteRef" href="#fn10" id="fnref10"><sup>10</sup></a> The titration curve for <a href="malonic_acid" title="wikilink">malonic acid</a> illustrates the power of the method. The first <a href="Equivalence_point" title="wikilink">end-point</a> at 4 ml is barely visible, but the second derivative allows its value to be easily determined by linear interpolation to find the zero crossing.</li>
<li>Baseline flattening. In <a href="analytical_chemistry" title="wikilink">analytical chemistry</a> it is sometimes necessary to measure the height of an <a href="absorption_band" title="wikilink">absorption band</a> against a curved baseline.<a class="footnoteRef" href="#fn11" id="fnref11"><sup>11</sup></a> Because the curvature of the baseline is much less than the curvature of the absorption band, the second derivative effectively flattens the baseline. Three measures of the derivative height, which is proportional to the absorption band height, are the "peak-to-valley" distances h1 and h2, and the height from baseline, h3.<a class="footnoteRef" href="#fn12" id="fnref12"><sup>12</sup></a></li>
<li>Resolution enhancement in spectroscopy. Bands in the second derivative of a spectroscopic curve are narrower than the bands in the spectrum: they have reduced <a href="Full_width_at_half_maximum" title="wikilink">half-width</a>. This allows partially overlapping bands to be "resolved" into separate (negative) peaks.<a class="footnoteRef" href="#fn13" id="fnref13"><sup>13</sup></a> The diagram illustrates how this may be used also for <a href="chemical_analysis" title="wikilink">chemical analysis</a>, using measurement of "peak-to-valley" distances. In this case the valleys are a property of the 2nd. derivative of a Lorentzian. (<em>x</em>-axis position is relative to the position of the peak maximum on a scale of <a href="Full_width_at_half_maximum" title="wikilink">half width at half height</a>).</li>
<li>Resolution enhancement with 4th. derivative (positive peaks). The minima are a property of the 4th derivative of a Lorentzian.</li>
</ol>
<h3 id="moving-average">Moving average</h3>

<p>A moving average filter is commonly used with time series data to smooth out short-term fluctuations and highlight longer-term trends or cycles. It is often used in technical analysis of financial data, like stock prices, returns or trading volumes. It is also used in economics to examine gross domestic product, employment or other macroeconomic time series.</p>

<p>An unweighted moving average filter is the simplest convolution filter. Each subset of the data set is fitted by a straight line. It was not included in the Savitzsky-Golay tables of convolution coefficients as all the coefficient values are simply equal to 1/<em>m</em>.</p>
<h2 id="derivation-of-convolution-coefficients">Derivation of convolution coefficients</h2>

<p>When the data points are equally spaced, an <a href="analytical_solution" title="wikilink">analytical solution</a> to the least-squares equations can be found.<a class="footnoteRef" href="#fn14" id="fnref14"><sup>14</sup></a> This solution forms the basis of the <a class="uri" href="convolution" title="wikilink">convolution</a> method of numerical smoothing and differentiation. Suppose that the data consists of a set of <em>n</em> {<em>x</em><sub><em>j</em></sub>, <em>y</em><sub><em>j</em></sub>} points (<em>j</em> = 1, ..., <em>n</em>), where <em>x</em> is an independent variable and <em>y</em><sub><em>j</em></sub> is a datum value. A polynomial will be fitted by <a href="linear_least_squares_(mathematics)" title="wikilink">linear least squares</a> to a set of <em>m</em> (an odd number) adjacent data points, each separated by an interval <em>h</em>. Firstly, a change of variable is made</p>

<p>

<math display="block" id="Savitzky–Golay_filter:2">
 <semantics>
  <mrow>
   <mi>z</mi>
   <mo>=</mo>
   <mfrac>
    <mrow>
     <mi>x</mi>
     <mo>-</mo>
     <mover accent="true">
      <mi>x</mi>
      <mo stretchy="false">¯</mo>
     </mover>
    </mrow>
    <mi>h</mi>
   </mfrac>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>z</ci>
    <apply>
     <divide></divide>
     <apply>
      <minus></minus>
      <ci>x</ci>
      <apply>
       <ci>normal-¯</ci>
       <ci>x</ci>
      </apply>
     </apply>
     <ci>h</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   z={{x-\bar{x}}\over h}
  </annotation>
 </semantics>
</math>

 where 

<math display="inline" id="Savitzky–Golay_filter:3">
 <semantics>
  <mover accent="true">
   <mi>x</mi>
   <mo stretchy="false">¯</mo>
  </mover>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-¯</ci>
    <ci>x</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   {\bar{x}}
  </annotation>
 </semantics>
</math>

 is the value of the central point. <em>z</em> takes the values 

<math display="inline" id="Savitzky–Golay_filter:4">
 <semantics>
  <mrow>
   <mfrac>
    <mrow>
     <mn>1</mn>
     <mo>-</mo>
     <mi>m</mi>
    </mrow>
    <mn>2</mn>
   </mfrac>
   <mo>,</mo>
   <mi mathvariant="normal">…</mi>
   <mo>,</mo>
   <mn>0</mn>
   <mo>,</mo>
   <mi mathvariant="normal">…</mi>
   <mo>,</mo>
   <mfrac>
    <mrow>
     <mi>m</mi>
     <mo>-</mo>
     <mn>1</mn>
    </mrow>
    <mn>2</mn>
   </mfrac>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <list>
    <apply>
     <divide></divide>
     <apply>
      <minus></minus>
      <cn type="integer">1</cn>
      <ci>m</ci>
     </apply>
     <cn type="integer">2</cn>
    </apply>
    <ci>normal-…</ci>
    <cn type="integer">0</cn>
    <ci>normal-…</ci>
    <apply>
     <divide></divide>
     <apply>
      <minus></minus>
      <ci>m</ci>
      <cn type="integer">1</cn>
     </apply>
     <cn type="integer">2</cn>
    </apply>
   </list>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   {1-m\over 2},\ldots,0,\ldots,{m-1\over 2}
  </annotation>
 </semantics>
</math>

 (e.g. <em>m</em> = 5 → <em>z</em> = −2, −1, 0, 1, 2).<a class="footnoteRef" href="#fn15" id="fnref15"><sup>15</sup></a> The polynomial, of degree <em>k</em> is defined as</p>

<p>

<math display="block" id="Savitzky–Golay_filter:5">
 <semantics>
  <mrow>
   <mrow>
    <mi>Y</mi>
    <mo>=</mo>
    <mrow>
     <msub>
      <mi>a</mi>
      <mn>0</mn>
     </msub>
     <mo>+</mo>
     <mrow>
      <msub>
       <mi>a</mi>
       <mn>1</mn>
      </msub>
      <mi>z</mi>
     </mrow>
     <mo>+</mo>
     <mrow>
      <msub>
       <mi>a</mi>
       <mn>2</mn>
      </msub>
      <msup>
       <mi>z</mi>
       <mn>2</mn>
      </msup>
      <mi mathvariant="normal">⋯</mi>
     </mrow>
     <mo>+</mo>
     <mrow>
      <msub>
       <mi>a</mi>
       <mi>k</mi>
      </msub>
      <msup>
       <mi>z</mi>
       <mi>k</mi>
      </msup>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>Y</ci>
    <apply>
     <plus></plus>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>a</ci>
      <cn type="integer">0</cn>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>a</ci>
       <cn type="integer">1</cn>
      </apply>
      <ci>z</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>a</ci>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>z</ci>
       <cn type="integer">2</cn>
      </apply>
      <ci>normal-⋯</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>a</ci>
       <ci>k</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>z</ci>
       <ci>k</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Y=a_{0}+a_{1}z+a_{2}z^{2}\cdots+a_{k}z^{k}.
  </annotation>
 </semantics>
</math>

<a class="footnoteRef" href="#fn16" id="fnref16"><sup>16</sup></a> The coefficients <em>a</em><sub>0</sub>, <em>a</em><sub>1</sub> etc. are obtained by solving the <a href="normal_equations" title="wikilink">normal equations</a></p>

<p>

<math display="block" id="Savitzky–Golay_filter:6">
 <semantics>
  <mrow>
   <mi>𝐚</mi>
   <mo>=</mo>
   <mrow>
    <msup>
     <mrow>
      <mo>(</mo>
      <mrow>
       <msup>
        <mi>𝐉</mi>
        <mi>𝐓</mi>
       </msup>
       <mi>𝐉</mi>
      </mrow>
      <mo>)</mo>
     </mrow>
     <mrow>
      <mo>-</mo>
      <mn>𝟏</mn>
     </mrow>
    </msup>
    <msup>
     <mi>𝐉</mi>
     <mi>𝐓</mi>
    </msup>
    <mi>𝐲</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>𝐚</ci>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>𝐉</ci>
        <ci>𝐓</ci>
       </apply>
       <ci>𝐉</ci>
      </apply>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>𝐉</ci>
      <ci>𝐓</ci>
     </apply>
     <ci>𝐲</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   {\mathbf{a}}=\left({{\mathbf{J}}^{\mathbf{T}}{\mathbf{J}}}\right)^{-{\mathbf{1%
}}}{\mathbf{J}}^{\mathbf{T}}{\mathbf{y}}
  </annotation>
 </semantics>
</math>

 where the <em>i</em>th row of the <a href="Jacobian_matrix" title="wikilink">Jacobian matrix</a>, 

<math display="inline" id="Savitzky–Golay_filter:7">
 <semantics>
  <mrow>
   <mi>𝐉</mi>
   <mo>=</mo>
   <mfrac>
    <mrow>
     <mo>∂</mo>
     <mi>𝐘</mi>
    </mrow>
    <mrow>
     <mo>∂</mo>
     <mi>𝐚</mi>
    </mrow>
   </mfrac>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>𝐉</ci>
    <apply>
     <divide></divide>
     <apply>
      <partialdiff></partialdiff>
      <ci>𝐘</ci>
     </apply>
     <apply>
      <partialdiff></partialdiff>
      <ci>𝐚</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{J}=\mathbf{{\partial Y\over\partial a}}
  </annotation>
 </semantics>
</math>

, has values 1, <em>z</em><sub>i</sub>, <em>z</em><sub>i</sub><sup>2</sup>, .. .</p>

<p>For example, for a cubic polynomial fitted to 5 points, <em>z</em>= −2, −1, 0, 1, 2 the normal equations are solved as follows.</p>

<p>

<math display="block" id="Savitzky–Golay_filter:8">
 <semantics>
  <mrow>
   <mi>𝐉</mi>
   <mo>=</mo>
   <mrow>
    <mo>(</mo>
    <mtable displaystyle="true">
     <mtr>
      <mtd columnalign="center">
       <mn>1</mn>
      </mtd>
      <mtd columnalign="center">
       <mrow>
        <mo>-</mo>
        <mn>2</mn>
       </mrow>
      </mtd>
      <mtd columnalign="center">
       <mn>4</mn>
      </mtd>
      <mtd columnalign="center">
       <mrow>
        <mo>-</mo>
        <mn>8</mn>
       </mrow>
      </mtd>
     </mtr>
     <mtr>
      <mtd columnalign="center">
       <mn>1</mn>
      </mtd>
      <mtd columnalign="center">
       <mrow>
        <mo>-</mo>
        <mn>1</mn>
       </mrow>
      </mtd>
      <mtd columnalign="center">
       <mn>1</mn>
      </mtd>
      <mtd columnalign="center">
       <mrow>
        <mo>-</mo>
        <mn>1</mn>
       </mrow>
      </mtd>
     </mtr>
     <mtr>
      <mtd columnalign="center">
       <mn>1</mn>
      </mtd>
      <mtd columnalign="center">
       <mn>0</mn>
      </mtd>
      <mtd columnalign="center">
       <mn>0</mn>
      </mtd>
      <mtd columnalign="center">
       <mn>0</mn>
      </mtd>
     </mtr>
     <mtr>
      <mtd columnalign="center">
       <mn>1</mn>
      </mtd>
      <mtd columnalign="center">
       <mn>1</mn>
      </mtd>
      <mtd columnalign="center">
       <mn>1</mn>
      </mtd>
      <mtd columnalign="center">
       <mn>1</mn>
      </mtd>
     </mtr>
     <mtr>
      <mtd columnalign="center">
       <mn>1</mn>
      </mtd>
      <mtd columnalign="center">
       <mn>2</mn>
      </mtd>
      <mtd columnalign="center">
       <mn>4</mn>
      </mtd>
      <mtd columnalign="center">
       <mn>8</mn>
      </mtd>
     </mtr>
    </mtable>
    <mo>)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>𝐉</ci>
    <matrix>
     <matrixrow>
      <cn type="integer">1</cn>
      <apply>
       <minus></minus>
       <cn type="integer">2</cn>
      </apply>
      <cn type="integer">4</cn>
      <apply>
       <minus></minus>
       <cn type="integer">8</cn>
      </apply>
     </matrixrow>
     <matrixrow>
      <cn type="integer">1</cn>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
      </apply>
      <cn type="integer">1</cn>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
      </apply>
     </matrixrow>
     <matrixrow>
      <cn type="integer">1</cn>
      <cn type="integer">0</cn>
      <cn type="integer">0</cn>
      <cn type="integer">0</cn>
     </matrixrow>
     <matrixrow>
      <cn type="integer">1</cn>
      <cn type="integer">1</cn>
      <cn type="integer">1</cn>
      <cn type="integer">1</cn>
     </matrixrow>
     <matrixrow>
      <cn type="integer">1</cn>
      <cn type="integer">2</cn>
      <cn type="integer">4</cn>
      <cn type="integer">8</cn>
     </matrixrow>
    </matrix>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{J}=\begin{pmatrix}1&-2&4&-8\\
1&-1&1&-1\\
1&0&0&0\\
1&1&1&1\\
1&2&4&8\end{pmatrix}
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Savitzky–Golay_filter:9">
 <semantics>
  <mrow>
   <mrow>
    <msup>
     <mi>𝐉</mi>
     <mi>𝐓</mi>
    </msup>
    <mi>𝐉</mi>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mo>(</mo>
    <mtable displaystyle="true">
     <mtr>
      <mtd columnalign="center">
       <mi>m</mi>
      </mtd>
      <mtd columnalign="center">
       <mstyle displaystyle="false">
        <mrow>
         <mo largeop="true" symmetric="true">∑</mo>
         <mi>z</mi>
        </mrow>
       </mstyle>
      </mtd>
      <mtd columnalign="center">
       <mstyle displaystyle="false">
        <mrow>
         <mo largeop="true" symmetric="true">∑</mo>
         <msup>
          <mi>z</mi>
          <mn>2</mn>
         </msup>
        </mrow>
       </mstyle>
      </mtd>
      <mtd columnalign="center">
       <mstyle displaystyle="false">
        <mrow>
         <mo largeop="true" symmetric="true">∑</mo>
         <msup>
          <mi>z</mi>
          <mn>3</mn>
         </msup>
        </mrow>
       </mstyle>
      </mtd>
     </mtr>
     <mtr>
      <mtd columnalign="center">
       <mstyle displaystyle="false">
        <mrow>
         <mo largeop="true" symmetric="true">∑</mo>
         <mi>z</mi>
        </mrow>
       </mstyle>
      </mtd>
      <mtd columnalign="center">
       <mstyle displaystyle="false">
        <mrow>
         <mo largeop="true" symmetric="true">∑</mo>
         <msup>
          <mi>z</mi>
          <mn>2</mn>
         </msup>
        </mrow>
       </mstyle>
      </mtd>
      <mtd columnalign="center">
       <mstyle displaystyle="false">
        <mrow>
         <mo largeop="true" symmetric="true">∑</mo>
         <msup>
          <mi>z</mi>
          <mn>3</mn>
         </msup>
        </mrow>
       </mstyle>
      </mtd>
      <mtd columnalign="center">
       <mstyle displaystyle="false">
        <mrow>
         <mo largeop="true" symmetric="true">∑</mo>
         <msup>
          <mi>z</mi>
          <mn>4</mn>
         </msup>
        </mrow>
       </mstyle>
      </mtd>
     </mtr>
     <mtr>
      <mtd columnalign="center">
       <mstyle displaystyle="false">
        <mrow>
         <mo largeop="true" symmetric="true">∑</mo>
         <msup>
          <mi>z</mi>
          <mn>2</mn>
         </msup>
        </mrow>
       </mstyle>
      </mtd>
      <mtd columnalign="center">
       <mstyle displaystyle="false">
        <mrow>
         <mo largeop="true" symmetric="true">∑</mo>
         <msup>
          <mi>z</mi>
          <mn>3</mn>
         </msup>
        </mrow>
       </mstyle>
      </mtd>
      <mtd columnalign="center">
       <mstyle displaystyle="false">
        <mrow>
         <mo largeop="true" symmetric="true">∑</mo>
         <msup>
          <mi>z</mi>
          <mn>4</mn>
         </msup>
        </mrow>
       </mstyle>
      </mtd>
      <mtd columnalign="center">
       <mstyle displaystyle="false">
        <mrow>
         <mo largeop="true" symmetric="true">∑</mo>
         <msup>
          <mi>z</mi>
          <mn>5</mn>
         </msup>
        </mrow>
       </mstyle>
      </mtd>
     </mtr>
     <mtr>
      <mtd columnalign="center">
       <mstyle displaystyle="false">
        <mrow>
         <mo largeop="true" symmetric="true">∑</mo>
         <msup>
          <mi>z</mi>
          <mn>3</mn>
         </msup>
        </mrow>
       </mstyle>
      </mtd>
      <mtd columnalign="center">
       <mstyle displaystyle="false">
        <mrow>
         <mo largeop="true" symmetric="true">∑</mo>
         <msup>
          <mi>z</mi>
          <mn>4</mn>
         </msup>
        </mrow>
       </mstyle>
      </mtd>
      <mtd columnalign="center">
       <mstyle displaystyle="false">
        <mrow>
         <mo largeop="true" symmetric="true">∑</mo>
         <msup>
          <mi>z</mi>
          <mn>5</mn>
         </msup>
        </mrow>
       </mstyle>
      </mtd>
      <mtd columnalign="center">
       <mstyle displaystyle="false">
        <mrow>
         <mo largeop="true" symmetric="true">∑</mo>
         <msup>
          <mi>z</mi>
          <mn>6</mn>
         </msup>
        </mrow>
       </mstyle>
      </mtd>
     </mtr>
     <mtr>
      <mtd columnalign="center">
       <mi></mi>
      </mtd>
     </mtr>
    </mtable>
    <mo>)</mo>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mo>(</mo>
    <mtable displaystyle="true">
     <mtr>
      <mtd columnalign="center">
       <mi>m</mi>
      </mtd>
      <mtd columnalign="center">
       <mn>0</mn>
      </mtd>
      <mtd columnalign="center">
       <mstyle displaystyle="false">
        <mrow>
         <mo largeop="true" symmetric="true">∑</mo>
         <msup>
          <mi>z</mi>
          <mn>2</mn>
         </msup>
        </mrow>
       </mstyle>
      </mtd>
      <mtd columnalign="center">
       <mn>0</mn>
      </mtd>
     </mtr>
     <mtr>
      <mtd columnalign="center">
       <mn>0</mn>
      </mtd>
      <mtd columnalign="center">
       <mstyle displaystyle="false">
        <mrow>
         <mo largeop="true" symmetric="true">∑</mo>
         <msup>
          <mi>z</mi>
          <mn>2</mn>
         </msup>
        </mrow>
       </mstyle>
      </mtd>
      <mtd columnalign="center">
       <mn>0</mn>
      </mtd>
      <mtd columnalign="center">
       <mstyle displaystyle="false">
        <mrow>
         <mo largeop="true" symmetric="true">∑</mo>
         <msup>
          <mi>z</mi>
          <mn>4</mn>
         </msup>
        </mrow>
       </mstyle>
      </mtd>
     </mtr>
     <mtr>
      <mtd columnalign="center">
       <mstyle displaystyle="false">
        <mrow>
         <mo largeop="true" symmetric="true">∑</mo>
         <msup>
          <mi>z</mi>
          <mn>2</mn>
         </msup>
        </mrow>
       </mstyle>
      </mtd>
      <mtd columnalign="center">
       <mn>0</mn>
      </mtd>
      <mtd columnalign="center">
       <mstyle displaystyle="false">
        <mrow>
         <mo largeop="true" symmetric="true">∑</mo>
         <msup>
          <mi>z</mi>
          <mn>4</mn>
         </msup>
        </mrow>
       </mstyle>
      </mtd>
      <mtd columnalign="center">
       <mn>0</mn>
      </mtd>
     </mtr>
     <mtr>
      <mtd columnalign="center">
       <mn>0</mn>
      </mtd>
      <mtd columnalign="center">
       <mstyle displaystyle="false">
        <mrow>
         <mo largeop="true" symmetric="true">∑</mo>
         <msup>
          <mi>z</mi>
          <mn>4</mn>
         </msup>
        </mrow>
       </mstyle>
      </mtd>
      <mtd columnalign="center">
       <mn>0</mn>
      </mtd>
      <mtd columnalign="center">
       <mstyle displaystyle="false">
        <mrow>
         <mo largeop="true" symmetric="true">∑</mo>
         <msup>
          <mi>z</mi>
          <mn>6</mn>
         </msup>
        </mrow>
       </mstyle>
      </mtd>
     </mtr>
    </mtable>
    <mo>)</mo>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mo>(</mo>
    <mtable displaystyle="true">
     <mtr>
      <mtd columnalign="center">
       <mn>5</mn>
      </mtd>
      <mtd columnalign="center">
       <mn>0</mn>
      </mtd>
      <mtd columnalign="center">
       <mn>10</mn>
      </mtd>
      <mtd columnalign="center">
       <mn>0</mn>
      </mtd>
     </mtr>
     <mtr>
      <mtd columnalign="center">
       <mn>0</mn>
      </mtd>
      <mtd columnalign="center">
       <mn>10</mn>
      </mtd>
      <mtd columnalign="center">
       <mn>0</mn>
      </mtd>
      <mtd columnalign="center">
       <mn>34</mn>
      </mtd>
     </mtr>
     <mtr>
      <mtd columnalign="center">
       <mn>10</mn>
      </mtd>
      <mtd columnalign="center">
       <mn>0</mn>
      </mtd>
      <mtd columnalign="center">
       <mn>34</mn>
      </mtd>
      <mtd columnalign="center">
       <mn>0</mn>
      </mtd>
     </mtr>
     <mtr>
      <mtd columnalign="center">
       <mn>0</mn>
      </mtd>
      <mtd columnalign="center">
       <mn>34</mn>
      </mtd>
      <mtd columnalign="center">
       <mn>0</mn>
      </mtd>
      <mtd columnalign="center">
       <mn>130</mn>
      </mtd>
     </mtr>
    </mtable>
    <mo>)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>𝐉</ci>
       <ci>𝐓</ci>
      </apply>
      <ci>𝐉</ci>
     </apply>
     <matrix>
      <matrixrow>
       <ci>m</ci>
       <apply>
        <sum></sum>
        <ci>z</ci>
       </apply>
       <apply>
        <sum></sum>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>z</ci>
         <cn type="integer">2</cn>
        </apply>
       </apply>
       <apply>
        <sum></sum>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>z</ci>
         <cn type="integer">3</cn>
        </apply>
       </apply>
      </matrixrow>
      <matrixrow>
       <apply>
        <sum></sum>
        <ci>z</ci>
       </apply>
       <apply>
        <sum></sum>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>z</ci>
         <cn type="integer">2</cn>
        </apply>
       </apply>
       <apply>
        <sum></sum>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>z</ci>
         <cn type="integer">3</cn>
        </apply>
       </apply>
       <apply>
        <sum></sum>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>z</ci>
         <cn type="integer">4</cn>
        </apply>
       </apply>
      </matrixrow>
      <matrixrow>
       <apply>
        <sum></sum>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>z</ci>
         <cn type="integer">2</cn>
        </apply>
       </apply>
       <apply>
        <sum></sum>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>z</ci>
         <cn type="integer">3</cn>
        </apply>
       </apply>
       <apply>
        <sum></sum>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>z</ci>
         <cn type="integer">4</cn>
        </apply>
       </apply>
       <apply>
        <sum></sum>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>z</ci>
         <cn type="integer">5</cn>
        </apply>
       </apply>
      </matrixrow>
      <matrixrow>
       <apply>
        <sum></sum>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>z</ci>
         <cn type="integer">3</cn>
        </apply>
       </apply>
       <apply>
        <sum></sum>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>z</ci>
         <cn type="integer">4</cn>
        </apply>
       </apply>
       <apply>
        <sum></sum>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>z</ci>
         <cn type="integer">5</cn>
        </apply>
       </apply>
       <apply>
        <sum></sum>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>z</ci>
         <cn type="integer">6</cn>
        </apply>
       </apply>
      </matrixrow>
      <matrixrow>
       <csymbol cd="latexml">absent</csymbol>
      </matrixrow>
     </matrix>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <matrix>
      <matrixrow>
       <ci>m</ci>
       <cn type="integer">0</cn>
       <apply>
        <sum></sum>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>z</ci>
         <cn type="integer">2</cn>
        </apply>
       </apply>
       <cn type="integer">0</cn>
      </matrixrow>
      <matrixrow>
       <cn type="integer">0</cn>
       <apply>
        <sum></sum>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>z</ci>
         <cn type="integer">2</cn>
        </apply>
       </apply>
       <cn type="integer">0</cn>
       <apply>
        <sum></sum>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>z</ci>
         <cn type="integer">4</cn>
        </apply>
       </apply>
      </matrixrow>
      <matrixrow>
       <apply>
        <sum></sum>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>z</ci>
         <cn type="integer">2</cn>
        </apply>
       </apply>
       <cn type="integer">0</cn>
       <apply>
        <sum></sum>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>z</ci>
         <cn type="integer">4</cn>
        </apply>
       </apply>
       <cn type="integer">0</cn>
      </matrixrow>
      <matrixrow>
       <cn type="integer">0</cn>
       <apply>
        <sum></sum>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>z</ci>
         <cn type="integer">4</cn>
        </apply>
       </apply>
       <cn type="integer">0</cn>
       <apply>
        <sum></sum>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>z</ci>
         <cn type="integer">6</cn>
        </apply>
       </apply>
      </matrixrow>
     </matrix>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <matrix>
      <matrixrow>
       <cn type="integer">5</cn>
       <cn type="integer">0</cn>
       <cn type="integer">10</cn>
       <cn type="integer">0</cn>
      </matrixrow>
      <matrixrow>
       <cn type="integer">0</cn>
       <cn type="integer">10</cn>
       <cn type="integer">0</cn>
       <cn type="integer">34</cn>
      </matrixrow>
      <matrixrow>
       <cn type="integer">10</cn>
       <cn type="integer">0</cn>
       <cn type="integer">34</cn>
       <cn type="integer">0</cn>
      </matrixrow>
      <matrixrow>
       <cn type="integer">0</cn>
       <cn type="integer">34</cn>
       <cn type="integer">0</cn>
       <cn type="integer">130</cn>
      </matrixrow>
     </matrix>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{J^{T}J}=\begin{pmatrix}m&\sum z&\sum z^{2}&\sum z^{3}\\
\sum z&\sum z^{2}&\sum z^{3}&\sum z^{4}\\
\sum z^{2}&\sum z^{3}&\sum z^{4}&\sum z^{5}\\
\sum z^{3}&\sum z^{4}&\sum z^{5}&\sum z^{6}\\
\par
\end{pmatrix}=\begin{pmatrix}m&0&\sum z^{2}&0\\
0&\sum z^{2}&0&\sum z^{4}\\
\sum z^{2}&0&\sum z^{4}&0\\
0&\sum z^{4}&0&\sum z^{6}\\
\end{pmatrix}=\begin{pmatrix}5&0&10&0\\
0&10&0&34\\
10&0&34&0\\
0&34&0&130\\
\end{pmatrix}
  </annotation>
 </semantics>
</math>

</p>

<p>Now, the normal equations can be factored into two separate sets of equations, by rearranging rows and columns, with</p>

<p>

<math display="block" id="Savitzky–Golay_filter:10">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <msup>
      <mi>𝐉</mi>
      <mi>𝐓</mi>
     </msup>
     <msub>
      <mi>𝐉</mi>
      <mrow>
       <mi>e</mi>
       <mi>v</mi>
       <mi>e</mi>
       <mi>n</mi>
      </mrow>
     </msub>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mo>(</mo>
      <mtable displaystyle="true">
       <mtr>
        <mtd columnalign="center">
         <mn>5</mn>
        </mtd>
        <mtd columnalign="center">
         <mn>10</mn>
        </mtd>
       </mtr>
       <mtr>
        <mtd columnalign="center">
         <mn>10</mn>
        </mtd>
        <mtd columnalign="center">
         <mn>34</mn>
        </mtd>
       </mtr>
      </mtable>
      <mo>)</mo>
     </mrow>
     <mi>and</mi>
    </mrow>
   </mrow>
   <mrow>
    <mrow>
     <msup>
      <mi>𝐉</mi>
      <mi>𝐓</mi>
     </msup>
     <msub>
      <mi>𝐉</mi>
      <mrow>
       <mi>o</mi>
       <mi>d</mi>
       <mi>d</mi>
      </mrow>
     </msub>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mo>(</mo>
     <mtable displaystyle="true">
      <mtr>
       <mtd columnalign="center">
        <mn>10</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>34</mn>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mn>34</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>130</mn>
       </mtd>
      </mtr>
     </mtable>
     <mo>)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <eq></eq>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>𝐉</ci>
       <ci>𝐓</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>𝐉</ci>
       <apply>
        <times></times>
        <ci>e</ci>
        <ci>v</ci>
        <ci>e</ci>
        <ci>n</ci>
       </apply>
      </apply>
     </apply>
     <list>
      <matrix>
       <matrixrow>
        <cn type="integer">5</cn>
        <cn type="integer">10</cn>
       </matrixrow>
       <matrixrow>
        <cn type="integer">10</cn>
        <cn type="integer">34</cn>
       </matrixrow>
      </matrix>
      <ci>and</ci>
     </list>
    </apply>
    <apply>
     <eq></eq>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>𝐉</ci>
       <ci>𝐓</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>𝐉</ci>
       <apply>
        <times></times>
        <ci>o</ci>
        <ci>d</ci>
        <ci>d</ci>
       </apply>
      </apply>
     </apply>
     <matrix>
      <matrixrow>
       <cn type="integer">10</cn>
       <cn type="integer">34</cn>
      </matrixrow>
      <matrixrow>
       <cn type="integer">34</cn>
       <cn type="integer">130</cn>
      </matrixrow>
     </matrix>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{J^{T}J}_{even}=\begin{pmatrix}5&10\\
10&34\\
\end{pmatrix}\quad\mathrm{and}\quad\mathbf{J^{T}J}_{odd}=\begin{pmatrix}10&34%
\\
34&130\\
\end{pmatrix}
  </annotation>
 </semantics>
</math>

 Expressions for the inverse of each of these matrices can be obtained using <a href="Cramer's_rule" title="wikilink">Cramer's rule</a></p>

<p>

<math display="block" id="Savitzky–Golay_filter:11">
 <semantics>
  <mrow>
   <mrow>
    <msubsup>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <msup>
        <mi>𝐉</mi>
        <mi>𝐓</mi>
       </msup>
       <mi>𝐉</mi>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <mtext>even</mtext>
     <mrow>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </msubsup>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mfrac>
       <mn>1</mn>
       <mn>70</mn>
      </mfrac>
      <mrow>
       <mo>(</mo>
       <mtable displaystyle="true">
        <mtr>
         <mtd columnalign="center">
          <mn>34</mn>
         </mtd>
         <mtd columnalign="center">
          <mrow>
           <mo>-</mo>
           <mn>10</mn>
          </mrow>
         </mtd>
        </mtr>
        <mtr>
         <mtd columnalign="center">
          <mrow>
           <mo>-</mo>
           <mn>10</mn>
          </mrow>
         </mtd>
         <mtd columnalign="center">
          <mn>5</mn>
         </mtd>
        </mtr>
       </mtable>
       <mo>)</mo>
      </mrow>
     </mrow>
     <mi>and</mi>
    </mrow>
   </mrow>
   <mrow>
    <msubsup>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <msup>
        <mi>𝐉</mi>
        <mi>𝐓</mi>
       </msup>
       <mi>𝐉</mi>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <mtext>odd</mtext>
     <mrow>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </msubsup>
    <mo>=</mo>
    <mrow>
     <mfrac>
      <mn>1</mn>
      <mn>144</mn>
     </mfrac>
     <mrow>
      <mo>(</mo>
      <mtable displaystyle="true">
       <mtr>
        <mtd columnalign="center">
         <mn>130</mn>
        </mtd>
        <mtd columnalign="center">
         <mrow>
          <mo>-</mo>
          <mn>34</mn>
         </mrow>
        </mtd>
       </mtr>
       <mtr>
        <mtd columnalign="center">
         <mrow>
          <mo>-</mo>
          <mn>34</mn>
         </mrow>
        </mtd>
        <mtd columnalign="center">
         <mn>10</mn>
        </mtd>
       </mtr>
      </mtable>
      <mo>)</mo>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>𝐉</ci>
         <ci>𝐓</ci>
        </apply>
        <ci>𝐉</ci>
       </apply>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <mtext>even</mtext>
     </apply>
     <list>
      <apply>
       <times></times>
       <apply>
        <divide></divide>
        <cn type="integer">1</cn>
        <cn type="integer">70</cn>
       </apply>
       <matrix>
        <matrixrow>
         <cn type="integer">34</cn>
         <apply>
          <minus></minus>
          <cn type="integer">10</cn>
         </apply>
        </matrixrow>
        <matrixrow>
         <apply>
          <minus></minus>
          <cn type="integer">10</cn>
         </apply>
         <cn type="integer">5</cn>
        </matrixrow>
       </matrix>
      </apply>
      <ci>and</ci>
     </list>
    </apply>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>𝐉</ci>
         <ci>𝐓</ci>
        </apply>
        <ci>𝐉</ci>
       </apply>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <mtext>odd</mtext>
     </apply>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <cn type="integer">144</cn>
      </apply>
      <matrix>
       <matrixrow>
        <cn type="integer">130</cn>
        <apply>
         <minus></minus>
         <cn type="integer">34</cn>
        </apply>
       </matrixrow>
       <matrixrow>
        <apply>
         <minus></minus>
         <cn type="integer">34</cn>
        </apply>
        <cn type="integer">10</cn>
       </matrixrow>
      </matrix>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (\mathbf{J^{T}J})^{-1}_{\text{even}}={1\over 70}\begin{pmatrix}34&-10\\
-10&5\\
\end{pmatrix}\quad\mathrm{and}\quad(\mathbf{J^{T}J})^{-1}_{\text{odd}}={1\over
1%
44}\begin{pmatrix}130&-34\\
-34&10\\
\end{pmatrix}
  </annotation>
 </semantics>
</math>

 The normal equations become</p>

<p>

<math display="block" id="Savitzky–Golay_filter:12">
 <semantics>
  <mrow>
   <msub>
    <mrow>
     <mo>(</mo>
     <mtable displaystyle="true">
      <mtr>
       <mtd columnalign="center">
        <msub>
         <mi>a</mi>
         <mn>0</mn>
        </msub>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <msub>
         <mi>a</mi>
         <mn>2</mn>
        </msub>
       </mtd>
      </mtr>
     </mtable>
     <mo>)</mo>
    </mrow>
    <mi>j</mi>
   </msub>
   <mo>=</mo>
   <mrow>
    <mfrac>
     <mn>1</mn>
     <mn>70</mn>
    </mfrac>
    <mrow>
     <mo>(</mo>
     <mtable displaystyle="true">
      <mtr>
       <mtd columnalign="center">
        <mn>34</mn>
       </mtd>
       <mtd columnalign="center">
        <mrow>
         <mo>-</mo>
         <mn>10</mn>
        </mrow>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mrow>
         <mo>-</mo>
         <mn>10</mn>
        </mrow>
       </mtd>
       <mtd columnalign="center">
        <mn>5</mn>
       </mtd>
      </mtr>
     </mtable>
     <mo>)</mo>
    </mrow>
    <mrow>
     <mo>(</mo>
     <mtable displaystyle="true">
      <mtr>
       <mtd columnalign="center">
        <mn>1</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>1</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>1</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>1</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>1</mn>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mn>4</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>1</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>1</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>4</mn>
       </mtd>
      </mtr>
     </mtable>
     <mo>)</mo>
    </mrow>
    <mrow>
     <mo>(</mo>
     <mtable displaystyle="true">
      <mtr>
       <mtd columnalign="center">
        <msub>
         <mi>y</mi>
         <mrow>
          <mi>j</mi>
          <mo>-</mo>
          <mn>2</mn>
         </mrow>
        </msub>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <msub>
         <mi>y</mi>
         <mrow>
          <mi>j</mi>
          <mo>-</mo>
          <mn>1</mn>
         </mrow>
        </msub>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <msub>
         <mi>y</mi>
         <mi>j</mi>
        </msub>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <msub>
         <mi>y</mi>
         <mrow>
          <mi>j</mi>
          <mo>+</mo>
          <mn>1</mn>
         </mrow>
        </msub>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <msub>
         <mi>y</mi>
         <mrow>
          <mi>j</mi>
          <mo>+</mo>
          <mn>2</mn>
         </mrow>
        </msub>
       </mtd>
      </mtr>
     </mtable>
     <mo>)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <matrix>
      <matrixrow>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>a</ci>
        <cn type="integer">0</cn>
       </apply>
      </matrixrow>
      <matrixrow>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>a</ci>
        <cn type="integer">2</cn>
       </apply>
      </matrixrow>
     </matrix>
     <ci>j</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <divide></divide>
      <cn type="integer">1</cn>
      <cn type="integer">70</cn>
     </apply>
     <matrix>
      <matrixrow>
       <cn type="integer">34</cn>
       <apply>
        <minus></minus>
        <cn type="integer">10</cn>
       </apply>
      </matrixrow>
      <matrixrow>
       <apply>
        <minus></minus>
        <cn type="integer">10</cn>
       </apply>
       <cn type="integer">5</cn>
      </matrixrow>
     </matrix>
     <matrix>
      <matrixrow>
       <cn type="integer">1</cn>
       <cn type="integer">1</cn>
       <cn type="integer">1</cn>
       <cn type="integer">1</cn>
       <cn type="integer">1</cn>
      </matrixrow>
      <matrixrow>
       <cn type="integer">4</cn>
       <cn type="integer">1</cn>
       <cn type="integer">0</cn>
       <cn type="integer">1</cn>
       <cn type="integer">4</cn>
      </matrixrow>
     </matrix>
     <matrix>
      <matrixrow>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>y</ci>
        <apply>
         <minus></minus>
         <ci>j</ci>
         <cn type="integer">2</cn>
        </apply>
       </apply>
      </matrixrow>
      <matrixrow>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>y</ci>
        <apply>
         <minus></minus>
         <ci>j</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
      </matrixrow>
      <matrixrow>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>y</ci>
        <ci>j</ci>
       </apply>
      </matrixrow>
      <matrixrow>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>y</ci>
        <apply>
         <plus></plus>
         <ci>j</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
      </matrixrow>
      <matrixrow>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>y</ci>
        <apply>
         <plus></plus>
         <ci>j</ci>
         <cn type="integer">2</cn>
        </apply>
       </apply>
      </matrixrow>
     </matrix>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \begin{pmatrix}{a_{0}}\\
{a_{2}}\\
\end{pmatrix}_{j}={1\over 70}\begin{pmatrix}34&-10\\
-10&5\end{pmatrix}\begin{pmatrix}1&1&1&1&1\\
4&1&0&1&4\\
\end{pmatrix}\begin{pmatrix}y_{j-2}\\
y_{j-1}\\
y_{j}\\
y_{j+1}\\
y_{j+2}\end{pmatrix}
  </annotation>
 </semantics>
</math>

 and</p>

<p>

<math display="block" id="Savitzky–Golay_filter:13">
 <semantics>
  <mrow>
   <msub>
    <mrow>
     <mo>(</mo>
     <mtable displaystyle="true">
      <mtr>
       <mtd columnalign="center">
        <msub>
         <mi>a</mi>
         <mn>1</mn>
        </msub>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <msub>
         <mi>a</mi>
         <mn>3</mn>
        </msub>
       </mtd>
      </mtr>
     </mtable>
     <mo>)</mo>
    </mrow>
    <mi>j</mi>
   </msub>
   <mo>=</mo>
   <mrow>
    <mfrac>
     <mn>1</mn>
     <mn>144</mn>
    </mfrac>
    <mrow>
     <mo>(</mo>
     <mtable displaystyle="true">
      <mtr>
       <mtd columnalign="center">
        <mn>130</mn>
       </mtd>
       <mtd columnalign="center">
        <mrow>
         <mo>-</mo>
         <mn>34</mn>
        </mrow>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mrow>
         <mo>-</mo>
         <mn>34</mn>
        </mrow>
       </mtd>
       <mtd columnalign="center">
        <mn>10</mn>
       </mtd>
      </mtr>
     </mtable>
     <mo>)</mo>
    </mrow>
    <mrow>
     <mo>(</mo>
     <mtable displaystyle="true">
      <mtr>
       <mtd columnalign="center">
        <mrow>
         <mo>-</mo>
         <mn>2</mn>
        </mrow>
       </mtd>
       <mtd columnalign="center">
        <mrow>
         <mo>-</mo>
         <mn>1</mn>
        </mrow>
       </mtd>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>1</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>2</mn>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mrow>
         <mo>-</mo>
         <mn>8</mn>
        </mrow>
       </mtd>
       <mtd columnalign="center">
        <mrow>
         <mo>-</mo>
         <mn>1</mn>
        </mrow>
       </mtd>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>1</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>8</mn>
       </mtd>
      </mtr>
     </mtable>
     <mo>)</mo>
    </mrow>
    <mrow>
     <mo>(</mo>
     <mtable displaystyle="true">
      <mtr>
       <mtd columnalign="center">
        <msub>
         <mi>y</mi>
         <mrow>
          <mi>j</mi>
          <mo>-</mo>
          <mn>2</mn>
         </mrow>
        </msub>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <msub>
         <mi>y</mi>
         <mrow>
          <mi>j</mi>
          <mo>-</mo>
          <mn>1</mn>
         </mrow>
        </msub>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <msub>
         <mi>y</mi>
         <mi>j</mi>
        </msub>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <msub>
         <mi>y</mi>
         <mrow>
          <mi>j</mi>
          <mo>+</mo>
          <mn>1</mn>
         </mrow>
        </msub>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <msub>
         <mi>y</mi>
         <mrow>
          <mi>j</mi>
          <mo>+</mo>
          <mn>2</mn>
         </mrow>
        </msub>
       </mtd>
      </mtr>
     </mtable>
     <mo>)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <matrix>
      <matrixrow>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>a</ci>
        <cn type="integer">1</cn>
       </apply>
      </matrixrow>
      <matrixrow>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>a</ci>
        <cn type="integer">3</cn>
       </apply>
      </matrixrow>
     </matrix>
     <ci>j</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <divide></divide>
      <cn type="integer">1</cn>
      <cn type="integer">144</cn>
     </apply>
     <matrix>
      <matrixrow>
       <cn type="integer">130</cn>
       <apply>
        <minus></minus>
        <cn type="integer">34</cn>
       </apply>
      </matrixrow>
      <matrixrow>
       <apply>
        <minus></minus>
        <cn type="integer">34</cn>
       </apply>
       <cn type="integer">10</cn>
      </matrixrow>
     </matrix>
     <matrix>
      <matrixrow>
       <apply>
        <minus></minus>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
       </apply>
       <cn type="integer">0</cn>
       <cn type="integer">1</cn>
       <cn type="integer">2</cn>
      </matrixrow>
      <matrixrow>
       <apply>
        <minus></minus>
        <cn type="integer">8</cn>
       </apply>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
       </apply>
       <cn type="integer">0</cn>
       <cn type="integer">1</cn>
       <cn type="integer">8</cn>
      </matrixrow>
     </matrix>
     <matrix>
      <matrixrow>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>y</ci>
        <apply>
         <minus></minus>
         <ci>j</ci>
         <cn type="integer">2</cn>
        </apply>
       </apply>
      </matrixrow>
      <matrixrow>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>y</ci>
        <apply>
         <minus></minus>
         <ci>j</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
      </matrixrow>
      <matrixrow>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>y</ci>
        <ci>j</ci>
       </apply>
      </matrixrow>
      <matrixrow>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>y</ci>
        <apply>
         <plus></plus>
         <ci>j</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
      </matrixrow>
      <matrixrow>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>y</ci>
        <apply>
         <plus></plus>
         <ci>j</ci>
         <cn type="integer">2</cn>
        </apply>
       </apply>
      </matrixrow>
     </matrix>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \begin{pmatrix}a_{1}\\
a_{3}\\
\end{pmatrix}_{j}={1\over 144}\begin{pmatrix}130&-34\\
-34&10\\
\end{pmatrix}\begin{pmatrix}-2&-1&0&1&2\\
-8&-1&0&1&8\\
\end{pmatrix}\begin{pmatrix}y_{j-2}\\
y_{j-1}\\
y_{j}\\
y_{j+1}\\
y_{j+2}\\
\end{pmatrix}
  </annotation>
 </semantics>
</math>

 Multiplying out and removing common factors,</p>

<p>

<math display="block" id="Savitzky–Golay_filter:14">
 <semantics>
  <mrow>
   <msub>
    <mi>a</mi>
    <mrow>
     <mn>0</mn>
     <mo>,</mo>
     <mi>j</mi>
    </mrow>
   </msub>
   <mo>=</mo>
   <mrow>
    <mfrac>
     <mn>1</mn>
     <mn>35</mn>
    </mfrac>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mrow>
       <mrow>
        <mo>-</mo>
        <mrow>
         <mn>3</mn>
         <msub>
          <mi>y</mi>
          <mrow>
           <mi>j</mi>
           <mo>-</mo>
           <mn>2</mn>
          </mrow>
         </msub>
        </mrow>
       </mrow>
       <mo>+</mo>
       <mrow>
        <mn>12</mn>
        <msub>
         <mi>y</mi>
         <mrow>
          <mi>j</mi>
          <mo>-</mo>
          <mn>1</mn>
         </mrow>
        </msub>
       </mrow>
       <mo>+</mo>
       <mrow>
        <mn>17</mn>
        <msub>
         <mi>y</mi>
         <mi>j</mi>
        </msub>
       </mrow>
       <mo>+</mo>
       <mrow>
        <mn>12</mn>
        <msub>
         <mi>y</mi>
         <mrow>
          <mi>j</mi>
          <mo>+</mo>
          <mn>1</mn>
         </mrow>
        </msub>
       </mrow>
      </mrow>
      <mo>-</mo>
      <mrow>
       <mn>3</mn>
       <msub>
        <mi>y</mi>
        <mrow>
         <mi>j</mi>
         <mo>+</mo>
         <mn>2</mn>
        </mrow>
       </msub>
      </mrow>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>a</ci>
     <list>
      <cn type="integer">0</cn>
      <ci>j</ci>
     </list>
    </apply>
    <apply>
     <times></times>
     <apply>
      <divide></divide>
      <cn type="integer">1</cn>
      <cn type="integer">35</cn>
     </apply>
     <apply>
      <minus></minus>
      <apply>
       <plus></plus>
       <apply>
        <minus></minus>
        <apply>
         <times></times>
         <cn type="integer">3</cn>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>y</ci>
          <apply>
           <minus></minus>
           <ci>j</ci>
           <cn type="integer">2</cn>
          </apply>
         </apply>
        </apply>
       </apply>
       <apply>
        <times></times>
        <cn type="integer">12</cn>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>y</ci>
         <apply>
          <minus></minus>
          <ci>j</ci>
          <cn type="integer">1</cn>
         </apply>
        </apply>
       </apply>
       <apply>
        <times></times>
        <cn type="integer">17</cn>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>y</ci>
         <ci>j</ci>
        </apply>
       </apply>
       <apply>
        <times></times>
        <cn type="integer">12</cn>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>y</ci>
         <apply>
          <plus></plus>
          <ci>j</ci>
          <cn type="integer">1</cn>
         </apply>
        </apply>
       </apply>
      </apply>
      <apply>
       <times></times>
       <cn type="integer">3</cn>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>y</ci>
        <apply>
         <plus></plus>
         <ci>j</ci>
         <cn type="integer">2</cn>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a_{0,j}={1\over 35}(-3y_{j-2}+12y_{j-1}+17y_{j}+12y_{j+1}-3y_{j+2})
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Savitzky–Golay_filter:15">
 <semantics>
  <mrow>
   <msub>
    <mi>a</mi>
    <mrow>
     <mn>1</mn>
     <mo>,</mo>
     <mi>j</mi>
    </mrow>
   </msub>
   <mo>=</mo>
   <mrow>
    <mfrac>
     <mn>1</mn>
     <mn>12</mn>
    </mfrac>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mrow>
       <mrow>
        <msub>
         <mi>y</mi>
         <mrow>
          <mi>j</mi>
          <mo>-</mo>
          <mn>2</mn>
         </mrow>
        </msub>
        <mo>-</mo>
        <mrow>
         <mn>8</mn>
         <msub>
          <mi>y</mi>
          <mrow>
           <mi>j</mi>
           <mo>-</mo>
           <mn>1</mn>
          </mrow>
         </msub>
        </mrow>
       </mrow>
       <mo>+</mo>
       <mrow>
        <mn>8</mn>
        <msub>
         <mi>y</mi>
         <mrow>
          <mi>j</mi>
          <mo>+</mo>
          <mn>1</mn>
         </mrow>
        </msub>
       </mrow>
      </mrow>
      <mo>-</mo>
      <msub>
       <mi>y</mi>
       <mrow>
        <mi>j</mi>
        <mo>+</mo>
        <mn>2</mn>
       </mrow>
      </msub>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>a</ci>
     <list>
      <cn type="integer">1</cn>
      <ci>j</ci>
     </list>
    </apply>
    <apply>
     <times></times>
     <apply>
      <divide></divide>
      <cn type="integer">1</cn>
      <cn type="integer">12</cn>
     </apply>
     <apply>
      <minus></minus>
      <apply>
       <plus></plus>
       <apply>
        <minus></minus>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>y</ci>
         <apply>
          <minus></minus>
          <ci>j</ci>
          <cn type="integer">2</cn>
         </apply>
        </apply>
        <apply>
         <times></times>
         <cn type="integer">8</cn>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>y</ci>
          <apply>
           <minus></minus>
           <ci>j</ci>
           <cn type="integer">1</cn>
          </apply>
         </apply>
        </apply>
       </apply>
       <apply>
        <times></times>
        <cn type="integer">8</cn>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>y</ci>
         <apply>
          <plus></plus>
          <ci>j</ci>
          <cn type="integer">1</cn>
         </apply>
        </apply>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>y</ci>
       <apply>
        <plus></plus>
        <ci>j</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a_{1,j}={1\over 12}(y_{j-2}-8y_{j-1}+8y_{j+1}-y_{j+2})
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Savitzky–Golay_filter:16">
 <semantics>
  <mrow>
   <msub>
    <mi>a</mi>
    <mrow>
     <mn>2</mn>
     <mo>,</mo>
     <mi>j</mi>
    </mrow>
   </msub>
   <mo>=</mo>
   <mrow>
    <mfrac>
     <mn>1</mn>
     <mn>14</mn>
    </mfrac>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mrow>
       <mrow>
        <mn>2</mn>
        <msub>
         <mi>y</mi>
         <mrow>
          <mi>j</mi>
          <mo>-</mo>
          <mn>2</mn>
         </mrow>
        </msub>
       </mrow>
       <mo>-</mo>
       <msub>
        <mi>y</mi>
        <mrow>
         <mi>j</mi>
         <mo>-</mo>
         <mn>1</mn>
        </mrow>
       </msub>
       <mo>-</mo>
       <mrow>
        <mn>2</mn>
        <msub>
         <mi>y</mi>
         <mi>j</mi>
        </msub>
       </mrow>
       <mo>-</mo>
       <msub>
        <mi>y</mi>
        <mrow>
         <mi>j</mi>
         <mo>+</mo>
         <mn>1</mn>
        </mrow>
       </msub>
      </mrow>
      <mo>+</mo>
      <mrow>
       <mn>2</mn>
       <msub>
        <mi>y</mi>
        <mrow>
         <mi>j</mi>
         <mo>+</mo>
         <mn>2</mn>
        </mrow>
       </msub>
      </mrow>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>a</ci>
     <list>
      <cn type="integer">2</cn>
      <ci>j</ci>
     </list>
    </apply>
    <apply>
     <times></times>
     <apply>
      <divide></divide>
      <cn type="integer">1</cn>
      <cn type="integer">14</cn>
     </apply>
     <apply>
      <plus></plus>
      <apply>
       <minus></minus>
       <apply>
        <times></times>
        <cn type="integer">2</cn>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>y</ci>
         <apply>
          <minus></minus>
          <ci>j</ci>
          <cn type="integer">2</cn>
         </apply>
        </apply>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>y</ci>
        <apply>
         <minus></minus>
         <ci>j</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <apply>
        <times></times>
        <cn type="integer">2</cn>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>y</ci>
         <ci>j</ci>
        </apply>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>y</ci>
        <apply>
         <plus></plus>
         <ci>j</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
      </apply>
      <apply>
       <times></times>
       <cn type="integer">2</cn>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>y</ci>
        <apply>
         <plus></plus>
         <ci>j</ci>
         <cn type="integer">2</cn>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a_{2,j}={1\over 14}(2y_{j-2}-y_{j-1}-2y_{j}-y_{j+1}+2y_{j+2})
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Savitzky–Golay_filter:17">
 <semantics>
  <mrow>
   <msub>
    <mi>a</mi>
    <mrow>
     <mn>3</mn>
     <mo>,</mo>
     <mi>j</mi>
    </mrow>
   </msub>
   <mo>=</mo>
   <mrow>
    <mfrac>
     <mn>1</mn>
     <mn>12</mn>
    </mfrac>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mrow>
       <mrow>
        <mrow>
         <mo>-</mo>
         <msub>
          <mi>y</mi>
          <mrow>
           <mi>j</mi>
           <mo>-</mo>
           <mn>2</mn>
          </mrow>
         </msub>
        </mrow>
        <mo>+</mo>
        <mrow>
         <mn>2</mn>
         <msub>
          <mi>y</mi>
          <mrow>
           <mi>j</mi>
           <mo>-</mo>
           <mn>1</mn>
          </mrow>
         </msub>
        </mrow>
       </mrow>
       <mo>-</mo>
       <mrow>
        <mn>2</mn>
        <msub>
         <mi>y</mi>
         <mrow>
          <mi>j</mi>
          <mo>+</mo>
          <mn>1</mn>
         </mrow>
        </msub>
       </mrow>
      </mrow>
      <mo>+</mo>
      <msub>
       <mi>y</mi>
       <mrow>
        <mi>j</mi>
        <mo>+</mo>
        <mn>2</mn>
       </mrow>
      </msub>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>a</ci>
     <list>
      <cn type="integer">3</cn>
      <ci>j</ci>
     </list>
    </apply>
    <apply>
     <times></times>
     <apply>
      <divide></divide>
      <cn type="integer">1</cn>
      <cn type="integer">12</cn>
     </apply>
     <apply>
      <plus></plus>
      <apply>
       <minus></minus>
       <apply>
        <plus></plus>
        <apply>
         <minus></minus>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>y</ci>
          <apply>
           <minus></minus>
           <ci>j</ci>
           <cn type="integer">2</cn>
          </apply>
         </apply>
        </apply>
        <apply>
         <times></times>
         <cn type="integer">2</cn>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>y</ci>
          <apply>
           <minus></minus>
           <ci>j</ci>
           <cn type="integer">1</cn>
          </apply>
         </apply>
        </apply>
       </apply>
       <apply>
        <times></times>
        <cn type="integer">2</cn>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>y</ci>
         <apply>
          <plus></plus>
          <ci>j</ci>
          <cn type="integer">1</cn>
         </apply>
        </apply>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>y</ci>
       <apply>
        <plus></plus>
        <ci>j</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a_{3,j}={1\over 12}(-y_{j-2}+2y_{j-1}-2y_{j+1}+y_{j+2})
  </annotation>
 </semantics>
</math>

</p>

<p>The coefficients of <em>y</em> in these expressions are known as <a class="uri" href="convolution" title="wikilink">convolution</a> coefficients. They are elements of the matrix</p>

<p>

<math display="block" id="Savitzky–Golay_filter:18">
 <semantics>
  <mrow>
   <mi>𝐂</mi>
   <mo>=</mo>
   <mrow>
    <msup>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <msup>
        <mi>𝐉</mi>
        <mi>𝐓</mi>
       </msup>
       <mi>𝐉</mi>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <mrow>
      <mo>-</mo>
      <mn>𝟏</mn>
     </mrow>
    </msup>
    <msup>
     <mi>𝐉</mi>
     <mi>𝐓</mi>
    </msup>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>𝐂</ci>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>𝐉</ci>
        <ci>𝐓</ci>
       </apply>
       <ci>𝐉</ci>
      </apply>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>𝐉</ci>
      <ci>𝐓</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{C=(J^{T}J)^{-1}J^{T}}
  </annotation>
 </semantics>
</math>

 In general,</p>

<p>

<math display="block" id="Savitzky–Golay_filter:19">
 <semantics>
  <mrow>
   <mrow>
    <mpadded width="+5pt">
     <msub>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mi>C</mi>
        <mo>⊗</mo>
        <mi>y</mi>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
      <mi>j</mi>
     </msub>
    </mpadded>
    <mo>=</mo>
    <msub>
     <mi>Y</mi>
     <mi>j</mi>
    </msub>
    <mo>=</mo>
    <mrow>
     <munderover>
      <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
      <mrow>
       <mi>i</mi>
       <mo>=</mo>
       <mrow>
        <mo>-</mo>
        <mrow>
         <mrow>
          <mo stretchy="false">(</mo>
          <mrow>
           <mi>m</mi>
           <mo>-</mo>
           <mn>1</mn>
          </mrow>
          <mo stretchy="false">)</mo>
         </mrow>
         <mo>/</mo>
         <mn>2</mn>
        </mrow>
       </mrow>
      </mrow>
      <mrow>
       <mi>i</mi>
       <mo>=</mo>
       <mrow>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <mi>m</mi>
          <mo>-</mo>
          <mn>1</mn>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
        <mo>/</mo>
        <mn>2</mn>
       </mrow>
      </mrow>
     </munderover>
     <mrow>
      <mpadded width="+1.7pt">
       <msub>
        <mi>C</mi>
        <mi>i</mi>
       </msub>
      </mpadded>
      <msub>
       <mi>y</mi>
       <mrow>
        <mi>j</mi>
        <mo>+</mo>
        <mi>i</mi>
       </mrow>
      </msub>
     </mrow>
    </mrow>
   </mrow>
   <mrow>
    <mfrac>
     <mrow>
      <mi>m</mi>
      <mo>+</mo>
      <mn>1</mn>
     </mrow>
     <mn>2</mn>
    </mfrac>
    <mo>≤</mo>
    <mi>j</mi>
    <mo>≤</mo>
    <mrow>
     <mi>n</mi>
     <mo>-</mo>
     <mfrac>
      <mrow>
       <mi>m</mi>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
      <mn>2</mn>
     </mfrac>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <and></and>
     <apply>
      <eq></eq>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <apply>
        <csymbol cd="latexml">tensor-product</csymbol>
        <ci>C</ci>
        <ci>y</ci>
       </apply>
       <ci>j</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>Y</ci>
       <ci>j</ci>
      </apply>
     </apply>
     <apply>
      <eq></eq>
      <share href="#.cmml">
      </share>
      <apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <sum></sum>
         <apply>
          <eq></eq>
          <ci>i</ci>
          <apply>
           <minus></minus>
           <apply>
            <divide></divide>
            <apply>
             <minus></minus>
             <ci>m</ci>
             <cn type="integer">1</cn>
            </apply>
            <cn type="integer">2</cn>
           </apply>
          </apply>
         </apply>
        </apply>
        <apply>
         <eq></eq>
         <ci>i</ci>
         <apply>
          <divide></divide>
          <apply>
           <minus></minus>
           <ci>m</ci>
           <cn type="integer">1</cn>
          </apply>
          <cn type="integer">2</cn>
         </apply>
        </apply>
       </apply>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>C</ci>
         <ci>i</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>y</ci>
         <apply>
          <plus></plus>
          <ci>j</ci>
          <ci>i</ci>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <and></and>
     <apply>
      <leq></leq>
      <apply>
       <divide></divide>
       <apply>
        <plus></plus>
        <ci>m</ci>
        <cn type="integer">1</cn>
       </apply>
       <cn type="integer">2</cn>
      </apply>
      <ci>j</ci>
     </apply>
     <apply>
      <leq></leq>
      <share href="#.cmml">
      </share>
      <apply>
       <minus></minus>
       <ci>n</ci>
       <apply>
        <divide></divide>
        <apply>
         <minus></minus>
         <ci>m</ci>
         <cn type="integer">1</cn>
        </apply>
        <cn type="integer">2</cn>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (C\otimes y)_{j}\ =Y_{j}=\sum_{i=-(m-1)/2}^{i=(m-1)/2}C_{i}\,y_{j+i}\qquad%
\frac{m+1}{2}\leq j\leq n-\frac{m-1}{2}
  </annotation>
 </semantics>
</math>

 In matrix notation this example is written as</p>

<p>

<math display="block" id="Savitzky–Golay_filter:20">
 <semantics>
  <mrow>
   <mrow>
    <mo>(</mo>
    <mtable displaystyle="true">
     <mtr>
      <mtd columnalign="center">
       <msub>
        <mi>Y</mi>
        <mn>3</mn>
       </msub>
      </mtd>
     </mtr>
     <mtr>
      <mtd columnalign="center">
       <msub>
        <mi>Y</mi>
        <mn>4</mn>
       </msub>
      </mtd>
     </mtr>
     <mtr>
      <mtd columnalign="center">
       <msub>
        <mi>Y</mi>
        <mn>5</mn>
       </msub>
      </mtd>
     </mtr>
     <mtr>
      <mtd columnalign="center">
       <mi mathvariant="normal">…</mi>
      </mtd>
     </mtr>
    </mtable>
    <mo>)</mo>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mfrac>
     <mn>1</mn>
     <mn>35</mn>
    </mfrac>
    <mrow>
     <mo>(</mo>
     <mtable displaystyle="true">
      <mtr>
       <mtd columnalign="center">
        <mrow>
         <mo>-</mo>
         <mn>3</mn>
        </mrow>
       </mtd>
       <mtd columnalign="center">
        <mn>12</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>17</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>12</mn>
       </mtd>
       <mtd columnalign="center">
        <mrow>
         <mo>-</mo>
         <mn>3</mn>
        </mrow>
       </mtd>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
       <mtd columnalign="center">
        <mi mathvariant="normal">…</mi>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
       <mtd columnalign="center">
        <mrow>
         <mo>-</mo>
         <mn>3</mn>
        </mrow>
       </mtd>
       <mtd columnalign="center">
        <mn>12</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>17</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>12</mn>
       </mtd>
       <mtd columnalign="center">
        <mrow>
         <mo>-</mo>
         <mn>3</mn>
        </mrow>
       </mtd>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
       <mtd columnalign="center">
        <mi mathvariant="normal">…</mi>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
       <mtd columnalign="center">
        <mrow>
         <mo>-</mo>
         <mn>3</mn>
        </mrow>
       </mtd>
       <mtd columnalign="center">
        <mn>12</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>17</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>12</mn>
       </mtd>
       <mtd columnalign="center">
        <mrow>
         <mo>-</mo>
         <mn>3</mn>
        </mrow>
       </mtd>
       <mtd columnalign="center">
        <mi mathvariant="normal">…</mi>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mi mathvariant="normal">…</mi>
       </mtd>
      </mtr>
     </mtable>
     <mo>)</mo>
    </mrow>
    <mrow>
     <mo>(</mo>
     <mtable displaystyle="true">
      <mtr>
       <mtd columnalign="center">
        <msub>
         <mi>y</mi>
         <mn>1</mn>
        </msub>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <msub>
         <mi>y</mi>
         <mn>2</mn>
        </msub>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <msub>
         <mi>y</mi>
         <mn>3</mn>
        </msub>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <msub>
         <mi>y</mi>
         <mn>4</mn>
        </msub>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <msub>
         <mi>y</mi>
         <mn>5</mn>
        </msub>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <msub>
         <mi>y</mi>
         <mn>6</mn>
        </msub>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <msub>
         <mi>y</mi>
         <mn>7</mn>
        </msub>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mi mathvariant="normal">…</mi>
       </mtd>
      </mtr>
     </mtable>
     <mo>)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <matrix>
     <matrixrow>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>Y</ci>
       <cn type="integer">3</cn>
      </apply>
     </matrixrow>
     <matrixrow>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>Y</ci>
       <cn type="integer">4</cn>
      </apply>
     </matrixrow>
     <matrixrow>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>Y</ci>
       <cn type="integer">5</cn>
      </apply>
     </matrixrow>
     <matrixrow>
      <ci>normal-…</ci>
     </matrixrow>
    </matrix>
    <apply>
     <times></times>
     <apply>
      <divide></divide>
      <cn type="integer">1</cn>
      <cn type="integer">35</cn>
     </apply>
     <matrix>
      <matrixrow>
       <apply>
        <minus></minus>
        <cn type="integer">3</cn>
       </apply>
       <cn type="integer">12</cn>
       <cn type="integer">17</cn>
       <cn type="integer">12</cn>
       <apply>
        <minus></minus>
        <cn type="integer">3</cn>
       </apply>
       <cn type="integer">0</cn>
       <cn type="integer">0</cn>
       <ci>normal-…</ci>
      </matrixrow>
      <matrixrow>
       <cn type="integer">0</cn>
       <apply>
        <minus></minus>
        <cn type="integer">3</cn>
       </apply>
       <cn type="integer">12</cn>
       <cn type="integer">17</cn>
       <cn type="integer">12</cn>
       <apply>
        <minus></minus>
        <cn type="integer">3</cn>
       </apply>
       <cn type="integer">0</cn>
       <ci>normal-…</ci>
      </matrixrow>
      <matrixrow>
       <cn type="integer">0</cn>
       <cn type="integer">0</cn>
       <apply>
        <minus></minus>
        <cn type="integer">3</cn>
       </apply>
       <cn type="integer">12</cn>
       <cn type="integer">17</cn>
       <cn type="integer">12</cn>
       <apply>
        <minus></minus>
        <cn type="integer">3</cn>
       </apply>
       <ci>normal-…</ci>
      </matrixrow>
      <matrixrow>
       <ci>normal-…</ci>
      </matrixrow>
     </matrix>
     <matrix>
      <matrixrow>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>y</ci>
        <cn type="integer">1</cn>
       </apply>
      </matrixrow>
      <matrixrow>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>y</ci>
        <cn type="integer">2</cn>
       </apply>
      </matrixrow>
      <matrixrow>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>y</ci>
        <cn type="integer">3</cn>
       </apply>
      </matrixrow>
      <matrixrow>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>y</ci>
        <cn type="integer">4</cn>
       </apply>
      </matrixrow>
      <matrixrow>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>y</ci>
        <cn type="integer">5</cn>
       </apply>
      </matrixrow>
      <matrixrow>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>y</ci>
        <cn type="integer">6</cn>
       </apply>
      </matrixrow>
      <matrixrow>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>y</ci>
        <cn type="integer">7</cn>
       </apply>
      </matrixrow>
      <matrixrow>
       <ci>normal-…</ci>
      </matrixrow>
     </matrix>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \begin{pmatrix}Y_{3}\\
Y_{4}\\
Y_{5}\\
\dots\end{pmatrix}={1\over 35}\begin{pmatrix}-3&12&17&12&-3&0&0&\dots\\
0&-3&12&17&12&-3&0&\dots\\
0&0&-3&12&17&12&-3&\dots\\
\par
\dots\end{pmatrix}\begin{pmatrix}y_{1}\\
y_{2}\\
y_{3}\\
y_{4}\\
y_{5}\\
y_{6}\\
y_{7}\\
\dots\end{pmatrix}
  </annotation>
 </semantics>
</math>

</p>

<p>Tables of convolution coefficients, calculated in the same way for <em>m</em> up to 25, were published for the Savitzky–Golay smoothing filter in 1964,<a class="footnoteRef" href="#fn17" id="fnref17"><sup>17</sup></a><a class="footnoteRef" href="#fn18" id="fnref18"><sup>18</sup></a> The value of the central point, <em>z</em> = 0, is obtained from a single set of coefficients, <em>a</em><sub>0</sub> for smoothing, <em>a</em><sub>1</sub> for 1st. derivative etc. The numerical derivatives are obtained by differentiating Y. This means that the <em>derivatives are calculated for the smoothed data curve</em>. For a cubic polynomial</p>

<p>

<math display="block" id="Savitzky–Golay_filter:21">
 <semantics>
  <mrow>
   <mrow>
    <mi>Y</mi>
    <mo>=</mo>
    <mrow>
     <msub>
      <mi>a</mi>
      <mn>0</mn>
     </msub>
     <mo>+</mo>
     <mrow>
      <msub>
       <mi>a</mi>
       <mn>1</mn>
      </msub>
      <mi>z</mi>
     </mrow>
     <mo>+</mo>
     <mrow>
      <msub>
       <mi>a</mi>
       <mn>2</mn>
      </msub>
      <msup>
       <mi>z</mi>
       <mn>2</mn>
      </msup>
     </mrow>
     <mo>+</mo>
     <mrow>
      <msub>
       <mi>a</mi>
       <mn>3</mn>
      </msub>
      <msup>
       <mi>z</mi>
       <mn>3</mn>
      </msup>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <msub>
      <mi>a</mi>
      <mn>0</mn>
     </msub>
     <mtext>at</mtext>
     <mi>z</mi>
    </mrow>
    <mo>=</mo>
    <mn>0</mn>
   </mrow>
   <mo>,</mo>
   <mrow>
    <mi>x</mi>
    <mo>=</mo>
    <mover accent="true">
     <mi>x</mi>
     <mo stretchy="false">¯</mo>
    </mover>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <and></and>
     <apply>
      <eq></eq>
      <ci>Y</ci>
      <apply>
       <plus></plus>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>a</ci>
        <cn type="integer">0</cn>
       </apply>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>a</ci>
         <cn type="integer">1</cn>
        </apply>
        <ci>z</ci>
       </apply>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>a</ci>
         <cn type="integer">2</cn>
        </apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>z</ci>
         <cn type="integer">2</cn>
        </apply>
       </apply>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>a</ci>
         <cn type="integer">3</cn>
        </apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>z</ci>
         <cn type="integer">3</cn>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <eq></eq>
      <share href="#.cmml">
      </share>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>a</ci>
        <cn type="integer">0</cn>
       </apply>
       <mtext>at</mtext>
       <ci>z</ci>
      </apply>
     </apply>
     <apply>
      <eq></eq>
      <share href="#.cmml">
      </share>
      <cn type="integer">0</cn>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <ci>x</ci>
     <apply>
      <ci>normal-¯</ci>
      <ci>x</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Y=a_{0}+a_{1}z+a_{2}z^{2}+a_{3}z^{3}=a_{0}\text{ at }z=0,x=\bar{x}
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Savitzky–Golay_filter:22">
 <semantics>
  <mrow>
   <mrow>
    <mfrac>
     <mrow>
      <mi>d</mi>
      <mi>Y</mi>
     </mrow>
     <mrow>
      <mi>d</mi>
      <mi>x</mi>
     </mrow>
    </mfrac>
    <mo>=</mo>
    <mrow>
     <mfrac>
      <mn>1</mn>
      <mi>h</mi>
     </mfrac>
     <mrow>
      <mo>(</mo>
      <mrow>
       <msub>
        <mi>a</mi>
        <mn>1</mn>
       </msub>
       <mo>+</mo>
       <mrow>
        <mn>2</mn>
        <msub>
         <mi>a</mi>
         <mn>2</mn>
        </msub>
        <mi>z</mi>
       </mrow>
       <mo>+</mo>
       <mrow>
        <mn>3</mn>
        <msub>
         <mi>a</mi>
         <mn>3</mn>
        </msub>
        <msup>
         <mi>z</mi>
         <mn>2</mn>
        </msup>
       </mrow>
      </mrow>
      <mo>)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mfrac>
      <mn>1</mn>
      <mi>h</mi>
     </mfrac>
     <msub>
      <mi>a</mi>
      <mn>1</mn>
     </msub>
     <mtext>at</mtext>
     <mi>z</mi>
    </mrow>
    <mo>=</mo>
    <mn>0</mn>
   </mrow>
   <mo>,</mo>
   <mrow>
    <mi>x</mi>
    <mo>=</mo>
    <mover accent="true">
     <mi>x</mi>
     <mo stretchy="false">¯</mo>
    </mover>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <and></and>
     <apply>
      <eq></eq>
      <apply>
       <divide></divide>
       <apply>
        <times></times>
        <ci>d</ci>
        <ci>Y</ci>
       </apply>
       <apply>
        <times></times>
        <ci>d</ci>
        <ci>x</ci>
       </apply>
      </apply>
      <apply>
       <times></times>
       <apply>
        <divide></divide>
        <cn type="integer">1</cn>
        <ci>h</ci>
       </apply>
       <apply>
        <plus></plus>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>a</ci>
         <cn type="integer">1</cn>
        </apply>
        <apply>
         <times></times>
         <cn type="integer">2</cn>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>a</ci>
          <cn type="integer">2</cn>
         </apply>
         <ci>z</ci>
        </apply>
        <apply>
         <times></times>
         <cn type="integer">3</cn>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>a</ci>
          <cn type="integer">3</cn>
         </apply>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>z</ci>
          <cn type="integer">2</cn>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <eq></eq>
      <share href="#.cmml">
      </share>
      <apply>
       <times></times>
       <apply>
        <divide></divide>
        <cn type="integer">1</cn>
        <ci>h</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>a</ci>
        <cn type="integer">1</cn>
       </apply>
       <mtext>at</mtext>
       <ci>z</ci>
      </apply>
     </apply>
     <apply>
      <eq></eq>
      <share href="#.cmml">
      </share>
      <cn type="integer">0</cn>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <ci>x</ci>
     <apply>
      <ci>normal-¯</ci>
      <ci>x</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \frac{{dY}}{{dx}}=\frac{1}{h}\left({a_{1}+2a_{2}z+3a_{3}z^{2}}\right)=\frac{1}%
{h}a_{1}\text{ at }z=0,x=\bar{x}
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Savitzky–Golay_filter:23">
 <semantics>
  <mrow>
   <mrow>
    <mfrac>
     <mrow>
      <msup>
       <mi>d</mi>
       <mn>2</mn>
      </msup>
      <mi>Y</mi>
     </mrow>
     <mrow>
      <mi>d</mi>
      <msup>
       <mi>x</mi>
       <mn>2</mn>
      </msup>
     </mrow>
    </mfrac>
    <mo>=</mo>
    <mrow>
     <mfrac>
      <mn>1</mn>
      <msup>
       <mi>h</mi>
       <mn>2</mn>
      </msup>
     </mfrac>
     <mrow>
      <mo>(</mo>
      <mrow>
       <mrow>
        <mn>2</mn>
        <msub>
         <mi>a</mi>
         <mn>2</mn>
        </msub>
       </mrow>
       <mo>+</mo>
       <mrow>
        <mn>6</mn>
        <msub>
         <mi>a</mi>
         <mn>3</mn>
        </msub>
        <mi>z</mi>
       </mrow>
      </mrow>
      <mo>)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mfrac>
      <mn>2</mn>
      <msup>
       <mi>h</mi>
       <mn>2</mn>
      </msup>
     </mfrac>
     <msub>
      <mi>a</mi>
      <mn>2</mn>
     </msub>
     <mtext>at</mtext>
     <mi>z</mi>
    </mrow>
    <mo>=</mo>
    <mn>0</mn>
   </mrow>
   <mo>,</mo>
   <mrow>
    <mi>x</mi>
    <mo>=</mo>
    <mover accent="true">
     <mi>x</mi>
     <mo stretchy="false">¯</mo>
    </mover>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <and></and>
     <apply>
      <eq></eq>
      <apply>
       <divide></divide>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>d</ci>
         <cn type="integer">2</cn>
        </apply>
        <ci>Y</ci>
       </apply>
       <apply>
        <times></times>
        <ci>d</ci>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>x</ci>
         <cn type="integer">2</cn>
        </apply>
       </apply>
      </apply>
      <apply>
       <times></times>
       <apply>
        <divide></divide>
        <cn type="integer">1</cn>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>h</ci>
         <cn type="integer">2</cn>
        </apply>
       </apply>
       <apply>
        <plus></plus>
        <apply>
         <times></times>
         <cn type="integer">2</cn>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>a</ci>
          <cn type="integer">2</cn>
         </apply>
        </apply>
        <apply>
         <times></times>
         <cn type="integer">6</cn>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>a</ci>
          <cn type="integer">3</cn>
         </apply>
         <ci>z</ci>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <eq></eq>
      <share href="#.cmml">
      </share>
      <apply>
       <times></times>
       <apply>
        <divide></divide>
        <cn type="integer">2</cn>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>h</ci>
         <cn type="integer">2</cn>
        </apply>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>a</ci>
        <cn type="integer">2</cn>
       </apply>
       <mtext>at</mtext>
       <ci>z</ci>
      </apply>
     </apply>
     <apply>
      <eq></eq>
      <share href="#.cmml">
      </share>
      <cn type="integer">0</cn>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <ci>x</ci>
     <apply>
      <ci>normal-¯</ci>
      <ci>x</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \frac{{d^{2}Y}}{{dx^{2}}}=\frac{1}{{h^{2}}}\left({2a_{2}+6a_{3}z}\right)=\frac%
{2}{h^{2}}a_{2}{\text{ at }}z=0,x=\bar{x}
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Savitzky–Golay_filter:24">
 <semantics>
  <mrow>
   <mfrac>
    <mrow>
     <msup>
      <mi>d</mi>
      <mn>3</mn>
     </msup>
     <mi>Y</mi>
    </mrow>
    <mrow>
     <mi>d</mi>
     <msup>
      <mi>x</mi>
      <mn>3</mn>
     </msup>
    </mrow>
   </mfrac>
   <mo>=</mo>
   <mrow>
    <mfrac>
     <mn>6</mn>
     <msup>
      <mi>h</mi>
      <mn>3</mn>
     </msup>
    </mfrac>
    <msub>
     <mi>a</mi>
     <mn>3</mn>
    </msub>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <divide></divide>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>d</ci>
       <cn type="integer">3</cn>
      </apply>
      <ci>Y</ci>
     </apply>
     <apply>
      <times></times>
      <ci>d</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>x</ci>
       <cn type="integer">3</cn>
      </apply>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <divide></divide>
      <cn type="integer">6</cn>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>h</ci>
       <cn type="integer">3</cn>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>a</ci>
      <cn type="integer">3</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \frac{{d^{3}Y}}{{dx^{3}}}=\frac{6}{{h^{3}}}a_{3}
  </annotation>
 </semantics>
</math>

</p>

<p>In general, polynomials of degree (0 and 1),<a class="footnoteRef" href="#fn19" id="fnref19"><sup>19</sup></a> (2 and 3), (4 and 5) etc. give the same coefficients for smoothing and even derivatives. Polynomials of degree (1 and 2), (3 and 4) etc. give the same coefficients for odd derivatives.</p>
<h3 id="algebraic-expressions">Algebraic expressions</h3>

<p>It is not necessary always to use the Savitzky–Golay tables. The summations in the matrix <strong>J</strong><sup>T</sup><strong>J</strong> can be evaluated in <a href="Faulhaber's_formula" title="wikilink">closed form</a>,</p>

<p>

<math display="block" id="Savitzky–Golay_filter:25">
 <semantics>
  <mrow>
   <mrow>
    <munderover>
     <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
     <mrow>
      <mo>-</mo>
      <mrow>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mi>m</mi>
         <mo>-</mo>
         <mn>1</mn>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
       <mo>/</mo>
       <mn>2</mn>
      </mrow>
     </mrow>
     <mrow>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mi>m</mi>
        <mo>-</mo>
        <mn>1</mn>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
      <mo>/</mo>
      <mn>2</mn>
     </mrow>
    </munderover>
    <msup>
     <mi>z</mi>
     <mn>2</mn>
    </msup>
   </mrow>
   <mo>=</mo>
   <mfrac>
    <mrow>
     <mi>m</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <msup>
        <mi>m</mi>
        <mn>2</mn>
       </msup>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mn>12</mn>
   </mfrac>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <apply>
        <minus></minus>
        <apply>
         <divide></divide>
         <apply>
          <minus></minus>
          <ci>m</ci>
          <cn type="integer">1</cn>
         </apply>
         <cn type="integer">2</cn>
        </apply>
       </apply>
      </apply>
      <apply>
       <divide></divide>
       <apply>
        <minus></minus>
        <ci>m</ci>
        <cn type="integer">1</cn>
       </apply>
       <cn type="integer">2</cn>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>z</ci>
      <cn type="integer">2</cn>
     </apply>
    </apply>
    <apply>
     <divide></divide>
     <apply>
      <times></times>
      <ci>m</ci>
      <apply>
       <minus></minus>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>m</ci>
        <cn type="integer">2</cn>
       </apply>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <cn type="integer">12</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \sum_{-(m-1)/2}^{(m-1)/2}z^{2}={m(m^{2}-1)\over 12}
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Savitzky–Golay_filter:26">
 <semantics>
  <mrow>
   <mrow>
    <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
    <msup>
     <mi>z</mi>
     <mn>4</mn>
    </msup>
   </mrow>
   <mo>=</mo>
   <mfrac>
    <mrow>
     <mi>m</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <msup>
        <mi>m</mi>
        <mn>2</mn>
       </msup>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mrow>
        <mn>3</mn>
        <msup>
         <mi>m</mi>
         <mn>2</mn>
        </msup>
       </mrow>
       <mo>-</mo>
       <mn>7</mn>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mn>240</mn>
   </mfrac>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <sum></sum>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>z</ci>
      <cn type="integer">4</cn>
     </apply>
    </apply>
    <apply>
     <divide></divide>
     <apply>
      <times></times>
      <ci>m</ci>
      <apply>
       <minus></minus>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>m</ci>
        <cn type="integer">2</cn>
       </apply>
       <cn type="integer">1</cn>
      </apply>
      <apply>
       <minus></minus>
       <apply>
        <times></times>
        <cn type="integer">3</cn>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>m</ci>
         <cn type="integer">2</cn>
        </apply>
       </apply>
       <cn type="integer">7</cn>
      </apply>
     </apply>
     <cn type="integer">240</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \sum z^{4}={m(m^{2}-1)(3m^{2}-7)\over 240}
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Savitzky–Golay_filter:27">
 <semantics>
  <mrow>
   <mrow>
    <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
    <msup>
     <mi>z</mi>
     <mn>6</mn>
    </msup>
   </mrow>
   <mo>=</mo>
   <mfrac>
    <mrow>
     <mi>m</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <msup>
        <mi>m</mi>
        <mn>2</mn>
       </msup>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mrow>
        <mrow>
         <mn>3</mn>
         <msup>
          <mi>m</mi>
          <mn>4</mn>
         </msup>
        </mrow>
        <mo>-</mo>
        <mrow>
         <mn>18</mn>
         <msup>
          <mi>m</mi>
          <mn>2</mn>
         </msup>
        </mrow>
       </mrow>
       <mo>+</mo>
       <mn>31</mn>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mn>1344</mn>
   </mfrac>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <sum></sum>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>z</ci>
      <cn type="integer">6</cn>
     </apply>
    </apply>
    <apply>
     <divide></divide>
     <apply>
      <times></times>
      <ci>m</ci>
      <apply>
       <minus></minus>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>m</ci>
        <cn type="integer">2</cn>
       </apply>
       <cn type="integer">1</cn>
      </apply>
      <apply>
       <plus></plus>
       <apply>
        <minus></minus>
        <apply>
         <times></times>
         <cn type="integer">3</cn>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>m</ci>
          <cn type="integer">4</cn>
         </apply>
        </apply>
        <apply>
         <times></times>
         <cn type="integer">18</cn>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>m</ci>
          <cn type="integer">2</cn>
         </apply>
        </apply>
       </apply>
       <cn type="integer">31</cn>
      </apply>
     </apply>
     <cn type="integer">1344</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \sum z^{6}={m(m^{2}-1)(3m^{4}-18m^{2}+31)\over 1344}
  </annotation>
 </semantics>
</math>

 so that algebraic formulae can be derived for the convolution coefficients.<a class="footnoteRef" href="#fn20" id="fnref20"><sup>20</sup></a><a class="footnoteRef" href="#fn21" id="fnref21"><sup>21</sup></a> Functions that are suitable for use with a curve that has an <a href="inflection_point" title="wikilink">inflection point</a> are:</p>
<dl>
<dd>Smoothing, polynomial degree 2,3 :<math>C_{0i} = \frac{{\left( {3m^2 - 7 - 20i^2 } \right)/4}};
</math></dd>
</dl>

<p><code>\quad \frac{1-m}{2} \le i \le \frac{m-1}{2} </code></p>

<p> (the range of values for <em>i</em> also applies to the expressions below)</p>
<dl>
<dd>1st derivative: polynomial degree 3,4 <math>
</math></dd>
</dl>

<p>C_{1i} = \frac{ {5\left( {3m^4 - 18m^2 + 31} \right)i - 28\left( {3m^2 - 7} \right)i^3 }}  </p>
<dl>
<dd>2nd. derivative: polynomial degree 2,3 <math>
</math></dd>
</dl>

<p>C_{2i} = \frac  </p>
<dl>
<dd>3rd. derivative: polynomial degree 3,4 <math>
</math></dd>
</dl>

<p>C_{3i} = \frac{{ - \left( {3m^2 - 7} \right)i + 20i^3 }} </p>

<p>Simpler expressions that can be used with curves that don't have an inflection point are:</p>
<dl>
<dd>Smoothing, polynomial degree 0,1 (moving average)

<math display="block" id="Savitzky–Golay_filter:28">
 <semantics>
  <mrow>
   <msub>
    <mi>C</mi>
    <mrow>
     <mn>0</mn>
     <mi>i</mi>
    </mrow>
   </msub>
   <mo>=</mo>
   <mfrac>
    <mn>1</mn>
    <mi>m</mi>
   </mfrac>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>C</ci>
     <apply>
      <times></times>
      <cn type="integer">0</cn>
      <ci>i</ci>
     </apply>
    </apply>
    <apply>
     <divide></divide>
     <cn type="integer">1</cn>
     <ci>m</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   C_{0i}=\frac{1}{m}
  </annotation>
 </semantics>
</math>


</dd>
</dl>
<dl>
<dd>1st derivative, polynomial degree 1,2

<math display="block" id="Savitzky–Golay_filter:29">
 <semantics>
  <mrow>
   <msub>
    <mi>C</mi>
    <mrow>
     <mn>1</mn>
     <mi>i</mi>
    </mrow>
   </msub>
   <mo>=</mo>
   <mfrac>
    <mi>i</mi>
    <mrow>
     <mrow>
      <mi>m</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <msup>
         <mi>m</mi>
         <mn>2</mn>
        </msup>
        <mo>-</mo>
        <mn>1</mn>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo>/</mo>
     <mn>12</mn>
    </mrow>
   </mfrac>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>C</ci>
     <apply>
      <times></times>
      <cn type="integer">1</cn>
      <ci>i</ci>
     </apply>
    </apply>
    <apply>
     <divide></divide>
     <ci>i</ci>
     <apply>
      <divide></divide>
      <apply>
       <times></times>
       <ci>m</ci>
       <apply>
        <minus></minus>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>m</ci>
         <cn type="integer">2</cn>
        </apply>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <cn type="integer">12</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   C_{1i}=\frac{i}{m(m^{2}-1)/12}
  </annotation>
 </semantics>
</math>


</dd>
</dl>

<p>Higher derivatives can be obtained. For example, a fourth derivative can be obtained by performing two passes of a second derivative function.<a class="footnoteRef" href="#fn22" id="fnref22"><sup>22</sup></a></p>
<h3 id="use-of-orthogonal-polynomials">Use of orthogonal polynomials</h3>

<p>An alternative to fitting <em>m</em> data points by a simple polynomial in the subsidiary variable, <em>z</em>, is to use <a href="orthogonal_polynomial" title="wikilink">orthogonal polynomials</a>.</p>

<p>

<math display="block" id="Savitzky–Golay_filter:30">
 <semantics>
  <mrow>
   <mrow>
    <mi>Y</mi>
    <mo>=</mo>
    <mrow>
     <mrow>
      <msub>
       <mi>b</mi>
       <mn>0</mn>
      </msub>
      <msup>
       <mi>P</mi>
       <mn>0</mn>
      </msup>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>z</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo>+</mo>
     <mrow>
      <msub>
       <mi>b</mi>
       <mn>1</mn>
      </msub>
      <msup>
       <mi>P</mi>
       <mn>1</mn>
      </msup>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>z</mi>
       <mo stretchy="false">)</mo>
      </mrow>
      <mi mathvariant="normal">⋯</mi>
     </mrow>
     <mo>+</mo>
     <mrow>
      <msub>
       <mi>b</mi>
       <mi>k</mi>
      </msub>
      <msup>
       <mi>P</mi>
       <mi>k</mi>
      </msup>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>z</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>Y</ci>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>b</ci>
       <cn type="integer">0</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>P</ci>
       <cn type="integer">0</cn>
      </apply>
      <ci>z</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>b</ci>
       <cn type="integer">1</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>P</ci>
       <cn type="integer">1</cn>
      </apply>
      <ci>z</ci>
      <ci>normal-⋯</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>b</ci>
       <ci>k</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>P</ci>
       <ci>k</ci>
      </apply>
      <ci>z</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Y=b_{0}P^{0}(z)+b_{1}P^{1}(z)\cdots+b_{k}P^{k}(z).
  </annotation>
 </semantics>
</math>

 where <em>P</em><sup>0</sup> .. <em>P</em><sup>k</sup> is a set of mutually orthogonal polynomials of degree 0 .. <em>k</em>. Full details on how to obtain expressions for the orthogonal polynomials and the relationship between the coefficients <strong><em>b</em></strong> and <strong><em>a</em></strong> are given by Guest.<a class="footnoteRef" href="#fn23" id="fnref23"><sup>23</sup></a> Expressions for the convolution coefficients are easily obtained because the normal equations matrix, <strong><em>J<strong><em><sup>T</sup></em></strong>J</em></strong>, is a <a href="diagonal_matrix" title="wikilink">diagonal matrix</a> as the product of any two orthogonal polynomials is zero by virtue of their mutual orthogonality. Therefore, each non-zero element of its inverse is simply the reciprocal the corresponding element in the normal equation matrix. The calculation is further simplified by using <a class="uri" href="recursion" title="wikilink">recursion</a> to build orthogonal <a href="Gram_polynomial" title="wikilink">Gram polynomials</a>. The whole calculation can be coded in a few lines of <a href="Pascal_(programming_language)" title="wikilink">PASCAL</a>, a computer language well-adapted for calculations involving recursion.<a class="footnoteRef" href="#fn24" id="fnref24"><sup>24</sup></a></p>
<h3 id="treatment-of-first-and-last-points">Treatment of first and last points</h3>

<p>Savitzky–Golay filters are most commonly used to obtain the smoothed or derivative value at the central point, <em>z</em> = 0, using a single set of convolution coefficients. (<em>m</em> − 1)/2 points at the start and end of the series cannot be calculated using this process. Various strategies can be employed to avoid this inconvenience.</p>
<ul>
<li>The data could be artificially extended by adding, in reverse order, copies of the first (<em>m</em> − 1)/2 points at the beginning and copies of the last (<em>m</em> − 1)/2 points at the end. For instance, with <em>m</em> = 5, two points are added at the start and end of the data <em>y</em><sub>1</sub>, ..., <em>y</em><sub><em>n</em></sub>.</li>
</ul>
<dl>
<dd><span style="color:red;"><em>y</em><sub>3</sub>,<em>y</em><sub>2</sub></span>,<em>y</em><sub>1</sub>, ... ,<em>y</em><sub><em>n</em></sub>, <span style="color:red;"><em>y</em><sub><em>n</em>−1</sub>, <em>y</em><sub><em>n</em>−2</sub></span>.
</dd>
</dl>
<ul>
<li>Looking again at the fitting polynomial, it is obvious that data can be calculated for all values of <em>z</em> by using all sets of convolution coefficients for a single polynomial, a<sub>0</sub> .. a<sub>k</sub>.</li>
</ul>
<dl>
<dd>For a cubic polynomial
</dd>
<dd>

<math display="inline" id="Savitzky–Golay_filter:31">
 <semantics>
  <mrow>
   <mi>Y</mi>
   <mo>=</mo>
   <mrow>
    <msub>
     <mi>a</mi>
     <mn>0</mn>
    </msub>
    <mo>+</mo>
    <mrow>
     <msub>
      <mi>a</mi>
      <mn>1</mn>
     </msub>
     <mi>z</mi>
    </mrow>
    <mo>+</mo>
    <mrow>
     <msub>
      <mi>a</mi>
      <mn>2</mn>
     </msub>
     <msup>
      <mi>z</mi>
      <mn>2</mn>
     </msup>
    </mrow>
    <mo>+</mo>
    <mrow>
     <msub>
      <mi>a</mi>
      <mn>3</mn>
     </msub>
     <msup>
      <mi>z</mi>
      <mn>3</mn>
     </msup>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>Y</ci>
    <apply>
     <plus></plus>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>a</ci>
      <cn type="integer">0</cn>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>a</ci>
       <cn type="integer">1</cn>
      </apply>
      <ci>z</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>a</ci>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>z</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>a</ci>
       <cn type="integer">3</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>z</ci>
       <cn type="integer">3</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Y=a_{0}+a_{1}z+a_{2}z^{2}+a_{3}z^{3}
  </annotation>
 </semantics>
</math>


</dd>
<dd>

<math display="inline" id="Savitzky–Golay_filter:32">
 <semantics>
  <mrow>
   <mfrac>
    <mrow>
     <mi>d</mi>
     <mi>Y</mi>
    </mrow>
    <mrow>
     <mi>d</mi>
     <mi>x</mi>
    </mrow>
   </mfrac>
   <mo>=</mo>
   <mrow>
    <mfrac>
     <mn>1</mn>
     <mi>h</mi>
    </mfrac>
    <mrow>
     <mo>(</mo>
     <mrow>
      <msub>
       <mi>a</mi>
       <mn>1</mn>
      </msub>
      <mo>+</mo>
      <mrow>
       <mn>2</mn>
       <msub>
        <mi>a</mi>
        <mn>2</mn>
       </msub>
       <mi>z</mi>
      </mrow>
      <mo>+</mo>
      <mrow>
       <mn>3</mn>
       <msub>
        <mi>a</mi>
        <mn>3</mn>
       </msub>
       <msup>
        <mi>z</mi>
        <mn>2</mn>
       </msup>
      </mrow>
     </mrow>
     <mo>)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <divide></divide>
     <apply>
      <times></times>
      <ci>d</ci>
      <ci>Y</ci>
     </apply>
     <apply>
      <times></times>
      <ci>d</ci>
      <ci>x</ci>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <divide></divide>
      <cn type="integer">1</cn>
      <ci>h</ci>
     </apply>
     <apply>
      <plus></plus>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>a</ci>
       <cn type="integer">1</cn>
      </apply>
      <apply>
       <times></times>
       <cn type="integer">2</cn>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>a</ci>
        <cn type="integer">2</cn>
       </apply>
       <ci>z</ci>
      </apply>
      <apply>
       <times></times>
       <cn type="integer">3</cn>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>a</ci>
        <cn type="integer">3</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>z</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \frac{{dY}}{{dx}}=\frac{1}{h}\left({a_{1}+2a_{2}z+3a_{3}z^{2}}\right)
  </annotation>
 </semantics>
</math>


</dd>
<dd>

<math display="inline" id="Savitzky–Golay_filter:33">
 <semantics>
  <mrow>
   <mfrac>
    <mrow>
     <msup>
      <mi>d</mi>
      <mn>2</mn>
     </msup>
     <mi>Y</mi>
    </mrow>
    <mrow>
     <mi>d</mi>
     <msup>
      <mi>x</mi>
      <mn>2</mn>
     </msup>
    </mrow>
   </mfrac>
   <mo>=</mo>
   <mrow>
    <mfrac>
     <mn>1</mn>
     <msup>
      <mi>h</mi>
      <mn>2</mn>
     </msup>
    </mfrac>
    <mrow>
     <mo>(</mo>
     <mrow>
      <mrow>
       <mn>2</mn>
       <msub>
        <mi>a</mi>
        <mn>2</mn>
       </msub>
      </mrow>
      <mo>+</mo>
      <mrow>
       <mn>6</mn>
       <msub>
        <mi>a</mi>
        <mn>3</mn>
       </msub>
       <mi>z</mi>
      </mrow>
     </mrow>
     <mo>)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <divide></divide>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>d</ci>
       <cn type="integer">2</cn>
      </apply>
      <ci>Y</ci>
     </apply>
     <apply>
      <times></times>
      <ci>d</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>x</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <divide></divide>
      <cn type="integer">1</cn>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>h</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
     <apply>
      <plus></plus>
      <apply>
       <times></times>
       <cn type="integer">2</cn>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>a</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
      <apply>
       <times></times>
       <cn type="integer">6</cn>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>a</ci>
        <cn type="integer">3</cn>
       </apply>
       <ci>z</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \frac{{d^{2}Y}}{{dx^{2}}}=\frac{1}{{h^{2}}}\left({2a_{2}+6a_{3}z}\right)
  </annotation>
 </semantics>
</math>


</dd>
<dd>

<math display="inline" id="Savitzky–Golay_filter:34">
 <semantics>
  <mrow>
   <mfrac>
    <mrow>
     <msup>
      <mi>d</mi>
      <mn>3</mn>
     </msup>
     <mi>Y</mi>
    </mrow>
    <mrow>
     <mi>d</mi>
     <msup>
      <mi>x</mi>
      <mn>3</mn>
     </msup>
    </mrow>
   </mfrac>
   <mo>=</mo>
   <mrow>
    <mfrac>
     <mn>6</mn>
     <msup>
      <mi>h</mi>
      <mn>3</mn>
     </msup>
    </mfrac>
    <msub>
     <mi>a</mi>
     <mn>3</mn>
    </msub>
    <mrow></mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <divide></divide>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>d</ci>
       <cn type="integer">3</cn>
      </apply>
      <ci>Y</ci>
     </apply>
     <apply>
      <times></times>
      <ci>d</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>x</ci>
       <cn type="integer">3</cn>
      </apply>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <divide></divide>
      <cn type="integer">6</cn>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>h</ci>
       <cn type="integer">3</cn>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>a</ci>
      <cn type="integer">3</cn>
     </apply>
     <mtext></mtext>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \frac{{d^{3}Y}}{{dx^{3}}}=\frac{6}{{h^{3}}}a_{3}{\text{ }}
  </annotation>
 </semantics>
</math>


</dd>
</dl>
<ul>
<li>Convolution coefficients for the missing first and last points can also be easily obtained.<a class="footnoteRef" href="#fn25" id="fnref25"><sup>25</sup></a> This is also equivalent to fitting the first (<em>m</em>+1)/2 points with the same polynomial, and similarly for the last points.</li>
</ul>
<h3 id="weighting-the-data">Weighting the data</h3>

<p>It is implicit in the above treatment that the data points are all given equal weight. Technically, the <a href="objective_function" title="wikilink">objective function</a></p>

<p>

<math display="block" id="Savitzky–Golay_filter:35">
 <semantics>
  <mrow>
   <mi>U</mi>
   <mo>=</mo>
   <mrow>
    <munder>
     <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
     <mi>i</mi>
    </munder>
    <mrow>
     <msub>
      <mi>w</mi>
      <mi>i</mi>
     </msub>
     <msup>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <msub>
         <mi>Y</mi>
         <mi>i</mi>
        </msub>
        <mo>-</mo>
        <msub>
         <mi>y</mi>
         <mi>i</mi>
        </msub>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
      <mn>2</mn>
     </msup>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>U</ci>
    <apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <sum></sum>
      <ci>i</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>w</ci>
       <ci>i</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <minus></minus>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>Y</ci>
         <ci>i</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>y</ci>
         <ci>i</ci>
        </apply>
       </apply>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   U=\sum_{i}w_{i}(Y_{i}-y_{i})^{2}
  </annotation>
 </semantics>
</math>

 being minimized in the least-squares process has unit weights, <em>w</em><sub>i</sub>=1. When weights are not all the same the normal equations become</p>

<p>

<math display="block" id="Savitzky–Golay_filter:36">
 <semantics>
  <mrow>
   <mrow>
    <mi>𝐚</mi>
    <mo>=</mo>
    <mrow>
     <msup>
      <mrow>
       <mo>(</mo>
       <mrow>
        <msup>
         <mi>𝐉</mi>
         <mi>𝐓</mi>
        </msup>
        <mi>𝐖𝐉</mi>
       </mrow>
       <mo>)</mo>
      </mrow>
      <mrow>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
     </msup>
     <msup>
      <mi>𝐉</mi>
      <mi>𝐓</mi>
     </msup>
     <mi>𝐖𝐲</mi>
    </mrow>
   </mrow>
   <mrow>
    <msub>
     <mi>W</mi>
     <mrow>
      <mi>i</mi>
      <mo>,</mo>
      <mi>i</mi>
     </mrow>
    </msub>
    <mo>≠</mo>
    <mn>1</mn>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <eq></eq>
     <ci>𝐚</ci>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>𝐉</ci>
         <ci>𝐓</ci>
        </apply>
        <ci>𝐖𝐉</ci>
       </apply>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>𝐉</ci>
       <ci>𝐓</ci>
      </apply>
      <ci>𝐖𝐲</ci>
     </apply>
    </apply>
    <apply>
     <neq></neq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>W</ci>
      <list>
       <ci>i</ci>
       <ci>i</ci>
      </list>
     </apply>
     <cn type="integer">1</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{a}=\left(\mathbf{J^{T}W}\mathbf{J}\right)^{-1}\mathbf{J^{T}W}\mathbf{y%
}\qquad W_{i,i}\neq 1
  </annotation>
 </semantics>
</math>

, If the same set of diagonal weights is used for all data subsets, <strong>W</strong> = diag(w<sub>1</sub>,w<sub>2</sub>,...w<sub>m</sub>), an analytical solution to the normal equations can be written down. For example, with a quadratic polynomial,</p>

<p>

<math display="block" id="Savitzky–Golay_filter:37">
 <semantics>
  <mrow>
   <mrow>
    <msup>
     <mi>𝐉</mi>
     <mi>𝐓</mi>
    </msup>
    <mi>𝐖𝐉</mi>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mo>(</mo>
    <mtable displaystyle="true">
     <mtr>
      <mtd columnalign="center">
       <mrow>
        <mi>m</mi>
        <mstyle displaystyle="false">
         <mrow>
          <mo largeop="true" symmetric="true">∑</mo>
          <msub>
           <mi>w</mi>
           <mi>i</mi>
          </msub>
         </mrow>
        </mstyle>
       </mrow>
      </mtd>
      <mtd columnalign="center">
       <mstyle displaystyle="false">
        <mrow>
         <mo largeop="true" symmetric="true">∑</mo>
         <mrow>
          <msub>
           <mi>w</mi>
           <mi>i</mi>
          </msub>
          <msub>
           <mi>z</mi>
           <mi>i</mi>
          </msub>
         </mrow>
        </mrow>
       </mstyle>
      </mtd>
      <mtd columnalign="center">
       <mstyle displaystyle="false">
        <mrow>
         <mo largeop="true" symmetric="true">∑</mo>
         <mrow>
          <msub>
           <mi>w</mi>
           <mi>i</mi>
          </msub>
          <msubsup>
           <mi>z</mi>
           <mi>i</mi>
           <mn>2</mn>
          </msubsup>
         </mrow>
        </mrow>
       </mstyle>
      </mtd>
     </mtr>
     <mtr>
      <mtd columnalign="center">
       <mstyle displaystyle="false">
        <mrow>
         <mo largeop="true" symmetric="true">∑</mo>
         <mrow>
          <msub>
           <mi>w</mi>
           <mi>i</mi>
          </msub>
          <msub>
           <mi>z</mi>
           <mi>i</mi>
          </msub>
         </mrow>
        </mrow>
       </mstyle>
      </mtd>
      <mtd columnalign="center">
       <mstyle displaystyle="false">
        <mrow>
         <mo largeop="true" symmetric="true">∑</mo>
         <mrow>
          <msub>
           <mi>w</mi>
           <mi>i</mi>
          </msub>
          <msubsup>
           <mi>z</mi>
           <mi>i</mi>
           <mn>2</mn>
          </msubsup>
         </mrow>
        </mrow>
       </mstyle>
      </mtd>
      <mtd columnalign="center">
       <mstyle displaystyle="false">
        <mrow>
         <mo largeop="true" symmetric="true">∑</mo>
         <mrow>
          <msub>
           <mi>w</mi>
           <mi>i</mi>
          </msub>
          <msubsup>
           <mi>z</mi>
           <mi>i</mi>
           <mn>3</mn>
          </msubsup>
         </mrow>
        </mrow>
       </mstyle>
      </mtd>
     </mtr>
     <mtr>
      <mtd columnalign="center">
       <mstyle displaystyle="false">
        <mrow>
         <mo largeop="true" symmetric="true">∑</mo>
         <mrow>
          <msub>
           <mi>w</mi>
           <mi>i</mi>
          </msub>
          <msubsup>
           <mi>z</mi>
           <mi>i</mi>
           <mn>2</mn>
          </msubsup>
         </mrow>
        </mrow>
       </mstyle>
      </mtd>
      <mtd columnalign="center">
       <mstyle displaystyle="false">
        <mrow>
         <mo largeop="true" symmetric="true">∑</mo>
         <mrow>
          <msub>
           <mi>w</mi>
           <mi>i</mi>
          </msub>
          <msubsup>
           <mi>z</mi>
           <mi>i</mi>
           <mn>3</mn>
          </msubsup>
         </mrow>
        </mrow>
       </mstyle>
      </mtd>
      <mtd columnalign="center">
       <mstyle displaystyle="false">
        <mrow>
         <mo largeop="true" symmetric="true">∑</mo>
         <mrow>
          <msub>
           <mi>w</mi>
           <mi>i</mi>
          </msub>
          <msubsup>
           <mi>z</mi>
           <mi>i</mi>
           <mn>4</mn>
          </msubsup>
         </mrow>
        </mrow>
       </mstyle>
      </mtd>
     </mtr>
    </mtable>
    <mo>)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>𝐉</ci>
      <ci>𝐓</ci>
     </apply>
     <ci>𝐖𝐉</ci>
    </apply>
    <matrix>
     <matrixrow>
      <apply>
       <times></times>
       <ci>m</ci>
       <apply>
        <sum></sum>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>w</ci>
         <ci>i</ci>
        </apply>
       </apply>
      </apply>
      <apply>
       <sum></sum>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>w</ci>
         <ci>i</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>z</ci>
         <ci>i</ci>
        </apply>
       </apply>
      </apply>
      <apply>
       <sum></sum>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>w</ci>
         <ci>i</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>z</ci>
          <ci>i</ci>
         </apply>
         <cn type="integer">2</cn>
        </apply>
       </apply>
      </apply>
     </matrixrow>
     <matrixrow>
      <apply>
       <sum></sum>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>w</ci>
         <ci>i</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>z</ci>
         <ci>i</ci>
        </apply>
       </apply>
      </apply>
      <apply>
       <sum></sum>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>w</ci>
         <ci>i</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>z</ci>
          <ci>i</ci>
         </apply>
         <cn type="integer">2</cn>
        </apply>
       </apply>
      </apply>
      <apply>
       <sum></sum>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>w</ci>
         <ci>i</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>z</ci>
          <ci>i</ci>
         </apply>
         <cn type="integer">3</cn>
        </apply>
       </apply>
      </apply>
     </matrixrow>
     <matrixrow>
      <apply>
       <sum></sum>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>w</ci>
         <ci>i</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>z</ci>
          <ci>i</ci>
         </apply>
         <cn type="integer">2</cn>
        </apply>
       </apply>
      </apply>
      <apply>
       <sum></sum>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>w</ci>
         <ci>i</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>z</ci>
          <ci>i</ci>
         </apply>
         <cn type="integer">3</cn>
        </apply>
       </apply>
      </apply>
      <apply>
       <sum></sum>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>w</ci>
         <ci>i</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>z</ci>
          <ci>i</ci>
         </apply>
         <cn type="integer">4</cn>
        </apply>
       </apply>
      </apply>
     </matrixrow>
    </matrix>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{J^{T}WJ}=\begin{pmatrix}m\sum w_{i}&\sum w_{i}z_{i}&\sum w_{i}z_{i}^{2%
}\\
\sum w_{i}z_{i}&\sum w_{i}z_{i}^{2}&\sum w_{i}z_{i}^{3}\\
\sum w_{i}z_{i}^{2}&\sum w_{i}z_{i}^{3}&\sum w_{i}z_{i}^{4}\end{pmatrix}
  </annotation>
 </semantics>
</math>

 An explicit expression for the inverse of this matrix can be obtained using <a href="Cramer's_rule" title="wikilink">Cramer's rule</a>. A set of convolution coefficients may then be derived as</p>

<p>

<math display="block" id="Savitzky–Golay_filter:38">
 <semantics>
  <mrow>
   <mi>𝐂</mi>
   <mo>=</mo>
   <mrow>
    <msup>
     <mrow>
      <mo>(</mo>
      <mrow>
       <msup>
        <mi>𝐉</mi>
        <mi>𝐓</mi>
       </msup>
       <mi>𝐖𝐉</mi>
      </mrow>
      <mo>)</mo>
     </mrow>
     <mrow>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </msup>
    <msup>
     <mi>𝐉</mi>
     <mi>𝐓</mi>
    </msup>
    <mi>𝐖</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>𝐂</ci>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>𝐉</ci>
        <ci>𝐓</ci>
       </apply>
       <ci>𝐖𝐉</ci>
      </apply>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>𝐉</ci>
      <ci>𝐓</ci>
     </apply>
     <ci>𝐖</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{C}=\left(\mathbf{J^{T}W}\mathbf{J}\right)^{-1}\mathbf{J^{T}W}
  </annotation>
 </semantics>
</math>

. Alternatively the coefficients, <strong>C</strong>, could be calculated in a spreadsheet, employing a built-in matrix inversion routine to obtain the inverse of the normal equations matrix. This set of coefficients, once calculated and stored, can be used with all calculations in which the same weighting scheme applies. A different set of coefficients is needed for each different weighting scheme.</p>
<h2 id="two-dimensional-convolution-coefficients">Two-dimensional convolution coefficients</h2>

<p>Two-dimensional smoothing and differentiation can also be applied to tables of data values, such as intensity values in a photographic image which is composed of a rectangular grid of pixels.<a class="footnoteRef" href="#fn26" id="fnref26"><sup>26</sup></a> <a class="footnoteRef" href="#fn27" id="fnref27"><sup>27</sup></a> The trick is to transform part of the table into a row by a simple ordering of the indices of the pixels. Whereas the one-dimensional filter coefficients are found by fitting a polynomial in the subsidiary variable, <em>z</em> to a set of <em>m</em> data points, the two-dimensional coefficients are found by fitting a polynomial in subsidiary variables <em>v</em> and <em>w</em> to a set of <em>m</em> × <em>m</em> data points. The following example, for a bicubic polynomial and <em>m</em> = 5, illustrates the process, which parallels the process for the one dimensional case, above.<a class="footnoteRef" href="#fn28" id="fnref28"><sup>28</sup></a></p>

<p>

<math display="block" id="Savitzky–Golay_filter:39">
 <semantics>
  <mrow>
   <mrow>
    <mi>v</mi>
    <mo>=</mo>
    <mfrac>
     <mrow>
      <mi>x</mi>
      <mo>-</mo>
      <mover accent="true">
       <mi>x</mi>
       <mo stretchy="false">¯</mo>
      </mover>
     </mrow>
     <mrow>
      <mi>h</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>x</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mfrac>
   </mrow>
   <mo>;</mo>
   <mrow>
    <mi>w</mi>
    <mo>=</mo>
    <mfrac>
     <mrow>
      <mi>y</mi>
      <mo>-</mo>
      <mover accent="true">
       <mi>y</mi>
       <mo stretchy="false">¯</mo>
      </mover>
     </mrow>
     <mrow>
      <mi>h</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>y</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mfrac>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <eq></eq>
     <ci>v</ci>
     <apply>
      <divide></divide>
      <apply>
       <minus></minus>
       <ci>x</ci>
       <apply>
        <ci>normal-¯</ci>
        <ci>x</ci>
       </apply>
      </apply>
      <apply>
       <times></times>
       <ci>h</ci>
       <ci>x</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <ci>w</ci>
     <apply>
      <divide></divide>
      <apply>
       <minus></minus>
       <ci>y</ci>
       <apply>
        <ci>normal-¯</ci>
        <ci>y</ci>
       </apply>
      </apply>
      <apply>
       <times></times>
       <ci>h</ci>
       <ci>y</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   v=\frac{x-\bar{x}}{h(x)};w=\frac{y-\bar{y}}{h(y)}
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Savitzky–Golay_filter:40">
 <semantics>
  <mrow>
   <mi>Y</mi>
   <mo>=</mo>
   <mrow>
    <msub>
     <mi>a</mi>
     <mn>00</mn>
    </msub>
    <mo>+</mo>
    <mrow>
     <msub>
      <mi>a</mi>
      <mn>10</mn>
     </msub>
     <mi>v</mi>
    </mrow>
    <mo>+</mo>
    <mrow>
     <msub>
      <mi>a</mi>
      <mn>01</mn>
     </msub>
     <mi>w</mi>
    </mrow>
    <mo>+</mo>
    <mrow>
     <msub>
      <mi>a</mi>
      <mn>20</mn>
     </msub>
     <msup>
      <mi>v</mi>
      <mn>2</mn>
     </msup>
    </mrow>
    <mo>+</mo>
    <mrow>
     <msub>
      <mi>a</mi>
      <mn>11</mn>
     </msub>
     <mi>v</mi>
     <mi>w</mi>
    </mrow>
    <mo>+</mo>
    <mrow>
     <msub>
      <mi>a</mi>
      <mn>02</mn>
     </msub>
     <msup>
      <mi>w</mi>
      <mn>2</mn>
     </msup>
    </mrow>
    <mo>+</mo>
    <mrow>
     <msub>
      <mi>a</mi>
      <mn>30</mn>
     </msub>
     <msup>
      <mi>v</mi>
      <mn>3</mn>
     </msup>
    </mrow>
    <mo>+</mo>
    <mrow>
     <msub>
      <mi>a</mi>
      <mn>21</mn>
     </msub>
     <msup>
      <mi>v</mi>
      <mn>2</mn>
     </msup>
     <mi>w</mi>
    </mrow>
    <mo>+</mo>
    <mrow>
     <msub>
      <mi>a</mi>
      <mn>12</mn>
     </msub>
     <mi>v</mi>
     <msup>
      <mi>w</mi>
      <mn>2</mn>
     </msup>
    </mrow>
    <mo>+</mo>
    <mrow>
     <msub>
      <mi>a</mi>
      <mn>03</mn>
     </msub>
     <msup>
      <mi>w</mi>
      <mn>3</mn>
     </msup>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>Y</ci>
    <apply>
     <plus></plus>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>a</ci>
      <cn type="integer">00</cn>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>a</ci>
       <cn type="integer">10</cn>
      </apply>
      <ci>v</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>a</ci>
       <cn type="integer">01</cn>
      </apply>
      <ci>w</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>a</ci>
       <cn type="integer">20</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>v</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>a</ci>
       <cn type="integer">11</cn>
      </apply>
      <ci>v</ci>
      <ci>w</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>a</ci>
       <cn type="integer">02</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>w</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>a</ci>
       <cn type="integer">30</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>v</ci>
       <cn type="integer">3</cn>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>a</ci>
       <cn type="integer">21</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>v</ci>
       <cn type="integer">2</cn>
      </apply>
      <ci>w</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>a</ci>
       <cn type="integer">12</cn>
      </apply>
      <ci>v</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>w</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>a</ci>
       <cn type="integer">03</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>w</ci>
       <cn type="integer">3</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Y=a_{00}+a_{10}v+a_{01}w+a_{20}v^{2}+a_{11}vw+a_{02}w^{2}+a_{30}v^{3}+a_{21}v^%
{2}w+a_{12}vw^{2}+a_{03}w^{3}
  </annotation>
 </semantics>
</math>

 The square of 25 data values, <em>d</em><sub>1</sub> − <em>d</em><sub>25</sub></p>
<dl>
<dd>
<table>
<tbody>
<tr class="odd">
<td style="text-align: left;">
<p>v</p></td>
<td style="text-align: left;">
<p>−2</p></td>
<td style="text-align: left;">
<p>−1</p></td>
<td style="text-align: left;">
<p>0</p></td>
<td style="text-align: left;">
<p>1</p></td>
<td style="text-align: left;">
<p>2</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>w</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>−2</p></td>
<td style="text-align: left;">
<p><em>d</em><sub>1</sub></p></td>
<td style="text-align: left;">
<p><em>d</em><sub>2</sub></p></td>
<td style="text-align: left;">
<p><em>d</em><sub>3</sub></p></td>
<td style="text-align: left;">
<p><em>d</em><sub>4</sub></p></td>
<td style="text-align: left;">
<p><em>d</em><sub>5</sub></p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>−1</p></td>
<td style="text-align: left;">
<p><em>d</em><sub>6</sub></p></td>
<td style="text-align: left;">
<p><em>d</em><sub>7</sub></p></td>
<td style="text-align: left;">
<p><em>d</em><sub>8</sub></p></td>
<td style="text-align: left;">
<p><em>d</em><sub>9</sub></p></td>
<td style="text-align: left;">
<p><em>d</em><sub>10</sub></p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>0</p></td>
<td style="text-align: left;">
<p><em>d</em><sub>11</sub></p></td>
<td style="text-align: left;">
<p><em>d</em><sub>12</sub></p></td>
<td style="text-align: left;">
<p><em>d</em><sub>13</sub></p></td>
<td style="text-align: left;">
<p><em>d</em><sub>14</sub></p></td>
<td style="text-align: left;">
<p><em>d</em><sub>15</sub></p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>1</p></td>
<td style="text-align: left;">
<p><em>d</em><sub>16</sub></p></td>
<td style="text-align: left;">
<p><em>d</em><sub>17</sub></p></td>
<td style="text-align: left;">
<p><em>d</em><sub>18</sub></p></td>
<td style="text-align: left;">
<p><em>d</em><sub>19</sub></p></td>
<td style="text-align: left;">
<p><em>d</em><sub>20</sub></p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>2</p></td>
<td style="text-align: left;">
<p><em>d</em><sub>21</sub></p></td>
<td style="text-align: left;">
<p><em>d</em><sub>22</sub></p></td>
<td style="text-align: left;">
<p><em>d</em><sub>23</sub></p></td>
<td style="text-align: left;">
<p><em>d</em><sub>24</sub></p></td>
<td style="text-align: left;">
<p><em>d</em><sub>25</sub></p></td>
</tr>
</tbody>
</table>
</dd>
</dl>

<p>becomes a vector when the rows are placed one after another.</p>
<dl>
<dd><strong>d</strong> = (<em>d</em><sub>1</sub> ... <em>d</em><sub>25</sub>)<sup>T</sup>
</dd>
</dl>

<p>The Jacobian has 10 columns, one for each of the parameters <em>a</em><sub>00</sub> − <em>a</em><sub>03</sub> and 25 rows, one for each pair of <em>v</em> and <em>w</em> values. Each row has the form</p>

<p>

<math display="block" id="Savitzky–Golay_filter:41">
 <semantics>
  <mrow>
   <msub>
    <mi>J</mi>
    <mtext>row</mtext>
   </msub>
   <mo>=</mo>
   <mrow>
    <mpadded width="+5pt">
     <mn>1</mn>
    </mpadded>
    <mpadded width="+5pt">
     <mi>v</mi>
    </mpadded>
    <mpadded width="+5pt">
     <mi>w</mi>
    </mpadded>
    <mpadded width="+5pt">
     <msup>
      <mi>v</mi>
      <mn>2</mn>
     </msup>
    </mpadded>
    <mi>v</mi>
    <mpadded width="+5pt">
     <mi>w</mi>
    </mpadded>
    <mpadded width="+5pt">
     <msup>
      <mi>w</mi>
      <mn>2</mn>
     </msup>
    </mpadded>
    <mpadded width="+5pt">
     <msup>
      <mi>v</mi>
      <mn>3</mn>
     </msup>
    </mpadded>
    <msup>
     <mi>v</mi>
     <mn>2</mn>
    </msup>
    <mpadded width="+5pt">
     <mi>w</mi>
    </mpadded>
    <mi>v</mi>
    <mpadded width="+5pt">
     <msup>
      <mi>w</mi>
      <mn>2</mn>
     </msup>
    </mpadded>
    <msup>
     <mi>w</mi>
     <mn>3</mn>
    </msup>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>J</ci>
     <mtext>row</mtext>
    </apply>
    <apply>
     <times></times>
     <cn type="integer">1</cn>
     <ci>v</ci>
     <ci>w</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>v</ci>
      <cn type="integer">2</cn>
     </apply>
     <ci>v</ci>
     <ci>w</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>w</ci>
      <cn type="integer">2</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>v</ci>
      <cn type="integer">3</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>v</ci>
      <cn type="integer">2</cn>
     </apply>
     <ci>w</ci>
     <ci>v</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>w</ci>
      <cn type="integer">2</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>w</ci>
      <cn type="integer">3</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   J_{\text{row}}=1\ v\ w\ v^{2}\ vw\ w^{2}\ v^{3}\ v^{2}w\ vw^{2}\ w^{3}
  </annotation>
 </semantics>
</math>

 The convolution coefficients are calculated as</p>

<p>

<math display="block" id="Savitzky–Golay_filter:42">
 <semantics>
  <mrow>
   <mi>𝐂</mi>
   <mo>=</mo>
   <mrow>
    <msup>
     <mrow>
      <mo>(</mo>
      <mrow>
       <msup>
        <mi>𝐉</mi>
        <mi>T</mi>
       </msup>
       <mi>𝐉</mi>
      </mrow>
      <mo>)</mo>
     </mrow>
     <mrow>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </msup>
    <msup>
     <mi>𝐉</mi>
     <mi>T</mi>
    </msup>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>𝐂</ci>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>𝐉</ci>
        <ci>T</ci>
       </apply>
       <ci>𝐉</ci>
      </apply>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>𝐉</ci>
      <ci>T</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{C}=\left(\mathbf{J}^{T}\mathbf{J}\right)^{-1}\mathbf{J}^{T}
  </annotation>
 </semantics>
</math>

 The first row of <strong>C</strong> contains 25 convolution coefficients which can be multiplied with the 25 data values to provide a smoothed value for the central data point (13) of the 25.</p>

<p>A <a class="uri" href="Matlab" title="wikilink">Matlab</a><a class="footnoteRef" href="#fn29" id="fnref29"><sup>29</sup></a> routine for computing the coefficients is available. 3-dimensional filters can be obtained with a similar procedure.<a class="footnoteRef" href="#fn30" id="fnref30"><sup>30</sup></a><a class="footnoteRef" href="#fn31" id="fnref31"><sup>31</sup></a></p>
<h2 id="some-properties-of-convolution">Some properties of convolution</h2>
<ol>
<li>The sum of convolution coefficients for smoothing is equal to one. The sum of coefficients for odd derivatives is zero.<a class="footnoteRef" href="#fn32" id="fnref32"><sup>32</sup></a></li>
<li>The sum of squared convolution coefficients for smoothing is equal to the value of the central coefficient.<a class="footnoteRef" href="#fn33" id="fnref33"><sup>33</sup></a></li>
<li>Smoothing of a function leaves the area under the function unchanged.<a class="footnoteRef" href="#fn34" id="fnref34"><sup>34</sup></a></li>
<li>Convolution of a symmetric function with even-derivative coefficients conserves the centre of symmetry.<a class="footnoteRef" href="#fn35" id="fnref35"><sup>35</sup></a></li>
<li>Properties of derivative filters.<a class="footnoteRef" href="#fn36" id="fnref36"><sup>36</sup></a></li>
</ol>
<h3 id="signal-distortion-and-noise-reduction">Signal distortion and noise reduction</h3>

<p>It is inevitable that the signal will be distorted in the convolution process. From property 3 above, when data which has a peak is smoothed the peak height will be reduced and the <a href="Full_width_at_half_maximum" title="wikilink">half-width</a> will be increased. Both the extent of the distortion and S/N (<a href="signal-to-noise_ratio" title="wikilink">signal-to-noise ratio</a>) improvement:</p>
<ul>
<li>decrease as the degree of the polynomial increases</li>
<li>increase as the width, <em>m</em> of the convolution function increases</li>
</ul>
<figure><b>(Figure)</b>
<figcaption>Effect of smoothing on data points with uncorrelated noise of unit standard deviation</figcaption>
</figure>

<p>For example, If the noise in all data points is uncorrelated and has a constant <a href="standard_deviation" title="wikilink">standard deviation</a>, σ, the standard deviation on the noise will be decreased by convolution with an <em>m</em>-point smoothing function to<a class="footnoteRef" href="#fn37" id="fnref37"><sup>37</sup></a></p>
<dl>
<dd>polynomial degree 0 or 1

<math display="block" id="Savitzky–Golay_filter:43">
 <semantics>
  <mrow>
   <msqrt>
    <mfrac>
     <mn>1</mn>
     <mi>m</mi>
    </mfrac>
   </msqrt>
   <mi>σ</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <root></root>
     <apply>
      <divide></divide>
      <cn type="integer">1</cn>
      <ci>m</ci>
     </apply>
    </apply>
    <ci>σ</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \sqrt{{1\over m}}\sigma
  </annotation>
 </semantics>
</math>

 (<a href="moving_average" title="wikilink">moving average</a>)
</dd>
<dd>polynomial degree 2 or 3

<math display="block" id="Savitzky–Golay_filter:44">
 <semantics>
  <mrow>
   <msqrt>
    <mfrac>
     <mrow>
      <mn>3</mn>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mrow>
         <mn>3</mn>
         <msup>
          <mi>m</mi>
          <mn>2</mn>
         </msup>
        </mrow>
        <mo>-</mo>
        <mn>7</mn>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mrow>
      <mn>4</mn>
      <mi>m</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <msup>
         <mi>m</mi>
         <mn>2</mn>
        </msup>
        <mo>-</mo>
        <mn>4</mn>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mfrac>
   </msqrt>
   <mi>σ</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <root></root>
     <apply>
      <divide></divide>
      <apply>
       <times></times>
       <cn type="integer">3</cn>
       <apply>
        <minus></minus>
        <apply>
         <times></times>
         <cn type="integer">3</cn>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>m</ci>
          <cn type="integer">2</cn>
         </apply>
        </apply>
        <cn type="integer">7</cn>
       </apply>
      </apply>
      <apply>
       <times></times>
       <cn type="integer">4</cn>
       <ci>m</ci>
       <apply>
        <minus></minus>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>m</ci>
         <cn type="integer">2</cn>
        </apply>
        <cn type="integer">4</cn>
       </apply>
      </apply>
     </apply>
    </apply>
    <ci>σ</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \sqrt{\frac{3(3m^{2}-7)}{4m(m^{2}-4)}}\sigma
  </annotation>
 </semantics>
</math>

.
</dd>
</dl>

<p>These functions are shown in the plot at the right. For example, with a 9-point linear function (moving average) two thirds of the noise is removed and with a 9-point quadratic/cubic smoothing function only about half the noise is removed. Most of the noise remaining is low-frequency noise(see <em>Frequency characteristics of convolution filters</em>, below).</p>

<p>Although the moving average function gives the best noise reduction it is unsuitable for smoothing data which has curvature over <em>m</em> points. A quadratic filter function is unsuitable for getting a derivative of a data curve with an <a href="inflection_point" title="wikilink">inflection point</a> because a quadratic polynomial does not have one. The optimal choice of polynomial order and number of convolution coefficients will be a compromise between noise reduction and distortion.<a class="footnoteRef" href="#fn38" id="fnref38"><sup>38</sup></a></p>
<h4 id="multipass-filters">Multipass filters</h4>

<p>One way to mitigate distortion and improve noise removal is to use a filter of smaller width and perform more than one convolution with it. For two passes of the same filter this is equivalent to one pass of a filter obtained by convolution of the original filter with itself.<a class="footnoteRef" href="#fn39" id="fnref39"><sup>39</sup></a> For example, 2 passes of the filter with coefficients (1/3, 1/3, 1/3) is equivalent to 1 pass of the filter with coefficients (1/9, 2/9, 3/9, 2/9, 1/9).</p>

<p>The disadvantage of multipassing is that the equivalent filter width for <em>n</em> passes of an <em>m</em>-point function is <em>n</em>(<em>m</em> − 1) + 1 so multipassing is subject to greater end-effects. Nevertheless, multipassing has been used to great advantage. For instance, some 40–80 passes on data with a signal-to-noise ratio of only 5 gave useful results.<a class="footnoteRef" href="#fn40" id="fnref40"><sup>40</sup></a> The noise reduction formulae given above do not apply because <a href="#Convolution_and_correlation" title="wikilink">correlation</a> between calculated data points increases with each pass.</p>
<h3 id="frequency-characteristics-of-convolution-filters">Frequency characteristics of convolution filters</h3>

<p> Convolution maps to multiplication in the <a href="Fourier_transform" title="wikilink">Fourier</a> <a href="Codomain" title="wikilink">co-domain</a>. The <a href="discrete_Fourier_transform" title="wikilink">discrete Fourier transform</a> of a convolution filter is a <a href="real-valued_function" title="wikilink">real-valued function</a> which can be represented as</p>

<p>

<math display="block" id="Savitzky–Golay_filter:45">
 <semantics>
  <mrow>
   <mrow>
    <mi>F</mi>
    <mi>T</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>θ</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <munderover>
     <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
     <mrow>
      <mi>j</mi>
      <mo>=</mo>
      <mrow>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mn>1</mn>
         <mo>-</mo>
         <mi>m</mi>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
       <mo>/</mo>
       <mn>2</mn>
      </mrow>
     </mrow>
     <mrow>
      <mi>j</mi>
      <mo>=</mo>
      <mrow>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mi>m</mi>
         <mo>-</mo>
         <mn>1</mn>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
       <mo>/</mo>
       <mn>2</mn>
      </mrow>
     </mrow>
    </munderover>
    <mrow>
     <msub>
      <mi>C</mi>
      <mi>j</mi>
     </msub>
     <mrow>
      <mi>cos</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mi>j</mi>
        <mi>θ</mi>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>F</ci>
     <ci>T</ci>
     <ci>θ</ci>
    </apply>
    <apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <apply>
        <eq></eq>
        <ci>j</ci>
        <apply>
         <divide></divide>
         <apply>
          <minus></minus>
          <cn type="integer">1</cn>
          <ci>m</ci>
         </apply>
         <cn type="integer">2</cn>
        </apply>
       </apply>
      </apply>
      <apply>
       <eq></eq>
       <ci>j</ci>
       <apply>
        <divide></divide>
        <apply>
         <minus></minus>
         <ci>m</ci>
         <cn type="integer">1</cn>
        </apply>
        <cn type="integer">2</cn>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>C</ci>
       <ci>j</ci>
      </apply>
      <apply>
       <cos></cos>
       <apply>
        <times></times>
        <ci>j</ci>
        <ci>θ</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   FT(\theta)=\sum_{j=(1-m)/2}^{j=(m-1)/2}C_{j}\cos(j\theta)
  </annotation>
 </semantics>
</math>

 θ runs from 0 to 180 <a href="Degree_(angle)" title="wikilink">degrees</a>, after which the function merely repeats itself. The plot for a 9-point quadratic/cubic smoothing function is typical. At very low angle, the plot is almost flat, meaning that low-frequency components of the data will be virtually unchanged by the smoothing operation. As the angle increases the value decreases so that higher frequency components are more and more attenuated. This shows that the convolution filter can be described as a <a href="low-pass_filter" title="wikilink">low-pass filter</a>: the noise that is removed is primarily high-frequency noise and low-frequency noise passes through the filter.<a class="footnoteRef" href="#fn41" id="fnref41"><sup>41</sup></a> Some high-frequency noise components are attenuated more than others, as shown by undulations in the Fourier transform at large angles. This can give rise to small oscillations in the smoothed data.<a class="footnoteRef" href="#fn42" id="fnref42"><sup>42</sup></a></p>
<h3 id="convolution-and-correlation">Convolution and correlation</h3>

<p>Convolution affects the correlation between errors in the data. The effect of convolution can be expressed as a linear transformation.</p>

<p>

<math display="block" id="Savitzky–Golay_filter:46">
 <semantics>
  <mrow>
   <mpadded width="+5pt">
    <msub>
     <mi>Y</mi>
     <mi>j</mi>
    </msub>
   </mpadded>
   <mo>=</mo>
   <mrow>
    <munderover>
     <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
     <mrow>
      <mi>i</mi>
      <mo>=</mo>
      <mrow>
       <mo>-</mo>
       <mrow>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <mi>m</mi>
          <mo>-</mo>
          <mn>1</mn>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
        <mo>/</mo>
        <mn>2</mn>
       </mrow>
      </mrow>
     </mrow>
     <mrow>
      <mi>i</mi>
      <mo>=</mo>
      <mrow>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mi>m</mi>
         <mo>-</mo>
         <mn>1</mn>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
       <mo>/</mo>
       <mn>2</mn>
      </mrow>
     </mrow>
    </munderover>
    <mrow>
     <mpadded width="+1.7pt">
      <msub>
       <mi>C</mi>
       <mi>i</mi>
      </msub>
     </mpadded>
     <msub>
      <mi>y</mi>
      <mrow>
       <mi>j</mi>
       <mo>+</mo>
       <mi>i</mi>
      </mrow>
     </msub>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>Y</ci>
     <ci>j</ci>
    </apply>
    <apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <apply>
        <eq></eq>
        <ci>i</ci>
        <apply>
         <minus></minus>
         <apply>
          <divide></divide>
          <apply>
           <minus></minus>
           <ci>m</ci>
           <cn type="integer">1</cn>
          </apply>
          <cn type="integer">2</cn>
         </apply>
        </apply>
       </apply>
      </apply>
      <apply>
       <eq></eq>
       <ci>i</ci>
       <apply>
        <divide></divide>
        <apply>
         <minus></minus>
         <ci>m</ci>
         <cn type="integer">1</cn>
        </apply>
        <cn type="integer">2</cn>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>C</ci>
       <ci>i</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>y</ci>
       <apply>
        <plus></plus>
        <ci>j</ci>
        <ci>i</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Y_{j}\ =\sum_{i=-(m-1)/2}^{i=(m-1)/2}C_{i}\,y_{j+i}
  </annotation>
 </semantics>
</math>

 By the law of <a href="error_propagation" title="wikilink">error propagation</a>, the <a href="variance-covariance_matrix" title="wikilink">variance-covariance matrix</a> of the data, <strong>A</strong> will be transformed into <strong>B</strong> according to</p>

<p>

<math display="block" id="Savitzky–Golay_filter:47">
 <semantics>
  <mrow>
   <mi>𝐁</mi>
   <mo>=</mo>
   <msup>
    <mi>𝐂𝐀𝐂</mi>
    <mi>T</mi>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>𝐁</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>𝐂𝐀𝐂</ci>
     <ci>T</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{B}=\mathbf{C}\mathbf{A}\mathbf{C}^{T}
  </annotation>
 </semantics>
</math>

 To see how this applies in practice, consider the effect of a 3-point moving average on the first three calculated points, <em>Y</em><sub>2</sub> − <em>Y</em><sub>4</sub>, assuming that the data points have equal <a class="uri" href="variance" title="wikilink">variance</a> and that there is no correlation between them. <strong>A</strong> will be an <a href="identity_matrix" title="wikilink">identity matrix</a> multiplied by a constant, σ<sup>2</sup>, the variance at each point.</p>

<p>

<math display="block" id="Savitzky–Golay_filter:48">
 <semantics>
  <mrow>
   <mi>𝐁</mi>
   <mo>=</mo>
   <mrow>
    <mfrac>
     <msup>
      <mi>σ</mi>
      <mn>2</mn>
     </msup>
     <mn>9</mn>
    </mfrac>
    <mrow>
     <mo>(</mo>
     <mtable displaystyle="true">
      <mtr>
       <mtd columnalign="center">
        <mn>1</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>1</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>1</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>1</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>1</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>1</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>1</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>1</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>1</mn>
       </mtd>
      </mtr>
     </mtable>
     <mo>)</mo>
    </mrow>
    <mrow>
     <mo>(</mo>
     <mtable displaystyle="true">
      <mtr>
       <mtd columnalign="center">
        <mn>1</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>1</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>1</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>1</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>1</mn>
       </mtd>
      </mtr>
     </mtable>
     <mo>)</mo>
    </mrow>
    <mrow>
     <mo>(</mo>
     <mtable displaystyle="true">
      <mtr>
       <mtd columnalign="center">
        <mn>1</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mn>1</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>1</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mn>1</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>1</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>1</mn>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>1</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>1</mn>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>1</mn>
       </mtd>
      </mtr>
     </mtable>
     <mo>)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mfrac>
     <msup>
      <mi>σ</mi>
      <mn>2</mn>
     </msup>
     <mn>9</mn>
    </mfrac>
    <mrow>
     <mo>(</mo>
     <mtable displaystyle="true">
      <mtr>
       <mtd columnalign="center">
        <mn>3</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>2</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>1</mn>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mn>2</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>3</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>2</mn>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mn>1</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>2</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>3</mn>
       </mtd>
      </mtr>
     </mtable>
     <mo>)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <ci>𝐁</ci>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>σ</ci>
        <cn type="integer">2</cn>
       </apply>
       <cn type="integer">9</cn>
      </apply>
      <matrix>
       <matrixrow>
        <cn type="integer">1</cn>
        <cn type="integer">1</cn>
        <cn type="integer">1</cn>
        <cn type="integer">0</cn>
        <cn type="integer">0</cn>
       </matrixrow>
       <matrixrow>
        <cn type="integer">0</cn>
        <cn type="integer">1</cn>
        <cn type="integer">1</cn>
        <cn type="integer">1</cn>
        <cn type="integer">0</cn>
       </matrixrow>
       <matrixrow>
        <cn type="integer">0</cn>
        <cn type="integer">0</cn>
        <cn type="integer">1</cn>
        <cn type="integer">1</cn>
        <cn type="integer">1</cn>
       </matrixrow>
      </matrix>
      <matrix>
       <matrixrow>
        <cn type="integer">1</cn>
        <cn type="integer">0</cn>
        <cn type="integer">0</cn>
        <cn type="integer">0</cn>
        <cn type="integer">0</cn>
       </matrixrow>
       <matrixrow>
        <cn type="integer">0</cn>
        <cn type="integer">1</cn>
        <cn type="integer">0</cn>
        <cn type="integer">0</cn>
        <cn type="integer">0</cn>
       </matrixrow>
       <matrixrow>
        <cn type="integer">0</cn>
        <cn type="integer">0</cn>
        <cn type="integer">1</cn>
        <cn type="integer">0</cn>
        <cn type="integer">0</cn>
       </matrixrow>
       <matrixrow>
        <cn type="integer">0</cn>
        <cn type="integer">0</cn>
        <cn type="integer">0</cn>
        <cn type="integer">1</cn>
        <cn type="integer">0</cn>
       </matrixrow>
       <matrixrow>
        <cn type="integer">0</cn>
        <cn type="integer">0</cn>
        <cn type="integer">0</cn>
        <cn type="integer">0</cn>
        <cn type="integer">1</cn>
       </matrixrow>
      </matrix>
      <matrix>
       <matrixrow>
        <cn type="integer">1</cn>
        <cn type="integer">0</cn>
        <cn type="integer">0</cn>
       </matrixrow>
       <matrixrow>
        <cn type="integer">1</cn>
        <cn type="integer">1</cn>
        <cn type="integer">0</cn>
       </matrixrow>
       <matrixrow>
        <cn type="integer">1</cn>
        <cn type="integer">1</cn>
        <cn type="integer">1</cn>
       </matrixrow>
       <matrixrow>
        <cn type="integer">0</cn>
        <cn type="integer">1</cn>
        <cn type="integer">1</cn>
       </matrixrow>
       <matrixrow>
        <cn type="integer">0</cn>
        <cn type="integer">0</cn>
        <cn type="integer">1</cn>
       </matrixrow>
      </matrix>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>σ</ci>
        <cn type="integer">2</cn>
       </apply>
       <cn type="integer">9</cn>
      </apply>
      <matrix>
       <matrixrow>
        <cn type="integer">3</cn>
        <cn type="integer">2</cn>
        <cn type="integer">1</cn>
       </matrixrow>
       <matrixrow>
        <cn type="integer">2</cn>
        <cn type="integer">3</cn>
        <cn type="integer">2</cn>
       </matrixrow>
       <matrixrow>
        <cn type="integer">1</cn>
        <cn type="integer">2</cn>
        <cn type="integer">3</cn>
       </matrixrow>
      </matrix>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{B}={\sigma^{2}\over 9}\begin{pmatrix}1&1&1&0&0\\
0&1&1&1&0\\
0&0&1&1&1\\
\end{pmatrix}\begin{pmatrix}1&0&0&0&0\\
0&1&0&0&0\\
0&0&1&0&0\\
0&0&0&1&0\\
0&0&0&0&1\\
\end{pmatrix}\begin{pmatrix}1&0&0\\
1&1&0\\
1&1&1\\
0&1&1\\
0&0&1\\
\end{pmatrix}={\sigma^{2}\over 9}\begin{pmatrix}3&2&1\\
2&3&2\\
1&2&3\\
\end{pmatrix}
  </annotation>
 </semantics>
</math>

</p>

<p>In this case the <a href="Correlation_and_dependence" title="wikilink">correlation coefficients</a>,</p>

<p>

<math display="block" id="Savitzky–Golay_filter:49">
 <semantics>
  <mrow>
   <msub>
    <mi>ρ</mi>
    <mrow>
     <mi>i</mi>
     <mi>j</mi>
    </mrow>
   </msub>
   <mo>=</mo>
   <mfrac>
    <msub>
     <mi>B</mi>
     <mrow>
      <mi>i</mi>
      <mi>j</mi>
     </mrow>
    </msub>
    <msqrt>
     <mrow>
      <msub>
       <mi>B</mi>
       <mrow>
        <mi>i</mi>
        <mi>i</mi>
       </mrow>
      </msub>
      <msub>
       <mi>B</mi>
       <mrow>
        <mi>j</mi>
        <mi>j</mi>
       </mrow>
      </msub>
     </mrow>
    </msqrt>
   </mfrac>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>i</mi>
    <mo>≠</mo>
    <mi>j</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>ρ</ci>
     <apply>
      <times></times>
      <ci>i</ci>
      <ci>j</ci>
     </apply>
    </apply>
    <eq></eq>
    <apply>
     <divide></divide>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>B</ci>
      <apply>
       <times></times>
       <ci>i</ci>
       <ci>j</ci>
      </apply>
     </apply>
     <apply>
      <root></root>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>B</ci>
        <apply>
         <times></times>
         <ci>i</ci>
         <ci>i</ci>
        </apply>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>B</ci>
        <apply>
         <times></times>
         <ci>j</ci>
         <ci>j</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">i</csymbol>
     <neq></neq>
     <csymbol cd="unknown">j</csymbol>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \rho_{ij}=\frac{B_{ij}}{\sqrt{B_{ii}B_{jj}}}(i\neq j)
  </annotation>
 </semantics>
</math>

 between calculated points <em>i</em> and <em>j</em> will be</p>

<p>

<math display="block" id="Savitzky–Golay_filter:50">
 <semantics>
  <mrow>
   <msub>
    <mi>ρ</mi>
    <mrow>
     <mi>i</mi>
     <mo>,</mo>
     <mrow>
      <mi>i</mi>
      <mo>+</mo>
      <mn>1</mn>
     </mrow>
    </mrow>
   </msub>
   <mo>=</mo>
   <mfrac>
    <mn>2</mn>
    <mn>3</mn>
   </mfrac>
   <mo>=</mo>
   <mn>0.66</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>ρ</ci>
      <list>
       <ci>i</ci>
       <apply>
        <plus></plus>
        <ci>i</ci>
        <cn type="integer">1</cn>
       </apply>
      </list>
     </apply>
     <apply>
      <divide></divide>
      <cn type="integer">2</cn>
      <cn type="integer">3</cn>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <cn type="float">0.66</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \rho_{i,i+1}={2\over 3}=0.66
  </annotation>
 </semantics>
</math>

, 

<math display="inline" id="Savitzky–Golay_filter:51">
 <semantics>
  <mrow>
   <msub>
    <mi>ρ</mi>
    <mrow>
     <mi>i</mi>
     <mo>,</mo>
     <mrow>
      <mi>i</mi>
      <mo>+</mo>
      <mn>2</mn>
     </mrow>
    </mrow>
   </msub>
   <mo>=</mo>
   <mfrac>
    <mn>1</mn>
    <mn>3</mn>
   </mfrac>
   <mo>=</mo>
   <mn>0.33</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>ρ</ci>
      <list>
       <ci>i</ci>
       <apply>
        <plus></plus>
        <ci>i</ci>
        <cn type="integer">2</cn>
       </apply>
      </list>
     </apply>
     <apply>
      <divide></divide>
      <cn type="integer">1</cn>
      <cn type="integer">3</cn>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <cn type="float">0.33</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \rho_{i,i+2}={1\over 3}=0.33
  </annotation>
 </semantics>
</math>

 In general, the calculated values are correlated even when the observed values are not correlated. The correlation extends over <em>m</em> − 1 calculated points at a time.<a class="footnoteRef" href="#fn43" id="fnref43"><sup>43</sup></a></p>
<h4 id="multipass-filters-1">Multipass filters</h4>

<p>To illustrate the effect of multipassing on the noise and correlation of a set of data, consider the effects of a second pass of a 3-point moving average filter. For the second pass<a class="footnoteRef" href="#fn44" id="fnref44"><sup>44</sup></a></p>

<p>

<math display="block" id="Savitzky–Golay_filter:52">
 <semantics>
  <mrow>
   <msup>
    <mi>𝐂𝐁𝐂</mi>
    <mi>𝐓</mi>
   </msup>
   <mo>=</mo>
   <mrow>
    <mfrac>
     <msup>
      <mi>σ</mi>
      <mn>2</mn>
     </msup>
     <mn>81</mn>
    </mfrac>
    <mrow>
     <mo>(</mo>
     <mtable displaystyle="true">
      <mtr>
       <mtd columnalign="center">
        <mn>1</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>1</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>1</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>1</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>1</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>1</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>1</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>1</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>1</mn>
       </mtd>
      </mtr>
     </mtable>
     <mo>)</mo>
    </mrow>
    <mrow>
     <mo>(</mo>
     <mtable displaystyle="true">
      <mtr>
       <mtd columnalign="center">
        <mn>3</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>2</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>1</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mn>2</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>3</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>2</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mn>1</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>2</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>3</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
      </mtr>
     </mtable>
     <mo>)</mo>
    </mrow>
    <mrow>
     <mo>(</mo>
     <mtable displaystyle="true">
      <mtr>
       <mtd columnalign="center">
        <mn>1</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mn>1</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>1</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mn>1</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>1</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>1</mn>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>1</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>1</mn>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>1</mn>
       </mtd>
      </mtr>
     </mtable>
     <mo>)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mfrac>
     <msup>
      <mi>σ</mi>
      <mn>2</mn>
     </msup>
     <mn>81</mn>
    </mfrac>
    <mrow>
     <mo>(</mo>
     <mtable displaystyle="true">
      <mtr>
       <mtd columnalign="center">
        <mn>19</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>16</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>10</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>4</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>1</mn>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mn>16</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>19</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>16</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>10</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>4</mn>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mn>10</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>16</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>19</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>16</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>10</mn>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mn>4</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>10</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>16</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>19</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>16</mn>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mn>1</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>4</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>10</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>16</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>19</mn>
       </mtd>
      </mtr>
     </mtable>
     <mo>)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>𝐂𝐁𝐂</ci>
      <ci>𝐓</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>σ</ci>
        <cn type="integer">2</cn>
       </apply>
       <cn type="integer">81</cn>
      </apply>
      <matrix>
       <matrixrow>
        <cn type="integer">1</cn>
        <cn type="integer">1</cn>
        <cn type="integer">1</cn>
        <cn type="integer">0</cn>
        <cn type="integer">0</cn>
       </matrixrow>
       <matrixrow>
        <cn type="integer">0</cn>
        <cn type="integer">1</cn>
        <cn type="integer">1</cn>
        <cn type="integer">1</cn>
        <cn type="integer">0</cn>
       </matrixrow>
       <matrixrow>
        <cn type="integer">0</cn>
        <cn type="integer">0</cn>
        <cn type="integer">1</cn>
        <cn type="integer">1</cn>
        <cn type="integer">1</cn>
       </matrixrow>
      </matrix>
      <matrix>
       <matrixrow>
        <cn type="integer">3</cn>
        <cn type="integer">2</cn>
        <cn type="integer">1</cn>
        <cn type="integer">0</cn>
        <cn type="integer">0</cn>
       </matrixrow>
       <matrixrow>
        <cn type="integer">2</cn>
        <cn type="integer">3</cn>
        <cn type="integer">2</cn>
        <cn type="integer">0</cn>
        <cn type="integer">0</cn>
       </matrixrow>
       <matrixrow>
        <cn type="integer">1</cn>
        <cn type="integer">2</cn>
        <cn type="integer">3</cn>
        <cn type="integer">0</cn>
        <cn type="integer">0</cn>
       </matrixrow>
       <matrixrow>
        <cn type="integer">0</cn>
        <cn type="integer">0</cn>
        <cn type="integer">0</cn>
        <cn type="integer">0</cn>
        <cn type="integer">0</cn>
       </matrixrow>
       <matrixrow>
        <cn type="integer">0</cn>
        <cn type="integer">0</cn>
        <cn type="integer">0</cn>
        <cn type="integer">0</cn>
        <cn type="integer">0</cn>
       </matrixrow>
      </matrix>
      <matrix>
       <matrixrow>
        <cn type="integer">1</cn>
        <cn type="integer">0</cn>
        <cn type="integer">0</cn>
       </matrixrow>
       <matrixrow>
        <cn type="integer">1</cn>
        <cn type="integer">1</cn>
        <cn type="integer">0</cn>
       </matrixrow>
       <matrixrow>
        <cn type="integer">1</cn>
        <cn type="integer">1</cn>
        <cn type="integer">1</cn>
       </matrixrow>
       <matrixrow>
        <cn type="integer">0</cn>
        <cn type="integer">1</cn>
        <cn type="integer">1</cn>
       </matrixrow>
       <matrixrow>
        <cn type="integer">0</cn>
        <cn type="integer">0</cn>
        <cn type="integer">1</cn>
       </matrixrow>
      </matrix>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>σ</ci>
        <cn type="integer">2</cn>
       </apply>
       <cn type="integer">81</cn>
      </apply>
      <matrix>
       <matrixrow>
        <cn type="integer">19</cn>
        <cn type="integer">16</cn>
        <cn type="integer">10</cn>
        <cn type="integer">4</cn>
        <cn type="integer">1</cn>
       </matrixrow>
       <matrixrow>
        <cn type="integer">16</cn>
        <cn type="integer">19</cn>
        <cn type="integer">16</cn>
        <cn type="integer">10</cn>
        <cn type="integer">4</cn>
       </matrixrow>
       <matrixrow>
        <cn type="integer">10</cn>
        <cn type="integer">16</cn>
        <cn type="integer">19</cn>
        <cn type="integer">16</cn>
        <cn type="integer">10</cn>
       </matrixrow>
       <matrixrow>
        <cn type="integer">4</cn>
        <cn type="integer">10</cn>
        <cn type="integer">16</cn>
        <cn type="integer">19</cn>
        <cn type="integer">16</cn>
       </matrixrow>
       <matrixrow>
        <cn type="integer">1</cn>
        <cn type="integer">4</cn>
        <cn type="integer">10</cn>
        <cn type="integer">16</cn>
        <cn type="integer">19</cn>
       </matrixrow>
      </matrix>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{CBC^{T}}={\sigma^{2}\over 81}\begin{pmatrix}1&1&1&0&0\\
0&1&1&1&0\\
0&0&1&1&1\\
\end{pmatrix}\begin{pmatrix}3&2&1&0&0\\
2&3&2&0&0\\
1&2&3&0&0\\
0&0&0&0&0\\
0&0&0&0&0\\
\end{pmatrix}\begin{pmatrix}1&0&0\\
1&1&0\\
1&1&1\\
0&1&1\\
0&0&1\\
\end{pmatrix}={\sigma^{2}\over 81}\begin{pmatrix}19&16&10&4&1\\
16&19&16&10&4\\
10&16&19&16&10\\
4&10&16&19&16\\
1&4&10&16&19\\
\end{pmatrix}
  </annotation>
 </semantics>
</math>

 After two passes, the standard deviation of the central point has decreased to 

<math display="inline" id="Savitzky–Golay_filter:53">
 <semantics>
  <mrow>
   <msqrt>
    <mrow>
     <mn>19</mn>
     <mo>/</mo>
     <mn>81</mn>
    </mrow>
   </msqrt>
   <mi>σ</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <root></root>
     <apply>
      <divide></divide>
      <cn type="integer">19</cn>
      <cn type="integer">81</cn>
     </apply>
    </apply>
    <ci>σ</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \sqrt{19/81}\sigma
  </annotation>
 </semantics>
</math>

 = 0.48σ, compared to 0.58σ for one pass. The noise reduction is a little less than would be obtained with one pass of a 5-point moving average which, under the same conditions, would result in the smoothed points having the smaller standard deviation of 0.45σ.</p>

<p>Correlation now extends over a span of 4 sequential points with correlation coefficients</p>

<p>

<math display="block" id="Savitzky–Golay_filter:54">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>ρ</mi>
     <mrow>
      <mi>i</mi>
      <mo>,</mo>
      <mrow>
       <mi>i</mi>
       <mo>+</mo>
       <mn>1</mn>
      </mrow>
     </mrow>
    </msub>
    <mo>=</mo>
    <mfrac>
     <mn>16</mn>
     <mn>19</mn>
    </mfrac>
    <mo>=</mo>
    <mn>0.84</mn>
   </mrow>
   <mo>,</mo>
   <mrow>
    <msub>
     <mi>ρ</mi>
     <mrow>
      <mi>i</mi>
      <mo>,</mo>
      <mrow>
       <mi>i</mi>
       <mo>+</mo>
       <mn>2</mn>
      </mrow>
     </mrow>
    </msub>
    <mo>=</mo>
    <mfrac>
     <mn>10</mn>
     <mn>19</mn>
    </mfrac>
    <mo>=</mo>
    <mn>0.53</mn>
   </mrow>
   <mo>,</mo>
   <mrow>
    <msub>
     <mi>ρ</mi>
     <mrow>
      <mi>i</mi>
      <mo>,</mo>
      <mrow>
       <mi>i</mi>
       <mo>+</mo>
       <mn>3</mn>
      </mrow>
     </mrow>
    </msub>
    <mo>=</mo>
    <mfrac>
     <mn>4</mn>
     <mn>19</mn>
    </mfrac>
    <mo>=</mo>
    <mn>0.21</mn>
   </mrow>
   <mo>,</mo>
   <mrow>
    <msub>
     <mi>ρ</mi>
     <mrow>
      <mi>i</mi>
      <mo>,</mo>
      <mrow>
       <mi>i</mi>
       <mo>+</mo>
       <mn>4</mn>
      </mrow>
     </mrow>
    </msub>
    <mo>=</mo>
    <mfrac>
     <mn>1</mn>
     <mn>19</mn>
    </mfrac>
    <mo>=</mo>
    <mn>0.05</mn>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <and></and>
     <apply>
      <eq></eq>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>ρ</ci>
       <list>
        <ci>i</ci>
        <apply>
         <plus></plus>
         <ci>i</ci>
         <cn type="integer">1</cn>
        </apply>
       </list>
      </apply>
      <apply>
       <divide></divide>
       <cn type="integer">16</cn>
       <cn type="integer">19</cn>
      </apply>
     </apply>
     <apply>
      <eq></eq>
      <share href="#.cmml">
      </share>
      <cn type="float">0.84</cn>
     </apply>
    </apply>
    <apply>
     <and></and>
     <apply>
      <eq></eq>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>ρ</ci>
       <list>
        <ci>i</ci>
        <apply>
         <plus></plus>
         <ci>i</ci>
         <cn type="integer">2</cn>
        </apply>
       </list>
      </apply>
      <apply>
       <divide></divide>
       <cn type="integer">10</cn>
       <cn type="integer">19</cn>
      </apply>
     </apply>
     <apply>
      <eq></eq>
      <share href="#.cmml">
      </share>
      <cn type="float">0.53</cn>
     </apply>
    </apply>
    <apply>
     <and></and>
     <apply>
      <eq></eq>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>ρ</ci>
       <list>
        <ci>i</ci>
        <apply>
         <plus></plus>
         <ci>i</ci>
         <cn type="integer">3</cn>
        </apply>
       </list>
      </apply>
      <apply>
       <divide></divide>
       <cn type="integer">4</cn>
       <cn type="integer">19</cn>
      </apply>
     </apply>
     <apply>
      <eq></eq>
      <share href="#.cmml">
      </share>
      <cn type="float">0.21</cn>
     </apply>
    </apply>
    <apply>
     <and></and>
     <apply>
      <eq></eq>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>ρ</ci>
       <list>
        <ci>i</ci>
        <apply>
         <plus></plus>
         <ci>i</ci>
         <cn type="integer">4</cn>
        </apply>
       </list>
      </apply>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <cn type="integer">19</cn>
      </apply>
     </apply>
     <apply>
      <eq></eq>
      <share href="#.cmml">
      </share>
      <cn type="float">0.05</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \rho_{i,i+1}={16\over 19}=0.84,\rho_{i,i+2}={10\over 19}=0.53,\rho_{i,i+3}={4%
\over 19}=0.21,\rho_{i,i+4}={1\over 19}=0.05
  </annotation>
 </semantics>
</math>

</p>

<p>The advantage obtained by performing two passes with the narrower smoothing function is that it introduces less distortion into the calculated data.</p>
<h2 id="see-also">See also</h2>
<ul>
<li><a href="Kernel_smoother" title="wikilink">Kernel smoother</a> – Different terminology for many of the same processes, used in <a class="uri" href="statistics" title="wikilink">statistics</a></li>
<li><a href="Local_regression" title="wikilink">Local regression</a> — the LOESS and LOWESS methods</li>
<li><a href="Numerical_differentiation" title="wikilink">Numerical differentiation</a> – Application to differentiation of <a href="function_(mathematics)" title="wikilink">functions</a></li>
<li><a href="Smoothing_spline" title="wikilink">Smoothing spline</a></li>
<li><a href="Stencil_(numerical_analysis)" title="wikilink">Stencil (numerical analysis)</a> – Application to the solution of differential equations</li>
</ul>
<h2 id="appendix">Appendix</h2>
<h3 id="tables-of-selected-convolution-coefficients">Tables of selected convolution coefficients</h3>

<p>Consider a set of data points (<em>x<sub>j</sub></em>, <em>y<sub>j</sub></em>)<sub>1 ≤ <em>j</em> ≤ <em>n</em></sub>. The Savitzky–Golay tables refer to the case that the step <em>x</em><sub><em>j</em></sub> − <em>x</em><sub><em>j</em> − 1</sub> is constant, <em>h</em>. Examples of the use of the so-called convolution coefficients, with a cubic polynomial and a window size, <em>m</em>, of 5 points are as follows.</p>
<dl>
<dd>Smoothing

<math display="block" id="Savitzky–Golay_filter:55">
 <semantics>
  <mrow>
   <msub>
    <mi>Y</mi>
    <mi>j</mi>
   </msub>
   <mo>=</mo>
   <mrow>
    <mfrac>
     <mn>1</mn>
     <mn>35</mn>
    </mfrac>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mrow>
       <mrow>
        <mo>-</mo>
        <mrow>
         <mn>3</mn>
         <mo>×</mo>
         <msub>
          <mi>y</mi>
          <mrow>
           <mi>j</mi>
           <mo>-</mo>
           <mn>2</mn>
          </mrow>
         </msub>
        </mrow>
       </mrow>
       <mo>+</mo>
       <mrow>
        <mn>12</mn>
        <mo>×</mo>
        <msub>
         <mi>y</mi>
         <mrow>
          <mi>j</mi>
          <mo>-</mo>
          <mn>1</mn>
         </mrow>
        </msub>
       </mrow>
       <mo>+</mo>
       <mrow>
        <mn>17</mn>
        <mo>×</mo>
        <msub>
         <mi>y</mi>
         <mi>j</mi>
        </msub>
       </mrow>
       <mo>+</mo>
       <mrow>
        <mn>12</mn>
        <mo>×</mo>
        <msub>
         <mi>y</mi>
         <mrow>
          <mi>j</mi>
          <mo>+</mo>
          <mn>1</mn>
         </mrow>
        </msub>
       </mrow>
      </mrow>
      <mo>-</mo>
      <mrow>
       <mn>3</mn>
       <mo>×</mo>
       <msub>
        <mi>y</mi>
        <mrow>
         <mi>j</mi>
         <mo>+</mo>
         <mn>2</mn>
        </mrow>
       </msub>
      </mrow>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>Y</ci>
     <ci>j</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <divide></divide>
      <cn type="integer">1</cn>
      <cn type="integer">35</cn>
     </apply>
     <apply>
      <minus></minus>
      <apply>
       <plus></plus>
       <apply>
        <minus></minus>
        <apply>
         <times></times>
         <cn type="integer">3</cn>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>y</ci>
          <apply>
           <minus></minus>
           <ci>j</ci>
           <cn type="integer">2</cn>
          </apply>
         </apply>
        </apply>
       </apply>
       <apply>
        <times></times>
        <cn type="integer">12</cn>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>y</ci>
         <apply>
          <minus></minus>
          <ci>j</ci>
          <cn type="integer">1</cn>
         </apply>
        </apply>
       </apply>
       <apply>
        <times></times>
        <cn type="integer">17</cn>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>y</ci>
         <ci>j</ci>
        </apply>
       </apply>
       <apply>
        <times></times>
        <cn type="integer">12</cn>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>y</ci>
         <apply>
          <plus></plus>
          <ci>j</ci>
          <cn type="integer">1</cn>
         </apply>
        </apply>
       </apply>
      </apply>
      <apply>
       <times></times>
       <cn type="integer">3</cn>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>y</ci>
        <apply>
         <plus></plus>
         <ci>j</ci>
         <cn type="integer">2</cn>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Y_{j}=\frac{1}{35}(-3\times y_{j-2}+12\times y_{j-1}+17\times y_{j}+12\times y%
_{j+1}-3\times y_{j+2})
  </annotation>
 </semantics>
</math>

 ;
</dd>
<dd>1st derivative

<math display="block" id="Savitzky–Golay_filter:56">
 <semantics>
  <mrow>
   <msubsup>
    <mi>Y</mi>
    <mi>j</mi>
    <mo>′</mo>
   </msubsup>
   <mo>=</mo>
   <mrow>
    <mfrac>
     <mn>1</mn>
     <mrow>
      <mn>12</mn>
      <mi>h</mi>
     </mrow>
    </mfrac>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mrow>
       <mrow>
        <mrow>
         <mn>1</mn>
         <mo>×</mo>
         <msub>
          <mi>y</mi>
          <mrow>
           <mi>j</mi>
           <mo>-</mo>
           <mn>2</mn>
          </mrow>
         </msub>
        </mrow>
        <mo>-</mo>
        <mrow>
         <mn>8</mn>
         <mo>×</mo>
         <msub>
          <mi>y</mi>
          <mrow>
           <mi>j</mi>
           <mo>-</mo>
           <mn>1</mn>
          </mrow>
         </msub>
        </mrow>
       </mrow>
       <mo>+</mo>
       <mrow>
        <mn>0</mn>
        <mo>×</mo>
        <msub>
         <mi>y</mi>
         <mi>j</mi>
        </msub>
       </mrow>
       <mo>+</mo>
       <mrow>
        <mn>8</mn>
        <mo>×</mo>
        <msub>
         <mi>y</mi>
         <mrow>
          <mi>j</mi>
          <mo>+</mo>
          <mn>1</mn>
         </mrow>
        </msub>
       </mrow>
      </mrow>
      <mo>-</mo>
      <mrow>
       <mn>1</mn>
       <mo>×</mo>
       <msub>
        <mi>y</mi>
        <mrow>
         <mi>j</mi>
         <mo>+</mo>
         <mn>2</mn>
        </mrow>
       </msub>
      </mrow>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>Y</ci>
      <ci>normal-′</ci>
     </apply>
     <ci>j</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <divide></divide>
      <cn type="integer">1</cn>
      <apply>
       <times></times>
       <cn type="integer">12</cn>
       <ci>h</ci>
      </apply>
     </apply>
     <apply>
      <minus></minus>
      <apply>
       <plus></plus>
       <apply>
        <minus></minus>
        <apply>
         <times></times>
         <cn type="integer">1</cn>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>y</ci>
          <apply>
           <minus></minus>
           <ci>j</ci>
           <cn type="integer">2</cn>
          </apply>
         </apply>
        </apply>
        <apply>
         <times></times>
         <cn type="integer">8</cn>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>y</ci>
          <apply>
           <minus></minus>
           <ci>j</ci>
           <cn type="integer">1</cn>
          </apply>
         </apply>
        </apply>
       </apply>
       <apply>
        <times></times>
        <cn type="integer">0</cn>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>y</ci>
         <ci>j</ci>
        </apply>
       </apply>
       <apply>
        <times></times>
        <cn type="integer">8</cn>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>y</ci>
         <apply>
          <plus></plus>
          <ci>j</ci>
          <cn type="integer">1</cn>
         </apply>
        </apply>
       </apply>
      </apply>
      <apply>
       <times></times>
       <cn type="integer">1</cn>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>y</ci>
        <apply>
         <plus></plus>
         <ci>j</ci>
         <cn type="integer">2</cn>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Y^{\prime}_{j}=\frac{1}{12h}(1\times y_{j-2}-8\times y_{j-1}+0\times y_{j}+8%
\times y_{j+1}-1\times y_{j+2})
  </annotation>
 </semantics>
</math>

 ;
</dd>
<dd>2nd. derivative

<math display="block" id="Savitzky–Golay_filter:57">
 <semantics>
  <mrow>
   <msubsup>
    <mi>Y</mi>
    <mi>j</mi>
    <mi>′′</mi>
   </msubsup>
   <mo>=</mo>
   <mrow>
    <mfrac>
     <mn>1</mn>
     <mrow>
      <mn>7</mn>
      <msup>
       <mi>h</mi>
       <mn>2</mn>
      </msup>
     </mrow>
    </mfrac>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mrow>
       <mrow>
        <mn>2</mn>
        <mo>×</mo>
        <msub>
         <mi>y</mi>
         <mrow>
          <mi>j</mi>
          <mo>-</mo>
          <mn>2</mn>
         </mrow>
        </msub>
       </mrow>
       <mo>-</mo>
       <mrow>
        <mn>1</mn>
        <mo>×</mo>
        <msub>
         <mi>y</mi>
         <mrow>
          <mi>j</mi>
          <mo>-</mo>
          <mn>1</mn>
         </mrow>
        </msub>
       </mrow>
       <mo>-</mo>
       <mrow>
        <mn>2</mn>
        <mo>×</mo>
        <msub>
         <mi>y</mi>
         <mi>j</mi>
        </msub>
       </mrow>
       <mo>-</mo>
       <mrow>
        <mn>1</mn>
        <mo>×</mo>
        <msub>
         <mi>y</mi>
         <mrow>
          <mi>j</mi>
          <mo>+</mo>
          <mn>1</mn>
         </mrow>
        </msub>
       </mrow>
      </mrow>
      <mo>+</mo>
      <mrow>
       <mn>2</mn>
       <mo>×</mo>
       <msub>
        <mi>y</mi>
        <mrow>
         <mi>j</mi>
         <mo>+</mo>
         <mn>2</mn>
        </mrow>
       </msub>
      </mrow>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>Y</ci>
      <ci>′′</ci>
     </apply>
     <ci>j</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <divide></divide>
      <cn type="integer">1</cn>
      <apply>
       <times></times>
       <cn type="integer">7</cn>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>h</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
     </apply>
     <apply>
      <plus></plus>
      <apply>
       <minus></minus>
       <apply>
        <times></times>
        <cn type="integer">2</cn>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>y</ci>
         <apply>
          <minus></minus>
          <ci>j</ci>
          <cn type="integer">2</cn>
         </apply>
        </apply>
       </apply>
       <apply>
        <times></times>
        <cn type="integer">1</cn>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>y</ci>
         <apply>
          <minus></minus>
          <ci>j</ci>
          <cn type="integer">1</cn>
         </apply>
        </apply>
       </apply>
       <apply>
        <times></times>
        <cn type="integer">2</cn>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>y</ci>
         <ci>j</ci>
        </apply>
       </apply>
       <apply>
        <times></times>
        <cn type="integer">1</cn>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>y</ci>
         <apply>
          <plus></plus>
          <ci>j</ci>
          <cn type="integer">1</cn>
         </apply>
        </apply>
       </apply>
      </apply>
      <apply>
       <times></times>
       <cn type="integer">2</cn>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>y</ci>
        <apply>
         <plus></plus>
         <ci>j</ci>
         <cn type="integer">2</cn>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Y^{\prime\prime}_{j}=\frac{1}{7h^{2}}(2\times y_{j-2}-1\times y_{j-1}-2\times y%
_{j}-1\times y_{j+1}+2\times y_{j+2})
  </annotation>
 </semantics>
</math>

.
</dd>
</dl>

<p>Selected values of the convolution coefficients for polynomials of degree 1,2,3, 4 and 5 are given in the following tables. The values were calculated using the PASCAL code provided in Gorry.<a class="footnoteRef" href="#fn45" id="fnref45"><sup>45</sup></a></p>
<table>
<tbody>
<tr class="odd">
<td style="text-align: left;"><table>
<tbody>
<tr class="odd">
<td style="text-align: left;">
<p>Coefficients for smoothing</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>Degree</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>Window size</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>−4</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>−3</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>−2</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>−1</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>0</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>1</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>2</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>3</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>4</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>Normalisation</p></td>
</tr>
</tbody>
</table></td>
<td style="text-align: left;"><table>
<tbody>
<tr class="odd">
<td style="text-align: left;">
<p>Coefficients for 1st derivative</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>Degree</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>Window size</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>−4</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>−3</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>−2</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>−1</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>0</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>1</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>2</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>3</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>4</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>Normalisation</p></td>
</tr>
</tbody>
</table></td>
</tr>
</tbody>
</table>
<table>
<tbody>
<tr class="odd">
<td style="text-align: left;"><table>
<tbody>
<tr class="odd">
<td style="text-align: left;">
<p>Coefficients for 2nd derivative</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>Degree</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>Window size</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>−4</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>−3</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>−2</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>−1</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>0</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>1</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>2</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>3</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>4</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>Normalisation</p></td>
</tr>
</tbody>
</table></td>
<td style="text-align: left;"><table>
<tbody>
<tr class="odd">
<td style="text-align: left;">
<p>Coefficients for 3rd derivative</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>Degree</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>Window size</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>−4</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>−3</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>−2</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>−1</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>0</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>1</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>2</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>3</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>4</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>Normalisation</p></td>
</tr>
</tbody>
</table></td>
<td style="text-align: left;"><table>
<tbody>
<tr class="odd">
<td style="text-align: left;">
<p>Coefficients for 4th derivative</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>Degree</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>Window size</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>−4</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>−3</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>−2</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>−1</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>0</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>1</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>2</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>3</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>4</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>Normalisation</p></td>
</tr>
</tbody>
</table></td>
</tr>
</tbody>
</table>
<h2 id="notes">Notes</h2>
<h2 id="references">References</h2>
<ul>
<li></li>
</ul>
<h2 id="external-links">External links</h2>
<ul>
<li><a href="http://www.statistics4u.info/fundstat_eng/cc_filter_savgolay.html">Savitzky–Golay filter in Fundamentals of Statistics</a></li>
</ul>

<p>"</p>

<p><a href="Category:Filter_theory" title="wikilink">Category:Filter theory</a> <a href="Category:Signal_processing" title="wikilink">Category:Signal processing</a> <a href="Category:Regression_analysis" title="wikilink">Category:Regression analysis</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1">. "Graduation Formulae obtained by fitting a Polynomial."<a href="#fnref1">↩</a></li>
<li id="fn2"><a href="#fnref2">↩</a></li>
<li id="fn3"><a href="#fnref3">↩</a></li>
<li id="fn4"><a href="#fnref4">↩</a></li>
<li id="fn5"><a href="#fnref5">↩</a></li>
<li id="fn6"><a href="#fnref6">↩</a></li>
<li id="fn7"><a href="#fnref7">↩</a></li>
<li id="fn8"><a href="#fnref8">↩</a></li>
<li id="fn9"></li>
<li id="fn10"><a href="#fnref10">↩</a></li>
<li id="fn11"><a href="#fnref11">↩</a></li>
<li id="fn12"><a href="#fnref12">↩</a></li>
<li id="fn13"><a href="#fnref13">↩</a></li>
<li id="fn14"></li>
<li id="fn15">With even values of <em>m</em>, <em>z</em> will run from 1 − <em>m</em> to <em>m</em> − 1 in steps of 2<a href="#fnref15">↩</a></li>
<li id="fn16">The simple <a href="moving_average" title="wikilink">moving average</a> is a special case with <em>k</em> = 0, <em>Y</em> = <em>a</em><sub>0</sub>. In this case all convolution coefficients are equal to 1/<em>m</em>.<a href="#fnref16">↩</a></li>
<li id="fn17"></li>
<li id="fn18"></li>
<li id="fn19">Smoothing using the moving average is equivalent, with equally spaced points, to local fitting with a (sloping) straight line<a href="#fnref19">↩</a></li>
<li id="fn20"><a href="#fnref20">↩</a></li>
<li id="fn21">The expressions given here are different from those of Madden, which are given in terms of the variable m' = (m − 1)/2.<a href="#fnref21">↩</a></li>
<li id="fn22"><a href="#fnref22">↩</a></li>
<li id="fn23"></li>
<li id="fn24"></li>
<li id="fn25"><a href="#fnref25">↩</a></li>
<li id="fn26"><a href="#fnref26">↩</a></li>
<li id="fn27"><a href="#fnref27">↩</a></li>
<li id="fn28"><a href="#fnref28">↩</a></li>
<li id="fn29"><a href="#fnref29">↩</a></li>
<li id="fn30"></li>
<li id="fn31"><a href="#fnref31">↩</a></li>
<li id="fn32"><a href="#fnref32">↩</a></li>
<li id="fn33"></li>
<li id="fn34"></li>
<li id="fn35"></li>
<li id="fn36"><a href="#fnref36">↩</a></li>
<li id="fn37"><a href="#fnref37">↩</a></li>
<li id="fn38"><a href="#fnref38">↩</a></li>
<li id="fn39"><a href="#fnref39">↩</a></li>
<li id="fn40"><a href="#fnref40">↩</a></li>
<li id="fn41"><a href="#fnref41">↩</a></li>
<li id="fn42"><a href="#fnref42">↩</a></li>
<li id="fn43"><a href="#fnref43">↩</a></li>
<li id="fn44">The same result is obtained with one pass of the equivalent filter with coefficients (1/9, 2/9, 3/9, 2/9, 1/9) and an identity variance-covariance matrix<a href="#fnref44">↩</a></li>
<li id="fn45"></li>
</ol>
</section>
</body>
</html>

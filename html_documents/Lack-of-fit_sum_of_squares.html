<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="1022">Lack-of-fit sum of squares</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Lack-of-fit sum of squares</h1>
<hr/>

<p>In <a class="uri" href="statistics" title="wikilink">statistics</a>, a <strong>sum of squares due to lack of fit</strong>, or more tersely a <strong>lack-of-fit sum of squares</strong>, is one of the components of a partition of the <a href="Sum_of_squares_(statistics)" title="wikilink">sum of squares</a> in an <a href="analysis_of_variance" title="wikilink">analysis of variance</a>, used in the <a class="uri" href="numerator" title="wikilink">numerator</a> in an <a class="uri" href="F-test" title="wikilink">F-test</a> of the <a href="null_hypothesis" title="wikilink">null hypothesis</a> that says that a proposed model fits well.</p>
<h2 id="sketch-of-the-idea">Sketch of the idea</h2>

<p>In order for the lack-of-fit sum of squares to differ from the <a href="Residual_sum_of_squares" title="wikilink">sum of squares of residuals</a>, there must be <a href="replication_(statistics)" title="wikilink">more than one</a> value of the <a href="response_variable" title="wikilink">response variable</a> for at least one of the values of the set of predictor variables. For example, consider fitting a line</p>

<p>

<math display="block" id="Lack-of-fit_sum_of_squares:0">
 <semantics>
  <mrow>
   <mi>y</mi>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mi>α</mi>
     <mi>x</mi>
    </mrow>
    <mo>+</mo>
    <mpadded width="+1.7pt">
     <mi>β</mi>
    </mpadded>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>y</ci>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <ci>α</ci>
      <ci>x</ci>
     </apply>
     <ci>β</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   y=\alpha x+\beta\,
  </annotation>
 </semantics>
</math>

</p>

<p>by the method of <a href="least_squares" title="wikilink">least squares</a>. One takes as estimates of <em>α</em> and <em>β</em> the values that minimize the sum of squares of residuals, i.e., the sum of squares of the differences between the observed <em>y</em>-value and the fitted <em>y</em>-value. To have a lack-of-fit sum of squares that differs from the residual sum of squares, one must observe more than one <em>y</em>-value for each of one or more of the <em>x</em>-values. One then partitions the "sum of squares due to error", i.e., the sum of squares of residuals, into two components:</p>
<dl>
<dd>sum of squares due to error = (sum of squares due to "pure" error) + (sum of squares due to lack of fit).
</dd>
</dl>

<p>The sum of squares due to "pure" error is the sum of squares of the differences between each observed <em>y</em>-value and the average of all <em>y</em>-values corresponding to the same <em>x</em>-value.</p>

<p>The sum of squares due to lack of fit is the <em>weighted</em> sum of squares of differences between each average of <em>y</em>-values corresponding to the same <em>x</em>-value and the corresponding fitted <em>y</em>-value, the weight in each case being simply the number of observed <em>y</em>-values for that <em>x</em>-value.<a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a><a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a> Because it is a property of least squares regression that the vector whose components are "pure errors" and the vector of lack-of-fit components are orthogonal to each other, the following equality holds:</p>

<p>

<math display="inline" id="Lack-of-fit_sum_of_squares:1">
 <semantics>
  <mstyle displaystyle="true">
   <mrow>
    <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
    <msup>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mtext>observed value</mtext>
       <mo>-</mo>
       <mtext>fitted value</mtext>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <mn>2</mn>
    </msup>
   </mrow>
  </mstyle>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <sum></sum>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <minus></minus>
      <mtext>observed value</mtext>
      <mtext>fitted value</mtext>
     </apply>
     <cn type="integer">2</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle\sum(\text{observed value}-\text{fitted value})^{2}
  </annotation>
 </semantics>
</math>


</p>

<p>Hence the residual sum of squares has been completely decomposed into two components.</p>
<h2 id="mathematical-details">Mathematical details</h2>

<p>Consider fitting a line with one predictor variable. Define <em>i</em> as an index of each of the <em>n</em> distinct <em>x</em> values, <em>j</em> as an index of the response variable observations for a given <em>x</em> value, and <em>n</em><sub><em>i</em></sub> as the number of <em>y</em> values associated with the <em>i</em> <sup>th</sup> <em>x</em> value. The value of each response variable observation can be represented by</p>

<p>

<math display="block" id="Lack-of-fit_sum_of_squares:2">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <msub>
      <mi>Y</mi>
      <mrow>
       <mi>i</mi>
       <mi>j</mi>
      </mrow>
     </msub>
     <mo>=</mo>
     <mrow>
      <mrow>
       <mi>α</mi>
       <msub>
        <mi>x</mi>
        <mi>i</mi>
       </msub>
      </mrow>
      <mo>+</mo>
      <mi>β</mi>
      <mo>+</mo>
      <msub>
       <mi>ε</mi>
       <mrow>
        <mi>i</mi>
        <mi>j</mi>
       </mrow>
      </msub>
     </mrow>
    </mrow>
    <mo rspace="22.5pt">,</mo>
    <mrow>
     <mrow>
      <mi>i</mi>
      <mo>=</mo>
      <mrow>
       <mn>1</mn>
       <mo>,</mo>
       <mi mathvariant="normal">…</mi>
       <mo>,</mo>
       <mi>n</mi>
      </mrow>
     </mrow>
     <mo rspace="12.5pt">,</mo>
     <mrow>
      <mi>j</mi>
      <mo>=</mo>
      <mrow>
       <mn>1</mn>
       <mo>,</mo>
       <mi mathvariant="normal">…</mi>
       <mo>,</mo>
       <msub>
        <mi>n</mi>
        <mi>i</mi>
       </msub>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>Y</ci>
      <apply>
       <times></times>
       <ci>i</ci>
       <ci>j</ci>
      </apply>
     </apply>
     <apply>
      <plus></plus>
      <apply>
       <times></times>
       <ci>α</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <ci>i</ci>
       </apply>
      </apply>
      <ci>β</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>ε</ci>
       <apply>
        <times></times>
        <ci>i</ci>
        <ci>j</ci>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <csymbol cd="ambiguous">formulae-sequence</csymbol>
     <apply>
      <eq></eq>
      <ci>i</ci>
      <list>
       <cn type="integer">1</cn>
       <ci>normal-…</ci>
       <ci>n</ci>
      </list>
     </apply>
     <apply>
      <eq></eq>
      <ci>j</ci>
      <list>
       <cn type="integer">1</cn>
       <ci>normal-…</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>n</ci>
        <ci>i</ci>
       </apply>
      </list>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Y_{ij}=\alpha x_{i}+\beta+\varepsilon_{ij},\qquad i=1,\dots,n,\quad j=1,\dots,%
n_{i}.
  </annotation>
 </semantics>
</math>

</p>

<p>Let</p>

<p>

<math display="block" id="Lack-of-fit_sum_of_squares:3">
 <semantics>
  <mrow>
   <mover accent="true">
    <mi>α</mi>
    <mo>^</mo>
   </mover>
   <mo>,</mo>
   <mpadded width="+1.7pt">
    <mover accent="true">
     <mi>β</mi>
     <mo>^</mo>
    </mover>
   </mpadded>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <list>
    <apply>
     <ci>normal-^</ci>
     <ci>α</ci>
    </apply>
    <apply>
     <ci>normal-^</ci>
     <ci>β</ci>
    </apply>
   </list>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \widehat{\alpha},\widehat{\beta}\,
  </annotation>
 </semantics>
</math>

</p>

<p>be the <a href="least_squares" title="wikilink">least squares</a> estimates of the unobservable parameters <em>α</em> and <em>β</em> based on the observed values of <em>x</em><sub> <em>i</em></sub> and <em>Y</em><sub> <em>i j</em></sub>.</p>

<p>Let</p>

<p>

<math display="block" id="Lack-of-fit_sum_of_squares:4">
 <semantics>
  <mrow>
   <msub>
    <mover accent="true">
     <mi>Y</mi>
     <mo>^</mo>
    </mover>
    <mi>i</mi>
   </msub>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mover accent="true">
      <mi>α</mi>
      <mo>^</mo>
     </mover>
     <msub>
      <mi>x</mi>
      <mi>i</mi>
     </msub>
    </mrow>
    <mo>+</mo>
    <mpadded width="+1.7pt">
     <mover accent="true">
      <mi>β</mi>
      <mo>^</mo>
     </mover>
    </mpadded>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <ci>normal-^</ci>
      <ci>Y</ci>
     </apply>
     <ci>i</ci>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <apply>
       <ci>normal-^</ci>
       <ci>α</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <ci>i</ci>
      </apply>
     </apply>
     <apply>
      <ci>normal-^</ci>
      <ci>β</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \widehat{Y}_{i}=\widehat{\alpha}x_{i}+\widehat{\beta}\,
  </annotation>
 </semantics>
</math>

</p>

<p>be the fitted values of the response variable. Then</p>

<p>

<math display="block" id="Lack-of-fit_sum_of_squares:5">
 <semantics>
  <mrow>
   <msub>
    <mover accent="true">
     <mi>ε</mi>
     <mo>^</mo>
    </mover>
    <mrow>
     <mi>i</mi>
     <mi>j</mi>
    </mrow>
   </msub>
   <mo>=</mo>
   <mrow>
    <msub>
     <mi>Y</mi>
     <mrow>
      <mi>i</mi>
      <mi>j</mi>
     </mrow>
    </msub>
    <mo>-</mo>
    <mpadded width="+1.7pt">
     <msub>
      <mover accent="true">
       <mi>Y</mi>
       <mo>^</mo>
      </mover>
      <mi>i</mi>
     </msub>
    </mpadded>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <ci>normal-^</ci>
      <ci>ε</ci>
     </apply>
     <apply>
      <times></times>
      <ci>i</ci>
      <ci>j</ci>
     </apply>
    </apply>
    <apply>
     <minus></minus>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>Y</ci>
      <apply>
       <times></times>
       <ci>i</ci>
       <ci>j</ci>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <ci>normal-^</ci>
       <ci>Y</ci>
      </apply>
      <ci>i</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \widehat{\varepsilon}_{ij}=Y_{ij}-\widehat{Y}_{i}\,
  </annotation>
 </semantics>
</math>

</p>

<p>are the <a href="errors_and_residuals_in_statistics" title="wikilink">residuals</a>, which are observable estimates of the unobservable values of the error term <em>ε</em><sub> <em>ij</em></sub>. Because of the nature of the method of least squares, the whole vector of residuals, with</p>

<p>

<math display="block" id="Lack-of-fit_sum_of_squares:6">
 <semantics>
  <mrow>
   <mi>N</mi>
   <mo>=</mo>
   <mrow>
    <munderover>
     <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
     <mrow>
      <mi>i</mi>
      <mo>=</mo>
      <mn>1</mn>
     </mrow>
     <mi>n</mi>
    </munderover>
    <msub>
     <mi>n</mi>
     <mi>i</mi>
    </msub>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>N</ci>
    <apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <apply>
        <eq></eq>
        <ci>i</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <ci>n</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>n</ci>
      <ci>i</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   N=\sum_{i=1}^{n}n_{i}
  </annotation>
 </semantics>
</math>

</p>

<p>scalar components, necessarily satisfies the two constraints</p>

<p>

<math display="block" id="Lack-of-fit_sum_of_squares:7">
 <semantics>
  <mrow>
   <mrow>
    <munderover>
     <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
     <mrow>
      <mi>i</mi>
      <mo>=</mo>
      <mn>1</mn>
     </mrow>
     <mi>n</mi>
    </munderover>
    <mrow>
     <munderover>
      <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
      <mrow>
       <mi>j</mi>
       <mo>=</mo>
       <mn>1</mn>
      </mrow>
      <msub>
       <mi>n</mi>
       <mi>i</mi>
      </msub>
     </munderover>
     <msub>
      <mover accent="true">
       <mi>ε</mi>
       <mo>^</mo>
      </mover>
      <mrow>
       <mi>i</mi>
       <mi>j</mi>
      </mrow>
     </msub>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mpadded width="+1.7pt">
    <mn>0</mn>
   </mpadded>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <apply>
        <eq></eq>
        <ci>i</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <ci>n</ci>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <apply>
         <eq></eq>
         <ci>j</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>n</ci>
        <ci>i</ci>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <apply>
        <ci>normal-^</ci>
        <ci>ε</ci>
       </apply>
       <apply>
        <times></times>
        <ci>i</ci>
        <ci>j</ci>
       </apply>
      </apply>
     </apply>
    </apply>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \sum_{i=1}^{n}\sum_{j=1}^{n_{i}}\widehat{\varepsilon}_{ij}=0\,
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Lack-of-fit_sum_of_squares:8">
 <semantics>
  <mrow>
   <mrow>
    <munderover>
     <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
     <mrow>
      <mi>i</mi>
      <mo>=</mo>
      <mn>1</mn>
     </mrow>
     <mi>n</mi>
    </munderover>
    <mrow>
     <mo>(</mo>
     <mrow>
      <msub>
       <mi>x</mi>
       <mi>i</mi>
      </msub>
      <mrow>
       <munderover>
        <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
        <mrow>
         <mi>j</mi>
         <mo>=</mo>
         <mn>1</mn>
        </mrow>
        <msub>
         <mi>n</mi>
         <mi>i</mi>
        </msub>
       </munderover>
       <msub>
        <mover accent="true">
         <mi>ε</mi>
         <mo>^</mo>
        </mover>
        <mrow>
         <mi>i</mi>
         <mi>j</mi>
        </mrow>
       </msub>
      </mrow>
     </mrow>
     <mo>)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mpadded width="+1.7pt">
    <mn>0.</mn>
   </mpadded>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <apply>
        <eq></eq>
        <ci>i</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <ci>n</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <ci>i</ci>
      </apply>
      <apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <sum></sum>
         <apply>
          <eq></eq>
          <ci>j</ci>
          <cn type="integer">1</cn>
         </apply>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>n</ci>
         <ci>i</ci>
        </apply>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <apply>
         <ci>normal-^</ci>
         <ci>ε</ci>
        </apply>
        <apply>
         <times></times>
         <ci>i</ci>
         <ci>j</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
    <cn type="float">0.</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \sum_{i=1}^{n}\left(x_{i}\sum_{j=1}^{n_{i}}\widehat{\varepsilon}_{ij}\right)=0.\,
  </annotation>
 </semantics>
</math>

</p>

<p>It is thus constrained to lie in an (<em>N</em> − 2)-dimensional subspace of <strong>R</strong><sup> <em>N</em></sup>, i.e. there are <em>N</em> − 2 "<a href="degrees_of_freedom_(statistics)" title="wikilink">degrees of freedom</a> for error".</p>

<p>Now let</p>

<p>

<math display="block" id="Lack-of-fit_sum_of_squares:9">
 <semantics>
  <mrow>
   <msub>
    <mover accent="true">
     <mi>Y</mi>
     <mo>¯</mo>
    </mover>
    <mrow>
     <mi>i</mi>
     <mo>∙</mo>
    </mrow>
   </msub>
   <mo>=</mo>
   <mrow>
    <mfrac>
     <mn>1</mn>
     <msub>
      <mi>n</mi>
      <mi>i</mi>
     </msub>
    </mfrac>
    <mrow>
     <munderover>
      <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
      <mrow>
       <mi>j</mi>
       <mo>=</mo>
       <mn>1</mn>
      </mrow>
      <msub>
       <mi>n</mi>
       <mi>i</mi>
      </msub>
     </munderover>
     <msub>
      <mi>Y</mi>
      <mrow>
       <mi>i</mi>
       <mi>j</mi>
      </mrow>
     </msub>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <ci>normal-¯</ci>
      <ci>Y</ci>
     </apply>
     <list>
      <ci>i</ci>
      <ci>normal-∙</ci>
     </list>
    </apply>
    <apply>
     <times></times>
     <apply>
      <divide></divide>
      <cn type="integer">1</cn>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>n</ci>
       <ci>i</ci>
      </apply>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <apply>
         <eq></eq>
         <ci>j</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>n</ci>
        <ci>i</ci>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>Y</ci>
       <apply>
        <times></times>
        <ci>i</ci>
        <ci>j</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \overline{Y}_{i\bullet}=\frac{1}{n_{i}}\sum_{j=1}^{n_{i}}Y_{ij}
  </annotation>
 </semantics>
</math>

</p>

<p>be the average of all <em>Y</em>-values associated with the <em>i</em> <sup>th</sup> <em>x</em>-value.</p>

<p>We partition the sum of squares due to error into two components:</p>

<p>

<math display="inline" id="Lack-of-fit_sum_of_squares:10">
 <semantics>
  <mrow>
   <mrow>
    <mstyle displaystyle="true">
     <munderover>
      <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
      <mrow>
       <mi>i</mi>
       <mo>=</mo>
       <mn>1</mn>
      </mrow>
      <mi>n</mi>
     </munderover>
    </mstyle>
    <mrow>
     <mstyle displaystyle="true">
      <munderover>
       <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
       <mrow>
        <mi>j</mi>
        <mo>=</mo>
        <mn>1</mn>
       </mrow>
       <msub>
        <mi>n</mi>
        <mi>i</mi>
       </msub>
      </munderover>
     </mstyle>
     <msubsup>
      <mover accent="true">
       <mi>ε</mi>
       <mo>^</mo>
      </mover>
      <mrow>
       <mi>i</mi>
       <mi>j</mi>
      </mrow>
      <mn>2</mn>
     </msubsup>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mstyle displaystyle="true">
     <munderover>
      <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
      <mrow>
       <mi>i</mi>
       <mo>=</mo>
       <mn>1</mn>
      </mrow>
      <mi>n</mi>
     </munderover>
    </mstyle>
    <mrow>
     <mstyle displaystyle="true">
      <munderover>
       <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
       <mrow>
        <mi>j</mi>
        <mo>=</mo>
        <mn>1</mn>
       </mrow>
       <msub>
        <mi>n</mi>
        <mi>i</mi>
       </msub>
      </munderover>
     </mstyle>
     <msup>
      <mrow>
       <mo>(</mo>
       <mrow>
        <msub>
         <mi>Y</mi>
         <mrow>
          <mi>i</mi>
          <mi>j</mi>
         </mrow>
        </msub>
        <mo>-</mo>
        <msub>
         <mover accent="true">
          <mi>Y</mi>
          <mo>^</mo>
         </mover>
         <mi>i</mi>
        </msub>
       </mrow>
       <mo>)</mo>
      </mrow>
      <mn>2</mn>
     </msup>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <apply>
        <eq></eq>
        <ci>i</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <ci>n</ci>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <apply>
         <eq></eq>
         <ci>j</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>n</ci>
        <ci>i</ci>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <apply>
         <ci>normal-^</ci>
         <ci>ε</ci>
        </apply>
        <apply>
         <times></times>
         <ci>i</ci>
         <ci>j</ci>
        </apply>
       </apply>
       <cn type="float">2</cn>
      </apply>
     </apply>
    </apply>
    <apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <apply>
        <eq></eq>
        <ci>i</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <ci>n</ci>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <apply>
         <eq></eq>
         <ci>j</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>n</ci>
        <ci>i</ci>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <minus></minus>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>Y</ci>
         <apply>
          <times></times>
          <ci>i</ci>
          <ci>j</ci>
         </apply>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <apply>
          <ci>normal-^</ci>
          <ci>Y</ci>
         </apply>
         <ci>i</ci>
        </apply>
       </apply>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle\sum_{i=1}^{n}\sum_{j=1}^{n_{i}}\widehat{\varepsilon}_{ij}^{\,2}=%
\sum_{i=1}^{n}\sum_{j=1}^{n_{i}}\left(Y_{ij}-\widehat{Y}_{i}\right)^{2}
  </annotation>
 </semantics>
</math>


</p>
<h2 id="probability-distributions">Probability distributions</h2>
<h3 id="sums-of-squares">Sums of squares</h3>

<p>Suppose the <a href="errors_and_residuals_in_statistics" title="wikilink">error terms</a> <em>ε</em><sub> <em>i j</em></sub> are <a href="statistical_independence" title="wikilink">independent</a> and <a href="normal_distribution" title="wikilink">normally distributed</a> with <a href="expected_value" title="wikilink">expected value</a> 0 and <a class="uri" href="variance" title="wikilink">variance</a> <em>σ</em><sup>2</sup>. We treat <em>x</em><sub> <em>i</em></sub> as constant rather than random. Then the response variables <em>Y</em><sub> <em>i j</em></sub> are random only because the errors <em>ε</em><sub> <em>i j</em></sub> are random.</p>

<p>It can be shown to follow that if the straight-line model is correct, then the <strong>sum of squares due to error</strong> divided by the error variance,</p>

<p>

<math display="block" id="Lack-of-fit_sum_of_squares:11">
 <semantics>
  <mrow>
   <mfrac>
    <mn>1</mn>
    <msup>
     <mi>σ</mi>
     <mn>2</mn>
    </msup>
   </mfrac>
   <mrow>
    <munderover>
     <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
     <mrow>
      <mi>i</mi>
      <mo>=</mo>
      <mn>1</mn>
     </mrow>
     <mi>n</mi>
    </munderover>
    <mrow>
     <munderover>
      <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
      <mrow>
       <mi>j</mi>
       <mo>=</mo>
       <mn>1</mn>
      </mrow>
      <msub>
       <mi>n</mi>
       <mi>i</mi>
      </msub>
     </munderover>
     <msubsup>
      <mover accent="true">
       <mi>ε</mi>
       <mo>^</mo>
      </mover>
      <mrow>
       <mi>i</mi>
       <mi>j</mi>
      </mrow>
      <mn>2</mn>
     </msubsup>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <divide></divide>
     <cn type="integer">1</cn>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>σ</ci>
      <cn type="integer">2</cn>
     </apply>
    </apply>
    <apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <apply>
        <eq></eq>
        <ci>i</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <ci>n</ci>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <apply>
         <eq></eq>
         <ci>j</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>n</ci>
        <ci>i</ci>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <apply>
         <ci>normal-^</ci>
         <ci>ε</ci>
        </apply>
        <apply>
         <times></times>
         <ci>i</ci>
         <ci>j</ci>
        </apply>
       </apply>
       <cn type="float">2</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \frac{1}{\sigma^{2}}\sum_{i=1}^{n}\sum_{j=1}^{n_{i}}\widehat{\varepsilon}_{ij}%
^{\,2}
  </annotation>
 </semantics>
</math>

</p>

<p>has a <a href="chi-squared_distribution" title="wikilink">chi-squared distribution</a> with <em>N</em> − 2 degrees of freedom.</p>

<p>Moreover, given the total number of observations <em>N</em>, the number of levels of the independent variable <em>n,</em> and the number of parameters in the model <em>p</em>:</p>
<ul>
<li>The sum of squares due to pure error, divided by the error variance <em>σ</em><sup>2</sup>, has a chi-squared distribution with <em>N</em> − <em>n</em> degrees of freedom;</li>
<li>The sum of squares due to lack of fit, divided by the error variance <em>σ</em><sup>2</sup>, has a chi-squared distribution with <em>n</em> − <em>p</em> degrees of freedom (here <em>p</em> = 2 as there are two parameters in the straight-line model);</li>
<li>The two sums of squares are probabilistically independent.</li>
</ul>
<h3 id="the-test-statistic">The test statistic</h3>

<p>It then follows that the statistic</p>

<p>

<math display="inline" id="Lack-of-fit_sum_of_squares:12">
 <semantics>
  <mi>F</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>F</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle F
  </annotation>
 </semantics>
</math>


</p>

<p>has an <a class="uri" href="F-distribution" title="wikilink">F-distribution</a> with the corresponding number of degrees of freedom in the numerator and the denominator, provided that the model is correct. If the model is wrong, then the probability distribution of the denominator is still as stated above, and the numerator and denominator are still independent. But the numerator then has a <a href="noncentral_chi-squared_distribution" title="wikilink">noncentral chi-squared distribution</a>, and consequently the quotient as a whole has a <a href="non-central_F-distribution" title="wikilink">non-central F-distribution</a>.</p>

<p>One uses this F-statistic to test the <a href="null_hypothesis" title="wikilink">null hypothesis</a> that there is no lack of linear fit. Since the non-central F-distribution is <a href="stochastic_order" title="wikilink">stochastically larger</a> than the (central) F-distribution, one rejects the null hypothesis if the F-statistic is larger than the critical F value. The critical value corresponds to the <a href="cumulative_distribution_function" title="wikilink">cumulative distribution function</a> of the <a href="F_distribution" title="wikilink">F distribution</a> with <em>x</em> equal to the desired <a href="confidence_level" title="wikilink">confidence level</a>, and degrees of freedom <em>d</em><sub>1</sub> = (<em>n</em> − <em>p</em>) and <em>d</em><sub>2</sub> = (<em>N</em> − <em>n</em>). This critical value can be calculated using online tools<a class="footnoteRef" href="#fn3" id="fnref3"><sup>3</sup></a> or found in tables of statistical values.<a class="footnoteRef" href="#fn4" id="fnref4"><sup>4</sup></a></p>

<p>The assumptions of <a href="normal_distribution" title="wikilink">normal distribution</a> of errors and <a href="independence_(probability_theory)" title="wikilink">independence</a> can be shown to entail that this <a href="lack-of-fit_test" title="wikilink">lack-of-fit test</a> is the <a href="likelihood-ratio_test" title="wikilink">likelihood-ratio test</a> of this null hypothesis.</p>
<h2 id="see-also">See also</h2>
<ul>
<li><a href="Linear_regression" title="wikilink">Linear regression</a></li>
</ul>
<h2 id="notes">Notes</h2>

<p>"</p>

<p><a href="Category:Analysis_of_variance" title="wikilink">Category:Analysis of variance</a> <a href="Category:Regression_analysis" title="wikilink">Category:Regression analysis</a> <a href="Category:Design_of_experiments" title="wikilink">Category:Design of experiments</a> <a href="Category:Least_squares" title="wikilink">Category:Least squares</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1"><a href="#fnref1">↩</a></li>
<li id="fn2"><a href="#fnref2">↩</a></li>
<li id="fn3"><a href="#fnref3">↩</a></li>
<li id="fn4"><a href="#fnref4">↩</a></li>
</ol>
</section>
</body>
</html>

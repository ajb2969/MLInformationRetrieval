<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="1046">Transportation theory (mathematics)</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Transportation theory (mathematics)</h1>
<hr/>

<p>In <a class="uri" href="mathematics" title="wikilink">mathematics</a> and economics, <strong>transportation theory</strong> is a name given to the study of optimal <a href="Transport" title="wikilink">transportation</a> and <a href="allocation_of_resources" title="wikilink">allocation of resources</a>.</p>

<p>The problem was formalized by the French <a class="uri" href="mathematician" title="wikilink">mathematician</a> <a href="Gaspard_Monge" title="wikilink">Gaspard Monge</a> in 1781.<a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a></p>

<p>In the 1920s A.N. Tolstoi was one of the first to study the transportation problem mathematically. In 1930, in the collection <em>Transportation Planning Volume I</em> for the National Commissariat of Transportation of the Soviet Union, he published a paper "Methods of Finding the Minimal Kilometrage in Cargo-transportation in space".<a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a><a class="footnoteRef" href="#fn3" id="fnref3"><sup>3</sup></a></p>

<p>Major advances were made in the field during World War II by the <a href="Soviet_Union" title="wikilink">Soviet</a>/<a href="Russia" title="wikilink">Russian</a> <a class="uri" href="mathematician" title="wikilink">mathematician</a> and economist <a href="Leonid_Kantorovich" title="wikilink">Leonid Kantorovich</a>.<a class="footnoteRef" href="#fn4" id="fnref4"><sup>4</sup></a> Consequently, the problem as it is stated is sometimes known as the <strong>Monge–Kantorovich transportation problem</strong>.<a class="footnoteRef" href="#fn5" id="fnref5"><sup>5</sup></a> The <a href="linear_programming" title="wikilink">linear programming</a> formulation of the transportation problem is also known as the <strong><a href="Frank_Lauren_Hitchcock" title="wikilink">Hitchcock</a>–<a href="Tjalling_Koopmans" title="wikilink">Koopmans</a> transportation problem</strong>.<a class="footnoteRef" href="#fn6" id="fnref6"><sup>6</sup></a></p>
<h2 id="motivation">Motivation</h2>
<h3 id="mines-and-factories">Mines and factories</h3>

<p>Suppose that we have a collection of <em>n</em> mines mining iron ore, and a collection of <em>n</em> factories which consume the iron ore that the mines produce. Suppose for the sake of argument that these mines and factories form two <a href="Disjoint_sets" title="wikilink">disjoint</a> <a href="subset" title="wikilink">subsets</a> <em>M</em> and <em>F</em> of the <a href="Euclidean_plane" title="wikilink">Euclidean plane</a> <strong>R</strong><sup>2</sup>. Suppose also that we have a <em>cost function</em> <em>c</em> : <strong>R</strong><sup>2</sup> × <strong>R</strong><sup>2</sup> → [0, ∞), so that <em>c</em>(<em>x</em>, <em>y</em>) is the cost of transporting one shipment of iron from <em>x</em> to <em>y</em>. For simplicity, we ignore the time taken to do the transporting. We also assume that each mine can supply only one factory (no splitting of shipments) and that each factory requires precisely one shipment to be in operation (factories cannot work at half- or double-capacity). Having made the above assumptions, a <em>transport plan</em> is a <a class="uri" href="bijection" title="wikilink">bijection</a> <em>T</em> : <em>M</em> → <em>F</em>. In other words, each mine <em>m</em> ∈ <em>M</em> supplies precisely one factory <em>T</em>(<em>m</em>) ∈ <em>F</em> and each factory is supplied by precisely one mine. We wish to find the <em>optimal transport plan</em>, the plan <em>T</em> whose <em>total cost</em></p>

<p>

<math display="block" id="Transportation_theory_(mathematics):0">
 <semantics>
  <mrow>
   <mrow>
    <mi>c</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>T</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>:=</mo>
   <mrow>
    <munder>
     <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
     <mrow>
      <mi>m</mi>
      <mo>∈</mo>
      <mi>M</mi>
     </mrow>
    </munder>
    <mrow>
     <mi>c</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>m</mi>
      <mo>,</mo>
      <mrow>
       <mi>T</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>m</mi>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">assign</csymbol>
    <apply>
     <times></times>
     <ci>c</ci>
     <ci>T</ci>
    </apply>
    <apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <sum></sum>
      <apply>
       <in></in>
       <ci>m</ci>
       <ci>M</ci>
      </apply>
     </apply>
     <apply>
      <times></times>
      <ci>c</ci>
      <interval closure="open">
       <ci>m</ci>
       <apply>
        <times></times>
        <ci>T</ci>
        <ci>m</ci>
       </apply>
      </interval>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   c(T):=\sum_{m\in M}c(m,T(m))
  </annotation>
 </semantics>
</math>

</p>

<p>is the least of all possible transport plans from <em>M</em> to <em>F</em>. This motivating special case of the transportation problem is an instance of the <a href="assignment_problem" title="wikilink">assignment problem</a>. More specifically, it is equivalent to finding a minimum weight matching in a bipartite graph.</p>
<h3 id="moving-books-the-importance-of-the-cost-function">Moving books: the importance of the cost function</h3>

<p>The following simple example illustrates the importance of the <a href="Cost_curve" title="wikilink">cost function</a> in determining the optimal transport plan. Suppose that we have <em>n</em> books of equal width on a shelf (the <a href="real_line" title="wikilink">real line</a>), arranged in a single contiguous block. We wish to rearrange them into another contiguous block, but shifted one book-width to the right. Two obvious candidates for the optimal transport plan present themselves:</p>
<ol>
<li>move all <em>n</em> books one book-width to the right; ("many small moves")</li>
<li>move the left-most book <em>n</em> book-widths to the right and leave all other books fixed. ("one big move")</li>
</ol>

<p>If the cost function is proportional to Euclidean distance (<em>c</em>(<em>x</em>, <em>y</em>) = α|<em>x</em> − <em>y</em>|) then these two candidates are <em>both</em> optimal. If, on the other hand, we choose the <a href="Convex_function" title="wikilink">strictly convex</a> cost function proportional to the square of Euclidean distance (<em>c</em>(<em>x</em>, <em>y</em>) = α|<em>x</em> − <em>y</em>|<sup>2</sup>), then the "many small moves" option becomes the unique minimizer.</p>

<p>Interestingly, while mathematicians prefer to work with convex cost functions, economists prefer <a href="concave_function" title="wikilink">concave</a> ones. The intuitive justification for this is that once goods have been loaded on to, say, a goods train, transporting the goods 200 kilometres costs much less than twice what it would cost to transport them 100 kilometres. Concave cost functions represent this <a href="economy_of_scale" title="wikilink">economy of scale</a>.</p>
<h2 id="abstract-formulation-of-the-problem">Abstract formulation of the problem</h2>
<h3 id="monge-and-kantorovich-formulations">Monge and Kantorovich formulations</h3>

<p>The transportation problem as it is stated in modern or more technical literature looks somewhat different because of the development of <a href="Riemannian_geometry" title="wikilink">Riemannian geometry</a> and <a href="measure_theory" title="wikilink">measure theory</a>. The mines-factories example, simple as it is, is a useful reference point when thinking of the abstract case. In this setting, we allow the possibility that we may not wish to keep all mines and factories open for business, and allow mines to supply more than one factory, and factories to accept iron from more than one mine.</p>

<p>Let <em>X</em> and <em>Y</em> be two <a href="separable_space" title="wikilink">separable</a> <a href="metric_space" title="wikilink">metric spaces</a> such that any <a href="probability_measure" title="wikilink">probability measure</a> on <em>X</em> (or <em>Y</em>) is a <a href="Radon_measure" title="wikilink">Radon measure</a> (i.e. they are <a href="Radon_space" title="wikilink">Radon spaces</a>). Let <em>c</em> : <em>X</em> × <em>Y</em> → [0, ∞] be a Borel-<a href="measurable_function" title="wikilink">measurable function</a>. Given probability measures μ on <em>X</em> and ν on <em>Y</em>, Monge's formulation of the optimal transportation problem is to find a transport map <em>T</em> : <em>X</em> → <em>Y</em> that realizes the <a class="uri" href="infimum" title="wikilink">infimum</a></p>

<p>

<math display="block" id="Transportation_theory_(mathematics):1">
 <semantics>
  <mrow>
   <mrow>
    <mo movablelimits="false">inf</mo>
    <mrow>
     <mo>{</mo>
     <mrow>
      <msub>
       <mo largeop="true" symmetric="true">∫</mo>
       <mi>X</mi>
      </msub>
      <mrow>
       <mi>c</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>x</mi>
        <mo>,</mo>
        <mrow>
         <mi>T</mi>
         <mrow>
          <mo stretchy="false">(</mo>
          <mi>x</mi>
          <mo stretchy="false">)</mo>
         </mrow>
        </mrow>
        <mo rspace="4.2pt" stretchy="false">)</mo>
       </mrow>
       <mi mathvariant="normal">d</mi>
       <mi>μ</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>x</mi>
        <mo rspace="5.3pt" stretchy="false">)</mo>
       </mrow>
      </mrow>
     </mrow>
     <mo rspace="5.3pt">|</mo>
     <mrow>
      <mrow>
       <mi>T</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>μ</mi>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
      <mo>=</mo>
      <mi>ν</mi>
     </mrow>
     <mo>}</mo>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">infimum</csymbol>
    <apply>
     <csymbol cd="latexml">conditional-set</csymbol>
     <apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <int></int>
       <ci>X</ci>
      </apply>
      <apply>
       <times></times>
       <ci>c</ci>
       <interval closure="open">
        <ci>x</ci>
        <apply>
         <times></times>
         <ci>T</ci>
         <ci>x</ci>
        </apply>
       </interval>
       <ci>normal-d</ci>
       <ci>μ</ci>
       <ci>x</ci>
      </apply>
     </apply>
     <apply>
      <eq></eq>
      <apply>
       <times></times>
       <ci>T</ci>
       <ci>μ</ci>
      </apply>
      <ci>ν</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \inf\left\{\left.\int_{X}c(x,T(x))\,\mathrm{d}\mu(x)\;\right|\;T(\mu)=\nu%
\right\},
  </annotation>
 </semantics>
</math>

</p>

<p>where <em>T</em></p>

<p>(μ) denotes the <a href="pushforward_measure" title="wikilink">push forward</a> of μ by <em>T</em>. A map <em>T</em> that attains this infimum (<em>i.e.</em> makes it a <a class="uri" href="minimum" title="wikilink">minimum</a> instead of an infimum) is called an "optimal transport map".</p>

<p>Monge's formulation of the optimal transportation problem can be ill-posed, because sometimes there is no <em>T</em> satisfying <em>T</em><sub>∗</sub>(μ) = ν: this happens, for example, when μ is a <a href="Dirac_measure" title="wikilink">Dirac measure</a> but ν is not).</p>

<p>We can improve on this by adopting Kantorovich's formulation of the optimal transportation problem, which is to find a probability measure γ on <em>X</em> × <em>Y</em> that attains the infimum</p>

<p>

<math display="block" id="Transportation_theory_(mathematics):2">
 <semantics>
  <mrow>
   <mrow>
    <mo movablelimits="false">inf</mo>
    <mrow>
     <mo>{</mo>
     <mrow>
      <msub>
       <mo largeop="true" symmetric="true">∫</mo>
       <mrow>
        <mi>X</mi>
        <mo>×</mo>
        <mi>Y</mi>
       </mrow>
      </msub>
      <mrow>
       <mi>c</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>x</mi>
        <mo>,</mo>
        <mi>y</mi>
        <mo rspace="4.2pt" stretchy="false">)</mo>
       </mrow>
       <mi mathvariant="normal">d</mi>
       <mi>γ</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>x</mi>
        <mo>,</mo>
        <mi>y</mi>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
     </mrow>
     <mo>|</mo>
     <mrow>
      <mi>γ</mi>
      <mo>∈</mo>
      <mrow>
       <mi mathvariant="normal">Γ</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>μ</mi>
        <mo>,</mo>
        <mi>ν</mi>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
     </mrow>
     <mo>}</mo>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">infimum</csymbol>
    <apply>
     <csymbol cd="latexml">conditional-set</csymbol>
     <apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <int></int>
       <apply>
        <times></times>
        <ci>X</ci>
        <ci>Y</ci>
       </apply>
      </apply>
      <apply>
       <times></times>
       <ci>c</ci>
       <interval closure="open">
        <ci>x</ci>
        <ci>y</ci>
       </interval>
       <ci>normal-d</ci>
       <ci>γ</ci>
       <interval closure="open">
        <ci>x</ci>
        <ci>y</ci>
       </interval>
      </apply>
     </apply>
     <apply>
      <in></in>
      <ci>γ</ci>
      <apply>
       <times></times>
       <ci>normal-Γ</ci>
       <interval closure="open">
        <ci>μ</ci>
        <ci>ν</ci>
       </interval>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \inf\left\{\left.\int_{X\times Y}c(x,y)\,\mathrm{d}\gamma(x,y)\right|\gamma\in%
\Gamma(\mu,\nu)\right\},
  </annotation>
 </semantics>
</math>

</p>

<p>where Γ(μ, ν) denotes the collection of all probability measures on <em>X</em> × <em>Y</em> with <a href="Conditional_probability" title="wikilink">marginals</a> μ on <em>X</em> and ν on <em>Y</em>. It can be shown<a class="footnoteRef" href="#fn7" id="fnref7"><sup>7</sup></a> that a minimizer for this problem always exists when the cost function <em>X</em> is lower semi-continuous and Γ(μ, ν) is a <a href="Tightness_of_measures" title="wikilink">tight</a> collection of measures (which is guaranteed for Radon spaces <em>X</em> and <em>Y</em>). (Compare this formulation with the definition of the <a href="Wasserstein_metric" title="wikilink">Wasserstein metric</a> <em>W</em><sub>1</sub> on the space of probability measures.) A gradient descent formulation for the solution of the Monge-Kantorovich problem was given by Sigurd Angenent, Steven Haker, and <a href="Allen_Tannenbaum" title="wikilink">Allen Tannenbaum</a>.<a class="footnoteRef" href="#fn8" id="fnref8"><sup>8</sup></a></p>
<h3 id="duality-formula">Duality formula</h3>

<p>The minimum of the Kantorovich problem is equal to</p>

<p>

<math display="block" id="Transportation_theory_(mathematics):3">
 <semantics>
  <mrow>
   <mrow>
    <mo movablelimits="false">sup</mo>
    <mrow>
     <mo>(</mo>
     <mrow>
      <mrow>
       <msub>
        <mo largeop="true" symmetric="true">∫</mo>
        <mi>X</mi>
       </msub>
       <mrow>
        <mi>φ</mi>
        <mrow>
         <mo stretchy="false">(</mo>
         <mi>x</mi>
         <mo rspace="4.2pt" stretchy="false">)</mo>
        </mrow>
        <mi mathvariant="normal">d</mi>
        <mi>μ</mi>
        <mrow>
         <mo stretchy="false">(</mo>
         <mi>x</mi>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
      </mrow>
      <mo>+</mo>
      <mrow>
       <msub>
        <mo largeop="true" symmetric="true">∫</mo>
        <mi>Y</mi>
       </msub>
       <mrow>
        <mi>ψ</mi>
        <mrow>
         <mo stretchy="false">(</mo>
         <mi>y</mi>
         <mo rspace="4.2pt" stretchy="false">)</mo>
        </mrow>
        <mi mathvariant="normal">d</mi>
        <mi>ν</mi>
        <mrow>
         <mo stretchy="false">(</mo>
         <mi>y</mi>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
      </mrow>
     </mrow>
     <mo>)</mo>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">supremum</csymbol>
    <apply>
     <plus></plus>
     <apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <int></int>
       <ci>X</ci>
      </apply>
      <apply>
       <times></times>
       <ci>φ</ci>
       <ci>x</ci>
       <ci>normal-d</ci>
       <ci>μ</ci>
       <ci>x</ci>
      </apply>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <int></int>
       <ci>Y</ci>
      </apply>
      <apply>
       <times></times>
       <ci>ψ</ci>
       <ci>y</ci>
       <ci>normal-d</ci>
       <ci>ν</ci>
       <ci>y</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \sup\left(\int_{X}\varphi(x)\,\mathrm{d}\mu(x)+\int_{Y}\psi(y)\,\mathrm{d}\nu(%
y)\right),
  </annotation>
 </semantics>
</math>

</p>

<p>where the <a class="uri" href="supremum" title="wikilink">supremum</a> runs over all pairs of <a href="bounded_function" title="wikilink">bounded</a> and <a href="continuous_function" title="wikilink">continuous functions</a> φ : <em>X</em> → <strong>R</strong> and ψ : <em>Y</em> → <strong>R</strong> such that</p>

<p>

<math display="block" id="Transportation_theory_(mathematics):4">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mrow>
      <mi>φ</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>x</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo>+</mo>
     <mrow>
      <mi>ψ</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>y</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mrow>
    <mo>≤</mo>
    <mrow>
     <mi>c</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>x</mi>
      <mo>,</mo>
      <mi>y</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <leq></leq>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <ci>φ</ci>
      <ci>x</ci>
     </apply>
     <apply>
      <times></times>
      <ci>ψ</ci>
      <ci>y</ci>
     </apply>
    </apply>
    <apply>
     <times></times>
     <ci>c</ci>
     <interval closure="open">
      <ci>x</ci>
      <ci>y</ci>
     </interval>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \varphi(x)+\psi(y)\leq c(x,y).
  </annotation>
 </semantics>
</math>

</p>
<h2 id="solution-of-the-problem">Solution of the problem</h2>
<h3 id="optimal-transportation-on-the-real-line">Optimal transportation on the real line</h3>

<p>For 1 ≤ <em>p</em> \mathcal{P}_p(\mathbf{R}) denote the collection of <a href="probability_measure" title="wikilink">probability measures</a> on <strong>R</strong> that have finite <em>p</em>th <a href="moment_(mathematics)" title="wikilink">moment</a>. Let 

<math display="inline" id="Transportation_theory_(mathematics):5">
 <semantics>
  <mrow>
   <mrow>
    <mi>μ</mi>
    <mo>,</mo>
    <mi>ν</mi>
   </mrow>
   <mo>∈</mo>
   <mrow>
    <msub>
     <mi class="ltx_font_mathcaligraphic">𝒫</mi>
     <mi>p</mi>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>𝐑</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <in></in>
    <list>
     <ci>μ</ci>
     <ci>ν</ci>
    </list>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>𝒫</ci>
      <ci>p</ci>
     </apply>
     <ci>𝐑</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mu,\nu\in\mathcal{P}_{p}(\mathbf{R})
  </annotation>
 </semantics>
</math>

 and let <em>c</em>(<em>x</em>, <em>y</em>) = <em>h</em>(<em>x</em>−<em>y</em>), where <em>h</em> : <strong>R</strong> → [0, ∞) is a <a href="convex_function" title="wikilink">convex function</a>.</p>
<ol>
<li>If μ has no <a href="atom_(measure_theory)" title="wikilink">atom</a>, i.e., if the <a href="cumulative_distribution_function" title="wikilink">cumulative distribution function</a> <em>F</em><sub>μ</sub> : <strong>R</strong> → [0, 1] of μ is a <a href="continuous_function" title="wikilink">continuous function</a>, then 

<math display="inline" id="Transportation_theory_(mathematics):6">
 <semantics>
  <mrow>
   <mrow>
    <msubsup>
     <mi>F</mi>
     <mi>ν</mi>
     <mrow>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </msubsup>
    <mo>∘</mo>
    <msub>
     <mi>F</mi>
     <mi>μ</mi>
    </msub>
   </mrow>
   <mo>:</mo>
   <mrow>
    <mi>𝐑</mi>
    <mo>→</mo>
    <mi>𝐑</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-:</ci>
    <apply>
     <compose></compose>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>F</ci>
       <ci>ν</ci>
      </apply>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>F</ci>
      <ci>μ</ci>
     </apply>
    </apply>
    <apply>
     <ci>normal-→</ci>
     <ci>𝐑</ci>
     <ci>𝐑</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   F_{\nu}^{-1}\circ F_{\mu}:\mathbf{R}\to\mathbf{R}
  </annotation>
 </semantics>
</math>

 is an optimal transport map. It is the unique optimal transport map if <em>h</em> is strictly convex.</li>
<li>We have</li>
</ol>
<dl>
<dd><dl>
<dd>

<math display="inline" id="Transportation_theory_(mathematics):7">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <msub>
      <mi>min</mi>
      <mrow>
       <mi>γ</mi>
       <mo>∈</mo>
       <mrow>
        <mi mathvariant="normal">Γ</mi>
        <mrow>
         <mo stretchy="false">(</mo>
         <mi>μ</mi>
         <mo>,</mo>
         <mi>ν</mi>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
      </mrow>
     </msub>
     <mrow>
      <msub>
       <mo largeop="true" symmetric="true">∫</mo>
       <msup>
        <mi>𝐑</mi>
        <mn>2</mn>
       </msup>
      </msub>
      <mrow>
       <mi>c</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>x</mi>
        <mo>,</mo>
        <mi>y</mi>
        <mo rspace="4.2pt" stretchy="false">)</mo>
       </mrow>
       <mi mathvariant="normal">d</mi>
       <mi>γ</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>x</mi>
        <mo>,</mo>
        <mi>y</mi>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <msubsup>
      <mo largeop="true" symmetric="true">∫</mo>
      <mn>0</mn>
      <mn>1</mn>
     </msubsup>
     <mrow>
      <mi>c</mi>
      <mrow>
       <mo>(</mo>
       <mrow>
        <msubsup>
         <mi>F</mi>
         <mi>μ</mi>
         <mrow>
          <mo>-</mo>
          <mn>1</mn>
         </mrow>
        </msubsup>
        <mrow>
         <mo stretchy="false">(</mo>
         <mi>s</mi>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
       <mo>,</mo>
       <mrow>
        <msubsup>
         <mi>F</mi>
         <mi>ν</mi>
         <mrow>
          <mo>-</mo>
          <mn>1</mn>
         </mrow>
        </msubsup>
        <mrow>
         <mo stretchy="false">(</mo>
         <mi>s</mi>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
       <mo rspace="4.2pt">)</mo>
      </mrow>
      <mi mathvariant="normal">d</mi>
      <mi>s</mi>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <min></min>
      <apply>
       <in></in>
       <ci>γ</ci>
       <apply>
        <times></times>
        <ci>normal-Γ</ci>
        <interval closure="open">
         <ci>μ</ci>
         <ci>ν</ci>
        </interval>
       </apply>
      </apply>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <int></int>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>𝐑</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
      <apply>
       <times></times>
       <ci>c</ci>
       <interval closure="open">
        <ci>x</ci>
        <ci>y</ci>
       </interval>
       <ci>normal-d</ci>
       <ci>γ</ci>
       <interval closure="open">
        <ci>x</ci>
        <ci>y</ci>
       </interval>
      </apply>
     </apply>
    </apply>
    <apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <int></int>
       <cn type="integer">0</cn>
      </apply>
      <cn type="integer">1</cn>
     </apply>
     <apply>
      <times></times>
      <ci>c</ci>
      <interval closure="open">
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>F</ci>
          <ci>μ</ci>
         </apply>
         <apply>
          <minus></minus>
          <cn type="integer">1</cn>
         </apply>
        </apply>
        <ci>s</ci>
       </apply>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>F</ci>
          <ci>ν</ci>
         </apply>
         <apply>
          <minus></minus>
          <cn type="integer">1</cn>
         </apply>
        </apply>
        <ci>s</ci>
       </apply>
      </interval>
      <ci>normal-d</ci>
      <ci>s</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \min_{\gamma\in\Gamma(\mu,\nu)}\int_{\mathbf{R}^{2}}c(x,y)\,\mathrm{d}\gamma(x%
,y)=\int_{0}^{1}c\left(F_{\mu}^{-1}(s),F_{\nu}^{-1}(s)\right)\,\mathrm{d}s.
  </annotation>
 </semantics>
</math>


</dd>
</dl>
</dd>
</dl>

<p>The proof of this solution appears in.<a class="footnoteRef" href="#fn9" id="fnref9"><sup>9</sup></a></p>
<h3 id="separable-hilbert-spaces">Separable Hilbert spaces</h3>

<p>Let <em>X</em> be a <a href="separable_space" title="wikilink">separable</a> <a href="Hilbert_space" title="wikilink">Hilbert space</a>. Let 

<math display="inline" id="Transportation_theory_(mathematics):8">
 <semantics>
  <mrow>
   <msub>
    <mi class="ltx_font_mathcaligraphic">𝒫</mi>
    <mi>p</mi>
   </msub>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>X</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>𝒫</ci>
     <ci>p</ci>
    </apply>
    <ci>X</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathcal{P}_{p}(X)
  </annotation>
 </semantics>
</math>

 denote the collection of probability measures on <em>X</em> such that have finite <em>p</em>th moment; let 

<math display="inline" id="Transportation_theory_(mathematics):9">
 <semantics>
  <mrow>
   <msubsup>
    <mi class="ltx_font_mathcaligraphic">𝒫</mi>
    <mi>p</mi>
    <mi>r</mi>
   </msubsup>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>X</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>𝒫</ci>
      <ci>p</ci>
     </apply>
     <ci>r</ci>
    </apply>
    <ci>X</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathcal{P}_{p}^{r}(X)
  </annotation>
 </semantics>
</math>

 denote those elements 

<math display="inline" id="Transportation_theory_(mathematics):10">
 <semantics>
  <mrow>
   <mi>μ</mi>
   <mo>∈</mo>
   <mrow>
    <msub>
     <mi class="ltx_font_mathcaligraphic">𝒫</mi>
     <mi>p</mi>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>X</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <in></in>
    <ci>μ</ci>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>𝒫</ci>
      <ci>p</ci>
     </apply>
     <ci>X</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mu\in\mathcal{P}_{p}(X)
  </annotation>
 </semantics>
</math>

 that are <strong>Gaussian regular</strong>: if <em>g</em> is any <a href="strictly_positive_measure" title="wikilink">strictly positive</a> <a href="Gaussian_measure" title="wikilink">Gaussian measure</a> on <em>X</em> and <em>g</em>(<em>N</em>) = 0, then μ(<em>N</em>) = 0 also.</p>

<p>Let 

<math display="inline" id="Transportation_theory_(mathematics):11">
 <semantics>
  <mrow>
   <mi>μ</mi>
   <mo>∈</mo>
   <mrow>
    <msubsup>
     <mi class="ltx_font_mathcaligraphic">𝒫</mi>
     <mi>p</mi>
     <mi>r</mi>
    </msubsup>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>X</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <in></in>
    <ci>μ</ci>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>𝒫</ci>
       <ci>p</ci>
      </apply>
      <ci>r</ci>
     </apply>
     <ci>X</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mu\in\mathcal{P}_{p}^{r}(X)
  </annotation>
 </semantics>
</math>

, 

<math display="inline" id="Transportation_theory_(mathematics):12">
 <semantics>
  <mrow>
   <mi>ν</mi>
   <mo>∈</mo>
   <mrow>
    <msub>
     <mi class="ltx_font_mathcaligraphic">𝒫</mi>
     <mi>p</mi>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>X</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <in></in>
    <ci>ν</ci>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>𝒫</ci>
      <ci>p</ci>
     </apply>
     <ci>X</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \nu\in\mathcal{P}_{p}(X)
  </annotation>
 </semantics>
</math>

, 

<math display="inline" id="Transportation_theory_(mathematics):13">
 <semantics>
  <mrow>
   <mrow>
    <mi>c</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>x</mi>
     <mo>,</mo>
     <mi>y</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <msup>
     <mrow>
      <mo stretchy="false">|</mo>
      <mrow>
       <mi>x</mi>
       <mo>-</mo>
       <mi>y</mi>
      </mrow>
      <mo stretchy="false">|</mo>
     </mrow>
     <mi>p</mi>
    </msup>
    <mo>/</mo>
    <mi>p</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>c</ci>
     <interval closure="open">
      <ci>x</ci>
      <ci>y</ci>
     </interval>
    </apply>
    <apply>
     <divide></divide>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <abs></abs>
       <apply>
        <minus></minus>
        <ci>x</ci>
        <ci>y</ci>
       </apply>
      </apply>
      <ci>p</ci>
     </apply>
     <ci>p</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   c(x,y)=|x-y|^{p}/p
  </annotation>
 </semantics>
</math>

 for <em>p</em> ∈ (1, ∞), <em>p</em><sup>−1</sup> + <em>q</em><sup>−1</sup> = 1. Then the Kantorovich problem has a unique solution κ, and this solution is induced by an optimal transport map: i.e., there exists a Borel map <em>r</em> ∈<em>L<sup>p</sup>(</em>X'', μ; <em>X</em>) such that</p>

<p>

<math display="block" id="Transportation_theory_(mathematics):14">
 <semantics>
  <mrow>
   <mrow>
    <mi>κ</mi>
    <mo>=</mo>
    <mrow>
     <msub>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <msub>
         <mi>id</mi>
         <mi>X</mi>
        </msub>
        <mo>×</mo>
        <mi>r</mi>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
      <mo>*</mo>
     </msub>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>μ</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>∈</mo>
    <mrow>
     <mi mathvariant="normal">Γ</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>μ</mi>
      <mo>,</mo>
      <mi>ν</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <ci>κ</ci>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>id</ci>
         <ci>X</ci>
        </apply>
        <ci>r</ci>
       </apply>
       <times></times>
      </apply>
      <ci>μ</ci>
     </apply>
    </apply>
    <apply>
     <in></in>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <ci>normal-Γ</ci>
      <interval closure="open">
       <ci>μ</ci>
       <ci>ν</ci>
      </interval>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \kappa=(\mathrm{id}_{X}\times r)_{*}(\mu)\in\Gamma(\mu,\nu).
  </annotation>
 </semantics>
</math>

</p>

<p>Moreover, if ν has <a href="bounded_set" title="wikilink">bounded</a> <a href="support_(measure_theory)" title="wikilink">support</a>, then</p>

<p>

<math display="block" id="Transportation_theory_(mathematics):15">
 <semantics>
  <mrow>
   <mrow>
    <mi>r</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>x</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mi>x</mi>
    <mo>-</mo>
    <mrow>
     <msup>
      <mrow>
       <mo stretchy="false">|</mo>
       <mrow>
        <mrow>
         <mo>∇</mo>
         <mi>ϕ</mi>
        </mrow>
        <mrow>
         <mo stretchy="false">(</mo>
         <mi>x</mi>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
       <mo stretchy="false">|</mo>
      </mrow>
      <mrow>
       <mi>q</mi>
       <mo>-</mo>
       <mn>2</mn>
      </mrow>
     </msup>
     <mrow>
      <mo>∇</mo>
      <mi>ϕ</mi>
     </mrow>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>x</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>r</ci>
     <ci>x</ci>
    </apply>
    <apply>
     <minus></minus>
     <ci>x</ci>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <abs></abs>
        <apply>
         <times></times>
         <apply>
          <ci>normal-∇</ci>
          <ci>ϕ</ci>
         </apply>
         <ci>x</ci>
        </apply>
       </apply>
       <apply>
        <minus></minus>
        <ci>q</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
      <apply>
       <ci>normal-∇</ci>
       <ci>ϕ</ci>
      </apply>
      <ci>x</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   r(x)=x-|\nabla\phi(x)|^{q-2}\nabla\phi(x)
  </annotation>
 </semantics>
</math>

</p>

<p>for μ-almost all <em>x</em> ∈ <em>X</em> for some <a href="Lipschitz_continuous" title="wikilink">locally Lipschitz</a>, <em>c</em>-concave and maximal Kantorovich potential φ. (Here ∇φ denotes the <a href="Gâteaux_derivative" title="wikilink">Gâteaux derivative</a> of φ.)</p>
<h2 id="see-also">See also</h2>
<ul>
<li><a href="Wasserstein_metric" title="wikilink">Wasserstein metric</a></li>
<li><a href="Transport_function" title="wikilink">Transport function</a></li>
<li><a href="Hungarian_algorithm" title="wikilink">Hungarian algorithm</a></li>
<li><a href="Transportation_planning" title="wikilink">Transportation planning</a></li>
</ul>
<h2 id="references">References</h2>
<h2 id="further-reading">Further reading</h2>
<ul>
<li></li>
</ul>

<p>"</p>

<p><a href="Category:Calculus_of_variations" title="wikilink">Category:Calculus of variations</a> <a class="uri" href="Category:Matching" title="wikilink">Category:Matching</a> <a href="Category:Mathematical_economics" title="wikilink">Category:Mathematical economics</a> <a href="Category:Measure_theory" title="wikilink">Category:Measure theory</a> <a href="Category:Transport_economics" title="wikilink">Category:Transport economics</a> <a href="Category:Optimization_in_vector_spaces" title="wikilink">Category:Optimization in vector spaces</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1">G. Monge. <em>Mémoire sur la théorie des déblais et des remblais. Histoire de l’Académie Royale des Sciences de Paris, avec les Mémoires de Mathématique et de Physique pour la même année</em>, pages 666–704, 1781.<a href="#fnref1">↩</a></li>
<li id="fn2"><a href="Alexander_Schrijver" title="wikilink">Schrijver, Alexander</a>, [<a class="uri" href="http://books.google.com/books?id=mqGeSQ6dJycC&amp;printsec">http://books.google.com/books?id=mqGeSQ6dJycC&amp;printsec;</a>;=frontcover <em>Combinatorial Optimization</em>], Berlin ; New York : Springer, 2003. ISBN 3540443894. Cf. [<a class="uri" href="http://books.google.com/books?id=mqGeSQ6dJycC&amp;pg">http://books.google.com/books?id=mqGeSQ6dJycC&amp;pg;</a>;=PA362&amp;lpg;=PA362&amp;dq;=a.n.+tolstoi+transportation+networks&amp;source;=bl&amp;ots;=xONQNWerQa&amp;sig;=LJl_9KbyS1FDp_wYuXNJ9ruEKes&amp;hl;=en&amp;ei;=bMujTLP6O4OClAfjoomQCw&amp;sa;=X&amp;oi;=book_result&amp;ct;=result&amp;resnum;=1&amp;ved;=0CBsQ6AEwAA#v=onepage&amp;q;=a.n.%20tolstoi%20transportation%20networks&amp;f;=false p.362]<a href="#fnref2">↩</a></li>
<li id="fn3">Ivor Grattan-Guinness, Ivor, [<a class="uri" href="http://books.google.com/books?id=2hDvzITtfdAC&amp;printsec">http://books.google.com/books?id=2hDvzITtfdAC&amp;printsec;</a>;=frontcover <em>Companion encyclopedia of the history and philosophy of the mathematical sciences</em>], Volume 1, JHU Press, 2003. Cf. [<a class="uri" href="http://books.google.com/books?id=2hDvzITtfdAC&amp;pg">http://books.google.com/books?id=2hDvzITtfdAC&amp;pg;</a>;=PA831&amp;lpg;=PA831&amp;dq;=%22a.n.+tolstoy%22+mathematics&amp;source;=bl&amp;ots;=pCwrnZWBwI&amp;sig;=QQz_1ng7mR6dmZWCmZ4L1Twar3U&amp;hl;=en&amp;ei;=w8SjTJeUDoT7lwe3nYT8Cw&amp;sa;=X&amp;oi;=book_result&amp;ct;=result&amp;resnum;=4&amp;ved;=0CCAQ6AEwAw#v=onepage&amp;q;=%22a.n.%20tolstoy%22%20mathematics&amp;f;=false p.831]<a href="#fnref3">↩</a></li>
<li id="fn4">L. Kantorovich. <em>On the translocation of masses.</em> C.R. (Doklady) Acad. Sci. URSS (N.S.), 37:199–201, 1942.<a href="#fnref4">↩</a></li>
<li id="fn5"><a href="#fnref5">↩</a></li>
<li id="fn6"><a href="#fnref6">↩</a></li>
<li id="fn7">L. Ambrosio, N. Gigli &amp; G. Savaré. <em>Gradient Flows in Metric Spaces and in the Space of Probability Measures.</em> Lectures in Mathematics ETH Zürich, Birkhäuser Verlag, Basel. (2005)<a href="#fnref7">↩</a></li>
<li id="fn8">S. Angenent, S. Haker, and A. Tannenbaum. <em>Minimizing flows for the Monge-Kantorovich problem.</em> SIAM J. Math. Analysis, volume 35, pp. 61-97 (2003).<a href="#fnref8">↩</a></li>
<li id="fn9">Rachev, Svetlozar T., and Ludger Rüschendorf. <em>Mass Transportation Problems: Volume I: Theory</em>. Vol. 1. Springer, 1998.<a href="#fnref9">↩</a></li>
</ol>
</section>
</body>
</html>

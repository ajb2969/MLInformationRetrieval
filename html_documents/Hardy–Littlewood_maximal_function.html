<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="889">Hardy–Littlewood maximal function</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Hardy–Littlewood maximal function</h1>
<hr/>

<p>In <a class="uri" href="mathematics" title="wikilink">mathematics</a>, the <strong>Hardy–Littlewood maximal operator</strong> <em>M</em> is a significant non-linear <a href="Operation_(mathematics)" title="wikilink">operator</a> used in <a href="real_analysis" title="wikilink">real analysis</a> and <a href="harmonic_analysis" title="wikilink">harmonic analysis</a>. It takes a <a href="locally_integrable" title="wikilink">locally integrable</a> function <em>f</em> : <strong>R</strong><sup><em>d</em></sup> → <strong>C</strong> and returns another function <em>Mf</em> that, at each point <em>x</em> ∈ <strong>R</strong><sup><em>d</em></sup>, gives the maximum <a href="average" title="wikilink">average value</a> that <em>f</em> can have on balls centered at that point. More precisely,</p>

<p>

<math display="block" id="Hardy–Littlewood_maximal_function:0">
 <semantics>
  <mrow>
   <mrow>
    <mi>M</mi>
    <mi>f</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>x</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <munder>
     <mo movablelimits="false">sup</mo>
     <mrow>
      <mi>r</mi>
      <mo>></mo>
      <mn>0</mn>
     </mrow>
    </munder>
    <mrow>
     <mfrac>
      <mn>1</mn>
      <mrow>
       <mo stretchy="false">|</mo>
       <mrow>
        <mi>B</mi>
        <mrow>
         <mo stretchy="false">(</mo>
         <mi>x</mi>
         <mo>,</mo>
         <mi>r</mi>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
       <mo stretchy="false">|</mo>
      </mrow>
     </mfrac>
     <mrow>
      <msub>
       <mo largeop="true" symmetric="true">∫</mo>
       <mrow>
        <mi>B</mi>
        <mrow>
         <mo stretchy="false">(</mo>
         <mi>x</mi>
         <mo>,</mo>
         <mi>r</mi>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
      </msub>
      <mrow>
       <mrow>
        <mo stretchy="false">|</mo>
        <mrow>
         <mi>f</mi>
         <mrow>
          <mo stretchy="false">(</mo>
          <mi>y</mi>
          <mo stretchy="false">)</mo>
         </mrow>
        </mrow>
        <mo rspace="4.2pt" stretchy="false">|</mo>
       </mrow>
       <mi>d</mi>
       <mi>y</mi>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>M</ci>
     <ci>f</ci>
     <ci>x</ci>
    </apply>
    <apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <csymbol cd="latexml">supremum</csymbol>
      <apply>
       <gt></gt>
       <ci>r</ci>
       <cn type="integer">0</cn>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <apply>
        <abs></abs>
        <apply>
         <times></times>
         <ci>B</ci>
         <interval closure="open">
          <ci>x</ci>
          <ci>r</ci>
         </interval>
        </apply>
       </apply>
      </apply>
      <apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <int></int>
        <apply>
         <times></times>
         <ci>B</ci>
         <interval closure="open">
          <ci>x</ci>
          <ci>r</ci>
         </interval>
        </apply>
       </apply>
       <apply>
        <times></times>
        <apply>
         <abs></abs>
         <apply>
          <times></times>
          <ci>f</ci>
          <ci>y</ci>
         </apply>
        </apply>
        <ci>d</ci>
        <ci>y</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Mf(x)=\sup_{r>0}\frac{1}{|B(x,r)|}\int_{B(x,r)}|f(y)|\,dy
  </annotation>
 </semantics>
</math>

</p>

<p>where <em>B</em>(<em>x</em>, <em>r</em>) is the ball of radius <em>r</em> centred at <em>x</em>, and |<em>E</em>| denotes the <a href="Lebesgue_measure" title="wikilink"><em>d</em>-dimensional Lebesgue measure</a> of <em>E</em> ⊂ <strong>R</strong><sup><em>d</em></sup>.</p>

<p>The averages are jointly <a href="Continuous_function" title="wikilink">continuous</a> in <em>x</em> and <em>r</em>, therefore the maximal function <em>Mf</em>, being the supremum over <em>r</em> &gt; 0, is <a href="Measurable_function" title="wikilink">measurable</a>. It is not obvious that <em>Mf</em> is finite almost everywhere. This is a corollary of the <strong>Hardy–Littlewood maximal inequality</strong></p>
<h2 id="hardylittlewood-maximal-inequality">Hardy–Littlewood maximal inequality</h2>

<p>This theorem of <a href="G._H._Hardy" title="wikilink">G. H. Hardy</a> and <a href="J._E._Littlewood" title="wikilink">J. E. Littlewood</a> states that <em>M</em> is <a href="bounded_operator" title="wikilink">bounded</a> as a <a href="sublinear_operator" title="wikilink">sublinear operator</a> from the <a href="Lp_space" title="wikilink"><em>L<sup>p</sup></em>(<strong>R</strong><sup><em>d</em></sup>)</a> to itself for <em>p</em> &gt; 1. That is, if <em>f</em> ∈ <em>L<sup>p</sup></em>(<strong>R</strong><sup><em>d</em></sup>) then the maximal function <em>Mf</em> is weak <em>L</em><sup>1</sup>-bounded and <em>Mf</em> ∈ <em>L<sup>p</sup></em>(<strong>R</strong><sup><em>d</em></sup>). Before stating the theorem more precisely, for simplicity, let {<em>f</em> &gt; <em>t</em>} denote the set {<em>x</em> | <em>f</em>(<em>x</em>) &gt; <em>t</em>}. Now we have:</p>
<blockquote>

<p><strong>Theorem (Weak Type Estimate).</strong> For <em>d</em> ≥ 1 and <em>f</em> ∈ <em>L</em><sup>1</sup>(<strong>R</strong><sup><em>d</em></sup>), there is a constant <em>C<sub>d</sub></em> &gt; 0 such that for all λ &gt; 0, we have:</p>

<p>

<math display="block" id="Hardy–Littlewood_maximal_function:1">
 <semantics>
  <mrow>
   <mo>|</mo>
   <mrow>
    <mo stretchy="false">{</mo>
    <mi>M</mi>
    <mi>f</mi>
    <mo>></mo>
    <mi>λ</mi>
    <mo stretchy="false">}</mo>
   </mrow>
   <mo>|</mo>
   <mo><</mo>
   <mfrac>
    <msub>
     <mi>C</mi>
     <mi>d</mi>
    </msub>
    <mi>λ</mi>
   </mfrac>
   <mo>∥</mo>
   <mi>f</mi>
   <msub>
    <mo>∥</mo>
    <mrow>
     <msup>
      <mi>L</mi>
      <mn>1</mn>
     </msup>
     <mrow>
      <mo stretchy="false">(</mo>
      <msup>
       <mi>𝐑</mi>
       <mi>d</mi>
      </msup>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </msub>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <ci>normal-|</ci>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-{</ci>
     <csymbol cd="unknown">M</csymbol>
     <csymbol cd="unknown">f</csymbol>
     <gt></gt>
     <csymbol cd="unknown">λ</csymbol>
     <ci>normal-}</ci>
    </cerror>
    <ci>normal-|</ci>
    <lt></lt>
    <apply>
     <divide></divide>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>C</ci>
      <ci>d</ci>
     </apply>
     <ci>λ</ci>
    </apply>
    <csymbol cd="latexml">parallel-to</csymbol>
    <csymbol cd="unknown">f</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <csymbol cd="latexml">parallel-to</csymbol>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>L</ci>
       <cn type="integer">1</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>𝐑</ci>
       <ci>d</ci>
      </apply>
     </apply>
    </apply>
    <ci>normal-.</ci>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \left|\{Mf>\lambda\}\right|<\frac{C_{d}}{\lambda}\|f\|_{L^{1}(\mathbf{R}^{d})}.
  </annotation>
 </semantics>
</math>

</p>
</blockquote>

<p>With the Hardy–Littlewood maximal inequality in hand, the following <em>strong-type</em> estimate is an immediate consequence of the <a href="Marcinkiewicz_theorem" title="wikilink">Marcinkiewicz interpolation theorem</a>:</p>
<blockquote>

<p><strong>Theorem (Strong Type Estimate).</strong> For <em>d</em> ≥ 1, 1 p''(<strong>R</strong><sup><em>d</em></sup>), there is a constant <em>C<sub>p,d</sub></em> &gt; 0 such that</p>

<p>

<math display="block" id="Hardy–Littlewood_maximal_function:2">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mrow>
      <mo>∥</mo>
      <mrow>
       <mi>M</mi>
       <mi>f</mi>
      </mrow>
      <mo>∥</mo>
     </mrow>
     <mrow>
      <msup>
       <mi>L</mi>
       <mi>p</mi>
      </msup>
      <mrow>
       <mo stretchy="false">(</mo>
       <msup>
        <mi>𝐑</mi>
        <mi>d</mi>
       </msup>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </msub>
    <mo>≤</mo>
    <mrow>
     <msub>
      <mi>C</mi>
      <mrow>
       <mi>p</mi>
       <mo>,</mo>
       <mi>d</mi>
      </mrow>
     </msub>
     <msub>
      <mrow>
       <mo>∥</mo>
       <mi>f</mi>
       <mo>∥</mo>
      </mrow>
      <mrow>
       <msup>
        <mi>L</mi>
        <mi>p</mi>
       </msup>
       <mrow>
        <mo stretchy="false">(</mo>
        <msup>
         <mi>𝐑</mi>
         <mi>d</mi>
        </msup>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
     </msub>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <leq></leq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <csymbol cd="latexml">norm</csymbol>
      <apply>
       <times></times>
       <ci>M</ci>
       <ci>f</ci>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>L</ci>
       <ci>p</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>𝐑</ci>
       <ci>d</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>C</ci>
      <list>
       <ci>p</ci>
       <ci>d</ci>
      </list>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <csymbol cd="latexml">norm</csymbol>
       <ci>f</ci>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>L</ci>
        <ci>p</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>𝐑</ci>
        <ci>d</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \|Mf\|_{L^{p}(\mathbf{R}^{d})}\leq C_{p,d}\|f\|_{L^{p}(\mathbf{R}^{d})}.
  </annotation>
 </semantics>
</math>

</p>
</blockquote>

<p>In the strong type estimate the best bounds for <em>C<sub>p,d</sub></em> are unknown.<a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a> However subsequently <a href="Elias_M._Stein" title="wikilink">Elias M. Stein</a> used the Calderón-Zygmund method of rotations to prove the following:</p>
<blockquote>

<p><strong>Theorem (Dimension Independence).</strong> For 1 p,d'' = <em>C<sub>p</sub></em> independent of <em>d</em>.<a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a><a class="footnoteRef" href="#fn3" id="fnref3"><sup>3</sup></a></p>
</blockquote>
<h2 id="proof">Proof</h2>

<p>While there are several proofs of this theorem, a common one is given below: For <em>p</em> = ∞, the inequality is trivial (since the average of a function is no larger than its <a href="essential_supremum" title="wikilink">essential supremum</a>). For 1 <strong>Lemma.</strong> Let <em>X</em> be a separable metric space and 

<math display="inline" id="Hardy–Littlewood_maximal_function:3">
 <semantics>
  <mi class="ltx_font_mathcaligraphic">ℱ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>ℱ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathcal{F}
  </annotation>
 </semantics>
</math>

 family of open balls with bounded diameter. Then 

<math display="inline" id="Hardy–Littlewood_maximal_function:4">
 <semantics>
  <mi class="ltx_font_mathcaligraphic">ℱ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>ℱ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathcal{F}
  </annotation>
 </semantics>
</math>

 has a countable subfamily 

<math display="inline" id="Hardy–Littlewood_maximal_function:5">
 <semantics>
  <msup>
   <mi class="ltx_font_mathcaligraphic">ℱ</mi>
   <mo>′</mo>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>ℱ</ci>
    <ci>normal-′</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathcal{F}^{\prime}
  </annotation>
 </semantics>
</math>

 consisting of disjoint balls such that</p>

<p>

<math display="block" id="Hardy–Littlewood_maximal_function:6">
 <semantics>
  <mrow>
   <mrow>
    <munder>
     <mo largeop="true" mathsize="160%" movablelimits="false" stretchy="false" symmetric="true">⋃</mo>
     <mrow>
      <mi>B</mi>
      <mo>∈</mo>
      <mi class="ltx_font_mathcaligraphic">ℱ</mi>
     </mrow>
    </munder>
    <mi>B</mi>
   </mrow>
   <mo>⊂</mo>
   <mrow>
    <munder>
     <mo largeop="true" mathsize="160%" movablelimits="false" stretchy="false" symmetric="true">⋃</mo>
     <mrow>
      <mi>B</mi>
      <mo>∈</mo>
      <msup>
       <mi class="ltx_font_mathcaligraphic">ℱ</mi>
       <mo>′</mo>
      </msup>
     </mrow>
    </munder>
    <mrow>
     <mn>5</mn>
     <mi>B</mi>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <subset></subset>
    <apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <union></union>
      <apply>
       <in></in>
       <ci>B</ci>
       <ci>ℱ</ci>
      </apply>
     </apply>
     <ci>B</ci>
    </apply>
    <apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <union></union>
      <apply>
       <in></in>
       <ci>B</ci>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>ℱ</ci>
        <ci>normal-′</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <cn type="integer">5</cn>
      <ci>B</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \bigcup_{B\in\mathcal{F}}B\subset\bigcup_{B\in\mathcal{F^{\prime}}}5B
  </annotation>
 </semantics>
</math>

 where 5<em>B</em> is <em>B</em> with 5 times radius.</p>

<p>If <em>Mf</em>(<em>x</em>) &gt; <em>t</em>, then, by definition, we can find a ball <em>B<sub>x</sub></em> centered at <em>x</em> such that</p>

<p>

<math display="block" id="Hardy–Littlewood_maximal_function:7">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <msub>
      <mo largeop="true" symmetric="true">∫</mo>
      <msub>
       <mi>B</mi>
       <mi>x</mi>
      </msub>
     </msub>
     <mrow>
      <mrow>
       <mo stretchy="false">|</mo>
       <mi>f</mi>
       <mo stretchy="false">|</mo>
      </mrow>
      <mi>d</mi>
      <mi>y</mi>
     </mrow>
    </mrow>
    <mo>></mo>
    <mrow>
     <mi>t</mi>
     <mrow>
      <mo stretchy="false">|</mo>
      <msub>
       <mi>B</mi>
       <mi>x</mi>
      </msub>
      <mo stretchy="false">|</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <gt></gt>
    <apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <int></int>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>B</ci>
       <ci>x</ci>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <abs></abs>
       <ci>f</ci>
      </apply>
      <ci>d</ci>
      <ci>y</ci>
     </apply>
    </apply>
    <apply>
     <times></times>
     <ci>t</ci>
     <apply>
      <abs></abs>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>B</ci>
       <ci>x</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \int_{B_{x}}|f|dy>t|B_{x}|.
  </annotation>
 </semantics>
</math>

 By the lemma, we can find, among such balls, a sequence of disjoint balls <em>B<sub>j</sub></em> such that the union of 5<em>B<sub>j</sub></em> covers {<em>Mf</em> &gt; <em>t</em>}. It follows:</p>

<p>

<math display="block" id="Hardy–Littlewood_maximal_function:8">
 <semantics>
  <mrow>
   <mo stretchy="false">|</mo>
   <mrow>
    <mo stretchy="false">{</mo>
    <mi>M</mi>
    <mi>f</mi>
    <mo>></mo>
    <mi>t</mi>
    <mo stretchy="false">}</mo>
   </mrow>
   <mo stretchy="false">|</mo>
   <mo>≤</mo>
   <msup>
    <mn>5</mn>
    <mi>d</mi>
   </msup>
   <munder>
    <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
    <mi>j</mi>
   </munder>
   <mo stretchy="false">|</mo>
   <msub>
    <mi>B</mi>
    <mi>j</mi>
   </msub>
   <mo stretchy="false">|</mo>
   <mo>≤</mo>
   <mfrac>
    <msup>
     <mn>5</mn>
     <mi>d</mi>
    </msup>
    <mi>t</mi>
   </mfrac>
   <mo largeop="true" symmetric="true">∫</mo>
   <mo stretchy="false">|</mo>
   <mi>f</mi>
   <mo stretchy="false">|</mo>
   <mi>d</mi>
   <mi>y</mi>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <ci>normal-|</ci>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-{</ci>
     <csymbol cd="unknown">M</csymbol>
     <csymbol cd="unknown">f</csymbol>
     <gt></gt>
     <csymbol cd="unknown">t</csymbol>
     <ci>normal-}</ci>
    </cerror>
    <ci>normal-|</ci>
    <leq></leq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <cn type="integer">5</cn>
     <ci>d</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <sum></sum>
     <ci>j</ci>
    </apply>
    <ci>normal-|</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>B</ci>
     <ci>j</ci>
    </apply>
    <ci>normal-|</ci>
    <leq></leq>
    <apply>
     <divide></divide>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <cn type="integer">5</cn>
      <ci>d</ci>
     </apply>
     <ci>t</ci>
    </apply>
    <int></int>
    <ci>normal-|</ci>
    <csymbol cd="unknown">f</csymbol>
    <ci>normal-|</ci>
    <csymbol cd="unknown">d</csymbol>
    <csymbol cd="unknown">y</csymbol>
    <ci>normal-.</ci>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   |\{Mf>t\}|\leq 5^{d}\sum_{j}|B_{j}|\leq{5^{d}\over t}\int|f|dy.
  </annotation>
 </semantics>
</math>

 This completes the proof of the weak-type estimate. We next deduce from this the <em>L<sup>p</sup></em> bounds. Define <em>b</em> by <em>b</em>(<em>x</em>) = <em>f</em>(<em>x</em>) if |<em>f</em>(<em>x</em>)| &gt; <em>t</em>/2 and 0 otherwise. By the weak-type estimate applied to <em>b</em>, we have:</p>

<p>

<math display="block" id="Hardy–Littlewood_maximal_function:9">
 <semantics>
  <mrow>
   <mo stretchy="false">|</mo>
   <mrow>
    <mo stretchy="false">{</mo>
    <mi>M</mi>
    <mi>f</mi>
    <mo>></mo>
    <mi>t</mi>
    <mo stretchy="false">}</mo>
   </mrow>
   <mo stretchy="false">|</mo>
   <mo>≤</mo>
   <mfrac>
    <mrow>
     <mn>2</mn>
     <mi>C</mi>
    </mrow>
    <mi>t</mi>
   </mfrac>
   <msub>
    <mo largeop="true" symmetric="true">∫</mo>
    <mrow>
     <mrow>
      <mo stretchy="false">|</mo>
      <mi>f</mi>
      <mo stretchy="false">|</mo>
     </mrow>
     <mo>></mo>
     <mfrac>
      <mi>t</mi>
      <mn>2</mn>
     </mfrac>
    </mrow>
   </msub>
   <mo stretchy="false">|</mo>
   <mi>f</mi>
   <mo stretchy="false">|</mo>
   <mi>d</mi>
   <mi>x</mi>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <ci>normal-|</ci>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-{</ci>
     <csymbol cd="unknown">M</csymbol>
     <csymbol cd="unknown">f</csymbol>
     <gt></gt>
     <csymbol cd="unknown">t</csymbol>
     <ci>normal-}</ci>
    </cerror>
    <ci>normal-|</ci>
    <leq></leq>
    <apply>
     <divide></divide>
     <apply>
      <times></times>
      <cn type="integer">2</cn>
      <ci>C</ci>
     </apply>
     <ci>t</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <int></int>
     <apply>
      <gt></gt>
      <apply>
       <abs></abs>
       <ci>f</ci>
      </apply>
      <apply>
       <divide></divide>
       <ci>t</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
    <ci>normal-|</ci>
    <csymbol cd="unknown">f</csymbol>
    <ci>normal-|</ci>
    <csymbol cd="unknown">d</csymbol>
    <csymbol cd="unknown">x</csymbol>
    <ci>normal-,</ci>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   |\{Mf>t\}|\leq{2C\over t}\int_{|f|>\frac{t}{2}}|f|dx,
  </annotation>
 </semantics>
</math>

 with <em>C</em> = 5<sup><em>d</em></sup>. Then</p>

<p>

<math display="block" id="Hardy–Littlewood_maximal_function:10">
 <semantics>
  <mrow>
   <mo>∥</mo>
   <mi>M</mi>
   <mi>f</mi>
   <msubsup>
    <mo>∥</mo>
    <mi>p</mi>
    <mi>p</mi>
   </msubsup>
   <mo>=</mo>
   <mo largeop="true" symmetric="true">∫</mo>
   <msubsup>
    <mo largeop="true" symmetric="true">∫</mo>
    <mn>0</mn>
    <mrow>
     <mi>M</mi>
     <mi>f</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>x</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </msubsup>
   <mi>p</mi>
   <msup>
    <mi>t</mi>
    <mrow>
     <mi>p</mi>
     <mo>-</mo>
     <mn>1</mn>
    </mrow>
   </msup>
   <mi>d</mi>
   <mi>t</mi>
   <mi>d</mi>
   <mi>x</mi>
   <mo>=</mo>
   <mi>p</mi>
   <msubsup>
    <mo largeop="true" symmetric="true">∫</mo>
    <mn>0</mn>
    <mi mathvariant="normal">∞</mi>
   </msubsup>
   <msup>
    <mi>t</mi>
    <mrow>
     <mi>p</mi>
     <mo>-</mo>
     <mn>1</mn>
    </mrow>
   </msup>
   <mo stretchy="false">|</mo>
   <mrow>
    <mo stretchy="false">{</mo>
    <mi>M</mi>
    <mi>f</mi>
    <mo>></mo>
    <mi>t</mi>
    <mo stretchy="false">}</mo>
   </mrow>
   <mo stretchy="false">|</mo>
   <mi>d</mi>
   <mi>t</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="latexml">parallel-to</csymbol>
    <csymbol cd="unknown">M</csymbol>
    <csymbol cd="unknown">f</csymbol>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <csymbol cd="latexml">parallel-to</csymbol>
      <ci>p</ci>
     </apply>
     <ci>p</ci>
    </apply>
    <eq></eq>
    <int></int>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <int></int>
      <cn type="integer">0</cn>
     </apply>
     <apply>
      <times></times>
      <ci>M</ci>
      <ci>f</ci>
      <ci>x</ci>
     </apply>
    </apply>
    <csymbol cd="unknown">p</csymbol>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>t</ci>
     <apply>
      <minus></minus>
      <ci>p</ci>
      <cn type="integer">1</cn>
     </apply>
    </apply>
    <csymbol cd="unknown">d</csymbol>
    <csymbol cd="unknown">t</csymbol>
    <csymbol cd="unknown">d</csymbol>
    <csymbol cd="unknown">x</csymbol>
    <eq></eq>
    <csymbol cd="unknown">p</csymbol>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <int></int>
      <cn type="integer">0</cn>
     </apply>
     <infinity></infinity>
    </apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>t</ci>
     <apply>
      <minus></minus>
      <ci>p</ci>
      <cn type="integer">1</cn>
     </apply>
    </apply>
    <ci>normal-|</ci>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-{</ci>
     <csymbol cd="unknown">M</csymbol>
     <csymbol cd="unknown">f</csymbol>
     <gt></gt>
     <csymbol cd="unknown">t</csymbol>
     <ci>normal-}</ci>
    </cerror>
    <ci>normal-|</ci>
    <csymbol cd="unknown">d</csymbol>
    <csymbol cd="unknown">t</csymbol>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \|Mf\|_{p}^{p}=\int\int_{0}^{Mf(x)}pt^{p-1}dtdx=p\int_{0}^{\infty}t^{p-1}|\{Mf%
>t\}|dt
  </annotation>
 </semantics>
</math>

 By the estimate above we have:</p>

<p>

<math display="block" id="Hardy–Littlewood_maximal_function:11">
 <semantics>
  <mrow>
   <msubsup>
    <mrow>
     <mo>∥</mo>
     <mrow>
      <mi>M</mi>
      <mi>f</mi>
     </mrow>
     <mo>∥</mo>
    </mrow>
    <mi>p</mi>
    <mi>p</mi>
   </msubsup>
   <mo>≤</mo>
   <mrow>
    <mi>p</mi>
    <mrow>
     <msubsup>
      <mo largeop="true" symmetric="true">∫</mo>
      <mn>0</mn>
      <mi mathvariant="normal">∞</mi>
     </msubsup>
     <mrow>
      <msup>
       <mi>t</mi>
       <mrow>
        <mi>p</mi>
        <mo>-</mo>
        <mn>1</mn>
       </mrow>
      </msup>
      <mrow>
       <mo>(</mo>
       <mrow>
        <mfrac>
         <mrow>
          <mn>2</mn>
          <mi>C</mi>
         </mrow>
         <mi>t</mi>
        </mfrac>
        <mrow>
         <msub>
          <mo largeop="true" symmetric="true">∫</mo>
          <mrow>
           <mrow>
            <mo stretchy="false">|</mo>
            <mi>f</mi>
            <mo stretchy="false">|</mo>
           </mrow>
           <mo>></mo>
           <mfrac>
            <mi>t</mi>
            <mn>2</mn>
           </mfrac>
          </mrow>
         </msub>
         <mrow>
          <mrow>
           <mo stretchy="false">|</mo>
           <mi>f</mi>
           <mo stretchy="false">|</mo>
          </mrow>
          <mi>d</mi>
          <mi>x</mi>
         </mrow>
        </mrow>
       </mrow>
       <mo>)</mo>
      </mrow>
      <mi>d</mi>
      <mi>t</mi>
     </mrow>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mn>2</mn>
    <mi>C</mi>
    <mi>p</mi>
    <mrow>
     <msubsup>
      <mo largeop="true" symmetric="true">∫</mo>
      <mn>0</mn>
      <mi mathvariant="normal">∞</mi>
     </msubsup>
     <mrow>
      <msub>
       <mo largeop="true" symmetric="true">∫</mo>
       <mrow>
        <mrow>
         <mo stretchy="false">|</mo>
         <mi>f</mi>
         <mo stretchy="false">|</mo>
        </mrow>
        <mo>></mo>
        <mfrac>
         <mi>t</mi>
         <mn>2</mn>
        </mfrac>
       </mrow>
      </msub>
      <mrow>
       <msup>
        <mi>t</mi>
        <mrow>
         <mi>p</mi>
         <mo>-</mo>
         <mn>2</mn>
        </mrow>
       </msup>
       <mrow>
        <mo stretchy="false">|</mo>
        <mi>f</mi>
        <mo stretchy="false">|</mo>
       </mrow>
       <mi>d</mi>
       <mi>x</mi>
       <mi>d</mi>
       <mi>t</mi>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <msub>
     <mi>C</mi>
     <mi>p</mi>
    </msub>
    <msubsup>
     <mrow>
      <mo>∥</mo>
      <mi>f</mi>
      <mo>∥</mo>
     </mrow>
     <mi>p</mi>
     <mi>p</mi>
    </msubsup>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <leq></leq>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <apply>
        <csymbol cd="latexml">norm</csymbol>
        <apply>
         <times></times>
         <ci>M</ci>
         <ci>f</ci>
        </apply>
       </apply>
       <ci>p</ci>
      </apply>
      <ci>p</ci>
     </apply>
     <apply>
      <times></times>
      <ci>p</ci>
      <apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <int></int>
         <cn type="integer">0</cn>
        </apply>
        <infinity></infinity>
       </apply>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>t</ci>
         <apply>
          <minus></minus>
          <ci>p</ci>
          <cn type="integer">1</cn>
         </apply>
        </apply>
        <apply>
         <times></times>
         <apply>
          <divide></divide>
          <apply>
           <times></times>
           <cn type="integer">2</cn>
           <ci>C</ci>
          </apply>
          <ci>t</ci>
         </apply>
         <apply>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <int></int>
           <apply>
            <gt></gt>
            <apply>
             <abs></abs>
             <ci>f</ci>
            </apply>
            <apply>
             <divide></divide>
             <ci>t</ci>
             <cn type="integer">2</cn>
            </apply>
           </apply>
          </apply>
          <apply>
           <times></times>
           <apply>
            <abs></abs>
            <ci>f</ci>
           </apply>
           <ci>d</ci>
           <ci>x</ci>
          </apply>
         </apply>
        </apply>
        <ci>d</ci>
        <ci>t</ci>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <cn type="integer">2</cn>
      <ci>C</ci>
      <ci>p</ci>
      <apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <int></int>
         <cn type="integer">0</cn>
        </apply>
        <infinity></infinity>
       </apply>
       <apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <int></int>
         <apply>
          <gt></gt>
          <apply>
           <abs></abs>
           <ci>f</ci>
          </apply>
          <apply>
           <divide></divide>
           <ci>t</ci>
           <cn type="integer">2</cn>
          </apply>
         </apply>
        </apply>
        <apply>
         <times></times>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>t</ci>
          <apply>
           <minus></minus>
           <ci>p</ci>
           <cn type="integer">2</cn>
          </apply>
         </apply>
         <apply>
          <abs></abs>
          <ci>f</ci>
         </apply>
         <ci>d</ci>
         <ci>x</ci>
         <ci>d</ci>
         <ci>t</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>C</ci>
       <ci>p</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <apply>
         <csymbol cd="latexml">norm</csymbol>
         <ci>f</ci>
        </apply>
        <ci>p</ci>
       </apply>
       <ci>p</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \|Mf\|_{p}^{p}\leq p\int_{0}^{\infty}t^{p-1}\left({2C\over t}\int_{|f|>\frac{t%
}{2}}|f|dx\right)dt=2Cp\int_{0}^{\infty}\int_{|f|>\frac{t}{2}}t^{p-2}|f|dxdt=C%
_{p}\|f\|_{p}^{p}
  </annotation>
 </semantics>
</math>

 where the constant <em>C<sub>p</sub></em> depends only on <em>p</em> and <em>d</em>. This completes the proof of the theorem.</p>

<p>Note that the constant 

<math display="inline" id="Hardy–Littlewood_maximal_function:12">
 <semantics>
  <mrow>
   <mi>C</mi>
   <mo>=</mo>
   <msup>
    <mn>5</mn>
    <mi>d</mi>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>C</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <cn type="integer">5</cn>
     <ci>d</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   C=5^{d}
  </annotation>
 </semantics>
</math>

 in the proof can be improved to 

<math display="inline" id="Hardy–Littlewood_maximal_function:13">
 <semantics>
  <msup>
   <mn>3</mn>
   <mi>d</mi>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <cn type="integer">3</cn>
    <ci>d</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   3^{d}
  </annotation>
 </semantics>
</math>

 by using the <a href="Inner_regular_measure" title="wikilink">inner regularity</a> of the <a href="Lebesgue_measure" title="wikilink">Lebesgue measure</a>, and the finite version of the <a href="Vitali_covering_lemma#Statement_of_the_lemma" title="wikilink">Vitali covering lemma</a>. See the <a href="Hardy-Littlewood_maximal_function#Discussion" title="wikilink">Discussion section</a> below for more about optimizing the constant.</p>
<h2 id="applications">Applications</h2>

<p>Some applications of the Hardy–Littlewood Maximal Inequality include proving the following results:</p>
<ul>
<li><a href="Lebesgue_differentiation_theorem" title="wikilink">Lebesgue differentiation theorem</a></li>
<li><a href="Rademacher's_theorem" title="wikilink">Rademacher differentiation theorem</a></li>
<li><a href="Fatou's_theorem" title="wikilink">Fatou's theorem</a> on nontangential convergence.</li>
<li><a href="Fractional_integration_theorem" title="wikilink">Fractional integration theorem</a></li>
</ul>

<p>Here we use a standard trick involving the maximal function to give a quick proof of Lebesgue differentiation theorem. (But remember that in the proof of the maximal theorem, we used the Vitali covering lemma.) Let <em>f</em> ∈ <em>L</em><sup>1</sup>(<strong>R</strong><sup><em>n</em></sup>) and</p>

<p>

<math display="block" id="Hardy–Littlewood_maximal_function:14">
 <semantics>
  <mrow>
   <mrow>
    <mi mathvariant="normal">Ω</mi>
    <mi>f</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>x</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <munder>
      <mo movablelimits="false">lim sup</mo>
      <mrow>
       <mi>r</mi>
       <mo>→</mo>
       <mn>0</mn>
      </mrow>
     </munder>
     <mrow>
      <msub>
       <mi>f</mi>
       <mi>r</mi>
      </msub>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>x</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mrow>
    <mo>-</mo>
    <mrow>
     <munder>
      <mo movablelimits="false">lim inf</mo>
      <mrow>
       <mi>r</mi>
       <mo>→</mo>
       <mn>0</mn>
      </mrow>
     </munder>
     <mrow>
      <msub>
       <mi>f</mi>
       <mi>r</mi>
      </msub>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>x</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>normal-Ω</ci>
     <ci>f</ci>
     <ci>x</ci>
    </apply>
    <apply>
     <minus></minus>
     <apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <csymbol cd="latexml">limit-supremum</csymbol>
       <apply>
        <ci>normal-→</ci>
        <ci>r</ci>
        <cn type="integer">0</cn>
       </apply>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>f</ci>
        <ci>r</ci>
       </apply>
       <ci>x</ci>
      </apply>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <csymbol cd="latexml">limit-infimum</csymbol>
       <apply>
        <ci>normal-→</ci>
        <ci>r</ci>
        <cn type="integer">0</cn>
       </apply>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>f</ci>
        <ci>r</ci>
       </apply>
       <ci>x</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Omega f(x)=\limsup_{r\to 0}f_{r}(x)-\liminf_{r\to 0}f_{r}(x)
  </annotation>
 </semantics>
</math>

</p>

<p>where</p>

<p>

<math display="block" id="Hardy–Littlewood_maximal_function:15">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <msub>
      <mi>f</mi>
      <mi>r</mi>
     </msub>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>x</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mfrac>
      <mn>1</mn>
      <mrow>
       <mo stretchy="false">|</mo>
       <mrow>
        <mi>B</mi>
        <mrow>
         <mo stretchy="false">(</mo>
         <mi>x</mi>
         <mo>,</mo>
         <mi>r</mi>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
       <mo stretchy="false">|</mo>
      </mrow>
     </mfrac>
     <mrow>
      <msub>
       <mo largeop="true" symmetric="true">∫</mo>
       <mrow>
        <mi>B</mi>
        <mrow>
         <mo stretchy="false">(</mo>
         <mi>x</mi>
         <mo>,</mo>
         <mi>r</mi>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
      </msub>
      <mrow>
       <mi>f</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>y</mi>
        <mo stretchy="false">)</mo>
       </mrow>
       <mi>d</mi>
       <mi>y</mi>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>f</ci>
      <ci>r</ci>
     </apply>
     <ci>x</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <divide></divide>
      <cn type="integer">1</cn>
      <apply>
       <abs></abs>
       <apply>
        <times></times>
        <ci>B</ci>
        <interval closure="open">
         <ci>x</ci>
         <ci>r</ci>
        </interval>
       </apply>
      </apply>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <int></int>
       <apply>
        <times></times>
        <ci>B</ci>
        <interval closure="open">
         <ci>x</ci>
         <ci>r</ci>
        </interval>
       </apply>
      </apply>
      <apply>
       <times></times>
       <ci>f</ci>
       <ci>y</ci>
       <ci>d</ci>
       <ci>y</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f_{r}(x)=\frac{1}{|B(x,r)|}\int_{B(x,r)}f(y)dy.
  </annotation>
 </semantics>
</math>

</p>

<p>We write <em>f</em> = <em>h</em> + <em>g</em> where <em>h</em> is continuous and has compact support and <em>g</em> ∈ <em>L</em><sup>1</sup>(<strong>R</strong><sup><em>n</em></sup>) with norm that can be made arbitrary small. Then</p>

<p>

<math display="block" id="Hardy–Littlewood_maximal_function:16">
 <semantics>
  <mrow>
   <mrow>
    <mi mathvariant="normal">Ω</mi>
    <mi>f</mi>
   </mrow>
   <mo>≤</mo>
   <mrow>
    <mrow>
     <mi mathvariant="normal">Ω</mi>
     <mi>g</mi>
    </mrow>
    <mo>+</mo>
    <mrow>
     <mi mathvariant="normal">Ω</mi>
     <mi>h</mi>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mi mathvariant="normal">Ω</mi>
    <mi>g</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <leq></leq>
     <apply>
      <times></times>
      <ci>normal-Ω</ci>
      <ci>f</ci>
     </apply>
     <apply>
      <plus></plus>
      <apply>
       <times></times>
       <ci>normal-Ω</ci>
       <ci>g</ci>
      </apply>
      <apply>
       <times></times>
       <ci>normal-Ω</ci>
       <ci>h</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <ci>normal-Ω</ci>
      <ci>g</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Omega f\leq\Omega g+\Omega h=\Omega g
  </annotation>
 </semantics>
</math>

</p>

<p>by continuity. Now, Ω<em>g</em> ≤ 2<em>Mg</em> and so, by the theorem, we have:</p>

<p>

<math display="block" id="Hardy–Littlewood_maximal_function:17">
 <semantics>
  <mrow>
   <mo>|</mo>
   <mrow>
    <mo stretchy="false">{</mo>
    <mi mathvariant="normal">Ω</mi>
    <mi>g</mi>
    <mo>></mo>
    <mi>ε</mi>
    <mo stretchy="false">}</mo>
   </mrow>
   <mo>|</mo>
   <mo>≤</mo>
   <mfrac>
    <mrow>
     <mn>2</mn>
     <mi>A</mi>
    </mrow>
    <mi>ε</mi>
   </mfrac>
   <mo>∥</mo>
   <mi>g</mi>
   <msub>
    <mo>∥</mo>
    <mn>1</mn>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <ci>normal-|</ci>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-{</ci>
     <csymbol cd="unknown">Ω</csymbol>
     <csymbol cd="unknown">g</csymbol>
     <gt></gt>
     <csymbol cd="unknown">ε</csymbol>
     <ci>normal-}</ci>
    </cerror>
    <ci>normal-|</ci>
    <leq></leq>
    <apply>
     <divide></divide>
     <apply>
      <times></times>
      <cn type="integer">2</cn>
      <ci>A</ci>
     </apply>
     <ci>ε</ci>
    </apply>
    <csymbol cd="latexml">parallel-to</csymbol>
    <csymbol cd="unknown">g</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <csymbol cd="latexml">parallel-to</csymbol>
     <cn type="integer">1</cn>
    </apply>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \left|\{\Omega g>\varepsilon\}\right|\leq\frac{2A}{\varepsilon}\|g\|_{1}
  </annotation>
 </semantics>
</math>

</p>

<p>Now, we can let 

<math display="inline" id="Hardy–Littlewood_maximal_function:18">
 <semantics>
  <mrow>
   <msub>
    <mrow>
     <mo>∥</mo>
     <mi>g</mi>
     <mo>∥</mo>
    </mrow>
    <mn>1</mn>
   </msub>
   <mo>→</mo>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-→</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <csymbol cd="latexml">norm</csymbol>
      <ci>g</ci>
     </apply>
     <cn type="integer">1</cn>
    </apply>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \|g\|_{1}\to 0
  </annotation>
 </semantics>
</math>

 and conclude Ω<em>f</em> = 0 almost everywhere; that is, 

<math display="inline" id="Hardy–Littlewood_maximal_function:19">
 <semantics>
  <mrow>
   <msub>
    <mo>lim</mo>
    <mrow>
     <mi>r</mi>
     <mo>→</mo>
     <mn>0</mn>
    </mrow>
   </msub>
   <mrow>
    <msub>
     <mi>f</mi>
     <mi>r</mi>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>x</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <limit></limit>
     <apply>
      <ci>normal-→</ci>
      <ci>r</ci>
      <cn type="integer">0</cn>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>f</ci>
      <ci>r</ci>
     </apply>
     <ci>x</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \lim_{r\to 0}f_{r}(x)
  </annotation>
 </semantics>
</math>

 exists for almost all <em>x</em>. It remains to show the limit actually equals <em>f</em>(<em>x</em>). But this is easy: it is known that 

<math display="inline" id="Hardy–Littlewood_maximal_function:20">
 <semantics>
  <mrow>
   <msub>
    <mrow>
     <mo>∥</mo>
     <mrow>
      <msub>
       <mi>f</mi>
       <mi>r</mi>
      </msub>
      <mo>-</mo>
      <mi>f</mi>
     </mrow>
     <mo>∥</mo>
    </mrow>
    <mn>1</mn>
   </msub>
   <mo>→</mo>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-→</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <csymbol cd="latexml">norm</csymbol>
      <apply>
       <minus></minus>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>f</ci>
        <ci>r</ci>
       </apply>
       <ci>f</ci>
      </apply>
     </apply>
     <cn type="integer">1</cn>
    </apply>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \|f_{r}-f\|_{1}\to 0
  </annotation>
 </semantics>
</math>

 (<a href="approximation_of_the_identity" title="wikilink">approximation of the identity</a>) and thus there is a subsequence 

<math display="inline" id="Hardy–Littlewood_maximal_function:21">
 <semantics>
  <mrow>
   <msub>
    <mi>f</mi>
    <msub>
     <mi>r</mi>
     <mi>k</mi>
    </msub>
   </msub>
   <mo>→</mo>
   <mi>f</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-→</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>f</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>r</ci>
      <ci>k</ci>
     </apply>
    </apply>
    <ci>f</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f_{r_{k}}\to f
  </annotation>
 </semantics>
</math>

 almost everywhere. By the uniqueness of limit, <em>f<sub>r</sub></em> → <em>f</em> almost everywhere then.</p>
<h2 id="discussion">Discussion</h2>

<p>It is still unknown what the smallest constants <em>C<sub>p,d</sub></em> and <em>C<sub>d</sub></em> are in the above inequalities. However, a result of <a href="Elias_Stein" title="wikilink">Elias Stein</a> about spherical maximal functions can be used to show that, for 1 p,d'' on the dimension, that is, <em>C<sub>p,d</sub></em> = <em>C<sub>p</sub></em> for some constant <em>C<sub>p</sub></em> &gt; 0 only depending on <em>p</em>. It is unknown whether there is a weak bound that is independent of dimension.</p>

<p>There are several common variants of the Hardy-Littlewood maximal operator which replace the averages over centered balls with averages over different families of sets. For instance, one can define the <em>uncentered</em> HL maximal operator (using the notation of Stein-Shakarchi)</p>

<p>

<math display="block" id="Hardy–Littlewood_maximal_function:22">
 <semantics>
  <mrow>
   <mrow>
    <msup>
     <mi>f</mi>
     <mo>*</mo>
    </msup>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>x</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <munder>
     <mo movablelimits="false">sup</mo>
     <mrow>
      <mi>x</mi>
      <mo>∈</mo>
      <msub>
       <mi>B</mi>
       <mi>x</mi>
      </msub>
     </mrow>
    </munder>
    <mrow>
     <mfrac>
      <mn>1</mn>
      <mrow>
       <mo stretchy="false">|</mo>
       <msub>
        <mi>B</mi>
        <mi>x</mi>
       </msub>
       <mo stretchy="false">|</mo>
      </mrow>
     </mfrac>
     <mrow>
      <msub>
       <mo largeop="true" symmetric="true">∫</mo>
       <msub>
        <mi>B</mi>
        <mi>x</mi>
       </msub>
      </msub>
      <mrow>
       <mrow>
        <mo stretchy="false">|</mo>
        <mrow>
         <mi>f</mi>
         <mrow>
          <mo stretchy="false">(</mo>
          <mi>y</mi>
          <mo stretchy="false">)</mo>
         </mrow>
        </mrow>
        <mo stretchy="false">|</mo>
       </mrow>
       <mi>d</mi>
       <mi>y</mi>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>f</ci>
      <times></times>
     </apply>
     <ci>x</ci>
    </apply>
    <apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <csymbol cd="latexml">supremum</csymbol>
      <apply>
       <in></in>
       <ci>x</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>B</ci>
        <ci>x</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <apply>
        <abs></abs>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>B</ci>
         <ci>x</ci>
        </apply>
       </apply>
      </apply>
      <apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <int></int>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>B</ci>
         <ci>x</ci>
        </apply>
       </apply>
       <apply>
        <times></times>
        <apply>
         <abs></abs>
         <apply>
          <times></times>
          <ci>f</ci>
          <ci>y</ci>
         </apply>
        </apply>
        <ci>d</ci>
        <ci>y</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f^{*}(x)=\sup_{x\in B_{x}}\frac{1}{|B_{x}|}\int_{B_{x}}|f(y)|dy
  </annotation>
 </semantics>
</math>

</p>

<p>where the balls <em>B<sub>x</sub></em> are required to merely contain x, rather than be centered at x. There is also the <em>dyadic</em> HL maximal operator</p>

<p>

<math display="block" id="Hardy–Littlewood_maximal_function:23">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>M</mi>
     <mi mathvariant="normal">Δ</mi>
    </msub>
    <mi>f</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>x</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <munder>
     <mo movablelimits="false">sup</mo>
     <mrow>
      <mi>x</mi>
      <mo>∈</mo>
      <msub>
       <mi>Q</mi>
       <mi>x</mi>
      </msub>
     </mrow>
    </munder>
    <mrow>
     <mfrac>
      <mn>1</mn>
      <mrow>
       <mo stretchy="false">|</mo>
       <msub>
        <mi>Q</mi>
        <mi>x</mi>
       </msub>
       <mo stretchy="false">|</mo>
      </mrow>
     </mfrac>
     <mrow>
      <msub>
       <mo largeop="true" symmetric="true">∫</mo>
       <msub>
        <mi>Q</mi>
        <mi>x</mi>
       </msub>
      </msub>
      <mrow>
       <mrow>
        <mo stretchy="false">|</mo>
        <mrow>
         <mi>f</mi>
         <mrow>
          <mo stretchy="false">(</mo>
          <mi>y</mi>
          <mo stretchy="false">)</mo>
         </mrow>
        </mrow>
        <mo stretchy="false">|</mo>
       </mrow>
       <mi>d</mi>
       <mi>y</mi>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>M</ci>
      <ci>normal-Δ</ci>
     </apply>
     <ci>f</ci>
     <ci>x</ci>
    </apply>
    <apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <csymbol cd="latexml">supremum</csymbol>
      <apply>
       <in></in>
       <ci>x</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>Q</ci>
        <ci>x</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <apply>
        <abs></abs>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>Q</ci>
         <ci>x</ci>
        </apply>
       </apply>
      </apply>
      <apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <int></int>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>Q</ci>
         <ci>x</ci>
        </apply>
       </apply>
       <apply>
        <times></times>
        <apply>
         <abs></abs>
         <apply>
          <times></times>
          <ci>f</ci>
          <ci>y</ci>
         </apply>
        </apply>
        <ci>d</ci>
        <ci>y</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   M_{\Delta}f(x)=\sup_{x\in Q_{x}}\frac{1}{|Q_{x}|}\int_{Q_{x}}|f(y)|dy
  </annotation>
 </semantics>
</math>

</p>

<p>where <em>Q<sub>x</sub></em> ranges over all <a href="dyadic_cubes" title="wikilink">dyadic cubes</a> containing the point <em>x</em>. Both of these operators satisfy the HL maximal inequality.</p>
<h2 id="references">References</h2>
<references>
</references>
<ul>
<li><a href="John_B._Garnett" title="wikilink">John B. Garnett</a>, <em>Bounded Analytic Functions</em>. Springer-Verlag, 2006</li>
<li>Antonios D. Melas, <em>The best constant for the centered Hardy–Littlewood maximal inequality</em>, Annals of Mathematics, 157 (2003), 647–688</li>
<li>Rami Shakarchi &amp; <a href="Elias_M._Stein" title="wikilink">Elias M. Stein</a>, <em>Princeton Lectures in Analysis III: Real Analysis</em>. Princeton University Press, 2005</li>
<li>Elias M. Stein, <em>Maximal functions: spherical means</em>, Proc. Nat. Acad. Sci. U.S.A. <strong>73</strong> (1976), 2174–2175</li>
<li>Elias M. Stein, <em>Singular Integrals and Differentiability Properties of Functions</em>. Princeton University Press, 1971</li>
<li><a href="Gerald_Teschl" title="wikilink">Gerald Teschl</a>, <a href="http://www.mat.univie.ac.at/~gerald/ftp/book-fa/index.html">Topics in Real and Functional Analysis</a> (lecture notes)</li>
</ul>

<p>"</p>

<p><a href="Category:Real_analysis" title="wikilink">Category:Real analysis</a> <a href="Category:Harmonic_analysis" title="wikilink">Category:Harmonic analysis</a> <a href="Category:Types_of_functions" title="wikilink">Category:Types of functions</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1"></li>
<li id="fn2"><a href="#fnref2">↩</a></li>
<li id="fn3"><a href="#fnref3">↩</a></li>
</ol>
</section>
</body>
</html>

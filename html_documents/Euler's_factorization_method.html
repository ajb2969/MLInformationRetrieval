<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="12">Euler's factorization method</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Euler's factorization method</h1>
<hr/>

<p><strong><a class="uri" href="Euler" title="wikilink">Euler</a>'s factorization method</strong> is a technique for <a href="integer_factorization" title="wikilink">factoring</a> a number by writing it as a sum of two squares in two different ways. For example the number 

<math display="inline" id="Euler's_factorization_method:0">
 <semantics>
  <mn>1000009</mn>
  <annotation-xml encoding="MathML-Content">
   <cn type="integer">1000009</cn>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   1000009
  </annotation>
 </semantics>
</math>

 can be written as 

<math display="inline" id="Euler's_factorization_method:1">
 <semantics>
  <mrow>
   <msup>
    <mn>1000</mn>
    <mn>2</mn>
   </msup>
   <mo>+</mo>
   <msup>
    <mn>3</mn>
    <mn>2</mn>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <plus></plus>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <cn type="integer">1000</cn>
     <cn type="integer">2</cn>
    </apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <cn type="integer">3</cn>
     <cn type="integer">2</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   1000^{2}+3^{2}
  </annotation>
 </semantics>
</math>

 or as 

<math display="inline" id="Euler's_factorization_method:2">
 <semantics>
  <mrow>
   <msup>
    <mn>972</mn>
    <mn>2</mn>
   </msup>
   <mo>+</mo>
   <msup>
    <mn>235</mn>
    <mn>2</mn>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <plus></plus>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <cn type="integer">972</cn>
     <cn type="integer">2</cn>
    </apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <cn type="integer">235</cn>
     <cn type="integer">2</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   972^{2}+235^{2}
  </annotation>
 </semantics>
</math>

 and Euler's method gives the factorization 

<math display="inline" id="Euler's_factorization_method:3">
 <semantics>
  <mrow>
   <mn>1000009</mn>
   <mo>=</mo>
   <mrow>
    <mn>293</mn>
    <mo>⋅</mo>
    <mn>3413</mn>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <cn type="integer">1000009</cn>
    <apply>
     <ci>normal-⋅</ci>
     <cn type="integer">293</cn>
     <cn type="integer">3413</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   1000009=293\cdot 3413
  </annotation>
 </semantics>
</math>


.</p>

<p>The idea that two distinct representations of an odd positive integer may lead to a factorization was apparently first proposed by <a href="Marin_Mersenne" title="wikilink">Marin Mersenne</a>. However, it was not put to use extensively until Euler one hundred years later. His most celebrated use of the method that now bears his name was to factor the number 

<math display="inline" id="Euler's_factorization_method:4">
 <semantics>
  <mn>1000009</mn>
  <annotation-xml encoding="MathML-Content">
   <cn type="integer">1000009</cn>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   1000009
  </annotation>
 </semantics>
</math>

, which apparently was previously thought to be prime even though it is not a <a class="uri" href="pseudoprime" title="wikilink">pseudoprime</a> by any major primality test.</p>

<p>Euler's factorization method is more effective than Fermat's for integers whose factors are not close together and potentially much more efficient than trial division if one can find representations of numbers as sums of two squares reasonably easily. Euler's development ultimately permitted much more efficient factoring of numbers and, by the 1910s, the development of large factor tables going up to about ten million. The methods used to find representations of numbers as sums of two squares are essentially the same as with finding differences of squares in <a href="Fermat's_factorization_method" title="wikilink">Fermat's factorization method</a>.</p>

<p>The great disadvantage of Euler's factorization method is that it cannot be applied to factoring an integer with any prime factor of the form 4<em>k</em> + 3 occurring to an odd power in its prime factorization, as such a number can never be the sum of two squares. Even odd <a href="composite_number" title="wikilink">composite numbers</a> of the form 4<em>k</em> + 1 are often the product of two primes of the form 4<em>k</em> + 3 (e.g. 3053 = 43 × 71) and again cannot be factored by Euler's method.</p>

<p>This restricted applicability has made Euler's factorization method disfavoured for <a class="uri" href="computer" title="wikilink">computer</a> factoring <a href="algorithm" title="wikilink">algorithms</a>, since any user attempting to factor a random integer is unlikely to know whether Euler's method can actually be applied to the integer in question. It is only relatively recently that there have been attempts to develop Euler's method into computer algorithms for use on specialised numbers where it is known Euler's method can be applied.</p>
<h2 id="theoretical-basis">Theoretical basis</h2>

<p>The <a href="Brahmagupta–Fibonacci_identity" title="wikilink">Brahmagupta–Fibonacci identity</a> states that the product of two sums of two squares is a sum of two squares. Euler's method relies on this theorem but it can be viewed as the converse, given 

<math display="inline" id="Euler's_factorization_method:5">
 <semantics>
  <mrow>
   <mi>n</mi>
   <mo>=</mo>
   <mrow>
    <msup>
     <mi>a</mi>
     <mn>2</mn>
    </msup>
    <mo>+</mo>
    <msup>
     <mi>b</mi>
     <mn>2</mn>
    </msup>
   </mrow>
   <mo>=</mo>
   <mrow>
    <msup>
     <mi>c</mi>
     <mn>2</mn>
    </msup>
    <mo>+</mo>
    <msup>
     <mi>d</mi>
     <mn>2</mn>
    </msup>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <ci>n</ci>
     <apply>
      <plus></plus>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>a</ci>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>b</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <plus></plus>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>c</ci>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>d</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n=a^{2}+b^{2}=c^{2}+d^{2}
  </annotation>
 </semantics>
</math>

 we find 

<math display="inline" id="Euler's_factorization_method:6">
 <semantics>
  <mi>n</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>n</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n
  </annotation>
 </semantics>
</math>

 as a product of sums of two squares.</p>

<p>First deduce that</p>

<p>

<math display="block" id="Euler's_factorization_method:7">
 <semantics>
  <mrow>
   <mrow>
    <msup>
     <mi>a</mi>
     <mn>2</mn>
    </msup>
    <mo>-</mo>
    <msup>
     <mi>c</mi>
     <mn>2</mn>
    </msup>
   </mrow>
   <mo>=</mo>
   <mrow>
    <msup>
     <mi>d</mi>
     <mn>2</mn>
    </msup>
    <mo>-</mo>
    <msup>
     <mi>b</mi>
     <mn>2</mn>
    </msup>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <minus></minus>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>a</ci>
      <cn type="integer">2</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>c</ci>
      <cn type="integer">2</cn>
     </apply>
    </apply>
    <apply>
     <minus></minus>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>d</ci>
      <cn type="integer">2</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>b</ci>
      <cn type="integer">2</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a^{2}-c^{2}=d^{2}-b^{2}
  </annotation>
 </semantics>
</math>

</p>

<p>and factor both sides to get</p>

<p>

<math display="block" id="Euler's_factorization_method:8">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>a</mi>
      <mo>-</mo>
      <mi>c</mi>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>a</mi>
      <mo>+</mo>
      <mi>c</mi>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>d</mi>
      <mo>-</mo>
      <mi>b</mi>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>d</mi>
      <mo>+</mo>
      <mi>b</mi>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <minus></minus>
      <ci>a</ci>
      <ci>c</ci>
     </apply>
     <apply>
      <plus></plus>
      <ci>a</ci>
      <ci>c</ci>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <minus></minus>
      <ci>d</ci>
      <ci>b</ci>
     </apply>
     <apply>
      <plus></plus>
      <ci>d</ci>
      <ci>b</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (a-c)(a+c)=(d-b)(d+b)
  </annotation>
 </semantics>
</math>

 (1)</p>

<p>Now let 

<math display="inline" id="Euler's_factorization_method:9">
 <semantics>
  <mrow>
   <mi>k</mi>
   <mo>=</mo>
   <mrow>
    <mo>gcd</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>a</mi>
      <mo>-</mo>
      <mi>c</mi>
     </mrow>
     <mo>,</mo>
     <mrow>
      <mi>d</mi>
      <mo>-</mo>
      <mi>b</mi>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>k</ci>
    <apply>
     <ci>gcd</ci>
     <apply>
      <minus></minus>
      <ci>a</ci>
      <ci>c</ci>
     </apply>
     <apply>
      <minus></minus>
      <ci>d</ci>
      <ci>b</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   k=\operatorname{gcd}(a-c,d-b)
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Euler's_factorization_method:10">
 <semantics>
  <mrow>
   <mi>h</mi>
   <mo>=</mo>
   <mrow>
    <mo>gcd</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>a</mi>
      <mo>+</mo>
      <mi>c</mi>
     </mrow>
     <mo>,</mo>
     <mrow>
      <mi>d</mi>
      <mo>+</mo>
      <mi>b</mi>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>h</ci>
    <apply>
     <ci>gcd</ci>
     <apply>
      <plus></plus>
      <ci>a</ci>
      <ci>c</ci>
     </apply>
     <apply>
      <plus></plus>
      <ci>d</ci>
      <ci>b</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   h=\operatorname{gcd}(a+c,d+b)
  </annotation>
 </semantics>
</math>

 so that there exists some constants 

<math display="inline" id="Euler's_factorization_method:11">
 <semantics>
  <mrow>
   <mi>l</mi>
   <mo>,</mo>
   <mi>m</mi>
   <mo>,</mo>
   <msup>
    <mi>l</mi>
    <mo>′</mo>
   </msup>
   <mo>,</mo>
   <msup>
    <mi>m</mi>
    <mo>′</mo>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <list>
    <ci>l</ci>
    <ci>m</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>l</ci>
     <ci>normal-′</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>m</ci>
     <ci>normal-′</ci>
    </apply>
   </list>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   l,m,l^{\prime},m^{\prime}
  </annotation>
 </semantics>
</math>

 satisfying</p>
<ul>
<li>

<math display="inline" id="Euler's_factorization_method:12">
 <semantics>
  <mrow>
   <mrow>
    <mo stretchy="false">(</mo>
    <mrow>
     <mi>a</mi>
     <mo>-</mo>
     <mi>c</mi>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mi>k</mi>
    <mi>l</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <minus></minus>
     <ci>a</ci>
     <ci>c</ci>
    </apply>
    <apply>
     <times></times>
     <ci>k</ci>
     <ci>l</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (a-c)=kl
  </annotation>
 </semantics>
</math>

,</li>
<li>

<math display="inline" id="Euler's_factorization_method:13">
 <semantics>
  <mrow>
   <mrow>
    <mo stretchy="false">(</mo>
    <mrow>
     <mi>d</mi>
     <mo>-</mo>
     <mi>b</mi>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mi>k</mi>
    <mi>m</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <minus></minus>
     <ci>d</ci>
     <ci>b</ci>
    </apply>
    <apply>
     <times></times>
     <ci>k</ci>
     <ci>m</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (d-b)=km
  </annotation>
 </semantics>
</math>


,</li>
</ul>

<p>

<math display="inline" id="Euler's_factorization_method:14">
 <semantics>
  <mrow>
   <mrow>
    <mo>gcd</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>l</mi>
     <mo>,</mo>
     <mi>m</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <ci>gcd</ci>
     <ci>l</ci>
     <ci>m</ci>
    </apply>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \operatorname{gcd}(l,m)=1
  </annotation>
 </semantics>
</math>

</p>
<ul>
<li>

<math display="inline" id="Euler's_factorization_method:15">
 <semantics>
  <mrow>
   <mrow>
    <mo stretchy="false">(</mo>
    <mrow>
     <mi>a</mi>
     <mo>+</mo>
     <mi>c</mi>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mi>h</mi>
    <msup>
     <mi>m</mi>
     <mo>′</mo>
    </msup>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <plus></plus>
     <ci>a</ci>
     <ci>c</ci>
    </apply>
    <apply>
     <times></times>
     <ci>h</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>m</ci>
      <ci>normal-′</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (a+c)=hm^{\prime}
  </annotation>
 </semantics>
</math>

,</li>
<li>

<math display="inline" id="Euler's_factorization_method:16">
 <semantics>
  <mrow>
   <mrow>
    <mo stretchy="false">(</mo>
    <mrow>
     <mi>d</mi>
     <mo>+</mo>
     <mi>b</mi>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mi>h</mi>
    <msup>
     <mi>l</mi>
     <mo>′</mo>
    </msup>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <plus></plus>
     <ci>d</ci>
     <ci>b</ci>
    </apply>
    <apply>
     <times></times>
     <ci>h</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>l</ci>
      <ci>normal-′</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (d+b)=hl^{\prime}
  </annotation>
 </semantics>
</math>

,</li>
</ul>

<p>

<math display="inline" id="Euler's_factorization_method:17">
 <semantics>
  <mrow>
   <mrow>
    <mo>gcd</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <msup>
      <mi>l</mi>
      <mo>′</mo>
     </msup>
     <mo>,</mo>
     <msup>
      <mi>m</mi>
      <mo>′</mo>
     </msup>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <ci>gcd</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>l</ci>
      <ci>normal-′</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>m</ci>
      <ci>normal-′</ci>
     </apply>
    </apply>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \operatorname{gcd}(l^{\prime},m^{\prime})=1
  </annotation>
 </semantics>
</math>

</p>

<p>Substituting these into equation (1) gives</p>

<p>

<math display="block" id="Euler's_factorization_method:18">
 <semantics>
  <mrow>
   <mrow>
    <mi>k</mi>
    <mi>l</mi>
    <mi>h</mi>
    <msup>
     <mi>m</mi>
     <mo>′</mo>
    </msup>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mi>k</mi>
    <mi>m</mi>
    <mi>h</mi>
    <msup>
     <mi>l</mi>
     <mo>′</mo>
    </msup>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>k</ci>
     <ci>l</ci>
     <ci>h</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>m</ci>
      <ci>normal-′</ci>
     </apply>
    </apply>
    <apply>
     <times></times>
     <ci>k</ci>
     <ci>m</ci>
     <ci>h</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>l</ci>
      <ci>normal-′</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   klhm^{\prime}=kmhl^{\prime}
  </annotation>
 </semantics>
</math>

</p>

<p>Canceling common factors yields</p>

<p>

<math display="block" id="Euler's_factorization_method:19">
 <semantics>
  <mrow>
   <mrow>
    <mi>l</mi>
    <msup>
     <mi>m</mi>
     <mo>′</mo>
    </msup>
   </mrow>
   <mo>=</mo>
   <mrow>
    <msup>
     <mi>l</mi>
     <mo>′</mo>
    </msup>
    <mi>m</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>l</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>m</ci>
      <ci>normal-′</ci>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>l</ci>
      <ci>normal-′</ci>
     </apply>
     <ci>m</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   lm^{\prime}=l^{\prime}m
  </annotation>
 </semantics>
</math>

</p>

<p>Now using the fact that 

<math display="inline" id="Euler's_factorization_method:20">
 <semantics>
  <mrow>
   <mo stretchy="false">(</mo>
   <mi>l</mi>
   <mo>,</mo>
   <mi>m</mi>
   <mo stretchy="false">)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <interval closure="open">
    <ci>l</ci>
    <ci>m</ci>
   </interval>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (l,m)
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Euler's_factorization_method:21">
 <semantics>
  <mrow>
   <mo stretchy="false">(</mo>
   <msup>
    <mi>l</mi>
    <mo>′</mo>
   </msup>
   <mo>,</mo>
   <msup>
    <mi>m</mi>
    <mo>′</mo>
   </msup>
   <mo stretchy="false">)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <interval closure="open">
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>l</ci>
     <ci>normal-′</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>m</ci>
     <ci>normal-′</ci>
    </apply>
   </interval>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (l^{\prime},m^{\prime})
  </annotation>
 </semantics>
</math>

 are pairs of relatively prime numbers, we find that</p>
<ul>
<li>

<math display="inline" id="Euler's_factorization_method:22">
 <semantics>
  <mrow>
   <mi>l</mi>
   <mo>=</mo>
   <msup>
    <mi>l</mi>
    <mo>′</mo>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>l</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>l</ci>
     <ci>normal-′</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   l=l^{\prime}
  </annotation>
 </semantics>
</math>

</li>
<li>

<math display="inline" id="Euler's_factorization_method:23">
 <semantics>
  <mrow>
   <mi>m</mi>
   <mo>=</mo>
   <msup>
    <mi>m</mi>
    <mo>′</mo>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>m</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>m</ci>
     <ci>normal-′</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   m=m^{\prime}
  </annotation>
 </semantics>
</math>


</li>
</ul>

<p>So</p>
<ul>
<li>

<math display="inline" id="Euler's_factorization_method:24">
 <semantics>
  <mrow>
   <mrow>
    <mo stretchy="false">(</mo>
    <mrow>
     <mi>a</mi>
     <mo>-</mo>
     <mi>c</mi>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mi>k</mi>
    <mi>l</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <minus></minus>
     <ci>a</ci>
     <ci>c</ci>
    </apply>
    <apply>
     <times></times>
     <ci>k</ci>
     <ci>l</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (a-c)=kl
  </annotation>
 </semantics>
</math>

</li>
<li>

<math display="inline" id="Euler's_factorization_method:25">
 <semantics>
  <mrow>
   <mrow>
    <mo stretchy="false">(</mo>
    <mrow>
     <mi>d</mi>
     <mo>-</mo>
     <mi>b</mi>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mi>k</mi>
    <mi>m</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <minus></minus>
     <ci>d</ci>
     <ci>b</ci>
    </apply>
    <apply>
     <times></times>
     <ci>k</ci>
     <ci>m</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (d-b)=km
  </annotation>
 </semantics>
</math>

</li>
<li>

<math display="inline" id="Euler's_factorization_method:26">
 <semantics>
  <mrow>
   <mrow>
    <mo stretchy="false">(</mo>
    <mrow>
     <mi>a</mi>
     <mo>+</mo>
     <mi>c</mi>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mi>h</mi>
    <mi>m</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <plus></plus>
     <ci>a</ci>
     <ci>c</ci>
    </apply>
    <apply>
     <times></times>
     <ci>h</ci>
     <ci>m</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (a+c)=hm
  </annotation>
 </semantics>
</math>

</li>
<li>

<math display="inline" id="Euler's_factorization_method:27">
 <semantics>
  <mrow>
   <mrow>
    <mo stretchy="false">(</mo>
    <mrow>
     <mi>d</mi>
     <mo>+</mo>
     <mi>b</mi>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mi>h</mi>
    <mi>l</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <plus></plus>
     <ci>d</ci>
     <ci>b</ci>
    </apply>
    <apply>
     <times></times>
     <ci>h</ci>
     <ci>l</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (d+b)=hl
  </annotation>
 </semantics>
</math>

</li>
</ul>

<p>We now see that 

<math display="inline" id="Euler's_factorization_method:28">
 <semantics>
  <mrow>
   <mi>m</mi>
   <mo>=</mo>
   <mrow>
    <mo>gcd</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>a</mi>
      <mo>+</mo>
      <mi>c</mi>
     </mrow>
     <mo>,</mo>
     <mrow>
      <mi>d</mi>
      <mo>-</mo>
      <mi>b</mi>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>m</ci>
    <apply>
     <ci>gcd</ci>
     <apply>
      <plus></plus>
      <ci>a</ci>
      <ci>c</ci>
     </apply>
     <apply>
      <minus></minus>
      <ci>d</ci>
      <ci>b</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   m=\operatorname{gcd}(a+c,d-b)
  </annotation>
 </semantics>
</math>


 and 

<math display="inline" id="Euler's_factorization_method:29">
 <semantics>
  <mrow>
   <mi>l</mi>
   <mo>=</mo>
   <mrow>
    <mo>gcd</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>a</mi>
      <mo>-</mo>
      <mi>c</mi>
     </mrow>
     <mo>,</mo>
     <mrow>
      <mi>d</mi>
      <mo>+</mo>
      <mi>b</mi>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>l</ci>
    <apply>
     <ci>gcd</ci>
     <apply>
      <minus></minus>
      <ci>a</ci>
      <ci>c</ci>
     </apply>
     <apply>
      <plus></plus>
      <ci>d</ci>
      <ci>b</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   l=\operatorname{gcd}(a-c,d+b)
  </annotation>
 </semantics>
</math>

</p>

<p>Applying the <a href="Brahmagupta–Fibonacci_identity" title="wikilink">Brahmagupta–Fibonacci identity</a> we get</p>

<p>

<math display="block" id="Euler's_factorization_method:30">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <msup>
        <mi>k</mi>
        <mn>2</mn>
       </msup>
       <mo>+</mo>
       <msup>
        <mi>h</mi>
        <mn>2</mn>
       </msup>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <msup>
        <mi>l</mi>
        <mn>2</mn>
       </msup>
       <mo>+</mo>
       <msup>
        <mi>m</mi>
        <mn>2</mn>
       </msup>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <msup>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mrow>
         <mi>k</mi>
         <mi>l</mi>
        </mrow>
        <mo>-</mo>
        <mrow>
         <mi>h</mi>
         <mi>m</mi>
        </mrow>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
      <mn>2</mn>
     </msup>
     <mo>+</mo>
     <msup>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mrow>
         <mi>k</mi>
         <mi>m</mi>
        </mrow>
        <mo>+</mo>
        <mrow>
         <mi>h</mi>
         <mi>l</mi>
        </mrow>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
      <mn>2</mn>
     </msup>
    </mrow>
    <mo>=</mo>
    <mrow>
     <msup>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <mi>a</mi>
          <mo>-</mo>
          <mi>c</mi>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
        <mo>-</mo>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <mi>a</mi>
          <mo>+</mo>
          <mi>c</mi>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
      <mn>2</mn>
     </msup>
     <mo>+</mo>
     <msup>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <mi>d</mi>
          <mo>-</mo>
          <mi>b</mi>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
        <mo>+</mo>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <mi>d</mi>
          <mo>+</mo>
          <mi>b</mi>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
      <mn>2</mn>
     </msup>
    </mrow>
    <mo>=</mo>
    <mrow>
     <msup>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mn>2</mn>
        <mi>c</mi>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
      <mn>2</mn>
     </msup>
     <mo>+</mo>
     <msup>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mn>2</mn>
        <mi>d</mi>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
      <mn>2</mn>
     </msup>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mn>4</mn>
     <mi>n</mi>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <times></times>
      <apply>
       <plus></plus>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>k</ci>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>h</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
      <apply>
       <plus></plus>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>l</ci>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>m</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
     </apply>
     <apply>
      <plus></plus>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <minus></minus>
        <apply>
         <times></times>
         <ci>k</ci>
         <ci>l</ci>
        </apply>
        <apply>
         <times></times>
         <ci>h</ci>
         <ci>m</ci>
        </apply>
       </apply>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <plus></plus>
        <apply>
         <times></times>
         <ci>k</ci>
         <ci>m</ci>
        </apply>
        <apply>
         <times></times>
         <ci>h</ci>
         <ci>l</ci>
        </apply>
       </apply>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <plus></plus>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <minus></minus>
        <apply>
         <minus></minus>
         <ci>a</ci>
         <ci>c</ci>
        </apply>
        <apply>
         <plus></plus>
         <ci>a</ci>
         <ci>c</ci>
        </apply>
       </apply>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <plus></plus>
        <apply>
         <minus></minus>
         <ci>d</ci>
         <ci>b</ci>
        </apply>
        <apply>
         <plus></plus>
         <ci>d</ci>
         <ci>b</ci>
        </apply>
       </apply>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <plus></plus>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <times></times>
        <cn type="integer">2</cn>
        <ci>c</ci>
       </apply>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <times></times>
        <cn type="integer">2</cn>
        <ci>d</ci>
       </apply>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <cn type="integer">4</cn>
      <ci>n</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (k^{2}+h^{2})(l^{2}+m^{2})=(kl-hm)^{2}+(km+hl)^{2}=((a-c)-(a+c))^{2}+((d-b)+(d%
+b))^{2}=(2c)^{2}+(2d)^{2}=4n,
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Euler's_factorization_method:31">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <msup>
        <mi>k</mi>
        <mn>2</mn>
       </msup>
       <mo>+</mo>
       <msup>
        <mi>h</mi>
        <mn>2</mn>
       </msup>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <msup>
        <mi>l</mi>
        <mn>2</mn>
       </msup>
       <mo>+</mo>
       <msup>
        <mi>m</mi>
        <mn>2</mn>
       </msup>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <msup>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mrow>
         <mi>k</mi>
         <mi>l</mi>
        </mrow>
        <mo>+</mo>
        <mrow>
         <mi>h</mi>
         <mi>m</mi>
        </mrow>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
      <mn>2</mn>
     </msup>
     <mo>+</mo>
     <msup>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mrow>
         <mi>k</mi>
         <mi>m</mi>
        </mrow>
        <mo>-</mo>
        <mrow>
         <mi>h</mi>
         <mi>l</mi>
        </mrow>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
      <mn>2</mn>
     </msup>
    </mrow>
    <mo>=</mo>
    <mrow>
     <msup>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <mi>a</mi>
          <mo>-</mo>
          <mi>c</mi>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
        <mo>+</mo>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <mi>a</mi>
          <mo>+</mo>
          <mi>c</mi>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
      <mn>2</mn>
     </msup>
     <mo>+</mo>
     <msup>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <mi>d</mi>
          <mo>-</mo>
          <mi>b</mi>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
        <mo>-</mo>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <mi>d</mi>
          <mo>+</mo>
          <mi>b</mi>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
      <mn>2</mn>
     </msup>
    </mrow>
    <mo>=</mo>
    <mrow>
     <msup>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mn>2</mn>
        <mi>a</mi>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
      <mn>2</mn>
     </msup>
     <mo>+</mo>
     <msup>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mn>2</mn>
        <mi>b</mi>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
      <mn>2</mn>
     </msup>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mn>4</mn>
     <mi>n</mi>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <times></times>
      <apply>
       <plus></plus>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>k</ci>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>h</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
      <apply>
       <plus></plus>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>l</ci>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>m</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
     </apply>
     <apply>
      <plus></plus>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <plus></plus>
        <apply>
         <times></times>
         <ci>k</ci>
         <ci>l</ci>
        </apply>
        <apply>
         <times></times>
         <ci>h</ci>
         <ci>m</ci>
        </apply>
       </apply>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <minus></minus>
        <apply>
         <times></times>
         <ci>k</ci>
         <ci>m</ci>
        </apply>
        <apply>
         <times></times>
         <ci>h</ci>
         <ci>l</ci>
        </apply>
       </apply>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <plus></plus>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <plus></plus>
        <apply>
         <minus></minus>
         <ci>a</ci>
         <ci>c</ci>
        </apply>
        <apply>
         <plus></plus>
         <ci>a</ci>
         <ci>c</ci>
        </apply>
       </apply>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <minus></minus>
        <apply>
         <minus></minus>
         <ci>d</ci>
         <ci>b</ci>
        </apply>
        <apply>
         <plus></plus>
         <ci>d</ci>
         <ci>b</ci>
        </apply>
       </apply>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <plus></plus>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <times></times>
        <cn type="integer">2</cn>
        <ci>a</ci>
       </apply>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <times></times>
        <cn type="integer">2</cn>
        <ci>b</ci>
       </apply>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <cn type="integer">4</cn>
      <ci>n</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (k^{2}+h^{2})(l^{2}+m^{2})=(kl+hm)^{2}+(km-hl)^{2}=((a-c)+(a+c))^{2}+((d-b)-(d%
+b))^{2}=(2a)^{2}+(2b)^{2}=4n.
  </annotation>
 </semantics>
</math>

</p>

<p>As each factor is a sum of two squares, one of these must contain both even numbers: either 

<math display="inline" id="Euler's_factorization_method:32">
 <semantics>
  <mrow>
   <mo stretchy="false">(</mo>
   <mi>k</mi>
   <mo>,</mo>
   <mi>h</mi>
   <mo stretchy="false">)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <interval closure="open">
    <ci>k</ci>
    <ci>h</ci>
   </interval>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (k,h)
  </annotation>
 </semantics>
</math>

 or 

<math display="inline" id="Euler's_factorization_method:33">
 <semantics>
  <mrow>
   <mo stretchy="false">(</mo>
   <mi>l</mi>
   <mo>,</mo>
   <mi>m</mi>
   <mo stretchy="false">)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <interval closure="open">
    <ci>l</ci>
    <ci>m</ci>
   </interval>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (l,m)
  </annotation>
 </semantics>
</math>


. Without loss of generality, assume that pair 

<math display="inline" id="Euler's_factorization_method:34">
 <semantics>
  <mrow>
   <mo stretchy="false">(</mo>
   <mi>k</mi>
   <mo>,</mo>
   <mi>h</mi>
   <mo stretchy="false">)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <interval closure="open">
    <ci>k</ci>
    <ci>h</ci>
   </interval>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (k,h)
  </annotation>
 </semantics>
</math>

 is even. The factorization then becomes</p>

<p>

<math display="block" id="Euler's_factorization_method:35">
 <semantics>
  <mrow>
   <mrow>
    <mi>n</mi>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <msup>
        <mrow>
         <mo stretchy="false">(</mo>
         <mstyle displaystyle="false">
          <mfrac>
           <mi>k</mi>
           <mn>2</mn>
          </mfrac>
         </mstyle>
         <mo stretchy="false">)</mo>
        </mrow>
        <mn>2</mn>
       </msup>
       <mo>+</mo>
       <msup>
        <mrow>
         <mo stretchy="false">(</mo>
         <mstyle displaystyle="false">
          <mfrac>
           <mi>h</mi>
           <mn>2</mn>
          </mfrac>
         </mstyle>
         <mo stretchy="false">)</mo>
        </mrow>
        <mn>2</mn>
       </msup>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <msup>
        <mi>l</mi>
        <mn>2</mn>
       </msup>
       <mo>+</mo>
       <msup>
        <mi>m</mi>
        <mn>2</mn>
       </msup>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>n</ci>
    <apply>
     <times></times>
     <apply>
      <plus></plus>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <divide></divide>
        <ci>k</ci>
        <cn type="integer">2</cn>
       </apply>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <divide></divide>
        <ci>h</ci>
        <cn type="integer">2</cn>
       </apply>
       <cn type="integer">2</cn>
      </apply>
     </apply>
     <apply>
      <plus></plus>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>l</ci>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>m</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n=((\tfrac{k}{2})^{2}+(\tfrac{h}{2})^{2})(l^{2}+m^{2}).\,
  </annotation>
 </semantics>
</math>

.</p>
<h2 id="worked-example">Worked example</h2>

<p>Since

<math display="block" id="Euler's_factorization_method:36">
 <semantics>
  <mrow>
   <mn>1000009</mn>
   <mo>=</mo>
   <mrow>
    <msup>
     <mn>1000</mn>
     <mn>2</mn>
    </msup>
    <mo>+</mo>
    <msup>
     <mn>3</mn>
     <mn>2</mn>
    </msup>
   </mrow>
   <mo>=</mo>
   <mrow>
    <msup>
     <mn>972</mn>
     <mn>2</mn>
    </msup>
    <mo>+</mo>
    <msup>
     <mn>235</mn>
     <mn>2</mn>
    </msup>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <cn type="float">1000009</cn>
     <apply>
      <plus></plus>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <cn type="integer">1000</cn>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <cn type="integer">3</cn>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <plus></plus>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <cn type="integer">972</cn>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <cn type="integer">235</cn>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \ 1000009=1000^{2}+3^{2}=972^{2}+235^{2}
  </annotation>
 </semantics>
</math>

</p>

<p>we have from the formula above:</p>
<table>
<tbody>
<tr class="odd">
<td style="text-align: left;">
<p><em>a</em> = 1000</p></td>
<td style="text-align: left;">
<p>(A) <em>a</em> − <em>c</em> = 28</p></td>
<td style="text-align: left;">
<p>gcd[A,C] <em>k</em> = 4</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p><em>b</em> = 3</p></td>
<td style="text-align: left;">
<p>(B) <em>a</em> + <em>c</em> = 1972</p></td>
<td style="text-align: left;">
<p>gcd[B,D] <em>h</em> = 34</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p><em>c</em> = 972</p></td>
<td style="text-align: left;">
<p>(C) <em>d</em> − <em>b</em> = 232</p></td>
<td style="text-align: left;">
<p><em>l</em> = 7</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p><em>d</em> = 235</p></td>
<td style="text-align: left;">
<p>(D) <em>d</em> + <em>b</em> = 238</p></td>
<td style="text-align: left;">
<p><em>m</em> = 58</p></td>
</tr>
</tbody>
</table>

<p>Thus,</p>

<p>

<math display="block" id="Euler's_factorization_method:37">
 <semantics>
  <mrow>
   <mn>1000009</mn>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mo>[</mo>
     <mrow>
      <msup>
       <mrow>
        <mo>(</mo>
        <mfrac>
         <mn>4</mn>
         <mn>2</mn>
        </mfrac>
        <mo>)</mo>
       </mrow>
       <mn>2</mn>
      </msup>
      <mo>+</mo>
      <msup>
       <mrow>
        <mo>(</mo>
        <mfrac>
         <mn>34</mn>
         <mn>2</mn>
        </mfrac>
        <mo>)</mo>
       </mrow>
       <mn>2</mn>
      </msup>
     </mrow>
     <mo>]</mo>
    </mrow>
    <mo>⋅</mo>
    <mrow>
     <mo>(</mo>
     <mrow>
      <msup>
       <mn>7</mn>
       <mn>2</mn>
      </msup>
      <mo>+</mo>
      <msup>
       <mn>58</mn>
       <mn>2</mn>
      </msup>
     </mrow>
     <mo rspace="4.2pt">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <cn type="integer">1000009</cn>
    <apply>
     <ci>normal-⋅</ci>
     <apply>
      <csymbol cd="latexml">delimited-[]</csymbol>
      <apply>
       <plus></plus>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <divide></divide>
         <cn type="integer">4</cn>
         <cn type="integer">2</cn>
        </apply>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <divide></divide>
         <cn type="integer">34</cn>
         <cn type="integer">2</cn>
        </apply>
        <cn type="integer">2</cn>
       </apply>
      </apply>
     </apply>
     <apply>
      <plus></plus>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <cn type="integer">7</cn>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <cn type="integer">58</cn>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   1000009=\left[\left(\frac{4}{2}\right)^{2}+\left(\frac{34}{2}\right)^{2}\right%
]\cdot\left(7^{2}+58^{2}\right)\,
  </annotation>
 </semantics>
</math>

</p>
<dl>
<dd><dl>
<dd>

<math display="inline" id="Euler's_factorization_method:38">
 <semantics>
  <mrow>
   <mi></mi>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mo>(</mo>
     <mrow>
      <msup>
       <mn>2</mn>
       <mn>2</mn>
      </msup>
      <mo>+</mo>
      <msup>
       <mn>17</mn>
       <mn>2</mn>
      </msup>
     </mrow>
     <mo>)</mo>
    </mrow>
    <mo>⋅</mo>
    <mrow>
     <mo>(</mo>
     <mrow>
      <msup>
       <mn>7</mn>
       <mn>2</mn>
      </msup>
      <mo>+</mo>
      <msup>
       <mn>58</mn>
       <mn>2</mn>
      </msup>
     </mrow>
     <mo rspace="4.2pt">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <csymbol cd="latexml">absent</csymbol>
    <apply>
     <ci>normal-⋅</ci>
     <apply>
      <plus></plus>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <cn type="integer">2</cn>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <cn type="integer">17</cn>
       <cn type="integer">2</cn>
      </apply>
     </apply>
     <apply>
      <plus></plus>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <cn type="integer">7</cn>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <cn type="integer">58</cn>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   =\left(2^{2}+17^{2}\right)\cdot\left(7^{2}+58^{2}\right)\,
  </annotation>
 </semantics>
</math>



</dd>
<dd>

<math display="inline" id="Euler's_factorization_method:39">
 <semantics>
  <mrow>
   <mi></mi>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mn>4</mn>
      <mo>+</mo>
      <mn>289</mn>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
    <mo>⋅</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mn>49</mn>
      <mo>+</mo>
      <mn>3364</mn>
     </mrow>
     <mo rspace="4.2pt" stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <csymbol cd="latexml">absent</csymbol>
    <apply>
     <ci>normal-⋅</ci>
     <apply>
      <plus></plus>
      <cn type="integer">4</cn>
      <cn type="integer">289</cn>
     </apply>
     <apply>
      <plus></plus>
      <cn type="integer">49</cn>
      <cn type="integer">3364</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   =(4+289)\cdot(49+3364)\,
  </annotation>
 </semantics>
</math>


</dd>
<dd>

<math display="inline" id="Euler's_factorization_method:40">
 <semantics>
  <mrow>
   <mi></mi>
   <mo>=</mo>
   <mrow>
    <mn>293</mn>
    <mo>⋅</mo>
    <mpadded width="+1.7pt">
     <mn>3413</mn>
    </mpadded>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <csymbol cd="latexml">absent</csymbol>
    <apply>
     <ci>normal-⋅</ci>
     <cn type="integer">293</cn>
     <cn type="integer">3413</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   =293\cdot 3413\,
  </annotation>
 </semantics>
</math>


</dd>
</dl>
</dd>
</dl>
<h2 id="references">References</h2>
<ul>
<li></li>
</ul>
<ul>
<li></li>
</ul>

<p>"</p>

<p><a href="Category:Integer_factorization_algorithms" title="wikilink">Euler's factorization method</a></p>
</body>
</html>

<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="1191">Chi-squared test</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Chi-squared test</h1>
<hr/>
<figure><b>(Figure)</b>
<figcaption><a href="Chi-square_distribution" title="wikilink">Chi-square distribution</a>, showing <em>X</em><sup>2</sup> on the x-axis and P-value on the y-axis.</figcaption>
</figure>

<p>A <strong>chi-squared test</strong>, also referred to as <strong>

<math display="inline" id="Chi-squared_test:0">
 <semantics>
  <msup>
   <mi>χ</mi>
   <mn>2</mn>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>χ</ci>
    <cn type="integer">2</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \chi^{2}
  </annotation>
 </semantics>
</math>

 test</strong> (or <strong>chi-square test</strong>), is any <a class="uri" href="statistical" title="wikilink">statistical</a> <a href="hypothesis_test" title="wikilink">hypothesis test</a> in which the <a href="sampling_distribution" title="wikilink">sampling distribution</a> of the test statistic is a <a href="chi-square_distribution" title="wikilink">chi-square distribution</a> when the <a href="null_hypothesis" title="wikilink">null hypothesis</a> is true. Chi-squared tests are often constructed from a <a href="Lack-of-fit_sum_of_squares#Sums_of_squares" title="wikilink">sum of squared errors</a>, or through the <a href="Variance#Distribution_of_the_sample_variance" title="wikilink">sample variance</a>. Test statistics that follow a chi-squared distribution arise from an assumption of independent normally distributed data, which is valid in many cases due to the <a href="central_limit_theorem" title="wikilink">central limit theorem</a>. A chi-squared test can then be used to reject the hypothesis that the data are independent.</p>

<p>Also considered a chi-square test is a test in which this is <em>asymptotically</em> true, meaning that the sampling distribution (if the null hypothesis is true) can be made to approximate a chi-square distribution as closely as desired by making the sample size large enough. The chi-squared test is used to determine whether there is a significant difference between the expected frequencies and the observed frequencies in one or more categories. Does the number of individuals or objects that fall in each category differ significantly from the number you would expect? Is this difference between the expected and observed due to sampling variation, or is it a real difference?</p>
<h2 id="examples-of-chi-square-tests-with-samples">Examples of chi-square tests with samples</h2>

<p>One <a href="test_statistic" title="wikilink">test statistic</a> that follows a <a href="chi-square_distribution" title="wikilink">chi-square distribution</a> exactly is the test that the variance of a normally distributed population has a given value based on a <a href="sample_variance" title="wikilink">sample variance</a>. Such tests are uncommon in practice because the true variance of the population is usually unknown. However, there are several statistical tests where the <a href="chi-square_distribution" title="wikilink">chi-square distribution</a> is approximately valid:</p>
<h3 id="pearsons-chi-square-test">Pearson's chi-square test</h3>

<p><a href="Pearson's_chi-square_test" title="wikilink">Pearson's chi-square test</a>, also known as the chi-square goodness-of-fit test or chi-square test for independence. When the chi-square test is mentioned without any modifiers or without other precluding context, this test is often meant (for an exact test used in place of 

<math display="inline" id="Chi-squared_test:1">
 <semantics>
  <msup>
   <mi>χ</mi>
   <mn>2</mn>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>χ</ci>
    <cn type="integer">2</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \chi^{2}
  </annotation>
 </semantics>
</math>

, see <a href="Fisher's_exact_test" title="wikilink">Fisher's exact test</a>).</p>
<h3 id="yatess-correction-for-continuity">Yates's correction for continuity</h3>

<p>Using the <a href="chi-square_distribution" title="wikilink">chi-square distribution</a> to interpret <a href="Pearson's_chi-square_test" title="wikilink">Pearson's chi-square statistic</a> requires one to assume that the <a href="Discrete_probability_distribution" title="wikilink">discrete</a> probability of observed <a href="binomial_distribution" title="wikilink">binomial frequencies</a> in the table can be approximated by the continuous <a href="chi-square_distribution" title="wikilink">chi-square distribution</a>. This assumption is not quite correct, and introduces some error.</p>

<p>To reduce the error in approximation, <a href="Frank_Yates" title="wikilink">Frank Yates</a> suggested a correction for continuity that adjusts the formula for <a href="Pearson's_chi-square_test" title="wikilink">Pearson's chi-square test</a> by subtracting 0.5 from the difference between each observed value and its expected value in a 2 × 2 contingency table.<a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a> This reduces the chi-square value obtained and thus increases its <a class="uri" href="p-value" title="wikilink">p-value</a>.</p>
<h3 id="other-chi-square-tests">Other chi-square tests</h3>
<ul>
<li><a href="Cochran–Mantel–Haenszel_statistics" title="wikilink">Cochran–Mantel–Haenszel chi-squared test</a>.</li>
<li><a href="McNemar's_test" title="wikilink">McNemar's test</a>, used in certain 2 × 2 tables with pairing</li>
<li><a href="Tukey's_test_of_additivity" title="wikilink">Tukey's test of additivity</a></li>
<li>The <a href="portmanteau_test" title="wikilink">portmanteau test</a> in <a href="time-series_analysis" title="wikilink">time-series analysis</a>, testing for the presence of <a class="uri" href="autocorrelation" title="wikilink">autocorrelation</a></li>
<li><a href="Likelihood-ratio_test" title="wikilink">Likelihood-ratio tests</a> in general statistical modelling, for testing whether there is evidence of the need to move from a simple model to a more complicated one (where the simple model is nested within the complicated one).</li>
</ul>
<h2 id="chi-squared-test-for-variance-in-a-normal-population">Chi-squared test for variance in a normal population</h2>

<p>If a sample of size <em>n</em> is taken from a population having a <a href="normal_distribution" title="wikilink">normal distribution</a>, then there is a result (see <a href="Variance#Distribution_of_the_sample_variance" title="wikilink">distribution of the sample variance</a>) which allows a test to be made of whether the variance of the population has a pre-determined value. For example, a manufacturing process might have been in stable condition for a long period, allowing a value for the variance to be determined essentially without error. Suppose that a variant of the process is being tested, giving rise to a small sample of <em>n</em> product items whose variation is to be tested. The test statistic <em>T</em> in this instance could be set to be the sum of squares about the sample mean, divided by the nominal value for the variance (i.e. the value to be tested as holding). Then <em>T</em> has a chi-square distribution with <em>n</em> − 1 <a href="Degrees_of_freedom_(statistics)" title="wikilink">degrees of freedom</a>. For example if the sample size is 21, the acceptance region for <em>T</em> for a significance level of 5% is the interval 9.59 to 34.17.</p>
<h2 id="example-chi-squared-test-for-categorical-data">Example chi-squared test for categorical data</h2>

<p>Suppose there is a city of 1 million residents with four neighborhoods: A, B, C, and D. A random sample of 650 residents of the city is taken and their occupation is recorded as "blue collar", "white collar", or "service". The null hypothesis is that each person's neighborhood of residence is independent of the person's occupational classification. The data are tabulated as:</p>

<p>

<math display="block" id="Chi-squared_test:2">
 <semantics>
  <mtable displaystyle="true">
   <mtr>
    <mtd class="ltx_border_r">
    </mtd>
    <mtd class="ltx_border_r" columnalign="center">
     <mtext>A</mtext>
    </mtd>
    <mtd class="ltx_border_r" columnalign="center">
     <mtext>B</mtext>
    </mtd>
    <mtd class="ltx_border_r" columnalign="center">
     <mtext>C</mtext>
    </mtd>
    <mtd class="ltx_border_r" columnalign="center">
     <mtext>D</mtext>
    </mtd>
    <mtd class="ltx_border_r">
    </mtd>
    <mtd columnalign="center">
     <mtext>total</mtext>
    </mtd>
   </mtr>
   <mtr>
    <mtd class="ltx_border_r ltx_border_t" columnalign="left">
     <mtext>Blue collar</mtext>
    </mtd>
    <mtd class="ltx_border_r ltx_border_t" columnalign="center">
     <mn>90</mn>
    </mtd>
    <mtd class="ltx_border_r ltx_border_t" columnalign="center">
     <mn>60</mn>
    </mtd>
    <mtd class="ltx_border_r ltx_border_t" columnalign="center">
     <mn>104</mn>
    </mtd>
    <mtd class="ltx_border_r ltx_border_t" columnalign="center">
     <mn>95</mn>
    </mtd>
    <mtd class="ltx_border_r ltx_border_t">
    </mtd>
    <mtd class="ltx_border_t" columnalign="center">
     <mn>349</mn>
    </mtd>
   </mtr>
   <mtr>
    <mtd class="ltx_border_r ltx_border_t" columnalign="left">
     <mtext>White collar</mtext>
    </mtd>
    <mtd class="ltx_border_r ltx_border_t" columnalign="center">
     <mn>30</mn>
    </mtd>
    <mtd class="ltx_border_r ltx_border_t" columnalign="center">
     <mn>50</mn>
    </mtd>
    <mtd class="ltx_border_r ltx_border_t" columnalign="center">
     <mn>51</mn>
    </mtd>
    <mtd class="ltx_border_r ltx_border_t" columnalign="center">
     <mn>20</mn>
    </mtd>
    <mtd class="ltx_border_r ltx_border_t">
    </mtd>
    <mtd class="ltx_border_t" columnalign="center">
     <mn>151</mn>
    </mtd>
   </mtr>
   <mtr>
    <mtd class="ltx_border_r ltx_border_t" columnalign="left">
     <mtext>Service</mtext>
    </mtd>
    <mtd class="ltx_border_r ltx_border_t" columnalign="center">
     <mn>30</mn>
    </mtd>
    <mtd class="ltx_border_r ltx_border_t" columnalign="center">
     <mn>40</mn>
    </mtd>
    <mtd class="ltx_border_r ltx_border_t" columnalign="center">
     <mn>45</mn>
    </mtd>
    <mtd class="ltx_border_r ltx_border_t" columnalign="center">
     <mn>35</mn>
    </mtd>
    <mtd class="ltx_border_r ltx_border_t">
    </mtd>
    <mtd class="ltx_border_t" columnalign="center">
     <mn>150</mn>
    </mtd>
   </mtr>
   <mtr>
    <mtd class="ltx_border_r ltx_border_t" columnalign="left">
     <mtext>total</mtext>
    </mtd>
    <mtd class="ltx_border_r ltx_border_t" columnalign="center">
     <mn>150</mn>
    </mtd>
    <mtd class="ltx_border_r ltx_border_t" columnalign="center">
     <mn>150</mn>
    </mtd>
    <mtd class="ltx_border_r ltx_border_t" columnalign="center">
     <mn>200</mn>
    </mtd>
    <mtd class="ltx_border_r ltx_border_t" columnalign="center">
     <mn>150</mn>
    </mtd>
    <mtd class="ltx_border_r ltx_border_t">
    </mtd>
    <mtd class="ltx_border_t" columnalign="center">
     <mn>650</mn>
    </mtd>
   </mtr>
  </mtable>
  <annotation-xml encoding="MathML-Content">
   <matrix>
    <matrixrow>
     <cerror>
      <csymbol cd="ambiguous">missing-subexpression</csymbol>
     </cerror>
     <mtext>A</mtext>
     <mtext>B</mtext>
     <mtext>C</mtext>
     <mtext>D</mtext>
     <cerror>
      <csymbol cd="ambiguous">missing-subexpression</csymbol>
     </cerror>
     <mtext>total</mtext>
    </matrixrow>
    <matrixrow>
     <mtext>Blue collar</mtext>
     <cn type="integer">90</cn>
     <cn type="integer">60</cn>
     <cn type="integer">104</cn>
     <cn type="integer">95</cn>
     <cerror>
      <csymbol cd="ambiguous">missing-subexpression</csymbol>
     </cerror>
     <cn type="integer">349</cn>
    </matrixrow>
    <matrixrow>
     <mtext>White collar</mtext>
     <cn type="integer">30</cn>
     <cn type="integer">50</cn>
     <cn type="integer">51</cn>
     <cn type="integer">20</cn>
     <cerror>
      <csymbol cd="ambiguous">missing-subexpression</csymbol>
     </cerror>
     <cn type="integer">151</cn>
    </matrixrow>
    <matrixrow>
     <mtext>Service</mtext>
     <cn type="integer">30</cn>
     <cn type="integer">40</cn>
     <cn type="integer">45</cn>
     <cn type="integer">35</cn>
     <cerror>
      <csymbol cd="ambiguous">missing-subexpression</csymbol>
     </cerror>
     <cn type="integer">150</cn>
    </matrixrow>
    <matrixrow>
     <mtext>total</mtext>
     <cn type="integer">150</cn>
     <cn type="integer">150</cn>
     <cn type="integer">200</cn>
     <cn type="integer">150</cn>
     <cerror>
      <csymbol cd="ambiguous">missing-subexpression</csymbol>
     </cerror>
     <cn type="integer">650</cn>
    </matrixrow>
   </matrix>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \begin{array}[]{l|c|c|c|c|c|c}&\text{A}&\text{B}&\text{C}&\text{D}&&\text{%
total}\\
\hline\text{Blue collar}&90&60&104&95&&349\\
\hline\text{White collar}&30&50&51&20&&151\\
\hline\text{Service}&30&40&45&35&&150\\
\hline\text{total}&150&150&200&150&&650\end{array}
  </annotation>
 </semantics>
</math>

</p>

<p>Let us take the sample living in neighborhood A, 150/650, to estimate what proportion of the whole 1 million people live in neighborhood A. Similarly we take 349/650 to estimate what proportion of the 1 million people are blue-collar workers. By the assumption of independence under the hypothesis we should "expect" the number of blue-collar workers in neighborhood A to be</p>

<p>

<math display="block" id="Chi-squared_test:3">
 <semantics>
  <mrow>
   <mrow>
    <mfrac>
     <mn>150</mn>
     <mn>650</mn>
    </mfrac>
    <mo>×</mo>
    <mfrac>
     <mn>349</mn>
     <mn>650</mn>
    </mfrac>
    <mo>×</mo>
    <mn>650</mn>
   </mrow>
   <mo>≈</mo>
   <mn>80.54.</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <approx></approx>
    <apply>
     <times></times>
     <apply>
      <divide></divide>
      <cn type="integer">150</cn>
      <cn type="integer">650</cn>
     </apply>
     <apply>
      <divide></divide>
      <cn type="integer">349</cn>
      <cn type="integer">650</cn>
     </apply>
     <cn type="integer">650</cn>
    </apply>
    <cn type="float">80.54.</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \frac{150}{650}\times\frac{349}{650}\times 650\approx 80.54.
  </annotation>
 </semantics>
</math>

</p>

<p>Then in that "cell" of the table, we have</p>

<p>

<math display="block" id="Chi-squared_test:4">
 <semantics>
  <mrow>
   <mrow>
    <mfrac>
     <msup>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mtext>observed</mtext>
        <mo>-</mo>
        <mtext>expected</mtext>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
      <mn>2</mn>
     </msup>
     <mtext>expected</mtext>
    </mfrac>
    <mo>=</mo>
    <mfrac>
     <msup>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mn>90</mn>
        <mo>-</mo>
        <mn>80.54</mn>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
      <mn>2</mn>
     </msup>
     <mn>80.54</mn>
    </mfrac>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <divide></divide>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <minus></minus>
       <mtext>observed</mtext>
       <mtext>expected</mtext>
      </apply>
      <cn type="integer">2</cn>
     </apply>
     <mtext>expected</mtext>
    </apply>
    <apply>
     <divide></divide>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <minus></minus>
       <cn type="integer">90</cn>
       <cn type="float">80.54</cn>
      </apply>
      <cn type="integer">2</cn>
     </apply>
     <cn type="float">80.54</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \frac{(\text{observed}-\text{expected})^{2}}{\text{expected}}=\frac{(90-80.54)%
^{2}}{80.54}.
  </annotation>
 </semantics>
</math>

</p>

<p>The sum of these quantities over all of the cells is the test statistic. Under the null hypothesis, it has approximately a chi-square distribution whose number of degrees of freedom are</p>

<p>

<math display="block" id="Chi-squared_test:5">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mtext>number of rows</mtext>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mtext>number of columns</mtext>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mn>3</mn>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mn>4</mn>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mpadded width="+1.7pt">
    <mn>6.</mn>
   </mpadded>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <times></times>
      <apply>
       <minus></minus>
       <mtext>number of rows</mtext>
       <cn type="integer">1</cn>
      </apply>
      <apply>
       <minus></minus>
       <mtext>number of columns</mtext>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <minus></minus>
       <cn type="integer">3</cn>
       <cn type="integer">1</cn>
      </apply>
      <apply>
       <minus></minus>
       <cn type="integer">4</cn>
       <cn type="integer">1</cn>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <cn type="float">6.</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (\text{number of rows}-1)(\text{number of columns}-1)=(3-1)(4-1)=6.\,
  </annotation>
 </semantics>
</math>

</p>

<p>If the test statistic is improbably large according to that chi-square distribution, then one rejects the null hypothesis of <strong>independence</strong>.</p>

<p>A related issue is a test of <strong>homogeneity</strong>. Suppose that instead of giving every resident of each of the four neighborhoods an equal chance of inclusion in the sample, we decide in advance how many residents of each neighborhood to include. Then each resident has the same chance of being chosen as do all residents of the same neighborhood, but residents of different neighborhoods would have different probabilities of being chosen if the four sample sizes are not proportional to the populations of the four neighborhoods. In such a case, we would be testing "homogeneity" rather than "independence". The question is whether the proportions of blue-collar, white-collar, and service workers in the four neighborhoods are the same. However, the test is done in the same way.</p>
<h2 id="applications">Applications</h2>

<p>In <a class="uri" href="cryptanalysis" title="wikilink">cryptanalysis</a>, chi-square test is used to compare the distribution of <a class="uri" href="plaintext" title="wikilink">plaintext</a> and (possibly) decrypted <a class="uri" href="ciphertext" title="wikilink">ciphertext</a>. The lowest value of the test means that the decryption was successful with high probability.<a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a><a class="footnoteRef" href="#fn3" id="fnref3"><sup>3</sup></a> This method can be generalized for solving modern cryptographic problems.<a class="footnoteRef" href="#fn4" id="fnref4"><sup>4</sup></a></p>
<h2 id="see-also">See also</h2>
<ul>
<li><a href="Nomogram#Chi-square_test_computation_nomogram" title="wikilink">Chi-square test nomogram</a></li>
<li><a href="G-test" title="wikilink"><em>G</em>-test</a></li>
<li><a href="Minimum_chi-square_estimation" title="wikilink">Minimum chi-square estimation</a></li>
<li>The <a href="Wald_test" title="wikilink">Wald test</a> can be evaluated against a chi-square distribution.</li>
</ul>
<h2 id="references">References</h2>
<ul>
<li></li>
<li>Corder, G.W. &amp; Foreman, D.I. (2014).'' Nonparametric Statistics: A Step-by-Step Approach''. Wiley, New York. ISBN 978-1118840313</li>
<li>Greenwood, P.E., Nikulin, M.S. (1996) <em>A guide to chi-squared testing</em>. Wiley, New York. ISBN 0-471-55779-X</li>
<li>Nikulin, M.S. (1973). "Chi-squared test for normality". In: <em>Proceedings of the International Vilnius Conference on Probability Theory and Mathematical Statistics</em>, v.2, pp. 119–122.</li>
<li>Bagdonavicius, V., Nikulin, M.S. (2011) "Chi-squared goodness-of-fit test for right censored data". <em>The International Journal of Applied Mathematics and Statistics</em>, p. 30-50.</li>
</ul>

<p>"</p>

<p><a href="Category:Statistical_tests" title="wikilink">Category:Statistical tests</a> <a href="Category:Non-parametric_statistics" title="wikilink">Category:Non-parametric statistics</a> <a href="Category:Categorical_data" title="wikilink">Category:Categorical data</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1"><a href="Frank_Yates" title="wikilink">Yates, F</a> (1934). "Contingency table involving small numbers and the χ<sup>2</sup> test". <em>Supplement to the <a href="Journal_of_the_Royal_Statistical_Society" title="wikilink">Journal of the Royal Statistical Society</a></em> <strong>1</strong>(2): 217–235. <a href="#fnref1">↩</a></li>
<li id="fn2"><a href="#fnref2">↩</a></li>
<li id="fn3"><a href="#fnref3">↩</a></li>
<li id="fn4"><a href="#fnref4">↩</a></li>
</ol>
</section>
</body>
</html>

<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title offset="1497">Sipser–Lautemann theorem</title>
   <script type="text/javascript"
      src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js">
    </script>
</head>
<body>
<h1>Sipser–Lautemann theorem</h1>
<hr/>
<p>In <a href="computational_complexity_theory" title="wikilink">computational complexity theory</a>, the <strong>Sipser–Lautemann theorem</strong> or <strong>Sipser–Gács–Lautemann theorem</strong> states that <a href="Bounded-error_probabilistic_polynomial" title="wikilink">Bounded-error Probabilistic Polynomial</a> (BPP) time, is contained in the <a href="Polynomial_hierarchy" title="wikilink">polynomial time hierarchy</a>, and more specifically Σ<sub>2</sub> ∩ Π<sub>2</sub>.</p>
<p>In 1983, <a href="Michael_Sipser" title="wikilink">Michael Sipser</a> showed that BPP is contained in the <a href="Polynomial_hierarchy" title="wikilink">polynomial time hierarchy</a>.<a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a> <a href="Péter_Gács" title="wikilink">Péter Gács</a> showed that BPP is actually contained in Σ<sub>2</sub> ∩ Π<sub>2</sub>. <a href="Clemens_Lautemann" title="wikilink">Clemens Lautemann</a> contributed by giving a simple proof of BPP’s membership in Σ<sub>2</sub> ∩ Π<sub>2</sub>, also in 1983.<a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a> It is conjectured that in fact BPP=<a href="P_(complexity)" title="wikilink">P</a>, which is a much stronger statement than the Sipser–Lautemann theorem.</p>
<h2 id="proof">Proof</h2>
<p>Here we present the Lautemann's proof,<a class="footnoteRef" href="#fn3" id="fnref3"><sup>3</sup></a> distinguishing the parts that are about containment in polynomial hierarchy and containment in Σ<sub>2</sub>.</p>
<h3 id="bpp-containment-in-polynomial-hierarchy">BPP containment in polynomial hierarchy</h3>
<p>This part is what Michael Sipser first proved.<a class="footnoteRef" href="#fn4" id="fnref4"><sup>4</sup></a> Without loss of generality, a machine <em>M</em> ∈ BPP with error ≤ 2<sup>-|<em>x</em>|</sup> can be chosen. (All BPP problems can be amplified to reduce the error probability exponentially.) The basic idea of the proof is to define a Σ<sub>2</sub> ∩ Π<sub>2</sub> sentence that is equivalent to stating that <em>x</em> is in the language, <em>L</em>, defined by <em>M</em> by using a set of transforms of the random variable inputs.</p>
<p>Since the output of <em>M</em> depends on random input, as well as the input <em>x</em>, it is useful to define which random strings produce the correct output as <em>A</em>(<em>x</em>) = {<em>r</em> | <em>M</em>(<em>x</em>,<em>r</em>) accepts}. The key to the proof is to note that when <em>x</em> ∈ <em>L</em>, <em>A</em>(<em>x</em>) is very large and when <em>x</em> ∉ <em>L</em>, <em>A</em>(<em>x</em>) is very small. By using <a href="Exclusive_disjunction" title="wikilink">bitwise parity</a>, ⊕, a set of transforms can be defined as <em>A</em>(<em>x</em>) ⊕ <em>t</em>={<em>r</em> ⊕ <em>t</em> | <em>r</em> ∈ <em>A</em>(<em>x</em>)}. The first main lemma of the proof shows that the union of a small finite number of these transforms will contain the entire space of random input strings. Using this fact, a Σ<sub>2</sub> sentence and a Π<sub>2</sub> sentence can be generated that is true if and only if <em>x</em> ∈ <em>L</em> (see corollary).</p>
<h4 id="lemma-1">Lemma 1</h4>
<p>The general idea of lemma one is to prove that if <em>A</em>(<em>x</em>) covers a large part of the random space <span class="LaTeX">$R= \{ 1,0 \} ^ {|r|}$</span> then there exists a small set of translations that will cover the entire random space. In more mathematical language:</p>
<dl>
<dd><em>If</em> <span class="LaTeX">$\frac{|A(x)|}{|R|} > 1 - \frac{1}{2^{|x|}}$</span>, <em>then</em> <span class="LaTeX">$\exists  t_1,t_2,\ldots,t_{|r|}$</span>, <em>where</em> <span class="LaTeX">$t_i \in \{ 1,0 \} ^{|r|} \$</span> <em>such that</em> <span class="LaTeX">$\bigcup_i A(x) \oplus t_i = R.$</span>
</dd>
</dl>
<p><strong>Proof.</strong> Randomly pick <em>t</em><sub>1</sub>, <em>t</em><sub>2</sub>, ..., <em>t</em><sub>|<em>r</em>|</sub>. Let <span class="LaTeX">$S=\bigcup_i A(x)\oplus t_i$</span> (the union of all transforms of <em>A</em>(<em>x</em>)).</p>
<p>So, for all <em>r</em> in <em>R</em>,</p>
<p><span class="LaTeX">$$\Pr [r \notin S] = \Pr [r \notin A(x) \oplus t_1] \cdot \Pr [r \notin A(x) \oplus t_2] \cdots \Pr [r \notin A(x) \oplus t_{|r|}] \le { \frac{1}{2^{|x| \cdot |r|}} }.$$</span></p>
<p>The probability that there will exist at least one element in <em>R</em> not in <em>S</em> is</p>
<p><span class="LaTeX">$$\Pr \Bigl[ \bigvee_i (r_i \notin S)\Bigr] \le \sum_i \frac{1}{2^{|x| \cdot |r|}} = \frac{1}{2^{|x|}} < 1.$$</span></p>
<p>Therefore</p>
<p><span class="LaTeX">$$\Pr [S = R] \ge 1 - \frac{1}{2^{|x|}}.$$</span></p>
<p>Thus there is a selection for each <span class="LaTeX">$t_1,t_2,\ldots,t_{|r|}$</span> such that</p>
<p><span class="LaTeX">$$\bigcup_i A(x) \oplus t_i = R.$$</span></p>
<h4 id="lemma-2">Lemma 2</h4>
<p>The previous lemma shows that <em>A</em>(<em>x</em>) can cover every possible point in the space using a small set of translations. Complementary to this, for <em>x</em> ∉ <em>L</em> only a small fraction of the space is covered by <em>A</em>(<em>x</em>). Therefore the set of random strings causing <em>M</em>(<em>x</em>,<em>r</em>) to accept cannot be generated by a small set of vectors <em>t<sub>i</sub></em>.</p>
<p><span class="LaTeX">$$R = \bigcup_i A(x) \oplus t_i$$</span></p>
<p><em>R</em> is the set of all accepting random strings, exclusive-or'd with vectors <em>t<sub>i</sub></em>.</p>
<p><span class="LaTeX">$$\frac{|A(x)|}{|R|} \le  \frac{1}{2^{|k|}} \implies \neg \exists t_1,t_2,\dots,t_{r}$$</span></p>
<h4 id="corollary">Corollary</h4>
<p>An important corollary of the lemmas shows that the result of the proof can be expressed as a Σ<sub>2</sub> expression, as follows.</p>
<p><span class="LaTeX">$$x \in L \iff \exists t_1,t_2,\dots,t_{|r|}\, \forall r \in R \bigvee_{ 1 \le i \le |r|} (M(x, r \oplus t_i) \text{ accepts}).$$</span></p>
<p>That is, <em>x</em> is in language <em>L</em> if and only if there exist |<em>r</em>| binary vectors, where for all random bit vectors <em>r</em>, TM <em>M</em> accepts at least one random vector ⊕ <em>t<sub>i</sub></em>.</p>
<p>The above expression is in <a href="Polynomial_hierarchy" title="wikilink">Σ<sub>2</sub></a> in that it is first existentially then universally quantified. Therefore BPP ⊆ Σ<sub>2</sub>. Because BPP is closed under <a href="Complement_(complexity)" title="wikilink">complement</a>, this proves BPP ⊆ Σ<sub>2</sub> ∩ Π<sub>2</sub></p>
<h3 id="bpp-containment-in-σ2">BPP containment in Σ<sub>2</sub></h3>
<p>This part is Lautemann's contribution to the theorem.</p>
<h4 id="lemma-3">Lemma 3</h4>
<p>Based on the definition of BPP we show the following:</p>
<p>If <em>L</em> is in BPP then there is an algorithm <em>A</em> such that for every <em>x</em>,</p>
<p><span class="LaTeX">$${\rm Pr}_r(A(x,r) = \mbox{right answer}) \ge 1 - \frac{1}{3m},$$</span></p>
<p>where <em>m</em> is the number of random bits <span class="LaTeX">$|r| = m = |x|^{O(1)}$</span> and <em>A</em> runs in time <span class="LaTeX">$|x|^{O(1)}$</span>.</p>
<p><strong>Proof:</strong> Let <em>A{{'}}</em> be a BPP algorithm for <em>L</em>. For every <em>x</em>, <span class="LaTeX">$\Pr_r(A'(x,r) = \mbox{wrong answer}) \le 1/3$</span>. <em>A{{'}}</em> uses <em>m{{'}}</em>(<em>n</em>) random bits where <em>n</em> = |<em>x</em>|. Do <em>k</em>(<em>n</em>) repetitions of <em>A{{'}}</em> and accept if and only if at least <em>k</em>(<em>n</em>)/2 executions of <em>A{{'}}</em> accept. Define this new algorithm as <em>A</em>. So <em>A</em> uses <em>k</em>(<em>n</em>)<em>m{{'}}</em>(<em>n</em>) random bits and</p>
<p><span class="LaTeX">$${\rm Pr}_r(A(x,r) = \mbox{wrong answer}) \le 2^{-ck(n)}.$$</span> We can then find <em>k</em>(<em>n</em>) with <span class="LaTeX">$k(n)=\Theta (\log m'(n))$</span> such that</p>
<p><span class="LaTeX">$$\frac{1}{2^{ck(n)}} \le \frac{1}{3k(n)m'(n)}.$$</span></p>
<h4 id="theorem-1">Theorem 1</h4>
<p><strong>Proof:</strong> Let <em>L</em> be in BPP and <em>A</em> as in Lemma 3. We want to show</p>
<p><span class="LaTeX">$$x \in L \iff \exists y_1,\dots,y_m \in \{0,1\}^m\, \forall z \in \{0,1\}^m \bigvee_{i=1}^mA(x,y_i \oplus z)=1.$$</span></p>
<p>where <em>m</em> is the number of random bits used by <em>A</em> on input <em>x</em>. Given <span class="LaTeX">$x \in L$</span>, then</p>
<p><span class="LaTeX">$$\begin{align}
  {\rm Pr}_{y_1,\dots,y_m}(\exists z& A(x,y_1 \oplus z)=\dots=A(x,y_m \oplus z)=0)\\
      &\le \sum_{z \in \{0,1\}^m} {\rm Pr}_{y_1,\dots,y_m}(A(x,y_1 \oplus z) = \dots = A( x, y_m \oplus z) = 0)\\
      &\le 2^m \frac{1}{(3m)^m}\\
      &< 1.
\end{align}$$</span></p>
<p>Thus</p>
<p><span class="LaTeX">$${\rm Pr}_{y_1,\dots,y_m}\Bigl( \forall z \bigvee_i A(x,y_i \oplus z)\Bigr)=1 - {\rm Pr}_{y_1,...,y_m}(\exists z A(x,y_1 \oplus z)=\dots=A(x,y_m \oplus z)=0).$$</span></p>
<p>Thus <span class="LaTeX">$(y_1,\dots,y_m)$</span> exists.</p>
<p>Conversely, suppose <span class="LaTeX">$x \notin L$</span>. Then</p>
<p><span class="LaTeX">${\rm Pr}_z \Bigl( \bigvee_i A(x,y_i \oplus z) \Bigr) \le \sum_i {\rm Pr}_z (A(x,y_i \oplus z)=1)\le m \frac{1}{3m}= \frac{1}{3}.$</span></p>
<p>Thus</p>
<p><span class="LaTeX">$${\rm Pr}_z(A(x,y_1 \oplus z)=\dots=A(x,y_m \oplus z)=0)= 1 - {\rm Pr}_z \Bigl( \bigvee_i A(x,y_i \oplus z) \Bigr)\ge \frac{2}{3} > 0.$$</span></p>
<p>Thus there is a <em>z</em> such that <span class="LaTeX">$\bigvee_i A(x,y_i \oplus z)=0$</span> for all <span class="LaTeX">$y_1,...,y_m \in \{0,1\}^m.$</span></p>
<h2 id="stronger-version">Stronger version</h2>
<p>The theorem can be strengthened to <span class="LaTeX">$\mathsf{BPP} \subseteq \mathsf{MA} \subseteq \mathsf{S}_2^P \subseteq \Sigma_2 \cap \Pi_2$</span> (see <a href="MA_(complexity)" title="wikilink">MA</a>, <a href="S2P_(complexity)" title="wikilink">S</a>).<a class="footnoteRef" href="#fn5" id="fnref5"><sup>5</sup></a><a class="footnoteRef" href="#fn6" id="fnref6"><sup>6</sup></a></p>
<h2 id="references">References</h2>
<references>
</references>
<p>"</p>
<p><a href="Category:Structural_complexity_theory" title="wikilink">Category:Structural complexity theory</a> <a href="Category:Probabilistic_complexity_theory" title="wikilink">Category:Probabilistic complexity theory</a> <a href="Category:Theorems_in_computational_complexity_theory" title="wikilink">Category:Theorems in computational complexity theory</a> <a href="Category:Articles_containing_proofs" title="wikilink">Category:Articles containing proofs</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1"><a href="#fnref1">↩</a></li>
<li id="fn2"><a href="#fnref2">↩</a></li>
<li id="fn3"></li>
<li id="fn4"></li>
<li id="fn5"><a href="#fnref5">↩</a></li>
<li id="fn6"><a href="#fnref6">↩</a></li>
</ol>
</section>
</body>
</html>

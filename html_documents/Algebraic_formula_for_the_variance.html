<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="1931">Algebraic formula for the variance</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Algebraic formula for the variance</h1>
<hr/>

<p>In <a href="probability_theory" title="wikilink">probability theory</a> and <a class="uri" href="statistics" title="wikilink">statistics</a>, there are several <strong>algebraic formulae for the variance</strong> available for deriving the <a class="uri" href="variance" title="wikilink">variance</a> of a <a href="random_variable" title="wikilink">random variable</a>. The usefulness of these depends on what is already known about the random variable; for example a random variable may be defined in terms of its <a href="probability_density_function" title="wikilink">probability density function</a> or by construction from other random variables. The context here is that of deriving algebraic expressions for the theoretical variance of a random variable, in contrast to questions of estimating the variance of a <a href="statistical_population" title="wikilink">population</a> from sample data for which there are special considerations in implementing <a href="Algorithms_for_calculating_variance" title="wikilink">computational algorithms</a>.</p>
<h2 id="in-terms-of-raw-moments">In terms of raw moments</h2>

<p>If the raw moments E(<em>X</em>) and E(<em>X</em> <sup>2</sup>) of a <a href="random_variable" title="wikilink">random variable</a> <em>X</em> are known (where E(<em>X</em>) is the <a href="expected_value" title="wikilink">expected value</a> of <em>X</em>), then Var(<em>X</em>) is given by</p>

<p>

<math display="block" id="Algebraic_formula_for_the_variance:0">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mo>Var</mo>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>X</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mo>E</mo>
      <mrow>
       <mo stretchy="false">(</mo>
       <msup>
        <mi>X</mi>
        <mn>2</mn>
       </msup>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo>-</mo>
     <msup>
      <mrow>
       <mo stretchy="false">[</mo>
       <mrow>
        <mo>E</mo>
        <mrow>
         <mo stretchy="false">(</mo>
         <mi>X</mi>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
       <mo stretchy="false">]</mo>
      </mrow>
      <mn>2</mn>
     </msup>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <ci>Var</ci>
     <ci>X</ci>
    </apply>
    <apply>
     <minus></minus>
     <apply>
      <ci>normal-E</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>X</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="latexml">delimited-[]</csymbol>
       <apply>
        <ci>normal-E</ci>
        <ci>X</ci>
       </apply>
      </apply>
      <cn type="integer">2</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \operatorname{Var}(X)=\operatorname{E}(X^{2})-[\operatorname{E}(X)]^{2}.
  </annotation>
 </semantics>
</math>

</p>

<p>The result is called the <a href="Johann_Samuel_K√∂nig" title="wikilink">K√∂nig</a>‚Äì<a href="Christiaan_Huygens" title="wikilink">Huygens</a> formula in French-language literature<a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a> and known as <a href="Jakob_Steiner" title="wikilink">Steiner</a> translation theorem in Germany.<a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a></p>

<p>There is a corresponding formula for use in estimation of the variance from sample data, that can be of use in hand calculations. This is a closely related identity that is structured to create an <a href="bias_(statistics)" title="wikilink">unbiased</a> estimate of the population variance</p>

<p>

<math display="block" id="Algebraic_formula_for_the_variance:1">
 <semantics>
  <mrow>
   <mrow>
    <msup>
     <mover accent="true">
      <mi>œÉ</mi>
      <mo stretchy="false">^</mo>
     </mover>
     <mn>2</mn>
    </msup>
    <mo>=</mo>
    <mrow>
     <mfrac>
      <mn>1</mn>
      <mrow>
       <mi>N</mi>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
     </mfrac>
     <mrow>
      <munderover>
       <mo largeop="true" movablelimits="false" symmetric="true">‚àë</mo>
       <mrow>
        <mi>i</mi>
        <mo>=</mo>
        <mn>1</mn>
       </mrow>
       <mi>N</mi>
      </munderover>
      <msup>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <msub>
          <mi>x</mi>
          <mi>i</mi>
         </msub>
         <mo>-</mo>
         <mover accent="true">
          <mi>x</mi>
          <mo stretchy="false">¬Ø</mo>
         </mover>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
       <mn>2</mn>
      </msup>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mfrac>
      <mi>N</mi>
      <mrow>
       <mi>N</mi>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
     </mfrac>
     <mrow>
      <mo>(</mo>
      <mrow>
       <mrow>
        <mfrac>
         <mn>1</mn>
         <mi>N</mi>
        </mfrac>
        <mrow>
         <mo>(</mo>
         <mrow>
          <munderover>
           <mo largeop="true" movablelimits="false" symmetric="true">‚àë</mo>
           <mrow>
            <mi>i</mi>
            <mo>=</mo>
            <mn>1</mn>
           </mrow>
           <mi>N</mi>
          </munderover>
          <msubsup>
           <mi>x</mi>
           <mi>i</mi>
           <mn>2</mn>
          </msubsup>
         </mrow>
         <mo>)</mo>
        </mrow>
       </mrow>
       <mo>-</mo>
       <msup>
        <mover accent="true">
         <mi>x</mi>
         <mo stretchy="false">¬Ø</mo>
        </mover>
        <mn>2</mn>
       </msup>
      </mrow>
      <mo>)</mo>
     </mrow>
    </mrow>
    <mo>‚â°</mo>
    <mrow>
     <mfrac>
      <mn>1</mn>
      <mrow>
       <mi>N</mi>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
     </mfrac>
     <mrow>
      <mo>(</mo>
      <mrow>
       <mrow>
        <mo>(</mo>
        <mrow>
         <munderover>
          <mo largeop="true" movablelimits="false" symmetric="true">‚àë</mo>
          <mrow>
           <mi>i</mi>
           <mo>=</mo>
           <mn>1</mn>
          </mrow>
          <mi>N</mi>
         </munderover>
         <msubsup>
          <mi>x</mi>
          <mi>i</mi>
          <mn>2</mn>
         </msubsup>
        </mrow>
        <mo>)</mo>
       </mrow>
       <mo>-</mo>
       <mrow>
        <mi>N</mi>
        <msup>
         <mrow>
          <mo>(</mo>
          <mover accent="true">
           <mi>x</mi>
           <mo stretchy="false">¬Ø</mo>
          </mover>
          <mo>)</mo>
         </mrow>
         <mn>2</mn>
        </msup>
       </mrow>
      </mrow>
      <mo>)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <ci>normal-^</ci>
       <ci>œÉ</ci>
      </apply>
      <cn type="integer">2</cn>
     </apply>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <apply>
        <minus></minus>
        <ci>N</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <sum></sum>
         <apply>
          <eq></eq>
          <ci>i</ci>
          <cn type="integer">1</cn>
         </apply>
        </apply>
        <ci>N</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <minus></minus>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>x</ci>
          <ci>i</ci>
         </apply>
         <apply>
          <ci>normal-¬Ø</ci>
          <ci>x</ci>
         </apply>
        </apply>
        <cn type="integer">2</cn>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <ci>N</ci>
       <apply>
        <minus></minus>
        <ci>N</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <apply>
       <minus></minus>
       <apply>
        <times></times>
        <apply>
         <divide></divide>
         <cn type="integer">1</cn>
         <ci>N</ci>
        </apply>
        <apply>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <sum></sum>
           <apply>
            <eq></eq>
            <ci>i</ci>
            <cn type="integer">1</cn>
           </apply>
          </apply>
          <ci>N</ci>
         </apply>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>x</ci>
           <ci>i</ci>
          </apply>
          <cn type="integer">2</cn>
         </apply>
        </apply>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <ci>normal-¬Ø</ci>
         <ci>x</ci>
        </apply>
        <cn type="integer">2</cn>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <equivalent></equivalent>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <apply>
        <minus></minus>
        <ci>N</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <apply>
       <minus></minus>
       <apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <sum></sum>
          <apply>
           <eq></eq>
           <ci>i</ci>
           <cn type="integer">1</cn>
          </apply>
         </apply>
         <ci>N</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>x</ci>
          <ci>i</ci>
         </apply>
         <cn type="integer">2</cn>
        </apply>
       </apply>
       <apply>
        <times></times>
        <ci>N</ci>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <ci>normal-¬Ø</ci>
          <ci>x</ci>
         </apply>
         <cn type="integer">2</cn>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \hat{\sigma}^{2}=\frac{1}{N-1}\sum_{i=1}^{N}(x_{i}-\bar{x})^{2}=\frac{N}{N-1}%
\left(\frac{1}{N}\left(\sum_{i=1}^{N}x_{i}^{2}\right)-\bar{x}^{2}\right)\equiv%
\frac{1}{N-1}\left(\left(\sum_{i=1}^{N}x_{i}^{2}\right)-N\left(\bar{x}\right)^%
{2}\right).
  </annotation>
 </semantics>
</math>

</p>

<p>However, use of these formulas can be unwise in practice when using floating point arithmetic with limited precision: subtracting two values having a similar magnitude can lead to <a href="Loss_of_significance" title="wikilink">catastrophic cancellation</a>,<a class="footnoteRef" href="#fn3" id="fnref3"><sup>3</sup></a> and thus causing a loss of significance when 

<math display="inline" id="Algebraic_formula_for_the_variance:2">
 <semantics>
  <mrow>
   <mo>E</mo>
   <msup>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>X</mi>
     <mo stretchy="false">)</mo>
    </mrow>
    <mn>2</mn>
   </msup>
   <mo>‚â´</mo>
   <mo>Var</mo>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>X</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <ci>normal-E</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <ci>normal-(</ci>
      <csymbol cd="unknown">X</csymbol>
      <ci>normal-)</ci>
     </cerror>
     <cn type="integer">2</cn>
    </apply>
    <csymbol cd="latexml">much-greater-than</csymbol>
    <ci>Var</ci>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">X</csymbol>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \operatorname{E}(X)^{2}\gg\operatorname{Var}(X)
  </annotation>
 </semantics>
</math>

. There exist other numerically stable <a href="algorithms_for_calculating_variance" title="wikilink">algorithms for calculating variance</a> for use with floating point numbers.</p>
<h3 id="proof">Proof</h3>

<p>The computational formula for the population variance follows in a straightforward manner from the <a href="Expected_value#Linearity" title="wikilink">linearity of expected values</a> and the definition of variance:</p>

<p>

<math display="inline" id="Algebraic_formula_for_the_variance:3">
 <semantics>
  <mrow>
   <mo>Var</mo>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>X</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>Var</ci>
    <ci>X</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle\operatorname{Var}(X)
  </annotation>
 </semantics>
</math>


</p>
<h3 id="generalization-to-covariance">Generalization to covariance</h3>

<p>This formula can be generalized for <a class="uri" href="covariance" title="wikilink">covariance</a>, with two random variables X<sub>i</sub> and X<sub>j</sub>:</p>

<p>

<math display="block" id="Algebraic_formula_for_the_variance:4">
 <semantics>
  <mrow>
   <mrow>
    <mo>Cov</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <msub>
      <mi>X</mi>
      <mi>i</mi>
     </msub>
     <mo>,</mo>
     <msub>
      <mi>X</mi>
      <mi>j</mi>
     </msub>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mo>E</mo>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <msub>
        <mi>X</mi>
        <mi>i</mi>
       </msub>
       <msub>
        <mi>X</mi>
        <mi>j</mi>
       </msub>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>-</mo>
    <mrow>
     <mrow>
      <mo>E</mo>
      <mrow>
       <mo stretchy="false">(</mo>
       <msub>
        <mi>X</mi>
        <mi>i</mi>
       </msub>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mrow>
      <mo>E</mo>
      <mrow>
       <mo stretchy="false">(</mo>
       <msub>
        <mi>X</mi>
        <mi>j</mi>
       </msub>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <ci>Cov</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>X</ci>
      <ci>i</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>X</ci>
      <ci>j</ci>
     </apply>
    </apply>
    <apply>
     <minus></minus>
     <apply>
      <ci>normal-E</ci>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>X</ci>
        <ci>i</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>X</ci>
        <ci>j</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <ci>normal-E</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>X</ci>
        <ci>i</ci>
       </apply>
      </apply>
      <apply>
       <ci>normal-E</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>X</ci>
        <ci>j</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \operatorname{Cov}(X_{i},X_{j})=\operatorname{E}(X_{i}X_{j})-\operatorname{E}(%
X_{i})\operatorname{E}(X_{j})
  </annotation>
 </semantics>
</math>

</p>

<p>as well as for the <em>n</em> by <em>n</em> <a href="covariance_matrix" title="wikilink">covariance matrix</a> of a <a href="random_vector" title="wikilink">random vector</a> of length <em>n</em>:</p>

<p>

<math display="block" id="Algebraic_formula_for_the_variance:5">
 <semantics>
  <mrow>
   <mo>Var</mo>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>ùêó</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>=</mo>
   <mo>E</mo>
   <mrow>
    <mo stretchy="false">(</mo>
    <msup>
     <mi>ùêóùêó</mi>
     <mo>‚ä§</mo>
    </msup>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>-</mo>
   <mo>E</mo>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>ùêó</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>E</mo>
   <msup>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>ùêó</mi>
     <mo stretchy="false">)</mo>
    </mrow>
    <mo>‚ä§</mo>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <ci>Var</ci>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">X</csymbol>
     <ci>normal-)</ci>
    </cerror>
    <eq></eq>
    <ci>normal-E</ci>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>ùêóùêó</ci>
      <csymbol cd="latexml">top</csymbol>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <minus></minus>
    <ci>normal-E</ci>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">X</csymbol>
     <ci>normal-)</ci>
    </cerror>
    <ci>normal-E</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <ci>normal-(</ci>
      <csymbol cd="unknown">X</csymbol>
      <ci>normal-)</ci>
     </cerror>
     <csymbol cd="latexml">top</csymbol>
    </apply>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \operatorname{Var}(\mathbf{X})=\operatorname{E}(\mathbf{XX^{\top}})-%
\operatorname{E}(\mathbf{X})\operatorname{E}(\mathbf{X})^{\top}
  </annotation>
 </semantics>
</math>

</p>

<p>and for the <em>n</em> by <em>m</em> <a class="uri" href="cross-covariance" title="wikilink">cross-covariance</a> matrix <em>between</em> two random vectors of length <em>n</em> and <em>m</em>:</p>

<p>

<math display="block" id="Algebraic_formula_for_the_variance:6">
 <semantics>
  <mrow>
   <mo>Cov</mo>
   <mrow>
    <mo stretchy="false">(</mo>
    <mtext>ùêó</mtext>
    <mo>,</mo>
    <mtext>ùêò</mtext>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>=</mo>
   <mo>E</mo>
   <mrow>
    <mo stretchy="false">(</mo>
    <msup>
     <mi>ùêóùêò</mi>
     <mo>‚ä§</mo>
    </msup>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>-</mo>
   <mo>E</mo>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>ùêó</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>E</mo>
   <msup>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>ùêò</mi>
     <mo stretchy="false">)</mo>
    </mrow>
    <mo>‚ä§</mo>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <ci>Cov</ci>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <mtext>X</mtext>
     <ci>normal-,</ci>
     <mtext>Y</mtext>
     <ci>normal-)</ci>
    </cerror>
    <eq></eq>
    <ci>normal-E</ci>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>ùêóùêò</ci>
      <csymbol cd="latexml">top</csymbol>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <minus></minus>
    <ci>normal-E</ci>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">X</csymbol>
     <ci>normal-)</ci>
    </cerror>
    <ci>normal-E</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <ci>normal-(</ci>
      <csymbol cd="unknown">Y</csymbol>
      <ci>normal-)</ci>
     </cerror>
     <csymbol cd="latexml">top</csymbol>
    </apply>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \operatorname{Cov}(\textbf{X},\textbf{Y})=\operatorname{E}(\mathbf{XY^{\top}})%
-\operatorname{E}(\mathbf{X})\operatorname{E}(\mathbf{Y})^{\top}
  </annotation>
 </semantics>
</math>

</p>

<p>where expectations are taken element-wise and 

<math display="inline" id="Algebraic_formula_for_the_variance:7">
 <semantics>
  <mrow>
   <mi>ùêó</mi>
   <mo>=</mo>
   <mrow>
    <mo stretchy="false">{</mo>
    <msub>
     <mi>X</mi>
     <mn>1</mn>
    </msub>
    <mo>,</mo>
    <msub>
     <mi>X</mi>
     <mn>2</mn>
    </msub>
    <mo>,</mo>
    <mi mathvariant="normal">‚Ä¶</mi>
    <mo>,</mo>
    <msub>
     <mi>X</mi>
     <mi>n</mi>
    </msub>
    <mo stretchy="false">}</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>ùêó</ci>
    <set>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>X</ci>
      <cn type="integer">1</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>X</ci>
      <cn type="integer">2</cn>
     </apply>
     <ci>normal-‚Ä¶</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>X</ci>
      <ci>n</ci>
     </apply>
    </set>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{X}=\{X_{1},X_{2},\ldots,X_{n}\}
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Algebraic_formula_for_the_variance:8">
 <semantics>
  <mrow>
   <mi>ùêò</mi>
   <mo>=</mo>
   <mrow>
    <mo stretchy="false">{</mo>
    <msub>
     <mi>Y</mi>
     <mn>1</mn>
    </msub>
    <mo>,</mo>
    <msub>
     <mi>Y</mi>
     <mn>2</mn>
    </msub>
    <mo>,</mo>
    <mi mathvariant="normal">‚Ä¶</mi>
    <mo>,</mo>
    <msub>
     <mi>Y</mi>
     <mi>m</mi>
    </msub>
    <mo stretchy="false">}</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>ùêò</ci>
    <set>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>Y</ci>
      <cn type="integer">1</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>Y</ci>
      <cn type="integer">2</cn>
     </apply>
     <ci>normal-‚Ä¶</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>Y</ci>
      <ci>m</ci>
     </apply>
    </set>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{Y}=\{Y_{1},Y_{2},\ldots,Y_{m}\}
  </annotation>
 </semantics>
</math>

 are random vectors of respective lengths <em>n</em> and <em>m</em>.</p>

<p>Note that this formula suffers from the same <a href="loss_of_significance" title="wikilink">loss of significance</a> as the formula for variance if used for calculating estimates of the covariance.</p>
<h2 id="see-also">See also</h2>
<ul>
<li><a href="Standard_deviation#Identities_and_mathematical_properties" title="wikilink">Standard deviation: Identities and mathematical properties</a></li>
</ul>
<h2 id="references">References</h2>

<p>"</p>

<p><a href="Category:Statistical_deviation_and_dispersion" title="wikilink">Category:Statistical deviation and dispersion</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1">In French: formule de Koenig‚ÄìHuygens. See e.g. <a href="#fnref1">‚Ü©</a></li>
<li id="fn2">In German: Verschiebungssatz von Steiner. See e.g. .<a href="#fnref2">‚Ü©</a></li>
<li id="fn3"><a href="Donald_E._Knuth" title="wikilink">Donald E. Knuth</a> (1998). <em><a href="The_Art_of_Computer_Programming" title="wikilink">The Art of Computer Programming</a></em>, volume 2: <em>Seminumerical Algorithms</em>, 3rd edn., p. 232. Boston: Addison-Wesley.<a href="#fnref3">‚Ü©</a></li>
</ol>
</section>
</body>
</html>

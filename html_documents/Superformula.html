<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="1421">Superformula</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Superformula</h1>
<style>
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
<style>
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
  </style>
</body></html>
<body>
<hr/>
<figure><b>(Figure)</b>
<figcaption>Some superformula samples: <em>a</em> = <em>b</em> = 1; <em>m</em>, <em>n</em><sub>1</sub>, <em>n</em><sub>2</sub> and <em>n</em><sub>3</sub> are shown in picture</figcaption>
</figure>

<p>The <strong>superformula</strong> is a generalization of the <a class="uri" href="superellipse" title="wikilink">superellipse</a> and was first proposed by Johan Gielis.</p>

<p>Gielis suggested that the formula can be used to describe many complex shapes and curves that are found in nature.</p>

<p>In <a href="polar_coordinates" title="wikilink">polar coordinates</a>, with 

<math display="inline" id="Superformula:0">
 <semantics>
  <mi>r</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>r</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   r
  </annotation>
 </semantics>
</math>

 the radius and 

<math display="inline" id="Superformula:1">
 <semantics>
  <mi>φ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>φ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \varphi
  </annotation>
 </semantics>
</math>

 the angle, the superformula is:</p>

<p>

<math display="block" id="Superformula:2">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>r</mi>
     <mrow>
      <mo>(</mo>
      <mi>φ</mi>
      <mo>)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <msup>
     <mrow>
      <mo>[</mo>
      <mrow>
       <msup>
        <mrow>
         <mo>|</mo>
         <mfrac>
          <mrow>
           <mi>cos</mi>
           <mrow>
            <mo>(</mo>
            <mfrac>
             <mrow>
              <mi>m</mi>
              <mi>φ</mi>
             </mrow>
             <mn>4</mn>
            </mfrac>
            <mo>)</mo>
           </mrow>
          </mrow>
          <mi>a</mi>
         </mfrac>
         <mo>|</mo>
        </mrow>
        <msub>
         <mi>n</mi>
         <mn>2</mn>
        </msub>
       </msup>
       <mo>+</mo>
       <msup>
        <mrow>
         <mo>|</mo>
         <mfrac>
          <mrow>
           <mi>sin</mi>
           <mrow>
            <mo>(</mo>
            <mfrac>
             <mrow>
              <mi>m</mi>
              <mi>φ</mi>
             </mrow>
             <mn>4</mn>
            </mfrac>
            <mo>)</mo>
           </mrow>
          </mrow>
          <mi>b</mi>
         </mfrac>
         <mo>|</mo>
        </mrow>
        <msub>
         <mi>n</mi>
         <mn>3</mn>
        </msub>
       </msup>
      </mrow>
      <mo>]</mo>
     </mrow>
     <mrow>
      <mo>-</mo>
      <mfrac>
       <mn>1</mn>
       <msub>
        <mi>n</mi>
        <mn>1</mn>
       </msub>
      </mfrac>
     </mrow>
    </msup>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>r</ci>
     <ci>φ</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="latexml">delimited-[]</csymbol>
      <apply>
       <plus></plus>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <abs></abs>
         <apply>
          <divide></divide>
          <apply>
           <cos></cos>
           <apply>
            <divide></divide>
            <apply>
             <times></times>
             <ci>m</ci>
             <ci>φ</ci>
            </apply>
            <cn type="integer">4</cn>
           </apply>
          </apply>
          <ci>a</ci>
         </apply>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>n</ci>
         <cn type="integer">2</cn>
        </apply>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <abs></abs>
         <apply>
          <divide></divide>
          <apply>
           <sin></sin>
           <apply>
            <divide></divide>
            <apply>
             <times></times>
             <ci>m</ci>
             <ci>φ</ci>
            </apply>
            <cn type="integer">4</cn>
           </apply>
          </apply>
          <ci>b</ci>
         </apply>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>n</ci>
         <cn type="integer">3</cn>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <minus></minus>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>n</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   r\left(\varphi\right)=\left[\left|\frac{\cos\left(\frac{m\varphi}{4}\right)}{a%
}\right|^{n_{2}}+\left|\frac{\sin\left(\frac{m\varphi}{4}\right)}{b}\right|^{n%
_{3}}\right]^{-\frac{1}{n_{1}}}.
  </annotation>
 </semantics>
</math>

</p>

<p>The formula appeared in a work by Gielis. It was obtained by generalizing the superellipse, named and popularized by <a href="Piet_Hein_(scientist)" title="wikilink">Piet Hein</a>, a <a href="Denmark" title="wikilink">Danish</a> <a class="uri" href="mathematician" title="wikilink">mathematician</a>.</p>
<h2 id="extension-to-higher-dimensions">Extension to higher dimensions</h2>

<p>It is possible to extend the formula to 3, 4, or <em>n</em> dimensions, by means of the <a href="spherical_product" title="wikilink">spherical product</a> of superformulas. For example, the <a href="dimension" title="wikilink">3D</a> <a href="parametric_surface" title="wikilink">parametric surface</a> is obtained by multiplying two superformulas <em>r</em><sub>1</sub> and <em>r</em><sub>2</sub>. The coordinates are defined by the relations:</p>

<p>

<math display="block" id="Superformula:3">
 <semantics>
  <mrow>
   <mrow>
    <mi>x</mi>
    <mo>=</mo>
    <mrow>
     <msub>
      <mi>r</mi>
      <mn>1</mn>
     </msub>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>θ</mi>
      <mo stretchy="false">)</mo>
     </mrow>
     <mrow>
      <mi>cos</mi>
      <mrow>
       <mi>θ</mi>
       <mo>⋅</mo>
       <msub>
        <mi>r</mi>
        <mn>2</mn>
       </msub>
      </mrow>
     </mrow>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>ϕ</mi>
      <mo stretchy="false">)</mo>
     </mrow>
     <mrow>
      <mi>cos</mi>
      <mi>ϕ</mi>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>x</ci>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>r</ci>
      <cn type="integer">1</cn>
     </apply>
     <ci>θ</ci>
     <apply>
      <cos></cos>
      <apply>
       <ci>normal-⋅</ci>
       <ci>θ</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>r</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
     </apply>
     <ci>ϕ</ci>
     <apply>
      <cos></cos>
      <ci>ϕ</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x=r_{1}(\theta)\cos\theta\cdot r_{2}(\phi)\cos\phi,
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Superformula:4">
 <semantics>
  <mrow>
   <mrow>
    <mi>y</mi>
    <mo>=</mo>
    <mrow>
     <msub>
      <mi>r</mi>
      <mn>1</mn>
     </msub>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>θ</mi>
      <mo stretchy="false">)</mo>
     </mrow>
     <mrow>
      <mi>sin</mi>
      <mrow>
       <mi>θ</mi>
       <mo>⋅</mo>
       <msub>
        <mi>r</mi>
        <mn>2</mn>
       </msub>
      </mrow>
     </mrow>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>ϕ</mi>
      <mo stretchy="false">)</mo>
     </mrow>
     <mrow>
      <mi>cos</mi>
      <mi>ϕ</mi>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>y</ci>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>r</ci>
      <cn type="integer">1</cn>
     </apply>
     <ci>θ</ci>
     <apply>
      <sin></sin>
      <apply>
       <ci>normal-⋅</ci>
       <ci>θ</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>r</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
     </apply>
     <ci>ϕ</ci>
     <apply>
      <cos></cos>
      <ci>ϕ</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   y=r_{1}(\theta)\sin\theta\cdot r_{2}(\phi)\cos\phi,
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Superformula:5">
 <semantics>
  <mrow>
   <mrow>
    <mi>z</mi>
    <mo>=</mo>
    <mrow>
     <msub>
      <mi>r</mi>
      <mn>2</mn>
     </msub>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>ϕ</mi>
      <mo stretchy="false">)</mo>
     </mrow>
     <mrow>
      <mi>sin</mi>
      <mi>ϕ</mi>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>z</ci>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>r</ci>
      <cn type="integer">2</cn>
     </apply>
     <ci>ϕ</ci>
     <apply>
      <sin></sin>
      <ci>ϕ</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   z=r_{2}(\phi)\sin\phi,
  </annotation>
 </semantics>
</math>

 where 

<math display="inline" id="Superformula:6">
 <semantics>
  <mi>ϕ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>ϕ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \phi
  </annotation>
 </semantics>
</math>


 (<a class="uri" href="latitude" title="wikilink">latitude</a>) varies between −<em>π</em>/2 and <em>π</em>/2 and <em>θ</em> (<a class="uri" href="longitude" title="wikilink">longitude</a>) between −<em>π</em> and <em>π</em>.</p>
<h2 id="plots">Plots</h2>
<figure><b>(Figure)</b>
<figcaption>Sf2d.png</figcaption>
</figure>

<p>A <a href="GNU_Octave" title="wikilink">GNU Octave</a> program for generating these figures:</p>
<div class="sourceCode"><pre class="sourceCode matlab"><code class="sourceCode matlab">  function sf2d(n,a)
    u=[<span class="fl">0</span>:<span class="fl">.001</span>:<span class="fl">2</span>*pi];
    raux=abs(<span class="fl">1</span>/a(<span class="fl">1</span>).*abs(cos(n(<span class="fl">1</span>)*u/<span class="fl">4</span>))).^n(<span class="fl">3</span>)+abs(<span class="fl">1</span>/a(<span class="fl">2</span>).*abs(sin(n(<span class="fl">1</span>)*u/<span class="fl">4</span>))).^n(<span class="fl">4</span>);
    r=abs(raux).^(-<span class="fl">1</span>/n(<span class="fl">2</span>));
    x=r.*cos(u);
    y=r.*sin(u);
    plot(x,y);
  end</code></pre></div>

<p><br/>
----</p>

<p>3D superformula: <em>a</em> = <em>b</em> = 1; <em>m</em>, <em>n</em><sub>1</sub>, <em>n</em><sub>2</sub> and <em>n</em><sub>3</sub> are shown in the pictures.</p>

<p>Image:Sf3d_3257.svg Image:Sf3d_3.5.5.5.svg Image:Sf3d_3301515.svg Image:Sf3d_7284.svg Image:Sf3d_5111.svg Image:sf3d_4.5.54.svg Image:sf3d_8.5.58.svg Image:Sf3d_4121515.svg</p>

<p>A <a href="GNU_Octave" title="wikilink">GNU Octave</a> program for generating these figures:</p>
<div class="sourceCode"><pre class="sourceCode matlab"><code class="sourceCode matlab"> function sf3d(n, a)
  u=[-pi:<span class="fl">.05</span>:pi];
  v=[-pi/<span class="fl">2</span>:<span class="fl">.05</span>:pi/<span class="fl">2</span>];
  nu=length(u);
  nv=length(v);
    for i=<span class="fl">1</span>:nu
    for j=<span class="fl">1</span>:nv
      raux1=abs(<span class="fl">1</span>/a(<span class="fl">1</span>)*abs(cos(n(<span class="fl">1</span>).*u(i)/<span class="fl">4</span>))).^n(<span class="fl">3</span>)+abs(<span class="fl">1</span>/a(<span class="fl">2</span>)*abs(sin(n(<span class="fl">1</span>)*u(i)/<span class="fl">4</span>))).^n(<span class="fl">4</span>);
      r1=abs(raux1).^(-<span class="fl">1</span>/n(<span class="fl">2</span>));
      raux2=abs(<span class="fl">1</span>/a(<span class="fl">1</span>)*abs(cos(n(<span class="fl">1</span>)*v(j)/<span class="fl">4</span>))).^n(<span class="fl">3</span>)+abs(<span class="fl">1</span>/a(<span class="fl">2</span>)*abs(sin(n(<span class="fl">1</span>)*v(j)/<span class="fl">4</span>))).^n(<span class="fl">4</span>);
      r2=abs(raux2).^(-<span class="fl">1</span>/n(<span class="fl">2</span>));
      x(i,j)=r1*cos(u(i))*r2*cos(v(j));
      y(i,j)=r1*sin(u(i))*r2*cos(v(j));
      z(i,j)=r2*sin(v(j));
    endfor;
  endfor;
  mesh(x,y,z);
 endfunction;</code></pre></div>
<h2 id="references">References</h2>
<ul>
<li></li>
</ul>
<h2 id="external-links">External links</h2>
<ul>
<li><a href="http://genicap.com">Website with information about the superformula and Johan Gielis</a></li>
<li><a href="http://ssrn.com/abstract=913667">Some Experiments on Fitting of Gielis Curves by Simulated Annealing and Particle Swarm Methods of Global Optimization</a></li>
<li><a href="http://ssrn.com/abstract=917762">Least Squares Fitting of Chacón-Gielis Curves By the Particle Swarm Method of Optimization</a></li>
<li><a href="http://www.perbang.dk/superformula/">Superformula 2D Plotter &amp; SVG Generator</a></li>
<li><a href="http://jsxgraph.uni-bayreuth.de/wiki/index.php/Superformula">Interactive example using JSXGraph</a></li>
<li><a href="http://www.k2g2.org/blog:bit.craft:superdupershape_explorer">3D Superdupershape Explorer using Processing</a></li>
<li><a href="http://chamicewicz.com/p5/superformula3d/">Interactive 3D Superformula plotter using Processing (with code)</a></li>
<li><a href="http://sourceforge.net/projects/supershaper">SuperShaper: An OpenSource, OpenCL accelerated, interactive 3D SuperShape generator with shader based visualisation (OpenGL3)</a></li>
<li>[<a class="uri" href="http://www.organicvectory.com/index.php?option=com_wrapper&amp;view">http://www.organicvectory.com/index.php?option=com_wrapper&amp;view;</a>;=wrapper&amp;Itemid;=98 Simpel, WebGL based SuperShape implementation]</li>
<li><a href="http://frink.machighway.com/~dynamicm/super-ellipse.html">The Gielis Supershape Formula</a>, Provides an interactive Java applet for exploring the variety of different shapes, natural or mathematical, that can be formed with the formula.</li>
</ul>

<p>"</p>

<p><a href="Category:Geometric_shapes" title="wikilink">Category:Geometric shapes</a> <a class="uri" href="Category:Curves" title="wikilink">Category:Curves</a> <a class="uri" href="Category:Surfaces" title="wikilink">Category:Surfaces</a></p>
</body>


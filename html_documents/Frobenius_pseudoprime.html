<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="427">Frobenius pseudoprime</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Frobenius pseudoprime</h1>
<hr/>

<p>In <a href="number_theory" title="wikilink">number theory</a>, a <strong>Frobenius pseudoprime</strong> is a <a class="uri" href="pseudoprime" title="wikilink">pseudoprime</a> that passes a specific <a href="probable_prime" title="wikilink">probable prime</a> test described by Jon Grantham in a 1998 preprint and published in 2000. <a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a> <a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a> It has been studied by other authors for the case of quadratic polynomials. <a class="footnoteRef" href="#fn3" id="fnref3"><sup>3</sup></a> <a class="footnoteRef" href="#fn4" id="fnref4"><sup>4</sup></a></p>
<h2 id="the-test-for-quadratic-polynomials">The test for quadratic polynomials</h2>

<p>A Frobenius test is defined in terms of a <a href="monic_polynomial" title="wikilink">monic polynomial</a>. The case of a degree-2 polynomial (a quadratic) is common and can be shown in terms of <a href="Lucas_sequence" title="wikilink">Lucas sequences</a>, lending itself to fast implementations.</p>

<p>For the polynomial 

<math display="inline" id="Frobenius_pseudoprime:0">
 <semantics>
  <mrow>
   <mrow>
    <msup>
     <mi>x</mi>
     <mn>2</mn>
    </msup>
    <mo>-</mo>
    <mrow>
     <mi>P</mi>
     <mi>x</mi>
    </mrow>
   </mrow>
   <mo>+</mo>
   <mi>Q</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <plus></plus>
    <apply>
     <minus></minus>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>x</ci>
      <cn type="integer">2</cn>
     </apply>
     <apply>
      <times></times>
      <ci>P</ci>
      <ci>x</ci>
     </apply>
    </apply>
    <ci>Q</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \scriptstyle x^{2}-Px+Q
  </annotation>
 </semantics>
</math>

, where 

<math display="inline" id="Frobenius_pseudoprime:1">
 <semantics>
  <mrow>
   <mi>D</mi>
   <mo>=</mo>
   <mrow>
    <msup>
     <mi>P</mi>
     <mn>2</mn>
    </msup>
    <mo>-</mo>
    <mrow>
     <mn>4</mn>
     <mi>Q</mi>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>D</ci>
    <apply>
     <minus></minus>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>P</ci>
      <cn type="integer">2</cn>
     </apply>
     <apply>
      <times></times>
      <cn type="integer">4</cn>
      <ci>Q</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \scriptstyle D=P^{2}-4Q
  </annotation>
 </semantics>
</math>

 is not a square, <em>n</em> a composite number, 

<math display="inline" id="Frobenius_pseudoprime:2">
 <semantics>
  <mrow>
   <mrow>
    <mi>gcd</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>n</mi>
     <mo>,</mo>
     <mrow>
      <mn>2</mn>
      <mi>Q</mi>
      <mi>D</mi>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <gcd></gcd>
     <ci>n</ci>
     <apply>
      <times></times>
      <cn type="integer">2</cn>
      <ci>Q</ci>
      <ci>D</ci>
     </apply>
    </apply>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \scriptstyle\gcd(n,2QD)=1
  </annotation>
 </semantics>
</math>

, and <em>k</em> the <a href="Jacobi_symbol" title="wikilink">Jacobi symbol</a> 

<math display="inline" id="Frobenius_pseudoprime:3">
 <semantics>
  <mrow>
   <mo>(</mo>
   <mfrac>
    <mi>D</mi>
    <mi>n</mi>
   </mfrac>
   <mo>)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <divide></divide>
    <ci>D</ci>
    <ci>n</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \scriptstyle\left(\tfrac{D}{n}\right)
  </annotation>
 </semantics>
</math>

, <em>n</em> is a Frobenius (P,Q) pseudoprime if and only if</p>

<p>

<math display="block" id="Frobenius_pseudoprime:4">
 <semantics>
  <mrow>
   <mrow>
    <mrow></mrow>
    <mrow>
     <mo stretchy="false">(</mo>
     <mn>1</mn>
     <mo stretchy="false">)</mo>
    </mrow>
    <mrow></mrow>
    <msub>
     <mi>U</mi>
     <mrow>
      <mi>n</mi>
      <mo>-</mo>
      <mi>k</mi>
     </mrow>
    </msub>
   </mrow>
   <mo>≡</mo>
   <mrow>
    <mn>0</mn>
    <mspace width="veryverythickmathspace">
    </mspace>
    <mrow>
     <mo lspace="8.1pt" stretchy="false">(</mo>
     <mrow>
      <mo>mod</mo>
      <mi>n</mi>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <equivalent></equivalent>
    <apply>
     <times></times>
     <mtext></mtext>
     <cn type="integer">1</cn>
     <mtext></mtext>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>U</ci>
      <apply>
       <minus></minus>
       <ci>n</ci>
       <ci>k</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <csymbol cd="latexml">annotated</csymbol>
     <cn type="integer">0</cn>
     <apply>
      <ci>pmod</ci>
      <ci>n</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \text{ }(1)\text{ }U_{n-k}\equiv 0\;\;(\mathop{{\rm mod}}n)
  </annotation>
 </semantics>
</math>

 and</p>

<p>

<math display="block" id="Frobenius_pseudoprime:5">
 <semantics>
  <mrow>
   <mrow>
    <mrow></mrow>
    <mrow>
     <mo stretchy="false">(</mo>
     <mn>2</mn>
     <mo stretchy="false">)</mo>
    </mrow>
    <mrow></mrow>
    <msub>
     <mi>V</mi>
     <mrow>
      <mi>n</mi>
      <mo>-</mo>
      <mi>k</mi>
     </mrow>
    </msub>
   </mrow>
   <mo>≡</mo>
   <mrow>
    <mo>{</mo>
    <mtable displaystyle="true">
     <mtr>
      <mtd columnalign="left">
       <mrow>
        <mn>2</mn>
        <mi>Q</mi>
       </mrow>
      </mtd>
      <mtd columnalign="left">
       <mrow>
        <mrow>
         <mtext>if</mtext>
         <mi>k</mi>
        </mrow>
        <mo>=</mo>
        <mrow>
         <mo>-</mo>
         <mn>1</mn>
        </mrow>
       </mrow>
      </mtd>
     </mtr>
     <mtr>
      <mtd columnalign="left">
       <mn>2</mn>
      </mtd>
      <mtd columnalign="left">
       <mrow>
        <mrow>
         <mtext>if</mtext>
         <mi>k</mi>
        </mrow>
        <mo>=</mo>
        <mrow>
         <mn>1</mn>
         <mtext>.</mtext>
        </mrow>
       </mrow>
      </mtd>
     </mtr>
    </mtable>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <equivalent></equivalent>
    <apply>
     <times></times>
     <mtext></mtext>
     <cn type="integer">2</cn>
     <mtext></mtext>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>V</ci>
      <apply>
       <minus></minus>
       <ci>n</ci>
       <ci>k</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <csymbol cd="latexml">cases</csymbol>
     <apply>
      <times></times>
      <cn type="integer">2</cn>
      <ci>Q</ci>
     </apply>
     <apply>
      <eq></eq>
      <apply>
       <times></times>
       <mtext>if</mtext>
       <ci>k</ci>
      </apply>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <cn type="integer">2</cn>
     <apply>
      <eq></eq>
      <apply>
       <times></times>
       <mtext>if</mtext>
       <ci>k</ci>
      </apply>
      <apply>
       <times></times>
       <cn type="integer">1</cn>
       <mtext>.</mtext>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \text{ }(2)\text{ }V_{n-k}\equiv\begin{cases}2Q&\mbox{if }k=-1\\
2&\mbox{if }k=1\mbox{.}\end{cases}
  </annotation>
 </semantics>
</math>

</p>

<p>Both conditions hold for all primes, hence this constitutes a probable prime test.</p>

<p>Condition (1) is the same condition that defines a <a href="Lucas_pseudoprime" title="wikilink">Lucas pseudoprime</a>, hence every Frobenius (P,Q) pseudoprime is also a Lucas (P,Q) pseudoprime, but because of the additional condition (2), the converse is not true.</p>
<h2 id="example">Example</h2>

<p>Frobenius pseudoprimes with respect to the Fibonacci polynomial 

<math display="inline" id="Frobenius_pseudoprime:6">
 <semantics>
  <mrow>
   <msup>
    <mi>x</mi>
    <mn>2</mn>
   </msup>
   <mo>-</mo>
   <mi>x</mi>
   <mo>-</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <minus></minus>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>x</ci>
     <cn type="integer">2</cn>
    </apply>
    <ci>x</ci>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \scriptstyle x^{2}-x-1
  </annotation>
 </semantics>
</math>

 can be determined using the <a href="Fibonacci_sequence" title="wikilink">Fibonacci sequence</a> (Lucas (1,-1) sequence) and are:</p>
<dl>
<dd>4181, 5777, 6721, 10877, 13201, 15251, 34561, 51841, 64079, 64681, 67861, 68251, 75077, 90061, 96049, 97921, 100127, 113573, 118441, 146611, 161027, 162133, 163081, 186961, 197209, 219781, 231703, 252601, 254321, 257761, 268801, 272611, 283361, 302101, 303101, 330929, 399001, 430127, 433621, 438751, 489601, ... 
</dd>
</dl>

<p>While 323 is the first <a href="Lucas_pseudoprime" title="wikilink">Lucas pseudoprime</a> with respect to the Fibonacci polynomial 

<math display="inline" id="Frobenius_pseudoprime:7">
 <semantics>
  <mrow>
   <msup>
    <mi>x</mi>
    <mn>2</mn>
   </msup>
   <mo>-</mo>
   <mi>x</mi>
   <mo>-</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <minus></minus>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>x</ci>
     <cn type="integer">2</cn>
    </apply>
    <ci>x</ci>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \scriptstyle x^{2}-x-1
  </annotation>
 </semantics>
</math>

, the first Frobenius pseudoprime with respect to the same polynomial is 4181 (Grantham indicates it is 5777<a class="footnoteRef" href="#fn5" id="fnref5"><sup>5</sup></a> but multiple authors have noted this is incorrect and is instead the first pseudoprime with 

<math display="inline" id="Frobenius_pseudoprime:8">
 <semantics>
  <mrow>
   <mrow>
    <mo>(</mo>
    <mfrac>
     <mn>5</mn>
     <mi>n</mi>
    </mfrac>
    <mo>)</mo>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mo>-</mo>
    <mn>1</mn>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <divide></divide>
     <cn type="integer">5</cn>
     <ci>n</ci>
    </apply>
    <apply>
     <minus></minus>
     <cn type="integer">1</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \left(\tfrac{5}{n}\right)=-1
  </annotation>
 </semantics>
</math>

 for this polynomial<a class="footnoteRef" href="#fn6" id="fnref6"><sup>6</sup></a>).</p>

<p>Another case, Frobenius pseudoprimes with respect to the quadratic polynomial 

<math display="inline" id="Frobenius_pseudoprime:9">
 <semantics>
  <mrow>
   <msup>
    <mi>x</mi>
    <mn>2</mn>
   </msup>
   <mo>-</mo>
   <mrow>
    <mn>3</mn>
    <mi>x</mi>
   </mrow>
   <mo>-</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <minus></minus>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>x</ci>
     <cn type="integer">2</cn>
    </apply>
    <apply>
     <times></times>
     <cn type="integer">3</cn>
     <ci>x</ci>
    </apply>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \scriptstyle x^{2}-3x-1
  </annotation>
 </semantics>
</math>

 can be determined using the Lucas (3,-1) sequence and are:</p>
<dl>
<dd>119, 649, 1189, 4187, 12871, 14041, 16109, 23479, 24769, 28421, 31631, 34997, 38503, 41441, 48577, 50545, 56279, 58081, 59081, 61447, 75077, 91187, 95761, 96139, 116821, 127937, 146329, 148943, 150281, 157693, 170039, 180517, 188501, 207761, 208349, 244649, 281017, 311579, 316409, 349441, 350173, 363091, 371399, 397927, 423721, 440833, 459191, 473801, 479119, 493697, ...
</dd>
</dl>

<p>The quadratic polynomial 

<math display="inline" id="Frobenius_pseudoprime:10">
 <semantics>
  <mrow>
   <msup>
    <mi>x</mi>
    <mn>2</mn>
   </msup>
   <mo>-</mo>
   <mrow>
    <mn>3</mn>
    <mi>x</mi>
   </mrow>
   <mo>-</mo>
   <mn>5</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <minus></minus>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>x</ci>
     <cn type="integer">2</cn>
    </apply>
    <apply>
     <times></times>
     <cn type="integer">3</cn>
     <ci>x</ci>
    </apply>
    <cn type="integer">5</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \scriptstyle x^{2}-3x-5
  </annotation>
 </semantics>
</math>

, with 

<math display="inline" id="Frobenius_pseudoprime:11">
 <semantics>
  <mrow>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>P</mi>
    <mo>,</mo>
    <mi>Q</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mo stretchy="false">(</mo>
    <mn>3</mn>
    <mo>,</mo>
    <mrow>
     <mo>-</mo>
     <mn>5</mn>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <interval closure="open">
     <ci>P</ci>
     <ci>Q</ci>
    </interval>
    <interval closure="open">
     <cn type="integer">3</cn>
     <apply>
      <minus></minus>
      <cn type="integer">5</cn>
     </apply>
    </interval>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \scriptstyle(P,Q)=(3,-5)
  </annotation>
 </semantics>
</math>

, has sparse pseudoprimes compared to many other simple quadratics. Using the same process above we get the sequence:</p>
<dl>
<dd>13333, 44801, 486157, 1615681, 3125281, 4219129, 9006401, 12589081, 13404751, 15576571, 16719781, ...
</dd>
</dl>

<p>Every entry in this sequence is a Fermat pseudoprime to base 5 as well as a Lucas (3,-5) pseudoprime, but the converse is not true: 642001 is both a psp-5 and a Lucas (3,-5) pseudoprime, but is not a Frobenius (3,-5) pseudoprime.</p>

<p>Using parameter selection ideas first laid out in Baillie and Wagstaff 1980 <a class="footnoteRef" href="#fn7" id="fnref7"><sup>7</sup></a> as part of the <a href="Baillie-PSW_primality_test" title="wikilink">Baillie-PSW primality test</a> and used by Grantham in his <a href="Quadratic_Frobenius_test" title="wikilink">Quadratic Frobenius Test</a> <a class="footnoteRef" href="#fn8" id="fnref8"><sup>8</sup></a> we can create even better quadratic tests, for instance using the parameters (P,2) where P is the first odd that satisfies 

<math display="inline" id="Frobenius_pseudoprime:12">
 <semantics>
  <mrow>
   <mrow>
    <mo>(</mo>
    <mfrac>
     <mi>D</mi>
     <mi>n</mi>
    </mfrac>
    <mo>)</mo>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mo>-</mo>
    <mn>1</mn>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <divide></divide>
     <ci>D</ci>
     <ci>n</ci>
    </apply>
    <apply>
     <minus></minus>
     <cn type="integer">1</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \scriptstyle\left(\tfrac{D}{n}\right)=-1
  </annotation>
 </semantics>
</math>

, which has no pseudoprimes less than 

<math display="inline" id="Frobenius_pseudoprime:13">
 <semantics>
  <msup>
   <mn>2</mn>
   <mn>64</mn>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <cn type="integer">2</cn>
    <cn type="integer">64</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \scriptstyle 2^{64}
  </annotation>
 </semantics>
</math>

.</p>
<h2 id="relations-to-other-pseudoprimes">Relations to other pseudoprimes</h2>

<p>For quadratic polynomials 

<math display="inline" id="Frobenius_pseudoprime:14">
 <semantics>
  <mrow>
   <mrow>
    <msup>
     <mi>x</mi>
     <mn>2</mn>
    </msup>
    <mo>-</mo>
    <mrow>
     <mi>P</mi>
     <mi>x</mi>
    </mrow>
   </mrow>
   <mo>+</mo>
   <mi>Q</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <plus></plus>
    <apply>
     <minus></minus>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>x</ci>
      <cn type="integer">2</cn>
     </apply>
     <apply>
      <times></times>
      <ci>P</ci>
      <ci>x</ci>
     </apply>
    </apply>
    <ci>Q</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \scriptstyle x^{2}-Px+Q
  </annotation>
 </semantics>
</math>

, every Frobenius (P,Q) pseudoprime is also a Lucas (P,Q) pseudoprime. <a class="footnoteRef" href="#fn9" id="fnref9"><sup>9</sup></a> <a class="footnoteRef" href="#fn10" id="fnref10"><sup>10</sup></a> <a class="footnoteRef" href="#fn11" id="fnref11"><sup>11</sup></a> This immediately follows from condition (1) which defined a Lucas (P,Q) pseudoprime. The converse is not true, making the Frobenius pseudoprimes a subset of the Lucas pseudoprimes for a given (P,Q). The condition on 

<math display="inline" id="Frobenius_pseudoprime:15">
 <semantics>
  <msub>
   <mi>V</mi>
   <mi>k</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>V</ci>
    <ci>k</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \scriptstyle V_{k}
  </annotation>
 </semantics>
</math>

 indicate it must also be a <a href="Dickson_pseudoprime" title="wikilink">Dickson pseudoprime</a> of the second kind.<a class="footnoteRef" href="#fn12" id="fnref12"><sup>12</sup></a></p>

<p>Every Frobenius pseudoprime to 

<math display="inline" id="Frobenius_pseudoprime:16">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <msup>
      <mi>x</mi>
      <mn>3</mn>
     </msup>
     <mo>-</mo>
     <mrow>
      <mi>r</mi>
      <msup>
       <mi>x</mi>
       <mn>2</mn>
      </msup>
     </mrow>
    </mrow>
    <mo>+</mo>
    <mrow>
     <mi>s</mi>
     <mi>x</mi>
    </mrow>
   </mrow>
   <mo>-</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <minus></minus>
    <apply>
     <plus></plus>
     <apply>
      <minus></minus>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>x</ci>
       <cn type="integer">3</cn>
      </apply>
      <apply>
       <times></times>
       <ci>r</ci>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>x</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <ci>s</ci>
      <ci>x</ci>
     </apply>
    </apply>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x^{3}-rx^{2}+sx-1
  </annotation>
 </semantics>
</math>

 is also a <a href="Perrin_pseudoprime" title="wikilink">Perrin pseudoprime</a>.<a class="footnoteRef" href="#fn13" id="fnref13"><sup>13</sup></a></p>
<h2 id="alternate-formulations">Alternate formulations</h2>

<p>An alternate formulation is given by Khashin.<a class="footnoteRef" href="#fn14" id="fnref14"><sup>14</sup></a> Given a number <em>n</em>, not a perfect square, where <em>c</em> is the smallest odd prime with Jacobi symbol 

<math display="inline" id="Frobenius_pseudoprime:17">
 <semantics>
  <mrow>
   <mrow>
    <mo>(</mo>
    <mfrac>
     <mi>c</mi>
     <mi>n</mi>
    </mfrac>
    <mo>)</mo>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mo>-</mo>
    <mn>1</mn>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <divide></divide>
     <ci>c</ci>
     <ci>n</ci>
    </apply>
    <apply>
     <minus></minus>
     <cn type="integer">1</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \left(\tfrac{c}{n}\right)=-1
  </annotation>
 </semantics>
</math>

, <em>n</em> is a either a prime or Frobenius pseudoprime if:</p>

<p>

<math display="block" id="Frobenius_pseudoprime:18">
 <semantics>
  <mrow>
   <msup>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mn>1</mn>
      <mo>+</mo>
      <msqrt>
       <mi>c</mi>
      </msqrt>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
    <mi>n</mi>
   </msup>
   <mo>≡</mo>
   <mrow>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mn>1</mn>
      <mo>-</mo>
      <msqrt>
       <mi>c</mi>
      </msqrt>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
    <mspace width="veryverythickmathspace">
    </mspace>
    <mrow>
     <mo lspace="8.1pt" stretchy="false">(</mo>
     <mrow>
      <mo>mod</mo>
      <mi>n</mi>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <equivalent></equivalent>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <plus></plus>
      <cn type="integer">1</cn>
      <apply>
       <root></root>
       <ci>c</ci>
      </apply>
     </apply>
     <ci>n</ci>
    </apply>
    <apply>
     <csymbol cd="latexml">annotated</csymbol>
     <apply>
      <minus></minus>
      <cn type="integer">1</cn>
      <apply>
       <root></root>
       <ci>c</ci>
      </apply>
     </apply>
     <apply>
      <ci>pmod</ci>
      <ci>n</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (1+\sqrt{c})^{n}\equiv(1-\sqrt{c})\;\;(\mathop{{\rm mod}}n)
  </annotation>
 </semantics>
</math>

.</p>

<p>Note the additional condition of choosing a parameter based on the Jacobi symbol finding a quadratic non-residue. This is similar to the method from Baillie and Wagstaff shown in the examples section.<a class="footnoteRef" href="#fn15" id="fnref15"><sup>15</sup></a> This makes far stronger tests, and is one reason for the success of the <a href="Baillie-PSW_primality_test" title="wikilink">Baillie-PSW primality test</a>. Similar to the example, Khashin notes that no pseudoprime has been found for his test. He further shows that any that exist under 2<sup>60</sup> must have a factor less than 19 or have <em>c</em> &gt; 128.</p>
<h2 id="strong-frobenius-pseudoprimes">Strong Frobenius pseudoprimes</h2>

<p>Strong Frobenius pseudoprimes are also defined.<a class="footnoteRef" href="#fn16" id="fnref16"><sup>16</sup></a> Details on implementation for quadratic polynomials can be found in Crandall and Pomerance.<a class="footnoteRef" href="#fn17" id="fnref17"><sup>17</sup></a></p>
<h2 id="properties">Properties</h2>

<p>The computational cost of the Frobenius pseudoprime test for quadratic polynomials is roughly three times the cost of a <a href="strong_pseudoprime" title="wikilink">strong pseudoprime</a> test (e.g. a single round of the <a href="Miller-Rabin_primality_test" title="wikilink">Miller-Rabin primality test</a>), 1.5 times that of a <a href="Lucas_pseudoprime" title="wikilink">Lucas pseudoprime</a> test, and slightly more than a <a href="Baillie-PSW_primality_test" title="wikilink">Baillie-PSW primality test</a>.</p>

<p>Note that the quadratic Frobenius test is stronger than the Lucas test. For example, 1763 is a Lucas pseudoprime to (<em>P</em>, <em>Q</em>) = (3, -1) since <em>U</em><sub>1764</sub> = 0 (mod 1763) where <em>U</em> is , and it also passes the Jacobi step since 

<math display="inline" id="Frobenius_pseudoprime:19">
 <semantics>
  <mrow>
   <mo>(</mo>
   <mfrac>
    <mn>13</mn>
    <mn>1763</mn>
   </mfrac>
   <mo>)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <divide></divide>
    <cn type="integer">13</cn>
    <cn type="integer">1763</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \left(\tfrac{13}{1763}\right)
  </annotation>
 </semantics>
</math>

 = -1, but it fails the Frobenius test to x<sup>2</sup> - 3x - 1. This property can be clearly seen when the algorithm is formulated as shown in Crandall and Pomerance Algorithm 3.6.9<a class="footnoteRef" href="#fn18" id="fnref18"><sup>18</sup></a> or as shown by Loebenberger,<a class="footnoteRef" href="#fn19" id="fnref19"><sup>19</sup></a> as the algorithm does a Lucas test followed by an additional check for the Frobenius condition.</p>

<p>While the quadratic Frobenius test does not have formal error bounds beyond that of the Lucas test, it can be used as the basis for methods with much smaller error bounds. Note that these have more steps, additional requirements, and non-negligible additional computation beyond what is described on this page. It is important to note that the error bounds for these methods <strong>do not apply</strong> to the standard or strong Frobenius tests with fixed values of (P,Q) described on this page.</p>

<p>Based on this idea of pseudoprimes, algorithms with strong worst-case error bounds can be built. The <a href="Quadratic_Frobenius_test" title="wikilink">Quadratic Frobenius Test</a><a class="footnoteRef" href="#fn20" id="fnref20"><sup>20</sup></a> has a bound of 

<math display="inline" id="Frobenius_pseudoprime:20">
 <semantics>
  <mfrac>
   <mn>1</mn>
   <mn>7710</mn>
  </mfrac>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <divide></divide>
    <cn type="integer">1</cn>
    <cn type="integer">7710</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \tfrac{1}{7710}
  </annotation>
 </semantics>
</math>

. Müller in 2001 proposed the MQFT test with bounds of essentially 

<math display="inline" id="Frobenius_pseudoprime:21">
 <semantics>
  <mfrac>
   <mn>1</mn>
   <msup>
    <mn>131040</mn>
    <mi>t</mi>
   </msup>
  </mfrac>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <divide></divide>
    <cn type="integer">1</cn>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <cn type="integer">131040</cn>
     <ci>t</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \tfrac{1}{131040^{t}}
  </annotation>
 </semantics>
</math>

. <a class="footnoteRef" href="#fn21" id="fnref21"><sup>21</sup></a> Damgård and Frandsen in 2003 proposed the EQFT with a bound of essentially 

<math display="inline" id="Frobenius_pseudoprime:22">
 <semantics>
  <mfrac>
   <mn>256</mn>
   <msup>
    <mn>331776</mn>
    <mi>t</mi>
   </msup>
  </mfrac>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <divide></divide>
    <cn type="integer">256</cn>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <cn type="integer">331776</cn>
     <ci>t</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \tfrac{256}{{331776}^{t}}
  </annotation>
 </semantics>
</math>

. <a class="footnoteRef" href="#fn22" id="fnref22"><sup>22</sup></a> Seysen in 2005 proposed the SQFT test with a bound of 

<math display="inline" id="Frobenius_pseudoprime:23">
 <semantics>
  <mfrac>
   <mn>1</mn>
   <msup>
    <mn>4096</mn>
    <mi>t</mi>
   </msup>
  </mfrac>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <divide></divide>
    <cn type="integer">1</cn>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <cn type="integer">4096</cn>
     <ci>t</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \tfrac{1}{{4096}^{t}}
  </annotation>
 </semantics>
</math>

 and a SQFT3 test with a bound of 

<math display="inline" id="Frobenius_pseudoprime:24">
 <semantics>
  <mfrac>
   <mn>16</mn>
   <msup>
    <mn>336442</mn>
    <mi>t</mi>
   </msup>
  </mfrac>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <divide></divide>
    <cn type="integer">16</cn>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <cn type="integer">336442</cn>
     <ci>t</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \tfrac{16}{336442^{t}}
  </annotation>
 </semantics>
</math>

. <a class="footnoteRef" href="#fn23" id="fnref23"><sup>23</sup></a></p>

<p>Given the same computational effort, these offer better worst-case bounds than the commonly used <a href="Miller-Rabin_primality_test" title="wikilink">Miller-Rabin primality test</a>.</p>
<h2 id="see-also">See also</h2>
<ul>
<li><a class="uri" href="Pseudoprime" title="wikilink">Pseudoprime</a></li>
<li><a href="Lucas_pseudoprime" title="wikilink">Lucas pseudoprime</a></li>
<li><a href="Ferdinand_Georg_Frobenius" title="wikilink">Ferdinand Georg Frobenius</a></li>
<li><a href="Quadratic_Frobenius_test" title="wikilink">Quadratic Frobenius test</a></li>
</ul>
<h2 id="references">References</h2>
<h2 id="external-links">External links</h2>
<ul>
<li></li>
<li></li>
<li>Jacobsen, Dana <a href="http://ntheory.org/pseudoprimes.html">Pseudoprime Statistics, Tables, and Data</a> (data for Frobenius (1,-1) and (3,-5) pseudoprimes)</li>
</ul>

<p>"</p>

<p><a class="uri" href="Category:Pseudoprimes" title="wikilink">Category:Pseudoprimes</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1"><a href="#fnref1">↩</a></li>
<li id="fn2"><a href="#fnref2">↩</a></li>
<li id="fn3"><a href="#fnref3">↩</a></li>
<li id="fn4"><a href="#fnref4">↩</a></li>
<li id="fn5"></li>
<li id="fn6"></li>
<li id="fn7"><a href="#fnref7">↩</a></li>
<li id="fn8"><a href="#fnref8">↩</a></li>
<li id="fn9"></li>
<li id="fn10"></li>
<li id="fn11"><a href="#fnref11">↩</a></li>
<li id="fn12"></li>
<li id="fn13"></li>
<li id="fn14"><a href="#fnref14">↩</a></li>
<li id="fn15"></li>
<li id="fn16"></li>
<li id="fn17"></li>
<li id="fn18"></li>
<li id="fn19"></li>
<li id="fn20"></li>
<li id="fn21"><a href="#fnref21">↩</a></li>
<li id="fn22"><a href="#fnref22">↩</a></li>
<li id="fn23">Martin Seysen. A Simplified Quadratic Frobenius Primality Test, 2005, <a class="uri" href="http://eprint.iacr.org/2005/462">http://eprint.iacr.org/2005/462</a><a href="#fnref23">↩</a></li>
</ol>
</section>
</body>
</html>

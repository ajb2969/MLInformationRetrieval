<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="30">COMP128</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>COMP128</h1>
<hr/>

<p>The <strong>COMP128</strong> algorithms are implementations of the A3 and A8 algorithms defined in the <a class="uri" href="GSM" title="wikilink">GSM</a> standard. The A3 algorithm is used to <a href="authentication" title="wikilink">authenticate</a> the mobile station to the network. The A8 algorithm is used to generate the <a href="session_key" title="wikilink">session key</a> used by A5 to encrypt the data transmitted between the mobile station and the <a href="Base_Transceiver_Station" title="wikilink">BTS</a>.</p>

<p>Currently there exist four versions of COMP128. The first three were originally confidential. A partial description of the first version was leaked in 1997 and completed via <a href="reverse_engineering" title="wikilink">reverse engineering</a>. This led to a full publication in 1998.<a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a> The second and third versions were obtained via reverse engineering of software which verifies SIM cards compliance.<a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a></p>
<h2 id="introduction">Introduction</h2>

<p>For details on the way A3 and A8 are used see <a href="Network_switching_subsystem#Authentication_centre_(AuC)" title="wikilink">Authentication Center</a>.</p>

<p>A3 and A8 both take a 128 bits key (<em>K<sub>i</sub></em>) and a 128 bits <a href="Challenge-response_authentication" title="wikilink">challenge</a> (<em>RAND</em>) as inputs. A3 produces a 32 bits response (<em>SRES</em>) and A8 produces a 64 bits session key (<em>K<sub>c</sub></em>).</p>

<p>The COMP128 algorithms combine the functionality of A3 and A8.</p>
<h2 id="comp128-algorithms">COMP128 algorithms</h2>

<p>Several COMP128 algorithms were designed:</p>
<ul>
<li>COMP128-1 – original algorithm with known weaknesses</li>
<li>COMP128-2 – stronger algorithm which still clears the 10 rightmost bits of <em>K<sub>c</sub></em></li>
<li>COMP128-3 – same algorithm as COMP128-2 with all 64-bits of <em>K<sub>c</sub></em> generated</li>
<li>COMP128-4 – based on the <a class="uri" href="3GPP" title="wikilink">3GPP</a> (3rd Generation Partnership Project) algorithm ("Milenage"), which uses AES</li>
</ul>
<h2 id="comp128-1-description">COMP128-1 Description</h2>

<p>COMP128-1 is built around a compression function with two 128 bits inputs and one 128 bits output. The function has eight rounds and is based on a butterfly structure with five stages.</p>
<h2 id="comp128-23-description">COMP128-2/3 Description</h2>

<p>The implementation of COMP128-2 and COMP128-3 is noticeably more complex than COMP128-1. For a full description of the algorithm, the reader can view the <a href="http://git.osmocom.org/libosmocore/tree/src/gsm/comp128v23.c">OsmocomBB implementation</a>. COMP128-2 is identical to COMP128-3 except for the fact that at the end, it clears the 10 rightmost bits of <em>K<sub>c</sub></em>.</p>
<h2 id="security">Security</h2>

<p>The COMP128-1 hash function is considered weak because there is insufficient <a href="Confusion_and_diffusion" title="wikilink">diffusion</a> of small changes in the input.</p>

<p>Practical attacks have been demonstrated that can recover the subscriber key from the SIM.<a class="footnoteRef" href="#fn3" id="fnref3"><sup>3</sup></a></p>

<p>The session keys produced by COMP128-1 and COMP128-2 have only 54 bits of entropy. This significantly weakens the A5 or A6 encryption.</p>
<h2 id="references">References</h2>
<references>

<p><a class="footnoteRef" href="#fn4" id="fnref4"><sup>4</sup></a> <a class="footnoteRef" href="#fn5" id="fnref5"><sup>5</sup></a> <a class="footnoteRef" href="#fn6" id="fnref6"><sup>6</sup></a></p>
</references>
<h2 id="external-links">External links</h2>
<ul>
<li></li>
<li></li>
</ul>

<p>"</p>

<p><a href="Category:GSM_standard" title="wikilink">Category:GSM standard</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1"></li>
<li id="fn2"></li>
<li id="fn3"></li>
<li id="fn4"><a href="#fnref4">↩</a></li>
<li id="fn5"><a href="#fnref5">↩</a></li>
<li id="fn6"><a href="#fnref6">↩</a></li>
</ol>
</section>
</body>
</html>

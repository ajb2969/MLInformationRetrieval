<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="540">Nodal analysis</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Nodal analysis</h1>
<hr/>

<p><a href="File:KCL.png" title="wikilink">framed|Kirchhoff's current law is the basis of nodal analysis.</a> In electric circuits analysis, <strong>nodal analysis</strong>, <strong>node-voltage analysis</strong>, or the <strong>branch current method</strong> is a method of determining the voltage (<a href="potential_difference" title="wikilink">potential difference</a>) between "<a href="Node_(circuits)" title="wikilink">nodes</a>" (points where elements or branches connect) in an <a href="electrical_circuit" title="wikilink">electrical circuit</a> in terms of the branch currents.</p>

<p>In analyzing a circuit using <a href="Kirchhoff's_circuit_laws" title="wikilink">Kirchhoff's circuit laws</a>, one can either do nodal analysis using Kirchhoff's current law (KCL) or <a href="mesh_analysis" title="wikilink">mesh analysis</a> using Kirchhoff's voltage law (KVL). Nodal analysis writes an equation at each <a href="Node_(circuits)" title="wikilink">electrical node</a>, requiring that the branch currents incident at a node must sum to zero. The branch currents are written in terms of the circuit node voltages. As a consequence, each branch constitutive relation must give current as a function of voltage; an <a class="uri" href="admittance" title="wikilink">admittance</a> representation. For instance, for a resistor, I<sub>branch</sub> = V<sub>branch</sub> * G, where G (=1/R) is the admittance (conductance) of the resistor.</p>

<p>Nodal analysis is possible when all the circuit elements' branch constitutive relations have an admittance representation. Nodal analysis produces a compact set of equations for the network, which can be solved by hand if small, or can be quickly solved using linear algebra by computer. Because of the compact system of equations, many <a href="circuit_simulation" title="wikilink">circuit simulation</a> programs (e.g. <a class="uri" href="SPICE" title="wikilink">SPICE</a>) use nodal analysis as a basis. When elements do not have admittance representations, a more general extension of nodal analysis, <a href="modified_nodal_analysis" title="wikilink">modified nodal analysis</a>, can be used.</p>
<h2 id="method">Method</h2>
<ol>
<li>Note all connected wire segments in the circuit. These are the <em>nodes</em> of nodal analysis.</li>
<li>Select one node as the ground reference. The choice does not affect the result and is just a matter of convention. Choosing the node with the most connections can simplify the analysis. For a circuit of <em>N</em> nodes the number of nodal equations is <em>N</em>−1.</li>
<li>Assign a variable for each node whose voltage is unknown. If the voltage is already known, it is not necessary to assign a variable.</li>
<li>For each unknown voltage, form an equation based on Kirchhoff's current law. Basically, add together all currents leaving from the node and mark the sum equal to zero. Finding the current between two nodes is nothing more than "the node you're on, minus the node you're going to, divided by the resistance between the two nodes."</li>
<li>If there are voltage sources between two unknown voltages, join the two nodes as a <a href="supernode_(circuit)" title="wikilink">supernode</a>. The currents of the two nodes are combined in a single equation, and a new equation for the voltages is formed.</li>
<li>Solve the system of <a href="simultaneous_equations" title="wikilink">simultaneous equations</a> for each unknown voltage.</li>
</ol>
<h2 id="examples">Examples</h2>
<h3 id="basic-case">Basic case</h3>
<figure><b>(Figure)</b>
<figcaption>Basic example circuit with one unknown voltage, V<sub>1</sub>.</figcaption>
</figure>

<p>The only unknown voltage in this circuit is V<sub>1</sub>. There are three connections to this node and consequently three currents to consider. The direction of the currents in calculations is chosen to be away from the node.</p>
<ol>
<li>Current through resistor R<sub>1</sub>: (V<sub>1</sub> - V<sub>S</sub>) / R<sub>1</sub></li>
<li>Current through resistor R<sub>2</sub>: V<sub>1</sub> / R<sub>2</sub></li>
<li>Current through current source I<sub>S</sub>: -I<sub>S</sub></li>
</ol>

<p><br/>
With Kirchhoff's current law, we get:</p>

<p>

<math display="inline" id="Nodal_analysis:0">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mfrac>
      <mrow>
       <msub>
        <mi>V</mi>
        <mn>1</mn>
       </msub>
       <mo>-</mo>
       <msub>
        <mi>V</mi>
        <mi>S</mi>
       </msub>
      </mrow>
      <msub>
       <mi>R</mi>
       <mn>1</mn>
      </msub>
     </mfrac>
     <mo>+</mo>
     <mfrac>
      <msub>
       <mi>V</mi>
       <mn>1</mn>
      </msub>
      <msub>
       <mi>R</mi>
       <mn>2</mn>
      </msub>
     </mfrac>
    </mrow>
    <mo>-</mo>
    <msub>
     <mi>I</mi>
     <mi>S</mi>
    </msub>
   </mrow>
   <mo>=</mo>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <minus></minus>
     <apply>
      <plus></plus>
      <apply>
       <divide></divide>
       <apply>
        <minus></minus>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>V</ci>
         <cn type="integer">1</cn>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>V</ci>
         <ci>S</ci>
        </apply>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>R</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <apply>
       <divide></divide>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>V</ci>
        <cn type="integer">1</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>R</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>I</ci>
      <ci>S</ci>
     </apply>
    </apply>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \frac{V_{1}-V_{S}}{R_{1}}+\frac{V_{1}}{R_{2}}-I_{S}=0
  </annotation>
 </semantics>
</math>

<br/>
 This equation can be solved in respect to V<sub>1</sub>:</p>

<p>

<math display="inline" id="Nodal_analysis:1">
 <semantics>
  <mrow>
   <msub>
    <mi>V</mi>
    <mn>1</mn>
   </msub>
   <mo>=</mo>
   <mfrac>
    <mrow>
     <mo>(</mo>
     <mrow>
      <mfrac>
       <msub>
        <mi>V</mi>
        <mi>S</mi>
       </msub>
       <mrow>
        <mi>R</mi>
        <mn>1</mn>
       </mrow>
      </mfrac>
      <mo>+</mo>
      <msub>
       <mi>I</mi>
       <mi>S</mi>
      </msub>
     </mrow>
     <mo>)</mo>
    </mrow>
    <mrow>
     <mo>(</mo>
     <mrow>
      <mfrac>
       <mn>1</mn>
       <msub>
        <mi>R</mi>
        <mn>1</mn>
       </msub>
      </mfrac>
      <mo>+</mo>
      <mfrac>
       <mn>1</mn>
       <msub>
        <mi>R</mi>
        <mn>2</mn>
       </msub>
      </mfrac>
     </mrow>
     <mo>)</mo>
    </mrow>
   </mfrac>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>V</ci>
     <cn type="integer">1</cn>
    </apply>
    <apply>
     <divide></divide>
     <apply>
      <plus></plus>
      <apply>
       <divide></divide>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>V</ci>
        <ci>S</ci>
       </apply>
       <apply>
        <times></times>
        <ci>R</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>I</ci>
       <ci>S</ci>
      </apply>
     </apply>
     <apply>
      <plus></plus>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>R</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>R</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   V_{1}=\frac{\left(\frac{V_{S}}{R1}+I_{S}\right)}{\left(\frac{1}{R_{1}}+\frac{1%
}{R_{2}}\right)}
  </annotation>
 </semantics>
</math>

<br/>
 Finally, the unknown voltage can be solved by substituting numerical values for the symbols. Any unknown currents are easy to calculate after all the voltages in the circuit are known.</p>

<p>

<math display="inline" id="Nodal_analysis:2">
 <semantics>
  <mrow>
   <msub>
    <mi>V</mi>
    <mn>1</mn>
   </msub>
   <mo>=</mo>
   <mfrac>
    <mrow>
     <mo>(</mo>
     <mrow>
      <mfrac>
       <mrow>
        <mn>5</mn>
        <mtext>V</mtext>
       </mrow>
       <mrow>
        <mpadded width="+1.7pt">
         <mn>100</mn>
        </mpadded>
        <mi mathvariant="normal">Ω</mi>
       </mrow>
      </mfrac>
      <mo>+</mo>
      <mrow>
       <mn>20</mn>
       <mtext>mA</mtext>
      </mrow>
     </mrow>
     <mo>)</mo>
    </mrow>
    <mrow>
     <mo>(</mo>
     <mrow>
      <mfrac>
       <mn>1</mn>
       <mrow>
        <mpadded width="+1.7pt">
         <mn>100</mn>
        </mpadded>
        <mi mathvariant="normal">Ω</mi>
       </mrow>
      </mfrac>
      <mo>+</mo>
      <mfrac>
       <mn>1</mn>
       <mrow>
        <mpadded width="+1.7pt">
         <mn>200</mn>
        </mpadded>
        <mi mathvariant="normal">Ω</mi>
       </mrow>
      </mfrac>
     </mrow>
     <mo>)</mo>
    </mrow>
   </mfrac>
   <mo>≈</mo>
   <mrow>
    <mn>4.667</mn>
    <mtext>V</mtext>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>V</ci>
      <cn type="integer">1</cn>
     </apply>
     <apply>
      <divide></divide>
      <apply>
       <plus></plus>
       <apply>
        <divide></divide>
        <apply>
         <times></times>
         <cn type="integer">5</cn>
         <mtext>V</mtext>
        </apply>
        <apply>
         <times></times>
         <cn type="integer">100</cn>
         <ci>normal-Ω</ci>
        </apply>
       </apply>
       <apply>
        <times></times>
        <cn type="integer">20</cn>
        <mtext>mA</mtext>
       </apply>
      </apply>
      <apply>
       <plus></plus>
       <apply>
        <divide></divide>
        <cn type="integer">1</cn>
        <apply>
         <times></times>
         <cn type="integer">100</cn>
         <ci>normal-Ω</ci>
        </apply>
       </apply>
       <apply>
        <divide></divide>
        <cn type="integer">1</cn>
        <apply>
         <times></times>
         <cn type="integer">200</cn>
         <ci>normal-Ω</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <approx></approx>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <cn type="float">4.667</cn>
      <mtext>V</mtext>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   V_{1}=\frac{\left(\frac{5\text{ V}}{100\,\Omega}+20\text{ mA}\right)}{\left(%
\frac{1}{100\,\Omega}+\frac{1}{200\,\Omega}\right)}\approx 4.667\text{ V}
  </annotation>
 </semantics>
</math>

</p>
<h3 id="supernodes">Supernodes</h3>

<p> In this circuit, we initially have two unknown voltages, V<sub>1</sub> and V<sub>2</sub>. The voltage at V<sub>3</sub> is already known to be V<sub>B</sub> because the other terminal of the voltage source is at ground potential.</p>

<p>The current going through voltage source V<sub>A</sub> cannot be directly calculated. Therefore we can not write the current equations for either V<sub>1</sub> or V<sub>2</sub>. However, we know that the same current leaving node V<sub>2</sub> must enter node V<sub>1</sub>. Even though the nodes can not be individually solved, we know that the combined current of these two nodes is zero. This combining of the two nodes is called the <a href="supernode_(circuit)" title="wikilink">supernode</a> technique, and it requires one additional equation: V<sub>1</sub> = V<sub>2</sub> + V<sub>A</sub>.</p>

<p>The complete set of equations for this circuit is:</p>

<p>

<math display="inline" id="Nodal_analysis:3">
 <semantics>
  <mrow>
   <mo>{</mo>
   <mtable>
    <mtr>
     <mtd columnalign="left">
      <mrow>
       <mrow>
        <mfrac>
         <mrow>
          <msub>
           <mi>V</mi>
           <mn>1</mn>
          </msub>
          <mo>-</mo>
          <msub>
           <mi>V</mi>
           <mtext>B</mtext>
          </msub>
         </mrow>
         <msub>
          <mi>R</mi>
          <mn>1</mn>
         </msub>
        </mfrac>
        <mo>+</mo>
        <mfrac>
         <mrow>
          <msub>
           <mi>V</mi>
           <mn>2</mn>
          </msub>
          <mo>-</mo>
          <msub>
           <mi>V</mi>
           <mtext>B</mtext>
          </msub>
         </mrow>
         <msub>
          <mi>R</mi>
          <mn>2</mn>
         </msub>
        </mfrac>
        <mo>+</mo>
        <mfrac>
         <msub>
          <mi>V</mi>
          <mn>2</mn>
         </msub>
         <msub>
          <mi>R</mi>
          <mn>3</mn>
         </msub>
        </mfrac>
       </mrow>
       <mo>=</mo>
       <mn>0</mn>
      </mrow>
     </mtd>
     <mtd></mtd>
    </mtr>
    <mtr>
     <mtd columnalign="left">
      <mrow>
       <msub>
        <mi>V</mi>
        <mn>1</mn>
       </msub>
       <mo>=</mo>
       <mrow>
        <msub>
         <mi>V</mi>
         <mn>2</mn>
        </msub>
        <mo>+</mo>
        <msub>
         <mi>V</mi>
         <mtext>A</mtext>
        </msub>
       </mrow>
      </mrow>
     </mtd>
     <mtd></mtd>
    </mtr>
   </mtable>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">cases</csymbol>
    <apply>
     <eq></eq>
     <apply>
      <plus></plus>
      <apply>
       <divide></divide>
       <apply>
        <minus></minus>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>V</ci>
         <cn type="integer">1</cn>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>V</ci>
         <mtext>B</mtext>
        </apply>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>R</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <apply>
       <divide></divide>
       <apply>
        <minus></minus>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>V</ci>
         <cn type="integer">2</cn>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>V</ci>
         <mtext>B</mtext>
        </apply>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>R</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
      <apply>
       <divide></divide>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>V</ci>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>R</ci>
        <cn type="integer">3</cn>
       </apply>
      </apply>
     </apply>
     <cn type="integer">0</cn>
    </apply>
    <mtext>otherwise</mtext>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>V</ci>
      <cn type="integer">1</cn>
     </apply>
     <apply>
      <plus></plus>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>V</ci>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>V</ci>
       <mtext>A</mtext>
      </apply>
     </apply>
    </apply>
    <mtext>otherwise</mtext>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \begin{cases}\frac{V_{1}-V_{\text{B}}}{R_{1}}+\frac{V_{2}-V_{\text{B}}}{R_{2}}%
+\frac{V_{2}}{R_{3}}=0\\
V_{1}=V_{2}+V_{\text{A}}\\
\end{cases}
  </annotation>
 </semantics>
</math>

</p>

<p>By substituting V<sub>1</sub> to the first equation and solving in respect to V2, we get:</p>

<p>

<math display="inline" id="Nodal_analysis:4">
 <semantics>
  <mrow>
   <msub>
    <mi>V</mi>
    <mn>2</mn>
   </msub>
   <mo>=</mo>
   <mfrac>
    <mrow>
     <mrow>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <msub>
         <mi>R</mi>
         <mn>1</mn>
        </msub>
        <mo>+</mo>
        <msub>
         <mi>R</mi>
         <mn>2</mn>
        </msub>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
      <msub>
       <mi>R</mi>
       <mn>3</mn>
      </msub>
      <msub>
       <mi>V</mi>
       <mtext>B</mtext>
      </msub>
     </mrow>
     <mo>-</mo>
     <mrow>
      <msub>
       <mi>R</mi>
       <mn>2</mn>
      </msub>
      <msub>
       <mi>R</mi>
       <mn>3</mn>
      </msub>
      <msub>
       <mi>V</mi>
       <mtext>A</mtext>
      </msub>
     </mrow>
    </mrow>
    <mrow>
     <mrow>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <msub>
         <mi>R</mi>
         <mn>1</mn>
        </msub>
        <mo>+</mo>
        <msub>
         <mi>R</mi>
         <mn>2</mn>
        </msub>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
      <msub>
       <mi>R</mi>
       <mn>3</mn>
      </msub>
     </mrow>
     <mo>+</mo>
     <mrow>
      <msub>
       <mi>R</mi>
       <mn>1</mn>
      </msub>
      <msub>
       <mi>R</mi>
       <mn>2</mn>
      </msub>
     </mrow>
    </mrow>
   </mfrac>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>V</ci>
     <cn type="integer">2</cn>
    </apply>
    <apply>
     <divide></divide>
     <apply>
      <minus></minus>
      <apply>
       <times></times>
       <apply>
        <plus></plus>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>R</ci>
         <cn type="integer">1</cn>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>R</ci>
         <cn type="integer">2</cn>
        </apply>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>R</ci>
        <cn type="integer">3</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>V</ci>
        <mtext>B</mtext>
       </apply>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>R</ci>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>R</ci>
        <cn type="integer">3</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>V</ci>
        <mtext>A</mtext>
       </apply>
      </apply>
     </apply>
     <apply>
      <plus></plus>
      <apply>
       <times></times>
       <apply>
        <plus></plus>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>R</ci>
         <cn type="integer">1</cn>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>R</ci>
         <cn type="integer">2</cn>
        </apply>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>R</ci>
        <cn type="integer">3</cn>
       </apply>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>R</ci>
        <cn type="integer">1</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>R</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   V_{2}=\frac{(R_{1}+R_{2})R_{3}V_{\text{B}}-R_{2}R_{3}V_{\text{A}}}{(R_{1}+R_{2%
})R_{3}+R_{1}R_{2}}
  </annotation>
 </semantics>
</math>

</p>
<h2 id="see-also">See also</h2>
<ul>
<li><a href="Mesh_analysis" title="wikilink">Mesh analysis</a></li>
<li><a href="Ybus_matrix" title="wikilink">Ybus matrix</a></li>
<li><a href="Topology_(electrical_circuits)" title="wikilink">Topology (electrical circuits)</a></li>
</ul>
<h2 id="references">References</h2>
<ul>
<li><a href="Paul_Dimo" title="wikilink">P. Dimo</a> Nodal Analysis of Power Systems Abacus Press Kent 1975</li>
</ul>
<h2 id="external-links">External links</h2>
<ul>
<li><a href="http://www.allaboutcircuits.com/vol_1/chpt_10/2.html">Branch current method</a></li>
<li><a href="http://www.catc.ac.ir/mazlumi/node.php">Online four-node problem solver</a></li>
<li><a href="http://wiki.syncleus.com/index.php/Nodal_Analysis">Simple Nodal Analysis Example</a></li>
</ul>

<p>"</p>

<p><a href="Category:Electronic_circuits" title="wikilink">Category:Electronic circuits</a> <a href="Category:Electrical_engineering" title="wikilink">Category:Electrical engineering</a></p>
</body>
</html>

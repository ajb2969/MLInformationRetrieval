<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="1992">Courant–Friedrichs–Lewy condition</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Courant–Friedrichs–Lewy condition</h1>
<hr>In [[mathematics]], the '''Courant–Friedrichs–Lewy (CFL) condition''' is a necessary condition for convergence while solving certain [[partial differential equation]]s (usually [[Hyperbolic partial differential equation|hyperbolic PDE]]s) numerically by the [[Finite difference method|method of finite differences]].<ref>In general, it is not a su
<p>fficient condition; also, it can be a demanding condition for some problems. See the "<a href="Courant–Friedrichs–Lewy_condition#Implications_of_the_CFL_condition" title="wikilink">Implications of the CFL condition</a>" section of this article for a brief survey of these issues. It arises in the <a href="numerical_analysis" title="wikilink">numerical analysis</a> of <a href="temporal_discretisation" title="wikilink">explicit time integration</a> schemes, when these are used for the numerical solution. As a consequence, the time step must be less than a certain time in many <a href="explicit_method" title="wikilink">explicit</a> time-marching <a href="computer_simulation" title="wikilink">computer simulations</a>, otherwise the simulation will produce incorrect results. The condition is named after <a href="Richard_Courant" title="wikilink">Richard Courant</a>, <a href="Kurt_Friedrichs" title="wikilink">Kurt Friedrichs</a>, and <a href="Hans_Lewy" title="wikilink">Hans Lewy</a> who described it in their 1928 paper.<a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a></p>
<h2 id="heuristic-description">Heuristic description</h2>

<p>The principle behind the condition is that, for example, if a wave is moving across a discrete spatial grid and we want to compute its <a class="uri" href="amplitude" title="wikilink">amplitude</a> at discrete time steps of equal duration,<a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a> then this duration must be less than the time for the wave to travel to adjacent grid points. As a corollary, when the grid point separation is reduced, the upper limit for the time step also decreases. In essence, the numerical domain of dependence of any point in space and time (as determined by initial conditions and the parameters of the approximation scheme) must include the analytical domain of dependence (wherein the initial conditions have an effect on the exact value of the solution at that point) in order to assure that the scheme can access the information required to form the solution.</p>
<h2 id="the-cfl-condition">The CFL condition</h2>

<p>In order to make a reasonably formally precise statement of the condition, it is necessary to define the following quantities</p>
<ul>
<li><em>Spatial coordinate</em>: it is one of the <a href="coordinate" title="wikilink">coordinates</a> of the <a href="physical_space" title="wikilink">physical space</a> in which the problem is posed.</li>
<li><em>Spatial dimension of the problem</em>: it is the number 

<math display="inline" id="Courant–Friedrichs–Lewy_condition:0">
 <semantics>
  <mi>n</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>n</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n
  </annotation>
 </semantics>
</math>

 of <a href="Dimension_(mathematics)" title="wikilink">spatial dimensions</a> i.e. the number of spatial <a href="coordinate" title="wikilink">coordinates</a> of the <a href="physical_space" title="wikilink">physical space</a> where the problem is posed. Typical values are 

<math display="inline" id="Courant–Friedrichs–Lewy_condition:1">
 <semantics>
  <mrow>
   <mi>n</mi>
   <mo>=</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>n</ci>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n=1
  </annotation>
 </semantics>
</math>

, 

<math display="inline" id="Courant–Friedrichs–Lewy_condition:2">
 <semantics>
  <mrow>
   <mi>n</mi>
   <mo>=</mo>
   <mn>2</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>n</ci>
    <cn type="integer">2</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n=2
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Courant–Friedrichs–Lewy_condition:3">
 <semantics>
  <mrow>
   <mi>n</mi>
   <mo>=</mo>
   <mn>3</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>n</ci>
    <cn type="integer">3</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n=3
  </annotation>
 </semantics>
</math>

.</li>
<li><em>Time</em>: it is the <a class="uri" href="coordinate" title="wikilink">coordinate</a>, acting as a <a class="uri" href="parameter" title="wikilink">parameter</a>, which describes the evolution of the system, distinct from the spatial coordinates.</li>
</ul>

<p>The spatial coordinates and the time are supposed to be discrete-valued independent <a href="Variable_(mathematics)" title="wikilink">variables</a>, which are placed at regular distances called the <em>interval length</em><a class="footnoteRef" href="#fn3" id="fnref3"><sup>3</sup></a> and the <em>time step</em>, respectively. Using these names, the CFL condition relates the length of the time step to a function of the interval lengths of each spatial coordinate and of the maximum speed with which information can travel in the physical space.</p>

<p>Operatively, the CFL condition is commonly prescribed for those terms of the <a href="finite-difference_approximation" title="wikilink">finite-difference approximation</a> of general <a href="partial_differential_equation" title="wikilink">partial differential equations</a> which model the <a class="uri" href="advection" title="wikilink">advection</a> phenomenon.<a class="footnoteRef" href="#fn4" id="fnref4"><sup>4</sup></a></p>
<h3 id="the-one-dimensional-case">The one-dimensional case</h3>

<p>For one-dimensional case, the CFL has the following form:</p>

<p>

<math display="block" id="Courant–Friedrichs–Lewy_condition:4">
 <semantics>
  <mrow>
   <mi>C</mi>
   <mo>=</mo>
   <mfrac>
    <mrow>
     <mpadded width="+1.7pt">
      <mi>u</mi>
     </mpadded>
     <mi mathvariant="normal">Δ</mi>
     <mi>t</mi>
    </mrow>
    <mrow>
     <mi mathvariant="normal">Δ</mi>
     <mi>x</mi>
    </mrow>
   </mfrac>
   <mo>≤</mo>
   <msub>
    <mi>C</mi>
    <mi>max</mi>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <ci>C</ci>
     <apply>
      <divide></divide>
      <apply>
       <times></times>
       <ci>u</ci>
       <ci>normal-Δ</ci>
       <ci>t</ci>
      </apply>
      <apply>
       <times></times>
       <ci>normal-Δ</ci>
       <ci>x</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <leq></leq>
     <share href="#.cmml">
     </share>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>C</ci>
      <max></max>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   C=\frac{u\,\Delta t}{\Delta x}\leq C_{\max}
  </annotation>
 </semantics>
</math>

</p>

<p>where the <a href="dimensionless_number" title="wikilink">dimensionless number</a> is called the <strong>Courant number</strong>,</p>
<ul>
<li>

<math display="inline" id="Courant–Friedrichs–Lewy_condition:5">
 <semantics>
  <mi>u</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>u</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   u
  </annotation>
 </semantics>
</math>

 is the <a href="Magnitude_(mathematics)" title="wikilink">magnitude</a> of the velocity (whose <a href="Dimensional_analysis#Definition" title="wikilink">dimension</a> is length/time)</li>
<li>

<math display="inline" id="Courant–Friedrichs–Lewy_condition:6">
 <semantics>
  <mrow>
   <mi mathvariant="normal">Δ</mi>
   <mi>t</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>normal-Δ</ci>
    <ci>t</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Delta t
  </annotation>
 </semantics>
</math>

 is the time step (whose <a href="Dimensional_analysis#Definition" title="wikilink">dimension</a> is time)</li>
<li>

<math display="inline" id="Courant–Friedrichs–Lewy_condition:7">
 <semantics>
  <mrow>
   <mi mathvariant="normal">Δ</mi>
   <mi>x</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>normal-Δ</ci>
    <ci>x</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Delta x
  </annotation>
 </semantics>
</math>

 is the length interval (whose <a href="Dimensional_analysis#Definition" title="wikilink">dimension</a> is length).</li>
</ul>

<p>The value of 

<math display="inline" id="Courant–Friedrichs–Lewy_condition:8">
 <semantics>
  <msub>
   <mi>C</mi>
   <mi>max</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>C</ci>
    <max></max>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   C_{\max}
  </annotation>
 </semantics>
</math>

 changes with the method used to solve the discretised equation, especially depending on whether the method is <a href="Explicit_and_implicit_methods" title="wikilink">explicit or implicit</a>. If an explicit (time-marching) solver is used then typically 

<math display="inline" id="Courant–Friedrichs–Lewy_condition:9">
 <semantics>
  <mrow>
   <msub>
    <mi>C</mi>
    <mi>max</mi>
   </msub>
   <mo>=</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>C</ci>
     <max></max>
    </apply>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   C_{\max}=1
  </annotation>
 </semantics>
</math>

. Implicit (matrix) solvers are usually less sensitive to numerical instability and so larger values of 

<math display="inline" id="Courant–Friedrichs–Lewy_condition:10">
 <semantics>
  <msub>
   <mi>C</mi>
   <mi>max</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>C</ci>
    <max></max>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   C_{\max}
  </annotation>
 </semantics>
</math>

 may be tolerated.</p>
<h3 id="the-two-and-general-n-dimensional-case">The two and general <em>n</em>-dimensional case</h3>

<p>In the <a href="Dimension_(mathematics)" title="wikilink">two-dimensional</a> case, the CFL condition becomes</p>

<p>

<math display="block" id="Courant–Friedrichs–Lewy_condition:11">
 <semantics>
  <mrow>
   <mi>C</mi>
   <mo>=</mo>
   <mrow>
    <mfrac>
     <mrow>
      <mpadded width="+1.7pt">
       <msub>
        <mi>u</mi>
        <mi>x</mi>
       </msub>
      </mpadded>
      <mi mathvariant="normal">Δ</mi>
      <mi>t</mi>
     </mrow>
     <mrow>
      <mi mathvariant="normal">Δ</mi>
      <mi>x</mi>
     </mrow>
    </mfrac>
    <mo>+</mo>
    <mfrac>
     <mrow>
      <mpadded width="+1.7pt">
       <msub>
        <mi>u</mi>
        <mi>y</mi>
       </msub>
      </mpadded>
      <mi mathvariant="normal">Δ</mi>
      <mi>t</mi>
     </mrow>
     <mrow>
      <mi mathvariant="normal">Δ</mi>
      <mi>y</mi>
     </mrow>
    </mfrac>
   </mrow>
   <mo>≤</mo>
   <msub>
    <mi>C</mi>
    <mi>max</mi>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <ci>C</ci>
     <apply>
      <plus></plus>
      <apply>
       <divide></divide>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>u</ci>
         <ci>x</ci>
        </apply>
        <ci>normal-Δ</ci>
        <ci>t</ci>
       </apply>
       <apply>
        <times></times>
        <ci>normal-Δ</ci>
        <ci>x</ci>
       </apply>
      </apply>
      <apply>
       <divide></divide>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>u</ci>
         <ci>y</ci>
        </apply>
        <ci>normal-Δ</ci>
        <ci>t</ci>
       </apply>
       <apply>
        <times></times>
        <ci>normal-Δ</ci>
        <ci>y</ci>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <leq></leq>
     <share href="#.cmml">
     </share>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>C</ci>
      <max></max>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   C=\frac{u_{x}\,\Delta t}{\Delta x}+\frac{u_{y}\,\Delta t}{\Delta y}\leq C_{\max}
  </annotation>
 </semantics>
</math>

</p>

<p>with obvious meaning of the symbols involved. By analogy with the two-dimensional case, the general CFL condition for the 

<math display="inline" id="Courant–Friedrichs–Lewy_condition:12">
 <semantics>
  <mi>n</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>n</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n
  </annotation>
 </semantics>
</math>

-dimensional case is the following one:</p>

<p>

<math display="block" id="Courant–Friedrichs–Lewy_condition:13">
 <semantics>
  <mrow>
   <mrow>
    <mi>C</mi>
    <mo>=</mo>
    <mrow>
     <mi mathvariant="normal">Δ</mi>
     <mi>t</mi>
     <mrow>
      <munderover>
       <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
       <mrow>
        <mi>i</mi>
        <mo>=</mo>
        <mn>1</mn>
       </mrow>
       <mi>n</mi>
      </munderover>
      <mfrac>
       <msub>
        <mi>u</mi>
        <msub>
         <mi>x</mi>
         <mi>i</mi>
        </msub>
       </msub>
       <mrow>
        <mi mathvariant="normal">Δ</mi>
        <msub>
         <mi>x</mi>
         <mi>i</mi>
        </msub>
       </mrow>
      </mfrac>
     </mrow>
    </mrow>
    <mo>≤</mo>
    <msub>
     <mi>C</mi>
     <mi>max</mi>
    </msub>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <ci>C</ci>
     <apply>
      <times></times>
      <ci>normal-Δ</ci>
      <ci>t</ci>
      <apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <sum></sum>
         <apply>
          <eq></eq>
          <ci>i</ci>
          <cn type="integer">1</cn>
         </apply>
        </apply>
        <ci>n</ci>
       </apply>
       <apply>
        <divide></divide>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>u</ci>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>x</ci>
          <ci>i</ci>
         </apply>
        </apply>
        <apply>
         <times></times>
         <ci>normal-Δ</ci>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>x</ci>
          <ci>i</ci>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <leq></leq>
     <share href="#.cmml">
     </share>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>C</ci>
      <max></max>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   C=\Delta t\sum_{i=1}^{n}\frac{u_{x_{i}}}{\Delta x_{i}}\leq C_{\max}.
  </annotation>
 </semantics>
</math>

</p>

<p>The interval length is not required to be the same for each spatial variable 

<math display="inline" id="Courant–Friedrichs–Lewy_condition:14">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mrow>
      <mi mathvariant="normal">Δ</mi>
      <msub>
       <mi>x</mi>
       <mi>i</mi>
      </msub>
     </mrow>
     <mo>,</mo>
     <mi>i</mi>
    </mrow>
    <mo>=</mo>
    <mn>1</mn>
   </mrow>
   <mo>,</mo>
   <mrow>
    <mi mathvariant="normal">…</mi>
    <mo>,</mo>
    <mi>n</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <eq></eq>
     <list>
      <apply>
       <times></times>
       <ci>normal-Δ</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <ci>i</ci>
       </apply>
      </apply>
      <ci>i</ci>
     </list>
     <cn type="integer">1</cn>
    </apply>
    <list>
     <ci>normal-…</ci>
     <ci>n</ci>
    </list>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Delta x_{i},i=1,\ldots,n
  </annotation>
 </semantics>
</math>

. This "<a href="Degrees_of_freedom_(physics_and_chemistry)" title="wikilink">degree of freedom</a>" can be used in order to somewhat optimize the value of the time step for a particular problem, by varying the values of the different interval in order to keep it not too small.</p>
<h2 id="implications-of-the-cfl-condition">Implications of the CFL condition</h2>
<h3 id="the-cfl-condition-is-only-a-necessary-one">The CFL condition is only a necessary one</h3>

<p>The CFL condition is a necessary condition, but may not be sufficient for the convergence of the <a href="finite-difference_approximation" title="wikilink">finite-difference approximation</a> of a given <a href="numerical_method" title="wikilink">numerical problem</a>. Thus, in order to establish the convergence of the finite-difference approximation, it is necessary to use other methods, which in turn could imply further limitations on the length of the time step and/or the lengths of the spatial intervals.</p>
<h2 id="notes">Notes</h2>
<h2 id="references">References</h2>
<ul>
<li>

<p>.</p></li>
<li>

<p>.: translated from the <a href="German_language" title="wikilink">German</a> by Phyllis Fox. This is an earlier version of the paper , circulated as a research report.</p></li>
<li>

<p>. A freely downlodable copy can be found <a href="http://www.stanford.edu/class/cme324/classics/courant-friedrichs-lewy.pdf">here</a>.</p></li>
</ul>
<h2 id="external-links">External links</h2>
<ul>
<li></li>
<li></li>
</ul>

<p>"</p>

<p><a href="Category:Numerical_differential_equations" title="wikilink">Category:Numerical differential equations</a> <a href="Category:Computational_fluid_dynamics" title="wikilink">Category:Computational fluid dynamics</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1">See reference . There exists also an <a href="English_language" title="wikilink">English</a> <a class="uri" href="translation" title="wikilink">translation</a> of the 1928 <a href="German_language" title="wikilink">German</a> original: see references  and .<a href="#fnref1">↩</a></li>
<li id="fn2">This situation commonly occurs when a <a href="hyperbolic_partial_differential_equation" title="wikilink">hyperbolic partial differential operator</a> has been <a href="approximation_theory" title="wikilink">approximated</a> by a <a href="Finite_difference" title="wikilink">finite difference equation</a>, which is then solved by <a href="numerical_linear_algebra" title="wikilink">numerical linear algebra</a> methods.<a href="#fnref2">↩</a></li>
<li id="fn3">This quantity is not necessarily the same for each spatial variable, as it is shown in the "<a href="Courant–Friedrichs–Lewy_condition#The_two_and_general_''n''–dimensional_case" title="wikilink">The two and general <em>n</em>–dimensional case</a>" section of this entry : it can be chosen in order to somewhat relax the condition.<a href="#fnref3">↩</a></li>
<li id="fn4">Precisely, this is the hyperbolic part of the PDE under analysis.<a href="#fnref4">↩</a></li>
</ol>
</section>
</ref></hr></body>
</html>

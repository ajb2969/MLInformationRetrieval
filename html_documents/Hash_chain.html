<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="1471">Hash chain</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Hash chain</h1>
<hr/>

<p>A <strong>hash chain</strong> is the successive application of a <a href="cryptographic_hash_function" title="wikilink">cryptographic hash function</a> to a piece of data. In <a href="computer_security" title="wikilink">computer security</a>, a hash chain is a method to produce many <a href="One-time_password" title="wikilink">one-time keys</a> from a single <a href="Key_(cryptography)" title="wikilink">key</a> or <a class="uri" href="password" title="wikilink">password</a>. For <a class="uri" href="non-repudiation" title="wikilink">non-repudiation</a> a hash function can be applied successively to additional pieces of data in order to record the chronology of data's existence.</p>
<h2 id="definition">Definition</h2>

<p>A <strong>hash chain</strong> is a successive application of a <a href="cryptographic_hash_function" title="wikilink">cryptographic hash function</a> 

<math display="inline" id="Hash_chain:0">
 <semantics>
  <mrow>
   <mi>h</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>x</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>h</ci>
    <ci>x</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   h(x)
  </annotation>
 </semantics>
</math>

 to a string 

<math display="inline" id="Hash_chain:1">
 <semantics>
  <mi>x</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>x</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x
  </annotation>
 </semantics>
</math>

.</p>

<p>For example,</p>

<p>

<math display="inline" id="Hash_chain:2">
 <semantics>
  <mrow>
   <mi>h</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mrow>
     <mi>h</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mi>h</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mi>h</mi>
         <mrow>
          <mo stretchy="false">(</mo>
          <mi>x</mi>
          <mo stretchy="false">)</mo>
         </mrow>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>h</ci>
    <apply>
     <times></times>
     <ci>h</ci>
     <apply>
      <times></times>
      <ci>h</ci>
      <apply>
       <times></times>
       <ci>h</ci>
       <ci>x</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   h(h(h(h(x))))
  </annotation>
 </semantics>
</math>

</p>

<p>gives a hash chain of length 4, often denoted 

<math display="inline" id="Hash_chain:3">
 <semantics>
  <mrow>
   <msup>
    <mi>h</mi>
    <mn>4</mn>
   </msup>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>x</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>h</ci>
     <cn type="integer">4</cn>
    </apply>
    <ci>x</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   h^{4}(x)
  </annotation>
 </semantics>
</math>

</p>
<h2 id="applications">Applications</h2>

<p><a href="Leslie_Lamport" title="wikilink">Lamport</a><a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a> suggested the use of hash chains as a password protection scheme in an insecure environment. A server which needs to provide <a class="uri" href="authentication" title="wikilink">authentication</a> may store a hash chain rather than a <a href="plain_text" title="wikilink">plain text</a> password and prevent theft of the password in transmission or theft from the server. For example, a server begins by storing 

<math display="inline" id="Hash_chain:4">
 <semantics>
  <mrow>
   <msup>
    <mi>h</mi>
    <mn>1000</mn>
   </msup>
   <mrow>
    <mo stretchy="false">(</mo>
    <mrow>
     <mi>p</mi>
     <mi>a</mi>
     <mi>s</mi>
     <mi>s</mi>
     <mi>w</mi>
     <mi>o</mi>
     <mi>r</mi>
     <mi>d</mi>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>h</ci>
     <cn type="integer">1000</cn>
    </apply>
    <apply>
     <times></times>
     <ci>p</ci>
     <ci>a</ci>
     <ci>s</ci>
     <ci>s</ci>
     <ci>w</ci>
     <ci>o</ci>
     <ci>r</ci>
     <ci>d</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   h^{1000}(password)
  </annotation>
 </semantics>
</math>

 which is provided by the user. When the user wishes to authenticate, he supplies 

<math display="inline" id="Hash_chain:5">
 <semantics>
  <mrow>
   <msup>
    <mi>h</mi>
    <mn>999</mn>
   </msup>
   <mrow>
    <mo stretchy="false">(</mo>
    <mrow>
     <mi>p</mi>
     <mi>a</mi>
     <mi>s</mi>
     <mi>s</mi>
     <mi>w</mi>
     <mi>o</mi>
     <mi>r</mi>
     <mi>d</mi>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>h</ci>
     <cn type="integer">999</cn>
    </apply>
    <apply>
     <times></times>
     <ci>p</ci>
     <ci>a</ci>
     <ci>s</ci>
     <ci>s</ci>
     <ci>w</ci>
     <ci>o</ci>
     <ci>r</ci>
     <ci>d</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   h^{999}(password)
  </annotation>
 </semantics>
</math>

 to the server. The server computes 

<math display="inline" id="Hash_chain:6">
 <semantics>
  <mrow>
   <mrow>
    <mi>h</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <msup>
       <mi>h</mi>
       <mn>999</mn>
      </msup>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mi>p</mi>
        <mi>a</mi>
        <mi>s</mi>
        <mi>s</mi>
        <mi>w</mi>
        <mi>o</mi>
        <mi>r</mi>
        <mi>d</mi>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <msup>
     <mi>h</mi>
     <mn>1000</mn>
    </msup>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>p</mi>
      <mi>a</mi>
      <mi>s</mi>
      <mi>s</mi>
      <mi>w</mi>
      <mi>o</mi>
      <mi>r</mi>
      <mi>d</mi>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>h</ci>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>h</ci>
       <cn type="integer">999</cn>
      </apply>
      <apply>
       <times></times>
       <ci>p</ci>
       <ci>a</ci>
       <ci>s</ci>
       <ci>s</ci>
       <ci>w</ci>
       <ci>o</ci>
       <ci>r</ci>
       <ci>d</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>h</ci>
      <cn type="integer">1000</cn>
     </apply>
     <apply>
      <times></times>
      <ci>p</ci>
      <ci>a</ci>
      <ci>s</ci>
      <ci>s</ci>
      <ci>w</ci>
      <ci>o</ci>
      <ci>r</ci>
      <ci>d</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   h(h^{999}(password))=h^{1000}(password)
  </annotation>
 </semantics>
</math>

 and verifies this matches the hash chain it has stored. It then stores 

<math display="inline" id="Hash_chain:7">
 <semantics>
  <mrow>
   <msup>
    <mi>h</mi>
    <mn>999</mn>
   </msup>
   <mrow>
    <mo stretchy="false">(</mo>
    <mrow>
     <mi>p</mi>
     <mi>a</mi>
     <mi>s</mi>
     <mi>s</mi>
     <mi>w</mi>
     <mi>o</mi>
     <mi>r</mi>
     <mi>d</mi>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>h</ci>
     <cn type="integer">999</cn>
    </apply>
    <apply>
     <times></times>
     <ci>p</ci>
     <ci>a</ci>
     <ci>s</ci>
     <ci>s</ci>
     <ci>w</ci>
     <ci>o</ci>
     <ci>r</ci>
     <ci>d</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   h^{999}(password)
  </annotation>
 </semantics>
</math>

 for the next time the user wishes to authenticate.</p>

<p>An eavesdropper seeing 

<math display="inline" id="Hash_chain:8">
 <semantics>
  <mrow>
   <msup>
    <mi>h</mi>
    <mn>999</mn>
   </msup>
   <mrow>
    <mo stretchy="false">(</mo>
    <mrow>
     <mi>p</mi>
     <mi>a</mi>
     <mi>s</mi>
     <mi>s</mi>
     <mi>w</mi>
     <mi>o</mi>
     <mi>r</mi>
     <mi>d</mi>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>h</ci>
     <cn type="integer">999</cn>
    </apply>
    <apply>
     <times></times>
     <ci>p</ci>
     <ci>a</ci>
     <ci>s</ci>
     <ci>s</ci>
     <ci>w</ci>
     <ci>o</ci>
     <ci>r</ci>
     <ci>d</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   h^{999}(password)
  </annotation>
 </semantics>
</math>

 communicated to the server will be unable to re-transmit the same hash chain to the server for <a class="uri" href="authentication" title="wikilink">authentication</a> since the server now expects 

<math display="inline" id="Hash_chain:9">
 <semantics>
  <mrow>
   <msup>
    <mi>h</mi>
    <mn>998</mn>
   </msup>
   <mrow>
    <mo stretchy="false">(</mo>
    <mrow>
     <mi>p</mi>
     <mi>a</mi>
     <mi>s</mi>
     <mi>s</mi>
     <mi>w</mi>
     <mi>o</mi>
     <mi>r</mi>
     <mi>d</mi>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>h</ci>
     <cn type="integer">998</cn>
    </apply>
    <apply>
     <times></times>
     <ci>p</ci>
     <ci>a</ci>
     <ci>s</ci>
     <ci>s</ci>
     <ci>w</ci>
     <ci>o</ci>
     <ci>r</ci>
     <ci>d</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   h^{998}(password)
  </annotation>
 </semantics>
</math>

. Due to the <a href="One-way_function" title="wikilink">one-way property</a> of <a href="Cryptographic_hash_function" title="wikilink">cryptographically secure hash functions</a>, it is infeasible for the eavesdropper to reverse the hash function and obtain an earlier piece of the hash chain. In this example, the user could authenticate 1000 times before the hash chain is exhausted. Each time the hash value is different, and thus cannot be duplicated by an attacker.</p>
<h2 id="binary-hash-chains">Binary hash chains</h2>

<p>Binary hash chains are commonly used in association with a <a href="Merkle_tree" title="wikilink">hash tree</a>. A Binary hash chain takes two hash values as inputs, concatenates them and applies a hash function to the result, thereby producing a third hash value.</p>
<figure><b>(Figure)</b>
<figcaption>hash tree and hash chain</figcaption>
</figure>

<p>The above diagram shows a hash tree consisting of eight leaf nodes and the hash chain for the third leaf node. In addition to the hash values themselves the order of concatenation (right or left 1,0) or “order bits” are necessary to complete the hash chain.</p>
<h2 id="hasq-hash-chain">Hasq hash chain</h2>

<p>Hasq hash chain is a linked list of records. Hash values serve as password digested keys and the link method. Hasq hash chains are part of a distributed database that allows to control anonymously digital tokens with. The picture below represents a particular linkage between the records in the database.</p>
<figure><b>(Figure)</b>
<figcaption>Hasq hash chains</figcaption>
</figure>
<h2 id="see-also">See also</h2>
<ul>
<li><a href="Challenge-response_authentication" title="wikilink">Challenge-response authentication</a></li>
<li><a href="Hash_list" title="wikilink">Hash list</a> - In contrast to the recursive structure of hash chains, the elements of a hash list are independent of each other..</li>
<li><a href="One-time_password" title="wikilink">One-time password</a></li>
<li><a href="Key_stretching" title="wikilink">Key stretching</a></li>
<li><a href="Linked_timestamping" title="wikilink">Linked timestamping</a> - Binary hash chains are a key component in linked timestamping</li>
</ul>
<h2 id="references">References</h2>

<p>"</p>

<p><a href="Category:Cryptographic_algorithms" title="wikilink">Category:Cryptographic algorithms</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1">L. Lamport, “Password Authentication with Insecure Communication”, Communications of the ACM 24.11 (November 1981), pp 770-772. [<a class="uri" href="http://scholar.google.de/scholar?num=100&amp;hl">http://scholar.google.de/scholar?num=100&amp;hl;</a>;=de&amp;lr;=&amp;cluster;=10450198314466995215] <a href="http://citeseer.ist.psu.edu/context/2064887/0">1</a><a href="#fnref1">↩</a></li>
</ol>
</section>
</body>
</html>

<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="374">Geodesics on an ellipsoid</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Geodesics on an ellipsoid</h1>
<hr/>

<p> The study of <strong>geodesics on an ellipsoid</strong> arose in connection with geodesy specifically with the solution of <a href="triangulation_network" title="wikilink">triangulation networks</a>. The <a href="figure_of_the_Earth" title="wikilink">figure of the Earth</a> is well approximated by an <em><a href="oblate_ellipsoid" title="wikilink">oblate ellipsoid</a></em>, a slightly flattened sphere. A <em><a class="uri" href="geodesic" title="wikilink">geodesic</a></em> is the shortest path between two points on a curved surface, i.e., the analogue of a <a href="straight_line" title="wikilink">straight line</a> on a plane surface. The solution of a triangulation network on an ellipsoid is therefore a set of exercises in spheroidal trigonometry .</p>

<p>  If the Earth is treated as a <a class="uri" href="sphere" title="wikilink">sphere</a>, the geodesics are <a href="great_circles" title="wikilink">great circles</a> (all of which are closed) and the problems reduce to ones in <a href="spherical_trigonometry" title="wikilink">spherical trigonometry</a>. However,  showed that the effect of the rotation of the Earth results in its resembling a slightly oblate ellipsoid and, in this case, the <a class="uri" href="equator" title="wikilink">equator</a> and the <a href="meridian_(geography)" title="wikilink">meridians</a> are the only closed geodesics. Furthermore, the shortest path between two points on the equator does not necessarily run along the equator. Finally, if the ellipsoid is further perturbed to become a <a href="triaxial_ellipsoid" title="wikilink">triaxial ellipsoid</a> (with three distinct semi-axes), then only three geodesics are closed and one of these is unstable.</p>

<p>The problems in geodesy are usually reduced to two main cases: the <em>direct problem</em>, given a starting point and an initial heading, find the position after traveling a certain distance along the geodesic; and the <em>inverse problem</em>, given two points on the ellipsoid find the connecting geodesic and hence the shortest distance between them. Because the flattening of the Earth is small, the geodesic distance between two points on the Earth is well approximated by the great-circle distance using the <a href="Earth_radius#Mean_radius" title="wikilink">mean Earth radius</a>—the relative error is less than 1%. However, the course of the geodesic can differ dramatically from that of the great circle. As an extreme example, consider two points on the equator with a longitude difference of 179°59′; while the connecting great circle follows the equator, the shortest geodesics pass within 180 km of either <a href="geographical_pole" title="wikilink">pole</a> (the flattening makes two symmetric paths passing close to the poles shorter than the route along the equator).</p>

<p>Aside from their use in geodesy and related fields such as navigation, terrestrial geodesics arise in the study of the propagation of signals which are confined (approximately) to the surface of the Earth, for example, sound waves in the ocean  and the radio signals from lightning . Geodesics are used to define some <a href="maritime_boundaries" title="wikilink">maritime boundaries</a>, which in turn determine the allocation of valuable resources as such <a href="mineral_rights" title="wikilink">oil and mineral rights</a>. Ellipsoidal geodesics also arise in other applications; for example, the propagation of radio waves along the fuselage of an aircraft, which can be roughly modeled as a <a href="prolate_spheroid" title="wikilink">prolate (elongated)</a> ellipsoid .</p>

<p>Geodesics are an important intrinsic characteristic of curved surfaces. The sequence of progressively more complex surfaces, the sphere, an <a href="ellipsoid_of_revolution" title="wikilink">ellipsoid of revolution</a>, and a triaxial ellipsoid, provide a useful family of surfaces for investigating the general theory of surfaces. Indeed, Gauss's work on the <a href=":de:Gaußsche_Landesaufnahme" title="wikilink">survey of Hanover</a>, which involved geodesics on an oblate ellipsoid, was a key motivation for his <a href="Differential_geometry_of_surfaces" title="wikilink">study of surfaces</a> . Similarly, the existence of three closed geodesics on a triaxial ellipsoid turns out to be a general property of <a href="closed_surface" title="wikilink">closed</a>, <a href="simply_connected" title="wikilink">simply connected</a> surfaces; this was conjectured by  and proved by  .</p>
<h2 id="geodesics-on-an-ellipsoid-of-revolution">Geodesics on an ellipsoid of revolution</h2>

<p>There are several ways of defining geodesics . A simple definition is as the shortest path between two points on a surface. However, it is frequently more useful to define them as paths with zero <a href="geodesic_curvature" title="wikilink">geodesic curvature</a>—i.e., the analogue of <a href="straight_lines" title="wikilink">straight lines</a> on a curved surface. This definition encompasses geodesics traveling so far across the ellipsoid's surface (somewhat less than half the circumference) that other distinct routes require less distance. Locally, these geodesics are still identical to the shortest distance between two points.</p>

<p>By the end of the 18th century, an ellipsoid of revolution (the term <a class="uri" href="spheroid" title="wikilink">spheroid</a> is also used) was a well-accepted approximation to the <a href="figure_of_the_Earth" title="wikilink">figure of the Earth</a>. The adjustment of <a href="triangulation_network" title="wikilink">triangulation networks</a> entailed reducing all the measurements to a <a href="reference_ellipsoid" title="wikilink">reference ellipsoid</a> and solving the resulting two-dimensional problem as an exercise in spheroidal trigonometry .</p>

<p> It is possible to reduce the various geodesic problems into one of two types. Consider two points: <em>A</em> at latitude φ<sub>1</sub> and longitude λ<sub>1</sub> and <em>B</em> at latitude φ<sub>2</sub> and longitude λ<sub>2</sub> (see Fig. 1). The connecting geodesic (from <em>A</em> to <em>B</em>) is <em>AB</em>, of length <em>s</em><sub>12</sub>, which has <a href="azimuth" title="wikilink">azimuths</a> α<sub>1</sub> and α<sub>2</sub> at the two endpoints. The two geodesic problems usually considered are:</p>
<ol>
<li>the <em>direct geodesic problem</em> or <em>first geodesic problem</em>, given <em>A</em>, α<sub>1</sub>, and <em>s</em><sub>12</sub>, determine <em>B</em> and α<sub>2</sub>;</li>
<li>the <em>inverse geodesic problem</em> or <em>second geodesic problem</em>, given <em>A</em> and <em>B</em>, determine <em>s</em><sub>12</sub>, α<sub>1</sub>, and α<sub>2</sub>.</li>
</ol>

<p>As can be seen from Fig. 1, these problems involve solving the triangle <em>NAB</em> given one angle, α<sub>1</sub> for the direct problem and λ<sub>12</sub> = λ<sub>2</sub> − λ<sub>1</sub> for the inverse problem, and its two adjacent sides. In the course of the 18th century these problems were elevated (especially in literature in the German language) to the <a href=":de:geodätische_Hauptaufgabe" title="wikilink"><em>principal geodesic problems</em></a> .</p>

<p>For a sphere the solutions to these problems are simple exercises in <a href="spherical_trigonometry" title="wikilink">spherical trigonometry</a>, whose solution is given by <a href="Solution_of_triangles#Two_sides_and_the_included_angle_given" title="wikilink">formulas for solving a spherical triangle</a>. (See the article on <a href="great-circle_navigation" title="wikilink">great-circle navigation</a>.)</p>

<p>  For an ellipsoid of revolution, the characteristic constant defining the geodesic was found by . A systematic solution for the paths of geodesics was given by  and  (and subsequent papers in <a href="#{{harvid" title="wikilink">Oriani|1808}}|1808</a> and <a href="#{{harvid" title="wikilink">Oriani|1810}}|1810</a>). The full solution for the direct problem (complete with computational tables and a worked out example) is given by .</p>

<p>Much of the early work on these problems was carried out by mathematicians—for example, <a href="Adrien-Marie_Legendre" title="wikilink">Legendre</a>, <a href="Friedrich_Bessel" title="wikilink">Bessel</a>, and <a href="Carl_Friedrich_Gauss" title="wikilink">Gauss</a>—who were also heavily involved in the practical aspects of <a class="uri" href="surveying" title="wikilink">surveying</a>. Beginning in about 1830, the disciplines diverged: those with an interest in geodesy concentrated on the practical aspects such as approximations suitable for field work, while mathematicians pursued the solution of geodesics on a triaxial ellipsoid, the analysis of the stability of closed geodesics, etc.</p>

<p>During the 18th century geodesics were typically referred to as "shortest lines". The term "geodesic line" was coined by :</p>
<blockquote>

<p>Nous désignerons cette ligne sous le nom de <em>ligne géodésique</em> [We will call this line the <em>geodesic line</em>].</p>
</blockquote>

<p>This terminology was introduced into English either as "geodesic line" or as "geodetic line", for example ,</p>
<blockquote>

<p>A line traced in the manner we have now been describing, or deduced from trigonometrical measures, by the means we have indicated, is called a <em>geodetic</em> or <em>geodesic line:</em> it has the property of being the shortest which can be drawn between its two extremities on the surface of the Earth; and it is therefore the proper itinerary measure of the distance between those two points.</p>
</blockquote>

<p>In its adoption by other fields "geodesic line", frequently shortened, to "geodesic", was preferred.</p>

<p>This section treats the problem on an ellipsoid of revolution (both oblate and prolate). The problem on a triaxial ellipsoid is covered in the next section.</p>

<p>When determining distances on the earth, various approximate methods are frequently used; some of these are described in the article on <a href="geographical_distance" title="wikilink">geographical distance</a>.</p>
<h3 id="equations-for-a-geodesic">Equations for a geodesic</h3>

<p> </p>

<p>Here the equations for a geodesic are developed; these allow the geodesics of any length to be computed accurately. The following derivation closely follows that of . , , , and  also provide derivations of these equations.</p>

<p>Consider an ellipsoid of revolution with equatorial radius <em>a</em> and polar semi-axis <em>b</em>. Define the flattening <em>f</em> = (<em>a</em> − <em>b</em>)/<em>a</em>, the eccentricity <em>e</em><sup>2</sup> = <em>f</em>(2 − <em>f</em>), and the second eccentricity <em>e</em>′ = <em>e</em>/(1 − <em>f</em>). (In most applications in geodesy, the ellipsoid is taken to be oblate, <em>a</em> &gt; <em>b</em>; however, the theory applies without change to prolate ellipsoids, <em>a</em> 2, and <em>e</em>′<sup>2</sup> are negative.)</p>

<p>Let an elementary segment of a path on the ellipsoid have length <em>ds</em>. From Figs. 2 and 3, we see that if its azimuth is α, then <em>ds</em> is related to <em>d</em>φ and <em>d</em>λ by</p>
<dl>
<dd>(1)<math>{\color{white}.}\qquad
</math></dd>
</dl>

<p>\cos\alpha\,ds = \rho\,d\phi = - dR/\sin\phi, \quad \sin\alpha\,ds = R\,d\lambda, where ρ is the <a href="Earth_radius#Meridional" title="wikilink">meridional radius of curvature</a>, <em>R</em> = ν cosφ is the radius of the circle of latitude φ, and ν is the <a href="Earth_radius#Normal" title="wikilink">normal radius of curvature</a>. The elementary segment is therefore given by</p>

<p>

<math display="block" id="Geodesics_on_an_ellipsoid:0">
 <semantics>
  <mrow>
   <mrow>
    <mi>d</mi>
    <msup>
     <mi>s</mi>
     <mn>2</mn>
    </msup>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mpadded width="+1.7pt">
      <msup>
       <mi>ρ</mi>
       <mn>2</mn>
      </msup>
     </mpadded>
     <mi>d</mi>
     <msup>
      <mi>ϕ</mi>
      <mn>2</mn>
     </msup>
    </mrow>
    <mo>+</mo>
    <mrow>
     <mpadded width="+1.7pt">
      <msup>
       <mi>R</mi>
       <mn>2</mn>
      </msup>
     </mpadded>
     <mi>d</mi>
     <msup>
      <mi>λ</mi>
      <mn>2</mn>
     </msup>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>d</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>s</ci>
      <cn type="integer">2</cn>
     </apply>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>ρ</ci>
       <cn type="integer">2</cn>
      </apply>
      <ci>d</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>ϕ</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>R</ci>
       <cn type="integer">2</cn>
      </apply>
      <ci>d</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>λ</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   ds^{2}=\rho^{2}\,d\phi^{2}+R^{2}\,d\lambda^{2}
  </annotation>
 </semantics>
</math>

 or</p>

<p>

<math display="inline" id="Geodesics_on_an_ellipsoid:1">
 <semantics>
  <mrow>
   <mi>d</mi>
   <mi>s</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>d</ci>
    <ci>s</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle ds
  </annotation>
 </semantics>
</math>


 where φ′ = <em>d</em>φ/<em>d</em>λ and <em>L</em> depends on φ through ρ(φ) and <em>R</em>(φ). The length of an arbitrary path between (φ<sub>1</sub>, λ<sub>1</sub>) and (φ<sub>2</sub>, λ<sub>2</sub>) is given by</p>

<p>

<math display="block" id="Geodesics_on_an_ellipsoid:2">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>s</mi>
     <mn>12</mn>
    </msub>
    <mo>=</mo>
    <mrow>
     <msubsup>
      <mo largeop="true" symmetric="true">∫</mo>
      <msub>
       <mi>λ</mi>
       <mn>1</mn>
      </msub>
      <msub>
       <mi>λ</mi>
       <mn>2</mn>
      </msub>
     </msubsup>
     <mrow>
      <mi>L</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>ϕ</mi>
       <mo>,</mo>
       <msup>
        <mi>ϕ</mi>
        <mo>′</mo>
       </msup>
       <mo rspace="4.2pt" stretchy="false">)</mo>
      </mrow>
      <mi>d</mi>
      <mi>λ</mi>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>s</ci>
     <cn type="integer">12</cn>
    </apply>
    <apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <int></int>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>λ</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>λ</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
     <apply>
      <times></times>
      <ci>L</ci>
      <interval closure="open">
       <ci>ϕ</ci>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>ϕ</ci>
        <ci>normal-′</ci>
       </apply>
      </interval>
      <ci>d</ci>
      <ci>λ</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   s_{12}=\int_{\lambda_{1}}^{\lambda_{2}}L(\phi,\phi^{\prime})\,d\lambda,
  </annotation>
 </semantics>
</math>

 where φ is a function of λ satisfying φ(λ<sub>1</sub>) = φ<sub>1</sub> and φ(λ<sub>2</sub>) = φ<sub>2</sub>. The shortest path or geodesic entails finding that function φ(λ) which minimizes <em>s</em><sub>12</sub>. This is an exercise in the <a href="calculus_of_variations" title="wikilink">calculus of variations</a> and the minimizing condition is given by the <a href="Beltrami_identity" title="wikilink">Beltrami identity</a>,</p>

<p>

<math display="block" id="Geodesics_on_an_ellipsoid:3">
 <semantics>
  <mrow>
   <mrow>
    <mi>L</mi>
    <mo>-</mo>
    <mrow>
     <msup>
      <mi>ϕ</mi>
      <mo>′</mo>
     </msup>
     <mfrac>
      <mrow>
       <mo>∂</mo>
       <mi>L</mi>
      </mrow>
      <mrow>
       <mo>∂</mo>
       <msup>
        <mi>ϕ</mi>
        <mo>′</mo>
       </msup>
      </mrow>
     </mfrac>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mtext>const.</mtext>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <minus></minus>
     <ci>L</ci>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>ϕ</ci>
       <ci>normal-′</ci>
      </apply>
      <apply>
       <divide></divide>
       <apply>
        <partialdiff></partialdiff>
        <ci>L</ci>
       </apply>
       <apply>
        <partialdiff></partialdiff>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>ϕ</ci>
         <ci>normal-′</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
    <mtext>const.</mtext>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   L-\phi^{\prime}\frac{\partial L}{\partial\phi^{\prime}}=\text{const.}
  </annotation>
 </semantics>
</math>

  Substituting for <em>L</em> and using Eqs. (1) gives</p>

<p>

<math display="block" id="Geodesics_on_an_ellipsoid:4">
 <semantics>
  <mrow>
   <mrow>
    <mi>R</mi>
    <mrow>
     <mi>sin</mi>
     <mi>α</mi>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mtext>const.</mtext>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>R</ci>
     <apply>
      <sin></sin>
      <ci>α</ci>
     </apply>
    </apply>
    <mtext>const.</mtext>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   R\sin\alpha=\text{const.}
  </annotation>
 </semantics>
</math>

  first found this <a href="Clairaut's_relation" title="wikilink">relation</a>, using a geometrical construction; a similar derivation is presented by . Differentiating this relation and manipulating the result gives </p>

<p>

<math display="block" id="Geodesics_on_an_ellipsoid:5">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>d</mi>
     <mi>α</mi>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mi>sin</mi>
     <mrow>
      <mpadded width="+1.7pt">
       <mi>ϕ</mi>
      </mpadded>
      <mi>d</mi>
      <mi>λ</mi>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>d</ci>
     <ci>α</ci>
    </apply>
    <apply>
     <sin></sin>
     <apply>
      <times></times>
      <ci>ϕ</ci>
      <ci>d</ci>
      <ci>λ</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   d\alpha=\sin\phi\,d\lambda.
  </annotation>
 </semantics>
</math>

 This, together with Eqs. (1), leads to a system of <a href="ordinary_differential_equations" title="wikilink">ordinary differential equations</a> for a geodesic </p>
<dl>
<dd>(2)<math>{\color{white}.}\qquad\displaystyle
</math></dd>
</dl>

<p>\frac{d\phi}{ds} = \frac{\cos\alpha}{\rho};\quad \frac{d\lambda}{ds} = \frac{\sin\alpha}{\nu\cos\phi};\quad \frac{d\alpha}{ds} = \frac{\tan\phi\sin\alpha}{\nu}. We can express <em>R</em> in terms of the <a href="Latitude#Reduced_(or_parametric)_latitude" title="wikilink">parametric latitude</a>, β, using</p>

<p>

<math display="block" id="Geodesics_on_an_ellipsoid:6">
 <semantics>
  <mrow>
   <mi>R</mi>
   <mo>=</mo>
   <mrow>
    <mi>a</mi>
    <mrow>
     <mi>cos</mi>
     <mi>β</mi>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>R</ci>
    <apply>
     <times></times>
     <ci>a</ci>
     <apply>
      <cos></cos>
      <ci>β</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   R=a\cos\beta
  </annotation>
 </semantics>
</math>

 (see Fig. 4 for the geometrical construction), and Clairaut's relation then becomes</p>

<p>

<math display="block" id="Geodesics_on_an_ellipsoid:7">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mrow>
      <mi>sin</mi>
      <msub>
       <mi>α</mi>
       <mn>1</mn>
      </msub>
     </mrow>
     <mrow>
      <mi>cos</mi>
      <msub>
       <mi>β</mi>
       <mn>1</mn>
      </msub>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mi>sin</mi>
      <msub>
       <mi>α</mi>
       <mn>2</mn>
      </msub>
     </mrow>
     <mrow>
      <mi>cos</mi>
      <msub>
       <mi>β</mi>
       <mn>2</mn>
      </msub>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <sin></sin>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>α</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <apply>
      <cos></cos>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>β</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <sin></sin>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>α</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
     <apply>
      <cos></cos>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>β</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \sin\alpha_{1}\cos\beta_{1}=\sin\alpha_{2}\cos\beta_{2}.
  </annotation>
 </semantics>
</math>

  This is the <a href="Spherical_trigonometry#Sine_rules" title="wikilink">sine rule</a> of spherical trigonometry relating two sides of the triangle <em>NAB</em> (see Fig. 5), <em>NA</em> = ½π − β<sub>1</sub>, and <em>NB</em> = ½π − β<sub>2</sub> and their opposite angles <em>B</em> = π − α<sub>2</sub> and <em>A</em> = α<sub>1</sub>.</p>

<p>In order to find the relation for the third side <em>AB</em> = σ<sub>12</sub>, the <em>spherical arc length</em>, and included angle <em>N</em> = ω<sub>12</sub>, the <em>spherical longitude</em>, it is useful to consider the triangle <em>NEP</em> representing a geodesic starting at the equator; see Fig. 6. In this figure, the variables referred to the auxiliary sphere are shown with the corresponding quantities for the ellipsoid shown in parentheses. Quantities without subscripts refer to the arbitrary point <em>P</em>; <em>E</em>, the point at which the geodesic crosses the equator in the northward direction, is used as the origin for σ, <em>s</em> and ω.</p>

<p> If the side <em>EP</em> is extended by moving <em>P</em> infinitesimally (see Fig. 7), we obtain</p>
<dl>
<dd>(3)<math>{\color{white}.}\qquad
</math></dd>
</dl>

<p>\cos\alpha\,d\sigma = d\beta, \quad \sin\alpha\,d\sigma = \cos\beta\,d\omega. Combining Eqs. (1) and (3) gives differential equations for <em>s</em> and λ</p>

<p>

<math display="block" id="Geodesics_on_an_ellipsoid:8">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mfrac>
      <mn>1</mn>
      <mi>a</mi>
     </mfrac>
     <mfrac>
      <mrow>
       <mi>d</mi>
       <mi>s</mi>
      </mrow>
      <mrow>
       <mi>d</mi>
       <mi>σ</mi>
      </mrow>
     </mfrac>
    </mrow>
    <mo>=</mo>
    <mfrac>
     <mrow>
      <mi>d</mi>
      <mi>λ</mi>
     </mrow>
     <mrow>
      <mi>d</mi>
      <mi>ω</mi>
     </mrow>
    </mfrac>
    <mo>=</mo>
    <mfrac>
     <mrow>
      <mi>sin</mi>
      <mi>β</mi>
     </mrow>
     <mrow>
      <mi>sin</mi>
      <mi>ϕ</mi>
     </mrow>
    </mfrac>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <ci>a</ci>
      </apply>
      <apply>
       <divide></divide>
       <apply>
        <times></times>
        <ci>d</ci>
        <ci>s</ci>
       </apply>
       <apply>
        <times></times>
        <ci>d</ci>
        <ci>σ</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <divide></divide>
      <apply>
       <times></times>
       <ci>d</ci>
       <ci>λ</ci>
      </apply>
      <apply>
       <times></times>
       <ci>d</ci>
       <ci>ω</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <divide></divide>
      <apply>
       <sin></sin>
       <ci>β</ci>
      </apply>
      <apply>
       <sin></sin>
       <ci>ϕ</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \frac{1}{a}\frac{ds}{d\sigma}=\frac{d\lambda}{d\omega}=\frac{\sin\beta}{\sin%
\phi}.
  </annotation>
 </semantics>
</math>

</p>

<p>Up to this point, we have not made use of the specific equations for an ellipsoid, and indeed the derivation applies to an arbitrary surface of revolution. Bessel now specializes to an ellipsoid in which <em>R</em> and <em>Z</em> are related by</p>

<p>

<math display="block" id="Geodesics_on_an_ellipsoid:9">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mfrac>
      <msup>
       <mi>R</mi>
       <mn>2</mn>
      </msup>
      <msup>
       <mi>a</mi>
       <mn>2</mn>
      </msup>
     </mfrac>
     <mo>+</mo>
     <mfrac>
      <msup>
       <mi>Z</mi>
       <mn>2</mn>
      </msup>
      <msup>
       <mi>b</mi>
       <mn>2</mn>
      </msup>
     </mfrac>
    </mrow>
    <mo>=</mo>
    <mn>1</mn>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <plus></plus>
     <apply>
      <divide></divide>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>R</ci>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>a</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
     <apply>
      <divide></divide>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>Z</ci>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>b</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \frac{R^{2}}{a^{2}}+\frac{Z^{2}}{b^{2}}=1,
  </annotation>
 </semantics>
</math>

 where <em>Z</em> is the height above the equator (see Fig. 4). Differentiating this and setting <em>dR</em>/<em>dZ</em> = −sinφ/cosφ gives</p>

<p>

<math display="block" id="Geodesics_on_an_ellipsoid:10">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mfrac>
      <mrow>
       <mi>R</mi>
       <mrow>
        <mi>sin</mi>
        <mi>ϕ</mi>
       </mrow>
      </mrow>
      <msup>
       <mi>a</mi>
       <mn>2</mn>
      </msup>
     </mfrac>
     <mo>-</mo>
     <mfrac>
      <mrow>
       <mi>Z</mi>
       <mrow>
        <mi>cos</mi>
        <mi>ϕ</mi>
       </mrow>
      </mrow>
      <msup>
       <mi>b</mi>
       <mn>2</mn>
      </msup>
     </mfrac>
    </mrow>
    <mo>=</mo>
    <mn>0</mn>
   </mrow>
   <mo>;</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <minus></minus>
     <apply>
      <divide></divide>
      <apply>
       <times></times>
       <ci>R</ci>
       <apply>
        <sin></sin>
        <ci>ϕ</ci>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>a</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
     <apply>
      <divide></divide>
      <apply>
       <times></times>
       <ci>Z</ci>
       <apply>
        <cos></cos>
        <ci>ϕ</ci>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>b</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \frac{R\sin\phi}{a^{2}}-\frac{Z\cos\phi}{b^{2}}=0;
  </annotation>
 </semantics>
</math>

 eliminating <em>Z</em> from these equations, we obtain</p>

<p>

<math display="block" id="Geodesics_on_an_ellipsoid:11">
 <semantics>
  <mrow>
   <mrow>
    <mfrac>
     <mi>R</mi>
     <mi>a</mi>
    </mfrac>
    <mo>=</mo>
    <mrow>
     <mi>cos</mi>
     <mi>β</mi>
    </mrow>
    <mo>=</mo>
    <mfrac>
     <mrow>
      <mi>cos</mi>
      <mi>ϕ</mi>
     </mrow>
     <msqrt>
      <mrow>
       <mn>1</mn>
       <mo>-</mo>
       <mrow>
        <msup>
         <mi>e</mi>
         <mn>2</mn>
        </msup>
        <mrow>
         <msup>
          <mi>sin</mi>
          <mn>2</mn>
         </msup>
         <mi>ϕ</mi>
        </mrow>
       </mrow>
      </mrow>
     </msqrt>
    </mfrac>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <divide></divide>
      <ci>R</ci>
      <ci>a</ci>
     </apply>
     <apply>
      <cos></cos>
      <ci>β</ci>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <divide></divide>
      <apply>
       <cos></cos>
       <ci>ϕ</ci>
      </apply>
      <apply>
       <root></root>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
        <apply>
         <times></times>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>e</ci>
          <cn type="integer">2</cn>
         </apply>
         <apply>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <sin></sin>
           <cn type="integer">2</cn>
          </apply>
          <ci>ϕ</ci>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \frac{R}{a}=\cos\beta=\frac{\cos\phi}{\sqrt{1-e^{2}\sin^{2}\phi}}.
  </annotation>
 </semantics>
</math>

 This relation between β and φ can be written as</p>

<p>

<math display="block" id="Geodesics_on_an_ellipsoid:12">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>tan</mi>
     <mi>β</mi>
    </mrow>
    <mo>=</mo>
    <mrow>
     <msqrt>
      <mrow>
       <mn>1</mn>
       <mo>-</mo>
       <msup>
        <mi>e</mi>
        <mn>2</mn>
       </msup>
      </mrow>
     </msqrt>
     <mrow>
      <mi>tan</mi>
      <mi>ϕ</mi>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mn>1</mn>
       <mo>-</mo>
       <mi>f</mi>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <mrow>
      <mi>tan</mi>
      <mi>ϕ</mi>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <tan></tan>
      <ci>β</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <root></root>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>e</ci>
         <cn type="integer">2</cn>
        </apply>
       </apply>
      </apply>
      <apply>
       <tan></tan>
       <ci>ϕ</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
       <ci>f</ci>
      </apply>
      <apply>
       <tan></tan>
       <ci>ϕ</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \tan\beta=\sqrt{1-e^{2}}\tan\phi=(1-f)\tan\phi,
  </annotation>
 </semantics>
</math>

 which is the normal definition of the <a href="Latitude#Reduced_(or_parametric)_latitude" title="wikilink">parametric latitude</a> on an ellipsoid. Furthermore, we have</p>

<p>

<math display="block" id="Geodesics_on_an_ellipsoid:13">
 <semantics>
  <mrow>
   <mrow>
    <mfrac>
     <mrow>
      <mi>sin</mi>
      <mi>β</mi>
     </mrow>
     <mrow>
      <mi>sin</mi>
      <mi>ϕ</mi>
     </mrow>
    </mfrac>
    <mo>=</mo>
    <msqrt>
     <mrow>
      <mn>1</mn>
      <mo>-</mo>
      <mrow>
       <msup>
        <mi>e</mi>
        <mn>2</mn>
       </msup>
       <mrow>
        <msup>
         <mi>cos</mi>
         <mn>2</mn>
        </msup>
        <mi>β</mi>
       </mrow>
      </mrow>
     </mrow>
    </msqrt>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <divide></divide>
     <apply>
      <sin></sin>
      <ci>β</ci>
     </apply>
     <apply>
      <sin></sin>
      <ci>ϕ</ci>
     </apply>
    </apply>
    <apply>
     <root></root>
     <apply>
      <minus></minus>
      <cn type="integer">1</cn>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>e</ci>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <cos></cos>
         <cn type="integer">2</cn>
        </apply>
        <ci>β</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \frac{\sin\beta}{\sin\phi}=\sqrt{1-e^{2}\cos^{2}\beta},
  </annotation>
 </semantics>
</math>

 so that the differential equations for the geodesic become</p>

<p>

<math display="block" id="Geodesics_on_an_ellipsoid:14">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mfrac>
      <mn>1</mn>
      <mi>a</mi>
     </mfrac>
     <mfrac>
      <mrow>
       <mi>d</mi>
       <mi>s</mi>
      </mrow>
      <mrow>
       <mi>d</mi>
       <mi>σ</mi>
      </mrow>
     </mfrac>
    </mrow>
    <mo>=</mo>
    <mfrac>
     <mrow>
      <mi>d</mi>
      <mi>λ</mi>
     </mrow>
     <mrow>
      <mi>d</mi>
      <mi>ω</mi>
     </mrow>
    </mfrac>
    <mo>=</mo>
    <msqrt>
     <mrow>
      <mn>1</mn>
      <mo>-</mo>
      <mrow>
       <msup>
        <mi>e</mi>
        <mn>2</mn>
       </msup>
       <mrow>
        <msup>
         <mi>cos</mi>
         <mn>2</mn>
        </msup>
        <mi>β</mi>
       </mrow>
      </mrow>
     </mrow>
    </msqrt>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <ci>a</ci>
      </apply>
      <apply>
       <divide></divide>
       <apply>
        <times></times>
        <ci>d</ci>
        <ci>s</ci>
       </apply>
       <apply>
        <times></times>
        <ci>d</ci>
        <ci>σ</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <divide></divide>
      <apply>
       <times></times>
       <ci>d</ci>
       <ci>λ</ci>
      </apply>
      <apply>
       <times></times>
       <ci>d</ci>
       <ci>ω</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <root></root>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>e</ci>
         <cn type="integer">2</cn>
        </apply>
        <apply>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <cos></cos>
          <cn type="integer">2</cn>
         </apply>
         <ci>β</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \frac{1}{a}\frac{ds}{d\sigma}=\frac{d\lambda}{d\omega}=\sqrt{1-e^{2}\cos^{2}%
\beta}.
  </annotation>
 </semantics>
</math>

</p>

<p>The last step is to use σ as the independent parameter in both of these differential equations and thereby to express <em>s</em> and λ as integrals. Applying the sine rule to the vertices <em>E</em> and <em>G</em> in the spherical triangle <em>EGP</em> in Fig. 6 gives</p>

<p>

<math display="block" id="Geodesics_on_an_ellipsoid:15">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>sin</mi>
     <mi>β</mi>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mi>sin</mi>
      <mi>β</mi>
     </mrow>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>σ</mi>
      <mo>;</mo>
      <msub>
       <mi>α</mi>
       <mn>0</mn>
      </msub>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mi>cos</mi>
      <msub>
       <mi>α</mi>
       <mn>0</mn>
      </msub>
     </mrow>
     <mrow>
      <mi>sin</mi>
      <mi>σ</mi>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <sin></sin>
      <ci>β</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <sin></sin>
       <ci>β</ci>
      </apply>
      <list>
       <ci>σ</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>α</ci>
        <cn type="integer">0</cn>
       </apply>
      </list>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <apply>
       <cos></cos>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>α</ci>
        <cn type="integer">0</cn>
       </apply>
      </apply>
      <apply>
       <sin></sin>
       <ci>σ</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \sin\beta=\sin\beta(\sigma;\alpha_{0})=\cos\alpha_{0}\sin\sigma,
  </annotation>
 </semantics>
</math>

 where α<sub>0</sub> is the azimuth at <em>E</em>. Substituting this into the equation for <em>ds</em>/<em>d</em>σ and integrating the result gives</p>
<dl>
<dd>(4)<math>{\color{white}.}\qquad
</math></dd>
</dl>

<p>\begin{align} \frac sb &amp;= \int_0^\sigma \frac{\sqrt{1 - e^2 \cos^2\beta(\sigma';\alpha_0)}}{1-f}\,d\sigma'\\ &amp;= \int_0^\sigma \sqrt{1 + k^2 \sin^2\sigma'}\,d\sigma', \end{align}  where</p>

<p>

<math display="block" id="Geodesics_on_an_ellipsoid:16">
 <semantics>
  <mrow>
   <mrow>
    <mi>k</mi>
    <mo>=</mo>
    <mrow>
     <msup>
      <mi>e</mi>
      <mo>′</mo>
     </msup>
     <mrow>
      <mi>cos</mi>
      <msub>
       <mi>α</mi>
       <mn>0</mn>
      </msub>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>k</ci>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>e</ci>
      <ci>normal-′</ci>
     </apply>
     <apply>
      <cos></cos>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>α</ci>
       <cn type="integer">0</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   k=e^{\prime}\cos\alpha_{0},
  </annotation>
 </semantics>
</math>

 and the limits on the integral are chosen so that <em>s</em>(σ = 0) = 0.  pointed out that the equation for <em>s</em> is the same as the equation for the <a href="Meridian_arc#Meridian_distance_on_the_ellipsoid" title="wikilink">arc on an ellipse</a> with semi-axes <em>b</em>(1 + <em>e</em>′<sup>2</sup> cos<sup>2</sup>α<sub>0</sub>)<sup>1/2</sup> and <em>b</em>. In order to express the equation for λ in terms of σ, we write</p>

<p>

<math display="block" id="Geodesics_on_an_ellipsoid:17">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>d</mi>
     <mi>ω</mi>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mpadded width="+1.7pt">
      <mfrac>
       <mrow>
        <mi>sin</mi>
        <msub>
         <mi>α</mi>
         <mn>0</mn>
        </msub>
       </mrow>
       <mrow>
        <msup>
         <mi>cos</mi>
         <mn>2</mn>
        </msup>
        <mi>β</mi>
       </mrow>
      </mfrac>
     </mpadded>
     <mi>d</mi>
     <mi>σ</mi>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>d</ci>
     <ci>ω</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <divide></divide>
      <apply>
       <sin></sin>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>α</ci>
        <cn type="integer">0</cn>
       </apply>
      </apply>
      <apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <cos></cos>
        <cn type="integer">2</cn>
       </apply>
       <ci>β</ci>
      </apply>
     </apply>
     <ci>d</ci>
     <ci>σ</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   d\omega=\frac{\sin\alpha_{0}}{\cos^{2}\beta}\,d\sigma,
  </annotation>
 </semantics>
</math>

 which follows from Eq. (3) and Clairaut's relation. This yields</p>
<dl>
<dd>(5)<math>{\color{white}.}\qquad
</math></dd>
</dl>

<p>\begin{align} \lambda - \lambda_0 &amp;= (1-f) \sin\alpha_0 \int_0^\sigma\frac {\sqrt{1 + k^2\sin^2\sigma'}} {1 - \cos^2\alpha_0\sin^2\sigma'}\,d\sigma'\\ &amp;= \omega - \sin\alpha_0 \int_0^\sigma\frac {e^2}{1 + \sqrt{1 - e^2\cos^2\beta(\sigma';\alpha_0)}}\,d\sigma'\\ &amp;= \omega - f\sin\alpha_0 \int_0^\sigma\frac {2-f}{1 + (1-f)\sqrt{1 + k^2\sin^2\sigma'}} \,d\sigma', \end{align} and the limits on the integrals are chosen so that λ = λ<sub>0</sub> at the equator crossing, σ = 0.</p>

<p>In using these integral relations, we allow σ to increase continuously (not restricting it to a range [−π, π], for example) as the great circle, resp. geodesic, encircles the auxiliary sphere, resp. ellipsoid. The quantities ω, λ, and <em>s</em> are likewise allowed to increase without limit. Once the problem is solved, λ can be reduced to the conventional range.</p>

<p>This completes the solution of the path of a geodesic using the auxiliary sphere. By this device a great circle can be mapped exactly to a geodesic on an ellipsoid of revolution. However, because the equations for <em>s</em> and λ in terms of the spherical quantities depend on α<sub>0</sub>, the mapping is not a consistent mapping of the surface of the sphere to the ellipsoid or vice versa; instead, it should be viewed merely as a convenient tool for solving for a particular geodesic.</p>

<p>There are also several ways of approximating geodesics on an ellipsoid which usually apply for sufficiently short lines ; however, these are typically comparable in complexity to the method for the exact solution given above .</p>
<h3 id="behavior-of-geodesics">Behavior of geodesics</h3>

<p>  Before solving for the geodesics, it is worth reviewing their behavior. Fig. 8 shows the simple closed geodesics which consist of the meridians (green) and the equator (red). (Here the qualification "simple" means that the geodesic closes on itself without an intervening self-intersection.) This follows from the equations for the geodesics given in the previous section.</p>

<p>For meridians, we have α<sub>0</sub> = 0 and Eq. (5) becomes λ = ω + λ<sub>0</sub>, i.e., the longitude will vary the same way as for a sphere, jumping by π each time the geodesic crosses the pole. The distance, Eq. (4), reduces to the length of an arc of an ellipse with semi-axes <em>a</em> and <em>b</em> (as expected), expressed in terms of parametric latitude, β.</p>

<p>The equator (β = 0</p>

<p>on the auxiliary sphere, φ = 0 on the ellipsoid) corresponds to α<sub>0</sub> = ½π. The distance reduces to the arc of a circle of radius <em>b</em> (and <em>not</em> <em>a</em>), <em>s</em> = <em>b</em>σ, while the longitude simplifies to λ = (1 − <em>f</em>)σ + λ<sub>0</sub>. A geodesic that is nearly equatorial will intersect the equator at intervals of π<em>b</em>. As a consequence, the maximum length of a equatorial geodesic which is also a shortest path is π<em>b</em> on an oblate ellipsoid (on a prolate ellipsoid, the maximum length is π<em>a</em>).</p>

<p>All other geodesics are typified by Figs. 9 to 11. Figure 9 shows latitude as a function of longitude for a geodesic starting on the equator with α<sub>0</sub> = 45°. A full cycle of the geodesic, from one northward crossing of the equator to the next, is shown. The equatorial crossings are called <em>nodes</em> and the points of maximum or minimum latitude are called <em>vertices</em>; the vertex latitudes are given by |β| = ±(½π − |α<sub>0</sub>|). The latitude is an odd, resp. even, function of the longitude about the nodes, resp. vertices. The geodesic completes one full oscillation in latitude before the longitude has increased by 360°. Thus, on each successive northward crossing of the equator (see Fig. 10), λ falls short of a full circuit of the equator by approximately 2π <em>f</em> sinα<sub>0</sub> (for a prolate ellipsoid, this quantity is negative and λ completes more that a full circuit; see Fig. 12). For nearly all values of α<sub>0</sub>, the geodesic will fill that portion of the ellipsoid between the two vertex latitudes (see Fig. 11).</p>

<p>If the ellipsoid is sufficiently oblate, i.e., <em>b</em>/<em>a</em> 0, for the green (resp. blue) geodesic is chosen to be 53.175° (resp. 75.192°), so that the geodesic completes 2 (resp. 3) complete oscillations about the equator on one circuit of the ellipsoid.</p>
<h3 id="evaluation-of-the-integrals">Evaluation of the integrals</h3>

<p>Solving the geodesic problems entails evaluating the integrals for the distance, <em>s</em>, and the longitude, λ, Eqs. (4) and (5). In geodetic applications, where <em>f</em> is small, the integrals are typically evaluated as a series; for this purpose, the second form of the longitude integral is preferred (since it avoids the near singular behavior of the first form when geodesics pass close to a pole). In both integrals, the integrand is an even periodic function of period π. Furthermore, the term dependent on σ is multiplied by a small quantity <em>k</em><sup>2</sup> = <em>O</em>(<em>f</em>). As a consequence, the integrals can both be written in the form</p>

<p>

<math display="block" id="Geodesics_on_an_ellipsoid:18">
 <semantics>
  <mrow>
   <mi>I</mi>
   <mo>=</mo>
   <mrow>
    <mrow>
     <msub>
      <mi>B</mi>
      <mn>0</mn>
     </msub>
     <mi>σ</mi>
    </mrow>
    <mo>+</mo>
    <mrow>
     <munderover>
      <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
      <mrow>
       <mi>j</mi>
       <mo>=</mo>
       <mn>1</mn>
      </mrow>
      <mi mathvariant="normal">∞</mi>
     </munderover>
     <mrow>
      <msub>
       <mi>B</mi>
       <mi>j</mi>
      </msub>
      <mrow>
       <mi>sin</mi>
       <mrow>
        <mn>2</mn>
        <mi>j</mi>
        <mi>σ</mi>
       </mrow>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>I</ci>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>B</ci>
       <cn type="integer">0</cn>
      </apply>
      <ci>σ</ci>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <apply>
         <eq></eq>
         <ci>j</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <infinity></infinity>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>B</ci>
        <ci>j</ci>
       </apply>
       <apply>
        <sin></sin>
        <apply>
         <times></times>
         <cn type="integer">2</cn>
         <ci>j</ci>
         <ci>σ</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   I=B_{0}\sigma+\sum_{j=1}^{\infty}B_{j}\sin 2j\sigma
  </annotation>
 </semantics>
</math>

 where <em>B</em><sub>0</sub> = 1 + <em>O</em>(<em>f</em>) and <em>B</em><sub><em>j</em></sub> = <em>O</em>(<em>f</em> <sup><em>j</em></sup>). Series expansions for <em>B</em><sub><em>j</em></sub> can readily be found and the result truncated so that only terms which are <em>O</em>(<em>f</em> <sup><em>J</em></sup>) and larger are retained. (Because the longitude integral is multiplied by <em>f</em>, it is typically only necessary to retain terms up to <em>O</em>(<em>f</em> <sup><em>J</em>−1</sup>) in that integral.) This prescription is followed by many authors      .  uses <em>J</em> = 3 which provides an accuracy of about 0.1 mm for the <a class="uri" href="WGS84" title="wikilink">WGS84</a> ellipsoid.  gives expansions carried out for <em>J</em> = 6 which suffices to provide full <a href="double_precision" title="wikilink">double precision</a> accuracy for |<em>f</em>| ≤ 1/50. Trigonometric series of this type can be conveniently summed using <a href="Clenshaw_summation" title="wikilink">Clenshaw summation</a>.</p>

<p>In order to solve the direct geodesic problem, it is necessary to find σ given <em>s</em>. Since the integrand in the distance integral is positive, this problem has a unique root, which may be found using <a href="Newton's_method" title="wikilink">Newton's method</a>, noting that the required derivative is just the integrand of the distance integral.  instead uses <a href="series_reversion" title="wikilink">series reversion</a> so that σ can be found without iteration;  gives a similar series. The reverted series converges somewhat slower that the direct series and, if |<em>f</em>| &gt; 1/100,  supplements the reverted series with one step of Newton's method to maintain accuracy.  instead relies on a simpler (but slower) function iteration to solve for σ.</p>

<p>It is also possible to evaluate the integrals (4) and (5) by numerical quadrature    or to apply numerical techniques for the solution of the ordinary differential equations, Eqs. (2)   . Such techniques can be used for arbitrary flattening <em>f</em>. However, if <em>f</em> is small, e.g., |<em>f</em>| ≤ 1/50, they do not offer the speed and accuracy of the series expansions described above. Furthermore, for arbitrary <em>f</em>, the evaluation of the integrals in terms of elliptic integrals (see below) also provides a fast and accurate solution. On the other hand,  has tackled the more complex problem of geodesics on the surface at a constant altitude, <em>h</em>, above the ellipsoid by solving the corresponding ordinary differential equations, Eqs. (2) with [ρ, ν] replaced by [ρ + <em>h</em>, ν + <em>h</em>].</p>

<p>  Geodesics on an ellipsoid was an early application of <a href="elliptic_integrals" title="wikilink">elliptic integrals</a>. In particular,  writes the integrals, Eqs. (4) and (5), as</p>
<dl>
<dd>(6)<math>{\color{white}.}\qquad
</math></dd>
</dl>

<p>\displaystyle</p>

<p><code> \frac sb = E(\sigma, ik),</code></p>

<p></p>
<dl>
<dd>(7)<math>{\color{white}.}\qquad
</math></dd>
</dl>

<p>\begin{align}</p>

<p><code> \lambda &amp;= (1 - f) \sin\alpha_0  G(\sigma, \cos^2\alpha_0, ik) \\</code><br/>
<code>         &amp;= \chi</code><br/>
<code>          - \frac{e'^2}{\sqrt{1+e'^2}}\sin\alpha_0 H(\sigma, -e'^2, ik), \\</code></p>

<p>\end{align}  where</p>

<p>

<math display="block" id="Geodesics_on_an_ellipsoid:19">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>tan</mi>
     <mi>χ</mi>
    </mrow>
    <mo>=</mo>
    <mrow>
     <msqrt>
      <mfrac>
       <mrow>
        <mn>1</mn>
        <mo>+</mo>
        <msup>
         <mi>e</mi>
         <mrow>
          <mi mathvariant="normal">′</mi>
          <mn>2</mn>
         </mrow>
        </msup>
       </mrow>
       <mrow>
        <mn>1</mn>
        <mo>+</mo>
        <mrow>
         <msup>
          <mi>k</mi>
          <mn>2</mn>
         </msup>
         <mrow>
          <msup>
           <mi>sin</mi>
           <mn>2</mn>
          </msup>
          <mi>σ</mi>
         </mrow>
        </mrow>
       </mrow>
      </mfrac>
     </msqrt>
     <mrow>
      <mi>tan</mi>
      <mi>ω</mi>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <tan></tan>
     <ci>χ</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <root></root>
      <apply>
       <divide></divide>
       <apply>
        <plus></plus>
        <cn type="integer">1</cn>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>e</ci>
         <list>
          <ci>normal-′</ci>
          <cn type="integer">2</cn>
         </list>
        </apply>
       </apply>
       <apply>
        <plus></plus>
        <cn type="integer">1</cn>
        <apply>
         <times></times>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>k</ci>
          <cn type="integer">2</cn>
         </apply>
         <apply>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <sin></sin>
           <cn type="integer">2</cn>
          </apply>
          <ci>σ</ci>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <tan></tan>
      <ci>ω</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \tan\chi=\sqrt{\frac{1+e^{\prime 2}}{1+k^{2}\sin^{2}\sigma}}\tan\omega,
  </annotation>
 </semantics>
</math>

 and</p>

<p>

<math display="inline" id="Geodesics_on_an_ellipsoid:20">
 <semantics>
  <mrow>
   <mi>G</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>ϕ</mi>
    <mo>,</mo>
    <msup>
     <mi>α</mi>
     <mn>2</mn>
    </msup>
    <mo>,</mo>
    <mi>k</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>G</ci>
    <vector>
     <ci>ϕ</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>α</ci>
      <cn type="integer">2</cn>
     </apply>
     <ci>k</ci>
    </vector>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle G(\phi,\alpha^{2},k)
  </annotation>
 </semantics>
</math>


 and <em>F</em>(φ, <em>k</em>), <em>E</em>(φ, <em>k</em>), and Π(φ, α<sup>2</sup>, <em>k</em>), are <a href="Elliptic_integral" title="wikilink">incomplete elliptic integrals</a> in the notation of . The first formula for the longitude in Eq. (7) follows directly from the first form of Eq. (5). The second formula in Eq. (7), due to , is more convenient for calculation since the elliptic integral appears in a small term. The equivalence of the two forms follows from . Fast algorithms for computing elliptic integrals are given by  in terms of <a href="Carlson_symmetric_form" title="wikilink">symmetric elliptic integrals</a>. Equation (6) is conveniently inverted using <a href="Newton's_method" title="wikilink">Newton's method</a>. The use of elliptic integrals provides a good method of solving the geodesic problem for |<em>f</em>| &gt; 1/50.</p>
<h3 id="solution-of-the-direct-problem">Solution of the direct problem</h3>

<p>The basic strategy for solving the geodesic problems on the ellipsoid is to map the problem onto the auxiliary sphere by converting φ, λ, and <em>s</em>, to β, ω and σ, to solve the corresponding great-circle problem on the sphere, and to transfer the results back to the ellipsoid.</p>

<p>In implementing this program, we will frequently need to solve the "elementary" spherical triangle for <em>NEP</em> in Fig. 6 with <em>P</em> replaced by either <em>A</em> (subscript 1) or <em>B</em> (subscript 2). For this purpose, we can apply <a href="Spherical_trigonometry#Napier's_rules_for_quadrantal_triangles" title="wikilink"> Napier's rules for quadrantal triangles</a> to the triangle <em>NEP</em> on the auxiliary sphere which give</p>

<p>

<math display="inline" id="Geodesics_on_an_ellipsoid:21">
 <semantics>
  <mrow>
   <mi>sin</mi>
   <msub>
    <mi>α</mi>
    <mn>0</mn>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <sin></sin>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>α</ci>
     <cn type="integer">0</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle\sin\alpha_{0}
  </annotation>
 </semantics>
</math>


 We can also stipulate that cosβ ≥ 0 and cosα<sub>0</sub> ≥ 0. Implementing this plan for the direct problem is straightforward. We are given φ<sub>1</sub>, α<sub>1</sub>, and <em>s</em><sub>12</sub>. From φ<sub>1</sub> we obtain β<sub>1</sub> (using the formula for the parametric latitude). We now solve the triangle problem with <em>P</em> = <em>A</em> and β<sub>1</sub> and α<sub>1</sub> given to find α<sub>0</sub>, σ<sub>1</sub>, and ω<sub>1</sub>. Use the distance and longitude equations, Eqs. (4) and (5), together with the known value of λ<sub>1</sub>, to find <em>s</em><sub>1</sub> and λ<sub>0</sub>. Determine <em>s</em><sub>2</sub> = <em>s</em><sub>1</sub> + <em>s</em><sub>12</sub> and invert the distance equation to find σ<sub>2</sub>. Solve the triangle problem with <em>P</em> = <em>B</em> and α<sub>0</sub> and σ<sub>2</sub> given to find β<sub>2</sub>, ω<sub>2</sub>, and α<sub>2</sub>. Convert β<sub>2</sub> to φ<sub>2</sub> and substitute σ<sub>2</sub> and ω<sub>2</sub> into the longitude equation to give λ<sub>2</sub>.</p>

<p>The overall method follows the procedure for <a href="Great-circle_navigation#Finding_way-points" title="wikilink">solving the direct problem on a sphere</a>. It is essentially the program laid out by , , and most subsequent authors.</p>

<p>Intermediate points, <a href="way-point" title="wikilink">way-points</a>, on a geodesic can be found by holding φ<sub>1</sub> and α<sub>1</sub> fixed and solving the direct problem for several values of <em>s</em><sub>12</sub>. Once the first waypoint is found, only the last portion of the solution (starting with the determination of <em>s</em><sub>2</sub>) needs to be repeated for each new value of <em>s</em><sub>12</sub>.</p>
<h3 id="solution-of-the-inverse-problem">Solution of the inverse problem</h3>

<p>The ease with which the direct problem can be solved results from the fact that given φ<sub>1</sub> and α<sub>1</sub>, we can immediately find α<sub>0</sub>, the parameter in the distance and longitude integrals, Eqs. (4) and (5). In the case of the inverse problem, we are given λ<sub>12</sub>, but we cannot easily relate this to the equivalent spherical angle ω<sub>12</sub> because α<sub>0</sub> is unknown. Thus, the solution of the problem requires that α<sub>0</sub> be found iteratively. Before tackling this, it is worth understanding better the behavior of geodesics, this time, keeping the starting point fixed and varying the azimuth.</p>

<p>Suppose point <em>A</em> in the inverse problem has φ<sub>1</sub> = −30° and λ<sub>1</sub> = 0°. Fig. 15 shows geodesics (in blue) emanating <em>A</em> with α<sub>1</sub> a multiple of 15° up to the point at which they cease to be shortest paths. (The flattening has been increased to 1/10 in order to accentuate the ellipsoidal effects.) Also shown (in green) are curves of constant <em>s</em><sub>12</sub>, which are the geodesic circles centered <em>A</em>.  showed that, on any surface, geodesics and geodesic circle intersect at right angles. The red line is the <a href="cut_locus" title="wikilink">cut locus</a>, the locus of points which have multiple (two in this case) shortest geodesics from <em>A</em>. On a sphere, the cut locus is a point. On an oblate ellipsoid (shown here), it is a segment of the circle of latitude centered on the point <a href="antipodes" title="wikilink">antipodal</a> to <em>A</em>, φ = −φ<sub>1</sub>. The longitudinal extent of cut locus is approximately λ<sub>12</sub> ∈ [π − <em>f</em> π cosφ<sub>1</sub>, π + <em>f</em> π cosφ<sub>1</sub>]. If <em>A</em> lies on the equator, φ<sub>1</sub> = 0, this relation is exact and as a consequence the equator is only a shortest geodesic if |λ<sub>12</sub>| ≤ (1 − <em>f</em>)π. For a prolate ellipsoid, the cut locus is a segment of the anti-meridian centered on the point antipodal to <em>A</em>, λ<sub>12</sub> = π, and this means that meridional geodesics stop being shortest paths before the antipodal point is reached.</p>

<p>The solution of the inverse problem involves determining, for a given point <em>B</em> with latitude φ<sub>2</sub> and longitude λ<sub>2</sub> which blue and green curves it lies on; this determines α<sub>1</sub> and <em>s</em><sub>12</sub> respectively. In Fig. 16, the ellipsoid has been "rolled out" onto a <a href="plate_carrée_projection" title="wikilink">plate carrée projection</a>. Suppose φ<sub>2</sub> = 20°, the green line in the figure. Then as α<sub>1</sub> is varied between 0° and 180°, the longitude at which the geodesic intersects φ = φ<sub>2</sub> varies between 0° and 180° (see Fig. 17). This behavior holds provided that |φ<sub>2</sub>| ≤ |φ<sub>1</sub>| (otherwise the geodesic does not reach φ<sub>2</sub> for some values of α<sub>1</sub>). Thus, the inverse problem may be solved by determining the value α<sub>1</sub> which results in the given value of λ<sub>12</sub> when the geodesic intersects the circle φ = φ<sub>2</sub>.</p>

<p>This suggests the following strategy for solving the inverse problem . Assume that the points <em>A</em> and <em>B</em> satisfy</p>
<dl>
<dd>(8)<math>{\color{white}.}\qquad
</math></dd>
</dl>

<p>\phi_1 \le 0, \quad \left|\phi_2\right| \le \left|\phi_1\right|, \quad 0 \le \lambda_{12} \le \pi.  (There is no loss of generality in this assumption, since the symmetries of the problem can be used to generate any configuration of points from such configurations.)</p>
<ol>
<li>First treat the "easy" cases, geodesics which lie on a meridian or the equator. Otherwise...</li>
<li>Guess a value of α<sub>1</sub>.</li>
<li>Solve the so-called <em>hybrid geodesic problem</em>, given φ<sub>1</sub>, φ<sub>2</sub>, and α<sub>1</sub> find λ<sub>12</sub>, <em>s</em><sub>12</sub>, and α<sub>2</sub>, corresponding to the <em>first</em> intersection of the geodesic with the circle φ = φ<sub>2</sub>.</li>
<li>Compare the resulting λ<sub>12</sub> with the desired value and adjust α<sub>1</sub> until the two values agree. This completes the solution.</li>
</ol>

<p>Each of these steps requires some discussion.</p>

<p>1. For an oblate ellipsoid, the shortest geodesic lies on a meridian if either point lies on a pole or if λ<sub>12</sub> = 0 or ±π. The shortest geodesic follows the equator if φ<sub>1</sub> = φ<sub>2</sub> = 0 and |λ<sub>12</sub>| ≤ (1 − <em>f</em>)π. For a prolate ellipsoid, the meridian is no longer the shortest geodesic if λ<sub>12</sub> = ±π and the points are close to antipodal (this will be discussed in the next section). There is no longitudinal restriction on equatorial geodesics.</p>

<p>2. In most cases a suitable starting value of α<sub>1</sub> is found by solving <a href="Solution_of_triangles#Two_sides_and_the_included_angle_given" title="wikilink"> the spherical inverse problem</a></p>

<p>

<math display="block" id="Geodesics_on_an_ellipsoid:22">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>tan</mi>
     <msub>
      <mi>α</mi>
      <mn>1</mn>
     </msub>
    </mrow>
    <mo>=</mo>
    <mfrac>
     <mrow>
      <mrow>
       <mi>cos</mi>
       <msub>
        <mi>β</mi>
        <mn>2</mn>
       </msub>
      </mrow>
      <mrow>
       <mi>sin</mi>
       <msub>
        <mi>ω</mi>
        <mn>12</mn>
       </msub>
      </mrow>
     </mrow>
     <mrow>
      <mrow>
       <mrow>
        <mi>cos</mi>
        <msub>
         <mi>β</mi>
         <mn>1</mn>
        </msub>
       </mrow>
       <mrow>
        <mi>sin</mi>
        <msub>
         <mi>β</mi>
         <mn>2</mn>
        </msub>
       </mrow>
      </mrow>
      <mo>-</mo>
      <mrow>
       <mrow>
        <mi>sin</mi>
        <msub>
         <mi>β</mi>
         <mn>1</mn>
        </msub>
       </mrow>
       <mrow>
        <mi>cos</mi>
        <msub>
         <mi>β</mi>
         <mn>2</mn>
        </msub>
       </mrow>
       <mrow>
        <mi>cos</mi>
        <msub>
         <mi>ω</mi>
         <mn>12</mn>
        </msub>
       </mrow>
      </mrow>
     </mrow>
    </mfrac>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <tan></tan>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>α</ci>
      <cn type="integer">1</cn>
     </apply>
    </apply>
    <apply>
     <divide></divide>
     <apply>
      <times></times>
      <apply>
       <cos></cos>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>β</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
      <apply>
       <sin></sin>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>ω</ci>
        <cn type="integer">12</cn>
       </apply>
      </apply>
     </apply>
     <apply>
      <minus></minus>
      <apply>
       <times></times>
       <apply>
        <cos></cos>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>β</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <apply>
        <sin></sin>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>β</ci>
         <cn type="integer">2</cn>
        </apply>
       </apply>
      </apply>
      <apply>
       <times></times>
       <apply>
        <sin></sin>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>β</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <apply>
        <cos></cos>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>β</ci>
         <cn type="integer">2</cn>
        </apply>
       </apply>
       <apply>
        <cos></cos>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>ω</ci>
         <cn type="integer">12</cn>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \tan\alpha_{1}=\frac{\cos\beta_{2}\sin\omega_{12}}{\cos\beta_{1}\sin\beta_{2}-%
\sin\beta_{1}\cos\beta_{2}\cos\omega_{12}},
  </annotation>
 </semantics>
</math>

 with ω<sub>12</sub> = λ<sub>12</sub>. This may be a bad approximation if <em>A</em> and <em>B</em> are nearly antipodal (both the numerator and denominator in the formula above become small); however, this may not matter (depending on how step 4 is handled).</p>

<p>3. The solution of the hybrid geodesic problem is as follows. It starts the same way as the solution of the direct problem, solving the triangle <em>NEP</em> with <em>P</em> = <em>A</em> to find α<sub>0</sub>, σ<sub>1</sub>, ω<sub>1</sub>, and λ<sub>0</sub>. Now find α<sub>2</sub> from sinα<sub>2</sub> = sinα<sub>0</sub>/cosβ<sub>2</sub>, taking cosα<sub>2</sub> ≥ 0 (corresponding to the first, northward, crossing of the circle φ = φ<sub>2</sub>). Next, σ<sub>2</sub> is given by tanσ<sub>2</sub> = tanβ<sub>2</sub>/cosα<sub>2</sub> and ω<sub>2</sub> by tanω<sub>2</sub> = tanσ<sub>2</sub>/sinα<sub>0</sub>. Finally, use the distance and longitude equations, Eqs. (4) and (5), to find <em>s</em><sub>12</sub> and λ<sub>12</sub>.</p>

<p>4. In order to discuss how α<sub>1</sub> is updated, let us define the root-finding problem in more detail. The curve in Fig. 17 shows λ<sub>12</sub>(α<sub>1</sub>; φ<sub>1</sub>, φ<sub>2</sub>) where we regard φ<sub>1</sub> and φ<sub>2</sub> as parameters and α<sub>1</sub> as the independent variable. We seek the value of α<sub>1</sub> which is the root of</p>

<p>

<math display="block" id="Geodesics_on_an_ellipsoid:23">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>g</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <msub>
       <mi>α</mi>
       <mn>1</mn>
      </msub>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>≡</mo>
    <mrow>
     <mrow>
      <msub>
       <mi>λ</mi>
       <mn>12</mn>
      </msub>
      <mrow>
       <mo stretchy="false">(</mo>
       <msub>
        <mi>α</mi>
        <mn>1</mn>
       </msub>
       <mo>;</mo>
       <msub>
        <mi>ϕ</mi>
        <mn>1</mn>
       </msub>
       <mo>,</mo>
       <msub>
        <mi>ϕ</mi>
        <mn>2</mn>
       </msub>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo>-</mo>
     <msub>
      <mi>λ</mi>
      <mn>12</mn>
     </msub>
    </mrow>
    <mo>=</mo>
    <mn>0</mn>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <equivalent></equivalent>
     <apply>
      <times></times>
      <ci>g</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>α</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <apply>
      <minus></minus>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>λ</ci>
        <cn type="integer">12</cn>
       </apply>
       <list>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>α</ci>
         <cn type="integer">1</cn>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>ϕ</ci>
         <cn type="integer">1</cn>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>ϕ</ci>
         <cn type="integer">2</cn>
        </apply>
       </list>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>λ</ci>
       <cn type="integer">12</cn>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <cn type="integer">0</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   g(\alpha_{1})\equiv\lambda_{12}(\alpha_{1};\phi_{1},\phi_{2})-\lambda_{12}=0,
  </annotation>
 </semantics>
</math>

 where <em>g</em>(0) ≤ 0 and <em>g</em>(π) ≥ 0. In fact, there is a unique root in the interval α<sub>1</sub> ∈ [0, π]. Any of a number of <a href="root-finding_algorithms" title="wikilink">root-finding algorithms</a> can be used to solve such an equation.  uses <a href="Newton's_method" title="wikilink">Newton's method</a>, which requires a good starting guess; however it may be supplemented by a <a class="uri" href="fail-safe" title="wikilink">fail-safe</a> method, such as the <a href="bisection_method" title="wikilink">bisection method</a>, to guarantee convergence.</p>

<p> An alternative method for solving the inverse problem is given by . Let us rewrite the Eq. (5) as</p>

<p>

<math display="inline" id="Geodesics_on_an_ellipsoid:24">
 <semantics>
  <msub>
   <mi>λ</mi>
   <mn>12</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>λ</ci>
    <cn type="integer">12</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle\lambda_{12}
  </annotation>
 </semantics>
</math>


</p>

<p>Helmert's method entails assuming that ω<sub>12</sub> = λ<sub>12</sub>, solving the resulting problem on auxiliary sphere, and obtaining an updated estimate of ω<sub>12</sub> using</p>

<p>

<math display="block" id="Geodesics_on_an_ellipsoid:25">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>ω</mi>
     <mn>12</mn>
    </msub>
    <mo>=</mo>
    <mrow>
     <msub>
      <mi>λ</mi>
      <mn>12</mn>
     </msub>
     <mo>+</mo>
     <mrow>
      <mi>f</mi>
      <mrow>
       <mi>sin</mi>
       <mrow>
        <msub>
         <mi>α</mi>
         <mn>0</mn>
        </msub>
        <mi>I</mi>
       </mrow>
      </mrow>
      <mrow>
       <mo stretchy="false">(</mo>
       <msub>
        <mi>σ</mi>
        <mn>1</mn>
       </msub>
       <mo>,</mo>
       <msub>
        <mi>σ</mi>
        <mn>2</mn>
       </msub>
       <mo>;</mo>
       <msub>
        <mi>α</mi>
        <mn>0</mn>
       </msub>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>ω</ci>
     <cn type="integer">12</cn>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>λ</ci>
      <cn type="integer">12</cn>
     </apply>
     <apply>
      <times></times>
      <ci>f</ci>
      <apply>
       <sin></sin>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>α</ci>
         <cn type="integer">0</cn>
        </apply>
        <ci>I</ci>
       </apply>
      </apply>
      <vector>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>σ</ci>
        <cn type="integer">1</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>σ</ci>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>α</ci>
        <cn type="integer">0</cn>
       </apply>
      </vector>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \omega_{12}=\lambda_{12}+f\sin\alpha_{0}I(\sigma_{1},\sigma_{2};\alpha_{0}).
  </annotation>
 </semantics>
</math>

 This <a href="fixed_point_iteration" title="wikilink">fixed point iteration</a> is repeated until convergence.  advocates this method and  adopted it in his solution of the inverse problem. The drawbacks of this method are that convergence is slower than obtained using Newton's method (as described above) and, more seriously, that the process fails to converge at all for nearly antipodal points. In a subsequent report,  attempts to cure this defect; but he is only partially successful—the  implementation still includes Vincenty's fix still fails to converge in some cases.  has compared 17 methods for solving the inverse problem against the method given by .</p>

<p>The shortest distance returned by the solution of the inverse problem is (obviously) uniquely defined. However, if <em>B</em> lies on the cut locus of <em>A</em> there are multiple azimuths which yield the same shortest distance. Here is a catalog of those cases:</p>
<ul>
<li>φ<sub>1</sub> = −φ<sub>2</sub> (with neither point at a pole). If α<sub>1</sub> = α<sub>2</sub>, the geodesic is unique. Otherwise there are two geodesics and the second one is obtained by interchanging α<sub>1</sub> and α<sub>2</sub>. (This occurs when λ<sub>12</sub> ≈ ±π for oblate ellipsoids.)</li>
<li>λ<sub>12</sub> = ±π (with neither point at a pole). If α<sub>1</sub> = 0 or ±π, the geodesic is unique. Otherwise there are two geodesics and the second one is obtained by negating α<sub>1</sub> and α<sub>2</sub>. (This occurs when φ<sub>1</sub> + φ<sub>2</sub> ≈ 0 for prolate ellipsoids.)</li>
<li><em>A</em> and <em>B</em> are at opposite poles. There are infinitely many geodesics which can be generated by varying the azimuths so as to keep α<sub>1</sub> + α<sub>2</sub> constant. (For spheres, this prescription applies when <em>A</em> and <em>B</em> are antipodal.)</li>
</ul>
<h3 id="differential-behavior-of-geodesics">Differential behavior of geodesics</h3>

<p>  Various problems involving geodesics require knowing their behavior when they are perturbed. This is useful in trigonometric adjustments , determining the physical properties of signals which follow geodesics, etc. Consider a reference geodesic, parameterized by <em>s</em> the length from the northward equator crossing, and a second geodesic a small distance <em>t</em>(<em>s</em>) away from it.  showed that <em>t</em>(<em>s</em>) obeys the <a href="Differential_geometry_of_surfaces#Gauss–Jacobi_equation" title="wikilink"> Gauss-Jacobi equation</a></p>
<dl>
<dd>(9)<math>{\color{white}.}\qquad
</math></dd>
</dl>

<p>\displaystyle\frac{d^2t(s)}{ds^2} = K(s) t(s),   where <em>K</em>(<em>s</em>) is the <a href="Gaussian_curvature" title="wikilink">Gaussian curvature</a> at <em>s</em>. The solution may be expressed as the sum of two independent solutions</p>

<p>

<math display="block" id="Geodesics_on_an_ellipsoid:26">
 <semantics>
  <mrow>
   <mrow>
    <mi>t</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <msub>
      <mi>s</mi>
      <mn>2</mn>
     </msub>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mi>C</mi>
     <mi>m</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <msub>
       <mi>s</mi>
       <mn>1</mn>
      </msub>
      <mo>,</mo>
      <msub>
       <mi>s</mi>
       <mn>2</mn>
      </msub>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>+</mo>
    <mrow>
     <mi>D</mi>
     <mi>M</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <msub>
       <mi>s</mi>
       <mn>1</mn>
      </msub>
      <mo>,</mo>
      <msub>
       <mi>s</mi>
       <mn>2</mn>
      </msub>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>t</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>s</ci>
      <cn type="integer">2</cn>
     </apply>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <ci>C</ci>
      <ci>m</ci>
      <interval closure="open">
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>s</ci>
        <cn type="integer">1</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>s</ci>
        <cn type="integer">2</cn>
       </apply>
      </interval>
     </apply>
     <apply>
      <times></times>
      <ci>D</ci>
      <ci>M</ci>
      <interval closure="open">
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>s</ci>
        <cn type="integer">1</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>s</ci>
        <cn type="integer">2</cn>
       </apply>
      </interval>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   t(s_{2})=Cm(s_{1},s_{2})+DM(s_{1},s_{2})
  </annotation>
 </semantics>
</math>

 where</p>

<p>

<math display="inline" id="Geodesics_on_an_ellipsoid:27">
 <semantics>
  <mrow>
   <mi>m</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>s</mi>
     <mn>1</mn>
    </msub>
    <mo>,</mo>
    <msub>
     <mi>s</mi>
     <mn>1</mn>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>m</ci>
    <interval closure="open">
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>s</ci>
      <cn type="integer">1</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>s</ci>
      <cn type="integer">1</cn>
     </apply>
    </interval>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle m(s_{1},s_{1})
  </annotation>
 </semantics>
</math>


 We shall abbreviate <em>m</em>(<em>s</em><sub>1</sub>, <em>s</em><sub>2</sub>) = <em>m</em><sub>12</sub>, the so-called <em>reduced length</em>, and <em>M</em>(<em>s</em><sub>1</sub>, <em>s</em><sub>2</sub>) = <em>M</em><sub>12</sub>, the <em>geodesic scale</em>. Their basic definitions are illustrated in Fig. 18.  made an extensive study of their properties. The reduced length obeys a reciprocity relation,</p>

<p>

<math display="block" id="Geodesics_on_an_ellipsoid:28">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>m</mi>
     <mn>12</mn>
    </msub>
    <mo>+</mo>
    <msub>
     <mi>m</mi>
     <mn>21</mn>
    </msub>
   </mrow>
   <mo>=</mo>
   <mn>0.</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <plus></plus>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>m</ci>
      <cn type="integer">12</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>m</ci>
      <cn type="integer">21</cn>
     </apply>
    </apply>
    <cn type="float">0.</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   m_{12}+m_{21}=0.
  </annotation>
 </semantics>
</math>

 Their derivatives are</p>

<p>

<math display="inline" id="Geodesics_on_an_ellipsoid:29">
 <semantics>
  <mstyle displaystyle="true">
   <mfrac>
    <mrow>
     <mi>d</mi>
     <msub>
      <mi>m</mi>
      <mn>12</mn>
     </msub>
    </mrow>
    <mrow>
     <mi>d</mi>
     <msub>
      <mi>s</mi>
      <mn>2</mn>
     </msub>
    </mrow>
   </mfrac>
  </mstyle>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <divide></divide>
    <apply>
     <times></times>
     <ci>d</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>m</ci>
      <cn type="integer">12</cn>
     </apply>
    </apply>
    <apply>
     <times></times>
     <ci>d</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>s</ci>
      <cn type="integer">2</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle\frac{dm_{12}}{ds_{2}}
  </annotation>
 </semantics>
</math>


 Assuming that points 1, 2, and 3, lie on the same geodesic, then the following addition rules apply ,</p>

<p>

<math display="inline" id="Geodesics_on_an_ellipsoid:30">
 <semantics>
  <msub>
   <mi>m</mi>
   <mn>13</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>m</ci>
    <cn type="integer">13</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle m_{13}
  </annotation>
 </semantics>
</math>


 The reduced length and the geodesic scale are components of the <a href="Jacobi_field" title="wikilink">Jacobi field</a>.</p>

<p>The <a href="Ellipsoid_of_revolution#Curvature" title="wikilink">Gaussian curvature for an ellipsoid of revolution</a> is</p>

<p>

<math display="block" id="Geodesics_on_an_ellipsoid:31">
 <semantics>
  <mrow>
   <mrow>
    <mi>K</mi>
    <mo>=</mo>
    <mfrac>
     <mn>1</mn>
     <mrow>
      <mi>ρ</mi>
      <mi>ν</mi>
     </mrow>
    </mfrac>
    <mo>=</mo>
    <mfrac>
     <msup>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mn>1</mn>
        <mo>-</mo>
        <mrow>
         <msup>
          <mi>e</mi>
          <mn>2</mn>
         </msup>
         <mrow>
          <msup>
           <mi>sin</mi>
           <mn>2</mn>
          </msup>
          <mi>ϕ</mi>
         </mrow>
        </mrow>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
      <mn>2</mn>
     </msup>
     <msup>
      <mi>b</mi>
      <mn>2</mn>
     </msup>
    </mfrac>
    <mo>=</mo>
    <mfrac>
     <msup>
      <mi>b</mi>
      <mn>2</mn>
     </msup>
     <mrow>
      <msup>
       <mi>a</mi>
       <mn>4</mn>
      </msup>
      <msup>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mn>1</mn>
         <mo>-</mo>
         <mrow>
          <msup>
           <mi>e</mi>
           <mn>2</mn>
          </msup>
          <mrow>
           <msup>
            <mi>cos</mi>
            <mn>2</mn>
           </msup>
           <mi>β</mi>
          </mrow>
         </mrow>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
       <mn>2</mn>
      </msup>
     </mrow>
    </mfrac>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <ci>K</ci>
     <apply>
      <divide></divide>
      <cn type="integer">1</cn>
      <apply>
       <times></times>
       <ci>ρ</ci>
       <ci>ν</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <divide></divide>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
        <apply>
         <times></times>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>e</ci>
          <cn type="integer">2</cn>
         </apply>
         <apply>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <sin></sin>
           <cn type="integer">2</cn>
          </apply>
          <ci>ϕ</ci>
         </apply>
        </apply>
       </apply>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>b</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <divide></divide>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>b</ci>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>a</ci>
        <cn type="integer">4</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <minus></minus>
         <cn type="integer">1</cn>
         <apply>
          <times></times>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <ci>e</ci>
           <cn type="integer">2</cn>
          </apply>
          <apply>
           <apply>
            <csymbol cd="ambiguous">superscript</csymbol>
            <cos></cos>
            <cn type="integer">2</cn>
           </apply>
           <ci>β</ci>
          </apply>
         </apply>
        </apply>
        <cn type="integer">2</cn>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   K=\frac{1}{\rho\nu}=\frac{(1-e^{2}\sin^{2}\phi)^{2}}{b^{2}}=\frac{b^{2}}{a^{4}%
(1-e^{2}\cos^{2}\beta)^{2}}.
  </annotation>
 </semantics>
</math>

  solved the Gauss-Jacobi equation for this case obtaining</p>

<p>

<math display="inline" id="Geodesics_on_an_ellipsoid:32">
 <semantics>
  <mrow>
   <msub>
    <mi>m</mi>
    <mn>12</mn>
   </msub>
   <mo>/</mo>
   <mi>b</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <divide></divide>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>m</ci>
     <cn type="integer">12</cn>
    </apply>
    <ci>b</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle m_{12}/b
  </annotation>
 </semantics>
</math>


 where</p>

<p>

<math display="inline" id="Geodesics_on_an_ellipsoid:33">
 <semantics>
  <mrow>
   <mi>J</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>σ</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>J</ci>
    <ci>σ</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle J(\sigma)
  </annotation>
 </semantics>
</math>


</p>

<p>As we see from Fig. 18 (top sub-figure), the separation of two geodesics starting at the same point with azimuths differing by <em>d</em>α<sub>1</sub> is <em>m</em><sub>12</sub> <em>d</em>α<sub>1</sub>. On a closed surface such as an ellipsoid, we expect <em>m</em><sub>12</sub> to oscillate about zero. Indeed, if the starting point of a geodesic is a pole, φ<sub>1</sub> = ½π, then the reduced length is the radius of the circle of latitude, <em>m</em><sub>12</sub> = <em>a</em> cosβ<sub>2</sub> = <em>a</em> sinσ<sub>12</sub>. Similarly, for a meridional geodesic starting on the equator, φ<sub>1</sub> = α<sub>1</sub> = 0, we have <em>M</em><sub>12</sub> = cosσ<sub>12</sub>. In the typical case, these quantities oscillate with a period of about 2π in σ<sub>12</sub> and grow linearly with distance at a rate proportional to <em>f</em>. In trigonometric adjustments over small areas, it may be possible to approximate <em>K</em>(<em>s</em>) in Eq. (9) by a constant <em>K</em>. In this limit, the solutions for <em>m</em><sub>12</sub> and <em>M</em><sub>12</sub> are the same as for a sphere of radius 1/√<em>K</em>, namely,</p>

<p>

<math display="block" id="Geodesics_on_an_ellipsoid:34">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <msub>
      <mi>m</mi>
      <mn>12</mn>
     </msub>
     <mo>=</mo>
     <mrow>
      <mrow>
       <mi>sin</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <msqrt>
          <mi>K</mi>
         </msqrt>
         <msub>
          <mi>s</mi>
          <mn>12</mn>
         </msub>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
      <mo>/</mo>
      <msqrt>
       <mi>K</mi>
      </msqrt>
     </mrow>
    </mrow>
    <mo rspace="12.5pt">,</mo>
    <mrow>
     <msub>
      <mi>M</mi>
      <mn>12</mn>
     </msub>
     <mo>=</mo>
     <mrow>
      <mi>cos</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <msqrt>
         <mi>K</mi>
        </msqrt>
        <msub>
         <mi>s</mi>
         <mn>12</mn>
        </msub>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>m</ci>
      <cn type="integer">12</cn>
     </apply>
     <apply>
      <divide></divide>
      <apply>
       <sin></sin>
       <apply>
        <times></times>
        <apply>
         <root></root>
         <ci>K</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>s</ci>
         <cn type="integer">12</cn>
        </apply>
       </apply>
      </apply>
      <apply>
       <root></root>
       <ci>K</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>M</ci>
      <cn type="integer">12</cn>
     </apply>
     <apply>
      <cos></cos>
      <apply>
       <times></times>
       <apply>
        <root></root>
        <ci>K</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>s</ci>
        <cn type="integer">12</cn>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   m_{12}=\sin(\sqrt{K}s_{12})/\sqrt{K},\quad M_{12}=\cos(\sqrt{K}s_{12}).
  </annotation>
 </semantics>
</math>

</p>

<p>To simplify the discussion of shortest paths in this paragraph we consider only geodesics with <em>s</em><sub>12</sub> &gt; 0. The point at which <em>m</em><sub>12</sub> becomes zero is the point <a href="conjugate_point" title="wikilink">conjugate</a> to the starting point. In order for a geodesic between <em>A</em> and <em>B</em>, of length <em>s</em><sub>12</sub>, to be a shortest path it must satisfy the Jacobi condition    , that there is no point conjugate to <em>A</em> between <em>A</em> and <em>B</em>. If this condition is not satisfied, then there is a <em>nearby</em> path (not necessarily a geodesic) which is shorter. Thus, the Jacobi condition is a local property of the geodesic and is only a necessary condition for the geodesic being a global shortest path. Necessary and sufficient conditions for a geodesic being the shortest path are:</p>
<ul>
<li>for an oblate ellipsoid, |σ<sub>12</sub>| ≤ π;</li>
<li>for a prolate ellipsoid, |λ<sub>12</sub>| ≤ π, if α<sub>0</sub> ≠ 0; if α<sub>0</sub> = 0, the supplemental condition <em>m</em><sub>12</sub> ≥ 0 is required if |λ<sub>12</sub>| = π.</li>
</ul>

<p>The latter condition above can be used to determine whether the shortest path is a meridian in the case of a prolate ellipsoid with |λ<sub>12</sub>| = π. The derivative required to solve the inverse method using Newton's method, ∂λ<sub>12</sub>(α<sub>1</sub>; φ<sub>1</sub>, φ<sub>2</sub>) / ∂α<sub>1</sub>, is given in terms of the reduced length .</p>
<h3 id="geodesic-map-projections">Geodesic map projections</h3>

<p>Two map projections are defined in terms of geodesics. They are based on polar and rectangular geodesic coordinates on the surface . The polar coordinate system (<em>r</em>, θ) is centered on some point <em>A</em>. The coordinates of another point <em>B</em> are given by <em>r</em> = <em>s</em><sub>12</sub> and θ = ½π − α<sub>1</sub> and these coordinates are used to find the projected coordinates on a plane map, <em>x</em> = <em>r</em> cosθ and <em>y</em> = <em>r</em> sinθ. The result is the familiar <a href="azimuthal_equidistant_projection" title="wikilink">azimuthal equidistant projection</a>; in the field of the <a href="differential_geometry_of_surfaces" title="wikilink">differential geometry of surfaces</a>, it is called the <a href="exponential_map_(Riemannian_geometry)" title="wikilink">exponential map</a>. Due to the basic properties of geodesics , lines of constant <em>r</em> and lines of constant θ intersect at right angles on the surface. The scale of the projection in the radial direction is unity, while the scale in the azimuthal direction is <em>s</em><sub>12</sub>/<em>m</em><sub>12</sub>.</p>

<p>The rectangular coordinate system (<em>x</em>, <em>y</em>) uses a reference geodesic defined by <em>A</em> and α<sub>1</sub> as the <em>x</em> axis. The point (<em>x</em>, <em>y</em>) is found by traveling a distance <em>s</em><sub>13</sub> = <em>x</em> from <em>A</em> along the reference geodesic to an intermediate point <em>C</em> and then turning ½π counter-clockwise and traveling along a geodesic a distance <em>s</em><sub>32</sub> = <em>y</em>. If <em>A</em> is on the equator and α<sub>1</sub> = ½π, this gives the <a href="equidistant_cylindrical_projection" title="wikilink">equidistant cylindrical projection</a>. If α<sub>1</sub> = 0, this gives the <a href="Cassini_projection" title="wikilink">Cassini-Soldner projection</a>. <a href="French_cartography#Cassini_maps" title="wikilink">Cassini's map of France</a> placed <em>A</em> at the <a href="Paris_Observatory" title="wikilink">Paris Observatory</a>. Due to the basic properties of geodesics , lines of constant <em>x</em> and lines of constant <em>y</em> intersect at right angles on the surface. The scale of the projection in the <em>y</em> direction is unity, while the scale in the <em>x</em> direction is 1/<em>M</em><sub>32</sub>.</p>

<p>The <a href="gnomonic_projection" title="wikilink">gnomonic projection</a> is a projection of the sphere where all geodesics (i.e., great circles) map to straight lines (making it a convenient <a href="Great-circle_navigation#Gnomonic_chart" title="wikilink">aid to navigation</a>). Such a projection is only possible for surfaces of constant <a href="Gaussian_curvature" title="wikilink">Gaussian curvature</a> . Thus a projection in which geodesics map to straight lines is not possible for an ellipsoid. However, it is possible to construct an ellipsoidal gnomonic projection in which this property <em>approximately</em> holds . On the sphere, the gnomonic projection is the limit of a doubly azimuthal projection, a projection preserving the azimuths from two points <em>A</em> and <em>B</em>, as <em>B</em> approaches <em>A</em>. Carrying out this limit in the case of a general surface yields an azimuthal projection in which the distance from the center of projection is given by ρ = <em>m</em><sub>12</sub>/<em>M</em><sub>12</sub>. Even though geodesics are only approximately straight in this projection, all geodesics through the center of projection <em>are</em> straight. The projection can then be used to give an iterative but rapidly converging method of solving some problems involving geodesics, in particular, finding the intersection of two geodesics and finding the shortest path from a point to a geodesic.</p>

<p>The <a href="Hammer_retroazimuthal_projection" title="wikilink">Hammer retroazimuthal projection</a> is a variation of the azimuthal equidistant projection . A geodesic is constructed from a central point <em>A</em> to some other point <em>B</em>. The polar coordinates of the projection of <em>B</em> are <em>r</em> = <em>s</em><sub>12</sub> and θ = ½π − α<sub>2</sub> (which depends on the azimuth at <em>B</em>, instead of at <em>A</em>). This can be used to determine the direction from an arbitrary point to some fixed center.  suggested another application: if the central point <em>A</em> is a beacon, such as the <a href="Rugby_Clock" title="wikilink">Rugby Clock</a>, then at an unknown location <em>B</em> the range and the bearing to <em>A</em> can be measured and the projection can be used to estimate the location of <em>B</em>.</p>
<h3 id="envelope-of-geodesics">Envelope of geodesics</h3>

<p>The geodesics from a particular point <em>A</em> if continued past the cut locus form an envelope illustrated in Fig. 19. Here the geodesics for which α<sub>1</sub> is a multiple of 3° are shown in light blue. (The geodesics are only shown for their first passage close to the antipodal point, not for subsequent ones.) Some geodesic circles are shown in green; these form cusps on the envelope. The cut locus is shown in red. The envelope is the locus of points which are conjugate to <em>A</em>; points on the envelope may be computed by finding the point at which <em>m</em><sub>12</sub> = 0 on a geodesic (and Newton's method can be used to find this point).  calls this star-like figure produced by the envelope an <a class="uri" href="astroid" title="wikilink">astroid</a>.</p>

<p>Outside the astroid two geodesics intersect at each point; thus there are two geodesics (with a length approximately half the circumference of the ellipsoid) between <em>A</em> and these points. This corresponds to the situation on the sphere where there are "short" and "long" routes on a great circle between two points. Inside the astroid four geodesics intersect at each point. Four such geodesics are shown in Fig. 20 where the geodesics are numbered in order of increasing length. (This figure uses the same position for <em>A</em> as Fig. 15 and is drawn in the same projection.) The two shorter geodesics are <em>stable</em>, i.e., <em>m</em><sub>12</sub> &gt; 0, so that there is no nearby path connecting the two points which is shorter; the other two are unstable. Only the shortest line (the first one) has σ<sub>12</sub> ≤ π. All the geodesics are tangent to the envelope which is shown in green in the figure. A similar set of geodesics for the WGS84 ellipsoid is given in this table :</p>
<table>
<tbody>
<tr class="odd">
<td style="text-align: left;">
<p>Geodesics for φ<sub>1</sub> = −30°, φ<sub>2</sub> = 29.9°, λ<sub>12</sub> = 179.8° (WGS84)</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>No.</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>1</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>2</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>3</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>4</p></td>
</tr>
</tbody>
</table>

<p>The approximate shape of the astroid is given by</p>

<p>

<math display="block" id="Geodesics_on_an_ellipsoid:35">
 <semantics>
  <mrow>
   <mrow>
    <msup>
     <mi>x</mi>
     <mrow>
      <mn>2</mn>
      <mo>/</mo>
      <mn>3</mn>
     </mrow>
    </msup>
    <mo>+</mo>
    <msup>
     <mi>y</mi>
     <mrow>
      <mn>2</mn>
      <mo>/</mo>
      <mn>3</mn>
     </mrow>
    </msup>
   </mrow>
   <mo>=</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <plus></plus>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>x</ci>
      <apply>
       <divide></divide>
       <cn type="integer">2</cn>
       <cn type="integer">3</cn>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>y</ci>
      <apply>
       <divide></divide>
       <cn type="integer">2</cn>
       <cn type="integer">3</cn>
      </apply>
     </apply>
    </apply>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x^{2/3}+y^{2/3}=1
  </annotation>
 </semantics>
</math>

 or, in parametric form,</p>

<p>

<math display="block" id="Geodesics_on_an_ellipsoid:36">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>x</mi>
     <mo>=</mo>
     <mrow>
      <msup>
       <mi>cos</mi>
       <mn>3</mn>
      </msup>
      <mi>θ</mi>
     </mrow>
    </mrow>
    <mo rspace="12.5pt">,</mo>
    <mrow>
     <mi>y</mi>
     <mo>=</mo>
     <mrow>
      <msup>
       <mi>sin</mi>
       <mn>3</mn>
      </msup>
      <mi>θ</mi>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <eq></eq>
     <ci>x</ci>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <cos></cos>
       <cn type="integer">3</cn>
      </apply>
      <ci>θ</ci>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <ci>y</ci>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <sin></sin>
       <cn type="integer">3</cn>
      </apply>
      <ci>θ</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x=\cos^{3}\theta,\quad y=\sin^{3}\theta.
  </annotation>
 </semantics>
</math>

 The astroid is also the envelope of the family of lines</p>

<p>

<math display="block" id="Geodesics_on_an_ellipsoid:37">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mfrac>
      <mi>x</mi>
      <mrow>
       <mi>cos</mi>
       <mi>γ</mi>
      </mrow>
     </mfrac>
     <mo>+</mo>
     <mfrac>
      <mi>y</mi>
      <mrow>
       <mi>sin</mi>
       <mi>γ</mi>
      </mrow>
     </mfrac>
    </mrow>
    <mo>=</mo>
    <mn>1</mn>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <plus></plus>
     <apply>
      <divide></divide>
      <ci>x</ci>
      <apply>
       <cos></cos>
       <ci>γ</ci>
      </apply>
     </apply>
     <apply>
      <divide></divide>
      <ci>y</ci>
      <apply>
       <sin></sin>
       <ci>γ</ci>
      </apply>
     </apply>
    </apply>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \frac{x}{\cos\gamma}+\frac{y}{\sin\gamma}=1,
  </annotation>
 </semantics>
</math>

 where γ is a parameter. (These are generated by the rod of the <a href="trammel_of_Archimedes" title="wikilink">trammel of Archimedes</a>.) This aids in finding a good starting guess for α<sub>1</sub> for Newton's method for in inverse problem in the case of nearly antipodal points .</p>

<p>The astroid is the (exterior) <a class="uri" href="evolute" title="wikilink">evolute</a> of the geodesic circles centered at <em>A</em>. Likewise, the geodesic circles are <a href="involute" title="wikilink">involutes</a> of the astroid.</p>
<h3 id="area-of-a-geodesic-polygon">Area of a geodesic polygon</h3>

<p>A <em>geodesic polygon</em> is a polygon whose sides are geodesics. The area of such a polygon may be found by first computing the area between a geodesic segment and the equator, i.e., the area of the quadrilateral <em>AFHB</em> in Fig. 1 . Once this area is known, the area of a polygon may be computed by summing the contributions from all the edges of the polygon.</p>

<p>Here we develop the formula for the area <em>S</em><sub>12</sub> of <em>AFHB</em> following . The area of any closed region of the ellipsoid is</p>

<p>

<math display="block" id="Geodesics_on_an_ellipsoid:38">
 <semantics>
  <mrow>
   <mrow>
    <mi>T</mi>
    <mo>=</mo>
    <mrow>
     <mo largeop="true" symmetric="true">∫</mo>
     <mrow>
      <mi>d</mi>
      <mi>T</mi>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mo largeop="true" symmetric="true">∫</mo>
     <mrow>
      <mfrac>
       <mn>1</mn>
       <mi>K</mi>
      </mfrac>
      <mrow>
       <mi>cos</mi>
       <mrow>
        <mpadded width="+1.7pt">
         <mi>ϕ</mi>
        </mpadded>
        <mi>d</mi>
        <mpadded width="+1.7pt">
         <mi>ϕ</mi>
        </mpadded>
        <mi>d</mi>
        <mi>λ</mi>
       </mrow>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <ci>T</ci>
     <apply>
      <int></int>
      <apply>
       <times></times>
       <ci>d</ci>
       <ci>T</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <int></int>
      <apply>
       <times></times>
       <apply>
        <divide></divide>
        <cn type="integer">1</cn>
        <ci>K</ci>
       </apply>
       <apply>
        <cos></cos>
        <apply>
         <times></times>
         <ci>ϕ</ci>
         <ci>d</ci>
         <ci>ϕ</ci>
         <ci>d</ci>
         <ci>λ</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   T=\int dT=\int\frac{1}{K}\cos\phi\,d\phi\,d\lambda,
  </annotation>
 </semantics>
</math>

 where <em>dT</em> is an element of surface area and <em>K</em> is the <a href="Gaussian_curvature" title="wikilink">Gaussian curvature</a>. Now the <a href="Gauss–Bonnet_theorem" title="wikilink">Gauss–Bonnet theorem</a> applied to a geodesic polygon states</p>

<p>

<math display="block" id="Geodesics_on_an_ellipsoid:39">
 <semantics>
  <mrow>
   <mrow>
    <mi mathvariant="normal">Γ</mi>
    <mo>=</mo>
    <mrow>
     <mo largeop="true" symmetric="true">∫</mo>
     <mrow>
      <mpadded width="+1.7pt">
       <mi>K</mi>
      </mpadded>
      <mi>d</mi>
      <mi>T</mi>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mo largeop="true" symmetric="true">∫</mo>
     <mrow>
      <mi>cos</mi>
      <mrow>
       <mpadded width="+1.7pt">
        <mi>ϕ</mi>
       </mpadded>
       <mi>d</mi>
       <mpadded width="+1.7pt">
        <mi>ϕ</mi>
       </mpadded>
       <mi>d</mi>
       <mi>λ</mi>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <ci>normal-Γ</ci>
     <apply>
      <int></int>
      <apply>
       <times></times>
       <ci>K</ci>
       <ci>d</ci>
       <ci>T</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <int></int>
      <apply>
       <cos></cos>
       <apply>
        <times></times>
        <ci>ϕ</ci>
        <ci>d</ci>
        <ci>ϕ</ci>
        <ci>d</ci>
        <ci>λ</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Gamma=\int K\,dT=\int\cos\phi\,d\phi\,d\lambda,
  </annotation>
 </semantics>
</math>

 where</p>

<p>

<math display="block" id="Geodesics_on_an_ellipsoid:40">
 <semantics>
  <mrow>
   <mi mathvariant="normal">Γ</mi>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mn>2</mn>
     <mi>π</mi>
    </mrow>
    <mo>-</mo>
    <mrow>
     <munder>
      <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
      <mi>j</mi>
     </munder>
     <msub>
      <mi>θ</mi>
      <mi>j</mi>
     </msub>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>normal-Γ</ci>
    <apply>
     <minus></minus>
     <apply>
      <times></times>
      <cn type="integer">2</cn>
      <ci>π</ci>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <ci>j</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>θ</ci>
       <ci>j</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Gamma=2\pi-\sum_{j}\theta_{j}
  </annotation>
 </semantics>
</math>

 is the geodesic excess and θ<sub><em>j</em></sub> is the exterior angle at vertex <em>j</em>. Multiplying the equation for Γ by <em>R</em><sub>2</sub><sup>2</sup>, where <em>R</em><sub>2</sub> is the <a href="Earth_radius#Authalic_radius" title="wikilink">authalic radius</a>, and subtracting this from the equation for <em>T</em> gives</p>

<p>

<math display="inline" id="Geodesics_on_an_ellipsoid:41">
 <semantics>
  <mi>T</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>T</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle T
  </annotation>
 </semantics>
</math>


 where the <a href="Spheroid#Curvature" title="wikilink">value of <em>K</em> for an ellipsoid</a> has been substituted. Applying this formula to the quadrilateral <em>AFHB</em>, noting that Γ = α<sub>2</sub> − α<sub>1</sub>, and performing the integral over φ gives</p>

<p>

<math display="block" id="Geodesics_on_an_ellipsoid:42">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>S</mi>
     <mn>12</mn>
    </msub>
    <mo>=</mo>
    <mrow>
     <mrow>
      <msubsup>
       <mi>R</mi>
       <mn>2</mn>
       <mn>2</mn>
      </msubsup>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <msub>
         <mi>α</mi>
         <mn>2</mn>
        </msub>
        <mo>-</mo>
        <msub>
         <mi>α</mi>
         <mn>1</mn>
        </msub>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo>+</mo>
     <mrow>
      <msup>
       <mi>b</mi>
       <mn>2</mn>
      </msup>
      <mrow>
       <msubsup>
        <mo largeop="true" symmetric="true">∫</mo>
        <msub>
         <mi>λ</mi>
         <mn>1</mn>
        </msub>
        <msub>
         <mi>λ</mi>
         <mn>2</mn>
        </msub>
       </msubsup>
       <mrow>
        <mrow>
         <mo maxsize="210%" minsize="210%">(</mo>
         <mrow>
          <mrow>
           <mfrac>
            <mn>1</mn>
            <mrow>
             <mn>2</mn>
             <mrow>
              <mo stretchy="false">(</mo>
              <mrow>
               <mn>1</mn>
               <mo>-</mo>
               <mrow>
                <msup>
                 <mi>e</mi>
                 <mn>2</mn>
                </msup>
                <mrow>
                 <msup>
                  <mi>sin</mi>
                  <mn>2</mn>
                 </msup>
                 <mi>ϕ</mi>
                </mrow>
               </mrow>
              </mrow>
              <mo stretchy="false">)</mo>
             </mrow>
            </mrow>
           </mfrac>
           <mo>+</mo>
           <mfrac>
            <mrow>
             <msup>
              <mi>tanh</mi>
              <mrow>
               <mo>-</mo>
               <mn>1</mn>
              </mrow>
             </msup>
             <mrow>
              <mo stretchy="false">(</mo>
              <mrow>
               <mi>e</mi>
               <mrow>
                <mi>sin</mi>
                <mi>ϕ</mi>
               </mrow>
              </mrow>
              <mo stretchy="false">)</mo>
             </mrow>
            </mrow>
            <mrow>
             <mn>2</mn>
             <mi>e</mi>
             <mrow>
              <mi>sin</mi>
              <mi>ϕ</mi>
             </mrow>
            </mrow>
           </mfrac>
          </mrow>
          <mo>-</mo>
          <mfrac>
           <msubsup>
            <mi>R</mi>
            <mn>2</mn>
            <mn>2</mn>
           </msubsup>
           <msup>
            <mi>b</mi>
            <mn>2</mn>
           </msup>
          </mfrac>
         </mrow>
         <mo maxsize="210%" minsize="210%">)</mo>
        </mrow>
        <mrow>
         <mi>sin</mi>
         <mrow>
          <mpadded width="+1.7pt">
           <mi>ϕ</mi>
          </mpadded>
          <mi>d</mi>
          <mi>λ</mi>
         </mrow>
        </mrow>
       </mrow>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>S</ci>
     <cn type="integer">12</cn>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>R</ci>
        <cn type="integer">2</cn>
       </apply>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <minus></minus>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>α</ci>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>α</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>b</ci>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <int></int>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>λ</ci>
          <cn type="integer">1</cn>
         </apply>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>λ</ci>
         <cn type="integer">2</cn>
        </apply>
       </apply>
       <apply>
        <times></times>
        <apply>
         <minus></minus>
         <apply>
          <plus></plus>
          <apply>
           <divide></divide>
           <cn type="integer">1</cn>
           <apply>
            <times></times>
            <cn type="integer">2</cn>
            <apply>
             <minus></minus>
             <cn type="integer">1</cn>
             <apply>
              <times></times>
              <apply>
               <csymbol cd="ambiguous">superscript</csymbol>
               <ci>e</ci>
               <cn type="integer">2</cn>
              </apply>
              <apply>
               <apply>
                <csymbol cd="ambiguous">superscript</csymbol>
                <sin></sin>
                <cn type="integer">2</cn>
               </apply>
               <ci>ϕ</ci>
              </apply>
             </apply>
            </apply>
           </apply>
          </apply>
          <apply>
           <divide></divide>
           <apply>
            <apply>
             <csymbol cd="ambiguous">superscript</csymbol>
             <tanh></tanh>
             <apply>
              <minus></minus>
              <cn type="integer">1</cn>
             </apply>
            </apply>
            <apply>
             <times></times>
             <ci>e</ci>
             <apply>
              <sin></sin>
              <ci>ϕ</ci>
             </apply>
            </apply>
           </apply>
           <apply>
            <times></times>
            <cn type="integer">2</cn>
            <ci>e</ci>
            <apply>
             <sin></sin>
             <ci>ϕ</ci>
            </apply>
           </apply>
          </apply>
         </apply>
         <apply>
          <divide></divide>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <ci>R</ci>
            <cn type="integer">2</cn>
           </apply>
           <cn type="integer">2</cn>
          </apply>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <ci>b</ci>
           <cn type="integer">2</cn>
          </apply>
         </apply>
        </apply>
        <apply>
         <sin></sin>
         <apply>
          <times></times>
          <ci>ϕ</ci>
          <ci>d</ci>
          <ci>λ</ci>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   S_{12}=R_{2}^{2}(\alpha_{2}-\alpha_{1})+b^{2}\int_{\lambda_{1}}^{\lambda_{2}}%
\biggl(\frac{1}{2(1-e^{2}\sin^{2}\phi)}+\frac{\tanh^{-1}(e\sin\phi)}{2e\sin%
\phi}-\frac{R_{2}^{2}}{b^{2}}\biggr)\sin\phi\,d\lambda,
  </annotation>
 </semantics>
</math>

 where the integral is over the geodesic line (so that φ is implicitly a function of λ). Converting this into an integral over σ, we obtain</p>

<p>

<math display="block" id="Geodesics_on_an_ellipsoid:43">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>S</mi>
     <mn>12</mn>
    </msub>
    <mo>=</mo>
    <mrow>
     <mrow>
      <msubsup>
       <mi>R</mi>
       <mn>2</mn>
       <mn>2</mn>
      </msubsup>
      <msub>
       <mi>E</mi>
       <mn>12</mn>
      </msub>
     </mrow>
     <mo>-</mo>
     <mrow>
      <msup>
       <mi>e</mi>
       <mn>2</mn>
      </msup>
      <msup>
       <mi>a</mi>
       <mn>2</mn>
      </msup>
      <mrow>
       <mi>cos</mi>
       <msub>
        <mi>α</mi>
        <mn>0</mn>
       </msub>
      </mrow>
      <mrow>
       <mi>sin</mi>
       <msub>
        <mi>α</mi>
        <mn>0</mn>
       </msub>
      </mrow>
      <mrow>
       <msubsup>
        <mo largeop="true" symmetric="true">∫</mo>
        <msub>
         <mi>σ</mi>
         <mn>1</mn>
        </msub>
        <msub>
         <mi>σ</mi>
         <mn>2</mn>
        </msub>
       </msubsup>
       <mrow>
        <mfrac>
         <mrow>
          <mrow>
           <mi>t</mi>
           <mrow>
            <mo stretchy="false">(</mo>
            <msup>
             <mi>e</mi>
             <mrow>
              <mi mathvariant="normal">′</mi>
              <mn>2</mn>
             </mrow>
            </msup>
            <mo stretchy="false">)</mo>
           </mrow>
          </mrow>
          <mo>-</mo>
          <mrow>
           <mi>t</mi>
           <mrow>
            <mo stretchy="false">(</mo>
            <mrow>
             <msup>
              <mi>k</mi>
              <mn>2</mn>
             </msup>
             <mrow>
              <msup>
               <mi>sin</mi>
               <mn>2</mn>
              </msup>
              <mi>σ</mi>
             </mrow>
            </mrow>
            <mo stretchy="false">)</mo>
           </mrow>
          </mrow>
         </mrow>
         <mrow>
          <msup>
           <mi>e</mi>
           <mrow>
            <mi mathvariant="normal">′</mi>
            <mn>2</mn>
           </mrow>
          </msup>
          <mo>-</mo>
          <mrow>
           <msup>
            <mi>k</mi>
            <mn>2</mn>
           </msup>
           <mrow>
            <msup>
             <mi>sin</mi>
             <mn>2</mn>
            </msup>
            <mi>σ</mi>
           </mrow>
          </mrow>
         </mrow>
        </mfrac>
        <mpadded width="+1.7pt">
         <mfrac>
          <mrow>
           <mi>sin</mi>
           <mi>σ</mi>
          </mrow>
          <mn>2</mn>
         </mfrac>
        </mpadded>
        <mi>d</mi>
        <mi>σ</mi>
       </mrow>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>S</ci>
     <cn type="integer">12</cn>
    </apply>
    <apply>
     <minus></minus>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>R</ci>
        <cn type="integer">2</cn>
       </apply>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>E</ci>
       <cn type="integer">12</cn>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>e</ci>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>a</ci>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <cos></cos>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>α</ci>
        <cn type="integer">0</cn>
       </apply>
      </apply>
      <apply>
       <sin></sin>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>α</ci>
        <cn type="integer">0</cn>
       </apply>
      </apply>
      <apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <int></int>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>σ</ci>
          <cn type="integer">1</cn>
         </apply>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>σ</ci>
         <cn type="integer">2</cn>
        </apply>
       </apply>
       <apply>
        <times></times>
        <apply>
         <divide></divide>
         <apply>
          <minus></minus>
          <apply>
           <times></times>
           <ci>t</ci>
           <apply>
            <csymbol cd="ambiguous">superscript</csymbol>
            <ci>e</ci>
            <list>
             <ci>normal-′</ci>
             <cn type="integer">2</cn>
            </list>
           </apply>
          </apply>
          <apply>
           <times></times>
           <ci>t</ci>
           <apply>
            <times></times>
            <apply>
             <csymbol cd="ambiguous">superscript</csymbol>
             <ci>k</ci>
             <cn type="integer">2</cn>
            </apply>
            <apply>
             <apply>
              <csymbol cd="ambiguous">superscript</csymbol>
              <sin></sin>
              <cn type="integer">2</cn>
             </apply>
             <ci>σ</ci>
            </apply>
           </apply>
          </apply>
         </apply>
         <apply>
          <minus></minus>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <ci>e</ci>
           <list>
            <ci>normal-′</ci>
            <cn type="integer">2</cn>
           </list>
          </apply>
          <apply>
           <times></times>
           <apply>
            <csymbol cd="ambiguous">superscript</csymbol>
            <ci>k</ci>
            <cn type="integer">2</cn>
           </apply>
           <apply>
            <apply>
             <csymbol cd="ambiguous">superscript</csymbol>
             <sin></sin>
             <cn type="integer">2</cn>
            </apply>
            <ci>σ</ci>
           </apply>
          </apply>
         </apply>
        </apply>
        <apply>
         <divide></divide>
         <apply>
          <sin></sin>
          <ci>σ</ci>
         </apply>
         <cn type="integer">2</cn>
        </apply>
        <ci>d</ci>
        <ci>σ</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   S_{12}=R_{2}^{2}E_{12}-e^{2}a^{2}\cos\alpha_{0}\sin\alpha_{0}\int_{\sigma_{1}}%
^{\sigma_{2}}\frac{t(e^{\prime 2})-t(k^{2}\sin^{2}\sigma)}{e^{\prime 2}-k^{2}%
\sin^{2}\sigma}\frac{\sin\sigma}{2}\,d\sigma,
  </annotation>
 </semantics>
</math>

 where</p>

<p>

<math display="block" id="Geodesics_on_an_ellipsoid:44">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>t</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>x</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mn>1</mn>
     <mo>+</mo>
     <mi>x</mi>
     <mo>+</mo>
     <mrow>
      <msqrt>
       <mrow>
        <mn>1</mn>
        <mo>+</mo>
        <mi>x</mi>
       </mrow>
      </msqrt>
      <mfrac>
       <mrow>
        <mpadded width="-1.7pt">
         <msup>
          <mi>sinh</mi>
          <mrow>
           <mo>-</mo>
           <mn>1</mn>
          </mrow>
         </msup>
        </mpadded>
        <msqrt>
         <mi>x</mi>
        </msqrt>
       </mrow>
       <msqrt>
        <mi>x</mi>
       </msqrt>
      </mfrac>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>t</ci>
     <ci>x</ci>
    </apply>
    <apply>
     <plus></plus>
     <cn type="integer">1</cn>
     <ci>x</ci>
     <apply>
      <times></times>
      <apply>
       <root></root>
       <apply>
        <plus></plus>
        <cn type="integer">1</cn>
        <ci>x</ci>
       </apply>
      </apply>
      <apply>
       <divide></divide>
       <apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <sinh></sinh>
         <apply>
          <minus></minus>
          <cn type="integer">1</cn>
         </apply>
        </apply>
        <apply>
         <root></root>
         <ci>x</ci>
        </apply>
       </apply>
       <apply>
        <root></root>
        <ci>x</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   t(x)=1+x+\sqrt{1+x}\frac{\sinh^{-1}\!\sqrt{x}}{\sqrt{x}},
  </annotation>
 </semantics>
</math>

 and the notation <em>E</em><sub>12</sub> = α<sub>2</sub> − α<sub>1</sub> is used for the geodesic excess. The integral can be expressed as a series valid for small <em>f</em>  .</p>

<p>The area of a geodesic polygon is given by summing <em>S</em><sub>12</sub> over its edges. This result holds provided that the polygon does not include a pole; if it does 2π <em>R</em><sub>2</sub><sup>2</sup> must be added to the sum. If the edges are specified by their vertices, then a <a href="Spherical_excess" title="wikilink">convenient expression</a> for <em>E</em><sub>12</sub> is</p>

<p>

<math display="block" id="Geodesics_on_an_ellipsoid:45">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>tan</mi>
     <mfrac>
      <msub>
       <mi>E</mi>
       <mn>12</mn>
      </msub>
      <mn>2</mn>
     </mfrac>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mfrac>
      <mrow>
       <mrow>
        <mi>sin</mi>
        <mfrac>
         <mn>1</mn>
         <mn>2</mn>
        </mfrac>
       </mrow>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <msub>
          <mi>β</mi>
          <mn>2</mn>
         </msub>
         <mo>+</mo>
         <msub>
          <mi>β</mi>
          <mn>1</mn>
         </msub>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
      <mrow>
       <mrow>
        <mi>cos</mi>
        <mfrac>
         <mn>1</mn>
         <mn>2</mn>
        </mfrac>
       </mrow>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <msub>
          <mi>β</mi>
          <mn>2</mn>
         </msub>
         <mo>-</mo>
         <msub>
          <mi>β</mi>
          <mn>1</mn>
         </msub>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
     </mfrac>
     <mrow>
      <mi>tan</mi>
      <mfrac>
       <msub>
        <mi>ω</mi>
        <mn>12</mn>
       </msub>
       <mn>2</mn>
      </mfrac>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <tan></tan>
     <apply>
      <divide></divide>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>E</ci>
       <cn type="integer">12</cn>
      </apply>
      <cn type="integer">2</cn>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <divide></divide>
      <apply>
       <times></times>
       <apply>
        <sin></sin>
        <apply>
         <divide></divide>
         <cn type="integer">1</cn>
         <cn type="integer">2</cn>
        </apply>
       </apply>
       <apply>
        <plus></plus>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>β</ci>
         <cn type="integer">2</cn>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>β</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
      </apply>
      <apply>
       <times></times>
       <apply>
        <cos></cos>
        <apply>
         <divide></divide>
         <cn type="integer">1</cn>
         <cn type="integer">2</cn>
        </apply>
       </apply>
       <apply>
        <minus></minus>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>β</ci>
         <cn type="integer">2</cn>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>β</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <tan></tan>
      <apply>
       <divide></divide>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>ω</ci>
        <cn type="integer">12</cn>
       </apply>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \tan\frac{E_{12}}{2}=\frac{\sin\tfrac{1}{2}(\beta_{2}+\beta_{1})}{\cos\tfrac{1%
}{2}(\beta_{2}-\beta_{1})}\tan\frac{\omega_{12}}{2}.
  </annotation>
 </semantics>
</math>

 This result follows from one of <a href="Napier's_analogies" title="wikilink">Napier's analogies</a>.</p>
<h3 id="software-implementations">Software implementations</h3>

<p>An implementation of Vincenty's algorithm in <a class="uri" href="Fortran" title="wikilink">Fortran</a> is provided by . Version 3.0 includes Vincenty's treatment of nearly antipodal points . <a href="Vincenty's_formulae" title="wikilink">Vincenty's original formulas</a> are used in many geographic information systems. Except for nearly antipodal points (where the inverse method fails to converge), this method is accurate to about 0.1 mm for the WGS84 ellipsoid .</p>

<p>The algorithms given in  are included in GeographicLib . These are accurate to about 15 nanometers for the WGS84 ellipsoid. Implementations in several languages (<a class="uri" href="C++" title="wikilink">C++</a>, <a href="C_(programming_language)" title="wikilink">C</a>, Fortran, <a href="Java_(programming_language)" title="wikilink">Java</a>, <a class="uri" href="JavaScript" title="wikilink">JavaScript</a>, <a href="Python_(programming_language)" title="wikilink">Python</a>, <a class="uri" href="Matlab" title="wikilink">Matlab</a>, and <a href="Maxima_(software)" title="wikilink">Maxima</a>) are provided. In addition to solving the basic geodesic problem, this library can return <em>m</em><sub>12</sub>, <em>M</em><sub>12</sub>, <em>M</em><sub>21</sub>, and <em>S</em><sub>12</sub>. The library includes a <a href="command-line_utility" title="wikilink">command-line utility</a>, <code>GeodSolve</code>, for geodesic calculations. As of version 4.9.1, the <a class="uri" href="PROJ.4" title="wikilink">PROJ.4</a> library for cartographic projections uses the C implementation for geodesic calculations. This is exposed in the command-line utility, <code>geod</code>, and in the library itself.</p>

<p>The solution of the geodesic problems in terms of elliptic integrals is included in GeographicLib (in C++ only), e.g., via the <code>-E</code> option to <code>GeodSolve</code>. This method of solution is about 2–3 times slower than using series expansions; however it provides accurate solutions for ellipsoids of revolution with <em>b</em>/<em>a</em> ∈ [0.01, 100] .</p>
<h2 id="geodesics-on-a-triaxial-ellipsoid">Geodesics on a triaxial ellipsoid</h2>

<p>Solving the geodesic problem for an ellipsoid of revolution is, from the mathematical point of view, relatively simple: because of symmetry, geodesics have a constant of the motion, given by Clairaut's relation allowing the problem to be reduced to <a href="Quadrature_(mathematics)" title="wikilink">quadrature</a>. By the early 19th century (with the work of Legendre, <a href="Barnaba_Oriani" title="wikilink">Oriani</a>, Bessel, et al.), there was a complete understanding of the properties of geodesics on an ellipsoid of revolution.</p>

<p>On the other hand, geodesics on a <a href="triaxial_ellipsoid" title="wikilink">triaxial ellipsoid</a> (with 3 unequal axes) have no obvious constant of the motion and thus represented a challenging "unsolved" problem in the first half of the 19th century. In a remarkable paper,  discovered a constant of the motion allowing this problem to be reduced to quadrature also .</p>
<h3 id="triaxial-coordinate-systems">Triaxial coordinate systems</h3>

<p>  The key to the solution is expressing the problem in the "right" coordinate system. Consider the ellipsoid defined by</p>

<p>

<math display="block" id="Geodesics_on_an_ellipsoid:46">
 <semantics>
  <mrow>
   <mrow>
    <mi>h</mi>
    <mo>=</mo>
    <mrow>
     <mfrac>
      <msup>
       <mi>X</mi>
       <mn>2</mn>
      </msup>
      <msup>
       <mi>a</mi>
       <mn>2</mn>
      </msup>
     </mfrac>
     <mo>+</mo>
     <mfrac>
      <msup>
       <mi>Y</mi>
       <mn>2</mn>
      </msup>
      <msup>
       <mi>b</mi>
       <mn>2</mn>
      </msup>
     </mfrac>
     <mo>+</mo>
     <mfrac>
      <msup>
       <mi>Z</mi>
       <mn>2</mn>
      </msup>
      <msup>
       <mi>c</mi>
       <mn>2</mn>
      </msup>
     </mfrac>
    </mrow>
    <mo>=</mo>
    <mn>1</mn>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <ci>h</ci>
     <apply>
      <plus></plus>
      <apply>
       <divide></divide>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>X</ci>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>a</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
      <apply>
       <divide></divide>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>Y</ci>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>b</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
      <apply>
       <divide></divide>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>Z</ci>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>c</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <cn type="integer">1</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   h=\frac{X^{2}}{a^{2}}+\frac{Y^{2}}{b^{2}}+\frac{Z^{2}}{c^{2}}=1,
  </annotation>
 </semantics>
</math>

 where (<em>X</em>,<em>Y</em>,<em>Z</em>) are Cartesian coordinates centered on the ellipsoid and, without loss of generality, <em>a</em> ≥ <em>b</em> ≥ <em>c</em> &gt; 0. A point on the surface is specified by a latitude and longitude. The <em>geographical</em> latitude and longitude (φ, λ) are defined by</p>

<p>

<math display="block" id="Geodesics_on_an_ellipsoid:47">
 <semantics>
  <mrow>
   <mrow>
    <mfrac>
     <mrow>
      <mo>∇</mo>
      <mi>h</mi>
     </mrow>
     <mrow>
      <mo>|</mo>
      <mrow>
       <mo>∇</mo>
       <mi>h</mi>
      </mrow>
      <mo>|</mo>
     </mrow>
    </mfrac>
    <mo>=</mo>
    <mrow>
     <mo>(</mo>
     <mtable displaystyle="true">
      <mtr>
       <mtd columnalign="center">
        <mrow>
         <mrow>
          <mi>cos</mi>
          <mi>ϕ</mi>
         </mrow>
         <mrow>
          <mi>cos</mi>
          <mi>λ</mi>
         </mrow>
        </mrow>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mrow>
         <mrow>
          <mi>cos</mi>
          <mi>ϕ</mi>
         </mrow>
         <mrow>
          <mi>sin</mi>
          <mi>λ</mi>
         </mrow>
        </mrow>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mrow>
         <mi>sin</mi>
         <mi>ϕ</mi>
        </mrow>
       </mtd>
      </mtr>
     </mtable>
     <mo>)</mo>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <divide></divide>
     <apply>
      <ci>normal-∇</ci>
      <ci>h</ci>
     </apply>
     <apply>
      <abs></abs>
      <apply>
       <ci>normal-∇</ci>
       <ci>h</ci>
      </apply>
     </apply>
    </apply>
    <matrix>
     <matrixrow>
      <apply>
       <times></times>
       <apply>
        <cos></cos>
        <ci>ϕ</ci>
       </apply>
       <apply>
        <cos></cos>
        <ci>λ</ci>
       </apply>
      </apply>
     </matrixrow>
     <matrixrow>
      <apply>
       <times></times>
       <apply>
        <cos></cos>
        <ci>ϕ</ci>
       </apply>
       <apply>
        <sin></sin>
        <ci>λ</ci>
       </apply>
      </apply>
     </matrixrow>
     <matrixrow>
      <apply>
       <sin></sin>
       <ci>ϕ</ci>
      </apply>
     </matrixrow>
    </matrix>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \frac{\nabla h}{\left|\nabla h\right|}=\left(\begin{array}[]{c}\cos\phi\cos%
\lambda\\
\cos\phi\sin\lambda\\
\sin\phi\end{array}\right).
  </annotation>
 </semantics>
</math>

 The <em>parametric</em> latitude and longitude (φ′, λ′) are defined by</p>

<p>

<math display="inline" id="Geodesics_on_an_ellipsoid:48">
 <semantics>
  <mi>X</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>X</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle X
  </annotation>
 </semantics>
</math>


  employed the <em>ellipsoidal</em> latitude and longitude (β, ω) defined by </p>

<p>

<math display="inline" id="Geodesics_on_an_ellipsoid:49">
 <semantics>
  <mi>X</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>X</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle X
  </annotation>
 </semantics>
</math>


 In the limit <em>b</em> → <em>a</em>, β becomes the parametric latitude for an oblate ellipsoid, so the use of the symbol β is consistent with the previous sections. However, ω is <em>different</em> from the spherical longitude defined above.</p>

<p>Grid lines of constant β (in blue) and ω (in green) are given in Fig. 21. In contrast to (φ, λ) and (φ′, λ′), (β, ω) is an <a class="uri" href="orthogonal" title="wikilink">orthogonal</a> coordinate system: the grid lines intersect at right angles. The principal sections of the ellipsoid, defined by <em>X</em> = 0 and <em>Z</em> = 0 are shown in red. The third principal section, <em>Y</em> = 0, is covered by the lines β = ±90° and ω = 0° or ±180°. These lines meet at four <a href="umbilical_point" title="wikilink">umbilical points</a> (two of which are visible in this figure) where the <a href="principal_curvature" title="wikilink">principal radii of curvature</a> are equal. Here and in the other figures in this section the parameters of the ellipsoid are <em>a</em>:<em>b</em>:<em>c</em> = 1.01:1:0.8, and it is viewed in an orthographic projection from a point above φ = 40°, λ = 30°.</p>

<p>The grid lines of the ellipsoidal coordinates may be interpreted in three different ways</p>
<ol>
<li>They are "lines of curvature" on the ellipsoid, i.e., they are parallel to the directions of principal curvature .</li>
<li>They are also intersections of the ellipsoid with <a href="confocal_ellipsoidal_coordinates" title="wikilink">confocal systems of hyperboloids of one and two sheets</a> .</li>
<li>Finally they are geodesic ellipses and hyperbolas defined using two adjacent umbilical points . For example, the lines of constant β in Fig. 21 can be generated with the familiar <a href="Gardener's_ellipse" title="wikilink">string construction for ellipses</a> with the ends of the string pinned to the two umbilical points.</li>
</ol>

<p>Conversions between these three types of latitudes and longitudes and the Cartesian coordinates are simple algebraic exercises.</p>

<p>The element of length on the ellipsoid in ellipsoidal coordinates is given by</p>

<p>

<math display="inline" id="Geodesics_on_an_ellipsoid:50">
 <semantics>
  <mstyle displaystyle="true">
   <mfrac>
    <mrow>
     <mi>d</mi>
     <msup>
      <mi>s</mi>
      <mn>2</mn>
     </msup>
    </mrow>
    <mrow>
     <mrow>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <msup>
         <mi>a</mi>
         <mn>2</mn>
        </msup>
        <mo>-</mo>
        <msup>
         <mi>b</mi>
         <mn>2</mn>
        </msup>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
      <mrow>
       <msup>
        <mi>sin</mi>
        <mn>2</mn>
       </msup>
       <mi>ω</mi>
      </mrow>
     </mrow>
     <mo>+</mo>
     <mrow>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <msup>
         <mi>b</mi>
         <mn>2</mn>
        </msup>
        <mo>-</mo>
        <msup>
         <mi>c</mi>
         <mn>2</mn>
        </msup>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
      <mrow>
       <msup>
        <mi>cos</mi>
        <mn>2</mn>
       </msup>
       <mi>β</mi>
      </mrow>
     </mrow>
    </mrow>
   </mfrac>
  </mstyle>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <divide></divide>
    <apply>
     <times></times>
     <ci>d</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>s</ci>
      <cn type="integer">2</cn>
     </apply>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <apply>
       <minus></minus>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>a</ci>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>b</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
      <apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <sin></sin>
        <cn type="integer">2</cn>
       </apply>
       <ci>ω</ci>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <minus></minus>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>b</ci>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>c</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
      <apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <cos></cos>
        <cn type="integer">2</cn>
       </apply>
       <ci>β</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle\frac{ds^{2}}{(a^{2}-b^{2})\sin^{2}\omega+(b^{2}-c^{2})\cos^{2}\beta}
  </annotation>
 </semantics>
</math>


 and the differential equations for a geodesic are</p>

<p>

<math display="inline" id="Geodesics_on_an_ellipsoid:51">
 <semantics>
  <mstyle displaystyle="true">
   <mfrac>
    <mrow>
     <mi>d</mi>
     <mi>β</mi>
    </mrow>
    <mrow>
     <mi>d</mi>
     <mi>s</mi>
    </mrow>
   </mfrac>
  </mstyle>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <divide></divide>
    <apply>
     <times></times>
     <ci>d</ci>
     <ci>β</ci>
    </apply>
    <apply>
     <times></times>
     <ci>d</ci>
     <ci>s</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle\frac{d\beta}{ds}
  </annotation>
 </semantics>
</math>


</p>
<h3 id="jacobis-solution">Jacobi's solution</h3>

<p>   Jacobi showed that the geodesic equations, expressed in ellipsoidal coordinates, are separable. Here is how he recounted his discovery to his friend and neighbor Bessel ,</p>
<blockquote>

<p>The day before yesterday, I reduced to quadrature the problem of geodesic lines on an <em>ellipsoid with three unequal axes</em>. They are the simplest formulas in the world, <a href="Abelian_integral" title="wikilink">Abelian integrals</a>, which become the well known elliptic integrals if 2 axes are set equal.<br/>
<a class="uri" href="Königsberg" title="wikilink">Königsberg</a>, 28th Dec. '38. </p>
</blockquote>

<p>The solution given by Jacobi   is</p>

<p>

<math display="inline" id="Geodesics_on_an_ellipsoid:52">
 <semantics>
  <mi>δ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>δ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle\delta
  </annotation>
 </semantics>
</math>


 As Jacobi notes "a function of the angle β equals a function of the angle ω. These two functions are just Abelian integrals..." Two constants δ and γ appear in the solution. Typically δ is zero if the lower limits of the integrals are taken to be the starting point of the geodesic and the direction of the geodesics is determined by γ. However, for geodesics that start at an umbilical points, we have γ = 0 and δ determines the direction at the umbilical point. The constant γ may be expressed as</p>

<p>

<math display="block" id="Geodesics_on_an_ellipsoid:53">
 <semantics>
  <mrow>
   <mrow>
    <mi>γ</mi>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <msup>
         <mi>b</mi>
         <mn>2</mn>
        </msup>
        <mo>-</mo>
        <msup>
         <mi>c</mi>
         <mn>2</mn>
        </msup>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
      <mrow>
       <msup>
        <mi>cos</mi>
        <mn>2</mn>
       </msup>
       <mi>β</mi>
      </mrow>
      <mrow>
       <msup>
        <mi>sin</mi>
        <mn>2</mn>
       </msup>
       <mi>α</mi>
      </mrow>
     </mrow>
     <mo>-</mo>
     <mrow>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <msup>
         <mi>a</mi>
         <mn>2</mn>
        </msup>
        <mo>-</mo>
        <msup>
         <mi>b</mi>
         <mn>2</mn>
        </msup>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
      <mrow>
       <msup>
        <mi>sin</mi>
        <mn>2</mn>
       </msup>
       <mi>ω</mi>
      </mrow>
      <mrow>
       <msup>
        <mi>cos</mi>
        <mn>2</mn>
       </msup>
       <mi>α</mi>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>γ</ci>
    <apply>
     <minus></minus>
     <apply>
      <times></times>
      <apply>
       <minus></minus>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>b</ci>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>c</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
      <apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <cos></cos>
        <cn type="integer">2</cn>
       </apply>
       <ci>β</ci>
      </apply>
      <apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <sin></sin>
        <cn type="integer">2</cn>
       </apply>
       <ci>α</ci>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <minus></minus>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>a</ci>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>b</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
      <apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <sin></sin>
        <cn type="integer">2</cn>
       </apply>
       <ci>ω</ci>
      </apply>
      <apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <cos></cos>
        <cn type="integer">2</cn>
       </apply>
       <ci>α</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \gamma=(b^{2}-c^{2})\cos^{2}\beta\sin^{2}\alpha-(a^{2}-b^{2})\sin^{2}\omega%
\cos^{2}\alpha,
  </annotation>
 </semantics>
</math>

 where α is the angle the geodesic makes with lines of constant ω. In the limit <em>b</em> → <em>a</em>, this reduces to sinα cosβ = const., the familiar Clairaut relation. A nice derivation of Jacobi's result is given by  where he gives the solution found by  for general quadratic surfaces. In this formulation, the distance along the geodesic, <em>s</em>, is found using</p>

<p>

<math display="inline" id="Geodesics_on_an_ellipsoid:54">
 <semantics>
  <mstyle displaystyle="true">
   <mfrac>
    <mrow>
     <mi>d</mi>
     <mi>s</mi>
    </mrow>
    <mrow>
     <mrow>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <msup>
         <mi>a</mi>
         <mn>2</mn>
        </msup>
        <mo>-</mo>
        <msup>
         <mi>b</mi>
         <mn>2</mn>
        </msup>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
      <mrow>
       <msup>
        <mi>sin</mi>
        <mn>2</mn>
       </msup>
       <mi>ω</mi>
      </mrow>
     </mrow>
     <mo>+</mo>
     <mrow>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <msup>
         <mi>b</mi>
         <mn>2</mn>
        </msup>
        <mo>-</mo>
        <msup>
         <mi>c</mi>
         <mn>2</mn>
        </msup>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
      <mrow>
       <msup>
        <mi>cos</mi>
        <mn>2</mn>
       </msup>
       <mi>β</mi>
      </mrow>
     </mrow>
    </mrow>
   </mfrac>
  </mstyle>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <divide></divide>
    <apply>
     <times></times>
     <ci>d</ci>
     <ci>s</ci>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <apply>
       <minus></minus>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>a</ci>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>b</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
      <apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <sin></sin>
        <cn type="integer">2</cn>
       </apply>
       <ci>ω</ci>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <minus></minus>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>b</ci>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>c</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
      <apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <cos></cos>
        <cn type="integer">2</cn>
       </apply>
       <ci>β</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle\frac{ds}{(a^{2}-b^{2})\sin^{2}\omega+(b^{2}-c^{2})\cos^{2}\beta}
  </annotation>
 </semantics>
</math>


 An alternative expression for the distance is</p>

<p>

<math display="inline" id="Geodesics_on_an_ellipsoid:55">
 <semantics>
  <mrow>
   <mi>d</mi>
   <mi>s</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>d</ci>
    <ci>s</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle ds
  </annotation>
 </semantics>
</math>


</p>
<h3 id="survey-of-triaxial-geodesics">Survey of triaxial geodesics</h3>

<p>On a triaxial ellipsoid, there are only 3 simple closed geodesics, the three principal sections of the ellipsoid given by <em>X</em> = 0, <em>Y</em> = 0, and <em>Z</em> = 0. To survey the other geodesics, it is convenient to consider geodesics which intersect the middle principal section, <em>Y</em> = 0, at right angles. Such geodesics are shown in Figs. 22–26, which use the same ellipsoid parameters and the same viewing direction as Fig. 21. In addition, the three principal ellipses are shown in red in each of these figures.</p>

<p>If the starting point is β<sub>1</sub> ∈ (−90°, 90°), ω<sub>1</sub> = 0, and α<sub>1</sub> = 90°, then γ &gt; 0 and the geodesic encircles the ellipsoid in a "circumpolar" sense. The geodesic oscillates north and south of the equator; on each oscillation it completes slightly less that a full circuit around the ellipsoid resulting, in the typical case, in the geodesic filling the area bounded by the two latitude lines β = ±β<sub>1</sub>. Two examples are given in Figs. 22 and 23. Figure 22 shows practically the same behavior as for an oblate ellipsoid of revolution (because <em>a</em> ≈ <em>b</em>); compare to Fig. 11. However, if the starting point is at a higher latitude (Fig. 22) the distortions resulting from <em>a</em> ≠ <em>b</em> are evident. All tangents to a circumpolar geodesic touch the confocal single-sheeted hyperboloid which intersects the ellipsoid at β = β<sub>1</sub>  .</p>

<p>If the starting point is β<sub>1</sub> = 90°, ω<sub>1</sub> ∈ (0°, 180°), and α<sub>1</sub> = 180°, then γ 1 and ω = 180° − ω<sub>1</sub>. If <em>a</em> = <em>b</em>, all meridians are geodesics; the effect of <em>a</em> ≠ <em>b</em> causes such geodesics to oscillate east and west. Two examples are given in Figs. 24 and 25. The constriction of the geodesic near the pole disappears in the limit <em>b</em> → <em>c</em>; in this case, the ellipsoid becomes a prolate ellipsoid and Fig. 24 would resemble Fig. 12 (rotated on its side). All tangents to a transpolar geodesic touch the confocal double-sheeted hyperboloid which intersects the ellipsoid at ω = ω<sub>1</sub>.</p>

<p> If the starting point is β<sub>1</sub> = 90°, ω<sub>1</sub> = 0° (an umbilical point), and α<sub>1</sub> = 135° (the geodesic leaves the ellipse <em>Y</em> = 0 at right angles), then γ = 0 and the geodesic repeatedly intersects the opposite umbilical point and returns to its starting point. However, on each circuit the angle at which it intersects <em>Y</em> = 0 becomes closer to 0° or 180° so that asymptotically the geodesic lies on the ellipse <em>Y</em> = 0  . This is shown in Fig. 26. Note that a single geodesic does not fill an area on the ellipsoid. All tangents to umbilical geodesics touch the confocal hyperbola which intersects the ellipsoid at the umbilic points.</p>

<p>Umbilical geodesic enjoy several interesting properties.</p>
<ul>
<li>Through any point on the ellipsoid, there are two umbilical geodesics.</li>
<li>The geodesic distance between opposite umbilical points is the same regardless of the initial direction of the geodesic.</li>
<li>Whereas the closed geodesics on the ellipses <em>X</em> = 0 and <em>Z</em> = 0 are stable (an geodesic initially close to and nearly parallel to the ellipse remains close to the ellipse), the closed geodesic on the ellipse <em>Y</em> = 0, which goes through all 4 umbilical points, is <em>exponentially unstable</em>. If it is perturbed, it will swing out of the plane <em>Y</em> = 0 and flip around before returning to close to the plane. (This behavior may repeat depending on the nature of the initial perturbation.)</li>
</ul>

<p>If the starting point <em>A</em> of a geodesic is not an umbilical point, then its envelope is an astroid with two cusps lying on β = −β<sub>1</sub> and the other two on ω = ω<sub>1</sub> + π . The cut locus for <em>A</em> is the portion of the line β = −β<sub>1</sub> between the cusps .</p>

<p>gives a method for solving the inverse problem for a triaxial ellipsoid by directly integrating the system of ordinary differential equations for a geodesic. (Thus, it does not utilize Jacobi's solution.)</p>
<h2 id="applications">Applications</h2>

<p>  The direct and inverse geodesic problems no longer play the central role in geodesy that they once did. Instead of solving <a href="adjustment_of_observations" title="wikilink">adjustment</a> of <a href="geodetic_networks" title="wikilink">geodetic networks</a> as a two-dimensional problem in spheroidal trigonometry, these problem are now solved by three-dimensional methods . Nevertheless, terrestrial geodesics still play an important role in several areas:</p>
<ul>
<li>for measuring distances and areas in <a href="geographic_information_systems" title="wikilink">geographic information systems</a>;</li>
<li>the definition of <a href="maritime_boundaries" title="wikilink">maritime boundaries</a> ;</li>
<li>in the rules of the <a href="Federal_Aviation_Administration" title="wikilink">Federal Aviation Administration</a> for area navigation ;</li>
<li>the method of measuring distances in the <a href="Fédération_Aéronautique_Internationale" title="wikilink">FAI</a> Sporting Code .</li>
</ul>

<p>By the <a href="principle_of_least_action" title="wikilink">principle of least action</a>, many problems in physics can be formulated as a variational problem similar to that for geodesics. Indeed, the geodesic problem is equivalent to the motion of a particle constrained to move on the surface, but otherwise subject to no forces  . For this reason, geodesics on simple surfaces such as ellipsoids of revolution or triaxial ellipsoids are frequently used as "test cases" for exploring new methods. Examples include:</p>
<ul>
<li>the development of elliptic integrals  and <a href="elliptic_functions" title="wikilink">elliptic functions</a> ;</li>
<li>the development of differential geometry  ;</li>
<li>methods for solving systems of differential equations by a change of independent variables ;</li>
<li>the study of <a href="caustic_(optics)" title="wikilink">caustics</a> ;</li>
<li>investigations into the number and stability of periodic orbits ;</li>
<li>in the limit <em>c</em> → 0, geodesics on a triaxial ellipsoid reduce to a case of <a href="dynamical_billiards" title="wikilink">dynamical billiards</a>;</li>
<li>extensions to an arbitrary number of dimensions ;</li>
<li>geodesic flow on a surface .</li>
</ul>
<h2 id="see-also">See also</h2>
<ul>
<li><a href="Geographical_distance" title="wikilink">Geographical distance</a></li>
<li><a href="Great-circle_navigation" title="wikilink">Great-circle navigation</a></li>
<li><a class="uri" href="Geodesics" title="wikilink">Geodesics</a></li>
<li><a class="uri" href="Geodesy" title="wikilink">Geodesy</a></li>
<li><a href="Meridian_arc" title="wikilink">Meridian arc</a></li>
<li><a href="Rhumb_line" title="wikilink">Rhumb line</a></li>
<li><a href="Vincenty's_formulae" title="wikilink">Vincenty's formulae</a></li>
</ul>
<h2 id="notes">Notes</h2>
<h2 id="references">References</h2>
<ul>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
</ul>
<h2 id="external-links">External links</h2>
<ul>
<li><a href="http://geographiclib.sourceforge.net/geodesic-papers/biblio.html">Online geodesic bibliography</a>, approximately 180 books and articles on geodesics on ellipsoids together with links to online copies.</li>
<li>Implementations of  for oblate ellipsoids:
<ul>
<li><a href="http://www.ngs.noaa.gov/PC_PROD/Inv_Fwd/">NGS implementation</a>, includes modifications described in .</li>
<li><a href="http://www.ngs.noaa.gov/TOOLS/Inv_Fwd/Inv_Fwd.html">NGS online tools</a>.</li>
<li><a href="http://www.ga.gov.au/earth-monitoring/geodesy/geodetic-techniques/distance-calculation-algorithms.html">Online calculator from Geoscience Australia</a>.</li>
<li>Javascript implementations of solutions to <a href="http://www.movable-type.co.uk/scripts/latlong-vincenty-direct.html">direct problem</a> and <a href="http://www.movable-type.co.uk/scripts/latlong-vincenty.html">inverse problem</a>.</li>
</ul></li>
<li>Implementation of  for ellipsoids of revolution in Geographiclib :
<ul>
<li><a href="http://geographiclib.sourceforge.net/">GeographicLib web site</a> for downloading library and documentation.</li>
<li><a href="http://geographiclib.sourceforge.net/html/GeodSolve.1.html">GeodSolve(1)</a>, <a href="man_page" title="wikilink">man page</a> for a utility for geodesic calculations.</li>
<li><a href="http://geographiclib.sourceforge.net/cgi-bin/GeodSolve">An online version of GeodSolve</a>.</li>
<li><a href="http://geographiclib.sourceforge.net/html/Planimeter.1.html">Planimeter(1)</a>, man page for a utility for calculating the area of geodesic polygons.</li>
<li><a href="http://geographiclib.sourceforge.net/cgi-bin/Planimeter">An online version of Planimeter</a>.</li>
<li><a href="http://trac.osgeo.org/proj/wiki/man_geod">geod(1)</a>, man page for the PROJ.4 utility for geodesic calculations.</li>
<li><a href="http://geographiclib.sourceforge.net/scripts/geod-calc.html">Javascript utility for direct and inverse problems and area calculations</a>.</li>
<li><a href="http://geographiclib.sourceforge.net/scripts/geod-google.html">Drawing geodesics on Google Maps</a>.</li>
<li><a href="http://www.mathworks.com/matlabcentral/fileexchange/50605">Matlab implementation of the geodesic routines</a> (used for the figures for geodesics on ellipsoids of revolution in this article).</li>
<li>The first <a href="http://geographiclib.sourceforge.net/2009-03/geodesic.html">description of the geodesic algorithms</a> from .</li>
</ul></li>
<li>Geodesics on a triaxial ellipsoid:
<ul>
<li><a href="http://geographiclib.sourceforge.net/html/triaxial.html">Additional notes about Jacobi's solution</a>.</li>
<li><a href="http://www.math.harvard.edu/~knill/caustic/exhibits/ellipsoid/index.html">Caustics on an ellipsoid</a>.</li>
</ul></li>
</ul>

<p>"</p>

<p><a class="uri" href="Category:Geodesy" title="wikilink">Category:Geodesy</a> <a href="Category:Geodesic_(mathematics)" title="wikilink">Category:Geodesic (mathematics)</a> <a href="Category:Differential_geometry" title="wikilink">Category:Differential geometry</a> <a href="Category:Calculus_of_variations" title="wikilink">Category:Calculus of variations</a></p>
</body>
</html>

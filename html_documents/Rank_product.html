<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="1251">Rank product</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Rank product</h1>
<hr/>

<p>The <strong>rank product</strong> is a biologically motivated test for the detection of differentially <a href="Gene_expression" title="wikilink">expressed</a> genes in replicated <a href="DNA_microarray" title="wikilink">microarray</a> experiments. It is a simple <a href="Non-parametric_statistics" title="wikilink">non-parametric</a> statistical method based on <a href="ranking" title="wikilink">ranks</a> of fold changes. In addition to its use in <a href="expression_profiling" title="wikilink">expression profiling</a>, it can be used to combine ranked lists in various application domains, including <a class="uri" href="proteomics" title="wikilink">proteomics</a>, <a class="uri" href="metabolomics" title="wikilink">metabolomics</a>, statistical <a class="uri" href="meta-analysis" title="wikilink">meta-analysis</a>, and general <a href="feature_selection" title="wikilink">feature selection</a>.</p>
<h2 id="calculation-of-the-rank-product">Calculation of the rank product</h2>
<figure><b>(Figure)</b>
<figcaption>Filled circles represent ranks of one gene in the different replicates. The rank product for this gene would be (2×1×4×2)<sup>1/4</sup> ≈ 2</figcaption>
</figure>

<p>Given <em>n</em> genes and <em>k</em> replicates, let 

<math display="inline" id="Rank_product:0">
<semantics>
<msub>
<mi>e</mi>
<mrow>
<mi>g</mi>
<mo>,</mo>
<mi>i</mi>
</mrow>
</msub>
<annotation-xml encoding="MathML-Content">
<apply>
<csymbol cd="ambiguous">subscript</csymbol>
<ci>e</ci>
<list>
<ci>g</ci>
<ci>i</ci>
</list>
</apply>
</annotation-xml>
<annotation encoding="application/x-tex">
   e_{g,i}
  </annotation>
</semantics>
</math>

 be the fold change and 

<math display="inline" id="Rank_product:1">
<semantics>
<msub>
<mi>r</mi>
<mrow>
<mi>g</mi>
<mo>,</mo>
<mi>i</mi>
</mrow>
</msub>
<annotation-xml encoding="MathML-Content">
<apply>
<csymbol cd="ambiguous">subscript</csymbol>
<ci>r</ci>
<list>
<ci>g</ci>
<ci>i</ci>
</list>
</apply>
</annotation-xml>
<annotation encoding="application/x-tex">
   r_{g,i}
  </annotation>
</semantics>
</math>

 the rank of gene <em>g</em> in the <em>i</em>-th replicate.</p>

<p>Compute the rank product via the <a href="geometric_mean" title="wikilink">geometric mean</a>:</p>

<p>
<math display="block" id="Rank_product:2">
<semantics>
<mrow>
<mrow>
<mi>R</mi>
<mi>P</mi>
<mrow>
<mo stretchy="false">(</mo>
<mi>g</mi>
<mo stretchy="false">)</mo>
</mrow>
</mrow>
<mo>=</mo>
<msup>
<mrow>
<mo stretchy="false">(</mo>
<mrow>
<msubsup>
<mi mathvariant="normal">Π</mi>
<mrow>
<mi>i</mi>
<mo>=</mo>
<mn>1</mn>
</mrow>
<mi>k</mi>
</msubsup>
<msub>
<mi>r</mi>
<mrow>
<mi>g</mi>
<mo>,</mo>
<mi>i</mi>
</mrow>
</msub>
</mrow>
<mo stretchy="false">)</mo>
</mrow>
<mrow>
<mn>1</mn>
<mo>/</mo>
<mi>k</mi>
</mrow>
</msup>
</mrow>
<annotation-xml encoding="MathML-Content">
<apply>
<eq></eq>
<apply>
<times></times>
<ci>R</ci>
<ci>P</ci>
<ci>g</ci>
</apply>
<apply>
<csymbol cd="ambiguous">superscript</csymbol>
<apply>
<times></times>
<apply>
<csymbol cd="ambiguous">superscript</csymbol>
<apply>
<csymbol cd="ambiguous">subscript</csymbol>
<ci>normal-Π</ci>
<apply>
<eq></eq>
<ci>i</ci>
<cn type="integer">1</cn>
</apply>
</apply>
<ci>k</ci>
</apply>
<apply>
<csymbol cd="ambiguous">subscript</csymbol>
<ci>r</ci>
<list>
<ci>g</ci>
<ci>i</ci>
</list>
</apply>
</apply>
<apply>
<divide></divide>
<cn type="integer">1</cn>
<ci>k</ci>
</apply>
</apply>
</apply>
</annotation-xml>
<annotation encoding="application/x-tex">
   RP(g)=(\Pi_{i=1}^{k}r_{g,i})^{1/k}
  </annotation>
</semantics>
</math>
</p>
<h2 id="determination-of-significance-levels">Determination of significance levels</h2>

<p>Simple permutation-based estimation is used to determine how likely a given RP value or better is observed in a random experiment.</p>
<ol>
<li>generate <em>p</em> <a href="permutation" title="wikilink">permutations</a> of <em>k</em> rank lists of length <em>n</em>.</li>
<li>calculate the rank products of the <em>n</em> genes in the <em>p</em> permutations.</li>
<li>count how many times the rank products of the genes in the permutations are smaller or equal to the observed rank product. Set <em>c</em> to this value.</li>
<li>calculate the average expected value for the rank product by

<math display="block" id="Rank_product:3">
<semantics>
<mrow>
<mrow>
<msub>
<mi mathvariant="normal">E</mi>
<mi>RP</mi>
</msub>
<mrow>
<mo stretchy="false">(</mo>
<mi>g</mi>
<mo stretchy="false">)</mo>
</mrow>
</mrow>
<mo>=</mo>
<mrow>
<mi>c</mi>
<mo>/</mo>
<mi>p</mi>
</mrow>
</mrow>
<annotation-xml encoding="MathML-Content">
<apply>
<eq></eq>
<apply>
<times></times>
<apply>
<csymbol cd="ambiguous">subscript</csymbol>
<ci>normal-E</ci>
<ci>RP</ci>
</apply>
<ci>g</ci>
</apply>
<apply>
<divide></divide>
<ci>c</ci>
<ci>p</ci>
</apply>
</apply>
</annotation-xml>
<annotation encoding="application/x-tex">
   \mathrm{E}_{\mathrm{RP}}(g)=c/p
  </annotation>
</semantics>
</math>

.</li>
<li>calculate the percentage of false positives as 

<math display="block" id="Rank_product:4">
<semantics>
<mrow>
<mrow>
<mi>pfp</mi>
<mrow>
<mo stretchy="false">(</mo>
<mi>g</mi>
<mo stretchy="false">)</mo>
</mrow>
</mrow>
<mo>=</mo>
<mrow>
<mrow>
<mrow>
<msub>
<mi mathvariant="normal">E</mi>
<mrow>
<mi>R</mi>
<mi>P</mi>
</mrow>
</msub>
<mrow>
<mo stretchy="false">(</mo>
<mi>g</mi>
<mo stretchy="false">)</mo>
</mrow>
</mrow>
<mo>/</mo>
<mi>rank</mi>
</mrow>
<mrow>
<mo stretchy="false">(</mo>
<mi>g</mi>
<mo stretchy="false">)</mo>
</mrow>
</mrow>
</mrow>
<annotation-xml encoding="MathML-Content">
<apply>
<eq></eq>
<apply>
<times></times>
<ci>pfp</ci>
<ci>g</ci>
</apply>
<apply>
<times></times>
<apply>
<divide></divide>
<apply>
<times></times>
<apply>
<csymbol cd="ambiguous">subscript</csymbol>
<ci>normal-E</ci>
<apply>
<times></times>
<ci>R</ci>
<ci>P</ci>
</apply>
</apply>
<ci>g</ci>
</apply>
<ci>rank</ci>
</apply>
<ci>g</ci>
</apply>
</apply>
</annotation-xml>
<annotation encoding="application/x-tex">
   \mathrm{pfp}(g)=\mathrm{E}_{RP}(g)/\mathrm{rank}(g)
  </annotation>
</semantics>
</math>

 where 

<math display="inline" id="Rank_product:5">
<semantics>
<mrow>
<mi>rank</mi>
<mrow>
<mo stretchy="false">(</mo>
<mi>g</mi>
<mo stretchy="false">)</mo>
</mrow>
</mrow>
<annotation-xml encoding="MathML-Content">
<apply>
<times></times>
<ci>rank</ci>
<ci>g</ci>
</apply>
</annotation-xml>
<annotation encoding="application/x-tex">
   \mathrm{rank}(g)
  </annotation>
</semantics>
</math>

 is the rank of gene <em>g</em> in a list of all <em>n</em> genes sorted by increasing 

<math display="inline" id="Rank_product:6">
<semantics>
<mi>RP</mi>
<annotation-xml encoding="MathML-Content">
<ci>RP</ci>
</annotation-xml>
<annotation encoding="application/x-tex">
   \mathrm{RP}
  </annotation>
</semantics>
</math>

.</li>
</ol>
<h2 id="exact-probability-distribution-and-accurate-approximation">Exact probability distribution and accurate approximation</h2>

<p>Permutation re-sampling requires a computationally demanding number of permutations to get reliable estimates of the <em>p</em>-values for the most differentially expressed genes, if <em>n</em> is large. Eisinga, Breitling and Heskes (2013) provide the exact probability mass distribution of the rank product statistic. Calculation of the exact <em>p</em>-values offers a substantial improvement over permutation approximation, most significantly for that part of the distribution rank product analysis is most interested in, i.e., the tin right tail. However, exact statistical significance of large rank products may take unacceptable long amounts of time to compute. Heskes, Eisinga and Breitling (2014) provide a method to determine accurate approximate <em>p</em>-values of the rank product statistic in a computationally fast manner.</p>
<h2 id="references">References</h2>
<ul>
<li>Breitling, R., Armengaud, P., Amtmann, A., and Herzyk, P. (2004) Rank Products: A simple, yet powerful, new method to detect differentially regulated genes in replicated microarray experiments, FEBS Letters, 573:83–-92</li>
<li>Eisinga, R., Breitling, R., and Heskes, T. (2013). The exact probability distribution of the rank product statistics for replicated experiments. FEBS Letters, 587:677--682 <a class="uri" href="http://dx.doi.org/10.1016/j.febslet.2013.01.037">http://dx.doi.org/10.1016/j.febslet.2013.01.037</a></li>
<li>Heskes, T., Eisinga, R., Breitling, R. (2014). A fast algorithm for determining bounds and accurate approximate <em>p</em>-values of the rank product statistic for replicate experiments. BMC Bioinformatics, 15:367. <a class="uri" href="http://www.biomedcentral.com/1471-2105/15/367">http://www.biomedcentral.com/1471-2105/15/367</a></li>
</ul>

<p>"</p>

<p><a href="Category:Gene_expression" title="wikilink">Category:Gene expression</a> <a class="uri" href="Category:Meta-analysis" title="wikilink">Category:Meta-analysis</a> <a href="Category:Non-parametric_statistics" title="wikilink">Category:Non-parametric statistics</a> <a class="uri" href="Category:Microarrays" title="wikilink">Category:Microarrays</a></p>
</body>
</html>

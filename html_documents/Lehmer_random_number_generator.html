<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="22">Lehmer random number generator</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Lehmer random number generator</h1>
<style>
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
<style>
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
  </style>
</body></html>
<body>
<hr/>

<p>The <strong>Lehmer random number generator</strong><a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a> (named after <a href="D._H._Lehmer" title="wikilink">D. H. Lehmer</a>), sometimes also referred to as the <strong>Park–Miller random number generator</strong> (after Stephen K. Park and Keith W. Miller), is a variant of <a href="linear_congruential_generator" title="wikilink">linear congruential generator</a> (LCG) that operates in <a href="multiplicative_group_of_integers_modulo_n" title="wikilink">multiplicative group of integers modulo n</a>. A general formula of a random number generator (RNG) of this type is:</p>

<p>

<math display="block" id="Lehmer_random_number_generator:0">
 <semantics>
  <mrow>
   <msub>
    <mi>X</mi>
    <mrow>
     <mi>k</mi>
     <mo>+</mo>
     <mn>1</mn>
    </mrow>
   </msub>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mi>g</mi>
     <mo>⋅</mo>
     <mpadded width="+6.6pt">
      <msub>
       <mi>X</mi>
       <mi>k</mi>
      </msub>
     </mpadded>
    </mrow>
    <mo lspace="2.5pt" rspace="9.1pt">mod</mo>
    <mi>n</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>X</ci>
     <apply>
      <plus></plus>
      <ci>k</ci>
      <cn type="integer">1</cn>
     </apply>
    </apply>
    <apply>
     <csymbol cd="latexml">modulo</csymbol>
     <apply>
      <ci>normal-⋅</ci>
      <ci>g</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>X</ci>
       <ci>k</ci>
      </apply>
     </apply>
     <ci>n</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   X_{k+1}=g\cdot X_{k}~{}~{}\bmod~{}~{}n
  </annotation>
 </semantics>
</math>

</p>

<p>where the modulus <em>n</em> is a <a href="prime_number" title="wikilink">prime number</a> or a power of a prime number, the multiplier <em>g</em> is an element of high <a href="multiplicative_order" title="wikilink">multiplicative order</a> modulo <em>n</em> (e.g., a <a href="primitive_root_modulo_n" title="wikilink">primitive root modulo n</a>), and the seed <em>X</em>

<math display="inline" id="Lehmer_random_number_generator:1">
 <semantics>
  <msub>
   <mi></mi>
   <mn>0</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   {}_{0}
  </annotation>
 </semantics>
</math>

 is <a href="coprime" title="wikilink">co-prime</a> to <em>n</em>.</p>
<h2 id="parameters-in-common-use">Parameters in common use</h2>

<p>In 1988, Park and Miller<a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a> suggested a Lehmer RNG with particular parameters <em>n</em> = 2

<math display="inline" id="Lehmer_random_number_generator:2">
 <semantics>
  <msup>
   <mi></mi>
   <mn>31</mn>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <cn type="integer">31</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   {}^{31}
  </annotation>
 </semantics>
</math>

 − 1 = 2,147,483,647 (a <a href="Mersenne_prime" title="wikilink">Mersenne prime</a> <em>M</em>

<math display="inline" id="Lehmer_random_number_generator:3">
 <semantics>
  <msub>
   <mi></mi>
   <mn>31</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <cn type="integer">31</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   {}_{31}
  </annotation>
 </semantics>
</math>

) and <em>g</em> = 7

<math display="inline" id="Lehmer_random_number_generator:4">
 <semantics>
  <msup>
   <mi></mi>
   <mn>5</mn>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <cn type="integer">5</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   {}^{5}
  </annotation>
 </semantics>
</math>

 = 16,807 (a primitive root modulo <em>M</em>

<math display="inline" id="Lehmer_random_number_generator:5">
 <semantics>
  <msub>
   <mi></mi>
   <mn>31</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <cn type="integer">31</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   {}_{31}
  </annotation>
 </semantics>
</math>

), now known as <strong>MINSTD</strong>. Although MINSTD was later criticized by Marsaglia and Sullivan (1993),<a class="footnoteRef" href="#fn3" id="fnref3"><sup>3</sup></a> it is still in use today (in particular, in <a class="uri" href="CarbonLib" title="wikilink">CarbonLib</a> and <a class="uri" href="C++11" title="wikilink">C++11</a>'s <code>minstd_rand0</code>). Park, Miller and Stockmeyer responded to the criticism (1993),<a class="footnoteRef" href="#fn4" id="fnref4"><sup>4</sup></a> saying:</p>
<blockquote>

<p>Given the dynamic nature of the area, it is difficult for nonspecialists to make decisions about what generator to use. "Give me something I can understand, implement and port... it needn't be state-of-the-art, just make sure it's reasonably good and efficient." Our article and the associated minimal standard generator was an attempt to respond to this request. Five years later, we see no need to alter our response other than to suggest the use of the multiplier a = 48271 in place of 16807.</p>
</blockquote>

<p>This revised constant is used in <a class="uri" href="C++11" title="wikilink">C++11</a>'s <code>minstd_rand</code> random number generator.</p>

<p>The <a href="ZX81" title="wikilink">Sinclair ZX81</a> and its successors use the Lehmer RNG with parameters <em>n</em> = 2

<math display="inline" id="Lehmer_random_number_generator:6">
 <semantics>
  <msup>
   <mi></mi>
   <mn>16</mn>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <cn type="integer">16</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   {}^{16}
  </annotation>
 </semantics>
</math>

 + 1 = 65,537 (a <a href="Fermat_prime" title="wikilink">Fermat prime</a> <em>F</em>

<math display="inline" id="Lehmer_random_number_generator:7">
 <semantics>
  <msub>
   <mi></mi>
   <mn>4</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <cn type="integer">4</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   {}_{4}
  </annotation>
 </semantics>
</math>

) and <em>g</em> = 75 (a primitive root modulo <em>F</em>

<math display="inline" id="Lehmer_random_number_generator:8">
 <semantics>
  <msub>
   <mi></mi>
   <mn>4</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <cn type="integer">4</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   {}_{4}
  </annotation>
 </semantics>
</math>

). <a class="footnoteRef" href="#fn5" id="fnref5"><sup>5</sup></a> The <a class="uri" href="CRAY" title="wikilink">CRAY</a> random number generator <strong>RANF</strong> is a Lehmer RNG with <em>n</em> = 2

<math display="inline" id="Lehmer_random_number_generator:9">
 <semantics>
  <msup>
   <mi></mi>
   <mn>48</mn>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <cn type="integer">48</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   {}^{48}
  </annotation>
 </semantics>
</math>

 and <em>g</em> = 44,485,709,377,909.<a class="footnoteRef" href="#fn6" id="fnref6"><sup>6</sup></a> The <a href="GNU_Scientific_Library" title="wikilink">GNU Scientific Library</a> includes several random number generators of the Lehmer form, including MINSTD, RANF, and the infamous <a class="uri" href="IBM" title="wikilink">IBM</a> random number generator <a class="uri" href="RANDU" title="wikilink">RANDU</a>.<a class="footnoteRef" href="#fn7" id="fnref7"><sup>7</sup></a></p>
<h2 id="relation-to-lcg">Relation to LCG</h2>

<p>While the Lehmer RNG can be viewed as a particular case of the <a href="linear_congruential_generator" title="wikilink">linear congruential generator</a> with , it is a special case that implies certain restrictions and properties. In particular, for the Lehmer RNG, the initial seed <em>X</em>

<math display="inline" id="Lehmer_random_number_generator:10">
 <semantics>
  <msub>
   <mi></mi>
   <mn>0</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   {}_{0}
  </annotation>
 </semantics>
</math>

 must be <a class="uri" href="coprime" title="wikilink">coprime</a> to the modulus <em>n</em> that is not required for LCGs in general. The choice of the modulus <em>n</em> and the multiplier <em>g</em> is also more restrictive for the Lehmer RNG. In contrast to LCG, the maximum period of the Lehmer RNG equals <em>n</em>−1 and it is such when <em>n</em> is prime and <em>g</em> is a primitive root modulo <em>n</em>.</p>

<p>On the other hand, the <a href="discrete_logarithm" title="wikilink">discrete logarithms</a> (to base <em>g</em> or any primitive root modulo <em>n</em>) of <em>X

<math display="inline" id="Lehmer_random_number_generator:11">
 <semantics>
  <msub>
   <mi></mi>
   <mi>k</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>k</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   {}_{k}
  </annotation>
 </semantics>
</math>

</em> in 

<math display="inline" id="Lehmer_random_number_generator:12">
 <semantics>
  <msub>
   <mi>ℤ</mi>
   <mi>n</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>ℤ</ci>
    <ci>n</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbb{Z}_{n}
  </annotation>
 </semantics>
</math>

 represent linear congruential sequence modulo <a href="Euler_totient" title="wikilink">Euler totient</a> 

<math display="inline" id="Lehmer_random_number_generator:13">
 <semantics>
  <mrow>
   <mi>φ</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>n</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>φ</ci>
    <ci>n</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \varphi(n)
  </annotation>
 </semantics>
</math>

.</p>
<h2 id="sample-c99-code">Sample C99 code</h2>

<p>Using <a href="ISO_C" title="wikilink">C</a> code, the Park-Miller Lehmer generator can be written as follows.</p>
<div class="sourceCode"><pre class="sourceCode c"><code class="sourceCode c"><span class="dt">uint32_t</span> lcg_parkmiller(<span class="dt">uint32_t</span> a)
{
    <span class="kw">return</span> ((<span class="dt">uint64_t</span>)a * 48271UL) % 2147483647UL;
}</code></pre></div>

<p>This function's output can be fed back to its input to generate pseudorandom numbers, as long as the caller is careful to begin with any number except zero. As the product of two 32 bit integers may overflow, the cast to uint64_t is necessary.</p>

<p>Another popular pair of Lehmer generator parameters uses the prime modulus 2<sup>32</sup>-5:</p>
<div class="sourceCode"><pre class="sourceCode c"><code class="sourceCode c"><span class="dt">uint32_t</span> lcg_rand(<span class="dt">uint32_t</span> a)
{
    <span class="kw">return</span> ((<span class="dt">uint64_t</span>)a * 279470273UL) % 4294967291UL;
}</code></pre></div>

<p>Many other Lehmer generators and primes have good properties.<a class="footnoteRef" href="#fn8" id="fnref8"><sup>8</sup></a></p>
<h2 id="references">References</h2>
<ul>
<li>

<p>(journal version: <em>Annals of the Computation Laboratory of Harvard University</em>, Vol. 26 (1951)).</p></li>
<li></li>
<li>Steve Park, <a href="http://www.cs.wm.edu/~va/software/park/">Random Number Generators</a></li>
<li><a href="http://www.firstpr.com.au/dsp/rand31/">Park–Miller–Carta Pseudo-Random Number Generator</a></li>
</ul>

<p>"</p>

<p><a href="Category:Pseudorandom_number_generators" title="wikilink">Category:Pseudorandom number generators</a> <a href="Category:Modular_arithmetic" title="wikilink">Category:Modular arithmetic</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1"><a href="#fnref1">↩</a></li>
<li id="fn2"><a href="#fnref2">↩</a></li>
<li id="fn3"><a href="#fnref3">↩</a></li>
<li id="fn4"><a href="#fnref4">↩</a></li>
<li id="fn5"> (Note the ZX81 manual incorrectly states that 65537 is a Mersenne prime that equals 2<sup>16</sup>-1. The ZX Spectrum manual fixed that and correctly states that it is a Fermat prime that equals 2<sup>16</sup>+1.)<a href="#fnref5">↩</a></li>
<li id="fn6"><a href="http://www.gnu.org/software/gsl/manual/html_node/Other-random-number-generators.html">GNU Scientific Library: Other random number generators</a><a href="#fnref6">↩</a></li>
<li id="fn7"></li>
<li id="fn8"><a href="#fnref8">↩</a></li>
</ol>
</section>
</body>


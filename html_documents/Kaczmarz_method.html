<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="653">Kaczmarz method</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Kaczmarz method</h1>
<hr/>

<p>The <strong>Kaczmarz method</strong> or <strong>Kaczmarz's algorithm</strong> is an <a href="iterative_algorithm" title="wikilink">iterative algorithm</a> for solving <a href="linear_equation_system" title="wikilink">linear equation systems</a> 

<math display="inline" id="Kaczmarz_method:0">
 <semantics>
  <mrow>
   <mrow>
    <mi>A</mi>
    <mi>x</mi>
   </mrow>
   <mo>=</mo>
   <mi>b</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>A</ci>
     <ci>x</ci>
    </apply>
    <ci>b</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Ax=b
  </annotation>
 </semantics>
</math>

. It was first discovered by the Polish mathematician <a href="Stefan_Kaczmarz" title="wikilink">Stefan Kaczmarz</a>,<a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a> and was rediscovered in the field of image reconstruction from projections by <a href="Richard_Gordon_(theoretical_biologist)" title="wikilink">Richard Gordon</a>, Robert Bender, and <a href="Gabor_Herman" title="wikilink">Gabor Herman</a> in 1970, where it is called the <a href="Algebraic_Reconstruction_Technique" title="wikilink">Algebraic Reconstruction Technique</a> (ART).<a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a> ART includes the positivity constraint, making it nonlinear.<a class="footnoteRef" href="#fn3" id="fnref3"><sup>3</sup></a></p>

<p>The Kaczmarz method is applicable to any linear system of equations, but its computational advantage relative to other methods depends on the system being <a href="Sparse_matrix" title="wikilink">sparse</a>. It has been demonstrated to be superior, in some biomedical imaging applications, to other methods such as the filtered backprojection method.<a class="footnoteRef" href="#fn4" id="fnref4"><sup>4</sup></a></p>

<p>It has many applications ranging from <a href="computed_tomography" title="wikilink">computed tomography</a> (CT) to <a href="signal_processing" title="wikilink">signal processing</a>. It can be obtained also by applying to the hyperplanes, described by the linear system, the method of successive <a href="projections_onto_convex_sets" title="wikilink">projections onto convex sets</a> (POCS).<a class="footnoteRef" href="#fn5" id="fnref5"><sup>5</sup></a><a class="footnoteRef" href="#fn6" id="fnref6"><sup>6</sup></a></p>
<h2 id="algorithm-1-kaczmarz-algorithm">Algorithm 1: Kaczmarz algorithm</h2>

<p>Let 

<math display="inline" id="Kaczmarz_method:1">
 <semantics>
  <mrow>
   <mrow>
    <mi>A</mi>
    <mi>x</mi>
   </mrow>
   <mo>=</mo>
   <mi>b</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>A</ci>
     <ci>x</ci>
    </apply>
    <ci>b</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Ax=b
  </annotation>
 </semantics>
</math>

 be a linear system, let 

<math display="inline" id="Kaczmarz_method:2">
 <semantics>
  <mi>m</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>m</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   m
  </annotation>
 </semantics>
</math>

 the number of rows of A, 

<math display="inline" id="Kaczmarz_method:3">
 <semantics>
  <msub>
   <mi>a</mi>
   <mi>i</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>a</ci>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a_{i}
  </annotation>
 </semantics>
</math>

 be the 

<math display="inline" id="Kaczmarz_method:4">
 <semantics>
  <mi>i</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>i</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   i
  </annotation>
 </semantics>
</math>

th row of complex-valued matrix 

<math display="inline" id="Kaczmarz_method:5">
 <semantics>
  <mi>A</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>A</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A
  </annotation>
 </semantics>
</math>

, and let 

<math display="inline" id="Kaczmarz_method:6">
 <semantics>
  <msub>
   <mi>x</mi>
   <mn>0</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>x</ci>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x_{0}
  </annotation>
 </semantics>
</math>

 be arbitrary complex-valued initial approximation to the solution of 

<math display="inline" id="Kaczmarz_method:7">
 <semantics>
  <mrow>
   <mrow>
    <mi>A</mi>
    <mi>x</mi>
   </mrow>
   <mo>=</mo>
   <mi>b</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>A</ci>
     <ci>x</ci>
    </apply>
    <ci>b</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Ax=b
  </annotation>
 </semantics>
</math>

. For 

<math display="inline" id="Kaczmarz_method:8">
 <semantics>
  <mrow>
   <mi>k</mi>
   <mo>=</mo>
   <mrow>
    <mn>0</mn>
    <mo>,</mo>
    <mn>1</mn>
    <mo>,</mo>
    <mi mathvariant="normal">…</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>k</ci>
    <list>
     <cn type="integer">0</cn>
     <cn type="integer">1</cn>
     <ci>normal-…</ci>
    </list>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   k=0,1,...
  </annotation>
 </semantics>
</math>

 compute:</p>

<p>

<math display="block" id="Kaczmarz_method:9">
 <semantics>
  <mrow>
   <msub>
    <mi>x</mi>
    <mrow>
     <mi>k</mi>
     <mo>+</mo>
     <mn>1</mn>
    </mrow>
   </msub>
   <mo>=</mo>
   <mrow>
    <msub>
     <mi>x</mi>
     <mi>k</mi>
    </msub>
    <mo>+</mo>
    <mrow>
     <mfrac>
      <mrow>
       <msub>
        <mi>b</mi>
        <mi>i</mi>
       </msub>
       <mo>-</mo>
       <mrow>
        <mo stretchy="false">⟨</mo>
        <msub>
         <mi>a</mi>
         <mi>i</mi>
        </msub>
        <mo>,</mo>
        <msub>
         <mi>x</mi>
         <mi>k</mi>
        </msub>
        <mo stretchy="false">⟩</mo>
       </mrow>
      </mrow>
      <msup>
       <mrow>
        <mo fence="true">∥</mo>
        <msub>
         <mi>a</mi>
         <mi>i</mi>
        </msub>
        <mo fence="true">∥</mo>
       </mrow>
       <mn>2</mn>
      </msup>
     </mfrac>
     <mover accent="true">
      <msub>
       <mi>a</mi>
       <mi>i</mi>
      </msub>
      <mo>¯</mo>
     </mover>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>x</ci>
     <apply>
      <plus></plus>
      <ci>k</ci>
      <cn type="integer">1</cn>
     </apply>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <ci>k</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <apply>
        <minus></minus>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>b</ci>
         <ci>i</ci>
        </apply>
        <list>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>a</ci>
          <ci>i</ci>
         </apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>x</ci>
          <ci>k</ci>
         </apply>
        </list>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="latexml">norm</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>a</ci>
          <ci>i</ci>
         </apply>
        </apply>
        <cn type="integer">2</cn>
       </apply>
      </apply>
      <apply>
       <ci>normal-¯</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>a</ci>
        <ci>i</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x_{k+1}=x_{k}+\frac{b_{i}-\langle a_{i},x_{k}\rangle}{\lVert a_{i}\rVert^{2}}%
\overline{a_{i}}
  </annotation>
 </semantics>
</math>

</p>

<p>where 

<math display="inline" id="Kaczmarz_method:10">
 <semantics>
  <mrow>
   <mi>i</mi>
   <mo>=</mo>
   <mrow>
    <mpadded width="+1.7pt">
     <mi>k</mi>
    </mpadded>
    <mo lspace="2.5pt" rspace="4.2pt">mod</mo>
    <mrow>
     <mi>m</mi>
     <mo>+</mo>
     <mn>1</mn>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>i</ci>
    <apply>
     <csymbol cd="latexml">modulo</csymbol>
     <ci>k</ci>
     <apply>
      <plus></plus>
      <ci>m</ci>
      <cn type="integer">1</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   i=k\,\bmod\,m+1
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Kaczmarz_method:11">
 <semantics>
  <mover accent="true">
   <msub>
    <mi>a</mi>
    <mi>i</mi>
   </msub>
   <mo>¯</mo>
  </mover>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-¯</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>a</ci>
     <ci>i</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \overline{a_{i}}
  </annotation>
 </semantics>
</math>

 denotes complex conjugation of 

<math display="inline" id="Kaczmarz_method:12">
 <semantics>
  <msub>
   <mi>a</mi>
   <mi>i</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>a</ci>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a_{i}
  </annotation>
 </semantics>
</math>

.</p>

<p>If the <a href="linear_system" title="wikilink">linear system</a> is consistent, 

<math display="inline" id="Kaczmarz_method:13">
 <semantics>
  <msub>
   <mi>x</mi>
   <mi>k</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>x</ci>
    <ci>k</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x_{k}
  </annotation>
 </semantics>
</math>

 converges to the minimum-norm solution, provided that the iterations start with the zero vector.</p>

<p>A more general algorithm can be defined using a relaxation parameter 

<math display="inline" id="Kaczmarz_method:14">
 <semantics>
  <msub>
   <mi>λ</mi>
   <mi>k</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>λ</ci>
    <ci>k</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \lambda_{k}
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Kaczmarz_method:15">
 <semantics>
  <mrow>
   <msup>
    <mi>x</mi>
    <mrow>
     <mi>k</mi>
     <mo>+</mo>
     <mn>1</mn>
    </mrow>
   </msup>
   <mo>=</mo>
   <mrow>
    <msup>
     <mi>x</mi>
     <mi>k</mi>
    </msup>
    <mo>+</mo>
    <mrow>
     <msub>
      <mi>λ</mi>
      <mi>k</mi>
     </msub>
     <mfrac>
      <mrow>
       <msub>
        <mi>b</mi>
        <mi>i</mi>
       </msub>
       <mo>-</mo>
       <mrow>
        <mo stretchy="false">⟨</mo>
        <msub>
         <mi>a</mi>
         <mi>i</mi>
        </msub>
        <mo>,</mo>
        <msup>
         <mi>x</mi>
         <mi>k</mi>
        </msup>
        <mo stretchy="false">⟩</mo>
       </mrow>
      </mrow>
      <msup>
       <mrow>
        <mo fence="true">∥</mo>
        <msub>
         <mi>a</mi>
         <mi>i</mi>
        </msub>
        <mo fence="true">∥</mo>
       </mrow>
       <mn>2</mn>
      </msup>
     </mfrac>
     <mover accent="true">
      <msub>
       <mi>a</mi>
       <mi>i</mi>
      </msub>
      <mo>¯</mo>
     </mover>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>x</ci>
     <apply>
      <plus></plus>
      <ci>k</ci>
      <cn type="integer">1</cn>
     </apply>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>x</ci>
      <ci>k</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>λ</ci>
       <ci>k</ci>
      </apply>
      <apply>
       <divide></divide>
       <apply>
        <minus></minus>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>b</ci>
         <ci>i</ci>
        </apply>
        <list>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>a</ci>
          <ci>i</ci>
         </apply>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>x</ci>
          <ci>k</ci>
         </apply>
        </list>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="latexml">norm</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>a</ci>
          <ci>i</ci>
         </apply>
        </apply>
        <cn type="integer">2</cn>
       </apply>
      </apply>
      <apply>
       <ci>normal-¯</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>a</ci>
        <ci>i</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x^{k+1}=x^{k}+\lambda_{k}\frac{b_{i}-\langle a_{i},x^{k}\rangle}{\lVert a_{i}%
\rVert^{2}}\overline{a_{i}}
  </annotation>
 </semantics>
</math>

</p>

<p>There are versions of the method that converge to a regularized weighted least squares solution when applied to a system of inconsistent equations and, at least as far as initial behavior is concerned, at a lesser cost than other iterative methods, such as the <a href="conjugate_gradient_method" title="wikilink">conjugate gradient method</a>.<a class="footnoteRef" href="#fn7" id="fnref7"><sup>7</sup></a></p>
<h2 id="algorithm-2-randomized-kaczmarz-algorithm">Algorithm 2: Randomized Kaczmarz algorithm</h2>

<p>Recently, a randomized version of the Kaczmarz method for <a href="overdetermined_system" title="wikilink">overdetermined</a> linear systems was introduced by Strohmer and Vershynin<a class="footnoteRef" href="#fn8" id="fnref8"><sup>8</sup></a> in which the <em>i</em>-th equation is selected randomly with probability proportional to 

<math display="inline" id="Kaczmarz_method:16">
 <semantics>
  <msup>
   <mrow>
    <mo fence="true">∥</mo>
    <msub>
     <mi>a</mi>
     <mi>i</mi>
    </msub>
    <mo fence="true">∥</mo>
   </mrow>
   <mn>2</mn>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <apply>
     <csymbol cd="latexml">norm</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>a</ci>
      <ci>i</ci>
     </apply>
    </apply>
    <cn type="integer">2</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \lVert a_{i}\rVert^{2}
  </annotation>
 </semantics>
</math>

.</p>

<p>This method can be seen as a particular case of <a href="stochastic_gradient_descent" title="wikilink">stochastic gradient descent</a> .<a class="footnoteRef" href="#fn9" id="fnref9"><sup>9</sup></a></p>

<p>Under such circumstances 

<math display="inline" id="Kaczmarz_method:17">
 <semantics>
  <msub>
   <mi>x</mi>
   <mi>k</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>x</ci>
    <ci>k</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x_{k}
  </annotation>
 </semantics>
</math>

 converges exponentially fast to the solution of 

<math display="inline" id="Kaczmarz_method:18">
 <semantics>
  <mrow>
   <mrow>
    <mi>A</mi>
    <mi>x</mi>
   </mrow>
   <mo>=</mo>
   <mi>b</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>A</ci>
     <ci>x</ci>
    </apply>
    <ci>b</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Ax=b
  </annotation>
 </semantics>
</math>

, and the rate of convergence depends only on the scaled <a href="condition_number" title="wikilink">condition number</a> 

<math display="inline" id="Kaczmarz_method:19">
 <semantics>
  <mrow>
   <mi>κ</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>A</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>κ</ci>
    <ci>A</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \kappa(A)
  </annotation>
 </semantics>
</math>

.</p>
<h3 id="theorem">Theorem</h3>

<p>Let 

<math display="inline" id="Kaczmarz_method:20">
 <semantics>
  <mi>x</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>x</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x
  </annotation>
 </semantics>
</math>

 be the solution of 

<math display="inline" id="Kaczmarz_method:21">
 <semantics>
  <mrow>
   <mrow>
    <mi>A</mi>
    <mi>x</mi>
   </mrow>
   <mo>=</mo>
   <mi>b</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>A</ci>
     <ci>x</ci>
    </apply>
    <ci>b</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Ax=b
  </annotation>
 </semantics>
</math>

. Then Algorithm 1 converges to 

<math display="inline" id="Kaczmarz_method:22">
 <semantics>
  <mi>x</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>x</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x
  </annotation>
 </semantics>
</math>

 in expectation, with the average error:</p>

<p>

<math display="block" id="Kaczmarz_method:23">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>E</mi>
     <msup>
      <mrow>
       <mo fence="true">∥</mo>
       <mrow>
        <msub>
         <mi>x</mi>
         <mi>k</mi>
        </msub>
        <mo>-</mo>
        <mi>x</mi>
       </mrow>
       <mo fence="true">∥</mo>
      </mrow>
      <mn>2</mn>
     </msup>
    </mrow>
    <mo>≤</mo>
    <mrow>
     <msup>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mn>1</mn>
        <mo>-</mo>
        <mrow>
         <mi>κ</mi>
         <msup>
          <mrow>
           <mo stretchy="false">(</mo>
           <mi>A</mi>
           <mo stretchy="false">)</mo>
          </mrow>
          <mrow>
           <mo>-</mo>
           <mn>2</mn>
          </mrow>
         </msup>
        </mrow>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
      <mi>k</mi>
     </msup>
     <mo>⋅</mo>
     <msup>
      <mrow>
       <mo fence="true">∥</mo>
       <mrow>
        <msub>
         <mi>x</mi>
         <mn>0</mn>
        </msub>
        <mo>-</mo>
        <mi>x</mi>
       </mrow>
       <mo fence="true">∥</mo>
      </mrow>
      <mn>2</mn>
     </msup>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <leq></leq>
    <apply>
     <times></times>
     <ci>E</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="latexml">norm</csymbol>
       <apply>
        <minus></minus>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>x</ci>
         <ci>k</ci>
        </apply>
        <ci>x</ci>
       </apply>
      </apply>
      <cn type="integer">2</cn>
     </apply>
    </apply>
    <apply>
     <ci>normal-⋅</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
       <apply>
        <times></times>
        <ci>κ</ci>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>A</ci>
         <apply>
          <minus></minus>
          <cn type="integer">2</cn>
         </apply>
        </apply>
       </apply>
      </apply>
      <ci>k</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="latexml">norm</csymbol>
       <apply>
        <minus></minus>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>x</ci>
         <cn type="integer">0</cn>
        </apply>
        <ci>x</ci>
       </apply>
      </apply>
      <cn type="integer">2</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   E{\lVert x_{k}-x\rVert^{2}}\leq(1-\kappa(A)^{-2})^{k}\cdot{\lVert x_{0}-x%
\rVert^{2}}.
  </annotation>
 </semantics>
</math>

</p>
<h3 id="proof">Proof</h3>

<p>We have</p>

<p>

<math display="inline" id="Kaczmarz_method:24">
 <semantics>
  <mrow>
   <mrow>
    <msubsup>
     <mo largeop="true" symmetric="true">∑</mo>
     <mrow>
      <mi>j</mi>
      <mo>=</mo>
      <mn>1</mn>
     </mrow>
     <mi>m</mi>
    </msubsup>
    <msup>
     <mrow>
      <mo stretchy="false">|</mo>
      <mrow>
       <mo stretchy="false">⟨</mo>
       <mi>z</mi>
       <mo>,</mo>
       <msub>
        <mi>a</mi>
        <mi>j</mi>
       </msub>
       <mo stretchy="false">⟩</mo>
      </mrow>
      <mo stretchy="false">|</mo>
     </mrow>
     <mn>2</mn>
    </msup>
   </mrow>
   <mo>≥</mo>
   <mrow>
    <mfrac>
     <msup>
      <mrow>
       <mo fence="true">∥</mo>
       <mi>z</mi>
       <mo fence="true">∥</mo>
      </mrow>
      <mn>2</mn>
     </msup>
     <msup>
      <mrow>
       <mo fence="true">∥</mo>
       <msup>
        <mi>A</mi>
        <mrow>
         <mo>-</mo>
         <mn>1</mn>
        </mrow>
       </msup>
       <mo fence="true">∥</mo>
      </mrow>
      <mn>2</mn>
     </msup>
    </mfrac>
    <mrow>
     <mo stretchy="false">(</mo>
     <mn>1</mn>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <geq></geq>
    <apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <apply>
        <eq></eq>
        <ci>j</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <ci>m</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <abs></abs>
       <list>
        <ci>z</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>a</ci>
         <ci>j</ci>
        </apply>
       </list>
      </apply>
      <cn type="integer">2</cn>
     </apply>
    </apply>
    <list>
     <apply>
      <divide></divide>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="latexml">norm</csymbol>
        <ci>z</ci>
       </apply>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="latexml">norm</csymbol>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>A</ci>
         <apply>
          <minus></minus>
          <cn type="integer">1</cn>
         </apply>
        </apply>
       </apply>
       <cn type="integer">2</cn>
      </apply>
     </apply>
     <cn type="integer">1</cn>
    </list>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \sum_{j=1}^{m}|\langle z,a_{j}\rangle|^{2}\geq\frac{\lVert z\rVert^{2}}{\lVert
A%
^{-1}\rVert^{2}}\qquad\qquad\qquad\qquad(1)
  </annotation>
 </semantics>
</math>

 for all 

<math display="inline" id="Kaczmarz_method:25">
 <semantics>
  <mrow>
   <mrow>
    <mi>z</mi>
    <mo>∈</mo>
    <msup>
     <mi>ℂ</mi>
     <mi>n</mi>
    </msup>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <in></in>
    <ci>z</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>ℂ</ci>
     <ci>n</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   z\in\mathbb{C}^{n}.
  </annotation>
 </semantics>
</math>

</p>

<p>Using the fact that 

<math display="inline" id="Kaczmarz_method:26">
 <semantics>
  <mrow>
   <msup>
    <mrow>
     <mo fence="true">∥</mo>
     <mi>A</mi>
     <mo fence="true">∥</mo>
    </mrow>
    <mn>2</mn>
   </msup>
   <mo>=</mo>
   <mrow>
    <msubsup>
     <mo largeop="true" symmetric="true">∑</mo>
     <mrow>
      <mi>j</mi>
      <mo>=</mo>
      <mn>1</mn>
     </mrow>
     <mi>m</mi>
    </msubsup>
    <msup>
     <mrow>
      <mo fence="true">∥</mo>
      <msub>
       <mi>a</mi>
       <mi>j</mi>
      </msub>
      <mo fence="true">∥</mo>
     </mrow>
     <mn>2</mn>
    </msup>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="latexml">norm</csymbol>
      <ci>A</ci>
     </apply>
     <cn type="integer">2</cn>
    </apply>
    <apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <apply>
        <eq></eq>
        <ci>j</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <ci>m</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="latexml">norm</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>a</ci>
        <ci>j</ci>
       </apply>
      </apply>
      <cn type="integer">2</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   {\lVert A\rVert^{2}}=\sum_{j=1}^{m}{\lVert a_{j}\rVert^{2}}
  </annotation>
 </semantics>
</math>

 we can write (1) as</p>

<p>

<math display="inline" id="Kaczmarz_method:27">
 <semantics>
  <mtable>
   <mtr>
    <mtd columnalign="right">
     <mrow>
      <mrow>
       <mstyle displaystyle="true">
        <munderover>
         <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
         <mrow>
          <mi>j</mi>
          <mo>=</mo>
          <mn>1</mn>
         </mrow>
         <mi>m</mi>
        </munderover>
       </mstyle>
       <mrow>
        <mstyle displaystyle="true">
         <mfrac>
          <msup>
           <mrow>
            <mo fence="true">∥</mo>
            <msub>
             <mi>a</mi>
             <mi>j</mi>
            </msub>
            <mo fence="true">∥</mo>
           </mrow>
           <mn>2</mn>
          </msup>
          <msup>
           <mrow>
            <mo fence="true">∥</mo>
            <mi>A</mi>
            <mo fence="true">∥</mo>
           </mrow>
           <mn>2</mn>
          </msup>
         </mfrac>
        </mstyle>
        <msup>
         <mrow>
          <mo>|</mo>
          <mrow>
           <mo>⟨</mo>
           <mi>z</mi>
           <mo>,</mo>
           <mstyle displaystyle="true">
            <mfrac>
             <msub>
              <mi>a</mi>
              <mi>j</mi>
             </msub>
             <mrow>
              <mo fence="true">∥</mo>
              <msub>
               <mi>a</mi>
               <mi>j</mi>
              </msub>
              <mo fence="true">∥</mo>
             </mrow>
            </mfrac>
           </mstyle>
           <mo>⟩</mo>
          </mrow>
          <mo>|</mo>
         </mrow>
         <mn>2</mn>
        </msup>
       </mrow>
      </mrow>
      <mo>≥</mo>
      <mrow>
       <mrow>
        <mi>κ</mi>
        <msup>
         <mrow>
          <mo stretchy="false">(</mo>
          <mi>A</mi>
          <mo stretchy="false">)</mo>
         </mrow>
         <mrow>
          <mo>-</mo>
          <mn>2</mn>
         </mrow>
        </msup>
        <msup>
         <mrow>
          <mo fence="true">∥</mo>
          <mi>z</mi>
          <mo fence="true">∥</mo>
         </mrow>
         <mn>2</mn>
        </msup>
       </mrow>
       <mrow>
        <mo stretchy="false">(</mo>
        <mn>2</mn>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
     </mrow>
    </mtd>
   </mtr>
  </mtable>
  <annotation-xml encoding="MathML-Content">
   <matrix>
    <matrixrow>
     <apply>
      <geq></geq>
      <apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <sum></sum>
         <apply>
          <eq></eq>
          <ci>j</ci>
          <cn type="integer">1</cn>
         </apply>
        </apply>
        <ci>m</ci>
       </apply>
       <apply>
        <times></times>
        <apply>
         <divide></divide>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <apply>
           <csymbol cd="latexml">norm</csymbol>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <ci>a</ci>
            <ci>j</ci>
           </apply>
          </apply>
          <cn type="integer">2</cn>
         </apply>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <apply>
           <csymbol cd="latexml">norm</csymbol>
           <ci>A</ci>
          </apply>
          <cn type="integer">2</cn>
         </apply>
        </apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <abs></abs>
          <list>
           <ci>z</ci>
           <apply>
            <divide></divide>
            <apply>
             <csymbol cd="ambiguous">subscript</csymbol>
             <ci>a</ci>
             <ci>j</ci>
            </apply>
            <apply>
             <csymbol cd="latexml">norm</csymbol>
             <apply>
              <csymbol cd="ambiguous">subscript</csymbol>
              <ci>a</ci>
              <ci>j</ci>
             </apply>
            </apply>
           </apply>
          </list>
         </apply>
         <cn type="integer">2</cn>
        </apply>
       </apply>
      </apply>
      <list>
       <apply>
        <times></times>
        <ci>κ</ci>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>A</ci>
         <apply>
          <minus></minus>
          <cn type="integer">2</cn>
         </apply>
        </apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <csymbol cd="latexml">norm</csymbol>
          <ci>z</ci>
         </apply>
         <cn type="integer">2</cn>
        </apply>
       </apply>
       <cn type="integer">2</cn>
      </list>
     </apply>
    </matrixrow>
   </matrix>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \begin{aligned}\displaystyle\sum_{j=1}^{m}\frac{{\lVert a_{j}\rVert^{2}}}{%
\lVert A\rVert^{2}}\left|\left\langle z,\frac{a_{j}}{\lVert a_{j}\rVert}\right%
\rangle\right|^{2}\geq\kappa(A)^{-2}{\lVert z\rVert^{2}}\qquad\qquad\qquad%
\qquad(2)\end{aligned}
  </annotation>
 </semantics>
</math>

 for all 

<math display="inline" id="Kaczmarz_method:28">
 <semantics>
  <mrow>
   <mrow>
    <mi>z</mi>
    <mo>∈</mo>
    <msup>
     <mi>ℂ</mi>
     <mi>n</mi>
    </msup>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <in></in>
    <ci>z</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>ℂ</ci>
     <ci>n</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   z\in\mathbb{C}^{n}.
  </annotation>
 </semantics>
</math>

</p>

<p>The main point of the proof is to view the left hand side in (2) as an expectation of some random variable. Namely, recall that the solution space of the 

<math display="inline" id="Kaczmarz_method:29">
 <semantics>
  <mrow>
   <mi>j</mi>
   <mo>-</mo>
   <mrow>
    <mi>t</mi>
    <mi>h</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <minus></minus>
    <ci>j</ci>
    <apply>
     <times></times>
     <ci>t</ci>
     <ci>h</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   j-th
  </annotation>
 </semantics>
</math>

 equation of 

<math display="inline" id="Kaczmarz_method:30">
 <semantics>
  <mrow>
   <mrow>
    <mi>A</mi>
    <mi>x</mi>
   </mrow>
   <mo>=</mo>
   <mi>b</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>A</ci>
     <ci>x</ci>
    </apply>
    <ci>b</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Ax=b
  </annotation>
 </semantics>
</math>

 is the hyperplane 

<math display="inline" id="Kaczmarz_method:31">
 <semantics>
  <mrow>
   <mi>y</mi>
   <mo>:</mo>
   <mrow>
    <mrow>
     <mo stretchy="false">⟨</mo>
     <mi>y</mi>
     <mo>,</mo>
     <msub>
      <mi>a</mi>
      <mi>j</mi>
     </msub>
     <mo stretchy="false">⟩</mo>
    </mrow>
    <mo>=</mo>
    <msub>
     <mi>b</mi>
     <mi>j</mi>
    </msub>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-:</ci>
    <ci>y</ci>
    <apply>
     <eq></eq>
     <list>
      <ci>y</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>a</ci>
       <ci>j</ci>
      </apply>
     </list>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>b</ci>
      <ci>j</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   {y:\langle y,a_{j}\rangle=b_{j}}
  </annotation>
 </semantics>
</math>

, whose normal is 

<math display="inline" id="Kaczmarz_method:32">
 <semantics>
  <mrow>
   <mfrac>
    <msub>
     <mi>a</mi>
     <mi>j</mi>
    </msub>
    <msup>
     <mrow>
      <mo fence="true">∥</mo>
      <msub>
       <mi>a</mi>
       <mi>j</mi>
      </msub>
      <mo fence="true">∥</mo>
     </mrow>
     <mn>2</mn>
    </msup>
   </mfrac>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <divide></divide>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>a</ci>
     <ci>j</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="latexml">norm</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>a</ci>
       <ci>j</ci>
      </apply>
     </apply>
     <cn type="integer">2</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \frac{a_{j}}{\lVert a_{j}\rVert^{2}}.
  </annotation>
 </semantics>
</math>

 Deﬁne a random vector Z whose values are the normals to all the equations of 

<math display="inline" id="Kaczmarz_method:33">
 <semantics>
  <mrow>
   <mrow>
    <mi>A</mi>
    <mi>x</mi>
   </mrow>
   <mo>=</mo>
   <mi>b</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>A</ci>
     <ci>x</ci>
    </apply>
    <ci>b</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Ax=b
  </annotation>
 </semantics>
</math>

, with probabilities as in our algorithm:</p>

<p>

<math display="inline" id="Kaczmarz_method:34">
 <semantics>
  <mrow>
   <mi>Z</mi>
   <mo>=</mo>
   <mfrac>
    <msub>
     <mi>a</mi>
     <mi>j</mi>
    </msub>
    <mrow>
     <mo fence="true">∥</mo>
     <msub>
      <mi>a</mi>
      <mi>j</mi>
     </msub>
     <mo fence="true">∥</mo>
    </mrow>
   </mfrac>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>Z</ci>
    <apply>
     <divide></divide>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>a</ci>
      <ci>j</ci>
     </apply>
     <apply>
      <csymbol cd="latexml">norm</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>a</ci>
       <ci>j</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Z=\frac{a_{j}}{\lVert a_{j}\rVert}
  </annotation>
 </semantics>
</math>

 with probability 

<math display="inline" id="Kaczmarz_method:35">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mfrac>
      <msup>
       <mrow>
        <mo fence="true">∥</mo>
        <msub>
         <mi>a</mi>
         <mi>j</mi>
        </msub>
        <mo fence="true">∥</mo>
       </mrow>
       <mn>2</mn>
      </msup>
      <msup>
       <mrow>
        <mo fence="true">∥</mo>
        <mi>A</mi>
        <mo fence="true">∥</mo>
       </mrow>
       <mn>2</mn>
      </msup>
     </mfrac>
     <mi>j</mi>
    </mrow>
    <mo>=</mo>
    <mn>1</mn>
   </mrow>
   <mo>,</mo>
   <mrow>
    <mi mathvariant="normal">⋯</mi>
    <mo>,</mo>
    <mi>m</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <eq></eq>
     <list>
      <apply>
       <divide></divide>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="latexml">norm</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>a</ci>
          <ci>j</ci>
         </apply>
        </apply>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="latexml">norm</csymbol>
         <ci>A</ci>
        </apply>
        <cn type="integer">2</cn>
       </apply>
      </apply>
      <ci>j</ci>
     </list>
     <cn type="integer">1</cn>
    </apply>
    <list>
     <ci>normal-⋯</ci>
     <ci>m</ci>
    </list>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \frac{\lVert a_{j}\rVert^{2}}{\lVert A\rVert^{2}}\qquad\qquad\qquad j=1,\cdots,m
  </annotation>
 </semantics>
</math>

</p>

<p>Then (2) says that</p>

<p>

<math display="inline" id="Kaczmarz_method:36">
 <semantics>
  <mtable>
   <mtr>
    <mtd columnalign="right">
     <mrow>
      <mrow>
       <mi>𝔼</mi>
       <msup>
        <mrow>
         <mo stretchy="false">|</mo>
         <mrow>
          <mo stretchy="false">⟨</mo>
          <mi>z</mi>
          <mo>,</mo>
          <mi>Z</mi>
          <mo stretchy="false">⟩</mo>
         </mrow>
         <mo stretchy="false">|</mo>
        </mrow>
        <mn>2</mn>
       </msup>
      </mrow>
      <mo>≥</mo>
      <mrow>
       <mrow>
        <mi>κ</mi>
        <msup>
         <mrow>
          <mo stretchy="false">(</mo>
          <mi>A</mi>
          <mo stretchy="false">)</mo>
         </mrow>
         <mrow>
          <mo>-</mo>
          <mn>2</mn>
         </mrow>
        </msup>
        <msup>
         <mrow>
          <mo fence="true">∥</mo>
          <mi>z</mi>
          <mo fence="true">∥</mo>
         </mrow>
         <mn>2</mn>
        </msup>
       </mrow>
       <mrow>
        <mo stretchy="false">(</mo>
        <mn>3</mn>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
     </mrow>
    </mtd>
   </mtr>
  </mtable>
  <annotation-xml encoding="MathML-Content">
   <matrix>
    <matrixrow>
     <apply>
      <geq></geq>
      <apply>
       <times></times>
       <ci>𝔼</ci>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <abs></abs>
         <list>
          <ci>z</ci>
          <ci>Z</ci>
         </list>
        </apply>
        <cn type="integer">2</cn>
       </apply>
      </apply>
      <list>
       <apply>
        <times></times>
        <ci>κ</ci>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>A</ci>
         <apply>
          <minus></minus>
          <cn type="integer">2</cn>
         </apply>
        </apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <csymbol cd="latexml">norm</csymbol>
          <ci>z</ci>
         </apply>
         <cn type="integer">2</cn>
        </apply>
       </apply>
       <cn type="integer">3</cn>
      </list>
     </apply>
    </matrixrow>
   </matrix>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \begin{aligned}\displaystyle\mathbb{E}|\langle z,Z\rangle|^{2}\geq\kappa(A)^{-%
2}{\lVert z\rVert^{2}}\qquad\qquad(3)\end{aligned}
  </annotation>
 </semantics>
</math>


 for all 

<math display="inline" id="Kaczmarz_method:37">
 <semantics>
  <mrow>
   <mrow>
    <mi>z</mi>
    <mo>∈</mo>
    <msup>
     <mi>ℂ</mi>
     <mi>n</mi>
    </msup>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <in></in>
    <ci>z</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>ℂ</ci>
     <ci>n</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   z\in\mathbb{C}^{n}.
  </annotation>
 </semantics>
</math>

</p>

<p>The orthogonal projection 

<math display="inline" id="Kaczmarz_method:38">
 <semantics>
  <mi>P</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>P</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   P
  </annotation>
 </semantics>
</math>

 onto the solution space of a random equation of 

<math display="inline" id="Kaczmarz_method:39">
 <semantics>
  <mrow>
   <mrow>
    <mi>A</mi>
    <mi>x</mi>
   </mrow>
   <mo>=</mo>
   <mi>b</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>A</ci>
     <ci>x</ci>
    </apply>
    <ci>b</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Ax=b
  </annotation>
 </semantics>
</math>

 is given by 

<math display="inline" id="Kaczmarz_method:40">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>P</mi>
     <mi>z</mi>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mi>z</mi>
     <mo>-</mo>
     <mrow>
      <mrow>
       <mo stretchy="false">⟨</mo>
       <mrow>
        <mi>z</mi>
        <mo>-</mo>
        <mi>x</mi>
       </mrow>
       <mo>,</mo>
       <mi>Z</mi>
       <mo stretchy="false">⟩</mo>
      </mrow>
      <mi>Z</mi>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>P</ci>
     <ci>z</ci>
    </apply>
    <apply>
     <minus></minus>
     <ci>z</ci>
     <apply>
      <times></times>
      <list>
       <apply>
        <minus></minus>
        <ci>z</ci>
        <ci>x</ci>
       </apply>
       <ci>Z</ci>
      </list>
      <ci>Z</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Pz=z-\langle z-x,Z\rangle Z.
  </annotation>
 </semantics>
</math>

</p>

<p>Now we are ready to analyze our algorithm. We want to show that the error 

<math display="inline" id="Kaczmarz_method:41">
 <semantics>
  <msup>
   <mrow>
    <mo fence="true">∥</mo>
    <mrow>
     <msub>
      <mi>x</mi>
      <mi>k</mi>
     </msub>
     <mo>-</mo>
     <mi>x</mi>
    </mrow>
    <mo fence="true">∥</mo>
   </mrow>
   <mn>2</mn>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <apply>
     <csymbol cd="latexml">norm</csymbol>
     <apply>
      <minus></minus>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <ci>k</ci>
      </apply>
      <ci>x</ci>
     </apply>
    </apply>
    <cn type="integer">2</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   {\lVert x_{k}-x\rVert^{2}}
  </annotation>
 </semantics>
</math>


 reduces at each step in average (conditioned on the previous steps) by at least the factor of 

<math display="inline" id="Kaczmarz_method:42">
 <semantics>
  <mrow>
   <mrow>
    <mo stretchy="false">(</mo>
    <mrow>
     <mn>1</mn>
     <mo>-</mo>
     <mrow>
      <mi>κ</mi>
      <msup>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>A</mi>
        <mo stretchy="false">)</mo>
       </mrow>
       <mrow>
        <mo>-</mo>
        <mn>2</mn>
       </mrow>
      </msup>
     </mrow>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <minus></minus>
    <cn type="integer">1</cn>
    <apply>
     <times></times>
     <ci>κ</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>A</ci>
      <apply>
       <minus></minus>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (1-\kappa(A)^{-2}).
  </annotation>
 </semantics>
</math>

 The next approximation 

<math display="inline" id="Kaczmarz_method:43">
 <semantics>
  <msub>
   <mi>x</mi>
   <mi>k</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>x</ci>
    <ci>k</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x_{k}
  </annotation>
 </semantics>
</math>

 is computed from 

<math display="inline" id="Kaczmarz_method:44">
 <semantics>
  <msub>
   <mi>x</mi>
   <mrow>
    <mi>k</mi>
    <mo>-</mo>
    <mn>1</mn>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>x</ci>
    <apply>
     <minus></minus>
     <ci>k</ci>
     <cn type="integer">1</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x_{k-1}
  </annotation>
 </semantics>
</math>

 as 

<math display="inline" id="Kaczmarz_method:45">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>x</mi>
     <mi>k</mi>
    </msub>
    <mo>=</mo>
    <mrow>
     <msub>
      <mi>P</mi>
      <mi>k</mi>
     </msub>
     <msub>
      <mi>x</mi>
      <mrow>
       <mi>k</mi>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
     </msub>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>x</ci>
     <ci>k</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>P</ci>
      <ci>k</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <apply>
       <minus></minus>
       <ci>k</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x_{k}=P_{k}x_{k-1},
  </annotation>
 </semantics>
</math>

 where 

<math display="inline" id="Kaczmarz_method:46">
 <semantics>
  <mrow>
   <msub>
    <mi>P</mi>
    <mn>1</mn>
   </msub>
   <mo>,</mo>
   <msub>
    <mi>P</mi>
    <mn>2</mn>
   </msub>
   <mo>,</mo>
   <mi mathvariant="normal">⋯</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <list>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>P</ci>
     <cn type="integer">1</cn>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>P</ci>
     <cn type="integer">2</cn>
    </apply>
    <ci>normal-⋯</ci>
   </list>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   P_{1},P_{2},\cdots
  </annotation>
 </semantics>
</math>


 are independent realizations of the random projection 

<math display="inline" id="Kaczmarz_method:47">
 <semantics>
  <mrow>
   <mi>P</mi>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <ci>P</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   P.
  </annotation>
 </semantics>
</math>

 The vector 

<math display="inline" id="Kaczmarz_method:48">
 <semantics>
  <mrow>
   <msub>
    <mi>x</mi>
    <mrow>
     <mi>k</mi>
     <mo>-</mo>
     <mn>1</mn>
    </mrow>
   </msub>
   <mo>-</mo>
   <msub>
    <mi>x</mi>
    <mi>k</mi>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <minus></minus>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>x</ci>
     <apply>
      <minus></minus>
      <ci>k</ci>
      <cn type="integer">1</cn>
     </apply>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>x</ci>
     <ci>k</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x_{k-1}-x_{k}
  </annotation>
 </semantics>
</math>

 is in the kernel of 

<math display="inline" id="Kaczmarz_method:49">
 <semantics>
  <mrow>
   <msub>
    <mi>P</mi>
    <mi>k</mi>
   </msub>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>P</ci>
    <ci>k</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   P_{k}.
  </annotation>
 </semantics>
</math>

 It is orthogonal to the solution space of the equation onto which 

<math display="inline" id="Kaczmarz_method:50">
 <semantics>
  <msub>
   <mi>P</mi>
   <mi>k</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>P</ci>
    <ci>k</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   P_{k}
  </annotation>
 </semantics>
</math>

 projects, which contains the vector 

<math display="inline" id="Kaczmarz_method:51">
 <semantics>
  <mrow>
   <msub>
    <mi>x</mi>
    <mi>k</mi>
   </msub>
   <mo>-</mo>
   <mi>x</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <minus></minus>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>x</ci>
     <ci>k</ci>
    </apply>
    <ci>x</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x_{k}-x
  </annotation>
 </semantics>
</math>


 (recall that 

<math display="inline" id="Kaczmarz_method:52">
 <semantics>
  <mi>x</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>x</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x
  </annotation>
 </semantics>
</math>

 is the solution to all equations). The orthogonality of these two vectors then yields 

<math display="inline" id="Kaczmarz_method:53">
 <semantics>
  <mrow>
   <mrow>
    <msup>
     <mrow>
      <mo fence="true">∥</mo>
      <mrow>
       <msub>
        <mi>x</mi>
        <mi>k</mi>
       </msub>
       <mo>-</mo>
       <mi>x</mi>
      </mrow>
      <mo fence="true">∥</mo>
     </mrow>
     <mn>2</mn>
    </msup>
    <mo>=</mo>
    <mrow>
     <msup>
      <mrow>
       <mo fence="true">∥</mo>
       <mrow>
        <msub>
         <mi>x</mi>
         <mrow>
          <mi>k</mi>
          <mo>-</mo>
          <mn>1</mn>
         </mrow>
        </msub>
        <mo>-</mo>
        <mi>x</mi>
       </mrow>
       <mo fence="true">∥</mo>
      </mrow>
      <mn>2</mn>
     </msup>
     <mo>-</mo>
     <msup>
      <mrow>
       <mo fence="true">∥</mo>
       <mrow>
        <msub>
         <mi>x</mi>
         <mrow>
          <mi>k</mi>
          <mo>-</mo>
          <mn>1</mn>
         </mrow>
        </msub>
        <mo>-</mo>
        <msub>
         <mi>x</mi>
         <mi>k</mi>
        </msub>
       </mrow>
       <mo fence="true">∥</mo>
      </mrow>
      <mn>2</mn>
     </msup>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="latexml">norm</csymbol>
      <apply>
       <minus></minus>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <ci>k</ci>
       </apply>
       <ci>x</ci>
      </apply>
     </apply>
     <cn type="integer">2</cn>
    </apply>
    <apply>
     <minus></minus>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="latexml">norm</csymbol>
       <apply>
        <minus></minus>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>x</ci>
         <apply>
          <minus></minus>
          <ci>k</ci>
          <cn type="integer">1</cn>
         </apply>
        </apply>
        <ci>x</ci>
       </apply>
      </apply>
      <cn type="integer">2</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="latexml">norm</csymbol>
       <apply>
        <minus></minus>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>x</ci>
         <apply>
          <minus></minus>
          <ci>k</ci>
          <cn type="integer">1</cn>
         </apply>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>x</ci>
         <ci>k</ci>
        </apply>
       </apply>
      </apply>
      <cn type="integer">2</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   {\lVert x_{k}-x\rVert^{2}}={\lVert x_{k-1}-x\rVert^{2}}-{\lVert x_{k-1}-x_{k}%
\rVert^{2}}.
  </annotation>
 </semantics>
</math>

 To complete the proof, we have to bound 

<math display="inline" id="Kaczmarz_method:54">
 <semantics>
  <msup>
   <mrow>
    <mo fence="true">∥</mo>
    <mrow>
     <msub>
      <mi>x</mi>
      <mrow>
       <mi>k</mi>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
     </msub>
     <mo>-</mo>
     <msub>
      <mi>x</mi>
      <mi>k</mi>
     </msub>
    </mrow>
    <mo fence="true">∥</mo>
   </mrow>
   <mn>2</mn>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <apply>
     <csymbol cd="latexml">norm</csymbol>
     <apply>
      <minus></minus>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <apply>
        <minus></minus>
        <ci>k</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <ci>k</ci>
      </apply>
     </apply>
    </apply>
    <cn type="integer">2</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   {\lVert x_{k-1}-x_{k}\rVert^{2}}
  </annotation>
 </semantics>
</math>

 from below. By the deﬁnition of 

<math display="inline" id="Kaczmarz_method:55">
 <semantics>
  <msub>
   <mi>x</mi>
   <mi>k</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>x</ci>
    <ci>k</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x_{k}
  </annotation>
 </semantics>
</math>

, we have 

<math display="inline" id="Kaczmarz_method:56">
 <semantics>
  <mrow>
   <mrow>
    <mo fence="true">∥</mo>
    <mrow>
     <msub>
      <mi>x</mi>
      <mrow>
       <mi>k</mi>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
     </msub>
     <mo>-</mo>
     <msub>
      <mi>x</mi>
      <mi>k</mi>
     </msub>
    </mrow>
    <mo fence="true">∥</mo>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mo stretchy="false">⟨</mo>
    <mrow>
     <msub>
      <mi>x</mi>
      <mrow>
       <mi>k</mi>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
     </msub>
     <mo>-</mo>
     <mi>x</mi>
    </mrow>
    <mo>,</mo>
    <msub>
     <mi>Z</mi>
     <mi>k</mi>
    </msub>
    <mo stretchy="false">⟩</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="latexml">norm</csymbol>
     <apply>
      <minus></minus>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <apply>
        <minus></minus>
        <ci>k</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <ci>k</ci>
      </apply>
     </apply>
    </apply>
    <list>
     <apply>
      <minus></minus>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <apply>
        <minus></minus>
        <ci>k</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <ci>x</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>Z</ci>
      <ci>k</ci>
     </apply>
    </list>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   {\lVert x_{k-1}-x_{k}\rVert}=\langle x_{k-1}-x,Z_{k}\rangle
  </annotation>
 </semantics>
</math>


</p>

<p>where 

<math display="inline" id="Kaczmarz_method:57">
 <semantics>
  <mrow>
   <msub>
    <mi>Z</mi>
    <mn>1</mn>
   </msub>
   <mo>,</mo>
   <msub>
    <mi>Z</mi>
    <mn>2</mn>
   </msub>
   <mo>,</mo>
   <mi mathvariant="normal">⋯</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <list>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>Z</ci>
     <cn type="integer">1</cn>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>Z</ci>
     <cn type="integer">2</cn>
    </apply>
    <ci>normal-⋯</ci>
   </list>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Z_{1},Z_{2},\cdots
  </annotation>
 </semantics>
</math>

 are independent realizations of the random vector 

<math display="inline" id="Kaczmarz_method:58">
 <semantics>
  <mrow>
   <mi>Z</mi>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <ci>Z</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Z.
  </annotation>
 </semantics>
</math>

</p>

<p>Thus 

<math display="inline" id="Kaczmarz_method:59">
 <semantics>
  <mrow>
   <mrow>
    <msup>
     <mrow>
      <mo fence="true">∥</mo>
      <mrow>
       <msub>
        <mi>x</mi>
        <mi>k</mi>
       </msub>
       <mo>-</mo>
       <mi>x</mi>
      </mrow>
      <mo fence="true">∥</mo>
     </mrow>
     <mn>2</mn>
    </msup>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mo>(</mo>
      <mrow>
       <mn>1</mn>
       <mo>-</mo>
       <msup>
        <mrow>
         <mo>|</mo>
         <mrow>
          <mo>⟨</mo>
          <mfrac>
           <mrow>
            <msub>
             <mi>x</mi>
             <mrow>
              <mi>k</mi>
              <mo>-</mo>
              <mn>1</mn>
             </mrow>
            </msub>
            <mo>-</mo>
            <mi>x</mi>
           </mrow>
           <mrow>
            <mo fence="true">∥</mo>
            <mrow>
             <msub>
              <mi>x</mi>
              <mrow>
               <mi>k</mi>
               <mo>-</mo>
               <mn>1</mn>
              </mrow>
             </msub>
             <mo>-</mo>
             <mi>x</mi>
            </mrow>
            <mo fence="true">∥</mo>
           </mrow>
          </mfrac>
          <mo>,</mo>
          <msub>
           <mi>Z</mi>
           <mi>k</mi>
          </msub>
          <mo>⟩</mo>
         </mrow>
         <mo>|</mo>
        </mrow>
        <mn>2</mn>
       </msup>
      </mrow>
      <mo>)</mo>
     </mrow>
     <msup>
      <mrow>
       <mo fence="true">∥</mo>
       <mrow>
        <msub>
         <mi>x</mi>
         <mrow>
          <mi>k</mi>
          <mo>-</mo>
          <mn>1</mn>
         </mrow>
        </msub>
        <mo>-</mo>
        <mi>x</mi>
       </mrow>
       <mo fence="true">∥</mo>
      </mrow>
      <mn>2</mn>
     </msup>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="latexml">norm</csymbol>
      <apply>
       <minus></minus>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <ci>k</ci>
       </apply>
       <ci>x</ci>
      </apply>
     </apply>
     <cn type="integer">2</cn>
    </apply>
    <apply>
     <times></times>
     <apply>
      <minus></minus>
      <cn type="integer">1</cn>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <abs></abs>
        <list>
         <apply>
          <divide></divide>
          <apply>
           <minus></minus>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <ci>x</ci>
            <apply>
             <minus></minus>
             <ci>k</ci>
             <cn type="integer">1</cn>
            </apply>
           </apply>
           <ci>x</ci>
          </apply>
          <apply>
           <csymbol cd="latexml">norm</csymbol>
           <apply>
            <minus></minus>
            <apply>
             <csymbol cd="ambiguous">subscript</csymbol>
             <ci>x</ci>
             <apply>
              <minus></minus>
              <ci>k</ci>
              <cn type="integer">1</cn>
             </apply>
            </apply>
            <ci>x</ci>
           </apply>
          </apply>
         </apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>Z</ci>
          <ci>k</ci>
         </apply>
        </list>
       </apply>
       <cn type="integer">2</cn>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="latexml">norm</csymbol>
       <apply>
        <minus></minus>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>x</ci>
         <apply>
          <minus></minus>
          <ci>k</ci>
          <cn type="integer">1</cn>
         </apply>
        </apply>
        <ci>x</ci>
       </apply>
      </apply>
      <cn type="integer">2</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   {\lVert x_{k}-x\rVert^{2}}=\left(1-\left|\left\langle\frac{x_{k-1}-x}{\lVert x%
_{k-1}-x\rVert},Z_{k}\right\rangle\right|^{2}\right){\lVert x_{k-1}-x\rVert^{2%
}}.
  </annotation>
 </semantics>
</math>

</p>

<p>Now we take the expectation of both sides conditional upon the choice of the random vectors 

<math display="inline" id="Kaczmarz_method:60">
 <semantics>
  <mrow>
   <msub>
    <mi>Z</mi>
    <mn>1</mn>
   </msub>
   <mo>,</mo>
   <mi mathvariant="normal">⋯</mi>
   <mo>,</mo>
   <msub>
    <mi>Z</mi>
    <mrow>
     <mi>k</mi>
     <mo>-</mo>
     <mn>1</mn>
    </mrow>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <list>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>Z</ci>
     <cn type="integer">1</cn>
    </apply>
    <ci>normal-⋯</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>Z</ci>
     <apply>
      <minus></minus>
      <ci>k</ci>
      <cn type="integer">1</cn>
     </apply>
    </apply>
   </list>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Z_{1},\cdots,Z_{k-1}
  </annotation>
 </semantics>
</math>

 (hence we ﬁx the choice of the random projections 

<math display="inline" id="Kaczmarz_method:61">
 <semantics>
  <mrow>
   <msub>
    <mi>P</mi>
    <mn>1</mn>
   </msub>
   <mo>,</mo>
   <mi mathvariant="normal">⋯</mi>
   <mo>,</mo>
   <msub>
    <mi>P</mi>
    <mrow>
     <mi>k</mi>
     <mo>-</mo>
     <mn>1</mn>
    </mrow>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <list>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>P</ci>
     <cn type="integer">1</cn>
    </apply>
    <ci>normal-⋯</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>P</ci>
     <apply>
      <minus></minus>
      <ci>k</ci>
      <cn type="integer">1</cn>
     </apply>
    </apply>
   </list>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   P_{1},\cdots,P_{k-1}
  </annotation>
 </semantics>
</math>


 and thus the random vectors 

<math display="inline" id="Kaczmarz_method:62">
 <semantics>
  <mrow>
   <msub>
    <mi>x</mi>
    <mn>1</mn>
   </msub>
   <mo>,</mo>
   <mi mathvariant="normal">⋯</mi>
   <mo>,</mo>
   <msub>
    <mi>x</mi>
    <mrow>
     <mi>k</mi>
     <mo>-</mo>
     <mn>1</mn>
    </mrow>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <list>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>x</ci>
     <cn type="integer">1</cn>
    </apply>
    <ci>normal-⋯</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>x</ci>
     <apply>
      <minus></minus>
      <ci>k</ci>
      <cn type="integer">1</cn>
     </apply>
    </apply>
   </list>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x_{1},\cdots,x_{k-1}
  </annotation>
 </semantics>
</math>

 and we average over the random vector 

<math display="inline" id="Kaczmarz_method:63">
 <semantics>
  <msub>
   <mi>Z</mi>
   <mi>k</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>Z</ci>
    <ci>k</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Z_{k}
  </annotation>
 </semantics>
</math>

). Then</p>

<p>

<math display="inline" id="Kaczmarz_method:64">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <msub>
      <mi>𝔼</mi>
      <mrow>
       <msub>
        <mi>Z</mi>
        <mn>1</mn>
       </msub>
       <mo>,</mo>
       <mi mathvariant="normal">⋯</mi>
       <mo>,</mo>
       <msub>
        <mi>Z</mi>
        <mrow>
         <mi>k</mi>
         <mo>-</mo>
         <mn>1</mn>
        </mrow>
       </msub>
      </mrow>
     </msub>
     <msup>
      <mrow>
       <mo fence="true">∥</mo>
       <mrow>
        <msub>
         <mi>x</mi>
         <mi>k</mi>
        </msub>
        <mo>-</mo>
        <mi>x</mi>
       </mrow>
       <mo fence="true">∥</mo>
      </mrow>
      <mn>2</mn>
     </msup>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mo>(</mo>
      <mrow>
       <mn>1</mn>
       <mo>-</mo>
       <mrow>
        <msub>
         <mi>𝔼</mi>
         <mrow>
          <msub>
           <mi>Z</mi>
           <mn>1</mn>
          </msub>
          <mo>,</mo>
          <mi mathvariant="normal">⋯</mi>
          <mo>,</mo>
          <msub>
           <mi>Z</mi>
           <mrow>
            <mi>k</mi>
            <mo>-</mo>
            <mn>1</mn>
           </mrow>
          </msub>
         </mrow>
        </msub>
        <msup>
         <mrow>
          <mo>|</mo>
          <mrow>
           <mo>⟨</mo>
           <mfrac>
            <mrow>
             <msub>
              <mi>x</mi>
              <mrow>
               <mi>k</mi>
               <mo>-</mo>
               <mn>1</mn>
              </mrow>
             </msub>
             <mo>-</mo>
             <mi>x</mi>
            </mrow>
            <mrow>
             <mo fence="true">∥</mo>
             <mrow>
              <msub>
               <mi>x</mi>
               <mrow>
                <mi>k</mi>
                <mo>-</mo>
                <mn>1</mn>
               </mrow>
              </msub>
              <mo>-</mo>
              <mi>x</mi>
             </mrow>
             <mo fence="true">∥</mo>
            </mrow>
           </mfrac>
           <mo>,</mo>
           <msub>
            <mi>Z</mi>
            <mi>k</mi>
           </msub>
           <mo>⟩</mo>
          </mrow>
          <mo>|</mo>
         </mrow>
         <mn>2</mn>
        </msup>
       </mrow>
      </mrow>
      <mo>)</mo>
     </mrow>
     <msup>
      <mrow>
       <mo fence="true">∥</mo>
       <mrow>
        <msub>
         <mi>x</mi>
         <mrow>
          <mi>k</mi>
          <mo>-</mo>
          <mn>1</mn>
         </mrow>
        </msub>
        <mo>-</mo>
        <mi>x</mi>
       </mrow>
       <mo fence="true">∥</mo>
      </mrow>
      <mn>2</mn>
     </msup>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>𝔼</ci>
      <list>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>Z</ci>
        <cn type="integer">1</cn>
       </apply>
       <ci>normal-⋯</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>Z</ci>
        <apply>
         <minus></minus>
         <ci>k</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
      </list>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="latexml">norm</csymbol>
       <apply>
        <minus></minus>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>x</ci>
         <ci>k</ci>
        </apply>
        <ci>x</ci>
       </apply>
      </apply>
      <cn type="integer">2</cn>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <minus></minus>
      <cn type="integer">1</cn>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>𝔼</ci>
        <list>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>Z</ci>
          <cn type="integer">1</cn>
         </apply>
         <ci>normal-⋯</ci>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>Z</ci>
          <apply>
           <minus></minus>
           <ci>k</ci>
           <cn type="integer">1</cn>
          </apply>
         </apply>
        </list>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <abs></abs>
         <list>
          <apply>
           <divide></divide>
           <apply>
            <minus></minus>
            <apply>
             <csymbol cd="ambiguous">subscript</csymbol>
             <ci>x</ci>
             <apply>
              <minus></minus>
              <ci>k</ci>
              <cn type="integer">1</cn>
             </apply>
            </apply>
            <ci>x</ci>
           </apply>
           <apply>
            <csymbol cd="latexml">norm</csymbol>
            <apply>
             <minus></minus>
             <apply>
              <csymbol cd="ambiguous">subscript</csymbol>
              <ci>x</ci>
              <apply>
               <minus></minus>
               <ci>k</ci>
               <cn type="integer">1</cn>
              </apply>
             </apply>
             <ci>x</ci>
            </apply>
           </apply>
          </apply>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>Z</ci>
           <ci>k</ci>
          </apply>
         </list>
        </apply>
        <cn type="integer">2</cn>
       </apply>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="latexml">norm</csymbol>
       <apply>
        <minus></minus>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>x</ci>
         <apply>
          <minus></minus>
          <ci>k</ci>
          <cn type="integer">1</cn>
         </apply>
        </apply>
        <ci>x</ci>
       </apply>
      </apply>
      <cn type="integer">2</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbb{E}_{{Z_{1},\cdots,Z_{k-1}}}{\lVert x_{k}-x\rVert^{2}}=\left(1-\mathbb{%
E}_{{Z_{1},\cdots,Z_{k-1}}}\left|\left\langle\frac{x_{k-1}-x}{\lVert x_{k-1}-x%
\rVert},Z_{k}\right\rangle\right|^{2}\right){\lVert x_{k-1}-x\rVert^{2}}.
  </annotation>
 </semantics>
</math>

</p>

<p>By (3) and the independence,</p>

<p>

<math display="inline" id="Kaczmarz_method:65">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <msub>
      <mi>𝔼</mi>
      <mrow>
       <msub>
        <mi>Z</mi>
        <mn>1</mn>
       </msub>
       <mo>,</mo>
       <mi mathvariant="normal">⋯</mi>
       <mo>,</mo>
       <msub>
        <mi>Z</mi>
        <mrow>
         <mi>k</mi>
         <mo>-</mo>
         <mn>1</mn>
        </mrow>
       </msub>
      </mrow>
     </msub>
     <msup>
      <mrow>
       <mo fence="true">∥</mo>
       <mrow>
        <msub>
         <mi>x</mi>
         <mi>k</mi>
        </msub>
        <mo>-</mo>
        <mi>x</mi>
       </mrow>
       <mo fence="true">∥</mo>
      </mrow>
      <mn>2</mn>
     </msup>
    </mrow>
    <mo>≤</mo>
    <mrow>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mn>1</mn>
       <mo>-</mo>
       <mrow>
        <mi>κ</mi>
        <msup>
         <mrow>
          <mo stretchy="false">(</mo>
          <mi>A</mi>
          <mo stretchy="false">)</mo>
         </mrow>
         <mrow>
          <mo>-</mo>
          <mn>2</mn>
         </mrow>
        </msup>
       </mrow>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <msup>
      <mrow>
       <mo fence="true">∥</mo>
       <mrow>
        <msub>
         <mi>x</mi>
         <mrow>
          <mi>k</mi>
          <mo>-</mo>
          <mn>1</mn>
         </mrow>
        </msub>
        <mo>-</mo>
        <mi>x</mi>
       </mrow>
       <mo fence="true">∥</mo>
      </mrow>
      <mn>2</mn>
     </msup>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <leq></leq>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>𝔼</ci>
      <list>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>Z</ci>
        <cn type="integer">1</cn>
       </apply>
       <ci>normal-⋯</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>Z</ci>
        <apply>
         <minus></minus>
         <ci>k</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
      </list>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="latexml">norm</csymbol>
       <apply>
        <minus></minus>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>x</ci>
         <ci>k</ci>
        </apply>
        <ci>x</ci>
       </apply>
      </apply>
      <cn type="integer">2</cn>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <minus></minus>
      <cn type="integer">1</cn>
      <apply>
       <times></times>
       <ci>κ</ci>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>A</ci>
        <apply>
         <minus></minus>
         <cn type="integer">2</cn>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="latexml">norm</csymbol>
       <apply>
        <minus></minus>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>x</ci>
         <apply>
          <minus></minus>
          <ci>k</ci>
          <cn type="integer">1</cn>
         </apply>
        </apply>
        <ci>x</ci>
       </apply>
      </apply>
      <cn type="integer">2</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbb{E}_{{Z_{1},\cdots,Z_{k-1}}}{\lVert x_{k}-x\rVert^{2}}\leq(1-\kappa(A)^%
{-2}){\lVert x_{k-1}-x\rVert^{2}}.
  </annotation>
 </semantics>
</math>

</p>

<p>Taking the full expectation of both sides, we conclude that</p>

<p>

<math display="inline" id="Kaczmarz_method:66">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>𝔼</mi>
     <msup>
      <mrow>
       <mo fence="true">∥</mo>
       <mrow>
        <msub>
         <mi>x</mi>
         <mi>k</mi>
        </msub>
        <mo>-</mo>
        <mi>x</mi>
       </mrow>
       <mo fence="true">∥</mo>
      </mrow>
      <mn>2</mn>
     </msup>
    </mrow>
    <mo>≤</mo>
    <mrow>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mn>1</mn>
       <mo>-</mo>
       <mrow>
        <mi>κ</mi>
        <msup>
         <mrow>
          <mo stretchy="false">(</mo>
          <mi>A</mi>
          <mo stretchy="false">)</mo>
         </mrow>
         <mrow>
          <mo>-</mo>
          <mn>2</mn>
         </mrow>
        </msup>
       </mrow>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <mi>𝔼</mi>
     <msup>
      <mrow>
       <mo fence="true">∥</mo>
       <mrow>
        <msub>
         <mi>x</mi>
         <mrow>
          <mi>k</mi>
          <mo>-</mo>
          <mn>1</mn>
         </mrow>
        </msub>
        <mo>-</mo>
        <mi>x</mi>
       </mrow>
       <mo fence="true">∥</mo>
      </mrow>
      <mn>2</mn>
     </msup>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <leq></leq>
    <apply>
     <times></times>
     <ci>𝔼</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="latexml">norm</csymbol>
       <apply>
        <minus></minus>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>x</ci>
         <ci>k</ci>
        </apply>
        <ci>x</ci>
       </apply>
      </apply>
      <cn type="integer">2</cn>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <minus></minus>
      <cn type="integer">1</cn>
      <apply>
       <times></times>
       <ci>κ</ci>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>A</ci>
        <apply>
         <minus></minus>
         <cn type="integer">2</cn>
        </apply>
       </apply>
      </apply>
     </apply>
     <ci>𝔼</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="latexml">norm</csymbol>
       <apply>
        <minus></minus>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>x</ci>
         <apply>
          <minus></minus>
          <ci>k</ci>
          <cn type="integer">1</cn>
         </apply>
        </apply>
        <ci>x</ci>
       </apply>
      </apply>
      <cn type="integer">2</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbb{E}{\lVert x_{k}-x\rVert^{2}}\leq(1-\kappa(A)^{-2})\mathbb{E}{\lVert x_%
{k-1}-x\rVert^{2}}.
  </annotation>
 </semantics>
</math>


 

<math display="inline" id="Kaczmarz_method:67">
 <semantics>
  <mi mathvariant="normal">■</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>normal-■</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \blacksquare
  </annotation>
 </semantics>
</math>

</p>

<p>The superiority of this selection was illustrated with the reconstruction of a bandlimited function from its nonuniformly spaced sampling values. However, it has been pointed out<a class="footnoteRef" href="#fn10" id="fnref10"><sup>10</sup></a> that the reported success by Strohmer and Vershynin depends on the specific choices that were made there in translating the underlying problem, whose geometrical nature is to <em>find a common point of a set of hyperplanes</em>, into a system of algebraic equations. There will always be legitimate algebraic representations of the underlying problem for which the selection method in <a class="footnoteRef" href="#fn11" id="fnref11"><sup>11</sup></a> will perform in an inferior manner.<a class="footnoteRef" href="#fn12" id="fnref12"><sup>12</sup></a><a class="footnoteRef" href="#fn13" id="fnref13"><sup>13</sup></a><a class="footnoteRef" href="#fn14" id="fnref14"><sup>14</sup></a></p>
<h2 id="notes">Notes</h2>
<h2 id="references">References</h2>
<ul>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
</ul>
<ul>
<li></li>
<li></li>
<li></li>
</ul>
<h2 id="external-links">External links</h2>
<ul>
<li><a href="http://www.eecs.berkeley.edu/~brecht/cs294docs/week1/09.Strohmer.pdf">1</a> A randomized Kaczmarz algorithm with exponential convergence</li>
<li><a href="http://www-personal.umich.edu/~romanv/papers/kaczmarz-comments.pdf">2</a> Comments on the randomized Kaczmarz method</li>
</ul>

<p>"</p>

<p><a href="Category:Medical_imaging" title="wikilink">Category:Medical imaging</a> <a href="Category:Numerical_linear_algebra" title="wikilink">Category:Numerical linear algebra</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1"><a href="#fnref1">↩</a></li>
<li id="fn2"><a href="#fnref2">↩</a></li>
<li id="fn3"><a href="#fnref3">↩</a></li>
<li id="fn4"><a href="#fnref4">↩</a></li>
<li id="fn5"><a href="#fnref5">↩</a></li>
<li id="fn6"><a href="#fnref6">↩</a></li>
<li id="fn7">See  and references therein.<a href="#fnref7">↩</a></li>
<li id="fn8"><a href="#fnref8">↩</a></li>
<li id="fn9"><a href="#fnref9">↩</a></li>
<li id="fn10"><a href="#fnref10">↩</a></li>
<li id="fn11"></li>
<li id="fn12"></li>
<li id="fn13"></li>
<li id="fn14"><a href="#fnref14">↩</a></li>
</ol>
</section>
</body>
</html>

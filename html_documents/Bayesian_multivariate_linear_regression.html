<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="1557">Bayesian multivariate linear regression</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Bayesian multivariate linear regression</h1>
<hr/>

<p>In <a class="uri" href="statistics" title="wikilink">statistics</a>, <strong>Bayesian multivariate linear regression</strong> is a <a href="Bayesian_inference" title="wikilink">Bayesian</a> approach to <a href="multivariate_linear_regression" title="wikilink">multivariate linear regression</a>, i.e. <a href="linear_regression" title="wikilink">linear regression</a> where the predicted outcome is a vector of correlated <a href="random_variable" title="wikilink">random variables</a> rather than a single scalar random variable. A more general treatment of this approach can be found in the article <a href="MMSE_estimator" title="wikilink">MMSE estimator</a>.</p>
<h2 id="details">Details</h2>

<p>Consider a regression problem where the <a href="dependent_variable" title="wikilink">dependent variable</a> to be predicted is not a single <a class="uri" href="real-valued" title="wikilink">real-valued</a> scalar but an <em>m</em>-length vector of correlated real numbers. As in the standard regression setup, there are <em>n</em> observations, where each observation <em>i</em> consists of <em>k</em>-1 <a href="explanatory_variable" title="wikilink">explanatory variables</a>, grouped into a vector 

<math display="inline" id="Bayesian_multivariate_linear_regression:0">
 <semantics>
  <msub>
   <mi>𝐱</mi>
   <mi>i</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>𝐱</ci>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{x}_{i}
  </annotation>
 </semantics>
</math>

 of length <em>k</em> (where a <a href="dummy_variable_(statistics)" title="wikilink">dummy variable</a> with a value of 1 has been added to allow for an intercept coefficient). This can be viewed as a set of <em>m</em> related regression problems for each observation <em>i</em>:</p>

<p>

<math display="block" id="Bayesian_multivariate_linear_regression:1">
 <semantics>
  <mrow>
   <msub>
    <mi>y</mi>
    <mrow>
     <mi>i</mi>
     <mo>,</mo>
     <mn>1</mn>
    </mrow>
   </msub>
   <mo>=</mo>
   <mrow>
    <mrow>
     <msubsup>
      <mi>𝐱</mi>
      <mi>i</mi>
      <mi mathvariant="normal">T</mi>
     </msubsup>
     <msub>
      <mi>𝜷</mi>
      <mn>1</mn>
     </msub>
    </mrow>
    <mo>+</mo>
    <msub>
     <mi>ϵ</mi>
     <mrow>
      <mi>i</mi>
      <mo>,</mo>
      <mn>1</mn>
     </mrow>
    </msub>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>y</ci>
     <list>
      <ci>i</ci>
      <cn type="integer">1</cn>
     </list>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>𝐱</ci>
        <ci>i</ci>
       </apply>
       <ci>normal-T</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>𝜷</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>ϵ</ci>
      <list>
       <ci>i</ci>
       <cn type="integer">1</cn>
      </list>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   y_{i,1}=\mathbf{x}_{i}^{\rm T}\boldsymbol{\beta}_{1}+\epsilon_{i,1}
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Bayesian_multivariate_linear_regression:2">
 <semantics>
  <mi mathvariant="normal">⋯</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>normal-⋯</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \cdots
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Bayesian_multivariate_linear_regression:3">
 <semantics>
  <mrow>
   <msub>
    <mi>y</mi>
    <mrow>
     <mi>i</mi>
     <mo>,</mo>
     <mi>m</mi>
    </mrow>
   </msub>
   <mo>=</mo>
   <mrow>
    <mrow>
     <msubsup>
      <mi>𝐱</mi>
      <mi>i</mi>
      <mi mathvariant="normal">T</mi>
     </msubsup>
     <msub>
      <mi>𝜷</mi>
      <mi>m</mi>
     </msub>
    </mrow>
    <mo>+</mo>
    <msub>
     <mi>ϵ</mi>
     <mrow>
      <mi>i</mi>
      <mo>,</mo>
      <mi>m</mi>
     </mrow>
    </msub>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>y</ci>
     <list>
      <ci>i</ci>
      <ci>m</ci>
     </list>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>𝐱</ci>
        <ci>i</ci>
       </apply>
       <ci>normal-T</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>𝜷</ci>
       <ci>m</ci>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>ϵ</ci>
      <list>
       <ci>i</ci>
       <ci>m</ci>
      </list>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   y_{i,m}=\mathbf{x}_{i}^{\rm T}\boldsymbol{\beta}_{m}+\epsilon_{i,m}
  </annotation>
 </semantics>
</math>

</p>

<p>where the set of errors 

<math display="inline" id="Bayesian_multivariate_linear_regression:4">
 <semantics>
  <mrow>
   <mo stretchy="false">{</mo>
   <msub>
    <mi>ϵ</mi>
    <mrow>
     <mi>i</mi>
     <mo>,</mo>
     <mn>1</mn>
    </mrow>
   </msub>
   <mo>,</mo>
   <mi mathvariant="normal">…</mi>
   <mo>,</mo>
   <msub>
    <mi>ϵ</mi>
    <mrow>
     <mi>i</mi>
     <mo>,</mo>
     <mi>m</mi>
    </mrow>
   </msub>
   <mo stretchy="false">}</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <set>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>ϵ</ci>
     <list>
      <ci>i</ci>
      <cn type="integer">1</cn>
     </list>
    </apply>
    <ci>normal-…</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>ϵ</ci>
     <list>
      <ci>i</ci>
      <ci>m</ci>
     </list>
    </apply>
   </set>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \{\epsilon_{i,1},\ldots,\epsilon_{i,m}\}
  </annotation>
 </semantics>
</math>

 are all correlated. Equivalently, it can be viewed as a single regression problem where the outcome is a <a href="row_vector" title="wikilink">row vector</a> 

<math display="inline" id="Bayesian_multivariate_linear_regression:5">
 <semantics>
  <msubsup>
   <mi>𝐲</mi>
   <mi>i</mi>
   <mi mathvariant="normal">T</mi>
  </msubsup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>𝐲</ci>
     <ci>i</ci>
    </apply>
    <ci>normal-T</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{y}_{i}^{\rm T}
  </annotation>
 </semantics>
</math>

 and the regression coefficient vectors are stacked next to each other, as follows:</p>

<p>

<math display="block" id="Bayesian_multivariate_linear_regression:6">
 <semantics>
  <mrow>
   <mrow>
    <msubsup>
     <mi>𝐲</mi>
     <mi>i</mi>
     <mi mathvariant="normal">T</mi>
    </msubsup>
    <mo>=</mo>
    <mrow>
     <mrow>
      <msubsup>
       <mi>𝐱</mi>
       <mi>i</mi>
       <mi mathvariant="normal">T</mi>
      </msubsup>
      <mi>𝐁</mi>
     </mrow>
     <mo>+</mo>
     <msubsup>
      <mi mathvariant="bold-italic">ϵ</mi>
      <mi>i</mi>
      <mi mathvariant="normal">T</mi>
     </msubsup>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>𝐲</ci>
      <ci>i</ci>
     </apply>
     <ci>normal-T</ci>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>𝐱</ci>
        <ci>i</ci>
       </apply>
       <ci>normal-T</ci>
      </apply>
      <ci>𝐁</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>bold-italic-ϵ</ci>
       <ci>i</ci>
      </apply>
      <ci>normal-T</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{y}_{i}^{\rm T}=\mathbf{x}_{i}^{\rm T}\mathbf{B}+\boldsymbol{\epsilon}_%
{i}^{\rm T}.
  </annotation>
 </semantics>
</math>

</p>

<p>The coefficient matrix <strong>B</strong> is a 

<math display="inline" id="Bayesian_multivariate_linear_regression:7">
 <semantics>
  <mrow>
   <mi>k</mi>
   <mo>×</mo>
   <mi>m</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>k</ci>
    <ci>m</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   k\times m
  </annotation>
 </semantics>
</math>


 matrix where the coefficient vectors 

<math display="inline" id="Bayesian_multivariate_linear_regression:8">
 <semantics>
  <mrow>
   <msub>
    <mi>𝜷</mi>
    <mn>1</mn>
   </msub>
   <mo>,</mo>
   <mi mathvariant="normal">…</mi>
   <mo>,</mo>
   <msub>
    <mi>𝜷</mi>
    <mi>m</mi>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <list>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>𝜷</ci>
     <cn type="integer">1</cn>
    </apply>
    <ci>normal-…</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>𝜷</ci>
     <ci>m</ci>
    </apply>
   </list>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \boldsymbol{\beta}_{1},\ldots,\boldsymbol{\beta}_{m}
  </annotation>
 </semantics>
</math>

 for each regression problem are stacked horizontally:</p>

<p>

<math display="block" id="Bayesian_multivariate_linear_regression:9">
 <semantics>
  <mrow>
   <mrow>
    <mi>𝐁</mi>
    <mo>=</mo>
    <mrow>
     <mo>[</mo>
     <mtable displaystyle="true">
      <mtr>
       <mtd columnalign="center">
        <mrow>
         <mrow>
          <mo>(</mo>
          <mtable displaystyle="true">
           <mtr>
            <mtd columnalign="center">
             <mi></mi>
            </mtd>
           </mtr>
           <mtr>
            <mtd columnalign="center">
             <msub>
              <mi>𝜷</mi>
              <mn>1</mn>
             </msub>
            </mtd>
           </mtr>
           <mtr>
            <mtd columnalign="center">
             <mi></mi>
            </mtd>
           </mtr>
          </mtable>
          <mo>)</mo>
         </mrow>
         <mi mathvariant="normal">⋯</mi>
         <mrow>
          <mo>(</mo>
          <mtable displaystyle="true">
           <mtr>
            <mtd columnalign="center">
             <mi></mi>
            </mtd>
           </mtr>
           <mtr>
            <mtd columnalign="center">
             <msub>
              <mi>𝜷</mi>
              <mi>m</mi>
             </msub>
            </mtd>
           </mtr>
           <mtr>
            <mtd columnalign="center">
             <mi></mi>
            </mtd>
           </mtr>
          </mtable>
          <mo>)</mo>
         </mrow>
        </mrow>
       </mtd>
      </mtr>
     </mtable>
     <mo>]</mo>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mo>[</mo>
     <mtable displaystyle="true">
      <mtr>
       <mtd columnalign="center">
        <mrow>
         <mrow>
          <mo>(</mo>
          <mtable displaystyle="true">
           <mtr>
            <mtd columnalign="center">
             <msub>
              <mi>β</mi>
              <mrow>
               <mn>1</mn>
               <mo>,</mo>
               <mn>1</mn>
              </mrow>
             </msub>
            </mtd>
           </mtr>
           <mtr>
            <mtd columnalign="center">
             <mi mathvariant="normal">⋮</mi>
            </mtd>
           </mtr>
           <mtr>
            <mtd columnalign="center">
             <msub>
              <mi>β</mi>
              <mrow>
               <mi>k</mi>
               <mo>,</mo>
               <mn>1</mn>
              </mrow>
             </msub>
            </mtd>
           </mtr>
          </mtable>
          <mo>)</mo>
         </mrow>
         <mi mathvariant="normal">⋯</mi>
         <mrow>
          <mo>(</mo>
          <mtable displaystyle="true">
           <mtr>
            <mtd columnalign="center">
             <msub>
              <mi>β</mi>
              <mrow>
               <mn>1</mn>
               <mo>,</mo>
               <mi>m</mi>
              </mrow>
             </msub>
            </mtd>
           </mtr>
           <mtr>
            <mtd columnalign="center">
             <mi mathvariant="normal">⋮</mi>
            </mtd>
           </mtr>
           <mtr>
            <mtd columnalign="center">
             <msub>
              <mi>β</mi>
              <mrow>
               <mi>k</mi>
               <mo>,</mo>
               <mi>m</mi>
              </mrow>
             </msub>
            </mtd>
           </mtr>
          </mtable>
          <mo>)</mo>
         </mrow>
        </mrow>
       </mtd>
      </mtr>
     </mtable>
     <mo>]</mo>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <ci>𝐁</ci>
     <matrix>
      <matrixrow>
       <apply>
        <times></times>
        <matrix>
         <matrixrow>
          <csymbol cd="latexml">absent</csymbol>
         </matrixrow>
         <matrixrow>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>𝜷</ci>
           <cn type="integer">1</cn>
          </apply>
         </matrixrow>
         <matrixrow>
          <csymbol cd="latexml">absent</csymbol>
         </matrixrow>
        </matrix>
        <ci>normal-⋯</ci>
        <matrix>
         <matrixrow>
          <csymbol cd="latexml">absent</csymbol>
         </matrixrow>
         <matrixrow>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>𝜷</ci>
           <ci>m</ci>
          </apply>
         </matrixrow>
         <matrixrow>
          <csymbol cd="latexml">absent</csymbol>
         </matrixrow>
        </matrix>
       </apply>
      </matrixrow>
     </matrix>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <matrix>
      <matrixrow>
       <apply>
        <times></times>
        <matrix>
         <matrixrow>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>β</ci>
           <list>
            <cn type="integer">1</cn>
            <cn type="integer">1</cn>
           </list>
          </apply>
         </matrixrow>
         <matrixrow>
          <ci>normal-⋮</ci>
         </matrixrow>
         <matrixrow>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>β</ci>
           <list>
            <ci>k</ci>
            <cn type="integer">1</cn>
           </list>
          </apply>
         </matrixrow>
        </matrix>
        <ci>normal-⋯</ci>
        <matrix>
         <matrixrow>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>β</ci>
           <list>
            <cn type="integer">1</cn>
            <ci>m</ci>
           </list>
          </apply>
         </matrixrow>
         <matrixrow>
          <ci>normal-⋮</ci>
         </matrixrow>
         <matrixrow>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>β</ci>
           <list>
            <ci>k</ci>
            <ci>m</ci>
           </list>
          </apply>
         </matrixrow>
        </matrix>
       </apply>
      </matrixrow>
     </matrix>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{B}=\begin{bmatrix}\begin{pmatrix}\\
\boldsymbol{\beta}_{1}\\
\\
\end{pmatrix}\cdots\begin{pmatrix}\\
\boldsymbol{\beta}_{m}\\
\\
\end{pmatrix}\end{bmatrix}=\begin{bmatrix}\begin{pmatrix}\beta_{1,1}\\
\vdots\\
\beta_{k,1}\\
\end{pmatrix}\cdots\begin{pmatrix}\beta_{1,m}\\
\vdots\\
\beta_{k,m}\\
\end{pmatrix}\end{bmatrix}.
  </annotation>
 </semantics>
</math>

</p>

<p>The noise vector 

<math display="inline" id="Bayesian_multivariate_linear_regression:10">
 <semantics>
  <msub>
   <mi mathvariant="bold-italic">ϵ</mi>
   <mi>i</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>bold-italic-ϵ</ci>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \boldsymbol{\epsilon}_{i}
  </annotation>
 </semantics>
</math>

 for each observation <em>i</em> is jointly normal, so that the outcomes for a given observation are correlated:</p>

<p>

<math display="block" id="Bayesian_multivariate_linear_regression:11">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi mathvariant="bold-italic">ϵ</mi>
     <mi>i</mi>
    </msub>
    <mo>∼</mo>
    <mrow>
     <mi>N</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mn>0</mn>
      <mo>,</mo>
      <msubsup>
       <mi>𝚺</mi>
       <mi>ϵ</mi>
       <mn>2</mn>
      </msubsup>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">similar-to</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>bold-italic-ϵ</ci>
     <ci>i</ci>
    </apply>
    <apply>
     <times></times>
     <ci>N</ci>
     <interval closure="open">
      <cn type="integer">0</cn>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>𝚺</ci>
        <ci>ϵ</ci>
       </apply>
       <cn type="integer">2</cn>
      </apply>
     </interval>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \boldsymbol{\epsilon}_{i}\sim N(0,\boldsymbol{\Sigma}_{\epsilon}^{2}).
  </annotation>
 </semantics>
</math>

</p>

<p>We can write the entire regression problem in matrix form as:</p>

<p>

<math display="block" id="Bayesian_multivariate_linear_regression:12">
 <semantics>
  <mrow>
   <mrow>
    <mi>𝐘</mi>
    <mo>=</mo>
    <mrow>
     <mi>𝐗𝐁</mi>
     <mo>+</mo>
     <mi>𝐄</mi>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>𝐘</ci>
    <apply>
     <plus></plus>
     <ci>𝐗𝐁</ci>
     <ci>𝐄</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{Y}=\mathbf{X}\mathbf{B}+\mathbf{E},
  </annotation>
 </semantics>
</math>

</p>

<p>where <strong>Y</strong> and <strong>E</strong> are 

<math display="inline" id="Bayesian_multivariate_linear_regression:13">
 <semantics>
  <mrow>
   <mi>n</mi>
   <mo>×</mo>
   <mi>m</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>n</ci>
    <ci>m</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n\times m
  </annotation>
 </semantics>
</math>

 matrices. The <a href="design_matrix" title="wikilink">design matrix</a> <strong>X</strong> is an 

<math display="inline" id="Bayesian_multivariate_linear_regression:14">
 <semantics>
  <mrow>
   <mi>n</mi>
   <mo>×</mo>
   <mi>k</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>n</ci>
    <ci>k</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n\times k
  </annotation>
 </semantics>
</math>

 matrix with the observations stacked vertically, as in the standard <a href="linear_regression" title="wikilink">linear regression</a> setup:</p>

<p>

<math display="block" id="Bayesian_multivariate_linear_regression:15">
 <semantics>
  <mrow>
   <mrow>
    <mi>𝐗</mi>
    <mo>=</mo>
    <mrow>
     <mo>[</mo>
     <mtable displaystyle="true">
      <mtr>
       <mtd columnalign="center">
        <msubsup>
         <mi>𝐱</mi>
         <mn>1</mn>
         <mi mathvariant="normal">T</mi>
        </msubsup>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <msubsup>
         <mi>𝐱</mi>
         <mn>2</mn>
         <mi mathvariant="normal">T</mi>
        </msubsup>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mi mathvariant="normal">⋮</mi>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <msubsup>
         <mi>𝐱</mi>
         <mi>n</mi>
         <mi mathvariant="normal">T</mi>
        </msubsup>
       </mtd>
      </mtr>
     </mtable>
     <mo>]</mo>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mo>[</mo>
     <mtable displaystyle="true">
      <mtr>
       <mtd columnalign="center">
        <msub>
         <mi>x</mi>
         <mrow>
          <mn>1</mn>
          <mo>,</mo>
          <mn>1</mn>
         </mrow>
        </msub>
       </mtd>
       <mtd columnalign="center">
        <mi mathvariant="normal">⋯</mi>
       </mtd>
       <mtd columnalign="center">
        <msub>
         <mi>x</mi>
         <mrow>
          <mn>1</mn>
          <mo>,</mo>
          <mi>k</mi>
         </mrow>
        </msub>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <msub>
         <mi>x</mi>
         <mrow>
          <mn>2</mn>
          <mo>,</mo>
          <mn>1</mn>
         </mrow>
        </msub>
       </mtd>
       <mtd columnalign="center">
        <mi mathvariant="normal">⋯</mi>
       </mtd>
       <mtd columnalign="center">
        <msub>
         <mi>x</mi>
         <mrow>
          <mn>2</mn>
          <mo>,</mo>
          <mi>k</mi>
         </mrow>
        </msub>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mi mathvariant="normal">⋮</mi>
       </mtd>
       <mtd columnalign="center">
        <mi mathvariant="normal">⋱</mi>
       </mtd>
       <mtd columnalign="center">
        <mi mathvariant="normal">⋮</mi>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <msub>
         <mi>x</mi>
         <mrow>
          <mi>n</mi>
          <mo>,</mo>
          <mn>1</mn>
         </mrow>
        </msub>
       </mtd>
       <mtd columnalign="center">
        <mi mathvariant="normal">⋯</mi>
       </mtd>
       <mtd columnalign="center">
        <msub>
         <mi>x</mi>
         <mrow>
          <mi>n</mi>
          <mo>,</mo>
          <mi>k</mi>
         </mrow>
        </msub>
       </mtd>
      </mtr>
     </mtable>
     <mo>]</mo>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <ci>𝐗</ci>
     <matrix>
      <matrixrow>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>𝐱</ci>
         <ci>normal-T</ci>
        </apply>
        <cn type="integer">1</cn>
       </apply>
      </matrixrow>
      <matrixrow>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>𝐱</ci>
         <ci>normal-T</ci>
        </apply>
        <cn type="integer">2</cn>
       </apply>
      </matrixrow>
      <matrixrow>
       <ci>normal-⋮</ci>
      </matrixrow>
      <matrixrow>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>𝐱</ci>
         <ci>normal-T</ci>
        </apply>
        <ci>n</ci>
       </apply>
      </matrixrow>
     </matrix>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <matrix>
      <matrixrow>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <list>
         <cn type="integer">1</cn>
         <cn type="integer">1</cn>
        </list>
       </apply>
       <ci>normal-⋯</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <list>
         <cn type="integer">1</cn>
         <ci>k</ci>
        </list>
       </apply>
      </matrixrow>
      <matrixrow>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <list>
         <cn type="integer">2</cn>
         <cn type="integer">1</cn>
        </list>
       </apply>
       <ci>normal-⋯</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <list>
         <cn type="integer">2</cn>
         <ci>k</ci>
        </list>
       </apply>
      </matrixrow>
      <matrixrow>
       <ci>normal-⋮</ci>
       <ci>normal-⋱</ci>
       <ci>normal-⋮</ci>
      </matrixrow>
      <matrixrow>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <list>
         <ci>n</ci>
         <cn type="integer">1</cn>
        </list>
       </apply>
       <ci>normal-⋯</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <list>
         <ci>n</ci>
         <ci>k</ci>
        </list>
       </apply>
      </matrixrow>
     </matrix>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{X}=\begin{bmatrix}\mathbf{x}^{\rm T}_{1}\\
\mathbf{x}^{\rm T}_{2}\\
\vdots\\
\mathbf{x}^{\rm T}_{n}\end{bmatrix}=\begin{bmatrix}x_{1,1}&\cdots&x_{1,k}\\
x_{2,1}&\cdots&x_{2,k}\\
\vdots&\ddots&\vdots\\
x_{n,1}&\cdots&x_{n,k}\end{bmatrix}.
  </annotation>
 </semantics>
</math>

</p>

<p>The classical, frequentists <a href="linear_least_squares_(mathematics)" title="wikilink">linear least squares</a> solution is to simply estimate the matrix of regression coefficients 

<math display="inline" id="Bayesian_multivariate_linear_regression:16">
 <semantics>
  <mover accent="true">
   <mi>𝐁</mi>
   <mo stretchy="false">^</mo>
  </mover>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-^</ci>
    <ci>𝐁</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \hat{\mathbf{B}}
  </annotation>
 </semantics>
</math>

 using the <a href="Moore–Penrose_pseudoinverse" title="wikilink">Moore-Penrose</a> <a class="uri" href="pseudoinverse" title="wikilink">pseudoinverse</a>:</p>

<p>

<math display="block" id="Bayesian_multivariate_linear_regression:17">
 <semantics>
  <mrow>
   <mover accent="true">
    <mi>𝐁</mi>
    <mo stretchy="false">^</mo>
   </mover>
   <mo>=</mo>
   <mrow>
    <msup>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <msup>
        <mi>𝐗</mi>
        <mi mathvariant="normal">T</mi>
       </msup>
       <mi>𝐗</mi>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <mrow>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </msup>
    <msup>
     <mi>𝐗</mi>
     <mi mathvariant="normal">T</mi>
    </msup>
    <mi>𝐘</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <ci>normal-^</ci>
     <ci>𝐁</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>𝐗</ci>
        <ci>normal-T</ci>
       </apply>
       <ci>𝐗</ci>
      </apply>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>𝐗</ci>
      <ci>normal-T</ci>
     </apply>
     <ci>𝐘</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \hat{\mathbf{B}}=(\mathbf{X}^{\rm T}\mathbf{X})^{-1}\mathbf{X}^{\rm T}\mathbf{Y}
  </annotation>
 </semantics>
</math>

.</p>

<p>To obtain the Bayesian solution, we need to specify the conditional likelihood and then find the appropriate conjugate prior. As with the univariate case of <a href="Bayesian_linear_regression" title="wikilink">linear Bayesian regression</a>, we will find that we can specify a natural conditional conjugate prior (which is scale dependent).</p>

<p>Let us write our conditional likelihood as<a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a></p>

<p>

<math display="block" id="Bayesian_multivariate_linear_regression:18">
 <semantics>
  <mrow>
   <mi>ρ</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>𝐄</mi>
    <mo stretchy="false">|</mo>
    <msub>
     <mi>𝚺</mi>
     <mi>ϵ</mi>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>∝</mo>
   <msup>
    <mrow>
     <mo stretchy="false">(</mo>
     <msubsup>
      <mi>𝚺</mi>
      <mi>ϵ</mi>
      <mn>2</mn>
     </msubsup>
     <mo stretchy="false">)</mo>
    </mrow>
    <mrow>
     <mo>-</mo>
     <mrow>
      <mi>n</mi>
      <mo>/</mo>
      <mn>2</mn>
     </mrow>
    </mrow>
   </msup>
   <mi>exp</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mo>-</mo>
    <mfrac>
     <mn>1</mn>
     <mn>2</mn>
    </mfrac>
    <mi>tr</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <msup>
      <mi>𝐄</mi>
      <mi mathvariant="normal">T</mi>
     </msup>
     <mi>𝐄</mi>
     <msubsup>
      <mi>𝚺</mi>
      <mi>ϵ</mi>
      <mrow>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
     </msubsup>
     <mo stretchy="false">)</mo>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">ρ</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">E</csymbol>
     <ci>normal-|</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>𝚺</ci>
      <ci>ϵ</ci>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <csymbol cd="latexml">proportional-to</csymbol>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <ci>normal-(</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>𝚺</ci>
        <ci>ϵ</ci>
       </apply>
       <cn type="integer">2</cn>
      </apply>
      <ci>normal-)</ci>
     </cerror>
     <apply>
      <minus></minus>
      <apply>
       <divide></divide>
       <ci>n</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
    <exp></exp>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <minus></minus>
     <apply>
      <divide></divide>
      <cn type="integer">1</cn>
      <cn type="integer">2</cn>
     </apply>
     <csymbol cd="unknown">tr</csymbol>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <ci>normal-(</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>𝐄</ci>
       <ci>normal-T</ci>
      </apply>
      <csymbol cd="unknown">E</csymbol>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>𝚺</ci>
        <ci>ϵ</ci>
       </apply>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <ci>normal-)</ci>
     </cerror>
     <ci>normal-)</ci>
    </cerror>
    <ci>normal-,</ci>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \rho(\mathbf{E}|\boldsymbol{\Sigma}_{\epsilon})\propto(\boldsymbol{\Sigma}_{%
\epsilon}^{2})^{-n/2}\exp(-\frac{1}{2}{\rm tr}(\mathbf{E}^{\rm T}\mathbf{E}%
\boldsymbol{\Sigma}_{\epsilon}^{-1})),
  </annotation>
 </semantics>
</math>

</p>

<p>writing the error 

<math display="inline" id="Bayesian_multivariate_linear_regression:19">
 <semantics>
  <mi>𝐄</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>𝐄</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{E}
  </annotation>
 </semantics>
</math>

 in terms of 

<math display="inline" id="Bayesian_multivariate_linear_regression:20">
 <semantics>
  <mrow>
   <mrow>
    <mi>𝐘</mi>
    <mo>,</mo>
    <mi>𝐗</mi>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <list>
    <ci>𝐘</ci>
    <ci>𝐗</ci>
   </list>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{Y},\mathbf{X},
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Bayesian_multivariate_linear_regression:21">
 <semantics>
  <mi>𝐁</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>𝐁</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{B}
  </annotation>
 </semantics>
</math>

 yields</p>

<p>

<math display="block" id="Bayesian_multivariate_linear_regression:22">
 <semantics>
  <mrow>
   <mi>ρ</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>𝐘</mi>
    <mo stretchy="false">|</mo>
    <mi>𝐗</mi>
    <mo>,</mo>
    <mi>𝐁</mi>
    <mo>,</mo>
    <msub>
     <mi>𝚺</mi>
     <mi>ϵ</mi>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>∝</mo>
   <msup>
    <mrow>
     <mo stretchy="false">(</mo>
     <msubsup>
      <mi>𝚺</mi>
      <mi>ϵ</mi>
      <mn>2</mn>
     </msubsup>
     <mo stretchy="false">)</mo>
    </mrow>
    <mrow>
     <mo>-</mo>
     <mrow>
      <mi>n</mi>
      <mo>/</mo>
      <mn>2</mn>
     </mrow>
    </mrow>
   </msup>
   <mi>exp</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mo>-</mo>
    <mfrac>
     <mn>1</mn>
     <mn>2</mn>
    </mfrac>
    <mi>tr</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <msup>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>𝐘</mi>
       <mo>-</mo>
       <mi>𝐗𝐁</mi>
       <mo stretchy="false">)</mo>
      </mrow>
      <mi mathvariant="normal">T</mi>
     </msup>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>𝐘</mi>
      <mo>-</mo>
      <mi>𝐗𝐁</mi>
      <mo stretchy="false">)</mo>
     </mrow>
     <msubsup>
      <mi>𝚺</mi>
      <mi>ϵ</mi>
      <mrow>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
     </msubsup>
     <mo stretchy="false">)</mo>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">ρ</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">Y</csymbol>
     <ci>normal-|</ci>
     <csymbol cd="unknown">X</csymbol>
     <ci>normal-,</ci>
     <csymbol cd="unknown">B</csymbol>
     <ci>normal-,</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>𝚺</ci>
      <ci>ϵ</ci>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <csymbol cd="latexml">proportional-to</csymbol>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <ci>normal-(</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>𝚺</ci>
        <ci>ϵ</ci>
       </apply>
       <cn type="integer">2</cn>
      </apply>
      <ci>normal-)</ci>
     </cerror>
     <apply>
      <minus></minus>
      <apply>
       <divide></divide>
       <ci>n</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
    <exp></exp>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <minus></minus>
     <apply>
      <divide></divide>
      <cn type="integer">1</cn>
      <cn type="integer">2</cn>
     </apply>
     <csymbol cd="unknown">tr</csymbol>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <ci>normal-(</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <cerror>
        <csymbol cd="ambiguous">fragments</csymbol>
        <ci>normal-(</ci>
        <csymbol cd="unknown">Y</csymbol>
        <minus></minus>
        <csymbol cd="unknown">XB</csymbol>
        <ci>normal-)</ci>
       </cerror>
       <ci>normal-T</ci>
      </apply>
      <cerror>
       <csymbol cd="ambiguous">fragments</csymbol>
       <ci>normal-(</ci>
       <csymbol cd="unknown">Y</csymbol>
       <minus></minus>
       <csymbol cd="unknown">XB</csymbol>
       <ci>normal-)</ci>
      </cerror>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>𝚺</ci>
        <ci>ϵ</ci>
       </apply>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <ci>normal-)</ci>
     </cerror>
     <ci>normal-)</ci>
    </cerror>
    <ci>normal-,</ci>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \rho(\mathbf{Y}|\mathbf{X},\mathbf{B},\boldsymbol{\Sigma}_{\epsilon})\propto(%
\boldsymbol{\Sigma}_{\epsilon}^{2})^{-n/2}\exp(-\frac{1}{2}{\rm tr}((\mathbf{Y%
}-\mathbf{X}\mathbf{\mathbf{B}})^{\rm T}(\mathbf{Y}-\mathbf{X}\mathbf{\mathbf{%
B}})\boldsymbol{\Sigma}_{\epsilon}^{-1})),
  </annotation>
 </semantics>
</math>

</p>

<p>We seek a natural conjugate prior—a joint density 

<math display="inline" id="Bayesian_multivariate_linear_regression:23">
 <semantics>
  <mrow>
   <mi>ρ</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>𝐁</mi>
    <mo>,</mo>
    <msub>
     <mi mathvariant="normal">Σ</mi>
     <mi>ϵ</mi>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>ρ</ci>
    <interval closure="open">
     <ci>𝐁</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>normal-Σ</ci>
      <ci>ϵ</ci>
     </apply>
    </interval>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \rho(\mathbf{B},\Sigma_{\epsilon})
  </annotation>
 </semantics>
</math>

 which is of the same functional form as the likelihood. Since the likelihood is quadratic in 

<math display="inline" id="Bayesian_multivariate_linear_regression:24">
 <semantics>
  <mi>𝐁</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>𝐁</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{B}
  </annotation>
 </semantics>
</math>

, we re-write the likelihood so it is normal in 

<math display="inline" id="Bayesian_multivariate_linear_regression:25">
 <semantics>
  <mrow>
   <mo stretchy="false">(</mo>
   <mrow>
    <mi>𝐁</mi>
    <mo>-</mo>
    <mover accent="true">
     <mi>𝐁</mi>
     <mo stretchy="false">^</mo>
    </mover>
   </mrow>
   <mo stretchy="false">)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <minus></minus>
    <ci>𝐁</ci>
    <apply>
     <ci>normal-^</ci>
     <ci>𝐁</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (\mathbf{B}-\hat{\mathbf{B}})
  </annotation>
 </semantics>
</math>

 (the deviation from classical sample estimate).</p>

<p>Using the same technique as with <a href="Bayesian_linear_regression" title="wikilink">Bayesian linear regression</a>, we decompose the exponential term using a matrix-form of the sum-of-squares technique. Here, however, we will also need to use the Matrix Differential Calculus (<a href="Kronecker_product" title="wikilink">Kronecker product</a> and <a href="vectorization_(mathematics)" title="wikilink">vectorization</a> transformations).</p>

<p>First, let us apply sum-of-squares to obtain new expression for the likelihood:</p>

<p>

<math display="block" id="Bayesian_multivariate_linear_regression:26">
 <semantics>
  <mrow>
   <mi>ρ</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>𝐘</mi>
    <mo stretchy="false">|</mo>
    <mi>𝐗</mi>
    <mo>,</mo>
    <mi>𝐁</mi>
    <mo>,</mo>
    <msub>
     <mi>𝚺</mi>
     <mi>ϵ</mi>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>∝</mo>
   <msubsup>
    <mi>𝚺</mi>
    <mi>ϵ</mi>
    <mrow>
     <mo>-</mo>
     <mrow>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mi>n</mi>
        <mo>-</mo>
        <mi>k</mi>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
      <mo>/</mo>
      <mn>2</mn>
     </mrow>
    </mrow>
   </msubsup>
   <mi>exp</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mo>-</mo>
    <mi>tr</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mfrac>
      <mn>1</mn>
      <mn>2</mn>
     </mfrac>
     <msup>
      <mi>𝐒</mi>
      <mi mathvariant="normal">T</mi>
     </msup>
     <mi>𝐒</mi>
     <msubsup>
      <mi>𝚺</mi>
      <mi>ϵ</mi>
      <mrow>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
     </msubsup>
     <mo stretchy="false">)</mo>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
   <msup>
    <mrow>
     <mo stretchy="false">(</mo>
     <msubsup>
      <mi>𝚺</mi>
      <mi>ϵ</mi>
      <mn>2</mn>
     </msubsup>
     <mo stretchy="false">)</mo>
    </mrow>
    <mrow>
     <mo>-</mo>
     <mrow>
      <mi>k</mi>
      <mo>/</mo>
      <mn>2</mn>
     </mrow>
    </mrow>
   </msup>
   <mi>exp</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mo>-</mo>
    <mfrac>
     <mn>1</mn>
     <mn>2</mn>
    </mfrac>
    <mi>tr</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <msup>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>𝐁</mi>
       <mo>-</mo>
       <mover accent="true">
        <mi>𝐁</mi>
        <mo stretchy="false">^</mo>
       </mover>
       <mo stretchy="false">)</mo>
      </mrow>
      <mi mathvariant="normal">T</mi>
     </msup>
     <msup>
      <mi>𝐗</mi>
      <mi mathvariant="normal">T</mi>
     </msup>
     <mi>𝐗</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>𝐁</mi>
      <mo>-</mo>
      <mover accent="true">
       <mi>𝐁</mi>
       <mo stretchy="false">^</mo>
      </mover>
      <mo stretchy="false">)</mo>
     </mrow>
     <msubsup>
      <mi>𝚺</mi>
      <mi>ϵ</mi>
      <mrow>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
     </msubsup>
     <mo stretchy="false">)</mo>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">ρ</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">Y</csymbol>
     <ci>normal-|</ci>
     <csymbol cd="unknown">X</csymbol>
     <ci>normal-,</ci>
     <csymbol cd="unknown">B</csymbol>
     <ci>normal-,</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>𝚺</ci>
      <ci>ϵ</ci>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <csymbol cd="latexml">proportional-to</csymbol>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>𝚺</ci>
      <ci>ϵ</ci>
     </apply>
     <apply>
      <minus></minus>
      <apply>
       <divide></divide>
       <apply>
        <minus></minus>
        <ci>n</ci>
        <ci>k</ci>
       </apply>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
    <exp></exp>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <minus></minus>
     <csymbol cd="unknown">tr</csymbol>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <ci>normal-(</ci>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>𝐒</ci>
       <ci>normal-T</ci>
      </apply>
      <csymbol cd="unknown">S</csymbol>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>𝚺</ci>
        <ci>ϵ</ci>
       </apply>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <ci>normal-)</ci>
     </cerror>
     <ci>normal-)</ci>
    </cerror>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <ci>normal-(</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>𝚺</ci>
        <ci>ϵ</ci>
       </apply>
       <cn type="integer">2</cn>
      </apply>
      <ci>normal-)</ci>
     </cerror>
     <apply>
      <minus></minus>
      <apply>
       <divide></divide>
       <ci>k</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
    <exp></exp>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <minus></minus>
     <apply>
      <divide></divide>
      <cn type="integer">1</cn>
      <cn type="integer">2</cn>
     </apply>
     <csymbol cd="unknown">tr</csymbol>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <ci>normal-(</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <cerror>
        <csymbol cd="ambiguous">fragments</csymbol>
        <ci>normal-(</ci>
        <csymbol cd="unknown">B</csymbol>
        <minus></minus>
        <apply>
         <ci>normal-^</ci>
         <ci>𝐁</ci>
        </apply>
        <ci>normal-)</ci>
       </cerror>
       <ci>normal-T</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>𝐗</ci>
       <ci>normal-T</ci>
      </apply>
      <csymbol cd="unknown">X</csymbol>
      <cerror>
       <csymbol cd="ambiguous">fragments</csymbol>
       <ci>normal-(</ci>
       <csymbol cd="unknown">B</csymbol>
       <minus></minus>
       <apply>
        <ci>normal-^</ci>
        <ci>𝐁</ci>
       </apply>
       <ci>normal-)</ci>
      </cerror>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>𝚺</ci>
        <ci>ϵ</ci>
       </apply>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <ci>normal-)</ci>
     </cerror>
     <ci>normal-)</ci>
    </cerror>
    <ci>normal-,</ci>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \rho(\mathbf{Y}|\mathbf{X},\mathbf{B},\boldsymbol{\Sigma}_{\epsilon})\propto%
\boldsymbol{\Sigma}_{\epsilon}^{-(n-k)/2}\exp(-{\rm tr}(\frac{1}{2}\mathbf{S}^%
{\rm T}\mathbf{S}\boldsymbol{\Sigma}_{\epsilon}^{-1}))(\boldsymbol{\Sigma}_{%
\epsilon}^{2})^{-k/2}\exp(-\frac{1}{2}{\rm tr}((\mathbf{B}-\hat{\mathbf{B}})^{%
\rm T}\mathbf{X}^{\rm T}\mathbf{X}(\mathbf{B}-\hat{\mathbf{B}})\boldsymbol{%
\Sigma}_{\epsilon}^{-1})),
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Bayesian_multivariate_linear_regression:27">
 <semantics>
  <mrow>
   <mi>𝐒</mi>
   <mo>=</mo>
   <mrow>
    <mi>𝐘</mi>
    <mo>-</mo>
    <mrow>
     <mover accent="true">
      <mi>𝐁</mi>
      <mo stretchy="false">^</mo>
     </mover>
     <mi>𝐗</mi>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>𝐒</ci>
    <apply>
     <minus></minus>
     <ci>𝐘</ci>
     <apply>
      <times></times>
      <apply>
       <ci>normal-^</ci>
       <ci>𝐁</ci>
      </apply>
      <ci>𝐗</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{S}=\mathbf{Y}-\hat{\mathbf{B}}\mathbf{X}
  </annotation>
 </semantics>
</math>

</p>

<p>We would like to develop a conditional form for the priors:</p>

<p>

<math display="block" id="Bayesian_multivariate_linear_regression:28">
 <semantics>
  <mrow>
   <mi>ρ</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>𝐁</mi>
    <mo>,</mo>
    <msub>
     <mi>𝚺</mi>
     <mi>ϵ</mi>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>=</mo>
   <mi>ρ</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>𝚺</mi>
     <mi>ϵ</mi>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
   <mi>ρ</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>𝐁</mi>
    <mo stretchy="false">|</mo>
    <msub>
     <mi>𝚺</mi>
     <mi>ϵ</mi>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">ρ</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">B</csymbol>
     <ci>normal-,</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>𝚺</ci>
      <ci>ϵ</ci>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <eq></eq>
    <csymbol cd="unknown">ρ</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>𝚺</ci>
      <ci>ϵ</ci>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <csymbol cd="unknown">ρ</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">B</csymbol>
     <ci>normal-|</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>𝚺</ci>
      <ci>ϵ</ci>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <ci>normal-,</ci>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \rho(\mathbf{B},\boldsymbol{\Sigma}_{\epsilon})=\rho(\boldsymbol{\Sigma}_{%
\epsilon})\rho(\mathbf{B}|\boldsymbol{\Sigma}_{\epsilon}),
  </annotation>
 </semantics>
</math>

</p>

<p>where 

<math display="inline" id="Bayesian_multivariate_linear_regression:29">
 <semantics>
  <mrow>
   <mi>ρ</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>𝚺</mi>
     <mi>ϵ</mi>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>ρ</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>𝚺</ci>
     <ci>ϵ</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \rho(\boldsymbol{\Sigma}_{\epsilon})
  </annotation>
 </semantics>
</math>

 is an <a href="inverse-Wishart_distribution" title="wikilink">inverse-Wishart distribution</a> and 

<math display="inline" id="Bayesian_multivariate_linear_regression:30">
 <semantics>
  <mrow>
   <mi>ρ</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>𝐁</mi>
    <mo stretchy="false">|</mo>
    <msub>
     <mi>𝚺</mi>
     <mi>ϵ</mi>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">ρ</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">B</csymbol>
     <ci>normal-|</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>𝚺</ci>
      <ci>ϵ</ci>
     </apply>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \rho(\mathbf{B}|\boldsymbol{\Sigma}_{\epsilon})
  </annotation>
 </semantics>
</math>

 is some form of <a href="normal_distribution" title="wikilink">normal distribution</a> in the matrix 

<math display="inline" id="Bayesian_multivariate_linear_regression:31">
 <semantics>
  <mi>𝐁</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>𝐁</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{B}
  </annotation>
 </semantics>
</math>

. This is accomplished using the <a href="vectorization_(mathematics)" title="wikilink">vectorization</a> transformation, which converts the likelihood from a function of the matrices 

<math display="inline" id="Bayesian_multivariate_linear_regression:32">
 <semantics>
  <mrow>
   <mi>𝐁</mi>
   <mo>,</mo>
   <mover accent="true">
    <mi>𝐁</mi>
    <mo stretchy="false">^</mo>
   </mover>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <list>
    <ci>𝐁</ci>
    <apply>
     <ci>normal-^</ci>
     <ci>𝐁</ci>
    </apply>
   </list>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{B},\hat{\mathbf{B}}
  </annotation>
 </semantics>
</math>

 to a function of the vectors 

<math display="inline" id="Bayesian_multivariate_linear_regression:33">
 <semantics>
  <mrow>
   <mrow>
    <mi>𝜷</mi>
    <mo>=</mo>
    <mrow>
     <mi>vec</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>𝐁</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
   <mrow>
    <mover accent="true">
     <mi>𝜷</mi>
     <mo stretchy="false">^</mo>
    </mover>
    <mo>=</mo>
    <mrow>
     <mi>vec</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mover accent="true">
       <mi>𝐁</mi>
       <mo stretchy="false">^</mo>
      </mover>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <eq></eq>
     <ci>𝜷</ci>
     <apply>
      <times></times>
      <ci>vec</ci>
      <ci>𝐁</ci>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <apply>
      <ci>normal-^</ci>
      <ci>𝜷</ci>
     </apply>
     <apply>
      <times></times>
      <ci>vec</ci>
      <apply>
       <ci>normal-^</ci>
       <ci>𝐁</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \boldsymbol{\beta}={\rm vec}(\mathbf{B}),\hat{\boldsymbol{\beta}}={\rm vec}(%
\hat{\mathbf{B}})
  </annotation>
 </semantics>
</math>

.</p>

<p>Write</p>

<p>

<math display="block" id="Bayesian_multivariate_linear_regression:34">
 <semantics>
  <mrow>
   <mrow>
    <mi>tr</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <msup>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mi>𝐁</mi>
         <mo>-</mo>
         <mover accent="true">
          <mi>𝐁</mi>
          <mo stretchy="false">^</mo>
         </mover>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
       <mi mathvariant="normal">T</mi>
      </msup>
      <msup>
       <mi>𝐗</mi>
       <mi mathvariant="normal">T</mi>
      </msup>
      <mi>𝐗</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mi>𝐁</mi>
        <mo>-</mo>
        <mover accent="true">
         <mi>𝐁</mi>
         <mo stretchy="false">^</mo>
        </mover>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
      <msubsup>
       <mi>𝚺</mi>
       <mi>ϵ</mi>
       <mrow>
        <mo>-</mo>
        <mn>1</mn>
       </mrow>
      </msubsup>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mi>vec</mi>
    <msup>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mi>𝐁</mi>
       <mo>-</mo>
       <mover accent="true">
        <mi>𝐁</mi>
        <mo stretchy="false">^</mo>
       </mover>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <mi mathvariant="normal">T</mi>
    </msup>
    <mi>vec</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <msup>
       <mi>𝐗</mi>
       <mi mathvariant="normal">T</mi>
      </msup>
      <mi>𝐗</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mi>𝐁</mi>
        <mo>-</mo>
        <mover accent="true">
         <mi>𝐁</mi>
         <mo stretchy="false">^</mo>
        </mover>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
      <msubsup>
       <mi>𝚺</mi>
       <mi>ϵ</mi>
       <mrow>
        <mo>-</mo>
        <mn>1</mn>
       </mrow>
      </msubsup>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>tr</ci>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <minus></minus>
        <ci>𝐁</ci>
        <apply>
         <ci>normal-^</ci>
         <ci>𝐁</ci>
        </apply>
       </apply>
       <ci>normal-T</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>𝐗</ci>
       <ci>normal-T</ci>
      </apply>
      <ci>𝐗</ci>
      <apply>
       <minus></minus>
       <ci>𝐁</ci>
       <apply>
        <ci>normal-^</ci>
        <ci>𝐁</ci>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>𝚺</ci>
        <ci>ϵ</ci>
       </apply>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <times></times>
     <ci>vec</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <minus></minus>
       <ci>𝐁</ci>
       <apply>
        <ci>normal-^</ci>
        <ci>𝐁</ci>
       </apply>
      </apply>
      <ci>normal-T</ci>
     </apply>
     <ci>vec</ci>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>𝐗</ci>
       <ci>normal-T</ci>
      </apply>
      <ci>𝐗</ci>
      <apply>
       <minus></minus>
       <ci>𝐁</ci>
       <apply>
        <ci>normal-^</ci>
        <ci>𝐁</ci>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>𝚺</ci>
        <ci>ϵ</ci>
       </apply>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   {\rm tr}((\mathbf{B}-\hat{\mathbf{B}})^{\rm T}\mathbf{X}^{\rm T}\mathbf{X}(%
\mathbf{B}-\hat{\mathbf{B}})\boldsymbol{\Sigma}_{\epsilon}^{-1})={\rm vec}(%
\mathbf{B}-\hat{\mathbf{B}})^{\rm T}{\rm vec}(\mathbf{X}^{\rm T}\mathbf{X}(%
\mathbf{B}-\hat{\mathbf{B}})\boldsymbol{\Sigma}_{\epsilon}^{-1})
  </annotation>
 </semantics>
</math>

</p>

<p>Let</p>

<p>

<math display="block" id="Bayesian_multivariate_linear_regression:35">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>vec</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <msup>
        <mi>𝐗</mi>
        <mi mathvariant="normal">T</mi>
       </msup>
       <mi>𝐗</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mi>𝐁</mi>
         <mo>-</mo>
         <mover accent="true">
          <mi>𝐁</mi>
          <mo stretchy="false">^</mo>
         </mover>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
       <msubsup>
        <mi>𝚺</mi>
        <mi>ϵ</mi>
        <mrow>
         <mo>-</mo>
         <mn>1</mn>
        </mrow>
       </msubsup>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mrow>
        <msubsup>
         <mi>𝚺</mi>
         <mi>ϵ</mi>
         <mrow>
          <mo>-</mo>
          <mn>1</mn>
         </mrow>
        </msubsup>
        <mo>⊗</mo>
        <msup>
         <mi>𝐗</mi>
         <mi mathvariant="normal">T</mi>
        </msup>
       </mrow>
       <mi>𝐗</mi>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <mi>vec</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mi>𝐁</mi>
       <mo>-</mo>
       <mover accent="true">
        <mi>𝐁</mi>
        <mo stretchy="false">^</mo>
       </mover>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>vec</ci>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>𝐗</ci>
       <ci>normal-T</ci>
      </apply>
      <ci>𝐗</ci>
      <apply>
       <minus></minus>
       <ci>𝐁</ci>
       <apply>
        <ci>normal-^</ci>
        <ci>𝐁</ci>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>𝚺</ci>
        <ci>ϵ</ci>
       </apply>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="latexml">tensor-product</csymbol>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>𝚺</ci>
         <ci>ϵ</ci>
        </apply>
        <apply>
         <minus></minus>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>𝐗</ci>
        <ci>normal-T</ci>
       </apply>
      </apply>
      <ci>𝐗</ci>
     </apply>
     <ci>vec</ci>
     <apply>
      <minus></minus>
      <ci>𝐁</ci>
      <apply>
       <ci>normal-^</ci>
       <ci>𝐁</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   {\rm vec}(\mathbf{X}^{\rm T}\mathbf{X}(\mathbf{B}-\hat{\mathbf{B}})\boldsymbol%
{\Sigma}_{\epsilon}^{-1})=(\boldsymbol{\Sigma}_{\epsilon}^{-1}\otimes\mathbf{X%
}^{\rm T}\mathbf{X}){\rm vec}(\mathbf{B}-\hat{\mathbf{B}}),
  </annotation>
 </semantics>
</math>

 where 

<math display="inline" id="Bayesian_multivariate_linear_regression:36">
 <semantics>
  <mrow>
   <mi>𝐀</mi>
   <mo>⊗</mo>
   <mi>𝐁</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">tensor-product</csymbol>
    <ci>𝐀</ci>
    <ci>𝐁</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{A}\otimes\mathbf{B}
  </annotation>
 </semantics>
</math>

 denotes the <a href="Kronecker_product" title="wikilink">Kronecker product</a> of matrices <strong>A</strong> and <strong>B</strong>, a generalization of the <a href="outer_product" title="wikilink">outer product</a> which multiplies an 

<math display="inline" id="Bayesian_multivariate_linear_regression:37">
 <semantics>
  <mrow>
   <mi>m</mi>
   <mo>×</mo>
   <mi>n</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>m</ci>
    <ci>n</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   m\times n
  </annotation>
 </semantics>
</math>

 matrix by a 

<math display="inline" id="Bayesian_multivariate_linear_regression:38">
 <semantics>
  <mrow>
   <mi>p</mi>
   <mo>×</mo>
   <mi>q</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>p</ci>
    <ci>q</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p\times q
  </annotation>
 </semantics>
</math>

 matrix to generate an 

<math display="inline" id="Bayesian_multivariate_linear_regression:39">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>m</mi>
     <mi>p</mi>
    </mrow>
    <mo>×</mo>
    <mi>n</mi>
   </mrow>
   <mi>q</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <times></times>
     <apply>
      <times></times>
      <ci>m</ci>
      <ci>p</ci>
     </apply>
     <ci>n</ci>
    </apply>
    <ci>q</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   mp\times nq
  </annotation>
 </semantics>
</math>

 matrix, consisting of every combination of products of elements from the two matrices.</p>

<p>Then</p>

<p>

<math display="block" id="Bayesian_multivariate_linear_regression:40">
 <semantics>
  <mrow>
   <mi>vec</mi>
   <msup>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>𝐁</mi>
      <mo>-</mo>
      <mover accent="true">
       <mi>𝐁</mi>
       <mo stretchy="false">^</mo>
      </mover>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
    <mi mathvariant="normal">T</mi>
   </msup>
   <mrow>
    <mo stretchy="false">(</mo>
    <mrow>
     <mrow>
      <msubsup>
       <mi>𝚺</mi>
       <mi>ϵ</mi>
       <mrow>
        <mo>-</mo>
        <mn>1</mn>
       </mrow>
      </msubsup>
      <mo>⊗</mo>
      <msup>
       <mi>𝐗</mi>
       <mi mathvariant="normal">T</mi>
      </msup>
     </mrow>
     <mi>𝐗</mi>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
   <mi>vec</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mrow>
     <mi>𝐁</mi>
     <mo>-</mo>
     <mover accent="true">
      <mi>𝐁</mi>
      <mo stretchy="false">^</mo>
     </mover>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>vec</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <minus></minus>
      <ci>𝐁</ci>
      <apply>
       <ci>normal-^</ci>
       <ci>𝐁</ci>
      </apply>
     </apply>
     <ci>normal-T</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="latexml">tensor-product</csymbol>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>𝚺</ci>
        <ci>ϵ</ci>
       </apply>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>𝐗</ci>
       <ci>normal-T</ci>
      </apply>
     </apply>
     <ci>𝐗</ci>
    </apply>
    <ci>vec</ci>
    <apply>
     <minus></minus>
     <ci>𝐁</ci>
     <apply>
      <ci>normal-^</ci>
      <ci>𝐁</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   {\rm vec}(\mathbf{B}-\hat{\mathbf{B}})^{\rm T}(\boldsymbol{\Sigma}_{\epsilon}^%
{-1}\otimes\mathbf{X}^{\rm T}\mathbf{X}){\rm vec}(\mathbf{B}-\hat{\mathbf{B}})
  </annotation>
 </semantics>
</math>

</p>
<dl>
<dd><dl>
<dd>

<math display="inline" id="Bayesian_multivariate_linear_regression:41">
 <semantics>
  <mrow>
   <mi></mi>
   <mo>=</mo>
   <mrow>
    <msup>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mi>𝜷</mi>
       <mo>-</mo>
       <mover accent="true">
        <mi>𝜷</mi>
        <mo stretchy="false">^</mo>
       </mover>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <mi mathvariant="normal">T</mi>
    </msup>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mrow>
       <msubsup>
        <mi>𝚺</mi>
        <mi>ϵ</mi>
        <mrow>
         <mo>-</mo>
         <mn>1</mn>
        </mrow>
       </msubsup>
       <mo>⊗</mo>
       <msup>
        <mi>𝐗</mi>
        <mi mathvariant="normal">T</mi>
       </msup>
      </mrow>
      <mi>𝐗</mi>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>𝜷</mi>
      <mo>-</mo>
      <mover accent="true">
       <mi>𝜷</mi>
       <mo stretchy="false">^</mo>
      </mover>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <csymbol cd="latexml">absent</csymbol>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <minus></minus>
       <ci>𝜷</ci>
       <apply>
        <ci>normal-^</ci>
        <ci>𝜷</ci>
       </apply>
      </apply>
      <ci>normal-T</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="latexml">tensor-product</csymbol>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>𝚺</ci>
         <ci>ϵ</ci>
        </apply>
        <apply>
         <minus></minus>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>𝐗</ci>
        <ci>normal-T</ci>
       </apply>
      </apply>
      <ci>𝐗</ci>
     </apply>
     <apply>
      <minus></minus>
      <ci>𝜷</ci>
      <apply>
       <ci>normal-^</ci>
       <ci>𝜷</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   =(\boldsymbol{\beta}-\hat{\boldsymbol{\beta}})^{\rm T}(\boldsymbol{\Sigma}_{%
\epsilon}^{-1}\otimes\mathbf{X}^{\rm T}\mathbf{X})(\boldsymbol{\beta}-\hat{%
\boldsymbol{\beta}})
  </annotation>
 </semantics>
</math>


</dd>
</dl>
</dd>
</dl>

<p>which will lead to a likelihood which is normal in 

<math display="inline" id="Bayesian_multivariate_linear_regression:42">
 <semantics>
  <mrow>
   <mo stretchy="false">(</mo>
   <mrow>
    <mi>𝜷</mi>
    <mo>-</mo>
    <mover accent="true">
     <mi>𝜷</mi>
     <mo stretchy="false">^</mo>
    </mover>
   </mrow>
   <mo stretchy="false">)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <minus></minus>
    <ci>𝜷</ci>
    <apply>
     <ci>normal-^</ci>
     <ci>𝜷</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (\boldsymbol{\beta}-\hat{\boldsymbol{\beta}})
  </annotation>
 </semantics>
</math>

.</p>

<p>With the likelihood in a more tractable form, we can now find a natural (conditional) conjugate prior.</p>
<h2 id="see-also">See also</h2>
<ul>
<li><a href="Bayesian_linear_regression" title="wikilink">Bayesian linear regression</a></li>
<li><a href="Matrix_normal_distribution" title="wikilink">Matrix normal distribution</a></li>
</ul>
<h2 id="references">References</h2>
<ul>
<li>Peter E. Rossi, Greg M. Allenby, and Robert McCulloch, <em>Bayesian Statistics and Marketing</em>, John Wiley &amp; Sons, Ltd, 2006</li>
</ul>

<p>"</p>

<p><a href="Category:Bayesian_inference" title="wikilink">Multivariate linear regression</a> <a href="Category:Regression_analysis" title="wikilink">Category:Regression analysis</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1">Peter E. Rossi, Greg M. Allenby, Rob McCulloch. <em>Bayesian Statistics and Marketing</em>. John Wiley &amp; Sons, 2012, p. 32.<a href="#fnref1">↩</a></li>
</ol>
</section>
</body>
</html>

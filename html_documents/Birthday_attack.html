<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="822">Birthday attack</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Birthday attack</h1>
<style>
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
<style>
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
  </style>
</body></html>
<body>
<hr/>

<p>A <strong>birthday attack</strong> is a type of <a href="cryptography" title="wikilink">cryptographic</a> <a href="cryptanalysis" title="wikilink">attack</a> that exploits the <a class="uri" href="mathematics" title="wikilink">mathematics</a> behind the <a href="birthday_problem" title="wikilink">birthday problem</a> in <a href="probability_theory" title="wikilink">probability theory</a>. This attack can be used to abuse communication between two or more parties. The attack depends on the higher likelihood of <a href="collision_(computer_science)" title="wikilink">collisions</a> found between random attack attempts and a fixed degree of permutations (<a href="pigeonhole_principle" title="wikilink">pigeonholes</a>).</p>
<h2 id="understanding-the-problem">Understanding the problem</h2>

<p>As an example, consider the scenario in which a teacher with a class of 30 students asks for everybody's birthday, to determine whether any two students have the same birthday (corresponding to a <a href="collision_(computer_science)" title="wikilink">hash collision</a> as described further [for simplicity, ignore February 29]). Intuitively, this chance may seem small. If the teacher picked a specific day (say September 16), then the chance that at least one student was born on that specific day is 

<math display="inline" id="Birthday_attack:0">
 <semantics>
  <mrow>
   <mn>1</mn>
   <mo>-</mo>
   <msup>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mn>364</mn>
      <mo>/</mo>
      <mn>365</mn>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
    <mn>30</mn>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <minus></minus>
    <cn type="integer">1</cn>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <divide></divide>
      <cn type="integer">364</cn>
      <cn type="integer">365</cn>
     </apply>
     <cn type="integer">30</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   1-(364/365)^{30}
  </annotation>
 </semantics>
</math>

, about 7.9%. However, the probability that at least one student has the same birthday as <em>any</em> other student is around 70% for n = 30, from the formula 

<math display="inline" id="Birthday_attack:1">
 <semantics>
  <mrow>
   <mn>1</mn>
   <mo>-</mo>
   <mrow>
    <mrow>
     <mn>365</mn>
     <mo lspace="0pt" rspace="3.5pt">!</mo>
    </mrow>
    <mo>/</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mrow>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mn>365</mn>
         <mo>-</mo>
         <mi>n</mi>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
       <mo lspace="0pt" rspace="3.5pt">!</mo>
      </mrow>
      <mo>⋅</mo>
      <msup>
       <mn>365</mn>
       <mi>n</mi>
      </msup>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <minus></minus>
    <cn type="integer">1</cn>
    <apply>
     <divide></divide>
     <apply>
      <factorial></factorial>
      <cn type="integer">365</cn>
     </apply>
     <apply>
      <ci>normal-⋅</ci>
      <apply>
       <factorial></factorial>
       <apply>
        <minus></minus>
        <cn type="integer">365</cn>
        <ci>n</ci>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <cn type="integer">365</cn>
       <ci>n</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   1-365!/((365-n)!\cdot 365^{n})
  </annotation>
 </semantics>
</math>

.<a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a></p>
<h2 id="mathematics">Mathematics</h2>

<p>Given a function 

<math display="inline" id="Birthday_attack:2">
 <semantics>
  <mi>f</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>f</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f
  </annotation>
 </semantics>
</math>

, the goal of the attack is to find two different inputs 

<math display="inline" id="Birthday_attack:3">
 <semantics>
  <mrow>
   <msub>
    <mi>x</mi>
    <mn>1</mn>
   </msub>
   <mo>,</mo>
   <msub>
    <mi>x</mi>
    <mn>2</mn>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <list>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>x</ci>
     <cn type="integer">1</cn>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>x</ci>
     <cn type="integer">2</cn>
    </apply>
   </list>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x_{1},x_{2}
  </annotation>
 </semantics>
</math>

 such that 

<math display="inline" id="Birthday_attack:4">
 <semantics>
  <mrow>
   <mrow>
    <mi>f</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <msub>
      <mi>x</mi>
      <mn>1</mn>
     </msub>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mi>f</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <msub>
      <mi>x</mi>
      <mn>2</mn>
     </msub>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>f</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <cn type="integer">1</cn>
     </apply>
    </apply>
    <apply>
     <times></times>
     <ci>f</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <cn type="integer">2</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f(x_{1})=f(x_{2})
  </annotation>
 </semantics>
</math>

. Such a pair 

<math display="inline" id="Birthday_attack:5">
 <semantics>
  <mrow>
   <msub>
    <mi>x</mi>
    <mn>1</mn>
   </msub>
   <mo>,</mo>
   <msub>
    <mi>x</mi>
    <mn>2</mn>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <list>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>x</ci>
     <cn type="integer">1</cn>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>x</ci>
     <cn type="integer">2</cn>
    </apply>
   </list>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x_{1},x_{2}
  </annotation>
 </semantics>
</math>

 is called a <a href="Collision_(computer_science)" title="wikilink">collision</a>. The method used to find a collision is simply to evaluate the function 

<math display="inline" id="Birthday_attack:6">
 <semantics>
  <mi>f</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>f</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f
  </annotation>
 </semantics>
</math>

 for different input values that may be chosen randomly or pseudorandomly until the same result is found more than once. Because of the birthday problem, this method can be rather efficient. Specifically, if a <a href="function_(mathematics)" title="wikilink">function</a> 

<math display="inline" id="Birthday_attack:7">
 <semantics>
  <mrow>
   <mi>f</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>x</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>f</ci>
    <ci>x</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f(x)
  </annotation>
 </semantics>
</math>

 yields any of 

<math display="inline" id="Birthday_attack:8">
 <semantics>
  <mi>H</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>H</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   H
  </annotation>
 </semantics>
</math>

 different outputs with equal probability and 

<math display="inline" id="Birthday_attack:9">
 <semantics>
  <mi>H</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>H</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   H
  </annotation>
 </semantics>
</math>

 is sufficiently large, then we expect to obtain a pair of different arguments 

<math display="inline" id="Birthday_attack:10">
 <semantics>
  <msub>
   <mi>x</mi>
   <mn>1</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>x</ci>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x_{1}
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Birthday_attack:11">
 <semantics>
  <msub>
   <mi>x</mi>
   <mn>2</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>x</ci>
    <cn type="integer">2</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x_{2}
  </annotation>
 </semantics>
</math>

 with 

<math display="inline" id="Birthday_attack:12">
 <semantics>
  <mrow>
   <mrow>
    <mi>f</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <msub>
      <mi>x</mi>
      <mn>1</mn>
     </msub>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mi>f</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <msub>
      <mi>x</mi>
      <mn>2</mn>
     </msub>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>f</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <cn type="integer">1</cn>
     </apply>
    </apply>
    <apply>
     <times></times>
     <ci>f</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <cn type="integer">2</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f(x_{1})=f(x_{2})
  </annotation>
 </semantics>
</math>

 after evaluating the function for about 

<math display="inline" id="Birthday_attack:13">
 <semantics>
  <mrow>
   <mn>1.25</mn>
   <msqrt>
    <mi>H</mi>
   </msqrt>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <cn type="float">1.25</cn>
    <apply>
     <root></root>
     <ci>H</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   1.25\sqrt{H}
  </annotation>
 </semantics>
</math>

 different arguments on average.</p>

<p>We consider the following experiment. From a set of <em>H</em> values we choose <em>n</em> values uniformly at random thereby allowing repetitions. Let <em>p</em>(<em>n</em>; <em>H</em>) be the probability that during this experiment at least one value is chosen more than once. This probability can be approximated as</p>

<p>

<math display="block" id="Birthday_attack:14">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>p</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>n</mi>
      <mo>;</mo>
      <mi>H</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>≈</mo>
    <mrow>
     <mn>1</mn>
     <mo>-</mo>
     <msup>
      <mi>e</mi>
      <mrow>
       <mo>-</mo>
       <mrow>
        <mrow>
         <mi>n</mi>
         <mrow>
          <mo stretchy="false">(</mo>
          <mrow>
           <mi>n</mi>
           <mo>-</mo>
           <mn>1</mn>
          </mrow>
          <mo stretchy="false">)</mo>
         </mrow>
        </mrow>
        <mo>/</mo>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <mn>2</mn>
          <mi>H</mi>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
      </mrow>
     </msup>
    </mrow>
    <mo>≈</mo>
    <mrow>
     <mn>1</mn>
     <mo>-</mo>
     <msup>
      <mi>e</mi>
      <mrow>
       <mo>-</mo>
       <mrow>
        <msup>
         <mi>n</mi>
         <mn>2</mn>
        </msup>
        <mo>/</mo>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <mn>2</mn>
          <mi>H</mi>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
      </mrow>
     </msup>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <approx></approx>
     <apply>
      <times></times>
      <ci>p</ci>
      <list>
       <ci>n</ci>
       <ci>H</ci>
      </list>
     </apply>
     <apply>
      <minus></minus>
      <cn type="integer">1</cn>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>e</ci>
       <apply>
        <minus></minus>
        <apply>
         <divide></divide>
         <apply>
          <times></times>
          <ci>n</ci>
          <apply>
           <minus></minus>
           <ci>n</ci>
           <cn type="integer">1</cn>
          </apply>
         </apply>
         <apply>
          <times></times>
          <cn type="integer">2</cn>
          <ci>H</ci>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <approx></approx>
     <share href="#.cmml">
     </share>
     <apply>
      <minus></minus>
      <cn type="integer">1</cn>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>e</ci>
       <apply>
        <minus></minus>
        <apply>
         <divide></divide>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>n</ci>
          <cn type="integer">2</cn>
         </apply>
         <apply>
          <times></times>
          <cn type="integer">2</cn>
          <ci>H</ci>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p(n;H)\approx 1-e^{-n(n-1)/(2H)}\approx 1-e^{-n^{2}/(2H)},\,
  </annotation>
 </semantics>
</math>

</p>

<p>Let <em>n</em>(<em>p</em>; <em>H</em>) be the smallest number of values we have to choose, such that the probability for finding a collision is at least <em>p</em>. By inverting this expression above, we find the following approximation</p>

<p>

<math display="block" id="Birthday_attack:15">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>n</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>p</mi>
      <mo>;</mo>
      <mi>H</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>≈</mo>
    <msqrt>
     <mrow>
      <mn>2</mn>
      <mi>H</mi>
      <mrow>
       <mi>ln</mi>
       <mfrac>
        <mn>1</mn>
        <mrow>
         <mn>1</mn>
         <mo>-</mo>
         <mi>p</mi>
        </mrow>
       </mfrac>
      </mrow>
     </mrow>
    </msqrt>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <approx></approx>
    <apply>
     <times></times>
     <ci>n</ci>
     <list>
      <ci>p</ci>
      <ci>H</ci>
     </list>
    </apply>
    <apply>
     <root></root>
     <apply>
      <times></times>
      <cn type="integer">2</cn>
      <ci>H</ci>
      <apply>
       <ln></ln>
       <apply>
        <divide></divide>
        <cn type="integer">1</cn>
        <apply>
         <minus></minus>
         <cn type="integer">1</cn>
         <ci>p</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n(p;H)\approx\sqrt{2H\ln\frac{1}{1-p}},
  </annotation>
 </semantics>
</math>

</p>

<p>and assigning a 0.5 probability of collision we arrive at</p>

<p>

<math display="block" id="Birthday_attack:16">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>n</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mn>0.5</mn>
      <mo>;</mo>
      <mi>H</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>≈</mo>
    <mrow>
     <mn>1.1774</mn>
     <msqrt>
      <mi>H</mi>
     </msqrt>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <approx></approx>
    <apply>
     <times></times>
     <ci>n</ci>
     <list>
      <cn type="float">0.5</cn>
      <ci>H</ci>
     </list>
    </apply>
    <apply>
     <times></times>
     <cn type="float">1.1774</cn>
     <apply>
      <root></root>
      <ci>H</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n(0.5;H)\approx 1.1774\sqrt{H}.\,
  </annotation>
 </semantics>
</math>

</p>

<p>Let <em>Q</em>(<em>H</em>) be the expected number of values we have to choose before finding the first collision. This number can be approximated by</p>

<p>

<math display="block" id="Birthday_attack:17">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>Q</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>H</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>≈</mo>
    <msqrt>
     <mrow>
      <mfrac>
       <mi>π</mi>
       <mn>2</mn>
      </mfrac>
      <mi>H</mi>
     </mrow>
    </msqrt>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <approx></approx>
    <apply>
     <times></times>
     <ci>Q</ci>
     <ci>H</ci>
    </apply>
    <apply>
     <root></root>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <ci>π</ci>
       <cn type="integer">2</cn>
      </apply>
      <ci>H</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Q(H)\approx\sqrt{\frac{\pi}{2}H}.
  </annotation>
 </semantics>
</math>

</p>

<p>As an example, if a 64-bit hash is used, there are approximately 1.8 × 10<sup>19</sup> different outputs. If these are all equally probable (the best case), then it would take 'only' approximately 5 billion attempts (5.1 × 10<sup>9</sup>) to generate a collision using brute force. This value is called <strong>birthday bound</strong><a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a> and for <em>n</em>-bit codes it could be computed as 2<sup><em>n</em>/2</sup>.<ref></ref></p>

<p> Other examples are as follows:</p>
<dl>
<dd>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">
<p>Bits</p></th>
<th style="text-align: left;">
<p>Possible outputs<br/>
(2 <a href="significant_figures" title="wikilink">s.f.</a>) (H)</p></th>
<th style="text-align: left;">
<p>Desired probability of random collision<br/>
(2 s.f.) (p)</p></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">
<p>10<sup>−18</sup></p></td>
<td style="text-align: left;">
<p>10<sup>−15</sup></p></td>
<td style="text-align: left;">
<p>10<sup>−12</sup></p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>16</p></td>
<td style="text-align: left;">
<p>65,536</p>
</td>
<td style="text-align: left;">
<p>&lt;2</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>32</p></td>
<td style="text-align: left;">
<p>4.3 × 10<sup>9</sup></p></td>
<td style="text-align: left;">
<p>&lt;2</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>64</p></td>
<td style="text-align: left;">
<p>1.8 × 10<sup>19</sup></p></td>
<td style="text-align: left;">
<p>6</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>128</p></td>
<td style="text-align: left;">
<p>3.4 × 10<sup>38</sup></p></td>
<td style="text-align: left;">
<p>2.6 × 10<sup>10</sup></p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>256</p></td>
<td style="text-align: left;">
<p>1.2 × 10<sup>77</sup></p></td>
<td style="text-align: left;">
<p>4.8 × 10<sup>29</sup></p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>384</p></td>
<td style="text-align: left;">
<p>3.9 × 10<sup>115</sup></p></td>
<td style="text-align: left;">
<p>8.9 × 10<sup>48</sup></p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>512</p></td>
<td style="text-align: left;">
<p>1.3 × 10<sup>154</sup></p></td>
<td style="text-align: left;">
<p>1.6 × 10<sup>68</sup></p></td>
</tr>
</tbody>
</table>
<dl>
<dd><em>Table shows number of hashes n</em>(<em>p</em>)'' needed to achieve the given probability of success, assuming all hashes are equally likely. For comparison, <em>10<sup>−18</sup></em> to <em>10<sup>−15</sup></em> is the uncorrectable bit error rate of a typical hard disk <a href="http://arxiv.org/abs/cs/0701166">1</a>. In theory, <a class="uri" href="MD5" title="wikilink">MD5</a> hashes or <a href="Universally_unique_identifier" title="wikilink">UUIDs</a>, being 128 bits, should stay within that range until about 820 billion documents, even if its possible outputs are many more.''
</dd>
</dl>

<p>It is easy to see that if the outputs of the function are distributed unevenly, then a collision could be found even faster. The notion of 'balance' of a hash function quantifies the resistance of the function to birthday attacks (exploiting uneven key distribution) and allows the vulnerability of popular hashes such as MD and SHA to be estimated (<a href="http://citeseer.ist.psu.edu/bellare02hash.html">Bellare and Kohno, 2004</a>).</p>

<p>The subexpression 

<math display="inline" id="Birthday_attack:18">
 <semantics>
  <mrow>
   <mi>ln</mi>
   <mfrac>
    <mn>1</mn>
    <mrow>
     <mn>1</mn>
     <mo>-</mo>
     <mi>p</mi>
    </mrow>
   </mfrac>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ln></ln>
    <apply>
     <divide></divide>
     <cn type="integer">1</cn>
     <apply>
      <minus></minus>
      <cn type="integer">1</cn>
      <ci>p</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \ln\frac{1}{1-p}
  </annotation>
 </semantics>
</math>

 in the equation for 

<math display="inline" id="Birthday_attack:19">
 <semantics>
  <mrow>
   <mi>n</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>p</mi>
    <mo>;</mo>
    <mi>H</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>n</ci>
    <list>
     <ci>p</ci>
     <ci>H</ci>
    </list>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n(p;H)
  </annotation>
 </semantics>
</math>

 is not computed accurately for small 

<math display="inline" id="Birthday_attack:20">
 <semantics>
  <mi>p</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>p</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p
  </annotation>
 </semantics>
</math>

 when directly translated into common programming languages as <code>log(1/(1-p))</code> due to <a href="loss_of_significance" title="wikilink">loss of significance</a>. When <code>log1p</code> is available (as it is in <a class="uri" href="C99" title="wikilink">C99</a>) for example, the equivalent expression <code>-log1p(-p)</code> should be used instead.<a class="footnoteRef" href="#fn3" id="fnref3"><sup>3</sup></a> If this is not done, the first column of the above table is computed as zero, and several items in the second column do not have even one correct significant digit.</p>
<h3 id="source-code-example">Source code example</h3>

<p>Here is a <a href="Python_(programming_language)" title="wikilink">Python</a> function that can accurately generate most of the above table:</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="kw">def</span> birthday(probability_exponent, bits):
    <span class="im">from</span> math <span class="im">import</span> log1p, sqrt
    probability <span class="op">=</span> <span class="dv">10</span>. <span class="op">**</span> probability_exponent
    outputs     <span class="op">=</span>  <span class="dv">2</span>. <span class="op">**</span> bits
    <span class="cf">return</span> sqrt(<span class="dv">2</span>. <span class="op">*</span> outputs <span class="op">*</span> <span class="op">-</span>log1p(<span class="op">-</span>probability))</code></pre></div>

<p>If the code is saved in a file named <code>birthday.py</code>, it can be run interactively as in the following example:</p>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash">$ <span class="kw">python</span> -i birthday.py
<span class="kw">&gt;&gt;&gt;</span> <span class="kw">birthday</span>(-15, 128)
<span class="kw">824963474247.1193</span>
<span class="kw">&gt;&gt;&gt;</span> <span class="kw">birthday</span>(-6, 32)
<span class="kw">92.68192319417072</span></code></pre></div>
<h3 id="simple-approximation">Simple approximation</h3>

<p>A good <a href="rule_of_thumb" title="wikilink">rule of thumb</a> which can be used for <a href="mental_calculation" title="wikilink">mental calculation</a> is the relation</p>

<p>

<math display="block" id="Birthday_attack:21">
 <semantics>
  <mrow>
   <mrow>
    <mi>p</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>n</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>≈</mo>
   <mfrac>
    <msup>
     <mi>n</mi>
     <mn>2</mn>
    </msup>
    <mrow>
     <mn>2</mn>
     <mi>m</mi>
    </mrow>
   </mfrac>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <approx></approx>
    <apply>
     <times></times>
     <ci>p</ci>
     <ci>n</ci>
    </apply>
    <apply>
     <divide></divide>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>n</ci>
      <cn type="integer">2</cn>
     </apply>
     <apply>
      <times></times>
      <cn type="integer">2</cn>
      <ci>m</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p(n)\approx{n^{2}\over 2m}
  </annotation>
 </semantics>
</math>

</p>

<p>which can also be written as</p>

<p>

<math display="block" id="Birthday_attack:22">
 <semantics>
  <mrow>
   <mi>n</mi>
   <mo>≈</mo>
   <msqrt>
    <mrow>
     <mrow>
      <mrow>
       <mn>2</mn>
       <mi>m</mi>
      </mrow>
      <mo>×</mo>
      <mi>p</mi>
     </mrow>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>n</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </msqrt>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <approx></approx>
    <ci>n</ci>
    <apply>
     <root></root>
     <apply>
      <times></times>
      <apply>
       <times></times>
       <apply>
        <times></times>
        <cn type="integer">2</cn>
        <ci>m</ci>
       </apply>
       <ci>p</ci>
      </apply>
      <ci>n</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n\approx\sqrt{2m\times p(n)}
  </annotation>
 </semantics>
</math>

.</p>

<p>This works well for probabilities less than or equal to 0.5.</p>

<p>This approximation scheme is especially easy to use for when working with exponents. For instance, suppose you are building 32-bit hashes (

<math display="inline" id="Birthday_attack:23">
 <semantics>
  <mrow>
   <mi>m</mi>
   <mo>=</mo>
   <msup>
    <mn>2</mn>
    <mn>32</mn>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>m</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <cn type="integer">2</cn>
     <cn type="integer">32</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   m=2^{32}
  </annotation>
 </semantics>
</math>

) and want the chance of a collision to be at most one in a million (

<math display="inline" id="Birthday_attack:24">
 <semantics>
  <mrow>
   <mi>p</mi>
   <mo>≈</mo>
   <msup>
    <mn>2</mn>
    <mrow>
     <mo>-</mo>
     <mn>20</mn>
    </mrow>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <approx></approx>
    <ci>p</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <cn type="integer">2</cn>
     <apply>
      <minus></minus>
      <cn type="integer">20</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p\approx 2^{-20}
  </annotation>
 </semantics>
</math>

), how many documents could we have at the most?</p>

<p>

<math display="block" id="Birthday_attack:25">
 <semantics>
  <mrow>
   <mi>n</mi>
   <mo>≈</mo>
   <msqrt>
    <mrow>
     <mn>2</mn>
     <mo>×</mo>
     <msup>
      <mn>2</mn>
      <mn>32</mn>
     </msup>
     <mo>×</mo>
     <msup>
      <mn>2</mn>
      <mrow>
       <mo>-</mo>
       <mn>20</mn>
      </mrow>
     </msup>
    </mrow>
   </msqrt>
   <mo>=</mo>
   <msqrt>
    <msup>
     <mn>2</mn>
     <mrow>
      <mrow>
       <mn>1</mn>
       <mo>+</mo>
       <mn>32</mn>
      </mrow>
      <mo>-</mo>
      <mn>20</mn>
     </mrow>
    </msup>
   </msqrt>
   <mo>=</mo>
   <msqrt>
    <msup>
     <mn>2</mn>
     <mn>13</mn>
    </msup>
   </msqrt>
   <mo>=</mo>
   <msup>
    <mn>2</mn>
    <mn>6.5</mn>
   </msup>
   <mo>≈</mo>
   <mn>90.5</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <approx></approx>
     <ci>n</ci>
     <apply>
      <root></root>
      <apply>
       <times></times>
       <cn type="integer">2</cn>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <cn type="integer">2</cn>
        <cn type="integer">32</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <cn type="integer">2</cn>
        <apply>
         <minus></minus>
         <cn type="integer">20</cn>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <root></root>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <cn type="integer">2</cn>
       <apply>
        <minus></minus>
        <apply>
         <plus></plus>
         <cn type="integer">1</cn>
         <cn type="integer">32</cn>
        </apply>
        <cn type="integer">20</cn>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <root></root>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <cn type="integer">2</cn>
       <cn type="integer">13</cn>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <cn type="integer">2</cn>
      <cn type="float">6.5</cn>
     </apply>
    </apply>
    <apply>
     <approx></approx>
     <share href="#.cmml">
     </share>
     <cn type="float">90.5</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n\approx\sqrt{2\times 2^{32}\times 2^{-20}}=\sqrt{2^{1+32-20}}=\sqrt{2^{13}}=2%
^{6.5}\approx 90.5
  </annotation>
 </semantics>
</math>

</p>

<p>which is close to the correct answer of 93.</p>
<h2 id="digital-signature-susceptibility">Digital signature susceptibility</h2>

<p><a href="Digital_signature" title="wikilink">Digital signatures</a> can be susceptible to a birthday attack. A message 

<math display="inline" id="Birthday_attack:26">
 <semantics>
  <mi>m</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>m</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   m
  </annotation>
 </semantics>
</math>

 is typically signed by first computing 

<math display="inline" id="Birthday_attack:27">
 <semantics>
  <mrow>
   <mi>f</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>m</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>f</ci>
    <ci>m</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f(m)
  </annotation>
 </semantics>
</math>

, where 

<math display="inline" id="Birthday_attack:28">
 <semantics>
  <mi>f</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>f</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f
  </annotation>
 </semantics>
</math>

 is a <a href="cryptographic_hash_function" title="wikilink">cryptographic hash function</a>, and then using some secret key to sign 

<math display="inline" id="Birthday_attack:29">
 <semantics>
  <mrow>
   <mi>f</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>m</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>f</ci>
    <ci>m</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f(m)
  </annotation>
 </semantics>
</math>

. Suppose <a href="Alice_and_Bob" title="wikilink">Mallory wants to trick Bob</a> into signing a <a class="uri" href="fraudulent" title="wikilink">fraudulent</a> contract. Mallory prepares a fair contract 

<math display="inline" id="Birthday_attack:30">
 <semantics>
  <mi>m</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>m</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   m
  </annotation>
 </semantics>
</math>

 and a fraudulent one 

<math display="inline" id="Birthday_attack:31">
 <semantics>
  <msup>
   <mi>m</mi>
   <mo>′</mo>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>m</ci>
    <ci>normal-′</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   m^{\prime}
  </annotation>
 </semantics>
</math>

. She then finds a number of positions where 

<math display="inline" id="Birthday_attack:32">
 <semantics>
  <mi>m</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>m</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   m
  </annotation>
 </semantics>
</math>

 can be changed without changing the meaning, such as inserting commas, empty lines, one versus two spaces after a sentence, replacing synonyms, etc. By combining these changes, she can create a huge number of variations on 

<math display="inline" id="Birthday_attack:33">
 <semantics>
  <mi>m</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>m</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   m
  </annotation>
 </semantics>
</math>

 which are all fair contracts.</p>

<p>In a similar manner, Mallory also creates a huge number of variations on the fraudulent contract 

<math display="inline" id="Birthday_attack:34">
 <semantics>
  <msup>
   <mi>m</mi>
   <mo>′</mo>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>m</ci>
    <ci>normal-′</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   m^{\prime}
  </annotation>
 </semantics>
</math>

. She then applies the hash function to all these variations until she finds a version of the fair contract and a version of the fraudulent contract which have the same hash value, 

<math display="inline" id="Birthday_attack:35">
 <semantics>
  <mrow>
   <mrow>
    <mi>f</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>m</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mi>f</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <msup>
      <mi>m</mi>
      <mo>′</mo>
     </msup>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>f</ci>
     <ci>m</ci>
    </apply>
    <apply>
     <times></times>
     <ci>f</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>m</ci>
      <ci>normal-′</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f(m)=f(m^{\prime})
  </annotation>
 </semantics>
</math>

. She presents the fair version to Bob for signing. After Bob has signed, Mallory takes the signature and attaches it to the fraudulent contract. This signature then "proves" that Bob signed the fraudulent contract.</p>

<p>The probabilities differ slightly from the original birthday problem, as Mallory gains nothing by finding two fair or two fraudulent contracts with the same hash. Mallory's strategy is to generate pairs of one fair and one fraudulent contract. The birthday problem equations apply where 

<math display="inline" id="Birthday_attack:36">
 <semantics>
  <mi>n</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>n</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n
  </annotation>
 </semantics>
</math>

 is the number of pairs. The number of hashes Mallory actually generates is 

<math display="inline" id="Birthday_attack:37">
 <semantics>
  <mrow>
   <mn>2</mn>
   <mi>n</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <cn type="integer">2</cn>
    <ci>n</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   2n
  </annotation>
 </semantics>
</math>

.</p>

<p>To avoid this attack, the output length of the hash function used for a signature scheme can be chosen large enough so that the birthday attack becomes computationally infeasible, i.e. about twice as many bits as are needed to prevent an ordinary <a href="brute-force_attack" title="wikilink">brute-force attack</a>.</p>

<p><a href="Pollard's_rho_algorithm_for_logarithms" title="wikilink">Pollard's rho algorithm for logarithms</a> is an example for an algorithm using a birthday attack for the computation of <a href="discrete_logarithm" title="wikilink">discrete logarithms</a>.</p>
<h2 id="see-also">See also</h2>
<ul>
<li><a href="Collision_attack" title="wikilink">Collision attack</a></li>
<li><a href="Meet-in-the-middle_attack" title="wikilink">Meet-in-the-middle attack</a></li>
</ul>
<h2 id="notes">Notes</h2>
<h2 id="references">References</h2>
<ul>
<li><a href="Mihir_Bellare" title="wikilink">Mihir Bellare</a>, Tadayoshi Kohno: Hash Function Balance and Its Impact on Birthday Attacks. <a class="uri" href="EUROCRYPT" title="wikilink">EUROCRYPT</a> 2004: pp401–418</li>
<li><em>Applied Cryptography, 2nd ed.</em> by <a href="Bruce_Schneier" title="wikilink">Bruce Schneier</a></li>
</ul>
<h2 id="external-links">External links</h2>
<ul>
<li><a href="http://www.rsasecurity.com/rsalabs/node.asp?id=2182">"What is a digital signature and what is authentication?"</a> from <a href="RSA_(security_firm)" title="wikilink">RSA Security</a>'s crypto <a class="uri" href="FAQ" title="wikilink">FAQ</a>.</li>
<li><a href="http://x5.net/faqs/crypto/q95.html">"Birthday Attack"</a> X5 Networks Crypto FAQs</li>
</ul>

<p><a class="uri" href="de:Kollisionsangriff#Geburtstagsangriff" title="wikilink">de:Kollisionsangriff#Geburtstagsangriff</a>"</p>

<p><a href="Category:Cryptographic_attacks" title="wikilink">Category:Cryptographic attacks</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1"><a href="#fnref1">↩</a></li>
<li id="fn2">See <a href="upper_and_lower_bounds" title="wikilink">upper and lower bounds</a>.<a href="#fnref2">↩</a></li>
<li id="fn3"><a href="#fnref3">↩</a></li>
</ol>
</section>
</dd></dl></body>


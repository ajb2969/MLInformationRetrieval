<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="603">Laplacian matrix</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Laplacian matrix</h1>
<style>
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
<style>
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
  </style>
</body></html>
<body>
<hr/>

<p>In the <a href="mathematics" title="wikilink">mathematical</a> field of <a href="graph_theory" title="wikilink">graph theory</a>, the <strong>Laplacian matrix</strong>, sometimes called <strong>admittance matrix</strong>, <strong>Kirchhoff matrix</strong> or <strong>discrete Laplacian</strong>, is a <a href="matrix_(mathematics)" title="wikilink">matrix</a> representation of a <a href="graph_(mathematics)" title="wikilink">graph</a>. Together with <a href="Kirchhoff's_theorem" title="wikilink">Kirchhoff's theorem</a>, it can be used to calculate the number of <a href="spanning_tree_(mathematics)" title="wikilink">spanning trees</a> for a given graph. The Laplacian matrix can be used to find many other properties of the graph. <a href="Cheeger_constant#Cheeger.27s_inequality" title="wikilink">Cheeger's inequality</a> from <a href="Riemannian_geometry" title="wikilink">Riemannian geometry</a> has a discrete analogue involving the Laplacian matrix; this is perhaps the most important theorem in <a href="spectral_graph_theory" title="wikilink">spectral graph theory</a> and one of the most useful facts in algorithmic applications. It approximates the sparsest cut of a graph through the second eigenvalue of its Laplacian.</p>
<h2 id="definition">Definition</h2>

<p>Given a <a href="simple_graph" title="wikilink">simple graph</a> <em>G</em> with <em>n</em> vertices, its Laplacian matrix 

<math display="inline" id="Laplacian_matrix:0">
 <semantics>
  <msub>
   <mi>L</mi>
   <mrow>
    <mi>n</mi>
    <mo>×</mo>
    <mi>n</mi>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>L</ci>
    <apply>
     <times></times>
     <ci>n</ci>
     <ci>n</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   L_{n\times n}
  </annotation>
 </semantics>
</math>

 is defined as:<a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a></p>

<p>

<math display="block" id="Laplacian_matrix:1">
 <semantics>
  <mrow>
   <mrow>
    <mi>L</mi>
    <mo>=</mo>
    <mrow>
     <mi>D</mi>
     <mo>-</mo>
     <mi>A</mi>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>L</ci>
    <apply>
     <minus></minus>
     <ci>D</ci>
     <ci>A</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   L=D-A,
  </annotation>
 </semantics>
</math>

 where <em>D</em> is the <a href="degree_matrix" title="wikilink">degree matrix</a> and <em>A</em> is the <a href="adjacency_matrix" title="wikilink">adjacency matrix</a> of the graph. In the case of <a href="directed_graph" title="wikilink">directed graphs</a>, either the <a href="degree_(graph_theory)" title="wikilink">indegree or outdegree</a> might be used, depending on the application.</p>

<p>The elements of 

<math display="inline" id="Laplacian_matrix:2">
 <semantics>
  <mi>L</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>L</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   L
  </annotation>
 </semantics>
</math>

 are given by</p>

<p>

<math display="block" id="Laplacian_matrix:3">
 <semantics>
  <mrow>
   <msub>
    <mi>L</mi>
    <mrow>
     <mi>i</mi>
     <mo>,</mo>
     <mi>j</mi>
    </mrow>
   </msub>
   <mo>:=</mo>
   <mrow>
    <mo>{</mo>
    <mtable displaystyle="true">
     <mtr>
      <mtd columnalign="left">
       <mrow>
        <mi>deg</mi>
        <mrow>
         <mo stretchy="false">(</mo>
         <msub>
          <mi>v</mi>
          <mi>i</mi>
         </msub>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
      </mtd>
      <mtd columnalign="left">
       <mrow>
        <mrow>
         <mpadded width="+5pt">
          <mtext>if</mtext>
         </mpadded>
         <mi>i</mi>
        </mrow>
        <mo>=</mo>
        <mi>j</mi>
       </mrow>
      </mtd>
     </mtr>
     <mtr>
      <mtd columnalign="left">
       <mrow>
        <mo>-</mo>
        <mn>1</mn>
       </mrow>
      </mtd>
      <mtd columnalign="left">
       <mrow>
        <mrow>
         <mpadded width="+5pt">
          <mtext>if</mtext>
         </mpadded>
         <mi>i</mi>
        </mrow>
        <mo>≠</mo>
        <mrow>
         <mpadded width="+5pt">
          <mi>j</mi>
         </mpadded>
         <mpadded width="+5pt">
          <mtext>and</mtext>
         </mpadded>
         <msub>
          <mi>v</mi>
          <mi>i</mi>
         </msub>
         <mtext>is adjacent to</mtext>
         <msub>
          <mi>v</mi>
          <mi>j</mi>
         </msub>
        </mrow>
       </mrow>
      </mtd>
     </mtr>
     <mtr>
      <mtd columnalign="left">
       <mn>0</mn>
      </mtd>
      <mtd columnalign="left">
       <mtext>otherwise</mtext>
      </mtd>
     </mtr>
    </mtable>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">assign</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>L</ci>
     <list>
      <ci>i</ci>
      <ci>j</ci>
     </list>
    </apply>
    <apply>
     <csymbol cd="latexml">cases</csymbol>
     <apply>
      <csymbol cd="latexml">degree</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>v</ci>
       <ci>i</ci>
      </apply>
     </apply>
     <apply>
      <eq></eq>
      <apply>
       <times></times>
       <mtext>if</mtext>
       <ci>i</ci>
      </apply>
      <ci>j</ci>
     </apply>
     <apply>
      <minus></minus>
      <cn type="integer">1</cn>
     </apply>
     <apply>
      <neq></neq>
      <apply>
       <times></times>
       <mtext>if</mtext>
       <ci>i</ci>
      </apply>
      <apply>
       <times></times>
       <ci>j</ci>
       <mtext>and</mtext>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>v</ci>
        <ci>i</ci>
       </apply>
       <mtext>is adjacent to</mtext>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>v</ci>
        <ci>j</ci>
       </apply>
      </apply>
     </apply>
     <cn type="integer">0</cn>
     <mtext>otherwise</mtext>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   L_{i,j}:=\begin{cases}\deg(v_{i})&\mbox{if}\ i=j\\
-1&\mbox{if}\ i\neq j\ \mbox{and}\ v_{i}\mbox{ is adjacent to }v_{j}\\
0&\mbox{otherwise}\end{cases}
  </annotation>
 </semantics>
</math>

</p>

<p>where deg(<em>v<sub>i</sub></em>) is degree of the vertex <em>i</em>.</p>

<p>The <a href="#Symmetric_normalized_Laplacian" title="wikilink">symmetric normalized Laplacian matrix</a> is defined as:<a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a></p>

<p>

<math display="block" id="Laplacian_matrix:4">
 <semantics>
  <mrow>
   <msup>
    <mi>L</mi>
    <mtext>sym</mtext>
   </msup>
   <mo>:=</mo>
   <mrow>
    <msup>
     <mi>D</mi>
     <mrow>
      <mo>-</mo>
      <mrow>
       <mn>1</mn>
       <mo>/</mo>
       <mn>2</mn>
      </mrow>
     </mrow>
    </msup>
    <mi>L</mi>
    <msup>
     <mi>D</mi>
     <mrow>
      <mo>-</mo>
      <mrow>
       <mn>1</mn>
       <mo>/</mo>
       <mn>2</mn>
      </mrow>
     </mrow>
    </msup>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mi>I</mi>
    <mo>-</mo>
    <mrow>
     <msup>
      <mi>D</mi>
      <mrow>
       <mo>-</mo>
       <mrow>
        <mn>1</mn>
        <mo>/</mo>
        <mn>2</mn>
       </mrow>
      </mrow>
     </msup>
     <mi>A</mi>
     <msup>
      <mi>D</mi>
      <mrow>
       <mo>-</mo>
       <mrow>
        <mn>1</mn>
        <mo>/</mo>
        <mn>2</mn>
       </mrow>
      </mrow>
     </msup>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <csymbol cd="latexml">assign</csymbol>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>L</ci>
      <mtext>sym</mtext>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>D</ci>
       <apply>
        <minus></minus>
        <apply>
         <divide></divide>
         <cn type="integer">1</cn>
         <cn type="integer">2</cn>
        </apply>
       </apply>
      </apply>
      <ci>L</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>D</ci>
       <apply>
        <minus></minus>
        <apply>
         <divide></divide>
         <cn type="integer">1</cn>
         <cn type="integer">2</cn>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <minus></minus>
      <ci>I</ci>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>D</ci>
        <apply>
         <minus></minus>
         <apply>
          <divide></divide>
          <cn type="integer">1</cn>
          <cn type="integer">2</cn>
         </apply>
        </apply>
       </apply>
       <ci>A</ci>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>D</ci>
        <apply>
         <minus></minus>
         <apply>
          <divide></divide>
          <cn type="integer">1</cn>
          <cn type="integer">2</cn>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   L^{\text{sym}}:=D^{-1/2}LD^{-1/2}=I-D^{-1/2}AD^{-1/2}
  </annotation>
 </semantics>
</math>

,</p>

<p>The elements of 

<math display="inline" id="Laplacian_matrix:5">
 <semantics>
  <msup>
   <mi>L</mi>
   <mtext>sym</mtext>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>L</ci>
    <mtext>sym</mtext>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   L^{\text{sym}}
  </annotation>
 </semantics>
</math>

 are given by</p>

<p>

<math display="block" id="Laplacian_matrix:6">
 <semantics>
  <mrow>
   <msubsup>
    <mi>L</mi>
    <mrow>
     <mi>i</mi>
     <mo>,</mo>
     <mi>j</mi>
    </mrow>
    <mtext>sym</mtext>
   </msubsup>
   <mo>:=</mo>
   <mrow>
    <mo>{</mo>
    <mtable displaystyle="true">
     <mtr>
      <mtd columnalign="left">
       <mn>1</mn>
      </mtd>
      <mtd columnalign="left">
       <mrow>
        <mrow>
         <mpadded width="+5pt">
          <mtext>if</mtext>
         </mpadded>
         <mi>i</mi>
        </mrow>
        <mo>=</mo>
        <mrow>
         <mpadded width="+5pt">
          <mi>j</mi>
         </mpadded>
         <mpadded width="+5pt">
          <mtext>and</mtext>
         </mpadded>
         <mrow>
          <mi>deg</mi>
          <mrow>
           <mo stretchy="false">(</mo>
           <msub>
            <mi>v</mi>
            <mi>i</mi>
           </msub>
           <mo stretchy="false">)</mo>
          </mrow>
         </mrow>
        </mrow>
        <mo>≠</mo>
        <mn>0</mn>
       </mrow>
      </mtd>
     </mtr>
     <mtr>
      <mtd columnalign="left">
       <mrow>
        <mo>-</mo>
        <mstyle displaystyle="false">
         <mfrac>
          <mn>1</mn>
          <msqrt>
           <mrow>
            <mrow>
             <mi>deg</mi>
             <mrow>
              <mo stretchy="false">(</mo>
              <msub>
               <mi>v</mi>
               <mi>i</mi>
              </msub>
              <mo stretchy="false">)</mo>
             </mrow>
            </mrow>
            <mrow>
             <mi>deg</mi>
             <mrow>
              <mo stretchy="false">(</mo>
              <msub>
               <mi>v</mi>
               <mi>j</mi>
              </msub>
              <mo stretchy="false">)</mo>
             </mrow>
            </mrow>
           </mrow>
          </msqrt>
         </mfrac>
        </mstyle>
       </mrow>
      </mtd>
      <mtd columnalign="left">
       <mrow>
        <mrow>
         <mpadded width="+5pt">
          <mtext>if</mtext>
         </mpadded>
         <mi>i</mi>
        </mrow>
        <mo>≠</mo>
        <mrow>
         <mpadded width="+5pt">
          <mi>j</mi>
         </mpadded>
         <mpadded width="+5pt">
          <mtext>and</mtext>
         </mpadded>
         <msub>
          <mi>v</mi>
          <mi>i</mi>
         </msub>
         <mtext>is adjacent to</mtext>
         <msub>
          <mi>v</mi>
          <mi>j</mi>
         </msub>
        </mrow>
       </mrow>
      </mtd>
     </mtr>
     <mtr>
      <mtd columnalign="left">
       <mn>0</mn>
      </mtd>
      <mtd columnalign="left">
       <mrow>
        <mtext>otherwise</mtext>
        <mo>.</mo>
       </mrow>
      </mtd>
     </mtr>
    </mtable>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">assign</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>L</ci>
      <mtext>sym</mtext>
     </apply>
     <list>
      <ci>i</ci>
      <ci>j</ci>
     </list>
    </apply>
    <apply>
     <csymbol cd="latexml">cases</csymbol>
     <cn type="integer">1</cn>
     <apply>
      <and></and>
      <apply>
       <eq></eq>
       <apply>
        <times></times>
        <mtext>if</mtext>
        <ci>i</ci>
       </apply>
       <apply>
        <times></times>
        <ci>j</ci>
        <mtext>and</mtext>
        <apply>
         <csymbol cd="latexml">degree</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>v</ci>
          <ci>i</ci>
         </apply>
        </apply>
       </apply>
      </apply>
      <apply>
       <neq></neq>
       <share href="#.cmml">
       </share>
       <cn type="integer">0</cn>
      </apply>
     </apply>
     <apply>
      <minus></minus>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <apply>
        <root></root>
        <apply>
         <times></times>
         <apply>
          <csymbol cd="latexml">degree</csymbol>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>v</ci>
           <ci>i</ci>
          </apply>
         </apply>
         <apply>
          <csymbol cd="latexml">degree</csymbol>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>v</ci>
           <ci>j</ci>
          </apply>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <neq></neq>
      <apply>
       <times></times>
       <mtext>if</mtext>
       <ci>i</ci>
      </apply>
      <apply>
       <times></times>
       <ci>j</ci>
       <mtext>and</mtext>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>v</ci>
        <ci>i</ci>
       </apply>
       <mtext>is adjacent to</mtext>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>v</ci>
        <ci>j</ci>
       </apply>
      </apply>
     </apply>
     <cn type="integer">0</cn>
     <mtext>otherwise</mtext>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   L^{\text{sym}}_{i,j}:=\begin{cases}1&\mbox{if}\ i=j\ \mbox{and}\ \deg(v_{i})%
\neq 0\\
-\frac{1}{\sqrt{\deg(v_{i})\deg(v_{j})}}&\mbox{if}\ i\neq j\ \mbox{and}\ v_{i}%
\mbox{ is adjacent to }v_{j}\\
0&\mbox{otherwise}.\end{cases}
  </annotation>
 </semantics>
</math>

</p>

<p>The <a href="#Random_walk_normalized_Laplacian" title="wikilink">random-walk normalized Laplacian matrix</a> is defined as:</p>

<p>

<math display="block" id="Laplacian_matrix:7">
 <semantics>
  <mrow>
   <msup>
    <mi>L</mi>
    <mtext>rw</mtext>
   </msup>
   <mo>:=</mo>
   <mrow>
    <msup>
     <mi>D</mi>
     <mrow>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </msup>
    <mi>L</mi>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mi>I</mi>
    <mo>-</mo>
    <mrow>
     <msup>
      <mi>D</mi>
      <mrow>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
     </msup>
     <mi>A</mi>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <csymbol cd="latexml">assign</csymbol>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>L</ci>
      <mtext>rw</mtext>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>D</ci>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <ci>L</ci>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <minus></minus>
      <ci>I</ci>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>D</ci>
        <apply>
         <minus></minus>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <ci>A</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   L^{\text{rw}}:=D^{-1}L=I-D^{-1}A
  </annotation>
 </semantics>
</math>

</p>

<p>The elements of 

<math display="inline" id="Laplacian_matrix:8">
 <semantics>
  <msup>
   <mi>L</mi>
   <mtext>rw</mtext>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>L</ci>
    <mtext>rw</mtext>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   L^{\text{rw}}
  </annotation>
 </semantics>
</math>

 are given by</p>

<p>

<math display="block" id="Laplacian_matrix:9">
 <semantics>
  <mrow>
   <msubsup>
    <mi>L</mi>
    <mrow>
     <mi>i</mi>
     <mo>,</mo>
     <mi>j</mi>
    </mrow>
    <mtext>rw</mtext>
   </msubsup>
   <mo>:=</mo>
   <mrow>
    <mo>{</mo>
    <mtable displaystyle="true">
     <mtr>
      <mtd columnalign="left">
       <mn>1</mn>
      </mtd>
      <mtd columnalign="left">
       <mrow>
        <mrow>
         <mpadded width="+5pt">
          <mtext>if</mtext>
         </mpadded>
         <mi>i</mi>
        </mrow>
        <mo>=</mo>
        <mrow>
         <mpadded width="+5pt">
          <mi>j</mi>
         </mpadded>
         <mpadded width="+5pt">
          <mtext>and</mtext>
         </mpadded>
         <mrow>
          <mi>deg</mi>
          <mrow>
           <mo stretchy="false">(</mo>
           <msub>
            <mi>v</mi>
            <mi>i</mi>
           </msub>
           <mo stretchy="false">)</mo>
          </mrow>
         </mrow>
        </mrow>
        <mo>≠</mo>
        <mn>0</mn>
       </mrow>
      </mtd>
     </mtr>
     <mtr>
      <mtd columnalign="left">
       <mrow>
        <mo>-</mo>
        <mstyle displaystyle="false">
         <mfrac>
          <mn>1</mn>
          <mrow>
           <mi>deg</mi>
           <mrow>
            <mo stretchy="false">(</mo>
            <msub>
             <mi>v</mi>
             <mi>i</mi>
            </msub>
            <mo stretchy="false">)</mo>
           </mrow>
          </mrow>
         </mfrac>
        </mstyle>
       </mrow>
      </mtd>
      <mtd columnalign="left">
       <mrow>
        <mrow>
         <mpadded width="+5pt">
          <mtext>if</mtext>
         </mpadded>
         <mi>i</mi>
        </mrow>
        <mo>≠</mo>
        <mrow>
         <mpadded width="+5pt">
          <mi>j</mi>
         </mpadded>
         <mpadded width="+5pt">
          <mtext>and</mtext>
         </mpadded>
         <msub>
          <mi>v</mi>
          <mi>i</mi>
         </msub>
         <mtext>is adjacent to</mtext>
         <msub>
          <mi>v</mi>
          <mi>j</mi>
         </msub>
        </mrow>
       </mrow>
      </mtd>
     </mtr>
     <mtr>
      <mtd columnalign="left">
       <mn>0</mn>
      </mtd>
      <mtd columnalign="left">
       <mrow>
        <mtext>otherwise</mtext>
        <mo>.</mo>
       </mrow>
      </mtd>
     </mtr>
    </mtable>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">assign</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>L</ci>
      <mtext>rw</mtext>
     </apply>
     <list>
      <ci>i</ci>
      <ci>j</ci>
     </list>
    </apply>
    <apply>
     <csymbol cd="latexml">cases</csymbol>
     <cn type="integer">1</cn>
     <apply>
      <and></and>
      <apply>
       <eq></eq>
       <apply>
        <times></times>
        <mtext>if</mtext>
        <ci>i</ci>
       </apply>
       <apply>
        <times></times>
        <ci>j</ci>
        <mtext>and</mtext>
        <apply>
         <csymbol cd="latexml">degree</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>v</ci>
          <ci>i</ci>
         </apply>
        </apply>
       </apply>
      </apply>
      <apply>
       <neq></neq>
       <share href="#.cmml">
       </share>
       <cn type="integer">0</cn>
      </apply>
     </apply>
     <apply>
      <minus></minus>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <apply>
        <csymbol cd="latexml">degree</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>v</ci>
         <ci>i</ci>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <neq></neq>
      <apply>
       <times></times>
       <mtext>if</mtext>
       <ci>i</ci>
      </apply>
      <apply>
       <times></times>
       <ci>j</ci>
       <mtext>and</mtext>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>v</ci>
        <ci>i</ci>
       </apply>
       <mtext>is adjacent to</mtext>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>v</ci>
        <ci>j</ci>
       </apply>
      </apply>
     </apply>
     <cn type="integer">0</cn>
     <mtext>otherwise</mtext>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   L^{\text{rw}}_{i,j}:=\begin{cases}1&\mbox{if}\ i=j\ \mbox{and}\ \deg(v_{i})%
\neq 0\\
-\frac{1}{\deg(v_{i})}&\mbox{if}\ i\neq j\ \mbox{and}\ v_{i}\mbox{ is adjacent%
 to }v_{j}\\
0&\mbox{otherwise}.\end{cases}
  </annotation>
 </semantics>
</math>

</p>
<h2 id="example">Example</h2>

<p>Here is a simple example of a labeled graph and its Laplacian matrix.</p>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">
<p><a href="Labeled_graph" title="wikilink">Labeled graph</a></p></th>
<th style="text-align: left;">
<p>Degree matrix</p></th>
<th style="text-align: left;">
<p>Adjacency matrix</p></th>
<th style="text-align: left;">
<p>Laplacian matrix</p></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">
<p><a href="image:6n-graf.svg" title="wikilink">175px</a></p></td>
<td style="text-align: left;">
<p>

<math display="inline" id="Laplacian_matrix:10">
 <semantics>
  <mrow>
   <mo>(</mo>
   <mtable>
    <mtr>
     <mtd columnalign="right">
      <mn>2</mn>
     </mtd>
     <mtd columnalign="right">
      <mn>0</mn>
     </mtd>
     <mtd columnalign="right">
      <mn>0</mn>
     </mtd>
     <mtd columnalign="right">
      <mn>0</mn>
     </mtd>
     <mtd columnalign="right">
      <mn>0</mn>
     </mtd>
     <mtd columnalign="right">
      <mn>0</mn>
     </mtd>
    </mtr>
    <mtr>
     <mtd columnalign="right">
      <mn>0</mn>
     </mtd>
     <mtd columnalign="right">
      <mn>3</mn>
     </mtd>
     <mtd columnalign="right">
      <mn>0</mn>
     </mtd>
     <mtd columnalign="right">
      <mn>0</mn>
     </mtd>
     <mtd columnalign="right">
      <mn>0</mn>
     </mtd>
     <mtd columnalign="right">
      <mn>0</mn>
     </mtd>
    </mtr>
    <mtr>
     <mtd columnalign="right">
      <mn>0</mn>
     </mtd>
     <mtd columnalign="right">
      <mn>0</mn>
     </mtd>
     <mtd columnalign="right">
      <mn>2</mn>
     </mtd>
     <mtd columnalign="right">
      <mn>0</mn>
     </mtd>
     <mtd columnalign="right">
      <mn>0</mn>
     </mtd>
     <mtd columnalign="right">
      <mn>0</mn>
     </mtd>
    </mtr>
    <mtr>
     <mtd columnalign="right">
      <mn>0</mn>
     </mtd>
     <mtd columnalign="right">
      <mn>0</mn>
     </mtd>
     <mtd columnalign="right">
      <mn>0</mn>
     </mtd>
     <mtd columnalign="right">
      <mn>3</mn>
     </mtd>
     <mtd columnalign="right">
      <mn>0</mn>
     </mtd>
     <mtd columnalign="right">
      <mn>0</mn>
     </mtd>
    </mtr>
    <mtr>
     <mtd columnalign="right">
      <mn>0</mn>
     </mtd>
     <mtd columnalign="right">
      <mn>0</mn>
     </mtd>
     <mtd columnalign="right">
      <mn>0</mn>
     </mtd>
     <mtd columnalign="right">
      <mn>0</mn>
     </mtd>
     <mtd columnalign="right">
      <mn>3</mn>
     </mtd>
     <mtd columnalign="right">
      <mn>0</mn>
     </mtd>
    </mtr>
    <mtr>
     <mtd columnalign="right">
      <mn>0</mn>
     </mtd>
     <mtd columnalign="right">
      <mn>0</mn>
     </mtd>
     <mtd columnalign="right">
      <mn>0</mn>
     </mtd>
     <mtd columnalign="right">
      <mn>0</mn>
     </mtd>
     <mtd columnalign="right">
      <mn>0</mn>
     </mtd>
     <mtd columnalign="right">
      <mn>1</mn>
     </mtd>
    </mtr>
   </mtable>
   <mo>)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <matrix>
    <matrixrow>
     <cn type="integer">2</cn>
     <cn type="integer">0</cn>
     <cn type="integer">0</cn>
     <cn type="integer">0</cn>
     <cn type="integer">0</cn>
     <cn type="integer">0</cn>
    </matrixrow>
    <matrixrow>
     <cn type="integer">0</cn>
     <cn type="integer">3</cn>
     <cn type="integer">0</cn>
     <cn type="integer">0</cn>
     <cn type="integer">0</cn>
     <cn type="integer">0</cn>
    </matrixrow>
    <matrixrow>
     <cn type="integer">0</cn>
     <cn type="integer">0</cn>
     <cn type="integer">2</cn>
     <cn type="integer">0</cn>
     <cn type="integer">0</cn>
     <cn type="integer">0</cn>
    </matrixrow>
    <matrixrow>
     <cn type="integer">0</cn>
     <cn type="integer">0</cn>
     <cn type="integer">0</cn>
     <cn type="integer">3</cn>
     <cn type="integer">0</cn>
     <cn type="integer">0</cn>
    </matrixrow>
    <matrixrow>
     <cn type="integer">0</cn>
     <cn type="integer">0</cn>
     <cn type="integer">0</cn>
     <cn type="integer">0</cn>
     <cn type="integer">3</cn>
     <cn type="integer">0</cn>
    </matrixrow>
    <matrixrow>
     <cn type="integer">0</cn>
     <cn type="integer">0</cn>
     <cn type="integer">0</cn>
     <cn type="integer">0</cn>
     <cn type="integer">0</cn>
     <cn type="integer">1</cn>
    </matrixrow>
   </matrix>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \left(\begin{array}[]{rrrrrr}2&0&0&0&0&0\\
0&3&0&0&0&0\\
0&0&2&0&0&0\\
0&0&0&3&0&0\\
0&0&0&0&3&0\\
0&0&0&0&0&1\\
\end{array}\right)
  </annotation>
 </semantics>
</math>

</p></td>
<td style="text-align: left;">
<p>

<math display="inline" id="Laplacian_matrix:11">
 <semantics>
  <mrow>
   <mo>(</mo>
   <mtable>
    <mtr>
     <mtd columnalign="right">
      <mn>0</mn>
     </mtd>
     <mtd columnalign="right">
      <mn>1</mn>
     </mtd>
     <mtd columnalign="right">
      <mn>0</mn>
     </mtd>
     <mtd columnalign="right">
      <mn>0</mn>
     </mtd>
     <mtd columnalign="right">
      <mn>1</mn>
     </mtd>
     <mtd columnalign="right">
      <mn>0</mn>
     </mtd>
    </mtr>
    <mtr>
     <mtd columnalign="right">
      <mn>1</mn>
     </mtd>
     <mtd columnalign="right">
      <mn>0</mn>
     </mtd>
     <mtd columnalign="right">
      <mn>1</mn>
     </mtd>
     <mtd columnalign="right">
      <mn>0</mn>
     </mtd>
     <mtd columnalign="right">
      <mn>1</mn>
     </mtd>
     <mtd columnalign="right">
      <mn>0</mn>
     </mtd>
    </mtr>
    <mtr>
     <mtd columnalign="right">
      <mn>0</mn>
     </mtd>
     <mtd columnalign="right">
      <mn>1</mn>
     </mtd>
     <mtd columnalign="right">
      <mn>0</mn>
     </mtd>
     <mtd columnalign="right">
      <mn>1</mn>
     </mtd>
     <mtd columnalign="right">
      <mn>0</mn>
     </mtd>
     <mtd columnalign="right">
      <mn>0</mn>
     </mtd>
    </mtr>
    <mtr>
     <mtd columnalign="right">
      <mn>0</mn>
     </mtd>
     <mtd columnalign="right">
      <mn>0</mn>
     </mtd>
     <mtd columnalign="right">
      <mn>1</mn>
     </mtd>
     <mtd columnalign="right">
      <mn>0</mn>
     </mtd>
     <mtd columnalign="right">
      <mn>1</mn>
     </mtd>
     <mtd columnalign="right">
      <mn>1</mn>
     </mtd>
    </mtr>
    <mtr>
     <mtd columnalign="right">
      <mn>1</mn>
     </mtd>
     <mtd columnalign="right">
      <mn>1</mn>
     </mtd>
     <mtd columnalign="right">
      <mn>0</mn>
     </mtd>
     <mtd columnalign="right">
      <mn>1</mn>
     </mtd>
     <mtd columnalign="right">
      <mn>0</mn>
     </mtd>
     <mtd columnalign="right">
      <mn>0</mn>
     </mtd>
    </mtr>
    <mtr>
     <mtd columnalign="right">
      <mn>0</mn>
     </mtd>
     <mtd columnalign="right">
      <mn>0</mn>
     </mtd>
     <mtd columnalign="right">
      <mn>0</mn>
     </mtd>
     <mtd columnalign="right">
      <mn>1</mn>
     </mtd>
     <mtd columnalign="right">
      <mn>0</mn>
     </mtd>
     <mtd columnalign="right">
      <mn>0</mn>
     </mtd>
    </mtr>
   </mtable>
   <mo>)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <matrix>
    <matrixrow>
     <cn type="integer">0</cn>
     <cn type="integer">1</cn>
     <cn type="integer">0</cn>
     <cn type="integer">0</cn>
     <cn type="integer">1</cn>
     <cn type="integer">0</cn>
    </matrixrow>
    <matrixrow>
     <cn type="integer">1</cn>
     <cn type="integer">0</cn>
     <cn type="integer">1</cn>
     <cn type="integer">0</cn>
     <cn type="integer">1</cn>
     <cn type="integer">0</cn>
    </matrixrow>
    <matrixrow>
     <cn type="integer">0</cn>
     <cn type="integer">1</cn>
     <cn type="integer">0</cn>
     <cn type="integer">1</cn>
     <cn type="integer">0</cn>
     <cn type="integer">0</cn>
    </matrixrow>
    <matrixrow>
     <cn type="integer">0</cn>
     <cn type="integer">0</cn>
     <cn type="integer">1</cn>
     <cn type="integer">0</cn>
     <cn type="integer">1</cn>
     <cn type="integer">1</cn>
    </matrixrow>
    <matrixrow>
     <cn type="integer">1</cn>
     <cn type="integer">1</cn>
     <cn type="integer">0</cn>
     <cn type="integer">1</cn>
     <cn type="integer">0</cn>
     <cn type="integer">0</cn>
    </matrixrow>
    <matrixrow>
     <cn type="integer">0</cn>
     <cn type="integer">0</cn>
     <cn type="integer">0</cn>
     <cn type="integer">1</cn>
     <cn type="integer">0</cn>
     <cn type="integer">0</cn>
    </matrixrow>
   </matrix>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \left(\begin{array}[]{rrrrrr}0&1&0&0&1&0\\
1&0&1&0&1&0\\
0&1&0&1&0&0\\
0&0&1&0&1&1\\
1&1&0&1&0&0\\
0&0&0&1&0&0\\
\end{array}\right)
  </annotation>
 </semantics>
</math>

</p></td>
<td style="text-align: left;">
<p>

<math display="inline" id="Laplacian_matrix:12">
 <semantics>
  <mrow>
   <mo>(</mo>
   <mtable>
    <mtr>
     <mtd columnalign="right">
      <mn>2</mn>
     </mtd>
     <mtd columnalign="right">
      <mrow>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
     </mtd>
     <mtd columnalign="right">
      <mn>0</mn>
     </mtd>
     <mtd columnalign="right">
      <mn>0</mn>
     </mtd>
     <mtd columnalign="right">
      <mrow>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
     </mtd>
     <mtd columnalign="right">
      <mn>0</mn>
     </mtd>
    </mtr>
    <mtr>
     <mtd columnalign="right">
      <mrow>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
     </mtd>
     <mtd columnalign="right">
      <mn>3</mn>
     </mtd>
     <mtd columnalign="right">
      <mrow>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
     </mtd>
     <mtd columnalign="right">
      <mn>0</mn>
     </mtd>
     <mtd columnalign="right">
      <mrow>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
     </mtd>
     <mtd columnalign="right">
      <mn>0</mn>
     </mtd>
    </mtr>
    <mtr>
     <mtd columnalign="right">
      <mn>0</mn>
     </mtd>
     <mtd columnalign="right">
      <mrow>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
     </mtd>
     <mtd columnalign="right">
      <mn>2</mn>
     </mtd>
     <mtd columnalign="right">
      <mrow>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
     </mtd>
     <mtd columnalign="right">
      <mn>0</mn>
     </mtd>
     <mtd columnalign="right">
      <mn>0</mn>
     </mtd>
    </mtr>
    <mtr>
     <mtd columnalign="right">
      <mn>0</mn>
     </mtd>
     <mtd columnalign="right">
      <mn>0</mn>
     </mtd>
     <mtd columnalign="right">
      <mrow>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
     </mtd>
     <mtd columnalign="right">
      <mn>3</mn>
     </mtd>
     <mtd columnalign="right">
      <mrow>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
     </mtd>
     <mtd columnalign="right">
      <mrow>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
     </mtd>
    </mtr>
    <mtr>
     <mtd columnalign="right">
      <mrow>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
     </mtd>
     <mtd columnalign="right">
      <mrow>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
     </mtd>
     <mtd columnalign="right">
      <mn>0</mn>
     </mtd>
     <mtd columnalign="right">
      <mrow>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
     </mtd>
     <mtd columnalign="right">
      <mn>3</mn>
     </mtd>
     <mtd columnalign="right">
      <mn>0</mn>
     </mtd>
    </mtr>
    <mtr>
     <mtd columnalign="right">
      <mn>0</mn>
     </mtd>
     <mtd columnalign="right">
      <mn>0</mn>
     </mtd>
     <mtd columnalign="right">
      <mn>0</mn>
     </mtd>
     <mtd columnalign="right">
      <mrow>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
     </mtd>
     <mtd columnalign="right">
      <mn>0</mn>
     </mtd>
     <mtd columnalign="right">
      <mn>1</mn>
     </mtd>
    </mtr>
   </mtable>
   <mo>)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <matrix>
    <matrixrow>
     <cn type="integer">2</cn>
     <apply>
      <minus></minus>
      <cn type="integer">1</cn>
     </apply>
     <cn type="integer">0</cn>
     <cn type="integer">0</cn>
     <apply>
      <minus></minus>
      <cn type="integer">1</cn>
     </apply>
     <cn type="integer">0</cn>
    </matrixrow>
    <matrixrow>
     <apply>
      <minus></minus>
      <cn type="integer">1</cn>
     </apply>
     <cn type="integer">3</cn>
     <apply>
      <minus></minus>
      <cn type="integer">1</cn>
     </apply>
     <cn type="integer">0</cn>
     <apply>
      <minus></minus>
      <cn type="integer">1</cn>
     </apply>
     <cn type="integer">0</cn>
    </matrixrow>
    <matrixrow>
     <cn type="integer">0</cn>
     <apply>
      <minus></minus>
      <cn type="integer">1</cn>
     </apply>
     <cn type="integer">2</cn>
     <apply>
      <minus></minus>
      <cn type="integer">1</cn>
     </apply>
     <cn type="integer">0</cn>
     <cn type="integer">0</cn>
    </matrixrow>
    <matrixrow>
     <cn type="integer">0</cn>
     <cn type="integer">0</cn>
     <apply>
      <minus></minus>
      <cn type="integer">1</cn>
     </apply>
     <cn type="integer">3</cn>
     <apply>
      <minus></minus>
      <cn type="integer">1</cn>
     </apply>
     <apply>
      <minus></minus>
      <cn type="integer">1</cn>
     </apply>
    </matrixrow>
    <matrixrow>
     <apply>
      <minus></minus>
      <cn type="integer">1</cn>
     </apply>
     <apply>
      <minus></minus>
      <cn type="integer">1</cn>
     </apply>
     <cn type="integer">0</cn>
     <apply>
      <minus></minus>
      <cn type="integer">1</cn>
     </apply>
     <cn type="integer">3</cn>
     <cn type="integer">0</cn>
    </matrixrow>
    <matrixrow>
     <cn type="integer">0</cn>
     <cn type="integer">0</cn>
     <cn type="integer">0</cn>
     <apply>
      <minus></minus>
      <cn type="integer">1</cn>
     </apply>
     <cn type="integer">0</cn>
     <cn type="integer">1</cn>
    </matrixrow>
   </matrix>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \left(\begin{array}[]{rrrrrr}2&-1&0&0&-1&0\\
-1&3&-1&0&-1&0\\
0&-1&2&-1&0&0\\
0&0&-1&3&-1&-1\\
-1&-1&0&-1&3&0\\
0&0&0&-1&0&1\\
\end{array}\right)
  </annotation>
 </semantics>
</math>

</p></td>
</tr>
</tbody>
</table>
<h2 id="properties">Properties</h2>

<p>For an (undirected) graph <em>G</em> and its Laplacian matrix <em>L</em> with <a class="uri" href="eigenvalues" title="wikilink">eigenvalues</a> 

<math display="inline" id="Laplacian_matrix:13">
 <semantics>
  <mrow>
   <msub>
    <mi>λ</mi>
    <mn>0</mn>
   </msub>
   <mo>≤</mo>
   <msub>
    <mi>λ</mi>
    <mn>1</mn>
   </msub>
   <mo>≤</mo>
   <mi mathvariant="normal">⋯</mi>
   <mo>≤</mo>
   <msub>
    <mi>λ</mi>
    <mrow>
     <mi>n</mi>
     <mo>-</mo>
     <mn>1</mn>
    </mrow>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <leq></leq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>λ</ci>
      <cn type="integer">0</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>λ</ci>
      <cn type="integer">1</cn>
     </apply>
    </apply>
    <apply>
     <leq></leq>
     <share href="#.cmml">
     </share>
     <ci>normal-⋯</ci>
    </apply>
    <apply>
     <leq></leq>
     <share href="#.cmml">
     </share>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>λ</ci>
      <apply>
       <minus></minus>
       <ci>n</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \lambda_{0}\leq\lambda_{1}\leq\cdots\leq\lambda_{n-1}
  </annotation>
 </semantics>
</math>

:</p>
<ul>
<li><em>L</em> is symmetric.</li>
<li><em>L</em> is <a href="positive-definite_matrix" title="wikilink">positive-semidefinite</a> (that is 

<math display="inline" id="Laplacian_matrix:14">
 <semantics>
  <mrow>
   <msub>
    <mi>λ</mi>
    <mi>i</mi>
   </msub>
   <mo>≥</mo>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <geq></geq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>λ</ci>
     <ci>i</ci>
    </apply>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \lambda_{i}\geq 0
  </annotation>
 </semantics>
</math>

 for all <em>i</em>). This is verified in the <a href="#Incidence_matrix" title="wikilink">incidence matrix</a> section (below). This can also be seen from the fact that the Laplacian is symmetric and <a href="diagonally_dominant_matrix#Applications_and_properties" title="wikilink">diagonally dominant</a>.</li>
<li><em>L</em> is an <a class="uri" href="M-matrix" title="wikilink">M-matrix</a> (its off-diagonal entries are nonpositive, yet the real parts of its eigenvalues are nonnegative).</li>
<li>Every row sum and column sum of <em>L</em> is zero. Indeed, in the sum, the degree of the vertex is summed with a "-1" for each neighbor.</li>
<li>In consequence, 

<math display="inline" id="Laplacian_matrix:15">
 <semantics>
  <mrow>
   <msub>
    <mi>λ</mi>
    <mn>0</mn>
   </msub>
   <mo>=</mo>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>λ</ci>
     <cn type="integer">0</cn>
    </apply>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \lambda_{0}=0
  </annotation>
 </semantics>
</math>

, because the vector 

<math display="inline" id="Laplacian_matrix:16">
 <semantics>
  <mrow>
   <msub>
    <mi>𝐯</mi>
    <mn>0</mn>
   </msub>
   <mo>=</mo>
   <mrow>
    <mo stretchy="false">(</mo>
    <mn>1</mn>
    <mo>,</mo>
    <mn>1</mn>
    <mo>,</mo>
    <mi mathvariant="normal">…</mi>
    <mo>,</mo>
    <mn>1</mn>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>𝐯</ci>
     <cn type="integer">0</cn>
    </apply>
    <vector>
     <cn type="integer">1</cn>
     <cn type="integer">1</cn>
     <ci>normal-…</ci>
     <cn type="integer">1</cn>
    </vector>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{v}_{0}=(1,1,\dots,1)
  </annotation>
 </semantics>
</math>

 satisfies 

<math display="inline" id="Laplacian_matrix:17">
 <semantics>
  <mrow>
   <mrow>
    <mi>L</mi>
    <msub>
     <mi>𝐯</mi>
     <mn>0</mn>
    </msub>
   </mrow>
   <mo>=</mo>
   <mn>0.</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>L</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>𝐯</ci>
      <cn type="integer">0</cn>
     </apply>
    </apply>
    <cn type="float">0.</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   L\mathbf{v}_{0}=\mathbf{0}.
  </annotation>
 </semantics>
</math>

</li>
<li>The number of times 0 appears as an eigenvalue in the Laplacian is the number of <a href="Connected_component_(graph_theory)" title="wikilink">connected components</a> in the graph.</li>
<li>The smallest non-zero eigenvalue of <em>L</em> is called the <a href="spectral_gap" title="wikilink">spectral gap</a>.</li>
<li>The second smallest eigenvalue of <em>L</em> is the <a href="algebraic_connectivity" title="wikilink">algebraic connectivity</a> (or <a href="Fiedler_value" title="wikilink">Fiedler value</a>) of <em>G</em>.</li>
<li>The <a class="uri" href="Laplacian" title="wikilink">Laplacian</a> is an operator on the n-dimensional vector space of functions f : V → 

<math display="inline" id="Laplacian_matrix:18">
 <semantics>
  <mi>ℝ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>ℝ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbb{R}
  </annotation>
 </semantics>
</math>

, where V is the vertex set of G, and n = |V|.</li>
<li>When G is k-regular, the normalized Laplacian is

<math display="block" id="Laplacian_matrix:19">
 <semantics>
  <mrow>
   <mi class="ltx_font_mathcaligraphic">ℒ</mi>
   <mo>=</mo>
   <mrow>
    <mstyle displaystyle="false">
     <mfrac>
      <mn>1</mn>
      <mi>k</mi>
     </mfrac>
    </mstyle>
    <mi>L</mi>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mi>I</mi>
    <mo>-</mo>
    <mrow>
     <mstyle displaystyle="false">
      <mfrac>
       <mn>1</mn>
       <mi>k</mi>
      </mfrac>
     </mstyle>
     <mi>A</mi>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <ci>ℒ</ci>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <ci>k</ci>
      </apply>
      <ci>L</ci>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <minus></minus>
      <ci>I</ci>
      <apply>
       <times></times>
       <apply>
        <divide></divide>
        <cn type="integer">1</cn>
        <ci>k</ci>
       </apply>
       <ci>A</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathcal{L}=\tfrac{1}{k}L=I-\tfrac{1}{k}A
  </annotation>
 </semantics>
</math>

, where A is the adjacency matrix and I is an identity matrix.</li>
<li>For a graph with multiple <a href="Connected_component_(graph_theory)" title="wikilink">connected components</a>, <em>L</em> is a <a href="Block_matrix#Block_diagonal_matrices" title="wikilink">block diagonal</a> matrix, where each block is the respective Laplacian matrix for each component, possibly after reordering the vertices (i.e. <em>L</em> is permutation-similar to a block diagonal matrix).</li>
</ul>
<h2 id="incidence-matrix">Incidence matrix</h2>

<p>Define an 

<math display="inline" id="Laplacian_matrix:20">
 <semantics>
  <mrow>
   <mo stretchy="false">|</mo>
   <mi>e</mi>
   <mo stretchy="false">|</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <abs></abs>
    <ci>e</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   |e|
  </annotation>
 </semantics>
</math>

 x 

<math display="inline" id="Laplacian_matrix:21">
 <semantics>
  <mrow>
   <mo stretchy="false">|</mo>
   <mi>v</mi>
   <mo stretchy="false">|</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <abs></abs>
    <ci>v</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   |v|
  </annotation>
 </semantics>
</math>

 oriented <a href="incidence_matrix" title="wikilink">incidence matrix</a> <em>M</em> with element <em>M</em><sub><em>ev</em></sub> for edge <em>e</em> (connecting vertex <em>i</em> and <em>j</em>, with <em>i</em> &gt; <em>j</em>) and vertex <em>v</em> given by</p>

<p>

<math display="block" id="Laplacian_matrix:22">
 <semantics>
  <mrow>
   <msub>
    <mi>M</mi>
    <mrow>
     <mi>e</mi>
     <mi>v</mi>
    </mrow>
   </msub>
   <mo>=</mo>
   <mrow>
    <mo>{</mo>
    <mtable displaystyle="true">
     <mtr>
      <mtd columnalign="right">
       <mrow>
        <mn>1</mn>
        <mo>,</mo>
       </mrow>
      </mtd>
      <mtd columnalign="left">
       <mrow>
        <mrow>
         <mpadded width="+1.7pt">
          <mtext>if</mtext>
         </mpadded>
         <mi>v</mi>
        </mrow>
        <mo>=</mo>
        <mi>i</mi>
       </mrow>
      </mtd>
     </mtr>
     <mtr>
      <mtd columnalign="right">
       <mrow>
        <mrow>
         <mo>-</mo>
         <mn>1</mn>
        </mrow>
        <mo>,</mo>
       </mrow>
      </mtd>
      <mtd columnalign="left">
       <mrow>
        <mrow>
         <mpadded width="+1.7pt">
          <mtext>if</mtext>
         </mpadded>
         <mi>v</mi>
        </mrow>
        <mo>=</mo>
        <mi>j</mi>
       </mrow>
      </mtd>
     </mtr>
     <mtr>
      <mtd columnalign="right">
       <mrow>
        <mn>0</mn>
        <mo>,</mo>
       </mrow>
      </mtd>
      <mtd columnalign="left">
       <mrow>
        <mtext>otherwise</mtext>
        <mo>.</mo>
       </mrow>
      </mtd>
     </mtr>
    </mtable>
    <mi></mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>M</ci>
     <apply>
      <times></times>
      <ci>e</ci>
      <ci>v</ci>
     </apply>
    </apply>
    <apply>
     <csymbol cd="latexml">cases</csymbol>
     <matrix>
      <matrixrow>
       <cn type="integer">1</cn>
       <apply>
        <eq></eq>
        <apply>
         <times></times>
         <mtext>if</mtext>
         <ci>v</ci>
        </apply>
        <ci>i</ci>
       </apply>
      </matrixrow>
      <matrixrow>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
       </apply>
       <apply>
        <eq></eq>
        <apply>
         <times></times>
         <mtext>if</mtext>
         <ci>v</ci>
        </apply>
        <ci>j</ci>
       </apply>
      </matrixrow>
      <matrixrow>
       <cn type="integer">0</cn>
       <mtext>otherwise</mtext>
      </matrixrow>
     </matrix>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   M_{ev}=\left\{\begin{array}[]{rl}1,&\text{if}\,v=i\\
-1,&\text{if}\,v=j\\
0,&\text{otherwise}.\end{array}\right.
  </annotation>
 </semantics>
</math>

 Then the Laplacian matrix <em>L</em> satisfies</p>

<p>

<math display="block" id="Laplacian_matrix:23">
 <semantics>
  <mrow>
   <mrow>
    <mi>L</mi>
    <mo>=</mo>
    <mrow>
     <msup>
      <mi>M</mi>
      <mtext>T</mtext>
     </msup>
     <mpadded width="+1.7pt">
      <mi>M</mi>
     </mpadded>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>L</ci>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>M</ci>
      <mtext>T</mtext>
     </apply>
     <ci>M</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   L=M^{\text{T}}M\,,
  </annotation>
 </semantics>
</math>

 where 

<math display="inline" id="Laplacian_matrix:24">
 <semantics>
  <msup>
   <mi>M</mi>
   <mtext>T</mtext>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>M</ci>
    <mtext>T</mtext>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   M^{\text{T}}
  </annotation>
 </semantics>
</math>

 is the <a href="transpose" title="wikilink">matrix transpose</a> of <em>M</em>.</p>

<p>Now consider an eigendecomposition of 

<math display="inline" id="Laplacian_matrix:25">
 <semantics>
  <mi>L</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>L</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   L
  </annotation>
 </semantics>
</math>

, with unit-norm eigenvectors 

<math display="inline" id="Laplacian_matrix:26">
 <semantics>
  <msub>
   <mi>𝐯</mi>
   <mi>i</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>𝐯</ci>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{v}_{i}
  </annotation>
 </semantics>
</math>

 and corresponding eigenvalues 

<math display="inline" id="Laplacian_matrix:27">
 <semantics>
  <msub>
   <mi>λ</mi>
   <mi>i</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>λ</ci>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \lambda_{i}
  </annotation>
 </semantics>
</math>

:</p>

<p>

<math display="inline" id="Laplacian_matrix:28">
 <semantics>
  <msub>
   <mi>λ</mi>
   <mi>i</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>λ</ci>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle\lambda_{i}
  </annotation>
 </semantics>
</math>


 Because 

<math display="inline" id="Laplacian_matrix:29">
 <semantics>
  <msub>
   <mi>λ</mi>
   <mi>i</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>λ</ci>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \lambda_{i}
  </annotation>
 </semantics>
</math>

 can be written as the inner product of the vector 

<math display="inline" id="Laplacian_matrix:30">
 <semantics>
  <mrow>
   <mi>M</mi>
   <msub>
    <mi>𝐯</mi>
    <mi>i</mi>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>M</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>𝐯</ci>
     <ci>i</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   M\mathbf{v}_{i}
  </annotation>
 </semantics>
</math>

 with itself, this shows that 

<math display="inline" id="Laplacian_matrix:31">
 <semantics>
  <mrow>
   <msub>
    <mi>λ</mi>
    <mi>i</mi>
   </msub>
   <mo>≥</mo>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <geq></geq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>λ</ci>
     <ci>i</ci>
    </apply>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \lambda_{i}\geq 0
  </annotation>
 </semantics>
</math>


 and so the eigenvalues of 

<math display="inline" id="Laplacian_matrix:32">
 <semantics>
  <mi>L</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>L</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   L
  </annotation>
 </semantics>
</math>

 are all non-negative.</p>
<h2 id="deformed-laplacian">Deformed Laplacian</h2>

<p>The <strong>deformed Laplacian</strong> is commonly defined as</p>

<p>

<math display="block" id="Laplacian_matrix:33">
 <semantics>
  <mrow>
   <mrow>
    <mi mathvariant="normal">Δ</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>s</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mi>I</mi>
     <mo>-</mo>
     <mrow>
      <mi>s</mi>
      <mi>A</mi>
     </mrow>
    </mrow>
    <mo>+</mo>
    <mrow>
     <msup>
      <mi>s</mi>
      <mn>2</mn>
     </msup>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mi>D</mi>
       <mo>-</mo>
       <mi>I</mi>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>normal-Δ</ci>
     <ci>s</ci>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <minus></minus>
      <ci>I</ci>
      <apply>
       <times></times>
       <ci>s</ci>
       <ci>A</ci>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>s</ci>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <minus></minus>
       <ci>D</ci>
       <ci>I</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Delta(s)=I-sA+s^{2}(D-I)
  </annotation>
 </semantics>
</math>

</p>

<p>where <em>I</em> is the unit matrix, <em>A</em> is the adjacency matrix, and <em>D</em> is the degree matrix, and <em>s</em> is a (complex-valued) number. Note that the standard Laplacian is just 

<math display="inline" id="Laplacian_matrix:34">
 <semantics>
  <mrow>
   <mi mathvariant="normal">Δ</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mn>1</mn>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>normal-Δ</ci>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Delta(1)
  </annotation>
 </semantics>
</math>

.<a class="footnoteRef" href="#fn3" id="fnref3"><sup>3</sup></a></p>
<h2 id="symmetric-normalized-laplacian">Symmetric normalized Laplacian</h2>

<p>The <strong>(symmetric) normalized Laplacian</strong> is defined as</p>

<p>

<math display="block" id="Laplacian_matrix:35">
 <semantics>
  <mrow>
   <msup>
    <mi>L</mi>
    <mtext>sym</mtext>
   </msup>
   <mo>:=</mo>
   <mrow>
    <msup>
     <mi>D</mi>
     <mrow>
      <mo>-</mo>
      <mrow>
       <mn>1</mn>
       <mo>/</mo>
       <mn>2</mn>
      </mrow>
     </mrow>
    </msup>
    <mi>L</mi>
    <msup>
     <mi>D</mi>
     <mrow>
      <mo>-</mo>
      <mrow>
       <mn>1</mn>
       <mo>/</mo>
       <mn>2</mn>
      </mrow>
     </mrow>
    </msup>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mi>I</mi>
    <mo>-</mo>
    <mrow>
     <msup>
      <mi>D</mi>
      <mrow>
       <mo>-</mo>
       <mrow>
        <mn>1</mn>
        <mo>/</mo>
        <mn>2</mn>
       </mrow>
      </mrow>
     </msup>
     <mi>A</mi>
     <msup>
      <mi>D</mi>
      <mrow>
       <mo>-</mo>
       <mrow>
        <mn>1</mn>
        <mo>/</mo>
        <mn>2</mn>
       </mrow>
      </mrow>
     </msup>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <csymbol cd="latexml">assign</csymbol>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>L</ci>
      <mtext>sym</mtext>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>D</ci>
       <apply>
        <minus></minus>
        <apply>
         <divide></divide>
         <cn type="integer">1</cn>
         <cn type="integer">2</cn>
        </apply>
       </apply>
      </apply>
      <ci>L</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>D</ci>
       <apply>
        <minus></minus>
        <apply>
         <divide></divide>
         <cn type="integer">1</cn>
         <cn type="integer">2</cn>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <minus></minus>
      <ci>I</ci>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>D</ci>
        <apply>
         <minus></minus>
         <apply>
          <divide></divide>
          <cn type="integer">1</cn>
          <cn type="integer">2</cn>
         </apply>
        </apply>
       </apply>
       <ci>A</ci>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>D</ci>
        <apply>
         <minus></minus>
         <apply>
          <divide></divide>
          <cn type="integer">1</cn>
          <cn type="integer">2</cn>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   L^{\text{sym}}:=D^{-1/2}LD^{-1/2}=I-D^{-1/2}AD^{-1/2}
  </annotation>
 </semantics>
</math>

 where <em>L</em> is the (unnormalized) Laplacian, <em>A</em> is the adjacency matrix and <em>D</em> is the degree matrix. Since the degree matrix <em>D</em> is diagonal and positive, its reciprocal square root 

<math display="inline" id="Laplacian_matrix:36">
 <semantics>
  <msup>
   <mi>D</mi>
   <mrow>
    <mo>-</mo>
    <mrow>
     <mn>1</mn>
     <mo>/</mo>
     <mn>2</mn>
    </mrow>
   </mrow>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>D</ci>
    <apply>
     <minus></minus>
     <apply>
      <divide></divide>
      <cn type="integer">1</cn>
      <cn type="integer">2</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   D^{-1/2}
  </annotation>
 </semantics>
</math>


 is just the diagonal matrix whose diagonal entries are the reciprocals of the positive square roots of the diagonal entries of <em>D</em>. The symmetric normalized Laplacian is a symmetric matrix.</p>

<p>One has

<math display="block" id="Laplacian_matrix:37">
 <semantics>
  <mrow>
   <msup>
    <mi>L</mi>
    <mtext>sym</mtext>
   </msup>
   <mo>=</mo>
   <mrow>
    <mi>S</mi>
    <msup>
     <mi>S</mi>
     <mo>*</mo>
    </msup>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>L</ci>
     <mtext>sym</mtext>
    </apply>
    <apply>
     <times></times>
     <ci>S</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>S</ci>
      <times></times>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   L^{\text{sym}}=SS^{*}
  </annotation>
 </semantics>
</math>

, where S is the matrix whose rows are indexed by the vertices and whose columns are indexed by the edges of G such that each column corresponding to an edge e = {u, v} has an entry 

<math display="inline" id="Laplacian_matrix:38">
 <semantics>
  <mfrac>
   <mn>1</mn>
   <msub>
    <msqrt>
     <mi>d</mi>
    </msqrt>
    <mi>u</mi>
   </msub>
  </mfrac>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <divide></divide>
    <cn type="integer">1</cn>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <root></root>
      <ci>d</ci>
     </apply>
     <ci>u</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \frac{1}{\sqrt{d}_{u}}
  </annotation>
 </semantics>
</math>

 in the row corresponding to u, an entry 

<math display="inline" id="Laplacian_matrix:39">
 <semantics>
  <mrow>
   <mo>-</mo>
   <mfrac>
    <mn>1</mn>
    <msub>
     <msqrt>
      <mi>d</mi>
     </msqrt>
     <mi>v</mi>
    </msub>
   </mfrac>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <minus></minus>
    <apply>
     <divide></divide>
     <cn type="integer">1</cn>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <root></root>
       <ci>d</ci>
      </apply>
      <ci>v</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   -\frac{1}{\sqrt{d}_{v}}
  </annotation>
 </semantics>
</math>

 in the row corresponding to v, and has 0 entries elsewhere. (Note

<math display="block" id="Laplacian_matrix:40">
 <semantics>
  <msup>
   <mi>S</mi>
   <mo>*</mo>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>S</ci>
    <times></times>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   S^{*}
  </annotation>
 </semantics>
</math>

 denotes the transpose of S).</p>

<p>All eigenvalues of the normalized Laplacian are real and non-negative. We can see this as follows. Since 

<math display="inline" id="Laplacian_matrix:41">
 <semantics>
  <msup>
   <mi>L</mi>
   <mtext>sym</mtext>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>L</ci>
    <mtext>sym</mtext>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   L^{\text{sym}}
  </annotation>
 </semantics>
</math>


 is symmetric, its eigenvalues are real. They are also non-negative: consider an eigenvector g of 

<math display="inline" id="Laplacian_matrix:42">
 <semantics>
  <msup>
   <mi>L</mi>
   <mtext>sym</mtext>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>L</ci>
    <mtext>sym</mtext>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   L^{\text{sym}}
  </annotation>
 </semantics>
</math>

 with eigenvalue λ and suppose 

<math display="inline" id="Laplacian_matrix:43">
 <semantics>
  <mrow>
   <mi>g</mi>
   <mo>=</mo>
   <mrow>
    <msup>
     <mi>D</mi>
     <mrow>
      <mn>1</mn>
      <mo>/</mo>
      <mn>2</mn>
     </mrow>
    </msup>
    <mi>f</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>g</ci>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>D</ci>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <cn type="integer">2</cn>
      </apply>
     </apply>
     <ci>f</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   g=D^{1/2}f
  </annotation>
 </semantics>
</math>

 . (We can consider g and f as real functions on the vertices v.) Then:</p>

<p>

<math display="block" id="Laplacian_matrix:44">
 <semantics>
  <mrow>
   <mrow>
    <mpadded width="+5pt">
     <mi>λ</mi>
    </mpadded>
    <mo rspace="7.5pt">=</mo>
    <mpadded width="+5pt">
     <mfrac>
      <mrow>
       <mo stretchy="false">⟨</mo>
       <mi>g</mi>
       <mo>,</mo>
       <mrow>
        <msup>
         <mi>L</mi>
         <mtext>sym</mtext>
        </msup>
        <mi>g</mi>
       </mrow>
       <mo stretchy="false">⟩</mo>
      </mrow>
      <mrow>
       <mo stretchy="false">⟨</mo>
       <mi>g</mi>
       <mo>,</mo>
       <mi>g</mi>
       <mo stretchy="false">⟩</mo>
      </mrow>
     </mfrac>
    </mpadded>
    <mo rspace="7.5pt">=</mo>
    <mpadded width="+5pt">
     <mfrac>
      <mrow>
       <mo stretchy="false">⟨</mo>
       <mi>g</mi>
       <mo>,</mo>
       <mrow>
        <msup>
         <mi>D</mi>
         <mrow>
          <mo>-</mo>
          <mrow>
           <mn>1</mn>
           <mo>/</mo>
           <mn>2</mn>
          </mrow>
         </mrow>
        </msup>
        <mi>L</mi>
        <msup>
         <mi>D</mi>
         <mrow>
          <mo>-</mo>
          <mrow>
           <mn>1</mn>
           <mo>/</mo>
           <mn>2</mn>
          </mrow>
         </mrow>
        </msup>
        <mi>g</mi>
       </mrow>
       <mo stretchy="false">⟩</mo>
      </mrow>
      <mrow>
       <mo stretchy="false">⟨</mo>
       <mi>g</mi>
       <mo>,</mo>
       <mi>g</mi>
       <mo stretchy="false">⟩</mo>
      </mrow>
     </mfrac>
    </mpadded>
    <mo rspace="7.5pt">=</mo>
    <mpadded width="+5pt">
     <mfrac>
      <mrow>
       <mo stretchy="false">⟨</mo>
       <mi>f</mi>
       <mo>,</mo>
       <mrow>
        <mi>L</mi>
        <mi>f</mi>
       </mrow>
       <mo stretchy="false">⟩</mo>
      </mrow>
      <mrow>
       <mo stretchy="false">⟨</mo>
       <mrow>
        <msup>
         <mi>D</mi>
         <mrow>
          <mn>1</mn>
          <mo>/</mo>
          <mn>2</mn>
         </mrow>
        </msup>
        <mi>f</mi>
       </mrow>
       <mo>,</mo>
       <mrow>
        <msup>
         <mi>D</mi>
         <mrow>
          <mn>1</mn>
          <mo>/</mo>
          <mn>2</mn>
         </mrow>
        </msup>
        <mi>f</mi>
       </mrow>
       <mo stretchy="false">⟩</mo>
      </mrow>
     </mfrac>
    </mpadded>
    <mo rspace="7.5pt">=</mo>
    <mpadded width="+5pt">
     <mfrac>
      <mrow>
       <msub>
        <mo largeop="true" symmetric="true">∑</mo>
        <mrow>
         <mi>u</mi>
         <mo>∼</mo>
         <mi>v</mi>
        </mrow>
       </msub>
       <msup>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <mrow>
           <mi>f</mi>
           <mrow>
            <mo stretchy="false">(</mo>
            <mi>u</mi>
            <mo stretchy="false">)</mo>
           </mrow>
          </mrow>
          <mo>-</mo>
          <mrow>
           <mi>f</mi>
           <mrow>
            <mo stretchy="false">(</mo>
            <mi>v</mi>
            <mo stretchy="false">)</mo>
           </mrow>
          </mrow>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
        <mn>2</mn>
       </msup>
      </mrow>
      <mrow>
       <msub>
        <mo largeop="true" symmetric="true">∑</mo>
        <mi>v</mi>
       </msub>
       <mrow>
        <mi>f</mi>
        <msup>
         <mrow>
          <mo stretchy="false">(</mo>
          <mi>v</mi>
          <mo stretchy="false">)</mo>
         </mrow>
         <mn>2</mn>
        </msup>
        <msub>
         <mi>d</mi>
         <mi>v</mi>
        </msub>
       </mrow>
      </mrow>
     </mfrac>
    </mpadded>
    <mo>></mo>
    <mn>0</mn>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <ci>λ</ci>
     <apply>
      <divide></divide>
      <list>
       <ci>g</ci>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>L</ci>
         <mtext>sym</mtext>
        </apply>
        <ci>g</ci>
       </apply>
      </list>
      <list>
       <ci>g</ci>
       <ci>g</ci>
      </list>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <divide></divide>
      <list>
       <ci>g</ci>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>D</ci>
         <apply>
          <minus></minus>
          <apply>
           <divide></divide>
           <cn type="integer">1</cn>
           <cn type="integer">2</cn>
          </apply>
         </apply>
        </apply>
        <ci>L</ci>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>D</ci>
         <apply>
          <minus></minus>
          <apply>
           <divide></divide>
           <cn type="integer">1</cn>
           <cn type="integer">2</cn>
          </apply>
         </apply>
        </apply>
        <ci>g</ci>
       </apply>
      </list>
      <list>
       <ci>g</ci>
       <ci>g</ci>
      </list>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <divide></divide>
      <list>
       <ci>f</ci>
       <apply>
        <times></times>
        <ci>L</ci>
        <ci>f</ci>
       </apply>
      </list>
      <list>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>D</ci>
         <apply>
          <divide></divide>
          <cn type="integer">1</cn>
          <cn type="integer">2</cn>
         </apply>
        </apply>
        <ci>f</ci>
       </apply>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>D</ci>
         <apply>
          <divide></divide>
          <cn type="integer">1</cn>
          <cn type="integer">2</cn>
         </apply>
        </apply>
        <ci>f</ci>
       </apply>
      </list>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <divide></divide>
      <apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <apply>
         <csymbol cd="latexml">similar-to</csymbol>
         <ci>u</ci>
         <ci>v</ci>
        </apply>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <minus></minus>
         <apply>
          <times></times>
          <ci>f</ci>
          <ci>u</ci>
         </apply>
         <apply>
          <times></times>
          <ci>f</ci>
          <ci>v</ci>
         </apply>
        </apply>
        <cn type="integer">2</cn>
       </apply>
      </apply>
      <apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <ci>v</ci>
       </apply>
       <apply>
        <times></times>
        <ci>f</ci>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>v</ci>
         <cn type="integer">2</cn>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>d</ci>
         <ci>v</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <gt></gt>
     <share href="#.cmml">
     </share>
     <cn type="float">0</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \lambda\ {}=\ {}\frac{\langle g,L^{\text{sym}}g\rangle}{\langle g,g\rangle}\ {%
}=\ {}\frac{\langle g,D^{-1/2}LD^{-1/2}g\rangle}{\langle g,g\rangle}\ {}=\ {}%
\frac{\langle f,Lf\rangle}{\langle D^{1/2}f,D^{1/2}f\rangle}\ {}=\ {}\frac{%
\sum_{u\sim v}(f(u)-f(v))^{2}}{\sum_{v}f(v)^{2}d_{v}}\ >\ 0,
  </annotation>
 </semantics>
</math>

 where we use the inner product 

<math display="inline" id="Laplacian_matrix:45">
 <semantics>
  <mrow>
   <mrow>
    <mo stretchy="false">⟨</mo>
    <mi>f</mi>
    <mo>,</mo>
    <mi>g</mi>
    <mo stretchy="false">⟩</mo>
   </mrow>
   <mo>=</mo>
   <mrow>
    <msub>
     <mo largeop="true" symmetric="true">∑</mo>
     <mi>v</mi>
    </msub>
    <mrow>
     <mi>f</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>v</mi>
      <mo stretchy="false">)</mo>
     </mrow>
     <mi>g</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>v</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <list>
     <ci>f</ci>
     <ci>g</ci>
    </list>
    <apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <sum></sum>
      <ci>v</ci>
     </apply>
     <apply>
      <times></times>
      <ci>f</ci>
      <ci>v</ci>
      <ci>g</ci>
      <ci>v</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \langle f,g\rangle=\sum_{v}f(v)g(v)
  </annotation>
 </semantics>
</math>

, a sum over all vertices v, and 

<math display="inline" id="Laplacian_matrix:46">
 <semantics>
  <msub>
   <mo largeop="true" symmetric="true">∑</mo>
   <mrow>
    <mi>u</mi>
    <mo>∼</mo>
    <mi>v</mi>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <sum></sum>
    <apply>
     <csymbol cd="latexml">similar-to</csymbol>
     <ci>u</ci>
     <ci>v</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \sum_{u\sim v}
  </annotation>
 </semantics>
</math>

 denotes the sum over all unordered pairs of adjacent vertices {u,v}. The quantity 

<math display="inline" id="Laplacian_matrix:47">
 <semantics>
  <mrow>
   <msub>
    <mo largeop="true" symmetric="true">∑</mo>
    <mrow>
     <mi>u</mi>
     <mo>,</mo>
     <mi>v</mi>
    </mrow>
   </msub>
   <msup>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mrow>
       <mi>f</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>u</mi>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
      <mo>-</mo>
      <mrow>
       <mi>f</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>v</mi>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
    <mn>2</mn>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <sum></sum>
     <list>
      <ci>u</ci>
      <ci>v</ci>
     </list>
    </apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <minus></minus>
      <apply>
       <times></times>
       <ci>f</ci>
       <ci>u</ci>
      </apply>
      <apply>
       <times></times>
       <ci>f</ci>
       <ci>v</ci>
      </apply>
     </apply>
     <cn type="integer">2</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \sum_{u,v}(f(u)-f(v))^{2}
  </annotation>
 </semantics>
</math>

 is called the <em>Dirichlet sum</em> of f, whereas the expression 

<math display="inline" id="Laplacian_matrix:48">
 <semantics>
  <mfrac>
   <mrow>
    <mo stretchy="false">⟨</mo>
    <mi>g</mi>
    <mo>,</mo>
    <mrow>
     <msup>
      <mi>L</mi>
      <mtext>sym</mtext>
     </msup>
     <mi>g</mi>
    </mrow>
    <mo stretchy="false">⟩</mo>
   </mrow>
   <mrow>
    <mo stretchy="false">⟨</mo>
    <mi>g</mi>
    <mo>,</mo>
    <mi>g</mi>
    <mo stretchy="false">⟩</mo>
   </mrow>
  </mfrac>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <divide></divide>
    <list>
     <ci>g</ci>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>L</ci>
       <mtext>sym</mtext>
      </apply>
      <ci>g</ci>
     </apply>
    </list>
    <list>
     <ci>g</ci>
     <ci>g</ci>
    </list>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \frac{\langle g,L^{\text{sym}}g\rangle}{\langle g,g\rangle}
  </annotation>
 </semantics>
</math>

 is called the <em>Rayleigh quotient</em> of g.</p>

<p>Let <strong>1</strong> be the function which assumes the value 1 on each vertex. Then 

<math display="inline" id="Laplacian_matrix:49">
 <semantics>
  <mrow>
   <msup>
    <mi>D</mi>
    <mrow>
     <mn>1</mn>
     <mo>/</mo>
     <mn>2</mn>
    </mrow>
   </msup>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>D</ci>
     <apply>
      <divide></divide>
      <cn type="integer">1</cn>
      <cn type="integer">2</cn>
     </apply>
    </apply>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   D^{1/2}1
  </annotation>
 </semantics>
</math>

 is an eigenfunction of 

<math display="inline" id="Laplacian_matrix:50">
 <semantics>
  <msup>
   <mi>L</mi>
   <mtext>sym</mtext>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>L</ci>
    <mtext>sym</mtext>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   L^{\text{sym}}
  </annotation>
 </semantics>
</math>

 with eigenvalue 0.<a class="footnoteRef" href="#fn4" id="fnref4"><sup>4</sup></a></p>

<p>In fact, the eigenvalues of the normalized symmetric Laplacian satisfy 0 = μ<sub>0</sub>≤...≤ μ<sub>n-1</sub>≤ 2. These eigenvalues (known as the spectrum of the normalized Laplacian) relate well to other graph invariants for general graphs.<a class="footnoteRef" href="#fn5" id="fnref5"><sup>5</sup></a></p>
<h2 id="random-walk-normalized-laplacian">Random walk normalized Laplacian</h2>

<p>The <strong>random walk normalized Laplacian</strong> is defined as</p>

<p>

<math display="block" id="Laplacian_matrix:51">
 <semantics>
  <mrow>
   <msup>
    <mi>L</mi>
    <mtext>rw</mtext>
   </msup>
   <mo>:=</mo>
   <mrow>
    <msup>
     <mi>D</mi>
     <mrow>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </msup>
    <mi>A</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">assign</csymbol>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>L</ci>
     <mtext>rw</mtext>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>D</ci>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <ci>A</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   L^{\text{rw}}:=D^{-1}A
  </annotation>
 </semantics>
</math>

</p>

<p>where <em>A</em> is the Adjacency matrix and <em>D</em> is the degree matrix. Since the degree matrix <em>D</em> is diagonal, its inverse 

<math display="inline" id="Laplacian_matrix:52">
 <semantics>
  <msup>
   <mi>D</mi>
   <mrow>
    <mo>-</mo>
    <mn>1</mn>
   </mrow>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>D</ci>
    <apply>
     <minus></minus>
     <cn type="integer">1</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   D^{-1}
  </annotation>
 </semantics>
</math>

 is simply defined as a diagonal matrix, having diagonal entries which are the reciprocals of the corresponding positive diagonal entries of <em>D</em>. For the isolated vertices (those with degree 0), a common choice is to set the corresponding element 

<math display="inline" id="Laplacian_matrix:53">
 <semantics>
  <msubsup>
   <mi>L</mi>
   <mrow>
    <mi>i</mi>
    <mo>,</mo>
    <mi>i</mi>
   </mrow>
   <mtext>rw</mtext>
  </msubsup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>L</ci>
     <mtext>rw</mtext>
    </apply>
    <list>
     <ci>i</ci>
     <ci>i</ci>
    </list>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   L^{\text{rw}}_{i,i}
  </annotation>
 </semantics>
</math>

 to 0. This convention results in a nice property that the multiplicity of the eigenvalue 0 is equal to the number of connected components in the graph. The matrix elements of 

<math display="inline" id="Laplacian_matrix:54">
 <semantics>
  <msup>
   <mi>L</mi>
   <mtext>rw</mtext>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>L</ci>
    <mtext>rw</mtext>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   L^{\text{rw}}
  </annotation>
 </semantics>
</math>

 are given by</p>

<p>

<math display="block" id="Laplacian_matrix:55">
 <semantics>
  <mrow>
   <msubsup>
    <mi>L</mi>
    <mrow>
     <mi>i</mi>
     <mo>,</mo>
     <mi>j</mi>
    </mrow>
    <mtext>rw</mtext>
   </msubsup>
   <mo>:=</mo>
   <mrow>
    <mo>{</mo>
    <mtable displaystyle="true">
     <mtr>
      <mtd columnalign="left">
       <mn>1</mn>
      </mtd>
      <mtd columnalign="left">
       <mrow>
        <mrow>
         <mpadded width="+5pt">
          <mtext>if</mtext>
         </mpadded>
         <mi>i</mi>
        </mrow>
        <mo>=</mo>
        <mrow>
         <mpadded width="+5pt">
          <mi>j</mi>
         </mpadded>
         <mpadded width="+5pt">
          <mtext>and</mtext>
         </mpadded>
         <mrow>
          <mi>deg</mi>
          <mrow>
           <mo stretchy="false">(</mo>
           <msub>
            <mi>v</mi>
            <mi>i</mi>
           </msub>
           <mo stretchy="false">)</mo>
          </mrow>
         </mrow>
        </mrow>
        <mo>≠</mo>
        <mn>0</mn>
       </mrow>
      </mtd>
     </mtr>
     <mtr>
      <mtd columnalign="left">
       <mrow>
        <mo>-</mo>
        <mstyle displaystyle="false">
         <mfrac>
          <mn>1</mn>
          <mrow>
           <mi>deg</mi>
           <mrow>
            <mo stretchy="false">(</mo>
            <msub>
             <mi>v</mi>
             <mi>i</mi>
            </msub>
            <mo stretchy="false">)</mo>
           </mrow>
          </mrow>
         </mfrac>
        </mstyle>
       </mrow>
      </mtd>
      <mtd columnalign="left">
       <mrow>
        <mrow>
         <mpadded width="+5pt">
          <mtext>if</mtext>
         </mpadded>
         <mi>i</mi>
        </mrow>
        <mo>≠</mo>
        <mrow>
         <mpadded width="+5pt">
          <mi>j</mi>
         </mpadded>
         <mpadded width="+5pt">
          <mtext>and</mtext>
         </mpadded>
         <msub>
          <mi>v</mi>
          <mi>i</mi>
         </msub>
         <mtext>is adjacent to</mtext>
         <msub>
          <mi>v</mi>
          <mi>j</mi>
         </msub>
        </mrow>
       </mrow>
      </mtd>
     </mtr>
     <mtr>
      <mtd columnalign="left">
       <mn>0</mn>
      </mtd>
      <mtd columnalign="left">
       <mrow>
        <mtext>otherwise</mtext>
        <mo>.</mo>
       </mrow>
      </mtd>
     </mtr>
    </mtable>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">assign</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>L</ci>
      <mtext>rw</mtext>
     </apply>
     <list>
      <ci>i</ci>
      <ci>j</ci>
     </list>
    </apply>
    <apply>
     <csymbol cd="latexml">cases</csymbol>
     <cn type="integer">1</cn>
     <apply>
      <and></and>
      <apply>
       <eq></eq>
       <apply>
        <times></times>
        <mtext>if</mtext>
        <ci>i</ci>
       </apply>
       <apply>
        <times></times>
        <ci>j</ci>
        <mtext>and</mtext>
        <apply>
         <csymbol cd="latexml">degree</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>v</ci>
          <ci>i</ci>
         </apply>
        </apply>
       </apply>
      </apply>
      <apply>
       <neq></neq>
       <share href="#.cmml">
       </share>
       <cn type="integer">0</cn>
      </apply>
     </apply>
     <apply>
      <minus></minus>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <apply>
        <csymbol cd="latexml">degree</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>v</ci>
         <ci>i</ci>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <neq></neq>
      <apply>
       <times></times>
       <mtext>if</mtext>
       <ci>i</ci>
      </apply>
      <apply>
       <times></times>
       <ci>j</ci>
       <mtext>and</mtext>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>v</ci>
        <ci>i</ci>
       </apply>
       <mtext>is adjacent to</mtext>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>v</ci>
        <ci>j</ci>
       </apply>
      </apply>
     </apply>
     <cn type="integer">0</cn>
     <mtext>otherwise</mtext>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   L^{\text{rw}}_{i,j}:=\begin{cases}1&\mbox{if}\ i=j\ \mbox{and}\ \deg(v_{i})%
\neq 0\\
-\frac{1}{\deg(v_{i})}&\mbox{if}\ i\neq j\ \mbox{and}\ v_{i}\mbox{ is adjacent%
 to }v_{j}\\
0&\mbox{otherwise}.\end{cases}
  </annotation>
 </semantics>
</math>

</p>

<p>The name of the random-walk normalized Laplacian comes from the fact that this matrix is simply the transition matrix of a random walker on the graph. For example let 

<math display="inline" id="Laplacian_matrix:56">
 <semantics>
  <msub>
   <mi>e</mi>
   <mi>i</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>e</ci>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   e_{i}
  </annotation>
 </semantics>
</math>

 denote the i-th <a href="standard_basis" title="wikilink">standard basis</a> vector, then 

<math display="inline" id="Laplacian_matrix:57">
 <semantics>
  <mrow>
   <mi>x</mi>
   <mo>=</mo>
   <mrow>
    <msub>
     <mi>e</mi>
     <mi>i</mi>
    </msub>
    <msup>
     <mi>L</mi>
     <mtext>rw</mtext>
    </msup>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>x</ci>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>e</ci>
      <ci>i</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>L</ci>
      <mtext>rw</mtext>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x=e_{i}L^{\text{rw}}
  </annotation>
 </semantics>
</math>

 is a <a href="probability_vector" title="wikilink">probability vector</a> representing the distribution of a random-walker's locations after taking a single step from vertex 

<math display="inline" id="Laplacian_matrix:58">
 <semantics>
  <mi>i</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>i</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   i
  </annotation>
 </semantics>
</math>

. i.e. 

<math display="inline" id="Laplacian_matrix:59">
 <semantics>
  <mrow>
   <msub>
    <mi>x</mi>
    <mi>j</mi>
   </msub>
   <mo>=</mo>
   <mi>ℙ</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>v</mi>
     <mi>i</mi>
    </msub>
    <mo>→</mo>
    <msub>
     <mi>v</mi>
     <mi>j</mi>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>x</ci>
     <ci>j</ci>
    </apply>
    <eq></eq>
    <csymbol cd="unknown">P</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>v</ci>
      <ci>i</ci>
     </apply>
     <ci>normal-→</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>v</ci>
      <ci>j</ci>
     </apply>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x_{j}=\mathbb{P}(v_{i}\to v_{j})
  </annotation>
 </semantics>
</math>

. More generally if the vector 

<math display="inline" id="Laplacian_matrix:60">
 <semantics>
  <mi>x</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>x</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x
  </annotation>
 </semantics>
</math>

 is a probability distribution of the location of a random-walker on the vertices of the graph then 

<math display="inline" id="Laplacian_matrix:61">
 <semantics>
  <mrow>
   <msup>
    <mi>x</mi>
    <mo>′</mo>
   </msup>
   <mo>=</mo>
   <mrow>
    <mi>x</mi>
    <msup>
     <mrow>
      <mo stretchy="false">(</mo>
      <msup>
       <mi>L</mi>
       <mtext>rw</mtext>
      </msup>
      <mo stretchy="false">)</mo>
     </mrow>
     <mi>t</mi>
    </msup>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>x</ci>
     <ci>normal-′</ci>
    </apply>
    <apply>
     <times></times>
     <ci>x</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>L</ci>
       <mtext>rw</mtext>
      </apply>
      <ci>t</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x^{\prime}=x(L^{\text{rw}})^{t}
  </annotation>
 </semantics>
</math>

 is the probability distribution of the walker after 

<math display="inline" id="Laplacian_matrix:62">
 <semantics>
  <mi>t</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>t</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   t
  </annotation>
 </semantics>
</math>

 steps.</p>

<p>One can check that</p>

<p>

<math display="block" id="Laplacian_matrix:63">
 <semantics>
  <mrow>
   <msup>
    <mi>L</mi>
    <mtext>rw</mtext>
   </msup>
   <mo>=</mo>
   <mrow>
    <msup>
     <mi>D</mi>
     <mrow>
      <mo>-</mo>
      <mfrac>
       <mn>1</mn>
       <mn>2</mn>
      </mfrac>
     </mrow>
    </msup>
    <mrow>
     <mo>(</mo>
     <mrow>
      <mi>I</mi>
      <mo>-</mo>
      <msup>
       <mi>L</mi>
       <mtext>sym</mtext>
      </msup>
     </mrow>
     <mo>)</mo>
    </mrow>
    <msup>
     <mi>D</mi>
     <mfrac>
      <mn>1</mn>
      <mn>2</mn>
     </mfrac>
    </msup>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>L</ci>
     <mtext>rw</mtext>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>D</ci>
      <apply>
       <minus></minus>
       <apply>
        <divide></divide>
        <cn type="integer">1</cn>
        <cn type="integer">2</cn>
       </apply>
      </apply>
     </apply>
     <apply>
      <minus></minus>
      <ci>I</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>L</ci>
       <mtext>sym</mtext>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>D</ci>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   L^{\text{rw}}=D^{-\frac{1}{2}}\left(I-L^{\text{sym}}\right)D^{\frac{1}{2}}
  </annotation>
 </semantics>
</math>

,</p>

<p>i.e., 

<math display="inline" id="Laplacian_matrix:64">
 <semantics>
  <msup>
   <mi>L</mi>
   <mtext>rw</mtext>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>L</ci>
    <mtext>rw</mtext>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   L^{\text{rw}}
  </annotation>
 </semantics>
</math>

 is similar to the normalized Laplacian 

<math display="inline" id="Laplacian_matrix:65">
 <semantics>
  <msup>
   <mi>L</mi>
   <mtext>sym</mtext>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>L</ci>
    <mtext>sym</mtext>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   L^{\text{sym}}
  </annotation>
 </semantics>
</math>

. For this reason, even if 

<math display="inline" id="Laplacian_matrix:66">
 <semantics>
  <msup>
   <mi>L</mi>
   <mtext>rw</mtext>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>L</ci>
    <mtext>rw</mtext>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   L^{\text{rw}}
  </annotation>
 </semantics>
</math>

 is in general not hermitian, it has real eigenvalues. Indeed, its eigenvalues agree with those of 

<math display="inline" id="Laplacian_matrix:67">
 <semantics>
  <msup>
   <mi>L</mi>
   <mtext>sym</mtext>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>L</ci>
    <mtext>sym</mtext>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   L^{\text{sym}}
  </annotation>
 </semantics>
</math>

 (which is hermitian) up to a reflection about 1/2.</p>

<p>In some of the literature, the matrix 

<math display="inline" id="Laplacian_matrix:68">
 <semantics>
  <mrow>
   <mi>I</mi>
   <mo>-</mo>
   <mrow>
    <msup>
     <mi>D</mi>
     <mrow>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </msup>
    <mi>A</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <minus></minus>
    <ci>I</ci>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>D</ci>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <ci>A</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   I-D^{-1}A
  </annotation>
 </semantics>
</math>

 is also referred to as the random-walk Laplacian since its properties approximate those of the standard discrete Laplacian from numerical analysis.</p>
<h3 id="graphs">Graphs</h3>

<p>As an aside about <a href="Random_walk#Random_walk_on_graphs" title="wikilink">random walks on graphs</a>, consider a simple <a href="Graph_(mathematics)#Undirected_graph" title="wikilink">undirected graph</a>. Consider the probability that the walker is at the vertex <em>i</em> at time <em>t</em>, given the probability distribution that he was at vertex <em>j</em> at time <em>t-1</em> (assuming a uniform chance of taking a step along any of the edges attached to a given vertex):</p>

<p>

<math display="block" id="Laplacian_matrix:69">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <msub>
      <mi>p</mi>
      <mi>i</mi>
     </msub>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>t</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <munder>
      <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
      <mi>j</mi>
     </munder>
     <mrow>
      <mfrac>
       <msub>
        <mi>A</mi>
        <mrow>
         <mi>i</mi>
         <mi>j</mi>
        </mrow>
       </msub>
       <mrow>
        <mi>d</mi>
        <mi>e</mi>
        <mi>g</mi>
        <mrow>
         <mo stretchy="false">(</mo>
         <msub>
          <mi>v</mi>
          <mi>j</mi>
         </msub>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
      </mfrac>
      <msub>
       <mi>p</mi>
       <mi>j</mi>
      </msub>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mi>t</mi>
        <mo>-</mo>
        <mn>1</mn>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>p</ci>
      <ci>i</ci>
     </apply>
     <ci>t</ci>
    </apply>
    <apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <sum></sum>
      <ci>j</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>A</ci>
        <apply>
         <times></times>
         <ci>i</ci>
         <ci>j</ci>
        </apply>
       </apply>
       <apply>
        <times></times>
        <ci>d</ci>
        <ci>e</ci>
        <ci>g</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>v</ci>
         <ci>j</ci>
        </apply>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>p</ci>
       <ci>j</ci>
      </apply>
      <apply>
       <minus></minus>
       <ci>t</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p_{i}(t)=\sum_{j}\frac{A_{ij}}{deg(v_{j})}p_{j}(t-1),
  </annotation>
 </semantics>
</math>

 or in matrix-vector notation:</p>

<p>

<math display="block" id="Laplacian_matrix:70">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>p</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>t</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mi>A</mi>
     <msup>
      <mi>D</mi>
      <mrow>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
     </msup>
     <mi>p</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mi>t</mi>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>p</ci>
     <ci>t</ci>
    </apply>
    <apply>
     <times></times>
     <ci>A</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>D</ci>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <ci>p</ci>
     <apply>
      <minus></minus>
      <ci>t</ci>
      <cn type="integer">1</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p(t)=AD^{-1}p(t-1).
  </annotation>
 </semantics>
</math>

 (Equilibrium, which sets in as 

<math display="inline" id="Laplacian_matrix:71">
 <semantics>
  <mrow>
   <mi>t</mi>
   <mo>→</mo>
   <mi mathvariant="normal">∞</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-→</ci>
    <ci>t</ci>
    <infinity></infinity>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   t\rightarrow\infty
  </annotation>
 </semantics>
</math>

, is defined by 

<math display="inline" id="Laplacian_matrix:72">
 <semantics>
  <mrow>
   <mi>p</mi>
   <mo>=</mo>
   <mrow>
    <mi>A</mi>
    <msup>
     <mi>D</mi>
     <mrow>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </msup>
    <mi>p</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>p</ci>
    <apply>
     <times></times>
     <ci>A</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>D</ci>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <ci>p</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p=AD^{-1}p
  </annotation>
 </semantics>
</math>

.)</p>

<p>We can rewrite this relation as</p>

<p>

<math display="inline" id="Laplacian_matrix:73">
 <semantics>
  <mrow>
   <msup>
    <mi>D</mi>
    <mrow>
     <mo>-</mo>
     <mfrac>
      <mn>1</mn>
      <mn>2</mn>
     </mfrac>
    </mrow>
   </msup>
   <mi>p</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>t</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>D</ci>
     <apply>
      <minus></minus>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
    <ci>p</ci>
    <ci>t</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle D^{-\frac{1}{2}}p(t)
  </annotation>
 </semantics>
</math>


 

<math display="inline" id="Laplacian_matrix:74">
 <semantics>
  <mrow>
   <msub>
    <mi>A</mi>
    <mrow>
     <mi>r</mi>
     <mi>e</mi>
     <mi>d</mi>
     <mi>u</mi>
     <mi>c</mi>
     <mi>e</mi>
     <mi>d</mi>
    </mrow>
   </msub>
   <mo>≡</mo>
   <mrow>
    <msup>
     <mi>D</mi>
     <mrow>
      <mo>-</mo>
      <mfrac>
       <mn>1</mn>
       <mn>2</mn>
      </mfrac>
     </mrow>
    </msup>
    <mi>A</mi>
    <msup>
     <mi>D</mi>
     <mrow>
      <mo>-</mo>
      <mfrac>
       <mn>1</mn>
       <mn>2</mn>
      </mfrac>
     </mrow>
    </msup>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <equivalent></equivalent>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>A</ci>
     <apply>
      <times></times>
      <ci>r</ci>
      <ci>e</ci>
      <ci>d</ci>
      <ci>u</ci>
      <ci>c</ci>
      <ci>e</ci>
      <ci>d</ci>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>D</ci>
      <apply>
       <minus></minus>
       <apply>
        <divide></divide>
        <cn type="integer">1</cn>
        <cn type="integer">2</cn>
       </apply>
      </apply>
     </apply>
     <ci>A</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>D</ci>
      <apply>
       <minus></minus>
       <apply>
        <divide></divide>
        <cn type="integer">1</cn>
        <cn type="integer">2</cn>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A_{reduced}\equiv D^{-\frac{1}{2}}AD^{-\frac{1}{2}}
  </annotation>
 </semantics>
</math>

 is a symmetric matrix called the <strong>reduced adjacency matrix</strong>. So, taking steps on this random walk requires taking powers of 

<math display="inline" id="Laplacian_matrix:75">
 <semantics>
  <msub>
   <mi>A</mi>
   <mrow>
    <mi>r</mi>
    <mi>e</mi>
    <mi>d</mi>
    <mi>u</mi>
    <mi>c</mi>
    <mi>e</mi>
    <mi>d</mi>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>A</ci>
    <apply>
     <times></times>
     <ci>r</ci>
     <ci>e</ci>
     <ci>d</ci>
     <ci>u</ci>
     <ci>c</ci>
     <ci>e</ci>
     <ci>d</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A_{reduced}
  </annotation>
 </semantics>
</math>

, which is a simple operation because 

<math display="inline" id="Laplacian_matrix:76">
 <semantics>
  <msub>
   <mi>A</mi>
   <mrow>
    <mi>r</mi>
    <mi>e</mi>
    <mi>d</mi>
    <mi>u</mi>
    <mi>c</mi>
    <mi>e</mi>
    <mi>d</mi>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>A</ci>
    <apply>
     <times></times>
     <ci>r</ci>
     <ci>e</ci>
     <ci>d</ci>
     <ci>u</ci>
     <ci>c</ci>
     <ci>e</ci>
     <ci>d</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A_{reduced}
  </annotation>
 </semantics>
</math>

 is symmetric.</p>
<h2 id="interpretation-as-the-discrete-laplace-operator">Interpretation as the discrete Laplace operator</h2>

<p>The Laplacian matrix can be interpreted as a matrix representation of a particular case of the <a href="discrete_Laplace_operator" title="wikilink">discrete Laplace operator</a>. Such an interpretation allows one, e.g., to generalise the Laplacian matrix to the case of graphs with an infinite number of vertices and edges, leading to a Laplacian matrix of an infinite size.</p>

<p>To expand upon this, we can "describe" the change of some element 

<math display="inline" id="Laplacian_matrix:77">
 <semantics>
  <msub>
   <mi>ϕ</mi>
   <mi>i</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>ϕ</ci>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \phi_{i}
  </annotation>
 </semantics>
</math>

 (with some constant <em>k</em>) as</p>

<p>

<math display="inline" id="Laplacian_matrix:78">
 <semantics>
  <mstyle displaystyle="true">
   <mfrac>
    <mrow>
     <mi>d</mi>
     <msub>
      <mi>ϕ</mi>
      <mi>i</mi>
     </msub>
    </mrow>
    <mrow>
     <mi>d</mi>
     <mi>t</mi>
    </mrow>
   </mfrac>
  </mstyle>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <divide></divide>
    <apply>
     <times></times>
     <ci>d</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>ϕ</ci>
      <ci>i</ci>
     </apply>
    </apply>
    <apply>
     <times></times>
     <ci>d</ci>
     <ci>t</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle\frac{d\phi_{i}}{dt}
  </annotation>
 </semantics>
</math>


</p>

<p>In matrix-vector notation,</p>

<p>

<math display="inline" id="Laplacian_matrix:79">
 <semantics>
  <mstyle displaystyle="true">
   <mfrac>
    <mrow>
     <mi>d</mi>
     <mi>ϕ</mi>
    </mrow>
    <mrow>
     <mi>d</mi>
     <mi>t</mi>
    </mrow>
   </mfrac>
  </mstyle>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <divide></divide>
    <apply>
     <times></times>
     <ci>d</ci>
     <ci>ϕ</ci>
    </apply>
    <apply>
     <times></times>
     <ci>d</ci>
     <ci>t</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle\frac{d\phi}{dt}
  </annotation>
 </semantics>
</math>


</p>

<p>which gives</p>

<p>

<math display="inline" id="Laplacian_matrix:80">
 <semantics>
  <mrow>
   <mrow>
    <mstyle displaystyle="true">
     <mfrac>
      <mrow>
       <mi>d</mi>
       <mi>ϕ</mi>
      </mrow>
      <mrow>
       <mi>d</mi>
       <mi>t</mi>
      </mrow>
     </mfrac>
    </mstyle>
    <mo>+</mo>
    <mrow>
     <mi>k</mi>
     <mi>L</mi>
     <mi>ϕ</mi>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mn>0.</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <plus></plus>
     <apply>
      <divide></divide>
      <apply>
       <times></times>
       <ci>d</ci>
       <ci>ϕ</ci>
      </apply>
      <apply>
       <times></times>
       <ci>d</ci>
       <ci>t</ci>
      </apply>
     </apply>
     <apply>
      <times></times>
      <ci>k</ci>
      <ci>L</ci>
      <ci>ϕ</ci>
     </apply>
    </apply>
    <cn type="float">0.</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle\frac{d\phi}{dt}+kL\phi=0.
  </annotation>
 </semantics>
</math>


</p>

<p>Notice that this equation takes the same form as the <a href="heat_equation" title="wikilink">heat equation</a>, where the matrix <em>L</em> is replacing the Laplacian operator 

<math display="inline" id="Laplacian_matrix:81">
 <semantics>
  <msup>
   <mo>∇</mo>
   <mn>2</mn>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>normal-∇</ci>
    <cn type="integer">2</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \nabla^{2}
  </annotation>
 </semantics>
</math>

; hence, the "graph Laplacian".</p>

<p>To find a solution to this differential equation, apply standard techniques for solving a first-order <a href="matrix_differential_equation" title="wikilink">matrix differential equation</a>. That is, write 

<math display="inline" id="Laplacian_matrix:82">
 <semantics>
  <mi>ϕ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>ϕ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \phi
  </annotation>
 </semantics>
</math>

 as a linear combination of eigenvectors 

<math display="inline" id="Laplacian_matrix:83">
 <semantics>
  <msub>
   <mi>𝐯</mi>
   <mi>i</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>𝐯</ci>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{v}_{i}
  </annotation>
 </semantics>
</math>

 of <em>L</em> (so that 

<math display="inline" id="Laplacian_matrix:84">
 <semantics>
  <mrow>
   <mrow>
    <mi>L</mi>
    <msub>
     <mi>𝐯</mi>
     <mi>i</mi>
    </msub>
   </mrow>
   <mo>=</mo>
   <mrow>
    <msub>
     <mi>λ</mi>
     <mi>i</mi>
    </msub>
    <msub>
     <mi>𝐯</mi>
     <mi>i</mi>
    </msub>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>L</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>𝐯</ci>
      <ci>i</ci>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>λ</ci>
      <ci>i</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>𝐯</ci>
      <ci>i</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   L\mathbf{v}_{i}=\lambda_{i}\mathbf{v}_{i}
  </annotation>
 </semantics>
</math>

), with time-dependent 

<math display="inline" id="Laplacian_matrix:85">
 <semantics>
  <mtable>
   <mtr>
    <mtd columnalign="right">
     <mrow>
      <mrow>
       <mi>ϕ</mi>
       <mo>=</mo>
       <mrow>
        <mstyle displaystyle="true">
         <munder>
          <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
          <mi>i</mi>
         </munder>
        </mstyle>
        <mrow>
         <msub>
          <mi>c</mi>
          <mi>i</mi>
         </msub>
         <msub>
          <mi>𝐯</mi>
          <mi>i</mi>
         </msub>
        </mrow>
       </mrow>
      </mrow>
      <mo>.</mo>
     </mrow>
    </mtd>
   </mtr>
  </mtable>
  <annotation-xml encoding="MathML-Content">
   <matrix>
    <matrixrow>
     <apply>
      <eq></eq>
      <ci>ϕ</ci>
      <apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <ci>i</ci>
       </apply>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>c</ci>
         <ci>i</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>𝐯</ci>
         <ci>i</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </matrixrow>
   </matrix>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \begin{aligned}\displaystyle\phi=\sum_{i}c_{i}\mathbf{v}_{i}.\end{aligned}
  </annotation>
 </semantics>
</math>

</p>

<p>Plugging into the original expression (note that we will use the fact that because <em>L</em> is a symmetric matrix, its unit-norm eigenvectors 

<math display="inline" id="Laplacian_matrix:86">
 <semantics>
  <msub>
   <mi>𝐯</mi>
   <mi>i</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>𝐯</ci>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{v}_{i}
  </annotation>
 </semantics>
</math>

 are orthogonal):</p>

<p>

<math display="inline" id="Laplacian_matrix:87">
 <semantics>
  <mrow>
   <mstyle displaystyle="true">
    <mfrac>
     <mrow>
      <mi>d</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <msub>
         <mo largeop="true" symmetric="true">∑</mo>
         <mi>i</mi>
        </msub>
        <mrow>
         <msub>
          <mi>c</mi>
          <mi>i</mi>
         </msub>
         <msub>
          <mi>𝐯</mi>
          <mi>i</mi>
         </msub>
        </mrow>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mrow>
      <mi>d</mi>
      <mi>t</mi>
     </mrow>
    </mfrac>
   </mstyle>
   <mo>+</mo>
   <mrow>
    <mi>k</mi>
    <mi>L</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mstyle displaystyle="true">
       <munder>
        <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
        <mi>i</mi>
       </munder>
      </mstyle>
      <mrow>
       <msub>
        <mi>c</mi>
        <mi>i</mi>
       </msub>
       <msub>
        <mi>𝐯</mi>
        <mi>i</mi>
       </msub>
      </mrow>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <plus></plus>
    <apply>
     <divide></divide>
     <apply>
      <times></times>
      <ci>d</ci>
      <apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <ci>i</ci>
       </apply>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>c</ci>
         <ci>i</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>𝐯</ci>
         <ci>i</ci>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <ci>d</ci>
      <ci>t</ci>
     </apply>
    </apply>
    <apply>
     <times></times>
     <ci>k</ci>
     <ci>L</ci>
     <apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <ci>i</ci>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>c</ci>
        <ci>i</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>𝐯</ci>
        <ci>i</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle\frac{d(\sum_{i}c_{i}\mathbf{v}_{i})}{dt}+kL(\sum_{i}c_{i}\mathbf%
{v}_{i})
  </annotation>
 </semantics>
</math>


</p>

<p>whose solution is</p>

<p>

<math display="inline" id="Laplacian_matrix:88">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <msub>
      <mi>c</mi>
      <mi>i</mi>
     </msub>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>t</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <msub>
      <mi>c</mi>
      <mi>i</mi>
     </msub>
     <mrow>
      <mo stretchy="false">(</mo>
      <mn>0</mn>
      <mo stretchy="false">)</mo>
     </mrow>
     <mrow>
      <mi>exp</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mo>-</mo>
        <mrow>
         <mi>k</mi>
         <msub>
          <mi>λ</mi>
          <mi>i</mi>
         </msub>
         <mi>t</mi>
        </mrow>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>c</ci>
      <ci>i</ci>
     </apply>
     <ci>t</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>c</ci>
      <ci>i</ci>
     </apply>
     <cn type="integer">0</cn>
     <apply>
      <exp></exp>
      <apply>
       <minus></minus>
       <apply>
        <times></times>
        <ci>k</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>λ</ci>
         <ci>i</ci>
        </apply>
        <ci>t</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle c_{i}(t)=c_{i}(0)\exp(-k\lambda_{i}t).
  </annotation>
 </semantics>
</math>


</p>

<p>As shown before, the eigenvalues 

<math display="inline" id="Laplacian_matrix:89">
 <semantics>
  <msub>
   <mi>λ</mi>
   <mi>i</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>λ</ci>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \lambda_{i}
  </annotation>
 </semantics>
</math>


 of <em>L</em> are non-negative, showing that the solution to the diffusion equation approaches an equilibrium, because it only exponentially decays or remains constant. This also shows that given 

<math display="inline" id="Laplacian_matrix:90">
 <semantics>
  <msub>
   <mi>λ</mi>
   <mi>i</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>λ</ci>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \lambda_{i}
  </annotation>
 </semantics>
</math>

 and the initial condition 

<math display="inline" id="Laplacian_matrix:91">
 <semantics>
  <mrow>
   <msub>
    <mi>c</mi>
    <mi>i</mi>
   </msub>
   <mrow>
    <mo stretchy="false">(</mo>
    <mn>0</mn>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>c</ci>
     <ci>i</ci>
    </apply>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   c_{i}(0)
  </annotation>
 </semantics>
</math>

, the solution at any time <em>t</em> can be found.<a class="footnoteRef" href="#fn6" id="fnref6"><sup>6</sup></a></p>

<p>To find 

<math display="inline" id="Laplacian_matrix:92">
 <semantics>
  <mrow>
   <msub>
    <mi>c</mi>
    <mi>i</mi>
   </msub>
   <mrow>
    <mo stretchy="false">(</mo>
    <mn>0</mn>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>c</ci>
     <ci>i</ci>
    </apply>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   c_{i}(0)
  </annotation>
 </semantics>
</math>

 for each 

<math display="inline" id="Laplacian_matrix:93">
 <semantics>
  <mi>i</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>i</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   i
  </annotation>
 </semantics>
</math>

 in terms of the overall initial condition 

<math display="inline" id="Laplacian_matrix:94">
 <semantics>
  <mrow>
   <mi>ϕ</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mn>0</mn>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>ϕ</ci>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \phi(0)
  </annotation>
 </semantics>
</math>


, simply project 

<math display="inline" id="Laplacian_matrix:95">
 <semantics>
  <mrow>
   <mi>ϕ</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mn>0</mn>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>ϕ</ci>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \phi(0)
  </annotation>
 </semantics>
</math>

 onto the unit-norm eigenvectors 

<math display="inline" id="Laplacian_matrix:96">
 <semantics>
  <msub>
   <mi>𝐯</mi>
   <mi>i</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>𝐯</ci>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{v}_{i}
  </annotation>
 </semantics>
</math>

;</p>

<p>

<math display="inline" id="Laplacian_matrix:97">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>c</mi>
     <mi>i</mi>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <mn>0</mn>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mo stretchy="false">⟨</mo>
    <mrow>
     <mi>ϕ</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mn>0</mn>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>,</mo>
    <msub>
     <mi>𝐯</mi>
     <mi>i</mi>
    </msub>
    <mo stretchy="false">⟩</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>c</ci>
      <ci>i</ci>
     </apply>
     <cn type="integer">0</cn>
    </apply>
    <list>
     <apply>
      <times></times>
      <ci>ϕ</ci>
      <cn type="integer">0</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>𝐯</ci>
      <ci>i</ci>
     </apply>
    </list>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   c_{i}(0)=\langle\phi(0),\mathbf{v}_{i}\rangle
  </annotation>
 </semantics>
</math>

.</p>

<p>In the case of undirected graphs, this works because 

<math display="inline" id="Laplacian_matrix:98">
 <semantics>
  <mi>L</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>L</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   L
  </annotation>
 </semantics>
</math>

 is symmetric, and by the <a href="spectral_theorem" title="wikilink">spectral theorem</a>, its eigenvectors are all orthogonal. So the projection onto the eigenvectors of 

<math display="inline" id="Laplacian_matrix:99">
 <semantics>
  <mi>L</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>L</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   L
  </annotation>
 </semantics>
</math>


 is simply an orthogonal coordinate transformation of the initial condition to a set of coordinates which decay exponentially and independently of each other.</p>
<h3 id="equilibrium-behavior">Equilibrium Behavior</h3>

<p>To understand 

<math display="inline" id="Laplacian_matrix:100">
 <semantics>
  <mrow>
   <msub>
    <mo>lim</mo>
    <mrow>
     <mi>t</mi>
     <mo>→</mo>
     <mi mathvariant="normal">∞</mi>
    </mrow>
   </msub>
   <mrow>
    <mi>ϕ</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>t</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <limit></limit>
     <apply>
      <ci>normal-→</ci>
      <ci>t</ci>
      <infinity></infinity>
     </apply>
    </apply>
    <apply>
     <times></times>
     <ci>ϕ</ci>
     <ci>t</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \lim_{t\to\infty}\phi(t)
  </annotation>
 </semantics>
</math>

, note that the only terms 

<math display="inline" id="Laplacian_matrix:101">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>c</mi>
     <mi>i</mi>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>t</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <msub>
     <mi>c</mi>
     <mi>i</mi>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <mn>0</mn>
     <mo stretchy="false">)</mo>
    </mrow>
    <mrow>
     <mi>exp</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mo>-</mo>
       <mrow>
        <mi>k</mi>
        <msub>
         <mi>λ</mi>
         <mi>i</mi>
        </msub>
        <mi>t</mi>
       </mrow>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>c</ci>
      <ci>i</ci>
     </apply>
     <ci>t</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>c</ci>
      <ci>i</ci>
     </apply>
     <cn type="integer">0</cn>
     <apply>
      <exp></exp>
      <apply>
       <minus></minus>
       <apply>
        <times></times>
        <ci>k</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>λ</ci>
         <ci>i</ci>
        </apply>
        <ci>t</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   c_{i}(t)=c_{i}(0)\exp(-k\lambda_{i}t)
  </annotation>
 </semantics>
</math>

 that remain are those where 

<math display="inline" id="Laplacian_matrix:102">
 <semantics>
  <mrow>
   <msub>
    <mi>λ</mi>
    <mi>i</mi>
   </msub>
   <mo>=</mo>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>λ</ci>
     <ci>i</ci>
    </apply>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \lambda_{i}=0
  </annotation>
 </semantics>
</math>

, since</p>

<p>

<math display="inline" id="Laplacian_matrix:103">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mo>lim</mo>
     <mrow>
      <mi>t</mi>
      <mo>→</mo>
      <mi mathvariant="normal">∞</mi>
     </mrow>
    </msub>
    <mrow>
     <mi>exp</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mo>-</mo>
       <mrow>
        <mi>k</mi>
        <msub>
         <mi>λ</mi>
         <mi>i</mi>
        </msub>
        <mi>t</mi>
       </mrow>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mo>{</mo>
    <mtable>
     <mtr>
      <mtd columnalign="right">
       <mn>0</mn>
      </mtd>
      <mtd columnalign="left">
       <mtext>if</mtext>
      </mtd>
      <mtd columnalign="right">
       <mrow>
        <msub>
         <mi>λ</mi>
         <mi>i</mi>
        </msub>
        <mo>></mo>
        <mn>0</mn>
       </mrow>
      </mtd>
     </mtr>
     <mtr>
      <mtd columnalign="right">
       <mn>1</mn>
      </mtd>
      <mtd columnalign="left">
       <mtext>if</mtext>
      </mtd>
      <mtd columnalign="right">
       <mrow>
        <msub>
         <mi>λ</mi>
         <mi>i</mi>
        </msub>
        <mo>=</mo>
        <mn>0</mn>
       </mrow>
      </mtd>
     </mtr>
    </mtable>
    <mo>}</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <limit></limit>
      <apply>
       <ci>normal-→</ci>
       <ci>t</ci>
       <infinity></infinity>
      </apply>
     </apply>
     <apply>
      <exp></exp>
      <apply>
       <minus></minus>
       <apply>
        <times></times>
        <ci>k</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>λ</ci>
         <ci>i</ci>
        </apply>
        <ci>t</ci>
       </apply>
      </apply>
     </apply>
    </apply>
    <set>
     <matrix>
      <matrixrow>
       <cn type="integer">0</cn>
       <mtext>if</mtext>
       <apply>
        <gt></gt>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>λ</ci>
         <ci>i</ci>
        </apply>
        <cn type="integer">0</cn>
       </apply>
      </matrixrow>
      <matrixrow>
       <cn type="integer">1</cn>
       <mtext>if</mtext>
       <apply>
        <eq></eq>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>λ</ci>
         <ci>i</ci>
        </apply>
        <cn type="integer">0</cn>
       </apply>
      </matrixrow>
     </matrix>
    </set>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \lim_{t\to\infty}\exp(-k\lambda_{i}t)=\left\{\begin{array}[]{rlr}0&\text{if}&%
\lambda_{i}>0\\
1&\text{if}&\lambda_{i}=0\end{array}\right\}
  </annotation>
 </semantics>
</math>

</p>

<p>In other words, the equilibrium state of the system is determined completely by the <a href="Kernel_(linear_algebra)" title="wikilink">kernel</a> of 

<math display="inline" id="Laplacian_matrix:104">
 <semantics>
  <mi>L</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>L</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   L
  </annotation>
 </semantics>
</math>


. Since by definition, 

<math display="inline" id="Laplacian_matrix:105">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mo largeop="true" symmetric="true">∑</mo>
     <mi>j</mi>
    </msub>
    <msub>
     <mi>L</mi>
     <mrow>
      <mi>i</mi>
      <mi>j</mi>
     </mrow>
    </msub>
   </mrow>
   <mo>=</mo>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <sum></sum>
      <ci>j</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>L</ci>
      <apply>
       <times></times>
       <ci>i</ci>
       <ci>j</ci>
      </apply>
     </apply>
    </apply>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \sum_{j}L_{ij}=0
  </annotation>
 </semantics>
</math>

, the vector 

<math display="inline" id="Laplacian_matrix:106">
 <semantics>
  <msup>
   <mi>𝐯</mi>
   <mn>1</mn>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>𝐯</ci>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{v}^{1}
  </annotation>
 </semantics>
</math>

 of all ones is in the kernel. Note also that if there are 

<math display="inline" id="Laplacian_matrix:107">
 <semantics>
  <mi>k</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>k</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   k
  </annotation>
 </semantics>
</math>

 disjoint <a href="Connected_component_(graph_theory)" title="wikilink">connected components</a> in the graph, then this vector of all ones can be split into the sum of 

<math display="inline" id="Laplacian_matrix:108">
 <semantics>
  <mi>k</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>k</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   k
  </annotation>
 </semantics>
</math>

 independent 

<math display="inline" id="Laplacian_matrix:109">
 <semantics>
  <mrow>
   <mi>λ</mi>
   <mo>=</mo>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>λ</ci>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \lambda=0
  </annotation>
 </semantics>
</math>


 eigenvectors of ones and zeros, where each connected component corresponds to an eigenvector with ones at the elements in the connected component and zeros elsewhere.</p>

<p>The consequence of this is that for a given initial condition 

<math display="inline" id="Laplacian_matrix:110">
 <semantics>
  <mrow>
   <mi>c</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mn>0</mn>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>c</ci>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   c(0)
  </annotation>
 </semantics>
</math>

 for a graph with 

<math display="inline" id="Laplacian_matrix:111">
 <semantics>
  <mi>N</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>N</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   N
  </annotation>
 </semantics>
</math>

 vertices</p>

<p>

<math display="inline" id="Laplacian_matrix:112">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mo>lim</mo>
     <mrow>
      <mi>t</mi>
      <mo>→</mo>
      <mi mathvariant="normal">∞</mi>
     </mrow>
    </msub>
    <mrow>
     <mi>ϕ</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>t</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mo stretchy="false">⟨</mo>
     <mrow>
      <mi>c</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mn>0</mn>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo>,</mo>
     <msup>
      <mi>𝐯</mi>
      <mn>𝟏</mn>
     </msup>
     <mo stretchy="false">⟩</mo>
    </mrow>
    <msup>
     <mi>𝐯</mi>
     <mn>𝟏</mn>
    </msup>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <limit></limit>
      <apply>
       <ci>normal-→</ci>
       <ci>t</ci>
       <infinity></infinity>
      </apply>
     </apply>
     <apply>
      <times></times>
      <ci>ϕ</ci>
      <ci>t</ci>
     </apply>
    </apply>
    <apply>
     <times></times>
     <list>
      <apply>
       <times></times>
       <ci>c</ci>
       <cn type="integer">0</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>𝐯</ci>
       <cn type="integer">1</cn>
      </apply>
     </list>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>𝐯</ci>
      <cn type="integer">1</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \lim_{t\to\infty}\phi(t)=\langle c(0),\mathbf{v^{1}}\rangle\mathbf{v^{1}}
  </annotation>
 </semantics>
</math>

</p>

<p>where</p>

<p>

<math display="inline" id="Laplacian_matrix:113">
 <semantics>
  <mrow>
   <msup>
    <mi>𝐯</mi>
    <mn>𝟏</mn>
   </msup>
   <mo>=</mo>
   <mrow>
    <mfrac>
     <mn>1</mn>
     <msqrt>
      <mi>N</mi>
     </msqrt>
    </mfrac>
    <mrow>
     <mo stretchy="false">[</mo>
     <mn>1</mn>
     <mo>,</mo>
     <mn>1</mn>
     <mo>,</mo>
     <mi mathvariant="normal">…</mi>
     <mo>,</mo>
     <mn>1</mn>
     <mo stretchy="false">]</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>𝐯</ci>
     <cn type="integer">1</cn>
    </apply>
    <apply>
     <times></times>
     <apply>
      <divide></divide>
      <cn type="integer">1</cn>
      <apply>
       <root></root>
       <ci>N</ci>
      </apply>
     </apply>
     <list>
      <cn type="integer">1</cn>
      <cn type="integer">1</cn>
      <ci>normal-…</ci>
      <cn type="integer">1</cn>
     </list>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{v^{1}}=\frac{1}{\sqrt{N}}[1,1,...,1]
  </annotation>
 </semantics>
</math>

</p>

<p>For each element 

<math display="inline" id="Laplacian_matrix:114">
 <semantics>
  <msub>
   <mi>ϕ</mi>
   <mi>j</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>ϕ</ci>
    <ci>j</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \phi_{j}
  </annotation>
 </semantics>
</math>


 of 

<math display="inline" id="Laplacian_matrix:115">
 <semantics>
  <mi>ϕ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>ϕ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \phi
  </annotation>
 </semantics>
</math>

, i.e. for each vertex 

<math display="inline" id="Laplacian_matrix:116">
 <semantics>
  <mi>j</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>j</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   j
  </annotation>
 </semantics>
</math>

 in the graph, it can be rewritten as</p>

<p>

<math display="inline" id="Laplacian_matrix:117">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mo>lim</mo>
     <mrow>
      <mi>t</mi>
      <mo>→</mo>
      <mi mathvariant="normal">∞</mi>
     </mrow>
    </msub>
    <mrow>
     <msub>
      <mi>ϕ</mi>
      <mi>j</mi>
     </msub>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>t</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mfrac>
     <mn>1</mn>
     <mi>N</mi>
    </mfrac>
    <mrow>
     <msubsup>
      <mo largeop="true" symmetric="true">∑</mo>
      <mrow>
       <mi>i</mi>
       <mo>=</mo>
       <mn>1</mn>
      </mrow>
      <mi>N</mi>
     </msubsup>
     <mrow>
      <msub>
       <mi>c</mi>
       <mi>i</mi>
      </msub>
      <mrow>
       <mo stretchy="false">(</mo>
       <mn>0</mn>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <limit></limit>
      <apply>
       <ci>normal-→</ci>
       <ci>t</ci>
       <infinity></infinity>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>ϕ</ci>
       <ci>j</ci>
      </apply>
      <ci>t</ci>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <divide></divide>
      <cn type="integer">1</cn>
      <ci>N</ci>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <apply>
         <eq></eq>
         <ci>i</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <ci>N</ci>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>c</ci>
        <ci>i</ci>
       </apply>
       <cn type="integer">0</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \lim_{t\to\infty}\phi_{j}(t)=\frac{1}{N}\sum_{i=1}^{N}c_{i}(0)
  </annotation>
 </semantics>
</math>

.</p>

<p>In other words, at steady state, the value of 

<math display="inline" id="Laplacian_matrix:118">
 <semantics>
  <mi>ϕ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>ϕ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \phi
  </annotation>
 </semantics>
</math>

 converges to the same value at each of the vertices of the graph, which is the average of the initial values at all of the vertices. Since this is the solution to the heat diffusion equation, this makes perfect sense intuitively. We expect that neighboring elements in the graph will exchange energy until that energy is spread out evenly throughout all of the elements that are connected to each other.</p>
<h3 id="example-of-the-operator-on-a-grid">Example of the Operator on a Grid</h3>
<figure><b>(Figure)</b>
<figcaption>This GIF shows the progression of diffusion, as solved by the graph laplacian technique. A graph is constructed over a grid, where each pixel in the graph is connected to its 8 bordering pixels. Values in the image then diffuse smoothly to their neighbors over time via these connections. This particular image starts off with three strong point values which spill over to their neighbors slowly. The whole system eventually settles out to the same value at equilibrium.</figcaption>
</figure>

<p>This section shows an example of a function 

<math display="inline" id="Laplacian_matrix:119">
 <semantics>
  <mi>ϕ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>ϕ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \phi
  </annotation>
 </semantics>
</math>


 diffusing over time through a graph. The graph in this example is constructed on a 2D discrete grid, with points on the grid connected to their eight neighbors. Three initial points are specified to have a positive value, while the rest of the values in the grid are zero. Over time, the exponential decay acts to distribute the values at these points evenly throughout the entire grid.</p>

<p>The complete Matlab source code that was used to generate this animation is provided below. It shows the process of specifying initial conditions, projecting these initial conditions onto the eigenvalues of the Laplacian Matrix, and simulating the exponential decay of these projected initial conditions.</p>
<div class="sourceCode"><pre class="sourceCode matlab"><code class="sourceCode matlab">
N = <span class="fl">20</span>;<span class="co">%The number of pixels along a dimension of the image</span>
A = zeros(N, N);<span class="co">%The image</span>
Adj = zeros(N*N, N*N);<span class="co">%The adjacency matrix</span>

<span class="co">%Use 8 neighbors, and fill in the adjacency matrix</span>
dx = [-<span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">1</span>, -<span class="fl">1</span>, <span class="fl">1</span>, -<span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">1</span>];
dy = [-<span class="fl">1</span>, -<span class="fl">1</span>, -<span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>];
for x = <span class="fl">1</span>:N
   for y = <span class="fl">1</span>:N
       index = (x-<span class="fl">1</span>)*N + y;
       for ne = <span class="fl">1</span>:length(dx)
           newx = x + dx(ne);
           newy = y + dy(ne);
           if newx &gt; <span class="fl">0</span> &amp;&amp; newx &lt;= N &amp;&amp; newy &gt; <span class="fl">0</span> &amp;&amp; newy &lt;= N
               index2 = (newx-<span class="fl">1</span>)*N + newy;
               Adj(index, index2) = <span class="fl">1</span>;
           end
       end
   end
end

<span class="co">%%%BELOW IS THE KEY CODE THAT COMPUTES THE SOLUTION TO THE DIFFERENTIAL</span>
<span class="co">%%%EQUATION</span>
Deg = diag(sum(Adj, <span class="fl">2</span>));<span class="co">%Compute the degree matrix</span>
L = Deg - Adj;<span class="co">%Compute the laplacian matrix in terms of the degree and adjacency matrices</span>
[V, D] = eig(L);<span class="co">%Compute the eigenvalues/vectors of the laplacian matrix</span>
D = diag(D);

<span class="co">%Initial condition (place a few large positive values around and</span>
<span class="co">%make everything else zero)</span>
C0 = zeros(N, N);
C0(<span class="fl">2</span>:<span class="fl">5</span>, <span class="fl">2</span>:<span class="fl">5</span>) = <span class="fl">5</span>;
C0(<span class="fl">10</span>:<span class="fl">15</span>, <span class="fl">10</span>:<span class="fl">15</span>) = <span class="fl">10</span>;
C0(<span class="fl">2</span>:<span class="fl">5</span>, <span class="fl">8</span>:<span class="fl">13</span>) = <span class="fl">7</span>;
C0 = C0(:);

C0V = V'*C0;<span class="co">%Transform the initial condition into the coordinate system </span>
<span class="co">%of the eigenvectors</span>
for t = <span class="fl">0</span>:<span class="fl">0.05</span>:<span class="fl">5</span>
   <span class="co">%Loop through times and decay each initial component</span>
   Phi = C0V.*exp(-D*t);<span class="co">%Exponential decay for each component</span>
   Phi = V*Phi;<span class="co">%Transform from eigenvector coordinate system to original coordinate system</span>
   Phi = reshape(Phi, N, N);
   <span class="co">%Display the results and write to GIF file</span>
   imagesc(Phi);
   caxis([<span class="fl">0</span>, <span class="fl">10</span>]);
   title(sprintf(<span class="st">'Diffusion t = %3f'</span>, t));
   frame = getframe(<span class="fl">1</span>);
   im = frame2im(frame);
   [imind, cm] = rgb2ind(im, <span class="fl">256</span>);
   if t == <span class="fl">0</span>
      imwrite(imind, cm, <span class="st">'out.gif'</span>, <span class="st">'gif'</span>, <span class="st">'Loopcount'</span>, inf, <span class="st">'DelayTime'</span>, <span class="fl">0.1</span>); 
   else
      imwrite(imind, cm, <span class="st">'out.gif'</span>, <span class="st">'gif'</span>, <span class="st">'WriteMode'</span>, <span class="st">'append'</span>, <span class="st">'DelayTime'</span>, <span class="fl">0.1</span>);
   end
end</code></pre></div>
<h2 id="approximation-to-the-negative-continuous-laplacian">Approximation to the negative continuous Laplacian</h2>

<p>The graph Laplacian matrix can be further viewed as a matrix form of an approximation to the (positive semi-definite) <a class="uri" href="Laplacian" title="wikilink">Laplacian</a> operator obtained by the <a href="finite_difference_method" title="wikilink">finite difference method</a>.<a class="footnoteRef" href="#fn7" id="fnref7"><sup>7</sup></a> In this interpretation, every graph vertex is treated as a grid point; the local connectivity of the vertex determines the finite difference approximation <a href="stencil_(numerical_analysis)" title="wikilink">stencil</a> at this grid point, the grid size is always one for every edge, and there are no constraints on any grid points, which corresponds to the case of the homogeneous <a href="Neumann_boundary_condition" title="wikilink">Neumann boundary condition</a>, i.e., free boundary.</p>
<h2 id="in-directed-multigraphs">In Directed Multigraphs</h2>

<p>An analogue of the Laplacian matrix can be defined for directed multigraphs.<a class="footnoteRef" href="#fn8" id="fnref8"><sup>8</sup></a> In this case the Laplacian matrix <em>L</em> is defined as</p>

<p>

<math display="block" id="Laplacian_matrix:120">
 <semantics>
  <mrow>
   <mi>L</mi>
   <mo>=</mo>
   <mrow>
    <mi>D</mi>
    <mo>-</mo>
    <mi>A</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>L</ci>
    <apply>
     <minus></minus>
     <ci>D</ci>
     <ci>A</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   L=D-A
  </annotation>
 </semantics>
</math>

 where <em>D</em> is a diagonal matrix with <em>D</em><sub><em>i</em>,<em>i</em></sub> equal to the outdegree of vertex <em>i</em> and <em>A</em> is a matix with <em>A</em><sub><em>i</em>,<em>j</em></sub> equal to the number of edges from <em>i</em> to <em>j</em> (including loops).</p>
<h2 id="see-also">See also</h2>
<ul>
<li><a href="Stiffness_matrix" title="wikilink">Stiffness matrix</a></li>
<li><a href="Resistance_distance" title="wikilink">Resistance distance</a></li>
</ul>
<h2 id="references">References</h2>
<ul>
<li>T. Sunada, Discrete geometric analysis, <em>Proceedings of Symposia in Pure Mathematics,</em> (ed. by P. Exner, J. P. Keating, P. Kuchment, T. Sunada, A. Teplyaev), <strong>77</strong> (2008), 51-86.</li>
<li>B. Bollobaás, <em>Modern Graph Theory</em>, Springer-Verlag (1998, corrected ed. 2013), ISBN 0-387-98488-7, Chapters II.3 (Vector Spaces and Matrices Associated with Graphs), VIII.2 (The Adjacency Matrix and the Laplacian), IX.2 (Electrical Networks and Random Walks).</li>
</ul>

<p>"</p>

<p><a href="Category:Algebraic_graph_theory" title="wikilink">Category:Algebraic graph theory</a> <a class="uri" href="Category:Matrices" title="wikilink">Category:Matrices</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1"><a href="#fnref1">↩</a></li>
<li id="fn2"></li>
<li id="fn3">"The Deformed Consensus Protocol", F. Morbidi, Automatica, vol. 49, n. 10, pp. 3049-3055, October 2013.<a href="#fnref3">↩</a></li>
<li id="fn4"><a href="#fnref4">↩</a></li>
<li id="fn5"><a href="#fnref5">↩</a></li>
<li id="fn6"><a href="#fnref6">↩</a></li>
<li id="fn7">.<a href="#fnref7">↩</a></li>
<li id="fn8"><a href="#fnref8">↩</a></li>
</ol>
</section>
</body>


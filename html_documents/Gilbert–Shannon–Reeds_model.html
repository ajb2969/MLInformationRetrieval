<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="365">Gilbert–Shannon–Reeds model</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Gilbert–Shannon–Reeds model</h1>
<hr/>

<p>In the mathematics of <a class="uri" href="shuffling" title="wikilink">shuffling</a> <a href="playing_card" title="wikilink">playing cards</a>, the <strong>Gilbert–Shannon–Reeds model</strong> is a <a href="probability_distribution" title="wikilink">probability distribution</a> on <a href="riffle_shuffle_permutation" title="wikilink">riffle shuffle permutations</a> that has been reported to be a good match for experimentally observed outcomes of human shuffling,<a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a> and that forms the basis for a recommendation that a deck of cards should be riffled seven times in order to thoroughly randomize it.<a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a> It is named after the work of <a href="Edgar_Gilbert" title="wikilink">Edgar Gilbert</a>, <a href="Claude_Shannon" title="wikilink">Claude Shannon</a>, and J. Reeds, reported in a 1955 technical report by Gilbert<a class="footnoteRef" href="#fn3" id="fnref3"><sup>3</sup></a> and in a 1981 unpublished manuscript of Reeds.</p>
<h2 id="the-model">The model</h2>

<p>The Gilbert–Shannon–Reeds model may be defined in several equivalent ways.</p>

<p>Most similarly to the way humans shuffle cards, it can be defined as a random cut and riffle. The deck of cards is cut into two packets; if there are a total of <em>n</em> cards, then the probability of selecting <em>k</em> cards in the first deck and <em>n</em> − <em>k</em> in the second deck is 

<math display="inline" id="Gilbert–Shannon–Reeds_model:0">
 <semantics>
  <mrow>
   <mrow>
    <mo>(</mo>
    <mstyle scriptlevel="+1">
     <mtable columnspacing="0.4em" rowspacing="0.2ex">
      <mtr>
       <mtd>
        <mi>n</mi>
       </mtd>
      </mtr>
      <mtr>
       <mtd>
        <mi>k</mi>
       </mtd>
      </mtr>
     </mtable>
    </mstyle>
    <mo>)</mo>
   </mrow>
   <mo>/</mo>
   <msup>
    <mn>2</mn>
    <mi>n</mi>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <divide></divide>
    <apply>
     <csymbol cd="latexml">binomial</csymbol>
     <ci>n</ci>
     <ci>k</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <cn type="integer">2</cn>
     <ci>n</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   {\textstyle\left({{n}\atop{k}}\right)}/2^{n}
  </annotation>
 </semantics>
</math>

. Then, one card at a time is repeatedly moved from the bottom of one of the packets to the top of the shuffled deck, such that if <em>x</em> cards remain in one packet and <em>y</em> cards remain in the other packet, then the probability of choosing a card from the first packet is <em>x</em>/(<em>x</em> + <em>y</em>) and the probability of choosing a card from the second packet is <em>y</em>/(<em>x</em> + <em>y</em>).<a class="footnoteRef" href="#fn4" id="fnref4"><sup>4</sup></a></p>

<p>An alternative description can be based on a property of the model, that it generates a permutation of the initial deck in which each card is equally likely to have come from the first or the second packet.<a class="footnoteRef" href="#fn5" id="fnref5"><sup>5</sup></a> To generate a random permutation according to this model, begin by flipping a <a href="fair_coin" title="wikilink">fair coin</a> <em>n</em> times, to determine for each position of the shuffled deck whether it comes from the first packet or the second packet. Then split into two packets whose sizes are the number of tails and the number of heads flipped, and use the same coin flip sequence to determine from which packet to pull each card of the shuffled deck.</p>

<p>Another alternative description is more abstract, but lends itself better to mathematical analysis. Generate a set of <em>n</em> values from the <a href="Uniform_distribution_(continuous)" title="wikilink">uniform continuous distribution</a> on the unit interval, and place them in sorted order. Then the <a href="dyadic_transformation" title="wikilink">doubling map</a> 

<math display="inline" id="Gilbert–Shannon–Reeds_model:1">
 <semantics>
  <mrow>
   <mi>x</mi>
   <mo>↦</mo>
   <mrow>
    <mrow>
     <mn>2</mn>
     <mi>x</mi>
    </mrow>
    <mspace width="veryverythickmathspace">
    </mspace>
    <mrow>
     <mo lspace="8.1pt" stretchy="false">(</mo>
     <mrow>
      <mo>mod</mo>
      <mn>1</mn>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">maps-to</csymbol>
    <ci>x</ci>
    <apply>
     <csymbol cd="latexml">annotated</csymbol>
     <apply>
      <times></times>
      <cn type="integer">2</cn>
      <ci>x</ci>
     </apply>
     <apply>
      <ci>pmod</ci>
      <cn type="integer">1</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x\mapsto 2x\;\;(\mathop{{\rm mod}}1)
  </annotation>
 </semantics>
</math>

 from the theory of <a href="dynamical_system" title="wikilink">dynamical systems</a> maps this system of points to a permutation of the points in which the permuted ordering obeys the Gilbert–Shannon–Reeds model, and the positions of the new points are again uniformly random.<a class="footnoteRef" href="#fn6" id="fnref6"><sup>6</sup></a><a class="footnoteRef" href="#fn7" id="fnref7"><sup>7</sup></a></p>

<p>Among all of the possible <a href="riffle_shuffle_permutation" title="wikilink">riffle shuffle permutations</a> of a card deck, the Gilbert–Shannon–Reeds model gives almost all riffles equal probability, 1/2<sup><em>n</em></sup>, of occurring. However, there is one exception, the <a href="identity_permutation" title="wikilink">identity permutation</a>, which has a greater probability (<em>n</em> + 1)/2<sup><em>n</em></sup> of occurring.<a class="footnoteRef" href="#fn8" id="fnref8"><sup>8</sup></a><a class="footnoteRef" href="#fn9" id="fnref9"><sup>9</sup></a></p>
<h2 id="inverse">Inverse</h2>

<p>The inverse permutation of a random riffle may be generated directly. To do so, start with a deck of <em>n</em> cards and then repeatedly deal off the bottom card of the deck onto one of two piles, choosing randomly with equal probability which of the two piles to deal each card onto. Then, when all cards have been dealt, stack the two piles back together.<a class="footnoteRef" href="#fn10" id="fnref10"><sup>10</sup></a></p>
<h2 id="the-effect-of-repeated-riffles">The effect of repeated riffles</h2>

<p>analyzed mathematically the <a href="total_variation_distance" title="wikilink">total variation distance</a> between two probability distributions on permutations: the <a href="Uniform_distribution_(discrete)" title="wikilink">uniform distribution</a> in which all permutations are equally likely, and the distribution generated by repeated applications of the Gilbert–Shannon–Reeds model. The total variation distance measures how similar or dissimilar two probability distributions are; it is zero only when the two distributions are identical, and attains a maximum value of one for probability distributions that never generate the same values as each other. Bayer and Diaconis reported that, for decks of <em>n</em> cards shuffled 

<math display="inline" id="Gilbert–Shannon–Reeds_model:2">
 <semantics>
  <mrow>
   <mrow>
    <mfrac>
     <mn>3</mn>
     <mn>2</mn>
    </mfrac>
    <mrow>
     <msub>
      <mi>log</mi>
      <mn>2</mn>
     </msub>
     <mi>n</mi>
    </mrow>
   </mrow>
   <mo>+</mo>
   <mi>θ</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <plus></plus>
    <apply>
     <times></times>
     <apply>
      <divide></divide>
      <cn type="integer">3</cn>
      <cn type="integer">2</cn>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <log></log>
       <cn type="integer">2</cn>
      </apply>
      <ci>n</ci>
     </apply>
    </apply>
    <ci>θ</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \tfrac{3}{2}\log_{2}n+\theta
  </annotation>
 </semantics>
</math>

 times, where <em>θ</em> is an arbitrary constant, the total variation distance is close to one when <em>θ</em> is significantly less than zero, and close to zero when <em>θ</em> is significantly greater than zero, independently of <em>n</em>. In particular their calculations showed that for <em>n</em> = 52, five riffles produce a distribution whose total variation distance from uniform is still close to one, while seven riffles give total variation distance 0.334. This result was widely reported as implying that card decks should be riffled seven times in order to thoroughly randomize them.<a class="footnoteRef" href="#fn11" id="fnref11"><sup>11</sup></a><a class="footnoteRef" href="#fn12" id="fnref12"><sup>12</sup></a><a class="footnoteRef" href="#fn13" id="fnref13"><sup>13</sup></a></p>

<p>Similar analyses have been performed using the <a href="Kullback–Leibler_divergence" title="wikilink">Kullback–Leibler divergence</a>, a distance between two probability distributions defined in terms of <a class="uri" href="entropy" title="wikilink">entropy</a>; the divergence of a distribution from uniform can be interpreted as the number of <a href="bit" title="wikilink">bits</a> of information that can still be recovered about the initial state of the card deck. The results are qualitatively different: rather than having a sharp threshold between random and non-random at 

<math display="inline" id="Gilbert–Shannon–Reeds_model:3">
 <semantics>
  <mrow>
   <mfrac>
    <mn>3</mn>
    <mn>2</mn>
   </mfrac>
   <mrow>
    <msub>
     <mi>log</mi>
     <mn>2</mn>
    </msub>
    <mi>n</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <divide></divide>
     <cn type="integer">3</cn>
     <cn type="integer">2</cn>
    </apply>
    <apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <log></log>
      <cn type="integer">2</cn>
     </apply>
     <ci>n</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \tfrac{3}{2}\log_{2}n
  </annotation>
 </semantics>
</math>

 shuffles, as occurs for total variation distance, the divergence decays more gradually, decreasing linearly as the number of shuffles ranges from zero to 

<math display="inline" id="Gilbert–Shannon–Reeds_model:4">
 <semantics>
  <mrow>
   <msub>
    <mi>log</mi>
    <mn>2</mn>
   </msub>
   <mi>n</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <log></log>
     <cn type="integer">2</cn>
    </apply>
    <ci>n</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \log_{2}n
  </annotation>
 </semantics>
</math>

 (at which point the number of remaining bits of information is linear, smaller by a logarithmic factor than its initial value) and then decreasing exponentially until, after 

<math display="inline" id="Gilbert–Shannon–Reeds_model:5">
 <semantics>
  <mrow>
   <mfrac>
    <mn>3</mn>
    <mn>2</mn>
   </mfrac>
   <mrow>
    <msub>
     <mi>log</mi>
     <mn>2</mn>
    </msub>
    <mi>n</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <divide></divide>
     <cn type="integer">3</cn>
     <cn type="integer">2</cn>
    </apply>
    <apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <log></log>
      <cn type="integer">2</cn>
     </apply>
     <ci>n</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \tfrac{3}{2}\log_{2}n
  </annotation>
 </semantics>
</math>

 shuffles, only a constant number of bits of information remain.<a class="footnoteRef" href="#fn14" id="fnref14"><sup>14</sup></a><a class="footnoteRef" href="#fn15" id="fnref15"><sup>15</sup></a></p>
<h2 id="references">References</h2>

<p>"</p>

<p><a href="Category:Card_shuffling" title="wikilink">Category:Card shuffling</a> <a href="Category:Stochastic_models" title="wikilink">Category:Stochastic models</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1">.<a href="#fnref1">↩</a></li>
<li id="fn2">.<a href="#fnref2">↩</a></li>
<li id="fn3"><a href="#fnref3">↩</a></li>
<li id="fn4"></li>
<li id="fn5"></li>
<li id="fn6"></li>
<li id="fn7">.<a href="#fnref7">↩</a></li>
<li id="fn8">This follows immediately from Theorem 1 of  together with the observation that the identity permutation has one rising sequence and all other riffle permutations have exactly two rising sequences.<a href="#fnref8">↩</a></li>
<li id="fn9"> instead states erroneously that all permutations are likely.<a href="#fnref9">↩</a></li>
<li id="fn10"></li>
<li id="fn11">.<a href="#fnref11">↩</a></li>
<li id="fn12">.<a href="#fnref12">↩</a></li>
<li id="fn13">.<a href="#fnref13">↩</a></li>
<li id="fn14">.<a href="#fnref14">↩</a></li>
<li id="fn15">.<a href="#fnref15">↩</a></li>
</ol>
</section>
</body>
</html>

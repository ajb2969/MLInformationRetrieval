<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="284">Thomae's function</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Thomae's function</h1>
<hr/>

<p> <strong>Thomae's function</strong>, named after <a href="Carl_Johannes_Thomae" title="wikilink">Carl Johannes Thomae</a>, has many names: the <strong>popcorn function</strong>, the <strong>raindrop function</strong>, the <strong>countable cloud function</strong>, the <strong>modified Dirichlet function</strong>, the <strong>ruler function</strong>,<a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a> the <strong>Riemann function</strong>, or the <strong>Stars over Babylon</strong> (<a href="John_Horton_Conway" title="wikilink">John Horton Conway</a>'s name).<a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a> This <a href="real_number" title="wikilink">real</a>-valued <a href="function_(mathematics)" title="wikilink">function</a> <em>f</em>(<em>x</em>) of the real variable <em>x</em> is defined as:</p>

<p>

<math display="block" id="Thomae's_function:0">
 <semantics>
  <mrow>
   <mrow>
    <mi>f</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>x</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mo>{</mo>
    <mtable displaystyle="true">
     <mtr>
      <mtd columnalign="left">
       <mstyle displaystyle="false">
        <mfrac>
         <mn>1</mn>
         <mi>q</mi>
        </mfrac>
       </mstyle>
      </mtd>
      <mtd columnalign="left">
       <mrow>
        <mrow>
         <mtext>if</mtext>
         <mi>x</mi>
         <mtext>is rational,</mtext>
         <mi>x</mi>
        </mrow>
        <mo>=</mo>
        <mrow>
         <mstyle displaystyle="false">
          <mfrac>
           <mi>p</mi>
           <mi>q</mi>
          </mfrac>
         </mstyle>
         <mtext>in lowest terms and</mtext>
         <mi>q</mi>
        </mrow>
        <mo>></mo>
        <mn>0</mn>
       </mrow>
      </mtd>
     </mtr>
     <mtr>
      <mtd columnalign="left">
       <mn>0</mn>
      </mtd>
      <mtd columnalign="left">
       <mrow>
        <mtext>if</mtext>
        <mi>x</mi>
        <mtext>is irrational.</mtext>
       </mrow>
      </mtd>
     </mtr>
    </mtable>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>f</ci>
     <ci>x</ci>
    </apply>
    <apply>
     <csymbol cd="latexml">cases</csymbol>
     <apply>
      <divide></divide>
      <cn type="integer">1</cn>
      <ci>q</ci>
     </apply>
     <apply>
      <and></and>
      <apply>
       <eq></eq>
       <apply>
        <times></times>
        <mtext>if</mtext>
        <ci>x</ci>
        <mtext>is rational,</mtext>
        <ci>x</ci>
       </apply>
       <apply>
        <times></times>
        <apply>
         <divide></divide>
         <ci>p</ci>
         <ci>q</ci>
        </apply>
        <mtext>in lowest terms and</mtext>
        <ci>q</ci>
       </apply>
      </apply>
      <apply>
       <gt></gt>
       <share href="#.cmml">
       </share>
       <cn type="integer">0</cn>
      </apply>
     </apply>
     <cn type="integer">0</cn>
     <apply>
      <times></times>
      <mtext>if</mtext>
      <ci>x</ci>
      <mtext>is irrational.</mtext>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f(x)=\begin{cases}\frac{1}{q}&\text{if }x\text{ is rational, }x=\tfrac{p}{q}%
\text{ in lowest terms and }q>0\\
0&\text{if }x\text{ is irrational.}\end{cases}
  </annotation>
 </semantics>
</math>

</p>

<p>It is a modification of the <a href="Dirichlet_function" title="wikilink">Dirichlet function</a>, which is 1 at rational numbers and 0 elsewhere.</p>
<h2 id="properties">Properties</h2>

<p>The popcorn function has a complicated set of <a href="continuous_function" title="wikilink">discontinuities</a>: <em>f</em> is continuous at all irrational numbers and discontinuous at all rational numbers.</p>

<p>The popcorn function also has a strict local <a href="maxima_and_minima" title="wikilink">maximum</a> at each rational number.</p>
<h3 id="informal-proof-of-discontinuities">Informal proof of discontinuities</h3>

<p>Clearly, <em>f</em> is discontinuous at all rational numbers: since the irrationals are <a href="dense_set" title="wikilink">dense</a> in the reals, for any rational <em>x</em>, no matter what <em>ε</em> we select, there is an irrational <em>a</em> even nearer to our <em>x</em> where <em>f</em>(<em>a</em>) = 0 (while <em>f</em>(<em>x</em>) is positive). In other words, <em>f</em> can never "get close" and "stay close" to any positive number because its domain is dense with zeroes.</p>

<p>To show continuity at the irrationals, assume without loss of generality that our <em>ε</em> is rational (for any irrational <em>ε′</em>, we can choose a smaller rational <em>ε″</em> and the proof is transitive). Since ε is rational, it can be expressed in lowest terms as <em>a/b</em>. We want to show that <em>f</em>(<em>x</em>) is continuous when <em>x</em> is irrational.</p>

<p>Note that <em>f</em> takes a maximum value of 1 at each whole integer, so we may limit our examination to the space between 

<math display="inline" id="Thomae's_function:1">
 <semantics>
  <mrow>
   <mo stretchy="false">⌊</mo>
   <mi>x</mi>
   <mo stretchy="false">⌋</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <floor></floor>
    <ci>x</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \scriptstyle\lfloor x\rfloor
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Thomae's_function:2">
 <semantics>
  <mrow>
   <mo stretchy="false">⌈</mo>
   <mi>x</mi>
   <mo stretchy="false">⌉</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ceiling></ceiling>
    <ci>x</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \scriptstyle\lceil x\rceil
  </annotation>
 </semantics>
</math>

. Since <em>ε</em> has a finite denominator of <em>b</em>, the only values for which <em>f</em> may return a value greater than <em>ε</em> are those with a reduced denominator <em>no larger than b</em>. There exist only a finite number of values between two integers with denominator no larger than <em>b</em>, so these can be exhaustively listed. Setting <em>δ</em> to be smaller than the nearest distance from <em>x</em> to one of these values guarantees every value within <em>δ</em> of <em>x</em> has <em>f</em>(<em>x</em>) Spivak, M. (p. 53, Theorem 3-8) Since the set of all discontinuities is the rational numbers, and the rational numbers are <a href="Countability" title="wikilink">countable</a>, the set has measure zero. As well, the function is bounded on the interval , so by the Lebesgue criterion, the function is Riemann integrable on . Its integral is equal to 0 over .</p>
<h2 id="follow-up">Follow-up</h2>

<p>A natural follow-up question one might ask is if there is a function which is continuous on the rational numbers and discontinuous on the irrational numbers. This turns out to be impossible; the set of discontinuities of any function must be an <a href="Fσ_set" title="wikilink">F<sub>σ</sub> set</a>. If such a function existed, then the irrationals would be an F<sub>σ</sub> set and hence, as they don't contain an interval, would also be a <a href="meager_set" title="wikilink">meager set</a>. It would follow that the real numbers, being a union of the irrationals and the rationals (which is evidently meager), would also be a meager set. This would contradict the <a href="Baire_category_theorem" title="wikilink">Baire category theorem</a>.</p>

<p>A variant of the popcorn function can be used to show that any F<sub>σ</sub> subset of the real numbers can be the set of discontinuities of a function. If 

<math display="inline" id="Thomae's_function:3">
 <semantics>
  <mrow>
   <mpadded width="+2.8pt">
    <mi>A</mi>
   </mpadded>
   <mo rspace="5.3pt">=</mo>
   <mrow>
    <msubsup>
     <mo largeop="true" mathsize="160%" stretchy="false" symmetric="true">⋃</mo>
     <mrow>
      <mi>n</mi>
      <mo>=</mo>
      <mn>1</mn>
     </mrow>
     <mi mathvariant="normal">∞</mi>
    </msubsup>
    <msub>
     <mi>F</mi>
     <mi>n</mi>
    </msub>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>A</ci>
    <apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <union></union>
       <apply>
        <eq></eq>
        <ci>n</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <infinity></infinity>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>F</ci>
      <ci>n</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \scriptstyle A\;=\;\bigcup_{n=1}^{\infty}F_{n}
  </annotation>
 </semantics>
</math>

 is a countable union of closed sets 

<math display="inline" id="Thomae's_function:4">
 <semantics>
  <msub>
   <mi>F</mi>
   <mi>n</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>F</ci>
    <ci>n</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \scriptstyle F_{n}
  </annotation>
 </semantics>
</math>

, define</p>

<p>

<math display="block" id="Thomae's_function:5">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>f</mi>
     <mi>A</mi>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>x</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mo>{</mo>
    <mtable displaystyle="true">
     <mtr>
      <mtd columnalign="left">
       <mstyle displaystyle="false">
        <mfrac>
         <mn>1</mn>
         <mi>n</mi>
        </mfrac>
       </mstyle>
      </mtd>
      <mtd columnalign="left">
       <mrow>
        <mrow>
         <mtext>if</mtext>
         <mi>x</mi>
         <mtext>is rational and</mtext>
         <mi>n</mi>
         <mtext>is minimal so that</mtext>
         <mi>x</mi>
        </mrow>
        <mo>∈</mo>
        <msub>
         <mi>F</mi>
         <mi>n</mi>
        </msub>
       </mrow>
      </mtd>
     </mtr>
     <mtr>
      <mtd columnalign="left">
       <mrow>
        <mo>-</mo>
        <mstyle displaystyle="false">
         <mfrac>
          <mn>1</mn>
          <mi>n</mi>
         </mfrac>
        </mstyle>
       </mrow>
      </mtd>
      <mtd columnalign="left">
       <mrow>
        <mrow>
         <mtext>if</mtext>
         <mi>x</mi>
         <mtext>is irrational and</mtext>
         <mi>n</mi>
         <mtext>is minimal so that</mtext>
         <mi>x</mi>
        </mrow>
        <mo>∈</mo>
        <msub>
         <mi>F</mi>
         <mi>n</mi>
        </msub>
       </mrow>
      </mtd>
     </mtr>
     <mtr>
      <mtd columnalign="left">
       <mn>0</mn>
      </mtd>
      <mtd columnalign="left">
       <mrow>
        <mrow>
         <mtext>if</mtext>
         <mi>x</mi>
        </mrow>
        <mo>∉</mo>
        <mi>A</mi>
       </mrow>
      </mtd>
     </mtr>
    </mtable>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>f</ci>
      <ci>A</ci>
     </apply>
     <ci>x</ci>
    </apply>
    <apply>
     <csymbol cd="latexml">cases</csymbol>
     <apply>
      <divide></divide>
      <cn type="integer">1</cn>
      <ci>n</ci>
     </apply>
     <apply>
      <in></in>
      <apply>
       <times></times>
       <mtext>if</mtext>
       <ci>x</ci>
       <mtext>is rational and</mtext>
       <ci>n</ci>
       <mtext>is minimal so that</mtext>
       <ci>x</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>F</ci>
       <ci>n</ci>
      </apply>
     </apply>
     <apply>
      <minus></minus>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <ci>n</ci>
      </apply>
     </apply>
     <apply>
      <in></in>
      <apply>
       <times></times>
       <mtext>if</mtext>
       <ci>x</ci>
       <mtext>is irrational and</mtext>
       <ci>n</ci>
       <mtext>is minimal so that</mtext>
       <ci>x</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>F</ci>
       <ci>n</ci>
      </apply>
     </apply>
     <cn type="integer">0</cn>
     <apply>
      <notin></notin>
      <apply>
       <times></times>
       <mtext>if</mtext>
       <ci>x</ci>
      </apply>
      <ci>A</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f_{A}(x)=\begin{cases}\frac{1}{n}&\text{if }x\text{ is rational and }n\text{ %
is minimal so that }x\in F_{n}\\
-\frac{1}{n}&\text{if }x\text{ is irrational and }n\text{ is minimal so that }%
x\in F_{n}\\
0&\text{if }x\notin A\end{cases}
  </annotation>
 </semantics>
</math>

</p>

<p>Then a similar argument as for the popcorn function shows that 

<math display="inline" id="Thomae's_function:6">
 <semantics>
  <msub>
   <mi>f</mi>
   <mi>A</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>f</ci>
    <ci>A</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \scriptstyle f_{A}
  </annotation>
 </semantics>
</math>

 has <em>A</em> as its set of discontinuities.</p>

<p>For a general construction on arbitrary metric space, see this article <a href="ftp://softbank.iust.ac.ir/MathBooks/American%20Mathematical%20Monthly/106/3-march/9.pdf">Kim, Sung Soo. "A Characterization of the Set of Points of Continuity of a Real Function." American Mathematical Monthly 106.3 (1999): 258-259.</a></p>
<h2 id="related-probability-distributions">Related probability distributions</h2>

<p>Empirical probability distributions related to Thomae's function appear in <a href="DNA_sequencing" title="wikilink">DNA sequencing</a>.<a class="footnoteRef" href="#fn3" id="fnref3"><sup>3</sup></a> The human genome is <a class="uri" href="diploid" title="wikilink">diploid</a>, having two strands per chromosome. When sequenced, small pieces ("reads") are generated: for each spot on the genome, an integer number of reads overlap with it. Their ratio is a rational number, and typically distributed similar to Thomae's function.</p>

<p>If pairs of positive integers 

<math display="inline" id="Thomae's_function:7">
 <semantics>
  <mrow>
   <mi>m</mi>
   <mo>,</mo>
   <mi>n</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <list>
    <ci>m</ci>
    <ci>n</ci>
   </list>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   m,n
  </annotation>
 </semantics>
</math>

 are sampled from a distribution 

<math display="inline" id="Thomae's_function:8">
 <semantics>
  <mrow>
   <mi>f</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>n</mi>
    <mo>,</mo>
    <mi>m</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>f</ci>
    <interval closure="open">
     <ci>n</ci>
     <ci>m</ci>
    </interval>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f(n,m)
  </annotation>
 </semantics>
</math>

 and used to generate ratios 

<math display="inline" id="Thomae's_function:9">
 <semantics>
  <mrow>
   <mi>q</mi>
   <mo>=</mo>
   <mrow>
    <mi>n</mi>
    <mo>/</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>n</mi>
      <mo>+</mo>
      <mi>m</mi>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>q</ci>
    <apply>
     <divide></divide>
     <ci>n</ci>
     <apply>
      <plus></plus>
      <ci>n</ci>
      <ci>m</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   q=n/(n+m)
  </annotation>
 </semantics>
</math>

, this gives rise to a distribution 

<math display="inline" id="Thomae's_function:10">
 <semantics>
  <mrow>
   <mi>g</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>q</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>g</ci>
    <ci>q</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   g(q)
  </annotation>
 </semantics>
</math>


 on the rational numbers. If the integers are independent the distribution can be viewed as a <a class="uri" href="convolution" title="wikilink">convolution</a> over the rational numbers, 

<math display="inline" id="Thomae's_function:11">
 <semantics>
  <mrow>
   <mrow>
    <mi>g</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>a</mi>
      <mo>/</mo>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mi>a</mi>
        <mo>+</mo>
        <mi>b</mi>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <msubsup>
     <mo largeop="true" symmetric="true">∑</mo>
     <mrow>
      <mi>t</mi>
      <mo>=</mo>
      <mn>1</mn>
     </mrow>
     <mi mathvariant="normal">∞</mi>
    </msubsup>
    <mrow>
     <mi>f</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mi>t</mi>
       <mi>a</mi>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <mi>f</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mi>t</mi>
       <mi>b</mi>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>g</ci>
     <apply>
      <divide></divide>
      <ci>a</ci>
      <apply>
       <plus></plus>
       <ci>a</ci>
       <ci>b</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <apply>
        <eq></eq>
        <ci>t</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <infinity></infinity>
     </apply>
     <apply>
      <times></times>
      <ci>f</ci>
      <apply>
       <times></times>
       <ci>t</ci>
       <ci>a</ci>
      </apply>
      <ci>f</ci>
      <apply>
       <times></times>
       <ci>t</ci>
       <ci>b</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   g(a/(a+b))=\sum_{t=1}^{\infty}f(ta)f(tb)
  </annotation>
 </semantics>
</math>

. Closed form solutions exist for <a class="uri" href="power-law" title="wikilink">power-law</a> distributions with a cut-off. If 

<math display="inline" id="Thomae's_function:12">
 <semantics>
  <mrow>
   <mrow>
    <mi>f</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>k</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mrow>
      <msup>
       <mi>k</mi>
       <mrow>
        <mo>-</mo>
        <mi>α</mi>
       </mrow>
      </msup>
      <msup>
       <mi>e</mi>
       <mrow>
        <mo>-</mo>
        <mrow>
         <mi>β</mi>
         <mi>k</mi>
        </mrow>
       </mrow>
      </msup>
     </mrow>
     <mo>/</mo>
     <msub>
      <mi>Li</mi>
      <mi>α</mi>
     </msub>
    </mrow>
    <mrow>
     <mo stretchy="false">(</mo>
     <msup>
      <mi>e</mi>
      <mrow>
       <mo>-</mo>
       <mi>β</mi>
      </mrow>
     </msup>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>f</ci>
     <ci>k</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <divide></divide>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>k</ci>
        <apply>
         <minus></minus>
         <ci>α</ci>
        </apply>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>e</ci>
        <apply>
         <minus></minus>
         <apply>
          <times></times>
          <ci>β</ci>
          <ci>k</ci>
         </apply>
        </apply>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>Li</ci>
       <ci>α</ci>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>e</ci>
      <apply>
       <minus></minus>
       <ci>β</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f(k)=k^{-\alpha}e^{-\beta k}/\mathrm{Li}_{\alpha}(e^{-\beta})
  </annotation>
 </semantics>
</math>

 (where 

<math display="inline" id="Thomae's_function:13">
 <semantics>
  <msub>
   <mi>Li</mi>
   <mi>α</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>Li</ci>
    <ci>α</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathrm{Li}_{\alpha}
  </annotation>
 </semantics>
</math>

 is the <a class="uri" href="polylogarithm" title="wikilink">polylogarithm</a> function) then 

<math display="inline" id="Thomae's_function:14">
 <semantics>
  <mrow>
   <mrow>
    <mi>g</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>a</mi>
      <mo>/</mo>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mi>a</mi>
        <mo>+</mo>
        <mi>b</mi>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mrow>
      <msup>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mi>a</mi>
         <mi>b</mi>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
       <mrow>
        <mo>-</mo>
        <mi>α</mi>
       </mrow>
      </msup>
      <msub>
       <mi>Li</mi>
       <mrow>
        <mn>2</mn>
        <mi>α</mi>
       </mrow>
      </msub>
      <mrow>
       <mo stretchy="false">(</mo>
       <msup>
        <mi>e</mi>
        <mrow>
         <mo>-</mo>
         <mrow>
          <mrow>
           <mo stretchy="false">(</mo>
           <mrow>
            <mi>a</mi>
            <mo>+</mo>
            <mi>b</mi>
           </mrow>
           <mo stretchy="false">)</mo>
          </mrow>
          <mi>β</mi>
         </mrow>
        </mrow>
       </msup>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo>/</mo>
     <msubsup>
      <mi>Li</mi>
      <mi>α</mi>
      <mn>2</mn>
     </msubsup>
    </mrow>
    <mrow>
     <mo stretchy="false">(</mo>
     <msup>
      <mi>e</mi>
      <mrow>
       <mo>-</mo>
       <mi>β</mi>
      </mrow>
     </msup>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>g</ci>
     <apply>
      <divide></divide>
      <ci>a</ci>
      <apply>
       <plus></plus>
       <ci>a</ci>
       <ci>b</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <divide></divide>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <times></times>
         <ci>a</ci>
         <ci>b</ci>
        </apply>
        <apply>
         <minus></minus>
         <ci>α</ci>
        </apply>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>Li</ci>
        <apply>
         <times></times>
         <cn type="integer">2</cn>
         <ci>α</ci>
        </apply>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>e</ci>
        <apply>
         <minus></minus>
         <apply>
          <times></times>
          <apply>
           <plus></plus>
           <ci>a</ci>
           <ci>b</ci>
          </apply>
          <ci>β</ci>
         </apply>
        </apply>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>Li</ci>
        <cn type="integer">2</cn>
       </apply>
       <ci>α</ci>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>e</ci>
      <apply>
       <minus></minus>
       <ci>β</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   g(a/(a+b))=(ab)^{-\alpha}\mathrm{Li}_{2\alpha}(e^{-(a+b)\beta})/\mathrm{Li}^{2%
}_{\alpha}(e^{-\beta})
  </annotation>
 </semantics>
</math>

. In the case of uniform distributions on the set 

<math display="inline" id="Thomae's_function:15">
 <semantics>
  <mrow>
   <mo stretchy="false">{</mo>
   <mn>1</mn>
   <mo>,</mo>
   <mn>2</mn>
   <mo>,</mo>
   <mi mathvariant="normal">…</mi>
   <mo>,</mo>
   <mi>L</mi>
   <mo stretchy="false">}</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <set>
    <cn type="integer">1</cn>
    <cn type="integer">2</cn>
    <ci>normal-…</ci>
    <ci>L</ci>
   </set>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \{1,2,\ldots,L\}
  </annotation>
 </semantics>
</math>


 

<math display="inline" id="Thomae's_function:16">
 <semantics>
  <mrow>
   <mrow>
    <mi>g</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>a</mi>
      <mo>/</mo>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mi>a</mi>
        <mo>+</mo>
        <mi>b</mi>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mn>1</mn>
      <mo>/</mo>
      <msup>
       <mi>L</mi>
       <mn>2</mn>
      </msup>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
    <mrow>
     <mo stretchy="false">⌊</mo>
     <mrow>
      <mi>L</mi>
      <mo>/</mo>
      <mrow>
       <mi>max</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>a</mi>
        <mo>,</mo>
        <mi>b</mi>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
     </mrow>
     <mo stretchy="false">⌋</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>g</ci>
     <apply>
      <divide></divide>
      <ci>a</ci>
      <apply>
       <plus></plus>
       <ci>a</ci>
       <ci>b</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <divide></divide>
      <cn type="integer">1</cn>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>L</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
     <apply>
      <floor></floor>
      <apply>
       <divide></divide>
       <ci>L</ci>
       <apply>
        <max></max>
        <ci>a</ci>
        <ci>b</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   g(a/(a+b))=(1/L^{2})\lfloor L/\max(a,b)\rfloor
  </annotation>
 </semantics>
</math>

, which is very similar to Thomae's function. Both their graphs have <a href="fractal_dimension" title="wikilink">fractal dimension</a> 3/2.<a class="footnoteRef" href="#fn4" id="fnref4"><sup>4</sup></a></p>
<h2 id="see-also">See also</h2>
<ul>
<li><a href="Euclid's_orchard" title="wikilink">Euclid's orchard</a> – Thomae's function can be interpreted as a perspective drawing of Euclid's orchard</li>
</ul>
<h2 id="notes">Notes</h2>
<h2 id="references">References</h2>
<ul>
<li>Robert G. Bartle and Donald R. Sherbert (1999), <em>Introduction to Real Analysis, 3rd Edition</em> (Example 5.1.6 (h)). Wiley. ISBN 978-0-471-32148-4</li>
<li><a href="Michael_Spivak" title="wikilink">Spivak, M.</a> Calculus on manifolds. 1965. Perseus Books. ISBN 0-8053-9021-9</li>
<li>Abbot, Stephen. <em>Understanding Analysis</em>. Berlin: <a href="Springer_Science+Business_Media" title="wikilink">Springer</a>, 2001. ISBN 0-387-95060-5</li>
</ul>
<h2 id="external-links">External links</h2>
<ul>
<li></li>
<li></li>
</ul>

<p>"</p>

<p><a class="uri" href="Category:Calculus" title="wikilink">Category:Calculus</a> <a href="Category:General_topology" title="wikilink">Category:General topology</a> <a href="Category:Special_functions" title="wikilink">Category:Special functions</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1">"…the so-called <em>ruler function</em>, a simple but provocative example that appeared in a work of Johannes Karl Thomae … The graph suggests the vertical markings on a ruler—hence the name." William Dunham, <em>The Calculus Gallery</em>, chapter 10<a href="#fnref1">↩</a></li>
<li id="fn2"><a class="uri" href="http://mathforum.org/kb/message.jspa?messageID=1375516">http://mathforum.org/kb/message.jspa?messageID=1375516</a><a href="#fnref2">↩</a></li>
<li id="fn3">Vladimir Trifonov, Laura Pasqualucci, Riccardo Dalla-Favera &amp; Raul Rabadan. Fractal-like Distributions over the Rational Numbers in High-throughput Biological and Clinical Data. Scientific Reports 1:191 DOI: 10.1038/srep00191<a href="#fnref3">↩</a></li>
<li id="fn4"></li>
</ol>
</section>
</body>
</html>

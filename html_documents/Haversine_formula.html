<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="1802">Haversine formula</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Haversine formula</h1>
<hr/>

<p>The <strong>haversine formula</strong> is an equation important in <a class="uri" href="navigation" title="wikilink">navigation</a>, giving <a href="great-circle_distance" title="wikilink">great-circle distances</a> between two points on a <a class="uri" href="sphere" title="wikilink">sphere</a> from their <a href="longitude" title="wikilink">longitudes</a> and <a href="latitude" title="wikilink">latitudes</a>. It is a special case of a more general formula in <a href="spherical_trigonometry" title="wikilink">spherical trigonometry</a>, the <strong>law of haversines</strong>, relating the sides and angles of spherical triangles. The first table of haversines in English was published by James Andrew in 1805.<a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a> Florian Cajori credits an earlier use by <a href="Jose_de_Mendoza_y_Ríos" title="wikilink">Jose de Mendoza y Ríos</a> in 1801<a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a> The term <em>haversine</em> was coined in 1835 by Prof. <a href="James_Inman" title="wikilink">James Inman</a>.<a class="footnoteRef" href="#fn3" id="fnref3"><sup>3</sup></a></p>

<p>These names follow from the fact that they are customarily written in terms of the <a href="versine" title="wikilink">haversine</a> function, given by haversin(θ) = sin<sup>2</sup>(θ/2). The formulas could equally be written in terms of any multiple of the haversine, such as the older <a class="uri" href="versine" title="wikilink">versine</a> function (twice the haversine). Prior to the advent of computers, the elimination of division and multiplication by factors of two proved convenient enough that tables of haversine values and <a href="logarithm" title="wikilink">logarithms</a> were included in 19th and early 20th century navigation and trigonometric texts.<a class="footnoteRef" href="#fn4" id="fnref4"><sup>4</sup></a><a class="footnoteRef" href="#fn5" id="fnref5"><sup>5</sup></a><a class="footnoteRef" href="#fn6" id="fnref6"><sup>6</sup></a> These days, the haversine form is also convenient in that it has no coefficient in front of the sin<sup>2</sup> function.</p>
<h2 id="the-haversine-formula">The haversine formula</h2>

<p>For any two points on a sphere, the haversine of the <a href="central_angle" title="wikilink">central angle</a> between them is given by</p>

<p>

<math display="block" id="Haversine_formula:0">
 <semantics>
  <mrow>
   <mrow>
    <mo>haversin</mo>
    <mrow>
     <mo>(</mo>
     <mfrac>
      <mi>d</mi>
      <mi>r</mi>
     </mfrac>
     <mo>)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mo>haversin</mo>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <msub>
        <mi>ϕ</mi>
        <mn>2</mn>
       </msub>
       <mo>-</mo>
       <msub>
        <mi>ϕ</mi>
        <mn>1</mn>
       </msub>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>+</mo>
    <mrow>
     <mrow>
      <mi>cos</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <msub>
        <mi>ϕ</mi>
        <mn>1</mn>
       </msub>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mrow>
      <mi>cos</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <msub>
        <mi>ϕ</mi>
        <mn>2</mn>
       </msub>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mrow>
      <mo>haversin</mo>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <msub>
         <mi>λ</mi>
         <mn>2</mn>
        </msub>
        <mo>-</mo>
        <msub>
         <mi>λ</mi>
         <mn>1</mn>
        </msub>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <ci>haversin</ci>
     <apply>
      <divide></divide>
      <ci>d</ci>
      <ci>r</ci>
     </apply>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <ci>haversin</ci>
      <apply>
       <minus></minus>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>ϕ</ci>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>ϕ</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <cos></cos>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>ϕ</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <apply>
       <cos></cos>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>ϕ</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
      <apply>
       <ci>haversin</ci>
       <apply>
        <minus></minus>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>λ</ci>
         <cn type="integer">2</cn>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>λ</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \operatorname{haversin}\left(\frac{d}{r}\right)=\operatorname{haversin}(\phi_{%
2}-\phi_{1})+\cos(\phi_{1})\cos(\phi_{2})\operatorname{haversin}(\lambda_{2}-%
\lambda_{1})
  </annotation>
 </semantics>
</math>

 where</p>
<ul>
<li><em>haversin</em> is the <a class="uri" href="haversine" title="wikilink">haversine</a> function:</li>
</ul>

<p>

<math display="block" id="Haversine_formula:1">
 <semantics>
  <mrow>
   <mrow>
    <mo>haversin</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>θ</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <msup>
     <mi>sin</mi>
     <mn>2</mn>
    </msup>
    <mrow>
     <mo>(</mo>
     <mfrac>
      <mi>θ</mi>
      <mn>2</mn>
     </mfrac>
     <mo>)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mfrac>
    <mrow>
     <mn>1</mn>
     <mo>-</mo>
     <mrow>
      <mi>cos</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>θ</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mrow>
    <mn>2</mn>
   </mfrac>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <ci>haversin</ci>
      <ci>θ</ci>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <sin></sin>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <divide></divide>
       <ci>θ</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <divide></divide>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
       <apply>
        <cos></cos>
        <ci>θ</ci>
       </apply>
      </apply>
      <cn type="integer">2</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \operatorname{haversin}(\theta)=\sin^{2}\left(\frac{\theta}{2}\right)=\frac{1-%
\cos(\theta)}{2}
  </annotation>
 </semantics>
</math>

</p>
<ul>
<li><em>d</em> is the distance between the two points (along a <a href="great_circle" title="wikilink">great circle</a> of the sphere; see <a href="Great-circle_distance" title="wikilink">spherical distance</a>),</li>
<li><em>r</em> is the radius of the sphere,</li>
<li>

<math display="inline" id="Haversine_formula:2">
 <semantics>
  <mrow>
   <msub>
    <mi>ϕ</mi>
    <mn>1</mn>
   </msub>
   <mo>,</mo>
   <msub>
    <mi>ϕ</mi>
    <mn>2</mn>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <list>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>ϕ</ci>
     <cn type="integer">1</cn>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>ϕ</ci>
     <cn type="integer">2</cn>
    </apply>
   </list>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \phi_{1},\phi_{2}
  </annotation>
 </semantics>
</math>

: latitude of point 1 and latitude of point 2</li>
<li>

<math display="inline" id="Haversine_formula:3">
 <semantics>
  <mrow>
   <msub>
    <mi>λ</mi>
    <mn>1</mn>
   </msub>
   <mo>,</mo>
   <msub>
    <mi>λ</mi>
    <mn>2</mn>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <list>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>λ</ci>
     <cn type="integer">1</cn>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>λ</ci>
     <cn type="integer">2</cn>
    </apply>
   </list>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \lambda_{1},\lambda_{2}
  </annotation>
 </semantics>
</math>

: longitude of point 1 and longitude of point 2</li>
</ul>

<p>On the left side of the equals sign d/r is the central angle, assuming angles are measured in <a href="radian" title="wikilink">radians</a> (note that φ and λ can be converted from degrees to radians by multiplying by π/180 as usual).</p>

<p>Solve for <em>d</em> by applying the inverse haversine (if available) or by using the <a class="uri" href="arcsine" title="wikilink">arcsine</a> (inverse sine) function:</p>

<p>

<math display="block" id="Haversine_formula:4">
 <semantics>
  <mrow>
   <mi>d</mi>
   <mo>=</mo>
   <mrow>
    <mi>r</mi>
    <mrow>
     <msup>
      <mo>haversin</mo>
      <mrow>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
     </msup>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>h</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mn>2</mn>
    <mi>r</mi>
    <mrow>
     <mi>arcsin</mi>
     <mrow>
      <mo>(</mo>
      <msqrt>
       <mi>h</mi>
      </msqrt>
      <mo>)</mo>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <ci>d</ci>
     <apply>
      <times></times>
      <ci>r</ci>
      <apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>haversin</ci>
        <apply>
         <minus></minus>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <ci>h</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <cn type="integer">2</cn>
      <ci>r</ci>
      <apply>
       <arcsin></arcsin>
       <apply>
        <root></root>
        <ci>h</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   d=r\operatorname{haversin}^{-1}(h)=2r\arcsin\left(\sqrt{h}\right)
  </annotation>
 </semantics>
</math>

 where <em>h</em> is haversin(<em>d</em>/<em>r</em>), or more explicitly:</p>

<p>

<math display="block" id="Haversine_formula:5">
 <semantics>
  <mrow>
   <mi>d</mi>
   <mo>=</mo>
   <mrow>
    <mn>2</mn>
    <mi>r</mi>
    <mrow>
     <mi>arcsin</mi>
     <mrow>
      <mo>(</mo>
      <msqrt>
       <mrow>
        <mrow>
         <mo>haversin</mo>
         <mrow>
          <mo stretchy="false">(</mo>
          <mrow>
           <msub>
            <mi>ϕ</mi>
            <mn>2</mn>
           </msub>
           <mo>-</mo>
           <msub>
            <mi>ϕ</mi>
            <mn>1</mn>
           </msub>
          </mrow>
          <mo stretchy="false">)</mo>
         </mrow>
        </mrow>
        <mo>+</mo>
        <mrow>
         <mrow>
          <mi>cos</mi>
          <mrow>
           <mo stretchy="false">(</mo>
           <msub>
            <mi>ϕ</mi>
            <mn>1</mn>
           </msub>
           <mo stretchy="false">)</mo>
          </mrow>
         </mrow>
         <mrow>
          <mi>cos</mi>
          <mrow>
           <mo stretchy="false">(</mo>
           <msub>
            <mi>ϕ</mi>
            <mn>2</mn>
           </msub>
           <mo stretchy="false">)</mo>
          </mrow>
         </mrow>
         <mrow>
          <mo>haversin</mo>
          <mrow>
           <mo stretchy="false">(</mo>
           <mrow>
            <msub>
             <mi>λ</mi>
             <mn>2</mn>
            </msub>
            <mo>-</mo>
            <msub>
             <mi>λ</mi>
             <mn>1</mn>
            </msub>
           </mrow>
           <mo stretchy="false">)</mo>
          </mrow>
         </mrow>
        </mrow>
       </mrow>
      </msqrt>
      <mo>)</mo>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>d</ci>
    <apply>
     <times></times>
     <cn type="integer">2</cn>
     <ci>r</ci>
     <apply>
      <arcsin></arcsin>
      <apply>
       <root></root>
       <apply>
        <plus></plus>
        <apply>
         <ci>haversin</ci>
         <apply>
          <minus></minus>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>ϕ</ci>
           <cn type="integer">2</cn>
          </apply>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>ϕ</ci>
           <cn type="integer">1</cn>
          </apply>
         </apply>
        </apply>
        <apply>
         <times></times>
         <apply>
          <cos></cos>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>ϕ</ci>
           <cn type="integer">1</cn>
          </apply>
         </apply>
         <apply>
          <cos></cos>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>ϕ</ci>
           <cn type="integer">2</cn>
          </apply>
         </apply>
         <apply>
          <ci>haversin</ci>
          <apply>
           <minus></minus>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <ci>λ</ci>
            <cn type="integer">2</cn>
           </apply>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <ci>λ</ci>
            <cn type="integer">1</cn>
           </apply>
          </apply>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   d=2r\arcsin\left(\sqrt{\operatorname{haversin}(\phi_{2}-\phi_{1})+\cos(\phi_{1%
})\cos(\phi_{2})\operatorname{haversin}(\lambda_{2}-\lambda_{1})}\right)
  </annotation>
 </semantics>
</math>

</p>
<dl>
<dd><dl>
<dd>

<math display="inline" id="Haversine_formula:6">
 <semantics>
  <mrow>
   <mi></mi>
   <mo>=</mo>
   <mrow>
    <mn>2</mn>
    <mi>r</mi>
    <mrow>
     <mi>arcsin</mi>
     <mrow>
      <mo>(</mo>
      <msqrt>
       <mrow>
        <mrow>
         <msup>
          <mi>sin</mi>
          <mn>2</mn>
         </msup>
         <mrow>
          <mo>(</mo>
          <mfrac>
           <mrow>
            <msub>
             <mi>ϕ</mi>
             <mn>2</mn>
            </msub>
            <mo>-</mo>
            <msub>
             <mi>ϕ</mi>
             <mn>1</mn>
            </msub>
           </mrow>
           <mn>2</mn>
          </mfrac>
          <mo>)</mo>
         </mrow>
        </mrow>
        <mo>+</mo>
        <mrow>
         <mrow>
          <mi>cos</mi>
          <mrow>
           <mo stretchy="false">(</mo>
           <msub>
            <mi>ϕ</mi>
            <mn>1</mn>
           </msub>
           <mo stretchy="false">)</mo>
          </mrow>
         </mrow>
         <mrow>
          <mi>cos</mi>
          <mrow>
           <mo stretchy="false">(</mo>
           <msub>
            <mi>ϕ</mi>
            <mn>2</mn>
           </msub>
           <mo stretchy="false">)</mo>
          </mrow>
         </mrow>
         <mrow>
          <msup>
           <mi>sin</mi>
           <mn>2</mn>
          </msup>
          <mrow>
           <mo>(</mo>
           <mfrac>
            <mrow>
             <msub>
              <mi>λ</mi>
              <mn>2</mn>
             </msub>
             <mo>-</mo>
             <msub>
              <mi>λ</mi>
              <mn>1</mn>
             </msub>
            </mrow>
            <mn>2</mn>
           </mfrac>
           <mo>)</mo>
          </mrow>
         </mrow>
        </mrow>
       </mrow>
      </msqrt>
      <mo>)</mo>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <csymbol cd="latexml">absent</csymbol>
    <apply>
     <times></times>
     <cn type="integer">2</cn>
     <ci>r</ci>
     <apply>
      <arcsin></arcsin>
      <apply>
       <root></root>
       <apply>
        <plus></plus>
        <apply>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <sin></sin>
          <cn type="integer">2</cn>
         </apply>
         <apply>
          <divide></divide>
          <apply>
           <minus></minus>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <ci>ϕ</ci>
            <cn type="integer">2</cn>
           </apply>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <ci>ϕ</ci>
            <cn type="integer">1</cn>
           </apply>
          </apply>
          <cn type="integer">2</cn>
         </apply>
        </apply>
        <apply>
         <times></times>
         <apply>
          <cos></cos>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>ϕ</ci>
           <cn type="integer">1</cn>
          </apply>
         </apply>
         <apply>
          <cos></cos>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>ϕ</ci>
           <cn type="integer">2</cn>
          </apply>
         </apply>
         <apply>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <sin></sin>
           <cn type="integer">2</cn>
          </apply>
          <apply>
           <divide></divide>
           <apply>
            <minus></minus>
            <apply>
             <csymbol cd="ambiguous">subscript</csymbol>
             <ci>λ</ci>
             <cn type="integer">2</cn>
            </apply>
            <apply>
             <csymbol cd="ambiguous">subscript</csymbol>
             <ci>λ</ci>
             <cn type="integer">1</cn>
            </apply>
           </apply>
           <cn type="integer">2</cn>
          </apply>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   =2r\arcsin\left(\sqrt{\sin^{2}\left(\frac{\phi_{2}-\phi_{1}}{2}\right)+\cos(%
\phi_{1})\cos(\phi_{2})\sin^{2}\left(\frac{\lambda_{2}-\lambda_{1}}{2}\right)}\right)
  </annotation>
 </semantics>
</math>


</dd>
</dl>
</dd>
</dl>

<p>When using these formulae, ensure that <em>h</em> does not exceed 1 due to a <a href="floating_point" title="wikilink">floating point</a> error (<em>d</em> is only <a href="real_number" title="wikilink">real</a> for <em>h</em> from 0 to 1). <em>h</em> only approaches 1 for <em>antipodal</em> points (on opposite sides of the sphere) — in this region, relatively large numerical errors tend to arise in the formula when finite precision is used. Because <em>d</em> is then large (approaching π<em>R</em>, half the circumference) a small error is often not a major concern in this unusual case (although there are other <a href="great-circle_distance" title="wikilink">great-circle distance</a> formulas that avoid this problem). (The formula above is sometimes written in terms of the <a class="uri" href="arctangent" title="wikilink">arctangent</a> function, but this suffers from similar numerical problems near <em>h</em> = 1.)</p>

<p>As described below, a similar formula can be written using cosines (sometimes called the <a href="spherical_law_of_cosines" title="wikilink">spherical law of cosines</a>, not to be confused with the <a href="law_of_cosines" title="wikilink">law of cosines</a> for plane geometry) instead of haversines, but if the two points are close together (e.g. a kilometer apart, on the Earth) you might end up with cos (d/R) = 0.99999999, leading to an inaccurate answer. Since the haversine formula uses sines it avoids that problem.</p>

<p>Either formula is only an approximation when applied to the <a class="uri" href="Earth" title="wikilink">Earth</a>, which is not a perfect sphere: the "<a href="Earth_radius" title="wikilink">Earth radius</a>" <em>R</em> varies from 6356.752 km at the poles to 6378.137 km at the equator. More importantly, the <a href="radius_of_curvature_(applications)" title="wikilink">radius of curvature</a> of a north-south line on the earth's surface is 1% greater at the poles (≈6399.594 km) than at the equator (≈6335.439 km)— so the haversine formula and law of cosines can't be guaranteed correct to better than <a href="http://www.movable-type.co.uk/scripts/latlong.html">0.5%</a>. More accurate methods that consider the Earth's ellipticity are given by <a href="Vincenty's_formulae" title="wikilink">Vincenty's formulae</a> and the other formulas in the <a href="geographical_distance" title="wikilink">geographical distance</a> article.</p>
<h2 id="the-law-of-haversines">The law of haversines</h2>

<p>Given a unit sphere, a "triangle" on the surface of the sphere is defined by the <a href="great_circle" title="wikilink">great circles</a> connecting three points <strong>u</strong>, <strong>v</strong>, and <strong>w</strong> on the sphere. If the lengths of these three sides are <em>a</em> (from <strong>u</strong> to <strong>v</strong>), <em>b</em> (from <strong>u</strong> to <strong>w</strong>), and <em>c</em> (from <strong>v</strong> to <strong>w</strong>), and the angle of the corner opposite <em>c</em> is <em>C</em>, then the law of haversines states:</p>
<div class="floatright">

<p><em>(the law of haversines)</em></p>
</div>

<p>

<math display="block" id="Haversine_formula:7">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mo>haversin</mo>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>c</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mo>haversin</mo>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mi>a</mi>
        <mo>-</mo>
        <mi>b</mi>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo>+</mo>
     <mrow>
      <mrow>
       <mi>sin</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>a</mi>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
      <mrow>
       <mi>sin</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>b</mi>
        <mo rspace="4.2pt" stretchy="false">)</mo>
       </mrow>
      </mrow>
      <mrow>
       <mo>haversin</mo>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>C</mi>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <ci>haversin</ci>
     <ci>c</ci>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <ci>haversin</ci>
      <apply>
       <minus></minus>
       <ci>a</ci>
       <ci>b</ci>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <sin></sin>
       <ci>a</ci>
      </apply>
      <apply>
       <sin></sin>
       <ci>b</ci>
      </apply>
      <apply>
       <ci>haversin</ci>
       <ci>C</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \operatorname{haversin}(c)=\operatorname{haversin}(a-b)+\sin(a)\sin(b)\,%
\operatorname{haversin}(C).
  </annotation>
 </semantics>
</math>

</p>

<p>Since this is a unit sphere, the lengths <em>a</em>, <em>b</em>, and <em>c</em> are simply equal to the angles (in <a href="radian" title="wikilink">radians</a>) subtended by those sides from the center of the sphere (for a non-unit sphere, each of these arc lengths is equal to its <a href="central_angle" title="wikilink">central angle</a> multiplied by the radius of the sphere). </p>

<p>In order to obtain the haversine formula of the previous section from this law, one simply considers the special case where <strong>u</strong> is the <a href="Geographic_North_Pole" title="wikilink">north pole</a>, while <strong>v</strong> and <strong>w</strong> are the two points whose separation <em>d</em> is to be determined. In that case, <em>a</em> and <em>b</em> are π/2 − φ<sub>1,2</sub> (i.e., 90° − latitude), <em>C</em> is the longitude separation Δλ, and <em>c</em> is the desired <em>d</em>/<em>R</em>. Noting that sin(<em>π</em>/2 − <em>φ</em>) = cos(<em>φ</em>), the haversine formula immediately follows.</p>

<p>To derive the law of haversines, one starts with the <a href="spherical_law_of_cosines" title="wikilink">spherical law of cosines</a>:</p>
<div class="floatright">

<p><em>(spherical law of cosines)</em></p>
</div>

<p>

<math display="block" id="Haversine_formula:8">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>cos</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>c</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mrow>
       <mi>cos</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>a</mi>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
      <mrow>
       <mi>cos</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>b</mi>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
     </mrow>
     <mo>+</mo>
     <mrow>
      <mrow>
       <mi>sin</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>a</mi>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
      <mrow>
       <mi>sin</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>b</mi>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
      <mrow>
       <mi>cos</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>C</mi>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <cos></cos>
     <ci>c</ci>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <apply>
       <cos></cos>
       <ci>a</ci>
      </apply>
      <apply>
       <cos></cos>
       <ci>b</ci>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <sin></sin>
       <ci>a</ci>
      </apply>
      <apply>
       <sin></sin>
       <ci>b</ci>
      </apply>
      <apply>
       <cos></cos>
       <ci>C</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \cos(c)=\cos(a)\cos(b)+\sin(a)\sin(b)\cos(C).\,
  </annotation>
 </semantics>
</math>

</p>

<p>As mentioned above, this formula is an ill-conditioned way of solving for <em>c</em> when <em>c</em> is small. Instead, we substitute the identity that cos(<em>θ</em>) = 1 − 2 haversin(<em>θ</em>), and also employ the <a href="trigonometric_identity#Addition/subtraction_theorems" title="wikilink">addition identity</a> cos(<em>a</em> − <em>b</em>) = cos(<em>a</em>) cos(<em>b</em>) + sin(<em>a</em>) sin(<em>b</em>), to obtain the law of haversines, above.</p>
<h2 id="references">References</h2>
<ul>
<li><a href="U._S._Census_Bureau" title="wikilink">U. S. Census Bureau</a> Geographic Information Systems FAQ, (content has been moved to <a href="http://www.movable-type.co.uk/scripts/GIS-FAQ-5.1.html">What is the best way to calculate the distance between 2 points?</a>)</li>
<li>R. W. Sinnott, "Virtues of the Haversine", <em>Sky and Telescope</em> <strong>68</strong> (2), 159 (1984).</li>
<li><a href="http://mathforum.org/library/drmath/view/51879.html">Deriving the haversine formula</a>, <em>Ask Dr. Math</em> (Apr. 20–21, 1999).</li>
<li>Romuald Ireneus 'Scibor-Marchocki, [<a class="uri" href="http://www.webcitation.org/query?url=http://www.geocities.com/ResearchTriangle/2363/trig02.html&amp;date">http://www.webcitation.org/query?url=http://www.geocities.com/ResearchTriangle/2363/trig02.html&amp;date;</a>;=2009-10-25+09:44:36 Spherical trigonometry], <em>Elementary-Geometry Trigonometry</em> web page (1997).</li>
<li>W. Gellert, S. Gottwald, M. Hellwich, H. Kästner, and H. Küstner, <em>The VNR Concise Encyclopedia of Mathematics</em>, 2nd ed., ch. 12 (Van Nostrand Reinhold: New York, 1989).</li>
</ul>
<references>
</references>
<h2 id="external-links">External links</h2>
<ul>
<li>Implementations of the Haversine formula <a href="http://rosettacode.org/wiki/Haversine_formula">in 67 languages at rosettacode.org</a> and <a href="http://www.codecodex.com/wiki/Calculate_Distance_Between_Two_Points_on_a_Globe">in 17 languages on codecodex.com</a></li>
<li>Other implementations in <a href="http://blog.julien.cayzac.name/2008/10/arc-and-distance-between-two-points-on.html">C++</a>, <a href="http://www.jaimerios.com/?p=39">C (MacOS)</a>, <a href="http://scifunam.fisica.unam.mx/mir/codes.html#haversine">Pascal</a>, <a href="http://stackoverflow.com/a/4913653/1389451">Python</a>, <a href="https://github.com/kristianmandrup/haversine/blob/master/lib/haversine.rb">Ruby</a>, <a href="http://www.movable-type.co.uk/scripts/LatLong.html">JavaScript</a>, <a href="http://samoht.fr/informatique/distance-between-two-points-on-earth-surface-haversine-formula">Matlab</a>, <a href="https://github.com/Lus71/lib_mysqludf_haversine">MySQL</a></li>
</ul>

<p><a href="de:Sinus_versus_und_Kosinus_versus" title="wikilink">de:Sinus versus und Kosinus versus</a>"</p>

<p><a href="Category:Spherical_trigonometry" title="wikilink">Category:Spherical trigonometry</a> <a class="uri" href="Category:Geolocation" title="wikilink">Category:Geolocation</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1">Heavenly Mathematics: The Forgotten Art of Spherical Trigonometry By Glen Van Brummelen<a href="#fnref1">↩</a></li>
<li id="fn2">A History of Mathematical Notations: Vol. II By Florian Cajori<a href="#fnref2">↩</a></li>
<li id="fn3">Oxford English Dictionary. Oxford University Press. 2nd ed. 1989. Cites coinage of term "Haversine" by Prof. Jas. Inman, D. D., in his Navigation and Nautical Astronomy, 3rd ed. (1835).<a href="#fnref3">↩</a></li>
<li id="fn4">H. B. Goodwin, [<a class="uri" href="http://books.google.com/books?id=KSNKAAAAYAAJ&amp;lpg">http://books.google.com/books?id=KSNKAAAAYAAJ&amp;lpg;</a>;=PA735&amp;pg;=PA735 The haversine in nautical astronomy], <em>Naval Institute Proceedings</em>, vol. 36, no. 3 (1910), pp. 735–746: <em>Evidently if a Table of Haversines is employed we shall be saved in the first instance the trouble of dividing the sum of the logarithms by two, and in the second place of multiplying the angle taken from the tables by the same number. This is the special advantage of the form of table first introduced by Professor Inman, of the Portsmouth Royal Navy College, nearly a century ago.</em><a href="#fnref4">↩</a></li>
<li id="fn5">W. W. Sheppard and C. C. Soule, <a href="http://books.google.com/books?id=8S0wAAAAYAAJ">Practical navigation</a> (World Technical Institute: Jersey City, 1922).<a href="#fnref5">↩</a></li>
<li id="fn6">E. R. Hedrick, <a href="https://archive.org/details/logarithmictrigo00hedriala">Logarithmic and Trigonometric Tables</a> (Macmillan, New York, 1913).<a href="#fnref6">↩</a></li>
</ol>
</section>
</body>
</html>

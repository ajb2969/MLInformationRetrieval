<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="173">McNemar's test</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>McNemar's test</h1>
<hr/>

<p>In <a class="uri" href="statistics" title="wikilink">statistics</a>, <strong>McNemar's test</strong> is a statistical test used on <a href="Blocking_(statistics)" title="wikilink">paired</a> <a href="nominal_data" title="wikilink">nominal data</a>. It is applied to 2 × 2 <a href="contingency_table" title="wikilink">contingency tables</a> with a <a class="uri" href="dichotomous" title="wikilink">dichotomous</a> trait, with matched pairs of subjects, to determine whether the row and column marginal frequencies are equal (that is, whether there is "marginal homogeneity"). It is named after <a href="Quinn_McNemar" title="wikilink">Quinn McNemar</a>, who introduced it in 1947.<a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a> An application of the test in genetics is the <a href="transmission_disequilibrium_test" title="wikilink">transmission disequilibrium test</a> for detecting <a href="linkage_disequilibrium" title="wikilink">linkage disequilibrium</a>.<a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a></p>
<h2 id="definition">Definition</h2>

<p>The test is applied to a 2 × 2 contingency table, which tabulates the outcomes of two tests on a sample of <em>n</em> subjects, as follows.</p>
<center>
<table>
<tbody>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">
<p>Test 2 positive</p></td>
<td style="text-align: left;">
<p>Test 2 negative</p></td>
<td style="text-align: left;">
<p>Row total</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>Test 1 positive</p></td>
<td style="text-align: left;">
<p><em>a</em></p></td>
<td style="text-align: left;">
<p><em>b</em></p></td>
<td style="text-align: left;">
<p><em>a</em> + <em>b</em></p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>Test 1 negative</p></td>
<td style="text-align: left;">
<p><em>c</em></p></td>
<td style="text-align: left;">
<p><em>d</em></p></td>
<td style="text-align: left;">
<p><em>c</em> + <em>d</em></p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>Column total</p></td>
<td style="text-align: left;">
<p><em>a</em> + <em>c</em></p></td>
<td style="text-align: left;">
<p><em>b</em> + <em>d</em></p></td>
<td style="text-align: left;">
<p><em>n</em></p></td>
</tr>
</tbody>
</table>
</center>

<p>The <a href="null_hypothesis" title="wikilink">null hypothesis</a> of marginal homogeneity states that the two marginal probabilities for each outcome are the same, i.e. <em>p</em><sub><em>a</em></sub> + <em>p</em><sub><em>b</em></sub> = <em>p</em><sub><em>a</em></sub> + <em>p</em><sub><em>c</em></sub> and <em>p</em><sub><em>c</em></sub> + <em>p</em><sub><em>d</em></sub> = <em>p</em><sub><em>b</em></sub> + <em>p</em><sub><em>d</em></sub>.</p>

<p>Thus the null and alternative hypotheses are<a class="footnoteRef" href="#fn3" id="fnref3"><sup>3</sup></a></p>

<p>

<math display="inline" id="McNemar's_test:0">
 <semantics>
  <msub>
   <mi>H</mi>
   <mn>0</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>H</ci>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle H_{0}
  </annotation>
 </semantics>
</math>


</p>

<p>Here <em>p</em><sub><em>a</em></sub>, etc., denote the theoretical probability of occurrences in cells with the corresponding label.</p>

<p>The McNemar <a href="test_statistic" title="wikilink">test statistic</a> is:</p>

<p>

<math display="block" id="McNemar's_test:1">
 <semantics>
  <mrow>
   <mrow>
    <msup>
     <mi>χ</mi>
     <mn>2</mn>
    </msup>
    <mo>=</mo>
    <mfrac>
     <msup>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mi>b</mi>
        <mo>-</mo>
        <mi>c</mi>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
      <mn>2</mn>
     </msup>
     <mrow>
      <mi>b</mi>
      <mo>+</mo>
      <mi>c</mi>
     </mrow>
    </mfrac>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>χ</ci>
     <cn type="integer">2</cn>
    </apply>
    <apply>
     <divide></divide>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <minus></minus>
       <ci>b</ci>
       <ci>c</ci>
      </apply>
      <cn type="integer">2</cn>
     </apply>
     <apply>
      <plus></plus>
      <ci>b</ci>
      <ci>c</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \chi^{2}={(b-c)^{2}\over b+c}.
  </annotation>
 </semantics>
</math>

</p>

<p>Under the null hypothesis, with a sufficiently large number of discordants (cells b and c), 

<math display="inline" id="McNemar's_test:2">
 <semantics>
  <msup>
   <mi>χ</mi>
   <mn>2</mn>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>χ</ci>
    <cn type="integer">2</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \chi^{2}
  </annotation>
 </semantics>
</math>

 has a <a href="chi-squared_distribution" title="wikilink">chi-squared distribution</a> with 1 <a href="degrees_of_freedom_(statistics)" title="wikilink">degree of freedom</a>. If the 

<math display="inline" id="McNemar's_test:3">
 <semantics>
  <msup>
   <mi>χ</mi>
   <mn>2</mn>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>χ</ci>
    <cn type="integer">2</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \chi^{2}
  </annotation>
 </semantics>
</math>

 result is <a href="statistical_significance" title="wikilink">significant</a>, this provides sufficient evidence to reject the null hypothesis, in favour of the alternative hypothesis that <em>p<sub>b</sub></em> ≠ <em>p<sub>c</sub></em>, which would mean that the marginal proportions are significantly different from each other.</p>
<h3 id="variations">Variations</h3>

<p>If either <em>b</em> or <em>c</em> is small (<em>b</em> + <em>c</em> \chi^2 is not well-approximated by the chi-squared distribution.  An exact binomial test can then be used, where <em>b</em> is compared to a <a href="binomial_distribution" title="wikilink">binomial distribution</a> with size parameter <em>n</em> = <em>b</em> + <em>c</em> and <em>p</em> = 0.5. Effectively, the exact binomial test evaluates the imbalance in the discordants <em>b</em> and <em>c</em>. To achieve a two-sided P-value, the P-value of the extreme tail should be multiplied by 2:</p>

<p>exact-P-value = 

<math display="inline" id="McNemar's_test:4">
 <semantics>
  <mrow>
   <mn>2</mn>
   <mrow>
    <msubsup>
     <mo largeop="true" symmetric="true">∑</mo>
     <mrow>
      <mi>i</mi>
      <mo>=</mo>
      <mn>0</mn>
     </mrow>
     <mi>b</mi>
    </msubsup>
    <mrow>
     <mrow>
      <mo>(</mo>
      <mstyle scriptlevel="+1">
       <mtable columnspacing="0.4em" rowspacing="0.2ex">
        <mtr>
         <mtd>
          <mi>n</mi>
         </mtd>
        </mtr>
        <mtr>
         <mtd>
          <mi>i</mi>
         </mtd>
        </mtr>
       </mtable>
      </mstyle>
      <mo>)</mo>
     </mrow>
     <msup>
      <mn>0.5</mn>
      <mi>i</mi>
     </msup>
     <msup>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mn>1</mn>
        <mo>-</mo>
        <mn>0.5</mn>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
      <mrow>
       <mi>n</mi>
       <mo>-</mo>
       <mi>i</mi>
      </mrow>
     </msup>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <cn type="integer">2</cn>
    <apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <apply>
        <eq></eq>
        <ci>i</ci>
        <cn type="integer">0</cn>
       </apply>
      </apply>
      <ci>b</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="latexml">binomial</csymbol>
       <ci>n</ci>
       <ci>i</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <cn type="float">0.5</cn>
       <ci>i</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
        <cn type="float">0.5</cn>
       </apply>
       <apply>
        <minus></minus>
        <ci>n</ci>
        <ci>i</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   2\sum_{i=0}^{b}{n\choose i}0.5^{i}(1-0.5)^{n-i}
  </annotation>
 </semantics>
</math>

</p>

<p>which is simply twice the binomial distribution <a href="cumulative_distribution_function" title="wikilink">cumulative distribution function</a> with <em>p</em> = 0.5 and <em>n</em> = <em>b</em> + <em>c</em>.</p>

<p>Edwards <a class="footnoteRef" href="#fn4" id="fnref4"><sup>4</sup></a> proposed the following continuity corrected version of the McNemar test to approximate the binomial exact-P-value:</p>

<p>

<math display="block" id="McNemar's_test:5">
 <semantics>
  <mrow>
   <mrow>
    <msup>
     <mi>χ</mi>
     <mn>2</mn>
    </msup>
    <mo>=</mo>
    <mfrac>
     <msup>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mrow>
         <mo stretchy="false">|</mo>
         <mrow>
          <mi>b</mi>
          <mo>-</mo>
          <mi>c</mi>
         </mrow>
         <mo stretchy="false">|</mo>
        </mrow>
        <mo>-</mo>
        <mn>1</mn>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
      <mn>2</mn>
     </msup>
     <mrow>
      <mi>b</mi>
      <mo>+</mo>
      <mi>c</mi>
     </mrow>
    </mfrac>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>χ</ci>
     <cn type="integer">2</cn>
    </apply>
    <apply>
     <divide></divide>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <minus></minus>
       <apply>
        <abs></abs>
        <apply>
         <minus></minus>
         <ci>b</ci>
         <ci>c</ci>
        </apply>
       </apply>
       <cn type="integer">1</cn>
      </apply>
      <cn type="integer">2</cn>
     </apply>
     <apply>
      <plus></plus>
      <ci>b</ci>
      <ci>c</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \chi^{2}={(|b-c|-1)^{2}\over b+c}.
  </annotation>
 </semantics>
</math>

</p>

<p>The mid-P McNemar test (mid-p binomial test) is calculated by subtracting half the probability of the observed <em>b</em> from the exact one-sided P-value, then double it to obtain the two-sided mid-P-value:<a class="footnoteRef" href="#fn5" id="fnref5"><sup>5</sup></a><a class="footnoteRef" href="#fn6" id="fnref6"><sup>6</sup></a></p>

<p>mid-P-value = 

<math display="inline" id="McNemar's_test:6">
 <semantics>
  <mrow>
   <mn>2</mn>
   <mrow>
    <mo stretchy="false">(</mo>
    <mrow>
     <mrow>
      <msubsup>
       <mo largeop="true" symmetric="true">∑</mo>
       <mrow>
        <mi>i</mi>
        <mo>=</mo>
        <mn>0</mn>
       </mrow>
       <mi>b</mi>
      </msubsup>
      <mrow>
       <mrow>
        <mo>(</mo>
        <mstyle scriptlevel="+1">
         <mtable columnspacing="0.4em" rowspacing="0.2ex">
          <mtr>
           <mtd>
            <mi>n</mi>
           </mtd>
          </mtr>
          <mtr>
           <mtd>
            <mi>i</mi>
           </mtd>
          </mtr>
         </mtable>
        </mstyle>
        <mo>)</mo>
       </mrow>
       <msup>
        <mn>0.5</mn>
        <mi>i</mi>
       </msup>
       <msup>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <mn>1</mn>
          <mo>-</mo>
          <mn>0.5</mn>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
        <mrow>
         <mi>n</mi>
         <mo>-</mo>
         <mi>i</mi>
        </mrow>
       </msup>
      </mrow>
     </mrow>
     <mo>-</mo>
     <mrow>
      <mn>0.5</mn>
      <mrow>
       <mo>(</mo>
       <mstyle scriptlevel="+1">
        <mtable columnspacing="0.4em" rowspacing="0.2ex">
         <mtr>
          <mtd>
           <mi>n</mi>
          </mtd>
         </mtr>
         <mtr>
          <mtd>
           <mi>b</mi>
          </mtd>
         </mtr>
        </mtable>
       </mstyle>
       <mo>)</mo>
      </mrow>
      <msup>
       <mn>0.5</mn>
       <mi>b</mi>
      </msup>
      <msup>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mn>1</mn>
         <mo>-</mo>
         <mn>0.5</mn>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
       <mrow>
        <mi>n</mi>
        <mo>-</mo>
        <mi>b</mi>
       </mrow>
      </msup>
     </mrow>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <cn type="integer">2</cn>
    <apply>
     <minus></minus>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <apply>
         <eq></eq>
         <ci>i</ci>
         <cn type="integer">0</cn>
        </apply>
       </apply>
       <ci>b</ci>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="latexml">binomial</csymbol>
        <ci>n</ci>
        <ci>i</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <cn type="float">0.5</cn>
        <ci>i</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <minus></minus>
         <cn type="integer">1</cn>
         <cn type="float">0.5</cn>
        </apply>
        <apply>
         <minus></minus>
         <ci>n</ci>
         <ci>i</ci>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <cn type="float">0.5</cn>
      <apply>
       <csymbol cd="latexml">binomial</csymbol>
       <ci>n</ci>
       <ci>b</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <cn type="float">0.5</cn>
       <ci>b</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
        <cn type="float">0.5</cn>
       </apply>
       <apply>
        <minus></minus>
        <ci>n</ci>
        <ci>b</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   2(\sum_{i=0}^{b}{n\choose i}0.5^{i}(1-0.5)^{n-i}-0.5{n\choose b}0.5^{b}(1-0.5)%
^{n-b})
  </annotation>
 </semantics>
</math>

</p>

<p>This is equivalent to:</p>

<p>mid-P-value = exact-P-value 

<math display="inline" id="McNemar's_test:7">
 <semantics>
  <mrow>
   <mo>-</mo>
   <mrow>
    <mrow>
     <mo>(</mo>
     <mstyle scriptlevel="+1">
      <mtable columnspacing="0.4em" rowspacing="0.2ex">
       <mtr>
        <mtd>
         <mi>n</mi>
        </mtd>
       </mtr>
       <mtr>
        <mtd>
         <mi>b</mi>
        </mtd>
       </mtr>
      </mtable>
     </mstyle>
     <mo>)</mo>
    </mrow>
    <msup>
     <mn>0.5</mn>
     <mi>b</mi>
    </msup>
    <msup>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mn>1</mn>
       <mo>-</mo>
       <mn>0.5</mn>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <mrow>
      <mi>n</mi>
      <mo>-</mo>
      <mi>b</mi>
     </mrow>
    </msup>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <minus></minus>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="latexml">binomial</csymbol>
      <ci>n</ci>
      <ci>b</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <cn type="float">0.5</cn>
      <ci>b</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
       <cn type="float">0.5</cn>
      </apply>
      <apply>
       <minus></minus>
       <ci>n</ci>
       <ci>b</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   -{n\choose b}0.5^{b}(1-0.5)^{n-b}
  </annotation>
 </semantics>
</math>

</p>

<p>where the second term is the binomial distribution <a href="probability_mass_function" title="wikilink">probability mass function</a> and <em>n</em> = <em>b</em> + <em>c</em>. Fortunately, binomial distribution functions are readily available in common software packages and the McNemar mid-P test can easily be calculated.<a class="footnoteRef" href="#fn7" id="fnref7"><sup>7</sup></a></p>

<p>The traditional advice has been to use the exact binomial test when <em>b</em> + <em>c</em>  When <em>b</em> + <em>c</em> </p>
<table>
<tbody>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">
<p><strong>After:</strong> present</p></td>
<td style="text-align: left;">
<p><strong>After:</strong> absent</p></td>
<td style="text-align: left;">
<p>Row total</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p><strong>Before:</strong> present</p></td>
<td style="text-align: left;">
<p>101</p></td>
<td style="text-align: left;">
<p>121</p></td>
<td style="text-align: left;">
<p>222</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p><strong>Before:</strong> absent</p></td>
<td style="text-align: left;">
<p>59</p></td>
<td style="text-align: left;">
<p>33</p></td>
<td style="text-align: left;">
<p>92</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>Column total</p></td>
<td style="text-align: left;">
<p>160</p></td>
<td style="text-align: left;">
<p>154</p></td>
<td style="text-align: left;">
<p>314</p></td>
</tr>
</tbody>
</table>

<p>In this example, the null hypothesis of "marginal homogeneity" would mean there was no effect of the treatment. From the above data, the McNemar test statistic:</p>

<p>

<math display="block" id="McNemar's_test:8">
 <semantics>
  <mrow>
   <msup>
    <mi>χ</mi>
    <mn>2</mn>
   </msup>
   <mo>=</mo>
   <mfrac>
    <msup>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mn>121</mn>
       <mo>-</mo>
       <mn>59</mn>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <mn>2</mn>
    </msup>
    <mrow>
     <mn>121</mn>
     <mo>+</mo>
     <mn>59</mn>
    </mrow>
   </mfrac>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>χ</ci>
     <cn type="integer">2</cn>
    </apply>
    <apply>
     <divide></divide>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <minus></minus>
       <cn type="integer">121</cn>
       <cn type="integer">59</cn>
      </apply>
      <cn type="integer">2</cn>
     </apply>
     <apply>
      <plus></plus>
      <cn type="integer">121</cn>
      <cn type="integer">59</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \chi^{2}={(121-59)^{2}\over{121+59}}
  </annotation>
 </semantics>
</math>

</p>

<p>has the value 21.35, which is extremely unlikely to form the distribution implied by the null hypothesis (<em>P</em>  The data table is formatted as before, with different numbers in the cells:</p>
<center>
<table>
<tbody>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">
<p><strong>After:</strong> present</p></td>
<td style="text-align: left;">
<p><strong>After:</strong> absent</p></td>
<td style="text-align: left;">
<p>Row total</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p><strong>Before:</strong> present</p></td>
<td style="text-align: left;">
<p>59</p></td>
<td style="text-align: left;">
<p>6</p></td>
<td style="text-align: left;">
<p>65</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p><strong>Before:</strong> absent</p></td>
<td style="text-align: left;">
<p>16</p></td>
<td style="text-align: left;">
<p>80</p></td>
<td style="text-align: left;">
<p>96</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>Column total</p></td>
<td style="text-align: left;">
<p>75</p></td>
<td style="text-align: left;">
<p>86</p></td>
<td style="text-align: left;">
<p>161</p></td>
</tr>
</tbody>
</table>
</center>

<p>With these data, the sample size (161 patients) is not small, however results from the McNemar test and other versions are different. The exact binomial test gives <em>P</em> = 0.053 and McNemar's test with continuity correction gives 

<math display="inline" id="McNemar's_test:9">
 <semantics>
  <msup>
   <mi>χ</mi>
   <mn>2</mn>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>χ</ci>
    <cn type="integer">2</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \chi^{2}
  </annotation>
 </semantics>
</math>

 = 3.68 and <em>P</em> = 0.055. The asymptotic McNemar's test gives 

<math display="inline" id="McNemar's_test:10">
 <semantics>
  <msup>
   <mi>χ</mi>
   <mn>2</mn>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>χ</ci>
    <cn type="integer">2</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \chi^{2}
  </annotation>
 </semantics>
</math>

 = 4.55 and <em>P</em> = 0.033 and the mid-P McNemar's test gives <em>P</em> = 0.035. Both the McNemar's test and mid-P version provide stronger evidence for a statistically significant treatment effect in this second example.</p>
<h2 id="discussion">Discussion</h2>

<p>An interesting observation when interpreting McNemar's test is that the elements of the main diagonal do not contribute to the decision about whether (in the above example) pre- or post-treatment condition is more favourable. Thus, the sum <em>b</em> + <em>c</em> can be small and statistical power of the tests described above can be low even though the number of pairs <em>a</em> + <em>b</em> + <em>c</em> + <em>d</em> is large (see second example above).</p>

<p>An extension of McNemar's test exists in situations where independence does not necessarily hold between the pairs; instead, there are clusters of paired data where the pairs in a cluster may not be independent, but independence holds between different clusters.<a class="footnoteRef" href="#fn8" id="fnref8"><sup>8</sup></a> An example is analyzing the effectiveness of a dental procedure; in this case, a pair corresponds to the treatment of an individual tooth in patients who might have multiple teeth treated; the effectiveness of treatment of two teeth in the same patient is not likely to be independent, but the treatment of two teeth in different patients is more likely to be independent.<a class="footnoteRef" href="#fn9" id="fnref9"><sup>9</sup></a></p>
<h3 id="information-in-the-pairings">Information in the pairings</h3>

<p>John Rice wrote:<a class="footnoteRef" href="#fn10" id="fnref10"><sup>10</sup></a></p>
<blockquote>

<p>85 <a href="Hodgkin's_lymphoma" title="wikilink">Hodgkin's</a> patients [...] had a sibling of the same sex who was free of the disease and whose age was within 5 years of the patient's. These investigators presented the following table:</p>
<dl>
<dd><dl>
<dd><math>
</math></dd>
</dl>
</dd>
</dl>

<p>\begin{array}{c|c|c} \hline &amp; \text{Tonsillectomy} &amp; \text{No tonsillectomy} \\ \hline\text{Hodgkins} &amp; 41 &amp; 44 \\ \hline\text{Control} &amp; 33 &amp; 52 \end{array}  They calculated a <a href="chi-squared_test" title="wikilink">chi-squared statistic</a> of 1.53, which is not <a href="statistical_significance" title="wikilink">significant</a>.[...] [they] had made an error in their analysis by ignoring the pairings.[...] [their] samples were not independent, because the siblings were paired [...] we set up a table that exhibits the pairings:</p>

<p>

<math display="block" id="McNemar's_test:11">
 <semantics>
  <mtable displaystyle="true">
   <mtr>
    <mtd></mtd>
    <mtd columnalign="center">
     <mtext>Sibling</mtext>
    </mtd>
   </mtr>
   <mtr>
    <mtd columnalign="center">
     <mtext>Patient</mtext>
    </mtd>
    <mtd columnalign="center">
     <mtable displaystyle="true">
      <mtr>
       <mtd class="ltx_border_r ltx_border_t">
        <mi></mi>
       </mtd>
       <mtd class="ltx_border_r ltx_border_t" columnalign="center">
        <mtext>No tonsillectomy</mtext>
       </mtd>
       <mtd class="ltx_border_t" columnalign="center">
        <mtext>Tonsillectomy</mtext>
       </mtd>
      </mtr>
      <mtr>
       <mtd class="ltx_border_r ltx_border_t" columnalign="center">
        <mtext>No tonsillectomy</mtext>
       </mtd>
       <mtd class="ltx_border_r ltx_border_t" columnalign="center">
        <mn>37</mn>
       </mtd>
       <mtd class="ltx_border_t" columnalign="center">
        <mn>7</mn>
       </mtd>
      </mtr>
      <mtr>
       <mtd class="ltx_border_r ltx_border_t" columnalign="center">
        <mtext>Tonsillectomy</mtext>
       </mtd>
       <mtd class="ltx_border_r ltx_border_t" columnalign="center">
        <mn>15</mn>
       </mtd>
       <mtd class="ltx_border_t" columnalign="center">
        <mn>26</mn>
       </mtd>
      </mtr>
     </mtable>
    </mtd>
   </mtr>
  </mtable>
  <annotation-xml encoding="MathML-Content">
   <matrix>
    <matrixrow>
     <cerror>
      <csymbol cd="ambiguous">missing-subexpression</csymbol>
     </cerror>
     <mtext>Sibling</mtext>
    </matrixrow>
    <matrixrow>
     <mtext>Patient</mtext>
     <matrix>
      <matrixrow>
       <csymbol cd="latexml">absent</csymbol>
       <mtext>No tonsillectomy</mtext>
       <mtext>Tonsillectomy</mtext>
      </matrixrow>
      <matrixrow>
       <mtext>No tonsillectomy</mtext>
       <cn type="integer">37</cn>
       <cn type="integer">7</cn>
      </matrixrow>
      <matrixrow>
       <mtext>Tonsillectomy</mtext>
       <cn type="integer">15</cn>
       <cn type="integer">26</cn>
      </matrixrow>
     </matrix>
    </matrixrow>
   </matrix>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \begin{array}[]{cc}&\text{Sibling}\\
\text{Patient}&\begin{array}[]{c|c|c}\hline&\text{No tonsillectomy}&\text{%
Tonsillectomy}\\
\hline\text{No tonsillectomy}&37&7\\
\hline\text{Tonsillectomy}&15&26\end{array}\end{array}
  </annotation>
 </semantics>
</math>

</p>
</blockquote>

<p>It is to the second table that McNemar's test can be applied. Notice that the sum of the numbers in the second table is 85—the number of <em>pairs</em> of siblings—whereas the sum of the numbers in the first table is twice as big, 170—the number of individuals. The second table gives more information than the first. The numbers in the first table can be found by using the numbers in the second table, but not vice versa. The numbers in the first table give only the marginal totals of the numbers in the second table.</p>
<h2 id="related-tests">Related tests</h2>
<ul>
<li>The binomial <a href="sign_test" title="wikilink">sign test</a> gives an exact test for the McNemar's test.</li>
<li>The <a href="Cochran's_Q_test" title="wikilink">Cochran's Q test</a> for two "treatments" is equivalent to the McNemar's test.</li>
<li>The <a href="Liddell's_exact_test" title="wikilink">Liddell's exact test</a> is an exact alternative to McNemar's test.<a class="footnoteRef" href="#fn11" id="fnref11"><sup>11</sup></a><a class="footnoteRef" href="#fn12" id="fnref12"><sup>12</sup></a></li>
<li>The <a href="Stuart–Maxwell_test" title="wikilink">Stuart–Maxwell test</a> is different generalization of the McNemar test, used for testing marginal homogeneity in a square table with more than two rows/columns.<a class="footnoteRef" href="#fn13" id="fnref13"><sup>13</sup></a><a class="footnoteRef" href="#fn14" id="fnref14"><sup>14</sup></a><a class="footnoteRef" href="#fn15" id="fnref15"><sup>15</sup></a></li>
<li>The <a href="Bhapkar's_test" title="wikilink">Bhapkar's test</a> (1966) is a more powerful alternative to the Stuart–Maxwell test,<a class="footnoteRef" href="#fn16" id="fnref16"><sup>16</sup></a><a class="footnoteRef" href="#fn17" id="fnref17"><sup>17</sup></a> but it tends to be liberal. Competitive alternatives to the extant methods are available.<a class="footnoteRef" href="#fn18" id="fnref18"><sup>18</sup></a></li>
</ul>
<h2 id="see-also">See also</h2>
<ul>
<li><a href="Pearson's_chi-squared_test" title="wikilink">Pearson's chi-squared test</a></li>
</ul>
<h2 id="references">References</h2>
<h2 id="external-links">External links</h2>
<ul>
<li><a href="http://faculty.vassar.edu/lowry/propcorr.html">Vassar College's McNemar 2×2 Grid</a></li>
<li><a href="http://john-uebersax.com/stat/mcnemar.htm">McNemar Tests of Marginal Homogeneity</a></li>
</ul>

<p>"</p>

<p><a href="Category:Statistical_tests" title="wikilink">Category:Statistical tests</a> <a href="Category:Categorical_data" title="wikilink">Category:Categorical data</a> <a href="Category:Non-parametric_statistics" title="wikilink">Category:Non-parametric statistics</a> <a href="Category:Summary_statistics_for_contingency_tables" title="wikilink">Category:Summary statistics for contingency tables</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1"><a href="#fnref1">↩</a></li>
<li id="fn2"><a href="#fnref2">↩</a></li>
<li id="fn3"></li>
<li id="fn4"><a href="#fnref4">↩</a></li>
<li id="fn5"><a href="#fnref5">↩</a></li>
<li id="fn6"><a href="#fnref6">↩</a></li>
<li id="fn7"></li>
<li id="fn8"><a href="#fnref8">↩</a></li>
<li id="fn9"><a href="#fnref9">↩</a></li>
<li id="fn10"><a href="#fnref10">↩</a></li>
<li id="fn11"><a href="#fnref11">↩</a></li>
<li id="fn12"><a href="#fnref12">↩</a></li>
<li id="fn13"><a href="#fnref13">↩</a></li>
<li id="fn14"><a href="#fnref14">↩</a></li>
<li id="fn15"><a href="#fnref15">↩</a></li>
<li id="fn16"><a href="#fnref16">↩</a></li>
<li id="fn17"><a href="#fnref17">↩</a></li>
<li id="fn18"><a href="#fnref18">↩</a></li>
</ol>
</section>
</body>
</html>

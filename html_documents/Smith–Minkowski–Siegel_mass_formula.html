<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="245">Smith–Minkowski–Siegel mass formula</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Smith–Minkowski–Siegel mass formula</h1>
<hr/>

<p>In mathematics, the <strong>Smith–Minkowski–Siegel mass formula</strong> (or <strong>Minkowski–Siegel mass formula</strong>) is a formula for the sum of the weights of the lattices (<a href="quadratic_form" title="wikilink">quadratic forms</a>) in a <a href="Genus_of_a_quadratic_form" title="wikilink">genus</a>, weighted by the reciprocals of the orders of their automorphism groups. The mass formula is often given for integral quadratic forms, though it can be generalized to quadratic forms over any algebraic number field.</p>

<p>In 0 and 1 dimensions the mass formula is trivial, in 2 dimensions it is essentially equivalent to <a href="Peter_Gustav_Lejeune_Dirichlet" title="wikilink">Dirichlet's</a> <a href="class_number_formula" title="wikilink">class number formulas</a> for <a href="imaginary_quadratic_field" title="wikilink">imaginary quadratic fields</a>, and in 3 dimensions some partial results were given by <a href="Ferdinand_Eisenstein" title="wikilink">Ferdinand Eisenstein</a>. The mass formula in higher dimensions was first given by , though his results were forgotten for many years. It was rediscovered by , and an error in Minkowski's paper was found and corrected by .</p>

<p>Many published versions of the mass formula have errors; in particular the 2-adic densities are difficult to get right, and it is sometimes forgotten that the trivial cases of dimensions 0 and 1 are different from the cases of dimension at least 2.  give an expository account and precise statement of the mass formula for integral quadratic forms, which is reliable because they check it on a large number of explicit cases.</p>

<p>For recent proofs of the mass formula see  and .</p>

<p>The Smith–Minkowski–Siegel mass formula is essentially the constant term of the <a href="Weil–Siegel_formula" title="wikilink">Weil–Siegel formula</a>.</p>
<h2 id="statement-of-the-mass-formula">Statement of the mass formula</h2>

<p>If <em>f</em> is an <em>n</em>-dimensional positive definite integral quadratic form (or lattice) then the <strong>mass</strong> of its genus is defined to be</p>

<p>

<math display="block" id="Smith–Minkowski–Siegel_mass_formula:0">
 <semantics>
  <mrow>
   <mrow>
    <mi>m</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>f</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <munder>
     <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
     <mi mathvariant="normal">Λ</mi>
    </munder>
    <mfrac>
     <mn>1</mn>
     <mrow>
      <mo stretchy="false">|</mo>
      <mrow>
       <mo>Aut</mo>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi mathvariant="normal">Λ</mi>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
      <mo stretchy="false">|</mo>
     </mrow>
    </mfrac>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>m</ci>
     <ci>f</ci>
    </apply>
    <apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <sum></sum>
      <ci>normal-Λ</ci>
     </apply>
     <apply>
      <divide></divide>
      <cn type="integer">1</cn>
      <apply>
       <abs></abs>
       <apply>
        <ci>Aut</ci>
        <ci>normal-Λ</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   m(f)=\sum_{\Lambda}{1\over|\operatorname{Aut}(\Lambda)|}
  </annotation>
 </semantics>
</math>

</p>

<p>where the sum is over all integrally inequivalent forms in the same genus as <em>f</em>, and Aut(Λ) is the automorphism group of Λ. The form of the <strong>mass formula</strong> given by  states that for <em>n</em> ≥ 2 the mass is given by</p>

<p>

<math display="block" id="Smith–Minkowski–Siegel_mass_formula:1">
 <semantics>
  <mrow>
   <mrow>
    <mi>m</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>f</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mn>2</mn>
    <msup>
     <mi>π</mi>
     <mrow>
      <mo>-</mo>
      <mrow>
       <mrow>
        <mi>n</mi>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <mi>n</mi>
          <mo>+</mo>
          <mn>1</mn>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
       <mo>/</mo>
       <mn>4</mn>
      </mrow>
     </mrow>
    </msup>
    <mrow>
     <munderover>
      <mo largeop="true" movablelimits="false" symmetric="true">∏</mo>
      <mrow>
       <mi>j</mi>
       <mo>=</mo>
       <mn>1</mn>
      </mrow>
      <mi>n</mi>
     </munderover>
     <mrow>
      <mi mathvariant="normal">Γ</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mi>j</mi>
        <mo>/</mo>
        <mn>2</mn>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
      <mrow>
       <munder>
        <mo largeop="true" movablelimits="false" symmetric="true">∏</mo>
        <mrow>
         <mi>p</mi>
         <mtext>prime</mtext>
        </mrow>
       </munder>
       <mrow>
        <mn>2</mn>
        <msub>
         <mi>m</mi>
         <mi>p</mi>
        </msub>
        <mrow>
         <mo stretchy="false">(</mo>
         <mi>f</mi>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>m</ci>
     <ci>f</ci>
    </apply>
    <apply>
     <times></times>
     <cn type="integer">2</cn>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>π</ci>
      <apply>
       <minus></minus>
       <apply>
        <divide></divide>
        <apply>
         <times></times>
         <ci>n</ci>
         <apply>
          <plus></plus>
          <ci>n</ci>
          <cn type="integer">1</cn>
         </apply>
        </apply>
        <cn type="integer">4</cn>
       </apply>
      </apply>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <csymbol cd="latexml">product</csymbol>
        <apply>
         <eq></eq>
         <ci>j</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <ci>n</ci>
      </apply>
      <apply>
       <times></times>
       <ci>normal-Γ</ci>
       <apply>
        <divide></divide>
        <ci>j</ci>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <csymbol cd="latexml">product</csymbol>
         <apply>
          <times></times>
          <ci>p</ci>
          <mtext>prime</mtext>
         </apply>
        </apply>
        <apply>
         <times></times>
         <cn type="integer">2</cn>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>m</ci>
          <ci>p</ci>
         </apply>
         <ci>f</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   m(f)=2\pi^{-n(n+1)/4}\prod_{j=1}^{n}\Gamma(j/2)\prod_{p\text{ prime}}2m_{p}(f)
  </annotation>
 </semantics>
</math>

</p>

<p>where <em>m</em><sub><em>p</em></sub>(<em>f</em>) is the <em>p</em>-mass of <em>f</em>, given by</p>

<p>

<math display="block" id="Smith–Minkowski–Siegel_mass_formula:2">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>m</mi>
     <mi>p</mi>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>f</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mfrac>
    <msup>
     <mi>p</mi>
     <mrow>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mrow>
         <mi>r</mi>
         <mi>n</mi>
         <mrow>
          <mo stretchy="false">(</mo>
          <mrow>
           <mi>n</mi>
           <mo>-</mo>
           <mn>1</mn>
          </mrow>
          <mo stretchy="false">)</mo>
         </mrow>
        </mrow>
        <mo>+</mo>
        <mrow>
         <mi>s</mi>
         <mrow>
          <mo stretchy="false">(</mo>
          <mrow>
           <mi>n</mi>
           <mo>+</mo>
           <mn>1</mn>
          </mrow>
          <mo stretchy="false">)</mo>
         </mrow>
        </mrow>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
      <mo>/</mo>
      <mn>2</mn>
     </mrow>
    </msup>
    <mrow>
     <mi>N</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <msup>
       <mi>p</mi>
       <mi>r</mi>
      </msup>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mfrac>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>m</ci>
      <ci>p</ci>
     </apply>
     <ci>f</ci>
    </apply>
    <apply>
     <divide></divide>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>p</ci>
      <apply>
       <divide></divide>
       <apply>
        <plus></plus>
        <apply>
         <times></times>
         <ci>r</ci>
         <ci>n</ci>
         <apply>
          <minus></minus>
          <ci>n</ci>
          <cn type="integer">1</cn>
         </apply>
        </apply>
        <apply>
         <times></times>
         <ci>s</ci>
         <apply>
          <plus></plus>
          <ci>n</ci>
          <cn type="integer">1</cn>
         </apply>
        </apply>
       </apply>
       <cn type="integer">2</cn>
      </apply>
     </apply>
     <apply>
      <times></times>
      <ci>N</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>p</ci>
       <ci>r</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   m_{p}(f)={p^{(rn(n-1)+s(n+1))/2}\over N(p^{r})}
  </annotation>
 </semantics>
</math>

</p>

<p>for sufficiently large <em>r</em>, where <em>p</em><sup><em>s</em></sup> is the highest power of <em>p</em> dividing the determinant of <em>f</em>. The number <em>N</em>(<em>p</em><sup><em>r</em></sup>) is the number of <em>n</em> by <em>n</em> matrices <em>X</em> with coefficients that are integers mod <em>p</em><sup> <em>r</em></sup> such that</p>

<p>

<math display="block" id="Smith–Minkowski–Siegel_mass_formula:3">
 <semantics>
  <mrow>
   <mrow>
    <msup>
     <mi>X</mi>
     <mtext>tr</mtext>
    </msup>
    <mi>A</mi>
    <mi>X</mi>
   </mrow>
   <mo>≡</mo>
   <mrow>
    <mpadded width="+5pt">
     <mi>A</mi>
    </mpadded>
    <mo lspace="2.5pt" rspace="7.5pt">mod</mo>
    <msup>
     <mi>p</mi>
     <mi>r</mi>
    </msup>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <equivalent></equivalent>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>X</ci>
      <mtext>tr</mtext>
     </apply>
     <ci>A</ci>
     <ci>X</ci>
    </apply>
    <apply>
     <csymbol cd="latexml">modulo</csymbol>
     <ci>A</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>p</ci>
      <ci>r</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   X^{\text{tr}}AX\equiv A\ \bmod\ p^{r}
  </annotation>
 </semantics>
</math>

</p>

<p>where <em>A</em> is the Gram matrix of <em>f</em>, or in other words the order of the automorphism group of the form reduced mod <em>p</em><sup> <em>r</em></sup>.</p>

<p>Some authors state the mass formula in terms of the <em>p</em>-adic density</p>

<p>

<math display="block" id="Smith–Minkowski–Siegel_mass_formula:4">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>α</mi>
     <mi>p</mi>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>f</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mfrac>
    <mrow>
     <mi>N</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <msup>
       <mi>p</mi>
       <mi>r</mi>
      </msup>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <msup>
     <mi>p</mi>
     <mrow>
      <mrow>
       <mi>r</mi>
       <mi>n</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mi>n</mi>
         <mo>-</mo>
         <mn>1</mn>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
      <mo>/</mo>
      <mn>2</mn>
     </mrow>
    </msup>
   </mfrac>
   <mo>=</mo>
   <mfrac>
    <msup>
     <mi>p</mi>
     <mrow>
      <mrow>
       <mi>s</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mi>n</mi>
         <mo>+</mo>
         <mn>1</mn>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
      <mo>/</mo>
      <mn>2</mn>
     </mrow>
    </msup>
    <mrow>
     <msub>
      <mi>m</mi>
      <mi>p</mi>
     </msub>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>f</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mfrac>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>α</ci>
       <ci>p</ci>
      </apply>
      <ci>f</ci>
     </apply>
     <apply>
      <divide></divide>
      <apply>
       <times></times>
       <ci>N</ci>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>p</ci>
        <ci>r</ci>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>p</ci>
       <apply>
        <divide></divide>
        <apply>
         <times></times>
         <ci>r</ci>
         <ci>n</ci>
         <apply>
          <minus></minus>
          <ci>n</ci>
          <cn type="integer">1</cn>
         </apply>
        </apply>
        <cn type="integer">2</cn>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <divide></divide>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>p</ci>
       <apply>
        <divide></divide>
        <apply>
         <times></times>
         <ci>s</ci>
         <apply>
          <plus></plus>
          <ci>n</ci>
          <cn type="integer">1</cn>
         </apply>
        </apply>
        <cn type="integer">2</cn>
       </apply>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>m</ci>
        <ci>p</ci>
       </apply>
       <ci>f</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \alpha_{p}(f)={N(p^{r})\over p^{rn(n-1)/2}}={p^{s(n+1)/2}\over m_{p}(f)}
  </annotation>
 </semantics>
</math>

</p>

<p>instead of the <em>p</em>-mass. The <em>p</em>-mass is invariant under rescaling <em>f</em> but the <em>p</em>-density is not.</p>

<p>In the (trivial) cases of dimension 0 or 1 the mass formula needs some modifications. The factor of 2 in front represents the Tamagawa number of the special orthogonal group, which is only 1 in dimensions 0 and 1. Also the factor of 2 in front of <em>m</em><sub><em>p</em></sub>(<em>f</em>) represents the index of the special orthogonal group in the orthogonal group, which is only 1 in 0 dimensions.</p>
<h2 id="evaluation-of-the-mass">Evaluation of the mass</h2>

<p>The mass formula gives the mass as an infinite product over all primes. This can be rewritten as a finite product as follows. For all but a finite number of primes (those not dividing 2 det(<em>ƒ</em>)) the <em>p</em>-mass <em>m</em><sub><em>p</em></sub>(<em>ƒ</em>) is equal to the <strong>standard p-mass</strong> std<sub><em>p</em></sub>(<em>ƒ</em>), given by</p>

<p>

<math display="block" id="Smith–Minkowski–Siegel_mass_formula:5">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <msub>
      <mo>std</mo>
      <mi>p</mi>
     </msub>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>f</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mfrac>
     <mn>1</mn>
     <mrow>
      <mn>2</mn>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mn>1</mn>
        <mo>-</mo>
        <msup>
         <mi>p</mi>
         <mrow>
          <mo>-</mo>
          <mn>2</mn>
         </mrow>
        </msup>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mn>1</mn>
        <mo>-</mo>
        <msup>
         <mi>p</mi>
         <mrow>
          <mo>-</mo>
          <mn>4</mn>
         </mrow>
        </msup>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
      <mi mathvariant="normal">⋯</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mn>1</mn>
        <mo>-</mo>
        <msup>
         <mi>p</mi>
         <mrow>
          <mn>2</mn>
          <mo>-</mo>
          <mi>n</mi>
         </mrow>
        </msup>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mn>1</mn>
        <mo>-</mo>
        <mrow>
         <mrow>
          <mo>(</mo>
          <mstyle scriptlevel="+1">
           <mtable columnspacing="0.4em" rowspacing="0.2ex">
            <mtr>
             <mtd>
              <mrow>
               <msup>
                <mrow>
                 <mo stretchy="false">(</mo>
                 <mrow>
                  <mo>-</mo>
                  <mn>1</mn>
                 </mrow>
                 <mo stretchy="false">)</mo>
                </mrow>
                <mrow>
                 <mi>n</mi>
                 <mo>/</mo>
                 <mn>2</mn>
                </mrow>
               </msup>
               <mrow>
                <mo>det</mo>
                <mrow>
                 <mo stretchy="false">(</mo>
                 <mi>f</mi>
                 <mo stretchy="false">)</mo>
                </mrow>
               </mrow>
              </mrow>
             </mtd>
            </mtr>
            <mtr>
             <mtd>
              <mi>p</mi>
             </mtd>
            </mtr>
           </mtable>
          </mstyle>
          <mo>)</mo>
         </mrow>
         <msup>
          <mi>p</mi>
          <mrow>
           <mo>-</mo>
           <mrow>
            <mi>n</mi>
            <mo>/</mo>
            <mn>2</mn>
           </mrow>
          </mrow>
         </msup>
        </mrow>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mfrac>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>std</ci>
      <ci>p</ci>
     </apply>
     <ci>f</ci>
    </apply>
    <apply>
     <divide></divide>
     <cn type="integer">1</cn>
     <apply>
      <times></times>
      <cn type="integer">2</cn>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>p</ci>
        <apply>
         <minus></minus>
         <cn type="integer">2</cn>
        </apply>
       </apply>
      </apply>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>p</ci>
        <apply>
         <minus></minus>
         <cn type="integer">4</cn>
        </apply>
       </apply>
      </apply>
      <ci>normal-⋯</ci>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>p</ci>
        <apply>
         <minus></minus>
         <cn type="integer">2</cn>
         <ci>n</ci>
        </apply>
       </apply>
      </apply>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="latexml">binomial</csymbol>
         <apply>
          <times></times>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <apply>
            <minus></minus>
            <cn type="integer">1</cn>
           </apply>
           <apply>
            <divide></divide>
            <ci>n</ci>
            <cn type="integer">2</cn>
           </apply>
          </apply>
          <apply>
           <determinant></determinant>
           <ci>f</ci>
          </apply>
         </apply>
         <ci>p</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>p</ci>
         <apply>
          <minus></minus>
          <apply>
           <divide></divide>
           <ci>n</ci>
           <cn type="integer">2</cn>
          </apply>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \operatorname{std}_{p}(f)={1\over 2(1-p^{-2})(1-p^{-4})\cdots(1-p^{2-n})(1-{(-%
1)^{n/2}\det(f)\choose p}p^{-n/2})}\quad
  </annotation>
 </semantics>
</math>

 (for <em>n</em> = dim(<em>ƒ</em>) even)</p>

<p>

<math display="block" id="Smith–Minkowski–Siegel_mass_formula:6">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mo>std</mo>
     <mi>p</mi>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>f</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mfrac>
    <mn>1</mn>
    <mrow>
     <mn>2</mn>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mn>1</mn>
       <mo>-</mo>
       <msup>
        <mi>p</mi>
        <mrow>
         <mo>-</mo>
         <mn>2</mn>
        </mrow>
       </msup>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mn>1</mn>
       <mo>-</mo>
       <msup>
        <mi>p</mi>
        <mrow>
         <mo>-</mo>
         <mn>4</mn>
        </mrow>
       </msup>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <mi mathvariant="normal">⋯</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mn>1</mn>
       <mo>-</mo>
       <msup>
        <mi>p</mi>
        <mrow>
         <mn>1</mn>
         <mo>-</mo>
         <mi>n</mi>
        </mrow>
       </msup>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mfrac>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>std</ci>
      <ci>p</ci>
     </apply>
     <ci>f</ci>
    </apply>
    <apply>
     <divide></divide>
     <cn type="integer">1</cn>
     <apply>
      <times></times>
      <cn type="integer">2</cn>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>p</ci>
        <apply>
         <minus></minus>
         <cn type="integer">2</cn>
        </apply>
       </apply>
      </apply>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>p</ci>
        <apply>
         <minus></minus>
         <cn type="integer">4</cn>
        </apply>
       </apply>
      </apply>
      <ci>normal-⋯</ci>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>p</ci>
        <apply>
         <minus></minus>
         <cn type="integer">1</cn>
         <ci>n</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \operatorname{std}_{p}(f)={1\over 2(1-p^{-2})(1-p^{-4})\cdots(1-p^{1-n})}
  </annotation>
 </semantics>
</math>

 (for <em>n</em> = dim(<em>ƒ</em>) odd)</p>

<p>where the Legendre symbol in the second line is interpreted as 0 if <em>p</em> divides 2 det(<em>ƒ</em>).</p>

<p>If all the <em>p</em>-masses have their standard value, then the total mass is the <strong>standard mass</strong></p>

<p>

<math display="block" id="Smith–Minkowski–Siegel_mass_formula:7">
 <semantics>
  <mrow>
   <mrow>
    <mo>std</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>f</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mn>2</mn>
    <msup>
     <mi>π</mi>
     <mrow>
      <mo>-</mo>
      <mrow>
       <mrow>
        <mi>n</mi>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <mi>n</mi>
          <mo>+</mo>
          <mn>1</mn>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
       <mo>/</mo>
       <mn>4</mn>
      </mrow>
     </mrow>
    </msup>
    <mrow>
     <mo>(</mo>
     <mrow>
      <munderover>
       <mo largeop="true" movablelimits="false" symmetric="true">∏</mo>
       <mrow>
        <mi>j</mi>
        <mo>=</mo>
        <mn>1</mn>
       </mrow>
       <mi>n</mi>
      </munderover>
      <mrow>
       <mi mathvariant="normal">Γ</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mi>j</mi>
         <mo>/</mo>
         <mn>2</mn>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
     </mrow>
     <mo>)</mo>
    </mrow>
    <mi>ζ</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mn>2</mn>
     <mo stretchy="false">)</mo>
    </mrow>
    <mi>ζ</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mn>4</mn>
     <mo stretchy="false">)</mo>
    </mrow>
    <mi mathvariant="normal">⋯</mi>
    <mi>ζ</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>n</mi>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <ci>std</ci>
     <ci>f</ci>
    </apply>
    <apply>
     <times></times>
     <cn type="integer">2</cn>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>π</ci>
      <apply>
       <minus></minus>
       <apply>
        <divide></divide>
        <apply>
         <times></times>
         <ci>n</ci>
         <apply>
          <plus></plus>
          <ci>n</ci>
          <cn type="integer">1</cn>
         </apply>
        </apply>
        <cn type="integer">4</cn>
       </apply>
      </apply>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <csymbol cd="latexml">product</csymbol>
        <apply>
         <eq></eq>
         <ci>j</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <ci>n</ci>
      </apply>
      <apply>
       <times></times>
       <ci>normal-Γ</ci>
       <apply>
        <divide></divide>
        <ci>j</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
     </apply>
     <ci>ζ</ci>
     <cn type="integer">2</cn>
     <ci>ζ</ci>
     <cn type="integer">4</cn>
     <ci>normal-⋯</ci>
     <ci>ζ</ci>
     <apply>
      <minus></minus>
      <ci>n</ci>
      <cn type="integer">1</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \operatorname{std}(f)=2\pi^{-n(n+1)/4}\left(\prod_{j=1}^{n}\Gamma(j/2)\right)%
\zeta(2)\zeta(4)\cdots\zeta(n-1)
  </annotation>
 </semantics>
</math>

 (For <em>n</em> odd)</p>

<p>

<math display="block" id="Smith–Minkowski–Siegel_mass_formula:8">
 <semantics>
  <mrow>
   <mrow>
    <mo>std</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>f</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mn>2</mn>
    <msup>
     <mi>π</mi>
     <mrow>
      <mo>-</mo>
      <mrow>
       <mrow>
        <mi>n</mi>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <mi>n</mi>
          <mo>+</mo>
          <mn>1</mn>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
       <mo>/</mo>
       <mn>4</mn>
      </mrow>
     </mrow>
    </msup>
    <mrow>
     <mo>(</mo>
     <mrow>
      <munderover>
       <mo largeop="true" movablelimits="false" symmetric="true">∏</mo>
       <mrow>
        <mi>j</mi>
        <mo>=</mo>
        <mn>1</mn>
       </mrow>
       <mi>n</mi>
      </munderover>
      <mrow>
       <mi mathvariant="normal">Γ</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mi>j</mi>
         <mo>/</mo>
         <mn>2</mn>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
     </mrow>
     <mo>)</mo>
    </mrow>
    <mi>ζ</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mn>2</mn>
     <mo stretchy="false">)</mo>
    </mrow>
    <mi>ζ</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mn>4</mn>
     <mo stretchy="false">)</mo>
    </mrow>
    <mi mathvariant="normal">⋯</mi>
    <mi>ζ</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>n</mi>
      <mo>-</mo>
      <mn>2</mn>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
    <msub>
     <mi>ζ</mi>
     <mi>D</mi>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>n</mi>
      <mo>/</mo>
      <mn>2</mn>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <ci>std</ci>
     <ci>f</ci>
    </apply>
    <apply>
     <times></times>
     <cn type="integer">2</cn>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>π</ci>
      <apply>
       <minus></minus>
       <apply>
        <divide></divide>
        <apply>
         <times></times>
         <ci>n</ci>
         <apply>
          <plus></plus>
          <ci>n</ci>
          <cn type="integer">1</cn>
         </apply>
        </apply>
        <cn type="integer">4</cn>
       </apply>
      </apply>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <csymbol cd="latexml">product</csymbol>
        <apply>
         <eq></eq>
         <ci>j</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <ci>n</ci>
      </apply>
      <apply>
       <times></times>
       <ci>normal-Γ</ci>
       <apply>
        <divide></divide>
        <ci>j</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
     </apply>
     <ci>ζ</ci>
     <cn type="integer">2</cn>
     <ci>ζ</ci>
     <cn type="integer">4</cn>
     <ci>normal-⋯</ci>
     <ci>ζ</ci>
     <apply>
      <minus></minus>
      <ci>n</ci>
      <cn type="integer">2</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>ζ</ci>
      <ci>D</ci>
     </apply>
     <apply>
      <divide></divide>
      <ci>n</ci>
      <cn type="integer">2</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \operatorname{std}(f)=2\pi^{-n(n+1)/4}\left(\prod_{j=1}^{n}\Gamma(j/2)\right)%
\zeta(2)\zeta(4)\cdots\zeta(n-2)\zeta_{D}(n/2)
  </annotation>
 </semantics>
</math>

 (For <em>n</em> even)</p>

<p>where</p>

<p>

<math display="block" id="Smith–Minkowski–Siegel_mass_formula:9">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>ζ</mi>
     <mi>D</mi>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>s</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <munder>
     <mo largeop="true" movablelimits="false" symmetric="true">∏</mo>
     <mi>p</mi>
    </munder>
    <mfrac>
     <mn>1</mn>
     <mrow>
      <mn>1</mn>
      <mo>-</mo>
      <mrow>
       <mrow>
        <mo>(</mo>
        <mstyle scriptlevel="+1">
         <mtable columnspacing="0.4em" rowspacing="0.2ex">
          <mtr>
           <mtd>
            <mi>D</mi>
           </mtd>
          </mtr>
          <mtr>
           <mtd>
            <mi>p</mi>
           </mtd>
          </mtr>
         </mtable>
        </mstyle>
        <mo>)</mo>
       </mrow>
       <msup>
        <mi>p</mi>
        <mrow>
         <mo>-</mo>
         <mi>s</mi>
        </mrow>
       </msup>
      </mrow>
     </mrow>
    </mfrac>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>ζ</ci>
      <ci>D</ci>
     </apply>
     <ci>s</ci>
    </apply>
    <apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <csymbol cd="latexml">product</csymbol>
      <ci>p</ci>
     </apply>
     <apply>
      <divide></divide>
      <cn type="integer">1</cn>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="latexml">binomial</csymbol>
         <ci>D</ci>
         <ci>p</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>p</ci>
         <apply>
          <minus></minus>
          <ci>s</ci>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \zeta_{D}(s)=\prod_{p}{1\over 1-{D\choose p}p^{-s}}
  </annotation>
 </semantics>
</math>

</p>
<dl>
<dd><em>D</em> = (−1)<sup><em>n</em>/2</sup> det(<em>ƒ</em>)
</dd>
</dl>

<p>The values of the <a href="Riemann_zeta_function" title="wikilink">Riemann zeta function</a> for an even integers <em>s</em> are given in terms of <a href="Bernoulli_number" title="wikilink">Bernoulli numbers</a> by</p>

<p>

<math display="block" id="Smith–Minkowski–Siegel_mass_formula:10">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>ζ</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>s</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mfrac>
      <msup>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mn>2</mn>
         <mi>π</mi>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
       <mi>s</mi>
      </msup>
      <mrow>
       <mn>2</mn>
       <mo>×</mo>
       <mrow>
        <mi>s</mi>
        <mo lspace="0pt" rspace="3.5pt">!</mo>
       </mrow>
      </mrow>
     </mfrac>
     <mrow>
      <mo stretchy="false">|</mo>
      <msub>
       <mi>B</mi>
       <mi>s</mi>
      </msub>
      <mo stretchy="false">|</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>ζ</ci>
     <ci>s</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <divide></divide>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <times></times>
        <cn type="integer">2</cn>
        <ci>π</ci>
       </apply>
       <ci>s</ci>
      </apply>
      <apply>
       <times></times>
       <cn type="integer">2</cn>
       <apply>
        <factorial></factorial>
        <ci>s</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <abs></abs>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>B</ci>
       <ci>s</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \zeta(s)={(2\pi)^{s}\over 2\times s!}|B_{s}|.
  </annotation>
 </semantics>
</math>

</p>

<p>So the mass of <em>ƒ</em> is given as a finite product of rational numbers as</p>

<p>

<math display="block" id="Smith–Minkowski–Siegel_mass_formula:11">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>m</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>f</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mo>std</mo>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>f</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mrow>
      <munder>
       <mo largeop="true" movablelimits="false" symmetric="true">∏</mo>
       <mrow>
        <mi>p</mi>
        <mo stretchy="false">|</mo>
        <mn>2</mn>
        <mo>det</mo>
        <mrow>
         <mo stretchy="false">(</mo>
         <mi>f</mi>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
      </munder>
      <mfrac>
       <mrow>
        <msub>
         <mi>m</mi>
         <mi>p</mi>
        </msub>
        <mrow>
         <mo stretchy="false">(</mo>
         <mi>f</mi>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
       <mrow>
        <msub>
         <mo>std</mo>
         <mi>p</mi>
        </msub>
        <mrow>
         <mo stretchy="false">(</mo>
         <mi>f</mi>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
      </mfrac>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>m</ci>
     <ci>f</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <ci>std</ci>
      <ci>f</ci>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <csymbol cd="latexml">product</csymbol>
       <cerror>
        <csymbol cd="ambiguous">fragments</csymbol>
        <csymbol cd="unknown">p</csymbol>
        <ci>normal-|</ci>
        <cn type="integer">2</cn>
        <determinant></determinant>
        <cerror>
         <csymbol cd="ambiguous">fragments</csymbol>
         <ci>normal-(</ci>
         <csymbol cd="unknown">f</csymbol>
         <ci>normal-)</ci>
        </cerror>
       </cerror>
      </apply>
      <apply>
       <divide></divide>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>m</ci>
         <ci>p</ci>
        </apply>
        <ci>f</ci>
       </apply>
       <apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>std</ci>
         <ci>p</ci>
        </apply>
        <ci>f</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   m(f)=\operatorname{std}(f)\prod_{p|2\det(f)}{m_{p}(f)\over\operatorname{std}_{%
p}(f)}.
  </annotation>
 </semantics>
</math>

</p>
<h2 id="evaluation-of-the-p-mass">Evaluation of the <em>p</em>-mass</h2>

<p>If the form <em>f</em> has a p-adic Jordan decomposition</p>

<p>

<math display="block" id="Smith–Minkowski–Siegel_mass_formula:12">
 <semantics>
  <mrow>
   <mi>f</mi>
   <mo>=</mo>
   <mrow>
    <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
    <mrow>
     <mi>q</mi>
     <msub>
      <mi>f</mi>
      <mi>q</mi>
     </msub>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>f</ci>
    <apply>
     <sum></sum>
     <apply>
      <times></times>
      <ci>q</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>f</ci>
       <ci>q</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f=\sum qf_{q}
  </annotation>
 </semantics>
</math>

</p>

<p>where <em>q</em> runs through powers of <em>p</em> and <em>f</em><sub><em>q</em></sub> has determinant prime to <em>p</em> and dimension <em>n</em>(<em>q</em>), then the <em>p</em>-mass is given by</p>

<p>

<math display="block" id="Smith–Minkowski–Siegel_mass_formula:13">
 <semantics>
  <mfrac>
   <mn>1</mn>
   <mrow>
    <mn>2</mn>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mn>1</mn>
      <mo>-</mo>
      <msup>
       <mi>p</mi>
       <mrow>
        <mo>-</mo>
        <mn>2</mn>
       </mrow>
      </msup>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mn>1</mn>
      <mo>-</mo>
      <msup>
       <mi>p</mi>
       <mrow>
        <mo>-</mo>
        <mn>4</mn>
       </mrow>
      </msup>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
    <mi mathvariant="normal">⋯</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mn>1</mn>
      <mo>-</mo>
      <msup>
       <mi>p</mi>
       <mrow>
        <mn>2</mn>
        <mo>-</mo>
        <mi>n</mi>
       </mrow>
      </msup>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mn>1</mn>
      <mo>-</mo>
      <msup>
       <mi>p</mi>
       <mrow>
        <mo>-</mo>
        <mrow>
         <mi>n</mi>
         <mo>/</mo>
         <mn>2</mn>
        </mrow>
       </mrow>
      </msup>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mfrac>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <divide></divide>
    <cn type="integer">1</cn>
    <apply>
     <times></times>
     <cn type="integer">2</cn>
     <apply>
      <minus></minus>
      <cn type="integer">1</cn>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>p</ci>
       <apply>
        <minus></minus>
        <cn type="integer">2</cn>
       </apply>
      </apply>
     </apply>
     <apply>
      <minus></minus>
      <cn type="integer">1</cn>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>p</ci>
       <apply>
        <minus></minus>
        <cn type="integer">4</cn>
       </apply>
      </apply>
     </apply>
     <ci>normal-⋯</ci>
     <apply>
      <minus></minus>
      <cn type="integer">1</cn>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>p</ci>
       <apply>
        <minus></minus>
        <cn type="integer">2</cn>
        <ci>n</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <minus></minus>
      <cn type="integer">1</cn>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>p</ci>
       <apply>
        <minus></minus>
        <apply>
         <divide></divide>
         <ci>n</ci>
         <cn type="integer">2</cn>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   {1\over 2(1-p^{-2})(1-p^{-4})\cdots(1-p^{2-n})(1-p^{-n/2})}
  </annotation>
 </semantics>
</math>

</p>

<p>when <em>n</em> is odd, or</p>

<p>

<math display="block" id="Smith–Minkowski–Siegel_mass_formula:14">
 <semantics>
  <mfrac>
   <mn>1</mn>
   <mrow>
    <mn>2</mn>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mn>1</mn>
      <mo>-</mo>
      <msup>
       <mi>p</mi>
       <mrow>
        <mo>-</mo>
        <mn>2</mn>
       </mrow>
      </msup>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mn>1</mn>
      <mo>-</mo>
      <msup>
       <mi>p</mi>
       <mrow>
        <mo>-</mo>
        <mn>4</mn>
       </mrow>
      </msup>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
    <mi mathvariant="normal">⋯</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mn>1</mn>
      <mo>-</mo>
      <msup>
       <mi>p</mi>
       <mrow>
        <mn>2</mn>
        <mo>-</mo>
        <mi>n</mi>
       </mrow>
      </msup>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mn>1</mn>
      <mo>+</mo>
      <msup>
       <mi>p</mi>
       <mrow>
        <mo>-</mo>
        <mrow>
         <mi>n</mi>
         <mo>/</mo>
         <mn>2</mn>
        </mrow>
       </mrow>
      </msup>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mfrac>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <divide></divide>
    <cn type="integer">1</cn>
    <apply>
     <times></times>
     <cn type="integer">2</cn>
     <apply>
      <minus></minus>
      <cn type="integer">1</cn>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>p</ci>
       <apply>
        <minus></minus>
        <cn type="integer">2</cn>
       </apply>
      </apply>
     </apply>
     <apply>
      <minus></minus>
      <cn type="integer">1</cn>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>p</ci>
       <apply>
        <minus></minus>
        <cn type="integer">4</cn>
       </apply>
      </apply>
     </apply>
     <ci>normal-⋯</ci>
     <apply>
      <minus></minus>
      <cn type="integer">1</cn>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>p</ci>
       <apply>
        <minus></minus>
        <cn type="integer">2</cn>
        <ci>n</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <plus></plus>
      <cn type="integer">1</cn>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>p</ci>
       <apply>
        <minus></minus>
        <apply>
         <divide></divide>
         <ci>n</ci>
         <cn type="integer">2</cn>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   {1\over 2(1-p^{-2})(1-p^{-4})\cdots(1-p^{2-n})(1+p^{-n/2})}
  </annotation>
 </semantics>
</math>

</p>

<p>when <em>n</em> is even and (−1)<sup><em>n</em>/2</sup><em>d</em><sub><em>q</em></sub> is a quadratic residue. or</p>

<p>

<math display="block" id="Smith–Minkowski–Siegel_mass_formula:15">
 <semantics>
  <mfrac>
   <mn>1</mn>
   <mrow>
    <mn>2</mn>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mn>1</mn>
      <mo>-</mo>
      <msup>
       <mi>p</mi>
       <mrow>
        <mo>-</mo>
        <mn>2</mn>
       </mrow>
      </msup>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mn>1</mn>
      <mo>-</mo>
      <msup>
       <mi>p</mi>
       <mrow>
        <mo>-</mo>
        <mn>4</mn>
       </mrow>
      </msup>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
    <mi mathvariant="normal">⋯</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mn>1</mn>
      <mo>-</mo>
      <msup>
       <mi>p</mi>
       <mrow>
        <mo>-</mo>
        <mrow>
         <mn>2</mn>
         <mi>t</mi>
        </mrow>
       </mrow>
      </msup>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mfrac>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <divide></divide>
    <cn type="integer">1</cn>
    <apply>
     <times></times>
     <cn type="integer">2</cn>
     <apply>
      <minus></minus>
      <cn type="integer">1</cn>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>p</ci>
       <apply>
        <minus></minus>
        <cn type="integer">2</cn>
       </apply>
      </apply>
     </apply>
     <apply>
      <minus></minus>
      <cn type="integer">1</cn>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>p</ci>
       <apply>
        <minus></minus>
        <cn type="integer">4</cn>
       </apply>
      </apply>
     </apply>
     <ci>normal-⋯</ci>
     <apply>
      <minus></minus>
      <cn type="integer">1</cn>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>p</ci>
       <apply>
        <minus></minus>
        <apply>
         <times></times>
         <cn type="integer">2</cn>
         <ci>t</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   {1\over 2(1-p^{-2})(1-p^{-4})\cdots(1-p^{-2t})}
  </annotation>
 </semantics>
</math>

</p>

<p>when <em>n</em> is even and (−1)<sup><em>n</em>/2</sup><em>d</em><sub><em>q</em></sub> is a quadratic nonresidue.</p>

<p>For <em>p</em> = 2 the diagonal factor <em>M</em><sub><em>p</em></sub>(<em>f</em><sub><em>q</em></sub>) is notoriously tricky to calculate. (The notation is misleading as it depends not only on <em>f</em><sub><em>q</em></sub> but also on <em>f</em><sub>2<em>q</em></sub> and <em>f</em><sub><em>q</em>/2</sub>.)</p>
<ul>
<li>We say that <em>f</em><sub><em>q</em></sub> is <strong>odd</strong> if it represents an odd 2-adic integer, and <strong>even</strong> otherwise.</li>
<li>The <strong>octane value</strong> of <em>f</em><sub><em>q</em></sub> is an integer mod 8; if <em>f</em><sub><em>q</em></sub> is even its octane value is 0 if the determinant is +1 or −1 mod 8, and is 4 if the determinant is +3 or −3 mod 8, while if <em>f</em><sub><em>q</em></sub> is odd it can be diagonalized and its octane value is then the number of diagonal entries that are 1 mod 4 minus the number that are 3 mod 4.</li>
<li>We say that <em>f</em><sub><em>q</em></sub> is <strong>bound</strong> if at least one of <em>f</em><sub>2<em>q</em></sub> and <em>f</em><sub><em>q</em>/2</sub> is odd, and say it is <strong>free</strong> otherwise.</li>
<li>The integer <em>t</em> is defined so that the dimension of <em>f</em><sub><em>q</em></sub> is 2<em>t</em> if <em>f</em><sub><em>q</em></sub> is even, and 2<em>t</em> + 1 or 2<em>t</em> + 2 if <em>f</em><sub><em>q</em></sub> is odd.</li>
</ul>

<p>Then the diagonal factor <em>M</em><sub><em>p</em></sub>(<em>f</em><sub><em>q</em></sub>) is given as follows.</p>

<p>

<math display="block" id="Smith–Minkowski–Siegel_mass_formula:16">
 <semantics>
  <mfrac>
   <mn>1</mn>
   <mrow>
    <mn>2</mn>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mn>1</mn>
      <mo>-</mo>
      <msup>
       <mi>p</mi>
       <mrow>
        <mo>-</mo>
        <mn>2</mn>
       </mrow>
      </msup>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mn>1</mn>
      <mo>-</mo>
      <msup>
       <mi>p</mi>
       <mrow>
        <mo>-</mo>
        <mn>4</mn>
       </mrow>
      </msup>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
    <mi mathvariant="normal">⋯</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mn>1</mn>
      <mo>-</mo>
      <msup>
       <mi>p</mi>
       <mrow>
        <mn>2</mn>
        <mo>-</mo>
        <mrow>
         <mn>2</mn>
         <mi>t</mi>
        </mrow>
       </mrow>
      </msup>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mn>1</mn>
      <mo>-</mo>
      <msup>
       <mi>p</mi>
       <mrow>
        <mo>-</mo>
        <mi>t</mi>
       </mrow>
      </msup>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mfrac>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <divide></divide>
    <cn type="integer">1</cn>
    <apply>
     <times></times>
     <cn type="integer">2</cn>
     <apply>
      <minus></minus>
      <cn type="integer">1</cn>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>p</ci>
       <apply>
        <minus></minus>
        <cn type="integer">2</cn>
       </apply>
      </apply>
     </apply>
     <apply>
      <minus></minus>
      <cn type="integer">1</cn>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>p</ci>
       <apply>
        <minus></minus>
        <cn type="integer">4</cn>
       </apply>
      </apply>
     </apply>
     <ci>normal-⋯</ci>
     <apply>
      <minus></minus>
      <cn type="integer">1</cn>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>p</ci>
       <apply>
        <minus></minus>
        <cn type="integer">2</cn>
        <apply>
         <times></times>
         <cn type="integer">2</cn>
         <ci>t</ci>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <minus></minus>
      <cn type="integer">1</cn>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>p</ci>
       <apply>
        <minus></minus>
        <ci>t</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   {1\over 2(1-p^{-2})(1-p^{-4})\cdots(1-p^{2-2t})(1-p^{-t})}
  </annotation>
 </semantics>
</math>

</p>

<p>when the form is bound or has octane value +2 or −2 mod 8 or</p>

<p>

<math display="block" id="Smith–Minkowski–Siegel_mass_formula:17">
 <semantics>
  <mfrac>
   <mn>1</mn>
   <mrow>
    <mn>2</mn>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mn>1</mn>
      <mo>-</mo>
      <msup>
       <mi>p</mi>
       <mrow>
        <mo>-</mo>
        <mn>2</mn>
       </mrow>
      </msup>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mn>1</mn>
      <mo>-</mo>
      <msup>
       <mi>p</mi>
       <mrow>
        <mo>-</mo>
        <mn>4</mn>
       </mrow>
      </msup>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
    <mi mathvariant="normal">⋯</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mn>1</mn>
      <mo>-</mo>
      <msup>
       <mi>p</mi>
       <mrow>
        <mn>2</mn>
        <mo>-</mo>
        <mrow>
         <mn>2</mn>
         <mi>t</mi>
        </mrow>
       </mrow>
      </msup>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mn>1</mn>
      <mo>+</mo>
      <msup>
       <mi>p</mi>
       <mrow>
        <mo>-</mo>
        <mi>t</mi>
       </mrow>
      </msup>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mfrac>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <divide></divide>
    <cn type="integer">1</cn>
    <apply>
     <times></times>
     <cn type="integer">2</cn>
     <apply>
      <minus></minus>
      <cn type="integer">1</cn>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>p</ci>
       <apply>
        <minus></minus>
        <cn type="integer">2</cn>
       </apply>
      </apply>
     </apply>
     <apply>
      <minus></minus>
      <cn type="integer">1</cn>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>p</ci>
       <apply>
        <minus></minus>
        <cn type="integer">4</cn>
       </apply>
      </apply>
     </apply>
     <ci>normal-⋯</ci>
     <apply>
      <minus></minus>
      <cn type="integer">1</cn>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>p</ci>
       <apply>
        <minus></minus>
        <cn type="integer">2</cn>
        <apply>
         <times></times>
         <cn type="integer">2</cn>
         <ci>t</ci>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <plus></plus>
      <cn type="integer">1</cn>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>p</ci>
       <apply>
        <minus></minus>
        <ci>t</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   {1\over 2(1-p^{-2})(1-p^{-4})\cdots(1-p^{2-2t})(1+p^{-t})}
  </annotation>
 </semantics>
</math>

</p>

<p>when the form is free and has octane value −1 or 0 or 1 mod 8 or</p>

<p>

<math display="inline" id="Smith–Minkowski–Siegel_mass_formula:18">
 <semantics>
  <mrow>
   <mo>(</mo>
   <mstyle scriptlevel="+1">
    <mtable columnspacing="0.4em" rowspacing="0.2ex">
     <mtr>
      <mtd>
       <mi>D</mi>
      </mtd>
     </mtr>
     <mtr>
      <mtd>
       <mi>m</mi>
      </mtd>
     </mtr>
    </mtable>
   </mstyle>
   <mo>)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">binomial</csymbol>
    <ci>D</ci>
    <ci>m</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   {D\choose m}
  </annotation>
 </semantics>
</math>


</p>

<p>when the form is free and has octane value −3 or 3 or 4 mod 8.</p>
<h2 id="evaluation-of-ζds">Evaluation of ζ<sub><em>D</em></sub>(<em>s</em>)</h2>

<p>The required values of the Dirichlet series ζ<sub><em>D</em></sub>(<em>s</em>) can be evaluated as follows. We write χ for the <a href="Dirichlet_character" title="wikilink">Dirichlet character</a> with χ(<em>m</em>) given by 0 if <em>m</em> is even, and the <a href="Jacobi_symbol" title="wikilink">Jacobi symbol</a> 

<math display="block" id="Smith–Minkowski–Siegel_mass_formula:19">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>ζ</mi>
     <mi>D</mi>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>s</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mi>L</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>s</mi>
     <mo>,</mo>
     <mi>χ</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mi>L</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>s</mi>
     <mo>,</mo>
     <mi>ψ</mi>
     <mo stretchy="false">)</mo>
    </mrow>
    <mrow>
     <munder>
      <mo largeop="true" movablelimits="false" symmetric="true">∏</mo>
      <mrow>
       <mi>p</mi>
       <mo stretchy="false">|</mo>
       <mi>k</mi>
      </mrow>
     </munder>
     <mrow>
      <mo>(</mo>
      <mrow>
       <mn>1</mn>
       <mo>-</mo>
       <mfrac>
        <mrow>
         <mi>ψ</mi>
         <mrow>
          <mo stretchy="false">(</mo>
          <mi>p</mi>
          <mo stretchy="false">)</mo>
         </mrow>
        </mrow>
        <msup>
         <mi>p</mi>
         <mi>s</mi>
        </msup>
       </mfrac>
      </mrow>
      <mo>)</mo>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>ζ</ci>
       <ci>D</ci>
      </apply>
      <ci>s</ci>
     </apply>
     <apply>
      <times></times>
      <ci>L</ci>
      <interval closure="open">
       <ci>s</ci>
       <ci>χ</ci>
      </interval>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <ci>L</ci>
      <interval closure="open">
       <ci>s</ci>
       <ci>ψ</ci>
      </interval>
      <apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <csymbol cd="latexml">product</csymbol>
        <cerror>
         <csymbol cd="ambiguous">fragments</csymbol>
         <csymbol cd="unknown">p</csymbol>
         <ci>normal-|</ci>
         <csymbol cd="unknown">k</csymbol>
        </cerror>
       </apply>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
        <apply>
         <divide></divide>
         <apply>
          <times></times>
          <ci>ψ</ci>
          <ci>p</ci>
         </apply>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>p</ci>
          <ci>s</ci>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \zeta_{D}(s)=L(s,\chi)=L(s,\psi)\prod_{p|k}\left(1-{\psi(p)\over p^{s}}\right)
  </annotation>
 </semantics>
</math>

 is <em>m</em> is odd. We write <em>k</em> for the modulus of this character and <em>k</em><sub>1</sub> for its conductor, and put χ = χ<sub>1</sub>ψ where χ<sub>1</sub> is the principal character mod <em>k</em> and ψ is a primitive character mod <em>k</em><sub>1</sub>. Then</p>

<p>

<math display="block" id="Smith–Minkowski–Siegel_mass_formula:20">
 <semantics>
  <mrow>
   <mrow>
    <mi>L</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mn>1</mn>
      <mo>-</mo>
      <mi>s</mi>
     </mrow>
     <mo>,</mo>
     <mi>ψ</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mfrac>
     <mrow>
      <msubsup>
       <mi>k</mi>
       <mn>1</mn>
       <mrow>
        <mi>s</mi>
        <mo>-</mo>
        <mn>1</mn>
       </mrow>
      </msubsup>
      <mi mathvariant="normal">Γ</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>s</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <msup>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mn>2</mn>
        <mi>π</mi>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
      <mi>s</mi>
     </msup>
    </mfrac>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <msup>
       <mi>i</mi>
       <mrow>
        <mo>-</mo>
        <mi>s</mi>
       </mrow>
      </msup>
      <mo>+</mo>
      <mrow>
       <mi>ψ</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mo>-</mo>
         <mn>1</mn>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
       <msup>
        <mi>i</mi>
        <mi>s</mi>
       </msup>
      </mrow>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
    <mi>G</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>ψ</mi>
     <mo stretchy="false">)</mo>
    </mrow>
    <mi>L</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>s</mi>
     <mo>,</mo>
     <mi>ψ</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>L</ci>
     <interval closure="open">
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
       <ci>s</ci>
      </apply>
      <ci>ψ</ci>
     </interval>
    </apply>
    <apply>
     <times></times>
     <apply>
      <divide></divide>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>k</ci>
         <cn type="integer">1</cn>
        </apply>
        <apply>
         <minus></minus>
         <ci>s</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <ci>normal-Γ</ci>
       <ci>s</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <times></times>
        <cn type="integer">2</cn>
        <ci>π</ci>
       </apply>
       <ci>s</ci>
      </apply>
     </apply>
     <apply>
      <plus></plus>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>i</ci>
       <apply>
        <minus></minus>
        <ci>s</ci>
       </apply>
      </apply>
      <apply>
       <times></times>
       <ci>ψ</ci>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>i</ci>
        <ci>s</ci>
       </apply>
      </apply>
     </apply>
     <ci>G</ci>
     <ci>ψ</ci>
     <ci>L</ci>
     <interval closure="open">
      <ci>s</ci>
      <ci>ψ</ci>
     </interval>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   L(1-s,\psi)={k_{1}^{s-1}\Gamma(s)\over(2\pi)^{s}}(i^{-s}+\psi(-1)i^{s})G(\psi)%
L(s,\psi)
  </annotation>
 </semantics>
</math>

</p>

<p>The functional equation for the L-series is</p>

<p>

<math display="block" id="Smith–Minkowski–Siegel_mass_formula:21">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>G</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>ψ</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <munderover>
      <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
      <mrow>
       <mi>r</mi>
       <mo>=</mo>
       <mn>1</mn>
      </mrow>
      <msub>
       <mi>k</mi>
       <mn>1</mn>
      </msub>
     </munderover>
     <mrow>
      <mi>ψ</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>r</mi>
       <mo stretchy="false">)</mo>
      </mrow>
      <msup>
       <mi>e</mi>
       <mrow>
        <mrow>
         <mn>2</mn>
         <mi>π</mi>
         <mi>i</mi>
         <mi>r</mi>
        </mrow>
        <mo>/</mo>
        <msub>
         <mi>k</mi>
         <mn>1</mn>
        </msub>
       </mrow>
      </msup>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>G</ci>
     <ci>ψ</ci>
    </apply>
    <apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <apply>
        <eq></eq>
        <ci>r</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>k</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <apply>
      <times></times>
      <ci>ψ</ci>
      <ci>r</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>e</ci>
       <apply>
        <divide></divide>
        <apply>
         <times></times>
         <cn type="integer">2</cn>
         <ci>π</ci>
         <ci>i</ci>
         <ci>r</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>k</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   G(\psi)=\sum_{r=1}^{k_{1}}\psi(r)e^{2\pi ir/k_{1}}.
  </annotation>
 </semantics>
</math>

</p>

<p>where <em>G</em> is the <a href="Gauss_sum" title="wikilink">Gauss sum</a></p>

<p>

<math display="block" id="Smith–Minkowski–Siegel_mass_formula:22">
 <semantics>
  <mrow>
   <mrow>
    <mi>L</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mn>1</mn>
      <mo>-</mo>
      <mi>s</mi>
     </mrow>
     <mo>,</mo>
     <mi>ψ</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mo>-</mo>
    <mrow>
     <mfrac>
      <msubsup>
       <mi>k</mi>
       <mn>1</mn>
       <mrow>
        <mi>s</mi>
        <mo>-</mo>
        <mn>1</mn>
       </mrow>
      </msubsup>
      <mi>s</mi>
     </mfrac>
     <mrow>
      <munderover>
       <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
       <mrow>
        <mi>r</mi>
        <mo>=</mo>
        <mn>1</mn>
       </mrow>
       <msub>
        <mi>k</mi>
        <mn>1</mn>
       </msub>
      </munderover>
      <mrow>
       <mi>ψ</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>r</mi>
        <mo stretchy="false">)</mo>
       </mrow>
       <msub>
        <mi>B</mi>
        <mi>s</mi>
       </msub>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mi>r</mi>
         <mo>/</mo>
         <msub>
          <mi>k</mi>
          <mn>1</mn>
         </msub>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>L</ci>
     <interval closure="open">
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
       <ci>s</ci>
      </apply>
      <ci>ψ</ci>
     </interval>
    </apply>
    <apply>
     <minus></minus>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>k</ci>
         <cn type="integer">1</cn>
        </apply>
        <apply>
         <minus></minus>
         <ci>s</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <ci>s</ci>
      </apply>
      <apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <sum></sum>
         <apply>
          <eq></eq>
          <ci>r</ci>
          <cn type="integer">1</cn>
         </apply>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>k</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <apply>
        <times></times>
        <ci>ψ</ci>
        <ci>r</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>B</ci>
         <ci>s</ci>
        </apply>
        <apply>
         <divide></divide>
         <ci>r</ci>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>k</ci>
          <cn type="integer">1</cn>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   L(1-s,\psi)=-{k_{1}^{s-1}\over s}\sum_{r=1}^{k_{1}}\psi(r)B_{s}(r/k_{1})
  </annotation>
 </semantics>
</math>

</p>

<p>If <em>s</em> is a positive integer then</p>

<p>

<math display="block" id="Smith–Minkowski–Siegel_mass_formula:23">
 <semantics>
  <mrow>
   <mrow>
    <munder>
     <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
     <mi mathvariant="normal">Λ</mi>
    </munder>
    <mfrac>
     <mn>1</mn>
     <mrow>
      <mo stretchy="false">|</mo>
      <mrow>
       <mo>Aut</mo>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi mathvariant="normal">Λ</mi>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
      <mo stretchy="false">|</mo>
     </mrow>
    </mfrac>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mfrac>
     <mrow>
      <mo stretchy="false">|</mo>
      <msub>
       <mi>B</mi>
       <mrow>
        <mi>n</mi>
        <mo>/</mo>
        <mn>2</mn>
       </mrow>
      </msub>
      <mo stretchy="false">|</mo>
     </mrow>
     <mi>n</mi>
    </mfrac>
    <mrow>
     <munder>
      <mo largeop="true" movablelimits="false" symmetric="true">∏</mo>
      <mrow>
       <mn>1</mn>
       <mo>≤</mo>
       <mi>j</mi>
       <mo><</mo>
       <mrow>
        <mi>n</mi>
        <mo>/</mo>
        <mn>2</mn>
       </mrow>
      </mrow>
     </munder>
     <mfrac>
      <mrow>
       <mo stretchy="false">|</mo>
       <msub>
        <mi>B</mi>
        <mrow>
         <mn>2</mn>
         <mi>j</mi>
        </mrow>
       </msub>
       <mo stretchy="false">|</mo>
      </mrow>
      <mrow>
       <mn>4</mn>
       <mi>j</mi>
      </mrow>
     </mfrac>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <sum></sum>
      <ci>normal-Λ</ci>
     </apply>
     <apply>
      <divide></divide>
      <cn type="integer">1</cn>
      <apply>
       <abs></abs>
       <apply>
        <ci>Aut</ci>
        <ci>normal-Λ</ci>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <divide></divide>
      <apply>
       <abs></abs>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>B</ci>
        <apply>
         <divide></divide>
         <ci>n</ci>
         <cn type="integer">2</cn>
        </apply>
       </apply>
      </apply>
      <ci>n</ci>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <csymbol cd="latexml">product</csymbol>
       <apply>
        <and></and>
        <apply>
         <leq></leq>
         <cn type="integer">1</cn>
         <ci>j</ci>
        </apply>
        <apply>
         <lt></lt>
         <share href="#.cmml">
         </share>
         <apply>
          <divide></divide>
          <ci>n</ci>
          <cn type="integer">2</cn>
         </apply>
        </apply>
       </apply>
      </apply>
      <apply>
       <divide></divide>
       <apply>
        <abs></abs>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>B</ci>
         <apply>
          <times></times>
          <cn type="integer">2</cn>
          <ci>j</ci>
         </apply>
        </apply>
       </apply>
       <apply>
        <times></times>
        <cn type="integer">4</cn>
        <ci>j</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \sum_{\Lambda}{1\over|\operatorname{Aut}(\Lambda)|}={|B_{n/2}|\over n}\prod_{1%
\leq j<n/2}{|B_{2j}|\over 4j}
  </annotation>
 </semantics>
</math>

</p>

<p>where <em>B</em><sub><em>s</em></sub>(<em>x</em>) is a <a href="Bernoulli_polynomial" title="wikilink">Bernoulli polynomial</a>.</p>
<h2 id="examples">Examples</h2>

<p>For the case of even <a href="unimodular_lattice" title="wikilink">unimodular lattices</a> Λ of dimension <em>n</em> &gt; 0 divisible by 8 the mass formula is</p>

<p>

<math display="block" id="Smith–Minkowski–Siegel_mass_formula:24">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mfrac>
      <mrow>
       <mo stretchy="false">|</mo>
       <msub>
        <mi>B</mi>
        <mn>4</mn>
       </msub>
       <mo stretchy="false">|</mo>
      </mrow>
      <mn>8</mn>
     </mfrac>
     <mfrac>
      <mrow>
       <mo stretchy="false">|</mo>
       <msub>
        <mi>B</mi>
        <mn>2</mn>
       </msub>
       <mo stretchy="false">|</mo>
      </mrow>
      <mn>4</mn>
     </mfrac>
     <mfrac>
      <mrow>
       <mo stretchy="false">|</mo>
       <msub>
        <mi>B</mi>
        <mn>4</mn>
       </msub>
       <mo stretchy="false">|</mo>
      </mrow>
      <mn>8</mn>
     </mfrac>
     <mfrac>
      <mrow>
       <mo stretchy="false">|</mo>
       <msub>
        <mi>B</mi>
        <mn>6</mn>
       </msub>
       <mo stretchy="false">|</mo>
      </mrow>
      <mn>12</mn>
     </mfrac>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mpadded width="+2.8pt">
      <mfrac>
       <mrow>
        <mn>1</mn>
        <mo>/</mo>
        <mn>30</mn>
       </mrow>
       <mn>8</mn>
      </mfrac>
     </mpadded>
     <mpadded width="+2.8pt">
      <mfrac>
       <mrow>
        <mn>1</mn>
        <mo>/</mo>
        <mn>6</mn>
       </mrow>
       <mn>4</mn>
      </mfrac>
     </mpadded>
     <mpadded width="+2.8pt">
      <mfrac>
       <mrow>
        <mn>1</mn>
        <mo>/</mo>
        <mn>30</mn>
       </mrow>
       <mn>8</mn>
      </mfrac>
     </mpadded>
     <mfrac>
      <mrow>
       <mn>1</mn>
       <mo>/</mo>
       <mn>42</mn>
      </mrow>
      <mn>12</mn>
     </mfrac>
    </mrow>
    <mo>=</mo>
    <mfrac>
     <mn>1</mn>
     <mn>696729600</mn>
    </mfrac>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <apply>
        <abs></abs>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>B</ci>
         <cn type="integer">4</cn>
        </apply>
       </apply>
       <cn type="integer">8</cn>
      </apply>
      <apply>
       <divide></divide>
       <apply>
        <abs></abs>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>B</ci>
         <cn type="integer">2</cn>
        </apply>
       </apply>
       <cn type="integer">4</cn>
      </apply>
      <apply>
       <divide></divide>
       <apply>
        <abs></abs>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>B</ci>
         <cn type="integer">4</cn>
        </apply>
       </apply>
       <cn type="integer">8</cn>
      </apply>
      <apply>
       <divide></divide>
       <apply>
        <abs></abs>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>B</ci>
         <cn type="integer">6</cn>
        </apply>
       </apply>
       <cn type="integer">12</cn>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <apply>
        <divide></divide>
        <cn type="integer">1</cn>
        <cn type="integer">30</cn>
       </apply>
       <cn type="integer">8</cn>
      </apply>
      <apply>
       <divide></divide>
       <apply>
        <divide></divide>
        <cn type="integer">1</cn>
        <cn type="integer">6</cn>
       </apply>
       <cn type="integer">4</cn>
      </apply>
      <apply>
       <divide></divide>
       <apply>
        <divide></divide>
        <cn type="integer">1</cn>
        <cn type="integer">30</cn>
       </apply>
       <cn type="integer">8</cn>
      </apply>
      <apply>
       <divide></divide>
       <apply>
        <divide></divide>
        <cn type="integer">1</cn>
        <cn type="integer">42</cn>
       </apply>
       <cn type="integer">12</cn>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <divide></divide>
      <cn type="integer">1</cn>
      <cn type="integer">696729600</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   {|B_{4}|\over 8}{|B_{2}|\over 4}{|B_{4}|\over 8}{|B_{6}|\over 12}={1/30\over 8%
}\;{1/6\over 4}\;{1/30\over 8}\;{1/42\over 12}={1\over 696729600}.
  </annotation>
 </semantics>
</math>

</p>

<p>where <em>B</em><sub><em>k</em></sub> is a <a href="Bernoulli_number" title="wikilink">Bernoulli number</a>.</p>

<p>===Dimension <em>n</em> = 0=== The formula above fails for <em>n</em> = 0, and in general the mass formula needs to be modified in the trivial cases when the dimension is at most 1. For <em>n</em> = 0 there is just one lattice, the zero lattice, of weight 1, so the total mass is 1.</p>

<p>===Dimension <em>n</em> = 8=== The mass formula gives the total mass as</p>

<p>

<math display="block" id="Smith–Minkowski–Siegel_mass_formula:25">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mfrac>
      <mrow>
       <mo stretchy="false">|</mo>
       <msub>
        <mi>B</mi>
        <mn>8</mn>
       </msub>
       <mo stretchy="false">|</mo>
      </mrow>
      <mn>16</mn>
     </mfrac>
     <mfrac>
      <mrow>
       <mo stretchy="false">|</mo>
       <msub>
        <mi>B</mi>
        <mn>2</mn>
       </msub>
       <mo stretchy="false">|</mo>
      </mrow>
      <mn>4</mn>
     </mfrac>
     <mfrac>
      <mrow>
       <mo stretchy="false">|</mo>
       <msub>
        <mi>B</mi>
        <mn>4</mn>
       </msub>
       <mo stretchy="false">|</mo>
      </mrow>
      <mn>8</mn>
     </mfrac>
     <mfrac>
      <mrow>
       <mo stretchy="false">|</mo>
       <msub>
        <mi>B</mi>
        <mn>6</mn>
       </msub>
       <mo stretchy="false">|</mo>
      </mrow>
      <mn>12</mn>
     </mfrac>
     <mfrac>
      <mrow>
       <mo stretchy="false">|</mo>
       <msub>
        <mi>B</mi>
        <mn>8</mn>
       </msub>
       <mo stretchy="false">|</mo>
      </mrow>
      <mn>16</mn>
     </mfrac>
     <mfrac>
      <mrow>
       <mo stretchy="false">|</mo>
       <msub>
        <mi>B</mi>
        <mn>10</mn>
       </msub>
       <mo stretchy="false">|</mo>
      </mrow>
      <mn>20</mn>
     </mfrac>
     <mfrac>
      <mrow>
       <mo stretchy="false">|</mo>
       <msub>
        <mi>B</mi>
        <mn>12</mn>
       </msub>
       <mo stretchy="false">|</mo>
      </mrow>
      <mn>24</mn>
     </mfrac>
     <mfrac>
      <mrow>
       <mo stretchy="false">|</mo>
       <msub>
        <mi>B</mi>
        <mn>14</mn>
       </msub>
       <mo stretchy="false">|</mo>
      </mrow>
      <mn>28</mn>
     </mfrac>
    </mrow>
    <mo>=</mo>
    <mfrac>
     <mn>691</mn>
     <mn>277667181515243520000</mn>
    </mfrac>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <divide></divide>
      <apply>
       <abs></abs>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>B</ci>
        <cn type="integer">8</cn>
       </apply>
      </apply>
      <cn type="integer">16</cn>
     </apply>
     <apply>
      <divide></divide>
      <apply>
       <abs></abs>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>B</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
      <cn type="integer">4</cn>
     </apply>
     <apply>
      <divide></divide>
      <apply>
       <abs></abs>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>B</ci>
        <cn type="integer">4</cn>
       </apply>
      </apply>
      <cn type="integer">8</cn>
     </apply>
     <apply>
      <divide></divide>
      <apply>
       <abs></abs>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>B</ci>
        <cn type="integer">6</cn>
       </apply>
      </apply>
      <cn type="integer">12</cn>
     </apply>
     <apply>
      <divide></divide>
      <apply>
       <abs></abs>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>B</ci>
        <cn type="integer">8</cn>
       </apply>
      </apply>
      <cn type="integer">16</cn>
     </apply>
     <apply>
      <divide></divide>
      <apply>
       <abs></abs>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>B</ci>
        <cn type="integer">10</cn>
       </apply>
      </apply>
      <cn type="integer">20</cn>
     </apply>
     <apply>
      <divide></divide>
      <apply>
       <abs></abs>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>B</ci>
        <cn type="integer">12</cn>
       </apply>
      </apply>
      <cn type="integer">24</cn>
     </apply>
     <apply>
      <divide></divide>
      <apply>
       <abs></abs>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>B</ci>
        <cn type="integer">14</cn>
       </apply>
      </apply>
      <cn type="integer">28</cn>
     </apply>
    </apply>
    <apply>
     <divide></divide>
     <cn type="integer">691</cn>
     <cn type="integer">277667181515243520000</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   {|B_{8}|\over 16}{|B_{2}|\over 4}{|B_{4}|\over 8}{|B_{6}|\over 12}{|B_{8}|%
\over 16}{|B_{10}|\over 20}{|B_{12}|\over 24}{|B_{14}|\over 28}={691\over 2776%
67181515243520000}.
  </annotation>
 </semantics>
</math>

</p>

<p>There is exactly one even unimodular lattice of dimension 8, the <a href="E8_lattice" title="wikilink">E8 lattice</a>, whose automorphism group is the Weyl group of <em>E</em><sub>8</sub> of order 696729600, so this verifies the mass formula in this case. Smith originally gave a nonconstructive proof of the existence of an even unimodular lattice of dimension 8 using the fact that the mass is non-zero.</p>

<p>===Dimension <em>n</em> = 16=== The mass formula gives the total mass as</p>

<p>

<math display="block" id="Smith–Minkowski–Siegel_mass_formula:26">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mfrac>
      <mn>1</mn>
      <mn>970864271032320000</mn>
     </mfrac>
     <mo>+</mo>
     <mfrac>
      <mn>1</mn>
      <mn>685597979049984000</mn>
     </mfrac>
    </mrow>
    <mo>=</mo>
    <mfrac>
     <mn>691</mn>
     <mn>277667181515243520000</mn>
    </mfrac>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <plus></plus>
     <apply>
      <divide></divide>
      <cn type="integer">1</cn>
      <cn type="integer">970864271032320000</cn>
     </apply>
     <apply>
      <divide></divide>
      <cn type="integer">1</cn>
      <cn type="integer">685597979049984000</cn>
     </apply>
    </apply>
    <apply>
     <divide></divide>
     <cn type="integer">691</cn>
     <cn type="integer">277667181515243520000</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   {1\over 970864271032320000}+{1\over 685597979049984000}={691\over 277667181515%
243520000}.
  </annotation>
 </semantics>
</math>

 There are two even unimodular lattices of dimension 16, one with root system <em>E</em><sub>8</sub><sup>2</sup> and automorphism group of order 2×696729600<sup>2</sup> = 970864271032320000, and one with root system <em>D</em><sub>16</sub> and automorphism group of order 2<sup>15</sup>16! = 685597979049984000.</p>

<p>So the mass formula is</p>

<p><span class="LaTeX">$${1\over 970864271032320000} + {1\over 685597979049984000} = {691\over 277667181515243520000 }.$$</span></p>

<p>===Dimension <em>n</em> = 24=== There are 24 even unimodular lattices of dimension 24, called the <a href="Niemeier_lattice" title="wikilink">Niemeier lattices</a>. The mass formula for them is checked in .</p>

<p>===Dimension <em>n</em> = 32=== The mass in this case is large, more than 40 million. This implies that there are more than 80 million even unimodular lattices of dimension 32, as each has automorphism group of order at least 2 so contributes at most 1/2 to the mass. By refining this argument,  showed that there are more than a billion such lattices. In higher dimensions the mass, and hence the number of lattices, increases very rapidly.</p>
<h2 id="generalizations">Generalizations</h2>

<p>Siegel gave a more general formula that counts the weighted number of representations of one quadratic form by forms in some genus; the Smith–Minkowski–Siegel mass formula is the special case when one form is the zero form.</p>

<p>Tamagawa showed that the mass formula was equivalent to the statement that the <a href="Tamagawa_number" title="wikilink">Tamagawa number</a> of the orthogonal group is 2, which is equivalent to saying that the Tamagawa number of its simply connected cover the spin group is 1. <a href="André_Weil" title="wikilink">André Weil</a> conjectured more generally that <a href="Weil_conjecture_on_Tamagawa_numbers" title="wikilink">the Tamagawa number of any simply connected semisimple group is 1</a>, and this conjecture was proved by Kottwitz in 1988.</p>

<p>gave a mass formula for <a href="unimodular_lattice" title="wikilink">unimodular lattices</a> without roots (or with given root system).</p>
<h2 id="see-also">See also</h2>
<ul>
<li><a href="Siegel_identity" title="wikilink">Siegel identity</a></li>
</ul>
<h2 id="references">References</h2>
<ul>
<li></li>
<li></li>
<li></li>
<li>

<p>.</p></li>
<li></li>
<li></li>
<li></li>
<li></li>
</ul>

<p>"</p>

<p><a href="Category:Quadratic_forms" title="wikilink">Category:Quadratic forms</a></p>
</body>
</html>

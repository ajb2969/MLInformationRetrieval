<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="1597">Spouge's approximation</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Spouge's approximation</h1>
<hr/>

<p>In <a class="uri" href="mathematics" title="wikilink">mathematics</a>, <strong>Spouge's approximation</strong> is a formula for the <a href="gamma_function" title="wikilink">gamma function</a> due to John L. Spouge in 1994.<a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a> The formula is a modification of <a href="Stirling's_approximation" title="wikilink">Stirling's approximation</a>, and has the form</p>

<p>

<math display="block" id="Spouge's_approximation:0">
 <semantics>
  <mrow>
   <mrow>
    <mi mathvariant="normal">Γ</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>z</mi>
      <mo>+</mo>
      <mn>1</mn>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <msup>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mi>z</mi>
       <mo>+</mo>
       <mi>a</mi>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <mrow>
      <mi>z</mi>
      <mo>+</mo>
      <mrow>
       <mn>1</mn>
       <mo>/</mo>
       <mn>2</mn>
      </mrow>
     </mrow>
    </msup>
    <msup>
     <mi>e</mi>
     <mrow>
      <mo>-</mo>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mi>z</mi>
        <mo>+</mo>
        <mi>a</mi>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </msup>
    <mrow>
     <mo>[</mo>
     <mrow>
      <msub>
       <mi>c</mi>
       <mn>0</mn>
      </msub>
      <mo>+</mo>
      <mrow>
       <munderover>
        <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
        <mrow>
         <mi>k</mi>
         <mo>=</mo>
         <mn>1</mn>
        </mrow>
        <mrow>
         <mi>a</mi>
         <mo>-</mo>
         <mn>1</mn>
        </mrow>
       </munderover>
       <mfrac>
        <msub>
         <mi>c</mi>
         <mi>k</mi>
        </msub>
        <mrow>
         <mi>z</mi>
         <mo>+</mo>
         <mi>k</mi>
        </mrow>
       </mfrac>
      </mrow>
      <mo>+</mo>
      <mrow>
       <msub>
        <mi>ε</mi>
        <mi>a</mi>
       </msub>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>z</mi>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
     </mrow>
     <mo>]</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>normal-Γ</ci>
     <apply>
      <plus></plus>
      <ci>z</ci>
      <cn type="integer">1</cn>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <plus></plus>
       <ci>z</ci>
       <ci>a</ci>
      </apply>
      <apply>
       <plus></plus>
       <ci>z</ci>
       <apply>
        <divide></divide>
        <cn type="integer">1</cn>
        <cn type="integer">2</cn>
       </apply>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>e</ci>
      <apply>
       <minus></minus>
       <apply>
        <plus></plus>
        <ci>z</ci>
        <ci>a</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <csymbol cd="latexml">delimited-[]</csymbol>
      <apply>
       <plus></plus>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>c</ci>
        <cn type="integer">0</cn>
       </apply>
       <apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <sum></sum>
          <apply>
           <eq></eq>
           <ci>k</ci>
           <cn type="integer">1</cn>
          </apply>
         </apply>
         <apply>
          <minus></minus>
          <ci>a</ci>
          <cn type="integer">1</cn>
         </apply>
        </apply>
        <apply>
         <divide></divide>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>c</ci>
          <ci>k</ci>
         </apply>
         <apply>
          <plus></plus>
          <ci>z</ci>
          <ci>k</ci>
         </apply>
        </apply>
       </apply>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>ε</ci>
         <ci>a</ci>
        </apply>
        <ci>z</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Gamma(z+1)=(z+a)^{z+1/2}e^{-(z+a)}\left[c_{0}+\sum_{k=1}^{a-1}\frac{c_{k}}{z+%
k}+\varepsilon_{a}(z)\right]
  </annotation>
 </semantics>
</math>

</p>

<p>where <em>a</em> is an arbitrary positive integer and the coefficients are given by</p>

<p>

<math display="block" id="Spouge's_approximation:1">
 <semantics>
  <mrow>
   <msub>
    <mi>c</mi>
    <mn>0</mn>
   </msub>
   <mo>=</mo>
   <mpadded width="+1.7pt">
    <msqrt>
     <mrow>
      <mn>2</mn>
      <mi>π</mi>
     </mrow>
    </msqrt>
   </mpadded>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>c</ci>
     <cn type="integer">0</cn>
    </apply>
    <apply>
     <root></root>
     <apply>
      <times></times>
      <cn type="integer">2</cn>
      <ci>π</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   c_{0}=\sqrt{2\pi}\,
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Spouge's_approximation:2">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <msub>
      <mi>c</mi>
      <mi>k</mi>
     </msub>
     <mo>=</mo>
     <mrow>
      <mfrac>
       <msup>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <mo>-</mo>
          <mn>1</mn>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
        <mrow>
         <mi>k</mi>
         <mo>-</mo>
         <mn>1</mn>
        </mrow>
       </msup>
       <mrow>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <mi>k</mi>
          <mo>-</mo>
          <mn>1</mn>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
        <mo lspace="0pt" rspace="3.5pt">!</mo>
       </mrow>
      </mfrac>
      <msup>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mrow>
          <mo>-</mo>
          <mi>k</mi>
         </mrow>
         <mo>+</mo>
         <mi>a</mi>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
       <mrow>
        <mi>k</mi>
        <mo>-</mo>
        <mrow>
         <mn>1</mn>
         <mo>/</mo>
         <mn>2</mn>
        </mrow>
       </mrow>
      </msup>
      <msup>
       <mi>e</mi>
       <mrow>
        <mrow>
         <mo>-</mo>
         <mi>k</mi>
        </mrow>
        <mo>+</mo>
        <mi>a</mi>
       </mrow>
      </msup>
     </mrow>
    </mrow>
    <mrow>
     <mi>k</mi>
     <mo>∈</mo>
     <mrow>
      <mo stretchy="false">{</mo>
      <mn>1</mn>
      <mo>,</mo>
      <mn>2</mn>
      <mo>,</mo>
      <mi mathvariant="normal">…</mi>
      <mo>,</mo>
      <mrow>
       <mi>a</mi>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
      <mo stretchy="false">}</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>c</ci>
      <ci>k</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <minus></minus>
         <cn type="integer">1</cn>
        </apply>
        <apply>
         <minus></minus>
         <ci>k</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <apply>
        <factorial></factorial>
        <apply>
         <minus></minus>
         <ci>k</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <plus></plus>
        <apply>
         <minus></minus>
         <ci>k</ci>
        </apply>
        <ci>a</ci>
       </apply>
       <apply>
        <minus></minus>
        <ci>k</ci>
        <apply>
         <divide></divide>
         <cn type="integer">1</cn>
         <cn type="integer">2</cn>
        </apply>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>e</ci>
       <apply>
        <plus></plus>
        <apply>
         <minus></minus>
         <ci>k</ci>
        </apply>
        <ci>a</ci>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <in></in>
     <ci>k</ci>
     <set>
      <cn type="integer">1</cn>
      <cn type="integer">2</cn>
      <ci>normal-…</ci>
      <apply>
       <minus></minus>
       <ci>a</ci>
       <cn type="integer">1</cn>
      </apply>
     </set>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   c_{k}=\frac{(-1)^{k-1}}{(k-1)!}(-k+a)^{k-1/2}e^{-k+a}\quad k\in\{1,2,\dots,a-1\}.
  </annotation>
 </semantics>
</math>

</p>

<p>Spouge has proved that, if Re(<em>z</em>) &gt; 0 and <em>a</em> &gt; 2, the relative error in discarding ε<sub><em>a</em></sub>(<em>z</em>) is bounded by</p>

<p>

<math display="block" id="Spouge's_approximation:3">
 <semantics>
  <mrow>
   <mrow>
    <msup>
     <mpadded lspace="1.7pt" width="+1.7pt">
      <mi>a</mi>
     </mpadded>
     <mrow>
      <mo>-</mo>
      <mrow>
       <mn>1</mn>
       <mo>/</mo>
       <mn>2</mn>
      </mrow>
     </mrow>
    </msup>
    <msup>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mn>2</mn>
       <mi>π</mi>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <mrow>
      <mo>-</mo>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mi>a</mi>
        <mo>+</mo>
        <mrow>
         <mn>1</mn>
         <mo>/</mo>
         <mn>2</mn>
        </mrow>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </msup>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>a</ci>
     <apply>
      <minus></minus>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <times></times>
      <cn type="integer">2</cn>
      <ci>π</ci>
     </apply>
     <apply>
      <minus></minus>
      <apply>
       <plus></plus>
       <ci>a</ci>
       <apply>
        <divide></divide>
        <cn type="integer">1</cn>
        <cn type="integer">2</cn>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \,a^{-1/2}(2\pi)^{-(a+1/2)}.
  </annotation>
 </semantics>
</math>

</p>

<p>The formula is similar to the <a href="Lanczos_approximation" title="wikilink">Lanczos approximation</a>, but has some distinct features. Whereas the Lanczos formula exhibits faster convergence, Spouge's coefficients are much easier to calculate and the error can be set arbitrarily low. The formula is therefore feasible for <a href="arbitrary-precision_arithmetic" title="wikilink">arbitrary-precision</a> evaluation of the gamma function. However, special care must be taken to use sufficient precision when computing the sum due to the large size of the coefficients 

<math display="inline" id="Spouge's_approximation:4">
 <semantics>
  <msub>
   <mi>c</mi>
   <mi>k</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>c</ci>
    <ci>k</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   c_{k}
  </annotation>
 </semantics>
</math>

, as well as their alternating sign. For example, for <em>a</em>=49, you must compute the sum using about 65 decimal digits of precision in order to obtain the promised 40 decimal digits of accuracy.</p>
<h2 id="see-also">See also</h2>
<ul>
<li><a href="Stirling's_approximation" title="wikilink">Stirling's approximation</a></li>
<li><a href="Lanczos_approximation" title="wikilink">Lanczos approximation</a></li>
</ul>
<h2 id="references">References</h2>
<h2 id="external-links">External links</h2>
<ul>
<li><a href="http://en.literateprograms.org/Gamma_function_with_Spouge's_formula_(Mathematica)">Gamma function with Spouge's formula</a> - <a class="uri" href="Mathematica" title="wikilink">Mathematica</a> implementation at LiteratePrograms</li>
</ul>

<p>"</p>

<p><a href="Category:Gamma_and_related_functions" title="wikilink">Category:Gamma and related functions</a> <a href="Category:Computer_arithmetic_algorithms" title="wikilink">Category:Computer arithmetic algorithms</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1"><a href="#fnref1">↩</a></li>
</ol>
</section>
</body>
</html>

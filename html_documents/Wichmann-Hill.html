<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="1788">Wichmann-Hill</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Wichmann-Hill</h1>
<hr>'''Wichmann-Hill''' is a [[pseudorandom number generator]] proposed in 1982 by [[Brian Wichmann]] and David Hill.<ref>{{Cite journal|url = http://wwwf.imperial.ac.uk/~ayoung/m3s9/wichmannhill.pdf|title = Algorithm AS 183: An Efficient and Portable Pseudo-Random<style>
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
<style>
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
  </style>
</ref></hr></body></html>
<body>

<p><code>Number Generator|last = Wichmann|first = Brian|date = 1982|journal = Journal of the Royal Statistical Society. Series C (Applied Statistics), Vol. 31, No. 2 (1982), pp. 188-190|doi = |pmid = |access-date = |last2 = Hill|first2 = David}} In its core, numbers are generated by taking the fractional part of a sum of rectangularly distributed numbers from imperfect algorithms. As the addition of fractional parts of numbers will be rectangularly distributed if only one of the number is rectangular, the method is an appropriate generator. In it's crude form, three number generators are used to create a pseudorandom sequence with cycle exceeding </code>

<math display="inline" id="Wichmann-Hill:0">
 <semantics>
  <mrow>
   <mn>6.95</mn>
   <mo>*</mo>
   <msup>
    <mn>10</mn>
    <mn>12</mn>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <cn type="float">6.95</cn>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <cn type="integer">10</cn>
     <cn type="integer">12</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   6.95*10^{12}
  </annotation>
 </semantics>
</math>

<code>.</code><a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a></p>
<h2 id="implementation">Implementation</h2>

<p>The following pseudocode is for implementation on machines capable of integer arithmetic up to 30323.</p>
<div class="sourceCode"><pre class="sourceCode javascript"><code class="sourceCode javascript">[r<span class="op">,</span> s1<span class="op">,</span> s2<span class="op">,</span> s3] <span class="op">=</span> <span class="kw">function</span>(s1<span class="op">,</span> s2<span class="op">,</span> s3)
    <span class="op">%</span> s1<span class="op">,</span> s2<span class="op">,</span> s3 should be random <span class="im">from</span> <span class="dv">0</span> to <span class="dv">30</span><span class="op">,</span><span class="dv">000</span>. <span class="at">Use</span> <span class="at">clock</span> <span class="at">if</span> <span class="at">available</span>
    s1 <span class="op">=</span> <span class="dv">171</span> <span class="op">*</span> <span class="at">mod</span>(s1<span class="op">,</span> <span class="dv">177</span>) <span class="op">-</span> <span class="dv">2</span> <span class="op">*</span> (s1/<span class="dv">177</span>)
    s2 <span class="op">=</span> <span class="dv">172</span> <span class="op">*</span> <span class="at">mod</span>(s2<span class="op">,</span> <span class="dv">176</span>) <span class="op">-</span> <span class="dv">35</span> <span class="op">*</span> (s2/<span class="dv">176</span>)
    s3 <span class="op">=</span> <span class="dv">170</span> <span class="op">*</span> <span class="at">mod</span>(s3<span class="op">,</span> <span class="dv">178</span>) <span class="op">-</span> <span class="dv">63</span> <span class="op">*</span> (s3/<span class="dv">178</span>)

    r <span class="op">=</span> <span class="at">mod</span> ( s1/<span class="dv">30269</span> <span class="op">+</span> s2/<span class="dv">30307</span> <span class="op">+</span> s3/<span class="dv">30323</span> <span class="op">,</span> <span class="dv">1</span>)</code></pre></div>

<p>On machines capable of integer arithmetic up to 5,212,632, the more compact version gives identical results</p>
<div class="sourceCode"><pre class="sourceCode javascript"><code class="sourceCode javascript">[r<span class="op">,</span> s1<span class="op">,</span> s2<span class="op">,</span> s3] <span class="op">=</span> <span class="kw">function</span>(s1<span class="op">,</span> s2<span class="op">,</span> s3)
    <span class="op">%</span> s1<span class="op">,</span> s2<span class="op">,</span> s3 should be random <span class="im">from</span> <span class="dv">0</span> to <span class="dv">30</span><span class="op">,</span><span class="dv">000</span>. <span class="at">Use</span> <span class="at">clock</span> <span class="at">if</span> <span class="at">available</span>
    s1 <span class="op">=</span> <span class="at">mod</span> ( <span class="dv">171</span> <span class="op">*</span> s1<span class="op">,</span> <span class="dv">30269</span> )
    s2 <span class="op">=</span> <span class="at">mod</span> ( <span class="dv">172</span> <span class="op">*</span> s2<span class="op">,</span> <span class="dv">30307</span> )
    s3 <span class="op">=</span> <span class="at">mod</span> ( <span class="dv">170</span> <span class="op">*</span> s3<span class="op">,</span> <span class="dv">30323</span> )

    r <span class="op">=</span> <span class="at">mod</span> ( s1/<span class="dv">30269</span> <span class="op">+</span> s2/<span class="dv">30307</span> <span class="op">+</span> s3/<span class="dv">30323</span> <span class="op">,</span> <span class="dv">1</span>)</code></pre></div>
<h2 id="references">References</h2>
<references>
</references>

<p>"</p>

<p><a href="Category:Pseudorandom_number_generators" title="wikilink">Category:Pseudorandom number generators</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1"><a href="#fnref1">↩</a></li>
</ol>
</section>
</body>


<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="1001">Geometric median</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Geometric median</h1>
<hr/>

<p>The <strong>geometric median</strong> of a discrete set of sample points in a <a href="Euclidean_space" title="wikilink">Euclidean space</a> is the point minimizing the sum of distances to the sample points. This generalizes the <a class="uri" href="median" title="wikilink">median</a>, which has the property of minimizing the sum of distances for one-dimensional data, and provides a <a href="central_tendency" title="wikilink">central tendency</a> in higher dimensions. It is also known as the <strong>1-median</strong>,<a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a> <strong>spatial median</strong>,<a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a> <strong>Euclidean minisum point</strong>,<a class="footnoteRef" href="#fn3" id="fnref3"><sup>3</sup></a> or <strong>Torricelli point</strong>.</p>

<p>The geometric median is an important <a class="uri" href="estimator" title="wikilink">estimator</a> of <a href="location_parameter" title="wikilink">location</a> in statistics, where it is also known as the <strong><em>L</em><sub>1</sub> estimator</strong>.<a class="footnoteRef" href="#fn4" id="fnref4"><sup>4</sup></a> It is also a standard problem in <a href="facility_location" title="wikilink">facility location</a>, where it models the problem of locating a facility to minimize the cost of transportation.</p>

<p>The special case of the problem for three points in the plane (that is, <em>m</em> = 3 and <em>n</em> = 2 in the definition below) is sometimes also known as Fermat's problem; it arises in the construction of minimal <a href="Steiner_tree" title="wikilink">Steiner trees</a>, and was originally posed as a problem by <a href="Pierre_de_Fermat" title="wikilink">Pierre de Fermat</a> and solved by <a href="Evangelista_Torricelli" title="wikilink">Evangelista Torricelli</a>. Its solution is now known as the <a href="Fermat_point" title="wikilink">Fermat point</a> of the triangle formed by the three sample points. The geometric median may in turn be generalized to the problem of minimizing the sum of <em>weighted</em> distances, known as the <a href="Weber_problem" title="wikilink">Weber problem</a> after <a href="Alfred_Weber" title="wikilink">Alfred Weber</a>'s discussion of the problem in his 1909 book on facility location.<a class="footnoteRef" href="#fn5" id="fnref5"><sup>5</sup></a> Some sources instead call Weber's problem the Fermat–Weber problem, but others use this name for the unweighted geometric median problem.  provides a survey of the geometric median problem. See  for generalizations of the problem to non-discrete point sets.</p>
<h2 id="definition">Definition</h2>

<p>Formally, for a given set of <em>m</em> points 

<math display="inline" id="Geometric_median:0">
 <semantics>
  <mrow>
   <msub>
    <mi>x</mi>
    <mn>1</mn>
   </msub>
   <mo>,</mo>
   <msub>
    <mi>x</mi>
    <mn>2</mn>
   </msub>
   <mo>,</mo>
   <mi mathvariant="normal">…</mi>
   <mo>,</mo>
   <mpadded width="+1.7pt">
    <msub>
     <mi>x</mi>
     <mi>m</mi>
    </msub>
   </mpadded>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <list>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>x</ci>
     <cn type="integer">1</cn>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>x</ci>
     <cn type="integer">2</cn>
    </apply>
    <ci>normal-…</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>x</ci>
     <ci>m</ci>
    </apply>
   </list>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x_{1},x_{2},\dots,x_{m}\,
  </annotation>
 </semantics>
</math>

 with each 

<math display="inline" id="Geometric_median:1">
 <semantics>
  <mrow>
   <msub>
    <mi>x</mi>
    <mi>i</mi>
   </msub>
   <mo>∈</mo>
   <msup>
    <mi>ℝ</mi>
    <mi>n</mi>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <in></in>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>x</ci>
     <ci>i</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>ℝ</ci>
     <ci>n</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x_{i}\in\mathbb{R}^{n}
  </annotation>
 </semantics>
</math>


, the geometric median is defined as</p>
<dl>
<dd>Geometric Median 

<math display="inline" id="Geometric_median:2">
 <semantics>
  <mrow>
   <mi></mi>
   <mo>=</mo>
   <mrow>
    <munder accentunder="true">
     <mrow>
      <mpadded width="+1.7pt">
       <mi>arg</mi>
      </mpadded>
      <mi>min</mi>
     </mrow>
     <mrow>
      <mi>y</mi>
      <mo>∈</mo>
      <msup>
       <mi>ℝ</mi>
       <mi>n</mi>
      </msup>
     </mrow>
    </munder>
    <mrow>
     <msubsup>
      <mo largeop="true" symmetric="true">∑</mo>
      <mrow>
       <mi>i</mi>
       <mo>=</mo>
       <mn>1</mn>
      </mrow>
      <mi>m</mi>
     </msubsup>
     <msub>
      <mrow>
       <mo>∥</mo>
       <mrow>
        <msub>
         <mi>x</mi>
         <mi>i</mi>
        </msub>
        <mo>-</mo>
        <mi>y</mi>
       </mrow>
       <mo>∥</mo>
      </mrow>
      <mn>2</mn>
     </msub>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <csymbol cd="latexml">absent</csymbol>
    <apply>
     <times></times>
     <apply>
      <apply>
       <in></in>
       <ci>y</ci>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>ℝ</ci>
        <ci>n</ci>
       </apply>
      </apply>
      <apply>
       <times></times>
       <ci>arg</ci>
       <ci>min</ci>
      </apply>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <apply>
         <eq></eq>
         <ci>i</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <ci>m</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <apply>
        <csymbol cd="latexml">norm</csymbol>
        <apply>
         <minus></minus>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>x</ci>
          <ci>i</ci>
         </apply>
         <ci>y</ci>
        </apply>
       </apply>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   =\underset{y\in\mathbb{R}^{n}}{\operatorname{arg\,min}}\sum_{i=1}^{m}\left\|x_%
{i}-y\right\|_{2}
  </annotation>
 </semantics>
</math>


</dd>
</dl>

<p>Note that <em>argmin</em> means the value of the argument 

<math display="inline" id="Geometric_median:3">
 <semantics>
  <mi>y</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>y</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   y
  </annotation>
 </semantics>
</math>

 which minimizes the sum. In this case, it is the point 

<math display="inline" id="Geometric_median:4">
 <semantics>
  <mi>y</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>y</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   y
  </annotation>
 </semantics>
</math>

 from where the sum of all <a href="Euclidean_distance" title="wikilink">Euclidean distances</a> to the 

<math display="inline" id="Geometric_median:5">
 <semantics>
  <msub>
   <mi>x</mi>
   <mi>i</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>x</ci>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x_{i}
  </annotation>
 </semantics>
</math>

's is minimum.</p>
<h2 id="properties">Properties</h2>
<ul>
<li>For the 1-dimensional case, the geometric median coincides with the <a class="uri" href="median" title="wikilink">median</a>. This is because the <a class="uri" href="univariate" title="wikilink">univariate</a> median also minimizes the sum of distances from the points.<a class="footnoteRef" href="#fn6" id="fnref6"><sup>6</sup></a></li>
<li>The geometric median is <strong>unique</strong> whenever the points are not <a href="Line_(geometry)#Collinear_points" title="wikilink">collinear</a>.<a class="footnoteRef" href="#fn7" id="fnref7"><sup>7</sup></a></li>
<li>The geometric median is <a class="uri" href="equivariant" title="wikilink">equivariant</a> for Euclidean <a href="Similarity_(geometry)" title="wikilink">similarity transformations</a>, including <a href="translation_(geometry)" title="wikilink">translation</a> and <a href="rotation_(mathematics)" title="wikilink">rotation</a>.<a class="footnoteRef" href="#fn8" id="fnref8"><sup>8</sup></a><a class="footnoteRef" href="#fn9" id="fnref9"><sup>9</sup></a> This means that one would get the same result either by transforming the geometric median, or by applying the same transformation to the sample data and finding the geometric median of the transformed data. This property follows from the fact that the geometric median is defined only from pairwise distances, and doesn't depend on the system of orthogonal <a href="Cartesian_coordinates" title="wikilink">Cartesian coordinates</a> by which the sample data is represented. In contrast, the component-wise median for a multivariate data set is not in general rotation invariant, nor is it independent of the choice of coordinates.<a class="footnoteRef" href="#fn10" id="fnref10"><sup>10</sup></a></li>
<li>The geometric median has a <a href="breakdown_point" title="wikilink">breakdown point</a> of 0.5.<a class="footnoteRef" href="#fn11" id="fnref11"><sup>11</sup></a> That is, up to half of the sample data may be arbitrarily corrupted, and the median of the samples will still provide a <a href="robust_estimator" title="wikilink">robust estimator</a> for the location of the uncorrupted data.</li>
</ul>
<h2 id="special-cases">Special cases</h2>
<ul>
<li><strong>For 3 (non-<a class="uri" href="collinear" title="wikilink">collinear</a>) points,</strong> if any angle of the triangle formed by those points is 120° or more, then the geometric median is the point making that angle. If all the angles are less than 120°, the geometric median is the point inside the triangle which subtends an angle of 120° to each three pairs of triangle vertices.<a class="footnoteRef" href="#fn12" id="fnref12"><sup>12</sup></a> This is also known as the <a href="Fermat_point" title="wikilink">Fermat point</a> of the triangle formed by the three vertices. (If the three points are collinear then the geometric median is the point between the two other points, as is the case with a one-dimensional median.)</li>
<li><strong>For 4 <a class="uri" href="coplanar" title="wikilink">coplanar</a> points,</strong> if one of the four points is inside the triangle formed by the other three points, then the geometric median is that point. Otherwise, the four points form a convex <a class="uri" href="quadrilateral" title="wikilink">quadrilateral</a> and the geometric median is the crossing point of the diagonals of the quadrilateral. The geometric median of four coplanar points is the same as the unique <a href="Radon_point" title="wikilink">Radon point</a> of the four points.<a class="footnoteRef" href="#fn13" id="fnref13"><sup>13</sup></a></li>
</ul>
<h2 id="computation">Computation</h2>

<p>Despite the geometric median's being an easy-to-understand concept, computing it poses a challenge. The <a class="uri" href="centroid" title="wikilink">centroid</a> or <a href="center_of_mass" title="wikilink">center of mass</a>, defined similarly to the geometric median as minimizing the sum of the <em>squares</em> of the distances to each point, can be found by a simple formula — its coordinates are the averages of the coordinates of the points — but no such formula is known for the geometric median, and it has been shown that no <a href="Closed-form_expression" title="wikilink">explicit formula</a>, nor an exact algorithm involving only arithmetic operations and <em>k</em>th roots can exist in general. Therefore only numerical or symbolic approximations to the solution of this problem are possible under this <a href="model_of_computation" title="wikilink">model of computation</a>.<a class="footnoteRef" href="#fn14" id="fnref14"><sup>14</sup></a></p>

<p>However, it is straightforward to calculate an approximation to the geometric median using an iterative procedure in which each step produces a more accurate approximation. Procedures of this type can be derived from the fact that the sum of distances to the sample points is a <a href="convex_function" title="wikilink">convex function</a>, since the distance to each sample point is convex and the sum of convex functions remains convex. Therefore, procedures that decrease the sum of distances at each step cannot get trapped in a <a href="local_optimum" title="wikilink">local optimum</a>.</p>

<p>One common approach of this type, called <strong>Weiszfeld's algorithm</strong> after the work of <a href="Endre_Weiszfeld" title="wikilink">Endre Weiszfeld</a>,<a class="footnoteRef" href="#fn15" id="fnref15"><sup>15</sup></a> is a form of <a href="iteratively_re-weighted_least_squares" title="wikilink">iteratively re-weighted least squares</a>. This algorithm defines a set of weights that are inversely proportional to the distances from the current estimate to the samples, and creates a new estimate that is the weighted average of the samples according to these weights. That is,</p>

<p>

<math display="block" id="Geometric_median:6">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>y</mi>
     <mrow>
      <mi>i</mi>
      <mo>+</mo>
      <mn>1</mn>
     </mrow>
    </msub>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mo>(</mo>
      <mrow>
       <munderover>
        <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
        <mrow>
         <mi>j</mi>
         <mo>=</mo>
         <mn>1</mn>
        </mrow>
        <mi>m</mi>
       </munderover>
       <mfrac>
        <msub>
         <mi>x</mi>
         <mi>j</mi>
        </msub>
        <mrow>
         <mo>∥</mo>
         <mrow>
          <msub>
           <mi>x</mi>
           <mi>j</mi>
          </msub>
          <mo>-</mo>
          <msub>
           <mi>y</mi>
           <mi>i</mi>
          </msub>
         </mrow>
         <mo>∥</mo>
        </mrow>
       </mfrac>
      </mrow>
      <mo>)</mo>
     </mrow>
     <mo>/</mo>
     <mrow>
      <mo>(</mo>
      <mrow>
       <munderover>
        <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
        <mrow>
         <mi>j</mi>
         <mo>=</mo>
         <mn>1</mn>
        </mrow>
        <mi>m</mi>
       </munderover>
       <mfrac>
        <mn>1</mn>
        <mrow>
         <mo>∥</mo>
         <mrow>
          <msub>
           <mi>x</mi>
           <mi>j</mi>
          </msub>
          <mo>-</mo>
          <msub>
           <mi>y</mi>
           <mi>i</mi>
          </msub>
         </mrow>
         <mo>∥</mo>
        </mrow>
       </mfrac>
      </mrow>
      <mo>)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>y</ci>
     <apply>
      <plus></plus>
      <ci>i</ci>
      <cn type="integer">1</cn>
     </apply>
    </apply>
    <apply>
     <ci>normal-/</ci>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <apply>
         <eq></eq>
         <ci>j</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <ci>m</ci>
      </apply>
      <apply>
       <divide></divide>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <ci>j</ci>
       </apply>
       <apply>
        <csymbol cd="latexml">norm</csymbol>
        <apply>
         <minus></minus>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>x</ci>
          <ci>j</ci>
         </apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>y</ci>
          <ci>i</ci>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <apply>
         <eq></eq>
         <ci>j</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <ci>m</ci>
      </apply>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <apply>
        <csymbol cd="latexml">norm</csymbol>
        <apply>
         <minus></minus>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>x</ci>
          <ci>j</ci>
         </apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>y</ci>
          <ci>i</ci>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \left.y_{i+1}=\left(\sum_{j=1}^{m}\frac{x_{j}}{\|x_{j}-y_{i}\|}\right)\right/%
\left(\sum_{j=1}^{m}\frac{1}{\|x_{j}-y_{i}\|}\right).
  </annotation>
 </semantics>
</math>

 This method converges for almost all initial positions, but may fail to converge when one of its estimates falls on one of the given points. It can be modified to handle these cases so that it converges for all initial points.<a class="footnoteRef" href="#fn16" id="fnref16"><sup>16</sup></a>  describe more sophisticated geometric optimization procedures for finding approximately optimal solutions to this problem. As  show, the problem can also be represented as a <a href="semidefinite_programming" title="wikilink">semidefinite program</a>.</p>
<h2 id="characterization-of-the-geometric-median">Characterization of the geometric median</h2>

<p>If <em>y</em> is distinct from all the given points, <em>x</em><sub><em>j</em></sub>, then <em>y</em> is the geometric median if and only if it satisfies:</p>

<p>

<math display="block" id="Geometric_median:7">
 <semantics>
  <mrow>
   <mrow>
    <mn>0</mn>
    <mo>=</mo>
    <mrow>
     <munderover>
      <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
      <mrow>
       <mi>j</mi>
       <mo>=</mo>
       <mn>1</mn>
      </mrow>
      <mi>m</mi>
     </munderover>
     <mfrac>
      <mrow>
       <msub>
        <mi>x</mi>
        <mi>j</mi>
       </msub>
       <mo>-</mo>
       <mi>y</mi>
      </mrow>
      <mrow>
       <mo>∥</mo>
       <mrow>
        <msub>
         <mi>x</mi>
         <mi>j</mi>
        </msub>
        <mo>-</mo>
        <mi>y</mi>
       </mrow>
       <mo>∥</mo>
      </mrow>
     </mfrac>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <cn type="integer">0</cn>
    <apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <apply>
        <eq></eq>
        <ci>j</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <ci>m</ci>
     </apply>
     <apply>
      <divide></divide>
      <apply>
       <minus></minus>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <ci>j</ci>
       </apply>
       <ci>y</ci>
      </apply>
      <apply>
       <csymbol cd="latexml">norm</csymbol>
       <apply>
        <minus></minus>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>x</ci>
         <ci>j</ci>
        </apply>
        <ci>y</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   0=\sum_{j=1}^{m}\frac{x_{j}-y}{\left\|x_{j}-y\right\|}.
  </annotation>
 </semantics>
</math>

</p>

<p>This is equivalent to:</p>

<p>

<math display="block" id="Geometric_median:8">
 <semantics>
  <mrow>
   <mrow>
    <mi>y</mi>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mo>(</mo>
      <mrow>
       <munderover>
        <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
        <mrow>
         <mi>j</mi>
         <mo>=</mo>
         <mn>1</mn>
        </mrow>
        <mi>m</mi>
       </munderover>
       <mfrac>
        <msub>
         <mi>x</mi>
         <mi>j</mi>
        </msub>
        <mrow>
         <mo>∥</mo>
         <mrow>
          <msub>
           <mi>x</mi>
           <mi>j</mi>
          </msub>
          <mo>-</mo>
          <mi>y</mi>
         </mrow>
         <mo>∥</mo>
        </mrow>
       </mfrac>
      </mrow>
      <mo>)</mo>
     </mrow>
     <mo>/</mo>
     <mrow>
      <mo>(</mo>
      <mrow>
       <munderover>
        <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
        <mrow>
         <mi>j</mi>
         <mo>=</mo>
         <mn>1</mn>
        </mrow>
        <mi>m</mi>
       </munderover>
       <mfrac>
        <mn>1</mn>
        <mrow>
         <mo>∥</mo>
         <mrow>
          <msub>
           <mi>x</mi>
           <mi>j</mi>
          </msub>
          <mo>-</mo>
          <mi>y</mi>
         </mrow>
         <mo>∥</mo>
        </mrow>
       </mfrac>
      </mrow>
      <mo>)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>y</ci>
    <apply>
     <ci>normal-/</ci>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <apply>
         <eq></eq>
         <ci>j</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <ci>m</ci>
      </apply>
      <apply>
       <divide></divide>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <ci>j</ci>
       </apply>
       <apply>
        <csymbol cd="latexml">norm</csymbol>
        <apply>
         <minus></minus>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>x</ci>
          <ci>j</ci>
         </apply>
         <ci>y</ci>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <apply>
         <eq></eq>
         <ci>j</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <ci>m</ci>
      </apply>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <apply>
        <csymbol cd="latexml">norm</csymbol>
        <apply>
         <minus></minus>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>x</ci>
          <ci>j</ci>
         </apply>
         <ci>y</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \left.y=\left(\sum_{j=1}^{m}\frac{x_{j}}{\|x_{j}-y\|}\right)\right/\left(\sum_%
{j=1}^{m}\frac{1}{\|x_{j}-y\|}\right),
  </annotation>
 </semantics>
</math>

</p>

<p>which is closely related to Weiszfeld's algorithm.</p>

<p>In general, <em>y</em> is the geometric median if and only if there are vectors <em>u</em><sub><em>j</em></sub> such that:</p>

<p>

<math display="block" id="Geometric_median:9">
 <semantics>
  <mrow>
   <mn>0</mn>
   <mo>=</mo>
   <mrow>
    <munderover>
     <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
     <mrow>
      <mi>j</mi>
      <mo>=</mo>
      <mn>1</mn>
     </mrow>
     <mi>m</mi>
    </munderover>
    <msub>
     <mi>u</mi>
     <mi>j</mi>
    </msub>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <cn type="integer">0</cn>
    <apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <apply>
        <eq></eq>
        <ci>j</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <ci>m</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>u</ci>
      <ci>j</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   0=\sum_{j=1}^{m}u_{j}
  </annotation>
 </semantics>
</math>

 where for <em>x</em><sub><em>j</em></sub> ≠ <em>y</em>,</p>

<p>

<math display="block" id="Geometric_median:10">
 <semantics>
  <mrow>
   <msub>
    <mi>u</mi>
    <mi>j</mi>
   </msub>
   <mo>=</mo>
   <mfrac>
    <mrow>
     <msub>
      <mi>x</mi>
      <mi>j</mi>
     </msub>
     <mo>-</mo>
     <mi>y</mi>
    </mrow>
    <mrow>
     <mo>∥</mo>
     <mrow>
      <msub>
       <mi>x</mi>
       <mi>j</mi>
      </msub>
      <mo>-</mo>
      <mi>y</mi>
     </mrow>
     <mo>∥</mo>
    </mrow>
   </mfrac>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>u</ci>
     <ci>j</ci>
    </apply>
    <apply>
     <divide></divide>
     <apply>
      <minus></minus>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <ci>j</ci>
      </apply>
      <ci>y</ci>
     </apply>
     <apply>
      <csymbol cd="latexml">norm</csymbol>
      <apply>
       <minus></minus>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <ci>j</ci>
       </apply>
       <ci>y</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   u_{j}=\frac{x_{j}-y}{\left\|x_{j}-y\right\|}
  </annotation>
 </semantics>
</math>

 and for <em>x</em><sub><em>j</em></sub> = <em>y</em>,</p>

<p>

<math display="block" id="Geometric_median:11">
 <semantics>
  <mrow>
   <mrow>
    <mo>∥</mo>
    <msub>
     <mi>u</mi>
     <mi>j</mi>
    </msub>
    <mo>∥</mo>
   </mrow>
   <mo>≤</mo>
   <mn>1.</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <leq></leq>
    <apply>
     <csymbol cd="latexml">norm</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>u</ci>
      <ci>j</ci>
     </apply>
    </apply>
    <cn type="float">1.</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \|u_{j}\|\leq 1.
  </annotation>
 </semantics>
</math>

 An equivalent formulation of this condition is</p>

<p>

<math display="block" id="Geometric_median:12">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <munder>
      <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
      <mrow>
       <mrow>
        <mn>1</mn>
        <mo>≤</mo>
        <mi>j</mi>
        <mo>≤</mo>
        <mi>m</mi>
       </mrow>
       <mo>,</mo>
       <mrow>
        <msub>
         <mi>x</mi>
         <mi>j</mi>
        </msub>
        <mo>≠</mo>
        <mi>y</mi>
       </mrow>
      </mrow>
     </munder>
     <mfrac>
      <mrow>
       <msub>
        <mi>x</mi>
        <mi>j</mi>
       </msub>
       <mo>-</mo>
       <mi>y</mi>
      </mrow>
      <mrow>
       <mo>∥</mo>
       <mrow>
        <msub>
         <mi>x</mi>
         <mi>j</mi>
        </msub>
        <mo>-</mo>
        <mi>y</mi>
       </mrow>
       <mo>∥</mo>
      </mrow>
     </mfrac>
    </mrow>
    <mo>≤</mo>
    <mrow>
     <mo>|</mo>
     <mrow>
      <mo rspace="4.2pt" stretchy="false">{</mo>
      <mi>j</mi>
      <mo>∣</mo>
      <mrow>
       <mrow>
        <mn>1</mn>
        <mo>≤</mo>
        <mi>j</mi>
        <mo>≤</mo>
        <mi>m</mi>
       </mrow>
       <mo>,</mo>
       <mrow>
        <msub>
         <mi>x</mi>
         <mi>j</mi>
        </msub>
        <mo>=</mo>
        <mpadded width="+1.7pt">
         <mi>y</mi>
        </mpadded>
       </mrow>
      </mrow>
      <mo stretchy="false">}</mo>
     </mrow>
     <mo>|</mo>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <leq></leq>
    <apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <sum></sum>
      <apply>
       <csymbol cd="ambiguous">formulae-sequence</csymbol>
       <apply>
        <and></and>
        <apply>
         <leq></leq>
         <cn type="integer">1</cn>
         <ci>j</ci>
        </apply>
        <apply>
         <leq></leq>
         <share href="#.cmml">
         </share>
         <ci>m</ci>
        </apply>
       </apply>
       <apply>
        <neq></neq>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>x</ci>
         <ci>j</ci>
        </apply>
        <ci>y</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <divide></divide>
      <apply>
       <minus></minus>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <ci>j</ci>
       </apply>
       <ci>y</ci>
      </apply>
      <apply>
       <csymbol cd="latexml">norm</csymbol>
       <apply>
        <minus></minus>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>x</ci>
         <ci>j</ci>
        </apply>
        <ci>y</ci>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <abs></abs>
     <apply>
      <csymbol cd="latexml">conditional-set</csymbol>
      <ci>j</ci>
      <apply>
       <csymbol cd="ambiguous">formulae-sequence</csymbol>
       <apply>
        <and></and>
        <apply>
         <leq></leq>
         <cn type="integer">1</cn>
         <ci>j</ci>
        </apply>
        <apply>
         <leq></leq>
         <share href="#.cmml">
         </share>
         <ci>m</ci>
        </apply>
       </apply>
       <apply>
        <eq></eq>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>x</ci>
         <ci>j</ci>
        </apply>
        <ci>y</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \sum_{1\leq j\leq m,x_{j}\neq y}\frac{x_{j}-y}{\left\|x_{j}-y\right\|}\leq%
\left|\{\,j\mid 1\leq j\leq m,x_{j}=y\,\}\right|.
  </annotation>
 </semantics>
</math>

</p>
<h2 id="generalizations">Generalizations</h2>

<p>The geometric median can be generalized from Euclidean spaces to general <a href="Riemannian_manifold" title="wikilink">Riemannian manifolds</a> (and even <a href="metric_space" title="wikilink">metric spaces</a>) using the same idea which is used to define the <a href="Fréchet_mean" title="wikilink">Fréchet mean</a> on a Riemannian manifold. Let 

<math display="inline" id="Geometric_median:13">
 <semantics>
  <mi>M</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>M</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   M
  </annotation>
 </semantics>
</math>

 be a Riemannian manifold with corresponding distance function 

<math display="inline" id="Geometric_median:14">
 <semantics>
  <mrow>
   <mi>d</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mo>⋅</mo>
    <mo>,</mo>
    <mo>⋅</mo>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>d</ci>
    <interval closure="open">
     <ci>normal-⋅</ci>
     <ci>normal-⋅</ci>
    </interval>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   d(\cdot,\cdot)
  </annotation>
 </semantics>
</math>

, let 

<math display="inline" id="Geometric_median:15">
 <semantics>
  <mrow>
   <msub>
    <mi>w</mi>
    <mn>1</mn>
   </msub>
   <mo>,</mo>
   <mi mathvariant="normal">…</mi>
   <mo>,</mo>
   <msub>
    <mi>w</mi>
    <mi>n</mi>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <list>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>w</ci>
     <cn type="integer">1</cn>
    </apply>
    <ci>normal-…</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>w</ci>
     <ci>n</ci>
    </apply>
   </list>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   w_{1},\ldots,w_{n}
  </annotation>
 </semantics>
</math>

 be 

<math display="inline" id="Geometric_median:16">
 <semantics>
  <mi>n</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>n</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n
  </annotation>
 </semantics>
</math>

 weights summing to 1, and let 

<math display="inline" id="Geometric_median:17">
 <semantics>
  <mrow>
   <msub>
    <mi>x</mi>
    <mn>1</mn>
   </msub>
   <mo>,</mo>
   <mi mathvariant="normal">…</mi>
   <mo>,</mo>
   <msub>
    <mi>x</mi>
    <mi>n</mi>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <list>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>x</ci>
     <cn type="integer">1</cn>
    </apply>
    <ci>normal-…</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>x</ci>
     <ci>n</ci>
    </apply>
   </list>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x_{1},\ldots,x_{n}
  </annotation>
 </semantics>
</math>

 be 

<math display="inline" id="Geometric_median:18">
 <semantics>
  <mi>n</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>n</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n
  </annotation>
 </semantics>
</math>

 observations from 

<math display="inline" id="Geometric_median:19">
 <semantics>
  <mi>M</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>M</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   M
  </annotation>
 </semantics>
</math>

. Then we define the weighted geometric median 

<math display="inline" id="Geometric_median:20">
 <semantics>
  <mi>m</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>m</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   m
  </annotation>
 </semantics>
</math>

 (or weighted Fréchet median) of the data points as</p>

<p>

<math display="block" id="Geometric_median:21">
 <semantics>
  <mrow>
   <mi>m</mi>
   <mo>=</mo>
   <mrow>
    <munder accentunder="true">
     <mrow>
      <mpadded width="+1.7pt">
       <mi>arg</mi>
      </mpadded>
      <mi>min</mi>
     </mrow>
     <mrow>
      <mi>x</mi>
      <mo>∈</mo>
      <mi>M</mi>
     </mrow>
    </munder>
    <mrow>
     <munderover>
      <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
      <mrow>
       <mi>i</mi>
       <mo>=</mo>
       <mn>1</mn>
      </mrow>
      <mi>n</mi>
     </munderover>
     <mrow>
      <msub>
       <mi>w</mi>
       <mi>i</mi>
      </msub>
      <mi>d</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>x</mi>
       <mo>,</mo>
       <msub>
        <mi>x</mi>
        <mi>i</mi>
       </msub>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>m</ci>
    <apply>
     <times></times>
     <apply>
      <apply>
       <in></in>
       <ci>x</ci>
       <ci>M</ci>
      </apply>
      <apply>
       <times></times>
       <ci>arg</ci>
       <ci>min</ci>
      </apply>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <apply>
         <eq></eq>
         <ci>i</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <ci>n</ci>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>w</ci>
        <ci>i</ci>
       </apply>
       <ci>d</ci>
       <interval closure="open">
        <ci>x</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>x</ci>
         <ci>i</ci>
        </apply>
       </interval>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   m=\underset{x\in M}{\operatorname{arg\,min}}\sum_{i=1}^{n}w_{i}d(x,x_{i})
  </annotation>
 </semantics>
</math>

. If all the weights are equal, we say simply that 

<math display="inline" id="Geometric_median:22">
 <semantics>
  <mi>m</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>m</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   m
  </annotation>
 </semantics>
</math>

 is the geometric median.</p>
<h2 id="notes">Notes</h2>
<h2 id="references">References</h2>
<ul>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
<li>

<p>.</p></li>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
</ul>

<p>"</p>

<p><a class="uri" href="Category:Means" title="wikilink">Category:Means</a> <a href="Category:Multivariate_statistics" title="wikilink">Category:Multivariate statistics</a> <a href="Category:Non-parametric_statistics" title="wikilink">Category:Non-parametric statistics</a> <a href="Category:Mathematical_optimization" title="wikilink">Category:Mathematical optimization</a> <a href="Category:Operations_research" title="wikilink">Category:Operations research</a> <a href="Category:Geometric_algorithms" title="wikilink">Category:Geometric algorithms</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1">The more general <a href="k-median_problem" title="wikilink"><em>k</em>-median problem</a> asks for the location of <em>k</em> cluster centers minimizing the sum of distances from each sample point to its nearest center.<a href="#fnref1">↩</a></li>
<li id="fn2"></li>
<li id="fn3"><a href="#fnref3">↩</a></li>
<li id="fn4"></li>
<li id="fn5"></li>
<li id="fn6"></li>
<li id="fn7"><a href="#fnref7">↩</a></li>
<li id="fn8"></li>
<li id="fn9"><a href="#fnref9">↩</a></li>
<li id="fn10"></li>
<li id="fn11"><a href="#fnref11">↩</a></li>
<li id="fn12"></li>
<li id="fn13">, p. 6; . The convex case was originally proven by <a href="Giovanni_Fagnano" title="wikilink">Giovanni Fagnano</a>.<a href="#fnref13">↩</a></li>
<li id="fn14">; . Earlier,  proved that the Steiner point for 5 points in the plane cannot be constructed with <a href="ruler_and_compass" title="wikilink">ruler and compass</a><a href="#fnref14">↩</a></li>
<li id="fn15">; ; .<a href="#fnref15">↩</a></li>
<li id="fn16"></li>
</ol>
</section>
</body>
</html>

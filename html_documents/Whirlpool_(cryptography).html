<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="1679">Whirlpool (cryptography)</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Whirlpool (cryptography)</h1>
<hr/>

<p>In <a href="computer_science" title="wikilink">computer science</a> and <a class="uri" href="cryptography" title="wikilink">cryptography</a>, <strong>Whirlpool</strong> (sometimes styled <strong>WHIRLPOOL</strong>) is a <a href="cryptographic_hash_function" title="wikilink">cryptographic hash function</a>. It was designed by <a href="Vincent_Rijmen" title="wikilink">Vincent Rijmen</a> (co-creator of the <a href="Advanced_Encryption_Standard" title="wikilink">Advanced Encryption Standard</a>) and <a href="Paulo_S._L._M._Barreto" title="wikilink">Paulo S. L. M. Barreto</a>, who first described it in 2000. The hash has been recommended by the <a class="uri" href="NESSIE" title="wikilink">NESSIE</a> project. It has also been adopted by the <a href="International_Organization_for_Standardization" title="wikilink">International Organization for Standardization</a> (ISO) and the <a href="International_Electrotechnical_Commission" title="wikilink">International Electrotechnical Commission</a> (IEC) as part of the joint ISO/IEC 10118-3 <a href="international_standard" title="wikilink">international standard</a>.</p>
<h2 id="design-features">Design features</h2>
<figure><b>(Figure)</b>
<figcaption>The <a href="Whirlpool_Galaxy" title="wikilink">Whirlpool Galaxy</a> (M51), which inspired the name of the algorithm.<a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a></figcaption>
</figure>

<p>Whirlpool is a hash designed after the <a href="Square_(cipher)" title="wikilink">Square</a> <a href="block_cipher" title="wikilink">block cipher</a>. Whirlpool is a <a href="One-way_compression_function#Miyaguchi–Preneel" title="wikilink">Miyaguchi-Preneel</a> construction based on a substantially modified <a href="Advanced_Encryption_Standard" title="wikilink">Advanced Encryption Standard</a> (AES). It takes a message of any length less than 2<sup>256</sup> bits and returns a 512-bit <a href="message_digest" title="wikilink">message digest</a>.<a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a></p>

<p>The authors have declared that "WHIRLPOOL is not (and will never be) patented. It may be used free of charge for any purpose."<a class="footnoteRef" href="#fn3" id="fnref3"><sup>3</sup></a></p>
<h3 id="version-changes">Version changes</h3>

<p>The original Whirlpool will be called <em>Whirlpool-0</em>, the first revision of Whirlpool will be called <em>Whirlpool-T</em> and the latest version will be called <em>Whirlpool</em> in the following test vectors.</p>
<ul>
<li>In the first revision in 2001, the <a class="uri" href="s-box" title="wikilink">s-box</a> was changed from a randomly generated one with good cryptographic properties to one which has better cryptographic properties and is easier to implement in hardware.</li>
<li>In the second revision (2003), a flaw in the <a href="MDS_matrix" title="wikilink">diffusion matrix</a> was found that lowered the estimated security of the algorithm below its potential.<ref></ref></li>
</ul>

<p> Changing the 8x8 rotating matrix constants from (1, 1, 3, 1, 5, 8, 9, 5) to (1, 1, 4, 1, 8, 5, 2, 9) solved this issue.</p>
<h2 id="internal-structure">Internal Structure</h2>

<p>The Whirlpool hash function is a <a href="Merkle–Damgård_construction" title="wikilink">Merkle–Damgård construction</a> based on an <a href="Advanced_Encryption_Standard" title="wikilink">AES</a>-like <a href="block_cipher" title="wikilink">block cipher</a> W in <a href="One-way_compression_function#Miyaguchi–Preneel" title="wikilink">Miyaguchi-Preneel</a> mode.<a class="footnoteRef" href="#fn4" id="fnref4"><sup>4</sup></a> The <a href="block_cipher" title="wikilink">block cipher</a> W consists of an 8×8 state matrix 

<math display="inline" id="Whirlpool_(cryptography):0">
 <semantics>
  <mi>S</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>S</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   S
  </annotation>
 </semantics>
</math>

 of bytes, for a total of 512 bits. The encryption process consists of updating the state with four round functions over 10 rounds. The four round functions are SubBytes (SB), ShiftColumns (SC), MixRows (MR) and AddRoundKey (AK). During each round the new state is computed as 

<math display="inline" id="Whirlpool_(cryptography):1">
 <semantics>
  <mrow>
   <mi>S</mi>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mrow>
      <mrow>
       <mrow>
        <mrow>
         <mrow>
          <mi>A</mi>
          <mi>K</mi>
         </mrow>
         <mo>∘</mo>
         <mi>M</mi>
        </mrow>
        <mi>R</mi>
       </mrow>
       <mo>∘</mo>
       <mi>S</mi>
      </mrow>
      <mi>C</mi>
     </mrow>
     <mo>∘</mo>
     <mi>S</mi>
    </mrow>
    <mi>B</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>S</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>S</ci>
    <apply>
     <times></times>
     <apply>
      <compose></compose>
      <apply>
       <times></times>
       <apply>
        <compose></compose>
        <apply>
         <times></times>
         <apply>
          <compose></compose>
          <apply>
           <times></times>
           <ci>A</ci>
           <ci>K</ci>
          </apply>
          <ci>M</ci>
         </apply>
         <ci>R</ci>
        </apply>
        <ci>S</ci>
       </apply>
       <ci>C</ci>
      </apply>
      <ci>S</ci>
     </apply>
     <ci>B</ci>
     <ci>S</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   S=AK\circ MR\circ SC\circ SB(S)
  </annotation>
 </semantics>
</math>

.</p>
<h3 id="subbytes">SubBytes</h3>

<p>The <strong>SubBytes</strong> operation applies a non-linear permutation (the S-box) to each byte of the state independently. The 8-bit S-box is composed of 3 smaller 4-bit S-boxes.</p>
<h3 id="shiftcolumns">ShiftColumns</h3>

<p>The <strong>ShiftColumns</strong> operation cyclically shifts each byte in each column of the state. Column <em>j</em> has its bytes shifted downwards by <em>j</em> positions.</p>
<h3 id="mixrows">MixRows</h3>

<p>The <strong>MixRows</strong> operation is a right-multiplication of each row by an 8×8 matrix over 

<math display="inline" id="Whirlpool_(cryptography):2">
 <semantics>
  <msub>
   <mi>𝔽</mi>
   <msup>
    <mn>2</mn>
    <mn>8</mn>
   </msup>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>𝔽</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <cn type="integer">2</cn>
     <cn type="integer">8</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbb{F}_{2^{8}}
  </annotation>
 </semantics>
</math>

. The matrix is chosen such that the branch number (an important property when looking at resistance to <a href="differential_cryptanalysis" title="wikilink">differential cryptanalysis</a>) is 9, which is maximal.</p>
<h3 id="addroundkey">AddRoundKey</h3>

<p>The <strong>AddRoundKey</strong> operation uses bitwise <a href="Exclusive_or" title="wikilink">xor</a> to add a key calculated by the key schedule to the current state. The key schedule is identical to the encryption itself, except the AddRoundKey function is replaced by an <strong>AddRoundConstant</strong> function that adds a predetermined constant in each round.</p>
<h2 id="whirlpool-hashes">Whirlpool hashes</h2>

<p>The Whirlpool algorithm has undergone two revisions since its original 2000 specification.</p>

<p>People incorporating Whirlpool will most likely use the most recent revision of Whirlpool; while there are no known security weaknesses in earlier versions of Whirlpool, the most recent revision has better hardware implementation efficiency characteristics, and is also likely to be more secure. As mentioned earlier, it is also the version adopted in the ISO/IEC 10118-3 <a href="international_standard" title="wikilink">international standard</a>.</p>

<p>The 512-bit (64-byte) Whirlpool hashes (also termed <em>message digests</em>) are typically represented as 128-digit <a class="uri" href="hexadecimal" title="wikilink">hexadecimal</a> numbers. The following demonstrates a 43-byte <a class="uri" href="ASCII" title="wikilink">ASCII</a> input and the corresponding Whirlpool hashes:</p>

<p><code> Whirlpool-0("</code><a href="The_quick_brown_fox_jumps_over_the_lazy_dog" title="wikilink"><code>The</code> <code>quick</code> <code>brown</code> <code>fox</code> <code>jumps</code> <code>over</code> <code>the</code> <code>lazy</code> <code>dog</code></a><code>") =</code><br/>
<code> 4F8F5CB531E3D49A61CF417CD133792CCFA501FD8DA53EE368FED20E5FE0248C</code><br/>
<code> 3A0B64F98A6533CEE1DA614C3A8DDEC791FF05FEE6D971D57C1348320F4EB42D</code><br/>
<br/>
<code> Whirlpool-T("The quick brown fox jumps over the lazy dog") =</code><br/>
<code> 3CCF8252D8BBB258460D9AA999C06EE38E67CB546CFFCF48E91F700F6FC7C183</code><br/>
<code> AC8CC3D3096DD30A35B01F4620A1E3A20D79CD5168544D9E1B7CDF49970E87F1</code><br/>
<br/>
<code> Whirlpool("The quick brown fox jumps over the lazy dog") =</code><br/>
<code> B97DE512E91E3828B40D2B0FDCE9CEB3C4A71F9BEA8D88E75C4FA854DF36725F</code><br/>
<code> D2B52EB6544EDCACD6F8BEDDFEA403CB55AE31F03AD62A5EF54E42EE82C3FB35</code></p>

<p>Even a small change in the message will (with an extremely high probability of 

<math display="inline" id="Whirlpool_(cryptography):3">
 <semantics>
  <mrow>
   <mn>1</mn>
   <mo>-</mo>
   <msup>
    <mn>10</mn>
    <mrow>
     <mo>-</mo>
     <mn>154</mn>
    </mrow>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <minus></minus>
    <cn type="integer">1</cn>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <cn type="integer">10</cn>
     <apply>
      <minus></minus>
      <cn type="integer">154</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   1-10^{-154}
  </annotation>
 </semantics>
</math>

) result in a different hash, which will <a href="Clustering_illusion" title="wikilink">usually</a> look completely different just like two unrelated random numbers do. The following demonstrates the result of changing the previous input by a single letter (a single bit, even, in ASCII-compatible encodings), replacing <code>d</code> with <code>e</code>:</p>

<p><code> Whirlpool-0("The quick brown fox jumps over the lazy eog") =</code><br/>
<code> 228FBF76B2A93469D4B25929836A12B7D7F2A0803E43DABA0C7FC38BC11C8F2A</code><br/>
<code> 9416BBCF8AB8392EB2AB7BCB565A64AC50C26179164B26084A253CAF2E012676</code><br/>
<br/>
<code> Whirlpool-T("The quick brown fox jumps over the lazy eog") =</code><br/>
<code> C8C15D2A0E0DE6E6885E8A7D9B8A9139746DA299AD50158F5FA9EECDDEF744F9</code><br/>
<code> 1B8B83C617080D77CB4247B1E964C2959C507AB2DB0F1F3BF3E3B299CA00CAE3</code><br/>
<code> </code><br/>
<code> Whirlpool("The quick brown fox jumps over the lazy eog") =</code><br/>
<code> C27BA124205F72E6847F3E19834F925CC666D0974167AF915BB462420ED40CC5</code><br/>
<code> 0900D85A1F923219D832357750492D5C143011A76988344C2635E69D06F2D38C</code></p>

<p>The hash of a zero-length string is:</p>

<p><code> Whirlpool-0("") =</code><br/>
<code> B3E1AB6EAF640A34F784593F2074416ACCD3B8E62C620175FCA0997B1BA23473</code><br/>
<code> 39AA0D79E754C308209EA36811DFA40C1C32F1A2B9004725D987D3635165D3C8</code><br/>
<br/>
<code> Whirlpool-T("") =</code><br/>
<code> 470F0409ABAA446E49667D4EBE12A14387CEDBD10DD17B8243CAD550A089DC0F</code><br/>
<code> EEA7AA40F6C2AAAB71C6EBD076E43C7CFCA0AD32567897DCB5969861049A0F5A</code><br/>
<br/>
<code> Whirlpool("") =</code><br/>
<code> 19FA61D75522A4669B44E39C1D2E1726C530232130D407F89AFEE0964997F7A7</code><br/>
<code> 3E83BE698B288FEBCF88E3E03C4F0757EA8964E59B63D93708B138CC42A66EB3</code></p>
<h2 id="implementations">Implementations</h2>

<p>The authors provide <a href="reference_implementation" title="wikilink">reference implementations</a> of the WHIRLPOOL algorithm, including a version written in <a href="C_(programming_language)" title="wikilink">C</a> and a version written in <a href="Java_(programming_language)" title="wikilink">Java</a>.<a class="footnoteRef" href="#fn5" id="fnref5"><sup>5</sup></a> These reference implementations have been released into the public domain.<a class="footnoteRef" href="#fn6" id="fnref6"><sup>6</sup></a></p>

<p>Two of the first widely used mainstream cryptographic programs that started using Whirlpool were <a class="uri" href="FreeOTFE" title="wikilink">FreeOTFE</a>, followed by <a class="uri" href="TrueCrypt" title="wikilink">TrueCrypt</a> in 2005.</p>
<h2 id="see-also">See also</h2>
<ul>
<li><a href="Digital_timestamping" title="wikilink">Digital timestamping</a></li>
<li><a class="uri" href="Hashcash" title="wikilink">Hashcash</a></li>
</ul>
<h2 id="references">References</h2>
<references>
</references>
<h2 id="external-links">External links</h2>
<ul>
<li><a href="http://www.larc.usp.br/~pbarreto/WhirlpoolPage.html">Whirlpool homepage</a> Includes detailed algorithm information, C and Java implementations, the paper, etc.</li>
<li><a href="http://sourceforge.net/projects/jacksum">A Java implementation of all three revisions of Whirlpool</a></li>
<li><a href="http://github.com/jzelinskie/whirlpool/">An open source Go implementation of the latest revision of Whirlpool</a></li>
<li><a href="http://www.karljapetre.com/whirlpool/">A Matlab Implementation of the Whirlpool Hashing Function</a></li>
<li><a href="http://compressme.net/">CHK</a> Freeware Checksum Utility with GUI and WHIRLPOOL support</li>
<li><a href="http://rhash.sourceforge.net/">RHash</a>, an <a href="open_source" title="wikilink">open source</a> command-line tool, which can calculate and verify Whirlpool hash.</li>
<li>[<a class="uri" href="https://metacpan.org/module/Digest">https://metacpan.org/module/Digest</a>::Whirlpool Perl Whirlpool module at CPAN]</li>
<li><a href="http://raa.ruby-lang.org/project/whirlpool/">Ruby Whirlpool library</a></li>
<li><a href="http://www.cliki.net/Ironclad">Ironclad: a Common Lisp cryptography package containing a Whirlpool implementation</a></li>
<li>[<a class="uri" href="http://www.iso.org/iso/en/CatalogueDetailPage.CatalogueDetail?CSNUMBER=39876&amp;scopelist">http://www.iso.org/iso/en/CatalogueDetailPage.CatalogueDetail?CSNUMBER=39876&amp;scopelist;</a>;= The ISO/IEC 10118-3 standard]</li>
<li><a href="http://www.cosic.esat.kuleuven.be/nessie/testvectors/hash/whirlpool/index.html">Test vectors for the Whirlpool hash from the NESSIE project</a></li>
<li><a href="https://code.google.com/p/csharptest-net/source/browse/src/Library/Crypto/WhirlpoolManaged.cs">Managed C# implementation</a></li>
</ul>

<p>"</p>

<p><a href="Category:Cryptographic_hash_functions" title="wikilink">Category:Cryptographic hash functions</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1"><a href="#fnref1">↩</a></li>
<li id="fn2"><a href="#fnref2">↩</a></li>
<li id="fn3"></li>
<li id="fn4"></li>
<li id="fn5"></li>
<li id="fn6"></li>
</ol>
</section>
</body>
</html>

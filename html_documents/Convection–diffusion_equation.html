<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="1331">Convection–diffusion equation</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Convection–diffusion equation</h1>
<hr/>

<p>The <strong>convection–diffusion equation</strong> is a combination of the <a href="diffusion_equation" title="wikilink">diffusion</a> and convection (<a href="advection_equation" title="wikilink">advection</a>) equations, and describes physical phenomena where particles, energy, or other physical quantities are transferred inside a physical system due to two processes: <a class="uri" href="diffusion" title="wikilink">diffusion</a> and <a class="uri" href="convection" title="wikilink">convection</a>. Depending on context, the same equation can be called the <strong><a class="uri" href="advection" title="wikilink">advection</a>–diffusion equation</strong>, <strong><a href="drift_velocity" title="wikilink">drift</a>–diffusion equation</strong>,<a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a> or <strong>(generic) scalar transport equation</strong>.<a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a></p>
<h2 id="equation">Equation</h2>
<h3 id="general">General</h3>

<p>The general equation is<a class="footnoteRef" href="#fn3" id="fnref3"><sup>3</sup></a><a class="footnoteRef" href="#fn4" id="fnref4"><sup>4</sup></a></p>

<p>

<math display="block" id="Convection–diffusion_equation:0">
 <semantics>
  <mrow>
   <mfrac>
    <mrow>
     <mo>∂</mo>
     <mi>c</mi>
    </mrow>
    <mrow>
     <mo>∂</mo>
     <mi>t</mi>
    </mrow>
   </mfrac>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mrow>
      <mo>∇</mo>
      <mo>⋅</mo>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mi>D</mi>
        <mrow>
         <mo>∇</mo>
         <mi>c</mi>
        </mrow>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo>-</mo>
     <mrow>
      <mo>∇</mo>
      <mo>⋅</mo>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mover accent="true">
         <mi>v</mi>
         <mo stretchy="false">→</mo>
        </mover>
        <mi>c</mi>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mrow>
    <mo>+</mo>
    <mi>R</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <divide></divide>
     <apply>
      <partialdiff></partialdiff>
      <ci>c</ci>
     </apply>
     <apply>
      <partialdiff></partialdiff>
      <ci>t</ci>
     </apply>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <minus></minus>
      <apply>
       <ci>normal-⋅</ci>
       <ci>normal-∇</ci>
       <apply>
        <times></times>
        <ci>D</ci>
        <apply>
         <ci>normal-∇</ci>
         <ci>c</ci>
        </apply>
       </apply>
      </apply>
      <apply>
       <ci>normal-⋅</ci>
       <ci>normal-∇</ci>
       <apply>
        <times></times>
        <apply>
         <ci>normal-→</ci>
         <ci>v</ci>
        </apply>
        <ci>c</ci>
       </apply>
      </apply>
     </apply>
     <ci>R</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \frac{\partial c}{\partial t}=\nabla\cdot(D\nabla c)-\nabla\cdot(\vec{v}c)+R
  </annotation>
 </semantics>
</math>

 where</p>
<ul>
<li><em>c</em> is the variable of interest (species concentration for <a href="mass_transfer" title="wikilink">mass transfer</a>, temperature for <a href="heat_transfer" title="wikilink">heat transfer</a>),</li>
<li><em>D</em> is the diffusivity (also called <a href="diffusion_coefficient" title="wikilink">diffusion coefficient</a>), such as <a href="mass_diffusivity" title="wikilink">mass diffusivity</a> for particle motion or <a href="thermal_diffusivity" title="wikilink">thermal diffusivity</a> for heat transport,</li>
<li>

<math display="inline" id="Convection–diffusion_equation:1">
 <semantics>
  <mover accent="true">
   <mi>v</mi>
   <mo stretchy="false">→</mo>
  </mover>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-→</ci>
    <ci>v</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \vec{v}
  </annotation>
 </semantics>
</math>

 is the average <a class="uri" href="velocity" title="wikilink">velocity</a> that the quantity is moving. For example, in <a class="uri" href="advection" title="wikilink">advection</a>, <em>c</em> might be the concentration of salt in a river, and then 

<math display="inline" id="Convection–diffusion_equation:2">
 <semantics>
  <mover accent="true">
   <mi>v</mi>
   <mo stretchy="false">→</mo>
  </mover>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-→</ci>
    <ci>v</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \vec{v}
  </annotation>
 </semantics>
</math>

 would be the velocity of the water flow. As another example, <em>c</em> might be the concentration of small bubbles in a calm lake, and then 

<math display="inline" id="Convection–diffusion_equation:3">
 <semantics>
  <mover accent="true">
   <mi>v</mi>
   <mo stretchy="false">→</mo>
  </mover>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-→</ci>
    <ci>v</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \vec{v}
  </annotation>
 </semantics>
</math>

 would be the average velocity of bubbles rising towards the surface by <a class="uri" href="buoyancy" title="wikilink">buoyancy</a> (see <a href="#Velocity_in_response_to_a_force" title="wikilink">below</a>). For <a href="multiphase_flow" title="wikilink">multiphase flows</a> and flows in <a href="porous_media" title="wikilink">porous media</a>, 

<math display="inline" id="Convection–diffusion_equation:4">
 <semantics>
  <mover accent="true">
   <mi>v</mi>
   <mo stretchy="false">→</mo>
  </mover>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-→</ci>
    <ci>v</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \vec{v}
  </annotation>
 </semantics>
</math>

 is the (hypothetical) <a href="superficial_velocity" title="wikilink">superficial velocity</a>.</li>
<li><em>R</em> describes "sources" or "sinks" of the quantity <em>c</em>. For example, for a chemical species, <em>R</em>&gt;0 means that a <a href="chemical_reaction" title="wikilink">chemical reaction</a> is creating more of the species, and <em>R</em>0 might occur if thermal energy is being generated by <a class="uri" href="friction" title="wikilink">friction</a>.</li>
<li>

<math display="inline" id="Convection–diffusion_equation:5">
 <semantics>
  <mo>∇</mo>
  <annotation-xml encoding="MathML-Content">
   <ci>normal-∇</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \nabla
  </annotation>
 </semantics>
</math>

 represents <a class="uri" href="gradient" title="wikilink">gradient</a> and 

<math display="inline" id="Convection–diffusion_equation:6">
 <semantics>
  <mrow>
   <mo>∇</mo>
   <mo>⋅</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <ci>normal-∇</ci>
    <ci>normal-⋅</ci>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \nabla\cdot
  </annotation>
 </semantics>
</math>

 represents <a class="uri" href="divergence" title="wikilink">divergence</a>.</li>
</ul>
<h3 id="understanding-the-terms-involved">Understanding the terms involved</h3>

<p>The right-hand side of the equation is the sum of three contributions.</p>
<ul>
<li>The first, 

<math display="inline" id="Convection–diffusion_equation:7">
 <semantics>
  <mrow>
   <mo>∇</mo>
   <mo>⋅</mo>
   <mrow>
    <mo stretchy="false">(</mo>
    <mrow>
     <mi>D</mi>
     <mrow>
      <mo>∇</mo>
      <mi>c</mi>
     </mrow>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-⋅</ci>
    <ci>normal-∇</ci>
    <apply>
     <times></times>
     <ci>D</ci>
     <apply>
      <ci>normal-∇</ci>
      <ci>c</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \nabla\cdot(D\nabla c)
  </annotation>
 </semantics>
</math>

, describes <a href="diffusion_equation" title="wikilink">diffusion</a>. Imagine that <em>c</em> is the concentration of a chemical. When concentration is low somewhere compared to the surrounding areas (e.g. a <a href="local_minimum" title="wikilink">local minimum</a> of concentration), the substance will diffuse in from the surroundings, so the concentration will increase. Conversely, if concentration is high compared to the surroundings (e.g. a <a href="local_maximum" title="wikilink">local maximum</a> of concentration), then the substance will diffuse out and the concentration will decrease. The net diffusion is proportional to the <a class="uri" href="Laplacian" title="wikilink">Laplacian</a> (or <a href="second_derivative" title="wikilink">second derivative</a>) of concentration.</li>
<li>The second contribution, 

<math display="inline" id="Convection–diffusion_equation:8">
 <semantics>
  <mrow>
   <mo>-</mo>
   <mrow>
    <mo>∇</mo>
    <mo>⋅</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mover accent="true">
       <mi>v</mi>
       <mo stretchy="false">→</mo>
      </mover>
      <mi>c</mi>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <minus></minus>
    <apply>
     <ci>normal-⋅</ci>
     <ci>normal-∇</ci>
     <apply>
      <times></times>
      <apply>
       <ci>normal-→</ci>
       <ci>v</ci>
      </apply>
      <ci>c</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   -\nabla\cdot(\vec{v}c)
  </annotation>
 </semantics>
</math>

, describes <a href="advection_equation" title="wikilink">convection</a> (or advection). Imagine standing on the bank of a river, measuring the water's salinity (amount of salt) each second. Upstream, somebody dumps a bucket of salt into the river. A while later, you would see the salinity suddenly rise, then fall, as the zone of salty water passes by. Thus, the concentration <em>at a given location</em> can change because of the flow.</li>
<li>The final contribution, <em>R</em>, describes the creation or destruction of the quantity. For example, if <em>c</em> is the concentration of a molecule, then <em>R</em> describes how the molecule can be created or destroyed by chemical reactions. <em>R</em> may be a function of <em>c</em> and of other parameters. Often there are several quantities, each with its own convection-diffusion equation, where the destruction of one quantity entails the creation of another. For example, when methane burns, it involves not only the destruction of methane and oxygen but also the creation of carbon dioxide and water vapor. Therefore, while each of these chemicals has its own convection-diffusion equation, they are "coupled together" and must be solved as a system of <em>simultaneous</em> differential equations.</li>
</ul>
<h3 id="common-simplifications">Common simplifications</h3>

<p>In a common situation, the diffusion coefficient is constant, there are no sources or sinks, and the velocity field describes an <a href="incompressible_flow" title="wikilink">incompressible flow</a> (i.e., it has <a href="Solenoidal_vector_field" title="wikilink">zero divergence</a>). Then the formula simplifies to:<a class="footnoteRef" href="#fn5" id="fnref5"><sup>5</sup></a><a class="footnoteRef" href="#fn6" id="fnref6"><sup>6</sup></a><a class="footnoteRef" href="#fn7" id="fnref7"><sup>7</sup></a></p>

<p>

<math display="block" id="Convection–diffusion_equation:9">
 <semantics>
  <mrow>
   <mrow>
    <mfrac>
     <mrow>
      <mo>∂</mo>
      <mi>c</mi>
     </mrow>
     <mrow>
      <mo>∂</mo>
      <mi>t</mi>
     </mrow>
    </mfrac>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mi>D</mi>
      <mrow>
       <msup>
        <mo>∇</mo>
        <mn>2</mn>
       </msup>
       <mi>c</mi>
      </mrow>
     </mrow>
     <mo>-</mo>
     <mrow>
      <mover accent="true">
       <mi>v</mi>
       <mo stretchy="false">→</mo>
      </mover>
      <mo>⋅</mo>
      <mrow>
       <mo>∇</mo>
       <mi>c</mi>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <divide></divide>
     <apply>
      <partialdiff></partialdiff>
      <ci>c</ci>
     </apply>
     <apply>
      <partialdiff></partialdiff>
      <ci>t</ci>
     </apply>
    </apply>
    <apply>
     <minus></minus>
     <apply>
      <times></times>
      <ci>D</ci>
      <apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>normal-∇</ci>
        <cn type="integer">2</cn>
       </apply>
       <ci>c</ci>
      </apply>
     </apply>
     <apply>
      <ci>normal-⋅</ci>
      <apply>
       <ci>normal-→</ci>
       <ci>v</ci>
      </apply>
      <apply>
       <ci>normal-∇</ci>
       <ci>c</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \frac{\partial c}{\partial t}=D\nabla^{2}c-\vec{v}\cdot\nabla c.
  </annotation>
 </semantics>
</math>

</p>

<p>In this form, the convection–diffusion equation combines both <a href="parabolic_partial_differential_equation" title="wikilink">parabolic</a> and <a href="hyperbolic_partial_differential_equation" title="wikilink">hyperbolic</a> <a href="partial_differential_equations" title="wikilink">partial differential equations</a>.</p>
<h3 id="stationary-version">Stationary version</h3>

<p>The <strong>stationary convection–diffusion equation</strong> describes the <a class="uri" href="steady-state" title="wikilink">steady-state</a> behavior of a convective-diffusive system. In steady-state, 

<math display="inline" id="Convection–diffusion_equation:10">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mo>∂</mo>
     <mi>c</mi>
    </mrow>
    <mo>/</mo>
    <mrow>
     <mo>∂</mo>
     <mi>t</mi>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <divide></divide>
     <apply>
      <partialdiff></partialdiff>
      <ci>c</ci>
     </apply>
     <apply>
      <partialdiff></partialdiff>
      <ci>t</ci>
     </apply>
    </apply>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \partial c/\partial t=0
  </annotation>
 </semantics>
</math>

, so the formula is:</p>

<p>

<math display="block" id="Convection–diffusion_equation:11">
 <semantics>
  <mrow>
   <mrow>
    <mn>0</mn>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mrow>
       <mo>∇</mo>
       <mo>⋅</mo>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mi>D</mi>
         <mrow>
          <mo>∇</mo>
          <mi>c</mi>
         </mrow>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
      <mo>-</mo>
      <mrow>
       <mo>∇</mo>
       <mo>⋅</mo>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mover accent="true">
          <mi>v</mi>
          <mo stretchy="false">→</mo>
         </mover>
         <mi>c</mi>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
     </mrow>
     <mo>+</mo>
     <mi>R</mi>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <cn type="integer">0</cn>
    <apply>
     <plus></plus>
     <apply>
      <minus></minus>
      <apply>
       <ci>normal-⋅</ci>
       <ci>normal-∇</ci>
       <apply>
        <times></times>
        <ci>D</ci>
        <apply>
         <ci>normal-∇</ci>
         <ci>c</ci>
        </apply>
       </apply>
      </apply>
      <apply>
       <ci>normal-⋅</ci>
       <ci>normal-∇</ci>
       <apply>
        <times></times>
        <apply>
         <ci>normal-→</ci>
         <ci>v</ci>
        </apply>
        <ci>c</ci>
       </apply>
      </apply>
     </apply>
     <ci>R</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   0=\nabla\cdot(D\nabla c)-\nabla\cdot(\vec{v}c)+R.
  </annotation>
 </semantics>
</math>

</p>
<h2 id="derivation">Derivation</h2>

<p>The convection–diffusion equation can be derived in a straightforward way<a class="footnoteRef" href="#fn8" id="fnref8"><sup>8</sup></a> from the <a href="Continuity_equation#Differential_form" title="wikilink">continuity equation</a>, which states that the rate of change for a <a href="Scalar_(physics)" title="wikilink">scalar quantity</a> in a <a href="Differential_(infinitesimal)" title="wikilink">differential</a> <a href="control_volume" title="wikilink">control volume</a> is given by flow and diffusion into and out of that part of the system along with any generation or consumption inside the control volume:</p>

<p>

<math display="block" id="Convection–diffusion_equation:12">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mfrac>
      <mrow>
       <mo>∂</mo>
       <mi>c</mi>
      </mrow>
      <mrow>
       <mo>∂</mo>
       <mi>t</mi>
      </mrow>
     </mfrac>
     <mo>+</mo>
     <mrow>
      <mo>∇</mo>
      <mo>⋅</mo>
      <mover accent="true">
       <mi>j</mi>
       <mo stretchy="false">→</mo>
      </mover>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mi>R</mi>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <plus></plus>
     <apply>
      <divide></divide>
      <apply>
       <partialdiff></partialdiff>
       <ci>c</ci>
      </apply>
      <apply>
       <partialdiff></partialdiff>
       <ci>t</ci>
      </apply>
     </apply>
     <apply>
      <ci>normal-⋅</ci>
      <ci>normal-∇</ci>
      <apply>
       <ci>normal-→</ci>
       <ci>j</ci>
      </apply>
     </apply>
    </apply>
    <ci>R</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \frac{\partial c}{\partial t}+\nabla\cdot\vec{j}=R,
  </annotation>
 </semantics>
</math>

 where 

<math display="inline" id="Convection–diffusion_equation:13">
 <semantics>
  <mover accent="true">
   <mi>j</mi>
   <mo stretchy="false">→</mo>
  </mover>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-→</ci>
    <ci>j</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \vec{j}
  </annotation>
 </semantics>
</math>

 is the total <a class="uri" href="flux" title="wikilink">flux</a> and <em>R</em> is a net volumetric source for <em>c</em>. There are two sources of flux in this situation. First, <strong>diffusive flux</strong> arises due to <a class="uri" href="diffusion" title="wikilink">diffusion</a>. This is typically approximated by <a href="Fick's_law" title="wikilink">Fick's first law</a>:</p>

<p>

<math display="block" id="Convection–diffusion_equation:14">
 <semantics>
  <mrow>
   <msub>
    <mover accent="true">
     <mi>j</mi>
     <mo stretchy="false">→</mo>
    </mover>
    <mtext>diffusion</mtext>
   </msub>
   <mo>=</mo>
   <mrow>
    <mo>-</mo>
    <mrow>
     <mpadded width="+1.7pt">
      <mi>D</mi>
     </mpadded>
     <mrow>
      <mo>∇</mo>
      <mi>c</mi>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <ci>normal-→</ci>
      <ci>j</ci>
     </apply>
     <mtext>diffusion</mtext>
    </apply>
    <apply>
     <minus></minus>
     <apply>
      <times></times>
      <ci>D</ci>
      <apply>
       <ci>normal-∇</ci>
       <ci>c</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \vec{j}_{\text{diffusion}}=-D\,\nabla c
  </annotation>
 </semantics>
</math>

 i.e., the flux of the diffusing material (relative to the bulk motion) in any part of the system is proportional to the local concentration <a class="uri" href="gradient" title="wikilink">gradient</a>. Second, when there is overall convection or flow, there is an associated flux called <strong><a href="advection" title="wikilink">advective flux</a></strong>:</p>

<p>

<math display="block" id="Convection–diffusion_equation:15">
 <semantics>
  <mrow>
   <msub>
    <mover accent="true">
     <mi>j</mi>
     <mo stretchy="false">→</mo>
    </mover>
    <mtext>advective</mtext>
   </msub>
   <mo>=</mo>
   <mrow>
    <mpadded width="+1.7pt">
     <mover accent="true">
      <mi>v</mi>
      <mo stretchy="false">→</mo>
     </mover>
    </mpadded>
    <mi>c</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <ci>normal-→</ci>
      <ci>j</ci>
     </apply>
     <mtext>advective</mtext>
    </apply>
    <apply>
     <times></times>
     <apply>
      <ci>normal-→</ci>
      <ci>v</ci>
     </apply>
     <ci>c</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \vec{j}_{\text{advective}}=\vec{v}\,c
  </annotation>
 </semantics>
</math>

 The total flux (in a stationary coordinate system) is given by the sum of these two:</p>

<p>

<math display="block" id="Convection–diffusion_equation:16">
 <semantics>
  <mrow>
   <mrow>
    <mover accent="true">
     <mi>j</mi>
     <mo stretchy="false">→</mo>
    </mover>
    <mo>=</mo>
    <mrow>
     <msub>
      <mover accent="true">
       <mi>j</mi>
       <mo stretchy="false">→</mo>
      </mover>
      <mtext>diffusion</mtext>
     </msub>
     <mo>+</mo>
     <msub>
      <mover accent="true">
       <mi>j</mi>
       <mo stretchy="false">→</mo>
      </mover>
      <mtext>advective</mtext>
     </msub>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mo>-</mo>
      <mrow>
       <mpadded width="+1.7pt">
        <mi>D</mi>
       </mpadded>
       <mrow>
        <mo>∇</mo>
        <mi>c</mi>
       </mrow>
      </mrow>
     </mrow>
     <mo>+</mo>
     <mrow>
      <mpadded width="+1.7pt">
       <mover accent="true">
        <mi>v</mi>
        <mo stretchy="false">→</mo>
       </mover>
      </mpadded>
      <mi>c</mi>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <ci>normal-→</ci>
      <ci>j</ci>
     </apply>
     <apply>
      <plus></plus>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <apply>
        <ci>normal-→</ci>
        <ci>j</ci>
       </apply>
       <mtext>diffusion</mtext>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <apply>
        <ci>normal-→</ci>
        <ci>j</ci>
       </apply>
       <mtext>advective</mtext>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <plus></plus>
      <apply>
       <minus></minus>
       <apply>
        <times></times>
        <ci>D</ci>
        <apply>
         <ci>normal-∇</ci>
         <ci>c</ci>
        </apply>
       </apply>
      </apply>
      <apply>
       <times></times>
       <apply>
        <ci>normal-→</ci>
        <ci>v</ci>
       </apply>
       <ci>c</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \vec{j}=\vec{j}_{\text{diffusion}}+\vec{j}_{\text{advective}}=-D\,\nabla c+%
\vec{v}\,c.
  </annotation>
 </semantics>
</math>

 Plugging into the continuity equation:</p>

<p>

<math display="block" id="Convection–diffusion_equation:17">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mfrac>
      <mrow>
       <mo>∂</mo>
       <mi>c</mi>
      </mrow>
      <mrow>
       <mo>∂</mo>
       <mi>t</mi>
      </mrow>
     </mfrac>
     <mo>+</mo>
     <mrow>
      <mo>∇</mo>
      <mo>⋅</mo>
      <mrow>
       <mo>(</mo>
       <mrow>
        <mrow>
         <mo>-</mo>
         <mrow>
          <mpadded width="+1.7pt">
           <mi>D</mi>
          </mpadded>
          <mrow>
           <mo>∇</mo>
           <mi>c</mi>
          </mrow>
         </mrow>
        </mrow>
        <mo>+</mo>
        <mrow>
         <mpadded width="+1.7pt">
          <mover accent="true">
           <mi>v</mi>
           <mo stretchy="false">→</mo>
          </mover>
         </mpadded>
         <mi>c</mi>
        </mrow>
       </mrow>
       <mo>)</mo>
      </mrow>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mi>R</mi>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <plus></plus>
     <apply>
      <divide></divide>
      <apply>
       <partialdiff></partialdiff>
       <ci>c</ci>
      </apply>
      <apply>
       <partialdiff></partialdiff>
       <ci>t</ci>
      </apply>
     </apply>
     <apply>
      <ci>normal-⋅</ci>
      <ci>normal-∇</ci>
      <apply>
       <plus></plus>
       <apply>
        <minus></minus>
        <apply>
         <times></times>
         <ci>D</ci>
         <apply>
          <ci>normal-∇</ci>
          <ci>c</ci>
         </apply>
        </apply>
       </apply>
       <apply>
        <times></times>
        <apply>
         <ci>normal-→</ci>
         <ci>v</ci>
        </apply>
        <ci>c</ci>
       </apply>
      </apply>
     </apply>
    </apply>
    <ci>R</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \frac{\partial c}{\partial t}+\nabla\cdot\left(-D\,\nabla c+\vec{v}\,c\right)=R.
  </annotation>
 </semantics>
</math>

</p>
<h2 id="complex-mixing-phenomena">Complex mixing phenomena</h2>

<p>In general, <em>D</em>, 

<math display="inline" id="Convection–diffusion_equation:18">
 <semantics>
  <mover accent="true">
   <mi>v</mi>
   <mo stretchy="false">→</mo>
  </mover>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-→</ci>
    <ci>v</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \vec{v}
  </annotation>
 </semantics>
</math>

, and <em>s</em> may vary with space and time. In cases in which they depend on concentration as well, the equation becomes nonlinear, giving rise to many distinctive mixing phenomena such as <a href="Rayleigh–Bénard_convection" title="wikilink">Rayleigh–Bénard convection</a> when 

<math display="inline" id="Convection–diffusion_equation:19">
 <semantics>
  <mover accent="true">
   <mi>v</mi>
   <mo stretchy="false">→</mo>
  </mover>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-→</ci>
    <ci>v</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \vec{v}
  </annotation>
 </semantics>
</math>

 depends on temperature in the heat transfer formulation and <a href="Reaction–diffusion_system" title="wikilink">reaction-diffusion</a> pattern formation when <em>s</em> depends on concentration in the mass transfer formulation.</p>
<h2 id="velocity-in-response-to-a-force">Velocity in response to a force</h2>

<p>In some cases, the average velocity field 

<math display="inline" id="Convection–diffusion_equation:20">
 <semantics>
  <mover accent="true">
   <mi>v</mi>
   <mo stretchy="false">→</mo>
  </mover>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-→</ci>
    <ci>v</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \vec{v}
  </annotation>
 </semantics>
</math>

 exists because of a force; for example, the equation might describe the flow of ions dissolved in a liquid, with an <a href="electric_field" title="wikilink">electric field</a> pulling the ions in some direction (as in <a href="gel_electrophoresis" title="wikilink">gel electrophoresis</a>). In this situation, it is usually called the <strong>drift-diffusion equation</strong> or the <strong>Smoluchowski equation</strong>,<a class="footnoteRef" href="#fn9" id="fnref9"><sup>9</sup></a> after <a href="Marian_Smoluchowski" title="wikilink">Marian Smoluchowski</a> who described it in 1915<a class="footnoteRef" href="#fn10" id="fnref10"><sup>10</sup></a> (not to be confused with the <a href="Einstein_relation_(kinetic_theory)" title="wikilink">Einstein–Smoluchowski relation</a> or <a href="Smoluchowski_coagulation_equation" title="wikilink">Smoluchowski coagulation equation</a>).</p>

<p>Typically, the average velocity is directly proportional to the applied force, giving the equation:<a class="footnoteRef" href="#fn11" id="fnref11"><sup>11</sup></a><a class="footnoteRef" href="#fn12" id="fnref12"><sup>12</sup></a></p>

<p>

<math display="block" id="Convection–diffusion_equation:21">
 <semantics>
  <mrow>
   <mfrac>
    <mrow>
     <mo>∂</mo>
     <mi>c</mi>
    </mrow>
    <mrow>
     <mo>∂</mo>
     <mi>t</mi>
    </mrow>
   </mfrac>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mrow>
      <mo>∇</mo>
      <mo>⋅</mo>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mi>D</mi>
        <mrow>
         <mo>∇</mo>
         <mi>c</mi>
        </mrow>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo>-</mo>
     <mrow>
      <mo>∇</mo>
      <mo>⋅</mo>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <msup>
         <mi>ζ</mi>
         <mrow>
          <mo>-</mo>
          <mn>1</mn>
         </mrow>
        </msup>
        <mover accent="true">
         <mi>F</mi>
         <mo stretchy="false">→</mo>
        </mover>
        <mi>c</mi>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mrow>
    <mo>+</mo>
    <mi>R</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <divide></divide>
     <apply>
      <partialdiff></partialdiff>
      <ci>c</ci>
     </apply>
     <apply>
      <partialdiff></partialdiff>
      <ci>t</ci>
     </apply>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <minus></minus>
      <apply>
       <ci>normal-⋅</ci>
       <ci>normal-∇</ci>
       <apply>
        <times></times>
        <ci>D</ci>
        <apply>
         <ci>normal-∇</ci>
         <ci>c</ci>
        </apply>
       </apply>
      </apply>
      <apply>
       <ci>normal-⋅</ci>
       <ci>normal-∇</ci>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>ζ</ci>
         <apply>
          <minus></minus>
          <cn type="integer">1</cn>
         </apply>
        </apply>
        <apply>
         <ci>normal-→</ci>
         <ci>F</ci>
        </apply>
        <ci>c</ci>
       </apply>
      </apply>
     </apply>
     <ci>R</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \frac{\partial c}{\partial t}=\nabla\cdot(D\nabla c)-\nabla\cdot(\zeta^{-1}%
\vec{F}c)+R
  </annotation>
 </semantics>
</math>

 where 

<math display="inline" id="Convection–diffusion_equation:22">
 <semantics>
  <mover accent="true">
   <mi>F</mi>
   <mo stretchy="false">→</mo>
  </mover>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-→</ci>
    <ci>F</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \vec{F}
  </annotation>
 </semantics>
</math>

 is the force, and 

<math display="inline" id="Convection–diffusion_equation:23">
 <semantics>
  <mi>ζ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>ζ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \zeta
  </annotation>
 </semantics>
</math>

 characterizes the friction or <a href="Drag_(physics)" title="wikilink">viscous drag</a>. (The inverse 

<math display="inline" id="Convection–diffusion_equation:24">
 <semantics>
  <msup>
   <mi>ζ</mi>
   <mrow>
    <mo>-</mo>
    <mn>1</mn>
   </mrow>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>ζ</ci>
    <apply>
     <minus></minus>
     <cn type="integer">1</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \zeta^{-1}
  </annotation>
 </semantics>
</math>

 is called <a href="Einstein_relation_(kinetic_theory)" title="wikilink">mobility</a>.)</p>
<h3 id="derivation-of-einstein-relation">Derivation of Einstein relation</h3>

<p>When the force is associated with a <a href="potential_energy" title="wikilink">potential energy</a> 

<math display="inline" id="Convection–diffusion_equation:25">
 <semantics>
  <mrow>
   <mover accent="true">
    <mi>F</mi>
    <mo stretchy="false">→</mo>
   </mover>
   <mo>=</mo>
   <mrow>
    <mo>-</mo>
    <mrow>
     <mo>∇</mo>
     <mi>U</mi>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <ci>normal-→</ci>
     <ci>F</ci>
    </apply>
    <apply>
     <minus></minus>
     <apply>
      <ci>normal-∇</ci>
      <ci>U</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \vec{F}=-\nabla U
  </annotation>
 </semantics>
</math>

 (see <a href="conservative_force" title="wikilink">conservative force</a>), a <a class="uri" href="steady-state" title="wikilink">steady-state</a> solution to the above equation (i.e. 0 = <em>R</em> = ∂<em>c</em>/∂<em>t</em>) is:</p>

<p>

<math display="block" id="Convection–diffusion_equation:26">
 <semantics>
  <mrow>
   <mi>c</mi>
   <mo>∝</mo>
   <mrow>
    <mi>exp</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mo>-</mo>
      <mrow>
       <msup>
        <mi>D</mi>
        <mrow>
         <mo>-</mo>
         <mn>1</mn>
        </mrow>
       </msup>
       <msup>
        <mi>ζ</mi>
        <mrow>
         <mo>-</mo>
         <mn>1</mn>
        </mrow>
       </msup>
       <mi>U</mi>
      </mrow>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">proportional-to</csymbol>
    <ci>c</ci>
    <apply>
     <exp></exp>
     <apply>
      <minus></minus>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>D</ci>
        <apply>
         <minus></minus>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>ζ</ci>
        <apply>
         <minus></minus>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <ci>U</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   c\propto\exp(-D^{-1}\zeta^{-1}U)
  </annotation>
 </semantics>
</math>

 (assuming <em>D</em> and 

<math display="inline" id="Convection–diffusion_equation:27">
 <semantics>
  <mi>ζ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>ζ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \zeta
  </annotation>
 </semantics>
</math>

 are constant). In other words, there are more particles where the energy is lower. This concentration profile is expected to agree with the <a href="Boltzmann_distribution" title="wikilink">Boltzmann distribution</a> (more precisely, the <a href="Gibbs_measure" title="wikilink">Gibbs measure</a>). From this assumption, the <a href="Einstein_relation_(kinetic_theory)" title="wikilink">Einstein relation</a> can be proven

<math display="block" id="Convection–diffusion_equation:28">
 <semantics>
  <mrow>
   <mrow>
    <mi>D</mi>
    <mi>ζ</mi>
   </mrow>
   <mo>=</mo>
   <mrow>
    <msub>
     <mi>k</mi>
     <mi>B</mi>
    </msub>
    <mi>T</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>D</ci>
     <ci>ζ</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>k</ci>
      <ci>B</ci>
     </apply>
     <ci>T</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   D\zeta=k_{B}T
  </annotation>
 </semantics>
</math>

.<a class="footnoteRef" href="#fn13" id="fnref13"><sup>13</sup></a></p>
<h2 id="as-a-stochastic-differential-equation">As a stochastic differential equation</h2>

<p>The convection–diffusion equation (with no sources or drains, <em>R</em>=0) can be viewed as a <a href="stochastic_differential_equation" title="wikilink">stochastic differential equation</a>, describing random motion with diffusivity <em>D</em> and bias 

<math display="inline" id="Convection–diffusion_equation:29">
 <semantics>
  <mover accent="true">
   <mi>v</mi>
   <mo stretchy="false">→</mo>
  </mover>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-→</ci>
    <ci>v</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \vec{v}
  </annotation>
 </semantics>
</math>

. For example, the equation can describe the Brownian motion of a single particle, where the variable <em>c</em> describes the <a href="probability_distribution" title="wikilink">probability distribution</a> for the particle to be in a given position at a given time. The reason the equation can be used that way is because there is no mathematical difference between the probability distribution of a single particle, and the concentration profile of a collection of infinitely many particles (as long as the particles do not interact with each other).</p>

<p>The <em><a href="Langevin_equation" title="wikilink">Langevin equation</a></em> describes advection, diffusion, and other phenomena in an explicitly stochastic way. One of the simplest forms of the Langevin equation is when its "noise term" is <a href="Gaussian_noise" title="wikilink">Gaussian</a>; in this case, the Langevin equation is exactly equivalent to the convection–diffusion equation.<a class="footnoteRef" href="#fn14" id="fnref14"><sup>14</sup></a> However, the Langevin equation is more general.<a class="footnoteRef" href="#fn15" id="fnref15"><sup>15</sup></a></p>
<h2 id="numerical-solution">Numerical solution</h2>

<p>The convection-diffusion equation can only rarely be solved with a pen and paper. More often, computers are used to numerically approximate the solution to the equation, typically using the <a href="finite_element_method" title="wikilink">finite element method</a>. For more details and algorithms see: <a href="Numerical_solution_of_the_convection–diffusion_equation" title="wikilink">Numerical solution of the convection–diffusion equation</a>.</p>
<h2 id="similar-equations-in-other-contexts">Similar equations in other contexts</h2>

<p>The convection–diffusion equation is a relatively simple equation describing flows, or alternatively, describing a stochastically-changing system. Therefore, the same or similar equation arises in many contexts unrelated to flows through space.</p>
<ul>
<li>It is formally identical to the <a href="Fokker–Planck_equation" title="wikilink">Fokker–Planck equation</a> for the velocity of a particle.</li>
<li>It is closely related to the <a href="Black–Scholes_equation" title="wikilink">Black–Scholes equation</a> and other equations in financial mathematics.</li>
<li>It is closely related to the <a href="Navier–Stokes_equations" title="wikilink">Navier–Stokes equations</a>, because the flow of <a class="uri" href="momentum" title="wikilink">momentum</a> in a fluid is mathematically similar to the flow of mass or energy. The correspondence is clearest in the case of an incompressible Newtonian fluid, in which case the Navier–Stokes equation is:</li>
</ul>

<p>

<math display="block" id="Convection–diffusion_equation:30">
 <semantics>
  <mrow>
   <mfrac>
    <mrow>
     <mo>∂</mo>
     <mi>𝐌</mi>
    </mrow>
    <mrow>
     <mo>∂</mo>
     <mi>t</mi>
    </mrow>
   </mfrac>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mrow>
      <mfrac>
       <mi>μ</mi>
       <mi>ρ</mi>
      </mfrac>
      <mrow>
       <msup>
        <mo>∇</mo>
        <mn>2</mn>
       </msup>
       <mi>𝐌</mi>
      </mrow>
     </mrow>
     <mo>-</mo>
     <mrow>
      <mi>𝐯</mi>
      <mo>⋅</mo>
      <mrow>
       <mo>∇</mo>
       <mi>𝐌</mi>
      </mrow>
     </mrow>
    </mrow>
    <mo>+</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>𝐟</mi>
      <mo>-</mo>
      <mrow>
       <mo>∇</mo>
       <mtext>P</mtext>
      </mrow>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <divide></divide>
     <apply>
      <partialdiff></partialdiff>
      <ci>𝐌</ci>
     </apply>
     <apply>
      <partialdiff></partialdiff>
      <ci>t</ci>
     </apply>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <minus></minus>
      <apply>
       <times></times>
       <apply>
        <divide></divide>
        <ci>μ</ci>
        <ci>ρ</ci>
       </apply>
       <apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>normal-∇</ci>
         <cn type="integer">2</cn>
        </apply>
        <ci>𝐌</ci>
       </apply>
      </apply>
      <apply>
       <ci>normal-⋅</ci>
       <ci>𝐯</ci>
       <apply>
        <ci>normal-∇</ci>
        <ci>𝐌</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <minus></minus>
      <ci>𝐟</ci>
      <apply>
       <ci>normal-∇</ci>
       <mtext>P</mtext>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \frac{\partial\mathbf{M}}{\partial t}=\frac{\mu}{\rho}\nabla^{2}\mathbf{M}-%
\mathbf{v}\cdot\nabla\mathbf{M}+(\mathbf{f}-\nabla\text{P})
  </annotation>
 </semantics>
</math>

 where <strong>M</strong> is the momentum of the fluid (per unit volume) at each point (equal to the density 

<math display="inline" id="Convection–diffusion_equation:31">
 <semantics>
  <mi>ρ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>ρ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \rho
  </annotation>
 </semantics>
</math>

 multiplied by the velocity <strong>v</strong>), 

<math display="inline" id="Convection–diffusion_equation:32">
 <semantics>
  <mi>μ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>μ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mu
  </annotation>
 </semantics>
</math>

 is viscosity, P is fluid pressure, and <strong>f</strong> is any other <a href="body_force" title="wikilink">body force</a> such as <a class="uri" href="gravity" title="wikilink">gravity</a>. In this equation, the term on the left-hand side describes the change in momentum at a given point; the first term on the right describes <a class="uri" href="viscosity" title="wikilink">viscosity</a>, which is really the diffusion of momentum; the second term on the right describes the advective flow of momentum; and the last two terms on the right describes the external and internal forces which can act as sources or sinks of momentum.</p>
<h2 id="in-semiconductor-physics">In semiconductor physics</h2>

<p>In <a href="semiconductor_physics" title="wikilink">semiconductor physics</a>, this equation is called the <strong>drift–diffusion equation</strong>. The word "drift" is related to <a href="drift_current" title="wikilink">drift current</a> and <a href="drift_velocity" title="wikilink">drift velocity</a>. The equation is normally written:</p>

<p>

<math display="block" id="Convection–diffusion_equation:33">
 <semantics>
  <mrow>
   <mfrac>
    <msub>
     <mi>𝐉</mi>
     <mi>n</mi>
    </msub>
    <mrow>
     <mo>-</mo>
     <mi>q</mi>
    </mrow>
   </mfrac>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mo>-</mo>
     <mrow>
      <msub>
       <mi>D</mi>
       <mi>n</mi>
      </msub>
      <mrow>
       <mo>∇</mo>
       <mi>n</mi>
      </mrow>
     </mrow>
    </mrow>
    <mo>-</mo>
    <mrow>
     <mi>n</mi>
     <msub>
      <mi>μ</mi>
      <mi>n</mi>
     </msub>
     <mi>𝐄</mi>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <divide></divide>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>𝐉</ci>
      <ci>n</ci>
     </apply>
     <apply>
      <minus></minus>
      <ci>q</ci>
     </apply>
    </apply>
    <apply>
     <minus></minus>
     <apply>
      <minus></minus>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>D</ci>
        <ci>n</ci>
       </apply>
       <apply>
        <ci>normal-∇</ci>
        <ci>n</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <ci>n</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>μ</ci>
       <ci>n</ci>
      </apply>
      <ci>𝐄</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \frac{\mathbf{J}_{n}}{-q}=-D_{n}\nabla n-n\mu_{n}\mathbf{E}
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Convection–diffusion_equation:34">
 <semantics>
  <mrow>
   <mfrac>
    <msub>
     <mi>𝐉</mi>
     <mi>p</mi>
    </msub>
    <mi>q</mi>
   </mfrac>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mo>-</mo>
     <mrow>
      <msub>
       <mi>D</mi>
       <mi>p</mi>
      </msub>
      <mrow>
       <mo>∇</mo>
       <mi>p</mi>
      </mrow>
     </mrow>
    </mrow>
    <mo>+</mo>
    <mrow>
     <mi>p</mi>
     <msub>
      <mi>μ</mi>
      <mi>p</mi>
     </msub>
     <mi>𝐄</mi>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <divide></divide>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>𝐉</ci>
      <ci>p</ci>
     </apply>
     <ci>q</ci>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <minus></minus>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>D</ci>
        <ci>p</ci>
       </apply>
       <apply>
        <ci>normal-∇</ci>
        <ci>p</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <ci>p</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>μ</ci>
       <ci>p</ci>
      </apply>
      <ci>𝐄</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \frac{\mathbf{J}_{p}}{q}=-D_{p}\nabla p+p\mu_{p}\mathbf{E}
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Convection–diffusion_equation:35">
 <semantics>
  <mrow>
   <mfrac>
    <mrow>
     <mo>∂</mo>
     <mi>n</mi>
    </mrow>
    <mrow>
     <mo>∂</mo>
     <mi>t</mi>
    </mrow>
   </mfrac>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mo>-</mo>
     <mrow>
      <mo>∇</mo>
      <mo>⋅</mo>
      <mfrac>
       <msub>
        <mi>𝐉</mi>
        <mi>n</mi>
       </msub>
       <mrow>
        <mo>-</mo>
        <mi>q</mi>
       </mrow>
      </mfrac>
     </mrow>
    </mrow>
    <mo>+</mo>
    <mi>R</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <divide></divide>
     <apply>
      <partialdiff></partialdiff>
      <ci>n</ci>
     </apply>
     <apply>
      <partialdiff></partialdiff>
      <ci>t</ci>
     </apply>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <minus></minus>
      <apply>
       <ci>normal-⋅</ci>
       <ci>normal-∇</ci>
       <apply>
        <divide></divide>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>𝐉</ci>
         <ci>n</ci>
        </apply>
        <apply>
         <minus></minus>
         <ci>q</ci>
        </apply>
       </apply>
      </apply>
     </apply>
     <ci>R</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \frac{\partial n}{\partial t}=-\nabla\cdot\frac{\mathbf{J}_{n}}{-q}+R
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Convection–diffusion_equation:36">
 <semantics>
  <mrow>
   <mfrac>
    <mrow>
     <mo>∂</mo>
     <mi>p</mi>
    </mrow>
    <mrow>
     <mo>∂</mo>
     <mi>t</mi>
    </mrow>
   </mfrac>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mo>-</mo>
     <mrow>
      <mo>∇</mo>
      <mo>⋅</mo>
      <mfrac>
       <msub>
        <mi>𝐉</mi>
        <mi>p</mi>
       </msub>
       <mi>q</mi>
      </mfrac>
     </mrow>
    </mrow>
    <mo>+</mo>
    <mi>R</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <divide></divide>
     <apply>
      <partialdiff></partialdiff>
      <ci>p</ci>
     </apply>
     <apply>
      <partialdiff></partialdiff>
      <ci>t</ci>
     </apply>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <minus></minus>
      <apply>
       <ci>normal-⋅</ci>
       <ci>normal-∇</ci>
       <apply>
        <divide></divide>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>𝐉</ci>
         <ci>p</ci>
        </apply>
        <ci>q</ci>
       </apply>
      </apply>
     </apply>
     <ci>R</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \frac{\partial p}{\partial t}=-\nabla\cdot\frac{\mathbf{J}_{p}}{q}+R
  </annotation>
 </semantics>
</math>

 where</p>
<ul>
<li><em>n</em> and <em>p</em> are the concentrations (densities) of electrons and <a href="electron_hole" title="wikilink">holes</a>, respectively,</li>
<li><em>q</em>&gt;0 is the <a href="elementary_charge" title="wikilink">elementary charge</a>,</li>
<li><em>J</em><sub>n</sub> and <em>J</em><sub>p</sub> are the <a href="electric_current" title="wikilink">electric currents</a> due to electrons and holes respectively,</li>
<li><em>J</em><sub>n</sub>/-<em>q</em> and <em>J</em><sub>p</sub>/<em>q</em> are the corresponding "particle currents" of electrons and holes respectively,</li>
<li><em>R</em> represents <a href="carrier_generation_and_recombination" title="wikilink">carrier generation and recombination</a> (<em>R</em>&gt;0 for generation of electron-hole pairs, <em>R</em>&lt;0 for recombination.)</li>
<li><strong>E</strong> is the <a href="electric_field" title="wikilink">electric field</a> vector</li>
<li>

<math display="inline" id="Convection–diffusion_equation:37">
 <semantics>
  <msub>
   <mi>μ</mi>
   <mi>n</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>μ</ci>
    <ci>n</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mu_{n}
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Convection–diffusion_equation:38">
 <semantics>
  <msub>
   <mi>μ</mi>
   <mi>p</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>μ</ci>
    <ci>p</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mu_{p}
  </annotation>
 </semantics>
</math>

 are <a href="electron_mobility" title="wikilink">electron and hole mobility</a>.</li>
</ul>

<p>The diffusion coefficient and mobility are related by the <a href="Einstein_relation_(kinetic_theory)" title="wikilink">Einstein relation</a> as above:</p>

<p>

<math display="block" id="Convection–diffusion_equation:39">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <msub>
      <mi>D</mi>
      <mi>n</mi>
     </msub>
     <mo>=</mo>
     <mrow>
      <mrow>
       <msub>
        <mi>μ</mi>
        <mi>n</mi>
       </msub>
       <msub>
        <mi>k</mi>
        <mi>B</mi>
       </msub>
       <mi>T</mi>
      </mrow>
      <mo>/</mo>
      <mi>q</mi>
     </mrow>
    </mrow>
    <mo rspace="12.5pt">,</mo>
    <mrow>
     <msub>
      <mi>D</mi>
      <mi>p</mi>
     </msub>
     <mo>=</mo>
     <mrow>
      <mrow>
       <msub>
        <mi>μ</mi>
        <mi>p</mi>
       </msub>
       <msub>
        <mi>k</mi>
        <mi>B</mi>
       </msub>
       <mi>T</mi>
      </mrow>
      <mo>/</mo>
      <mi>q</mi>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>D</ci>
      <ci>n</ci>
     </apply>
     <apply>
      <divide></divide>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>μ</ci>
        <ci>n</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>k</ci>
        <ci>B</ci>
       </apply>
       <ci>T</ci>
      </apply>
      <ci>q</ci>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>D</ci>
      <ci>p</ci>
     </apply>
     <apply>
      <divide></divide>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>μ</ci>
        <ci>p</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>k</ci>
        <ci>B</ci>
       </apply>
       <ci>T</ci>
      </apply>
      <ci>q</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   D_{n}=\mu_{n}k_{B}T/q,\quad D_{p}=\mu_{p}k_{B}T/q,
  </annotation>
 </semantics>
</math>

 where <em>k</em><sub>B</sub> is <a href="Boltzmann_constant" title="wikilink">Boltzmann constant</a> and <em>T</em> is <a href="absolute_temperature" title="wikilink">absolute temperature</a>. The <strong><a href="drift_current" title="wikilink">drift current</a></strong> and <strong>diffusion current</strong> refer separately to the two terms in the expressions for <strong>J</strong>, i.e.:</p>

<p>

<math display="block" id="Convection–diffusion_equation:40">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <msub>
      <mi>𝐉</mi>
      <mrow>
       <mi>n</mi>
       <mo>,</mo>
       <mtext>drift</mtext>
      </mrow>
     </msub>
     <mo>/</mo>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mo>-</mo>
       <mi>q</mi>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mo>-</mo>
     <mrow>
      <mi>n</mi>
      <msub>
       <mi>μ</mi>
       <mi>n</mi>
      </msub>
      <mi>𝐄</mi>
     </mrow>
    </mrow>
   </mrow>
   <mo rspace="22.5pt">,</mo>
   <mrow>
    <mrow>
     <msub>
      <mi>𝐉</mi>
      <mrow>
       <mi>p</mi>
       <mo>,</mo>
       <mtext>drift</mtext>
      </mrow>
     </msub>
     <mo>/</mo>
     <mi>q</mi>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mi>p</mi>
     <msub>
      <mi>μ</mi>
      <mi>p</mi>
     </msub>
     <mi>𝐄</mi>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <eq></eq>
     <apply>
      <divide></divide>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>𝐉</ci>
       <list>
        <ci>n</ci>
        <mtext>drift</mtext>
       </list>
      </apply>
      <apply>
       <minus></minus>
       <ci>q</ci>
      </apply>
     </apply>
     <apply>
      <minus></minus>
      <apply>
       <times></times>
       <ci>n</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>μ</ci>
        <ci>n</ci>
       </apply>
       <ci>𝐄</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <apply>
      <divide></divide>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>𝐉</ci>
       <list>
        <ci>p</ci>
        <mtext>drift</mtext>
       </list>
      </apply>
      <ci>q</ci>
     </apply>
     <apply>
      <times></times>
      <ci>p</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>μ</ci>
       <ci>p</ci>
      </apply>
      <ci>𝐄</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{J}_{n,\text{drift}}/(-q)=-n\mu_{n}\mathbf{E},\qquad\mathbf{J}_{p,\text%
{drift}}/q=p\mu_{p}\mathbf{E}
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Convection–diffusion_equation:41">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mrow>
      <msub>
       <mi>𝐉</mi>
       <mrow>
        <mi>n</mi>
        <mo>,</mo>
        <mtext>diffusion</mtext>
       </mrow>
      </msub>
      <mo>/</mo>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mo>-</mo>
        <mi>q</mi>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo>=</mo>
     <mrow>
      <mo>-</mo>
      <mrow>
       <msub>
        <mi>D</mi>
        <mi>n</mi>
       </msub>
       <mrow>
        <mo>∇</mo>
        <mi>n</mi>
       </mrow>
      </mrow>
     </mrow>
    </mrow>
    <mo rspace="22.5pt">,</mo>
    <mrow>
     <mrow>
      <msub>
       <mi>𝐉</mi>
       <mrow>
        <mi>p</mi>
        <mo>,</mo>
        <mtext>diffusion</mtext>
       </mrow>
      </msub>
      <mo>/</mo>
      <mi>q</mi>
     </mrow>
     <mo>=</mo>
     <mrow>
      <mo>-</mo>
      <mrow>
       <msub>
        <mi>D</mi>
        <mi>p</mi>
       </msub>
       <mrow>
        <mo>∇</mo>
        <mi>p</mi>
       </mrow>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <eq></eq>
     <apply>
      <divide></divide>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>𝐉</ci>
       <list>
        <ci>n</ci>
        <mtext>diffusion</mtext>
       </list>
      </apply>
      <apply>
       <minus></minus>
       <ci>q</ci>
      </apply>
     </apply>
     <apply>
      <minus></minus>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>D</ci>
        <ci>n</ci>
       </apply>
       <apply>
        <ci>normal-∇</ci>
        <ci>n</ci>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <apply>
      <divide></divide>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>𝐉</ci>
       <list>
        <ci>p</ci>
        <mtext>diffusion</mtext>
       </list>
      </apply>
      <ci>q</ci>
     </apply>
     <apply>
      <minus></minus>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>D</ci>
        <ci>p</ci>
       </apply>
       <apply>
        <ci>normal-∇</ci>
        <ci>p</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{J}_{n,\text{diffusion}}/(-q)=-D_{n}\nabla n,\qquad\mathbf{J}_{p,\text{%
diffusion}}/q=-D_{p}\nabla p.
  </annotation>
 </semantics>
</math>

</p>
<h2 id="see-also">See also</h2>
<ul>
<li><a href="Conservation_law" title="wikilink">Conservation equations</a></li>
<li><a href="Incompressible_Navier-Stokes_equations" title="wikilink">Incompressible Navier-Stokes equations</a></li>
<li><a href="Nernst–Planck_equation" title="wikilink">Nernst–Planck equation</a></li>
<li><a href="Double_diffusive_convection" title="wikilink">Double diffusive convection</a></li>
<li><a href="Natural_convection" title="wikilink">Natural convection</a></li>
<li><a href="Buckley–Leverett_equation" title="wikilink">Buckley–Leverett equation</a></li>
</ul>
<h2 id="references">References</h2>
<ul>
<li>Granville Sewell, <em>The Numerical Solution of Ordinary and Partial Differential Equations</em>, Academic Press (1988). ISBN 0-12-637475-9</li>
</ul>

<p>"</p>

<p><a class="uri" href="Category:Diffusion" title="wikilink">Category:Diffusion</a> <a href="Category:Parabolic_partial_differential_equations" title="wikilink">Category:Parabolic partial differential equations</a> <a href="Category:Stochastic_differential_equations" title="wikilink">Category:Stochastic differential equations</a> <a href="Category:Transport_phenomena" title="wikilink">Category:Transport phenomena</a> <a href="Category:Equations_of_physics" title="wikilink">Category:Equations of physics</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1"></li>
<li id="fn2"><em>Computational Fluid Dynamics in Industrial Combustion</em> by Baukal and Gershtein, p67, [<a class="uri" href="http://books.google.com/books?id=YlSbCgjjLrcC&amp;pg">http://books.google.com/books?id=YlSbCgjjLrcC&amp;pg;</a>;=PA67 google books link].<a href="#fnref2">↩</a></li>
<li id="fn3"><em>Introduction to Climate Modelling</em>, by Thomas Stocker, p57, [<a class="uri" href="http://books.google.com/books?id=D4zulgFb5JwC&amp;pg">http://books.google.com/books?id=D4zulgFb5JwC&amp;pg;</a>;=PA57 google books link]<a href="#fnref3">↩</a></li>
<li id="fn4"><em>Advective Diffusion Equation</em>, lecture notes by Scott A. Socolofsky and Gerhard H. Jirka, <a href="https://ceprofs.civil.tamu.edu/ssocolofsky/cven489/downloads/book/ch2.pdf">web link</a><a href="#fnref4">↩</a></li>
<li id="fn5"><a href="#fnref5">↩</a></li>
<li id="fn6"><a href="#fnref6">↩</a></li>
<li id="fn7"><a href="#fnref7">↩</a></li>
<li id="fn8"></li>
<li id="fn9"> See equation (312)<a href="#fnref9">↩</a></li>
<li id="fn10">M. v. Smoluchowski, ''Über Brownsche Molekularbewegung unter Einwirkung äußerer Kräfte und den Zusammenhang mit der verallgemeinerten Diffusionsgleichung, Ann. Phys. 353 (4. Folge 48), 1103–1112 (1915), <a href="http://matwbn.icm.edu.pl/ksiazki/pms/pms2/pms2132.pdf">PDF link</a><a href="#fnref10">↩</a></li>
<li id="fn11"><a class="uri" href="http://www.ks.uiuc.edu/~kosztin/PHYCS498NSM/LectureNotes/chp4.pdf">http://www.ks.uiuc.edu/~kosztin/PHYCS498NSM/LectureNotes/chp4.pdf</a><a href="#fnref11">↩</a></li>
<li id="fn12"><em>The Theory of Polymer Dynamics</em> by Doi and Edwards, p46-52, [<a class="uri" href="http://books.google.com/books?id=dMzGyWs3GKcC&amp;pg">http://books.google.com/books?id=dMzGyWs3GKcC&amp;pg;</a>;=PA46 google books link]<a href="#fnref12">↩</a></li>
<li id="fn13"></li>
<li id="fn14"></li>
<li id="fn15"></li>
</ol>
</section>
</body>
</html>

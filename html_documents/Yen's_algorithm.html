<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="722">Yen's algorithm</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Yen's algorithm</h1>
<hr/>

<p><strong>Yen's algorithm</strong> computes single-source <em>K</em>-shortest loopless paths for a <a href="Graph_(mathematics)" title="wikilink">graph</a> with non-negative <a href="Glossary_of_graph_theory#Basics" title="wikilink">edge</a> cost.<a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a> The algorithm was published by Jin Y. Yen in 1971 and employs any <a href="shortest_path_algorithm" title="wikilink">shortest path algorithm</a> to find the best path, then proceeds to find <em>K</em> − 1 deviations of the best path.<a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a> </p>
<h2 id="algorithm">Algorithm</h2>
<h3 id="terminology-and-notation">Terminology and notation</h3>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">
<p>Notation</p></th>
<th style="text-align: left;">
<p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">
<p>

<math display="inline" id="Yen's_algorithm:0">
 <semantics>
  <mi>N</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>N</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   N
  </annotation>
 </semantics>
</math>

</p></td>
<td style="text-align: left;">
<p>The size of the graph, i.e., the amount of nodes in the network.</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>

<math display="inline" id="Yen's_algorithm:1">
 <semantics>
  <mrow>
   <mo stretchy="false">(</mo>
   <mi>i</mi>
   <mo stretchy="false">)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <ci>i</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (i)
  </annotation>
 </semantics>
</math>

</p></td>
<td style="text-align: left;">
<p>The 

<math display="inline" id="Yen's_algorithm:2">
 <semantics>
  <msup>
   <mi>i</mi>
   <mrow>
    <mi>t</mi>
    <mi>h</mi>
   </mrow>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>i</ci>
    <apply>
     <times></times>
     <ci>t</ci>
     <ci>h</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   i^{th}
  </annotation>
 </semantics>
</math>

 node of the graph, where 

<math display="inline" id="Yen's_algorithm:3">
 <semantics>
  <mi>i</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>i</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   i
  </annotation>
 </semantics>
</math>

 ranges from 

<math display="inline" id="Yen's_algorithm:4">
 <semantics>
  <mn>1</mn>
  <annotation-xml encoding="MathML-Content">
   <cn type="integer">1</cn>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   1
  </annotation>
 </semantics>
</math>

 to 

<math display="inline" id="Yen's_algorithm:5">
 <semantics>
  <mi>N</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>N</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   N
  </annotation>
 </semantics>
</math>

. This means that 

<math display="inline" id="Yen's_algorithm:6">
 <semantics>
  <mrow>
   <mo stretchy="false">(</mo>
   <mn>1</mn>
   <mo stretchy="false">)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cn type="integer">1</cn>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (1)
  </annotation>
 </semantics>
</math>

 is the source node of the graph and 

<math display="inline" id="Yen's_algorithm:7">
 <semantics>
  <mrow>
   <mo stretchy="false">(</mo>
   <mi>N</mi>
   <mo stretchy="false">)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <ci>N</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (N)
  </annotation>
 </semantics>
</math>

 is the sink node of the graph.</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>

<math display="inline" id="Yen's_algorithm:8">
 <semantics>
  <msub>
   <mi>d</mi>
   <mrow>
    <mi>i</mi>
    <mi>j</mi>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>d</ci>
    <apply>
     <times></times>
     <ci>i</ci>
     <ci>j</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   d_{ij}
  </annotation>
 </semantics>
</math>

</p></td>
<td style="text-align: left;">
<p>The cost of the edge between 

<math display="inline" id="Yen's_algorithm:9">
 <semantics>
  <mrow>
   <mo stretchy="false">(</mo>
   <mi>i</mi>
   <mo stretchy="false">)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <ci>i</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (i)
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Yen's_algorithm:10">
 <semantics>
  <mrow>
   <mo stretchy="false">(</mo>
   <mi>j</mi>
   <mo stretchy="false">)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <ci>j</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (j)
  </annotation>
 </semantics>
</math>

, assuming that 

<math display="inline" id="Yen's_algorithm:11">
 <semantics>
  <mrow>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>i</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>≠</mo>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>j</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <neq></neq>
    <ci>i</ci>
    <ci>j</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (i)\neq(j)
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Yen's_algorithm:12">
 <semantics>
  <mrow>
   <msub>
    <mi>d</mi>
    <mrow>
     <mi>i</mi>
     <mi>j</mi>
    </mrow>
   </msub>
   <mo>≥</mo>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <geq></geq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>d</ci>
     <apply>
      <times></times>
      <ci>i</ci>
      <ci>j</ci>
     </apply>
    </apply>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   d_{ij}\geq 0
  </annotation>
 </semantics>
</math>

.</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>

<math display="inline" id="Yen's_algorithm:13">
 <semantics>
  <msup>
   <mi>A</mi>
   <mi>k</mi>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>A</ci>
    <ci>k</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A^{k}
  </annotation>
 </semantics>
</math>

</p></td>
<td style="text-align: left;">
<p>The 

<math display="inline" id="Yen's_algorithm:14">
 <semantics>
  <msup>
   <mi>k</mi>
   <mrow>
    <mi>t</mi>
    <mi>h</mi>
   </mrow>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>k</ci>
    <apply>
     <times></times>
     <ci>t</ci>
     <ci>h</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   k^{th}
  </annotation>
 </semantics>
</math>

 shortest path from 

<math display="inline" id="Yen's_algorithm:15">
 <semantics>
  <mrow>
   <mo stretchy="false">(</mo>
   <mn>1</mn>
   <mo stretchy="false">)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cn type="integer">1</cn>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (1)
  </annotation>
 </semantics>
</math>

 to 

<math display="inline" id="Yen's_algorithm:16">
 <semantics>
  <mrow>
   <mo stretchy="false">(</mo>
   <mi>N</mi>
   <mo stretchy="false">)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <ci>N</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (N)
  </annotation>
 </semantics>
</math>

, where 

<math display="inline" id="Yen's_algorithm:17">
 <semantics>
  <mi>k</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>k</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   k
  </annotation>
 </semantics>
</math>

 ranges from 

<math display="inline" id="Yen's_algorithm:18">
 <semantics>
  <mn>1</mn>
  <annotation-xml encoding="MathML-Content">
   <cn type="integer">1</cn>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   1
  </annotation>
 </semantics>
</math>

 to 

<math display="inline" id="Yen's_algorithm:19">
 <semantics>
  <mi>K</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>K</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   K
  </annotation>
 </semantics>
</math>

. Then 

<math display="inline" id="Yen's_algorithm:20">
 <semantics>
  <mrow>
   <msup>
    <mi>A</mi>
    <mi>k</mi>
   </msup>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mo stretchy="false">(</mo>
     <mn>1</mn>
     <mo stretchy="false">)</mo>
    </mrow>
    <mo>-</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <msup>
      <mn>2</mn>
      <mi>k</mi>
     </msup>
     <mo stretchy="false">)</mo>
    </mrow>
    <mo>-</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <msup>
      <mn>3</mn>
      <mi>k</mi>
     </msup>
     <mo stretchy="false">)</mo>
    </mrow>
    <mo>-</mo>
    <mi mathvariant="normal">⋯</mi>
    <mo>-</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <mmultiscripts>
      <mi>Q</mi>
      <mi>k</mi>
      <none></none>
      <none></none>
      <mi>k</mi>
     </mmultiscripts>
     <mo stretchy="false">)</mo>
    </mrow>
    <mo>-</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>N</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>A</ci>
     <ci>k</ci>
    </apply>
    <apply>
     <minus></minus>
     <cn type="integer">1</cn>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <cn type="integer">2</cn>
      <ci>k</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <cn type="integer">3</cn>
      <ci>k</ci>
     </apply>
     <ci>normal-⋯</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>Q</ci>
       <ci>k</ci>
      </apply>
      <ci>k</ci>
     </apply>
     <ci>N</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A^{k}=(1)-(2^{k})-(3^{k})-\cdots-({Q_{k}}^{k})-(N)
  </annotation>
 </semantics>
</math>

, where 

<math display="inline" id="Yen's_algorithm:21">
 <semantics>
  <mrow>
   <mo stretchy="false">(</mo>
   <msup>
    <mn>2</mn>
    <mi>k</mi>
   </msup>
   <mo stretchy="false">)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <cn type="integer">2</cn>
    <ci>k</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (2^{k})
  </annotation>
 </semantics>
</math>

 is the 2nd node of the 

<math display="inline" id="Yen's_algorithm:22">
 <semantics>
  <msup>
   <mi>k</mi>
   <mrow>
    <mi>t</mi>
    <mi>h</mi>
   </mrow>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>k</ci>
    <apply>
     <times></times>
     <ci>t</ci>
     <ci>h</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   k^{th}
  </annotation>
 </semantics>
</math>

 shortest path and 

<math display="inline" id="Yen's_algorithm:23">
 <semantics>
  <mrow>
   <mo stretchy="false">(</mo>
   <msup>
    <mn>3</mn>
    <mi>k</mi>
   </msup>
   <mo stretchy="false">)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <cn type="integer">3</cn>
    <ci>k</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (3^{k})
  </annotation>
 </semantics>
</math>

 is the 3rd node of the 

<math display="inline" id="Yen's_algorithm:24">
 <semantics>
  <msup>
   <mi>k</mi>
   <mrow>
    <mi>t</mi>
    <mi>h</mi>
   </mrow>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>k</ci>
    <apply>
     <times></times>
     <ci>t</ci>
     <ci>h</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   k^{th}
  </annotation>
 </semantics>
</math>

 shortest path, and so on.</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>

<math display="inline" id="Yen's_algorithm:25">
 <semantics>
  <mmultiscripts>
   <mi>A</mi>
   <none></none>
   <mi>k</mi>
   <mi>i</mi>
   <none></none>
  </mmultiscripts>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>A</ci>
     <ci>k</ci>
    </apply>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   {A^{k}}_{i}
  </annotation>
 </semantics>
</math>

</p></td>
<td style="text-align: left;">
<p>A deviation path from 

<math display="inline" id="Yen's_algorithm:26">
 <semantics>
  <msup>
   <mi>A</mi>
   <mrow>
    <mi>k</mi>
    <mo>-</mo>
    <mn>1</mn>
   </mrow>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>A</ci>
    <apply>
     <minus></minus>
     <ci>k</ci>
     <cn type="integer">1</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A^{k-1}
  </annotation>
 </semantics>
</math>

 at node 

<math display="inline" id="Yen's_algorithm:27">
 <semantics>
  <mrow>
   <mo stretchy="false">(</mo>
   <mi>i</mi>
   <mo stretchy="false">)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <ci>i</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (i)
  </annotation>
 </semantics>
</math>

, where 

<math display="inline" id="Yen's_algorithm:28">
 <semantics>
  <mi>i</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>i</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   i
  </annotation>
 </semantics>
</math>

 ranges from 

<math display="inline" id="Yen's_algorithm:29">
 <semantics>
  <mn>1</mn>
  <annotation-xml encoding="MathML-Content">
   <cn type="integer">1</cn>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   1
  </annotation>
 </semantics>
</math>

 to 

<math display="inline" id="Yen's_algorithm:30">
 <semantics>
  <msub>
   <mi>Q</mi>
   <mi>k</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>Q</ci>
    <ci>k</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Q_{k}
  </annotation>
 </semantics>
</math>

. Note that the maximum value of 

<math display="inline" id="Yen's_algorithm:31">
 <semantics>
  <mi>i</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>i</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   i
  </annotation>
 </semantics>
</math>

 is 

<math display="inline" id="Yen's_algorithm:32">
 <semantics>
  <msub>
   <mi>Q</mi>
   <mi>k</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>Q</ci>
    <ci>k</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Q_{k}
  </annotation>
 </semantics>
</math>

, which is the node just before the sink in the 

<math display="inline" id="Yen's_algorithm:33">
 <semantics>
  <mi>k</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>k</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   k
  </annotation>
 </semantics>
</math>

 shortest path. This means that the deviation path cannot deviate from the 

<math display="inline" id="Yen's_algorithm:34">
 <semantics>
  <mrow>
   <mi>k</mi>
   <mo>-</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <minus></minus>
    <ci>k</ci>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   k-1
  </annotation>
 </semantics>
</math>

 shortest path at the sink. The paths 

<math display="inline" id="Yen's_algorithm:35">
 <semantics>
  <msup>
   <mi>A</mi>
   <mi>k</mi>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>A</ci>
    <ci>k</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A^{k}
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Yen's_algorithm:36">
 <semantics>
  <msup>
   <mi>A</mi>
   <mrow>
    <mi>k</mi>
    <mo>-</mo>
    <mn>1</mn>
   </mrow>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>A</ci>
    <apply>
     <minus></minus>
     <ci>k</ci>
     <cn type="integer">1</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A^{k-1}
  </annotation>
 </semantics>
</math>

 follow the same path until the 

<math display="inline" id="Yen's_algorithm:37">
 <semantics>
  <msub>
   <mi>i</mi>
   <mrow>
    <mi>t</mi>
    <mi>h</mi>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>i</ci>
    <apply>
     <times></times>
     <ci>t</ci>
     <ci>h</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   i_{th}
  </annotation>
 </semantics>
</math>

 node, then 

<math display="inline" id="Yen's_algorithm:38">
 <semantics>
  <mrow>
   <msup>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>i</mi>
     <mo stretchy="false">)</mo>
    </mrow>
    <mi>k</mi>
   </msup>
   <mo>-</mo>
   <msup>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>i</mi>
      <mo>+</mo>
      <mn>1</mn>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
    <mi>k</mi>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <minus></minus>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>i</ci>
     <ci>k</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <plus></plus>
      <ci>i</ci>
      <cn type="integer">1</cn>
     </apply>
     <ci>k</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (i)^{k}-(i+1)^{k}
  </annotation>
 </semantics>
</math>

 edge is different from any path in 

<math display="inline" id="Yen's_algorithm:39">
 <semantics>
  <msup>
   <mi>A</mi>
   <mi>j</mi>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>A</ci>
    <ci>j</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A^{j}
  </annotation>
 </semantics>
</math>

, where 

<math display="inline" id="Yen's_algorithm:40">
 <semantics>
  <mi>j</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>j</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   j
  </annotation>
 </semantics>
</math>

 ranges from 

<math display="inline" id="Yen's_algorithm:41">
 <semantics>
  <mn>1</mn>
  <annotation-xml encoding="MathML-Content">
   <cn type="integer">1</cn>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   1
  </annotation>
 </semantics>
</math>

 to 

<math display="inline" id="Yen's_algorithm:42">
 <semantics>
  <mrow>
   <mi>k</mi>
   <mo>-</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <minus></minus>
    <ci>k</ci>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   k-1
  </annotation>
 </semantics>
</math>

.</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>

<math display="inline" id="Yen's_algorithm:43">
 <semantics>
  <mmultiscripts>
   <mi>R</mi>
   <none></none>
   <mi>k</mi>
   <mi>i</mi>
   <none></none>
  </mmultiscripts>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>R</ci>
     <ci>k</ci>
    </apply>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   {R^{k}}_{i}
  </annotation>
 </semantics>
</math>

</p></td>
<td style="text-align: left;">
<p>The root path of 

<math display="inline" id="Yen's_algorithm:44">
 <semantics>
  <mmultiscripts>
   <mi>A</mi>
   <none></none>
   <mi>k</mi>
   <mi>i</mi>
   <none></none>
  </mmultiscripts>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>A</ci>
     <ci>k</ci>
    </apply>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   {A^{k}}_{i}
  </annotation>
 </semantics>
</math>

 that follows that 

<math display="inline" id="Yen's_algorithm:45">
 <semantics>
  <msup>
   <mi>A</mi>
   <mrow>
    <mi>k</mi>
    <mo>-</mo>
    <mn>1</mn>
   </mrow>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>A</ci>
    <apply>
     <minus></minus>
     <ci>k</ci>
     <cn type="integer">1</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A^{k-1}
  </annotation>
 </semantics>
</math>

 until the 

<math display="inline" id="Yen's_algorithm:46">
 <semantics>
  <msub>
   <mi>i</mi>
   <mrow>
    <mi>t</mi>
    <mi>h</mi>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>i</ci>
    <apply>
     <times></times>
     <ci>t</ci>
     <ci>h</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   i_{th}
  </annotation>
 </semantics>
</math>

 node of 

<math display="inline" id="Yen's_algorithm:47">
 <semantics>
  <msup>
   <mi>A</mi>
   <mrow>
    <mi>k</mi>
    <mo>-</mo>
    <mn>1</mn>
   </mrow>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>A</ci>
    <apply>
     <minus></minus>
     <ci>k</ci>
     <cn type="integer">1</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A^{k-1}
  </annotation>
 </semantics>
</math>

.</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>

<math display="inline" id="Yen's_algorithm:48">
 <semantics>
  <mmultiscripts>
   <mi>S</mi>
   <none></none>
   <mi>k</mi>
   <mi>i</mi>
   <none></none>
  </mmultiscripts>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>S</ci>
     <ci>k</ci>
    </apply>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   {S^{k}}_{i}
  </annotation>
 </semantics>
</math>

</p></td>
<td style="text-align: left;">
<p>The spur path of 

<math display="inline" id="Yen's_algorithm:49">
 <semantics>
  <mmultiscripts>
   <mi>A</mi>
   <none></none>
   <mi>k</mi>
   <mi>i</mi>
   <none></none>
  </mmultiscripts>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>A</ci>
     <ci>k</ci>
    </apply>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   {A^{k}}_{i}
  </annotation>
 </semantics>
</math>

 that starts at the 

<math display="inline" id="Yen's_algorithm:50">
 <semantics>
  <msub>
   <mi>i</mi>
   <mrow>
    <mi>t</mi>
    <mi>h</mi>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>i</ci>
    <apply>
     <times></times>
     <ci>t</ci>
     <ci>h</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   i_{th}
  </annotation>
 </semantics>
</math>

 node of 

<math display="inline" id="Yen's_algorithm:51">
 <semantics>
  <mmultiscripts>
   <mi>A</mi>
   <none></none>
   <mi>k</mi>
   <mi>i</mi>
   <none></none>
  </mmultiscripts>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>A</ci>
     <ci>k</ci>
    </apply>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   {A^{k}}_{i}
  </annotation>
 </semantics>
</math>

 and ends at the sink.</p></td>
</tr>
</tbody>
</table>
<h3 id="description">Description</h3>

<p>The algorithm can be broken down into two parts, determining the first <a href="K_shortest_path_routing" title="wikilink">k-shortest path</a>, 

<math display="inline" id="Yen's_algorithm:52">
 <semantics>
  <msup>
   <mi>A</mi>
   <mn>1</mn>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>A</ci>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A^{1}
  </annotation>
 </semantics>
</math>

, and then determining all other <em>k</em>-<a href="shortest_path" title="wikilink">shortest paths</a>. It is assumed that the container 

<math display="inline" id="Yen's_algorithm:53">
 <semantics>
  <mi>A</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>A</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A
  </annotation>
 </semantics>
</math>

 will hold the <em>k</em>-shortest path, whereas the container 

<math display="inline" id="Yen's_algorithm:54">
 <semantics>
  <mi>B</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>B</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   B
  </annotation>
 </semantics>
</math>

, will hold the potential <em>k</em>-shortest paths. To determine 

<math display="inline" id="Yen's_algorithm:55">
 <semantics>
  <msup>
   <mi>A</mi>
   <mn>1</mn>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>A</ci>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A^{1}
  </annotation>
 </semantics>
</math>

, the <a href="shortest_path" title="wikilink">shortest path</a> from the source to the sink, any efficient <a href="shortest_path_algorithm" title="wikilink">shortest path algorithm</a> can be used.</p>

<p>To find the 

<math display="inline" id="Yen's_algorithm:56">
 <semantics>
  <msup>
   <mi>A</mi>
   <mi>k</mi>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>A</ci>
    <ci>k</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A^{k}
  </annotation>
 </semantics>
</math>

, where 

<math display="inline" id="Yen's_algorithm:57">
 <semantics>
  <mi>k</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>k</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   k
  </annotation>
 </semantics>
</math>

 ranges from 

<math display="inline" id="Yen's_algorithm:58">
 <semantics>
  <mn>2</mn>
  <annotation-xml encoding="MathML-Content">
   <cn type="integer">2</cn>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   2
  </annotation>
 </semantics>
</math>

 to 

<math display="inline" id="Yen's_algorithm:59">
 <semantics>
  <mi>K</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>K</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   K
  </annotation>
 </semantics>
</math>

, the algorithm assumes that all paths from 

<math display="inline" id="Yen's_algorithm:60">
 <semantics>
  <msup>
   <mi>A</mi>
   <mn>1</mn>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>A</ci>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A^{1}
  </annotation>
 </semantics>
</math>

 to 

<math display="inline" id="Yen's_algorithm:61">
 <semantics>
  <msup>
   <mi>A</mi>
   <mrow>
    <mi>k</mi>
    <mo>-</mo>
    <mn>1</mn>
   </mrow>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>A</ci>
    <apply>
     <minus></minus>
     <ci>k</ci>
     <cn type="integer">1</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A^{k-1}
  </annotation>
 </semantics>
</math>

 have previously been found. The 

<math display="inline" id="Yen's_algorithm:62">
 <semantics>
  <mi>k</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>k</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   k
  </annotation>
 </semantics>
</math>

 iteration can be divided into two processes, finding all the deviations 

<math display="inline" id="Yen's_algorithm:63">
 <semantics>
  <mmultiscripts>
   <mi>A</mi>
   <none></none>
   <mi>k</mi>
   <mi>i</mi>
   <none></none>
  </mmultiscripts>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>A</ci>
     <ci>k</ci>
    </apply>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   {A^{k}}_{i}
  </annotation>
 </semantics>
</math>

 and choosing a minimum length path to become 

<math display="inline" id="Yen's_algorithm:64">
 <semantics>
  <msup>
   <mi>A</mi>
   <mi>k</mi>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>A</ci>
    <ci>k</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A^{k}
  </annotation>
 </semantics>
</math>

. Note that in this iteration, 

<math display="inline" id="Yen's_algorithm:65">
 <semantics>
  <mi>i</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>i</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   i
  </annotation>
 </semantics>
</math>

 ranges from 

<math display="inline" id="Yen's_algorithm:66">
 <semantics>
  <mn>1</mn>
  <annotation-xml encoding="MathML-Content">
   <cn type="integer">1</cn>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   1
  </annotation>
 </semantics>
</math>

 to 

<math display="inline" id="Yen's_algorithm:67">
 <semantics>
  <mmultiscripts>
   <mi>Q</mi>
   <none></none>
   <mi>k</mi>
   <mi>k</mi>
   <none></none>
  </mmultiscripts>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>Q</ci>
     <ci>k</ci>
    </apply>
    <ci>k</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   {Q^{k}}_{k}
  </annotation>
 </semantics>
</math>

.</p>

<p>The first process can be further subdivided into three operations, choosing the 

<math display="inline" id="Yen's_algorithm:68">
 <semantics>
  <mmultiscripts>
   <mi>R</mi>
   <none></none>
   <mi>k</mi>
   <mi>i</mi>
   <none></none>
  </mmultiscripts>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>R</ci>
     <ci>k</ci>
    </apply>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   {R^{k}}_{i}
  </annotation>
 </semantics>
</math>

, finding 

<math display="inline" id="Yen's_algorithm:69">
 <semantics>
  <mmultiscripts>
   <mi>S</mi>
   <none></none>
   <mi>k</mi>
   <mi>i</mi>
   <none></none>
  </mmultiscripts>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>S</ci>
     <ci>k</ci>
    </apply>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   {S^{k}}_{i}
  </annotation>
 </semantics>
</math>

, and then adding 

<math display="inline" id="Yen's_algorithm:70">
 <semantics>
  <mmultiscripts>
   <mi>A</mi>
   <none></none>
   <mi>k</mi>
   <mi>i</mi>
   <none></none>
  </mmultiscripts>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>A</ci>
     <ci>k</ci>
    </apply>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   {A^{k}}_{i}
  </annotation>
 </semantics>
</math>

 to the container 

<math display="inline" id="Yen's_algorithm:71">
 <semantics>
  <mi>B</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>B</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   B
  </annotation>
 </semantics>
</math>

. The root path, 

<math display="inline" id="Yen's_algorithm:72">
 <semantics>
  <mmultiscripts>
   <mi>R</mi>
   <none></none>
   <mi>k</mi>
   <mi>i</mi>
   <none></none>
  </mmultiscripts>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>R</ci>
     <ci>k</ci>
    </apply>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   {R^{k}}_{i}
  </annotation>
 </semantics>
</math>

, is chosen by finding the subpath in 

<math display="inline" id="Yen's_algorithm:73">
 <semantics>
  <msup>
   <mi>A</mi>
   <mrow>
    <mi>k</mi>
    <mo>-</mo>
    <mn>1</mn>
   </mrow>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>A</ci>
    <apply>
     <minus></minus>
     <ci>k</ci>
     <cn type="integer">1</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A^{k-1}
  </annotation>
 </semantics>
</math>

 that follows the first 

<math display="inline" id="Yen's_algorithm:74">
 <semantics>
  <mi>i</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>i</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   i
  </annotation>
 </semantics>
</math>

 nodes of 

<math display="inline" id="Yen's_algorithm:75">
 <semantics>
  <msup>
   <mi>A</mi>
   <mi>j</mi>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>A</ci>
    <ci>j</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A^{j}
  </annotation>
 </semantics>
</math>

, where 

<math display="inline" id="Yen's_algorithm:76">
 <semantics>
  <mi>j</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>j</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   j
  </annotation>
 </semantics>
</math>

 ranges from 

<math display="inline" id="Yen's_algorithm:77">
 <semantics>
  <mn>1</mn>
  <annotation-xml encoding="MathML-Content">
   <cn type="integer">1</cn>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   1
  </annotation>
 </semantics>
</math>

 to 

<math display="inline" id="Yen's_algorithm:78">
 <semantics>
  <mrow>
   <mi>k</mi>
   <mo>-</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <minus></minus>
    <ci>k</ci>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   k-1
  </annotation>
 </semantics>
</math>

. Then, if a path is found, the cost of edge 

<math display="inline" id="Yen's_algorithm:79">
 <semantics>
  <msub>
   <mi>d</mi>
   <mrow>
    <mi>i</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>i</mi>
      <mo>+</mo>
      <mn>1</mn>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>d</ci>
    <apply>
     <times></times>
     <ci>i</ci>
     <apply>
      <plus></plus>
      <ci>i</ci>
      <cn type="integer">1</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   d_{i(i+1)}
  </annotation>
 </semantics>
</math>

 of 

<math display="inline" id="Yen's_algorithm:80">
 <semantics>
  <msup>
   <mi>A</mi>
   <mi>j</mi>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>A</ci>
    <ci>j</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A^{j}
  </annotation>
 </semantics>
</math>

 is set to infinity. Next, the spur path, 

<math display="inline" id="Yen's_algorithm:81">
 <semantics>
  <mmultiscripts>
   <mi>S</mi>
   <none></none>
   <mi>k</mi>
   <mi>i</mi>
   <none></none>
  </mmultiscripts>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>S</ci>
     <ci>k</ci>
    </apply>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   {S^{k}}_{i}
  </annotation>
 </semantics>
</math>

, is found by computing the shortest path from the spur node, node 

<math display="inline" id="Yen's_algorithm:82">
 <semantics>
  <mi>i</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>i</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   i
  </annotation>
 </semantics>
</math>

, to the sink. The removal of previous used edges from 

<math display="inline" id="Yen's_algorithm:83">
 <semantics>
  <mrow>
   <mo stretchy="false">(</mo>
   <mi>i</mi>
   <mo stretchy="false">)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <ci>i</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (i)
  </annotation>
 </semantics>
</math>

 to 

<math display="inline" id="Yen's_algorithm:84">
 <semantics>
  <mrow>
   <mo stretchy="false">(</mo>
   <mrow>
    <mi>i</mi>
    <mo>+</mo>
    <mn>1</mn>
   </mrow>
   <mo stretchy="false">)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <plus></plus>
    <ci>i</ci>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (i+1)
  </annotation>
 </semantics>
</math>

 ensures that the spur path is different. 

<math display="inline" id="Yen's_algorithm:85">
 <semantics>
  <mrow>
   <mmultiscripts>
    <mi>A</mi>
    <none></none>
    <mi>k</mi>
    <mi>i</mi>
    <none></none>
   </mmultiscripts>
   <mo>=</mo>
   <mrow>
    <mmultiscripts>
     <mi>R</mi>
     <none></none>
     <mi>k</mi>
     <mi>i</mi>
     <none></none>
    </mmultiscripts>
    <mo>+</mo>
    <mmultiscripts>
     <mi>S</mi>
     <none></none>
     <mi>k</mi>
     <mi>i</mi>
     <none></none>
    </mmultiscripts>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>A</ci>
      <ci>k</ci>
     </apply>
     <ci>i</ci>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>R</ci>
       <ci>k</ci>
      </apply>
      <ci>i</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>S</ci>
       <ci>k</ci>
      </apply>
      <ci>i</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   {A^{k}}_{i}={R^{k}}_{i}+{S^{k}}_{i}
  </annotation>
 </semantics>
</math>

, the addition of the root path and the spur path, is added to 

<math display="inline" id="Yen's_algorithm:86">
 <semantics>
  <mi>B</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>B</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   B
  </annotation>
 </semantics>
</math>

. Next, the edges that were removed, i.e. had their cost set to infinity, are restored to their initial values.</p>

<p>The second process determines a suitable path for 

<math display="inline" id="Yen's_algorithm:87">
 <semantics>
  <msup>
   <mi>A</mi>
   <mi>k</mi>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>A</ci>
    <ci>k</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A^{k}
  </annotation>
 </semantics>
</math>

 by finding the path in container 

<math display="inline" id="Yen's_algorithm:88">
 <semantics>
  <mi>B</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>B</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   B
  </annotation>
 </semantics>
</math>

 with the lowest cost. This path is removed from container 

<math display="inline" id="Yen's_algorithm:89">
 <semantics>
  <mi>B</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>B</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   B
  </annotation>
 </semantics>
</math>

 and inserted into container 

<math display="inline" id="Yen's_algorithm:90">
 <semantics>
  <mi>A</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>A</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A
  </annotation>
 </semantics>
</math>

 and the algorithm continues to the next iteration. Note that if the amount of paths in container 

<math display="inline" id="Yen's_algorithm:91">
 <semantics>
  <mi>B</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>B</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   B
  </annotation>
 </semantics>
</math>

 equal or exceed the amount of k-shortest paths that still need to be found, then the necessary paths of container 

<math display="inline" id="Yen's_algorithm:92">
 <semantics>
  <mi>B</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>B</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   B
  </annotation>
 </semantics>
</math>

 are added to container 

<math display="inline" id="Yen's_algorithm:93">
 <semantics>
  <mi>A</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>A</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A
  </annotation>
 </semantics>
</math>

 and the algorithm is finished.</p>
<h3 id="pseudocode">Pseudocode</h3>

<p>The algorithm assumes that the Dijkstra algorithm is used to find the shortest path between two nodes, but any shortest path algorithm can be used in its place.</p>

<p><strong><code>function</code></strong><code> YenKSP(Graph, source, sink, K):</code><br/>
<code>   </code><em><code>//</code> <code>Determine</code> <code>the</code> <code>shortest</code> <code>path</code> <code>from</code> <code>the</code> <code>source</code> <code>to</code> <code>the</code> <code>sink.</code></em><br/>
<code>   A[0] = Dijkstra(Graph, source, sink);</code><br/>
<code>   </code><em><code>//</code> <code>Initialize</code> <code>the</code> <code>heap</code> <code>to</code> <code>store</code> <code>the</code> <code>potential</code> <code>kth</code> <code>shortest</code> <code>path.</code></em><br/>
<code>   B = [];</code><br/>
<code>   </code><br/>
<code>   </code><strong><code>for</code></strong><code> k </code><strong><code>from</code></strong><code> 1 </code><strong><code>to</code></strong><code> K:</code><br/>
<code>       </code><em><code>//</code> <code>The</code> <code>spur</code> <code>node</code> <code>ranges</code> <code>from</code> <code>the</code> <code>first</code> <code>node</code> <code>to</code> <code>the</code> <code>next</code> <code>to</code> <code>last</code> <code>node</code> <code>in</code> <code>the</code> <code>previous</code> <code>k-shortest</code> <code>path.</code></em><br/>
<code>       </code><strong><code>for</code></strong><code> i </code><strong><code>from</code></strong><code> 0 </code><strong><code>to</code></strong><code> size(A[k − 1]) − 1:</code><br/>
<code>           </code><br/>
<code>           </code><em><code>//</code> <code>Spur</code> <code>node</code> <code>is</code> <code>retrieved</code> <code>from</code> <code>the</code> <code>previous</code> <code>k-shortest</code> <code>path,</code> <code>k</code> <code>−</code> <code>1.</code></em><br/>
<code>           spurNode = A[k-1].node(i);</code><br/>
<code>           </code><em><code>//</code> <code>The</code> <code>sequence</code> <code>of</code> <code>nodes</code> <code>from</code> <code>the</code> <code>source</code> <code>to</code> <code>the</code> <code>spur</code> <code>node</code> <code>of</code> <code>the</code> <code>previous</code> <code>k-shortest</code> <code>path.</code></em><br/>
<code>           rootPath = A[k-1].nodes(0, i);</code><br/>
<code>           </code><br/>
<code>           </code><strong><code>for</code> <code>each</code></strong><code> path p </code><strong><code>in</code></strong><code> A:</code><br/>
<code>               </code><strong><code>if</code></strong><code> rootPath == p.nodes(0, i):</code><br/>
<code>                   </code><em><code>//</code> <code>Remove</code> <code>the</code> <code>links</code> <code>that</code> <code>are</code> <code>part</code> <code>of</code> <code>the</code> <code>previous</code> <code>shortest</code> <code>paths</code> <code>which</code> <code>share</code> <code>the</code> <code>same</code> <code>root</code> <code>path.</code></em><br/>
<code>                   remove p.edge(i, i + 1) </code><strong><code>from</code></strong><code> Graph;</code><br/>
<code>           </code><br/>
<code>           </code><strong><code>for</code> <code>each</code></strong><code> node rootPathNode </code><strong><code>in</code></strong><code> rootPath except spurNode:</code><br/>
<code>               remove rootPathNode </code><strong><code>from</code></strong><code> Graph;</code><br/>
<code>           </code><br/>
<code>           </code><em><code>//</code> <code>Calculate</code> <code>the</code> <code>spur</code> <code>path</code> <code>from</code> <code>the</code> <code>spur</code> <code>node</code> <code>to</code> <code>the</code> <code>sink.</code></em><br/>
<code>           spurPath = Dijkstra(Graph, spurNode, sink);</code><br/>
<code>           </code><br/>
<code>           </code><em><code>//</code> <code>Entire</code> <code>path</code> <code>is</code> <code>made</code> <code>up</code> <code>of</code> <code>the</code> <code>root</code> <code>path</code> <code>and</code> <code>spur</code> <code>path.</code></em><br/>
<code>           totalPath = rootPath + spurPath;</code><br/>
<code>           </code><em><code>//</code> <code>Add</code> <code>the</code> <code>potential</code> <code>k-shortest</code> <code>path</code> <code>to</code> <code>the</code> <code>heap.</code></em><br/>
<code>           B.append(totalPath);</code><br/>
<code>           </code><br/>
<code>           </code><em><code>//</code> <code>Add</code> <code>back</code> <code>the</code> <code>edges</code> <code>and</code> <code>nodes</code> <code>that</code> <code>were</code> <code>removed</code> <code>from</code> <code>the</code> <code>graph.</code></em><br/>
<code>           restore edges </code><strong><code>to</code></strong><code> Graph;</code><br/>
<code>           restore nodes in rootPath </code><strong><code>to</code></strong><code> Graph;</code><br/>
<code>                   </code><br/>
<code>       if B is empty:</code><br/>
<code>           </code><em><code>//</code> <code>This</code> <code>handles</code> <code>the</code> <code>case</code> <code>of</code> <code>there</code> <code>being</code> <code>no</code> <code>spur</code> <code>paths,</code> <code>or</code> <code>no</code> <code>spur</code> <code>paths</code> <code>left.</code></em><br/>
<code>           ''// This could happen if the spur paths have already been exhausted (added to A), ''</code><br/>
<code>           ''// or there are no spur paths at all - such as when both the source and sink vertices ''</code><br/>
<code>           </code><em><code>//</code> <code>lie</code> <code>along</code> <code>a</code> <code>"dead</code> <code>end".</code></em><br/>
<code>           break;</code><br/>
<code>       </code><em><code>//</code> <code>Sort</code> <code>the</code> <code>potential</code> <code>k-shortest</code> <code>paths</code> <code>by</code> <code>cost.</code></em><br/>
<code>       B.sort();</code><br/>
<code>       </code><em><code>//</code> <code>Add</code> <code>the</code> <code>lowest</code> <code>cost</code> <code>path</code> <code>becomes</code> <code>the</code> <code>k-shortest</code> <code>path.</code></em><br/>
<code>       A[k] = B[0];</code><br/>
<code>       B.pop();</code><br/>
<code>   </code><br/>
<code>   </code><strong><code>return</code></strong><code> A;</code></p>
<h3 id="example">Example</h3>

<p> The example uses Yen's <em>K</em>-Shortest Path Algorithm to compute three paths from 

<math display="inline" id="Yen's_algorithm:94">
 <semantics>
  <mrow>
   <mo stretchy="false">(</mo>
   <mi>C</mi>
   <mo stretchy="false">)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <ci>C</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (C)
  </annotation>
 </semantics>
</math>

 to 

<math display="inline" id="Yen's_algorithm:95">
 <semantics>
  <mrow>
   <mo stretchy="false">(</mo>
   <mi>H</mi>
   <mo stretchy="false">)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <ci>H</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (H)
  </annotation>
 </semantics>
</math>

. <a href="Dijkstra's_algorithm" title="wikilink">Dijkstra's algorithm</a> is used to calculate the best path from 

<math display="inline" id="Yen's_algorithm:96">
 <semantics>
  <mrow>
   <mo stretchy="false">(</mo>
   <mi>C</mi>
   <mo stretchy="false">)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <ci>C</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (C)
  </annotation>
 </semantics>
</math>

 to 

<math display="inline" id="Yen's_algorithm:97">
 <semantics>
  <mrow>
   <mo stretchy="false">(</mo>
   <mi>H</mi>
   <mo stretchy="false">)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <ci>H</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (H)
  </annotation>
 </semantics>
</math>

, which is 

<math display="inline" id="Yen's_algorithm:98">
 <semantics>
  <mrow>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>C</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>-</mo>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>E</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>-</mo>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>F</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>-</mo>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>H</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <minus></minus>
    <ci>C</ci>
    <ci>E</ci>
    <ci>F</ci>
    <ci>H</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (C)-(E)-(F)-(H)
  </annotation>
 </semantics>
</math>

 with cost 5. This path is appended to container 

<math display="inline" id="Yen's_algorithm:99">
 <semantics>
  <mi>A</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>A</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A
  </annotation>
 </semantics>
</math>

 and becomes the first <em>k</em>-shortest path, 

<math display="inline" id="Yen's_algorithm:100">
 <semantics>
  <msup>
   <mi>A</mi>
   <mn>1</mn>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>A</ci>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A^{1}
  </annotation>
 </semantics>
</math>

.</p>

<p>Node 

<math display="inline" id="Yen's_algorithm:101">
 <semantics>
  <mrow>
   <mo stretchy="false">(</mo>
   <mi>C</mi>
   <mo stretchy="false">)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <ci>C</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (C)
  </annotation>
 </semantics>
</math>

 of 

<math display="inline" id="Yen's_algorithm:102">
 <semantics>
  <msup>
   <mi>A</mi>
   <mn>1</mn>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>A</ci>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A^{1}
  </annotation>
 </semantics>
</math>

 becomes the spur node with a root path of itself, 

<math display="inline" id="Yen's_algorithm:103">
 <semantics>
  <mrow>
   <mmultiscripts>
    <mi>R</mi>
    <none></none>
    <mn>2</mn>
    <mn>1</mn>
    <none></none>
   </mmultiscripts>
   <mo>=</mo>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>C</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>R</ci>
      <cn type="integer">2</cn>
     </apply>
     <cn type="integer">1</cn>
    </apply>
    <ci>C</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   {R^{2}}_{1}=(C)
  </annotation>
 </semantics>
</math>

. The edge, 

<math display="inline" id="Yen's_algorithm:104">
 <semantics>
  <mrow>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>C</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>-</mo>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>E</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <minus></minus>
    <ci>C</ci>
    <ci>E</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (C)-(E)
  </annotation>
 </semantics>
</math>

, is removed because it coincides with the root path and a path in container 

<math display="inline" id="Yen's_algorithm:105">
 <semantics>
  <mi>A</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>A</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A
  </annotation>
 </semantics>
</math>

. <a href="Dijkstra's_algorithm" title="wikilink">Dijkstra's algorithm</a> is used to compute the spur path 

<math display="inline" id="Yen's_algorithm:106">
 <semantics>
  <mmultiscripts>
   <mi>S</mi>
   <none></none>
   <mn>2</mn>
   <mn>1</mn>
   <none></none>
  </mmultiscripts>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>S</ci>
     <cn type="integer">2</cn>
    </apply>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   {S^{2}}_{1}
  </annotation>
 </semantics>
</math>

, which is 

<math display="inline" id="Yen's_algorithm:107">
 <semantics>
  <mrow>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>C</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>-</mo>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>D</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>-</mo>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>F</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>-</mo>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>H</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <minus></minus>
    <ci>C</ci>
    <ci>D</ci>
    <ci>F</ci>
    <ci>H</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (C)-(D)-(F)-(H)
  </annotation>
 </semantics>
</math>

, with a cost of 8. 

<math display="inline" id="Yen's_algorithm:108">
 <semantics>
  <mrow>
   <mmultiscripts>
    <mi>A</mi>
    <none></none>
    <mn>2</mn>
    <mn>1</mn>
    <none></none>
   </mmultiscripts>
   <mo>=</mo>
   <mrow>
    <mmultiscripts>
     <mi>R</mi>
     <none></none>
     <mn>2</mn>
     <mn>1</mn>
     <none></none>
    </mmultiscripts>
    <mo>+</mo>
    <mmultiscripts>
     <mi>S</mi>
     <none></none>
     <mn>2</mn>
     <mn>1</mn>
     <none></none>
    </mmultiscripts>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>C</mi>
     <mo stretchy="false">)</mo>
    </mrow>
    <mo>-</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>D</mi>
     <mo stretchy="false">)</mo>
    </mrow>
    <mo>-</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>F</mi>
     <mo stretchy="false">)</mo>
    </mrow>
    <mo>-</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>H</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>A</ci>
       <cn type="integer">2</cn>
      </apply>
      <cn type="integer">1</cn>
     </apply>
     <apply>
      <plus></plus>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>R</ci>
        <cn type="integer">2</cn>
       </apply>
       <cn type="integer">1</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>S</ci>
        <cn type="integer">2</cn>
       </apply>
       <cn type="integer">1</cn>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <minus></minus>
      <ci>C</ci>
      <ci>D</ci>
      <ci>F</ci>
      <ci>H</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   {A^{2}}_{1}={R^{2}}_{1}+{S^{2}}_{1}=(C)-(D)-(F)-(H)
  </annotation>
 </semantics>
</math>

 is added to container 

<math display="inline" id="Yen's_algorithm:109">
 <semantics>
  <mi>B</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>B</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   B
  </annotation>
 </semantics>
</math>

 as a potential <em>k</em>-shortest path.</p>

<p>Node 

<math display="inline" id="Yen's_algorithm:110">
 <semantics>
  <mrow>
   <mo stretchy="false">(</mo>
   <mi>E</mi>
   <mo stretchy="false">)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <ci>E</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (E)
  </annotation>
 </semantics>
</math>

 of 

<math display="inline" id="Yen's_algorithm:111">
 <semantics>
  <msup>
   <mi>A</mi>
   <mn>1</mn>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>A</ci>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A^{1}
  </annotation>
 </semantics>
</math>

 becomes the spur node with 

<math display="inline" id="Yen's_algorithm:112">
 <semantics>
  <mrow>
   <mmultiscripts>
    <mi>R</mi>
    <none></none>
    <mn>2</mn>
    <mn>2</mn>
    <none></none>
   </mmultiscripts>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>C</mi>
     <mo stretchy="false">)</mo>
    </mrow>
    <mo>-</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>E</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>R</ci>
      <cn type="integer">2</cn>
     </apply>
     <cn type="integer">2</cn>
    </apply>
    <apply>
     <minus></minus>
     <ci>C</ci>
     <ci>E</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   {R^{2}}_{2}=(C)-(E)
  </annotation>
 </semantics>
</math>

. The edge, 

<math display="inline" id="Yen's_algorithm:113">
 <semantics>
  <mrow>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>E</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>-</mo>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>F</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <minus></minus>
    <ci>E</ci>
    <ci>F</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (E)-(F)
  </annotation>
 </semantics>
</math>

, is removed because it coincides with the root path and a path in container 

<math display="inline" id="Yen's_algorithm:114">
 <semantics>
  <mi>A</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>A</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A
  </annotation>
 </semantics>
</math>

. <a href="Dijkstra's_algorithm" title="wikilink">Dijkstra's algorithm</a> is used to compute the spur path 

<math display="inline" id="Yen's_algorithm:115">
 <semantics>
  <mmultiscripts>
   <mi>S</mi>
   <none></none>
   <mn>2</mn>
   <mn>2</mn>
   <none></none>
  </mmultiscripts>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>S</ci>
     <cn type="integer">2</cn>
    </apply>
    <cn type="integer">2</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   {S^{2}}_{2}
  </annotation>
 </semantics>
</math>

, which is 

<math display="inline" id="Yen's_algorithm:116">
 <semantics>
  <mrow>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>E</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>-</mo>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>G</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>-</mo>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>H</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <minus></minus>
    <ci>E</ci>
    <ci>G</ci>
    <ci>H</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (E)-(G)-(H)
  </annotation>
 </semantics>
</math>

, with a cost of 7. 

<math display="inline" id="Yen's_algorithm:117">
 <semantics>
  <mrow>
   <mmultiscripts>
    <mi>A</mi>
    <none></none>
    <mn>2</mn>
    <mn>2</mn>
    <none></none>
   </mmultiscripts>
   <mo>=</mo>
   <mrow>
    <mmultiscripts>
     <mi>R</mi>
     <none></none>
     <mn>2</mn>
     <mn>2</mn>
     <none></none>
    </mmultiscripts>
    <mo>+</mo>
    <mmultiscripts>
     <mi>S</mi>
     <none></none>
     <mn>2</mn>
     <mn>2</mn>
     <none></none>
    </mmultiscripts>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>C</mi>
     <mo stretchy="false">)</mo>
    </mrow>
    <mo>-</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>E</mi>
     <mo stretchy="false">)</mo>
    </mrow>
    <mo>-</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>G</mi>
     <mo stretchy="false">)</mo>
    </mrow>
    <mo>-</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>H</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>A</ci>
       <cn type="integer">2</cn>
      </apply>
      <cn type="integer">2</cn>
     </apply>
     <apply>
      <plus></plus>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>R</ci>
        <cn type="integer">2</cn>
       </apply>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>S</ci>
        <cn type="integer">2</cn>
       </apply>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <minus></minus>
      <ci>C</ci>
      <ci>E</ci>
      <ci>G</ci>
      <ci>H</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   {A^{2}}_{2}={R^{2}}_{2}+{S^{2}}_{2}=(C)-(E)-(G)-(H)
  </annotation>
 </semantics>
</math>

 is added to container 

<math display="inline" id="Yen's_algorithm:118">
 <semantics>
  <mi>B</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>B</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   B
  </annotation>
 </semantics>
</math>

 as a potential <em>k</em>-shortest path.</p>

<p>Node 

<math display="inline" id="Yen's_algorithm:119">
 <semantics>
  <mrow>
   <mo stretchy="false">(</mo>
   <mi>F</mi>
   <mo stretchy="false">)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <ci>F</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (F)
  </annotation>
 </semantics>
</math>

 of 

<math display="inline" id="Yen's_algorithm:120">
 <semantics>
  <msup>
   <mi>A</mi>
   <mn>1</mn>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>A</ci>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A^{1}
  </annotation>
 </semantics>
</math>

 becomes the spur node with a root path, 

<math display="inline" id="Yen's_algorithm:121">
 <semantics>
  <mrow>
   <mmultiscripts>
    <mi>R</mi>
    <none></none>
    <mn>2</mn>
    <mn>3</mn>
    <none></none>
   </mmultiscripts>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>C</mi>
     <mo stretchy="false">)</mo>
    </mrow>
    <mo>-</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>E</mi>
     <mo stretchy="false">)</mo>
    </mrow>
    <mo>-</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>F</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>R</ci>
      <cn type="integer">2</cn>
     </apply>
     <cn type="integer">3</cn>
    </apply>
    <apply>
     <minus></minus>
     <ci>C</ci>
     <ci>E</ci>
     <ci>F</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   {R^{2}}_{3}=(C)-(E)-(F)
  </annotation>
 </semantics>
</math>

. The edge, 

<math display="inline" id="Yen's_algorithm:122">
 <semantics>
  <mrow>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>F</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>-</mo>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>H</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <minus></minus>
    <ci>F</ci>
    <ci>H</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (F)-(H)
  </annotation>
 </semantics>
</math>

, is removed because it coincides with the root path and a path in container 

<math display="inline" id="Yen's_algorithm:123">
 <semantics>
  <mi>A</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>A</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A
  </annotation>
 </semantics>
</math>

. <a href="Dijkstra's_algorithm" title="wikilink">Dijkstra's algorithm</a> is used to compute the spur path 

<math display="inline" id="Yen's_algorithm:124">
 <semantics>
  <mmultiscripts>
   <mi>S</mi>
   <none></none>
   <mn>2</mn>
   <mn>3</mn>
   <none></none>
  </mmultiscripts>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>S</ci>
     <cn type="integer">2</cn>
    </apply>
    <cn type="integer">3</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   {S^{2}}_{3}
  </annotation>
 </semantics>
</math>

, which is 

<math display="inline" id="Yen's_algorithm:125">
 <semantics>
  <mrow>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>F</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>-</mo>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>G</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>-</mo>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>H</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <minus></minus>
    <ci>F</ci>
    <ci>G</ci>
    <ci>H</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (F)-(G)-(H)
  </annotation>
 </semantics>
</math>

, with a cost of 8. 

<math display="inline" id="Yen's_algorithm:126">
 <semantics>
  <mrow>
   <mmultiscripts>
    <mi>A</mi>
    <none></none>
    <mn>2</mn>
    <mn>3</mn>
    <none></none>
   </mmultiscripts>
   <mo>=</mo>
   <mrow>
    <mmultiscripts>
     <mi>R</mi>
     <none></none>
     <mn>2</mn>
     <mn>3</mn>
     <none></none>
    </mmultiscripts>
    <mo>+</mo>
    <mmultiscripts>
     <mi>S</mi>
     <none></none>
     <mn>2</mn>
     <mn>3</mn>
     <none></none>
    </mmultiscripts>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>C</mi>
     <mo stretchy="false">)</mo>
    </mrow>
    <mo>-</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>E</mi>
     <mo stretchy="false">)</mo>
    </mrow>
    <mo>-</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>F</mi>
     <mo stretchy="false">)</mo>
    </mrow>
    <mo>-</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>G</mi>
     <mo stretchy="false">)</mo>
    </mrow>
    <mo>-</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>H</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>A</ci>
       <cn type="integer">2</cn>
      </apply>
      <cn type="integer">3</cn>
     </apply>
     <apply>
      <plus></plus>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>R</ci>
        <cn type="integer">2</cn>
       </apply>
       <cn type="integer">3</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>S</ci>
        <cn type="integer">2</cn>
       </apply>
       <cn type="integer">3</cn>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <minus></minus>
      <ci>C</ci>
      <ci>E</ci>
      <ci>F</ci>
      <ci>G</ci>
      <ci>H</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   {A^{2}}_{3}={R^{2}}_{3}+{S^{2}}_{3}=(C)-(E)-(F)-(G)-(H)
  </annotation>
 </semantics>
</math>

 is added to container 

<math display="inline" id="Yen's_algorithm:127">
 <semantics>
  <mi>B</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>B</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   B
  </annotation>
 </semantics>
</math>

 as a potential <em>k</em>-shortest path.</p>

<p>Of the three paths in container B, 

<math display="inline" id="Yen's_algorithm:128">
 <semantics>
  <mmultiscripts>
   <mi>A</mi>
   <none></none>
   <mn>2</mn>
   <mn>2</mn>
   <none></none>
  </mmultiscripts>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>A</ci>
     <cn type="integer">2</cn>
    </apply>
    <cn type="integer">2</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   {A^{2}}_{2}
  </annotation>
 </semantics>
</math>

 is chosen to become 

<math display="inline" id="Yen's_algorithm:129">
 <semantics>
  <msup>
   <mi>A</mi>
   <mn>2</mn>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>A</ci>
    <cn type="integer">2</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A^{2}
  </annotation>
 </semantics>
</math>

 because it has the lowest cost of 7. This process is continued to the 3rd <em>k</em>-shortest path. However, within this 3rd iteration, note that some spur paths do not exist.And the path that is chosen to become 

<math display="inline" id="Yen's_algorithm:130">
 <semantics>
  <msup>
   <mi>A</mi>
   <mn>3</mn>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>A</ci>
    <cn type="integer">3</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A^{3}
  </annotation>
 </semantics>
</math>

 is 

<math display="inline" id="Yen's_algorithm:131">
 <semantics>
  <mrow>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>C</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>-</mo>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>D</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>-</mo>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>F</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>-</mo>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>H</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <minus></minus>
    <ci>C</ci>
    <ci>D</ci>
    <ci>F</ci>
    <ci>H</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (C)-(D)-(F)-(H)
  </annotation>
 </semantics>
</math>

.</p>
<h2 id="features">Features</h2>
<h3 id="space-complexity">Space complexity</h3>

<p>To store the edges of the graph, the shortest path list 

<math display="inline" id="Yen's_algorithm:132">
 <semantics>
  <mi>A</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>A</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A
  </annotation>
 </semantics>
</math>

, and the potential shortest path list 

<math display="inline" id="Yen's_algorithm:133">
 <semantics>
  <mi>B</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>B</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   B
  </annotation>
 </semantics>
</math>

, 

<math display="inline" id="Yen's_algorithm:134">
 <semantics>
  <mrow>
   <msup>
    <mi>N</mi>
    <mn>2</mn>
   </msup>
   <mo>+</mo>
   <mrow>
    <mi>K</mi>
    <mi>N</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <plus></plus>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>N</ci>
     <cn type="integer">2</cn>
    </apply>
    <apply>
     <times></times>
     <ci>K</ci>
     <ci>N</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   N^{2}+KN
  </annotation>
 </semantics>
</math>

 memory addresses are required.<a class="footnoteRef" href="#fn3" id="fnref3"><sup>3</sup></a> At worse case, the every node in the graph has an edge to every other node in the graph, thus 

<math display="inline" id="Yen's_algorithm:135">
 <semantics>
  <msup>
   <mi>N</mi>
   <mn>2</mn>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>N</ci>
    <cn type="integer">2</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   N^{2}
  </annotation>
 </semantics>
</math>

 addresses are needed. Only 

<math display="inline" id="Yen's_algorithm:136">
 <semantics>
  <mrow>
   <mi>K</mi>
   <mi>N</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>K</ci>
    <ci>N</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   KN
  </annotation>
 </semantics>
</math>

 addresses are need for both list 

<math display="inline" id="Yen's_algorithm:137">
 <semantics>
  <mi>A</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>A</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Yen's_algorithm:138">
 <semantics>
  <mi>B</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>B</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   B
  </annotation>
 </semantics>
</math>

 because at most only 

<math display="inline" id="Yen's_algorithm:139">
 <semantics>
  <mi>K</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>K</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   K
  </annotation>
 </semantics>
</math>

 paths will be stored,<a class="footnoteRef" href="#fn4" id="fnref4"><sup>4</sup></a> where it is possible for each path to have 

<math display="inline" id="Yen's_algorithm:140">
 <semantics>
  <mi>N</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>N</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   N
  </annotation>
 </semantics>
</math>

 nodes.</p>
<h3 id="time-complexity">Time complexity</h3>

<p>The time complexity of Yen's algorithm is dependent on the shortest path algorithm used in the computation of the spur paths, so the Dijkstra algorithm is assumed. Dijkstra's algorithm has a worse case time complexity of 

<math display="inline" id="Yen's_algorithm:141">
 <semantics>
  <mrow>
   <mi>O</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msup>
     <mi>N</mi>
     <mn>2</mn>
    </msup>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>O</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>N</ci>
     <cn type="integer">2</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   O(N^{2})
  </annotation>
 </semantics>
</math>

, but using a Fibonacci heap it becomes 

<math display="inline" id="Yen's_algorithm:142">
 <semantics>
  <mrow>
   <mi>O</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mrow>
     <mi>M</mi>
     <mo>+</mo>
     <mrow>
      <mi>N</mi>
      <mrow>
       <mi>log</mi>
       <mi>N</mi>
      </mrow>
     </mrow>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>O</ci>
    <apply>
     <plus></plus>
     <ci>M</ci>
     <apply>
      <times></times>
      <ci>N</ci>
      <apply>
       <log></log>
       <ci>N</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   O(M+N\log N)
  </annotation>
 </semantics>
</math>

,<a class="footnoteRef" href="#fn5" id="fnref5"><sup>5</sup></a> where 

<math display="inline" id="Yen's_algorithm:143">
 <semantics>
  <mi>M</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>M</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   M
  </annotation>
 </semantics>
</math>

 is the amount of edges in the graph. Since Yen's algorithm makes 

<math display="inline" id="Yen's_algorithm:144">
 <semantics>
  <mrow>
   <mi>K</mi>
   <mi>l</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>K</ci>
    <ci>l</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Kl
  </annotation>
 </semantics>
</math>

 calls to the Dijkstra in computing the spur paths, where 

<math display="inline" id="Yen's_algorithm:145">
 <semantics>
  <mi>l</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>l</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   l
  </annotation>
 </semantics>
</math>

 is the length of spur paths. In a condensed graph, the expected value of 

<math display="inline" id="Yen's_algorithm:146">
 <semantics>
  <mi>l</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>l</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   l
  </annotation>
 </semantics>
</math>

 is 

<math display="inline" id="Yen's_algorithm:147">
 <semantics>
  <mrow>
   <mi>O</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mrow>
     <mi>log</mi>
     <mi>N</mi>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>O</ci>
    <apply>
     <log></log>
     <ci>N</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   O(\log N)
  </annotation>
 </semantics>
</math>

, while the worst case is 

<math display="inline" id="Yen's_algorithm:148">
 <semantics>
  <mi>N</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>N</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   N
  </annotation>
 </semantics>
</math>

. , the time complexity becomes 

<math display="inline" id="Yen's_algorithm:149">
 <semantics>
  <mrow>
   <mi>O</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mrow>
     <mi>K</mi>
     <mi>N</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mi>M</mi>
       <mo>+</mo>
       <mrow>
        <mi>N</mi>
        <mrow>
         <mi>log</mi>
         <mi>N</mi>
        </mrow>
       </mrow>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>O</ci>
    <apply>
     <times></times>
     <ci>K</ci>
     <ci>N</ci>
     <apply>
      <plus></plus>
      <ci>M</ci>
      <apply>
       <times></times>
       <ci>N</ci>
       <apply>
        <log></log>
        <ci>N</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   O(KN(M+N\log N))
  </annotation>
 </semantics>
</math>

. <a class="footnoteRef" href="#fn6" id="fnref6"><sup>6</sup></a></p>
<h2 id="improvements">Improvements</h2>

<p>Yen's algorithm can be improved by using a heap to store 

<math display="inline" id="Yen's_algorithm:150">
 <semantics>
  <mi>B</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>B</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   B
  </annotation>
 </semantics>
</math>

, the set of potential <em>k</em>-shortest paths. Using a heap instead of a list will improve the performance of the algorithm, but not the complexity.<a class="footnoteRef" href="#fn7" id="fnref7"><sup>7</sup></a> One method to slightly decrease complexity is to skip the nodes where there are non-existent spur paths. This case is produced when all the spur paths from a spur node have been used in the previous 

<math display="inline" id="Yen's_algorithm:151">
 <semantics>
  <msup>
   <mi>A</mi>
   <mi>k</mi>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>A</ci>
    <ci>k</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A^{k}
  </annotation>
 </semantics>
</math>

. Also, if container 

<math display="inline" id="Yen's_algorithm:152">
 <semantics>
  <mi>B</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>B</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   B
  </annotation>
 </semantics>
</math>

 has 

<math display="inline" id="Yen's_algorithm:153">
 <semantics>
  <mrow>
   <mi>K</mi>
   <mo>-</mo>
   <mi>k</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <minus></minus>
    <ci>K</ci>
    <ci>k</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   K-k
  </annotation>
 </semantics>
</math>

 paths of minimum length, in reference to those in container 

<math display="inline" id="Yen's_algorithm:154">
 <semantics>
  <mi>A</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>A</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A
  </annotation>
 </semantics>
</math>

, then they can be extract and inserted into container 

<math display="inline" id="Yen's_algorithm:155">
 <semantics>
  <mi>A</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>A</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A
  </annotation>
 </semantics>
</math>

 since no shorter paths will be found.</p>
<h3 id="lawlers-modification">Lawler's modification</h3>

<p><a href="Eugene_Lawler" title="wikilink">Eugene Lawler</a> proposed a modification to Yen's algorithm in which duplicates path are not calculated as opposed to the original algorithm where they are calculated and then discarded when they are found to be duplicates.<a class="footnoteRef" href="#fn8" id="fnref8"><sup>8</sup></a> These duplicates paths result from calculating spur paths of nodes in the root of 

<math display="inline" id="Yen's_algorithm:156">
 <semantics>
  <msup>
   <mi>A</mi>
   <mi>k</mi>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>A</ci>
    <ci>k</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A^{k}
  </annotation>
 </semantics>
</math>

. For instance, 

<math display="inline" id="Yen's_algorithm:157">
 <semantics>
  <msup>
   <mi>A</mi>
   <mi>k</mi>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>A</ci>
    <ci>k</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A^{k}
  </annotation>
 </semantics>
</math>

 deviates from 

<math display="inline" id="Yen's_algorithm:158">
 <semantics>
  <msup>
   <mi>A</mi>
   <mrow>
    <mi>k</mi>
    <mo>-</mo>
    <mn>1</mn>
   </mrow>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>A</ci>
    <apply>
     <minus></minus>
     <ci>k</ci>
     <cn type="integer">1</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A^{k-1}
  </annotation>
 </semantics>
</math>

 at some node 

<math display="inline" id="Yen's_algorithm:159">
 <semantics>
  <mrow>
   <mo stretchy="false">(</mo>
   <mi>i</mi>
   <mo stretchy="false">)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <ci>i</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (i)
  </annotation>
 </semantics>
</math>

. Any spur path, 

<math display="inline" id="Yen's_algorithm:160">
 <semantics>
  <mmultiscripts>
   <mi>S</mi>
   <none></none>
   <mi>k</mi>
   <mi>j</mi>
   <none></none>
  </mmultiscripts>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>S</ci>
     <ci>k</ci>
    </apply>
    <ci>j</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   {S^{k}}_{j}
  </annotation>
 </semantics>
</math>

 where 

<math display="inline" id="Yen's_algorithm:161">
 <semantics>
  <mrow>
   <mi>j</mi>
   <mo>=</mo>
   <mrow>
    <mn>0</mn>
    <mo>,</mo>
    <mi mathvariant="normal">…</mi>
    <mo>,</mo>
    <mi>i</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>j</ci>
    <list>
     <cn type="integer">0</cn>
     <ci>normal-…</ci>
     <ci>i</ci>
    </list>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   j=0,\ldots,i
  </annotation>
 </semantics>
</math>

, that is calculated will be a duplicate because they have already been calculated during the 

<math display="inline" id="Yen's_algorithm:162">
 <semantics>
  <mrow>
   <mi>k</mi>
   <mo>-</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <minus></minus>
    <ci>k</ci>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   k-1
  </annotation>
 </semantics>
</math>

 iteration. Therefore, only spur paths for nodes that were on the spur path of 

<math display="inline" id="Yen's_algorithm:163">
 <semantics>
  <msup>
   <mi>A</mi>
   <mrow>
    <mi>k</mi>
    <mo>-</mo>
    <mn>1</mn>
   </mrow>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>A</ci>
    <apply>
     <minus></minus>
     <ci>k</ci>
     <cn type="integer">1</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A^{k-1}
  </annotation>
 </semantics>
</math>

 must be calculated, i.e. only 

<math display="inline" id="Yen's_algorithm:164">
 <semantics>
  <mmultiscripts>
   <mi>S</mi>
   <none></none>
   <mi>k</mi>
   <mi>h</mi>
   <none></none>
  </mmultiscripts>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>S</ci>
     <ci>k</ci>
    </apply>
    <ci>h</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   {S^{k}}_{h}
  </annotation>
 </semantics>
</math>

 where 

<math display="inline" id="Yen's_algorithm:165">
 <semantics>
  <mi>h</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>h</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   h
  </annotation>
 </semantics>
</math>

 ranges from 

<math display="inline" id="Yen's_algorithm:166">
 <semantics>
  <msup>
   <mrow>
    <mo stretchy="false">(</mo>
    <mrow>
     <mi>i</mi>
     <mo>+</mo>
     <mn>1</mn>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
   <mrow>
    <mi>k</mi>
    <mo>-</mo>
    <mn>1</mn>
   </mrow>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <apply>
     <plus></plus>
     <ci>i</ci>
     <cn type="integer">1</cn>
    </apply>
    <apply>
     <minus></minus>
     <ci>k</ci>
     <cn type="integer">1</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (i+1)^{k-1}
  </annotation>
 </semantics>
</math>

 to 

<math display="inline" id="Yen's_algorithm:167">
 <semantics>
  <msup>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>Q</mi>
     <mi>k</mi>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
   <mrow>
    <mi>k</mi>
    <mo>-</mo>
    <mn>1</mn>
   </mrow>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>Q</ci>
     <ci>k</ci>
    </apply>
    <apply>
     <minus></minus>
     <ci>k</ci>
     <cn type="integer">1</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (Q_{k})^{k-1}
  </annotation>
 </semantics>
</math>

. To perform this operation for 

<math display="inline" id="Yen's_algorithm:168">
 <semantics>
  <msup>
   <mi>A</mi>
   <mi>k</mi>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>A</ci>
    <ci>k</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A^{k}
  </annotation>
 </semantics>
</math>

, a record is needed to identify the node where 

<math display="inline" id="Yen's_algorithm:169">
 <semantics>
  <msup>
   <mi>A</mi>
   <mrow>
    <mi>k</mi>
    <mo>-</mo>
    <mn>1</mn>
   </mrow>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>A</ci>
    <apply>
     <minus></minus>
     <ci>k</ci>
     <cn type="integer">1</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A^{k-1}
  </annotation>
 </semantics>
</math>

 branched from 

<math display="inline" id="Yen's_algorithm:170">
 <semantics>
  <msup>
   <mi>A</mi>
   <mrow>
    <mi>k</mi>
    <mo>-</mo>
    <mn>2</mn>
   </mrow>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>A</ci>
    <apply>
     <minus></minus>
     <ci>k</ci>
     <cn type="integer">2</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A^{k-2}
  </annotation>
 </semantics>
</math>

.</p>
<h2 id="see-also">See also</h2>
<ul>
<li>Yen's improvement to the <a href="Bellman–Ford_algorithm#Yen.27s_improvement" title="wikilink">Bellman–Ford algorithm</a></li>
</ul>
<h2 id="references">References</h2>
<h2 id="external-links">External links</h2>
<ul>
<li><a href="https://github.com/Pent00/YenKSP">Open Source Python Implementation</a> on GitHub</li>
<li><a href="http://code.google.com/p/k-shortest-paths/">Open Source C++ Implementation</a> on Google Code</li>
</ul>

<p>"</p>

<p><a href="Category:Graph_algorithms" title="wikilink">Category:Graph algorithms</a> <a href="Category:Polynomial-time_problems" title="wikilink">Category:Polynomial-time problems</a> <a href="Category:Articles_with_example_pseudocode" title="wikilink">Category:Articles with example pseudocode</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1"><a href="#fnref1">↩</a></li>
<li id="fn2"><a href="#fnref2">↩</a></li>
<li id="fn3"></li>
<li id="fn4"></li>
<li id="fn5"><a href="#fnref5">↩</a></li>
<li id="fn6"><a href="#fnref6">↩</a></li>
<li id="fn7"><a href="#fnref7">↩</a></li>
<li id="fn8"><a href="#fnref8">↩</a></li>
</ol>
</section>
</body>
</html>

<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="1550">Draft:Chirp: Reducing Spectral Ripple</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Draft:Chirp: Reducing Spectral Ripple</h1>
<hr/>
<hr/>
<h2 id="chirp-reducing-spectral-ripple">Chirp: Reducing Spectral Ripple</h2>

<p>The spectrum of a constant-amplitude linear chirp does not have a simple rectangular profile, as might be expected, but it has a number of obtrusive ripples superimposed upon it. These ripples, often referred to as Fresnel ripples, are a consequence of the truncation of the sweep range of the chirp to a limited band of frequencies. Their presence can be unwelcome if, say, the waveform is a test waveform being used for system analysis purposes, or it is to be compressed in a <a class="uri" href="radar" title="wikilink">radar</a> or <a class="uri" href="sonar" title="wikilink">sonar</a> application where the ripples cause unwanted artifacts to appear on the resultant output. The ripples are particularly noticable when the time-bandwidth product of a chirp is small, about 50 or less. There are a number of procedures that can be applied to reduce the ripple levels, but they are not all equally effective. Furthermore, some of the methods require amplitude shaping, or amplitude modulation, of the chirp pulse and this is not always possible (for example, when chirp pulses are transmitted by a power amplifier operating in a near-limiting conditions). For such systems only the methods using frequency (or phase) pre-distortion are appropriate.<br/>
For reference, two spectra are shown, with time bandwidth products of 250 and 25. (They are taken from <a href="chirp_spectrum" title="wikilink">chirp spectrum</a>). </p>
<h3 id="introducing-rise-and-fall-times-of-finite-duration">Introducing Rise and Fall Times of Finite Duration</h3>

<p>If the transitions at the start and end of the chirp are made less sudden (or more 'rounded'), then a reduction in ripple amplitude is achieved<a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a><a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a> <a class="footnoteRef" href="#fn3" id="fnref3"><sup>3</sup></a>. The durations of the two transition regions need only be a small fraction of the total pulse duration, and suggested values are between 2/<mtpl></mtpl>F and 3/<mtpl></mtpl>F <a class="footnoteRef" href="#fn4" id="fnref4"><sup>4</sup></a> but, as expected, when the time-bandwidth product of the pulse is small, longer transition periods are needed. The actual profiles of these rise and fall regions of a pulse do not seem to be critical and may be provided, for example, by band limiting filters in analogue implementations and a linear slope in digital ones.<br/>
 Two examples show the spectra of linear chirps with finite rise-times. The first is for a chirp with time-bandwidth of 250, where the rise and fall times are 4% of the total pulse duration and the second is for a chirp with time-bandwidth of 25, where the rise and fall times are 10% of the total. These two spectra show a marked reduction in ripple amplitude compared to the spectra of unmodified linear chirps shown earlier.<br/>
</p>
<h3 id="applying-phase-or-frequency-distortion-to-the-chirp-pulse">Applying Phase or Frequency Distortion to the Chirp Pulse</h3>

<p>A analogous technique can be applied to the frequency characteristic of the chirp waveform by adding linear FM distortion segments (quadratic phase modulation distortion) to the frequency characteristic of the chirp, as shown. The method is effective because amplitude and phase distortions having functional similarity can produce similar effects when the distortion factors are small<a class="footnoteRef" href="#fn5" id="fnref5"><sup>5</sup></a><a class="footnoteRef" href="#fn6" id="fnref6"><sup>6</sup></a>.<br/>
 Suggested values for these distortion regions, to give good results are:<br/>
<math display="inline" id="Draft:Chirp:_Reducing_Spectral_Ripple:0">
<semantics>
<mrow>
<mrow>
<mrow>
<mi mathvariant="normal">Δ</mi>
<msub>
<mi>f</mi>
<mi>p</mi>
</msub>
</mrow>
<mo>=</mo>
<mrow>
<mrow>
<mn>0.75</mn>
<mi mathvariant="normal">Δ</mi>
<mi>F</mi>
</mrow>
<mrow>
<mi>a</mi>
<mi>n</mi>
<mi>d</mi>
</mrow>
</mrow>
</mrow>
<mrow>
<mi>δ</mi>
<mo>=</mo>
<mrow>
<mrow>
<mn>1</mn>
<mo>/</mo>
<mi mathvariant="normal">Δ</mi>
</mrow>
<mi>F</mi>
</mrow>
</mrow>
</mrow>
<annotation-xml encoding="MathML-Content">
<apply>
<csymbol cd="ambiguous">formulae-sequence</csymbol>
<apply>
<eq></eq>
<apply>
<times></times>
<ci>normal-Δ</ci>
<apply>
<csymbol cd="ambiguous">subscript</csymbol>
<ci>f</ci>
<ci>p</ci>
</apply>
</apply>
<list>
<apply>
<times></times>
<cn type="float">0.75</cn>
<ci>normal-Δ</ci>
<ci>F</ci>
</apply>
<apply>
<times></times>
<ci>a</ci>
<ci>n</ci>
<ci>d</ci>
</apply>
</list>
</apply>
<apply>
<eq></eq>
<ci>δ</ci>
<apply>
<times></times>
<apply>
<divide></divide>
<cn type="integer">1</cn>
<ci>normal-Δ</ci>
</apply>
<ci>F</ci>
</apply>
</apply>
</apply>
</annotation-xml>
<annotation encoding="application/x-tex">
   \Delta f_{p}=0.75\Delta F\qquad and\qquad\delta=1/\Delta F
  </annotation>
</semantics>
</math>
<br/>
<br/>
Later work<a class="footnoteRef" href="#fn7" id="fnref7"><sup>7</sup></a> proposed slightly different values, namely:<br/>
<math display="inline" id="Draft:Chirp:_Reducing_Spectral_Ripple:1">
<semantics>
<mrow>
<mrow>
<mrow>
<mi mathvariant="normal">Δ</mi>
<msub>
<mi>f</mi>
<mi>p</mi>
</msub>
</mrow>
<mo>=</mo>
<mrow>
<mrow>
<mn>0.73</mn>
<mi mathvariant="normal">Δ</mi>
<mi>F</mi>
</mrow>
<mrow>
<mi>a</mi>
<mi>n</mi>
<mi>d</mi>
</mrow>
</mrow>
</mrow>
<mrow>
<mi>δ</mi>
<mo>=</mo>
<mrow>
<mrow>
<mn>0.86</mn>
<mo>/</mo>
<mi mathvariant="normal">Δ</mi>
</mrow>
<mi>F</mi>
</mrow>
</mrow>
</mrow>
<annotation-xml encoding="MathML-Content">
<apply>
<csymbol cd="ambiguous">formulae-sequence</csymbol>
<apply>
<eq></eq>
<apply>
<times></times>
<ci>normal-Δ</ci>
<apply>
<csymbol cd="ambiguous">subscript</csymbol>
<ci>f</ci>
<ci>p</ci>
</apply>
</apply>
<list>
<apply>
<times></times>
<cn type="float">0.73</cn>
<ci>normal-Δ</ci>
<ci>F</ci>
</apply>
<apply>
<times></times>
<ci>a</ci>
<ci>n</ci>
<ci>d</ci>
</apply>
</list>
</apply>
<apply>
<eq></eq>
<ci>δ</ci>
<apply>
<times></times>
<apply>
<divide></divide>
<cn type="float">0.86</cn>
<ci>normal-Δ</ci>
</apply>
<ci>F</ci>
</apply>
</apply>
</apply>
</annotation-xml>
<annotation encoding="application/x-tex">
   \Delta f_{p}=0.73\Delta F\qquad and\qquad\delta=0.86/\Delta F
  </annotation>
</semantics>
</math>
<br/>
but the outcome can doubtless be improved by optimizing values for each particular situation.<br/>
Two plots show the effects of frequency pre-correction and can be compared to the results in the earlier sections.<br/>
 The ripple reduction achieved by frequency pre-correction, although significant, is seen to be less successful than that achieved by the amplitude modulation methods of the previous section. However, it has been suggested<a class="footnoteRef" href="#fn8" id="fnref8"><sup>8</sup></a> that by implementing cubic (rather than quadratic) phase pre-correction, comparable results can be achieved.<br/>
</p>
<h3 id="deriving-a-waveform-from-a-target-frequency-spectrum">Deriving a Waveform from a Target Frequency Spectrum</h3>

<p>This method uses an inverse Fourier transform in order to derive a waveform which has a spectrum with the phase characteristic of a chosen chirp but a new amplitude profile which is rectangular and ripple free. The method is very effective but, unfortunately, the waveform that is so derived has a very long time duration. If, for convenience, the newly derived waveform is truncated to a practical length, then some ripple is reintroduced onto the spectrum.<br/>
As an example, a linear chirp waveform with a time bandwidth of 25 is shown together with its spectrum magnitude (shown by a full line) which, as demonstrated earlier, has a large ripple component. It is possible to find, by means of an inverse FFT, a chirp waveform which, in the frequency domain, has the same phase characteristic as before, but with the rectangular magnitude characteristic shown by the dashed line on the plot. The chirp waveform resulting from this process has a has a semi-infinite time duration, but when it is truncated to say, a length 2T, then the spectrum acquires some ripple once more, as shown.<br/>
</p>
<h3 id="applying-window-functions">Applying Window Functions</h3>

<p>There are many applications in which a spectrum with a rectangular magnitude profile is not ideal. For example, when a chirp waveform is compressed by means of its matched filter, then the resultant waveform approximates to the <a class="uri" href="sinc" title="wikilink">sinc</a> function and, consequently, has annoyingly high sidelobes. Often, to improve the characteristics of the pulse and lower the sidelobe levels, its spectrum is modified, typically to a bell-shaped profile. Similar problems arise in <a href="digital_signal_processing" title="wikilink">digital signal processing</a> where the spectral shaping is provided by a <a href="window_function" title="wikilink">window function</a>, a process sometimes called <a class="uri" href="apodization" title="wikilink">apodization</a>. In the case of an antenna array, similar profiling by "weighting functions" is used to reduce the spatial sidelobes of the radiation pattern.<br/>
Although spectral shaping of a chirp could be applied in the frequency domain, better results are obtained if the shaping is carried out in the time domain<a class="footnoteRef" href="#fn9" id="fnref9"><sup>9</sup></a><a class="footnoteRef" href="#fn10" id="fnref10"><sup>10</sup></a>.<br/>
Examples of this process are shown for linear chirps with time-bandwidth products of 250 and 25. They have been shaped by a 3-term Blackman-Harris window<a class="footnoteRef" href="#fn11" id="fnref11"><sup>11</sup></a><br/>
<math display="inline" id="Draft:Chirp:_Reducing_Spectral_Ripple:2">
<semantics>
<mrow>
<msup>
<mrow>
<mo stretchy="false">|</mo>
<mrow>
<mi>U</mi>
<mrow>
<mo stretchy="false">(</mo>
<mi>ω</mi>
<mo stretchy="false">)</mo>
</mrow>
</mrow>
<mo stretchy="false">|</mo>
</mrow>
<mn>2</mn>
</msup>
<mo>=</mo>
<mrow>
<mrow>
<mn>0.42323</mn>
<mo>-</mo>
<mrow>
<mn>0.49755</mn>
<mi>c</mi>
<mi>o</mi>
<mi>s</mi>
<mrow>
<mo>(</mo>
<mfrac>
<mrow>
<mn>2</mn>
<mi>π</mi>
<mi>ω</mi>
</mrow>
<msub>
<mi>ω</mi>
<mrow>
<mi>m</mi>
<mi>a</mi>
<mi>x</mi>
</mrow>
</msub>
</mfrac>
<mo>)</mo>
</mrow>
</mrow>
</mrow>
<mo>+</mo>
<mrow>
<mn>0.07922</mn>
<mi>c</mi>
<mi>o</mi>
<mi>s</mi>
<mrow>
<mo>(</mo>
<mfrac>
<mrow>
<mn>4</mn>
<mi>π</mi>
<mi>ω</mi>
</mrow>
<msub>
<mi>ω</mi>
<mrow>
<mi>m</mi>
<mi>a</mi>
<mi>x</mi>
</mrow>
</msub>
</mfrac>
<mo>)</mo>
</mrow>
</mrow>
</mrow>
</mrow>
<annotation-xml encoding="MathML-Content">
<apply>
<eq></eq>
<apply>
<csymbol cd="ambiguous">superscript</csymbol>
<apply>
<abs></abs>
<apply>
<times></times>
<ci>U</ci>
<ci>ω</ci>
</apply>
</apply>
<cn type="integer">2</cn>
</apply>
<apply>
<plus></plus>
<apply>
<minus></minus>
<cn type="float">0.42323</cn>
<apply>
<times></times>
<cn type="float">0.49755</cn>
<ci>c</ci>
<ci>o</ci>
<ci>s</ci>
<apply>
<divide></divide>
<apply>
<times></times>
<cn type="integer">2</cn>
<ci>π</ci>
<ci>ω</ci>
</apply>
<apply>
<csymbol cd="ambiguous">subscript</csymbol>
<ci>ω</ci>
<apply>
<times></times>
<ci>m</ci>
<ci>a</ci>
<ci>x</ci>
</apply>
</apply>
</apply>
</apply>
</apply>
<apply>
<times></times>
<cn type="float">0.07922</cn>
<ci>c</ci>
<ci>o</ci>
<ci>s</ci>
<apply>
<divide></divide>
<apply>
<times></times>
<cn type="integer">4</cn>
<ci>π</ci>
<ci>ω</ci>
</apply>
<apply>
<csymbol cd="ambiguous">subscript</csymbol>
<ci>ω</ci>
<apply>
<times></times>
<ci>m</ci>
<ci>a</ci>
<ci>x</ci>
</apply>
</apply>
</apply>
</apply>
</apply>
</apply>
</annotation-xml>
<annotation encoding="application/x-tex">
   |U(\omega)|^{2}=0.42323-0.49755cos\left(\frac{2\pi\omega}{\omega_{max}}\right)%
+0.07922cos\left(\frac{4\pi\omega}{\omega_{max}}\right)
  </annotation>
</semantics>
</math>
<br/>
The spectra, now bell-shaped, are seen to be free of ripples.   Non-linear chirps can be devised that have a bell shaped spectrum, such as the Blackman-Harris window just discussed, and consequently will exhibit reduced ripple compared to the linear chirp. By means of the stationary phase method described earlier, an approximate relationship between time and frequency can be obtained and is:<br/>
<math display="inline" id="Draft:Chirp:_Reducing_Spectral_Ripple:3">
<semantics>
<mrow>
<mfrac>
<mi>t</mi>
<mi>T</mi>
</mfrac>
<mo>=</mo>
<mrow>
<mfrac>
<mn>1</mn>
<mn>2</mn>
</mfrac>
<mo>+</mo>
<mfrac>
<mi>ω</mi>
<msub>
<mi>ω</mi>
<mrow>
<mi>m</mi>
<mi>a</mi>
<mi>x</mi>
</mrow>
</msub>
</mfrac>
<mo>+</mo>
<mrow>
<mn>0.1871</mn>
<mi>s</mi>
<mi>i</mi>
<mi>n</mi>
<mrow>
<mo>(</mo>
<mfrac>
<mrow>
<mn>2</mn>
<mi>π</mi>
<mi>ω</mi>
</mrow>
<msub>
<mi>ω</mi>
<mrow>
<mi>m</mi>
<mi>a</mi>
<mi>x</mi>
</mrow>
</msub>
</mfrac>
<mo>)</mo>
</mrow>
</mrow>
<mo>+</mo>
<mrow>
<mn>0.014895</mn>
<mi>s</mi>
<mi>i</mi>
<mi>n</mi>
<mrow>
<mo>(</mo>
<mfrac>
<mrow>
<mn>4</mn>
<mi>π</mi>
<mi>ω</mi>
</mrow>
<msub>
<mi>ω</mi>
<mrow>
<mi>m</mi>
<mi>a</mi>
<mi>x</mi>
</mrow>
</msub>
</mfrac>
<mo>)</mo>
</mrow>
</mrow>
</mrow>
</mrow>
<annotation-xml encoding="MathML-Content">
<apply>
<eq></eq>
<apply>
<divide></divide>
<ci>t</ci>
<ci>T</ci>
</apply>
<apply>
<plus></plus>
<apply>
<divide></divide>
<cn type="integer">1</cn>
<cn type="integer">2</cn>
</apply>
<apply>
<divide></divide>
<ci>ω</ci>
<apply>
<csymbol cd="ambiguous">subscript</csymbol>
<ci>ω</ci>
<apply>
<times></times>
<ci>m</ci>
<ci>a</ci>
<ci>x</ci>
</apply>
</apply>
</apply>
<apply>
<times></times>
<cn type="float">0.1871</cn>
<ci>s</ci>
<ci>i</ci>
<ci>n</ci>
<apply>
<divide></divide>
<apply>
<times></times>
<cn type="integer">2</cn>
<ci>π</ci>
<ci>ω</ci>
</apply>
<apply>
<csymbol cd="ambiguous">subscript</csymbol>
<ci>ω</ci>
<apply>
<times></times>
<ci>m</ci>
<ci>a</ci>
<ci>x</ci>
</apply>
</apply>
</apply>
</apply>
<apply>
<times></times>
<cn type="float">0.014895</cn>
<ci>s</ci>
<ci>i</ci>
<ci>n</ci>
<apply>
<divide></divide>
<apply>
<times></times>
<cn type="integer">4</cn>
<ci>π</ci>
<ci>ω</ci>
</apply>
<apply>
<csymbol cd="ambiguous">subscript</csymbol>
<ci>ω</ci>
<apply>
<times></times>
<ci>m</ci>
<ci>a</ci>
<ci>x</ci>
</apply>
</apply>
</apply>
</apply>
</apply>
</apply>
</annotation-xml>
<annotation encoding="application/x-tex">
   \frac{t}{T}=\frac{1}{2}+\frac{\omega}{\omega_{max}}+0.1871sin\left(\frac{2\pi%
\omega}{\omega_{max}}\right)+0.014895sin\left(\frac{4\pi\omega}{\omega_{max}}\right)
  </annotation>
</semantics>
</math>
<br/>
 Rearranging the equation, a plot of frequency against time can be plotted, as shown.<br/>
<br/>
As examples, plots of the spectral magnitudes of non-linear chirps with spectral profiles of Blackman-Harris windows and with time-bandwidth products of 250 and 25 are shown below. As can be seen, there is some ripple reduction, but the disappointing performance can be attributed to the fact that these chirps, although they have reduced energy content in their outer frequency regions, they still have amplitude profiles with fast rise and fall times.<br/>
<br/>
</p>
<h2 id="see-also">See Also</h2>

<p><a class="uri" href="chirp" title="wikilink">chirp</a><br/>
<a href="chirp_spectrum" title="wikilink">chirp spectrum</a><br/>
<a href="pulse_compression" title="wikilink">pulse compression</a><br/>
</p>
<h2 id="references">References</h2>
<references>
</references>

<p>"</p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1">Cook C.E. &amp; Paolillo J., "A Pulse Compression Predistortion Function for Efficient Sidelobe Reduction in a High-Power Radar", Proc. IEEE Vol.52, April 1964 (pp.377-384)<a href="#fnref1">↩</a></li>
<li id="fn2">Kowatsch M. and Stocker H.R., "Effect of Fresnel ripples on sidelobe suppression in low time-bandwith product linear FM pulse compression", IEE Proc. Vol. 129, Pf. F, No.1 Feb 1982<a href="#fnref2">↩</a></li>
<li id="fn3">Cook C.E. and Bernfeld M., "Radar Signals - An Introduction to Theory and Application", Artech House 1993 <a href="#fnref3">↩</a></li>
<li id="fn4"></li>
<li id="fn5"></li>
<li id="fn6">Wheeler H.A., "The Interpretation of Amplitude and Phase Distortion in Terms of Paired Echoes", Proc. IRE, June 1939<a href="#fnref6">↩</a></li>
<li id="fn7">Solal M., "High Performance SAW Delay Lines for Low Time Bandwidth Using Periodically Sampled Transducers", Ultrasonics Symposium, IEEE, Nov. 1988.<a href="#fnref7">↩</a></li>
<li id="fn8"></li>
<li id="fn9">Judd G.W., "Technique for Realizing Low Time Sidelobe Levels in Small Compression Ratio Chirp Waveforms", Proc. IEEE Ultrasonics Symposium, 1973, pp.478-483<a href="#fnref9">↩</a></li>
<li id="fn10">McCue J.J.G., "A Note on the Hamming Weighting of Linear-FM Pulses", Proc. IEEE, Vol. 67, No. 11, Nov 1979, pp.1575-1577.<a href="#fnref10">↩</a></li>
<li id="fn11">Harris F.J., "On the Use of Windows for Harmonic Analysis with the Discrete Fourier Transform", Proc. IEEE Vol.66, Jan 1978<a href="#fnref11">↩</a></li>
</ol>
</section>
</body>
</html>

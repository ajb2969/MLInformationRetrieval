<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="895">Guided tour puzzle protocol</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Guided tour puzzle protocol</h1>
<hr/>

<p>Guided tour puzzle (GTP) protocol is a <a href="cryptographic_protocol" title="wikilink">cryptographic protocol</a> for mitigating <a href="Denial-of-service_attack" title="wikilink">application layer denial of service attacks</a>. It aims to overcome the shortcoming of <a href="Client_Puzzle_Protocol" title="wikilink">computation-based puzzle protocols</a>, in which <a href="Client_(computing)" title="wikilink">clients</a> are required to compute hard CPU or memory-bound puzzles that favor clients with abundant computational resources. <strong>Guided tour puzzle protocol</strong> can be seen as a form of <a href="Proof-of-work_system" title="wikilink">proof-of-work</a> (POW) protocol.</p>
<h2 id="overview">Overview</h2>

<p>The protocol steps of the guided tour puzzle protocol is similar to that of client puzzle protocol. All clients are required to complete a guided tour puzzle prior to receiving service from the <a href="Server_(computing)" title="wikilink">server</a>, if the server suspects it is currently under <a href="Denial-of-service_attack" title="wikilink">denial of service attack</a> or its load exceeds a pre-defined threshold. Simply put, a guided tour puzzle is a tour that needs to be completed by taking multiple <a href="Round-trip_delay_time" title="wikilink">round-trips</a> to a set of special nodes, called <em>tour guides</em>, in a sequential order. It is called a <em>guided tour</em>, because the order in which the tour guides are visited is unknown to the client, and each tour guide has to direct the client towards the next tour guide for the client to complete the tour in correct order. A single tour guide may appear multiple times in a tour, so the term <em>stop</em> is used to denote a single appearance of a tour guide in a tour. A client knows which tour guide is at the next stop, only after completing its visit to the current stop.</p>

<p>Solving a guided tour puzzle is essentially equal to completing a guided tour in the correct order. Starting from the first stop, the client contacts each stop and receives a reply. Each reply contains a unique token. The token in the reply message from the current stop is used for computing the address of the next stop tour guide. The address of the first stop tour guide is computed using the token contained in the server's first reply message that informs the client of the start of a puzzle process.</p>

<p>The client must send the token received from the current stop tour guide to the next stop tour guide, which will use it as an input to its token calculation function. The token received from the last stop tour guide plus the token from the server's puzzle message are sent to the server as the proof of completion of a tour. The server can efficiently validate these two tokens, and grants service to the client only after proving their validity.</p>
<h2 id="protocol-steps">Protocol Steps</h2>
<figure><b>(Figure)</b>
<figcaption>Example of a guided tour puzzle when the number of tour guides is 2, and the tour length is 5. The order of the tour is: G1 -&gt; G0 -&gt; G1 -&gt; G1 -&gt; G0.</figcaption>
</figure>

<p>Before the guided tour puzzle can start, 

<math display="inline" id="Guided_tour_puzzle_protocol:0">
 <semantics>
  <mi>N</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>N</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   N
  </annotation>
 </semantics>
</math>

 tour guides has to be set up in the system, where 

<math display="inline" id="Guided_tour_puzzle_protocol:1">
 <semantics>
  <mrow>
   <mi>N</mi>
   <mo>≥</mo>
   <mn>2</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <geq></geq>
    <ci>N</ci>
    <cn type="integer">2</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   N\geq 2
  </annotation>
 </semantics>
</math>

. Meanwhile, the server establishes a <a href="shared_secret" title="wikilink">shared secret</a> 

<math display="inline" id="Guided_tour_puzzle_protocol:2">
 <semantics>
  <msub>
   <mi>k</mi>
   <mrow>
    <mi>j</mi>
    <mi>s</mi>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>k</ci>
    <apply>
     <times></times>
     <ci>j</ci>
     <ci>s</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   k_{js}
  </annotation>
 </semantics>
</math>

 with each tour guide 

<math display="inline" id="Guided_tour_puzzle_protocol:3">
 <semantics>
  <msub>
   <mi>G</mi>
   <mi>j</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>G</ci>
    <ci>j</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   G_{j}
  </annotation>
 </semantics>
</math>


 using a secure channel, where 

<math display="inline" id="Guided_tour_puzzle_protocol:4">
 <semantics>
  <mi>L</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>L</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   L
  </annotation>
 </semantics>
</math>

 for computing the first hash value that is returned to the client as part of a puzzle message. A puzzle message also contains the length of the tour 

<math display="inline" id="Guided_tour_puzzle_protocol:5">
 <semantics>
  <mrow>
   <mi>N</mi>
   <mo>=</mo>
   <mn>2</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>N</ci>
    <cn type="integer">2</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   N=2
  </annotation>
 </semantics>
</math>

, which is used to control the difficulty of a guided tour puzzle. The figure shows an example of a guided tour when 

<math display="inline" id="Guided_tour_puzzle_protocol:6">
 <semantics>
  <mrow>
   <mi>L</mi>
   <mo>=</mo>
   <mn>5</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>L</ci>
    <cn type="integer">5</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   L=5
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Guided_tour_puzzle_protocol:7">
 <semantics>
  <mi>x</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>x</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x
  </annotation>
 </semantics>
</math>

.</p>

<p>The details of the each protocol step of the guided tour puzzle protocol is explained in the following.<a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a></p>
<ul>
<li><strong>Service request</strong>: A client 

<math display="inline" id="Guided_tour_puzzle_protocol:8">
 <semantics>
  <mi>x</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>x</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x
  </annotation>
 </semantics>
</math>


 sends a service request to the server. If the server load is normal, the client's request is serviced as usual; if the server is overloaded, then it proceeds to the <em>initial puzzle generation</em> step.</li>
</ul>
<ul>
<li><strong>Initial puzzle generation</strong>: the server replies to the client 

<math display="inline" id="Guided_tour_puzzle_protocol:9">
 <semantics>
  <mi>L</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>L</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   L
  </annotation>
 </semantics>
</math>

 with a puzzle message that informs the client to complete a guided tour. The puzzle message contains the length of the tour 

<math display="inline" id="Guided_tour_puzzle_protocol:10">
 <semantics>
  <msub>
   <mi>h</mi>
   <mn>0</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>h</ci>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   h_{0}
  </annotation>
 </semantics>
</math>

 and a hash value 

<math display="inline" id="Guided_tour_puzzle_protocol:11">
 <semantics>
  <msub>
   <mi>h</mi>
   <mn>0</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>h</ci>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   h_{0}
  </annotation>
 </semantics>
</math>

. The server computes 

<math display="inline" id="Guided_tour_puzzle_protocol:12">
 <semantics>
  <mrow>
   <msub>
    <mi>h</mi>
    <mn>0</mn>
   </msub>
   <mo>=</mo>
   <mrow>
    <mi>h</mi>
    <mi>a</mi>
    <mi>s</mi>
    <mi>h</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mpadded width="+2.8pt">
       <msub>
        <mi>A</mi>
        <mi>x</mi>
       </msub>
      </mpadded>
      <mrow>
       <mo stretchy="false">|</mo>
       <mrow>
        <mrow>
         <mo rspace="5.3pt" stretchy="false">|</mo>
         <mpadded width="+2.8pt">
          <mi>L</mi>
         </mpadded>
         <mo stretchy="false">|</mo>
        </mrow>
        <mrow>
         <mo rspace="5.3pt" stretchy="false">|</mo>
         <mrow>
          <mi>t</mi>
          <mpadded width="+2.8pt">
           <mi>s</mi>
          </mpadded>
         </mrow>
         <mo stretchy="false">|</mo>
        </mrow>
       </mrow>
       <mo rspace="5.3pt" stretchy="false">|</mo>
      </mrow>
      <msub>
       <mi>K</mi>
       <mi>s</mi>
      </msub>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>h</ci>
     <cn type="integer">0</cn>
    </apply>
    <apply>
     <times></times>
     <ci>h</ci>
     <ci>a</ci>
     <ci>s</ci>
     <ci>h</ci>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>A</ci>
       <ci>x</ci>
      </apply>
      <apply>
       <abs></abs>
       <apply>
        <times></times>
        <apply>
         <abs></abs>
         <ci>L</ci>
        </apply>
        <apply>
         <abs></abs>
         <apply>
          <times></times>
          <ci>t</ci>
          <ci>s</ci>
         </apply>
        </apply>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>K</ci>
       <ci>s</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   h_{0}=hash(A_{x}\;||\;L\;||\;ts\;||\;K_{s})
  </annotation>
 </semantics>
</math>

 using the following formula:</li>
</ul>
<dl>
<dd><dl>
<dd>

<math display="inline" id="Guided_tour_puzzle_protocol:13">
 <semantics>
  <mrow>
   <mo stretchy="false">|</mo>
   <mo stretchy="false">|</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <ci>normal-|</ci>
    <ci>normal-|</ci>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   ||
  </annotation>
 </semantics>
</math>



</dd>
</dl>
</dd>
<dd>where, 

<math display="inline" id="Guided_tour_puzzle_protocol:14">
 <semantics>
  <msub>
   <mi>A</mi>
   <mi>x</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>A</ci>
    <ci>x</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A_{x}
  </annotation>
 </semantics>
</math>

 means concatenation, 

<math display="inline" id="Guided_tour_puzzle_protocol:15">
 <semantics>
  <mi>x</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>x</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x
  </annotation>
 </semantics>
</math>

 is the address (or any unique value) of the client 

<math display="inline" id="Guided_tour_puzzle_protocol:16">
 <semantics>
  <mrow>
   <mi>t</mi>
   <mi>s</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>t</ci>
    <ci>s</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   ts
  </annotation>
 </semantics>
</math>

, 

<math display="inline" id="Guided_tour_puzzle_protocol:17">
 <semantics>
  <mrow>
   <mi>h</mi>
   <mi>a</mi>
   <mi>s</mi>
   <mi>h</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>h</ci>
    <ci>a</ci>
    <ci>s</ci>
    <ci>h</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   hash
  </annotation>
 </semantics>
</math>

 is a coarse timestamp, and 

<math display="inline" id="Guided_tour_puzzle_protocol:18">
 <semantics>
  <mi>l</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>l</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   l
  </annotation>
 </semantics>
</math>


 is a cryptographic hash function such as <a class="uri" href="SHA-1" title="wikilink">SHA-1</a>.
</dd>
</dl>
<ul>
<li><strong>Puzzle solving</strong>: A client computes the index of the tour guide at the 

<math display="inline" id="Guided_tour_puzzle_protocol:19">
 <semantics>
  <mrow>
   <msub>
    <mi>S</mi>
    <mi>l</mi>
   </msub>
   <mo>=</mo>
   <mrow>
    <mo stretchy="false">(</mo>
    <mrow>
     <mpadded width="+2.8pt">
      <msub>
       <mi>h</mi>
       <mrow>
        <mi>l</mi>
        <mo>-</mo>
        <mn>1</mn>
       </mrow>
      </msub>
     </mpadded>
     <mi>m</mi>
     <mi>o</mi>
     <mpadded width="+2.8pt">
      <mi>d</mi>
     </mpadded>
     <mi>N</mi>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>S</ci>
     <ci>l</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>h</ci>
      <apply>
       <minus></minus>
       <ci>l</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <ci>m</ci>
     <ci>o</ci>
     <ci>d</ci>
     <ci>N</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   S_{l}=(h_{l-1}\;mod\;N)
  </annotation>
 </semantics>
</math>

-th stop of its tour using the following formula:</li>
</ul>
<dl>
<dd><dl>
<dd>

<math display="inline" id="Guided_tour_puzzle_protocol:20">
 <semantics>
  <mrow>
   <mn>0</mn>
   <mo><</mo>
   <mi>l</mi>
   <mo>≤</mo>
   <mi>L</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <lt></lt>
     <cn type="integer">0</cn>
     <ci>l</ci>
    </apply>
    <apply>
     <leq></leq>
     <share href="#.cmml">
     </share>
     <ci>L</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   0<l\leq L
  </annotation>
 </semantics>
</math>


</dd>
</dl>
</dd>
<dd>where, 

<math display="inline" id="Guided_tour_puzzle_protocol:21">
 <semantics>
  <mi>x</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>x</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x
  </annotation>
 </semantics>
</math>

. When contacted by a client 

<math display="inline" id="Guided_tour_puzzle_protocol:22">
 <semantics>
  <msub>
   <mi>G</mi>
   <mi>j</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>G</ci>
    <ci>j</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   G_{j}
  </annotation>
 </semantics>
</math>

, a tour guide 

<math display="inline" id="Guided_tour_puzzle_protocol:23">
 <semantics>
  <msub>
   <mi>h</mi>
   <mi>l</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>h</ci>
    <ci>l</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   h_{l}
  </annotation>
 </semantics>
</math>


 computes a hash value 

<math display="inline" id="Guided_tour_puzzle_protocol:24">
 <semantics>
  <mrow>
   <mn>0</mn>
   <mo><</mo>
   <mi>l</mi>
   <mo>≤</mo>
   <mi>L</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <lt></lt>
     <cn type="integer">0</cn>
     <ci>l</ci>
    </apply>
    <apply>
     <leq></leq>
     <share href="#.cmml">
     </share>
     <ci>L</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   0<l\leq L
  </annotation>
 </semantics>
</math>

 (

<math display="block" id="Guided_tour_puzzle_protocol:25">
 <semantics>
  <mrow>
   <msub>
    <mi>h</mi>
    <mi>l</mi>
   </msub>
   <mo>=</mo>
   <mrow>
    <mi>h</mi>
    <mi>a</mi>
    <mi>s</mi>
    <mi>h</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mpadded width="+2.8pt">
       <msub>
        <mi>h</mi>
        <mrow>
         <mi>l</mi>
         <mo>-</mo>
         <mn>1</mn>
        </mrow>
       </msub>
      </mpadded>
      <mrow>
       <mo stretchy="false">|</mo>
       <mrow>
        <mrow>
         <mo rspace="5.3pt" stretchy="false">|</mo>
         <mpadded width="+2.8pt">
          <mi>l</mi>
         </mpadded>
         <mo stretchy="false">|</mo>
        </mrow>
        <mrow>
         <mo rspace="5.3pt" stretchy="false">|</mo>
         <mpadded width="+2.8pt">
          <mi>L</mi>
         </mpadded>
         <mo stretchy="false">|</mo>
        </mrow>
        <mrow>
         <mo rspace="5.3pt" stretchy="false">|</mo>
         <mpadded width="+2.8pt">
          <msub>
           <mi>A</mi>
           <mi>x</mi>
          </msub>
         </mpadded>
         <mo stretchy="false">|</mo>
        </mrow>
        <mrow>
         <mo rspace="5.3pt" stretchy="false">|</mo>
         <mrow>
          <mi>t</mi>
          <mpadded width="+2.8pt">
           <mi>s</mi>
          </mpadded>
         </mrow>
         <mo stretchy="false">|</mo>
        </mrow>
       </mrow>
       <mo rspace="5.3pt" stretchy="false">|</mo>
      </mrow>
      <msub>
       <mi>k</mi>
       <mrow>
        <mi>j</mi>
        <mi>s</mi>
       </mrow>
      </msub>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>h</ci>
     <ci>l</ci>
    </apply>
    <apply>
     <times></times>
     <ci>h</ci>
     <ci>a</ci>
     <ci>s</ci>
     <ci>h</ci>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>h</ci>
       <apply>
        <minus></minus>
        <ci>l</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <apply>
       <abs></abs>
       <apply>
        <times></times>
        <apply>
         <abs></abs>
         <ci>l</ci>
        </apply>
        <apply>
         <abs></abs>
         <ci>L</ci>
        </apply>
        <apply>
         <abs></abs>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>A</ci>
          <ci>x</ci>
         </apply>
        </apply>
        <apply>
         <abs></abs>
         <apply>
          <times></times>
          <ci>t</ci>
          <ci>s</ci>
         </apply>
        </apply>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>k</ci>
       <apply>
        <times></times>
        <ci>j</ci>
        <ci>s</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   h_{l}=hash(h_{l-1}\;||\;l\;||\;L\;||\;A_{x}\;||\;ts\;||\;k_{js})
  </annotation>
 </semantics>
</math>

) using the formula:

<p>

<math display="inline" id="Guided_tour_puzzle_protocol:26">
 <semantics>
  <mi>l</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>l</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   l
  </annotation>
 </semantics>
</math>

</p>
</dd>
<dd>where, 

<math display="inline" id="Guided_tour_puzzle_protocol:27">
 <semantics>
  <mi>l</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>l</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   l
  </annotation>
 </semantics>
</math>

 means the 

<math display="inline" id="Guided_tour_puzzle_protocol:28">
 <semantics>
  <msub>
   <mi>k</mi>
   <mrow>
    <mi>j</mi>
    <mi>s</mi>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>k</ci>
    <apply>
     <times></times>
     <ci>j</ci>
     <ci>s</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   k_{js}
  </annotation>
 </semantics>
</math>


-th stop of the client's tour, 

<math display="inline" id="Guided_tour_puzzle_protocol:29">
 <semantics>
  <msub>
   <mi>G</mi>
   <mi>j</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>G</ci>
    <ci>j</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   G_{j}
  </annotation>
 </semantics>
</math>

 is the shared key between the tour guide 

<math display="inline" id="Guided_tour_puzzle_protocol:30">
 <semantics>
  <mi>x</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>x</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x
  </annotation>
 </semantics>
</math>

 and the server. After client 

<math display="inline" id="Guided_tour_puzzle_protocol:31">
 <semantics>
  <msub>
   <mi>S</mi>
   <mn>1</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>S</ci>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   S_{1}
  </annotation>
 </semantics>
</math>

 receives the server's reply message, it starts a guided tour by computing the index 

<math display="inline" id="Guided_tour_puzzle_protocol:32">
 <semantics>
  <msub>
   <mi>h</mi>
   <mn>0</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>h</ci>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   h_{0}
  </annotation>
 </semantics>
</math>

 of the first tour guide using formula for $S_l$. The client then sends a set of values (

<math display="inline" id="Guided_tour_puzzle_protocol:33">
 <semantics>
  <mn>1</mn>
  <annotation-xml encoding="MathML-Content">
   <cn type="integer">1</cn>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   1
  </annotation>
 </semantics>
</math>


, 

<math display="inline" id="Guided_tour_puzzle_protocol:34">
 <semantics>
  <mi>L</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>L</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   L
  </annotation>
 </semantics>
</math>

, 

<math display="inline" id="Guided_tour_puzzle_protocol:35">
 <semantics>
  <msub>
   <mi>G</mi>
   <msub>
    <mi>S</mi>
    <mn>1</mn>
   </msub>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>G</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>S</ci>
     <cn type="integer">1</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   G_{S_{1}}
  </annotation>
 </semantics>
</math>

) to the tour guide 

<math display="inline" id="Guided_tour_puzzle_protocol:36">
 <semantics>
  <msub>
   <mi>h</mi>
   <mn>1</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>h</ci>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   h_{1}
  </annotation>
 </semantics>
</math>

, where the second value denotes which stop of a tour the client is currently at. As a response, the client receives a hash value 

<math display="inline" id="Guided_tour_puzzle_protocol:37">
 <semantics>
  <msub>
   <mi>G</mi>
   <msub>
    <mi>S</mi>
    <mn>1</mn>
   </msub>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>G</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>S</ci>
     <cn type="integer">1</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   G_{S_{1}}
  </annotation>
 </semantics>
</math>

 from the tour guide 

<math display="inline" id="Guided_tour_puzzle_protocol:38">
 <semantics>
  <msub>
   <mi>h</mi>
   <mn>1</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>h</ci>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   h_{1}
  </annotation>
 </semantics>
</math>


, where 

<math display="inline" id="Guided_tour_puzzle_protocol:39">
 <semantics>
  <msub>
   <mi>h</mi>
   <mi>l</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>h</ci>
    <ci>l</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   h_{l}
  </annotation>
 </semantics>
</math>

 is computed using the formula for 

<math display="inline" id="Guided_tour_puzzle_protocol:40">
 <semantics>
  <mi>x</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>x</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x
  </annotation>
 </semantics>
</math>

. The client 

<math display="inline" id="Guided_tour_puzzle_protocol:41">
 <semantics>
  <mrow>
   <mi>L</mi>
   <mo>-</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <minus></minus>
    <ci>L</ci>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   L-1
  </annotation>
 </semantics>
</math>

 repeats this process 

<math display="inline" id="Guided_tour_puzzle_protocol:42">
 <semantics>
  <mrow>
   <msub>
    <mi>G</mi>
    <msub>
     <mi>S</mi>
     <mn>2</mn>
    </msub>
   </msub>
   <mo>,</mo>
   <msub>
    <mi>G</mi>
    <msub>
     <mi>S</mi>
     <mn>3</mn>
    </msub>
   </msub>
   <mo>,</mo>
   <mi mathvariant="normal">…</mi>
   <mo>,</mo>
   <msub>
    <mi>G</mi>
    <msub>
     <mi>S</mi>
     <mi>L</mi>
    </msub>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <list>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>G</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>S</ci>
      <cn type="integer">2</cn>
     </apply>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>G</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>S</ci>
      <cn type="integer">3</cn>
     </apply>
    </apply>
    <ci>normal-…</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>G</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>S</ci>
      <ci>L</ci>
     </apply>
    </apply>
   </list>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   G_{S_{2}},G_{S_{3}},...,G_{S_{L}}
  </annotation>
 </semantics>
</math>

 more times and contacts the tour guides 

<math display="inline" id="Guided_tour_puzzle_protocol:43">
 <semantics>
  <msub>
   <mi>G</mi>
   <msub>
    <mi>S</mi>
    <mi>L</mi>
   </msub>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>G</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>S</ci>
     <ci>L</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   G_{S_{L}}
  </annotation>
 </semantics>
</math>


. The reply message from the last-stop tour guide 

<math display="inline" id="Guided_tour_puzzle_protocol:44">
 <semantics>
  <msub>
   <mi>h</mi>
   <mi>L</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>h</ci>
    <ci>L</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   h_{L}
  </annotation>
 </semantics>
</math>

 contains the last hash value 

<math display="inline" id="Guided_tour_puzzle_protocol:45">
 <semantics>
  <mi>x</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>x</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x
  </annotation>
 </semantics>
</math>

, and the client 

<math display="inline" id="Guided_tour_puzzle_protocol:46">
 <semantics>
  <mrow>
   <msub>
    <mi>h</mi>
    <mn>0</mn>
   </msub>
   <mo rspace="5.3pt">,</mo>
   <msub>
    <mi>h</mi>
    <mi>L</mi>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <list>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>h</ci>
     <cn type="integer">0</cn>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>h</ci>
     <ci>L</ci>
    </apply>
   </list>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   h_{0},\;h_{L}
  </annotation>
 </semantics>
</math>

 sends (

<math display="inline" id="Guided_tour_puzzle_protocol:47">
 <semantics>
  <mi>x</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>x</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x
  </annotation>
 </semantics>
</math>

) to the server as the puzzle answer.
</dd>
</dl>
<ul>
<li><strong>Puzzle verification</strong>: when the server receives a request from client 

<math display="inline" id="Guided_tour_puzzle_protocol:48">
 <semantics>
  <msubsup>
   <mi>h</mi>
   <mn>0</mn>
   <mo>′</mo>
  </msubsup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>h</ci>
     <ci>normal-′</ci>
    </apply>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   h^{\prime}_{0}
  </annotation>
 </semantics>
</math>


 with a puzzle answer (

<math display="inline" id="Guided_tour_puzzle_protocol:49">
 <semantics>
  <msubsup>
   <mi>h</mi>
   <mi>L</mi>
   <mo>′</mo>
  </msubsup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>h</ci>
     <ci>normal-′</ci>
    </apply>
    <ci>L</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   h^{\prime}_{L}
  </annotation>
 </semantics>
</math>

, 

<math display="inline" id="Guided_tour_puzzle_protocol:50">
 <semantics>
  <msubsup>
   <mi>h</mi>
   <mn>0</mn>
   <mo>′</mo>
  </msubsup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>h</ci>
     <ci>normal-′</ci>
    </apply>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   h^{\prime}_{0}
  </annotation>
 </semantics>
</math>

) attached, it first checks to see if 

<math display="inline" id="Guided_tour_puzzle_protocol:51">
 <semantics>
  <msub>
   <mi>h</mi>
   <mn>0</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>h</ci>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   h_{0}
  </annotation>
 </semantics>
</math>

 is equal to the 

<math display="inline" id="Guided_tour_puzzle_protocol:52">
 <semantics>
  <msub>
   <mi>h</mi>
   <mn>0</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>h</ci>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   h_{0}
  </annotation>
 </semantics>
</math>

 it computed using the formula for 

<math display="inline" id="Guided_tour_puzzle_protocol:53">
 <semantics>
  <msub>
   <mi>h</mi>
   <mi>L</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>h</ci>
    <ci>L</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   h_{L}
  </annotation>
 </semantics>
</math>


. If so, the server computes 

<math display="inline" id="Guided_tour_puzzle_protocol:54">
 <semantics>
  <msub>
   <mi>h</mi>
   <mi>l</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>h</ci>
    <ci>l</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   h_{l}
  </annotation>
 </semantics>
</math>

 by repeatedly using the formula for 

<math display="inline" id="Guided_tour_puzzle_protocol:55">
 <semantics>
  <msubsup>
   <mi>h</mi>
   <mi>L</mi>
   <mo>′</mo>
  </msubsup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>h</ci>
     <ci>normal-′</ci>
    </apply>
    <ci>L</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   h^{\prime}_{L}
  </annotation>
 </semantics>
</math>

, and verifies that 

<math display="inline" id="Guided_tour_puzzle_protocol:56">
 <semantics>
  <msub>
   <mi>h</mi>
   <mi>L</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>h</ci>
    <ci>L</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   h_{L}
  </annotation>
 </semantics>
</math>

 is equal to 

<math display="inline" id="Guided_tour_puzzle_protocol:57">
 <semantics>
  <mrow>
   <msub>
    <mi>k</mi>
    <mrow>
     <mn>1</mn>
     <mi>s</mi>
    </mrow>
   </msub>
   <mo>,</mo>
   <msub>
    <mi>k</mi>
    <mrow>
     <mn>2</mn>
     <mi>s</mi>
    </mrow>
   </msub>
   <mo>,</mo>
   <mi mathvariant="normal">…</mi>
   <mo>,</mo>
   <msub>
    <mi>k</mi>
    <mrow>
     <mi>N</mi>
     <mi>s</mi>
    </mrow>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <list>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>k</ci>
     <apply>
      <times></times>
      <cn type="integer">1</cn>
      <ci>s</ci>
     </apply>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>k</ci>
     <apply>
      <times></times>
      <cn type="integer">2</cn>
      <ci>s</ci>
     </apply>
    </apply>
    <ci>normal-…</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>k</ci>
     <apply>
      <times></times>
      <ci>N</ci>
      <ci>s</ci>
     </apply>
    </apply>
   </list>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   k_{1s},k_{2s},\dots,k_{Ns}
  </annotation>
 </semantics>
</math>

. If both hash values are valid, the server allocates resources to process the client's request. Since the server knows the shared keys 

<math display="inline" id="Guided_tour_puzzle_protocol:58">
 <semantics>
  <mrow>
   <msub>
    <mi>h</mi>
    <mn>1</mn>
   </msub>
   <mo>,</mo>
   <msub>
    <mi>h</mi>
    <mn>2</mn>
   </msub>
   <mo>,</mo>
   <mi mathvariant="normal">…</mi>
   <mo>,</mo>
   <msub>
    <mi>h</mi>
    <mi>L</mi>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <list>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>h</ci>
     <cn type="integer">1</cn>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>h</ci>
     <cn type="integer">2</cn>
    </apply>
    <ci>normal-…</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>h</ci>
     <ci>L</ci>
    </apply>
   </list>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   h_{1},h_{2},...,h_{L}
  </annotation>
 </semantics>
</math>


, it can compute the chain of hashes <span class="LaTeX">$h_1, h_2, ..., h_L$</span> without contacting any tour guide. A loose time synchronization between the server and tour guides is required in order to compute the same hash value at the server and tour guides.</li>
</ul>
<h2 id="comparison-to-other-puzzle-protocols">Comparison to other puzzle protocols</h2>

<p>CPU-bound computational puzzle protocols, such as the <a href="Client_Puzzle_Protocol" title="wikilink">Client Puzzle Protocol</a>, can mitigate the effect of denial of service attack, because the more an attacker wants to overwhelm the server, the more puzzles it has to compute, and the more computational resources of its own it needs to expend. However, due to the variation in the computational powers of clients, clients with strong computational power can solve puzzles at much higher rate than the destitute clients, and can unfairly take up most of the server resources.<a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a><a class="footnoteRef" href="#fn3" id="fnref3"><sup>3</sup></a><a class="footnoteRef" href="#fn4" id="fnref4"><sup>4</sup></a></p>

<p>Another crucial shortcoming of computational puzzle protocols is that all clients, including all legitimate clients, are required to perform such CPU-intensive computations that do not contribute to any meaningful service or application.</p>

<p>Guided tour puzzle protocol enforces delay on the clients through <a href="End-to-end_delay" title="wikilink">round trip delays</a>, so that clients' requests arrive at a rate that is sustainable by the server. The advantage of using round-trip delays, as opposed to hard computational problems, is that the round trip delay of a small packet is determined mostly by the <a href="processing_delay" title="wikilink">processing delays</a>, <a href="queuing_delay" title="wikilink">queuing delays</a>, and <a href="propagation_delay" title="wikilink">propagation delays</a> at the intermediate <a href="router_(computing)" title="wikilink">routers</a>, therefore is beyond the control of end hosts (clients). As such, even an attacker with abundant computational resources cannot unfairly take advantage over poorly provisioned legitimate clients.</p>

<p>Furthermore, in guided tour puzzle protocol, the computation required for the client is trivial. Since the length of a guided tour is usually a small number in the order of tens or lower, the bandwidth overhead for completing a guided tour is also trivial. As a result, clients are not burdened with heavy computations that is usually required by CPU-bound or memory bound puzzle protocols.</p>
<h2 id="see-also">See also</h2>
<ul>
<li><a href="Proof-of-work_system" title="wikilink">Proof-of-work system</a></li>
<li><a href="Client_Puzzle_Protocol" title="wikilink">Client Puzzle Protocol</a></li>
<li><a class="uri" href="CAPTCHA" title="wikilink">CAPTCHA</a></li>
</ul>
<h2 id="references">References</h2>
<references>
</references>
<h2 id="external-links">External links</h2>
<ul>
<li>[<a class="uri" href="http://www.acsac.org/2009/openconf/modules/request.php?module=oc_program&amp;action">http://www.acsac.org/2009/openconf/modules/request.php?module=oc_program&amp;action;</a>;=summary.php&amp;id;=195 Program of Annual Computer Security Applications Conference 2009]</li>
</ul>

<p>"</p>

<p><a href="Category:Computer_network_security" title="wikilink">Category:Computer network security</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1">Mehmud Abliz and Taieb Znati. A Guided Tour Puzzle for Denial of Service Prevention. In <em>Proceedings of the Annual Computer Security Applications Conference (ACSAC) 2009</em>, pages 279-288, Honolulu, HI, Dec 2009.<a href="#fnref1">↩</a></li>
<li id="fn2"></li>
<li id="fn3">Martin Abadi, Mike Burrows, Mark Manasse and Ted Wobber. Moderately Hard, Memory-bound Functions. In <em>Proceedings of NDSS 2003</em>, pages 25-39, 2003.<a href="#fnref3">↩</a></li>
<li id="fn4">Cynthia Dwork, Andrew Goldberg, and Moni Naor. On Memory-Bound Functions for Fighting Spam. In <em>Proceedings of CRYPTO 2003</em>, pages 426-444, 2003.<a href="#fnref4">↩</a></li>
</ol>
</section>
</body>
</html>

<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="1804">Perturbation theory (quantum mechanics)</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Perturbation theory (quantum mechanics)</h1>
<hr/>

<p>In <a href="quantum_mechanics" title="wikilink">quantum mechanics</a>, <strong>perturbation theory</strong> is a set of approximation schemes directly related to mathematical <a href="perturbation_theory" title="wikilink">perturbation</a> for describing a complicated quantum system in terms of a simpler one. The idea is to start with a simple system for which a mathematical solution is known, and add an additional "perturbing" <a href="Hamiltonian_(quantum_mechanics)" title="wikilink">Hamiltonian</a> representing a weak disturbance to the system. If the disturbance is not too large, the various physical quantities associated with the perturbed system (e.g. its <a class="uri" href="energy" title="wikilink">energy</a> levels and <a href="quantum_state" title="wikilink">eigenstates</a>) can be expressed as "corrections" to those of the simple system. These corrections, being small compared to the size of the quantities themselves, can be calculated using approximate methods such as <a href="asymptotic_series" title="wikilink">asymptotic series</a>. The complicated system can therefore be studied based on knowledge of the simpler one.</p>
<h2 id="applications-of-perturbation-theory">Applications of perturbation theory</h2>

<p>Perturbation theory is an important tool for describing real quantum systems, as it turns out to be very difficult to find exact solutions to the <a href="Schrödinger_equation" title="wikilink">Schrödinger equation</a> for <a href="Hamiltonian_(quantum_mechanics)" title="wikilink">Hamiltonians</a> of even moderate complexity. The Hamiltonians to which we know exact solutions, such as the <a href="hydrogen_atom" title="wikilink">hydrogen atom</a>, the <a href="quantum_harmonic_oscillator" title="wikilink">quantum harmonic oscillator</a> and the <a href="particle_in_a_box" title="wikilink">particle in a box</a>, are too idealized to adequately describe most systems. Using perturbation theory, we can use the known solutions of these simple Hamiltonians to generate solutions for a range of more complicated systems.</p>

<p>For example, by adding a perturbative <a href="electric_potential" title="wikilink">electric potential</a> to the quantum mechanical model of the hydrogen atom, we can calculate the tiny shifts in the <a href="spectral_line" title="wikilink">spectral lines</a> of hydrogen caused by the presence of an <a href="electric_field" title="wikilink">electric field</a> (the <a href="Stark_effect" title="wikilink">Stark effect</a>). This is only approximate because the sum of a <a href="Coulomb_potential" title="wikilink">Coulomb potential</a> with a linear potential is unstable (has no true bound states) although the <a href="tunneling_time" title="wikilink">tunneling time</a> (<a href="decay_rate" title="wikilink">decay rate</a>) is very long. This instability shows up as a broadening of the energy spectrum lines, which perturbation theory fails to reproduce entirely.</p>

<p>The expressions produced by perturbation theory are not exact, but they can lead to accurate results as long as the expansion parameter, say 

<math display="inline" id="Perturbation_theory_(quantum_mechanics):0">
 <semantics>
  <mi>α</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>α</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   α
  </annotation>
 </semantics>
</math>

, is very small. Typically, the results are expressed in terms of finite <a href="power_series" title="wikilink">power series</a> in 

<math display="inline" id="Perturbation_theory_(quantum_mechanics):1">
 <semantics>
  <mi>α</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>α</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   α
  </annotation>
 </semantics>
</math>

 that seem to converge to the exact values when summed to higher order. After a certain order 

<math display="inline" id="Perturbation_theory_(quantum_mechanics):2">
 <semantics>
  <mrow>
   <mrow>
    <mpadded width="+3.3pt">
     <mi>n</mi>
    </mpadded>
    <mn>1</mn>
   </mrow>
   <mo>/</mo>
   <mi>α</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <divide></divide>
    <apply>
     <times></times>
     <ci>n</ci>
     <cn type="integer">1</cn>
    </apply>
    <ci>α</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n~{}1/α
  </annotation>
 </semantics>
</math>

 however, the results become increasingly worse since the series are usually <a href="divergent_series" title="wikilink">divergent</a> (being <a href="asymptotic_series" title="wikilink">asymptotic series</a>). There exist ways to convert them into convergent series, which can be evaluated for large-expansion parameters, most efficiently by <a href="Variational_method_(quantum_mechanics)" title="wikilink">Variational method</a>.</p>

<p>In the theory of <a href="quantum_electrodynamics" title="wikilink">quantum electrodynamics</a> (QED), in which the <a class="uri" href="electron" title="wikilink">electron</a>–<a class="uri" href="photon" title="wikilink">photon</a> interaction is treated perturbatively, the calculation of the electron's <a href="magnetic_moment" title="wikilink">magnetic moment</a> has been found to agree with experiment to eleven decimal places.<a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a> In QED and other <a href="quantum_field_theory" title="wikilink">quantum field theories</a>, special calculation techniques known as <a href="Feynman_diagram" title="wikilink">Feynman diagrams</a> are used to systematically sum the power series terms.</p>

<p>Under some circumstances, perturbation theory is an invalid approach to take. This happens when the system we wish to describe cannot be described by a small perturbation imposed on some simple system. In <a href="quantum_chromodynamics" title="wikilink">quantum chromodynamics</a>, for instance, the interaction of <a href="quark" title="wikilink">quarks</a> with the <a class="uri" href="gluon" title="wikilink">gluon</a> field cannot be treated perturbatively at low energies because the <a href="coupling_constant" title="wikilink">coupling constant</a> (the expansion parameter) becomes too large. Perturbation theory also fails to describe states that are not generated <a href="Adiabatic_process_(quantum_mechanics)" title="wikilink">adiabatically</a> from the "free model", including <a href="bound_state" title="wikilink">bound states</a> and various collective phenomena such as <a href="soliton" title="wikilink">solitons</a>. Imagine, for example, that we have a system of free (i.e. non-interacting) particles, to which an attractive interaction is introduced. Depending on the form of the interaction, this may create an entirely new set of eigenstates corresponding to groups of particles bound to one another. An example of this phenomenon may be found in conventional <a class="uri" href="superconductivity" title="wikilink">superconductivity</a>, in which the <a class="uri" href="phonon" title="wikilink">phonon</a>-mediated attraction between <a href="conduction_electron" title="wikilink">conduction electrons</a> leads to the formation of correlated electron pairs known as <a href="Cooper_pair" title="wikilink">Cooper pairs</a>. When faced with such systems, one usually turns to other approximation schemes, such as the <a href="variational_method_(quantum_mechanics)" title="wikilink">variational method</a> and the <a href="WKB_approximation" title="wikilink">WKB approximation</a>. This is because there is no analogue of a <a href="bound_particle" title="wikilink">bound particle</a> in the unperturbed model and the energy of a soliton typically goes as the <em>inverse</em> of the expansion parameter. However, if we "integrate" over the solitonic phenomena, the nonperturbative corrections in this case will be tiny; of the order of exp(−1/

<math display="inline" id="Perturbation_theory_(quantum_mechanics):3">
 <semantics>
  <mi>g</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>g</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   g
  </annotation>
 </semantics>
</math>

) or exp(−1/

<math display="inline" id="Perturbation_theory_(quantum_mechanics):4">
 <semantics>
  <mi>g</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>g</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   g
  </annotation>
 </semantics>
</math>

<sup>2</sup>) in the perturbation parameter 

<math display="inline" id="Perturbation_theory_(quantum_mechanics):5">
 <semantics>
  <mi>g</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>g</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   g
  </annotation>
 </semantics>
</math>

. Perturbation theory can only detect solutions "close" to the unperturbed solution, even if there are other solutions for which the perturbative expansion is not valid.</p>

<p>The problem of non-perturbative systems has been somewhat alleviated by the advent of modern <a href="computer" title="wikilink">computers</a>. It has become practical to obtain numerical non-perturbative solutions for certain problems, using methods such as <a href="density_functional_theory" title="wikilink">density functional theory</a>. These advances have been of particular benefit to the field of <a href="quantum_chemistry" title="wikilink">quantum chemistry</a>. Computers have also been used to carry out perturbation theory calculations to extraordinarily high levels of precision, which has proven important in <a href="particle_physics" title="wikilink">particle physics</a> for generating theoretical results that can be compared with experiment.</p>
<h2 id="time-independent-perturbation-theory">Time-independent perturbation theory</h2>

<p>Time-independent perturbation theory is one of two categories of perturbation theory, the other being time-dependent perturbation (see next section). In time-independent perturbation theory the perturbation Hamiltonian is static (i.e., possesses no time dependence). Time-independent perturbation theory was presented by <a href="Erwin_Schrödinger" title="wikilink">Erwin Schrödinger</a> in a 1926 paper,<a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a> shortly after he produced his theories in wave mechanics. In this paper Schrödinger referred to earlier work of <a href="John_William_Strutt,_3rd_Baron_Rayleigh" title="wikilink">Lord Rayleigh</a>,<a class="footnoteRef" href="#fn3" id="fnref3"><sup>3</sup></a> who investigated harmonic vibrations of a string perturbed by small inhomogeneities. This is why this perturbation theory is often referred to as <strong>Rayleigh–Schrödinger perturbation theory</strong>.</p>
<h3 id="first-order-corrections">First order corrections</h3>

<p>We begin<a class="footnoteRef" href="#fn4" id="fnref4"><sup>4</sup></a> with an unperturbed Hamiltonian <mtpl></mtpl>, which is also assumed to have no time dependence. It has known energy levels and eigenstates, arising from the time-independent <a href="Schrödinger_equation" title="wikilink">Schrödinger equation</a>:</p>

<p>

<math display="block" id="Perturbation_theory_(quantum_mechanics):6">
 <semantics>
  <mrow>
   <msub>
    <mi>H</mi>
    <mn>0</mn>
   </msub>
   <mo>|</mo>
   <msup>
    <mi>n</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mn>0</mn>
     <mo stretchy="false">)</mo>
    </mrow>
   </msup>
   <mo>=</mo>
   <msubsup>
    <mi>E</mi>
    <mi>n</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mn>0</mn>
     <mo stretchy="false">)</mo>
    </mrow>
   </msubsup>
   <mo>|</mo>
   <msup>
    <mi>n</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mn>0</mn>
     <mo stretchy="false">)</mo>
    </mrow>
   </msup>
   <mo rspace="22.5pt">,</mo>
   <mi>n</mi>
   <mo>=</mo>
   <mn>1</mn>
   <mo>,</mo>
   <mn>2</mn>
   <mo>,</mo>
   <mn>3</mn>
   <mo>,</mo>
   <mi mathvariant="normal">⋯</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>H</ci>
     <cn type="integer">0</cn>
    </apply>
    <ci>normal-|</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>n</ci>
     <cn type="integer">0</cn>
    </apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>E</ci>
      <ci>n</ci>
     </apply>
     <cn type="integer">0</cn>
    </apply>
    <ci>normal-|</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>n</ci>
     <cn type="integer">0</cn>
    </apply>
    <ci>normal-,</ci>
    <csymbol cd="unknown">n</csymbol>
    <eq></eq>
    <cn type="integer">1</cn>
    <ci>normal-,</ci>
    <cn type="integer">2</cn>
    <ci>normal-,</ci>
    <cn type="integer">3</cn>
    <ci>normal-,</ci>
    <ci>normal-⋯</ci>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   H_{0}\left|n^{(0)}\right\rang=E_{n}^{(0)}\left|n^{(0)}\right\rang,\qquad n=1,2%
,3,\cdots
  </annotation>
 </semantics>
</math>

</p>

<p>For simplicity, we have assumed that the energies are discrete. The 

<math display="inline" id="Perturbation_theory_(quantum_mechanics):7">
 <semantics>
  <mrow>
   <mo stretchy="false">(</mo>
   <mn>0</mn>
   <mo stretchy="false">)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cn type="integer">0</cn>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (0)
  </annotation>
 </semantics>
</math>

 superscripts denote that these quantities are associated with the unperturbed system. Note the use of <a href="bra–ket_notation" title="wikilink">bra–ket notation</a>.</p>

<p>We now introduce a perturbation to the Hamiltonian. Let 

<math display="inline" id="Perturbation_theory_(quantum_mechanics):8">
 <semantics>
  <mi>V</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>V</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   V
  </annotation>
 </semantics>
</math>

 be a Hamiltonian representing a weak physical disturbance, such as a potential energy produced by an external field. (Thus, 

<math display="inline" id="Perturbation_theory_(quantum_mechanics):9">
 <semantics>
  <mi>V</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>V</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   V
  </annotation>
 </semantics>
</math>

 is formally a <a href="Hermitian_operator" title="wikilink">Hermitian operator</a>.) Let 

<math display="inline" id="Perturbation_theory_(quantum_mechanics):10">
 <semantics>
  <mi>λ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>λ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   λ
  </annotation>
 </semantics>
</math>

 be a dimensionless parameter that can take on values ranging continuously from 0 (no perturbation) to 1 (the full perturbation). The perturbed Hamiltonian is</p>

<p>

<math display="block" id="Perturbation_theory_(quantum_mechanics):11">
 <semantics>
  <mrow>
   <mi>H</mi>
   <mo>=</mo>
   <mrow>
    <msub>
     <mi>H</mi>
     <mn>0</mn>
    </msub>
    <mo>+</mo>
    <mrow>
     <mi>λ</mi>
     <mi>V</mi>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>H</ci>
    <apply>
     <plus></plus>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>H</ci>
      <cn type="integer">0</cn>
     </apply>
     <apply>
      <times></times>
      <ci>λ</ci>
      <ci>V</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   H=H_{0}+\lambda V
  </annotation>
 </semantics>
</math>

</p>

<p>The energy levels and eigenstates of the perturbed Hamiltonian are again given by the Schrödinger equation:</p>

<p>

<math display="block" id="Perturbation_theory_(quantum_mechanics):12">
 <semantics>
  <mrow>
   <mrow>
    <mo>(</mo>
    <msub>
     <mi>H</mi>
     <mn>0</mn>
    </msub>
    <mo>+</mo>
    <mi>λ</mi>
    <mi>V</mi>
    <mo>)</mo>
   </mrow>
   <mo stretchy="false">|</mo>
   <mi>n</mi>
   <merror class="ltx_ERROR undefined undefined">
    <mtext>\rang</mtext>
   </merror>
   <mo>=</mo>
   <msub>
    <mi>E</mi>
    <mi>n</mi>
   </msub>
   <mo stretchy="false">|</mo>
   <mi>n</mi>
   <merror class="ltx_ERROR undefined undefined">
    <mtext>\rang</mtext>
   </merror>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>H</ci>
      <cn type="integer">0</cn>
     </apply>
     <plus></plus>
     <csymbol cd="unknown">λ</csymbol>
     <csymbol cd="unknown">V</csymbol>
     <ci>normal-)</ci>
    </cerror>
    <ci>normal-|</ci>
    <csymbol cd="unknown">n</csymbol>
    <mtext>\rang</mtext>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>E</ci>
     <ci>n</ci>
    </apply>
    <ci>normal-|</ci>
    <csymbol cd="unknown">n</csymbol>
    <mtext>\rang</mtext>
    <ci>normal-.</ci>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \left(H_{0}+\lambda V\right)|n\rang=E_{n}|n\rang.
  </annotation>
 </semantics>
</math>

</p>

<p>Our goal is to express <mtpl></mtpl> and 

<math display="inline" id="Perturbation_theory_(quantum_mechanics):13">
 <semantics>
  <mrow>
   <mo stretchy="false">|</mo>
   <mi>n</mi>
   <merror class="ltx_ERROR undefined undefined">
    <mtext>\rang</mtext>
   </merror>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <ci>normal-|</ci>
    <csymbol cd="unknown">n</csymbol>
    <mtext>\rang</mtext>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   |n\rang
  </annotation>
 </semantics>
</math>

 in terms of the energy levels and eigenstates of the old Hamiltonian. If the perturbation is sufficiently weak, we can write them as <a href="power_series" title="wikilink">power series</a> in 

<math display="inline" id="Perturbation_theory_(quantum_mechanics):14">
 <semantics>
  <mi>λ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>λ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   λ
  </annotation>
 </semantics>
</math>

:</p>

<p>

<math display="inline" id="Perturbation_theory_(quantum_mechanics):15">
 <semantics>
  <msub>
   <mi>E</mi>
   <mi>n</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>E</ci>
    <ci>n</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle E_{n}
  </annotation>
 </semantics>
</math>


</p>

<p>where</p>

<p>

<math display="inline" id="Perturbation_theory_(quantum_mechanics):16">
 <semantics>
  <msubsup>
   <mi>E</mi>
   <mi>n</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>k</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </msubsup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>E</ci>
     <ci>n</ci>
    </apply>
    <ci>k</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle E_{n}^{(k)}
  </annotation>
 </semantics>
</math>


</p>

<p>When 

<math display="inline" id="Perturbation_theory_(quantum_mechanics):17">
 <semantics>
  <mrow>
   <mi>λ</mi>
   <mo>=</mo>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>λ</ci>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   λ=0
  </annotation>
 </semantics>
</math>

, these reduce to the unperturbed values, which are the first term in each series. Since the perturbation is weak, the energy levels and eigenstates should not deviate too much from their unperturbed values, and the terms should rapidly become smaller as we go to higher order.</p>

<p>Substituting the power series expansion into the Schrödinger equation, we obtain</p>

<p>

<math display="block" id="Perturbation_theory_(quantum_mechanics):18">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mo>(</mo>
     <mrow>
      <msub>
       <mi>H</mi>
       <mn>0</mn>
      </msub>
      <mo>+</mo>
      <mrow>
       <mi>λ</mi>
       <mi>V</mi>
      </mrow>
     </mrow>
     <mo>)</mo>
    </mrow>
    <mrow>
     <mo>(</mo>
     <mrow>
      <mrow>
       <mrow>
        <mo>|</mo>
        <mrow>
         <msup>
          <mi>n</mi>
          <mrow>
           <mo stretchy="false">(</mo>
           <mn>0</mn>
           <mo stretchy="false">)</mo>
          </mrow>
         </msup>
         <mo>+</mo>
         <mi>λ</mi>
        </mrow>
        <mo>|</mo>
       </mrow>
       <msup>
        <mi>n</mi>
        <mrow>
         <mo stretchy="false">(</mo>
         <mn>1</mn>
         <mo stretchy="false">)</mo>
        </mrow>
       </msup>
      </mrow>
      <mo>+</mo>
      <mi mathvariant="normal">⋯</mi>
     </mrow>
     <mo>)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mo>(</mo>
     <mrow>
      <msubsup>
       <mi>E</mi>
       <mi>n</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mn>0</mn>
        <mo stretchy="false">)</mo>
       </mrow>
      </msubsup>
      <mo>+</mo>
      <mrow>
       <mi>λ</mi>
       <msubsup>
        <mi>E</mi>
        <mi>n</mi>
        <mrow>
         <mo stretchy="false">(</mo>
         <mn>1</mn>
         <mo stretchy="false">)</mo>
        </mrow>
       </msubsup>
      </mrow>
      <mo>+</mo>
      <mrow>
       <msup>
        <mi>λ</mi>
        <mn>2</mn>
       </msup>
       <msubsup>
        <mi>E</mi>
        <mi>n</mi>
        <mrow>
         <mo stretchy="false">(</mo>
         <mn>2</mn>
         <mo stretchy="false">)</mo>
        </mrow>
       </msubsup>
      </mrow>
      <mo>+</mo>
      <mi mathvariant="normal">⋯</mi>
     </mrow>
     <mo>)</mo>
    </mrow>
    <mrow>
     <mo>(</mo>
     <mrow>
      <mrow>
       <mrow>
        <mo>|</mo>
        <mrow>
         <msup>
          <mi>n</mi>
          <mrow>
           <mo stretchy="false">(</mo>
           <mn>0</mn>
           <mo stretchy="false">)</mo>
          </mrow>
         </msup>
         <mo>+</mo>
         <mi>λ</mi>
        </mrow>
        <mo>|</mo>
       </mrow>
       <msup>
        <mi>n</mi>
        <mrow>
         <mo stretchy="false">(</mo>
         <mn>1</mn>
         <mo stretchy="false">)</mo>
        </mrow>
       </msup>
      </mrow>
      <mo>+</mo>
      <mi mathvariant="normal">⋯</mi>
     </mrow>
     <mo>)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <plus></plus>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>H</ci>
       <cn type="integer">0</cn>
      </apply>
      <apply>
       <times></times>
       <ci>λ</ci>
       <ci>V</ci>
      </apply>
     </apply>
     <apply>
      <plus></plus>
      <apply>
       <times></times>
       <apply>
        <abs></abs>
        <apply>
         <plus></plus>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>n</ci>
          <cn type="integer">0</cn>
         </apply>
         <ci>λ</ci>
        </apply>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>n</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <ci>normal-⋯</ci>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <plus></plus>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>E</ci>
        <ci>n</ci>
       </apply>
       <cn type="integer">0</cn>
      </apply>
      <apply>
       <times></times>
       <ci>λ</ci>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>E</ci>
         <ci>n</ci>
        </apply>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>λ</ci>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>E</ci>
         <ci>n</ci>
        </apply>
        <cn type="integer">2</cn>
       </apply>
      </apply>
      <ci>normal-⋯</ci>
     </apply>
     <apply>
      <plus></plus>
      <apply>
       <times></times>
       <apply>
        <abs></abs>
        <apply>
         <plus></plus>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>n</ci>
          <cn type="integer">0</cn>
         </apply>
         <ci>λ</ci>
        </apply>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>n</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <ci>normal-⋯</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \left(H_{0}+\lambda V\right)\left(\left|n^{(0)}\right\rang+\lambda\left|n^{(1)%
}\right\rang+\cdots\right)=\left(E_{n}^{(0)}+\lambda E_{n}^{(1)}+\lambda^{2}E_%
{n}^{(2)}+\cdots\right)\left(\left|n^{(0)}\right\rang+\lambda\left|n^{(1)}%
\right\rang+\cdots\right)
  </annotation>
 </semantics>
</math>

</p>

<p>Expanding this equation and comparing coefficients of each power of <em>λ</em> results in an infinite series of <a href="simultaneous_equation" title="wikilink">simultaneous equations</a>. The zeroth-order equation is simply the Schrödinger equation for the unperturbed system. The first-order equation is</p>

<p>

<math display="block" id="Perturbation_theory_(quantum_mechanics):19">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>H</mi>
     <mn>0</mn>
    </msub>
    <mrow>
     <mo>|</mo>
     <mrow>
      <msup>
       <mi>n</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mn>1</mn>
        <mo stretchy="false">)</mo>
       </mrow>
      </msup>
      <mo>+</mo>
      <mi>V</mi>
     </mrow>
     <mo>|</mo>
    </mrow>
    <msup>
     <mi>n</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mn>0</mn>
      <mo stretchy="false">)</mo>
     </mrow>
    </msup>
   </mrow>
   <mo>=</mo>
   <mrow>
    <msubsup>
     <mi>E</mi>
     <mi>n</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mn>0</mn>
      <mo stretchy="false">)</mo>
     </mrow>
    </msubsup>
    <mrow>
     <mo>|</mo>
     <mrow>
      <msup>
       <mi>n</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mn>1</mn>
        <mo stretchy="false">)</mo>
       </mrow>
      </msup>
      <mo>+</mo>
      <msubsup>
       <mi>E</mi>
       <mi>n</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mn>1</mn>
        <mo stretchy="false">)</mo>
       </mrow>
      </msubsup>
     </mrow>
     <mo>|</mo>
    </mrow>
    <msup>
     <mi>n</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mn>0</mn>
      <mo stretchy="false">)</mo>
     </mrow>
    </msup>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>H</ci>
      <cn type="integer">0</cn>
     </apply>
     <apply>
      <abs></abs>
      <apply>
       <plus></plus>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>n</ci>
        <cn type="integer">1</cn>
       </apply>
       <ci>V</ci>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>n</ci>
      <cn type="integer">0</cn>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>E</ci>
       <ci>n</ci>
      </apply>
      <cn type="integer">0</cn>
     </apply>
     <apply>
      <abs></abs>
      <apply>
       <plus></plus>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>n</ci>
        <cn type="integer">1</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>E</ci>
         <ci>n</ci>
        </apply>
        <cn type="integer">1</cn>
       </apply>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>n</ci>
      <cn type="integer">0</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   H_{0}\left|n^{(1)}\right\rang+V\left|n^{(0)}\right\rang=E_{n}^{(0)}\left|n^{(1%
)}\right\rang+E_{n}^{(1)}\left|n^{(0)}\right\rang
  </annotation>
 </semantics>
</math>

</p>

<p>Operating through by 

<math display="inline" id="Perturbation_theory_(quantum_mechanics):20">
 <semantics>
  <mrow>
   <merror class="ltx_ERROR undefined undefined">
    <mtext>\lang</mtext>
   </merror>
   <msup>
    <mi>n</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mn>0</mn>
     <mo stretchy="false">)</mo>
    </mrow>
   </msup>
   <mo stretchy="false">|</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <mtext>\lang</mtext>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>n</ci>
     <cn type="integer">0</cn>
    </apply>
    <ci>normal-|</ci>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \lang n^{(0)}|
  </annotation>
 </semantics>
</math>


. The first term on the left-hand side cancels with the first term on the right-hand side. (Recall, the unperturbed Hamiltonian is <a href="Hermitian_operator" title="wikilink">Hermitian</a>). This leads to the first-order energy shift:</p>

<p>

<math display="block" id="Perturbation_theory_(quantum_mechanics):21">
 <semantics>
  <mrow>
   <msubsup>
    <mi>E</mi>
    <mi>n</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mn>1</mn>
     <mo stretchy="false">)</mo>
    </mrow>
   </msubsup>
   <mo>=</mo>
   <mrow>
    <mo>⟨</mo>
    <msup>
     <mi>n</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mn>0</mn>
      <mo stretchy="false">)</mo>
     </mrow>
    </msup>
    <mo>|</mo>
    <mi>V</mi>
    <mo>|</mo>
    <msup>
     <mi>n</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mn>0</mn>
      <mo stretchy="false">)</mo>
     </mrow>
    </msup>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>E</ci>
      <ci>n</ci>
     </apply>
     <cn type="integer">1</cn>
    </apply>
    <eq></eq>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-⟨</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>n</ci>
      <cn type="integer">0</cn>
     </apply>
     <ci>normal-|</ci>
     <csymbol cd="unknown">V</csymbol>
     <ci>normal-|</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>n</ci>
      <cn type="integer">0</cn>
     </apply>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   E_{n}^{(1)}=\left\langle n^{(0)}\right|V\left|n^{(0)}\right\rang
  </annotation>
 </semantics>
</math>

</p>

<p>This is simply the <a href="Expectation_value_(quantum_mechanics)" title="wikilink">expectation value</a> of the perturbation Hamiltonian while the system is in the unperturbed state. This result can be interpreted in the following way: suppose the perturbation is applied, but we keep the system in the quantum state 

<math display="inline" id="Perturbation_theory_(quantum_mechanics):22">
 <semantics>
  <mrow>
   <mo stretchy="false">|</mo>
   <msup>
    <mi>n</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mn>0</mn>
     <mo stretchy="false">)</mo>
    </mrow>
   </msup>
   <merror class="ltx_ERROR undefined undefined">
    <mtext>\rang</mtext>
   </merror>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <ci>normal-|</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>n</ci>
     <cn type="integer">0</cn>
    </apply>
    <mtext>\rang</mtext>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   |n^{(0)}\rang
  </annotation>
 </semantics>
</math>

, which is a valid quantum state though no longer an energy eigenstate. The perturbation causes the average energy of this state to increase by 

<math display="inline" id="Perturbation_theory_(quantum_mechanics):23">
 <semantics>
  <mrow>
   <merror class="ltx_ERROR undefined undefined">
    <mtext>\lang</mtext>
   </merror>
   <msup>
    <mi>n</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mn>0</mn>
     <mo stretchy="false">)</mo>
    </mrow>
   </msup>
   <mrow>
    <mo stretchy="false">|</mo>
    <mi>V</mi>
    <mo stretchy="false">|</mo>
   </mrow>
   <msup>
    <mi>n</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mn>0</mn>
     <mo stretchy="false">)</mo>
    </mrow>
   </msup>
   <merror class="ltx_ERROR undefined undefined">
    <mtext>\rang</mtext>
   </merror>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <mtext>\lang</mtext>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>n</ci>
     <cn type="integer">0</cn>
    </apply>
    <apply>
     <abs></abs>
     <ci>V</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>n</ci>
     <cn type="integer">0</cn>
    </apply>
    <mtext>\rang</mtext>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \lang n^{(0)}|V|n^{(0)}\rang
  </annotation>
 </semantics>
</math>

. However, the true energy shift is slightly different, because the perturbed eigenstate is not exactly the same as <em>

<math display="inline" id="Perturbation_theory_(quantum_mechanics):24">
 <semantics>
  <mrow>
   <mo stretchy="false">|</mo>
   <msup>
    <mi>n</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mn>0</mn>
     <mo stretchy="false">)</mo>
    </mrow>
   </msup>
   <merror class="ltx_ERROR undefined undefined">
    <mtext>\rang</mtext>
   </merror>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <ci>normal-|</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>n</ci>
     <cn type="integer">0</cn>
    </apply>
    <mtext>\rang</mtext>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   |n^{(0)}\rang
  </annotation>
 </semantics>
</math>

</em>. These further shifts are given by the second and higher order corrections to the energy.</p>

<p>Before we compute the corrections to the energy eigenstate, we need to address the issue of normalization. We may suppose</p>

<p>

<math display="block" id="Perturbation_theory_(quantum_mechanics):25">
 <semantics>
  <mrow>
   <msup>
    <mi>n</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mn>0</mn>
     <mo stretchy="false">)</mo>
    </mrow>
   </msup>
   <mo>|</mo>
   <msup>
    <mi>n</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mn>0</mn>
     <mo stretchy="false">)</mo>
    </mrow>
   </msup>
   <mo>=</mo>
   <mn>1</mn>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>n</ci>
     <cn type="integer">0</cn>
    </apply>
    <ci>normal-|</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>n</ci>
     <cn type="integer">0</cn>
    </apply>
    <eq></eq>
    <cn type="integer">1</cn>
    <ci>normal-,</ci>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \left\lang n^{(0)}\right|\left.n^{(0)}\right\rang=1,
  </annotation>
 </semantics>
</math>

</p>

<p>but perturbation theory assumes we also have 

<math display="inline" id="Perturbation_theory_(quantum_mechanics):26">
 <semantics>
  <mrow>
   <merror class="ltx_ERROR undefined undefined">
    <mtext>\lang</mtext>
   </merror>
   <mi>n</mi>
   <mo stretchy="false">|</mo>
   <mi>n</mi>
   <merror class="ltx_ERROR undefined undefined">
    <mtext>\rang</mtext>
   </merror>
   <mo>=</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <mtext>\lang</mtext>
    <csymbol cd="unknown">n</csymbol>
    <ci>normal-|</ci>
    <csymbol cd="unknown">n</csymbol>
    <mtext>\rang</mtext>
    <eq></eq>
    <cn type="integer">1</cn>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \lang n|n\rang=1
  </annotation>
 </semantics>
</math>

. It follows that at first order in 

<math display="inline" id="Perturbation_theory_(quantum_mechanics):27">
 <semantics>
  <mi>λ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>λ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   λ
  </annotation>
 </semantics>
</math>

, we must have</p>

<p>

<math display="block" id="Perturbation_theory_(quantum_mechanics):28">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mo>(</mo>
     <mrow>
      <msup>
       <mi>n</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mn>0</mn>
        <mo stretchy="false">)</mo>
       </mrow>
      </msup>
      <mrow>
       <mo>|</mo>
       <mrow>
        <mo>+</mo>
        <mrow>
         <mi>λ</mi>
         <msup>
          <mi>n</mi>
          <mrow>
           <mo stretchy="false">(</mo>
           <mn>1</mn>
           <mo stretchy="false">)</mo>
          </mrow>
         </msup>
        </mrow>
       </mrow>
       <mo>|</mo>
      </mrow>
     </mrow>
     <mo>)</mo>
    </mrow>
    <mrow>
     <mo>(</mo>
     <mrow>
      <mrow>
       <mo>|</mo>
       <mrow>
        <msup>
         <mi>n</mi>
         <mrow>
          <mo stretchy="false">(</mo>
          <mn>0</mn>
          <mo stretchy="false">)</mo>
         </mrow>
        </msup>
        <mo>+</mo>
        <mi>λ</mi>
       </mrow>
       <mo>|</mo>
      </mrow>
      <msup>
       <mi>n</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mn>1</mn>
        <mo stretchy="false">)</mo>
       </mrow>
      </msup>
     </mrow>
     <mo>)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>n</ci>
       <cn type="integer">0</cn>
      </apply>
      <apply>
       <abs></abs>
       <apply>
        <plus></plus>
        <apply>
         <times></times>
         <ci>λ</ci>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>n</ci>
          <cn type="integer">1</cn>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <abs></abs>
       <apply>
        <plus></plus>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>n</ci>
         <cn type="integer">0</cn>
        </apply>
        <ci>λ</ci>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>n</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
    </apply>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \left(\left\lang n^{(0)}\right|+\lambda\left\lang n^{(1)}\right|\right)\left(%
\left|n^{(0)}\right\rang+\lambda\left|n^{(1)}\right\rang\right)=1
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Perturbation_theory_(quantum_mechanics):29">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <msup>
      <mi>n</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mn>0</mn>
       <mo stretchy="false">)</mo>
      </mrow>
     </msup>
     <mrow>
      <mo>|</mo>
      <mrow>
       <msup>
        <mi>n</mi>
        <mrow>
         <mo stretchy="false">(</mo>
         <mn>0</mn>
         <mo stretchy="false">)</mo>
        </mrow>
       </msup>
       <mo>+</mo>
       <mrow>
        <mi>λ</mi>
        <msup>
         <mi>n</mi>
         <mrow>
          <mo stretchy="false">(</mo>
          <mn>0</mn>
          <mo stretchy="false">)</mo>
         </mrow>
        </msup>
       </mrow>
      </mrow>
      <mo>|</mo>
     </mrow>
     <msup>
      <mi>n</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mn>1</mn>
       <mo stretchy="false">)</mo>
      </mrow>
     </msup>
    </mrow>
    <mo>+</mo>
    <mrow>
     <mi>λ</mi>
     <msup>
      <mi>n</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mn>1</mn>
       <mo stretchy="false">)</mo>
      </mrow>
     </msup>
     <mrow>
      <mo>|</mo>
      <mrow>
       <msup>
        <mi>n</mi>
        <mrow>
         <mo stretchy="false">(</mo>
         <mn>0</mn>
         <mo stretchy="false">)</mo>
        </mrow>
       </msup>
       <mo>+</mo>
       <mrow>
        <merror class="ltx_ERROR undefined undefined">
         <mtext>\cancel</mtext>
        </merror>
        <msup>
         <mi>λ</mi>
         <mn>2</mn>
        </msup>
        <msup>
         <mi>n</mi>
         <mrow>
          <mo stretchy="false">(</mo>
          <mn>1</mn>
          <mo stretchy="false">)</mo>
         </mrow>
        </msup>
       </mrow>
      </mrow>
      <mo>|</mo>
     </mrow>
     <msup>
      <mi>n</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mn>1</mn>
       <mo stretchy="false">)</mo>
      </mrow>
     </msup>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>n</ci>
       <cn type="integer">0</cn>
      </apply>
      <apply>
       <abs></abs>
       <apply>
        <plus></plus>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>n</ci>
         <cn type="integer">0</cn>
        </apply>
        <apply>
         <times></times>
         <ci>λ</ci>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>n</ci>
          <cn type="integer">0</cn>
         </apply>
        </apply>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>n</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <apply>
      <times></times>
      <ci>λ</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>n</ci>
       <cn type="integer">1</cn>
      </apply>
      <apply>
       <abs></abs>
       <apply>
        <plus></plus>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>n</ci>
         <cn type="integer">0</cn>
        </apply>
        <apply>
         <times></times>
         <mtext>\cancel</mtext>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>λ</ci>
          <cn type="integer">2</cn>
         </apply>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>n</ci>
          <cn type="integer">1</cn>
         </apply>
        </apply>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>n</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
    </apply>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \left\lang n^{(0)}\right|\left.n^{(0)}\right\rang+\lambda\left\lang n^{(0)}%
\right|\left.n^{(1)}\right\rang+\lambda\left\lang n^{(1)}\right|\left.n^{(0)}%
\right\rang+\cancel{\lambda^{2}\left\lang n^{(1)}\right|\left.n^{(1)}\right%
\rang}=1
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Perturbation_theory_(quantum_mechanics):30">
 <semantics>
  <mrow>
   <mrow>
    <msup>
     <mi>n</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mn>0</mn>
      <mo stretchy="false">)</mo>
     </mrow>
    </msup>
    <mrow>
     <mo>|</mo>
     <mrow>
      <msup>
       <mi>n</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mn>1</mn>
        <mo stretchy="false">)</mo>
       </mrow>
      </msup>
      <mo>+</mo>
      <msup>
       <mi>n</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mn>1</mn>
        <mo stretchy="false">)</mo>
       </mrow>
      </msup>
     </mrow>
     <mo>|</mo>
    </mrow>
    <msup>
     <mi>n</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mn>0</mn>
      <mo stretchy="false">)</mo>
     </mrow>
    </msup>
   </mrow>
   <mo>=</mo>
   <mn>0.</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>n</ci>
      <cn type="integer">0</cn>
     </apply>
     <apply>
      <abs></abs>
      <apply>
       <plus></plus>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>n</ci>
        <cn type="integer">1</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>n</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>n</ci>
      <cn type="integer">0</cn>
     </apply>
    </apply>
    <cn type="float">0.</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \left\lang n^{(0)}\right|\left.n^{(1)}\right\rang+\left\lang n^{(1)}\right|%
\left.n^{(0)}\right\rang=0.
  </annotation>
 </semantics>
</math>

</p>

<p>Since the overall phase is not determined in quantum mechanics, <a href="without_loss_of_generality" title="wikilink">without loss of generality</a>, we may assume 

<math display="inline" id="Perturbation_theory_(quantum_mechanics):31">
 <semantics>
  <mrow>
   <merror class="ltx_ERROR undefined undefined">
    <mtext>\lang</mtext>
   </merror>
   <msup>
    <mi>n</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mn>0</mn>
     <mo stretchy="false">)</mo>
    </mrow>
   </msup>
   <mo stretchy="false">|</mo>
   <mi>n</mi>
   <merror class="ltx_ERROR undefined undefined">
    <mtext>\rang</mtext>
   </merror>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <mtext>\lang</mtext>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>n</ci>
     <cn type="integer">0</cn>
    </apply>
    <ci>normal-|</ci>
    <csymbol cd="unknown">n</csymbol>
    <mtext>\rang</mtext>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \lang n^{(0)}|n\rang
  </annotation>
 </semantics>
</math>

 is purely real. Therefore,</p>

<p>

<math display="block" id="Perturbation_theory_(quantum_mechanics):32">
 <semantics>
  <mrow>
   <msup>
    <mi>n</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mn>0</mn>
     <mo stretchy="false">)</mo>
    </mrow>
   </msup>
   <mo>|</mo>
   <msup>
    <mi>n</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mn>1</mn>
     <mo stretchy="false">)</mo>
    </mrow>
   </msup>
   <mo>=</mo>
   <mo>-</mo>
   <msup>
    <mi>n</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mn>0</mn>
     <mo stretchy="false">)</mo>
    </mrow>
   </msup>
   <mo>|</mo>
   <msup>
    <mi>n</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mn>1</mn>
     <mo stretchy="false">)</mo>
    </mrow>
   </msup>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>n</ci>
     <cn type="integer">0</cn>
    </apply>
    <ci>normal-|</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>n</ci>
     <cn type="integer">1</cn>
    </apply>
    <eq></eq>
    <minus></minus>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>n</ci>
     <cn type="integer">0</cn>
    </apply>
    <ci>normal-|</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>n</ci>
     <cn type="integer">1</cn>
    </apply>
    <ci>normal-,</ci>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \left\lang n^{(0)}\right|\left.n^{(1)}\right\rang=-\left\lang n^{(0)}\right|%
\left.n^{(1)}\right\rang,
  </annotation>
 </semantics>
</math>

</p>

<p>and we deduce</p>

<p>

<math display="block" id="Perturbation_theory_(quantum_mechanics):33">
 <semantics>
  <mrow>
   <msup>
    <mi>n</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mn>0</mn>
     <mo stretchy="false">)</mo>
    </mrow>
   </msup>
   <mo>|</mo>
   <msup>
    <mi>n</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mn>1</mn>
     <mo stretchy="false">)</mo>
    </mrow>
   </msup>
   <mo>=</mo>
   <mn>0.</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>n</ci>
     <cn type="integer">0</cn>
    </apply>
    <ci>normal-|</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>n</ci>
     <cn type="integer">1</cn>
    </apply>
    <eq></eq>
    <cn type="float">0.</cn>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \left\lang n^{(0)}\right|\left.n^{(1)}\right\rang=0.
  </annotation>
 </semantics>
</math>

</p>

<p>To obtain the first-order correction to the energy eigenstate, we insert our expression for the first-order energy correction back into the result shown above of equating the first-order coefficients of 

<math display="inline" id="Perturbation_theory_(quantum_mechanics):34">
 <semantics>
  <mi>λ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>λ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   λ
  </annotation>
 </semantics>
</math>

. We then make use of the <a href="resolution_of_the_identity" title="wikilink">resolution of the identity</a>,</p>

<p>

<math display="inline" id="Perturbation_theory_(quantum_mechanics):35">
 <semantics>
  <mrow>
   <mi>V</mi>
   <mo>|</mo>
   <msup>
    <mi>n</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mn>0</mn>
     <mo stretchy="false">)</mo>
    </mrow>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">V</csymbol>
    <ci>normal-|</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>n</ci>
     <cn type="integer">0</cn>
    </apply>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle V\left|n^{(0)}\right\rang
  </annotation>
 </semantics>
</math>


</p>

<p>where the 

<math display="inline" id="Perturbation_theory_(quantum_mechanics):36">
 <semantics>
  <mrow>
   <mo fence="true" stretchy="false">|</mo>
   <msup>
    <mi>k</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mn>0</mn>
     <mo stretchy="false">)</mo>
    </mrow>
   </msup>
   <mo stretchy="false">⟩</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">ket</csymbol>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>k</ci>
     <cn type="integer">0</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   |k^{(0)}\rangle
  </annotation>
 </semantics>
</math>

 are in the <a href="orthogonal_complement" title="wikilink">orthogonal complement</a> of 

<math display="inline" id="Perturbation_theory_(quantum_mechanics):37">
 <semantics>
  <mrow>
   <mo fence="true" stretchy="false">|</mo>
   <msup>
    <mi>n</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mn>0</mn>
     <mo stretchy="false">)</mo>
    </mrow>
   </msup>
   <mo stretchy="false">⟩</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">ket</csymbol>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>n</ci>
     <cn type="integer">0</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   |n^{(0)}\rangle
  </annotation>
 </semantics>
</math>

. The result is</p>

<p>

<math display="block" id="Perturbation_theory_(quantum_mechanics):38">
 <semantics>
  <mrow>
   <mrow>
    <mo>(</mo>
    <msubsup>
     <mi>E</mi>
     <mi>n</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mn>0</mn>
      <mo stretchy="false">)</mo>
     </mrow>
    </msubsup>
    <mo>-</mo>
    <msub>
     <mi>H</mi>
     <mn>0</mn>
    </msub>
    <mo>)</mo>
   </mrow>
   <mo>|</mo>
   <msup>
    <mi>n</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mn>1</mn>
     <mo stretchy="false">)</mo>
    </mrow>
   </msup>
   <mo>=</mo>
   <munder>
    <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
    <mrow>
     <mi>k</mi>
     <mo>≠</mo>
     <mi>n</mi>
    </mrow>
   </munder>
   <mo>|</mo>
   <msup>
    <mi>k</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mn>0</mn>
     <mo stretchy="false">)</mo>
    </mrow>
   </msup>
   <mrow>
    <mo>⟨</mo>
    <msup>
     <mi>k</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mn>0</mn>
      <mo stretchy="false">)</mo>
     </mrow>
    </msup>
    <mo>|</mo>
    <mi>V</mi>
    <mo>|</mo>
    <msup>
     <mi>n</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mn>0</mn>
      <mo stretchy="false">)</mo>
     </mrow>
    </msup>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>E</ci>
       <ci>n</ci>
      </apply>
      <cn type="integer">0</cn>
     </apply>
     <minus></minus>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>H</ci>
      <cn type="integer">0</cn>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <ci>normal-|</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>n</ci>
     <cn type="integer">1</cn>
    </apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <sum></sum>
     <apply>
      <neq></neq>
      <ci>k</ci>
      <ci>n</ci>
     </apply>
    </apply>
    <ci>normal-|</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>k</ci>
     <cn type="integer">0</cn>
    </apply>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-⟨</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>k</ci>
      <cn type="integer">0</cn>
     </apply>
     <ci>normal-|</ci>
     <csymbol cd="unknown">V</csymbol>
     <ci>normal-|</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>n</ci>
      <cn type="integer">0</cn>
     </apply>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \left(E_{n}^{(0)}-H_{0}\right)\left|n^{(1)}\right\rang=\sum_{k\neq n}\left|k^{%
(0)}\right\rang\left\langle k^{(0)}\right|V\left|n^{(0)}\right\rang
  </annotation>
 </semantics>
</math>

</p>

<p>For the moment, suppose that the zeroth-order energy level is not <a href="Degenerate_energy_level" title="wikilink">degenerate</a>, i.e. there is no eigenstate of <mtpl></mtpl> in the orthogonal complement of 

<math display="inline" id="Perturbation_theory_(quantum_mechanics):39">
 <semantics>
  <mrow>
   <mo fence="true" stretchy="false">|</mo>
   <msup>
    <mi>n</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mn>0</mn>
     <mo stretchy="false">)</mo>
    </mrow>
   </msup>
   <mo stretchy="false">⟩</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">ket</csymbol>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>n</ci>
     <cn type="integer">0</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   |n^{(0)}\rangle
  </annotation>
 </semantics>
</math>

 with the energy 

<math display="inline" id="Perturbation_theory_(quantum_mechanics):40">
 <semantics>
  <msubsup>
   <mi>E</mi>
   <mi>n</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mn>0</mn>
    <mo stretchy="false">)</mo>
   </mrow>
  </msubsup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>E</ci>
     <ci>n</ci>
    </apply>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   E_{n}^{(0)}
  </annotation>
 </semantics>
</math>

. We multiply through by 

<math display="inline" id="Perturbation_theory_(quantum_mechanics):41">
 <semantics>
  <mrow>
   <merror class="ltx_ERROR undefined undefined">
    <mtext>\lang</mtext>
   </merror>
   <msup>
    <mi>k</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mn>0</mn>
     <mo stretchy="false">)</mo>
    </mrow>
   </msup>
   <mo stretchy="false">|</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <mtext>\lang</mtext>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>k</ci>
     <cn type="integer">0</cn>
    </apply>
    <ci>normal-|</ci>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \lang k^{(0)}|
  </annotation>
 </semantics>
</math>

, which gives</p>

<p>

<math display="block" id="Perturbation_theory_(quantum_mechanics):42">
 <semantics>
  <mrow>
   <mrow>
    <mo>(</mo>
    <msubsup>
     <mi>E</mi>
     <mi>n</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mn>0</mn>
      <mo stretchy="false">)</mo>
     </mrow>
    </msubsup>
    <mo>-</mo>
    <msubsup>
     <mi>E</mi>
     <mi>k</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mn>0</mn>
      <mo stretchy="false">)</mo>
     </mrow>
    </msubsup>
    <mo>)</mo>
   </mrow>
   <mrow>
    <mo>⟨</mo>
    <msup>
     <mi>k</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mn>0</mn>
      <mo stretchy="false">)</mo>
     </mrow>
    </msup>
    <mo>|</mo>
    <msup>
     <mi>n</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mn>1</mn>
      <mo stretchy="false">)</mo>
     </mrow>
    </msup>
    <mo>=</mo>
    <mrow>
     <mo>⟨</mo>
     <msup>
      <mi>k</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mn>0</mn>
       <mo stretchy="false">)</mo>
      </mrow>
     </msup>
     <mo>|</mo>
     <mi>V</mi>
     <mo>|</mo>
     <msup>
      <mi>n</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mn>0</mn>
       <mo stretchy="false">)</mo>
      </mrow>
     </msup>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>E</ci>
       <ci>n</ci>
      </apply>
      <cn type="integer">0</cn>
     </apply>
     <minus></minus>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>E</ci>
       <ci>k</ci>
      </apply>
      <cn type="integer">0</cn>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-⟨</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>k</ci>
      <cn type="integer">0</cn>
     </apply>
     <ci>normal-|</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>n</ci>
      <cn type="integer">1</cn>
     </apply>
     <eq></eq>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <ci>normal-⟨</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>k</ci>
       <cn type="integer">0</cn>
      </apply>
      <ci>normal-|</ci>
      <csymbol cd="unknown">V</csymbol>
      <ci>normal-|</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>n</ci>
       <cn type="integer">0</cn>
      </apply>
     </cerror>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \left(E_{n}^{(0)}-E_{k}^{(0)}\right)\left\langle k^{(0)}\right.\left|n^{(1)}%
\right\rang=\left\langle k^{(0)}\right|V\left|n^{(0)}\right\rang
  </annotation>
 </semantics>
</math>

</p>

<p>and hence the component of the first-order correction along 

<math display="inline" id="Perturbation_theory_(quantum_mechanics):43">
 <semantics>
  <mrow>
   <mo stretchy="false">|</mo>
   <msup>
    <mi>k</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mn>0</mn>
     <mo stretchy="false">)</mo>
    </mrow>
   </msup>
   <merror class="ltx_ERROR undefined undefined">
    <mtext>\rang</mtext>
   </merror>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <ci>normal-|</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>k</ci>
     <cn type="integer">0</cn>
    </apply>
    <mtext>\rang</mtext>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   |k^{(0)}\rang
  </annotation>
 </semantics>
</math>

 since by assumption 

<math display="inline" id="Perturbation_theory_(quantum_mechanics):44">
 <semantics>
  <mrow>
   <msubsup>
    <mi>E</mi>
    <mi>n</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mn>0</mn>
     <mo stretchy="false">)</mo>
    </mrow>
   </msubsup>
   <mo>≠</mo>
   <msubsup>
    <mi>E</mi>
    <mi>k</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mn>0</mn>
     <mo stretchy="false">)</mo>
    </mrow>
   </msubsup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <neq></neq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>E</ci>
      <ci>n</ci>
     </apply>
     <cn type="integer">0</cn>
    </apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>E</ci>
      <ci>k</ci>
     </apply>
     <cn type="integer">0</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   E_{n}^{(0)}\neq E_{k}^{(0)}
  </annotation>
 </semantics>
</math>

. In total we get</p>

<p>

<math display="block" id="Perturbation_theory_(quantum_mechanics):45">
 <semantics>
  <mrow>
   <mo>|</mo>
   <msup>
    <mi>n</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mn>1</mn>
     <mo stretchy="false">)</mo>
    </mrow>
   </msup>
   <mo>=</mo>
   <munder>
    <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
    <mrow>
     <mi>k</mi>
     <mo>≠</mo>
     <mi>n</mi>
    </mrow>
   </munder>
   <mfrac>
    <mrow>
     <mo>⟨</mo>
     <msup>
      <mi>k</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mn>0</mn>
       <mo stretchy="false">)</mo>
      </mrow>
     </msup>
     <mo>|</mo>
     <mi>V</mi>
     <mo>|</mo>
     <msup>
      <mi>n</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mn>0</mn>
       <mo stretchy="false">)</mo>
      </mrow>
     </msup>
    </mrow>
    <mrow>
     <msubsup>
      <mi>E</mi>
      <mi>n</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mn>0</mn>
       <mo stretchy="false">)</mo>
      </mrow>
     </msubsup>
     <mo>-</mo>
     <msubsup>
      <mi>E</mi>
      <mi>k</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mn>0</mn>
       <mo stretchy="false">)</mo>
      </mrow>
     </msubsup>
    </mrow>
   </mfrac>
   <mo>|</mo>
   <msup>
    <mi>k</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mn>0</mn>
     <mo stretchy="false">)</mo>
    </mrow>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <ci>normal-|</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>n</ci>
     <cn type="integer">1</cn>
    </apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <sum></sum>
     <apply>
      <neq></neq>
      <ci>k</ci>
      <ci>n</ci>
     </apply>
    </apply>
    <apply>
     <divide></divide>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <ci>normal-⟨</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>k</ci>
       <cn type="integer">0</cn>
      </apply>
      <ci>normal-|</ci>
      <csymbol cd="unknown">V</csymbol>
      <ci>normal-|</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>n</ci>
       <cn type="integer">0</cn>
      </apply>
     </cerror>
     <apply>
      <minus></minus>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>E</ci>
        <ci>n</ci>
       </apply>
       <cn type="integer">0</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>E</ci>
        <ci>k</ci>
       </apply>
       <cn type="integer">0</cn>
      </apply>
     </apply>
    </apply>
    <ci>normal-|</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>k</ci>
     <cn type="integer">0</cn>
    </apply>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \left|n^{(1)}\right\rang=\sum_{k\neq n}\frac{\left\langle k^{(0)}\right|V\left%
|n^{(0)}\right\rang}{E_{n}^{(0)}-E_{k}^{(0)}}\left|k^{(0)}\right\rang
  </annotation>
 </semantics>
</math>

</p>

<p>The first-order change in the 

<math display="inline" id="Perturbation_theory_(quantum_mechanics):46">
 <semantics>
  <mi>n</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>n</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n
  </annotation>
 </semantics>
</math>

-th energy eigenket has a contribution from each of the energy eigenstates 

<math display="inline" id="Perturbation_theory_(quantum_mechanics):47">
 <semantics>
  <mrow>
   <mi>k</mi>
   <mi mathvariant="normal">≠</mi>
   <mi>n</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>k</ci>
    <ci>normal-≠</ci>
    <ci>n</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   k≠n
  </annotation>
 </semantics>
</math>

. Each term is proportional to the matrix element 

<math display="inline" id="Perturbation_theory_(quantum_mechanics):48">
 <semantics>
  <mrow>
   <merror class="ltx_ERROR undefined undefined">
    <mtext>\lang</mtext>
   </merror>
   <msup>
    <mi>k</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mn>0</mn>
     <mo stretchy="false">)</mo>
    </mrow>
   </msup>
   <mrow>
    <mo stretchy="false">|</mo>
    <mi>V</mi>
    <mo stretchy="false">|</mo>
   </mrow>
   <msup>
    <mi>n</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mn>0</mn>
     <mo stretchy="false">)</mo>
    </mrow>
   </msup>
   <merror class="ltx_ERROR undefined undefined">
    <mtext>\rang</mtext>
   </merror>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <mtext>\lang</mtext>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>k</ci>
     <cn type="integer">0</cn>
    </apply>
    <apply>
     <abs></abs>
     <ci>V</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>n</ci>
     <cn type="integer">0</cn>
    </apply>
    <mtext>\rang</mtext>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \lang k^{(0)}|V|n^{(0)}\rang
  </annotation>
 </semantics>
</math>

, which is a measure of how much the perturbation mixes eigenstate 

<math display="inline" id="Perturbation_theory_(quantum_mechanics):49">
 <semantics>
  <mi>n</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>n</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n
  </annotation>
 </semantics>
</math>

 with eigenstate 

<math display="inline" id="Perturbation_theory_(quantum_mechanics):50">
 <semantics>
  <mi>k</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>k</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   k
  </annotation>
 </semantics>
</math>

; it is also inversely proportional to the energy difference between eigenstates 

<math display="inline" id="Perturbation_theory_(quantum_mechanics):51">
 <semantics>
  <mi>k</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>k</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   k
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Perturbation_theory_(quantum_mechanics):52">
 <semantics>
  <mi>n</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>n</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n
  </annotation>
 </semantics>
</math>

, which means that the perturbation deforms the eigenstate to a greater extent if there are more eigenstates at nearby energies. We see also that the expression is singular if any of these states have the same energy as state 

<math display="inline" id="Perturbation_theory_(quantum_mechanics):53">
 <semantics>
  <mi>n</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>n</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n
  </annotation>
 </semantics>
</math>

, which is why we assumed that there is no degeneracy.</p>
<h3 id="second-order-and-higher-corrections">Second-order and higher corrections</h3>

<p>We can find the higher-order deviations by a similar procedure, though the calculations become quite tedious with our current formulation. Our normalization prescription gives that</p>

<p>

<math display="block" id="Perturbation_theory_(quantum_mechanics):54">
 <semantics>
  <mrow>
   <mrow>
    <mn>2</mn>
    <msup>
     <mi>n</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mn>0</mn>
      <mo stretchy="false">)</mo>
     </mrow>
    </msup>
    <mrow>
     <mo>|</mo>
     <mrow>
      <msup>
       <mi>n</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mn>2</mn>
        <mo stretchy="false">)</mo>
       </mrow>
      </msup>
      <mo>+</mo>
      <msup>
       <mi>n</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mn>1</mn>
        <mo stretchy="false">)</mo>
       </mrow>
      </msup>
     </mrow>
     <mo>|</mo>
    </mrow>
    <msup>
     <mi>n</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mn>1</mn>
      <mo stretchy="false">)</mo>
     </mrow>
    </msup>
   </mrow>
   <mo>=</mo>
   <mn>0.</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <cn type="integer">2</cn>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>n</ci>
      <cn type="integer">0</cn>
     </apply>
     <apply>
      <abs></abs>
      <apply>
       <plus></plus>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>n</ci>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>n</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>n</ci>
      <cn type="integer">1</cn>
     </apply>
    </apply>
    <cn type="float">0.</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   2\left\lang n^{(0)}\right|\left.n^{(2)}\right\rang+\left\lang n^{(1)}\right|%
\left.n^{(1)}\right\rang=0.
  </annotation>
 </semantics>
</math>

</p>

<p>Up to second order, the expressions for the energies and (normalized) eigenstates are:</p>

<p>

<math display="block" id="Perturbation_theory_(quantum_mechanics):55">
 <semantics>
  <mrow>
   <msub>
    <mi>E</mi>
    <mi>n</mi>
   </msub>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>λ</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>=</mo>
   <msubsup>
    <mi>E</mi>
    <mi>n</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mn>0</mn>
     <mo stretchy="false">)</mo>
    </mrow>
   </msubsup>
   <mo>+</mo>
   <mi>λ</mi>
   <mrow>
    <mo>⟨</mo>
    <msup>
     <mi>n</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mn>0</mn>
      <mo stretchy="false">)</mo>
     </mrow>
    </msup>
    <mo>|</mo>
    <mi>V</mi>
    <mo>|</mo>
    <msup>
     <mi>n</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mn>0</mn>
      <mo stretchy="false">)</mo>
     </mrow>
    </msup>
    <mo>+</mo>
    <msup>
     <mi>λ</mi>
     <mn>2</mn>
    </msup>
    <munder>
     <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
     <mrow>
      <mi>k</mi>
      <mo>≠</mo>
      <mi>n</mi>
     </mrow>
    </munder>
    <mfrac>
     <mrow>
      <mo>|</mo>
      <mrow>
       <mo>⟨</mo>
       <msup>
        <mi>k</mi>
        <mrow>
         <mo stretchy="false">(</mo>
         <mn>0</mn>
         <mo stretchy="false">)</mo>
        </mrow>
       </msup>
       <mo>|</mo>
       <mi>V</mi>
       <mo>|</mo>
       <msup>
        <mi>n</mi>
        <mrow>
         <mo stretchy="false">(</mo>
         <mn>0</mn>
         <mo stretchy="false">)</mo>
        </mrow>
       </msup>
       <msup>
        <mo>|</mo>
        <mn>2</mn>
       </msup>
      </mrow>
     </mrow>
     <mrow>
      <msubsup>
       <mi>E</mi>
       <mi>n</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mn>0</mn>
        <mo stretchy="false">)</mo>
       </mrow>
      </msubsup>
      <mo>-</mo>
      <msubsup>
       <mi>E</mi>
       <mi>k</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mn>0</mn>
        <mo stretchy="false">)</mo>
       </mrow>
      </msubsup>
     </mrow>
    </mfrac>
    <mo>+</mo>
    <mi>O</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <msup>
      <mi>λ</mi>
      <mn>3</mn>
     </msup>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>E</ci>
     <ci>n</ci>
    </apply>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">λ</csymbol>
     <ci>normal-)</ci>
    </cerror>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>E</ci>
      <ci>n</ci>
     </apply>
     <cn type="integer">0</cn>
    </apply>
    <plus></plus>
    <csymbol cd="unknown">λ</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-⟨</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>n</ci>
      <cn type="integer">0</cn>
     </apply>
     <ci>normal-|</ci>
     <csymbol cd="unknown">V</csymbol>
     <ci>normal-|</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>n</ci>
      <cn type="integer">0</cn>
     </apply>
     <plus></plus>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>λ</ci>
      <cn type="integer">2</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <sum></sum>
      <apply>
       <neq></neq>
       <ci>k</ci>
       <ci>n</ci>
      </apply>
     </apply>
     <apply>
      <divide></divide>
      <cerror>
       <csymbol cd="ambiguous">fragments</csymbol>
       <ci>normal-|</ci>
       <cerror>
        <csymbol cd="ambiguous">fragments</csymbol>
        <ci>normal-⟨</ci>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>k</ci>
         <cn type="integer">0</cn>
        </apply>
        <ci>normal-|</ci>
        <csymbol cd="unknown">V</csymbol>
        <ci>normal-|</ci>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>n</ci>
         <cn type="integer">0</cn>
        </apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>normal-|</ci>
         <cn type="integer">2</cn>
        </apply>
       </cerror>
      </cerror>
      <apply>
       <minus></minus>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>E</ci>
         <ci>n</ci>
        </apply>
        <cn type="integer">0</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>E</ci>
         <ci>k</ci>
        </apply>
        <cn type="integer">0</cn>
       </apply>
      </apply>
     </apply>
     <plus></plus>
     <csymbol cd="unknown">O</csymbol>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <ci>normal-(</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>λ</ci>
       <cn type="integer">3</cn>
      </apply>
      <ci>normal-)</ci>
     </cerror>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   E_{n}(\lambda)=E_{n}^{(0)}+\lambda\left\langle n^{(0)}\right|V\left|n^{(0)}%
\right\rang+\lambda^{2}\sum_{k\neq n}\frac{\left|\left\langle k^{(0)}\right|V%
\left|n^{(0)}\right\rang\right|^{2}}{E_{n}^{(0)}-E_{k}^{(0)}}+O(\lambda^{3})
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="inline" id="Perturbation_theory_(quantum_mechanics):56">
 <semantics>
  <mrow>
   <mrow>
    <mo fence="true" stretchy="false">|</mo>
    <mrow>
     <mi>n</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>λ</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo stretchy="false">⟩</mo>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mo fence="true">|</mo>
    <msup>
     <mi>n</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mn>0</mn>
      <mo stretchy="false">)</mo>
     </mrow>
    </msup>
    <mo>⟩</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="latexml">ket</csymbol>
     <apply>
      <times></times>
      <ci>n</ci>
      <ci>λ</ci>
     </apply>
    </apply>
    <apply>
     <csymbol cd="latexml">ket</csymbol>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>n</ci>
      <cn type="integer">0</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle|n(\lambda)\rangle=\left|n^{(0)}\right\rangle
  </annotation>
 </semantics>
</math>


</p>

<p>Extending the process further, the third-order energy correction can be shown to be <a class="footnoteRef" href="#fn5" id="fnref5"><sup>5</sup></a></p>

<p>

<math display="block" id="Perturbation_theory_(quantum_mechanics):57">
 <semantics>
  <mrow>
   <mrow>
    <msubsup>
     <mi>E</mi>
     <mi>n</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mn>3</mn>
      <mo stretchy="false">)</mo>
     </mrow>
    </msubsup>
    <mo>=</mo>
    <mrow>
     <mrow>
      <munder>
       <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
       <mrow>
        <mi>k</mi>
        <mo>≠</mo>
        <mi>n</mi>
       </mrow>
      </munder>
      <mrow>
       <munder>
        <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
        <mrow>
         <mi>m</mi>
         <mo>≠</mo>
         <mi>n</mi>
        </mrow>
       </munder>
       <mfrac>
        <mrow>
         <mrow>
          <mo stretchy="false">⟨</mo>
          <msup>
           <mi>n</mi>
           <mrow>
            <mo stretchy="false">(</mo>
            <mn>0</mn>
            <mo stretchy="false">)</mo>
           </mrow>
          </msup>
          <mo fence="true" stretchy="false">|</mo>
          <mi>V</mi>
          <mo fence="true" stretchy="false">|</mo>
          <msup>
           <mi>m</mi>
           <mrow>
            <mo stretchy="false">(</mo>
            <mn>0</mn>
            <mo stretchy="false">)</mo>
           </mrow>
          </msup>
          <mo stretchy="false">⟩</mo>
         </mrow>
         <mrow>
          <mo stretchy="false">⟨</mo>
          <msup>
           <mi>m</mi>
           <mrow>
            <mo stretchy="false">(</mo>
            <mn>0</mn>
            <mo stretchy="false">)</mo>
           </mrow>
          </msup>
          <mo fence="true" stretchy="false">|</mo>
          <mi>V</mi>
          <mo fence="true" stretchy="false">|</mo>
          <msup>
           <mi>k</mi>
           <mrow>
            <mo stretchy="false">(</mo>
            <mn>0</mn>
            <mo stretchy="false">)</mo>
           </mrow>
          </msup>
          <mo stretchy="false">⟩</mo>
         </mrow>
         <mrow>
          <mo stretchy="false">⟨</mo>
          <msup>
           <mi>k</mi>
           <mrow>
            <mo stretchy="false">(</mo>
            <mn>0</mn>
            <mo stretchy="false">)</mo>
           </mrow>
          </msup>
          <mo fence="true" stretchy="false">|</mo>
          <mi>V</mi>
          <mo fence="true" stretchy="false">|</mo>
          <msup>
           <mi>n</mi>
           <mrow>
            <mo stretchy="false">(</mo>
            <mn>0</mn>
            <mo stretchy="false">)</mo>
           </mrow>
          </msup>
          <mo stretchy="false">⟩</mo>
         </mrow>
        </mrow>
        <mrow>
         <mrow>
          <mo>(</mo>
          <mrow>
           <msubsup>
            <mi>E</mi>
            <mi>m</mi>
            <mrow>
             <mo stretchy="false">(</mo>
             <mn>0</mn>
             <mo stretchy="false">)</mo>
            </mrow>
           </msubsup>
           <mo>-</mo>
           <msubsup>
            <mi>E</mi>
            <mi>n</mi>
            <mrow>
             <mo stretchy="false">(</mo>
             <mn>0</mn>
             <mo stretchy="false">)</mo>
            </mrow>
           </msubsup>
          </mrow>
          <mo>)</mo>
         </mrow>
         <mrow>
          <mo>(</mo>
          <mrow>
           <msubsup>
            <mi>E</mi>
            <mi>k</mi>
            <mrow>
             <mo stretchy="false">(</mo>
             <mn>0</mn>
             <mo stretchy="false">)</mo>
            </mrow>
           </msubsup>
           <mo>-</mo>
           <msubsup>
            <mi>E</mi>
            <mi>n</mi>
            <mrow>
             <mo stretchy="false">(</mo>
             <mn>0</mn>
             <mo stretchy="false">)</mo>
            </mrow>
           </msubsup>
          </mrow>
          <mo>)</mo>
         </mrow>
        </mrow>
       </mfrac>
      </mrow>
     </mrow>
     <mo>-</mo>
     <mrow>
      <mrow>
       <mo stretchy="false">⟨</mo>
       <msup>
        <mi>n</mi>
        <mrow>
         <mo stretchy="false">(</mo>
         <mn>0</mn>
         <mo stretchy="false">)</mo>
        </mrow>
       </msup>
       <mo fence="true" stretchy="false">|</mo>
       <mi>V</mi>
       <mo fence="true" stretchy="false">|</mo>
       <msup>
        <mi>n</mi>
        <mrow>
         <mo stretchy="false">(</mo>
         <mn>0</mn>
         <mo stretchy="false">)</mo>
        </mrow>
       </msup>
       <mo stretchy="false">⟩</mo>
      </mrow>
      <mrow>
       <munder>
        <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
        <mrow>
         <mi>m</mi>
         <mo>≠</mo>
         <mi>n</mi>
        </mrow>
       </munder>
       <mfrac>
        <msup>
         <mrow>
          <mo stretchy="false">|</mo>
          <mrow>
           <mo stretchy="false">⟨</mo>
           <msup>
            <mi>n</mi>
            <mrow>
             <mo stretchy="false">(</mo>
             <mn>0</mn>
             <mo stretchy="false">)</mo>
            </mrow>
           </msup>
           <mo fence="true" stretchy="false">|</mo>
           <mi>V</mi>
           <mo fence="true" stretchy="false">|</mo>
           <msup>
            <mi>m</mi>
            <mrow>
             <mo stretchy="false">(</mo>
             <mn>0</mn>
             <mo stretchy="false">)</mo>
            </mrow>
           </msup>
           <mo stretchy="false">⟩</mo>
          </mrow>
          <mo stretchy="false">|</mo>
         </mrow>
         <mn>2</mn>
        </msup>
        <msup>
         <mrow>
          <mo>(</mo>
          <mrow>
           <msubsup>
            <mi>E</mi>
            <mi>m</mi>
            <mrow>
             <mo stretchy="false">(</mo>
             <mn>0</mn>
             <mo stretchy="false">)</mo>
            </mrow>
           </msubsup>
           <mo>-</mo>
           <msubsup>
            <mi>E</mi>
            <mi>n</mi>
            <mrow>
             <mo stretchy="false">(</mo>
             <mn>0</mn>
             <mo stretchy="false">)</mo>
            </mrow>
           </msubsup>
          </mrow>
          <mo>)</mo>
         </mrow>
         <mn>2</mn>
        </msup>
       </mfrac>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>E</ci>
      <ci>n</ci>
     </apply>
     <cn type="integer">3</cn>
    </apply>
    <apply>
     <minus></minus>
     <apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <apply>
        <neq></neq>
        <ci>k</ci>
        <ci>n</ci>
       </apply>
      </apply>
      <apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <apply>
         <neq></neq>
         <ci>m</ci>
         <ci>n</ci>
        </apply>
       </apply>
       <apply>
        <divide></divide>
        <apply>
         <times></times>
         <apply>
          <csymbol cd="latexml">quantum-operator-product</csymbol>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <ci>n</ci>
           <cn type="integer">0</cn>
          </apply>
          <ci>V</ci>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <ci>m</ci>
           <cn type="integer">0</cn>
          </apply>
         </apply>
         <apply>
          <csymbol cd="latexml">quantum-operator-product</csymbol>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <ci>m</ci>
           <cn type="integer">0</cn>
          </apply>
          <ci>V</ci>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <ci>k</ci>
           <cn type="integer">0</cn>
          </apply>
         </apply>
         <apply>
          <csymbol cd="latexml">quantum-operator-product</csymbol>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <ci>k</ci>
           <cn type="integer">0</cn>
          </apply>
          <ci>V</ci>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <ci>n</ci>
           <cn type="integer">0</cn>
          </apply>
         </apply>
        </apply>
        <apply>
         <times></times>
         <apply>
          <minus></minus>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <ci>E</ci>
            <ci>m</ci>
           </apply>
           <cn type="integer">0</cn>
          </apply>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <ci>E</ci>
            <ci>n</ci>
           </apply>
           <cn type="integer">0</cn>
          </apply>
         </apply>
         <apply>
          <minus></minus>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <ci>E</ci>
            <ci>k</ci>
           </apply>
           <cn type="integer">0</cn>
          </apply>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <ci>E</ci>
            <ci>n</ci>
           </apply>
           <cn type="integer">0</cn>
          </apply>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="latexml">quantum-operator-product</csymbol>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>n</ci>
        <cn type="integer">0</cn>
       </apply>
       <ci>V</ci>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>n</ci>
        <cn type="integer">0</cn>
       </apply>
      </apply>
      <apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <apply>
         <neq></neq>
         <ci>m</ci>
         <ci>n</ci>
        </apply>
       </apply>
       <apply>
        <divide></divide>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <abs></abs>
          <apply>
           <csymbol cd="latexml">quantum-operator-product</csymbol>
           <apply>
            <csymbol cd="ambiguous">superscript</csymbol>
            <ci>n</ci>
            <cn type="integer">0</cn>
           </apply>
           <ci>V</ci>
           <apply>
            <csymbol cd="ambiguous">superscript</csymbol>
            <ci>m</ci>
            <cn type="integer">0</cn>
           </apply>
          </apply>
         </apply>
         <cn type="integer">2</cn>
        </apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <minus></minus>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <ci>E</ci>
            <ci>m</ci>
           </apply>
           <cn type="integer">0</cn>
          </apply>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <ci>E</ci>
            <ci>n</ci>
           </apply>
           <cn type="integer">0</cn>
          </apply>
         </apply>
         <cn type="integer">2</cn>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   E_{n}^{(3)}=\sum_{k\neq n}\sum_{m\neq n}\frac{\langle n^{(0)}|V|m^{(0)}\rangle%
\langle m^{(0)}|V|k^{(0)}\rangle\langle k^{(0)}|V|n^{(0)}\rangle}{\left(E_{m}^%
{(0)}-E_{n}^{(0)}\right)\left(E_{k}^{(0)}-E_{n}^{(0)}\right)}-\langle n^{(0)}|%
V|n^{(0)}\rangle\sum_{m\neq n}\frac{|\langle n^{(0)}|V|m^{(0)}\rangle|^{2}}{%
\left(E_{m}^{(0)}-E_{n}^{(0)}\right)^{2}}.
  </annotation>
 </semantics>
</math>

</p>

<p>\\ E_n^{(3)} &amp;= \frac{V_{nk_3}V_{k_3k_2}V_{k_2n}}{E_{nk_2}E_{nk_3}}-V_{nn}\frac{|V_{nk_3}|^2}{E_{nk_3}^2} \\ E_n^{(4)} &amp;= \frac{V_{nk_4}V_{k_4k_3}V_{k_3k_2}V_{k_2n}}{E_{nk_2}E_{nk_3}E_{nk_4}}-\frac{|V_{nk_4}|^2}{E_{nk_4}^2}\frac{|V_{nk_2}|^2}{E_{nk_2}}-V_{nn}\frac{V_{nk_4}V_{k_4k_3}V_{k_3n}}{E_{nk_3}^2E_{nk_4}}-V_{nn}\frac{V_{nk_4}V_{k_4k_2}V_{k_2n}}{E_{nk_2}E_{nk_4}^2}+V_{nn}^2\frac{|V_{nk_4}|^2}{E_{nk_4}^3} \\ &amp;=\frac{V_{nk_4}V_{k_4k_3}V_{k_3k_2}V_{k_2n}}{E_{nk_2}E_{nk_3}E_{nk_4}}-E_{n}^{(2)}\frac{|V_{nk_4}|^2}{E_{nk_4}^2}-2V_{nn}\frac{V_{nk_4}V_{k_4k_3}V_{k_3n}}{E_{nk_3}^2E_{nk_4}} +V_{nn}^2\frac{|V_{nk_4}|^2}{E_{nk_4}^3} \\ E_n^{(5)} &amp;=\frac{V_{nk_5}V_{k_5k_4}V_{k_4k_3}V_{k_3k_2}V_{k_2n}}{E_{nk_2}E_{nk_3}E_{nk_4}E_{nk_5}}-\frac{V_{nk_5}V_{k_5k_4}V_{k_4n}}{E_{nk_4}^2E_{nk_5}}\frac{|V_{nk_2}|^2}{E_{nk_2}}-\frac{V_{nk_5}V_{k_5k_2}V_{k_2n}}{E_{nk_2}E_{nk_5}^2}\frac{|V_{nk_2}|^2}{E_{nk_2}}-\frac{|V_{nk_5}|^2}{E_{nk_5}^2}\frac{V_{nk_3}V_{k_3k_2}V_{k_2n}}{E_{nk_2}E_{nk_3}} \\ &amp;\quad -V_{nn}\frac{V_{nk_5}V_{k_5k_4}V_{k_4k_3}V_{k_3n}}{E_{nk_3}^2E_{nk_4}E_{nk_5}}-V_{nn}\frac{V_{nk_5}V_{k_5k_4}V_{k_4k_2}V_{k_2n}}{E_{nk_2}E_{nk_4}^2E_{nk_5}}-V_{nn}\frac{V_{nk_5}V_{k_5k_3}V_{k_3k_2}V_{k_2n}}{E_{nk_2}E_{nk_3}E_{nk_5}^2}+V_{nn}\frac{|V_{nk_5}|^2}{E_{nk_5}^2}\frac{|V_{nk_3}|^2}{E_{nk_3}^2}+2V_{nn}\frac{|V_{nk_5}|^2}{E_{nk_5}^3}\frac{|V_{nk_2}|^2}{E_{nk_2}} \\ &amp;\quad +V_{nn}^2\frac{V_{nk_5}V_{k_5k_4}V_{k_4n}}{E_{nk_4}^3E_{nk_5}}+V_{nn}^2\frac{V_{nk_5}V_{k_5k_3}V_{k_3n}}{E_{nk_3}^2E_{nk_5}^2}+V_{nn}^2\frac{V_{nk_5}V_{k_5k_2}V_{k_2n}}{E_{nk_2}E_{nk_5}^3}-V_{nn}^3\frac{|V_{nk_5}|^2}{E_{nk_5}^4} \\ &amp;=\frac{V_{nk_5}V_{k_5k_4}V_{k_4k_3}V_{k_3k_2}V_{k_2n}}{E_{nk_2}E_{nk_3}E_{nk_4}E_{nk_5}}-2E_n^{(2)}\frac{V_{nk_5}V_{k_5k_4}V_{k_4n}}{E_{nk_4}^2E_{nk_5}}-\frac{|V_{nk_5}|^2}{E_{nk_5}^2}\frac{V_{nk_3}V_{k_3k_2}V_{k_2n}}{E_{nk_2}E_{nk_3}} \\ &amp;\quad -2V_{nn}\left(\frac{V_{nk_5}V_{k_5k_4}V_{k_4k_3}V_{k_3n}}{E_{nk_3}^2E_{nk_4}E_{nk_5}}-\frac{V_{nk_5}V_{k_5k_4}V_{k_4k_2}V_{k_2n}}{E_{nk_2}E_{nk_4}^2E_{nk_5}}+\frac{|V_{nk_5}|^2}{E_{nk_5}^2}\frac{|V_{nk_3}|^2}{E_{nk_3}^2}+2E_n^{(2)}\frac{|V_{nk_5}|^2}{E_{nk_5}^3}\right) \\ &amp;\quad +V_{nn}^2\left(2\frac{V_{nk_5}V_{k_5k_4}V_{k_4n}}{E_{nk_4}^3E_{nk_5}}+\frac{V_{nk_5}V_{k_5k_3}V_{k_3n}}{E_{nk_3}^2E_{nk_5}^2}\right)-V_{nn}^3\frac{|V_{nk_5}|^2}{E_{nk_5}^4} \end{align}</p>

<p>and the states to fourth order can be written</p>

<p>

<math display="inline" id="Perturbation_theory_(quantum_mechanics):58">
 <semantics>
  <mrow>
   <mo fence="true" stretchy="false">|</mo>
   <msup>
    <mi>n</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mn>1</mn>
     <mo stretchy="false">)</mo>
    </mrow>
   </msup>
   <mo stretchy="false">⟩</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">ket</csymbol>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>n</ci>
     <cn type="integer">1</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle|n^{(1)}\rangle
  </annotation>
 </semantics>
</math>


</p>

<p>All terms involved <mtpl></mtpl> should be summed over <mtpl></mtpl> such that the denominator does not vanish. }}</p>
<h3 id="effects-of-degeneracy">Effects of degeneracy</h3>

<p>Suppose that two or more energy eigenstates are <a href="Degenerate_energy_level" title="wikilink">degenerate</a>. The first-order energy shift is not well defined, since there is no unique way to choose a basis of eigenstates for the unperturbed system. The calculation of the change in the eigenstate is problematic as well, because the operator</p>

<p>

<math display="block" id="Perturbation_theory_(quantum_mechanics):59">
 <semantics>
  <mrow>
   <msubsup>
    <mi>E</mi>
    <mi>n</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mn>0</mn>
     <mo stretchy="false">)</mo>
    </mrow>
   </msubsup>
   <mo>-</mo>
   <msub>
    <mi>H</mi>
    <mn>0</mn>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <minus></minus>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>E</ci>
      <ci>n</ci>
     </apply>
     <cn type="integer">0</cn>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>H</ci>
     <cn type="integer">0</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   E_{n}^{(0)}-H_{0}
  </annotation>
 </semantics>
</math>

</p>

<p>does not have a well-defined inverse.</p>

<p>Let 

<math display="inline" id="Perturbation_theory_(quantum_mechanics):60">
 <semantics>
  <mi>D</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>D</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   D
  </annotation>
 </semantics>
</math>

 denote the subspace spanned by these degenerate eigenstates. No matter how small the perturbation is, in the degenerate subspace 

<math display="inline" id="Perturbation_theory_(quantum_mechanics):61">
 <semantics>
  <mi>D</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>D</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   D
  </annotation>
 </semantics>
</math>

 the energy differences between the eigenstates <mtpl></mtpl> are zero, so complete mixing of at least some of these states is assured. Thus the perturbation can not be considered small in the 

<math display="inline" id="Perturbation_theory_(quantum_mechanics):62">
 <semantics>
  <mi>D</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>D</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   D
  </annotation>
 </semantics>
</math>

 subspace and in that subspace the new Hamiltonian must be diagonalized first. These correct perturbed eigenstates in 

<math display="inline" id="Perturbation_theory_(quantum_mechanics):63">
 <semantics>
  <mi>D</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>D</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   D
  </annotation>
 </semantics>
</math>

 are now the basis for the perturbation expansion:</p>

<p>

<math display="block" id="Perturbation_theory_(quantum_mechanics):64">
 <semantics>
  <mrow>
   <mrow>
    <mo fence="true" stretchy="false">|</mo>
    <mi>n</mi>
    <mo stretchy="false">⟩</mo>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <munder>
      <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
      <mrow>
       <mi>k</mi>
       <mo>∈</mo>
       <mi>D</mi>
      </mrow>
     </munder>
     <mrow>
      <msub>
       <mi>α</mi>
       <mrow>
        <mi>n</mi>
        <mi>k</mi>
       </mrow>
      </msub>
      <mrow>
       <mo fence="true" stretchy="false">|</mo>
       <msup>
        <mi>k</mi>
        <mrow>
         <mo stretchy="false">(</mo>
         <mn>0</mn>
         <mo stretchy="false">)</mo>
        </mrow>
       </msup>
       <mo stretchy="false">⟩</mo>
      </mrow>
     </mrow>
    </mrow>
    <mo>+</mo>
    <mrow>
     <mi>λ</mi>
     <mrow>
      <mo fence="true" stretchy="false">|</mo>
      <msup>
       <mi>n</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mn>1</mn>
        <mo stretchy="false">)</mo>
       </mrow>
      </msup>
      <mo stretchy="false">⟩</mo>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="latexml">ket</csymbol>
     <ci>n</ci>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <apply>
        <in></in>
        <ci>k</ci>
        <ci>D</ci>
       </apply>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>α</ci>
        <apply>
         <times></times>
         <ci>n</ci>
         <ci>k</ci>
        </apply>
       </apply>
       <apply>
        <csymbol cd="latexml">ket</csymbol>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>k</ci>
         <cn type="integer">0</cn>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <ci>λ</ci>
      <apply>
       <csymbol cd="latexml">ket</csymbol>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>n</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   |n\rangle=\sum_{k\in D}\alpha_{nk}|k^{(0)}\rangle+\lambda|n^{(1)}\rangle
  </annotation>
 </semantics>
</math>

</p>

<p>where only eigenstates outside of the 

<math display="inline" id="Perturbation_theory_(quantum_mechanics):65">
 <semantics>
  <mi>D</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>D</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   D
  </annotation>
 </semantics>
</math>

 subspace are considered to be small. For the first-order perturbation we need to solve the perturbed Hamiltonian restricted to the degenerate subspace 

<math display="inline" id="Perturbation_theory_(quantum_mechanics):66">
 <semantics>
  <mi>D</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>D</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   D
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Perturbation_theory_(quantum_mechanics):67">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mrow>
      <mi>V</mi>
      <mrow>
       <mo fence="true" stretchy="false">|</mo>
       <msup>
        <mi>k</mi>
        <mrow>
         <mo stretchy="false">(</mo>
         <mn>0</mn>
         <mo stretchy="false">)</mo>
        </mrow>
       </msup>
       <mo stretchy="false">⟩</mo>
      </mrow>
     </mrow>
     <mo>=</mo>
     <mrow>
      <msub>
       <mi>ϵ</mi>
       <mi>k</mi>
      </msub>
      <mrow>
       <mo fence="true" stretchy="false">|</mo>
       <msup>
        <mi>k</mi>
        <mrow>
         <mo stretchy="false">(</mo>
         <mn>0</mn>
         <mo stretchy="false">)</mo>
        </mrow>
       </msup>
       <mo stretchy="false">⟩</mo>
      </mrow>
     </mrow>
    </mrow>
    <mrow>
     <mrow>
      <mo rspace="5.3pt">∀</mo>
      <mrow>
       <mo fence="true" stretchy="false">|</mo>
       <msup>
        <mi>k</mi>
        <mrow>
         <mo stretchy="false">(</mo>
         <mn>0</mn>
         <mo stretchy="false">)</mo>
        </mrow>
       </msup>
       <mo stretchy="false">⟩</mo>
      </mrow>
     </mrow>
     <mo>∈</mo>
     <mi>D</mi>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <eq></eq>
     <apply>
      <times></times>
      <ci>V</ci>
      <apply>
       <csymbol cd="latexml">ket</csymbol>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>k</ci>
        <cn type="integer">0</cn>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>ϵ</ci>
       <ci>k</ci>
      </apply>
      <apply>
       <csymbol cd="latexml">ket</csymbol>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>k</ci>
        <cn type="integer">0</cn>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <in></in>
     <apply>
      <csymbol cd="latexml">for-all</csymbol>
      <apply>
       <csymbol cd="latexml">ket</csymbol>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>k</ci>
        <cn type="integer">0</cn>
       </apply>
      </apply>
     </apply>
     <ci>D</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   V|k^{(0)}\rangle=\epsilon_{k}|k^{(0)}\rangle\qquad\forall\;|k^{(0)}\rangle\in D.
  </annotation>
 </semantics>
</math>

</p>

<p>simultaneously for all the degenerate eigenstates, where 

<math display="inline" id="Perturbation_theory_(quantum_mechanics):68">
 <semantics>
  <msub>
   <mi>ϵ</mi>
   <mi>k</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>ϵ</ci>
    <ci>k</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \epsilon_{k}
  </annotation>
 </semantics>
</math>

 are first-order corrections to the degenerate energy levels. This is equivalent to diagonalizing the matrix</p>

<p>

<math display="block" id="Perturbation_theory_(quantum_mechanics):69">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mrow>
      <mo stretchy="false">⟨</mo>
      <msup>
       <mi>k</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mn>0</mn>
        <mo stretchy="false">)</mo>
       </mrow>
      </msup>
      <mo fence="true" stretchy="false">|</mo>
      <mi>V</mi>
      <mo fence="true" stretchy="false">|</mo>
      <msup>
       <mi>l</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mn>0</mn>
        <mo stretchy="false">)</mo>
       </mrow>
      </msup>
      <mo stretchy="false">⟩</mo>
     </mrow>
     <mo>=</mo>
     <mrow>
      <msub>
       <mi>V</mi>
       <mrow>
        <mi>k</mi>
        <mi>l</mi>
       </mrow>
      </msub>
      <mrow>
       <mo rspace="5.3pt">∀</mo>
       <mrow>
        <mo fence="true" stretchy="false">|</mo>
        <msup>
         <mi>k</mi>
         <mrow>
          <mo stretchy="false">(</mo>
          <mn>0</mn>
          <mo stretchy="false">)</mo>
         </mrow>
        </msup>
        <mo stretchy="false">⟩</mo>
       </mrow>
      </mrow>
     </mrow>
    </mrow>
    <mo>,</mo>
    <mrow>
     <mrow>
      <mo fence="true" stretchy="false">|</mo>
      <msup>
       <mi>l</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mn>0</mn>
        <mo stretchy="false">)</mo>
       </mrow>
      </msup>
      <mo stretchy="false">⟩</mo>
     </mrow>
     <mo>∈</mo>
     <mi>D</mi>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="latexml">quantum-operator-product</csymbol>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>k</ci>
       <cn type="integer">0</cn>
      </apply>
      <ci>V</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>l</ci>
       <cn type="integer">0</cn>
      </apply>
     </apply>
     <list>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>V</ci>
       <apply>
        <times></times>
        <ci>k</ci>
        <ci>l</ci>
       </apply>
      </apply>
      <apply>
       <csymbol cd="latexml">for-all</csymbol>
       <apply>
        <csymbol cd="latexml">ket</csymbol>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>k</ci>
         <cn type="integer">0</cn>
        </apply>
       </apply>
      </apply>
     </list>
    </apply>
    <apply>
     <in></in>
     <apply>
      <csymbol cd="latexml">ket</csymbol>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>l</ci>
       <cn type="integer">0</cn>
      </apply>
     </apply>
     <ci>D</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \langle k^{(0)}|V|l^{(0)}\rangle=V_{kl}\qquad\forall\;|k^{(0)}\rangle,|l^{(0)}%
\rangle\in D.
  </annotation>
 </semantics>
</math>

</p>

<p>This procedure is approximate, since we neglected states outside the 

<math display="inline" id="Perturbation_theory_(quantum_mechanics):70">
 <semantics>
  <mi>D</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>D</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   D
  </annotation>
 </semantics>
</math>

 subspace. The splitting of degenerate energies 

<math display="inline" id="Perturbation_theory_(quantum_mechanics):71">
 <semantics>
  <msub>
   <mi>ϵ</mi>
   <mi>k</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>ϵ</ci>
    <ci>k</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \epsilon_{k}
  </annotation>
 </semantics>
</math>

 is generally observed. Although the splitting may be small compared to the range of energies found in the system, it is crucial in understanding certain details, such as spectral lines in <a href="Electron_Spin_Resonance" title="wikilink">Electron Spin Resonance</a> experiments.</p>

<p>Higher-order corrections due to other eigenstates can be found in the same way as for the non-degenerate case</p>

<p>

<math display="block" id="Perturbation_theory_(quantum_mechanics):72">
 <semantics>
  <mrow>
   <mrow>
    <mo>(</mo>
    <msubsup>
     <mi>E</mi>
     <mi>n</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mn>0</mn>
      <mo stretchy="false">)</mo>
     </mrow>
    </msubsup>
    <mo>-</mo>
    <msub>
     <mi>H</mi>
     <mn>0</mn>
    </msub>
    <mo>)</mo>
   </mrow>
   <mo stretchy="false">|</mo>
   <msup>
    <mi>n</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mn>1</mn>
     <mo stretchy="false">)</mo>
    </mrow>
   </msup>
   <merror class="ltx_ERROR undefined undefined">
    <mtext>\rang</mtext>
   </merror>
   <mo>=</mo>
   <munder>
    <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
    <mrow>
     <mi>k</mi>
     <mo>∉</mo>
     <mi>D</mi>
    </mrow>
   </munder>
   <mrow>
    <mo>(</mo>
    <mrow>
     <mo stretchy="false">⟨</mo>
     <msup>
      <mi>k</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mn>0</mn>
       <mo stretchy="false">)</mo>
      </mrow>
     </msup>
     <mo stretchy="false">|</mo>
     <mi>V</mi>
     <mo stretchy="false">|</mo>
     <msup>
      <mi>n</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mn>0</mn>
       <mo stretchy="false">)</mo>
      </mrow>
     </msup>
     <mo stretchy="false">⟩</mo>
    </mrow>
    <mo>)</mo>
   </mrow>
   <mo stretchy="false">|</mo>
   <msup>
    <mi>k</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mn>0</mn>
     <mo stretchy="false">)</mo>
    </mrow>
   </msup>
   <merror class="ltx_ERROR undefined undefined">
    <mtext>\rang</mtext>
   </merror>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>E</ci>
       <ci>n</ci>
      </apply>
      <cn type="integer">0</cn>
     </apply>
     <minus></minus>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>H</ci>
      <cn type="integer">0</cn>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <ci>normal-|</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>n</ci>
     <cn type="integer">1</cn>
    </apply>
    <mtext>\rang</mtext>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <sum></sum>
     <apply>
      <notin></notin>
      <ci>k</ci>
      <ci>D</ci>
     </apply>
    </apply>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <ci>normal-⟨</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>k</ci>
       <cn type="integer">0</cn>
      </apply>
      <ci>normal-|</ci>
      <csymbol cd="unknown">V</csymbol>
      <ci>normal-|</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>n</ci>
       <cn type="integer">0</cn>
      </apply>
      <ci>normal-⟩</ci>
     </cerror>
     <ci>normal-)</ci>
    </cerror>
    <ci>normal-|</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>k</ci>
     <cn type="integer">0</cn>
    </apply>
    <mtext>\rang</mtext>
    <ci>normal-.</ci>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \left(E_{n}^{(0)}-H_{0}\right)|n^{(1)}\rang=\sum_{k\not\in D}\left(\langle k^{%
(0)}|V|n^{(0)}\rangle\right)|k^{(0)}\rang.
  </annotation>
 </semantics>
</math>

</p>

<p>The operator on the left hand side is not singular when applied to eigenstates outside 

<math display="inline" id="Perturbation_theory_(quantum_mechanics):73">
 <semantics>
  <mi>D</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>D</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   D
  </annotation>
 </semantics>
</math>

, so we can write</p>

<p>

<math display="block" id="Perturbation_theory_(quantum_mechanics):74">
 <semantics>
  <mrow>
   <mo stretchy="false">|</mo>
   <msup>
    <mi>n</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mn>1</mn>
     <mo stretchy="false">)</mo>
    </mrow>
   </msup>
   <mo stretchy="false">⟩</mo>
   <mo>=</mo>
   <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
   <msub>
    <mi></mi>
    <mrow>
     <mi>k</mi>
     <mo>∉</mo>
     <mi>D</mi>
    </mrow>
   </msub>
   <mfrac>
    <mrow>
     <mo stretchy="false">⟨</mo>
     <msup>
      <mi>k</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mn>0</mn>
       <mo stretchy="false">)</mo>
      </mrow>
     </msup>
     <mo fence="true" stretchy="false">|</mo>
     <mi>V</mi>
     <mo fence="true" stretchy="false">|</mo>
     <msup>
      <mi>n</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mn>0</mn>
       <mo stretchy="false">)</mo>
      </mrow>
     </msup>
     <mo stretchy="false">⟩</mo>
    </mrow>
    <mrow>
     <msubsup>
      <mi>E</mi>
      <mi>n</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mn>0</mn>
       <mo stretchy="false">)</mo>
      </mrow>
     </msubsup>
     <mo>-</mo>
     <msubsup>
      <mi>E</mi>
      <mi>k</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mn>0</mn>
       <mo stretchy="false">)</mo>
      </mrow>
     </msubsup>
    </mrow>
   </mfrac>
   <mo stretchy="false">|</mo>
   <mi>k</mi>
   <msup>
    <mi></mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mn>0</mn>
     <mo stretchy="false">)</mo>
    </mrow>
   </msup>
   <merror class="ltx_ERROR undefined undefined">
    <mtext>\rang</mtext>
   </merror>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <ci>normal-|</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>n</ci>
     <cn type="integer">1</cn>
    </apply>
    <ci>normal-⟩</ci>
    <eq></eq>
    <sum></sum>
    <apply>
     <apply>
      <notin></notin>
      <ci>k</ci>
      <ci>D</ci>
     </apply>
    </apply>
    <apply>
     <divide></divide>
     <apply>
      <csymbol cd="latexml">quantum-operator-product</csymbol>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>k</ci>
       <cn type="integer">0</cn>
      </apply>
      <ci>V</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>n</ci>
       <cn type="integer">0</cn>
      </apply>
     </apply>
     <apply>
      <minus></minus>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>E</ci>
        <ci>n</ci>
       </apply>
       <cn type="integer">0</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>E</ci>
        <ci>k</ci>
       </apply>
       <cn type="integer">0</cn>
      </apply>
     </apply>
    </apply>
    <ci>normal-|</ci>
    <csymbol cd="unknown">k</csymbol>
    <apply>
     <cn type="integer">0</cn>
    </apply>
    <mtext>\rang</mtext>
    <ci>normal-,</ci>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   |n^{(1)}\rangle=\sum_{k\not\in D}\frac{\langle k^{(0)}|V|n^{(0)}\rangle}{E_{n}%
^{(0)}-E_{k}^{(0)}}|k^{(0)}\rang,
  </annotation>
 </semantics>
</math>

</p>

<p>but the effect on the degenerate states is minuscule, proportional to the square of the first-order correction 

<math display="inline" id="Perturbation_theory_(quantum_mechanics):75">
 <semantics>
  <msub>
   <mi>ϵ</mi>
   <mi>k</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>ϵ</ci>
    <ci>k</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \epsilon_{k}
  </annotation>
 </semantics>
</math>

.</p>

<p>Near-degenerate states should also be treated in the above manner, since the original Hamiltonian won't be larger than the perturbation in the near-degenerate subspace. An application is found in the <a href="nearly_free_electron_model" title="wikilink">nearly free electron model</a>, where near-degeneracy treated properly gives rise to an energy gap even for small perturbations. Other eigenstates will only shift the absolute energy of all near-degenerate states simultaneously.</p>
<h3 id="generalization-to-multi-parameter-case">Generalization to multi-parameter case</h3>

<p>The generalization of the time-independent perturbation theory to the case where there are multiple small parameters 

<math display="inline" id="Perturbation_theory_(quantum_mechanics):76">
 <semantics>
  <mrow>
   <msup>
    <mi>x</mi>
    <mi>μ</mi>
   </msup>
   <mo>=</mo>
   <mrow>
    <mo stretchy="false">(</mo>
    <msup>
     <mi>x</mi>
     <mn>1</mn>
    </msup>
    <mo>,</mo>
    <msup>
     <mi>x</mi>
     <mn>2</mn>
    </msup>
    <mo>,</mo>
    <mi mathvariant="normal">⋯</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>x</ci>
     <ci>μ</ci>
    </apply>
    <vector>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>x</ci>
      <cn type="integer">1</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>x</ci>
      <cn type="integer">2</cn>
     </apply>
     <ci>normal-⋯</ci>
    </vector>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x^{\mu}=(x^{1},x^{2},\cdots)
  </annotation>
 </semantics>
</math>

 in place of λ can be formulated more systematically using the language of <a href="differential_geometry" title="wikilink">differential geometry</a>, which basically defines the derivatives of the quantum states and calculate the perturbative corrections by taking derivatives iteratively at the unperturbed point.</p>
<h4 id="hamiltonian-and-force-operator">Hamiltonian and force operator</h4>

<p>From the differential geometric point of view, a parameterized Hamiltonian is considered as a function defined on the parameter <a class="uri" href="manifold" title="wikilink">manifold</a> that maps each particular set of parameters 

<math display="inline" id="Perturbation_theory_(quantum_mechanics):77">
 <semantics>
  <mrow>
   <mo stretchy="false">(</mo>
   <msup>
    <mi>x</mi>
    <mn>1</mn>
   </msup>
   <mo>,</mo>
   <msup>
    <mi>x</mi>
    <mn>2</mn>
   </msup>
   <mo>,</mo>
   <mi mathvariant="normal">⋯</mi>
   <mo stretchy="false">)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <vector>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>x</ci>
     <cn type="integer">1</cn>
    </apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>x</ci>
     <cn type="integer">2</cn>
    </apply>
    <ci>normal-⋯</ci>
   </vector>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (x^{1},x^{2},\cdots)
  </annotation>
 </semantics>
</math>

 to an Hermitian operator <mtpl></mtpl> that acts on the Hilbert space. The parameters here can be external field, interaction strength, or driving parameters in the <a href="quantum_phase_transition" title="wikilink">quantum phase transition</a>. Let <mtpl></mtpl> and 

<math display="inline" id="Perturbation_theory_(quantum_mechanics):78">
 <semantics>
  <mrow>
   <mo fence="true" stretchy="false">|</mo>
   <mrow>
    <mi>n</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <msup>
      <mi>x</mi>
      <mi>μ</mi>
     </msup>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo stretchy="false">⟩</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">ket</csymbol>
    <apply>
     <times></times>
     <ci>n</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>x</ci>
      <ci>μ</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   |n(x^{\mu})\rangle
  </annotation>
 </semantics>
</math>

 be the 

<math display="inline" id="Perturbation_theory_(quantum_mechanics):79">
 <semantics>
  <mi>n</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>n</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n
  </annotation>
 </semantics>
</math>

-th eigenenergy and eigenstate of <mtpl></mtpl> respectively. In the language of differential geometry, the states 

<math display="inline" id="Perturbation_theory_(quantum_mechanics):80">
 <semantics>
  <mrow>
   <mo fence="true" stretchy="false">|</mo>
   <mrow>
    <mi>n</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <msup>
      <mi>x</mi>
      <mi>μ</mi>
     </msup>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo stretchy="false">⟩</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">ket</csymbol>
    <apply>
     <times></times>
     <ci>n</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>x</ci>
      <ci>μ</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   |n(x^{\mu})\rangle
  </annotation>
 </semantics>
</math>

 form a <a href="vector_bundle" title="wikilink">vector bundle</a> over the parameter manifold, on which derivatives of these states can be defined. The perturbation theory is to answer the following question: given 

<math display="inline" id="Perturbation_theory_(quantum_mechanics):81">
 <semantics>
  <mrow>
   <msub>
    <mi>E</mi>
    <mi>n</mi>
   </msub>
   <mrow>
    <mo stretchy="false">(</mo>
    <msubsup>
     <mi>x</mi>
     <mn>0</mn>
     <mi>μ</mi>
    </msubsup>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>E</ci>
     <ci>n</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>x</ci>
      <ci>μ</ci>
     </apply>
     <cn type="integer">0</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   E_{n}(x^{\mu}_{0})
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Perturbation_theory_(quantum_mechanics):82">
 <semantics>
  <mrow>
   <mo fence="true" stretchy="false">|</mo>
   <mrow>
    <mi>n</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <msubsup>
      <mi>x</mi>
      <mn>0</mn>
      <mi>μ</mi>
     </msubsup>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo stretchy="false">⟩</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">ket</csymbol>
    <apply>
     <times></times>
     <ci>n</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>x</ci>
       <ci>μ</ci>
      </apply>
      <cn type="integer">0</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   |n(x^{\mu}_{0})\rangle
  </annotation>
 </semantics>
</math>

 at an unperturbed reference point 

<math display="inline" id="Perturbation_theory_(quantum_mechanics):83">
 <semantics>
  <msubsup>
   <mi>x</mi>
   <mn>0</mn>
   <mi>μ</mi>
  </msubsup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>x</ci>
     <ci>μ</ci>
    </apply>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x^{\mu}_{0}
  </annotation>
 </semantics>
</math>

, how to estimate the <mtpl></mtpl> and 

<math display="inline" id="Perturbation_theory_(quantum_mechanics):84">
 <semantics>
  <mrow>
   <mo fence="true" stretchy="false">|</mo>
   <mrow>
    <mi>n</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <msup>
      <mi>x</mi>
      <mi>μ</mi>
     </msup>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo stretchy="false">⟩</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">ket</csymbol>
    <apply>
     <times></times>
     <ci>n</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>x</ci>
      <ci>μ</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   |n(x^{\mu})\rangle
  </annotation>
 </semantics>
</math>

 at <mtpl></mtpl> close to that reference point.</p>

<p>Without loss of generality, the coordinate system can be shifted, such that the reference point 

<math display="inline" id="Perturbation_theory_(quantum_mechanics):85">
 <semantics>
  <mrow>
   <msubsup>
    <mi>x</mi>
    <mn>0</mn>
    <mi>μ</mi>
   </msubsup>
   <mo>=</mo>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>x</ci>
      <ci>μ</ci>
     </apply>
     <cn type="integer">0</cn>
    </apply>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x^{\mu}_{0}=0
  </annotation>
 </semantics>
</math>

 is set to be the origin. The following linearly parameterized Hamiltonian is frequently used</p>

<p>

<math display="block" id="Perturbation_theory_(quantum_mechanics):86">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>H</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <msup>
       <mi>x</mi>
       <mi>μ</mi>
      </msup>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mi>H</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mn>0</mn>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo>+</mo>
     <mrow>
      <msup>
       <mi>x</mi>
       <mi>μ</mi>
      </msup>
      <msub>
       <mi>F</mi>
       <mi>μ</mi>
      </msub>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>H</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>x</ci>
      <ci>μ</ci>
     </apply>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <ci>H</ci>
      <cn type="integer">0</cn>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>x</ci>
       <ci>μ</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>F</ci>
       <ci>μ</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   H(x^{\mu})=H(0)+x^{\mu}F_{\mu}.
  </annotation>
 </semantics>
</math>

</p>

<p>If the parameters <mtpl></mtpl> are considered as generalized coordinates, then <mtpl></mtpl> should be identified as the generalized force operators related to those coordinates. Different indices 

<math display="inline" id="Perturbation_theory_(quantum_mechanics):87">
 <semantics>
  <mi>μ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>μ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   μ
  </annotation>
 </semantics>
</math>

 label the different forces along different directions in the parameter manifold. For example, if <mtpl></mtpl> denotes the external magnetic field in the 

<math display="inline" id="Perturbation_theory_(quantum_mechanics):88">
 <semantics>
  <mi>μ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>μ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   μ
  </annotation>
 </semantics>
</math>

-direction, then <mtpl></mtpl> should be the magnetization in the same direction.</p>
<h4 id="perturbation-theory-as-power-series-expansion">Perturbation theory as power series expansion</h4>

<p>The validity of the perturbation theory lies on the adiabatic assumption, which assumes the eigenenergies and eigenstates of the Hamiltonian are smooth functions of parameters such that their values in the vicinity region can be calculated in power series (like <a href="Taylor_series" title="wikilink">Taylor expansion</a>) of the parameters:</p>

<p>

<math display="inline" id="Perturbation_theory_(quantum_mechanics):89">
 <semantics>
  <mrow>
   <msub>
    <mi>E</mi>
    <mi>n</mi>
   </msub>
   <mrow>
    <mo stretchy="false">(</mo>
    <msup>
     <mi>x</mi>
     <mi>μ</mi>
    </msup>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>E</ci>
     <ci>n</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>x</ci>
     <ci>μ</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle E_{n}(x^{\mu})
  </annotation>
 </semantics>
</math>


</p>

<p>Here <mtpl></mtpl> denotes the derivative with respect to <mtpl></mtpl>. When applying to the state 

<math display="inline" id="Perturbation_theory_(quantum_mechanics):90">
 <semantics>
  <mrow>
   <mo fence="true" stretchy="false">|</mo>
   <mrow>
    <msub>
     <mo>∂</mo>
     <mi>μ</mi>
    </msub>
    <mi>n</mi>
   </mrow>
   <mo stretchy="false">⟩</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">ket</csymbol>
    <apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <partialdiff></partialdiff>
      <ci>μ</ci>
     </apply>
     <ci>n</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   |\partial_{\mu}n\rangle
  </annotation>
 </semantics>
</math>

, it should be understood as the <a href="covariant_derivative" title="wikilink">covariant derivative</a> if the vector bundle is equipped with non-vanishing <a href="Connection_(mathematics)" title="wikilink">connection</a>. All the terms on the right-hand-side of the series are evaluated at <mtpl> 0}}</mtpl>, e.g. <mtpl></mtpl> and 

<math display="inline" id="Perturbation_theory_(quantum_mechanics):91">
 <semantics>
  <mrow>
   <mrow>
    <mo fence="true" stretchy="false">|</mo>
    <mi>n</mi>
    <mo stretchy="false">⟩</mo>
   </mrow>
   <mo>≡</mo>
   <mrow>
    <mo fence="true" stretchy="false">|</mo>
    <mrow>
     <mi>n</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mn>0</mn>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo stretchy="false">⟩</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <equivalent></equivalent>
    <apply>
     <csymbol cd="latexml">ket</csymbol>
     <ci>n</ci>
    </apply>
    <apply>
     <csymbol cd="latexml">ket</csymbol>
     <apply>
      <times></times>
      <ci>n</ci>
      <cn type="integer">0</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   |n\rangle\equiv|n(0)\rangle
  </annotation>
 </semantics>
</math>

. This convention will be adopted throughout this subsection, that all functions without the parameter dependence explicitly stated are assumed to be evaluated at the origin. The power series may converge slowly or even not converge when the energy levels are close to each other. The adiabatic assumption breaks down when there is energy level degeneracy, and hence the perturbation theory is not applicable in that case.</p>
<h4 id="hellmanfeynman-theorems">Hellman–Feynman theorems</h4>

<p>The above power series expansion can be readily evaluated if there is a systematic approach to calculate the derivates to any order. Using the <a href="chain_rule" title="wikilink">chain rule</a>, the derivatives can be broken down to the single derivative on either the energy or the state. The <a href="Hellmann–Feynman_theorem" title="wikilink">Hellmann–Feynman theorems</a> are used to calculate these single derivatives. The first Hellmann–Feynman theorem gives the derivative of the energy,</p>

<p>

<math display="block" id="Perturbation_theory_(quantum_mechanics):92">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mo>∂</mo>
     <mi>μ</mi>
    </msub>
    <msub>
     <mi>E</mi>
     <mi>n</mi>
    </msub>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mo stretchy="false">⟨</mo>
    <mi>n</mi>
    <mo fence="true" stretchy="false">|</mo>
    <mrow>
     <msub>
      <mo>∂</mo>
      <mi>μ</mi>
     </msub>
     <mi>H</mi>
    </mrow>
    <mo fence="true" stretchy="false">|</mo>
    <mi>n</mi>
    <mo stretchy="false">⟩</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <partialdiff></partialdiff>
      <ci>μ</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>E</ci>
      <ci>n</ci>
     </apply>
    </apply>
    <apply>
     <csymbol cd="latexml">quantum-operator-product</csymbol>
     <ci>n</ci>
     <apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <partialdiff></partialdiff>
       <ci>μ</ci>
      </apply>
      <ci>H</ci>
     </apply>
     <ci>n</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \partial_{\mu}E_{n}=\langle n|\partial_{\mu}H|n\rangle
  </annotation>
 </semantics>
</math>

</p>

<p>The second Hellmann–Feynman theorem gives the derivative of the state (resolved by the complete basis with m ≠ n),</p>

<p>

<math display="block" id="Perturbation_theory_(quantum_mechanics):93">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mrow>
      <mo stretchy="false">⟨</mo>
      <mi>m</mi>
      <mo stretchy="false">|</mo>
      <mrow>
       <msub>
        <mo>∂</mo>
        <mi>μ</mi>
       </msub>
       <mi>n</mi>
      </mrow>
      <mo stretchy="false">⟩</mo>
     </mrow>
     <mo>=</mo>
     <mfrac>
      <mrow>
       <mo stretchy="false">⟨</mo>
       <mi>m</mi>
       <mo fence="true" stretchy="false">|</mo>
       <mrow>
        <msub>
         <mo>∂</mo>
         <mi>μ</mi>
        </msub>
        <mi>H</mi>
       </mrow>
       <mo fence="true" stretchy="false">|</mo>
       <mi>n</mi>
       <mo stretchy="false">⟩</mo>
      </mrow>
      <mrow>
       <msub>
        <mi>E</mi>
        <mi>n</mi>
       </msub>
       <mo>-</mo>
       <msub>
        <mi>E</mi>
        <mi>m</mi>
       </msub>
      </mrow>
     </mfrac>
    </mrow>
    <mo rspace="22.5pt">,</mo>
    <mrow>
     <mrow>
      <mo stretchy="false">⟨</mo>
      <mrow>
       <msub>
        <mo>∂</mo>
        <mi>μ</mi>
       </msub>
       <mi>m</mi>
      </mrow>
      <mo stretchy="false">|</mo>
      <mi>n</mi>
      <mo stretchy="false">⟩</mo>
     </mrow>
     <mo>=</mo>
     <mfrac>
      <mrow>
       <mo stretchy="false">⟨</mo>
       <mi>m</mi>
       <mo fence="true" stretchy="false">|</mo>
       <mrow>
        <msub>
         <mo>∂</mo>
         <mi>μ</mi>
        </msub>
        <mi>H</mi>
       </mrow>
       <mo fence="true" stretchy="false">|</mo>
       <mi>n</mi>
       <mo stretchy="false">⟩</mo>
      </mrow>
      <mrow>
       <msub>
        <mi>E</mi>
        <mi>m</mi>
       </msub>
       <mo>-</mo>
       <msub>
        <mi>E</mi>
        <mi>n</mi>
       </msub>
      </mrow>
     </mfrac>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="latexml">inner-product</csymbol>
      <ci>m</ci>
      <apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <partialdiff></partialdiff>
        <ci>μ</ci>
       </apply>
       <ci>n</ci>
      </apply>
     </apply>
     <apply>
      <divide></divide>
      <apply>
       <csymbol cd="latexml">quantum-operator-product</csymbol>
       <ci>m</ci>
       <apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <partialdiff></partialdiff>
         <ci>μ</ci>
        </apply>
        <ci>H</ci>
       </apply>
       <ci>n</ci>
      </apply>
      <apply>
       <minus></minus>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>E</ci>
        <ci>n</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>E</ci>
        <ci>m</ci>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="latexml">inner-product</csymbol>
      <apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <partialdiff></partialdiff>
        <ci>μ</ci>
       </apply>
       <ci>m</ci>
      </apply>
      <ci>n</ci>
     </apply>
     <apply>
      <divide></divide>
      <apply>
       <csymbol cd="latexml">quantum-operator-product</csymbol>
       <ci>m</ci>
       <apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <partialdiff></partialdiff>
         <ci>μ</ci>
        </apply>
        <ci>H</ci>
       </apply>
       <ci>n</ci>
      </apply>
      <apply>
       <minus></minus>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>E</ci>
        <ci>m</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>E</ci>
        <ci>n</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \langle m|\partial_{\mu}n\rangle=\frac{\langle m|\partial_{\mu}H|n\rangle}{E_{%
n}-E_{m}},\qquad\langle\partial_{\mu}m|n\rangle=\frac{\langle m|\partial_{\mu}%
H|n\rangle}{E_{m}-E_{n}}.
  </annotation>
 </semantics>
</math>

</p>

<p>For the linearly parameterized Hamiltonian, <mtpl></mtpl> simply stands for the generalized force operator <mtpl></mtpl>.</p>

<p>The theorems can be simply derived by applying the differential operator <mtpl></mtpl> to both sides of the <a href="Schrödinger_equation" title="wikilink">Schrödinger equation</a> 

<math display="inline" id="Perturbation_theory_(quantum_mechanics):94">
 <semantics>
  <mrow>
   <mi>H</mi>
   <mo stretchy="false">|</mo>
   <mi>n</mi>
   <merror class="ltx_ERROR undefined undefined">
    <mtext>\rang</mtext>
   </merror>
   <mo>=</mo>
   <msub>
    <mi>E</mi>
    <mi>n</mi>
   </msub>
   <mo stretchy="false">|</mo>
   <mi>n</mi>
   <merror class="ltx_ERROR undefined undefined">
    <mtext>\rang</mtext>
   </merror>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">H</csymbol>
    <ci>normal-|</ci>
    <csymbol cd="unknown">n</csymbol>
    <mtext>\rang</mtext>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>E</ci>
     <ci>n</ci>
    </apply>
    <ci>normal-|</ci>
    <csymbol cd="unknown">n</csymbol>
    <mtext>\rang</mtext>
    <ci>normal-,</ci>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   H|n\rang=E_{n}|n\rang,
  </annotation>
 </semantics>
</math>

 which reads</p>

<p>

<math display="block" id="Perturbation_theory_(quantum_mechanics):95">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mrow>
      <mrow>
       <msub>
        <mo>∂</mo>
        <mi>μ</mi>
       </msub>
       <mi>H</mi>
      </mrow>
      <mrow>
       <mo fence="true" stretchy="false">|</mo>
       <mi>n</mi>
       <mo stretchy="false">⟩</mo>
      </mrow>
     </mrow>
     <mo>+</mo>
     <mrow>
      <mi>H</mi>
      <mrow>
       <mo fence="true" stretchy="false">|</mo>
       <mrow>
        <msub>
         <mo>∂</mo>
         <mi>μ</mi>
        </msub>
        <mi>n</mi>
       </mrow>
       <mo stretchy="false">⟩</mo>
      </mrow>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mrow>
       <msub>
        <mo>∂</mo>
        <mi>μ</mi>
       </msub>
       <msub>
        <mi>E</mi>
        <mi>n</mi>
       </msub>
      </mrow>
      <mrow>
       <mo fence="true" stretchy="false">|</mo>
       <mi>n</mi>
       <mo stretchy="false">⟩</mo>
      </mrow>
     </mrow>
     <mo>+</mo>
     <mrow>
      <msub>
       <mi>E</mi>
       <mi>n</mi>
      </msub>
      <mrow>
       <mo fence="true" stretchy="false">|</mo>
       <mrow>
        <msub>
         <mo>∂</mo>
         <mi>μ</mi>
        </msub>
        <mi>n</mi>
       </mrow>
       <mo stretchy="false">⟩</mo>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <partialdiff></partialdiff>
        <ci>μ</ci>
       </apply>
       <ci>H</ci>
      </apply>
      <apply>
       <csymbol cd="latexml">ket</csymbol>
       <ci>n</ci>
      </apply>
     </apply>
     <apply>
      <times></times>
      <ci>H</ci>
      <apply>
       <csymbol cd="latexml">ket</csymbol>
       <apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <partialdiff></partialdiff>
         <ci>μ</ci>
        </apply>
        <ci>n</ci>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <partialdiff></partialdiff>
        <ci>μ</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>E</ci>
        <ci>n</ci>
       </apply>
      </apply>
      <apply>
       <csymbol cd="latexml">ket</csymbol>
       <ci>n</ci>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>E</ci>
       <ci>n</ci>
      </apply>
      <apply>
       <csymbol cd="latexml">ket</csymbol>
       <apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <partialdiff></partialdiff>
         <ci>μ</ci>
        </apply>
        <ci>n</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \partial_{\mu}H|n\rangle+H|\partial_{\mu}n\rangle=\partial_{\mu}E_{n}|n\rangle%
+E_{n}|\partial_{\mu}n\rangle.
  </annotation>
 </semantics>
</math>

</p>

<p>Then overlap with the state 

<math display="inline" id="Perturbation_theory_(quantum_mechanics):96">
 <semantics>
  <mrow>
   <mo stretchy="false">⟨</mo>
   <mi>m</mi>
   <mo fence="true" stretchy="false">|</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">bra</csymbol>
    <ci>m</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \langle m|
  </annotation>
 </semantics>
</math>

 from left and make use of the Schrödinger equation 

<math display="inline" id="Perturbation_theory_(quantum_mechanics):97">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mo stretchy="false">⟨</mo>
     <mi>m</mi>
     <mo fence="true" stretchy="false">|</mo>
    </mrow>
    <mi>H</mi>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mo stretchy="false">⟨</mo>
     <mi>m</mi>
     <mo fence="true" stretchy="false">|</mo>
    </mrow>
    <msub>
     <mi>E</mi>
     <mi>m</mi>
    </msub>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="latexml">bra</csymbol>
      <ci>m</ci>
     </apply>
     <ci>H</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="latexml">bra</csymbol>
      <ci>m</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>E</ci>
      <ci>m</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \langle m|H=\langle m|E_{m}
  </annotation>
 </semantics>
</math>

 again,</p>

<p>

<math display="block" id="Perturbation_theory_(quantum_mechanics):98">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mrow>
      <mo stretchy="false">⟨</mo>
      <mi>m</mi>
      <mo fence="true" stretchy="false">|</mo>
      <mrow>
       <msub>
        <mo>∂</mo>
        <mi>μ</mi>
       </msub>
       <mi>H</mi>
      </mrow>
      <mo fence="true" stretchy="false">|</mo>
      <mi>n</mi>
      <mo stretchy="false">⟩</mo>
     </mrow>
     <mo>+</mo>
     <mrow>
      <msub>
       <mi>E</mi>
       <mi>m</mi>
      </msub>
      <mrow>
       <mo stretchy="false">⟨</mo>
       <mi>m</mi>
       <mo stretchy="false">|</mo>
       <mrow>
        <msub>
         <mo>∂</mo>
         <mi>μ</mi>
        </msub>
        <mi>n</mi>
       </mrow>
       <mo stretchy="false">⟩</mo>
      </mrow>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mrow>
       <msub>
        <mo>∂</mo>
        <mi>μ</mi>
       </msub>
       <msub>
        <mi>E</mi>
        <mi>n</mi>
       </msub>
      </mrow>
      <mrow>
       <mo stretchy="false">⟨</mo>
       <mi>m</mi>
       <mo stretchy="false">|</mo>
       <mi>n</mi>
       <mo stretchy="false">⟩</mo>
      </mrow>
     </mrow>
     <mo>+</mo>
     <mrow>
      <msub>
       <mi>E</mi>
       <mi>n</mi>
      </msub>
      <mrow>
       <mo stretchy="false">⟨</mo>
       <mi>m</mi>
       <mo stretchy="false">|</mo>
       <mrow>
        <msub>
         <mo>∂</mo>
         <mi>μ</mi>
        </msub>
        <mi>n</mi>
       </mrow>
       <mo stretchy="false">⟩</mo>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <plus></plus>
     <apply>
      <csymbol cd="latexml">quantum-operator-product</csymbol>
      <ci>m</ci>
      <apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <partialdiff></partialdiff>
        <ci>μ</ci>
       </apply>
       <ci>H</ci>
      </apply>
      <ci>n</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>E</ci>
       <ci>m</ci>
      </apply>
      <apply>
       <csymbol cd="latexml">inner-product</csymbol>
       <ci>m</ci>
       <apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <partialdiff></partialdiff>
         <ci>μ</ci>
        </apply>
        <ci>n</ci>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <partialdiff></partialdiff>
        <ci>μ</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>E</ci>
        <ci>n</ci>
       </apply>
      </apply>
      <apply>
       <csymbol cd="latexml">inner-product</csymbol>
       <ci>m</ci>
       <ci>n</ci>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>E</ci>
       <ci>n</ci>
      </apply>
      <apply>
       <csymbol cd="latexml">inner-product</csymbol>
       <ci>m</ci>
       <apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <partialdiff></partialdiff>
         <ci>μ</ci>
        </apply>
        <ci>n</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \langle m|\partial_{\mu}H|n\rangle+E_{m}\langle m|\partial_{\mu}n\rangle=%
\partial_{\mu}E_{n}\langle m|n\rangle+E_{n}\langle m|\partial_{\mu}n\rangle.
  </annotation>
 </semantics>
</math>

</p>

<p>Given that the eigenstates of the Hamiltonian always form an orthonormal basis 

<math display="inline" id="Perturbation_theory_(quantum_mechanics):99">
 <semantics>
  <mrow>
   <mrow>
    <mo stretchy="false">⟨</mo>
    <mi>m</mi>
    <mo stretchy="false">|</mo>
    <mi>n</mi>
    <mo stretchy="false">⟩</mo>
   </mrow>
   <mo>=</mo>
   <msub>
    <mi>δ</mi>
    <mrow>
     <mi>m</mi>
     <mi>n</mi>
    </mrow>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="latexml">inner-product</csymbol>
     <ci>m</ci>
     <ci>n</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>δ</ci>
     <apply>
      <times></times>
      <ci>m</ci>
      <ci>n</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \langle m|n\rangle=\delta_{mn}
  </annotation>
 </semantics>
</math>

, the cases of 

<math display="inline" id="Perturbation_theory_(quantum_mechanics):100">
 <semantics>
  <mrow>
   <mi>m</mi>
   <mo>=</mo>
   <mi>n</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>m</ci>
    <ci>n</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   m=n
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Perturbation_theory_(quantum_mechanics):101">
 <semantics>
  <mrow>
   <mi>m</mi>
   <mi mathvariant="normal">≠</mi>
   <mi>n</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>m</ci>
    <ci>normal-≠</ci>
    <ci>n</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   m≠n
  </annotation>
 </semantics>
</math>

 can be discussed separately. The first case will lead to the first theorem and the second case to the second theorem, which can be shown immediately by rearranging the terms. With the differential rules given by the Hellmann–Feynman theorems, the perturbative correction to the energies and states can be calculated systematically.</p>
<h4 id="correction-of-energy-and-state">Correction of energy and state</h4>

<p>To the second order, the energy correction reads</p>

<p>

<math display="block" id="Perturbation_theory_(quantum_mechanics):102">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <msub>
      <mi>E</mi>
      <mi>n</mi>
     </msub>
     <mrow>
      <mo stretchy="false">(</mo>
      <msup>
       <mi>x</mi>
       <mi>μ</mi>
      </msup>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mo stretchy="false">⟨</mo>
      <mi>n</mi>
      <mo fence="true" stretchy="false">|</mo>
      <mi>H</mi>
      <mo fence="true" stretchy="false">|</mo>
      <mi>n</mi>
      <mo stretchy="false">⟩</mo>
     </mrow>
     <mo>+</mo>
     <mrow>
      <mrow>
       <mo stretchy="false">⟨</mo>
       <mi>n</mi>
       <mo fence="true" stretchy="false">|</mo>
       <mrow>
        <msub>
         <mo>∂</mo>
         <mi>μ</mi>
        </msub>
        <mi>H</mi>
       </mrow>
       <mo fence="true" stretchy="false">|</mo>
       <mi>n</mi>
       <mo stretchy="false">⟩</mo>
      </mrow>
      <msup>
       <mi>x</mi>
       <mi>μ</mi>
      </msup>
     </mrow>
     <mo>+</mo>
     <mrow>
      <munder>
       <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
       <mrow>
        <mi>m</mi>
        <mo>≠</mo>
        <mi>n</mi>
       </mrow>
      </munder>
      <mrow>
       <mfrac>
        <mrow>
         <mrow>
          <mo stretchy="false">⟨</mo>
          <mi>n</mi>
          <mo fence="true" stretchy="false">|</mo>
          <mrow>
           <msub>
            <mo>∂</mo>
            <mi>ν</mi>
           </msub>
           <mi>H</mi>
          </mrow>
          <mo fence="true" stretchy="false">|</mo>
          <mi>m</mi>
          <mo stretchy="false">⟩</mo>
         </mrow>
         <mrow>
          <mo stretchy="false">⟨</mo>
          <mi>m</mi>
          <mo fence="true" stretchy="false">|</mo>
          <mrow>
           <msub>
            <mo>∂</mo>
            <mi>μ</mi>
           </msub>
           <mi>H</mi>
          </mrow>
          <mo fence="true" stretchy="false">|</mo>
          <mi>n</mi>
          <mo stretchy="false">⟩</mo>
         </mrow>
        </mrow>
        <mrow>
         <msub>
          <mi>E</mi>
          <mi>n</mi>
         </msub>
         <mo>-</mo>
         <msub>
          <mi>E</mi>
          <mi>m</mi>
         </msub>
        </mrow>
       </mfrac>
       <msup>
        <mi>x</mi>
        <mi>μ</mi>
       </msup>
       <msup>
        <mi>x</mi>
        <mi>ν</mi>
       </msup>
      </mrow>
     </mrow>
     <mo>+</mo>
     <mi mathvariant="normal">⋯</mi>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>E</ci>
      <ci>n</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>x</ci>
      <ci>μ</ci>
     </apply>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <csymbol cd="latexml">quantum-operator-product</csymbol>
      <ci>n</ci>
      <ci>H</ci>
      <ci>n</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="latexml">quantum-operator-product</csymbol>
       <ci>n</ci>
       <apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <partialdiff></partialdiff>
         <ci>μ</ci>
        </apply>
        <ci>H</ci>
       </apply>
       <ci>n</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>x</ci>
       <ci>μ</ci>
      </apply>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <apply>
        <neq></neq>
        <ci>m</ci>
        <ci>n</ci>
       </apply>
      </apply>
      <apply>
       <times></times>
       <apply>
        <divide></divide>
        <apply>
         <times></times>
         <apply>
          <csymbol cd="latexml">quantum-operator-product</csymbol>
          <ci>n</ci>
          <apply>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <partialdiff></partialdiff>
            <ci>ν</ci>
           </apply>
           <ci>H</ci>
          </apply>
          <ci>m</ci>
         </apply>
         <apply>
          <csymbol cd="latexml">quantum-operator-product</csymbol>
          <ci>m</ci>
          <apply>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <partialdiff></partialdiff>
            <ci>μ</ci>
           </apply>
           <ci>H</ci>
          </apply>
          <ci>n</ci>
         </apply>
        </apply>
        <apply>
         <minus></minus>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>E</ci>
          <ci>n</ci>
         </apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>E</ci>
          <ci>m</ci>
         </apply>
        </apply>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>x</ci>
        <ci>μ</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>x</ci>
        <ci>ν</ci>
       </apply>
      </apply>
     </apply>
     <ci>normal-⋯</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   E_{n}(x^{\mu})=\langle n|H|n\rangle+\langle n|\partial_{\mu}H|n\rangle x^{\mu}%
+\sum_{m\neq n}\frac{\langle n|\partial_{\nu}H|m\rangle\langle m|\partial_{\mu%
}H|n\rangle}{E_{n}-E_{m}}x^{\mu}x^{\nu}+\cdots.
  </annotation>
 </semantics>
</math>

</p>

<p>The first order derivative <mtpl></mtpl> is given by the first Hellmann–Feynman theorem directly. To obtain the second order derivative <mtpl></mtpl>, simply applying the differential operator <mtpl></mtpl> to the result of the first order derivative 

<math display="inline" id="Perturbation_theory_(quantum_mechanics):103">
 <semantics>
  <mrow>
   <mo stretchy="false">⟨</mo>
   <mi>n</mi>
   <mo fence="true" stretchy="false">|</mo>
   <mrow>
    <msub>
     <mo>∂</mo>
     <mi>ν</mi>
    </msub>
    <mi>H</mi>
   </mrow>
   <mo fence="true" stretchy="false">|</mo>
   <mi>n</mi>
   <mo stretchy="false">⟩</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">quantum-operator-product</csymbol>
    <ci>n</ci>
    <apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <partialdiff></partialdiff>
      <ci>ν</ci>
     </apply>
     <ci>H</ci>
    </apply>
    <ci>n</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \langle n|\partial_{\nu}H|n\rangle
  </annotation>
 </semantics>
</math>

, which reads</p>

<p>

<math display="block" id="Perturbation_theory_(quantum_mechanics):104">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mrow>
      <msub>
       <mo>∂</mo>
       <mi>μ</mi>
      </msub>
      <msub>
       <mo>∂</mo>
       <mi>ν</mi>
      </msub>
     </mrow>
     <msub>
      <mi>E</mi>
      <mi>n</mi>
     </msub>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mo stretchy="false">⟨</mo>
      <mrow>
       <msub>
        <mo>∂</mo>
        <mi>μ</mi>
       </msub>
       <mrow>
        <mi>n</mi>
        <mrow>
         <mo stretchy="false">|</mo>
         <mrow>
          <msub>
           <mo>∂</mo>
           <mi>ν</mi>
          </msub>
          <mi>H</mi>
         </mrow>
         <mo stretchy="false">|</mo>
        </mrow>
        <mi>n</mi>
       </mrow>
      </mrow>
      <mo stretchy="false">⟩</mo>
     </mrow>
     <mo>+</mo>
     <mrow>
      <mo stretchy="false">⟨</mo>
      <mrow>
       <mi>n</mi>
       <mrow>
        <mo stretchy="false">|</mo>
        <mrow>
         <mrow>
          <msub>
           <mo>∂</mo>
           <mi>μ</mi>
          </msub>
          <msub>
           <mo>∂</mo>
           <mi>ν</mi>
          </msub>
         </mrow>
         <mi>H</mi>
        </mrow>
        <mo stretchy="false">|</mo>
       </mrow>
       <mi>n</mi>
      </mrow>
      <mo stretchy="false">⟩</mo>
     </mrow>
     <mo>+</mo>
     <mrow>
      <mo stretchy="false">⟨</mo>
      <mrow>
       <mi>n</mi>
       <mrow>
        <mo stretchy="false">|</mo>
        <mrow>
         <msub>
          <mo>∂</mo>
          <mi>ν</mi>
         </msub>
         <mi>H</mi>
        </mrow>
        <mo stretchy="false">|</mo>
       </mrow>
       <mrow>
        <msub>
         <mo>∂</mo>
         <mi>μ</mi>
        </msub>
        <mi>n</mi>
       </mrow>
      </mrow>
      <mo stretchy="false">⟩</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <partialdiff></partialdiff>
       <ci>μ</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <partialdiff></partialdiff>
       <ci>ν</ci>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>E</ci>
      <ci>n</ci>
     </apply>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <csymbol cd="latexml">delimited-⟨⟩</csymbol>
      <apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <partialdiff></partialdiff>
        <ci>μ</ci>
       </apply>
       <apply>
        <times></times>
        <ci>n</ci>
        <apply>
         <abs></abs>
         <apply>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <partialdiff></partialdiff>
           <ci>ν</ci>
          </apply>
          <ci>H</ci>
         </apply>
        </apply>
        <ci>n</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <csymbol cd="latexml">delimited-⟨⟩</csymbol>
      <apply>
       <times></times>
       <ci>n</ci>
       <apply>
        <abs></abs>
        <apply>
         <apply>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <partialdiff></partialdiff>
           <ci>μ</ci>
          </apply>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <partialdiff></partialdiff>
           <ci>ν</ci>
          </apply>
         </apply>
         <ci>H</ci>
        </apply>
       </apply>
       <ci>n</ci>
      </apply>
     </apply>
     <apply>
      <csymbol cd="latexml">delimited-⟨⟩</csymbol>
      <apply>
       <times></times>
       <ci>n</ci>
       <apply>
        <abs></abs>
        <apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <partialdiff></partialdiff>
          <ci>ν</ci>
         </apply>
         <ci>H</ci>
        </apply>
       </apply>
       <apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <partialdiff></partialdiff>
         <ci>μ</ci>
        </apply>
        <ci>n</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \partial_{\mu}\partial_{\nu}E_{n}=\langle\partial_{\mu}n|\partial_{\nu}H|n%
\rangle+\langle n|\partial_{\mu}\partial_{\nu}H|n\rangle+\langle n|\partial_{%
\nu}H|\partial_{\mu}n\rangle.
  </annotation>
 </semantics>
</math>

</p>

<p>Note that for linearly parameterized Hamiltonian, there is no second derivative <mtpl> 0}}</mtpl> on the operator level. Resolve the derivative of state by inserting the complete set of basis,</p>

<p>

<math display="block" id="Perturbation_theory_(quantum_mechanics):105">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mrow>
      <msub>
       <mo>∂</mo>
       <mi>μ</mi>
      </msub>
      <msub>
       <mo>∂</mo>
       <mi>ν</mi>
      </msub>
     </mrow>
     <msub>
      <mi>E</mi>
      <mi>n</mi>
     </msub>
    </mrow>
    <mo>=</mo>
    <mrow>
     <munder>
      <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
      <mi>m</mi>
     </munder>
     <mrow>
      <mo>(</mo>
      <mrow>
       <mrow>
        <mrow>
         <mo stretchy="false">⟨</mo>
         <mrow>
          <msub>
           <mo>∂</mo>
           <mi>μ</mi>
          </msub>
          <mi>n</mi>
         </mrow>
         <mo stretchy="false">|</mo>
         <mi>m</mi>
         <mo stretchy="false">⟩</mo>
        </mrow>
        <mrow>
         <mo stretchy="false">⟨</mo>
         <mi>m</mi>
         <mo fence="true" stretchy="false">|</mo>
         <mrow>
          <msub>
           <mo>∂</mo>
           <mi>ν</mi>
          </msub>
          <mi>H</mi>
         </mrow>
         <mo fence="true" stretchy="false">|</mo>
         <mi>n</mi>
         <mo stretchy="false">⟩</mo>
        </mrow>
       </mrow>
       <mo>+</mo>
       <mrow>
        <mrow>
         <mo stretchy="false">⟨</mo>
         <mi>n</mi>
         <mo fence="true" stretchy="false">|</mo>
         <mrow>
          <msub>
           <mo>∂</mo>
           <mi>ν</mi>
          </msub>
          <mi>H</mi>
         </mrow>
         <mo fence="true" stretchy="false">|</mo>
         <mi>m</mi>
         <mo stretchy="false">⟩</mo>
        </mrow>
        <mrow>
         <mo stretchy="false">⟨</mo>
         <mi>m</mi>
         <mo stretchy="false">|</mo>
         <mrow>
          <msub>
           <mo>∂</mo>
           <mi>μ</mi>
          </msub>
          <mi>n</mi>
         </mrow>
         <mo stretchy="false">⟩</mo>
        </mrow>
       </mrow>
      </mrow>
      <mo>)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <partialdiff></partialdiff>
       <ci>μ</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <partialdiff></partialdiff>
       <ci>ν</ci>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>E</ci>
      <ci>n</ci>
     </apply>
    </apply>
    <apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <sum></sum>
      <ci>m</ci>
     </apply>
     <apply>
      <plus></plus>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="latexml">inner-product</csymbol>
        <apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <partialdiff></partialdiff>
          <ci>μ</ci>
         </apply>
         <ci>n</ci>
        </apply>
        <ci>m</ci>
       </apply>
       <apply>
        <csymbol cd="latexml">quantum-operator-product</csymbol>
        <ci>m</ci>
        <apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <partialdiff></partialdiff>
          <ci>ν</ci>
         </apply>
         <ci>H</ci>
        </apply>
        <ci>n</ci>
       </apply>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="latexml">quantum-operator-product</csymbol>
        <ci>n</ci>
        <apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <partialdiff></partialdiff>
          <ci>ν</ci>
         </apply>
         <ci>H</ci>
        </apply>
        <ci>m</ci>
       </apply>
       <apply>
        <csymbol cd="latexml">inner-product</csymbol>
        <ci>m</ci>
        <apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <partialdiff></partialdiff>
          <ci>μ</ci>
         </apply>
         <ci>n</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \partial_{\mu}\partial_{\nu}E_{n}=\sum_{m}\left(\langle\partial_{\mu}n|m%
\rangle\langle m|\partial_{\nu}H|n\rangle+\langle n|\partial_{\nu}H|m\rangle%
\langle m|\partial_{\mu}n\rangle\right),
  </annotation>
 </semantics>
</math>

</p>

<p>then all parts can be calculated using the Hellmann–Feynman theorems. In terms of Lie derivatives, 

<math display="inline" id="Perturbation_theory_(quantum_mechanics):106">
 <semantics>
  <mrow>
   <mrow>
    <mo stretchy="false">⟨</mo>
    <mrow>
     <msub>
      <mo>∂</mo>
      <mi>μ</mi>
     </msub>
     <mi>n</mi>
    </mrow>
    <mo stretchy="false">|</mo>
    <mi>n</mi>
    <mo stretchy="false">⟩</mo>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mo stretchy="false">⟨</mo>
    <mi>n</mi>
    <mo stretchy="false">|</mo>
    <mrow>
     <msub>
      <mo>∂</mo>
      <mi>μ</mi>
     </msub>
     <mi>n</mi>
    </mrow>
    <mo stretchy="false">⟩</mo>
   </mrow>
   <mo>=</mo>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="latexml">inner-product</csymbol>
      <apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <partialdiff></partialdiff>
        <ci>μ</ci>
       </apply>
       <ci>n</ci>
      </apply>
      <ci>n</ci>
     </apply>
     <apply>
      <csymbol cd="latexml">inner-product</csymbol>
      <ci>n</ci>
      <apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <partialdiff></partialdiff>
        <ci>μ</ci>
       </apply>
       <ci>n</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <cn type="integer">0</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \langle\partial_{\mu}n|n\rangle=\langle n|\partial_{\mu}n\rangle=0
  </annotation>
 </semantics>
</math>

 according to the definition of the connection for the vector bundle. Therefore the case 

<math display="inline" id="Perturbation_theory_(quantum_mechanics):107">
 <semantics>
  <mrow>
   <mi>m</mi>
   <mo>=</mo>
   <mi>n</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>m</ci>
    <ci>n</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   m=n
  </annotation>
 </semantics>
</math>

 can be excluded from the summation, which avoids the singularity of the energy denominator. The same procedure can be carried on for higher order derivatives, from which higher order corrections are obtained.</p>

<p>The same computational scheme is applicable for the correction of states. The result to the second order is as follows</p>

<p>

<math display="inline" id="Perturbation_theory_(quantum_mechanics):108">
 <semantics>
  <mrow>
   <mrow>
    <mo fence="true">|</mo>
    <mrow>
     <mi>n</mi>
     <mrow>
      <mo>(</mo>
      <msup>
       <mi>x</mi>
       <mi>μ</mi>
      </msup>
      <mo>)</mo>
     </mrow>
    </mrow>
    <mo>⟩</mo>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mo fence="true" stretchy="false">|</mo>
    <mi>n</mi>
    <mo stretchy="false">⟩</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="latexml">ket</csymbol>
     <apply>
      <times></times>
      <ci>n</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>x</ci>
       <ci>μ</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <csymbol cd="latexml">ket</csymbol>
     <ci>n</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle\left|n\left(x^{\mu}\right)\right\rangle=|n\rangle
  </annotation>
 </semantics>
</math>


</p>

<p>Both energy derivatives and state derivatives will be involved in deduction. Whenever a state derivative is encountered, resolve it by inserting the complete set of basis, then the Hellmann-Feynman theorem is applicable. Because differentiation can be calculated systematically, the series expansion approach to the perturbative corrections can be coded on computers with symbolic processing software like <a class="uri" href="Mathematica" title="wikilink">Mathematica</a>.</p>
<h4 id="effective-hamiltonian">Effective Hamiltonian</h4>

<p>Let 

<math display="inline" id="Perturbation_theory_(quantum_mechanics):109">
 <semantics>
  <mrow>
   <mi>H</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mn>0</mn>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>H</ci>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   H(0)
  </annotation>
 </semantics>
</math>

 be the Hamiltonian completely restricted either in the low-energy subspace 

<math display="inline" id="Perturbation_theory_(quantum_mechanics):110">
 <semantics>
  <msub>
   <mi class="ltx_font_mathcaligraphic">ℋ</mi>
   <mi>L</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>ℋ</ci>
    <ci>L</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathcal{H}_{L}
  </annotation>
 </semantics>
</math>

 or in the high-energy subspace 

<math display="inline" id="Perturbation_theory_(quantum_mechanics):111">
 <semantics>
  <msub>
   <mi class="ltx_font_mathcaligraphic">ℋ</mi>
   <mi>H</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>ℋ</ci>
    <ci>H</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathcal{H}_{H}
  </annotation>
 </semantics>
</math>


, such that there is no matrix element in 

<math display="inline" id="Perturbation_theory_(quantum_mechanics):112">
 <semantics>
  <mrow>
   <mi>H</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mn>0</mn>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>H</ci>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   H(0)
  </annotation>
 </semantics>
</math>

 connecting the low- and the high-energy subspaces, i.e. 

<math display="inline" id="Perturbation_theory_(quantum_mechanics):113">
 <semantics>
  <mrow>
   <mrow>
    <mo stretchy="false">⟨</mo>
    <mi>m</mi>
    <mo fence="true" stretchy="false">|</mo>
    <mrow>
     <mi>H</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mn>0</mn>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo fence="true" stretchy="false">|</mo>
    <mi>l</mi>
    <mo stretchy="false">⟩</mo>
   </mrow>
   <mo>=</mo>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="latexml">quantum-operator-product</csymbol>
     <ci>m</ci>
     <apply>
      <times></times>
      <ci>H</ci>
      <cn type="integer">0</cn>
     </apply>
     <ci>l</ci>
    </apply>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \langle m|H(0)|l\rangle=0
  </annotation>
 </semantics>
</math>

 if 

<math display="inline" id="Perturbation_theory_(quantum_mechanics):114">
 <semantics>
  <mrow>
   <mrow>
    <mi>m</mi>
    <mo>∈</mo>
    <msub>
     <mi class="ltx_font_mathcaligraphic">ℋ</mi>
     <mi>L</mi>
    </msub>
   </mrow>
   <mo>,</mo>
   <mrow>
    <mi>l</mi>
    <mo>∈</mo>
    <msub>
     <mi class="ltx_font_mathcaligraphic">ℋ</mi>
     <mi>H</mi>
    </msub>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <in></in>
     <ci>m</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>ℋ</ci>
      <ci>L</ci>
     </apply>
    </apply>
    <apply>
     <in></in>
     <ci>l</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>ℋ</ci>
      <ci>H</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   m\in\mathcal{H}_{L},l\in\mathcal{H}_{H}
  </annotation>
 </semantics>
</math>

. Let <mtpl> ∂<sub><em>μ</em></sub><em>H</em>}}</mtpl> be the coupling terms connecting the subspaces. Then when the high energy degrees of freedoms are integrated out, the effective Hamiltonian in the low energy subspace reads</p>

<p>

<math display="block" id="Perturbation_theory_(quantum_mechanics):115">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <msubsup>
      <mi>H</mi>
      <mrow>
       <mi>m</mi>
       <mi>n</mi>
      </mrow>
      <mtext>eff</mtext>
     </msubsup>
     <mrow>
      <mo>(</mo>
      <msup>
       <mi>x</mi>
       <mi>μ</mi>
      </msup>
      <mo>)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mo stretchy="false">⟨</mo>
      <mi>m</mi>
      <mo fence="true" stretchy="false">|</mo>
      <mi>H</mi>
      <mo fence="true" stretchy="false">|</mo>
      <mi>n</mi>
      <mo stretchy="false">⟩</mo>
     </mrow>
     <mo>+</mo>
     <mrow>
      <mrow>
       <mo stretchy="false">⟨</mo>
       <mi>m</mi>
       <mo fence="true" stretchy="false">|</mo>
       <mrow>
        <msub>
         <mo>∂</mo>
         <mi>μ</mi>
        </msub>
        <mi>H</mi>
       </mrow>
       <mo fence="true" stretchy="false">|</mo>
       <mi>n</mi>
       <mo stretchy="false">⟩</mo>
      </mrow>
      <msup>
       <mi>x</mi>
       <mi>μ</mi>
      </msup>
     </mrow>
     <mo>+</mo>
     <mrow>
      <mfrac>
       <mn>1</mn>
       <mrow>
        <mn>2</mn>
        <mo lspace="0pt" rspace="3.5pt">!</mo>
       </mrow>
      </mfrac>
      <mrow>
       <munder>
        <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
        <mrow>
         <mi>l</mi>
         <mo>∈</mo>
         <msub>
          <mi class="ltx_font_mathcaligraphic">ℋ</mi>
          <mi>H</mi>
         </msub>
        </mrow>
       </munder>
       <mrow>
        <mrow>
         <mo>(</mo>
         <mrow>
          <mfrac>
           <mrow>
            <mrow>
             <mo stretchy="false">⟨</mo>
             <mi>m</mi>
             <mo fence="true" stretchy="false">|</mo>
             <mrow>
              <msub>
               <mo>∂</mo>
               <mi>μ</mi>
              </msub>
              <mi>H</mi>
             </mrow>
             <mo fence="true" stretchy="false">|</mo>
             <mi>l</mi>
             <mo stretchy="false">⟩</mo>
            </mrow>
            <mrow>
             <mo stretchy="false">⟨</mo>
             <mi>l</mi>
             <mo fence="true" stretchy="false">|</mo>
             <mrow>
              <msub>
               <mo>∂</mo>
               <mi>ν</mi>
              </msub>
              <mi>H</mi>
             </mrow>
             <mo fence="true" stretchy="false">|</mo>
             <mi>n</mi>
             <mo stretchy="false">⟩</mo>
            </mrow>
           </mrow>
           <mrow>
            <msub>
             <mi>E</mi>
             <mi>m</mi>
            </msub>
            <mo>-</mo>
            <msub>
             <mi>E</mi>
             <mi>l</mi>
            </msub>
           </mrow>
          </mfrac>
          <mo>+</mo>
          <mfrac>
           <mrow>
            <mrow>
             <mo stretchy="false">⟨</mo>
             <mi>m</mi>
             <mo fence="true" stretchy="false">|</mo>
             <mrow>
              <msub>
               <mo>∂</mo>
               <mi>ν</mi>
              </msub>
              <mi>H</mi>
             </mrow>
             <mo fence="true" stretchy="false">|</mo>
             <mi>l</mi>
             <mo stretchy="false">⟩</mo>
            </mrow>
            <mrow>
             <mo stretchy="false">⟨</mo>
             <mi>l</mi>
             <mo fence="true" stretchy="false">|</mo>
             <mrow>
              <msub>
               <mo>∂</mo>
               <mi>μ</mi>
              </msub>
              <mi>H</mi>
             </mrow>
             <mo fence="true" stretchy="false">|</mo>
             <mi>n</mi>
             <mo stretchy="false">⟩</mo>
            </mrow>
           </mrow>
           <mrow>
            <msub>
             <mi>E</mi>
             <mi>n</mi>
            </msub>
            <mo>-</mo>
            <msub>
             <mi>E</mi>
             <mi>l</mi>
            </msub>
           </mrow>
          </mfrac>
         </mrow>
         <mo>)</mo>
        </mrow>
        <msup>
         <mi>x</mi>
         <mi>μ</mi>
        </msup>
        <msup>
         <mi>x</mi>
         <mi>ν</mi>
        </msup>
       </mrow>
      </mrow>
     </mrow>
     <mo>+</mo>
     <mi mathvariant="normal">⋯</mi>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>H</ci>
       <apply>
        <times></times>
        <ci>m</ci>
        <ci>n</ci>
       </apply>
      </apply>
      <mtext>eff</mtext>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>x</ci>
      <ci>μ</ci>
     </apply>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <csymbol cd="latexml">quantum-operator-product</csymbol>
      <ci>m</ci>
      <ci>H</ci>
      <ci>n</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="latexml">quantum-operator-product</csymbol>
       <ci>m</ci>
       <apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <partialdiff></partialdiff>
         <ci>μ</ci>
        </apply>
        <ci>H</ci>
       </apply>
       <ci>n</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>x</ci>
       <ci>μ</ci>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <apply>
        <factorial></factorial>
        <cn type="integer">2</cn>
       </apply>
      </apply>
      <apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <apply>
         <in></in>
         <ci>l</ci>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>ℋ</ci>
          <ci>H</ci>
         </apply>
        </apply>
       </apply>
       <apply>
        <times></times>
        <apply>
         <plus></plus>
         <apply>
          <divide></divide>
          <apply>
           <times></times>
           <apply>
            <csymbol cd="latexml">quantum-operator-product</csymbol>
            <ci>m</ci>
            <apply>
             <apply>
              <csymbol cd="ambiguous">subscript</csymbol>
              <partialdiff></partialdiff>
              <ci>μ</ci>
             </apply>
             <ci>H</ci>
            </apply>
            <ci>l</ci>
           </apply>
           <apply>
            <csymbol cd="latexml">quantum-operator-product</csymbol>
            <ci>l</ci>
            <apply>
             <apply>
              <csymbol cd="ambiguous">subscript</csymbol>
              <partialdiff></partialdiff>
              <ci>ν</ci>
             </apply>
             <ci>H</ci>
            </apply>
            <ci>n</ci>
           </apply>
          </apply>
          <apply>
           <minus></minus>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <ci>E</ci>
            <ci>m</ci>
           </apply>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <ci>E</ci>
            <ci>l</ci>
           </apply>
          </apply>
         </apply>
         <apply>
          <divide></divide>
          <apply>
           <times></times>
           <apply>
            <csymbol cd="latexml">quantum-operator-product</csymbol>
            <ci>m</ci>
            <apply>
             <apply>
              <csymbol cd="ambiguous">subscript</csymbol>
              <partialdiff></partialdiff>
              <ci>ν</ci>
             </apply>
             <ci>H</ci>
            </apply>
            <ci>l</ci>
           </apply>
           <apply>
            <csymbol cd="latexml">quantum-operator-product</csymbol>
            <ci>l</ci>
            <apply>
             <apply>
              <csymbol cd="ambiguous">subscript</csymbol>
              <partialdiff></partialdiff>
              <ci>μ</ci>
             </apply>
             <ci>H</ci>
            </apply>
            <ci>n</ci>
           </apply>
          </apply>
          <apply>
           <minus></minus>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <ci>E</ci>
            <ci>n</ci>
           </apply>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <ci>E</ci>
            <ci>l</ci>
           </apply>
          </apply>
         </apply>
        </apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>x</ci>
         <ci>μ</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>x</ci>
         <ci>ν</ci>
        </apply>
       </apply>
      </apply>
     </apply>
     <ci>normal-⋯</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   H_{mn}^{\text{eff}}\left(x^{\mu}\right)=\langle m|H|n\rangle+\langle m|%
\partial_{\mu}H|n\rangle x^{\mu}+\frac{1}{2!}\sum_{l\in\mathcal{H}_{H}}\left(%
\frac{\langle m|\partial_{\mu}H|l\rangle\langle l|\partial_{\nu}H|n\rangle}{E_%
{m}-E_{l}}+\frac{\langle m|\partial_{\nu}H|l\rangle\langle l|\partial_{\mu}H|n%
\rangle}{E_{n}-E_{l}}\right)x^{\mu}x^{\nu}+\cdots.
  </annotation>
 </semantics>
</math>

</p>

<p>Here 

<math display="inline" id="Perturbation_theory_(quantum_mechanics):116">
 <semantics>
  <mrow>
   <mrow>
    <mi>m</mi>
    <mo>,</mo>
    <mi>n</mi>
   </mrow>
   <mo>∈</mo>
   <msub>
    <mi class="ltx_font_mathcaligraphic">ℋ</mi>
    <mi>L</mi>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <in></in>
    <list>
     <ci>m</ci>
     <ci>n</ci>
    </list>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>ℋ</ci>
     <ci>L</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   m,n\in\mathcal{H}_{L}
  </annotation>
 </semantics>
</math>


 are restricted in the low energy subspace. The above result can be derived by power series expansion of 

<math display="inline" id="Perturbation_theory_(quantum_mechanics):117">
 <semantics>
  <mrow>
   <mo stretchy="false">⟨</mo>
   <mi>m</mi>
   <mo fence="true" stretchy="false">|</mo>
   <mrow>
    <mi>H</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <msup>
      <mi>x</mi>
      <mi>μ</mi>
     </msup>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo fence="true" stretchy="false">|</mo>
   <mi>n</mi>
   <mo stretchy="false">⟩</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">quantum-operator-product</csymbol>
    <ci>m</ci>
    <apply>
     <times></times>
     <ci>H</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>x</ci>
      <ci>μ</ci>
     </apply>
    </apply>
    <ci>n</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \langle m|H(x^{\mu})|n\rangle
  </annotation>
 </semantics>
</math>

.</p>

<p>In a formal way it is possible to define an effective Hamiltonian that gives exactly the low-lying energy states and wavefunctions.<a class="footnoteRef" href="#fn6" id="fnref6"><sup>6</sup></a> In practice, some kind of approximation (perturbation theory) is generally required.</p>
<h2 id="time-dependent-perturbation-theory">Time-dependent perturbation theory</h2>
<h3 id="method-of-variation-of-constants">Method of variation of constants</h3>

<p>Time-dependent perturbation theory, developed by <a href="Paul_Dirac" title="wikilink">Paul Dirac</a>, studies the effect of a time-dependent perturbation 

<math display="inline" id="Perturbation_theory_(quantum_mechanics):118">
 <semantics>
  <mrow>
   <mi>V</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>t</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>V</ci>
    <ci>t</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   V(t)
  </annotation>
 </semantics>
</math>

 applied to a time-independent Hamiltonian 

<math display="inline" id="Perturbation_theory_(quantum_mechanics):119">
 <semantics>
  <mi>H</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>H</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   H
  </annotation>
 </semantics>
</math>

<sub>0</sub>.</p>

<p>Since the perturbed Hamiltonian is time-dependent, so are its energy levels and eigenstates. Thus, the goals of time-dependent perturbation theory are slightly different from time-independent perturbation theory. One is interested in the following quantities:</p>
<ul>
<li>The time-dependent <a href="expectation_value" title="wikilink">expectation value</a> of some observable 

<math display="inline" id="Perturbation_theory_(quantum_mechanics):120">
 <semantics>
  <mi>A</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>A</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A
  </annotation>
 </semantics>
</math>

, for a given initial state.</li>
<li>The time-dependent amplitudes of those quantum states that are energy eigenkets (eigenvectors) in the unperturbed system.</li>
</ul>

<p>The first quantity is important because it gives rise to the <a href="classical_mechanics" title="wikilink">classical</a> result of an 

<math display="inline" id="Perturbation_theory_(quantum_mechanics):121">
 <semantics>
  <mi>A</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>A</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A
  </annotation>
 </semantics>
</math>


 measurement performed on a macroscopic number of copies of the perturbed system. For example, we could take 

<math display="inline" id="Perturbation_theory_(quantum_mechanics):122">
 <semantics>
  <mi>A</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>A</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A
  </annotation>
 </semantics>
</math>

 to be the displacement in the 

<math display="inline" id="Perturbation_theory_(quantum_mechanics):123">
 <semantics>
  <mi>x</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>x</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x
  </annotation>
 </semantics>
</math>

-direction of the electron in a hydrogen atom, in which case the expected value, when multiplied by an appropriate coefficient, gives the time-dependent <a href="dielectric_polarization" title="wikilink">dielectric polarization</a> of a hydrogen gas. With an appropriate choice of perturbation (i.e. an oscillating electric potential), this allows one to calculate the AC <a class="uri" href="permittivity" title="wikilink">permittivity</a> of the gas.</p>

<p>The second quantity looks at the time-dependent probability of occupation for each eigenstate. This is particularly useful in <a class="uri" href="laser" title="wikilink">laser</a> physics, where one is interested in the populations of different atomic states in a gas when a time-dependent electric field is applied. These probabilities are also useful for calculating the "quantum broadening" of <a href="spectral_line" title="wikilink">spectral lines</a> (see <a href="line_broadening" title="wikilink">line broadening</a>) and <a href="particle_decay" title="wikilink">particle decay</a> in <a href="particle_physics" title="wikilink">particle physics</a> and <a href="nuclear_physics" title="wikilink">nuclear physics</a>.</p>

<p>We will briefly examine the method behind Dirac's formulation of time-dependent perturbation theory. Choose an energy basis 

<math display="inline" id="Perturbation_theory_(quantum_mechanics):124">
 <semantics>
  <mrow>
   <mo fence="true" stretchy="false">|</mo>
   <mi>n</mi>
   <mo stretchy="false">⟩</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">ket</csymbol>
    <ci>n</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   {|n\rangle}
  </annotation>
 </semantics>
</math>

 for the unperturbed system. (We drop the (0) superscripts for the eigenstates, because it is not useful to speak of energy levels and eigenstates for the perturbed system.)</p>

<p>If the unperturbed system is in eigenstate 

<math display="inline" id="Perturbation_theory_(quantum_mechanics):125">
 <semantics>
  <mrow>
   <mo fence="true" stretchy="false">|</mo>
   <mi>j</mi>
   <mo stretchy="false">⟩</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">ket</csymbol>
    <ci>j</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   |j\rangle
  </annotation>
 </semantics>
</math>

 at time 

<math display="inline" id="Perturbation_theory_(quantum_mechanics):126">
 <semantics>
  <mi>t</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>t</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   t
  </annotation>
 </semantics>
</math>


 = 0, its state at subsequent times varies only by a <a href="phase_(waves)" title="wikilink">phase</a> (in the <a href="Schrödinger_picture" title="wikilink">Schrödinger picture</a>, where state vectors evolve in time and operators are constant),</p>

<p>

<math display="block" id="Perturbation_theory_(quantum_mechanics):127">
 <semantics>
  <mrow>
   <mo stretchy="false">|</mo>
   <mi>j</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>t</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <merror class="ltx_ERROR undefined undefined">
    <mtext>\rang</mtext>
   </merror>
   <mo>=</mo>
   <msup>
    <mi>e</mi>
    <mrow>
     <mo>-</mo>
     <mrow>
      <mrow>
       <mi>i</mi>
       <msub>
        <mi>E</mi>
        <mi>j</mi>
       </msub>
       <mi>t</mi>
      </mrow>
      <mo>/</mo>
      <mi mathvariant="normal">ℏ</mi>
     </mrow>
    </mrow>
   </msup>
   <mo stretchy="false">|</mo>
   <mi>j</mi>
   <merror class="ltx_ERROR undefined undefined">
    <mtext>\rang</mtext>
   </merror>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <ci>normal-|</ci>
    <csymbol cd="unknown">j</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">t</csymbol>
     <ci>normal-)</ci>
    </cerror>
    <mtext>\rang</mtext>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>e</ci>
     <apply>
      <minus></minus>
      <apply>
       <divide></divide>
       <apply>
        <times></times>
        <ci>i</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>E</ci>
         <ci>j</ci>
        </apply>
        <ci>t</ci>
       </apply>
       <csymbol cd="latexml">Planck-constant-over-2-pi</csymbol>
      </apply>
     </apply>
    </apply>
    <ci>normal-|</ci>
    <csymbol cd="unknown">j</csymbol>
    <mtext>\rang</mtext>
    <ci>normal-.</ci>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   |j(t)\rang=e^{-iE_{j}t/\hbar}|j\rang~{}.
  </annotation>
 </semantics>
</math>

</p>

<p>Now, introduce a time-dependent perturbing Hamiltonian 

<math display="inline" id="Perturbation_theory_(quantum_mechanics):128">
 <semantics>
  <mrow>
   <mi>V</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>t</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>V</ci>
    <ci>t</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   V(t)
  </annotation>
 </semantics>
</math>

. The Hamiltonian of the perturbed system is</p>

<p>

<math display="block" id="Perturbation_theory_(quantum_mechanics):129">
 <semantics>
  <mrow>
   <mrow>
    <mi>H</mi>
    <mo>=</mo>
    <mrow>
     <msub>
      <mi>H</mi>
      <mn>0</mn>
     </msub>
     <mo>+</mo>
     <mrow>
      <mi>V</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>t</mi>
       <mo rspace="5.8pt" stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>H</ci>
    <apply>
     <plus></plus>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>H</ci>
      <cn type="integer">0</cn>
     </apply>
     <apply>
      <times></times>
      <ci>V</ci>
      <ci>t</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   H=H_{0}+V(t)~{}.
  </annotation>
 </semantics>
</math>

 Let 

<math display="inline" id="Perturbation_theory_(quantum_mechanics):130">
 <semantics>
  <mrow>
   <mo stretchy="false">|</mo>
   <mi>ψ</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>t</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <merror class="ltx_ERROR undefined undefined">
    <mtext>\rang</mtext>
   </merror>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <ci>normal-|</ci>
    <csymbol cd="unknown">ψ</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">t</csymbol>
     <ci>normal-)</ci>
    </cerror>
    <mtext>\rang</mtext>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   |\psi(t)\rang
  </annotation>
 </semantics>
</math>

 denote the quantum state of the perturbed system at time 

<math display="inline" id="Perturbation_theory_(quantum_mechanics):131">
 <semantics>
  <mi>t</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>t</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   t
  </annotation>
 </semantics>
</math>


. It obeys the time-dependent Schrödinger equation,</p>

<p>

<math display="block" id="Perturbation_theory_(quantum_mechanics):132">
 <semantics>
  <mrow>
   <mi>H</mi>
   <mo stretchy="false">|</mo>
   <mi>ψ</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>t</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <merror class="ltx_ERROR undefined undefined">
    <mtext>\rang</mtext>
   </merror>
   <mo>=</mo>
   <mi>i</mi>
   <mi mathvariant="normal">ℏ</mi>
   <mfrac>
    <mo>∂</mo>
    <mrow>
     <mo>∂</mo>
     <mi>t</mi>
    </mrow>
   </mfrac>
   <mo stretchy="false">|</mo>
   <mi>ψ</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>t</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <merror class="ltx_ERROR undefined undefined">
    <mtext>\rang</mtext>
   </merror>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">H</csymbol>
    <ci>normal-|</ci>
    <csymbol cd="unknown">ψ</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">t</csymbol>
     <ci>normal-)</ci>
    </cerror>
    <mtext>\rang</mtext>
    <eq></eq>
    <csymbol cd="unknown">i</csymbol>
    <csymbol cd="latexml">Planck-constant-over-2-pi</csymbol>
    <apply>
     <divide></divide>
     <partialdiff></partialdiff>
     <apply>
      <partialdiff></partialdiff>
      <ci>t</ci>
     </apply>
    </apply>
    <ci>normal-|</ci>
    <csymbol cd="unknown">ψ</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">t</csymbol>
     <ci>normal-)</ci>
    </cerror>
    <mtext>\rang</mtext>
    <ci>normal-.</ci>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   H|\psi(t)\rang=i\hbar\frac{\partial}{\partial t}|\psi(t)\rang~{}.
  </annotation>
 </semantics>
</math>

</p>

<p>The quantum state at each instant can be expressed as a linear combination of the complete eigenbasis of 

<math display="inline" id="Perturbation_theory_(quantum_mechanics):133">
 <semantics>
  <mrow>
   <mo stretchy="false">|</mo>
   <mi>n</mi>
   <merror class="ltx_ERROR undefined undefined">
    <mtext>\rang</mtext>
   </merror>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <ci>normal-|</ci>
    <csymbol cd="unknown">n</csymbol>
    <mtext>\rang</mtext>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   |n\rang
  </annotation>
 </semantics>
</math>

:</p>

<p>

<math display="block" id="Perturbation_theory_(quantum_mechanics):134">
 <semantics>
  <mrow>
   <mo stretchy="false">|</mo>
   <mi>ψ</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>t</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <merror class="ltx_ERROR undefined undefined">
    <mtext>\rang</mtext>
   </merror>
   <mo>=</mo>
   <munder>
    <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
    <mi>n</mi>
   </munder>
   <msub>
    <mi>c</mi>
    <mi>n</mi>
   </msub>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>t</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <msup>
    <mi>e</mi>
    <mrow>
     <mo>-</mo>
     <mrow>
      <mrow>
       <mi>i</mi>
       <msub>
        <mi>E</mi>
        <mi>n</mi>
       </msub>
       <mi>t</mi>
      </mrow>
      <mo>/</mo>
      <mi mathvariant="normal">ℏ</mi>
     </mrow>
    </mrow>
   </msup>
   <mo stretchy="false">|</mo>
   <mi>n</mi>
   <merror class="ltx_ERROR undefined undefined">
    <mtext>\rang</mtext>
   </merror>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <ci>normal-|</ci>
    <csymbol cd="unknown">ψ</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">t</csymbol>
     <ci>normal-)</ci>
    </cerror>
    <mtext>\rang</mtext>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <sum></sum>
     <ci>n</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>c</ci>
     <ci>n</ci>
    </apply>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">t</csymbol>
     <ci>normal-)</ci>
    </cerror>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>e</ci>
     <apply>
      <minus></minus>
      <apply>
       <divide></divide>
       <apply>
        <times></times>
        <ci>i</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>E</ci>
         <ci>n</ci>
        </apply>
        <ci>t</ci>
       </apply>
       <csymbol cd="latexml">Planck-constant-over-2-pi</csymbol>
      </apply>
     </apply>
    </apply>
    <ci>normal-|</ci>
    <csymbol cd="unknown">n</csymbol>
    <mtext>\rang</mtext>
    <ci>normal-,</ci>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   |\psi(t)\rang=\sum_{n}c_{n}(t)e^{-iE_{n}t/\hbar}|n\rang~{},
  </annotation>
 </semantics>
</math>

 where the <mtpl></mtpl>s are to be determined <a href="complex_number" title="wikilink">complex</a> functions of 

<math display="inline" id="Perturbation_theory_(quantum_mechanics):135">
 <semantics>
  <mi>t</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>t</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   t
  </annotation>
 </semantics>
</math>

 which we will refer to as <strong>amplitudes</strong> (strictly speaking, they are the amplitudes in the <a href="Dirac_picture" title="wikilink">Dirac picture</a>).</p>

<p>We have explicitly extracted the exponential phase factors 

<math display="inline" id="Perturbation_theory_(quantum_mechanics):136">
 <semantics>
  <mrow>
   <mi>exp</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mrow>
     <mo>-</mo>
     <mrow>
      <mrow>
       <mi>i</mi>
       <msub>
        <mi>E</mi>
        <mi>n</mi>
       </msub>
       <mi>t</mi>
      </mrow>
      <mo>/</mo>
      <mi mathvariant="normal">ℏ</mi>
     </mrow>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <exp></exp>
    <apply>
     <minus></minus>
     <apply>
      <divide></divide>
      <apply>
       <times></times>
       <ci>i</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>E</ci>
        <ci>n</ci>
       </apply>
       <ci>t</ci>
      </apply>
      <csymbol cd="latexml">Planck-constant-over-2-pi</csymbol>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \exp(-iE_{n}t/\hbar)
  </annotation>
 </semantics>
</math>


 on the right hand side. This is only a matter of convention, and may be done without loss of generality. The reason we go to this trouble is that when the system starts in the state 

<math display="inline" id="Perturbation_theory_(quantum_mechanics):137">
 <semantics>
  <mrow>
   <mo stretchy="false">|</mo>
   <mi>j</mi>
   <merror class="ltx_ERROR undefined undefined">
    <mtext>\rang</mtext>
   </merror>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <ci>normal-|</ci>
    <csymbol cd="unknown">j</csymbol>
    <mtext>\rang</mtext>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   |j\rang
  </annotation>
 </semantics>
</math>

 and no perturbation is present, the amplitudes have the convenient property that, for all 

<math display="inline" id="Perturbation_theory_(quantum_mechanics):138">
 <semantics>
  <mi>t</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>t</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   t
  </annotation>
 </semantics>
</math>

, <mtpl></mtpl> = 1 and <mtpl></mtpl> = 0 if 

<math display="inline" id="Perturbation_theory_(quantum_mechanics):139">
 <semantics>
  <mrow>
   <mi>n</mi>
   <mi mathvariant="normal">≠</mi>
   <mi>j</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>n</ci>
    <ci>normal-≠</ci>
    <ci>j</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n≠j
  </annotation>
 </semantics>
</math>

.</p>

<p>The square of the absolute amplitude <mtpl></mtpl> is the probability that the system is in state 

<math display="inline" id="Perturbation_theory_(quantum_mechanics):140">
 <semantics>
  <mi>n</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>n</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n
  </annotation>
 </semantics>
</math>

 at time 

<math display="inline" id="Perturbation_theory_(quantum_mechanics):141">
 <semantics>
  <mi>t</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>t</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   t
  </annotation>
 </semantics>
</math>


, since</p>

<p>

<math display="block" id="Perturbation_theory_(quantum_mechanics):142">
 <semantics>
  <mrow>
   <mo>|</mo>
   <msub>
    <mi>c</mi>
    <mi>n</mi>
   </msub>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>t</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <msup>
    <mo>|</mo>
    <mn>2</mn>
   </msup>
   <mo>=</mo>
   <mo>|</mo>
   <merror class="ltx_ERROR undefined undefined">
    <mtext>\lang</mtext>
   </merror>
   <mi>n</mi>
   <mo stretchy="false">|</mo>
   <mi>ψ</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>t</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <merror class="ltx_ERROR undefined undefined">
    <mtext>\rang</mtext>
   </merror>
   <mpadded width="+3.3pt">
    <msup>
     <mo>|</mo>
     <mn>2</mn>
    </msup>
   </mpadded>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <ci>normal-|</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>c</ci>
     <ci>n</ci>
    </apply>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">t</csymbol>
     <ci>normal-)</ci>
    </cerror>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>normal-|</ci>
     <cn type="integer">2</cn>
    </apply>
    <eq></eq>
    <ci>normal-|</ci>
    <mtext>\lang</mtext>
    <csymbol cd="unknown">n</csymbol>
    <ci>normal-|</ci>
    <csymbol cd="unknown">ψ</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">t</csymbol>
     <ci>normal-)</ci>
    </cerror>
    <mtext>\rang</mtext>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>normal-|</ci>
     <cn type="integer">2</cn>
    </apply>
    <ci>normal-.</ci>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \left|c_{n}(t)\right|^{2}=\left|\lang n|\psi(t)\rang\right|^{2}~{}.
  </annotation>
 </semantics>
</math>

</p>

<p>Plugging into the Schrödinger equation and using the fact that ∂/∂<em>t</em> acts by a <a href="chain_rule" title="wikilink">chain rule</a>, one obtains</p>

<p>

<math display="block" id="Perturbation_theory_(quantum_mechanics):143">
 <semantics>
  <mrow>
   <munder>
    <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
    <mi>n</mi>
   </munder>
   <mrow>
    <mo>(</mo>
    <mi>i</mi>
    <mi mathvariant="normal">ℏ</mi>
    <mfrac>
     <mrow>
      <mo>∂</mo>
      <msub>
       <mi>c</mi>
       <mi>n</mi>
      </msub>
     </mrow>
     <mrow>
      <mo>∂</mo>
      <mi>t</mi>
     </mrow>
    </mfrac>
    <mo>-</mo>
    <msub>
     <mi>c</mi>
     <mi>n</mi>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>t</mi>
     <mo stretchy="false">)</mo>
    </mrow>
    <mi>V</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>t</mi>
     <mo stretchy="false">)</mo>
    </mrow>
    <mo>)</mo>
   </mrow>
   <msup>
    <mi>e</mi>
    <mrow>
     <mo>-</mo>
     <mrow>
      <mrow>
       <mi>i</mi>
       <msub>
        <mi>E</mi>
        <mi>n</mi>
       </msub>
       <mi>t</mi>
      </mrow>
      <mo>/</mo>
      <mi mathvariant="normal">ℏ</mi>
     </mrow>
    </mrow>
   </msup>
   <mo stretchy="false">|</mo>
   <mi>n</mi>
   <merror class="ltx_ERROR undefined undefined">
    <mtext>\rang</mtext>
   </merror>
   <mo>=</mo>
   <mpadded width="+3.3pt">
    <mn>0</mn>
   </mpadded>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <sum></sum>
     <ci>n</ci>
    </apply>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">i</csymbol>
     <csymbol cd="latexml">Planck-constant-over-2-pi</csymbol>
     <apply>
      <divide></divide>
      <apply>
       <partialdiff></partialdiff>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>c</ci>
        <ci>n</ci>
       </apply>
      </apply>
      <apply>
       <partialdiff></partialdiff>
       <ci>t</ci>
      </apply>
     </apply>
     <minus></minus>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>c</ci>
      <ci>n</ci>
     </apply>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <ci>normal-(</ci>
      <csymbol cd="unknown">t</csymbol>
      <ci>normal-)</ci>
     </cerror>
     <csymbol cd="unknown">V</csymbol>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <ci>normal-(</ci>
      <csymbol cd="unknown">t</csymbol>
      <ci>normal-)</ci>
     </cerror>
     <ci>normal-)</ci>
    </cerror>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>e</ci>
     <apply>
      <minus></minus>
      <apply>
       <divide></divide>
       <apply>
        <times></times>
        <ci>i</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>E</ci>
         <ci>n</ci>
        </apply>
        <ci>t</ci>
       </apply>
       <csymbol cd="latexml">Planck-constant-over-2-pi</csymbol>
      </apply>
     </apply>
    </apply>
    <ci>normal-|</ci>
    <csymbol cd="unknown">n</csymbol>
    <mtext>\rang</mtext>
    <eq></eq>
    <cn type="integer">0</cn>
    <ci>normal-.</ci>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \sum_{n}\left(i\hbar\frac{\partial c_{n}}{\partial t}-c_{n}(t)V(t)\right)e^{-%
iE_{n}t/\hbar}|n\rang=0~{}.
  </annotation>
 </semantics>
</math>

</p>

<p>By resolving the identity in front of 

<math display="inline" id="Perturbation_theory_(quantum_mechanics):144">
 <semantics>
  <mi>V</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>V</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   V
  </annotation>
 </semantics>
</math>

, this can be reduced to a set of <a href="partial_differential_equation" title="wikilink">partial differential equations</a> for the amplitudes,</p>

<p>

<math display="block" id="Perturbation_theory_(quantum_mechanics):145">
 <semantics>
  <mrow>
   <mrow>
    <mfrac>
     <mrow>
      <mo>∂</mo>
      <msub>
       <mi>c</mi>
       <mi>n</mi>
      </msub>
     </mrow>
     <mrow>
      <mo>∂</mo>
      <mi>t</mi>
     </mrow>
    </mfrac>
    <mo>=</mo>
    <mrow>
     <mfrac>
      <mrow>
       <mo>-</mo>
       <mi>i</mi>
      </mrow>
      <mi mathvariant="normal">ℏ</mi>
     </mfrac>
     <mrow>
      <munder>
       <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
       <mi>k</mi>
      </munder>
      <mrow>
       <merror class="ltx_ERROR undefined undefined">
        <mtext>\lang</mtext>
       </merror>
       <mi>n</mi>
       <mrow>
        <mo stretchy="false">|</mo>
        <mrow>
         <mi>V</mi>
         <mrow>
          <mo stretchy="false">(</mo>
          <mi>t</mi>
          <mo stretchy="false">)</mo>
         </mrow>
        </mrow>
        <mo stretchy="false">|</mo>
       </mrow>
       <mi>k</mi>
       <merror class="ltx_ERROR undefined undefined">
        <mtext>\rang</mtext>
       </merror>
       <msub>
        <mi>c</mi>
        <mi>k</mi>
       </msub>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>t</mi>
        <mo rspace="4.2pt" stretchy="false">)</mo>
       </mrow>
       <mpadded width="+3.3pt">
        <msup>
         <mi>e</mi>
         <mrow>
          <mo>-</mo>
          <mrow>
           <mrow>
            <mi>i</mi>
            <mrow>
             <mo stretchy="false">(</mo>
             <mrow>
              <msub>
               <mi>E</mi>
               <mi>k</mi>
              </msub>
              <mo>-</mo>
              <msub>
               <mi>E</mi>
               <mi>n</mi>
              </msub>
             </mrow>
             <mo stretchy="false">)</mo>
            </mrow>
            <mi>t</mi>
           </mrow>
           <mo>/</mo>
           <mi mathvariant="normal">ℏ</mi>
          </mrow>
         </mrow>
        </msup>
       </mpadded>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <divide></divide>
     <apply>
      <partialdiff></partialdiff>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>c</ci>
       <ci>n</ci>
      </apply>
     </apply>
     <apply>
      <partialdiff></partialdiff>
      <ci>t</ci>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <divide></divide>
      <apply>
       <minus></minus>
       <ci>i</ci>
      </apply>
      <csymbol cd="latexml">Planck-constant-over-2-pi</csymbol>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <ci>k</ci>
      </apply>
      <apply>
       <times></times>
       <mtext>\lang</mtext>
       <ci>n</ci>
       <apply>
        <abs></abs>
        <apply>
         <times></times>
         <ci>V</ci>
         <ci>t</ci>
        </apply>
       </apply>
       <ci>k</ci>
       <mtext>\rang</mtext>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>c</ci>
        <ci>k</ci>
       </apply>
       <ci>t</ci>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>e</ci>
        <apply>
         <minus></minus>
         <apply>
          <divide></divide>
          <apply>
           <times></times>
           <ci>i</ci>
           <apply>
            <minus></minus>
            <apply>
             <csymbol cd="ambiguous">subscript</csymbol>
             <ci>E</ci>
             <ci>k</ci>
            </apply>
            <apply>
             <csymbol cd="ambiguous">subscript</csymbol>
             <ci>E</ci>
             <ci>n</ci>
            </apply>
           </apply>
           <ci>t</ci>
          </apply>
          <csymbol cd="latexml">Planck-constant-over-2-pi</csymbol>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \frac{\partial c_{n}}{\partial t}=\frac{-i}{\hbar}\sum_{k}\lang n|V(t)|k\rang%
\,c_{k}(t)\,e^{-i(E_{k}-E_{n})t/\hbar}~{}.
  </annotation>
 </semantics>
</math>

</p>

<p>The matrix elements of 

<math display="inline" id="Perturbation_theory_(quantum_mechanics):146">
 <semantics>
  <mi>V</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>V</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   V
  </annotation>
 </semantics>
</math>


 play a similar role as in time-independent perturbation theory, being proportional to the rate at which amplitudes are shifted between states. Note, however, that the direction of the shift is modified by the exponential phase factor. Over times much longer than the energy difference <mtpl></mtpl>, the phase winds around 0 several times. If the time-dependence of 

<math display="inline" id="Perturbation_theory_(quantum_mechanics):147">
 <semantics>
  <mi>V</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>V</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   V
  </annotation>
 </semantics>
</math>

 is sufficiently slow, this may cause the state amplitudes to oscillate. ( E.g., such oscillations are useful for managing radiative transitions in a <a class="uri" href="laser" title="wikilink">laser</a>.)</p>

<p>Up to this point, we have made no approximations, so this set of differential equations is exact. By supplying appropriate initial values <mtpl></mtpl>, we could in principle find an exact (i.e., non-perturbative) solution. This is easily done when there are only two energy levels (

<math display="inline" id="Perturbation_theory_(quantum_mechanics):148">
 <semantics>
  <mi>n</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>n</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n
  </annotation>
 </semantics>
</math>

 = 1, 2), and this solution is useful for modelling systems like the <a class="uri" href="ammonia" title="wikilink">ammonia</a> molecule.</p>

<p>However, exact solutions are difficult to find when there are many energy levels, and one instead looks for perturbative solutions. These may be obtained by expressing the equations in an integral form,</p>

<p>

<math display="block" id="Perturbation_theory_(quantum_mechanics):149">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <msub>
      <mi>c</mi>
      <mi>n</mi>
     </msub>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>t</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mrow>
      <msub>
       <mi>c</mi>
       <mi>n</mi>
      </msub>
      <mrow>
       <mo stretchy="false">(</mo>
       <mn>0</mn>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo>+</mo>
     <mrow>
      <mfrac>
       <mrow>
        <mo>-</mo>
        <mi>i</mi>
       </mrow>
       <mi mathvariant="normal">ℏ</mi>
      </mfrac>
      <mrow>
       <munder>
        <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
        <mi>k</mi>
       </munder>
       <mrow>
        <msubsup>
         <mo largeop="true" symmetric="true">∫</mo>
         <mn>0</mn>
         <mi>t</mi>
        </msubsup>
        <mrow>
         <mi>d</mi>
         <mpadded width="+2.8pt">
          <msup>
           <mi>t</mi>
           <mo>′</mo>
          </msup>
         </mpadded>
         <merror class="ltx_ERROR undefined undefined">
          <mtext>\lang</mtext>
         </merror>
         <mi>n</mi>
         <mrow>
          <mo stretchy="false">|</mo>
          <mrow>
           <mi>V</mi>
           <mrow>
            <mo stretchy="false">(</mo>
            <msup>
             <mi>t</mi>
             <mo>′</mo>
            </msup>
            <mo stretchy="false">)</mo>
           </mrow>
          </mrow>
          <mo stretchy="false">|</mo>
         </mrow>
         <mi>k</mi>
         <merror class="ltx_ERROR undefined undefined">
          <mtext>\rang</mtext>
         </merror>
         <msub>
          <mi>c</mi>
          <mi>k</mi>
         </msub>
         <mrow>
          <mo stretchy="false">(</mo>
          <msup>
           <mi>t</mi>
           <mo>′</mo>
          </msup>
          <mo rspace="4.2pt" stretchy="false">)</mo>
         </mrow>
         <mpadded width="+3.3pt">
          <msup>
           <mi>e</mi>
           <mrow>
            <mo>-</mo>
            <mrow>
             <mrow>
              <mi>i</mi>
              <mrow>
               <mo stretchy="false">(</mo>
               <mrow>
                <msub>
                 <mi>E</mi>
                 <mi>k</mi>
                </msub>
                <mo>-</mo>
                <msub>
                 <mi>E</mi>
                 <mi>n</mi>
                </msub>
               </mrow>
               <mo stretchy="false">)</mo>
              </mrow>
              <msup>
               <mi>t</mi>
               <mo>′</mo>
              </msup>
             </mrow>
             <mo>/</mo>
             <mi mathvariant="normal">ℏ</mi>
            </mrow>
           </mrow>
          </msup>
         </mpadded>
        </mrow>
       </mrow>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>c</ci>
      <ci>n</ci>
     </apply>
     <ci>t</ci>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>c</ci>
       <ci>n</ci>
      </apply>
      <cn type="integer">0</cn>
     </apply>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <apply>
        <minus></minus>
        <ci>i</ci>
       </apply>
       <csymbol cd="latexml">Planck-constant-over-2-pi</csymbol>
      </apply>
      <apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <ci>k</ci>
       </apply>
       <apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <int></int>
          <cn type="integer">0</cn>
         </apply>
         <ci>t</ci>
        </apply>
        <apply>
         <times></times>
         <ci>d</ci>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>t</ci>
          <ci>normal-′</ci>
         </apply>
         <mtext>\lang</mtext>
         <ci>n</ci>
         <apply>
          <abs></abs>
          <apply>
           <times></times>
           <ci>V</ci>
           <apply>
            <csymbol cd="ambiguous">superscript</csymbol>
            <ci>t</ci>
            <ci>normal-′</ci>
           </apply>
          </apply>
         </apply>
         <ci>k</ci>
         <mtext>\rang</mtext>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>c</ci>
          <ci>k</ci>
         </apply>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>t</ci>
          <ci>normal-′</ci>
         </apply>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>e</ci>
          <apply>
           <minus></minus>
           <apply>
            <divide></divide>
            <apply>
             <times></times>
             <ci>i</ci>
             <apply>
              <minus></minus>
              <apply>
               <csymbol cd="ambiguous">subscript</csymbol>
               <ci>E</ci>
               <ci>k</ci>
              </apply>
              <apply>
               <csymbol cd="ambiguous">subscript</csymbol>
               <ci>E</ci>
               <ci>n</ci>
              </apply>
             </apply>
             <apply>
              <csymbol cd="ambiguous">superscript</csymbol>
              <ci>t</ci>
              <ci>normal-′</ci>
             </apply>
            </apply>
            <csymbol cd="latexml">Planck-constant-over-2-pi</csymbol>
           </apply>
          </apply>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   c_{n}(t)=c_{n}(0)+\frac{-i}{\hbar}\sum_{k}\int_{0}^{t}dt^{\prime}\;\lang n|V(t%
^{\prime})|k\rang\,c_{k}(t^{\prime})\,e^{-i(E_{k}-E_{n})t^{\prime}/\hbar}~{}.
  </annotation>
 </semantics>
</math>

</p>

<p>Repeatedly substituting this expression for <mtpl></mtpl> back into right hand side, yields an iterative solution,</p>

<p>

<math display="block" id="Perturbation_theory_(quantum_mechanics):150">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>c</mi>
     <mi>n</mi>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>t</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <msubsup>
     <mi>c</mi>
     <mi>n</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mn>0</mn>
      <mo stretchy="false">)</mo>
     </mrow>
    </msubsup>
    <mo>+</mo>
    <msubsup>
     <mi>c</mi>
     <mi>n</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mn>1</mn>
      <mo stretchy="false">)</mo>
     </mrow>
    </msubsup>
    <mo>+</mo>
    <msubsup>
     <mi>c</mi>
     <mi>n</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mn>2</mn>
      <mo stretchy="false">)</mo>
     </mrow>
    </msubsup>
    <mo>+</mo>
    <mi mathvariant="normal">⋯</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>c</ci>
      <ci>n</ci>
     </apply>
     <ci>t</ci>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>c</ci>
       <ci>n</ci>
      </apply>
      <cn type="integer">0</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>c</ci>
       <ci>n</ci>
      </apply>
      <cn type="integer">1</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>c</ci>
       <ci>n</ci>
      </apply>
      <cn type="integer">2</cn>
     </apply>
     <ci>normal-⋯</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   c_{n}(t)=c_{n}^{(0)}+c_{n}^{(1)}+c_{n}^{(2)}+\cdots
  </annotation>
 </semantics>
</math>

 where, for example, the first-order term is</p>

<p>

<math display="block" id="Perturbation_theory_(quantum_mechanics):151">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <msubsup>
      <mi>c</mi>
      <mi>n</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mn>1</mn>
       <mo stretchy="false">)</mo>
      </mrow>
     </msubsup>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>t</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mfrac>
      <mrow>
       <mo>-</mo>
       <mi>i</mi>
      </mrow>
      <mi mathvariant="normal">ℏ</mi>
     </mfrac>
     <mrow>
      <munder>
       <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
       <mi>k</mi>
      </munder>
      <mrow>
       <msubsup>
        <mo largeop="true" symmetric="true">∫</mo>
        <mn>0</mn>
        <mi>t</mi>
       </msubsup>
       <mrow>
        <mi>d</mi>
        <mpadded width="+2.8pt">
         <msup>
          <mi>t</mi>
          <mo>′</mo>
         </msup>
        </mpadded>
        <merror class="ltx_ERROR undefined undefined">
         <mtext>\lang</mtext>
        </merror>
        <mi>n</mi>
        <mrow>
         <mo stretchy="false">|</mo>
         <mrow>
          <mi>V</mi>
          <mrow>
           <mo stretchy="false">(</mo>
           <msup>
            <mi>t</mi>
            <mo>′</mo>
           </msup>
           <mo stretchy="false">)</mo>
          </mrow>
         </mrow>
         <mo stretchy="false">|</mo>
        </mrow>
        <mi>k</mi>
        <merror class="ltx_ERROR undefined undefined">
         <mtext>\rang</mtext>
        </merror>
        <msub>
         <mi>c</mi>
         <mi>k</mi>
        </msub>
        <mrow>
         <mo stretchy="false">(</mo>
         <mn>0</mn>
         <mo rspace="4.2pt" stretchy="false">)</mo>
        </mrow>
        <mpadded width="+3.3pt">
         <msup>
          <mi>e</mi>
          <mrow>
           <mo>-</mo>
           <mrow>
            <mrow>
             <mi>i</mi>
             <mrow>
              <mo stretchy="false">(</mo>
              <mrow>
               <msub>
                <mi>E</mi>
                <mi>k</mi>
               </msub>
               <mo>-</mo>
               <msub>
                <mi>E</mi>
                <mi>n</mi>
               </msub>
              </mrow>
              <mo stretchy="false">)</mo>
             </mrow>
             <msup>
              <mi>t</mi>
              <mo>′</mo>
             </msup>
            </mrow>
            <mo>/</mo>
            <mi mathvariant="normal">ℏ</mi>
           </mrow>
          </mrow>
         </msup>
        </mpadded>
       </mrow>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>c</ci>
       <ci>n</ci>
      </apply>
      <cn type="integer">1</cn>
     </apply>
     <ci>t</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <divide></divide>
      <apply>
       <minus></minus>
       <ci>i</ci>
      </apply>
      <csymbol cd="latexml">Planck-constant-over-2-pi</csymbol>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <ci>k</ci>
      </apply>
      <apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <int></int>
         <cn type="integer">0</cn>
        </apply>
        <ci>t</ci>
       </apply>
       <apply>
        <times></times>
        <ci>d</ci>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>t</ci>
         <ci>normal-′</ci>
        </apply>
        <mtext>\lang</mtext>
        <ci>n</ci>
        <apply>
         <abs></abs>
         <apply>
          <times></times>
          <ci>V</ci>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <ci>t</ci>
           <ci>normal-′</ci>
          </apply>
         </apply>
        </apply>
        <ci>k</ci>
        <mtext>\rang</mtext>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>c</ci>
         <ci>k</ci>
        </apply>
        <cn type="integer">0</cn>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>e</ci>
         <apply>
          <minus></minus>
          <apply>
           <divide></divide>
           <apply>
            <times></times>
            <ci>i</ci>
            <apply>
             <minus></minus>
             <apply>
              <csymbol cd="ambiguous">subscript</csymbol>
              <ci>E</ci>
              <ci>k</ci>
             </apply>
             <apply>
              <csymbol cd="ambiguous">subscript</csymbol>
              <ci>E</ci>
              <ci>n</ci>
             </apply>
            </apply>
            <apply>
             <csymbol cd="ambiguous">superscript</csymbol>
             <ci>t</ci>
             <ci>normal-′</ci>
            </apply>
           </apply>
           <csymbol cd="latexml">Planck-constant-over-2-pi</csymbol>
          </apply>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   c_{n}^{(1)}(t)=\frac{-i}{\hbar}\sum_{k}\int_{0}^{t}dt^{\prime}\;\lang n|V(t^{%
\prime})|k\rang\,c_{k}(0)\,e^{-i(E_{k}-E_{n})t^{\prime}/\hbar}~{}.
  </annotation>
 </semantics>
</math>

</p>

<p>Several further results follow from this, such as <a href="Fermi's_golden_rule" title="wikilink">Fermi's golden rule</a>, which relates the rate of transitions between quantum states to the density of states at particular energies; or the <a href="Dyson_series" title="wikilink">Dyson series</a>, obtained by applying the iterative method to the <a href="Hamiltonian_(quantum_mechanics)" title="wikilink">time evolution operator</a>, which is one of the starting points for the method of <a href="Feynman_diagram" title="wikilink">Feynman diagrams</a>.</p>
<h3 id="method-of-dyson-series">Method of Dyson series</h3>

<p>Time-dependent perturbations can be reorganized through the technique of the <a href="Dyson_series" title="wikilink">Dyson series</a>. The <a href="Schrödinger_equation" title="wikilink">Schrödinger equation</a></p>

<p>

<math display="block" id="Perturbation_theory_(quantum_mechanics):152">
 <semantics>
  <mrow>
   <mrow>
    <mi>H</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>t</mi>
     <mo stretchy="false">)</mo>
    </mrow>
    <mrow>
     <mo fence="true" stretchy="false">|</mo>
     <mrow>
      <mi>ψ</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>t</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo stretchy="false">⟩</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mi>i</mi>
    <mi mathvariant="normal">ℏ</mi>
    <mfrac>
     <mrow>
      <mo>∂</mo>
      <mrow>
       <mo fence="true" stretchy="false">|</mo>
       <mrow>
        <mi>ψ</mi>
        <mrow>
         <mo stretchy="false">(</mo>
         <mi>t</mi>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
       <mo stretchy="false">⟩</mo>
      </mrow>
     </mrow>
     <mrow>
      <mo>∂</mo>
      <mi>t</mi>
     </mrow>
    </mfrac>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>H</ci>
     <ci>t</ci>
     <apply>
      <csymbol cd="latexml">ket</csymbol>
      <apply>
       <times></times>
       <ci>ψ</ci>
       <ci>t</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <times></times>
     <ci>i</ci>
     <csymbol cd="latexml">Planck-constant-over-2-pi</csymbol>
     <apply>
      <divide></divide>
      <apply>
       <times></times>
       <partialdiff></partialdiff>
       <apply>
        <csymbol cd="latexml">ket</csymbol>
        <apply>
         <times></times>
         <ci>ψ</ci>
         <ci>t</ci>
        </apply>
       </apply>
      </apply>
      <apply>
       <partialdiff></partialdiff>
       <ci>t</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   H(t)|\psi(t)\rangle=i\hbar\frac{\partial|\psi(t)\rangle}{\partial t}
  </annotation>
 </semantics>
</math>

 has the formal solution</p>

<p>

<math display="block" id="Perturbation_theory_(quantum_mechanics):153">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mo fence="true" stretchy="false">|</mo>
     <mrow>
      <mi>ψ</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>t</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo stretchy="false">⟩</mo>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mi>T</mi>
     <mrow>
      <mi>exp</mi>
      <mrow>
       <mo>[</mo>
       <mrow>
        <mo>-</mo>
        <mrow>
         <mfrac>
          <mi>i</mi>
          <mi mathvariant="normal">ℏ</mi>
         </mfrac>
         <mrow>
          <msubsup>
           <mo largeop="true" symmetric="true">∫</mo>
           <msub>
            <mi>t</mi>
            <mn>0</mn>
           </msub>
           <mi>t</mi>
          </msubsup>
          <mrow>
           <mi>d</mi>
           <msup>
            <mi>t</mi>
            <mo>′</mo>
           </msup>
           <mi>H</mi>
           <mrow>
            <mo stretchy="false">(</mo>
            <msup>
             <mi>t</mi>
             <mo>′</mo>
            </msup>
            <mo stretchy="false">)</mo>
           </mrow>
          </mrow>
         </mrow>
        </mrow>
       </mrow>
       <mo>]</mo>
      </mrow>
     </mrow>
     <mrow>
      <mo fence="true" stretchy="false">|</mo>
      <mrow>
       <mi>ψ</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <msub>
         <mi>t</mi>
         <mn>0</mn>
        </msub>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
      <mo rspace="5.8pt" stretchy="false">⟩</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="latexml">ket</csymbol>
     <apply>
      <times></times>
      <ci>ψ</ci>
      <ci>t</ci>
     </apply>
    </apply>
    <apply>
     <times></times>
     <ci>T</ci>
     <apply>
      <exp></exp>
      <apply>
       <minus></minus>
       <apply>
        <times></times>
        <apply>
         <divide></divide>
         <ci>i</ci>
         <csymbol cd="latexml">Planck-constant-over-2-pi</csymbol>
        </apply>
        <apply>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <int></int>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <ci>t</ci>
            <cn type="integer">0</cn>
           </apply>
          </apply>
          <ci>t</ci>
         </apply>
         <apply>
          <times></times>
          <ci>d</ci>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <ci>t</ci>
           <ci>normal-′</ci>
          </apply>
          <ci>H</ci>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <ci>t</ci>
           <ci>normal-′</ci>
          </apply>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <csymbol cd="latexml">ket</csymbol>
      <apply>
       <times></times>
       <ci>ψ</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>t</ci>
        <cn type="integer">0</cn>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   |\psi(t)\rangle=T\exp{\left[-\frac{i}{\hbar}\int_{t_{0}}^{t}dt^{\prime}H(t^{%
\prime})\right]}|\psi(t_{0})\rangle~{},
  </annotation>
 </semantics>
</math>

 where 

<math display="inline" id="Perturbation_theory_(quantum_mechanics):154">
 <semantics>
  <mi>T</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>T</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   T
  </annotation>
 </semantics>
</math>

 is the time ordering operator,</p>

<p>

<math display="block" id="Perturbation_theory_(quantum_mechanics):155">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>T</mi>
     <mi>A</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <msub>
       <mi>t</mi>
       <mn>1</mn>
      </msub>
      <mo stretchy="false">)</mo>
     </mrow>
     <mi>A</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <msub>
       <mi>t</mi>
       <mn>2</mn>
      </msub>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mpadded width="+3.3pt">
     <mrow>
      <mo>{</mo>
      <mtable displaystyle="true">
       <mtr>
        <mtd columnalign="left">
         <mrow>
          <mi>A</mi>
          <mrow>
           <mo stretchy="false">(</mo>
           <msub>
            <mi>t</mi>
            <mn>1</mn>
           </msub>
           <mo stretchy="false">)</mo>
          </mrow>
          <mi>A</mi>
          <mrow>
           <mo stretchy="false">(</mo>
           <msub>
            <mi>t</mi>
            <mn>2</mn>
           </msub>
           <mo stretchy="false">)</mo>
          </mrow>
         </mrow>
        </mtd>
        <mtd columnalign="left">
         <mrow>
          <msub>
           <mi>t</mi>
           <mn>1</mn>
          </msub>
          <mo>></mo>
          <msub>
           <mi>t</mi>
           <mn>2</mn>
          </msub>
         </mrow>
        </mtd>
       </mtr>
       <mtr>
        <mtd columnalign="left">
         <mrow>
          <mi>A</mi>
          <mrow>
           <mo stretchy="false">(</mo>
           <msub>
            <mi>t</mi>
            <mn>2</mn>
           </msub>
           <mo stretchy="false">)</mo>
          </mrow>
          <mi>A</mi>
          <mrow>
           <mo stretchy="false">(</mo>
           <msub>
            <mi>t</mi>
            <mn>1</mn>
           </msub>
           <mo stretchy="false">)</mo>
          </mrow>
         </mrow>
        </mtd>
        <mtd columnalign="left">
         <mrow>
          <msub>
           <mi>t</mi>
           <mn>2</mn>
          </msub>
          <mo>></mo>
          <msub>
           <mi>t</mi>
           <mn>1</mn>
          </msub>
         </mrow>
        </mtd>
       </mtr>
      </mtable>
     </mrow>
    </mpadded>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>T</ci>
     <ci>A</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>t</ci>
      <cn type="integer">1</cn>
     </apply>
     <ci>A</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>t</ci>
      <cn type="integer">2</cn>
     </apply>
    </apply>
    <apply>
     <csymbol cd="latexml">cases</csymbol>
     <apply>
      <times></times>
      <ci>A</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>t</ci>
       <cn type="integer">1</cn>
      </apply>
      <ci>A</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>t</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
     <apply>
      <gt></gt>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>t</ci>
       <cn type="integer">1</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>t</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
     <apply>
      <times></times>
      <ci>A</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>t</ci>
       <cn type="integer">2</cn>
      </apply>
      <ci>A</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>t</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <apply>
      <gt></gt>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>t</ci>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>t</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   TA(t_{1})A(t_{2})=\begin{cases}A(t_{1})A(t_{2})&t_{1}>t_{2}\\
A(t_{2})A(t_{1})&t_{2}>t_{1}\end{cases}~{}.
  </annotation>
 </semantics>
</math>

 Thus, the exponential represents the following <a href="Dyson_series" title="wikilink">Dyson series</a>,</p>

<p>

<math display="block" id="Perturbation_theory_(quantum_mechanics):156">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mo fence="true" stretchy="false">|</mo>
     <mrow>
      <mi>ψ</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>t</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo stretchy="false">⟩</mo>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mo>[</mo>
      <mrow>
       <mrow>
        <mn>1</mn>
        <mo>-</mo>
        <mrow>
         <mfrac>
          <mi>i</mi>
          <mi mathvariant="normal">ℏ</mi>
         </mfrac>
         <mrow>
          <msubsup>
           <mo largeop="true" symmetric="true">∫</mo>
           <msub>
            <mi>t</mi>
            <mn>0</mn>
           </msub>
           <mi>t</mi>
          </msubsup>
          <mrow>
           <mi>d</mi>
           <msub>
            <mi>t</mi>
            <mn>1</mn>
           </msub>
           <mi>H</mi>
           <mrow>
            <mo stretchy="false">(</mo>
            <msub>
             <mi>t</mi>
             <mn>1</mn>
            </msub>
            <mo stretchy="false">)</mo>
           </mrow>
          </mrow>
         </mrow>
        </mrow>
        <mo>-</mo>
        <mrow>
         <mfrac>
          <mn>1</mn>
          <msup>
           <mi mathvariant="normal">ℏ</mi>
           <mn>2</mn>
          </msup>
         </mfrac>
         <mrow>
          <msubsup>
           <mo largeop="true" symmetric="true">∫</mo>
           <msub>
            <mi>t</mi>
            <mn>0</mn>
           </msub>
           <mi>t</mi>
          </msubsup>
          <mrow>
           <mi>d</mi>
           <msub>
            <mi>t</mi>
            <mn>1</mn>
           </msub>
           <mrow>
            <msubsup>
             <mo largeop="true" symmetric="true">∫</mo>
             <msub>
              <mi>t</mi>
              <mn>0</mn>
             </msub>
             <msub>
              <mi>t</mi>
              <mn>1</mn>
             </msub>
            </msubsup>
            <mrow>
             <mi>d</mi>
             <msub>
              <mi>t</mi>
              <mn>2</mn>
             </msub>
             <mi>H</mi>
             <mrow>
              <mo stretchy="false">(</mo>
              <msub>
               <mi>t</mi>
               <mn>1</mn>
              </msub>
              <mo stretchy="false">)</mo>
             </mrow>
             <mi>H</mi>
             <mrow>
              <mo stretchy="false">(</mo>
              <msub>
               <mi>t</mi>
               <mn>2</mn>
              </msub>
              <mo stretchy="false">)</mo>
             </mrow>
            </mrow>
           </mrow>
          </mrow>
         </mrow>
        </mrow>
       </mrow>
       <mo>+</mo>
       <mi mathvariant="normal">…</mi>
      </mrow>
      <mo>]</mo>
     </mrow>
     <mrow>
      <mo fence="true" stretchy="false">|</mo>
      <mrow>
       <mi>ψ</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <msub>
         <mi>t</mi>
         <mn>0</mn>
        </msub>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
      <mo rspace="5.8pt" stretchy="false">⟩</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="latexml">ket</csymbol>
     <apply>
      <times></times>
      <ci>ψ</ci>
      <ci>t</ci>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="latexml">delimited-[]</csymbol>
      <apply>
       <plus></plus>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
        <apply>
         <times></times>
         <apply>
          <divide></divide>
          <ci>i</ci>
          <csymbol cd="latexml">Planck-constant-over-2-pi</csymbol>
         </apply>
         <apply>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <int></int>
            <apply>
             <csymbol cd="ambiguous">subscript</csymbol>
             <ci>t</ci>
             <cn type="integer">0</cn>
            </apply>
           </apply>
           <ci>t</ci>
          </apply>
          <apply>
           <times></times>
           <ci>d</ci>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <ci>t</ci>
            <cn type="integer">1</cn>
           </apply>
           <ci>H</ci>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <ci>t</ci>
            <cn type="integer">1</cn>
           </apply>
          </apply>
         </apply>
        </apply>
        <apply>
         <times></times>
         <apply>
          <divide></divide>
          <cn type="integer">1</cn>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <csymbol cd="latexml">Planck-constant-over-2-pi</csymbol>
           <cn type="integer">2</cn>
          </apply>
         </apply>
         <apply>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <int></int>
            <apply>
             <csymbol cd="ambiguous">subscript</csymbol>
             <ci>t</ci>
             <cn type="integer">0</cn>
            </apply>
           </apply>
           <ci>t</ci>
          </apply>
          <apply>
           <times></times>
           <ci>d</ci>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <ci>t</ci>
            <cn type="integer">1</cn>
           </apply>
           <apply>
            <apply>
             <csymbol cd="ambiguous">superscript</csymbol>
             <apply>
              <csymbol cd="ambiguous">subscript</csymbol>
              <int></int>
              <apply>
               <csymbol cd="ambiguous">subscript</csymbol>
               <ci>t</ci>
               <cn type="integer">0</cn>
              </apply>
             </apply>
             <apply>
              <csymbol cd="ambiguous">subscript</csymbol>
              <ci>t</ci>
              <cn type="integer">1</cn>
             </apply>
            </apply>
            <apply>
             <times></times>
             <ci>d</ci>
             <apply>
              <csymbol cd="ambiguous">subscript</csymbol>
              <ci>t</ci>
              <cn type="integer">2</cn>
             </apply>
             <ci>H</ci>
             <apply>
              <csymbol cd="ambiguous">subscript</csymbol>
              <ci>t</ci>
              <cn type="integer">1</cn>
             </apply>
             <ci>H</ci>
             <apply>
              <csymbol cd="ambiguous">subscript</csymbol>
              <ci>t</ci>
              <cn type="integer">2</cn>
             </apply>
            </apply>
           </apply>
          </apply>
         </apply>
        </apply>
       </apply>
       <ci>normal-…</ci>
      </apply>
     </apply>
     <apply>
      <csymbol cd="latexml">ket</csymbol>
      <apply>
       <times></times>
       <ci>ψ</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>t</ci>
        <cn type="integer">0</cn>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   |\psi(t)\rangle=\left[1-\frac{i}{\hbar}\int_{t_{0}}^{t}dt_{1}H(t_{1})-\frac{1}%
{\hbar^{2}}\int_{t_{0}}^{t}dt_{1}\int_{t_{0}}^{t_{1}}dt_{2}H(t_{1})H(t_{2})+%
\ldots\right]|\psi(t_{0})\rangle~{}.
  </annotation>
 </semantics>
</math>

</p>

<p>Consider the following perturbation problem</p>

<p>

<math display="block" id="Perturbation_theory_(quantum_mechanics):157">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mrow>
      <mo stretchy="false">[</mo>
      <mrow>
       <msub>
        <mi>H</mi>
        <mn>0</mn>
       </msub>
       <mo>+</mo>
       <mrow>
        <mi>λ</mi>
        <mi>V</mi>
        <mrow>
         <mo stretchy="false">(</mo>
         <mi>t</mi>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
      </mrow>
      <mo stretchy="false">]</mo>
     </mrow>
     <mrow>
      <mo fence="true" stretchy="false">|</mo>
      <mrow>
       <mi>ψ</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>t</mi>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
      <mo stretchy="false">⟩</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mi>i</mi>
     <mi mathvariant="normal">ℏ</mi>
     <mpadded width="+3.3pt">
      <mfrac>
       <mrow>
        <mo>∂</mo>
        <mrow>
         <mo fence="true" stretchy="false">|</mo>
         <mrow>
          <mi>ψ</mi>
          <mrow>
           <mo stretchy="false">(</mo>
           <mi>t</mi>
           <mo stretchy="false">)</mo>
          </mrow>
         </mrow>
         <mo stretchy="false">⟩</mo>
        </mrow>
       </mrow>
       <mrow>
        <mo>∂</mo>
        <mi>t</mi>
       </mrow>
      </mfrac>
     </mpadded>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="latexml">delimited-[]</csymbol>
      <apply>
       <plus></plus>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>H</ci>
        <cn type="integer">0</cn>
       </apply>
       <apply>
        <times></times>
        <ci>λ</ci>
        <ci>V</ci>
        <ci>t</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <csymbol cd="latexml">ket</csymbol>
      <apply>
       <times></times>
       <ci>ψ</ci>
       <ci>t</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <times></times>
     <ci>i</ci>
     <csymbol cd="latexml">Planck-constant-over-2-pi</csymbol>
     <apply>
      <divide></divide>
      <apply>
       <times></times>
       <partialdiff></partialdiff>
       <apply>
        <csymbol cd="latexml">ket</csymbol>
        <apply>
         <times></times>
         <ci>ψ</ci>
         <ci>t</ci>
        </apply>
       </apply>
      </apply>
      <apply>
       <partialdiff></partialdiff>
       <ci>t</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   [H_{0}+\lambda V(t)]|\psi(t)\rangle=i\hbar\frac{\partial|\psi(t)\rangle}{%
\partial t}~{},
  </annotation>
 </semantics>
</math>

 assuming that the parameter 

<math display="inline" id="Perturbation_theory_(quantum_mechanics):158">
 <semantics>
  <mi>λ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>λ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   λ
  </annotation>
 </semantics>
</math>

 is small and that the problem 

<math display="inline" id="Perturbation_theory_(quantum_mechanics):159">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>H</mi>
     <mn>0</mn>
    </msub>
    <mrow>
     <mo fence="true" stretchy="false">|</mo>
     <mi>n</mi>
     <mo stretchy="false">⟩</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <msub>
     <mi>E</mi>
     <mi>n</mi>
    </msub>
    <mrow>
     <mo fence="true" stretchy="false">|</mo>
     <mi>n</mi>
     <mo stretchy="false">⟩</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>H</ci>
      <cn type="integer">0</cn>
     </apply>
     <apply>
      <csymbol cd="latexml">ket</csymbol>
      <ci>n</ci>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>E</ci>
      <ci>n</ci>
     </apply>
     <apply>
      <csymbol cd="latexml">ket</csymbol>
      <ci>n</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   H_{0}|n\rangle=E_{n}|n\rangle
  </annotation>
 </semantics>
</math>

 has been solved.</p>

<p>Perform the following unitary transformation to the <a href="interaction_picture" title="wikilink">interaction picture</a> (or Dirac picture),</p>

<p>

<math display="block" id="Perturbation_theory_(quantum_mechanics):160">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mo fence="true" stretchy="false">|</mo>
     <mrow>
      <mi>ψ</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>t</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo stretchy="false">⟩</mo>
    </mrow>
    <mo>=</mo>
    <mrow>
     <msup>
      <mi>e</mi>
      <mrow>
       <mo>-</mo>
       <mrow>
        <mfrac>
         <mi>i</mi>
         <mi mathvariant="normal">ℏ</mi>
        </mfrac>
        <msub>
         <mi>H</mi>
         <mn>0</mn>
        </msub>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <mi>t</mi>
          <mo>-</mo>
          <msub>
           <mi>t</mi>
           <mn>0</mn>
          </msub>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
      </mrow>
     </msup>
     <mrow>
      <mo fence="true" stretchy="false">|</mo>
      <mrow>
       <msub>
        <mi>ψ</mi>
        <mi>I</mi>
       </msub>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>t</mi>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
      <mo rspace="5.8pt" stretchy="false">⟩</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="latexml">ket</csymbol>
     <apply>
      <times></times>
      <ci>ψ</ci>
      <ci>t</ci>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>e</ci>
      <apply>
       <minus></minus>
       <apply>
        <times></times>
        <apply>
         <divide></divide>
         <ci>i</ci>
         <csymbol cd="latexml">Planck-constant-over-2-pi</csymbol>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>H</ci>
         <cn type="integer">0</cn>
        </apply>
        <apply>
         <minus></minus>
         <ci>t</ci>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>t</ci>
          <cn type="integer">0</cn>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <csymbol cd="latexml">ket</csymbol>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>ψ</ci>
        <ci>I</ci>
       </apply>
       <ci>t</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   |\psi(t)\rangle=e^{-\frac{i}{\hbar}H_{0}(t-t_{0})}|\psi_{I}(t)\rangle~{}.
  </annotation>
 </semantics>
</math>

 Consequently, the <a href="Schrödinger_equation" title="wikilink">Schrödinger equation</a> simplifies to</p>

<p>

<math display="block" id="Perturbation_theory_(quantum_mechanics):161">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>λ</mi>
     <msup>
      <mi>e</mi>
      <mrow>
       <mfrac>
        <mi>i</mi>
        <mi mathvariant="normal">ℏ</mi>
       </mfrac>
       <msub>
        <mi>H</mi>
        <mn>0</mn>
       </msub>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mi>t</mi>
         <mo>-</mo>
         <msub>
          <mi>t</mi>
          <mn>0</mn>
         </msub>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
     </msup>
     <mi>V</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>t</mi>
      <mo stretchy="false">)</mo>
     </mrow>
     <msup>
      <mi>e</mi>
      <mrow>
       <mo>-</mo>
       <mrow>
        <mfrac>
         <mi>i</mi>
         <mi mathvariant="normal">ℏ</mi>
        </mfrac>
        <msub>
         <mi>H</mi>
         <mn>0</mn>
        </msub>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <mi>t</mi>
          <mo>-</mo>
          <msub>
           <mi>t</mi>
           <mn>0</mn>
          </msub>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
      </mrow>
     </msup>
     <mrow>
      <mo fence="true" stretchy="false">|</mo>
      <mrow>
       <msub>
        <mi>ψ</mi>
        <mi>I</mi>
       </msub>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>t</mi>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
      <mo stretchy="false">⟩</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mi>i</mi>
     <mi mathvariant="normal">ℏ</mi>
     <mpadded width="+3.3pt">
      <mfrac>
       <mrow>
        <mo>∂</mo>
        <mrow>
         <mo fence="true" stretchy="false">|</mo>
         <mrow>
          <msub>
           <mi>ψ</mi>
           <mi>I</mi>
          </msub>
          <mrow>
           <mo stretchy="false">(</mo>
           <mi>t</mi>
           <mo stretchy="false">)</mo>
          </mrow>
         </mrow>
         <mo stretchy="false">⟩</mo>
        </mrow>
       </mrow>
       <mrow>
        <mo>∂</mo>
        <mi>t</mi>
       </mrow>
      </mfrac>
     </mpadded>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>λ</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>e</ci>
      <apply>
       <times></times>
       <apply>
        <divide></divide>
        <ci>i</ci>
        <csymbol cd="latexml">Planck-constant-over-2-pi</csymbol>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>H</ci>
        <cn type="integer">0</cn>
       </apply>
       <apply>
        <minus></minus>
        <ci>t</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>t</ci>
         <cn type="integer">0</cn>
        </apply>
       </apply>
      </apply>
     </apply>
     <ci>V</ci>
     <ci>t</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>e</ci>
      <apply>
       <minus></minus>
       <apply>
        <times></times>
        <apply>
         <divide></divide>
         <ci>i</ci>
         <csymbol cd="latexml">Planck-constant-over-2-pi</csymbol>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>H</ci>
         <cn type="integer">0</cn>
        </apply>
        <apply>
         <minus></minus>
         <ci>t</ci>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>t</ci>
          <cn type="integer">0</cn>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <csymbol cd="latexml">ket</csymbol>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>ψ</ci>
        <ci>I</ci>
       </apply>
       <ci>t</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <times></times>
     <ci>i</ci>
     <csymbol cd="latexml">Planck-constant-over-2-pi</csymbol>
     <apply>
      <divide></divide>
      <apply>
       <times></times>
       <partialdiff></partialdiff>
       <apply>
        <csymbol cd="latexml">ket</csymbol>
        <apply>
         <times></times>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>ψ</ci>
          <ci>I</ci>
         </apply>
         <ci>t</ci>
        </apply>
       </apply>
      </apply>
      <apply>
       <partialdiff></partialdiff>
       <ci>t</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \lambda e^{\frac{i}{\hbar}H_{0}(t-t_{0})}V(t)e^{-\frac{i}{\hbar}H_{0}(t-t_{0})%
}|\psi_{I}(t)\rangle=i\hbar\frac{\partial|\psi_{I}(t)\rangle}{\partial t}~{},
  </annotation>
 </semantics>
</math>

 so it is solved through the above <a href="Dyson_series" title="wikilink">Dyson series</a>,</p>

<p>

<math display="block" id="Perturbation_theory_(quantum_mechanics):162">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mo fence="true" stretchy="false">|</mo>
     <mrow>
      <msub>
       <mi>ψ</mi>
       <mi>I</mi>
      </msub>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>t</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo stretchy="false">⟩</mo>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mo>[</mo>
      <mrow>
       <mrow>
        <mn>1</mn>
        <mo>-</mo>
        <mrow>
         <mfrac>
          <mrow>
           <mi>i</mi>
           <mi>λ</mi>
          </mrow>
          <mi mathvariant="normal">ℏ</mi>
         </mfrac>
         <mrow>
          <msubsup>
           <mo largeop="true" symmetric="true">∫</mo>
           <msub>
            <mi>t</mi>
            <mn>0</mn>
           </msub>
           <mi>t</mi>
          </msubsup>
          <mrow>
           <mi>d</mi>
           <msub>
            <mi>t</mi>
            <mn>1</mn>
           </msub>
           <msup>
            <mi>e</mi>
            <mrow>
             <mfrac>
              <mi>i</mi>
              <mi mathvariant="normal">ℏ</mi>
             </mfrac>
             <msub>
              <mi>H</mi>
              <mn>0</mn>
             </msub>
             <mrow>
              <mo stretchy="false">(</mo>
              <mrow>
               <msub>
                <mi>t</mi>
                <mn>1</mn>
               </msub>
               <mo>-</mo>
               <msub>
                <mi>t</mi>
                <mn>0</mn>
               </msub>
              </mrow>
              <mo stretchy="false">)</mo>
             </mrow>
            </mrow>
           </msup>
           <mi>V</mi>
           <mrow>
            <mo stretchy="false">(</mo>
            <msub>
             <mi>t</mi>
             <mn>1</mn>
            </msub>
            <mo stretchy="false">)</mo>
           </mrow>
           <msup>
            <mi>e</mi>
            <mrow>
             <mo>-</mo>
             <mrow>
              <mfrac>
               <mi>i</mi>
               <mi mathvariant="normal">ℏ</mi>
              </mfrac>
              <msub>
               <mi>H</mi>
               <mn>0</mn>
              </msub>
              <mrow>
               <mo stretchy="false">(</mo>
               <mrow>
                <msub>
                 <mi>t</mi>
                 <mn>1</mn>
                </msub>
                <mo>-</mo>
                <msub>
                 <mi>t</mi>
                 <mn>0</mn>
                </msub>
               </mrow>
               <mo stretchy="false">)</mo>
              </mrow>
             </mrow>
            </mrow>
           </msup>
          </mrow>
         </mrow>
        </mrow>
        <mo>-</mo>
        <mrow>
         <mfrac>
          <msup>
           <mi>λ</mi>
           <mn>2</mn>
          </msup>
          <msup>
           <mi mathvariant="normal">ℏ</mi>
           <mn>2</mn>
          </msup>
         </mfrac>
         <mrow>
          <msubsup>
           <mo largeop="true" symmetric="true">∫</mo>
           <msub>
            <mi>t</mi>
            <mn>0</mn>
           </msub>
           <mi>t</mi>
          </msubsup>
          <mrow>
           <mi>d</mi>
           <msub>
            <mi>t</mi>
            <mn>1</mn>
           </msub>
           <mrow>
            <msubsup>
             <mo largeop="true" symmetric="true">∫</mo>
             <msub>
              <mi>t</mi>
              <mn>0</mn>
             </msub>
             <msub>
              <mi>t</mi>
              <mn>1</mn>
             </msub>
            </msubsup>
            <mrow>
             <mi>d</mi>
             <msub>
              <mi>t</mi>
              <mn>2</mn>
             </msub>
             <msup>
              <mi>e</mi>
              <mrow>
               <mfrac>
                <mi>i</mi>
                <mi mathvariant="normal">ℏ</mi>
               </mfrac>
               <msub>
                <mi>H</mi>
                <mn>0</mn>
               </msub>
               <mrow>
                <mo stretchy="false">(</mo>
                <mrow>
                 <msub>
                  <mi>t</mi>
                  <mn>1</mn>
                 </msub>
                 <mo>-</mo>
                 <msub>
                  <mi>t</mi>
                  <mn>0</mn>
                 </msub>
                </mrow>
                <mo stretchy="false">)</mo>
               </mrow>
              </mrow>
             </msup>
             <mi>V</mi>
             <mrow>
              <mo stretchy="false">(</mo>
              <msub>
               <mi>t</mi>
               <mn>1</mn>
              </msub>
              <mo stretchy="false">)</mo>
             </mrow>
             <msup>
              <mi>e</mi>
              <mrow>
               <mo>-</mo>
               <mrow>
                <mfrac>
                 <mi>i</mi>
                 <mi mathvariant="normal">ℏ</mi>
                </mfrac>
                <msub>
                 <mi>H</mi>
                 <mn>0</mn>
                </msub>
                <mrow>
                 <mo stretchy="false">(</mo>
                 <mrow>
                  <msub>
                   <mi>t</mi>
                   <mn>1</mn>
                  </msub>
                  <mo>-</mo>
                  <msub>
                   <mi>t</mi>
                   <mn>0</mn>
                  </msub>
                 </mrow>
                 <mo stretchy="false">)</mo>
                </mrow>
               </mrow>
              </mrow>
             </msup>
             <msup>
              <mi>e</mi>
              <mrow>
               <mfrac>
                <mi>i</mi>
                <mi mathvariant="normal">ℏ</mi>
               </mfrac>
               <msub>
                <mi>H</mi>
                <mn>0</mn>
               </msub>
               <mrow>
                <mo stretchy="false">(</mo>
                <mrow>
                 <msub>
                  <mi>t</mi>
                  <mn>2</mn>
                 </msub>
                 <mo>-</mo>
                 <msub>
                  <mi>t</mi>
                  <mn>0</mn>
                 </msub>
                </mrow>
                <mo stretchy="false">)</mo>
               </mrow>
              </mrow>
             </msup>
             <mi>V</mi>
             <mrow>
              <mo stretchy="false">(</mo>
              <msub>
               <mi>t</mi>
               <mn>2</mn>
              </msub>
              <mo stretchy="false">)</mo>
             </mrow>
             <msup>
              <mi>e</mi>
              <mrow>
               <mo>-</mo>
               <mrow>
                <mfrac>
                 <mi>i</mi>
                 <mi mathvariant="normal">ℏ</mi>
                </mfrac>
                <msub>
                 <mi>H</mi>
                 <mn>0</mn>
                </msub>
                <mrow>
                 <mo stretchy="false">(</mo>
                 <mrow>
                  <msub>
                   <mi>t</mi>
                   <mn>2</mn>
                  </msub>
                  <mo>-</mo>
                  <msub>
                   <mi>t</mi>
                   <mn>0</mn>
                  </msub>
                 </mrow>
                 <mo stretchy="false">)</mo>
                </mrow>
               </mrow>
              </mrow>
             </msup>
            </mrow>
           </mrow>
          </mrow>
         </mrow>
        </mrow>
       </mrow>
       <mo>+</mo>
       <mi mathvariant="normal">…</mi>
      </mrow>
      <mo>]</mo>
     </mrow>
     <mrow>
      <mo fence="true" stretchy="false">|</mo>
      <mrow>
       <mi>ψ</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <msub>
         <mi>t</mi>
         <mn>0</mn>
        </msub>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
      <mo rspace="5.8pt" stretchy="false">⟩</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="latexml">ket</csymbol>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>ψ</ci>
       <ci>I</ci>
      </apply>
      <ci>t</ci>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="latexml">delimited-[]</csymbol>
      <apply>
       <plus></plus>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
        <apply>
         <times></times>
         <apply>
          <divide></divide>
          <apply>
           <times></times>
           <ci>i</ci>
           <ci>λ</ci>
          </apply>
          <csymbol cd="latexml">Planck-constant-over-2-pi</csymbol>
         </apply>
         <apply>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <int></int>
            <apply>
             <csymbol cd="ambiguous">subscript</csymbol>
             <ci>t</ci>
             <cn type="integer">0</cn>
            </apply>
           </apply>
           <ci>t</ci>
          </apply>
          <apply>
           <times></times>
           <ci>d</ci>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <ci>t</ci>
            <cn type="integer">1</cn>
           </apply>
           <apply>
            <csymbol cd="ambiguous">superscript</csymbol>
            <ci>e</ci>
            <apply>
             <times></times>
             <apply>
              <divide></divide>
              <ci>i</ci>
              <csymbol cd="latexml">Planck-constant-over-2-pi</csymbol>
             </apply>
             <apply>
              <csymbol cd="ambiguous">subscript</csymbol>
              <ci>H</ci>
              <cn type="integer">0</cn>
             </apply>
             <apply>
              <minus></minus>
              <apply>
               <csymbol cd="ambiguous">subscript</csymbol>
               <ci>t</ci>
               <cn type="integer">1</cn>
              </apply>
              <apply>
               <csymbol cd="ambiguous">subscript</csymbol>
               <ci>t</ci>
               <cn type="integer">0</cn>
              </apply>
             </apply>
            </apply>
           </apply>
           <ci>V</ci>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <ci>t</ci>
            <cn type="integer">1</cn>
           </apply>
           <apply>
            <csymbol cd="ambiguous">superscript</csymbol>
            <ci>e</ci>
            <apply>
             <minus></minus>
             <apply>
              <times></times>
              <apply>
               <divide></divide>
               <ci>i</ci>
               <csymbol cd="latexml">Planck-constant-over-2-pi</csymbol>
              </apply>
              <apply>
               <csymbol cd="ambiguous">subscript</csymbol>
               <ci>H</ci>
               <cn type="integer">0</cn>
              </apply>
              <apply>
               <minus></minus>
               <apply>
                <csymbol cd="ambiguous">subscript</csymbol>
                <ci>t</ci>
                <cn type="integer">1</cn>
               </apply>
               <apply>
                <csymbol cd="ambiguous">subscript</csymbol>
                <ci>t</ci>
                <cn type="integer">0</cn>
               </apply>
              </apply>
             </apply>
            </apply>
           </apply>
          </apply>
         </apply>
        </apply>
        <apply>
         <times></times>
         <apply>
          <divide></divide>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <ci>λ</ci>
           <cn type="integer">2</cn>
          </apply>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <csymbol cd="latexml">Planck-constant-over-2-pi</csymbol>
           <cn type="integer">2</cn>
          </apply>
         </apply>
         <apply>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <int></int>
            <apply>
             <csymbol cd="ambiguous">subscript</csymbol>
             <ci>t</ci>
             <cn type="integer">0</cn>
            </apply>
           </apply>
           <ci>t</ci>
          </apply>
          <apply>
           <times></times>
           <ci>d</ci>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <ci>t</ci>
            <cn type="integer">1</cn>
           </apply>
           <apply>
            <apply>
             <csymbol cd="ambiguous">superscript</csymbol>
             <apply>
              <csymbol cd="ambiguous">subscript</csymbol>
              <int></int>
              <apply>
               <csymbol cd="ambiguous">subscript</csymbol>
               <ci>t</ci>
               <cn type="integer">0</cn>
              </apply>
             </apply>
             <apply>
              <csymbol cd="ambiguous">subscript</csymbol>
              <ci>t</ci>
              <cn type="integer">1</cn>
             </apply>
            </apply>
            <apply>
             <times></times>
             <ci>d</ci>
             <apply>
              <csymbol cd="ambiguous">subscript</csymbol>
              <ci>t</ci>
              <cn type="integer">2</cn>
             </apply>
             <apply>
              <csymbol cd="ambiguous">superscript</csymbol>
              <ci>e</ci>
              <apply>
               <times></times>
               <apply>
                <divide></divide>
                <ci>i</ci>
                <csymbol cd="latexml">Planck-constant-over-2-pi</csymbol>
               </apply>
               <apply>
                <csymbol cd="ambiguous">subscript</csymbol>
                <ci>H</ci>
                <cn type="integer">0</cn>
               </apply>
               <apply>
                <minus></minus>
                <apply>
                 <csymbol cd="ambiguous">subscript</csymbol>
                 <ci>t</ci>
                 <cn type="integer">1</cn>
                </apply>
                <apply>
                 <csymbol cd="ambiguous">subscript</csymbol>
                 <ci>t</ci>
                 <cn type="integer">0</cn>
                </apply>
               </apply>
              </apply>
             </apply>
             <ci>V</ci>
             <apply>
              <csymbol cd="ambiguous">subscript</csymbol>
              <ci>t</ci>
              <cn type="integer">1</cn>
             </apply>
             <apply>
              <csymbol cd="ambiguous">superscript</csymbol>
              <ci>e</ci>
              <apply>
               <minus></minus>
               <apply>
                <times></times>
                <apply>
                 <divide></divide>
                 <ci>i</ci>
                 <csymbol cd="latexml">Planck-constant-over-2-pi</csymbol>
                </apply>
                <apply>
                 <csymbol cd="ambiguous">subscript</csymbol>
                 <ci>H</ci>
                 <cn type="integer">0</cn>
                </apply>
                <apply>
                 <minus></minus>
                 <apply>
                  <csymbol cd="ambiguous">subscript</csymbol>
                  <ci>t</ci>
                  <cn type="integer">1</cn>
                 </apply>
                 <apply>
                  <csymbol cd="ambiguous">subscript</csymbol>
                  <ci>t</ci>
                  <cn type="integer">0</cn>
                 </apply>
                </apply>
               </apply>
              </apply>
             </apply>
             <apply>
              <csymbol cd="ambiguous">superscript</csymbol>
              <ci>e</ci>
              <apply>
               <times></times>
               <apply>
                <divide></divide>
                <ci>i</ci>
                <csymbol cd="latexml">Planck-constant-over-2-pi</csymbol>
               </apply>
               <apply>
                <csymbol cd="ambiguous">subscript</csymbol>
                <ci>H</ci>
                <cn type="integer">0</cn>
               </apply>
               <apply>
                <minus></minus>
                <apply>
                 <csymbol cd="ambiguous">subscript</csymbol>
                 <ci>t</ci>
                 <cn type="integer">2</cn>
                </apply>
                <apply>
                 <csymbol cd="ambiguous">subscript</csymbol>
                 <ci>t</ci>
                 <cn type="integer">0</cn>
                </apply>
               </apply>
              </apply>
             </apply>
             <ci>V</ci>
             <apply>
              <csymbol cd="ambiguous">subscript</csymbol>
              <ci>t</ci>
              <cn type="integer">2</cn>
             </apply>
             <apply>
              <csymbol cd="ambiguous">superscript</csymbol>
              <ci>e</ci>
              <apply>
               <minus></minus>
               <apply>
                <times></times>
                <apply>
                 <divide></divide>
                 <ci>i</ci>
                 <csymbol cd="latexml">Planck-constant-over-2-pi</csymbol>
                </apply>
                <apply>
                 <csymbol cd="ambiguous">subscript</csymbol>
                 <ci>H</ci>
                 <cn type="integer">0</cn>
                </apply>
                <apply>
                 <minus></minus>
                 <apply>
                  <csymbol cd="ambiguous">subscript</csymbol>
                  <ci>t</ci>
                  <cn type="integer">2</cn>
                 </apply>
                 <apply>
                  <csymbol cd="ambiguous">subscript</csymbol>
                  <ci>t</ci>
                  <cn type="integer">0</cn>
                 </apply>
                </apply>
               </apply>
              </apply>
             </apply>
            </apply>
           </apply>
          </apply>
         </apply>
        </apply>
       </apply>
       <ci>normal-…</ci>
      </apply>
     </apply>
     <apply>
      <csymbol cd="latexml">ket</csymbol>
      <apply>
       <times></times>
       <ci>ψ</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>t</ci>
        <cn type="integer">0</cn>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   |\psi_{I}(t)\rangle=\left[1-\frac{i\lambda}{\hbar}\int_{t_{0}}^{t}dt_{1}e^{%
\frac{i}{\hbar}H_{0}(t_{1}-t_{0})}V(t_{1})e^{-\frac{i}{\hbar}H_{0}(t_{1}-t_{0}%
)}-\frac{\lambda^{2}}{\hbar^{2}}\int_{t_{0}}^{t}dt_{1}\int_{t_{0}}^{t_{1}}dt_{%
2}e^{\frac{i}{\hbar}H_{0}(t_{1}-t_{0})}V(t_{1})e^{-\frac{i}{\hbar}H_{0}(t_{1}-%
t_{0})}e^{\frac{i}{\hbar}H_{0}(t_{2}-t_{0})}V(t_{2})e^{-\frac{i}{\hbar}H_{0}(t%
_{2}-t_{0})}+\ldots\right]|\psi(t_{0})\rangle~{},
  </annotation>
 </semantics>
</math>

 as a perturbation series with small 

<math display="inline" id="Perturbation_theory_(quantum_mechanics):163">
 <semantics>
  <mi>λ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>λ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   λ
  </annotation>
 </semantics>
</math>

.</p>

<p>Using the solution of the unperturbed problem 

<math display="inline" id="Perturbation_theory_(quantum_mechanics):164">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>H</mi>
     <mn>0</mn>
    </msub>
    <mrow>
     <mo fence="true" stretchy="false">|</mo>
     <mi>n</mi>
     <mo stretchy="false">⟩</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <msub>
     <mi>E</mi>
     <mi>n</mi>
    </msub>
    <mrow>
     <mo fence="true" stretchy="false">|</mo>
     <mi>n</mi>
     <mo stretchy="false">⟩</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>H</ci>
      <cn type="integer">0</cn>
     </apply>
     <apply>
      <csymbol cd="latexml">ket</csymbol>
      <ci>n</ci>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>E</ci>
      <ci>n</ci>
     </apply>
     <apply>
      <csymbol cd="latexml">ket</csymbol>
      <ci>n</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   H_{0}|n\rangle=E_{n}|n\rangle
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Perturbation_theory_(quantum_mechanics):165">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mo largeop="true" symmetric="true">∑</mo>
     <mi>n</mi>
    </msub>
    <mrow>
     <mrow>
      <mo fence="true" stretchy="false">|</mo>
      <mi>n</mi>
      <mo stretchy="false">⟩</mo>
     </mrow>
     <mrow>
      <mo stretchy="false">⟨</mo>
      <mi>n</mi>
      <mo fence="true" stretchy="false">|</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <sum></sum>
      <ci>n</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="latexml">ket</csymbol>
       <ci>n</ci>
      </apply>
      <apply>
       <csymbol cd="latexml">bra</csymbol>
       <ci>n</ci>
      </apply>
     </apply>
    </apply>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \sum_{n}|n\rangle\langle n|=1
  </annotation>
 </semantics>
</math>

 (for the sake of simplicity assume a pure discrete spectrum), yields, to first order,</p>

<p>

<math display="block" id="Perturbation_theory_(quantum_mechanics):166">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mo fence="true" stretchy="false">|</mo>
     <mrow>
      <msub>
       <mi>ψ</mi>
       <mi>I</mi>
      </msub>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>t</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo stretchy="false">⟩</mo>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mo>[</mo>
      <mrow>
       <mrow>
        <mn>1</mn>
        <mo>-</mo>
        <mrow>
         <mfrac>
          <mrow>
           <mi>i</mi>
           <mi>λ</mi>
          </mrow>
          <mi mathvariant="normal">ℏ</mi>
         </mfrac>
         <mrow>
          <munder>
           <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
           <mi>m</mi>
          </munder>
          <mrow>
           <munder>
            <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
            <mi>n</mi>
           </munder>
           <mrow>
            <msubsup>
             <mo largeop="true" symmetric="true">∫</mo>
             <msub>
              <mi>t</mi>
              <mn>0</mn>
             </msub>
             <mi>t</mi>
            </msubsup>
            <mrow>
             <mi>d</mi>
             <msub>
              <mi>t</mi>
              <mn>1</mn>
             </msub>
             <mrow>
              <mo stretchy="false">⟨</mo>
              <mi>m</mi>
              <mo fence="true" stretchy="false">|</mo>
              <mrow>
               <mi>V</mi>
               <mrow>
                <mo stretchy="false">(</mo>
                <msub>
                 <mi>t</mi>
                 <mn>1</mn>
                </msub>
                <mo stretchy="false">)</mo>
               </mrow>
              </mrow>
              <mo fence="true" stretchy="false">|</mo>
              <mi>n</mi>
              <mo stretchy="false">⟩</mo>
             </mrow>
             <msup>
              <mi>e</mi>
              <mrow>
               <mo>-</mo>
               <mrow>
                <mfrac>
                 <mi>i</mi>
                 <mi mathvariant="normal">ℏ</mi>
                </mfrac>
                <mrow>
                 <mo stretchy="false">(</mo>
                 <mrow>
                  <msub>
                   <mi>E</mi>
                   <mi>n</mi>
                  </msub>
                  <mo>-</mo>
                  <msub>
                   <mi>E</mi>
                   <mi>m</mi>
                  </msub>
                 </mrow>
                 <mo stretchy="false">)</mo>
                </mrow>
                <mrow>
                 <mo stretchy="false">(</mo>
                 <mrow>
                  <msub>
                   <mi>t</mi>
                   <mn>1</mn>
                  </msub>
                  <mo>-</mo>
                  <msub>
                   <mi>t</mi>
                   <mn>0</mn>
                  </msub>
                 </mrow>
                 <mo stretchy="false">)</mo>
                </mrow>
               </mrow>
              </mrow>
             </msup>
             <mrow>
              <mo fence="true" stretchy="false">|</mo>
              <mi>m</mi>
              <mo stretchy="false">⟩</mo>
             </mrow>
             <mrow>
              <mo stretchy="false">⟨</mo>
              <mi>n</mi>
              <mo fence="true" stretchy="false">|</mo>
             </mrow>
            </mrow>
           </mrow>
          </mrow>
         </mrow>
        </mrow>
       </mrow>
       <mo>+</mo>
       <mi mathvariant="normal">…</mi>
      </mrow>
      <mo>]</mo>
     </mrow>
     <mrow>
      <mo fence="true" stretchy="false">|</mo>
      <mrow>
       <mi>ψ</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <msub>
         <mi>t</mi>
         <mn>0</mn>
        </msub>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
      <mo rspace="5.8pt" stretchy="false">⟩</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="latexml">ket</csymbol>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>ψ</ci>
       <ci>I</ci>
      </apply>
      <ci>t</ci>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="latexml">delimited-[]</csymbol>
      <apply>
       <plus></plus>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
        <apply>
         <times></times>
         <apply>
          <divide></divide>
          <apply>
           <times></times>
           <ci>i</ci>
           <ci>λ</ci>
          </apply>
          <csymbol cd="latexml">Planck-constant-over-2-pi</csymbol>
         </apply>
         <apply>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <sum></sum>
           <ci>m</ci>
          </apply>
          <apply>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <sum></sum>
            <ci>n</ci>
           </apply>
           <apply>
            <apply>
             <csymbol cd="ambiguous">superscript</csymbol>
             <apply>
              <csymbol cd="ambiguous">subscript</csymbol>
              <int></int>
              <apply>
               <csymbol cd="ambiguous">subscript</csymbol>
               <ci>t</ci>
               <cn type="integer">0</cn>
              </apply>
             </apply>
             <ci>t</ci>
            </apply>
            <apply>
             <times></times>
             <ci>d</ci>
             <apply>
              <csymbol cd="ambiguous">subscript</csymbol>
              <ci>t</ci>
              <cn type="integer">1</cn>
             </apply>
             <apply>
              <csymbol cd="latexml">quantum-operator-product</csymbol>
              <ci>m</ci>
              <apply>
               <times></times>
               <ci>V</ci>
               <apply>
                <csymbol cd="ambiguous">subscript</csymbol>
                <ci>t</ci>
                <cn type="integer">1</cn>
               </apply>
              </apply>
              <ci>n</ci>
             </apply>
             <apply>
              <csymbol cd="ambiguous">superscript</csymbol>
              <ci>e</ci>
              <apply>
               <minus></minus>
               <apply>
                <times></times>
                <apply>
                 <divide></divide>
                 <ci>i</ci>
                 <csymbol cd="latexml">Planck-constant-over-2-pi</csymbol>
                </apply>
                <apply>
                 <minus></minus>
                 <apply>
                  <csymbol cd="ambiguous">subscript</csymbol>
                  <ci>E</ci>
                  <ci>n</ci>
                 </apply>
                 <apply>
                  <csymbol cd="ambiguous">subscript</csymbol>
                  <ci>E</ci>
                  <ci>m</ci>
                 </apply>
                </apply>
                <apply>
                 <minus></minus>
                 <apply>
                  <csymbol cd="ambiguous">subscript</csymbol>
                  <ci>t</ci>
                  <cn type="integer">1</cn>
                 </apply>
                 <apply>
                  <csymbol cd="ambiguous">subscript</csymbol>
                  <ci>t</ci>
                  <cn type="integer">0</cn>
                 </apply>
                </apply>
               </apply>
              </apply>
             </apply>
             <apply>
              <csymbol cd="latexml">ket</csymbol>
              <ci>m</ci>
             </apply>
             <apply>
              <csymbol cd="latexml">bra</csymbol>
              <ci>n</ci>
             </apply>
            </apply>
           </apply>
          </apply>
         </apply>
        </apply>
       </apply>
       <ci>normal-…</ci>
      </apply>
     </apply>
     <apply>
      <csymbol cd="latexml">ket</csymbol>
      <apply>
       <times></times>
       <ci>ψ</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>t</ci>
        <cn type="integer">0</cn>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   |\psi_{I}(t)\rangle=\left[1-\frac{i\lambda}{\hbar}\sum_{m}\sum_{n}\int_{t_{0}}%
^{t}dt_{1}\langle m|V(t_{1})|n\rangle e^{-\frac{i}{\hbar}(E_{n}-E_{m})(t_{1}-t%
_{0})}|m\rangle\langle n|+\ldots\right]|\psi(t_{0})\rangle~{}.
  </annotation>
 </semantics>
</math>

</p>

<p>Thus, the system, initially in the unperturbed state 

<math display="inline" id="Perturbation_theory_(quantum_mechanics):167">
 <semantics>
  <mrow>
   <mrow>
    <mo fence="true" stretchy="false">|</mo>
    <mi>α</mi>
    <mo stretchy="false">⟩</mo>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mo fence="true" stretchy="false">|</mo>
    <mrow>
     <mi>ψ</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <msub>
       <mi>t</mi>
       <mn>0</mn>
      </msub>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo stretchy="false">⟩</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="latexml">ket</csymbol>
     <ci>α</ci>
    </apply>
    <apply>
     <csymbol cd="latexml">ket</csymbol>
     <apply>
      <times></times>
      <ci>ψ</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>t</ci>
       <cn type="integer">0</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   |\alpha\rangle=|\psi(t_{0})\rangle
  </annotation>
 </semantics>
</math>

, by dint of the perturbation can go into the state 

<math display="inline" id="Perturbation_theory_(quantum_mechanics):168">
 <semantics>
  <mrow>
   <mo fence="true" stretchy="false">|</mo>
   <mi>β</mi>
   <mo stretchy="false">⟩</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">ket</csymbol>
    <ci>β</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   |\beta\rangle
  </annotation>
 </semantics>
</math>

. The corresponding transition probability amplitude to first order is</p>

<p>

<math display="block" id="Perturbation_theory_(quantum_mechanics):169">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>A</mi>
     <mrow>
      <mi>α</mi>
      <mi>β</mi>
     </mrow>
    </msub>
    <mo>=</mo>
    <mrow>
     <mo>-</mo>
     <mrow>
      <mfrac>
       <mrow>
        <mi>i</mi>
        <mi>λ</mi>
       </mrow>
       <mi mathvariant="normal">ℏ</mi>
      </mfrac>
      <mrow>
       <msubsup>
        <mo largeop="true" symmetric="true">∫</mo>
        <msub>
         <mi>t</mi>
         <mn>0</mn>
        </msub>
        <mi>t</mi>
       </msubsup>
       <mrow>
        <mi>d</mi>
        <msub>
         <mi>t</mi>
         <mn>1</mn>
        </msub>
        <mrow>
         <mo stretchy="false">⟨</mo>
         <mi>β</mi>
         <mo fence="true" stretchy="false">|</mo>
         <mrow>
          <mi>V</mi>
          <mrow>
           <mo stretchy="false">(</mo>
           <msub>
            <mi>t</mi>
            <mn>1</mn>
           </msub>
           <mo stretchy="false">)</mo>
          </mrow>
         </mrow>
         <mo fence="true" stretchy="false">|</mo>
         <mi>α</mi>
         <mo stretchy="false">⟩</mo>
        </mrow>
        <mpadded width="+3.3pt">
         <msup>
          <mi>e</mi>
          <mrow>
           <mo>-</mo>
           <mrow>
            <mfrac>
             <mi>i</mi>
             <mi mathvariant="normal">ℏ</mi>
            </mfrac>
            <mrow>
             <mo stretchy="false">(</mo>
             <mrow>
              <msub>
               <mi>E</mi>
               <mi>α</mi>
              </msub>
              <mo>-</mo>
              <msub>
               <mi>E</mi>
               <mi>β</mi>
              </msub>
             </mrow>
             <mo stretchy="false">)</mo>
            </mrow>
            <mrow>
             <mo stretchy="false">(</mo>
             <mrow>
              <msub>
               <mi>t</mi>
               <mn>1</mn>
              </msub>
              <mo>-</mo>
              <msub>
               <mi>t</mi>
               <mn>0</mn>
              </msub>
             </mrow>
             <mo stretchy="false">)</mo>
            </mrow>
           </mrow>
          </mrow>
         </msup>
        </mpadded>
       </mrow>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>A</ci>
     <apply>
      <times></times>
      <ci>α</ci>
      <ci>β</ci>
     </apply>
    </apply>
    <apply>
     <minus></minus>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <apply>
        <times></times>
        <ci>i</ci>
        <ci>λ</ci>
       </apply>
       <csymbol cd="latexml">Planck-constant-over-2-pi</csymbol>
      </apply>
      <apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <int></int>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>t</ci>
          <cn type="integer">0</cn>
         </apply>
        </apply>
        <ci>t</ci>
       </apply>
       <apply>
        <times></times>
        <ci>d</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>t</ci>
         <cn type="integer">1</cn>
        </apply>
        <apply>
         <csymbol cd="latexml">quantum-operator-product</csymbol>
         <ci>β</ci>
         <apply>
          <times></times>
          <ci>V</ci>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>t</ci>
           <cn type="integer">1</cn>
          </apply>
         </apply>
         <ci>α</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>e</ci>
         <apply>
          <minus></minus>
          <apply>
           <times></times>
           <apply>
            <divide></divide>
            <ci>i</ci>
            <csymbol cd="latexml">Planck-constant-over-2-pi</csymbol>
           </apply>
           <apply>
            <minus></minus>
            <apply>
             <csymbol cd="ambiguous">subscript</csymbol>
             <ci>E</ci>
             <ci>α</ci>
            </apply>
            <apply>
             <csymbol cd="ambiguous">subscript</csymbol>
             <ci>E</ci>
             <ci>β</ci>
            </apply>
           </apply>
           <apply>
            <minus></minus>
            <apply>
             <csymbol cd="ambiguous">subscript</csymbol>
             <ci>t</ci>
             <cn type="integer">1</cn>
            </apply>
            <apply>
             <csymbol cd="ambiguous">subscript</csymbol>
             <ci>t</ci>
             <cn type="integer">0</cn>
            </apply>
           </apply>
          </apply>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A_{\alpha\beta}=-\frac{i\lambda}{\hbar}\int_{t_{0}}^{t}dt_{1}\langle\beta|V(t_%
{1})|\alpha\rangle e^{-\frac{i}{\hbar}(E_{\alpha}-E_{\beta})(t_{1}-t_{0})}~{},
  </annotation>
 </semantics>
</math>

 as detailed in the previous section——while the corresponding transition probability to a continuum is furnished by <a href="Fermi's_golden_rule" title="wikilink">Fermi's golden rule</a>.</p>

<p>As an aside, note that time-independent perturbation theory is also organized inside this time-dependent perturbation theory Dyson series. To see this, write the unitary evolution operator, obtained from the above <a href="Dyson_series" title="wikilink">Dyson series</a>, as</p>

<p>

<math display="block" id="Perturbation_theory_(quantum_mechanics):170">
 <semantics>
  <mrow>
   <mrow>
    <mi>U</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>t</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mn>1</mn>
     <mo>-</mo>
     <mrow>
      <mfrac>
       <mrow>
        <mi>i</mi>
        <mi>λ</mi>
       </mrow>
       <mi mathvariant="normal">ℏ</mi>
      </mfrac>
      <mrow>
       <msubsup>
        <mo largeop="true" symmetric="true">∫</mo>
        <msub>
         <mi>t</mi>
         <mn>0</mn>
        </msub>
        <mi>t</mi>
       </msubsup>
       <mrow>
        <mi>d</mi>
        <msub>
         <mi>t</mi>
         <mn>1</mn>
        </msub>
        <msup>
         <mi>e</mi>
         <mrow>
          <mfrac>
           <mi>i</mi>
           <mi mathvariant="normal">ℏ</mi>
          </mfrac>
          <msub>
           <mi>H</mi>
           <mn>0</mn>
          </msub>
          <mrow>
           <mo stretchy="false">(</mo>
           <mrow>
            <msub>
             <mi>t</mi>
             <mn>1</mn>
            </msub>
            <mo>-</mo>
            <msub>
             <mi>t</mi>
             <mn>0</mn>
            </msub>
           </mrow>
           <mo stretchy="false">)</mo>
          </mrow>
         </mrow>
        </msup>
        <mi>V</mi>
        <mrow>
         <mo stretchy="false">(</mo>
         <msub>
          <mi>t</mi>
          <mn>1</mn>
         </msub>
         <mo stretchy="false">)</mo>
        </mrow>
        <msup>
         <mi>e</mi>
         <mrow>
          <mo>-</mo>
          <mrow>
           <mfrac>
            <mi>i</mi>
            <mi mathvariant="normal">ℏ</mi>
           </mfrac>
           <msub>
            <mi>H</mi>
            <mn>0</mn>
           </msub>
           <mrow>
            <mo stretchy="false">(</mo>
            <mrow>
             <msub>
              <mi>t</mi>
              <mn>1</mn>
             </msub>
             <mo>-</mo>
             <msub>
              <mi>t</mi>
              <mn>0</mn>
             </msub>
            </mrow>
            <mo stretchy="false">)</mo>
           </mrow>
          </mrow>
         </mrow>
        </msup>
       </mrow>
      </mrow>
     </mrow>
     <mo>-</mo>
     <mrow>
      <mfrac>
       <msup>
        <mi>λ</mi>
        <mn>2</mn>
       </msup>
       <msup>
        <mi mathvariant="normal">ℏ</mi>
        <mn>2</mn>
       </msup>
      </mfrac>
      <mrow>
       <msubsup>
        <mo largeop="true" symmetric="true">∫</mo>
        <msub>
         <mi>t</mi>
         <mn>0</mn>
        </msub>
        <mi>t</mi>
       </msubsup>
       <mrow>
        <mi>d</mi>
        <msub>
         <mi>t</mi>
         <mn>1</mn>
        </msub>
        <mrow>
         <msubsup>
          <mo largeop="true" symmetric="true">∫</mo>
          <msub>
           <mi>t</mi>
           <mn>0</mn>
          </msub>
          <msub>
           <mi>t</mi>
           <mn>1</mn>
          </msub>
         </msubsup>
         <mrow>
          <mi>d</mi>
          <msub>
           <mi>t</mi>
           <mn>2</mn>
          </msub>
          <msup>
           <mi>e</mi>
           <mrow>
            <mfrac>
             <mi>i</mi>
             <mi mathvariant="normal">ℏ</mi>
            </mfrac>
            <msub>
             <mi>H</mi>
             <mn>0</mn>
            </msub>
            <mrow>
             <mo stretchy="false">(</mo>
             <mrow>
              <msub>
               <mi>t</mi>
               <mn>1</mn>
              </msub>
              <mo>-</mo>
              <msub>
               <mi>t</mi>
               <mn>0</mn>
              </msub>
             </mrow>
             <mo stretchy="false">)</mo>
            </mrow>
           </mrow>
          </msup>
          <mi>V</mi>
          <mrow>
           <mo stretchy="false">(</mo>
           <msub>
            <mi>t</mi>
            <mn>1</mn>
           </msub>
           <mo stretchy="false">)</mo>
          </mrow>
          <msup>
           <mi>e</mi>
           <mrow>
            <mo>-</mo>
            <mrow>
             <mfrac>
              <mi>i</mi>
              <mi mathvariant="normal">ℏ</mi>
             </mfrac>
             <msub>
              <mi>H</mi>
              <mn>0</mn>
             </msub>
             <mrow>
              <mo stretchy="false">(</mo>
              <mrow>
               <msub>
                <mi>t</mi>
                <mn>1</mn>
               </msub>
               <mo>-</mo>
               <msub>
                <mi>t</mi>
                <mn>0</mn>
               </msub>
              </mrow>
              <mo stretchy="false">)</mo>
             </mrow>
            </mrow>
           </mrow>
          </msup>
          <msup>
           <mi>e</mi>
           <mrow>
            <mfrac>
             <mi>i</mi>
             <mi mathvariant="normal">ℏ</mi>
            </mfrac>
            <msub>
             <mi>H</mi>
             <mn>0</mn>
            </msub>
            <mrow>
             <mo stretchy="false">(</mo>
             <mrow>
              <msub>
               <mi>t</mi>
               <mn>2</mn>
              </msub>
              <mo>-</mo>
              <msub>
               <mi>t</mi>
               <mn>0</mn>
              </msub>
             </mrow>
             <mo stretchy="false">)</mo>
            </mrow>
           </mrow>
          </msup>
          <mi>V</mi>
          <mrow>
           <mo stretchy="false">(</mo>
           <msub>
            <mi>t</mi>
            <mn>2</mn>
           </msub>
           <mo stretchy="false">)</mo>
          </mrow>
          <msup>
           <mi>e</mi>
           <mrow>
            <mo>-</mo>
            <mrow>
             <mfrac>
              <mi>i</mi>
              <mi mathvariant="normal">ℏ</mi>
             </mfrac>
             <msub>
              <mi>H</mi>
              <mn>0</mn>
             </msub>
             <mrow>
              <mo stretchy="false">(</mo>
              <mrow>
               <msub>
                <mi>t</mi>
                <mn>2</mn>
               </msub>
               <mo>-</mo>
               <msub>
                <mi>t</mi>
                <mn>0</mn>
               </msub>
              </mrow>
              <mo stretchy="false">)</mo>
             </mrow>
            </mrow>
           </mrow>
          </msup>
         </mrow>
        </mrow>
       </mrow>
      </mrow>
     </mrow>
    </mrow>
    <mo>+</mo>
    <mi mathvariant="normal">⋯</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>U</ci>
     <ci>t</ci>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <minus></minus>
      <cn type="integer">1</cn>
      <apply>
       <times></times>
       <apply>
        <divide></divide>
        <apply>
         <times></times>
         <ci>i</ci>
         <ci>λ</ci>
        </apply>
        <csymbol cd="latexml">Planck-constant-over-2-pi</csymbol>
       </apply>
       <apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <int></int>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>t</ci>
           <cn type="integer">0</cn>
          </apply>
         </apply>
         <ci>t</ci>
        </apply>
        <apply>
         <times></times>
         <ci>d</ci>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>t</ci>
          <cn type="integer">1</cn>
         </apply>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>e</ci>
          <apply>
           <times></times>
           <apply>
            <divide></divide>
            <ci>i</ci>
            <csymbol cd="latexml">Planck-constant-over-2-pi</csymbol>
           </apply>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <ci>H</ci>
            <cn type="integer">0</cn>
           </apply>
           <apply>
            <minus></minus>
            <apply>
             <csymbol cd="ambiguous">subscript</csymbol>
             <ci>t</ci>
             <cn type="integer">1</cn>
            </apply>
            <apply>
             <csymbol cd="ambiguous">subscript</csymbol>
             <ci>t</ci>
             <cn type="integer">0</cn>
            </apply>
           </apply>
          </apply>
         </apply>
         <ci>V</ci>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>t</ci>
          <cn type="integer">1</cn>
         </apply>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>e</ci>
          <apply>
           <minus></minus>
           <apply>
            <times></times>
            <apply>
             <divide></divide>
             <ci>i</ci>
             <csymbol cd="latexml">Planck-constant-over-2-pi</csymbol>
            </apply>
            <apply>
             <csymbol cd="ambiguous">subscript</csymbol>
             <ci>H</ci>
             <cn type="integer">0</cn>
            </apply>
            <apply>
             <minus></minus>
             <apply>
              <csymbol cd="ambiguous">subscript</csymbol>
              <ci>t</ci>
              <cn type="integer">1</cn>
             </apply>
             <apply>
              <csymbol cd="ambiguous">subscript</csymbol>
              <ci>t</ci>
              <cn type="integer">0</cn>
             </apply>
            </apply>
           </apply>
          </apply>
         </apply>
        </apply>
       </apply>
      </apply>
      <apply>
       <times></times>
       <apply>
        <divide></divide>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>λ</ci>
         <cn type="integer">2</cn>
        </apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <csymbol cd="latexml">Planck-constant-over-2-pi</csymbol>
         <cn type="integer">2</cn>
        </apply>
       </apply>
       <apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <int></int>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>t</ci>
           <cn type="integer">0</cn>
          </apply>
         </apply>
         <ci>t</ci>
        </apply>
        <apply>
         <times></times>
         <ci>d</ci>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>t</ci>
          <cn type="integer">1</cn>
         </apply>
         <apply>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <int></int>
            <apply>
             <csymbol cd="ambiguous">subscript</csymbol>
             <ci>t</ci>
             <cn type="integer">0</cn>
            </apply>
           </apply>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <ci>t</ci>
            <cn type="integer">1</cn>
           </apply>
          </apply>
          <apply>
           <times></times>
           <ci>d</ci>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <ci>t</ci>
            <cn type="integer">2</cn>
           </apply>
           <apply>
            <csymbol cd="ambiguous">superscript</csymbol>
            <ci>e</ci>
            <apply>
             <times></times>
             <apply>
              <divide></divide>
              <ci>i</ci>
              <csymbol cd="latexml">Planck-constant-over-2-pi</csymbol>
             </apply>
             <apply>
              <csymbol cd="ambiguous">subscript</csymbol>
              <ci>H</ci>
              <cn type="integer">0</cn>
             </apply>
             <apply>
              <minus></minus>
              <apply>
               <csymbol cd="ambiguous">subscript</csymbol>
               <ci>t</ci>
               <cn type="integer">1</cn>
              </apply>
              <apply>
               <csymbol cd="ambiguous">subscript</csymbol>
               <ci>t</ci>
               <cn type="integer">0</cn>
              </apply>
             </apply>
            </apply>
           </apply>
           <ci>V</ci>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <ci>t</ci>
            <cn type="integer">1</cn>
           </apply>
           <apply>
            <csymbol cd="ambiguous">superscript</csymbol>
            <ci>e</ci>
            <apply>
             <minus></minus>
             <apply>
              <times></times>
              <apply>
               <divide></divide>
               <ci>i</ci>
               <csymbol cd="latexml">Planck-constant-over-2-pi</csymbol>
              </apply>
              <apply>
               <csymbol cd="ambiguous">subscript</csymbol>
               <ci>H</ci>
               <cn type="integer">0</cn>
              </apply>
              <apply>
               <minus></minus>
               <apply>
                <csymbol cd="ambiguous">subscript</csymbol>
                <ci>t</ci>
                <cn type="integer">1</cn>
               </apply>
               <apply>
                <csymbol cd="ambiguous">subscript</csymbol>
                <ci>t</ci>
                <cn type="integer">0</cn>
               </apply>
              </apply>
             </apply>
            </apply>
           </apply>
           <apply>
            <csymbol cd="ambiguous">superscript</csymbol>
            <ci>e</ci>
            <apply>
             <times></times>
             <apply>
              <divide></divide>
              <ci>i</ci>
              <csymbol cd="latexml">Planck-constant-over-2-pi</csymbol>
             </apply>
             <apply>
              <csymbol cd="ambiguous">subscript</csymbol>
              <ci>H</ci>
              <cn type="integer">0</cn>
             </apply>
             <apply>
              <minus></minus>
              <apply>
               <csymbol cd="ambiguous">subscript</csymbol>
               <ci>t</ci>
               <cn type="integer">2</cn>
              </apply>
              <apply>
               <csymbol cd="ambiguous">subscript</csymbol>
               <ci>t</ci>
               <cn type="integer">0</cn>
              </apply>
             </apply>
            </apply>
           </apply>
           <ci>V</ci>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <ci>t</ci>
            <cn type="integer">2</cn>
           </apply>
           <apply>
            <csymbol cd="ambiguous">superscript</csymbol>
            <ci>e</ci>
            <apply>
             <minus></minus>
             <apply>
              <times></times>
              <apply>
               <divide></divide>
               <ci>i</ci>
               <csymbol cd="latexml">Planck-constant-over-2-pi</csymbol>
              </apply>
              <apply>
               <csymbol cd="ambiguous">subscript</csymbol>
               <ci>H</ci>
               <cn type="integer">0</cn>
              </apply>
              <apply>
               <minus></minus>
               <apply>
                <csymbol cd="ambiguous">subscript</csymbol>
                <ci>t</ci>
                <cn type="integer">2</cn>
               </apply>
               <apply>
                <csymbol cd="ambiguous">subscript</csymbol>
                <ci>t</ci>
                <cn type="integer">0</cn>
               </apply>
              </apply>
             </apply>
            </apply>
           </apply>
          </apply>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
     <ci>normal-⋯</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   U(t)=1-\frac{i\lambda}{\hbar}\int_{t_{0}}^{t}dt_{1}e^{\frac{i}{\hbar}H_{0}(t_{%
1}-t_{0})}V(t_{1})e^{-\frac{i}{\hbar}H_{0}(t_{1}-t_{0})}-\frac{\lambda^{2}}{%
\hbar^{2}}\int_{t_{0}}^{t}dt_{1}\int_{t_{0}}^{t_{1}}dt_{2}e^{\frac{i}{\hbar}H_%
{0}(t_{1}-t_{0})}V(t_{1})e^{-\frac{i}{\hbar}H_{0}(t_{1}-t_{0})}e^{\frac{i}{%
\hbar}H_{0}(t_{2}-t_{0})}V(t_{2})e^{-\frac{i}{\hbar}H_{0}(t_{2}-t_{0})}+\cdots
  </annotation>
 </semantics>
</math>

 and take the perturbation 

<math display="inline" id="Perturbation_theory_(quantum_mechanics):171">
 <semantics>
  <mi>V</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>V</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   V
  </annotation>
 </semantics>
</math>


 to be time-independent.</p>

<p>Using the identity resolution</p>

<p>

<math display="block" id="Perturbation_theory_(quantum_mechanics):172">
 <semantics>
  <mrow>
   <mrow>
    <munder>
     <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
     <mi>n</mi>
    </munder>
    <mrow>
     <mrow>
      <mo fence="true" stretchy="false">|</mo>
      <mi>n</mi>
      <mo stretchy="false">⟩</mo>
     </mrow>
     <mrow>
      <mo stretchy="false">⟨</mo>
      <mi>n</mi>
      <mo fence="true" stretchy="false">|</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <sum></sum>
      <ci>n</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="latexml">ket</csymbol>
       <ci>n</ci>
      </apply>
      <apply>
       <csymbol cd="latexml">bra</csymbol>
       <ci>n</ci>
      </apply>
     </apply>
    </apply>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \sum_{n}|n\rangle\langle n|=1
  </annotation>
 </semantics>
</math>

 with 

<math display="inline" id="Perturbation_theory_(quantum_mechanics):173">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>H</mi>
     <mn>0</mn>
    </msub>
    <mrow>
     <mo fence="true" stretchy="false">|</mo>
     <mi>n</mi>
     <mo stretchy="false">⟩</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <msub>
     <mi>E</mi>
     <mi>n</mi>
    </msub>
    <mrow>
     <mo fence="true" stretchy="false">|</mo>
     <mi>n</mi>
     <mo stretchy="false">⟩</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>H</ci>
      <cn type="integer">0</cn>
     </apply>
     <apply>
      <csymbol cd="latexml">ket</csymbol>
      <ci>n</ci>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>E</ci>
      <ci>n</ci>
     </apply>
     <apply>
      <csymbol cd="latexml">ket</csymbol>
      <ci>n</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   H_{0}|n\rangle=E_{n}|n\rangle
  </annotation>
 </semantics>
</math>

 for a pure discrete spectrum, write</p>

<p>

<math display="inline" id="Perturbation_theory_(quantum_mechanics):174">
 <semantics>
  <mrow>
   <mrow>
    <mi>U</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>t</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>U</ci>
     <ci>t</ci>
    </apply>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle U(t)=1
  </annotation>
 </semantics>
</math>


</p>

<p>It is evident that, at second order, one must sum on all the intermediate states. Assume 

<math display="inline" id="Perturbation_theory_(quantum_mechanics):175">
 <semantics>
  <mrow>
   <msub>
    <mi>t</mi>
    <mn>0</mn>
   </msub>
   <mo>=</mo>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>t</ci>
     <cn type="integer">0</cn>
    </apply>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   t_{0}=0
  </annotation>
 </semantics>
</math>

 and the asymptotic limit of larger times. This means that, at each contribution of the perturbation series, one has to add a multiplicative factor 

<math display="inline" id="Perturbation_theory_(quantum_mechanics):176">
 <semantics>
  <msup>
   <mi>e</mi>
   <mrow>
    <mo>-</mo>
    <mrow>
     <mi>ϵ</mi>
     <mi>t</mi>
    </mrow>
   </mrow>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>e</ci>
    <apply>
     <minus></minus>
     <apply>
      <times></times>
      <ci>ϵ</ci>
      <ci>t</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   e^{-\epsilon t}
  </annotation>
 </semantics>
</math>

 in the integrands for 

<math display="inline" id="Perturbation_theory_(quantum_mechanics):177">
 <semantics>
  <mi>ε</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>ε</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   ε
  </annotation>
 </semantics>
</math>

 arbitrarily small. Thus the limit 

<math display="inline" id="Perturbation_theory_(quantum_mechanics):178">
 <semantics>
  <mrow>
   <mi>t</mi>
   <mi mathvariant="normal">→</mi>
   <mi mathvariant="normal">∞</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>t</ci>
    <ci>normal-→</ci>
    <ci>normal-∞</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   t→∞
  </annotation>
 </semantics>
</math>

 gives back the final state of the system by eliminating all oscillating terms, but keeping the secular ones. The integrals are thus computable, and, separating the diagonal terms from the others yields</p>

<p>

<math display="inline" id="Perturbation_theory_(quantum_mechanics):179">
 <semantics>
  <mrow>
   <mrow>
    <mi>U</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>t</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>U</ci>
     <ci>t</ci>
    </apply>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle U(t)=1
  </annotation>
 </semantics>
</math>


 where the time secular series yields the eigenvalues of the perturbed problem specified above, recursively; whereas the remaining time-constant part yields the corrections to the stationary eigenfunctions also given above (

<math display="inline" id="Perturbation_theory_(quantum_mechanics):180">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mo stretchy="false">|</mo>
     <mi>n</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>λ</mi>
      <mo stretchy="false">)</mo>
     </mrow>
     <mo stretchy="false">⟩</mo>
    </mrow>
    <mo>=</mo>
    <mi>U</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mn>0</mn>
     <mo>;</mo>
     <mi>λ</mi>
     <mo stretchy="false">)</mo>
    </mrow>
    <mo stretchy="false">|</mo>
    <mi>n</mi>
    <mo stretchy="false">⟩</mo>
   </mrow>
   <mo stretchy="false">)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <ci>normal-|</ci>
      <csymbol cd="unknown">n</csymbol>
      <cerror>
       <csymbol cd="ambiguous">fragments</csymbol>
       <ci>normal-(</ci>
       <csymbol cd="unknown">λ</csymbol>
       <ci>normal-)</ci>
      </cerror>
      <ci>normal-⟩</ci>
     </cerror>
     <eq></eq>
     <csymbol cd="unknown">U</csymbol>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <ci>normal-(</ci>
      <cn type="integer">0</cn>
      <ci>normal-;</ci>
      <csymbol cd="unknown">λ</csymbol>
      <ci>normal-)</ci>
     </cerror>
     <ci>normal-|</ci>
     <csymbol cd="unknown">n</csymbol>
     <ci>normal-⟩</ci>
    </cerror>
    <ci>normal-)</ci>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   |n(\lambda)\rangle=U(0;\lambda)|n\rangle)
  </annotation>
 </semantics>
</math>

.)</p>

<p>The unitary evolution operator is applicable to arbitrary eigenstates of the unperturbed problem and, in this case, yields a secular series that holds at small times.</p>
<h2 id="strong-perturbation-theory">Strong perturbation theory</h2>

<p>In a similar way as for small perturbations, it is possible to develop a strong perturbation theory. Let us consider as usual the <a href="Schrödinger_equation" title="wikilink">Schrödinger equation</a></p>

<p>

<math display="block" id="Perturbation_theory_(quantum_mechanics):181">
 <semantics>
  <mrow>
   <mrow>
    <mi>H</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>t</mi>
     <mo stretchy="false">)</mo>
    </mrow>
    <mrow>
     <mo fence="true" stretchy="false">|</mo>
     <mrow>
      <mi>ψ</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>t</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo stretchy="false">⟩</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mi>i</mi>
    <mi mathvariant="normal">ℏ</mi>
    <mfrac>
     <mrow>
      <mo>∂</mo>
      <mrow>
       <mo fence="true" stretchy="false">|</mo>
       <mrow>
        <mi>ψ</mi>
        <mrow>
         <mo stretchy="false">(</mo>
         <mi>t</mi>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
       <mo stretchy="false">⟩</mo>
      </mrow>
     </mrow>
     <mrow>
      <mo>∂</mo>
      <mi>t</mi>
     </mrow>
    </mfrac>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>H</ci>
     <ci>t</ci>
     <apply>
      <csymbol cd="latexml">ket</csymbol>
      <apply>
       <times></times>
       <ci>ψ</ci>
       <ci>t</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <times></times>
     <ci>i</ci>
     <csymbol cd="latexml">Planck-constant-over-2-pi</csymbol>
     <apply>
      <divide></divide>
      <apply>
       <times></times>
       <partialdiff></partialdiff>
       <apply>
        <csymbol cd="latexml">ket</csymbol>
        <apply>
         <times></times>
         <ci>ψ</ci>
         <ci>t</ci>
        </apply>
       </apply>
      </apply>
      <apply>
       <partialdiff></partialdiff>
       <ci>t</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   H(t)|\psi(t)\rangle=i\hbar\frac{\partial|\psi(t)\rangle}{\partial t}
  </annotation>
 </semantics>
</math>

</p>

<p>and we consider the question if a dual Dyson series exists that applies in the limit of a perturbation increasingly large. This question can be answered in an affirmative way <a class="footnoteRef" href="#fn7" id="fnref7"><sup>7</sup></a> and the series is the well-known adiabatic series.<a class="footnoteRef" href="#fn8" id="fnref8"><sup>8</sup></a> This approach is quite general and can be shown in the following way. Let us consider the perturbation problem</p>

<p>

<math display="block" id="Perturbation_theory_(quantum_mechanics):182">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mo stretchy="false">[</mo>
     <mrow>
      <msub>
       <mi>H</mi>
       <mn>0</mn>
      </msub>
      <mo>+</mo>
      <mrow>
       <mi>λ</mi>
       <mi>V</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>t</mi>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
     </mrow>
     <mo stretchy="false">]</mo>
    </mrow>
    <mrow>
     <mo fence="true" stretchy="false">|</mo>
     <mrow>
      <mi>ψ</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>t</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo stretchy="false">⟩</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mi>i</mi>
    <mi mathvariant="normal">ℏ</mi>
    <mfrac>
     <mrow>
      <mo>∂</mo>
      <mrow>
       <mo fence="true" stretchy="false">|</mo>
       <mrow>
        <mi>ψ</mi>
        <mrow>
         <mo stretchy="false">(</mo>
         <mi>t</mi>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
       <mo stretchy="false">⟩</mo>
      </mrow>
     </mrow>
     <mrow>
      <mo>∂</mo>
      <mi>t</mi>
     </mrow>
    </mfrac>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="latexml">delimited-[]</csymbol>
      <apply>
       <plus></plus>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>H</ci>
        <cn type="integer">0</cn>
       </apply>
       <apply>
        <times></times>
        <ci>λ</ci>
        <ci>V</ci>
        <ci>t</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <csymbol cd="latexml">ket</csymbol>
      <apply>
       <times></times>
       <ci>ψ</ci>
       <ci>t</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <times></times>
     <ci>i</ci>
     <csymbol cd="latexml">Planck-constant-over-2-pi</csymbol>
     <apply>
      <divide></divide>
      <apply>
       <times></times>
       <partialdiff></partialdiff>
       <apply>
        <csymbol cd="latexml">ket</csymbol>
        <apply>
         <times></times>
         <ci>ψ</ci>
         <ci>t</ci>
        </apply>
       </apply>
      </apply>
      <apply>
       <partialdiff></partialdiff>
       <ci>t</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   [H_{0}+\lambda V(t)]|\psi(t)\rangle=i\hbar\frac{\partial|\psi(t)\rangle}{%
\partial t}
  </annotation>
 </semantics>
</math>

</p>

<p>being 

<math display="inline" id="Perturbation_theory_(quantum_mechanics):183">
 <semantics>
  <mrow>
   <mi>λ</mi>
   <mi mathvariant="normal">→</mi>
   <mi mathvariant="normal">∞</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>λ</ci>
    <ci>normal-→</ci>
    <ci>normal-∞</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   λ→∞
  </annotation>
 </semantics>
</math>

. Our aim is to find a solution in the form</p>

<p>

<math display="block" id="Perturbation_theory_(quantum_mechanics):184">
 <semantics>
  <mrow>
   <mrow>
    <mo fence="true" stretchy="false">|</mo>
    <mi>ψ</mi>
    <mo stretchy="false">⟩</mo>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mo fence="true" stretchy="false">|</mo>
     <msub>
      <mi>ψ</mi>
      <mn>0</mn>
     </msub>
     <mo stretchy="false">⟩</mo>
    </mrow>
    <mo>+</mo>
    <mrow>
     <mfrac>
      <mn>1</mn>
      <mi>λ</mi>
     </mfrac>
     <mrow>
      <mo fence="true" stretchy="false">|</mo>
      <msub>
       <mi>ψ</mi>
       <mn>1</mn>
      </msub>
      <mo stretchy="false">⟩</mo>
     </mrow>
    </mrow>
    <mo>+</mo>
    <mrow>
     <mfrac>
      <mn>1</mn>
      <msup>
       <mi>λ</mi>
       <mn>2</mn>
      </msup>
     </mfrac>
     <mrow>
      <mo fence="true" stretchy="false">|</mo>
      <msub>
       <mi>ψ</mi>
       <mn>2</mn>
      </msub>
      <mo stretchy="false">⟩</mo>
     </mrow>
    </mrow>
    <mo>+</mo>
    <mi mathvariant="normal">…</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="latexml">ket</csymbol>
     <ci>ψ</ci>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <csymbol cd="latexml">ket</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>ψ</ci>
       <cn type="integer">0</cn>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <ci>λ</ci>
      </apply>
      <apply>
       <csymbol cd="latexml">ket</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>ψ</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>λ</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
      <apply>
       <csymbol cd="latexml">ket</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>ψ</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
     </apply>
     <ci>normal-…</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   |\psi\rangle=|\psi_{0}\rangle+\frac{1}{\lambda}|\psi_{1}\rangle+\frac{1}{%
\lambda^{2}}|\psi_{2}\rangle+\ldots
  </annotation>
 </semantics>
</math>

</p>

<p>but a direct substitution into the above equation fails to produce useful results. This situation can be adjusted making a rescaling of the time variable as 

<math display="inline" id="Perturbation_theory_(quantum_mechanics):185">
 <semantics>
  <mrow>
   <mi>τ</mi>
   <mo>=</mo>
   <mrow>
    <mi>λ</mi>
    <mi>t</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>τ</ci>
    <apply>
     <times></times>
     <ci>λ</ci>
     <ci>t</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \tau=\lambda t
  </annotation>
 </semantics>
</math>

 producing the following meaningful equations</p>

<p>

<math display="block" id="Perturbation_theory_(quantum_mechanics):186">
 <semantics>
  <mrow>
   <mrow>
    <mi>V</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>t</mi>
     <mo stretchy="false">)</mo>
    </mrow>
    <mrow>
     <mo fence="true" stretchy="false">|</mo>
     <msub>
      <mi>ψ</mi>
      <mn>0</mn>
     </msub>
     <mo stretchy="false">⟩</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mi>i</mi>
    <mi mathvariant="normal">ℏ</mi>
    <mfrac>
     <mrow>
      <mo>∂</mo>
      <mrow>
       <mo fence="true" stretchy="false">|</mo>
       <msub>
        <mi>ψ</mi>
        <mn>0</mn>
       </msub>
       <mo stretchy="false">⟩</mo>
      </mrow>
     </mrow>
     <mrow>
      <mo>∂</mo>
      <mi>τ</mi>
     </mrow>
    </mfrac>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>V</ci>
     <ci>t</ci>
     <apply>
      <csymbol cd="latexml">ket</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>ψ</ci>
       <cn type="integer">0</cn>
      </apply>
     </apply>
    </apply>
    <apply>
     <times></times>
     <ci>i</ci>
     <csymbol cd="latexml">Planck-constant-over-2-pi</csymbol>
     <apply>
      <divide></divide>
      <apply>
       <times></times>
       <partialdiff></partialdiff>
       <apply>
        <csymbol cd="latexml">ket</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>ψ</ci>
         <cn type="integer">0</cn>
        </apply>
       </apply>
      </apply>
      <apply>
       <partialdiff></partialdiff>
       <ci>τ</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   V(t)|\psi_{0}\rangle=i\hbar\frac{\partial|\psi_{0}\rangle}{\partial\tau}
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Perturbation_theory_(quantum_mechanics):187">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>V</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>t</mi>
      <mo stretchy="false">)</mo>
     </mrow>
     <mrow>
      <mo fence="true" stretchy="false">|</mo>
      <msub>
       <mi>ψ</mi>
       <mn>1</mn>
      </msub>
      <mo stretchy="false">⟩</mo>
     </mrow>
    </mrow>
    <mo>+</mo>
    <mrow>
     <msub>
      <mi>H</mi>
      <mn>0</mn>
     </msub>
     <mrow>
      <mo fence="true" stretchy="false">|</mo>
      <msub>
       <mi>ψ</mi>
       <mn>0</mn>
      </msub>
      <mo stretchy="false">⟩</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mi>i</mi>
    <mi mathvariant="normal">ℏ</mi>
    <mfrac>
     <mrow>
      <mo>∂</mo>
      <mrow>
       <mo fence="true" stretchy="false">|</mo>
       <msub>
        <mi>ψ</mi>
        <mn>1</mn>
       </msub>
       <mo stretchy="false">⟩</mo>
      </mrow>
     </mrow>
     <mrow>
      <mo>∂</mo>
      <mi>τ</mi>
     </mrow>
    </mfrac>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <ci>V</ci>
      <ci>t</ci>
      <apply>
       <csymbol cd="latexml">ket</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>ψ</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>H</ci>
       <cn type="integer">0</cn>
      </apply>
      <apply>
       <csymbol cd="latexml">ket</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>ψ</ci>
        <cn type="integer">0</cn>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <times></times>
     <ci>i</ci>
     <csymbol cd="latexml">Planck-constant-over-2-pi</csymbol>
     <apply>
      <divide></divide>
      <apply>
       <times></times>
       <partialdiff></partialdiff>
       <apply>
        <csymbol cd="latexml">ket</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>ψ</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
      </apply>
      <apply>
       <partialdiff></partialdiff>
       <ci>τ</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   V(t)|\psi_{1}\rangle+H_{0}|\psi_{0}\rangle=i\hbar\frac{\partial|\psi_{1}%
\rangle}{\partial\tau}
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Perturbation_theory_(quantum_mechanics):188">
 <semantics>
  <mi mathvariant="normal">⋮</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>normal-⋮</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \vdots
  </annotation>
 </semantics>
</math>

</p>

<p>that can be solved once we know the solution of the <a href="leading-order" title="wikilink">leading order</a> equation. But we know that in this case we can use the <a href="adiabatic_approximation" title="wikilink">adiabatic approximation</a>. When 

<math display="inline" id="Perturbation_theory_(quantum_mechanics):189">
 <semantics>
  <mrow>
   <mi>V</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>t</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>V</ci>
    <ci>t</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   V(t)
  </annotation>
 </semantics>
</math>

 does not depend on time one gets the <a href="Wigner-Kirkwood_series" title="wikilink">Wigner-Kirkwood series</a> that is often used in <a href="statistical_mechanics" title="wikilink">statistical mechanics</a>. Indeed, in this case we introduce the unitary transformation</p>

<p>

<math display="block" id="Perturbation_theory_(quantum_mechanics):190">
 <semantics>
  <mrow>
   <mrow>
    <mo fence="true" stretchy="false">|</mo>
    <mrow>
     <mi>ψ</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>t</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo stretchy="false">⟩</mo>
   </mrow>
   <mo>=</mo>
   <mrow>
    <msup>
     <mi>e</mi>
     <mrow>
      <mo>-</mo>
      <mrow>
       <mfrac>
        <mi>i</mi>
        <mi mathvariant="normal">ℏ</mi>
       </mfrac>
       <mi>λ</mi>
       <mi>V</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mi>t</mi>
         <mo>-</mo>
         <msub>
          <mi>t</mi>
          <mn>0</mn>
         </msub>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
     </mrow>
    </msup>
    <mrow>
     <mo fence="true" stretchy="false">|</mo>
     <mrow>
      <msub>
       <mi>ψ</mi>
       <mi>F</mi>
      </msub>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>t</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo stretchy="false">⟩</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="latexml">ket</csymbol>
     <apply>
      <times></times>
      <ci>ψ</ci>
      <ci>t</ci>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>e</ci>
      <apply>
       <minus></minus>
       <apply>
        <times></times>
        <apply>
         <divide></divide>
         <ci>i</ci>
         <csymbol cd="latexml">Planck-constant-over-2-pi</csymbol>
        </apply>
        <ci>λ</ci>
        <ci>V</ci>
        <apply>
         <minus></minus>
         <ci>t</ci>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>t</ci>
          <cn type="integer">0</cn>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <csymbol cd="latexml">ket</csymbol>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>ψ</ci>
        <ci>F</ci>
       </apply>
       <ci>t</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   |\psi(t)\rangle=e^{-\frac{i}{\hbar}\lambda V(t-t_{0})}|\psi_{F}(t)\rangle
  </annotation>
 </semantics>
</math>

</p>

<p>that defines a <strong>free picture</strong> as we are trying to eliminate the interaction term. Now, in dual way with respect to the small perturbations, we have to solve the <a href="Schrödinger_equation" title="wikilink">Schrödinger equation</a></p>

<p>

<math display="block" id="Perturbation_theory_(quantum_mechanics):191">
 <semantics>
  <mrow>
   <mrow>
    <msup>
     <mi>e</mi>
     <mrow>
      <mfrac>
       <mi>i</mi>
       <mi mathvariant="normal">ℏ</mi>
      </mfrac>
      <mi>λ</mi>
      <mi>V</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mi>t</mi>
        <mo>-</mo>
        <msub>
         <mi>t</mi>
         <mn>0</mn>
        </msub>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </msup>
    <msub>
     <mi>H</mi>
     <mn>0</mn>
    </msub>
    <msup>
     <mi>e</mi>
     <mrow>
      <mo>-</mo>
      <mrow>
       <mfrac>
        <mi>i</mi>
        <mi mathvariant="normal">ℏ</mi>
       </mfrac>
       <mi>λ</mi>
       <mi>V</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mi>t</mi>
         <mo>-</mo>
         <msub>
          <mi>t</mi>
          <mn>0</mn>
         </msub>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
     </mrow>
    </msup>
    <mrow>
     <mo fence="true" stretchy="false">|</mo>
     <mrow>
      <msub>
       <mi>ψ</mi>
       <mi>F</mi>
      </msub>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>t</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo stretchy="false">⟩</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mi>i</mi>
    <mi mathvariant="normal">ℏ</mi>
    <mfrac>
     <mrow>
      <mo>∂</mo>
      <mrow>
       <mo fence="true" stretchy="false">|</mo>
       <mrow>
        <msub>
         <mi>ψ</mi>
         <mi>F</mi>
        </msub>
        <mrow>
         <mo stretchy="false">(</mo>
         <mi>t</mi>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
       <mo stretchy="false">⟩</mo>
      </mrow>
     </mrow>
     <mrow>
      <mo>∂</mo>
      <mi>t</mi>
     </mrow>
    </mfrac>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>e</ci>
      <apply>
       <times></times>
       <apply>
        <divide></divide>
        <ci>i</ci>
        <csymbol cd="latexml">Planck-constant-over-2-pi</csymbol>
       </apply>
       <ci>λ</ci>
       <ci>V</ci>
       <apply>
        <minus></minus>
        <ci>t</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>t</ci>
         <cn type="integer">0</cn>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>H</ci>
      <cn type="integer">0</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>e</ci>
      <apply>
       <minus></minus>
       <apply>
        <times></times>
        <apply>
         <divide></divide>
         <ci>i</ci>
         <csymbol cd="latexml">Planck-constant-over-2-pi</csymbol>
        </apply>
        <ci>λ</ci>
        <ci>V</ci>
        <apply>
         <minus></minus>
         <ci>t</ci>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>t</ci>
          <cn type="integer">0</cn>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <csymbol cd="latexml">ket</csymbol>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>ψ</ci>
        <ci>F</ci>
       </apply>
       <ci>t</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <times></times>
     <ci>i</ci>
     <csymbol cd="latexml">Planck-constant-over-2-pi</csymbol>
     <apply>
      <divide></divide>
      <apply>
       <times></times>
       <partialdiff></partialdiff>
       <apply>
        <csymbol cd="latexml">ket</csymbol>
        <apply>
         <times></times>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>ψ</ci>
          <ci>F</ci>
         </apply>
         <ci>t</ci>
        </apply>
       </apply>
      </apply>
      <apply>
       <partialdiff></partialdiff>
       <ci>t</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   e^{\frac{i}{\hbar}\lambda V(t-t_{0})}H_{0}e^{-\frac{i}{\hbar}\lambda V(t-t_{0}%
)}|\psi_{F}(t)\rangle=i\hbar\frac{\partial|\psi_{F}(t)\rangle}{\partial t}
  </annotation>
 </semantics>
</math>

</p>

<p>and we see that the expansion parameter 

<math display="inline" id="Perturbation_theory_(quantum_mechanics):192">
 <semantics>
  <mi>λ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>λ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   λ
  </annotation>
 </semantics>
</math>

 appears only into the exponential and so, the corresponding <a href="Dyson_series" title="wikilink">Dyson series</a>, a <strong>dual Dyson series</strong>, is meaningful at large 

<math display="inline" id="Perturbation_theory_(quantum_mechanics):193">
 <semantics>
  <mi>λ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>λ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   λ
  </annotation>
 </semantics>
</math>

s and is</p>

<p>

<math display="block" id="Perturbation_theory_(quantum_mechanics):194">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mo fence="true" stretchy="false">|</mo>
     <mrow>
      <msub>
       <mi>ψ</mi>
       <mi>F</mi>
      </msub>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>t</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo stretchy="false">⟩</mo>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mo>[</mo>
      <mrow>
       <mrow>
        <mn>1</mn>
        <mo>-</mo>
        <mrow>
         <mfrac>
          <mi>i</mi>
          <mi mathvariant="normal">ℏ</mi>
         </mfrac>
         <mrow>
          <msubsup>
           <mo largeop="true" symmetric="true">∫</mo>
           <msub>
            <mi>t</mi>
            <mn>0</mn>
           </msub>
           <mi>t</mi>
          </msubsup>
          <mrow>
           <mi>d</mi>
           <msub>
            <mi>t</mi>
            <mn>1</mn>
           </msub>
           <msup>
            <mi>e</mi>
            <mrow>
             <mfrac>
              <mi>i</mi>
              <mi mathvariant="normal">ℏ</mi>
             </mfrac>
             <mi>λ</mi>
             <mi>V</mi>
             <mrow>
              <mo stretchy="false">(</mo>
              <mrow>
               <msub>
                <mi>t</mi>
                <mn>1</mn>
               </msub>
               <mo>-</mo>
               <msub>
                <mi>t</mi>
                <mn>0</mn>
               </msub>
              </mrow>
              <mo stretchy="false">)</mo>
             </mrow>
            </mrow>
           </msup>
           <msub>
            <mi>H</mi>
            <mn>0</mn>
           </msub>
           <msup>
            <mi>e</mi>
            <mrow>
             <mo>-</mo>
             <mrow>
              <mfrac>
               <mi>i</mi>
               <mi mathvariant="normal">ℏ</mi>
              </mfrac>
              <mi>λ</mi>
              <mi>V</mi>
              <mrow>
               <mo stretchy="false">(</mo>
               <mrow>
                <msub>
                 <mi>t</mi>
                 <mn>1</mn>
                </msub>
                <mo>-</mo>
                <msub>
                 <mi>t</mi>
                 <mn>0</mn>
                </msub>
               </mrow>
               <mo stretchy="false">)</mo>
              </mrow>
             </mrow>
            </mrow>
           </msup>
          </mrow>
         </mrow>
        </mrow>
        <mo>-</mo>
        <mrow>
         <mfrac>
          <mn>1</mn>
          <msup>
           <mi mathvariant="normal">ℏ</mi>
           <mn>2</mn>
          </msup>
         </mfrac>
         <mrow>
          <msubsup>
           <mo largeop="true" symmetric="true">∫</mo>
           <msub>
            <mi>t</mi>
            <mn>0</mn>
           </msub>
           <mi>t</mi>
          </msubsup>
          <mrow>
           <mi>d</mi>
           <msub>
            <mi>t</mi>
            <mn>1</mn>
           </msub>
           <mrow>
            <msubsup>
             <mo largeop="true" symmetric="true">∫</mo>
             <msub>
              <mi>t</mi>
              <mn>0</mn>
             </msub>
             <msub>
              <mi>t</mi>
              <mn>1</mn>
             </msub>
            </msubsup>
            <mrow>
             <mi>d</mi>
             <msub>
              <mi>t</mi>
              <mn>2</mn>
             </msub>
             <msup>
              <mi>e</mi>
              <mrow>
               <mfrac>
                <mi>i</mi>
                <mi mathvariant="normal">ℏ</mi>
               </mfrac>
               <mi>λ</mi>
               <mi>V</mi>
               <mrow>
                <mo stretchy="false">(</mo>
                <mrow>
                 <msub>
                  <mi>t</mi>
                  <mn>1</mn>
                 </msub>
                 <mo>-</mo>
                 <msub>
                  <mi>t</mi>
                  <mn>0</mn>
                 </msub>
                </mrow>
                <mo stretchy="false">)</mo>
               </mrow>
              </mrow>
             </msup>
             <msub>
              <mi>H</mi>
              <mn>0</mn>
             </msub>
             <msup>
              <mi>e</mi>
              <mrow>
               <mo>-</mo>
               <mrow>
                <mfrac>
                 <mi>i</mi>
                 <mi mathvariant="normal">ℏ</mi>
                </mfrac>
                <mi>λ</mi>
                <mi>V</mi>
                <mrow>
                 <mo stretchy="false">(</mo>
                 <mrow>
                  <msub>
                   <mi>t</mi>
                   <mn>1</mn>
                  </msub>
                  <mo>-</mo>
                  <msub>
                   <mi>t</mi>
                   <mn>0</mn>
                  </msub>
                 </mrow>
                 <mo stretchy="false">)</mo>
                </mrow>
               </mrow>
              </mrow>
             </msup>
             <msup>
              <mi>e</mi>
              <mrow>
               <mfrac>
                <mi>i</mi>
                <mi mathvariant="normal">ℏ</mi>
               </mfrac>
               <mi>λ</mi>
               <mi>V</mi>
               <mrow>
                <mo stretchy="false">(</mo>
                <mrow>
                 <msub>
                  <mi>t</mi>
                  <mn>2</mn>
                 </msub>
                 <mo>-</mo>
                 <msub>
                  <mi>t</mi>
                  <mn>0</mn>
                 </msub>
                </mrow>
                <mo stretchy="false">)</mo>
               </mrow>
              </mrow>
             </msup>
             <msub>
              <mi>H</mi>
              <mn>0</mn>
             </msub>
             <msup>
              <mi>e</mi>
              <mrow>
               <mo>-</mo>
               <mrow>
                <mfrac>
                 <mi>i</mi>
                 <mi mathvariant="normal">ℏ</mi>
                </mfrac>
                <mi>λ</mi>
                <mi>V</mi>
                <mrow>
                 <mo stretchy="false">(</mo>
                 <mrow>
                  <msub>
                   <mi>t</mi>
                   <mn>2</mn>
                  </msub>
                  <mo>-</mo>
                  <msub>
                   <mi>t</mi>
                   <mn>0</mn>
                  </msub>
                 </mrow>
                 <mo stretchy="false">)</mo>
                </mrow>
               </mrow>
              </mrow>
             </msup>
            </mrow>
           </mrow>
          </mrow>
         </mrow>
        </mrow>
       </mrow>
       <mo>+</mo>
       <mi mathvariant="normal">…</mi>
      </mrow>
      <mo>]</mo>
     </mrow>
     <mrow>
      <mo fence="true" stretchy="false">|</mo>
      <mrow>
       <mi>ψ</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <msub>
         <mi>t</mi>
         <mn>0</mn>
        </msub>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
      <mo stretchy="false">⟩</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="latexml">ket</csymbol>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>ψ</ci>
       <ci>F</ci>
      </apply>
      <ci>t</ci>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="latexml">delimited-[]</csymbol>
      <apply>
       <plus></plus>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
        <apply>
         <times></times>
         <apply>
          <divide></divide>
          <ci>i</ci>
          <csymbol cd="latexml">Planck-constant-over-2-pi</csymbol>
         </apply>
         <apply>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <int></int>
            <apply>
             <csymbol cd="ambiguous">subscript</csymbol>
             <ci>t</ci>
             <cn type="integer">0</cn>
            </apply>
           </apply>
           <ci>t</ci>
          </apply>
          <apply>
           <times></times>
           <ci>d</ci>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <ci>t</ci>
            <cn type="integer">1</cn>
           </apply>
           <apply>
            <csymbol cd="ambiguous">superscript</csymbol>
            <ci>e</ci>
            <apply>
             <times></times>
             <apply>
              <divide></divide>
              <ci>i</ci>
              <csymbol cd="latexml">Planck-constant-over-2-pi</csymbol>
             </apply>
             <ci>λ</ci>
             <ci>V</ci>
             <apply>
              <minus></minus>
              <apply>
               <csymbol cd="ambiguous">subscript</csymbol>
               <ci>t</ci>
               <cn type="integer">1</cn>
              </apply>
              <apply>
               <csymbol cd="ambiguous">subscript</csymbol>
               <ci>t</ci>
               <cn type="integer">0</cn>
              </apply>
             </apply>
            </apply>
           </apply>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <ci>H</ci>
            <cn type="integer">0</cn>
           </apply>
           <apply>
            <csymbol cd="ambiguous">superscript</csymbol>
            <ci>e</ci>
            <apply>
             <minus></minus>
             <apply>
              <times></times>
              <apply>
               <divide></divide>
               <ci>i</ci>
               <csymbol cd="latexml">Planck-constant-over-2-pi</csymbol>
              </apply>
              <ci>λ</ci>
              <ci>V</ci>
              <apply>
               <minus></minus>
               <apply>
                <csymbol cd="ambiguous">subscript</csymbol>
                <ci>t</ci>
                <cn type="integer">1</cn>
               </apply>
               <apply>
                <csymbol cd="ambiguous">subscript</csymbol>
                <ci>t</ci>
                <cn type="integer">0</cn>
               </apply>
              </apply>
             </apply>
            </apply>
           </apply>
          </apply>
         </apply>
        </apply>
        <apply>
         <times></times>
         <apply>
          <divide></divide>
          <cn type="integer">1</cn>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <csymbol cd="latexml">Planck-constant-over-2-pi</csymbol>
           <cn type="integer">2</cn>
          </apply>
         </apply>
         <apply>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <int></int>
            <apply>
             <csymbol cd="ambiguous">subscript</csymbol>
             <ci>t</ci>
             <cn type="integer">0</cn>
            </apply>
           </apply>
           <ci>t</ci>
          </apply>
          <apply>
           <times></times>
           <ci>d</ci>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <ci>t</ci>
            <cn type="integer">1</cn>
           </apply>
           <apply>
            <apply>
             <csymbol cd="ambiguous">superscript</csymbol>
             <apply>
              <csymbol cd="ambiguous">subscript</csymbol>
              <int></int>
              <apply>
               <csymbol cd="ambiguous">subscript</csymbol>
               <ci>t</ci>
               <cn type="integer">0</cn>
              </apply>
             </apply>
             <apply>
              <csymbol cd="ambiguous">subscript</csymbol>
              <ci>t</ci>
              <cn type="integer">1</cn>
             </apply>
            </apply>
            <apply>
             <times></times>
             <ci>d</ci>
             <apply>
              <csymbol cd="ambiguous">subscript</csymbol>
              <ci>t</ci>
              <cn type="integer">2</cn>
             </apply>
             <apply>
              <csymbol cd="ambiguous">superscript</csymbol>
              <ci>e</ci>
              <apply>
               <times></times>
               <apply>
                <divide></divide>
                <ci>i</ci>
                <csymbol cd="latexml">Planck-constant-over-2-pi</csymbol>
               </apply>
               <ci>λ</ci>
               <ci>V</ci>
               <apply>
                <minus></minus>
                <apply>
                 <csymbol cd="ambiguous">subscript</csymbol>
                 <ci>t</ci>
                 <cn type="integer">1</cn>
                </apply>
                <apply>
                 <csymbol cd="ambiguous">subscript</csymbol>
                 <ci>t</ci>
                 <cn type="integer">0</cn>
                </apply>
               </apply>
              </apply>
             </apply>
             <apply>
              <csymbol cd="ambiguous">subscript</csymbol>
              <ci>H</ci>
              <cn type="integer">0</cn>
             </apply>
             <apply>
              <csymbol cd="ambiguous">superscript</csymbol>
              <ci>e</ci>
              <apply>
               <minus></minus>
               <apply>
                <times></times>
                <apply>
                 <divide></divide>
                 <ci>i</ci>
                 <csymbol cd="latexml">Planck-constant-over-2-pi</csymbol>
                </apply>
                <ci>λ</ci>
                <ci>V</ci>
                <apply>
                 <minus></minus>
                 <apply>
                  <csymbol cd="ambiguous">subscript</csymbol>
                  <ci>t</ci>
                  <cn type="integer">1</cn>
                 </apply>
                 <apply>
                  <csymbol cd="ambiguous">subscript</csymbol>
                  <ci>t</ci>
                  <cn type="integer">0</cn>
                 </apply>
                </apply>
               </apply>
              </apply>
             </apply>
             <apply>
              <csymbol cd="ambiguous">superscript</csymbol>
              <ci>e</ci>
              <apply>
               <times></times>
               <apply>
                <divide></divide>
                <ci>i</ci>
                <csymbol cd="latexml">Planck-constant-over-2-pi</csymbol>
               </apply>
               <ci>λ</ci>
               <ci>V</ci>
               <apply>
                <minus></minus>
                <apply>
                 <csymbol cd="ambiguous">subscript</csymbol>
                 <ci>t</ci>
                 <cn type="integer">2</cn>
                </apply>
                <apply>
                 <csymbol cd="ambiguous">subscript</csymbol>
                 <ci>t</ci>
                 <cn type="integer">0</cn>
                </apply>
               </apply>
              </apply>
             </apply>
             <apply>
              <csymbol cd="ambiguous">subscript</csymbol>
              <ci>H</ci>
              <cn type="integer">0</cn>
             </apply>
             <apply>
              <csymbol cd="ambiguous">superscript</csymbol>
              <ci>e</ci>
              <apply>
               <minus></minus>
               <apply>
                <times></times>
                <apply>
                 <divide></divide>
                 <ci>i</ci>
                 <csymbol cd="latexml">Planck-constant-over-2-pi</csymbol>
                </apply>
                <ci>λ</ci>
                <ci>V</ci>
                <apply>
                 <minus></minus>
                 <apply>
                  <csymbol cd="ambiguous">subscript</csymbol>
                  <ci>t</ci>
                  <cn type="integer">2</cn>
                 </apply>
                 <apply>
                  <csymbol cd="ambiguous">subscript</csymbol>
                  <ci>t</ci>
                  <cn type="integer">0</cn>
                 </apply>
                </apply>
               </apply>
              </apply>
             </apply>
            </apply>
           </apply>
          </apply>
         </apply>
        </apply>
       </apply>
       <ci>normal-…</ci>
      </apply>
     </apply>
     <apply>
      <csymbol cd="latexml">ket</csymbol>
      <apply>
       <times></times>
       <ci>ψ</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>t</ci>
        <cn type="integer">0</cn>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   |\psi_{F}(t)\rangle=\left[1-\frac{i}{\hbar}\int_{t_{0}}^{t}dt_{1}e^{\frac{i}{%
\hbar}\lambda V(t_{1}-t_{0})}H_{0}e^{-\frac{i}{\hbar}\lambda V(t_{1}-t_{0})}-%
\frac{1}{\hbar^{2}}\int_{t_{0}}^{t}dt_{1}\int_{t_{0}}^{t_{1}}dt_{2}e^{\frac{i}%
{\hbar}\lambda V(t_{1}-t_{0})}H_{0}e^{-\frac{i}{\hbar}\lambda V(t_{1}-t_{0})}e%
^{\frac{i}{\hbar}\lambda V(t_{2}-t_{0})}H_{0}e^{-\frac{i}{\hbar}\lambda V(t_{2%
}-t_{0})}+\ldots\right]|\psi(t_{0})\rangle.
  </annotation>
 </semantics>
</math>

</p>

<p>After the rescaling in time 

<math display="inline" id="Perturbation_theory_(quantum_mechanics):195">
 <semantics>
  <mrow>
   <mi>τ</mi>
   <mo>=</mo>
   <mrow>
    <mi>λ</mi>
    <mi>t</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>τ</ci>
    <apply>
     <times></times>
     <ci>λ</ci>
     <ci>t</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \tau=\lambda t
  </annotation>
 </semantics>
</math>

 we can see that this is indeed a series in 

<math display="inline" id="Perturbation_theory_(quantum_mechanics):196">
 <semantics>
  <mrow>
   <mn>1</mn>
   <mo>/</mo>
   <mi>λ</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <divide></divide>
    <cn type="integer">1</cn>
    <ci>λ</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   1/\lambda
  </annotation>
 </semantics>
</math>

 justifying in this way the name of <strong>dual Dyson series</strong>. The reason is that we have obtained this series simply interchanging <mtpl></mtpl> and 

<math display="inline" id="Perturbation_theory_(quantum_mechanics):197">
 <semantics>
  <mi>V</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>V</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   V
  </annotation>
 </semantics>
</math>

 and we can go from one to another applying this exchange. This is called <strong>duality principle</strong> in perturbation theory. The choice 

<math display="inline" id="Perturbation_theory_(quantum_mechanics):198">
 <semantics>
  <mrow>
   <msub>
    <mi>H</mi>
    <mn>0</mn>
   </msub>
   <mo>=</mo>
   <mrow>
    <mrow>
     <msup>
      <mi>p</mi>
      <mn>2</mn>
     </msup>
     <mo>/</mo>
     <mn>2</mn>
    </mrow>
    <mi>m</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>H</ci>
     <cn type="integer">0</cn>
    </apply>
    <apply>
     <times></times>
     <apply>
      <divide></divide>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>p</ci>
       <cn type="integer">2</cn>
      </apply>
      <cn type="integer">2</cn>
     </apply>
     <ci>m</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   H_{0}=p^{2}/2m
  </annotation>
 </semantics>
</math>

 yields, as already said, a <a href="Wigner-Kirkwood_series" title="wikilink">Wigner-Kirkwood series</a> that is a gradient expansion. The <a href="Wigner-Kirkwood_series" title="wikilink">Wigner-Kirkwood series</a> is a semiclassical series with eigenvalues given exactly as for <a href="WKB_approximation" title="wikilink">WKB approximation</a>.<a class="footnoteRef" href="#fn9" id="fnref9"><sup>9</sup></a></p>
<h2 id="examples">Examples</h2>
<h3 id="example-of-first-order-perturbation-theory-ground-state-energy-of-the-quartic-oscillator">Example of first order perturbation theory – ground state energy of the quartic oscillator</h3>

<p>Let us consider the quantum harmonic oscillator with the quartic potential perturbation and the Hamiltonian</p>

<p>

<math display="block" id="Perturbation_theory_(quantum_mechanics):199">
 <semantics>
  <mrow>
   <mi>H</mi>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mo>-</mo>
     <mrow>
      <mfrac>
       <msup>
        <mi mathvariant="normal">ℏ</mi>
        <mn>2</mn>
       </msup>
       <mrow>
        <mn>2</mn>
        <mi>m</mi>
       </mrow>
      </mfrac>
      <mfrac>
       <msup>
        <mo>∂</mo>
        <mn>2</mn>
       </msup>
       <mrow>
        <mo>∂</mo>
        <msup>
         <mi>x</mi>
         <mn>2</mn>
        </msup>
       </mrow>
      </mfrac>
     </mrow>
    </mrow>
    <mo>+</mo>
    <mfrac>
     <mrow>
      <mi>m</mi>
      <msup>
       <mi>ω</mi>
       <mn>2</mn>
      </msup>
      <msup>
       <mi>x</mi>
       <mn>2</mn>
      </msup>
     </mrow>
     <mn>2</mn>
    </mfrac>
    <mo>+</mo>
    <mrow>
     <mi>λ</mi>
     <msup>
      <mi>x</mi>
      <mn>4</mn>
     </msup>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>H</ci>
    <apply>
     <plus></plus>
     <apply>
      <minus></minus>
      <apply>
       <times></times>
       <apply>
        <divide></divide>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <csymbol cd="latexml">Planck-constant-over-2-pi</csymbol>
         <cn type="integer">2</cn>
        </apply>
        <apply>
         <times></times>
         <cn type="integer">2</cn>
         <ci>m</ci>
        </apply>
       </apply>
       <apply>
        <divide></divide>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <partialdiff></partialdiff>
         <cn type="integer">2</cn>
        </apply>
        <apply>
         <partialdiff></partialdiff>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>x</ci>
          <cn type="integer">2</cn>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <divide></divide>
      <apply>
       <times></times>
       <ci>m</ci>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>ω</ci>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>x</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
      <cn type="integer">2</cn>
     </apply>
     <apply>
      <times></times>
      <ci>λ</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>x</ci>
       <cn type="integer">4</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   H=-\frac{\hbar^{2}}{2m}\frac{\partial^{2}}{\partial x^{2}}+\frac{m\omega^{2}x^%
{2}}{2}+\lambda x^{4}
  </annotation>
 </semantics>
</math>

</p>

<p>The ground state of the harmonic oscillator is</p>

<p>

<math display="block" id="Perturbation_theory_(quantum_mechanics):200">
 <semantics>
  <mrow>
   <msub>
    <mi>ψ</mi>
    <mn>0</mn>
   </msub>
   <mo>=</mo>
   <mrow>
    <msup>
     <mrow>
      <mo>(</mo>
      <mfrac>
       <mi>α</mi>
       <mi>π</mi>
      </mfrac>
      <mo>)</mo>
     </mrow>
     <mfrac>
      <mn>1</mn>
      <mn>4</mn>
     </mfrac>
    </msup>
    <msup>
     <mi>e</mi>
     <mrow>
      <mo>-</mo>
      <mrow>
       <mrow>
        <mi>α</mi>
        <msup>
         <mi>x</mi>
         <mn>2</mn>
        </msup>
       </mrow>
       <mo>/</mo>
       <mn>2</mn>
      </mrow>
     </mrow>
    </msup>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>ψ</ci>
     <cn type="integer">0</cn>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <divide></divide>
       <ci>α</ci>
       <ci>π</ci>
      </apply>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <cn type="integer">4</cn>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>e</ci>
      <apply>
       <minus></minus>
       <apply>
        <divide></divide>
        <apply>
         <times></times>
         <ci>α</ci>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>x</ci>
          <cn type="integer">2</cn>
         </apply>
        </apply>
        <cn type="integer">2</cn>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \psi_{0}=\left(\frac{\alpha}{\pi}\right)^{\frac{1}{4}}e^{-\alpha x^{2}/2}
  </annotation>
 </semantics>
</math>

</p>

<p>(

<math display="inline" id="Perturbation_theory_(quantum_mechanics):201">
 <semantics>
  <mrow>
   <mi>α</mi>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mi>m</mi>
     <mi>ω</mi>
    </mrow>
    <mo>/</mo>
    <mi mathvariant="normal">ℏ</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>α</ci>
    <apply>
     <divide></divide>
     <apply>
      <times></times>
      <ci>m</ci>
      <ci>ω</ci>
     </apply>
     <csymbol cd="latexml">Planck-constant-over-2-pi</csymbol>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \alpha=m\omega/\hbar
  </annotation>
 </semantics>
</math>

) and the energy of unperturbed ground state is</p>

<p>

<math display="block" id="Perturbation_theory_(quantum_mechanics):202">
 <semantics>
  <mrow>
   <mrow>
    <msubsup>
     <mi>E</mi>
     <mn>0</mn>
     <mrow>
      <mo stretchy="false">(</mo>
      <mn>0</mn>
      <mo stretchy="false">)</mo>
     </mrow>
    </msubsup>
    <mo>=</mo>
    <mrow>
     <mfrac>
      <mn>1</mn>
      <mn>2</mn>
     </mfrac>
     <mi mathvariant="normal">ℏ</mi>
     <mi>ω</mi>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>E</ci>
      <cn type="integer">0</cn>
     </apply>
     <cn type="integer">0</cn>
    </apply>
    <apply>
     <times></times>
     <apply>
      <divide></divide>
      <cn type="integer">1</cn>
      <cn type="integer">2</cn>
     </apply>
     <csymbol cd="latexml">Planck-constant-over-2-pi</csymbol>
     <ci>ω</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   E_{0}^{(0)}=\frac{1}{2}\hbar\omega.\,
  </annotation>
 </semantics>
</math>

</p>

<p>Using the first order correction formula we get</p>

<p>

<math display="block" id="Perturbation_theory_(quantum_mechanics):203">
 <semantics>
  <mrow>
   <msubsup>
    <mi>E</mi>
    <mn>0</mn>
    <mrow>
     <mo stretchy="false">(</mo>
     <mn>1</mn>
     <mo stretchy="false">)</mo>
    </mrow>
   </msubsup>
   <mo>=</mo>
   <mrow>
    <mi>λ</mi>
    <msup>
     <mrow>
      <mo>(</mo>
      <mfrac>
       <mi>α</mi>
       <mi>π</mi>
      </mfrac>
      <mo>)</mo>
     </mrow>
     <mfrac>
      <mn>1</mn>
      <mn>2</mn>
     </mfrac>
    </msup>
    <mrow>
     <mo largeop="true" symmetric="true">∫</mo>
     <mrow>
      <msup>
       <mi>e</mi>
       <mrow>
        <mo>-</mo>
        <mrow>
         <mrow>
          <mi>α</mi>
          <msup>
           <mi>x</mi>
           <mn>2</mn>
          </msup>
         </mrow>
         <mo>/</mo>
         <mn>2</mn>
        </mrow>
       </mrow>
      </msup>
      <msup>
       <mi>x</mi>
       <mn>4</mn>
      </msup>
      <msup>
       <mi>e</mi>
       <mrow>
        <mo>-</mo>
        <mrow>
         <mrow>
          <mi>α</mi>
          <msup>
           <mi>x</mi>
           <mn>2</mn>
          </msup>
         </mrow>
         <mo>/</mo>
         <mn>2</mn>
        </mrow>
       </mrow>
      </msup>
      <mi>d</mi>
      <mi>x</mi>
     </mrow>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mi>λ</mi>
    <msup>
     <mrow>
      <mo>(</mo>
      <mfrac>
       <mi>α</mi>
       <mi>π</mi>
      </mfrac>
      <mo>)</mo>
     </mrow>
     <mfrac>
      <mn>1</mn>
      <mn>2</mn>
     </mfrac>
    </msup>
    <mfrac>
     <msup>
      <mo>∂</mo>
      <mn>2</mn>
     </msup>
     <mrow>
      <mo>∂</mo>
      <msup>
       <mi>α</mi>
       <mn>2</mn>
      </msup>
     </mrow>
    </mfrac>
    <mrow>
     <mo largeop="true" symmetric="true">∫</mo>
     <mrow>
      <msup>
       <mi>e</mi>
       <mrow>
        <mo>-</mo>
        <mrow>
         <mi>α</mi>
         <msup>
          <mi>x</mi>
          <mn>2</mn>
         </msup>
        </mrow>
       </mrow>
      </msup>
      <mi>d</mi>
      <mi>x</mi>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>E</ci>
       <cn type="integer">0</cn>
      </apply>
      <cn type="integer">1</cn>
     </apply>
     <apply>
      <times></times>
      <ci>λ</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <divide></divide>
        <ci>α</ci>
        <ci>π</ci>
       </apply>
       <apply>
        <divide></divide>
        <cn type="integer">1</cn>
        <cn type="integer">2</cn>
       </apply>
      </apply>
      <apply>
       <int></int>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>e</ci>
         <apply>
          <minus></minus>
          <apply>
           <divide></divide>
           <apply>
            <times></times>
            <ci>α</ci>
            <apply>
             <csymbol cd="ambiguous">superscript</csymbol>
             <ci>x</ci>
             <cn type="integer">2</cn>
            </apply>
           </apply>
           <cn type="integer">2</cn>
          </apply>
         </apply>
        </apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>x</ci>
         <cn type="integer">4</cn>
        </apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>e</ci>
         <apply>
          <minus></minus>
          <apply>
           <divide></divide>
           <apply>
            <times></times>
            <ci>α</ci>
            <apply>
             <csymbol cd="ambiguous">superscript</csymbol>
             <ci>x</ci>
             <cn type="integer">2</cn>
            </apply>
           </apply>
           <cn type="integer">2</cn>
          </apply>
         </apply>
        </apply>
        <ci>d</ci>
        <ci>x</ci>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <ci>λ</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <divide></divide>
        <ci>α</ci>
        <ci>π</ci>
       </apply>
       <apply>
        <divide></divide>
        <cn type="integer">1</cn>
        <cn type="integer">2</cn>
       </apply>
      </apply>
      <apply>
       <divide></divide>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <partialdiff></partialdiff>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <partialdiff></partialdiff>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>α</ci>
         <cn type="integer">2</cn>
        </apply>
       </apply>
      </apply>
      <apply>
       <int></int>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>e</ci>
         <apply>
          <minus></minus>
          <apply>
           <times></times>
           <ci>α</ci>
           <apply>
            <csymbol cd="ambiguous">superscript</csymbol>
            <ci>x</ci>
            <cn type="integer">2</cn>
           </apply>
          </apply>
         </apply>
        </apply>
        <ci>d</ci>
        <ci>x</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   E_{0}^{(1)}=\lambda\left(\frac{\alpha}{\pi}\right)^{\frac{1}{2}}\int e^{-%
\alpha x^{2}/2}x^{4}e^{-\alpha x^{2}/2}dx=\lambda\left(\frac{\alpha}{\pi}%
\right)^{\frac{1}{2}}\frac{\partial^{2}}{\partial\alpha^{2}}\int e^{-\alpha x^%
{2}}dx
  </annotation>
 </semantics>
</math>

</p>

<p>or</p>

<p>

<math display="block" id="Perturbation_theory_(quantum_mechanics):204">
 <semantics>
  <mrow>
   <msubsup>
    <mi>E</mi>
    <mn>0</mn>
    <mrow>
     <mo stretchy="false">(</mo>
     <mn>1</mn>
     <mo stretchy="false">)</mo>
    </mrow>
   </msubsup>
   <mo>=</mo>
   <mrow>
    <mi>λ</mi>
    <msup>
     <mrow>
      <mo>(</mo>
      <mfrac>
       <mi>α</mi>
       <mi>π</mi>
      </mfrac>
      <mo>)</mo>
     </mrow>
     <mfrac>
      <mn>1</mn>
      <mn>2</mn>
     </mfrac>
    </msup>
    <mfrac>
     <msup>
      <mo>∂</mo>
      <mn>2</mn>
     </msup>
     <mrow>
      <mo>∂</mo>
      <msup>
       <mi>α</mi>
       <mn>2</mn>
      </msup>
     </mrow>
    </mfrac>
    <msup>
     <mrow>
      <mo>(</mo>
      <mfrac>
       <mi>π</mi>
       <mi>α</mi>
      </mfrac>
      <mo>)</mo>
     </mrow>
     <mfrac>
      <mn>1</mn>
      <mn>2</mn>
     </mfrac>
    </msup>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mi>λ</mi>
    <mfrac>
     <mn>3</mn>
     <mn>4</mn>
    </mfrac>
    <mfrac>
     <mn>1</mn>
     <msup>
      <mi>α</mi>
      <mn>2</mn>
     </msup>
    </mfrac>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mfrac>
     <mn>3</mn>
     <mn>4</mn>
    </mfrac>
    <mfrac>
     <mrow>
      <msup>
       <mi mathvariant="normal">ℏ</mi>
       <mn>2</mn>
      </msup>
      <mi>λ</mi>
     </mrow>
     <mrow>
      <msup>
       <mi>m</mi>
       <mn>2</mn>
      </msup>
      <msup>
       <mi>ω</mi>
       <mn>2</mn>
      </msup>
     </mrow>
    </mfrac>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>E</ci>
       <cn type="integer">0</cn>
      </apply>
      <cn type="integer">1</cn>
     </apply>
     <apply>
      <times></times>
      <ci>λ</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <divide></divide>
        <ci>α</ci>
        <ci>π</ci>
       </apply>
       <apply>
        <divide></divide>
        <cn type="integer">1</cn>
        <cn type="integer">2</cn>
       </apply>
      </apply>
      <apply>
       <divide></divide>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <partialdiff></partialdiff>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <partialdiff></partialdiff>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>α</ci>
         <cn type="integer">2</cn>
        </apply>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <divide></divide>
        <ci>π</ci>
        <ci>α</ci>
       </apply>
       <apply>
        <divide></divide>
        <cn type="integer">1</cn>
        <cn type="integer">2</cn>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <ci>λ</ci>
      <apply>
       <divide></divide>
       <cn type="integer">3</cn>
       <cn type="integer">4</cn>
      </apply>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>α</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <cn type="integer">3</cn>
       <cn type="integer">4</cn>
      </apply>
      <apply>
       <divide></divide>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <csymbol cd="latexml">Planck-constant-over-2-pi</csymbol>
         <cn type="integer">2</cn>
        </apply>
        <ci>λ</ci>
       </apply>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>m</ci>
         <cn type="integer">2</cn>
        </apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>ω</ci>
         <cn type="integer">2</cn>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   E_{0}^{(1)}=\lambda\left(\frac{\alpha}{\pi}\right)^{\frac{1}{2}}\frac{\partial%
^{2}}{\partial\alpha^{2}}\left(\frac{\pi}{\alpha}\right)^{\frac{1}{2}}=\lambda%
\frac{3}{4}\frac{1}{\alpha^{2}}=\frac{3}{4}\frac{\hbar^{2}\lambda}{m^{2}\omega%
^{2}}
  </annotation>
 </semantics>
</math>

</p>
<h3 id="example-of-first-and-second-order-perturbation-theory-quantum-pendulum">Example of first and second order perturbation theory – quantum pendulum</h3>

<p>Consider the quantum mathematical pendulum with the Hamiltonian</p>

<p>

<math display="block" id="Perturbation_theory_(quantum_mechanics):205">
 <semantics>
  <mrow>
   <mi>H</mi>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mo>-</mo>
     <mrow>
      <mfrac>
       <msup>
        <mi mathvariant="normal">ℏ</mi>
        <mn>2</mn>
       </msup>
       <mrow>
        <mn>2</mn>
        <mi>m</mi>
        <msup>
         <mi>a</mi>
         <mn>2</mn>
        </msup>
       </mrow>
      </mfrac>
      <mfrac>
       <msup>
        <mo>∂</mo>
        <mn>2</mn>
       </msup>
       <mrow>
        <mo>∂</mo>
        <msup>
         <mi>ϕ</mi>
         <mn>2</mn>
        </msup>
       </mrow>
      </mfrac>
     </mrow>
    </mrow>
    <mo>-</mo>
    <mrow>
     <mi>λ</mi>
     <mrow>
      <mi>cos</mi>
      <mi>ϕ</mi>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>H</ci>
    <apply>
     <minus></minus>
     <apply>
      <minus></minus>
      <apply>
       <times></times>
       <apply>
        <divide></divide>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <csymbol cd="latexml">Planck-constant-over-2-pi</csymbol>
         <cn type="integer">2</cn>
        </apply>
        <apply>
         <times></times>
         <cn type="integer">2</cn>
         <ci>m</ci>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>a</ci>
          <cn type="integer">2</cn>
         </apply>
        </apply>
       </apply>
       <apply>
        <divide></divide>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <partialdiff></partialdiff>
         <cn type="integer">2</cn>
        </apply>
        <apply>
         <partialdiff></partialdiff>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>ϕ</ci>
          <cn type="integer">2</cn>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <ci>λ</ci>
      <apply>
       <cos></cos>
       <ci>ϕ</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   H=-\frac{\hbar^{2}}{2ma^{2}}\frac{\partial^{2}}{\partial\phi^{2}}-\lambda\cos\phi
  </annotation>
 </semantics>
</math>

</p>

<p>with the potential energy 

<math display="inline" id="Perturbation_theory_(quantum_mechanics):206">
 <semantics>
  <mrow>
   <mo>-</mo>
   <mrow>
    <mi>λ</mi>
    <mrow>
     <mi>cos</mi>
     <mi>ϕ</mi>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <minus></minus>
    <apply>
     <times></times>
     <ci>λ</ci>
     <apply>
      <cos></cos>
      <ci>ϕ</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   -\lambda\cos\phi
  </annotation>
 </semantics>
</math>

 taken as the perturbation i.e.</p>

<p>

<math display="block" id="Perturbation_theory_(quantum_mechanics):207">
 <semantics>
  <mrow>
   <mrow>
    <mfrac>
     <mi></mi>
     <mi></mi>
    </mfrac>
    <mi>V</mi>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mo>-</mo>
    <mrow>
     <mi>cos</mi>
     <mi>ϕ</mi>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <divide></divide>
      <csymbol cd="latexml">absent</csymbol>
      <csymbol cd="latexml">absent</csymbol>
     </apply>
     <ci>V</ci>
    </apply>
    <apply>
     <minus></minus>
     <apply>
      <cos></cos>
      <ci>ϕ</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \frac{}{}V=-\cos\phi
  </annotation>
 </semantics>
</math>

</p>

<p>The unperturbed normalized quantum wave functions are those of the rigid rotor and are given by</p>

<p>

<math display="block" id="Perturbation_theory_(quantum_mechanics):208">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>ψ</mi>
     <mi>n</mi>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>ϕ</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mfrac>
    <msup>
     <mi>e</mi>
     <mrow>
      <mi>i</mi>
      <mi>n</mi>
      <mi>ϕ</mi>
     </mrow>
    </msup>
    <msqrt>
     <mrow>
      <mn>2</mn>
      <mi>π</mi>
     </mrow>
    </msqrt>
   </mfrac>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>ψ</ci>
      <ci>n</ci>
     </apply>
     <ci>ϕ</ci>
    </apply>
    <apply>
     <divide></divide>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>e</ci>
      <apply>
       <times></times>
       <ci>i</ci>
       <ci>n</ci>
       <ci>ϕ</ci>
      </apply>
     </apply>
     <apply>
      <root></root>
      <apply>
       <times></times>
       <cn type="integer">2</cn>
       <ci>π</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \psi_{n}(\phi)=\frac{e^{in\phi}}{\sqrt{2\pi}}
  </annotation>
 </semantics>
</math>

</p>

<p>and the energies</p>

<p>

<math display="block" id="Perturbation_theory_(quantum_mechanics):209">
 <semantics>
  <mrow>
   <msubsup>
    <mi>E</mi>
    <mi>n</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mn>0</mn>
     <mo stretchy="false">)</mo>
    </mrow>
   </msubsup>
   <mo>=</mo>
   <mfrac>
    <mrow>
     <msup>
      <mi mathvariant="normal">ℏ</mi>
      <mn>2</mn>
     </msup>
     <msup>
      <mi>n</mi>
      <mn>2</mn>
     </msup>
    </mrow>
    <mrow>
     <mn>2</mn>
     <mi>m</mi>
     <msup>
      <mi>a</mi>
      <mn>2</mn>
     </msup>
    </mrow>
   </mfrac>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>E</ci>
      <ci>n</ci>
     </apply>
     <cn type="integer">0</cn>
    </apply>
    <apply>
     <divide></divide>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <csymbol cd="latexml">Planck-constant-over-2-pi</csymbol>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>n</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
     <apply>
      <times></times>
      <cn type="integer">2</cn>
      <ci>m</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>a</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   E_{n}^{(0)}=\frac{\hbar^{2}n^{2}}{2ma^{2}}
  </annotation>
 </semantics>
</math>

</p>

<p>The first order energy correction to the rotor due to the potential energy is</p>

<p>

<math display="block" id="Perturbation_theory_(quantum_mechanics):210">
 <semantics>
  <mrow>
   <msubsup>
    <mi>E</mi>
    <mi>n</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mn>1</mn>
     <mo stretchy="false">)</mo>
    </mrow>
   </msubsup>
   <mo>=</mo>
   <mrow>
    <mo>-</mo>
    <mrow>
     <mfrac>
      <mn>1</mn>
      <mrow>
       <mn>2</mn>
       <mi>π</mi>
      </mrow>
     </mfrac>
     <mrow>
      <mo largeop="true" symmetric="true">∫</mo>
      <mrow>
       <msup>
        <mi>e</mi>
        <mrow>
         <mo>-</mo>
         <mrow>
          <mi>i</mi>
          <mi>n</mi>
          <mi>ϕ</mi>
         </mrow>
        </mrow>
       </msup>
       <mrow>
        <mi>cos</mi>
        <mrow>
         <mi>ϕ</mi>
         <msup>
          <mi>e</mi>
          <mrow>
           <mi>i</mi>
           <mi>n</mi>
           <mi>ϕ</mi>
          </mrow>
         </msup>
        </mrow>
       </mrow>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mo>-</mo>
    <mrow>
     <mfrac>
      <mn>1</mn>
      <mrow>
       <mn>2</mn>
       <mi>π</mi>
      </mrow>
     </mfrac>
     <mrow>
      <mo largeop="true" symmetric="true">∫</mo>
      <mrow>
       <mi>cos</mi>
       <mi>ϕ</mi>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>E</ci>
       <ci>n</ci>
      </apply>
      <cn type="integer">1</cn>
     </apply>
     <apply>
      <minus></minus>
      <apply>
       <times></times>
       <apply>
        <divide></divide>
        <cn type="integer">1</cn>
        <apply>
         <times></times>
         <cn type="integer">2</cn>
         <ci>π</ci>
        </apply>
       </apply>
       <apply>
        <int></int>
        <apply>
         <times></times>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>e</ci>
          <apply>
           <minus></minus>
           <apply>
            <times></times>
            <ci>i</ci>
            <ci>n</ci>
            <ci>ϕ</ci>
           </apply>
          </apply>
         </apply>
         <apply>
          <cos></cos>
          <apply>
           <times></times>
           <ci>ϕ</ci>
           <apply>
            <csymbol cd="ambiguous">superscript</csymbol>
            <ci>e</ci>
            <apply>
             <times></times>
             <ci>i</ci>
             <ci>n</ci>
             <ci>ϕ</ci>
            </apply>
           </apply>
          </apply>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <minus></minus>
      <apply>
       <times></times>
       <apply>
        <divide></divide>
        <cn type="integer">1</cn>
        <apply>
         <times></times>
         <cn type="integer">2</cn>
         <ci>π</ci>
        </apply>
       </apply>
       <apply>
        <int></int>
        <apply>
         <cos></cos>
         <ci>ϕ</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <cn type="integer">0</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   E_{n}^{(1)}=-\frac{1}{2\pi}\int e^{-in\phi}\cos\phi e^{in\phi}=-\frac{1}{2\pi}%
\int\cos\phi=0
  </annotation>
 </semantics>
</math>

</p>

<p>Using the formula for the second order correction one gets</p>

<p>

<math display="block" id="Perturbation_theory_(quantum_mechanics):211">
 <semantics>
  <mrow>
   <msubsup>
    <mi>E</mi>
    <mi>n</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mn>2</mn>
     <mo stretchy="false">)</mo>
    </mrow>
   </msubsup>
   <mo>=</mo>
   <mrow>
    <mfrac>
     <mrow>
      <mi>m</mi>
      <msup>
       <mi>a</mi>
       <mn>2</mn>
      </msup>
     </mrow>
     <mrow>
      <mn>2</mn>
      <msup>
       <mi>π</mi>
       <mn>2</mn>
      </msup>
      <msup>
       <mi mathvariant="normal">ℏ</mi>
       <mn>2</mn>
      </msup>
     </mrow>
    </mfrac>
    <mrow>
     <munder>
      <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
      <mi>k</mi>
     </munder>
     <mfrac>
      <msup>
       <mrow>
        <mo>|</mo>
        <mrow>
         <mo largeop="true" symmetric="true">∫</mo>
         <mrow>
          <msup>
           <mi>e</mi>
           <mrow>
            <mo>-</mo>
            <mrow>
             <mi>i</mi>
             <mi>k</mi>
             <mi>ϕ</mi>
            </mrow>
           </mrow>
          </msup>
          <mrow>
           <mi>cos</mi>
           <mrow>
            <mi>ϕ</mi>
            <msup>
             <mi>e</mi>
             <mrow>
              <mi>i</mi>
              <mi>n</mi>
              <mi>ϕ</mi>
             </mrow>
            </msup>
           </mrow>
          </mrow>
         </mrow>
        </mrow>
        <mo>|</mo>
       </mrow>
       <mn>2</mn>
      </msup>
      <mrow>
       <msup>
        <mi>n</mi>
        <mn>2</mn>
       </msup>
       <mo>-</mo>
       <msup>
        <mi>k</mi>
        <mn>2</mn>
       </msup>
      </mrow>
     </mfrac>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>E</ci>
      <ci>n</ci>
     </apply>
     <cn type="integer">2</cn>
    </apply>
    <apply>
     <times></times>
     <apply>
      <divide></divide>
      <apply>
       <times></times>
       <ci>m</ci>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>a</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
      <apply>
       <times></times>
       <cn type="integer">2</cn>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>π</ci>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <csymbol cd="latexml">Planck-constant-over-2-pi</csymbol>
        <cn type="integer">2</cn>
       </apply>
      </apply>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <ci>k</ci>
      </apply>
      <apply>
       <divide></divide>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <abs></abs>
         <apply>
          <int></int>
          <apply>
           <times></times>
           <apply>
            <csymbol cd="ambiguous">superscript</csymbol>
            <ci>e</ci>
            <apply>
             <minus></minus>
             <apply>
              <times></times>
              <ci>i</ci>
              <ci>k</ci>
              <ci>ϕ</ci>
             </apply>
            </apply>
           </apply>
           <apply>
            <cos></cos>
            <apply>
             <times></times>
             <ci>ϕ</ci>
             <apply>
              <csymbol cd="ambiguous">superscript</csymbol>
              <ci>e</ci>
              <apply>
               <times></times>
               <ci>i</ci>
               <ci>n</ci>
               <ci>ϕ</ci>
              </apply>
             </apply>
            </apply>
           </apply>
          </apply>
         </apply>
        </apply>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <minus></minus>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>n</ci>
         <cn type="integer">2</cn>
        </apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>k</ci>
         <cn type="integer">2</cn>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   E_{n}^{(2)}=\frac{ma^{2}}{2\pi^{2}\hbar^{2}}\sum_{k}\frac{\left|\int e^{-ik%
\phi}\cos\phi e^{in\phi}\right|^{2}}{n^{2}-k^{2}}
  </annotation>
 </semantics>
</math>

</p>

<p>or</p>

<p>

<math display="block" id="Perturbation_theory_(quantum_mechanics):212">
 <semantics>
  <mrow>
   <msubsup>
    <mi>E</mi>
    <mi>n</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mn>2</mn>
     <mo stretchy="false">)</mo>
    </mrow>
   </msubsup>
   <mo>=</mo>
   <mrow>
    <mfrac>
     <mrow>
      <mi>m</mi>
      <msup>
       <mi>a</mi>
       <mn>2</mn>
      </msup>
     </mrow>
     <mrow>
      <mn>2</mn>
      <msup>
       <mi mathvariant="normal">ℏ</mi>
       <mn>2</mn>
      </msup>
     </mrow>
    </mfrac>
    <mrow>
     <munder>
      <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
      <mi>k</mi>
     </munder>
     <mfrac>
      <msup>
       <mrow>
        <mo>|</mo>
        <mrow>
         <mo>(</mo>
         <mrow>
          <msub>
           <mi>δ</mi>
           <mrow>
            <mi>n</mi>
            <mo>,</mo>
            <mrow>
             <mn>1</mn>
             <mo>-</mo>
             <mi>k</mi>
            </mrow>
           </mrow>
          </msub>
          <mo>+</mo>
          <msub>
           <mi>δ</mi>
           <mrow>
            <mi>n</mi>
            <mo>,</mo>
            <mrow>
             <mrow>
              <mo>-</mo>
              <mn>1</mn>
             </mrow>
             <mo>-</mo>
             <mi>k</mi>
            </mrow>
           </mrow>
          </msub>
         </mrow>
         <mo>)</mo>
        </mrow>
        <mo>|</mo>
       </mrow>
       <mn>2</mn>
      </msup>
      <mrow>
       <msup>
        <mi>n</mi>
        <mn>2</mn>
       </msup>
       <mo>-</mo>
       <msup>
        <mi>k</mi>
        <mn>2</mn>
       </msup>
      </mrow>
     </mfrac>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>E</ci>
      <ci>n</ci>
     </apply>
     <cn type="integer">2</cn>
    </apply>
    <apply>
     <times></times>
     <apply>
      <divide></divide>
      <apply>
       <times></times>
       <ci>m</ci>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>a</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
      <apply>
       <times></times>
       <cn type="integer">2</cn>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <csymbol cd="latexml">Planck-constant-over-2-pi</csymbol>
        <cn type="integer">2</cn>
       </apply>
      </apply>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <ci>k</ci>
      </apply>
      <apply>
       <divide></divide>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <abs></abs>
         <apply>
          <plus></plus>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>δ</ci>
           <list>
            <ci>n</ci>
            <apply>
             <minus></minus>
             <cn type="integer">1</cn>
             <ci>k</ci>
            </apply>
           </list>
          </apply>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>δ</ci>
           <list>
            <ci>n</ci>
            <apply>
             <minus></minus>
             <apply>
              <minus></minus>
              <cn type="integer">1</cn>
             </apply>
             <ci>k</ci>
            </apply>
           </list>
          </apply>
         </apply>
        </apply>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <minus></minus>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>n</ci>
         <cn type="integer">2</cn>
        </apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>k</ci>
         <cn type="integer">2</cn>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   E_{n}^{(2)}=\frac{ma^{2}}{2\hbar^{2}}\sum_{k}\frac{\left|\left(\delta_{n,1-k}+%
\delta_{n,-1-k}\right)\right|^{2}}{n^{2}-k^{2}}
  </annotation>
 </semantics>
</math>

</p>

<p>or</p>

<p>

<math display="block" id="Perturbation_theory_(quantum_mechanics):213">
 <semantics>
  <mrow>
   <msubsup>
    <mi>E</mi>
    <mi>n</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mn>2</mn>
     <mo stretchy="false">)</mo>
    </mrow>
   </msubsup>
   <mo>=</mo>
   <mrow>
    <mfrac>
     <mrow>
      <mi>m</mi>
      <msup>
       <mi>a</mi>
       <mn>2</mn>
      </msup>
     </mrow>
     <mrow>
      <mn>2</mn>
      <msup>
       <mi mathvariant="normal">ℏ</mi>
       <mn>2</mn>
      </msup>
     </mrow>
    </mfrac>
    <mrow>
     <mo>(</mo>
     <mrow>
      <mfrac>
       <mn>1</mn>
       <mrow>
        <mrow>
         <mn>2</mn>
         <mi>n</mi>
        </mrow>
        <mo>-</mo>
        <mn>1</mn>
       </mrow>
      </mfrac>
      <mo>+</mo>
      <mfrac>
       <mn>1</mn>
       <mrow>
        <mrow>
         <mo>-</mo>
         <mrow>
          <mn>2</mn>
          <mi>n</mi>
         </mrow>
        </mrow>
        <mo>-</mo>
        <mn>1</mn>
       </mrow>
      </mfrac>
     </mrow>
     <mo>)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mfrac>
     <mrow>
      <mi>m</mi>
      <msup>
       <mi>a</mi>
       <mn>2</mn>
      </msup>
     </mrow>
     <msup>
      <mi mathvariant="normal">ℏ</mi>
      <mn>2</mn>
     </msup>
    </mfrac>
    <mfrac>
     <mn>1</mn>
     <mrow>
      <mrow>
       <mn>4</mn>
       <msup>
        <mi>n</mi>
        <mn>2</mn>
       </msup>
      </mrow>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </mfrac>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>E</ci>
       <ci>n</ci>
      </apply>
      <cn type="integer">2</cn>
     </apply>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <apply>
        <times></times>
        <ci>m</ci>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>a</ci>
         <cn type="integer">2</cn>
        </apply>
       </apply>
       <apply>
        <times></times>
        <cn type="integer">2</cn>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <csymbol cd="latexml">Planck-constant-over-2-pi</csymbol>
         <cn type="integer">2</cn>
        </apply>
       </apply>
      </apply>
      <apply>
       <plus></plus>
       <apply>
        <divide></divide>
        <cn type="integer">1</cn>
        <apply>
         <minus></minus>
         <apply>
          <times></times>
          <cn type="integer">2</cn>
          <ci>n</ci>
         </apply>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <apply>
        <divide></divide>
        <cn type="integer">1</cn>
        <apply>
         <minus></minus>
         <apply>
          <minus></minus>
          <apply>
           <times></times>
           <cn type="integer">2</cn>
           <ci>n</ci>
          </apply>
         </apply>
         <cn type="integer">1</cn>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <apply>
        <times></times>
        <ci>m</ci>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>a</ci>
         <cn type="integer">2</cn>
        </apply>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <csymbol cd="latexml">Planck-constant-over-2-pi</csymbol>
        <cn type="integer">2</cn>
       </apply>
      </apply>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <apply>
        <minus></minus>
        <apply>
         <times></times>
         <cn type="integer">4</cn>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>n</ci>
          <cn type="integer">2</cn>
         </apply>
        </apply>
        <cn type="integer">1</cn>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   E_{n}^{(2)}=\frac{ma^{2}}{2\hbar^{2}}\left(\frac{1}{2n-1}+\frac{1}{-2n-1}%
\right)=\frac{ma^{2}}{\hbar^{2}}\frac{1}{4n^{2}-1}
  </annotation>
 </semantics>
</math>

</p>
<h2 id="see-also">See also</h2>
<ul>
<li><a href="Fermi's_Golden_Rule" title="wikilink">Fermi's Golden Rule</a></li>
</ul>
<h2 id="references">References</h2>

<p>"</p>

<p><a href="Category:Perturbation_theory" title="wikilink"> </a> <a href="Category:Quantum_mechanics" title="wikilink">Category:Quantum mechanics</a> <a href="Category:Mathematical_physics" title="wikilink">Category:Mathematical physics</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1"><a href="#fnref1">↩</a></li>
<li id="fn2"><a href="#fnref2">↩</a></li>
<li id="fn3"><a href="#fnref3">↩</a></li>
<li id="fn4">Sakurai, J.J., and Napolitano, J. (1964,2011). <em>Modern quantum mechanics</em> (2nd ed.), Addison Wesley ISBN 978-0-8053-8291-4 . Chapter 5<a href="#fnref4">↩</a></li>
<li id="fn5"><a href="#fnref5">↩</a></li>
<li id="fn6"><a href="#fnref6">↩</a></li>
<li id="fn7"><a href="#fnref7">↩</a></li>
<li id="fn8"><a href="#fnref8">↩</a></li>
<li id="fn9"><a href="#fnref9">↩</a></li>
</ol>
</section>
</body>
</html>

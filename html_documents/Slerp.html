<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="1201">Slerp</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Slerp</h1>
<hr/>

<p>In <a href="computer_graphics" title="wikilink">computer graphics</a>, <strong>Slerp</strong> is shorthand for <strong>s</strong>pherical <strong>l</strong>inear int<strong>erp</strong>olation, introduced by Ken Shoemake in the context of <a class="uri" href="quaternion" title="wikilink">quaternion</a> <a class="uri" href="interpolation" title="wikilink">interpolation</a> for the purpose of <a href="animation" title="wikilink">animating</a> 3D <a class="uri" href="rotation" title="wikilink">rotation</a>. It refers to constant-speed motion along a unit-radius <a href="great_circle" title="wikilink">great circle</a> arc, given the ends and an interpolation parameter between 0 and 1.</p>
<h2 id="geometric-slerp">Geometric Slerp</h2>

<p>Slerp has a geometric formula independent of quaternions, and independent of the dimension of the space in which the arc is embedded. This formula, a symmetric weighted sum credited to Glenn Davis, is based on the fact that any point on the curve must be a <a href="linear_combination" title="wikilink">linear combination</a> of the ends. Let <em>p</em><sub>0</sub> and <em>p</em><sub>1</sub> be the first and last points of the arc, and let <em>t</em> be the parameter, 0 ≤ <em>t</em> ≤ 1. Compute Ω as the angle <a href="Subtended_angle" title="wikilink">subtended</a> by the arc, so that <mtpl></mtpl>, the <em>n</em>-dimensional <a href="dot_product" title="wikilink">dot product</a> of the unit vectors from the origin to the ends. The geometric formula is then</p>

<p>

<math display="block" id="Slerp:0">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>Slerp</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <msub>
       <mi>p</mi>
       <mn>0</mn>
      </msub>
      <mo>,</mo>
      <msub>
       <mi>p</mi>
       <mn>1</mn>
      </msub>
      <mo>;</mo>
      <mi>t</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mfrac>
       <mrow>
        <mi>sin</mi>
        <mrow>
         <mo stretchy="false">[</mo>
         <mrow>
          <mrow>
           <mo stretchy="false">(</mo>
           <mrow>
            <mn>1</mn>
            <mo>-</mo>
            <mi>t</mi>
           </mrow>
           <mo stretchy="false">)</mo>
          </mrow>
          <mi mathvariant="normal">Ω</mi>
         </mrow>
         <mo stretchy="false">]</mo>
        </mrow>
       </mrow>
       <mrow>
        <mi>sin</mi>
        <mi mathvariant="normal">Ω</mi>
       </mrow>
      </mfrac>
      <msub>
       <mi>p</mi>
       <mn>0</mn>
      </msub>
     </mrow>
     <mo>+</mo>
     <mrow>
      <mfrac>
       <mrow>
        <mi>sin</mi>
        <mrow>
         <mo stretchy="false">[</mo>
         <mrow>
          <mi>t</mi>
          <mi mathvariant="normal">Ω</mi>
         </mrow>
         <mo stretchy="false">]</mo>
        </mrow>
       </mrow>
       <mrow>
        <mi>sin</mi>
        <mi mathvariant="normal">Ω</mi>
       </mrow>
      </mfrac>
      <msub>
       <mi>p</mi>
       <mn>1</mn>
      </msub>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>Slerp</ci>
     <vector>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>p</ci>
       <cn type="integer">0</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>p</ci>
       <cn type="integer">1</cn>
      </apply>
      <ci>t</ci>
     </vector>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <apply>
        <sin></sin>
        <apply>
         <times></times>
         <apply>
          <minus></minus>
          <cn type="integer">1</cn>
          <ci>t</ci>
         </apply>
         <ci>normal-Ω</ci>
        </apply>
       </apply>
       <apply>
        <sin></sin>
        <ci>normal-Ω</ci>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>p</ci>
       <cn type="integer">0</cn>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <apply>
        <sin></sin>
        <apply>
         <times></times>
         <ci>t</ci>
         <ci>normal-Ω</ci>
        </apply>
       </apply>
       <apply>
        <sin></sin>
        <ci>normal-Ω</ci>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>p</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathrm{Slerp}(p_{0},p_{1};t)=\frac{\sin{[(1-t)\Omega}]}{\sin\Omega}p_{0}+%
\frac{\sin[t\Omega]}{\sin\Omega}p_{1}.
  </annotation>
 </semantics>
</math>

</p>

<p>The symmetry can be seen in the fact that <mtpl></mtpl> = <mtpl></mtpl>. In the limit as Ω → 0, this formula reduces to the corresponding symmetric formula for <a href="linear_interpolation" title="wikilink">linear interpolation</a>,</p>

<p>

<math display="block" id="Slerp:1">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>Slerp</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <msub>
       <mi>p</mi>
       <mn>0</mn>
      </msub>
      <mo>,</mo>
      <msub>
       <mi>p</mi>
       <mn>1</mn>
      </msub>
      <mo>;</mo>
      <mi>t</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mn>1</mn>
        <mo>-</mo>
        <mi>t</mi>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
      <msub>
       <mi>p</mi>
       <mn>0</mn>
      </msub>
     </mrow>
     <mo>+</mo>
     <mrow>
      <mi>t</mi>
      <msub>
       <mi>p</mi>
       <mn>1</mn>
      </msub>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>Slerp</ci>
     <vector>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>p</ci>
       <cn type="integer">0</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>p</ci>
       <cn type="integer">1</cn>
      </apply>
      <ci>t</ci>
     </vector>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
       <ci>t</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>p</ci>
       <cn type="integer">0</cn>
      </apply>
     </apply>
     <apply>
      <times></times>
      <ci>t</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>p</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathrm{Slerp}(p_{0},p_{1};t)=(1-t)p_{0}+tp_{1}.\,\!
  </annotation>
 </semantics>
</math>

</p>

<p>A Slerp path is, in fact, the spherical geometry equivalent of a path along a line segment in the plane; a great circle is a spherical <a class="uri" href="geodesic" title="wikilink">geodesic</a>.</p>

<p> More familiar than the general Slerp formula is the case when the end vectors are perpendicular, in which case the formula is <mtpl></mtpl>. Letting , and applying the trigonometric identity , this becomes the Slerp formula. The factor of  in the general formula is a normalization, since a vector <em>p</em><sub>1</sub> at an angle of Ω to <em>p</em><sub>0</sub> projects onto the perpendicular ⊥<em>p</em><sub>0</sub> with a length of only .</p>

<p>Some special cases of Slerp admit more efficient calculation. When a circular arc is to be drawn into a raster image, the preferred method is some variation of <a href="Jack_E._Bresenham" title="wikilink">Bresenham's</a> circle algorithm. Evaluation at the special parameter values 0 and 1 trivially yields <em>p</em><sub>0</sub> and <em>p</em><sub>1</sub>, respectively; and bisection, evaluation at ½, simplifies to <mtpl></mtpl>, normalized. Another special case, common in animation, is evaluation with fixed ends and equal parametric steps. If <em>p</em><sub><em>k</em>−1</sub> and <em>p</em><sub><em>k</em></sub> are two consecutive values, and if <em>c</em> is twice their dot product (constant for all steps), then the next value, <em>p</em><sub><em>k</em>+1</sub>, is the reflection <mtpl></mtpl>.</p>
<h2 id="quaternion-slerp">Quaternion Slerp</h2>

<p>When Slerp is applied to unit <a href="quaternion" title="wikilink">quaternions</a>, the quaternion path maps to a path through 3D rotations in a <a href="quaternions_and_spatial_rotation" title="wikilink">standard way</a>. The effect is a rotation with uniform <a href="angular_velocity" title="wikilink">angular velocity</a> around a fixed <a href="axis_of_rotation" title="wikilink">rotation axis</a>. When the initial end point is the identity quaternion, Slerp gives a segment of a <a href="one-parameter_subgroup" title="wikilink">one-parameter subgroup</a> of both the <a href="Lie_group" title="wikilink">Lie group</a> of 3D rotations, <a class="uri" href="SO(3)" title="wikilink">SO(3)</a>, and its <a href="covering_map" title="wikilink">universal covering group</a> of unit quaternions, <a href="3-sphere" title="wikilink">S<sup>3</sup></a>. Slerp gives a straightest and shortest path between its quaternion end points, and maps to a rotation through an angle of 2Ω. However, because the covering is double (<em>q</em> and −<em>q</em> map to the same rotation), the rotation path may turn either the "short way" (less than 180°) or the "long way" (more than 180°). Long paths can be prevented by negating one end if the dot product, , is negative, thus ensuring that −90° ≤ Ω ≤ 90°.</p>

<p>Slerp also has expressions in terms of quaternion algebra, all using <a class="uri" href="exponentiation" title="wikilink">exponentiation</a>. <a href="real_numbers" title="wikilink">Real</a> powers of a quaternion are defined in terms of the quaternion <a href="exponential_function" title="wikilink">exponential function</a>, written as <mtpl></mtpl> and given by the <a href="power_series" title="wikilink">power series</a> equally familiar from calculus, complex analysis and matrix algebra:</p>

<p>

<math display="block" id="Slerp:2">
 <semantics>
  <mrow>
   <mrow>
    <msup>
     <mi>e</mi>
     <mi>q</mi>
    </msup>
    <mo>=</mo>
    <mrow>
     <mn>1</mn>
     <mo>+</mo>
     <mi>q</mi>
     <mo>+</mo>
     <mfrac>
      <msup>
       <mi>q</mi>
       <mn>2</mn>
      </msup>
      <mn>2</mn>
     </mfrac>
     <mo>+</mo>
     <mfrac>
      <msup>
       <mi>q</mi>
       <mn>3</mn>
      </msup>
      <mn>6</mn>
     </mfrac>
     <mo>+</mo>
     <mi mathvariant="normal">⋯</mi>
     <mo>+</mo>
     <mfrac>
      <msup>
       <mi>q</mi>
       <mi>n</mi>
      </msup>
      <mrow>
       <mi>n</mi>
       <mo lspace="0pt" rspace="3.5pt">!</mo>
      </mrow>
     </mfrac>
     <mo>+</mo>
     <mi mathvariant="normal">⋯</mi>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>e</ci>
     <ci>q</ci>
    </apply>
    <apply>
     <plus></plus>
     <cn type="integer">1</cn>
     <ci>q</ci>
     <apply>
      <divide></divide>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>q</ci>
       <cn type="integer">2</cn>
      </apply>
      <cn type="integer">2</cn>
     </apply>
     <apply>
      <divide></divide>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>q</ci>
       <cn type="integer">3</cn>
      </apply>
      <cn type="integer">6</cn>
     </apply>
     <ci>normal-⋯</ci>
     <apply>
      <divide></divide>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>q</ci>
       <ci>n</ci>
      </apply>
      <apply>
       <factorial></factorial>
       <ci>n</ci>
      </apply>
     </apply>
     <ci>normal-⋯</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   e^{q}=1+q+\frac{q^{2}}{2}+\frac{q^{3}}{6}+\cdots+\frac{q^{n}}{n!}+\cdots.
  </annotation>
 </semantics>
</math>

</p>

<p>Writing a unit quaternion <em>q</em> in <a class="uri" href="versor" title="wikilink">versor</a> form, , with <strong>v</strong> a unit 3-vector, and noting that the quaternion square <strong>v</strong><sup>2</sup> equals −1 (implying a quaternion version of <a href="Euler's_formula" title="wikilink">Euler's formula</a>), we have <mtpl></mtpl>, and <mtpl></mtpl>. The identification of interest is <mtpl></mtpl>, so that the real part of <em>q</em> is , the same as the geometric dot product used above. Here are four equivalent quaternion expressions for Slerp.</p>

<p>

<math display="inline" id="Slerp:3">
 <semantics>
  <mrow>
   <mi>Slerp</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>q</mi>
     <mn>0</mn>
    </msub>
    <mo>,</mo>
    <msub>
     <mi>q</mi>
     <mn>1</mn>
    </msub>
    <mo>,</mo>
    <mi>t</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>Slerp</ci>
    <vector>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>q</ci>
      <cn type="integer">0</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>q</ci>
      <cn type="integer">1</cn>
     </apply>
     <ci>t</ci>
    </vector>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle\mathrm{Slerp}(q_{0},q_{1},t)
  </annotation>
 </semantics>
</math>


</p>

<p>The <a class="uri" href="derivative" title="wikilink">derivative</a> of <mtpl></mtpl> with respect to <em>t</em>, assuming the ends are fixed, is log(<em>q</em><sub>1</sub><em>q</em><sub>0</sub><sup>−1</sup>) times the function value, where the quaternion <a href="natural_logarithm" title="wikilink">natural logarithm</a> in this case yields half the 3D <a href="angular_velocity" title="wikilink">angular velocity</a> vector. The initial tangent vector is <a href="parallel_transport" title="wikilink">parallel transported</a> to each tangent along the curve; thus the curve is, indeed, a geodesic.</p>

<p>In the <a href="tangent_space" title="wikilink">tangent space</a> at any point on a quaternion Slerp curve, the inverse of the <a href="exponential_map_(Riemannian_geometry)" title="wikilink">exponential map</a> transforms the curve into a line segment. Slerp curves not extending through a point fail to transform into lines in that point's tangent space.</p>

<p>Quaternion Slerps are commonly used to construct smooth animation curves by mimicking affine constructions like the <a href="de_Casteljau's_algorithm" title="wikilink">de Casteljau algorithm</a> for <a href="Bézier_curve" title="wikilink">Bézier curves</a>. Since the sphere is not an <a href="affine_space" title="wikilink">affine space</a>, familiar properties of affine constructions may fail, though the constructed curves may otherwise be entirely satisfactory. For example, the de Casteljau algorithm may be used to split a curve in affine space; this does not work on a sphere.</p>

<p>The two-valued Slerp can be extended to interpolate among many unit quaternions, but the extension loses the <a href="time_complexity" title="wikilink">fixed execution-time</a> of the Slerp algorithm.</p>
<h2 id="external-links">External links</h2>
<ul>
<li>Ken Shoemake. <a href="http://run.usc.edu/cs520-s12/assign2/p245-shoemake.pdf">Animating rotation with quaternion curves</a>.</li>
<li>Erik B. Dam, Martin Koch, Martin Lillholm. <a href="http://web.mit.edu/2.998/www/QuaternionReport1.pdf">Quaternions, Interpolation and Animation</a></li>
<li><a href="http://number-none.com/product/Understanding%20Slerp,%20Then%20Not%20Using%20It/">Understanding Slerp, Then Not Using It</a></li>
<li><a href="http://www.theory.org/software/qfa/writeup/node12.html">Brian Martin on quaternion animation</a></li>
</ul>

<p>"</p>

<p><a href="Category:Computer_graphics_algorithms" title="wikilink">Category:Computer graphics algorithms</a> <a class="uri" href="Category:Quaternions" title="wikilink">Category:Quaternions</a> <a class="uri" href="Category:Interpolation" title="wikilink">Category:Interpolation</a> <a href="Category:Rotation_in_three_dimensions" title="wikilink">Category:Rotation in three dimensions</a> <a href="Category:Spherical_geometry" title="wikilink">Category:Spherical geometry</a></p>
</body>
</html>

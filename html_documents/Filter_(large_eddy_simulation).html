<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="447">Filter (large eddy simulation)</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Filter (large eddy simulation)</h1>
<hr/>

<p><strong>Filtering</strong> in the context of <a href="large_eddy_simulation" title="wikilink">large eddy simulation</a> (LES) is a mathematical operation intended to remove a range of small scales from the solution to the <a href="Navier-Stokes_equations" title="wikilink">Navier-Stokes equations</a>. Because the principal difficulty in simulating turbulent flows comes from the wide range of length and time scales, this operation makes turbulent flow simulation cheaper by reducing the range of scales that must be resolved. The LES filter operation is low-pass, meaning it filters out the scales associated with high frequencies.</p>
<h2 id="homogeneous-filters">Homogeneous filters</h2>

<p> </p>
<h3 id="definition-in-physical-space">Definition in physical space</h3>

<p>The low-pass filtering operation used in LES can be applied to a spatial and temporal field, for example 

<math display="inline" id="Filter_(large_eddy_simulation):0">
 <semantics>
  <mrow>
   <mi>ϕ</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>𝒙</mi>
    <mo>,</mo>
    <mi>t</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>ϕ</ci>
    <interval closure="open">
     <ci>𝒙</ci>
     <ci>t</ci>
    </interval>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \phi(\boldsymbol{x},t)
  </annotation>
 </semantics>
</math>

. The LES filter operation may be spatial, temporal, or both. The filtered field, denoted with a bar, is defined as:<a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a><a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a></p>

<p>

<math display="block" id="Filter_(large_eddy_simulation):1">
 <semantics>
  <mrow>
   <mrow>
    <mover accent="true">
     <mrow>
      <mi>ϕ</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>𝒙</mi>
       <mo>,</mo>
       <mi>t</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo>¯</mo>
    </mover>
    <mo>=</mo>
    <mrow>
     <msubsup>
      <mo largeop="true" symmetric="true">∫</mo>
      <mrow>
       <mo>-</mo>
       <mi mathvariant="normal">∞</mi>
      </mrow>
      <mi mathvariant="normal">∞</mi>
     </msubsup>
     <mrow>
      <msubsup>
       <mo largeop="true" symmetric="true">∫</mo>
       <mrow>
        <mo>-</mo>
        <mi mathvariant="normal">∞</mi>
       </mrow>
       <mi mathvariant="normal">∞</mi>
      </msubsup>
      <mrow>
       <mi>ϕ</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>𝒓</mi>
        <mo>,</mo>
        <msup>
         <mi>t</mi>
         <mo>′</mo>
        </msup>
        <mo stretchy="false">)</mo>
       </mrow>
       <mi>G</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mi>𝒙</mi>
         <mo>-</mo>
         <mi>𝒓</mi>
        </mrow>
        <mo>,</mo>
        <mrow>
         <mi>t</mi>
         <mo>-</mo>
         <msup>
          <mi>t</mi>
          <mo>′</mo>
         </msup>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
       <mi>d</mi>
       <msup>
        <mi>t</mi>
        <mo>′</mo>
       </msup>
       <mi>d</mi>
       <mi>𝒓</mi>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <ci>normal-¯</ci>
     <apply>
      <times></times>
      <ci>ϕ</ci>
      <interval closure="open">
       <ci>𝒙</ci>
       <ci>t</ci>
      </interval>
     </apply>
    </apply>
    <apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <int></int>
       <apply>
        <minus></minus>
        <infinity></infinity>
       </apply>
      </apply>
      <infinity></infinity>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <int></int>
        <apply>
         <minus></minus>
         <infinity></infinity>
        </apply>
       </apply>
       <infinity></infinity>
      </apply>
      <apply>
       <times></times>
       <ci>ϕ</ci>
       <interval closure="open">
        <ci>𝒓</ci>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>t</ci>
         <ci>normal-′</ci>
        </apply>
       </interval>
       <ci>G</ci>
       <interval closure="open">
        <apply>
         <minus></minus>
         <ci>𝒙</ci>
         <ci>𝒓</ci>
        </apply>
        <apply>
         <minus></minus>
         <ci>t</ci>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>t</ci>
          <ci>normal-′</ci>
         </apply>
        </apply>
       </interval>
       <ci>d</ci>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>t</ci>
        <ci>normal-′</ci>
       </apply>
       <ci>d</ci>
       <ci>𝒓</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \overline{\phi(\boldsymbol{x},t)}=\displaystyle{\int_{-\infty}^{\infty}}\int_{%
-\infty}^{\infty}\phi(\boldsymbol{r},t^{\prime})G(\boldsymbol{x}-\boldsymbol{r%
},t-t^{\prime})dt^{\prime}d\boldsymbol{r},
  </annotation>
 </semantics>
</math>

</p>

<p>where 

<math display="inline" id="Filter_(large_eddy_simulation):2">
 <semantics>
  <mi>G</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>G</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   G
  </annotation>
 </semantics>
</math>

 is a convolution kernel unique to the filter type used. This can be written as a convolution operation:</p>

<p>

<math display="block" id="Filter_(large_eddy_simulation):3">
 <semantics>
  <mrow>
   <mrow>
    <mover accent="true">
     <mi>ϕ</mi>
     <mo>¯</mo>
    </mover>
    <mo>=</mo>
    <mrow>
     <mi>G</mi>
     <mo>⋆</mo>
     <mi>ϕ</mi>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <ci>normal-¯</ci>
     <ci>ϕ</ci>
    </apply>
    <apply>
     <ci>normal-⋆</ci>
     <ci>G</ci>
     <ci>ϕ</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \overline{\phi}=G\star\phi.
  </annotation>
 </semantics>
</math>

</p>

<p>The filter kernel 

<math display="inline" id="Filter_(large_eddy_simulation):4">
 <semantics>
  <mi>G</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>G</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   G
  </annotation>
 </semantics>
</math>

 uses cutoff length and time scales, denoted 

<math display="inline" id="Filter_(large_eddy_simulation):5">
 <semantics>
  <mi mathvariant="normal">Δ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>normal-Δ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Delta
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Filter_(large_eddy_simulation):6">
 <semantics>
  <mrow>
   <msub>
    <mi>τ</mi>
    <mi>c</mi>
   </msub>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>τ</ci>
    <ci>c</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \tau_{c},
  </annotation>
 </semantics>
</math>

 respectively. Scales smaller than these are eliminated from 

<math display="inline" id="Filter_(large_eddy_simulation):7">
 <semantics>
  <mrow>
   <mover accent="true">
    <mi>ϕ</mi>
    <mo>¯</mo>
   </mover>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-¯</ci>
    <ci>ϕ</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \overline{\phi}.
  </annotation>
 </semantics>
</math>

 Using this definition, any field 

<math display="inline" id="Filter_(large_eddy_simulation):8">
 <semantics>
  <mi>ϕ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>ϕ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \phi
  </annotation>
 </semantics>
</math>

 may be split up into a filtered and sub-filtered (denoted with a prime) portion, as</p>

<p>

<math display="block" id="Filter_(large_eddy_simulation):9">
 <semantics>
  <mrow>
   <mrow>
    <mi>ϕ</mi>
    <mo>=</mo>
    <mrow>
     <mover accent="true">
      <mi>ϕ</mi>
      <mo stretchy="false">¯</mo>
     </mover>
     <mo>+</mo>
     <msup>
      <mi>ϕ</mi>
      <mo>′</mo>
     </msup>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>ϕ</ci>
    <apply>
     <plus></plus>
     <apply>
      <ci>normal-¯</ci>
      <ci>ϕ</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>ϕ</ci>
      <ci>normal-′</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \phi=\bar{\phi}+\phi^{\prime}.
  </annotation>
 </semantics>
</math>

</p>

<p>This can also be written as a convolution operation,</p>

<p>

<math display="block" id="Filter_(large_eddy_simulation):10">
 <semantics>
  <mrow>
   <mrow>
    <msup>
     <mi>ϕ</mi>
     <mo>′</mo>
    </msup>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mo>(</mo>
      <mrow>
       <mn>1</mn>
       <mo>-</mo>
       <mi>G</mi>
      </mrow>
      <mo>)</mo>
     </mrow>
     <mo>⋆</mo>
     <mi>ϕ</mi>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>ϕ</ci>
     <ci>normal-′</ci>
    </apply>
    <apply>
     <ci>normal-⋆</ci>
     <apply>
      <minus></minus>
      <cn type="integer">1</cn>
      <ci>G</ci>
     </apply>
     <ci>ϕ</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \phi^{\prime}=\left(1-G\right)\star\phi.
  </annotation>
 </semantics>
</math>

</p>
<h3 id="definition-in-spectral-space">Definition in spectral space</h3>

<p>The filtering operation removes scales associated with high frequencies, and the operation can accordingly be interpreted in <a href="Frequency_domain" title="wikilink">Fourier space</a>. For a scalar field 

<math display="inline" id="Filter_(large_eddy_simulation):11">
 <semantics>
  <mrow>
   <mrow>
    <mi>ϕ</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>𝒙</mi>
     <mo>,</mo>
     <mi>t</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>ϕ</ci>
    <interval closure="open">
     <ci>𝒙</ci>
     <ci>t</ci>
    </interval>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \phi(\boldsymbol{x},t),
  </annotation>
 </semantics>
</math>

 the <a href="Fourier_transform" title="wikilink">Fourier transform</a> of 

<math display="inline" id="Filter_(large_eddy_simulation):12">
 <semantics>
  <mi>ϕ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>ϕ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \phi
  </annotation>
 </semantics>
</math>

 is 

<math display="inline" id="Filter_(large_eddy_simulation):13">
 <semantics>
  <mrow>
   <mrow>
    <mover accent="true">
     <mi>ϕ</mi>
     <mo stretchy="false">^</mo>
    </mover>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>𝒌</mi>
     <mo>,</mo>
     <mi>ω</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <ci>normal-^</ci>
     <ci>ϕ</ci>
    </apply>
    <interval closure="open">
     <ci>𝒌</ci>
     <ci>ω</ci>
    </interval>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \hat{\phi}(\boldsymbol{k},\omega),
  </annotation>
 </semantics>
</math>

 a function of 

<math display="inline" id="Filter_(large_eddy_simulation):14">
 <semantics>
  <mrow>
   <mi>𝒌</mi>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <ci>𝒌</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \boldsymbol{k},
  </annotation>
 </semantics>
</math>

 the spatial wave number, and 

<math display="inline" id="Filter_(large_eddy_simulation):15">
 <semantics>
  <mrow>
   <mi>ω</mi>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <ci>ω</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \omega,
  </annotation>
 </semantics>
</math>

 the temporal frequency. 

<math display="inline" id="Filter_(large_eddy_simulation):16">
 <semantics>
  <mover accent="true">
   <mi>ϕ</mi>
   <mo stretchy="false">^</mo>
  </mover>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-^</ci>
    <ci>ϕ</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \hat{\phi}
  </annotation>
 </semantics>
</math>

 can be filtered by the corresponding <a href="Fourier_transform" title="wikilink">Fourier transform</a> of the filter kernel, denoted 

<math display="inline" id="Filter_(large_eddy_simulation):17">
 <semantics>
  <mrow>
   <mrow>
    <mover accent="true">
     <mi>G</mi>
     <mo stretchy="false">^</mo>
    </mover>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>𝒌</mi>
     <mo>,</mo>
     <mi>ω</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>:</mo>
   <mi></mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-:</ci>
    <apply>
     <times></times>
     <apply>
      <ci>normal-^</ci>
      <ci>G</ci>
     </apply>
     <interval closure="open">
      <ci>𝒌</ci>
      <ci>ω</ci>
     </interval>
    </apply>
    <csymbol cd="latexml">absent</csymbol>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \hat{G}(\boldsymbol{k},\omega):
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Filter_(large_eddy_simulation):18">
 <semantics>
  <mrow>
   <mrow>
    <mover accent="true">
     <mover accent="true">
      <mi>ϕ</mi>
      <mo stretchy="false">^</mo>
     </mover>
     <mo>¯</mo>
    </mover>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>𝒌</mi>
     <mo>,</mo>
     <mi>ω</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mover accent="true">
     <mi>ϕ</mi>
     <mo stretchy="false">^</mo>
    </mover>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>𝒌</mi>
     <mo>,</mo>
     <mi>ω</mi>
     <mo stretchy="false">)</mo>
    </mrow>
    <mover accent="true">
     <mi>G</mi>
     <mo stretchy="false">^</mo>
    </mover>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>𝒌</mi>
     <mo>,</mo>
     <mi>ω</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <ci>normal-¯</ci>
      <apply>
       <ci>normal-^</ci>
       <ci>ϕ</ci>
      </apply>
     </apply>
     <interval closure="open">
      <ci>𝒌</ci>
      <ci>ω</ci>
     </interval>
    </apply>
    <apply>
     <times></times>
     <apply>
      <ci>normal-^</ci>
      <ci>ϕ</ci>
     </apply>
     <interval closure="open">
      <ci>𝒌</ci>
      <ci>ω</ci>
     </interval>
     <apply>
      <ci>normal-^</ci>
      <ci>G</ci>
     </apply>
     <interval closure="open">
      <ci>𝒌</ci>
      <ci>ω</ci>
     </interval>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \overline{\hat{\phi}}(\boldsymbol{k},\omega)=\hat{\phi}(\boldsymbol{k},\omega)%
\hat{G}(\boldsymbol{k},\omega)
  </annotation>
 </semantics>
</math>

</p>

<p>or,</p>

<p>

<math display="block" id="Filter_(large_eddy_simulation):19">
 <semantics>
  <mrow>
   <mrow>
    <mover accent="true">
     <mover accent="true">
      <mi>ϕ</mi>
      <mo stretchy="false">^</mo>
     </mover>
     <mo>¯</mo>
    </mover>
    <mo>=</mo>
    <mrow>
     <mover accent="true">
      <mi>G</mi>
      <mo stretchy="false">^</mo>
     </mover>
     <mover accent="true">
      <mi>ϕ</mi>
      <mo stretchy="false">^</mo>
     </mover>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <ci>normal-¯</ci>
     <apply>
      <ci>normal-^</ci>
      <ci>ϕ</ci>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <ci>normal-^</ci>
      <ci>G</ci>
     </apply>
     <apply>
      <ci>normal-^</ci>
      <ci>ϕ</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \overline{\hat{\phi}}=\hat{G}\hat{\phi}.
  </annotation>
 </semantics>
</math>

</p>

<p>The filter width 

<math display="inline" id="Filter_(large_eddy_simulation):20">
 <semantics>
  <mi mathvariant="normal">Δ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>normal-Δ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Delta
  </annotation>
 </semantics>
</math>

 has an associated cutoff wave number 

<math display="inline" id="Filter_(large_eddy_simulation):21">
 <semantics>
  <mrow>
   <msub>
    <mi>k</mi>
    <mi>c</mi>
   </msub>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>k</ci>
    <ci>c</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   k_{c},
  </annotation>
 </semantics>
</math>

 and the temporal filter width 

<math display="inline" id="Filter_(large_eddy_simulation):22">
 <semantics>
  <msub>
   <mi>τ</mi>
   <mi>c</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>τ</ci>
    <ci>c</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \tau_{c}
  </annotation>
 </semantics>
</math>

 also has an associated cutoff frequency 

<math display="inline" id="Filter_(large_eddy_simulation):23">
 <semantics>
  <mrow>
   <msub>
    <mi>ω</mi>
    <mi>c</mi>
   </msub>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>ω</ci>
    <ci>c</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \omega_{c}.
  </annotation>
 </semantics>
</math>

 The unfiltered portion of 

<math display="inline" id="Filter_(large_eddy_simulation):24">
 <semantics>
  <mover accent="true">
   <mi>ϕ</mi>
   <mo stretchy="false">^</mo>
  </mover>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-^</ci>
    <ci>ϕ</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \hat{\phi}
  </annotation>
 </semantics>
</math>

 is:</p>

<p>

<math display="block" id="Filter_(large_eddy_simulation):25">
 <semantics>
  <mrow>
   <mrow>
    <mover accent="true">
     <msup>
      <mi>ϕ</mi>
      <mo>′</mo>
     </msup>
     <mo stretchy="false">^</mo>
    </mover>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mn>1</mn>
       <mo>-</mo>
       <mover accent="true">
        <mi>G</mi>
        <mo stretchy="false">^</mo>
       </mover>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <mover accent="true">
      <mi>ϕ</mi>
      <mo stretchy="false">^</mo>
     </mover>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <ci>normal-^</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>ϕ</ci>
      <ci>normal-′</ci>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <minus></minus>
      <cn type="integer">1</cn>
      <apply>
       <ci>normal-^</ci>
       <ci>G</ci>
      </apply>
     </apply>
     <apply>
      <ci>normal-^</ci>
      <ci>ϕ</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \hat{\phi^{\prime}}=(1-\hat{G})\hat{\phi}.
  </annotation>
 </semantics>
</math>

</p>

<p>The spectral interpretation of the filtering operation is essential to the filtering operation in large eddy simulation, as the <a href="Turbulence#Kolmogorov's_theory_of_1941" title="wikilink">spectra of turbulent flows</a> is central to LES subgrid-scale models, which reconstruct the effect of the sub-filter scales (the highest frequencies). One of the challenges in subgrid modeling is to effectively mimic the cascade of kinetic energy from low to high frequencies. This makes the spectral properties of the implemented LES filter very important to subgrid modeling efforts.</p>
<h3 id="homogeneous-filter-properties">Homogeneous filter properties</h3>

<p>Homogeneous LES filters must satisfy the following set of properties when applied to the Navier-Stokes equations.<a class="footnoteRef" href="#fn3" id="fnref3"><sup>3</sup></a></p>
<dl>
<dt>1. Conservation of constants</dt>
</dl>
<dl>
<dd>The value of a filtered constant must be equal to the constant,
</dd>
</dl>
<dl>
<dd><dl>
<dd><math>
</math></dd>
</dl>
</dd>
</dl>

<p>\overline{a} = a, </p>
<dl>
<dd>which implies,
</dd>
</dl>
<dl>
<dd><dl>
<dd><math>
</math></dd>
</dl>
</dd>
</dl>

<p>\int_{-\infty}^{\infty} \int_{-\infty}^{\infty} G( \boldsymbol{\xi}, t^{\prime} ) d^3 \boldsymbol{\xi} dt^{\prime} = 1. </p>
<dl>
<dt>2. Linearity</dt>
</dl>
<dl>
<dd><dl>
<dd><math>
</math></dd>
</dl>
</dd>
</dl>

<p>\overline{ \phi + \psi } = \overline{\phi} + \overline{\psi}. </p>
<dl>
<dt>3. Commutation with derivatives</dt>
</dl>
<dl>
<dd><dl>
<dd><math>
</math></dd>
</dl>
</dd>
</dl>

<p>\overline{ \frac{\partial \phi}{\partial s} } = \frac{\partial \overline{\phi} }{\partial s}, \qquad s = \boldsymbol{x}, t. </p>
<dl>
<dd>If notation is introduced for operator commutation 

<math display="inline" id="Filter_(large_eddy_simulation):26">
 <semantics>
  <mrow>
   <mo stretchy="false">[</mo>
   <mi>f</mi>
   <mo>,</mo>
   <mi>g</mi>
   <mo stretchy="false">]</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <interval closure="closed">
    <ci>f</ci>
    <ci>g</ci>
   </interval>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   [f,g]
  </annotation>
 </semantics>
</math>

 for two arbitrary operators 

<math display="inline" id="Filter_(large_eddy_simulation):27">
 <semantics>
  <mi>f</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>f</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Filter_(large_eddy_simulation):28">
 <semantics>
  <mi>g</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>g</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   g
  </annotation>
 </semantics>
</math>

, where
</dd>
</dl>
<dl>
<dd><dl>
<dd><math>
</math></dd>
</dl>
</dd>
</dl>

<p>[f, g] \phi = f \circ g(\phi) - g \circ f(\phi) = f(g(\phi)) - g(f(\phi)), </p>
<dl>
<dd>then this third property can be expressed as
</dd>
</dl>
<dl>
<dd><dl>
<dd><math>
</math></dd>
</dl>
</dd>
</dl>

<p>\left[ G \star, \frac{\partial}{\partial s} \right] = 0. </p>

<p>Filters satisfying these properties are generally not <a href="Reynolds_operator" title="wikilink">Reynolds operators</a>, meaning, first:</p>

<p>

<math display="block" id="Filter_(large_eddy_simulation):29">
 <semantics>
  <mtable displaystyle="true">
   <mtr>
    <mtd columnalign="right">
     <mover accent="true">
      <mover accent="true">
       <mi>ϕ</mi>
       <mo>¯</mo>
      </mover>
      <mo>¯</mo>
     </mover>
    </mtd>
    <mtd columnalign="center">
     <mo>≠</mo>
    </mtd>
    <mtd columnalign="left">
     <mrow>
      <mover accent="true">
       <mi>ϕ</mi>
       <mo>¯</mo>
      </mover>
      <mo>,</mo>
     </mrow>
    </mtd>
   </mtr>
   <mtr>
    <mtd columnalign="right">
     <mrow>
      <mrow>
       <mi>G</mi>
       <mo>⋆</mo>
       <mi>G</mi>
       <mo>⋆</mo>
       <mi>ϕ</mi>
      </mrow>
      <mo>=</mo>
      <mrow>
       <msup>
        <mi>G</mi>
        <mn>2</mn>
       </msup>
       <mi>ϕ</mi>
      </mrow>
     </mrow>
    </mtd>
    <mtd columnalign="center">
     <mo>≠</mo>
    </mtd>
    <mtd columnalign="left">
     <mrow>
      <mrow>
       <mi>G</mi>
       <mo>⋆</mo>
       <mi>ϕ</mi>
      </mrow>
      <mo>,</mo>
     </mrow>
    </mtd>
   </mtr>
  </mtable>
  <annotation-xml encoding="MathML-Content">
   <matrix>
    <matrixrow>
     <apply>
      <ci>normal-¯</ci>
      <apply>
       <ci>normal-¯</ci>
       <ci>ϕ</ci>
      </apply>
     </apply>
     <neq></neq>
     <apply>
      <ci>normal-¯</ci>
      <ci>ϕ</ci>
     </apply>
    </matrixrow>
    <matrixrow>
     <apply>
      <eq></eq>
      <apply>
       <ci>normal-⋆</ci>
       <ci>G</ci>
       <ci>G</ci>
       <ci>ϕ</ci>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>G</ci>
        <cn type="integer">2</cn>
       </apply>
       <ci>ϕ</ci>
      </apply>
     </apply>
     <neq></neq>
     <apply>
      <ci>normal-⋆</ci>
      <ci>G</ci>
      <ci>ϕ</ci>
     </apply>
    </matrixrow>
   </matrix>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \begin{array}[]{rcl}\overline{\overline{\phi}}&\neq&\overline{\phi},\\
G\star G\star\phi=G^{2}\phi&\neq&G\star\phi,\end{array}
  </annotation>
 </semantics>
</math>

</p>

<p>and second,</p>

<p>

<math display="block" id="Filter_(large_eddy_simulation):30">
 <semantics>
  <mrow>
   <mover accent="true">
    <msup>
     <mi>ϕ</mi>
     <mo>′</mo>
    </msup>
    <mo>¯</mo>
   </mover>
   <mo>=</mo>
   <mrow>
    <mi>G</mi>
    <mo>⋆</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mn>1</mn>
      <mo>-</mo>
      <mi>G</mi>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
    <mo>⋆</mo>
    <mi>ϕ</mi>
   </mrow>
   <mo>≠</mo>
   <mn>0.</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <ci>normal-¯</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>ϕ</ci>
       <ci>normal-′</ci>
      </apply>
     </apply>
     <apply>
      <ci>normal-⋆</ci>
      <ci>G</ci>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
       <ci>G</ci>
      </apply>
      <ci>ϕ</ci>
     </apply>
    </apply>
    <apply>
     <neq></neq>
     <share href="#.cmml">
     </share>
     <cn type="float">0.</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \overline{\phi^{\prime}}=G\star(1-G)\star\phi\neq 0.
  </annotation>
 </semantics>
</math>

</p>
<h2 id="inhomogeneous-filters">Inhomogeneous filters</h2>

<p>Implementations of filtering operations for all but the simplest flows are inhomogeneous filter operations. This means that the flow either has non-periodic boundaries, causing problems with certain types of filters, or has a non-constant filter width 

<math display="inline" id="Filter_(large_eddy_simulation):31">
 <semantics>
  <mi mathvariant="normal">Δ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>normal-Δ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Delta
  </annotation>
 </semantics>
</math>

, or both. This prevents the filter from commuting with derivatives, and the commutation operation leads to several additional error terms:</p>

<p>

<math display="block" id="Filter_(large_eddy_simulation):32">
 <semantics>
  <mrow>
   <mtable displaystyle="true">
    <mtr>
     <mtd columnalign="right">
      <mrow>
       <mrow>
        <mo>[</mo>
        <mfrac>
         <mo>∂</mo>
         <mrow>
          <mo>∂</mo>
          <mi>𝒙</mi>
         </mrow>
        </mfrac>
        <mo>,</mo>
        <mi>G</mi>
        <mo>⋆</mo>
        <mo>]</mo>
       </mrow>
       <mi>ϕ</mi>
      </mrow>
     </mtd>
     <mtd columnalign="center">
      <mo>=</mo>
     </mtd>
     <mtd columnalign="left">
      <mrow>
       <mrow>
        <mfrac>
         <mo>∂</mo>
         <mrow>
          <mo>∂</mo>
          <mi>𝒙</mi>
         </mrow>
        </mfrac>
        <mrow>
         <mo>(</mo>
         <mrow>
          <mi>G</mi>
          <mo>⋆</mo>
          <mi>ϕ</mi>
         </mrow>
         <mo>)</mo>
        </mrow>
       </mrow>
       <mo>-</mo>
       <mrow>
        <mi>G</mi>
        <mo>⋆</mo>
        <mfrac>
         <mrow>
          <mo>∂</mo>
          <mi>ϕ</mi>
         </mrow>
         <mrow>
          <mo>∂</mo>
          <mi>𝒙</mi>
         </mrow>
        </mfrac>
       </mrow>
      </mrow>
     </mtd>
    </mtr>
    <mtr>
     <mtd></mtd>
     <mtd columnalign="center">
      <mo>=</mo>
     </mtd>
     <mtd columnalign="left">
      <mrow>
       <mrow>
        <mfrac>
         <mo>∂</mo>
         <mrow>
          <mo>∂</mo>
          <mi>𝒙</mi>
         </mrow>
        </mfrac>
        <mrow>
         <msub>
          <mo largeop="true" symmetric="true">∫</mo>
          <mi mathvariant="normal">Ω</mi>
         </msub>
         <mrow>
          <mi>G</mi>
          <mrow>
           <mo stretchy="false">(</mo>
           <mrow>
            <mi>𝒙</mi>
            <mo>-</mo>
            <mi>𝒓</mi>
           </mrow>
           <mo>,</mo>
           <mrow>
            <mi mathvariant="normal">Δ</mi>
            <mrow>
             <mo stretchy="false">(</mo>
             <mi>𝒙</mi>
             <mo>,</mo>
             <mi>t</mi>
             <mo stretchy="false">)</mo>
            </mrow>
           </mrow>
           <mo stretchy="false">)</mo>
          </mrow>
          <mi>ϕ</mi>
          <mrow>
           <mo stretchy="false">(</mo>
           <mi>𝒓</mi>
           <mo>,</mo>
           <mi>t</mi>
           <mo stretchy="false">)</mo>
          </mrow>
          <mi>d</mi>
          <mi>𝒓</mi>
         </mrow>
        </mrow>
       </mrow>
       <mo>-</mo>
       <mrow>
        <mi>G</mi>
        <mo>⋆</mo>
        <mfrac>
         <mrow>
          <mo>∂</mo>
          <mi>ϕ</mi>
         </mrow>
         <mrow>
          <mo>∂</mo>
          <mi>𝒙</mi>
         </mrow>
        </mfrac>
       </mrow>
      </mrow>
     </mtd>
    </mtr>
    <mtr>
     <mtd></mtd>
     <mtd columnalign="center">
      <mo>=</mo>
     </mtd>
     <mtd columnalign="left">
      <mrow>
       <mrow>
        <mrow>
         <mo>(</mo>
         <mrow>
          <mfrac>
           <mrow>
            <mo>∂</mo>
            <mi>G</mi>
           </mrow>
           <mrow>
            <mo>∂</mo>
            <mi mathvariant="normal">Δ</mi>
           </mrow>
          </mfrac>
          <mo>⋆</mo>
          <mi>ϕ</mi>
         </mrow>
         <mo>)</mo>
        </mrow>
        <mfrac>
         <mrow>
          <mo>∂</mo>
          <mi mathvariant="normal">Δ</mi>
         </mrow>
         <mrow>
          <mo>∂</mo>
          <mi>x</mi>
         </mrow>
        </mfrac>
       </mrow>
       <mo>+</mo>
       <mrow>
        <msub>
         <mo largeop="true" symmetric="true">∫</mo>
         <mrow>
          <mi>d</mi>
          <mi mathvariant="normal">Ω</mi>
         </mrow>
        </msub>
        <mrow>
         <mi>G</mi>
         <mrow>
          <mo stretchy="false">(</mo>
          <mrow>
           <mi>x</mi>
           <mo>-</mo>
           <mi>r</mi>
          </mrow>
          <mo>,</mo>
          <mrow>
           <mi mathvariant="normal">Δ</mi>
           <mrow>
            <mo stretchy="false">(</mo>
            <mi>x</mi>
            <mo>,</mo>
            <mi>t</mi>
            <mo stretchy="false">)</mo>
           </mrow>
          </mrow>
          <mo stretchy="false">)</mo>
         </mrow>
         <mi>ϕ</mi>
         <mrow>
          <mo stretchy="false">(</mo>
          <mi>r</mi>
          <mo>,</mo>
          <mi>t</mi>
          <mo stretchy="false">)</mo>
         </mrow>
         <mi>𝒏</mi>
         <mi>d</mi>
         <mi>S</mi>
        </mrow>
       </mrow>
      </mrow>
     </mtd>
    </mtr>
   </mtable>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <matrix>
    <matrixrow>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <cerror>
       <csymbol cd="ambiguous">fragments</csymbol>
       <ci>normal-[</ci>
       <apply>
        <divide></divide>
        <partialdiff></partialdiff>
        <apply>
         <partialdiff></partialdiff>
         <ci>𝒙</ci>
        </apply>
       </apply>
       <ci>normal-,</ci>
       <csymbol cd="unknown">G</csymbol>
       <ci>normal-⋆</ci>
       <ci>normal-]</ci>
      </cerror>
      <csymbol cd="unknown">ϕ</csymbol>
     </cerror>
     <eq></eq>
     <apply>
      <minus></minus>
      <apply>
       <times></times>
       <apply>
        <divide></divide>
        <partialdiff></partialdiff>
        <apply>
         <partialdiff></partialdiff>
         <ci>𝒙</ci>
        </apply>
       </apply>
       <apply>
        <ci>normal-⋆</ci>
        <ci>G</ci>
        <ci>ϕ</ci>
       </apply>
      </apply>
      <apply>
       <ci>normal-⋆</ci>
       <ci>G</ci>
       <apply>
        <divide></divide>
        <apply>
         <partialdiff></partialdiff>
         <ci>ϕ</ci>
        </apply>
        <apply>
         <partialdiff></partialdiff>
         <ci>𝒙</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </matrixrow>
    <matrixrow>
     <cerror>
      <csymbol cd="ambiguous">missing-subexpression</csymbol>
     </cerror>
     <eq></eq>
     <apply>
      <minus></minus>
      <apply>
       <times></times>
       <apply>
        <divide></divide>
        <partialdiff></partialdiff>
        <apply>
         <partialdiff></partialdiff>
         <ci>𝒙</ci>
        </apply>
       </apply>
       <apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <int></int>
         <ci>normal-Ω</ci>
        </apply>
        <apply>
         <times></times>
         <ci>G</ci>
         <interval closure="open">
          <apply>
           <minus></minus>
           <ci>𝒙</ci>
           <ci>𝒓</ci>
          </apply>
          <apply>
           <times></times>
           <ci>normal-Δ</ci>
           <interval closure="open">
            <ci>𝒙</ci>
            <ci>t</ci>
           </interval>
          </apply>
         </interval>
         <ci>ϕ</ci>
         <interval closure="open">
          <ci>𝒓</ci>
          <ci>t</ci>
         </interval>
         <ci>d</ci>
         <ci>𝒓</ci>
        </apply>
       </apply>
      </apply>
      <apply>
       <ci>normal-⋆</ci>
       <ci>G</ci>
       <apply>
        <divide></divide>
        <apply>
         <partialdiff></partialdiff>
         <ci>ϕ</ci>
        </apply>
        <apply>
         <partialdiff></partialdiff>
         <ci>𝒙</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </matrixrow>
    <matrixrow>
     <cerror>
      <csymbol cd="ambiguous">missing-subexpression</csymbol>
     </cerror>
     <eq></eq>
     <apply>
      <plus></plus>
      <apply>
       <times></times>
       <apply>
        <ci>normal-⋆</ci>
        <apply>
         <divide></divide>
         <apply>
          <partialdiff></partialdiff>
          <ci>G</ci>
         </apply>
         <apply>
          <partialdiff></partialdiff>
          <ci>normal-Δ</ci>
         </apply>
        </apply>
        <ci>ϕ</ci>
       </apply>
       <apply>
        <divide></divide>
        <apply>
         <partialdiff></partialdiff>
         <ci>normal-Δ</ci>
        </apply>
        <apply>
         <partialdiff></partialdiff>
         <ci>x</ci>
        </apply>
       </apply>
      </apply>
      <apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <int></int>
        <apply>
         <times></times>
         <ci>d</ci>
         <ci>normal-Ω</ci>
        </apply>
       </apply>
       <apply>
        <times></times>
        <ci>G</ci>
        <interval closure="open">
         <apply>
          <minus></minus>
          <ci>x</ci>
          <ci>r</ci>
         </apply>
         <apply>
          <times></times>
          <ci>normal-Δ</ci>
          <interval closure="open">
           <ci>x</ci>
           <ci>t</ci>
          </interval>
         </apply>
        </interval>
        <ci>ϕ</ci>
        <interval closure="open">
         <ci>r</ci>
         <ci>t</ci>
        </interval>
        <ci>𝒏</ci>
        <ci>d</ci>
        <ci>S</ci>
       </apply>
      </apply>
     </apply>
    </matrixrow>
   </matrix>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \begin{array}[]{rcl}\left[\frac{\partial}{\partial\boldsymbol{x}},G\star\right%
]\phi&=&\frac{\partial}{\partial\boldsymbol{x}}\left(G\star\phi\right)-G\star%
\frac{\partial\phi}{\partial\boldsymbol{x}}\\
&=&\frac{\partial}{\partial\boldsymbol{x}}\int_{\Omega}G(\boldsymbol{x}-%
\boldsymbol{r},\Delta(\boldsymbol{x},t))\phi(\boldsymbol{r},t)d\boldsymbol{r}-%
G\star\frac{\partial\phi}{\partial\boldsymbol{x}}\\
&=&\left(\frac{\partial G}{\partial\Delta}\star\phi\right)\frac{\partial\Delta%
}{\partial x}+\int_{d\Omega}G(x-r,\Delta(x,t))\phi(r,t)\boldsymbol{n}dS\end{%
array},
  </annotation>
 </semantics>
</math>

</p>

<p>where 

<math display="inline" id="Filter_(large_eddy_simulation):33">
 <semantics>
  <mi>𝒏</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>𝒏</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \boldsymbol{n}
  </annotation>
 </semantics>
</math>

 is the vector normal to the surface of the boundary 

<math display="inline" id="Filter_(large_eddy_simulation):34">
 <semantics>
  <mi mathvariant="normal">Ω</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>normal-Ω</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Omega
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Filter_(large_eddy_simulation):35">
 <semantics>
  <mrow>
   <mrow>
    <mi>d</mi>
    <mi mathvariant="normal">Ω</mi>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>d</ci>
    <ci>normal-Ω</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   d\Omega.
  </annotation>
 </semantics>
</math>

<a class="footnoteRef" href="#fn4" id="fnref4"><sup>4</sup></a></p>

<p>The two terms both appear due to inhomogeneities. The first is due to the spatial variation in the filter size 

<math display="inline" id="Filter_(large_eddy_simulation):36">
 <semantics>
  <mrow>
   <mi mathvariant="normal">Δ</mi>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <ci>normal-Δ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Delta,
  </annotation>
 </semantics>
</math>

 while the second is due to the domain boundary. Similarly, the commutation of the filter 

<math display="inline" id="Filter_(large_eddy_simulation):37">
 <semantics>
  <mi>G</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>G</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   G
  </annotation>
 </semantics>
</math>

 with the temporal derivative leads to an error term resulting from temporal variation in the filter size,</p>

<p>

<math display="block" id="Filter_(large_eddy_simulation):38">
 <semantics>
  <mrow>
   <mrow>
    <mo>[</mo>
    <mfrac>
     <mo>∂</mo>
     <mrow>
      <mo>∂</mo>
      <mi>t</mi>
     </mrow>
    </mfrac>
    <mo>,</mo>
    <mi>G</mi>
    <mo>⋆</mo>
    <mo>]</mo>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mo>(</mo>
    <mfrac>
     <mrow>
      <mo>∂</mo>
      <mi>G</mi>
     </mrow>
     <mrow>
      <mo>∂</mo>
      <mi mathvariant="normal">Δ</mi>
     </mrow>
    </mfrac>
    <mo>⋆</mo>
    <mi>ϕ</mi>
    <mo>)</mo>
   </mrow>
   <mfrac>
    <mrow>
     <mo>∂</mo>
     <mi mathvariant="normal">Δ</mi>
    </mrow>
    <mrow>
     <mo>∂</mo>
     <mi>t</mi>
    </mrow>
   </mfrac>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-[</ci>
     <apply>
      <divide></divide>
      <partialdiff></partialdiff>
      <apply>
       <partialdiff></partialdiff>
       <ci>t</ci>
      </apply>
     </apply>
     <ci>normal-,</ci>
     <csymbol cd="unknown">G</csymbol>
     <ci>normal-⋆</ci>
     <ci>normal-]</ci>
    </cerror>
    <eq></eq>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <divide></divide>
      <apply>
       <partialdiff></partialdiff>
       <ci>G</ci>
      </apply>
      <apply>
       <partialdiff></partialdiff>
       <ci>normal-Δ</ci>
      </apply>
     </apply>
     <ci>normal-⋆</ci>
     <csymbol cd="unknown">ϕ</csymbol>
     <ci>normal-)</ci>
    </cerror>
    <apply>
     <divide></divide>
     <apply>
      <partialdiff></partialdiff>
      <ci>normal-Δ</ci>
     </apply>
     <apply>
      <partialdiff></partialdiff>
      <ci>t</ci>
     </apply>
    </apply>
    <ci>normal-.</ci>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \left[\frac{\partial}{\partial t},G\star\right]=\left(\frac{\partial G}{%
\partial\Delta}\star\phi\right)\frac{\partial\Delta}{\partial t}.
  </annotation>
 </semantics>
</math>

</p>

<p>Several filter operations which eliminate or minimize these error terms have been proposed.</p>
<h2 id="classic-large-eddy-simulation-filters">Classic large eddy simulation filters</h2>

<p>There are three filters ordinarily used for spatial filtering in large eddy simulation. The definition of 

<math display="inline" id="Filter_(large_eddy_simulation):39">
 <semantics>
  <mrow>
   <mi>G</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>𝒙</mi>
    <mo>,</mo>
    <mi>t</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>G</ci>
    <interval closure="open">
     <ci>𝒙</ci>
     <ci>t</ci>
    </interval>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   G(\boldsymbol{x},t)
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Filter_(large_eddy_simulation):40">
 <semantics>
  <mrow>
   <mrow>
    <mover accent="true">
     <mi>G</mi>
     <mo stretchy="false">^</mo>
    </mover>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>𝒌</mi>
     <mo>,</mo>
     <mi>ω</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <ci>normal-^</ci>
     <ci>G</ci>
    </apply>
    <interval closure="open">
     <ci>𝒌</ci>
     <ci>ω</ci>
    </interval>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \hat{G}(\boldsymbol{k},\omega),
  </annotation>
 </semantics>
</math>

 and a discussion of important properties, is given.<a class="footnoteRef" href="#fn5" id="fnref5"><sup>5</sup></a></p>
<h3 id="box-filter">Box filter</h3>

<p>The filter kernel in physical space is given by:</p>

<p>

<math display="block" id="Filter_(large_eddy_simulation):41">
 <semantics>
  <mrow>
   <mrow>
    <mi>G</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>𝒙</mi>
      <mo>-</mo>
      <mi>𝒓</mi>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mo>{</mo>
    <mtable displaystyle="true">
     <mtr>
      <mtd columnalign="left">
       <mrow>
        <mstyle displaystyle="false">
         <mfrac>
          <mn>1</mn>
          <mi mathvariant="normal">Δ</mi>
         </mfrac>
        </mstyle>
        <mo>,</mo>
       </mrow>
      </mtd>
      <mtd columnalign="left">
       <mrow>
        <mrow>
         <mrow>
          <mtext>if</mtext>
          <mrow>
           <mo>|</mo>
           <mrow>
            <mi>𝒙</mi>
            <mo>-</mo>
            <mi>𝒓</mi>
           </mrow>
           <mo>|</mo>
          </mrow>
         </mrow>
         <mo>≤</mo>
         <mstyle displaystyle="false">
          <mfrac>
           <mi mathvariant="normal">Δ</mi>
           <mn>2</mn>
          </mfrac>
         </mstyle>
        </mrow>
        <mo>,</mo>
       </mrow>
      </mtd>
     </mtr>
     <mtr>
      <mtd columnalign="left">
       <mrow>
        <mn>0</mn>
        <mo>,</mo>
       </mrow>
      </mtd>
      <mtd columnalign="left">
       <mrow>
        <mtext>otherwise</mtext>
        <mo>.</mo>
       </mrow>
      </mtd>
     </mtr>
    </mtable>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>G</ci>
     <apply>
      <minus></minus>
      <ci>𝒙</ci>
      <ci>𝒓</ci>
     </apply>
    </apply>
    <apply>
     <csymbol cd="latexml">cases</csymbol>
     <apply>
      <divide></divide>
      <cn type="integer">1</cn>
      <ci>normal-Δ</ci>
     </apply>
     <apply>
      <leq></leq>
      <apply>
       <times></times>
       <mtext>if</mtext>
       <apply>
        <abs></abs>
        <apply>
         <minus></minus>
         <ci>𝒙</ci>
         <ci>𝒓</ci>
        </apply>
       </apply>
      </apply>
      <apply>
       <divide></divide>
       <ci>normal-Δ</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
     <cn type="integer">0</cn>
     <mtext>otherwise</mtext>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   G(\boldsymbol{x}-\boldsymbol{r})=\begin{cases}\frac{1}{\Delta},&\text{if}\left%
|\boldsymbol{x}-\boldsymbol{r}\right|\leq\frac{\Delta}{2},\\
0,&\text{otherwise}.\end{cases}
  </annotation>
 </semantics>
</math>

</p>

<p>The filter kernel in spectral space is given by:</p>

<p>

<math display="block" id="Filter_(large_eddy_simulation):42">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mover accent="true">
      <mi>G</mi>
      <mo stretchy="false">^</mo>
     </mover>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>𝒌</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mfrac>
     <mrow>
      <mi>sin</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mfrac>
         <mn>1</mn>
         <mn>2</mn>
        </mfrac>
        <mi>k</mi>
        <mi mathvariant="normal">Δ</mi>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mrow>
      <mfrac>
       <mn>1</mn>
       <mn>2</mn>
      </mfrac>
      <mi>k</mi>
      <mi mathvariant="normal">Δ</mi>
     </mrow>
    </mfrac>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <ci>normal-^</ci>
      <ci>G</ci>
     </apply>
     <ci>𝒌</ci>
    </apply>
    <apply>
     <divide></divide>
     <apply>
      <sin></sin>
      <apply>
       <times></times>
       <apply>
        <divide></divide>
        <cn type="integer">1</cn>
        <cn type="integer">2</cn>
       </apply>
       <ci>k</ci>
       <ci>normal-Δ</ci>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <cn type="integer">2</cn>
      </apply>
      <ci>k</ci>
      <ci>normal-Δ</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \hat{G}(\boldsymbol{k})=\frac{\sin{(\frac{1}{2}k\Delta)}}{\frac{1}{2}k\Delta}.
  </annotation>
 </semantics>
</math>

</p>
<h3 id="gaussian-filter">Gaussian filter</h3>

<p>The filter kernel in physical space is given by:</p>

<p>

<math display="block" id="Filter_(large_eddy_simulation):43">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>G</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mi>𝒙</mi>
       <mo>-</mo>
       <mi>𝒓</mi>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <msup>
      <mrow>
       <mo>(</mo>
       <mfrac>
        <mn>6</mn>
        <mrow>
         <mi>π</mi>
         <msup>
          <mi mathvariant="normal">Δ</mi>
          <mn>2</mn>
         </msup>
        </mrow>
       </mfrac>
       <mo>)</mo>
      </mrow>
      <mfrac>
       <mn>1</mn>
       <mn>2</mn>
      </mfrac>
     </msup>
     <mrow>
      <mi>exp</mi>
      <mrow>
       <mo>(</mo>
       <mrow>
        <mo>-</mo>
        <mfrac>
         <mrow>
          <mn>6</mn>
          <msup>
           <mrow>
            <mo stretchy="false">(</mo>
            <mrow>
             <mi>𝒙</mi>
             <mo mathvariant="bold">-</mo>
             <mi>𝒓</mi>
            </mrow>
            <mo stretchy="false">)</mo>
           </mrow>
           <mn>2</mn>
          </msup>
         </mrow>
         <msup>
          <mi mathvariant="normal">Δ</mi>
          <mn>2</mn>
         </msup>
        </mfrac>
       </mrow>
       <mo>)</mo>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>G</ci>
     <apply>
      <minus></minus>
      <ci>𝒙</ci>
      <ci>𝒓</ci>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <divide></divide>
       <cn type="integer">6</cn>
       <apply>
        <times></times>
        <ci>π</ci>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>normal-Δ</ci>
         <cn type="integer">2</cn>
        </apply>
       </apply>
      </apply>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <cn type="integer">2</cn>
      </apply>
     </apply>
     <apply>
      <exp></exp>
      <apply>
       <minus></minus>
       <apply>
        <divide></divide>
        <apply>
         <times></times>
         <cn type="integer">6</cn>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <apply>
           <minus></minus>
           <ci>𝒙</ci>
           <ci>𝒓</ci>
          </apply>
          <cn type="integer">2</cn>
         </apply>
        </apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>normal-Δ</ci>
         <cn type="integer">2</cn>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   G(\boldsymbol{x}-\boldsymbol{r})=\left(\frac{6}{\pi\Delta^{2}}\right)^{\frac{1%
}{2}}\exp{\left(-\frac{6(\boldsymbol{x-r})^{2}}{\Delta^{2}}\right)}.
  </annotation>
 </semantics>
</math>

</p>

<p>The filter kernel in spectral space is given by:</p>

<p>

<math display="block" id="Filter_(large_eddy_simulation):44">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mover accent="true">
      <mi>G</mi>
      <mo stretchy="false">^</mo>
     </mover>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>𝒌</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mi>exp</mi>
     <mrow>
      <mo>(</mo>
      <mrow>
       <mo>-</mo>
       <mfrac>
        <mrow>
         <msup>
          <mi>𝒌</mi>
          <mn>2</mn>
         </msup>
         <msup>
          <mi mathvariant="normal">Δ</mi>
          <mn>2</mn>
         </msup>
        </mrow>
        <mn>24</mn>
       </mfrac>
      </mrow>
      <mo>)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <ci>normal-^</ci>
      <ci>G</ci>
     </apply>
     <ci>𝒌</ci>
    </apply>
    <apply>
     <exp></exp>
     <apply>
      <minus></minus>
      <apply>
       <divide></divide>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>𝒌</ci>
         <cn type="integer">2</cn>
        </apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>normal-Δ</ci>
         <cn type="integer">2</cn>
        </apply>
       </apply>
       <cn type="integer">24</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \hat{G}(\boldsymbol{k})=\exp{\left(-\frac{\boldsymbol{k}^{2}\Delta^{2}}{24}%
\right)}.
  </annotation>
 </semantics>
</math>

</p>
<h3 id="sharp-spectral-filter">Sharp spectral filter</h3>

<p>The filter kernel in physical space is given by:</p>

<p>

<math display="block" id="Filter_(large_eddy_simulation):45">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>G</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mi>𝒙</mi>
       <mo>-</mo>
       <mi>𝒓</mi>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mfrac>
     <mrow>
      <mi>sin</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mrow>
         <mi>π</mi>
         <mrow>
          <mo stretchy="false">(</mo>
          <mrow>
           <mi>𝒙</mi>
           <mo mathvariant="bold">-</mo>
           <mi>𝒓</mi>
          </mrow>
          <mo stretchy="false">)</mo>
         </mrow>
        </mrow>
        <mo>/</mo>
        <mi mathvariant="normal">Δ</mi>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mrow>
      <mi>π</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mi>𝒙</mi>
        <mo mathvariant="bold">-</mo>
        <mi>𝒓</mi>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mfrac>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>G</ci>
     <apply>
      <minus></minus>
      <ci>𝒙</ci>
      <ci>𝒓</ci>
     </apply>
    </apply>
    <apply>
     <divide></divide>
     <apply>
      <sin></sin>
      <apply>
       <divide></divide>
       <apply>
        <times></times>
        <ci>π</ci>
        <apply>
         <minus></minus>
         <ci>𝒙</ci>
         <ci>𝒓</ci>
        </apply>
       </apply>
       <ci>normal-Δ</ci>
      </apply>
     </apply>
     <apply>
      <times></times>
      <ci>π</ci>
      <apply>
       <minus></minus>
       <ci>𝒙</ci>
       <ci>𝒓</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   G(\boldsymbol{x}-\boldsymbol{r})=\frac{\sin{(\pi(\boldsymbol{x-r})/\Delta)}}{%
\pi(\boldsymbol{x-r})}.
  </annotation>
 </semantics>
</math>

</p>

<p>The filter kernel in spectral space is given by:</p>

<p>

<math display="block" id="Filter_(large_eddy_simulation):46">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mrow>
      <mover accent="true">
       <mi>G</mi>
       <mo stretchy="false">^</mo>
      </mover>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>𝒌</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo>=</mo>
     <mrow>
      <mi>H</mi>
      <mrow>
       <mo>(</mo>
       <mrow>
        <msub>
         <mi>k</mi>
         <mi>c</mi>
        </msub>
        <mo>-</mo>
        <mrow>
         <mo>|</mo>
         <mi>k</mi>
         <mo>|</mo>
        </mrow>
       </mrow>
       <mo>)</mo>
      </mrow>
     </mrow>
    </mrow>
    <mo rspace="22.5pt">,</mo>
    <mrow>
     <msub>
      <mi>k</mi>
      <mi>c</mi>
     </msub>
     <mo>=</mo>
     <mfrac>
      <mi>π</mi>
      <mi mathvariant="normal">Δ</mi>
     </mfrac>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <eq></eq>
     <apply>
      <times></times>
      <apply>
       <ci>normal-^</ci>
       <ci>G</ci>
      </apply>
      <ci>𝒌</ci>
     </apply>
     <apply>
      <times></times>
      <ci>H</ci>
      <apply>
       <minus></minus>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>k</ci>
        <ci>c</ci>
       </apply>
       <apply>
        <abs></abs>
        <ci>k</ci>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>k</ci>
      <ci>c</ci>
     </apply>
     <apply>
      <divide></divide>
      <ci>π</ci>
      <ci>normal-Δ</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \hat{G}(\boldsymbol{k})=H\left(k_{c}-\left|k\right|\right),\qquad k_{c}=\frac{%
\pi}{\Delta}.
  </annotation>
 </semantics>
</math>

</p>
<h2 id="see-also">See also</h2>
<ul>
<li><a href="Computational_fluid_dynamics" title="wikilink">Computational fluid dynamics</a></li>
<li><a href="Filter_(signal_processing)" title="wikilink">Filter (signal processing)</a></li>
<li><a href="Fluid_mechanics" title="wikilink">Fluid mechanics</a></li>
<li><a href="Fourier_transform" title="wikilink">Fourier transform</a></li>
<li><a href="Frequency_domain" title="wikilink">Frequency domain</a></li>
<li><a href="Large_eddy_simulation" title="wikilink">Large eddy simulation</a></li>
<li><a class="uri" href="Turbulence" title="wikilink">Turbulence</a></li>
</ul>
<h2 id="references">References</h2>
<references>
</references>

<p>"</p>

<p><a href="Category:Turbulence_models" title="wikilink">Category:Turbulence models</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1"><a href="#fnref1">↩</a></li>
<li id="fn2"><a href="#fnref2">↩</a></li>
<li id="fn3"></li>
<li id="fn4"></li>
<li id="fn5"></li>
</ol>
</section>
</body>
</html>

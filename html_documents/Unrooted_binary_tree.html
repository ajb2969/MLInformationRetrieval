<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="130">Unrooted binary tree</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Unrooted binary tree</h1>
<hr/>

<p> In mathematics and computer science, an <strong>unrooted binary tree</strong> is an <a href="free_tree" title="wikilink">unrooted tree</a> in which each <a href="vertex_(graph_theory)" title="wikilink">vertex</a> has either one or three neighbors.</p>
<h2 id="definitions">Definitions</h2>

<p>A <a href="free_tree" title="wikilink">free tree</a> or unrooted tree is a <a href="connected_graph" title="wikilink">connected</a> <a href="undirected_graph" title="wikilink">undirected graph</a> with no <a href="cycle_(graph_theory)" title="wikilink">cycles</a>. The vertices with one neighbor are the <em>leaves</em> of the tree, and the remaining vertices are the <em>internal nodes</em> of the tree. The <a href="degree_(graph_theory)" title="wikilink">degree</a> of a vertex is its number of neighbors; in a tree with more than one node, the leaves are the vertices of degree one. An unrooted binary tree is a free tree in which all internal nodes have degree exactly three.</p>

<p>In some applications it may make sense to distinguish subtypes of unrooted binary trees: a <a href="planar_graph" title="wikilink">planar embedding</a> of the tree may be fixed by specifying a cyclic ordering for the edges at each vertex, making it into a <a href="plane_tree" title="wikilink">plane tree</a>. In computer science, binary trees are often rooted and ordered when they are used as <a href="data_structure" title="wikilink">data structures</a>, but in the applications of unrooted binary trees in <a href="hierarchical_clustering" title="wikilink">hierarchical clustering</a> and <a href="evolutionary_tree" title="wikilink">evolutionary tree</a> reconstruction, unordered trees are more common.<a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a></p>

<p>Additionally, one may distinguish between trees in which all vertices have distinct labels, trees in which the leaves only are labeled, and trees in which the nodes are not labeled. In an unrooted binary tree with <em>n</em> leaves, there will be <em>n</em> − 2 internal nodes, so the labels may be taken from the set of integers from 1 to 2<em>n</em> − 1 when all nodes are to be labeled, or from the set of integers from 1 to <em>n</em> when only the leaves are to be labeled.<a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a></p>
<h2 id="related-structures">Related structures</h2>
<h3 id="rooted-binary-trees">Rooted binary trees</h3>

<p>An unrooted binary tree <em>T</em> may be transformed into a full rooted <a href="binary_tree" title="wikilink">binary tree</a> (that is, a rooted tree in which each non-leaf node has exactly two children) by choosing a <em>root edge</em> <em>e</em> of <em>T</em>, placing a new root node in the middle of <em>e</em>, and directing every edge of the resulting subdivided tree away from the root node. Conversely, any full rooted binary tree may be transformed into an unrooted binary tree by removing the root node, replacing the path between its two children by a single undirected edge, and suppressing the orientation of the remaining edges in the graph. For this reason, there are exactly 2<em>n</em> −3 times as many full rooted binary trees with <em>n</em> leaves as there are unrooted binary trees with <em>n</em> leaves.<a class="footnoteRef" href="#fn3" id="fnref3"><sup>3</sup></a></p>
<h3 id="hierarchical-clustering">Hierarchical clustering</h3>

<p>A <a href="hierarchical_clustering" title="wikilink">hierarchical clustering</a> of a collection of objects may be formalized as a <a href="maximal_element" title="wikilink">maximal</a> <a href="family_of_sets" title="wikilink">family of sets</a> of the objects in which no two sets cross. That is, for every two sets <em>S</em> and <em>T</em> in the family, either <em>S</em> and <em>T</em> are disjoint or one is a subset of the other, and no more sets can be added to the family while preserving this property. If <em>T</em> is an unrooted binary tree, it defines a hierarchical clustering of its leaves: for each edge (<em>u</em>,<em>v</em>) in <em>T</em> there is a cluster consisting of the leaves that are closer to <em>u</em> than to <em>v</em>, and these sets together with the empty set and the set of all leaves form a maximal non-crossing family. Conversely, from any maximal non-crossing family of sets over a set of <em>n</em> elements, one can form a unique unrooted binary tree that has a node for each triple (<em>A</em>,<em>B</em>,<em>C</em>) of disjoint sets in the family that together cover all of the elements.<a class="footnoteRef" href="#fn4" id="fnref4"><sup>4</sup></a></p>
<h3 id="evolutionary-trees">Evolutionary trees</h3>

<p>According to simple forms of the <a href="theory_of_evolution" title="wikilink">theory of evolution</a>, the history of life can be summarized as a <a href="phylogenetic_tree" title="wikilink">phylogenetic tree</a> in which each node describes a species, the leaves represent the species that exist today, and the edges represent ancestor-descendant relationships between species. This tree has a natural orientation from ancestors to descendants, and a root at the <a href="common_ancestor" title="wikilink">common ancestor</a> of the species, so it is a rooted tree. However, some methods of reconstructing binary trees can reconstruct only the nodes and the edges of this tree, but not their orientations.</p>

<p>For instance, <a href="Cladistics" title="wikilink">cladistic methods</a> such as <a href="maximum_parsimony" title="wikilink">maximum parsimony</a> use as data a set of binary attributes describing features of the species. These methods seek a tree with the given species as leaves in which the internal nodes are also labeled with features, and attempt to minimize the number of times some feature is present at only one of the two endpoints of an edge in the tree. Ideally, each feature should only have one edge for which this is the case. Changing the root of a tree does not change this number of edge differences, so methods based on parsimony are not capable of determining the location of the tree root and will produce an unrooted tree, often an unrooted binary tree.<a class="footnoteRef" href="#fn5" id="fnref5"><sup>5</sup></a></p>

<p>Unrooted binary trees also are produced by methods for inferring evolutionary trees based on quartet data specifying, for each four leaf species, the unrooted binary tree describing the evolution of those four species, and by methods that use <a href="quartet_distance" title="wikilink">quartet distance</a> to measure the distance between trees.<a class="footnoteRef" href="#fn6" id="fnref6"><sup>6</sup></a></p>
<h3 id="branch-decomposition">Branch-decomposition</h3>

<p>Unrooted binary trees are also used to define <a href="branch-decomposition" title="wikilink">branch-decompositions</a> of graphs, by forming an unrooted binary tree whose leaves represent the edges of the given graph. That is, a branch-decomposition may be viewed as a hierarchical clustering of the edges of the graph. Branch-decompositions and an associated numerical quantity, branch-width, are closely related to <a class="uri" href="treewidth" title="wikilink">treewidth</a> and form the basis for efficient <a href="dynamic_programming" title="wikilink">dynamic programming</a> algorithms on graphs.<a class="footnoteRef" href="#fn7" id="fnref7"><sup>7</sup></a></p>
<h2 id="enumeration">Enumeration</h2>

<p>Because of their applications in hierarchical clustering, the most natural <a href="graph_enumeration" title="wikilink">graph enumeration</a> problem on unrooted binary trees is to count the number of trees with <em>n</em> labeled leaves and unlabeled internal nodes. An unrooted binary tree on <em>n</em> labeled leaves can be formed by connecting the <em>n</em>th leaf to a new node in the middle of any of the edges of an unrooted binary tree on <em>n</em> − 1 labeled leaves. There are 2<em>n</em> − 5 edges at which the <em>n</em>th node can be attached; therefore, the number of trees on <em>n</em> leaves is larger than the number of trees on <em>n</em> − 1 leaves by a factor of 2<em>n</em> − 5. Thus, the number of trees on <em>n</em> labeled leaves is the <a href="double_factorial" title="wikilink">double factorial</a></p>

<p>

<math display="block" id="Unrooted_binary_tree:0">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mrow>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mrow>
         <mn>2</mn>
         <mi>n</mi>
        </mrow>
        <mo>-</mo>
        <mn>5</mn>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
      <mo lspace="0pt" rspace="3.5pt">!</mo>
     </mrow>
     <mo lspace="0pt" rspace="3.5pt">!</mo>
    </mrow>
    <mo>=</mo>
    <mfrac>
     <mrow>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mrow>
         <mn>2</mn>
         <mi>n</mi>
        </mrow>
        <mo>-</mo>
        <mn>4</mn>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
      <mo lspace="0pt" rspace="3.5pt">!</mo>
     </mrow>
     <mrow>
      <mrow>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mi>n</mi>
         <mo>-</mo>
         <mn>2</mn>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
       <mo lspace="0pt" rspace="3.5pt">!</mo>
      </mrow>
      <msup>
       <mn>2</mn>
       <mrow>
        <mi>n</mi>
        <mo>-</mo>
        <mn>2</mn>
       </mrow>
      </msup>
     </mrow>
    </mfrac>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <factorial></factorial>
     <apply>
      <factorial></factorial>
      <apply>
       <minus></minus>
       <apply>
        <times></times>
        <cn type="integer">2</cn>
        <ci>n</ci>
       </apply>
       <cn type="integer">5</cn>
      </apply>
     </apply>
    </apply>
    <apply>
     <divide></divide>
     <apply>
      <factorial></factorial>
      <apply>
       <minus></minus>
       <apply>
        <times></times>
        <cn type="integer">2</cn>
        <ci>n</ci>
       </apply>
       <cn type="integer">4</cn>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <factorial></factorial>
       <apply>
        <minus></minus>
        <ci>n</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <cn type="integer">2</cn>
       <apply>
        <minus></minus>
        <ci>n</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (2n-5)!!=\frac{(2n-4)!}{(n-2)!2^{n-2}}.
  </annotation>
 </semantics>
</math>

<a class="footnoteRef" href="#fn8" id="fnref8"><sup>8</sup></a> The numbers of trees on 2, 3, 4, 5, ... labeled leaves are</p>
<dl>
<dd>1, 1, 3, 15, 105, 945, 10395, 135135, 2027025, 34459425, ... .
</dd>
</dl>
<h2 id="alternative-names">Alternative names</h2>

<p>Unrooted binary trees have also been called <strong>free binary trees</strong>,<a class="footnoteRef" href="#fn9" id="fnref9"><sup>9</sup></a> <strong>cubic trees</strong>,<a class="footnoteRef" href="#fn10" id="fnref10"><sup>10</sup></a> <strong>ternary trees</strong><a class="footnoteRef" href="#fn11" id="fnref11"><sup>11</sup></a> and <strong>unrooted ternary trees</strong>,.<a class="footnoteRef" href="#fn12" id="fnref12"><sup>12</sup></a> However, the "free binary tree" name has also been applied to unrooted trees that may have degree-two nodes<a class="footnoteRef" href="#fn13" id="fnref13"><sup>13</sup></a> and to rooted binary trees with unordered children,<a class="footnoteRef" href="#fn14" id="fnref14"><sup>14</sup></a> and the "ternary tree" name is more frequently used to mean a <a href="ternary_tree" title="wikilink">rooted tree with three children per node</a>.</p>
<h2 id="notes">Notes</h2>
<h2 id="references">References</h2>
<ul>
<li>

<p>.</p></li>
<li>

<p>.</p></li>
<li>

<p>.</p></li>
<li>

<p>.</p></li>
<li>

<p>.</p></li>
<li>

<p>.</p></li>
<li>

<p>.</p></li>
<li></li>
<li>

<p>.</p></li>
<li>

<p>.</p></li>
<li>

<p>.</p></li>
</ul>

<p>"</p>

<p><a href="Category:Trees_(graph_theory)" title="wikilink">Category:Trees (graph theory)</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1"></li>
<li id="fn2">.<a href="#fnref2">↩</a></li>
<li id="fn3"></li>
<li id="fn4">See e.g.  for the same correspondence between clusterings and trees, but using rooted binary trees instead of unrooted trees and therefore including an arbitrary choice of the root node.<a href="#fnref4">↩</a></li>
<li id="fn5">.<a href="#fnref5">↩</a></li>
<li id="fn6">.<a href="#fnref6">↩</a></li>
<li id="fn7">.<a href="#fnref7">↩</a></li>
<li id="fn8">.<a href="#fnref8">↩</a></li>
<li id="fn9">.<a href="#fnref9">↩</a></li>
<li id="fn10">.<a href="#fnref10">↩</a></li>
<li id="fn11"></li>
<li id="fn12">.<a href="#fnref12">↩</a></li>
<li id="fn13">.<a href="#fnref13">↩</a></li>
<li id="fn14">.<a href="#fnref14">↩</a></li>
</ol>
</section>
</body>
</html>

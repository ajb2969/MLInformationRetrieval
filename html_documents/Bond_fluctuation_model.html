<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="91">Bond fluctuation model</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Bond fluctuation model</h1>
<hr/>

<p>The <strong>BFM</strong> (<strong>bond fluctuation model</strong> or <strong>bond fluctuation method</strong>) is a <a href="lattice_model_(physics)" title="wikilink">lattice model</a> for <a href="simulation" title="wikilink">simulating</a> the conformation and dynamics of <a class="uri" href="polymer" title="wikilink">polymer</a> systems. There are two versions of the BFM used: The earlier version was first introduced by <a class="uri" href="Carmesin" title="wikilink">Carmesin</a> and <a class="uri" href="Kremer" title="wikilink">Kremer</a> in 1988,<a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a> and the later version by Shaffer in 1994.<a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a> Conversion between models is possible.<a class="footnoteRef" href="#fn3" id="fnref3"><sup>3</sup></a></p>
<h2 id="model">Model</h2>
<h3 id="carmesin-and-kremer-version">Carmesin and Kremer version</h3>

<p>In this model the <a class="uri" href="monomers" title="wikilink">monomers</a> are represented by <a href="cube" title="wikilink">cubes</a> on a regular cubic lattice with each cube occupying eight lattice positions. Each lattice position can only be occupied by one monomer in order to model <a href="Excluded_Volume" title="wikilink">excluded volume</a>. The monomers are connected by a bond <a href="Euclidean_vector" title="wikilink">vector</a>, which is taken from a set of typically 108 allowed vectors. There are different definitions for this vector set. One example for a bond vector set is made up from the six <a href="basis_vector" title="wikilink">base vectors</a> below using <a class="uri" href="permutation" title="wikilink">permutation</a> and sign variation of the three vector components in each direction:</p>

<p>

<math display="block" id="Bond_fluctuation_model:0">
 <semantics>
  <mrow>
   <mi>𝐁</mi>
   <mo>=</mo>
   <mrow>
    <mrow>
     <msub>
      <mi>𝐏</mi>
      <mo>±</mo>
     </msub>
     <mrow>
      <mo>(</mo>
      <mtable displaystyle="true">
       <mtr>
        <mtd columnalign="center">
         <mn>2</mn>
        </mtd>
       </mtr>
       <mtr>
        <mtd columnalign="center">
         <mn>0</mn>
        </mtd>
       </mtr>
       <mtr>
        <mtd columnalign="center">
         <mn>0</mn>
        </mtd>
       </mtr>
      </mtable>
      <mo>)</mo>
     </mrow>
    </mrow>
    <mo rspace="5.8pt">∪</mo>
    <mrow>
     <msub>
      <mi>𝐏</mi>
      <mo>±</mo>
     </msub>
     <mrow>
      <mo>(</mo>
      <mtable displaystyle="true">
       <mtr>
        <mtd columnalign="center">
         <mn>2</mn>
        </mtd>
       </mtr>
       <mtr>
        <mtd columnalign="center">
         <mn>1</mn>
        </mtd>
       </mtr>
       <mtr>
        <mtd columnalign="center">
         <mn>0</mn>
        </mtd>
       </mtr>
      </mtable>
      <mo>)</mo>
     </mrow>
    </mrow>
    <mo rspace="5.8pt">∪</mo>
    <mrow>
     <msub>
      <mi>𝐏</mi>
      <mo>±</mo>
     </msub>
     <mrow>
      <mo>(</mo>
      <mtable displaystyle="true">
       <mtr>
        <mtd columnalign="center">
         <mn>2</mn>
        </mtd>
       </mtr>
       <mtr>
        <mtd columnalign="center">
         <mn>1</mn>
        </mtd>
       </mtr>
       <mtr>
        <mtd columnalign="center">
         <mn>1</mn>
        </mtd>
       </mtr>
      </mtable>
      <mo>)</mo>
     </mrow>
    </mrow>
    <mo rspace="5.8pt">∪</mo>
    <mrow>
     <msub>
      <mi>𝐏</mi>
      <mo>±</mo>
     </msub>
     <mrow>
      <mo>(</mo>
      <mtable displaystyle="true">
       <mtr>
        <mtd columnalign="center">
         <mn>2</mn>
        </mtd>
       </mtr>
       <mtr>
        <mtd columnalign="center">
         <mn>2</mn>
        </mtd>
       </mtr>
       <mtr>
        <mtd columnalign="center">
         <mn>1</mn>
        </mtd>
       </mtr>
      </mtable>
      <mo>)</mo>
     </mrow>
    </mrow>
    <mo rspace="5.8pt">∪</mo>
    <mrow>
     <msub>
      <mi>𝐏</mi>
      <mo>±</mo>
     </msub>
     <mrow>
      <mo>(</mo>
      <mtable displaystyle="true">
       <mtr>
        <mtd columnalign="center">
         <mn>3</mn>
        </mtd>
       </mtr>
       <mtr>
        <mtd columnalign="center">
         <mn>0</mn>
        </mtd>
       </mtr>
       <mtr>
        <mtd columnalign="center">
         <mn>0</mn>
        </mtd>
       </mtr>
      </mtable>
      <mo>)</mo>
     </mrow>
    </mrow>
    <mo rspace="5.8pt">∪</mo>
    <mrow>
     <msub>
      <mi>𝐏</mi>
      <mo>±</mo>
     </msub>
     <mrow>
      <mo>(</mo>
      <mtable displaystyle="true">
       <mtr>
        <mtd columnalign="center">
         <mn>3</mn>
        </mtd>
       </mtr>
       <mtr>
        <mtd columnalign="center">
         <mn>1</mn>
        </mtd>
       </mtr>
       <mtr>
        <mtd columnalign="center">
         <mn>0</mn>
        </mtd>
       </mtr>
      </mtable>
      <mo>)</mo>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>𝐁</ci>
    <apply>
     <union></union>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>𝐏</ci>
       <csymbol cd="latexml">plus-or-minus</csymbol>
      </apply>
      <matrix>
       <matrixrow>
        <cn type="integer">2</cn>
       </matrixrow>
       <matrixrow>
        <cn type="integer">0</cn>
       </matrixrow>
       <matrixrow>
        <cn type="integer">0</cn>
       </matrixrow>
      </matrix>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>𝐏</ci>
       <csymbol cd="latexml">plus-or-minus</csymbol>
      </apply>
      <matrix>
       <matrixrow>
        <cn type="integer">2</cn>
       </matrixrow>
       <matrixrow>
        <cn type="integer">1</cn>
       </matrixrow>
       <matrixrow>
        <cn type="integer">0</cn>
       </matrixrow>
      </matrix>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>𝐏</ci>
       <csymbol cd="latexml">plus-or-minus</csymbol>
      </apply>
      <matrix>
       <matrixrow>
        <cn type="integer">2</cn>
       </matrixrow>
       <matrixrow>
        <cn type="integer">1</cn>
       </matrixrow>
       <matrixrow>
        <cn type="integer">1</cn>
       </matrixrow>
      </matrix>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>𝐏</ci>
       <csymbol cd="latexml">plus-or-minus</csymbol>
      </apply>
      <matrix>
       <matrixrow>
        <cn type="integer">2</cn>
       </matrixrow>
       <matrixrow>
        <cn type="integer">2</cn>
       </matrixrow>
       <matrixrow>
        <cn type="integer">1</cn>
       </matrixrow>
      </matrix>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>𝐏</ci>
       <csymbol cd="latexml">plus-or-minus</csymbol>
      </apply>
      <matrix>
       <matrixrow>
        <cn type="integer">3</cn>
       </matrixrow>
       <matrixrow>
        <cn type="integer">0</cn>
       </matrixrow>
       <matrixrow>
        <cn type="integer">0</cn>
       </matrixrow>
      </matrix>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>𝐏</ci>
       <csymbol cd="latexml">plus-or-minus</csymbol>
      </apply>
      <matrix>
       <matrixrow>
        <cn type="integer">3</cn>
       </matrixrow>
       <matrixrow>
        <cn type="integer">1</cn>
       </matrixrow>
       <matrixrow>
        <cn type="integer">0</cn>
       </matrixrow>
      </matrix>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{B}=\mathbf{P_{\pm}}\left(\begin{matrix}2\\
0\\
0\end{matrix}\right)\cup\!\ \mathbf{P_{\pm}}\left(\begin{matrix}2\\
1\\
0\end{matrix}\right)\cup\!\ \mathbf{P_{\pm}}\left(\begin{matrix}2\\
1\\
1\end{matrix}\right)\cup\!\ \mathbf{P_{\pm}}\left(\begin{matrix}2\\
2\\
1\end{matrix}\right)\cup\!\ \mathbf{P_{\pm}}\left(\begin{matrix}3\\
0\\
0\end{matrix}\right)\cup\!\ \mathbf{P_{\pm}}\left(\begin{matrix}3\\
1\\
0\end{matrix}\right)
  </annotation>
 </semantics>
</math>

</p>

<p>The resulting bond lengths are 

<math display="inline" id="Bond_fluctuation_model:1">
 <semantics>
  <mrow>
   <mn>2</mn>
   <mo>,</mo>
   <msqrt>
    <mn>5</mn>
   </msqrt>
   <mo>,</mo>
   <msqrt>
    <mn>6</mn>
   </msqrt>
   <mo>,</mo>
   <mn>3</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <list>
    <cn type="integer">2</cn>
    <apply>
     <root></root>
     <cn type="integer">5</cn>
    </apply>
    <apply>
     <root></root>
     <cn type="integer">6</cn>
    </apply>
    <cn type="integer">3</cn>
   </list>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   2,\sqrt{5},\sqrt{6},3
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Bond_fluctuation_model:2">
 <semantics>
  <msqrt>
   <mn>10</mn>
  </msqrt>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <root></root>
    <cn type="integer">10</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \sqrt{10}
  </annotation>
 </semantics>
</math>

.</p>

<p>The combination of bond vector set and monomer shape in this model ensures that polymer chains cannot cross each other, without explicit test of the local <a class="uri" href="topology" title="wikilink">topology</a>.</p>

<p>The basic movement of a monomer cube takes place along the lattice axes</p>

<p>

<math display="block" id="Bond_fluctuation_model:3">
 <semantics>
  <mrow>
   <mrow>
    <mi>𝚫</mi>
    <mi>𝐁</mi>
   </mrow>
   <mo>=</mo>
   <mrow>
    <msub>
     <mi>𝐏</mi>
     <mo>±</mo>
    </msub>
    <mrow>
     <mo>(</mo>
     <mn>1</mn>
     <mo>,</mo>
     <mn>0</mn>
     <mo>,</mo>
     <mn>0</mn>
     <mo>)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>𝚫</ci>
     <ci>𝐁</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>𝐏</ci>
      <csymbol cd="latexml">plus-or-minus</csymbol>
     </apply>
     <vector>
      <cn type="integer">1</cn>
      <cn type="integer">0</cn>
      <cn type="integer">0</cn>
     </vector>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{\Delta B}=\mathbf{P_{\pm}}\left(1,0,0\right)
  </annotation>
 </semantics>
</math>

</p>

<p>so that each of the possible bond vectors can be realized.<a class="footnoteRef" href="#fn4" id="fnref4"><sup>4</sup></a></p>
<h3 id="shaffers-version">Shaffer's version</h3>

<p>As in the case of the Carmesin-Kremer BFM, the Shaffer BFM is also constructed on a simple-cubic lattice. However, the lattice points, or vertices of each cube are the sites that can be occupied by a monomer. Each lattice point can be occupied by one monomer only. Successive monomers along a polymer backbone are connected by bond vectors. The allowed bond vectors must be one of: (a) A cube edge (b) A face diagonal or (c) A solid diagonal. The resulting bond lengths are 

<math display="inline" id="Bond_fluctuation_model:4">
 <semantics>
  <mrow>
   <mn>1</mn>
   <mo>,</mo>
   <msqrt>
    <mn>2</mn>
   </msqrt>
   <mo>,</mo>
   <msqrt>
    <mn>3</mn>
   </msqrt>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <list>
    <cn type="integer">1</cn>
    <apply>
     <root></root>
     <cn type="integer">2</cn>
    </apply>
    <apply>
     <root></root>
     <cn type="integer">3</cn>
    </apply>
   </list>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   1,\sqrt{2},\sqrt{3}
  </annotation>
 </semantics>
</math>

. In addition to the bond length constraint, polymers should not be allowed to cross. This is done most efficiently by the use of a secondary lattice which is twice as fine as the original lattice. The secondary lattice tracks the midpoints of the bonds in the system, and forbids the overlap of bond midpoints. This effectively leads to disallowing polymers from crossing each other.</p>
<h2 id="monte-carlo-step">Monte Carlo step</h2>

<p>In both versions of the BFM, a single attempt to move one monomer consists of the following steps which are standard for <a href="Monte_Carlo_method" title="wikilink">Monte Carlo methods</a>:</p>
<ol>
<li>Select a monomer m and a direction 

<math display="inline" id="Bond_fluctuation_model:5">
 <semantics>
  <mrow>
   <mrow>
    <mi mathvariant="normal">Δ</mi>
    <mi>𝐁</mi>
   </mrow>
   <mo>∈</mo>
   <mrow>
    <msub>
     <mi>𝐏</mi>
     <mo>±</mo>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <mn>1</mn>
     <mo>,</mo>
     <mn>0</mn>
     <mo>,</mo>
     <mn>0</mn>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <in></in>
    <apply>
     <times></times>
     <ci>normal-Δ</ci>
     <ci>𝐁</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>𝐏</ci>
      <csymbol cd="latexml">plus-or-minus</csymbol>
     </apply>
     <vector>
      <cn type="integer">1</cn>
      <cn type="integer">0</cn>
      <cn type="integer">0</cn>
     </vector>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Delta\mathbf{B}\in\mathbf{P}_{\pm}(1,0,0)
  </annotation>
 </semantics>
</math>

 randomly</li>
<li>Check list of conditions (see below)</li>
<li>If all conditions are fulfilled, perform move</li>
</ol>

<p>The conditions to perform a move can be subdivided into mandatory and optional ones.</p>
<h2 id="mandatory-conditions-for-carmesinkremer-bfm">Mandatory conditions for Carmesin–Kremer BFM</h2>
<ol>
<li>Four lattice sites next to monomer <em>m</em> in the direction <em>d</em> are empty</li>
<li>The move does not lead to bonds that are not contained in the bond vector set.</li>
</ol>
<h2 id="mandatory-conditions-for-shaffer-bfm">Mandatory conditions for Shaffer BFM</h2>
<ol>
<li>The lattice site to which the chosen monomer is going to be moved is empty</li>
<li>The move does not lead to bonds that are not contained in the bond vector set.</li>
<li>The move does not lead to overlapping of bond midpoints.</li>
</ol>
<h2 id="optional-conditions">Optional conditions</h2>

<p>If the move leads to an energetic difference 

<math display="inline" id="Bond_fluctuation_model:6">
 <semantics>
  <mrow>
   <mi mathvariant="normal">Δ</mi>
   <mi>U</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>normal-Δ</ci>
    <ci>U</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Delta U
  </annotation>
 </semantics>
</math>

 for example due to an electric field or an adsorbing force to the walls. In this case a <a href="Metropolis-Hastings_algorithm" title="wikilink">Metropolis algorithm</a> is applied: The Metroplis rate 

<math display="inline" id="Bond_fluctuation_model:7">
 <semantics>
  <msub>
   <mi>p</mi>
   <mi>M</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>p</ci>
    <ci>M</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p_{M}
  </annotation>
 </semantics>
</math>

 which is defined as</p>

<p>

<math display="block" id="Bond_fluctuation_model:8">
 <semantics>
  <mrow>
   <msub>
    <mi>p</mi>
    <mi>M</mi>
   </msub>
   <mo>=</mo>
   <mpadded width="+1.7pt">
    <msup>
     <mi>e</mi>
     <mrow>
      <mo>-</mo>
      <mrow>
       <mrow>
        <mrow>
         <mi mathvariant="normal">Δ</mi>
         <mi>U</mi>
        </mrow>
        <mo>/</mo>
        <msub>
         <mi>k</mi>
         <mi>B</mi>
        </msub>
       </mrow>
       <mi>T</mi>
      </mrow>
     </mrow>
    </msup>
   </mpadded>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>p</ci>
     <ci>M</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>e</ci>
     <apply>
      <minus></minus>
      <apply>
       <times></times>
       <apply>
        <divide></divide>
        <apply>
         <times></times>
         <ci>normal-Δ</ci>
         <ci>U</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>k</ci>
         <ci>B</ci>
        </apply>
       </apply>
       <ci>T</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p_{M}=e^{-\Delta U/k_{B}T}\,
  </annotation>
 </semantics>
</math>

</p>

<p>is compared to a random number <em>r</em> from the interval [0, 1). If the Metropolis rate is smaller than <em>r</em> the move is rejected, otherwise it is accepted.</p>

<p>The number of Monte Carlo steps of the total system is defined as:</p>

<p>

<math display="block" id="Bond_fluctuation_model:9">
 <semantics>
  <mrow>
   <mrow>
    <mi mathvariant="normal">#</mi>
    <mi>M</mi>
    <mi>C</mi>
    <mi>S</mi>
   </mrow>
   <mo>=</mo>
   <mfrac>
    <mrow>
     <mi mathvariant="normal">#</mi>
     <mtext>attempts</mtext>
    </mrow>
    <mrow>
     <mi mathvariant="normal">#</mi>
     <mtext>monomers</mtext>
    </mrow>
   </mfrac>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>normal-#</ci>
     <ci>M</ci>
     <ci>C</ci>
     <ci>S</ci>
    </apply>
    <apply>
     <divide></divide>
     <apply>
      <times></times>
      <ci>normal-#</ci>
      <mtext>attempts</mtext>
     </apply>
     <apply>
      <times></times>
      <ci>normal-#</ci>
      <mtext>monomers</mtext>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \#MCS=\frac{\#\text{ attempts}}{\#\text{ monomers}}
  </annotation>
 </semantics>
</math>

</p>
<h2 id="notes">Notes</h2>
<h2 id="external-links">External links</h2>
<ul>
<li>[<a class="uri" href="http://www.ipfdd.de/Software.1568.0.html">http://www.ipfdd.de/Software.1568.0.html</a>?&amp;L;=1 JBFM] – a <a href="Java_applet" title="wikilink">Java applet</a> from the <a href="Leibniz_Institute_of_Polymer_Research_Dresden" title="wikilink">Leibniz Institute of Polymer Research Dresden</a> (<a class="uri" href="Germany" title="wikilink">Germany</a>) for simulating polymers with the BFM</li>
</ul>

<p>"</p>

<p><a href="Category:Polymer_physics" title="wikilink">Category:Polymer physics</a> <a href="Category:Lattice_models" title="wikilink">Category:Lattice models</a> <a href="Category:Stochastic_models" title="wikilink">Category:Stochastic models</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1"><a href="#fnref1">↩</a></li>
<li id="fn2"><a href="#fnref2">↩</a></li>
<li id="fn3"><a href="#fnref3">↩</a></li>
<li id="fn4"><a href="#fnref4">↩</a></li>
</ol>
</section>
</body>
</html>

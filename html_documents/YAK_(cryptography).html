<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="530">YAK (cryptography)</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>YAK (cryptography)</h1>
<hr/>

<p>The <strong>YAK</strong> is a public-key authenticated <a href="key_agreement_protocol" title="wikilink">key agreement protocol</a>.<a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a> It is considered the simplest among the related protocols, including <a class="uri" href="MQV" title="wikilink">MQV</a>, HMQV, <a href="Station-to-Station_protocol" title="wikilink">Station-to-Station protocol</a>, <a href="Secure_Sockets_Layer" title="wikilink">SSL</a>/<a href="Transport_Layer_Security" title="wikilink">TLS</a> etc. The authentication is based on public key pairs. As with other protocols, YAK normally requires a <a href="Public_Key_Infrastructure" title="wikilink">Public Key Infrastructure</a> to distribute authentic public keys to the communicating parties. The author suggests that YAK may be unencumbered by patent.</p>
<h2 id="description">Description</h2>

<p>Two parties, Alice and Bob, agree on a group 

<math display="inline" id="YAK_(cryptography):0">
 <semantics>
  <mi>G</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>G</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   G
  </annotation>
 </semantics>
</math>

 with generator 

<math display="inline" id="YAK_(cryptography):1">
 <semantics>
  <mi>g</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>g</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   g
  </annotation>
 </semantics>
</math>

 of prime order 

<math display="inline" id="YAK_(cryptography):2">
 <semantics>
  <mi>q</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>q</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   q
  </annotation>
 </semantics>
</math>

 in which the discrete log problem is hard. Typically a <a href="Schnorr_group" title="wikilink">Schnorr group</a> is used. In general, YAK can use any prime order group that is suitable for public key cryptography, including <a href="elliptic_curve_cryptography" title="wikilink">elliptic curve cryptography</a>. Let 

<math display="inline" id="YAK_(cryptography):3">
 <semantics>
  <msup>
   <mi>g</mi>
   <mi>a</mi>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>g</ci>
    <ci>a</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   g^{a}
  </annotation>
 </semantics>
</math>

 be Alice's long-term public key and 

<math display="inline" id="YAK_(cryptography):4">
 <semantics>
  <msup>
   <mi>g</mi>
   <mi>b</mi>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>g</ci>
    <ci>b</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   g^{b}
  </annotation>
 </semantics>
</math>

 be Bob's. The protocol executes in <strong>one round</strong>:</p>

<p>Alice selects 

<math display="inline" id="YAK_(cryptography):5">
 <semantics>
  <mrow>
   <mi>x</mi>
   <msub>
    <mo>∈</mo>
    <mtext>R</mtext>
   </msub>
   <mrow>
    <mo stretchy="false">[</mo>
    <mn>0</mn>
    <mo>,</mo>
    <mrow>
     <mi>q</mi>
     <mo>-</mo>
     <mn>1</mn>
    </mrow>
    <mo stretchy="false">]</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <in></in>
     <mtext>R</mtext>
    </apply>
    <ci>x</ci>
    <interval closure="closed">
     <cn type="integer">0</cn>
     <apply>
      <minus></minus>
      <ci>q</ci>
      <cn type="integer">1</cn>
     </apply>
    </interval>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x\in_{\text{R}}[0,q-1]
  </annotation>
 </semantics>
</math>

 and sends out 

<math display="inline" id="YAK_(cryptography):6">
 <semantics>
  <msup>
   <mi>g</mi>
   <mi>x</mi>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>g</ci>
    <ci>x</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   g^{x}
  </annotation>
 </semantics>
</math>

 together with a <a href="zero-knowledge_proof" title="wikilink">zero-knowledge proof</a> (using for example <a href="Schnorr_signature" title="wikilink">Schnorr signature</a>) for the proof of the exponent 

<math display="inline" id="YAK_(cryptography):7">
 <semantics>
  <mi>x</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>x</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x
  </annotation>
 </semantics>
</math>

. Similarly, Bob selects 

<math display="inline" id="YAK_(cryptography):8">
 <semantics>
  <mrow>
   <mi>y</mi>
   <msub>
    <mo>∈</mo>
    <mtext>R</mtext>
   </msub>
   <mrow>
    <mo stretchy="false">[</mo>
    <mn>0</mn>
    <mo>,</mo>
    <mrow>
     <mi>q</mi>
     <mo>-</mo>
     <mn>1</mn>
    </mrow>
    <mo stretchy="false">]</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <in></in>
     <mtext>R</mtext>
    </apply>
    <ci>y</ci>
    <interval closure="closed">
     <cn type="integer">0</cn>
     <apply>
      <minus></minus>
      <ci>q</ci>
      <cn type="integer">1</cn>
     </apply>
    </interval>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   y\in_{\text{R}}[0,q-1]
  </annotation>
 </semantics>
</math>

 and sends out 

<math display="inline" id="YAK_(cryptography):9">
 <semantics>
  <msup>
   <mi>g</mi>
   <mi>y</mi>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>g</ci>
    <ci>y</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   g^{y}
  </annotation>
 </semantics>
</math>

 together with a <a href="zero-knowledge_proof" title="wikilink">zero-knowledge proof</a> for the proof of the exponent 

<math display="inline" id="YAK_(cryptography):10">
 <semantics>
  <mi>y</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>y</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   y
  </annotation>
 </semantics>
</math>

. Here, the notation 

<math display="inline" id="YAK_(cryptography):11">
 <semantics>
  <msub>
   <mo>∈</mo>
   <mtext>R</mtext>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <in></in>
    <mtext>R</mtext>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \in_{\text{R}}
  </annotation>
 </semantics>
</math>

 denotes <em>an element selected randomly with uniform probability</em>.</p>

<p>The above communication can be completed in one round as neither party depends on the other. When it finishes, Alice and Bob verify the received <a href="zero-knowledge_proof" title="wikilink">zero-knowledge proofs</a>. Alice then computes 

<math display="inline" id="YAK_(cryptography):12">
 <semantics>
  <mrow>
   <mi>K</mi>
   <mo>=</mo>
   <msup>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <msup>
       <mi>g</mi>
       <mi>y</mi>
      </msup>
      <msup>
       <mi>g</mi>
       <mi>b</mi>
      </msup>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
    <mrow>
     <mi>x</mi>
     <mo>+</mo>
     <mi>a</mi>
    </mrow>
   </msup>
   <mo>=</mo>
   <msup>
    <mi>g</mi>
    <mrow>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mi>x</mi>
       <mo>+</mo>
       <mi>a</mi>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mi>y</mi>
       <mo>+</mo>
       <mi>b</mi>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <ci>K</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>g</ci>
        <ci>y</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>g</ci>
        <ci>b</ci>
       </apply>
      </apply>
      <apply>
       <plus></plus>
       <ci>x</ci>
       <ci>a</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>g</ci>
      <apply>
       <times></times>
       <apply>
        <plus></plus>
        <ci>x</ci>
        <ci>a</ci>
       </apply>
       <apply>
        <plus></plus>
        <ci>y</ci>
        <ci>b</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   K=(g^{y}g^{b})^{x+a}=g^{(x+a)(y+b)}
  </annotation>
 </semantics>
</math>

. Similarly, Bob computes 

<math display="inline" id="YAK_(cryptography):13">
 <semantics>
  <mrow>
   <mi>K</mi>
   <mo>=</mo>
   <msup>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <msup>
       <mi>g</mi>
       <mi>x</mi>
      </msup>
      <msup>
       <mi>g</mi>
       <mi>a</mi>
      </msup>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
    <mrow>
     <mi>y</mi>
     <mo>+</mo>
     <mi>b</mi>
    </mrow>
   </msup>
   <mo>=</mo>
   <msup>
    <mi>g</mi>
    <mrow>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mi>x</mi>
       <mo>+</mo>
       <mi>a</mi>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mi>y</mi>
       <mo>+</mo>
       <mi>b</mi>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <ci>K</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>g</ci>
        <ci>x</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>g</ci>
        <ci>a</ci>
       </apply>
      </apply>
      <apply>
       <plus></plus>
       <ci>y</ci>
       <ci>b</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>g</ci>
      <apply>
       <times></times>
       <apply>
        <plus></plus>
        <ci>x</ci>
        <ci>a</ci>
       </apply>
       <apply>
        <plus></plus>
        <ci>y</ci>
        <ci>b</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   K=(g^{x}g^{a})^{y+b}=g^{(x+a)(y+b)}
  </annotation>
 </semantics>
</math>

. With the same keying material 

<math display="inline" id="YAK_(cryptography):14">
 <semantics>
  <mi>K</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>K</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   K
  </annotation>
 </semantics>
</math>

, Alice and Bob can derive a session key using a <a href="cryptographic_hash_function" title="wikilink">cryptographic hash function</a>

<math display="block" id="YAK_(cryptography):15">
 <semantics>
  <mrow>
   <mi>κ</mi>
   <mo>=</mo>
   <mrow>
    <mi>H</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>K</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>κ</ci>
    <apply>
     <times></times>
     <ci>H</ci>
     <ci>K</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \kappa=H(K)
  </annotation>
 </semantics>
</math>

.</p>
<h2 id="security-properties">Security properties</h2>

<p>Given that the underlying <a href="Non-interactive_zero-knowledge_proof" title="wikilink">zero knowledge proof</a> primitive is secure, the YAK protocol is proved to fulfill the following properties.</p>
<ol>
<li><strong>Private key security</strong> – An attacker cannot learn the user's static private key even if he is able to learn all session specific secrets in any compromised session.</li>
<li><strong>Full <a href="forward_secrecy" title="wikilink">forward secrecy</a></strong> – Session keys that were securely established in the past uncorrupted sessions will remain incomputable in the future even when both users' static private keys are disclosed.</li>
<li><strong>Session key security</strong> – An attacker cannot compute the session key if he impersonates a user but has no access to the user's private key.</li>
</ol>
<h2 id="references">References</h2>
<references>
</references>
<h2 id="external-links">External links</h2>
<ul>
<li><a href="http://eprint.iacr.org/2010/136.pdf">On Robust Key Agreement Based on Public Key Authentication (Full Paper)</a></li>
</ul>

<p>"</p>

<p><a class="uri" href="Category:Cryptography" title="wikilink">Category:Cryptography</a> <a href="Category:Cryptographic_protocols" title="wikilink">Category:Cryptographic protocols</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1">F. Hao, <a href="http://sites.google.com/site/haofeng662/YAK-short-final.pdf">On Robust Key Agreement Based on Public Key Authentication</a>. ''Proceedings of the 14th International Conference on Financial Cryptography and Data Security, Tenerife, Spain, LNCS 6052, pp. 383–390, Jan, 2010.<a href="#fnref1">↩</a></li>
</ol>
</section>
</body>
</html>

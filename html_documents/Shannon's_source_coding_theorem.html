<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="36">Shannon's source coding theorem</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Shannon's source coding theorem</h1>
<hr/>

<p>In <a href="information_theory" title="wikilink">information theory</a>, <strong>Shannon's source coding theorem</strong> (or <strong>noiseless coding theorem</strong>) establishes the limits to possible <a href="data_compression" title="wikilink">data compression</a>, and the operational meaning of the <a href="Shannon_entropy" title="wikilink">Shannon entropy</a>.</p>

<p>The <strong>source coding theorem</strong> shows that (in the limit, as the length of a stream of <a href="independent_identically-distributed_random_variables" title="wikilink">independent and identically-distributed random variable (i.i.d.)</a> data tends to infinity) it is impossible to compress the data such that the code rate (average number of bits per symbol) is less than the Shannon entropy of the source, without it being virtually certain that information will be lost. However it is possible to get the code rate arbitrarily close to the Shannon entropy, with negligible probability of loss.</p>

<p>The <strong>source coding theorem for symbol codes</strong> places an upper and a lower bound on the minimal possible expected length of codewords as a function of the <a href="Entropy_(information_theory)" title="wikilink">entropy</a> of the input word (which is viewed as a <a href="random_variable" title="wikilink">random variable</a>) and of the size of the target alphabet.</p>
<h2 id="statements">Statements</h2>

<p><em>Source coding</em> is a mapping from (a sequence of) symbols from an information <a href="Information_theory#Source_theory" title="wikilink">source</a> to a sequence of alphabet symbols (usually bits) such that the source symbols can be exactly recovered from the binary bits (lossless source coding) or recovered within some distortion (lossy source coding). This is the concept behind <a href="data_compression" title="wikilink">data compression</a>.</p>
<h3 id="source-coding-theorem">Source coding theorem</h3>

<p>In information theory, the <strong>source coding theorem</strong> (Shannon 1948)<a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a> informally states that (MacKay 2003, pg. 81,<a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a> Cover:Chapter 5<a class="footnoteRef" href="#fn3" id="fnref3"><sup>3</sup></a>):</p>
<blockquote>

<p>

<math display="inline" id="Shannon's_source_coding_theorem:0">
 <semantics>
  <mi>N</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>N</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   N
  </annotation>
 </semantics>
</math>

 <a href="Independent_and_identically_distributed_random_variables" title="wikilink">i.i.d.</a> random variables each with <a href="Entropy_(information_theory)" title="wikilink">entropy</a> 

<math display="inline" id="Shannon's_source_coding_theorem:1">
 <semantics>
  <mrow>
   <mi>H</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>X</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>H</ci>
    <ci>X</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   H(X)
  </annotation>
 </semantics>
</math>

 can be compressed into more than 

<math display="inline" id="Shannon's_source_coding_theorem:2">
 <semantics>
  <mrow>
   <mi>N</mi>
   <mi mathvariant="normal"></mi>
   <mi>H</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>X</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>N</ci>
    <ci>normal-</ci>
    <ci>H</ci>
    <ci>X</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   N‚ÄâH(X)
  </annotation>
 </semantics>
</math>

 <a href="bit" title="wikilink">bits</a> with negligible risk of information loss, as 

<math display="inline" id="Shannon's_source_coding_theorem:3">
 <semantics>
  <mrow>
   <mi>N</mi>
   <mi mathvariant="normal">‚Üí</mi>
   <mi mathvariant="normal">‚àû</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>N</ci>
    <ci>normal-‚Üí</ci>
    <ci>normal-‚àû</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   N‚Üí‚àû
  </annotation>
 </semantics>
</math>

; but conversely, if they are compressed into fewer than 

<math display="inline" id="Shannon's_source_coding_theorem:4">
 <semantics>
  <mrow>
   <mi>N</mi>
   <mi mathvariant="normal"></mi>
   <mi>H</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>X</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>N</ci>
    <ci>normal-</ci>
    <ci>H</ci>
    <ci>X</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   N‚ÄâH(X)
  </annotation>
 </semantics>
</math>

 bits it is virtually certain that information will be lost.</p>
</blockquote>
<h3 id="source-coding-theorem-for-symbol-codes">Source coding theorem for symbol codes</h3>

<p>Let <mtpl></mtpl> denote two finite alphabets and let 

<math display="inline" id="Shannon's_source_coding_theorem:5">
 <semantics>
  <mi mathvariant="normal">Œ£</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>normal-Œ£</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Œ£
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Shannon's_source_coding_theorem:6">
 <semantics>
  <mi mathvariant="normal">Œ£</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>normal-Œ£</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Œ£
  </annotation>
 </semantics>
</math>

 denote the <a href="Kleene_star" title="wikilink">set of all finite words</a> from those alphabets (respectively).</p>

<p>Suppose that 

<math display="inline" id="Shannon's_source_coding_theorem:7">
 <semantics>
  <mi>X</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>X</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   X
  </annotation>
 </semantics>
</math>

 is a random variable taking values in <mtpl></mtpl> and let 

<math display="inline" id="Shannon's_source_coding_theorem:8">
 <semantics>
  <mi>f</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>f</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f
  </annotation>
 </semantics>
</math>

 be a <a href="Variable-length_code#Uniquely_decodable_codes" title="wikilink">uniquely decodable</a> code from 

<math display="inline" id="Shannon's_source_coding_theorem:9">
 <semantics>
  <mi mathvariant="normal">Œ£</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>normal-Œ£</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Œ£
  </annotation>
 </semantics>
</math>

 to 

<math display="inline" id="Shannon's_source_coding_theorem:10">
 <semantics>
  <mi mathvariant="normal">Œ£</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>normal-Œ£</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Œ£
  </annotation>
 </semantics>
</math>

 where <mtpl>Œ£<sub>2</sub>{{!}} {{=}} <em>a</em>}}</mtpl>. Let 

<math display="inline" id="Shannon's_source_coding_theorem:11">
 <semantics>
  <mi>S</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>S</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   S
  </annotation>
 </semantics>
</math>

 denote the random variable given by the word length 

<math display="inline" id="Shannon's_source_coding_theorem:12">
 <semantics>
  <mrow>
   <mi>f</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>X</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>f</ci>
    <ci>X</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f(X)
  </annotation>
 </semantics>
</math>

.</p>

<p>If 

<math display="inline" id="Shannon's_source_coding_theorem:13">
 <semantics>
  <mi>f</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>f</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f
  </annotation>
 </semantics>
</math>

 is optimal in the sense that it has the minimal expected word length for 

<math display="inline" id="Shannon's_source_coding_theorem:14">
 <semantics>
  <mi>X</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>X</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   X
  </annotation>
 </semantics>
</math>

, then (Shannon 1948):</p>

<p>

<math display="block" id="Shannon's_source_coding_theorem:15">
 <semantics>
  <mrow>
   <mfrac>
    <mrow>
     <mi>H</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>X</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mrow>
     <msub>
      <mi>log</mi>
      <mn>2</mn>
     </msub>
     <mi>a</mi>
    </mrow>
   </mfrac>
   <mo>‚â§</mo>
   <mrow>
    <mi>ùîº</mi>
    <mi>S</mi>
   </mrow>
   <mo><</mo>
   <mrow>
    <mfrac>
     <mrow>
      <mi>H</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>X</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mrow>
      <msub>
       <mi>log</mi>
       <mn>2</mn>
      </msub>
      <mi>a</mi>
     </mrow>
    </mfrac>
    <mo>+</mo>
    <mn>1</mn>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <leq></leq>
     <apply>
      <divide></divide>
      <apply>
       <times></times>
       <ci>H</ci>
       <ci>X</ci>
      </apply>
      <apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <log></log>
        <cn type="integer">2</cn>
       </apply>
       <ci>a</ci>
      </apply>
     </apply>
     <apply>
      <times></times>
      <ci>ùîº</ci>
      <ci>S</ci>
     </apply>
    </apply>
    <apply>
     <lt></lt>
     <share href="#.cmml">
     </share>
     <apply>
      <plus></plus>
      <apply>
       <divide></divide>
       <apply>
        <times></times>
        <ci>H</ci>
        <ci>X</ci>
       </apply>
       <apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <log></log>
         <cn type="integer">2</cn>
        </apply>
        <ci>a</ci>
       </apply>
      </apply>
      <cn type="integer">1</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \frac{H(X)}{\log_{2}a}\leq\mathbb{E}S<\frac{H(X)}{\log_{2}a}+1
  </annotation>
 </semantics>
</math>

</p>
<h2 id="proof-source-coding-theorem">Proof: Source coding theorem</h2>

<p>Given 

<math display="inline" id="Shannon's_source_coding_theorem:16">
 <semantics>
  <mi>X</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>X</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   X
  </annotation>
 </semantics>
</math>

 is an <a href="independent_identically-distributed_random_variables" title="wikilink">i.i.d.</a> source, its <a href="time_series" title="wikilink">time series</a> <mtpl></mtpl> is i.i.d. with <a class="uri" href="entropy" title="wikilink">entropy</a> 

<math display="inline" id="Shannon's_source_coding_theorem:17">
 <semantics>
  <mrow>
   <mi>H</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>X</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>H</ci>
    <ci>X</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   H(X)
  </annotation>
 </semantics>
</math>

 in the discrete-valued case and <a href="differential_entropy" title="wikilink">differential entropy</a> in the continuous-valued case. The Source coding theorem states that for any 

<math display="inline" id="Shannon's_source_coding_theorem:18">
 <semantics>
  <mrow>
   <mi>Œµ</mi>
   <mo>></mo>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <gt></gt>
    <ci>Œµ</ci>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Œµ>0
  </annotation>
 </semantics>
</math>

 for any <a href="information_theory#Rate" title="wikilink">rate</a> larger than the <a class="uri" href="entropy" title="wikilink">entropy</a> of the source, there is large enough 

<math display="inline" id="Shannon's_source_coding_theorem:19">
 <semantics>
  <mi>n</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>n</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n
  </annotation>
 </semantics>
</math>

 and an encoder that takes 

<math display="inline" id="Shannon's_source_coding_theorem:20">
 <semantics>
  <mi>n</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>n</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n
  </annotation>
 </semantics>
</math>

 i.i.d. repetition of the source, <mtpl></mtpl>, and maps it to 

<math display="inline" id="Shannon's_source_coding_theorem:21">
 <semantics>
  <mrow>
   <mi>n</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mrow>
     <mrow>
      <mi>H</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>X</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo>+</mo>
     <mi>Œµ</mi>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>n</ci>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <ci>H</ci>
      <ci>X</ci>
     </apply>
     <ci>Œµ</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n(H(X)+Œµ)
  </annotation>
 </semantics>
</math>

 binary bits such that the source symbols <mtpl></mtpl> are recoverable from the binary bits with probability at least 

<math display="inline" id="Shannon's_source_coding_theorem:22">
 <semantics>
  <mrow>
   <mn>1</mn>
   <mi mathvariant="normal">‚àí</mi>
   <mi>Œµ</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <cn type="integer">1</cn>
    <ci>normal-‚àí</ci>
    <ci>Œµ</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   1‚àíŒµ
  </annotation>
 </semantics>
</math>

.</p>

<p><strong>Proof of Achievability.</strong> Fix some 

<math display="inline" id="Shannon's_source_coding_theorem:23">
 <semantics>
  <mrow>
   <mi>Œµ</mi>
   <mo>></mo>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <gt></gt>
    <ci>Œµ</ci>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Œµ>0
  </annotation>
 </semantics>
</math>

, and let</p>

<p>

<math display="block" id="Shannon's_source_coding_theorem:24">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>p</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <msub>
       <mi>x</mi>
       <mn>1</mn>
      </msub>
      <mo>,</mo>
      <mi mathvariant="normal">‚Ä¶</mi>
      <mo>,</mo>
      <msub>
       <mi>x</mi>
       <mi>n</mi>
      </msub>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mi>Pr</mi>
     <mrow>
      <mo>[</mo>
      <mrow>
       <msub>
        <mi>X</mi>
        <mn>1</mn>
       </msub>
       <mo>=</mo>
       <msub>
        <mi>x</mi>
        <mn>1</mn>
       </msub>
      </mrow>
      <mo>,</mo>
      <mi mathvariant="normal">‚ãØ</mi>
      <mo>,</mo>
      <mrow>
       <msub>
        <mi>X</mi>
        <mi>n</mi>
       </msub>
       <mo>=</mo>
       <msub>
        <mi>x</mi>
        <mi>n</mi>
       </msub>
      </mrow>
      <mo>]</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>p</ci>
     <vector>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <cn type="integer">1</cn>
      </apply>
      <ci>normal-‚Ä¶</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <ci>n</ci>
      </apply>
     </vector>
    </apply>
    <apply>
     <ci>Pr</ci>
     <apply>
      <eq></eq>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>X</ci>
       <cn type="integer">1</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <ci>normal-‚ãØ</ci>
     <apply>
      <eq></eq>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>X</ci>
       <ci>n</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <ci>n</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p(x_{1},\ldots,x_{n})=\Pr\left[X_{1}=x_{1},\cdots,X_{n}=x_{n}\right].
  </annotation>
 </semantics>
</math>

</p>

<p>The typical set, 

<math display="inline" id="Shannon's_source_coding_theorem:25">
 <semantics>
  <mi>A</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>A</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A
  </annotation>
 </semantics>
</math>

, is defined as follows:</p>

<p>

<math display="block" id="Shannon's_source_coding_theorem:26">
 <semantics>
  <mrow>
   <mrow>
    <msubsup>
     <mi>A</mi>
     <mi>n</mi>
     <mi>Œµ</mi>
    </msubsup>
    <mo>=</mo>
    <mrow>
     <mo>{</mo>
     <mrow>
      <mo stretchy="false">(</mo>
      <msub>
       <mi>x</mi>
       <mn>1</mn>
      </msub>
      <mo>,</mo>
      <mi mathvariant="normal">‚ãØ</mi>
      <mo>,</mo>
      <msub>
       <mi>x</mi>
       <mi>n</mi>
      </msub>
      <mo rspace="7.5pt" stretchy="false">)</mo>
     </mrow>
     <mo rspace="7.5pt">:</mo>
     <mrow>
      <mrow>
       <mo>|</mo>
       <mrow>
        <mrow>
         <mo>-</mo>
         <mrow>
          <mfrac>
           <mn>1</mn>
           <mi>n</mi>
          </mfrac>
          <mrow>
           <mi>log</mi>
           <mi>p</mi>
          </mrow>
          <mrow>
           <mo stretchy="false">(</mo>
           <msub>
            <mi>x</mi>
            <mn>1</mn>
           </msub>
           <mo>,</mo>
           <mi mathvariant="normal">‚ãØ</mi>
           <mo>,</mo>
           <msub>
            <mi>x</mi>
            <mi>n</mi>
           </msub>
           <mo stretchy="false">)</mo>
          </mrow>
         </mrow>
        </mrow>
        <mo>-</mo>
        <mrow>
         <msub>
          <mi>H</mi>
          <mi>n</mi>
         </msub>
         <mrow>
          <mo stretchy="false">(</mo>
          <mi>X</mi>
          <mo stretchy="false">)</mo>
         </mrow>
        </mrow>
       </mrow>
       <mo>|</mo>
      </mrow>
      <mo><</mo>
      <mi>Œµ</mi>
     </mrow>
     <mo>}</mo>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>A</ci>
      <ci>n</ci>
     </apply>
     <ci>Œµ</ci>
    </apply>
    <apply>
     <csymbol cd="latexml">conditional-set</csymbol>
     <vector>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <cn type="integer">1</cn>
      </apply>
      <ci>normal-‚ãØ</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <ci>n</ci>
      </apply>
     </vector>
     <apply>
      <lt></lt>
      <apply>
       <abs></abs>
       <apply>
        <minus></minus>
        <apply>
         <minus></minus>
         <apply>
          <times></times>
          <apply>
           <divide></divide>
           <cn type="integer">1</cn>
           <ci>n</ci>
          </apply>
          <apply>
           <log></log>
           <ci>p</ci>
          </apply>
          <vector>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <ci>x</ci>
            <cn type="integer">1</cn>
           </apply>
           <ci>normal-‚ãØ</ci>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <ci>x</ci>
            <ci>n</ci>
           </apply>
          </vector>
         </apply>
        </apply>
        <apply>
         <times></times>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>H</ci>
          <ci>n</ci>
         </apply>
         <ci>X</ci>
        </apply>
       </apply>
      </apply>
      <ci>Œµ</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A_{n}^{\varepsilon}=\left\{(x_{1},\cdots,x_{n})\ :\ \left|-\frac{1}{n}\log p(x%
_{1},\cdots,x_{n})-H_{n}(X)\right|<\varepsilon\right\}.
  </annotation>
 </semantics>
</math>

</p>

<p>The <a href="Asymptotic_equipartition_property#AEP_for_discrete-time_i.i.d._sources" title="wikilink">Asymptotic Equipartition Property</a> (AEP) shows that for large enough 

<math display="inline" id="Shannon's_source_coding_theorem:27">
 <semantics>
  <mi>n</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>n</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n
  </annotation>
 </semantics>
</math>

, the probability that a sequence generated by the source lies in the typical set, 

<math display="inline" id="Shannon's_source_coding_theorem:28">
 <semantics>
  <mi>A</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>A</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A
  </annotation>
 </semantics>
</math>

, as defined approaches one. In particular there for large enough 

<math display="inline" id="Shannon's_source_coding_theorem:29">
 <semantics>
  <mi>n</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>n</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n
  </annotation>
 </semantics>
</math>

, 

<math display="inline" id="Shannon's_source_coding_theorem:30">
 <semantics>
  <mrow>
   <mrow>
    <mi>P</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <msubsup>
      <mi>A</mi>
      <mi>n</mi>
      <mi>Œµ</mi>
     </msubsup>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>></mo>
   <mrow>
    <mn>1</mn>
    <mo>-</mo>
    <mi>Œµ</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <gt></gt>
    <apply>
     <times></times>
     <ci>P</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>A</ci>
       <ci>n</ci>
      </apply>
      <ci>Œµ</ci>
     </apply>
    </apply>
    <apply>
     <minus></minus>
     <cn type="integer">1</cn>
     <ci>Œµ</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   P(A_{n}^{\varepsilon})>1-\varepsilon
  </annotation>
 </semantics>
</math>

 (See <a href="Asymptotic_equipartition_property#AEP_for_discrete-time_i.i.d._sources" title="wikilink">AEP</a> for a proof):</p>

<p>The definition of typical sets implies that those sequences that lie in the typical set satisfy:</p>

<p>

<math display="block" id="Shannon's_source_coding_theorem:31">
 <semantics>
  <mrow>
   <msup>
    <mn>2</mn>
    <mrow>
     <mo>-</mo>
     <mrow>
      <mi>n</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mrow>
         <mi>H</mi>
         <mrow>
          <mo stretchy="false">(</mo>
          <mi>X</mi>
          <mo stretchy="false">)</mo>
         </mrow>
        </mrow>
        <mo>+</mo>
        <mi>Œµ</mi>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mrow>
   </msup>
   <mo>‚â§</mo>
   <mrow>
    <mi>p</mi>
    <mrow>
     <mo>(</mo>
     <msub>
      <mi>x</mi>
      <mn>1</mn>
     </msub>
     <mo>,</mo>
     <mi mathvariant="normal">‚ãØ</mi>
     <mo>,</mo>
     <msub>
      <mi>x</mi>
      <mi>n</mi>
     </msub>
     <mo>)</mo>
    </mrow>
   </mrow>
   <mo>‚â§</mo>
   <msup>
    <mn>2</mn>
    <mrow>
     <mo>-</mo>
     <mrow>
      <mi>n</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mrow>
         <mi>H</mi>
         <mrow>
          <mo stretchy="false">(</mo>
          <mi>X</mi>
          <mo stretchy="false">)</mo>
         </mrow>
        </mrow>
        <mo>-</mo>
        <mi>Œµ</mi>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mrow>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <leq></leq>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <cn type="integer">2</cn>
      <apply>
       <minus></minus>
       <apply>
        <times></times>
        <ci>n</ci>
        <apply>
         <plus></plus>
         <apply>
          <times></times>
          <ci>H</ci>
          <ci>X</ci>
         </apply>
         <ci>Œµ</ci>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <ci>p</ci>
      <vector>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <cn type="integer">1</cn>
       </apply>
       <ci>normal-‚ãØ</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <ci>n</ci>
       </apply>
      </vector>
     </apply>
    </apply>
    <apply>
     <leq></leq>
     <share href="#.cmml">
     </share>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <cn type="integer">2</cn>
      <apply>
       <minus></minus>
       <apply>
        <times></times>
        <ci>n</ci>
        <apply>
         <minus></minus>
         <apply>
          <times></times>
          <ci>H</ci>
          <ci>X</ci>
         </apply>
         <ci>Œµ</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   2^{-n(H(X)+\varepsilon)}\leq p\left(x_{1},\cdots,x_{n}\right)\leq 2^{-n(H(X)-%
\varepsilon)}
  </annotation>
 </semantics>
</math>

</p>

<p>Note that:</p>
<ul>
<li>The probability of a sequence from 

<math display="inline" id="Shannon's_source_coding_theorem:32">
 <semantics>
  <mi>X</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>X</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   X
  </annotation>
 </semantics>
</math>

 being drawn from 

<math display="inline" id="Shannon's_source_coding_theorem:33">
 <semantics>
  <mi>A</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>A</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A
  </annotation>
 </semantics>
</math>

 is greater than 

<math display="inline" id="Shannon's_source_coding_theorem:34">
 <semantics>
  <mrow>
   <mn>1</mn>
   <mi mathvariant="normal">‚àí</mi>
   <mi>Œµ</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <cn type="integer">1</cn>
    <ci>normal-‚àí</ci>
    <ci>Œµ</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   1‚àíŒµ
  </annotation>
 </semantics>
</math>

.</li>
</ul>
<ul>
<li>

<math display="inline" id="Shannon's_source_coding_theorem:35">
 <semantics>
  <mrow>
   <mrow>
    <mo>|</mo>
    <msubsup>
     <mi>A</mi>
     <mi>n</mi>
     <mi>Œµ</mi>
    </msubsup>
    <mo>|</mo>
   </mrow>
   <mo>‚â§</mo>
   <msup>
    <mn>2</mn>
    <mrow>
     <mi>n</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mrow>
        <mi>H</mi>
        <mrow>
         <mo stretchy="false">(</mo>
         <mi>X</mi>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
       <mo>+</mo>
       <mi>Œµ</mi>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <leq></leq>
    <apply>
     <abs></abs>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>A</ci>
       <ci>n</ci>
      </apply>
      <ci>Œµ</ci>
     </apply>
    </apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <cn type="integer">2</cn>
     <apply>
      <times></times>
      <ci>n</ci>
      <apply>
       <plus></plus>
       <apply>
        <times></times>
        <ci>H</ci>
        <ci>X</ci>
       </apply>
       <ci>Œµ</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \left|A_{n}^{\varepsilon}\right|\leq 2^{n(H(X)+\varepsilon)}
  </annotation>
 </semantics>
</math>

 since the probability of the whole set 

<math display="inline" id="Shannon's_source_coding_theorem:36">
 <semantics>
  <mi>A</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>A</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A
  </annotation>
 </semantics>
</math>

 is at most one.</li>
</ul>
<ul>
<li>

<math display="inline" id="Shannon's_source_coding_theorem:37">
 <semantics>
  <mrow>
   <mrow>
    <mo>|</mo>
    <msubsup>
     <mi>A</mi>
     <mi>n</mi>
     <mi>Œµ</mi>
    </msubsup>
    <mo>|</mo>
   </mrow>
   <mo>‚â•</mo>
   <mrow>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mn>1</mn>
      <mo>-</mo>
      <mi>Œµ</mi>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
    <msup>
     <mn>2</mn>
     <mrow>
      <mi>n</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mrow>
         <mi>H</mi>
         <mrow>
          <mo stretchy="false">(</mo>
          <mi>X</mi>
          <mo stretchy="false">)</mo>
         </mrow>
        </mrow>
        <mo>-</mo>
        <mi>Œµ</mi>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </msup>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <geq></geq>
    <apply>
     <abs></abs>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>A</ci>
       <ci>n</ci>
      </apply>
      <ci>Œµ</ci>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <minus></minus>
      <cn type="integer">1</cn>
      <ci>Œµ</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <cn type="integer">2</cn>
      <apply>
       <times></times>
       <ci>n</ci>
       <apply>
        <minus></minus>
        <apply>
         <times></times>
         <ci>H</ci>
         <ci>X</ci>
        </apply>
        <ci>Œµ</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \left|A_{n}^{\varepsilon}\right|\geq(1-\varepsilon)2^{n(H(X)-\varepsilon)}
  </annotation>
 </semantics>
</math>

. For the proof, use the upper bound on the probability of each term in typical set and the lower bound on the probability of the whole set 

<math display="inline" id="Shannon's_source_coding_theorem:38">
 <semantics>
  <mi>A</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>A</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A
  </annotation>
 </semantics>
</math>

.</li>
</ul>

<p>Since 

<math display="inline" id="Shannon's_source_coding_theorem:39">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mo>|</mo>
     <msubsup>
      <mi>A</mi>
      <mi>n</mi>
      <mi>Œµ</mi>
     </msubsup>
     <mo>|</mo>
    </mrow>
    <mo>‚â§</mo>
    <mrow>
     <msup>
      <mn>2</mn>
      <mrow>
       <mi>n</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mrow>
          <mi>H</mi>
          <mrow>
           <mo stretchy="false">(</mo>
           <mi>X</mi>
           <mo stretchy="false">)</mo>
          </mrow>
         </mrow>
         <mo>+</mo>
         <mi>Œµ</mi>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
     </msup>
     <mo>,</mo>
     <mi>n</mi>
    </mrow>
   </mrow>
   <mo>.</mo>
   <mrow>
    <mo stretchy="false">(</mo>
    <mrow>
     <mrow>
      <mi>H</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>X</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo>+</mo>
     <mi>Œµ</mi>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <leq></leq>
     <apply>
      <abs></abs>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>A</ci>
        <ci>n</ci>
       </apply>
       <ci>Œµ</ci>
      </apply>
     </apply>
     <list>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <cn type="integer">2</cn>
       <apply>
        <times></times>
        <ci>n</ci>
        <apply>
         <plus></plus>
         <apply>
          <times></times>
          <ci>H</ci>
          <ci>X</ci>
         </apply>
         <ci>Œµ</ci>
        </apply>
       </apply>
      </apply>
      <ci>n</ci>
     </list>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <ci>H</ci>
      <ci>X</ci>
     </apply>
     <ci>Œµ</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \left|A_{n}^{\varepsilon}\right|\leq 2^{n(H(X)+\varepsilon)},n.(H(X)+\varepsilon)
  </annotation>
 </semantics>
</math>

 bits are enough to point to any string in this set.</p>

<p>The encoding algorithm: The encoder checks if the input sequence lies within the typical set; if yes, it outputs the index of the input sequence within the typical set; if not, the encoder outputs an arbitrary 

<math display="inline" id="Shannon's_source_coding_theorem:40">
 <semantics>
  <mrow>
   <mi>n</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mrow>
     <mrow>
      <mi>H</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>X</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo>+</mo>
     <mi>Œµ</mi>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>n</ci>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <ci>H</ci>
      <ci>X</ci>
     </apply>
     <ci>Œµ</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n(H(X)+Œµ)
  </annotation>
 </semantics>
</math>

 digit number. As long as the input sequence lies within the typical set (with probability at least 

<math display="inline" id="Shannon's_source_coding_theorem:41">
 <semantics>
  <mrow>
   <mn>1</mn>
   <mi mathvariant="normal">‚àí</mi>
   <mi>Œµ</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <cn type="integer">1</cn>
    <ci>normal-‚àí</ci>
    <ci>Œµ</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   1‚àíŒµ
  </annotation>
 </semantics>
</math>

), the encoder doesn't make any error. So, the probability of error of the encoder is bounded above by 

<math display="inline" id="Shannon's_source_coding_theorem:42">
 <semantics>
  <mi>Œµ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>Œµ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Œµ
  </annotation>
 </semantics>
</math>

.</p>

<p><strong>Proof of Converse.</strong> The converse is proved by showing that any set of size smaller than 

<math display="inline" id="Shannon's_source_coding_theorem:43">
 <semantics>
  <mi>A</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>A</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A
  </annotation>
 </semantics>
</math>

 (in the sense of exponent) would cover a set of probability bounded away from 

<math display="inline" id="Shannon's_source_coding_theorem:44">
 <semantics>
  <mn>1</mn>
  <annotation-xml encoding="MathML-Content">
   <cn type="integer">1</cn>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   1
  </annotation>
 </semantics>
</math>

.</p>
<h2 id="proof-source-coding-theorem-for-symbol-codes">Proof: Source coding theorem for symbol codes</h2>

<p>For 

<math display="inline" id="Shannon's_source_coding_theorem:45">
 <semantics>
  <mrow>
   <mn>1</mn>
   <mi mathvariant="normal">‚â§</mi>
   <mi>i</mi>
   <mi mathvariant="normal">‚â§</mi>
   <mi>n</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <cn type="integer">1</cn>
    <ci>normal-‚â§</ci>
    <ci>i</ci>
    <ci>normal-‚â§</ci>
    <ci>n</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   1‚â§i‚â§n
  </annotation>
 </semantics>
</math>

 let <mtpl></mtpl> denote the word length of each possible <mtpl></mtpl>. Define 

<math display="inline" id="Shannon's_source_coding_theorem:46">
 <semantics>
  <mrow>
   <msub>
    <mi>q</mi>
    <mi>i</mi>
   </msub>
   <mo>=</mo>
   <mrow>
    <msup>
     <mi>a</mi>
     <mrow>
      <mo>-</mo>
      <msub>
       <mi>s</mi>
       <mi>i</mi>
      </msub>
     </mrow>
    </msup>
    <mo>/</mo>
    <mi>C</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>q</ci>
     <ci>i</ci>
    </apply>
    <apply>
     <divide></divide>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>a</ci>
      <apply>
       <minus></minus>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>s</ci>
        <ci>i</ci>
       </apply>
      </apply>
     </apply>
     <ci>C</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   q_{i}=a^{-s_{i}}/C
  </annotation>
 </semantics>
</math>

, where 

<math display="inline" id="Shannon's_source_coding_theorem:47">
 <semantics>
  <mi>C</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>C</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   C
  </annotation>
 </semantics>
</math>

 is chosen so that <mtpl> 1}}</mtpl>. Then</p>

<p>

<math display="inline" id="Shannon's_source_coding_theorem:48">
 <semantics>
  <mrow>
   <mi>H</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>X</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>H</ci>
    <ci>X</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle H(X)
  </annotation>
 </semantics>
</math>


</p>

<p>where the second line follows from <a href="Gibbs'_inequality" title="wikilink">Gibbs' inequality</a> and the fifth line follows from <a href="Kraft's_inequality" title="wikilink">Kraft's inequality</a>:</p>

<p>

<math display="block" id="Shannon's_source_coding_theorem:49">
 <semantics>
  <mrow>
   <mi>C</mi>
   <mo>=</mo>
   <mrow>
    <munderover>
     <mo largeop="true" movablelimits="false" symmetric="true">‚àë</mo>
     <mrow>
      <mi>i</mi>
      <mo>=</mo>
      <mn>1</mn>
     </mrow>
     <mi>n</mi>
    </munderover>
    <msup>
     <mi>a</mi>
     <mrow>
      <mo>-</mo>
      <msub>
       <mi>s</mi>
       <mi>i</mi>
      </msub>
     </mrow>
    </msup>
   </mrow>
   <mo>‚â§</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <ci>C</ci>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <apply>
         <eq></eq>
         <ci>i</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <ci>n</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>a</ci>
       <apply>
        <minus></minus>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>s</ci>
         <ci>i</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <leq></leq>
     <share href="#.cmml">
     </share>
     <cn type="integer">1</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   C=\sum_{i=1}^{n}a^{-s_{i}}\leq 1
  </annotation>
 </semantics>
</math>

</p>

<p>so 

<math display="inline" id="Shannon's_source_coding_theorem:50">
 <semantics>
  <mrow>
   <mi>l</mi>
   <mi>o</mi>
   <mi>g</mi>
   <mi>C</mi>
   <mi mathvariant="normal">‚â§</mi>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>l</ci>
    <ci>o</ci>
    <ci>g</ci>
    <ci>C</ci>
    <ci>normal-‚â§</ci>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   logC‚â§0
  </annotation>
 </semantics>
</math>

.</p>

<p>For the second inequality we may set</p>

<p>

<math display="block" id="Shannon's_source_coding_theorem:51">
 <semantics>
  <mrow>
   <msub>
    <mi>s</mi>
    <mi>i</mi>
   </msub>
   <mo>=</mo>
   <mrow>
    <mo stretchy="false">‚åà</mo>
    <mrow>
     <mo>-</mo>
     <mrow>
      <msub>
       <mi>log</mi>
       <mi>a</mi>
      </msub>
      <msub>
       <mi>p</mi>
       <mi>i</mi>
      </msub>
     </mrow>
    </mrow>
    <mo stretchy="false">‚åâ</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>s</ci>
     <ci>i</ci>
    </apply>
    <apply>
     <ceiling></ceiling>
     <apply>
      <minus></minus>
      <apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <log></log>
        <ci>a</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>p</ci>
        <ci>i</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   s_{i}=\lceil-\log_{a}p_{i}\rceil
  </annotation>
 </semantics>
</math>

</p>

<p>so that</p>

<p>

<math display="block" id="Shannon's_source_coding_theorem:52">
 <semantics>
  <mrow>
   <mrow>
    <mo>-</mo>
    <mrow>
     <msub>
      <mi>log</mi>
      <mi>a</mi>
     </msub>
     <msub>
      <mi>p</mi>
      <mi>i</mi>
     </msub>
    </mrow>
   </mrow>
   <mo>‚â§</mo>
   <msub>
    <mi>s</mi>
    <mi>i</mi>
   </msub>
   <mo><</mo>
   <mrow>
    <mrow>
     <mo>-</mo>
     <mrow>
      <msub>
       <mi>log</mi>
       <mi>a</mi>
      </msub>
      <msub>
       <mi>p</mi>
       <mi>i</mi>
      </msub>
     </mrow>
    </mrow>
    <mo>+</mo>
    <mn>1</mn>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <leq></leq>
     <apply>
      <minus></minus>
      <apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <log></log>
        <ci>a</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>p</ci>
        <ci>i</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>s</ci>
      <ci>i</ci>
     </apply>
    </apply>
    <apply>
     <lt></lt>
     <share href="#.cmml">
     </share>
     <apply>
      <plus></plus>
      <apply>
       <minus></minus>
       <apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <log></log>
         <ci>a</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>p</ci>
         <ci>i</ci>
        </apply>
       </apply>
      </apply>
      <cn type="integer">1</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   -\log_{a}p_{i}\leq s_{i}<-\log_{a}p_{i}+1
  </annotation>
 </semantics>
</math>

</p>

<p>and so</p>

<p>

<math display="block" id="Shannon's_source_coding_theorem:53">
 <semantics>
  <mrow>
   <msup>
    <mi>a</mi>
    <mrow>
     <mo>-</mo>
     <msub>
      <mi>s</mi>
      <mi>i</mi>
     </msub>
    </mrow>
   </msup>
   <mo>‚â§</mo>
   <msub>
    <mi>p</mi>
    <mi>i</mi>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <leq></leq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>a</ci>
     <apply>
      <minus></minus>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>s</ci>
       <ci>i</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>p</ci>
     <ci>i</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a^{-s_{i}}\leq p_{i}
  </annotation>
 </semantics>
</math>

</p>

<p>and</p>

<p>

<math display="block" id="Shannon's_source_coding_theorem:54">
 <semantics>
  <mrow>
   <mrow>
    <mo largeop="true" movablelimits="false" symmetric="true">‚àë</mo>
    <msup>
     <mi>a</mi>
     <mrow>
      <mo>-</mo>
      <msub>
       <mi>s</mi>
       <mi>i</mi>
      </msub>
     </mrow>
    </msup>
   </mrow>
   <mo>‚â§</mo>
   <mrow>
    <mo largeop="true" movablelimits="false" symmetric="true">‚àë</mo>
    <msub>
     <mi>p</mi>
     <mi>i</mi>
    </msub>
   </mrow>
   <mo>=</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <leq></leq>
     <apply>
      <sum></sum>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>a</ci>
       <apply>
        <minus></minus>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>s</ci>
         <ci>i</ci>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <sum></sum>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>p</ci>
       <ci>i</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <cn type="integer">1</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \sum a^{-s_{i}}\leq\sum p_{i}=1
  </annotation>
 </semantics>
</math>

</p>

<p>and so by Kraft's inequality there exists a prefix-free code having those word lengths. Thus the minimal 

<math display="inline" id="Shannon's_source_coding_theorem:55">
 <semantics>
  <mi>S</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>S</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   S
  </annotation>
 </semantics>
</math>

 satisfies</p>

<p>

<math display="inline" id="Shannon's_source_coding_theorem:56">
 <semantics>
  <mrow>
   <mi>ùîº</mi>
   <mi>S</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>ùîº</ci>
    <ci>S</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle\mathbb{E}S
  </annotation>
 </semantics>
</math>


</p>
<h2 id="extension-to-non-stationary-independent-sources">Extension to non-stationary independent sources</h2>
<h3 id="fixed-rate-lossless-source-coding-for-discrete-time-non-stationary-independent-sources">Fixed Rate lossless source coding for discrete time non-stationary independent sources</h3>

<p>Define typical set 

<math display="inline" id="Shannon's_source_coding_theorem:57">
 <semantics>
  <mi>A</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>A</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A
  </annotation>
 </semantics>
</math>

 as:</p>

<p>

<math display="block" id="Shannon's_source_coding_theorem:58">
 <semantics>
  <mrow>
   <mrow>
    <msubsup>
     <mi>A</mi>
     <mi>n</mi>
     <mi>Œµ</mi>
    </msubsup>
    <mo>=</mo>
    <mrow>
     <mo>{</mo>
     <mpadded width="+5pt">
      <msubsup>
       <mi>x</mi>
       <mn>1</mn>
       <mi>n</mi>
      </msubsup>
     </mpadded>
     <mo rspace="7.5pt">:</mo>
     <mrow>
      <mrow>
       <mo>|</mo>
       <mrow>
        <mrow>
         <mo>-</mo>
         <mrow>
          <mfrac>
           <mn>1</mn>
           <mi>n</mi>
          </mfrac>
          <mrow>
           <mi>log</mi>
           <mi>p</mi>
          </mrow>
          <mrow>
           <mo>(</mo>
           <msub>
            <mi>X</mi>
            <mn>1</mn>
           </msub>
           <mo>,</mo>
           <mi mathvariant="normal">‚ãØ</mi>
           <mo>,</mo>
           <msub>
            <mi>X</mi>
            <mi>n</mi>
           </msub>
           <mo>)</mo>
          </mrow>
         </mrow>
        </mrow>
        <mo>-</mo>
        <mrow>
         <mover accent="true">
          <msub>
           <mi>H</mi>
           <mi>n</mi>
          </msub>
          <mo>¬Ø</mo>
         </mover>
         <mrow>
          <mo stretchy="false">(</mo>
          <mi>X</mi>
          <mo stretchy="false">)</mo>
         </mrow>
        </mrow>
       </mrow>
       <mo>|</mo>
      </mrow>
      <mo><</mo>
      <mi>Œµ</mi>
     </mrow>
     <mo>}</mo>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>A</ci>
      <ci>n</ci>
     </apply>
     <ci>Œµ</ci>
    </apply>
    <apply>
     <csymbol cd="latexml">conditional-set</csymbol>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <cn type="integer">1</cn>
      </apply>
      <ci>n</ci>
     </apply>
     <apply>
      <lt></lt>
      <apply>
       <abs></abs>
       <apply>
        <minus></minus>
        <apply>
         <minus></minus>
         <apply>
          <times></times>
          <apply>
           <divide></divide>
           <cn type="integer">1</cn>
           <ci>n</ci>
          </apply>
          <apply>
           <log></log>
           <ci>p</ci>
          </apply>
          <vector>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <ci>X</ci>
            <cn type="integer">1</cn>
           </apply>
           <ci>normal-‚ãØ</ci>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <ci>X</ci>
            <ci>n</ci>
           </apply>
          </vector>
         </apply>
        </apply>
        <apply>
         <times></times>
         <apply>
          <ci>normal-¬Ø</ci>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>H</ci>
           <ci>n</ci>
          </apply>
         </apply>
         <ci>X</ci>
        </apply>
       </apply>
      </apply>
      <ci>Œµ</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A_{n}^{\varepsilon}=\left\{x_{1}^{n}\ :\ \left|-\frac{1}{n}\log p\left(X_{1},%
\cdots,X_{n}\right)-\overline{H_{n}}(X)\right|<\varepsilon\right\}.
  </annotation>
 </semantics>
</math>

</p>

<p>Then, for given 

<math display="inline" id="Shannon's_source_coding_theorem:59">
 <semantics>
  <mrow>
   <mi>Œ¥</mi>
   <mo>></mo>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <gt></gt>
    <ci>Œ¥</ci>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Œ¥>0
  </annotation>
 </semantics>
</math>

, for 

<math display="inline" id="Shannon's_source_coding_theorem:60">
 <semantics>
  <mi>n</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>n</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n
  </annotation>
 </semantics>
</math>

 large enough, 

<math display="inline" id="Shannon's_source_coding_theorem:61">
 <semantics>
  <mrow>
   <mrow>
    <mi>P</mi>
    <mi>r</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>A</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>></mo>
   <mrow>
    <mn>1</mn>
    <mi mathvariant="normal">‚àí</mi>
    <mi>Œ¥</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <gt></gt>
    <apply>
     <times></times>
     <ci>P</ci>
     <ci>r</ci>
     <ci>A</ci>
    </apply>
    <apply>
     <times></times>
     <cn type="integer">1</cn>
     <ci>normal-‚àí</ci>
     <ci>Œ¥</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Pr(A)>1‚àíŒ¥
  </annotation>
 </semantics>
</math>

. Now we just encode the sequences in the typical set, and usual methods in source coding show that the cardinality of this set is smaller than 

<math display="inline" id="Shannon's_source_coding_theorem:62">
 <semantics>
  <msup>
   <mn>2</mn>
   <mrow>
    <mi>n</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mrow>
       <mover accent="true">
        <msub>
         <mi>H</mi>
         <mi>n</mi>
        </msub>
        <mo>¬Ø</mo>
       </mover>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>X</mi>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
      <mo>+</mo>
      <mi>Œµ</mi>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <cn type="integer">2</cn>
    <apply>
     <times></times>
     <ci>n</ci>
     <apply>
      <plus></plus>
      <apply>
       <times></times>
       <apply>
        <ci>normal-¬Ø</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>H</ci>
         <ci>n</ci>
        </apply>
       </apply>
       <ci>X</ci>
      </apply>
      <ci>Œµ</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   2^{n(\overline{H_{n}}(X)+\varepsilon)}
  </annotation>
 </semantics>
</math>

. Thus, on an average, <mtpl></mtpl> bits suffice for encoding with probability greater than 

<math display="inline" id="Shannon's_source_coding_theorem:63">
 <semantics>
  <mrow>
   <mn>1</mn>
   <mi mathvariant="normal">‚àí</mi>
   <mi>Œ¥</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <cn type="integer">1</cn>
    <ci>normal-‚àí</ci>
    <ci>Œ¥</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   1‚àíŒ¥
  </annotation>
 </semantics>
</math>

, where 

<math display="inline" id="Shannon's_source_coding_theorem:64">
 <semantics>
  <mi>Œµ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>Œµ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Œµ
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Shannon's_source_coding_theorem:65">
 <semantics>
  <mi>Œ¥</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>Œ¥</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Œ¥
  </annotation>
 </semantics>
</math>

 can be made arbitrarily small, by making 

<math display="inline" id="Shannon's_source_coding_theorem:66">
 <semantics>
  <mi>n</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>n</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n
  </annotation>
 </semantics>
</math>

 larger.</p>
<h2 id="see-also">See also</h2>
<ul>
<li><a href="Channel_coding" title="wikilink">Channel coding</a></li>
<li><a href="noisy_channel_coding_theorem" title="wikilink">Noisy Channel Coding Theorem</a></li>
<li><a href="Error_exponent" title="wikilink">Error exponent</a></li>
<li><a href="Asymptotic_equipartition_property" title="wikilink">Asymptotic Equipartition Property</a> (AEP)</li>
</ul>
<h2 id="references">References</h2>

<p>"</p>

<p><a href="Category:Information_theory" title="wikilink">Category:Information theory</a> <a href="Category:Coding_theory" title="wikilink">Category:Coding theory</a> <a href="Category:Data_compression" title="wikilink">Category:Data compression</a> <a href="Category:Presentation_layer_protocols" title="wikilink">Category:Presentation layer protocols</a> <a href="Category:Mathematical_theorems_in_theoretical_computer_science" title="wikilink">Category:Mathematical theorems in theoretical computer science</a> <a href="Category:Articles_containing_proofs" title="wikilink">Category:Articles containing proofs</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1"></li>
<li id="fn2"></li>
<li id="fn3"></li>
</ol>
</section>
</body>
</html>

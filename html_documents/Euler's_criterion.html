<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="258">Euler's criterion</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Euler's criterion</h1>
<hr/>

<p>In <a href="number_theory" title="wikilink">number theory</a> <strong>Euler's criterion</strong> is a formula for determining whether an <a class="uri" href="integer" title="wikilink">integer</a> is a <a href="quadratic_residue" title="wikilink">quadratic residue</a> <a href="modular_arithmetic" title="wikilink">modulo</a> a <a href="prime_number" title="wikilink">prime</a>. Precisely,</p>

<p>Let <em>p</em> be an <a href="odd_number" title="wikilink">odd</a> prime and <em>a</em> an integer <a class="uri" href="coprime" title="wikilink">coprime</a> to <em>p</em>. Then<a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a></p>

<p>

<math display="block" id="Euler's_criterion:0">
 <semantics>
  <mrow>
   <msup>
    <mi>a</mi>
    <mstyle scriptlevel="-1">
     <mfrac>
      <mrow>
       <mi>p</mi>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
      <mn>2</mn>
     </mfrac>
    </mstyle>
   </msup>
   <mo>≡</mo>
   <mrow>
    <mo>{</mo>
    <mtable displaystyle="true">
     <mtr>
      <mtd columnalign="left">
       <mrow>
        <mn>1</mn>
        <mspace width="veryverythickmathspace">
        </mspace>
        <mrow>
         <mo lspace="8.1pt" stretchy="false">(</mo>
         <mrow>
          <mo>mod</mo>
          <mi>p</mi>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
      </mtd>
      <mtd columnalign="left">
       <mrow>
        <mrow>
         <mtext>if there is an integer</mtext>
         <mi>x</mi>
         <mtext>such that</mtext>
         <mi>a</mi>
        </mrow>
        <mo>≡</mo>
        <mrow>
         <msup>
          <mi>x</mi>
          <mn>2</mn>
         </msup>
         <mspace width="veryverythickmathspace">
         </mspace>
         <mrow>
          <mo lspace="8.1pt" stretchy="false">(</mo>
          <mrow>
           <mo>mod</mo>
           <mi>p</mi>
          </mrow>
          <mo stretchy="false">)</mo>
         </mrow>
        </mrow>
       </mrow>
      </mtd>
     </mtr>
     <mtr>
      <mtd columnalign="left">
       <mrow>
        <mrow>
         <mo>-</mo>
         <mn>1</mn>
        </mrow>
        <mspace width="veryverythickmathspace">
        </mspace>
        <mrow>
         <mo lspace="8.1pt" stretchy="false">(</mo>
         <mrow>
          <mo>mod</mo>
          <mi>p</mi>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
      </mtd>
      <mtd columnalign="left">
       <mtext>if there is no such integer.</mtext>
      </mtd>
     </mtr>
    </mtable>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <equivalent></equivalent>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>a</ci>
     <apply>
      <divide></divide>
      <apply>
       <minus></minus>
       <ci>p</ci>
       <cn type="integer">1</cn>
      </apply>
      <cn type="integer">2</cn>
     </apply>
    </apply>
    <apply>
     <csymbol cd="latexml">cases</csymbol>
     <apply>
      <csymbol cd="latexml">annotated</csymbol>
      <cn type="float">1</cn>
      <apply>
       <ci>pmod</ci>
       <ci>p</ci>
      </apply>
     </apply>
     <apply>
      <equivalent></equivalent>
      <apply>
       <times></times>
       <mtext>if there is an integer</mtext>
       <ci>x</ci>
       <mtext>such that</mtext>
       <ci>a</ci>
      </apply>
      <apply>
       <csymbol cd="latexml">annotated</csymbol>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>x</ci>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <ci>pmod</ci>
        <ci>p</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <csymbol cd="latexml">annotated</csymbol>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
      </apply>
      <apply>
       <ci>pmod</ci>
       <ci>p</ci>
      </apply>
     </apply>
     <mtext>if there is no such integer.</mtext>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a^{\tfrac{p-1}{2}}\equiv\begin{cases}\;\;\,1\;\;(\mathop{{\rm mod}}p)&\text{ %
if there is an integer }x\text{ such that }a\equiv x^{2}\;\;(\mathop{{\rm mod}%
}p)\\
-1\;\;(\mathop{{\rm mod}}p)&\text{ if there is no such integer.}\end{cases}
  </annotation>
 </semantics>
</math>

</p>

<p>Euler's criterion can be concisely reformulated using the <a href="Legendre_symbol" title="wikilink">Legendre symbol</a>:<a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a></p>

<p>

<math display="block" id="Euler's_criterion:1">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mo>(</mo>
     <mfrac>
      <mi>a</mi>
      <mi>p</mi>
     </mfrac>
     <mo>)</mo>
    </mrow>
    <mo>≡</mo>
    <mrow>
     <msup>
      <mi>a</mi>
      <mrow>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mi>p</mi>
         <mo>-</mo>
         <mn>1</mn>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
       <mo>/</mo>
       <mn>2</mn>
      </mrow>
     </msup>
     <mspace width="veryverythickmathspace">
     </mspace>
     <mrow>
      <mo lspace="8.1pt" stretchy="false">(</mo>
      <mrow>
       <mo>mod</mo>
       <mi>p</mi>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <equivalent></equivalent>
    <apply>
     <divide></divide>
     <ci>a</ci>
     <ci>p</ci>
    </apply>
    <apply>
     <csymbol cd="latexml">annotated</csymbol>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>a</ci>
      <apply>
       <divide></divide>
       <apply>
        <minus></minus>
        <ci>p</ci>
        <cn type="integer">1</cn>
       </apply>
       <cn type="integer">2</cn>
      </apply>
     </apply>
     <apply>
      <ci>pmod</ci>
      <ci>p</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \left(\frac{a}{p}\right)\equiv a^{(p-1)/2}\;\;(\mathop{{\rm mod}}p).
  </annotation>
 </semantics>
</math>

</p>

<p>The criterion first appeared in a 1748 paper by <a href="Leonhard_Euler" title="wikilink">Euler</a>.<a class="footnoteRef" href="#fn3" id="fnref3"><sup>3</sup></a></p>
<h2 id="proof">Proof</h2>

<p>The proof uses fact that the residue classes modulo a prime number are a <a href="finite_field" title="wikilink">field</a>. See the article <a href="Characteristic_(algebra)#Case_of_fields" title="wikilink">prime field</a> for more details. The fact that there are (<em>p</em> − 1)/2 quadratic residues and the same number of nonresidues (mod <em>p</em>) is proved in the article <a href="quadratic_residue" title="wikilink">quadratic residue</a>.</p>

<p><a href="Fermat's_little_theorem" title="wikilink">Fermat's little theorem</a> says that</p>

<p>

<math display="block" id="Euler's_criterion:2">
 <semantics>
  <mrow>
   <msup>
    <mi>a</mi>
    <mrow>
     <mi>p</mi>
     <mo>-</mo>
     <mn>1</mn>
    </mrow>
   </msup>
   <mo>≡</mo>
   <mrow>
    <mn>1</mn>
    <mspace width="veryverythickmathspace">
    </mspace>
    <mrow>
     <mo lspace="8.1pt" stretchy="false">(</mo>
     <mrow>
      <mo>mod</mo>
      <mi>p</mi>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <equivalent></equivalent>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>a</ci>
     <apply>
      <minus></minus>
      <ci>p</ci>
      <cn type="integer">1</cn>
     </apply>
    </apply>
    <apply>
     <csymbol cd="latexml">annotated</csymbol>
     <cn type="integer">1</cn>
     <apply>
      <ci>pmod</ci>
      <ci>p</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a^{p-1}\equiv 1\;\;(\mathop{{\rm mod}}p)
  </annotation>
 </semantics>
</math>

 (Assume throughout this solution that a is not 0 mod p). This can be written as</p>

<p>

<math display="block" id="Euler's_criterion:3">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <msup>
        <mi>a</mi>
        <mstyle scriptlevel="-1">
         <mfrac>
          <mrow>
           <mi>p</mi>
           <mo>-</mo>
           <mn>1</mn>
          </mrow>
          <mn>2</mn>
         </mfrac>
        </mstyle>
       </msup>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <msup>
        <mi>a</mi>
        <mstyle scriptlevel="-1">
         <mfrac>
          <mrow>
           <mi>p</mi>
           <mo>-</mo>
           <mn>1</mn>
          </mrow>
          <mn>2</mn>
         </mfrac>
        </mstyle>
       </msup>
       <mo>+</mo>
       <mn>1</mn>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>≡</mo>
    <mrow>
     <mn>0</mn>
     <mspace width="veryverythickmathspace">
     </mspace>
     <mrow>
      <mo lspace="8.1pt" stretchy="false">(</mo>
      <mrow>
       <mo>mod</mo>
       <mi>p</mi>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <equivalent></equivalent>
    <apply>
     <times></times>
     <apply>
      <minus></minus>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>a</ci>
       <apply>
        <divide></divide>
        <apply>
         <minus></minus>
         <ci>p</ci>
         <cn type="integer">1</cn>
        </apply>
        <cn type="integer">2</cn>
       </apply>
      </apply>
      <cn type="integer">1</cn>
     </apply>
     <apply>
      <plus></plus>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>a</ci>
       <apply>
        <divide></divide>
        <apply>
         <minus></minus>
         <ci>p</ci>
         <cn type="integer">1</cn>
        </apply>
        <cn type="integer">2</cn>
       </apply>
      </apply>
      <cn type="integer">1</cn>
     </apply>
    </apply>
    <apply>
     <csymbol cd="latexml">annotated</csymbol>
     <cn type="integer">0</cn>
     <apply>
      <ci>pmod</ci>
      <ci>p</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (a^{\tfrac{p-1}{2}}-1)(a^{\tfrac{p-1}{2}}+1)\equiv 0\;\;(\mathop{{\rm mod}}p).
  </annotation>
 </semantics>
</math>

 Since the integers mod <em>p</em> form a field, one or the other of these factors must be congruent to zero.</p>

<p>Now if <em>a</em> is a quadratic residue, <em>a</em> ≡ <em>x</em><sup>2</sup>,</p>

<p>

<math display="block" id="Euler's_criterion:4">
 <semantics>
  <mrow>
   <mrow>
    <msup>
     <mi>a</mi>
     <mstyle scriptlevel="-1">
      <mfrac>
       <mrow>
        <mi>p</mi>
        <mo>-</mo>
        <mn>1</mn>
       </mrow>
       <mn>2</mn>
      </mfrac>
     </mstyle>
    </msup>
    <mo>≡</mo>
    <mmultiscripts>
     <mi>x</mi>
     <none></none>
     <mn>2</mn>
     <none></none>
     <mstyle scriptlevel="-1">
      <mfrac>
       <mrow>
        <mi>p</mi>
        <mo>-</mo>
        <mn>1</mn>
       </mrow>
       <mn>2</mn>
      </mfrac>
     </mstyle>
    </mmultiscripts>
    <mo>≡</mo>
    <msup>
     <mi>x</mi>
     <mrow>
      <mi>p</mi>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </msup>
    <mo>≡</mo>
    <mrow>
     <mn>1</mn>
     <mspace width="veryverythickmathspace">
     </mspace>
     <mrow>
      <mo lspace="8.1pt" stretchy="false">(</mo>
      <mrow>
       <mo>mod</mo>
       <mi>p</mi>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <equivalent></equivalent>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>a</ci>
      <apply>
       <divide></divide>
       <apply>
        <minus></minus>
        <ci>p</ci>
        <cn type="integer">1</cn>
       </apply>
       <cn type="integer">2</cn>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>x</ci>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <divide></divide>
       <apply>
        <minus></minus>
        <ci>p</ci>
        <cn type="integer">1</cn>
       </apply>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
    <apply>
     <equivalent></equivalent>
     <share href="#.cmml">
     </share>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>x</ci>
      <apply>
       <minus></minus>
       <ci>p</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
    </apply>
    <apply>
     <equivalent></equivalent>
     <share href="#.cmml">
     </share>
     <apply>
      <csymbol cd="latexml">annotated</csymbol>
      <cn type="integer">1</cn>
      <apply>
       <ci>pmod</ci>
       <ci>p</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a^{\tfrac{p-1}{2}}\equiv{x^{2}}^{\tfrac{p-1}{2}}\equiv x^{p-1}\equiv 1\;\;(%
\mathop{{\rm mod}}p).
  </annotation>
 </semantics>
</math>

 So every quadratic residue (mod <em>p</em>) makes the first factor zero.</p>

<p><a href="Lagrange's_theorem_(number_theory)" title="wikilink">Lagrange's theorem</a> says that there can be no more than (<em>p</em> − 1)/2 values of <em>a</em> that make the first factor zero. But it is known that there are (<em>p</em> − 1)/2 distinct quadratic residues (mod <em>p</em>) (besides 0). Therefore they are precisely the residue classes that make the first factor zero. The other (<em>p</em> − 1)/2 residue classes, the nonresidues, must be the ones making the second factor zero. This is Euler's criterion.</p>
<h2 id="examples">Examples</h2>

<p><strong>Example 1: Finding primes for which <em>a</em> is a residue</strong></p>

<p>Let <em>a</em> = 17. For which primes <em>p</em> is 17 a quadratic residue?</p>

<p>We can test prime <em>p</em>'s manually given the formula above.</p>

<p>In one case, testing <em>p</em> = 3, we have 17<sup>(3 − 1)/2</sup> = 17<sup>1</sup> ≡ 2 ≡ −1 (mod 3), therefore 17 is not a quadratic residue modulo 3.</p>

<p>In another case, testing <em>p</em> = 13, we have 17<sup>(13 − 1)/2</sup> = 17<sup>6</sup> ≡ 1 (mod 13), therefore 17 is a quadratic residue modulo 13. As confirmation, note that 17 ≡ 4 (mod 13), and 2<sup>2</sup> = 4.</p>

<p>We can do these calculations faster by using various modular arithmetic and Legendre symbol properties.</p>

<p>If we keep calculating the values, we find:</p>
<dl>
<dd>(17/<em>p</em>) = +1 for <em>p</em> = {13, 19, ...} (17 is a quadratic residue modulo these values)
</dd>
</dl>
<dl>
<dd>(17/<em>p</em>) = −1 for <em>p</em> = {3, 5, 7, 11, 23, ...} (17 is not a quadratic residue modulo these values).
</dd>
</dl>

<p>'''Example 2: Finding residues given a prime modulus <em>p</em> '''</p>

<p>Which numbers are squares modulo 17 (quadratic residues modulo 17)?</p>

<p>We can manually calculate it as:</p>
<dl>
<dd>1<sup>2</sup> = 1
</dd>
<dd>2<sup>2</sup> = 4
</dd>
<dd>3<sup>2</sup> = 9
</dd>
<dd>4<sup>2</sup> = 16
</dd>
<dd>5<sup>2</sup> = 25 ≡ 8 (mod 17)
</dd>
<dd>6<sup>2</sup> = 36 ≡ 2 (mod 17)
</dd>
<dd>7<sup>2</sup> = 49 ≡ 15 (mod 17)
</dd>
<dd>8<sup>2</sup> = 64 ≡ 13 (mod 17).
</dd>
</dl>

<p>So the set of the quadratic residues modulo 17 is {1,2,4,8,9,13,15,16}. Note that we did not need to calculate squares for the values 9 through 16, as they are all negatives of the previously squared values (e.g. 9 ≡ −8 (mod 17), so 9<sup>2</sup> ≡ (−8)<sup>2</sup> = 64 ≡ 13 (mod 17)).</p>

<p>We can find quadratic residues or verify them using the above formula. To test if 2 is a quadratic residue modulo 17, we calculate 2<sup>(17 − 1)/2</sup> = 2<sup>8</sup> ≡ 1 (mod 17), so it is a quadratic residue. To test if 3 is a quadratic residue modulo 17, we calculate 3<sup>(17 − 1)/2</sup> = 3<sup>8</sup> ≡ 16 ≡ −1 (mod 17), so it is not a quadratic residue.</p>

<p>Euler's criterion is related to the <a href="Quadratic_reciprocity" title="wikilink">Law of quadratic reciprocity</a> and is used in a definition of <a href="Euler–Jacobi_pseudoprime" title="wikilink">Euler–Jacobi pseudoprimes</a>.</p>
<h2 id="notes">Notes</h2>
<h2 id="references">References</h2>

<p>The <em><a href="Disquisitiones_Arithmeticae" title="wikilink">Disquisitiones Arithmeticae</a></em> has been translated from Gauss's Ciceronian Latin into English and German. The German edition includes all of his papers on number theory: all the proofs of quadratic reciprocity, the determination of the sign of the Gauss sum, the investigations into biquadratic reciprocity, and unpublished notes.</p>
<ul>
<li></li>
</ul>
<ul>
<li></li>
</ul>
<ul>
<li></li>
</ul>
<ul>
<li></li>
</ul>
<h2 id="external-links">External links</h2>
<ul>
<li><a href="http://www.math.dartmouth.edu/~euler/index.html">The Euler Archive</a></li>
</ul>

<p>"</p>

<p><a href="Category:Modular_arithmetic" title="wikilink">Category:Modular arithmetic</a> <a href="Category:Articles_containing_proofs" title="wikilink">Category:Articles containing proofs</a> <a href="Category:Quadratic_residue" title="wikilink">Category:Quadratic residue</a> <a href="Category:Theorems_about_prime_numbers" title="wikilink">Category:Theorems about prime numbers</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1">Gauss, DA, Art. 106<a href="#fnref1">↩</a></li>
<li id="fn2">Hardy &amp; Wright, thm. 83<a href="#fnref2">↩</a></li>
<li id="fn3">Lemmermeyer, p. 4 cites two papers, E134 and E262 in the Euler Archive<a href="#fnref3">↩</a></li>
</ol>
</section>
</body>
</html>

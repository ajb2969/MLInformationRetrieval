<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="1777">Recurrence period density entropy</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Recurrence period density entropy</h1>
<hr/>

<p><strong>Recurrence period density entropy (RPDE)</strong> is a method, in the fields of <a href="dynamical_systems" title="wikilink">dynamical systems</a>, <a href="stochastic_processes" title="wikilink">stochastic processes</a>, and <a href="time_series_analysis" title="wikilink">time series analysis</a>, for determining the periodicity, or <strong>repetitiveness</strong> of a signal.</p>
<h2 id="overview">Overview</h2>

<p>Recurrence period density entropy is useful for characterising the extent to which a time series repeats the same sequence, and is therefore similar to linear <a class="uri" href="autocorrelation" title="wikilink">autocorrelation</a> and time delayed mutual information, except that it measures repetitiveness in the <a href="phase_space" title="wikilink">phase space</a> of the system, and is thus a more reliable measure based upon the dynamics of the underlying system that generated the signal. It has the advantage that it does not require the assumptions of <a href="linear_systems" title="wikilink">linearity</a>, <a href="Normal_distribution" title="wikilink">Gaussianity</a> or dynamical determinism. It has been successfully used to detect abnormalities in biomedical contexts such as <a href="Speech_communication" title="wikilink">speech</a> signal.<a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a><a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a></p>

<p>The RPDE value 

<math display="inline" id="Recurrence_period_density_entropy:0">
 <semantics>
  <msub>
   <mi>H</mi>
   <mi>norm</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>H</ci>
    <ci>norm</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \scriptstyle H_{\mathrm{norm}}
  </annotation>
 </semantics>
</math>

 is a scalar in the range zero to one. For purely periodic signals, 

<math display="inline" id="Recurrence_period_density_entropy:1">
 <semantics>
  <mrow>
   <msub>
    <mi>H</mi>
    <mi>norm</mi>
   </msub>
   <mo>=</mo>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>H</ci>
     <ci>norm</ci>
    </apply>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \scriptstyle H_{\mathrm{norm}}=0
  </annotation>
 </semantics>
</math>

, whereas for purely <a class="uri" href="i.i.d." title="wikilink">i.i.d.</a>, uniform <a href="white_noise" title="wikilink">white noise</a>, 

<math display="inline" id="Recurrence_period_density_entropy:2">
 <semantics>
  <mrow>
   <msub>
    <mi>H</mi>
    <mi>norm</mi>
   </msub>
   <mo>‚âà</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <approx></approx>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>H</ci>
     <ci>norm</ci>
    </apply>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \scriptstyle H_{\mathrm{norm}}\approx 1
  </annotation>
 </semantics>
</math>

.<a class="footnoteRef" href="#fn3" id="fnref3"><sup>3</sup></a></p>
<figure><b>(Figure)</b>
<figcaption>How RPDE ranks signals by their phase space periodicity. The small panels are depictions of the time series, and the large scale in the middle is the RPDE value. It can be seen that purely periodic signals, regardless of harmonic content in a spectral sense, have an RPDE value of zero. Randomly forced periodic oscillation has a higher value, followed by chaotic systems, randomly forced linear resonators, autocorrelated random processes, and at the extreme, uniform random noise has an RPDE value of nearly one.</figcaption>
</figure>
<h2 id="method-description">Method description</h2>

<p>The RPDE method first requires the <a class="uri" href="embedding" title="wikilink">embedding</a> of a time series in <a href="phase_space" title="wikilink">phase space</a>, which, according to stochastic extensions to Taken's embedding theorems, can be carried out by forming time-delayed vectors:</p>

<p>

<math display="block" id="Recurrence_period_density_entropy:3">
 <semantics>
  <mrow>
   <msub>
    <mi>ùêó</mi>
    <mi>n</mi>
   </msub>
   <mo>=</mo>
   <mrow>
    <mo stretchy="false">[</mo>
    <msub>
     <mi>x</mi>
     <mi>n</mi>
    </msub>
    <mo>,</mo>
    <msub>
     <mi>x</mi>
     <mrow>
      <mi>n</mi>
      <mo>+</mo>
      <mi>œÑ</mi>
     </mrow>
    </msub>
    <mo>,</mo>
    <msub>
     <mi>x</mi>
     <mrow>
      <mi>n</mi>
      <mo>+</mo>
      <mrow>
       <mn>2</mn>
       <mi>œÑ</mi>
      </mrow>
     </mrow>
    </msub>
    <mo>,</mo>
    <mi mathvariant="normal">‚Ä¶</mi>
    <mo>,</mo>
    <msub>
     <mi>x</mi>
     <mrow>
      <mi>n</mi>
      <mo>+</mo>
      <mrow>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mi>M</mi>
         <mo>-</mo>
         <mn>1</mn>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
       <mi>œÑ</mi>
      </mrow>
     </mrow>
    </msub>
    <mo stretchy="false">]</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>ùêó</ci>
     <ci>n</ci>
    </apply>
    <list>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <ci>n</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <apply>
       <plus></plus>
       <ci>n</ci>
       <ci>œÑ</ci>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <apply>
       <plus></plus>
       <ci>n</ci>
       <apply>
        <times></times>
        <cn type="integer">2</cn>
        <ci>œÑ</ci>
       </apply>
      </apply>
     </apply>
     <ci>normal-‚Ä¶</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <apply>
       <plus></plus>
       <ci>n</ci>
       <apply>
        <times></times>
        <apply>
         <minus></minus>
         <ci>M</ci>
         <cn type="integer">1</cn>
        </apply>
        <ci>œÑ</ci>
       </apply>
      </apply>
     </apply>
    </list>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{X}_{n}=[x_{n},x_{n+\tau},x_{n+2\tau},\ldots,x_{n+(M-1)\tau}]
  </annotation>
 </semantics>
</math>

</p>

<p>for each value <em>x</em><sub><em>n</em></sub> in the time series, where <em>M</em> is the embedding dimension, and œÑ is the embedding delay. These parameters are obtained by systematic search for the optimal set (due to lack of practical embedding parameter techniques for stochastic systems) (Stark et al. 2003). Next, around each point 

<math display="inline" id="Recurrence_period_density_entropy:4">
 <semantics>
  <msub>
   <mi>ùêó</mi>
   <mi>n</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>ùêó</ci>
    <ci>n</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \scriptstyle\mathbf{X}_{n}
  </annotation>
 </semantics>
</math>

 in the phase space, an 

<math display="inline" id="Recurrence_period_density_entropy:5">
 <semantics>
  <mi>Œµ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>Œµ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \varepsilon
  </annotation>
 </semantics>
</math>

-neighbourhood (an <em>m</em>-dimensional ball with this radius) is formed, and every time the time series returns to this ball, after having left it, the time difference <em>T</em> between successive returns is recorded in a <a class="uri" href="histogram" title="wikilink">histogram</a>. This histogram is normalised to sum to unity, to form an estimate of the <strong>recurrence period density</strong> function <em>P</em>(<em>T</em>). The normalised <a class="uri" href="entropy" title="wikilink">entropy</a> of this density:</p>

<p>

<math display="block" id="Recurrence_period_density_entropy:6">
 <semantics>
  <mrow>
   <msub>
    <mi>H</mi>
    <mi>norm</mi>
   </msub>
   <mo>=</mo>
   <mrow>
    <mo>-</mo>
    <mrow>
     <msup>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mi>ln</mi>
        <msub>
         <mi>T</mi>
         <mi>max</mi>
        </msub>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
      <mrow>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
     </msup>
     <mrow>
      <munderover>
       <mo largeop="true" movablelimits="false" symmetric="true">‚àë</mo>
       <mrow>
        <mi>t</mi>
        <mo>=</mo>
        <mn>1</mn>
       </mrow>
       <msub>
        <mi>T</mi>
        <mi>max</mi>
       </msub>
      </munderover>
      <mrow>
       <mi>P</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>t</mi>
        <mo stretchy="false">)</mo>
       </mrow>
       <mrow>
        <mi>ln</mi>
        <mi>P</mi>
       </mrow>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>t</mi>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>H</ci>
     <ci>norm</ci>
    </apply>
    <apply>
     <minus></minus>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <ln></ln>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>T</ci>
         <max></max>
        </apply>
       </apply>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <sum></sum>
         <apply>
          <eq></eq>
          <ci>t</ci>
          <cn type="integer">1</cn>
         </apply>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>T</ci>
         <max></max>
        </apply>
       </apply>
       <apply>
        <times></times>
        <ci>P</ci>
        <ci>t</ci>
        <apply>
         <ln></ln>
         <ci>P</ci>
        </apply>
        <ci>t</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   H_{\mathrm{norm}}=-(\ln{T_{\max})}^{-1}\sum_{t=1}^{T_{\max}}P(t)\ln{P(t)}
  </annotation>
 </semantics>
</math>

</p>

<p>is the RPDE value, where 

<math display="inline" id="Recurrence_period_density_entropy:7">
 <semantics>
  <msub>
   <mi>T</mi>
   <mi>max</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>T</ci>
    <max></max>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \scriptstyle T_{\max}
  </annotation>
 </semantics>
</math>

 is the largest recurrence value (typically on the order of 1000 samples).<a class="footnoteRef" href="#fn4" id="fnref4"><sup>4</sup></a> Note that RPDE is intended to be applied to both deterministic and stochastic signals, therefore, strictly speaking, Taken's original embedding theorem does not apply, and needs some modification.<a class="footnoteRef" href="#fn5" id="fnref5"><sup>5</sup></a></p>
<figure><b>(Figure)</b>
<figcaption>Pictorial description of the calculations required to find the RPDE value. First, the time series is time delay embedded into a reconstructed phase space. Then, around each point in the embedded phase space, a recurrence neighbourhood of radius 

<math display="inline" id="Recurrence_period_density_entropy:8">
 <semantics>
  <mi>Œµ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>Œµ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \scriptstyle\varepsilon
  </annotation>
 </semantics>
</math>


 is created. All recurrences into this neighbourhood are tracked, and the time interval <em>T</em> between recurrences is recorded in a histogram. This histogram is normalised to create an estimate of the recurrence period density function <em>P</em>(<em>T</em>). The normalised <a class="uri" href="entropy" title="wikilink">entropy</a> of this density is the RPDE value 

<math display="inline" id="Recurrence_period_density_entropy:9">
 <semantics>
  <msub>
   <mi>H</mi>
   <mi>norm</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>H</ci>
    <ci>norm</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \scriptstyle H_{\mathrm{norm}}
  </annotation>
 </semantics>
</math>

.</figcaption>
</figure>
<h2 id="rpde-in-practice">RPDE in practice</h2>

<p>RPDE has the ability to detect subtle changes in natural biological time series such as the breakdown of regular periodic oscillation in abnormal cardiac function which are hard to detect using classical signal processing tools such as the <a href="Fourier_transform" title="wikilink">Fourier transform</a> or <a href="linear_prediction" title="wikilink">linear prediction</a>. The recurrence period density is a <strong>sparse representation</strong> for nonlinear, non-Gaussian and nondeterministic signals, whereas the <a href="Fourier_transform" title="wikilink">Fourier transform</a> is only sparse for purely periodic signals.</p>
<figure><b>(Figure)</b>
<figcaption>RPDE values 

<math display="inline" id="Recurrence_period_density_entropy:10">
 <semantics>
  <msub>
   <mi>H</mi>
   <mrow>
    <mi>n</mi>
    <mi>o</mi>
    <mi>r</mi>
    <mi>m</mi>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>H</ci>
    <apply>
     <times></times>
     <ci>n</ci>
     <ci>o</ci>
     <ci>r</ci>
     <ci>m</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   H_{norm}
  </annotation>
 </semantics>
</math>

 for normal sinus rhythm ECG, and for ECG from a patient with sleep apnoea. The time series (plots with blue traces) and spectra (plots with black traces) are relatively difficult to distinguish, nonetheless, the RPDE values are sufficiently different that detection of the abnormality is straightforward.</figcaption>
</figure>
<h2 id="see-also">See also</h2>
<ul>
<li><a href="Recurrence_plot" title="wikilink">Recurrence plot</a>, a powerful visualisation tool of recurrences in dynamical (and other) systems.<a class="footnoteRef" href="#fn6" id="fnref6"><sup>6</sup></a></li>
<li><a href="Recurrence_quantification_analysis" title="wikilink">Recurrence quantification analysis</a>, another approach to quantify recurrence properties.</li>
</ul>
<h2 id="references">References</h2>
<h2 id="external-links">External links</h2>
<ul>
<li><a href="http://www.maxlittle.net/software/">Fast MATLAB code for calculating the RPDE value.</a></li>
<li><a class="uri" href="http://www.recurrence-plot.tk/">http://www.recurrence-plot.tk/</a></li>
</ul>

<p>"</p>

<p><a href="Category:Signal_processing" title="wikilink">Category:Signal processing</a> <a class="uri" href="Category:Entropy" title="wikilink">Category:Entropy</a> <a href="Category:Stochastic_processes" title="wikilink">Category:Stochastic processes</a> <a href="Category:Dynamical_systems" title="wikilink">Category:Dynamical systems</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1">M. Little, P. McSharry, I. Moroz, S. Roberts (2006) <a href="http://www.maxlittle.net/publications/dfafullpath.pdf">Nonlinear, Biophysically-Informed Speech Pathology Detection</a> in 2006 IEEE International Conference on Acoustics, Speech and Signal Processing, 2006. ICASSP 2006 Proceedings.: Toulouse, France. pp. II-1080-II-1083.<a href="#fnref1">‚Ü©</a></li>
<li id="fn2">M.A. Little, P.E. McSharry, S.J. Roberts, D.A.E. Costello, I.M. Moroz (2007) <a href="http://www.maxlittle.net/publications/bmeo.pdf">Exploiting Nonlinear Recurrence and Fractal Scaling Properties for Voice Disorder Detection</a>, BioMedical Engineering OnLine, <strong>6</strong>:23<a href="#fnref2">‚Ü©</a></li>
<li id="fn3"></li>
<li id="fn4"></li>
<li id="fn5">J. Stark, D. S. Broomhead, M. E. Davies and J. Huke (2003) Delay Embeddings for Forced Systems. II. Stochastic Forcing. Journal of Nonlinear Science, <strong>13</strong>(6):519-577<a href="#fnref5">‚Ü©</a></li>
<li id="fn6"><a href="#fnref6">‚Ü©</a></li>
</ol>
</section>
</body>
</html>

<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="592">Chromatic adaptation</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Chromatic adaptation</h1>
<hr/>

<p><strong>Chromatic adaptation</strong> is one aspect of <a href="Human_visual_system" title="wikilink">vision</a> that may fool someone into observing a color-based <a href="optical_illusion" title="wikilink">optical illusion</a>, such as the <a href="same_color_illusion" title="wikilink">same color illusion</a>.</p>

<p>An object may be viewed under various conditions. For example, it may be illuminated by sunlight, the light of a fire, or a harsh electric light. In all of these situations, human vision perceives that the object has the same color: an apple always appears red, whether viewed at night or during the day. On the other hand, a camera with no adjustment for light may register the apple as having varying color. This feature of the visual system is called chromatic adaptation, or <a href="color_constancy" title="wikilink">color constancy</a>; when the correction occurs in a camera it is referred to as <a href="white_balance" title="wikilink">white balance</a>.</p>

<p>Though the human visual system generally does maintain constant perceived color under different lighting, there are situations where the relative brightness of two different stimuli will appear reversed at different <a class="uri" href="illuminance" title="wikilink">illuminance</a> levels. For example, the bright yellow petals of flowers will appear dark compared to the green leaves in dim light while the opposite is true during the day. This is known as the <a href="Purkinje_effect" title="wikilink">Purkinje effect</a>, and arises because the peak sensitivity of the human eye shifts toward the blue end of the spectrum at lower light levels.</p>
<h2 id="von-kries-transform">von Kries transform</h2>

<p>The von Kries chromatic adaptation method is a technique that is sometimes used in camera image processing. The method is to apply a gain to each of the human <a href="cone_cell" title="wikilink">cone cell</a> spectral sensitivity responses so as to keep the adapted appearance of the reference white constant. The application of <a href="Johannes_von_Kries" title="wikilink">Johannes von Kries</a>'s idea of adaptive gains on the three <a href="cone_cell" title="wikilink">cone cell</a> types was first explicitly applied to the problem of color constancy by <a href="Herbert_E._Ives" title="wikilink">Herbert E. Ives</a>,<a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a><a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a> and the method is sometimes referred to as the Ives transform<a class="footnoteRef" href="#fn3" id="fnref3"><sup>3</sup></a> or the von Kries–Ives adaptation.<a class="footnoteRef" href="#fn4" id="fnref4"><sup>4</sup></a></p>

<p>The <a href="von_Kries_Coefficient_Law" title="wikilink">von Kries</a> <em>coefficient rule</em> rests on the assumption that <a href="color_constancy" title="wikilink">color constancy</a> is achieved by individually adapting the gains of the three cone responses, the gains depending on the sensory context, that is, the color history and surround. Thus, the cone responses 

<math display="inline" id="Chromatic_adaptation:0">
 <semantics>
  <msup>
   <mi>c</mi>
   <mo>′</mo>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>c</ci>
    <ci>normal-′</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   c^{\prime}
  </annotation>
 </semantics>
</math>

 from two radiant spectra can be matched by appropriate choice of diagonal adaptation matrices <em>D</em><sub>1</sub> and <em>D</em><sub>2</sub>:<a class="footnoteRef" href="#fn5" id="fnref5"><sup>5</sup></a></p>

<p>

<math display="block" id="Chromatic_adaptation:1">
 <semantics>
  <mrow>
   <msup>
    <mi>c</mi>
    <mo>′</mo>
   </msup>
   <mo>=</mo>
   <mrow>
    <mpadded width="+1.7pt">
     <msub>
      <mi>D</mi>
      <mn>1</mn>
     </msub>
    </mpadded>
    <mpadded width="+1.7pt">
     <msup>
      <mi>S</mi>
      <mi>T</mi>
     </msup>
    </mpadded>
    <msub>
     <mi>f</mi>
     <mn>1</mn>
    </msub>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mpadded width="+1.7pt">
     <msub>
      <mi>D</mi>
      <mn>2</mn>
     </msub>
    </mpadded>
    <mpadded width="+1.7pt">
     <msup>
      <mi>S</mi>
      <mi>T</mi>
     </msup>
    </mpadded>
    <msub>
     <mi>f</mi>
     <mn>2</mn>
    </msub>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>c</ci>
      <ci>normal-′</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>D</ci>
       <cn type="integer">1</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>S</ci>
       <ci>T</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>f</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>D</ci>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>S</ci>
       <ci>T</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>f</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   c^{\prime}=D_{1}\,S^{T}\,f_{1}=D_{2}\,S^{T}\,f_{2}
  </annotation>
 </semantics>
</math>

</p>

<p>where 

<math display="inline" id="Chromatic_adaptation:2">
 <semantics>
  <mi>S</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>S</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   S
  </annotation>
 </semantics>
</math>

 is the <em>cone sensitivity matrix</em> and 

<math display="inline" id="Chromatic_adaptation:3">
 <semantics>
  <mi>f</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>f</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f
  </annotation>
 </semantics>
</math>

 is the spectrum of the conditioning stimulus. This leads to the <em>von Kries transform</em> for chromatic adaptation in <a href="LMS_color_space" title="wikilink">LMS color space</a> (responses of long-, medium-, and short-wavelength cone response space):</p>

<p>

<math display="block" id="Chromatic_adaptation:4">
 <semantics>
  <mrow>
   <mi>D</mi>
   <mo>=</mo>
   <mrow>
    <msubsup>
     <mi>D</mi>
     <mn>1</mn>
     <mrow>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </msubsup>
    <msub>
     <mi>D</mi>
     <mn>2</mn>
    </msub>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mo>[</mo>
    <mtable displaystyle="true">
     <mtr>
      <mtd columnalign="center">
       <mrow>
        <msub>
         <mi>L</mi>
         <mn>2</mn>
        </msub>
        <mo>/</mo>
        <msub>
         <mi>L</mi>
         <mn>1</mn>
        </msub>
       </mrow>
      </mtd>
      <mtd columnalign="center">
       <mn>0</mn>
      </mtd>
      <mtd columnalign="center">
       <mn>0</mn>
      </mtd>
     </mtr>
     <mtr>
      <mtd columnalign="center">
       <mn>0</mn>
      </mtd>
      <mtd columnalign="center">
       <mrow>
        <msub>
         <mi>M</mi>
         <mn>2</mn>
        </msub>
        <mo>/</mo>
        <msub>
         <mi>M</mi>
         <mn>1</mn>
        </msub>
       </mrow>
      </mtd>
      <mtd columnalign="center">
       <mn>0</mn>
      </mtd>
     </mtr>
     <mtr>
      <mtd columnalign="center">
       <mn>0</mn>
      </mtd>
      <mtd columnalign="center">
       <mn>0</mn>
      </mtd>
      <mtd columnalign="center">
       <mrow>
        <msub>
         <mi>S</mi>
         <mn>2</mn>
        </msub>
        <mo>/</mo>
        <msub>
         <mi>S</mi>
         <mn>1</mn>
        </msub>
       </mrow>
      </mtd>
     </mtr>
    </mtable>
    <mo>]</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <ci>D</ci>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>D</ci>
        <cn type="integer">1</cn>
       </apply>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>D</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <matrix>
      <matrixrow>
       <apply>
        <divide></divide>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>L</ci>
         <cn type="integer">2</cn>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>L</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <cn type="integer">0</cn>
       <cn type="integer">0</cn>
      </matrixrow>
      <matrixrow>
       <cn type="integer">0</cn>
       <apply>
        <divide></divide>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>M</ci>
         <cn type="integer">2</cn>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>M</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <cn type="integer">0</cn>
      </matrixrow>
      <matrixrow>
       <cn type="integer">0</cn>
       <cn type="integer">0</cn>
       <apply>
        <divide></divide>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>S</ci>
         <cn type="integer">2</cn>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>S</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
      </matrixrow>
     </matrix>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   D=D_{1}^{-1}D_{2}=\begin{bmatrix}L_{2}/L_{1}&0&0\\
0&M_{2}/M_{1}&0\\
0&0&S_{2}/S_{1}\end{bmatrix}
  </annotation>
 </semantics>
</math>

</p>

<p>This diagonal matrix <em>D</em> maps cone responses, or colors, in one adaptation state to corresponding colors in another; when the adaptation state is presumed to be determined by the illuminant, this matrix is useful as an illuminant adaptation transform. The elements of the diagonal matrix <em>D</em> are the ratios of the cone responses (Long, Medium, Short) for the illuminant's <a href="white_point" title="wikilink">white point</a>.</p>

<p>The more complete von Kries transform, for colors represented in <a href="CIE_1931_color_space" title="wikilink">XYZ</a> or <a href="RGB_color_space" title="wikilink">RGB color space</a>, includes matrix transformations into and out of <a href="LMS_Color_Space" title="wikilink">LMS space</a>, with the diagonal transform <em>D</em> in the middle.<a class="footnoteRef" href="#fn6" id="fnref6"><sup>6</sup></a></p>
<h2 id="references">References</h2>
<references>
</references>
<h2 id="further-reading">Further reading</h2>
<ul>
<li></li>
</ul>
<h2 id="external-links">External links</h2>
<ul>
<li><a href="http://www.stareclips.com/">Working examples of Chromatic Adaptation.</a></li>
</ul>

<p>"</p>

<p><a href="Category:Color_appearance_phenomena" title="wikilink">Category:Color appearance phenomena</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1"> (Reprinted in: )<a href="#fnref1">↩</a></li>
<li id="fn2"><a href="#fnref2">↩</a></li>
<li id="fn3"><a href="#fnref3">↩</a></li>
<li id="fn4"><a href="#fnref4">↩</a></li>
<li id="fn5"><a href="#fnref5">↩</a></li>
<li id="fn6"><a href="#fnref6">↩</a></li>
</ol>
</section>
</body>
</html>

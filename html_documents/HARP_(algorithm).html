<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="339">HARP (algorithm)</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>HARP (algorithm)</h1>
<hr/>

<p>Harmonic phase (HARP) algorithm<a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a> is a medical image analysis technique capable of extracting and processing motion information from tagged magnetic resonance image (MRI) sequences. It was initially developed by N. F. Osman and J. L. Prince at the Image Analysis and Communications Laboratory at <a href="Johns_Hopkins_University" title="wikilink">Johns Hopkins University</a>. The method uses spectral peaks in the Fourier domain of tagged MRI, calculating the phase images of their inverse Fourier transforms, which are called harmonic phase (HARP) images. The motion of material points through time is then tracked, under the assumption that the HARP value of a fixed material point is time-invariant. The method is fast and accurate, and has been accepted as one of the most popular tagged MRI analysis methods in medical image processing.</p>
<h2 id="background">Background</h2>

<p>In cardiac magnetic resonance imaging, tagging techniques<a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a><a class="footnoteRef" href="#fn3" id="fnref3"><sup>3</sup></a><a class="footnoteRef" href="#fn4" id="fnref4"><sup>4</sup></a><a class="footnoteRef" href="#fn5" id="fnref5"><sup>5</sup></a> make it possible to capture and store the motion information of myocardium in vivo. MR tagging uses a special pulse sequence to create temporary features ‚Äì tags in the myocardium. Tags deform together with the myocardium as the heart beats and are captured by MR imaging. Analysis of the motion of the tag features in many images taken from different orientations and at different times can be used to track material points in the myocardium.<a class="footnoteRef" href="#fn6" id="fnref6"><sup>6</sup></a><a class="footnoteRef" href="#fn7" id="fnref7"><sup>7</sup></a> Tagged MRI is widely used to develop and refine models of normal and abnormal myocardial motion<a class="footnoteRef" href="#fn8" id="fnref8"><sup>8</sup></a><a class="footnoteRef" href="#fn9" id="fnref9"><sup>9</sup></a><a class="footnoteRef" href="#fn10" id="fnref10"><sup>10</sup></a><a class="footnoteRef" href="#fn11" id="fnref11"><sup>11</sup></a> to better understand the correlation of coronary artery disease with myocardial motion abnormalities and the effects of treatment after myocardial infarction. However, suffered from long imaging and post-processing times,<a class="footnoteRef" href="#fn12" id="fnref12"><sup>12</sup></a> tagged MRI was slow in entering into routine clinical use until the HARP algorithm was developed and published in 1999.<a class="footnoteRef" href="#fn13" id="fnref13"><sup>13</sup></a></p>
<h2 id="description">Description</h2>
<h3 id="harp-processing">HARP processing</h3>
<figure><b>(Figure)</b>
<figcaption>Demonstration of the HARP processing of a tagged cardiac MRI slice. (a) An MR image with vertical SPAMM tags. (b) shows the magnitude of its Fourier transform. By extracting the spectral peak inside the circle, a complex image is produced with a magnitude (c) and a phase (d).</figcaption>
</figure>

<p>A tagged MRI showing motion of a human heart is shown in the image (a). The effect of tagging can be described as a multiplication of the underlying image by a sinusoid tag pattern having a certain fundamental frequency, causing an amplitude modulation of the underlying image and replicating its Fourier transform into the pattern shown in (b).</p>

<p>HARP processing uses a bandpass filter to isolate one of the spectral peaks. For example, the circle drawn in (b) is the -3¬†dB isocontour of the bandpass filter used to process this data. Selection of the filters for optimal performance is discussed in this paper.<a class="footnoteRef" href="#fn14" id="fnref14"><sup>14</sup></a> The inverse Fourier transform of the filtered image yields a complex harmonic image 

<math display="inline" id="HARP_(algorithm):0">
 <semantics>
  <mrow>
   <msub>
    <mi>I</mi>
    <mi>k</mi>
   </msub>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>ùê≤</mi>
    <mo>,</mo>
    <mi>t</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>I</ci>
     <ci>k</ci>
    </apply>
    <interval closure="open">
     <ci>ùê≤</ci>
     <ci>t</ci>
    </interval>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   I_{k}(\mathbf{y},t)
  </annotation>
 </semantics>
</math>

 at image coordinates 

<math display="inline" id="HARP_(algorithm):1">
 <semantics>
  <mrow>
   <mi>ùê≤</mi>
   <mo>=</mo>
   <msup>
    <mrow>
     <mo stretchy="false">[</mo>
     <msub>
      <mi>y</mi>
      <mn>1</mn>
     </msub>
     <mo>,</mo>
     <msub>
      <mi>y</mi>
      <mn>2</mn>
     </msub>
     <mo stretchy="false">]</mo>
    </mrow>
    <mi>T</mi>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>ùê≤</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <interval closure="closed">
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>y</ci>
       <cn type="integer">1</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>y</ci>
       <cn type="integer">2</cn>
      </apply>
     </interval>
     <ci>T</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{y}=[y_{1},y_{2}]^{T}
  </annotation>
 </semantics>
</math>

 and time 

<math display="inline" id="HARP_(algorithm):2">
 <semantics>
  <mi>t</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>t</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   t
  </annotation>
 </semantics>
</math>

:</p>

<p>

<math display="block" id="HARP_(algorithm):3">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>I</mi>
     <mi>k</mi>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>ùê≤</mi>
     <mo>,</mo>
     <mi>t</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <msub>
     <mi>D</mi>
     <mi>k</mi>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>ùê≤</mi>
     <mo>,</mo>
     <mi>t</mi>
     <mo stretchy="false">)</mo>
    </mrow>
    <msup>
     <mi>e</mi>
     <mrow>
      <mi>j</mi>
      <msub>
       <mi>œï</mi>
       <mi>k</mi>
      </msub>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>ùê≤</mi>
       <mo>,</mo>
       <mi>t</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </msup>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>I</ci>
      <ci>k</ci>
     </apply>
     <interval closure="open">
      <ci>ùê≤</ci>
      <ci>t</ci>
     </interval>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>D</ci>
      <ci>k</ci>
     </apply>
     <interval closure="open">
      <ci>ùê≤</ci>
      <ci>t</ci>
     </interval>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>e</ci>
      <apply>
       <times></times>
       <ci>j</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>œï</ci>
        <ci>k</ci>
       </apply>
       <interval closure="open">
        <ci>ùê≤</ci>
        <ci>t</ci>
       </interval>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   I_{k}(\mathbf{y},t)=D_{k}(\mathbf{y},t)e^{j\phi_{k}(\mathbf{y},t)}
  </annotation>
 </semantics>
</math>

</p>

<p>where 

<math display="inline" id="HARP_(algorithm):4">
 <semantics>
  <msub>
   <mi>D</mi>
   <mi>k</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>D</ci>
    <ci>k</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   D_{k}
  </annotation>
 </semantics>
</math>

 is called the harmonic magnitude image and 

<math display="inline" id="HARP_(algorithm):5">
 <semantics>
  <msub>
   <mi>œï</mi>
   <mi>k</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>œï</ci>
    <ci>k</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \phi_{k}
  </annotation>
 </semantics>
</math>

 is called the harmonic phase image. The harmonic magnitude image in (c) extracted from a using the filter in (b) shows the geometry of the heart. And the harmonic phase image in (d) contains the motion of the myocardium in horizontal direction. In practice, tagged images from two directions (both horizontal and vertical, i.e., 

<math display="inline" id="HARP_(algorithm):6">
 <semantics>
  <mi>k</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>k</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   k
  </annotation>
 </semantics>
</math>

 is 1 and 2) are processed to provide a 2D motion map in the image plane. Notice that the harmonic phase images are computed by taking the inverse tangent of the imaginary part divided by the real part of 

<math display="inline" id="HARP_(algorithm):7">
 <semantics>
  <mrow>
   <msub>
    <mi>I</mi>
    <mi>k</mi>
   </msub>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>ùê≤</mi>
    <mo>,</mo>
    <mi>t</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>I</ci>
     <ci>k</ci>
    </apply>
    <interval closure="open">
     <ci>ùê≤</ci>
     <ci>t</ci>
    </interval>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   I_{k}(\mathbf{y},t)
  </annotation>
 </semantics>
</math>

, such that the range of this computation is only in 

<math display="inline" id="HARP_(algorithm):8">
 <semantics>
  <mrow>
   <mo stretchy="false">[</mo>
   <mrow>
    <mo>-</mo>
    <mi>œÄ</mi>
   </mrow>
   <mo>,</mo>
   <mrow>
    <mo>+</mo>
    <mi>œÄ</mi>
   </mrow>
   <mo stretchy="false">)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <interval closure="closed-open">
    <apply>
     <minus></minus>
     <ci>œÄ</ci>
    </apply>
    <apply>
     <plus></plus>
     <ci>œÄ</ci>
    </apply>
   </interval>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   [-\pi,+\pi)
  </annotation>
 </semantics>
</math>

. In other words, d is only the wrapped value of the actual phase. We denote this principle value by 

<math display="inline" id="HARP_(algorithm):9">
 <semantics>
  <mrow>
   <msub>
    <mi>a</mi>
    <mi>k</mi>
   </msub>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>ùê≤</mi>
    <mo>,</mo>
    <mi>t</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>a</ci>
     <ci>k</ci>
    </apply>
    <interval closure="open">
     <ci>ùê≤</ci>
     <ci>t</ci>
    </interval>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a_{k}(\mathbf{y},t)
  </annotation>
 </semantics>
</math>

; it is mathematically related to the true phase by:</p>

<p>

<math display="block" id="HARP_(algorithm):10">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>a</mi>
     <mi>k</mi>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>ùê≤</mi>
     <mo>,</mo>
     <mi>t</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mi>m</mi>
     <mi>o</mi>
     <mi>d</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mrow>
        <msub>
         <mi>œï</mi>
         <mi>k</mi>
        </msub>
        <mrow>
         <mo stretchy="false">(</mo>
         <mi>ùê≤</mi>
         <mo>,</mo>
         <mi>t</mi>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
       <mo>+</mo>
       <mi>œÄ</mi>
      </mrow>
      <mo>,</mo>
      <mrow>
       <mn>2</mn>
       <mi>œÄ</mi>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>-</mo>
    <mi>œÄ</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>a</ci>
      <ci>k</ci>
     </apply>
     <interval closure="open">
      <ci>ùê≤</ci>
      <ci>t</ci>
     </interval>
    </apply>
    <apply>
     <minus></minus>
     <apply>
      <times></times>
      <ci>m</ci>
      <ci>o</ci>
      <ci>d</ci>
      <interval closure="open">
       <apply>
        <plus></plus>
        <apply>
         <times></times>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>œï</ci>
          <ci>k</ci>
         </apply>
         <interval closure="open">
          <ci>ùê≤</ci>
          <ci>t</ci>
         </interval>
        </apply>
        <ci>œÄ</ci>
       </apply>
       <apply>
        <times></times>
        <cn type="integer">2</cn>
        <ci>œÄ</ci>
       </apply>
      </interval>
     </apply>
     <ci>œÄ</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a_{k}(\mathbf{y},t)=mod(\phi_{k}(\mathbf{y},t)+\pi,2\pi)-\pi
  </annotation>
 </semantics>
</math>

</p>

<p>Either 

<math display="inline" id="HARP_(algorithm):11">
 <semantics>
  <msub>
   <mi>œï</mi>
   <mi>k</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>œï</ci>
    <ci>k</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \phi_{k}
  </annotation>
 </semantics>
</math>

 or 

<math display="inline" id="HARP_(algorithm):12">
 <semantics>
  <msub>
   <mi>a</mi>
   <mi>k</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>a</ci>
    <ci>k</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a_{k}
  </annotation>
 </semantics>
</math>

 might be called a harmonic phase (HARP) image, but only 

<math display="inline" id="HARP_(algorithm):13">
 <semantics>
  <msub>
   <mi>a</mi>
   <mi>k</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>a</ci>
    <ci>k</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a_{k}
  </annotation>
 </semantics>
</math>

 can be directly calculated and visualized. It is the basis for HARP tracking.</p>
<h3 id="harp-tracking">HARP tracking</h3>
<figure><b>(Figure)</b>
<figcaption>Result of HARP tracking of a tagged cardiac MRI slice.</figcaption>
</figure>

<p>For a fixed material point with a HARP value, only one of the points sharing the same HARP value in a later time frame is the correct match. If the apparent motion is small from one image to the next, it is likely that the nearest of these points is the correct point. The tracking result is very accurate in this case.</p>

<p>Consider a material point located at 

<math display="inline" id="HARP_(algorithm):14">
 <semantics>
  <msub>
   <mi>ùê≤</mi>
   <mi>m</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>ùê≤</ci>
    <ci>m</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{y}_{m}
  </annotation>
 </semantics>
</math>

 at time 

<math display="inline" id="HARP_(algorithm):15">
 <semantics>
  <msub>
   <mi>t</mi>
   <mi>m</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>t</ci>
    <ci>m</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   t_{m}
  </annotation>
 </semantics>
</math>

. If 

<math display="inline" id="HARP_(algorithm):16">
 <semantics>
  <msub>
   <mi>ùê≤</mi>
   <mrow>
    <mi>m</mi>
    <mo>+</mo>
    <mn>1</mn>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>ùê≤</ci>
    <apply>
     <plus></plus>
     <ci>m</ci>
     <cn type="integer">1</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{y}_{m+1}
  </annotation>
 </semantics>
</math>

 is the apparent position of this point at time 

<math display="inline" id="HARP_(algorithm):17">
 <semantics>
  <msub>
   <mi>t</mi>
   <mrow>
    <mi>m</mi>
    <mo>+</mo>
    <mn>1</mn>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>t</ci>
    <apply>
     <plus></plus>
     <ci>m</ci>
     <cn type="integer">1</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   t_{m+1}
  </annotation>
 </semantics>
</math>

, we have:</p>

<p>

<math display="block" id="HARP_(algorithm):18">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>œï</mi>
     <mi>k</mi>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <msub>
      <mi>ùê≤</mi>
      <mrow>
       <mi>m</mi>
       <mo>+</mo>
       <mn>1</mn>
      </mrow>
     </msub>
     <mo>,</mo>
     <msub>
      <mi>t</mi>
      <mrow>
       <mi>m</mi>
       <mo>+</mo>
       <mn>1</mn>
      </mrow>
     </msub>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <msub>
     <mi>œï</mi>
     <mi>k</mi>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <msub>
      <mi>ùê≤</mi>
      <mi>m</mi>
     </msub>
     <mo>,</mo>
     <msub>
      <mi>t</mi>
      <mi>m</mi>
     </msub>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>œï</ci>
      <ci>k</ci>
     </apply>
     <interval closure="open">
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>ùê≤</ci>
       <apply>
        <plus></plus>
        <ci>m</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>t</ci>
       <apply>
        <plus></plus>
        <ci>m</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
     </interval>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>œï</ci>
      <ci>k</ci>
     </apply>
     <interval closure="open">
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>ùê≤</ci>
       <ci>m</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>t</ci>
       <ci>m</ci>
      </apply>
     </interval>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \phi_{k}(\mathbf{y}_{m+1},t_{m+1})=\phi_{k}(\mathbf{y}_{m},t_{m})
  </annotation>
 </semantics>
</math>

</p>

<p>The <a class="uri" href="Newton-Raphson" title="wikilink">Newton-Raphson</a> interative method is used to find a solution, which is:</p>

<p>

<math display="block" id="HARP_(algorithm):19">
 <semantics>
  <mrow>
   <msup>
    <mi>y</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>n</mi>
      <mo>+</mo>
      <mn>1</mn>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </msup>
   <mo>=</mo>
   <mrow>
    <msup>
     <mi>y</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>n</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </msup>
    <mo>-</mo>
    <mrow>
     <msup>
      <mrow>
       <mo stretchy="false">[</mo>
       <mrow>
        <mrow>
         <mo>‚àá</mo>
         <msub>
          <mi>œï</mi>
          <mi>k</mi>
         </msub>
        </mrow>
        <mrow>
         <mo stretchy="false">(</mo>
         <msup>
          <mi>ùê≤</mi>
          <mrow>
           <mo stretchy="false">(</mo>
           <mi>n</mi>
           <mo stretchy="false">)</mo>
          </mrow>
         </msup>
         <mo>,</mo>
         <msub>
          <mi>t</mi>
          <mi>m</mi>
         </msub>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
       <mo stretchy="false">]</mo>
      </mrow>
      <mrow>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
     </msup>
     <mrow>
      <mo stretchy="false">[</mo>
      <mrow>
       <mrow>
        <msub>
         <mi>œï</mi>
         <mi>k</mi>
        </msub>
        <mrow>
         <mo stretchy="false">(</mo>
         <msup>
          <mi>ùê≤</mi>
          <mrow>
           <mo stretchy="false">(</mo>
           <mi>n</mi>
           <mo stretchy="false">)</mo>
          </mrow>
         </msup>
         <mo>,</mo>
         <msub>
          <mi>t</mi>
          <mi>m</mi>
         </msub>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
       <mo>-</mo>
       <mrow>
        <msub>
         <mi>œï</mi>
         <mi>k</mi>
        </msub>
        <mrow>
         <mo stretchy="false">(</mo>
         <msub>
          <mi>ùê≤</mi>
          <mi>m</mi>
         </msub>
         <mo>,</mo>
         <msub>
          <mi>t</mi>
          <mi>m</mi>
         </msub>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
      </mrow>
      <mo stretchy="false">]</mo>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>y</ci>
     <apply>
      <plus></plus>
      <ci>n</ci>
      <cn type="integer">1</cn>
     </apply>
    </apply>
    <apply>
     <minus></minus>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>y</ci>
      <ci>n</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="latexml">delimited-[]</csymbol>
        <apply>
         <times></times>
         <apply>
          <ci>normal-‚àá</ci>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>œï</ci>
           <ci>k</ci>
          </apply>
         </apply>
         <interval closure="open">
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <ci>ùê≤</ci>
           <ci>n</ci>
          </apply>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>t</ci>
           <ci>m</ci>
          </apply>
         </interval>
        </apply>
       </apply>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <apply>
       <csymbol cd="latexml">delimited-[]</csymbol>
       <apply>
        <minus></minus>
        <apply>
         <times></times>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>œï</ci>
          <ci>k</ci>
         </apply>
         <interval closure="open">
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <ci>ùê≤</ci>
           <ci>n</ci>
          </apply>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>t</ci>
           <ci>m</ci>
          </apply>
         </interval>
        </apply>
        <apply>
         <times></times>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>œï</ci>
          <ci>k</ci>
         </apply>
         <interval closure="open">
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>ùê≤</ci>
           <ci>m</ci>
          </apply>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>t</ci>
           <ci>m</ci>
          </apply>
         </interval>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   y^{(n+1)}=y^{(n)}-[\nabla\phi_{k}(\mathbf{y}^{(n)},t_{m})]^{-1}[\phi_{k}(%
\mathbf{y}^{(n)},t_{m})-\phi_{k}(\mathbf{y}_{m},t_{m})]
  </annotation>
 </semantics>
</math>

</p>

<p>In practice, since 

<math display="inline" id="HARP_(algorithm):20">
 <semantics>
  <msub>
   <mi>œï</mi>
   <mi>k</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>œï</ci>
    <ci>k</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \phi_{k}
  </annotation>
 </semantics>
</math>

 is not available, 

<math display="inline" id="HARP_(algorithm):21">
 <semantics>
  <msub>
   <mi>a</mi>
   <mi>k</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>a</ci>
    <ci>k</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a_{k}
  </annotation>
 </semantics>
</math>

 is used in its place. This equation can be rewritten after a few derivations considering the "wrapping" relation between 

<math display="inline" id="HARP_(algorithm):22">
 <semantics>
  <msub>
   <mi>œï</mi>
   <mi>k</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>œï</ci>
    <ci>k</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \phi_{k}
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="HARP_(algorithm):23">
 <semantics>
  <msub>
   <mi>a</mi>
   <mi>k</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>a</ci>
    <ci>k</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a_{k}
  </annotation>
 </semantics>
</math>

.</p>

<p>The result of HARP tracking of one frame of cardiac MRI is shown in the figure. It is obtained by calculating both motions from horizontal direction and vertical direction, resulting in a 2D vector field showing the motion of every material point on the myocardium at this time frame.</p>

<p>The entire HARP algorithm takes only a few minutes to perform on a normal computer and the motion tracking result is accurate (with a typical error range of 

<math display="inline" id="HARP_(algorithm):24">
 <semantics>
  <mrow>
   <mo>¬±</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">plus-or-minus</csymbol>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \pm 1
  </annotation>
 </semantics>
</math>

 pixel). As a result, it is now widely adopted by the medical image analysis community as a standard processing technique for tagged MRI.</p>
<h2 id="see-also">See also</h2>
<ul>
<li><a href="Strain_Encoding_MRI" title="wikilink">Strain Encoding (SENC) MRI</a></li>
</ul>
<h2 id="references">References</h2>
<h2 id="external-links">External links</h2>
<ul>
<li><a href="http://www.iacl.ece.jhu.edu/static/harp/">HARP Overview at Image Analysis and Communications Laboratory</a></li>
<li><a href="http://www.iacl.ece.jhu.edu/static/harp/">Image Analysis and Communications Laboratory Homepage</a></li>
</ul>

<p>"</p>

<p><a href="Category:Cardiac_imaging" title="wikilink">Category:Cardiac imaging</a> <a href="Category:Magnetic_resonance_imaging" title="wikilink">Category:Magnetic resonance imaging</a> <a href="Category:Medical_imaging" title="wikilink">Category:Medical imaging</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1"><a href="#fnref1">‚Ü©</a></li>
<li id="fn2"><a href="#fnref2">‚Ü©</a></li>
<li id="fn3"><a href="#fnref3">‚Ü©</a></li>
<li id="fn4"><a href="#fnref4">‚Ü©</a></li>
<li id="fn5"><a href="#fnref5">‚Ü©</a></li>
<li id="fn6"><a href="#fnref6">‚Ü©</a></li>
<li id="fn7"><a href="#fnref7">‚Ü©</a></li>
<li id="fn8"><a href="#fnref8">‚Ü©</a></li>
<li id="fn9"><a href="#fnref9">‚Ü©</a></li>
<li id="fn10"><a href="#fnref10">‚Ü©</a></li>
<li id="fn11"><a href="#fnref11">‚Ü©</a></li>
<li id="fn12"><a href="#fnref12">‚Ü©</a></li>
<li id="fn13"><a href="#fnref13">‚Ü©</a></li>
<li id="fn14"><a href="#fnref14">‚Ü©</a></li>
</ol>
</section>
</body>
</html>

<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="952">RA plot</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>RA plot</h1>
<hr/>

<p>The Ratio Average [RA] plot is an integer based version of an <a href="MA_plot" title="wikilink">MA plot</a> for visualizing two-condition count data. Its distinctive arrow-like shape derives from the way it includes condition-unique (0,n) or (n,0) points into the plot via an <a href="Epsilon#Symbol" title="wikilink">epsilon factor</a>.</p>
<h2 id="definition">Definition</h2>

<p>An <strong>RA plot</strong>, like its cousin, the <a href="MA_plot" title="wikilink">MA plot</a>, is a re-scaled and (45 degree) rotated version of a simple two dimensional scatter plot of a vs b where a and b are equal length vectors of positive measurements. This rescaling and rotation allows for better visibility and emphasis of important outliers points that vary between the two measurement conditions.<a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a> Essentially it is a plot of the log ratio [R] vs the average log [A] of each pairing of the elements of a and b. Unlike an MA plot, however, because the RA plot takes non-negative integer counts as input, it must employ work-arounds to include mathematically invisible points (such as points where one or both element(s) of the pair is zero).</p>

<p>If we modify our original a (or b) vector via:</p>

<p>

<math display="inline" id="RA_plot:0">
 <semantics>
  <mrow>
   <mi>a</mi>
   <mo>=</mo>
   <mrow>
    <mo>{</mo>
    <mtable>
     <mtr>
      <mtd columnalign="left">
       <mrow>
        <mrow>
         <mi>a</mi>
         <mo>+</mo>
         <mi>ϵ</mi>
        </mrow>
        <mo>,</mo>
       </mrow>
      </mtd>
      <mtd columnalign="left">
       <mrow>
        <mrow>
         <mtext>if</mtext>
         <mi>a</mi>
        </mrow>
        <mo>=</mo>
        <mn>0</mn>
       </mrow>
      </mtd>
     </mtr>
     <mtr>
      <mtd columnalign="left">
       <mrow>
        <mi>a</mi>
        <mo>,</mo>
       </mrow>
      </mtd>
      <mtd columnalign="left">
       <mrow>
        <mrow>
         <mtext>if</mtext>
         <mi>a</mi>
        </mrow>
        <mo>></mo>
        <mn>0</mn>
       </mrow>
      </mtd>
     </mtr>
    </mtable>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>a</ci>
    <apply>
     <csymbol cd="latexml">cases</csymbol>
     <apply>
      <plus></plus>
      <ci>a</ci>
      <ci>ϵ</ci>
     </apply>
     <apply>
      <eq></eq>
      <apply>
       <times></times>
       <mtext>if</mtext>
       <ci>a</ci>
      </apply>
      <cn type="integer">0</cn>
     </apply>
     <ci>a</ci>
     <apply>
      <gt></gt>
      <apply>
       <times></times>
       <mtext>if</mtext>
       <ci>a</ci>
      </apply>
      <cn type="integer">0</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a=\begin{cases}a+\epsilon,&\text{if }a=0\\
a,&\text{if }a>0\end{cases}
  </annotation>
 </semantics>
</math>

</p>

<p>where</p>

<p>

<math display="inline" id="RA_plot:1">
 <semantics>
  <mrow>
   <mn>0</mn>
   <mo><</mo>
   <mi>ϵ</mi>
   <mo><</mo>
   <mn>0.5</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <lt></lt>
     <cn type="integer">0</cn>
     <ci>ϵ</ci>
    </apply>
    <apply>
     <lt></lt>
     <share href="#.cmml">
     </share>
     <cn type="float">0.5</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   0<\epsilon<0.5
  </annotation>
 </semantics>
</math>

</p>

<p>then R and A can be defined as:</p>

<p>

<math display="inline" id="RA_plot:2">
 <semantics>
  <mrow>
   <mi>R</mi>
   <mo>=</mo>
   <mrow>
    <msub>
     <mi>log</mi>
     <mn>2</mn>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>a</mi>
      <mo>/</mo>
      <mi>b</mi>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>R</ci>
    <apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <log></log>
      <cn type="integer">2</cn>
     </apply>
     <apply>
      <divide></divide>
      <ci>a</ci>
      <ci>b</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \textstyle{R=\log_{2}(a/b)}
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="inline" id="RA_plot:3">
 <semantics>
  <mrow>
   <mi>A</mi>
   <mo>=</mo>
   <mrow>
    <mfrac>
     <mn>1</mn>
     <mn>2</mn>
    </mfrac>
    <mo>×</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mrow>
       <msub>
        <mi>log</mi>
        <mn>2</mn>
       </msub>
       <mi>a</mi>
      </mrow>
      <mo>+</mo>
      <mrow>
       <msub>
        <mi>log</mi>
        <mn>2</mn>
       </msub>
       <mi>b</mi>
      </mrow>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>A</ci>
    <apply>
     <times></times>
     <apply>
      <divide></divide>
      <cn type="integer">1</cn>
      <cn type="integer">2</cn>
     </apply>
     <apply>
      <plus></plus>
      <apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <log></log>
        <cn type="integer">2</cn>
       </apply>
       <ci>a</ci>
      </apply>
      <apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <log></log>
        <cn type="integer">2</cn>
       </apply>
       <ci>b</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \textstyle{A=\frac{1}{2}\times(\log_{2}a+\log_{2}b)}
  </annotation>
 </semantics>
</math>

</p>

<p>R, like M, is plotted on the y-axis and represents a log (fold change) ratio between a and b. A is plotted on the x-axis and represents the average abundance for a coordinate pair. The RA plot provides a quick overview of the distribution and size of a dataset consisting of non-zero counts.</p>
<h2 id="etymology">Etymology</h2>

<p>The acronym prefix "R.A." is sometimes pronounced as the one syllable word "ray" because of the plot's strong resemblance to a <a href="Line_(geometry)#Ray" title="wikilink">geometric ray</a>. This characteristic arrow-like shape derives from two key features: on the right at the <a href="Vector_(geometric)#Representations" title="wikilink">vector</a> origin, a long asymptotic tail, and on the left (forming the arrow head) two (often dense) patches of condition-unique points.</p>
<h2 id="work-arounds-for-point-visibility-and-inclusion">Work-Arounds for point visibility and inclusion</h2>
<h3 id="condition-unique-points">Condition unique points</h3>

<p>Because a large portion of the pairs of a and b contain zeros in one or both conditions, they are impossible to plot as-is on a log scale. Other MA plotting functions artificially include these condition-unique points in the plot by spreading them vertically as a "smear" on the left or horizontally as a "<a href="http://projetos.inpa.gov.br/i3geo/pacotes/r/win/library/graphics/html/rug.html">rug</a>" at the very top and bottom of the plot. In an RA plot, by contrast, the uniques are included via addition a small <a href="Epsilon#Math_and_science" title="wikilink">epsilon factor</a> (between .1 and .5) which places them in a more statistically appropriate location in the plot.</p>

<p>{{-}}</p>
<h3 id="overplotting">Overplotting</h3>

<p>Another problem with plotting this (or any) type of count data is <a href="http://en.wiktionary.org/wiki/overplotting">overplotting</a> which is solved in the RA plot by <a href="jitter" title="wikilink">jittering</a> the points out away from each other but no so far as to merge with other coordinates. The result of this feature is a patchwork-like appearance to the plot that fades away as the A increases.</p>

<p>{{-}}</p>
<h2 id="packages">Packages</h2>

<p>The <a href="http://cran.r-project.org/web/packages/caroline/index.html">caroline CRAN R package</a> contains the only known implementation of an RA plot. However, the meta-transcriptomics <a href="http://bioconductor.org/packages/devel/bioc/html/manta.html">"manta" R package</a> provides a wrapper around this RA plot implementation and is used for assessing fold change in transcription of genes (the points) while simultaneously visualizing each gene's taxonomic distributions as individual pie chart points.<a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a></p>
<h2 id="examples">Examples</h2>
<pre><code>
library(caroline)
a &lt;- rnbinom(n=10000, mu=5, size=2)
b &lt;- rnbinom(n=10000, mu=5, size=2)

raPlot(a, b)</code></pre>
<h2 id="references">References</h2>
<references>
</references>
<h2 id="see-also">See also</h2>
<ul>
<li><a href="MA_plot" title="wikilink">MA plot</a></li>
<li><a href="DNA_microarray" title="wikilink">DNA microarray</a></li>
<li><a href="Bland–Altman_plot" title="wikilink">Bland–Altman plot</a></li>
</ul>

<p>"</p>

<p><a href="Category:Gene_expression" title="wikilink">Category:Gene expression</a> <a class="uri" href="Category:Microarrays" title="wikilink">Category:Microarrays</a> <a href="Category:Plots_(graphics)" title="wikilink">Category:Plots (graphics)</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1">Dudoit, S, Yang, YH, Callow, MJ, Speed, TP. (2002). Statistical methods for identifying differentially expressed genes in replicated cDNA microarray experiments. <em>Stat. Sin.</em> 12:1 111-139<a href="#fnref1">↩</a></li>
<li id="fn2">Schruth,D. &amp; Marchetti,A. (2011). Microbial Assemblage Normalized Transcript Analysis. R package version 0.9.5.<a href="#fnref2">↩</a></li>
</ol>
</section>
</body>
</html>

   Variational Bayesian methods      Variational Bayesian methods   Variational Bayesian methods are a family of techniques for approximating intractable integrals arising in Bayesian inference and machine learning . They are typically used in complex statistical models consisting of observed variables (usually termed "data") as well as unknown parameters and latent variables , with various sorts of relationships among the three types of random variables , as might be described by a graphical model . As is typical in Bayesian inference, the parameters and latent variables are grouped together as "unobserved variables". Variational Bayesian methods are primarily used for two purposes:   To provide an analytical approximation to the posterior probability of the unobserved variables, in order to do statistical inference over these variables.  To derive a lower bound for the marginal likelihood (sometimes called the "evidence") of the observed data (i.e. the marginal probability of the data given the model, with marginalization performed over unobserved variables). This is typically used for performing model selection , the general idea being that a higher marginal likelihood for a given model indicates a better fit of the data by that model and hence a greater probability that the model in question was the one that generated the data. (See also the Bayes factor article.)   In the former purpose (that of approximating a posterior probability), variational Bayes is an alternative to Monte Carlo sampling methods — particularly, Markov chain Monte Carlo methods such as Gibbs sampling — for taking a fully Bayesian approach to statistical inference over complex distributions that are difficult to directly evaluate or sample from. In particular, whereas Monte Carlo techniques provide a numerical approximation to the exact posterior using a set of samples, Variational Bayes provides a locally-optimal, exact analytical solution to an approximation of the posterior.  Variational Bayes can be seen as an extension of the EM ( expectation-maximization ) algorithm from maximum a posteriori estimation (MAP estimation) of the single most probable value of each parameter to fully Bayesian estimation which computes (an approximation to) the entire posterior distribution of the parameters and latent variables. As in EM, it finds a set of optimal parameter values, and it has the same alternating structure as does EM, based on a set of interlocked (mutually dependent) equations that cannot be solved analytically.  For many applications, variational Bayes produces solutions of comparable accuracy to Gibbs sampling at greater speed. However, deriving the set of equations used to iteratively update the parameters often requires a large amount of work compared with deriving the comparable Gibbs sampling equations. This is the case even for many models that are conceptually quite simple, as is demonstrated below in the case of a basic non-hierarchical model with only two parameters and no latent variables.  Mathematical derivation of the mean-field approximation  In variational inference, the posterior distribution over a set of unobserved variables    𝐙  =   {    Z  1   …   Z  n    }       𝐙      subscript  Z  1   normal-…   subscript  Z  n       \mathbf{Z}=\{Z_{1}\dots Z_{n}\}   given some data   𝐗   𝐗   \mathbf{X}   is approximated by a variational distribution,    Q   (  𝐙  )       Q  𝐙    Q(\mathbf{Z})   :      P   (  𝐙  ∣  𝐗  )   ≈  Q   (  𝐙  )   .     fragments  P   fragments  normal-(  Z  normal-∣  X  normal-)    Q   fragments  normal-(  Z  normal-)   normal-.    P(\mathbf{Z}\mid\mathbf{X})\approx Q(\mathbf{Z}).     The distribution    Q   (  𝐙  )       Q  𝐙    Q(\mathbf{Z})   is restricted to belong to a family of distributions of simpler form than    P   (  𝐙  ∣  𝐗  )      fragments  P   fragments  normal-(  Z  normal-∣  X  normal-)     P(\mathbf{Z}\mid\mathbf{X})   , selected with the intention of making    Q   (  𝐙  )       Q  𝐙    Q(\mathbf{Z})   similar to the true posterior,    P   (  𝐙  ∣  𝐗  )      fragments  P   fragments  normal-(  Z  normal-∣  X  normal-)     P(\mathbf{Z}\mid\mathbf{X})   . The lack of similarity is measured in terms of a dissimilarity function    d   (  Q  ;  P  )       d   Q  P     d(Q;P)   and hence inference is performed by selecting the distribution    Q   (  𝐙  )       Q  𝐙    Q(\mathbf{Z})   that minimizes    d   (  Q  ;  P  )       d   Q  P     d(Q;P)   .  The most common type of variational Bayes, known as mean-field variational Bayes , uses the Kullback–Leibler divergence (KL-divergence) of P from Q as the choice of dissimilarity function. This choice makes this minimization tractable. The KL-divergence is defined as       D  KL    (  Q  |  |  P  )   =   ∑  𝐙   Q   (  𝐙  )   log    Q   (  𝐙  )     P   (  𝐙  ∣  𝐗  )     .     fragments   subscript  D  KL    fragments  normal-(  Q  normal-|  normal-|  P  normal-)     subscript   𝐙   Q   fragments  normal-(  Z  normal-)        Q  𝐙    fragments  P   fragments  normal-(  Z  normal-∣  X  normal-)     normal-.    D_{\mathrm{KL}}(Q||P)=\sum_{\mathbf{Z}}Q(\mathbf{Z})\log\frac{Q(\mathbf{Z})}{P%
 (\mathbf{Z}\mid\mathbf{X})}.     Note that Q and P are reversed from what one might expect. This use of reversed KL-divergence is conceptually similar to the expectation-maximization algorithm . (Using the KL-divergence in the other way produces the expectation propagation algorithm.)  The KL-divergence can be written as       D  KL    (  Q  |  |  P  )   =   ∑  𝐙   Q   (  𝐙  )   log    Q   (  𝐙  )     P   (  𝐙  ,  𝐗  )     +  log  P   (  𝐗  )   ,     fragments   subscript  D  KL    fragments  normal-(  Q  normal-|  normal-|  P  normal-)     subscript   𝐙   Q   fragments  normal-(  Z  normal-)        Q  𝐙     P   𝐙  𝐗       P   fragments  normal-(  X  normal-)   normal-,    D_{\mathrm{KL}}(Q||P)=\sum_{\mathbf{Z}}Q(\mathbf{Z})\log\frac{Q(\mathbf{Z})}{P%
 (\mathbf{Z},\mathbf{X})}+\log P(\mathbf{X}),     or      log  P   (  𝐗  )   =   D  KL    (  Q  |  |  P  )   -   ∑  𝐙   Q   (  𝐙  )   log    Q   (  𝐙  )     P   (  𝐙  ,  𝐗  )     =   D  KL    (  Q  |  |  P  )   +  ℒ   (  Q  )   .     fragments   P   fragments  normal-(  X  normal-)     subscript  D  KL    fragments  normal-(  Q  normal-|  normal-|  P  normal-)     subscript   𝐙   Q   fragments  normal-(  Z  normal-)        Q  𝐙     P   𝐙  𝐗       subscript  D  KL    fragments  normal-(  Q  normal-|  normal-|  P  normal-)    L   fragments  normal-(  Q  normal-)   normal-.    \log P(\mathbf{X})=D_{\mathrm{KL}}(Q||P)-\sum_{\mathbf{Z}}Q(\mathbf{Z})\log%
 \frac{Q(\mathbf{Z})}{P(\mathbf{Z},\mathbf{X})}=D_{\mathrm{KL}}(Q||P)+\mathcal{%
 L}(Q).     As the log evidence      log  P    (  𝐗  )         P   𝐗    \log P(\mathbf{X})   is fixed with respect to   Q   Q   Q   , maximizing the final term    ℒ   (  Q  )       ℒ  Q    \mathcal{L}(Q)   minimizes the KL divergence of   P   P   P   from   Q   Q   Q   . By appropriate choice of   Q   Q   Q   ,    ℒ   (  Q  )       ℒ  Q    \mathcal{L}(Q)   becomes tractable to compute and to maximize. Hence we have both an analytical approximation   Q   Q   Q   for the posterior    P   (  𝐙  ∣  𝐗  )      fragments  P   fragments  normal-(  Z  normal-∣  X  normal-)     P(\mathbf{Z}\mid\mathbf{X})   , and a lower bound    ℒ   (  Q  )       ℒ  Q    \mathcal{L}(Q)   for the evidence     log  P    (  𝐗  )         P   𝐗    \log P(\mathbf{X})   . The lower bound    ℒ   (  Q  )       ℒ  Q    \mathcal{L}(Q)   is known as the (negative) variational free energy because it can also be expressed as an "energy"     E  Q    [    log  P    (  𝐙  ,  𝐗  )    ]       subscript  normal-E  Q       P    𝐙  𝐗      \operatorname{E}_{Q}[\log P(\mathbf{Z},\mathbf{X})]   plus the entropy of   Q   Q   Q   .  In practice  The variational distribution    Q   (  𝐙  )       Q  𝐙    Q(\mathbf{Z})   is usually assumed to factorize over some partition of the latent variables, i.e. for some partition of the latent variables   𝐙   𝐙   \mathbf{Z}   into     𝐙  1   …   𝐙  M        subscript  𝐙  1   normal-…   subscript  𝐙  M     \mathbf{Z}_{1}\dots\mathbf{Z}_{M}   ,      Q   (  𝐙  )   =   ∏   i  =  1   M    q  i    (   𝐙  i   ∣  𝐗  )      fragments  Q   fragments  normal-(  Z  normal-)     superscript   subscript  product    i  1    M    subscript  q  i    fragments  normal-(   subscript  𝐙  i   normal-∣  X  normal-)     Q(\mathbf{Z})=\prod_{i=1}^{M}q_{i}(\mathbf{Z}_{i}\mid\mathbf{X})     It can be shown using the calculus of variations (hence the name "variational Bayes") that the "best" distribution    q  j  *     superscript   subscript  q  j      q_{j}^{*}   for each of the factors    q  j     subscript  q  j    q_{j}   (in terms of the distribution minimizing the KL divergence, as described above) can be expressed as:       q  j  *    (   𝐙  j   ∣  𝐗  )   =    e    E   i  ≠  j     [    ln  p    (  𝐙  ,  𝐗  )    ]      ∫     e    E   i  ≠  j     [    ln  p    (  𝐙  ,  𝐗  )    ]      d   𝐙  j         fragments   superscript   subscript  q  j      fragments  normal-(   subscript  𝐙  j   normal-∣  X  normal-)       superscript  e    subscript  normal-E    i  j        p    𝐙  𝐗           superscript  e    subscript  normal-E    i  j        p    𝐙  𝐗      d   subscript  𝐙  j        q_{j}^{*}(\mathbf{Z}_{j}\mid\mathbf{X})=\frac{e^{\operatorname{E}_{i\neq j}[%
 \ln p(\mathbf{Z},\mathbf{X})]}}{\int e^{\operatorname{E}_{i\neq j}[\ln p(%
 \mathbf{Z},\mathbf{X})]}\,d\mathbf{Z}_{j}}     where     E   i  ≠  j     [    ln  p    (  𝐙  ,  𝐗  )    ]       subscript  normal-E    i  j        p    𝐙  𝐗      \operatorname{E}_{i\neq j}[\ln p(\mathbf{Z},\mathbf{X})]   is the expectation of the logarithm of the joint probability of the data and latent variables, taken over all variables not in the partition.  In practice, we usually work in terms of logarithms, i.e.:      ln   q  j  *    (   𝐙  j   ∣  𝐗  )   =   E   i  ≠  j     [  ln  p   (  𝐙  ,  𝐗  )   ]   +  constant     fragments    superscript   subscript  q  j      fragments  normal-(   subscript  𝐙  j   normal-∣  X  normal-)     subscript  normal-E    i  j     fragments  normal-[   p   fragments  normal-(  Z  normal-,  X  normal-)   normal-]    constant    \ln q_{j}^{*}(\mathbf{Z}_{j}\mid\mathbf{X})=\operatorname{E}_{i\neq j}[\ln p(%
 \mathbf{Z},\mathbf{X})]+\text{constant}     The constant in the above expression is related to the normalizing constant (the denominator in the expression above for    q  j  *     superscript   subscript  q  j      q_{j}^{*}   ) and is usually reinstated by inspection, as the rest of the expression can usually be recognized as being a known type of distribution (e.g. Gaussian , gamma , etc.).  Using the properties of expectations, the expression     E   i  ≠  j     [    ln  p    (  𝐙  ,  𝐗  )    ]       subscript  normal-E    i  j        p    𝐙  𝐗      \operatorname{E}_{i\neq j}[\ln p(\mathbf{Z},\mathbf{X})]   can usually be simplified into a function of the fixed hyperparameters of the prior distributions over the latent variables and of expectations (and sometimes higher moments such as the variance ) of latent variables not in the current partition (i.e. latent variables not included in    𝐙  j     subscript  𝐙  j    \mathbf{Z}_{j}   ). This creates circular dependencies between the parameters of the distributions over variables in one partition and the expectations of variables in the other partitions. This naturally suggests an iterative algorithm, much like EM (the expectation-maximization algorithm), in which the expectations (and possibly higher moments) of the latent variables are initialized in some fashion (perhaps randomly), and then the parameters of each distribution are computed in turn using the current values of the expectations, after which the expectation of the newly computed distribution is set appropriately according to the computed parameters. An algorithm of this sort is guaranteed to converge . 1 Furthermore, if the distributions in question are part of the exponential family , which is usually the case, convergence will be to a global maximum , since the exponential family is convex . 2  In other words, for each of the partitions of variables, by simplifying the expression for the distribution over the partition's variables and examining the distribution's functional dependency on the variables in question, the family of the distribution can usually be determined (which in turn determines the value of the constant). The formula for the distribution's parameters will be expressed in terms of the prior distributions' hyperparameters (which are known constants), but also in terms of expectations of functions of variables in other partitions. Usually these expectations can be simplified into functions of expectations of the variables themselves (i.e. the means ); sometimes expectations of squared variables (which can be related to the variance of the variables), or expectations of higher powers (i.e. higher moments ) also appear. In most cases, the other variables' distributions will be from known families, and the formulas for the relevant expectations can be looked up. However, those formulas depend on those distributions' parameters, which depend in turn on the expectations about other variables. The result is that the formulas for the parameters of each variable's distributions can be expressed as a series of equations with mutual, nonlinear dependencies among the variables. Usually, it is not possible to solve this system of equations directly. However, as described above, the dependencies suggest a simple iterative algorithm, which in most cases is guaranteed to converge. An example will make this process clearer.  A basic example  Consider a simple non-hierarchical Bayesian model consisting of a set of i.i.d. observations from a Gaussian distribution , with unknown mean and variance . 3 In the following, we work through this model in great detail to illustrate the workings of the variational Bayes method.  For mathematical convenience, in the following example we work in terms of the precision — i.e. the reciprocal of the variance (or in a multivariate Gaussian, the inverse of the covariance matrix ) — rather than the variance itself. (From a theoretical standpoint, precision and variance are equivalent since there is a one-to-one correspondence between the two.)  The mathematical model  We place conjugate prior distributions on the unknown mean and variance, i.e. the mean also follows a Gaussian distribution while the precision follows a gamma distribution . In other words:     μ   μ   \displaystyle\mu     We are given   N   N   N   data points    𝐗  =   {   x  1   ,  …  ,   x  N   }       𝐗    subscript  x  1   normal-…   subscript  x  N      \mathbf{X}=\{x_{1},\dots,x_{N}\}   and our goal is to infer the posterior distribution     q   (  μ  ,  τ  )   =  p   (  μ  ,  τ  ∣   x  1   ,  …  ,   x  N   )      fragments  q   fragments  normal-(  μ  normal-,  τ  normal-)    p   fragments  normal-(  μ  normal-,  τ  normal-∣   subscript  x  1   normal-,  normal-…  normal-,   subscript  x  N   normal-)     q(\mu,\tau)=p(\mu,\tau\mid x_{1},\ldots,x_{N})   of the parameters   μ   μ   \mu   and   τ   τ   \tau   .  The hyperparameters     μ  0     subscript  μ  0    \mu_{0}   ,    λ  0     subscript  λ  0    \lambda_{0}   ,    a  0     subscript  a  0    a_{0}   and    b  0     subscript  b  0    b_{0}   are fixed, given values. They can be set to small positive numbers to give broad prior distributions indicating ignorance about the prior distributions of   μ   μ   \mu   and   τ   τ   \tau   .  The joint probability  The joint probability of all variables can be rewritten as      p   (  𝐗  ,  μ  ,  τ  )   =  p   (  𝐗  ∣  μ  ,  τ  )   p   (  μ  ∣  τ  )   p   (  τ  )      fragments  p   fragments  normal-(  X  normal-,  μ  normal-,  τ  normal-)    p   fragments  normal-(  X  normal-∣  μ  normal-,  τ  normal-)   p   fragments  normal-(  μ  normal-∣  τ  normal-)   p   fragments  normal-(  τ  normal-)     p(\mathbf{X},\mu,\tau)=p(\mathbf{X}\mid\mu,\tau)p(\mu\mid\tau)p(\tau)     where the individual factors are      p   (  𝐗  ∣  μ  ,  τ  )      fragments  p   fragments  normal-(  X  normal-∣  μ  normal-,  τ  normal-)     \displaystyle p(\mathbf{X}\mid\mu,\tau)     where      𝒩   (  x  ∣  μ  ,   σ  2   )      fragments  N   fragments  normal-(  x  normal-∣  μ  normal-,   superscript  σ  2   normal-)     \displaystyle\mathcal{N}(x\mid\mu,\sigma^{2})     Factorized approximation  Assume that     q   (  μ  ,  τ  )    =   q   (  μ  )   q   (  τ  )          q   μ  τ      q  μ  q  τ     q(\mu,\tau)=q(\mu)q(\tau)   , i.e. that the posterior distribution factorizes into independent factors for   μ   μ   \mu   and   τ   τ   \tau   . This type of assumption underlies the variational Bayesian method. The true posterior distribution does not in fact factor this way (in fact, in this simple case, it is known to be a Gaussian-gamma distribution ), and hence the result we obtain will be an approximation.  Derivation of q(μ)  Then       ln   q  μ  *     (  μ  )          superscript   subscript  q  μ      μ    \displaystyle\ln q_{\mu}^{*}(\mu)     In the above derivation,   C   C   C   ,    C  2     subscript  C  2    C_{2}   and    C  3     subscript  C  3    C_{3}   refer to values that are constant with respect to   μ   μ   \mu   . Note that the term     E  τ    [    ln  p    (  τ  )    ]       subscript  normal-E  τ       p   τ     \operatorname{E}_{\tau}[\ln p(\tau)]   is not a function of   μ   μ   \mu   and will have the same value regardless of the value of   μ   μ   \mu   . Hence in line 3 we can absorb it into the constant term at the end. We do the same thing in line 7.  The last line is simply a quadratic polynomial in   μ   μ   \mu   . Since this is the logarithm of     q  μ  *    (  μ  )        superscript   subscript  q  μ     μ    q_{\mu}^{*}(\mu)   , we can see that     q  μ  *    (  μ  )        superscript   subscript  q  μ     μ    q_{\mu}^{*}(\mu)   itself is a Gaussian distribution .  With a certain amount of tedious math (expanding the squares inside of the braces, separating out and grouping the terms involving   μ   μ   \mu   and    μ  2     superscript  μ  2    \mu^{2}   and completing the square over   μ   μ   \mu   ), we can derive the parameters of the Gaussian distribution:       ln   q  μ  *     (  μ  )          superscript   subscript  q  μ      μ    \displaystyle\ln q_{\mu}^{*}(\mu)     Note that all of the above steps can be shortened by using the formula for the sum of two quadratics .  In other words:       q  μ  *    (  μ  )        superscript   subscript  q  μ     μ    \displaystyle q_{\mu}^{*}(\mu)     Derivation of q(τ)  The derivation of     q  τ  *    (  τ  )        superscript   subscript  q  τ     τ    q_{\tau}^{*}(\tau)   is similar to above, although we omit some of the details for the sake of brevity.       ln   q  τ  *     (  τ  )          superscript   subscript  q  τ      τ    \displaystyle\ln q_{\tau}^{*}(\tau)     Exponentiating both sides, we can see that     q  τ  *    (  τ  )        superscript   subscript  q  τ     τ    q_{\tau}^{*}(\tau)   is a gamma distribution . Specifically:       q  τ  *    (  τ  )        superscript   subscript  q  τ     τ    \displaystyle q_{\tau}^{*}(\tau)     Algorithm for computing the parameters  Let us recap the conclusions from the previous sections:       q  μ  *    (  μ  )        superscript   subscript  q  μ     μ    \displaystyle q_{\mu}^{*}(\mu)     and       q  τ  *    (  τ  )        superscript   subscript  q  τ     τ    \displaystyle q_{\tau}^{*}(\tau)     In each case, the parameters for the distribution over one of the variables depend on expectations taken with respect to the other variable. We can expand the expectations, using the standard formulas for the expectations of moments of the Gaussian and gamma distributions:      E   [  τ  ∣   a  N   ,   b  N   ]      normal-E  τ   subscript  a  N    subscript  b  N     \displaystyle\operatorname{E}[\tau\mid a_{N},b_{N}]     Applying these formulas to the above equations is trivial in most cases, but the equation for    b  N     subscript  b  N    b_{N}   takes more work:      b  N     subscript  b  N    \displaystyle b_{N}     We can then write the parameter equations as follows, without any expectations:      μ  N     subscript  μ  N    \displaystyle\mu_{N}     Note that there are circular dependencies among the formulas for    μ  N     subscript  μ  N    \mu_{N}   ,    λ  N     subscript  λ  N    \lambda_{N}   and    b  N     subscript  b  N    b_{N}   . This naturally suggests an EM -like algorithm:   Compute     ∑   n  =  1   N    x  n       superscript   subscript     n  1    N    subscript  x  n     \sum_{n=1}^{N}x_{n}   and      ∑   n  =  1   N    x  n  2    .      superscript   subscript     n  1    N    superscript   subscript  x  n   2     \sum_{n=1}^{N}x_{n}^{2}.   Use these values to compute    μ  N     subscript  μ  N    \mu_{N}   and     a  N   .     subscript  a  N    a_{N}.     Initialize    λ  N     subscript  λ  N    \lambda_{N}   to some arbitrary value.  Use the current value of     λ  N   ,     subscript  λ  N    \lambda_{N},   along with the known values of the other parameters, to compute    b  N     subscript  b  N    b_{N}   .  Use the current value of     b  N   ,     subscript  b  N    b_{N},   along with the known values of the other parameters, to compute    λ  N     subscript  λ  N    \lambda_{N}   .  Repeat the last two steps until convergence (i.e. until neither value has changed more than some small amount).   We then have values for the hyperparameters of the approximating distributions of the posterior parameters, which we can use to compute any properties we want of the posterior — e.g. its mean and variance, a 95% highest-density region (the smallest interval that includes 95% of the total probability), etc.  It can be shown that this algorithm is guaranteed to converge to a local maximum, and since both posterior distributions are in the exponential family , this local maximum will be a global maximum .  Note also that the posterior distributions have the same form as the corresponding prior distributions. We did not assume this; the only assumption we made was that the distributions factorize, and the form of the distributions followed naturally. It turns out (see below) that the fact that the posterior distributions have the same form as the prior distributions is not a coincidence, but a general result whenever the prior distributions are members of the exponential family , which is the case for most of the standard distributions.  Further discussion  Step-by-step recipe  The above example shows the method by which the variational-Bayesian approximation to a posterior probability density in a given Bayesian network is derived:   Describe the network with a graphical model , identifying the observed variables (data)   𝐗   𝐗   \mathbf{X}   and unobserved variables ( parameters    𝚯   𝚯   \boldsymbol{\Theta}   and latent variables    𝐙   𝐙   \mathbf{Z}   ) and their conditional probability distributions . Variational Bayes will then construct an approximation to the posterior probability    p   (  𝐙  ,  𝚯  ∣  𝐗  )      fragments  p   fragments  normal-(  Z  normal-,  Θ  normal-∣  X  normal-)     p(\mathbf{Z},\boldsymbol{\Theta}\mid\mathbf{X})   . The approximation has the basic property that it is a factorized distribution, i.e. a product of two or more independent distributions over disjoint subsets of the unobserved variables.  Partition the unobserved variables into two or more subsets, over which the independent factors will be derived. There is no universal procedure for doing this; creating too many subsets yields a poor approximation, while creating too few makes the entire variational Bayes procedure intractable. Typically, the first split is to separate the parameters and latent variables; often, this is enough by itself to produce a tractable result. Assume that the partitions are called     𝐙  1   ,  …  ,   𝐙  M       subscript  𝐙  1   normal-…   subscript  𝐙  M     \mathbf{Z}_{1},\ldots,\mathbf{Z}_{M}   .  For a given partition    𝐙  j     subscript  𝐙  j    \mathbf{Z}_{j}   , write down the formula for the best approximating distribution     q  j  *    (   𝐙  j   ∣  𝐗  )      fragments   superscript   subscript  q  j      fragments  normal-(   subscript  𝐙  j   normal-∣  X  normal-)     q_{j}^{*}(\mathbf{Z}_{j}\mid\mathbf{X})   using the basic equation    ln   q  j  *    (   𝐙  j   ∣  𝐗  )   =   E   i  ≠  j     [  ln  p   (  𝐙  ,  𝐗  )   ]   +  constant     fragments    superscript   subscript  q  j      fragments  normal-(   subscript  𝐙  j   normal-∣  X  normal-)     subscript  normal-E    i  j     fragments  normal-[   p   fragments  normal-(  Z  normal-,  X  normal-)   normal-]    constant    \ln q_{j}^{*}(\mathbf{Z}_{j}\mid\mathbf{X})=\operatorname{E}_{i\neq j}[\ln p(%
 \mathbf{Z},\mathbf{X})]+\text{constant}   .  Fill in the formula for the joint probability distribution using the graphical model. Any component conditional distributions that don't involve any of the variables in    𝐙  j     subscript  𝐙  j    \mathbf{Z}_{j}   can be ignored; they will be folded into the constant term.  Simplify the formula and apply the expectation operator, following the above example. Ideally, this should simplify into expectations of basic functions of variables not in    𝐙  j     subscript  𝐙  j    \mathbf{Z}_{j}   (e.g. first or second raw moments , expectation of a logarithm, etc.). In order for the variational Bayes procedure to work well, these expectations should generally be expressible analytically as functions of the parameters and/or hyperparameters of the distributions of these variables. In all cases, these expectation terms are constants with respect to the variables in the current partition.  The functional form of the formula with respect to the variables in the current partition indicates the type of distribution. In particular, exponentiating the formula generates the probability density function (PDF) of the distribution (or at least, something proportional to it, with unknown normalization constant ). In order for the overall method to be tractable, it should be possible to recognize the functional form as belonging to a known distribution. Significant mathematical manipulation may be required to convert the formula into a form that matches the PDF of a known distribution. When this can be done, the normalization constant can be reinstated by definition, and equations for the parameters of the known distribution can be derived by extracting the appropriate parts of the formula.  When all expectations can be replaced analytically with functions of variables not in the current partition, and the PDF put into a form that allows identification with a known distribution, the result is a set of equations expressing the values of the optimum parameters as functions of the parameters of variables in other partitions.  When this procedure can be applied to all partitions, the result is a set of mutually linked equations specifying the optimum values of all parameters.  An expectation maximization (EM) type procedure is then applied, picking an initial value for each parameter and the iterating through a series of steps, where at each step we cycle through the equations, updating each parameter in turn. This is guaranteed to converge.   Most important points  Due to all of the mathematical manipulations involved, it is easy to lose track of the big picture. The important things are:   The idea of variational Bayes is to construct an analytical approximation to the posterior probability of the set of unobserved variables (parameters and latent variables), given the data. This means that the form of the solution is similar to other Bayesian inference methods, such as Gibbs sampling — i.e. a distribution that seeks to describe everything that is known about the variables. As in other Bayesian methods — but unlike e.g. in expectation maximization (EM) or other maximum likelihood methods — both types of unobserved variables (i.e. parameters and latent variables) are treated the same, i.e. as random variables . Estimates for the variables can then be derived in the standard Bayesian ways, e.g. calculating the mean of the distribution to get a single point estimate or deriving a credible interval , highest density region, etc.  "Analytical approximation" means that a formula can be written down for the posterior distribution. The formula generally consists of a product of well-known probability distributions, each of which factorizes over a set of unobserved variables (i.e. it is conditionally independent of the other variables, given the observed data). This formula is not the true posterior distribution, but an approximation to it; in particular, it will generally agree fairly closely in the lowest moments of the unobserved variables, e.g. the mean and variance .  The result of all of the mathematical manipulations is (1) the identity of the probability distributions making up the factors, and (2) mutually dependent formulas for the parameters of these distributions. The actual values of these parameters are computed numerically, through an alternating iterative procedure much like EM.   Compared with expectation maximization (EM)  Variational Bayes (VB) is often compared with expectation maximization (EM). The actual numerical procedure is quite similar, in that both are alternating iterative procedures that successively converge on optimum parameter values. The initial steps to derive the respective procedures are also vaguely similar, both starting out with formulas for probability densities and both involving significant amounts of mathematical manipulations.  However, there are a number of differences. Most important is what is being computed.   EM computes point estimates of posterior distribution of those random variables that can be categorized as "parameters", but estimates of the actual posterior distributions of the latent variables (at least in "soft EM", and often only when the latent variables are discrete). The point estimates computed are the modes of these parameters; no other information is available.  VB, on the other hand, computes estimates of the actual posterior distribution of all variables, both parameters and latent variables. When point estimates need to be derived, generally the mean is used rather than the mode, as is normal in Bayesian inference. Concomitant with this, it should be noted that the parameters computed in VB do not have the same significance as those in EM. EM computes optimum values of the parameters of the Bayes network itself. VB computes optimum values of the parameters of the distributions used to approximate the parameters and latent variables of the Bayes network. For example, a typical Gaussian mixture model will have parameters for the mean and variance of each of the mixture components. EM would directly estimate optimum values for these parameters. VB, however, would first fit a distribution to these parameters — typically in the form of a prior distribution , e.g. a normal-scaled inverse gamma distribution — and would then compute values for the parameters of this prior distribution, i.e. essentially hyperparameters . In this case, VB would compute optimum estimates of the four parameters of the normal-scaled inverse gamma distribution that describes the joint distribution of the mean and variance of the component.   ==A more complex example==  Imagine a Bayesian Gaussian mixture model described as follows: 4     π   π   \displaystyle\mathbf{\pi}     Note:   SymDir() is the symmetric Dirichlet distribution of dimension   K   K   K   , with the hyperparameter for each component set to    α  0     subscript  α  0    \alpha_{0}   . The Dirichlet distribution is the conjugate prior of the categorical distribution or multinomial distribution .      𝒲   (  )       𝒲     \mathcal{W}()   is the Wishart distribution , which is the conjugate prior of the precision matrix (inverse covariance matrix ) for a multivariate Gaussian distribution .  Mult() is a multinomial distribution over a single observation (equivalent to a categorical distribution ). The state space is a "one-of-K" representation, i.e. a   K   K   K   -dimensional vector in which one of the elements is 1 (specifying the identity of the observation) and all other elements are 0.      𝒩   (  )       𝒩     \mathcal{N}()   is the Gaussian distribution , in this case specifically the multivariate Gaussian distribution .   The interpretation of the above variables is as follows:       𝐗  =   {   𝐱  1   ,  …  ,   𝐱  N   }       𝐗    subscript  𝐱  1   normal-…   subscript  𝐱  N      \mathbf{X}=\{\mathbf{x}_{1},\dots,\mathbf{x}_{N}\}   is the set of   N   N   N   data points, each of which is a   K   K   K   -dimensional vector distributed according to a multivariate Gaussian distribution .      𝐙  =   {   𝐳  1   ,  …  ,   𝐳  N   }       𝐙    subscript  𝐳  1   normal-…   subscript  𝐳  N      \mathbf{Z}=\{\mathbf{z}_{1},\dots,\mathbf{z}_{N}\}   is a set of latent variables, one per data point, specifying which mixture component the corresponding data point belongs to, using a "one-of-K" vector representation with components    z   n  k      subscript  z    n  k     z_{nk}   for    k  =   1  …  K       k    1  normal-…  K     k=1\dots K   , as described above.     π   π   \mathbf{\pi}   is the mixing proportions for the   K   K   K   mixture components.      μ   i  =   1  …  K       subscript  μ    i    1  normal-…  K      \mathbf{\mu}_{i=1\dots K}   and    𝚲   i  =   1  …  K       subscript  𝚲    i    1  normal-…  K      \mathbf{\Lambda}_{i=1\dots K}   specify the parameters ( mean and precision ) associated with each mixture component.   The joint probability of all variables can be rewritten as      p   (  𝐗  ,  𝐙  ,  π  ,  μ  ,  𝚲  )   =  p   (  𝐗  ∣  𝐙  ,  μ  ,  𝚲  )   p   (  𝐙  ∣  π  )   p   (  π  )   p   (  μ  ∣  𝚲  )   p   (  𝚲  )      fragments  p   fragments  normal-(  X  normal-,  Z  normal-,  π  normal-,  μ  normal-,  Λ  normal-)    p   fragments  normal-(  X  normal-∣  Z  normal-,  μ  normal-,  Λ  normal-)   p   fragments  normal-(  Z  normal-∣  π  normal-)   p   fragments  normal-(  π  normal-)   p   fragments  normal-(  μ  normal-∣  Λ  normal-)   p   fragments  normal-(  Λ  normal-)     p(\mathbf{X},\mathbf{Z},\mathbf{\pi},\mathbf{\mu},\mathbf{\Lambda})=p(\mathbf{%
 X}\mid\mathbf{Z},\mathbf{\mu},\mathbf{\Lambda})p(\mathbf{Z}\mid\mathbf{\pi})p(%
 \mathbf{\pi})p(\mathbf{\mu}\mid\mathbf{\Lambda})p(\mathbf{\Lambda})     where the individual factors are      p   (  𝐗  ∣  𝐙  ,  μ  ,  𝚲  )      fragments  p   fragments  normal-(  X  normal-∣  Z  normal-,  μ  normal-,  Λ  normal-)     \displaystyle p(\mathbf{X}\mid\mathbf{Z},\mathbf{\mu},\mathbf{\Lambda})     where      𝒩   (  𝐱  ∣  μ  ,  𝚺  )      fragments  N   fragments  normal-(  x  normal-∣  μ  normal-,  Σ  normal-)     \displaystyle\mathcal{N}(\mathbf{x}\mid\mathbf{\mu},\mathbf{\Sigma})     Assume that     q   (  𝐙  ,  π  ,  μ  ,  𝚲  )    =   q   (  𝐙  )   q   (  π  ,  μ  ,  𝚲  )          q   𝐙  π  μ  𝚲      q  𝐙  q   π  μ  𝚲      q(\mathbf{Z},\mathbf{\pi},\mathbf{\mu},\mathbf{\Lambda})=q(\mathbf{Z})q(%
 \mathbf{\pi},\mathbf{\mu},\mathbf{\Lambda})   .  Then       ln   q  *     (  𝐙  )          superscript  q     𝐙    \displaystyle\ln q^{*}(\mathbf{Z})     where we have defined       ln   ρ   n  k     =     E   [   ln   π  k    ]    +    1  2    E   [   ln   |   𝚲  k   |    ]      -    D  2    ln   (   2  π   )     -    1  2     E    μ  k   ,   𝚲  k      [     (    𝐱  n   -   μ  k    )   T    𝚲  k    (    𝐱  n   -   μ  k    )    ]             subscript  ρ    n  k          normal-E     subscript  π  k         1  2    normal-E       subscript  𝚲  k            D  2       2  π         1  2     subscript  normal-E    subscript  μ  k    subscript  𝚲  k        superscript     subscript  𝐱  n    subscript  μ  k    normal-T    subscript  𝚲  k      subscript  𝐱  n    subscript  μ  k          \ln\rho_{nk}=\operatorname{E}[\ln\pi_{k}]+\frac{1}{2}\operatorname{E}[\ln|%
 \mathbf{\Lambda}_{k}|]-\frac{D}{2}\ln(2\pi)-\frac{1}{2}\operatorname{E}_{%
 \mathbf{\mu}_{k},\mathbf{\Lambda}_{k}}[(\mathbf{x}_{n}-\mathbf{\mu}_{k})^{\rm T%
 }\mathbf{\Lambda}_{k}(\mathbf{x}_{n}-\mathbf{\mu}_{k})]     Exponentiating both sides of the formula for     ln   q  *     (  𝐙  )          superscript  q     𝐙    \ln q^{*}(\mathbf{Z})   yields        q  *    (  𝐙  )    ∝    ∏   n  =  1   N     ∏   k  =  1   K    ρ   n  k    z   n  k          proportional-to     superscript  q    𝐙     superscript   subscript  product    n  1    N     superscript   subscript  product    k  1    K    superscript   subscript  ρ    n  k     subscript  z    n  k         q^{*}(\mathbf{Z})\propto\prod_{n=1}^{N}\prod_{k=1}^{K}\rho_{nk}^{z_{nk}}     Requiring that this be normalized ends up requiring that the    ρ   n  k      subscript  ρ    n  k     \rho_{nk}   sum to 1 over all values of   k   k   k   , yielding        q  *    (  𝐙  )    =    ∏   n  =  1   N     ∏   k  =  1   K    r   n  k    z   n  k              superscript  q    𝐙     superscript   subscript  product    n  1    N     superscript   subscript  product    k  1    K    superscript   subscript  r    n  k     subscript  z    n  k         q^{*}(\mathbf{Z})=\prod_{n=1}^{N}\prod_{k=1}^{K}r_{nk}^{z_{nk}}     where       r   n  k    =    ρ   n  k      ∑   j  =  1   K    ρ   n  j           subscript  r    n  k       subscript  ρ    n  k      superscript   subscript     j  1    K    subscript  ρ    n  j        r_{nk}=\frac{\rho_{nk}}{\sum_{j=1}^{K}\rho_{nj}}     In other words,     q  *    (  𝐙  )        superscript  q    𝐙    q^{*}(\mathbf{Z})   is a product of single-observation multinomial distributions , and factors over each individual    𝐳  n     subscript  𝐳  n    \mathbf{z}_{n}   , which is distributed as a single-observation multinomial distribution with parameters    r   n  k      subscript  r    n  k     r_{nk}   for    k  =   1  …  K       k    1  normal-…  K     k=1\dots K   .  Furthermore, we note that       E   [   z   n  k    ]    =    r   n  k          normal-E   subscript  z    n  k      subscript  r    n  k      \operatorname{E}[z_{nk}]=r_{nk}\,     which is a standard result for categorical distributions.  Now, considering the factor    q   (  π  ,  μ  ,  𝚲  )       q   π  μ  𝚲     q(\mathbf{\pi},\mathbf{\mu},\mathbf{\Lambda})   , note that it automatically factors into    q   (  π  )     ∏   k  =  1   K    q   (   μ  k   ,   𝚲  k   )         q  π    superscript   subscript  product    k  1    K     q    subscript  μ  k    subscript  𝚲  k        q(\mathbf{\pi})\prod_{k=1}^{K}q(\mathbf{\mu}_{k},\mathbf{\Lambda}_{k})   due to the structure of the graphical model defining our Gaussian mixture model, which is specified above.  Then,       ln   q  *     (  π  )          superscript  q     π    \displaystyle\ln q^{*}(\mathbf{\pi})     Taking the exponential of both sides, we recognize     q  *    (  π  )        superscript  q    π    q^{*}(\mathbf{\pi})   as a Dirichlet distribution        q  *    (  π  )    ∼   Dir   (  α  )       similar-to     superscript  q    π    Dir  α     q^{*}(\mathbf{\pi})\sim\operatorname{Dir}(\mathbf{\alpha})\,     where       α  k   =    α  0   +    N  k          subscript  α  k      subscript  α  0    subscript  N  k      \alpha_{k}=\alpha_{0}+N_{k}\,     where       N  k   =    ∑   n  =  1   N     r   n  k           subscript  N  k     superscript   subscript     n  1    N    subscript  r    n  k       N_{k}=\sum_{n=1}^{N}r_{nk}\,     Finally      ln   q  *    (   μ  k   ,   𝚲  k   )   =  ln  p   (   μ  k   ,   𝚲  k   )   +   ∑   n  =  1   N   E   [   z   n  k    ]   ln  𝒩   (   𝐱  n   ∣   μ  k   ,   𝚲  k   -  1    )   +  constant     fragments    superscript  q     fragments  normal-(   subscript  μ  k   normal-,   subscript  𝚲  k   normal-)     p   fragments  normal-(   subscript  μ  k   normal-,   subscript  𝚲  k   normal-)     superscript   subscript     n  1    N   normal-E   fragments  normal-[   subscript  z    n  k    normal-]    N   fragments  normal-(   subscript  𝐱  n   normal-∣   subscript  μ  k   normal-,   superscript   subscript  𝚲  k     1    normal-)    constant    \ln q^{*}(\mathbf{\mu}_{k},\mathbf{\Lambda}_{k})=\ln p(\mathbf{\mu}_{k},%
 \mathbf{\Lambda}_{k})+\sum_{n=1}^{N}\operatorname{E}[z_{nk}]\ln\mathcal{N}(%
 \mathbf{x}_{n}\mid\mathbf{\mu}_{k},\mathbf{\Lambda}_{k}^{-1})+\text{constant}     Grouping and reading off terms involving    μ  k     subscript  μ  k    \mathbf{\mu}_{k}   and    𝚲  k     subscript  𝚲  k    \mathbf{\Lambda}_{k}   , the result is a Gaussian-Wishart distribution given by       q  *    (   μ  k   ,   𝚲  k   )   =  𝒩   (   μ  k   ∣   𝐦  k   ,    (   β  k    𝚲  k   )    -  1    )   𝒲   (   𝚲  k   ∣   𝐖  k   ,   ν  k   )      fragments   superscript  q     fragments  normal-(   subscript  μ  k   normal-,   subscript  𝚲  k   normal-)    N   fragments  normal-(   subscript  μ  k   normal-∣   subscript  𝐦  k   normal-,   superscript   fragments  normal-(   subscript  β  k    subscript  𝚲  k   normal-)     1    normal-)   W   fragments  normal-(   subscript  𝚲  k   normal-∣   subscript  𝐖  k   normal-,   subscript  ν  k   normal-)     q^{*}(\mathbf{\mu}_{k},\mathbf{\Lambda}_{k})=\mathcal{N}(\mathbf{\mu}_{k}\mid%
 \mathbf{m}_{k},(\beta_{k}\mathbf{\Lambda}_{k})^{-1})\mathcal{W}(\mathbf{%
 \Lambda}_{k}\mid\mathbf{W}_{k},\nu_{k})     given the definitions      β  k     subscript  β  k    \displaystyle\beta_{k}     Finally, notice that these functions require the values of    r   n  k      subscript  r    n  k     r_{nk}   , which make use of    ρ   n  k      subscript  ρ    n  k     \rho_{nk}   , which is defined in turn based on    E   [   ln   π  k    ]      normal-E     subscript  π  k      \operatorname{E}[\ln\pi_{k}]   ,    E   [   ln   |   𝚲  k   |    ]      normal-E       subscript  𝚲  k       \operatorname{E}[\ln|\mathbf{\Lambda}_{k}|]   , and     E    μ  k   ,   𝚲  k      [     (    𝐱  n   -   μ  k    )   T    𝚲  k    (    𝐱  n   -   μ  k    )    ]       subscript  normal-E    subscript  μ  k    subscript  𝚲  k        superscript     subscript  𝐱  n    subscript  μ  k    normal-T    subscript  𝚲  k      subscript  𝐱  n    subscript  μ  k       \operatorname{E}_{\mathbf{\mu}_{k},\mathbf{\Lambda}_{k}}[(\mathbf{x}_{n}-%
 \mathbf{\mu}_{k})^{\rm T}\mathbf{\Lambda}_{k}(\mathbf{x}_{n}-\mathbf{\mu}_{k})]   . Now that we have determined the distributions over which these expectations are taken, we can derive formulas for them:       E    μ  k   ,   𝚲  k      [     (    𝐱  n   -   μ  k    )   T    𝚲  k    (    𝐱  n   -   μ  k    )    ]       subscript  normal-E    subscript  μ  k    subscript  𝚲  k        superscript     subscript  𝐱  n    subscript  μ  k    normal-T    subscript  𝚲  k      subscript  𝐱  n    subscript  μ  k       \displaystyle\operatorname{E}_{\mathbf{\mu}_{k},\mathbf{\Lambda}_{k}}[(\mathbf%
 {x}_{n}-\mathbf{\mu}_{k})^{\rm T}\mathbf{\Lambda}_{k}(\mathbf{x}_{n}-\mathbf{%
 \mu}_{k})]     These results lead to       r   n  k    ∝     π  ~   k     Λ  ~   k   1  /  2     exp   {    -   D   2   β  k      -     ν  k   2     (    𝐱  n   -   𝐦  k    )   T    𝐖  k    (    𝐱  n   -   𝐦  k    )     }        proportional-to   subscript  r    n  k       subscript   normal-~  π   k    superscript   subscript   normal-~  normal-Λ   k     1  2            D    2   subscript  β  k           subscript  ν  k   2    superscript     subscript  𝐱  n    subscript  𝐦  k    normal-T    subscript  𝐖  k      subscript  𝐱  n    subscript  𝐦  k          r_{nk}\propto{\tilde{\pi}}_{k}{\tilde{\Lambda}}_{k}^{1/2}\exp\left\{-\frac{D}{%
 2\beta_{k}}-\frac{\nu_{k}}{2}(\mathbf{x}_{n}-\mathbf{m}_{k})^{\rm T}\mathbf{W}%
 _{k}(\mathbf{x}_{n}-\mathbf{m}_{k})\right\}     These can be converted from proportional to absolute values by normalizing over   k   k   k   so that the corresponding values sum to 1.  Note that:   The update equations for the parameters    β  k     subscript  β  k    \beta_{k}   ,    𝐦  k     subscript  𝐦  k    \mathbf{m}_{k}   ,    𝐖  k     subscript  𝐖  k    \mathbf{W}_{k}   and    ν  k     subscript  ν  k    \nu_{k}   of the variables    μ  k     subscript  μ  k    \mathbf{\mu}_{k}   and    𝚲  k     subscript  𝚲  k    \mathbf{\Lambda}_{k}   depend on the statistics    N  k     subscript  N  k    N_{k}   ,     𝐱  ¯   k     subscript   normal-¯  𝐱   k    {\bar{\mathbf{x}}}_{k}   , and    𝐒  k     subscript  𝐒  k    \mathbf{S}_{k}   , and these statistics in turn depend on    r   n  k      subscript  r    n  k     r_{nk}   .  The update equations for the parameters    α   1  …  K      subscript  α    1  normal-…  K     \alpha_{1\dots K}   of the variable   π   π   \mathbf{\pi}   depend on the statistic    N  k     subscript  N  k    N_{k}   , which depends in turn on    r   n  k      subscript  r    n  k     r_{nk}   .  The update equation for    r   n  k      subscript  r    n  k     r_{nk}   has a direct circular dependence on    β  k     subscript  β  k    \beta_{k}   ,    𝐦  k     subscript  𝐦  k    \mathbf{m}_{k}   ,    𝐖  k     subscript  𝐖  k    \mathbf{W}_{k}   and    ν  k     subscript  ν  k    \nu_{k}   as well as an indirect circular dependence on    𝐖  k     subscript  𝐖  k    \mathbf{W}_{k}   ,    ν  k     subscript  ν  k    \nu_{k}   and    α   1  …  K      subscript  α    1  normal-…  K     \alpha_{1\dots K}   through     π  ~   k     subscript   normal-~  π   k    {\tilde{\pi}}_{k}   and     Λ  ~   k     subscript   normal-~  normal-Λ   k    {\tilde{\Lambda}}_{k}   .   This suggests an iterative procedure that alternates between two steps:   An E-step that computes the value of    r   n  k      subscript  r    n  k     r_{nk}   using the current values of all the other parameters.  An M-step that uses the new value of    r   n  k      subscript  r    n  k     r_{nk}   to compute new values of all the other parameters.   Note that these steps correspond closely with the standard EM algorithm to derive a maximum likelihood or maximum a posteriori (MAP) solution for the parameters of a Gaussian mixture model . The responsibilities    r   n  k      subscript  r    n  k     r_{nk}   in the E step correspond closely to the posterior probabilities of the latent variables given the data, i.e.    p   (  𝐙  ∣  𝐗  )      fragments  p   fragments  normal-(  Z  normal-∣  X  normal-)     p(\mathbf{Z}\mid\mathbf{X})   ; the computation of the statistics    N  k     subscript  N  k    N_{k}   ,     𝐱  ¯   k     subscript   normal-¯  𝐱   k    {\bar{\mathbf{x}}}_{k}   , and    𝐒  k     subscript  𝐒  k    \mathbf{S}_{k}   corresponds closely to the computation of corresponding "soft-count" statistics over the data; and the use of those statistics to compute new values of the parameters corresponds closely to the use of soft counts to compute new parameter values in normal EM over a Gaussian mixture model.  Exponential-family distributions  Note that in the previous example, once the distribution over unobserved variables was assumed to factorize into distributions over the "parameters" and distributions over the "latent data", the derived "best" distribution for each variable was in the same family as the corresponding prior distribution over the variable. This is a general result that holds true for all prior distributions derived from the exponential family .  See also   Variational message passing : a modular algorithm for variational Bayesian inference.  Expectation-maximization algorithm : a related approach which corresponds to a special case of variational Bayesian inference.  Generalized filtering : a variational filtering scheme for nonlinear state space models.  Calculus of variations : the field of mathematical analysis that deals with maximizing or minimizing functionals.   Notes  References     External links   Variational-Bayes Repository A repository of papers, software, and links related to the use of variational methods for approximate Bayesian learning  The on-line textbook: Information Theory, Inference, and Learning Algorithms , by David J.C. MacKay provides an introduction to variational methods (p. 422).  Variational Algorithms for Approximate Bayesian Inference , by M. J. Beal includes comparisons of EM to Variational Bayesian EM and derivations of several models including Variational Bayesian HMMs.  A Tutorial on Variational Bayes . Fox, C. and Roberts, S. 2012. Artificial Intelligence Review, .  High-Level Explanation of Variational Inference by Jason Eisner may be worth reading before a more mathematically detailed treatment.   "  Category:Bayesian statistics     ↩  Christopher Bishop, Pattern Recognition and Machine Learning , 2006 ↩  Based on Chapter 10 of Pattern Recognition and Machine Learning by Christopher M. Bishop ↩  Based on Chapter 10 of Pattern Recognition and Machine Learning by Christopher M. Bishop ↩     
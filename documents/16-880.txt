   Surface hopping      Surface hopping   Surface hopping is a semi-classical technique that incorporates quantum mechanical effects into molecular dynamics simulations. 1 2 3 4 Traditional approaches propagate the dynamics only on one surface. However, quantum mechanics predicts that the dynamics happen on all the surfaces simultaneously. Surface hopping incorporates the effect of other surfaces by allowing for 'hops' between the surfaces, subject to certain criteria. This method is particularly useful when the Born-Oppenheimer approximation breaks down in certain regions, particularly conical intersections and avoided crossings .  Motivation  Molecular dynamics simulations numerically solve the classical equations of motion. These simulations, though, ignore the effects of zero-point energy , quantum interference , and quantum tunneling . 5 Solving the time-dependent SchrÃ¶dinger equation numerically incorporates all these effects, but is computationally unfeasible when the system has many degrees of freedom. To tackle this issue, one approach is the mean field or Ehrenfest method, where the molecular dynamics is run on the average potential energy surface given by a linear combination of the adiabatic states. This was applied successfully for some applications, but has some important limitations. When the difference between the adiabatic states is large, then the dynamics must be primarily driven by only one surface, and not an average potential. In addition, this method also violates the principle of microscopic reversibility. 6  Surface hopping accounts for these limitations by propagating an ensemble of trajectories, each one of them on a single adiabatic surface at any given time. The trajectories are allowed to 'hop' between various adiabatic states at certain times such that the quantum amplitudes for the adiabatic states follow the time dependent SchrÃ¶dinger equation. The probability of these hops are dependent on the coupling between the states, and is generally significant only in the regions where the difference between adiabatic energies is small.  Theory behind the method  The formulation described here is in the adiabatic representation for simplicity. 7 It can easily be generalized to a different representation. The coordinates of the system is divided into two categories: quantum (   ğª   ğª   \mathbf{q}   ) and classical (   ğ‘   ğ‘   \mathbf{R}   ). The Hamiltonian of the quantum degrees of freedom with mass     m  i     subscript  m  i    m_{i}   is defined as:      H  =     âˆ‘  i   -     â„  2    2   m  i      âˆ‡   q  i   2     +   V   (  ğª  ,  ğ‘  )         H       subscript   i        superscript  Planck-constant-over-2-pi  2     2   subscript  m  i      superscript   subscript  normal-âˆ‡   subscript  q  i    2       V   ğª  ğ‘       H=\sum_{i}-\frac{\hbar^{2}}{2m_{i}}\nabla_{q_{i}}^{2}+V(\mathbf{q},\mathbf{R})   , where   V   V   V   describes the potential for the whole system. The eigenvalues of   H   H   H   as a function of   ğ‘   ğ‘   \mathbf{R}   are called the adiabatic surfaces     Ï•  i    (  ğª  ;  ğ‘  )        subscript  Ï•  i    ğª  ğ‘     \phi_{i}(\mathbf{q};\mathbf{R})   . Typically,   ğª   ğª   \mathbf{q}   corresponds to the electronic degree of freedom, light atoms such as hydrogen , or high frequency vibrations such as O-H stretch. The forces in the molecular dynamics simulations are derived only from one adiabatic surface, and are given by:      ğ…  ğ‘     subscript  ğ…  ğ‘    \displaystyle\mathbf{F}_{\mathbf{R}}   where i represents the chosen adiabatic surface. The last equation is derived using Hellmann-Feynman theorem . The brackets denote the integral is done only over the quantum degrees of freedom. Choosing only one adiabatic surface is an excellent approximation if the difference between the adiabatic surfaces is large for energetically accessible regions of   ğ‘   ğ‘   \mathbf{R}   . When this is not the case, the effect of the other states become important. This effect is incorporated in the surface hopping algorithm by considering the wavefunction of the quantum degrees of freedom at time t as an expansion in the adiabatic basis:       Ïˆ   (  ğª  ;  ğ‘  ,  t  )    =    âˆ‘  n     c  n    (  t  )    Ï•  n    (  ğª  ;  ğ‘  )           Ïˆ   ğª  ğ‘  t      subscript   n      subscript  c  n   t   subscript  Ï•  n    ğª  ğ‘       \psi(\mathbf{q};\mathbf{R},t)=\sum_{n}c_{n}(t)\phi_{n}(\mathbf{q};\mathbf{R})   , where     c  n    (  t  )        subscript  c  n   t    c_{n}(t)   are the expansion coefficients. Substituting the above equation into the time dependent SchrÃ¶dinger equation gives      i  â„    c  j   Ë™   =   âˆ‘  n    c  n    (   V   j  n    -  i  â„   ğ‘  Ë™   .   ğ   j  n    )      fragments  i  Planck-constant-over-2-pi   normal-Ë™   subscript  c  j      subscript   n    subscript  c  n    fragments  normal-(   subscript  V    j  n     i  Planck-constant-over-2-pi   normal-Ë™  ğ‘   normal-.   subscript  ğ    j  n    normal-)     i\hbar\dot{c_{j}}=\sum_{n}c_{n}\left(V_{jn}-i\hbar\dot{\mathbf{R}}.\mathbf{d}_%
 {jn}\right)   , where    V   j  n      subscript  V    j  n     V_{jn}   and the nonadiabatic coupling vector     ğ   j  n      subscript  ğ    j  n     \mathbf{d}_{jn}   are given by      V   j  n      subscript  V    j  n     \displaystyle V_{jn}   The adiabatic surface can switch at any given time t based on how the quantum probabilities     |    c  j    (  t  )    |   2     superscript       subscript  c  j   t    2    |c_{j}(t)|^{2}   are changing with time. The rate of change of     |    c  j    (  t  )    |   2     superscript       subscript  c  j   t    2    |c_{j}(t)|^{2}   is given by:         |    c  j    (  t  )    |   2   Ë™   =   âˆ‘  n    2  â„   I  m   (   a   n  j     V   j  n    )   -  2  R  e   (   a   n  j     ğ‘  Ë™   .   ğ   j  n    )      fragments   normal-Ë™   superscript       subscript  c  j   t    2      subscript   n     2  Planck-constant-over-2-pi   I  m   fragments  normal-(   subscript  a    n  j     subscript  V    j  n    normal-)    2  R  e   fragments  normal-(   subscript  a    n  j     normal-Ë™  ğ‘   normal-.   subscript  ğ    j  n    normal-)     \dot{|c_{j}(t)|^{2}}=\sum_{n}\frac{2}{\hbar}Im(a_{nj}V_{jn})-2Re(a_{nj}\dot{%
 \mathbf{R}}.\mathbf{d}_{jn})   , where     a   n  j    =    c  n    c  j  *         subscript  a    n  j       subscript  c  n    superscript   subscript  c  j        a_{nj}=c_{n}c_{j}^{*}   . For a small time interval dt, the fractional change in     |    c  j    (  t  )    |   2     superscript       subscript  c  j   t    2    |c_{j}(t)|^{2}   is given by          |    c  j    (   t  +   d  t    )    |   2   -    |    c  j    (  t  )    |   2      |    c  j    (  t  )    |   2    â‰ˆ    d  t    a   j  j      âˆ‘  n    2  â„   I  m   (   a   n  j     V   j  n    )   -  2  R  e   (   a   n  j     ğ‘  Ë™   .   ğ   j  n    )      fragments       superscript       subscript  c  j     t    d  t      2    superscript       subscript  c  j   t    2     superscript       subscript  c  j   t    2         d  t    subscript  a    j  j      subscript   n     2  Planck-constant-over-2-pi   I  m   fragments  normal-(   subscript  a    n  j     subscript  V    j  n    normal-)    2  R  e   fragments  normal-(   subscript  a    n  j     normal-Ë™  ğ‘   normal-.   subscript  ğ    j  n    normal-)     \frac{|c_{j}(t+dt)|^{2}-|c_{j}(t)|^{2}}{|c_{j}(t)|^{2}}\approx\frac{dt}{a_{jj}%
 }\sum_{n}\frac{2}{\hbar}Im(a_{nj}V_{jn})-2Re(a_{nj}\dot{\mathbf{R}}.\mathbf{d}%
 _{jn})   . This gives the net change in flux of population from state   j   j   j   . Based on this, the probability of hopping from state j to n is proposed to be       P   j  â†’  n    =    d  t    a   j  j      (   2  â„   I  m   (   a   n  j     V   j  n    )   -  2  R  e   (   a   n  j     ğ‘  Ë™   .   ğ   j  n    )   )      fragments   subscript  P   normal-â†’  j  n         d  t    subscript  a    j  j      fragments  normal-(    2  Planck-constant-over-2-pi   I  m   fragments  normal-(   subscript  a    n  j     subscript  V    j  n    normal-)    2  R  e   fragments  normal-(   subscript  a    n  j     normal-Ë™  ğ‘   normal-.   subscript  ğ    j  n    normal-)   normal-)     P_{j\to n}=\frac{dt}{a_{jj}}\left(\frac{2}{\hbar}Im(a_{nj}V_{jn})-2Re(a_{nj}%
 \dot{\mathbf{R}}.\mathbf{d}_{jn})\right)   . This criteria is known as the "fewest switching" algorithm, as it minimizes the number of hops required to maintain the population in various adiabatic states.  Whenever a hop takes place, the velocity is adjusted to maintain conservation of energy . To compute the direction of the change in velocity, the nuclear forces in the transition is      <   Ï•  j   |    âˆ‡  ğ‘   H   |   Ï•  n   >     quantum-operator-product   subscript  Ï•  j     subscript  normal-âˆ‡  ğ‘   H    subscript  Ï•  n     \displaystyle<\phi_{j}|\nabla_{\mathbf{R}}H|\phi_{n}>   where     E  j   =   <   Ï•  j   |  H  |   Ï•  j   >        subscript  E  j    quantum-operator-product   subscript  Ï•  j   H   subscript  Ï•  j      E_{j}=<\phi_{j}|H|\phi_{j}>   is the eigen value. For the last equality,     d   j  n    =   -   d   n  j          subscript  d    j  n       subscript  d    n  j       d_{jn}=-d_{nj}   is used. This shows that the nuclear forces acting during the hop are in the direction of the nonadiabatic coupling vector    ğ   j  n      subscript  ğ    j  n     \mathbf{d}_{jn}   . Hence    ğ   j  n      subscript  ğ    j  n     \mathbf{d}_{jn}   is a reasonable choice for the direction along which velocity should be changed.  Frustrated Hops  If the velocity reduction required to conserve energy while making a hop is greater than the component of the velocity to be adjusted, then the hop is known as frustrated. In other words, a hop is frustrated if the system does not have enough energy to make the hop. Several approaches have been suggested to deal with these frustrated hops. The simplest of these is to ignore these hops. 8 Another suggestion is not to change the adiabatic state, but reverse the direction of the component of the velocity along the nonadiabatic coupling vector. 9 Yet another approach is to allow the hop to happen if an allowed hopping point is reachable within uncertainty time      Î´  t   =    â„  /  2   Î”  E         Î´  t       Planck-constant-over-2-pi  2   normal-Î”  E     \delta t=\hbar/2\Delta E   , where    Î”  E      normal-Î”  E    \Delta E   is the extra energy that the system needed to make the hop possible. 10  Decoherence Time  Surface hopping can develop nonphysical coherence between the quantum coefficients over large time. To eliminate this, the quantum coefficient is set to 1 for the current state (and zero for the rest of the states) after a predefined time has elapsed after the trajectory crosses the region where hopping has high probabilities. 11  Outline of the algorithm  The state of the system at any time   t   t   t   is given by the phase space of all the classical particles, the quantum amplitudes, and the adiabatic state. The simulation broadly consists of the following steps:  Step 1. Initialize the state of the system. The classical positions and velocities are chosen based on the ensemble required.  Step 2. Compute forces using Hellmann-Feynman theorem, and integrate the equations of motion by time step    Î”  t      normal-Î”  t    \Delta t   to obtain the classical phase space at time    t  +   Î”  t       t    normal-Î”  t     t+\Delta t   .  Step 3. Integrate the SchrÃ¶dinger equation to evolve quantum amplitudes from time   t   t   t   to    t  +   Î”  t       t    normal-Î”  t     t+\Delta t   in increments of    Î´  t      Î´  t    \delta t   . This time step    Î´  t      Î´  t    \delta t   is typically much smaller than    Î”  t      normal-Î”  t    \Delta t   .  Step 4. Compute probability of hopping from current state to all other states. Generate a random number, and determine whether a switch should take place. If a switch does occur, change velocities to conserve energy. Go back to step 2, till trajectories have been evolved for the desired time.  Applications  The method has been applied successfully to understand dynamics of systems that include tunneling, conical intersections and electronic excitation . 12  13  Limitations  Most of the critique of the surface hopping method comes from the separation of classical and quantum degrees of freedom. This ignores the entanglement between these degrees of freedom. Moreover, this method is computationally feasible only for a limited number of quantum degrees of freedom. In addition, the trajectories must have enough energy to be able to reach the regions where probability of hopping is large.  See Also   Molecular Dynamics  Computational Chemistry  Quantum Chemistry  Path Integral Molecular Dynamics   References  External Links   Newton-X: A package for Newtonian dynamics close to the crossing seam.  Movie examples of surface hopping.   "  Category:Quantum mechanics  Category:Molecular dynamics                     
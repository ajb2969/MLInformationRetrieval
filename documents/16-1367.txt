   Multidimensional Filter Design      Multidimensional Filter Design   Many concepts in 1-D signal processing are similar to concepts in multidimensional signal processing. However, many familiar one-dimensional procedures do not readily generalize to the multidimensional case and some important issues associated with multidimensional signals and systems do not appear in the one-dimensional special case.  Motivation and applications  A multidimensional (M-D) signal can be modeled as a function of   M   M   M    independent variables , where   M   M   M   is greater than or equal to 2. These signals may be categorized as continuous, discrete, or mixed. A continuous signal can be modeled as a function of independent variables which range over a continuum of values, example – an audio wave travelling in space. A discrete signal , on the other hand, can be modeled as a function defined only on a set of points, such as the set of integers. A mixed signal is a multidimensional signal that is modeled as a function of some continuous variables and some discrete ones, example – an ensemble of time waveforms recorded from an array of electrical transducers is a mixed signal. The ensemble can be modeled with one continuous variable, time, and one or more discrete variables to index the transducers.  Filtering of M-D signals is required in several day to day applications, like image processing , video signal filtering , computational tomography (CT) and many more. M-D filter mathematics can also be used in grid methods for solving partial differential equations , distributed control , and iterative learning control. The design and implementation of M-D filters are generally more complicated than the design and implementation of 1-D filters.  Problem Statement & Basic Concepts  Usual time domain or one-dimensional filtering is causal, i.e. there is a preferred direction in the one-dimension. However, for many multi-dimensional signals, there is no preferred direction for the coordinates, which often represent spatial coordinates, and not time. Thus non-causal filters are often employed in multi-dimensional signal processing.  (Figure)  design   A Finite Impulse Response (FIR), or non-recursive filter has an impulse response with a finite number of non-zero samples. This makes their impulse response always absolutely summable and thus FIR filters are always stable.    x   (   n  ¯   )       x   normal-¯  n     x\left(\underline{n}\right)   is the multidimensional input signal and    y   (   n  ¯   )       y   normal-¯  n     y\left(\underline{n}\right)   is the multidimensional output signal. For a   m   m   m   dimensional spatial domain, the output   y   y   y   can be represented as       y   (   n  1   ,   n  2   ,  …  ,   n  m   )    =    ∑    l  1   =  0     L  1   -  1      ∑    l  2   =  0     L  2   -  1     …    ∑    l  m   =  0     L  m   -  1     b   (   l  1   ,   l  2   ,  …  ,   l  m   )   x   (    n  1   -   l  1    ,    n  2   -   l  2    ,  …  ,    n  m   -   l  m    )              y    subscript  n  1    subscript  n  2   normal-…   subscript  n  m       superscript   subscript      subscript  l  1   0       subscript  L  1   1      superscript   subscript      subscript  l  2   0       subscript  L  2   1      normal-…    superscript   subscript      subscript  l  m   0       subscript  L  m   1      b    subscript  l  1    subscript  l  2   normal-…   subscript  l  m    x      subscript  n  1    subscript  l  1       subscript  n  2    subscript  l  2    normal-…     subscript  n  m    subscript  l  m            y\left(n_{1},n_{2},...,n_{m}\right)=\sum_{l_{1}=0}^{L_{1}-1}\sum_{l_{2}=0}^{L_%
 {2}-1}...\sum_{l_{m}=0}^{L_{m}-1}b(l_{1},l_{2},...,l_{m})x(n_{1}-l_{1},n_{2}-l%
 _{2},...,n_{m}-l_{m})     (Figure)  filter design   An Infinite Impulse Response (IIR), or recursive filter (due to feedback) has infinite impulse response. Its input and output satisfy a multidimensional difference equation of finite order. IIR filters may or may not be stable and in many cases are less complex to realize when compared to FIR filters. For a   m   m   m   dimensional domain, the output   y   y   y   can be represented as       y   (   n  1   ,   n  2   ,  …  ,   n  m   )    =     ∑    l  1   =  0     L  1   -  1      ∑    l  2   =  0     L  2   -  1     …    ∑    l  m   =  0     L  m   -  1     b   (   l  1   ,   l  2   ,  …  ,   l  m   )   x   (    n  1   -   l  1    ,    n  2   -   l  2    ,  …  ,    n  m   -   l  m    )        -    ∑    m  1   =  0     M  1   -  1      ∑    m  2   =  0     M  2   -  1     …    ∑    m  m   =  0     M  m   -  1     a   (   m  1   ,   m  2   ,  …  ,   m  m   )   y   (    n  1   -   m  1    ,    n  2   -   m  2    ,  …  ,    n  m   -   m  m    )               y    subscript  n  1    subscript  n  2   normal-…   subscript  n  m         superscript   subscript      subscript  l  1   0       subscript  L  1   1      superscript   subscript      subscript  l  2   0       subscript  L  2   1      normal-…    superscript   subscript      subscript  l  m   0       subscript  L  m   1      b    subscript  l  1    subscript  l  2   normal-…   subscript  l  m    x      subscript  n  1    subscript  l  1       subscript  n  2    subscript  l  2    normal-…     subscript  n  m    subscript  l  m            superscript   subscript      subscript  m  1   0       subscript  M  1   1      superscript   subscript      subscript  m  2   0       subscript  M  2   1      normal-…    superscript   subscript      subscript  m  m   0       subscript  M  m   1      a    subscript  m  1    subscript  m  2   normal-…   subscript  m  m    y      subscript  n  1    subscript  m  1       subscript  n  2    subscript  m  2    normal-…     subscript  n  m    subscript  m  m             y\left(n_{1},n_{2},...,n_{m}\right)=\sum_{l_{1}=0}^{L_{1}-1}\sum_{l_{2}=0}^{L_%
 {2}-1}...\sum_{l_{m}=0}^{L_{m}-1}b(l_{1},l_{2},...,l_{m})x(n_{1}-l_{1},n_{2}-l%
 _{2},...,n_{m}-l_{m})-\sum_{m_{1}=0}^{M_{1}-1}\sum_{m_{2}=0}^{M_{2}-1}...\sum_%
 {m_{m}=0}^{M_{m}-1}a(m_{1},m_{2},...,m_{m})y(n_{1}-m_{1},n_{2}-m_{2},...,n_{m}%
 -m_{m})     Implementable FIR filters can be designed to have purely real frequency responses (such filters are said to be zero-phase). It is possible for FIR filters to always have linear phase, which is difficult to control for IIR filters. IIR filters can have limit cycles, whereas FIR filters do not. IIR filters can be designed to simulate classical analog filter responses such as Butterworth filter, Chebyshev I, II filter, while FIR filters cannot achieve it.  Existing Approaches for FIR Filter Design  Direct Convolution 1  Linear Shift Invariant (LSI) filter’s output can be determined from its input by means of the convolution sum. There are a finite number of non-zero samples and the limits of summation are finite for a FIR filter. The convolution sum serves as an algorithm that enables us to compute the successive output samples of the filter. As an example, let is assume that the filter has support over the region {(    n  1     subscript  n  1    n_{1}   ,    n  2     subscript  n  2    n_{2}   ,...,    n  m     subscript  n  m    n_{m}   )   0   0    ≤    n  1     subscript  n  1    n_{1}   N_1 ,   0   0    ≤    n  2     subscript  n  2    n_{2}   N_2,...,   0   0    ≤    n  m     subscript  n  m    n_{m}   N_m }, the output samples can be computed using       y   (   n  1   ,   n  2   ,  …  ,   n  m   )    =    ∑    k  1   =  0     N  1   -  1      ∑    k  2   =  0     N  2   -  1     …    ∑    k  m   =  0     N  m   -  1     h   (   k  1   ,   k  2   ,  …  ,   k  m   )   x   (    n  1   -   k  1    ,    n  2   -   k  2    ,  …  ,    n  m   -   k  m    )              y    subscript  n  1    subscript  n  2   normal-…   subscript  n  m       superscript   subscript      subscript  k  1   0       subscript  N  1   1      superscript   subscript      subscript  k  2   0       subscript  N  2   1      normal-…    superscript   subscript      subscript  k  m   0       subscript  N  m   1      h    subscript  k  1    subscript  k  2   normal-…   subscript  k  m    x      subscript  n  1    subscript  k  1       subscript  n  2    subscript  k  2    normal-…     subscript  n  m    subscript  k  m            y\left(n_{1},n_{2},...,n_{m}\right)=\sum_{k_{1}=0}^{N_{1}-1}\sum_{k_{2}=0}^{N_%
 {2}-1}...\sum_{k_{m}=0}^{N_{m}-1}h(k_{1},k_{2},...,k_{m})x(n_{1}-k_{1},n_{2}-k%
 _{2},...,n_{m}-k_{m})     If all input samples are available, the output samples can be computed in any order or can also be computed simultaneously. However, if only selected samples of the output are desired, only those samples need to be computed. The number of multiplications and additions for one desired output sample is (    N  1     subscript  N  1    N_{1}   .    N  2     subscript  N  2    N_{2}   ...    N  m     subscript  N  m    N_{m}   ) and (    N  1     subscript  N  1    N_{1}   .    N  2     subscript  N  2    N_{2}   ...    N  m     subscript  N  m    N_{m}   )–   1   1   1   respectively.  For the 2D case, the computation of    y   (   n  1   ,   n  2   )       y    subscript  n  1    subscript  n  2      y\left(n_{1},n_{2}\right)   depends on input samples from (    N  1     subscript  N  1    N_{1}   –   1   1   1   ) previous columns of the input and the (    N  2     subscript  N  2    N_{2}   –   1   1   1   ) previous rows. If the input samples arrive row by row, we need sufficient storage to store    N  2     subscript  N  2    N_{2}   rows of the input sequence. If the input is available column by column instead, we need to store    N  1     subscript  N  1    N_{1}   columns of the input. A zero phase filter with a real impulse response satisfies    h   (   n  1   ,   n  2   )       h    subscript  n  1    subscript  n  2      h\left(n_{1},n_{2}\right)   =    h   (   -   n  1    ,   -   n  2    )       h      subscript  n  1       subscript  n  2       h\left(-n_{1},-n_{2}\right)   , which means that each sample can be paired with another of identical value. In this case we can use the arithmetic distributive law to interchange some of the multiplications and additions, to reduce the number of multiplications necessary to implement the filter, but the number of multiplications is still proportional to the filter order. Specifically, if the region of support for the filter is assumed to be rectangular and centered at the origin, we have       y   (   n  1   ,   n  2   )    =    ∑    k  1   =   -   N  1      N  1      ∑    k  2   =   -   N  2      N  2     h   (   k  1   ,   k  2   )   x   (    n  1   -   k  1    ,    n  2   -   k  2    )            y    subscript  n  1    subscript  n  2       superscript   subscript      subscript  k  1      subscript  N  1       subscript  N  1      superscript   subscript      subscript  k  2      subscript  N  2       subscript  N  2      h    subscript  k  1    subscript  k  2    x      subscript  n  1    subscript  k  1       subscript  n  2    subscript  k  2          y\left(n_{1},n_{2}\right)=\sum_{k_{1}=-N_{1}}^{N_{1}}\sum_{k_{2}=-N_{2}}^{N_{2%
 }}h(k_{1},k_{2})x(n_{1}-k_{1},n_{2}-k_{2})        y   (   n  1   ,   n  2   )    =     ∑    k  1   =   -   N  1      N  1      ∑    k  2   =  1    N  2     h   (   k  1   ,   k  2   )    [    x   (    n  1   -   k  1    ,    n  2   -   k  2    )    +   x   (    n  1   +   k  1    ,    n  2   +   k  2    )     ]      +    ∑    k  1   =  1    N  1     h   (   k  1   ,  0  )    [    x   (    n  1   -   k  1    ,   n  2   )    +   x   (    n  1   +   k  1    ,   n  2   )     ]     +   h   (  0  ,  0  )   x   (   n  1   ,   n  2   )           y    subscript  n  1    subscript  n  2         superscript   subscript      subscript  k  1      subscript  N  1       subscript  N  1      superscript   subscript      subscript  k  2   1     subscript  N  2      h    subscript  k  1    subscript  k  2     delimited-[]      x      subscript  n  1    subscript  k  1       subscript  n  2    subscript  k  2        x      subscript  n  1    subscript  k  1       subscript  n  2    subscript  k  2             superscript   subscript      subscript  k  1   1     subscript  N  1      h    subscript  k  1   0    delimited-[]      x      subscript  n  1    subscript  k  1     subscript  n  2       x      subscript  n  1    subscript  k  1     subscript  n  2           h   0  0   x    subscript  n  1    subscript  n  2        y\left(n_{1},n_{2}\right)=\sum_{k_{1}=-N_{1}}^{N_{1}}\sum_{k_{2}=1}^{N_{2}}h(k%
 _{1},k_{2})[x(n_{1}-k_{1},n_{2}-k_{2})+x(n_{1}+k_{1},n_{2}+k_{2})]+\sum_{k_{1}%
 =1}^{N_{1}}h(k_{1},0)[x(n_{1}-k_{1},n_{2})+x(n_{1}+k_{1},n_{2})]+h(0,0)x(n_{1}%
 ,n_{2})     Using the above equation to implement an FIR filter requires roughly one-half the number of multiplications of an implementation, although both implementations require the same number of additions and the same amount of storage. If the impulse response of an FIR filter possess other symmetries, they can be exploited in a similar fashion to reduce further the number of required multiplications.  Discrete Fourier Transform Implementations of FIR Filters 2  The Discrete Fourier Transform is a preferred method to obtain high-order filters because the various fast Fourier transform algorithms permit the efficient evaluation of the DFT. The general form of DFT for multidimensional signals can be seen below, where   N   N   N   is periodicity matrix,    x   (   n  ¯   )       x   normal-¯  n     x(\underline{n})   is the multidimensional signal in the space domain,    X   (   k  ¯   )       X   normal-¯  k     X(\underline{k})   is the DFT of    x   (   n  ¯   )       x   normal-¯  n     x(\underline{n})   in frequency domain,    I  N     subscript  I  N    I_{N}   is a region containing |    d  e  t  N      d  e  t  N    detN   | samples in   n   n   n   domain, and    J  N     subscript  J  N    J_{N}   is a region containing |    d  e  t   N  T       d  e  t   superscript  N  T     detN^{T}   | (     =   d  e  t  N       absent    d  e  t  N     =detN   ) frequency samples.       X   (  k  )    =    ∑   n  ϵ   I  n      x   (  n  )    e   -   j   k  T    (   2  π   N   -  1     )   n             X  k     subscript     n  ϵ   subscript  I  n       x  n   superscript  e      j   superscript  k  T     2  π   superscript  N    1     n         X\left(k\right)=\sum_{n\epsilon I_{n}}x\left(n\right)e^{-jk^{T}\left(2\pi N^{-%
 1}\right)n}     Let    y   (   n  1   ,   n  2   ,  …  ,   n  m   )       y    subscript  n  1    subscript  n  2   normal-…   subscript  n  m      y\left(n_{1},n_{2},...,n_{m}\right)   be the linear convolution of a finite-extent sequence    x   (   n  1   ,   n  2   ,  …  ,   n  m   )       x    subscript  n  1    subscript  n  2   normal-…   subscript  n  m      x\left(n_{1},n_{2},...,n_{m}\right)   with the impulse response    h   (   n  1   ,   n  2   ,  …  ,   n  m   )       h    subscript  n  1    subscript  n  2   normal-…   subscript  n  m      h\left(n_{1},n_{2},...,n_{m}\right)   of an FIR filter.       y   (   n  1   ,   n  2   ,  …  ,   n  m   )    =     x   (   n  1   ,   n  2   ,  …  ,   n  m   )    *  h    (   n  1   ,   n  2   ,  …  ,   n  m   )          y    subscript  n  1    subscript  n  2   normal-…   subscript  n  m           x    subscript  n  1    subscript  n  2   normal-…   subscript  n  m     h     subscript  n  1    subscript  n  2   normal-…   subscript  n  m       y\left(n_{1},n_{2},...,n_{m}\right)=x\left(n_{1},n_{2},...,n_{m}\right)*h\left%
 (n_{1},n_{2},...,n_{m}\right)     On computing Fourier Transform of both sides of this expression, we get       Y   (   w  1   ,   w  2   ,  …  ,   w  m   )    =   X   (   w  1   ,   w  2   ,  …  ,   w  m   )          Y    subscript  w  1    subscript  w  2   normal-…   subscript  w  m       X    subscript  w  1    subscript  w  2   normal-…   subscript  w  m       Y\left(w_{1},w_{2},...,w_{m}\right)=X\left(w_{1},w_{2},...,w_{m}\right)       H   (   w  1   ,   w  2   ,  …  ,   w  m   )       H    subscript  w  1    subscript  w  2   normal-…   subscript  w  m      H\left(w_{1},w_{2},...,w_{m}\right)     There are many possible definitions of the M-D discrete Fourier transform, and that all of these correspond to sets of samples of the M-D Fourier transform; these DFT’s can be used to perform convolutions as long their assumed region of support contains the support for    y   (   n  1   ,   n  2   ,  …  ,   n  m   )       y    subscript  n  1    subscript  n  2   normal-…   subscript  n  m      y\left(n_{1},n_{2},...,n_{m}\right)   . Let us assume that    Y   (   w  1   ,   w  2   ,  …  ,   w  m   )       Y    subscript  w  1    subscript  w  2   normal-…   subscript  w  m      Y\left(w_{1},w_{2},...,w_{m}\right)   is sampled on a    N  1     subscript  N  1    N_{1}   x    N  2     subscript  N  2    N_{2}   x...x    N  m     subscript  N  m    N_{m}   rectangular lattice of samples, and let      Y   (   k  1   ,   k  2   ,  …  ,   k  m   )   =  Y   (   w  1   ,   w  2   ,  …  ,   w  m   )   |   w  1   =    2  π   k  1     N  1    ;   w  2   =    2  π   k  2     N  2    ;  …  ;   w  m   =    2  π   k  m     N  m       fragments  Y   fragments  normal-(   subscript  k  1   normal-,   subscript  k  2   normal-,  normal-…  normal-,   subscript  k  m   normal-)    Y   fragments  normal-(   subscript  w  1   normal-,   subscript  w  2   normal-,  normal-…  normal-,   subscript  w  m   normal-)   normal-|   subscript  w  1        2  π   subscript  k  1     subscript  N  1    normal-;   subscript  w  2        2  π   subscript  k  2     subscript  N  2    normal-;  normal-…  normal-;   subscript  w  m        2  π   subscript  k  m     subscript  N  m      Y\left(k_{1},k_{2},...,k_{m}\right)=Y\left(w_{1},w_{2},...,w_{m}\right)|w_{1}=%
 \frac{2\pi k_{1}}{N_{1}};w_{2}=\frac{2\pi k_{2}}{N_{2}};...;w_{m}=\frac{2\pi k%
 _{m}}{N_{m}}     Therefore,     Y   (   k  1   ,   k  2   ,  …  ,   k  m   )    =   X   (   k  1   ,   k  2   ,  …  ,   k  m   )          Y    subscript  k  1    subscript  k  2   normal-…   subscript  k  m       X    subscript  k  1    subscript  k  2   normal-…   subscript  k  m       Y\left(k_{1},k_{2},...,k_{m}\right)=X\left(k_{1},k_{2},...,k_{m}\right)       H   (   k  1   ,   k  2   ,  …  ,   k  m   )       H    subscript  k  1    subscript  k  2   normal-…   subscript  k  m      H\left(k_{1},k_{2},...,k_{m}\right)   . To compute (    N  1     subscript  N  1    N_{1}   x    N  2     subscript  N  2    N_{2}   x...x    N  m     subscript  N  m    N_{m}   )-point DFT’s of   x   x   x   and   h   h   h   require If     y  ^    (   n  1   ,   n  2   ,  …  ,   n  m   )        normal-^  y     subscript  n  1    subscript  n  2   normal-…   subscript  n  m      \hat{y}\left(n_{1},n_{2},...,n_{m}\right)   results from the inverse DFT of the product    X   (   k  1   ,   k  2   ,  …  ,   k  m   )       X    subscript  k  1    subscript  k  2   normal-…   subscript  k  m      X\left(k_{1},k_{2},...,k_{m}\right)   .    H   (   k  1   ,   k  2   ,  …  ,   k  m   )       H    subscript  k  1    subscript  k  2   normal-…   subscript  k  m      H\left(k_{1},k_{2},...,k_{m}\right)   , then     y  ^    (   n  1   ,   n  2   ,  …  ,   n  m   )        normal-^  y     subscript  n  1    subscript  n  2   normal-…   subscript  n  m      \hat{y}\left(n_{1},n_{2},...,n_{m}\right)   will be the circular convolution of    h   (   n  1   ,   n  2   ,  …  ,   n  m   )       h    subscript  n  1    subscript  n  2   normal-…   subscript  n  m      h\left(n_{1},n_{2},...,n_{m}\right)   and    x   (   n  1   ,   n  2   ,  …  ,   n  m   )       x    subscript  n  1    subscript  n  2   normal-…   subscript  n  m      x\left(n_{1},n_{2},...,n_{m}\right)   . If    N  1     subscript  N  1    N_{1}   ,    N  2     subscript  N  2    N_{2}   ,...,    N  m     subscript  N  m    N_{m}   are chosen to be at least equal to the size of    y   (   n  1   ,   n  2   ,  …  ,   n  m   )       y    subscript  n  1    subscript  n  2   normal-…   subscript  n  m      y\left(n_{1},n_{2},...,n_{m}\right)   , then      y  ^    (   n  1   ,   n  2   ,  …  ,   n  m   )    =   y   (   n  1   ,   n  2   ,  …  ,   n  m   )           normal-^  y     subscript  n  1    subscript  n  2   normal-…   subscript  n  m       y    subscript  n  1    subscript  n  2   normal-…   subscript  n  m       \hat{y}\left(n_{1},n_{2},...,n_{m}\right)=y\left(n_{1},n_{2},...,n_{m}\right)   . To compute (    N  1     subscript  N  1    N_{1}   x    N  2     subscript  N  2    N_{2}   x...x    N  m     subscript  N  m    N_{m}   )-point DFT’s of   x   x   x   and   h   h   h   requires that both sequences have their region of support extended with samples of value zero. This technique is efficient with respect to computation, however it is prodigal with respect to storage as this method requires sufficient storage to contain all    N  1     subscript  N  1    N_{1}   x    N  2     subscript  N  2    N_{2}   x...x    N  m     subscript  N  m    N_{m}   points of the signal    x   (   n  1   ,   n  2   ,  …  ,   n  m   )       x    subscript  n  1    subscript  n  2   normal-…   subscript  n  m      x\left(n_{1},n_{2},...,n_{m}\right)   . In addition, we must store the filter response coefficients    H   (   k  1   ,   k  2   ,  …  ,   k  m   )       H    subscript  k  1    subscript  k  2   normal-…   subscript  k  m      H\left(k_{1},k_{2},...,k_{m}\right)   . By direct convolution the number of rows of the input that needs to be stored depends on the order of the filter. However, with the DFT the whole input must be stored regardless of the filter order.  For the 2D case, and assuming that    H   (   k  1   ,   k  2   )       H    subscript  k  1    subscript  k  2      H\left(k_{1},k_{2}\right)   is pre-computed, the number of real multiplications needed to compute    y   (   n  1   ,   n  2   )       y    subscript  n  1    subscript  n  2      y\left(n_{1},n_{2}\right)   is     2   2   2   x    N  1     subscript  N  1    N_{1}   x    N  2     subscript  N  2    N_{2}   x    log  2     subscript   2    \log_{2}       N  1     subscript  N  1    N_{1}   x    N  2     subscript  N  2    N_{2}      +     +      2   2   2   x    N  1     subscript  N  1    N_{1}   x    N  2     subscript  N  2    N_{2}   ;    N  1     subscript  N  1    N_{1}   and    N  2     subscript  N  2    N_{2}   are powers of 2  Trigonometric Sum-of-Squares Optimization 3  Here we discuss a method for multidimensional FIR filter designn via sum-of-squares formulations of sepctral mask constraints. The sum-of-squares optimization problem is expressed as a semidefinite program with low-rank structure, by sampling the constraints using discrete sine and cosine transforms. The resulting semidefinite program is then solved by a customized primal-dual interior-point method that exploits low-rank structure. This leads to substantial reduction in the computational complexity, compared to general-purpose semidefinite programming methods that exploit sparsity.  A variety of one-dimensional FIR filter design problems can be expressed as convex optimization problems over real trigonometric polynomials, subject to spectral mask constraints. These optimization problems can be formulated as semidefinite programs (SDPs) using classical sum-of-squares (SOS) characterizations of nonnegative polynomials, and solved efficiently via interior-point methods for semidefinite programming.  (Figure)  FIR filter in frequency domain with d=2; n1=n2=5 and has 61 sampling points   For the figure above, FIR filter in frequency domain with d=2; n1=n2=5 and has 61 sampling points. The extension of these techniques to multidimensional filter design poses several difficulties. First, SOS characterization of multivariate positive trigonometric polynomials may require factors of arbitrarily high degree. Second, difficulty stems from the large size of the semidefinite programming problems obtained from multivariate SOS programs. Most recent research on exploiting structure in semidefinite programming has focused on exploiting sparsity of the coefficient matrices. This technique is very useful for SDPs derived from SOS programs and are included in several general purpose semidefinite programming packages.  Let    Z  d     subscript  Z  d    Z_{d}   and    N  d     subscript  N  d    N_{d}   denote the sets of d-vectors of integers and natural numbers, respectively. For a vector   x   x   x   , we define    d  i  a  g   (  x  )       d  i  a  g  x    diag\left(x\right)   as the diagonal matrix with    x  i     subscript  x  i    x_{i}   as its ith diagonal entry. For a square matrix   X   X   X   ,    d  i  a  g   (  X  )       d  i  a  g  X    diag\left(X\right)   is a vector with the    i   t  h      superscript  i    t  h     i^{th}   entry    X  i  i      X  i  i    Xii   . The matrix inequality    A  >  ≥  B     fragments  A    B    A>\geq B   denotes that    A  -  B      A  B    A-B   is positive definite (semidefinite).    T  r   (  A  )       T  r  A    Tr\left(A\right)   denotes the trace of a symmetric matrix   A   A   A   .     R   R   R   is a   d   d   d   -variate trigonometric polynomial of degree    n  ϵ   Z  d       n  ϵ   subscript  Z  d     n\epsilon Z_{d}   , with real symmetric coefficients    x  k     subscript  x  k    x_{k}   =    x   -  k      subscript  x    k     x_{-k}        R   (  w  )    =    ∑   k  =   -  n    n     x  k    e   -   j   k  T   w             R  w     superscript   subscript     k    n     n      subscript  x  k    superscript  e      j   superscript  k  T   w         R\left(w\right)=\sum_{k=-n}^{n}x_{k}e^{-jk^{T}w}     The above summation is over all integer vectors   k   k   k   that satisfy     -  n   ≤  k  ≤  n          n   k       n     -n\leq k\leq n   , where the inequalities between the vectors are interpreted element-wise.   R   R   R   is positive on     [   -  π   ,  π  ]   d     superscript     π   π   d    [-\pi,\pi]^{d}   , then it can be expressed as sum of squares of trigonometric polynomials        H  l    (  w  )    =    ∑   l  =  1   r     |    H  l    (  w  )    |   2           subscript  H  l   w     superscript   subscript     l  1    r    superscript       subscript  H  l   w    2      H_{l}\left(w\right)=\sum_{l=1}^{r}|H_{l}\left(w\right)|^{2}         H  l    (  w  )    =    ∑   k  =  0    n  l      h   l  ,  k     e   -   j   k  T   w              subscript  H  l   w     superscript   subscript     k  0     subscript  n  l       subscript  h   l  k     superscript  e      j   superscript  k  T   w         H_{l}\left(w\right)=\sum_{k=0}^{n_{l}}h_{l,k}e^{-jk^{T}w}     2-D FIR Filter Design as SOS Program:   H   H   H   is taken to be the frequency response of a 2-D linear phase FIR filter with filter order    n  =   (   n  1   ,   n  2   )       n    subscript  n  1    subscript  n  2      n=\left(n_{1},n_{2}\right)   , with filter coefficients    h  k     subscript  h  k    h_{k}   =    h   -  k      subscript  h    k     h_{-k}   .       H   (  w  )    =    ∑   k  =   -  n    n     h  k    e   -   j   k  T   w             H  w     superscript   subscript     k    n     n      subscript  h  k    superscript  e      j   superscript  k  T   w         H\left(w\right)=\sum_{k=-n}^{n}h_{k}e^{-jk^{T}w}     We want to determine the filter coefficients    h  k     subscript  h  k    h_{k}   that maximize the attenuation    δ  s     subscript  δ  s    \delta_{s}   in the stopband    D  s     subscript  D  s    D_{s}   for a given maximum allowable ripple (    δ  p     subscript  δ  p    \delta_{p}   ) in the passband    D  p     subscript  D  p    D_{p}   . The optimization problem is to minimize    δ  s     subscript  δ  s    \delta_{s}   by subjecting to the following conditions       |   1  -   H   (  w  )     |   ≤    δ  p   ,   w  ϵ   D  p             1    H  w       subscript  δ  p     w  ϵ   subscript  D  p       |1-H\left(w\right)|\leq\delta_{p},\,\,w\epsilon D_{p}        |   H   (  w  )    |   ≤    δ  s   ,   w  ϵ   D  s             H  w      subscript  δ  s     w  ϵ   subscript  D  s       |H\left(w\right)|\leq\delta_{s},\,\,w\epsilon D_{s}     where the scalar    δ  s     subscript  δ  s    \delta_{s}   and the filter coefficients    h  k     subscript  h  k    h_{k}   are the problem variables. These constraints are as shown below         R  1    (  w  )    =     H   (  w  )    -  1   +   δ  p    ≥  0   ,   w  ϵ   D  p       formulae-sequence         subscript  R  1   w         H  w   1    subscript  δ  p         0      w  ϵ   subscript  D  p      R_{1}\left(w\right)=H\left(w\right)-1+\delta_{p}\geq 0,\,\,w\epsilon D_{p}          R  2    (  w  )    =    1  -   H   (  w  )     +   δ  p    ≥  0   ,   w  ϵ   D  p       formulae-sequence         subscript  R  2   w       1    H  w     subscript  δ  p         0      w  ϵ   subscript  D  p      R_{2}\left(w\right)=1-H\left(w\right)+\delta_{p}\geq 0,\,\,w\epsilon D_{p}          R  3    (  w  )    =    H   (  w  )    +   δ  s    ≥  0   ,   w  ϵ   D  s       formulae-sequence         subscript  R  3   w       H  w    subscript  δ  s         0      w  ϵ   subscript  D  s      R_{3}\left(w\right)=H\left(w\right)+\delta_{s}\geq 0,\,\,w\epsilon D_{s}          R  4    (  w  )    =    H   (  w  )    -   δ  s    ≥  0   ,   w  ϵ   D  s       formulae-sequence         subscript  R  4   w       H  w    subscript  δ  s         0      w  ϵ   subscript  D  s      R_{4}\left(w\right)=H\left(w\right)-\delta_{s}\geq 0,\,\,w\epsilon D_{s}     If the passband and stopband are defined, then we can replace each positive polynomial    R  i     subscript  R  i    R_{i}   by a weighted sum of squares expression. Limiting the degrees of the sum-of-squares polynomials to   n   n   n   then gives sufficient conditions for feasibility. We call the resulting optimization problem a sum-of-squares program and can be solved via semidefinite programming.  Existing Approaches for IIR Filter Design  Similar to its 1-D special case, M-D IIR filters can have dramatically lower order than FIR filters with similar performance. This motivates the development of design techniques for M-D IIR filtering algorithms. This section presents brief overview of three approaches for designing M-D IIR filters.  Iterative design 4  In some applications, where access to all values of signal is available (i.e. where entire signal is stored in memory and is available for processing), the concept of “feedback” can be realized. The iterative approach uses the previous output as feedback to generate successively better approximations to the desired output signal.  In general, the IIR frequency response can be expressed as       H   (   w  1   ,   w  2   ,  …  ,   w  m   )    =    A   (   w  1   ,   w  2   ,  …  ,   w  m   )     B   (   w  1   ,   w  2   ,  …  ,   w  m   )     =      ∑   l  1        ∑   l  2      …     ∑   l  m      a   (   l  1   ,   l  2   ,  …  ,   l  m   )    e   -   j   (     w  1    l  1    +    w  2    l  2    +  …  +    w  m    l  m     )              ∑   k  1        ∑   k  2      …     ∑   k  m      b   (   k  1   ,   k  2   ,  …  ,   k  m   )    e   -   j   (     w  1    k  1    +    w  2    k  2    +  …  +    w  m    k  m     )                    H    subscript  w  1    subscript  w  2   normal-…   subscript  w  m         A    subscript  w  1    subscript  w  2   normal-…   subscript  w  m       B    subscript  w  1    subscript  w  2   normal-…   subscript  w  m               subscript    subscript  l  1      subscript    subscript  l  2      normal-…    subscript    subscript  l  m      a    subscript  l  1    subscript  l  2   normal-…   subscript  l  m     superscript  e      j       subscript  w  1    subscript  l  1       subscript  w  2    subscript  l  2    normal-…     subscript  w  m    subscript  l  m               subscript    subscript  k  1      subscript    subscript  k  2      normal-…    subscript    subscript  k  m      b    subscript  k  1    subscript  k  2   normal-…   subscript  k  m     superscript  e      j       subscript  w  1    subscript  k  1       subscript  w  2    subscript  k  2    normal-…     subscript  w  m    subscript  k  m                 H\left(w_{1},w_{2},...,w_{m}\right)=\frac{A\left(w_{1},w_{2},...,w_{m}\right)}%
 {B\left(w_{1},w_{2},...,w_{m}\right)}=\frac{\sum_{l_{1}}\sum_{l_{2}}...\sum_{l%
 _{m}}a\left(l_{1},l_{2},...,l_{m}\right)e^{-j\left(w_{1}l_{1}+w_{2}l_{2}+...+w%
 _{m}l_{m}\right)}}{\sum_{k_{1}}\sum_{k_{2}}...\sum_{k_{m}}b\left(k_{1},k_{2},.%
 ..,k_{m}\right)e^{-j\left(w_{1}k_{1}+w_{2}k_{2}+...+w_{m}k_{m}\right)}}     where    a   (   l  1   ,   l  2   ,  …  ,   l  m   )       a    subscript  l  1    subscript  l  2   normal-…   subscript  l  m      a\left(l_{1},l_{2},...,l_{m}\right)   and    b   (   k  1   ,   k  2   ,  …  ,   k  m   )       b    subscript  k  1    subscript  k  2   normal-…   subscript  k  m      b\left(k_{1},k_{2},...,k_{m}\right)   are M-D finite extent coefficient arrays. The ratio is normalized so that     b   (  0  ,  0  ,  …  ,  0  )    =  1        b   0  0  normal-…  0    1    b\left(0,0,...,0\right)=1     Now, let    X   (   w  1   ,   w  2   ,  …  ,   w  m   )       X    subscript  w  1    subscript  w  2   normal-…   subscript  w  m      X\left(w_{1},w_{2},...,w_{m}\right)   represent the spectrum of a M-D input signal    x   (   n  1   ,   n  2   ,  …  ,   n  m   )       x    subscript  n  1    subscript  n  2   normal-…   subscript  n  m      x\left(n_{1},n_{2},...,n_{m}\right)   and    Y   (   w  1   ,   w  2   ,  …  ,   w  m   )       Y    subscript  w  1    subscript  w  2   normal-…   subscript  w  m      Y\left(w_{1},w_{2},...,w_{m}\right)   represent the spectrum of a M-D output signal    y   (   n  1   ,   n  2   ,  …  ,   n  m   )       y    subscript  n  1    subscript  n  2   normal-…   subscript  n  m      y\left(n_{1},n_{2},...,n_{m}\right)   .       Y   (   w  1   ,   w  2   ,  …  ,   w  m   )    =    A   (   w  1   ,   w  2   ,  …  ,   w  m   )   X   (   w  1   ,   w  2   ,  …  ,   w  m   )    +   C   (   w  1   ,   w  2   ,  …  ,   w  m   )   Y   (   w  1   ,   w  2   ,  …  ,   w  m   )           Y    subscript  w  1    subscript  w  2   normal-…   subscript  w  m         A    subscript  w  1    subscript  w  2   normal-…   subscript  w  m    X    subscript  w  1    subscript  w  2   normal-…   subscript  w  m       C    subscript  w  1    subscript  w  2   normal-…   subscript  w  m    Y    subscript  w  1    subscript  w  2   normal-…   subscript  w  m        Y\left(w_{1},w_{2},...,w_{m}\right)=A\left(w_{1},w_{2},...,w_{m}\right)X\left(%
 w_{1},w_{2},...,w_{m}\right)+C\left(w_{1},w_{2},...,w_{m}\right)Y\left(w_{1},w%
 _{2},...,w_{m}\right)     where    C   (   w  1   ,   w  2   ,  …  ,   w  m   )       C    subscript  w  1    subscript  w  2   normal-…   subscript  w  m      C\left(w_{1},w_{2},...,w_{m}\right)   is a trigonometric polynomial defined as     C   (   w  1   ,   w  2   ,  …  ,   w  m   )    =   1  -   B   (   w  1   ,   w  2   ,  …  ,   w  m   )           C    subscript  w  1    subscript  w  2   normal-…   subscript  w  m       1    B    subscript  w  1    subscript  w  2   normal-…   subscript  w  m        C\left(w_{1},w_{2},...,w_{m}\right)=1-B\left(w_{1},w_{2},...,w_{m}\right)     In the signal domain, the equation becomes     y   (   n  1   ,   n  2   ,  …  ,   n  m   )    =      a   (   n  1   ,   n  2   ,  …  ,   n  m   )    *  x    (   n  1   ,   n  2   ,  …  ,   n  m   )    +     c   (   n  1   ,   n  2   ,  …  ,   n  m   )    *  y    (   n  1   ,   n  2   ,  …  ,   n  m   )           y    subscript  n  1    subscript  n  2   normal-…   subscript  n  m             a    subscript  n  1    subscript  n  2   normal-…   subscript  n  m     x     subscript  n  1    subscript  n  2   normal-…   subscript  n  m           c    subscript  n  1    subscript  n  2   normal-…   subscript  n  m     y     subscript  n  1    subscript  n  2   normal-…   subscript  n  m        y\left(n_{1},n_{2},...,n_{m}\right)=a\left(n_{1},n_{2},...,n_{m}\right)*x\left%
 (n_{1},n_{2},...,n_{m}\right)+c\left(n_{1},n_{2},...,n_{m}\right)*y\left(n_{1}%
 ,n_{2},...,n_{m}\right)     After making an initial guess, and then substituting the guess in the above equation iteratively, a better approximation of    y   (   n  1   ,   n  2   ,  …  ,   n  m   )       y    subscript  n  1    subscript  n  2   normal-…   subscript  n  m      y\left(n_{1},n_{2},...,n_{m}\right)   can be obtained –      y  i    (   n  1   ,   n  2   ,  …  ,   n  m   )    =      a   (   n  1   ,   n  2   ,  …  ,   n  m   )    *  x    (   n  1   ,   n  2   ,  …  ,   n  m   )    +     c   (   n  1   ,   n  2   ,  …  ,   n  m   )    *   y   i  -  1      (   n  1   ,   n  2   ,  …  ,   n  m   )            subscript  y  i     subscript  n  1    subscript  n  2   normal-…   subscript  n  m             a    subscript  n  1    subscript  n  2   normal-…   subscript  n  m     x     subscript  n  1    subscript  n  2   normal-…   subscript  n  m           c    subscript  n  1    subscript  n  2   normal-…   subscript  n  m      subscript  y    i  1       subscript  n  1    subscript  n  2   normal-…   subscript  n  m        y_{i}\left(n_{1},n_{2},...,n_{m}\right)=a\left(n_{1},n_{2},...,n_{m}\right)*x%
 \left(n_{1},n_{2},...,n_{m}\right)+c\left(n_{1},n_{2},...,n_{m}\right)*y_{i-1}%
 \left(n_{1},n_{2},...,n_{m}\right)     where   i   i   i   denotes the iteration index  In the frequency domain, the above equation becomes      Y  i    (   w  1   ,   w  2   ,  …  ,   w  m   )    =    A   (   w  1   ,   w  2   ,  …  ,   w  m   )   X   (   w  1   ,   w  2   ,  …  ,   w  m   )    +   C   (   w  1   ,   w  2   ,  …  ,   w  m   )    Y   i  -  1     (   w  1   ,   w  2   ,  …  ,   w  m   )            subscript  Y  i     subscript  w  1    subscript  w  2   normal-…   subscript  w  m         A    subscript  w  1    subscript  w  2   normal-…   subscript  w  m    X    subscript  w  1    subscript  w  2   normal-…   subscript  w  m       C    subscript  w  1    subscript  w  2   normal-…   subscript  w  m     subscript  Y    i  1      subscript  w  1    subscript  w  2   normal-…   subscript  w  m        Y_{i}\left(w_{1},w_{2},...,w_{m}\right)=A\left(w_{1},w_{2},...,w_{m}\right)X%
 \left(w_{1},w_{2},...,w_{m}\right)+C\left(w_{1},w_{2},...,w_{m}\right)Y_{i-1}%
 \left(w_{1},w_{2},...,w_{m}\right)     An IIR filter is BIBO stable if     C   (   w  1   ,   w  2   ,  …  ,   w  m   )    ≠  0        C    subscript  w  1    subscript  w  2   normal-…   subscript  w  m     0    C\left(w_{1},w_{2},...,w_{m}\right)\neq 0     If we assume that     |   C   (   w  1   ,   w  2   ,  …  ,   w  m   )    |   <  1          C    subscript  w  1    subscript  w  2   normal-…   subscript  w  m      1    |C\left(w_{1},w_{2},...,w_{m}\right)|<1   then        lim   I  →  ∞      Y  I    (   w  1   ,   w  2   ,  …  ,   w  m   )     =    A   (   w  1   ,   w  2   ,  …  ,   w  m   )   X   (   w  1   ,   w  2   ,  …  ,   w  m   )     1  -   C   (   w  1   ,   w  2   ,  …  ,   w  m   )      =   Y   (   w  1   ,   w  2   ,  …  ,   w  m   )            subscript    normal-→  I        subscript  Y  I     subscript  w  1    subscript  w  2   normal-…   subscript  w  m          A    subscript  w  1    subscript  w  2   normal-…   subscript  w  m    X    subscript  w  1    subscript  w  2   normal-…   subscript  w  m       1    C    subscript  w  1    subscript  w  2   normal-…   subscript  w  m              Y    subscript  w  1    subscript  w  2   normal-…   subscript  w  m        \lim_{I\to\infty}Y_{I}\left(w_{1},w_{2},...,w_{m}\right)=\frac{A\left(w_{1},w_%
 {2},...,w_{m}\right)X\left(w_{1},w_{2},...,w_{m}\right)}{1-C\left(w_{1},w_{2},%
 ...,w_{m}\right)}=Y\left(w_{1},w_{2},...,w_{m}\right)     (Figure)  design   Thus, it can be said that, the frequency response    H   (   w  1   ,   w  2   ,  …  ,   w  m   )       H    subscript  w  1    subscript  w  2   normal-…   subscript  w  m      H\left(w_{1},w_{2},...,w_{m}\right)   of a M-D IIR filter can be obtained by infinite number of M-D FIR filtering operations. The store operator stores the result of the previous iteration.  To be practical, an iterative IIR filter should require fewer computations, counting all iterations to achieve an acceptable error, compared to an FIR filter with similar performance.  Shank’s method 5  This technique is based on minimizing the error functionals in the space domain. The coefficient arrays    a   (   n  1   ,   n  2   ,  …  ,   n  m   )       a    subscript  n  1    subscript  n  2   normal-…   subscript  n  m      a\left(n_{1},n_{2},...,n_{m}\right)   and    b   (   n  1   ,   n  2   ,  …  ,   n  m   )       b    subscript  n  1    subscript  n  2   normal-…   subscript  n  m      b\left(n_{1},n_{2},...,n_{m}\right)   are determined such that the output response    y   (   n  1   ,   n  2   )       y    subscript  n  1    subscript  n  2      y\left(n_{1},n_{2}\right)   of a filter matches the desired response    d   (   n  1   ,   n  2   ,  …  ,   n  m   )       d    subscript  n  1    subscript  n  2   normal-…   subscript  n  m      d\left(n_{1},n_{2},...,n_{m}\right)   .  Let’s denote the error signal as       e   (   n  1   ,   n  2   ,  …  ,   n  m   )    =    y   (   n  1   ,   n  2   ,  …  ,   n  m   )    -   d   (   n  1   ,   n  2   ,  …  ,   n  m   )           e    subscript  n  1    subscript  n  2   normal-…   subscript  n  m         y    subscript  n  1    subscript  n  2   normal-…   subscript  n  m       d    subscript  n  1    subscript  n  2   normal-…   subscript  n  m        e\left(n_{1},n_{2},...,n_{m}\right)=y\left(n_{1},n_{2},...,n_{m}\right)-d\left%
 (n_{1},n_{2},...,n_{m}\right)     And let    E   (   w  1   ,   w  2   ,  …  ,   w  m   )       E    subscript  w  1    subscript  w  2   normal-…   subscript  w  m      E\left(w_{1},w_{2},...,w_{m}\right)   denote it’s the Fourier transform       E   (   w  1   ,   w  2   ,  …  ,   w  m   )    =     A   (   w  1   ,   w  2   ,  …  ,   w  m   )   X   (   w  1   ,   w  2   ,  …  ,   w  m   )     B   (   w  1   ,   w  2   ,  …  ,   w  m   )     -   D   (   w  1   ,   w  2   ,  …  ,   w  m   )           E    subscript  w  1    subscript  w  2   normal-…   subscript  w  m           A    subscript  w  1    subscript  w  2   normal-…   subscript  w  m    X    subscript  w  1    subscript  w  2   normal-…   subscript  w  m       B    subscript  w  1    subscript  w  2   normal-…   subscript  w  m        D    subscript  w  1    subscript  w  2   normal-…   subscript  w  m        E\left(w_{1},w_{2},...,w_{m}\right)=\frac{A\left(w_{1},w_{2},...,w_{m}\right)X%
 \left(w_{1},w_{2},...,w_{m}\right)}{B\left(w_{1},w_{2},...,w_{m}\right)}-D%
 \left(w_{1},w_{2},...,w_{m}\right)     By multiplying both sides by    B   (   w  1   ,   w  2   ,  …  ,   w  m   )       B    subscript  w  1    subscript  w  2   normal-…   subscript  w  m      B\left(w_{1},w_{2},...,w_{m}\right)   , we get the modified error spectrum, converted in discrete domain as        e  ′    (   n  1   ,   n  2   ,  …  ,   n  m   )    =      a   (   n  1   ,   n  2   ,  …  ,   n  m   )    *  x    (   n  1   ,   n  2   ,  …  ,   n  m   )    -     b   (   n  1   ,   n  2   ,  …  ,   n  m   )    *  d    (   n  1   ,   n  2   ,  …  ,   n  m   )            superscript  e  normal-′     subscript  n  1    subscript  n  2   normal-…   subscript  n  m             a    subscript  n  1    subscript  n  2   normal-…   subscript  n  m     x     subscript  n  1    subscript  n  2   normal-…   subscript  n  m           b    subscript  n  1    subscript  n  2   normal-…   subscript  n  m     d     subscript  n  1    subscript  n  2   normal-…   subscript  n  m        e^{\prime}\left(n_{1},n_{2},...,n_{m}\right)=a\left(n_{1},n_{2},...,n_{m}%
 \right)*x\left(n_{1},n_{2},...,n_{m}\right)-b\left(n_{1},n_{2},...,n_{m}\right%
 )*d\left(n_{1},n_{2},...,n_{m}\right)     The total mean-squared error is obtained as –        e  2  ′    (   n  1   ,   n  2   ,  …  ,   n  m   )    =    ∑   n  1      ∑   n  2     …    ∑   n  m      [    e  ′    (   n  1   ,   n  2   ,  …  ,   n  m   )    ]   2              subscript   superscript  e  normal-′   2     subscript  n  1    subscript  n  2   normal-…   subscript  n  m       subscript    subscript  n  1      subscript    subscript  n  2      normal-…    subscript    subscript  n  m     superscript   delimited-[]     superscript  e  normal-′     subscript  n  1    subscript  n  2   normal-…   subscript  n  m      2         e^{\prime}_{2}\left(n_{1},n_{2},...,n_{m}\right)=\sum_{n_{1}}\sum_{n_{2}}...%
 \sum_{n_{m}}[e^{\prime}\left(n_{1},n_{2},...,n_{m}\right)]^{2}     Let the input signal be    δ   (   n  1   ,   n  2   ,  …  ,   n  m   )       δ    subscript  n  1    subscript  n  2   normal-…   subscript  n  m      \delta\left(n_{1},n_{2},...,n_{m}\right)   . Now, the numerator coefficient    a   (   n  1   ,   n  2   ,  …  ,   n  m   )       a    subscript  n  1    subscript  n  2   normal-…   subscript  n  m      a\left(n_{1},n_{2},...,n_{m}\right)   is zero outside region     0  ≤   n  1   ≤     N  1   -   1    &  0   ≤   n  2   ≤    N  2   -  1...    ,   0  ≤   n  m   ≤    N  m   -  1       formulae-sequence      0   subscript  n  1             subscript  N  1   1   0         subscript  n  2           subscript  N  2   1...         0   subscript  n  m           subscript  N  m   1       0\leq n_{1}\leq N_{1}-1\,\&\,0\leq n_{2}\leq N_{2}-1...,0\leq n_{m}\leq N_{m}-1   because of the ROS of input signal.Then equation becomes       e  ′    (   n  1   ,   n  2   ,  …  ,   n  m   )   =  -   ∑    q  1   =  0     M  1   -  1     ∑    q  2   =  0     M  2   -  1    …   ∑    q  m   =  0     M  m   -  1    b   (   q  1   ,   q  2   ,  .  .  ,   q  m   )   d   (   n  1   -   q  1   ,   n  2   -   q  2   )   ;     fragments   superscript  e  normal-′    fragments  normal-(   subscript  n  1   normal-,   subscript  n  2   normal-,  normal-…  normal-,   subscript  n  m   normal-)      superscript   subscript      subscript  q  1   0       subscript  M  1   1     superscript   subscript      subscript  q  2   0       subscript  M  2   1    normal-…   superscript   subscript      subscript  q  m   0       subscript  M  m   1    b   fragments  normal-(   subscript  q  1   normal-,   subscript  q  2   normal-,  normal-.  normal-.  normal-,   subscript  q  m   normal-)   d   fragments  normal-(   subscript  n  1     subscript  q  1   normal-,   subscript  n  2     subscript  q  2   normal-)   normal-;    e^{\prime}\left(n_{1},n_{2},...,n_{m}\right)=-\sum_{q_{1}=0}^{M_{1}-1}\sum_{q_%
 {2}=0}^{M_{2}-1}...\sum_{q_{m}=0}^{M_{m}-1}b\left(q_{1},q_{2},..,q_{m}\right)d%
 \left(n_{1}-q_{1},n_{2}-q_{2}\right)\,;\,   for     n  1   ≥    N  1   -  1        subscript  n  1      subscript  N  1   1     n_{1}\geq N_{1}-1   or     n  2   ≥    N  2   -  1        subscript  n  2      subscript  N  2   1     n_{2}\geq N_{2}-1   or ...     n  m   ≥    N  m   -  1        subscript  n  m      subscript  N  m   1     n_{m}\geq N_{m}-1     Substituting the result    e  ′     superscript  e  normal-′    e^{\prime}   into    e  2  ′     superscript   subscript  e  2   normal-′    e_{2}^{\prime}   and differentiating    e  2  ′     subscript   superscript  e  normal-′   2    e^{\prime}_{2}   with respect to denominator coefficients    b   (   q  1   ,   q  2   ,  …  ,   q  n   )       b    subscript  q  1    subscript  q  2   normal-…   subscript  q  n      b\left(q_{1},q_{2},...,q_{n}\right)   , the linear set of equations is obtained as         ∑    m  1   =  0     M  1   -  1      ∑    m  2   =  0     M  2   -  1     …    ∑    m  m   =  0     M  m   -  1     b   (   m  1   ,   m  2   ,  …  ,   m  m   )   r   (   m  1   ,   m  2   ,  …  ,   m  m   ;   q  1   ,   q  2   ,  …  ,   q  m   )        =   0    ;        superscript   subscript      subscript  m  1   0       subscript  M  1   1      superscript   subscript      subscript  m  2   0       subscript  M  2   1      normal-…    superscript   subscript      subscript  m  m   0       subscript  M  m   1      b    subscript  m  1    subscript  m  2   normal-…   subscript  m  m    r    subscript  m  1    subscript  m  2   normal-…   subscript  m  m    subscript  q  1    subscript  q  2   normal-…   subscript  q  m         0    \sum_{m_{1}=0}^{M_{1}-1}\sum_{m_{2}=0}^{M_{2}-1}...\sum_{m_{m}=0}^{M_{m}-1}b%
 \left(m_{1},m_{2},...,m_{m}\right)r\left(m_{1},m_{2},...,m_{m};q_{1},q_{2},...%
 ,q_{m}\right)=0\,;\,   for     0  ≤   m  1   <   M  1    ;   0  ≤   m  2   <   M  2    ;    …  ;  0   ≤   m  m   <   M  m       formulae-sequence      0   subscript  m  1         subscript  M  1         0   subscript  m  2         subscript  M  2          normal-…  0    subscript  m  m         subscript  M  m       0\leq m_{1}     (Figure)  Design   Now, taking the double summation for the region “R” i.e for     n  1   ≥    N  1   -  1        subscript  n  1      subscript  N  1   1     n_{1}\geq N_{1}-1   and     n  2   ≥    N  2   -  1        subscript  n  2      subscript  N  2   1     n_{2}\geq N_{2}-1   and ...     n  m   ≥    N  m   -  1        subscript  n  m      subscript  N  m   1     n_{m}\geq N_{m}-1   shown in figure (shown for 2-D case), the coefficients    b   (   n  1   ,   n  2   ,  …  ,   n  m   )       b    subscript  n  1    subscript  n  2   normal-…   subscript  n  m      b\left(n_{1},n_{2},...,n_{m}\right)   are obtained.  The coefficients    a   (   n  1   ,   n  2   ,  …  ,   n  m   )       a    subscript  n  1    subscript  n  2   normal-…   subscript  n  m      a\left(n_{1},n_{2},...,n_{m}\right)   can be obtained from       a   (   n  1   ,   n  2   ,  …  ,   n  m   )    ≈     b   (   n  1   ,   n  2   ,  …  ,   n  m   )    *  d    (   n  1   ,   n  2   ,  …  ,   n  m   )          a    subscript  n  1    subscript  n  2   normal-…   subscript  n  m           b    subscript  n  1    subscript  n  2   normal-…   subscript  n  m     d     subscript  n  1    subscript  n  2   normal-…   subscript  n  m       a\left(n_{1},n_{2},...,n_{m}\right)\approx b\left(n_{1},n_{2},...,n_{m}\right)%
 *d\left(n_{1},n_{2},...,n_{m}\right)     The major advantage of Shank’s method is that IIR filter coefficients can be obtained by solving linear equations. The disadvantage is that the mean squared error between   y   y   y   and   d   d   d   is not minimized. Also, the stability is not certain.  Magnitude and Magnitude squared Design algorithm 6  In this section, we examine the technique for designing 2-D IIR filters based on minimizing error functionals in the frequency domain. The mean-squared error is given as       1    (   2  π   )   m      ∫   -  π   π     ∫   -  π   π    …    ∫   -  π   π      |    Y   (   w  1   ,   w  2   ,  …  ,   w  m   )    -   D   (   w  1   ,   w  2   ,  …  ,   w  m   )     |   2   d   w  1   d   w  2   …  d   w  m              1   superscript    2  π   m      superscript   subscript     π    π     superscript   subscript     π    π     normal-…    superscript   subscript     π    π      superscript        Y    subscript  w  1    subscript  w  2   normal-…   subscript  w  m       D    subscript  w  1    subscript  w  2   normal-…   subscript  w  m       2   d   subscript  w  1   d   subscript  w  2   normal-…  d   subscript  w  m          \frac{1}{\left(2\pi\right)^{m}}\int_{-\pi}^{\pi}\int_{-\pi}^{\pi}...\int_{-\pi%
 }^{\pi}|Y\left(w_{1},w_{2},...,w_{m}\right)-D\left(w_{1},w_{2},...,w_{m}\right%
 )|^{2}dw_{1}dw_{2}...dw_{m}     The below function    J  a     subscript  J  a    J_{a}   is the measure of difference between two complex functions - the desired response    D   (   w  1   ,   w  2   ,  …  ,   w  m   )       D    subscript  w  1    subscript  w  2   normal-…   subscript  w  m      D\left(w_{1},w_{2},...,w_{m}\right)   and the actual response    Y   (   w  1   ,   w  2   ,  …  ,   w  m   )       Y    subscript  w  1    subscript  w  2   normal-…   subscript  w  m      Y\left(w_{1},w_{2},...,w_{m}\right)   . Generally, we can define a complex function   f   f   f   of   Y   Y   Y   to approximate the desired response   D   D   D   . Hence, the optimization task boils down to the task of minimizing "      f  /  l   e  f  t   (  Y  )    -  D          f  l   e  f  t  Y   D    f/left(Y)-D   ".       J  a   =    ∑  k    W   (   w   1  k    ,   w   2  k    ,  …  ,   w   m  k    )     [    f   (    A   (   w   1  k    ,   w   2  k    ,  …  ,   w   m  k    )     B   (   w   1  k    ,   w   2  k    ,  …  ,   w   m  k    )     )    -   D   (   w   1  k    ,   w   2  k    ,  …  ,   w   m  k    )     ]   2          subscript  J  a     subscript   k     W    subscript  w    1  k     subscript  w    2  k    normal-…   subscript  w    m  k      superscript   delimited-[]      f      A    subscript  w    1  k     subscript  w    2  k    normal-…   subscript  w    m  k        B    subscript  w    1  k     subscript  w    2  k    normal-…   subscript  w    m  k          D    subscript  w    1  k     subscript  w    2  k    normal-…   subscript  w    m  k        2       J_{a}=\sum_{k}W\left(w_{1k},w_{2k},...,w_{mk}\right)[f\left(\frac{A\left(w_{1k%
 },w_{2k},...,w_{mk}\right)}{B\left(w_{1k},w_{2k},...,w_{mk}\right)}\right)-D%
 \left(w_{1k},w_{2k},...,w_{mk}\right)]^{2}     where    W   (   w  1   ,   w  2   ,  …  ,   w  m   )       W    subscript  w  1    subscript  w  2   normal-…   subscript  w  m      W\left(w_{1},w_{2},...,w_{m}\right)   is the weighting function and    (   w   1  k    ,   w   2  k    ,   …   w   m  k     )      subscript  w    1  k     subscript  w    2  k      normal-…   subscript  w    m  k       \left(w_{1k},w_{2k},...w_{mk}\right)   are frequency domain samples selected for minimization. Now, consider a case, where we ignore the phase response of the filter i.e. we concentrate on only matching the magnitude (or square of magnitude) of the desired and actual filter response. Linearization can be used to find out the coefficients    {   a   (   n  1   ,   n  2   ,  …  ,   w  m   )   b   (   n  1   ,   n  2   ,  …  ,   w  m   )    }       a    subscript  n  1    subscript  n  2   normal-…   subscript  w  m    b    subscript  n  1    subscript  n  2   normal-…   subscript  w  m       \{a\left(n_{1},n_{2},...,w_{m}\right)\,b\left(n_{1},n_{2},...,w_{m}\right)\}   that results in minimum value of    J  a     subscript  J  a    J_{a}   . This will ensure that the filter form can be represented by a finite order difference equation. The stability of the filter depends on   f   f   f   - the function of    Y   (   w  1   ,   w  2   ,  …  ,   w  m   )       Y    subscript  w  1    subscript  w  2   normal-…   subscript  w  m      Y\left(w_{1},w_{2},...,w_{m}\right)   .  References  "  Category:Digital signal processing  Category:Multidimensional signal processing     Dan E. Dudgeon, Russell M. Mersereau, “Multidimensional Digital Signal Processing”, Prentice-Hall Signal Processing Series, ISBN 0136049591, 1983. ↩   Roh T., Bogdan D.,Vandenberghe L., “Multidimensional FIR Filter Design Via Trigonometric Sum-of-Squares Optimization,” 'IEEE ''JOURNAL OF SELECTED TOPICS IN SIGNAL PROCESSING (12/2007)', Vol. 1, No. 4, Page 1-10 ↩        
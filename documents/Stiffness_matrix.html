<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="148">Stiffness matrix</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Stiffness matrix</h1>
<hr/>
<dl>
<dd><em>For the stiffness tensor in solid mechanics, see <a href="Hooke's_law#Matrix_representation_(stiffness_tensor)" title="wikilink">Hooke's law#Matrix representation (stiffness tensor)</a>.</em>
</dd>
</dl>

<p>In the <a href="finite_element_method" title="wikilink">finite element method</a> for the numerical solution of elliptic <a href="partial_differential_equations" title="wikilink">partial differential equations</a>, the <strong>stiffness matrix</strong> represents the system of linear equations that must be solved in order to ascertain an approximate solution to the differential equation.</p>
<h2 id="the-stiffness-matrix-for-the-poisson-problem">The stiffness matrix for the Poisson problem</h2>

<p>For simplicity, we will first consider the <a href="Poisson_problem" title="wikilink">Poisson problem</a></p>

<p>

<math display="block" id="Stiffness_matrix:0">
 <semantics>
  <mrow>
   <mrow>
    <mo>-</mo>
    <mrow>
     <msup>
      <mo>∇</mo>
      <mn>2</mn>
     </msup>
     <mi>u</mi>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mi>f</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <minus></minus>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>normal-∇</ci>
       <cn type="integer">2</cn>
      </apply>
      <ci>u</ci>
     </apply>
    </apply>
    <ci>f</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   -\nabla^{2}u=f
  </annotation>
 </semantics>
</math>

</p>

<p>on some domain Ω, subject to the boundary condition <em>u</em> = 0 on the boundary of Ω. To discretize this equation by the finite element method, one chooses a set of <em>basis functions</em> {<em>φ</em><sub>1</sub>, ..., <em>φ</em><sub><em>n</em></sub>} defined on Ω which also vanish on the boundary. One then approximates</p>

<p>

<math display="block" id="Stiffness_matrix:1">
 <semantics>
  <mrow>
   <mrow>
    <mi>u</mi>
    <mo>≈</mo>
    <msup>
     <mi>u</mi>
     <mi>h</mi>
    </msup>
    <mo>=</mo>
    <mrow>
     <mrow>
      <msub>
       <mi>u</mi>
       <mn>1</mn>
      </msub>
      <msub>
       <mi>φ</mi>
       <mn>1</mn>
      </msub>
     </mrow>
     <mo>+</mo>
     <mi mathvariant="normal">⋯</mi>
     <mo>+</mo>
     <mrow>
      <msub>
       <mi>u</mi>
       <mi>n</mi>
      </msub>
      <msub>
       <mi>φ</mi>
       <mi>n</mi>
      </msub>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <approx></approx>
     <ci>u</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>u</ci>
      <ci>h</ci>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <plus></plus>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>u</ci>
        <cn type="integer">1</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>φ</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <ci>normal-⋯</ci>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>u</ci>
        <ci>n</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>φ</ci>
        <ci>n</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   u\approx u^{h}=u_{1}\varphi_{1}+\cdots+u_{n}\varphi_{n}.
  </annotation>
 </semantics>
</math>

</p>

<p>The coefficients <em>u</em><sub>1</sub>, ..., <em>u</em><sub><em>n</em></sub> are determined so that the error in the approximation is orthogonal to each basis function <em>φ</em><sub><em>i</em></sub>:</p>

<p>

<math display="block" id="Stiffness_matrix:2">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <msub>
      <mo largeop="true" symmetric="true">∫</mo>
      <mi mathvariant="normal">Ω</mi>
     </msub>
     <mrow>
      <mrow>
       <msub>
        <mi>φ</mi>
        <mi>i</mi>
       </msub>
       <mo>⋅</mo>
       <mpadded width="+1.7pt">
        <mi>f</mi>
       </mpadded>
      </mrow>
      <mi>d</mi>
      <mi>x</mi>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mo>-</mo>
     <mrow>
      <msub>
       <mo largeop="true" symmetric="true">∫</mo>
       <mi mathvariant="normal">Ω</mi>
      </msub>
      <mrow>
       <msub>
        <mi>φ</mi>
        <mi>i</mi>
       </msub>
       <mrow>
        <msup>
         <mo>∇</mo>
         <mn>2</mn>
        </msup>
        <mrow>
         <mpadded width="+1.7pt">
          <msup>
           <mi>u</mi>
           <mi>h</mi>
          </msup>
         </mpadded>
         <mi>d</mi>
         <mi>x</mi>
        </mrow>
       </mrow>
      </mrow>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mo>-</mo>
     <mrow>
      <munder>
       <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
       <mi>j</mi>
      </munder>
      <mrow>
       <mrow>
        <mo>(</mo>
        <mrow>
         <msub>
          <mo largeop="true" symmetric="true">∫</mo>
          <mi mathvariant="normal">Ω</mi>
         </msub>
         <mrow>
          <msub>
           <mi>φ</mi>
           <mi>i</mi>
          </msub>
          <mrow>
           <msup>
            <mo>∇</mo>
            <mn>2</mn>
           </msup>
           <mrow>
            <mpadded width="+1.7pt">
             <msub>
              <mi>φ</mi>
              <mi>j</mi>
             </msub>
            </mpadded>
            <mi>d</mi>
            <mi>x</mi>
           </mrow>
          </mrow>
         </mrow>
        </mrow>
        <mo rspace="4.2pt">)</mo>
       </mrow>
       <msub>
        <mi>u</mi>
        <mi>j</mi>
       </msub>
      </mrow>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <munder>
      <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
      <mi>j</mi>
     </munder>
     <mrow>
      <mrow>
       <mo>(</mo>
       <mrow>
        <msub>
         <mo largeop="true" symmetric="true">∫</mo>
         <mi mathvariant="normal">Ω</mi>
        </msub>
        <mrow>
         <mrow>
          <mo>∇</mo>
          <msub>
           <mi>φ</mi>
           <mi>i</mi>
          </msub>
         </mrow>
         <mo>⋅</mo>
         <mrow>
          <mo>∇</mo>
          <mrow>
           <mpadded width="+1.7pt">
            <msub>
             <mi>φ</mi>
             <mi>j</mi>
            </msub>
           </mpadded>
           <mi>d</mi>
           <mi>x</mi>
          </mrow>
         </mrow>
        </mrow>
       </mrow>
       <mo>)</mo>
      </mrow>
      <msub>
       <mi>u</mi>
       <mi>j</mi>
      </msub>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <int></int>
       <ci>normal-Ω</ci>
      </apply>
      <apply>
       <times></times>
       <apply>
        <ci>normal-⋅</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>φ</ci>
         <ci>i</ci>
        </apply>
        <ci>f</ci>
       </apply>
       <ci>d</ci>
       <ci>x</ci>
      </apply>
     </apply>
     <apply>
      <minus></minus>
      <apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <int></int>
        <ci>normal-Ω</ci>
       </apply>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>φ</ci>
         <ci>i</ci>
        </apply>
        <apply>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>normal-∇</ci>
          <cn type="integer">2</cn>
         </apply>
         <apply>
          <times></times>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <ci>u</ci>
           <ci>h</ci>
          </apply>
          <ci>d</ci>
          <ci>x</ci>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <minus></minus>
      <apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <ci>j</ci>
       </apply>
       <apply>
        <times></times>
        <apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <int></int>
          <ci>normal-Ω</ci>
         </apply>
         <apply>
          <times></times>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>φ</ci>
           <ci>i</ci>
          </apply>
          <apply>
           <apply>
            <csymbol cd="ambiguous">superscript</csymbol>
            <ci>normal-∇</ci>
            <cn type="integer">2</cn>
           </apply>
           <apply>
            <times></times>
            <apply>
             <csymbol cd="ambiguous">subscript</csymbol>
             <ci>φ</ci>
             <ci>j</ci>
            </apply>
            <ci>d</ci>
            <ci>x</ci>
           </apply>
          </apply>
         </apply>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>u</ci>
         <ci>j</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <ci>j</ci>
      </apply>
      <apply>
       <times></times>
       <apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <int></int>
         <ci>normal-Ω</ci>
        </apply>
        <apply>
         <ci>normal-⋅</ci>
         <apply>
          <ci>normal-∇</ci>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>φ</ci>
           <ci>i</ci>
          </apply>
         </apply>
         <apply>
          <ci>normal-∇</ci>
          <apply>
           <times></times>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <ci>φ</ci>
            <ci>j</ci>
           </apply>
           <ci>d</ci>
           <ci>x</ci>
          </apply>
         </apply>
        </apply>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>u</ci>
        <ci>j</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \int_{\Omega}\varphi_{i}\cdot f\,dx=-\int_{\Omega}\varphi_{i}\nabla^{2}u^{h}\,%
dx=-\sum_{j}\left(\int_{\Omega}\varphi_{i}\nabla^{2}\varphi_{j}\,dx\right)\,u_%
{j}=\sum_{j}\left(\int_{\Omega}\nabla\varphi_{i}\cdot\nabla\varphi_{j}\,dx%
\right)u_{j}.
  </annotation>
 </semantics>
</math>

</p>

<p>The <strong>stiffness matrix</strong> is the n-element square matrix A defined by</p>

<p>

<math display="block" id="Stiffness_matrix:3">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>A</mi>
     <mrow>
      <mi>i</mi>
      <mi>j</mi>
     </mrow>
    </msub>
    <mo>=</mo>
    <mrow>
     <msub>
      <mo largeop="true" symmetric="true">∫</mo>
      <mi mathvariant="normal">Ω</mi>
     </msub>
     <mrow>
      <mrow>
       <mo>∇</mo>
       <msub>
        <mi>φ</mi>
        <mi>i</mi>
       </msub>
      </mrow>
      <mo>⋅</mo>
      <mrow>
       <mo>∇</mo>
       <mrow>
        <mpadded width="+1.7pt">
         <msub>
          <mi>φ</mi>
          <mi>j</mi>
         </msub>
        </mpadded>
        <mi>d</mi>
        <mi>x</mi>
       </mrow>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>A</ci>
     <apply>
      <times></times>
      <ci>i</ci>
      <ci>j</ci>
     </apply>
    </apply>
    <apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <int></int>
      <ci>normal-Ω</ci>
     </apply>
     <apply>
      <ci>normal-⋅</ci>
      <apply>
       <ci>normal-∇</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>φ</ci>
        <ci>i</ci>
       </apply>
      </apply>
      <apply>
       <ci>normal-∇</ci>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>φ</ci>
         <ci>j</ci>
        </apply>
        <ci>d</ci>
        <ci>x</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A_{ij}=\int_{\Omega}\nabla\varphi_{i}\cdot\nabla\varphi_{j}\,dx.
  </annotation>
 </semantics>
</math>

</p>

<p>By defining the vector <em>F</em> with components <em>F</em><sub><em>i</em></sub> = (<em>φ</em><sub><em>i</em></sub>, <em>f</em>), the coefficients <em>u</em><sub><em>i</em></sub> are determined by the linear system <em>AU</em> = <em>F</em>. The stiffness matrix is symmetric, i.e. <em>A</em><sub><em>ij</em></sub> = <em>A</em><sub><em>ji</em></sub>, so all its eigenvalues are real. Moreover, it is a strictly <a href="positive-definite_matrix" title="wikilink">positive-definite matrix</a>, so that the system <em>AU</em> = <em>F</em> always has a unique solution. (For other problems, these nice properties will be lost.)</p>

<p>Note that the stiffness matrix will be different depending on the computational grid used for the domain and what type of finite element is used. For example, the stiffness matrix when piecewise quadratic finite elements are used will have more degrees of freedom than piecewise linear elements.</p>
<h2 id="the-stiffness-matrix-for-other-problems">The stiffness matrix for other problems</h2>

<p>Determining the stiffness matrix for other PDE follows essentially the same procedure, but it can be complicated by the choice of boundary conditions. As a more complex example, consider the elliptic equation</p>

<p>

<math display="block" id="Stiffness_matrix:4">
 <semantics>
  <mrow>
   <mrow>
    <mo>-</mo>
    <mrow>
     <munder>
      <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
      <mrow>
       <mi>k</mi>
       <mo>,</mo>
       <mi>l</mi>
      </mrow>
     </munder>
     <mrow>
      <mfrac>
       <mo>∂</mo>
       <mrow>
        <mo>∂</mo>
        <msub>
         <mi>x</mi>
         <mi>k</mi>
        </msub>
       </mrow>
      </mfrac>
      <mrow>
       <mo>(</mo>
       <mrow>
        <msup>
         <mi>a</mi>
         <mrow>
          <mi>k</mi>
          <mi>l</mi>
         </mrow>
        </msup>
        <mfrac>
         <mrow>
          <mo>∂</mo>
          <mi>u</mi>
         </mrow>
         <mrow>
          <mo>∂</mo>
          <msub>
           <mi>x</mi>
           <mi>l</mi>
          </msub>
         </mrow>
        </mfrac>
       </mrow>
       <mo>)</mo>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mi>f</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <minus></minus>
     <apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <list>
        <ci>k</ci>
        <ci>l</ci>
       </list>
      </apply>
      <apply>
       <times></times>
       <apply>
        <divide></divide>
        <partialdiff></partialdiff>
        <apply>
         <partialdiff></partialdiff>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>x</ci>
          <ci>k</ci>
         </apply>
        </apply>
       </apply>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>a</ci>
         <apply>
          <times></times>
          <ci>k</ci>
          <ci>l</ci>
         </apply>
        </apply>
        <apply>
         <divide></divide>
         <apply>
          <partialdiff></partialdiff>
          <ci>u</ci>
         </apply>
         <apply>
          <partialdiff></partialdiff>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>x</ci>
           <ci>l</ci>
          </apply>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
    <ci>f</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   -\sum_{k,l}\frac{\partial}{\partial x_{k}}\left(a^{kl}\frac{\partial u}{%
\partial x_{l}}\right)=f
  </annotation>
 </semantics>
</math>

</p>

<p>where <em>A</em>(<em>x</em>) = <em>a</em><sup><em>kl</em></sup>(<em>x</em>) is a positive-definite matrix defined for each point <em>x</em> in the domain. We impose the Robin boundary condition</p>

<p>

<math display="block" id="Stiffness_matrix:5">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mo>-</mo>
     <mrow>
      <munder>
       <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
       <mrow>
        <mi>k</mi>
        <mo>,</mo>
        <mi>l</mi>
       </mrow>
      </munder>
      <mrow>
       <msub>
        <mi>ν</mi>
        <mi>k</mi>
       </msub>
       <msup>
        <mi>a</mi>
        <mrow>
         <mi>k</mi>
         <mi>l</mi>
        </mrow>
       </msup>
       <mfrac>
        <mrow>
         <mo>∂</mo>
         <mi>u</mi>
        </mrow>
        <mrow>
         <mo>∂</mo>
         <msub>
          <mi>x</mi>
          <mi>l</mi>
         </msub>
        </mrow>
       </mfrac>
      </mrow>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mi>c</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mi>u</mi>
       <mo>-</mo>
       <mi>g</mi>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <minus></minus>
     <apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <list>
        <ci>k</ci>
        <ci>l</ci>
       </list>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>ν</ci>
        <ci>k</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>a</ci>
        <apply>
         <times></times>
         <ci>k</ci>
         <ci>l</ci>
        </apply>
       </apply>
       <apply>
        <divide></divide>
        <apply>
         <partialdiff></partialdiff>
         <ci>u</ci>
        </apply>
        <apply>
         <partialdiff></partialdiff>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>x</ci>
          <ci>l</ci>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <times></times>
     <ci>c</ci>
     <apply>
      <minus></minus>
      <ci>u</ci>
      <ci>g</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   -\sum_{k,l}\nu_{k}a^{kl}\frac{\partial u}{\partial x_{l}}=c(u-g),
  </annotation>
 </semantics>
</math>

</p>

<p>where <em>ν</em><sub><em>k</em></sub> is the component of the unit outward normal vector <em>ν</em> in the <em>k</em>-th direction. The system to be solved is</p>

<p>

<math display="block" id="Stiffness_matrix:6">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <munder>
      <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
      <mi>j</mi>
     </munder>
     <mrow>
      <mrow>
       <mo>(</mo>
       <mrow>
        <mrow>
         <munder>
          <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
          <mrow>
           <mi>k</mi>
           <mo>,</mo>
           <mi>l</mi>
          </mrow>
         </munder>
         <mrow>
          <msub>
           <mo largeop="true" symmetric="true">∫</mo>
           <mi mathvariant="normal">Ω</mi>
          </msub>
          <mrow>
           <msup>
            <mi>a</mi>
            <mrow>
             <mi>k</mi>
             <mi>l</mi>
            </mrow>
           </msup>
           <mfrac>
            <mrow>
             <mo>∂</mo>
             <msub>
              <mi>φ</mi>
              <mi>i</mi>
             </msub>
            </mrow>
            <mrow>
             <mo>∂</mo>
             <msub>
              <mi>x</mi>
              <mi>k</mi>
             </msub>
            </mrow>
           </mfrac>
           <mfrac>
            <mrow>
             <mo>∂</mo>
             <msub>
              <mi>φ</mi>
              <mi>j</mi>
             </msub>
            </mrow>
            <mrow>
             <mo>∂</mo>
             <msub>
              <mi>x</mi>
              <mi>l</mi>
             </msub>
            </mrow>
           </mfrac>
           <mi>d</mi>
           <mi>x</mi>
          </mrow>
         </mrow>
        </mrow>
        <mo>+</mo>
        <mrow>
         <msub>
          <mo largeop="true" symmetric="true">∫</mo>
          <mrow>
           <mo>∂</mo>
           <mi mathvariant="normal">Ω</mi>
          </mrow>
         </msub>
         <mrow>
          <mi>c</mi>
          <msub>
           <mi>φ</mi>
           <mi>i</mi>
          </msub>
          <mpadded width="+1.7pt">
           <msub>
            <mi>φ</mi>
            <mi>j</mi>
           </msub>
          </mpadded>
          <mi>d</mi>
          <mi>s</mi>
         </mrow>
        </mrow>
       </mrow>
       <mo>)</mo>
      </mrow>
      <msub>
       <mi>u</mi>
       <mi>j</mi>
      </msub>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mrow>
      <msub>
       <mo largeop="true" symmetric="true">∫</mo>
       <mi mathvariant="normal">Ω</mi>
      </msub>
      <mrow>
       <msub>
        <mi>φ</mi>
        <mi>i</mi>
       </msub>
       <mpadded width="+1.7pt">
        <mi>f</mi>
       </mpadded>
       <mi>d</mi>
       <mi>x</mi>
      </mrow>
     </mrow>
     <mo>+</mo>
     <mrow>
      <msub>
       <mo largeop="true" symmetric="true">∫</mo>
       <mrow>
        <mo>∂</mo>
        <mi mathvariant="normal">Ω</mi>
       </mrow>
      </msub>
      <mrow>
       <mi>c</mi>
       <msub>
        <mi>φ</mi>
        <mi>i</mi>
       </msub>
       <mpadded width="+1.7pt">
        <mi>g</mi>
       </mpadded>
       <mi>d</mi>
       <mi>s</mi>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <sum></sum>
      <ci>j</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <plus></plus>
       <apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <sum></sum>
         <list>
          <ci>k</ci>
          <ci>l</ci>
         </list>
        </apply>
        <apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <int></int>
          <ci>normal-Ω</ci>
         </apply>
         <apply>
          <times></times>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <ci>a</ci>
           <apply>
            <times></times>
            <ci>k</ci>
            <ci>l</ci>
           </apply>
          </apply>
          <apply>
           <divide></divide>
           <apply>
            <partialdiff></partialdiff>
            <apply>
             <csymbol cd="ambiguous">subscript</csymbol>
             <ci>φ</ci>
             <ci>i</ci>
            </apply>
           </apply>
           <apply>
            <partialdiff></partialdiff>
            <apply>
             <csymbol cd="ambiguous">subscript</csymbol>
             <ci>x</ci>
             <ci>k</ci>
            </apply>
           </apply>
          </apply>
          <apply>
           <divide></divide>
           <apply>
            <partialdiff></partialdiff>
            <apply>
             <csymbol cd="ambiguous">subscript</csymbol>
             <ci>φ</ci>
             <ci>j</ci>
            </apply>
           </apply>
           <apply>
            <partialdiff></partialdiff>
            <apply>
             <csymbol cd="ambiguous">subscript</csymbol>
             <ci>x</ci>
             <ci>l</ci>
            </apply>
           </apply>
          </apply>
          <ci>d</ci>
          <ci>x</ci>
         </apply>
        </apply>
       </apply>
       <apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <int></int>
         <apply>
          <partialdiff></partialdiff>
          <ci>normal-Ω</ci>
         </apply>
        </apply>
        <apply>
         <times></times>
         <ci>c</ci>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>φ</ci>
          <ci>i</ci>
         </apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>φ</ci>
          <ci>j</ci>
         </apply>
         <ci>d</ci>
         <ci>s</ci>
        </apply>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>u</ci>
       <ci>j</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <int></int>
       <ci>normal-Ω</ci>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>φ</ci>
        <ci>i</ci>
       </apply>
       <ci>f</ci>
       <ci>d</ci>
       <ci>x</ci>
      </apply>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <int></int>
       <apply>
        <partialdiff></partialdiff>
        <ci>normal-Ω</ci>
       </apply>
      </apply>
      <apply>
       <times></times>
       <ci>c</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>φ</ci>
        <ci>i</ci>
       </apply>
       <ci>g</ci>
       <ci>d</ci>
       <ci>s</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \sum_{j}\left(\sum_{k,l}\int_{\Omega}a^{kl}\frac{\partial\varphi_{i}}{\partial
x%
_{k}}\frac{\partial\varphi_{j}}{\partial x_{l}}dx+\int_{\partial\Omega}c%
\varphi_{i}\varphi_{j}\,ds\right)u_{j}=\int_{\Omega}\varphi_{i}f\,dx+\int_{%
\partial\Omega}c\varphi_{i}g\,ds,
  </annotation>
 </semantics>
</math>

</p>

<p>as can be shown using an analogue of Green's identity. The coefficients <em>u</em><sub><em>i</em></sub> are still found by solving a system of linear equations, but the matrix representing the system is markedly different from that for the ordinary Poisson problem.</p>

<p>In general, to each scalar elliptic operator <em>L</em> of order 2<em>k</em>, there is associated a bilinear form <em>B</em> on the <a href="Sobolev_space" title="wikilink">Sobolev space</a> <em>H</em><sup><em>k</em></sup>, so that the <a href="weak_formulation" title="wikilink">weak formulation</a> of the equation <em>Lu</em> = <em>f</em> is</p>

<p>

<math display="block" id="Stiffness_matrix:7">
 <semantics>
  <mrow>
   <mrow>
    <mi>B</mi>
    <mrow>
     <mo stretchy="false">[</mo>
     <mi>u</mi>
     <mo>,</mo>
     <mi>v</mi>
     <mo stretchy="false">]</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>f</mi>
    <mo>,</mo>
    <mi>v</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>B</ci>
     <interval closure="closed">
      <ci>u</ci>
      <ci>v</ci>
     </interval>
    </apply>
    <interval closure="open">
     <ci>f</ci>
     <ci>v</ci>
    </interval>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   B[u,v]=(f,v)
  </annotation>
 </semantics>
</math>

</p>

<p>for all functions <em>v</em> in <em>H</em><sup><em>k</em></sup>. Then the stiffness matrix for this problem is</p>

<p>

<math display="block" id="Stiffness_matrix:8">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>A</mi>
     <mrow>
      <mi>i</mi>
      <mi>j</mi>
     </mrow>
    </msub>
    <mo>=</mo>
    <mrow>
     <mi>B</mi>
     <mrow>
      <mo stretchy="false">[</mo>
      <msub>
       <mi>φ</mi>
       <mi>j</mi>
      </msub>
      <mo>,</mo>
      <msub>
       <mi>φ</mi>
       <mi>i</mi>
      </msub>
      <mo stretchy="false">]</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>A</ci>
     <apply>
      <times></times>
      <ci>i</ci>
      <ci>j</ci>
     </apply>
    </apply>
    <apply>
     <times></times>
     <ci>B</ci>
     <interval closure="closed">
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>φ</ci>
       <ci>j</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>φ</ci>
       <ci>i</ci>
      </apply>
     </interval>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A_{ij}=B[\varphi_{j},\varphi_{i}].
  </annotation>
 </semantics>
</math>

</p>
<h2 id="practical-assembly-of-the-stiffness-matrix">Practical assembly of the stiffness matrix</h2>

<p>In order to implement the finite element method on a computer, one must first choose a set of basis functions and then compute the integrals defining the stiffness matrix. Usually, the domain Ω is discretized by some form of <a href="mesh_generation" title="wikilink">mesh generation</a>, wherein it is divided into non-overlapping triangles or quadrilaterals, which are generally referred to as elements. The basis functions are then chosen to be polynomials of some order within each element, and continuous across element boundaries. The simplest choices are piecewise linear for triangular elements and piecewise bilinear for rectangular elements.</p>

<p>The <strong>element stiffness matrix</strong> <em>A</em><sup>[<em>k</em>]</sup> for element <em>T</em><sub><em>k</em></sub> is the matrix</p>

<p>

<math display="block" id="Stiffness_matrix:9">
 <semantics>
  <mrow>
   <mrow>
    <msubsup>
     <mi>A</mi>
     <mrow>
      <mi>i</mi>
      <mi>j</mi>
     </mrow>
     <mrow>
      <mo stretchy="false">[</mo>
      <mi>k</mi>
      <mo stretchy="false">]</mo>
     </mrow>
    </msubsup>
    <mo>=</mo>
    <mrow>
     <msub>
      <mo largeop="true" symmetric="true">∫</mo>
      <msub>
       <mi>T</mi>
       <mi>k</mi>
      </msub>
     </msub>
     <mrow>
      <mrow>
       <mo>∇</mo>
       <msub>
        <mi>φ</mi>
        <mi>i</mi>
       </msub>
      </mrow>
      <mo>⋅</mo>
      <mrow>
       <mo>∇</mo>
       <mrow>
        <mpadded width="+1.7pt">
         <msub>
          <mi>φ</mi>
          <mi>j</mi>
         </msub>
        </mpadded>
        <mi>d</mi>
        <mi>x</mi>
       </mrow>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>A</ci>
      <apply>
       <csymbol cd="latexml">delimited-[]</csymbol>
       <ci>k</ci>
      </apply>
     </apply>
     <apply>
      <times></times>
      <ci>i</ci>
      <ci>j</ci>
     </apply>
    </apply>
    <apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <int></int>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>T</ci>
       <ci>k</ci>
      </apply>
     </apply>
     <apply>
      <ci>normal-⋅</ci>
      <apply>
       <ci>normal-∇</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>φ</ci>
        <ci>i</ci>
       </apply>
      </apply>
      <apply>
       <ci>normal-∇</ci>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>φ</ci>
         <ci>j</ci>
        </apply>
        <ci>d</ci>
        <ci>x</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A^{[k]}_{ij}=\int_{T_{k}}\nabla\varphi_{i}\cdot\nabla\varphi_{j}\,dx.
  </annotation>
 </semantics>
</math>

</p>

<p>The element stiffness matrix is zero for most values of i and j, for which the corresponding basis functions are zero within <em>T</em><sub><em>k</em></sub>. The full stiffness matrix <em>A</em> is the sum of the element stiffness matrices. In particular, for basis functions that are only supported locally, the stiffness matrix is <a href="sparse_matrix" title="wikilink">sparse</a>.</p>

<p>For many standard choices of basis functions, i.e. piecewise linear basis functions on triangles, there are simple formulas for the element stiffness matrices. For example, for piecewise linear elements, consider a triangle with vertices (<em>x</em><sub>1</sub>,<em>y</em><sub>1</sub>), (<em>x</em><sub>2</sub>,<em>y</em><sub>2</sub>), (<em>x</em><sub>3</sub>,<em>y</em><sub>3</sub>), and define the 2×3 matrix</p>

<p>

<math display="block" id="Stiffness_matrix:10">
 <semantics>
  <mrow>
   <mrow>
    <mi>D</mi>
    <mo>=</mo>
    <mrow>
     <mo>[</mo>
     <mtable displaystyle="true">
      <mtr>
       <mtd columnalign="center">
        <mrow>
         <msub>
          <mi>x</mi>
          <mn>3</mn>
         </msub>
         <mo>-</mo>
         <msub>
          <mi>x</mi>
          <mn>2</mn>
         </msub>
        </mrow>
       </mtd>
       <mtd columnalign="center">
        <mrow>
         <msub>
          <mi>x</mi>
          <mn>1</mn>
         </msub>
         <mo>-</mo>
         <msub>
          <mi>x</mi>
          <mn>3</mn>
         </msub>
        </mrow>
       </mtd>
       <mtd columnalign="center">
        <mrow>
         <msub>
          <mi>x</mi>
          <mn>2</mn>
         </msub>
         <mo>-</mo>
         <msub>
          <mi>x</mi>
          <mn>1</mn>
         </msub>
        </mrow>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mrow>
         <msub>
          <mi>y</mi>
          <mn>3</mn>
         </msub>
         <mo>-</mo>
         <msub>
          <mi>y</mi>
          <mn>2</mn>
         </msub>
        </mrow>
       </mtd>
       <mtd columnalign="center">
        <mrow>
         <msub>
          <mi>y</mi>
          <mn>1</mn>
         </msub>
         <mo>-</mo>
         <msub>
          <mi>y</mi>
          <mn>3</mn>
         </msub>
        </mrow>
       </mtd>
       <mtd columnalign="center">
        <mrow>
         <msub>
          <mi>y</mi>
          <mn>2</mn>
         </msub>
         <mo>-</mo>
         <msub>
          <mi>y</mi>
          <mn>1</mn>
         </msub>
        </mrow>
       </mtd>
      </mtr>
     </mtable>
     <mo>]</mo>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>D</ci>
    <apply>
     <csymbol cd="latexml">delimited-[]</csymbol>
     <matrix>
      <matrixrow>
       <apply>
        <minus></minus>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>x</ci>
         <cn type="integer">3</cn>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>x</ci>
         <cn type="integer">2</cn>
        </apply>
       </apply>
       <apply>
        <minus></minus>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>x</ci>
         <cn type="integer">1</cn>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>x</ci>
         <cn type="integer">3</cn>
        </apply>
       </apply>
       <apply>
        <minus></minus>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>x</ci>
         <cn type="integer">2</cn>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>x</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
      </matrixrow>
      <matrixrow>
       <apply>
        <minus></minus>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>y</ci>
         <cn type="integer">3</cn>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>y</ci>
         <cn type="integer">2</cn>
        </apply>
       </apply>
       <apply>
        <minus></minus>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>y</ci>
         <cn type="integer">1</cn>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>y</ci>
         <cn type="integer">3</cn>
        </apply>
       </apply>
       <apply>
        <minus></minus>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>y</ci>
         <cn type="integer">2</cn>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>y</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
      </matrixrow>
     </matrix>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   D=\left[\begin{matrix}x_{3}-x_{2}&x_{1}-x_{3}&x_{2}-x_{1}\\
y_{3}-y_{2}&y_{1}-y_{3}&y_{2}-y_{1}\end{matrix}\right].
  </annotation>
 </semantics>
</math>

</p>

<p>Then the element stiffness matrix is</p>

<p>

<math display="block" id="Stiffness_matrix:11">
 <semantics>
  <mrow>
   <msup>
    <mi>A</mi>
    <mrow>
     <mo stretchy="false">[</mo>
     <mi>k</mi>
     <mo stretchy="false">]</mo>
    </mrow>
   </msup>
   <mo>=</mo>
   <mrow>
    <mrow>
     <msup>
      <mi>D</mi>
      <mo>⊤</mo>
     </msup>
     <mi>D</mi>
    </mrow>
    <mo>/</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mrow>
       <mn>4</mn>
       <mo>⋅</mo>
       <mi>area</mi>
      </mrow>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>T</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>A</ci>
     <apply>
      <csymbol cd="latexml">delimited-[]</csymbol>
      <ci>k</ci>
     </apply>
    </apply>
    <apply>
     <divide></divide>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>D</ci>
       <csymbol cd="latexml">top</csymbol>
      </apply>
      <ci>D</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <ci>normal-⋅</ci>
       <cn type="integer">4</cn>
       <ci>area</ci>
      </apply>
      <ci>T</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A^{[k]}=D^{\top}D/(4\cdot\mathrm{area}(T))
  </annotation>
 </semantics>
</math>

.</p>

<p>When the differential equation is more complicated, say by having an inhomogeneous diffusion coefficient, the integral defining the element stiffness matrix can be evaluated by <a href="Gaussian_quadrature" title="wikilink">Gaussian quadrature</a>.</p>

<p>The <a href="condition_number" title="wikilink">condition number</a> of the stiffness matrix depends strongly on the quality of the numerical grid. In particular, triangles with small angles in the finite element mesh induce large eigenvalues of the stiffness matrix, degrading the solution quality.</p>
<h2 id="references">References</h2>
<ul>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
</ul>

<p>"</p>

<p><a href="Category:Applied_mathematics" title="wikilink">Category:Applied mathematics</a> <a href="Category:Numerical_analysis" title="wikilink">Category:Numerical analysis</a></p>
</body>
</html>

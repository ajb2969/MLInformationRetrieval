   Lucas sequence      Lucas sequence   In mathematics , the Lucas sequences  U n ( P , Q ) and V n ( P , Q ) are certain integer sequences that satisfy the recurrence relation   x n = P x n −1 − Q x n −2    where P and Q are fixed integers. Any other sequence satisfying this recurrence relation can be represented as a linear combination of the Lucas sequences U n ( P , Q ) and V n ( P , Q ).  More generally, Lucas sequences U n ( P , Q ) and V n ( P , Q ) represent sequences of polynomials in P and Q with integer coefficients.  Famous examples of Lucas sequences include the Fibonacci numbers , Mersenne numbers , Pell numbers , Lucas numbers , Jacobsthal numbers , and a superset of Fermat numbers . Lucas sequences are named after the French  mathematician  Édouard Lucas .  Recurrence relations  Given two integer parameters P and Q , the Lucas sequences of the first kind U n ( P , Q ) and of the second kind V n ( P , Q ) are defined by the recurrence relations :         U  0    (  P  ,  Q  )    =  0   ,         subscript  U  0    P  Q    0    U_{0}(P,Q)=0,\,            U  1    (  P  ,  Q  )    =  1   ,         subscript  U  1    P  Q    1    U_{1}(P,Q)=1,\,            U  n    (  P  ,  Q  )    =     P  ⋅   U   n  -  1      (  P  ,  Q  )    -    Q  ⋅   U   n  -  2      (  P  ,  Q  )   for  n    >  1   ,           subscript  U  n    P  Q         normal-⋅  P   subscript  U    n  1      P  Q       normal-⋅  Q   subscript  U    n  2      P  Q   for  n         1     U_{n}(P,Q)=P\cdot U_{n-1}(P,Q)-Q\cdot U_{n-2}(P,Q)\mbox{ for }n>1,\,     and         V  0    (  P  ,  Q  )    =  2   ,         subscript  V  0    P  Q    2    V_{0}(P,Q)=2,\,            V  1    (  P  ,  Q  )    =  P   ,         subscript  V  1    P  Q    P    V_{1}(P,Q)=P,\,            V  n    (  P  ,  Q  )    =     P  ⋅   V   n  -  1      (  P  ,  Q  )    -    Q  ⋅   V   n  -  2      (  P  ,  Q  )   for  n    >  1   ,           subscript  V  n    P  Q         normal-⋅  P   subscript  V    n  1      P  Q       normal-⋅  Q   subscript  V    n  2      P  Q   for  n         1     V_{n}(P,Q)=P\cdot V_{n-1}(P,Q)-Q\cdot V_{n-2}(P,Q)\mbox{ for }n>1,\,     It is not hard to show that for    n  >  0      n  0    n>0   ,         U  n    (  P  ,  Q  )    =      P  ⋅   U   n  -  1      (  P  ,  Q  )    +    V   n  -  1     (  P  ,  Q  )     2    ,         subscript  U  n    P  Q           normal-⋅  P   subscript  U    n  1      P  Q       subscript  V    n  1     P  Q     2     U_{n}(P,Q)=\frac{P\cdot U_{n-1}(P,Q)+V_{n-1}(P,Q)}{2},\,            V  n    (  P  ,  Q  )    =       (    P  2   -   4  Q    )   ⋅   U   n  -  1      (  P  ,  Q  )    +    P  ⋅   V   n  -  1      (  P  ,  Q  )     2    .         subscript  V  n    P  Q           normal-⋅     superscript  P  2     4  Q     subscript  U    n  1      P  Q       normal-⋅  P   subscript  V    n  1      P  Q     2     V_{n}(P,Q)=\frac{(P^{2}-4Q)\cdot U_{n-1}(P,Q)+P\cdot V_{n-1}(P,Q)}{2}.\,     Examples  Initial terms of Lucas sequences U n ( P , Q ) and V n ( P , Q ) are given in the table:          n    n   n\,           U  n    (  P  ,  Q  )        subscript  U  n    P  Q     U_{n}(P,Q)\,           V  n    (  P  ,  Q  )        subscript  V  n    P  Q     V_{n}(P,Q)\,              0    0   0\,          0    0   0\,          2    2   2\,            1    1   1\,          1    1   1\,          P    P   P\,            2    2   2\,          P    P   P\,           P  2   -   2   Q         superscript  P  2     2  Q     {P}^{2}-2Q\,            3    3   3\,           P  2   -   Q        superscript  P  2   Q    {P}^{2}-Q\,           P  3   -   3  P   Q         superscript  P  3     3  P  Q     {P}^{3}-3PQ\,            4    4   4\,           P  3   -   2  P   Q         superscript  P  3     2  P  Q     {P}^{3}-2PQ\,            P  4   -   4   P  2   Q    +   2    Q  2            superscript  P  4     4   superscript  P  2   Q      2   superscript  Q  2      {P}^{4}-4{P}^{2}Q+2{Q}^{2}\,            5    5   5\,            P  4   -   3   P  2   Q    +    Q  2           superscript  P  4     3   superscript  P  2   Q     superscript  Q  2     {P}^{4}-3{P}^{2}Q+{Q}^{2}\,            P  5   -   5   P  3   Q    +   5  P    Q  2            superscript  P  5     5   superscript  P  3   Q      5  P   superscript  Q  2      {P}^{5}-5{P}^{3}Q+5P{Q}^{2}\,            6    6   6\,            P  5   -   4   P  3   Q    +   3  P    Q  2            superscript  P  5     4   superscript  P  3   Q      3  P   superscript  Q  2      {P}^{5}-4{P}^{3}Q+3P{Q}^{2}\,             P  6   -   6   P  4   Q    +   9   P  2    Q  2     -   2    Q  3              superscript  P  6     6   superscript  P  4   Q      9   superscript  P  2    superscript  Q  2       2   superscript  Q  3      {P}^{6}-6{P}^{4}Q+9{P}^{2}{Q}^{2}-2{Q}^{3}\,        Algebraic relations  The characteristic equation of the recurrence relation for Lucas sequences     U  n    (  P  ,  Q  )        subscript  U  n    P  Q     U_{n}(P,Q)   and     V  n    (  P  ,  Q  )        subscript  V  n    P  Q     V_{n}(P,Q)   is:         x  2   -   P  x    +  Q   =   0            superscript  x  2     P  x    Q   0    x^{2}-Px+Q=0\,     It has the discriminant     D  =    P  2   -   4  Q        D     superscript  P  2     4  Q      D=P^{2}-4Q   and the roots:        a  =     P  +   D    2   and     b  =    P  -   D    2     .     formulae-sequence    a       P    D    2   and      b      P    D    2      a=\frac{P+\sqrt{D}}{2}\quad\text{and}\quad b=\frac{P-\sqrt{D}}{2}.\,     Thus:        a  +  b   =   P    ,        a  b   P    a+b=P\,,           a  b   =    1  4    (    P  2   -  D   )    =   Q    ,          a  b       1  4      superscript  P  2   D         Q     ab=\frac{1}{4}(P^{2}-D)=Q\,,           a  -  b   =    D     .        a  b     D     a-b=\sqrt{D}\,.     Note that the sequence    a  n     superscript  a  n    a^{n}   and the sequence    b  n     superscript  b  n    b^{n}   also satisfy the recurrence relation. However these might not be integer sequences.  Distinct roots  When    D  ≠  0      D  0    D\neq 0   , a and b are distinct and one quickly verifies that       a  n   =     V  n   +    U  n    D     2        superscript  a  n        subscript  V  n      subscript  U  n     D     2     a^{n}=\frac{V_{n}+U_{n}\sqrt{D}}{2}          b  n   =     V  n   -    U  n    D     2        superscript  b  n        subscript  V  n      subscript  U  n     D     2     b^{n}=\frac{V_{n}-U_{n}\sqrt{D}}{2}   .  It follows that the terms of Lucas sequences can be expressed in terms of a and b as follows       U  n   =     a  n   -   b  n     a  -  b    =     a  n   -   b  n     D           subscript  U  n        superscript  a  n    superscript  b  n      a  b              superscript  a  n    superscript  b  n      D       U_{n}=\frac{a^{n}-b^{n}}{a-b}=\frac{a^{n}-b^{n}}{\sqrt{D}}          V  n   =    a  n   +    b  n          subscript  V  n      superscript  a  n    superscript  b  n      V_{n}=a^{n}+b^{n}\,     Repeated root  The case    D  =  0      D  0    D=0   occurs exactly when    P  =   2  S  and  Q   =   S  2         P    2  S  and  Q         superscript  S  2      P=2S\text{ and }Q=S^{2}   for some integer S so that    a  =  b  =  S        a  b       S     a=b=S   . In this case one easily finds that        U  n    (  P  ,  Q  )    =    U  n    (   2  S   ,   S  2   )    =   n    S   n  -  1               subscript  U  n    P  Q       subscript  U  n      2  S    superscript  S  2            n   superscript  S    n  1        U_{n}(P,Q)=U_{n}(2S,S^{2})=nS^{n-1}\,           V  n    (  P  ,  Q  )    =    V  n    (   2  S   ,   S  2   )    =   2    S  n              subscript  V  n    P  Q       subscript  V  n      2  S    superscript  S  2            2   superscript  S  n       V_{n}(P,Q)=V_{n}(2S,S^{2})=2S^{n}\,   .  Additional sequences having the same discriminant  If the Lucas sequences     U  n    (  P  ,  Q  )        subscript  U  n    P  Q     U_{n}(P,Q)   and     V  n    (  P  ,  Q  )        subscript  V  n    P  Q     V_{n}(P,Q)   have discriminant    D  =    P  2   -   4  Q        D     superscript  P  2     4  Q      D=P^{2}-4Q   , then the sequences based on    P  2     subscript  P  2    P_{2}   and    Q  2     subscript  Q  2    Q_{2}   where       P  2   =   P  +  2        subscript  P  2     P  2     P_{2}=P+2          Q  2   =   P  +  Q  +  1        subscript  Q  2     P  Q  1     Q_{2}=P+Q+1   have the same discriminant      P  2  2   -   4   Q  2     =     (   P  +  2   )   2   -   4   (   P  +  Q  +  1   )     =    P  2   -   4  Q    =  D           superscript   subscript  P  2   2     4   subscript  Q  2        superscript    P  2   2     4    P  Q  1             superscript  P  2     4  Q         D     P_{2}^{2}-4Q_{2}=(P+2)^{2}-4(P+Q+1)=P^{2}-4Q=D   .  Other relations  The terms of Lucas sequences satisfy relations that are generalizations of those between Fibonacci numbers      F  n   =    U  n    (  1  ,   -  1   )         subscript  F  n      subscript  U  n    1    1       F_{n}=U_{n}(1,-1)   and Lucas numbers      L  n   =    V  n    (  1  ,   -  1   )         subscript  L  n      subscript  V  n    1    1       L_{n}=V_{n}(1,-1)   . For example:      General   P = 1, Q = -1             (    P  2   -   4  Q    )    U  n    =    V   n  +  1    -   Q   V   n  -  1      =    2   V   n  +  1     -   P    V  n                 superscript  P  2     4  Q     subscript  U  n       subscript  V    n  1      Q   subscript  V    n  1               2   subscript  V    n  1       P   subscript  V  n        (P^{2}-4Q)U_{n}={V_{n+1}-QV_{n-1}}=2V_{n+1}-PV_{n}\,           5   F  n    =    L   n  +  1    +   L   n  -  1     =    2   L   n  +  1     -    L  n             5   subscript  F  n       subscript  L    n  1     subscript  L    n  1              2   subscript  L    n  1      subscript  L  n       5F_{n}={L_{n+1}+L_{n-1}}=2L_{n+1}-L_{n}\,             V  n   =    U   n  +  1    -   Q   U   n  -  1      =    2   U   n  +  1     -   P    U  n             subscript  V  n      subscript  U    n  1      Q   subscript  U    n  1               2   subscript  U    n  1       P   subscript  U  n        V_{n}=U_{n+1}-QU_{n-1}=2U_{n+1}-PU_{n}\,           L  n   =    F   n  +  1    +   F   n  -  1     =    2   F   n  +  1     -    F  n            subscript  L  n      subscript  F    n  1     subscript  F    n  1              2   subscript  F    n  1      subscript  F  n       L_{n}=F_{n+1}+F_{n-1}=2F_{n+1}-F_{n}\,             U   2  n    =    U  n     V  n          subscript  U    2  n       subscript  U  n    subscript  V  n      U_{2n}=U_{n}V_{n}\,           F   2  n    =    F  n     L  n          subscript  F    2  n       subscript  F  n    subscript  L  n      F_{2n}=F_{n}L_{n}\,             V   2  n    =    V  n  2   -   2    Q  n           subscript  V    2  n       superscript   subscript  V  n   2     2   superscript  Q  n       V_{2n}=V_{n}^{2}-2Q^{n}\,           L   2  n    =    L  n  2   -   2     (   -  1   )   n           subscript  L    2  n       superscript   subscript  L  n   2     2   superscript    1   n       L_{2n}=L_{n}^{2}-2(-1)^{n}\,             U   n  +  m    =     U  n    U   m  +  1     -   Q   U  m    U   n  -  1      =       U  n    V  m    +    U  m    V  n     2           subscript  U    n  m         subscript  U  n    subscript  U    m  1       Q   subscript  U  m    subscript  U    n  1                  subscript  U  n    subscript  V  m       subscript  U  m    subscript  V  n     2      U_{n+m}=U_{n}U_{m+1}-QU_{m}U_{n-1}=\frac{U_{n}V_{m}+U_{m}V_{n}}{2}\,           F   n  +  m    =     F  n    F   m  +  1     +    F  m    F   n  -  1      =       F  n    L  m    +    F  m    L  n     2           subscript  F    n  m         subscript  F  n    subscript  F    m  1        subscript  F  m    subscript  F    n  1                  subscript  F  n    subscript  L  m       subscript  F  m    subscript  L  n     2      F_{n+m}=F_{n}F_{m+1}+F_{m}F_{n-1}=\frac{F_{n}L_{m}+F_{m}L_{n}}{2}\,             V   n  +  m    =     V  n    V  m    -    Q  m     V   n  -  m            subscript  V    n  m         subscript  V  n    subscript  V  m       superscript  Q  m    subscript  V    n  m        V_{n+m}=V_{n}V_{m}-Q^{m}V_{n-m}\,           L   n  +  m    =     L  n    L  m    -     (   -  1   )   m     L   n  -  m            subscript  L    n  m         subscript  L  n    subscript  L  m       superscript    1   m    subscript  L    n  m        L_{n+m}=L_{n}L_{m}-(-1)^{m}L_{n-m}\,        Among the consequences is that     U   k  m     (  P  ,  Q  )        subscript  U    k  m     P  Q     U_{km}(P,Q)   is a multiple of     U  m    (  P  ,  Q  )        subscript  U  m    P  Q     U_{m}(P,Q)   , i.e., the sequence     (    U  m    (  P  ,  Q  )    )    m  ≥  1      subscript     subscript  U  m    P  Q      m  1     (U_{m}(P,Q))_{m\geq 1}   is a divisibility sequence . This implies, in particular, that     U  n    (  P  ,  Q  )        subscript  U  n    P  Q     U_{n}(P,Q)   can be prime only when n is prime. Another consequence is an analog of exponentiation by squaring that allows fast computation of     U  n    (  P  ,  Q  )        subscript  U  n    P  Q     U_{n}(P,Q)   for large values of n . These facts are used in the Lucas–Lehmer primality test .  Carmichael's theorem states that all but finitely many of the terms in a Lucas sequence have a prime factor that does not divide any earlier term in the sequence .  Specific names  The Lucas sequences for some values of P and Q have specific names:   U n (1,−1) : Fibonacci numbers   V n (1,−1) : Lucas numbers   U n (2,−1) : Pell numbers   V n (2,−1) : Companion Pell numbers or Pell-Lucas numbers  U n (1,−2) : Jacobsthal numbers   V n (1,−2) : Jacobsthal-Lucas numbers   U n (3, 2) : Mersenne numbers 2 n − 1  V n (3, 2) : Numbers of the form 2 n + 1, which include the Fermat numbers .  U n ( x ,−1) : Fibonacci polynomials   V n ( x ,−1) : Lucas polynomials   U n ( x +1, x ) : Repunits base x   V n ( x +1, x ) : x n + 1   Some Lucas sequences have entries in the On-Line Encyclopedia of Integer Sequences :            P    P   P\,          Q    Q   Q\,           U  n    (  P  ,  Q  )        subscript  U  n    P  Q     U_{n}(P,Q)\,           V  n    (  P  ,  Q  )        subscript  V  n    P  Q     V_{n}(P,Q)\,          -1   3      1   -1       1   1       1   2      2   -1       2   1      2   2       2   3      2   4      2   5      3   -5       3   -4       3   -3       3   -2       3   -1       3   1       3   2       3   5      4   -3       4   -2      4   -1       4   1       4   2       4   3       4   4      5   -3      5   -2      5   -1       5   1       5   4         Applications   Lucas sequences are used in probabilistic Lucas pseudoprime tests, which are part of the commonly used Baillie-PSW primality test .    Lucas sequences are used in some primality proof methods, including the Lucas-Lehmer-Riesel test , and the N+1 and hybrid N-1/N+1 methods such as those in Brillhart-Lehmer-Selfridge 1975 1    LUC is a public-key cryptosystem based on Lucas sequences 2 that implements the analogs of ElGamal (LUCELG), Diffie-Hellman (LUCDIF), and RSA (LUCRSA). The encryption of the message in LUC is computed as a term of certain Lucas sequence, instead of using modular exponentiation as in RSA or Diffie-Hellman. However, a paper by Bleichenbacher et al. 3 shows that many of the supposed security advantages of LUC over cryptosystems based on modular exponentiation are either not present, or not as substantial as claimed.   See also   Somer–Lucas pseudoprime   References        {{ cite journal|first1=Paulo | last1=Ribenboim | first2=Wayne L. |last2=McDaniel   |title=The square terms in Lucas Sequences | journal=J. Numb. Theory |year=1996 | volume=58 | number=1 | pages=104–123 | doi=10.1006/jnth.1996.0068 }}       .      "  Category:Recurrence relations  Category:Integer sequences     ↩  ↩  ↩     
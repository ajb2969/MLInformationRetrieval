   Möbius inversion formula      Möbius inversion formula    Möbius transform redirects here. It should not be confused with Möbius transformation .    In mathematics , the classic Möbius inversion formula was introduced into number theory during the 19th century by August Ferdinand Möbius .  Other Möbius inversion formulas are obtained when different locally finite partially ordered sets replace the classic case of the natural numbers ordered by divisibility; for an account of those, see incidence algebra .  Statement of the formula  The classic version states that if g and f are arithmetic functions satisfying        g   (  n  )    =    ∑    d   ∣  n     f   (  d  )        for every integer  n   ≥  1      formulae-sequence      g  n     subscript    fragments  d  normal-∣  n      f  d         for every integer  n   1     g(n)=\sum_{d\,\mid\,n}f(d)\quad\text{for every integer }n\geq 1     then        f   (  n  )    =    ∑    d   ∣  n     μ   (  d  )   g   (   n  /  d   )        for every integer  n   ≥  1      formulae-sequence      f  n     subscript    fragments  d  normal-∣  n      μ  d  g    n  d          for every integer  n   1     f(n)=\sum_{d\,\mid\,n}\mu(d)g(n/d)\quad\text{for every integer }n\geq 1     where μ is the Möbius function and the sums extend over all positive divisors  d of n . In effect, the original f ( n ) can be determined given g ( n ) by using the inversion formula. The two sequences are said to be Möbius transforms of each other.  The formula is also correct if f and g are functions from the positive integers into some abelian group (viewed as a   ℤ   ℤ   \mathbb{Z}   - module ).  In the language of Dirichlet convolutions , the first formula may be written as      g  =   f  *  1       g    f  1     g=f*1     where * denotes the Dirichlet convolution, and 1 is the constant function      1   (  n  )    =  1        1  n   1    1(n)=1   . The second formula is then written as       f  =   μ  *  g    .      f    μ  g     f=\mu*g.     Many specific examples are given in the article on multiplicative functions .  The theorem follows because   *     *   is (commutative and) associative, and     1  *  μ   =  ϵ        1  μ   ϵ    1*\mu=\epsilon   , where   ϵ   ϵ   \epsilon   is the identity function for the Dirichlet convolution, taking values      ϵ   (  1  )    =  1   ,    ϵ   (  n  )    =  0      formulae-sequence      ϵ  1   1       ϵ  n   0     \epsilon(1)=1,\epsilon(n)=0   for all    n  >  1      n  1    n>1   . Thus     μ  *  g   =   μ  *   (   1  *  f   )    =    (   μ  *  1   )   *  f   =   ϵ  *  f   =  f          μ  g     μ    1  f             μ  1   f          ϵ  f        f     \mu*g=\mu*(1*f)=(\mu*1)*f=\epsilon*f=f   .  Series relations  Let       a  n   =    ∑   d  ∣  n     b  d         subscript  a  n     subscript    fragments  d  normal-∣  n     subscript  b  d      a_{n}=\sum_{d\mid n}b_{d}     so that       b  n   =    ∑   d  ∣  n     μ   (   n  d   )    a  d          subscript  b  n     subscript    fragments  d  normal-∣  n      μ    n  d    subscript  a  d       b_{n}=\sum_{d\mid n}\mu\left(\frac{n}{d}\right)a_{d}     is its transform. The transforms are related by means of series: the Lambert series        ∑   n  =  1   ∞     a  n    x  n     =    ∑   n  =  1   ∞     b  n     x  n    1  -   x  n             superscript   subscript     n  1         subscript  a  n    superscript  x  n       superscript   subscript     n  1         subscript  b  n      superscript  x  n     1   superscript  x  n         \sum_{n=1}^{\infty}a_{n}x^{n}=\sum_{n=1}^{\infty}b_{n}\frac{x^{n}}{1-x^{n}}     and the Dirichlet series :        ∑   n  =  1   ∞     a  n    n  s     =   ζ   (  s  )     ∑   n  =  1   ∞     b  n    n  s            superscript   subscript     n  1         subscript  a  n    superscript  n  s       ζ  s    superscript   subscript     n  1         subscript  b  n    superscript  n  s        \sum_{n=1}^{\infty}\frac{a_{n}}{n^{s}}=\zeta(s)\sum_{n=1}^{\infty}\frac{b_{n}}%
 {n^{s}}     where    ζ   (  s  )       ζ  s    \zeta(s)   is the Riemann zeta function .  Repeated transformations  Given an arithmetic function, one can generate a bi-infinite sequence of other arithmetic functions by repeatedly applying the first summation.  For example, if one starts with Euler's totient function    φ   φ   \varphi   , and repeatedly applies the transformation process, one obtains:      φ   φ   \varphi   the totient function       φ  *  1   =  Id        φ  1   Id    \varphi*1=\operatorname{Id}   where     Id   (  n  )    =  n       Id  n   n    \operatorname{Id}(n)=n   is the identity function       Id  *  1   =   σ  1   =  σ          Id  1    subscript  σ  1        σ     \operatorname{Id}*1=\sigma_{1}=\sigma   , the divisor function   If the starting function is the Möbius function itself, the list of functions is:      μ   μ   \mu   , the Möbius function       μ  *  1   =  ε        μ  1   ε    \mu*1=\varepsilon   where     ε   (  n  )    =   {      1  ,       if  n   =  1        0  ,       if  n   >  1             ε  n    cases  1      if  n   1   0      if  n   1      \varepsilon(n)=\begin{cases}1,&\mbox{if }n=1\\
 0,&\mbox{if }n>1\end{cases}   is the unit function       ε  *  1   =  1        ε  1   1    \varepsilon*1=1   , the constant function       1  *  1   =   σ  0   =  d  =  τ          1  1    subscript  σ  0        normal-d       τ     1*1=\sigma_{0}=\operatorname{d}=\tau   , where    d  =  τ      normal-d  τ    \operatorname{d}=\tau   is the number of divisors of n , (see divisor function ).   Both of these lists of functions extend infinitely in both directions. The Möbius inversion formula enables these lists to be traversed backwards.  As an example the sequence starting in   φ   φ   \varphi   is:       f  n   =   {         μ  *  …  *  μ   ⏟    -   n  factors     *  φ       if  n   <  0       φ      if  n   =  0        φ  *     1  *  …  *  1   ⏟    n  factors         if  n   >  0            subscript  f  n    cases     subscript   normal-⏟    μ  normal-…  μ        n  factors     φ       if  n   0   φ      if  n   0     φ   subscript   normal-⏟    1  normal-…  1      n  factors         if  n   0      f_{n}=\begin{cases}\underbrace{\mu*\ldots*\mu}_{-n\text{ factors}}*\varphi&%
 \text{if }n<0\\
 \varphi&\text{if }n=0\\
 \varphi*\underbrace{1*\ldots*1}_{n\text{ factors}}&\text{if }n>0\end{cases}     The generated sequences can perhaps be more easily understood by considering the corresponding Dirichlet series : each repeated application of the transform corresponds to multiplication by the Riemann zeta function .  Generalizations  A related inversion formula more useful in combinatorics is as follows: suppose F ( x ) and G ( x ) are complex -valued functions defined on the interval [1,∞) such that        G   (  x  )    =    ∑   1  ≤  n  ≤  x     F   (   x  /  n   )        for all  x   ≥  1      formulae-sequence      G  x     subscript       1  n       x       F    x  n          for all  x   1     G(x)=\sum_{1\leq n\leq x}F(x/n)\quad\mbox{ for all }x\geq 1     then        F   (  x  )    =    ∑   1  ≤  n  ≤  x     μ   (  n  )   G   (   x  /  n   )        for all  x   ≥  1.      formulae-sequence      F  x     subscript       1  n       x       μ  n  G    x  n          for all  x   1.     F(x)=\sum_{1\leq n\leq x}\mu(n)G(x/n)\quad\mbox{ for all }x\geq 1.     Here the sums extend over all positive integers n which are less than or equal to x .  This in turn is a special case of a more general form. If    α   (  n  )       α  n    \alpha(n)   is an arithmetic function possessing a Dirichlet inverse      α   -  1     (  n  )        superscript  α    1    n    \alpha^{-1}(n)   , then if one defines        G   (  x  )    =    ∑   1  ≤  n  ≤  x     α   (  n  )   F   (   x  /  n   )        for all  x   ≥  1      formulae-sequence      G  x     subscript       1  n       x       α  n  F    x  n          for all  x   1     G(x)=\sum_{1\leq n\leq x}\alpha(n)F(x/n)\quad\mbox{ for all }x\geq 1     then        F   (  x  )    =    ∑   1  ≤  n  ≤  x      α   -  1     (  n  )   G   (   x  /  n   )        for all  x   ≥  1.      formulae-sequence      F  x     subscript       1  n       x        superscript  α    1    n  G    x  n          for all  x   1.     F(x)=\sum_{1\leq n\leq x}\alpha^{-1}(n)G(x/n)\quad\mbox{ for all }x\geq 1.     The previous formula arises in the special case of the constant function     α   (  n  )    =  1        α  n   1    \alpha(n)=1   , whose Dirichlet inverse is      α   -  1     (  n  )    =   μ   (  n  )           superscript  α    1    n     μ  n     \alpha^{-1}(n)=\mu(n)   .  A particular application of the first of these extensions arises if we have (complex-valued) functions f ( n ) and g ( n ) defined on the positive integers, with        g   (  n  )    =    ∑   1  ≤  m  ≤  n     f   (   ⌊   n  m   ⌋   )        for all  n   ≥  1.      formulae-sequence      g  n     subscript       1  m       n       f      n  m           for all  n   1.     g(n)=\sum_{1\leq m\leq n}f\left(\left\lfloor\frac{n}{m}\right\rfloor\right)%
 \quad\mbox{ for all }n\geq 1.     By defining     F   (  x  )    =   f   (   ⌊  x  ⌋   )          F  x     f    x      F(x)=f(\lfloor x\rfloor)   and     G   (  x  )    =   g   (   ⌊  x  ⌋   )          G  x     g    x      G(x)=g(\lfloor x\rfloor)   , we deduce that        f   (  n  )    =    ∑   1  ≤  m  ≤  n     μ   (  m  )   g   (   ⌊   n  m   ⌋   )        for all  n   ≥  1.      formulae-sequence      f  n     subscript       1  m       n       μ  m  g      n  m           for all  n   1.     f(n)=\sum_{1\leq m\leq n}\mu(m)g\left(\left\lfloor\frac{n}{m}\right\rfloor%
 \right)\quad\mbox{ for all }n\geq 1.     A simple example of the use of this formula is counting the number of reduced fractions 0 g(x) = \sum_{m=1}^\infty \frac{f(mx)}{m^s}\quad\mbox{ for all } x\ge 1\quad\Longleftrightarrow\quad f(x) = \sum_{m=1}^\infty \mu(m)\frac{g(mx)}{m^s}\quad\mbox{ for all } x\ge 1.  As above, this generalises to the case where    α   (  n  )       α  n    \alpha(n)   is an arithmetic function possessing a Dirichlet inverse     α   -  1     (  n  )        superscript  α    1    n    \alpha^{-1}(n)   :        g   (  x  )    =    ∑   m  =  1   ∞    α   (  m  )     f   (   m  x   )     m  s          for all  x   ≥   1  ⟺       f   (  x  )    =    ∑   m  =  1   ∞     α   -  1     (  m  )     g   (   m  x   )     m  s         for all  x   ≥  1.        formulae-sequence      g  x     superscript   subscript     m  1        α  m      f    m  x     superscript  m  s        formulae-sequence      for all  x    1  normal-⟺     formulae-sequence      f  x     superscript   subscript     m  1         superscript  α    1    m      g    m  x     superscript  m  s           for all  x   1.       g(x)=\sum_{m=1}^{\infty}\alpha(m)\frac{f(mx)}{m^{s}}\quad\mbox{ for all }x\geq
 1%
 \quad\Longleftrightarrow\quad f(x)=\sum_{m=1}^{\infty}\alpha^{-1}(m)\frac{g(mx%
 )}{m^{s}}\quad\mbox{ for all }x\geq 1.     Multiplicative notation  As Möbius inversion applies to any abelian group, it makes no difference whether the group operation is written as addition or as multiplication. This gives rise to the following notational variant of the inversion formula:         If  F   (  n  )    =    ∏   d  |  n     f   (  d  )      ,    then  f   (  n  )    =    ∏   d  |  n     F    (   n  /  d   )    μ   (  d  )         .     formulae-sequence      If  F  n     subscript  product   fragments  d  normal-|  n      f  d         then  f  n     subscript  product   fragments  d  normal-|  n      F   superscript    n  d     μ  d         \mbox{If }F(n)=\prod_{d|n}f(d),\mbox{ then }f(n)=\prod_{d|n}F(n/d)^{\mu(d)}.\,     Proofs of generalizations  The first generalization can be proved as follows. We use Iverson's convention that [condition] is the indicator function of the condition, being 1 if the condition is true and 0 if false. We use the result that      ∑   d  |  n     μ   (  d  )     =   i   (  n  )          subscript    fragments  d  normal-|  n      μ  d      i  n     \sum_{d|n}\mu(d)=i(n)   , that is, 1*μ= i .  We have the following:           ∑   1  ≤  n  ≤  x      μ   (  n  )   g   (    x  n    )         =     ∑   1  ≤  n  ≤  x      μ   (  n  )      ∑   1  ≤  m  ≤   x  /  n       f   (    x   m  n     )              =    ∑   1  ≤  n  ≤  x     μ   (  n  )     ∑   1  ≤  m  ≤   x  /  n        ∑   1  ≤  r  ≤  x      [  r  =  m  n  ]   f   (    x  r    )          =    ∑   1  ≤  r  ≤  x     f   (    x  r    )     ∑   1  ≤  n  ≤  x     μ   (  n  )     ∑   1  ≤  m  ≤   x  /  n       [  m  =  r  /  n  ]   rearranging the summation order          =     ∑   1  ≤  r  ≤  x      f   (    x  r    )      ∑   n  |  r      μ   (  n  )               =     ∑   1  ≤  r  ≤  x      f   (    x  r    )   i   (  r  )              =   f   (  x  )       since  i   (  r  )    =   0  except when  r   =  1            subscript       1  n       x       μ  n  g    x  n       absent    subscript       1  n       x       μ  n    subscript       1  m         x  n        f    x    m  n            missing-subexpression    fragments    subscript       1  n       x     μ   fragments  normal-(  n  normal-)    subscript       1  m         x  n       subscript       1  r       x      fragments  normal-[  r   m  n  normal-]   f   fragments  normal-(    x  r   normal-)       missing-subexpression    fragments    subscript       1  r       x     f   fragments  normal-(    x  r   normal-)    subscript       1  n       x     μ   fragments  normal-(  n  normal-)    subscript       1  m         x  n       fragments  normal-[  m   r   n  normal-]    rearranging the summation order      missing-subexpression     absent    subscript       1  r       x       f    x  r     subscript    fragments  n  normal-|  r      μ  n          missing-subexpression     absent    subscript       1  r       x       f    x  r   i  r        missing-subexpression    formulae-sequence    absent    f  x          since  i  r     0  except when  r        1        \begin{aligned}\displaystyle\sum_{1\leq n\leq x}\mu(n)g\left(\frac{x}{n}\right%
 )&\displaystyle=\sum_{1\leq n\leq x}\mu(n)\sum_{1\leq m\leq x/n}f\left(\frac{x%
 }{mn}\right)\\
 &\displaystyle=\sum_{1\leq n\leq x}\mu(n)\sum_{1\leq m\leq x/n}\sum_{1\leq r%
 \leq x}[r=mn]f\left(\frac{x}{r}\right)\\
 &\displaystyle=\sum_{1\leq r\leq x}f\left(\frac{x}{r}\right)\sum_{1\leq n\leq x%
 }\mu(n)\sum_{1\leq m\leq x/n}[m=r/n]\qquad\text{rearranging the summation %
 order}\\
 &\displaystyle=\sum_{1\leq r\leq x}f\left(\frac{x}{r}\right)\sum_{n|r}\mu(n)\\
 &\displaystyle=\sum_{1\leq r\leq x}f\left(\frac{x}{r}\right)i(r)\\
 &\displaystyle=f(x)\qquad\text{since }i(r)=0\text{ except when }r=1\end{aligned}     The proof in the more general case where α( n ) replaces 1 is essentially identical, as is the second generalisation.  Contributions of Weisner, Hall, and Rota  See also   Farey sequence   References     K. Ireland, M. Rosen. A Classical Introduction to Modern Number Theory , (1990) Springer-Verlag.   External links     ru:Функция Мёбиуса#Обращение Мёбиуса "  Category:Arithmetic functions  Category:Enumerative combinatorics  Category:Order theory   
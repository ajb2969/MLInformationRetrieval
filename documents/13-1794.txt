   Barrett reduction      Barrett reduction   In modular arithmetic , Barrett reduction is a reduction algorithm introduced in 1986 by P.D. Barrett. 1 A naive way of computing       c  =    a   mod  n    .      c   modulo  a  n     c=a\,\bmod\,n.\,     would be to use a fast division algorithm . Barrett reduction is an algorithm designed to optimize this operation assuming   n   n   n   is constant, and   n   n   n   be the inverse of      a   mod  n   =   a  -    ⌊   a  m   ⌋   n         modulo  a  n     a        a  m    n      a\,\bmod\,n=a-\lfloor am\rfloor n   as a floating point number. Then      ⌊  x  ⌋      x    \lfloor x\rfloor     where     2  k   >  n       superscript  2  k   n    2^{k}>n   denotes the floor function . The result is exact, as long as m is computed with sufficient accuracy.  Barrett algorithm  Barrett algorithm is a fixed-point analog which expresses everything in terms of integers. Let k be the smallest integer such that    n   2   -  k        n   superscript  2    k      n2^{-k}   . Think of n as representing the fixed-point number    m  =   ⌊    4  k   /  n   ⌋       m       superscript  4  k   n      m=\lfloor 4^{k}/n\rfloor   . We precompute m such that     m   2   -  k     ≈    (   n   2   -  k     )    -  1          m   superscript  2    k      superscript    n   superscript  2    k       1      m2^{-k}\approx\left(n2^{-k}\right)^{-1}   . Then m represents the fixed-point number    q  =   ⌊    m  a    4  k    ⌋       q        m  a    superscript  4  k       q=\left\lfloor\frac{ma}{4^{k}}\right\rfloor   .  Let       r  =   a  -   q  n        r    a    q  n      r=a-qn   and     q   q   q   .   Because of the floor function ,    r  ≡   a     (   mod  n   )        r   annotated  a   pmod  n      r\equiv a\;\;(\mathop{{\rm mod}}n)   is an integer and    a  <   n  2       a   superscript  n  2     a   . Also, if    r  <   2  n       r    2  n     r<2n   then     c  =    a   mod  n    .      c   modulo  a  n     c=a\,\bmod\,n.\,   . In that case     n   n   n        ↩     
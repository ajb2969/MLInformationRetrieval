   Duhamel's principle      Duhamel's principle   In mathematics , and more specifically in partial differential equations , Duhamel's principle is a general method for obtaining solutions to inhomogeneous linear evolution equations like the heat equation , wave equation , and vibrating plate equation. It is named after Jean-Marie Duhamel who first applied the principle to the inhomogeneous heat equation that models, for instance, the distribution of heat in a thin plate which is heated from beneath. For linear evolution equations without spatial dependency, such as a harmonic oscillator , Duhamel's principle reduces to the method of variation of parameters technique for solving linear inhomogeneous ordinary differential equations . 1  The philosophy underlying Duhamel's principle is that it is possible to go from solutions of the Cauchy problem (or initial value problem) to solutions of the inhomogeneous problem. Consider, for instance, the example of the heat equation modeling the distribution of heat energy u in R n . The initial value problem is      {         u  t    (  x  ,  t  )    -   Œî  u   (  x  ,  t  )     =  0       (  x  ,  t  )   ‚àà    ùêë  n   √ó   (  0  ,  ‚àû  )           u   (  x  ,  0  )    =   g   (  x  )        x  ‚àà   ùêë  n          cases         subscript  u  t    x  t      normal-Œî  u   x  t     0      x  t      superscript  ùêë  n    0          u   x  0      g  x      x   superscript  ùêë  n      \begin{cases}u_{t}(x,t)-\Delta u(x,t)=0&(x,t)\in\mathbf{R}^{n}\times(0,\infty)%
 \\
 u(x,0)=g(x)&x\in\mathbf{R}^{n}\end{cases}   where g is the initial heat distribution. By contrast, the inhomogeneous problem for the heat equation is      {         u  t    (  x  ,  t  )    -   Œî  u   (  x  ,  t  )     =   f   (  x  ,  t  )         (  x  ,  t  )   ‚àà    ùêë  n   √ó   (  0  ,  ‚àû  )           u   (  x  ,  0  )    =  0      x  ‚àà   ùêë  n          cases         subscript  u  t    x  t      normal-Œî  u   x  t       f   x  t        x  t      superscript  ùêë  n    0          u   x  0    0     x   superscript  ùêë  n      \begin{cases}u_{t}(x,t)-\Delta u(x,t)=f(x,t)&(x,t)\in\mathbf{R}^{n}\times(0,%
 \infty)\\
 u(x,0)=0&x\in\mathbf{R}^{n}\end{cases}   corresponds to adding an external heat energy ∆í ( x , t ) dt at each point. Intuitively, one can think of the inhomogeneous problem as a set of homogeneous problems each starting afresh at a different time slice t = t 0 . By linearity, one can add up (integrate) the resulting solutions through time t 0 and obtain the solution for the inhomogeneous problem. This is the essence of Duhamel's principle.  General considerations  Formally, consider a linear inhomogeneous evolution equation for a function      u  :    D  √ó   (  0  ,  ‚àû  )    ‚Üí  ùêë      normal-:  u   normal-‚Üí    D   0     ùêë     u:D\times(0,\infty)\to\mathbf{R}   with spatial domain D in R n , of the form      {         u  t    (  x  ,  t  )    -   L  u   (  x  ,  t  )     =   f   (  x  ,  t  )         (  x  ,  t  )   ‚àà   D  √ó   (  0  ,  ‚àû  )            u  |    ‚àÇ  D    =  0            u   (  x  ,  0  )    =  0       x  ‚àà  D   ,         cases         subscript  u  t    x  t      L  u   x  t       f   x  t        x  t     D   0         evaluated-at  u    D    0   absent      u   x  0    0     x  D     \begin{cases}u_{t}(x,t)-Lu(x,t)=f(x,t)&(x,t)\in D\times(0,\infty)\\
 u|_{\partial D}=0&\\
 u(x,0)=0&x\in D,\end{cases}   where L is a linear differential operator that involves no time derivatives.  Duhamel's principle is, formally, that the solution to this problem is       u   (  x  ,  t  )    =    ‚à´  0  t     (    P  s   f   )    (  x  ,  t  )   d  s          u   x  t      superscript   subscript   0   t        superscript  P  s   f    x  t   d  s      u(x,t)=\int_{0}^{t}(P^{s}f)(x,t)\,ds   where P s ∆í is the solution of the problem      {        u  t   -   L  u    =  0       (  x  ,  t  )   ‚àà   D  √ó   (  s  ,  ‚àû  )            u  |    ‚àÇ  D    =  0            u   (  x  ,  s  )    =   f   (  x  ,  s  )         x  ‚àà  D   .         cases       subscript  u  t     L  u    0      x  t     D   s         evaluated-at  u    D    0   absent      u   x  s      f   x  s       x  D     \begin{cases}u_{t}-Lu=0&(x,t)\in D\times(s,\infty)\\
 u|_{\partial D}=0&\\
 u(x,s)=f(x,s)&x\in D.\end{cases}     Duhamel's principle also holds for linear systems (with vector-valued functions u ), and this in turn furnishes a generalization to higher t derivatives, such as those appearing in the wave equation (see below). Validity of the principle depends on being able to solve the homogeneous problem in an appropriate function space and that the solution should exhibit reasonable dependence on parameters so that the integral is well-defined. Precise analytic conditions on u and f depend on the particular application.  Examples  Wave equation  The linear wave equation models the displacement u of an idealized dispersionless one-dimensional string, in terms of derivatives with respect to time t and space x :           ‚àÇ  2   u    ‚àÇ   t  2     -    c  2      ‚àÇ  2   u    ‚àÇ   x  2       =   f   (  x  ,  t  )     .            superscript   2   u      superscript  t  2        superscript  c  2       superscript   2   u      superscript  x  2         f   x  t      \frac{\partial^{2}u}{\partial t^{2}}-c^{2}\frac{\partial^{2}u}{\partial x^{2}}%
 =f(x,t).\,     The function f ( x , t ), in natural units, represents an external force applied to string at the position ( x , t ). In order to be a suitable physical model for nature, it should be possible to solve it for any initial state that the string is in, specified by its initial displacement and velocity:         u   (  x  ,  0  )    =    u  0    (  x  )     ,      ‚àÇ  u    ‚àÇ  t     (  x  ,  0  )    =    v  0    (  x  )      .     formulae-sequence      u   x  0       subscript  u  0   x            u     t     x  0       subscript  v  0   x      u(x,0)=u_{0}(x),\qquad\frac{\partial u}{\partial t}(x,0)=v_{0}(x).\,     More generally, we should be able to solve the equation with data specified on any t = constant slice:         u   (  x  ,  T  )    =    u  T    (  x  )     ,      ‚àÇ  u    ‚àÇ  t     (  x  ,  T  )    =    v  T    (  x  )      .     formulae-sequence      u   x  T       subscript  u  T   x            u     t     x  T       subscript  v  T   x      u(x,T)=u_{T}(x),\qquad\frac{\partial u}{\partial t}(x,T)=v_{T}(x).\,     To evolve a solution from any given time slice T to T + dT , the contribution of the force must be added to the solution. That contribution comes from changing the velocity of the string by f ( x , T ) dT . That is, to get the solution at time T + dT from the solution at time T , we must add to it a new (forward) solution of the homogeneous (no external forces) wave equation          ‚àÇ  2   u    ‚àÇ   t  2     -    c  2      ‚àÇ  2   u    ‚àÇ   x  2       =  0            superscript   2   u      superscript  t  2        superscript  c  2       superscript   2   u      superscript  x  2       0    \frac{\partial^{2}u}{\partial t^{2}}-c^{2}\frac{\partial^{2}u}{\partial x^{2}}=0     with the initial conditions         u   (  x  ,  T  )    =  0   ,      ‚àÇ  u    ‚àÇ  t     (  x  ,  T  )    =   f   (  x  ,  T  )   d  T     .     formulae-sequence      u   x  T    0           u     t     x  T      f   x  T   d  T      u(x,T)=0,\qquad\frac{\partial u}{\partial t}(x,T)=f(x,T)dT.     A solution to this equation is achieved by straightforward integration:       (    1   2  c      ‚à´   x  -   c   (   t  -  T   )      x  +   c   (   t  -  T   )       f   (  Œæ  ,  T  )   d  Œæ     )   d  T          1    2  c      superscript   subscript     x    c    t  T        x    c    t  T        f   Œæ  T   d  Œæ     d  T    \left(\frac{1}{2c}\int_{x-c(t-T)}^{x+c(t-T)}f(\xi,T)\,d\xi\right)\,dT     (The expression in parenthesis is just     P  T   f   (  x  ,  t  )        superscript  P  T   f   x  t     P^{T}f(x,t)   in the notation of the general method above.) So a solution of the original initial value problem is obtained by starting with a solution to the problem with the same prescribed initial values problem but with zero external force, and adding to that (integrating) the contributions from the added force in the time intervals from T to T + dT :        u   (  x  ,  t  )    =     u  0    (  x  )    +    1   2  c      ‚à´  0  t     ‚à´   x  -   c   (   t  -  T   )      x  +   c   (   t  -  T   )       f   (  Œæ  ,  T  )   d   Œæ   d  T        .        u   x  t         subscript  u  0   x       1    2  c      superscript   subscript   0   t     superscript   subscript     x    c    t  T        x    c    t  T        f   Œæ  T   d  Œæ  d  T         u(x,t)=u_{0}(x)+\frac{1}{2c}\int_{0}^{t}\int_{x-c(t-T)}^{x+c(t-T)}f(\xi,T)\,d%
 \xi\,dT.\,     Constant-coefficient linear ODE  Duhamel's principle is the result that the solution to an inhomogeneous, linear, partial differential equation can be solved by first finding the solution for a step input, and then superposing using Duhamel's integral . Suppose we have a constant coefficient, m th order inhomogeneous ordinary differential equation .       P   (   ‚àÇ  t   )   u   (  t  )    =   F   (  t  )          P   subscript   t   u  t     F  t     P(\partial_{t})u(t)=F(t)\,             ‚àÇ  t  j   u    (  0  )    =  0   ,   0  ‚â§  j  ‚â§   m  -  1       formulae-sequence        superscript   subscript   t   j   u   0   0       0  j         m  1       \partial_{t}^{j}u(0)=0,\;0\leq j\leq m-1     where        P   (   ‚àÇ  t   )    :=     a  m    ‚àÇ  t  m    +  ‚ãØ  +    a  1    ‚àÇ  t    +   a  0     ,    a  m   ‚â†  0.      formulae-sequence   assign    P   subscript   t         subscript  a  m    superscript   subscript   t   m    normal-‚ãØ     subscript  a  1    subscript   t     subscript  a  0        subscript  a  m   0.     P(\partial_{t}):=a_{m}\partial_{t}^{m}+\cdots+a_{1}\partial_{t}+a_{0},\;a_{m}%
 \neq 0.     We can reduce this to the solution of a homogeneous ODE using the following method. All steps are done formally, ignoring necessary requirements for the solution to be well defined.  First let G solve          P   (   ‚àÇ  t   )   G   =  0   ,       ‚àÇ  t  j   G    (  0  )    =  0   ,   0  ‚â§  j  ‚â§   m  -  2      ,      ‚àÇ  t   m  -  1    G    (  0  )    =   1  /   a  m      .     formulae-sequence   formulae-sequence      P   subscript   t   G   0    formulae-sequence        subscript   superscript   j   t   G   0   0       0  j         m  2             superscript   subscript   t     m  1    G   0     1   subscript  a  m       P(\partial_{t})G=0,\;\partial^{j}_{t}G(0)=0,\quad 0\leq j\leq m-2,\;\partial_{%
 t}^{m-1}G(0)=1/a_{m}.     Define    H  =   G   œá   [  0  ,  ‚àû  )         H    G   subscript  œá   0        H=G\chi_{[0,\infty)}   , with    œá   [  0  ,  ‚àû  )      subscript  œá   0      \chi_{[0,\infty)}   being the characteristic function of the interval    [  0  ,  ‚àû  )     0     [0,\infty)   . Then we have       P   (   ‚àÇ  t   )   H   =  Œ¥        P   subscript   t   H   Œ¥    P(\partial_{t})H=\delta     in the sense of distributions . Therefore       u   (  t  )    =    (   H  ‚àó  F   )    (  t  )          u  t      normal-‚àó  H  F   t     u(t)=(H\ast F)(t)          =    ‚à´  0  ‚àû    G   (  œÑ  )   F   (   t  -  œÑ   )   d  œÑ        absent    superscript   subscript   0       G  œÑ  F    t  œÑ   d  œÑ      =\int_{0}^{\infty}G(\tau)F(t-\tau)\,d\tau          =    ‚à´   -  ‚àû   t    G   (   t  -  œÑ   )   F   (  œÑ  )   d  œÑ        absent    superscript   subscript        t     G    t  œÑ   F  œÑ  d  œÑ      =\int_{-\infty}^{t}G(t-\tau)F(\tau)\,d\tau     solves the ODE.  Constant-coefficient linear PDE  More generally, suppose we have a constant coefficient inhomogeneous partial differential equation       P   (   ‚àÇ  t   ,   D  x   )   u   (  t  ,  x  )    =   F   (  t  ,  x  )          P    subscript   t    subscript  D  x    u   t  x      F   t  x      P(\partial_{t},D_{x})u(t,x)=F(t,x)\,     where        D  x   =    1  i    ‚àÇ   ‚àÇ  x      .       subscript  D  x       1  i        x       D_{x}=\frac{1}{i}\frac{\partial}{\partial x}.\,     We can reduce this to the solution of a homogeneous ODE using the following method. All steps are done formally, ignoring necessary requirements for the solution to be well defined.  First, taking the Fourier transform in x we have        P   (   ‚àÇ  t   ,  Œæ  )    u  ^    (  t  ,  Œæ  )    =    F  ^    (  t  ,  Œæ  )     .        P    subscript   t   Œæ    normal-^  u    t  Œæ       normal-^  F    t  Œæ      P(\partial_{t},\xi)\hat{u}(t,\xi)=\hat{F}(t,\xi).     Assume that    P   (   ‚àÇ  t   ,  Œæ  )       P    subscript   t   Œæ     P(\partial_{t},\xi)   is an m th order ODE in t . Let    a  m     subscript  a  m    a_{m}   be the coefficient of the highest order term of    P   (   ‚àÇ  t   ,  Œæ  )       P    subscript   t   Œæ     P(\partial_{t},\xi)   . Now for every   Œæ   Œæ   \xi   let    G   (  t  ,  Œæ  )       G   t  Œæ     G(t,\xi)   solve          P   (   ‚àÇ  t   ,  Œæ  )   G   (  t  ,  Œæ  )    =  0   ,      ‚àÇ  t  j   G    (  0  ,  Œæ  )    =    0   for  0   ‚â§  j  ‚â§   m  -  2     ,      ‚àÇ  t   m  -  1    G    (  0  ,  Œæ  )    =   1  /   a  m      .     formulae-sequence   formulae-sequence      P    subscript   t   Œæ   G   t  Œæ    0           subscript   superscript   j   t   G    0  Œæ      0  for  0        j         m  2            superscript   subscript   t     m  1    G    0  Œæ      1   subscript  a  m       P(\partial_{t},\xi)G(t,\xi)=0,\;\partial^{j}_{t}G(0,\xi)=0\;\mbox{ for }0\leq j%
 \leq m-2,\;\partial_{t}^{m-1}G(0,\xi)=1/a_{m}.     Define     H   (  t  ,  Œæ  )    =   G   (  t  ,  Œæ  )    œá   [  0  ,  ‚àû  )     (  t  )          H   t  Œæ      G   t  Œæ    subscript  œá   0     t     H(t,\xi)=G(t,\xi)\chi_{[0,\infty)}(t)   . We then have       P   (   ‚àÇ  t   ,  Œæ  )   H   (  t  ,  Œæ  )    =   Œ¥   (  t  )          P    subscript   t   Œæ   H   t  Œæ      Œ¥  t     P(\partial_{t},\xi)H(t,\xi)=\delta(t)     in the sense of distributions . Therefore        u  ^    (  t  ,  Œæ  )    =    (     H   (  ‚ãÖ  ,  Œæ  )    ‚àó   F  ^     (  ‚ãÖ  ,  Œæ  )    )    (  t  )           normal-^  u    t  Œæ         normal-‚àó    H   normal-‚ãÖ  Œæ     normal-^  F     normal-‚ãÖ  Œæ    t     \hat{u}(t,\xi)=(H(\cdot,\xi)\ast\hat{F}(\cdot,\xi))(t)          =    ‚à´  0  ‚àû    G   (  œÑ  ,  Œæ  )   F   (   t  -  œÑ   ,  Œæ  )   d  œÑ        absent    superscript   subscript   0       G   œÑ  Œæ   F     t  œÑ   Œæ   d  œÑ      =\int_{0}^{\infty}G(\tau,\xi)F(t-\tau,\xi)\,d\tau          =    ‚à´   -  ‚àû   t    G   (   t  -  œÑ   ,  Œæ  )   F   (  œÑ  ,  Œæ  )   d  œÑ        absent    superscript   subscript        t     G     t  œÑ   Œæ   F   œÑ  Œæ   d  œÑ      =\int_{-\infty}^{t}G(t-\tau,\xi)F(\tau,\xi)\,d\tau     solves the PDE (after transforming back to x ).  See also   Retarded potential   References  "  Category:Wave mechanics  Category:Partial differential equations  Category:Mathematical principles     Fritz John, "Partial Differential Equations', New York, Springer-Verlag, 1982, 4th ed., 0387906096 ‚Ü©     
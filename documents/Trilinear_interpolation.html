<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="229">Trilinear interpolation</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Trilinear interpolation</h1>
<hr/>

<p><strong>Trilinear interpolation</strong> is a method of <a href="multivariate_interpolation" title="wikilink">multivariate interpolation</a> on a <a href="Three_dimensional_space" title="wikilink">3-dimensional</a> <a href="regular_grid" title="wikilink">regular grid</a>. It approximates the value of an intermediate point 

<math display="inline" id="Trilinear_interpolation:0">
 <semantics>
  <mrow>
   <mo stretchy="false">(</mo>
   <mi>x</mi>
   <mo>,</mo>
   <mi>y</mi>
   <mo>,</mo>
   <mi>z</mi>
   <mo stretchy="false">)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <vector>
    <ci>x</ci>
    <ci>y</ci>
    <ci>z</ci>
   </vector>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (x,y,z)
  </annotation>
 </semantics>
</math>

 within the local axial rectangular <a href="prism_(geometry)" title="wikilink">prism</a> linearly, using data on the lattice points. For an arbitrary, <a href="unstructured_grid" title="wikilink">unstructured mesh</a> (as used in <a href="finite_element" title="wikilink">finite element</a> analysis), other methods of interpolation must be used; if all the mesh elements are <a href="tetrahedron" title="wikilink">tetrahedra</a> (3D <a href="simplex" title="wikilink">simplices</a>), then <a href="barycentric_coordinates_(mathematics)#Barycentric_coordinates_on_tetrahedra" title="wikilink">barycentric coordinates</a> provide a straightforward procedure.</p>

<p>Trilinear interpolation is frequently used in <a href="numerical_analysis" title="wikilink">numerical analysis</a>, <a href="data_analysis" title="wikilink">data analysis</a>, and <a href="computer_graphics" title="wikilink">computer graphics</a>.</p>
<h2 id="compared-to-linear-and-bilinear-interpolation">Compared to linear and bilinear interpolation</h2>

<p>Trilinear interpolation is the extension of <a href="linear_interpolation" title="wikilink">linear interpolation</a>, which operates in spaces with <a class="uri" href="dimension" title="wikilink">dimension</a> 

<math display="inline" id="Trilinear_interpolation:1">
 <semantics>
  <mrow>
   <mi>D</mi>
   <mo>=</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>D</ci>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   D=1
  </annotation>
 </semantics>
</math>

, and <a href="bilinear_interpolation" title="wikilink">bilinear interpolation</a>, which operates with dimension 

<math display="inline" id="Trilinear_interpolation:2">
 <semantics>
  <mrow>
   <mi>D</mi>
   <mo>=</mo>
   <mn>2</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>D</ci>
    <cn type="integer">2</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   D=2
  </annotation>
 </semantics>
</math>

, to dimension 

<math display="inline" id="Trilinear_interpolation:3">
 <semantics>
  <mrow>
   <mi>D</mi>
   <mo>=</mo>
   <mn>3</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>D</ci>
    <cn type="integer">3</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   D=3
  </annotation>
 </semantics>
</math>


. The order of accuracy is 1 for all these interpolation schemes, and it requires 

<math display="inline" id="Trilinear_interpolation:4">
 <semantics>
  <mrow>
   <msup>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mn>1</mn>
      <mo>+</mo>
      <mi>n</mi>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
    <mi>D</mi>
   </msup>
   <mo>=</mo>
   <mn>8</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <plus></plus>
      <cn type="integer">1</cn>
      <ci>n</ci>
     </apply>
     <ci>D</ci>
    </apply>
    <cn type="integer">8</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (1+n)^{D}=8
  </annotation>
 </semantics>
</math>

 adjacent pre-defined values surrounding the interpolation point. There are several ways to arrive at trilinear interpolation, it is equivalent to 3-dimensional <a class="uri" href="tensor" title="wikilink">tensor</a> <a class="uri" href="B-spline" title="wikilink">B-spline</a> interpolation of order 1, and the trilinear interpolation operator is also a tensor product of 3 linear interpolation operators.</p>
<h2 id="method">Method</h2>

<p> </p>

<p>On a periodic and cubic lattice, let 

<math display="inline" id="Trilinear_interpolation:5">
 <semantics>
  <msub>
   <mi>x</mi>
   <mi>d</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>x</ci>
    <ci>d</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x_{d}
  </annotation>
 </semantics>
</math>

, 

<math display="inline" id="Trilinear_interpolation:6">
 <semantics>
  <msub>
   <mi>y</mi>
   <mi>d</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>y</ci>
    <ci>d</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   y_{d}
  </annotation>
 </semantics>
</math>

, and 

<math display="inline" id="Trilinear_interpolation:7">
 <semantics>
  <msub>
   <mi>z</mi>
   <mi>d</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>z</ci>
    <ci>d</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   z_{d}
  </annotation>
 </semantics>
</math>

 be the differences between each of 

<math display="inline" id="Trilinear_interpolation:8">
 <semantics>
  <mi>x</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>x</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x
  </annotation>
 </semantics>
</math>


, 

<math display="inline" id="Trilinear_interpolation:9">
 <semantics>
  <mi>y</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>y</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   y
  </annotation>
 </semantics>
</math>

, 

<math display="inline" id="Trilinear_interpolation:10">
 <semantics>
  <mi>z</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>z</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   z
  </annotation>
 </semantics>
</math>

 and the smaller coordinate related, that is:</p>

<p>

<math display="block" id="Trilinear_interpolation:11">
 <semantics>
  <mrow>
   <msub>
    <mpadded lspace="5pt" width="+5pt">
     <mi>x</mi>
    </mpadded>
    <mi>d</mi>
   </msub>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>x</mi>
      <mo>-</mo>
      <msub>
       <mi>x</mi>
       <mn>0</mn>
      </msub>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
    <mo>/</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <msub>
       <mi>x</mi>
       <mn>1</mn>
      </msub>
      <mo>-</mo>
      <msub>
       <mi>x</mi>
       <mn>0</mn>
      </msub>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>x</ci>
     <ci>d</ci>
    </apply>
    <apply>
     <divide></divide>
     <apply>
      <minus></minus>
      <ci>x</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <cn type="integer">0</cn>
      </apply>
     </apply>
     <apply>
      <minus></minus>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <cn type="integer">1</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <cn type="integer">0</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \ x_{d}=(x-x_{0})/(x_{1}-x_{0})
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Trilinear_interpolation:12">
 <semantics>
  <mrow>
   <msub>
    <mpadded lspace="5pt" width="+5pt">
     <mi>y</mi>
    </mpadded>
    <mi>d</mi>
   </msub>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>y</mi>
      <mo>-</mo>
      <msub>
       <mi>y</mi>
       <mn>0</mn>
      </msub>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
    <mo>/</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <msub>
       <mi>y</mi>
       <mn>1</mn>
      </msub>
      <mo>-</mo>
      <msub>
       <mi>y</mi>
       <mn>0</mn>
      </msub>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>y</ci>
     <ci>d</ci>
    </apply>
    <apply>
     <divide></divide>
     <apply>
      <minus></minus>
      <ci>y</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>y</ci>
       <cn type="integer">0</cn>
      </apply>
     </apply>
     <apply>
      <minus></minus>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>y</ci>
       <cn type="integer">1</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>y</ci>
       <cn type="integer">0</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \ y_{d}=(y-y_{0})/(y_{1}-y_{0})
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Trilinear_interpolation:13">
 <semantics>
  <mrow>
   <msub>
    <mpadded lspace="5pt" width="+5pt">
     <mi>z</mi>
    </mpadded>
    <mi>d</mi>
   </msub>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>z</mi>
      <mo>-</mo>
      <msub>
       <mi>z</mi>
       <mn>0</mn>
      </msub>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
    <mo>/</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <msub>
       <mi>z</mi>
       <mn>1</mn>
      </msub>
      <mo>-</mo>
      <msub>
       <mi>z</mi>
       <mn>0</mn>
      </msub>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>z</ci>
     <ci>d</ci>
    </apply>
    <apply>
     <divide></divide>
     <apply>
      <minus></minus>
      <ci>z</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>z</ci>
       <cn type="integer">0</cn>
      </apply>
     </apply>
     <apply>
      <minus></minus>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>z</ci>
       <cn type="integer">1</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>z</ci>
       <cn type="integer">0</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \ z_{d}=(z-z_{0})/(z_{1}-z_{0})
  </annotation>
 </semantics>
</math>

</p>

<p>where 

<math display="inline" id="Trilinear_interpolation:14">
 <semantics>
  <msub>
   <mi>x</mi>
   <mn>0</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>x</ci>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x_{0}
  </annotation>
 </semantics>
</math>

 indicates the lattice point below 

<math display="inline" id="Trilinear_interpolation:15">
 <semantics>
  <mi>x</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>x</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x
  </annotation>
 </semantics>
</math>

, and 

<math display="inline" id="Trilinear_interpolation:16">
 <semantics>
  <msub>
   <mi>x</mi>
   <mn>1</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>x</ci>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x_{1}
  </annotation>
 </semantics>
</math>

 indicates the lattice point above 

<math display="inline" id="Trilinear_interpolation:17">
 <semantics>
  <mi>x</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>x</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x
  </annotation>
 </semantics>
</math>

 and similarly for 

<math display="inline" id="Trilinear_interpolation:18">
 <semantics>
  <mrow>
   <msub>
    <mi>y</mi>
    <mn>0</mn>
   </msub>
   <mo>,</mo>
   <msub>
    <mi>y</mi>
    <mn>1</mn>
   </msub>
   <mo>,</mo>
   <msub>
    <mi>z</mi>
    <mn>0</mn>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <list>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>y</ci>
     <cn type="integer">0</cn>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>y</ci>
     <cn type="integer">1</cn>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>z</ci>
     <cn type="integer">0</cn>
    </apply>
   </list>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   y_{0},y_{1},z_{0}
  </annotation>
 </semantics>
</math>


 and 

<math display="inline" id="Trilinear_interpolation:19">
 <semantics>
  <msub>
   <mi>z</mi>
   <mn>1</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>z</ci>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   z_{1}
  </annotation>
 </semantics>
</math>

.</p>

<p>First we interpolate along 

<math display="inline" id="Trilinear_interpolation:20">
 <semantics>
  <mi>x</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>x</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x
  </annotation>
 </semantics>
</math>

 (imagine we are pushing the front face of the cube to the back), giving:</p>

<p>

<math display="block" id="Trilinear_interpolation:21">
 <semantics>
  <mrow>
   <msub>
    <mpadded lspace="5pt" width="+5pt">
     <mi>c</mi>
    </mpadded>
    <mn>00</mn>
   </msub>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mi>V</mi>
     <mrow>
      <mo stretchy="false">[</mo>
      <msub>
       <mi>x</mi>
       <mn>0</mn>
      </msub>
      <mo>,</mo>
      <msub>
       <mi>y</mi>
       <mn>0</mn>
      </msub>
      <mo>,</mo>
      <msub>
       <mi>z</mi>
       <mn>0</mn>
      </msub>
      <mo stretchy="false">]</mo>
     </mrow>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mn>1</mn>
       <mo>-</mo>
       <msub>
        <mi>x</mi>
        <mi>d</mi>
       </msub>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>+</mo>
    <mrow>
     <mi>V</mi>
     <mrow>
      <mo stretchy="false">[</mo>
      <msub>
       <mi>x</mi>
       <mn>1</mn>
      </msub>
      <mo>,</mo>
      <msub>
       <mi>y</mi>
       <mn>0</mn>
      </msub>
      <mo>,</mo>
      <msub>
       <mi>z</mi>
       <mn>0</mn>
      </msub>
      <mo stretchy="false">]</mo>
     </mrow>
     <msub>
      <mi>x</mi>
      <mi>d</mi>
     </msub>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>c</ci>
     <cn type="integer">00</cn>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <ci>V</ci>
      <list>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <cn type="integer">0</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>y</ci>
        <cn type="integer">0</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>z</ci>
        <cn type="integer">0</cn>
       </apply>
      </list>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <ci>d</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <ci>V</ci>
      <list>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <cn type="integer">1</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>y</ci>
        <cn type="integer">0</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>z</ci>
        <cn type="integer">0</cn>
       </apply>
      </list>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <ci>d</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \ c_{00}=V[x_{0},y_{0},z_{0}](1-x_{d})+V[x_{1},y_{0},z_{0}]x_{d}
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Trilinear_interpolation:22">
 <semantics>
  <mrow>
   <msub>
    <mpadded lspace="5pt" width="+5pt">
     <mi>c</mi>
    </mpadded>
    <mn>10</mn>
   </msub>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mi>V</mi>
     <mrow>
      <mo stretchy="false">[</mo>
      <msub>
       <mi>x</mi>
       <mn>0</mn>
      </msub>
      <mo>,</mo>
      <msub>
       <mi>y</mi>
       <mn>1</mn>
      </msub>
      <mo>,</mo>
      <msub>
       <mi>z</mi>
       <mn>0</mn>
      </msub>
      <mo stretchy="false">]</mo>
     </mrow>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mn>1</mn>
       <mo>-</mo>
       <msub>
        <mi>x</mi>
        <mi>d</mi>
       </msub>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>+</mo>
    <mrow>
     <mi>V</mi>
     <mrow>
      <mo stretchy="false">[</mo>
      <msub>
       <mi>x</mi>
       <mn>1</mn>
      </msub>
      <mo>,</mo>
      <msub>
       <mi>y</mi>
       <mn>1</mn>
      </msub>
      <mo>,</mo>
      <msub>
       <mi>z</mi>
       <mn>0</mn>
      </msub>
      <mo stretchy="false">]</mo>
     </mrow>
     <msub>
      <mi>x</mi>
      <mi>d</mi>
     </msub>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>c</ci>
     <cn type="integer">10</cn>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <ci>V</ci>
      <list>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <cn type="integer">0</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>y</ci>
        <cn type="integer">1</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>z</ci>
        <cn type="integer">0</cn>
       </apply>
      </list>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <ci>d</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <ci>V</ci>
      <list>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <cn type="integer">1</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>y</ci>
        <cn type="integer">1</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>z</ci>
        <cn type="integer">0</cn>
       </apply>
      </list>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <ci>d</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \ c_{10}=V[x_{0},y_{1},z_{0}](1-x_{d})+V[x_{1},y_{1},z_{0}]x_{d}
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Trilinear_interpolation:23">
 <semantics>
  <mrow>
   <msub>
    <mpadded lspace="5pt" width="+5pt">
     <mi>c</mi>
    </mpadded>
    <mn>01</mn>
   </msub>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mi>V</mi>
     <mrow>
      <mo stretchy="false">[</mo>
      <msub>
       <mi>x</mi>
       <mn>0</mn>
      </msub>
      <mo>,</mo>
      <msub>
       <mi>y</mi>
       <mn>0</mn>
      </msub>
      <mo>,</mo>
      <msub>
       <mi>z</mi>
       <mn>1</mn>
      </msub>
      <mo stretchy="false">]</mo>
     </mrow>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mn>1</mn>
       <mo>-</mo>
       <msub>
        <mi>x</mi>
        <mi>d</mi>
       </msub>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>+</mo>
    <mrow>
     <mi>V</mi>
     <mrow>
      <mo stretchy="false">[</mo>
      <msub>
       <mi>x</mi>
       <mn>1</mn>
      </msub>
      <mo>,</mo>
      <msub>
       <mi>y</mi>
       <mn>0</mn>
      </msub>
      <mo>,</mo>
      <msub>
       <mi>z</mi>
       <mn>1</mn>
      </msub>
      <mo stretchy="false">]</mo>
     </mrow>
     <msub>
      <mi>x</mi>
      <mi>d</mi>
     </msub>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>c</ci>
     <cn type="integer">01</cn>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <ci>V</ci>
      <list>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <cn type="integer">0</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>y</ci>
        <cn type="integer">0</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>z</ci>
        <cn type="integer">1</cn>
       </apply>
      </list>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <ci>d</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <ci>V</ci>
      <list>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <cn type="integer">1</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>y</ci>
        <cn type="integer">0</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>z</ci>
        <cn type="integer">1</cn>
       </apply>
      </list>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <ci>d</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \ c_{01}=V[x_{0},y_{0},z_{1}](1-x_{d})+V[x_{1},y_{0},z_{1}]x_{d}
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Trilinear_interpolation:24">
 <semantics>
  <mrow>
   <msub>
    <mpadded lspace="5pt" width="+5pt">
     <mi>c</mi>
    </mpadded>
    <mn>11</mn>
   </msub>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mi>V</mi>
     <mrow>
      <mo stretchy="false">[</mo>
      <msub>
       <mi>x</mi>
       <mn>0</mn>
      </msub>
      <mo>,</mo>
      <msub>
       <mi>y</mi>
       <mn>1</mn>
      </msub>
      <mo>,</mo>
      <msub>
       <mi>z</mi>
       <mn>1</mn>
      </msub>
      <mo stretchy="false">]</mo>
     </mrow>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mn>1</mn>
       <mo>-</mo>
       <msub>
        <mi>x</mi>
        <mi>d</mi>
       </msub>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>+</mo>
    <mrow>
     <mi>V</mi>
     <mrow>
      <mo stretchy="false">[</mo>
      <msub>
       <mi>x</mi>
       <mn>1</mn>
      </msub>
      <mo>,</mo>
      <msub>
       <mi>y</mi>
       <mn>1</mn>
      </msub>
      <mo>,</mo>
      <msub>
       <mi>z</mi>
       <mn>1</mn>
      </msub>
      <mo stretchy="false">]</mo>
     </mrow>
     <msub>
      <mi>x</mi>
      <mi>d</mi>
     </msub>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>c</ci>
     <cn type="integer">11</cn>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <ci>V</ci>
      <list>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <cn type="integer">0</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>y</ci>
        <cn type="integer">1</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>z</ci>
        <cn type="integer">1</cn>
       </apply>
      </list>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <ci>d</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <ci>V</ci>
      <list>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <cn type="integer">1</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>y</ci>
        <cn type="integer">1</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>z</ci>
        <cn type="integer">1</cn>
       </apply>
      </list>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <ci>d</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \ c_{11}=V[x_{0},y_{1},z_{1}](1-x_{d})+V[x_{1},y_{1},z_{1}]x_{d}
  </annotation>
 </semantics>
</math>

</p>

<p>Where 

<math display="inline" id="Trilinear_interpolation:25">
 <semantics>
  <mrow>
   <mi>V</mi>
   <mrow>
    <mo stretchy="false">[</mo>
    <msub>
     <mi>x</mi>
     <mn>0</mn>
    </msub>
    <mo>,</mo>
    <msub>
     <mi>y</mi>
     <mn>0</mn>
    </msub>
    <mo>,</mo>
    <msub>
     <mi>z</mi>
     <mn>0</mn>
    </msub>
    <mo stretchy="false">]</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>V</ci>
    <list>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <cn type="integer">0</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <cn type="integer">0</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>z</ci>
      <cn type="integer">0</cn>
     </apply>
    </list>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   V[x_{0},y_{0},z_{0}]
  </annotation>
 </semantics>
</math>

 means the function value of 

<math display="inline" id="Trilinear_interpolation:26">
 <semantics>
  <mrow>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>x</mi>
     <mn>0</mn>
    </msub>
    <mo>,</mo>
    <msub>
     <mi>y</mi>
     <mn>0</mn>
    </msub>
    <mo>,</mo>
    <msub>
     <mi>z</mi>
     <mn>0</mn>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <vector>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>x</ci>
     <cn type="integer">0</cn>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>y</ci>
     <cn type="integer">0</cn>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>z</ci>
     <cn type="integer">0</cn>
    </apply>
   </vector>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (x_{0},y_{0},z_{0}).
  </annotation>
 </semantics>
</math>

 Then we interpolate these values (along 

<math display="inline" id="Trilinear_interpolation:27">
 <semantics>
  <mi>y</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>y</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   y
  </annotation>
 </semantics>
</math>

, as we were pushing the top edge to the bottom), giving:</p>

<p>

<math display="block" id="Trilinear_interpolation:28">
 <semantics>
  <mrow>
   <msub>
    <mpadded lspace="5pt" width="+5pt">
     <mi>c</mi>
    </mpadded>
    <mn>0</mn>
   </msub>
   <mo>=</mo>
   <mrow>
    <mrow>
     <msub>
      <mi>c</mi>
      <mn>00</mn>
     </msub>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mn>1</mn>
       <mo>-</mo>
       <msub>
        <mi>y</mi>
        <mi>d</mi>
       </msub>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>+</mo>
    <mrow>
     <msub>
      <mi>c</mi>
      <mn>10</mn>
     </msub>
     <msub>
      <mi>y</mi>
      <mi>d</mi>
     </msub>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>c</ci>
     <cn type="integer">0</cn>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>c</ci>
       <cn type="integer">00</cn>
      </apply>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>y</ci>
        <ci>d</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>c</ci>
       <cn type="integer">10</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>y</ci>
       <ci>d</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \ c_{0}=c_{00}(1-y_{d})+c_{10}y_{d}
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Trilinear_interpolation:29">
 <semantics>
  <mrow>
   <msub>
    <mpadded lspace="5pt" width="+5pt">
     <mi>c</mi>
    </mpadded>
    <mn>1</mn>
   </msub>
   <mo>=</mo>
   <mrow>
    <mrow>
     <msub>
      <mi>c</mi>
      <mn>01</mn>
     </msub>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mn>1</mn>
       <mo>-</mo>
       <msub>
        <mi>y</mi>
        <mi>d</mi>
       </msub>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>+</mo>
    <mrow>
     <msub>
      <mi>c</mi>
      <mn>11</mn>
     </msub>
     <msub>
      <mi>y</mi>
      <mi>d</mi>
     </msub>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>c</ci>
     <cn type="integer">1</cn>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>c</ci>
       <cn type="integer">01</cn>
      </apply>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>y</ci>
        <ci>d</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>c</ci>
       <cn type="integer">11</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>y</ci>
       <ci>d</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \ c_{1}=c_{01}(1-y_{d})+c_{11}y_{d}
  </annotation>
 </semantics>
</math>

</p>

<p>Finally we interpolate these values along 

<math display="inline" id="Trilinear_interpolation:30">
 <semantics>
  <mi>z</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>z</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   z
  </annotation>
 </semantics>
</math>

(walking through a line):</p>

<p>

<math display="block" id="Trilinear_interpolation:31">
 <semantics>
  <mrow>
   <mrow>
    <mpadded lspace="5pt" width="+5pt">
     <mi>c</mi>
    </mpadded>
    <mo>=</mo>
    <mrow>
     <mrow>
      <msub>
       <mi>c</mi>
       <mn>0</mn>
      </msub>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mn>1</mn>
        <mo>-</mo>
        <msub>
         <mi>z</mi>
         <mi>d</mi>
        </msub>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo>+</mo>
     <mrow>
      <msub>
       <mi>c</mi>
       <mn>1</mn>
      </msub>
      <msub>
       <mi>z</mi>
       <mi>d</mi>
      </msub>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>c</ci>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>c</ci>
       <cn type="integer">0</cn>
      </apply>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>z</ci>
        <ci>d</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>c</ci>
       <cn type="integer">1</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>z</ci>
       <ci>d</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \ c=c_{0}(1-z_{d})+c_{1}z_{d}.
  </annotation>
 </semantics>
</math>

</p>

<p>This gives us a predicted value for the point.</p>

<p>The result of trilinear interpolation is independent of the order of the interpolation steps along the three axes: any other order, for instance along 

<math display="inline" id="Trilinear_interpolation:32">
 <semantics>
  <mi>x</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>x</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x
  </annotation>
 </semantics>
</math>

, then along 

<math display="inline" id="Trilinear_interpolation:33">
 <semantics>
  <mi>y</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>y</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   y
  </annotation>
 </semantics>
</math>


, and finally along 

<math display="inline" id="Trilinear_interpolation:34">
 <semantics>
  <mi>z</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>z</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   z
  </annotation>
 </semantics>
</math>

, produces the same value.</p>

<p>The above operations can be visualized as follows: First we find the eight corners of a cube that surround our point of interest. These corners have the values C000, C100, C010, C110, C001, C101, C011, C111.</p>

<p>Next, we perform linear interpolation between C000 and C100 to find C00, C001 and C101 to find C01, C011 and C111 to find C11, C010 and C110 to find C10.</p>

<p>Now we do interpolation between C00 and C10 to find C0, C01 and C11 to find C1. Finally, we calculate the value C via linear interpolation of C0 and C1</p>

<p>In practice, a trilinear interpolation is identical to three successive <a href="linear_interpolation" title="wikilink">linear interpolations</a>, or a <a href="bilinear_interpolation" title="wikilink">bilinear interpolation</a> combined with a linear interpolation:</p>

<p>

<math display="block" id="Trilinear_interpolation:35">
 <semantics>
  <mrow>
   <mi>C</mi>
   <mo rspace="7.5pt">≈</mo>
   <mrow>
    <mi>l</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>b</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <msub>
        <mi>C</mi>
        <mn>000</mn>
       </msub>
       <mo>,</mo>
       <msub>
        <mi>C</mi>
        <mn>010</mn>
       </msub>
       <mo>,</mo>
       <msub>
        <mi>C</mi>
        <mn>100</mn>
       </msub>
       <mo>,</mo>
       <msub>
        <mi>C</mi>
        <mn>110</mn>
       </msub>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo>,</mo>
     <mrow>
      <mi>b</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <msub>
        <mi>C</mi>
        <mn>001</mn>
       </msub>
       <mo>,</mo>
       <msub>
        <mi>C</mi>
        <mn>011</mn>
       </msub>
       <mo>,</mo>
       <msub>
        <mi>C</mi>
        <mn>101</mn>
       </msub>
       <mo>,</mo>
       <msub>
        <mi>C</mi>
        <mn>111</mn>
       </msub>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <approx></approx>
    <ci>C</ci>
    <apply>
     <times></times>
     <ci>l</ci>
     <interval closure="open">
      <apply>
       <times></times>
       <ci>b</ci>
       <vector>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>C</ci>
         <cn type="integer">000</cn>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>C</ci>
         <cn type="integer">010</cn>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>C</ci>
         <cn type="integer">100</cn>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>C</ci>
         <cn type="integer">110</cn>
        </apply>
       </vector>
      </apply>
      <apply>
       <times></times>
       <ci>b</ci>
       <vector>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>C</ci>
         <cn type="integer">001</cn>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>C</ci>
         <cn type="integer">011</cn>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>C</ci>
         <cn type="integer">101</cn>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>C</ci>
         <cn type="integer">111</cn>
        </apply>
       </vector>
      </apply>
     </interval>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   C\approx\ l(b(C_{000},C_{010},C_{100},C_{110}),b(C_{001},C_{011},C_{101},C_{11%
1}))
  </annotation>
 </semantics>
</math>

</p>
<h2 id="see-also">See also</h2>
<ul>
<li><a href="Linear_interpolation" title="wikilink">Linear interpolation</a></li>
<li><a href="Bilinear_interpolation" title="wikilink">Bilinear interpolation</a></li>
<li><a href="Tricubic_interpolation" title="wikilink">Tricubic interpolation</a></li>
<li><a href="Radial_interpolation" title="wikilink">Radial interpolation</a></li>
<li><a href="Tetrahedral_interpolation" title="wikilink">Tetrahedral interpolation</a></li>
</ul>
<h2 id="external-links">External links</h2>
<ul>
<li><a href="http://www.grc.nasa.gov/WWW/winddocs/utilities/b4wind_guide/trilinear.html">pseudo-code from NASA</a>, describes an iterative inverse trilinear interpolation (given the vertices and the value of C find Xd, Yd and Zd).</li>
<li>Paul Bourke, <a href="http://paulbourke.net/miscellaneous/interpolation/">Interpolation methods</a>, 1999. Contains a very clever and simple method to find trilinear interpolation that is based on binary logic and can be extended to any dimension (Tetralinear, Pentalinear, ...).</li>
</ul>

<p>"</p>

<p><a href="Category:Multivariate_interpolation" title="wikilink">Category:Multivariate interpolation</a></p>
</body>
</html>

   Finite difference      Finite difference   A finite difference is a mathematical expression of the form    f   (   x  +  b   )    −  f   (   x  +  a   )       f    x  b   normal-  normal-−  f    x  a     f(x+b) −f(x+a)   . If a finite difference is divided by    b  −  a      b  normal-−  a    b−a   , one gets a difference quotient . The approximation of derivatives by finite differences plays a central role in finite difference methods for the numerical solution of differential equations , especially boundary value problems .  Certain recurrence relations can be written as difference equations by replacing iteration notation with finite differences.  Today, the term "finite difference" is often taken as synonymous with finite difference approximations of derivatives, especially in the context of numerical methods . 1 2 3 Finite difference approximations are finite difference quotients in the terminology employed above.  Finite differences have also been the topic of study as abstract self-standing mathematical objects, e.g. in works by George Boole (1860), L. M. Milne-Thomson (1933), and Károly Jordan (1939), tracing its origins back to Isaac Newton . In this viewpoint, the formal calculus of finite differences is an alternative to the calculus of infinitesimals . 4  Forward, backward, and central differences  Three forms are commonly considered: forward, backward, and central differences. 5 6 7  A forward difference is an expression of the form         Δ  h    [  f  ]    (  x  )    =    f   (   x  +  h   )    -   f   (  x  )      .         subscript  normal-Δ  h    delimited-[]  f   x       f    x  h      f  x      \Delta_{h}[f](x)=f(x+h)-f(x).     Depending on the application, the spacing h may be variable or constant. When omitted, h is taken to be 1     Δ   [  f  ]    (  x  )    =    Δ  1    [  f  ]    (  x  )          normal-Δ   delimited-[]  f   x      subscript  normal-Δ  1    delimited-[]  f   x     \Delta[f](x)=\Delta_{1}[f](x)   .  A backward difference uses the function values at x and x − h , instead of the values at x + h and x :          ∇  h    [  f  ]     (  x  )    =    f   (  x  )    -   f   (   x  -  h   )      .         subscript  normal-∇  h   f   x       f  x     f    x  h       \nabla_{h}[f](x)=f(x)-f(x-h).   Finally, the central difference is given by         δ  h    [  f  ]    (  x  )    =    f   (   x  +     1  2    h    )    -   f   (   x  -     1  2    h    )      .         subscript  δ  h    delimited-[]  f   x       f    x      1  2   h       f    x      1  2   h        \delta_{h}[f](x)=f(x+\tfrac{1}{2}h)-f(x-\tfrac{1}{2}h)~{}.     Relation with derivatives  The derivative of a function   f   f   f   at a point   x   x   x   is defined by the limit         f  ′    (  x  )    =    lim   h  →  0       f   (   x  +  h   )    -   f   (  x  )     h     .         superscript  f  normal-′   x     subscript    normal-→  h  0          f    x  h      f  x    h      f^{\prime}(x)=\lim_{h\to 0}\frac{f(x+h)-f(x)}{h}.     If   h   h   h   has a fixed (non-zero) value instead of approaching zero, then the right-hand side of the above equation would be written          f   (   x  +  h   )    -   f   (  x  )     h   =     Δ  h    [  f  ]    (  x  )    h    .            f    x  h      f  x    h        subscript  normal-Δ  h    delimited-[]  f   x   h     \frac{f(x+h)-f(x)}{h}=\frac{\Delta_{h}[f](x)}{h}.     Hence, the forward difference divided by   h   h   h   approximates the derivative when   h   h   h   is small. The error in this approximation can be derived from Taylor's theorem . Assuming that   f   f   f   is differentiable, we have         Δ  h    [  f  ]    (  x  )    h   -   f  ′    (  x  )   =  O   (  h  )   →  0  as   (  h  →  0  )   .     fragments       subscript  normal-Δ  h    delimited-[]  f   x   h     superscript  f  normal-′    fragments  normal-(  x  normal-)    O   fragments  normal-(  h  normal-)   normal-→  0   as   fragments  normal-(  h  normal-→  0  normal-)   normal-.    \frac{\Delta_{h}[f](x)}{h}-f^{\prime}(x)=O(h)\to 0\quad\text{as }(h\to 0).     The same formula holds for the backward difference:          ∇  h    [  f  ]     (  x  )    h   -   f  ′    (  x  )   =  O   (  h  )   →  0  as   (  h  →  0  )   .     fragments       subscript  normal-∇  h   f   x   h     superscript  f  normal-′    fragments  normal-(  x  normal-)    O   fragments  normal-(  h  normal-)   normal-→  0   as   fragments  normal-(  h  normal-→  0  normal-)   normal-.    \frac{\nabla_{h}[f](x)}{h}-f^{\prime}(x)=O(h)\to 0\quad\text{as }(h\to 0).     However, the central (also called centered) difference yields a more accurate approximation. If   f   f   f   is twice differentiable,           δ  h    [  f  ]    (  x  )    h   -    f  ′    (  x  )     =   O   (   h  2   )     .             subscript  δ  h    delimited-[]  f   x   h      superscript  f  normal-′   x      O   superscript  h  2      \frac{\delta_{h}[f](x)}{h}-f^{\prime}(x)=O(h^{2}).\!     The main problem with the central difference method, however, is that oscillating functions can yield zero derivative. If     f   (   n  h   )    =  1        f    n  h    1    f(nh)=1   for   n   n   n   odd, and     f   (   n  h   )    =  2        f    n  h    2    f(nh)=2   for   n   n   n   even, then     f   (   n  h   )    =  0        f    n  h    0    f(nh)=0   if it is calculated with the central difference scheme. This is particularly troublesome if the domain of   f   f   f   is discrete.  Authors for whom finite differences mean finite difference approximations define the forward/backward/central differences as the quotients given in this section (instead of employing the definitions given in the previous section). 8 9 10   Higher-order differences  In an analogous way one can obtain finite difference approximations to higher order derivatives and differential operators. For example, by using the above central difference formula for    f   (   x  +   h  /  2    )       f    x    h  2      f(x+h/2)   and    f   (    x  −  h   /  2   )       f      x  normal-−  h   2     f(x−h/2)   and applying a central difference formula for the derivative of   f   f   f   at   x   x   x   , we obtain the central difference approximation of the second derivative of   f   f   f   :  2nd order central         f  ′′    (  x  )    ≈     δ  h  2    [  f  ]    (  x  )     h  2    =      f   (   x  +  h   )    -   2  f   (  x  )     +   f   (   x  -  h   )      h  2     .           superscript  f  ′′   x        superscript   subscript  δ  h   2    delimited-[]  f   x    superscript  h  2                 f    x  h      2  f  x      f    x  h      superscript  h  2       f^{\prime\prime}(x)\approx\frac{\delta_{h}^{2}[f](x)}{h^{2}}=\frac{f(x+h)-2f(x%
 )+f(x-h)}{h^{2}}.     Similarly we can apply other differencing formulas in a recursive manner.  2nd order forward         f  ′′    (  x  )    ≈     Δ  h  2    [  f  ]    (  x  )     h  2    =      f   (   x  +   2  h    )    -   2  f   (   x  +  h   )     +   f   (  x  )      h  2     .           superscript  f  ′′   x        superscript   subscript  normal-Δ  h   2    delimited-[]  f   x    superscript  h  2                 f    x    2  h       2  f    x  h       f  x     superscript  h  2       f^{\prime\prime}(x)\approx\frac{\Delta_{h}^{2}[f](x)}{h^{2}}=\frac{f(x+2h)-2f(%
 x+h)+f(x)}{h^{2}}.     More generally, the    n   n   n   -th order forward, backward, and central differences are given by, respectively,  Forward         Δ  h  n    [  f  ]    (  x  )    =    ∑   i  =  0   n      (   -  1   )   i    (     n      i     )   f   (   x  +    (   n  -  i   )   h    )      ,         subscript   superscript  normal-Δ  n   h    delimited-[]  f   x     superscript   subscript     i  0    n      superscript    1   i    binomial  n  i   f    x      n  i   h        \Delta^{n}_{h}[f](x)=\sum_{i=0}^{n}(-1)^{i}{\left({{n}\atop{i}}\right)}f(x+(n-%
 i)h),     or for h=1,        Δ  n    [  f  ]    (  x  )    =    ∑   k  =  0   n     (     n      k     )     (   -  1   )    n  -  k    f   (   x  +  k   )            superscript  normal-Δ  n    delimited-[]  f   x     superscript   subscript     k  0    n      binomial  n  k    superscript    1     n  k    f    x  k       \Delta^{n}[f](x)=\sum_{k=0}^{n}{\left({{n}\atop{k}}\right)}(-1)^{n-k}f(x+k)     Backward          ∇  h  n    [  f  ]     (  x  )    =    ∑   i  =  0   n      (   -  1   )   i    (     n      i     )   f   (   x  -   i  h    )      ,         subscript   superscript  normal-∇  n   h   f   x     superscript   subscript     i  0    n      superscript    1   i    binomial  n  i   f    x    i  h        \nabla^{n}_{h}[f](x)=\sum_{i=0}^{n}(-1)^{i}{\left({{n}\atop{i}}\right)}f(x-ih),     Central         δ  h  n    [  f  ]    (  x  )    =    ∑   i  =  0   n      (   -  1   )   i    (     n      i     )   f   (   x  +    (    n  2   -  i   )   h    )      .         subscript   superscript  δ  n   h    delimited-[]  f   x     superscript   subscript     i  0    n      superscript    1   i    binomial  n  i   f    x        n  2   i   h        \delta^{n}_{h}[f](x)=\sum_{i=0}^{n}(-1)^{i}{\left({{n}\atop{i}}\right)}f\left(%
 x+\left(\frac{n}{2}-i\right)h\right).     These equations are using binomial coefficients after the summation sign shown as     (      n      i      )      binomial  n  i    \ {\left({{n}\atop{i}}\right)}   . Each row of Pascal's triangle provides the coefficient for each value of i.  Note that the central difference will, for odd   n   n   n   , have   h   h   h   multiplied by non-integers. This is often a problem because it amounts to changing the interval of discretization. The problem may be remedied taking the average of     δ  n    [  f  ]    (   x  -   h  /  2    )        superscript  δ  n    delimited-[]  f     x    h  2      \delta^{n}[f](x-h/2)   and     δ  n    [  f  ]    (   x  +   h  /  2    )        superscript  δ  n    delimited-[]  f     x    h  2      \delta^{n}[f](x+h/2)   .  Forward differences applied to a sequence are sometimes called the binomial transform of the sequence, and have a number of interesting combinatorial properties. Forward differences may be evaluated using the Nörlund–Rice integral . The integral representation for these types of series is interesting, because the integral can often be evaluated using asymptotic expansion or saddle-point techniques; by contrast, the forward difference series can be extremely hard to evaluate numerically, because the binomial coefficients grow rapidly for large   n   n   n   .  The relationship of these higher-order differences with the respective derivatives is straightforward,           d  n   f    d   x  n      (  x  )    =      Δ  h  n    [  f  ]    (  x  )     h  n    +   O   (  h  )     =       ∇  h  n    [  f  ]     (  x  )     h  n    +   O   (  h  )     =      δ  h  n    [  f  ]    (  x  )     h  n    +   O   (   h  2   )      .               superscript  d  n   f     d   superscript  x  n     x          superscript   subscript  normal-Δ  h   n    delimited-[]  f   x    superscript  h  n      O  h                superscript   subscript  normal-∇  h   n   f   x    superscript  h  n      O  h                superscript   subscript  δ  h   n    delimited-[]  f   x    superscript  h  n      O   superscript  h  2        \frac{d^{n}f}{dx^{n}}(x)=\frac{\Delta_{h}^{n}[f](x)}{h^{n}}+O(h)=\frac{\nabla_%
 {h}^{n}[f](x)}{h^{n}}+O(h)=\frac{\delta_{h}^{n}[f](x)}{h^{n}}+O(h^{2}).     Higher-order differences can also be used to construct better approximations. As mentioned above, the first-order difference approximates the first-order derivative up to a term of order   h   h   h   . However, the combination          Δ  h    [  f  ]    (  x  )    -    1  2    Δ  h  2    [  f  ]    (  x  )     h   =   -      f   (   x  +   2  h    )    -   4  f   (   x  +  h   )     +   3  f   (  x  )      2  h                subscript  normal-Δ  h    delimited-[]  f   x       1  2    superscript   subscript  normal-Δ  h   2    delimited-[]  f   x    h             f    x    2  h       4  f    x  h       3  f  x      2  h       \frac{\Delta_{h}[f](x)-\frac{1}{2}\Delta_{h}^{2}[f](x)}{h}=-\frac{f(x+2h)-4f(x%
 +h)+3f(x)}{2h}   approximates f '( x ) up to a term of order . This can be proven by expanding the above expression in Taylor series , or by using the calculus of finite differences, explained below.  If necessary, the finite difference can be centered about any point by mixing forward, backward, and central differences.  Arbitrarily sized kernels  Using a little linear algebra, one can fairly easily construct approximations, which sample an arbitrary number of points to the left and a (possibly different) number of points to the right of the center point, for any order of derivative. This involves solving a linear system such that the Taylor expansion of the sum of those points, around the center point, well approximates the Taylor expansion of the desired derivative.  This is useful for differentiating a function on a grid, where, as one approaches the edge of the grid, one must sample fewer and fewer points on one side.  The details are outlined in these notes .  Properties   For all positive k and n          Δ   k  h   n    (  f  ,  x  )    =    ∑    i  1   =  0    k  -  1      ∑    i  2   =  0    k  -  1     ⋯    ∑    i  n   =  0    k  -  1      Δ  h  n    (  f  ,   x  +    i  1   h   +    i  2   h   +  ⋯  +    i  n   h    )         .         subscript   superscript  normal-Δ  n     k  h     f  x      superscript   subscript      subscript  i  1   0      k  1      superscript   subscript      subscript  i  2   0      k  1      normal-⋯    superscript   subscript      subscript  i  n   0      k  1       subscript   superscript  normal-Δ  n   h    f    x     subscript  i  1   h      subscript  i  2   h   normal-⋯     subscript  i  n   h            \Delta^{n}_{kh}(f,x)=\sum\limits_{i_{1}=0}^{k-1}\sum\limits_{i_{2}=0}^{k-1}%
 \cdots\sum\limits_{i_{n}=0}^{k-1}\Delta^{n}_{h}(f,x+i_{1}h+i_{2}h+\cdots+i_{n}%
 h).      Leibniz rule :          Δ  h  n    (   f  g   ,  x  )    =    ∑   k  =  0   n     (     n      k     )    Δ  h  k    (  f  ,  x  )    Δ  h   n  -  k     (  g  ,   x  +   k  h    )      .         subscript   superscript  normal-Δ  n   h      f  g   x      superscript   subscript     k  0    n      binomial  n  k    subscript   superscript  normal-Δ  k   h    f  x    subscript   superscript  normal-Δ    n  k    h    g    x    k  h         \Delta^{n}_{h}(fg,x)=\sum\limits_{k=0}^{n}{\left({{n}\atop{k}}\right)}\Delta^{%
 k}_{h}(f,x)\Delta^{n-k}_{h}(g,x+kh).     Finite difference methods  An important application of finite differences is in numerical analysis , especially in numerical differential equations , which aim at the numerical solution of ordinary and partial differential equations respectively. The idea is to replace the derivatives appearing in the differential equation by finite differences that approximate them. The resulting methods are called finite difference methods .  Common applications of the finite difference method are in computational science and engineering disciplines, such as thermal engineering , fluid mechanics , etc.  Newton's series  The Newton series consists of the terms of the Newton forward difference equation , named after Isaac Newton ; in essence, it is the Newton interpolation formula , first published in his Principia Mathematica in 1687, 11 namely the discrete analog of the continuum Taylor expansion,  which holds for any polynomial function f and for most (but not all) analytic functions . Here, the expression       (     x      k     )   =     (  x  )   k    k  !         binomial  x  k      subscript  x  k     k      {x\choose k}=\frac{(x)_{k}}{k!}     is the binomial coefficient , and        (  x  )   k   =   x   (   x  -  1   )    (   x  -  2   )   ⋯   (    x  -  k   +  1   )         subscript  x  k     x    x  1     x  2   normal-⋯      x  k   1      (x)_{k}=x(x-1)(x-2)\cdots(x-k+1)     is the " falling factorial " or "lower factorial", while the empty product ( x ) 0 is defined to be 1. In this particular case, there is an assumption of unit steps for the changes in the values of x , h = 1 of the generalization below.  Note the formal correspondence of this result to Taylor's theorem . Historically, this, as well as the Chu–Vandermonde identity ,         (   x  +  y   )   n   =    ∑   k  =  0   n     (     n      k     )      (  x  )    n  -  k        (  y  )   k       ,       subscript    x  y   n     superscript   subscript     k  0    n      binomial  n  k    subscript  x    n  k     subscript  y  k       (x+y)_{n}=\sum_{k=0}^{n}{n\choose k}(x)_{n-k}~{}(y)_{k}~{},   (following from it, and corresponding to the binomial theorem ), are included in the observations that matured to the system of the umbral calculus .  To illustrate how one may use Newton's formula in actual practice, consider the first few terms of doubling the Fibonacci sequence    f   f   f   = 2, 2, 4, ... One can find a polynomial that reproduces these values, by first computing a difference table, and then substituting the differences that correspond to x 0 (underlined) into the formula as follows,           x     f  =   Δ  0       Δ  1      Δ  2       1     2  ¯                0  ¯         2    2       2  ¯           2        3    4                f   (  x  )       =   Δ  0   ⋅  1  +   Δ  1   ⋅     (   x  -   x  0    )   1    1  !    +   Δ  2   ⋅     (   x  -   x  0    )   2    2  !     (   x  0   =  1  )              =    2  ⋅  1   +   0  ⋅    x  -  1   1    +   2  ⋅     (   x  -  1   )    (   x  -  2   )    2                =   2  +    (   x  -  1   )    (   x  -  2   )                  x    f   superscript  normal-Δ  0     superscript  normal-Δ  1    superscript  normal-Δ  2     1   normal-¯  2    missing-subexpression    missing-subexpression      missing-subexpression    missing-subexpression    normal-¯  0    missing-subexpression     2  2   missing-subexpression    normal-¯  2      missing-subexpression    missing-subexpression   2   missing-subexpression     3  4   missing-subexpression    missing-subexpression         f  x    fragments    superscript  normal-Δ  0   normal-⋅  1    superscript  normal-Δ  1   normal-⋅     subscript    x   subscript  x  0    1     1      superscript  normal-Δ  2   normal-⋅     subscript    x   subscript  x  0    2     2    normal-   fragments  normal-(   subscript  x  0    1  normal-)       missing-subexpression      missing-subexpression     absent     normal-⋅  2  1    normal-⋅  0      x  1   1     normal-⋅  2        x  1     x  2    2         missing-subexpression      missing-subexpression     absent    2      x  1     x  2           \begin{matrix}\par
 \begin{array}[]{|c| |c|c|c|}\hline x&f=\Delta^{0}&\Delta^{1%
 }&\Delta^{2}\\
 \hline 1&\underline{2}&&\\
 &&\underline{0}&\\
 2&2&&\underline{2}\\
 &&2&\\
 3&4&&\\
 \hline\end{array}\par
 &\par
 \quad\begin{aligned}\displaystyle f(x)&%
 \displaystyle=\Delta^{0}\cdot 1+\Delta^{1}\cdot\dfrac{(x-x_{0})_{1}}{1!}+%
 \Delta^{2}\cdot\dfrac{(x-x_{0})_{2}}{2!}\quad(x_{0}=1)\\
 \\
 &\displaystyle=2\cdot 1+0\cdot\dfrac{x-1}{1}+2\cdot\dfrac{(x-1)(x-2)}{2}\\
 \\
 &\displaystyle=2+(x-1)(x-2)\\
 \end{aligned}\end{matrix}     For the case of nonuniform steps in the values of x , Newton computes the divided differences ,       Δ   j  ,  0    =   y  j   ,   Δ   j  ,  k    =     Δ    j  +  1   ,   k  -  1     -   Δ   j  ,   k  -  1        x   j  +  k    -   x  j     ∋   {  k  >  0  ,  j  ≤  max   (  j  )   -  k  }   ,  Δ   0  k   =   Δ   0  ,  k       fragments   subscript  normal-Δ   j  0      subscript  y  j   normal-,   subscript  normal-Δ   j  k          subscript  normal-Δ     j  1     k  1      subscript  normal-Δ   j    k  1         subscript  x    j  k     subscript  x  j      contains    fragments  normal-{  k   0  normal-,  j     fragments  normal-(  j  normal-)    k  normal-}   normal-,  Δ   subscript  0  k     subscript  normal-Δ   0  k      \Delta_{j,0}=y_{j},\quad\quad\Delta_{j,k}=\frac{\Delta_{j+1,k-1}-\Delta_{j,k-1%
 }}{x_{j+k}-x_{j}}\quad\ni\quad\left\{k>0,\ \ j\leq\max\left(j\right)-k\right\}%
 ,\quad\quad\Delta 0_{k}=\Delta_{0,k}   the series of products,         P  0   =  1   ,    P   k  +  1    =    P  k   ⋅   (   ξ  -   x  k    )      ,     formulae-sequence     subscript  P  0   1      subscript  P    k  1     normal-⋅   subscript  P  k     ξ   subscript  x  k        {P_{0}}=1,\quad\quad P_{k+1}=P_{k}\cdot\left(\xi-x_{k}\right)~{},   and the resulting polynomial is the scalar product ,     f   (  ξ  )    =     Δ  0   ⋅  P    (  ξ  )          f  ξ      normal-⋅    normal-Δ  0   P   ξ     f(\xi)=\Delta 0\cdot P\left(\xi\right)   . 12  In analysis with p-adic numbers , Mahler's theorem states that the assumption that f is a polynomial function can be weakened all the way to the assumption that f is merely continuous.  Carlson's theorem provides necessary and sufficient conditions for a Newton series to be unique, if it exists. However, a Newton series does not, in general, exist.  The Newton series, together with the Stirling series and the Selberg series , is a special case of the general difference series , all of which are defined in terms of suitably scaled forward differences.  In a compressed and slightly more general form and equidistant nodes the formula reads        f   (  x  )    =    ∑   k  =  0      (        x  -  a   h        k     )     ∑   j  =  0   k      (   -  1   )    k  -  j     (     k      j     )   f   (   a  +   j  h    )        .        f  x     subscript     k  0       binomial      x  a   h   k     superscript   subscript     j  0    k      superscript    1     k  j     binomial  k  j   f    a    j  h          f(x)=\sum_{k=0}{\frac{x-a}{h}\choose k}\sum_{j=0}^{k}(-1)^{k-j}{k\choose j}f(a%
 +jh).     Calculus of finite differences  The forward difference can be considered as a difference operator , 13 14 which maps the function   f   f   f   to . This operator amounts to          Δ  h   =    T  h   -  I    ,       subscript  normal-Δ  h      subscript  T  h   I     \Delta_{h}=T_{h}-I,\,        where is the shift operator with step h , defined by  f ( x + h )}} , and   I   I   I   is the identity operator .  The finite difference of higher orders can be defined in recursive manner as ). Another equivalent definition is [ T h − I ] n }} .  The difference operator is a linear operator and it satisfies a special Leibniz rule indicated above, (Δ h f ( x )) g ( x + h ) + f ( x ) (Δ h g ( x ))}} . Similar statements hold for the backward and central differences.  Formally applying the Taylor series with respect to h , yields the formula        Δ  h   =    h  D   +    1  2    h  2    D  2    +    1   3  !     h  3    D  3    +  ⋯   =    e   h  D    -   I     ,         subscript  normal-Δ  h       h  D       1  2    superscript  h  2    superscript  D  2        1    3     superscript  h  3    superscript  D  3    normal-⋯           superscript  normal-e    h  D    I      \Delta_{h}=hD+\frac{1}{2}h^{2}D^{2}+\frac{1}{3!}h^{3}D^{3}+\cdots=\mathrm{e}^{%
 hD}-I~{},   where D denotes the continuum derivative operator, mapping f to its derivative f '. The expansion is valid when both sides act on analytic functions , for sufficiently small h . Thus, e hD }} , and formally inverting the exponential yields        h  D   =   log   (   1  +   Δ  h    )    =     Δ  h   -     1  2     Δ  h  2     +     1  3     Δ  h  3    +  ⋯    .          h  D       1   subscript  normal-Δ  h               subscript  normal-Δ  h       1  2    superscript   subscript  normal-Δ  h   2         1  3    superscript   subscript  normal-Δ  h   3    normal-⋯      hD=\log(1+\Delta_{h})=\Delta_{h}-\tfrac{1}{2}\Delta_{h}^{2}+\tfrac{1}{3}\Delta%
 _{h}^{3}+\cdots.\,   This formula holds in the sense that both operators give the same result when applied to a polynomial.  Even for analytic functions, the series on the right is not guaranteed to converge; it may be an asymptotic series . However, it can be used to obtain more accurate approximations for the derivative. For instance, retaining the first two terms of the series yields the second-order approximation to    f  ’   (  x  )       f  normal-’  x    f’(x)   mentioned at the end of the section Higher-order differences .  The analogous formulas for the backward and central difference operators are         h  D   =    -   log   (   1  -   ∇  h    )     and      h  D   =    2    arsinh   (     1  2     δ  h    )       .     formulae-sequence      h  D          1   subscript  normal-∇  h      and        h  D     2   arsinh      1  2    subscript  δ  h         hD=-\log(1-\nabla_{h})\quad\text{and}\quad hD=2\,\operatorname{arsinh}(\tfrac{%
 1}{2}\delta_{h}).     The calculus of finite differences is related to the umbral calculus of combinatorics. This remarkably systematic correspondence is due to the identity of the commutators of the umbral quantities to their continuum analogs (    h  →  0      h  normal-→  0    h→0   limits),  A large number of formal differential relations of standard calculus involving functions    f   (  x  )       f  x    f(x)   thus map systematically to umbral finite-difference analogs involving .  For instance, the umbral analog of a monomial x n is a generalization of the above falling factorial ( Pochhammer k-symbol ),        (  x  )   n   ≡    (   x   T  h   -  1     )   n   =   x   (   x  -  h   )    (   x  -   2  h    )   ⋯   (   x  -    (   n  -  1   )   h    )           subscript  x  n    superscript    x   superscript   subscript  T  h     1     n          x    x  h     x    2  h    normal-⋯    x      n  1   h        ~{}(x)_{n}\equiv(xT_{h}^{-1})^{n}=x(x-h)(x-2h)\cdots(x-(n-1)h)   , so that             Δ  h   h      (  x  )   n    =    n      (  x  )    n  -  1       ,           subscript  normal-Δ  h   h    subscript  x  n      n   subscript  x    n  1       \frac{\Delta_{h}}{h}~{}(x)_{n}=n~{}(x)_{n-1}~{},        hence the above Newton interpolation formula (by matching coefficients in the expansion of an arbitrary function f ( x ) in such symbols), and so on.  For example, the umbral sine is        sin   (    x    T  h   -  1     )    =      x  -     (  x  )   3    3  !     +     (  x  )   5    5  !     -     (  x  )   7    7  !     +  ⋯    .          x   superscript   subscript  T  h     1              x     subscript  x  3     3        subscript  x  5     5        subscript  x  7     7     normal-⋯     \sin(x\,T_{h}^{-1})=x-\frac{(x)_{3}}{3!}+\frac{(x)_{5}}{5!}-\frac{(x)_{7}}{7!}%
 +\cdots.     As in the continuum limit, the eigenfunction of also happens to be an exponential ,             Δ  h   h      (   1  +   λ  h    )    x  /  h     =      Δ  h   h     e     ln   (   1  +   λ  h    )    x   /  h     =    λ     e     ln   (   1  +   λ  h    )    x   /  h       ,             subscript  normal-Δ  h   h    superscript    1    λ  h      x  h          subscript  normal-Δ  h   h    superscript  e          1    λ  h     x   h            λ   superscript  e          1    λ  h     x   h        \frac{\Delta_{h}}{h}~{}(1+\lambda h)^{x/h}=\frac{\Delta_{h}}{h}~{}e^{\ln(1+%
 \lambda h)~{}x/h}=\lambda~{}e^{\ln(1+\lambda h)~{}x/h}~{},        and hence Fourier sums of continuum functions are readily mapped to umbral Fourier sums faithfully , i.e., involving the same Fourier coefficients multiplying these umbral basis exponentials. 15 This umbral exponential thus amounts to the exponential generating function of the Pochhammer symbols .  Thus, for instance, the Dirac delta function maps to its umbral correspondent, the cardinal sine function ,        δ   (  x  )    ↦     sin   [    π  2    (   1  +   x  /  h    )    ]     π   (   x  +  h   )       ,     maps-to    δ  x           π  2     1    x  h        π    x  h       \delta(x)\mapsto\frac{\sin\bigl[\frac{\pi}{2}(1+x/h)\bigr]}{\pi(x+h)}~{},     and so forth. 16  Difference equations can often be solved with techniques very similar to those for solving differential equations .  The inverse operator of the forward difference operator, so then the umbral integral, is the indefinite sum or antidifference operator.  Rules for calculus of finite difference operators  Analogous to rules for finding the derivative , we have:   Constant rule : If c is a constant , then        Δ  c   =   0         normal-Δ  c   0    \Delta c=0{\,}      Linearity : if a and b are constants ,        Δ   (    a  f   +   b  g    )    =     a   Δ  f   +    b   Δ  g          normal-Δ      a  f     b  g         a  normal-Δ  f     b  normal-Δ  g      \Delta(af+bg)=a\,\Delta f+b\,\Delta g     All of the above rules apply equally well to any difference operator, including   ∇   normal-∇   \nabla   as to   Δ   normal-Δ   \Delta   .   Product rule :        Δ   (   f  g   )    =     f   Δ  g   +    g   Δ  f   +   Δ   f   Δ  g          normal-Δ    f  g        f  normal-Δ  g     g  normal-Δ  f     normal-Δ  f  normal-Δ  g      \Delta(fg)=f\,\Delta g+g\,\Delta f+\Delta f\,\Delta g          ∇   (   f  g   )    =      f    ∇  g    +    g    ∇  f     -    ∇   f     ∇  g          normal-∇    f  g          f   normal-∇  g      g   normal-∇  f        normal-∇  f    normal-∇  g       \nabla(fg)=f\,\nabla g+g\,\nabla f-\nabla f\,\nabla g      Quotient rule :        ∇   (   f  g   )    =    1  g    det    [      ∇  f      ∇  g       f    g     ]     (   det   [     g     ∇  g       1    1     ]    )    -  1            normal-∇    f  g        1  g          normal-∇  f    normal-∇  g     f  g     superscript      g   normal-∇  g     1  1       1         \nabla\left(\frac{f}{g}\right)=\frac{1}{g}\det\begin{bmatrix}\nabla f&\nabla g%
 \\
 f&g\end{bmatrix}\left(\det{\begin{bmatrix}g&\nabla g\\
 1&1\end{bmatrix}}\right)^{-1}       or         ∇   (   f  g   )    =      g    ∇  f    -    f    ∇  g      g  ⋅   (   g  -   ∇  g    )          normal-∇    f  g          g   normal-∇  f      f   normal-∇  g      normal-⋅  g    g   normal-∇  g        \nabla\left(\frac{f}{g}\right)=\frac{g\,\nabla f-f\,\nabla g}{g\cdot(g-\nabla g)}          Δ   (   f  g   )    =      g   Δ  f   -    f   Δ  g     g  ⋅   (   g  +   Δ  g    )           normal-Δ    f  g          g  normal-Δ  f     f  normal-Δ  g     normal-⋅  g    g    normal-Δ  g        \Delta\left(\frac{f}{g}\right)=\frac{g\,\Delta f-f\,\Delta g}{g\cdot(g+\Delta g)}       Summation rules :         ∑   n  =  a   b    Δ  f   (  n  )     =    f   (   b  +  1   )    -   f   (  a  )           superscript   subscript     n  a    b     normal-Δ  f  n        f    b  1      f  a      \sum_{n=a}^{b}\Delta f(n)=f(b+1)-f(a)           ∑   n  =  a   b     ∇  f    (  n  )     =    f   (  b  )    -   f   (   a  -  1   )           superscript   subscript     n  a    b      normal-∇  f   n        f  b     f    a  1       \sum_{n=a}^{b}\nabla f(n)=f(b)-f(a-1)    See Refs 17 18 19 20  Generalizations   A generalized finite difference is usually defined as          Δ  h  μ    [  f  ]    (  x  )    =    ∑   k  =  0   N     μ  k   f   (   x  +   k  h    )      ,         superscript   subscript  normal-Δ  h   μ    delimited-[]  f   x     superscript   subscript     k  0    N      subscript  μ  k   f    x    k  h        \Delta_{h}^{\mu}[f](x)=\sum_{k=0}^{N}\mu_{k}f(x+kh),   where    μ  =   (   μ  0   ,  …  ,   μ  N   )       μ    subscript  μ  0   normal-…   subscript  μ  N      \mu=(\mu_{0},\ldots,\mu_{N})   is its coefficients vector. An infinite difference is a further generalization, where the finite sum above is replaced by an infinite series . Another way of generalization is making coefficients    μ  k     subscript  μ  k    \mu_{k}   depend on point   x   x   x        μ  k   =    μ  k    (  x  )         subscript  μ  k      subscript  μ  k   x     \mu_{k}=\mu_{k}(x)   , thus considering weighted finite difference . Also one may make step   h   h   h   depend on point   x   x   x       h  =   h   (  x  )        h    h  x     h=h(x)   . Such generalizations are useful for constructing different modulus of continuity .   The generalized difference can be seen as the polynomial rings    R   [   T  h   ]       R   delimited-[]   subscript  T  h      R[T_{h}]   . It leads to difference algebras.    Difference operator generalizes to Möbius inversion over a partially ordered set .    As a convolution operator: Via the formalism of incidence algebras , difference operators and other Möbius inversion can be represented by convolution with a function on the poset, called the Möbius function μ; for the difference operator, μ is the sequence (1, −1, 0, 0, 0, ...).   Finite difference in several variables  Finite differences can be considered in more than one variable. They are analogous to partial derivatives in several variables.  Some partial derivative approximations are (using central step method):        f  x    (  x  ,  y  )    ≈     f   (   x  +  h   ,  y  )    -   f   (   x  -  h   ,  y  )      2  h           subscript  f  x    x  y          f     x  h   y      f     x  h   y       2  h      f_{x}(x,y)\approx\frac{f(x+h,y)-f(x-h,y)}{2h}           f  y    (  x  ,  y  )    ≈     f   (  x  ,   y  +  k   )    -   f   (  x  ,   y  -  k   )      2  k           subscript  f  y    x  y          f   x    y  k       f   x    y  k        2  k      f_{y}(x,y)\approx\frac{f(x,y+k)-f(x,y-k)}{2k}           f   x  x     (  x  ,  y  )    ≈      f   (   x  +  h   ,  y  )    -   2  f   (  x  ,  y  )     +   f   (   x  -  h   ,  y  )      h  2           subscript  f    x  x     x  y            f     x  h   y      2  f   x  y       f     x  h   y      superscript  h  2      f_{xx}(x,y)\approx\frac{f(x+h,y)-2f(x,y)+f(x-h,y)}{h^{2}}           f   y  y     (  x  ,  y  )    ≈      f   (  x  ,   y  +  k   )    -   2  f   (  x  ,  y  )     +   f   (  x  ,   y  -  k   )      k  2           subscript  f    y  y     x  y            f   x    y  k       2  f   x  y       f   x    y  k       superscript  k  2      f_{yy}(x,y)\approx\frac{f(x,y+k)-2f(x,y)+f(x,y-k)}{k^{2}}            f   x  y     (  x  ,  y  )    ≈       f   (   x  +  h   ,   y  +  k   )    -   f   (   x  +  h   ,   y  -  k   )    -   f   (   x  -  h   ,   y  +  k   )     +   f   (   x  -  h   ,   y  -  k   )      4  h  k      .         subscript  f    x  y     x  y            f     x  h     y  k       f     x  h     y  k       f     x  h     y  k        f     x  h     y  k        4  h  k      f_{xy}(x,y)\approx\frac{f(x+h,y+k)-f(x+h,y-k)-f(x-h,y+k)+f(x-h,y-k)}{4hk}~{}.     Alternatively, for applications in which the computation of   f   f   f   is the most costly step, and both first and second derivatives must be computed, a more efficient formula for the last case is         f   x  y     (  x  ,  y  )    ≈         f   (   x  +  h   ,   y  +  k   )    -   f   (   x  +  h   ,  y  )    -   f   (  x  ,   y  +  k   )     +   2  f   (  x  ,  y  )     -   f   (   x  -  h   ,  y  )    -   f   (  x  ,   y  -  k   )     +   f   (   x  -  h   ,   y  -  k   )      2  h  k      ,         subscript  f    x  y     x  y                f     x  h     y  k       f     x  h   y      f   x    y  k        2  f   x  y       f     x  h   y      f   x    y  k        f     x  h     y  k        2  h  k      f_{xy}(x,y)\approx\frac{f(x+h,y+k)-f(x+h,y)-f(x,y+k)+2f(x,y)-f(x-h,y)-f(x,y-k)%
 +f(x-h,y-k)}{2hk}~{},     since the only values to compute that are not already needed for the previous four equations are    f   (   x  +  h   ,   y  +  k   )       f     x  h     y  k      f(x+h,y+k)   and    f   (   x  −  h   ,   y  −  k   )       f     x  normal-−  h     y  normal-−  k      f(x−h,y−k)   .  See also  References     Richardson, C. H. (1954): An Introduction to the Calculus of Finite Differences (Van Nostrand (1954)'' online copy  Mickens, R. E. (1991): Difference Equations: Theory and Applications (Chapman and Hall/CRC) ISBN 978-0442001360   External links    Table of useful finite difference formula generated using Mathematica  D. Gleich (2005), Finite Calculus: A Tutorial for Solving Nasty Sums  Discrete Second Derivative from Unevenly Spaced Points   de:Finite-Differenzen-Methode  fr:Différences finies  ja:差分 "    Category:Numerical differential equations  Category:Mathematical analysis  Category:Factorial and binomial topics  Category:Linear operators in calculus     ↩  ↩  ↩  Jordán, op. cit., p. 1 and Milne-Thomson, p. xxi. Milne-Thomson, Louis Melville (2000): The Calculus of Finite Differences (Chelsea Pub Co, 2000) ISBN 978-0821821077 ↩        Newton, Isaac, (1687). [ http://books.google.com/books?id=KaAIAAAAIAAJ&dq; ;=sir%20isaac%20newton%20principia%20mathematica&as;_brr=1&pg;=PA466#v=onepage&q;&f;=false Principia , Book III, Lemma V, Case 1] ↩  Richtmeyer, D. and Morton, K.W., (1967). Difference Methods for Initial Value Problems , 2nd ed., Wiley, New York. ↩  Boole, George , (1872). A Treatise On The Calculus of Finite Differences , 2nd ed., Macmillan and Company. On line . Also, [Dover edition 1960] ↩  Jordan, Charles, (1939/1965). "Calculus of Finite Differences", Chelsea Publishing. On-line: [ http://books.google.com/books?hl=en&lr; ;=&id;=3RfZOsDAyQsC&oi;=fnd&pg;=PA1&ots;=AqSuAgOKs3&sig;=fzPpAdvnzp7sG6PorqIe5qFjD2Q#v=onepage] ↩  ↩  ↩  ↩  Ames, W. F., (1977). Numerical Methods for Partial Differential Equations , Section 1.6. Academic Press, New York. ISBN 0-12-056760-1. ↩  Hildebrand, F. B. , (1968). Finite-Difference Equations and Simulations , Section 2.2, Prentice-Hall, Englewood Cliffs, New Jersey. ↩  . ↩     
<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="1772">Dmrg of Heisenberg model</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Dmrg of Heisenberg model</h1>
<hr/>

<p>This example presents the <em>infinite <a href="density_matrix_renormalization_group" title="wikilink">DMRG</a> algorithm</em>. It is about 

<math display="inline" id="Dmrg_of_Heisenberg_model:0">
 <semantics>
  <mrow>
   <mi>S</mi>
   <mo>=</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>S</ci>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   S=1
  </annotation>
 </semantics>
</math>

 antiferromagnetic <a href="heisenberg_model_(quantum)" title="wikilink">Heisenberg chain</a>, but the recipe can be applied for every translationally invariant one-dimensional <a href="lattice_(group)" title="wikilink">lattice</a>. <em>DMRG</em> is a <a href="renormalization_group" title="wikilink">renormalization-group</a> technique because it offers an efficient truncation of the <a href="Hilbert_space" title="wikilink">Hilbert space</a> of one-dimensional <a href="quantum_mechanics" title="wikilink">quantum systems</a>.</p>
<h2 id="the-algorithm">The algorithm</h2>
<h3 id="the-starting-point">The Starting Point</h3>

<p>To simulate an infinite chain, starting with four sites. The first is the <em>Block site</em>, the last the <em>Universe-Block site</em> and the remaining are the <em>added sites</em>, the right one is "added" to the Universe-Block site and the other to the Block site.</p>

<p>The Hilbert space for the single site is 

<math display="inline" id="Dmrg_of_Heisenberg_model:1">
 <semantics>
  <mi>ℌ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>ℌ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathfrak{H}
  </annotation>
 </semantics>
</math>

 with the base 

<math display="inline" id="Dmrg_of_Heisenberg_model:2">
 <semantics>
  <mrow>
   <mrow>
    <mo stretchy="false">{</mo>
    <mrow>
     <mo fence="true" stretchy="false">|</mo>
     <mrow>
      <mi>S</mi>
      <mo>,</mo>
      <msub>
       <mi>S</mi>
       <mi>z</mi>
      </msub>
     </mrow>
     <mo stretchy="false">⟩</mo>
    </mrow>
    <mo stretchy="false">}</mo>
   </mrow>
   <mo>≡</mo>
   <mrow>
    <mo stretchy="false">{</mo>
    <mrow>
     <mo fence="true" stretchy="false">|</mo>
     <mrow>
      <mn>1</mn>
      <mo>,</mo>
      <mn>1</mn>
     </mrow>
     <mo stretchy="false">⟩</mo>
    </mrow>
    <mo>,</mo>
    <mrow>
     <mo fence="true" stretchy="false">|</mo>
     <mrow>
      <mn>1</mn>
      <mo>,</mo>
      <mn>0</mn>
     </mrow>
     <mo stretchy="false">⟩</mo>
    </mrow>
    <mo>,</mo>
    <mrow>
     <mo fence="true" stretchy="false">|</mo>
     <mrow>
      <mn>1</mn>
      <mo>,</mo>
      <mrow>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
     </mrow>
     <mo stretchy="false">⟩</mo>
    </mrow>
    <mo stretchy="false">}</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <equivalent></equivalent>
    <set>
     <apply>
      <csymbol cd="latexml">ket</csymbol>
      <list>
       <ci>S</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>S</ci>
        <ci>z</ci>
       </apply>
      </list>
     </apply>
    </set>
    <set>
     <apply>
      <csymbol cd="latexml">ket</csymbol>
      <list>
       <cn type="integer">1</cn>
       <cn type="integer">1</cn>
      </list>
     </apply>
     <apply>
      <csymbol cd="latexml">ket</csymbol>
      <list>
       <cn type="integer">1</cn>
       <cn type="integer">0</cn>
      </list>
     </apply>
     <apply>
      <csymbol cd="latexml">ket</csymbol>
      <list>
       <cn type="integer">1</cn>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
       </apply>
      </list>
     </apply>
    </set>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \{|S,S_{z}\rangle\}\equiv\{|1,1\rangle,|1,0\rangle,|1,-1\rangle\}
  </annotation>
 </semantics>
</math>

. With this base the <a href="spin_(physics)" title="wikilink">spin</a> operators are 

<math display="inline" id="Dmrg_of_Heisenberg_model:3">
 <semantics>
  <msub>
   <mi>S</mi>
   <mi>x</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>S</ci>
    <ci>x</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   S_{x}
  </annotation>
 </semantics>
</math>

, 

<math display="inline" id="Dmrg_of_Heisenberg_model:4">
 <semantics>
  <msub>
   <mi>S</mi>
   <mi>y</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>S</ci>
    <ci>y</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   S_{y}
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Dmrg_of_Heisenberg_model:5">
 <semantics>
  <msub>
   <mi>S</mi>
   <mi>z</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>S</ci>
    <ci>z</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   S_{z}
  </annotation>
 </semantics>
</math>

 for the single site. For every "block", the two blocks and the two sites, there is its own Hilbert space 

<math display="inline" id="Dmrg_of_Heisenberg_model:6">
 <semantics>
  <msub>
   <mi>ℌ</mi>
   <mi>b</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>ℌ</ci>
    <ci>b</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathfrak{H}_{b}
  </annotation>
 </semantics>
</math>

, its base 

<math display="inline" id="Dmrg_of_Heisenberg_model:7">
 <semantics>
  <mrow>
   <mo stretchy="false">{</mo>
   <mrow>
    <mo fence="true" stretchy="false">|</mo>
    <msub>
     <mi>w</mi>
     <mi>i</mi>
    </msub>
    <mo stretchy="false">⟩</mo>
   </mrow>
   <mo stretchy="false">}</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <set>
    <apply>
     <csymbol cd="latexml">ket</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>w</ci>
      <ci>i</ci>
     </apply>
    </apply>
   </set>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \{|w_{i}\rangle\}
  </annotation>
 </semantics>
</math>

 (

<math display="inline" id="Dmrg_of_Heisenberg_model:8">
 <semantics>
  <mrow>
   <mi>i</mi>
   <mo>:</mo>
   <mrow>
    <mn>1</mn>
    <mi mathvariant="normal">…</mi>
    <mrow>
     <mo>dim</mo>
     <mrow>
      <mo stretchy="false">(</mo>
      <msub>
       <mi>ℌ</mi>
       <mi>b</mi>
      </msub>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-:</ci>
    <ci>i</ci>
    <apply>
     <times></times>
     <cn type="integer">1</cn>
     <ci>normal-…</ci>
     <apply>
      <csymbol cd="latexml">dimension</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>ℌ</ci>
       <ci>b</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   i:1\dots\dim(\mathfrak{H}_{b})
  </annotation>
 </semantics>
</math>

)and its own operators 

<math display="inline" id="Dmrg_of_Heisenberg_model:9">
 <semantics>
  <mrow>
   <msub>
    <mi>O</mi>
    <mi>b</mi>
   </msub>
   <mo>:</mo>
   <mrow>
    <msub>
     <mi>ℌ</mi>
     <mi>b</mi>
    </msub>
    <mo>→</mo>
    <msub>
     <mi>ℌ</mi>
     <mi>b</mi>
    </msub>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-:</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>O</ci>
     <ci>b</ci>
    </apply>
    <apply>
     <ci>normal-→</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>ℌ</ci>
      <ci>b</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>ℌ</ci>
      <ci>b</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   O_{b}:\mathfrak{H}_{b}\rightarrow\mathfrak{H}_{b}
  </annotation>
 </semantics>
</math>

:</p>
<ul>
<li>Block

<math display="block" id="Dmrg_of_Heisenberg_model:10">
 <semantics>
  <msub>
   <mi>ℌ</mi>
   <mi>B</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>ℌ</ci>
    <ci>B</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathfrak{H}_{B}
  </annotation>
 </semantics>
</math>

, 

<math display="inline" id="Dmrg_of_Heisenberg_model:11">
 <semantics>
  <mrow>
   <mo stretchy="false">{</mo>
   <mrow>
    <mo fence="true" stretchy="false">|</mo>
    <msub>
     <mi>u</mi>
     <mi>i</mi>
    </msub>
    <mo stretchy="false">⟩</mo>
   </mrow>
   <mo stretchy="false">}</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <set>
    <apply>
     <csymbol cd="latexml">ket</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>u</ci>
      <ci>i</ci>
     </apply>
    </apply>
   </set>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \{|u_{i}\rangle\}
  </annotation>
 </semantics>
</math>

, 

<math display="inline" id="Dmrg_of_Heisenberg_model:12">
 <semantics>
  <msub>
   <mi>H</mi>
   <mi>B</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>H</ci>
    <ci>B</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   H_{B}
  </annotation>
 </semantics>
</math>

, 

<math display="inline" id="Dmrg_of_Heisenberg_model:13">
 <semantics>
  <msub>
   <mi>S</mi>
   <msub>
    <mi>x</mi>
    <mi>B</mi>
   </msub>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>S</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>x</ci>
     <ci>B</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   S_{x_{B}}
  </annotation>
 </semantics>
</math>

, 

<math display="inline" id="Dmrg_of_Heisenberg_model:14">
 <semantics>
  <msub>
   <mi>S</mi>
   <msub>
    <mi>y</mi>
    <mi>B</mi>
   </msub>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>S</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>y</ci>
     <ci>B</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   S_{y_{B}}
  </annotation>
 </semantics>
</math>

, 

<math display="inline" id="Dmrg_of_Heisenberg_model:15">
 <semantics>
  <msub>
   <mi>S</mi>
   <msub>
    <mi>z</mi>
    <mi>B</mi>
   </msub>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>S</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>z</ci>
     <ci>B</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   S_{z_{B}}
  </annotation>
 </semantics>
</math>

</li>
<li>left-site

<math display="block" id="Dmrg_of_Heisenberg_model:16">
 <semantics>
  <msub>
   <mi>ℌ</mi>
   <mi>l</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>ℌ</ci>
    <ci>l</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathfrak{H}_{l}
  </annotation>
 </semantics>
</math>

, 

<math display="inline" id="Dmrg_of_Heisenberg_model:17">
 <semantics>
  <mrow>
   <mo stretchy="false">{</mo>
   <mrow>
    <mo fence="true" stretchy="false">|</mo>
    <msub>
     <mi>t</mi>
     <mi>i</mi>
    </msub>
    <mo stretchy="false">⟩</mo>
   </mrow>
   <mo stretchy="false">}</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <set>
    <apply>
     <csymbol cd="latexml">ket</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>t</ci>
      <ci>i</ci>
     </apply>
    </apply>
   </set>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \{|t_{i}\rangle\}
  </annotation>
 </semantics>
</math>

, 

<math display="inline" id="Dmrg_of_Heisenberg_model:18">
 <semantics>
  <msub>
   <mi>S</mi>
   <msub>
    <mi>x</mi>
    <mi>l</mi>
   </msub>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>S</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>x</ci>
     <ci>l</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   S_{x_{l}}
  </annotation>
 </semantics>
</math>

, 

<math display="inline" id="Dmrg_of_Heisenberg_model:19">
 <semantics>
  <msub>
   <mi>S</mi>
   <msub>
    <mi>y</mi>
    <mi>l</mi>
   </msub>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>S</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>y</ci>
     <ci>l</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   S_{y_{l}}
  </annotation>
 </semantics>
</math>

, 

<math display="inline" id="Dmrg_of_Heisenberg_model:20">
 <semantics>
  <msub>
   <mi>S</mi>
   <msub>
    <mi>z</mi>
    <mi>l</mi>
   </msub>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>S</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>z</ci>
     <ci>l</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   S_{z_{l}}
  </annotation>
 </semantics>
</math>

</li>
<li>right-site

<math display="block" id="Dmrg_of_Heisenberg_model:21">
 <semantics>
  <msub>
   <mi>ℌ</mi>
   <mi>r</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>ℌ</ci>
    <ci>r</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathfrak{H}_{r}
  </annotation>
 </semantics>
</math>

, 

<math display="inline" id="Dmrg_of_Heisenberg_model:22">
 <semantics>
  <mrow>
   <mo stretchy="false">{</mo>
   <mrow>
    <mo fence="true" stretchy="false">|</mo>
    <msub>
     <mi>s</mi>
     <mi>i</mi>
    </msub>
    <mo stretchy="false">⟩</mo>
   </mrow>
   <mo stretchy="false">}</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <set>
    <apply>
     <csymbol cd="latexml">ket</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>s</ci>
      <ci>i</ci>
     </apply>
    </apply>
   </set>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \{|s_{i}\rangle\}
  </annotation>
 </semantics>
</math>

, 

<math display="inline" id="Dmrg_of_Heisenberg_model:23">
 <semantics>
  <msub>
   <mi>S</mi>
   <msub>
    <mi>x</mi>
    <mi>r</mi>
   </msub>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>S</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>x</ci>
     <ci>r</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   S_{x_{r}}
  </annotation>
 </semantics>
</math>

, 

<math display="inline" id="Dmrg_of_Heisenberg_model:24">
 <semantics>
  <msub>
   <mi>S</mi>
   <msub>
    <mi>y</mi>
    <mi>r</mi>
   </msub>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>S</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>y</ci>
     <ci>r</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   S_{y_{r}}
  </annotation>
 </semantics>
</math>

, 

<math display="inline" id="Dmrg_of_Heisenberg_model:25">
 <semantics>
  <msub>
   <mi>S</mi>
   <msub>
    <mi>z</mi>
    <mi>r</mi>
   </msub>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>S</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>z</ci>
     <ci>r</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   S_{z_{r}}
  </annotation>
 </semantics>
</math>

</li>
<li>Universe

<math display="block" id="Dmrg_of_Heisenberg_model:26">
 <semantics>
  <msub>
   <mi>ℌ</mi>
   <mi>U</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>ℌ</ci>
    <ci>U</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathfrak{H}_{U}
  </annotation>
 </semantics>
</math>

, 

<math display="inline" id="Dmrg_of_Heisenberg_model:27">
 <semantics>
  <mrow>
   <mo stretchy="false">{</mo>
   <mrow>
    <mo fence="true" stretchy="false">|</mo>
    <msub>
     <mi>r</mi>
     <mi>i</mi>
    </msub>
    <mo stretchy="false">⟩</mo>
   </mrow>
   <mo stretchy="false">}</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <set>
    <apply>
     <csymbol cd="latexml">ket</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>r</ci>
      <ci>i</ci>
     </apply>
    </apply>
   </set>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \{|r_{i}\rangle\}
  </annotation>
 </semantics>
</math>

, 

<math display="inline" id="Dmrg_of_Heisenberg_model:28">
 <semantics>
  <msub>
   <mi>H</mi>
   <mi>U</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>H</ci>
    <ci>U</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   H_{U}
  </annotation>
 </semantics>
</math>

, 

<math display="inline" id="Dmrg_of_Heisenberg_model:29">
 <semantics>
  <msub>
   <mi>S</mi>
   <msub>
    <mi>x</mi>
    <mi>U</mi>
   </msub>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>S</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>x</ci>
     <ci>U</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   S_{x_{U}}
  </annotation>
 </semantics>
</math>

, 

<math display="inline" id="Dmrg_of_Heisenberg_model:30">
 <semantics>
  <msub>
   <mi>S</mi>
   <msub>
    <mi>y</mi>
    <mi>U</mi>
   </msub>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>S</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>y</ci>
     <ci>U</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   S_{y_{U}}
  </annotation>
 </semantics>
</math>

, 

<math display="inline" id="Dmrg_of_Heisenberg_model:31">
 <semantics>
  <msub>
   <mi>S</mi>
   <msub>
    <mi>z</mi>
    <mi>U</mi>
   </msub>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>S</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>z</ci>
     <ci>U</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   S_{z_{U}}
  </annotation>
 </semantics>
</math>

</li>
</ul>

<p>At the starting point all four Hilbert spaces are equivalent to 

<math display="inline" id="Dmrg_of_Heisenberg_model:32">
 <semantics>
  <mi>ℌ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>ℌ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathfrak{H}
  </annotation>
 </semantics>
</math>

, all spin operators are equivalent to 

<math display="inline" id="Dmrg_of_Heisenberg_model:33">
 <semantics>
  <msub>
   <mi>S</mi>
   <mi>x</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>S</ci>
    <ci>x</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   S_{x}
  </annotation>
 </semantics>
</math>

, 

<math display="inline" id="Dmrg_of_Heisenberg_model:34">
 <semantics>
  <msub>
   <mi>S</mi>
   <mi>y</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>S</ci>
    <ci>y</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   S_{y}
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Dmrg_of_Heisenberg_model:35">
 <semantics>
  <msub>
   <mi>S</mi>
   <mi>z</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>S</ci>
    <ci>z</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   S_{z}
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Dmrg_of_Heisenberg_model:36">
 <semantics>
  <mrow>
   <msub>
    <mi>H</mi>
    <mi>B</mi>
   </msub>
   <mo>=</mo>
   <msub>
    <mi>H</mi>
    <mi>U</mi>
   </msub>
   <mo>=</mo>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>H</ci>
      <ci>B</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>H</ci>
      <ci>U</ci>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <cn type="integer">0</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   H_{B}=H_{U}=0
  </annotation>
 </semantics>
</math>

. This is always (at every iterations) true only for left and right sites.</p>
<h3 id="step-1-form-the-hamiltonian-matrix-for-the-superblock">Step 1: Form the Hamiltonian matrix for the Superblock</h3>

<p>The ingredients are the four Block operators and the four Universe-Block operators, which at the first iteration are 

<math display="inline" id="Dmrg_of_Heisenberg_model:37">
 <semantics>
  <mrow>
   <mn>3</mn>
   <mo>×</mo>
   <mn>3</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <cn type="integer">3</cn>
    <cn type="integer">3</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   3\times 3
  </annotation>
 </semantics>
</math>

 <a href="matrix_(mathematics)" title="wikilink">matrices</a>, the three left-site spin operators and the three right-site spin operators, which are always 

<math display="inline" id="Dmrg_of_Heisenberg_model:38">
 <semantics>
  <mrow>
   <mn>3</mn>
   <mo>×</mo>
   <mn>3</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <cn type="integer">3</cn>
    <cn type="integer">3</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   3\times 3
  </annotation>
 </semantics>
</math>

 matrices. The <a href="hamiltonian_system" title="wikilink">Hamiltonian</a> matrix of the <em>superblock</em> (the chain), which at the first iteration has only four sites, is formed by these operators. In the Heisenberg antiferromagnetic S=1 model the Hamiltonian is:</p>

<p>

<math display="block" id="Dmrg_of_Heisenberg_model:39">
 <semantics>
  <mrow>
   <msub>
    <mi>ℌ</mi>
    <mrow>
     <mi>S</mi>
     <mi>B</mi>
    </mrow>
   </msub>
   <mo>=</mo>
   <mrow>
    <msub>
     <mi>ℌ</mi>
     <mi>B</mi>
    </msub>
    <mo>⊗</mo>
    <msub>
     <mi>ℌ</mi>
     <mi>l</mi>
    </msub>
    <mo>⊗</mo>
    <msub>
     <mi>ℌ</mi>
     <mi>r</mi>
    </msub>
    <mo>⊗</mo>
    <msub>
     <mi>ℌ</mi>
     <mi>U</mi>
    </msub>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>ℌ</ci>
     <apply>
      <times></times>
      <ci>S</ci>
      <ci>B</ci>
     </apply>
    </apply>
    <apply>
     <csymbol cd="latexml">tensor-product</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>ℌ</ci>
      <ci>B</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>ℌ</ci>
      <ci>l</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>ℌ</ci>
      <ci>r</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>ℌ</ci>
      <ci>U</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathfrak{H}_{SB}=\mathfrak{H}_{B}\otimes\mathfrak{H}_{l}\otimes\mathfrak{H}_{%
r}\otimes\mathfrak{H}_{U}
  </annotation>
 </semantics>
</math>

</p>

<p>These operators live in the superblock state space

<math display="inline" id="Dmrg_of_Heisenberg_model:40">
 <semantics>
  <mrow>
   <mo stretchy="false">{</mo>
   <mrow>
    <mrow>
     <mo fence="true" stretchy="false">|</mo>
     <mi>f</mi>
     <mo stretchy="false">⟩</mo>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mo fence="true" stretchy="false">|</mo>
      <mi>u</mi>
      <mo stretchy="false">⟩</mo>
     </mrow>
     <mo>⊗</mo>
     <mrow>
      <mo fence="true" stretchy="false">|</mo>
      <mi>t</mi>
      <mo stretchy="false">⟩</mo>
     </mrow>
     <mo>⊗</mo>
     <mrow>
      <mo fence="true" stretchy="false">|</mo>
      <mi>s</mi>
      <mo stretchy="false">⟩</mo>
     </mrow>
     <mo>⊗</mo>
     <mrow>
      <mo fence="true" stretchy="false">|</mo>
      <mi>r</mi>
      <mo stretchy="false">⟩</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo stretchy="false">}</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <set>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="latexml">ket</csymbol>
      <ci>f</ci>
     </apply>
     <apply>
      <csymbol cd="latexml">tensor-product</csymbol>
      <apply>
       <csymbol cd="latexml">ket</csymbol>
       <ci>u</ci>
      </apply>
      <apply>
       <csymbol cd="latexml">ket</csymbol>
       <ci>t</ci>
      </apply>
      <apply>
       <csymbol cd="latexml">ket</csymbol>
       <ci>s</ci>
      </apply>
      <apply>
       <csymbol cd="latexml">ket</csymbol>
       <ci>r</ci>
      </apply>
     </apply>
    </apply>
   </set>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \{|f\rangle=|u\rangle\otimes|t\rangle\otimes|s\rangle\otimes|r\rangle\}
  </annotation>
 </semantics>
</math>

, the base is 

<math display="inline" id="Dmrg_of_Heisenberg_model:41">
 <semantics>
  <mrow>
   <mrow>
    <mo fence="true" stretchy="false">|</mo>
    <mrow>
     <mn>1000</mn>
     <mi mathvariant="normal">…</mi>
     <mn>0</mn>
    </mrow>
    <mo stretchy="false">⟩</mo>
   </mrow>
   <mo>≡</mo>
   <mrow>
    <mo fence="true" stretchy="false">|</mo>
    <msub>
     <mi>f</mi>
     <mn>1</mn>
    </msub>
    <mo stretchy="false">⟩</mo>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mo fence="true" stretchy="false">|</mo>
    <mrow>
     <msub>
      <mi>u</mi>
      <mn>1</mn>
     </msub>
     <mo>,</mo>
     <msub>
      <mi>t</mi>
      <mn>1</mn>
     </msub>
     <mo>,</mo>
     <msub>
      <mi>s</mi>
      <mn>1</mn>
     </msub>
     <mo>,</mo>
     <msub>
      <mi>r</mi>
      <mn>1</mn>
     </msub>
    </mrow>
    <mo stretchy="false">⟩</mo>
   </mrow>
   <mo>≡</mo>
   <mrow>
    <mo fence="true" stretchy="false">|</mo>
    <mrow>
     <mn>100</mn>
     <mo>,</mo>
     <mn>100</mn>
     <mo>,</mo>
     <mn>100</mn>
     <mo>,</mo>
     <mn>100</mn>
    </mrow>
    <mo stretchy="false">⟩</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <equivalent></equivalent>
     <apply>
      <csymbol cd="latexml">ket</csymbol>
      <apply>
       <times></times>
       <cn type="integer">1000</cn>
       <ci>normal-…</ci>
       <cn type="integer">0</cn>
      </apply>
     </apply>
     <apply>
      <csymbol cd="latexml">ket</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>f</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <csymbol cd="latexml">ket</csymbol>
      <list>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>u</ci>
        <cn type="integer">1</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>t</ci>
        <cn type="integer">1</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>s</ci>
        <cn type="integer">1</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>r</ci>
        <cn type="integer">1</cn>
       </apply>
      </list>
     </apply>
    </apply>
    <apply>
     <equivalent></equivalent>
     <share href="#.cmml">
     </share>
     <apply>
      <csymbol cd="latexml">ket</csymbol>
      <list>
       <cn type="integer">100</cn>
       <cn type="integer">100</cn>
       <cn type="integer">100</cn>
       <cn type="integer">100</cn>
      </list>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   |1000\dots 0\rangle\equiv|f_{1}\rangle=|u_{1},t_{1},s_{1},r_{1}\rangle\equiv|1%
00,100,100,100\rangle
  </annotation>
 </semantics>
</math>

. For example: (convention):</p>

<p>

<math display="inline" id="Dmrg_of_Heisenberg_model:42">
 <semantics>
  <mrow>
   <mrow>
    <mo fence="true" stretchy="false">|</mo>
    <mrow>
     <mn>0100</mn>
     <mi mathvariant="normal">…</mi>
     <mn>0</mn>
    </mrow>
    <mo stretchy="false">⟩</mo>
   </mrow>
   <mo>≡</mo>
   <mrow>
    <mo fence="true" stretchy="false">|</mo>
    <msub>
     <mi>f</mi>
     <mn>2</mn>
    </msub>
    <mo stretchy="false">⟩</mo>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mo fence="true" stretchy="false">|</mo>
    <mrow>
     <msub>
      <mi>u</mi>
      <mn>1</mn>
     </msub>
     <mo>,</mo>
     <msub>
      <mi>t</mi>
      <mn>1</mn>
     </msub>
     <mo>,</mo>
     <msub>
      <mi>s</mi>
      <mn>1</mn>
     </msub>
     <mo>,</mo>
     <msub>
      <mi>r</mi>
      <mn>2</mn>
     </msub>
    </mrow>
    <mo stretchy="false">⟩</mo>
   </mrow>
   <mo>≡</mo>
   <mrow>
    <mo fence="true" stretchy="false">|</mo>
    <mrow>
     <mn>100</mn>
     <mo>,</mo>
     <mn>100</mn>
     <mo>,</mo>
     <mn>100</mn>
     <mo>,</mo>
     <mn>010</mn>
    </mrow>
    <mo stretchy="false">⟩</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <equivalent></equivalent>
     <apply>
      <csymbol cd="latexml">ket</csymbol>
      <apply>
       <times></times>
       <cn type="integer">0100</cn>
       <ci>normal-…</ci>
       <cn type="integer">0</cn>
      </apply>
     </apply>
     <apply>
      <csymbol cd="latexml">ket</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>f</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <csymbol cd="latexml">ket</csymbol>
      <list>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>u</ci>
        <cn type="integer">1</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>t</ci>
        <cn type="integer">1</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>s</ci>
        <cn type="integer">1</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>r</ci>
        <cn type="integer">2</cn>
       </apply>
      </list>
     </apply>
    </apply>
    <apply>
     <equivalent></equivalent>
     <share href="#.cmml">
     </share>
     <apply>
      <csymbol cd="latexml">ket</csymbol>
      <list>
       <cn type="integer">100</cn>
       <cn type="integer">100</cn>
       <cn type="integer">100</cn>
       <cn type="integer">010</cn>
      </list>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   |0100\dots 0\rangle\equiv|f_{2}\rangle=|u_{1},t_{1},s_{1},r_{2}\rangle\equiv|1%
00,100,100,010\rangle
  </annotation>
 </semantics>
</math>

 

<math display="inline" id="Dmrg_of_Heisenberg_model:43">
 <semantics>
  <mrow>
   <mi>J</mi>
   <mo>=</mo>
   <mrow>
    <mo>-</mo>
    <mn>1</mn>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>J</ci>
    <apply>
     <minus></minus>
     <cn type="integer">1</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   J=-1
  </annotation>
 </semantics>
</math>

</p>

<p>The Hamiltonian in the <em>DMRG form</em> is (we set 

<math display="inline" id="Dmrg_of_Heisenberg_model:44">
 <semantics>
  <mrow>
   <mrow>
    <mo stretchy="false">(</mo>
    <mrow>
     <mi>d</mi>
     <mo>*</mo>
     <mn>3</mn>
     <mo>*</mo>
     <mn>3</mn>
     <mo>*</mo>
     <mi>d</mi>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>×</mo>
   <mrow>
    <mo stretchy="false">(</mo>
    <mrow>
     <mi>d</mi>
     <mo>*</mo>
     <mn>3</mn>
     <mo>*</mo>
     <mn>3</mn>
     <mo>*</mo>
     <mi>d</mi>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <times></times>
     <ci>d</ci>
     <cn type="integer">3</cn>
     <cn type="integer">3</cn>
     <ci>d</ci>
    </apply>
    <apply>
     <times></times>
     <ci>d</ci>
     <cn type="integer">3</cn>
     <cn type="integer">3</cn>
     <ci>d</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (d*3*3*d)\times(d*3*3*d)
  </annotation>
 </semantics>
</math>

):</p>

<p>

<math display="inline" id="Dmrg_of_Heisenberg_model:45">
 <semantics>
  <mrow>
   <mi>d</mi>
   <mo>=</mo>
   <mrow>
    <mo>dim</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <msub>
      <mi>ℌ</mi>
      <mi>B</mi>
     </msub>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>≡</mo>
   <mrow>
    <mo>dim</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <msub>
      <mi>ℌ</mi>
      <mi>U</mi>
     </msub>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <ci>d</ci>
     <apply>
      <csymbol cd="latexml">dimension</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>ℌ</ci>
       <ci>B</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <equivalent></equivalent>
     <share href="#.cmml">
     </share>
     <apply>
      <csymbol cd="latexml">dimension</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>ℌ</ci>
       <ci>U</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   d=\dim(\mathfrak{H}_{B})\equiv\dim(\mathfrak{H}_{U})
  </annotation>
 </semantics>
</math>

</p>

<p>The operators are 

<math display="inline" id="Dmrg_of_Heisenberg_model:46">
 <semantics>
  <mrow>
   <mrow>
    <mo stretchy="false">⟨</mo>
    <mi>f</mi>
    <mo fence="true" stretchy="false">|</mo>
    <msub>
     <mi>𝐇</mi>
     <mi>B</mi>
    </msub>
    <mo fence="true" stretchy="false">|</mo>
    <msup>
     <mi>f</mi>
     <mo>′</mo>
    </msup>
    <mo stretchy="false">⟩</mo>
   </mrow>
   <mo>≡</mo>
   <mrow>
    <mo stretchy="false">⟨</mo>
    <mrow>
     <mi>u</mi>
     <mo>,</mo>
     <mi>t</mi>
     <mo>,</mo>
     <mi>s</mi>
     <mo>,</mo>
     <mi>r</mi>
    </mrow>
    <mo fence="true" stretchy="false">|</mo>
    <mrow>
     <msub>
      <mi>H</mi>
      <mi>B</mi>
     </msub>
     <mo>⊗</mo>
     <mi>𝕀</mi>
     <mo>⊗</mo>
     <mi>𝕀</mi>
     <mo>⊗</mo>
     <mi>𝕀</mi>
    </mrow>
    <mo fence="true" stretchy="false">|</mo>
    <mrow>
     <msup>
      <mi>u</mi>
      <mo>′</mo>
     </msup>
     <mo>,</mo>
     <msup>
      <mi>t</mi>
      <mo>′</mo>
     </msup>
     <mo>,</mo>
     <msup>
      <mi>s</mi>
      <mo>′</mo>
     </msup>
     <mo>,</mo>
     <msup>
      <mi>r</mi>
      <mo>′</mo>
     </msup>
    </mrow>
    <mo stretchy="false">⟩</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <equivalent></equivalent>
    <apply>
     <csymbol cd="latexml">quantum-operator-product</csymbol>
     <ci>f</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>𝐇</ci>
      <ci>B</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>f</ci>
      <ci>normal-′</ci>
     </apply>
    </apply>
    <apply>
     <csymbol cd="latexml">quantum-operator-product</csymbol>
     <list>
      <ci>u</ci>
      <ci>t</ci>
      <ci>s</ci>
      <ci>r</ci>
     </list>
     <apply>
      <csymbol cd="latexml">tensor-product</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>H</ci>
       <ci>B</ci>
      </apply>
      <ci>𝕀</ci>
      <ci>𝕀</ci>
      <ci>𝕀</ci>
     </apply>
     <list>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>u</ci>
       <ci>normal-′</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>t</ci>
       <ci>normal-′</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>s</ci>
       <ci>normal-′</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>r</ci>
       <ci>normal-′</ci>
      </apply>
     </list>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \langle f|\mathbf{H}_{B}|f^{\prime}\rangle\equiv\langle u,t,s,r|H_{B}\otimes%
\mathbb{I}\otimes\mathbb{I}\otimes\mathbb{I}|u^{\prime},t^{\prime},s^{\prime},%
r^{\prime}\rangle
  </annotation>
 </semantics>
</math>

 matrices, 

<math display="inline" id="Dmrg_of_Heisenberg_model:47">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>𝐒</mi>
     <msub>
      <mi>x</mi>
      <mi>B</mi>
     </msub>
    </msub>
    <msub>
     <mi>𝐒</mi>
     <msub>
      <mi>x</mi>
      <mi>l</mi>
     </msub>
    </msub>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mrow>
      <mrow>
       <mrow>
        <mrow>
         <mrow>
          <msub>
           <mi>S</mi>
           <msub>
            <mi>x</mi>
            <mi>B</mi>
           </msub>
          </msub>
          <mi>𝕀</mi>
         </mrow>
         <mo>⊗</mo>
         <mi>𝕀</mi>
        </mrow>
        <msub>
         <mi>S</mi>
         <msub>
          <mi>x</mi>
          <mi>l</mi>
         </msub>
        </msub>
       </mrow>
       <mo>⊗</mo>
       <mi>𝕀</mi>
      </mrow>
      <mi>𝕀</mi>
     </mrow>
     <mo>⊗</mo>
     <mi>𝕀</mi>
    </mrow>
    <mi>𝕀</mi>
   </mrow>
   <mo>=</mo>
   <mrow>
    <msub>
     <mi>S</mi>
     <msub>
      <mi>x</mi>
      <mi>B</mi>
     </msub>
    </msub>
    <mo>⊗</mo>
    <msub>
     <mi>S</mi>
     <msub>
      <mi>x</mi>
      <mi>l</mi>
     </msub>
    </msub>
    <mo>⊗</mo>
    <mi>𝕀</mi>
    <mo>⊗</mo>
    <mi>𝕀</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>𝐒</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <ci>B</ci>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>𝐒</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <ci>l</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="latexml">tensor-product</csymbol>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="latexml">tensor-product</csymbol>
         <apply>
          <times></times>
          <apply>
           <csymbol cd="latexml">tensor-product</csymbol>
           <apply>
            <times></times>
            <apply>
             <csymbol cd="ambiguous">subscript</csymbol>
             <ci>S</ci>
             <apply>
              <csymbol cd="ambiguous">subscript</csymbol>
              <ci>x</ci>
              <ci>B</ci>
             </apply>
            </apply>
            <ci>𝕀</ci>
           </apply>
           <ci>𝕀</ci>
          </apply>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>S</ci>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <ci>x</ci>
            <ci>l</ci>
           </apply>
          </apply>
         </apply>
         <ci>𝕀</ci>
        </apply>
        <ci>𝕀</ci>
       </apply>
       <ci>𝕀</ci>
      </apply>
      <ci>𝕀</ci>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <csymbol cd="latexml">tensor-product</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>S</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <ci>B</ci>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>S</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <ci>l</ci>
       </apply>
      </apply>
      <ci>𝕀</ci>
      <ci>𝕀</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{S}_{x_{B}}\mathbf{S}_{x_{l}}=S_{x_{B}}\mathbb{I}\otimes\mathbb{I}S_{x_%
{l}}\otimes\mathbb{I}\mathbb{I}\otimes\mathbb{I}\mathbb{I}=S_{x_{B}}\otimes S_%
{x_{l}}\otimes\mathbb{I}\otimes\mathbb{I}
  </annotation>
 </semantics>
</math>

, for example:</p>

<p>

<math display="inline" id="Dmrg_of_Heisenberg_model:48">
 <semantics>
  <mrow>
   <mrow>
    <mo fence="true" stretchy="false">|</mo>
    <mi mathvariant="normal">Ψ</mi>
    <mo stretchy="false">⟩</mo>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mo largeop="true" symmetric="true">∑</mo>
    <mrow>
     <msub>
      <mi mathvariant="normal">Ψ</mi>
      <mrow>
       <mi>i</mi>
       <mo>,</mo>
       <mi>j</mi>
       <mo>,</mo>
       <mi>k</mi>
       <mo>,</mo>
       <mi>w</mi>
      </mrow>
     </msub>
     <mrow>
      <mo fence="true" stretchy="false">|</mo>
      <mrow>
       <msub>
        <mi>u</mi>
        <mi>i</mi>
       </msub>
       <mo>,</mo>
       <msub>
        <mi>t</mi>
        <mi>j</mi>
       </msub>
       <mo>,</mo>
       <msub>
        <mi>s</mi>
        <mi>k</mi>
       </msub>
       <mo>,</mo>
       <msub>
        <mi>r</mi>
        <mi>w</mi>
       </msub>
      </mrow>
      <mo stretchy="false">⟩</mo>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="latexml">ket</csymbol>
     <ci>normal-Ψ</ci>
    </apply>
    <apply>
     <sum></sum>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>normal-Ψ</ci>
       <list>
        <ci>i</ci>
        <ci>j</ci>
        <ci>k</ci>
        <ci>w</ci>
       </list>
      </apply>
      <apply>
       <csymbol cd="latexml">ket</csymbol>
       <list>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>u</ci>
         <ci>i</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>t</ci>
         <ci>j</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>s</ci>
         <ci>k</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>r</ci>
         <ci>w</ci>
        </apply>
       </list>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   |\Psi\rangle=\sum\Psi_{i,j,k,w}|u_{i},t_{j},s_{k},r_{w}\rangle
  </annotation>
 </semantics>
</math>

 

<math display="inline" id="Dmrg_of_Heisenberg_model:49">
 <semantics>
  <mrow>
   <mo fence="true" stretchy="false">|</mo>
   <mi mathvariant="normal">Ψ</mi>
   <mo stretchy="false">⟩</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">ket</csymbol>
    <ci>normal-Ψ</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   |\Psi\rangle
  </annotation>
 </semantics>
</math>

</p>
<h3 id="step-2-diagonalize-the-superblock-hamiltonian">Step 2: Diagonalize the superblock Hamiltonian</h3>

<p>At this point you must choose the <a href="Eigenvalue,_eigenvector_and_eigenspace" title="wikilink">eigenstate</a> of the Hamiltonian for which some <a href="observable" title="wikilink">observables</a> is calculated, this is the <em>target state</em> . At the beginning you can choose the <a href="stationary_state" title="wikilink">ground state</a> and use some advanced algorithm to find it, one of these is described in:</p>
<ul>
<li><em>The Iterative Calculation of a Few of the Lowest Eigenvalues and Corresponding <a href="Eigenvalue,_eigenvector_and_eigenspace" title="wikilink">Eigenvectors</a> of Large Real-<a href="symmetric_matrix" title="wikilink">Symmetric Matrices</a></em>, <a href="Ernest_R._Davidson" title="wikilink">Ernest R. Davidson</a>; Journal of Computational Physics 17, 87-94 (1975)</li>
</ul>

<p>This step is the most time-consuming part of the algorithm.</p>

<p>If 

<math display="inline" id="Dmrg_of_Heisenberg_model:50">
 <semantics>
  <mi>ρ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>ρ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \rho
  </annotation>
 </semantics>
</math>

 is the target state, <a href="Expected_value" title="wikilink">expectation value</a> of various operators can be measured at this point using 

<math display="inline" id="Dmrg_of_Heisenberg_model:51">
 <semantics>
  <mrow>
   <mrow>
    <mo stretchy="false">(</mo>
    <mrow>
     <mi>d</mi>
     <mo>*</mo>
     <mn>3</mn>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>×</mo>
   <mrow>
    <mo stretchy="false">(</mo>
    <mrow>
     <mi>d</mi>
     <mo>*</mo>
     <mn>3</mn>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <times></times>
     <ci>d</ci>
     <cn type="integer">3</cn>
    </apply>
    <apply>
     <times></times>
     <ci>d</ci>
     <cn type="integer">3</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (d*3)\times(d*3)
  </annotation>
 </semantics>
</math>

.</p>
<h3 id="step-3-reduce-density-matrix">Step 3: Reduce Density Matrix</h3>

<p>Form the reduce density matrix 

<math display="inline" id="Dmrg_of_Heisenberg_model:52">
 <semantics>
  <mrow>
   <msub>
    <mi>ρ</mi>
    <mrow>
     <mi>i</mi>
     <mo>,</mo>
     <mi>j</mi>
     <mo>;</mo>
     <msup>
      <mi>i</mi>
      <mo>′</mo>
     </msup>
     <mo>,</mo>
     <msup>
      <mi>j</mi>
      <mo>′</mo>
     </msup>
    </mrow>
   </msub>
   <mo>≡</mo>
   <mrow>
    <msub>
     <mo largeop="true" symmetric="true">∑</mo>
     <mrow>
      <mi>k</mi>
      <mo>,</mo>
      <mi>w</mi>
     </mrow>
    </msub>
    <mrow>
     <msub>
      <mi mathvariant="normal">Ψ</mi>
      <mrow>
       <mi>i</mi>
       <mo>,</mo>
       <mi>j</mi>
       <mo>,</mo>
       <mi>k</mi>
       <mo>,</mo>
       <mi>w</mi>
      </mrow>
     </msub>
     <msub>
      <mi mathvariant="normal">Ψ</mi>
      <mrow>
       <msup>
        <mi>i</mi>
        <mo>′</mo>
       </msup>
       <mo>,</mo>
       <msup>
        <mi>j</mi>
        <mo>′</mo>
       </msup>
       <mo>,</mo>
       <mi>k</mi>
       <mo>,</mo>
       <mi>w</mi>
      </mrow>
     </msub>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <equivalent></equivalent>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>ρ</ci>
     <list>
      <ci>i</ci>
      <ci>j</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>i</ci>
       <ci>normal-′</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>j</ci>
       <ci>normal-′</ci>
      </apply>
     </list>
    </apply>
    <apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <sum></sum>
      <list>
       <ci>k</ci>
       <ci>w</ci>
      </list>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>normal-Ψ</ci>
       <list>
        <ci>i</ci>
        <ci>j</ci>
        <ci>k</ci>
        <ci>w</ci>
       </list>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>normal-Ψ</ci>
       <list>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>i</ci>
         <ci>normal-′</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>j</ci>
         <ci>normal-′</ci>
        </apply>
        <ci>k</ci>
        <ci>w</ci>
       </list>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \rho_{i,j;i^{\prime},j^{\prime}}\equiv\sum_{k,w}\Psi_{i,j,k,w}\Psi_{i^{\prime}%
,j^{\prime},k,w}
  </annotation>
 </semantics>
</math>

 for the first two block system, the Block and the left-site. By definition it is the 

<math display="inline" id="Dmrg_of_Heisenberg_model:53">
 <semantics>
  <mi>ρ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>ρ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \rho
  </annotation>
 </semantics>
</math>

 matrix: 

<math display="inline" id="Dmrg_of_Heisenberg_model:54">
 <semantics>
  <mrow>
   <mi>m</mi>
   <mo>×</mo>
   <mrow>
    <mo stretchy="false">(</mo>
    <mrow>
     <mi>d</mi>
     <mo>*</mo>
     <mn>3</mn>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>m</ci>
    <apply>
     <times></times>
     <ci>d</ci>
     <cn type="integer">3</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   m\times(d*3)
  </annotation>
 </semantics>
</math>

 <a href="Diagonalization" title="wikilink">Diagonalize</a> 

<math display="inline" id="Dmrg_of_Heisenberg_model:55">
 <semantics>
  <mi>T</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>T</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   T
  </annotation>
 </semantics>
</math>

 and form the 

<math display="inline" id="Dmrg_of_Heisenberg_model:56">
 <semantics>
  <mi>m</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>m</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   m
  </annotation>
 </semantics>
</math>

 matrix 

<math display="inline" id="Dmrg_of_Heisenberg_model:57">
 <semantics>
  <mi>m</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>m</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   m
  </annotation>
 </semantics>
</math>

, which rows are the 

<math display="inline" id="Dmrg_of_Heisenberg_model:58">
 <semantics>
  <msub>
   <mi>e</mi>
   <mi>α</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>e</ci>
    <ci>α</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   e_{\alpha}
  </annotation>
 </semantics>
</math>

 eigenvectors associated with the 

<math display="inline" id="Dmrg_of_Heisenberg_model:59">
 <semantics>
  <mi>ρ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>ρ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \rho
  </annotation>
 </semantics>
</math>

 largest eigenvalue 

<math display="inline" id="Dmrg_of_Heisenberg_model:60">
 <semantics>
  <mi>T</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>T</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   T
  </annotation>
 </semantics>
</math>

 of 

<math display="inline" id="Dmrg_of_Heisenberg_model:61">
 <semantics>
  <mi>m</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>m</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   m
  </annotation>
 </semantics>
</math>

. So 

<math display="inline" id="Dmrg_of_Heisenberg_model:62">
 <semantics>
  <mrow>
   <msub>
    <mi>P</mi>
    <mi>m</mi>
   </msub>
   <mo>≡</mo>
   <mrow>
    <msubsup>
     <mo largeop="true" symmetric="true">∑</mo>
     <mrow>
      <mi>α</mi>
      <mo>=</mo>
      <mn>1</mn>
     </mrow>
     <mi>m</mi>
    </msubsup>
    <msub>
     <mi>e</mi>
     <mi>α</mi>
    </msub>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <equivalent></equivalent>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>P</ci>
     <ci>m</ci>
    </apply>
    <apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <apply>
        <eq></eq>
        <ci>α</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <ci>m</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>e</ci>
      <ci>α</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   P_{m}\equiv\sum_{\alpha=1}^{m}e_{\alpha}
  </annotation>
 </semantics>
</math>

 is formed by the most significant eigenstates of the reduce density matrix. You choose 

<math display="block" id="Dmrg_of_Heisenberg_model:63">
 <semantics>
  <mrow>
   <mrow>
    <mn>1</mn>
    <mo>-</mo>
    <msub>
     <mi>P</mi>
     <mi>m</mi>
    </msub>
   </mrow>
   <mo>≅</mo>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <approx></approx>
    <apply>
     <minus></minus>
     <cn type="integer">1</cn>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>P</ci>
      <ci>m</ci>
     </apply>
    </apply>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   1-P_{m}\cong 0
  </annotation>
 </semantics>
</math>

 looking to the parameter 

<math display="inline" id="Dmrg_of_Heisenberg_model:64">
 <semantics>
  <mrow>
   <mrow>
    <mo stretchy="false">(</mo>
    <mrow>
     <mi>d</mi>
     <mo>*</mo>
     <mn>3</mn>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>×</mo>
   <mrow>
    <mo stretchy="false">(</mo>
    <mrow>
     <mi>d</mi>
     <mo>*</mo>
     <mn>3</mn>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <times></times>
     <ci>d</ci>
     <cn type="integer">3</cn>
    </apply>
    <apply>
     <times></times>
     <ci>d</ci>
     <cn type="integer">3</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (d*3)\times(d*3)
  </annotation>
 </semantics>
</math>



<math display="inline" id="Dmrg_of_Heisenberg_model:65">
 <semantics>
  <mrow>
   <msub>
    <mi>H</mi>
    <mrow>
     <mi>B</mi>
     <mo>-</mo>
     <mi>l</mi>
    </mrow>
   </msub>
   <mo>=</mo>
   <mrow>
    <mrow>
     <msub>
      <mi>H</mi>
      <mi>B</mi>
     </msub>
     <mo>⊗</mo>
     <mi>𝕀</mi>
    </mrow>
    <mo>+</mo>
    <mrow>
     <msub>
      <mi>S</mi>
      <msub>
       <mi>x</mi>
       <mi>B</mi>
      </msub>
     </msub>
     <mo>⊗</mo>
     <msub>
      <mi>S</mi>
      <msub>
       <mi>x</mi>
       <mi>l</mi>
      </msub>
     </msub>
    </mrow>
    <mo>+</mo>
    <mrow>
     <msub>
      <mi>S</mi>
      <msub>
       <mi>y</mi>
       <mi>B</mi>
      </msub>
     </msub>
     <mo>⊗</mo>
     <msub>
      <mi>S</mi>
      <msub>
       <mi>y</mi>
       <mi>l</mi>
      </msub>
     </msub>
    </mrow>
    <mo>+</mo>
    <mrow>
     <msub>
      <mi>S</mi>
      <msub>
       <mi>z</mi>
       <mi>B</mi>
      </msub>
     </msub>
     <mo>⊗</mo>
     <msub>
      <mi>S</mi>
      <msub>
       <mi>z</mi>
       <mi>l</mi>
      </msub>
     </msub>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>H</ci>
     <apply>
      <minus></minus>
      <ci>B</ci>
      <ci>l</ci>
     </apply>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <csymbol cd="latexml">tensor-product</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>H</ci>
       <ci>B</ci>
      </apply>
      <ci>𝕀</ci>
     </apply>
     <apply>
      <csymbol cd="latexml">tensor-product</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>S</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <ci>B</ci>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>S</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <ci>l</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <csymbol cd="latexml">tensor-product</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>S</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>y</ci>
        <ci>B</ci>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>S</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>y</ci>
        <ci>l</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <csymbol cd="latexml">tensor-product</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>S</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>z</ci>
        <ci>B</ci>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>S</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>z</ci>
        <ci>l</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   H_{B-l}=H_{B}\otimes\mathbb{I}+S_{x_{B}}\otimes S_{x_{l}}+S_{y_{B}}\otimes S_{%
y_{l}}+S_{z_{B}}\otimes S_{z_{l}}
  </annotation>
 </semantics>
</math>

.</p>
<h3 id="step-4-new-block-and-universe-block-operators">Step 4: New, Block and Universe Block, operators</h3>

<p>Form the 

<math display="inline" id="Dmrg_of_Heisenberg_model:66">
 <semantics>
  <mrow>
   <msub>
    <mi>S</mi>
    <msub>
     <mi>x</mi>
     <mrow>
      <mi>B</mi>
      <mo>-</mo>
      <mi>l</mi>
     </mrow>
    </msub>
   </msub>
   <mo>=</mo>
   <mrow>
    <mi>𝕀</mi>
    <mo>⊗</mo>
    <msub>
     <mi>S</mi>
     <msub>
      <mi>x</mi>
      <mi>l</mi>
     </msub>
    </msub>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>S</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <apply>
       <minus></minus>
       <ci>B</ci>
       <ci>l</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <csymbol cd="latexml">tensor-product</csymbol>
     <ci>𝕀</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>S</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <ci>l</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   S_{x_{B-l}}=\mathbb{I}\otimes S_{x_{l}}
  </annotation>
 </semantics>
</math>

 matrix representation of operators for the system composite of Block and left-site, and for the system composite of right-site and Universe-Block, for example: 

<math display="inline" id="Dmrg_of_Heisenberg_model:67">
 <semantics>
  <mrow>
   <msub>
    <mi>H</mi>
    <mrow>
     <mi>r</mi>
     <mo>-</mo>
     <mi>U</mi>
    </mrow>
   </msub>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mi>𝕀</mi>
     <mo>⊗</mo>
     <msub>
      <mi>H</mi>
      <mi>U</mi>
     </msub>
    </mrow>
    <mo>+</mo>
    <mrow>
     <msub>
      <mi>S</mi>
      <msub>
       <mi>x</mi>
       <mi>r</mi>
      </msub>
     </msub>
     <mo>⊗</mo>
     <msub>
      <mi>S</mi>
      <msub>
       <mi>x</mi>
       <mi>U</mi>
      </msub>
     </msub>
    </mrow>
    <mo>+</mo>
    <mrow>
     <msub>
      <mi>S</mi>
      <msub>
       <mi>y</mi>
       <mi>r</mi>
      </msub>
     </msub>
     <mo>⊗</mo>
     <msub>
      <mi>S</mi>
      <msub>
       <mi>y</mi>
       <mi>U</mi>
      </msub>
     </msub>
    </mrow>
    <mo>+</mo>
    <mrow>
     <msub>
      <mi>S</mi>
      <msub>
       <mi>z</mi>
       <mi>r</mi>
      </msub>
     </msub>
     <mo>⊗</mo>
     <msub>
      <mi>S</mi>
      <msub>
       <mi>z</mi>
       <mi>U</mi>
      </msub>
     </msub>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>H</ci>
     <apply>
      <minus></minus>
      <ci>r</ci>
      <ci>U</ci>
     </apply>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <csymbol cd="latexml">tensor-product</csymbol>
      <ci>𝕀</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>H</ci>
       <ci>U</ci>
      </apply>
     </apply>
     <apply>
      <csymbol cd="latexml">tensor-product</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>S</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <ci>r</ci>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>S</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <ci>U</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <csymbol cd="latexml">tensor-product</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>S</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>y</ci>
        <ci>r</ci>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>S</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>y</ci>
        <ci>U</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <csymbol cd="latexml">tensor-product</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>S</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>z</ci>
        <ci>r</ci>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>S</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>z</ci>
        <ci>U</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   H_{r-U}=\mathbb{I}\otimes H_{U}+S_{x_{r}}\otimes S_{x_{U}}+S_{y_{r}}\otimes S_%
{y_{U}}+S_{z_{r}}\otimes S_{z_{U}}
  </annotation>
 </semantics>
</math>

 

<math display="inline" id="Dmrg_of_Heisenberg_model:68">
 <semantics>
  <mrow>
   <msub>
    <mi>S</mi>
    <msub>
     <mi>x</mi>
     <mrow>
      <mi>r</mi>
      <mo>-</mo>
      <mi>U</mi>
     </mrow>
    </msub>
   </msub>
   <mo>=</mo>
   <mrow>
    <msub>
     <mi>S</mi>
     <msub>
      <mi>x</mi>
      <mi>r</mi>
     </msub>
    </msub>
    <mo>⊗</mo>
    <mi>𝕀</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>S</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <apply>
       <minus></minus>
       <ci>r</ci>
       <ci>U</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <csymbol cd="latexml">tensor-product</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>S</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <ci>r</ci>
      </apply>
     </apply>
     <ci>𝕀</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   S_{x_{r-U}}=S_{x_{r}}\otimes\mathbb{I}
  </annotation>
 </semantics>
</math>

 

<math display="inline" id="Dmrg_of_Heisenberg_model:69">
 <semantics>
  <mrow>
   <mi>m</mi>
   <mo>×</mo>
   <mi>m</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>m</ci>
    <ci>m</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   m\times m
  </annotation>
 </semantics>
</math>

 

<math display="inline" id="Dmrg_of_Heisenberg_model:70">
 <semantics>
  <mi>T</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>T</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   T
  </annotation>
 </semantics>
</math>

</p>

<p>Now, form the 

<math display="inline" id="Dmrg_of_Heisenberg_model:71">
 <semantics>
  <mtable>
   <mtr>
    <mtd columnalign="center">
     <mi></mi>
    </mtd>
    <mtd columnalign="center">
     <mrow>
      <mi>H</mi>
      <msub>
       <mo>;</mo>
       <mi>B</mi>
      </msub>
      <mo>=</mo>
      <mi>T</mi>
      <msub>
       <mi>H</mi>
       <mrow>
        <mi>B</mi>
        <mo>-</mo>
        <mi>l</mi>
       </mrow>
      </msub>
      <msup>
       <mi>T</mi>
       <mo>†</mo>
      </msup>
     </mrow>
    </mtd>
    <mtd columnalign="center">
     <mrow>
      <mi>S</mi>
      <msub>
       <mo>;</mo>
       <msub>
        <mi>x</mi>
        <mi>B</mi>
       </msub>
      </msub>
      <mo>=</mo>
      <mi>T</mi>
      <msub>
       <mi>S</mi>
       <msub>
        <mi>x</mi>
        <mrow>
         <mi>B</mi>
         <mo>-</mo>
         <mi>l</mi>
        </mrow>
       </msub>
      </msub>
      <msup>
       <mi>T</mi>
       <mo>†</mo>
      </msup>
     </mrow>
    </mtd>
   </mtr>
  </mtable>
  <annotation-xml encoding="MathML-Content">
   <matrix>
    <matrixrow>
     <csymbol cd="latexml">absent</csymbol>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <csymbol cd="unknown">H</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>normal-;</ci>
       <ci>B</ci>
      </apply>
      <eq></eq>
      <csymbol cd="unknown">T</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>H</ci>
       <apply>
        <minus></minus>
        <ci>B</ci>
        <ci>l</ci>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>T</ci>
       <ci>normal-†</ci>
      </apply>
     </cerror>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <csymbol cd="unknown">S</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>normal-;</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <ci>B</ci>
       </apply>
      </apply>
      <eq></eq>
      <csymbol cd="unknown">T</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>S</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <apply>
         <minus></minus>
         <ci>B</ci>
         <ci>l</ci>
        </apply>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>T</ci>
       <ci>normal-†</ci>
      </apply>
     </cerror>
    </matrixrow>
   </matrix>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \begin{matrix}&H;_{B}=TH_{B-l}T^{\dagger}\par
&S;_{x_{B}}=TS_{x_{B-l}}T^{%
\dagger}\par
\end{matrix}
  </annotation>
 </semantics>
</math>

 matrix representations of the new Block and Universe-Block operators, form a new block by changing basis with the transformation <span class="LaTeX">$T$</span>, for example:</p>
<center>

<p><span class="LaTeX">$\begin{matrix}
&amp;H;_B=TH_{B-l}T^\dagger

&amp;S;_{x_B}=TS_{x_{B-l}}T^\dagger

\end{matrix}$</span></p>
</center>

<p>At this point the iteration is ended and the algorithm goes back to step 1. The algorithm stops successfully when the observable converges to some value.</p>
<h2 id="further-reading">Further reading</h2>
<ul>
<li><a href="http://prola.aps.org/abstract/PRB/v48/i14/p10345_1"><em>Density-matrix algorithms for quantum renormalization groups</em> , Steven R. White; Phys. Review B, 48, 10345</a></li>
<li><a href="http://prola.aps.org/abstract/PRB/v48/i6/p3844_1"><em>Numerical renormalization-group study of low-lying eigenstates of the antiferromagnetic S=1 Heisenberg chain</em> , Steven R. White, </a><a href="David_Alan_Huse" title="wikilink">David A. Huse</a>; Phys. Review B, 48, 3844</li>
<li><a href="http://link.aps.org/doi/10.1103/RevModPhys.77.259"><em>The density-matrix renormalization group</em> , U. Schollwock; Reviews of Modern Physics, Volume 77, 259, January 2005</a></li>
</ul>
<h2 id="see-also">See also</h2>
<ul>
<li><a href="Heisenberg_model_(quantum)" title="wikilink">Heisenberg model (quantum)</a></li>
<li><a href="Density_Matrix_Renormalization_Group" title="wikilink">Density Matrix Renormalization Group</a></li>
</ul>

<p>"</p>

<p><a href="Category:Theoretical_physics" title="wikilink">Category:Theoretical physics</a> <a href="Category:Statistical_mechanics" title="wikilink">Category:Statistical mechanics</a></p>
</body>
</html>

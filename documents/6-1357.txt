   Direct stiffness method      Direct stiffness method  As one of the methods of structural analysis , the direct stiffness method , also known as the matrix stiffness method , is particularly suited for computer-automated analysis of complex structures including the statically indeterminate type. It is a matrix method that makes use of the members' stiffness relations for computing member forces and displacements in structures. The direct stiffness method is the most common implementation of the finite element method (FEM). In applying the method, the system must be modeled as a set of simpler, idealized elements interconnected at the nodes. The material stiffness properties of these elements are then, through matrix mathematics , compiled into a single matrix equation which governs the behaviour of the entire idealized structure. The structureâ€™s unknown displacements and forces can then be determined by solving this equation. The direct stiffness method forms the basis for most commercial and free source finite element software.  The direct stiffness method originated in the field of aerospace . Researchers looked at various approaches for analysis of complex airplane frames. These included elasticity theory , energy principles in structural mechanics , flexibility method and matrix stiffness method . It was through analysis of these methods that the direct stiffness method emerged as an efficient method ideally suited for computer implementation.  History  Between 1934 and 1938 A. R. Collar and W. J. Duncan published the first papers with the representation and terminology for matrix systems that are used today. Aeroelastic research continued through World War II but publication restrictions from 1938 to 1947 make this work difficult to trace. The second major breakthrough in matrix structural analysis occurred through 1954 and 1955 when professor John H. Argyris systemized the concept of assembling elemental components of a structure into a system of equations. Finally, on Nov. 6 1959, M. J. Turner , head of Boeing â€™s Structural Dynamics Unit, published a paper outlining the direct stiffness method as an efficient model for computer implementation .  Member stiffness relations  A typical member stiffness relation has the following general form:       ğ  m   =      ğ¤  m    ğª  m    +   ğ   o  m      (  1  )         superscript  ğ  m         superscript  ğ¤  m    superscript  ğª  m     superscript  ğ    o  m     1     \mathbf{Q}^{m}=\mathbf{k}^{m}\mathbf{q}^{m}+\mathbf{Q}^{om}\qquad\qquad\qquad%
 \mathrm{(1)}   where   m = member number m .      ğ  m     superscript  ğ  m    \mathbf{Q}^{m}   = vector of member's characteristic forces, which are unknown internal forces.      ğ¤  m     superscript  ğ¤  m    \mathbf{k}^{m}   = member stiffness matrix which characterises the member's resistance against deformations.      ğª  m     superscript  ğª  m    \mathbf{q}^{m}   = vector of member's characteristic displacements or deformations.      ğ   o  m      superscript  ğ    o  m     \mathbf{Q}^{om}   = vector of member's characteristic forces caused by external effects (such as known forces and temperature changes) applied to the member while     ğª  m   =  0       superscript  ğª  m   0    \mathbf{q}^{m}=0   ).   If    ğª  m     superscript  ğª  m    \mathbf{q}^{m}   are member deformations rather than absolute displacements, then    ğ  m     superscript  ğ  m    \mathbf{Q}^{m}   are independent member forces, and in such case (1) can be inverted to yield the so-called member flexibility matrix , which is used in the flexibility method .  System stiffness relation  For a system with many members interconnected at points called nodes, the members' stiffness relations such as Eq.(1) can be integrated by making use of the following observations:   The member deformations    ğª  m     superscript  ğª  m    \mathbf{q}^{m}   can be expressed in terms of system nodal displacements r in order to ensure compatibility between members. This implies that r will be the primary unknowns.  The member forces    ğ  m     superscript  ğ  m    \mathbf{Q}^{m}   help to the keep the nodes in equilibrium under the nodal forces R . This implies that the right-hand-side of (1) will be integrated into the right-hand-side of the following nodal equilibrium equations for the entire system:       ğ‘  =    ğŠğ«  +   ğ‘  o     (  2  )        ğ‘     ğŠğ«   superscript  ğ‘  o    2     \mathbf{R}=\mathbf{Kr}+\mathbf{R}^{o}\qquad\qquad\qquad\mathrm{(2)}   where     ğ‘   ğ‘   \mathbf{R}   = vector of nodal forces, representing external forces applied to the system's nodes.     ğŠ   ğŠ   \mathbf{K}   = system stiffness matrix, which is established by assembling the members' stiffness matrices    ğ¤  m     superscript  ğ¤  m    \mathbf{k}^{m}   .     ğ«   ğ«   \mathbf{r}   = vector of system's nodal displacements that can define all possible deformed configurations of the system subject to arbitrary nodal forces R .      ğ‘  o     superscript  ğ‘  o    \mathbf{R}^{o}   = vector of equivalent nodal forces, representing all external effects other than the nodal forces which are already included in the preceding nodal force vector R . This vector is established by assembling the members'    ğ   o  m      superscript  ğ    o  m     \mathbf{Q}^{om}   .  Solution  The system stiffness matrix K is square since the vectors R and r have the same size. In addition, it is symmetric because    ğ¤  m     superscript  ğ¤  m    \mathbf{k}^{m}   is symmetric. Once the supports' constraints are accounted for in (2), the nodal displacements are found by solving the system of linear equations (2), symbolically:      ğ«  =     ğŠ   -  1     (   ğ‘  -   ğ‘  o    )     (  3  )        ğ«      superscript  ğŠ    1      ğ‘   superscript  ğ‘  o     3     \mathbf{r}=\mathbf{K}^{-1}(\mathbf{R}-\mathbf{R}^{o})\qquad\qquad\qquad\mathrm%
 {(3)}     Subsequently, the members' characteristic forces may be found from Eq.(1) where    ğª  m     superscript  ğª  m    \mathbf{q}^{m}   can be found from r by compatibility consideration.  The direct stiffness method  It is common to have Eq.(1) in a form where    ğª  m     superscript  ğª  m    \mathbf{q}^{m}   and    ğ   o  m      superscript  ğ    o  m     \mathbf{Q}^{om}   are, respectively, the member-end displacements and forces matching in direction with r and R . In such case,   ğŠ   ğŠ   \mathbf{K}   and    ğ‘  o     superscript  ğ‘  o    \mathbf{R}^{o}   can be obtained by direct summation of the members' matrices    ğ¤  m     superscript  ğ¤  m    \mathbf{k}^{m}   and    ğ   o  m      superscript  ğ    o  m     \mathbf{Q}^{om}   . The method is then known as the direct stiffness method.  The advantages and disadvantages of the matrix stiffness method are compared and discussed in the flexibility method article.  Example  Breakdown  The first step when using the direct stiffness method is to identify the individual elements which make up the structure.  (Figure)  DSMImage1.png   Once the elements are identified, the structure is disconnected at the nodes, the points which connect the different elements together.  (Figure)  DSMImage2.png   Each element is then analyzed individually to develop member stiffness equations. The forces and displacements are related through the element stiffness matrix which depends on the geometry and properties of the element.  A truss element can only transmit forces in compression or tension. This means that in two dimensions, each node has two degrees of freedom (DOF): horizontal and vertical displacement. The resulting equation contains a four by four stiffness matrix.       [      f   x  1         f   y  1         f   x  2         f   y  2       ]   =    [      k  11      k  12      k  13      k  14        k  21      k  22      k  23      k  24        k  31      k  32      k  33      k  34        k  41      k  42      k  43      k  44      ]    [      u   x  1         u   y  1         u   x  2         u   y  2       ]           subscript  f    x  1       subscript  f    y  1       subscript  f    x  2       subscript  f    y  2           subscript  k  11    subscript  k  12    subscript  k  13    subscript  k  14      subscript  k  21    subscript  k  22    subscript  k  23    subscript  k  24      subscript  k  31    subscript  k  32    subscript  k  33    subscript  k  34      subscript  k  41    subscript  k  42    subscript  k  43    subscript  k  44        subscript  u    x  1       subscript  u    y  1       subscript  u    x  2       subscript  u    y  2         \begin{bmatrix}f_{x1}\\
 f_{y1}\\
 f_{x2}\\
 f_{y2}\\
 \end{bmatrix}=\begin{bmatrix}k_{11}&k_{12}&k_{13}&k_{14}\\
 k_{21}&k_{22}&k_{23}&k_{24}\\
 k_{31}&k_{32}&k_{33}&k_{34}\\
 k_{41}&k_{42}&k_{43}&k_{44}\\
 \end{bmatrix}\begin{bmatrix}u_{x1}\\
 u_{y1}\\
 u_{x2}\\
 u_{y2}\\
 \end{bmatrix}     A frame element is able to withstand bending moments in addition to compression and tension. This results in three degrees of freedom: horizontal displacement, vertical displacement and in-plane rotation. The stiffness matrix in this case is six by six.       [      f   x  1         f   y  1         m   z  1         f   x  2         f   y  2         m   z  2       ]   =    [      k  11      k  12      k  13      k  14      k  15      k  16        k  21      k  22      k  23      k  24      k  25      k  26        k  31      k  32      k  33      k  34      k  35      k  36        k  41      k  42      k  43      k  44      k  45      k  46        k  51      k  52      k  53      k  54      k  55      k  56        k  61      k  62      k  63      k  64      k  65      k  66      ]    [      u   x  1         u   y  1         Î¸   z  1         u   x  2         u   y  2         Î¸   z  2       ]           subscript  f    x  1       subscript  f    y  1       subscript  m    z  1       subscript  f    x  2       subscript  f    y  2       subscript  m    z  2           subscript  k  11    subscript  k  12    subscript  k  13    subscript  k  14    subscript  k  15    subscript  k  16      subscript  k  21    subscript  k  22    subscript  k  23    subscript  k  24    subscript  k  25    subscript  k  26      subscript  k  31    subscript  k  32    subscript  k  33    subscript  k  34    subscript  k  35    subscript  k  36      subscript  k  41    subscript  k  42    subscript  k  43    subscript  k  44    subscript  k  45    subscript  k  46      subscript  k  51    subscript  k  52    subscript  k  53    subscript  k  54    subscript  k  55    subscript  k  56      subscript  k  61    subscript  k  62    subscript  k  63    subscript  k  64    subscript  k  65    subscript  k  66        subscript  u    x  1       subscript  u    y  1       subscript  Î¸    z  1       subscript  u    x  2       subscript  u    y  2       subscript  Î¸    z  2         \begin{bmatrix}f_{x1}\\
 f_{y1}\\
 m_{z1}\\
 f_{x2}\\
 f_{y2}\\
 m_{z2}\\
 \end{bmatrix}=\begin{bmatrix}k_{11}&k_{12}&k_{13}&k_{14}&k_{15}&k_{16}\\
 k_{21}&k_{22}&k_{23}&k_{24}&k_{25}&k_{26}\\
 k_{31}&k_{32}&k_{33}&k_{34}&k_{35}&k_{36}\\
 k_{41}&k_{42}&k_{43}&k_{44}&k_{45}&k_{46}\\
 k_{51}&k_{52}&k_{53}&k_{54}&k_{55}&k_{56}\\
 k_{61}&k_{62}&k_{63}&k_{64}&k_{65}&k_{66}\\
 \end{bmatrix}\begin{bmatrix}u_{x1}\\
 u_{y1}\\
 \theta_{z1}\\
 u_{x2}\\
 u_{y2}\\
 \theta_{z2}\\
 \end{bmatrix}     Other elements such as plates and shells can also be incorporated into the direct stiffness method and similar equations must be developed.  Assembly  Once the individual element stiffness relations have been developed they must be assembled into the original structure. The first step in this process is to convert the stiffness relations for the individual elements into a global system for the entire structure. In the case of a truss element, the global form of the stiffness method depends on the angle of the element with respect to the global coordinate system (This system is usually the traditional Cartesian coordinate system ).       [      f   x  1         f   y  1         f   x  2         f   y  2       ]   =     E  A   L    [      c  2      s  c      -   c  2       -   s  c         s  c      s  2      -   s  c       -   s  2         -   c  2       -   s  c       c  2      s  c        -   s  c       -   s  2       s  c      s  2      ]    [      u   x  1         u   y  1         u   x  2         u   y  2       ]       s  =   sin  Î²         c  =   cos  Î²               subscript  f    x  1       subscript  f    y  1       subscript  f    x  2       subscript  f    y  2            E  A   L      superscript  c  2     s  c      superscript  c  2        s  c        s  c    superscript  s  2       s  c       superscript  s  2         superscript  c  2        s  c     superscript  c  2     s  c         s  c       superscript  s  2      s  c    superscript  s  2        subscript  u    x  1       subscript  u    y  1       subscript  u    x  2       subscript  u    y  2          s    Î²        c    Î²         \begin{bmatrix}f_{x1}\\
 f_{y1}\\
 f_{x2}\\
 f_{y2}\\
 \end{bmatrix}=\frac{EA}{L}\begin{bmatrix}c^{2}&sc&-c^{2}&-sc\\
 sc&s^{2}&-sc&-s^{2}\\
 -c^{2}&-sc&c^{2}&sc\\
 -sc&-s^{2}&sc&s^{2}\\
 \end{bmatrix}\begin{bmatrix}u_{x1}\\
 u_{y1}\\
 u_{x2}\\
 u_{y2}\\
 \end{bmatrix}\par
 \begin{array}[]{ r }s=\sin\beta\\
 c=\cos\beta\\
 \end{array}   '' (for a truss element at angle Î²)'' Equivalently,     [      f   x  1         f   y  1         f   x  2         f   y  2       ]   =     E  A   L    [       c  x    c  x        c  x    c  y       -    c  x    c  x        -    c  x    c  y           c  y    c  x        c  y    c  y       -    c  y    c  x        -    c  y    c  y          -    c  x    c  x        -    c  x    c  y         c  x    c  x        c  x    c  y         -    c  y    c  x        -    c  y    c  y         c  y    c  x        c  y    c  y       ]    [      u   x  1         u   y  1         u   x  2         u   y  2       ]         delimited-[]     subscript  f    x  1       subscript  f    y  1       subscript  f    x  2       subscript  f    y  2             E  A   L    delimited-[]       subscript  c  x    subscript  c  x       subscript  c  x    subscript  c  y         subscript  c  x    subscript  c  x          subscript  c  x    subscript  c  y          subscript  c  y    subscript  c  x       subscript  c  y    subscript  c  y         subscript  c  y    subscript  c  x          subscript  c  y    subscript  c  y            subscript  c  x    subscript  c  x          subscript  c  x    subscript  c  y        subscript  c  x    subscript  c  x       subscript  c  x    subscript  c  y           subscript  c  y    subscript  c  x          subscript  c  y    subscript  c  y        subscript  c  y    subscript  c  x       subscript  c  y    subscript  c  y        delimited-[]     subscript  u    x  1       subscript  u    y  1       subscript  u    x  2       subscript  u    y  2          \left[\begin{array}[]{c}f_{x1}\\
 f_{y1}\\
 \hline f_{x2}\\
 f_{y2}\\
 \end{array}\right]=\frac{EA}{L}\left[\begin{array}[]{c c|c c}c_{x}c_{x}&c_{x}c%
 _{y}&-c_{x}c_{x}&-c_{x}c_{y}\\
 c_{y}c_{x}&c_{y}c_{y}&-c_{y}c_{x}&-c_{y}c_{y}\\
 \hline-c_{x}c_{x}&-c_{x}c_{y}&c_{x}c_{x}&c_{x}c_{y}\\
 -c_{y}c_{x}&-c_{y}c_{y}&c_{y}c_{x}&c_{y}c_{y}\\
 \end{array}\right]\left[\begin{array}[]{c}u_{x1}\\
 u_{y1}\\
 \hline u_{x2}\\
 u_{y2}\\
 \end{array}\right]     where    c  x     subscript  c  x    c_{x}   and    c  y     subscript  c  y    c_{y}   are the direction cosines of the truss element (i.e., they are components of a unit vector aligned with the member). This form reveals how to generalize the element stiffness to 3-D space trusses by simply extending the pattern that is evident in this formulation.  After developing the element stiffness matrix in the global coordinate system, they must be merged into a single â€œmasterâ€ or â€œglobalâ€ stiffness matrix. When merging these matrices together there are two rules that must be followed: compatibility of displacements and force equilibrium at each node. These rules are upheld by relating the element nodal displacements to the global nodal displacements.  (Figure)  DSMImage3.png   The global displacement and force vectors each contain one entry for each degree of freedom in the structure. The element stiffness matrices are merged by augmenting or expanding each matrix in conformation to the global displacement and load vectors.       k   (  1  )    =     E  A   L    [     1    0     -  1     0      0    0    0    0       -  1     0    1    0      0    0    0    0     ]    â†’   K   (  1  )    =     E  A   L    [     1    0     -  1     0    0    0      0    0    0    0    0    0       -  1     0    1    0    0    0      0    0    0    0    0    0      0    0    0    0    0    0      0    0    0    0    0    0     ]           superscript  k  1         E  A   L     1  0    1   0    0  0  0  0      1   0  1  0    0  0  0  0       normal-â†’     superscript  K  1              E  A   L     1  0    1   0  0  0    0  0  0  0  0  0      1   0  1  0  0  0    0  0  0  0  0  0    0  0  0  0  0  0    0  0  0  0  0  0        k^{(1)}=\frac{EA}{L}\begin{bmatrix}1&0&-1&0\\
 0&0&0&0\\
 -1&0&1&0\\
 0&0&0&0\\
 \end{bmatrix}\rightarrow K^{(1)}=\frac{EA}{L}\begin{bmatrix}1&0&-1&0&0&0\\
 0&0&0&0&0&0\\
 -1&0&1&0&0&0\\
 0&0&0&0&0&0\\
 0&0&0&0&0&0\\
 0&0&0&0&0&0\\
 \end{bmatrix}    (for element (1) of the above structure)  Finally, the global stiffness matrix is constructed by adding the individual expanded element matrices together.  Solution  Once the global stiffness matrix, displacement vector, and force vector have been constructed, the system can be expressed as a single matrix equation.  (Figure)  DSMImage4.png   For each degree of freedom in the structure, either the displacement or the force is known.  (Figure)  DSMImage5.png   After inserting the known value for each degree of freedom, the master stiffness equation is complete and ready to be evaluated. There are several different methods available for evaluating a matrix equation including but not limited to Cholesky decomposition and the brute force evaluation of systems of equations. If a structure isnâ€™t properly restrained, the application of a force will cause it to move rigidly and additional support conditions must be added.  The method described in this section is meant as an overview of the direct stiffness method. Additional sources should be consulted for more details on the process as well as the assumptions about material properties inherent in the process.  Applications  The direct stiffness method was developed specifically to effectively and easily implement into computer software to evaluate complicated structures that contain a large number of elements. Today, nearly every finite element solver available is based on the direct stiffness method. While each program utilizes the same process, many have been streamlined to reduce computation time and reduce the required memory. In order to achieve this, shortcuts have been developed.  One of the largest areas to utilize the direct stiffness method is the field of structural analysis where this method has been incorporated into modeling software. The software allows users to model a structure and, after the user defines the material properties of the elements, the program automatically generates element and global stiffness relationships. When various loading conditions are applied the software evaluates the structure and generates the deflections for the user.  See also   Finite element method  Finite element method in structural mechanics  Structural analysis  Flexibility method  List of finite element software packages   External links   Application of direct stiffness method to a 1-D Spring System  Matrix Structural Analysis  Animations of Stiffness Analysis Simulations   References    Felippa, Carlos A. Introduction to Finite Element Method. Fall 2001. University of Colorado. 18 Sept. 2005  Robinson, John. Structural Matrix Analysis for the Engineer. New York: John Wiley & Sons, 1966  Rubinstein, Moshe F. Matrix Computer Analysis of Structures. New Jersey: Prentice-Hall, 1966  McGuire, W., Gallagher, R. H., and Ziemian, R. D. Matrix Structural Analysis, 2nd Ed. New York: John Wiley & Sons, 2000.   "  Category:Structural analysis  Category:Numerical differential equations   
   Carmichael function      Carmichael function   In number theory , the Carmichael function of a positive integer  n , denoted    λ   (  n  )       λ  n    \lambda(n)   , is defined as the smallest positive integer m such that       a  m   ≡   1     (   mod  n   )         superscript  a  m    annotated  1   pmod  n      a^{m}\equiv 1\;\;(\mathop{{\rm mod}}n)   for every integer a that is coprime to n . In more algebraic terms, it defines the exponent of the multiplicative group of integers modulo n . The Carmichael function is also known as the reduced totient function or the least universal exponent function , and is sometimes also denoted    ψ   (  n  )       ψ  n    \psi(n)   .  The first 36 values of    λ   (  n  )       λ  n    \lambda(n)   compared to Euler's totient function    φ   φ   \varphi   . (in bold if they are different)      n   1   2   3   4   5   6   7   8   9   10   11   12   13   14   15   16   17   18   19   20   21   22   23   24   25   26   27   28   29   30   31   32   33   34   35   36           λ   (  n  )       λ  n    \lambda(n)      1   1   2   2   4   2   6   2   6   4   10   2   12   6   4   4   16   6   18   4   6   10   22   2   20   12   18   6   28   4   30   8   10   16   12   6         φ   (  n  )       φ  n    \varphi(n)      1   1   2   2   4   2   6   4   6   4   10   4   12   6   8   8   16   6   18   8   12   10   22   8   20   12   18   12   28   8   30   16   20   16   24   12     Numerical example  7 2 = 49 ≡ 1 (mod 8) because 7 and 8 are coprime (their greatest common divisor equals 1; they have no common factors) and the value of Carmichael's function at 8 is 2. Euler's totient function is 4 at 8 because there are 4 numbers lesser than and coprime to 8 (1, 3, 5, and 7). Whilst it is true that 7 4 = 2401 ≡ 1 (mod 8), as shown by Euler's theorem , raising 7 to the fourth power is unnecessary because the Carmichael function indicates that 7 squared equals 1 (mod 8). Raising 7 to exponents greater than 2 only repeats the cycle 7, 1, 7, 1, ... . Because the same holds true for 3 and 5, the Carmichael number is 2 rather than 4. 1  Carmichael's theorem  For a power of an odd prime, twice the power of an odd prime, and for 2 and 4, λ( n ) is equal to the Euler totient φ( n ); for powers of 2 greater than 4 it is equal to one half of the Euler totient:       λ   (  n  )    =   {       φ    (  n  )        if  n   =   2  ,  3  ,  4  ,  5  ,  6  ,  7  ,  9  ,  10  ,  11  ,  13  ,  14  ,  17  ,  19  ,  22  ,  23  ,  25  ,  26  ,  27  ,   29  …            1  2    φ   (  n  )        if  n   =   8  ,  16  ,  32  ,  64  ,  128  ,   256  …               λ  n    cases    φ  n       if  n    2  3  4  5  6  7  9  10  11  13  14  17  19  22  23  25  26  27    29  normal-…         1  2   φ  n       if  n    8  16  32  64  128    256  normal-…        \lambda(n)=\begin{cases}\;\;\varphi(n)&\mbox{if }n=2,3,4,5,6,7,9,10,11,13,14,1%
 7,19,22,23,25,26,27,29\dots\\
 \tfrac{1}{2}\varphi(n)&\text{if }n=8,16,32,64,128,256\dots\end{cases}   Euler's function for prime powers is given by        φ   (   p  k   )    =    p   k  -  1     (   p  -  1   )     .        φ   superscript  p  k       superscript  p    k  1      p  1      \varphi(p^{k})=p^{k-1}(p-1).\;     By the fundamental theorem of arithmetic any n > 1 can be written in a unique way      n  =    p  1   a  1     p  2   a  2    …   p   ω   (  n  )     a   ω   (  n  )           n     superscript   subscript  p  1    subscript  a  1     superscript   subscript  p  2    subscript  a  2    normal-…   superscript   subscript  p    ω  n     subscript  a    ω  n        n=p_{1}^{a_{1}}p_{2}^{a_{2}}\dots p_{\omega(n)}^{a_{\omega(n)}}   where p 1 2 ω are primes and the a i > 0. ( n = 1 corresponds to the empty product.)  For general n , λ( n ) is the least common multiple of λ of each of its prime power factors:        λ   (  n  )    =   lcm   [   λ   (   p  1   a  1    )    ,   λ   (   p  2   a  2    )    ,  …  ,   λ   (   p   ω   (  n  )     a   ω   (  n  )      )    ]     .        λ  n    lcm    λ   superscript   subscript  p  1    subscript  a  1       λ   superscript   subscript  p  2    subscript  a  2     normal-…    λ   superscript   subscript  p    ω  n     subscript  a    ω  n         \lambda(n)=\operatorname{lcm}[\lambda(p_{1}^{a_{1}}),\;\lambda(p_{2}^{a_{2}}),%
 \dots,\lambda(p_{\omega(n)}^{a_{\omega(n)}})].     Carmichael's theorem states that if a is coprime to n , then        a   λ   (  n  )     ≡   1     (   mod  n   )     ,       superscript  a    λ  n     annotated  1   pmod  n      a^{\lambda(n)}\equiv 1\;\;(\mathop{{\rm mod}}n),   where   λ   λ   \lambda   is the Carmichael function defined above. In other words, it asserts the correctness of the formulas. This can be proven by considering any primitive root modulo n and the Chinese remainder theorem .  Hierarchy of results  Since λ( n ) divides φ( n ), Euler's totient function (the quotients are listed in ), the Carmichael function is a stronger result than the classical Euler's theorem . Clearly Carmichael's theorem is related to Euler's theorem, because the exponent of a finite abelian group must divide the order of the group, by elementary group theory. The two functions differ already in small cases: λ(15) = 4 while φ(15) = 8 (see  for the associated n ).  Fermat's little theorem is the special case of Euler's theorem in which n is a prime number p . Carmichael's theorem for a prime p gives the same result, because the group in question is a cyclic group for which the order and exponent are both p − 1.  Properties of the Carmichael function  Divisibility      a  |  b  ⇒  λ   (  a  )   |  λ   (  b  )      fragments  a  normal-|  b  normal-⇒  λ   fragments  normal-(  a  normal-)   normal-|  λ   fragments  normal-(  b  normal-)     a|b\Rightarrow\lambda(a)|\lambda(b)     Composition  For all positive integers   a   a   a   and   b   b   b   it holds       λ   (   lcm   (  a  ,  b  )    )    =   lcm   (   λ   (  a  )    ,   λ   (  b  )    )          λ    lcm   a  b       lcm     λ  a     λ  b       \lambda(\mathrm{lcm}(a,b))=\mathrm{lcm}(\lambda(a),\lambda(b))   . This is an immediate consequence of the recursive definition of the Carmichael function.  Primitive m-th roots of unity  Let   a   a   a   and   n   n   n   be coprime and let   m   m   m   be the smallest exponent with     a  m   ≡   1     (   mod  n   )         superscript  a  m    annotated  1   pmod  n      a^{m}\equiv 1\;\;(\mathop{{\rm mod}}n)   , then it holds      m  |  λ   (  n  )      fragments  m  normal-|  λ   fragments  normal-(  n  normal-)     m|\lambda(n)   . That is, the orders of primitive roots of unity in the ring of integers modulo   n   n   n   are divisors of    λ   (  n  )       λ  n    \lambda(n)   .  Exponential cycle length  For a number   n   n   n   with maximum prime exponent of    x   m  a  x      subscript  x    m  a  x     x_{max}   under prime factorization, then for all   a   a   a   (including those not co-prime to   n   n   n   ) and all    k  ≥   x   m  a  x        k   subscript  x    m  a  x      k\geq x_{max}   ,       a  k   ≡    a   k  +   λ   (  n  )         (   mod  n   )         superscript  a  k    annotated   superscript  a    k    λ  n      pmod  n      a^{k}\equiv a^{k+\lambda(n)}\;\;(\mathop{{\rm mod}}n)     In particular, for squarefree    n   n   n   (     x   m  a  x    =  1       subscript  x    m  a  x    1    x_{max}=1   ), for all   a   a   a         a  ≡    a    λ   (  n  )    +  1       (   mod  n   )        a   annotated   superscript  a      λ  n   1     pmod  n      a\equiv a^{\lambda(n)+1}\;\;(\mathop{{\rm mod}}n)     Average and typical value  For any x > 16, and a constant B :        1  x     ∑   n  ≤  x     λ   (  n  )      =    x   ln  x     e    B   (   1  +   o   (  1  )     )    ln   ln  x     /   (   ln   ln   ln  x     )              1  x     subscript     n  x      λ  n         x    x     superscript  e      B    1    o  1        x           x          \frac{1}{x}\sum_{n\leq x}\lambda(n)=\frac{x}{\ln x}e^{B(1+o(1))\ln\ln x/(\ln%
 \ln\ln x)}   . 2 3  Here      B  =    e   -  γ      ∏  p    (   1  -   1     (   p  -  1   )   2    (   p  +  1   )      )     ≈  0.34537 .        B     superscript  e    γ      subscript  product  p     1    1     superscript    p  1   2     p  1             0.34537 .     B=e^{-\gamma}\prod_{p}\left({1-\frac{1}{(p-1)^{2}(p+1)}}\right)\approx 0.34537\ .     For all numbers N and all except o ( N ) positive integers ''n ≤ N :       λ   (  n  )    =   n  /     (   ln  n   )     ln   ln   ln  n     +  A  +   o   (  1  )              λ  n     n   superscript    n           n     A    o  1        \lambda(n)=n/(\ln n)^{\ln\ln\ln n+A+o(1)}\,   where A is a constant, 4 5      A  =    -  1   +    ∑  p     log  p     (   p  -  1   )   2      ≈  0.2269688 .        A      1     subscript   p       p    superscript    p  1   2           0.2269688 .     A=-1+\sum_{p}\frac{\log p}{(p-1)^{2}}\approx 0.2269688\ .     Lower bounds  For any sufficiently large number N and for any    Δ  ≥    (   ln   ln  N    )   3       normal-Δ   superscript      N    3     \Delta\geq(\ln\ln N)^{3}   , there are at most      N   e   -   0.69    (   Δ   ln  Δ    )    1  /  3           N   superscript  e      0.69   superscript    normal-Δ    normal-Δ      1  3         Ne^{-0.69(\Delta\ln\Delta)^{1/3}}   positive integers    n  ≤  N      n  N    n\leq N   such that     λ   (  n  )    ≤   n   e   -  Δ           λ  n     n   superscript  e    normal-Δ       \lambda(n)\leq ne^{-\Delta}   . 6  For any sequence    n  >  A      n  A    n>A   . 7 8  Small values  For a constant c and any sufficiently large positive A , there exists an integer     λ   (  n  )    <    (   ln  A   )    c   ln   ln   ln  A             λ  n    superscript    A     c        A         \lambda(n)<(\ln A)^{c\ln\ln\ln A}   such that    n  =    ∏    (  q  -  1  )   |  m  and  q  is prime    q       n    subscript  product   fragments   fragments  normal-(  q   1  normal-)   normal-|  m  and  q  is prime    q     n=\prod_{(q-1)|m\text{ and }q\text{ is prime}}q   . 9 Moreover, n is of the form      m  <    (   ln  A   )    c   ln   ln   ln  A           m   superscript    A     c        A         m<(\ln A)^{c\ln\ln\ln A}   for some square-free integer      x    (   log  x   )    η  +   o   (  1  )       ,       x   superscript    x     η    o  1       \frac{x}{(\log x)^{\eta+o(1)}}\ ,   . 10  Image of the function  The set of values of the Carmichael function has counting function  $$\frac{x}{(\log x)^{\eta+o(1)}} \ ,$$ where η=1−(1+loglog2)/(log2)=0.08607…. 11  See also   Carmichael number   Notes    References       "  Category:Modular arithmetic  Category:Functions and mappings     http://www25.brinkster.com/denshade/totient.html ↩  Theorem 3 in Erdős (1991) ↩  Sándor & Crstici (2004) p.194 ↩   Theorem 2 in Erdős (1991) ↩  Theorem 5 in Friedlander (2001) ↩  Theorem 1 in Erdős 1991 ↩  Sándor & Crstici (2004) p.193 ↩    ↩     
   Models of DNA evolution      Models of DNA evolution   A number of different Markov  models of DNA sequence evolution have been proposed. These substitution models differ in terms of the parameters used to describe the rates at which one nucleotide replaces another during evolution. These models are frequently used in molecular phylogenetic analyses . In particular, they are used during the calculation of likelihood of a tree (in Bayesian and maximum likelihood approaches to tree estimation) and they are used to estimate the evolutionary distance between sequences from the observed differences between the sequences.  Introduction  These models are phenomenological descriptions of the evolution of DNA as a string of four discrete states. These Markov models do not explicitly depict the mechanism of mutation nor the action of natural selection. Rather they describe the relative rates of different changes. For example, mutational biases and purifying selection favoring conservative changes are probably both responsible for the relatively high rate of transitions compared to transversions in evolving sequences. However, the Kimura (K80) model described below merely attempts to capture the effect of both forces in a parameter that reflects the relative rate of transitions to transversions.  Evolutionary analyses of sequences are conducted on a wide variety of time scales. Thus, it is convenient to express these models in terms of the instantaneous rates of change between different states (the Q matrices below). If we are given a starting (ancestral) state at one position, the model's Q matrix and a branch length expressing the expected number of changes to have occurred since the ancestor, then we can derive the probability of the descendant sequence having each of the four states. The mathematical details of this transformation from rate-matrix to probability matrix are described in the mathematics of substitution models section of the substitution model page. By expressing models in terms of the instantaneous rates of change we can avoid estimating a large numbers of parameters for each branch on a phylogenetic tree (or each comparison if the analysis involves many pairwise sequence comparisons).  The models described on this page describe the evolution of a single site within a set of sequences. They are often used for analyzing the evolution of an entire locus by making the simplifying assumption that different sites evolve independently and are identically distributed . This assumption may be justifiable if the sites can be assumed to be evolving neutrally . If the primary effect of natural selection on the evolution of the sequences is to constrain some sites, then models of among-site rate-heterogeneity can be used. This approach allows one to estimate only one matrix of relative rates of substitution, and another set of parameters describing the variance in the total rate of substitution across sites.  DNA evolution as a continuous-time Markov chain  Continuous-time Markov chains  Continuous-time  Markov chains have the usual transition matrices which are, in addition, parameterized by time,   t   t   t   . Specifically, if     E  1   ,  â€¦  ,   E  4       subscript  E  1   normal-â€¦   subscript  E  4     E_{1},\ldots,E_{4}   are the states, then the transition matrix       P   (  t  )    =   (    P   i  j     (  t  )    )         P  t      subscript  P    i  j    t     P(t)=\big(P_{ij}(t)\big)   where each individual entry,     P   i  j     (  t  )        subscript  P    i  j    t    P_{ij}(t)   refers to the probability that state    E  i     subscript  E  i    E_{i}   will change to state    E  j     subscript  E  j    E_{j}   in time   t   t   t   .  Example: We would like to model the substitution process in DNA sequences ( i.e.  Jukesâ€“Cantor , Kimura, etc. ) in a continuous-time fashion. The corresponding transition matrices will look like:       P   (  t  )    =   (       p   A  A     (  t  )        p   G  A     (  t  )        p   C  A     (  t  )        p   T  A     (  t  )          p   A  G     (  t  )        p   G  G     (  t  )        p   C  G     (  t  )        p   T  G     (  t  )          p   A  C     (  t  )        p   G  C     (  t  )        p   C  C     (  t  )        p   T  C     (  t  )          p   A  T     (  t  )        p   G  T     (  t  )        p   C  T     (  t  )        p   T  T     (  t  )       )         P  t        subscript  p    A  A    t      subscript  p    G  A    t      subscript  p    C  A    t      subscript  p    T  A    t        subscript  p    A  G    t      subscript  p    G  G    t      subscript  p    C  G    t      subscript  p    T  G    t        subscript  p    A  C    t      subscript  p    G  C    t      subscript  p    C  C    t      subscript  p    T  C    t        subscript  p    A  T    t      subscript  p    G  T    t      subscript  p    C  T    t      subscript  p    T  T    t       P(t)=\begin{pmatrix}p_{AA}(t)&p_{GA}(t)&p_{CA}(t)&p_{TA}(t)\\
 p_{AG}(t)&p_{GG}(t)&p_{CG}(t)&p_{TG}(t)\\
 p_{AC}(t)&p_{GC}(t)&p_{CC}(t)&p_{TC}(t)\\
 p_{AT}(t)&p_{GT}(t)&p_{CT}(t)&p_{TT}(t)\end{pmatrix}     where the top-left and bottom-right 2Â Ã—Â 2 blocks correspond to transition probabilities and the top-right and bottom-left 2Â Ã—Â 2 blocks corresponds to transversion probabilities .  Assumption: If at some time    t  0     subscript  t  0    t_{0}   , the Markov chain is in state    E  i     subscript  E  i    E_{i}   , then the probability that at time     t  0   +  t       subscript  t  0   t    t_{0}+t   , it will be in state    E  j     subscript  E  j    E_{j}   depends only upon   i   i   i   ,   j   j   j   and   t   t   t   . This then allows us to write that probability as     p   i  j     (  t  )        subscript  p    i  j    t    p_{ij}(t)   .  Theorem: Continuous-time transition matrices satisfy:         P   (   t  +  Ï„   )    =   P   (  t  )   P   (  Ï„  )          P    t  Ï„      P  t  P  Ï„     P(t+\tau)=P(t)P(\tau)        Note: There is here a possible confusion between two meanings of the word transition . (i) In the context of Markov chains , transition is the general term that refers to the change between two states. (ii) In the context of nucleotide changes in DNA sequences , transition is a specific term that refers to the exchange between either the two purines (A â†” G) or the two pyrimidines (C â†” T) (for additional details, see the article about transitions in genetics ). By contrast, an exchange between one purine and one pyrimidine is called a transversion .  Deriving the dynamics of substitution  Consider a DNA sequence of fixed length m evolving in time by base replacement. Assume that the processes followed by the m sites are Markovian independent, identically distributed and constant in time. For a fixed site, let       ğ   (  t  )    =    (    p  A    (  t  )    ,    p  G    (  t  )    ,    p  C    (  t  )    ,    p  T    (  t  )    )   T         ğ  t    superscript      subscript  p  A   t      subscript  p  G   t      subscript  p  C   t      subscript  p  T   t    T     \mathbf{P}(t)=(p_{A}(t),\ p_{G}(t),\ p_{C}(t),\ p_{T}(t))^{T}     be the column vector of probabilities of states    A  ,    A   A,        G  ,     G   \ G,        C  ,     C   \ C,   and    T    T   \ T   at time   t   t   t   . Let      â„°  =   {  A  ,  G  ,  C  ,  T  }       â„°   A  G  C  T     \mathcal{E}=\{A,\ G,\ C,\ T\}     be the state-space. For two distinct       x  ,  y   âˆˆ  â„°       x  y   â„°    x,y\in\mathcal{E}   , let    Î¼   x  y      subscript  Î¼    x  y     \mu_{xy}     be the transition rate from state   x   x   x   to state   y   y   y   . Similarly, for any   x   x   x   , let:       Î¼  x   =    âˆ‘   y  â‰   x     Î¼   x  y          subscript  Î¼  x     subscript     y  x     subscript  Î¼    x  y       \mu_{x}=\sum_{y\neq x}\mu_{xy}     The changes in the probability distribution     p  A    (  t  )        subscript  p  A   t    p_{A}(t)   for small increments of time    Î”  t      normal-Î”  t    \Delta t   are given by:        p  A    (   t  +   Î”  t    )    =      p  A    (  t  )    -    p  A    (  t  )    Î¼  A   Î”  t    +    âˆ‘   x  â‰   A      p  x    (  t  )    Î¼   x  A    Î”  t            subscript  p  A     t    normal-Î”  t            subscript  p  A   t      subscript  p  A   t   subscript  Î¼  A   normal-Î”  t      subscript     x  A       subscript  p  x   t   subscript  Î¼    x  A    normal-Î”  t       p_{A}(t+\Delta t)=p_{A}(t)-p_{A}(t)\mu_{A}\Delta t+\sum_{x\neq A}p_{x}(t)\mu_{%
 xA}\Delta t     In other words (in frequentist language), the frequency of   A   A   A   's at time    t  +   Î”  t       t    normal-Î”  t     t+\Delta t   is equal to the frequency at time   t   t   t   minus the frequency of the lost    A   A   A   's plus the frequency of the newly created    A   A   A   's.  Similarly for the probabilities      p  G    (  t  )    ,    p  C    (  t  )    ,    and    p  T    (  t  )          subscript  p  G   t      subscript  p  C   t     and   subscript  p  T   t     p_{G}(t),\ p_{C}(t),\ \mathrm{and}\ p_{T}(t)   . We can write these compactly as:       ğ   (   t  +   Î”  t    )    =    ğ   (  t  )    +   Q  ğ   (  t  )   Î”  t          ğ    t    normal-Î”  t         ğ  t     Q  ğ  t  normal-Î”  t      \mathbf{P}(t+\Delta t)=\mathbf{P}(t)+Q\mathbf{P}(t)\Delta t     where,      Q  =   (      -   Î¼  A       Î¼   G  A       Î¼   C  A       Î¼   T  A         Î¼   A  G       -   Î¼  G       Î¼   C  G       Î¼   T  G         Î¼   A  C       Î¼   G  C       -   Î¼  C       Î¼   T  C         Î¼   A  T       Î¼   G  T       Î¼   C  T       -   Î¼  T       )       Q       subscript  Î¼  A     subscript  Î¼    G  A     subscript  Î¼    C  A     subscript  Î¼    T  A       subscript  Î¼    A  G       subscript  Î¼  G     subscript  Î¼    C  G     subscript  Î¼    T  G       subscript  Î¼    A  C     subscript  Î¼    G  C       subscript  Î¼  C     subscript  Î¼    T  C       subscript  Î¼    A  T     subscript  Î¼    G  T     subscript  Î¼    C  T       subscript  Î¼  T        Q=\begin{pmatrix}-\mu_{A}&\mu_{GA}&\mu_{CA}&\mu_{TA}\\
 \mu_{AG}&-\mu_{G}&\mu_{CG}&\mu_{TG}\\
 \mu_{AC}&\mu_{GC}&-\mu_{C}&\mu_{TC}\\
 \mu_{AT}&\mu_{GT}&\mu_{CT}&-\mu_{T}\end{pmatrix}   or, alternately:        ğ  â€²    (  t  )    =   Q  ğ   (  t  )           superscript  ğ  normal-â€²   t     Q  ğ  t     \mathbf{P}^{\prime}(t)=Q\mathbf{P}(t)     where,   Q   Q   Q   is the rate matrix. Note that by definition, the columns of   Q   Q   Q   sum to zero. For a stationary process , where   Q   Q   Q   does not depend upon time t , this differential equation is solvable using matrix exponentiation :       P   (  t  )    =   exp   (   Q  t   )          P  t       Q  t      P(t)=\exp(Qt)   and        ğ   (  t  )    =   P   (  t  )   ğ   (  0  )    =    exp   (   Q  t   )    ğ   (  0  )     .          ğ  t     P  t  ğ  0              Q  t    ğ  0      \mathbf{P}(t)=P(t)\mathbf{P}(0)=\exp(Qt)\mathbf{P}(0)\,.     Ergodicity  If all the transition probabilities,    Î¼   x  y      subscript  Î¼    x  y     \mu_{xy}   are positive, i.e. if all states     x  ,  y   âˆˆ  â„°       x  y   â„°    x,y\in\mathcal{E}    communicate , then the Markov chain has a unique stationary distribution    ğš·  =   {   Ï€  x   ,  x  âˆˆ  â„°  }      fragments  Î     fragments  normal-{   subscript  Ï€  x   normal-,  x   E  normal-}     \mathbf{\Pi}=\{\pi_{x},\ x\in\mathcal{E}\}   where each    Ï€  x     subscript  Ï€  x    \pi_{x}   is the proportion of time spent in state   x   x   x   after the Markov chain has run for infinite time. Such a Markov chain is called, ergodic . In DNA evolution, under the assumption of a common process for each site, the stationary frequencies,     Ï€  A   ,   Ï€  G   ,   Ï€  C   ,   Ï€  T       subscript  Ï€  A    subscript  Ï€  G    subscript  Ï€  C    subscript  Ï€  T     \pi_{A},\pi_{G},\pi_{C},\pi_{T}   correspond to equilibrium base compositions.  When the current distribution    ğ   (  t  )       ğ  t    \mathbf{P}(t)   is the stationary distribution   ğš·   ğš·   \mathbf{\Pi}   , then it follows that     Q  ğš·   =  0        Q  ğš·   0    Q\mathbf{\Pi}=0   using the differential equation above,       Q  ğš·   =   Q  ğ   (  t  )    =    d  ğ   (  t  )     d  t    =  0â€‰.          Q  ğš·     Q  ğ  t            d  ğ  t     d  t         0â€‰.     Q\mathbf{\Pi}=Q\mathbf{P}(t)=\frac{d\mathbf{P}(t)}{dt}=0\,.     Time reversibility  Definition : A stationary Markov process is time reversible if (in the steady state) the amount of change from state   x   x   x   to   y   y   y   is equal to the amount of change from   y   y   y   to   x   x   x   , (although the two states may occur with different frequencies). This means that:        Ï€  x    Î¼   x  y     =    Ï€  y    Î¼   y  x            subscript  Ï€  x    subscript  Î¼    x  y        subscript  Ï€  y    subscript  Î¼    y  x       \pi_{x}\mu_{xy}=\pi_{y}\mu_{yx}     Not all stationary processes are reversible, however, almost all DNA evolution models assume time reversibility, which is considered to be a reasonable assumption.  Under the time reversibility assumption, let     s   x  y    =    Î¼   x  y    /   Ï€  y         subscript  s    x  y       subscript  Î¼    x  y     subscript  Ï€  y      s_{xy}=\mu_{xy}/\pi_{y}   , then it is easy to see that:       s   x  y    =   s   y  x         subscript  s    x  y     subscript  s    y  x      s_{xy}=s_{yx}     Definition The symmetric term    s   x  y      subscript  s    x  y     s_{xy}   is called the exchangeability between states   x   x   x   and   y   y   y   . In other words,    s   x  y      subscript  s    x  y     s_{xy}   is the fraction of the frequency of state   x   x   x   that is the result of transitions from state   y   y   y   to state   x   x   x   .  Corollary The 12 off-diagonal entries of the rate matrix,   Q   Q   Q   (note the off-diagonal entries determine the diagonal entries, since the rows of   Q   Q   Q   sum to zero) can be completely determined by 9 numbers; these are: 6 exchangeability terms and 3 stationary frequencies    Ï€  x     subscript  Ï€  x    \pi_{x}   , (since the stationary frequencies sum to 1).  Scaling of branch lengths  By comparing extant sequences, one can determine the amount of sequence divergence. This raw measurement of divergence provides information about the number of changes that have occurred along the path separating the sequences. The simple count of differences (the Hamming distance ) between sequences will often underestimate the number of substitution because of multiple hits (see homoplasy ). Trying to estimate the exact number of changes that have occurred is difficult, and usually not necessary. Instead, branch lengths (and path lengths) in phylogenetic analyses are usually expressed in the expected number of changes per site. The path length is the product of the duration of the path in time and the mean rate of substitutions. While their product can be estimated, the rate and time are not identifiable from sequence divergence.  The descriptions of rate matrices on this page accurately reflect the relative magnitude of different substitutions, but these rate matrices are not scaled such that a branch length of 1 yields one expected change. This scaling can be accomplished by multiplying every element of the matrix by the same factor, or simply by scaling the branch lengths. If we use the Î² to denote the scaling factor, and Î½ to denote the branch length measured in the expected number of substitutions per site then Î²Î½ is used the transition probability formulae below in place of Î¼ t . Note that Î½ is a parameter to be estimated from data, and is referred to as the branch length, while Î² is simply a number that can be calculated from the rate matrix (it is not a separate free parameter).  The value of Î² can be found by forcing the expected rate of flux of states to 1. The diagonal entries of the rate-matrix (the Q matrix) represent -1 times the rate of leaving each state. For time-reversible models, we know the equilibrium state frequencies (these are simply the Ï€ i parameter value for state i ). Thus we can find the expected rate of change by calculating the sum of flux out of each state weighted by the proportion of sites that are expected to be in that class. Setting Î² to be the reciprocal of this sum will guarantee that scaled process has an expected flux of 1:      Î²  =   1  /   (   -    âˆ‘  i     Ï€  i    Î¼   i  i       )        Î²    1      subscript   i      subscript  Ï€  i    subscript  Î¼    i  i          \beta=1/\left(-\sum_{i}\pi_{i}\mu_{ii}\right)   For example, in the Jukes-Cantor, the scaling factor would be ''4/(3Î¼)' because the rate of leaving each state is 3Î¼/4 .  Most common models of DNA evolution  JC69 model ( Jukes and Cantor , 1969) 1  JC69 is the simplest substitution model . There are several assumptions. It assumes equal base frequencies    (    Ï€  A   =   Ï€  G   =   Ï€  C   =   Ï€  T   =   1  4    )         subscript  Ï€  A    subscript  Ï€  G         subscript  Ï€  C         subscript  Ï€  T          1  4      \left(\pi_{A}=\pi_{G}=\pi_{C}=\pi_{T}={1\over 4}\right)   and equal mutation rates . The only parameter of this model is therefore   Î¼   Î¼   \mu   , the overall substitution rate. As previously mentioned, this variable becomes a constant when we normalize to the mean-rate to 1.      Q  =   (     *      Î¼  4        Î¼  4        Î¼  4          Î¼  4      *      Î¼  4        Î¼  4          Î¼  4        Î¼  4      *      Î¼  4          Î¼  4        Î¼  4        Î¼  4      *     )       Q       Î¼  4     Î¼  4     Î¼  4       Î¼  4      Î¼  4     Î¼  4       Î¼  4     Î¼  4      Î¼  4       Î¼  4     Î¼  4     Î¼  4        Q=\begin{pmatrix}{*}&{\mu\over 4}&{\mu\over 4}&{\mu\over 4}\\
 {\mu\over 4}&{*}&{\mu\over 4}&{\mu\over 4}\\
 {\mu\over 4}&{\mu\over 4}&{*}&{\mu\over 4}\\
 {\mu\over 4}&{\mu\over 4}&{\mu\over 4}&{*}\end{pmatrix}         P  =   (        1  4    +     3  4     e   -   t  Î¼            1  4    -     1  4     e   -   t  Î¼            1  4    -     1  4     e   -   t  Î¼            1  4    -     1  4     e   -   t  Î¼                   1  4    -     1  4     e   -   t  Î¼            1  4    +     3  4     e   -   t  Î¼            1  4    -     1  4     e   -   t  Î¼            1  4    -     1  4     e   -   t  Î¼                   1  4    -     1  4     e   -   t  Î¼            1  4    -     1  4     e   -   t  Î¼            1  4    +     3  4     e   -   t  Î¼            1  4    -     1  4     e   -   t  Î¼                   1  4    -     1  4     e   -   t  Î¼            1  4    -     1  4     e   -   t  Î¼            1  4    -     1  4     e   -   t  Î¼            1  4    +     3  4     e   -   t  Î¼          )       P        1  4       3  4    superscript  e      t  Î¼           1  4       1  4    superscript  e      t  Î¼           1  4       1  4    superscript  e      t  Î¼           1  4       1  4    superscript  e      t  Î¼         absent        1  4       1  4    superscript  e      t  Î¼           1  4       3  4    superscript  e      t  Î¼           1  4       1  4    superscript  e      t  Î¼           1  4       1  4    superscript  e      t  Î¼         absent        1  4       1  4    superscript  e      t  Î¼           1  4       1  4    superscript  e      t  Î¼           1  4       3  4    superscript  e      t  Î¼           1  4       1  4    superscript  e      t  Î¼         absent        1  4       1  4    superscript  e      t  Î¼           1  4       1  4    superscript  e      t  Î¼           1  4       1  4    superscript  e      t  Î¼           1  4       3  4    superscript  e      t  Î¼           P=\begin{pmatrix}{{1\over 4}+{3\over 4}e^{-t\mu}}&{{1\over 4}-{1\over 4}e^{-t%
 \mu}}&{{1\over 4}-{1\over 4}e^{-t\mu}}&{{1\over 4}-{1\over 4}e^{-t\mu}}\\
 \\
 {{1\over 4}-{1\over 4}e^{-t\mu}}&{{1\over 4}+{3\over 4}e^{-t\mu}}&{{1\over 4}-%
 {1\over 4}e^{-t\mu}}&{{1\over 4}-{1\over 4}e^{-t\mu}}\\
 \\
 {{1\over 4}-{1\over 4}e^{-t\mu}}&{{1\over 4}-{1\over 4}e^{-t\mu}}&{{1\over 4}+%
 {3\over 4}e^{-t\mu}}&{{1\over 4}-{1\over 4}e^{-t\mu}}\\
 \\
 {{1\over 4}-{1\over 4}e^{-t\mu}}&{{1\over 4}-{1\over 4}e^{-t\mu}}&{{1\over 4}-%
 {1\over 4}e^{-t\mu}}&{{1\over 4}+{3\over 4}e^{-t\mu}}\end{pmatrix}     When branch length,   Î½   Î½   \nu   , is measured in the expected number of changes per site then:        P   i  j     (  Î½  )    =   {       1  4   +    3  4    e   -    4  Î½   /  3           if  i   =  j         1  4   -    1  4    e   -    4  Î½   /  3           if  i   â‰   j               subscript  P    i  j    Î½    cases        1  4       3  4    superscript  e        4  Î½   3           if  i   j         1  4       1  4    superscript  e        4  Î½   3           if  i   j        P_{ij}(\nu)=\left\{\begin{array}[]{cc}{1\over 4}+{3\over 4}e^{-4\nu/3}&\mbox{ %
 if }i=j\\
 {1\over 4}-{1\over 4}e^{-4\nu/3}&\mbox{ if }i\neq j\end{array}\right.     It is worth noticing that    Î½  =    3  4   t  Î¼   =    (    Î¼  4   +   Î¼  4   +   Î¼  4    )   t         Î½      3  4   t  Î¼              Î¼  4     Î¼  4     Î¼  4    t      \nu={3\over 4}t\mu=({\mu\over 4}+{\mu\over 4}+{\mu\over 4})t   what stands for sum of any column (or row) of matrix   Q   Q   Q   multiplied by time and thus means expected number of substitutions in time   t   t   t   (branch duration) for each particular site (per site) when the rate of substitution equals   Î¼   Î¼   \mu   .  Given the proportion   p   p   p   of sites that differ between the two sequences the Jukes-Cantor estimate of the evolutionary distance (in terms of the expected number of changes) between two sequences is given by       d  ^   =   -    3  4    ln   (   1  -    4  3   p    )      =   Î½  ^          normal-^  d         3  4       1      4  3   p             normal-^  Î½      \hat{d}=-{3\over 4}\ln({1-{4\over 3}p})=\hat{\nu}   The   p   p   p   in this formula is frequently referred to as the   p   p   p   -distance. It is a sufficient statistic for calculating the Jukes-Cantor distance correction, but is not sufficient for the calculation of the evolutionary distance under the more complex models that follow (also note that   p   p   p   used in subsequent formulae is not identical to the "   p   p   p   -distance").  K80 model ( Kimura , 1980) 2  The K80 model distinguishes between transitions (A  G, i.e. from purine to purine, or C  T, i.e. from pyrimidine to pyrimidine) and transversions (from purine to pyrimidine or vice versa). In Kimura's original description of the model the Î± and Î² were used to denote the rates of these types of substitutions, but it is now more common to set the rate of transversions to 1 and use Îº to denote the transition/transversion rate ratio (as is done below). The K80 model assumes that all of the bases are equally frequent ( Ï€ T =Ï€ C =Ï€ A =Ï€ G =0.25 ).  Rate matrix    Q  =   (     *    Îº    1    1      Îº    *    1    1      1    1    *    Îº      1    1    Îº    *     )       Q     Îº  1  1    Îº   1  1    1  1   Îº    1  1  Îº       Q=\begin{pmatrix}{*}&{\kappa}&{1}&{1}\\
 {\kappa}&{*}&{1}&{1}\\
 {1}&{1}&{*}&{\kappa}\\
 {1}&{1}&{\kappa}&{*}\end{pmatrix}     The Kimura two-parameter distance is given by:       d  ^   =    -    1  2    ln   (   1  -   2  p   -  q   )      -    1  4    ln   (   1  -   2  q    )           normal-^  d           1  2       1    2  p   q          1  4       1    2  q         \hat{d}=-{1\over 2}\ln(1-2p-q)-{1\over 4}\ln(1-2q)   where p is the proportion of sites that show transitional differences and q is the proportion of sites that show transversional differences.  F81 model ( Felsenstein 1981) 3  Felsenstein's 1981 model is an extension of the JC69 model in which base frequencies are allowed to vary from 0.25 (     Ï€  T   â‰    Ï€  C   â‰    Ï€  A   â‰    Ï€  G          subscript  Ï€  T    subscript  Ï€  C         subscript  Ï€  A         subscript  Ï€  G      \pi_{T}\neq\pi_{C}\neq\pi_{A}\neq\pi_{G}   )  Rate matrix:      Q  =   (     *     Ï€  C      Ï€  A      Ï€  G        Ï€  T     *     Ï€  A      Ï€  G        Ï€  T      Ï€  C     *     Ï€  G        Ï€  T      Ï€  C      Ï€  A     *     )       Q      subscript  Ï€  C    subscript  Ï€  A    subscript  Ï€  G      subscript  Ï€  T     subscript  Ï€  A    subscript  Ï€  G      subscript  Ï€  T    subscript  Ï€  C     subscript  Ï€  G      subscript  Ï€  T    subscript  Ï€  C    subscript  Ï€  A        Q=\begin{pmatrix}{*}&{\pi_{C}}&{\pi_{A}}&{\pi_{G}}\\
 {\pi_{T}}&{*}&{\pi_{A}}&{\pi_{G}}\\
 {\pi_{T}}&{\pi_{C}}&{*}&{\pi_{G}}\\
 {\pi_{T}}&{\pi_{C}}&{\pi_{A}}&{*}\end{pmatrix}     When branch length, Î½, is measured in the expected number of changes per site then:      Î²  =   1  /   (   1  -   Ï€  A  2   -   Ï€  C  2   -   Ï€  G  2   -   Ï€  T  2    )        Î²    1    1   superscript   subscript  Ï€  A   2    superscript   subscript  Ï€  C   2    superscript   subscript  Ï€  G   2    superscript   subscript  Ï€  T   2       \beta=1/(1-\pi_{A}^{2}-\pi_{C}^{2}-\pi_{G}^{2}-\pi_{T}^{2})           P   i  j     (  Î½  )    =   {       e   -   Î²  Î½     +    Ï€  j    (   1  -   e   -   Î²  Î½      )         if  i   =  j         Ï€  j    (   1  -   e   -   Î²  Î½      )        if  i   â‰   j               subscript  P    i  j    Î½    cases       superscript  e      Î²  Î½        subscript  Ï€  j     1   superscript  e      Î²  Î½            if  i   j        subscript  Ï€  j     1   superscript  e      Î²  Î½           if  i   j        P_{ij}(\nu)=\left\{\begin{array}[]{cc}e^{-\beta\nu}+\pi_{j}\left(1-e^{-\beta%
 \nu}\right)&\mbox{ if }i=j\\
 \pi_{j}\left(1-e^{-\beta\nu}\right)&\mbox{ if }i\neq j\end{array}\right.     HKY85 model (Hasegawa, Kishino and Yano 1985) 4  The HKY85 model can be thought of as combining the extensions made in the Kimura80 and Felsenstein81 models. Namely, it distinguishes between the rate of transitions and transversions (using the Îº parameter), and it allows unequal base frequencies (     Ï€  T   â‰    Ï€  C   â‰    Ï€  A   â‰    Ï€  G          subscript  Ï€  T    subscript  Ï€  C         subscript  Ï€  A         subscript  Ï€  G      \pi_{T}\neq\pi_{C}\neq\pi_{A}\neq\pi_{G}   ). [ Felsenstein described a similar (but not equivalent) model in 1984 using a different parameterization; 5 that latter model is referred to as the F84 model. 6 ]  Rate matrix    Q  =   (     *     Îº   Ï€  C       Ï€  A      Ï€  G        Îº   Ï€  T      *     Ï€  A      Ï€  G        Ï€  T      Ï€  C     *     Îº   Ï€  G         Ï€  T      Ï€  C      Îº   Ï€  A      *     )       Q       Îº   subscript  Ï€  C     subscript  Ï€  A    subscript  Ï€  G       Îº   subscript  Ï€  T      subscript  Ï€  A    subscript  Ï€  G      subscript  Ï€  T    subscript  Ï€  C      Îº   subscript  Ï€  G       subscript  Ï€  T    subscript  Ï€  C     Îº   subscript  Ï€  A         Q=\begin{pmatrix}{*}&{\kappa\pi_{C}}&{\pi_{A}}&{\pi_{G}}\\
 {\kappa\pi_{T}}&{*}&{\pi_{A}}&{\pi_{G}}\\
 {\pi_{T}}&{\pi_{C}}&{*}&{\kappa\pi_{G}}\\
 {\pi_{T}}&{\pi_{C}}&{\kappa\pi_{A}}&{*}\end{pmatrix}     If we express the branch length, Î½ in terms of the expected number of changes per site then:      Î²  =   1    2   (    Ï€  A   +   Ï€  G    )    (    Ï€  C   +   Ï€  T    )    +   2  Îº   [    (    Ï€  A    Ï€  G    )   +   (    Ï€  C    Ï€  T    )    ]          Î²    1      2     subscript  Ï€  A    subscript  Ï€  G       subscript  Ï€  C    subscript  Ï€  T       2  Îº   delimited-[]       subscript  Ï€  A    subscript  Ï€  G       subscript  Ï€  C    subscript  Ï€  T           \beta=\frac{1}{2(\pi_{A}+\pi_{G})(\pi_{C}+\pi_{T})+2\kappa[(\pi_{A}\pi_{G})+(%
 \pi_{C}\pi_{T})]}           P   A  A     (  Î½  ,  Îº  ,  Ï€  )    =    [     Ï€  A    (    Ï€  A   +   Ï€  G   +    (    Ï€  C   +   Ï€  T    )    e   -   Î²  Î½       )    +    Ï€  G    e   -    (   1  +    (    Ï€  A   +   Ï€  G    )    (   Îº  -  1.0   )     )   Î²  Î½       ]   /   (    Ï€  A   +   Ï€  G    )           subscript  P    A  A     Î½  Îº  Ï€       delimited-[]       subscript  Ï€  A      subscript  Ï€  A    subscript  Ï€  G        subscript  Ï€  C    subscript  Ï€  T     superscript  e      Î²  Î½           subscript  Ï€  G    superscript  e        1       subscript  Ï€  A    subscript  Ï€  G      Îº  1.0     Î²  Î½           subscript  Ï€  A    subscript  Ï€  G       P_{AA}(\nu,\kappa,\pi)=\left[\pi_{A}\left(\pi_{A}+\pi_{G}+(\pi_{C}+\pi_{T})e^{%
 -\beta\nu}\right)+\pi_{G}e^{-(1+(\pi_{A}+\pi_{G})(\kappa-1.0))\beta\nu}\right]%
 /(\pi_{A}+\pi_{G})           P   A  C     (  Î½  ,  Îº  ,  Ï€  )    =    Ï€  C    (   1.0  -   e   -   Î²  Î½      )           subscript  P    A  C     Î½  Îº  Ï€       subscript  Ï€  C     1.0   superscript  e      Î²  Î½         P_{AC}(\nu,\kappa,\pi)=\pi_{C}\left(1.0-e^{-\beta\nu}\right)           P   A  G     (  Î½  ,  Îº  ,  Ï€  )    =    [     Ï€  G    (    Ï€  A   +   Ï€  G   +    (    Ï€  C   +   Ï€  T    )    e   -   Î²  Î½       )    -    Ï€  G    e   -    (   1  +    (    Ï€  A   +   Ï€  G    )    (   Îº  -  1.0   )     )   Î²  Î½       ]   /   (    Ï€  A   +   Ï€  G    )           subscript  P    A  G     Î½  Îº  Ï€       delimited-[]       subscript  Ï€  G      subscript  Ï€  A    subscript  Ï€  G        subscript  Ï€  C    subscript  Ï€  T     superscript  e      Î²  Î½           subscript  Ï€  G    superscript  e        1       subscript  Ï€  A    subscript  Ï€  G      Îº  1.0     Î²  Î½           subscript  Ï€  A    subscript  Ï€  G       P_{AG}(\nu,\kappa,\pi)=\left[\pi_{G}\left(\pi_{A}+\pi_{G}+(\pi_{C}+\pi_{T})e^{%
 -\beta\nu}\right)-\pi_{G}e^{-(1+(\pi_{A}+\pi_{G})(\kappa-1.0))\beta\nu}\right]%
 /\left(\pi_{A}+\pi_{G}\right)           P   A  T     (  Î½  ,  Îº  ,  Ï€  )    =    Ï€  T    (   1.0  -   e   -   Î²  Î½      )           subscript  P    A  T     Î½  Îº  Ï€       subscript  Ï€  T     1.0   superscript  e      Î²  Î½         P_{AT}(\nu,\kappa,\pi)=\pi_{T}\left(1.0-e^{-\beta\nu}\right)   and formula for the other combinations of states can be obtained by substituting in the appropriate base frequencies.  T92 model (Tamura 1992) 7  T92 is a simple mathematical method developed to estimate the number of nucleotide substitutions per site between two DNA sequences, by extending Kimuraâ€™s (1980) two-parameter method to the case where a G+C-content bias exists. This method will be useful when there are strong transition-transversion and G+C-content biases, as in the case of Drosophila mitochondrial DNA. (Tamura 1992)  One frequency only    Ï€   G  C      subscript  Ï€    G  C     \pi_{GC}        Ï€  G   =   Ï€  C   =    Ï€   G  C    2          subscript  Ï€  G    subscript  Ï€  C           subscript  Ï€    G  C    2      \pi_{G}=\pi_{C}={\pi_{GC}\over 2}        Ï€  A   =   Ï€  T   =    (   1  -   Ï€   G  C     )   2          subscript  Ï€  A    subscript  Ï€  T            1   subscript  Ï€    G  C     2      \pi_{A}=\pi_{T}={(1-\pi_{GC})\over 2}     Rate matrix    Q  =   (     *      Îº   (   1  -   Ï€   G  C     )    /  2       (   1  -   Ï€   G  C     )   /  2       (   1  -   Ï€   G  C     )   /  2         Îº   Ï€   G  C     /  2     *      Ï€   G  C    /  2       Ï€   G  C    /  2         (   1  -   Ï€   G  C     )   /  2       (   1  -   Ï€   G  C     )   /  2     *      Îº   (   1  -   Ï€   G  C     )    /  2         Ï€   G  C    /  2       Ï€   G  C    /  2       Îº   Ï€   G  C     /  2     *     )       Q         Îº    1   subscript  Ï€    G  C      2       1   subscript  Ï€    G  C     2       1   subscript  Ï€    G  C     2         Îº   subscript  Ï€    G  C     2       subscript  Ï€    G  C    2      subscript  Ï€    G  C    2         1   subscript  Ï€    G  C     2       1   subscript  Ï€    G  C     2        Îº    1   subscript  Ï€    G  C      2        subscript  Ï€    G  C    2      subscript  Ï€    G  C    2       Îº   subscript  Ï€    G  C     2        Q=\begin{pmatrix}{*}&{\kappa(1-\pi_{GC})/2}&{(1-\pi_{GC})/2}&{(1-\pi_{GC})/2}%
 \\
 {\kappa\pi_{GC}/2}&{*}&{\pi_{GC}/2}&{\pi_{GC}/2}\\
 {(1-\pi_{GC})/2}&{(1-\pi_{GC})/2}&{*}&{\kappa(1-\pi_{GC})/2}\\
 {\pi_{GC}/2}&{\pi_{GC}/2}&{\kappa\pi_{GC}/2}&{*}\end{pmatrix}     The evolutionary distance between two noncoding sequences according to this model is given by      d  =    -   h   ln   (   1  -   p  h   -  q   )      -    1  2    (   1  -  h   )    ln   (   1  -   2  q    )          d        h      1    p  h   q          1  2     1  h       1    2  q         d=-h\ln(1-{p\over h}-q)-{1\over 2}(1-h)\ln(1-2q)   where    h  =   2  Î¸   (   1  -  Î¸   )        h    2  Î¸    1  Î¸      h=2\theta(1-\theta)   where    Î¸  âˆˆ   (  0  ,  1  )       Î¸   0  1     \theta\in(0,1)   is the GC content.  TN93 model (Tamura and Nei 1993) 8  The TN93 model distinguishes between the two different types of transition - i.e. (A  G) is allowed to have a different rate to (CT). Transversions are all assumed to occur at the same rate, but that rate is allowed to be different from both of the rates for transitions.  TN93 also allows unequal base frequencies (     Ï€  T   â‰    Ï€  C   â‰    Ï€  A   â‰    Ï€  G          subscript  Ï€  T    subscript  Ï€  C         subscript  Ï€  A         subscript  Ï€  G      \pi_{T}\neq\pi_{C}\neq\pi_{A}\neq\pi_{G}   ).  Rate matrix    Q  =   (     *      Îº  1    Ï€  C       Ï€  A      Ï€  G         Îº  1    Ï€  T      *     Ï€  A      Ï€  G        Ï€  T      Ï€  C     *      Îº  2    Ï€  G         Ï€  T      Ï€  C       Îº  2    Ï€  A      *     )       Q        subscript  Îº  1    subscript  Ï€  C     subscript  Ï€  A    subscript  Ï€  G        subscript  Îº  1    subscript  Ï€  T      subscript  Ï€  A    subscript  Ï€  G      subscript  Ï€  T    subscript  Ï€  C       subscript  Îº  2    subscript  Ï€  G       subscript  Ï€  T    subscript  Ï€  C      subscript  Îº  2    subscript  Ï€  A         Q=\begin{pmatrix}{*}&{\kappa_{1}\pi_{C}}&{\pi_{A}}&{\pi_{G}}\\
 {\kappa_{1}\pi_{T}}&{*}&{\pi_{A}}&{\pi_{G}}\\
 {\pi_{T}}&{\pi_{C}}&{*}&{\kappa_{2}\pi_{G}}\\
 {\pi_{T}}&{\pi_{C}}&{\kappa_{2}\pi_{A}}&{*}\end{pmatrix}     GTR: Generalised time-reversible ( TavarÃ© 1986) 9  GTR is the most general neutral, independent, finite-sites, time-reversible model possible. It was first described in a general form by Simon TavarÃ© in 1986. 10  The GTR parameters consist of an equilibrium base frequency vector,    Î   =   (   Ï€  1   ,   Ï€  2   ,   Ï€  3   ,   Ï€  4   )       normal-Î     subscript  Ï€  1    subscript  Ï€  2    subscript  Ï€  3    subscript  Ï€  4      \Pi=(\pi_{1},\pi_{2},\pi_{3},\pi_{4})   , giving the frequency at which each base occurs at each site, and the rate matrix      Q  =   (      -   (    Î±   Ï€  C    +   Î²   Ï€  A    +   Î³   Ï€  G     )       Î±   Ï€  C       Î²   Ï€  A       Î³   Ï€  G         Î±   Ï€  T       -   (    Î±   Ï€  T    +   Î´   Ï€  A    +   Ïµ   Ï€  G     )       Î´   Ï€  A       Ïµ   Ï€  G         Î²   Ï€  T       Î´   Ï€  C       -   (    Î²   Ï€  T    +   Î´   Ï€  C    +   Î·   Ï€  G     )       Î·   Ï€  G         Î³   Ï€  T       Ïµ   Ï€  C       Î·   Ï€  A       -   (    Î³   Ï€  T    +   Ïµ   Ï€  C    +   Î·   Ï€  A     )       )       Q          Î±   subscript  Ï€  C      Î²   subscript  Ï€  A      Î³   subscript  Ï€  G        Î±   subscript  Ï€  C      Î²   subscript  Ï€  A      Î³   subscript  Ï€  G        Î±   subscript  Ï€  T          Î±   subscript  Ï€  T      Î´   subscript  Ï€  A      Ïµ   subscript  Ï€  G        Î´   subscript  Ï€  A      Ïµ   subscript  Ï€  G        Î²   subscript  Ï€  T      Î´   subscript  Ï€  C          Î²   subscript  Ï€  T      Î´   subscript  Ï€  C      Î·   subscript  Ï€  G        Î·   subscript  Ï€  G        Î³   subscript  Ï€  T      Ïµ   subscript  Ï€  C      Î·   subscript  Ï€  A          Î³   subscript  Ï€  T      Ïµ   subscript  Ï€  C      Î·   subscript  Ï€  A          Q=\begin{pmatrix}{-(\alpha\pi_{C}+\beta\pi_{A}+\gamma\pi_{G})}&{\alpha\pi_{C}}%
 &{\beta\pi_{A}}&{\gamma\pi_{G}}\\
 {\alpha\pi_{T}}&{-(\alpha\pi_{T}+\delta\pi_{A}+\epsilon\pi_{G})}&{\delta\pi_{A%
 }}&{\epsilon\pi_{G}}\\
 {\beta\pi_{T}}&{\delta\pi_{C}}&{-(\beta\pi_{T}+\delta\pi_{C}+\eta\pi_{G})}&{%
 \eta\pi_{G}}\\
 {\gamma\pi_{T}}&{\epsilon\pi_{C}}&{\eta\pi_{A}}&{-(\gamma\pi_{T}+\epsilon\pi_{%
 C}+\eta\pi_{A})}\end{pmatrix}     Where         Î±  =  r   (  T  â†’  C  )   =  r   (  C  â†’  T  )         Î²  =  r   (  T  â†’  A  )   =  r   (  A  â†’  T  )         Î³  =  r   (  T  â†’  G  )   =  r   (  G  â†’  T  )         Î´  =  r   (  C  â†’  A  )   =  r   (  A  â†’  C  )         Ïµ  =  r   (  C  â†’  G  )   =  r   (  G  â†’  C  )         Î·  =  r   (  A  â†’  G  )   =  r   (  G  â†’  A  )           fragments  Î±   r   fragments  normal-(  T  normal-â†’  C  normal-)    r   fragments  normal-(  C  normal-â†’  T  normal-)       fragments  Î²   r   fragments  normal-(  T  normal-â†’  A  normal-)    r   fragments  normal-(  A  normal-â†’  T  normal-)       fragments  Î³   r   fragments  normal-(  T  normal-â†’  G  normal-)    r   fragments  normal-(  G  normal-â†’  T  normal-)       fragments  Î´   r   fragments  normal-(  C  normal-â†’  A  normal-)    r   fragments  normal-(  A  normal-â†’  C  normal-)       fragments  Ïµ   r   fragments  normal-(  C  normal-â†’  G  normal-)    r   fragments  normal-(  G  normal-â†’  C  normal-)       fragments  Î·   r   fragments  normal-(  A  normal-â†’  G  normal-)    r   fragments  normal-(  G  normal-â†’  A  normal-)       \begin{aligned}\displaystyle\alpha=r(T\rightarrow C)=r(C\rightarrow T)\\
 \displaystyle\beta=r(T\rightarrow A)=r(A\rightarrow T)\\
 \displaystyle\gamma=r(T\rightarrow G)=r(G\rightarrow T)\\
 \displaystyle\delta=r(C\rightarrow A)=r(A\rightarrow C)\\
 \displaystyle\epsilon=r(C\rightarrow G)=r(G\rightarrow C)\\
 \displaystyle\eta=r(A\rightarrow G)=r(G\rightarrow A)\end{aligned}     are the transition rate parameters.  Therefore, GTR (for four characters, as is often the case in phylogenetics) requires 6 substitution rate parameters, as well as 4 equilibrium base frequency parameters. However, this is usually eliminated down to 9 parameters plus   Î¼   Î¼   \mu   , the overall number of substitutions per unit time. When measuring time in substitutions (   Î¼   Î¼   \mu   =1) only 8 free parameters remain.  In general, to compute the number of parameters, one must count the number of entries above the diagonal in the matrix, i.e. for n trait values per site      n  2   -  n   2         superscript  n  2   n   2    {{n^{2}-n}\over 2}   , and then add n for the equilibrium base frequencies, and subtract 1 because   Î¼   Î¼   \mu   is fixed. One gets           n  2   -  n   2   +  n   -  1   =      1  2    n  2    +    1  2   n    -  1.                superscript  n  2   n   2   n   1           1  2    superscript  n  2        1  2   n    1.     {{n^{2}-n}\over 2}+n-1={1\over 2}n^{2}+{1\over 2}n-1.     For example, for an amino acid sequence (there are 20 "standard" amino acids that make up proteins ), one would find there are 209 parameters. However, when studying coding regions of the genome, it is more common to work with a codon substitution model (a codon is three bases and codes for one amino acid in a protein). There are     4  3   =  64       superscript  4  3   64    4^{3}=64   codons, but the rates for transitions between codons which differ by more than one base is assumed to be zero. Hence, there are        20  Ã—  19  Ã—  3   2   +  64   -  1   =  633              20  19  3   2   64   1   633    {{20\times 19\times 3}\over 2}+64-1=633   parameters.  See also   Molecular evolution  Molecular clock  UPGMA   References  Further reading      External links   DAWG: DNA Assembly With Gaps â€” free software for simulating sequence evolution   "  Category:Bioinformatics  Category:Phylogenetics  Category:Computational phylogenetics  Category:Markov models     â†©  â†©  â†©  â†©  â†©  â†©  â†©  â†©  â†©      
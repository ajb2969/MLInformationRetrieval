   Shanks transformation      Shanks transformation   In numerical analysis , the Shanks transformation is a non-linear  series acceleration method to increase the rate of convergence of a sequence . This method is named after Daniel Shanks , who rediscovered this sequence transformation in 1955. It was first derived and published by R. Schmidt in 1941. 1  Formulation  For a sequence     {   a  m   }    m  ∈  ℕ      subscript    subscript  a  m      m  ℕ     \left\{a_{m}\right\}_{m\in\mathbb{N}}   the series      A  =    ∑   m  =  0   ∞     a  m         A    superscript   subscript     m  0       subscript  a  m      A=\sum_{m=0}^{\infty}a_{m}\,     is to be determined. First, the partial sum    A  n     subscript  A  n    A_{n}   is defined as:       A  n   =    ∑   m  =  0   n     a  m          subscript  A  n     superscript   subscript     m  0    n    subscript  a  m      A_{n}=\sum_{m=0}^{n}a_{m}\,     and forms a new sequence     {   A  n   }    n  ∈  ℕ      subscript    subscript  A  n      n  ℕ     \left\{A_{n}\right\}_{n\in\mathbb{N}}   . Provided the series converges,    A  n     subscript  A  n    A_{n}   will also approach the limit   A   A   A   as     n  →  ∞   .     normal-→  n     n\to\infty.   The Shanks transformation    S   (   A  n   )       S   subscript  A  n     S(A_{n})   of the sequence    A  n     subscript  A  n    A_{n}   is defined as 2 3       S   (   A  n   )    =       A   n  +  1       A   n  -  1      -   A  n  2       A   n  +  1    -   2   A  n     +   A   n  -  1            S   subscript  A  n           subscript  A    n  1     subscript  A    n  1      superscript   subscript  A  n   2         subscript  A    n  1      2   subscript  A  n      subscript  A    n  1        S(A_{n})=\frac{A_{n+1}\,A_{n-1}\,-\,A_{n}^{2}}{A_{n+1}-2A_{n}+A_{n-1}}     and forms a new sequence. The sequence    S   (   A  n   )       S   subscript  A  n     S(A_{n})   often converges more rapidly than the sequence     A  n   .     subscript  A  n    A_{n}.   Further speed-up may be obtained by repeated use of the Shanks transformation, by computing       S  2    (   A  n   )    =   S   (   S   (   A  n   )    )     ,         superscript  S  2    subscript  A  n      S    S   subscript  A  n       S^{2}(A_{n})=S(S(A_{n})),          S  3    (   A  n   )    =   S   (   S   (   S   (   A  n   )    )    )     ,         superscript  S  3    subscript  A  n      S    S    S   subscript  A  n        S^{3}(A_{n})=S(S(S(A_{n}))),   etc.  Note that the non-linear transformation as used in the Shanks transformation is essentially the same as used in Aitken's delta-squared process . Both operate on a sequence, but the sequence the Shanks transformation operates on is usually thought of as being a sequence of partial sums, although any sequence may be viewed as a sequence of partial sums.  Example  As an example, consider the slowly convergent series 4       4    ∑   k  =  0   ∞      (   -  1   )   k    1    2  k   +  1       =   4   (      1  -   1  3    +   1  5    -   1  7    +  ⋯   )          4    superscript   subscript     k  0         superscript    1   k     1      2  k   1         4          1    1  3      1  5      1  7    normal-⋯      4\sum_{k=0}^{\infty}(-1)^{k}\frac{1}{2k+1}=4\left(1-\frac{1}{3}+\frac{1}{5}-%
 \frac{1}{7}+\cdots\right)     which has the exact sum π ≈ 3.14159265. The partial sum    A  6     subscript  A  6    A_{6}   has only one digit accuracy, while six-figure accuracy requires summing about 400,000 terms.  In the table below, the partial sums    A  n     subscript  A  n    A_{n}   , the Shanks transformation    S   (   A  n   )       S   subscript  A  n     S(A_{n})   on them, as well as the repeated Shanks transformations     S  2    (   A  n   )        superscript  S  2    subscript  A  n     S^{2}(A_{n})   and     S  3    (   A  n   )        superscript  S  3    subscript  A  n     S^{3}(A_{n})   are given for   n   n   n   up to 12. The figure to the right shows the absolute error for the partial sums and Shanks transformation results, clearly showing the improved accuracy and convergence rate.         n   n   n          A  n     subscript  A  n    A_{n}          S   (   A  n   )       S   subscript  A  n     S(A_{n})           S  2    (   A  n   )        superscript  S  2    subscript  A  n     S^{2}(A_{n})           S  3    (   A  n   )        superscript  S  3    subscript  A  n     S^{3}(A_{n})          0   4.00000000   —   —   —     1   2.66666667   3.16666667   —   —     2   3.46666667   3.13333333   3.14210526   —     3   2.89523810   3.14523810   3.14145022   3.14159936     4   3.33968254   3.13968254   3.14164332   3.14159086     5   2.97604618   3.14271284   3.14157129   3.14159323     6   3.28373848   3.14088134   3.14160284   3.14159244     7   3.01707182   3.14207182   3.14158732   3.14159274     8   3.25236593   3.14125482   3.14159566   3.14159261     9   3.04183962   3.14183962   3.14159086   3.14159267     10   3.23231581   3.14140672   3.14159377   3.14159264     11   3.05840277   3.14173610   3.14159192   3.14159266     12   3.21840277   3.14147969   3.14159314   3.14159265     The Shanks transformation    S   (   A  1   )       S   subscript  A  1     S(A_{1})   already has two-digit accuracy, while the original partial sums only establish the same accuracy at     A  24   .     subscript  A  24    A_{24}.   Remarkably,     S  3    (   A  3   )        superscript  S  3    subscript  A  3     S^{3}(A_{3})   has six digits accuracy, obtained from repeated Shank transformations applied to the first seven terms    A  0     subscript  A  0    A_{0}   , ... ,     A  6   .     subscript  A  6    A_{6}.   As said before,    A  n     subscript  A  n    A_{n}   only obtains 6-digit accuracy after about summing 400,000 terms.  Motivation  The Shanks transformation is motivated by the observation that — for larger   n   n   n   — the partial sum    A  n     subscript  A  n    A_{n}   quite often behaves approximately as 5        A  n   =   A  +   α   q  n      ,       subscript  A  n     A    α   superscript  q  n       A_{n}=A+\alpha q^{n},\,     with     |  q  |   <  1        q   1    |q|<1   so that the sequence converges transiently to the series result   A   A   A   for     n  →  ∞   .     normal-→  n     n\to\infty.   So for     n  -  1   ,      n  1    n-1,      n   n   n   and    n  +  1      n  1    n+1   the respective partial sums are:       A   n  -  1    =  A  +  α   q   n  -  1    ,   A  n   =  A  +  α   q  n   and   A   n  +  1    =  A  +  α   q   n  +  1    .     fragments   subscript  A    n  1     A   α   superscript  q    n  1     normal-,   subscript  A  n    A   α   superscript  q  n   italic-  and  italic-   subscript  A    n  1     A   α   superscript  q    n  1    normal-.    A_{n-1}=A+\alpha q^{n-1}\quad,\qquad A_{n}=A+\alpha q^{n}\qquad\text{and}%
 \qquad A_{n+1}=A+\alpha q^{n+1}.     These three equations contain three unknowns    A  ,    A   A,      α   α   \alpha   and    q  .    q   q.   Solving for   A   A   A   gives 6       A  =       A   n  +  1       A   n  -  1      -   A  n  2       A   n  +  1    -   2   A  n     +   A   n  -  1       .      A         subscript  A    n  1     subscript  A    n  1      superscript   subscript  A  n   2         subscript  A    n  1      2   subscript  A  n      subscript  A    n  1        A=\frac{A_{n+1}\,A_{n-1}\,-\,A_{n}^{2}}{A_{n+1}-2A_{n}+A_{n-1}}.     In the (exceptional) case that the denominator is equal to zero: then     A  n   =  A       subscript  A  n   A    A_{n}=A   for all    n  .    n   n.     Generalized Shanks transformation  The generalized k th-order Shanks transformation is given as the ratio of the determinants : 7         S  k    (   A  n   )    =    |      A   n  -  k      ⋯     A   n  -  1       A  n        Δ   A   n  -  k       ⋯     Δ   A   n  -  1        Δ   A  n         Δ   A    n  -  k   +  1       ⋯     Δ   A  n       Δ   A   n  +  1         ⋮       ⋮    ⋮       Δ   A   n  -  1       ⋯     Δ   A    n  +  k   -  2        Δ   A    n  +  k   -  1        |    |     1    ⋯    1    1       Δ   A   n  -  k       ⋯     Δ   A   n  -  1        Δ   A  n         Δ   A    n  -  k   +  1       ⋯     Δ   A  n       Δ   A   n  +  1         ⋮       ⋮    ⋮       Δ   A   n  -  1       ⋯     Δ   A    n  +  k   -  2        Δ   A    n  +  k   -  1        |     ,         subscript  S  k    subscript  A  n           subscript  A    n  k    normal-⋯   subscript  A    n  1     subscript  A  n       normal-Δ   subscript  A    n  k     normal-⋯    normal-Δ   subscript  A    n  1       normal-Δ   subscript  A  n        normal-Δ   subscript  A      n  k   1     normal-⋯    normal-Δ   subscript  A  n      normal-Δ   subscript  A    n  1       normal-⋮  absent  normal-⋮  normal-⋮      normal-Δ   subscript  A    n  1     normal-⋯    normal-Δ   subscript  A      n  k   2       normal-Δ   subscript  A      n  k   1            1  normal-⋯  1  1      normal-Δ   subscript  A    n  k     normal-⋯    normal-Δ   subscript  A    n  1       normal-Δ   subscript  A  n        normal-Δ   subscript  A      n  k   1     normal-⋯    normal-Δ   subscript  A  n      normal-Δ   subscript  A    n  1       normal-⋮  absent  normal-⋮  normal-⋮      normal-Δ   subscript  A    n  1     normal-⋯    normal-Δ   subscript  A      n  k   2       normal-Δ   subscript  A      n  k   1           S_{k}(A_{n})=\frac{\begin{vmatrix}A_{n-k}&\cdots&A_{n-1}&A_{n}\\
 \Delta A_{n-k}&\cdots&\Delta A_{n-1}&\Delta A_{n}\\
 \Delta A_{n-k+1}&\cdots&\Delta A_{n}&\Delta A_{n+1}\\
 \vdots&&\vdots&\vdots\\
 \Delta A_{n-1}&\cdots&\Delta A_{n+k-2}&\Delta A_{n+k-1}\\
 \end{vmatrix}}{\begin{vmatrix}1&\cdots&1&1\\
 \Delta A_{n-k}&\cdots&\Delta A_{n-1}&\Delta A_{n}\\
 \Delta A_{n-k+1}&\cdots&\Delta A_{n}&\Delta A_{n+1}\\
 \vdots&&\vdots&\vdots\\
 \Delta A_{n-1}&\cdots&\Delta A_{n+k-2}&\Delta A_{n+k-1}\\
 \end{vmatrix}},   with      Δ   A  p    =    A   p  +  1    -   A  p     .        normal-Δ   subscript  A  p       subscript  A    p  1     subscript  A  p      \Delta A_{p}=A_{p+1}-A_{p}.   It is the solution of a model for the convergence behaviour of the partial sums    A  n     subscript  A  n    A_{n}   with   k   k   k   distinct transients:        A  n   =   A  +    ∑   p  =  1   k     α  p    q  p  n       .       subscript  A  n     A    superscript   subscript     p  1    k      subscript  α  p    superscript   subscript  q  p   n        A_{n}=A+\sum_{p=1}^{k}\alpha_{p}q_{p}^{n}.     This model for the convergence behaviour contains     2  k   +  1        2  k   1    2k+1   unknowns. By evaluating the above equation at the elements     A   n  -  k    ,   A    n  -  k   +  1    ,  …  ,   A   n  +  k        subscript  A    n  k     subscript  A      n  k   1    normal-…   subscript  A    n  k      A_{n-k},A_{n-k+1},\ldots,A_{n+k}   and solving for    A  ,    A   A,   the above expression for the k th-order Shanks transformation is obtained. The first-order generalized Shanks transformation is equal to the ordinary Shanks transformation       S  1    (   A  n   )    =   S   (   A  n   )     .         subscript  S  1    subscript  A  n      S   subscript  A  n      S_{1}(A_{n})=S(A_{n}).     The generalized Shanks transformation is closely related to Padé approximants and Padé tables . 8  See also   Aitken's delta-squared process  Rate of convergence  Richardson extrapolation  sequence transformation   Notes  References         "  Category:Numerical analysis  Category:Asymptotic analysis     Weniger (2003). ↩  Bender & Orszag (1999), pp. 368–375. ↩  Van Dyke (1975), pp. 202–205. ↩     Bender & Orszag (1999), pp. 389–392. ↩      
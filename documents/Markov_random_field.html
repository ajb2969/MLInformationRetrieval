<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="309">Markov random field</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Markov random field</h1>
<hr/>
<figure><b>(Figure)</b>
<figcaption>An example of a Markov random field. Each edge represents dependency. In this example: A depends on B and D. B depends on A and D. D depends on A, B, and E. E depends on D and C. C depends on E.</figcaption>
</figure>

<p>In the domain of <a class="uri" href="physics" title="wikilink">physics</a> and <a class="uri" href="probability" title="wikilink">probability</a>, a <strong>Markov random field</strong> (often abbreviated as <strong>MRF</strong>), <strong>Markov network</strong> or <strong>undirected <a href="graphical_model" title="wikilink">graphical model</a></strong> is a set of <a href="random_variable" title="wikilink">random variables</a> having a <a href="Markov_property" title="wikilink">Markov property</a> described by an <a href="undirected_graph" title="wikilink">undirected graph</a>. A Markov random field is similar to a <a href="Bayesian_network" title="wikilink">Bayesian network</a> in its representation of dependencies; the differences being that Bayesian networks are directed and acyclic, whereas Markov networks are undirected and may be cyclic. Thus, a Markov network can represent certain dependencies that a Bayesian network cannot (such as cyclic dependencies); on the other hand, it can't represent certain dependencies that a Bayesian network can (such as induced dependencies). The underlying graph of a Markov random field may be finite or infinite.</p>

<p>When the <a href="joint_probability_distribution" title="wikilink">joint probability density</a> of the random variables is strictly positive, it is also referred to as a <strong>Gibbs random field</strong>, because, according to the <a href="Hammersley–Clifford_theorem" title="wikilink">Hammersley–Clifford theorem</a>, it can then be represented by a <a href="Gibbs_measure" title="wikilink">Gibbs measure</a> for an appropriate (locally defined) energy function. The prototypical Markov random field is the <a href="Ising_model" title="wikilink">Ising model</a>; indeed, the Markov random field was introduced as the general setting for the <a href="Ising_model" title="wikilink">Ising model</a>.<a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a> In the domain of <a href="artificial_intelligence" title="wikilink">artificial intelligence</a>, a Markov random field is used to model various low- to mid-level tasks in <a href="image_processing" title="wikilink">image processing</a> and <a href="computer_vision" title="wikilink">computer vision</a>.<a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a> For example, MRFs are used for <a href="image_restoration" title="wikilink">image restoration</a>, image completion, <a href="Segmentation_(image_processing)" title="wikilink">segmentation</a>, <a href="image_registration" title="wikilink">image registration</a>, <a href="texture_synthesis" title="wikilink">texture synthesis</a>, <a class="uri" href="super-resolution" title="wikilink">super-resolution</a>, <a href="Computer_stereo_vision" title="wikilink">stereo matching</a> and <a href="Information_Retrieval" title="wikilink">information retrieval</a>.</p>
<h2 id="definition">Definition</h2>

<p>Given an <a href="undirected_graph" title="wikilink">undirected graph</a> <em>G</em> = (<em>V</em>, <em>E</em>), a set of <a href="random_variable" title="wikilink">random variables</a> <em>X</em> = (<em>X</em><sub><em>v</em></sub>)<sub><em>v</em> ∈ <em>V</em></sub> indexed by <em>V</em>  form a Markov random field with respect to <em>G</em>  if they satisfy the local <a href="Markov_property" title="wikilink">Markov properties</a>:</p>
<dl>
<dd><strong>Pairwise Markov property</strong>: Any two non-adjacent variables are <a href="conditional_independence" title="wikilink">conditionally independent</a> given all other variables:
</dd>
</dl>
<dl>
<dd><dl>
<dd>

<math display="inline" id="Markov_random_field:0">
 <semantics>
  <mrow>
   <msub>
    <mi>X</mi>
    <mi>u</mi>
   </msub>
   <mo rspace="0pt">⟂</mo>
   <mo>⟂</mo>
   <msub>
    <mi>X</mi>
    <mi>v</mi>
   </msub>
   <mo>∣</mo>
   <msub>
    <mi>X</mi>
    <mrow>
     <mi>V</mi>
     <mo>∖</mo>
     <mrow>
      <mo stretchy="false">{</mo>
      <mi>u</mi>
      <mo>,</mo>
      <mi>v</mi>
      <mo stretchy="false">}</mo>
     </mrow>
    </mrow>
   </msub>
   <mtext>if</mtext>
   <mrow>
    <mo stretchy="false">{</mo>
    <mi>u</mi>
    <mo>,</mo>
    <mi>v</mi>
    <mo stretchy="false">}</mo>
   </mrow>
   <mo>∉</mo>
   <mi>E</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>X</ci>
     <ci>u</ci>
    </apply>
    <csymbol cd="latexml">perpendicular-to</csymbol>
    <csymbol cd="latexml">perpendicular-to</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>X</ci>
     <ci>v</ci>
    </apply>
    <ci>normal-∣</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>X</ci>
     <apply>
      <setdiff></setdiff>
      <ci>V</ci>
      <set>
       <ci>u</ci>
       <ci>v</ci>
      </set>
     </apply>
    </apply>
    <ci></ci>
    <mtext>if</mtext>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-{</ci>
     <csymbol cd="unknown">u</csymbol>
     <ci>normal-,</ci>
     <csymbol cd="unknown">v</csymbol>
     <ci>normal-}</ci>
    </cerror>
    <notin></notin>
    <csymbol cd="unknown">E</csymbol>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   X_{u}\perp\!\!\!\perp X_{v}\mid X_{V\setminus\{u,v\}}\quad\text{if }\{u,v\}\notin
E
  </annotation>
 </semantics>
</math>


</dd>
</dl>
</dd>
</dl>
<dl>
<dd><strong>Local Markov property</strong>: A variable is conditionally independent of all other variables given its neighbors:
</dd>
</dl>
<dl>
<dd><dl>
<dd>

<math display="inline" id="Markov_random_field:1">
 <semantics>
  <mrow>
   <msub>
    <mi>X</mi>
    <mi>v</mi>
   </msub>
   <mo rspace="0pt">⟂</mo>
   <mo>⟂</mo>
   <msub>
    <mi>X</mi>
    <mrow>
     <mi>V</mi>
     <mo>∖</mo>
     <mrow>
      <mo>cl</mo>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>v</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mrow>
   </msub>
   <mo>∣</mo>
   <msub>
    <mi>X</mi>
    <mrow>
     <mo>ne</mo>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>v</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>X</ci>
     <ci>v</ci>
    </apply>
    <csymbol cd="latexml">perpendicular-to</csymbol>
    <csymbol cd="latexml">perpendicular-to</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>X</ci>
     <apply>
      <setdiff></setdiff>
      <ci>V</ci>
      <apply>
       <ci>cl</ci>
       <ci>v</ci>
      </apply>
     </apply>
    </apply>
    <ci>normal-∣</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>X</ci>
     <apply>
      <ci>ne</ci>
      <ci>v</ci>
     </apply>
    </apply>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   X_{v}\perp\!\!\!\perp X_{V\setminus\operatorname{cl}(v)}\mid X_{\operatorname{%
ne}(v)}
  </annotation>
 </semantics>
</math>


</dd>
</dl>
</dd>
<dd>where ne(<em>v</em>) is the set of neighbors of <em>v</em>, and cl(<em>v</em>) = {<em>v</em>} ∪ ne(<em>v</em>) is the <a href="Neighborhood_(graph_theory)" title="wikilink">closed neighbourhood</a> of <em>v</em>.
</dd>
</dl>
<dl>
<dd><strong>Global Markov property</strong>: Any two subsets of variables are conditionally independent given a separating subset:
</dd>
</dl>
<dl>
<dd><dl>
<dd>

<math display="inline" id="Markov_random_field:2">
 <semantics>
  <mrow>
   <msub>
    <mi>X</mi>
    <mi>A</mi>
   </msub>
   <mo rspace="0pt">⟂</mo>
   <mo>⟂</mo>
   <msub>
    <mi>X</mi>
    <mi>B</mi>
   </msub>
   <mo>∣</mo>
   <msub>
    <mi>X</mi>
    <mi>S</mi>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>X</ci>
     <ci>A</ci>
    </apply>
    <csymbol cd="latexml">perpendicular-to</csymbol>
    <csymbol cd="latexml">perpendicular-to</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>X</ci>
     <ci>B</ci>
    </apply>
    <ci>normal-∣</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>X</ci>
     <ci>S</ci>
    </apply>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   X_{A}\perp\!\!\!\perp X_{B}\mid X_{S}
  </annotation>
 </semantics>
</math>


</dd>
</dl>
</dd>
<dd>where every path from a node in <em>A</em> to a node in <em>B</em> passes through <em>S</em>.
</dd>
</dl>

<p>The above three <a href="Markov_property" title="wikilink">Markov properties</a> are not equivalent: The Local Markov property is stronger than the Pairwise one, while weaker than the Global one.</p>
<h2 id="clique-factorization">Clique factorization</h2>

<p>As the Markov properties of an arbitrary probability distribution can be difficult to establish, a commonly used class of Markov random fields are those that can be factorized according to the <a href="Clique_(graph_theory)" title="wikilink">cliques</a> of the graph.</p>

<p>Given a set of random variables <em>X</em> = (<em>X</em><sub><em>v</em></sub>)<sub><em>v</em> ∈ <em>V</em></sub>, let <em>P</em>(<em>X</em> = <em>x</em>) be the <a href="Probability_density_function" title="wikilink">probability</a> of a particular field configuration <em>x</em> in <em>X</em>. That is, <em>P</em>(<em>X</em> = <em>x</em>) is the probability of finding that the random variables <em>X</em> take on the particular value <em>x</em>. Because <em>X</em> is a set, the probability of <em>x</em> should be understood to be taken with respect to a <em>joint distribution</em> of the X<sub>v</sub>.</p>

<p>If this joint density can be factorized over the <a href="Clique_(graph_theory)" title="wikilink">cliques</a> of <em>G</em>:</p>

<p>

<math display="block" id="Markov_random_field:3">
 <semantics>
  <mrow>
   <mi>P</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>X</mi>
    <mo>=</mo>
    <mi>x</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>=</mo>
   <munder>
    <mo largeop="true" movablelimits="false" symmetric="true">∏</mo>
    <mrow>
     <mi>C</mi>
     <mo>∈</mo>
     <mrow>
      <mo>cl</mo>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>G</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mrow>
   </munder>
   <msub>
    <mi>ϕ</mi>
    <mi>C</mi>
   </msub>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>x</mi>
     <mi>C</mi>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">P</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">X</csymbol>
     <eq></eq>
     <csymbol cd="unknown">x</csymbol>
     <ci>normal-)</ci>
    </cerror>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <csymbol cd="latexml">product</csymbol>
     <apply>
      <in></in>
      <ci>C</ci>
      <apply>
       <ci>cl</ci>
       <ci>G</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>ϕ</ci>
     <ci>C</ci>
    </apply>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <ci>C</ci>
     </apply>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   P(X=x)=\prod_{C\in\operatorname{cl}(G)}\phi_{C}(x_{C})
  </annotation>
 </semantics>
</math>

</p>

<p>then <em>X</em> forms a Markov random field with respect to <em>G</em>. Here, cl(<em>G</em>) is the set of cliques of <em>G</em>. The definition is equivalent if only maximal cliques are used. The functions <em>φ</em><sub><em>C</em></sub> are sometimes referred to as <em>factor potentials</em> or <em>clique potentials</em>. Note, however, conflicting terminology is in use: the word <em>potential</em> is often applied to the logarithm of <em>φ</em><sub><em>C</em></sub>. This is because, in <a href="statistical_mechanics" title="wikilink">statistical mechanics</a>, log(<em>φ</em><sub><em>C</em></sub>) has a direct interpretation as the <a href="potential_energy" title="wikilink">potential energy</a> of a <a href="configuration_space" title="wikilink">configuration</a> <em>x</em><sub><em>C</em></sub>.</p>

<p>Although some MRFs do not factorize (a simple example can be constructed on a cycle of 4 nodes<a class="footnoteRef" href="#fn3" id="fnref3"><sup>3</sup></a>), in certain cases they can be shown to be equivalent conditions:</p>
<ul>
<li>if the density is positive (by the <a href="Hammersley–Clifford_theorem" title="wikilink">Hammersley–Clifford theorem</a>),</li>
<li>if the graph is <a href="Chordal_graph" title="wikilink">chordal</a> (by equivalence to a <a href="Bayesian_network" title="wikilink">Bayesian network</a>).</li>
</ul>

<p>When such a factorization does exist, it is possible to construct a <a href="factor_graph" title="wikilink">factor graph</a> for the network.</p>
<h2 id="logistic-model">Logistic model</h2>

<p>Any Markov random field (with a strictly positive density) can be written as <a href="log-linear_model" title="wikilink">log-linear model</a> with feature functions 

<math display="inline" id="Markov_random_field:4">
 <semantics>
  <msub>
   <mi>f</mi>
   <mi>k</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>f</ci>
    <ci>k</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f_{k}
  </annotation>
 </semantics>
</math>

 such that the full-joint distribution can be written as</p>

<p>

<math display="block" id="Markov_random_field:5">
 <semantics>
  <mrow>
   <mi>P</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>X</mi>
    <mo>=</mo>
    <mi>x</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>=</mo>
   <mfrac>
    <mn>1</mn>
    <mi>Z</mi>
   </mfrac>
   <mi>exp</mi>
   <mrow>
    <mo>(</mo>
    <munder>
     <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
     <mi>k</mi>
    </munder>
    <msubsup>
     <mi>w</mi>
     <mi>k</mi>
     <mo>⊤</mo>
    </msubsup>
    <msub>
     <mi>f</mi>
     <mi>k</mi>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <msub>
      <mi>x</mi>
      <mrow>
       <mo stretchy="false">{</mo>
       <mi>k</mi>
       <mo stretchy="false">}</mo>
      </mrow>
     </msub>
     <mo stretchy="false">)</mo>
    </mrow>
    <mo>)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">P</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">X</csymbol>
     <eq></eq>
     <csymbol cd="unknown">x</csymbol>
     <ci>normal-)</ci>
    </cerror>
    <eq></eq>
    <apply>
     <divide></divide>
     <cn type="integer">1</cn>
     <ci>Z</ci>
    </apply>
    <exp></exp>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <sum></sum>
      <ci>k</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>w</ci>
       <ci>k</ci>
      </apply>
      <csymbol cd="latexml">top</csymbol>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>f</ci>
      <ci>k</ci>
     </apply>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <ci>normal-(</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <set>
        <ci>k</ci>
       </set>
      </apply>
      <ci>normal-)</ci>
     </cerror>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   P(X=x)=\frac{1}{Z}\exp\left(\sum_{k}w_{k}^{\top}f_{k}(x_{\{k\}})\right)
  </annotation>
 </semantics>
</math>

 where the notation</p>

<p>

<math display="block" id="Markov_random_field:6">
 <semantics>
  <mrow>
   <mrow>
    <msubsup>
     <mi>w</mi>
     <mi>k</mi>
     <mo>⊤</mo>
    </msubsup>
    <msub>
     <mi>f</mi>
     <mi>k</mi>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <msub>
      <mi>x</mi>
      <mrow>
       <mo stretchy="false">{</mo>
       <mi>k</mi>
       <mo stretchy="false">}</mo>
      </mrow>
     </msub>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <munderover>
     <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
     <mrow>
      <mi>i</mi>
      <mo>=</mo>
      <mn>1</mn>
     </mrow>
     <msub>
      <mi>N</mi>
      <mi>k</mi>
     </msub>
    </munderover>
    <mrow>
     <mrow>
      <msub>
       <mi>w</mi>
       <mrow>
        <mi>k</mi>
        <mo>,</mo>
        <mi>i</mi>
       </mrow>
      </msub>
      <mo>⋅</mo>
      <msub>
       <mi>f</mi>
       <mrow>
        <mi>k</mi>
        <mo>,</mo>
        <mi>i</mi>
       </mrow>
      </msub>
     </mrow>
     <mrow>
      <mo stretchy="false">(</mo>
      <msub>
       <mi>x</mi>
       <mrow>
        <mo stretchy="false">{</mo>
        <mi>k</mi>
        <mo stretchy="false">}</mo>
       </mrow>
      </msub>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>w</ci>
       <ci>k</ci>
      </apply>
      <csymbol cd="latexml">top</csymbol>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>f</ci>
      <ci>k</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <set>
       <ci>k</ci>
      </set>
     </apply>
    </apply>
    <apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <apply>
        <eq></eq>
        <ci>i</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>N</ci>
       <ci>k</ci>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <ci>normal-⋅</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>w</ci>
        <list>
         <ci>k</ci>
         <ci>i</ci>
        </list>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>f</ci>
        <list>
         <ci>k</ci>
         <ci>i</ci>
        </list>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <set>
        <ci>k</ci>
       </set>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   w_{k}^{\top}f_{k}(x_{\{k\}})=\sum_{i=1}^{N_{k}}w_{k,i}\cdot f_{k,i}(x_{\{k\}})
  </annotation>
 </semantics>
</math>

 is simply a <a href="dot_product" title="wikilink">dot product</a> over field configurations, and <em>Z</em> is the <a href="partition_function_(mathematics)" title="wikilink">partition function</a>:</p>

<p>

<math display="block" id="Markov_random_field:7">
 <semantics>
  <mrow>
   <mrow>
    <mi>Z</mi>
    <mo>=</mo>
    <mrow>
     <munder>
      <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
      <mrow>
       <mi>x</mi>
       <mo>∈</mo>
       <mi class="ltx_font_mathcaligraphic">𝒳</mi>
      </mrow>
     </munder>
     <mrow>
      <mi>exp</mi>
      <mrow>
       <mo>(</mo>
       <mrow>
        <munder>
         <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
         <mi>k</mi>
        </munder>
        <mrow>
         <msubsup>
          <mi>w</mi>
          <mi>k</mi>
          <mo>⊤</mo>
         </msubsup>
         <msub>
          <mi>f</mi>
          <mi>k</mi>
         </msub>
         <mrow>
          <mo stretchy="false">(</mo>
          <msub>
           <mi>x</mi>
           <mrow>
            <mo stretchy="false">{</mo>
            <mi>k</mi>
            <mo stretchy="false">}</mo>
           </mrow>
          </msub>
          <mo stretchy="false">)</mo>
         </mrow>
        </mrow>
       </mrow>
       <mo>)</mo>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>Z</ci>
    <apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <sum></sum>
      <apply>
       <in></in>
       <ci>x</ci>
       <ci>𝒳</ci>
      </apply>
     </apply>
     <apply>
      <exp></exp>
      <apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <ci>k</ci>
       </apply>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>w</ci>
          <ci>k</ci>
         </apply>
         <csymbol cd="latexml">top</csymbol>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>f</ci>
         <ci>k</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>x</ci>
         <set>
          <ci>k</ci>
         </set>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Z=\sum_{x\in\mathcal{X}}\exp\left(\sum_{k}w_{k}^{\top}f_{k}(x_{\{k\}})\right).
  </annotation>
 </semantics>
</math>

</p>

<p>Here, 

<math display="inline" id="Markov_random_field:8">
 <semantics>
  <mi class="ltx_font_mathcaligraphic">𝒳</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>𝒳</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathcal{X}
  </annotation>
 </semantics>
</math>

 denotes the set of all possible assignments of values to all the network's random variables. Usually, the feature functions 

<math display="inline" id="Markov_random_field:9">
 <semantics>
  <msub>
   <mi>f</mi>
   <mrow>
    <mi>k</mi>
    <mo>,</mo>
    <mi>i</mi>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>f</ci>
    <list>
     <ci>k</ci>
     <ci>i</ci>
    </list>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f_{k,i}
  </annotation>
 </semantics>
</math>

 are defined such that they are <a href="indicator_function" title="wikilink">indicators</a> of the clique's configuration, <em>i.e.</em> 

<math display="inline" id="Markov_random_field:10">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>f</mi>
     <mrow>
      <mi>k</mi>
      <mo>,</mo>
      <mi>i</mi>
     </mrow>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <msub>
      <mi>x</mi>
      <mrow>
       <mo stretchy="false">{</mo>
       <mi>k</mi>
       <mo stretchy="false">}</mo>
      </mrow>
     </msub>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>f</ci>
      <list>
       <ci>k</ci>
       <ci>i</ci>
      </list>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <set>
       <ci>k</ci>
      </set>
     </apply>
    </apply>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f_{k,i}(x_{\{k\}})=1
  </annotation>
 </semantics>
</math>

 if 

<math display="inline" id="Markov_random_field:11">
 <semantics>
  <msub>
   <mi>x</mi>
   <mrow>
    <mo stretchy="false">{</mo>
    <mi>k</mi>
    <mo stretchy="false">}</mo>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>x</ci>
    <set>
     <ci>k</ci>
    </set>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x_{\{k\}}
  </annotation>
 </semantics>
</math>

 corresponds to the <em>i</em>-th possible configuration of the <em>k</em>-th clique and 0 otherwise. This model is equivalent to the clique factorization model given above, if 

<math display="inline" id="Markov_random_field:12">
 <semantics>
  <mrow>
   <msub>
    <mi>N</mi>
    <mi>k</mi>
   </msub>
   <mo>=</mo>
   <mrow>
    <mo stretchy="false">|</mo>
    <mrow>
     <mo>dom</mo>
     <mrow>
      <mo stretchy="false">(</mo>
      <msub>
       <mi>C</mi>
       <mi>k</mi>
      </msub>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo stretchy="false">|</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>N</ci>
     <ci>k</ci>
    </apply>
    <apply>
     <abs></abs>
     <apply>
      <ci>dom</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>C</ci>
       <ci>k</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   N_{k}=|\operatorname{dom}(C_{k})|
  </annotation>
 </semantics>
</math>

 is the cardinality of the clique, and the weight of a feature 

<math display="inline" id="Markov_random_field:13">
 <semantics>
  <msub>
   <mi>f</mi>
   <mrow>
    <mi>k</mi>
    <mo>,</mo>
    <mi>i</mi>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>f</ci>
    <list>
     <ci>k</ci>
     <ci>i</ci>
    </list>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f_{k,i}
  </annotation>
 </semantics>
</math>

 corresponds to the logarithm of the corresponding clique factor, <em>i.e.</em> 

<math display="inline" id="Markov_random_field:14">
 <semantics>
  <mrow>
   <msub>
    <mi>w</mi>
    <mrow>
     <mi>k</mi>
     <mo>,</mo>
     <mi>i</mi>
    </mrow>
   </msub>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mi>log</mi>
     <mi>ϕ</mi>
    </mrow>
    <mrow>
     <mo stretchy="false">(</mo>
     <msub>
      <mi>c</mi>
      <mrow>
       <mi>k</mi>
       <mo>,</mo>
       <mi>i</mi>
      </mrow>
     </msub>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>w</ci>
     <list>
      <ci>k</ci>
      <ci>i</ci>
     </list>
    </apply>
    <apply>
     <times></times>
     <apply>
      <log></log>
      <ci>ϕ</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>c</ci>
      <list>
       <ci>k</ci>
       <ci>i</ci>
      </list>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   w_{k,i}=\log\phi(c_{k,i})
  </annotation>
 </semantics>
</math>

, where 

<math display="inline" id="Markov_random_field:15">
 <semantics>
  <msub>
   <mi>c</mi>
   <mrow>
    <mi>k</mi>
    <mo>,</mo>
    <mi>i</mi>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>c</ci>
    <list>
     <ci>k</ci>
     <ci>i</ci>
    </list>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   c_{k,i}
  </annotation>
 </semantics>
</math>

 is the <em>i</em>-th possible configuration of the <em>k</em>-th clique, <em>i.e.</em> the <em>i</em>-th value in the domain of the clique 

<math display="inline" id="Markov_random_field:16">
 <semantics>
  <msub>
   <mi>C</mi>
   <mi>k</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>C</ci>
    <ci>k</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   C_{k}
  </annotation>
 </semantics>
</math>

.</p>

<p>The probability <em>P</em> is often called the <a href="Gibbs_measure" title="wikilink">Gibbs measure</a>. This expression of a Markov field as a logistic model is only possible if all clique factors are non-zero, <em>i.e.</em> if none of the elements of 

<math display="inline" id="Markov_random_field:17">
 <semantics>
  <mi class="ltx_font_mathcaligraphic">𝒳</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>𝒳</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathcal{X}
  </annotation>
 </semantics>
</math>

 are assigned a probability of 0. This allows techniques from matrix algebra to be applied, <em>e.g.</em> that the <a href="trace_(linear_algebra)" title="wikilink">trace</a> of a matrix is log of the <a class="uri" href="determinant" title="wikilink">determinant</a>, with the matrix representation of a graph arising from the graph's <a href="incidence_matrix" title="wikilink">incidence matrix</a>.</p>

<p>The importance of the partition function <em>Z</em> is that many concepts from <a href="statistical_mechanics" title="wikilink">statistical mechanics</a>, such as <a class="uri" href="entropy" title="wikilink">entropy</a>, directly generalize to the case of Markov networks, and an <em>intuitive</em> understanding can thereby be gained. In addition, the partition function allows <a href="variational_method" title="wikilink">variational methods</a> to be applied to the solution of the problem: one can attach a driving force to one or more of the random variables, and explore the reaction of the network in response to this <a href="perturbation_theory" title="wikilink">perturbation</a>. Thus, for example, one may add a driving term <em>J</em><sub><em>v</em></sub>, for each vertex <em>v</em> of the graph, to the partition function to get:</p>

<p>

<math display="block" id="Markov_random_field:18">
 <semantics>
  <mrow>
   <mrow>
    <mi>Z</mi>
    <mrow>
     <mo stretchy="false">[</mo>
     <mi>J</mi>
     <mo stretchy="false">]</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <munder>
     <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
     <mrow>
      <mi>x</mi>
      <mo>∈</mo>
      <mi class="ltx_font_mathcaligraphic">𝒳</mi>
     </mrow>
    </munder>
    <mrow>
     <mi>exp</mi>
     <mrow>
      <mo>(</mo>
      <mrow>
       <mrow>
        <munder>
         <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
         <mi>k</mi>
        </munder>
        <mrow>
         <msubsup>
          <mi>w</mi>
          <mi>k</mi>
          <mo>⊤</mo>
         </msubsup>
         <msub>
          <mi>f</mi>
          <mi>k</mi>
         </msub>
         <mrow>
          <mo stretchy="false">(</mo>
          <msub>
           <mi>x</mi>
           <mrow>
            <mo stretchy="false">{</mo>
            <mi>k</mi>
            <mo stretchy="false">}</mo>
           </mrow>
          </msub>
          <mo stretchy="false">)</mo>
         </mrow>
        </mrow>
       </mrow>
       <mo>+</mo>
       <mrow>
        <munder>
         <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
         <mi>v</mi>
        </munder>
        <mrow>
         <msub>
          <mi>J</mi>
          <mi>v</mi>
         </msub>
         <msub>
          <mi>x</mi>
          <mi>v</mi>
         </msub>
        </mrow>
       </mrow>
      </mrow>
      <mo>)</mo>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>Z</ci>
     <apply>
      <csymbol cd="latexml">delimited-[]</csymbol>
      <ci>J</ci>
     </apply>
    </apply>
    <apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <sum></sum>
      <apply>
       <in></in>
       <ci>x</ci>
       <ci>𝒳</ci>
      </apply>
     </apply>
     <apply>
      <exp></exp>
      <apply>
       <plus></plus>
       <apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <sum></sum>
         <ci>k</ci>
        </apply>
        <apply>
         <times></times>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>w</ci>
           <ci>k</ci>
          </apply>
          <csymbol cd="latexml">top</csymbol>
         </apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>f</ci>
          <ci>k</ci>
         </apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>x</ci>
          <set>
           <ci>k</ci>
          </set>
         </apply>
        </apply>
       </apply>
       <apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <sum></sum>
         <ci>v</ci>
        </apply>
        <apply>
         <times></times>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>J</ci>
          <ci>v</ci>
         </apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>x</ci>
          <ci>v</ci>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Z[J]=\sum_{x\in\mathcal{X}}\exp\left(\sum_{k}w_{k}^{\top}f_{k}(x_{\{k\}})+\sum%
_{v}J_{v}x_{v}\right)
  </annotation>
 </semantics>
</math>

</p>

<p>Formally differentiating with respect to <em>J</em><sub><em>v</em></sub> gives the <a href="expectation_value" title="wikilink">expectation value</a> of the random variable <em>X</em><sub><em>v</em></sub> associated with the vertex <em>v</em>:</p>

<p>

<math display="block" id="Markov_random_field:19">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>E</mi>
     <mrow>
      <mo stretchy="false">[</mo>
      <msub>
       <mi>X</mi>
       <mi>v</mi>
      </msub>
      <mo stretchy="false">]</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <msub>
     <mrow>
      <mrow>
       <mfrac>
        <mn>1</mn>
        <mi>Z</mi>
       </mfrac>
       <mfrac>
        <mrow>
         <mrow>
          <mo>∂</mo>
          <mi>Z</mi>
         </mrow>
         <mrow>
          <mo stretchy="false">[</mo>
          <mi>J</mi>
          <mo stretchy="false">]</mo>
         </mrow>
        </mrow>
        <mrow>
         <mo>∂</mo>
         <msub>
          <mi>J</mi>
          <mi>v</mi>
         </msub>
        </mrow>
       </mfrac>
      </mrow>
      <mo fence="true">|</mo>
     </mrow>
     <mrow>
      <msub>
       <mi>J</mi>
       <mi>v</mi>
      </msub>
      <mo>=</mo>
      <mn>0</mn>
     </mrow>
    </msub>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>E</ci>
     <apply>
      <csymbol cd="latexml">delimited-[]</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>X</ci>
       <ci>v</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <csymbol cd="latexml">evaluated-at</csymbol>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <ci>Z</ci>
      </apply>
      <apply>
       <divide></divide>
       <apply>
        <times></times>
        <apply>
         <partialdiff></partialdiff>
         <ci>Z</ci>
        </apply>
        <apply>
         <csymbol cd="latexml">delimited-[]</csymbol>
         <ci>J</ci>
        </apply>
       </apply>
       <apply>
        <partialdiff></partialdiff>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>J</ci>
         <ci>v</ci>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <eq></eq>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>J</ci>
       <ci>v</ci>
      </apply>
      <cn type="integer">0</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   E[X_{v}]=\frac{1}{Z}\left.\frac{\partial Z[J]}{\partial J_{v}}\right|_{J_{v}=0}.
  </annotation>
 </semantics>
</math>

</p>

<p><a href="Correlation_function" title="wikilink">Correlation functions</a> are computed likewise; the two-point correlation is:</p>

<p>

<math display="block" id="Markov_random_field:20">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>C</mi>
     <mrow>
      <mo stretchy="false">[</mo>
      <msub>
       <mi>X</mi>
       <mi>u</mi>
      </msub>
      <mo>,</mo>
      <msub>
       <mi>X</mi>
       <mi>v</mi>
      </msub>
      <mo stretchy="false">]</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <msub>
     <mrow>
      <mrow>
       <mfrac>
        <mn>1</mn>
        <mi>Z</mi>
       </mfrac>
       <mfrac>
        <mrow>
         <mrow>
          <msup>
           <mo>∂</mo>
           <mn>2</mn>
          </msup>
          <mi>Z</mi>
         </mrow>
         <mrow>
          <mo stretchy="false">[</mo>
          <mi>J</mi>
          <mo stretchy="false">]</mo>
         </mrow>
        </mrow>
        <mrow>
         <mrow>
          <mo>∂</mo>
          <msub>
           <mi>J</mi>
           <mi>u</mi>
          </msub>
         </mrow>
         <mrow>
          <mo>∂</mo>
          <msub>
           <mi>J</mi>
           <mi>v</mi>
          </msub>
         </mrow>
        </mrow>
       </mfrac>
      </mrow>
      <mo fence="true">|</mo>
     </mrow>
     <mrow>
      <mrow>
       <msub>
        <mi>J</mi>
        <mi>u</mi>
       </msub>
       <mo>=</mo>
       <mn>0</mn>
      </mrow>
      <mo>,</mo>
      <mrow>
       <msub>
        <mi>J</mi>
        <mi>v</mi>
       </msub>
       <mo>=</mo>
       <mn>0</mn>
      </mrow>
     </mrow>
    </msub>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>C</ci>
     <interval closure="closed">
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>X</ci>
       <ci>u</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>X</ci>
       <ci>v</ci>
      </apply>
     </interval>
    </apply>
    <apply>
     <csymbol cd="latexml">evaluated-at</csymbol>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <ci>Z</ci>
      </apply>
      <apply>
       <divide></divide>
       <apply>
        <times></times>
        <apply>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <partialdiff></partialdiff>
          <cn type="integer">2</cn>
         </apply>
         <ci>Z</ci>
        </apply>
        <apply>
         <csymbol cd="latexml">delimited-[]</csymbol>
         <ci>J</ci>
        </apply>
       </apply>
       <apply>
        <times></times>
        <apply>
         <partialdiff></partialdiff>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>J</ci>
          <ci>u</ci>
         </apply>
        </apply>
        <apply>
         <partialdiff></partialdiff>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>J</ci>
          <ci>v</ci>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">formulae-sequence</csymbol>
      <apply>
       <eq></eq>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>J</ci>
        <ci>u</ci>
       </apply>
       <cn type="integer">0</cn>
      </apply>
      <apply>
       <eq></eq>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>J</ci>
        <ci>v</ci>
       </apply>
       <cn type="integer">0</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   C[X_{u},X_{v}]=\frac{1}{Z}\left.\frac{\partial^{2}Z[J]}{\partial J_{u}\partial
J%
_{v}}\right|_{J_{u}=0,J_{v}=0}.
  </annotation>
 </semantics>
</math>

</p>

<p>Log-linear models are especially convenient for their interpretation. A log-linear model can provide a much more compact representation for many distributions, especially when variables have large domains. They are convenient too because their negative <a href="Likelihood_function" title="wikilink">log likelihoods</a> are <a href="Convex_function" title="wikilink">convex</a>. Unfortunately, though the likelihood of a logistic Markov network is convex, evaluating the likelihood or gradient of the likelihood of a model requires inference in the model, which is in general computationally infeasible.</p>
<h2 id="examples">Examples</h2>
<h3 id="gaussian-markov-random-field">Gaussian Markov random field</h3>

<p>A <a href="multivariate_normal_distribution" title="wikilink">multivariate normal distribution</a> forms a Markov random field with respect to a graph <em>G</em> = (<em>V</em>, <em>E</em>) if the missing edges correspond to zeros on the <a href="precision_matrix" title="wikilink">precision matrix</a> (the inverse <a href="covariance_matrix" title="wikilink">covariance matrix</a>):</p>

<p>

<math display="block" id="Markov_random_field:21">
 <semantics>
  <mrow>
   <mi>X</mi>
   <mo>=</mo>
   <msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <msub>
      <mi>X</mi>
      <mi>v</mi>
     </msub>
     <mo stretchy="false">)</mo>
    </mrow>
    <mrow>
     <mi>v</mi>
     <mo>∈</mo>
     <mi>V</mi>
    </mrow>
   </msub>
   <mo>∼</mo>
   <mrow>
    <mi class="ltx_font_mathcaligraphic">𝒩</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>𝝁</mi>
     <mo>,</mo>
     <mi mathvariant="normal">Σ</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <ci>X</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>X</ci>
       <ci>v</ci>
      </apply>
      <apply>
       <in></in>
       <ci>v</ci>
       <ci>V</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <csymbol cd="latexml">similar-to</csymbol>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <ci>𝒩</ci>
      <interval closure="open">
       <ci>𝝁</ci>
       <ci>normal-Σ</ci>
      </interval>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   X=(X_{v})_{v\in V}\sim\mathcal{N}(\boldsymbol{\mu},\Sigma)
  </annotation>
 </semantics>
</math>

 such that</p>

<p>

<math display="block" id="Markov_random_field:22">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <msub>
      <mrow>
       <mo stretchy="false">(</mo>
       <msup>
        <mi mathvariant="normal">Σ</mi>
        <mrow>
         <mo>-</mo>
         <mn>1</mn>
        </mrow>
       </msup>
       <mo stretchy="false">)</mo>
      </mrow>
      <mrow>
       <mi>u</mi>
       <mi>v</mi>
      </mrow>
     </msub>
     <mo>=</mo>
     <mrow>
      <mn>0</mn>
      <mtext>if</mtext>
     </mrow>
    </mrow>
    <mrow>
     <mrow>
      <mo stretchy="false">{</mo>
      <mi>u</mi>
      <mo>,</mo>
      <mi>v</mi>
      <mo stretchy="false">}</mo>
     </mrow>
     <mo>∉</mo>
     <mi>E</mi>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>normal-Σ</ci>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <apply>
       <times></times>
       <ci>u</ci>
       <ci>v</ci>
      </apply>
     </apply>
     <list>
      <cn type="integer">0</cn>
      <mtext>if</mtext>
     </list>
    </apply>
    <apply>
     <notin></notin>
     <set>
      <ci>u</ci>
      <ci>v</ci>
     </set>
     <ci>E</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (\Sigma^{-1})_{uv}=0\quad\text{if}\quad\{u,v\}\notin E.
  </annotation>
 </semantics>
</math>

<a class="footnoteRef" href="#fn4" id="fnref4"><sup>4</sup></a></p>
<h2 id="inference">Inference</h2>

<p>As in a Bayesian network, one may calculate the <a href="conditional_distribution" title="wikilink">conditional distribution</a> of a set of nodes 

<math display="inline" id="Markov_random_field:23">
 <semantics>
  <mrow>
   <msup>
    <mi>V</mi>
    <mo>′</mo>
   </msup>
   <mo>=</mo>
   <mrow>
    <mo stretchy="false">{</mo>
    <msub>
     <mi>v</mi>
     <mn>1</mn>
    </msub>
    <mo>,</mo>
    <mi mathvariant="normal">…</mi>
    <mo>,</mo>
    <msub>
     <mi>v</mi>
     <mi>i</mi>
    </msub>
    <mo stretchy="false">}</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>V</ci>
     <ci>normal-′</ci>
    </apply>
    <set>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>v</ci>
      <cn type="integer">1</cn>
     </apply>
     <ci>normal-…</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>v</ci>
      <ci>i</ci>
     </apply>
    </set>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   V^{\prime}=\{v_{1},\ldots,v_{i}\}
  </annotation>
 </semantics>
</math>

 given values to another set of nodes 

<math display="inline" id="Markov_random_field:24">
 <semantics>
  <mrow>
   <msup>
    <mi>W</mi>
    <mo>′</mo>
   </msup>
   <mo>=</mo>
   <mrow>
    <mo stretchy="false">{</mo>
    <msub>
     <mi>w</mi>
     <mn>1</mn>
    </msub>
    <mo>,</mo>
    <mi mathvariant="normal">…</mi>
    <mo>,</mo>
    <msub>
     <mi>w</mi>
     <mi>j</mi>
    </msub>
    <mo stretchy="false">}</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>W</ci>
     <ci>normal-′</ci>
    </apply>
    <set>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>w</ci>
      <cn type="integer">1</cn>
     </apply>
     <ci>normal-…</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>w</ci>
      <ci>j</ci>
     </apply>
    </set>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   W^{\prime}=\{w_{1},\ldots,w_{j}\}
  </annotation>
 </semantics>
</math>

 in the Markov random field by summing over all possible assignments to 

<math display="inline" id="Markov_random_field:25">
 <semantics>
  <mrow>
   <mi>u</mi>
   <mo>∉</mo>
   <mrow>
    <msup>
     <mi>V</mi>
     <mo>′</mo>
    </msup>
    <mo>,</mo>
    <msup>
     <mi>W</mi>
     <mo>′</mo>
    </msup>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <notin></notin>
    <ci>u</ci>
    <list>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>V</ci>
      <ci>normal-′</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>W</ci>
      <ci>normal-′</ci>
     </apply>
    </list>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   u\notin V^{\prime},W^{\prime}
  </annotation>
 </semantics>
</math>

; this is called <a href="exact_inference" title="wikilink">exact inference</a>. However, exact inference is a <a href="Sharp-P-complete" title="wikilink">#P-complete</a> problem, and thus computationally intractable in the general case. Approximation techniques such as <a href="Markov_chain_Monte_Carlo" title="wikilink">Markov chain Monte Carlo</a> and loopy <a href="belief_propagation" title="wikilink">belief propagation</a> are often more feasible in practice. Some particular subclasses of MRFs, such as trees (see <a href="Chow–Liu_tree" title="wikilink">Chow–Liu tree</a>), have polynomial-time inference algorithms; discovering such subclasses is an active research topic. There are also subclasses of MRFs that permit efficient <a href="Maximum_a_posteriori" title="wikilink">MAP</a>, or most likely assignment, inference; examples of these include associative networks.<a class="footnoteRef" href="#fn5" id="fnref5"><sup>5</sup></a><a class="footnoteRef" href="#fn6" id="fnref6"><sup>6</sup></a> Another interesting sub-class is the one of decomposable models (when the graph is <a href="Chordal_graph" title="wikilink">chordal</a>): having a closed-form for the <a href="Maximum_likelihood_estimate" title="wikilink">MLE</a>, it is possible to discover a consistent structure for hundreds of variables.<a class="footnoteRef" href="#fn7" id="fnref7"><sup>7</sup></a></p>
<h2 id="conditional-random-fields">Conditional random fields</h2>

<p>One notable variant of a Markov random field is a <strong><a href="conditional_random_field" title="wikilink">conditional random field</a></strong>, in which each random variable may also be conditioned upon a set of global observations 

<math display="inline" id="Markov_random_field:26">
 <semantics>
  <mi>o</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>o</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   o
  </annotation>
 </semantics>
</math>

. In this model, each function 

<math display="inline" id="Markov_random_field:27">
 <semantics>
  <msub>
   <mi>ϕ</mi>
   <mi>k</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>ϕ</ci>
    <ci>k</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \phi_{k}
  </annotation>
 </semantics>
</math>

 is a mapping from all assignments to both the <a href="Clique_(graph_theory)" title="wikilink">clique</a> <em>k</em> and the observations 

<math display="inline" id="Markov_random_field:28">
 <semantics>
  <mi>o</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>o</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   o
  </annotation>
 </semantics>
</math>

 to the nonnegative real numbers. This form of the Markov network may be more appropriate for producing <a href="discriminative_model" title="wikilink">discriminative classifiers</a>, which do not model the distribution over the observations. CRFs were proposed by <a href="John_D._Lafferty" title="wikilink">John D. Lafferty</a>, <a href="Andrew_McCallum" title="wikilink">Andrew McCallum</a> and <a href="Fernando_C.N._Pereira" title="wikilink">Fernando C.N. Pereira</a> in 2001.<a class="footnoteRef" href="#fn8" id="fnref8"><sup>8</sup></a></p>
<h2 id="see-also">See also</h2>
<ul>
<li><a href="Maximum_entropy_method" title="wikilink">Maximum entropy method</a></li>
<li><a href="Hopfield_network" title="wikilink">Hopfield network</a></li>
<li><a href="Graphical_model" title="wikilink">Graphical model</a></li>
<li><a href="Markov_chain" title="wikilink">Markov chain</a></li>
<li><a href="Markov_logic_network" title="wikilink">Markov logic network</a></li>
<li><a href="Hammersley–Clifford_theorem" title="wikilink">Hammersley–Clifford theorem</a></li>
<li><a href="Interacting_particle_system" title="wikilink">Interacting particle system</a></li>
<li><a href="Stochastic_cellular_automata" title="wikilink">Probabilistic cellular automata</a></li>
<li><a href="Log-linear_analysis" title="wikilink">Log-linear analysis</a></li>
</ul>
<h2 id="references">References</h2>
<h2 id="external-links">External links</h2>
<ul>
<li><a href="https://bitbucket.org/rukletsov/b">MRF implementation in C++ for regular 2D lattices</a></li>
</ul>

<p>"</p>

<p><a href="Category:Graphical_models" title="wikilink">Category:Graphical models</a> <a href="Category:Markov_networks" title="wikilink"> </a> <a href="Category:Probability_theory" title="wikilink">Category:Probability theory</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1"><a href="#fnref1">↩</a></li>
<li id="fn2"><a href="#fnref2">↩</a></li>
<li id="fn3"><a href="#fnref3">↩</a></li>
<li id="fn4"><a href="#fnref4">↩</a></li>
<li id="fn5">.<a href="#fnref5">↩</a></li>
<li id="fn6">.<a href="#fnref6">↩</a></li>
<li id="fn7"><a href="#fnref7">↩</a></li>
<li id="fn8"><a href="#fnref8">↩</a></li>
</ol>
</section>
</body>
</html>

   G-test      G-test   In statistics , G -tests are likelihood-ratio or maximum likelihood  statistical significance tests that are increasingly being used in situations where chi-squared tests were previously recommended. 1  The general formula for G is       G  =   2    ∑  i     O  i   ⋅   ln   (    O  i    E  i    )        ,      G    2    subscript   i    normal-⋅   subscript  O  i        subscript  O  i    subscript  E  i          G=2\sum_{i}{O_{i}\cdot\ln\left(\frac{O_{i}}{E_{i}}\right)},     where O i is the observed frequency in a cell, E i is the expected frequency under the null hypothesis, ln denotes the natural logarithm , and the sum is taken over all non-empty cells.  G -tests have been recommended at least since the 1981 edition of the popular statistics textbook by Robert R. Sokal and F. James Rohlf . 2  Distribution and usage  Given the null hypothesis that the observed frequencies result from random sampling from a distribution with the given expected frequencies, the distribution of G is approximately a chi-squared distribution , with the same number of degrees of freedom as in the corresponding chi-squared test.  For very small samples the multinomial test for goodness of fit, and Fisher's exact test for contingency tables, or even Bayesian hypothesis selection are preferable to the G -test .  Relation to the chi-squared test  The commonly used chi-squared tests for goodness of fit to a distribution and for independence in contingency tables are in fact approximations of the log-likelihood ratio on which the G -tests are based. The general formula for Pearson's chi-squared test statistic is        χ  2   =    ∑  i      (    O  i   -   E  i    )   2    E  i      .       superscript  χ  2     subscript   i      superscript     subscript  O  i    subscript  E  i    2    subscript  E  i       \chi^{2}=\sum_{i}{\frac{\left(O_{i}-E_{i}\right)^{2}}{E_{i}}}.   The approximation of G by chi squared is obtained by a second order Taylor expansion of the natural logarithm around 1. This approximation was developed by Karl Pearson because at the time it was unduly laborious to calculate log-likelihood ratios. With the advent of electronic calculators and personal computers, this is no longer a problem. A derivation of how the chi-squared test is related to the G -test and likelihood ratios, including to a full Bayesian solution is provided in Hoey (2012). 3  For samples of a reasonable size, the G -test and the chi-squared test will lead to the same conclusions. However, the approximation to the theoretical chi-squared distribution for the G -test is better than for the Pearson's chi-squared test . 4 In cases where     O  i   >   2  ⋅   E  i         subscript  O  i    normal-⋅  2   subscript  E  i      O_{i}>2\cdot E_{i}   for some cell case the G -test is always better than the chi-squared test.  For testing goodness-of-fit the G -test is infinitely more efficient than the chi squared test in the sense of Bahadur, but the two tests are equally efficient in the sense of Pitman or in the sense of Hodge and Lehman. 5 6  Relation to Kullback–Leibler divergence  The G -test quantity is proportional to the Kullback–Leibler divergence of the empirical distribution from the theoretical distribution.  Relation to mutual information  For analysis of contingency tables the value of G can also be expressed in terms of mutual information .  Let      N  =    ∑   i  j      O   i  j          N    subscript     i  j     subscript  O    i  j       N=\sum_{ij}{O_{ij}}\;   ,      π    i  j    =     O   i  j    N         subscript  π    i  j       subscript  O    i  j    N     \;\pi_{ij}=\frac{O_{ij}}{N}\;   ,      π    i  .    =       ∑  j     O   i  j     N         subscript  π   fragments  i  normal-.        subscript   j    subscript  O    i  j     N     \;\pi_{i.}=\frac{\sum_{j}O_{ij}}{N}\;   , and      π    .  j    =       ∑  i     O   i  j     N         subscript  π   fragments  normal-.  j        subscript   i    subscript  O    i  j     N     \;\pi_{.j}=\frac{\sum_{i}O_{ij}}{N}\;   .  Then G can be expressed in several alternative forms:       G  =   2  ⋅  N  ⋅    ∑   i  j      π   i  j     (    ln   (   π   i  j    )    -   ln   (   π   i  .    )    -   ln   (   π   .  j    )     )       ,      G   normal-⋅  2  N    subscript     i  j       subscript  π    i  j         subscript  π    i  j        subscript  π   fragments  i  normal-.        subscript  π   fragments  normal-.  j           G=2\cdot N\cdot\sum_{ij}{\pi_{ij}\left(\ln(\pi_{ij})-\ln(\pi_{i.})-\ln(\pi_{.j%
 })\right)},          G  =   2  ⋅  N  ⋅   [     H   (  r  )    +   H   (  c  )     -   H   (  r  ,  c  )     ]     ,      G   normal-⋅  2  N   delimited-[]        H  r     H  c      H   r  c         G=2\cdot N\cdot\left[H(r)+H(c)-H(r,c)\right],          G  =    2  ⋅  N  ⋅  M   I   (  r  ,  c  )     ,      G     normal-⋅  2  N  M   I   r  c      G=2\cdot N\cdot MI(r,c)\,,     where the entropy of a discrete random variable    X    X   X\,   is defined as        H   (  X  )    =   -    ∑   x  ∈   Supp   (  X  )       p   (  x  )    log  p    (  x  )       ,        H  X       subscript     x    Supp  X       p  x    p   x       H(X)=-{\sum_{x\in\text{Supp}(X)}p(x)\log p(x)}\,,   and where       M  I   (  r  ,  c  )    =     H   (  r  )    +   H   (  c  )     -   H   (  r  ,  c  )           M  I   r  c          H  r     H  c      H   r  c       MI(r,c)=H(r)+H(c)-H(r,c)\,   is the mutual information between the row vector r and the column vector c of the contingency table.  It can also be shown that the inverse document frequency weighting commonly used for text retrieval is an approximation of G applicable when the row sum for the query is much smaller than the row sum for the remainder of the corpus. Similarly, the result of Bayesian inference applied to a choice of single multinomial distribution for all rows of the contingency table taken together versus the more general alternative of a separate multinomial per row produces results very similar to the G statistic.  Application   The McDonald–Kreitman test in statistical genetics is an application of the G -test.  Dunning 7 introduced the test to the computational linguistics community where it is now widely used.   Statistical software   The R programming language has the likelihood.test function in the Deducer package.  In SAS , one can conduct G -test by applying the /chisq option after the proc freq . 8  In Stata , one can conduct a G -test by applying the lr option after the tabulate command.  Fisher's G -test in the GeneCycle Package of the R programming language (fisher.g.test) does not implement the G -test as described in this article, but rather Fisher's exact test of Gaussian white-noise in a time series. 9   References    External links   G 2 /Log-likelihood calculator   "  Category:Categorical data  Category:Statistical tests     ↩  ↩  ↩  ↩  ↩  ↩  Dunning, Ted (1993). " Accurate Methods for the Statistics of Surprise and Coincidence ", Computational Linguistics , Volume 19, issue 1 (March, 1993). ↩  G-test of independence , G-test for goodness-of-fit in Handbook of Biological Statistics, University of Delaware. (pp. 46–51, 64–69 in: McDonald, J. H. (2009) Handbook of Biological Statistics (2nd ed.). Sparky House Publishing, Baltimore, Maryland.) ↩  Fisher, R. A. (1929), "Tests of significance in harmonic analysis", Proceedings of the Royal Society of London: Series A , Volume 125, Issue 796, pp. 54–59. ↩     
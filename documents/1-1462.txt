   Negative binomial distribution      Negative binomial distribution   In probability theory and statistics , the negative binomial distribution is a discrete probability distribution of the number of successes in a sequence of independent and identically distributed Bernoulli trials before a specified (non-random) number of failures (denoted r ) occurs. For example, if we define a "1" as failure, all non-"1"s as successes, and we throw a die repeatedly until the third time “1” appears ( r = three failures), then the probability distribution of the number of non-“1”s that had appeared will be a negative binomial.  The Pascal distribution (after Blaise Pascal ) and Polya distribution (for George Pólya ) are special cases of the negative binomial. There is a convention among engineers, climatologists, and others to reserve “negative binomial” in a strict sense or “Pascal” for the case of an integer-valued stopping-time parameter r , and use “Polya” for the real-valued case.  For occurrences of “contagious” discrete events, like tornado outbreaks, the Polya distributions can be used to give more accurate models than the Poisson distribution by allowing the mean and variance to be different, unlike the Poisson. “Contagious” events have positively correlated occurrences causing a larger variance than if the occurrences were independent, due to a positive covariance term.  Definition  Suppose there is a sequence of independent Bernoulli trials , each trial having two potential outcomes called “success” and “failure”. In each trial the probability of success is p and of failure is (1 − p ). We are observing this sequence until a predefined number r of failures has occurred. Then the random number of successes we have seen, X , will have the negative binomial (or Pascal ) distribution:       X   ∼   NB   (  r  ;  p  )       similar-to  X    NB   r  p      X\ \sim\ \text{NB}(r;p)     When applied to real-world problems, outcomes of success and failure may or may not be outcomes we ordinarily view as good and bad, respectively. Suppose we used the negative binomial distribution to model the number of days a certain machine works before it breaks down. In this case “success” would be the result on a day when the machine worked properly, whereas a breakdown would be a “failure”. If we used the negative binomial distribution to model the number of goal attempts a sportsman makes before scoring a goal, though, then each unsuccessful attempt would be a “success”, and scoring a goal would be “failure”. If we are tossing a coin, then the negative binomial distribution can give the number of heads (“success”) we are likely to encounter before we encounter a certain number of tails (“failure”). In the probability mass function below, p is the probability of success, and (1-p) is the probability of failure.  The probability mass function of the negative binomial distribution is        f   (  k  ;  r  ,  p  )    ≡   Pr   (   X  =  k   )    =    (       k  +  r   -  1       k     )    p  k     (   1  -  p   )   r       for  k   =   0  ,  1  ,  2  ,  …       formulae-sequence        f   k  r  p     Pr    X  k            binomial      k  r   1   k    superscript  p  k    superscript    1  p   r          for  k    0  1  2  normal-…      f(k;r,p)\equiv\Pr(X=k)={k+r-1\choose k}p^{k}(1-p)^{r}\quad\text{for }k=0,1,2,\dots     Here the quantity in parentheses is the binomial coefficient , and is equal to        (       k  +  r   -  1       k     )   =     (    k  +  r   -  1   )   !     k  !     (   r  -  1   )   !     =     (    k  +  r   -  1   )    (    k  +  r   -  2   )   ⋯   (  r  )     k  !     .         binomial      k  r   1   k           k  r   1        k       r  1                   k  r   1       k  r   2   normal-⋯  r     k       {k+r-1\choose k}=\frac{(k+r-1)!}{k!\,(r-1)!}=\frac{(k+r-1)(k+r-2)\cdots(r)}{k!}.     This quantity can alternatively be written in the following manner, explaining the name “negative binomial”:         (    k  +  r   -  1   )   ⋯   (  r  )     k  !    =    (  -  1  )   k      (   -  r   )    (    -  r   -  1   )    (    -  r   -  2   )   ⋯   (     -  r   -  k   +  1   )     k  !    =    (  -  1  )   k    (      -  r       k     )   .   (  *  )      fragments          k  r   1   normal-⋯  r     k      superscript   fragments  normal-(   1  normal-)   k         r       r   1       r   2   normal-⋯        r   k   1      k      superscript   fragments  normal-(   1  normal-)   k    binomial    r   k   normal-.  italic-   fragments  normal-(   normal-)     \frac{(k+r-1)\cdots(r)}{k!}=(-1)^{k}\frac{(-r)(-r-1)(-r-2)\cdots(-r-k+1)}{k!}=%
 (-1)^{k}{-r\choose k}.\qquad(*)     To understand the above definition of the probability mass function, note that the probability for every specific sequence of k successes and r failures is , because the outcomes of the k + r trials are supposed to happen independently . Since the r th failure comes last, it remains to choose the k trials with successes out of the remaining k + r − 1 trials. The above binomial coefficient, due to its combinatorial interpretation, gives precisely the number of all these sequences of length k + r − 1.  Recurrence relation      {       (   k  +  1   )    Pr   (   k  +  1   )     -   p   Pr   (  k  )     (   k  +  r   )     =  0   ,    Pr   (  0  )    =    (   1  -  p   )   r     }      formulae-sequence          k  1    Pr    k  1       p   Pr  k     k  r     0      Pr  0    superscript    1  p   r       \left\{(k+1)\Pr(k+1)-p\Pr(k)(k+r)=0,\Pr(0)=(1-p)^{r}\right\}     Expectation  The expected total number of trials k+r of a negative binomial distribution with parameters (r,p) is r/(1-p). To see this intuitively, imagine the above experiment is performed many times. That is, a set of trials are performed until r failures are obtained,then another set of trials, and then another etc. Write down the number of trials performed in each experiment: a, b, c... and set a + b + c + ... = N. Now we would expect about N(1-p) failures in total. Say the experiment was performed n times. Then there are nr failures in total. So we would expect nr = N(1-p), so N/n = r/(1-p). See that N/n is just the average number of trials per experiment. That is what we mean by "expectation." The average number of successes per experiment is N/n - r, which must have expected value equal to r/(1-p) - r = rp/(1-p). This agrees with the mean given in the box on the right-hand side of this page.  Extension to real-valued r  It is possible to extend the definition of the negative binomial distribution to the case of a positive real parameter r . Although it is impossible to visualize a non-integer number of “failures”, we can still formally define the distribution through its probability mass function.  As before, we say that X has a negative binomial (or Pólya ) distribution if it has a probability mass function :        f   (  k  ;  r  ,  p  )    ≡   Pr   (   X  =  k   )    =    (       k  +  r   -  1       k     )    p  k     (   1  -  p   )   r       for  k   =   0  ,  1  ,  2  ,  …       formulae-sequence        f   k  r  p     Pr    X  k            binomial      k  r   1   k    superscript  p  k    superscript    1  p   r          for  k    0  1  2  normal-…      f(k;r,p)\equiv\Pr(X=k)={k+r-1\choose k}p^{k}(1-p)^{r}\quad\text{for }k=0,1,2,\dots   Here r is a real, positive number. The binomial coefficient is then defined by the multiplicative formula and can also be rewritten using the gamma function :        (       k  +  r   -  1       k     )   =     (    k  +  r   -  1   )    (    k  +  r   -  2   )   ⋯   (  r  )     k  !    =    Γ   (   k  +  r   )      k  !   Γ   (  r  )      .         binomial      k  r   1   k           k  r   1       k  r   2   normal-⋯  r     k             normal-Γ    k  r        k   normal-Γ  r       {k+r-1\choose k}=\frac{(k+r-1)(k+r-2)\cdots(r)}{k!}=\frac{\Gamma(k+r)}{k!\,%
 \Gamma(r)}.   Note that by the binomial series and (*) above, for every ,         (   1  -  p   )    -  r    =    ∑   k  =  0   ∞     (      -  r       k     )     (   -  p   )   k     =    ∑   k  =  0   ∞     (       k  +  r   -  1       k     )    p  k      ,         superscript    1  p     r      superscript   subscript     k  0         binomial    r   k    superscript    p   k            superscript   subscript     k  0         binomial      k  r   1   k    superscript  p  k        (1-p)^{-r}=\sum_{k=0}^{\infty}{-r\choose k}(-p)^{k}=\sum_{k=0}^{\infty}{k+r-1%
 \choose k}p^{k},   hence the terms of the probability mass function indeed add up to one.  Alternative formulations  Some textbooks may define the negative binomial distribution slightly differently from here. The most common variations are:  Occurrence  Waiting time in a Bernoulli process  For the special case where r is an integer, the negative binomial distribution is known as the Pascal distribution . It is the probability distribution of a certain number of failures and successes in a series of independent and identically distributed Bernoulli trials. For k + r  Bernoulli trials with success probability p , the negative binomial gives the probability of k successes and r failures, with a failure on the last trial. In other words, the negative binomial distribution is the probability distribution of the number of successes before the r th failure in a Bernoulli process , with probability p of successes on each trial. A Bernoulli process is a discrete time process, and so the number of trials, failures, and successes are integers.  Consider the following example. Suppose we repeatedly throw a die, and consider a “1” to be a “failure”. The probability of failure on each trial is 1/6. The number of successes before the third failure belongs to the infinite set { 0, 1, 2, 3, ... }. That number of successes is a negative-binomially distributed random variable.  When r = 1 we get the probability distribution of number of successes before the first failure (i.e. the probability of the first failure occurring on the ( k + 1)st trial), which is a geometric distribution :       f   (  k  ;  r  ,  p  )    =    (   1  -  p   )   ⋅    p  k           f   k  r  p     normal-⋅    1  p    superscript  p  k      f(k;r,p)=(1-p)\cdot p^{k}\!     Overdispersed Poisson  The negative binomial distribution, especially in its alternative parameterization described above, can be used as an alternative to the Poisson distribution. It is especially useful for discrete data over an unbounded positive range whose sample variance exceeds the sample mean . In such cases, the observations are overdispersed with respect to a Poisson distribution, for which the mean is equal to the variance. Hence a Poisson distribution is not an appropriate model. Since the negative binomial distribution has one more parameter than the Poisson, the second parameter can be used to adjust the variance independently of the mean. See Cumulants of some discrete probability distributions .  An application of this is to annual counts of tropical cyclones in the North Atlantic or to monthly to 6-monthly counts of wintertime extratropical cyclones over Europe, for which the variance is greater than the mean. 1 2 3 In the case of modest overdispersion, this may produce substantially similar results to an overdispersed Poisson distribution. 4 5  The negative binomial distribution is also commonly used to model gene expression in the form of discrete read count data from high-throughput RNA sequencing experiments. 6 7  Related distributions   The geometric distribution (on { 0, 1, 2, 3, ... }) is a special case of the negative binomial distribution, with           Geom   (  p  )    =   NB   (  1  ,   1  -  p   )     .        Geom  p     NB   1    1  p       \text{Geom}(p)=\text{NB}(1,\,1-p).\,         The negative binomial distribution is a special case of the discrete phase-type distribution .    The negative binomial distribution is a special case of discrete Compound Poisson distribution .   Poisson distribution  Consider a sequence of negative binomial random variables where the stopping parameter r goes to infinity, whereas the probability of success in each trial, p , goes to zero in such a way as to keep the mean of the distribution constant. Denoting this mean λ , the parameter p will be p= λ /( λ +r)        λ  =     r    p   1  -  p     ⇒     p  =   λ   r  +  λ      .     formulae-sequence    λ     r    p    1  p     normal-⇒      p    λ    r  λ       \lambda=r\,\frac{p}{1-p}\quad\Rightarrow\quad p=\frac{\lambda}{r+\lambda}.     Under this parametrization the probability mass function will be       f   (  k  ;  r  ,  p  )    =     Γ   (   k  +  r   )       k  !   ⋅  Γ    (  r  )      p  k     (   1  -  p   )   r    =     λ  k    k  !    ⋅    Γ   (   r  +  k   )     Γ   (  r  )     (   r  +  λ   )   k     ⋅   1    (   1  +   λ  r    )   r             f   k  r  p          normal-Γ    k  r       normal-⋅    k   normal-Γ   r     superscript  p  k    superscript    1  p   r          normal-⋅     superscript  λ  k     k        normal-Γ    r  k      normal-Γ  r   superscript    r  λ   k       1   superscript    1    λ  r    r        f(k;r,p)=\frac{\Gamma(k+r)}{k!\cdot\Gamma(r)}p^{k}(1-p)^{r}=\frac{\lambda^{k}}%
 {k!}\cdot\frac{\Gamma(r+k)}{\Gamma(r)\;(r+\lambda)^{k}}\cdot\frac{1}{\left(1+%
 \frac{\lambda}{r}\right)^{r}}     Now if we consider the limit as r → ∞, the second factor will converge to one, and the third to the exponent function:         lim   r  →  ∞     f   (  k  ;  r  ,  p  )     =     λ  k    k  !    ⋅  1  ⋅   1   e  λ      ,        subscript    normal-→  r       f   k  r  p      normal-⋅     superscript  λ  k     k    1    1   superscript  e  λ       \lim_{r\to\infty}f(k;r,p)=\frac{\lambda^{k}}{k!}\cdot 1\cdot\frac{1}{e^{%
 \lambda}},   which is the mass function of a Poisson-distributed random variable with expected value λ .  In other words, the alternatively parameterized negative binomial distribution converges to the Poisson distribution and r controls the deviation from the Poisson. This makes the negative binomial distribution suitable as a robust alternative to the Poisson, which approaches the Poisson for large r , but which has larger variance than the Poisson for small r .        Poisson   (  λ  )    =    lim   r  →  ∞     NB   (  r  ,   λ   λ  +  r    )      .        Poisson  λ     subscript    normal-→  r       NB   r    λ    λ  r         \text{Poisson}(\lambda)=\lim_{r\to\infty}\text{NB}\Big(r,\ \frac{\lambda}{%
 \lambda+r}\Big).     Gamma–Poisson mixture  The negative binomial distribution also arises as a continuous mixture of Poisson distributions (i.e. a compound probability distribution ) where the mixing distribution of the Poisson rate is a gamma distribution . That is, we can view the negative binomial as a  distribution, where λ is itself a random variable, distributed as a gamma distribution with shape = r and scale θ =  or correspondingly rate β = .  Formally, this means that the mass function of the negative binomial distribution can be written as      f   (  k  ;  r  ,  p  )       f   k  r  p     \displaystyle f(k;r,p)     Because of this, the negative binomial distribution is also known as the gamma–Poisson (mixture) distribution .  Note: The negative binomial distribution was originally derived as a limiting case of the gamma-Poisson distribution. 8  Sum of geometric distributions  If Y r is a random variable following the negative binomial distribution with parameters r and p , and support {0, 1, 2, ...}, then Y r is a sum of r  independent variables following the geometric distribution (on {0, 1, 2, ...}) with parameter 1-p . As a result of the central limit theorem , Y r (properly scaled and shifted) is therefore approximately normal for sufficiently large r .  Furthermore, if B s + r is a random variable following the binomial distribution with parameters s + r and 1 − p , then      Pr   (    Y  r   ≤  s   )      Pr     subscript  Y  r   s     \displaystyle\Pr(Y_{r}\leq s)     In this sense, the negative binomial distribution is the "inverse" of the binomial distribution.  The sum of independent negative-binomially distributed random variables r 1 and r 2 with the same value for parameter p is negative-binomially distributed with the same p but with " r -value" r 1 + r 2 .  The negative binomial distribution is infinitely divisible , i.e., if Y has a negative binomial distribution, then for any positive integer n , there exist independent identically distributed random variables Y 1 , ..., Y n whose sum has the same distribution that Y has.  Representation as compound Poisson distribution  The negative binomial distribution NB( r , p ) can be represented as a compound Poisson distribution : Let } denote a sequence of independent and identically distributed random variables , each one having the logarithmic distribution Log( p ), with probability mass function         f   (  k  ;  r  ,  p  )    =    -   p  k     k   ln   (   1  -  p   )       ,   k  ∈  ℕ    .     formulae-sequence      f   k  r  p         superscript  p  k      k      1  p         k  ℕ     f(k;r,p)=\frac{-p^{k}}{k\ln(1-p)},\qquad k\in{\mathbb{N}}.     Let N be a random variable, independent of the sequence, and suppose that N has a Poisson distribution with mean . Then the random sum      X  =    ∑   n  =  1   N    Y  n        X    superscript   subscript     n  1    N    subscript  Y  n      X=\sum_{n=1}^{N}Y_{n}     is NB( r , p )-distributed. To prove this, we calculate the probability generating function  G X of X , which is the composition of the probability generating functions G N and G Y 1 . Using          G  N    (  z  )    =   exp   (   λ   (   z  -  1   )    )     ,   z  ∈  ℝ    ,     formulae-sequence       subscript  G  N   z       λ    z  1        z  ℝ     G_{N}(z)=\exp(\lambda(z-1)),\qquad z\in\mathbb{R},     and          G   Y  1     (  z  )    =    ln   (   1  -   p  z    )     ln   (   1  -  p   )      ,    |  z  |   <   1  p     ,     formulae-sequence       subscript  G   subscript  Y  1    z         1    p  z         1  p          z     1  p      G_{Y_{1}}(z)=\frac{\ln(1-pz)}{\ln(1-p)},\qquad|z|<\frac{1}{p},     we obtain       G  X    (  z  )        subscript  G  X   z    \displaystyle G_{X}(z)     which is the probability generating function of the NB( r , p ) distribution.  The following table describes four distributions related to the number of successes in a sequence of draws:       With replacements   No replacements       Given number of draws   binomial distribution   hypergeometric distribution     Given number of failures   negative binomial distribution   negative hypergeometric distribution     Properties  Cumulative distribution function  The cumulative distribution function can be expressed in terms of the regularized incomplete beta function :        f   (  k  ;  r  ,  p  )    ≡   Pr   (   X  ≤  k   )    =   1  -    I  p    (   k  +  1   ,  r  )     =    I   1  -  p     (  r  ,   k  +  1   )     .          f   k  r  p     Pr    X  k           1     subscript  I  p      k  1   r             subscript  I    1  p     r    k  1        f(k;r,p)\equiv\Pr(X\leq k)=1-I_{p}(k+1,r)=I_{1-p}(r,k+1).     Sampling and point estimation of p  Suppose p is unknown and an experiment is conducted where it is decided ahead of time that sampling will continue until r successes are found. A sufficient statistic for the experiment is k , the number of failures.  In estimating p , the minimum variance unbiased estimator is        p  ^   =    r  -  1     r  +  k   -  1     .       normal-^  p       r  1       r  k   1      \hat{p}=\frac{r-1}{r+k-1}.     The maximum likelihood estimate of p is        p  ~   =   r   r  +  k     ,       normal-~  p     r    r  k      \tilde{p}=\frac{r}{r+k},     but this is a biased estimate . Its inverse ( r + k )/ r , is an unbiased estimate of 1/ p , however. 9  Relation to the binomial theorem  Suppose Y is a random variable with a binomial distribution with parameters n and p . Assume p + q = 1, with p , q >=0. Then the binomial theorem implies that       1  =   1  n   =    (   p  +  q   )   n   =    ∑   k  =  0   n     (     n      k     )    p  k    q   n  -  k       .        1   superscript  1  n         superscript    p  q   n          superscript   subscript     k  0    n      binomial  n  k    superscript  p  k    superscript  q    n  k         1=1^{n}=(p+q)^{n}=\sum_{k=0}^{n}{n\choose k}p^{k}q^{n-k}.     Using Newton's binomial theorem , this can equally be written as:         (   p  +  q   )   n   =    ∑   k  =  0   ∞     (     n      k     )    p  k    q   n  -  k       ,       superscript    p  q   n     superscript   subscript     k  0         binomial  n  k    superscript  p  k    superscript  q    n  k        (p+q)^{n}=\sum_{k=0}^{\infty}{n\choose k}p^{k}q^{n-k},     in which the upper bound of summation is infinite. In this case, the binomial coefficient        (     n      k     )   =    n   (   n  -  1   )    (   n  -  2   )   ⋯   (    n  -  k   +  1   )     k  !     .       binomial  n  k       n    n  1     n  2   normal-⋯      n  k   1      k      {n\choose k}={n(n-1)(n-2)\cdots(n-k+1)\over k!}.     is defined when n is a real number, instead of just a positive integer. But in our case of the binomial distribution it is zero when k > n . We can then say, for example         (   p  +  q   )   8.3   =    ∑   k  =  0   ∞     (     8.3      k     )    p  k    q   8.3  -  k       .       superscript    p  q   8.3     superscript   subscript     k  0         binomial  8.3  k    superscript  p  k    superscript  q    8.3  k        (p+q)^{8.3}=\sum_{k=0}^{\infty}{8.3\choose k}p^{k}q^{8.3-k}.     Now suppose r > 0 and we use a negative exponent:       1  =    p  r   ⋅   p   -  r     =    p  r     (   1  -  q   )    -  r     =    p  r     ∑   k  =  0   ∞     (      -  r       k     )     (   -  q   )   k       .        1   normal-⋅   superscript  p  r    superscript  p    r             superscript  p  r    superscript    1  q     r             superscript  p  r     superscript   subscript     k  0         binomial    r   k    superscript    q   k         1=p^{r}\cdot p^{-r}=p^{r}(1-q)^{-r}=p^{r}\sum_{k=0}^{\infty}{-r\choose k}(-q)^%
 {k}.     Then all of the terms are positive, and the term       p  r    (      -  r       k     )     (   -  q   )   k        superscript  p  r    binomial    r   k    superscript    q   k     p^{r}{-r\choose k}(-q)^{k}     is just the probability that the number of failures before the r th success is equal to k , provided r is an integer. (If r is a negative non-integer, so that the exponent is a positive non-integer, then some of the terms in the sum above are negative, so we do not have a probability distribution on the set of all nonnegative integers.)  Now we also allow non-integer values of r . Then we have a proper negative binomial distribution, which is a generalization of the Pascal distribution, which coincides with the Pascal distribution when r happens to be a positive integer.  Recall from above that   The sum of independent negative-binomially distributed random variables r 1 and r 2 with the same value for parameter p is negative-binomially distributed with the same p but with " r -value" r 1 + r 2 .   This property persists when the definition is thus generalized, and affords a quick way to see that the negative binomial distribution is infinitely divisible .  Parameter estimation  Maximum likelihood estimation  The likelihood function for N  iid observations ( k 1 , ..., k N ) is       L   (  r  ,  p  )    =    ∏   i  =  1   N    f   (   k  i   ;  r  ,  p  )           L   r  p      superscript   subscript  product    i  1    N     f    subscript  k  i   r  p       L(r,p)=\prod_{i=1}^{N}f(k_{i};r,p)\,\!     from which we calculate the log-likelihood function        ℓ   (  r  ,  p  )    =      ∑   i  =  1   N    ln   (   Γ   (    k  i   +  r   )    )     -    ∑   i  =  1   N    ln   (    k  i   !   )     -   N   ln   (   Γ   (  r  )    )      +    ∑   i  =  1   N     k  i    ln   (  p  )      +   N  r   ln   (   1  -  p   )       .        normal-ℓ   r  p          superscript   subscript     i  1    N       normal-Γ     subscript  k  i   r        superscript   subscript     i  1    N        subscript  k  i        N      normal-Γ  r        superscript   subscript     i  1    N      subscript  k  i     p       N  r      1  p        \ell(r,p)=\sum_{i=1}^{N}\ln{(\Gamma(k_{i}+r))}-\sum_{i=1}^{N}\ln(k_{i}!)-N\ln{%
 (\Gamma(r))}+\sum_{i=1}^{N}k_{i}\ln{(p)}+Nr\ln(1-p).     To find the maximum we take the partial derivatives with respect to r and p and set them equal to zero:         ∂  ℓ    (  r  ,  p  )     ∂  p    =     ∑   i  =  1   N     k  i    1  p     -   N  r   1   1  -  p      =  0              normal-ℓ    r  p      p        superscript   subscript     i  1    N      subscript  k  i     1  p       N  r    1    1  p           0     \frac{\partial\ell(r,p)}{\partial p}=\sum_{i=1}^{N}k_{i}\frac{1}{p}-Nr\frac{1}%
 {1-p}=0   and         ∂  ℓ    (  r  ,  p  )     ∂  r    =      ∑   i  =  1   N    ψ   (    k  i   +  r   )     -   N  ψ   (  r  )     +   N   ln   (   1  -  p   )      =  0              normal-ℓ    r  p      r          superscript   subscript     i  1    N     ψ     subscript  k  i   r       N  ψ  r      N      1  p           0     \frac{\partial\ell(r,p)}{\partial r}=\sum_{i=1}^{N}\psi(k_{i}+r)-N\psi(r)+N\ln%
 {(1-p)}=0     where       ψ   (  k  )    =      Γ  ′    (  k  )     Γ   (  k  )            ψ  k        superscript  normal-Γ  normal-′   k     normal-Γ  k      \psi(k)=\frac{\Gamma^{\prime}(k)}{\Gamma(k)}\!   is the digamma function .  Solving the first equation for p gives:      p  =     ∑   i  =  1   N    k  i      N  r   +    ∑   i  =  1   N    k  i          p      superscript   subscript     i  1    N    subscript  k  i        N  r     superscript   subscript     i  1    N    subscript  k  i        p=\frac{\sum_{i=1}^{N}k_{i}}{Nr+\sum_{i=1}^{N}k_{i}}     Substituting this in the second equation gives:         ∂  ℓ    (  r  ,  p  )     ∂  r    =      ∑   i  =  1   N    ψ   (    k  i   +  r   )     -   N  ψ   (  r  )     +   N   ln   (   r   r  +    ∑   i  =  1   N     k  i   /  N      )      =  0              normal-ℓ    r  p      r          superscript   subscript     i  1    N     ψ     subscript  k  i   r       N  ψ  r      N      r    r    superscript   subscript     i  1    N      subscript  k  i   N              0     \frac{\partial\ell(r,p)}{\partial r}=\sum_{i=1}^{N}\psi(k_{i}+r)-N\psi(r)+N\ln%
 {\left(\frac{r}{r+\sum_{i=1}^{N}k_{i}/N}\right)}=0     This equation cannot be solved for r in closed form . If a numerical solution is desired, an iterative technique such as Newton's method can be used.  Examples  Selling candy  Pat is required to sell candy bars to raise money for the 6th grade field trip. There are thirty houses in the neighborhood, and Pat is not supposed to return home until five candy bars have been sold. So the child goes door to door, selling candy bars. At each house, there is a 0.4 probability of selling one candy bar and a 0.6 probability of selling nothing.  What's the probability of selling the last candy bar at the  n th house?  Recall that the NegBin( r , p ) distribution describes the probability of k failures and r successes in k + r Bernoulli( p ) trials with success on the last trial. Selling five candy bars means getting five successes. The number of trials (i.e. houses) this takes is therefore k + 5 = n . The random variable we are interested in is the number of houses, so we substitute k = n − 5 into a NegBin(5, 0.4) mass function and obtain the following mass function of the distribution of houses (for n ≥ 5):        f   (  n  )    =    (        (   n  -  5   )   +  5   -  1        n  -  5      )    0.4  5    0.6   n  -  5     =    (      n  -  1        n  -  5      )     2  5      3   n  -  5     5  n      .          f  n      binomial        n  5   5   1     n  5     superscript  0.4  5    superscript  0.6    n  5             binomial    n  1     n  5     superscript  2  5      superscript  3    n  5     superscript  5  n        f(n)={(n-5)+5-1\choose n-5}\;0.4^{5}\;0.6^{n-5}={n-1\choose n-5}\;2^{5}\;\frac%
 {3^{n-5}}{5^{n}}.     What's the probability that Pat finishes on the tenth house?       f   (  10  )    =   0.1003290624.         f  10   0.1003290624.    f(10)=0.1003290624.\,     What's the probability that Pat finishes on or before reaching the eighth house?  To finish on or before the eighth house, Pat must finish at the fifth, sixth, seventh, or eighth house. Sum those probabilities:       f   (  5  )    =   0.01024         f  5   0.01024    f(5)=0.01024\,          f   (  6  )    =   0.03072         f  6   0.03072    f(6)=0.03072\,          f   (  7  )    =   0.055296         f  7   0.055296    f(7)=0.055296\,          f   (  8  )    =   0.0774144         f  8   0.0774144    f(8)=0.0774144\,           ∑   j  =  5   8    f   (  j  )     =  0.17367.        superscript   subscript     j  5    8     f  j    0.17367.    \sum_{j=5}^{8}f(j)=0.17367.     What's the probability that Pat exhausts all 30 houses in the neighborhood?  This can be expressed as the probability that Pat does not finish on the fifth through the thirtieth house:       1  -    ∑   j  =  5   30    f   (  j  )      =   1  -    I  0.4    (  5  ,    30  -  5   +  1   )     ≈   1  -  0.99849   =  0.00151.          1    superscript   subscript     j  5    30     f  j       1     subscript  I  0.4    5      30  5   1             1  0.99849        0.00151.     1-\sum_{j=5}^{30}f(j)=1-I_{0.4}(5,30-5+1)\approx 1-0.99849=0.00151.     Length of hospital stay  Hospital length of stay is an example of real world data that can be modelled well with a negative binomial distribution. 10  See also   Coupon collector's problem  Beta negative binomial distribution  Extended negative binomial distribution  Negative multinomial distribution  Binomial distribution  Poisson distribution  Exponential family  Compound Poisson distribution   References  "  Category:Discrete distributions  Category:Factorial and binomial topics  Category:Exponential family distributions  Category:Infinitely divisible probability distributions  Category:Probability distributions     ↩  ↩  ↩  ↩  ↩  ↩  ↩  Greenwood M, Yule GU (1920) An enquiry into the nature of frequency distributions representative of multiple happenings with particular reference of multiple attacks of disease or of repeated accidents. J R Statist Soc 83: 25–279 ↩  J. B. S. Haldane , "On a Method of Estimating Frequencies", Biometrika , Vol. 33, No. 3 (Nov., 1945), pp. 222–225. ↩   ↩     
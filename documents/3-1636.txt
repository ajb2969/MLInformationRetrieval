   Information bottleneck method      Information bottleneck method   The information bottleneck method is a technique introduced by Naftali Tishby et al. [1] for finding the best tradeoff between accuracy and complexity ( compression ) when summarizing (e.g. clustering ) a random variable  X , given a joint probability distribution between X and an observed relevant variable Y . Other applications include distributional clustering, and dimension reduction . In a well defined sense it generalized the classical notion of minimal sufficient statistics from parametric statistics to arbitrary distributions, not necessarily of exponential form. It does so by relaxing the sufficiency condition to capture some fraction of the mutual information with the relevant variable Y .  The compressed variable is    T    T   T\,   and the algorithm minimises the following quantity          min   p   (  t  |  x  )      I    (  X  ;  T  )    -   β  I   (  T  ;  Y  )            subscript    fragments  p   fragments  normal-(  t  normal-|  x  normal-)     I    X  T      β  I   T  Y      \min_{p(t|x)}\,\,I(X;T)-\beta I(T;Y)     where    I   (  X  ;  T  )   I   (  T  ;  Y  )       I   X  T   I   T  Y     I(X;T)\,\,I(T;Y)   are the mutual information between    X  ;   T      X  T    X;T\,   and    T  ;   Y      T  Y    T;Y\,   respectively, and   β   β   \beta   is a Lagrange multiplier .  Gaussian information bottleneck  A relatively simple application of the information bottleneck is to Gaussian variates and this has some semblance to a least squares reduced rank or canonical correlation [2]. Assume    X  ,   Y      X  Y    X,Y\,   are jointly multivariate zero mean normal vectors with covariances     Σ   X  X    ,   Σ   Y  Y        subscript  normal-Σ    X  X     subscript  normal-Σ    Y  Y      \Sigma_{XX},\,\,\Sigma_{YY}   and    T    T   T\,   is a compressed version of    X    X   X\,   which must maintain a given value of mutual information with    Y    Y   Y\,   . It can be shown that the optimum    T    T   T\,   is a normal vector consisting of linear combinations of the elements of     X  ,  T   =   A   X         X  T     A  X     X,\,\,T=AX\,   where matrix    A    A   A\,   has orthogonal rows.  The projection matrix    A    A   A\,   in fact contains    M    M   M\,   rows selected from the weighted left eigenvectors of the singular value decomposition of the following matrix (generally asymmetric)       Ω  =    Σ   X  |  Y     Σ   X  X    -  1     =   I  -    Σ   X  Y     Σ   Y  Y    -  1     Σ   X  Y   T    Σ   X  X    -  1       .        normal-Ω     subscript  normal-Σ   fragments  X  normal-|  Y     superscript   subscript  normal-Σ    X  X      1            I     subscript  normal-Σ    X  Y     superscript   subscript  normal-Σ    Y  Y      1     superscript   subscript  normal-Σ    X  Y    T    superscript   subscript  normal-Σ    X  X      1         \Omega=\Sigma_{X|Y}\Sigma_{XX}^{-1}=I-\Sigma_{XY}\Sigma_{YY}^{-1}\Sigma_{XY}^{%
 T}\Sigma_{XX}^{-1}.\,     Define the singular value decomposition      Ω  =   U  Λ   V  T   with  Λ   =   Diag   (    λ  1   ≤    λ  2   ⋯   λ  N     )          normal-Ω    U  normal-Λ   superscript  V  T   with  normal-Λ         Diag     subscript  λ  1      subscript  λ  2   normal-⋯   subscript  λ  N         \Omega=U\Lambda V^{T}\text{ with }\Lambda=\operatorname{Diag}\big(\lambda_{1}%
 \leq\lambda_{2}\cdots\lambda_{N}\big)\,     and the critical values        β  i  C    =    λ  i   <  1      (   1  -   λ  i    )    -  1     .       superscript   subscript  β  i   C       subscript  λ  i   1      superscript    1   subscript  λ  i      1      \beta_{i}^{C}\underset{\lambda_{i}<1}{=}(1-\lambda_{i})^{-1}.\,     then the number    M    M   M\,   of active eigenvectors in the projection, or order of approximation, is given by       β   M  -  1   C   <  β  ≤   β  M  C          superscript   subscript  β    M  1    C   β        superscript   subscript  β  M   C      \beta_{M-1}^{C}<\beta\leq\beta_{M}^{C}     And we finally get      A  =    [    w  1    U  1    ,  …  ,    w  M    U  M    ]   T       A   superscript      subscript  w  1    subscript  U  1    normal-…     subscript  w  M    subscript  U  M     T     A=[w_{1}U_{1},\dots,w_{M}U_{M}]^{T}     In which the weights are given by       w  i   =    (  β   (  1  -   λ  i   )   /   λ  i    r  i          subscript  w  i      fragments  normal-(  β   fragments  normal-(  1    subscript  λ  i   normal-)     subscript  λ  i    subscript  r  i       w_{i}=\sqrt{(\beta(1-\lambda_{i})/\lambda_{i}r_{i}}     where      r  i   =    U  i  T    Σ   X  X     U  i     .       subscript  r  i      superscript   subscript  U  i   T    subscript  normal-Σ    X  X     subscript  U  i      r_{i}=U_{i}^{T}\Sigma_{XX}U_{i}.\,     Applying the Gaussian information bottleneck on time series, one gets optimal predictive coding. This procedure is formally equivalent to linear Slow Feature Analysis [3 ]. Optimal temporal structures in linear dynamic systems can be revealed in the so-called past-future information bottleneck [4 ].  Data clustering using the information bottleneck  This application of the bottleneck method to non-Gaussian sampled data is described in [4] by Tishby et. el. The concept, as treated there, is not without complication as there are two independent phases in the exercise: firstly estimation of the unknown parent probability densities from which the data samples are drawn and secondly the use of these densities within the information theoretic framework of the bottleneck.  Density estimation  Since the bottleneck method is framed in probabilistic rather than statistical terms, we first need to estimate the underlying probability density at the sample points    X  =    x  i        X   subscript  x  i     X={x_{i}}\,   . This is a well known problem with a number of solutions described by Silverman in [5]. In the present method, joint probabilities of the samples are found by use of a Markov transition matrix method and this has some mathematical synergy with the bottleneck method itself.  Define an arbitrarily increasing distance metric    f    f   f\,   between all sample pairs and distance matrix      d   i  ,  j    =   f   (   |    x  i   -   x  j    |   )         subscript  d   i  j      f       subscript  x  i    subscript  x  j        d_{i,j}=f\Big(\Big|x_{i}-x_{j}\Big|\Big)   . Then compute transition probabilities between sample pairs     P   i  ,  j    =   exp   (   -   λ   d   i  ,  j      )         subscript  P   i  j          λ   subscript  d   i  j         P_{i,j}=\exp(-\lambda d_{i,j})\,   for some    λ  >   0       λ  0    \lambda>0\,   . Treating samples as states, and a normalised version of    P    P   P\,   as a Markov state transition probability matrix, the vector of probabilities of the ‘states’ after    t    t   t\,   steps, conditioned on the initial state    p   (  0  )       p  0    p(0)\,   , is     p   (  t  )    =    P  t   p   (  0  )          p  t      superscript  P  t   p  0     p(t)=P^{t}p(0)\,   . We are here interested only in the equilibrium probability vector    p   (  ∞  )       p     p(\infty)\,   given, in the usual way, by the dominant eigenvector of matrix    P    P   P\,   which is independent of the initialising vector    p   (  0  )       p  0    p(0)\,   . This Markov transition method establishes a probability at the sample points which is claimed to be proportional to the probabilities densities there.  Other interpretations of the use of the eigenvalues of distance matrix    d    d   d\,   are discussed in [6].  Clusters  In the following soft clustering example, the reference vector    Y    Y   Y\,   contains sample categories and the joint probability    p   (  X  ,  Y  )       p   X  Y     p(X,Y)\,   is assumed known. A soft cluster     c  k      subscript  c  k    c_{k}\,   is defined by its probability distribution over the data samples     x  i   :  p   (   c  k   |   x  i   )      fragments   subscript  x  i   normal-:  p   fragments  normal-(   subscript  c  k   normal-|   subscript  x  i   normal-)     x_{i}:\,\,\,p(c_{k}|x_{i})   . In [1] Tishby et al. present the following iterative set of equations to determine the clusters which are ultimately a generalization of the Blahut-Arimoto algorithm, developed in rate distortion theory. The application of this type of algorithm in neural networks appears to originate in entropy arguments arising in application of Gibbs Distributions in deterministic annealing [7].      {      p   (  c  |  x  )   =  K  p   (  c  )   exp   (  -   β    D   K  L     [  p   (  y  |  x  )   |  |  p   (  y  |  c  )   ]   )          p   (  y  |  c  )   =    ∑  x    p   (  y  |  x  )   p   (  c  |  x  )   p   (  x  )   /  p   (  c  )          p   (  c  )   =    ∑  x    p   (  c  |  x  )   p   (  x  )           cases   fragments  p   fragments  normal-(  c  normal-|  x  normal-)    K  p   fragments  normal-(  c  normal-)     fragments  normal-(   β   superscript  D    K  L     fragments  normal-[  p   fragments  normal-(  y  normal-|  x  normal-)   normal-|  normal-|  p   fragments  normal-(  y  normal-|  c  normal-)   normal-]   normal-)    otherwise   fragments  p   fragments  normal-(  y  normal-|  c  normal-)     subscript   x   p   fragments  normal-(  y  normal-|  x  normal-)   p   fragments  normal-(  c  normal-|  x  normal-)   p   fragments  normal-(  x  normal-)    p   fragments  normal-(  c  normal-)    otherwise   fragments  p   fragments  normal-(  c  normal-)     subscript   x   p   fragments  normal-(  c  normal-|  x  normal-)   p   fragments  normal-(  x  normal-)    otherwise    \begin{cases}p(c|x)=Kp(c)\exp\Big(-\beta\,D^{KL}\Big[p(y|x)\,||\,p(y|c)\Big]%
 \Big)\\
 p(y|c)=\textstyle\sum_{x}p(y|x)p(c|x)p(x)\big/p(c)\\
 p(c)=\textstyle\sum_{x}p(c|x)p(x)\\
 \end{cases}     The function of each line of the iteration is expanded as follows.  Line 1: This is a matrix valued set of conditional probabilities       A   i  ,  j    =  p   (   c  i   |   x  j   )   =  K  p   (   c  i   )   exp   (  -   β    D   K  L     [  p   (  y  |   x  j   )   |  |  p   (  y  |   c  i   )   ]   )      fragments   subscript  A   i  j     p   fragments  normal-(   subscript  c  i   normal-|   subscript  x  j   normal-)    K  p   fragments  normal-(   subscript  c  i   normal-)     fragments  normal-(   β   superscript  D    K  L     fragments  normal-[  p   fragments  normal-(  y  normal-|   subscript  x  j   normal-)   normal-|  normal-|  p   fragments  normal-(  y  normal-|   subscript  c  i   normal-)   normal-]   normal-)     A_{i,j}=p(c_{i}|x_{j})=Kp(c_{i})\exp\Big(-\beta\,D^{KL}\Big[p(y|x_{j})\,||\,p(%
 y|c_{i})\Big]\Big)     The Kullback–Leibler distance      D   K  L       superscript  D    K  L     D^{KL}\,   between the    Y    Y   Y\,   vectors generated by the sample data    x    x   x\,   and those generated by its reduced information proxy    c    c   c\,   is applied to assess the fidelity of the compressed vector with respect to the reference (or categorical) data    Y    Y   Y\,   in accordance with the fundamental bottleneck equation.     D   K  L     (  a  |  |  b  )      fragments   superscript  D    K  L     fragments  normal-(  a  normal-|  normal-|  b  normal-)     D^{KL}(a||b)\,   is the Kullback Leibler distance between distributions    a  ,   b      a  b    a,b\,          D   K  L     (  a  |  |  b  )   =   ∑  i   p   (   a  i   )   log   (    p   (   a  i   )     p   (   b  i   )     )      fragments   superscript  D    K  L     fragments  normal-(  a  normal-|  normal-|  b  normal-)     subscript   i   p   fragments  normal-(   subscript  a  i   normal-)     fragments  normal-(      p   subscript  a  i      p   subscript  b  i     normal-)     D^{KL}(a||b)=\sum_{i}p(a_{i})\log\Big(\frac{p(a_{i})}{p(b_{i})}\Big)     and    K    K   K\,   is a scalar normalization. The weighting by the negative exponent of the distance means that prior cluster probabilities are downweighted in line 1 when the Kullback Liebler distance is large, thus successful clusters grow in probability while unsuccessful ones decay.  '''Line 2: '''This is a second matrix-valued set of conditional probabilities. The steps in deriving it are as follows. We have, by definition      p   (   y  i   |   c  k   )      fragments  p   fragments  normal-(   subscript  y  i   normal-|   subscript  c  k   normal-)     \displaystyle p(y_{i}|c_{k})   where the Bayes identities    p   (  a  ,  b  )   =  p   (  a  |  b  )   p   (  b  )   =  p   (  b  |  a  )   p   (  a  )      fragments  p   fragments  normal-(  a  normal-,  b  normal-)    p   fragments  normal-(  a  normal-|  b  normal-)   p   fragments  normal-(  b  normal-)    p   fragments  normal-(  b  normal-|  a  normal-)   p   fragments  normal-(  a  normal-)     p(a,b)=p(a|b)p(b)=p(b|a)p(a)\,   are used.  Line 3: this line finds the marginal distribution of the clusters    c    c   c\,         p   (   c  i   )       p   subscript  c  i     \displaystyle p(c_{i})    This is also a standard result.  Further inputs to the algorithm are the marginal sample distribution    p   (  x  )       p  x    p(x)\,   which has already been determined by the dominant eigenvector of    P    P   P\,   and the matrix valued Kullback Leibler distance function       D   i  ,  j    K  L    =   D   K  L     [  p   (  y  |   x  j   )   |  |  p   (  y  |   c  i   )   ]   )     fragments   superscript   subscript  D   i  j      K  L      superscript  D    K  L     fragments  normal-[  p   fragments  normal-(  y  normal-|   subscript  x  j   normal-)   normal-|  normal-|  p   fragments  normal-(  y  normal-|   subscript  c  i   normal-)   normal-]   normal-)    D_{i,j}^{KL}=D^{KL}\Big[p(y|x_{j})\,||\,p(y|c_{i})\Big]\Big)     derived from the sample spacings and transition probabilities.  The matrix    p   (   y  i   |   c  j   )      fragments  p   fragments  normal-(   subscript  y  i   normal-|   subscript  c  j   normal-)     p(y_{i}|c_{j})\,   can be initialised randomly or as a reasonable guess, while matrix    p   (   c  i   |   x  j   )      fragments  p   fragments  normal-(   subscript  c  i   normal-|   subscript  x  j   normal-)     p(c_{i}|x_{j})\,   needs no prior values. Although the algorithm is converging, multiple minima may exist which need some action to resolve. Further details, including hard clustering methods, are found in [5].  Defining decision contours  To categorize a new sample     x  ′      superscript  x  normal-′    x^{\prime}\,   external to the training set    X    X   X\,   , apply the previous distance metric to find the transition probabilities between     x  ′      superscript  x  normal-′    x^{\prime}\,   and all samples in    X  :      normal-:  X  absent    X:\,\,   ,     p  ~    (   x  i   )   =  p   (   x  i   |   x  ′   )   =   \Kappa   exp   (  -  λ  f   (  |   x  i   -   x  ′   |  )   )      fragments   normal-~  p    fragments  normal-(   subscript  x  i   normal-)    p   fragments  normal-(   subscript  x  i   normal-|   superscript  x  normal-′   normal-)    \Kappa    fragments  normal-(   λ  f   fragments  normal-(  normal-|   subscript  x  i     superscript  x  normal-′   normal-|  normal-)   normal-)     \tilde{p}(x_{i})=p(x_{i}|x^{\prime})=\Kappa\exp\Big(-\lambda f\big(\Big|x_{i}-%
 x^{\prime}\Big|\big)\Big)   with    \Kappa    \Kappa   \Kappa\,   a normalisation. Secondly apply the last two lines of the 3-line algorithm to get cluster, and conditional category probabilities.       p  ~    (   c  i   )   =  p   (   c  i   |   x  ′   )   =    ∑  j    p   (   c  i   |   x  j   )   p   (   x  j   |   x  ′   )   =    ∑  j    p   (   c  i   |   x  j   )    p  ~    (   x  j   )      fragments   normal-~  p    fragments  normal-(   subscript  c  i   normal-)    p   fragments  normal-(   subscript  c  i   normal-|   superscript  x  normal-′   normal-)     subscript   j   p   fragments  normal-(   subscript  c  i   normal-|   subscript  x  j   normal-)   p   fragments  normal-(   subscript  x  j   normal-|   superscript  x  normal-′   normal-)     subscript   j   p   fragments  normal-(   subscript  c  i   normal-|   subscript  x  j   normal-)    normal-~  p    fragments  normal-(   subscript  x  j   normal-)     \displaystyle\tilde{p}(c_{i})=p(c_{i}|x^{\prime})=\sum_{j}p(c_{i}|x_{j})p(x_{j%
 }|x^{\prime})=\sum_{j}p(c_{i}|x_{j})\tilde{p}(x_{j})     Finally we have      p   (   y  i   |   x  ′   )   =   ∑  j   p   (   y  i   |   c  j   )   p   (   c  j   |   x  ′   )   )  =  ∑    j   p  (   y  i   |   c  j   )   p  ~   (   c  j   )     fragments  p   fragments  normal-(   subscript  y  i   normal-|   superscript  x  normal-′   normal-)     subscript   j   p   fragments  normal-(   subscript  y  i   normal-|   subscript  c  j   normal-)   p   fragments  normal-(   subscript  c  j   normal-|   superscript  x  normal-′   normal-)   normal-)     j   p  normal-(   subscript  y  i   normal-|   subscript  c  j   normal-)   normal-~  p   normal-(   subscript  c  j   normal-)    p(y_{i}|x^{\prime})=\sum_{j}p(y_{i}|c_{j})p(c_{j}|x^{\prime}))=\sum_{j}p(y_{i}%
 |c_{j})\tilde{p}(c_{j})\,     Parameter    β    β   \beta\,   must be kept under close supervision since, as it is increased from zero, increasing numbers of features, in the category probability space, snap into focus at certain critical thresholds.  An example  The following case examines clustering in a four quadrant multiplier with random inputs    u  ,   v      u  v    u,v\,   and two categories of output,    ±   1      plus-or-minus  1    \pm 1\,   , generated by    y  =   sign   (   u  v   )        y   sign    u  v      y=\operatorname{sign}(uv)\,   . This function has the property that there are two spatially separated clusters for each category and so it demonstrates that the method can handle such distributions.  20 samples are taken, uniformly distributed on the square      [   -  1   ,  1  ]   2      superscript     1   1   2    [-1,1]^{2}\,   . The number of clusters used beyond the number of categories, two in this case, has little effect on performance and the results are shown for two clusters using parameters     λ  =  3   ,   β  =  2.5      formulae-sequence    λ  3     β  2.5     \lambda=3,\,\beta=2.5   .  The distance function is     d   i  ,  j    =    |    x  i   -   x  j    |   2        subscript  d   i  j     superscript       subscript  x  i    subscript  x  j     2     d_{i,j}=\Big|x_{i}-x_{j}\Big|^{2}   where     x  i   =     (   u  i   ,   v  i   )   T         subscript  x  i    superscript    subscript  u  i    subscript  v  i    T     x_{i}=(u_{i},v_{i})^{T}\,   while the conditional distribution    p   (  y  |  x  )      fragments  p   fragments  normal-(  y  normal-|  x  normal-)     p(y|x)\,   is a 2 × 20 matrix      P  r   (   y  i   =  1  )   =  1  if  sign   (   u  i    v  i   )   =  1     fragments  P  r   fragments  normal-(   subscript  y  i    1  normal-)    1  if  sign   fragments  normal-(   subscript  u  i    subscript  v  i   normal-)    1    \displaystyle Pr(y_{i}=1)=1\text{ if }\operatorname{sign}(u_{i}v_{i})=1     and zero elsewhere.  The summation in line 2 is only incorporates two values representing the training values of +1 or −1 but nevertheless seems to work quite well. Five iterations of the equations were used. The figure shows the locations of the twenty samples with '0' representing Y = 1 and 'x' representing Y = −1. The contour at the unity likelihood ratio level is shown,      L  =    Pr   (  1  )     Pr   (   -  1   )     =  1        L     Pr  1    Pr    1          1     L=\frac{\Pr(1)}{\Pr(-1)}=1     as a new sample     x  ′      superscript  x  normal-′    x^{\prime}\,   is scanned over the square. Theoretically the contour should align with the    u  =   0       u  0    u=0\,   and    v  =   0       v  0    v=0\,   coordinates but for such small sample numbers they have instead followed the spurious clusterings of the sample points.  Neural network/fuzzy logic analogies  There is some analogy between this algorithm and a neural network with a single hidden layer. The internal nodes are represented by the clusters     c  j      subscript  c  j    c_{j}\,   and the first and second layers of network weights are the conditional probabilities    p   (   c  j   |   x  i   )      fragments  p   fragments  normal-(   subscript  c  j   normal-|   subscript  x  i   normal-)     p(c_{j}|x_{i})\,   and    p   (   y  k   |   c  j   )      fragments  p   fragments  normal-(   subscript  y  k   normal-|   subscript  c  j   normal-)     p(y_{k}|c_{j})\,   respectively. However, unlike a standard neural network, the present algorithm relies entirely on probabilities as inputs rather than the sample values themselves while internal and output values are all conditional probability density distributions. Nonlinear functions are encapsulated in distance metric    f   (  .  )      fragments  f   fragments  normal-(  normal-.  normal-)     f(.)\,   (or influence functions/radial basis functions ) and transition probabilities instead of sigmoid functions. The Blahut-Arimoto three-line algorithm is seen to converge rapidly, often in tens of iterations, and by varying    β    β   \beta\,   ,    λ    λ   \lambda\,   and    f    f   f\,   and the cardinality of the clusters, various levels of focus on data features can be achieved. The statistical soft clustering definition    p   (   c  i   |   x  j   )      fragments  p   fragments  normal-(   subscript  c  i   normal-|   subscript  x  j   normal-)     p(c_{i}|x_{j})\,   has some overlap with the verbal fuzzy membership concept of fuzzy logic.  Bibliography  [1] N. Tishby, F.C. Pereira, and W. Bialek: “The Information Bottleneck method”. The 37th annual Allerton Conference on Communication, Control, and Computing, Sep 1999: pp. 368–377  [2] G. Chechik, A Globerson, N. Tishby and Y. Weiss: “Information Bottleneck for Gaussian Variables”. Journal of Machine Learning Research 6, Jan 2005, pp. 165–188  [3] F. Creutzig, H. Sprekeler: Predictive Coding and the Slowness Principle: an Information-Theoretic Approach , 2008, Neural Computation 20(4): 1026–1041  [4] F. Creutzig, A. Globerson, N. Tishby: Past-future information bottleneck in dynamical systems , 2009, Physical Review E 79, 041925  [5] N Tishby, N Slonim: “Data clustering by Markovian Relaxation and the Information Bottleneck Method”, Neural Information Processing Systems (NIPS) 2000, pp. 640–646  [6] B.W. Silverman: “Density Estimation for Statistical Data Analysis”, Chapman and Hall, 1986.  [7] N. Slonim, N. Tishby: "Document Clustering using Word Clusters via the Information Bottleneck Method", SIGIR 2000, pp. 208–215  [8] Y. Weiss: "Segmentation using eigenvectors: a unifying view", Proceedings IEEE International Conference on Computer Vision 1999, pp. 975–982  [9] D. J. Miller, A. V. Rao, K. Rose, A. Gersho: "An Information-theoretic Learning Algorithm for Neural Network Classification". NIPS 1995: pp. 591–597  [10] P. Harremoes and N. Tishby "The Information Bottleneck Revisited or How to Choose a Good Distortion Measure". In proceedings of the International Symposium on Information Theory (ISIT) 2007  See also   Information theory   External links   Paper by N. Tishby, et al.   "  Category:Data clustering algorithms  Category:Multivariate statistics   
   N-electron valence state perturbation theory      N-electron valence state perturbation theory   In quantum chemistry , n -electron valence state perturbation theory (NEVPT) is a perturbative treatment applicable to multireference  CASCI-type  wavefunctions . It can be considered as a generalization of the well-known second-order M√∏ller‚ÄìPlesset perturbation theory to multireference Complete Active Space cases. The theory is directly integrated into the quantum chemistry packages DALTON and ORCA .  The research performed into the development of this theory led to various implementations. The theory here presented refers to the deployment for the Single-State NEVPT, where the perturbative correction is applied to a single electronic state. Research implementations has been also developed for Quasi-Degenerate cases, where a set of electronic states undergo the perturbative correction at the same time, allowing interaction among themselves. The theory development makes use of the quasi-degenerate formalism by Lindgren and the Hamiltonian multipartitioning technique from Zaitsevskii and Malrieu.  Theory  Let    Œ®  m   (  0  )      superscript   subscript  normal-Œ®  m   0    \Psi_{m}^{(0)}   be a zero-order CASCI wavefunction, defined as a linear combination of Slater determinants       Œ®  m   (  0  )    =    ‚àë   I  ‚àà  CAS      C   I  ,  m     |  I  ‚ü©          superscript   subscript  normal-Œ®  m   0     subscript     I  CAS       subscript  C   I  m     ket  I       \Psi_{m}^{(0)}=\sum_{I\in{\rm CAS}}C_{I,m}\left|I\right\rangle     obtained diagonalizing the true Hamiltonian    ‚Ñã  ^     normal-^  ‚Ñã    \hat{\mathcal{H}}   inside the CASCI space         ùí´  ^   CAS    ‚Ñã  ^     ùí´  ^   CAS    |   Œ®  m   (  0  )    ‚ü©    =    E  m   (  0  )     |   Œ®  m   (  0  )    ‚ü©           subscript   normal-^  ùí´   CAS    normal-^  ‚Ñã    subscript   normal-^  ùí´   CAS    ket   superscript   subscript  normal-Œ®  m   0        superscript   subscript  E  m   0    ket   superscript   subscript  normal-Œ®  m   0       \hat{\mathcal{P}}_{\rm CAS}\hat{\mathcal{H}}\hat{\mathcal{P}}_{\rm CAS}\left|%
 \Psi_{m}^{(0)}\right\rangle=E_{m}^{(0)}\left|\Psi_{m}^{(0)}\right\rangle     where     ùí´  ^   CAS     subscript   normal-^  ùí´   CAS    \hat{\mathcal{P}}_{\rm CAS}   is the projector inside the CASCI space. It is possible to define perturber wavefunctions in NEVPT as zero-order wavefunctions of the outer space (external to CAS) where   k   k   k   electrons are removed from the inactive part (core and virtual orbitals) and added to the valence part (active orbitals). At second order of perturbation     -  2   ‚â§  k  ‚â§  2          2   k       2     -2\leq k\leq 2   . Decomposing the zero-order CASCI wavefunction as an antisymmetrized product of the inactive part    Œ¶  c     subscript  normal-Œ¶  c    \Phi_{c}   and a valence part    Œ®  m  v     superscript   subscript  normal-Œ®  m   v    \Psi_{m}^{v}          |   Œ®  m   (  0  )    ‚ü©   =   |    Œ¶  c    Œ®  m  v    ‚ü©        ket   superscript   subscript  normal-Œ®  m   0     ket     subscript  normal-Œ¶  c    superscript   subscript  normal-Œ®  m   v       \left|\Psi_{m}^{(0)}\right\rangle=\left|\Phi_{c}\Psi_{m}^{v}\right\rangle     then the perturber wavefunctions can be written as       |   Œ®   l  ,  Œº   k   ‚ü©   =   |    Œ¶  l   -  k     Œ®  Œº   v  +  k     ‚ü©        ket   superscript   subscript  normal-Œ®   l  Œº    k     ket     superscript   subscript  normal-Œ¶  l     k     superscript   subscript  normal-Œ®  Œº     v  k        \left|\Psi_{l,\mu}^{k}\right\rangle=\left|\Phi_{l}^{-k}\Psi_{\mu}^{v+k}\right\rangle     The pattern of inactive orbitals involved in the procedure can be grouped as a collective index   l   l   l   , so to represent the various perturber wavefunctions as    Œ®   l  ,  Œº   k     superscript   subscript  normal-Œ®   l  Œº    k    \Psi_{l,\mu}^{k}   , with   Œº   Œº   \mu   an enumerator index for the different wavefunctions. The number of these functions is relative to the degree of contraction of the resulting perturbative space.  Supposing indexes   i   i   i   and   j   j   j   referring to core orbitals,   a   a   a   and   b   b   b   referring to active orbitals and   r   r   r   and   s   s   s   referring to virtual orbitals, the possible excitation schemes are:   two electrons from core orbitals to virtual orbitals (the active space is not enriched nor depleted of electrons, therefore    k  =  0      k  0    k=0   )  one electron from a core orbital to a virtual orbital, and one electron from a core orbital to an active orbital (the active space is enriched with one electron, therefore    k  =   +  1       k    1     k=+1   )  one electron from a core orbital to a virtual orbital, and one electron from an active orbital to a virtual orbital (the active space is depleted with one electron, therefore    k  =   -  1       k    1     k=-1   )  two electrons from core orbitals to active orbitals (active space enriched with two electrons,    k  =   +  2       k    2     k=+2   )  two electrons from active orbitals to virtual orbitals (active space depleted with two electrons,    k  =   -  2       k    2     k=-2   )   These cases always represent situations where interclass electronic excitations happen. Other three excitation schemes involve a single interclass excitation plus an intraclass excitation internal to the active space:   one electron from a core orbital to a virtual orbital, and an internal active-active excitation (    k  =  0      k  0    k=0   )  one electron from a core orbital to an active orbital, and an internal active-active excitation (    k  =   +  1       k    1     k=+1   )  one electron from an active orbital to a virtual orbital, and an internal active-active excitation (    k  =   -  1       k    1     k=-1   )   Totally Uncontracted Approach  A possible approach is to define the perturber wavefunctions into Hilbert spaces    S  l  k     superscript   subscript  S  l   k    S_{l}^{k}   defined by those determinants with given k and l labels. It is interesting to note that the determinants characterizing these spaces can be written as a partition comprising the same inactive (core + virtual) part    Œ¶  l   -  k      superscript   subscript  normal-Œ¶  l     k     \Phi_{l}^{-k}   and all possible valence (active) parts    Œ®  I  k     superscript   subscript  normal-Œ®  I   k    \Psi_{I}^{k}           S  l  k      =  def     {    Œ¶  l   -  k     Œ®  I  k    }       superscript   def    superscript   subscript  S  l   k       superscript   subscript  normal-Œ¶  l     k     superscript   subscript  normal-Œ®  I   k       S_{l}^{k}\ \stackrel{\mathrm{def}}{=}\ \{\Phi_{l}^{-k}\Psi_{I}^{k}\}     The full dimensionality of these spaces can be exploited to obtain the definition of the perturbers, by diagonalizing the Hamiltonian inside them         ùí´  ^    S  l  k     ‚Ñã  ^     ùí´  ^    S  l  k     |    Œ¶  l   -  k     Œ®  Œº   v  +  k     ‚ü©    =    E   l  ,  Œº     |    Œ¶  l   -  k     Œ®  Œº   v  +  k     ‚ü©           subscript   normal-^  ùí´    superscript   subscript  S  l   k     normal-^  ‚Ñã    subscript   normal-^  ùí´    superscript   subscript  S  l   k     ket     superscript   subscript  normal-Œ¶  l     k     superscript   subscript  normal-Œ®  Œº     v  k          subscript  E   l  Œº     ket     superscript   subscript  normal-Œ¶  l     k     superscript   subscript  normal-Œ®  Œº     v  k         \hat{\mathcal{P}}_{S_{l}^{k}}\hat{\mathcal{H}}\hat{\mathcal{P}}_{S_{l}^{k}}%
 \left|\Phi_{l}^{-k}\Psi_{\mu}^{v+k}\right\rangle=E_{l,\mu}\left|\Phi_{l}^{-k}%
 \Psi_{\mu}^{v+k}\right\rangle     This procedure is impractical given its high computational cost: for each    S  l  k     superscript   subscript  S  l   k    S_{l}^{k}   space, a diagonalization of the true Hamiltonian must be performed. Computationally, is preferable to improve the theoretical development making use of the modified Dyall's Hamiltonian      ‚Ñã  ^   D     superscript   normal-^  ‚Ñã   D    \hat{\mathcal{H}}^{D}   . This Hamiltonian behaves like the true Hamiltonian inside the CAS space, having the same eigenvalues and eigenvectors of the true Hamiltonian projected onto the CAS space. Also, given the decomposition for the wavefunction defined before, the action of the Dyall's Hamiltonian can be partitioned into         ‚Ñã  ^   D    |    Œ¶  l   -  k     Œ®  Œº   v  +  k     ‚ü©    =    E   l  ,  Œº   k    |    Œ¶  l   -  k     Œ®  Œº   v  +  k     ‚ü©           superscript   normal-^  ‚Ñã   D    ket     superscript   subscript  normal-Œ¶  l     k     superscript   subscript  normal-Œ®  Œº     v  k          superscript   subscript  E   l  Œº    k    ket     superscript   subscript  normal-Œ¶  l     k     superscript   subscript  normal-Œ®  Œº     v  k         \hat{\mathcal{H}}^{D}\left|\Phi_{l}^{-k}\Psi_{\mu}^{v+k}\right\rangle=E_{l,\mu%
 }^{k}\left|\Phi_{l}^{-k}\Psi_{\mu}^{v+k}\right\rangle     stripping out the constant contribution of the inactive part and leaving a subsystem to be solved for the valence part         ‚Ñã  ^   v  D    |   Œ®  Œº   v  +  k    ‚ü©    =    E  Œº  k    |   Œ®  Œº   v  +  k    ‚ü©           subscript   superscript   normal-^  ‚Ñã   D   v    ket   superscript   subscript  normal-Œ®  Œº     v  k         superscript   subscript  E  Œº   k    ket   superscript   subscript  normal-Œ®  Œº     v  k        \hat{\mathcal{H}}^{D}_{v}\left|\Psi_{\mu}^{v+k}\right\rangle=E_{\mu}^{k}\left|%
 \Psi_{\mu}^{v+k}\right\rangle     The total energy    E   l  ,  Œº   k     superscript   subscript  E   l  Œº    k    E_{l,\mu}^{k}   is the sum of    E  Œº  k     superscript   subscript  E  Œº   k    E_{\mu}^{k}   and the energies of the orbitals involved in the definition of the inactive part    Œ¶  l   -  k      superscript   subscript  normal-Œ¶  l     k     \Phi_{l}^{-k}   . This introduces the possibility to perform a single diagonalization of the valence Dyall's Hamiltonian on the CASCI zero-order wavefunction and evaluate the perturber energies using the property depicted above.  Strongly Contracted Approach  A different choice in the development of the NEVPT approach is to choose a single function for each space    S  l  k     superscript   subscript  S  l   k    S_{l}^{k}   , leading to the Strongly Contracted (SC) scheme. A set of perturbative operators are used to produce a single function for each space, defined as the projection inside each space     ùí´  ^    S  l  k      subscript   normal-^  ùí´    superscript   subscript  S  l   k     \hat{\mathcal{P}}_{S_{l}^{k}}   of the application of the Hamiltonian to the contracted zero order wavefunction. In other words       Œ®  l  k   =     ùí´  ^    S  l  k     ‚Ñã  ^    Œ®  m   (  0  )          superscript   subscript  normal-Œ®  l   k      subscript   normal-^  ùí´    superscript   subscript  S  l   k     normal-^  ‚Ñã    superscript   subscript  normal-Œ®  m   0      \Psi_{l}^{k}=\hat{\mathcal{P}}_{S_{l}^{k}}\hat{\mathcal{H}}\Psi_{m}^{(0)}     where     ùí´  ^    S  l  k      subscript   normal-^  ùí´    superscript   subscript  S  l   k     \hat{\mathcal{P}}_{S_{l}^{k}}   is the projector onto the subspace. This can be equivalently written as the application of a specific part of the Hamiltonian to the zero-order wavefunction       Œ®  l  k   =    V  l  k    Œ®  m   (  0  )          superscript   subscript  normal-Œ®  l   k      superscript   subscript  V  l   k    superscript   subscript  normal-Œ®  m   0      \Psi_{l}^{k}=V_{l}^{k}\Psi_{m}^{(0)}     For each space, appropriate operators can be devised. We will not present their definition, as it could result overkilling. Suffice to say that the resulting perturbers are not normalized, and their norm       N  l  k   =   ‚ü®   Œ®  l  k   |   Œ®  l  k   ‚ü©   =   ‚ü®   Œ®  m   (  0  )    |     (   V  l  k   )   +    V  l  k    |   Œ®  m   (  0  )    ‚ü©          superscript   subscript  N  l   k    inner-product   superscript   subscript  normal-Œ®  l   k    superscript   subscript  normal-Œ®  l   k          quantum-operator-product   superscript   subscript  normal-Œ®  m   0      superscript   superscript   subscript  V  l   k      superscript   subscript  V  l   k     superscript   subscript  normal-Œ®  m   0       N_{l}^{k}=\left\langle\Psi_{l}^{k}\left.\right|\Psi_{l}^{k}\right\rangle=\left%
 \langle\Psi_{m}^{(0)}\left|\left(V_{l}^{k}\right)^{+}V_{l}^{k}\right|\Psi_{m}^%
 {(0)}\right\rangle     plays an important role in the Strongly Contracted development. To evaluate these norms, the spinless density matrix of rank not higher than three between the    Œ®  m   (  0  )      superscript   subscript  normal-Œ®  m   0    \Psi_{m}^{(0)}   functions are needed.  An important property of the    Œ®  l  k     superscript   subscript  normal-Œ®  l   k    \Psi_{l}^{k}   is that any other function of the space    S  l  k     superscript   subscript  S  l   k    S_{l}^{k}   which is orthogonal to    Œ®  l  k     superscript   subscript  normal-Œ®  l   k    \Psi_{l}^{k}   do not interact with the zero-order wavefunction through the true Hamiltonian. It is possible to use the    Œ®  l  k     superscript   subscript  normal-Œ®  l   k    \Psi_{l}^{k}   functions as a basis set for the expansion of the first-order correction to the wavefunction, and also for the expression of the zero-order Hamiltonian by means of a spectral decomposition         ‚Ñã  ^   0   =   ‚àë   l  k    |   Œ®  l  k    ‚ü©    ‚Ä≤     E  l  k    ‚ü®   Œ®  l  k    ‚ü©    ‚Ä≤    +   ‚àë  m   |   Œ®  m   (  0  )    ‚ü©  E    m      (  0  )    ‚ü®   Œ®  m   (  0  )    |     fragments   fragments   subscript   normal-^  ‚Ñã   0     subscript     l  k    normal-|   superscript   subscript  normal-Œ®  l   k    superscript  normal-‚ü©  normal-‚Ä≤     superscript   subscript  E  l   k    fragments  normal-‚ü®   superscript   subscript  normal-Œ®  l   k    superscript  normal-‚ü©  normal-‚Ä≤      subscript   m   normal-|   superscript   subscript  normal-Œ®  m   0   normal-‚ü©  E   m    0   normal-‚ü®   superscript   subscript  normal-Œ®  m   0   normal-|    \hat{\mathcal{H}}_{0}=\sum_{lk}\left|\Psi_{l}^{k}{}^{\prime}\right\rangle E_{l%
 }^{k}\left\langle\Psi_{l}^{k}{}^{\prime}\right\rangle+\sum_{m}\left|\Psi_{m}^{%
 (0)}\right\rangle E_{m}^{(0)}\left\langle\Psi_{m}^{(0)}\right|     where    |   Œ®  l  k    ‚ü©    ‚Ä≤      fragments  normal-|   superscript   subscript  normal-Œ®  l   k    superscript  normal-‚ü©  normal-‚Ä≤     \left|\Psi_{l}^{k}{}^{\prime}\right\rangle   are the normalized    |   Œ®  l  k   ‚ü©     ket   superscript   subscript  normal-Œ®  l   k     \left|\Psi_{l}^{k}\right\rangle   .  The expression for the first-order correction to the wavefunction is therefore        Œ®  m   (  1  )    =   ‚àë   k  l    |   Œ®  l  k    ‚ü©    ‚Ä≤      ‚ü®   Œ®  l  k    |    ‚Ä≤    ‚Ñã  ^   |   Œ®  m   (  0  )    ‚ü©     E  m   (  0  )    -   E  l  k     =   ‚àë   k  l    |   Œ®  l  k    ‚ü©    ‚Ä≤      N  l  k      E  m   (  0  )    -   E  l  k        fragments   fragments   superscript   subscript  normal-Œ®  m   1     subscript     k  l    normal-|   superscript   subscript  normal-Œ®  l   k    superscript  normal-‚ü©  normal-‚Ä≤       fragments  normal-‚ü®   superscript   subscript  normal-Œ®  l   k    superscript  normal-|  normal-‚Ä≤    normal-^  ‚Ñã   normal-|   superscript   subscript  normal-Œ®  m   0   normal-‚ü©      superscript   subscript  E  m   0    superscript   subscript  E  l   k       subscript     k  l    normal-|   superscript   subscript  normal-Œ®  l   k    superscript  normal-‚ü©  normal-‚Ä≤        superscript   subscript  N  l   k       superscript   subscript  E  m   0    superscript   subscript  E  l   k       \Psi_{m}^{(1)}=\sum_{kl}\left|\Psi_{l}^{k}{}^{\prime}\right\rangle\frac{\left%
 \langle\Psi_{l}^{k}{}^{\prime}\left|\hat{\mathcal{H}}\right|\Psi_{m}^{(0)}%
 \right\rangle}{E_{m}^{(0)}-E_{l}^{k}}=\sum_{kl}\left|\Psi_{l}^{k}{}^{\prime}%
 \right\rangle\frac{\sqrt{N_{l}^{k}}}{E_{m}^{(0)}-E_{l}^{k}}     and for the energy is       E  m   (  2  )    =    ‚àë   k  l      |   ‚ü®   Œ®  l  k    |    ‚Ä≤    ‚Ñã  ^   |   Œ®  m   (  0  )    ‚ü©    |  2      E  m   (  0  )    -   E  l  k      =    ‚àë   k  l      N  l  k     E  m   (  0  )    -   E  l  k             superscript   subscript  E  m   2     subscript     k  l       fragments  normal-|   fragments  normal-‚ü®   superscript   subscript  normal-Œ®  l   k    superscript  normal-|  normal-‚Ä≤    normal-^  ‚Ñã   normal-|   superscript   subscript  normal-Œ®  m   0   normal-‚ü©    superscript  normal-|  2       superscript   subscript  E  m   0    superscript   subscript  E  l   k             subscript     k  l       superscript   subscript  N  l   k      superscript   subscript  E  m   0    superscript   subscript  E  l   k         E_{m}^{(2)}=\sum_{kl}\frac{\left|\left\langle\Psi_{l}^{k}{}^{\prime}\left|\hat%
 {\mathcal{H}}\right|\Psi_{m}^{(0)}\right\rangle\right|^{2}}{E_{m}^{(0)}-E_{l}^%
 {k}}=\sum_{kl}\frac{N_{l}^{k}}{E_{m}^{(0)}-E_{l}^{k}}     It is important to note that this result still misses a definition of the perturber energies    E  l  k     superscript   subscript  E  l   k    E_{l}^{k}   , which can be defined in a computationally advantageous approach by means of the Dyall's Hamiltonian       E  l  k   =    1   N  l  k     ‚ü®   Œ®  l  k   |    ‚Ñã  ^   D   |   Œ®  l  k   ‚ü©         superscript   subscript  E  l   k       1   superscript   subscript  N  l   k     quantum-operator-product   superscript   subscript  normal-Œ®  l   k    superscript   normal-^  ‚Ñã   D    superscript   subscript  normal-Œ®  l   k       E_{l}^{k}=\frac{1}{N_{l}^{k}}\left\langle\Psi_{l}^{k}\left|\hat{\mathcal{H}}^{%
 D}\right|\Psi_{l}^{k}\right\rangle     leading to        N  l  k    E  l  k    =   ‚ü®   Œ®  m   (  0  )    |     (   V  l  k   )   +     ‚Ñã  ^   D    V  l  k    |   Œ®  m   (  0  )    ‚ü©   =    ‚ü®   Œ®  m   (  0  )    |     (   V  l  k   )   +    V  l  k     ‚Ñã  ^   D    |   Œ®  m   (  0  )    ‚ü©   +   ‚ü®   Œ®  m   (  0  )    |     (   V  l  k   )   +    [    ‚Ñã  ^   D   ,   V  l  k   ]    |   Œ®  m   (  0  )    ‚ü©             superscript   subscript  N  l   k    superscript   subscript  E  l   k     quantum-operator-product   superscript   subscript  normal-Œ®  m   0      superscript   superscript   subscript  V  l   k      superscript   normal-^  ‚Ñã   D    superscript   subscript  V  l   k     superscript   subscript  normal-Œ®  m   0            quantum-operator-product   superscript   subscript  normal-Œ®  m   0      superscript   superscript   subscript  V  l   k      superscript   subscript  V  l   k    superscript   normal-^  ‚Ñã   D     superscript   subscript  normal-Œ®  m   0     quantum-operator-product   superscript   subscript  normal-Œ®  m   0      superscript   superscript   subscript  V  l   k       superscript   normal-^  ‚Ñã   D    superscript   subscript  V  l   k      superscript   subscript  normal-Œ®  m   0        N_{l}^{k}E_{l}^{k}=\left\langle\Psi_{m}^{(0)}\left|\left(V_{l}^{k}\right)^{+}%
 \hat{\mathcal{H}}^{D}V_{l}^{k}\right|\Psi_{m}^{(0)}\right\rangle=\left\langle%
 \Psi_{m}^{(0)}\left|\left(V_{l}^{k}\right)^{+}V_{l}^{k}\hat{\mathcal{H}}^{D}%
 \right|\Psi_{m}^{(0)}\right\rangle+\left\langle\Psi_{m}^{(0)}\left|\left(V_{l}%
 ^{k}\right)^{+}\left[\hat{\mathcal{H}}^{D},V_{l}^{k}\right]\right|\Psi_{m}^{(0%
 )}\right\rangle     Developing the first term and extracting the inactive part of the Dyall's Hamiltonian it can be obtained       E  l  k   =    E  m   (  0  )    +   Œî   œµ  l    +    1   N  l  k     ‚ü®   Œ®  m   (  0  )    |     (   V  l  k   )   +    [    ‚Ñã  ^   v   ,   V  l  k   ]    |   Œ®  m   (  0  )    ‚ü©          superscript   subscript  E  l   k      superscript   subscript  E  m   0     normal-Œî   subscript  œµ  l        1   superscript   subscript  N  l   k     quantum-operator-product   superscript   subscript  normal-Œ®  m   0      superscript   superscript   subscript  V  l   k       subscript   normal-^  ‚Ñã   v    superscript   subscript  V  l   k      superscript   subscript  normal-Œ®  m   0        E_{l}^{k}=E_{m}^{(0)}+\Delta\epsilon_{l}+\frac{1}{N_{l}^{k}}\left\langle\Psi_{%
 m}^{(0)}\left|\left(V_{l}^{k}\right)^{+}\left[\hat{\mathcal{H}}_{v},V_{l}^{k}%
 \right]\right|\Psi_{m}^{(0)}\right\rangle     with    Œî   œµ  l       normal-Œî   subscript  œµ  l     \Delta\epsilon_{l}   equal to the sum of the orbital energies of the newly occupied virtual orbitals minus the orbital energies of the unoccupied core orbitals.  The term that still need to be evaluated is the braket involving the commutator. This can be obtained developing each   V   V   V   operator and substituting. To obtain the final result is necessary to evaluate Koopmans matrices and density matrices involving only active indexes. An interesting case is represented by the contribution for the    V   i  j  r  s    (  0  )      superscript   subscript  V    i  j  r  s    0    V_{ijrs}^{(0)}   case, which is trivial and can be demonstrated identical to the M√∏ller‚ÄìPlesset second-order contribution        E  m   (  2  )     (   S   r  s  i  j   0   )    =   -    N   r  s  i  j   0      œµ  r   +   œµ  s    -   œµ  i   -   œµ  j             superscript   subscript  E  m   2    superscript   subscript  S    r  s  i  j    0         superscript   subscript  N    r  s  i  j    0        subscript  œµ  r    subscript  œµ  s     subscript  œµ  i    subscript  œµ  j        E_{m}^{(2)}\left(S_{rsij}^{0}\right)=-\frac{N_{rsij}^{0}}{\epsilon_{r}+%
 \epsilon_{s}-\epsilon_{i}-\epsilon_{j}}     NEVPT2 can therefore be seen as a generalized form of MP2 to multireference wavefunctions.  Partially Contracted Approach  An alternative approach, named Partially Contracted (PC) is to define the perturber wavefunctions in a subspace     S  ¬Ø   l  k     superscript   subscript   normal-¬Ø  S   l   k    \overline{S}_{l}^{k}   of    S  l  k     superscript   subscript  S  l   k    S_{l}^{k}   with dimensionality higher than one (like in case of the Strongly Contracted approach). To define this subspace, a set of functions   Œ¶   normal-Œ¶   \Phi   is generated by means of the    V  l  k     superscript   subscript  V  l   k    V_{l}^{k}   operators, after decontraction of their formulation. For example, in the case of the    V   r  s  i    -  1      superscript   subscript  V    r  s  i      1     V_{rsi}^{-1}   operator        V   r  s  i    -  1    =    Œ≥   r  s      ‚àë  a    (     ‚ü®   r  s   |   i  a   ‚ü©    E   r  i     E   s  a     +    ‚ü®   s  r   |   i  a   ‚ü©    E   s  i     E   r  a      )       r  ‚â§  s      formulae-sequence     superscript   subscript  V    r  s  i      1       subscript  Œ≥    r  s      subscript   a        inner-product    r  s     i  a     subscript  E    r  i     subscript  E    s  a        inner-product    s  r     i  a     subscript  E    s  i     subscript  E    r  a           r  s     V_{rsi}^{-1}=\gamma_{rs}\sum_{a}\left(\left\langle rs\left.\right|ia\right%
 \rangle E_{ri}E_{sa}+\left\langle sr\left.\right|ia\right\rangle E_{si}E_{ra}%
 \right)\quad r\leq s     The Partially Contracted approach makes use of functions     Œ¶   r  i  s  a    =    E   r  i     E   s  a     Œ®  m   (  0  )          subscript  normal-Œ¶    r  i  s  a       subscript  E    r  i     subscript  E    s  a     superscript   subscript  normal-Œ®  m   0      \Phi_{risa}=E_{ri}E_{sa}\Psi_{m}^{(0)}   and     Œ¶   r  i  s  a    =    E   s  i     E   r  a     Œ®  m   (  0  )          subscript  normal-Œ¶    r  i  s  a       subscript  E    s  i     subscript  E    r  a     superscript   subscript  normal-Œ®  m   0      \Phi_{risa}=E_{si}E_{ra}\Psi_{m}^{(0)}   . These functions must be orthonormalized and purged of linear dependencies which may arise. The resulting set spans the     S  ¬Ø    r  s  i    -  1      superscript   subscript   normal-¬Ø  S     r  s  i      1     \overline{S}_{rsi}^{-1}   space.  Once all the     S  ¬Ø   l  k     superscript   subscript   normal-¬Ø  S   l   k    \overline{S}_{l}^{k}   spaces have been defined, we can obtain as usual a set of perturbers from the diagonalization of the Hamiltonian (true or Dyall) inside this space         ùí´  ^     S  ¬Ø   l  k     ‚Ñã  ^     ùí´  ^     S  ¬Ø   l  k     |   Œ®   l  Œº   k   ‚ü©    =    E   l  ,  Œº   k    |   Œ®   l  Œº   k   ‚ü©           subscript   normal-^  ùí´    superscript   subscript   normal-¬Ø  S   l   k     normal-^  ‚Ñã    subscript   normal-^  ùí´    superscript   subscript   normal-¬Ø  S   l   k     ket   superscript   subscript  normal-Œ®    l  Œº    k        superscript   subscript  E   l  Œº    k    ket   superscript   subscript  normal-Œ®    l  Œº    k       \hat{\mathcal{P}}_{\overline{S}_{l}^{k}}\hat{\mathcal{H}}\hat{\mathcal{P}}_{%
 \overline{S}_{l}^{k}}\left|\Psi_{l\mu}^{k}\right\rangle=E_{l,\mu}^{k}\left|%
 \Psi_{l\mu}^{k}\right\rangle     As usual, the evaluation of the Partially Contracted perturbative correction by means of the Dyall Hamiltonian involves simply manageable entities for nowadays computers.  Although the Strongly Contracted approach makes use of a perturbative space with very low flexibility, in general it provides values in very good agreement with those obtained by the more decontracted space defined for the Partially Contracted approach. This can be probably explained by the fact that the Strongly Contracted perturbers are a good average of the totally decontracted perturbative space.  It should also be noted that the Partially Contracted evaluation has a very little overhead in computational cost with respect to the Strongly Contracted one, therefore they are normally evaluated together.  Properties  NEVPT is blessed with many important properties, making the approach very solid and reliable. These properties arise both from the theoretical approach used and on the Dyall's Hamiltonian particular structure:   Size consistency : NEVPT is size consistent ( strict separable ). Briefly, if A and B are two non-interacting systems, the energy of the supersystem A-B is equal to the sum of the energy of A plus the energy of B taken by themselves (     E   (   A  -  B   )    =    E   (  A  )    +   E   (  B  )           E    A  B        E  A     E  B      E(A-B)=E(A)+E(B)   ). This property is of particular importance to obtain correctly behaving dissociation curves.    Absence of intruder states : in perturbation theory, divergencies can occur if the energy of some perturber happens to be nearly equal to the energy of the zero-order wavefunction. This situation, which is due to the presence of an energy difference at the denominator, can be avoided if the energies associated to the perturbers are guaranteed to be never nearly equal to the zero-order energy. NEVPT satisfies this requirement.    Invariance under active orbital rotation : The NEVPT results are stable if an intraclass active-active orbital mixing occurs. This arises both from the structure of the Dyall Hamiltonian and the properties of a CASSCF wavefunction. This property has been also extended to the intraclass core-core and virtual-virtual mixing, thanks to the Non Canonical NEVPT approach, allowing to apply a NEVPT evaluation without performing an orbital canonization (which is required, as we saw previously)    Spin purity is guaranteed : The resulting wavefunctions are guaranteed to be spin pure, due to the spin-free formalism.    Efficiency : although not a formal theoretical property, computational efficiency is highly important for the evaluation on medium-size molecular systems. The current limit of the NEVPT application is largely dependent on the feasibility of the previous CASSCF evaluation, which scales factorially with respect to the active space size. The NEVPT implementation using the Dyall's Hamiltonian involves the evaluation of Koopmans' matrices and density matrices up to the four-particle density matrix spanning only active orbitals. This is particularly convenient, given the small size of currently used active spaces.    Partitioning into additive classes : The perturbative correction to the energy is additive on eight different contributions. Although the evaluation of each contribution has a different computational cost, this fact can be used to improve performance, by parallelizing each contribution to a different processor.   See also   Electron correlation  Perturbation theory (quantum mechanics)  Post-Hartree‚ÄìFock   References       "  Category:Electron states  Category:Computational chemistry   
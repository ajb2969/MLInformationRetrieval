   Schuette‚ÄìNesbitt formula      Schuette‚ÄìNesbitt formula   In mathematics , the Schuette‚ÄìNesbitt formula is a generalization of the inclusion‚Äìexclusion principle . It is named after Donald R. Schuette and Cecil J. Nesbitt .  The probabilistic version of the Schuette‚ÄìNesbitt formula has practical applications in actuarial science , where it is used to calculate the net single premium for life annuities and life insurances based on the general symmetric status.  Combinatorial versions  Consider a set    Œ©   normal-Œ©   Œ©   and subsets  . Let  denote the number of subsets to which    œâ  ‚àà  Œ©      œâ  normal-‚àà  normal-Œ©    œâ‚ààŒ©   belongs, where we use the indicator functions of the sets . Furthermore, for each     k  ‚àà  0   ,  1  ,  ‚Ä¶  ,  m       k  normal-‚àà  0   1  normal-‚Ä¶  m    k‚àà{0,1,...,m}   , let  denote the number of intersections of exactly   k   k   k   sets out of , to which   œâ   œâ   œâ   belongs, where the intersection over the empty index set is defined as   Œ©   normal-Œ©   Œ©   , hence 1 Œ© }} . Let   V   V   V   denote a vector space over a field    R   R   R   such as the real or complex numbers (or more generally a module over a ring    R   R   R   with multiplicative identity ). Then, for every choice of ,  c_n = \sum_{k=0}^m N_k\sum_{l=0}^k (-1)^{k-l}\binom klc_l,| 3 }}  where }} denotes the indicator function of the set of all    œâ  ‚àà  Œ©      œâ  normal-‚àà  normal-Œ©    œâ‚ààŒ©   with     N   (  œâ  )    =  n        N  œâ   n    N(œâ)=n   , and    (      k      l      )     binomial  k  l    \textstyle{\left({{k}\atop{l}}\right)}   is a binomial coefficient . Equality () says that the two   V   V   V   -valued functions defined on   Œ©   normal-Œ©   Œ©   are the same.    Proof of ()    We prove that () holds pointwise. Take    œâ  ‚àà  Œ©      œâ  normal-‚àà  normal-Œ©    œâ‚ààŒ©   and define    n  =   N   (  œâ  )        n    N  œâ     n=N(œâ)   . Then the left-hand side of () equals . Let   I   I   I   denote the set of all those indices     i  ‚àà  1   ,  ‚Ä¶  ,  m       i  normal-‚àà  1   normal-‚Ä¶  m    i‚àà{1,...,m}   such that , hence   I   I   I   contains exactly   n   n   n   indices. Given     J  ‚äÇ  1   ,  ‚Ä¶  ,  m       J  normal-‚äÇ  1   normal-‚Ä¶  m    J‚äÇ{1,...,m}   with   k   k   k   elements, then   œâ   œâ   œâ   belongs to the intersection if and only if   J   J   J   is a subset of   I   I   I   . By the combinatorial interpretation of the binomial coefficient , there are }}     (      n      k      )     binomial  n  k    \textstyle{\left({{n}\atop{k}}\right)}   such subsets (the binomial coefficient is zero for    k  >  n      k  n    k>n   ). Therefore the right-hand side of () evaluated at   œâ   œâ   œâ   equals         ‚àë   k  =  0   m     (     n      k     )     ‚àë   l  =  0   k      (   -  1   )    k  -  l     (     k      l     )    c  l       =    ‚àë   l  =  0   m        ‚àë   k  =  l   n      (   -  1   )    k  -  l     (     n      k     )    (     k      l     )     ‚èü    =    :   (  *  )       c  l      ,        superscript   subscript     k  0    m      binomial  n  k     superscript   subscript     l  0    k      superscript    1     k  l     binomial  k  l    subscript  c  l         superscript   subscript     l  0    m      subscript   normal-‚èü    superscript   subscript     k  l    n      superscript    1     k  l     binomial  n  k    binomial  k  l         normal-:  absent       subscript  c  l       \sum_{k=0}^{m}{\left({{n}\atop{k}}\right)}\sum_{l=0}^{k}(-1)^{k-l}{\left({{k}%
 \atop{l}}\right)}c_{l}=\sum_{l=0}^{m}\underbrace{\sum_{k=l}^{n}(-1)^{k-l}{%
 \left({{n}\atop{k}}\right)}{\left({{k}\atop{l}}\right)}}_{=:\,(*)}c_{l},     where we used that the first binomial coefficient is zero for    k  >  n      k  n    k>n   . Note that the sum (*) is empty and therefore defined as zero for    (  *  )      \displaystyle(*)         j  =   k  ‚àí  l       j    k  normal-‚àí  l     j=k‚àíl   Rewriting (**) with the summation index    (  *  *  )     fragments  normal-(    normal-)    \displaystyle(**)   und using the binomial formula for the third equality shows that     n   n   n   which is the Kronecker delta . Substituting this result into the above formula and noting that   l   l   l   choose   1   1   1   equals    l  =  n      l  n    l=n   for   œâ   œâ   œâ   , it follows that the right-hand side of () evaluated at   V   V   V   also reduces to .    Representation in the polynomial ring  As a special case, take for    R  x  x      R  x  x    Rxx   the polynomial ring    x   x   x   with the indeterminate    œâ   œâ   œâ   . Then () can be rewritten in a more compact way as  x^n = \sum_{k=0}^m N_k(x-1)^k.| 4 }}  This is an identity for two polynomials whose coefficients depend on     n  ‚àà  0   ,  ‚Ä¶  ,  m       n  normal-‚àà  0   normal-‚Ä¶  m    n‚àà{0,...,m}   , which is implicit in the notation.    Proof of () using ()    Substituting  x n }} for       ‚àë   n  =  0   m     1   {  N  =  n  }     x  n     =    ‚àë   k  =  0   m     N  k       ‚àë   l  =  0   k     (     k      l     )     (   -  1   )    k  -  l     x  l     ‚èü     =    (   x  -  1   )   k        ,        superscript   subscript     n  0    m      subscript  1   fragments  normal-{  N   n  normal-}     superscript  x  n       superscript   subscript     k  0    m      subscript  N  k    subscript   normal-‚èü    superscript   subscript     l  0    k      binomial  k  l    superscript    1     k  l     superscript  x  l        absent   superscript    x  1   k         \sum_{n=0}^{m}1_{\{N=n\}}x^{n}=\sum_{k=0}^{m}N_{k}\underbrace{\sum_{l=0}^{k}{%
 \left({{k}\atop{l}}\right)}(-1)^{k-l}x^{l}}_{=\,(x-1)^{k}},   into () and using the binomial formula shows that     E   E   E   which proves ().    Representation with shift and difference operators  Consider the linear  shift operator    Œî   normal-Œî   Œî   and the linear difference operator    V   V   V   , which we define here on the sequence space of    E  :   V   ‚Ñï  0       normal-:  E   superscript  V   subscript  ‚Ñï  0      \displaystyle E:V^{\mathbb{N}_{0}}   by      Œî  :   V   ‚Ñï  0       normal-:  normal-Œî   superscript  V   subscript  ‚Ñï  0      \displaystyle\Delta:V^{\mathbb{N}_{0}}     and      x  =  E      x  E    x=E     Substituting    Œî  =   E  ‚Äì  I       normal-Œî    E  normal-‚Äì  I     Œî=E‚ÄìI   in () shows that  E^n = \sum_{k=0}^m N_k\Delta^k,| 5 }}  where we used that   I   I   I   with   I   I   I   denoting the identity operator . Note that and equal the identity operator   k   k   k   on the sequence space, and denote the   Œ©   normal-Œ©   Œ©   -fold composition .    Direct proof of () by the operator method    To prove (), we first want to verify the equation E^n=\prod_{j=1}^m(1_{A_j^{\mathrm c}}I+1_{A_j}E)| * }}  involving indicator functions of the sets and their complements with respect to   œâ   œâ   œâ   . Suppose an   Œ©   normal-Œ©   Œ©   from   k   k   k   belongs to exactly     k  ‚àà  0   ,  ‚Ä¶  ,  m       k  normal-‚àà  0   normal-‚Ä¶  m    k‚àà{0,...,m}   sets out of , where   œâ   œâ   œâ   , for simplicity of notation say that   k   k   k   only belongs to . Then the left-hand side of () is . On the right-hand side of (), the first   E   E   E   factors equal   I   I   I   , the remaining ones equal      1   A  j  c    I   +    1   A  j    E          subscript  1   superscript   subscript  A  j   normal-c    I      subscript  1   subscript  A  j    E     \displaystyle 1_{A_{j}^{\mathrm{c}}}I+1_{A_{j}}E   , their product is also , hence the formula () is true.  Note that         ‚àë   n  =  0   m     1   {  N  =  n  }     E  n     =    ‚àë   k  =  0   m     ‚àë       J  ‚äÇ   {  1  ,  ‚Ä¶  ,  m  }          |  J  |   =  k          1    ‚à©   j  ‚àà  J     A  j      Œî  k       ,        superscript   subscript     n  0    m      subscript  1   fragments  normal-{  N   n  normal-}     superscript  E  n       superscript   subscript     k  0    m     subscript    STACKED    J   1  normal-‚Ä¶  m        J   k        subscript  1    subscript     j  J     subscript  A  j      superscript  normal-Œî  k        \sum_{n=0}^{m}1_{\{N=n\}}E^{n}=\sum_{k=0}^{m}\sum_{\scriptstyle J\subset\{1,%
 \ldots,m\}\atop\scriptstyle|J|=k}1_{\cap_{j\in J}A_{j}}\Delta^{k},     Inserting this result into equation () and expanding the product gives     k   k   k     because the product of indicator functions is the indicator function of the intersection. Using the definition (), the result () follows.    Let denote the 0th component of the    (  Œ©  ,  ‚Ñ±  ,    ‚Ñô   )     normal-Œ©  ‚Ñ±    normal-  normal-‚Ñô     (Œ©,\mathcal{F},‚Äâ‚Ñô)   -fold composition  applied to ( c 0 , c 1 , ..., c m , ...)}} , where denotes the identity. Then () can be rewritten in a more compact way as  c_n = \sum_{k=0}^m N_k(\Delta^k c)_0.| 6 }}  Probabilistic versions  Consider arbitrary events  in a probability space    ùêÑ   ùêÑ   \mathbf{E}   and let   N   N   N   denote the expectation operator . Then   Œ©   normal-Œ©   Œ©   from () is the random number of these events which occur simultaneously. Using from (), define  where the intersection over the empty index set is again defined as   R   R   R   , hence 1}} . If the ring    R  x  x      R  x  x    Rxx   is also an algebra over the real or complex numbers, then taking the expectation of the coefficients in () and using the notation from (),  in   R   R   R   . If   N   N   N   is the field of real numbers, then this is the probability-generating function of the probability distribution of   V   V   V   .  Similarly, () and () yield  and, for every sequence ( c 0 , c 1 , c 2 , c 3 , ..., c m , ...)}} ,  The quantity on the left-hand side of () is the expected value of .  Remarks   In actuarial science , the name Schuette‚ÄìNesbitt formula refers to equation (), where   E   E   E   denotes the set of real numbers.  The left-hand side of equation () is a convex combination of the powers of the shift operator    c  =   (  0  ,  1  ,  1  ,  ‚Ä¶  )       c   0  1  1  normal-‚Ä¶     c=(0,1,1,...)   , it can be seen as the expected value of random operator . Accordingly, the left-hand side of equation () is the expected value of random component . Note that both have a discrete probability distribution with finite support , hence expectations are just the well-defined finite sums.  The probabilistic version of the inclusion‚Äìexclusion principle can be derived from equation () by choosing the sequence    N  ‚â•  1      N  normal-‚â•  1    {N‚â•1}   : the left-hand side reduces to the probability of the event     k  ‚àà  1   ,  ‚Ä¶  ,  m       k  normal-‚àà  1   normal-‚Ä¶  m    k‚àà{1,...,m}   , which is the union of , and the right-hand side is , because 0}} and ‚Äì(‚Äì1) k }} for    m  +  1      m  1    m+1   .  Equations (), (), () and () are also true when the shift operator and the difference operator are considered on a subspace like the spaces .  If desired, the formulae (), (), () and () can be considered in finite dimensions, because only the first   E   E   E   components of the sequences matter. Hence, represent the linear shift operator   Œî   normal-Œî   Œî   and the linear difference opertor    (   m  +  1   )      m  1    (m+1)   as mappings of the     (   m  +  1   )   √ó   (   m  +  1   )         m  1   normal-√ó    m  1     (m+1)√ó(m+1)   -dimensional Euclidean space into itself, given by the   I   I   I   - matrices     E=\begin{pmatrix}     0&1&0&\cdots&0\\ 0&0&1&\ddots&\vdots\\ \vdots&\ddots&\ddots&\ddots&0\\ 0&\cdots&0&0&1\\ 0&\cdots&0&0&0 \end{pmatrix}, \qquad \Delta=\begin{pmatrix} -1&1&0&\cdots&0\\ 0&-1&1&\ddots&\vdots\\ \vdots&\ddots&\ddots&\ddots&0\\ 0&\cdots&0&-1&1\\ 0&\cdots&0&0&-1 \end{pmatrix},    and let    (   m  +  1   )      m  1    (m+1)   denote the    (   m  +  1   )      m  1    (m+1)   -dimensional identity matrix . Then () and () hold for every vector  ( c 0 , c 1 , ..., c m ) T }} in   T   T   T   -dimensional Euclidean space, where the exponent   c   c   c   in the definition of   E   E   E   denotes the transpose .      Equations () and () hold for an arbitrary linear operator   Œî   normal-Œî   Œî   as long as   E   E   E   is the difference of   I   I   I   and the identity operator    N  =  n      N  n    {N=n}   .  The probabilistic versions (), () and () can be generalized to every finite measure space .   For textbook presentations of the probabilistic Schuette‚ÄìNesbitt formula () and their applications to actuarial science, cf. . Chapter 8, or , Chapter 18 and the Appendix, pp.¬†577‚Äì578.  History  For independent events, the formula () appeared in a discussion of Robert P. White and T.N.E. Greville's paper by Donald R. Schuette and Cecil J. Nesbitt , see . In the two-page note , Hans U. Gerber, called it Schuette‚ÄìNesbitt formula and generalized it to arbitrary events. Christian Buchta, see , noticed the combinatorial nature of the formula and published the elementary combinatorial proof of¬†().  Cecil J. Nesbitt, PhD , F.S.A. , M.A.A.A., received his mathematical education at the University of Toronto and the Institute for Advanced Study in Princeton . He taught actuarial mathematics at the University of Michigan from 1938 to 1980. He served the Society of Actuaries from 1985 to 1987 as Vice-President for Research and Studies. Professor Nesbitt died in 2001. (Short CV taken from , page¬†xv.)  Donald Richard Schuette was a PhD student of C.¬†Nesbitt, he later became professor at the University of Wisconsin‚ÄìMadison .  The probabilistic version of the Schuette‚ÄìNesbitt formula () generalizes much older formulae of Waring , which express the probability of the events    N  ‚â•  n      N  normal-‚â•  n    {N‚â•n}   and    (      k      n      )     binomial  k  n    \textstyle{\left({{k}\atop{n}}\right)}   in terms of , , ..., . More precisely, with       Œî  k   =    (   E  -  I   )   k   =    ‚àë   j  =  0   k     (     k      j     )     (   -  1   )    k  -  j     E  j      ,   k  ‚àà   ‚Ñï  0     .     formulae-sequence       superscript  normal-Œî  k    superscript    E  I   k          superscript   subscript     j  0    k      binomial  k  j    superscript    1     k  j     superscript  E  j         k   subscript  ‚Ñï  0      \Delta^{k}=(E-I)^{k}=\sum_{j=0}^{k}{\left({{k}\atop{j}}\right)}(-1)^{k-j}E^{j}%
 ,\qquad k\in\mathbb{N}_{0}.   denoting the binomial coefficient ,  and  see , Sections IV.3 and IV.5, respectively.  To see that these formulae are special cases of the probabilistic version of the Schuette‚ÄìNesbitt formula, note that by the binomial theorem      c  =   (  0  ,  ‚Ä¶  ,  0  ,  1  ,  0  ,  0  ,  ‚Ä¶  )       c   0  normal-‚Ä¶  0  1  0  0  normal-‚Ä¶     c=(0,...,0,1,0,0,...)     Applying this operator identity to the sequence   n   n   n   with    j  =  n      j  n    j=n   leading zeros and noting that 1}} if    N  =  n      N  n    {N=n}   and 0}} otherwise, the formula () for    c  =   (  0  ,  ‚Ä¶  ,  0  ,  1  ,  1  ,  1  ,  ‚Ä¶  )       c   0  normal-‚Ä¶  0  1  1  1  normal-‚Ä¶     c=(0,...,0,1,1,1,...)   follows from ().  Applying the identity to   n   n   n   with    j  ‚â•  n      j  normal-‚â•  n    j‚â•n   leading zeros and noting that 1}} if    ‚Ñô   (  N  ‚â•  n  )   =   ‚àë   k  =  n   m    S  k    ‚àë   j  =  n   k    (     k      j     )     (  -  1  )    k  -  j    .     fragments  P   fragments  normal-(  N   n  normal-)     superscript   subscript     k  n    m    subscript  S  k    superscript   subscript     j  n    k    binomial  k  j    superscript   fragments  normal-(   1  normal-)     k  j    normal-.    \mathbb{P}(N\geq n)=\sum_{k=n}^{m}S_{k}\sum_{j=n}^{k}{\left({{k}\atop{j}}%
 \right)}(-1)^{k-j}.   and 0}} otherwise, equation () implies that         ‚àë   j  =  n   k     (     k      j     )     (   -  1   )    k  -  j      =   -    ‚àë   j  =  0    n  -  1      (     k      j     )     (   -  1   )    k  -  j       =     (   -  1   )    k  -  n     (      k  -  1        n  -  1      )     .          superscript   subscript     j  n    k      binomial  k  j    superscript    1     k  j          superscript   subscript     j  0      n  1       binomial  k  j    superscript    1     k  j               superscript    1     k  n     binomial    k  1     n  1        \sum_{j=n}^{k}{\left({{k}\atop{j}}\right)}(-1)^{k-j}=-\sum_{j=0}^{n-1}{\left({%
 {k}\atop{j}}\right)}(-1)^{k-j}=(-1)^{k-n}{\left({{k-1}\atop{n-1}}\right)}.     Expanding using the binomial theorem and using equation (11) of the formulas involving binomial coefficients , we obtain      N  ‚â•  n      N  normal-‚â•  n    {N‚â•n}     Hence, we have the formula () for   m   m   m   .  An application in actuarial science  Problem: Suppose there are   t   t   t   persons aged with remaining random (but independent) lifetimes . Suppose the group signs a life insurance contract which pays them after   n   n   n   years the amount if exactly   m   m   m   persons out of   t   t   t   are still alive after   t   t   t   years. How high is the expected payout of this insurance contract in   j   j   j   years?  Solution: Let denote the event that person   t   t   t   survives   œÉ   œÉ   œÉ   years, which means that }} . In actuarial notation the probability of this event is denoted by and can be taken from a life table . Use independence to calculate the probability of intersections. Calculate and use the probabilistic version of the Schuette‚ÄìNesbitt formula () to calculate the expected value of .  An application in probability theory  Let    1  ,  ‚Ä¶  ,  m     1  normal-‚Ä¶  m    {1,...,m}   be a random permutation of the set   j   j   j   and let denote the event that   œÉ   œÉ   œÉ   is a fixed point of   J   J   J   , meaning that  j }}}} . When the numbers in    1  ,  ‚Ä¶  ,  m     1  normal-‚Ä¶  m    {1,...,m}   , which is a subset of     (   m  ‚Äì   |  J  |    )   !        m  normal-‚Äì    J      (m‚Äì|J|)!   , are fixed points, then there are    m  ‚Äì   |  J  |       m  normal-‚Äì    J     m‚Äì|J|   ways to permute the remaining      ‚Ñô   (    ‚ãÇ   j  ‚àà  J     A  j    )    =     (   m  -   |  J  |    )   !    m  !     .        ‚Ñô    subscript     j  J     subscript  A  j           m    J       m      \mathbb{P}\biggl(\bigcap_{j\in J}A_{j}\biggr)=\frac{(m-|J|)!}{m!}.   numbers, hence      (      m      k      )     binomial  m  k    \textstyle{\left({{m}\atop{k}}\right)}     By the combinatorical interpretation of the binomial coefficient , there are   J   J   J   different choices of a subset    1  ,  ‚Ä¶  ,  m     1  normal-‚Ä¶  m    {1,...,m}   of   k   k   k   with      S  k   =    (     m      k     )      (   m  -  k   )   !    m  !     =   1   k  !     .         subscript  S  k      binomial  m  k         m  k      m            1    k       S_{k}={\left({{m}\atop{k}}\right)}\frac{(m-k)!}{m!}=\frac{1}{k!}.   elements, hence () simplifies to     N   N   N     Therefore, using (), the probability-generating function of the number       ùîº   [   x  N   ]    =    ‚àë   k  =  0   m      (   x  -  1   )   k    k  !      ,   x  ‚àà  ‚Ñù    .     formulae-sequence      ùîº   delimited-[]   superscript  x  N       superscript   subscript     k  0    m      superscript    x  1   k     k        x  ‚Ñù     \mathbb{E}[x^{N}]=\sum_{k=0}^{m}\frac{(x-1)^{k}}{k!},\qquad x\in\mathbb{R}.   of fixed points is given by      x  ‚Äì  1      x  normal-‚Äì  1    x‚Äì1     This is the partial sum of the infinite series giving the exponential function at   1   1   1   , which in turn is the probability-generating function of the Poisson distribution with parameter   m   m   m   . Therefore, as   N   N   N   tends to infinity , the distribution of   1   1   1    converges to the Poisson distribution with parameter $1$ .  See also   Rencontres numbers   References          External links      "  Category:Enumerative combinatorics  Category:Probability theory  Category:Probability theorems  Category:Statistical theorems  Category:Articles containing proofs   
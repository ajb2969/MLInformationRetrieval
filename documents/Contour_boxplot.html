<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="413">Contour boxplot</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Contour boxplot</h1>
<hr/>

<p>In <a href="statistical_graphics" title="wikilink">statistical graphics</a> and <a href="scientific_visualization" title="wikilink">scientific visualization</a>, the <strong>contour boxplot</strong><a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a> is an exploratory tool that has been proposed for visualizing ensembles of feature-sets determined by a threshold on some scalar function (e.g. level-sets, isocontours). Analogous to the classical boxplot and considered an expansion of the concepts defining <a href="functional_boxplot" title="wikilink">functional boxplot</a>,<a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a><a class="footnoteRef" href="#fn3" id="fnref3"><sup>3</sup></a> the <a href="descriptive_statistics" title="wikilink">descriptive statistics</a> of a contour boxplot are: the envelope of the 50% central region, the median curve and the maximum non-outlying envelope.</p>

<p>To construct a contour boxplot, data ordering is the first step. In <a href="functional_data_analysis" title="wikilink">functional data analysis</a>, each observation is a real function, therefore data ordering is different from the classical boxplot where scalar data are simply ordered from the smallest sample value to the largest. More generally, data depth, gives a center-outward ordering of data points, and thereby provides a mechanism for constructing rank statistics of various kinds of multidimensional data. For instance, functional data examples can be ordered using the method of band depth or a modified band depth. In contour data analysis, each observation is a feature-set (a subset of the domain), and therefore not a function. Thus, the notion of band depth and modified band depth is further extended to accommodate features that can be expressed as sets but not necessarily as functions. Contour band depth allows for ordering feature-set data from the center outwards and, thus, introduces a measure to define functional quantiles and the centrality or outlyingness of an observation. Having the ranks of feature-set data, the contour boxplot is a natural extension of the classical boxplot which in special cases reduces back to the traditional functional boxplot.</p>
<h2 id="setcontour-band-depth">Set/contour band depth</h2>

<p>Set band depth (introduced in <a class="footnoteRef" href="#fn4" id="fnref4"><sup>4</sup></a>), denoted as sBD, is a method for establishing a center-outward ordering of a collection of sets. As with other band depth, data ordering methods, set band depth, computes the probability of whether a sample lies in the band formed by <em>j</em> other samples from the distribution. We say that a set <em>S</em> ∈ <em>E</em> is an element of the band of a collection of <em>j</em> other sets <em>S</em><sub>1</sub>, ..., <em>S</em><sub><em>j</em></sub> ∈ <em>E</em> if it is bounded by their union and intersection. That is:</p>

<p>

<math display="block" id="Contour_boxplot:0">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>S</mi>
     <mo>∈</mo>
     <mrow>
      <mi>s</mi>
      <mi>B</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <msub>
        <mi>S</mi>
        <mn>1</mn>
       </msub>
       <mo>,</mo>
       <mi mathvariant="normal">…</mi>
       <mo>,</mo>
       <msub>
        <mi>S</mi>
        <mi>j</mi>
       </msub>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mrow>
    <mo>⟺</mo>
    <mrow>
     <mrow>
      <munderover>
       <mo largeop="true" mathsize="160%" movablelimits="false" stretchy="false" symmetric="true">⋂</mo>
       <mrow>
        <mi>k</mi>
        <mo>=</mo>
        <mn>1</mn>
       </mrow>
       <mi>j</mi>
      </munderover>
      <msub>
       <mi>S</mi>
       <mi>k</mi>
      </msub>
     </mrow>
     <mo>⊂</mo>
     <mi>S</mi>
     <mo>⊂</mo>
     <mrow>
      <munderover>
       <mo largeop="true" mathsize="160%" movablelimits="false" stretchy="false" symmetric="true">⋃</mo>
       <mrow>
        <mi>k</mi>
        <mo>=</mo>
        <mn>1</mn>
       </mrow>
       <mi>j</mi>
      </munderover>
      <msub>
       <mi>S</mi>
       <mi>k</mi>
      </msub>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-⟺</ci>
    <apply>
     <in></in>
     <ci>S</ci>
     <apply>
      <times></times>
      <ci>s</ci>
      <ci>B</ci>
      <vector>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>S</ci>
        <cn type="integer">1</cn>
       </apply>
       <ci>normal-…</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>S</ci>
        <ci>j</ci>
       </apply>
      </vector>
     </apply>
    </apply>
    <apply>
     <and></and>
     <apply>
      <subset></subset>
      <apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <intersect></intersect>
         <apply>
          <eq></eq>
          <ci>k</ci>
          <cn type="integer">1</cn>
         </apply>
        </apply>
        <ci>j</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>S</ci>
        <ci>k</ci>
       </apply>
      </apply>
      <ci>S</ci>
     </apply>
     <apply>
      <subset></subset>
      <share href="#.cmml">
      </share>
      <apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <union></union>
         <apply>
          <eq></eq>
          <ci>k</ci>
          <cn type="integer">1</cn>
         </apply>
        </apply>
        <ci>j</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>S</ci>
        <ci>k</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   S\in sB(S_{1},\ldots,S_{j})\Longleftrightarrow\bigcap_{k=1}^{j}S_{k}\subset S%
\subset\bigcup_{k=1}^{j}S_{k}.\,
  </annotation>
 </semantics>
</math>

</p>

<p>The set band depth is the sum of probabilities of lying in bands formed by different numbers of samples (2, ..., <em>J</em>).</p>

<p>

<math display="block" id="Contour_boxplot:1">
 <semantics>
  <mrow>
   <mi>s</mi>
   <mi>B</mi>
   <msub>
    <mi>D</mi>
    <mi>J</mi>
   </msub>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>S</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>=</mo>
   <munderover>
    <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
    <mrow>
     <mi>j</mi>
     <mo>=</mo>
     <mn>2</mn>
    </mrow>
    <mi>J</mi>
   </munderover>
   <mi>P</mi>
   <mrow>
    <mo>[</mo>
    <mi>S</mi>
    <mo>∈</mo>
    <mi>s</mi>
    <mi>B</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <msub>
      <mi>S</mi>
      <mn>1</mn>
     </msub>
     <mo>,</mo>
     <mi mathvariant="normal">…</mi>
     <mo>,</mo>
     <msub>
      <mi>S</mi>
      <mi>j</mi>
     </msub>
     <mo>]</mo>
    </mrow>
    <mo>.</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">s</csymbol>
    <csymbol cd="unknown">B</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>D</ci>
     <ci>J</ci>
    </apply>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">S</csymbol>
     <ci>normal-)</ci>
    </cerror>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <sum></sum>
      <apply>
       <eq></eq>
       <ci>j</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
     <ci>J</ci>
    </apply>
    <csymbol cd="unknown">P</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-[</ci>
     <csymbol cd="unknown">S</csymbol>
     <in></in>
     <csymbol cd="unknown">s</csymbol>
     <csymbol cd="unknown">B</csymbol>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <ci>normal-(</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>S</ci>
       <cn type="integer">1</cn>
      </apply>
      <ci>normal-,</ci>
      <ci>normal-…</ci>
      <ci>normal-,</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>S</ci>
       <ci>j</ci>
      </apply>
      <ci>normal-]</ci>
     </cerror>
     <ci>normal-.</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   sBD_{J}(S)=\sum_{j=2}^{J}P\left[S\in sB(S_{1},\ldots,S_{j}\right].
  </annotation>
 </semantics>
</math>

</p>

<p>Set band depth is shown to be a generalization of function band depth. Set band depth has a modified form that is derived from a relaxed form of subset, which requires only a percentage of a set to be included in another.</p>

<p>Contour band depth (cBD) is a direct application of sBD, where the sets are derived from thresholded input functions, <em>F</em>(<em>x</em>) &gt; <em>q</em>. In this way, an ensemble of scalar input functions and a threshold value, gives rise to a collection of contours, and sorting cBD gives a data-depth ordering (highest-to-lowest probability gives greatest-to-smallest depth) of those contours. By relying on the set formulation, contour boxplots avoid any explicit correspondence of points on different contours.</p>
<h2 id="contour-boxplot-construction">Contour boxplot construction</h2>

<p>In the classical boxplot, the box itself represents the middle 50% of the data. Since the data ordering in the contour boxplot is from the center outwards, the 50% central region is defined by the band delimited by the 50% of deepest, or the most central observations. The border of the 50% central region is defined as the envelope representing the box in a classical boxplot. Thus, this 50% central region is the analog to the <a href="interquartile_range" title="wikilink">interquartile range</a> (IQR) and gives a useful indication of the spread of the central 50% of the curves. This is a robust range for interpretation because the 50% central region is not affected by outliers or extreme values, and gives a less biased visualization of the curves' spread. The observation in the box indicates the <a class="uri" href="median" title="wikilink">median</a>, or the most central observation which is also a robust statistic to measure centrality.</p>

<p>The "whiskers" of the boxplot are the vertical lines of the plot extending from the box and indicating the maximum envelope of the dataset except the outliers. In contour boxplots, this is formed by considering the difference of the union and intersection formed by all non-outlying samples. Outliers are determined as having a cBD value that is less than some multiplier (less than one) times the cBD of the 50% ranked samples.</p>
<h2 id="examples">Examples</h2>

<p>The following example is an ensemble of data from 2D incompressible Navier–Stokes simulation consisting of 40 members, where each ensemble member is a simulation with Reynolds number and inlet velocity chosen randomly. The inlet velocity values are randomly drawn from a normal distribution with mean value of 1 and standard deviation of ±0.01 (in non-dimensionalized units); likewise, Reynolds numbers are generated from a normal distribution with mean value of 130 and standard deviation of ±3. </p>

<p>The example below is from an ensemble of publicly available data from the <a href="National_Oceanic_and_Atmospheric_Administration" title="wikilink">National Oceanic and Atmospheric Administration</a> (NOAA) [1]. The ensemble data are formed through different runs of a simulation model with different perturbations of the initial conditions to account for the errors in the initial conditions and/or model parameterizations. The ensemble consists of isocontours of the temperature field (isovalue −15C) at 500mb in altitude. </p>
<h2 id="see-also">See also</h2>
<ul>
<li><a class="uri" href="Boxplot" title="wikilink">Boxplot</a></li>
<li><a href="Functional_boxplot" title="wikilink">Functional boxplot</a></li>
</ul>
<h2 id="references">References</h2>

<p>"</p>

<p><a class="uri" href="Category:Statistics" title="wikilink">Category:Statistics</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1"><a href="#fnref1">↩</a></li>
<li id="fn2"><a href="#fnref2">↩</a></li>
<li id="fn3"><a href="#fnref3">↩</a></li>
<li id="fn4"></li>
</ol>
</section>
</body>
</html>

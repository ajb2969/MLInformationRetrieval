   Negative multinomial distribution      Negative multinomial distribution   {\Gamma(k_0)} \prod_{i=1}^m{\frac{p_i^{k_i}}{k_i!}}, where Γ( x ) is the Gamma function .  | cdf        =  | mean       =        k  0    p  0     p         subscript  k  0    subscript  p  0    p    \tfrac{k_{0}}{p_{0}}\,p     | variance   =         k  0    p  0  2     p   p  ′    +      k  0    p  0      diag   (  p  )              subscript  k  0    superscript   subscript  p  0   2    p   superscript  p  normal-′         subscript  k  0    subscript  p  0     diag  p      \tfrac{k_{0}}{p_{0}^{2}}\,pp^{\prime}+\tfrac{k_{0}}{p_{0}}\,\operatorname{diag%
 }(p)     | mode       =  | entropy    =  | mgf        =  | cf         =      (    p  0    1  -    p  ′    e   i  t       )     k   0      superscript     subscript  p  0     1     superscript  p  normal-′    superscript  e    i  t        subscript  k  0     \bigg(\frac{p_{0}}{1-p^{\prime}e^{it}}\bigg)^{\!k_{0}}     }}  In probability theory and statistics , the negative multinomial distribution is a generalization of the negative binomial distribution (NB( r , p )) to more than two outcomes. 1  Suppose we have an experiment that generates m +1≥2 possible outcomes, { X 0 ,…, X m }, each occurring with non-negative probabilities { p 0 ,…, p m } respectively. If sampling proceeded until n observations were made, then { X 0 ,…, X m } would have been multinomially distributed . However, if the experiment is stopped once X 0 reaches the predetermined value k 0 , then the distribution of the m -tuple { X 1 ,…, X m } is negative multinomial . These variables are not multinomially distributed because their sum X 1 +…+ X m is not fixed, being a draw from a negative binomial distribution .  Negative multinomial distribution example  The table below shows the an example of 400 Melanoma (skin cancer) Patients where the Type and Site of the cancer are recorded for each subject.       Type   Site   Totals     Head and Neck   Trunk   Extremities     Hutchinson's melanomic freckle   22   2     Superficial   16   54     Nodular   19   33     Indeterminant   11   17     Column Totals   68   106      The sites (locations) of the cancer may be independent, but there may be positive dependencies of the type of cancer for a given location (site). For example, localized exposure to radiation implies that elevated level of one type of cancer (at a given location) may indicate higher level of another cancer type at the same location. The Negative Multinomial distribution may be used to model the sites cancer rates and help measure some of the cancer type dependencies within each location.  If    x   i  ,  j      subscript  x   i  j     x_{i,j}   denote the cancer rates for each site (    0  ≤  i  ≤  2        0  i       2     0\leq i\leq 2   ) and each type of cancer (    0  ≤  j  ≤  3        0  j       3     0\leq j\leq 3   ), for a fixed site (    i  0     subscript  i  0    i_{0}   ) the cancer rates are independent Negative Multinomial distributed random variables. That is, for each column index (site) the column-vector X has the following distribution:      X  =   {   X  1   ,   X  2   ,   X  3   }   ∼   N  M   (   k  0   ,   {   p  1   ,   p  2   ,   p  3   }   )          X    subscript  X  1    subscript  X  2    subscript  X  3      similar-to      N  M    subscript  k  0     subscript  p  1    subscript  p  2    subscript  p  3         X=\{X_{1},X_{2},X_{3}\}\sim NM(k_{0},\{p_{1},p_{2},p_{3}\})   . Different columns in the table (sites) are considered to be different instances of the random multinomially distributed vector, X. Then we have the following estimates of expected counts (frequencies of cancer):        μ  ^    i  ,  j    =     x   i  ,  .    ×   x   .  ,  j      x   .  ,  .          subscript   normal-^  μ    i  j         subscript  x   fragments  i  normal-,  normal-.     subscript  x   fragments  normal-.  normal-,  j      subscript  x   fragments  normal-.  normal-,  normal-.       \hat{\mu}_{i,j}=\frac{x_{i,.}\times x_{.,j}}{x_{.,.}}          x   i  ,  .    =    ∑   j  =  0   3    x   i  ,  j          subscript  x   fragments  i  normal-,  normal-.      superscript   subscript     j  0    3    subscript  x   i  j       x_{i,.}=\sum_{j=0}^{3}{x_{i,j}}          x   .  ,  j    =    ∑   i  =  0   2    x   i  ,  j          subscript  x   fragments  normal-.  normal-,  j      superscript   subscript     i  0    2    subscript  x   i  j       x_{.,j}=\sum_{i=0}^{2}{x_{i,j}}          x   .  ,  .    =    ∑   i  =  0   2     ∑   j  =  0   3    x   i  ,  j           subscript  x   fragments  normal-.  normal-,  normal-.      superscript   subscript     i  0    2     superscript   subscript     j  0    3    subscript  x   i  j        x_{.,.}=\sum_{i=0}^{2}\sum_{j=0}^{3}{{x_{i,j}}}      Example      μ  ^    1  ,  1    =     x   1  ,  .    ×   x   .  ,  1      x   .  ,  .     =    34  ×  68   400   =  5.78         subscript   normal-^  μ    1  1         subscript  x   fragments  1  normal-,  normal-.     subscript  x   fragments  normal-.  normal-,  1      subscript  x   fragments  normal-.  normal-,  normal-.              34  68   400        5.78     \hat{\mu}_{1,1}=\frac{x_{1,.}\times x_{.,1}}{x_{.,.}}=\frac{34\times 68}{400}=%
 5.78      For the first site (Head and Neck, j=0), suppose that    X  =   {   X  1   =  5  ,   X  2   =  1  ,   X  3   =  5  }      fragments  X    fragments  normal-{   subscript  X  1    5  normal-,   subscript  X  2    1  normal-,   subscript  X  3    5  normal-}     X=\left\{X_{1}=5,X_{2}=1,X_{3}=5\right\}   and    X  ∼  N  M   (   k  0   =  10  ,   {   p  1   =  0.2  ,   p  2   =  0.1  ,   p  3   =  0.2  }   )      fragments  X  similar-to  N  M   fragments  normal-(   subscript  k  0    10  normal-,   fragments  normal-{   subscript  p  1    0.2  normal-,   subscript  p  2    0.1  normal-,   subscript  p  3    0.2  normal-}   normal-)     X\sim NM(k_{0}=10,\{p_{1}=0.2,p_{2}=0.1,p_{3}=0.2\})   . Then:       p  0   =   1  -    ∑   i  =  1   3    p  i     =  0.5         subscript  p  0     1    superscript   subscript     i  1    3    subscript  p  i          0.5     p_{0}=1-\sum_{i=1}^{3}{p_{i}}=0.5         N  M   (  X  |   k  0   ,   {   p  1   ,   p  2   ,   p  3   }   )   =  0.00465585119998784     fragments  N  M   fragments  normal-(  X  normal-|   subscript  k  0   normal-,   fragments  normal-{   subscript  p  1   normal-,   subscript  p  2   normal-,   subscript  p  3   normal-}   normal-)    0.00465585119998784    NM(X|k_{0},\{p_{1},p_{2},p_{3}\})=0.00465585119998784          c  o  v   [   X  1   ,   X  3   ]    =    10  ×  0.2  ×  0.2    0.5  2    =  1.6          c  o  v    subscript  X  1    subscript  X  3         10  0.2  0.2    superscript  0.5  2         1.6     cov[X_{1},X_{3}]=\frac{10\times 0.2\times 0.2}{0.5^{2}}=1.6          μ  2   =     k  0    p  2     p  0    =    10  ×  0.1   0.5   =  2.0         subscript  μ  2        subscript  k  0    subscript  p  2     subscript  p  0             10  0.1   0.5        2.0     \mu_{2}=\frac{k_{0}p_{2}}{p_{0}}=\frac{10\times 0.1}{0.5}=2.0          μ  3   =     k  0    p  3     p  0    =    10  ×  0.2   0.5   =  4.0         subscript  μ  3        subscript  k  0    subscript  p  3     subscript  p  0             10  0.2   0.5        4.0     \mu_{3}=\frac{k_{0}p_{3}}{p_{0}}=\frac{10\times 0.2}{0.5}=4.0          c  o  r  r   [   X  2   ,   X  3   ]    =    (     μ  2   ×   μ  3      (    k  0   +   μ  2    )    (    k  0   +   μ  3    )     )    1  2          c  o  r  r    subscript  X  2    subscript  X  3      superscript       subscript  μ  2    subscript  μ  3         subscript  k  0    subscript  μ  2       subscript  k  0    subscript  μ  3        1  2      corr[X_{2},X_{3}]=\left(\frac{\mu_{2}\times\mu_{3}}{(k_{0}+\mu_{2})(k_{0}+\mu_%
 {3})}\right)^{\frac{1}{2}}   and therefore,     c  o  r  r   [   X  2   ,   X  3   ]    =    (    2  ×  4     (   10  +  2   )    (   10  +  4   )     )    1  2    =  0.21821789023599242.          c  o  r  r    subscript  X  2    subscript  X  3      superscript      2  4       10  2     10  4       1  2         0.21821789023599242.     corr[X_{2},X_{3}]=\left(\frac{2\times 4}{(10+2)(10+4)}\right)^{\frac{1}{2}}=0.%
 21821789023599242.     Notice that the pair-wise NM correlations are always positive, whereas the correlations between multinomial counts are always negative. As the parameter    k  0     subscript  k  0    k_{0}   increases, the paired correlations tend to zero! Thus, for large    k  0     subscript  k  0    k_{0}   , the Negative Multinomial counts    X  i     subscript  X  i    X_{i}   behave as independent  Poisson random variables with respect to their means    (    μ  i   =    k  0     p  i    p  0      )       subscript  μ  i      subscript  k  0      subscript  p  i    subscript  p  0       \left(\mu_{i}=k_{0}\frac{p_{i}}{p_{0}}\right)   .  The marginal distribution of each of the    X  i     subscript  X  i    X_{i}   variables is negative binomial , as the    X  i     subscript  X  i    X_{i}   count (considered as success) is measured against all the other outcomes (failure). But jointly, the distribution of    X  =   {   X  1   ,  ⋯  ,   X  m   }       X    subscript  X  1   normal-⋯   subscript  X  m      X=\{X_{1},\cdots,X_{m}\}   is negative multinomial, i.e.,    X  ∼   N  M   (   k  0   ,   {   p  1   ,  ⋯  ,   p  m   }   )       similar-to  X    N  M    subscript  k  0     subscript  p  1   normal-⋯   subscript  p  m        X\sim NM(k_{0},\{p_{1},\cdots,p_{m}\})   .  Parameter estimation   Estimation of the mean (expected) frequency counts (    μ  j     subscript  μ  j    \mu_{j}   ) of each outcome (    X  j     subscript  X  j    X_{j}   ) using maximum likelihood is possible. If we have a single observation vector    {   x  1   ,  ⋯  ,   x  m   }      subscript  x  1   normal-⋯   subscript  x  m     \{x_{1},\cdots,x_{m}\}   , then       μ  ^   i   =   x  i    .       subscript   normal-^  μ   i    subscript  x  i     \hat{\mu}_{i}=x_{i}.   If we have several observation vectors, like in this case we have the cancer type frequencies for 3 different sites, then the MLE estimates of the mean counts are      μ  ^   j   =    x   j  ,  .    I        subscript   normal-^  μ   j      subscript  x   fragments  j  normal-,  normal-.    I     \hat{\mu}_{j}=\frac{x_{j,.}}{I}   , where    0  ≤  j  ≤  J        0  j       J     0\leq j\leq J   is the cancer-type index and the summation is over the number of observed (sampled) vectors (I). For the cancer data above, we have the following MLE estimates for the expectations for the frequency counts:     Hutchinson's melanomic freckle type of cancer (    X  0     subscript  X  0    X_{0}   ) is      μ  ^   0   =   34  /  3   =  11.33         subscript   normal-^  μ   0     34  3        11.33     \hat{\mu}_{0}=34/3=11.33   .  Superficial type of cancer (    X  1     subscript  X  1    X_{1}   ) is      μ  ^   1   =   185  /  3   =  61.67         subscript   normal-^  μ   1     185  3        61.67     \hat{\mu}_{1}=185/3=61.67   .  Nodular type of cancer (    X  2     subscript  X  2    X_{2}   ) is      μ  ^   2   =   125  /  3   =  41.67         subscript   normal-^  μ   2     125  3        41.67     \hat{\mu}_{2}=125/3=41.67   .  Indeterminant type of cancer (    X  3     subscript  X  3    X_{3}   ) is      μ  ^   3   =   56  /  3   =  18.67         subscript   normal-^  μ   3     56  3        18.67     \hat{\mu}_{3}=56/3=18.67   .      There is no MLE estimate for the NM    k  0     subscript  k  0    k_{0}   parameter. 2 3 However, there are approximate protocols for estimating the    k  0     subscript  k  0    k_{0}   parameter using the chi-squared goodness of fit statistic . In the usual chi-squared statistic:         \Chi   2   =    ∑  i      (    x  i   -   μ  i    )   2    μ  i          superscript  \Chi  2     subscript   i      superscript     subscript  x  i    subscript  μ  i    2    subscript  μ  i       \Chi^{2}=\sum_{i}{\frac{(x_{i}-\mu_{i})^{2}}{\mu_{i}}}   , we can replace the expected-means (    μ  i     subscript  μ  i    \mu_{i}   ) by their estimates,     μ  i   ^     normal-^   subscript  μ  i     \hat{\mu_{i}}   , and replace denominators by the corresponding negative multinomial variances. Then we get the following test statistic for negative multinomial distributed data:         \Chi   2    (   k  0   )    =    ∑  i      (    x  i   -    μ  i   ^    )   2      μ  i   ^    (   1  +     μ  i   ^    k  0     )             superscript  \Chi  2    subscript  k  0      subscript   i      superscript     subscript  x  i    normal-^   subscript  μ  i     2      normal-^   subscript  μ  i      1     normal-^   subscript  μ  i     subscript  k  0          \Chi^{2}(k_{0})=\sum_{i}{\frac{(x_{i}-\hat{\mu_{i}})^{2}}{\hat{\mu_{i}}\left(1%
 +\frac{\hat{\mu_{i}}}{k_{0}}\right)}}   .   Next, we can estimate the    k  0     subscript  k  0    k_{0}   parameter by varying the values of    k  0     subscript  k  0    k_{0}   in the expression      \Chi   2    (   k  0   )        superscript  \Chi  2    subscript  k  0     \Chi^{2}(k_{0})   and matching the values of this statistic with the corresponding asymptotic chi-squared distribution. The following protocol summarizes these steps using the cancer data above.  DF : The degree of freedom for the Chi-squared distribution in this case is:  df = (# rows – 1)(# columns – 1) = (3-1)*(4-1) = 6         Median : The median of a chi-squared random variable with 6 df is 5.261948.       Mean Counts Estimates : The mean counts estimates (    μ  j     subscript  μ  j    \mu_{j}   ) for the 4 different cancer types are:       μ  ^   1   =   185  /  3   =  61.67         subscript   normal-^  μ   1     185  3        61.67     \hat{\mu}_{1}=185/3=61.67   ;      μ  ^   2   =   125  /  3   =  41.67         subscript   normal-^  μ   2     125  3        41.67     \hat{\mu}_{2}=125/3=41.67   ; and      μ  ^   3   =   56  /  3   =  18.67         subscript   normal-^  μ   3     56  3        18.67     \hat{\mu}_{3}=56/3=18.67   .       Thus, we can solve the equation above       \Chi   2    (   k  0   )    =  5.261948         superscript  \Chi  2    subscript  k  0    5.261948    \Chi^{2}(k_{0})=5.261948   for the single variable of interest -- the unknown parameter    k  0     subscript  k  0    k_{0}   . In the cancer example, suppose    x  =   {   x  1   =  5  ,   x  2   =  1  ,   x  3   =  5  }      fragments  x    fragments  normal-{   subscript  x  1    5  normal-,   subscript  x  2    1  normal-,   subscript  x  3    5  normal-}     x=\{x_{1}=5,x_{2}=1,x_{3}=5\}   . Then, the solution is an asymptotic chi-squared distribution driven estimate of the parameter    k  0     subscript  k  0    k_{0}   .         \Chi   2    (   k  0   )    =    ∑   i  =  1   3      (    x  i   -    μ  i   ^    )   2      μ  i   ^    (   1  +     μ  i   ^    k  0     )             superscript  \Chi  2    subscript  k  0      superscript   subscript     i  1    3      superscript     subscript  x  i    normal-^   subscript  μ  i     2      normal-^   subscript  μ  i      1     normal-^   subscript  μ  i     subscript  k  0          \Chi^{2}(k_{0})=\sum_{i=1}^{3}{\frac{(x_{i}-\hat{\mu_{i}})^{2}}{\hat{\mu_{i}}%
 \left(1+\frac{\hat{\mu_{i}}}{k_{0}}\right)}}   .         \Chi   2    (   k  0   )    =      (   5  -  61.67   )   2    61.67   (   1  +   61.67  /   k  0     )     +     (   1  -  41.67   )   2    41.67   (   1  +   41.67  /   k  0     )     +     (   5  -  18.67   )   2    18.67   (   1  +   18.67  /   k  0     )      =  5.261948.           superscript  \Chi  2    subscript  k  0         superscript    5  61.67   2     61.67    1    61.67   subscript  k  0          superscript    1  41.67   2     41.67    1    41.67   subscript  k  0          superscript    5  18.67   2     18.67    1    18.67   subscript  k  0             5.261948.     \Chi^{2}(k_{0})=\frac{(5-61.67)^{2}}{61.67(1+61.67/k_{0})}+\frac{(1-41.67)^{2}%
 }{41.67(1+41.67/k_{0})}+\frac{(5-18.67)^{2}}{18.67(1+18.67/k_{0})}=5.261948.   Solving this equation for    k  0     subscript  k  0    k_{0}   provides the desired estimate for the last parameter.  Mathematica provides 3 distinct (    k  0     subscript  k  0    k_{0}   ) solutions to this equation: { 50.5466 , -21.5204, 2.40461 }. Since     k  0   >  0       subscript  k  0   0    k_{0}>0   there are 2 candidate solutions.      Estimates of probabilities: Assume     k  0   =  2       subscript  k  0   2    k_{0}=2   and       μ  i    k  0     p  0    =   p  i            subscript  μ  i    subscript  k  0     subscript  p  0     subscript  p  i     \frac{\mu_{i}}{k_{0}}p_{0}=p_{i}   , then:         61.67   k  0     p  0    =   31   p  0    =   p  1             61.67   subscript  k  0     subscript  p  0      31   subscript  p  0          subscript  p  1      \frac{61.67}{k_{0}}p_{0}=31p_{0}=p_{1}          20   p  0    =   p  2         20   subscript  p  0     subscript  p  2     20p_{0}=p_{2}          9   p  0    =   p  3         9   subscript  p  0     subscript  p  3     9p_{0}=p_{3}      Hence,     1  -   p  0    =    p  1   +   p  2   +   p  3    =   60   p  0            1   subscript  p  0       subscript  p  1    subscript  p  2    subscript  p  3           60   subscript  p  0       1-p_{0}=p_{1}+p_{2}+p_{3}=60p_{0}   , and     p  0   =   1  61        subscript  p  0     1  61     p_{0}=\frac{1}{61}   ,     p  1   =   31  61        subscript  p  1     31  61     p_{1}=\frac{31}{61}   ,     p  2   =   20  61        subscript  p  2     20  61     p_{2}=\frac{20}{61}   and     p  3   =   9  61        subscript  p  3     9  61     p_{3}=\frac{9}{61}   .  Therefore, the best model distribution for the observed sample    x  =   {   x  1   =  5  ,   x  2   =  1  ,   x  3   =  5  }      fragments  x    fragments  normal-{   subscript  x  1    5  normal-,   subscript  x  2    1  normal-,   subscript  x  3    5  normal-}     x=\{x_{1}=5,x_{2}=1,x_{3}=5\}   is     X  ∼   N  M   (  2  ,   {   31  61   ,   20  61   ,   9  61   }   )     .     similar-to  X    N  M   2     31  61     20  61     9  61        X\sim NM\left(2,\left\{\frac{31}{61},\frac{20}{61},\frac{9}{61}\right\}\right).      Related distributions   Negative binomial distribution  Multinomial distribution  Inverted Dirichlet distribution , a conjugate prior for the negative multinomial   References    Waller LA and Zelterman D. (1997). Log-linear modeling with the negative multi- nomial distribution. Biometrics 53: 971-82.  Further reading  "  Category:Factorial and binomial topics  Category:Multivariate discrete distributions  Category:Probability distributions     Le Gall, F. The modes of a negative multinomial distribution, Statistics & Probability Letters, Volume 76, Issue 6, 15 March 2006, Pages 619-624, ISSN 0167-7152, 10.1016/j.spl.2005.09.009 . ↩   ↩     
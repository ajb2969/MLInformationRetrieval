   Covariance      Covariance   In probability theory and statistics , covariance is a measure of how much two random variables change together. If the greater values of one variable mainly correspond with the greater values of the other variable, and the same holds for the smaller values, i.e., the variables tend to show similar behavior, the covariance is positive. 1 In the opposite case, when the greater values of one variable mainly correspond to the smaller values of the other, i.e., the variables tend to show opposite behavior, the covariance is negative. The sign of the covariance therefore shows the tendency in the linear relationship between the variables. The magnitude of the covariance is not easy to interpret. The normalized version of the covariance , the correlation coefficient , however, shows by its magnitude the strength of the linear relation.  A distinction must be made between (1) the covariance of two random variables, which is a population  parameter that can be seen as a property of the joint probability distribution , and (2) the sample covariance, which serves as an estimated value of the parameter.  Definition  The covariance between two jointly distributed  real -valued random variables  X and Y with finite second moments is defined as 2        σ   (  X  ,  Y  )    =   E   [    (   X  -   E   [  X  ]     )    (   Y  -   E   [  Y  ]     )    ]     ,        σ   X  Y     normal-E      X   normal-E  X      Y   normal-E  Y        \sigma(X,Y)=\operatorname{E}{\big[(X-\operatorname{E}[X])(Y-\operatorname{E}[Y%
 ])\big]},   where E[ X ] is the expected value of X , also known as the mean of X . By using the linearity property of expectations, this can be simplified to      σ   (  X  ,  Y  )       σ   X  Y     \displaystyle\sigma(X,Y)   However, when     E   [   X  Y   ]    ≈    E   [  X  ]     E   [  Y  ]          normal-E    X  Y       normal-E  X    normal-E  Y      \operatorname{E}[XY]\approx\operatorname{E}[X]\operatorname{E}[Y]   , this last equation is prone to catastrophic cancellation when computed with floating point arithmetic and thus should be avoided in computer programs when the data has not been centered before. 3  For random vectors     𝐗  ∈   ℝ  m       𝐗   superscript  ℝ  m     \mathbf{X}\in\mathbb{R}^{m}   and    𝐘  ∈   ℝ  n       𝐘   superscript  ℝ  n     \mathbf{Y}\in\mathbb{R}^{n}   , the m×n  cross covariance matrix (also known as dispersion matrix or variance–covariance matrix , 4 or simply called covariance matrix ) is equal to      σ   (  𝐗  ,  𝐘  )       σ   𝐗  𝐘     \displaystyle\sigma(\mathbf{X},\mathbf{Y})     where m T is the transpose of the vector (or matrix) m .  The ( i , j )-th element of this matrix is equal to the covariance Cov( X i , Y j ) between the i -th scalar component of X and the j -th scalar component of Y . In particular, Cov( Y , X ) is the transpose of Cov( X , Y ).  For a vector    𝐗  =    [      X  1      X  2     …     X  m      ]   T       𝐗   superscript     subscript  X  1    subscript  X  2   normal-…   subscript  X  m     normal-T     \mathbf{X}=\begin{bmatrix}X_{1}&X_{2}&\dots&X_{m}\end{bmatrix}^{\mathrm{T}}   of m jointly distributed random variables with finite second moments, its covariance matrix is defined as        Σ   (  𝐗  )    =   σ   (  𝐗  ,  𝐗  )     .        normal-Σ  𝐗     σ   𝐗  𝐗      \Sigma(\mathbf{X})=\sigma(\mathbf{X},\mathbf{X}).     Random variables whose covariance is zero are called uncorrelated .  The units of measurement of the covariance Cov( X , Y ) are those of X times those of Y . By contrast, correlation coefficients , which depend on the covariance, are a dimensionless measure of linear dependence. (In fact, correlation coefficients can simply be understood as a normalized version of covariance.)  The covariance of two discrete sets can be equivalently expressed, without directly referring to the mean 5        cov   (  X  ,  Y  )    =    1   n  2      ∑   i  =  1   n     ∑   j  =  1   n      1  2    (    x  i   -   x  j    )    ⋅    (    y  i   -   y  j    )   T       =    1   n  2      ∑  i     ∑   j  >  i      (    x  i   -   x  j    )   ⋅    (    y  i   -   y  j    )   T        .         cov  X  Y       1   superscript  n  2      superscript   subscript     i  1    n     superscript   subscript     j  1    n    normal-⋅      1  2      subscript  x  i    subscript  x  j      superscript     subscript  y  i    subscript  y  j    normal-T                1   superscript  n  2      subscript   i     subscript     j  i     normal-⋅     subscript  x  i    subscript  x  j     superscript     subscript  y  i    subscript  y  j    normal-T          \operatorname{cov}(X,Y)=\frac{1}{n^{2}}\sum_{i=1}^{n}\sum_{j=1}^{n}\frac{1}{2}%
 (x_{i}-x_{j})\cdot(y_{i}-y_{j})^{\mathrm{T}}=\frac{1}{n^{2}}\sum_{i}\sum_{j>i}%
 (x_{i}-x_{j})\cdot(y_{i}-y_{j})^{\mathrm{T}}.     Properties   Variance is a special case of the covariance when the two variables are identical:         σ   (  X  ,  X  )    =    σ  2    (  X  )     .        σ   X  X       superscript  σ  2   X     \sigma(X,X)=\sigma^{2}(X).      If X , Y , W , and V are real-valued random variables and a , b , c , d are constant ("constant" in this context means non-random), then the following facts are a consequence of the definition of covariance:       σ   (  X  ,  a  )       σ   X  a     \displaystyle\sigma(X,a)     For a sequence X 1 , ..., X n of random variables, and constants a 1 , ..., a n , we have      Σ   (  𝐗  )       normal-Σ  𝐗    \Sigma(\mathbf{X})   be a random vector with covariance matrix   A   A   A   , and let   𝐗   𝐗   \mathbf{X}   be a matrix that can act on    A  𝐗      A  𝐗    A\mathbf{X}   . The covariance matrix of the vector     Σ   (   A  𝐗   )    =    A   Σ   (  𝐗  )    A  T          normal-Σ    A  𝐗      A  normal-Σ  𝐗   superscript  A  normal-T      \Sigma(A\mathbf{X})=A\,\Sigma(\mathbf{X})\,A^{\mathrm{T}}   is:        E   [   X  Y   ]    =    E   [  X  ]    ⋅   E   [  Y  ]      .       normal-E    X  Y     normal-⋅   normal-E  X    normal-E  Y      \operatorname{E}\left[XY\right]=\operatorname{E}[X]\cdot\operatorname{E}[Y].   .  This is a direct result of the linearity of expectation and is useful when applying a linear transformation , such as a whitening transformation , to a vector.  Uncorrelatedness and independence  If X and Y are independent , then their covariance is zero. This follows because under independence,      σ   (  X  ,  Y  )       σ   X  Y     \displaystyle\sigma(X,Y)     The converse, however, is not generally true. For example, let X be uniformly distributed in [-1, 1] and let Y = X 2 . Clearly, X and Y are dependent, but       |   σ   (  X  ,  Y  )    |   ≤     σ  2    (  X  )    σ  2    (  Y  )             σ   X  Y          superscript  σ  2   X   superscript  σ  2   Y      |\sigma(X,Y)|\leq\sqrt{\sigma^{2}(X)\sigma^{2}(Y)}   In this case, the relationship between Y and X is non-linear, while correlation and covariance are measures of linear dependence between two variables. This example shows that if two variables are uncorrelated, that does not in general imply that they are independent. However, if two variables are jointly normally distributed (but not if they are merely individually normally distributed ), uncorrelatedness does imply independence.  Relationship to inner products  Many of the properties of covariance can be extracted elegantly by observing that it satisfies similar properties to those of an inner product :   bilinear : for constants a and b and random variables X , Y , Z , σ( aX + bY , Z ) = a σ( X , Z ) + b σ( Y , Z );  symmetric: σ( X , Y ) = σ( Y , X );  positive semi-definite : σ 2 ( X ) = σ( X , X ) ≥ 0 for all random variables X , and σ( X , X ) = 0 implies that X is a constant random variable ( K ).   In fact these properties imply that the covariance defines an inner product over the quotient vector space obtained by taking the subspace of random variables with finite second moment and identifying any two that differ by a constant. (This identification turns the positive semi-definiteness above into positive definiteness.) That quotient vector space is isomorphic to the subspace of random variables with finite second moment and mean zero; on that subspace, the covariance is exactly the L 2 inner product of real-valued functions on the sample space.  As a result for random variables with finite variance, the inequality       Z  =   X  -     σ   (  X  ,  Y  )      σ  2    (  Y  )     Y     .      Z    X        σ   X  Y       superscript  σ  2   Y    Y      Z=X-\frac{\sigma(X,Y)}{\sigma^{2}(Y)}Y.     holds via the Cauchy–Schwarz inequality .  Proof: If σ 2 ( Y ) = 0, then it holds trivially. Otherwise, let random variable      0  ≤    σ  2    (  Z  )        0     superscript  σ  2   Z     \displaystyle 0\leq\sigma^{2}(Z)     Then we have        q  ¯   ¯   =   [   [   q   j  k    ]   ]        normal-¯   normal-¯  q     delimited-[]   delimited-[]   subscript  q    j  k        \textstyle\overline{\overline{q}}=\left[[q_{jk}]\right]     Calculating the sample covariance  The sample covariance of N observations of K variables is the K -by- K  matrix      q   j  k    =    1   N  -  1      ∑   i  =  1   N     (    X   i  j    -    X  ¯   j    )    (    X   i  k    -    X  ¯   k    )           subscript  q    j  k        1    N  1      superscript   subscript     i  1    N        subscript  X    i  j     subscript   normal-¯  X   j       subscript  X    i  k     subscript   normal-¯  X   k         q_{jk}=\frac{1}{N-1}\sum_{i=1}^{N}\left(X_{ij}-\bar{X}_{j}\right)\left(X_{ik}-%
 \bar{X}_{k}\right)   with the entries     j   j   j   ,  which is an estimate of the covariance between variable   k   k   k   and variable   𝐗   𝐗   \textstyle\mathbf{X}   .  The sample mean and the sample covariance matrix are unbiased estimates of the mean and the covariance matrix of the random vector     N  -  1      N  1    \textstyle N-1   , a row vector whose j th element ( j = 1, ..., K ) is one of the random variables. The reason the sample covariance matrix has   N   N   \textstyle N   in the denominator rather than    E   (  X  )       E  X    E(X)   is essentially that the population mean    𝐗  ¯     normal-¯  𝐗    \mathbf{\bar{X}}   is not known and is replaced by the sample mean    E   (  X  )       E  X    E(X)   . If the population mean     q   j  k    =    1  N     ∑   i  =  1   N     (    X   i  j    -   E   (   X  j   )     )    (    X   i  k    -   E   (   X  k   )     )           subscript  q    j  k        1  N     superscript   subscript     i  1    N        subscript  X    i  j      E   subscript  X  j        subscript  X    i  k      E   subscript  X  k          q_{jk}=\frac{1}{N}\sum_{i=1}^{N}\left(X_{ij}-E(X_{j})\right)\left(X_{ik}-E(X_{%
 k})\right)   is known, the analogous unbiased estimate is given by  $$q_{jk}=\frac{1}{N}\sum_{i=1}^N \left(  X_{ij}-E(X_j)\right)  \left( X_{ik}-E(X_k)\right)$$  Comments  The covariance is sometimes called a measure of "linear dependence" between the two random variables. That does not mean the same thing as in the context of linear algebra (see linear dependence ). When the covariance is normalized, one obtains the correlation coefficient . From it, one can obtain the Pearson coefficient , which gives the goodness of the fit for the best possible linear function describing the relation between the variables. In this sense covariance is a linear gauge of dependence.  Applications  In genetics and molecular biology  Covariance is an important measure in biology. Certain sequences of DNA are conserved more than others among species, and thus to study secondary and tertiary structures of proteins, or of RNA structures, sequences are compared in closely related species. If sequence changes are found or no changes at all are found in noncoding RNA (such as microRNA), sequences are found to be necessary for common structural motifs, such as an RNA loop.  In financial economics  Covariances play a key role in financial economics , especially in portfolio theory and in the capital asset pricing model . Covariances among various assets' returns are used to determine, under certain assumptions, the relative amounts of different assets that investors should (in a normative analysis ) or are predicted to (in a positive analysis ) choose to hold in a context of diversification .  In meteorological data assimilation  The covariance matrix is important in estimating the initial conditions required for running weather forecast models.  See also   Algorithms for calculating covariance  Analysis of covariance  Autocovariance  Correlation and dependence  Covariance function  Covariance mapping  Covariance matrix  Covariance operator  Distance covariance , or Brownian covariance.  Eddy covariance  Law of total covariance  Propagation of uncertainty   References  External links    MathWorld page on calculating the sample covariance  Covariance Tutorial using R   "  Category:Covariance and correlation  Category:Algebra of random variables     http://mathworld.wolfram.com/Covariance.html ↩  Oxford Dictionary of Statistics, Oxford University Press, 2002, p. 104. ↩  Donald E. Knuth (1998). The Art of Computer Programming , volume 2: Seminumerical Algorithms , 3rd edn., p. 232. Boston: Addison-Wesley. ↩  W. J. Krzanowski, Principles of Multivariate Analysis , Chap. 7.1, Oxford University Press, New York, 1988 ↩  ↩     
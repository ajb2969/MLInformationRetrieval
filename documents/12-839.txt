   Change of variables (PDE)      Change of variables (PDE)   Often a partial differential equation can be reduced to a simpler form with a known solution by a suitable change of variables .  The article discusses change of variable for PDEs below in two ways:   by example;  by giving the theory of the method.   Explanation by example  For example the following simplified form of the Black–Scholes PDE          ∂  V    ∂  t    +    1  2    S  2      ∂  2   V    ∂   S  2      +   S    ∂  V    ∂  S      -  V   =  0.              V     t        1  2    superscript  S  2       superscript   2   V      superscript  S  2        S      V     S      V   0.    \frac{\partial V}{\partial t}+\frac{1}{2}S^{2}\frac{\partial^{2}V}{\partial S^%
 {2}}+S\frac{\partial V}{\partial S}-V=0.     is reducible to the heat equation        ∂  u    ∂  τ    =     ∂  2   u    ∂   x  2             u     τ        superscript   2   u      superscript  x  2       \frac{\partial u}{\partial\tau}=\frac{\partial^{2}u}{\partial x^{2}}     by the change of variables: 1       V   (  S  ,  t  )    =   v   (   x   (  S  )    ,   τ   (  t  )    )          V   S  t      v     x  S     τ  t       V(S,t)=v(x(S),\tau(t))          x   (  S  )    =   ln   (  S  )          x  S     S     x(S)=\ln(S)          τ   (  t  )    =    1  2    (   T  -  t   )          τ  t       1  2     T  t      \tau(t)=\frac{1}{2}(T-t)          v   (  x  ,  τ  )    =    exp   (    -    (   1  /  2   )   x    -    (   9  /  4   )   τ    )    u   (  x  ,  τ  )          v   x  τ                1  2   x        9  4   τ     u   x  τ      v(x,\tau)=\exp(-(1/2)x-(9/4)\tau)u(x,\tau)     in these steps:   Replace    V   (  S  ,  t  )       V   S  t     V(S,t)   by    v   (   x   (  S  )    ,   τ   (  t  )    )       v     x  S     τ  t      v(x(S),\tau(t))   and apply the chain rule to get     \frac{1}{2}\left(-2v(x(S),\tau)+2 \frac{\partial\tau}{\partial t} \frac{\partial v}{\partial \tau} +S\left(\left(2 \frac{\partial x}{\partial S} + S\frac{\partial^2 x}{\partial S^2}\right)     \frac{\partial v}{\partial x} + S \left(\frac{\partial x}{\partial S}\right)^2 \frac{\partial^2 v}{\partial x^2}\right)\right)=0.   Replace    x   (  S  )       x  S    x(S)   and    τ   (  t  )       τ  t    \tau(t)   by    ln   (  S  )       S    \ln(S)   and     1  2    (   T  -  t   )         1  2     T  t     \frac{1}{2}(T-t)   to get     \frac{1}{2}\left(     -2v(\ln(S),\frac{1}{2}(T-t))  -\frac{\partial v(\ln(S),\frac{1}{2}(T-t))}{\partial\tau}  +\frac{\partial v(\ln(S),\frac{1}{2}(T-t))}{\partial x}  +\frac{\partial^2 v(\ln(S),\frac{1}{2}(T-t))}{\partial x^2}\right)=0.    Replace    ln   (  S  )       S    \ln(S)   and     1  2    (   T  -  t   )         1  2     T  t     \frac{1}{2}(T-t)   by    x   (  S  )       x  S    x(S)   and    τ   (  t  )       τ  t    \tau(t)   and divide both sides by    1  2      1  2    \frac{1}{2}   to get            -   2  v    -    ∂  v    ∂  τ     +    ∂  v    ∂  x    +     ∂  2   v    ∂   x  2      =  0.              2  v        v     τ         v     x        superscript   2   v      superscript  x  2      0.    -2v-\frac{\partial v}{\partial\tau}+\frac{\partial v}{\partial x}+\frac{%
 \partial^{2}v}{\partial x^{2}}=0.         Replace    v   (  x  ,  τ  )       v   x  τ     v(x,\tau)   by     exp   (    -    (   1  /  2   )   x    -    (   9  /  4   )   τ    )    u   (  x  ,  τ  )                 1  2   x        9  4   τ     u   x  τ     \exp(-(1/2)x-(9/4)\tau)u(x,\tau)   and divide through by    -    exp   (    -    (   1  /  2   )   x    -    (   9  /  4   )   τ    )    u   (  x  ,  τ  )                    1  2   x        9  4   τ     u   x  τ      -\exp(-(1/2)x-(9/4)\tau)u(x,\tau)   to yield the heat equation.   Advice on the application of change of variable to PDEs is given by mathematician J. Michael Steele : 2   Technique in general  Suppose that we have a function    u   (  x  ,  t  )       u   x  t     u(x,t)   and a change of variables     x  1   ,   x  2       subscript  x  1    subscript  x  2     x_{1},x_{2}   such that there exist functions     a   (  x  ,  t  )    ,   b   (  x  ,  t  )         a   x  t      b   x  t      a(x,t),b(x,t)   such that       x  1   =   a   (  x  ,  t  )         subscript  x  1     a   x  t      x_{1}=a(x,t)          x  2   =   b   (  x  ,  t  )         subscript  x  2     b   x  t      x_{2}=b(x,t)     and functions     e   (   x  1   ,   x  2   )    ,   f   (   x  1   ,   x  2   )         e    subscript  x  1    subscript  x  2       f    subscript  x  1    subscript  x  2       e(x_{1},x_{2}),f(x_{1},x_{2})   such that      x  =   e   (   x  1   ,   x  2   )        x    e    subscript  x  1    subscript  x  2       x=e(x_{1},x_{2})         t  =   f   (   x  1   ,   x  2   )        t    f    subscript  x  1    subscript  x  2       t=f(x_{1},x_{2})     and furthermore such that       x  1   =   a   (   e   (   x  1   ,   x  2   )    ,   f   (   x  1   ,   x  2   )    )         subscript  x  1     a     e    subscript  x  1    subscript  x  2       f    subscript  x  1    subscript  x  2         x_{1}=a(e(x_{1},x_{2}),f(x_{1},x_{2}))          x  2   =   b   (   e   (   x  1   ,   x  2   )    ,   f   (   x  1   ,   x  2   )    )         subscript  x  2     b     e    subscript  x  1    subscript  x  2       f    subscript  x  1    subscript  x  2         x_{2}=b(e(x_{1},x_{2}),f(x_{1},x_{2}))     and      x  =   e   (   a   (  x  ,  t  )    ,   b   (  x  ,  t  )    )        x    e     a   x  t      b   x  t        x=e(a(x,t),b(x,t))         t  =   f   (   a   (  x  ,  t  )    ,   b   (  x  ,  t  )    )        t    f     a   x  t      b   x  t        t=f(a(x,t),b(x,t))     In other words, it is helpful for there to be a bijection between the old set of variables and the new one, or else one has to   Restrict the domain of applicability of the correspondence to a subject of the real plane which is sufficient for a solution of the practical problem at hand (where again it needs to be a bijection), and  Enumerate the (zero or more finite list) of exceptions (poles) where the otherwise-bijection fails (and say why these exceptions don't restrict the applicability of the solution of the reduced equation to the original equation)   If a bijection does not exist then the solution to the reduced-form equation will not in general be a solution of the original equation.  We are discussing change of variable for PDEs. A PDE can be expressed as a differential operator applied to a function. Suppose   ℒ   ℒ   \mathcal{L}   is a differential operator such that       ℒ  u   (  x  ,  t  )    =  0        ℒ  u   x  t    0    \mathcal{L}u(x,t)=0     Then it is also the case that       ℒ  v   (   x  1   ,   x  2   )    =  0        ℒ  v    subscript  x  1    subscript  x  2     0    \mathcal{L}v(x_{1},x_{2})=0     where       v   (   x  1   ,   x  2   )    =   u   (   e   (   x  1   ,   x  2   )    ,   f   (   x  1   ,   x  2   )    )          v    subscript  x  1    subscript  x  2       u     e    subscript  x  1    subscript  x  2       f    subscript  x  1    subscript  x  2         v(x_{1},x_{2})=u(e(x_{1},x_{2}),f(x_{1},x_{2}))     and we operate as follows to go from     ℒ  u   (  x  ,  t  )    =  0        ℒ  u   x  t    0    \mathcal{L}u(x,t)=0   to      ℒ  v   (   x  1   ,   x  2   )    =  0   :      normal-:      ℒ  v    subscript  x  1    subscript  x  2     0   absent    \mathcal{L}v(x_{1},x_{2})=0:      Apply the chain rule to     ℒ  v   (    x  1    (  x  ,  t  )    ,    x  2    (  x  ,  t  )    )    =  0        ℒ  v      subscript  x  1    x  t       subscript  x  2    x  t      0    \mathcal{L}v(x_{1}(x,t),x_{2}(x,t))=0   and expand out giving equation    e  1     subscript  e  1    e_{1}   .  Substitute    a   (  x  ,  t  )       a   x  t     a(x,t)   for     x  1    (  x  ,  t  )        subscript  x  1    x  t     x_{1}(x,t)   and    b   (  x  ,  t  )       b   x  t     b(x,t)   for     x  2    (  x  ,  t  )        subscript  x  2    x  t     x_{2}(x,t)   in    e  1     subscript  e  1    e_{1}   and expand out giving equation    e  2     subscript  e  2    e_{2}   .  Replace occurrences of   x   x   x   by    e   (   x  1   ,   x  2   )       e    subscript  x  1    subscript  x  2      e(x_{1},x_{2})   and   t   t   t   by    f   (   x  1   ,   x  2   )       f    subscript  x  1    subscript  x  2      f(x_{1},x_{2})   to yield     ℒ  v   (   x  1   ,   x  2   )    =  0        ℒ  v    subscript  x  1    subscript  x  2     0    \mathcal{L}v(x_{1},x_{2})=0   , which will be free of   x   x   x   and   t   t   t   .   Action-angle coordinates  Often, theory can establish the existence of a change of variables, although the formula itself cannot be explicitly stated. For an integrable Hamiltonian system of dimension   n   n   n   , with      x  ˙   i   =    ∂  H   /   ∂   p  j          subscript   normal-˙  x   i       H      subscript  p  j       \dot{x}_{i}=\partial H/\partial p_{j}   and      p  ˙   j   =   -    ∂  H   /   ∂   x  j           subscript   normal-˙  p   j         H      subscript  x  j        \dot{p}_{j}=-\partial H/\partial x_{j}   , there exist   n   n   n   integrals    I  i     subscript  I  i    I_{i}   . There exists a change of variables from the coordinates    {   x  1   ,  …  ,   x  n   ,   p  1   ,  …  ,   p  n   }      subscript  x  1   normal-…   subscript  x  n    subscript  p  1   normal-…   subscript  p  n     \{x_{1},\dots,x_{n},p_{1},\dots,p_{n}\}   to a set of variables    {   I  1   ,   …   I  n    ,   φ  1   ,  …  ,   φ  n   }      subscript  I  1     normal-…   subscript  I  n     subscript  φ  1   normal-…   subscript  φ  n     \{I_{1},\dots I_{n},\varphi_{1},\dots,\varphi_{n}\}   , in which the equations of motion become      I  ˙   i   =  0       subscript   normal-˙  I   i   0    \dot{I}_{i}=0   ,      φ  ˙   i   =    ω  i    (   I  1   ,  …  ,   I  n   )         subscript   normal-˙  φ   i      subscript  ω  i     subscript  I  1   normal-…   subscript  I  n       \dot{\varphi}_{i}=\omega_{i}(I_{1},\dots,I_{n})   , where the functions     ω  1   ,  …  ,   ω  n       subscript  ω  1   normal-…   subscript  ω  n     \omega_{1},\dots,\omega_{n}   are unknown, but depend only on     I  1   ,  …  ,   I  n       subscript  I  1   normal-…   subscript  I  n     I_{1},\dots,I_{n}   . The variables     I  1   ,  …  ,   I  n       subscript  I  1   normal-…   subscript  I  n     I_{1},\dots,I_{n}   are the action coordinates, the variables     φ  1   ,  …  ,   φ  n       subscript  φ  1   normal-…   subscript  φ  n     \varphi_{1},\dots,\varphi_{n}   are the angle coordinates. The motion of the system can thus be visualized as rotation on torii. As a particular example, consider the simple harmonic oscillator, with     x  ˙   =   2  p        normal-˙  x     2  p     \dot{x}=2p   and     p  ˙   =   -   2  x         normal-˙  p       2  x      \dot{p}=-2x   , with Hamiltonian     H   (  x  ,  p  )    =    x  2   +   p  2          H   x  p       superscript  x  2    superscript  p  2      H(x,p)=x^{2}+p^{2}   . This system can be rewritten as     I  ˙   =  0       normal-˙  I   0    \dot{I}=0   ,     φ  ˙   =  1       normal-˙  φ   1    \dot{\varphi}=1   , where   I   I   I   and   φ   φ   \varphi   are the canonical polar coordinates    I  =    p  2   +   q  2        I     superscript  p  2    superscript  q  2      I=p^{2}+q^{2}   and     tan   (  φ  )    =   p  /  x         φ     p  x     \tan(\varphi)=p/x   . See V. I. Arnold , `Mathematical Methods of Classical Mechanics', for more details. 3  References    "  Category:Multivariable calculus  *     Ömür Ugur , An Introduction to Computational Finance , Series in Quantitative Finance, v. 1, Imperial College Press, 298 pp., 2009 ↩  J. Michael Steele , Stochastic Calculus and Financial Applications , Springer, New York, 2001 ↩  V. I. Arnold , Mathematical Methods of Classical Mechanics , Graduate Texts in Mathematics, v. 60, Springer-Verlag, New York, 1989 ↩     
   Markov switching multifractal      Markov switching multifractal   In financial econometrics , the Markov-switching multifractal (MSM) is a model of asset returns that incorporates stochastic volatility components of heterogeneous durations . 1 2 MSM captures the outliers , log-memory-like volatility persistence and power variation of financial returns . In currency and equity series, MSM compares favorably with standard volatility models such as GARCH(1,1) and FIGARCH both in- and out-of-sample. MSM is used by practitioners in the financial industry to forecast volatility , compute value-at-risk , and price derivatives .  MSM specification  The MSM model can be specified in both discrete time and continuous time.  Discrete time  Let    P  t     subscript  P  t    P_{t}   denote the price of a financial asset, and let     r  t   =   ln   (    P  t   /   P   t  -  1     )         subscript  r  t        subscript  P  t    subscript  P    t  1        r_{t}=\ln(P_{t}/P_{t-1})   denote the return over two consecutive periods. In MSM, returns are specified as        r  t   =   Œº  +    œÉ  ¬Ø     (    M   1  ,  t     M   2  ,  t    ‚Ä¶   M    k  ¬Ø   ,  t     )    1  /  2     œµ  t      ,       subscript  r  t     Œº     normal-¬Ø  œÉ    superscript     subscript  M   1  t     subscript  M   2  t    normal-‚Ä¶   subscript  M    normal-¬Ø  k   t       1  2     subscript  œµ  t       r_{t}=\mu+\bar{\sigma}(M_{1,t}M_{2,t}...M_{\bar{k},t})^{1/2}\epsilon_{t},     where   Œº   Œº   \mu   and   œÉ   œÉ   \sigma   are constants and {    œµ  t     subscript  œµ  t    \epsilon_{t}   } are independent standard Gaussians. Volatility is driven by the first-order latent Markov state vector:        M  t   =   (    M   1  ,  t     M   2  ,  t    ‚Ä¶   M    k  ¬Ø   ,  t     )   ‚àà   R  +   k  ¬Ø     .         subscript  M  t      subscript  M   1  t     subscript  M   2  t    normal-‚Ä¶   subscript  M    normal-¬Ø  k   t           superscript   subscript  R     normal-¬Ø  k       M_{t}=(M_{1,t}M_{2,t}\dots M_{\bar{k},t})\in R_{+}^{\bar{k}}.     Given the volatility state    M  t     subscript  M  t    M_{t}   , the next-period multiplier    M   k  ,   t  +  1       subscript  M   k    t  1      M_{k,t+1}   is drawn from a fixed distribution   M   M   M   with probability    Œ≥  k     subscript  Œ≥  k    \gamma_{k}   , and is otherwise left unchanged.            The transition probabilities are specified by       Œ≥  k   =   1  -    (   1  -   Œ≥  1    )    (   b   k  -  1    )          subscript  Œ≥  k     1   superscript    1   subscript  Œ≥  1     superscript  b    k  1        \gamma_{k}=1-(1-\gamma_{1})^{(b^{k-1})}   .  The sequence    Œ≥  k     subscript  Œ≥  k    \gamma_{k}   is approximately geometric     Œ≥  k   ‚âà    Œ≥  1    b   k  -  1          subscript  Œ≥  k      subscript  Œ≥  1    superscript  b    k  1       \gamma_{k}\approx\gamma_{1}b^{k-1}   at low frequency. The marginal distribution   M   M   M   has a unit mean, has a positive support, and is independent of   k   k   k   .  Binomial MSM  In empirical applications, the distribution   M   M   M   is often a discrete distribution that can take the values    m  0     subscript  m  0    m_{0}   or    2  -   m  0       2   subscript  m  0     2-m_{0}   with equal probability. The return process    r  t     subscript  r  t    r_{t}   is then specified by the parameters    Œ∏  =   (   m  0   ,  Œº  ,   œÉ  ¬Ø   ,  b  ,   Œ≥  1   )       Œ∏    subscript  m  0   Œº   normal-¬Ø  œÉ   b   subscript  Œ≥  1      \theta=(m_{0},\mu,\bar{\sigma},b,\gamma_{1})   . Note that the number of parameters is the same for all     k  ¬Ø   >  1       normal-¬Ø  k   1    \bar{k}>1   .  Continuous time  MSM is similarly defined in continuous time. The price process follows the diffusion:         d   P  t     P  t    =    Œº  d  t   +   œÉ   (   M  t   )   d   W  t      ,          d   subscript  P  t     subscript  P  t        Œº  d  t     œÉ   subscript  M  t   d   subscript  W  t       \frac{dP_{t}}{P_{t}}=\mu dt+\sigma(M_{t})\,dW_{t},     where     œÉ   (   M  t   )    =    œÉ  ¬Ø     (    M   1  ,  t    ‚Ä¶   M    k  ¬Ø   ,  t     )    1  /  2           œÉ   subscript  M  t       normal-¬Ø  œÉ    superscript     subscript  M   1  t    normal-‚Ä¶   subscript  M    normal-¬Ø  k   t       1  2       \sigma(M_{t})=\bar{\sigma}(M_{1,t}\dots M_{\bar{k},t})^{1/2}   ,    W  t     subscript  W  t    W_{t}   is a standard Brownian motion, and   Œº   Œº   \mu   and    œÉ  ¬Ø     normal-¬Ø  œÉ    \bar{\sigma}   are constants. Each component follows the dynamics:            The intensities vary geometrically with   k   k   k   :        Œ≥  k   =    Œ≥  1    b   k  -  1      .       subscript  Œ≥  k      subscript  Œ≥  1    superscript  b    k  1       \gamma_{k}=\gamma_{1}b^{k-1}.     When the number of components    k  ¬Ø     normal-¬Ø  k    \bar{k}   goes to infinity, continuous-time MSM converges to a multifractal diffusion, whose sample paths take a continuum of local H√∂lder exponents on any finite time interval.  Inference and closed-form likelihood  When   M   M   M   has a discrete distribution , the Markov state vector    M  t     subscript  M  t    M_{t}   takes finitely many values      m  1   ,  ‚Ä¶  ,   m  d    ‚àà   R  +   k  ¬Ø          superscript  m  1   normal-‚Ä¶   superscript  m  d     superscript   subscript  R     normal-¬Ø  k      m^{1},...,m^{d}\in R_{+}^{\bar{k}}   . For instance, there are    d  =   2   k  ¬Ø        d   superscript  2   normal-¬Ø  k      d=2^{\bar{k}}   possible states in binomial MSM. The Markov dynamics are characterized by the transition matrix    A  =    (   a   i  ,  j    )     1  ‚â§  i   ,   j  ‚â§  d         A   subscript   subscript  a   i  j     formulae-sequence    1  i     j  d       A=(a_{i,j})_{1\leq i,j\leq d}   with components     a   i  ,  j    =  P   (   M   t  +  1    =   m  j   |   M  t   =   m  i   )      fragments   subscript  a   i  j     P   fragments  normal-(   subscript  M    t  1      superscript  m  j   normal-|   subscript  M  t     superscript  m  i   normal-)     a_{i,j}=P\left(M_{t+1}=m^{j}|M_{t}=m^{i}\right)   . Conditional on the volatility state, the return    r  t     subscript  r  t    r_{t}   has Gaussian density      f   (   r  t   |   M  t   =   m  i   )   =   1    2  œÄ   œÉ  2    (   m  i   )      exp   [  -     (    r  t   -  Œº   )   2    2   œÉ  2    (   m  i   )     ]   .     fragments  f   fragments  normal-(   subscript  r  t   normal-|   subscript  M  t     superscript  m  i   normal-)      1      2  œÄ   superscript  œÉ  2    superscript  m  i        fragments  normal-[      superscript     subscript  r  t   Œº   2     2   superscript  œÉ  2    superscript  m  i     normal-]   normal-.    f(r_{t}|M_{t}=m^{i})=\frac{1}{\sqrt{2\pi\sigma^{2}(m^{i})}}\exp\left[-\frac{(r%
 _{t}-\mu)^{2}}{2\sigma^{2}(m^{i})}\right].     Conditional distribution  We do not directly observe the latent state vector    M  t     subscript  M  t    M_{t}   . Given past returns, we can define the conditional probabilities:       Œ†  t  j   ‚â°  P   (   M  t   =   m  j   |   r  1   ,  ‚Ä¶  ,   r  t   )   .     fragments   superscript   subscript  normal-Œ†  t   j    P   fragments  normal-(   subscript  M  t     superscript  m  j   normal-|   subscript  r  1   normal-,  normal-‚Ä¶  normal-,   subscript  r  t   normal-)   normal-.    \Pi_{t}^{j}\equiv P(M_{t}=m^{j}|r_{1},...,r_{t}).     The vector     Œ†  t   =   (   Œ†  t  1   ,  ‚Ä¶  ,   Œ†  t  d   )        subscript  normal-Œ†  t     superscript   subscript  normal-Œ†  t   1   normal-‚Ä¶   superscript   subscript  normal-Œ†  t   d      \Pi_{t}=(\Pi_{t}^{1},...,\Pi_{t}^{d})   is computed recursively:        Œ†  t   =     œâ   (   r  t   )    *   (    Œ†   t  -  1    A   )      [    œâ   (   r  t   )    *   (    Œ†   t  -  1    A   )    ]    ùüè  ‚Ä≤      .       subscript  normal-Œ†  t         œâ   subscript  r  t       subscript  normal-Œ†    t  1    A       delimited-[]      œâ   subscript  r  t       subscript  normal-Œ†    t  1    A      superscript  1  normal-‚Ä≤       \Pi_{t}=\frac{\omega(r_{t})*(\Pi_{t-1}A)}{[\omega(r_{t})*(\Pi_{t-1}A)]\textbf{%
 1}^{\prime}}.     where    ùüè  =   (  1  ,  ‚Ä¶  ,  1  )   ‚àà   R  d         1   1  normal-‚Ä¶  1         superscript  R  d      \textbf{1}=(1,\dots,1)\in R^{d}   ,     x  *  y   =   (    x  1    y  1    ,  ‚Ä¶  ,    x  d    y  d    )         x  y       subscript  x  1    subscript  y  1    normal-‚Ä¶     subscript  x  d    subscript  y  d       x*y=\left(x_{1}y_{1},\dots,x_{d}y_{d}\right)   for any     x  ,  y   ‚àà   R  d        x  y    superscript  R  d     x,y\in R^{d}   , and      œâ   (   r  t   )   =   [  f   (   r  t   |   M  t   =   m  1   )   ;  ‚Ä¶  ;  f   (   r  t   |   M  t   =   m  d   )   ]   .     fragments  œâ   fragments  normal-(   subscript  r  t   normal-)     fragments  normal-[  f   fragments  normal-(   subscript  r  t   normal-|   subscript  M  t     superscript  m  1   normal-)   normal-;  normal-‚Ä¶  normal-;  f   fragments  normal-(   subscript  r  t   normal-|   subscript  M  t     superscript  m  d   normal-)   normal-]   normal-.    \omega(r_{t})=\left[f(r_{t}|M_{t}=m^{1});\dots;f(r_{t}|M_{t}=m^{d})\right].     The initial vector    Œ†  0     subscript  normal-Œ†  0    \Pi_{0}   is set equal to the ergodic distribution of    M  t     subscript  M  t    M_{t}   . For binomial MSM,     Œ†  0  j   =   1  /  d   =   2   -   k  ¬Ø            superscript   subscript  normal-Œ†  0   j     1  d         superscript  2     normal-¬Ø  k        \Pi_{0}^{j}=1/d=2^{-\bar{k}}   for all   j   j   j   .  Closed-form Likelihood  The log likelihood function has the following analytical expression:      ln  L   (   r  1   ,  ‚Ä¶  ,   r  T   ;  Œ∏  )   =   ‚àë   t  =  1   T   ln   [  œâ   (   r  t   )   .   (   Œ†   t  -  1    A  )   ]   .     fragments   L   fragments  normal-(   subscript  r  1   normal-,  normal-‚Ä¶  normal-,   subscript  r  T   normal-;  Œ∏  normal-)     superscript   subscript     t  1    T     fragments  normal-[  œâ   fragments  normal-(   subscript  r  t   normal-)   normal-.   fragments  normal-(   subscript  normal-Œ†    t  1    A  normal-)   normal-]   normal-.    \ln L(r_{1},\dots,r_{T};\theta)=\sum_{t=1}^{T}\ln[\omega(r_{t}).(\Pi_{t-1}A)].     Maximum likelihood provides reasonably precise estimates in finite samples. 3  Other estimation methods  When   M   M   M   has a continuous distribution , estimation can proceed by simulated method of moments, 4 5 or simulated likelihood via a particle filter. 6  Forecasting  Given     r  1   ,  ‚Ä¶  ,   r  t       subscript  r  1   normal-‚Ä¶   subscript  r  t     r_{1},\dots,r_{t}   , the conditional distribution of the latent state vector at date    t  +  n      t  n    t+n   is given by:         Œ†  ^    t  ,  n    =    Œ†  t    A  n     .       subscript   normal-^  normal-Œ†    t  n       subscript  normal-Œ†  t    superscript  A  n      \hat{\Pi}_{t,n}=\Pi_{t}A^{n}.\,     MSM often provides better volatility forecasts than some of the best traditional models both in and out of sample. Calvet and Fisher 7 report considerable gains in exchange rate volatility forecasts at horizons of 10 to 50 days as compared with GARCH(1,1), Markov-Switching GARCH, 8 9 and Fractionally Integrated GARCH. 10 Lux 11 obtains similar results using linear predictions.  Applications  Multiple assets and value-at-risk  Extensions of MSM to multiple assets provide reliable estimates of the value-at-risk in a portfolio of securities. 12  Asset pricing  In financial economics, MSM has been used to analyze the pricing implications of multifrequency risk. The models have had some success in explaining the excess volatility of stock returns compared to fundamentals and the negative skewness of equity returns. They have also been used to generate multifractal jump-diffusions. 13  Related approaches  MSM is a stochastic volatility model 14 15 with arbitrarily many frequencies. MSM builds on the convenience of regime-switching models, which were advanced in economics and finance by James D. Hamilton . 16 17 MSM is closely related to the Multifractal Model of Asset Returns . 18 MSM improves on the MMAR‚Äôs combinatorial construction by randomizing arrival times, guaranteeing a strictly stationary process. MSM provides a pure regime-switching formulation of multifractal measures, which were pioneered by Benoit Mandelbrot . 19 20 21  See also   Brownian motion  Markov chain  Multifractal model of asset returns  Multifractal  Stochastic volatility   References  External links   Financial Time Series, Multifractals and Hidden Markov Models   "  Category:Mathematical finance  Category:Markov models  Category:Fractals     ‚Ü©  ‚Ü©   ‚Ü©  ‚Ü©  ‚Ü©   ‚Ü©  ‚Ü©  ‚Ü©    ‚Ü©  ‚Ü©  ‚Ü©  ‚Ü©  ‚Ü©  ‚Ü©  ‚Ü©  ‚Ü©  ‚Ü©     
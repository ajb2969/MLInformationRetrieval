   Hamiltonian mechanics      Hamiltonian mechanics   Hamiltonian mechanics is a theory developed as a reformulation of classical mechanics and predicts the same outcomes as non-Hamiltonian classical mechanics. It uses a different mathematical formalism, providing a more abstract understanding of the theory. Historically, it was an important reformulation of classical mechanics, which later contributed to the formulation of quantum mechanics .  Hamiltonian mechanics was first formulated by William Rowan Hamilton in 1833, starting from Lagrangian mechanics , a previous reformulation of classical mechanics introduced by Joseph Louis Lagrange in 1788.  Overview  In Hamiltonian mechanics, a classical physical system is described by a set of canonical coordinates     ùíì  =   (  ùíí  ,  ùíë  )       ùíì   ùíí  ùíë     \boldsymbol{r}=(\boldsymbol{q},\boldsymbol{p})   , where each component of the coordinate     q  i   ,   p  i       subscript  q  i    subscript  p  i     q_{i},p_{i}   is indexed to the frame of reference of the system.  The time evolution of the system is uniquely defined by Hamilton's equations: 1  {\mathrm{d}t} = -\frac{\partial \mathcal{H}}{\partial \boldsymbol{q}}\\ & \frac{\mathrm{d}\boldsymbol{q}}{\mathrm{d}t} = +\frac{\partial \mathcal{H}}{\partial \boldsymbol{p}} \end{align}  |cellpadding= 5 |border |border colour = #0073CF |background colour=#F5FFFA}}  where    ‚Ñã  =   ‚Ñã   (  ùíí  ,  ùíë  ,  t  )        ‚Ñã    ‚Ñã   ùíí  ùíë  t      \mathcal{H}=\mathcal{H}(\boldsymbol{q},\boldsymbol{p},t)   is the Hamiltonian, which often corresponds to the total energy of the system. 2 For a closed system, it is the sum of the kinetic and potential energy in the system.  In Newtonian mechanics, the time evolution is obtained by computing the total force being exerted on each particle of the system, and from Newton's second law , the time-evolutions of both position and velocity are computed. In contrast, in Hamiltonian mechanics, the time evolution is obtained by computing the Hamiltonian of the system in the generalized coordinates and inserting it in the Hamiltonian equations. This approach is equivalent to the one used in Lagrangian mechanics . In fact, as is shown below, the Hamiltonian is the Legendre transform of the Lagrangian, and thus both approaches give the same equations for the same generalized momentum. The main motivation to use Hamiltonian mechanics instead of Lagrangian mechanics comes from the symplectic structure of Hamiltonian systems .  While Hamiltonian mechanics can be used to describe simple systems such as a bouncing ball, a pendulum or an oscillating spring in which energy changes from kinetic to potential and back again over time, its strength is shown in more complex dynamic systems, such as planetary orbits in celestial mechanics . 3 The more degrees of freedom the system has, the more complicated its time evolution is and, in most cases, it becomes chaotic .  Basic physical interpretation  A simple interpretation of the Hamilton mechanics comes from its application on a one-dimensional system consisting of one particle of mass m . The Hamiltonian represents the total energy of the system, which is the sum of kinetic and potential energy , traditionally denoted T and V , respectively. Here q is the coordinate and p is the momentum, mv. Then        ‚Ñã  =   T  +  V    ,    T  =    p  2    2  m     ,   V  =   V   (  q  )       .     formulae-sequence    ‚Ñã    T  V     formulae-sequence    T     superscript  p  2     2  m       V    V  q       \mathcal{H}=T+V,\quad T=\frac{p^{2}}{2m},\quad V=V(q).     Note that T is a function of p alone, while V is a function of q alone (i.e., T and V are scleronomic ).  In this example, the time-derivative of the momentum p equals the Newtonian force , and so the first Hamilton equation means that the force equals the negative gradient of potential energy. The time-derivative of q is the velocity, and so the second Hamilton equation means that the particle‚Äôs velocity equals the derivative of its kinetic energy with respect to its momentum.  Calculating a Hamiltonian from a Lagrangian  Given a Lagrangian in terms of the generalized coordinates     q  i     subscript  q  i    q_{i}   and generalized velocities      q  Àô   i     subscript   normal-Àô  q   i    \dot{q}_{i}   and time,   The momenta are calculated by differentiating the Lagrangian with respect to the (generalized) velocities       p  i    (   q  i   ,    q  Àô   i   ,  t  )    =     ‚àÇ  ‚Ñí    ‚àÇ    q  Àô   i       .         subscript  p  i     subscript  q  i    subscript   normal-Àô  q   i   t        ‚Ñí      subscript   normal-Àô  q   i       p_{i}(q_{i},\dot{q}_{i},t)=\frac{\partial\mathcal{L}}{\partial{\dot{q}_{i}}}\,.     The velocities     q  Àô   i     subscript   normal-Àô  q   i    \dot{q}_{i}   are expressed in terms of the momenta    p  i     subscript  p  i    p_{i}   by inverting the expressions in the previous step.  The Hamiltonian is calculated using the usual definition of   ‚Ñã   ‚Ñã   \mathcal{H}   as the Legendre transformation of   ‚Ñí   ‚Ñí   \mathcal{L}   :          ‚Ñã  =     ‚àë  i      q  Àô   i     ‚àÇ  ‚Ñí    ‚àÇ    q  Àô   i       -  ‚Ñí   =     ‚àë  i      q  Àô   i    p  i     -   ‚Ñí     .        ‚Ñã      subscript   i      subscript   normal-Àô  q   i       ‚Ñí      subscript   normal-Àô  q   i       ‚Ñí            subscript   i      subscript   normal-Àô  q   i    subscript  p  i     ‚Ñí      \mathcal{H}=\sum_{i}{\dot{q}_{i}}\frac{\partial\mathcal{L}}{\partial{\dot{q}_{%
 i}}}-\mathcal{L}=\sum_{i}{\dot{q}_{i}}p_{i}-\mathcal{L}\,.     Then the velocities are substituted for through the above results.     Deriving Hamilton's equations  Hamilton's equations can be derived by looking at how the total differential of the Lagrangian depends on time, generalized positions     q  i      subscript  q  i    q_{i}\,   and generalized velocities      q  Àô   i   :      normal-:   subscript   normal-Àô  q   i   absent    \dot{q}_{i}:    4        d  ‚Ñí   =     ‚àë  i    (      ‚àÇ  ‚Ñí    ‚àÇ   q  i     d   q  i    +     ‚àÇ  ‚Ñí    ‚àÇ    q  Àô   i     d    q  Àô   i     )    +     ‚àÇ  ‚Ñí    ‚àÇ  t    d   t      .        normal-d  ‚Ñí       subscript   i           ‚Ñí      subscript  q  i     normal-d   subscript  q  i          ‚Ñí      subscript   normal-Àô  q   i     normal-d   subscript   normal-Àô  q   i            ‚Ñí     t    normal-d  t      \mathrm{d}\mathcal{L}=\sum_{i}\left(\frac{\partial\mathcal{L}}{\partial q_{i}}%
 \mathrm{d}q_{i}+\frac{\partial\mathcal{L}}{\partial{\dot{q}_{i}}}\mathrm{d}{%
 \dot{q}_{i}}\right)+\frac{\partial\mathcal{L}}{\partial t}\mathrm{d}t\,.     Now the generalized momenta were defined as        p  i   =     ‚àÇ  ‚Ñí    ‚àÇ    q  Àô   i       .       subscript  p  i       ‚Ñí      subscript   normal-Àô  q   i       p_{i}=\frac{\partial\mathcal{L}}{\partial{\dot{q}_{i}}}\,.     If this is substituted into the total differential of the Lagrangian, one gets        d  ‚Ñí   =     ‚àë  i    (      ‚àÇ  ‚Ñí    ‚àÇ   q  i     d   q  i    +    p  i   d    q  Àô   i     )    +     ‚àÇ  ‚Ñí    ‚àÇ  t    d   t      .        normal-d  ‚Ñí       subscript   i           ‚Ñí      subscript  q  i     normal-d   subscript  q  i       subscript  p  i   normal-d   subscript   normal-Àô  q   i            ‚Ñí     t    normal-d  t      \mathrm{d}\mathcal{L}=\sum_{i}\left(\frac{\partial\mathcal{L}}{\partial q_{i}}%
 \mathrm{d}q_{i}+p_{i}\mathrm{d}{\dot{q}_{i}}\right)+\frac{\partial\mathcal{L}}%
 {\partial t}\mathrm{d}t\,.     We can rewrite this as       d  ‚Ñí   =     ‚àë  i    (       ‚àÇ  ‚Ñí    ‚àÇ   q  i     d   q  i    +   d   (    p  i     q  Àô   i    )     -     q  Àô   i   d   p  i     )    +     ‚àÇ  ‚Ñí    ‚àÇ  t    d   t           normal-d  ‚Ñí       subscript   i             ‚Ñí      subscript  q  i     normal-d   subscript  q  i      normal-d     subscript  p  i    subscript   normal-Àô  q   i         subscript   normal-Àô  q   i   normal-d   subscript  p  i            ‚Ñí     t    normal-d  t      \mathrm{d}\mathcal{L}=\sum_{i}\left(\frac{\partial\mathcal{L}}{\partial q_{i}}%
 \mathrm{d}q_{i}+\mathrm{d}\left(p_{i}{\dot{q}_{i}}\right)-{\dot{q}_{i}}\mathrm%
 {d}p_{i}\right)+\frac{\partial\mathcal{L}}{\partial t}\mathrm{d}t\,     and rearrange again to get        d   (     ‚àë  i     p  i     q  Àô   i     -  ‚Ñí   )    =     ‚àë  i    (    -     ‚àÇ  ‚Ñí    ‚àÇ   q  i     d   q  i     +     q  Àô   i   d   p  i     )    -     ‚àÇ  ‚Ñí    ‚àÇ  t    d   t      .        normal-d      subscript   i      subscript  p  i    subscript   normal-Àô  q   i     ‚Ñí        subscript   i             ‚Ñí      subscript  q  i     normal-d   subscript  q  i        subscript   normal-Àô  q   i   normal-d   subscript  p  i            ‚Ñí     t    normal-d  t      \mathrm{d}\left(\sum_{i}p_{i}{\dot{q}_{i}}-\mathcal{L}\right)=\sum_{i}\left(-%
 \frac{\partial\mathcal{L}}{\partial q_{i}}\mathrm{d}q_{i}+{\dot{q}_{i}}\mathrm%
 {d}p_{i}\right)-\frac{\partial\mathcal{L}}{\partial t}\mathrm{d}t\,.     The term on the left-hand side is just the Hamiltonian that we have defined before, so we find that        d  ‚Ñã   =     ‚àë  i    (    -     ‚àÇ  ‚Ñí    ‚àÇ   q  i     d   q  i     +     q  Àô   i   d   p  i     )    -     ‚àÇ  ‚Ñí    ‚àÇ  t    d  t     .        normal-d  ‚Ñã       subscript   i             ‚Ñí      subscript  q  i     normal-d   subscript  q  i        subscript   normal-Àô  q   i   normal-d   subscript  p  i            ‚Ñí     t    normal-d  t      \mathrm{d}\mathcal{H}=\sum_{i}\left(-\frac{\partial\mathcal{L}}{\partial q_{i}%
 }\mathrm{d}q_{i}+{\dot{q}_{i}}\mathrm{d}p_{i}\right)-\frac{\partial\mathcal{L}%
 }{\partial t}\mathrm{d}t.     We can also calculate the total differential of the Hamiltonian   ‚Ñã   ‚Ñã   \mathcal{H}   with respect to time directly, as we did with the Lagrangian   ‚Ñí   ‚Ñí   \mathcal{L}   above, yielding:        d  ‚Ñã   =     ‚àë  i    (      ‚àÇ  ‚Ñã    ‚àÇ   q  i     d   q  i    +     ‚àÇ  ‚Ñã    ‚àÇ   p  i     d   p  i     )    +     ‚àÇ  ‚Ñã    ‚àÇ  t    d  t     .        normal-d  ‚Ñã       subscript   i           ‚Ñã      subscript  q  i     normal-d   subscript  q  i          ‚Ñã      subscript  p  i     normal-d   subscript  p  i            ‚Ñã     t    normal-d  t      \mathrm{d}\mathcal{H}=\sum_{i}\left(\frac{\partial\mathcal{H}}{\partial q_{i}}%
 \mathrm{d}q_{i}+\frac{\partial\mathcal{H}}{\partial p_{i}}\mathrm{d}p_{i}%
 \right)+\frac{\partial\mathcal{H}}{\partial t}\mathrm{d}t.     It follows from the previous two independent equations that their right-hand sides are equal with each other. Thus we obtain the equation          ‚àë  i    (    -     ‚àÇ  ‚Ñí    ‚àÇ   q  i     d   q  i     +     q  Àô   i   d   p  i     )    -     ‚àÇ  ‚Ñí    ‚àÇ  t    d  t    =     ‚àë  i    (      ‚àÇ  ‚Ñã    ‚àÇ   q  i     d   q  i    +     ‚àÇ  ‚Ñã    ‚àÇ   p  i     d   p  i     )    +     ‚àÇ  ‚Ñã    ‚àÇ  t    d  t     .          subscript   i             ‚Ñí      subscript  q  i     normal-d   subscript  q  i        subscript   normal-Àô  q   i   normal-d   subscript  p  i            ‚Ñí     t    normal-d  t        subscript   i           ‚Ñã      subscript  q  i     normal-d   subscript  q  i          ‚Ñã      subscript  p  i     normal-d   subscript  p  i            ‚Ñã     t    normal-d  t      \sum_{i}\left(-\frac{\partial\mathcal{L}}{\partial q_{i}}\mathrm{d}q_{i}+{\dot%
 {q}_{i}}\mathrm{d}p_{i}\right)-\frac{\partial\mathcal{L}}{\partial t}\mathrm{d%
 }t=\sum_{i}\left(\frac{\partial\mathcal{H}}{\partial q_{i}}\mathrm{d}q_{i}+%
 \frac{\partial\mathcal{H}}{\partial p_{i}}\mathrm{d}p_{i}\right)+\frac{%
 \partial\mathcal{H}}{\partial t}\mathrm{d}t.     Since this calculation was done off-shell , we can associate corresponding terms from both sides of this equation to yield:          ‚àÇ  ‚Ñã    ‚àÇ   q  i     =   -     ‚àÇ  ‚Ñí    ‚àÇ   q  i        ,      ‚àÇ  ‚Ñã    ‚àÇ   p  i     =     q  Àô   i     ,     ‚àÇ  ‚Ñã    ‚àÇ  t    =   -     ‚àÇ  ‚Ñí    ‚àÇ  t         .     formulae-sequence        ‚Ñã      subscript  q  i           ‚Ñí      subscript  q  i        formulae-sequence        ‚Ñã      subscript  p  i      subscript   normal-Àô  q   i          ‚Ñã     t          ‚Ñí     t         \frac{\partial\mathcal{H}}{\partial q_{i}}=-\frac{\partial\mathcal{L}}{%
 \partial q_{i}}\,,\quad\frac{\partial\mathcal{H}}{\partial p_{i}}=\dot{q}_{i}%
 \,,\quad\frac{\partial\mathcal{H}}{\partial t}=-{\partial\mathcal{L}\over%
 \partial t}\,.     On-shell, Lagrange's equations tell us that         d   d  t      ‚àÇ  ‚Ñí    ‚àÇ    q  Àô   i      -    ‚àÇ  ‚Ñí    ‚àÇ   q  i      =  0‚Äâ.            normal-d    normal-d  t        ‚Ñí      subscript   normal-Àô  q   i          ‚Ñí      subscript  q  i      0‚Äâ.    \frac{\mathrm{d}}{\mathrm{d}t}\frac{\partial\mathcal{L}}{\partial{\dot{q}_{i}}%
 }-\frac{\partial\mathcal{L}}{\partial q_{i}}=0\,.     We can rearrange this to get         ‚àÇ  ‚Ñí    ‚àÇ   q  i     =     p  Àô   i     .          ‚Ñí      subscript  q  i      subscript   normal-Àô  p   i     \frac{\partial\mathcal{L}}{\partial q_{i}}={\dot{p}}_{i}\,.     Thus Hamilton's equations hold on-shell:          ‚àÇ  ‚Ñã    ‚àÇ   q  j     =   -     p  Àô   j      ,      ‚àÇ  ‚Ñã    ‚àÇ   p  j     =     q  Àô   j     ,     ‚àÇ  ‚Ñã    ‚àÇ  t    =   -     ‚àÇ  ‚Ñí    ‚àÇ  t         .     formulae-sequence        ‚Ñã      subscript  q  j        subscript   normal-Àô  p   j      formulae-sequence        ‚Ñã      subscript  p  j      subscript   normal-Àô  q   j          ‚Ñã     t          ‚Ñí     t         \frac{\partial\mathcal{H}}{\partial q_{j}}=-\dot{p}_{j}\,,\quad\frac{\partial%
 \mathcal{H}}{\partial p_{j}}=\dot{q}_{j}\,,\quad\frac{\partial\mathcal{H}}{%
 \partial t}=-{\partial\mathcal{L}\over\partial t}\,.     As a reformulation of Lagrangian mechanics  Starting with Lagrangian mechanics , the equations of motion are based on generalized coordinates      {    q  j    |   j  =   1  ,  ‚Ä¶  ,  N    }     conditional-set   subscript  q  j     j   1  normal-‚Ä¶  N      \left\{q_{j}\ |\ j=1,\ldots,N\right\}     and matching generalized velocities       {     q  Àô   j    |   j  =   1  ,  ‚Ä¶  ,  N    }   .     conditional-set   subscript   normal-Àô  q   j     j   1  normal-‚Ä¶  N      \left\{\dot{q}_{j}\ |\ j=1,\ldots,N\right\}.     We write the Lagrangian as      ‚Ñí   (   q  j   ,    q  Àô   j   ,  t  )       ‚Ñí    subscript  q  j    subscript   normal-Àô  q   j   t     \mathcal{L}(q_{j},\dot{q}_{j},t)     with the subscripted variables understood to represent all N variables of that type. Hamiltonian mechanics aims to replace the generalized velocity variables with generalized momentum variables, also known as conjugate momenta . By doing so, it is possible to handle certain systems, such as aspects of quantum mechanics, that would otherwise be even more complicated.  For each generalized velocity, there is one corresponding conjugate momentum , defined as:        p  j   =    ‚àÇ  ‚Ñí    ‚àÇ    q  Àô   j      .       subscript  p  j       ‚Ñí      subscript   normal-Àô  q   j       p_{j}={\partial\mathcal{L}\over\partial\dot{q}_{j}}.     In Cartesian coordinates , the generalized momenta are precisely the physical linear momenta . In circular polar coordinates , the generalized momentum corresponding to the angular velocity is the physical angular momentum . For an arbitrary choice of generalized coordinates, it may not be possible to obtain an intuitive interpretation of the conjugate momenta.  One thing which is not too obvious in this coordinate dependent formulation is that different generalized coordinates are really nothing more than different coordinate patches on the same symplectic manifold (see Mathematical formalism , below).  The Hamiltonian is the Legendre transform of the Lagrangian :        ‚Ñã   (   q  j   ,   p  j   ,  t  )    =    (    ‚àë  i      q  Àô   i    p  i     )   -   ‚Ñí   (   q  j   ,    q  Àô   j   ,  t  )      .        ‚Ñã    subscript  q  j    subscript  p  j   t        subscript   i      subscript   normal-Àô  q   i    subscript  p  i       ‚Ñí    subscript  q  j    subscript   normal-Àô  q   j   t       \mathcal{H}\left(q_{j},p_{j},t\right)=\left(\sum_{i}\dot{q}_{i}p_{i}\right)-%
 \mathcal{L}(q_{j},\dot{q}_{j},t).     If the transformation equations defining the generalized coordinates are independent of t , and the Lagrangian is a sum of products of functions (in the generalized coordinates) which are homogeneous of order 0, 1 or 2, then it can be shown that H is equal to the total energy E = T + V .  Each side in the definition of    ‚Ñã   ‚Ñã   \mathcal{H}    produces a differential:      d  ‚Ñã      normal-d  ‚Ñã    \displaystyle\mathrm{d}\mathcal{H}     Substituting the previous definition of the conjugate momenta into this equation and matching coefficients, we obtain the equations of motion of Hamiltonian mechanics, known as the canonical equations of Hamilton:          ‚àÇ  ‚Ñã    ‚àÇ   q  j     =   -    p  Àô   j     ,      ‚àÇ  ‚Ñã    ‚àÇ   p  j     =    q  Àô   j    ,     ‚àÇ  ‚Ñã    ‚àÇ  t    =   -    ‚àÇ  ‚Ñí    ‚àÇ  t        .     formulae-sequence        ‚Ñã      subscript  q  j        subscript   normal-Àô  p   j      formulae-sequence        ‚Ñã      subscript  p  j      subscript   normal-Àô  q   j          ‚Ñã     t          ‚Ñí     t         \frac{\partial\mathcal{H}}{\partial q_{j}}=-\dot{p}_{j},\qquad\frac{\partial%
 \mathcal{H}}{\partial p_{j}}=\dot{q}_{j},\qquad\frac{\partial\mathcal{H}}{%
 \partial t}=-{\partial\mathcal{L}\over\partial t}.     Hamilton's equations consist of 2n first-order differential equations , while Lagrange's equations consist of n second-order equations. However, Hamilton's equations usually don't reduce the difficulty of finding explicit solutions. They still offer some advantages, since important theoretical results can be derived because coordinates and momenta are independent variables with nearly symmetric roles.  Hamilton's equations have another advantage over Lagrange's equations: if a system has a symmetry, such that a coordinate does not occur in the Hamiltonian, the corresponding momentum is conserved, and that coordinate can be ignored in the other equations of the set. Effectively, this reduces the problem from n coordinates to (n-1) coordinates. In the Lagrangian framework, of course the result that the corresponding momentum is conserved still follows immediately, but all the generalized velocities still occur in the Lagrangian - we still have to solve a system of equations in n coordinates. 5  The Lagrangian and Hamiltonian approaches provide the groundwork for deeper results in the theory of classical mechanics, and for formulations of quantum mechanics.  Geometry of Hamiltonian systems  A Hamiltonian system may be understood as a fiber bundle  E over time  R , with the fibers  E t , t ‚àà R , being the position space. The Lagrangian is thus a function on the jet bundle  J over E ; taking the fiberwise Legendre transform of the Lagrangian produces a function on the dual bundle over time whose fiber at t is the cotangent space  T * E t , which comes equipped with a natural symplectic form , and this latter function is the Hamiltonian.  Generalization to quantum mechanics through Poisson bracket  Hamilton's equations above work well for classical mechanics , but not for quantum mechanics , since the differential equations discussed assume that one can specify the exact position and momentum of the particle simultaneously at any point in time. However, the equations can be further generalized to then be extended to apply to quantum mechanics as well as to classical mechanics, through the deformation of the Poisson algebra over p and q to the algebra of Moyal brackets .  Specifically, the more general form of the Hamilton's equation reads        d  f    d  t    =    {  f  ,  ‚Ñã  }   +    ‚àÇ  f    ‚àÇ  t             normal-d  f     normal-d  t       f  ‚Ñã       f     t       \frac{\mathrm{d}f}{\mathrm{d}t}=\{f,\mathcal{H}\}+\frac{\partial f}{\partial t}     where f is some function of p and q , and H is the Hamiltonian. To find out the rules for evaluating a Poisson bracket without resorting to differential equations, see Lie algebra ; a Poisson bracket is the name for the Lie bracket in a Poisson algebra . These Poisson brackets can then be extended to Moyal brackets comporting to an inequivalent Lie algebra, as proven by H. Groenewold , and thereby describe quantum mechanical diffusion in phase space (See the phase space formulation and the Wigner-Weyl transform ). This more algebraic approach not only permits ultimately extending probability distributions in phase space to Wigner quasi-probability distributions , but, at the mere Poisson bracket classical setting, also provides more power in helping analyze the relevant conserved quantities in a system.  Mathematical formalism  Any smooth real-valued function H on a symplectic manifold can be used to define a Hamiltonian system . The function H is known as the Hamiltonian or the energy function . The symplectic manifold is then called the phase space . The Hamiltonian induces a special vector field on the symplectic manifold, known as the Hamiltonian vector field .  The Hamiltonian vector field (a special type of symplectic vector field ) induces a Hamiltonian flow on the manifold. This is a one-parameter family of transformations of the manifold (the parameter of the curves is commonly called the time ); in other words an isotopy of symplectomorphisms , starting with the identity. By Liouville's theorem , each symplectomorphism preserves the volume form on the phase space . The collection of symplectomorphisms induced by the Hamiltonian flow is commonly called the Hamiltonian mechanics of the Hamiltonian system.  The symplectic structure induces a Poisson bracket . The Poisson bracket gives the space of functions on the manifold the structure of a Lie algebra .  Given a function f         d   d  t    f   =     ‚àÇ   ‚àÇ  t    f   +   {  f  ,   ‚Ñã   }     .          normal-d    normal-d  t    f            t    f    f  ‚Ñã      \frac{\mathrm{d}}{\mathrm{d}t}f=\frac{\partial}{\partial t}f+\{\,f,\mathcal{H}%
 \,\}.     If we have a probability distribution , œÅ, then (since the phase space velocity (      p  Àô   i   ,    q  Àô   i       subscript   normal-Àô  p   i    subscript   normal-Àô  q   i     {\dot{p}_{i}},{\dot{q}_{i}}   ) has zero divergence, and probability is conserved) its convective derivative can be shown to be zero and so         ‚àÇ   ‚àÇ  t    œÅ   =   -   {  œÅ  ,   ‚Ñã   }     .             t    œÅ      œÅ  ‚Ñã      \frac{\partial}{\partial t}\rho=-\{\,\rho,\mathcal{H}\,\}.     This is called Liouville's theorem . Every smooth function  G over the symplectic manifold generates a one-parameter family of symplectomorphisms and if { G , H } = 0, then G is conserved and the symplectomorphisms are symmetry transformations .  A Hamiltonian may have multiple conserved quantities G i . If the symplectic manifold has dimension 2 n and there are n functionally independent conserved quantities G i which are in involution (i.e., { G i , G j } = 0), then the Hamiltonian is Liouville integrable . The Liouville-Arnold theorem says that locally, any Liouville integrable Hamiltonian can be transformed via a symplectomorphism in a new Hamiltonian with the conserved quantities G i as coordinates; the new coordinates are called action-angle coordinates . The transformed Hamiltonian depends only on the G i , and hence the equations of motion have the simple form          G  Àô   i   =  0   ,     œÜ  Àô   i   =   F   (  G  )      ,     formulae-sequence     subscript   normal-Àô  G   i   0      subscript   normal-Àô  œÜ   i     F  G      \dot{G}_{i}=0,\qquad\dot{\varphi}_{i}=F(G),   for some function F (Arnol'd et al., 1988). There is an entire field focusing on small deviations from integrable systems governed by the KAM theorem .  The integrability of Hamiltonian vector fields is an open question. In general, Hamiltonian systems are chaotic ; concepts of measure, completeness, integrability and stability are poorly defined. At this time, the study of dynamical systems is primarily qualitative, and not a quantitative science.  Riemannian manifolds  An important special case consists of those Hamiltonians that are quadratic forms , that is, Hamiltonians that can be written as       ‚Ñã   (  q  ,  p  )    =    1  2     ‚ü®  p  ,  p  ‚ü©   q          ‚Ñã   q  p        1  2    subscript   p  p   q      \mathcal{H}(q,p)=\frac{1}{2}\langle p,p\rangle_{q}     where     ‚ü®  ‚ãÖ  ,  ‚ãÖ  ‚ü©   q     subscript   normal-‚ãÖ  normal-‚ãÖ   q    \langle\cdot,\cdot\rangle_{q}   is a smoothly varying inner product on the fibers      T  q  *   Q       superscript   subscript  T  q     Q    T_{q}^{*}Q   , the cotangent space to the point q in the configuration space , sometimes called a cometric. This Hamiltonian consists entirely of the kinetic term .  If one considers a Riemannian manifold or a pseudo-Riemannian manifold , the Riemannian metric induces a linear isomorphism between the tangent and cotangent bundles. (See Musical isomorphism ). Using this isomorphism, one can define a cometric. (In coordinates, the matrix defining the cometric is the inverse of the matrix defining the metric.) The solutions to the Hamilton‚ÄìJacobi equations for this Hamiltonian are then the same as the geodesics on the manifold. In particular, the Hamiltonian flow in this case is the same thing as the geodesic flow . The existence of such solutions, and the completeness of the set of solutions, are discussed in detail in the article on geodesics . See also Geodesics as Hamiltonian flows .  Sub-Riemannian manifolds  When the cometric is degenerate, then it is not invertible. In this case, one does not have a Riemannian manifold, as one does not have a metric. However, the Hamiltonian still exists. In the case where the cometric is degenerate at every point q of the configuration space manifold Q , so that the rank of the cometric is less than the dimension of the manifold Q , one has a sub-Riemannian manifold .  The Hamiltonian in this case is known as a sub-Riemannian Hamiltonian . Every such Hamiltonian uniquely determines the cometric, and vice versa. This implies that every sub-Riemannian manifold is uniquely determined by its sub-Riemannian Hamiltonian, and that the converse is true: every sub-Riemannian manifold has a unique sub-Riemannian Hamiltonian. The existence of sub-Riemannian geodesics is given by the Chow‚ÄìRashevskii theorem .  The continuous, real-valued Heisenberg group provides a simple example of a sub-Riemannian manifold. For the Heisenberg group, the Hamiltonian is given by        ‚Ñã   (  x  ,  y  ,  z  ,   p  x   ,   p  y   ,   p  z   )    =    1  2    (    p  x  2   +   p  y  2    )     .        ‚Ñã   x  y  z   subscript  p  x    subscript  p  y    subscript  p  z         1  2      superscript   subscript  p  x   2    superscript   subscript  p  y   2       \mathcal{H}(x,y,z,p_{x},p_{y},p_{z})=\frac{1}{2}\left(p_{x}^{2}+p_{y}^{2}%
 \right).       p  z     subscript  p  z    p_{z}   is not involved in the Hamiltonian.  Poisson algebras  Hamiltonian systems can be generalized in various ways. Instead of simply looking at the algebra of smooth functions over a symplectic manifold , Hamiltonian mechanics can be formulated on general commutative  unital  real  Poisson algebras . A state is a continuous  linear functional on the Poisson algebra (equipped with some suitable topology ) such that for any element A of the algebra, A ¬≤ maps to a nonnegative real number.  A further generalization is given by Nambu dynamics .  Charged particle in an electromagnetic field  A good illustration of Hamiltonian mechanics is given by the Hamiltonian of a charged particle in an electromagnetic field . In Cartesian coordinates (i.e.     q  i   =   x  i        subscript  q  i    subscript  x  i     q_{i}=x_{i}   ), the Lagrangian of a non-relativistic classical particle in an electromagnetic field is (in SI Units ):       ‚Ñí  =      ‚àë  i      1  2    m    x  Àô   i  2     +    ‚àë  i    e    x  Àô   i    A  i      -   e  œï     ,      ‚Ñí        subscript   i       1  2   m   superscript   subscript   normal-Àô  x   i   2       subscript   i     e   subscript   normal-Àô  x   i    subscript  A  i        e  œï      \mathcal{L}=\sum_{i}\tfrac{1}{2}m\dot{x}_{i}^{2}+\sum_{i}e\dot{x}_{i}A_{i}-e\phi,     where e is the electric charge of the particle (not necessarily the elementary charge ),   œï   œï   \phi   is the electric scalar potential , and the    A  i     subscript  A  i    A_{i}   are the components of the magnetic vector potential (these may be modified through a gauge transformation ). This is called minimal coupling .  The generalized momenta are given by:        p  i   =    ‚àÇ  ‚Ñí    ‚àÇ    x  Àô   i     =    m    x  Àô   i    +   e   A  i      .         subscript  p  i       ‚Ñí      subscript   normal-Àô  x   i              m   subscript   normal-Àô  x   i      e   subscript  A  i        p_{i}=\frac{\partial\mathcal{L}}{\partial\dot{x}_{i}}=m\dot{x}_{i}+eA_{i}.     Rearranging, the velocities are expressed in terms of the momenta:         x  Àô   i   =     p  i   -   e   A  i     m    .       subscript   normal-Àô  x   i        subscript  p  i     e   subscript  A  i     m     \dot{x}_{i}=\frac{p_{i}-eA_{i}}{m}.     If we substitute the definition of the momenta, and the definitions of the velocities in terms of the momenta, into the definition of the Hamiltonian given above, and then simplify and rearrange, we get:       ‚Ñã  =    {    ‚àë  i      x  Àô   i    p  i     }   -  ‚Ñí   =     ‚àë  i      (    p  i   -   e   A  i     )   2    2  m     +   e  œï     .        ‚Ñã       subscript   i      subscript   normal-Àô  x   i    subscript  p  i      ‚Ñí            subscript   i      superscript     subscript  p  i     e   subscript  A  i     2     2  m       e  œï       \mathcal{H}=\left\{\sum_{i}\dot{x}_{i}p_{i}\right\}-\mathcal{L}=\sum_{i}\frac{%
 (p_{i}-eA_{i})^{2}}{2m}+e\phi.     This equation is used frequently in quantum mechanics .  Relativistic charged particle in an electromagnetic field  The Lagrangian for a relativistic charged particle is given by:        ‚Ñí   (  t  )    =     -   m   c  2     1  -      x  ‚Üí   Àô     (  t  )   2     c  2        -   e  œï   (    x  ‚Üí    (  t  )    ,  t  )     +     e    x  ‚Üí   Àô    (  t  )    ‚ãÖ   A  ‚Üí     (    x  ‚Üí    (  t  )    ,  t  )      .        ‚Ñí  t           m   superscript  c  2       1       normal-Àô   normal-‚Üí  x     superscript  t  2     superscript  c  2          e  œï      normal-‚Üí  x   t   t        normal-‚ãÖ    e   normal-Àô   normal-‚Üí  x    t    normal-‚Üí  A        normal-‚Üí  x   t   t       \mathcal{L}(t)=-mc^{2}\sqrt{1-\frac{{\dot{\vec{x}}(t)}^{2}}{c^{2}}}-e\phi(\vec%
 {x}(t),t)+e\dot{\vec{x}}(t)\cdot\vec{A}(\vec{x}(t),t)\,.     Thus the particle's canonical (total) momentum is          P  ‚Üí     (  t  )    =     ‚àÇ  ‚Ñí    (  t  )      ‚àÇ    x  ‚Üí   Àô     (  t  )     =     m    x  ‚Üí   Àô    (  t  )      1  -      x  ‚Üí   Àô     (  t  )   2     c  2       +   e   A  ‚Üí    (    x  ‚Üí    (  t  )    ,  t  )      ,           normal-‚Üí  P   t         ‚Ñí   t        normal-Àô   normal-‚Üí  x     t               m   normal-Àô   normal-‚Üí  x    t       1       normal-Àô   normal-‚Üí  x     superscript  t  2     superscript  c  2         e   normal-‚Üí  A       normal-‚Üí  x   t   t        \vec{P}\,(t)=\frac{\partial\mathcal{L}(t)}{\partial\dot{\vec{x}}(t)}=\frac{m%
 \dot{\vec{x}}(t)}{\sqrt{1-\frac{{\dot{\vec{x}}(t)}^{2}}{c^{2}}}}+e\vec{A}(\vec%
 {x}(t),t)\,,   that is, the sum of the kinetic momentum and the potential momentum.  Solving for the velocity, we get          x  ‚Üí   Àô    (  t  )    =        P  ‚Üí     (  t  )    -   e   A  ‚Üí    (    x  ‚Üí    (  t  )    ,  t  )        m  2   +    1   c  2      (      P  ‚Üí     (  t  )    -   e   A  ‚Üí    (    x  ‚Üí    (  t  )    ,  t  )     )   2         .         normal-Àô   normal-‚Üí  x    t          normal-‚Üí  P   t     e   normal-‚Üí  A       normal-‚Üí  x   t   t          superscript  m  2       1   superscript  c  2     superscript       normal-‚Üí  P   t     e   normal-‚Üí  A       normal-‚Üí  x   t   t     2         \dot{\vec{x}}(t)=\frac{\vec{P}\,(t)-e\vec{A}(\vec{x}(t),t)}{\sqrt{m^{2}+\frac{%
 1}{c^{2}}{\left(\vec{P}\,(t)-e\vec{A}(\vec{x}(t),t)\right)}^{2}}}\,.     So the Hamiltonian is        ‚Ñã   (  t  )    =        x  ‚Üí   Àô    (  t  )    ‚ãÖ    P  ‚Üí      (  t  )    -   ‚Ñí   (  t  )     =    c      m  2    c  2    +    (      P  ‚Üí     (  t  )    -   e   A  ‚Üí    (    x  ‚Üí    (  t  )    ,  t  )     )   2      +   e  œï   (    x  ‚Üí    (  t  )    ,  t  )      .          ‚Ñã  t        normal-‚ãÖ     normal-Àô   normal-‚Üí  x    t    normal-‚Üí  P    t     ‚Ñí  t             c         superscript  m  2    superscript  c  2     superscript       normal-‚Üí  P   t     e   normal-‚Üí  A       normal-‚Üí  x   t   t     2        e  œï      normal-‚Üí  x   t   t        \mathcal{H}(t)=\dot{\vec{x}}(t)\cdot\vec{P}\,(t)-\mathcal{L}(t)=c\sqrt{m^{2}c^%
 {2}+{\left(\vec{P}\,(t)-e\vec{A}(\vec{x}(t),t)\right)}^{2}}+e\phi(\vec{x}(t),t%
 )\,.     From this we get the force equation (equivalent to the Euler‚ÄìLagrange equation )        P  ‚Üí   Àô   =   -    ‚àÇ  ‚Ñã    ‚àÇ   x  ‚Üí      =     e   (    ‚àá  ‚Üí    A  ‚Üí    )    ‚ãÖ    x  ‚Üí   Àô    -   e   ‚àá  ‚Üí    œï            normal-Àô   normal-‚Üí  P          ‚Ñã      normal-‚Üí  x              normal-‚ãÖ    e     normal-‚Üí  normal-‚àá    normal-‚Üí  A      normal-Àô   normal-‚Üí  x       e   normal-‚Üí  normal-‚àá   œï       \dot{\vec{P}}=-\frac{\partial\mathcal{H}}{\partial\vec{x}}=e(\vec{\nabla}\vec{%
 A})\cdot\dot{\vec{x}}-e\vec{\nabla}\phi\,     from which one can derive         d   d  t     (    m    x  ‚Üí   Àô      1  -      x  ‚Üí   Àô   2    c  2       )    =    e   E  ‚Üí    +    e    x  ‚Üí   Àô    √ó    B  ‚Üí       .          d    d  t        m   normal-Àô   normal-‚Üí  x         1     superscript   normal-Àô   normal-‚Üí  x    2    superscript  c  2            e   normal-‚Üí  E        e   normal-Àô   normal-‚Üí  x      normal-‚Üí  B       \frac{d}{dt}\left(\frac{m\dot{\vec{x}}}{\sqrt{1-\frac{\dot{\vec{x}}^{2}}{c^{2}%
 }}}\right)=e\vec{E}+e\dot{\vec{x}}\times\vec{B}\,.     An equivalent expression for the Hamiltonian as function of the relativistic (kinetic) momentum,      p  ‚Üí   =   Œ≥  m    x  ‚Üí   Àô    (  t  )     ,       normal-‚Üí  p     Œ≥  m   normal-Àô   normal-‚Üí  x    t     \vec{p}=\gamma m\dot{\vec{x}}(t)\,,   is        ‚Ñã   (  t  )    =        x  ‚Üí   Àô    (  t  )    ‚ãÖ    p  ‚Üí      (  t  )    +    m   c  2    Œ≥   +   e  œï   (    x  ‚Üí    (  t  )    ,  t  )     =    Œ≥  m   c  2    +   e  œï   (    x  ‚Üí    (  t  )    ,  t  )     =   E  +   V     .          ‚Ñã  t        normal-‚ãÖ     normal-Àô   normal-‚Üí  x    t    normal-‚Üí  p    t       m   superscript  c  2    Œ≥     e  œï      normal-‚Üí  x   t   t              Œ≥  m   superscript  c  2      e  œï      normal-‚Üí  x   t   t            E  V      \mathcal{H}(t)=\dot{\vec{x}}(t)\cdot\vec{p}\,(t)+\frac{mc^{2}}{\gamma}+e\phi(%
 \vec{x}(t),t)=\gamma mc^{2}+e\phi(\vec{x}(t),t)=E+V\,.     This has the advantage that    p  ‚Üí     normal-‚Üí  p    \vec{p}   can be measured experimentally whereas    P  ‚Üí     normal-‚Üí  P    \vec{P}   cannot. Notice that the Hamiltonian ( total energy ) can be viewed as the sum of the relativistic energy (kinetic+rest) ,     E  =   Œ≥  m    c  2      ,      E    Œ≥  m   superscript  c  2      E=\gamma mc^{2}\,,   plus the potential energy ,     V  =   e   œï     .      V    e  œï     V=e\phi\,.     See also   Canonical transformation  Classical field theory  Hamiltonian field theory  Covariant Hamiltonian field theory  Classical mechanics  Dynamical systems theory  Hamilton‚ÄìJacobi equation  Hamilton‚ÄìJacobi‚ÄìEinstein equation  Lagrangian mechanics  Maxwell's equations  Hamiltonian (quantum mechanics)  Quantum Hamilton's equations  Quantum field theory  Hamiltonian optics  De Donder‚ÄìWeyl theory  Geometric mechanics  Routhian mechanics   References  Footnotes  Sources        External links       "  Category:Concepts in physics  Category:Classical mechanics    Category:Dynamical systems  Category:Symplectic geometry     Analytical Mechanics, L.N. Hand, J.D. Finch, Cambridge University Press, 2008, ISBN 978-0-521-57572-0 ‚Ü©   ‚Ü©  This derivation is along the lines as given in ‚Ü©  ‚Ü©     
<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="1048">Hamiltonian optics</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Hamiltonian optics</h1>
<hr/>

<p><strong>Lagrangian optics</strong><a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a> and <strong>Hamiltonian optics</strong><a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a> are two formulations of <a href="geometrical_optics" title="wikilink">geometrical optics</a> which share much of the mathematical formalism with <a href="Lagrangian_mechanics" title="wikilink">Lagrangian mechanics</a> and <a href="Hamiltonian_mechanics" title="wikilink">Hamiltonian mechanics</a>.</p>
<h2 id="hamiltons-principle">Hamilton's principle</h2>

<p>In <a class="uri" href="physics" title="wikilink">physics</a>, Hamilton's principle states that the evolution of a system 

<math display="inline" id="Hamiltonian_optics:0">
 <semantics>
  <mrow>
   <mo>(</mo>
   <mrow>
    <msub>
     <mi>q</mi>
     <mn>1</mn>
    </msub>
    <mrow>
     <mo>(</mo>
     <mi>σ</mi>
     <mo>)</mo>
    </mrow>
   </mrow>
   <mo>,</mo>
   <mi mathvariant="normal">⋯</mi>
   <mo>,</mo>
   <mrow>
    <msub>
     <mi>q</mi>
     <mi>N</mi>
    </msub>
    <mrow>
     <mo>(</mo>
     <mi>σ</mi>
     <mo>)</mo>
    </mrow>
   </mrow>
   <mo>)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <vector>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>q</ci>
      <cn type="integer">1</cn>
     </apply>
     <ci>σ</ci>
    </apply>
    <ci>normal-⋯</ci>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>q</ci>
      <ci>N</ci>
     </apply>
     <ci>σ</ci>
    </apply>
   </vector>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \left(q_{1}\left(\sigma\right),\cdots,q_{N}\left(\sigma\right)\right)
  </annotation>
 </semantics>
</math>

 described by 

<math display="inline" id="Hamiltonian_optics:1">
 <semantics>
  <mi>N</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>N</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   N
  </annotation>
 </semantics>
</math>

 <a href="generalized_coordinates" title="wikilink">generalized coordinates</a> between two specified states at two specified parameters <em>σ</em><sub><em>A</em></sub> and <em>σ</em><sub><em>B</em></sub> is a <a href="stationary_point" title="wikilink">stationary point</a> (a point where the <a href="Calculus_of_variations" title="wikilink">variation</a> is zero), of the <a href="action_(physics)" title="wikilink">action</a> <a href="functional_(mathematics)" title="wikilink">functional</a>, or</p>

<p>

<math display="block" id="Hamiltonian_optics:2">
 <semantics>
  <mrow>
   <mrow>
    <mi>δ</mi>
    <mi>S</mi>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mi>δ</mi>
    <mrow>
     <msubsup>
      <mo largeop="true" symmetric="true">∫</mo>
      <msub>
       <mi>σ</mi>
       <mi>A</mi>
      </msub>
      <msub>
       <mi>σ</mi>
       <mi>B</mi>
      </msub>
     </msubsup>
     <mrow>
      <mi>L</mi>
      <mrow>
       <mo>(</mo>
       <msub>
        <mi>q</mi>
        <mn>1</mn>
       </msub>
       <mo>,</mo>
       <mi mathvariant="normal">⋯</mi>
       <mo>,</mo>
       <msub>
        <mi>q</mi>
        <mi>N</mi>
       </msub>
       <mo>,</mo>
       <msub>
        <mover accent="true">
         <mi>q</mi>
         <mo>˙</mo>
        </mover>
        <mn>1</mn>
       </msub>
       <mo>,</mo>
       <mi mathvariant="normal">⋯</mi>
       <mo>,</mo>
       <msub>
        <mover accent="true">
         <mi>q</mi>
         <mo>˙</mo>
        </mover>
        <mi>N</mi>
       </msub>
       <mo>,</mo>
       <mi>σ</mi>
       <mo rspace="4.2pt">)</mo>
      </mrow>
      <mi>d</mi>
      <mi>σ</mi>
     </mrow>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <times></times>
      <ci>δ</ci>
      <ci>S</ci>
     </apply>
     <apply>
      <times></times>
      <ci>δ</ci>
      <apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <int></int>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>σ</ci>
          <ci>A</ci>
         </apply>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>σ</ci>
         <ci>B</ci>
        </apply>
       </apply>
       <apply>
        <times></times>
        <ci>L</ci>
        <vector>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>q</ci>
          <cn type="integer">1</cn>
         </apply>
         <ci>normal-⋯</ci>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>q</ci>
          <ci>N</ci>
         </apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <apply>
           <ci>normal-˙</ci>
           <ci>q</ci>
          </apply>
          <cn type="integer">1</cn>
         </apply>
         <ci>normal-⋯</ci>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <apply>
           <ci>normal-˙</ci>
           <ci>q</ci>
          </apply>
          <ci>N</ci>
         </apply>
         <ci>σ</ci>
        </vector>
        <ci>d</ci>
        <ci>σ</ci>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <cn type="integer">0</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \delta S=\delta\int_{\sigma_{A}}^{\sigma_{B}}L\left(q_{1},\cdots,q_{N},\dot{q}%
_{1},\cdots,\dot{q}_{N},\sigma\right)\,d\sigma=0
  </annotation>
 </semantics>
</math>

</p>

<p>where 

<math display="inline" id="Hamiltonian_optics:3">
 <semantics>
  <mrow>
   <msub>
    <mover accent="true">
     <mi>q</mi>
     <mo>˙</mo>
    </mover>
    <mi>k</mi>
   </msub>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mrow>
      <mi>d</mi>
      <msub>
       <mi>q</mi>
       <mi>k</mi>
      </msub>
     </mrow>
     <mo>/</mo>
     <mi>d</mi>
    </mrow>
    <mi>σ</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <ci>normal-˙</ci>
      <ci>q</ci>
     </apply>
     <ci>k</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <divide></divide>
      <apply>
       <times></times>
       <ci>d</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>q</ci>
        <ci>k</ci>
       </apply>
      </apply>
      <ci>d</ci>
     </apply>
     <ci>σ</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \dot{q}_{k}=dq_{k}/d\sigma
  </annotation>
 </semantics>
</math>

. Condition 

<math display="inline" id="Hamiltonian_optics:4">
 <semantics>
  <mrow>
   <mrow>
    <mi>δ</mi>
    <mi>S</mi>
   </mrow>
   <mo>=</mo>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>δ</ci>
     <ci>S</ci>
    </apply>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \delta S=0
  </annotation>
 </semantics>
</math>

 is valid if and only if the Euler-Lagrange equations are satisfied</p>

<p>

<math display="block" id="Hamiltonian_optics:5">
 <semantics>
  <mrow>
   <mrow>
    <mfrac>
     <mrow>
      <mo>∂</mo>
      <mi>L</mi>
     </mrow>
     <mrow>
      <mo>∂</mo>
      <msub>
       <mi>q</mi>
       <mi>k</mi>
      </msub>
     </mrow>
    </mfrac>
    <mo>-</mo>
    <mrow>
     <mfrac>
      <mi>d</mi>
      <mrow>
       <mi>d</mi>
       <mi>σ</mi>
      </mrow>
     </mfrac>
     <mfrac>
      <mrow>
       <mo>∂</mo>
       <mi>L</mi>
      </mrow>
      <mrow>
       <mo>∂</mo>
       <msub>
        <mover accent="true">
         <mi>q</mi>
         <mo>˙</mo>
        </mover>
        <mi>k</mi>
       </msub>
      </mrow>
     </mfrac>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <minus></minus>
     <apply>
      <divide></divide>
      <apply>
       <partialdiff></partialdiff>
       <ci>L</ci>
      </apply>
      <apply>
       <partialdiff></partialdiff>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>q</ci>
        <ci>k</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <ci>d</ci>
       <apply>
        <times></times>
        <ci>d</ci>
        <ci>σ</ci>
       </apply>
      </apply>
      <apply>
       <divide></divide>
       <apply>
        <partialdiff></partialdiff>
        <ci>L</ci>
       </apply>
       <apply>
        <partialdiff></partialdiff>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <apply>
          <ci>normal-˙</ci>
          <ci>q</ci>
         </apply>
         <ci>k</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \frac{\partial L}{\partial q_{k}}-\frac{d}{d\sigma}\frac{\partial L}{\partial%
\dot{q}_{k}}=0
  </annotation>
 </semantics>
</math>

</p>

<p>with 

<math display="inline" id="Hamiltonian_optics:6">
 <semantics>
  <mrow>
   <mi>k</mi>
   <mo>=</mo>
   <mrow>
    <mn>1</mn>
    <mo>,</mo>
    <mi mathvariant="normal">⋯</mi>
    <mo>,</mo>
    <mi>N</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>k</ci>
    <list>
     <cn type="integer">1</cn>
     <ci>normal-⋯</ci>
     <ci>N</ci>
    </list>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   k=1,\cdots,N
  </annotation>
 </semantics>
</math>

.</p>

<p>The momentum is defined as</p>

<p>

<math display="block" id="Hamiltonian_optics:7">
 <semantics>
  <mrow>
   <msub>
    <mi>p</mi>
    <mi>k</mi>
   </msub>
   <mo>=</mo>
   <mfrac>
    <mrow>
     <mo>∂</mo>
     <mi>L</mi>
    </mrow>
    <mrow>
     <mo>∂</mo>
     <msub>
      <mover accent="true">
       <mi>q</mi>
       <mo>˙</mo>
      </mover>
      <mi>k</mi>
     </msub>
    </mrow>
   </mfrac>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>p</ci>
     <ci>k</ci>
    </apply>
    <apply>
     <divide></divide>
     <apply>
      <partialdiff></partialdiff>
      <ci>L</ci>
     </apply>
     <apply>
      <partialdiff></partialdiff>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <apply>
        <ci>normal-˙</ci>
        <ci>q</ci>
       </apply>
       <ci>k</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p_{k}=\frac{\partial L}{\partial\dot{q}_{k}}
  </annotation>
 </semantics>
</math>

</p>

<p>and the Euler-Lagrange equations can then be rewritten as</p>

<p>

<math display="block" id="Hamiltonian_optics:8">
 <semantics>
  <mrow>
   <msub>
    <mover accent="true">
     <mi>p</mi>
     <mo>˙</mo>
    </mover>
    <mi>k</mi>
   </msub>
   <mo>=</mo>
   <mfrac>
    <mrow>
     <mo>∂</mo>
     <mi>L</mi>
    </mrow>
    <mrow>
     <mo>∂</mo>
     <msub>
      <mi>q</mi>
      <mi>k</mi>
     </msub>
    </mrow>
   </mfrac>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <ci>normal-˙</ci>
      <ci>p</ci>
     </apply>
     <ci>k</ci>
    </apply>
    <apply>
     <divide></divide>
     <apply>
      <partialdiff></partialdiff>
      <ci>L</ci>
     </apply>
     <apply>
      <partialdiff></partialdiff>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>q</ci>
       <ci>k</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \dot{p}_{k}=\frac{\partial L}{\partial q_{k}}
  </annotation>
 </semantics>
</math>

</p>

<p>where 

<math display="inline" id="Hamiltonian_optics:9">
 <semantics>
  <mrow>
   <msub>
    <mover accent="true">
     <mi>p</mi>
     <mo>˙</mo>
    </mover>
    <mi>k</mi>
   </msub>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mrow>
      <mi>d</mi>
      <msub>
       <mi>p</mi>
       <mi>k</mi>
      </msub>
     </mrow>
     <mo>/</mo>
     <mi>d</mi>
    </mrow>
    <mi>σ</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <ci>normal-˙</ci>
      <ci>p</ci>
     </apply>
     <ci>k</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <divide></divide>
      <apply>
       <times></times>
       <ci>d</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>p</ci>
        <ci>k</ci>
       </apply>
      </apply>
      <ci>d</ci>
     </apply>
     <ci>σ</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \dot{p}_{k}=dp_{k}/d\sigma
  </annotation>
 </semantics>
</math>

.</p>

<p>A different approach to solving this problem consists in defining a Hamiltonian (taking a <a href="Legendre_transformation" title="wikilink">Legendre transform</a> of the <a href="Lagrangian_mechanics" title="wikilink">Lagrangian</a>) as</p>

<p>

<math display="block" id="Hamiltonian_optics:10">
 <semantics>
  <mrow>
   <mi>H</mi>
   <mo>=</mo>
   <mrow>
    <mrow>
     <munder>
      <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
      <mi>k</mi>
     </munder>
     <mrow>
      <msub>
       <mover accent="true">
        <mi>q</mi>
        <mo>˙</mo>
       </mover>
       <mi>k</mi>
      </msub>
      <msub>
       <mi>p</mi>
       <mi>k</mi>
      </msub>
     </mrow>
    </mrow>
    <mo>-</mo>
    <mi>L</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>H</ci>
    <apply>
     <minus></minus>
     <apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <ci>k</ci>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <apply>
         <ci>normal-˙</ci>
         <ci>q</ci>
        </apply>
        <ci>k</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>p</ci>
        <ci>k</ci>
       </apply>
      </apply>
     </apply>
     <ci>L</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   H=\sum_{k}{\dot{q}_{k}}p_{k}-L
  </annotation>
 </semantics>
</math>

</p>

<p>for which a new set of differential equations <a href="Hamiltonian_mechanics#Deriving_Hamilton's_equations" title="wikilink">can be derived</a> by looking at how the <a href="total_differential" title="wikilink">total differential</a> of the <a href="Lagrangian_mechanics" title="wikilink">Lagrangian</a> depends on parameter <em>σ</em>, positions 

<math display="inline" id="Hamiltonian_optics:11">
 <semantics>
  <mpadded width="+1.7pt">
   <msub>
    <mi>q</mi>
    <mi>i</mi>
   </msub>
  </mpadded>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>q</ci>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   q_{i}\,
  </annotation>
 </semantics>
</math>

 and their derivatives 

<math display="inline" id="Hamiltonian_optics:12">
 <semantics>
  <msub>
   <mover accent="true">
    <mi>q</mi>
    <mo>˙</mo>
   </mover>
   <mi>i</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <apply>
     <ci>normal-˙</ci>
     <ci>q</ci>
    </apply>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \dot{q}_{i}
  </annotation>
 </semantics>
</math>

 relative to <em>σ</em>. This derivation is the same as in Hamiltonian mechanics, only with time <em>t</em> now replaced by a general parameter <em>σ</em>. Those differential equations are the Hamilton's equations</p>

<p>

<math display="block" id="Hamiltonian_optics:13">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mfrac>
      <mrow>
       <mo>∂</mo>
       <mi>H</mi>
      </mrow>
      <mrow>
       <mo>∂</mo>
       <msub>
        <mi>q</mi>
        <mi>k</mi>
       </msub>
      </mrow>
     </mfrac>
     <mo>=</mo>
     <mrow>
      <mo>-</mo>
      <mpadded width="+1.7pt">
       <msub>
        <mover accent="true">
         <mi>p</mi>
         <mo>˙</mo>
        </mover>
        <mi>k</mi>
       </msub>
      </mpadded>
     </mrow>
    </mrow>
    <mo rspace="12.5pt">,</mo>
    <mrow>
     <mrow>
      <mfrac>
       <mrow>
        <mo>∂</mo>
        <mi>H</mi>
       </mrow>
       <mrow>
        <mo>∂</mo>
        <msub>
         <mi>p</mi>
         <mi>k</mi>
        </msub>
       </mrow>
      </mfrac>
      <mo>=</mo>
      <mpadded width="+1.7pt">
       <msub>
        <mover accent="true">
         <mi>q</mi>
         <mo>˙</mo>
        </mover>
        <mi>k</mi>
       </msub>
      </mpadded>
     </mrow>
     <mo rspace="12.5pt">,</mo>
     <mrow>
      <mfrac>
       <mrow>
        <mo>∂</mo>
        <mi>H</mi>
       </mrow>
       <mrow>
        <mo>∂</mo>
        <mi>σ</mi>
       </mrow>
      </mfrac>
      <mo>=</mo>
      <mrow>
       <mo>-</mo>
       <mpadded width="+1.7pt">
        <mfrac>
         <mrow>
          <mo>∂</mo>
          <mi>L</mi>
         </mrow>
         <mrow>
          <mo>∂</mo>
          <mi>σ</mi>
         </mrow>
        </mfrac>
       </mpadded>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <eq></eq>
     <apply>
      <divide></divide>
      <apply>
       <partialdiff></partialdiff>
       <ci>H</ci>
      </apply>
      <apply>
       <partialdiff></partialdiff>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>q</ci>
        <ci>k</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <minus></minus>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <apply>
        <ci>normal-˙</ci>
        <ci>p</ci>
       </apply>
       <ci>k</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <csymbol cd="ambiguous">formulae-sequence</csymbol>
     <apply>
      <eq></eq>
      <apply>
       <divide></divide>
       <apply>
        <partialdiff></partialdiff>
        <ci>H</ci>
       </apply>
       <apply>
        <partialdiff></partialdiff>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>p</ci>
         <ci>k</ci>
        </apply>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <apply>
        <ci>normal-˙</ci>
        <ci>q</ci>
       </apply>
       <ci>k</ci>
      </apply>
     </apply>
     <apply>
      <eq></eq>
      <apply>
       <divide></divide>
       <apply>
        <partialdiff></partialdiff>
        <ci>H</ci>
       </apply>
       <apply>
        <partialdiff></partialdiff>
        <ci>σ</ci>
       </apply>
      </apply>
      <apply>
       <minus></minus>
       <apply>
        <divide></divide>
        <apply>
         <partialdiff></partialdiff>
         <ci>L</ci>
        </apply>
        <apply>
         <partialdiff></partialdiff>
         <ci>σ</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \frac{\partial H}{\partial q_{k}}=-\dot{p}_{k}\,,\quad\frac{\partial H}{%
\partial p_{k}}=\dot{q}_{k}\,,\quad\frac{\partial H}{\partial\sigma}=-{%
\partial L\over\partial\sigma}\,.
  </annotation>
 </semantics>
</math>

</p>

<p>with 

<math display="inline" id="Hamiltonian_optics:14">
 <semantics>
  <mrow>
   <mi>k</mi>
   <mo>=</mo>
   <mrow>
    <mn>1</mn>
    <mo>,</mo>
    <mi mathvariant="normal">⋯</mi>
    <mo>,</mo>
    <mi>N</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>k</ci>
    <list>
     <cn type="integer">1</cn>
     <ci>normal-⋯</ci>
     <ci>N</ci>
    </list>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   k=1,\cdots,N
  </annotation>
 </semantics>
</math>

. Hamilton's equations are first-order <a href="differential_equation" title="wikilink">differential equations</a>, while Euler-Lagrange's equations are second-order.</p>
<h2 id="lagrangian-and-hamiltonian-optics">Lagrangian and Hamiltonian optics</h2>

<p>The general results presented above for <a href="#Hamilton's_principle" title="wikilink">Hamilton's principle</a> can be applied to optics.<a class="footnoteRef" href="#fn3" id="fnref3"><sup>3</sup></a><a class="footnoteRef" href="#fn4" id="fnref4"><sup>4</sup></a> In <a href="Three-dimensional_space" title="wikilink">3D</a> <a href="euclidean_space" title="wikilink">euclidean space</a> the <a href="generalized_coordinates" title="wikilink">generalized coordinates</a> are now the coordinates of <a href="euclidean_space" title="wikilink">euclidean space</a>.</p>
<h3 id="fermats-principle">Fermat's principle</h3>

<p>Fermat's principle states that the optical length of the path followed by light between two fixed points, <strong>A</strong> and <strong>B</strong>, is a stationary point. It may be a maximum, a minimum, constant or an <a href="inflection_point" title="wikilink">inflection point</a>. In general, as light travels, it moves in a medium of variable <a href="refractive_index" title="wikilink">refractive index</a> which is a <a href="scalar_field" title="wikilink">scalar field</a> of position in space, that is, 

<math display="inline" id="Hamiltonian_optics:15">
 <semantics>
  <mrow>
   <mi>n</mi>
   <mo>=</mo>
   <mrow>
    <mi>n</mi>
    <mrow>
     <mo>(</mo>
     <msub>
      <mi>x</mi>
      <mn>1</mn>
     </msub>
     <mo>,</mo>
     <msub>
      <mi>x</mi>
      <mn>2</mn>
     </msub>
     <mo>,</mo>
     <msub>
      <mi>x</mi>
      <mn>3</mn>
     </msub>
     <mo>)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>n</ci>
    <apply>
     <times></times>
     <ci>n</ci>
     <vector>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <cn type="integer">1</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <cn type="integer">3</cn>
      </apply>
     </vector>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n=n\left(x_{1},x_{2},x_{3}\right)
  </annotation>
 </semantics>
</math>

 in <a href="Three-dimensional_space" title="wikilink">3D</a> <a href="euclidean_space" title="wikilink">euclidean space</a>. Assuming now that light travels along the <em>x</em><sub>3</sub> axis, the path of a light ray may be parametrized as 

<math display="inline" id="Hamiltonian_optics:16">
 <semantics>
  <mrow>
   <mi>s</mi>
   <mo>=</mo>
   <mrow>
    <mo>(</mo>
    <mrow>
     <msub>
      <mi>x</mi>
      <mn>1</mn>
     </msub>
     <mrow>
      <mo>(</mo>
      <msub>
       <mi>x</mi>
       <mn>3</mn>
      </msub>
      <mo>)</mo>
     </mrow>
    </mrow>
    <mo>,</mo>
    <mrow>
     <msub>
      <mi>x</mi>
      <mn>2</mn>
     </msub>
     <mrow>
      <mo>(</mo>
      <msub>
       <mi>x</mi>
       <mn>3</mn>
      </msub>
      <mo>)</mo>
     </mrow>
    </mrow>
    <mo>,</mo>
    <msub>
     <mi>x</mi>
     <mn>3</mn>
    </msub>
    <mo>)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>s</ci>
    <vector>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <cn type="integer">1</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <cn type="integer">3</cn>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <cn type="integer">3</cn>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <cn type="integer">3</cn>
     </apply>
    </vector>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   s=\left(x_{1}\left(x_{3}\right),x_{2}\left(x_{3}\right),x_{3}\right)
  </annotation>
 </semantics>
</math>

 starting at a point 

<math display="inline" id="Hamiltonian_optics:17">
 <semantics>
  <mrow>
   <mi>𝐀</mi>
   <mo>=</mo>
   <mrow>
    <mo>(</mo>
    <mrow>
     <msub>
      <mi>x</mi>
      <mn>1</mn>
     </msub>
     <mrow>
      <mo>(</mo>
      <msub>
       <mi>x</mi>
       <mrow>
        <mn>3</mn>
        <mi>A</mi>
       </mrow>
      </msub>
      <mo>)</mo>
     </mrow>
    </mrow>
    <mo>,</mo>
    <mrow>
     <msub>
      <mi>x</mi>
      <mn>2</mn>
     </msub>
     <mrow>
      <mo>(</mo>
      <msub>
       <mi>x</mi>
       <mrow>
        <mn>3</mn>
        <mi>A</mi>
       </mrow>
      </msub>
      <mo>)</mo>
     </mrow>
    </mrow>
    <mo>,</mo>
    <msub>
     <mi>x</mi>
     <mrow>
      <mn>3</mn>
      <mi>A</mi>
     </mrow>
    </msub>
    <mo>)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>𝐀</ci>
    <vector>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <cn type="integer">1</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <apply>
        <times></times>
        <cn type="integer">3</cn>
        <ci>A</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <apply>
        <times></times>
        <cn type="integer">3</cn>
        <ci>A</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <apply>
       <times></times>
       <cn type="integer">3</cn>
       <ci>A</ci>
      </apply>
     </apply>
    </vector>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{A}=\left(x_{1}\left(x_{3A}\right),x_{2}\left(x_{3A}\right),x_{3A}\right)
  </annotation>
 </semantics>
</math>

 and ending at a point 

<math display="inline" id="Hamiltonian_optics:18">
 <semantics>
  <mrow>
   <mi>𝐁</mi>
   <mo>=</mo>
   <mrow>
    <mo>(</mo>
    <mrow>
     <msub>
      <mi>x</mi>
      <mn>1</mn>
     </msub>
     <mrow>
      <mo>(</mo>
      <msub>
       <mi>x</mi>
       <mrow>
        <mn>3</mn>
        <mi>B</mi>
       </mrow>
      </msub>
      <mo>)</mo>
     </mrow>
    </mrow>
    <mo>,</mo>
    <mrow>
     <msub>
      <mi>x</mi>
      <mn>2</mn>
     </msub>
     <mrow>
      <mo>(</mo>
      <msub>
       <mi>x</mi>
       <mrow>
        <mn>3</mn>
        <mi>B</mi>
       </mrow>
      </msub>
      <mo>)</mo>
     </mrow>
    </mrow>
    <mo>,</mo>
    <msub>
     <mi>x</mi>
     <mrow>
      <mn>3</mn>
      <mi>B</mi>
     </mrow>
    </msub>
    <mo>)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>𝐁</ci>
    <vector>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <cn type="integer">1</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <apply>
        <times></times>
        <cn type="integer">3</cn>
        <ci>B</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <apply>
        <times></times>
        <cn type="integer">3</cn>
        <ci>B</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <apply>
       <times></times>
       <cn type="integer">3</cn>
       <ci>B</ci>
      </apply>
     </apply>
    </vector>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{B}=\left(x_{1}\left(x_{3B}\right),x_{2}\left(x_{3B}\right),x_{3B}\right)
  </annotation>
 </semantics>
</math>

. In this case, when compared to <a href="#Hamilton's_principle" title="wikilink">Hamilton's principle</a> above, coordinates 

<math display="inline" id="Hamiltonian_optics:19">
 <semantics>
  <msub>
   <mi>x</mi>
   <mn>1</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>x</ci>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x_{1}
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Hamiltonian_optics:20">
 <semantics>
  <msub>
   <mi>x</mi>
   <mn>2</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>x</ci>
    <cn type="integer">2</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x_{2}
  </annotation>
 </semantics>
</math>

 take the role of the generalized coordinates 

<math display="inline" id="Hamiltonian_optics:21">
 <semantics>
  <msub>
   <mi>q</mi>
   <mi>k</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>q</ci>
    <ci>k</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   q_{k}
  </annotation>
 </semantics>
</math>

 while 

<math display="inline" id="Hamiltonian_optics:22">
 <semantics>
  <msub>
   <mi>x</mi>
   <mn>3</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>x</ci>
    <cn type="integer">3</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x_{3}
  </annotation>
 </semantics>
</math>

 takes the role of parameter 

<math display="inline" id="Hamiltonian_optics:23">
 <semantics>
  <mi>σ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>σ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \sigma
  </annotation>
 </semantics>
</math>

, that is, parameter <em>σ</em> =<em>x</em><sub>3</sub> and <em>N</em>=2.</p>

<p>In the context of <a href="calculus_of_variations" title="wikilink">calculus of variations</a> this can be written as<a class="footnoteRef" href="#fn5" id="fnref5"><sup>5</sup></a></p>

<p>

<math display="block" id="Hamiltonian_optics:24">
 <semantics>
  <mrow>
   <mrow>
    <mi>δ</mi>
    <mi>S</mi>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mi>δ</mi>
    <mrow>
     <msubsup>
      <mo largeop="true" symmetric="true">∫</mo>
      <mi>𝐀</mi>
      <mi>𝐁</mi>
     </msubsup>
     <mrow>
      <mpadded width="+1.7pt">
       <mi>n</mi>
      </mpadded>
      <mi>d</mi>
      <mi>s</mi>
     </mrow>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mi>δ</mi>
    <mrow>
     <msubsup>
      <mo largeop="true" symmetric="true">∫</mo>
      <msub>
       <mi>x</mi>
       <mrow>
        <mn>3</mn>
        <mi>A</mi>
       </mrow>
      </msub>
      <msub>
       <mi>x</mi>
       <mrow>
        <mn>3</mn>
        <mi>B</mi>
       </mrow>
      </msub>
     </msubsup>
     <mrow>
      <mi>n</mi>
      <mpadded width="+1.7pt">
       <mfrac>
        <mrow>
         <mi>d</mi>
         <mi>s</mi>
        </mrow>
        <mrow>
         <mi>d</mi>
         <msub>
          <mi>x</mi>
          <mn>3</mn>
         </msub>
        </mrow>
       </mfrac>
      </mpadded>
      <mi>d</mi>
      <msub>
       <mi>x</mi>
       <mn>3</mn>
      </msub>
     </mrow>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mi>δ</mi>
    <mrow>
     <msubsup>
      <mo largeop="true" symmetric="true">∫</mo>
      <msub>
       <mi>x</mi>
       <mrow>
        <mn>3</mn>
        <mi>A</mi>
       </mrow>
      </msub>
      <msub>
       <mi>x</mi>
       <mrow>
        <mn>3</mn>
        <mi>B</mi>
       </mrow>
      </msub>
     </msubsup>
     <mrow>
      <mi>L</mi>
      <mrow>
       <mo>(</mo>
       <msub>
        <mi>x</mi>
        <mn>1</mn>
       </msub>
       <mo>,</mo>
       <msub>
        <mi>x</mi>
        <mn>2</mn>
       </msub>
       <mo>,</mo>
       <msub>
        <mover accent="true">
         <mi>x</mi>
         <mo>˙</mo>
        </mover>
        <mn>1</mn>
       </msub>
       <mo>,</mo>
       <msub>
        <mover accent="true">
         <mi>x</mi>
         <mo>˙</mo>
        </mover>
        <mn>2</mn>
       </msub>
       <mo>,</mo>
       <msub>
        <mi>x</mi>
        <mn>3</mn>
       </msub>
       <mo rspace="4.2pt">)</mo>
      </mrow>
      <mi>d</mi>
      <msub>
       <mi>x</mi>
       <mn>3</mn>
      </msub>
     </mrow>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <times></times>
      <ci>δ</ci>
      <ci>S</ci>
     </apply>
     <apply>
      <times></times>
      <ci>δ</ci>
      <apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <int></int>
         <ci>𝐀</ci>
        </apply>
        <ci>𝐁</ci>
       </apply>
       <apply>
        <times></times>
        <ci>n</ci>
        <ci>d</ci>
        <ci>s</ci>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <ci>δ</ci>
      <apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <int></int>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>x</ci>
          <apply>
           <times></times>
           <cn type="integer">3</cn>
           <ci>A</ci>
          </apply>
         </apply>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>x</ci>
         <apply>
          <times></times>
          <cn type="integer">3</cn>
          <ci>B</ci>
         </apply>
        </apply>
       </apply>
       <apply>
        <times></times>
        <ci>n</ci>
        <apply>
         <divide></divide>
         <apply>
          <times></times>
          <ci>d</ci>
          <ci>s</ci>
         </apply>
         <apply>
          <times></times>
          <ci>d</ci>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>x</ci>
           <cn type="integer">3</cn>
          </apply>
         </apply>
        </apply>
        <ci>d</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>x</ci>
         <cn type="integer">3</cn>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <ci>δ</ci>
      <apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <int></int>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>x</ci>
          <apply>
           <times></times>
           <cn type="integer">3</cn>
           <ci>A</ci>
          </apply>
         </apply>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>x</ci>
         <apply>
          <times></times>
          <cn type="integer">3</cn>
          <ci>B</ci>
         </apply>
        </apply>
       </apply>
       <apply>
        <times></times>
        <ci>L</ci>
        <vector>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>x</ci>
          <cn type="integer">1</cn>
         </apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>x</ci>
          <cn type="integer">2</cn>
         </apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <apply>
           <ci>normal-˙</ci>
           <ci>x</ci>
          </apply>
          <cn type="integer">1</cn>
         </apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <apply>
           <ci>normal-˙</ci>
           <ci>x</ci>
          </apply>
          <cn type="integer">2</cn>
         </apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>x</ci>
          <cn type="integer">3</cn>
         </apply>
        </vector>
        <ci>d</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>x</ci>
         <cn type="integer">3</cn>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <cn type="integer">0</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \delta S=\delta\int_{\mathbf{A}}^{\mathbf{B}}n\,ds=\delta\int_{x_{3A}}^{x_{3B}%
}n\frac{ds}{dx_{3}}\,dx_{3}=\delta\int_{x_{3A}}^{x_{3B}}L\left(x_{1},x_{2},%
\dot{x}_{1},\dot{x}_{2},x_{3}\right)\,dx_{3}=0
  </annotation>
 </semantics>
</math>

</p>

<p>where <em>ds</em> is an infinitesimal displacement along the ray given by 

<math display="inline" id="Hamiltonian_optics:25">
 <semantics>
  <mrow>
   <mrow>
    <mi>d</mi>
    <mi>s</mi>
   </mrow>
   <mo>=</mo>
   <msqrt>
    <mrow>
     <mrow>
      <mi>d</mi>
      <msubsup>
       <mi>x</mi>
       <mn>1</mn>
       <mn>2</mn>
      </msubsup>
     </mrow>
     <mo>+</mo>
     <mrow>
      <mi>d</mi>
      <msubsup>
       <mi>x</mi>
       <mn>2</mn>
       <mn>2</mn>
      </msubsup>
     </mrow>
     <mo>+</mo>
     <mrow>
      <mi>d</mi>
      <msubsup>
       <mi>x</mi>
       <mn>3</mn>
       <mn>2</mn>
      </msubsup>
     </mrow>
    </mrow>
   </msqrt>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>d</ci>
     <ci>s</ci>
    </apply>
    <apply>
     <root></root>
     <apply>
      <plus></plus>
      <apply>
       <times></times>
       <ci>d</ci>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>x</ci>
         <cn type="integer">1</cn>
        </apply>
        <cn type="integer">2</cn>
       </apply>
      </apply>
      <apply>
       <times></times>
       <ci>d</ci>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>x</ci>
         <cn type="integer">2</cn>
        </apply>
        <cn type="integer">2</cn>
       </apply>
      </apply>
      <apply>
       <times></times>
       <ci>d</ci>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>x</ci>
         <cn type="integer">3</cn>
        </apply>
        <cn type="integer">2</cn>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   ds=\sqrt{dx_{1}^{2}+dx_{2}^{2}+dx_{3}^{2}}
  </annotation>
 </semantics>
</math>

 and</p>

<p>

<math display="block" id="Hamiltonian_optics:26">
 <semantics>
  <mrow>
   <mi>L</mi>
   <mo>=</mo>
   <mrow>
    <mi>n</mi>
    <mfrac>
     <mrow>
      <mi>d</mi>
      <mi>s</mi>
     </mrow>
     <mrow>
      <mi>d</mi>
      <msub>
       <mi>x</mi>
       <mn>3</mn>
      </msub>
     </mrow>
    </mfrac>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mi>n</mi>
    <mrow>
     <mo>(</mo>
     <msub>
      <mi>x</mi>
      <mn>1</mn>
     </msub>
     <mo>,</mo>
     <msub>
      <mi>x</mi>
      <mn>2</mn>
     </msub>
     <mo>,</mo>
     <msub>
      <mi>x</mi>
      <mn>3</mn>
     </msub>
     <mo>)</mo>
    </mrow>
    <msqrt>
     <mrow>
      <mn>1</mn>
      <mo>+</mo>
      <msubsup>
       <mover accent="true">
        <mi>x</mi>
        <mo>˙</mo>
       </mover>
       <mn>1</mn>
       <mn>2</mn>
      </msubsup>
      <mo>+</mo>
      <msubsup>
       <mover accent="true">
        <mi>x</mi>
        <mo>˙</mo>
       </mover>
       <mn>2</mn>
       <mn>2</mn>
      </msubsup>
     </mrow>
    </msqrt>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <ci>L</ci>
     <apply>
      <times></times>
      <ci>n</ci>
      <apply>
       <divide></divide>
       <apply>
        <times></times>
        <ci>d</ci>
        <ci>s</ci>
       </apply>
       <apply>
        <times></times>
        <ci>d</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>x</ci>
         <cn type="integer">3</cn>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <ci>n</ci>
      <vector>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <cn type="integer">1</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <cn type="integer">3</cn>
       </apply>
      </vector>
      <apply>
       <root></root>
       <apply>
        <plus></plus>
        <cn type="integer">1</cn>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <apply>
           <ci>normal-˙</ci>
           <ci>x</ci>
          </apply>
          <cn type="integer">1</cn>
         </apply>
         <cn type="integer">2</cn>
        </apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <apply>
           <ci>normal-˙</ci>
           <ci>x</ci>
          </apply>
          <cn type="integer">2</cn>
         </apply>
         <cn type="integer">2</cn>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   L=n\frac{ds}{dx_{3}}=n\left(x_{1},x_{2},x_{3}\right)\sqrt{1+\dot{x}_{1}^{2}+%
\dot{x}_{2}^{2}}
  </annotation>
 </semantics>
</math>

</p>

<p>is the optical Lagrangian and 

<math display="inline" id="Hamiltonian_optics:27">
 <semantics>
  <mrow>
   <msub>
    <mover accent="true">
     <mi>x</mi>
     <mo>˙</mo>
    </mover>
    <mi>k</mi>
   </msub>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mrow>
      <mi>d</mi>
      <msub>
       <mi>x</mi>
       <mi>k</mi>
      </msub>
     </mrow>
     <mo>/</mo>
     <mi>d</mi>
    </mrow>
    <msub>
     <mi>x</mi>
     <mn>3</mn>
    </msub>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <ci>normal-˙</ci>
      <ci>x</ci>
     </apply>
     <ci>k</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <divide></divide>
      <apply>
       <times></times>
       <ci>d</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <ci>k</ci>
       </apply>
      </apply>
      <ci>d</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <cn type="integer">3</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \dot{x}_{k}=dx_{k}/dx_{3}
  </annotation>
 </semantics>
</math>

.</p>

<p>The <a href="optical_path_length" title="wikilink">optical path length</a> (OPL) is defined as</p>

<p>

<math display="block" id="Hamiltonian_optics:28">
 <semantics>
  <mrow>
   <mi>S</mi>
   <mo>=</mo>
   <mrow>
    <msubsup>
     <mo largeop="true" symmetric="true">∫</mo>
     <mi>𝐀</mi>
     <mi>𝐁</mi>
    </msubsup>
    <mrow>
     <mpadded width="+1.7pt">
      <mi>n</mi>
     </mpadded>
     <mi>d</mi>
     <mi>s</mi>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <msubsup>
     <mo largeop="true" symmetric="true">∫</mo>
     <mi>𝐀</mi>
     <mi>𝐁</mi>
    </msubsup>
    <mrow>
     <mpadded width="+1.7pt">
      <mi>L</mi>
     </mpadded>
     <mi>d</mi>
     <msub>
      <mi>x</mi>
      <mn>3</mn>
     </msub>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <ci>S</ci>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <int></int>
        <ci>𝐀</ci>
       </apply>
       <ci>𝐁</ci>
      </apply>
      <apply>
       <times></times>
       <ci>n</ci>
       <ci>d</ci>
       <ci>s</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <int></int>
        <ci>𝐀</ci>
       </apply>
       <ci>𝐁</ci>
      </apply>
      <apply>
       <times></times>
       <ci>L</ci>
       <ci>d</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <cn type="integer">3</cn>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   S=\int_{\mathbf{A}}^{\mathbf{B}}n\,ds=\int_{\mathbf{A}}^{\mathbf{B}}L\,dx_{3}
  </annotation>
 </semantics>
</math>

</p>

<p>where <em>n</em> is the local refractive index as a function of position along the path between points <strong>A</strong> and <strong>B</strong>.</p>
<h3 id="the-euler-lagrange-equations">The Euler-Lagrange equations</h3>

<p>The general results presented above for <a href="#Hamilton's_principle" title="wikilink">Hamilton's principle</a> can be applied to optics using the Lagrangian defined in <a href="#Fermat's_principle" title="wikilink">Fermat's principle</a>. The Euler-Lagrange equations with parameter <em>σ</em> =<em>x</em><sub>3</sub> and <em>N</em>=2 applied to Fermat's principle result in</p>

<p>

<math display="block" id="Hamiltonian_optics:29">
 <semantics>
  <mrow>
   <mrow>
    <mfrac>
     <mrow>
      <mo>∂</mo>
      <mi>L</mi>
     </mrow>
     <mrow>
      <mo>∂</mo>
      <msub>
       <mi>x</mi>
       <mi>k</mi>
      </msub>
     </mrow>
    </mfrac>
    <mo>-</mo>
    <mrow>
     <mfrac>
      <mi>d</mi>
      <mrow>
       <mi>d</mi>
       <msub>
        <mi>x</mi>
        <mn>3</mn>
       </msub>
      </mrow>
     </mfrac>
     <mfrac>
      <mrow>
       <mo>∂</mo>
       <mi>L</mi>
      </mrow>
      <mrow>
       <mo>∂</mo>
       <msub>
        <mover accent="true">
         <mi>x</mi>
         <mo>˙</mo>
        </mover>
        <mi>k</mi>
       </msub>
      </mrow>
     </mfrac>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <minus></minus>
     <apply>
      <divide></divide>
      <apply>
       <partialdiff></partialdiff>
       <ci>L</ci>
      </apply>
      <apply>
       <partialdiff></partialdiff>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <ci>k</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <ci>d</ci>
       <apply>
        <times></times>
        <ci>d</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>x</ci>
         <cn type="integer">3</cn>
        </apply>
       </apply>
      </apply>
      <apply>
       <divide></divide>
       <apply>
        <partialdiff></partialdiff>
        <ci>L</ci>
       </apply>
       <apply>
        <partialdiff></partialdiff>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <apply>
          <ci>normal-˙</ci>
          <ci>x</ci>
         </apply>
         <ci>k</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \frac{\partial L}{\partial x_{k}}-\frac{d}{dx_{3}}\frac{\partial L}{\partial%
\dot{x}_{k}}=0
  </annotation>
 </semantics>
</math>

</p>

<p>with <em>k</em>=1,2 and where <em>L</em> is the optical Lagrangian and 

<math display="inline" id="Hamiltonian_optics:30">
 <semantics>
  <mrow>
   <msub>
    <mover accent="true">
     <mi>x</mi>
     <mo>˙</mo>
    </mover>
    <mi>k</mi>
   </msub>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mrow>
      <mi>d</mi>
      <msub>
       <mi>x</mi>
       <mi>k</mi>
      </msub>
     </mrow>
     <mo>/</mo>
     <mi>d</mi>
    </mrow>
    <msub>
     <mi>x</mi>
     <mn>3</mn>
    </msub>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <ci>normal-˙</ci>
      <ci>x</ci>
     </apply>
     <ci>k</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <divide></divide>
      <apply>
       <times></times>
       <ci>d</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <ci>k</ci>
       </apply>
      </apply>
      <ci>d</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <cn type="integer">3</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \dot{x}_{k}=dx_{k}/dx_{3}
  </annotation>
 </semantics>
</math>


.</p>
<h3 id="optical-momentum">Optical momentum</h3>

<p>The optical momentum is defined as</p>

<p>

<math display="block" id="Hamiltonian_optics:31">
 <semantics>
  <mrow>
   <msub>
    <mi>p</mi>
    <mi>k</mi>
   </msub>
   <mo>=</mo>
   <mfrac>
    <mrow>
     <mo>∂</mo>
     <mi>L</mi>
    </mrow>
    <mrow>
     <mo>∂</mo>
     <msub>
      <mover accent="true">
       <mi>x</mi>
       <mo>˙</mo>
      </mover>
      <mi>k</mi>
     </msub>
    </mrow>
   </mfrac>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>p</ci>
     <ci>k</ci>
    </apply>
    <apply>
     <divide></divide>
     <apply>
      <partialdiff></partialdiff>
      <ci>L</ci>
     </apply>
     <apply>
      <partialdiff></partialdiff>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <apply>
        <ci>normal-˙</ci>
        <ci>x</ci>
       </apply>
       <ci>k</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p_{k}=\frac{\partial L}{\partial\dot{x}_{k}}
  </annotation>
 </semantics>
</math>

</p>

<p>and from the definition of the optical Lagrangian 

<math display="inline" id="Hamiltonian_optics:32">
 <semantics>
  <mrow>
   <mi>L</mi>
   <mo>=</mo>
   <mrow>
    <mi>n</mi>
    <msqrt>
     <mrow>
      <mn>1</mn>
      <mo>+</mo>
      <msubsup>
       <mover accent="true">
        <mi>x</mi>
        <mo>˙</mo>
       </mover>
       <mn>1</mn>
       <mn>2</mn>
      </msubsup>
      <mo>+</mo>
      <msubsup>
       <mover accent="true">
        <mi>x</mi>
        <mo>˙</mo>
       </mover>
       <mn>2</mn>
       <mn>2</mn>
      </msubsup>
     </mrow>
    </msqrt>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>L</ci>
    <apply>
     <times></times>
     <ci>n</ci>
     <apply>
      <root></root>
      <apply>
       <plus></plus>
       <cn type="integer">1</cn>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <apply>
          <ci>normal-˙</ci>
          <ci>x</ci>
         </apply>
         <cn type="integer">1</cn>
        </apply>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <apply>
          <ci>normal-˙</ci>
          <ci>x</ci>
         </apply>
         <cn type="integer">2</cn>
        </apply>
        <cn type="integer">2</cn>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   L=n\sqrt{1+\dot{x}_{1}^{2}+\dot{x}_{2}^{2}}
  </annotation>
 </semantics>
</math>

 this expression can be rewritten as</p>

<p>

<math display="block" id="Hamiltonian_optics:33">
 <semantics>
  <mrow>
   <msub>
    <mi>p</mi>
    <mi>k</mi>
   </msub>
   <mo>=</mo>
   <mrow>
    <mi>n</mi>
    <mfrac>
     <msub>
      <mover accent="true">
       <mi>x</mi>
       <mo>˙</mo>
      </mover>
      <mi>k</mi>
     </msub>
     <msqrt>
      <mrow>
       <msubsup>
        <mover accent="true">
         <mi>x</mi>
         <mo>˙</mo>
        </mover>
        <mn>1</mn>
        <mn>2</mn>
       </msubsup>
       <mo>+</mo>
       <msubsup>
        <mover accent="true">
         <mi>x</mi>
         <mo>˙</mo>
        </mover>
        <mn>2</mn>
        <mn>2</mn>
       </msubsup>
       <mo>+</mo>
       <msubsup>
        <mover accent="true">
         <mi>x</mi>
         <mo>˙</mo>
        </mover>
        <mn>3</mn>
        <mn>2</mn>
       </msubsup>
      </mrow>
     </msqrt>
    </mfrac>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mi>n</mi>
    <mfrac>
     <mrow>
      <mi>d</mi>
      <msub>
       <mi>x</mi>
       <mi>k</mi>
      </msub>
     </mrow>
     <msqrt>
      <mrow>
       <mrow>
        <mi>d</mi>
        <msubsup>
         <mi>x</mi>
         <mn>1</mn>
         <mn>2</mn>
        </msubsup>
       </mrow>
       <mo>+</mo>
       <mrow>
        <mi>d</mi>
        <msubsup>
         <mi>x</mi>
         <mn>2</mn>
         <mn>2</mn>
        </msubsup>
       </mrow>
       <mo>+</mo>
       <mrow>
        <mi>d</mi>
        <msubsup>
         <mi>x</mi>
         <mn>3</mn>
         <mn>2</mn>
        </msubsup>
       </mrow>
      </mrow>
     </msqrt>
    </mfrac>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mi>n</mi>
    <mfrac>
     <mrow>
      <mi>d</mi>
      <msub>
       <mi>x</mi>
       <mi>k</mi>
      </msub>
     </mrow>
     <mrow>
      <mi>d</mi>
      <mi>s</mi>
     </mrow>
    </mfrac>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>p</ci>
      <ci>k</ci>
     </apply>
     <apply>
      <times></times>
      <ci>n</ci>
      <apply>
       <divide></divide>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <apply>
         <ci>normal-˙</ci>
         <ci>x</ci>
        </apply>
        <ci>k</ci>
       </apply>
       <apply>
        <root></root>
        <apply>
         <plus></plus>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <apply>
            <ci>normal-˙</ci>
            <ci>x</ci>
           </apply>
           <cn type="integer">1</cn>
          </apply>
          <cn type="integer">2</cn>
         </apply>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <apply>
            <ci>normal-˙</ci>
            <ci>x</ci>
           </apply>
           <cn type="integer">2</cn>
          </apply>
          <cn type="integer">2</cn>
         </apply>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <apply>
            <ci>normal-˙</ci>
            <ci>x</ci>
           </apply>
           <cn type="integer">3</cn>
          </apply>
          <cn type="integer">2</cn>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <ci>n</ci>
      <apply>
       <divide></divide>
       <apply>
        <times></times>
        <ci>d</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>x</ci>
         <ci>k</ci>
        </apply>
       </apply>
       <apply>
        <root></root>
        <apply>
         <plus></plus>
         <apply>
          <times></times>
          <ci>d</ci>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <ci>x</ci>
            <cn type="integer">1</cn>
           </apply>
           <cn type="integer">2</cn>
          </apply>
         </apply>
         <apply>
          <times></times>
          <ci>d</ci>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <ci>x</ci>
            <cn type="integer">2</cn>
           </apply>
           <cn type="integer">2</cn>
          </apply>
         </apply>
         <apply>
          <times></times>
          <ci>d</ci>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <ci>x</ci>
            <cn type="integer">3</cn>
           </apply>
           <cn type="integer">2</cn>
          </apply>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <ci>n</ci>
      <apply>
       <divide></divide>
       <apply>
        <times></times>
        <ci>d</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>x</ci>
         <ci>k</ci>
        </apply>
       </apply>
       <apply>
        <times></times>
        <ci>d</ci>
        <ci>s</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p_{k}=n\frac{\dot{x}_{k}}{\sqrt{\dot{x}_{1}^{2}+\dot{x}_{2}^{2}+\dot{x}_{3}^{2%
}}}=n\frac{dx_{k}}{\sqrt{dx_{1}^{2}+dx_{2}^{2}+dx_{3}^{2}}}=n\frac{dx_{k}}{ds}
  </annotation>
 </semantics>
</math>

</p>
<figure><b>(Figure)</b>
<figcaption>Optical momentum</figcaption>
</figure>

<p>or in vector form</p>

<p>

<math display="block" id="Hamiltonian_optics:34">
 <semantics>
  <mrow>
   <mi>𝐩</mi>
   <mo>=</mo>
   <mrow>
    <mi>n</mi>
    <mfrac>
     <mi>𝐝𝐬</mi>
     <mrow>
      <mi>d</mi>
      <mi>s</mi>
     </mrow>
    </mfrac>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mo>(</mo>
    <msub>
     <mi>p</mi>
     <mn>1</mn>
    </msub>
    <mo>,</mo>
    <msub>
     <mi>p</mi>
     <mn>2</mn>
    </msub>
    <mo>,</mo>
    <msub>
     <mi>p</mi>
     <mn>3</mn>
    </msub>
    <mo>)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <ci>𝐩</ci>
     <apply>
      <times></times>
      <ci>n</ci>
      <apply>
       <divide></divide>
       <ci>𝐝𝐬</ci>
       <apply>
        <times></times>
        <ci>d</ci>
        <ci>s</ci>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <vector>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>p</ci>
       <cn type="integer">1</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>p</ci>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>p</ci>
       <cn type="integer">3</cn>
      </apply>
     </vector>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{p}=n\frac{\mathbf{ds}}{ds}=\left(p_{1},p_{2},p_{3}\right)
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Hamiltonian_optics:35">
 <semantics>
  <mrow>
   <mi></mi>
   <mo>=</mo>
   <mrow>
    <mo>(</mo>
    <mrow>
     <mi>n</mi>
     <mrow>
      <mi>cos</mi>
      <msub>
       <mi>α</mi>
       <mn>1</mn>
      </msub>
     </mrow>
    </mrow>
    <mo>,</mo>
    <mrow>
     <mi>n</mi>
     <mrow>
      <mi>cos</mi>
      <msub>
       <mi>α</mi>
       <mn>2</mn>
      </msub>
     </mrow>
    </mrow>
    <mo>,</mo>
    <mrow>
     <mi>n</mi>
     <mrow>
      <mi>cos</mi>
      <msub>
       <mi>α</mi>
       <mn>3</mn>
      </msub>
     </mrow>
    </mrow>
    <mo>)</mo>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mi>n</mi>
    <mover accent="true">
     <mi>𝐞</mi>
     <mo stretchy="false">^</mo>
    </mover>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <csymbol cd="latexml">absent</csymbol>
     <vector>
      <apply>
       <times></times>
       <ci>n</ci>
       <apply>
        <cos></cos>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>α</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
      </apply>
      <apply>
       <times></times>
       <ci>n</ci>
       <apply>
        <cos></cos>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>α</ci>
         <cn type="integer">2</cn>
        </apply>
       </apply>
      </apply>
      <apply>
       <times></times>
       <ci>n</ci>
       <apply>
        <cos></cos>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>α</ci>
         <cn type="integer">3</cn>
        </apply>
       </apply>
      </apply>
     </vector>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <ci>n</ci>
      <apply>
       <ci>normal-^</ci>
       <ci>𝐞</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   =\left(n\cos\alpha_{1},n\cos\alpha_{2},n\cos\alpha_{3}\right)=n\mathbf{\hat{e}}
  </annotation>
 </semantics>
</math>

</p>

<p>where 

<math display="inline" id="Hamiltonian_optics:36">
 <semantics>
  <mover accent="true">
   <mi>𝐞</mi>
   <mo stretchy="false">^</mo>
  </mover>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-^</ci>
    <ci>𝐞</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{\hat{e}}
  </annotation>
 </semantics>
</math>

 is a <a href="unit_vector" title="wikilink">unit vector</a> and angles <em>α</em><sub>1</sub>, <em>α</em><sub>2</sub> and <em>α</em><sub>3</sub> are the angles <strong>p</strong> makes to axis <em>x</em><sub>1</sub>, <em>x</em><sub>2</sub> and <em>x</em><sub>3</sub> respectively, as shown in figure "optical momentum". Therefore the optical momentum is a vector of <a href="Norm_(mathematics)#Euclidean_norm" title="wikilink">norm</a></p>

<p>

<math display="block" id="Hamiltonian_optics:37">
 <semantics>
  <mrow>
   <mrow>
    <mo>∥</mo>
    <mi>𝐩</mi>
    <mo>∥</mo>
   </mrow>
   <mo>=</mo>
   <msqrt>
    <mrow>
     <msubsup>
      <mi>p</mi>
      <mn>1</mn>
      <mn>2</mn>
     </msubsup>
     <mo>+</mo>
     <msubsup>
      <mi>p</mi>
      <mn>2</mn>
      <mn>2</mn>
     </msubsup>
     <mo>+</mo>
     <msubsup>
      <mi>p</mi>
      <mn>3</mn>
      <mn>2</mn>
     </msubsup>
    </mrow>
   </msqrt>
   <mo>=</mo>
   <mi>n</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="latexml">norm</csymbol>
      <ci>𝐩</ci>
     </apply>
     <apply>
      <root></root>
      <apply>
       <plus></plus>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>p</ci>
         <cn type="integer">1</cn>
        </apply>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>p</ci>
         <cn type="integer">2</cn>
        </apply>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>p</ci>
         <cn type="integer">3</cn>
        </apply>
        <cn type="integer">2</cn>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <ci>n</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \|\mathbf{p}\|=\sqrt{p_{1}^{2}+p_{2}^{2}+p_{3}^{2}}=n
  </annotation>
 </semantics>
</math>

</p>

<p>where <em>n</em> is the refractive index at which <strong>p</strong> is calculated. Vector <strong>p</strong> points in the direction of propagation of light. If light is propagating in a <a href="Gradient_index_optics" title="wikilink">gradient index optic</a> the path of the light ray is curved and vector <strong>p</strong> is tangent to the light ray.</p>

<p>The expression for the optical path length can also be written as a function of the optical momentum. Having in consideration that 

<math display="inline" id="Hamiltonian_optics:38">
 <semantics>
  <mrow>
   <msub>
    <mover accent="true">
     <mi>x</mi>
     <mo>˙</mo>
    </mover>
    <mn>3</mn>
   </msub>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mrow>
      <mi>d</mi>
      <msub>
       <mi>x</mi>
       <mn>3</mn>
      </msub>
     </mrow>
     <mo>/</mo>
     <mi>d</mi>
    </mrow>
    <msub>
     <mi>x</mi>
     <mn>3</mn>
    </msub>
   </mrow>
   <mo>=</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <ci>normal-˙</ci>
       <ci>x</ci>
      </apply>
      <cn type="integer">3</cn>
     </apply>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <apply>
        <times></times>
        <ci>d</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>x</ci>
         <cn type="integer">3</cn>
        </apply>
       </apply>
       <ci>d</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <cn type="integer">3</cn>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <cn type="integer">1</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \dot{x}_{3}=dx_{3}/dx_{3}=1
  </annotation>
 </semantics>
</math>

 the expression for the optical Lagrangian can be rewritten as</p>

<p>

<math display="block" id="Hamiltonian_optics:39">
 <semantics>
  <mrow>
   <mi>L</mi>
   <mo>=</mo>
   <mrow>
    <mi>n</mi>
    <msqrt>
     <mrow>
      <msubsup>
       <mover accent="true">
        <mi>x</mi>
        <mo>˙</mo>
       </mover>
       <mn>1</mn>
       <mn>2</mn>
      </msubsup>
      <mo>+</mo>
      <msubsup>
       <mover accent="true">
        <mi>x</mi>
        <mo>˙</mo>
       </mover>
       <mn>2</mn>
       <mn>2</mn>
      </msubsup>
      <mo>+</mo>
      <msubsup>
       <mover accent="true">
        <mi>x</mi>
        <mo>˙</mo>
       </mover>
       <mn>3</mn>
       <mn>2</mn>
      </msubsup>
     </mrow>
    </msqrt>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <msub>
      <mover accent="true">
       <mi>x</mi>
       <mo>˙</mo>
      </mover>
      <mn>1</mn>
     </msub>
     <mfrac>
      <mrow>
       <mi>n</mi>
       <msub>
        <mover accent="true">
         <mi>x</mi>
         <mo>˙</mo>
        </mover>
        <mn>1</mn>
       </msub>
      </mrow>
      <msqrt>
       <mrow>
        <msubsup>
         <mover accent="true">
          <mi>x</mi>
          <mo>˙</mo>
         </mover>
         <mn>1</mn>
         <mn>2</mn>
        </msubsup>
        <mo>+</mo>
        <msubsup>
         <mover accent="true">
          <mi>x</mi>
          <mo>˙</mo>
         </mover>
         <mn>2</mn>
         <mn>2</mn>
        </msubsup>
        <mo>+</mo>
        <msubsup>
         <mover accent="true">
          <mi>x</mi>
          <mo>˙</mo>
         </mover>
         <mn>3</mn>
         <mn>2</mn>
        </msubsup>
       </mrow>
      </msqrt>
     </mfrac>
    </mrow>
    <mo>+</mo>
    <mrow>
     <msub>
      <mover accent="true">
       <mi>x</mi>
       <mo>˙</mo>
      </mover>
      <mn>2</mn>
     </msub>
     <mfrac>
      <mrow>
       <mi>n</mi>
       <msub>
        <mover accent="true">
         <mi>x</mi>
         <mo>˙</mo>
        </mover>
        <mn>2</mn>
       </msub>
      </mrow>
      <msqrt>
       <mrow>
        <msubsup>
         <mover accent="true">
          <mi>x</mi>
          <mo>˙</mo>
         </mover>
         <mn>1</mn>
         <mn>2</mn>
        </msubsup>
        <mo>+</mo>
        <msubsup>
         <mover accent="true">
          <mi>x</mi>
          <mo>˙</mo>
         </mover>
         <mn>2</mn>
         <mn>2</mn>
        </msubsup>
        <mo>+</mo>
        <msubsup>
         <mover accent="true">
          <mi>x</mi>
          <mo>˙</mo>
         </mover>
         <mn>3</mn>
         <mn>2</mn>
        </msubsup>
       </mrow>
      </msqrt>
     </mfrac>
    </mrow>
    <mo>+</mo>
    <mfrac>
     <mrow>
      <mi>n</mi>
      <msub>
       <mover accent="true">
        <mi>x</mi>
        <mo>˙</mo>
       </mover>
       <mn>3</mn>
      </msub>
     </mrow>
     <msqrt>
      <mrow>
       <msubsup>
        <mover accent="true">
         <mi>x</mi>
         <mo>˙</mo>
        </mover>
        <mn>1</mn>
        <mn>2</mn>
       </msubsup>
       <mo>+</mo>
       <msubsup>
        <mover accent="true">
         <mi>x</mi>
         <mo>˙</mo>
        </mover>
        <mn>2</mn>
        <mn>2</mn>
       </msubsup>
       <mo>+</mo>
       <msubsup>
        <mover accent="true">
         <mi>x</mi>
         <mo>˙</mo>
        </mover>
        <mn>3</mn>
        <mn>2</mn>
       </msubsup>
      </mrow>
     </msqrt>
    </mfrac>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <ci>L</ci>
     <apply>
      <times></times>
      <ci>n</ci>
      <apply>
       <root></root>
       <apply>
        <plus></plus>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <apply>
           <ci>normal-˙</ci>
           <ci>x</ci>
          </apply>
          <cn type="integer">1</cn>
         </apply>
         <cn type="integer">2</cn>
        </apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <apply>
           <ci>normal-˙</ci>
           <ci>x</ci>
          </apply>
          <cn type="integer">2</cn>
         </apply>
         <cn type="integer">2</cn>
        </apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <apply>
           <ci>normal-˙</ci>
           <ci>x</ci>
          </apply>
          <cn type="integer">3</cn>
         </apply>
         <cn type="integer">2</cn>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <plus></plus>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <apply>
         <ci>normal-˙</ci>
         <ci>x</ci>
        </apply>
        <cn type="integer">1</cn>
       </apply>
       <apply>
        <divide></divide>
        <apply>
         <times></times>
         <ci>n</ci>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <apply>
           <ci>normal-˙</ci>
           <ci>x</ci>
          </apply>
          <cn type="integer">1</cn>
         </apply>
        </apply>
        <apply>
         <root></root>
         <apply>
          <plus></plus>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <apply>
             <ci>normal-˙</ci>
             <ci>x</ci>
            </apply>
            <cn type="integer">1</cn>
           </apply>
           <cn type="integer">2</cn>
          </apply>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <apply>
             <ci>normal-˙</ci>
             <ci>x</ci>
            </apply>
            <cn type="integer">2</cn>
           </apply>
           <cn type="integer">2</cn>
          </apply>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <apply>
             <ci>normal-˙</ci>
             <ci>x</ci>
            </apply>
            <cn type="integer">3</cn>
           </apply>
           <cn type="integer">2</cn>
          </apply>
         </apply>
        </apply>
       </apply>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <apply>
         <ci>normal-˙</ci>
         <ci>x</ci>
        </apply>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <divide></divide>
        <apply>
         <times></times>
         <ci>n</ci>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <apply>
           <ci>normal-˙</ci>
           <ci>x</ci>
          </apply>
          <cn type="integer">2</cn>
         </apply>
        </apply>
        <apply>
         <root></root>
         <apply>
          <plus></plus>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <apply>
             <ci>normal-˙</ci>
             <ci>x</ci>
            </apply>
            <cn type="integer">1</cn>
           </apply>
           <cn type="integer">2</cn>
          </apply>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <apply>
             <ci>normal-˙</ci>
             <ci>x</ci>
            </apply>
            <cn type="integer">2</cn>
           </apply>
           <cn type="integer">2</cn>
          </apply>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <apply>
             <ci>normal-˙</ci>
             <ci>x</ci>
            </apply>
            <cn type="integer">3</cn>
           </apply>
           <cn type="integer">2</cn>
          </apply>
         </apply>
        </apply>
       </apply>
      </apply>
      <apply>
       <divide></divide>
       <apply>
        <times></times>
        <ci>n</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <apply>
          <ci>normal-˙</ci>
          <ci>x</ci>
         </apply>
         <cn type="integer">3</cn>
        </apply>
       </apply>
       <apply>
        <root></root>
        <apply>
         <plus></plus>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <apply>
            <ci>normal-˙</ci>
            <ci>x</ci>
           </apply>
           <cn type="integer">1</cn>
          </apply>
          <cn type="integer">2</cn>
         </apply>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <apply>
            <ci>normal-˙</ci>
            <ci>x</ci>
           </apply>
           <cn type="integer">2</cn>
          </apply>
          <cn type="integer">2</cn>
         </apply>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <apply>
            <ci>normal-˙</ci>
            <ci>x</ci>
           </apply>
           <cn type="integer">3</cn>
          </apply>
          <cn type="integer">2</cn>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   L=n\sqrt{\dot{x}_{1}^{2}+\dot{x}_{2}^{2}+\dot{x}_{3}^{2}}=\dot{x}_{1}\frac{n%
\dot{x}_{1}}{\sqrt{\dot{x}_{1}^{2}+\dot{x}_{2}^{2}+\dot{x}_{3}^{2}}}+\dot{x}_{%
2}\frac{n\dot{x}_{2}}{\sqrt{\dot{x}_{1}^{2}+\dot{x}_{2}^{2}+\dot{x}_{3}^{2}}}+%
\frac{n\dot{x}_{3}}{\sqrt{\dot{x}_{1}^{2}+\dot{x}_{2}^{2}+\dot{x}_{3}^{2}}}
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Hamiltonian_optics:40">
 <semantics>
  <mrow>
   <mi></mi>
   <mo>=</mo>
   <mrow>
    <mrow>
     <msub>
      <mover accent="true">
       <mi>x</mi>
       <mo>˙</mo>
      </mover>
      <mn>1</mn>
     </msub>
     <msub>
      <mi>p</mi>
      <mn>1</mn>
     </msub>
    </mrow>
    <mo>+</mo>
    <mrow>
     <msub>
      <mover accent="true">
       <mi>x</mi>
       <mo>˙</mo>
      </mover>
      <mn>2</mn>
     </msub>
     <msub>
      <mi>p</mi>
      <mn>2</mn>
     </msub>
    </mrow>
    <mo>+</mo>
    <mrow>
     <msub>
      <mover accent="true">
       <mi>x</mi>
       <mo>˙</mo>
      </mover>
      <mn>3</mn>
     </msub>
     <msub>
      <mi>p</mi>
      <mn>3</mn>
     </msub>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <msub>
      <mover accent="true">
       <mi>x</mi>
       <mo>˙</mo>
      </mover>
      <mn>1</mn>
     </msub>
     <msub>
      <mi>p</mi>
      <mn>1</mn>
     </msub>
    </mrow>
    <mo>+</mo>
    <mrow>
     <msub>
      <mover accent="true">
       <mi>x</mi>
       <mo>˙</mo>
      </mover>
      <mn>2</mn>
     </msub>
     <msub>
      <mi>p</mi>
      <mn>2</mn>
     </msub>
    </mrow>
    <mo>+</mo>
    <msub>
     <mi>p</mi>
     <mn>3</mn>
    </msub>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <csymbol cd="latexml">absent</csymbol>
     <apply>
      <plus></plus>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <apply>
         <ci>normal-˙</ci>
         <ci>x</ci>
        </apply>
        <cn type="integer">1</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>p</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <apply>
         <ci>normal-˙</ci>
         <ci>x</ci>
        </apply>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>p</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <apply>
         <ci>normal-˙</ci>
         <ci>x</ci>
        </apply>
        <cn type="integer">3</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>p</ci>
        <cn type="integer">3</cn>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <plus></plus>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <apply>
         <ci>normal-˙</ci>
         <ci>x</ci>
        </apply>
        <cn type="integer">1</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>p</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <apply>
         <ci>normal-˙</ci>
         <ci>x</ci>
        </apply>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>p</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>p</ci>
       <cn type="integer">3</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   =\dot{x}_{1}p_{1}+\dot{x}_{2}p_{2}+\dot{x}_{3}p_{3}=\dot{x}_{1}p_{1}+\dot{x}_{%
2}p_{2}+p_{3}
  </annotation>
 </semantics>
</math>

</p>

<p>and the expression for the optical path length is</p>

<p>

<math display="block" id="Hamiltonian_optics:41">
 <semantics>
  <mrow>
   <mi>S</mi>
   <mo>=</mo>
   <mrow>
    <mo largeop="true" symmetric="true">∫</mo>
    <mrow>
     <mpadded width="+1.7pt">
      <mi>L</mi>
     </mpadded>
     <mi>d</mi>
     <msub>
      <mi>x</mi>
      <mn>3</mn>
     </msub>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mo largeop="true" symmetric="true">∫</mo>
    <mrow>
     <mrow>
      <mi>𝐩</mi>
      <mo>⋅</mo>
      <mi>d</mi>
     </mrow>
     <mi>𝐬</mi>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <ci>S</ci>
     <apply>
      <int></int>
      <apply>
       <times></times>
       <ci>L</ci>
       <ci>d</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <cn type="integer">3</cn>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <int></int>
      <apply>
       <times></times>
       <apply>
        <ci>normal-⋅</ci>
        <ci>𝐩</ci>
        <ci>d</ci>
       </apply>
       <ci>𝐬</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   S=\int L\,dx_{3}=\int\mathbf{p}\cdot d\mathbf{s}
  </annotation>
 </semantics>
</math>

</p>
<h3 id="hamiltons-equations">Hamilton's equations</h3>

<p>Similarly to what happens in <a href="Hamiltonian_mechanics" title="wikilink">Hamiltonian mechanics</a>, also in optics the Hamiltonian is defined by the expression given <a href="#Hamilton's_principle" title="wikilink">above</a> for <em>N</em>=2 corresponding to functions 

<math display="inline" id="Hamiltonian_optics:42">
 <semantics>
  <mrow>
   <msub>
    <mi>x</mi>
    <mn>1</mn>
   </msub>
   <mrow>
    <mo>(</mo>
    <msub>
     <mi>x</mi>
     <mn>3</mn>
    </msub>
    <mo>)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>x</ci>
     <cn type="integer">1</cn>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>x</ci>
     <cn type="integer">3</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x_{1}\left(x_{3}\right)
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Hamiltonian_optics:43">
 <semantics>
  <mrow>
   <msub>
    <mi>x</mi>
    <mn>2</mn>
   </msub>
   <mrow>
    <mo>(</mo>
    <msub>
     <mi>x</mi>
     <mn>3</mn>
    </msub>
    <mo>)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>x</ci>
     <cn type="integer">2</cn>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>x</ci>
     <cn type="integer">3</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x_{2}\left(x_{3}\right)
  </annotation>
 </semantics>
</math>

 to be determined</p>

<p>

<math display="block" id="Hamiltonian_optics:44">
 <semantics>
  <mrow>
   <mi>H</mi>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mrow>
      <msub>
       <mover accent="true">
        <mi>x</mi>
        <mo>˙</mo>
       </mover>
       <mn>1</mn>
      </msub>
      <msub>
       <mi>p</mi>
       <mn>1</mn>
      </msub>
     </mrow>
     <mo>+</mo>
     <mrow>
      <msub>
       <mover accent="true">
        <mi>x</mi>
        <mo>˙</mo>
       </mover>
       <mn>2</mn>
      </msub>
      <msub>
       <mi>p</mi>
       <mn>2</mn>
      </msub>
     </mrow>
    </mrow>
    <mo>-</mo>
    <mi>L</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>H</ci>
    <apply>
     <minus></minus>
     <apply>
      <plus></plus>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <apply>
         <ci>normal-˙</ci>
         <ci>x</ci>
        </apply>
        <cn type="integer">1</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>p</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <apply>
         <ci>normal-˙</ci>
         <ci>x</ci>
        </apply>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>p</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
     </apply>
     <ci>L</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   H=\dot{x}_{1}p_{1}+\dot{x}_{2}p_{2}-L
  </annotation>
 </semantics>
</math>

</p>

<p>Comparing this expression with 

<math display="inline" id="Hamiltonian_optics:45">
 <semantics>
  <mrow>
   <mi>L</mi>
   <mo>=</mo>
   <mrow>
    <mrow>
     <msub>
      <mover accent="true">
       <mi>x</mi>
       <mo>˙</mo>
      </mover>
      <mn>1</mn>
     </msub>
     <msub>
      <mi>p</mi>
      <mn>1</mn>
     </msub>
    </mrow>
    <mo>+</mo>
    <mrow>
     <msub>
      <mover accent="true">
       <mi>x</mi>
       <mo>˙</mo>
      </mover>
      <mn>2</mn>
     </msub>
     <msub>
      <mi>p</mi>
      <mn>2</mn>
     </msub>
    </mrow>
    <mo>+</mo>
    <msub>
     <mi>p</mi>
     <mn>3</mn>
    </msub>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>L</ci>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <apply>
        <ci>normal-˙</ci>
        <ci>x</ci>
       </apply>
       <cn type="integer">1</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>p</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <apply>
        <ci>normal-˙</ci>
        <ci>x</ci>
       </apply>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>p</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>p</ci>
      <cn type="integer">3</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   L=\dot{x}_{1}p_{1}+\dot{x}_{2}p_{2}+p_{3}
  </annotation>
 </semantics>
</math>

 for the Lagrangian results in</p>

<p>

<math display="block" id="Hamiltonian_optics:46">
 <semantics>
  <mrow>
   <mi>H</mi>
   <mo>=</mo>
   <mrow>
    <mo>-</mo>
    <msub>
     <mi>p</mi>
     <mn>3</mn>
    </msub>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mo>-</mo>
    <msqrt>
     <mrow>
      <msup>
       <mi>n</mi>
       <mn>2</mn>
      </msup>
      <mo>-</mo>
      <msubsup>
       <mi>p</mi>
       <mn>1</mn>
       <mn>2</mn>
      </msubsup>
      <mo>-</mo>
      <msubsup>
       <mi>p</mi>
       <mn>2</mn>
       <mn>2</mn>
      </msubsup>
     </mrow>
    </msqrt>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <ci>H</ci>
     <apply>
      <minus></minus>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>p</ci>
       <cn type="integer">3</cn>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <minus></minus>
      <apply>
       <root></root>
       <apply>
        <minus></minus>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>n</ci>
         <cn type="integer">2</cn>
        </apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>p</ci>
          <cn type="integer">1</cn>
         </apply>
         <cn type="integer">2</cn>
        </apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>p</ci>
          <cn type="integer">2</cn>
         </apply>
         <cn type="integer">2</cn>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   H=-p_{3}=-\sqrt{n^{2}-p_{1}^{2}-p_{2}^{2}}
  </annotation>
 </semantics>
</math>

</p>

<p>And the corresponding Hamilton's equations with parameter <em>σ</em> =<em>x</em><sub>3</sub> and <em>k</em>=1,2 applied to optics are<a class="footnoteRef" href="#fn6" id="fnref6"><sup>6</sup></a><a class="footnoteRef" href="#fn7" id="fnref7"><sup>7</sup></a></p>

<p>

<math display="block" id="Hamiltonian_optics:47">
 <semantics>
  <mrow>
   <mrow>
    <mfrac>
     <mrow>
      <mo>∂</mo>
      <mi>H</mi>
     </mrow>
     <mrow>
      <mo>∂</mo>
      <msub>
       <mi>x</mi>
       <mi>k</mi>
      </msub>
     </mrow>
    </mfrac>
    <mo>=</mo>
    <mrow>
     <mo>-</mo>
     <mpadded width="+1.7pt">
      <msub>
       <mover accent="true">
        <mi>p</mi>
        <mo>˙</mo>
       </mover>
       <mi>k</mi>
      </msub>
     </mpadded>
    </mrow>
   </mrow>
   <mo rspace="12.5pt">,</mo>
   <mrow>
    <mfrac>
     <mrow>
      <mo>∂</mo>
      <mi>H</mi>
     </mrow>
     <mrow>
      <mo>∂</mo>
      <msub>
       <mi>p</mi>
       <mi>k</mi>
      </msub>
     </mrow>
    </mfrac>
    <mo>=</mo>
    <msub>
     <mover accent="true">
      <mi>x</mi>
      <mo>˙</mo>
     </mover>
     <mi>k</mi>
    </msub>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <eq></eq>
     <apply>
      <divide></divide>
      <apply>
       <partialdiff></partialdiff>
       <ci>H</ci>
      </apply>
      <apply>
       <partialdiff></partialdiff>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <ci>k</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <minus></minus>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <apply>
        <ci>normal-˙</ci>
        <ci>p</ci>
       </apply>
       <ci>k</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <apply>
      <divide></divide>
      <apply>
       <partialdiff></partialdiff>
       <ci>H</ci>
      </apply>
      <apply>
       <partialdiff></partialdiff>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>p</ci>
        <ci>k</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <ci>normal-˙</ci>
       <ci>x</ci>
      </apply>
      <ci>k</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \frac{\partial H}{\partial x_{k}}=-\dot{p}_{k}\,,\quad\frac{\partial H}{%
\partial p_{k}}=\dot{x}_{k}
  </annotation>
 </semantics>
</math>

</p>

<p>with 

<math display="inline" id="Hamiltonian_optics:48">
 <semantics>
  <mrow>
   <msub>
    <mover accent="true">
     <mi>x</mi>
     <mo>˙</mo>
    </mover>
    <mi>k</mi>
   </msub>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mrow>
      <mi>d</mi>
      <msub>
       <mi>x</mi>
       <mi>k</mi>
      </msub>
     </mrow>
     <mo>/</mo>
     <mi>d</mi>
    </mrow>
    <msub>
     <mi>x</mi>
     <mn>3</mn>
    </msub>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <ci>normal-˙</ci>
      <ci>x</ci>
     </apply>
     <ci>k</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <divide></divide>
      <apply>
       <times></times>
       <ci>d</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <ci>k</ci>
       </apply>
      </apply>
      <ci>d</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <cn type="integer">3</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \dot{x}_{k}=dx_{k}/dx_{3}
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Hamiltonian_optics:49">
 <semantics>
  <mrow>
   <msub>
    <mover accent="true">
     <mi>p</mi>
     <mo>˙</mo>
    </mover>
    <mi>k</mi>
   </msub>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mrow>
      <mi>d</mi>
      <msub>
       <mi>p</mi>
       <mi>k</mi>
      </msub>
     </mrow>
     <mo>/</mo>
     <mi>d</mi>
    </mrow>
    <msub>
     <mi>x</mi>
     <mn>3</mn>
    </msub>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <ci>normal-˙</ci>
      <ci>p</ci>
     </apply>
     <ci>k</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <divide></divide>
      <apply>
       <times></times>
       <ci>d</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>p</ci>
        <ci>k</ci>
       </apply>
      </apply>
      <ci>d</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <cn type="integer">3</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \dot{p}_{k}=dp_{k}/dx_{3}
  </annotation>
 </semantics>
</math>

.</p>
<h2 id="applications">Applications</h2>

<p>It is assumed that light travels along the <em>x</em><sub>3</sub> axis, in <a href="#Hamilton's_principle" title="wikilink">Hamilton's principle</a> above, coordinates 

<math display="inline" id="Hamiltonian_optics:50">
 <semantics>
  <msub>
   <mi>x</mi>
   <mn>1</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>x</ci>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x_{1}
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Hamiltonian_optics:51">
 <semantics>
  <msub>
   <mi>x</mi>
   <mn>2</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>x</ci>
    <cn type="integer">2</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x_{2}
  </annotation>
 </semantics>
</math>

 take the role of the generalized coordinates 

<math display="inline" id="Hamiltonian_optics:52">
 <semantics>
  <msub>
   <mi>q</mi>
   <mi>k</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>q</ci>
    <ci>k</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   q_{k}
  </annotation>
 </semantics>
</math>

 while 

<math display="inline" id="Hamiltonian_optics:53">
 <semantics>
  <msub>
   <mi>x</mi>
   <mn>3</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>x</ci>
    <cn type="integer">3</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x_{3}
  </annotation>
 </semantics>
</math>

 takes the role of parameter 

<math display="inline" id="Hamiltonian_optics:54">
 <semantics>
  <mi>σ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>σ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \sigma
  </annotation>
 </semantics>
</math>

, that is, parameter <em>σ</em> =<em>x</em><sub>3</sub> and <em>N</em>=2.</p>
<h3 id="refraction-and-reflection">Refraction and reflection</h3>

<p>If plane <em>x</em><sub>1</sub><em>x</em><sub>2</sub> separates two media of refractive index <em>n</em><sub><em>A</em></sub> below and <em>n</em><sub><em>B</em></sub> above it, the refractive index is given by a <a href="step_function" title="wikilink">step function</a></p>

<p>

<math display="block" id="Hamiltonian_optics:55">
 <semantics>
  <mrow>
   <mrow>
    <mi>n</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <msub>
      <mi>x</mi>
      <mn>3</mn>
     </msub>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mo>{</mo>
    <mtable displaystyle="true">
     <mtr>
      <mtd columnalign="left">
       <msub>
        <mi>n</mi>
        <mi>A</mi>
       </msub>
      </mtd>
      <mtd columnalign="left">
       <mrow>
        <mrow>
         <mtext>if</mtext>
         <msub>
          <mi>x</mi>
          <mn>3</mn>
         </msub>
        </mrow>
        <mo><</mo>
        <mn>0</mn>
       </mrow>
      </mtd>
     </mtr>
     <mtr>
      <mtd columnalign="left">
       <msub>
        <mi>n</mi>
        <mi>B</mi>
       </msub>
      </mtd>
      <mtd columnalign="left">
       <mrow>
        <mrow>
         <mtext>if</mtext>
         <msub>
          <mi>x</mi>
          <mn>3</mn>
         </msub>
        </mrow>
        <mo>></mo>
        <mn>0</mn>
       </mrow>
      </mtd>
     </mtr>
    </mtable>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>n</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <cn type="integer">3</cn>
     </apply>
    </apply>
    <apply>
     <csymbol cd="latexml">cases</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>n</ci>
      <ci>A</ci>
     </apply>
     <apply>
      <lt></lt>
      <apply>
       <times></times>
       <mtext>if</mtext>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <cn type="integer">3</cn>
       </apply>
      </apply>
      <cn type="integer">0</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>n</ci>
      <ci>B</ci>
     </apply>
     <apply>
      <gt></gt>
      <apply>
       <times></times>
       <mtext>if</mtext>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <cn type="integer">3</cn>
       </apply>
      </apply>
      <cn type="integer">0</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n(x_{3})=\begin{cases}n_{A}&\mbox{if }x_{3}<0\\
n_{B}&\mbox{if }x_{3}>0\\
\end{cases}
  </annotation>
 </semantics>
</math>

</p>

<p>and from <a href="#Hamilton's_equations" title="wikilink">Hamilton's equations</a></p>

<p>

<math display="block" id="Hamiltonian_optics:56">
 <semantics>
  <mrow>
   <mfrac>
    <mrow>
     <mo>∂</mo>
     <mi>H</mi>
    </mrow>
    <mrow>
     <mo>∂</mo>
     <msub>
      <mi>x</mi>
      <mi>k</mi>
     </msub>
    </mrow>
   </mfrac>
   <mo>=</mo>
   <mrow>
    <mo>-</mo>
    <mrow>
     <mfrac>
      <mo>∂</mo>
      <mrow>
       <mo>∂</mo>
       <msub>
        <mi>x</mi>
        <mi>k</mi>
       </msub>
      </mrow>
     </mfrac>
     <msqrt>
      <mrow>
       <mrow>
        <mi>n</mi>
        <msup>
         <mrow>
          <mo stretchy="false">(</mo>
          <msub>
           <mi>x</mi>
           <mn>3</mn>
          </msub>
          <mo stretchy="false">)</mo>
         </mrow>
         <mn>2</mn>
        </msup>
       </mrow>
       <mo>-</mo>
       <msubsup>
        <mi>p</mi>
        <mn>1</mn>
        <mn>2</mn>
       </msubsup>
       <mo>-</mo>
       <msubsup>
        <mi>p</mi>
        <mn>2</mn>
        <mn>2</mn>
       </msubsup>
      </mrow>
     </msqrt>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <divide></divide>
      <apply>
       <partialdiff></partialdiff>
       <ci>H</ci>
      </apply>
      <apply>
       <partialdiff></partialdiff>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <ci>k</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <minus></minus>
      <apply>
       <times></times>
       <apply>
        <divide></divide>
        <partialdiff></partialdiff>
        <apply>
         <partialdiff></partialdiff>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>x</ci>
          <ci>k</ci>
         </apply>
        </apply>
       </apply>
       <apply>
        <root></root>
        <apply>
         <minus></minus>
         <apply>
          <times></times>
          <ci>n</ci>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <ci>x</ci>
            <cn type="integer">3</cn>
           </apply>
           <cn type="integer">2</cn>
          </apply>
         </apply>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>p</ci>
           <cn type="integer">1</cn>
          </apply>
          <cn type="integer">2</cn>
         </apply>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>p</ci>
           <cn type="integer">2</cn>
          </apply>
          <cn type="integer">2</cn>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <cn type="integer">0</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \frac{\partial H}{\partial x_{k}}=-\frac{\partial}{\partial x_{k}}\sqrt{n(x_{3%
})^{2}-p_{1}^{2}-p_{2}^{2}}=0
  </annotation>
 </semantics>
</math>

</p>

<p>and therefore 

<math display="inline" id="Hamiltonian_optics:57">
 <semantics>
  <mrow>
   <msub>
    <mover accent="true">
     <mi>p</mi>
     <mo>˙</mo>
    </mover>
    <mi>k</mi>
   </msub>
   <mo>=</mo>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <ci>normal-˙</ci>
      <ci>p</ci>
     </apply>
     <ci>k</ci>
    </apply>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \dot{p}_{k}=0
  </annotation>
 </semantics>
</math>

 or 

<math display="inline" id="Hamiltonian_optics:58">
 <semantics>
  <mrow>
   <msub>
    <mi>p</mi>
    <mi>k</mi>
   </msub>
   <mo>=</mo>
   <mtext>Constant</mtext>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>p</ci>
     <ci>k</ci>
    </apply>
    <mtext>Constant</mtext>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p_{k}=\text{Constant}
  </annotation>
 </semantics>
</math>

 for <em>k</em>=1,2.</p>

<p>An incoming light ray has momentum <strong>p</strong><sub><em>A</em></sub> before refraction (below plane <em>x</em><sub>1</sub><em>x</em><sub>2</sub>) and momentum <strong>p</strong><sub><em>B</em></sub> after refraction (above plane <em>x</em><sub>1</sub><em>x</em><sub>2</sub>). The light ray makes an angle <em>θ</em><sub><em>A</em></sub> with axis <em>x</em><sub>3</sub> (the normal to the refractive surface) before refraction and an angle <em>θ</em><sub><em>B</em></sub> with axis <em>x</em><sub>3</sub> after refraction. Since the <em>p</em><sub>1</sub> and <em>p</em><sub>2</sub> components of the momentum are constant, only <em>p</em><sub>3</sub> changes from <em>p</em><sub>3<em>A</em></sub> to <em>p</em><sub>3<em>B</em></sub>.</p>
<figure><b>(Figure)</b>
<figcaption>Refraction</figcaption>
</figure>

<p>Figure "refraction" shows the geometry of this refraction from which 

<math display="inline" id="Hamiltonian_optics:59">
 <semantics>
  <mrow>
   <mi>d</mi>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mo>∥</mo>
     <msub>
      <mi>𝐩</mi>
      <mi>A</mi>
     </msub>
     <mo>∥</mo>
    </mrow>
    <mrow>
     <mi>sin</mi>
     <msub>
      <mi>θ</mi>
      <mi>A</mi>
     </msub>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mo>∥</mo>
     <msub>
      <mi>𝐩</mi>
      <mi>B</mi>
     </msub>
     <mo>∥</mo>
    </mrow>
    <mrow>
     <mi>sin</mi>
     <msub>
      <mi>θ</mi>
      <mi>B</mi>
     </msub>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <ci>d</ci>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="latexml">norm</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>𝐩</ci>
        <ci>A</ci>
       </apply>
      </apply>
      <apply>
       <sin></sin>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>θ</ci>
        <ci>A</ci>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="latexml">norm</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>𝐩</ci>
        <ci>B</ci>
       </apply>
      </apply>
      <apply>
       <sin></sin>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>θ</ci>
        <ci>B</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   d=\|\mathbf{p}_{A}\|\sin\theta_{A}=\|\mathbf{p}_{B}\|\sin\theta_{B}
  </annotation>
 </semantics>
</math>

. Since 

<math display="inline" id="Hamiltonian_optics:60">
 <semantics>
  <mrow>
   <mrow>
    <mo>∥</mo>
    <msub>
     <mi>𝐩</mi>
     <mi>A</mi>
    </msub>
    <mo>∥</mo>
   </mrow>
   <mo>=</mo>
   <msub>
    <mi>n</mi>
    <mi>A</mi>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="latexml">norm</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>𝐩</ci>
      <ci>A</ci>
     </apply>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>n</ci>
     <ci>A</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \|\mathbf{p}_{A}\|=n_{A}
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Hamiltonian_optics:61">
 <semantics>
  <mrow>
   <mrow>
    <mo>∥</mo>
    <msub>
     <mi>𝐩</mi>
     <mi>B</mi>
    </msub>
    <mo>∥</mo>
   </mrow>
   <mo>=</mo>
   <msub>
    <mi>n</mi>
    <mi>B</mi>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="latexml">norm</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>𝐩</ci>
      <ci>B</ci>
     </apply>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>n</ci>
     <ci>B</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \|\mathbf{p}_{B}\|=n_{B}
  </annotation>
 </semantics>
</math>

, this last expression can be written as</p>

<p>

<math display="block" id="Hamiltonian_optics:62">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>n</mi>
     <mi>A</mi>
    </msub>
    <mrow>
     <mi>sin</mi>
     <msub>
      <mi>θ</mi>
      <mi>A</mi>
     </msub>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <msub>
     <mi>n</mi>
     <mi>B</mi>
    </msub>
    <mrow>
     <mi>sin</mi>
     <msub>
      <mi>θ</mi>
      <mi>B</mi>
     </msub>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>n</ci>
      <ci>A</ci>
     </apply>
     <apply>
      <sin></sin>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>θ</ci>
       <ci>A</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>n</ci>
      <ci>B</ci>
     </apply>
     <apply>
      <sin></sin>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>θ</ci>
       <ci>B</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n_{A}\sin\theta_{A}=n_{B}\sin\theta_{B}
  </annotation>
 </semantics>
</math>

</p>

<p>which is <a href="Snell's_law" title="wikilink">Snell's law</a> of <a class="uri" href="refraction" title="wikilink">refraction</a>.</p>

<p>In figure "refraction", the normal to the refractive surface points in the direction of axis <em>x</em><sub>3</sub>, and also of vector 

<math display="inline" id="Hamiltonian_optics:63">
 <semantics>
  <mrow>
   <mi>𝐯</mi>
   <mo>=</mo>
   <mrow>
    <msub>
     <mi>𝐩</mi>
     <mi>A</mi>
    </msub>
    <mo>-</mo>
    <msub>
     <mi>𝐩</mi>
     <mi>B</mi>
    </msub>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>𝐯</ci>
    <apply>
     <minus></minus>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>𝐩</ci>
      <ci>A</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>𝐩</ci>
      <ci>B</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{v}=\mathbf{p}_{A}-\mathbf{p}_{B}
  </annotation>
 </semantics>
</math>

. A unit normal 

<math display="inline" id="Hamiltonian_optics:64">
 <semantics>
  <mrow>
   <mi>𝐧</mi>
   <mo>=</mo>
   <mrow>
    <mi>𝐯</mi>
    <mo>/</mo>
    <mrow>
     <mo>∥</mo>
     <mi>𝐯</mi>
     <mo>∥</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>𝐧</ci>
    <apply>
     <divide></divide>
     <ci>𝐯</ci>
     <apply>
      <csymbol cd="latexml">norm</csymbol>
      <ci>𝐯</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{n}=\mathbf{v}/\|\mathbf{v}\|
  </annotation>
 </semantics>
</math>

 to the refractive surface can then be obtained from the momenta of the incoming and outgoing rays by</p>

<p>

<math display="block" id="Hamiltonian_optics:65">
 <semantics>
  <mrow>
   <mi>𝐧</mi>
   <mo>=</mo>
   <mfrac>
    <mrow>
     <msub>
      <mi>𝐩</mi>
      <mi>A</mi>
     </msub>
     <mo>-</mo>
     <msub>
      <mi>𝐩</mi>
      <mi>B</mi>
     </msub>
    </mrow>
    <mrow>
     <mo>∥</mo>
     <mrow>
      <msub>
       <mi>𝐩</mi>
       <mi>A</mi>
      </msub>
      <mo>-</mo>
      <msub>
       <mi>𝐩</mi>
       <mi>B</mi>
      </msub>
     </mrow>
     <mo>∥</mo>
    </mrow>
   </mfrac>
   <mo>=</mo>
   <mfrac>
    <mrow>
     <mrow>
      <msub>
       <mi>n</mi>
       <mi>A</mi>
      </msub>
      <mi>𝐢</mi>
     </mrow>
     <mo>-</mo>
     <mrow>
      <msub>
       <mi>n</mi>
       <mi>B</mi>
      </msub>
      <mi>𝐫</mi>
     </mrow>
    </mrow>
    <mrow>
     <mo>∥</mo>
     <mrow>
      <mrow>
       <msub>
        <mi>n</mi>
        <mi>A</mi>
       </msub>
       <mi>𝐢</mi>
      </mrow>
      <mo>-</mo>
      <mrow>
       <msub>
        <mi>n</mi>
        <mi>B</mi>
       </msub>
       <mi>𝐫</mi>
      </mrow>
     </mrow>
     <mo>∥</mo>
    </mrow>
   </mfrac>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <ci>𝐧</ci>
     <apply>
      <divide></divide>
      <apply>
       <minus></minus>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>𝐩</ci>
        <ci>A</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>𝐩</ci>
        <ci>B</ci>
       </apply>
      </apply>
      <apply>
       <csymbol cd="latexml">norm</csymbol>
       <apply>
        <minus></minus>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>𝐩</ci>
         <ci>A</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>𝐩</ci>
         <ci>B</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <divide></divide>
      <apply>
       <minus></minus>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>n</ci>
         <ci>A</ci>
        </apply>
        <ci>𝐢</ci>
       </apply>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>n</ci>
         <ci>B</ci>
        </apply>
        <ci>𝐫</ci>
       </apply>
      </apply>
      <apply>
       <csymbol cd="latexml">norm</csymbol>
       <apply>
        <minus></minus>
        <apply>
         <times></times>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>n</ci>
          <ci>A</ci>
         </apply>
         <ci>𝐢</ci>
        </apply>
        <apply>
         <times></times>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>n</ci>
          <ci>B</ci>
         </apply>
         <ci>𝐫</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{n}=\frac{\mathbf{p}_{A}-\mathbf{p}_{B}}{\|\mathbf{p}_{A}-\mathbf{p}_{B%
}\|}=\frac{n_{A}\mathbf{i}-n_{B}\mathbf{r}}{\|n_{A}\mathbf{i}-n_{B}\mathbf{r}\|}
  </annotation>
 </semantics>
</math>

</p>

<p>where <strong>i</strong> and <strong>r</strong> are a unit vectors in the directions of the incident and refracted rays. Also, the outgoing ray (in the direction of 

<math display="inline" id="Hamiltonian_optics:66">
 <semantics>
  <msub>
   <mi>𝐩</mi>
   <mi>B</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>𝐩</ci>
    <ci>B</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{p}_{B}
  </annotation>
 </semantics>
</math>

) is contained in the plane defined by the incoming ray (in the direction of 

<math display="inline" id="Hamiltonian_optics:67">
 <semantics>
  <msub>
   <mi>𝐩</mi>
   <mi>A</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>𝐩</ci>
    <ci>A</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{p}_{A}
  </annotation>
 </semantics>
</math>

) and the normal 

<math display="inline" id="Hamiltonian_optics:68">
 <semantics>
  <mi>𝐧</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>𝐧</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{n}
  </annotation>
 </semantics>
</math>

 to the surface.</p>

<p>A similar argument can be used for <a href="Reflection_(physics)" title="wikilink">reflection</a> in deriving the law of <a href="specular_reflection" title="wikilink">specular reflection</a>, only now with <em>n</em><sub><em>A</em></sub>=<em>n</em><sub><em>B</em></sub>, resulting in <em>θ</em><sub><em>A</em></sub>=<em>θ</em><sub><em>B</em></sub>. Also, if <strong>i</strong> and <strong>r</strong> are unit vectors in the directions of the incident and refracted ray respectively, the corresponding normal to the surface is given by the same expression as for refraction, only with <em>n</em><sub><em>A</em></sub>=<em>n</em><sub><em>B</em></sub></p>

<p>

<math display="block" id="Hamiltonian_optics:69">
 <semantics>
  <mrow>
   <mi>𝐧</mi>
   <mo>=</mo>
   <mfrac>
    <mrow>
     <mi>𝐢</mi>
     <mo>-</mo>
     <mi>𝐫</mi>
    </mrow>
    <mrow>
     <mo>∥</mo>
     <mrow>
      <mi>𝐢</mi>
      <mo>-</mo>
      <mi>𝐫</mi>
     </mrow>
     <mo>∥</mo>
    </mrow>
   </mfrac>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>𝐧</ci>
    <apply>
     <divide></divide>
     <apply>
      <minus></minus>
      <ci>𝐢</ci>
      <ci>𝐫</ci>
     </apply>
     <apply>
      <csymbol cd="latexml">norm</csymbol>
      <apply>
       <minus></minus>
       <ci>𝐢</ci>
       <ci>𝐫</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{n}=\frac{\mathbf{i}-\mathbf{r}}{\|\mathbf{i}-\mathbf{r}\|}
  </annotation>
 </semantics>
</math>

</p>

<p>In vector form, if <strong>i</strong> is a unit vector pointing in the direction of the incident ray and <strong>n</strong> is the unit normal to the surface, the direction <strong>r</strong> of the refracted ray is given by:<a class="footnoteRef" href="#fn8" id="fnref8"><sup>8</sup></a></p>

<p>

<math display="block" id="Hamiltonian_optics:70">
 <semantics>
  <mrow>
   <mi>𝐫</mi>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mfrac>
      <msub>
       <mi>n</mi>
       <mi>A</mi>
      </msub>
      <msub>
       <mi>n</mi>
       <mi>B</mi>
      </msub>
     </mfrac>
     <mi>𝐢</mi>
    </mrow>
    <mo>+</mo>
    <mrow>
     <mrow>
      <mo>(</mo>
      <mrow>
       <mrow>
        <mo>-</mo>
        <mrow>
         <mrow>
          <mo>(</mo>
          <mrow>
           <mi>𝐢</mi>
           <mo>⋅</mo>
           <mi>𝐧</mi>
          </mrow>
          <mo>)</mo>
         </mrow>
         <mfrac>
          <msub>
           <mi>n</mi>
           <mi>A</mi>
          </msub>
          <msub>
           <mi>n</mi>
           <mi>B</mi>
          </msub>
         </mfrac>
        </mrow>
       </mrow>
       <mo>+</mo>
       <msqrt>
        <mi mathvariant="normal">Δ</mi>
       </msqrt>
      </mrow>
      <mo>)</mo>
     </mrow>
     <mi>𝐧</mi>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>𝐫</ci>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>n</ci>
        <ci>A</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>n</ci>
        <ci>B</ci>
       </apply>
      </apply>
      <ci>𝐢</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <plus></plus>
       <apply>
        <minus></minus>
        <apply>
         <times></times>
         <apply>
          <ci>normal-⋅</ci>
          <ci>𝐢</ci>
          <ci>𝐧</ci>
         </apply>
         <apply>
          <divide></divide>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>n</ci>
           <ci>A</ci>
          </apply>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>n</ci>
           <ci>B</ci>
          </apply>
         </apply>
        </apply>
       </apply>
       <apply>
        <root></root>
        <ci>normal-Δ</ci>
       </apply>
      </apply>
      <ci>𝐧</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{r}=\frac{n_{A}}{n_{B}}\mathbf{i}+\left(-\left(\mathbf{i}\cdot\mathbf{n%
}\right)\frac{n_{A}}{n_{B}}+\sqrt{\Delta}\right)\mathbf{n}
  </annotation>
 </semantics>
</math>

</p>

<p>with</p>

<p>

<math display="block" id="Hamiltonian_optics:71">
 <semantics>
  <mrow>
   <mi mathvariant="normal">Δ</mi>
   <mo>=</mo>
   <mrow>
    <mn>1</mn>
    <mo>-</mo>
    <mrow>
     <msup>
      <mrow>
       <mo>(</mo>
       <mfrac>
        <msub>
         <mi>n</mi>
         <mi>A</mi>
        </msub>
        <msub>
         <mi>n</mi>
         <mi>B</mi>
        </msub>
       </mfrac>
       <mo>)</mo>
      </mrow>
      <mn>2</mn>
     </msup>
     <mrow>
      <mo>(</mo>
      <mrow>
       <mn>1</mn>
       <mo>-</mo>
       <msup>
        <mrow>
         <mo>(</mo>
         <mrow>
          <mi>𝐢</mi>
          <mo>⋅</mo>
          <mi>𝐧</mi>
         </mrow>
         <mo>)</mo>
        </mrow>
        <mn>2</mn>
       </msup>
      </mrow>
      <mo>)</mo>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>normal-Δ</ci>
    <apply>
     <minus></minus>
     <cn type="integer">1</cn>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <divide></divide>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>n</ci>
         <ci>A</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>n</ci>
         <ci>B</ci>
        </apply>
       </apply>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <ci>normal-⋅</ci>
         <ci>𝐢</ci>
         <ci>𝐧</ci>
        </apply>
        <cn type="integer">2</cn>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Delta=1-\left(\frac{n_{A}}{n_{B}}\right)^{2}\left(1-\left(\mathbf{i}\cdot%
\mathbf{n}\right)^{2}\right)
  </annotation>
 </semantics>
</math>

</p>

<p>If <strong>i</strong>·<strong>n</strong>\Delta , light suffers <a href="total_internal_reflection" title="wikilink">total internal reflection</a> and the expression for the reflected ray is that of reflection:</p>

<p>

<math display="block" id="Hamiltonian_optics:72">
 <semantics>
  <mrow>
   <mi>𝐫</mi>
   <mo>=</mo>
   <mrow>
    <mi>𝐢</mi>
    <mo>-</mo>
    <mrow>
     <mn>2</mn>
     <mrow>
      <mo>(</mo>
      <mrow>
       <mi>𝐢</mi>
       <mo>⋅</mo>
       <mi>𝐧</mi>
      </mrow>
      <mo>)</mo>
     </mrow>
     <mi>𝐧</mi>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>𝐫</ci>
    <apply>
     <minus></minus>
     <ci>𝐢</ci>
     <apply>
      <times></times>
      <cn type="integer">2</cn>
      <apply>
       <ci>normal-⋅</ci>
       <ci>𝐢</ci>
       <ci>𝐧</ci>
      </apply>
      <ci>𝐧</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{r}=\mathbf{i}-2\left(\mathbf{i}\cdot\mathbf{n}\right)\mathbf{n}
  </annotation>
 </semantics>
</math>

</p>
<h3 id="rays-and-wavefronts">Rays and wavefronts</h3>

<p>From the definition of optical path length 

<math display="inline" id="Hamiltonian_optics:73">
 <semantics>
  <mrow>
   <mi>S</mi>
   <mo>=</mo>
   <mrow>
    <mo largeop="true" symmetric="true">∫</mo>
    <mrow>
     <mpadded width="+1.7pt">
      <mi>L</mi>
     </mpadded>
     <mi>d</mi>
     <msub>
      <mi>x</mi>
      <mn>3</mn>
     </msub>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>S</ci>
    <apply>
     <int></int>
     <apply>
      <times></times>
      <ci>L</ci>
      <ci>d</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <cn type="integer">3</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   S=\int L\,dx_{3}
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Hamiltonian_optics:74">
 <semantics>
  <mrow>
   <mfrac>
    <mrow>
     <mo>∂</mo>
     <mi>S</mi>
    </mrow>
    <mrow>
     <mo>∂</mo>
     <msub>
      <mi>x</mi>
      <mi>k</mi>
     </msub>
    </mrow>
   </mfrac>
   <mo>=</mo>
   <mrow>
    <mo largeop="true" symmetric="true">∫</mo>
    <mrow>
     <mpadded width="+1.7pt">
      <mfrac>
       <mrow>
        <mo>∂</mo>
        <mi>L</mi>
       </mrow>
       <mrow>
        <mo>∂</mo>
        <msub>
         <mi>x</mi>
         <mi>k</mi>
        </msub>
       </mrow>
      </mfrac>
     </mpadded>
     <mi>d</mi>
     <msub>
      <mi>x</mi>
      <mn>3</mn>
     </msub>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mo largeop="true" symmetric="true">∫</mo>
    <mrow>
     <mpadded width="+1.7pt">
      <mfrac>
       <mrow>
        <mi>d</mi>
        <msub>
         <mi>p</mi>
         <mi>k</mi>
        </msub>
       </mrow>
       <mrow>
        <mi>d</mi>
        <msub>
         <mi>x</mi>
         <mn>3</mn>
        </msub>
       </mrow>
      </mfrac>
     </mpadded>
     <mi>d</mi>
     <msub>
      <mi>x</mi>
      <mn>3</mn>
     </msub>
    </mrow>
   </mrow>
   <mo>=</mo>
   <msub>
    <mi>p</mi>
    <mi>k</mi>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <divide></divide>
      <apply>
       <partialdiff></partialdiff>
       <ci>S</ci>
      </apply>
      <apply>
       <partialdiff></partialdiff>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <ci>k</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <int></int>
      <apply>
       <times></times>
       <apply>
        <divide></divide>
        <apply>
         <partialdiff></partialdiff>
         <ci>L</ci>
        </apply>
        <apply>
         <partialdiff></partialdiff>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>x</ci>
          <ci>k</ci>
         </apply>
        </apply>
       </apply>
       <ci>d</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <cn type="integer">3</cn>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <int></int>
      <apply>
       <times></times>
       <apply>
        <divide></divide>
        <apply>
         <times></times>
         <ci>d</ci>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>p</ci>
          <ci>k</ci>
         </apply>
        </apply>
        <apply>
         <times></times>
         <ci>d</ci>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>x</ci>
          <cn type="integer">3</cn>
         </apply>
        </apply>
       </apply>
       <ci>d</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <cn type="integer">3</cn>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>p</ci>
      <ci>k</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \frac{\partial S}{\partial x_{k}}=\int\frac{\partial L}{\partial x_{k}}\,dx_{3%
}=\int\frac{dp_{k}}{dx_{3}}\,dx_{3}=p_{k}
  </annotation>
 </semantics>
</math>

</p>
<figure><b>(Figure)</b>
<figcaption>Rays and wavefronts</figcaption>
</figure>

<p>with <em>k</em>=1,2 where the <a href="#The_Euler-Lagrange_equations" title="wikilink">Euler-Lagrange equations</a> 

<math display="inline" id="Hamiltonian_optics:75">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mo>∂</mo>
     <mi>L</mi>
    </mrow>
    <mo>/</mo>
    <mrow>
     <mo>∂</mo>
     <msub>
      <mi>x</mi>
      <mi>k</mi>
     </msub>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mrow>
      <mi>d</mi>
      <msub>
       <mi>p</mi>
       <mi>k</mi>
      </msub>
     </mrow>
     <mo>/</mo>
     <mi>d</mi>
    </mrow>
    <msub>
     <mi>x</mi>
     <mn>3</mn>
    </msub>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <divide></divide>
     <apply>
      <partialdiff></partialdiff>
      <ci>L</ci>
     </apply>
     <apply>
      <partialdiff></partialdiff>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <ci>k</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <divide></divide>
      <apply>
       <times></times>
       <ci>d</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>p</ci>
        <ci>k</ci>
       </apply>
      </apply>
      <ci>d</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <cn type="integer">3</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \partial L/\partial x_{k}=dp_{k}/dx_{3}
  </annotation>
 </semantics>
</math>

 with <em>k</em>=1,2 were used. Also, from the last of <a href="#Hamilton's_principle" title="wikilink">Hamilton's equations</a> 

<math display="inline" id="Hamiltonian_optics:76">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mo>∂</mo>
     <mi>H</mi>
    </mrow>
    <mo>/</mo>
    <mrow>
     <mo>∂</mo>
     <msub>
      <mi>x</mi>
      <mn>3</mn>
     </msub>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mo>-</mo>
    <mrow>
     <mrow>
      <mo>∂</mo>
      <mi>L</mi>
     </mrow>
     <mo>/</mo>
     <mrow>
      <mo>∂</mo>
      <msub>
       <mi>x</mi>
       <mn>3</mn>
      </msub>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <divide></divide>
     <apply>
      <partialdiff></partialdiff>
      <ci>H</ci>
     </apply>
     <apply>
      <partialdiff></partialdiff>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <cn type="integer">3</cn>
      </apply>
     </apply>
    </apply>
    <apply>
     <minus></minus>
     <apply>
      <divide></divide>
      <apply>
       <partialdiff></partialdiff>
       <ci>L</ci>
      </apply>
      <apply>
       <partialdiff></partialdiff>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <cn type="integer">3</cn>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \partial H/\partial x_{3}=-\partial L/\partial x_{3}
  </annotation>
 </semantics>
</math>

 and from 

<math display="inline" id="Hamiltonian_optics:77">
 <semantics>
  <mrow>
   <mi>H</mi>
   <mo>=</mo>
   <mrow>
    <mo>-</mo>
    <msub>
     <mi>p</mi>
     <mn>3</mn>
    </msub>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>H</ci>
    <apply>
     <minus></minus>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>p</ci>
      <cn type="integer">3</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   H=-p_{3}
  </annotation>
 </semantics>
</math>

 <a href="#Hamilton's_equations" title="wikilink">above</a></p>

<p>

<math display="block" id="Hamiltonian_optics:78">
 <semantics>
  <mrow>
   <mfrac>
    <mrow>
     <mo>∂</mo>
     <mi>S</mi>
    </mrow>
    <mrow>
     <mo>∂</mo>
     <msub>
      <mi>x</mi>
      <mn>3</mn>
     </msub>
    </mrow>
   </mfrac>
   <mo>=</mo>
   <mrow>
    <mo largeop="true" symmetric="true">∫</mo>
    <mrow>
     <mpadded width="+1.7pt">
      <mfrac>
       <mrow>
        <mo>∂</mo>
        <mi>L</mi>
       </mrow>
       <mrow>
        <mo>∂</mo>
        <msub>
         <mi>x</mi>
         <mn>3</mn>
        </msub>
       </mrow>
      </mfrac>
     </mpadded>
     <mi>d</mi>
     <msub>
      <mi>x</mi>
      <mn>3</mn>
     </msub>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mo largeop="true" symmetric="true">∫</mo>
    <mrow>
     <mpadded width="+1.7pt">
      <mfrac>
       <mrow>
        <mi>d</mi>
        <msub>
         <mi>p</mi>
         <mn>3</mn>
        </msub>
       </mrow>
       <mrow>
        <mi>d</mi>
        <msub>
         <mi>x</mi>
         <mn>3</mn>
        </msub>
       </mrow>
      </mfrac>
     </mpadded>
     <mi>d</mi>
     <msub>
      <mi>x</mi>
      <mn>3</mn>
     </msub>
    </mrow>
   </mrow>
   <mo>=</mo>
   <msub>
    <mi>p</mi>
    <mn>3</mn>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <divide></divide>
      <apply>
       <partialdiff></partialdiff>
       <ci>S</ci>
      </apply>
      <apply>
       <partialdiff></partialdiff>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <cn type="integer">3</cn>
       </apply>
      </apply>
     </apply>
     <apply>
      <int></int>
      <apply>
       <times></times>
       <apply>
        <divide></divide>
        <apply>
         <partialdiff></partialdiff>
         <ci>L</ci>
        </apply>
        <apply>
         <partialdiff></partialdiff>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>x</ci>
          <cn type="integer">3</cn>
         </apply>
        </apply>
       </apply>
       <ci>d</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <cn type="integer">3</cn>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <int></int>
      <apply>
       <times></times>
       <apply>
        <divide></divide>
        <apply>
         <times></times>
         <ci>d</ci>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>p</ci>
          <cn type="integer">3</cn>
         </apply>
        </apply>
        <apply>
         <times></times>
         <ci>d</ci>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>x</ci>
          <cn type="integer">3</cn>
         </apply>
        </apply>
       </apply>
       <ci>d</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <cn type="integer">3</cn>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>p</ci>
      <cn type="integer">3</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \frac{\partial S}{\partial x_{3}}=\int\frac{\partial L}{\partial x_{3}}\,dx_{3%
}=\int\frac{dp_{3}}{dx_{3}}\,dx_{3}=p_{3}
  </annotation>
 </semantics>
</math>

</p>

<p>combining the equations for the components of momentum <strong>p</strong> results in</p>

<p>

<math display="block" id="Hamiltonian_optics:79">
 <semantics>
  <mrow>
   <mi>𝐩</mi>
   <mo>=</mo>
   <mrow>
    <mo>∇</mo>
    <mi>S</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>𝐩</ci>
    <apply>
     <ci>normal-∇</ci>
     <ci>S</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{p}=\nabla S
  </annotation>
 </semantics>
</math>

</p>

<p>Since <strong>p</strong> is a vector tangent to the light rays, surfaces <em>S</em>=Constant must be perpendicular to those light rays. These surfaces are called <a href="wavefront" title="wikilink">wavefronts</a>. Figure "rays and wavefronts" illustrates this relationship. Also shown is optical momentum <strong>p</strong>, tangent to a light ray and perpendicular to the wavefront.</p>

<p>Vector field 

<math display="inline" id="Hamiltonian_optics:80">
 <semantics>
  <mrow>
   <mi>𝐩</mi>
   <mo>=</mo>
   <mrow>
    <mo>∇</mo>
    <mi>S</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>𝐩</ci>
    <apply>
     <ci>normal-∇</ci>
     <ci>S</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{p}=\nabla S
  </annotation>
 </semantics>
</math>

 is <a href="conservative_vector_field" title="wikilink">conservative vector field</a>. The <a href="gradient_theorem" title="wikilink">gradient theorem</a> can then be applied to the optical path length (as given <a href="#Optical_momentum" title="wikilink">above</a>) resulting in</p>

<p>

<math display="block" id="Hamiltonian_optics:81">
 <semantics>
  <mrow>
   <mi>S</mi>
   <mo>=</mo>
   <mrow>
    <msubsup>
     <mo largeop="true" symmetric="true">∫</mo>
     <mi>𝐀</mi>
     <mi>𝐁</mi>
    </msubsup>
    <mrow>
     <mrow>
      <mi>𝐩</mi>
      <mo>⋅</mo>
      <mi>d</mi>
     </mrow>
     <mi>𝐬</mi>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <msubsup>
     <mo largeop="true" symmetric="true">∫</mo>
     <mi>𝐀</mi>
     <mi>𝐁</mi>
    </msubsup>
    <mrow>
     <mo>∇</mo>
     <mrow>
      <mrow>
       <mi>S</mi>
       <mo>⋅</mo>
       <mi>d</mi>
      </mrow>
      <mi>𝐬</mi>
     </mrow>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mi>S</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>𝐁</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>-</mo>
    <mrow>
     <mi>S</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>𝐀</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <ci>S</ci>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <int></int>
        <ci>𝐀</ci>
       </apply>
       <ci>𝐁</ci>
      </apply>
      <apply>
       <times></times>
       <apply>
        <ci>normal-⋅</ci>
        <ci>𝐩</ci>
        <ci>d</ci>
       </apply>
       <ci>𝐬</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <int></int>
        <ci>𝐀</ci>
       </apply>
       <ci>𝐁</ci>
      </apply>
      <apply>
       <ci>normal-∇</ci>
       <apply>
        <times></times>
        <apply>
         <ci>normal-⋅</ci>
         <ci>S</ci>
         <ci>d</ci>
        </apply>
        <ci>𝐬</ci>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <minus></minus>
      <apply>
       <times></times>
       <ci>S</ci>
       <ci>𝐁</ci>
      </apply>
      <apply>
       <times></times>
       <ci>S</ci>
       <ci>𝐀</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   S=\int_{\mathbf{A}}^{\mathbf{B}}\mathbf{p}\cdot d\mathbf{s}=\int_{\mathbf{A}}^%
{\mathbf{B}}\nabla S\cdot d\mathbf{s}=S(\mathbf{B})-S(\mathbf{A})
  </annotation>
 </semantics>
</math>

</p>

<p>and the optical path length <em>S</em> calculated along a curve <em>C</em> between points <strong>A</strong> and <strong>B</strong> is a function of only its end points <strong>A</strong> and <strong>B</strong> and not the shape of the curve between them. In particular, if the curve is closed, it starts and ends at the same point, or <strong>A</strong>=<strong>B</strong> so that</p>

<p>

<math display="block" id="Hamiltonian_optics:82">
 <semantics>
  <mrow>
   <mi>S</mi>
   <mo>=</mo>
   <mrow>
    <mo largeop="true" symmetric="true">∮</mo>
    <mrow>
     <mo>∇</mo>
     <mrow>
      <mrow>
       <mi>S</mi>
       <mo>⋅</mo>
       <mi>d</mi>
      </mrow>
      <mi>𝐬</mi>
     </mrow>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <ci>S</ci>
     <apply>
      <csymbol cd="latexml">contour-integral</csymbol>
      <apply>
       <ci>normal-∇</ci>
       <apply>
        <times></times>
        <apply>
         <ci>normal-⋅</ci>
         <ci>S</ci>
         <ci>d</ci>
        </apply>
        <ci>𝐬</ci>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <cn type="integer">0</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   S=\oint\nabla S\cdot d\mathbf{s}=0
  </annotation>
 </semantics>
</math>

</p>

<p>This result may be applied to a closed path <strong>ABCDA</strong> as in figure "optical path length"</p>

<p>

<math display="block" id="Hamiltonian_optics:83">
 <semantics>
  <mrow>
   <mi>S</mi>
   <mo>=</mo>
   <mrow>
    <mrow>
     <msubsup>
      <mo largeop="true" symmetric="true">∫</mo>
      <mi>𝐀</mi>
      <mi>𝐁</mi>
     </msubsup>
     <mrow>
      <mrow>
       <mi>𝐩</mi>
       <mo>⋅</mo>
       <mi>d</mi>
      </mrow>
      <mi>𝐬</mi>
     </mrow>
    </mrow>
    <mo>+</mo>
    <mrow>
     <msubsup>
      <mo largeop="true" symmetric="true">∫</mo>
      <mi>𝐁</mi>
      <mi>𝐂</mi>
     </msubsup>
     <mrow>
      <mrow>
       <mi>𝐩</mi>
       <mo>⋅</mo>
       <mi>d</mi>
      </mrow>
      <mi>𝐬</mi>
     </mrow>
    </mrow>
    <mo>+</mo>
    <mrow>
     <msubsup>
      <mo largeop="true" symmetric="true">∫</mo>
      <mi>𝐂</mi>
      <mi>𝐃</mi>
     </msubsup>
     <mrow>
      <mrow>
       <mi>𝐩</mi>
       <mo>⋅</mo>
       <mi>d</mi>
      </mrow>
      <mi>𝐬</mi>
     </mrow>
    </mrow>
    <mo>+</mo>
    <mrow>
     <msubsup>
      <mo largeop="true" symmetric="true">∫</mo>
      <mi>𝐃</mi>
      <mi>𝐀</mi>
     </msubsup>
     <mrow>
      <mrow>
       <mi>𝐩</mi>
       <mo>⋅</mo>
       <mi>d</mi>
      </mrow>
      <mi>𝐬</mi>
     </mrow>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <ci>S</ci>
     <apply>
      <plus></plus>
      <apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <int></int>
         <ci>𝐀</ci>
        </apply>
        <ci>𝐁</ci>
       </apply>
       <apply>
        <times></times>
        <apply>
         <ci>normal-⋅</ci>
         <ci>𝐩</ci>
         <ci>d</ci>
        </apply>
        <ci>𝐬</ci>
       </apply>
      </apply>
      <apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <int></int>
         <ci>𝐁</ci>
        </apply>
        <ci>𝐂</ci>
       </apply>
       <apply>
        <times></times>
        <apply>
         <ci>normal-⋅</ci>
         <ci>𝐩</ci>
         <ci>d</ci>
        </apply>
        <ci>𝐬</ci>
       </apply>
      </apply>
      <apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <int></int>
         <ci>𝐂</ci>
        </apply>
        <ci>𝐃</ci>
       </apply>
       <apply>
        <times></times>
        <apply>
         <ci>normal-⋅</ci>
         <ci>𝐩</ci>
         <ci>d</ci>
        </apply>
        <ci>𝐬</ci>
       </apply>
      </apply>
      <apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <int></int>
         <ci>𝐃</ci>
        </apply>
        <ci>𝐀</ci>
       </apply>
       <apply>
        <times></times>
        <apply>
         <ci>normal-⋅</ci>
         <ci>𝐩</ci>
         <ci>d</ci>
        </apply>
        <ci>𝐬</ci>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <cn type="integer">0</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   S=\int_{\mathbf{A}}^{\mathbf{B}}\mathbf{p}\cdot d\mathbf{s}+\int_{\mathbf{B}}^%
{\mathbf{C}}\mathbf{p}\cdot d\mathbf{s}+\int_{\mathbf{C}}^{\mathbf{D}}\mathbf{%
p}\cdot d\mathbf{s}+\int_{\mathbf{D}}^{\mathbf{A}}\mathbf{p}\cdot d\mathbf{s}=0
  </annotation>
 </semantics>
</math>

</p>
<figure><b>(Figure)</b>
<figcaption>Optical path length</figcaption>
</figure>

<p>for curve segment <strong>AB</strong> the optical momentum <strong>p</strong> is perpendicular to a displacement <em>d</em><strong>s</strong> along curve <strong>AB</strong>, or 

<math display="inline" id="Hamiltonian_optics:84">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>𝐩</mi>
     <mo>⋅</mo>
     <mi>d</mi>
    </mrow>
    <mi>𝐬</mi>
   </mrow>
   <mo>=</mo>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <ci>normal-⋅</ci>
      <ci>𝐩</ci>
      <ci>d</ci>
     </apply>
     <ci>𝐬</ci>
    </apply>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{p}\cdot d\mathbf{s}=0
  </annotation>
 </semantics>
</math>

. The same is true for segment <strong>CD</strong>. For segment <strong>BC</strong> the optical momentum <strong>p</strong> has the same direction as displacement <em>d</em><strong>s</strong> and 

<math display="inline" id="Hamiltonian_optics:85">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>𝐩</mi>
     <mo>⋅</mo>
     <mi>d</mi>
    </mrow>
    <mi>𝐬</mi>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mi>n</mi>
    <mi>d</mi>
    <mi>s</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <ci>normal-⋅</ci>
      <ci>𝐩</ci>
      <ci>d</ci>
     </apply>
     <ci>𝐬</ci>
    </apply>
    <apply>
     <times></times>
     <ci>n</ci>
     <ci>d</ci>
     <ci>s</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{p}\cdot d\mathbf{s}=nds
  </annotation>
 </semantics>
</math>

. For segment <strong>DA</strong> the optical momentum <strong>p</strong> has the opposite direction to displacement <em>d</em><strong>s</strong> and 

<math display="inline" id="Hamiltonian_optics:86">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>𝐩</mi>
     <mo>⋅</mo>
     <mi>d</mi>
    </mrow>
    <mi>𝐬</mi>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mo>-</mo>
    <mrow>
     <mpadded width="+1.7pt">
      <mi>n</mi>
     </mpadded>
     <mi>d</mi>
     <mi>s</mi>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <ci>normal-⋅</ci>
      <ci>𝐩</ci>
      <ci>d</ci>
     </apply>
     <ci>𝐬</ci>
    </apply>
    <apply>
     <minus></minus>
     <apply>
      <times></times>
      <ci>n</ci>
      <ci>d</ci>
      <ci>s</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{p}\cdot d\mathbf{s}=-n\,ds
  </annotation>
 </semantics>
</math>

. However inverting the direction of the integration so that the integral is taken from <strong>A</strong> to <strong>D</strong>, <em>d</em><strong>s</strong> inverts direction and 

<math display="inline" id="Hamiltonian_optics:87">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>𝐩</mi>
     <mo>⋅</mo>
     <mi>d</mi>
    </mrow>
    <mi>𝐬</mi>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mpadded width="+1.7pt">
     <mi>n</mi>
    </mpadded>
    <mi>d</mi>
    <mi>s</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <ci>normal-⋅</ci>
      <ci>𝐩</ci>
      <ci>d</ci>
     </apply>
     <ci>𝐬</ci>
    </apply>
    <apply>
     <times></times>
     <ci>n</ci>
     <ci>d</ci>
     <ci>s</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{p}\cdot d\mathbf{s}=n\,ds
  </annotation>
 </semantics>
</math>

. From these considerations</p>

<p>

<math display="block" id="Hamiltonian_optics:88">
 <semantics>
  <mrow>
   <mrow>
    <msubsup>
     <mo largeop="true" symmetric="true">∫</mo>
     <mi>𝐁</mi>
     <mi>𝐂</mi>
    </msubsup>
    <mrow>
     <mpadded width="+1.7pt">
      <mi>n</mi>
     </mpadded>
     <mi>d</mi>
     <mi>s</mi>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <msubsup>
     <mo largeop="true" symmetric="true">∫</mo>
     <mi>𝐀</mi>
     <mi>𝐃</mi>
    </msubsup>
    <mrow>
     <mpadded width="+1.7pt">
      <mi>n</mi>
     </mpadded>
     <mi>d</mi>
     <mi>s</mi>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <int></int>
       <ci>𝐁</ci>
      </apply>
      <ci>𝐂</ci>
     </apply>
     <apply>
      <times></times>
      <ci>n</ci>
      <ci>d</ci>
      <ci>s</ci>
     </apply>
    </apply>
    <apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <int></int>
       <ci>𝐀</ci>
      </apply>
      <ci>𝐃</ci>
     </apply>
     <apply>
      <times></times>
      <ci>n</ci>
      <ci>d</ci>
      <ci>s</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \int_{\mathbf{B}}^{\mathbf{C}}n\,ds=\int_{\mathbf{A}}^{\mathbf{D}}n\,ds
  </annotation>
 </semantics>
</math>

</p>

<p>or</p>

<p>

<math display="block" id="Hamiltonian_optics:89">
 <semantics>
  <mrow>
   <msub>
    <mi>S</mi>
    <mi>𝐁𝐂</mi>
   </msub>
   <mo>=</mo>
   <msub>
    <mi>S</mi>
    <mi>𝐀𝐃</mi>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>S</ci>
     <ci>𝐁𝐂</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>S</ci>
     <ci>𝐀𝐃</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   S_{\mathbf{BC}}=S_{\mathbf{AD}}
  </annotation>
 </semantics>
</math>

</p>

<p>and the optical path length <em>S</em><sub><strong>BC</strong></sub> between points <strong>B</strong> and <strong>C</strong> along the ray connecting them is the same as the optical path length <em>S</em><sub><strong>AD</strong></sub> between points <strong>A</strong> and <strong>D</strong> along the ray connecting them. The optical path length is constant between wavefronts.</p>
<h3 id="phase-space">Phase space</h3>

<p>Figure "2D phase space" shows at the top some light rays in a two-dimensional space. Here <em>x</em><sub>2</sub>=0 and <em>p</em><sub>2</sub>=0 so light travels on the plane <em>x</em><sub>1</sub><em>x</em><sub>3</sub> in directions of increasing <em>x</em><sub>3</sub> values. In this case 

<math display="inline" id="Hamiltonian_optics:90">
 <semantics>
  <mrow>
   <mrow>
    <msubsup>
     <mi>p</mi>
     <mn>1</mn>
     <mn>2</mn>
    </msubsup>
    <mo>+</mo>
    <msubsup>
     <mi>p</mi>
     <mn>3</mn>
     <mn>2</mn>
    </msubsup>
   </mrow>
   <mo>=</mo>
   <msup>
    <mi>n</mi>
    <mn>2</mn>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <plus></plus>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>p</ci>
       <cn type="integer">1</cn>
      </apply>
      <cn type="integer">2</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>p</ci>
       <cn type="integer">3</cn>
      </apply>
      <cn type="integer">2</cn>
     </apply>
    </apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>n</ci>
     <cn type="integer">2</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p_{1}^{2}+p_{3}^{2}=n^{2}
  </annotation>
 </semantics>
</math>

 and the direction of a light ray is completely specified by the <em>p</em><sub>1</sub> component of momentum 

<math display="inline" id="Hamiltonian_optics:91">
 <semantics>
  <mrow>
   <mi>𝐩</mi>
   <mo>=</mo>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>p</mi>
     <mn>1</mn>
    </msub>
    <mo>,</mo>
    <msub>
     <mi>p</mi>
     <mn>3</mn>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>𝐩</ci>
    <interval closure="open">
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>p</ci>
      <cn type="integer">1</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>p</ci>
      <cn type="integer">3</cn>
     </apply>
    </interval>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{p}=(p_{1},p_{3})
  </annotation>
 </semantics>
</math>

 since <em>p</em><sub>2</sub>=0. If <em>p</em><sub>1</sub> is given, <em>p</em><sub>3</sub> may be calculated (given the value of the refractive index <em>n</em>) and therefore <em>p</em><sub>1</sub> suffices to determine the direction of the light ray. The refractive index of the medium the ray is traveling in is determined by 

<math display="inline" id="Hamiltonian_optics:92">
 <semantics>
  <mrow>
   <mrow>
    <mo>∥</mo>
    <mi>𝐩</mi>
    <mo>∥</mo>
   </mrow>
   <mo>=</mo>
   <mi>n</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="latexml">norm</csymbol>
     <ci>𝐩</ci>
    </apply>
    <ci>n</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \|\mathbf{p}\|=n
  </annotation>
 </semantics>
</math>

.</p>
<figure><b>(Figure)</b>
<figcaption>2D phase space</figcaption>
</figure>

<p>For example, ray <em>r</em><sub><em>C</em></sub> crosses axis <em>x</em><sub>1</sub> at coordinate <em>x</em><sub><em>B</em></sub> with an optical momentum <strong>p</strong><sub><em>C</em></sub>, which has its tip on a circle of radius <em>n</em> centered at position <em>x</em><sub><em>B</em></sub>. Coordinate <em>x</em><sub><em>B</em></sub> and the horizontal coordinate <em>p</em><sub>1<em>C</em></sub> of momentum <strong>p</strong><sub><em>C</em></sub> completely define ray <em>r</em><sub><em>C</em></sub> as it crosses axis <em>x</em><sub>1</sub>. This ray may then be defined by a point <em>r</em><sub><em>C</em></sub>=(<em>x</em><sub><em>B</em></sub>,<em>p</em><sub>1<em>C</em></sub>) in space <em>x</em><sub>1</sub><em>p</em><sub>1</sub> as shown at the bottom of the figure. Space <em>x</em><sub>1</sub><em>p</em><sub>1</sub> is called <a href="phase_space" title="wikilink">phase space</a> and different light rays may be represented by different points in this space.</p>

<p>As such, ray <em>r</em><sub><em>D</em></sub> shown at the top is represented by a point <em>r</em><sub><em>D</em></sub> in phase space at the bottom. All rays crossing axis <em>x</em><sub>1</sub> at coordinate <em>x</em><sub><em>B</em></sub> contained between rays <em>r</em><sub><em>C</em></sub> and <em>r</em><sub><em>D</em></sub> are represented by a vertical line connecting points <em>r</em><sub><em>C</em></sub> and <em>r</em><sub><em>D</em></sub> in phase space. Accordingly, all rays crossing axis <em>x</em><sub>1</sub> at coordinate <em>x</em><sub><em>A</em></sub> contained between rays <em>r</em><sub><em>A</em></sub> and <em>r</em><sub><em>B</em></sub> are represented by a vertical line connecting points <em>r</em><sub><em>A</em></sub> and <em>r</em><sub><em>B</em></sub> in phase space. In general, all rays crossing axis <em>x</em><sub>1</sub> between <em>x</em><sub><em>L</em></sub> and <em>x</em><sub><em>R</em></sub> are represented by a volume <em>R</em> in phase space. The rays at the boundary ∂<em>R</em> of volume <em>R</em> are called edge rays. For example, at position <em>x</em><sub><em>A</em></sub> of axis <em>x</em><sub>1</sub>, rays <em>r</em><sub><em>A</em></sub> and <em>r</em><sub><em>B</em></sub> are the edge rays since all other rays are contained between these two.</p>

<p>In three-dimensional geometry the optical momentum is given by 

<math display="inline" id="Hamiltonian_optics:93">
 <semantics>
  <mrow>
   <mi>𝐩</mi>
   <mo>=</mo>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>p</mi>
     <mn>1</mn>
    </msub>
    <mo>,</mo>
    <msub>
     <mi>p</mi>
     <mn>2</mn>
    </msub>
    <mo>,</mo>
    <msub>
     <mi>p</mi>
     <mn>3</mn>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>𝐩</ci>
    <vector>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>p</ci>
      <cn type="integer">1</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>p</ci>
      <cn type="integer">2</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>p</ci>
      <cn type="integer">3</cn>
     </apply>
    </vector>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{p}=(p_{1},p_{2},p_{3})
  </annotation>
 </semantics>
</math>


 with 

<math display="inline" id="Hamiltonian_optics:94">
 <semantics>
  <mrow>
   <mrow>
    <msubsup>
     <mi>p</mi>
     <mn>1</mn>
     <mn>2</mn>
    </msubsup>
    <mo>+</mo>
    <msubsup>
     <mi>p</mi>
     <mn>2</mn>
     <mn>2</mn>
    </msubsup>
    <mo>+</mo>
    <msubsup>
     <mi>p</mi>
     <mn>3</mn>
     <mn>2</mn>
    </msubsup>
   </mrow>
   <mo>=</mo>
   <msup>
    <mi>n</mi>
    <mn>2</mn>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <plus></plus>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>p</ci>
       <cn type="integer">1</cn>
      </apply>
      <cn type="integer">2</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>p</ci>
       <cn type="integer">2</cn>
      </apply>
      <cn type="integer">2</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>p</ci>
       <cn type="integer">3</cn>
      </apply>
      <cn type="integer">2</cn>
     </apply>
    </apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>n</ci>
     <cn type="integer">2</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p_{1}^{2}+p_{2}^{2}+p_{3}^{2}=n^{2}
  </annotation>
 </semantics>
</math>

. If <em>p</em><sub>1</sub> and <em>p</em><sub>2</sub> are given, <em>p</em><sub>3</sub> may be calculated (given the value of the refractive index <em>n</em>) and therefore <em>p</em><sub>1</sub> and <em>p</em><sub>2</sub> suffice to determine the direction of the light ray. A ray traveling along axis <em>x</em><sub>3</sub> is then defined by a point (<em>x</em><sub>1</sub>,<em>x</em><sub>2</sub>) in plane <em>x</em><sub>1</sub><em>x</em><sub>2</sub> and a direction (<em>p</em><sub>1</sub>,<em>p</em><sub>2</sub>). It may then be defined by a point in four-dimensional <a href="phase_space" title="wikilink">phase space</a> <em>x</em><sub>1</sub><em>x</em><sub>2</sub><em>p</em><sub>1</sub><em>p</em><sub>2</sub>.</p>
<h3 id="conservation-of-etendue">Conservation of etendue</h3>

<p>Figure "volume variation" shows a volume <em>V</em> bound by an area <em>A</em>. Over time, if the boundary <em>A</em> moves, the volume of <em>V</em> may vary. In particular, an infinitesimal area <em>dA</em> with outward pointing unit normal <strong>n</strong> moves with a velocity <strong>v</strong>.</p>
<figure><b>(Figure)</b>
<figcaption>Volume variation</figcaption>
</figure>

<p>This leads to a volume variation 

<math display="inline" id="Hamiltonian_optics:95">
 <semantics>
  <mrow>
   <mrow>
    <mi>d</mi>
    <mi>V</mi>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mi>d</mi>
    <mi>A</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>𝐯</mi>
      <mo>⋅</mo>
      <mi>𝐧</mi>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
    <mi>d</mi>
    <mi>t</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>d</ci>
     <ci>V</ci>
    </apply>
    <apply>
     <times></times>
     <ci>d</ci>
     <ci>A</ci>
     <apply>
      <ci>normal-⋅</ci>
      <ci>𝐯</ci>
      <ci>𝐧</ci>
     </apply>
     <ci>d</ci>
     <ci>t</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   dV=dA(\mathbf{v}\cdot\mathbf{n})dt
  </annotation>
 </semantics>
</math>

. Making use of <a href="Gauss's_theorem" title="wikilink">Gauss's theorem</a>, the variation in time of the total volume <em>V</em> volume moving in space is</p>

<p>

<math display="block" id="Hamiltonian_optics:96">
 <semantics>
  <mrow>
   <mfrac>
    <mrow>
     <mi>d</mi>
     <mi>V</mi>
    </mrow>
    <mrow>
     <mi>d</mi>
     <mi>t</mi>
    </mrow>
   </mfrac>
   <mo>=</mo>
   <mrow>
    <msub>
     <mo largeop="true" symmetric="true">∫</mo>
     <mi>A</mi>
    </msub>
    <mrow>
     <mrow>
      <mi>𝐯</mi>
      <mo>⋅</mo>
      <mpadded width="+1.7pt">
       <mi>𝐧</mi>
      </mpadded>
     </mrow>
     <mi>d</mi>
     <mi>A</mi>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <msub>
     <mo largeop="true" symmetric="true">∫</mo>
     <mi>V</mi>
    </msub>
    <mrow>
     <mrow>
      <mo>∇</mo>
      <mo>⋅</mo>
      <mpadded width="+1.7pt">
       <mi>𝐯</mi>
      </mpadded>
     </mrow>
     <mi>d</mi>
     <mi>V</mi>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <divide></divide>
      <apply>
       <times></times>
       <ci>d</ci>
       <ci>V</ci>
      </apply>
      <apply>
       <times></times>
       <ci>d</ci>
       <ci>t</ci>
      </apply>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <int></int>
       <ci>A</ci>
      </apply>
      <apply>
       <times></times>
       <apply>
        <ci>normal-⋅</ci>
        <ci>𝐯</ci>
        <ci>𝐧</ci>
       </apply>
       <ci>d</ci>
       <ci>A</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <int></int>
       <ci>V</ci>
      </apply>
      <apply>
       <times></times>
       <apply>
        <ci>normal-⋅</ci>
        <ci>normal-∇</ci>
        <ci>𝐯</ci>
       </apply>
       <ci>d</ci>
       <ci>V</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \frac{dV}{dt}=\int_{A}\mathbf{v}\cdot\mathbf{n}\,dA=\int_{V}\nabla\cdot\mathbf%
{v}\,dV
  </annotation>
 </semantics>
</math>

</p>

<p>The rightmost term is a <a href="volume_integral" title="wikilink">volume integral</a> over the volume <em>V</em> and the middle term is the <a href="surface_integral" title="wikilink">surface integral</a> over the boundary <em>A</em> of the volume <em>V</em>. Also, <strong>v</strong> is the velocity with which the points in <em>V</em> are moving.</p>

<p>In optics coordinate 

<math display="inline" id="Hamiltonian_optics:97">
 <semantics>
  <msub>
   <mi>x</mi>
   <mn>3</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>x</ci>
    <cn type="integer">3</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x_{3}
  </annotation>
 </semantics>
</math>

 takes the role of time. In phase space a light ray is identified by a point 

<math display="inline" id="Hamiltonian_optics:98">
 <semantics>
  <mrow>
   <mo stretchy="false">(</mo>
   <msub>
    <mi>x</mi>
    <mn>1</mn>
   </msub>
   <mo>,</mo>
   <msub>
    <mi>x</mi>
    <mn>2</mn>
   </msub>
   <mo>,</mo>
   <msub>
    <mi>p</mi>
    <mn>1</mn>
   </msub>
   <mo>,</mo>
   <msub>
    <mi>p</mi>
    <mn>2</mn>
   </msub>
   <mo stretchy="false">)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <vector>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>x</ci>
     <cn type="integer">1</cn>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>x</ci>
     <cn type="integer">2</cn>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>p</ci>
     <cn type="integer">1</cn>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>p</ci>
     <cn type="integer">2</cn>
    </apply>
   </vector>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (x_{1},x_{2},p_{1},p_{2})
  </annotation>
 </semantics>
</math>


 which moves with a "<a class="uri" href="velocity" title="wikilink">velocity</a>" 

<math display="inline" id="Hamiltonian_optics:99">
 <semantics>
  <mrow>
   <mi>𝐯</mi>
   <mo>=</mo>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mover accent="true">
      <mi>x</mi>
      <mo>˙</mo>
     </mover>
     <mn>1</mn>
    </msub>
    <mo>,</mo>
    <msub>
     <mover accent="true">
      <mi>x</mi>
      <mo>˙</mo>
     </mover>
     <mn>2</mn>
    </msub>
    <mo>,</mo>
    <msub>
     <mover accent="true">
      <mi>p</mi>
      <mo>˙</mo>
     </mover>
     <mn>1</mn>
    </msub>
    <mo>,</mo>
    <msub>
     <mover accent="true">
      <mi>p</mi>
      <mo>˙</mo>
     </mover>
     <mn>2</mn>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>𝐯</ci>
    <vector>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <ci>normal-˙</ci>
       <ci>x</ci>
      </apply>
      <cn type="integer">1</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <ci>normal-˙</ci>
       <ci>x</ci>
      </apply>
      <cn type="integer">2</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <ci>normal-˙</ci>
       <ci>p</ci>
      </apply>
      <cn type="integer">1</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <ci>normal-˙</ci>
       <ci>p</ci>
      </apply>
      <cn type="integer">2</cn>
     </apply>
    </vector>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{v}=(\dot{x}_{1},\dot{x}_{2},\dot{p}_{1},\dot{p}_{2})
  </annotation>
 </semantics>
</math>

 where the dot represents a derivative relative to 

<math display="inline" id="Hamiltonian_optics:100">
 <semantics>
  <msub>
   <mi>x</mi>
   <mn>3</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>x</ci>
    <cn type="integer">3</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x_{3}
  </annotation>
 </semantics>
</math>

. A set of light rays spreading over 

<math display="inline" id="Hamiltonian_optics:101">
 <semantics>
  <mrow>
   <mi>d</mi>
   <msub>
    <mi>x</mi>
    <mn>1</mn>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>d</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>x</ci>
     <cn type="integer">1</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   dx_{1}
  </annotation>
 </semantics>
</math>

 in coordinate 

<math display="inline" id="Hamiltonian_optics:102">
 <semantics>
  <msub>
   <mi>x</mi>
   <mn>1</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>x</ci>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x_{1}
  </annotation>
 </semantics>
</math>

, 

<math display="inline" id="Hamiltonian_optics:103">
 <semantics>
  <mrow>
   <mi>d</mi>
   <msub>
    <mi>x</mi>
    <mn>2</mn>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>d</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>x</ci>
     <cn type="integer">2</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   dx_{2}
  </annotation>
 </semantics>
</math>


 in coordinate 

<math display="inline" id="Hamiltonian_optics:104">
 <semantics>
  <msub>
   <mi>x</mi>
   <mn>2</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>x</ci>
    <cn type="integer">2</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x_{2}
  </annotation>
 </semantics>
</math>

, 

<math display="inline" id="Hamiltonian_optics:105">
 <semantics>
  <mrow>
   <mi>d</mi>
   <msub>
    <mi>p</mi>
    <mn>1</mn>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>d</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>p</ci>
     <cn type="integer">1</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   dp_{1}
  </annotation>
 </semantics>
</math>

 in coordinate 

<math display="inline" id="Hamiltonian_optics:106">
 <semantics>
  <msub>
   <mi>p</mi>
   <mn>1</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>p</ci>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p_{1}
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Hamiltonian_optics:107">
 <semantics>
  <mrow>
   <mi>d</mi>
   <msub>
    <mi>p</mi>
    <mn>2</mn>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>d</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>p</ci>
     <cn type="integer">2</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   dp_{2}
  </annotation>
 </semantics>
</math>

 in coordinate 

<math display="inline" id="Hamiltonian_optics:108">
 <semantics>
  <msub>
   <mi>p</mi>
   <mn>2</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>p</ci>
    <cn type="integer">2</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p_{2}
  </annotation>
 </semantics>
</math>


 occupies a volume 

<math display="inline" id="Hamiltonian_optics:109">
 <semantics>
  <mrow>
   <mrow>
    <mi>d</mi>
    <mi>V</mi>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mi>d</mi>
    <msub>
     <mi>x</mi>
     <mn>1</mn>
    </msub>
    <mi>d</mi>
    <msub>
     <mi>x</mi>
     <mn>2</mn>
    </msub>
    <mi>d</mi>
    <msub>
     <mi>p</mi>
     <mn>1</mn>
    </msub>
    <mi>d</mi>
    <msub>
     <mi>p</mi>
     <mn>2</mn>
    </msub>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>d</ci>
     <ci>V</ci>
    </apply>
    <apply>
     <times></times>
     <ci>d</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <cn type="integer">1</cn>
     </apply>
     <ci>d</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <cn type="integer">2</cn>
     </apply>
     <ci>d</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>p</ci>
      <cn type="integer">1</cn>
     </apply>
     <ci>d</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>p</ci>
      <cn type="integer">2</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   dV=dx_{1}dx_{2}dp_{1}dp_{2}
  </annotation>
 </semantics>
</math>

 in phase space. In general, a large set of rays occupies a large volume 

<math display="inline" id="Hamiltonian_optics:110">
 <semantics>
  <mi>V</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>V</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   V
  </annotation>
 </semantics>
</math>

 in phase space to which <a href="Gauss's_theorem" title="wikilink">Gauss's theorem</a> may be applied</p>

<p>

<math display="block" id="Hamiltonian_optics:111">
 <semantics>
  <mrow>
   <mfrac>
    <mrow>
     <mi>d</mi>
     <mi>V</mi>
    </mrow>
    <mrow>
     <mi>d</mi>
     <msub>
      <mi>x</mi>
      <mn>3</mn>
     </msub>
    </mrow>
   </mfrac>
   <mo>=</mo>
   <mrow>
    <msub>
     <mo largeop="true" symmetric="true">∫</mo>
     <mi>V</mi>
    </msub>
    <mrow>
     <mrow>
      <mo>∇</mo>
      <mo>⋅</mo>
      <mpadded width="+1.7pt">
       <mi>𝐯</mi>
      </mpadded>
     </mrow>
     <mi>d</mi>
     <mi>V</mi>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <divide></divide>
     <apply>
      <times></times>
      <ci>d</ci>
      <ci>V</ci>
     </apply>
     <apply>
      <times></times>
      <ci>d</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <cn type="integer">3</cn>
      </apply>
     </apply>
    </apply>
    <apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <int></int>
      <ci>V</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <ci>normal-⋅</ci>
       <ci>normal-∇</ci>
       <ci>𝐯</ci>
      </apply>
      <ci>d</ci>
      <ci>V</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \frac{dV}{dx_{3}}=\int_{V}\nabla\cdot\mathbf{v}\,dV
  </annotation>
 </semantics>
</math>

</p>

<p>and using <a href="#Hamilton's_equations" title="wikilink">Hamilton's equations</a></p>

<p>

<math display="block" id="Hamiltonian_optics:112">
 <semantics>
  <mrow>
   <mrow>
    <mo>∇</mo>
    <mo>⋅</mo>
    <mi>𝐯</mi>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mfrac>
     <mrow>
      <mo>∂</mo>
      <msub>
       <mover accent="true">
        <mi>x</mi>
        <mo>˙</mo>
       </mover>
       <mn>1</mn>
      </msub>
     </mrow>
     <mrow>
      <mo>∂</mo>
      <msub>
       <mi>x</mi>
       <mn>1</mn>
      </msub>
     </mrow>
    </mfrac>
    <mo>+</mo>
    <mfrac>
     <mrow>
      <mo>∂</mo>
      <msub>
       <mover accent="true">
        <mi>x</mi>
        <mo>˙</mo>
       </mover>
       <mn>2</mn>
      </msub>
     </mrow>
     <mrow>
      <mo>∂</mo>
      <msub>
       <mi>x</mi>
       <mn>2</mn>
      </msub>
     </mrow>
    </mfrac>
    <mo>+</mo>
    <mfrac>
     <mrow>
      <mo>∂</mo>
      <msub>
       <mover accent="true">
        <mi>p</mi>
        <mo>˙</mo>
       </mover>
       <mn>1</mn>
      </msub>
     </mrow>
     <mrow>
      <mo>∂</mo>
      <msub>
       <mi>p</mi>
       <mn>1</mn>
      </msub>
     </mrow>
    </mfrac>
    <mo>+</mo>
    <mfrac>
     <mrow>
      <mo>∂</mo>
      <msub>
       <mover accent="true">
        <mi>p</mi>
        <mo>˙</mo>
       </mover>
       <mn>2</mn>
      </msub>
     </mrow>
     <mrow>
      <mo>∂</mo>
      <msub>
       <mi>p</mi>
       <mn>2</mn>
      </msub>
     </mrow>
    </mfrac>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mrow>
      <mfrac>
       <mo>∂</mo>
       <mrow>
        <mo>∂</mo>
        <msub>
         <mi>x</mi>
         <mn>1</mn>
        </msub>
       </mrow>
      </mfrac>
      <mfrac>
       <mrow>
        <mo>∂</mo>
        <mi>H</mi>
       </mrow>
       <mrow>
        <mo>∂</mo>
        <msub>
         <mi>p</mi>
         <mn>1</mn>
        </msub>
       </mrow>
      </mfrac>
     </mrow>
     <mo>+</mo>
     <mrow>
      <mfrac>
       <mo>∂</mo>
       <mrow>
        <mo>∂</mo>
        <msub>
         <mi>x</mi>
         <mn>2</mn>
        </msub>
       </mrow>
      </mfrac>
      <mfrac>
       <mrow>
        <mo>∂</mo>
        <mi>H</mi>
       </mrow>
       <mrow>
        <mo>∂</mo>
        <msub>
         <mi>p</mi>
         <mn>2</mn>
        </msub>
       </mrow>
      </mfrac>
     </mrow>
    </mrow>
    <mo>-</mo>
    <mrow>
     <mfrac>
      <mo>∂</mo>
      <mrow>
       <mo>∂</mo>
       <msub>
        <mi>p</mi>
        <mn>1</mn>
       </msub>
      </mrow>
     </mfrac>
     <mfrac>
      <mrow>
       <mo>∂</mo>
       <mi>H</mi>
      </mrow>
      <mrow>
       <mo>∂</mo>
       <msub>
        <mi>x</mi>
        <mn>1</mn>
       </msub>
      </mrow>
     </mfrac>
    </mrow>
    <mo>-</mo>
    <mrow>
     <mfrac>
      <mo>∂</mo>
      <mrow>
       <mo>∂</mo>
       <msub>
        <mi>p</mi>
        <mn>2</mn>
       </msub>
      </mrow>
     </mfrac>
     <mfrac>
      <mrow>
       <mo>∂</mo>
       <mi>H</mi>
      </mrow>
      <mrow>
       <mo>∂</mo>
       <msub>
        <mi>x</mi>
        <mn>2</mn>
       </msub>
      </mrow>
     </mfrac>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <ci>normal-⋅</ci>
      <ci>normal-∇</ci>
      <ci>𝐯</ci>
     </apply>
     <apply>
      <plus></plus>
      <apply>
       <divide></divide>
       <apply>
        <partialdiff></partialdiff>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <apply>
          <ci>normal-˙</ci>
          <ci>x</ci>
         </apply>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <apply>
        <partialdiff></partialdiff>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>x</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
      </apply>
      <apply>
       <divide></divide>
       <apply>
        <partialdiff></partialdiff>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <apply>
          <ci>normal-˙</ci>
          <ci>x</ci>
         </apply>
         <cn type="integer">2</cn>
        </apply>
       </apply>
       <apply>
        <partialdiff></partialdiff>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>x</ci>
         <cn type="integer">2</cn>
        </apply>
       </apply>
      </apply>
      <apply>
       <divide></divide>
       <apply>
        <partialdiff></partialdiff>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <apply>
          <ci>normal-˙</ci>
          <ci>p</ci>
         </apply>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <apply>
        <partialdiff></partialdiff>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>p</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
      </apply>
      <apply>
       <divide></divide>
       <apply>
        <partialdiff></partialdiff>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <apply>
          <ci>normal-˙</ci>
          <ci>p</ci>
         </apply>
         <cn type="integer">2</cn>
        </apply>
       </apply>
       <apply>
        <partialdiff></partialdiff>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>p</ci>
         <cn type="integer">2</cn>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <minus></minus>
      <apply>
       <plus></plus>
       <apply>
        <times></times>
        <apply>
         <divide></divide>
         <partialdiff></partialdiff>
         <apply>
          <partialdiff></partialdiff>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>x</ci>
           <cn type="integer">1</cn>
          </apply>
         </apply>
        </apply>
        <apply>
         <divide></divide>
         <apply>
          <partialdiff></partialdiff>
          <ci>H</ci>
         </apply>
         <apply>
          <partialdiff></partialdiff>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>p</ci>
           <cn type="integer">1</cn>
          </apply>
         </apply>
        </apply>
       </apply>
       <apply>
        <times></times>
        <apply>
         <divide></divide>
         <partialdiff></partialdiff>
         <apply>
          <partialdiff></partialdiff>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>x</ci>
           <cn type="integer">2</cn>
          </apply>
         </apply>
        </apply>
        <apply>
         <divide></divide>
         <apply>
          <partialdiff></partialdiff>
          <ci>H</ci>
         </apply>
         <apply>
          <partialdiff></partialdiff>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>p</ci>
           <cn type="integer">2</cn>
          </apply>
         </apply>
        </apply>
       </apply>
      </apply>
      <apply>
       <times></times>
       <apply>
        <divide></divide>
        <partialdiff></partialdiff>
        <apply>
         <partialdiff></partialdiff>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>p</ci>
          <cn type="integer">1</cn>
         </apply>
        </apply>
       </apply>
       <apply>
        <divide></divide>
        <apply>
         <partialdiff></partialdiff>
         <ci>H</ci>
        </apply>
        <apply>
         <partialdiff></partialdiff>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>x</ci>
          <cn type="integer">1</cn>
         </apply>
        </apply>
       </apply>
      </apply>
      <apply>
       <times></times>
       <apply>
        <divide></divide>
        <partialdiff></partialdiff>
        <apply>
         <partialdiff></partialdiff>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>p</ci>
          <cn type="integer">2</cn>
         </apply>
        </apply>
       </apply>
       <apply>
        <divide></divide>
        <apply>
         <partialdiff></partialdiff>
         <ci>H</ci>
        </apply>
        <apply>
         <partialdiff></partialdiff>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>x</ci>
          <cn type="integer">2</cn>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <cn type="integer">0</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \nabla\cdot\mathbf{v}=\frac{\partial\dot{x}_{1}}{\partial x_{1}}+\frac{%
\partial\dot{x}_{2}}{\partial x_{2}}+\frac{\partial\dot{p}_{1}}{\partial p_{1}%
}+\frac{\partial\dot{p}_{2}}{\partial p_{2}}=\frac{\partial}{\partial x_{1}}%
\frac{\partial H}{\partial p_{1}}+\frac{\partial}{\partial x_{2}}\frac{%
\partial H}{\partial p_{2}}-\frac{\partial}{\partial p_{1}}\frac{\partial H}{%
\partial x_{1}}-\frac{\partial}{\partial p_{2}}\frac{\partial H}{\partial x_{2%
}}=0
  </annotation>
 </semantics>
</math>

</p>

<p>or 

<math display="inline" id="Hamiltonian_optics:113">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mrow>
      <mi>d</mi>
      <mi>V</mi>
     </mrow>
     <mo>/</mo>
     <mi>d</mi>
    </mrow>
    <msub>
     <mi>x</mi>
     <mn>3</mn>
    </msub>
   </mrow>
   <mo>=</mo>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <divide></divide>
      <apply>
       <times></times>
       <ci>d</ci>
       <ci>V</ci>
      </apply>
      <ci>d</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <cn type="integer">3</cn>
     </apply>
    </apply>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   dV/dx_{3}=0
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Hamiltonian_optics:114">
 <semantics>
  <mrow>
   <mrow>
    <mi>d</mi>
    <mi>V</mi>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mi>d</mi>
    <msub>
     <mi>x</mi>
     <mn>1</mn>
    </msub>
    <mi>d</mi>
    <msub>
     <mi>x</mi>
     <mn>2</mn>
    </msub>
    <mi>d</mi>
    <msub>
     <mi>p</mi>
     <mn>1</mn>
    </msub>
    <mi>d</mi>
    <msub>
     <mi>p</mi>
     <mn>2</mn>
    </msub>
   </mrow>
   <mo>=</mo>
   <mtext>Constant</mtext>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <times></times>
      <ci>d</ci>
      <ci>V</ci>
     </apply>
     <apply>
      <times></times>
      <ci>d</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <cn type="integer">1</cn>
      </apply>
      <ci>d</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <cn type="integer">2</cn>
      </apply>
      <ci>d</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>p</ci>
       <cn type="integer">1</cn>
      </apply>
      <ci>d</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>p</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <mtext>Constant</mtext>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   dV=dx_{1}dx_{2}dp_{1}dp_{2}=\text{Constant}
  </annotation>
 </semantics>
</math>

 which means that the phase space volume is conserved as light travels along an optical system.</p>

<p>The volume occupied by a set of rays in phase space is called <a class="uri" href="etendue" title="wikilink">etendue</a>, which is conserved as light rays progress in the optical system along direction <em>x</em><sub>3</sub>. This corresponds to <a href="Liouville's_theorem_(Hamiltonian)" title="wikilink">Liouville's theorem</a>, which also applies to <a href="Hamiltonian_mechanics" title="wikilink">Hamiltonian mechanics</a>. <mtpl></mtpl></p>
<h3 id="imaging-and-nonimaging-optics">Imaging and nonimaging optics</h3>

<p>Figure "conservation of etendue" shows on the left a diagrammatic two-dimensional optical system in which <em>x</em><sub>2</sub>=0 and <em>p</em><sub>2</sub>=0 so light travels on the plane <em>x</em><sub>1</sub><em>x</em><sub>3</sub> in directions of increasing <em>x</em><sub>3</sub> values.</p>
<figure><b>(Figure)</b>
<figcaption>Conservation of etendue</figcaption>
</figure>

<p>Light rays crossing the input aperture of the optic at point <em>x</em><sub>1</sub>=<em>x</em><sub><em>I</em></sub> are contained between edge rays <em>r</em><sub><em>A</em></sub> and <em>r</em><sub><em>B</em></sub> represented by a vertical line between points <em>r</em><sub><em>A</em></sub> and <em>r</em><sub><em>B</em></sub> at the phase space of the input aperture (right, bottom corner of the figure). All rays crossing the input aperture are represented in phase space by a region <em>R</em><sub><em>I</em></sub>.</p>

<p>Also, light rays crossing the output aperture of the optic at point <em>x</em><sub>1</sub>=<em>x</em><sub><em>O</em></sub> are contained between edge rays <em>r</em><sub><em>A</em></sub> and <em>r</em><sub><em>B</em></sub> represented by a vertical line between points <em>r</em><sub><em>A</em></sub> and <em>r</em><sub><em>B</em></sub> at the phase space of the output aperture (right, top corner of the figure). All rays crossing the output aperture are represented in phase space by a region <em>R</em><sub><em>O</em></sub>.</p>

<p>Conservation of etendue in the optical system means that the volume (or area in this two-dimensional case) in phase space occupied by <em>R</em><sub><em>I</em></sub> at the input aperture must be the same as the volume in phase space occupied by <em>R</em><sub><em>O</em></sub> at the output aperture.</p>

<p>In imaging optics, all light rays crossing the input aperture at <em>x</em><sub>1</sub>=<em>x</em><sub><em>I</em></sub> are redirected by it towards the output aperture at <em>x</em><sub>1</sub>=<em>x</em><sub><em>O</em></sub> where <em>x</em><sub><em>I</em></sub>=<em>m x</em><sub><em>O</em></sub>. This ensures that an image of the input of formed at the output with a magnification <em>m</em>. In phase space, this means that vertical lines in the phase space at the input are transformed into vertical lines at the output. That would be the case of vertical line <em>r</em><sub><em>A</em></sub> <em>r</em><sub><em>B</em></sub> in <em>R</em><sub><em>I</em></sub> transformed to vertical line <em>r</em><sub><em>A</em></sub> <em>r</em><sub><em>B</em></sub> in <em>R</em><sub><em>O</em></sub>.</p>

<p>In <a href="nonimaging_optics" title="wikilink">nonimaging optics</a>, the goal is not to form an image but simply to transfer all light from the input aperture to the output aperture. This is accomplished by transforming the edge rays ∂<em>R</em><sub><em>I</em></sub> of <em>R</em><sub><em>I</em></sub> to edge rays ∂<em>R</em><sub><em>O</em></sub> of <em>R</em><sub><em>O</em></sub>. This is known as the <a href="Nonimaging_optics#Edge_ray_principle" title="wikilink">edge ray principle</a>.</p>
<h2 id="generalizations">Generalizations</h2>

<p>Above it was assumed that light travels along the <em>x</em><sub>3</sub> axis, in <a href="#Hamilton's_principle" title="wikilink">Hamilton's principle</a> above, coordinates 

<math display="inline" id="Hamiltonian_optics:115">
 <semantics>
  <msub>
   <mi>x</mi>
   <mn>1</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>x</ci>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x_{1}
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Hamiltonian_optics:116">
 <semantics>
  <msub>
   <mi>x</mi>
   <mn>2</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>x</ci>
    <cn type="integer">2</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x_{2}
  </annotation>
 </semantics>
</math>

 take the role of the generalized coordinates 

<math display="inline" id="Hamiltonian_optics:117">
 <semantics>
  <msub>
   <mi>q</mi>
   <mi>k</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>q</ci>
    <ci>k</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   q_{k}
  </annotation>
 </semantics>
</math>

 while 

<math display="inline" id="Hamiltonian_optics:118">
 <semantics>
  <msub>
   <mi>x</mi>
   <mn>3</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>x</ci>
    <cn type="integer">3</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x_{3}
  </annotation>
 </semantics>
</math>

 takes the role of parameter 

<math display="inline" id="Hamiltonian_optics:119">
 <semantics>
  <mi>σ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>σ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \sigma
  </annotation>
 </semantics>
</math>

, that is, parameter <em>σ</em> =<em>x</em><sub>3</sub> and <em>N</em>=2. However, different parametrizations of the light rays are possible, as well as the use of <a href="generalized_coordinates" title="wikilink">generalized coordinates</a>.</p>
<h3 id="general-ray-parametrization">General ray parametrization</h3>

<p>A more general situation can be considered in which the path of a light ray is parametrized as 

<math display="inline" id="Hamiltonian_optics:120">
 <semantics>
  <mrow>
   <mi>s</mi>
   <mo>=</mo>
   <mrow>
    <mo>(</mo>
    <mrow>
     <msub>
      <mi>x</mi>
      <mn>1</mn>
     </msub>
     <mrow>
      <mo>(</mo>
      <mi>σ</mi>
      <mo>)</mo>
     </mrow>
    </mrow>
    <mo>,</mo>
    <mrow>
     <msub>
      <mi>x</mi>
      <mn>2</mn>
     </msub>
     <mrow>
      <mo>(</mo>
      <mi>σ</mi>
      <mo>)</mo>
     </mrow>
    </mrow>
    <mo>,</mo>
    <mrow>
     <msub>
      <mi>x</mi>
      <mn>3</mn>
     </msub>
     <mrow>
      <mo>(</mo>
      <mi>σ</mi>
      <mo>)</mo>
     </mrow>
    </mrow>
    <mo>)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>s</ci>
    <vector>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <cn type="integer">1</cn>
      </apply>
      <ci>σ</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <cn type="integer">2</cn>
      </apply>
      <ci>σ</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <cn type="integer">3</cn>
      </apply>
      <ci>σ</ci>
     </apply>
    </vector>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   s=\left(x_{1}\left(\sigma\right),x_{2}\left(\sigma\right),x_{3}\left(\sigma%
\right)\right)
  </annotation>
 </semantics>
</math>

 in which <em>σ</em> is a general parameter. In this case, when compared to <a href="#Hamilton's_principle" title="wikilink">Hamilton's principle</a> above, coordinates 

<math display="inline" id="Hamiltonian_optics:121">
 <semantics>
  <msub>
   <mi>x</mi>
   <mn>1</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>x</ci>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x_{1}
  </annotation>
 </semantics>
</math>

, 

<math display="inline" id="Hamiltonian_optics:122">
 <semantics>
  <msub>
   <mi>x</mi>
   <mn>2</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>x</ci>
    <cn type="integer">2</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x_{2}
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Hamiltonian_optics:123">
 <semantics>
  <msub>
   <mi>x</mi>
   <mn>3</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>x</ci>
    <cn type="integer">3</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x_{3}
  </annotation>
 </semantics>
</math>

 take the role of the generalized coordinates 

<math display="inline" id="Hamiltonian_optics:124">
 <semantics>
  <msub>
   <mi>q</mi>
   <mi>k</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>q</ci>
    <ci>k</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   q_{k}
  </annotation>
 </semantics>
</math>

 with <em>N</em>=3. Applying <a href="#Hamilton's_principle" title="wikilink">Hamilton's principle</a> to optics in this case leads to</p>

<p>

<math display="block" id="Hamiltonian_optics:125">
 <semantics>
  <mrow>
   <mrow>
    <mi>δ</mi>
    <mi>S</mi>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mi>δ</mi>
    <mrow>
     <msubsup>
      <mo largeop="true" symmetric="true">∫</mo>
      <mi>𝐀</mi>
      <mi>𝐁</mi>
     </msubsup>
     <mrow>
      <mpadded width="+1.7pt">
       <mi>n</mi>
      </mpadded>
      <mi>d</mi>
      <mi>s</mi>
     </mrow>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mi>δ</mi>
    <mrow>
     <msubsup>
      <mo largeop="true" symmetric="true">∫</mo>
      <msub>
       <mi>σ</mi>
       <mi>A</mi>
      </msub>
      <msub>
       <mi>σ</mi>
       <mi>B</mi>
      </msub>
     </msubsup>
     <mrow>
      <mi>n</mi>
      <mpadded width="+1.7pt">
       <mfrac>
        <mrow>
         <mi>d</mi>
         <mi>s</mi>
        </mrow>
        <mrow>
         <mi>d</mi>
         <mi>σ</mi>
        </mrow>
       </mfrac>
      </mpadded>
      <mi>d</mi>
      <mi>σ</mi>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <times></times>
      <ci>δ</ci>
      <ci>S</ci>
     </apply>
     <apply>
      <times></times>
      <ci>δ</ci>
      <apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <int></int>
         <ci>𝐀</ci>
        </apply>
        <ci>𝐁</ci>
       </apply>
       <apply>
        <times></times>
        <ci>n</ci>
        <ci>d</ci>
        <ci>s</ci>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <ci>δ</ci>
      <apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <int></int>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>σ</ci>
          <ci>A</ci>
         </apply>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>σ</ci>
         <ci>B</ci>
        </apply>
       </apply>
       <apply>
        <times></times>
        <ci>n</ci>
        <apply>
         <divide></divide>
         <apply>
          <times></times>
          <ci>d</ci>
          <ci>s</ci>
         </apply>
         <apply>
          <times></times>
          <ci>d</ci>
          <ci>σ</ci>
         </apply>
        </apply>
        <ci>d</ci>
        <ci>σ</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \delta S=\delta\int_{\mathbf{A}}^{\mathbf{B}}n\,ds=\delta\int_{\sigma_{A}}^{%
\sigma_{B}}n\frac{ds}{d\sigma}\,d\sigma
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Hamiltonian_optics:126">
 <semantics>
  <mrow>
   <mi></mi>
   <mo>=</mo>
   <mrow>
    <mi>δ</mi>
    <mrow>
     <msubsup>
      <mo largeop="true" symmetric="true">∫</mo>
      <msub>
       <mi>σ</mi>
       <mi>A</mi>
      </msub>
      <msub>
       <mi>σ</mi>
       <mi>B</mi>
      </msub>
     </msubsup>
     <mrow>
      <mi>L</mi>
      <mrow>
       <mo>(</mo>
       <msub>
        <mi>x</mi>
        <mn>1</mn>
       </msub>
       <mo>,</mo>
       <msub>
        <mi>x</mi>
        <mn>2</mn>
       </msub>
       <mo>,</mo>
       <msub>
        <mi>x</mi>
        <mn>3</mn>
       </msub>
       <mo>,</mo>
       <msub>
        <mover accent="true">
         <mi>x</mi>
         <mo>˙</mo>
        </mover>
        <mn>1</mn>
       </msub>
       <mo>,</mo>
       <msub>
        <mover accent="true">
         <mi>x</mi>
         <mo>˙</mo>
        </mover>
        <mn>2</mn>
       </msub>
       <mo>,</mo>
       <msub>
        <mover accent="true">
         <mi>x</mi>
         <mo>˙</mo>
        </mover>
        <mn>3</mn>
       </msub>
       <mo>,</mo>
       <mi>σ</mi>
       <mo rspace="4.2pt">)</mo>
      </mrow>
      <mi>d</mi>
      <mi>σ</mi>
     </mrow>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <csymbol cd="latexml">absent</csymbol>
     <apply>
      <times></times>
      <ci>δ</ci>
      <apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <int></int>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>σ</ci>
          <ci>A</ci>
         </apply>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>σ</ci>
         <ci>B</ci>
        </apply>
       </apply>
       <apply>
        <times></times>
        <ci>L</ci>
        <vector>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>x</ci>
          <cn type="integer">1</cn>
         </apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>x</ci>
          <cn type="integer">2</cn>
         </apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>x</ci>
          <cn type="integer">3</cn>
         </apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <apply>
           <ci>normal-˙</ci>
           <ci>x</ci>
          </apply>
          <cn type="integer">1</cn>
         </apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <apply>
           <ci>normal-˙</ci>
           <ci>x</ci>
          </apply>
          <cn type="integer">2</cn>
         </apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <apply>
           <ci>normal-˙</ci>
           <ci>x</ci>
          </apply>
          <cn type="integer">3</cn>
         </apply>
         <ci>σ</ci>
        </vector>
        <ci>d</ci>
        <ci>σ</ci>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <cn type="integer">0</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   =\delta\int_{\sigma_{A}}^{\sigma_{B}}L\left(x_{1},x_{2},x_{3},\dot{x}_{1},\dot%
{x}_{2},\dot{x}_{3},\sigma\right)\,d\sigma=0
  </annotation>
 </semantics>
</math>

</p>

<p>where now 

<math display="inline" id="Hamiltonian_optics:127">
 <semantics>
  <mrow>
   <mi>L</mi>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mrow>
      <mi>n</mi>
      <mi>d</mi>
      <mi>s</mi>
     </mrow>
     <mo>/</mo>
     <mi>d</mi>
    </mrow>
    <mi>σ</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>L</ci>
    <apply>
     <times></times>
     <apply>
      <divide></divide>
      <apply>
       <times></times>
       <ci>n</ci>
       <ci>d</ci>
       <ci>s</ci>
      </apply>
      <ci>d</ci>
     </apply>
     <ci>σ</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   L=nds/d\sigma
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Hamiltonian_optics:128">
 <semantics>
  <mrow>
   <msub>
    <mover accent="true">
     <mi>x</mi>
     <mo>˙</mo>
    </mover>
    <mi>k</mi>
   </msub>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mrow>
      <mi>d</mi>
      <msub>
       <mi>x</mi>
       <mi>k</mi>
      </msub>
     </mrow>
     <mo>/</mo>
     <mi>d</mi>
    </mrow>
    <mi>σ</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <ci>normal-˙</ci>
      <ci>x</ci>
     </apply>
     <ci>k</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <divide></divide>
      <apply>
       <times></times>
       <ci>d</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <ci>k</ci>
       </apply>
      </apply>
      <ci>d</ci>
     </apply>
     <ci>σ</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \dot{x}_{k}=dx_{k}/d\sigma
  </annotation>
 </semantics>
</math>

 and for which the Euler-Lagrange equations applied to this form of Fermat's principle result in</p>

<p>

<math display="block" id="Hamiltonian_optics:129">
 <semantics>
  <mrow>
   <mrow>
    <mfrac>
     <mrow>
      <mo>∂</mo>
      <mi>L</mi>
     </mrow>
     <mrow>
      <mo>∂</mo>
      <msub>
       <mi>x</mi>
       <mi>k</mi>
      </msub>
     </mrow>
    </mfrac>
    <mo>-</mo>
    <mrow>
     <mfrac>
      <mi>d</mi>
      <mrow>
       <mi>d</mi>
       <mi>σ</mi>
      </mrow>
     </mfrac>
     <mfrac>
      <mrow>
       <mo>∂</mo>
       <mi>L</mi>
      </mrow>
      <mrow>
       <mo>∂</mo>
       <msub>
        <mover accent="true">
         <mi>x</mi>
         <mo>˙</mo>
        </mover>
        <mi>k</mi>
       </msub>
      </mrow>
     </mfrac>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <minus></minus>
     <apply>
      <divide></divide>
      <apply>
       <partialdiff></partialdiff>
       <ci>L</ci>
      </apply>
      <apply>
       <partialdiff></partialdiff>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <ci>k</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <ci>d</ci>
       <apply>
        <times></times>
        <ci>d</ci>
        <ci>σ</ci>
       </apply>
      </apply>
      <apply>
       <divide></divide>
       <apply>
        <partialdiff></partialdiff>
        <ci>L</ci>
       </apply>
       <apply>
        <partialdiff></partialdiff>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <apply>
          <ci>normal-˙</ci>
          <ci>x</ci>
         </apply>
         <ci>k</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \frac{\partial L}{\partial x_{k}}-\frac{d}{d\sigma}\frac{\partial L}{\partial%
\dot{x}_{k}}=0
  </annotation>
 </semantics>
</math>

</p>

<p>with <em>k</em>=1,2,3 and where <em>L</em> is the optical Lagrangian. Also in this case the optical momentum is defined as</p>

<p>

<math display="block" id="Hamiltonian_optics:130">
 <semantics>
  <mrow>
   <msub>
    <mi>p</mi>
    <mi>k</mi>
   </msub>
   <mo>=</mo>
   <mfrac>
    <mrow>
     <mo>∂</mo>
     <mi>L</mi>
    </mrow>
    <mrow>
     <mo>∂</mo>
     <msub>
      <mover accent="true">
       <mi>x</mi>
       <mo>˙</mo>
      </mover>
      <mi>k</mi>
     </msub>
    </mrow>
   </mfrac>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>p</ci>
     <ci>k</ci>
    </apply>
    <apply>
     <divide></divide>
     <apply>
      <partialdiff></partialdiff>
      <ci>L</ci>
     </apply>
     <apply>
      <partialdiff></partialdiff>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <apply>
        <ci>normal-˙</ci>
        <ci>x</ci>
       </apply>
       <ci>k</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p_{k}=\frac{\partial L}{\partial\dot{x}_{k}}
  </annotation>
 </semantics>
</math>

</p>

<p>and the Hamiltonian <em>P</em> is defined by the expression given <a href="#Hamilton's_principle" title="wikilink">above</a> for <em>N</em>=3 corresponding to functions 

<math display="inline" id="Hamiltonian_optics:131">
 <semantics>
  <mrow>
   <msub>
    <mi>x</mi>
    <mn>1</mn>
   </msub>
   <mrow>
    <mo>(</mo>
    <mi>σ</mi>
    <mo>)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>x</ci>
     <cn type="integer">1</cn>
    </apply>
    <ci>σ</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x_{1}\left(\sigma\right)
  </annotation>
 </semantics>
</math>


, 

<math display="inline" id="Hamiltonian_optics:132">
 <semantics>
  <mrow>
   <msub>
    <mi>x</mi>
    <mn>2</mn>
   </msub>
   <mrow>
    <mo>(</mo>
    <mi>σ</mi>
    <mo>)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>x</ci>
     <cn type="integer">2</cn>
    </apply>
    <ci>σ</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x_{2}\left(\sigma\right)
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Hamiltonian_optics:133">
 <semantics>
  <mrow>
   <msub>
    <mi>x</mi>
    <mn>3</mn>
   </msub>
   <mrow>
    <mo>(</mo>
    <mi>σ</mi>
    <mo>)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>x</ci>
     <cn type="integer">3</cn>
    </apply>
    <ci>σ</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x_{3}\left(\sigma\right)
  </annotation>
 </semantics>
</math>

 to be determined</p>

<p>

<math display="block" id="Hamiltonian_optics:134">
 <semantics>
  <mrow>
   <mi>P</mi>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mrow>
      <msub>
       <mover accent="true">
        <mi>x</mi>
        <mo>˙</mo>
       </mover>
       <mn>1</mn>
      </msub>
      <msub>
       <mi>p</mi>
       <mn>1</mn>
      </msub>
     </mrow>
     <mo>+</mo>
     <mrow>
      <msub>
       <mover accent="true">
        <mi>x</mi>
        <mo>˙</mo>
       </mover>
       <mn>2</mn>
      </msub>
      <msub>
       <mi>p</mi>
       <mn>2</mn>
      </msub>
     </mrow>
     <mo>+</mo>
     <mrow>
      <msub>
       <mover accent="true">
        <mi>x</mi>
        <mo>˙</mo>
       </mover>
       <mn>3</mn>
      </msub>
      <msub>
       <mi>p</mi>
       <mn>3</mn>
      </msub>
     </mrow>
    </mrow>
    <mo>-</mo>
    <mi>L</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>P</ci>
    <apply>
     <minus></minus>
     <apply>
      <plus></plus>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <apply>
         <ci>normal-˙</ci>
         <ci>x</ci>
        </apply>
        <cn type="integer">1</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>p</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <apply>
         <ci>normal-˙</ci>
         <ci>x</ci>
        </apply>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>p</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <apply>
         <ci>normal-˙</ci>
         <ci>x</ci>
        </apply>
        <cn type="integer">3</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>p</ci>
        <cn type="integer">3</cn>
       </apply>
      </apply>
     </apply>
     <ci>L</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   P=\dot{x}_{1}p_{1}+\dot{x}_{2}p_{2}+\dot{x}_{3}p_{3}-L
  </annotation>
 </semantics>
</math>

</p>

<p>And the corresponding Hamilton's equations with <em>k</em>=1,2,3 applied optics are</p>

<p>

<math display="block" id="Hamiltonian_optics:135">
 <semantics>
  <mrow>
   <mrow>
    <mfrac>
     <mrow>
      <mo>∂</mo>
      <mi>H</mi>
     </mrow>
     <mrow>
      <mo>∂</mo>
      <msub>
       <mi>x</mi>
       <mi>k</mi>
      </msub>
     </mrow>
    </mfrac>
    <mo>=</mo>
    <mrow>
     <mo>-</mo>
     <mpadded width="+1.7pt">
      <msub>
       <mover accent="true">
        <mi>p</mi>
        <mo>˙</mo>
       </mover>
       <mi>k</mi>
      </msub>
     </mpadded>
    </mrow>
   </mrow>
   <mo rspace="12.5pt">,</mo>
   <mrow>
    <mfrac>
     <mrow>
      <mo>∂</mo>
      <mi>H</mi>
     </mrow>
     <mrow>
      <mo>∂</mo>
      <msub>
       <mi>p</mi>
       <mi>k</mi>
      </msub>
     </mrow>
    </mfrac>
    <mo>=</mo>
    <msub>
     <mover accent="true">
      <mi>x</mi>
      <mo>˙</mo>
     </mover>
     <mi>k</mi>
    </msub>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <eq></eq>
     <apply>
      <divide></divide>
      <apply>
       <partialdiff></partialdiff>
       <ci>H</ci>
      </apply>
      <apply>
       <partialdiff></partialdiff>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <ci>k</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <minus></minus>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <apply>
        <ci>normal-˙</ci>
        <ci>p</ci>
       </apply>
       <ci>k</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <apply>
      <divide></divide>
      <apply>
       <partialdiff></partialdiff>
       <ci>H</ci>
      </apply>
      <apply>
       <partialdiff></partialdiff>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>p</ci>
        <ci>k</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <ci>normal-˙</ci>
       <ci>x</ci>
      </apply>
      <ci>k</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \frac{\partial H}{\partial x_{k}}=-\dot{p}_{k}\,,\quad\frac{\partial H}{%
\partial p_{k}}=\dot{x}_{k}
  </annotation>
 </semantics>
</math>

</p>

<p>with 

<math display="inline" id="Hamiltonian_optics:136">
 <semantics>
  <mrow>
   <msub>
    <mover accent="true">
     <mi>x</mi>
     <mo>˙</mo>
    </mover>
    <mi>k</mi>
   </msub>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mrow>
      <mi>d</mi>
      <msub>
       <mi>x</mi>
       <mi>k</mi>
      </msub>
     </mrow>
     <mo>/</mo>
     <mi>d</mi>
    </mrow>
    <mi>σ</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <ci>normal-˙</ci>
      <ci>x</ci>
     </apply>
     <ci>k</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <divide></divide>
      <apply>
       <times></times>
       <ci>d</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <ci>k</ci>
       </apply>
      </apply>
      <ci>d</ci>
     </apply>
     <ci>σ</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \dot{x}_{k}=dx_{k}/d\sigma
  </annotation>
 </semantics>
</math>


 and 

<math display="inline" id="Hamiltonian_optics:137">
 <semantics>
  <mrow>
   <msub>
    <mover accent="true">
     <mi>p</mi>
     <mo>˙</mo>
    </mover>
    <mi>k</mi>
   </msub>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mrow>
      <mi>d</mi>
      <msub>
       <mi>p</mi>
       <mi>k</mi>
      </msub>
     </mrow>
     <mo>/</mo>
     <mi>d</mi>
    </mrow>
    <mi>σ</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <ci>normal-˙</ci>
      <ci>p</ci>
     </apply>
     <ci>k</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <divide></divide>
      <apply>
       <times></times>
       <ci>d</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>p</ci>
        <ci>k</ci>
       </apply>
      </apply>
      <ci>d</ci>
     </apply>
     <ci>σ</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \dot{p}_{k}=dp_{k}/d\sigma
  </annotation>
 </semantics>
</math>

.</p>

<p>The optical Lagrangian is given by</p>

<p>

<math display="block" id="Hamiltonian_optics:138">
 <semantics>
  <mrow>
   <mi>L</mi>
   <mo>=</mo>
   <mrow>
    <mi>n</mi>
    <mfrac>
     <mrow>
      <mi>d</mi>
      <mi>s</mi>
     </mrow>
     <mrow>
      <mi>d</mi>
      <mi>σ</mi>
     </mrow>
    </mfrac>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mi>n</mi>
    <mrow>
     <mo>(</mo>
     <msub>
      <mi>x</mi>
      <mn>1</mn>
     </msub>
     <mo>,</mo>
     <msub>
      <mi>x</mi>
      <mn>2</mn>
     </msub>
     <mo>,</mo>
     <msub>
      <mi>x</mi>
      <mn>3</mn>
     </msub>
     <mo>)</mo>
    </mrow>
    <msqrt>
     <mrow>
      <msubsup>
       <mover accent="true">
        <mi>x</mi>
        <mo>˙</mo>
       </mover>
       <mn>1</mn>
       <mn>2</mn>
      </msubsup>
      <mo>+</mo>
      <msubsup>
       <mover accent="true">
        <mi>x</mi>
        <mo>˙</mo>
       </mover>
       <mn>2</mn>
       <mn>2</mn>
      </msubsup>
      <mo>+</mo>
      <msubsup>
       <mover accent="true">
        <mi>x</mi>
        <mo>˙</mo>
       </mover>
       <mn>3</mn>
       <mn>2</mn>
      </msubsup>
     </mrow>
    </msqrt>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mi>L</mi>
    <mrow>
     <mo>(</mo>
     <msub>
      <mi>x</mi>
      <mn>1</mn>
     </msub>
     <mo>,</mo>
     <msub>
      <mi>x</mi>
      <mn>2</mn>
     </msub>
     <mo>,</mo>
     <msub>
      <mi>x</mi>
      <mn>3</mn>
     </msub>
     <mo>,</mo>
     <msub>
      <mover accent="true">
       <mi>x</mi>
       <mo>˙</mo>
      </mover>
      <mn>1</mn>
     </msub>
     <mo>,</mo>
     <msub>
      <mover accent="true">
       <mi>x</mi>
       <mo>˙</mo>
      </mover>
      <mn>2</mn>
     </msub>
     <mo>,</mo>
     <msub>
      <mover accent="true">
       <mi>x</mi>
       <mo>˙</mo>
      </mover>
      <mn>3</mn>
     </msub>
     <mo>)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <ci>L</ci>
     <apply>
      <times></times>
      <ci>n</ci>
      <apply>
       <divide></divide>
       <apply>
        <times></times>
        <ci>d</ci>
        <ci>s</ci>
       </apply>
       <apply>
        <times></times>
        <ci>d</ci>
        <ci>σ</ci>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <ci>n</ci>
      <vector>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <cn type="integer">1</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <cn type="integer">3</cn>
       </apply>
      </vector>
      <apply>
       <root></root>
       <apply>
        <plus></plus>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <apply>
           <ci>normal-˙</ci>
           <ci>x</ci>
          </apply>
          <cn type="integer">1</cn>
         </apply>
         <cn type="integer">2</cn>
        </apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <apply>
           <ci>normal-˙</ci>
           <ci>x</ci>
          </apply>
          <cn type="integer">2</cn>
         </apply>
         <cn type="integer">2</cn>
        </apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <apply>
           <ci>normal-˙</ci>
           <ci>x</ci>
          </apply>
          <cn type="integer">3</cn>
         </apply>
         <cn type="integer">2</cn>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <ci>L</ci>
      <vector>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <cn type="integer">1</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <cn type="integer">3</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <apply>
         <ci>normal-˙</ci>
         <ci>x</ci>
        </apply>
        <cn type="integer">1</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <apply>
         <ci>normal-˙</ci>
         <ci>x</ci>
        </apply>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <apply>
         <ci>normal-˙</ci>
         <ci>x</ci>
        </apply>
        <cn type="integer">3</cn>
       </apply>
      </vector>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   L=n\frac{ds}{d\sigma}=n\left(x_{1},x_{2},x_{3}\right)\sqrt{\dot{x}_{1}^{2}+%
\dot{x}_{2}^{2}+\dot{x}_{3}^{2}}=L\left(x_{1},x_{2},x_{3},\dot{x}_{1},\dot{x}_%
{2},\dot{x}_{3}\right)
  </annotation>
 </semantics>
</math>

</p>

<p>and does not explicitly depend on parameter <em>σ</em>. For that reason not all solutions of the Euler-Lagrange equations will be possible light rays, since their derivation assumed an explicit dependence of <em>L</em> on <em>σ</em> which does not happen in optics.</p>

<p>The optical momentum components can be obtained from</p>

<p>

<math display="block" id="Hamiltonian_optics:139">
 <semantics>
  <mrow>
   <msub>
    <mi>p</mi>
    <mi>k</mi>
   </msub>
   <mo>=</mo>
   <mrow>
    <mi>n</mi>
    <mfrac>
     <msub>
      <mover accent="true">
       <mi>x</mi>
       <mo>˙</mo>
      </mover>
      <mi>k</mi>
     </msub>
     <msqrt>
      <mrow>
       <msubsup>
        <mover accent="true">
         <mi>x</mi>
         <mo>˙</mo>
        </mover>
        <mn>1</mn>
        <mn>2</mn>
       </msubsup>
       <mo>+</mo>
       <msubsup>
        <mover accent="true">
         <mi>x</mi>
         <mo>˙</mo>
        </mover>
        <mn>2</mn>
        <mn>2</mn>
       </msubsup>
       <mo>+</mo>
       <msubsup>
        <mover accent="true">
         <mi>x</mi>
         <mo>˙</mo>
        </mover>
        <mn>3</mn>
        <mn>2</mn>
       </msubsup>
      </mrow>
     </msqrt>
    </mfrac>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mi>n</mi>
    <mfrac>
     <mrow>
      <mi>d</mi>
      <msub>
       <mi>x</mi>
       <mi>k</mi>
      </msub>
     </mrow>
     <msqrt>
      <mrow>
       <mrow>
        <mi>d</mi>
        <msubsup>
         <mi>x</mi>
         <mn>1</mn>
         <mn>2</mn>
        </msubsup>
       </mrow>
       <mo>+</mo>
       <mrow>
        <mi>d</mi>
        <msubsup>
         <mi>x</mi>
         <mn>2</mn>
         <mn>2</mn>
        </msubsup>
       </mrow>
       <mo>+</mo>
       <mrow>
        <mi>d</mi>
        <msubsup>
         <mi>x</mi>
         <mn>3</mn>
         <mn>2</mn>
        </msubsup>
       </mrow>
      </mrow>
     </msqrt>
    </mfrac>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mi>n</mi>
    <mfrac>
     <mrow>
      <mi>d</mi>
      <msub>
       <mi>x</mi>
       <mi>k</mi>
      </msub>
     </mrow>
     <mrow>
      <mi>d</mi>
      <mi>s</mi>
     </mrow>
    </mfrac>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>p</ci>
      <ci>k</ci>
     </apply>
     <apply>
      <times></times>
      <ci>n</ci>
      <apply>
       <divide></divide>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <apply>
         <ci>normal-˙</ci>
         <ci>x</ci>
        </apply>
        <ci>k</ci>
       </apply>
       <apply>
        <root></root>
        <apply>
         <plus></plus>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <apply>
            <ci>normal-˙</ci>
            <ci>x</ci>
           </apply>
           <cn type="integer">1</cn>
          </apply>
          <cn type="integer">2</cn>
         </apply>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <apply>
            <ci>normal-˙</ci>
            <ci>x</ci>
           </apply>
           <cn type="integer">2</cn>
          </apply>
          <cn type="integer">2</cn>
         </apply>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <apply>
            <ci>normal-˙</ci>
            <ci>x</ci>
           </apply>
           <cn type="integer">3</cn>
          </apply>
          <cn type="integer">2</cn>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <ci>n</ci>
      <apply>
       <divide></divide>
       <apply>
        <times></times>
        <ci>d</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>x</ci>
         <ci>k</ci>
        </apply>
       </apply>
       <apply>
        <root></root>
        <apply>
         <plus></plus>
         <apply>
          <times></times>
          <ci>d</ci>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <ci>x</ci>
            <cn type="integer">1</cn>
           </apply>
           <cn type="integer">2</cn>
          </apply>
         </apply>
         <apply>
          <times></times>
          <ci>d</ci>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <ci>x</ci>
            <cn type="integer">2</cn>
           </apply>
           <cn type="integer">2</cn>
          </apply>
         </apply>
         <apply>
          <times></times>
          <ci>d</ci>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <ci>x</ci>
            <cn type="integer">3</cn>
           </apply>
           <cn type="integer">2</cn>
          </apply>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <ci>n</ci>
      <apply>
       <divide></divide>
       <apply>
        <times></times>
        <ci>d</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>x</ci>
         <ci>k</ci>
        </apply>
       </apply>
       <apply>
        <times></times>
        <ci>d</ci>
        <ci>s</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p_{k}=n\frac{\dot{x}_{k}}{\sqrt{\dot{x}_{1}^{2}+\dot{x}_{2}^{2}+\dot{x}_{3}^{2%
}}}=n\frac{dx_{k}}{\sqrt{dx_{1}^{2}+dx_{2}^{2}+dx_{3}^{2}}}=n\frac{dx_{k}}{ds}
  </annotation>
 </semantics>
</math>

</p>

<p>where 

<math display="inline" id="Hamiltonian_optics:140">
 <semantics>
  <mrow>
   <msub>
    <mover accent="true">
     <mi>x</mi>
     <mo>˙</mo>
    </mover>
    <mi>k</mi>
   </msub>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mrow>
      <mi>d</mi>
      <msub>
       <mi>x</mi>
       <mi>k</mi>
      </msub>
     </mrow>
     <mo>/</mo>
     <mi>d</mi>
    </mrow>
    <mi>σ</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <ci>normal-˙</ci>
      <ci>x</ci>
     </apply>
     <ci>k</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <divide></divide>
      <apply>
       <times></times>
       <ci>d</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <ci>k</ci>
       </apply>
      </apply>
      <ci>d</ci>
     </apply>
     <ci>σ</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \dot{x}_{k}=dx_{k}/d\sigma
  </annotation>
 </semantics>
</math>

. The expression for the Lagrangian can be rewritten as</p>

<p>

<math display="block" id="Hamiltonian_optics:141">
 <semantics>
  <mrow>
   <mi>L</mi>
   <mo>=</mo>
   <mrow>
    <mi>n</mi>
    <msqrt>
     <mrow>
      <msubsup>
       <mover accent="true">
        <mi>x</mi>
        <mo>˙</mo>
       </mover>
       <mn>1</mn>
       <mn>2</mn>
      </msubsup>
      <mo>+</mo>
      <msubsup>
       <mover accent="true">
        <mi>x</mi>
        <mo>˙</mo>
       </mover>
       <mn>2</mn>
       <mn>2</mn>
      </msubsup>
      <mo>+</mo>
      <msubsup>
       <mover accent="true">
        <mi>x</mi>
        <mo>˙</mo>
       </mover>
       <mn>3</mn>
       <mn>2</mn>
      </msubsup>
     </mrow>
    </msqrt>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <msub>
      <mover accent="true">
       <mi>x</mi>
       <mo>˙</mo>
      </mover>
      <mn>1</mn>
     </msub>
     <mfrac>
      <mrow>
       <mi>n</mi>
       <msub>
        <mover accent="true">
         <mi>x</mi>
         <mo>˙</mo>
        </mover>
        <mn>1</mn>
       </msub>
      </mrow>
      <msqrt>
       <mrow>
        <msubsup>
         <mover accent="true">
          <mi>x</mi>
          <mo>˙</mo>
         </mover>
         <mn>1</mn>
         <mn>2</mn>
        </msubsup>
        <mo>+</mo>
        <msubsup>
         <mover accent="true">
          <mi>x</mi>
          <mo>˙</mo>
         </mover>
         <mn>2</mn>
         <mn>2</mn>
        </msubsup>
        <mo>+</mo>
        <msubsup>
         <mover accent="true">
          <mi>x</mi>
          <mo>˙</mo>
         </mover>
         <mn>3</mn>
         <mn>2</mn>
        </msubsup>
       </mrow>
      </msqrt>
     </mfrac>
    </mrow>
    <mo>+</mo>
    <mrow>
     <msub>
      <mover accent="true">
       <mi>x</mi>
       <mo>˙</mo>
      </mover>
      <mn>2</mn>
     </msub>
     <mfrac>
      <mrow>
       <mi>n</mi>
       <msub>
        <mover accent="true">
         <mi>x</mi>
         <mo>˙</mo>
        </mover>
        <mn>2</mn>
       </msub>
      </mrow>
      <msqrt>
       <mrow>
        <msubsup>
         <mover accent="true">
          <mi>x</mi>
          <mo>˙</mo>
         </mover>
         <mn>1</mn>
         <mn>2</mn>
        </msubsup>
        <mo>+</mo>
        <msubsup>
         <mover accent="true">
          <mi>x</mi>
          <mo>˙</mo>
         </mover>
         <mn>2</mn>
         <mn>2</mn>
        </msubsup>
        <mo>+</mo>
        <msubsup>
         <mover accent="true">
          <mi>x</mi>
          <mo>˙</mo>
         </mover>
         <mn>3</mn>
         <mn>2</mn>
        </msubsup>
       </mrow>
      </msqrt>
     </mfrac>
    </mrow>
    <mo>+</mo>
    <mrow>
     <msub>
      <mover accent="true">
       <mi>x</mi>
       <mo>˙</mo>
      </mover>
      <mn>3</mn>
     </msub>
     <mfrac>
      <mrow>
       <mi>n</mi>
       <msub>
        <mover accent="true">
         <mi>x</mi>
         <mo>˙</mo>
        </mover>
        <mn>3</mn>
       </msub>
      </mrow>
      <msqrt>
       <mrow>
        <msubsup>
         <mover accent="true">
          <mi>x</mi>
          <mo>˙</mo>
         </mover>
         <mn>1</mn>
         <mn>2</mn>
        </msubsup>
        <mo>+</mo>
        <msubsup>
         <mover accent="true">
          <mi>x</mi>
          <mo>˙</mo>
         </mover>
         <mn>2</mn>
         <mn>2</mn>
        </msubsup>
        <mo>+</mo>
        <msubsup>
         <mover accent="true">
          <mi>x</mi>
          <mo>˙</mo>
         </mover>
         <mn>3</mn>
         <mn>2</mn>
        </msubsup>
       </mrow>
      </msqrt>
     </mfrac>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <ci>L</ci>
     <apply>
      <times></times>
      <ci>n</ci>
      <apply>
       <root></root>
       <apply>
        <plus></plus>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <apply>
           <ci>normal-˙</ci>
           <ci>x</ci>
          </apply>
          <cn type="integer">1</cn>
         </apply>
         <cn type="integer">2</cn>
        </apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <apply>
           <ci>normal-˙</ci>
           <ci>x</ci>
          </apply>
          <cn type="integer">2</cn>
         </apply>
         <cn type="integer">2</cn>
        </apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <apply>
           <ci>normal-˙</ci>
           <ci>x</ci>
          </apply>
          <cn type="integer">3</cn>
         </apply>
         <cn type="integer">2</cn>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <plus></plus>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <apply>
         <ci>normal-˙</ci>
         <ci>x</ci>
        </apply>
        <cn type="integer">1</cn>
       </apply>
       <apply>
        <divide></divide>
        <apply>
         <times></times>
         <ci>n</ci>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <apply>
           <ci>normal-˙</ci>
           <ci>x</ci>
          </apply>
          <cn type="integer">1</cn>
         </apply>
        </apply>
        <apply>
         <root></root>
         <apply>
          <plus></plus>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <apply>
             <ci>normal-˙</ci>
             <ci>x</ci>
            </apply>
            <cn type="integer">1</cn>
           </apply>
           <cn type="integer">2</cn>
          </apply>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <apply>
             <ci>normal-˙</ci>
             <ci>x</ci>
            </apply>
            <cn type="integer">2</cn>
           </apply>
           <cn type="integer">2</cn>
          </apply>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <apply>
             <ci>normal-˙</ci>
             <ci>x</ci>
            </apply>
            <cn type="integer">3</cn>
           </apply>
           <cn type="integer">2</cn>
          </apply>
         </apply>
        </apply>
       </apply>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <apply>
         <ci>normal-˙</ci>
         <ci>x</ci>
        </apply>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <divide></divide>
        <apply>
         <times></times>
         <ci>n</ci>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <apply>
           <ci>normal-˙</ci>
           <ci>x</ci>
          </apply>
          <cn type="integer">2</cn>
         </apply>
        </apply>
        <apply>
         <root></root>
         <apply>
          <plus></plus>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <apply>
             <ci>normal-˙</ci>
             <ci>x</ci>
            </apply>
            <cn type="integer">1</cn>
           </apply>
           <cn type="integer">2</cn>
          </apply>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <apply>
             <ci>normal-˙</ci>
             <ci>x</ci>
            </apply>
            <cn type="integer">2</cn>
           </apply>
           <cn type="integer">2</cn>
          </apply>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <apply>
             <ci>normal-˙</ci>
             <ci>x</ci>
            </apply>
            <cn type="integer">3</cn>
           </apply>
           <cn type="integer">2</cn>
          </apply>
         </apply>
        </apply>
       </apply>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <apply>
         <ci>normal-˙</ci>
         <ci>x</ci>
        </apply>
        <cn type="integer">3</cn>
       </apply>
       <apply>
        <divide></divide>
        <apply>
         <times></times>
         <ci>n</ci>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <apply>
           <ci>normal-˙</ci>
           <ci>x</ci>
          </apply>
          <cn type="integer">3</cn>
         </apply>
        </apply>
        <apply>
         <root></root>
         <apply>
          <plus></plus>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <apply>
             <ci>normal-˙</ci>
             <ci>x</ci>
            </apply>
            <cn type="integer">1</cn>
           </apply>
           <cn type="integer">2</cn>
          </apply>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <apply>
             <ci>normal-˙</ci>
             <ci>x</ci>
            </apply>
            <cn type="integer">2</cn>
           </apply>
           <cn type="integer">2</cn>
          </apply>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <apply>
             <ci>normal-˙</ci>
             <ci>x</ci>
            </apply>
            <cn type="integer">3</cn>
           </apply>
           <cn type="integer">2</cn>
          </apply>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   L=n\sqrt{\dot{x}_{1}^{2}+\dot{x}_{2}^{2}+\dot{x}_{3}^{2}}=\dot{x}_{1}\frac{n%
\dot{x}_{1}}{\sqrt{\dot{x}_{1}^{2}+\dot{x}_{2}^{2}+\dot{x}_{3}^{2}}}+\dot{x}_{%
2}\frac{n\dot{x}_{2}}{\sqrt{\dot{x}_{1}^{2}+\dot{x}_{2}^{2}+\dot{x}_{3}^{2}}}+%
\dot{x}_{3}\frac{n\dot{x}_{3}}{\sqrt{\dot{x}_{1}^{2}+\dot{x}_{2}^{2}+\dot{x}_{%
3}^{2}}}
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Hamiltonian_optics:142">
 <semantics>
  <mrow>
   <mi></mi>
   <mo>=</mo>
   <mrow>
    <mrow>
     <msub>
      <mover accent="true">
       <mi>x</mi>
       <mo>˙</mo>
      </mover>
      <mn>1</mn>
     </msub>
     <msub>
      <mi>p</mi>
      <mn>1</mn>
     </msub>
    </mrow>
    <mo>+</mo>
    <mrow>
     <msub>
      <mover accent="true">
       <mi>x</mi>
       <mo>˙</mo>
      </mover>
      <mn>2</mn>
     </msub>
     <msub>
      <mi>p</mi>
      <mn>2</mn>
     </msub>
    </mrow>
    <mo>+</mo>
    <mrow>
     <msub>
      <mover accent="true">
       <mi>x</mi>
       <mo>˙</mo>
      </mover>
      <mn>3</mn>
     </msub>
     <msub>
      <mi>p</mi>
      <mn>3</mn>
     </msub>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <csymbol cd="latexml">absent</csymbol>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <apply>
        <ci>normal-˙</ci>
        <ci>x</ci>
       </apply>
       <cn type="integer">1</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>p</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <apply>
        <ci>normal-˙</ci>
        <ci>x</ci>
       </apply>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>p</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <apply>
        <ci>normal-˙</ci>
        <ci>x</ci>
       </apply>
       <cn type="integer">3</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>p</ci>
       <cn type="integer">3</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   =\dot{x}_{1}p_{1}+\dot{x}_{2}p_{2}+\dot{x}_{3}p_{3}
  </annotation>
 </semantics>
</math>

</p>

<p>Comparing this expression for <em>L</em> with that for the Hamiltonian <em>P</em> it can be concluded that</p>

<p>

<math display="block" id="Hamiltonian_optics:143">
 <semantics>
  <mrow>
   <mi>P</mi>
   <mo>=</mo>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>P</ci>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   P=0
  </annotation>
 </semantics>
</math>

</p>

<p>From the expressions for the components 

<math display="inline" id="Hamiltonian_optics:144">
 <semantics>
  <msub>
   <mi>p</mi>
   <mi>k</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>p</ci>
    <ci>k</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p_{k}
  </annotation>
 </semantics>
</math>

 of the optical momentum results</p>

<p>

<math display="block" id="Hamiltonian_optics:145">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <msubsup>
      <mi>p</mi>
      <mn>1</mn>
      <mn>2</mn>
     </msubsup>
     <mo>+</mo>
     <msubsup>
      <mi>p</mi>
      <mn>2</mn>
      <mn>2</mn>
     </msubsup>
     <mo>+</mo>
     <msubsup>
      <mi>p</mi>
      <mn>3</mn>
      <mn>2</mn>
     </msubsup>
    </mrow>
    <mo>-</mo>
    <mrow>
     <msup>
      <mi>n</mi>
      <mn>2</mn>
     </msup>
     <mrow>
      <mo>(</mo>
      <msub>
       <mi>x</mi>
       <mn>1</mn>
      </msub>
      <mo>,</mo>
      <msub>
       <mi>x</mi>
       <mn>2</mn>
      </msub>
      <mo>,</mo>
      <msub>
       <mi>x</mi>
       <mn>3</mn>
      </msub>
      <mo>)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <minus></minus>
     <apply>
      <plus></plus>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>p</ci>
        <cn type="integer">1</cn>
       </apply>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>p</ci>
        <cn type="integer">2</cn>
       </apply>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>p</ci>
        <cn type="integer">3</cn>
       </apply>
       <cn type="integer">2</cn>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>n</ci>
       <cn type="integer">2</cn>
      </apply>
      <vector>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <cn type="integer">1</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <cn type="integer">3</cn>
       </apply>
      </vector>
     </apply>
    </apply>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p_{1}^{2}+p_{2}^{2}+p_{3}^{2}-n^{2}\left(x_{1},x_{2},x_{3}\right)=0
  </annotation>
 </semantics>
</math>

</p>

<p>The optical Hamiltonian is chosen as</p>

<p>

<math display="block" id="Hamiltonian_optics:146">
 <semantics>
  <mrow>
   <mi>P</mi>
   <mo>=</mo>
   <mrow>
    <mrow>
     <msubsup>
      <mi>p</mi>
      <mn>1</mn>
      <mn>2</mn>
     </msubsup>
     <mo>+</mo>
     <msubsup>
      <mi>p</mi>
      <mn>2</mn>
      <mn>2</mn>
     </msubsup>
     <mo>+</mo>
     <msubsup>
      <mi>p</mi>
      <mn>3</mn>
      <mn>2</mn>
     </msubsup>
    </mrow>
    <mo>-</mo>
    <mrow>
     <msup>
      <mi>n</mi>
      <mn>2</mn>
     </msup>
     <mrow>
      <mo>(</mo>
      <msub>
       <mi>x</mi>
       <mn>1</mn>
      </msub>
      <mo>,</mo>
      <msub>
       <mi>x</mi>
       <mn>2</mn>
      </msub>
      <mo>,</mo>
      <msub>
       <mi>x</mi>
       <mn>3</mn>
      </msub>
      <mo>)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <ci>P</ci>
     <apply>
      <minus></minus>
      <apply>
       <plus></plus>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>p</ci>
         <cn type="integer">1</cn>
        </apply>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>p</ci>
         <cn type="integer">2</cn>
        </apply>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>p</ci>
         <cn type="integer">3</cn>
        </apply>
        <cn type="integer">2</cn>
       </apply>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>n</ci>
        <cn type="integer">2</cn>
       </apply>
       <vector>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>x</ci>
         <cn type="integer">1</cn>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>x</ci>
         <cn type="integer">2</cn>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>x</ci>
         <cn type="integer">3</cn>
        </apply>
       </vector>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <cn type="integer">0</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   P=p_{1}^{2}+p_{2}^{2}+p_{3}^{2}-n^{2}\left(x_{1},x_{2},x_{3}\right)=0
  </annotation>
 </semantics>
</math>

</p>

<p>although other choices could be made.<a class="footnoteRef" href="#fn9" id="fnref9"><sup>9</sup></a><a class="footnoteRef" href="#fn10" id="fnref10"><sup>10</sup></a> The Hamilton's equations with <em>k</em>=1,2,3 defined above together with 

<math display="inline" id="Hamiltonian_optics:147">
 <semantics>
  <mrow>
   <mi>P</mi>
   <mo>=</mo>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>P</ci>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   P=0
  </annotation>
 </semantics>
</math>

 define the possible light rays.</p>
<h3 id="generalized-coordinates">Generalized coordinates</h3>

<p>As in <a href="Hamiltonian_mechanics" title="wikilink">Hamiltonian mechanics</a>, it is also possible to write the equations of Hamiltonian optics in terms of <a href="generalized_coordinates" title="wikilink">generalized coordinates</a> 

<math display="inline" id="Hamiltonian_optics:148">
 <semantics>
  <mrow>
   <mo>(</mo>
   <mrow>
    <msub>
     <mi>q</mi>
     <mn>1</mn>
    </msub>
    <mrow>
     <mo>(</mo>
     <mi>σ</mi>
     <mo>)</mo>
    </mrow>
   </mrow>
   <mo>,</mo>
   <mrow>
    <msub>
     <mi>q</mi>
     <mn>2</mn>
    </msub>
    <mrow>
     <mo>(</mo>
     <mi>σ</mi>
     <mo>)</mo>
    </mrow>
   </mrow>
   <mo>,</mo>
   <mrow>
    <msub>
     <mi>q</mi>
     <mn>3</mn>
    </msub>
    <mrow>
     <mo>(</mo>
     <mi>σ</mi>
     <mo>)</mo>
    </mrow>
   </mrow>
   <mo>)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <vector>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>q</ci>
      <cn type="integer">1</cn>
     </apply>
     <ci>σ</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>q</ci>
      <cn type="integer">2</cn>
     </apply>
     <ci>σ</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>q</ci>
      <cn type="integer">3</cn>
     </apply>
     <ci>σ</ci>
    </apply>
   </vector>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \left(q_{1}\left(\sigma\right),q_{2}\left(\sigma\right),q_{3}\left(\sigma%
\right)\right)
  </annotation>
 </semantics>
</math>

, generalized momenta 

<math display="inline" id="Hamiltonian_optics:149">
 <semantics>
  <mrow>
   <mo>(</mo>
   <mrow>
    <msub>
     <mi>u</mi>
     <mn>1</mn>
    </msub>
    <mrow>
     <mo>(</mo>
     <mi>σ</mi>
     <mo>)</mo>
    </mrow>
   </mrow>
   <mo>,</mo>
   <mrow>
    <msub>
     <mi>u</mi>
     <mn>2</mn>
    </msub>
    <mrow>
     <mo>(</mo>
     <mi>σ</mi>
     <mo>)</mo>
    </mrow>
   </mrow>
   <mo>,</mo>
   <mrow>
    <msub>
     <mi>u</mi>
     <mn>3</mn>
    </msub>
    <mrow>
     <mo>(</mo>
     <mi>σ</mi>
     <mo>)</mo>
    </mrow>
   </mrow>
   <mo>)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <vector>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>u</ci>
      <cn type="integer">1</cn>
     </apply>
     <ci>σ</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>u</ci>
      <cn type="integer">2</cn>
     </apply>
     <ci>σ</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>u</ci>
      <cn type="integer">3</cn>
     </apply>
     <ci>σ</ci>
    </apply>
   </vector>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \left(u_{1}\left(\sigma\right),u_{2}\left(\sigma\right),u_{3}\left(\sigma%
\right)\right)
  </annotation>
 </semantics>
</math>

 and Hamiltonian <em>P</em> as<a class="footnoteRef" href="#fn11" id="fnref11"><sup>11</sup></a><a class="footnoteRef" href="#fn12" id="fnref12"><sup>12</sup></a></p>

<p>

<math display="block" id="Hamiltonian_optics:150">
 <semantics>
  <mrow>
   <mrow>
    <mfrac>
     <mrow>
      <mi>d</mi>
      <msub>
       <mi>q</mi>
       <mn>1</mn>
      </msub>
     </mrow>
     <mrow>
      <mi>d</mi>
      <mi>σ</mi>
     </mrow>
    </mfrac>
    <mo>=</mo>
    <mfrac>
     <mrow>
      <mo>∂</mo>
      <mi>P</mi>
     </mrow>
     <mrow>
      <mo>∂</mo>
      <msub>
       <mi>u</mi>
       <mn>1</mn>
      </msub>
     </mrow>
    </mfrac>
   </mrow>
   <mrow>
    <mfrac>
     <mrow>
      <mi>d</mi>
      <msub>
       <mi>u</mi>
       <mn>1</mn>
      </msub>
     </mrow>
     <mrow>
      <mi>d</mi>
      <mi>σ</mi>
     </mrow>
    </mfrac>
    <mo>=</mo>
    <mrow>
     <mo>-</mo>
     <mfrac>
      <mrow>
       <mo>∂</mo>
       <mi>P</mi>
      </mrow>
      <mrow>
       <mo>∂</mo>
       <msub>
        <mi>q</mi>
        <mn>1</mn>
       </msub>
      </mrow>
     </mfrac>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <eq></eq>
     <apply>
      <divide></divide>
      <apply>
       <times></times>
       <ci>d</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>q</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <apply>
       <times></times>
       <ci>d</ci>
       <ci>σ</ci>
      </apply>
     </apply>
     <apply>
      <divide></divide>
      <apply>
       <partialdiff></partialdiff>
       <ci>P</ci>
      </apply>
      <apply>
       <partialdiff></partialdiff>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>u</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <apply>
      <divide></divide>
      <apply>
       <times></times>
       <ci>d</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>u</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <apply>
       <times></times>
       <ci>d</ci>
       <ci>σ</ci>
      </apply>
     </apply>
     <apply>
      <minus></minus>
      <apply>
       <divide></divide>
       <apply>
        <partialdiff></partialdiff>
        <ci>P</ci>
       </apply>
       <apply>
        <partialdiff></partialdiff>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>q</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \frac{dq_{1}}{d\sigma}=\frac{\partial P}{\partial u_{1}}\quad\quad\frac{du_{1}%
}{d\sigma}=-\frac{\partial P}{\partial q_{1}}
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Hamiltonian_optics:151">
 <semantics>
  <mrow>
   <mrow>
    <mfrac>
     <mrow>
      <mi>d</mi>
      <msub>
       <mi>q</mi>
       <mn>2</mn>
      </msub>
     </mrow>
     <mrow>
      <mi>d</mi>
      <mi>σ</mi>
     </mrow>
    </mfrac>
    <mo>=</mo>
    <mfrac>
     <mrow>
      <mo>∂</mo>
      <mi>P</mi>
     </mrow>
     <mrow>
      <mo>∂</mo>
      <msub>
       <mi>u</mi>
       <mn>2</mn>
      </msub>
     </mrow>
    </mfrac>
   </mrow>
   <mrow>
    <mfrac>
     <mrow>
      <mi>d</mi>
      <msub>
       <mi>u</mi>
       <mn>2</mn>
      </msub>
     </mrow>
     <mrow>
      <mi>d</mi>
      <mi>σ</mi>
     </mrow>
    </mfrac>
    <mo>=</mo>
    <mrow>
     <mo>-</mo>
     <mfrac>
      <mrow>
       <mo>∂</mo>
       <mi>P</mi>
      </mrow>
      <mrow>
       <mo>∂</mo>
       <msub>
        <mi>q</mi>
        <mn>2</mn>
       </msub>
      </mrow>
     </mfrac>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <eq></eq>
     <apply>
      <divide></divide>
      <apply>
       <times></times>
       <ci>d</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>q</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
      <apply>
       <times></times>
       <ci>d</ci>
       <ci>σ</ci>
      </apply>
     </apply>
     <apply>
      <divide></divide>
      <apply>
       <partialdiff></partialdiff>
       <ci>P</ci>
      </apply>
      <apply>
       <partialdiff></partialdiff>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>u</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <apply>
      <divide></divide>
      <apply>
       <times></times>
       <ci>d</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>u</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
      <apply>
       <times></times>
       <ci>d</ci>
       <ci>σ</ci>
      </apply>
     </apply>
     <apply>
      <minus></minus>
      <apply>
       <divide></divide>
       <apply>
        <partialdiff></partialdiff>
        <ci>P</ci>
       </apply>
       <apply>
        <partialdiff></partialdiff>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>q</ci>
         <cn type="integer">2</cn>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \frac{dq_{2}}{d\sigma}=\frac{\partial P}{\partial u_{2}}\quad\quad\frac{du_{2}%
}{d\sigma}=-\frac{\partial P}{\partial q_{2}}
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Hamiltonian_optics:152">
 <semantics>
  <mrow>
   <mrow>
    <mfrac>
     <mrow>
      <mi>d</mi>
      <msub>
       <mi>q</mi>
       <mn>3</mn>
      </msub>
     </mrow>
     <mrow>
      <mi>d</mi>
      <mi>σ</mi>
     </mrow>
    </mfrac>
    <mo>=</mo>
    <mfrac>
     <mrow>
      <mo>∂</mo>
      <mi>P</mi>
     </mrow>
     <mrow>
      <mo>∂</mo>
      <msub>
       <mi>u</mi>
       <mn>3</mn>
      </msub>
     </mrow>
    </mfrac>
   </mrow>
   <mrow>
    <mfrac>
     <mrow>
      <mi>d</mi>
      <msub>
       <mi>u</mi>
       <mn>3</mn>
      </msub>
     </mrow>
     <mrow>
      <mi>d</mi>
      <mi>σ</mi>
     </mrow>
    </mfrac>
    <mo>=</mo>
    <mrow>
     <mo>-</mo>
     <mfrac>
      <mrow>
       <mo>∂</mo>
       <mi>P</mi>
      </mrow>
      <mrow>
       <mo>∂</mo>
       <msub>
        <mi>q</mi>
        <mn>3</mn>
       </msub>
      </mrow>
     </mfrac>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <eq></eq>
     <apply>
      <divide></divide>
      <apply>
       <times></times>
       <ci>d</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>q</ci>
        <cn type="integer">3</cn>
       </apply>
      </apply>
      <apply>
       <times></times>
       <ci>d</ci>
       <ci>σ</ci>
      </apply>
     </apply>
     <apply>
      <divide></divide>
      <apply>
       <partialdiff></partialdiff>
       <ci>P</ci>
      </apply>
      <apply>
       <partialdiff></partialdiff>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>u</ci>
        <cn type="integer">3</cn>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <apply>
      <divide></divide>
      <apply>
       <times></times>
       <ci>d</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>u</ci>
        <cn type="integer">3</cn>
       </apply>
      </apply>
      <apply>
       <times></times>
       <ci>d</ci>
       <ci>σ</ci>
      </apply>
     </apply>
     <apply>
      <minus></minus>
      <apply>
       <divide></divide>
       <apply>
        <partialdiff></partialdiff>
        <ci>P</ci>
       </apply>
       <apply>
        <partialdiff></partialdiff>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>q</ci>
         <cn type="integer">3</cn>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \frac{dq_{3}}{d\sigma}=\frac{\partial P}{\partial u_{3}}\quad\quad\frac{du_{3}%
}{d\sigma}=-\frac{\partial P}{\partial q_{3}}
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Hamiltonian_optics:153">
 <semantics>
  <mrow>
   <mi>P</mi>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mi>𝐩</mi>
     <mo>⋅</mo>
     <mi>𝐩</mi>
    </mrow>
    <mo>-</mo>
    <msup>
     <mi>n</mi>
     <mn>2</mn>
    </msup>
   </mrow>
   <mo>=</mo>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <ci>P</ci>
     <apply>
      <minus></minus>
      <apply>
       <ci>normal-⋅</ci>
       <ci>𝐩</ci>
       <ci>𝐩</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>n</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <cn type="integer">0</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   P=\mathbf{p}\cdot\mathbf{p}-n^{2}=0
  </annotation>
 </semantics>
</math>

</p>

<p>where the optical momentum is given by</p>

<p>

<math display="block" id="Hamiltonian_optics:154">
 <semantics>
  <mrow>
   <mi>𝐩</mi>
   <mo>=</mo>
   <mrow>
    <mrow>
     <msub>
      <mi>u</mi>
      <mn>1</mn>
     </msub>
     <mrow>
      <mo>∇</mo>
      <msub>
       <mi>q</mi>
       <mn>1</mn>
      </msub>
     </mrow>
    </mrow>
    <mo>+</mo>
    <mrow>
     <msub>
      <mi>u</mi>
      <mn>2</mn>
     </msub>
     <mrow>
      <mo>∇</mo>
      <msub>
       <mi>q</mi>
       <mn>2</mn>
      </msub>
     </mrow>
    </mrow>
    <mo>+</mo>
    <mrow>
     <msub>
      <mi>u</mi>
      <mn>3</mn>
     </msub>
     <mrow>
      <mo>∇</mo>
      <msub>
       <mi>q</mi>
       <mn>3</mn>
      </msub>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>𝐩</ci>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>u</ci>
       <cn type="integer">1</cn>
      </apply>
      <apply>
       <ci>normal-∇</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>q</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>u</ci>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <ci>normal-∇</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>q</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>u</ci>
       <cn type="integer">3</cn>
      </apply>
      <apply>
       <ci>normal-∇</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>q</ci>
        <cn type="integer">3</cn>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{p}=u_{1}\nabla q_{1}+u_{2}\nabla q_{2}+u_{3}\nabla q_{3}
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Hamiltonian_optics:155">
 <semantics>
  <mrow>
   <mi></mi>
   <mo>=</mo>
   <mrow>
    <msub>
     <mi>u</mi>
     <mn>1</mn>
    </msub>
    <mrow>
     <mo>∥</mo>
     <mrow>
      <mrow>
       <mo>∇</mo>
       <mrow>
        <msub>
         <mi>q</mi>
         <mn>1</mn>
        </msub>
        <mrow>
         <mo>∥</mo>
         <mrow>
          <mfrac>
           <mrow>
            <mo>∇</mo>
            <msub>
             <mi>q</mi>
             <mn>1</mn>
            </msub>
           </mrow>
           <mrow>
            <mo>∥</mo>
            <mrow>
             <mo>∇</mo>
             <msub>
              <mi>q</mi>
              <mn>1</mn>
             </msub>
            </mrow>
            <mo>∥</mo>
           </mrow>
          </mfrac>
          <mo>+</mo>
          <msub>
           <mi>u</mi>
           <mn>2</mn>
          </msub>
         </mrow>
         <mo>∥</mo>
        </mrow>
       </mrow>
      </mrow>
      <mrow>
       <mo>∇</mo>
       <mrow>
        <msub>
         <mi>q</mi>
         <mn>2</mn>
        </msub>
        <mrow>
         <mo>∥</mo>
         <mrow>
          <mfrac>
           <mrow>
            <mo>∇</mo>
            <msub>
             <mi>q</mi>
             <mn>2</mn>
            </msub>
           </mrow>
           <mrow>
            <mo>∥</mo>
            <mrow>
             <mo>∇</mo>
             <msub>
              <mi>q</mi>
              <mn>2</mn>
             </msub>
            </mrow>
            <mo>∥</mo>
           </mrow>
          </mfrac>
          <mo>+</mo>
          <msub>
           <mi>u</mi>
           <mn>3</mn>
          </msub>
         </mrow>
         <mo>∥</mo>
        </mrow>
       </mrow>
      </mrow>
      <mrow>
       <mo>∇</mo>
       <msub>
        <mi>q</mi>
        <mn>3</mn>
       </msub>
      </mrow>
     </mrow>
     <mo>∥</mo>
    </mrow>
    <mfrac>
     <mrow>
      <mo>∇</mo>
      <msub>
       <mi>q</mi>
       <mn>3</mn>
      </msub>
     </mrow>
     <mrow>
      <mo>∥</mo>
      <mrow>
       <mo>∇</mo>
       <msub>
        <mi>q</mi>
        <mn>3</mn>
       </msub>
      </mrow>
      <mo>∥</mo>
     </mrow>
    </mfrac>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <csymbol cd="latexml">absent</csymbol>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>u</ci>
      <cn type="integer">1</cn>
     </apply>
     <apply>
      <csymbol cd="latexml">norm</csymbol>
      <apply>
       <times></times>
       <apply>
        <ci>normal-∇</ci>
        <apply>
         <times></times>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>q</ci>
          <cn type="integer">1</cn>
         </apply>
         <apply>
          <csymbol cd="latexml">norm</csymbol>
          <apply>
           <plus></plus>
           <apply>
            <divide></divide>
            <apply>
             <ci>normal-∇</ci>
             <apply>
              <csymbol cd="ambiguous">subscript</csymbol>
              <ci>q</ci>
              <cn type="integer">1</cn>
             </apply>
            </apply>
            <apply>
             <csymbol cd="latexml">norm</csymbol>
             <apply>
              <ci>normal-∇</ci>
              <apply>
               <csymbol cd="ambiguous">subscript</csymbol>
               <ci>q</ci>
               <cn type="integer">1</cn>
              </apply>
             </apply>
            </apply>
           </apply>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <ci>u</ci>
            <cn type="integer">2</cn>
           </apply>
          </apply>
         </apply>
        </apply>
       </apply>
       <apply>
        <ci>normal-∇</ci>
        <apply>
         <times></times>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>q</ci>
          <cn type="integer">2</cn>
         </apply>
         <apply>
          <csymbol cd="latexml">norm</csymbol>
          <apply>
           <plus></plus>
           <apply>
            <divide></divide>
            <apply>
             <ci>normal-∇</ci>
             <apply>
              <csymbol cd="ambiguous">subscript</csymbol>
              <ci>q</ci>
              <cn type="integer">2</cn>
             </apply>
            </apply>
            <apply>
             <csymbol cd="latexml">norm</csymbol>
             <apply>
              <ci>normal-∇</ci>
              <apply>
               <csymbol cd="ambiguous">subscript</csymbol>
               <ci>q</ci>
               <cn type="integer">2</cn>
              </apply>
             </apply>
            </apply>
           </apply>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <ci>u</ci>
            <cn type="integer">3</cn>
           </apply>
          </apply>
         </apply>
        </apply>
       </apply>
       <apply>
        <ci>normal-∇</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>q</ci>
         <cn type="integer">3</cn>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <divide></divide>
      <apply>
       <ci>normal-∇</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>q</ci>
        <cn type="integer">3</cn>
       </apply>
      </apply>
      <apply>
       <csymbol cd="latexml">norm</csymbol>
       <apply>
        <ci>normal-∇</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>q</ci>
         <cn type="integer">3</cn>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   =u_{1}\|\nabla q_{1}\|\frac{\nabla q_{1}}{\|\nabla q_{1}\|}+u_{2}\|\nabla q_{2%
}\|\frac{\nabla q_{2}}{\|\nabla q_{2}\|}+u_{3}\|\nabla q_{3}\|\frac{\nabla q_{%
3}}{\|\nabla q_{3}\|}
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Hamiltonian_optics:156">
 <semantics>
  <mrow>
   <mi></mi>
   <mo>=</mo>
   <mrow>
    <mrow>
     <msub>
      <mi>u</mi>
      <mn>1</mn>
     </msub>
     <msub>
      <mi>a</mi>
      <mn>1</mn>
     </msub>
     <msub>
      <mover accent="true">
       <mi>𝐞</mi>
       <mo stretchy="false">^</mo>
      </mover>
      <mn>1</mn>
     </msub>
    </mrow>
    <mo>+</mo>
    <mrow>
     <msub>
      <mi>u</mi>
      <mn>2</mn>
     </msub>
     <msub>
      <mi>a</mi>
      <mn>2</mn>
     </msub>
     <msub>
      <mover accent="true">
       <mi>𝐞</mi>
       <mo stretchy="false">^</mo>
      </mover>
      <mn>2</mn>
     </msub>
    </mrow>
    <mo>+</mo>
    <mrow>
     <msub>
      <mi>u</mi>
      <mn>3</mn>
     </msub>
     <msub>
      <mi>a</mi>
      <mn>3</mn>
     </msub>
     <msub>
      <mover accent="true">
       <mi>𝐞</mi>
       <mo stretchy="false">^</mo>
      </mover>
      <mn>3</mn>
     </msub>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <csymbol cd="latexml">absent</csymbol>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>u</ci>
       <cn type="integer">1</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>a</ci>
       <cn type="integer">1</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <apply>
        <ci>normal-^</ci>
        <ci>𝐞</ci>
       </apply>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>u</ci>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>a</ci>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <apply>
        <ci>normal-^</ci>
        <ci>𝐞</ci>
       </apply>
       <cn type="integer">2</cn>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>u</ci>
       <cn type="integer">3</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>a</ci>
       <cn type="integer">3</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <apply>
        <ci>normal-^</ci>
        <ci>𝐞</ci>
       </apply>
       <cn type="integer">3</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   =u_{1}a_{1}\mathbf{\hat{e}}_{1}+u_{2}a_{2}\mathbf{\hat{e}}_{2}+u_{3}a_{3}%
\mathbf{\hat{e}}_{3}
  </annotation>
 </semantics>
</math>

</p>

<p>and 

<math display="inline" id="Hamiltonian_optics:157">
 <semantics>
  <msub>
   <mover accent="true">
    <mi>𝐞</mi>
    <mo stretchy="false">^</mo>
   </mover>
   <mn>1</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <apply>
     <ci>normal-^</ci>
     <ci>𝐞</ci>
    </apply>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{\hat{e}}_{1}
  </annotation>
 </semantics>
</math>

, 

<math display="inline" id="Hamiltonian_optics:158">
 <semantics>
  <msub>
   <mover accent="true">
    <mi>𝐞</mi>
    <mo stretchy="false">^</mo>
   </mover>
   <mn>2</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <apply>
     <ci>normal-^</ci>
     <ci>𝐞</ci>
    </apply>
    <cn type="integer">2</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{\hat{e}}_{2}
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Hamiltonian_optics:159">
 <semantics>
  <msub>
   <mover accent="true">
    <mi>𝐞</mi>
    <mo stretchy="false">^</mo>
   </mover>
   <mn>3</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <apply>
     <ci>normal-^</ci>
     <ci>𝐞</ci>
    </apply>
    <cn type="integer">3</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{\hat{e}}_{3}
  </annotation>
 </semantics>
</math>

 are <a href="unit_vectors" title="wikilink">unit vectors</a>. A particular case is obtained when these vectors form an <a href="orthonormal_basis" title="wikilink">orthonormal basis</a>, that is, they are all perpendicular to each other. In that case, 

<math display="inline" id="Hamiltonian_optics:160">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>u</mi>
     <mi>k</mi>
    </msub>
    <msub>
     <mi>a</mi>
     <mi>k</mi>
    </msub>
   </mrow>
   <mo>/</mo>
   <mi>n</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <divide></divide>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>u</ci>
      <ci>k</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>a</ci>
      <ci>k</ci>
     </apply>
    </apply>
    <ci>n</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   u_{k}a_{k}/n
  </annotation>
 </semantics>
</math>

 is the cosine of the angle the optical momentum 

<math display="inline" id="Hamiltonian_optics:161">
 <semantics>
  <mi>𝐩</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>𝐩</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{p}
  </annotation>
 </semantics>
</math>

 makes to unit vector 

<math display="inline" id="Hamiltonian_optics:162">
 <semantics>
  <msub>
   <mover accent="true">
    <mi>𝐞</mi>
    <mo stretchy="false">^</mo>
   </mover>
   <mi>k</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <apply>
     <ci>normal-^</ci>
     <ci>𝐞</ci>
    </apply>
    <ci>k</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{\hat{e}}_{k}
  </annotation>
 </semantics>
</math>

.</p>
<h2 id="see-also">See also</h2>
<ul>
<li><a href="Hamiltonian_mechanics" title="wikilink">Hamiltonian mechanics</a></li>
<li><a href="Calculus_of_variations#Applications" title="wikilink">Calculus of variations</a></li>
</ul>
<h2 id="references">References</h2>

<p>"</p>

<p><a class="uri" href="Category:Optics" title="wikilink">Category:Optics</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1">Vasudevan Lakshminarayanan et al., <em>Lagrangian Optics</em>, Springer Netherlands, 2011 [ISBN 978-0792375821]<a href="#fnref1">↩</a></li>
<li id="fn2">H. A. Buchdahl, <em>An Introduction to Hamiltonian Optics</em>, Dover Publications, 1993 [ISBN 978-0486675978]<a href="#fnref2">↩</a></li>
<li id="fn3">Julio Chaves, <em>Introduction to Nonimaging Optics</em>, CRC Press, 2008 [ISBN 978-1420054293]<a href="#fnref3">↩</a></li>
<li id="fn4">Roland Winston et al., <em>Nonimaging Optics</em>, Academic Press, 2004 [ISBN 978-0127597515]<a href="#fnref4">↩</a></li>
<li id="fn5"></li>
<li id="fn6">Dietrich Marcuse, <em>Light Transmission Optics</em>, Van Nostrand Reinhold Company, New York, 1972 [ISBN 978-0894643057]<a href="#fnref6">↩</a></li>
<li id="fn7">Rudolf Karl Luneburg,<em>Mathematical Theory of Optics</em>, University of California Press, Berkeley, CA, 1964, p. 90.<a href="#fnref7">↩</a></li>
<li id="fn8"></li>
<li id="fn9"></li>
<li id="fn10"></li>
<li id="fn11"></li>
<li id="fn12"></li>
</ol>
</section>
</body>
</html>

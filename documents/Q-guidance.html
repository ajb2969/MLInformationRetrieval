<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="420">Q-guidance</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Q-guidance</h1>
<hr/>

<p><strong>Q-guidance</strong> is a method of missile <a href="guidance_system" title="wikilink">guidance</a> used in some U.S. <a href="ballistic_missiles" title="wikilink">ballistic missiles</a> and some civilian space flights. It was developed in the 1950s by <a href="J._Halcombe_Laning" title="wikilink">J. Halcombe Laning</a> and Richard Battin at the <a href="Charles_Stark_Draper_Laboratory" title="wikilink">MIT Instrumentation Lab</a>.</p>

<p>Q-guidance is used for missiles whose trajectory consists of a relatively short <a href="boost_phase" title="wikilink">boost phase</a> (or powered phase) during which the missile's propulsion system operates, followed by a <a href="coast_phase" title="wikilink">ballistic phase</a> during which the missile coasts to its target under the influence of gravity. (<a href="Cruise_missile" title="wikilink">Cruise missiles</a> use different guidance methods). The objective of Q-guidance is to hit a specified target at a specified time (if there is some flexibility as to the time the target should be hit then other types of guidance can be used).</p>
<h2 id="early-implementations">Early Implementations</h2>

<p>At the time Q-guidance was developed the main competitive method was called Delta-guidance. According to Mackenzie,<a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a> <a href="Titan_missile" title="wikilink">Titan</a>, some versions of <a href="Atlas_missile" title="wikilink">Atlas</a>, <a href="LGM-30_Minuteman" title="wikilink">Minuteman</a> I and II used Delta-guidance, while Q-guidance was used for <a href="Thor_missile" title="wikilink">Thor IRBM</a> and <a href="Polaris_missile" title="wikilink">Polaris</a>, and presumably <a href="Poseidon_missile" title="wikilink">Poseidon</a>. It appears, from monitoring of test launches, that early Soviet ICBMs used a variant of Delta-guidance.</p>
<h2 id="delta-guidance-overview">Delta-guidance overview</h2>

<p>Delta-guidance is based on adherence to a pre-planned reference trajectory, which is developed before the flight using ground-based computers and stored in the missile's guidance system. In flight, the actual trajectory is modeled mathematically as a <a href="Taylor_series" title="wikilink">Taylor series</a> expansion around the reference trajectory. The guidance system attempts to zero the linear terms of this expression, i.e. to bring the missile back to the pre-planned trajectory. For this reason, Delta-guidance is sometimes referred to as "fly [along] the wire", where the (imaginary) wire refers to the reference trajectory.<a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a></p>

<p>In contrast, Q-guidance is a dynamic method, reminiscent of the theories <a href="dynamic_programming" title="wikilink">dynamic programming</a> or <a href="State_space_(controls)" title="wikilink">state based feedback</a>. In essence, it says "never mind where we were supposed to be, given where we are what should we do to make progress towards the goal of reaching the required target at the required time". To do this it relies on the concept of "velocity to be gained".</p>
<h2 id="velocity-to-be-gained">Velocity To Be Gained</h2>

<p>At a given time <em>t</em> and for a given vehicle position <em>r</em>, the correlated velocity vector <em>V</em><sub>c</sub> is defined as follows: if the vehicle had the velocity <em>V</em><sub>c</sub> and the propulsion system was turned off, then the missile would reach the desired target at the desired time under the influence of gravity. In some sense, <em>V</em><sub>c</sub> is the desired velocity.</p>

<p>The actual velocity of the missile is denoted by <em>V</em><sub>m</sub> and the missile is subject to both the acceleration due to gravity <em>g</em> and that due to the engines <em>a</em><sub>T</sub>. The velocity to be gained is defined as the difference between <em>V</em><sub>c</sub> and <em>V</em><sub>m</sub>:</p>

<p>

<math display="block" id="Q-guidance:0">
 <semantics>
  <mrow>
   <msub>
    <mi>V</mi>
    <mrow>
     <mi>T</mi>
     <mi>B</mi>
     <mi>G</mi>
    </mrow>
   </msub>
   <mo>=</mo>
   <mrow>
    <msub>
     <mi>V</mi>
     <mi>c</mi>
    </msub>
    <mo>-</mo>
    <msub>
     <mi>V</mi>
     <mi>m</mi>
    </msub>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>V</ci>
     <apply>
      <times></times>
      <ci>T</ci>
      <ci>B</ci>
      <ci>G</ci>
     </apply>
    </apply>
    <apply>
     <minus></minus>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>V</ci>
      <ci>c</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>V</ci>
      <ci>m</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   V_{TBG}=V_{c}-V_{m}
  </annotation>
 </semantics>
</math>

</p>

<p>A simple guidance strategy is to apply acceleration (i.e. engine thrust) in the direction of <em>V</em><sub>TBG</sub>. This will have the effect of making the actual velocity come closer to <em>V</em><sub>c</sub>. When they become equal (i.e. when <em>V</em><sub>TBG</sub> becomes identically zero) it is time to shut off the engines, since the missile is by definition able to reach the desired target at the desired time on its own.</p>

<p>The only remaining issue is how to compute <em>V</em><sub>TBG</sub> easily from information available on board the vehicle.</p>
<h2 id="the-q-matrix">The Q Matrix</h2>

<p>A remarkably simple differential equation can be used to compute the velocity to be gained:</p>

<p>

<math display="block" id="Q-guidance:1">
 <semantics>
  <mrow>
   <mfrac>
    <mrow>
     <mi>d</mi>
     <msub>
      <mi>V</mi>
      <mrow>
       <mi>T</mi>
       <mi>B</mi>
       <mi>G</mi>
      </mrow>
     </msub>
    </mrow>
    <mrow>
     <mi>d</mi>
     <mi>t</mi>
    </mrow>
   </mfrac>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mo>-</mo>
     <msub>
      <mi>a</mi>
      <mi>T</mi>
     </msub>
    </mrow>
    <mo>-</mo>
    <mrow>
     <mi>Q</mi>
     <msub>
      <mi>V</mi>
      <mrow>
       <mi>T</mi>
       <mi>B</mi>
       <mi>G</mi>
      </mrow>
     </msub>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <divide></divide>
     <apply>
      <times></times>
      <ci>d</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>V</ci>
       <apply>
        <times></times>
        <ci>T</ci>
        <ci>B</ci>
        <ci>G</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <ci>d</ci>
      <ci>t</ci>
     </apply>
    </apply>
    <apply>
     <minus></minus>
     <apply>
      <minus></minus>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>a</ci>
       <ci>T</ci>
      </apply>
     </apply>
     <apply>
      <times></times>
      <ci>Q</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>V</ci>
       <apply>
        <times></times>
        <ci>T</ci>
        <ci>B</ci>
        <ci>G</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \frac{dV_{TBG}}{dt}=-a_{T}-QV_{TBG}
  </annotation>
 </semantics>
</math>

</p>

<p>where the <em>Q</em> matrix is defined by</p>

<p>

<math display="block" id="Q-guidance:2">
 <semantics>
  <mrow>
   <mi>Q</mi>
   <mo>=</mo>
   <msub>
    <mrow>
     <mfrac>
      <mrow>
       <mo>∂</mo>
       <msub>
        <mi>V</mi>
        <mi>c</mi>
       </msub>
      </mrow>
      <mrow>
       <mo>∂</mo>
       <mi>r</mi>
      </mrow>
     </mfrac>
     <mo fence="true">|</mo>
    </mrow>
    <mrow>
     <msub>
      <mi>r</mi>
      <mi>T</mi>
     </msub>
     <mo>,</mo>
     <msub>
      <mi>t</mi>
      <mi>f</mi>
     </msub>
    </mrow>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>Q</ci>
    <apply>
     <csymbol cd="latexml">evaluated-at</csymbol>
     <apply>
      <divide></divide>
      <apply>
       <partialdiff></partialdiff>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>V</ci>
        <ci>c</ci>
       </apply>
      </apply>
      <apply>
       <partialdiff></partialdiff>
       <ci>r</ci>
      </apply>
     </apply>
     <list>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>r</ci>
       <ci>T</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>t</ci>
       <ci>f</ci>
      </apply>
     </list>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Q=\left.\frac{\partial V_{c}}{\partial r}\right|_{r_{T},t_{f}}
  </annotation>
 </semantics>
</math>

</p>

<p>where <em>Q</em> is a symmetric 3 by 3 time-varying matrix. (The vertical bar refers to the fact that the derivative must be evaluated for a given target position <em>r</em><sub>T</sub> and time of free flight <em>t</em><sub>f</sub>.)<a class="footnoteRef" href="#fn3" id="fnref3"><sup>3</sup></a> The calculation of this matrix is non-trivial, but can be performed offline before the flight; experience shows that the matrix is only slowly time varying, so only a few values of Q corresponding to different times during the flight need to be stored on board the vehicle.</p>

<p>In early applications the integration of the differential equation was performed using analog hardware, rather than a digital computer. Information about vehicle acceleration, velocity and position is supplied by the onboard <a href="Inertial_measurement_unit" title="wikilink">Inertial measurement unit</a>.</p>

<p><strong>Derivation of the equation</strong></p>

<p>Notation:</p>

<p><em>t</em> the current time</p>

<p><em>r</em> the current vehicle position vector</p>

<p><em>V</em><sub>m</sub> the current vehicle velocity vector</p>

<p><em>T</em> the time the vehicle will reach the target</p>

<p><em>t</em><sub>f</sub> the time of free flight for the correlated vehicle, i.e. t-T</p>

<p>[...]</p>
<h2 id="cross-product-steering">Cross Product Steering</h2>

<p>A reasonable strategy to gradually align the thrust vector to the <em>V</em><sub>TBG</sub> vector is to steer at a rate proportional to the cross product between them. A simple control strategy that does this is to steer at the rate</p>

<p>

<math display="block" id="Q-guidance:3">
 <semantics>
  <mrow>
   <mi>ω</mi>
   <mo>=</mo>
   <mrow>
    <mi>κ</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <msub>
       <mi>a</mi>
       <mi>T</mi>
      </msub>
      <mo>×</mo>
      <msub>
       <mi>V</mi>
       <mrow>
        <mi>T</mi>
        <mi>B</mi>
        <mi>G</mi>
       </mrow>
      </msub>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>ω</ci>
    <apply>
     <times></times>
     <ci>κ</ci>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>a</ci>
       <ci>T</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>V</ci>
       <apply>
        <times></times>
        <ci>T</ci>
        <ci>B</ci>
        <ci>G</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \omega=\kappa(a_{T}\times V_{TBG})
  </annotation>
 </semantics>
</math>

</p>

<p>where 

<math display="inline" id="Q-guidance:4">
 <semantics>
  <mi>κ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>κ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \kappa
  </annotation>
 </semantics>
</math>

 is a constant. This implicitly assumes that <em>V</em><sub>TBG</sub> remains roughly constant during the maneuver. A somewhat more clever strategy can be designed that takes into account the rate of time change of <em>V</em><sub>TBG</sub> as well, since this is available from the differential equation above.</p>

<p>This second control strategy is based on Battin's insight<a class="footnoteRef" href="#fn4" id="fnref4"><sup>4</sup></a> that "If you want to drive a vector to zero, it is [expedient] to align the time rate of change of the vector with the vector itself". This suggests setting the auto-pilot steering rate to</p>

<p>

<math display="block" id="Q-guidance:5">
 <semantics>
  <mrow>
   <mi>ω</mi>
   <mo>=</mo>
   <mrow>
    <mi>κ</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <msub>
       <mi>V</mi>
       <mrow>
        <mi>T</mi>
        <mi>B</mi>
        <mi>G</mi>
       </mrow>
      </msub>
      <mo>×</mo>
      <mfrac>
       <mrow>
        <mi>d</mi>
        <msub>
         <mi>V</mi>
         <mrow>
          <mi>T</mi>
          <mi>B</mi>
          <mi>G</mi>
         </mrow>
        </msub>
       </mrow>
       <mrow>
        <mi>d</mi>
        <mi>t</mi>
       </mrow>
      </mfrac>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>ω</ci>
    <apply>
     <times></times>
     <ci>κ</ci>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>V</ci>
       <apply>
        <times></times>
        <ci>T</ci>
        <ci>B</ci>
        <ci>G</ci>
       </apply>
      </apply>
      <apply>
       <divide></divide>
       <apply>
        <times></times>
        <ci>d</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>V</ci>
         <apply>
          <times></times>
          <ci>T</ci>
          <ci>B</ci>
          <ci>G</ci>
         </apply>
        </apply>
       </apply>
       <apply>
        <times></times>
        <ci>d</ci>
        <ci>t</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \omega=\kappa(V_{TBG}\times\frac{dV_{TBG}}{dt})
  </annotation>
 </semantics>
</math>

</p>

<p>Either of these methods are referred to as <strong>cross-product steering</strong>, and they are easy to implement in analog hardware.</p>

<p>Finally, when all components of <em>V</em><sub>TBG</sub> are small, the order to cut-off engine power can be given.</p>
<h2 id="references">References</h2>
<ul>
<li>D. Mackenzie: <em>Inventing Accuracy - A Historical Sociology of Nuclear Missile Guidance</em>, MIT Press, 1990, ISBN 0-262-13258-3</li>
</ul>
<ul>
<li>R. Battin: <em>An Introduction to the Mathematics and Methods of Astrodynamics</em>, AIAA, 1999, ISBN 1-56347-342-9 <a href="http://www.ngds-ku.org/Papers/Battin.pdf">Review</a></li>
</ul>
<ul>
<li>S. A. Kamal, A. Mirza: <em>[<a class="uri" href="http://www10.brinkster.com/drakamal/pub/confabst.htm#C66">http://www10.brinkster.com/drakamal/pub/confabst.htm#C66</a>: The Multi-Stage-Q System and the Inverse-Q System for Possible application in SLV]</em>, Proc. IBCAST 2005, Volume 3, Control and Simulation, Edited by Hussain SI, Munir A, Kiyani J, Samar R, Khan MA, National Center for Physics, Bhurban, KP, Pakistan, 2006, pp 27–33 <a href="http://www.ngds-ku.org/Papers/C66.pdf">Free Full Text</a></li>
</ul>
<ul>
<li>S. A. Kamal: <em>[<a class="uri" href="http://www10.brinkster.com/drakamal/pub/confabst.htm#C56">http://www10.brinkster.com/drakamal/pub/confabst.htm#C56</a>: Incompleteness of Cross-Product Steering and a Mathematical Formulation of Extended-Cross-Product Steering]</em>, Proc. IBCAST 2002, Volume 1, Advanced Materials, Computational Fluid Dynamics and Control Engineering, Edited by Hoorani HR, Munir A, Samar R, Zahir S, National Center for Physics, Bhurban, KP, Pakistan, 2003, pp 167–177 <a href="http://www.ngds-ku.org/Papers/C56.pdf">Free Full Text</a></li>
</ul>

<p>"</p>

<p><a class="uri" href="Category:Navigation" title="wikilink">Category:Navigation</a> <a href="Category:Missile_guidance" title="wikilink">Category:Missile guidance</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1">Mackenzie: Inventing Accuracy<a href="#fnref1">↩</a></li>
<li id="fn2"></li>
<li id="fn3">Battin: Introduction<a href="#fnref3">↩</a></li>
<li id="fn4">Battin: An Introduction<a href="#fnref4">↩</a></li>
</ol>
</section>
</body>
</html>

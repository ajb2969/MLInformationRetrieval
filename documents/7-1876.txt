   Duhamel's integral      Duhamel's integral   In theory of vibrations , Duhamel's integral is a way of calculating the response of linear systems and structures to arbitrary time-varying external excitation s.  Introduction  Background  The response of a linear, viscously damped single-degree of freedom (SDOF) system to a time-varying mechanical excitation p ( t ) is given by the following second-order ordinary differential equation        m     d  2   x   (  t  )     d   t  2      +   c    d  x   (  t  )     d  t     +   k  x   (  t  )     =   p   (  t  )            m       superscript  d  2   x  t     d   superscript  t  2        c      d  x  t     d  t       k  x  t      p  t     m\frac{{d^{2}x(t)}}{{dt^{2}}}+c\frac{{dx(t)}}{{dt}}+kx(t)=p(t)   where m is the (equivalent) mass, x stands for the amplitude of vibration, t for time, c for the viscous damping coefficient, and k for the stiffness of the system or structure.  If a system is initially rest at its equilibrium position, from where it is acted upon by a unit-impulse at the instance t =0, i.e., p ( t ) in the equation above is a Dirac delta function  δ ( t ),     x   (  0  )    =      d  x    d  t    |    t  =  0    =  0          x  0    evaluated-at      d  x     d  t      t  0         0     x(0)=\left.{\frac{{dx}}{{dt}}}\right|_{t=0}=0   , then by solving the differential equation one can get a fundamental solution (known as a unit-impulse response function )       h   (  t  )    =   {         1   m   ω  d       e   -   ς   ω  n   t      sin    ω  d   t     ,      t  >  0        0  ,      t  <  0             h  t    cases      1    m   subscript  ω  d      superscript  e      ς   subscript  ω  n   t          subscript  ω  d   t       t  0   0    t  0      h(t)=\begin{cases}\frac{1}{{m\omega_{d}}}e^{-\varsigma\omega_{n}t}\sin\omega_{%
 d}t,&t>0\\
 0,&t<0\end{cases}   where    ς  =   c   2    k  m          ς    c    2      k  m        \varsigma=\frac{c}{2\sqrt{km}}   is called the damping ratio of the system,     ω  n   =    k  m         subscript  ω  n       k  m      \omega_{n}=\sqrt{\frac{k}{m}}   is the natural angular frequency of the undamped system (when c =0) and     ω  d   =    ω  n     1  -   ς  2           subscript  ω  d      subscript  ω  n       1   superscript  ς  2        \omega_{d}=\omega_{n}\sqrt{1-\varsigma^{2}}   is the circular frequency when damping effect is taken into account (when    c  ≠  0      c  0    c\neq 0   ). If the impulse happens at t = τ instead of t =0, i.e.     p   (  t  )    =   δ   (   t  -  τ   )          p  t     δ    t  τ      p(t)=\delta(t-\tau)   , the impulse response is       h   (   t  -  τ   )    =    1   m   ω  d      e   -   ς   ω  n    (   t  -  τ   )       sin   [    ω  d    (   t  -  τ   )    ]           h    t  τ        1    m   subscript  ω  d      superscript  e      ς   subscript  ω  n     t  τ           subscript  ω  d     t  τ        h(t-\tau)=\frac{1}{{m\omega_{d}}}e^{-\varsigma\omega_{n}(t-\tau)}\sin[\omega_{%
 d}(t-\tau)]   ，    t  ≥  τ      t  τ    t\geq\tau     Conclusion  Regarding the arbitrarily varying excitation p ( t ) as a superposition of a series of impulses:       x   (  t  )    =    ∫  0  t    p   (  τ  )   h   (   t  -  τ   )   d  τ          x  t     superscript   subscript   0   t     p  τ  h    t  τ   d  τ      x(t)=\int_{0}^{t}{p(\tau)h(t-\tau)d\tau}   , and replacing the summation by integration , the above equation is strictly valid       x   (  t  )    =    1   m   ω  d       ∫  0  t    p   (  τ  )    e   -   ς   ω  n    (   t  -  τ   )       sin   [    ω  d    (   t  -  τ   )    ]    d  τ           x  t       1    m   subscript  ω  d       superscript   subscript   0   t     p  τ   superscript  e      ς   subscript  ω  n     t  τ           subscript  ω  d     t  τ     d  τ       x(t)=\frac{1}{{m\omega_{d}}}\int_{0}^{t}{p(\tau)e^{-\varsigma\omega_{n}(t-\tau%
 )}\sin[\omega_{d}(t-\tau)]d\tau}   Substituting the expression of h ( t - τ ) into the above equation leads to the general expression of Duhamel's integral          d  2   x   (  t  )     d   t  2     +    c  ¯     d  x   (  t  )     d  t     +    k  ¯   x   (  t  )     =  0             superscript  d  2   x  t     d   superscript  t  2        normal-¯  c       d  x  t     d  t        normal-¯  k   x  t    0    \frac{{d^{2}x(t)}}{{dt^{2}}}+\bar{c}\frac{{dx(t)}}{{dt}}+\bar{k}x(t)=0     Mathematical Proof  The above SDOF dynamic equilibrium equation in the case p(t)=0 is the homogeneous equation :        c  ¯   =   c  m    ,    k  ¯   =   k  m       formulae-sequence     normal-¯  c     c  m       normal-¯  k     k  m      \bar{c}=\frac{c}{m},\bar{k}=\frac{k}{m}   , where      x  h    (  t  )    =     C  1   ⋅   e   -    1  2    (    c  ¯   +      c  ¯   2   -   4  ⋅   k  ¯       )   t      +    C  2   ⋅   e    1  2    (    -   c  ¯    +      c  ¯   2   -   4  ⋅   k  ¯       )   t             subscript  x  h   t      normal-⋅   subscript  C  1    superscript  e        1  2      normal-¯  c        superscript   normal-¯  c   2    normal-⋅  4   normal-¯  k       t       normal-⋅   subscript  C  2    superscript  e      1  2        normal-¯  c         superscript   normal-¯  c   2    normal-⋅  4   normal-¯  k       t        x_{h}(t)=C_{1}\cdot e^{-\frac{1}{2}(\bar{c}+\sqrt{\bar{c}^{2}-4\cdot\bar{k}})t%
 }+C_{2}\cdot e^{\frac{1}{2}(-\bar{c}+\sqrt{\bar{c}^{2}-4\cdot\bar{k}})t}   The solution of this equation is:       A  =    1  2    (    c  ¯   -      c  ¯   2   -   4   k  ¯       )     ,    B  =    1  2    (    c  ¯   +      c  ¯   2   -   4   k  ¯       )     ,    P  =      c  ¯   2   -   4   k  ¯       ,   P  =   B  -  A         formulae-sequence    A      1  2      normal-¯  c        superscript   normal-¯  c   2     4   normal-¯  k          formulae-sequence    B      1  2      normal-¯  c        superscript   normal-¯  c   2     4   normal-¯  k          formulae-sequence    P       superscript   normal-¯  c   2     4   normal-¯  k         P    B  A        A=\frac{1}{2}(\bar{c}-\sqrt{\bar{c}^{2}-4\bar{k}}),\;B=\frac{1}{2}(\bar{c}+%
 \sqrt{\bar{c}^{2}-4\bar{k}}),\;P=\sqrt{\bar{c}^{2}-4\bar{k}},\;P=B-A   The substitution      x  h    (  t  )    =     C  1     e   -   B  ⋅  t       +    C  2    e   -   A  ⋅  t              subscript  x  h   t        subscript  C  1    superscript  e     normal-⋅  B  t         subscript  C  2    superscript  e     normal-⋅  A  t         x_{h}(t)=C_{1}e^{-B\cdot t}\;+\;C_{2}e^{-A\cdot t}   leads to:          d  2   x   (  t  )     d   t  2     +    c  ¯     d  x   (  t  )     d  t     +    k  ¯   x   (  t  )     =    p   (  t  )    ¯              superscript  d  2   x  t     d   superscript  t  2        normal-¯  c       d  x  t     d  t        normal-¯  k   x  t     normal-¯    p  t      \frac{{d^{2}x(t)}}{{dt^{2}}}+\bar{c}\frac{{dx(t)}}{{dt}}+\bar{k}x(t)=\bar{p(t)}   One partial solution of the non-homogeneous equation      p   (  t  )    ¯   =    p   (  t  )    m        normal-¯    p  t        p  t   m     \bar{p(t)}=\frac{p(t)}{m}   , where      x  p    (  t  )    =     ∫       p   (  t  )    ¯   ⋅   e   A  t     d  t   ⋅   e   -   A  t       -   ∫       p   (  t  )    ¯   ⋅   e   B  t     d  t   ⋅   e   -   B  t        P          subscript  x  p   t          normal-⋅     normal-⋅   normal-¯    p  t     superscript  e    A  t     d  t    superscript  e      A  t          normal-⋅     normal-⋅   normal-¯    p  t     superscript  e    B  t     d  t    superscript  e      B  t        P     x_{p}(t)=\frac{\int{\bar{p(t)}\cdot e^{At}dt}\cdot e^{-At}-\int{\bar{p(t)}%
 \cdot e^{Bt}dt}\cdot e^{-Bt}}{P}   , could be obtained by the Lagrangian method for deriving partial solution of non-homogeneous ordinary differential equations .  This solution has the form:          ∫      p   (  t  )    ¯   ⋅   e   A  t     d  t    |    t  =  z    =   Q  z    ,      ∫      p   (  t  )    ¯   ⋅   e   B  t     d  t    |    t  =  z    =   R  z       formulae-sequence     evaluated-at       normal-⋅   normal-¯    p  t     superscript  e    A  t     d  t      t  z     subscript  Q  z       evaluated-at       normal-⋅   normal-¯    p  t     superscript  e    B  t     d  t      t  z     subscript  R  z      \int{\bar{p(t)}\cdot e^{At}dt}|_{t=z}=Q_{z},\int{\bar{p(t)}\cdot e^{Bt}dt}|_{t%
 =z}=R_{z}   Now substituting      ∫   x   (  t  )   d  t    |    t  =  z      evaluated-at      x  t  d  t      t  z     \int{x(t)dt}|_{t=z}   ,where      x  p    (  t  )    =      Q  t   ⋅   e   -   A  t      -    R  t   ⋅   e   -   B  t       P          subscript  x  p   t        normal-⋅   subscript  Q  t    superscript  e      A  t       normal-⋅   subscript  R  t    superscript  e      B  t       P     x_{p}(t)=\frac{Q_{t}\cdot e^{-At}-R_{t}\cdot e^{-Bt}}{P}   is the primitive of x(t) computed at t=z , in the case z=t this integral is the primitive itself, yields:       x   (  t  )    =     x  h    (  t  )    +    x  p    (  t  )     =     C  1   ⋅   e   -   B  t      +    C  2   ⋅   e   -   A  t      +      Q  t   ⋅   e   -   A  t      -    R  t   ⋅   e   -   B  t       P            x  t        subscript  x  h   t      subscript  x  p   t            normal-⋅   subscript  C  1    superscript  e      B  t       normal-⋅   subscript  C  2    superscript  e      A  t           normal-⋅   subscript  Q  t    superscript  e      A  t       normal-⋅   subscript  R  t    superscript  e      B  t       P       x(t)=x_{h}(t)+x_{p}(t)=C_{1}\cdot e^{-Bt}+C_{2}\cdot e^{-At}+\frac{Q_{t}\cdot e%
 ^{-At}-R_{t}\cdot e^{-Bt}}{P}   Finally the general solution of the above non-homogeneous equation is represented as:        d  x    d  t    =     -    A   e   -   A  t      ⋅   C  2     -    B   e   -   B  t      ⋅   C  1     +    1  P    [       Q  t   ˙   ⋅   e   -   A  t      -    A   Q  t    ⋅   e   -   A  t      -     R  t   ˙   ⋅   e   -   B  t       +    B   R  t    ⋅   e   -   B  t       ]             d  x     d  t           normal-⋅    A   superscript  e      A  t       subscript  C  2      normal-⋅    B   superscript  e      B  t       subscript  C  1         1  P    delimited-[]       normal-⋅   normal-˙   subscript  Q  t     superscript  e      A  t       normal-⋅    A   subscript  Q  t     superscript  e      A  t       normal-⋅   normal-˙   subscript  R  t     superscript  e      B  t        normal-⋅    B   subscript  R  t     superscript  e      B  t            \frac{dx}{dt}=-Ae^{-At}\cdot C_{2}-Be^{-Bt}\cdot C_{1}+\frac{1}{P}[\dot{Q_{t}}%
 \cdot e^{-At}-AQ_{t}\cdot e^{-At}-\dot{R_{t}}\cdot e^{-Bt}+BR_{t}\cdot e^{-Bt}]   with time derivative:         Q  t   ˙   =    p   (  t  )    ⋅   e   A  t      ,     R  t   ˙   =    p   (  t  )    ⋅   e   B  t         formulae-sequence     normal-˙   subscript  Q  t     normal-⋅    p  t    superscript  e    A  t         normal-˙   subscript  R  t     normal-⋅    p  t    superscript  e    B  t        \dot{Q_{t}}=p(t)\cdot e^{At},\dot{R_{t}}=p(t)\cdot e^{Bt}   , where     C  1   ,   C  2       subscript  C  1    subscript  C  2     C_{1},C_{2}   In order to find the unknown constants        x   (  t  )    |    t  =  0    =  0   :     C  1   +   C  2   +      Q  0   ⋅  1   -    R  0   ⋅  1    P    =  0      normal-:     evaluated-at    x  t     t  0    0        subscript  C  1    subscript  C  2        normal-⋅   subscript  Q  0   1    normal-⋅   subscript  R  0   1    P    0     x(t)|_{t=0}=0:C_{1}+C_{2}+\frac{Q_{0}\cdot 1-R_{0}\cdot 1}{P}=0   , zero initial conditions will be applied:        C  1   +   C  2    =     R  0   -   Q  0    P          subscript  C  1    subscript  C  2         subscript  R  0    subscript  Q  0    P     C_{1}+C_{2}=\frac{R_{0}-Q_{0}}{P}   ⇒         d  x    d  t    |    t  =  0    =  0   :      -   A  ⋅   C  2     -   B  ⋅   C  1     +    1  P   ⋅   [    -   A  ⋅   Q  0     +   B  ⋅   R  0     ]     =  0      normal-:     evaluated-at      d  x     d  t      t  0    0            normal-⋅  A   subscript  C  2      normal-⋅  B   subscript  C  1      normal-⋅    1  P    delimited-[]       normal-⋅  A   subscript  Q  0      normal-⋅  B   subscript  R  0        0     \left.{\frac{{dx}}{{dt}}}\right|_{t=0}=0:-A\cdot C_{2}-B\cdot C_{1}+\frac{1}{P%
 }\cdot[-A\cdot Q_{0}+B\cdot R_{0}]=0           A  ⋅   C  2    +   B  ⋅   C  1     =    1  P   ⋅   [    B  ⋅   R  0    -   A  ⋅   Q  0     ]           normal-⋅  A   subscript  C  2     normal-⋅  B   subscript  C  1      normal-⋅    1  P    delimited-[]     normal-⋅  B   subscript  R  0     normal-⋅  A   subscript  Q  0         A\cdot C_{2}+B\cdot C_{1}=\frac{1}{P}\cdot[B\cdot R_{0}-A\cdot Q_{0}]   ⇒        C  1      +       C   2      =         R  0   -   Q  0    P          B  ⋅   C  1       +       A   ⋅   C  2       =        1  P    ⋅   [    B  ⋅   R  0    -   A  ⋅   Q  0     ]       |      C  1      =        R  0   P          C  2      =      -    Q  0   P          fragments     subscript  C  1    missing-subexpression     missing-subexpression    subscript  C  2    missing-subexpression     missing-subexpression        subscript  R  0    subscript  Q  0    P    missing-subexpression      normal-⋅  B   subscript  C  1     missing-subexpression     missing-subexpression    normal-⋅  A   subscript  C  2     missing-subexpression     missing-subexpression    normal-⋅    1  P    delimited-[]     normal-⋅  B   subscript  R  0     normal-⋅  A   subscript  Q  0         normal-|     subscript  C  1    missing-subexpression     missing-subexpression      subscript  R  0   P    missing-subexpression      subscript  C  2    missing-subexpression     missing-subexpression        subscript  Q  0   P        \left.{\begin{aligned}\displaystyle C_{1}&&\displaystyle\;+&&\displaystyle\;C_%
 {2}&&\displaystyle\;=&&\displaystyle\;\frac{R_{0}-Q_{0}}{P}&\\
 \displaystyle B\cdot C_{1}&&\displaystyle\;+&&\displaystyle\;A\cdot C_{2}&&%
 \displaystyle\;=&&\displaystyle\;\frac{1}{P}\cdot[B\cdot R_{0}-A\cdot Q_{0}]%
 \end{aligned}}\right|{\begin{aligned}\displaystyle C_{1}&&\displaystyle\;=&&%
 \displaystyle\;\frac{R_{0}}{P}&\\
 \displaystyle C_{2}&&\displaystyle\;=&&\displaystyle\;-\frac{Q_{0}}{P}\end{%
 aligned}}   Now combining both initial conditions together, the next system of equations is observed:      C  1     subscript  C  1    C_{1}   The back substitution of the constants    C  2     subscript  C  2    C_{2}   and     x   (  t  )    =       Q  t   -   Q  0    P   ⋅   e   -   A  ⋅  t      -      R  t   -   R  0    P   ⋅   e   -   B  ⋅  t             x  t      normal-⋅       subscript  Q  t    subscript  Q  0    P    superscript  e     normal-⋅  A  t       normal-⋅       subscript  R  t    subscript  R  0    P    superscript  e     normal-⋅  B  t         x(t)=\frac{Q_{t}-Q_{0}}{P}\cdot e^{-A\cdot t}-\frac{R_{t}-R_{0}}{P}\cdot e^{-B%
 \cdot t}   into the above expression for x(t) yields:       Q  t   -   Q  0        subscript  Q  t    subscript  Q  0     Q_{t}-Q_{0}   Replacing     R  t   -   R  0        subscript  R  t    subscript  R  0     R_{t}-R_{0}   and     x   (  t  )    =    1  P   ⋅   [     ∫  0  t        p   (  τ  )    ¯   ⋅   e   A  τ     d  τ   ⋅   e   -   A  t       -    ∫  0  t        p   (  τ  )    ¯   ⋅   e   B  τ     d  τ   ⋅   e   -   B  t        ]          x  t    normal-⋅    1  P    delimited-[]      superscript   subscript   0   t    normal-⋅     normal-⋅   normal-¯    p  τ     superscript  e    A  τ     d  τ    superscript  e      A  t         superscript   subscript   0   t    normal-⋅     normal-⋅   normal-¯    p  τ     superscript  e    B  τ     d  τ    superscript  e      B  t            x(t)=\frac{1}{P}\cdot[\int_{0}^{t}{\bar{p(\tau)}\cdot e^{A\tau}d\tau}\cdot e^{%
 -At}-\int_{0}^{t}{\bar{p(\tau)}\cdot e^{B\tau}d\tau}\cdot e^{-Bt}]   (the difference between the primitives at t=t and t=0 ) with definite integrals (by another variable τ ) will reveal the general solution with zero initial conditions, namely:       c  =   2  ξ  ω  m    ,   k  =    ω  2   m       formulae-sequence    c    2  ξ  ω  m      k     superscript  ω  2   m      c=2\xi\omega m,\;k=\omega^{2}m   Finally substituting      c  ¯   =   2  ξ  ω    ,    k  ¯   =   ω  2       formulae-sequence     normal-¯  c     2  ξ  ω       normal-¯  k    superscript  ω  2      \bar{c}=2\xi\omega,\bar{k}=\omega^{2}   , accordingly     P  =   2   ω  D   i    ,    A  =    ξ  ω   -    ω  D   i     ,   B  =    ξ  ω   +    ω  D   i         formulae-sequence    P    2   subscript  ω  D   i     formulae-sequence    A      ξ  ω      subscript  ω  D   i       B      ξ  ω      subscript  ω  D   i        P=2\omega_{D}i,\;A=\xi\omega-\omega_{D}i,\;B=\xi\omega+\omega_{D}i   , where ''ξ yields:       ω  D   =   ω  ⋅    1  -   ξ  2           subscript  ω  D    normal-⋅  ω      1   superscript  ξ  2        \omega_{D}=\omega\cdot\sqrt{1-\xi^{2}}   , where     x   (  t  )    =    1   ω  D      ∫  0  t      p   (  τ  )    ¯    e   -   ξ  ω   (   t  -  τ   )      s  i  n   (    ω  D    (   t  -  τ   )    )   d  τ           x  t       1   subscript  ω  D      superscript   subscript   0   t      normal-¯    p  τ     superscript  e      ξ  ω    t  τ      s  i  n     subscript  ω  D     t  τ    d  τ       x(t)=\frac{1}{\omega_{D}}\int_{0}^{t}{\bar{p(\tau)}e^{-\xi\omega(t-\tau)}sin(%
 \omega_{D}(t-\tau))d\tau}   and i is the imaginary unit . Substituting this expressions into the above general solution with zero initial conditions and using the Euler's exponential formula will lead to canceling out the imaginary terms and reveals the Duhamel's solution:  $$x(t)=\frac{1}{\omega_D}\int_0^t{\bar{p(\tau)}e^{-\xi\omega(t-\tau)}sin(\omega_D(t-\tau))d\tau}$$  See also   Duhamel's principle   References   Ni Zhenhua, Mechanics of Vibrations , Xi'an Jiaotong University Press, Xi'an, 1990 (in Chinese)  R. W. Clough, J. Penzien, Dynamics of Structures , Mc-Graw Hill Inc., New York, 1975.  Anil K. Chopra, Dynamics of Structures - Theory and applications to Earthquake Engineering , Pearson Education Asia Limited and Tsinghua University Press, Beijing, 2001  Leonard Meirovitch, Elements of Vibration Analysis , Mc-Graw Hill Inc., Singapore, 1986   External links   Duhamel's formula at "Dispersive Wiki".   "  Category:Mechanics  Category:Structural analysis  Category:Integrals   
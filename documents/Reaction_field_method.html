<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="200">Reaction field method</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Reaction field method</h1>
<hr>The '''reaction field  method''' is used in molecular simulations to simulate the effect of long range dipole-dipole interactions for simulations with [[periodic boundary conditions]]. Around each molecule there is a 'cavity' or sphere within which the Coulomb interactions are treated explicitly. Outside of this cavity the medium is assumed to have a uniform dielectric constant. The molecule induces polarization in this media which in turn creates a reaction field, sometimes called t
<p>he <strong>Onsager reaction field</strong>. Although <a href="Lars_Onsager" title="wikilink">Onsager</a>'s name is often attached to the technique, because he considered such a geometry in his theory of the dielectric constant,<a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a> the method was first introduced by Barker and Watts in 1973.<a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a><a class="footnoteRef" href="#fn3" id="fnref3"><sup>3</sup></a></p>

<p>The effective pairwise potential becomes:</p>

<p>

<math display="block" id="Reaction_field_method:0">
 <semantics>
  <mrow>
   <msub>
    <mi>U</mi>
    <mrow>
     <mi>A</mi>
     <mi>B</mi>
    </mrow>
   </msub>
   <mo>=</mo>
   <mrow>
    <msub>
     <mi>q</mi>
     <mi>A</mi>
    </msub>
    <msub>
     <mi>q</mi>
     <mi>B</mi>
    </msub>
    <mrow>
     <mo>[</mo>
     <mrow>
      <mfrac>
       <mn>1</mn>
       <msub>
        <mi>r</mi>
        <mrow>
         <mi>A</mi>
         <mi>B</mi>
        </mrow>
       </msub>
      </mfrac>
      <mo>+</mo>
      <mfrac>
       <mrow>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <msub>
           <mi>ε</mi>
           <mrow>
            <mi>R</mi>
            <mi>F</mi>
           </mrow>
          </msub>
          <mo>-</mo>
          <mn>1</mn>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
        <msubsup>
         <mi>r</mi>
         <mrow>
          <mi>A</mi>
          <mi>B</mi>
         </mrow>
         <mn>2</mn>
        </msubsup>
       </mrow>
       <mrow>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <mrow>
           <mn>2</mn>
           <msub>
            <mi>ε</mi>
            <mrow>
             <mi>R</mi>
             <mi>F</mi>
            </mrow>
           </msub>
          </mrow>
          <mo>+</mo>
          <mn>1</mn>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
        <msubsup>
         <mi>r</mi>
         <mi>c</mi>
         <mn>3</mn>
        </msubsup>
       </mrow>
      </mfrac>
     </mrow>
     <mo>]</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>U</ci>
     <apply>
      <times></times>
      <ci>A</ci>
      <ci>B</ci>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>q</ci>
      <ci>A</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>q</ci>
      <ci>B</ci>
     </apply>
     <apply>
      <csymbol cd="latexml">delimited-[]</csymbol>
      <apply>
       <plus></plus>
       <apply>
        <divide></divide>
        <cn type="integer">1</cn>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>r</ci>
         <apply>
          <times></times>
          <ci>A</ci>
          <ci>B</ci>
         </apply>
        </apply>
       </apply>
       <apply>
        <divide></divide>
        <apply>
         <times></times>
         <apply>
          <minus></minus>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>ε</ci>
           <apply>
            <times></times>
            <ci>R</ci>
            <ci>F</ci>
           </apply>
          </apply>
          <cn type="integer">1</cn>
         </apply>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>r</ci>
           <apply>
            <times></times>
            <ci>A</ci>
            <ci>B</ci>
           </apply>
          </apply>
          <cn type="integer">2</cn>
         </apply>
        </apply>
        <apply>
         <times></times>
         <apply>
          <plus></plus>
          <apply>
           <times></times>
           <cn type="integer">2</cn>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <ci>ε</ci>
            <apply>
             <times></times>
             <ci>R</ci>
             <ci>F</ci>
            </apply>
           </apply>
          </apply>
          <cn type="integer">1</cn>
         </apply>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>r</ci>
           <ci>c</ci>
          </apply>
          <cn type="integer">3</cn>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   U_{AB}=q_{A}q_{B}\left[\frac{1}{r_{AB}}+\frac{(\varepsilon_{RF}-1)r_{AB}^{2}}{%
(2\varepsilon_{RF}+1)r_{c}^{3}}\right]
  </annotation>
 </semantics>
</math>

 where 

<math display="inline" id="Reaction_field_method:1">
 <semantics>
  <msub>
   <mi>r</mi>
   <mi>c</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>r</ci>
    <ci>c</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   r_{c}
  </annotation>
 </semantics>
</math>

 is the cut-off radius.</p>

<p>The reaction field in the center of the cavity is given by :</p>

<p>

<math display="block" id="Reaction_field_method:2">
 <semantics>
  <mrow>
   <msub>
    <mi>E</mi>
    <mrow>
     <mi>R</mi>
     <mi>F</mi>
    </mrow>
   </msub>
   <mo>=</mo>
   <mrow>
    <mfrac>
     <mrow>
      <mn>2</mn>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <msub>
         <mi>ε</mi>
         <mrow>
          <mi>R</mi>
          <mi>F</mi>
         </mrow>
        </msub>
        <mo>-</mo>
        <mn>1</mn>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mrow>
      <mrow>
       <mn>2</mn>
       <msub>
        <mi>ε</mi>
        <mrow>
         <mi>R</mi>
         <mi>F</mi>
        </mrow>
       </msub>
      </mrow>
      <mo>+</mo>
      <mn>1</mn>
     </mrow>
    </mfrac>
    <mfrac>
     <mover accent="true">
      <mi>M</mi>
      <mo stretchy="false">→</mo>
     </mover>
     <msubsup>
      <mi>r</mi>
      <mi>c</mi>
      <mn>3</mn>
     </msubsup>
    </mfrac>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>E</ci>
     <apply>
      <times></times>
      <ci>R</ci>
      <ci>F</ci>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <divide></divide>
      <apply>
       <times></times>
       <cn type="integer">2</cn>
       <apply>
        <minus></minus>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>ε</ci>
         <apply>
          <times></times>
          <ci>R</ci>
          <ci>F</ci>
         </apply>
        </apply>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <apply>
       <plus></plus>
       <apply>
        <times></times>
        <cn type="integer">2</cn>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>ε</ci>
         <apply>
          <times></times>
          <ci>R</ci>
          <ci>F</ci>
         </apply>
        </apply>
       </apply>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <apply>
      <divide></divide>
      <apply>
       <ci>normal-→</ci>
       <ci>M</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>r</ci>
        <ci>c</ci>
       </apply>
       <cn type="integer">3</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   E_{RF}=\frac{2(\varepsilon_{RF}-1)}{2\varepsilon_{RF}+1}\frac{\vec{M}}{r_{c}^{%
3}}
  </annotation>
 </semantics>
</math>

 where 

<math display="inline" id="Reaction_field_method:3">
 <semantics>
  <mrow>
   <mover accent="true">
    <mi>M</mi>
    <mo stretchy="false">→</mo>
   </mover>
   <mo>=</mo>
   <mrow>
    <mo largeop="true" symmetric="true">∑</mo>
    <msub>
     <mi>μ</mi>
     <mi>i</mi>
    </msub>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <ci>normal-→</ci>
     <ci>M</ci>
    </apply>
    <apply>
     <sum></sum>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>μ</ci>
      <ci>i</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \vec{M}=\sum\mu_{i}
  </annotation>
 </semantics>
</math>


 is the total dipole moment of all the molecules in the cavity. The contribution to the potential energy of the molecule 

<math display="inline" id="Reaction_field_method:4">
 <semantics>
  <mi>i</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>i</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   i
  </annotation>
 </semantics>
</math>

 at the center of the cavity is 

<math display="inline" id="Reaction_field_method:5">
 <semantics>
  <mrow>
   <mo>-</mo>
   <mrow>
    <mrow>
     <mrow>
      <mn>1</mn>
      <mo>/</mo>
      <mn>2</mn>
     </mrow>
     <msub>
      <mi>μ</mi>
      <mi>i</mi>
     </msub>
    </mrow>
    <mo>⋅</mo>
    <msub>
     <mi>E</mi>
     <mrow>
      <mi>R</mi>
      <mi>F</mi>
     </mrow>
    </msub>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <minus></minus>
    <apply>
     <ci>normal-⋅</ci>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>μ</ci>
       <ci>i</ci>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>E</ci>
      <apply>
       <times></times>
       <ci>R</ci>
       <ci>F</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   -1/2\mu_{i}\cdot E_{RF}
  </annotation>
 </semantics>
</math>

 and the torque on molecule 

<math display="inline" id="Reaction_field_method:6">
 <semantics>
  <mi>i</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>i</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   i
  </annotation>
 </semantics>
</math>

 is simply 

<math display="inline" id="Reaction_field_method:7">
 <semantics>
  <mrow>
   <msub>
    <mi>μ</mi>
    <mi>i</mi>
   </msub>
   <mo>×</mo>
   <msub>
    <mi>E</mi>
    <mrow>
     <mi>R</mi>
     <mi>F</mi>
    </mrow>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>μ</ci>
     <ci>i</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>E</ci>
     <apply>
      <times></times>
      <ci>R</ci>
      <ci>F</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mu_{i}\times E_{RF}
  </annotation>
 </semantics>
</math>

.</p>

<p>When a molecule enters or leaves the sphere defined by the cut-off radius, there is a discontinuous jump in energy.<a class="footnoteRef" href="#fn4" id="fnref4"><sup>4</sup></a> When all of these jumps in energy are summed, they do not exactly cancel, leading to poor energy conservation, a deficiency found whenever a spherical cut-off is used. The situation can be improved by tapering the potential energy function to zero near the cut-off radius. Beyond a certain radius 

<math display="inline" id="Reaction_field_method:8">
 <semantics>
  <msub>
   <mi>r</mi>
   <mi>t</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>r</ci>
    <ci>t</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   r_{t}
  </annotation>
 </semantics>
</math>


 the potential is multiplied by a tapering function 

<math display="inline" id="Reaction_field_method:9">
 <semantics>
  <mrow>
   <mi>f</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>r</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>f</ci>
    <ci>r</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f(r)
  </annotation>
 </semantics>
</math>

. A simple choice is linear tapering with 

<math display="inline" id="Reaction_field_method:10">
 <semantics>
  <mrow>
   <msub>
    <mi>r</mi>
    <mi>t</mi>
   </msub>
   <mo>=</mo>
   <mrow>
    <mn>.95</mn>
    <msub>
     <mi>r</mi>
     <mi>c</mi>
    </msub>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>r</ci>
     <ci>t</ci>
    </apply>
    <apply>
     <times></times>
     <cn type="float">.95</cn>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>r</ci>
      <ci>c</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   r_{t}=.95r_{c}
  </annotation>
 </semantics>
</math>

, although better results may be found with more sophisticated tapering functions.</p>

<p>Another potential difficulty of the reaction field method is that the dielectric constant must be known a priori. However, it turns out that in most cases dynamical properties are fairly insensitive to the choice of 

<math display="inline" id="Reaction_field_method:11">
 <semantics>
  <msub>
   <mi>ε</mi>
   <mrow>
    <mi>R</mi>
    <mi>F</mi>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>ε</ci>
    <apply>
     <times></times>
     <ci>R</ci>
     <ci>F</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \varepsilon_{RF}
  </annotation>
 </semantics>
</math>

. It can be put in by hand, or calculated approximately using any of a number of well-known relations between the dipole fluctuations inside the simulation box and the macroscopic dielectric constant.<a class="footnoteRef" href="#fn5" id="fnref5"><sup>5</sup></a></p>

<p>Another possible modification is to take into account the finite time required for the reaction field to respond to changes in the cavity. This "delayed reaction field method" was investigated by van Gunsteren, Berendsen and Rullmann in 1978.<a class="footnoteRef" href="#fn6" id="fnref6"><sup>6</sup></a> It was found to give better results—this makes sense, as without taking into account the delay, the reaction field is overestimated. However, the delayed method has additional difficulties with energy conservation and thus is not suitable for simulating an NVE ensemble.</p>
<h2 id="comparison-with-other-techniques">Comparison with other techniques</h2>

<p>The reaction field method is an alternative to the popular technique of <a href="Ewald_summation" title="wikilink">Ewald summation</a>. Today, Ewald summation is the usual technique of choice, but for many quantities of interest both techniques yield equivalent results. For example, in <a href="Monte_Carlo" title="wikilink">Monte Carlo</a> simulations of liquid crystals, (using both the <a href="hard_spherocylinder" title="wikilink">hard spherocylinder</a><a class="footnoteRef" href="#fn7" id="fnref7"><sup>7</sup></a> and Gay-Berne models<a class="footnoteRef" href="#fn8" id="fnref8"><sup>8</sup></a>) the results from the reaction field method and Ewald summation are consistent. However, the reaction field presents a considerable reduction in the computer time required. The reaction field should be applied carefully, and becomes complicated or impossible to implement for non-isotropic systems, such as systems dominated by large biomolecules or systems with liquid-vapour or liquid-solid coexistence.<a class="footnoteRef" href="#fn9" id="fnref9"><sup>9</sup></a></p>

<p>In section 5.5.5 of his book, Allen<a class="footnoteRef" href="#fn10" id="fnref10"><sup>10</sup></a> compares the reaction field with other methods, focusing on the simulation of the <a href="Stockmayer_system" title="wikilink">Stockmayer system</a> (the simplest model for a dipolar fluid, such as water). The work of Adams, et al. (1979) showed that the reaction field produces results with thermodynamic quantities (volume, pressure and temperature) which are in good agreement with other methods, although pressure was slightly higher with the reaction field method compared to the Ewald-Kornfeld method (1.69 vs 1.52). The results show that macroscopic thermodynamic properties do not depend heavily on how long-range forces are treated. Similarly, single particle correlation functions do not depend heavily on the method employed. Several other results also show that the dielectric constant 

<math display="inline" id="Reaction_field_method:12">
 <semantics>
  <mi>ϵ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>ϵ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \epsilon
  </annotation>
 </semantics>
</math>

 can be well estimated with either the reaction field or a lattice summation technique.<a class="footnoteRef" href="#fn11" id="fnref11"><sup>11</sup></a></p>
<h2 id="references">References</h2>
<h2 id="further-reading">Further reading</h2>
<ul>
<li><a href="http://dx.doi.org/10.1080/00268978000100361">Martin Neumann and Othmar Steinhauser "The influence of boundary conditions used in machine simulations on the structure of polar systems", Molecular Physics <strong>39</strong> pp. 437-454 (1980)</a></li>
<li><a href="http://dx.doi.org/10.1080/00268978400101081">Martin Neumann, Othmar Steinhauser and G. Stuart Pawley "Consistent calculation of the static and frequency-dependent dielectric constant in computer simulations", Molecular Physics <strong>52</strong> pp. 97-113 (1984)</a></li>
<li><a href="http://dx.doi.org/10.1063/1.3081138">Andrij Baumketner "Removing systematic errors in interionic potentials of mean force computed in molecular simulations using reaction-field-based electrostatics", Journal of Chemical Physics <strong>130</strong> 104106 (2009)</a></li>
<li><a href="http://wanglab.bu.edu/DLPOLY2/node68.html">Reaction Field method</a></li>
</ul>

<p>"</p>

<p><a href="Category:Molecular_modelling" title="wikilink">Category:Molecular modelling</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1"><a href="#fnref1">↩</a></li>
<li id="fn2"><a href="#fnref2">↩</a></li>
<li id="fn3"><a href="#fnref3">↩</a></li>
<li id="fn4"><a href="#fnref4">↩</a></li>
<li id="fn5"></li>
<li id="fn6"><a href="#fnref6">↩</a></li>
<li id="fn7"><a href="#fnref7">↩</a></li>
<li id="fn8"><a href="#fnref8">↩</a></li>
<li id="fn9"><a href="http://dx.doi.org/10.1016/0009-2614(94)01298-9">Benito Garzón, Santiago Lago and Carlos Vega "Reaction field simulations of the vapor-liquid equilibria of dipolar fluids: Does the reaction field dielectric constant affect the coexistence properties?", Chemical Physics Letters <strong>231</strong> pp. 366-372 (1994)</a><a href="#fnref9">↩</a></li>
<li id="fn10"></li>
<li id="fn11"></li>
</ol>
</section>
</hr></body>
</html>

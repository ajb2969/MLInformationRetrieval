   Hadamard product (matrices)      Hadamard product (matrices)   In mathematics , the Hadamard product (also known as the Schur product  1 or the entrywise product 2 ) is a binary operation that takes two matrices of the same dimensions, and produces another matrix where each element ij is the product of elements ij of the original two matrices. It should not be confused with the more common matrix product . It is attributed to, and named after, either French mathematician Jacques Hadamard , or German mathematician Issai Schur .  The Hadamard product is associative and distributive , and unlike the matrix product it is also commutative .  Definition  For two matrices,    A  ,  B     A  B    A,B   , of the same dimension,    m  ×  n      m  n    m\times n   the Hadamard product,    A  ∘  B      A  B    A\circ B   , is a matrix, of the same dimension as the operands, with elements given by        (   A  ∘  B   )    i  ,  j    =     (  A  )    i  ,  j    ⋅    (  B  )    i  ,  j          subscript    A  B    i  j     normal-⋅   subscript  A   i  j     subscript  B   i  j       (A\circ B)_{i,j}=(A)_{i,j}\cdot(B)_{i,j}   . For matrices of different dimensions (    m  ×  n      m  n    m\times n   and    p  ×  q      p  q    p\times q   , where    m  ≠  p      m  p    m\not=p   or    n  ≠  q      n  q    n\not=q   or both) the Hadamard product is undefined.  Example  For example the Hadamard product for a 3x3 matrix A with a 3x3 matrix B is:        (      a  11      a  12      a  13        a  21      a  22      a  23        a  31      a  32      a  33      )   ∘   (      b  11      b  12      b  13        b  21      b  22      b  23        b  31      b  32      b  33      )    =   (        a  11     b  11         a  12     b  12         a  13     b  13           a  21     b  21         a  22     b  22         a  23     b  23           a  31     b  31         a  32     b  32         a  33     b  33       )            subscript  normal-a  11    subscript  normal-a  12    subscript  normal-a  13      subscript  normal-a  21    subscript  normal-a  22    subscript  normal-a  23      subscript  normal-a  31    subscript  normal-a  32    subscript  normal-a  33        subscript  normal-b  11    subscript  normal-b  12    subscript  normal-b  13      subscript  normal-b  21    subscript  normal-b  22    subscript  normal-b  23      subscript  normal-b  31    subscript  normal-b  32    subscript  normal-b  33           subscript  normal-a  11    subscript  normal-b  11       subscript  normal-a  12    subscript  normal-b  12       subscript  normal-a  13    subscript  normal-b  13         subscript  normal-a  21    subscript  normal-b  21       subscript  normal-a  22    subscript  normal-b  22       subscript  normal-a  23    subscript  normal-b  23         subscript  normal-a  31    subscript  normal-b  31       subscript  normal-a  32    subscript  normal-b  32       subscript  normal-a  33    subscript  normal-b  33        \left(\begin{array}[]{ccc}\mathrm{a}_{11}&\mathrm{a}_{12}&\mathrm{a}_{13}\\
 \mathrm{a}_{21}&\mathrm{a}_{22}&\mathrm{a}_{23}\\
 \mathrm{a}_{31}&\mathrm{a}_{32}&\mathrm{a}_{33}\end{array}\right)\circ\left(%
 \begin{array}[]{ccc}\mathrm{b}_{11}&\mathrm{b}_{12}&\mathrm{b}_{13}\\
 \mathrm{b}_{21}&\mathrm{b}_{22}&\mathrm{b}_{23}\\
 \mathrm{b}_{31}&\mathrm{b}_{32}&\mathrm{b}_{33}\end{array}\right)=\left(\begin%
 {array}[]{ccc}\mathrm{a}_{11}\,\mathrm{b}_{11}&\mathrm{a}_{12}\,\mathrm{b}_{12%
 }&\mathrm{a}_{13}\,\mathrm{b}_{13}\\
 \mathrm{a}_{21}\,\mathrm{b}_{21}&\mathrm{a}_{22}\,\mathrm{b}_{22}&\mathrm{a}_{%
 23}\,\mathrm{b}_{23}\\
 \mathrm{a}_{31}\,\mathrm{b}_{31}&\mathrm{a}_{32}\,\mathrm{b}_{32}&\mathrm{a}_{%
 33}\,\mathrm{b}_{33}\end{array}\right)     Properties  The Hadamard product is commutative , associative and distributive over addition. That is,        A  ∘  B   =   B  ∘  A    ,        A  B     B  A     A\circ B=B\circ A,           A  ∘   (   B  ∘  C   )    =    (   A  ∘  B   )   ∘  C    ,        A    B  C        A  B   C     A\circ(B\circ C)=(A\circ B)\circ C,           A  ∘   (   B  +  C   )    =    A  ∘  B   +   A  ∘  C     .        A    B  C        A  B     A  C      A\circ(B+C)=A\circ B+A\circ C.     The identity matrix under Hadamard multiplication of two m-by-n matrices is m-by-n matrix where all elements are equal to 1. This is different from the identity matrix under regular matrix multiplication, where only the elements of the main diagonal are equal to 1. Furthermore, a matrix has an inverse under Hadamard multiplication if and only if none of the elements are equal to zero. 3  For vectors   x   x   x   and   y   y   y   , and corresponding diagonal matrices    D  x     subscript  D  x    D_{x}   and    D  y     subscript  D  y    D_{y}   with these vectors as their leading diagonals, the following identity holds: 4        x  *    (   A  ∘  B   )   y   =   tr   (    D  x  *   A   D  y    B  T    )           superscript  x      A  B   y     tr     superscript   subscript  D  x     A   subscript  D  y    superscript  B  T       x^{*}(A\circ B)y=\mathrm{tr}(D_{x}^{*}AD_{y}B^{T})   , where    x  *     superscript  x     x^{*}   denotes the conjugate transpose of   x   x   x   . In particular, using vectors of ones, this shows that the sum of all elements in the Hadamard product is the trace of    A   B  T       A   superscript  B  T     AB^{T}   . A related result for square   A   A   A   and   B   B   B   , is that the row-sums of their Hadamard product are the diagonal elements of     A   B  T    :      normal-:    A   superscript  B  T    absent    AB^{T}:    5         ∑  j     (   A  ∘  B   )    i  ,  j     =    (   A   B  T    )    i  ,  i     .        subscript   j    subscript    A  B    i  j      subscript    A   superscript  B  T     i  i      \sum_{j}(A\circ B)_{i,j}=(AB^{T})_{i,i}.     The Hadamard product is a principal submatrix of the Kronecker product .  The Hadamard product satisfies the rank inequality       rank   (   A  ∘  B   )    ≤    rank   (  A  )     rank   (  B  )          rank    A  B       rank  A    rank  B      \operatorname{rank}(A\circ B)\leq\operatorname{rank}(A)\operatorname{rank}(B)     Schur product theorem  The Hadamard product of two positive-semidefinite matrices is positive-semidefinite. 6 This is known as the Schur product theorem, 7 after German mathematician Issai Schur . For positive-semidefinite matrices A and B , it is also known that        det   (   A  ∘  B   )    ≥   det    (  A  )    det   (  B  )       .          A  B        A    B       \det(A\circ B)\geq\det(A)\det(B).\,    8  In programming languages  Hadamard multiplication is built into certain programming languages under various names. In MATLAB , GNU Octave and GAUSS , it is known as "array multiplication", with the symbol .* . 9 In Fortran , R , 10  J and Mathematica , it is done through simple multiplication operator * , whereas the matrix product is done through the function matmul , %*% , +/ .* and the . operators, respectively. In Python with the numpy numerical library or the sympy symbolic library, multiplication of array objects as a1*a2 produces the Hadamard product, but with otherwise matrix objects m1*m2 will produce a matrix product. The Eigen C++ library provides a cwiseProduct member function for the Matrix class ( a.cwiseProduct(b) ), while the Armadillo library use the operator % to make compact expressions ( a % b ; a * b is a matrix product).  Applications  The Hadamard product appears in lossy compression algorithms such as JPEG . The decoding step involves an entry-for-entry product, i.e., Hadamard product.  Analogous Operations  Other Hadamard reactions are also seen in the Mathematical literature , namely the "Hadamard Root" and "Hadamard Power" (which are in effect the same thing because of fractional indices), defined for a a matrix such that:  For      B  =   A    ∘  2        B   superscript  A    absent  2      {B}={A}^{\circ 2}        B   i  j    =   A   i  j   2        subscript  B    i  j     subscript   superscript  A  2     i  j      {B}_{ij}={A}^{2}_{ij}     And for      B  =   A    ∘   1  2         B   superscript  A    absent    1  2       {B}={A}^{\circ\frac{1}{2}}        B   i  j    =   A   i  j    1  2         subscript  B    i  j     subscript   superscript  A    1  2      i  j      {B}_{ij}={A}^{\frac{1}{2}}_{ij}     See also   Pointwise product   References  "  Category:Matrix theory     Davis, Chandler. "The norm of the Schur product operation." Numerische Mathematik 4.1 (1962): 343-344. ↩  ↩  ↩  ↩   ↩    ↩  ↩     
   Proof of Stein's example      Proof of Stein's example   Stein's example is an important result in decision theory which can be stated as   The ordinary decision rule for estimating the mean of a multivariate Gaussian distribution is inadmissible under mean squared error risk in dimension at least 3 .   The following is an outline of its proof. The reader is referred to the main article for more information.  Sketched proof  The risk function of the decision rule     d   (  ğ±  )    =  ğ±        d  ğ±   ğ±    d(\mathbf{x})=\mathbf{x}   is       R   (  Î¸  ,  d  )    =    ğ”¼  Î¸    [    |   Î¸  -  ğ—   |   2   ]          R   Î¸  d       subscript  ğ”¼  Î¸    delimited-[]   superscript      Î¸  ğ—    2       R(\theta,d)=\mathbb{E}_{\theta}[|\mathbf{\theta-X}|^{2}]            =   âˆ«     (   Î¸  -  ğ±   )   T    (   Î¸  -  ğ±   )     (   1   2  Ï€    )    n  /  2     e    (   -   1  /  2    )     (   Î¸  -  ğ±   )   T    (   Î¸  -  ğ±   )     m   (   d  x   )         absent       superscript    Î¸  ğ±   T     Î¸  ğ±    superscript    1    2  Ï€      n  2     superscript  e        1  2     superscript    Î¸  ğ±   T     Î¸  ğ±     m    d  x       =\int(\mathbf{\theta-x})^{T}(\mathbf{\theta-x})\left(\frac{1}{2\pi}\right)^{n/%
 2}e^{(-1/2)(\mathbf{\theta-x})^{T}(\mathbf{\theta-x})}m(dx)                =  n   .      absent  n    =n.\,        Now consider the decision rule        d  â€²    (  ğ±  )    =   ğ±  -    Î±    |  ğ±  |   2    ğ±           superscript  d  normal-â€²   ğ±     ğ±      Î±   superscript    ğ±   2    ğ±      d^{\prime}(\mathbf{x})=\mathbf{x}-\frac{\alpha}{|\mathbf{x}|^{2}}\mathbf{x}     where    Î±  =   n  -  2       Î±    n  2     \alpha=n-2   . We will show that    d  â€²     superscript  d  normal-â€²    d^{\prime}   is a better decision rule than   d   d   d   . The risk function is       R   (  Î¸  ,   d  â€²   )    =    ğ”¼  Î¸    [    |    Î¸  -  ğ—   +    Î±    |  ğ—  |   2    ğ—    |   2   ]          R   Î¸   superscript  d  normal-â€²        subscript  ğ”¼  Î¸    delimited-[]   superscript        Î¸  ğ—       Î±   superscript    ğ—   2    ğ—     2       R(\theta,d^{\prime})=\mathbb{E}_{\theta}\left[\left|\mathbf{\theta-X}+\frac{%
 \alpha}{|\mathbf{X}|^{2}}\mathbf{X}\right|^{2}\right]            =    ğ”¼  Î¸    [     |   Î¸  -  ğ—   |   2   +   2    (   Î¸  -  ğ—   )   T    Î±    |  ğ—  |   2    ğ—   +     Î±  2     |  ğ—  |   4      |  ğ—  |   2     ]        absent     subscript  ğ”¼  Î¸    delimited-[]     superscript      Î¸  ğ—    2     2   superscript    Î¸  ğ—   T     Î±   superscript    ğ—   2    ğ—        superscript  Î±  2    superscript    ğ—   4     superscript    ğ—   2         =\mathbb{E}_{\theta}\left[|\mathbf{\theta-X}|^{2}+2(\mathbf{\theta-X})^{T}%
 \frac{\alpha}{|\mathbf{X}|^{2}}\mathbf{X}+\frac{\alpha^{2}}{|\mathbf{X}|^{4}}|%
 \mathbf{X}|^{2}\right]               =     ğ”¼  Î¸    [    |   Î¸  -  ğ—   |   2   ]    +   2  Î±   ğ”¼  Î¸    [      (   Î¸  -  ğ—   )   ğ“   ğ—     |  ğ—  |   2    ]    +    Î±  2    ğ”¼  Î¸    [   1    |  ğ—  |   2    ]         absent       subscript  ğ”¼  Î¸    delimited-[]   superscript      Î¸  ğ—    2       2  Î±   subscript  ğ”¼  Î¸    delimited-[]       superscript    Î¸  ğ—   ğ“   ğ—    superscript    ğ—   2         superscript  Î±  2    subscript  ğ”¼  Î¸    delimited-[]    1   superscript    ğ—   2         =\mathbb{E}_{\theta}\left[|\mathbf{\theta-X}|^{2}\right]+2\alpha\mathbb{E}_{%
 \theta}\left[\frac{\mathbf{(\theta-X)^{T}X}}{|\mathbf{X}|^{2}}\right]+\alpha^{%
 2}\mathbb{E}_{\theta}\left[\frac{1}{|\mathbf{X}|^{2}}\right]        â€” a quadratic in   Î±   Î±   \alpha   . We may simplify the middle term by considering a general "well-behaved" function    h  :   ğ±  â†¦   h   (  ğ±  )    âˆˆ  â„      normal-:  h     maps-to  ğ±    h  ğ±        â„      h:\mathbf{x}\mapsto h(\mathbf{x})\in\mathbb{R}   and using integration by parts . For    1  â‰¤  i  â‰¤  n        1  i       n     1\leq i\leq n   , for any continuously differentiable   h   h   h   growing sufficiently slowly for large    x  i     subscript  x  i    x_{i}   we have:         ğ”¼  Î¸    [   (   Î¸  i   -   X  i   )   h   (  ğ—  )   |   X  j   =   x  j    (  j  â‰   i  )   ]   =  âˆ«   (   Î¸  i   -   x  i   )   h   (  ğ±  )     (   1   2  Ï€    )    n  /  2     e   -    (   1  /  2   )     (   ğ±  -  Î¸   )   T    (   ğ±  -  Î¸   )      m   (  d   x  i   )      fragments   subscript  ğ”¼  Î¸    fragments  normal-[   fragments  normal-(   subscript  Î¸  i     subscript  X  i   normal-)   h   fragments  normal-(  X  normal-)   normal-|   subscript  X  j     subscript  x  j    fragments  normal-(  j   i  normal-)   normal-]      fragments  normal-(   subscript  Î¸  i     subscript  x  i   normal-)   h   fragments  normal-(  x  normal-)    superscript   fragments  normal-(    1    2  Ï€    normal-)     n  2     superscript  e        1  2    superscript    ğ±  Î¸   T     ğ±  Î¸      m   fragments  normal-(  d   subscript  x  i   normal-)     \mathbb{E}_{\theta}[(\theta_{i}-X_{i})h(\mathbf{X})|X_{j}=x_{j}(j\neq i)]=\int%
 (\theta_{i}-x_{i})h(\mathbf{x})\left(\frac{1}{2\pi}\right)^{n/2}e^{-(1/2)%
 \mathbf{(x-\theta)}^{T}\mathbf{(x-\theta)}}m(dx_{i})             =     [   h   (  ğ±  )     (   1   2  Ï€    )    n  /  2     e   -    (   1  /  2   )     (   ğ±  -  Î¸   )   T    (   ğ±  -  Î¸   )       ]     x  i   =   -  âˆ    âˆ   -   âˆ«     âˆ‚  h    âˆ‚   x  i      (  ğ±  )     (   1   2  Ï€    )    n  /  2     e   -    (   1  /  2   )     (   ğ±  -  Î¸   )   T    (   ğ±  -  Î¸   )      m   (   d   x  i    )          absent     subscript   superscript   delimited-[]    h  ğ±   superscript    1    2  Ï€      n  2     superscript  e        1  2    superscript    ğ±  Î¸   T     ğ±  Î¸             subscript  x  i                 h      subscript  x  i     ğ±   superscript    1    2  Ï€      n  2     superscript  e        1  2    superscript    ğ±  Î¸   T     ğ±  Î¸      m    d   subscript  x  i         =\left[h(\mathbf{x})\left(\frac{1}{2\pi}\right)^{n/2}e^{-(1/2)\mathbf{(x-%
 \theta)}^{T}\mathbf{(x-\theta)}}\right]^{\infty}_{x_{i}=-\infty}-\int\frac{%
 \partial h}{\partial x_{i}}(\mathbf{x})\left(\frac{1}{2\pi}\right)^{n/2}e^{-(1%
 /2)\mathbf{(x-\theta)}^{T}\mathbf{(x-\theta)}}m(dx_{i})         =  -   ğ”¼  Î¸    [    âˆ‚  h    âˆ‚   x  i      (  ğ—  )   |   X  j   =   x  j    (  j  â‰   i  )   ]   .     fragments     subscript  ğ”¼  Î¸    fragments  normal-[      h      subscript  x  i      fragments  normal-(  X  normal-)   normal-|   subscript  X  j     subscript  x  j    fragments  normal-(  j   i  normal-)   normal-]   normal-.    =-\mathbb{E}_{\theta}\left[\frac{\partial h}{\partial x_{i}}(\mathbf{X})|X_{j}%
 =x_{j}(j\neq i)\right].     Therefore,         ğ”¼  Î¸    [    (    Î¸  i   -   X  i    )   h   (  ğ—  )    ]    =   -    ğ”¼  Î¸    [     âˆ‚  h    âˆ‚   x  i      (  ğ—  )    ]      .         subscript  ğ”¼  Î¸    delimited-[]       subscript  Î¸  i    subscript  X  i    h  ğ—          subscript  ğ”¼  Î¸    delimited-[]        h      subscript  x  i     ğ—        \mathbb{E}_{\theta}[(\theta_{i}-X_{i})h(\mathbf{X})]=-\mathbb{E}_{\theta}\left%
 [\frac{\partial h}{\partial x_{i}}(\mathbf{X})\right].     (This result is known as Stein's lemma .)  Now, we choose        h   (  ğ±  )    =    x  i     |  ğ±  |   2     .        h  ğ±      subscript  x  i    superscript    ğ±   2      h(\mathbf{x})=\frac{x_{i}}{|\mathbf{x}|^{2}}.     If   h   h   h   met the "well-behaved" condition (it doesn't, but this can be remedied -- see below), we would have        âˆ‚  h    âˆ‚   x  i     =    1    |  ğ±  |   2    -    2   x  i  2      |  ğ±  |   4             h      subscript  x  i         1   superscript    ğ±   2        2   superscript   subscript  x  i   2     superscript    ğ±   4       \frac{\partial h}{\partial x_{i}}=\frac{1}{|\mathbf{x}|^{2}}-\frac{2x_{i}^{2}}%
 {|\mathbf{x}|^{4}}     and so         \mathbb{E}_\theta\left[\frac{\mathbf{(\theta-X)^T X}}{|\mathbf{X}|^2}\right] = \sum_{i=1}^n \mathbb{E}_\theta \left[ (\theta_i - X_i) \frac{X_i}{|\mathbf{X}|^2} \right]       =   -    âˆ‘   i  =  1   n     ğ”¼  Î¸    [    1    |  ğ—  |   2    -    2   X  i  2      |  ğ—  |   4     ]          absent      superscript   subscript     i  1    n      subscript  ğ”¼  Î¸    delimited-[]      1   superscript    ğ—   2        2   superscript   subscript  X  i   2     superscript    ğ—   4           =-\sum_{i=1}^{n}\mathbb{E}_{\theta}\left[\frac{1}{|\mathbf{X}|^{2}}-\frac{2X_{%
 i}^{2}}{|\mathbf{X}|^{4}}\right]           =   -    (   n  -  2   )    ğ”¼  Î¸    [   1    |  ğ—  |   2    ]      .      absent        n  2    subscript  ğ”¼  Î¸    delimited-[]    1   superscript    ğ—   2         =-(n-2)\mathbb{E}_{\theta}\left[\frac{1}{|\mathbf{X}|^{2}}\right].     Then returning to the risk function of    d  â€²     superscript  d  normal-â€²    d^{\prime}   :        R   (  Î¸  ,   d  â€²   )    =    n  -   2  Î±   (   n  -  2   )    ğ”¼  Î¸    [   1    |  ğ—  |   2    ]     +    Î±  2    ğ”¼  Î¸    [   1    |  ğ—  |   2    ]      .        R   Î¸   superscript  d  normal-â€²         n    2  Î±    n  2    subscript  ğ”¼  Î¸    delimited-[]    1   superscript    ğ—   2          superscript  Î±  2    subscript  ğ”¼  Î¸    delimited-[]    1   superscript    ğ—   2         R(\theta,d^{\prime})=n-2\alpha(n-2)\mathbb{E}_{\theta}\left[\frac{1}{|\mathbf{%
 X}|^{2}}\right]+\alpha^{2}\mathbb{E}_{\theta}\left[\frac{1}{|\mathbf{X}|^{2}}%
 \right].     This quadratic in   Î±   Î±   \alpha   is minimized at       Î±  =   n  -  2    ,      Î±    n  2     \alpha=n-2,\,     giving       R   (  Î¸  ,   d  â€²   )    =    R   (  Î¸  ,  d  )    -     (   n  -  2   )   2    ğ”¼  Î¸    [   1    |  ğ—  |   2    ]           R   Î¸   superscript  d  normal-â€²         R   Î¸  d       superscript    n  2   2    subscript  ğ”¼  Î¸    delimited-[]    1   superscript    ğ—   2         R(\theta,d^{\prime})=R(\theta,d)-(n-2)^{2}\mathbb{E}_{\theta}\left[\frac{1}{|%
 \mathbf{X}|^{2}}\right]     which of course satisfies:        R   (  Î¸  ,   d  â€²   )    <   R   (  Î¸  ,  d  )     .        R   Î¸   superscript  d  normal-â€²       R   Î¸  d      R(\theta,d^{\prime})     making   d   d   d   an inadmissible decision rule.  It remains to justify the use of        h   (  ğ—  )    =   ğ—    |  ğ—  |   2     .        h  ğ—     ğ—   superscript    ğ—   2      h(\mathbf{X})=\frac{\mathbf{X}}{|\mathbf{X}|^{2}}.     This function is not continuously differentiable since it is singular at    ğ±  =  0      ğ±  0    \mathbf{x}=0   . However the function       h   (  ğ—  )    =   ğ—   Ïµ  +    |  ğ—  |   2           h  ğ—     ğ—    Ïµ   superscript    ğ—   2       h(\mathbf{X})=\frac{\mathbf{X}}{\epsilon+|\mathbf{X}|^{2}}     is continuously differentiable, and after following the algebra through and letting    Ïµ  â†’  0     normal-â†’  Ïµ  0    \epsilon\to 0   one obtains the same result.  "  Category:Article proofs  Category:Decision theory  Category:Mathematical examples  Category:Statistical paradoxes   
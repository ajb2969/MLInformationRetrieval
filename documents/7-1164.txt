   Quadratic form (statistics)      Quadratic form (statistics)   In multivariate statistics , if   ϵ   ϵ   \epsilon   is a vector of   n   n   n    random variables , and   Λ   normal-Λ   \Lambda   is an   n   n   n   -dimensional symmetric matrix , then the scalar quantity     ϵ  T   Λ  ϵ       superscript  ϵ  T   normal-Λ  ϵ    \epsilon^{T}\Lambda\epsilon   is known as a quadratic form in   ϵ   ϵ   \epsilon   .  Expectation  It can be shown that 1       E   [    ϵ  T   Λ  ϵ   ]    =    tr   [   Λ  Σ   ]    +    μ  T   Λ  μ         normal-E     superscript  ϵ  T   normal-Λ  ϵ       tr    normal-Λ  normal-Σ       superscript  μ  T   normal-Λ  μ      \operatorname{E}\left[\epsilon^{T}\Lambda\epsilon\right]=\operatorname{tr}%
 \left[\Lambda\Sigma\right]+\mu^{T}\Lambda\mu     where   μ   μ   \mu   and   Σ   normal-Σ   \Sigma   are the expected value and variance-covariance matrix of   ϵ   ϵ   \epsilon   , respectively, and tr denotes the trace of a matrix. This result only depends on the existence of   μ   μ   \mu   and   Σ   normal-Σ   \Sigma   ; in particular, normality of   ϵ   ϵ   \epsilon   is not required.  A book treatment of the topic of quadratic forms in random variables is 2  Proof  Since the quadratic form is a scalar quantity     E   [    ϵ  T   Λ  ϵ   ]    =   tr   (   E   [    ϵ  T   Λ  ϵ   ]    )         normal-E     superscript  ϵ  T   normal-Λ  ϵ     tr   normal-E     superscript  ϵ  T   normal-Λ  ϵ       \operatorname{E}\left[\epsilon^{T}\Lambda\epsilon\right]=\operatorname{tr}(%
 \operatorname{E}[\epsilon^{T}\Lambda\epsilon])   . Note that both   E   normal-E   \operatorname{E}   and   tr   tr   \operatorname{tr}   are linear operators, so     E  ∘  tr   =   tr  ∘  E         normal-E  tr     tr  normal-E     \operatorname{E}\circ\operatorname{tr}=\operatorname{tr}\circ\operatorname{E}   . It follows that        tr   (   E   [    ϵ  T   Λ  ϵ   ]    )    =   E   [   tr   (    ϵ  T   Λ  ϵ   )    ]     ,       tr   normal-E     superscript  ϵ  T   normal-Λ  ϵ      normal-E   tr     superscript  ϵ  T   normal-Λ  ϵ       \operatorname{tr}(\operatorname{E}\left[\epsilon^{T}\Lambda\epsilon\right])=%
 \operatorname{E}[\operatorname{tr}(\epsilon^{T}\Lambda\epsilon)],   and that, by the cyclic property of the trace operator,        E   [   tr   (    ϵ  T   Λ  ϵ   )    ]    =   E   [   tr   (   Λ  ϵ   ϵ  T    )    ]    =   tr   (   Λ   (   Σ  +   μ   μ  T     )    )    =    tr   (   Λ  Σ   )    +    μ  T   Λ  μ     .         normal-E   tr     superscript  ϵ  T   normal-Λ  ϵ      normal-E   tr    normal-Λ  ϵ   superscript  ϵ  T            tr    normal-Λ    normal-Σ    μ   superscript  μ  T               tr    normal-Λ  normal-Σ       superscript  μ  T   normal-Λ  μ       \operatorname{E}[\operatorname{tr}(\epsilon^{T}\Lambda\epsilon)]=\operatorname%
 {E}[\operatorname{tr}(\Lambda\epsilon\epsilon^{T})]=\operatorname{tr}(\Lambda(%
 \Sigma+\mu\mu^{T}))=\operatorname{tr}(\Lambda\Sigma)+\mu^{T}\Lambda\mu.     Variance  In general, the variance of a quadratic form depends greatly on the distribution of   ϵ   ϵ   \epsilon   . However, if   ϵ   ϵ   \epsilon    does follow a multivariate normal distribution, the variance of the quadratic form becomes particularly tractable. Assume for the moment that   Λ   normal-Λ   \Lambda   is a symmetric matrix. Then,       var   [    ϵ  T   Λ  ϵ   ]    =    2   tr   [   Λ  Σ  Λ  Σ   ]     +   4   μ  T   Λ  Σ  Λ  μ         var     superscript  ϵ  T   normal-Λ  ϵ        2   tr    normal-Λ  normal-Σ  normal-Λ  normal-Σ       4   superscript  μ  T   normal-Λ  normal-Σ  normal-Λ  μ      \operatorname{var}\left[\epsilon^{T}\Lambda\epsilon\right]=2\operatorname{tr}%
 \left[\Lambda\Sigma\Lambda\Sigma\right]+4\mu^{T}\Lambda\Sigma\Lambda\mu     In fact, this can be generalized to find the covariance between two quadratic forms on the same   ϵ   ϵ   \epsilon   (once again,    Λ  1     subscript  normal-Λ  1    \Lambda_{1}   and    Λ  2     subscript  normal-Λ  2    \Lambda_{2}   must both be symmetric):       cov   [    ϵ  T    Λ  1   ϵ   ,    ϵ  T    Λ  2   ϵ   ]    =    2   tr   [    Λ  1   Σ   Λ  2   Σ   ]     +   4   μ  T    Λ  1   Σ   Λ  2   μ         cov     superscript  ϵ  T    subscript  normal-Λ  1   ϵ      superscript  ϵ  T    subscript  normal-Λ  2   ϵ        2   tr     subscript  normal-Λ  1   normal-Σ   subscript  normal-Λ  2   normal-Σ       4   superscript  μ  T    subscript  normal-Λ  1   normal-Σ   subscript  normal-Λ  2   μ      \operatorname{cov}\left[\epsilon^{T}\Lambda_{1}\epsilon,\epsilon^{T}\Lambda_{2%
 }\epsilon\right]=2\operatorname{tr}\left[\Lambda_{1}\Sigma\Lambda_{2}\Sigma%
 \right]+4\mu^{T}\Lambda_{1}\Sigma\Lambda_{2}\mu     Computing the variance in the non-symmetric case  Some texts incorrectly state that the above variance or covariance results hold without requiring   Λ   normal-Λ   \Lambda   to be symmetric. The case for general   Λ   normal-Λ   \Lambda   can be derived by noting that        ϵ  T    Λ  T   ϵ   =    ϵ  T   Λ  ϵ          superscript  ϵ  T    superscript  normal-Λ  T   ϵ      superscript  ϵ  T   normal-Λ  ϵ     \epsilon^{T}\Lambda^{T}\epsilon=\epsilon^{T}\Lambda\epsilon     so        ϵ  T    Λ  ~   ϵ   =     ϵ  T    (   Λ  +   Λ  T    )   ϵ   /  2          superscript  ϵ  T    normal-~  normal-Λ   ϵ        superscript  ϵ  T     normal-Λ   superscript  normal-Λ  T    ϵ   2     \epsilon^{T}\tilde{\Lambda}\epsilon=\epsilon^{T}\left(\Lambda+\Lambda^{T}%
 \right)\epsilon/2     But this is a quadratic form in the symmetric matrix     Λ  ~   =    (   Λ  +   Λ  T    )   /  2        normal-~  normal-Λ       normal-Λ   superscript  normal-Λ  T    2     \tilde{\Lambda}=\left(\Lambda+\Lambda^{T}\right)/2   , so the mean and variance expressions are the same, provided   Λ   normal-Λ   \Lambda   is replaced by    Λ  ~     normal-~  normal-Λ    \tilde{\Lambda}   therein.  Examples of quadratic forms  In the setting where one has a set of observations   y   y   y   and an operator matrix    H   H   H   , then the residual sum of squares can be written as a quadratic form in   y   y   y   :       RSS  =    y  T     (   I  -  H   )   T    (   I  -  H   )   y    .      RSS     superscript  y  T    superscript    I  H   T     I  H   y     \textrm{RSS}=y^{T}\left(I-H\right)^{T}\left(I-H\right)y.     For procedures where the matrix   H   H   H   is symmetric and idempotent , and the errors are Gaussian with covariance matrix     σ  2   I       superscript  σ  2   I    \sigma^{2}I   ,    RSS  /   σ  2       RSS   superscript  σ  2     \textrm{RSS}/\sigma^{2}   has a chi-squared distribution with   k   k   k   degrees of freedom and noncentrality parameter   λ   λ   \lambda   , where      k  =   tr   [     (   I  -  H   )   T    (   I  -  H   )    ]        k   tr     superscript    I  H   T     I  H       k=\operatorname{tr}\left[\left(I-H\right)^{T}\left(I-H\right)\right]         λ  =     μ  T     (   I  -  H   )   T    (   I  -  H   )   μ   /  2       λ       superscript  μ  T    superscript    I  H   T     I  H   μ   2     \lambda=\mu^{T}\left(I-H\right)^{T}\left(I-H\right)\mu/2     may be found by matching the first two central moments of a noncentral chi-squared random variable to the expressions given in the first two sections. If    H  y      H  y    Hy   estimates   μ   μ   \mu   with no bias , then the noncentrality   λ   λ   \lambda   is zero and    RSS  /   σ  2       RSS   superscript  σ  2     \textrm{RSS}/\sigma^{2}   follows a central chi-squared distribution.  References  See also   Quadratic form  Covariance matrix   "  Category:Multivariate statistics  Category:Quadratic forms     ↩  ↩     
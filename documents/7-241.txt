   Weak formulation      Weak formulation   Weak formulations are an important tool for the analysis of mathematical equations that permit the transfer of concepts of linear algebra to solve problems in other fields such as partial differential equations . In a weak formulation, an equation is no longer required to hold absolutely (and this is not even well defined) and has instead weak solutions only with respect to certain "test vectors" or " test functions ". This is equivalent to formulating the problem to require a solution in the sense of a distribution .  We introduce weak formulations by a few examples and present the main theorem for the solution, the Lax‚ÄìMilgram theorem .  General concept  Let   V   V   V   be a Banach space . We want to find the solution    u  ‚àà  V      u  V    u\in V   of the equation       A  u   =  f        A  u   f    Au=f   ,  where    A  :   V  ‚Üí   V  ‚Ä≤       normal-:  A   normal-‚Üí  V   superscript  V  normal-‚Ä≤      A:V\to V^{\prime}   and    f  ‚àà   V  ‚Ä≤       f   superscript  V  normal-‚Ä≤     f\in V^{\prime}   , with    V  ‚Ä≤     superscript  V  normal-‚Ä≤    V^{\prime}   being the dual of   V   V   V   .  Calculus of variations tells us that this is equivalent to finding    u  ‚àà  V      u  V    u\in V   such that for all    v  ‚àà  V      v  V    v\in V   holds:        [   A  u   ]    (  v  )    =   f   (  v  )           delimited-[]    A  u    v     f  v     [Au](v)=f(v)   .  Here, we call   v   v   v   a test vector or test function.  We bring this into the generic form of a weak formulation, namely, find    u  ‚àà  V      u  V    u\in V   such that         a   (  u  ,  v  )    =   f   (  v  )       ‚àÄ  v   ‚àà  V    ,     formulae-sequence      a   u  v      f  v       for-all  v   V     a(u,v)=f(v)\quad\forall v\in V,     by defining the bilinear form        a   (  u  ,  v  )    :=    [   A  u   ]    (  v  )     .     assign    a   u  v       delimited-[]    A  u    v     a(u,v):=[Au](v).     Since this is very abstract, let us follow this by some examples.  Example 1: linear system of equations  Now, let    V  =   ‚Ñù  n       V   superscript  ‚Ñù  n     V=\mathbb{R}^{n}   and    A  :   V  ‚Üí  V      normal-:  A   normal-‚Üí  V  V     A:V\to V   a linear mapping. Then, the weak formulation of the equation       A  u   =  f        A  u   f    Au=f     involves finding    u  ‚àà  V      u  V    u\in V   such that for all    v  ‚àà  V      v  V    v\in V   the following equation holds:        ‚ü®   A  u   ,  v  ‚ü©   =   ‚ü®  f  ,  v  ‚ü©    ,         A  u   v    f  v     \langle Au,v\rangle=\langle f,v\rangle,\,     where    ‚ü®  ‚ãÖ  ,  ‚ãÖ  ‚ü©     normal-‚ãÖ  normal-‚ãÖ    \langle\cdot,\cdot\rangle   denotes an inner product.  Since   A   A   A   is a linear mapping, it is sufficient to test with basis vectors, and we get         ‚ü®   A  u   ,   e  i   ‚ü©   =   ‚ü®  f  ,   e  i   ‚ü©     i  =   1  ,  ‚Ä¶  ,  n     .     formulae-sequence       A  u    subscript  e  i     f   subscript  e  i       i   1  normal-‚Ä¶  n      \langle Au,e_{i}\rangle=\langle f,e_{i}\rangle\quad i=1,\ldots,n.\,     Actually, expanding    u  =    ‚àë   j  =  1   n     u  j    e  j         u    superscript   subscript     j  1    n      subscript  u  j    subscript  e  j       u=\sum_{j=1}^{n}u_{j}e_{j}   , we obtain the matrix form of the equation       ùêÄùêÆ  =  ùêü   ,      ùêÄùêÆ  ùêü    \mathbf{A}\mathbf{u}=\mathbf{f},     where     a   i  j    =   ‚ü®   A   e  j    ,   e  i   ‚ü©        subscript  a    i  j       A   subscript  e  j     subscript  e  i      a_{ij}=\langle Ae_{j},e_{i}\rangle   and     f  i   =   ‚ü®  f  ,   e  i   ‚ü©        subscript  f  i    f   subscript  e  i      f_{i}=\langle f,e_{i}\rangle   .  The bilinear form associated to this weak formulation is        a   (  u  ,  v  )    =    ùêØ  T   ùêÄùêÆ    .        a   u  v       superscript  ùêØ  T   ùêÄùêÆ     a(u,v)=\mathbf{v}^{T}\mathbf{A}\mathbf{u}.     Example 2: Poisson's equation  Our aim is to solve Poisson's equation        -    ‚àá  2   u    =  f   ,          superscript  normal-‚àá  2   u    f    -\nabla^{2}u=f,\,     on a domain    Œ©  ‚äÇ   ‚Ñù  d       normal-Œ©   superscript  ‚Ñù  d     \Omega\subset\mathbb{R}^{d}   with    u  =  0      u  0    u=0   on its boundary, and we want to specify the solution space   V   V   V   later. We will use the    L  2     superscript  L  2    L^{2}   -scalar product       ‚ü®  u  ,  v  ‚ü©   =    ‚à´  Œ©    u   v   d  x         u  v     subscript   normal-Œ©     u  v  d  x      \langle u,v\rangle=\int_{\Omega}uv\,dx     to derive our weak formulation. Then, testing with differentiable functions   v   v   v   , we get        -    ‚à´  Œ©     (    ‚àá  2   u   )    v   d  x     =    ‚à´  Œ©    f   v   d  x     .          subscript   normal-Œ©       superscript  normal-‚àá  2   u   v  d  x       subscript   normal-Œ©     f  v  d  x      -\int_{\Omega}(\nabla^{2}u)v\,dx=\int_{\Omega}fv\,dx.     We can make the left side of this equation more symmetric by integration by parts using Green's identity :         ‚à´  Œ©     ‚àá  u   ‚ãÖ   ‚àá    v   d  x      =    ‚à´  Œ©    f   v   d  x     .        subscript   normal-Œ©    normal-‚ãÖ   normal-‚àá  u    normal-‚àá    v  d  x        subscript   normal-Œ©     f  v  d  x      \int_{\Omega}\nabla u\cdot\nabla v\,dx=\int_{\Omega}fv\,dx.     This is what is usually called the weak formulation of Poisson's equation ; what's missing is the space   V   V   V   , which is beyond the scope of this article. The space must allow us to write down this equation. Therefore, we should require that the derivatives of functions in this space are square integrable. Now, there is actually the Sobolev space      H  0  1    (  Œ©  )        subscript   superscript  H  1   0   normal-Œ©    H^{1}_{0}(\Omega)   of functions with weak derivatives in     L  2    (  Œ©  )        superscript  L  2   normal-Œ©    L^{2}(\Omega)   and with zero boundary conditions, which fulfills this purpose.  We obtain the generic form by assigning       a   (  u  ,  v  )    =    ‚à´  Œ©     ‚àá  u   ‚ãÖ   ‚àá    v   d  x            a   u  v      subscript   normal-Œ©    normal-‚ãÖ   normal-‚àá  u    normal-‚àá    v  d  x        a(u,v)=\int_{\Omega}\nabla u\cdot\nabla v\,dx     and        f   (  v  )    =    ‚à´  Œ©    f   v   d  x     .        f  v     subscript   normal-Œ©     f  v  d  x      f(v)=\int_{\Omega}fv\,dx.     The Lax‚ÄìMilgram theorem  This is a formulation of the Lax‚ÄìMilgram theorem which relies on properties of the symmetric part of the bilinear form . It is not the most general form.  Let   V   V   V   be a Hilbert space and    a   (  ‚ãÖ  ,  ‚ãÖ  )       a   normal-‚ãÖ  normal-‚ãÖ     a(\cdot,\cdot)   a bilinear form on   V   V   V   , which is   bounded      |   a   (  u  ,  v  )    |   ‚â§   C   ‚à•  u  ‚à•    ‚à•  v  ‚à•            a   u  v       C   norm  u    norm  v      |a(u,v)|\leq C\|u\|\|v\|   and  coercive       a   (  u  ,  u  )    ‚â•   c    ‚à•  u  ‚à•   2     .        a   u  u      c   superscript   norm  u   2      a(u,u)\geq c\|u\|^{2}.      Then, for any    f  ‚àà   V  ‚Ä≤       f   superscript  V  normal-‚Ä≤     f\in V^{\prime}   , there is a unique solution    u  ‚àà  V      u  V    u\in V   to the equation       a   (  u  ,  v  )    =   f   (  v  )          a   u  v      f  v     a(u,v)=f(v)     and it holds        ‚à•  u  ‚à•   ‚â§    1  c     ‚à•  f  ‚à•    V  ‚Ä≤      .       norm  u       1  c    subscript   norm  f    superscript  V  normal-‚Ä≤       \|u\|\leq\frac{1}{c}\|f\|_{V^{\prime}}.     Application to example 1  Here, application of the Lax‚ÄìMilgram theorem is definitely overkill, but we still can use it and give this problem the same structure as the others have.   Boundedness: all bilinear forms on    ‚Ñù  n     superscript  ‚Ñù  n    \mathbb{R}^{n}   are bounded. In particular, we have      |   a   (  u  ,  v  )    |   ‚â§    ‚à•  A  ‚à•    ‚à•  u  ‚à•    ‚à•  v  ‚à•            a   u  v        norm  A    norm  u    norm  v      |a(u,v)|\leq\|A\|\,\|u\|\,\|v\|\,     Coercivity: this actually means that the real parts of the eigenvalues of   A   A   A   are not smaller than   c   c   c   . Since this implies in particular that no eigenvalue is zero, the system is solvable.   Additionally, we get the estimate        ‚à•  u  ‚à•   ‚â§    1  c    ‚à•  f  ‚à•     ,       norm  u       1  c    norm  f      \|u\|\leq\frac{1}{c}\|f\|,\,     where   c   c   c   is the minimal real part of an eigenvalue of   A   A   A   .  Application to example 2  Here, as we mentioned above, we choose    V  =    H  0  1    (  Œ©  )        V     subscript   superscript  H  1   0   normal-Œ©     V=H^{1}_{0}(\Omega)   with the norm         ‚à•  v  ‚à•   V   :=   ‚à•   ‚àá  v   ‚à•    ,     assign   subscript   norm  v   V    norm   normal-‚àá  v      \|v\|_{V}:=\|\nabla v\|,     where the norm on the right is the    L  2     superscript  L  2    L^{2}   -norm on   Œ©   normal-Œ©   \Omega   (this provides a true norm on   V   V   V   by the Poincar√© inequality ). But, we see that     |   a   (  u  ,  u  )    |   =    ‚à•   ‚àá  u   ‚à•   2           a   u  u      superscript   norm   normal-‚àá  u    2     |a(u,u)|=\|\nabla u\|^{2}   and by the Cauchy‚ÄìSchwarz inequality ,     |   a   (  u  ,  v  )    |   ‚â§    ‚à•   ‚àá  u   ‚à•    ‚à•   ‚àá  v   ‚à•            a   u  v        norm   normal-‚àá  u     norm   normal-‚àá  v       |a(u,v)|\leq\|\nabla u\|\,\|\nabla v\|   .  Therefore, for any    f  ‚àà    [    H  0  1    (  Œ©  )    ]   ‚Ä≤       f   superscript   delimited-[]     subscript   superscript  H  1   0   normal-Œ©    normal-‚Ä≤     f\in[H^{1}_{0}(\Omega)]^{\prime}   , there is a unique solution    u  ‚àà  V      u  V    u\in V   of Poisson's equation and we have the estimate        ‚à•   ‚àá  u   ‚à•   ‚â§    ‚à•  f  ‚à•     [    H  0  1    (  Œ©  )    ]   ‚Ä≤     .       norm   normal-‚àá  u     subscript   norm  f    superscript   delimited-[]     subscript   superscript  H  1   0   normal-Œ©    normal-‚Ä≤      \|\nabla u\|\leq\|f\|_{[H^{1}_{0}(\Omega)]^{\prime}}.     See also   Babu≈°ka‚ÄìLax‚ÄìMilgram theorem  Lions‚ÄìLax‚ÄìMilgram theorem   References      External links   MathWorld page on Lax‚ÄìMilgram theorem   "  Category:Partial differential equations  Category:Numerical differential equations   
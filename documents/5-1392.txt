   Minimum mean square error      Minimum mean square error   In statistics and signal processing , a minimum mean square error ( MMSE ) estimator is an estimation method which minimizes the mean square error (MSE) of the fitted values of a dependent variable , which is a common measure of estimator quality.  The term MMSE more specifically refers to estimation in a Bayesian setting with quadratic cost function. The basic idea behind the Bayesian approach to estimation stems from practical situations where we often have some prior information about the parameter to be estimated. For instance, we may have prior information about the range that the parameter can assume; or we may have an old estimate of the parameter that we want to modify when a new observation is made available; or the statistics of an actual random signal such as speech. This is in contrast to the non-Bayesian approach like minimum-variance unbiased estimator (MVUE) where absolutely nothing is assumed to be known about the parameter in advance and which does not account for such situations. In the Bayesian approach, such prior information is captured by the prior probability density function of the parameters; and based directly on Bayes theorem , it allows us to make better posterior estimates as more observations become available. Thus unlike non-Bayesian approach where parameters of interest are assumed to be deterministic, but unknown constants, the Bayesian estimator seeks to estimate a parameter that is itself a random variable. Furthermore, Bayesian estimation can also deal with situations where the sequence of observations are not necessarily independent. Thus Bayesian estimation provides yet another alternative to the MVUE. This is useful when the MVUE does not exist or cannot be found.  Definition  Let   x   x   x   be a    n  √ó  1      n  1    n\times 1   hidden random vector variable, and let   y   y   y   be a    m  √ó  1      m  1    m\times 1   known random vector variable (the measurement or observation), both of them not necessarily of the same dimension. An estimator      x  ^    (  y  )        normal-^  x   y    \hat{x}(y)   of   x   x   x   is any function of the measurement   y   y   y   . The estimation error vector is given by    e  =    x  ^   -  x       e     normal-^  x   x     e=\hat{x}-x   and its mean squared error (MSE) is given by the trace of error covariance matrix      MSE  =   tr   {   E   {    (    x  ^   -  x   )     (    x  ^   -  x   )   T    }    }        MSE    tr     normal-E        normal-^  x   x    superscript     normal-^  x   x   T          \mathrm{MSE}=\mathrm{tr}\left\{\mathrm{E}\{(\hat{x}-x)(\hat{x}-x)^{T}\}\right\}   , where the expectation    E   normal-E   \mathrm{E}   is taken over both   x   x   x   and   y   y   y   . When   x   x   x   is a scalar variable, the MSE expression simplifies to    E   {    (    x  ^   -  x   )   2   }       normal-E    superscript     normal-^  x   x   2      \mathrm{E}\left\{(\hat{x}-x)^{2}\right\}   . Note that MSE can equivalently be defined in other ways, since        tr   {   E   {   e   e  T    }    }    =   E   {   tr   {   e   e  T    }    }    =   E   {    e  T   e   }    =    ‚àë   i  =  1   n    E   {   e  i  2   }      .          tr     normal-E     e   superscript  e  T          normal-E     tr     e   superscript  e  T               normal-E      superscript  e  T   e            superscript   subscript     i  1    n     normal-E    superscript   subscript  e  i   2         \mathrm{tr}\left\{\mathrm{E}\{ee^{T}\}\right\}=\mathrm{E}\left\{\mathrm{tr}\{%
 ee^{T}\}\right\}=\mathrm{E}\{e^{T}e\}=\sum_{i=1}^{n}\mathrm{E}\{e_{i}^{2}\}.     The MMSE estimator is then defined as the estimator achieving minimal MSE.  Properties   Under some weak regularity assumptions, 1 the MMSE estimator is uniquely defined, and is given by             x  ^   MMSE    (  y  )    =   E   {  x  |  y  }     .         subscript   normal-^  x   MMSE   y     normal-E   conditional-set  x  y      \hat{x}_{\mathrm{MMSE}}(y)=\mathrm{E}\left\{x|y\right\}.       In other words, the MMSE estimator is the conditional expectation of   x   x   x   given the known observed value of the measurements.    The MMSE estimator is unbiased (under the regularity assumptions mentioned above):           E   {     x  ^   MMSE    (  y  )    }    =   E   {   E   {  x  |  y  }    }    =   E   {  x  }     .          normal-E      subscript   normal-^  x   MMSE   y       normal-E     normal-E   conditional-set  x  y             normal-E   x       \mathrm{E}\{\hat{x}_{\mathrm{MMSE}}(y)\}=\mathrm{E}\{\mathrm{E}\{x|y\}\}=%
 \mathrm{E}\{x\}.         The MMSE estimator is asymptotically unbiased and it converges in distribution to the normal distribution:            n    (    x  ^   -  x   )     ‚Üí  ùëë    ùí©   (  0  ,    I   -  1     (  x  )    )     ,      d  normal-‚Üí       n      normal-^  x   x      ùí©   0     superscript  I    1    x       \sqrt{n}(\hat{x}-x)\xrightarrow{d}\mathcal{N}\left(0,I^{-1}(x)\right),       where    I   (  x  )       I  x    I(x)   is the Fisher information of   x   x   x   . Thus, the MMSE estimator is asymptotically efficient .    The orthogonality principle : When   x   x   x   is a scalar, an estimator constrained to be of certain form     x  ^   =   g   (  y  )         normal-^  x     g  y     \hat{x}=g(y)   is an optimal estimator, i.e.       x  ^   MMSE   =    g  *    (  y  )     ,       subscript   normal-^  x   MMSE      superscript  g    y     \hat{x}_{\mathrm{MMSE}}=g^{*}(y),   if and only if          E   {    (     x  ^   MMSE   -  x   )   g   (  y  )    }    =  0        normal-E        subscript   normal-^  x   MMSE   x   g  y     0    \mathrm{E}\{(\hat{x}_{\mathrm{MMSE}}-x)g(y)\}=0       for all    g   (  y  )       g  y    g(y)   in closed, linear subspace    ùí±  =   {   g   (  y  )    |   g  :     ‚Ñù  m   ‚Üí  ‚Ñù   ,    E   {   g    (  y  )   2    }    <   +  ‚àû      }       ùí±   conditional-set    g  y    normal-:  g   formulae-sequence   normal-‚Üí   superscript  ‚Ñù  m   ‚Ñù       normal-E     g   superscript  y  2                \mathcal{V}=\{g(y)|g:\mathbb{R}^{m}\rightarrow\mathbb{R},\mathrm{E}\{g(y)^{2}%
 \}<+\infty\}   of the measurements. For random vectors, since the MSE for estimation of a random vector is the sum of the MSEs of the coordinates, finding the MMSE estimator of a random vector decomposes into finding the MMSE estimators of the coordinates of X separately:       E   {    (     g  i  *    (  y  )    -   x  i    )    g  j    (  y  )    }    =  0   ,        normal-E          superscript   subscript  g  i     y    subscript  x  i     subscript  g  j   y     0    \mathrm{E}\{(g_{i}^{*}(y)-x_{i})g_{j}(y)\}=0,      for all i and j . More succinctly put, the cross-correlation between the minimum estimation error      x  ^   MMSE   -  x       subscript   normal-^  x   MMSE   x    \hat{x}_{\mathrm{MMSE}}-x   and the estimator    x  ^     normal-^  x    \hat{x}   should be zero,      E   {    (     x  ^   MMSE   -  x   )     x  ^   T    }    =  0.        normal-E        subscript   normal-^  x   MMSE   x    superscript   normal-^  x   T      0.    \mathrm{E}\{(\hat{x}_{\mathrm{MMSE}}-x)\hat{x}^{T}\}=0.        If   x   x   x   and   y   y   y   are jointly Gaussian , then the MMSE estimator is linear, i.e., it has the form     W  y   +  b        W  y   b    Wy+b   for matrix   W   W   W   and constant   b   b   b   . This can be directly shown using the Bayes theorem. As a consequence, to find the MMSE estimator, it is sufficient to find the linear MMSE estimator.   Linear MMSE estimator  In many cases, it is not possible to determine a closed form expression for the conditional expectation    E   {  x  |  y  }       normal-E   conditional-set  x  y     \mathrm{E}\{x|y\}   required to obtain the MMSE estimator. Direct numerical evaluation of the conditional expectation is computationally expensive, since they often require multidimensional integration usually done using Monte Carlo methods . In such cases, one possibility is to abandon the full optimality requirements and seek a technique minimizing the MSE within a particular class of estimators, such as the class of linear estimators. Thus we postulate that the conditional expectation of   x   x   x   given   y   y   y   is a simple linear function of   y   y   y   ,     E   {  x  |  y  }    =    W  y   +  b         normal-E   conditional-set  x  y        W  y   b     \mathrm{E}\{x|y\}=Wy+b   , where the measurement   y   y   y   is a random vector,   W   W   W   is a matrix and   b   b   b   is a vector. The linear MMSE estimator is the estimator achieving minimum MSE among all estimators of such form. One advantage of such linear MMSE estimator is that it is not necessary to explicitly calculate the posterior probability density function of   x   x   x   . Such linear estimator only depends on the first two moments of the probability density function. So although it may be convenient to assume that   x   x   x   and   y   y   y   are jointly Gaussian, it is not necessary to make this assumption, so long as the assumed distribution has well defined first and second moments. The form of the linear estimator does not depend on the type of the assumed underlying distribution.  The expression for optimal   b   b   b   and   W   W   W   is given by       b  =    x  ¬Ø   -   W   y  ¬Ø      ,      b     normal-¬Ø  x     W   normal-¬Ø  y       b=\bar{x}-W\bar{y},          W  =    C   X  Y     C  Y   -  1      .      W     subscript  C    X  Y     subscript   superscript  C    1    Y      W=C_{XY}C^{-1}_{Y}.     Thus the expression for linear MMSE estimator, its mean, and its auto-covariance is given by        x  ^   =    W   (   y  -   y  ¬Ø    )    +   x  ¬Ø     ,       normal-^  x       W    y   normal-¬Ø  y      normal-¬Ø  x      \hat{x}=W(y-\bar{y})+\bar{x},           E   {   x  ^   }    =   x  ¬Ø    ,        normal-E    normal-^  x      normal-¬Ø  x     \mathrm{E}\{\hat{x}\}=\bar{x},           C   X  ^    =    C   X  Y     C  Y   -  1     C   Y  X      ,       subscript  C   normal-^  X       subscript  C    X  Y     subscript   superscript  C    1    Y    subscript  C    Y  X       C_{\hat{X}}=C_{XY}C^{-1}_{Y}C_{YX},     where     x  ¬Ø   =   E   {  x  }         normal-¬Ø  x     normal-E   x      \bar{x}=\mathrm{E}\{x\}   ,      y  ¬Ø   =   E   {  y  }     ,       normal-¬Ø  y     normal-E   y      \bar{y}=\mathrm{E}\{y\},   the    C   X  Y      subscript  C    X  Y     C_{XY}   is cross-covariance matrix between   x   x   x   and   y   y   y   , the    C  Y     subscript  C  Y    C_{Y}   is auto-covariance matrix of   y   y   y   , and the    C   Y  X      subscript  C    Y  X     C_{YX}   is cross-covariance matrix between   y   y   y   and   x   x   x   . Lastly, the error covariance and minimum mean square error achievable by such estimator is        C  e   =    C  X   -   C   X  ^     =    C  X   -    C   X  Y     C  Y   -  1     C   Y  X       ,         subscript  C  e      subscript  C  X    subscript  C   normal-^  X             subscript  C  X      subscript  C    X  Y     subscript   superscript  C    1    Y    subscript  C    Y  X         C_{e}=C_{X}-C_{\hat{X}}=C_{X}-C_{XY}C^{-1}_{Y}C_{YX},          LMMSE  =   tr   {   C  e   }     .      LMMSE    tr    subscript  C  e       \mathrm{LMMSE}=\mathrm{tr}\{C_{e}\}.     For the special case when both   x   x   x   and   y   y   y   are scalars, the above relations simplify to        x  ^   =      œÉ   X  Y     œÉ  Y  2     (   y  -   y  ¬Ø    )    +   x  ¬Ø     ,       normal-^  x          subscript  œÉ    X  Y     superscript   subscript  œÉ  Y   2      y   normal-¬Ø  y      normal-¬Ø  x      \hat{x}=\frac{\sigma_{XY}}{\sigma_{Y}^{2}}(y-\bar{y})+\bar{x},           œÉ  e  2   =    œÉ  X  2   -    œÉ   X  Y   2    œÉ  Y  2      .       subscript   superscript  œÉ  2   e      superscript   subscript  œÉ  X   2      superscript   subscript  œÉ    X  Y    2    superscript   subscript  œÉ  Y   2       \sigma^{2}_{e}=\sigma_{X}^{2}-\frac{\sigma_{XY}^{2}}{\sigma_{Y}^{2}}.     Let us have the optimal linear MMSE estimator given as     x  ^   =    W  y   +  b        normal-^  x       W  y   b     \hat{x}=Wy+b   , where we are required to find the expression for   W   W   W   and   b   b   b   . It is required that the MMSE estimator be unbiased. This means,        E   {   x  ^   }    =   E   {  x  }     .        normal-E    normal-^  x       normal-E   x      \mathrm{E}\{\hat{x}\}=\mathrm{E}\{x\}.     Plugging the expression for    x  ^     normal-^  x    \hat{x}   in above, we get       b  =    x  ¬Ø   -   W   y  ¬Ø      ,      b     normal-¬Ø  x     W   normal-¬Ø  y       b=\bar{x}-W\bar{y},     where     x  ¬Ø   =   E   {  x  }         normal-¬Ø  x     normal-E   x      \bar{x}=\mathrm{E}\{x\}   and     y  ¬Ø   =   E   {  y  }         normal-¬Ø  y     normal-E   y      \bar{y}=\mathrm{E}\{y\}   . Thus we can re-write the estimator as       x  ^   =    W   (   y  -   y  ¬Ø    )    +   x  ¬Ø         normal-^  x       W    y   normal-¬Ø  y      normal-¬Ø  x      \hat{x}=W(y-\bar{y})+\bar{x}     and the expression for estimation error becomes         x  ^   -  x   =    W   (   y  -   y  ¬Ø    )    -   (   x  -   x  ¬Ø    )     .         normal-^  x   x       W    y   normal-¬Ø  y       x   normal-¬Ø  x       \hat{x}-x=W(y-\bar{y})-(x-\bar{x}).     From the orthogonality principle, we can have     E   {    (    x  ^   -  x   )     (   y  -   y  ¬Ø    )   T    }    =  0        normal-E        normal-^  x   x    superscript    y   normal-¬Ø  y    T      0    \mathrm{E}\{(\hat{x}-x)(y-\bar{y})^{T}\}=0   , where we take     g   (  y  )    =   y  -   y  ¬Ø          g  y     y   normal-¬Ø  y      g(y)=y-\bar{y}   . Here the left hand side term is         E   {    (    x  ^   -  x   )     (   y  -   y  ¬Ø    )   T    }        =   E   {    (    W   (   y  -   y  ¬Ø    )    -   (   x  -   x  ¬Ø    )    )     (   y  -   y  ¬Ø    )   T    }            =    W  E   {    (   y  -   y  ¬Ø    )     (   y  -   y  ¬Ø    )   T    }    -   E   {    (   x  -   x  ¬Ø    )     (   y  -   y  ¬Ø    )   T    }              =    W   C  Y    -   C   X  Y      .           normal-E        normal-^  x   x    superscript    y   normal-¬Ø  y    T        absent    normal-E         W    y   normal-¬Ø  y       x   normal-¬Ø  x      superscript    y   normal-¬Ø  y    T          missing-subexpression     absent      W  normal-E       y   normal-¬Ø  y     superscript    y   normal-¬Ø  y    T        normal-E       x   normal-¬Ø  x     superscript    y   normal-¬Ø  y    T           missing-subexpression     absent      W   subscript  C  Y     subscript  C    X  Y         \begin{array}[]{ll}\mathrm{E}\{(\hat{x}-x)(y-\bar{y})^{T}\}&=\mathrm{E}\{(W(y-%
 \bar{y})-(x-\bar{x}))(y-\bar{y})^{T}\}\\
 &=W\mathrm{E}\{(y-\bar{y})(y-\bar{y})^{T}\}-\mathrm{E}\{(x-\bar{x})(y-\bar{y})%
 ^{T}\}\\
 &=WC_{Y}-C_{XY}.\end{array}     When equated to zero, we obtain the desired expression for   W   W   W   as       W  =    C   X  Y     C  Y   -  1      .      W     subscript  C    X  Y     subscript   superscript  C    1    Y      W=C_{XY}C^{-1}_{Y}.     The    C   X  Y      subscript  C    X  Y     C_{XY}   is cross-covariance matrix between X and Y, and    C  Y     subscript  C  Y    C_{Y}   is auto-covariance matrix of Y. Since     C   X  Y    =   C   Y  X   T        subscript  C    X  Y     subscript   superscript  C  T     Y  X      C_{XY}=C^{T}_{YX}   , the expression can also be re-written in terms of    C   Y  X      subscript  C    Y  X     C_{YX}   as        W  T   =    C  Y   -  1     C   Y  X      .       superscript  W  T      subscript   superscript  C    1    Y    subscript  C    Y  X       W^{T}=C^{-1}_{Y}C_{YX}.     Thus the full expression for the linear MMSE estimator is        x  ^   =     C   X  Y     C  Y   -  1     (   y  -   y  ¬Ø    )    +   x  ¬Ø     .       normal-^  x        subscript  C    X  Y     subscript   superscript  C    1    Y     y   normal-¬Ø  y      normal-¬Ø  x      \hat{x}=C_{XY}C^{-1}_{Y}(y-\bar{y})+\bar{x}.     Since the estimate    x  ^     normal-^  x    \hat{x}   is itself a random variable with     E   {   x  ^   }    =   x  ¬Ø         normal-E    normal-^  x      normal-¬Ø  x     \mathrm{E}\{\hat{x}\}=\bar{x}   , we can also obtain its auto-covariance as         C   X  ^        =   E   {    (    x  ^   -   x  ¬Ø    )     (    x  ^   -   x  ¬Ø    )   T    }            =   W  E   {    (   y  -   y  ¬Ø    )     (   y  -   y  ¬Ø    )   T    }    W  T             =   W   C  Y    W  T     .          subscript  C   normal-^  X      absent    normal-E        normal-^  x    normal-¬Ø  x     superscript     normal-^  x    normal-¬Ø  x    T          missing-subexpression     absent    W  normal-E       y   normal-¬Ø  y     superscript    y   normal-¬Ø  y    T      superscript  W  T        missing-subexpression     absent    W   subscript  C  Y    superscript  W  T        \begin{array}[]{ll}C_{\hat{X}}&=\mathrm{E}\{(\hat{x}-\bar{x})(\hat{x}-\bar{x})%
 ^{T}\}\\
 &=W\mathrm{E}\{(y-\bar{y})(y-\bar{y})^{T}\}W^{T}\\
 &=WC_{Y}W^{T}.\\
 \end{array}     Putting the expression for   W   W   W   and    W  T     superscript  W  T    W^{T}   , we get        C   X  ^    =    C   X  Y     C  Y   -  1     C   Y  X      .       subscript  C   normal-^  X       subscript  C    X  Y     subscript   superscript  C    1    Y    subscript  C    Y  X       C_{\hat{X}}=C_{XY}C^{-1}_{Y}C_{YX}.     Lastly, the covariance of linear MMSE estimation error will then be given by         C  e       =   E   {    (    x  ^   -  x   )     (    x  ^   -  x   )   T    }            =   E   {    (    x  ^   -  x   )     (    W   (   y  -   y  ¬Ø    )    -   (   x  -   x  ¬Ø    )    )   T    }            =       E   {    (    x  ^   -  x   )     (   y  -   y  ¬Ø    )   T    }    ‚èü   0    W  T    -   E   {    (    x  ^   -  x   )     (   x  -   x  ¬Ø    )   T    }             =   -   E   {    (    W   (   y  -   y  ¬Ø    )    -   (   x  -   x  ¬Ø    )    )     (   x  -   x  ¬Ø    )   T    }             =    E   {    (   x  -   x  ¬Ø    )     (   x  -   x  ¬Ø    )   T    }    -   W  E   {    (   y  -   y  ¬Ø    )     (   x  -   x  ¬Ø    )   T    }              =    C  X   -   W   C   Y  X       .          subscript  C  e     absent    normal-E        normal-^  x   x    superscript     normal-^  x   x   T          missing-subexpression     absent    normal-E        normal-^  x   x    superscript      W    y   normal-¬Ø  y       x   normal-¬Ø  x     T          missing-subexpression     absent       subscript   normal-‚èü    normal-E        normal-^  x   x    superscript    y   normal-¬Ø  y    T       0    superscript  W  T      normal-E        normal-^  x   x    superscript    x   normal-¬Ø  x    T           missing-subexpression     absent      normal-E         W    y   normal-¬Ø  y       x   normal-¬Ø  x      superscript    x   normal-¬Ø  x    T           missing-subexpression     absent      normal-E       x   normal-¬Ø  x     superscript    x   normal-¬Ø  x    T        W  normal-E       y   normal-¬Ø  y     superscript    x   normal-¬Ø  x    T           missing-subexpression     absent     subscript  C  X     W   subscript  C    Y  X          \begin{array}[]{ll}C_{e}&=\mathrm{E}\{(\hat{x}-x)(\hat{x}-x)^{T}\}\\
 &=\mathrm{E}\{(\hat{x}-x)(W(y-\bar{y})-(x-\bar{x}))^{T}\}\\
 &=\underbrace{\mathrm{E}\{(\hat{x}-x)(y-\bar{y})^{T}\}}_{0}W^{T}-\mathrm{E}\{(%
 \hat{x}-x)(x-\bar{x})^{T}\}\\
 &=-\mathrm{E}\{(W(y-\bar{y})-(x-\bar{x}))(x-\bar{x})^{T}\}\\
 &=\mathrm{E}\{(x-\bar{x})(x-\bar{x})^{T}\}-W\mathrm{E}\{(y-\bar{y})(x-\bar{x})%
 ^{T}\}\\
 &=C_{X}-WC_{YX}.\\
 \end{array}     The first term in the third line is zero due to the orthogonality principle. Since    W  =    C   X  Y     C  Y   -  1         W     subscript  C    X  Y     subscript   superscript  C    1    Y      W=C_{XY}C^{-1}_{Y}   , we can re-write    C  e     subscript  C  e    C_{e}   in terms of covariance matrices as        C  e   =    C  X   -    C   X  Y     C  Y   -  1     C   Y  X       .       subscript  C  e      subscript  C  X      subscript  C    X  Y     subscript   superscript  C    1    Y    subscript  C    Y  X        C_{e}=C_{X}-C_{XY}C^{-1}_{Y}C_{YX}.     This we can recognize to be the same as      C  e   =    C  X   -   C   X  ^      .       subscript  C  e      subscript  C  X    subscript  C   normal-^  X       C_{e}=C_{X}-C_{\hat{X}}.   Thus the minimum mean square error achievable by such a linear estimator is      LMMSE  =   tr   {   C  e   }        LMMSE    tr    subscript  C  e       \mathrm{LMMSE}=\mathrm{tr}\{C_{e}\}   .  Standard method like Gauss elimination can be used to solve the matrix equation for   W   W   W   . A more numerically stable method is provided by QR decomposition method. Since the matrix    C  Y     subscript  C  Y    C_{Y}   is a symmetric positive definite matrix,   W   W   W   can be solved twice as fast with the Cholesky decomposition , while for large sparse systems conjugate gradient method is more effective. Levinson recursion is a fast method when    C  Y     subscript  C  Y    C_{Y}   is also a Toeplitz matrix . This can happen when   y   y   y   is a wide sense stationary process. In such stationary cases, these estimators are also referred to as Wiener-Kolmogorov filters .  Linear MMSE estimator for linear observation process  Let us further model the underlying process of observation as a linear process    y  =    A  x   +  z       y      A  x   z     y=Ax+z   , where   A   A   A   is a known matrix and   z   z   z   is random noise vector with the mean     E   {  z  }    =  0        normal-E   z    0    \mathrm{E}\{z\}=0   and cross-covariance     C   X  Z    =  0       subscript  C    X  Z    0    C_{XZ}=0   . Here the required mean and the covariance matrices will be        E   {  y  }    =   A   x  ¬Ø     ,        normal-E   y      A   normal-¬Ø  x      \mathrm{E}\{y\}=A\bar{x},           C  Y   =    A   C  X    A  T    +   C  Z     ,       subscript  C  Y       A   subscript  C  X    superscript  A  T     subscript  C  Z      C_{Y}=AC_{X}A^{T}+C_{Z},           C   X  Y    =    C  X    A  T     .       subscript  C    X  Y       subscript  C  X    superscript  A  T      C_{XY}=C_{X}A^{T}.     Thus the expression for the linear MMSE estimator matrix   W   W   W   further modifies to       W  =    C  X    A  T     (    A   C  X    A  T    +   C  Z    )    -  1      .      W     subscript  C  X    superscript  A  T    superscript      A   subscript  C  X    superscript  A  T     subscript  C  Z      1       W=C_{X}A^{T}(AC_{X}A^{T}+C_{Z})^{-1}.     Putting everything into the expression for    x  ^     normal-^  x    \hat{x}   , we get        x  ^   =     C  X    A  T     (    A   C  X    A  T    +   C  Z    )    -  1     (   y  -   A   x  ¬Ø     )    +   x  ¬Ø     .       normal-^  x        subscript  C  X    superscript  A  T    superscript      A   subscript  C  X    superscript  A  T     subscript  C  Z      1      y    A   normal-¬Ø  x       normal-¬Ø  x      \hat{x}=C_{X}A^{T}(AC_{X}A^{T}+C_{Z})^{-1}(y-A\bar{x})+\bar{x}.     Lastly, the error covariance is        C  e   =    C  X   -   C   X  ^     =    C  X   -    C  X    A  T     (    A   C  X    A  T    +   C  Z    )    -  1    A   C  X      .         subscript  C  e      subscript  C  X    subscript  C   normal-^  X             subscript  C  X      subscript  C  X    superscript  A  T    superscript      A   subscript  C  X    superscript  A  T     subscript  C  Z      1    A   subscript  C  X        C_{e}=C_{X}-C_{\hat{X}}=C_{X}-C_{X}A^{T}(AC_{X}A^{T}+C_{Z})^{-1}AC_{X}.     The significant difference between the estimation problem treated above and those of least squares and Gauss-Markov estimate is that the number of observations m , (i.e. the dimension of   y   y   y   ) need not be at least as large as the number of unknowns, n , (i.e. the dimension of   x   x   x   ). The estimate for the linear observation process exists so long as the m -by- m matrix     (    A   C  X    A  T    +   C  Z    )    -  1      superscript      A   subscript  C  X    superscript  A  T     subscript  C  Z      1     (AC_{X}A^{T}+C_{Z})^{-1}   exists; this is the case for any m if, for instance,    C  Z     subscript  C  Z    C_{Z}   is positive definite. Physically the reason for this property is that since   x   x   x   is now a random variable, it is possible to form a meaningful estimate (namely its mean) even with no measurements. Every new measurement simply provides additional information which may modify our original estimate. Another feature of this estimate is that for m C_Z = 0, because as long as    A   C  X    A  T       A   subscript  C  X    superscript  A  T     AC_{X}A^{T}   is positive definite, the estimate still exists. Lastly, this technique can handle cases where the noise is correlated, or in other words, when the noise is non-white.  Alternative form  An alternative form of expression can be obtained by using the matrix identity         C  X    A  T     (    A   C  X    A  T    +   C  Z    )    -  1     =     (     A  T    C  Z   -  1    A   +   C  X   -  1     )    -  1     A  T    C  Z   -  1      ,         subscript  C  X    superscript  A  T    superscript      A   subscript  C  X    superscript  A  T     subscript  C  Z      1        superscript       superscript  A  T    superscript   subscript  C  Z     1    A    superscript   subscript  C  X     1       1     superscript  A  T    superscript   subscript  C  Z     1       C_{X}A^{T}(AC_{X}A^{T}+C_{Z})^{-1}=(A^{T}C_{Z}^{-1}A+C_{X}^{-1})^{-1}A^{T}C_{Z%
 }^{-1},   which can be established by post-multiplying by    (    A   C  X    A  T    +   C  Z    )        A   subscript  C  X    superscript  A  T     subscript  C  Z     (AC_{X}A^{T}+C_{Z})   and pre-multiplying by     (     A  T    C  Z   -  1    A   +   C  X   -  1     )   ,         superscript  A  T    superscript   subscript  C  Z     1    A    superscript   subscript  C  X     1      (A^{T}C_{Z}^{-1}A+C_{X}^{-1}),   to obtain       W  =     (     A  T    C  Z   -  1    A   +   C  X   -  1     )    -  1     A  T    C  Z   -  1      ,      W     superscript       superscript  A  T    superscript   subscript  C  Z     1    A    superscript   subscript  C  X     1       1     superscript  A  T    superscript   subscript  C  Z     1       W=(A^{T}C_{Z}^{-1}A+C_{X}^{-1})^{-1}A^{T}C_{Z}^{-1},   and        C  e   =    (     A  T    C  Z   -  1    A   +   C  X   -  1     )    -  1     .       subscript  C  e    superscript       superscript  A  T    superscript   subscript  C  Z     1    A    superscript   subscript  C  X     1       1      C_{e}=(A^{T}C_{Z}^{-1}A+C_{X}^{-1})^{-1}.     Since   W   W   W   can now be written in terms of    C  e     subscript  C  e    C_{e}   as    W  =    C  e    A  T    C  Z   -  1         W     subscript  C  e    superscript  A  T    superscript   subscript  C  Z     1       W=C_{e}A^{T}C_{Z}^{-1}   , we get a simplified expression for    x  ^     normal-^  x    \hat{x}   as        x  ^   =     C  e    A  T    C  Z   -  1     (   y  -   A   x  ¬Ø     )    +   x  ¬Ø     .       normal-^  x        subscript  C  e    superscript  A  T    superscript   subscript  C  Z     1      y    A   normal-¬Ø  x       normal-¬Ø  x      \hat{x}=C_{e}A^{T}C_{Z}^{-1}(y-A\bar{x})+\bar{x}.     In this form the above expression can be easily compared with weighed least square and Gauss-Markov estimate . In particular, when     C  X   -  1    =  0       superscript   subscript  C  X     1    0    C_{X}^{-1}=0   , corresponding to infinite variance of the apriori information concerning   x   x   x   , the result    W  =     (    A  T    C  Z   -  1    A   )    -  1     A  T    C  Z   -  1         W     superscript     superscript  A  T    superscript   subscript  C  Z     1    A     1     superscript  A  T    superscript   subscript  C  Z     1       W=(A^{T}C_{Z}^{-1}A)^{-1}A^{T}C_{Z}^{-1}   is identical to the weighed linear least square estimate with    C  Z   -  1      superscript   subscript  C  Z     1     C_{Z}^{-1}   as the weight matrix. Moreover, if the components of   z   z   z   are uncorrelated and have equal variance such that      C  Z   =    œÉ  2   I    ,       subscript  C  Z      superscript  œÉ  2   I     C_{Z}=\sigma^{2}I,   where   I   I   I   is an identity matrix, then    W  =     (    A  T   A   )    -  1     A  T        W     superscript     superscript  A  T   A     1     superscript  A  T      W=(A^{T}A)^{-1}A^{T}   which has the same expression as the ordinary least square estimate.  Sequential linear MMSE estimation  For stationary process  In many real-time application, observational data is not available in a single batch. Instead the observations are made in a sequence. A naive application of previous formulas would have us discard an old estimate and recompute a new estimate as fresh data is made available. But then we lose all information provided by the old observation. When the observations are scalar quantities, one possible way of avoiding such re-computation is to first concatenate the entire sequence of observations and then apply the standard estimation formula as done in Example 2. But this can be very tedious because as the number of observation increases so does the size of the matrices that need to be inverted and multiplied grow. Also, this method is difficult to extend to the case of vector observations. Another approach to estimation from sequential observations is to simply update an old estimate as additional data becomes available, leading to finer estimates. Thus a recursive method is desired where the new measurements can modify the old estimates. Implicit in these discussions is the assumption that the statistical properties of   x   x   x   does not change with time. In other words,   x   x   x   is stationary.  For sequential estimation, if we have an estimate     x  ^   1     subscript   normal-^  x   1    \hat{x}_{1}   based on measurements generating space    Y  1     subscript  Y  1    Y_{1}   , then after receiving another set of measurements, we should subtract out from these measurements that part that could be anticipated from the result of the first measurements. In other words, the updating must be based on that part of the new data which is orthogonal to the old data.  Suppose an optimal estimate     x  ^   1     subscript   normal-^  x   1    \hat{x}_{1}   has been formed on the basis of past measurements and that error covariance matrix is    C   e  1      subscript  C   subscript  e  1     C_{e_{1}}   . For linear observation processes the best estimate of   y   y   y   based on past observation, and hence old estimate     x  ^   1     subscript   normal-^  x   1    \hat{x}_{1}   , is     y  ^   =   A    x  ^   1         normal-^  y     A   subscript   normal-^  x   1      \hat{y}=A\hat{x}_{1}   . Subtracting    y  ^     normal-^  y    \hat{y}   from   y   y   y   , we obtain     y  ~   =   y  -   y  ^    =    A   (   x  -    x  ^   1    )    +  z   =    A   e  1    +  z          normal-~  y     y   normal-^  y             A    x   subscript   normal-^  x   1     z            A   subscript  e  1    z      \tilde{y}=y-\hat{y}=A(x-\hat{x}_{1})+z=Ae_{1}+z   . The new estimate based on additional data is now         x  ^   2   =     x  ^   1   +    C   X   Y  ~      C   Y  ~    -  1     y  ~      ,       subscript   normal-^  x   2      subscript   normal-^  x   1      subscript  C    X   normal-~  Y      superscript   subscript  C   normal-~  Y      1     normal-~  y       \hat{x}_{2}=\hat{x}_{1}+C_{X\tilde{Y}}C_{\tilde{Y}}^{-1}\tilde{y},   where    C   X   Y  ~       subscript  C    X   normal-~  Y      C_{X\tilde{Y}}   is the cross-covariance between   x   x   x   and    y  ~     normal-~  y    \tilde{y}   and    C   Y  ~      subscript  C   normal-~  Y     C_{\tilde{Y}}   is the auto-covariance of     y  ~   .     normal-~  y    \tilde{y}.     Using the fact that     E   {   y  ~   }    =  0        normal-E    normal-~  y     0    \mathrm{E}\{\tilde{y}\}=0   and    x  =     x  ^   1   +   e  1        x     subscript   normal-^  x   1    subscript  e  1      x=\hat{x}_{1}+e_{1}   , we can obtain the covariance matrices in terms of error covariance as        C   Y  ~    =    A   C   e  1     A  T    +   C  Z     ,       subscript  C   normal-~  Y        A   subscript  C   subscript  e  1     superscript  A  T     subscript  C  Z      C_{\tilde{Y}}=AC_{e_{1}}A^{T}+C_{Z},           C   X   Y  ~     =   E   {    (      x  ^   1   +   e  1    -   x  ¬Ø    )     (    A   e  1    +  z   )   T    }    =    C   e  1     A  T     .         subscript  C    X   normal-~  Y       normal-E          subscript   normal-^  x   1    subscript  e  1     normal-¬Ø  x     superscript      A   subscript  e  1    z   T              subscript  C   subscript  e  1     superscript  A  T       C_{X\tilde{Y}}=\mathrm{E}\{(\hat{x}_{1}+e_{1}-\bar{x})(Ae_{1}+z)^{T}\}=C_{e_{1%
 }}A^{T}.   Putting everything together, we have the new estimate as         x  ^   2   =     x  ^   1   +    C   e  1     A  T     (    A   C   e  1     A  T    +   C  Z    )    -  1     (   y  -   A    x  ^   1     )      ,       subscript   normal-^  x   2      subscript   normal-^  x   1      subscript  C   subscript  e  1     superscript  A  T    superscript      A   subscript  C   subscript  e  1     superscript  A  T     subscript  C  Z      1      y    A   subscript   normal-^  x   1         \hat{x}_{2}=\hat{x}_{1}+C_{e_{1}}A^{T}(AC_{e_{1}}A^{T}+C_{Z})^{-1}(y-A\hat{x}_%
 {1}),   and the new error covariance as        C   e  2    =    C   e  1    -    C   e  1     A  T     (    A   C   e  1     A  T    +   C  Z    )    -  1    A   C   e  1       .       subscript  C   subscript  e  2       subscript  C   subscript  e  1       subscript  C   subscript  e  1     superscript  A  T    superscript      A   subscript  C   subscript  e  1     superscript  A  T     subscript  C  Z      1    A   subscript  C   subscript  e  1        C_{e_{2}}=C_{e_{1}}-C_{e_{1}}A^{T}(AC_{e_{1}}A^{T}+C_{Z})^{-1}AC_{e_{1}}.     The repeated use of the above two equations as more observations become available lead to recursive estimation techniques. The expressions can be more compactly written as  :#      K  2   =    C   e  1     A  T     (    A   C   e  1     A  T    +   C  Z    )    -  1      ,       subscript  K  2      subscript  C   subscript  e  1     superscript  A  T    superscript      A   subscript  C   subscript  e  1     superscript  A  T     subscript  C  Z      1       K_{2}=C_{e_{1}}A^{T}(AC_{e_{1}}A^{T}+C_{Z})^{-1},     :#       x  ^   2   =     x  ^   1   +    K  2    (   y  -   A    x  ^   1     )      ,       subscript   normal-^  x   2      subscript   normal-^  x   1      subscript  K  2     y    A   subscript   normal-^  x   1         \hat{x}_{2}=\hat{x}_{1}+K_{2}(y-A\hat{x}_{1}),     :#      C   e  2    =    (   I  -    K  2   A    )    C   e  1      .       subscript  C   subscript  e  2        I     subscript  K  2   A     subscript  C   subscript  e  1       C_{e_{2}}=(I-K_{2}A)C_{e_{1}}.     The matrix   K   K   K   is often referred to as the gain factor. The repetition of these three steps as more data becomes available leads to an iterative estimation algorithm.  For example, an easy to use recursive expression can be derived when at each m -th time instant the underlying linear observation process yields a scalar such that     y  m   =     a  m  T    x  m    +   z  m         subscript  y  m        superscript   subscript  a  m   T    subscript  x  m     subscript  z  m      y_{m}=a_{m}^{T}x_{m}+z_{m}   , where    a  m  T     superscript   subscript  a  m   T    a_{m}^{T}   is 1-by- n known row vector whose values can change with time,    x  m     subscript  x  m    x_{m}   is n -by-1 random column vector to be estimated, and    z  m     subscript  z  m    z_{m}   is scalar noise term with variance    œÉ  m  2     superscript   subscript  œÉ  m   2    \sigma_{m}^{2}   . After ( m +1)-th observation, the direct use of above recursive equations give the expression for the estimate     x  ^    m  +  1      subscript   normal-^  x     m  1     \hat{x}_{m+1}   as:        x  ^    m  +  1    =     x  ^   m   +    k   m  +  1     (    y   m  +  1    -    a   m  +  1   T     x  ^   m     )          subscript   normal-^  x     m  1       subscript   normal-^  x   m      subscript  k    m  1       subscript  y    m  1       subscript   superscript  a  T     m  1     subscript   normal-^  x   m         \hat{x}_{m+1}=\hat{x}_{m}+k_{m+1}(y_{m+1}-a^{T}_{m+1}\hat{x}_{m})     where    y   m  +  1      subscript  y    m  1     y_{m+1}   is the new scalar observation and the gain factor    k   m  +  1      subscript  k    m  1     k_{m+1}   is n -by-1 column vector given by        k   m  +  1    =      (   C  e   )   m    a   m  +  1       œÉ   m  +  1   2   +    a   m  +  1   T     (   C  e   )   m    a   m  +  1        .       subscript  k    m  1         subscript   subscript  C  e   m    subscript  a    m  1        subscript   superscript  œÉ  2     m  1       subscript   superscript  a  T     m  1     subscript   subscript  C  e   m    subscript  a    m  1         k_{m+1}=\frac{(C_{e})_{m}a_{m+1}}{\sigma^{2}_{m+1}+a^{T}_{m+1}(C_{e})_{m}a_{m+%
 1}}.   The     (   C  e   )    m  +  1      subscript   subscript  C  e     m  1     (C_{e})_{m+1}   is n -by- n error covariance matrix given by         (   C  e   )    m  +  1    =    (   I  -    k   m  +  1     a   m  +  1   T     )     (   C  e   )   m     .       subscript   subscript  C  e     m  1        I     subscript  k    m  1     subscript   superscript  a  T     m  1       subscript   subscript  C  e   m      (C_{e})_{m+1}=(I-k_{m+1}a^{T}_{m+1})(C_{e})_{m}.     Here no matrix inversion is required. Also the gain factor    k   m  +  1      subscript  k    m  1     k_{m+1}   depends on our confidence in the new data sample, as measured by the noise variance, versus that in the previous data. The initial values of    x  ^     normal-^  x    \hat{x}   and    C  e     subscript  C  e    C_{e}   are taken to be the mean and covariance of the aprior probability density function of   x   x   x   .  Examples  Example 1  We shall take a linear prediction problem as an example. Let a linear combination of observed scalar random variables     x  1   ,   x  2       subscript  x  1    subscript  x  2     x_{1},x_{2}   and    x  3     subscript  x  3    x_{3}   be used to estimate another future scalar random variable    x  4     subscript  x  4    x_{4}   such that      x  ^   4   =    ‚àë   i  =  1   3     w  i    x  i          subscript   normal-^  x   4     superscript   subscript     i  1    3      subscript  w  i    subscript  x  i       \hat{x}_{4}=\sum_{i=1}^{3}w_{i}x_{i}   . If the random variables    x  =    [   x  1   ,   x  2   ,   x  3   ,   x  4   ]   T       x   superscript    subscript  x  1    subscript  x  2    subscript  x  3    subscript  x  4    T     x=[x_{1},x_{2},x_{3},x_{4}]^{T}   are real Gaussian random variables with zero mean and its covariance matrix given by        cov   (  X  )    =   E   [   x   x  T    ]    =   [     1    2    3    4      2    5    8    9      3    8    6    10      4    9    10    15     ]    ,         cov  X     normal-E   delimited-[]    x   superscript  x  T            delimited-[]    1  2  3  4    2  5  8  9    3  8  6  10    4  9  10  15        \operatorname{cov}(X)=\mathrm{E}[xx^{T}]=\left[\begin{array}[]{cccc}1&2&3&4\\
 2&5&8&9\\
 3&8&6&10\\
 4&9&10&15\end{array}\right],   then our task is to find the coefficients    w  i     subscript  w  i    w_{i}   such that it will yield an optimal linear estimate     x  ^   4     subscript   normal-^  x   4    \hat{x}_{4}   .  In terms of the terminology developed in the previous section, for this problem we have the observation vector    y  =    [   x  1   ,   x  2   ,   x  3   ]   T       y   superscript    subscript  x  1    subscript  x  2    subscript  x  3    T     y=[x_{1},x_{2},x_{3}]^{T}   , the estimator matrix    W  =   [   w  1   ,   w  2   ,   w  3   ]       W    subscript  w  1    subscript  w  2    subscript  w  3      W=[w_{1},w_{2},w_{3}]   as a row vector, and the estimated variable    x  =   x  4       x   subscript  x  4     x=x_{4}   as a scalar quantity. The autocorrelation matrix    C  Y     subscript  C  Y    C_{Y}   is defined as        C  Y   =   [      E   [   x  1   ,   x  1   ]       E   [   x  2   ,   x  1   ]       E   [   x  3   ,   x  1   ]         E   [   x  1   ,   x  2   ]       E   [   x  2   ,   x  2   ]       E   [   x  3   ,   x  2   ]         E   [   x  1   ,   x  3   ]       E   [   x  2   ,   x  3   ]       E   [   x  3   ,   x  3   ]       ]   =   [     1    2    3      2    5    8      3    8    6     ]    .         subscript  C  Y    delimited-[]      E    subscript  x  1    subscript  x  1       E    subscript  x  2    subscript  x  1       E    subscript  x  3    subscript  x  1         E    subscript  x  1    subscript  x  2       E    subscript  x  2    subscript  x  2       E    subscript  x  3    subscript  x  2         E    subscript  x  1    subscript  x  3       E    subscript  x  2    subscript  x  3       E    subscript  x  3    subscript  x  3              delimited-[]    1  2  3    2  5  8    3  8  6        C_{Y}=\left[\begin{array}[]{ccc}E[x_{1},x_{1}]&E[x_{2},x_{1}]&E[x_{3},x_{1}]\\
 E[x_{1},x_{2}]&E[x_{2},x_{2}]&E[x_{3},x_{2}]\\
 E[x_{1},x_{3}]&E[x_{2},x_{3}]&E[x_{3},x_{3}]\end{array}\right]=\left[\begin{%
 array}[]{ccc}1&2&3\\
 2&5&8\\
 3&8&6\end{array}\right].   The cross correlation matrix    C   Y  X      subscript  C    Y  X     C_{YX}   is defined as        C   Y  X    =   [      E   [   x  4   ,   x  1   ]         E   [   x  4   ,   x  2   ]         E   [   x  4   ,   x  3   ]       ]   =   [     4      9      10     ]    .         subscript  C    Y  X     delimited-[]      E    subscript  x  4    subscript  x  1         E    subscript  x  4    subscript  x  2         E    subscript  x  4    subscript  x  3              delimited-[]    4    9    10        C_{YX}=\left[\begin{array}[]{c}E[x_{4},x_{1}]\\
 E[x_{4},x_{2}]\\
 E[x_{4},x_{3}]\end{array}\right]=\left[\begin{array}[]{c}4\\
 9\\
 10\end{array}\right].     We now solve the equation      C  Y    W  T    =   C   Y  X           subscript  C  Y    superscript  W  T     subscript  C    Y  X      C_{Y}W^{T}=C_{YX}   by inverting    C  Y     subscript  C  Y    C_{Y}   and pre-multiplying to get         C  Y   -  1     C   Y  X     =    [     4.85     -  1.71      -  .142        -  1.71     .428    .2857       -  .142     .2857     -  .1429      ]    [     4      9      10     ]    =   [     2.57       -  .142       .5714     ]   =   W  T    .           superscript   subscript  C  Y     1     subscript  C    Y  X        delimited-[]    4.85    1.71     .142       1.71   .428  .2857      .142   .2857    .1429       delimited-[]    4    9    10            delimited-[]    2.57      .142     .5714           superscript  W  T      C_{Y}^{-1}C_{YX}=\left[\begin{array}[]{ccc}4.85&-1.71&-.142\\
 -1.71&.428&.2857\\
 -.142&.2857&-.1429\end{array}\right]\left[\begin{array}[]{c}4\\
 9\\
 10\end{array}\right]=\left[\begin{array}[]{c}2.57\\
 -.142\\
 .5714\end{array}\right]=W^{T}.     So we have      w  1   =  2.57   ,       subscript  w  1   2.57    w_{1}=2.57,         w  2   =   -  .142    ,       subscript  w  2     .142     w_{2}=-.142,   and     w  3   =  .5714       subscript  w  3   .5714    w_{3}=.5714   as the optimal coefficients for     x  ^   4     subscript   normal-^  x   4    \hat{x}_{4}   . Computing the minimum mean square error then gives      ‚à•  e  ‚à•   min  2   =    E   [    x  4    x  4    ]    -   W   C   Y  X      =   15  -   W   C   Y  X      =  .2857         superscript   subscript   norm  e     2       normal-E   delimited-[]     subscript  x  4    subscript  x  4        W   subscript  C    Y  X             15    W   subscript  C    Y  X           .2857     \left\|e\right\|_{\min}^{2}=\mathrm{E}[x_{4}x_{4}]-WC_{YX}=15-WC_{YX}=.2857   . 2 Note that it is not necessary to obtain an explicit matrix inverse of    C  Y     subscript  C  Y    C_{Y}   to compute the value of   W   W   W   . The matrix equation can be solved by well known methods such as Gauss elimination method. A shorter, non-numerical example can be found in orthogonality principle .  Example 2  Consider a vector   y   y   y   formed by taking   N   N   N   observations of a fixed but unknown scalar parameter   x   x   x   disturbed by white Gaussian noise. We can describe the process by a linear equation    y  =    1  x   +  z       y      1  x   z     y=1x+z   , where    1  =    [  1  ,  1  ,  ‚Ä¶  ,  1  ]   T       1   superscript   1  1  normal-‚Ä¶  1   T     1=[1,1,\ldots,1]^{T}   . Depending on context it will be clear if   1   1   1   represents a scalar or a vector. Suppose that we know    [   -   x  0    ,   x  0   ]        subscript  x  0     subscript  x  0     [-x_{0},x_{0}]   to be the range within which the value of   x   x   x   is going to fall in. We can model our uncertainty of   x   x   x   by an aprior uniform distribution over an interval    [   -   x  0    ,   x  0   ]        subscript  x  0     subscript  x  0     [-x_{0},x_{0}]   , and thus   x   x   x   will have variance of     œÉ  X  2   =    x  0  2   /  3.        superscript   subscript  œÉ  X   2      superscript   subscript  x  0   2   3.     \sigma_{X}^{2}=x_{0}^{2}/3.   . Let the noise vector   z   z   z   be normally distributed as    N   (  0  ,    œÉ  Z  2   I   )       N   0     superscript   subscript  œÉ  Z   2   I      N(0,\sigma_{Z}^{2}I)   where   I   I   I   is an identity matrix. Also   x   x   x   and   z   z   z   are independent and     C   X  Z    =  0       subscript  C    X  Z    0    C_{XZ}=0   . It is easy to see that        E   {  y  }    =  0   ,        normal-E   y    0    \displaystyle\mathrm{E}\{y\}=0,     Thus, the linear MMSE estimator is given by      x  ^     normal-^  x    \displaystyle\hat{x}   We can simplify the expression by using the alternative form for   W   W   W   as      x  ^     normal-^  x    \displaystyle\hat{x}     where for    y  =    [   y  1   ,   y  2   ,  ‚Ä¶  ,   y  N   ]   T       y   superscript    subscript  y  1    subscript  y  2   normal-‚Ä¶   subscript  y  N    T     y=[y_{1},y_{2},\ldots,y_{N}]^{T}   we have      y  ¬Ø   =     1  T   y   N   =      ‚àë   i  =  1   N     y  i    N    .         normal-¬Ø  y        superscript  1  T   y   N            superscript   subscript     i  1    N    subscript  y  i    N      \bar{y}=\frac{1^{T}y}{N}=\frac{\sum_{i=1}^{N}y_{i}}{N}.     Similarly, the variance of the estimator is        œÉ   X  ^   2   =    C   X  Y     C  Y   -  1     C   Y  X     =    (    œÉ  X  2     œÉ  X  2   +    œÉ  Z  2   /  N     )    œÉ  X  2     .         superscript   subscript  œÉ   normal-^  X    2      subscript  C    X  Y     superscript   subscript  C  Y     1     subscript  C    Y  X               superscript   subscript  œÉ  X   2      superscript   subscript  œÉ  X   2      superscript   subscript  œÉ  Z   2   N      superscript   subscript  œÉ  X   2       \sigma_{\hat{X}}^{2}=C_{XY}C_{Y}^{-1}C_{YX}=\Big(\frac{\sigma_{X}^{2}}{\sigma_%
 {X}^{2}+\sigma_{Z}^{2}/N}\Big)\sigma_{X}^{2}.     Thus the MMSE of this linear estimator is       LMMSE  =    œÉ  X  2   -   œÉ   X  ^   2    =    (    œÉ  Z  2     œÉ  X  2   +    œÉ  Z  2   /  N     )     œÉ  X  2   N     .        LMMSE     superscript   subscript  œÉ  X   2    superscript   subscript  œÉ   normal-^  X    2              superscript   subscript  œÉ  Z   2      superscript   subscript  œÉ  X   2      superscript   subscript  œÉ  Z   2   N        superscript   subscript  œÉ  X   2   N       \mathrm{LMMSE}=\sigma_{X}^{2}-\sigma_{\hat{X}}^{2}=\Big(\frac{\sigma_{Z}^{2}}{%
 \sigma_{X}^{2}+\sigma_{Z}^{2}/N}\Big)\frac{\sigma_{X}^{2}}{N}.     For very large   N   N   N   , we see that the MMSE estimator of a scalar unknown random variable with uniform aprior distribution can be approximated by the arithmetic average of all the observed data        x  ^   =    1  N     ‚àë   i  =  1   N    y  i      ,       normal-^  x       1  N     superscript   subscript     i  1    N    subscript  y  i       \hat{x}=\frac{1}{N}\sum_{i=1}^{N}y_{i},   while the variance will be unaffected by data      œÉ   X  ^   2   =   œÉ  X  2    ,       superscript   subscript  œÉ   normal-^  X    2    superscript   subscript  œÉ  X   2     \sigma_{\hat{X}}^{2}=\sigma_{X}^{2},   and the LMMSE of the estimate will tend to zero.  However, the estimator is suboptimal since it is constrained to be linear. Had the random variable   x   x   x   also been Gaussian, then the estimator would have been optimal. Notice, that the form of the estimator will remain unchanged, regardless of the apriori distribution of   x   x   x   , so long as the mean and variance of these distributions are the same.  Example 3  Consider a variation of the above example: Two candidates are standing for an election. Let the fraction of votes that a candidate will receive on an election day be     x  ‚àà   [  0  ,  1  ]    .      x   0  1     x\in[0,1].   Thus the fraction of votes the other candidate will receive will be     1  -  x   .      1  x    1-x.   We shall take   x   x   x   as a random variable with a uniform prior distribution over    [  0  ,  1  ]     0  1    [0,1]   so that its mean is     x  ¬Ø   =   1  /  2        normal-¬Ø  x     1  2     \bar{x}=1/2   and variance is     œÉ  X  2   =   1  /  12.        superscript   subscript  œÉ  X   2     1  12.     \sigma_{X}^{2}=1/12.   A few weeks before the election, two independent public opinion polls were conducted by two different pollsters. The first poll revealed that the candidate is likely to get    y  1     subscript  y  1    y_{1}   fraction of votes. Since some error is always present due to finite sampling and the particular polling methodology adopted, the first pollster declares their estimate to have an error    z  1     subscript  z  1    z_{1}   with zero mean and variance     œÉ   Z  1   2   .     superscript   subscript  œÉ   subscript  Z  1    2    \sigma_{Z_{1}}^{2}.   Similarly, the second pollster declares their estimate to be    y  2     subscript  y  2    y_{2}   with an error    z  2     subscript  z  2    z_{2}   with zero mean and variance     œÉ   Z  2   2   .     superscript   subscript  œÉ   subscript  Z  2    2    \sigma_{Z_{2}}^{2}.   Note that except for the mean and variance of the error, the error distribution is unspecified. How should the two polls be combined to obtain the voting prediction for the given candidate?  As with previous example, we have      y  1     subscript  y  1    \displaystyle y_{1}     Here both the     E   {   y  1   }    =   E   {   y  2   }    =   x  ¬Ø   =   1  /  2           normal-E    subscript  y  1       normal-E    subscript  y  2           normal-¬Ø  x          1  2      \mathrm{E}\{y_{1}\}=\mathrm{E}\{y_{2}\}=\bar{x}=1/2   . Thus we can obtain the LMMSE estimate as the linear combination of    y  1     subscript  y  1    y_{1}   and    y  2     subscript  y  2    y_{2}   as        x  ^   =     w  1    (    y  1   -   x  ¬Ø    )    +    w  2    (    y  2   -   x  ¬Ø    )    +   x  ¬Ø     ,       normal-^  x        subscript  w  1      subscript  y  1    normal-¬Ø  x        subscript  w  2      subscript  y  2    normal-¬Ø  x      normal-¬Ø  x      \hat{x}=w_{1}(y_{1}-\bar{x})+w_{2}(y_{2}-\bar{x})+\bar{x},   where the weights are given by      w  1     subscript  w  1    \displaystyle w_{1}   Here since the denominator term is constant, the poll with lower error is given higher weight in order to predict the election outcome. Lastly, the variance of the prediction is given by        œÉ   X  ^   2   =      1  /   œÉ   Z  1   2    +   1  /   œÉ   Z  2   2       1  /   œÉ   Z  1   2    +   1  /   œÉ   Z  2   2    +   1  /   œÉ  X  2       œÉ  X  2     ,       superscript   subscript  œÉ   normal-^  X    2           1   superscript   subscript  œÉ   subscript  Z  1    2      1   superscript   subscript  œÉ   subscript  Z  2    2         1   superscript   subscript  œÉ   subscript  Z  1    2      1   superscript   subscript  œÉ   subscript  Z  2    2      1   superscript   subscript  œÉ  X   2       superscript   subscript  œÉ  X   2      \sigma_{\hat{X}}^{2}=\frac{1/\sigma_{Z_{1}}^{2}+1/\sigma_{Z_{2}}^{2}}{1/\sigma%
 _{Z_{1}}^{2}+1/\sigma_{Z_{2}}^{2}+1/\sigma_{X}^{2}}\sigma_{X}^{2},   which makes    œÉ   X  ^   2     superscript   subscript  œÉ   normal-^  X    2    \sigma_{\hat{X}}^{2}   smaller than     œÉ  X  2   .     superscript   subscript  œÉ  X   2    \sigma_{X}^{2}.     In general, if we have   N   N   N   pollsters, then the weight for i-th pollster is is given by     w  i   =    1  /   œÉ   Z  i   2        ‚àë   i  =  1   N     1  /   œÉ   Z  i   2     +   1  /   œÉ  X  2           subscript  w  i       1   superscript   subscript  œÉ   subscript  Z  i    2        superscript   subscript     i  1    N     1   superscript   subscript  œÉ   subscript  Z  i    2       1   superscript   subscript  œÉ  X   2        w_{i}=\frac{1/\sigma_{Z_{i}}^{2}}{\sum_{i=1}^{N}1/\sigma_{Z_{i}}^{2}+1/\sigma_%
 {X}^{2}}     Example 4  Suppose that a musician is playing an instrument and that the sound is received by two microphones, each of them located at two different places. Let the attenuation of sound due to distance at each microphone be    a  1     subscript  a  1    a_{1}   and    a  2     subscript  a  2    a_{2}   , which are assumed to be known constants. Similarly, let the noise at each microphone be    z  1     subscript  z  1    z_{1}   and    z  2     subscript  z  2    z_{2}   , each with zero mean and variances    œÉ   Z  1   2     superscript   subscript  œÉ   subscript  Z  1    2    \sigma_{Z_{1}}^{2}   and    œÉ   Z  2   2     superscript   subscript  œÉ   subscript  Z  2    2    \sigma_{Z_{2}}^{2}   respectively. Let   x   x   x   denote the sound produced by the musician, which is a random variable with zero mean and variance     œÉ  X  2   .     superscript   subscript  œÉ  X   2    \sigma_{X}^{2}.   How should the recorded music from these two microphones be combined, after being synced with each other?  We can model the sound received by each microphone as      y  1     subscript  y  1    \displaystyle y_{1}     Here both the     E   {   y  1   }    =   E   {   y  2   }    =  0          normal-E    subscript  y  1       normal-E    subscript  y  2          0     \mathrm{E}\{y_{1}\}=\mathrm{E}\{y_{2}\}=0   . Thus, we can combine the two sounds as      y  =     w  1    y  1    +    w  2    y  2         y       subscript  w  1    subscript  y  1       subscript  w  2    subscript  y  2       y=w_{1}y_{1}+w_{2}y_{2}   where the i-th weight is given as        w  i   =     a  i   /   œÉ   Z  i   2       ‚àë  i     a  i  2   /   œÉ   Z  i   2     +   1  /   œÉ  X  2       .       subscript  w  i        subscript  a  i    superscript   subscript  œÉ   subscript  Z  i    2        subscript   i      superscript   subscript  a  i   2    superscript   subscript  œÉ   subscript  Z  i    2       1   superscript   subscript  œÉ  X   2        w_{i}=\frac{a_{i}/\sigma_{Z_{i}}^{2}}{\sum_{i}a_{i}^{2}/\sigma_{Z_{i}}^{2}+1/%
 \sigma_{X}^{2}}.     See also   Bayesian estimator  Mean squared error  Least squares  Minimum-variance unbiased estimator (MVUE)  Orthogonality principle  Wiener filter  Kalman filter  Linear prediction  Zero forcing equalizer   Notes    Further reading             "  Category:Statistical deviation and dispersion  Category:Estimation theory  Category:Signal processing     Lehmann and Casella, Corollary 4.1.2. ‚Ü©  Moon and Stirling. ‚Ü©     
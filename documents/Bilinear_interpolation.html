<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="228">Bilinear interpolation</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Bilinear interpolation</h1>
<hr/>

<p>  In <a class="uri" href="mathematics" title="wikilink">mathematics</a>, <strong>bilinear interpolation</strong> is an extension of <a href="linear_interpolation" title="wikilink">linear interpolation</a> for <a href="interpolation" title="wikilink">interpolating</a> functions of two variables (e.g., <em>x</em> and <em>y</em>) on a <a href="rectilinear_grid" title="wikilink">rectilinear 2D grid</a>.</p>

<p>The key idea is to perform linear interpolation first in one direction, and then again in the other direction. Although each step is linear in the sampled values and in the position, the interpolation as a whole is not linear but rather quadratic in the sample location.</p>
<h2 id="algorithm">Algorithm</h2>

<p>Suppose that we want to find the value of the unknown function <em>f</em> at the point (<em>x</em>, <em>y</em>). It is assumed that we know the value of <em>f</em> at the four points <em>Q</em><sub>11</sub> = (<em>x</em><sub>1</sub>, <em>y</em><sub>1</sub>), <em>Q</em><sub>12</sub> = (<em>x</em><sub>1</sub>, <em>y</em><sub>2</sub>), <em>Q</em><sub>21</sub> = (<em>x</em><sub>2</sub>, <em>y</em><sub>1</sub>), and <em>Q</em><sub>22</sub> = (<em>x</em><sub>2</sub>, <em>y</em><sub>2</sub>).</p>

<p>We first do linear interpolation in the <em>x</em>-direction. This yields</p>

<p>

<math display="inline" id="Bilinear_interpolation:0">
 <semantics>
  <mrow>
   <mi>f</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>x</mi>
    <mo>,</mo>
    <msub>
     <mi>y</mi>
     <mn>1</mn>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>f</ci>
    <interval closure="open">
     <ci>x</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <cn type="integer">1</cn>
     </apply>
    </interval>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle f(x,y_{1})
  </annotation>
 </semantics>
</math>


 We proceed by interpolating in the <em>y</em>-direction to obtain the desired estimate:</p>

<p>

<math display="inline" id="Bilinear_interpolation:1">
 <semantics>
  <mrow>
   <mi>f</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>x</mi>
    <mo>,</mo>
    <mi>y</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>f</ci>
    <interval closure="open">
     <ci>x</ci>
     <ci>y</ci>
    </interval>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle f(x,y)
  </annotation>
 </semantics>
</math>


 Note that we will arrive at the same result if the interpolation is done first along the <em>y</em>-direction and then along the <em>x</em>-direction.</p>
<h3 id="alternative-algorithm">Alternative algorithm</h3>

<p>An alternative way to write the solution to the interpolation problem is</p>

<p>

<math display="block" id="Bilinear_interpolation:2">
 <semantics>
  <mrow>
   <mrow>
    <mi>f</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>x</mi>
     <mo>,</mo>
     <mi>y</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>≈</mo>
   <mrow>
    <msub>
     <mi>a</mi>
     <mn>0</mn>
    </msub>
    <mo>+</mo>
    <mrow>
     <msub>
      <mi>a</mi>
      <mn>1</mn>
     </msub>
     <mi>x</mi>
    </mrow>
    <mo>+</mo>
    <mrow>
     <msub>
      <mi>a</mi>
      <mn>2</mn>
     </msub>
     <mi>y</mi>
    </mrow>
    <mo>+</mo>
    <mrow>
     <msub>
      <mi>a</mi>
      <mn>3</mn>
     </msub>
     <mi>x</mi>
     <mi>y</mi>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <approx></approx>
    <apply>
     <times></times>
     <ci>f</ci>
     <interval closure="open">
      <ci>x</ci>
      <ci>y</ci>
     </interval>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>a</ci>
      <cn type="integer">0</cn>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>a</ci>
       <cn type="integer">1</cn>
      </apply>
      <ci>x</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>a</ci>
       <cn type="integer">2</cn>
      </apply>
      <ci>y</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>a</ci>
       <cn type="integer">3</cn>
      </apply>
      <ci>x</ci>
      <ci>y</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f(x,y)\approx a_{0}+a_{1}x+a_{2}y+a_{3}xy
  </annotation>
 </semantics>
</math>

 Where the coefficients are found by solving the linear system</p>

<p>

<math display="inline" id="Bilinear_interpolation:3">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mo>[</mo>
     <mtable>
      <mtr>
       <mtd columnalign="center">
        <mn>1</mn>
       </mtd>
       <mtd columnalign="center">
        <msub>
         <mi>x</mi>
         <mn>1</mn>
        </msub>
       </mtd>
       <mtd columnalign="center">
        <msub>
         <mi>y</mi>
         <mn>1</mn>
        </msub>
       </mtd>
       <mtd columnalign="center">
        <mrow>
         <msub>
          <mi>x</mi>
          <mn>1</mn>
         </msub>
         <msub>
          <mi>y</mi>
          <mn>1</mn>
         </msub>
        </mrow>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mn>1</mn>
       </mtd>
       <mtd columnalign="center">
        <msub>
         <mi>x</mi>
         <mn>1</mn>
        </msub>
       </mtd>
       <mtd columnalign="center">
        <msub>
         <mi>y</mi>
         <mn>2</mn>
        </msub>
       </mtd>
       <mtd columnalign="center">
        <mrow>
         <msub>
          <mi>x</mi>
          <mn>1</mn>
         </msub>
         <msub>
          <mi>y</mi>
          <mn>2</mn>
         </msub>
        </mrow>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mn>1</mn>
       </mtd>
       <mtd columnalign="center">
        <msub>
         <mi>x</mi>
         <mn>2</mn>
        </msub>
       </mtd>
       <mtd columnalign="center">
        <msub>
         <mi>y</mi>
         <mn>1</mn>
        </msub>
       </mtd>
       <mtd columnalign="center">
        <mrow>
         <msub>
          <mi>x</mi>
          <mn>2</mn>
         </msub>
         <msub>
          <mi>y</mi>
          <mn>1</mn>
         </msub>
        </mrow>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mn>1</mn>
       </mtd>
       <mtd columnalign="center">
        <msub>
         <mi>x</mi>
         <mn>2</mn>
        </msub>
       </mtd>
       <mtd columnalign="center">
        <msub>
         <mi>y</mi>
         <mn>2</mn>
        </msub>
       </mtd>
       <mtd columnalign="center">
        <mrow>
         <msub>
          <mi>x</mi>
          <mn>2</mn>
         </msub>
         <msub>
          <mi>y</mi>
          <mn>2</mn>
         </msub>
        </mrow>
       </mtd>
      </mtr>
     </mtable>
     <mo>]</mo>
    </mrow>
    <mrow>
     <mo>[</mo>
     <mtable>
      <mtr>
       <mtd columnalign="center">
        <msub>
         <mi>a</mi>
         <mn>0</mn>
        </msub>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <msub>
         <mi>a</mi>
         <mn>1</mn>
        </msub>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <msub>
         <mi>a</mi>
         <mn>2</mn>
        </msub>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <msub>
         <mi>a</mi>
         <mn>3</mn>
        </msub>
       </mtd>
      </mtr>
     </mtable>
     <mo>]</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mo>[</mo>
    <mtable>
     <mtr>
      <mtd columnalign="center">
       <mrow>
        <mi>f</mi>
        <mrow>
         <mo stretchy="false">(</mo>
         <msub>
          <mi>Q</mi>
          <mn>11</mn>
         </msub>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
      </mtd>
     </mtr>
     <mtr>
      <mtd columnalign="center">
       <mrow>
        <mi>f</mi>
        <mrow>
         <mo stretchy="false">(</mo>
         <msub>
          <mi>Q</mi>
          <mn>12</mn>
         </msub>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
      </mtd>
     </mtr>
     <mtr>
      <mtd columnalign="center">
       <mrow>
        <mi>f</mi>
        <mrow>
         <mo stretchy="false">(</mo>
         <msub>
          <mi>Q</mi>
          <mn>21</mn>
         </msub>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
      </mtd>
     </mtr>
     <mtr>
      <mtd columnalign="center">
       <mrow>
        <mi>f</mi>
        <mrow>
         <mo stretchy="false">(</mo>
         <msub>
          <mi>Q</mi>
          <mn>22</mn>
         </msub>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
      </mtd>
     </mtr>
    </mtable>
    <mo>]</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <matrix>
      <matrixrow>
       <cn type="integer">1</cn>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <cn type="integer">1</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>y</ci>
        <cn type="integer">1</cn>
       </apply>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>x</ci>
         <cn type="integer">1</cn>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>y</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
      </matrixrow>
      <matrixrow>
       <cn type="integer">1</cn>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <cn type="integer">1</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>y</ci>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>x</ci>
         <cn type="integer">1</cn>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>y</ci>
         <cn type="integer">2</cn>
        </apply>
       </apply>
      </matrixrow>
      <matrixrow>
       <cn type="integer">1</cn>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>y</ci>
        <cn type="integer">1</cn>
       </apply>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>x</ci>
         <cn type="integer">2</cn>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>y</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
      </matrixrow>
      <matrixrow>
       <cn type="integer">1</cn>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>y</ci>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>x</ci>
         <cn type="integer">2</cn>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>y</ci>
         <cn type="integer">2</cn>
        </apply>
       </apply>
      </matrixrow>
     </matrix>
     <matrix>
      <matrixrow>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>a</ci>
        <cn type="integer">0</cn>
       </apply>
      </matrixrow>
      <matrixrow>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>a</ci>
        <cn type="integer">1</cn>
       </apply>
      </matrixrow>
      <matrixrow>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>a</ci>
        <cn type="integer">2</cn>
       </apply>
      </matrixrow>
      <matrixrow>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>a</ci>
        <cn type="integer">3</cn>
       </apply>
      </matrixrow>
     </matrix>
    </apply>
    <matrix>
     <matrixrow>
      <apply>
       <times></times>
       <ci>f</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>Q</ci>
        <cn type="integer">11</cn>
       </apply>
      </apply>
     </matrixrow>
     <matrixrow>
      <apply>
       <times></times>
       <ci>f</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>Q</ci>
        <cn type="integer">12</cn>
       </apply>
      </apply>
     </matrixrow>
     <matrixrow>
      <apply>
       <times></times>
       <ci>f</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>Q</ci>
        <cn type="integer">21</cn>
       </apply>
      </apply>
     </matrixrow>
     <matrixrow>
      <apply>
       <times></times>
       <ci>f</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>Q</ci>
        <cn type="integer">22</cn>
       </apply>
      </apply>
     </matrixrow>
    </matrix>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle\begin{bmatrix}1&x_{1}&y_{1}&x_{1}y_{1}\\
1&x_{1}&y_{2}&x_{1}y_{2}\\
1&x_{2}&y_{1}&x_{2}y_{1}\\
1&x_{2}&y_{2}&x_{2}y_{2}\end{bmatrix}\begin{bmatrix}a_{0}\\
a_{1}\\
a_{2}\\
a_{3}\end{bmatrix}=\begin{bmatrix}f(Q_{11})\\
f(Q_{12})\\
f(Q_{21})\\
f(Q_{22})\end{bmatrix}
  </annotation>
 </semantics>
</math>


 If a solution is preferred in terms of <em>f(Q)</em> then we can write</p>

<p>

<math display="block" id="Bilinear_interpolation:4">
 <semantics>
  <mrow>
   <mrow>
    <mi>f</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>x</mi>
     <mo>,</mo>
     <mi>y</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>≈</mo>
   <mrow>
    <mrow>
     <msub>
      <mi>b</mi>
      <mn>11</mn>
     </msub>
     <mi>f</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <msub>
       <mi>Q</mi>
       <mn>11</mn>
      </msub>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>+</mo>
    <mrow>
     <msub>
      <mi>b</mi>
      <mn>12</mn>
     </msub>
     <mi>f</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <msub>
       <mi>Q</mi>
       <mn>12</mn>
      </msub>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>+</mo>
    <mrow>
     <msub>
      <mi>b</mi>
      <mn>21</mn>
     </msub>
     <mi>f</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <msub>
       <mi>Q</mi>
       <mn>21</mn>
      </msub>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>+</mo>
    <mrow>
     <msub>
      <mi>b</mi>
      <mn>22</mn>
     </msub>
     <mi>f</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <msub>
       <mi>Q</mi>
       <mn>22</mn>
      </msub>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <approx></approx>
    <apply>
     <times></times>
     <ci>f</ci>
     <interval closure="open">
      <ci>x</ci>
      <ci>y</ci>
     </interval>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>b</ci>
       <cn type="integer">11</cn>
      </apply>
      <ci>f</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>Q</ci>
       <cn type="integer">11</cn>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>b</ci>
       <cn type="integer">12</cn>
      </apply>
      <ci>f</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>Q</ci>
       <cn type="integer">12</cn>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>b</ci>
       <cn type="integer">21</cn>
      </apply>
      <ci>f</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>Q</ci>
       <cn type="integer">21</cn>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>b</ci>
       <cn type="integer">22</cn>
      </apply>
      <ci>f</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>Q</ci>
       <cn type="integer">22</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f(x,y)\approx b_{11}f(Q_{11})+b_{12}f(Q_{12})+b_{21}f(Q_{21})+b_{22}f(Q_{22})
  </annotation>
 </semantics>
</math>

 Where the coefficients are found by solving</p>

<p>

<math display="block" id="Bilinear_interpolation:5">
 <semantics>
  <mrow>
   <mrow>
    <mo>[</mo>
    <mtable displaystyle="true">
     <mtr>
      <mtd columnalign="center">
       <msub>
        <mi>b</mi>
        <mn>11</mn>
       </msub>
      </mtd>
     </mtr>
     <mtr>
      <mtd columnalign="center">
       <msub>
        <mi>b</mi>
        <mn>12</mn>
       </msub>
      </mtd>
     </mtr>
     <mtr>
      <mtd columnalign="center">
       <msub>
        <mi>b</mi>
        <mn>21</mn>
       </msub>
      </mtd>
     </mtr>
     <mtr>
      <mtd columnalign="center">
       <msub>
        <mi>b</mi>
        <mn>22</mn>
       </msub>
      </mtd>
     </mtr>
    </mtable>
    <mo>]</mo>
   </mrow>
   <mo>=</mo>
   <mrow>
    <msup>
     <mrow>
      <mo>(</mo>
      <msup>
       <mrow>
        <mo>[</mo>
        <mtable displaystyle="true">
         <mtr>
          <mtd columnalign="center">
           <mn>1</mn>
          </mtd>
          <mtd columnalign="center">
           <msub>
            <mi>x</mi>
            <mn>1</mn>
           </msub>
          </mtd>
          <mtd columnalign="center">
           <msub>
            <mi>y</mi>
            <mn>1</mn>
           </msub>
          </mtd>
          <mtd columnalign="center">
           <mrow>
            <msub>
             <mi>x</mi>
             <mn>1</mn>
            </msub>
            <msub>
             <mi>y</mi>
             <mn>1</mn>
            </msub>
           </mrow>
          </mtd>
         </mtr>
         <mtr>
          <mtd columnalign="center">
           <mn>1</mn>
          </mtd>
          <mtd columnalign="center">
           <msub>
            <mi>x</mi>
            <mn>1</mn>
           </msub>
          </mtd>
          <mtd columnalign="center">
           <msub>
            <mi>y</mi>
            <mn>2</mn>
           </msub>
          </mtd>
          <mtd columnalign="center">
           <mrow>
            <msub>
             <mi>x</mi>
             <mn>1</mn>
            </msub>
            <msub>
             <mi>y</mi>
             <mn>2</mn>
            </msub>
           </mrow>
          </mtd>
         </mtr>
         <mtr>
          <mtd columnalign="center">
           <mn>1</mn>
          </mtd>
          <mtd columnalign="center">
           <msub>
            <mi>x</mi>
            <mn>2</mn>
           </msub>
          </mtd>
          <mtd columnalign="center">
           <msub>
            <mi>y</mi>
            <mn>1</mn>
           </msub>
          </mtd>
          <mtd columnalign="center">
           <mrow>
            <msub>
             <mi>x</mi>
             <mn>2</mn>
            </msub>
            <msub>
             <mi>y</mi>
             <mn>1</mn>
            </msub>
           </mrow>
          </mtd>
         </mtr>
         <mtr>
          <mtd columnalign="center">
           <mn>1</mn>
          </mtd>
          <mtd columnalign="center">
           <msub>
            <mi>x</mi>
            <mn>2</mn>
           </msub>
          </mtd>
          <mtd columnalign="center">
           <msub>
            <mi>y</mi>
            <mn>2</mn>
           </msub>
          </mtd>
          <mtd columnalign="center">
           <mrow>
            <msub>
             <mi>x</mi>
             <mn>2</mn>
            </msub>
            <msub>
             <mi>y</mi>
             <mn>2</mn>
            </msub>
           </mrow>
          </mtd>
         </mtr>
        </mtable>
        <mo>]</mo>
       </mrow>
       <mrow>
        <mo>-</mo>
        <mn>1</mn>
       </mrow>
      </msup>
      <mo>)</mo>
     </mrow>
     <mi>T</mi>
    </msup>
    <mrow>
     <mo>[</mo>
     <mtable displaystyle="true">
      <mtr>
       <mtd columnalign="center">
        <mn>1</mn>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mi>x</mi>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mi>y</mi>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mrow>
         <mi>x</mi>
         <mi>y</mi>
        </mrow>
       </mtd>
      </mtr>
     </mtable>
     <mo>]</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <matrix>
     <matrixrow>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>b</ci>
       <cn type="integer">11</cn>
      </apply>
     </matrixrow>
     <matrixrow>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>b</ci>
       <cn type="integer">12</cn>
      </apply>
     </matrixrow>
     <matrixrow>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>b</ci>
       <cn type="integer">21</cn>
      </apply>
     </matrixrow>
     <matrixrow>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>b</ci>
       <cn type="integer">22</cn>
      </apply>
     </matrixrow>
    </matrix>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <matrix>
        <matrixrow>
         <cn type="integer">1</cn>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>x</ci>
          <cn type="integer">1</cn>
         </apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>y</ci>
          <cn type="integer">1</cn>
         </apply>
         <apply>
          <times></times>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>x</ci>
           <cn type="integer">1</cn>
          </apply>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>y</ci>
           <cn type="integer">1</cn>
          </apply>
         </apply>
        </matrixrow>
        <matrixrow>
         <cn type="integer">1</cn>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>x</ci>
          <cn type="integer">1</cn>
         </apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>y</ci>
          <cn type="integer">2</cn>
         </apply>
         <apply>
          <times></times>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>x</ci>
           <cn type="integer">1</cn>
          </apply>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>y</ci>
           <cn type="integer">2</cn>
          </apply>
         </apply>
        </matrixrow>
        <matrixrow>
         <cn type="integer">1</cn>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>x</ci>
          <cn type="integer">2</cn>
         </apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>y</ci>
          <cn type="integer">1</cn>
         </apply>
         <apply>
          <times></times>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>x</ci>
           <cn type="integer">2</cn>
          </apply>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>y</ci>
           <cn type="integer">1</cn>
          </apply>
         </apply>
        </matrixrow>
        <matrixrow>
         <cn type="integer">1</cn>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>x</ci>
          <cn type="integer">2</cn>
         </apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>y</ci>
          <cn type="integer">2</cn>
         </apply>
         <apply>
          <times></times>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>x</ci>
           <cn type="integer">2</cn>
          </apply>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>y</ci>
           <cn type="integer">2</cn>
          </apply>
         </apply>
        </matrixrow>
       </matrix>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <ci>T</ci>
     </apply>
     <matrix>
      <matrixrow>
       <cn type="integer">1</cn>
      </matrixrow>
      <matrixrow>
       <ci>x</ci>
      </matrixrow>
      <matrixrow>
       <ci>y</ci>
      </matrixrow>
      <matrixrow>
       <apply>
        <times></times>
        <ci>x</ci>
        <ci>y</ci>
       </apply>
      </matrixrow>
     </matrix>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \begin{bmatrix}b_{11}\\
b_{12}\\
b_{21}\\
b_{22}\end{bmatrix}=\left(\begin{bmatrix}1&x_{1}&y_{1}&x_{1}y_{1}\\
1&x_{1}&y_{2}&x_{1}y_{2}\\
1&x_{2}&y_{1}&x_{2}y_{1}\\
1&x_{2}&y_{2}&x_{2}y_{2}\end{bmatrix}^{-1}\right)^{T}\begin{bmatrix}1\\
x\\
y\\
xy\end{bmatrix}
  </annotation>
 </semantics>
</math>

</p>
<h3 id="unit-square">Unit Square</h3>

<p>If we choose a coordinate system in which the four points where <em>f</em> is known are 

<math display="inline" id="Bilinear_interpolation:6">
 <semantics>
  <mrow>
   <mrow>
    <mo stretchy="false">(</mo>
    <mn>0</mn>
    <mo>,</mo>
    <mn>0</mn>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>,</mo>
   <mrow>
    <mo stretchy="false">(</mo>
    <mn>0</mn>
    <mo>,</mo>
    <mn>1</mn>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>,</mo>
   <mrow>
    <mo stretchy="false">(</mo>
    <mn>1</mn>
    <mo>,</mo>
    <mn>0</mn>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <list>
    <interval closure="open">
     <cn type="integer">0</cn>
     <cn type="integer">0</cn>
    </interval>
    <interval closure="open">
     <cn type="integer">0</cn>
     <cn type="integer">1</cn>
    </interval>
    <interval closure="open">
     <cn type="integer">1</cn>
     <cn type="integer">0</cn>
    </interval>
   </list>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (0,0),(0,1),(1,0)
  </annotation>
 </semantics>
</math>

, and (1, 1), then the interpolation formula simplifies to</p>

<p>

<math display="block" id="Bilinear_interpolation:7">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>f</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>x</mi>
      <mo>,</mo>
      <mi>y</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>≈</mo>
    <mrow>
     <mrow>
      <mi>f</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mn>0</mn>
       <mo>,</mo>
       <mn>0</mn>
       <mo stretchy="false">)</mo>
      </mrow>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mn>1</mn>
        <mo>-</mo>
        <mi>x</mi>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mn>1</mn>
        <mo>-</mo>
        <mi>y</mi>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo>+</mo>
     <mrow>
      <mi>f</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mn>1</mn>
       <mo>,</mo>
       <mn>0</mn>
       <mo stretchy="false">)</mo>
      </mrow>
      <mi>x</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mn>1</mn>
        <mo>-</mo>
        <mi>y</mi>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo>+</mo>
     <mrow>
      <mi>f</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mn>0</mn>
       <mo>,</mo>
       <mn>1</mn>
       <mo stretchy="false">)</mo>
      </mrow>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mn>1</mn>
        <mo>-</mo>
        <mi>x</mi>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
      <mi>y</mi>
     </mrow>
     <mo>+</mo>
     <mrow>
      <mi>f</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mn>1</mn>
       <mo>,</mo>
       <mn>1</mn>
       <mo stretchy="false">)</mo>
      </mrow>
      <mi>x</mi>
      <mi>y</mi>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <approx></approx>
    <apply>
     <times></times>
     <ci>f</ci>
     <interval closure="open">
      <ci>x</ci>
      <ci>y</ci>
     </interval>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <ci>f</ci>
      <interval closure="open">
       <cn type="integer">0</cn>
       <cn type="integer">0</cn>
      </interval>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
       <ci>x</ci>
      </apply>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
       <ci>y</ci>
      </apply>
     </apply>
     <apply>
      <times></times>
      <ci>f</ci>
      <interval closure="open">
       <cn type="integer">1</cn>
       <cn type="integer">0</cn>
      </interval>
      <ci>x</ci>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
       <ci>y</ci>
      </apply>
     </apply>
     <apply>
      <times></times>
      <ci>f</ci>
      <interval closure="open">
       <cn type="integer">0</cn>
       <cn type="integer">1</cn>
      </interval>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
       <ci>x</ci>
      </apply>
      <ci>y</ci>
     </apply>
     <apply>
      <times></times>
      <ci>f</ci>
      <interval closure="open">
       <cn type="integer">1</cn>
       <cn type="integer">1</cn>
      </interval>
      <ci>x</ci>
      <ci>y</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f(x,y)\approx f(0,0)(1-x)(1-y)+f(1,0)x(1-y)+f(0,1)(1-x)y+f(1,1)xy.
  </annotation>
 </semantics>
</math>

 Or equivalently, in matrix operations:</p>

<p>

<math display="block" id="Bilinear_interpolation:8">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>f</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>x</mi>
      <mo>,</mo>
      <mi>y</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>≈</mo>
    <mrow>
     <mrow>
      <mo>[</mo>
      <mtable displaystyle="true">
       <mtr>
        <mtd columnalign="center">
         <mrow>
          <mn>1</mn>
          <mo>-</mo>
          <mi>x</mi>
         </mrow>
        </mtd>
        <mtd columnalign="center">
         <mi>x</mi>
        </mtd>
       </mtr>
      </mtable>
      <mo>]</mo>
     </mrow>
     <mrow>
      <mo>[</mo>
      <mtable displaystyle="true">
       <mtr>
        <mtd columnalign="center">
         <mrow>
          <mi>f</mi>
          <mrow>
           <mo stretchy="false">(</mo>
           <mn>0</mn>
           <mo>,</mo>
           <mn>0</mn>
           <mo stretchy="false">)</mo>
          </mrow>
         </mrow>
        </mtd>
        <mtd columnalign="center">
         <mrow>
          <mi>f</mi>
          <mrow>
           <mo stretchy="false">(</mo>
           <mn>0</mn>
           <mo>,</mo>
           <mn>1</mn>
           <mo stretchy="false">)</mo>
          </mrow>
         </mrow>
        </mtd>
       </mtr>
       <mtr>
        <mtd columnalign="center">
         <mrow>
          <mi>f</mi>
          <mrow>
           <mo stretchy="false">(</mo>
           <mn>1</mn>
           <mo>,</mo>
           <mn>0</mn>
           <mo stretchy="false">)</mo>
          </mrow>
         </mrow>
        </mtd>
        <mtd columnalign="center">
         <mrow>
          <mi>f</mi>
          <mrow>
           <mo stretchy="false">(</mo>
           <mn>1</mn>
           <mo>,</mo>
           <mn>1</mn>
           <mo stretchy="false">)</mo>
          </mrow>
         </mrow>
        </mtd>
       </mtr>
      </mtable>
      <mo>]</mo>
     </mrow>
     <mrow>
      <mo>[</mo>
      <mtable displaystyle="true">
       <mtr>
        <mtd columnalign="center">
         <mrow>
          <mn>1</mn>
          <mo>-</mo>
          <mi>y</mi>
         </mrow>
        </mtd>
       </mtr>
       <mtr>
        <mtd columnalign="center">
         <mi>y</mi>
        </mtd>
       </mtr>
      </mtable>
      <mo>]</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <approx></approx>
    <apply>
     <times></times>
     <ci>f</ci>
     <interval closure="open">
      <ci>x</ci>
      <ci>y</ci>
     </interval>
    </apply>
    <apply>
     <times></times>
     <matrix>
      <matrixrow>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
        <ci>x</ci>
       </apply>
       <ci>x</ci>
      </matrixrow>
     </matrix>
     <matrix>
      <matrixrow>
       <apply>
        <times></times>
        <ci>f</ci>
        <interval closure="open">
         <cn type="integer">0</cn>
         <cn type="integer">0</cn>
        </interval>
       </apply>
       <apply>
        <times></times>
        <ci>f</ci>
        <interval closure="open">
         <cn type="integer">0</cn>
         <cn type="integer">1</cn>
        </interval>
       </apply>
      </matrixrow>
      <matrixrow>
       <apply>
        <times></times>
        <ci>f</ci>
        <interval closure="open">
         <cn type="integer">1</cn>
         <cn type="integer">0</cn>
        </interval>
       </apply>
       <apply>
        <times></times>
        <ci>f</ci>
        <interval closure="open">
         <cn type="integer">1</cn>
         <cn type="integer">1</cn>
        </interval>
       </apply>
      </matrixrow>
     </matrix>
     <matrix>
      <matrixrow>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
        <ci>y</ci>
       </apply>
      </matrixrow>
      <matrixrow>
       <ci>y</ci>
      </matrixrow>
     </matrix>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f(x,y)\approx\begin{bmatrix}1-x&x\end{bmatrix}\begin{bmatrix}f(0,0)&f(0,1)\\
f(1,0)&f(1,1)\end{bmatrix}\begin{bmatrix}1-y\\
y\end{bmatrix}.
  </annotation>
 </semantics>
</math>

</p>
<h3 id="nonlinear">Nonlinear</h3>

<p>Contrary to what the name suggests, the bilinear interpolant is <em>not</em> linear; but it is the product of two <a href="linear_functions" title="wikilink">linear functions</a>.</p>

<p>Alternatively, the interpolant can be written as</p>

<p>

<math display="block" id="Bilinear_interpolation:9">
 <semantics>
  <mrow>
   <mrow>
    <mi>f</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>x</mi>
     <mo>,</mo>
     <mi>y</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <munderover>
     <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
     <mrow>
      <mi>i</mi>
      <mo>=</mo>
      <mn>0</mn>
     </mrow>
     <mn>1</mn>
    </munderover>
    <mrow>
     <munderover>
      <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
      <mrow>
       <mi>j</mi>
       <mo>=</mo>
       <mn>0</mn>
      </mrow>
      <mn>1</mn>
     </munderover>
     <mrow>
      <msub>
       <mi>a</mi>
       <mrow>
        <mi>i</mi>
        <mi>j</mi>
       </mrow>
      </msub>
      <msup>
       <mi>x</mi>
       <mi>i</mi>
      </msup>
      <msup>
       <mi>y</mi>
       <mi>j</mi>
      </msup>
     </mrow>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <msub>
     <mi>a</mi>
     <mn>00</mn>
    </msub>
    <mo>+</mo>
    <mrow>
     <msub>
      <mi>a</mi>
      <mn>10</mn>
     </msub>
     <mi>x</mi>
    </mrow>
    <mo>+</mo>
    <mrow>
     <msub>
      <mi>a</mi>
      <mn>01</mn>
     </msub>
     <mi>y</mi>
    </mrow>
    <mo>+</mo>
    <mrow>
     <msub>
      <mi>a</mi>
      <mn>11</mn>
     </msub>
     <mi>x</mi>
     <mi>y</mi>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <times></times>
      <ci>f</ci>
      <interval closure="open">
       <ci>x</ci>
       <ci>y</ci>
      </interval>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <apply>
         <eq></eq>
         <ci>i</ci>
         <cn type="integer">0</cn>
        </apply>
       </apply>
       <cn type="integer">1</cn>
      </apply>
      <apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <sum></sum>
         <apply>
          <eq></eq>
          <ci>j</ci>
          <cn type="integer">0</cn>
         </apply>
        </apply>
        <cn type="integer">1</cn>
       </apply>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>a</ci>
         <apply>
          <times></times>
          <ci>i</ci>
          <ci>j</ci>
         </apply>
        </apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>x</ci>
         <ci>i</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>y</ci>
         <ci>j</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <plus></plus>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>a</ci>
       <cn type="integer">00</cn>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>a</ci>
        <cn type="integer">10</cn>
       </apply>
       <ci>x</ci>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>a</ci>
        <cn type="integer">01</cn>
       </apply>
       <ci>y</ci>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>a</ci>
        <cn type="integer">11</cn>
       </apply>
       <ci>x</ci>
       <ci>y</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f(x,y)=\sum_{i=0}^{1}\sum_{j=0}^{1}a_{ij}x^{i}y^{j}=a_{00}+a_{10}x+a_{01}y+a_{%
11}xy
  </annotation>
 </semantics>
</math>

 where</p>

<p>

<math display="block" id="Bilinear_interpolation:10">
 <semantics>
  <mrow>
   <msub>
    <mi>a</mi>
    <mn>00</mn>
   </msub>
   <mo>=</mo>
   <mrow>
    <mi>f</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mn>0</mn>
     <mo>,</mo>
     <mn>0</mn>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>a</ci>
     <cn type="integer">00</cn>
    </apply>
    <apply>
     <times></times>
     <ci>f</ci>
     <interval closure="open">
      <cn type="integer">0</cn>
      <cn type="integer">0</cn>
     </interval>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a_{00}=f(0,0)
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Bilinear_interpolation:11">
 <semantics>
  <mrow>
   <msub>
    <mi>a</mi>
    <mn>10</mn>
   </msub>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mi>f</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mn>1</mn>
      <mo>,</mo>
      <mn>0</mn>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>-</mo>
    <mrow>
     <mi>f</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mn>0</mn>
      <mo>,</mo>
      <mn>0</mn>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>a</ci>
     <cn type="integer">10</cn>
    </apply>
    <apply>
     <minus></minus>
     <apply>
      <times></times>
      <ci>f</ci>
      <interval closure="open">
       <cn type="integer">1</cn>
       <cn type="integer">0</cn>
      </interval>
     </apply>
     <apply>
      <times></times>
      <ci>f</ci>
      <interval closure="open">
       <cn type="integer">0</cn>
       <cn type="integer">0</cn>
      </interval>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a_{10}=f(1,0)-f(0,0)
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Bilinear_interpolation:12">
 <semantics>
  <mrow>
   <msub>
    <mi>a</mi>
    <mn>01</mn>
   </msub>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mi>f</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mn>0</mn>
      <mo>,</mo>
      <mn>1</mn>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>-</mo>
    <mrow>
     <mi>f</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mn>0</mn>
      <mo>,</mo>
      <mn>0</mn>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>a</ci>
     <cn type="integer">01</cn>
    </apply>
    <apply>
     <minus></minus>
     <apply>
      <times></times>
      <ci>f</ci>
      <interval closure="open">
       <cn type="integer">0</cn>
       <cn type="integer">1</cn>
      </interval>
     </apply>
     <apply>
      <times></times>
      <ci>f</ci>
      <interval closure="open">
       <cn type="integer">0</cn>
       <cn type="integer">0</cn>
      </interval>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a_{01}=f(0,1)-f(0,0)
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Bilinear_interpolation:13">
 <semantics>
  <mrow>
   <msub>
    <mi>a</mi>
    <mn>11</mn>
   </msub>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mrow>
      <mi>f</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mn>1</mn>
       <mo>,</mo>
       <mn>1</mn>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo>+</mo>
     <mrow>
      <mi>f</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mn>0</mn>
       <mo>,</mo>
       <mn>0</mn>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mrow>
    <mo>-</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mrow>
       <mi>f</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mn>1</mn>
        <mo>,</mo>
        <mn>0</mn>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
      <mo>+</mo>
      <mrow>
       <mi>f</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mn>0</mn>
        <mo>,</mo>
        <mn>1</mn>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>a</ci>
     <cn type="integer">11</cn>
    </apply>
    <apply>
     <minus></minus>
     <apply>
      <plus></plus>
      <apply>
       <times></times>
       <ci>f</ci>
       <interval closure="open">
        <cn type="integer">1</cn>
        <cn type="integer">1</cn>
       </interval>
      </apply>
      <apply>
       <times></times>
       <ci>f</ci>
       <interval closure="open">
        <cn type="integer">0</cn>
        <cn type="integer">0</cn>
       </interval>
      </apply>
     </apply>
     <apply>
      <plus></plus>
      <apply>
       <times></times>
       <ci>f</ci>
       <interval closure="open">
        <cn type="integer">1</cn>
        <cn type="integer">0</cn>
       </interval>
      </apply>
      <apply>
       <times></times>
       <ci>f</ci>
       <interval closure="open">
        <cn type="integer">0</cn>
        <cn type="integer">1</cn>
       </interval>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a_{11}=f(1,1)+f(0,0)-(f(1,0)+f(0,1))
  </annotation>
 </semantics>
</math>

</p>
<figure><b>(Figure)</b>
<figcaption>In this geometric visualisation, the value at the black spot is the sum of the value at each coloured spot multiplied by the area of the rectangle of the same colour, divided by the total area of all four rectangles.</figcaption>
</figure>

<p>In both cases, the number of constants (four) correspond to the number of data points where <em>f</em> is given. The interpolant is linear along lines <a href="Parallel_(geometry)" title="wikilink">parallel</a> to either the <em>x</em> or the <em>y</em> direction, equivalently if <em>x</em> or <em>y</em> is set constant. Along any other straight line, the interpolant is <a href="Quadratic_function" title="wikilink">quadratic</a>. However, even if the interpolation is <em>not</em> linear in the position (<em>x</em> and <em>y</em>), it <em>is</em> linear in the amplitude, as it is apparent from the equations above: all the coefficient <em>bj, j=1..4</em>, are proportional to the value of the function <em>f(,)</em>.</p>

<p>The result of bilinear interpolation is independent of which axis is interpolated first and which second. If we had first performed the linear interpolation in the <em>y</em>-direction and then in the <em>x</em>-direction, the resulting approximation would be the same.</p>

<p>The obvious extension of bilinear interpolation to three dimensions is called <a href="trilinear_interpolation" title="wikilink">trilinear interpolation</a>.</p>
<h2 id="application-in-image-processing">Application in image processing</h2>

<p>In <a href="computer_vision" title="wikilink">computer vision</a> and <a href="image_processing" title="wikilink">image processing</a>, bilinear interpolation is one of the basic <a href="resampling_(bitmap)" title="wikilink">resampling</a> techniques.</p>

<p>In <a href="texture_mapping" title="wikilink">texture mapping</a>, it is also known as <a href="bilinear_filtering" title="wikilink">bilinear filtering</a> or <em>bilinear texture mapping</em>, and it can be used to produce a reasonably realistic image. An algorithm is used to map a screen pixel location to a corresponding point on the texture map. A weighted average of the attributes (color, alpha, etc.) of the four surrounding texels is computed and applied to the screen pixel. This process is repeated for each pixel forming the object being textured.<a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a></p>

<p>When an image needs to be scaled up, each pixel of the original image needs to be moved in a certain direction based on the scale constant. However, when scaling up an image by a non-integral scale factor, there are pixels (i.e., <em>holes</em>) that are not assigned appropriate pixel values. In this case, those <em>holes</em> should be assigned appropriate <a class="uri" href="RGB" title="wikilink">RGB</a> or <a class="uri" href="grayscale" title="wikilink">grayscale</a> values so that the output image does not have non-valued pixels.</p>

<p>Bilinear interpolation can be used where perfect image transformation with pixel matching is impossible, so that one can calculate and assign appropriate intensity values to pixels. Unlike other interpolation techniques such as <a href="nearest_neighbor_interpolation" title="wikilink">nearest neighbor interpolation</a> and <a href="bicubic_interpolation" title="wikilink">bicubic interpolation</a>, bilinear interpolation uses only the 4 nearest pixel values which are located in diagonal directions from a given pixel in order to find the appropriate color intensity values of that pixel.</p>

<p>Bilinear interpolation considers the closest 2x2 neighborhood of known pixel values surrounding the unknown pixel's computed location. It then takes a weighted average of these 4 pixels to arrive at its final, interpolated value. The weight on each of the 4 pixel values is based on the computed pixel's distance (in 2D space) from each of the known points.<a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a></p>
<figure><b>(Figure)</b>
<figcaption>Example of bilinear interpolation in grayscale values.</figcaption>
</figure>

<p>As seen in the example on the right, the intensity value at the pixel computed to be at row 20.2, column 14.5 can be calculated by first linearly interpolating between the values at column 14 and 15 on each rows 20 and 21, giving</p>

<p>

<math display="inline" id="Bilinear_interpolation:14">
 <semantics>
  <msub>
   <mi>I</mi>
   <mrow>
    <mn>20</mn>
    <mo>,</mo>
    <mn>14.5</mn>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>I</ci>
    <list>
     <cn type="integer">20</cn>
     <cn type="float">14.5</cn>
    </list>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle I_{20,14.5}
  </annotation>
 </semantics>
</math>


 and then interpolating linearly between these values, giving</p>

<p>

<math display="block" id="Bilinear_interpolation:15">
 <semantics>
  <mrow>
   <msub>
    <mi>I</mi>
    <mrow>
     <mn>20.2</mn>
     <mo>,</mo>
     <mn>14.5</mn>
    </mrow>
   </msub>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mstyle displaystyle="false">
      <mfrac>
       <mrow>
        <mn>21</mn>
        <mo>-</mo>
        <mn>20.2</mn>
       </mrow>
       <mrow>
        <mn>21</mn>
        <mo>-</mo>
        <mn>20</mn>
       </mrow>
      </mfrac>
     </mstyle>
     <mo>⋅</mo>
     <mn>150.5</mn>
    </mrow>
    <mo>+</mo>
    <mrow>
     <mstyle displaystyle="false">
      <mfrac>
       <mrow>
        <mn>20.2</mn>
        <mo>-</mo>
        <mn>20</mn>
       </mrow>
       <mrow>
        <mn>21</mn>
        <mo>-</mo>
        <mn>20</mn>
       </mrow>
      </mfrac>
     </mstyle>
     <mo>⋅</mo>
     <mn>128.5</mn>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mn>146.1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>I</ci>
      <list>
       <cn type="float">20.2</cn>
       <cn type="float">14.5</cn>
      </list>
     </apply>
     <apply>
      <plus></plus>
      <apply>
       <ci>normal-⋅</ci>
       <apply>
        <divide></divide>
        <apply>
         <minus></minus>
         <cn type="integer">21</cn>
         <cn type="float">20.2</cn>
        </apply>
        <apply>
         <minus></minus>
         <cn type="integer">21</cn>
         <cn type="integer">20</cn>
        </apply>
       </apply>
       <cn type="float">150.5</cn>
      </apply>
      <apply>
       <ci>normal-⋅</ci>
       <apply>
        <divide></divide>
        <apply>
         <minus></minus>
         <cn type="float">20.2</cn>
         <cn type="integer">20</cn>
        </apply>
        <apply>
         <minus></minus>
         <cn type="integer">21</cn>
         <cn type="integer">20</cn>
        </apply>
       </apply>
       <cn type="float">128.5</cn>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <cn type="float">146.1</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   I_{20.2,14.5}=\tfrac{21-20.2}{21-20}\cdot 150.5+\tfrac{20.2-20}{21-20}\cdot 12%
8.5=146.1
  </annotation>
 </semantics>
</math>

 This algorithm reduces some of the visual distortion caused by resizing an image to a non-integral zoom factor, as opposed to nearest neighbor interpolation, which will make some pixels appear larger than others in the resized image. Bilinear interpolation tends, however, to produce a greater number of interpolation artifacts (such as <a class="uri" href="aliasing" title="wikilink">aliasing</a>, blurring, and edge halos) than more computationally demanding techniques such as bicubic interpolation.<a class="footnoteRef" href="#fn3" id="fnref3"><sup>3</sup></a></p>
<h2 id="see-also">See also</h2>
<ul>
<li><a href="Bicubic_interpolation" title="wikilink">Bicubic interpolation</a></li>
<li><a href="Trilinear_interpolation" title="wikilink">Trilinear interpolation</a></li>
<li><a href="Spline_interpolation" title="wikilink">Spline interpolation</a></li>
<li><a href="Lanczos_resampling" title="wikilink">Lanczos resampling</a></li>
<li><a href="Stairstep_interpolation" title="wikilink">Stairstep interpolation</a></li>
<li><a href="Barycentric_coordinate_system_(mathematics)" title="wikilink">Barycentric coordinates - for interpolating within a triangle or tetrahedron</a></li>
</ul>
<h2 id="references">References</h2>
<references>
</references>

<p>"</p>

<p><a href="Category:Multivariate_interpolation" title="wikilink">Category:Multivariate interpolation</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1">[<a class="uri" href="http://www.pcmag.com/encyclopedia_term/0,2542,t=bilinear+interpolation&amp;i">http://www.pcmag.com/encyclopedia_term/0,2542,t=bilinear+interpolation&amp;i;</a>;=38607,00.asp Bilinear interpolation definition at www.pcmag.com]<a href="#fnref1">↩</a></li>
<li id="fn2"><a href="http://www.cambridgeincolour.com/tutorials/image-interpolation.htm">"Digital Image Interpolation"</a><a href="#fnref2">↩</a></li>
<li id="fn3"><a href="http://www.optoiq.com/index/machine-vision-imaging-processing/display/vsd-article-display/308929/articles/vision-systems-design/volume-12/issue-10/departments/wilsons-websites/understanding-image-interpolation-techniques.html">"Understanding image-interpolation techniques"</a><a href="#fnref3">↩</a></li>
</ol>
</section>
</body>
</html>

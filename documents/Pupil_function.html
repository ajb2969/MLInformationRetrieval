<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="621">Pupil function</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Pupil function</h1>
<hr>The '''pupil function''' or '''aperture function''' describes how a light wave is affected upon transmission through an optical imaging system such as a camera, microscope, or the human eye. More specifically, it is a [[Complex-valued function|complex function]] of the position in the pupil<ref n<p="">ame=pupil&gt; or aperture (often an <a href="Diaphragm_(optics)" title="wikilink">iris</a>) that indicates the relative change in amplitude and phase of the light wave. Sometimes this function is referred to as the <em>generalized</em> pupil function, in which case pupil function only indicates whether light is transmitted or not.<a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a> Imperfections in the optics typically have a direct effect on the pupil function, it is therefore an important tool to study optical imaging systems and their performance.<a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a></ref></hr></body></html>
<h2 id="relationship-with-other-functions-in-optics">Relationship with other functions in optics</h2>

<p>The complex pupil function 

<math display="inline" id="Pupil_function:0">
 <semantics>
  <mrow>
   <mi mathvariant="normal">P</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>u</mi>
    <mo>,</mo>
    <mi>v</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>normal-P</ci>
    <interval closure="open">
     <ci>u</ci>
     <ci>v</ci>
    </interval>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathrm{P}(u,v)
  </annotation>
 </semantics>
</math>

 can be written as the product of two real functions:</p>

<p>

<math display="block" id="Pupil_function:1">
 <semantics>
  <mrow>
   <mrow>
    <mi mathvariant="normal">P</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>u</mi>
     <mo>,</mo>
     <mi>v</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mrow>
      <mi mathvariant="normal">A</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>u</mi>
       <mo>,</mo>
       <mi>v</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo>⋅</mo>
     <mi>exp</mi>
    </mrow>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mpadded width="+1.7pt">
       <mi>i</mi>
      </mpadded>
      <mi mathvariant="normal">Θ</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>u</mi>
       <mo>,</mo>
       <mi>v</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>normal-P</ci>
     <interval closure="open">
      <ci>u</ci>
      <ci>v</ci>
     </interval>
    </apply>
    <apply>
     <times></times>
     <apply>
      <ci>normal-⋅</ci>
      <apply>
       <times></times>
       <ci>normal-A</ci>
       <interval closure="open">
        <ci>u</ci>
        <ci>v</ci>
       </interval>
      </apply>
      <ci>exp</ci>
     </apply>
     <apply>
      <times></times>
      <ci>i</ci>
      <ci>normal-Θ</ci>
      <interval closure="open">
       <ci>u</ci>
       <ci>v</ci>
      </interval>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathrm{P}(u,v)=\mathrm{A}(u,v)\cdot\mathrm{exp}(i\,\mathrm{\Theta}(u,v))
  </annotation>
 </semantics>
</math>

, where 

<math display="inline" id="Pupil_function:2">
 <semantics>
  <mrow>
   <mi mathvariant="normal">Θ</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>u</mi>
    <mo>,</mo>
    <mi>v</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>normal-Θ</ci>
    <interval closure="open">
     <ci>u</ci>
     <ci>v</ci>
    </interval>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathrm{\Theta}(u,v)
  </annotation>
 </semantics>
</math>

 is the phase change (in radians) introduced by the optics,<a class="footnoteRef" href="#fn3" id="fnref3"><sup>3</sup></a> or the surrounding medium.<a class="footnoteRef" href="#fn4" id="fnref4"><sup>4</sup></a> It captures all <a href="optical_aberrations" title="wikilink">optical aberrations</a> that occur between the image plane and the focal plane in the scene or sample. The light may also be attenuated differently at different positions 

<math display="inline" id="Pupil_function:3">
 <semantics>
  <mrow>
   <mo stretchy="false">(</mo>
   <mi>u</mi>
   <mo>,</mo>
   <mi>v</mi>
   <mo stretchy="false">)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <interval closure="open">
    <ci>u</ci>
    <ci>v</ci>
   </interval>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (u,v)
  </annotation>
 </semantics>
</math>

 in the pupil, sometimes deliberately for the purpose of <a class="uri" href="apodization" title="wikilink">apodization</a>. Such change in amplitude of the light wave is described by the factor 

<math display="inline" id="Pupil_function:4">
 <semantics>
  <mrow>
   <mi mathvariant="normal">A</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>u</mi>
    <mo>,</mo>
    <mi>v</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>normal-A</ci>
    <interval closure="open">
     <ci>u</ci>
     <ci>v</ci>
    </interval>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathrm{A}(u,v)
  </annotation>
 </semantics>
</math>

.</p>

<p>The pupil function is also directly related to the <a href="point_spread_function" title="wikilink">point spread function</a> by its <a href="Fourier_transform" title="wikilink">Fourier transform</a>. As such, the effect of aberrations on the point spread function can be described mathematically using the concept of the pupil function.</p>

<p>Since the (incoherent) point spread function is also related to the optical transfer function via a Fourier transform, a direct relationship exists between the pupil function and the optical transfer function. In the case of an incoherent optical imaging system, the optical transfer function is the auto correlation of the pupil function.<a class="footnoteRef" href="#fn5" id="fnref5"><sup>5</sup></a><a class="footnoteRef" href="#fn6" id="fnref6"><sup>6</sup></a></p>
<h2 id="examples">Examples</h2>
<h3 id="in-focus">In focus</h3>

<p>In a homogeneous medium, a point source emits light with spherical wave fronts. A lens that is focused onto the point source will have optics that change the spherical wave front into a planar wave before it passes through the pupil or aperture stop. Often, additional lens element refocus the light onto a sensor or photographic film, by converting the planar wave front to a spherical wave front, centered onto the image plane. The pupil function of such an ideal system is equal to one at every point within the pupil, and zero out with it. In case of a circular pupil, this can be written mathematically as:</p>

<p>

<math display="block" id="Pupil_function:5">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi mathvariant="normal">P</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>u</mi>
      <mo>,</mo>
      <mi>v</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mn>1</mn>
     <mo>,</mo>
     <mrow>
      <mo>∀</mo>
      <mi>u</mi>
     </mrow>
     <mo>,</mo>
     <mi>v</mi>
    </mrow>
   </mrow>
   <mo>:</mo>
   <mrow>
    <msqrt>
     <mrow>
      <msup>
       <mi>u</mi>
       <mn>2</mn>
      </msup>
      <mo>+</mo>
      <msup>
       <mi>v</mi>
       <mn>2</mn>
      </msup>
     </mrow>
    </msqrt>
    <mo>≤</mo>
    <mi>R</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-:</ci>
    <apply>
     <eq></eq>
     <apply>
      <times></times>
      <ci>normal-P</ci>
      <interval closure="open">
       <ci>u</ci>
       <ci>v</ci>
      </interval>
     </apply>
     <list>
      <cn type="integer">1</cn>
      <apply>
       <csymbol cd="latexml">for-all</csymbol>
       <ci>u</ci>
      </apply>
      <ci>v</ci>
     </list>
    </apply>
    <apply>
     <leq></leq>
     <apply>
      <root></root>
      <apply>
       <plus></plus>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>u</ci>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>v</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
     </apply>
     <ci>R</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathrm{P}(u,v)=1,\forall u,v:\sqrt{u^{2}+v^{2}}\leq R
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Pupil_function:6">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mrow>
      <mi mathvariant="normal">P</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>u</mi>
       <mo>,</mo>
       <mi>v</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo>=</mo>
     <mrow>
      <mn>0</mn>
      <mo>,</mo>
      <mrow>
       <mo>∀</mo>
       <mi>u</mi>
      </mrow>
      <mo>,</mo>
      <mi>v</mi>
     </mrow>
    </mrow>
    <mo>:</mo>
    <mrow>
     <msqrt>
      <mrow>
       <msup>
        <mi>u</mi>
        <mn>2</mn>
       </msup>
       <mo>+</mo>
       <msup>
        <mi>v</mi>
        <mn>2</mn>
       </msup>
      </mrow>
     </msqrt>
     <mo>></mo>
     <mi>R</mi>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-:</ci>
    <apply>
     <eq></eq>
     <apply>
      <times></times>
      <ci>normal-P</ci>
      <interval closure="open">
       <ci>u</ci>
       <ci>v</ci>
      </interval>
     </apply>
     <list>
      <cn type="integer">0</cn>
      <apply>
       <csymbol cd="latexml">for-all</csymbol>
       <ci>u</ci>
      </apply>
      <ci>v</ci>
     </list>
    </apply>
    <apply>
     <gt></gt>
     <apply>
      <root></root>
      <apply>
       <plus></plus>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>u</ci>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>v</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
     </apply>
     <ci>R</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathrm{P}(u,v)=0,\forall u,v:\sqrt{u^{2}+v^{2}}>R,
  </annotation>
 </semantics>
</math>

 where 

<math display="inline" id="Pupil_function:7">
 <semantics>
  <mi>R</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>R</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   R
  </annotation>
 </semantics>
</math>

 is the pupil radius.</p>
<h3 id="out-of-focus">Out of focus</h3>

<p>When the point source is out of focus, the spherical wave will not be completely made planar by the optics, but will have an approximately parabolic wave front

<math display="block" id="Pupil_function:8">
 <semantics>
  <mrow>
   <mi>k</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mrow>
     <msup>
      <mi>u</mi>
      <mn>2</mn>
     </msup>
     <mo>+</mo>
     <msup>
      <mi>v</mi>
      <mn>2</mn>
     </msup>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>k</ci>
    <apply>
     <plus></plus>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>u</ci>
      <cn type="integer">2</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>v</ci>
      <cn type="integer">2</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   k(u^{2}+v^{2})
  </annotation>
 </semantics>
</math>

. Such a variation in optical path length corresponds to a radial variation in the complex argument of the pupil function:</p>

<p>

<math display="block" id="Pupil_function:9">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi mathvariant="normal">P</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>u</mi>
      <mo>,</mo>
      <mi>v</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mi>exp</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mpadded width="+1.7pt">
         <mi>i</mi>
        </mpadded>
        <mi>k</mi>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <msup>
           <mi>u</mi>
           <mn>2</mn>
          </msup>
          <mo>+</mo>
          <msup>
           <mi>v</mi>
           <mn>2</mn>
          </msup>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo>,</mo>
     <mrow>
      <mo>∀</mo>
      <mi>u</mi>
     </mrow>
     <mo>,</mo>
     <mi>v</mi>
    </mrow>
   </mrow>
   <mo>:</mo>
   <mrow>
    <msqrt>
     <mrow>
      <msup>
       <mi>u</mi>
       <mn>2</mn>
      </msup>
      <mo>+</mo>
      <msup>
       <mi>v</mi>
       <mn>2</mn>
      </msup>
     </mrow>
    </msqrt>
    <mo>≤</mo>
    <mi>R</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-:</ci>
    <apply>
     <eq></eq>
     <apply>
      <times></times>
      <ci>normal-P</ci>
      <interval closure="open">
       <ci>u</ci>
       <ci>v</ci>
      </interval>
     </apply>
     <list>
      <apply>
       <times></times>
       <ci>exp</ci>
       <apply>
        <times></times>
        <ci>i</ci>
        <ci>k</ci>
        <apply>
         <plus></plus>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>u</ci>
          <cn type="integer">2</cn>
         </apply>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>v</ci>
          <cn type="integer">2</cn>
         </apply>
        </apply>
       </apply>
      </apply>
      <apply>
       <csymbol cd="latexml">for-all</csymbol>
       <ci>u</ci>
      </apply>
      <ci>v</ci>
     </list>
    </apply>
    <apply>
     <leq></leq>
     <apply>
      <root></root>
      <apply>
       <plus></plus>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>u</ci>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>v</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
     </apply>
     <ci>R</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathrm{P}(u,v)=\mathrm{exp}(i\,k(u^{2}+v^{2})),\forall u,v:\sqrt{u^{2}+v^{2}}\leq
R
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Pupil_function:10">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi mathvariant="normal">P</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>u</mi>
      <mo>,</mo>
      <mi>v</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mn>0</mn>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>normal-P</ci>
     <interval closure="open">
      <ci>u</ci>
      <ci>v</ci>
     </interval>
    </apply>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathrm{P}(u,v)=0,
  </annotation>
 </semantics>
</math>

 otherwise. It is thus possible to deduce the point-spread function of the out of focus point source as the Fourier transform of the pupil function.</p>
<h3 id="aberrated-optics">Aberrated Optics</h3>

<p>The spherical wave could also be deformed by imperfect optics to an approximately cylindrical wave front

<math display="block" id="Pupil_function:11">
 <semantics>
  <mrow>
   <mi>k</mi>
   <msup>
    <mi>u</mi>
    <mn>2</mn>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>k</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>u</ci>
     <cn type="integer">2</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   ku^{2}
  </annotation>
 </semantics>
</math>

.</p>

<p>

<math display="block" id="Pupil_function:12">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi mathvariant="normal">P</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>u</mi>
      <mo>,</mo>
      <mi>v</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mi>exp</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mpadded width="+1.7pt">
         <mi>i</mi>
        </mpadded>
        <mi>k</mi>
        <msup>
         <mi>u</mi>
         <mn>2</mn>
        </msup>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo>,</mo>
     <mrow>
      <mo>∀</mo>
      <mi>u</mi>
     </mrow>
     <mo>,</mo>
     <mi>v</mi>
    </mrow>
   </mrow>
   <mo>:</mo>
   <mrow>
    <msqrt>
     <mrow>
      <msup>
       <mi>u</mi>
       <mn>2</mn>
      </msup>
      <mo>+</mo>
      <msup>
       <mi>v</mi>
       <mn>2</mn>
      </msup>
     </mrow>
    </msqrt>
    <mo>≤</mo>
    <mi>R</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-:</ci>
    <apply>
     <eq></eq>
     <apply>
      <times></times>
      <ci>normal-P</ci>
      <interval closure="open">
       <ci>u</ci>
       <ci>v</ci>
      </interval>
     </apply>
     <list>
      <apply>
       <times></times>
       <ci>exp</ci>
       <apply>
        <times></times>
        <ci>i</ci>
        <ci>k</ci>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>u</ci>
         <cn type="integer">2</cn>
        </apply>
       </apply>
      </apply>
      <apply>
       <csymbol cd="latexml">for-all</csymbol>
       <ci>u</ci>
      </apply>
      <ci>v</ci>
     </list>
    </apply>
    <apply>
     <leq></leq>
     <apply>
      <root></root>
      <apply>
       <plus></plus>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>u</ci>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>v</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
     </apply>
     <ci>R</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathrm{P}(u,v)=\mathrm{exp}(i\,ku^{2}),\forall u,v:\sqrt{u^{2}+v^{2}}\leq R
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Pupil_function:13">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi mathvariant="normal">P</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>u</mi>
      <mo>,</mo>
      <mi>v</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mn>0</mn>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>normal-P</ci>
     <interval closure="open">
      <ci>u</ci>
      <ci>v</ci>
     </interval>
    </apply>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathrm{P}(u,v)=0,
  </annotation>
 </semantics>
</math>

 otherwise. Such a variation in optical path length will create an image that is blurred only in one dimension as is typical of systems with <a class="uri" href="astigmatism" title="wikilink">astigmatism</a>.</p>
<h2 id="see-also">See also</h2>
<ul>
<li><a href="Fourier_optics" title="wikilink">Fourier optics</a></li>
<li><a href="Point_spread_function" title="wikilink">Point spread function</a></li>
<li><a href="Optical_transfer_function" title="wikilink">Optical transfer function</a></li>
</ul>
<h2 id="references">References</h2>

<p>"</p>

<p><a class="uri" href="Category:Optics" title="wikilink">Category:Optics</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1"><a href="#fnref1">↩</a></li>
<li id="fn2"><a href="#fnref2">↩</a></li>
<li id="fn3"></li>
<li id="fn4"><a href="#fnref4">↩</a></li>
<li id="fn5"></li>
<li id="fn6"><a href="#fnref6">↩</a></li>
</ol>
</section>



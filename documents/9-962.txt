   Unbiased estimation of standard deviation      Unbiased estimation of standard deviation   In statistics and in particular statistical theory , unbiased estimation of a standard deviation is the calculation from a statistical sample of an estimated value of the standard deviation (a measure of statistical dispersion ) of a population of values, in such a way that the expected value of the calculation equals the true value. Except in some important situations, outlined later, the task has little relevance to applications of statistics since its need is avoided by standard procedures, such as the use of significance tests and confidence intervals , or by using Bayesian analysis .  However, for statistical theory, it provides an exemplar problem in the context of estimation theory which is both simple to state and for which results cannot be obtained in closed form. It also provides an example where imposing the requirement for unbiased estimation might be seen as just adding inconvenience, with no real benefit.  Background  In statistics , the standard deviation of a population of numbers is often estimated from a random sample drawn from the population. The most common measure used is the sample standard deviation, which is defined by       s  =      1   n  -  1      ∑   i  =  1   n     (    x  i   -   x  ¯    )   2        ,      s        1    n  1      superscript   subscript     i  1    n    superscript     subscript  x  i    normal-¯  x    2        s=\sqrt{\frac{1}{n-1}\sum_{i=1}^{n}(x_{i}-\overline{x})^{2}}\,,   where    {   x  1   ,   x  2   ,  …  ,   x  n   }      subscript  x  1    subscript  x  2   normal-…   subscript  x  n     \{x_{1},x_{2},\ldots,x_{n}\}   is the sample (formally, realizations from a random variable  X ) and    x  ¯     normal-¯  x    \overline{x}   is the sample mean .  One way of seeing that this is a biased estimator of the standard deviation of the population is to start from the result that s 2 is an unbiased estimator for the variance σ 2 of the underlying population if that variance exists and the sample values are drawn independently with replacement. The square root is a nonlinear function, and only linear functions commute with taking the expectation. Since the square root is a strictly concave function, it follows from Jensen's inequality that the square root of the sample variance is an underestimate.  The use of n − 1 instead of n in the formula for the sample variance is known as Bessel's correction , which corrects the bias in the estimation of the population variance, and some, but not all of the bias in the estimation of the sample standard deviation.  It is not possible to find an estimate of the standard deviation which is unbiased for all population distributions, as the bias depends on the particular distribution. Much of the following relates to estimation assuming a normal distribution .  Bias correction  Results for the normal distribution  (Figure)  Correction factor c 4 versus sample size n .   When the random variable is normally distributed , a minor correction exists to eliminate the bias. To derive the correction, note that for normally distributed X , Cochran's theorem implies that the square of        n  -  1     s   /  σ            n  1    s   σ    \sqrt{n-1}\,s/\sigma   has a chi distribution with  degrees of freedom. Consequently,       E   [  s  ]    =    c  4    (  n  )    σ         normal-E  s      subscript  c  4   n  σ     \operatorname{E}[s]=c_{4}(n)\sigma\,     where the correction factor c 4 ( n ) is the scale mean of the chi distribution with  degrees of freedom,       μ  1    (   n  -  1   )    /    n  -  1     .         subscript  μ  1     n  1        n  1      \mu_{1}(n-1)/\sqrt{n-1}.   This depends on the sample size n, and is given as follows : 1        c  4    (  n  )    =      2   n  -  1         Γ   (   n  2   )     Γ   (    n  -  1   2   )       =    1  -   1   4  n    -   7   32   n  2     -   19   128   n  3      +   O   (   n   -  4    )              subscript  c  4   n         2    n  1         normal-Γ    n  2      normal-Γ      n  1   2               1    1    4  n      7    32   superscript  n  2       19    128   superscript  n  3        O   superscript  n    4         c_{4}(n)\,=\,\sqrt{\frac{2}{n-1}}\,\,\,\frac{\Gamma\left(\frac{n}{2}\right)}{%
 \Gamma\left(\frac{n-1}{2}\right)}\,=\,1-\frac{1}{4n}-\frac{7}{32n^{2}}-\frac{1%
 9}{128n^{3}}+O(n^{-4})     and Γ(·) is the gamma function . An unbiased estimator of σ can be obtained by dividing s by c 4 ( n ). As n grows large it approaches 1, and even for smaller values the correction is minor. The figure shows a plot of c 4 ( n ) versus sample size. The table below gives numerical values of c 4 and algebraic expressions for some values of n ; more complete tables may be found in most textbooks on statistical quality control .      Sample size   Expression of c 4   Numerical value       2        2  π         2  π     \sqrt{\frac{2}{\pi}}      0.7978845608     3        π   2        π   2    \frac{\sqrt{\pi}}{2}      0.8862269255     4        2     2   3  π         2      2    3  π       2\,\sqrt{\frac{2}{3\pi}}      0.9213177319     5         3  4      π  2          3  4       π  2      \frac{3}{4}\,\sqrt{\frac{\pi}{2}}      0.9399856030     6         8  3      2   5  π           8  3       2    5  π       \frac{8}{3}\,\sqrt{\frac{2}{5\pi}}      0.9515328619     7        5    3  π     16        5      3  π     16    \frac{5\sqrt{3\pi}}{16}      0.9593687891     8         16  5      2   7  π           16  5       2    7  π       \frac{16}{5}\,\sqrt{\frac{2}{7\pi}}      0.9650304561     9        35   π    64        35    π    64    \frac{35\sqrt{\pi}}{64}      0.9693106998     10         128  105      2  π          128  105       2  π      \frac{128}{105}\,\sqrt{\frac{2}{\pi}}      0.9726592741     100    0.9974779761     1000    0.9997497811     10000    0.9999749978     n = 2k          2   π   (    2  k   -  1   )          2    2  k   -  2       (   k  -  1   )   !   2      (    2  k   -  2   )   !            2    π      2  k   1           superscript  2      2  k   2     superscript      k  1    2          2  k   2       \sqrt{\frac{2}{\pi\left(2k-1\right)}}\,\frac{2^{2k-2}\left(k-1\right)!^{2}}{%
 \left(2k-2\right)!}        n = 2k+1          π  k        (    2  k   -  1   )   !     2    2  k   -  1       (   k  -  1   )   !   2             π  k            2  k   1       superscript  2      2  k   1     superscript      k  1    2       \sqrt{\frac{\pi}{k}}\,\frac{\left(2k-1\right)!}{2^{2k-1}\left(k-1\right)!^{2}}        It is important to keep in mind this correction only produces an unbiased estimator for normally and independently distributed X . When this condition is satisfied, another result about s involving c 4 ( n ) is that the standard error of s is 2 3     σ    1  -   c  4  2         σ      1   superscript   subscript  c  4   2       \sigma\sqrt{1-c_{4}^{2}}   , while the standard error of the unbiased estimator is     σ     c  4   -  2    -  1     .      σ       superscript   subscript  c  4     2    1      \sigma\sqrt{c_{4}^{-2}-1}.     Rule of thumb for the normal distribution  If calculation of the function c 4 ( n ) appears too difficult, there is a simple rule-of-thumb 4 to take the estimator       σ  ^   =     1   n  -  1.5      ∑   i  =  1   n     (    x  i   -   x  ¯    )   2           normal-^  σ         1    n  1.5      superscript   subscript     i  1    n    superscript     subscript  x  i    normal-¯  x    2        \hat{\sigma}=\sqrt{\frac{1}{n-1.5}\sum_{i=1}^{n}(x_{i}-\bar{x})^{2}}   The formula differs from the familiar expression for s 2 only by having  instead of  in the denominator. This expression is only approximate, in fact        E   [   σ  ^   ]    =   σ  ⋅   (   1  +   1   16   n  2     +   3   16   n  3     +   O   (   n   -  4    )     )     .       normal-E   normal-^  σ     normal-⋅  σ    1    1    16   superscript  n  2       3    16   superscript  n  3       O   superscript  n    4         \operatorname{E}[\hat{\sigma}]=\sigma\cdot\Big(1+\frac{1}{16n^{2}}+\frac{3}{16%
 n^{3}}+O(n^{-4})\Big).   The bias is relatively small: say, for  it is equal to 1.3%, and for  the bias is already less than 0.1%.  Other distributions  In cases where statistically independent data are modelled by a parametric family of distributions other than the normal distribution , the population standard deviation will, if it exists, be a function of the parameters of the model. One general approach to estimation would be maximum likelihood . Alternatively, it may be possible to use the Rao–Blackwell theorem as a route to finding a good estimate of the standard deviation. In neither case would the estimates obtained usually be unbiased. Notionally, theoretical adjustments might be obtainable to lead to unbiased estimates but, unlike those for the normal distribution, these would typically depend on the estimated parameters.  If the requirement is simply to reduce the bias of an estimated standard deviation, rather than to eliminate it entirely, then two practical approaches are available, both within the context of resampling . These are jackknifing and bootstrapping . Both can be applied either to parametrically based estimates of the standard deviation or to the sample standard deviation.  For non-normal distributions an approximate (up to O ( n −1 ) terms) formula for the unbiased estimator of the standard deviation is        σ  ^   =     1   n  -  1.5  -    1  4    γ  2        ∑   i  =  1   n     (    x  i   -   x  ¯    )   2       ,       normal-^  σ         1    n  1.5      1  4    subscript  γ  2        superscript   subscript     i  1    n    superscript     subscript  x  i    normal-¯  x    2        \hat{\sigma}=\sqrt{\frac{1}{n-1.5-\tfrac{1}{4}\gamma_{2}}\sum_{i=1}^{n}(x_{i}-%
 \bar{x})^{2}},   where γ 2 denotes the population excess kurtosis . The excess kurtosis may be either known beforehand for certain distributions, or estimated from the data.  Effect of autocorrelation (serial correlation)  The material above, to stress the point again, applies only to independent data. However, real-world data often does not meet this requirement; it is autocorrelated (also known as serial correlation). As one example, the successive readings of a measurement instrument that incorporates some form of “smoothing” (more correctly, low-pass filtering) process will be autocorrelated, since any particular value is calculated from some combination of the earlier and later readings.  Estimates of the variance, and standard deviation, of autocorrelated data will be biased. The expected value of the sample variance is 5       E   [   s  2   ]    =     σ  2     [    1   -     2   n  -  1        ∑    k   =  1     n   -  1       (    1   -   k  n    )    ρ  k       ]          normal-E   delimited-[]   superscript  s  2        superscript  σ  2    delimited-[]    1      2    n  1      superscript   subscript     k  1      n  1        1    k  n     subscript  ρ  k           {\rm E}\left[{s^{2}}\right]\,\,=\,\,\sigma^{2}\,\left[{1\,\,\,-\,\,\,{2\over{n%
 -\,\,1}}\,\,\sum\limits_{k\,=\,1}^{n\,-1}{\,\left({1\,\,-\,\,{k\over n}}\right%
 )\rho_{k}}}\right]     where n is the sample size (number of measurements) and     ρ  k     subscript  ρ  k    \rho_{k}    is the autocorrelation function (ACF) of the data. (Note that the expression in the brackets is simply one minus the average expected autocorrelation for the readings.) If the ACF consists of positive values then the estimate of the variance (and its square root, the standard deviation) will be biased low. That is, the actual variability of the data will be greater than that indicated by an uncorrected variance or standard deviation calculation. It is essential to recognize that, if this expression is to be used to correct for the bias, by dividing the estimate    s  2     superscript  s  2    s^{2}   by the quantity in brackets above, then the ACF must be known analytically , not via estimation from the data. This is because the estimated ACF will itself be biased. 6  Example of bias in standard deviation  To illustrate the magnitude of the bias in the standard deviation, consider a dataset that consists of sequential readings from an instrument that uses a specific digital filter whose ACF is known to be given by       ρ  k   =    (    1   -   α    )   k        subscript  ρ  k    superscript    1  α   k     \rho_{k}=\,\,\left({\,1\,\,-\,\,\alpha\,}\right)^{k}     where α is the parameter of the filter, and it takes values from zero to unity. Thus the ACF is positive and geometrically decreasing. The figure shows the ratio of the estimated standard deviation to its known value (which can be calculated analytically for this digital filter), for several settings of α as a function of sample size n . Changing α alters the variance reduction ratio of the filter, which is known to be       VRR   =   α    2   -  α        VRR    α    2  α      {\rm VRR}\,\,\,=\,\,{\alpha\over{2\,\,-\,\,\alpha}}     so that smaller values of α result in more variance reduction, or “smoothing.” The bias is indicated by values on the vertical axis different from unity; that is, if there were no bias, the ratio of the estimated to known standard deviation would be unity. Clearly, for modest sample sizes there can be significant bias (a factor of two, or more).  Variance of the mean  It is often of interest to estimate the variance or standard deviation of an estimated mean rather than the variance of a population. When the data are autocorrelated, this has a direct effect on the theoretical variance of the sample mean, which is 7        Var   [   x  ¯   ]    =      σ  2   n     [    1   +    2     ∑    k   =  1    n  -  1      (    1   -   k  n    )    ρ  k       ]     .        Var   delimited-[]   normal-¯  x          superscript  σ  2   n    delimited-[]    1    2    superscript   subscript     k  1      n  1        1    k  n     subscript  ρ  k           {\rm Var}\left[\bar{x}\right]\,\,\,=\,\,{{\sigma^{2}}\over n}\,\left[{1\,\,\,+%
 \,\,\,2\,\sum\limits_{k\,=\,1}^{n-1}{\left({1\,\,-\,\,{k\over n}}\right)\rho_{%
 k}}}\right].   The variance of the sample mean can then be estimated by substituting an estimate of σ 2 . One such estimate can be obtained from the equation for E[s 2 ] given above. First define the following constants, assuming, again, a known ACF:         γ  1    ≡    1   -     2    n   -  1        ∑    k   =  1     n   -  1       (    1   -   k  n    )    ρ  k           γ  2    ≡    1   +    2      ∑    k   =  1     n   -  1       (    1   -   k  n    )    ρ  k           formulae-sequence     subscript  γ  1     1      2    n  1      superscript   subscript     k  1      n  1        1    k  n     subscript  ρ  k           subscript  γ  2     1    2    superscript   subscript     k  1      n  1        1    k  n     subscript  ρ  k          \gamma_{1}\,\,\equiv\,\,1\,\,\,-\,\,{2\over{n\,\,-\,\,1}}\,\,\sum\limits_{k\,=%
 \,1}^{n\,-\,1}{\,\left({1\,\,-\,\,{k\over n}}\right)}\,\rho_{k}\,\,\,\,\,\,\,%
 \,\,\,\,\,\gamma_{2}\,\,\equiv\,\,1\,\,\,+\,\,2\,\sum\limits_{k\,=\,1}^{n\,-\,%
 1}{\,\left({1\,\,-\,\,{k\over n}}\right)}\,\rho_{k}   so that        E   [   s  2   ]    =      σ  2     γ  1    ⇒      E   [    s  2    γ  1    ]    =   σ  2       formulae-sequence      normal-E   delimited-[]   superscript  s  2         superscript  σ  2    subscript  γ  1    normal-⇒        normal-E   delimited-[]     superscript  s  2    subscript  γ  1       superscript  σ  2      {\rm E}\left[{s^{2}}\right]\,\,=\,\,\sigma^{2}\,\gamma_{1}\,\,\,\,\,\,%
 \Rightarrow\,\,\,\,\,\,{\rm E}\left[{{{s^{2}}\over{\gamma_{1}}}}\right]\,\,\,=%
 \,\,\,\sigma^{2}   This says that the expected value of the quantity obtained by dividing the observed sample variance by the correction factor    γ  1     subscript  γ  1    \gamma_{1}   gives an unbiased estimate of the variance. Similarly, re-writing the expression above for the variance of the mean,       Var   [   x  ¯   ]    =      σ  2   n     γ  2          Var   delimited-[]   normal-¯  x          superscript  σ  2   n    subscript  γ  2      {\rm Var}\left[{\bar{x}}\right]\,\,\,=\,\,\,{{\sigma^{2}}\over n}\,\,\gamma_{2}   and substituting the estimate for    σ  2     superscript  σ  2    \sigma^{2}   gives 8       Var   [   x  ¯   ]    =   E   [     s  2    γ  1     (    γ  2   n   )    ]    =   E   [     s  2   n    {     n   -  1     n   γ  2    -  1    }    ]            Var   delimited-[]   normal-¯  x       normal-E   delimited-[]       superscript  s  2    subscript  γ  1       subscript  γ  2   n             normal-E   delimited-[]       superscript  s  2   n        n  1       n   subscript  γ  2    1           {\rm Var}\left[{\bar{x}}\right]\,\,\,=\,\,\,{\rm E}\left[{{{s^{2}}\over{\gamma%
 _{1}}}\left({{{\gamma_{2}}\over n}}\right)}\right]\,\,\,\,=\,\,\,{\rm E}\left[%
 {{{s^{2}}\over n}\left\{{{{n\,\,-\,\,1}\over{{n\over{\gamma_{2}}}-\,\,1}}}%
 \right\}}\right]   which is an unbiased estimator of the variance of the mean in terms of the observed sample variance and known quantities. Note that, if the autocorrelations    ρ  k     subscript  ρ  k    \rho_{k}   are identically zero, this expression reduces to the well-known result for the variance of the mean for independent data. The effect of the expectation operator in these expressions is that the equality holds in the mean (i.e., on average).  Estimating the standard deviation of the population  Having the expressions above involving the variance of the population, and of an estimate of the mean of that population, it would seem logical to simply take the square root of these expressions to obtain unbiased estimates of the respective standard deviations. However it is the case that, since expectations are integrals,       E   [  s  ]    ≠      E    [   s  2   ]      ≠    σ      γ   1             normal-E   delimited-[]  s        normal-E   delimited-[]   superscript  s  2             σ     subscript  γ  1        {\rm E}[s]\,\,\,\neq\,\,\sqrt{\,{\rm E}\left[{s^{2}}\right]}\,\,\,\neq\,\,\,%
 \sigma\,\sqrt{\,\gamma_{1}}     Instead, assume a function θ exists such that an unbiased estimator of the standard deviation can be written        E   [  s  ]    =     σ   θ     γ   1     ⇒       σ  ^    =   s    θ      γ   1          formulae-sequence      normal-E   delimited-[]  s       σ  θ     subscript  γ  1     normal-⇒       normal-^  σ     s    θ     subscript  γ  1         {\rm E}\left[s\right]\,\,\,=\,\,\,\sigma\,\,\theta\sqrt{\,\gamma_{1}}\,\,\,\,%
 \,\,\,\,\Rightarrow\,\,\,\,\,\,\,\hat{\sigma}\,\,=\,\,{s\over{\theta\,\sqrt{\,%
 \gamma_{1}}}}     and θ depends on the sample size n and the ACF. In the case of NID (normally and independently distributed) data, the radicand is unity and θ is just the c 4 function given in the first section above. As with c 4 , θ approaches unity as the sample size increases (as does γ 1 ).  It can be demonstrated via simulation modeling that ignoring θ (that is, taking it to be unity) and using        E   [  s  ]    ≈     σ      γ   1     ⇒       σ  ^    ≈   s     γ   1         formulae-sequence      normal-E   delimited-[]  s       σ     subscript  γ  1     normal-⇒       normal-^  σ     s     subscript  γ  1        {\rm E}[s]\,\,\approx\,\,\sigma\,\sqrt{\,\gamma_{1}}\,\,\,\,\,\,\,\,\,\,%
 \Rightarrow\,\,\,\,\,\,\,\,\,\hat{\sigma}\,\,\,\approx\,\,\,{s\over{\sqrt{\,%
 \gamma_{1}}}}     removes all but a few percent of the bias caused by autocorrelation, making this a reduced -bias estimator, rather than an un biased estimator. In practical measurement situations, this reduction in bias can be significant, and useful, even if some relatively small bias remains. The figure above, showing an example of the bias in the standard deviation vs. sample size, is based on this approximation; the actual bias would be somewhat larger than indicated in those graphs since the transformation bias θ is not included there.  Estimating the standard deviation of the mean  The unbiased variance of the mean in terms of the population variance and the ACF is given by       Var   [   x  ¯   ]    =      σ  2   n      γ  2           Var   delimited-[]   normal-¯  x          superscript  σ  2   n    subscript  γ  2      {\rm Var}\left[{\bar{x}}\right]\,\,\,=\,\,\,{{\sigma^{2}}\over n}\,\,\gamma_{2}\,     and since there are no expected values here, in this case the square root can be taken, so that        σ   x  ¯     =     σ    n         γ   2          subscript  σ   normal-¯  x        σ    n       subscript  γ  2       \sigma_{\bar{x}}\,\,\,\,=\,\,\,{\sigma\over{\sqrt{\,n}}}\,\,\sqrt{\,\gamma_{2}}     Using the unbiased estimate expression above for σ , an estimate of the standard deviation of the mean will then be         σ  ^    x  ¯     =     s     θ     n          γ   2       γ   1           subscript   normal-^  σ    normal-¯  x        s    θ    n          subscript  γ  2       subscript  γ  1        \hat{\sigma}_{\bar{x}}\,\,=\,\,\,{{s\,}\over{\theta\,\sqrt{\,n}}}{{\sqrt{\,%
 \gamma_{2}}}\over{\sqrt{\,\gamma_{1}}}}     If the data are NID, so that the ACF vanishes, this reduces to         σ  ^    x  ¯     =   s    c  4     n           subscript   normal-^  σ    normal-¯  x      s     subscript  c  4     n       \hat{\sigma}_{\bar{x}}\,\,\,=\,\,\,{s\over{c_{4}\sqrt{\,n}}}     In the presence of a nonzero ACF, ignoring the function θ as before leads to the reduced -bias estimator         σ  ^    x  ¯     ≈     s     n          γ   2       γ   1       =     s     n         n   -  1      n   γ  2     -  1             subscript   normal-^  σ    normal-¯  x        s    n         subscript  γ  2       subscript  γ  1               s    n          n  1       n   subscript  γ  2    1         \hat{\sigma}_{\bar{x}}\,\,\,\approx\,\,\,\,{{s\,}\over{\sqrt{\,n}}}{{\sqrt{\,%
 \gamma_{2}}}\over{\sqrt{\,\gamma_{1}}}}\,\,\,\,=\,\,\,\,{{s\,}\over{\sqrt{\,n}%
 }}\sqrt{{{n\,\,-\,\,1}\over{{n\over{\gamma_{2}}}\,\,-\,\,1}}}     which again can be demonstrated to remove a useful majority of the bias.  See also   Bessel's correction  Estimation of covariance matrices  Sample mean and sample covariance   References   Douglas C. Montgomery and George C. Runger, Applied Statistics and Probability for Engineers , 3rd edition, Wiley and sons, 2003. (see Sections 7–2.2 and 16–5)     External links   A Java interactive graphic showing the Helmert PDF from which the bias correction factors are derived.  Monte-Carlo simulation demo for unbiased estimation of standard deviation.  http://www.itl.nist.gov/div898/handbook/pmc/section3/pmc32.htm What are Variables Control Charts?   "  Category:Estimation for specific parameters  Category:Summary statistics  Category:Covariance and correlation     Ben W. Bolch, "More on unbiased estimation of the standard deviation", The American Statistician, 22(3), p. 27 (1968) ↩  Duncan, A. J., Quality Control and Industrial Statistics 4th Ed., Irwin (1974) ISBN 0-256-01558-9, p.139 ↩  * N.L. Johnson, S. Kotz, and N. Balakrishnan, Continuous Univariate Distributions, Volume 1 , 2nd edition, Wiley and sons, 1994. ISBN 0-471-58495-9. Chapter 13, Section 8.2 ↩  Richard M. Brugger, "A Note on Unbiased Estimation of the Standard Deviation", The American Statistician (23) 4 p. 32 (1969) ↩  Law and Kelton, Simulation Modeling and Analysis , 2nd Ed. McGraw-Hill (1991), p.284, ISBN 0-07-036698-5. This expression can be derived from its original source in Anderson, The Statistical Analysis of Time Series , Wiley (1971), ISBN 0-471-04745-7, p.448, Equation 51. ↩  Law and Kelton, p.286. This bias is quantified in Anderson, p.448, Equations 52–54. ↩  Law and Kelton, p.285. This equation can be derived from Theorem 8.2.3 of Anderson. It also appears in Box, Jenkins, Reinsel, Time Series Analysis: Forecasting and Control , 4th Ed. Wiley (2008), ISBN 978-0-470-27284-8, p.31. ↩  Law and Kelton, p.285 ↩     
<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="380">Multi-compartment model</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Multi-compartment model</h1>
<hr/>

<p>A <strong>multi-compartment model</strong> is a type of <a href="mathematical_model" title="wikilink">mathematical model</a> used for describing the way materials or energies are transmitted among the <em>compartments</em> of a system. Each compartment is assumed to be a homogeneous entity within which the entities being modelled are equivalent. For instance, in a pharmacokinetic model, the compartments may represent different sections of a body within which the concentration of a drug is assumed to be uniformly equal.</p>

<p>Hence a multi-compartment model is a <a href="lumped_parameters" title="wikilink">lumped parameters</a> model.</p>

<p>Multi-compartment models are used in many fields including <a class="uri" href="pharmacokinetics" title="wikilink">pharmacokinetics</a>, <a href="compartmental_models_in_epidemiology" title="wikilink">epidemiology</a>, <a class="uri" href="biomedicine" title="wikilink">biomedicine</a>, <a href="systems_theory" title="wikilink">systems theory</a>, <a href="Complex_systems" title="wikilink">complexity theory</a>, engineering, physics, information science and social science. The circuits systems can be viewed as a multi-compartment model as well.</p>

<p>In systems theory, it involves the description of a network whose components are compartments that represent a population of elements that are equivalent with respect to the manner in which they process input signals to the compartment.</p>
<dl>
<dd>
</dd>
</dl>
<ul>
<li>Instant homogeneous distribution of materials or energies within a "compartment."</li>
<li>The exchange rate of materials or energies among the compartments is related to the densities of these compartments.</li>
<li>Usually, it is desirable that the materials do not undergo chemical reactions while transmitting among the compartments.</li>
<li>When concentration of the cell is of interest, typically the volume is assumed to be constant over time, though this may not be totally true in reality.</li>
</ul>

<p>Most commonly, the mathematics of multi-compartment models is simplified to provide only a single parameterâ€”such as concentrationâ€”within a compartment.</p>
<h2 id="single-compartment-model">Single-compartment model</h2>
<figure><b>(Figure)</b>
<figcaption>Singlecell.PNG</figcaption>
</figure>

<p>Possibly the simplest application of multi-compartment model is in the single-cell concentration monitoring (see the figure above). If the volume of a cell is <em>V</em>, the <a class="uri" href="mass" title="wikilink">mass</a> of <a href="solution" title="wikilink">solute</a> is <em>q</em>, the input is <em>u</em>(<em>t</em>) and the secretion of the solution is proportional to the density of it within the cell, then the concentration of the solution ''C"' within the cell over time is given by</p>

<p>

<math display="block" id="Multi-compartment_model:0">
 <semantics>
  <mrow>
   <mfrac>
    <mrow>
     <mi mathvariant="normal">d</mi>
     <mi>q</mi>
    </mrow>
    <mrow>
     <mi mathvariant="normal">d</mi>
     <mi>t</mi>
    </mrow>
   </mfrac>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mi>u</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>t</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>-</mo>
    <mrow>
     <mi>k</mi>
     <mi>q</mi>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <divide></divide>
     <apply>
      <times></times>
      <ci>normal-d</ci>
      <ci>q</ci>
     </apply>
     <apply>
      <times></times>
      <ci>normal-d</ci>
      <ci>t</ci>
     </apply>
    </apply>
    <apply>
     <minus></minus>
     <apply>
      <times></times>
      <ci>u</ci>
      <ci>t</ci>
     </apply>
     <apply>
      <times></times>
      <ci>k</ci>
      <ci>q</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \frac{\mathrm{d}q}{\mathrm{d}t}=u(t)-kq
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Multi-compartment_model:1">
 <semantics>
  <mrow>
   <mi>C</mi>
   <mo>=</mo>
   <mfrac>
    <mi>q</mi>
    <mi>V</mi>
   </mfrac>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>C</ci>
    <apply>
     <divide></divide>
     <ci>q</ci>
     <ci>V</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   C=\frac{q}{V}
  </annotation>
 </semantics>
</math>

</p>

<p>where <em>k</em> is the proportionality.</p>

<p>As the number of compartments increases, the model can be very complex and the solutions usually beyond ordinary calculation. Below shows a three-cell model with interlinks among each other.</p>

<p>The formulae for <strong>n-cell</strong> multi-compartment models become:</p>

<p>

<math display="inline" id="Multi-compartment_model:2">
 <semantics>
  <mrow>
   <msub>
    <mover accent="true">
     <mi>q</mi>
     <mo>Ë™</mo>
    </mover>
    <mn>1</mn>
   </msub>
   <mo>=</mo>
   <mrow>
    <mrow>
     <msub>
      <mi>q</mi>
      <mn>1</mn>
     </msub>
     <msub>
      <mi>k</mi>
      <mn>11</mn>
     </msub>
    </mrow>
    <mo>+</mo>
    <mrow>
     <msub>
      <mi>q</mi>
      <mn>2</mn>
     </msub>
     <msub>
      <mi>k</mi>
      <mn>12</mn>
     </msub>
    </mrow>
    <mo>+</mo>
    <mi mathvariant="normal">â‹¯</mi>
    <mo>+</mo>
    <mrow>
     <msub>
      <mi>q</mi>
      <mi>n</mi>
     </msub>
     <msub>
      <mi>k</mi>
      <mrow>
       <mn>1</mn>
       <mi>n</mi>
      </mrow>
     </msub>
    </mrow>
    <mo>+</mo>
    <mrow>
     <msub>
      <mi>u</mi>
      <mn>1</mn>
     </msub>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>t</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <ci>normal-Ë™</ci>
      <ci>q</ci>
     </apply>
     <cn type="integer">1</cn>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>q</ci>
       <cn type="integer">1</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>k</ci>
       <cn type="integer">11</cn>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>q</ci>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>k</ci>
       <cn type="integer">12</cn>
      </apply>
     </apply>
     <ci>normal-â‹¯</ci>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>q</ci>
       <ci>n</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>k</ci>
       <apply>
        <times></times>
        <cn type="integer">1</cn>
        <ci>n</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>u</ci>
       <cn type="integer">1</cn>
      </apply>
      <ci>t</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle\dot{q}_{1}=q_{1}k_{11}+q_{2}k_{12}+\cdots+q_{n}k_{1n}+u_{1}(t)
  </annotation>
 </semantics>
</math>


</p>

<p>Where</p>

<p>

<math display="block" id="Multi-compartment_model:3">
 <semantics>
  <mrow>
   <mn>0</mn>
   <mo>=</mo>
   <mrow>
    <munderover>
     <mo largeop="true" movablelimits="false" symmetric="true">âˆ‘</mo>
     <mrow>
      <mi>i</mi>
      <mo>=</mo>
      <mn>1</mn>
     </mrow>
     <mi>n</mi>
    </munderover>
    <msub>
     <mi>k</mi>
     <mrow>
      <mi>i</mi>
      <mi>j</mi>
     </mrow>
    </msub>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <cn type="integer">0</cn>
    <apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <sum></sum>
       <ci>n</ci>
      </apply>
      <apply>
       <eq></eq>
       <ci>i</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>k</ci>
      <apply>
       <times></times>
       <ci>i</ci>
       <ci>j</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   0=\sum^{n}_{i=1}{k_{ij}}
  </annotation>
 </semantics>
</math>

 for 

<math display="inline" id="Multi-compartment_model:4">
 <semantics>
  <mrow>
   <mi>j</mi>
   <mo>=</mo>
   <mrow>
    <mn>1</mn>
    <mo>,</mo>
    <mn>2</mn>
    <mo>,</mo>
    <mi mathvariant="normal">â€¦</mi>
    <mo>,</mo>
    <mi>n</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>j</ci>
    <list>
     <cn type="integer">1</cn>
     <cn type="integer">2</cn>
     <ci>normal-â€¦</ci>
     <ci>n</ci>
    </list>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   j=1,2,\dots,n
  </annotation>
 </semantics>
</math>

 (as the total 'contents' of all compartments is constant in a closed system)</p>

<p>Or in matrix forms:</p>

<p>

<math display="block" id="Multi-compartment_model:5">
 <semantics>
  <mrow>
   <mover accent="true">
    <mi>ğª</mi>
    <mo>Ë™</mo>
   </mover>
   <mo>=</mo>
   <mrow>
    <mi>ğŠğª</mi>
    <mo>+</mo>
    <mi>ğ®</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <ci>normal-Ë™</ci>
     <ci>ğª</ci>
    </apply>
    <apply>
     <plus></plus>
     <ci>ğŠğª</ci>
     <ci>ğ®</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{\dot{q}}=\mathbf{Kq}+\mathbf{u}
  </annotation>
 </semantics>
</math>

</p>

<p>Where</p>

<p>

<math display="block" id="Multi-compartment_model:6">
 <semantics>
  <mrow>
   <mi>ğŠ</mi>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mo>[</mo>
     <mtable displaystyle="true">
      <mtr>
       <mtd columnalign="center">
        <msub>
         <mi>k</mi>
         <mn>11</mn>
        </msub>
       </mtd>
       <mtd columnalign="center">
        <msub>
         <mi>k</mi>
         <mn>12</mn>
        </msub>
       </mtd>
       <mtd columnalign="center">
        <mi mathvariant="normal">â‹¯</mi>
       </mtd>
       <mtd columnalign="center">
        <mrow>
         <mi>k</mi>
         <msub>
          <mo>;</mo>
          <mrow>
           <mn>1</mn>
           <mi>n</mi>
          </mrow>
         </msub>
        </mrow>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <msub>
         <mi>k</mi>
         <mn>21</mn>
        </msub>
       </mtd>
       <mtd columnalign="center">
        <msub>
         <mi>k</mi>
         <mn>22</mn>
        </msub>
       </mtd>
       <mtd columnalign="center">
        <mi mathvariant="normal">â‹¯</mi>
       </mtd>
       <mtd columnalign="center">
        <mrow>
         <mi>k</mi>
         <msub>
          <mo>;</mo>
          <mrow>
           <mn>2</mn>
           <mi>n</mi>
          </mrow>
         </msub>
        </mrow>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mi mathvariant="normal">â‹®</mi>
       </mtd>
       <mtd columnalign="center">
        <mi mathvariant="normal">â‹®</mi>
       </mtd>
       <mtd columnalign="center">
        <mi mathvariant="normal">â‹±</mi>
       </mtd>
       <mtd columnalign="center">
        <mi mathvariant="normal">â‹®</mi>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <msub>
         <mi>k</mi>
         <mrow>
          <mi>n</mi>
          <mn>1</mn>
         </mrow>
        </msub>
       </mtd>
       <mtd columnalign="center">
        <msub>
         <mi>k</mi>
         <mrow>
          <mi>n</mi>
          <mn>2</mn>
         </mrow>
        </msub>
       </mtd>
       <mtd columnalign="center">
        <mi mathvariant="normal">â‹¯</mi>
       </mtd>
       <mtd columnalign="center">
        <mrow>
         <mi>k</mi>
         <msub>
          <mo>;</mo>
          <mrow>
           <mi>n</mi>
           <mi>n</mi>
          </mrow>
         </msub>
        </mrow>
       </mtd>
      </mtr>
     </mtable>
     <mo>]</mo>
    </mrow>
    <mi>ğª</mi>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mo>[</mo>
     <mtable displaystyle="true">
      <mtr>
       <mtd columnalign="center">
        <msub>
         <mi>q</mi>
         <mn>1</mn>
        </msub>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <msub>
         <mi>q</mi>
         <mn>2</mn>
        </msub>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mi mathvariant="normal">â‹®</mi>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <msub>
         <mi>q</mi>
         <mi>n</mi>
        </msub>
       </mtd>
      </mtr>
     </mtable>
     <mo>]</mo>
    </mrow>
    <mi>ğ®</mi>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mo>[</mo>
    <mtable displaystyle="true">
     <mtr>
      <mtd columnalign="center">
       <mrow>
        <msub>
         <mi>u</mi>
         <mn>1</mn>
        </msub>
        <mrow>
         <mo stretchy="false">(</mo>
         <mi>t</mi>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
      </mtd>
     </mtr>
     <mtr>
      <mtd columnalign="center">
       <mrow>
        <msub>
         <mi>u</mi>
         <mn>2</mn>
        </msub>
        <mrow>
         <mo stretchy="false">(</mo>
         <mi>t</mi>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
      </mtd>
     </mtr>
     <mtr>
      <mtd columnalign="center">
       <mi mathvariant="normal">â‹®</mi>
      </mtd>
     </mtr>
     <mtr>
      <mtd columnalign="center">
       <mrow>
        <msub>
         <mi>u</mi>
         <mi>n</mi>
        </msub>
        <mrow>
         <mo stretchy="false">(</mo>
         <mi>t</mi>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
      </mtd>
     </mtr>
    </mtable>
    <mo>]</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <ci>ğŠ</ci>
     <apply>
      <times></times>
      <matrix>
       <matrixrow>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>k</ci>
         <cn type="integer">11</cn>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>k</ci>
         <cn type="integer">12</cn>
        </apply>
        <ci>normal-â‹¯</ci>
        <cerror>
         <csymbol cd="ambiguous">fragments</csymbol>
         <csymbol cd="unknown">k</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>normal-;</ci>
          <apply>
           <times></times>
           <cn type="integer">1</cn>
           <ci>n</ci>
          </apply>
         </apply>
        </cerror>
       </matrixrow>
       <matrixrow>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>k</ci>
         <cn type="integer">21</cn>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>k</ci>
         <cn type="integer">22</cn>
        </apply>
        <ci>normal-â‹¯</ci>
        <cerror>
         <csymbol cd="ambiguous">fragments</csymbol>
         <csymbol cd="unknown">k</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>normal-;</ci>
          <apply>
           <times></times>
           <cn type="integer">2</cn>
           <ci>n</ci>
          </apply>
         </apply>
        </cerror>
       </matrixrow>
       <matrixrow>
        <ci>normal-â‹®</ci>
        <ci>normal-â‹®</ci>
        <ci>normal-â‹±</ci>
        <ci>normal-â‹®</ci>
       </matrixrow>
       <matrixrow>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>k</ci>
         <apply>
          <times></times>
          <ci>n</ci>
          <cn type="integer">1</cn>
         </apply>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>k</ci>
         <apply>
          <times></times>
          <ci>n</ci>
          <cn type="integer">2</cn>
         </apply>
        </apply>
        <ci>normal-â‹¯</ci>
        <cerror>
         <csymbol cd="ambiguous">fragments</csymbol>
         <csymbol cd="unknown">k</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>normal-;</ci>
          <apply>
           <times></times>
           <ci>n</ci>
           <ci>n</ci>
          </apply>
         </apply>
        </cerror>
       </matrixrow>
      </matrix>
      <ci>ğª</ci>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <matrix>
       <matrixrow>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>q</ci>
         <cn type="integer">1</cn>
        </apply>
       </matrixrow>
       <matrixrow>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>q</ci>
         <cn type="integer">2</cn>
        </apply>
       </matrixrow>
       <matrixrow>
        <ci>normal-â‹®</ci>
       </matrixrow>
       <matrixrow>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>q</ci>
         <ci>n</ci>
        </apply>
       </matrixrow>
      </matrix>
      <ci>ğ®</ci>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <matrix>
      <matrixrow>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>u</ci>
         <cn type="integer">1</cn>
        </apply>
        <ci>t</ci>
       </apply>
      </matrixrow>
      <matrixrow>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>u</ci>
         <cn type="integer">2</cn>
        </apply>
        <ci>t</ci>
       </apply>
      </matrixrow>
      <matrixrow>
       <ci>normal-â‹®</ci>
      </matrixrow>
      <matrixrow>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>u</ci>
         <ci>n</ci>
        </apply>
        <ci>t</ci>
       </apply>
      </matrixrow>
     </matrix>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{K}=\begin{bmatrix}k_{11}&k_{12}&\cdots&k;_{1n}\\
k_{21}&k_{22}&\cdots&k;_{2n}\\
\vdots&\vdots&\ddots&\vdots\\
k_{n1}&k_{n2}&\cdots&k;_{nn}\\
\end{bmatrix}\mathbf{q}=\begin{bmatrix}q_{1}\\
q_{2}\\
\vdots\\
q_{n}\end{bmatrix}\mathbf{u}=\begin{bmatrix}u_{1}(t)\\
u_{2}(t)\\
\vdots\\
u_{n}(t)\end{bmatrix}
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Multi-compartment_model:7">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mo>[</mo>
     <mtable>
      <mtr>
       <mtd columnalign="center">
        <mn>1</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>1</mn>
       </mtd>
       <mtd columnalign="center">
        <mi mathvariant="normal">â‹¯</mi>
       </mtd>
       <mtd columnalign="center">
        <mn>1</mn>
       </mtd>
      </mtr>
     </mtable>
     <mo>]</mo>
    </mrow>
    <mi>ğŠ</mi>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mo>[</mo>
    <mtable>
     <mtr>
      <mtd columnalign="center">
       <mn>0</mn>
      </mtd>
      <mtd columnalign="center">
       <mn>0</mn>
      </mtd>
      <mtd columnalign="center">
       <mi mathvariant="normal">â‹¯</mi>
      </mtd>
      <mtd columnalign="center">
       <mn>0</mn>
      </mtd>
     </mtr>
    </mtable>
    <mo>]</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <matrix>
      <matrixrow>
       <cn type="integer">1</cn>
       <cn type="integer">1</cn>
       <ci>normal-â‹¯</ci>
       <cn type="integer">1</cn>
      </matrixrow>
     </matrix>
     <ci>ğŠ</ci>
    </apply>
    <matrix>
     <matrixrow>
      <cn type="integer">0</cn>
      <cn type="integer">0</cn>
      <ci>normal-â‹¯</ci>
      <cn type="integer">0</cn>
     </matrixrow>
    </matrix>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \begin{bmatrix}1&1&\cdots&1\\
\end{bmatrix}\mathbf{K}=\begin{bmatrix}0&0&\cdots&0\\
\end{bmatrix}
  </annotation>
 </semantics>
</math>

 (as the total 'contents' of all compartments is constant in a closed system)</p>

<p>In the special case of a closed system (see below) i.e. where 

<math display="inline" id="Multi-compartment_model:8">
 <semantics>
  <mrow>
   <mi>ğ®</mi>
   <mo>=</mo>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>ğ®</ci>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{u}=0
  </annotation>
 </semantics>
</math>

 then there is a general solution.</p>

<p>

<math display="block" id="Multi-compartment_model:9">
 <semantics>
  <mrow>
   <mi>ğª</mi>
   <mo>=</mo>
   <mrow>
    <mrow>
     <msub>
      <mi>c</mi>
      <mn>1</mn>
     </msub>
     <msup>
      <mi>e</mi>
      <mrow>
       <msub>
        <mi>Î»</mi>
        <mn>1</mn>
       </msub>
       <mi>t</mi>
      </mrow>
     </msup>
     <msub>
      <mi>ğ¯</mi>
      <mn>ğŸ</mn>
     </msub>
    </mrow>
    <mo>+</mo>
    <mrow>
     <msub>
      <mi>c</mi>
      <mn>2</mn>
     </msub>
     <msup>
      <mi>e</mi>
      <mrow>
       <msub>
        <mi>Î»</mi>
        <mn>2</mn>
       </msub>
       <mi>t</mi>
      </mrow>
     </msup>
     <msub>
      <mi>ğ¯</mi>
      <mn>ğŸ</mn>
     </msub>
    </mrow>
    <mo>+</mo>
    <mi mathvariant="normal">â‹¯</mi>
    <mo>+</mo>
    <mrow>
     <msub>
      <mi>c</mi>
      <mi>n</mi>
     </msub>
     <msup>
      <mi>e</mi>
      <mrow>
       <msub>
        <mi>Î»</mi>
        <mi>n</mi>
       </msub>
       <mi>t</mi>
      </mrow>
     </msup>
     <msub>
      <mi>ğ¯</mi>
      <mi>ğ§</mi>
     </msub>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>ğª</ci>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>c</ci>
       <cn type="integer">1</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>e</ci>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>Î»</ci>
         <cn type="integer">1</cn>
        </apply>
        <ci>t</ci>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>ğ¯</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>c</ci>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>e</ci>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>Î»</ci>
         <cn type="integer">2</cn>
        </apply>
        <ci>t</ci>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>ğ¯</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
     <ci>normal-â‹¯</ci>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>c</ci>
       <ci>n</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>e</ci>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>Î»</ci>
         <ci>n</ci>
        </apply>
        <ci>t</ci>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>ğ¯</ci>
       <ci>ğ§</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{q}=c_{1}e^{\lambda_{1}t}\mathbf{v_{1}}+c_{2}e^{\lambda_{2}t}\mathbf{v_%
{2}}+\cdots+c_{n}e^{\lambda_{n}t}\mathbf{v_{n}}
  </annotation>
 </semantics>
</math>

</p>

<p>Where 

<math display="inline" id="Multi-compartment_model:10">
 <semantics>
  <msub>
   <mi>Î»</mi>
   <mn>1</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>Î»</ci>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \lambda_{1}
  </annotation>
 </semantics>
</math>

, 

<math display="inline" id="Multi-compartment_model:11">
 <semantics>
  <msub>
   <mi>Î»</mi>
   <mn>2</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>Î»</ci>
    <cn type="integer">2</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \lambda_{2}
  </annotation>
 </semantics>
</math>

, ... and 

<math display="inline" id="Multi-compartment_model:12">
 <semantics>
  <msub>
   <mi>Î»</mi>
   <mi>n</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>Î»</ci>
    <ci>n</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \lambda_{n}
  </annotation>
 </semantics>
</math>

 are the <a href="Eigenvalues_and_eigenvectors" title="wikilink">eigenvalues</a> of 

<math display="inline" id="Multi-compartment_model:13">
 <semantics>
  <mi>ğŠ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>ğŠ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{K}
  </annotation>
 </semantics>
</math>

; 

<math display="inline" id="Multi-compartment_model:14">
 <semantics>
  <msub>
   <mi>ğ¯</mi>
   <mn>ğŸ</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>ğ¯</ci>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{v_{1}}
  </annotation>
 </semantics>
</math>

, 

<math display="inline" id="Multi-compartment_model:15">
 <semantics>
  <msub>
   <mi>ğ¯</mi>
   <mn>ğŸ</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>ğ¯</ci>
    <cn type="integer">2</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{v_{2}}
  </annotation>
 </semantics>
</math>

, ... and 

<math display="inline" id="Multi-compartment_model:16">
 <semantics>
  <msub>
   <mi>ğ¯</mi>
   <mi>ğ§</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>ğ¯</ci>
    <ci>ğ§</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{v_{n}}
  </annotation>
 </semantics>
</math>

 are the respective <a href="Eigenvalues_and_eigenvectors" title="wikilink">eigenvectors</a> of 

<math display="inline" id="Multi-compartment_model:17">
 <semantics>
  <mi>ğŠ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>ğŠ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{K}
  </annotation>
 </semantics>
</math>

; and 

<math display="inline" id="Multi-compartment_model:18">
 <semantics>
  <msub>
   <mi>c</mi>
   <mn>1</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>c</ci>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   c_{1}
  </annotation>
 </semantics>
</math>

, 

<math display="inline" id="Multi-compartment_model:19">
 <semantics>
  <msub>
   <mi>c</mi>
   <mn>2</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>c</ci>
    <cn type="integer">2</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   c_{2}
  </annotation>
 </semantics>
</math>

, .... and 

<math display="inline" id="Multi-compartment_model:20">
 <semantics>
  <msub>
   <mi>c</mi>
   <mi>n</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>c</ci>
    <ci>n</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   c_{n}
  </annotation>
 </semantics>
</math>

 are constants.</p>

<p>However it can be shown that given the above requirement to ensure the 'contents' of a closed system are constant, then for every pair of <a href="Eigenvalues_and_eigenvectors" title="wikilink">eigenvalue</a> and <a href="Eigenvalues_and_eigenvectors" title="wikilink">eigenvector</a> then either 

<math display="inline" id="Multi-compartment_model:21">
 <semantics>
  <mrow>
   <mi>Î»</mi>
   <mo>=</mo>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>Î»</ci>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \lambda=0
  </annotation>
 </semantics>
</math>

 or 

<math display="inline" id="Multi-compartment_model:22">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mo>[</mo>
     <mtable>
      <mtr>
       <mtd columnalign="center">
        <mn>1</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>1</mn>
       </mtd>
       <mtd columnalign="center">
        <mi mathvariant="normal">â‹¯</mi>
       </mtd>
       <mtd columnalign="center">
        <mn>1</mn>
       </mtd>
      </mtr>
     </mtable>
     <mo>]</mo>
    </mrow>
    <mi>ğ¯</mi>
   </mrow>
   <mo>=</mo>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <matrix>
      <matrixrow>
       <cn type="integer">1</cn>
       <cn type="integer">1</cn>
       <ci>normal-â‹¯</ci>
       <cn type="integer">1</cn>
      </matrixrow>
     </matrix>
     <ci>ğ¯</ci>
    </apply>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \begin{bmatrix}1&1&\cdots&1\\
\end{bmatrix}\mathbf{v}=0
  </annotation>
 </semantics>
</math>

 and also that one <a href="Eigenvalues_and_eigenvectors" title="wikilink">eigenvalue</a> is 0, say 

<math display="inline" id="Multi-compartment_model:23">
 <semantics>
  <msub>
   <mi>Î»</mi>
   <mn>1</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>Î»</ci>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \lambda_{1}
  </annotation>
 </semantics>
</math>

</p>

<p>So</p>

<p>

<math display="block" id="Multi-compartment_model:24">
 <semantics>
  <mrow>
   <mi>ğª</mi>
   <mo>=</mo>
   <mrow>
    <mrow>
     <msub>
      <mi>c</mi>
      <mn>1</mn>
     </msub>
     <msub>
      <mi>ğ¯</mi>
      <mn>ğŸ</mn>
     </msub>
    </mrow>
    <mo>+</mo>
    <mrow>
     <msub>
      <mi>c</mi>
      <mn>2</mn>
     </msub>
     <msup>
      <mi>e</mi>
      <mrow>
       <msub>
        <mi>Î»</mi>
        <mn>2</mn>
       </msub>
       <mi>t</mi>
      </mrow>
     </msup>
     <msub>
      <mi>ğ¯</mi>
      <mn>ğŸ</mn>
     </msub>
    </mrow>
    <mo>+</mo>
    <mi mathvariant="normal">â‹¯</mi>
    <mo>+</mo>
    <mrow>
     <msub>
      <mi>c</mi>
      <mi>n</mi>
     </msub>
     <msup>
      <mi>e</mi>
      <mrow>
       <msub>
        <mi>Î»</mi>
        <mi>n</mi>
       </msub>
       <mi>t</mi>
      </mrow>
     </msup>
     <msub>
      <mi>ğ¯</mi>
      <mi>ğ§</mi>
     </msub>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>ğª</ci>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>c</ci>
       <cn type="integer">1</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>ğ¯</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>c</ci>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>e</ci>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>Î»</ci>
         <cn type="integer">2</cn>
        </apply>
        <ci>t</ci>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>ğ¯</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
     <ci>normal-â‹¯</ci>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>c</ci>
       <ci>n</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>e</ci>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>Î»</ci>
         <ci>n</ci>
        </apply>
        <ci>t</ci>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>ğ¯</ci>
       <ci>ğ§</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{q}=c_{1}\mathbf{v_{1}}+c_{2}e^{\lambda_{2}t}\mathbf{v_{2}}+\cdots+c_{n%
}e^{\lambda_{n}t}\mathbf{v_{n}}
  </annotation>
 </semantics>
</math>

</p>

<p>Where</p>

<p>

<math display="block" id="Multi-compartment_model:25">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mo>[</mo>
     <mtable displaystyle="true">
      <mtr>
       <mtd columnalign="center">
        <mn>1</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>1</mn>
       </mtd>
       <mtd columnalign="center">
        <mi mathvariant="normal">â‹¯</mi>
       </mtd>
       <mtd columnalign="center">
        <mn>1</mn>
       </mtd>
      </mtr>
     </mtable>
     <mo>]</mo>
    </mrow>
    <msub>
     <mi>ğ¯</mi>
     <mi>ğ¢</mi>
    </msub>
   </mrow>
   <mo>=</mo>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <matrix>
      <matrixrow>
       <cn type="integer">1</cn>
       <cn type="integer">1</cn>
       <ci>normal-â‹¯</ci>
       <cn type="integer">1</cn>
      </matrixrow>
     </matrix>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>ğ¯</ci>
      <ci>ğ¢</ci>
     </apply>
    </apply>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \begin{bmatrix}1&1&\cdots&1\\
\end{bmatrix}\mathbf{v_{i}}=0
  </annotation>
 </semantics>
</math>

 for 

<math display="inline" id="Multi-compartment_model:26">
 <semantics>
  <mrow>
   <mi>ğ¢</mi>
   <mo>=</mo>
   <mrow>
    <mn>2</mn>
    <mo>,</mo>
    <mn>3</mn>
    <mo>,</mo>
    <mrow>
     <mi mathvariant="normal">â€¦</mi>
     <mi>n</mi>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>ğ¢</ci>
    <list>
     <cn type="integer">2</cn>
     <cn type="integer">3</cn>
     <apply>
      <times></times>
      <ci>normal-â€¦</ci>
      <ci>n</ci>
     </apply>
    </list>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{i}=2,3,\dots n
  </annotation>
 </semantics>
</math>

</p>

<p>This solution can be rearranged:</p>

<p>

<math display="block" id="Multi-compartment_model:27">
 <semantics>
  <mrow>
   <mi>ğª</mi>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mo maxsize="260%" minsize="260%">[</mo>
     <mrow>
      <mrow>
       <msub>
        <mi>ğ¯</mi>
        <mn>ğŸ</mn>
       </msub>
       <mrow>
        <mo>[</mo>
        <mtable displaystyle="true">
         <mtr>
          <mtd columnalign="center">
           <msub>
            <mi>c</mi>
            <mn>1</mn>
           </msub>
          </mtd>
          <mtd columnalign="center">
           <mn>0</mn>
          </mtd>
          <mtd columnalign="center">
           <mi mathvariant="normal">â‹¯</mi>
          </mtd>
          <mtd columnalign="center">
           <mn>0</mn>
          </mtd>
         </mtr>
        </mtable>
        <mo>]</mo>
       </mrow>
      </mrow>
      <mo>+</mo>
      <mrow>
       <msub>
        <mi>ğ¯</mi>
        <mn>ğŸ</mn>
       </msub>
       <mrow>
        <mo>[</mo>
        <mtable displaystyle="true">
         <mtr>
          <mtd columnalign="center">
           <mn>0</mn>
          </mtd>
          <mtd columnalign="center">
           <msub>
            <mi>c</mi>
            <mn>2</mn>
           </msub>
          </mtd>
          <mtd columnalign="center">
           <mi mathvariant="normal">â‹¯</mi>
          </mtd>
          <mtd columnalign="center">
           <mn>0</mn>
          </mtd>
         </mtr>
        </mtable>
        <mo>]</mo>
       </mrow>
      </mrow>
      <mo>+</mo>
      <mi mathvariant="normal">â€¦</mi>
      <mo>+</mo>
      <mrow>
       <msub>
        <mi>ğ¯</mi>
        <mi>ğ§</mi>
       </msub>
       <mrow>
        <mo>[</mo>
        <mtable displaystyle="true">
         <mtr>
          <mtd columnalign="center">
           <mn>0</mn>
          </mtd>
          <mtd columnalign="center">
           <mn>0</mn>
          </mtd>
          <mtd columnalign="center">
           <mi mathvariant="normal">â‹¯</mi>
          </mtd>
          <mtd columnalign="center">
           <msub>
            <mi>c</mi>
            <mi>n</mi>
           </msub>
          </mtd>
         </mtr>
        </mtable>
        <mo>]</mo>
       </mrow>
      </mrow>
     </mrow>
     <mo maxsize="260%" minsize="260%">]</mo>
    </mrow>
    <mrow>
     <mo>[</mo>
     <mtable displaystyle="true">
      <mtr>
       <mtd columnalign="center">
        <mn>1</mn>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <msup>
         <mi>e</mi>
         <mrow>
          <msub>
           <mi>Î»</mi>
           <mn>2</mn>
          </msub>
          <mi>t</mi>
         </mrow>
        </msup>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mi mathvariant="normal">â‹®</mi>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <msup>
         <mi>e</mi>
         <mrow>
          <msub>
           <mi>Î»</mi>
           <mi>n</mi>
          </msub>
          <mi>t</mi>
         </mrow>
        </msup>
       </mtd>
      </mtr>
     </mtable>
     <mo>]</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>ğª</ci>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="latexml">delimited-[]</csymbol>
      <apply>
       <plus></plus>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>ğ¯</ci>
         <cn type="integer">1</cn>
        </apply>
        <matrix>
         <matrixrow>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>c</ci>
           <cn type="integer">1</cn>
          </apply>
          <cn type="integer">0</cn>
          <ci>normal-â‹¯</ci>
          <cn type="integer">0</cn>
         </matrixrow>
        </matrix>
       </apply>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>ğ¯</ci>
         <cn type="integer">2</cn>
        </apply>
        <matrix>
         <matrixrow>
          <cn type="integer">0</cn>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>c</ci>
           <cn type="integer">2</cn>
          </apply>
          <ci>normal-â‹¯</ci>
          <cn type="integer">0</cn>
         </matrixrow>
        </matrix>
       </apply>
       <ci>normal-â€¦</ci>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>ğ¯</ci>
         <ci>ğ§</ci>
        </apply>
        <matrix>
         <matrixrow>
          <cn type="integer">0</cn>
          <cn type="integer">0</cn>
          <ci>normal-â‹¯</ci>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>c</ci>
           <ci>n</ci>
          </apply>
         </matrixrow>
        </matrix>
       </apply>
      </apply>
     </apply>
     <matrix>
      <matrixrow>
       <cn type="integer">1</cn>
      </matrixrow>
      <matrixrow>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>e</ci>
        <apply>
         <times></times>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>Î»</ci>
          <cn type="integer">2</cn>
         </apply>
         <ci>t</ci>
        </apply>
       </apply>
      </matrixrow>
      <matrixrow>
       <ci>normal-â‹®</ci>
      </matrixrow>
      <matrixrow>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>e</ci>
        <apply>
         <times></times>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>Î»</ci>
          <ci>n</ci>
         </apply>
         <ci>t</ci>
        </apply>
       </apply>
      </matrixrow>
     </matrix>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{q}=\Bigg[\mathbf{v_{1}}\begin{bmatrix}c_{1}&0&\cdots&0\\
\end{bmatrix}+\mathbf{v_{2}}\begin{bmatrix}0&c_{2}&\cdots&0\\
\end{bmatrix}+\dots+\mathbf{v_{n}}\begin{bmatrix}0&0&\cdots&c_{n}\\
\end{bmatrix}\Bigg]\begin{bmatrix}1\\
e^{\lambda_{2}t}\\
\vdots\\
e^{\lambda_{n}t}\\
\end{bmatrix}
  </annotation>
 </semantics>
</math>

</p>

<p>This somewhat inelegant equation demonstrates that all solutions of an <em>n-cell</em> multi-compartment model with constant or no inputs are of the form:</p>

<p>

<math display="block" id="Multi-compartment_model:28">
 <semantics>
  <mrow>
   <mi>ğª</mi>
   <mo>=</mo>
   <mrow>
    <mi>ğ€</mi>
    <mrow>
     <mo>[</mo>
     <mtable displaystyle="true">
      <mtr>
       <mtd columnalign="center">
        <mn>1</mn>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <msup>
         <mi>e</mi>
         <mrow>
          <msub>
           <mi>Î»</mi>
           <mn>2</mn>
          </msub>
          <mi>t</mi>
         </mrow>
        </msup>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mi mathvariant="normal">â‹®</mi>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <msup>
         <mi>e</mi>
         <mrow>
          <msub>
           <mi>Î»</mi>
           <mi>n</mi>
          </msub>
          <mi>t</mi>
         </mrow>
        </msup>
       </mtd>
      </mtr>
     </mtable>
     <mo>]</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>ğª</ci>
    <apply>
     <times></times>
     <ci>ğ€</ci>
     <matrix>
      <matrixrow>
       <cn type="integer">1</cn>
      </matrixrow>
      <matrixrow>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>e</ci>
        <apply>
         <times></times>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>Î»</ci>
          <cn type="integer">2</cn>
         </apply>
         <ci>t</ci>
        </apply>
       </apply>
      </matrixrow>
      <matrixrow>
       <ci>normal-â‹®</ci>
      </matrixrow>
      <matrixrow>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>e</ci>
        <apply>
         <times></times>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>Î»</ci>
          <ci>n</ci>
         </apply>
         <ci>t</ci>
        </apply>
       </apply>
      </matrixrow>
     </matrix>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{q}=\mathbf{A}\begin{bmatrix}1\\
e^{\lambda_{2}t}\\
\vdots\\
e^{\lambda_{n}t}\\
\end{bmatrix}
  </annotation>
 </semantics>
</math>

</p>

<p>Where 

<math display="inline" id="Multi-compartment_model:29">
 <semantics>
  <mi>ğ€</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>ğ€</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{A}
  </annotation>
 </semantics>
</math>

 is a <em>nxn</em> matrix and 

<math display="inline" id="Multi-compartment_model:30">
 <semantics>
  <msub>
   <mi>Î»</mi>
   <mn>2</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>Î»</ci>
    <cn type="integer">2</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \lambda_{2}
  </annotation>
 </semantics>
</math>

, 

<math display="inline" id="Multi-compartment_model:31">
 <semantics>
  <msub>
   <mi>Î»</mi>
   <mn>3</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>Î»</ci>
    <cn type="integer">3</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \lambda_{3}
  </annotation>
 </semantics>
</math>

, ... and 

<math display="inline" id="Multi-compartment_model:32">
 <semantics>
  <msub>
   <mi>Î»</mi>
   <mi>n</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>Î»</ci>
    <ci>n</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \lambda_{n}
  </annotation>
 </semantics>
</math>

 are constants. Where 

<math display="inline" id="Multi-compartment_model:33">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mo>[</mo>
     <mtable>
      <mtr>
       <mtd columnalign="center">
        <mn>1</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>1</mn>
       </mtd>
       <mtd columnalign="center">
        <mi mathvariant="normal">â‹¯</mi>
       </mtd>
       <mtd columnalign="center">
        <mn>1</mn>
       </mtd>
      </mtr>
     </mtable>
     <mo>]</mo>
    </mrow>
    <mi>ğ€</mi>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mo>[</mo>
    <mtable>
     <mtr>
      <mtd columnalign="center">
       <mi>a</mi>
      </mtd>
      <mtd columnalign="center">
       <mn>0</mn>
      </mtd>
      <mtd columnalign="center">
       <mi mathvariant="normal">â‹¯</mi>
      </mtd>
      <mtd columnalign="center">
       <mn>0</mn>
      </mtd>
     </mtr>
    </mtable>
    <mo>]</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <matrix>
      <matrixrow>
       <cn type="integer">1</cn>
       <cn type="integer">1</cn>
       <ci>normal-â‹¯</ci>
       <cn type="integer">1</cn>
      </matrixrow>
     </matrix>
     <ci>ğ€</ci>
    </apply>
    <matrix>
     <matrixrow>
      <ci>a</ci>
      <cn type="integer">0</cn>
      <ci>normal-â‹¯</ci>
      <cn type="integer">0</cn>
     </matrixrow>
    </matrix>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \begin{bmatrix}1&1&\cdots&1\\
\end{bmatrix}\mathbf{A}=\begin{bmatrix}a&0&\cdots&0\\
\end{bmatrix}
  </annotation>
 </semantics>
</math>


</p>
<h2 id="model-topologies">Model topologies</h2>

<p>Generally speaking, as the number of compartments increase, it is challenging both to find the algebraic and numerical solutions of the model. However, there are special cases of models, which rarely exist in nature, when the topologies exhibit certain regularities that the solutions become easier to find. The model can be classified according to the interconnection of cells and input/output characteristics:</p>
<ol>
<li><strong>Closed model</strong>: No sinks or source, lit. all <em>k</em><sub>oi</sub> = 0 and <em>u</em><sub><em>i</em></sub> = 0;</li>
<li><strong>Open model</strong>: There are sinks or/and sources among cells.</li>
<li><strong>Catenary model</strong>: All compartments are arranged in a chain, with each pool connecting only to its neighbors. This model has two or more cells.</li>
<li><strong>Cyclic model</strong>: It's a special case of the catenary model, with three or more cells, in which the first and last cell are connected, i.e. <em>k</em><sub>1<em>n</em></sub> â‰  0 or/and <em>k</em><sub><em>n</em>1</sub> â‰  0.</li>
<li><strong>Mammillary model</strong>: Consists of a central compartment with peripheral compartments connecting to it. There are no interconnections among other compartments.</li>
<li><strong>Reducible model</strong>: It's a set of unconnected models. It bears great resemblance to the computer concept of <strong>forest</strong> as against <strong>trees</strong>.</li>
</ol>
<h2 id="see-also">See also</h2>
<ul>
<li><a href="Mathematical_model" title="wikilink">Mathematical model</a></li>
<li><a href="Biomedical_engineering" title="wikilink">Biomedical engineering</a></li>
<li><a href="Biological_neuron_models#Compartmental_models" title="wikilink">Biological neuron models</a></li>
<li><a href="Compartmental_models_in_epidemiology" title="wikilink">Compartmental models in epidemiology</a></li>
<li><a href="Physiologically-based_pharmacokinetic_modelling" title="wikilink">Physiologically-based pharmacokinetic modelling</a></li>
</ul>
<h2 id="references">References</h2>
<ul>
<li>Godfrey, K., <em>Compartmental Models and Their Application</em>, Academic Press, 1983 (ISBN 0-12-286970-2).</li>
<li>Anderson, D. H., <em>Compartmental Modeling and Tracer Kinetics</em>, Springer-Verlag Lecture Notes in Biomathematics #50, 1983 (ISBN 0-387-12303-2).</li>
<li>Jacquez, J. A, <em>Compartmental Analysis in Biology and Medicine</em>, 2nd ed., The University of Michigan Press, 1985.</li>
<li>Evans, W. C., Linear Systems, Compartmental Modeling, and Estimability Issues in IAQ Studies, in Tichenor, B., <em>Characterizing Sources of Indoor Air Pollution and Related Sink Effects</em>, ASTM STP 1287, pp.Â 239â€“262, 1996 (ISBN 0-8031-2030-3).</li>
</ul>

<p>"</p>

<p><a href="Category:Mathematical_modeling" title="wikilink">Category:Mathematical modeling</a> <a href="Category:Systems_theory" title="wikilink">Category:Systems theory</a></p>
</body>
</html>

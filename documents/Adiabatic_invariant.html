<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="580">Adiabatic invariant</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Adiabatic invariant</h1>
<hr/>

<p>An <strong>adiabatic invariant</strong> is a property of a <a href="physical_system" title="wikilink">physical system</a> that stays constant when changes occur slowly.</p>

<p>In <a class="uri" href="thermodynamics" title="wikilink">thermodynamics</a>, an adiabatic process is a change that occurs without heat flow, and slowly compared to the time to reach equilibrium. In an adiabatic process, the system is in equilibrium at all stages. Under these conditions, the <a class="uri" href="entropy" title="wikilink">entropy</a> is constant.</p>

<p>In <a class="uri" href="mechanics" title="wikilink">mechanics</a>, an adiabatic change is a slow deformation of the <a href="Hamiltonian_(quantum_mechanics)" title="wikilink">Hamiltonian</a>, where the <a href="logarithmic_derivative" title="wikilink">fractional rate of change</a> of the energy is much slower than the orbital frequency. The area enclosed by the different motions in phase space are the <em>adiabatic invariants</em>.</p>

<p>In <a href="quantum_mechanics" title="wikilink">quantum mechanics</a>, an adiabatic change is one that occurs at a rate much slower than the difference in frequency between energy eigenstates. In this case, the energy states of the system do not make transitions, so that the <a href="quantum_number" title="wikilink">quantum number</a> is an adiabatic invariant.</p>

<p>The <a href="old_quantum_theory" title="wikilink">old quantum theory</a> was formulated by equating the quantum number of a system with its classical adiabatic invariant. This determined the form of the <a href="Bohr–Sommerfeld_quantization" title="wikilink">Bohr–Sommerfeld quantization</a> rule: the quantum number is the area in phase space of the classical orbit.</p>
<h2 id="thermodynamics">Thermodynamics</h2>

<p>In thermodynamics, adiabatic changes are those that do not increase the entropy. They occur slowly, and allow heat flow only between objects at the same temperature. For isolated systems, an adiabatic change allows no heat to flow in or out.</p>
<h3 id="adiabatic-expansion-of-an-ideal-gas">Adiabatic expansion of an ideal gas</h3>

<p>If a container with an <a href="ideal_gas" title="wikilink">ideal gas</a> is expanded instantaneously, the temperature of the gas doesn't change at all, because none of the molecules slow down. The molecules keep their kinetic energy, but now the gas occupies a bigger volume. If the container expands slowly, however, so that the ideal gas pressure law holds at any time, gas molecules lose energy at the rate that they do work on the expanding wall. The amount of work they do is the pressure times the area of the wall times the outward displacement, which is the pressure times the change in the volume of the gas:</p>

<p>

<math display="block" id="Adiabatic_invariant:0">
 <semantics>
  <mrow>
   <mrow>
    <mi>d</mi>
    <mi>W</mi>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mi>P</mi>
    <mi>d</mi>
    <mi>V</mi>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mfrac>
     <mrow>
      <mi>N</mi>
      <msub>
       <mi>k</mi>
       <mi>B</mi>
      </msub>
      <mi>T</mi>
     </mrow>
     <mi>V</mi>
    </mfrac>
    <mi>d</mi>
    <mi>V</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <times></times>
      <ci>d</ci>
      <ci>W</ci>
     </apply>
     <apply>
      <times></times>
      <ci>P</ci>
      <ci>d</ci>
      <ci>V</ci>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <apply>
        <times></times>
        <ci>N</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>k</ci>
         <ci>B</ci>
        </apply>
        <ci>T</ci>
       </apply>
       <ci>V</ci>
      </apply>
      <ci>d</ci>
      <ci>V</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   dW=PdV={Nk_{B}T\over V}dV
  </annotation>
 </semantics>
</math>

</p>

<p>If no heat enters the gas, the energy in the gas molecules is decreasing by the same amount. By definition, a gas is ideal when its temperature is only a function of the internal energy per particle, not the volume. So</p>

<p>

<math display="block" id="Adiabatic_invariant:1">
 <semantics>
  <mrow>
   <mrow>
    <mi>d</mi>
    <mi>T</mi>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mfrac>
     <mn>1</mn>
     <mrow>
      <mi>N</mi>
      <msub>
       <mi>C</mi>
       <mi>v</mi>
      </msub>
     </mrow>
    </mfrac>
    <mi>d</mi>
    <mi>E</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>d</ci>
     <ci>T</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <divide></divide>
      <cn type="integer">1</cn>
      <apply>
       <times></times>
       <ci>N</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>C</ci>
        <ci>v</ci>
       </apply>
      </apply>
     </apply>
     <ci>d</ci>
     <ci>E</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   dT={1\over NC_{v}}dE
  </annotation>
 </semantics>
</math>

</p>

<p>Where 

<math display="inline" id="Adiabatic_invariant:2">
 <semantics>
  <msub>
   <mi>C</mi>
   <mi>v</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>C</ci>
    <ci>v</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   C_{v}
  </annotation>
 </semantics>
</math>

 is the specific heat at constant volume. When the change in energy is entirely due to work done on the wall, the change in temperature is given by:</p>

<p>

<math display="block" id="Adiabatic_invariant:3">
 <semantics>
  <mrow>
   <mrow>
    <mi>N</mi>
    <msub>
     <mi>C</mi>
     <mi>v</mi>
    </msub>
    <mi>d</mi>
    <mi>T</mi>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mo>-</mo>
    <mrow>
     <mi>d</mi>
     <mi>W</mi>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mo>-</mo>
    <mrow>
     <mfrac>
      <mrow>
       <mi>N</mi>
       <msub>
        <mi>k</mi>
        <mi>B</mi>
       </msub>
       <mi>T</mi>
      </mrow>
      <mi>V</mi>
     </mfrac>
     <mi>d</mi>
     <mi>V</mi>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <times></times>
      <ci>N</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>C</ci>
       <ci>v</ci>
      </apply>
      <ci>d</ci>
      <ci>T</ci>
     </apply>
     <apply>
      <minus></minus>
      <apply>
       <times></times>
       <ci>d</ci>
       <ci>W</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <minus></minus>
      <apply>
       <times></times>
       <apply>
        <divide></divide>
        <apply>
         <times></times>
         <ci>N</ci>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>k</ci>
          <ci>B</ci>
         </apply>
         <ci>T</ci>
        </apply>
        <ci>V</ci>
       </apply>
       <ci>d</ci>
       <ci>V</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   NC_{v}dT=-dW=-{N{k_{B}}T\over V}dV
  </annotation>
 </semantics>
</math>

</p>

<p>This gives a differential relationship between the changes in temperature and volume, which can be integrated to find the invariant. The constant 

<math display="inline" id="Adiabatic_invariant:4">
 <semantics>
  <msub>
   <mi>k</mi>
   <mi>B</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>k</ci>
    <ci>B</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   k_{B}
  </annotation>
 </semantics>
</math>

 is just a <a href="natural_units" title="wikilink">unit conversion factor</a>, which can be set equal to one:</p>

<p>

<math display="block" id="Adiabatic_invariant:5">
 <semantics>
  <mrow>
   <mrow>
    <mpadded lspace="1.7pt" width="+1.7pt">
     <mi>d</mi>
    </mpadded>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <msub>
       <mi>C</mi>
       <mi>v</mi>
      </msub>
      <mi>N</mi>
      <mrow>
       <mi>log</mi>
       <mi>T</mi>
      </mrow>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mo>-</mo>
    <mrow>
     <mi>d</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mi>N</mi>
       <mrow>
        <mi>log</mi>
        <mi>V</mi>
       </mrow>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>d</ci>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>C</ci>
       <ci>v</ci>
      </apply>
      <ci>N</ci>
      <apply>
       <log></log>
       <ci>T</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <minus></minus>
     <apply>
      <times></times>
      <ci>d</ci>
      <apply>
       <times></times>
       <ci>N</ci>
       <apply>
        <log></log>
        <ci>V</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \,d(C_{v}N\log T)=-d(N\log V)
  </annotation>
 </semantics>
</math>

</p>

<p>So</p>

<p>

<math display="block" id="Adiabatic_invariant:6">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mpadded lspace="1.7pt" width="+1.7pt">
      <mi>C</mi>
     </mpadded>
     <mi>v</mi>
    </msub>
    <mi>N</mi>
    <mrow>
     <mi>log</mi>
     <mi>T</mi>
    </mrow>
   </mrow>
   <mo>+</mo>
   <mrow>
    <mi>N</mi>
    <mrow>
     <mi>log</mi>
     <mi>V</mi>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <plus></plus>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>C</ci>
      <ci>v</ci>
     </apply>
     <ci>N</ci>
     <apply>
      <log></log>
      <ci>T</ci>
     </apply>
    </apply>
    <apply>
     <times></times>
     <ci>N</ci>
     <apply>
      <log></log>
      <ci>V</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \,C_{v}N\log T+N\log V
  </annotation>
 </semantics>
</math>

</p>

<p>is an adiabatic invariant, which is related to the entropy</p>

<p>

<math display="block" id="Adiabatic_invariant:7">
 <semantics>
  <mrow>
   <mpadded lspace="1.7pt" width="+1.7pt">
    <mi>S</mi>
   </mpadded>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mrow>
      <msub>
       <mi>C</mi>
       <mi>v</mi>
      </msub>
      <mi>N</mi>
      <mrow>
       <mi>log</mi>
       <mi>T</mi>
      </mrow>
     </mrow>
     <mo>+</mo>
     <mrow>
      <mi>N</mi>
      <mrow>
       <mi>log</mi>
       <mi>V</mi>
      </mrow>
     </mrow>
    </mrow>
    <mo>-</mo>
    <mrow>
     <mi>N</mi>
     <mrow>
      <mi>log</mi>
      <mi>N</mi>
     </mrow>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mi>N</mi>
    <mrow>
     <mi>log</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mrow>
        <msup>
         <mi>T</mi>
         <msub>
          <mi>C</mi>
          <mi>v</mi>
         </msub>
        </msup>
        <mi>V</mi>
       </mrow>
       <mo>/</mo>
       <mi>N</mi>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <ci>S</ci>
     <apply>
      <minus></minus>
      <apply>
       <plus></plus>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>C</ci>
         <ci>v</ci>
        </apply>
        <ci>N</ci>
        <apply>
         <log></log>
         <ci>T</ci>
        </apply>
       </apply>
       <apply>
        <times></times>
        <ci>N</ci>
        <apply>
         <log></log>
         <ci>V</ci>
        </apply>
       </apply>
      </apply>
      <apply>
       <times></times>
       <ci>N</ci>
       <apply>
        <log></log>
        <ci>N</ci>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <ci>N</ci>
      <apply>
       <log></log>
       <apply>
        <divide></divide>
        <apply>
         <times></times>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>T</ci>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>C</ci>
           <ci>v</ci>
          </apply>
         </apply>
         <ci>V</ci>
        </apply>
        <ci>N</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \,S=C_{v}N\log T+N\log V-N\log N=N\log(T^{C_{v}}V/N)
  </annotation>
 </semantics>
</math>

</p>

<p>So entropy is an adiabatic invariant. The <em>N</em> log(<em>N</em>) term makes the entropy additive, so the entropy of two volumes of gas is the sum of the entropies of each one.</p>

<p>In a molecular interpretation, <em>S</em> is the logarithm of the phase space volume of all gas states with energy <em>E</em>(<em>T</em>) and volume <em>V</em>.</p>

<p>For a monatomic ideal gas, this can easily be seen by writing down the energy,</p>

<p>

<math display="block" id="Adiabatic_invariant:8">
 <semantics>
  <mrow>
   <mi>E</mi>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mfrac>
      <mn>1</mn>
      <mrow>
       <mn>2</mn>
       <mi>m</mi>
      </mrow>
     </mfrac>
     <mrow>
      <munder>
       <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
       <mi>k</mi>
      </munder>
      <msubsup>
       <mi>p</mi>
       <mrow>
        <mi>k</mi>
        <mn>1</mn>
       </mrow>
       <mn>2</mn>
      </msubsup>
     </mrow>
    </mrow>
    <mo>+</mo>
    <msubsup>
     <mi>p</mi>
     <mrow>
      <mi>k</mi>
      <mn>2</mn>
     </mrow>
     <mn>2</mn>
    </msubsup>
    <mo>+</mo>
    <msubsup>
     <mi>p</mi>
     <mrow>
      <mi>k</mi>
      <mn>3</mn>
     </mrow>
     <mn>2</mn>
    </msubsup>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>E</ci>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <apply>
        <times></times>
        <cn type="integer">2</cn>
        <ci>m</ci>
       </apply>
      </apply>
      <apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <ci>k</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>p</ci>
         <apply>
          <times></times>
          <ci>k</ci>
          <cn type="integer">1</cn>
         </apply>
        </apply>
        <cn type="integer">2</cn>
       </apply>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>p</ci>
       <apply>
        <times></times>
        <ci>k</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
      <cn type="integer">2</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>p</ci>
       <apply>
        <times></times>
        <ci>k</ci>
        <cn type="integer">3</cn>
       </apply>
      </apply>
      <cn type="integer">2</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   E={1\over 2m}\sum_{k}p_{k1}^{2}+p_{k2}^{2}+p_{k3}^{2}
  </annotation>
 </semantics>
</math>

</p>

<p>The different internal motions of the gas with total energy <em>E</em> define a sphere, the surface of a 3<em>N</em>-dimensional ball with radius 

<math display="inline" id="Adiabatic_invariant:9">
 <semantics>
  <msqrt>
   <mrow>
    <mn>2</mn>
    <mi>m</mi>
    <mi>E</mi>
   </mrow>
  </msqrt>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <root></root>
    <apply>
     <times></times>
     <cn type="integer">2</cn>
     <ci>m</ci>
     <ci>E</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \scriptstyle\sqrt{2mE}
  </annotation>
 </semantics>
</math>


. The volume of the sphere is</p>

<p>

<math display="block" id="Adiabatic_invariant:10">
 <semantics>
  <mfrac>
   <mrow>
    <mn>2</mn>
    <msup>
     <mi>π</mi>
     <mrow>
      <mrow>
       <mn>3</mn>
       <mi>N</mi>
      </mrow>
      <mo>/</mo>
      <mn>2</mn>
     </mrow>
    </msup>
    <msup>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mn>2</mn>
       <mi>m</mi>
       <mi>E</mi>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <mstyle scriptlevel="+1">
      <mfrac>
       <mrow>
        <mrow>
         <mn>3</mn>
         <mi>N</mi>
        </mrow>
        <mo>-</mo>
        <mn>1</mn>
       </mrow>
       <mn>2</mn>
      </mfrac>
     </mstyle>
    </msup>
   </mrow>
   <mrow>
    <mi mathvariant="normal">Γ</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mrow>
       <mn>3</mn>
       <mi>N</mi>
      </mrow>
      <mo>/</mo>
      <mn>2</mn>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mfrac>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <divide></divide>
    <apply>
     <times></times>
     <cn type="integer">2</cn>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>π</ci>
      <apply>
       <divide></divide>
       <apply>
        <times></times>
        <cn type="integer">3</cn>
        <ci>N</ci>
       </apply>
       <cn type="integer">2</cn>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <times></times>
       <cn type="integer">2</cn>
       <ci>m</ci>
       <ci>E</ci>
      </apply>
      <apply>
       <divide></divide>
       <apply>
        <minus></minus>
        <apply>
         <times></times>
         <cn type="integer">3</cn>
         <ci>N</ci>
        </apply>
        <cn type="integer">1</cn>
       </apply>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
    <apply>
     <times></times>
     <ci>normal-Γ</ci>
     <apply>
      <divide></divide>
      <apply>
       <times></times>
       <cn type="integer">3</cn>
       <ci>N</ci>
      </apply>
      <cn type="integer">2</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   {2\pi^{3N/2}(2mE)^{{3N-1}\over 2}}\over{\Gamma(3N/2)}
  </annotation>
 </semantics>
</math>

,</p>

<p>where 

<math display="inline" id="Adiabatic_invariant:11">
 <semantics>
  <mi mathvariant="normal">Γ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>normal-Γ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Gamma
  </annotation>
 </semantics>
</math>

 is the <a href="Gamma_function" title="wikilink">Gamma function</a>.</p>

<p>Since each gas molecule can be anywhere within the volume <em>V</em>, the volume in phase space occupied by the gas states with energy <em>E</em> is</p>

<p>

<math display="block" id="Adiabatic_invariant:12">
 <semantics>
  <mfrac>
   <mrow>
    <mn>2</mn>
    <msup>
     <mi>π</mi>
     <mrow>
      <mrow>
       <mn>3</mn>
       <mi>N</mi>
      </mrow>
      <mo>/</mo>
      <mn>2</mn>
     </mrow>
    </msup>
    <msup>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mn>2</mn>
       <mi>m</mi>
       <mi>E</mi>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <mstyle scriptlevel="+1">
      <mfrac>
       <mrow>
        <mrow>
         <mn>3</mn>
         <mi>N</mi>
        </mrow>
        <mo>-</mo>
        <mn>1</mn>
       </mrow>
       <mn>2</mn>
      </mfrac>
     </mstyle>
    </msup>
    <msup>
     <mi>V</mi>
     <mi>N</mi>
    </msup>
   </mrow>
   <mrow>
    <mi mathvariant="normal">Γ</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mrow>
       <mn>3</mn>
       <mi>N</mi>
      </mrow>
      <mo>/</mo>
      <mn>2</mn>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mfrac>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <divide></divide>
    <apply>
     <times></times>
     <cn type="integer">2</cn>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>π</ci>
      <apply>
       <divide></divide>
       <apply>
        <times></times>
        <cn type="integer">3</cn>
        <ci>N</ci>
       </apply>
       <cn type="integer">2</cn>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <times></times>
       <cn type="integer">2</cn>
       <ci>m</ci>
       <ci>E</ci>
      </apply>
      <apply>
       <divide></divide>
       <apply>
        <minus></minus>
        <apply>
         <times></times>
         <cn type="integer">3</cn>
         <ci>N</ci>
        </apply>
        <cn type="integer">1</cn>
       </apply>
       <cn type="integer">2</cn>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>V</ci>
      <ci>N</ci>
     </apply>
    </apply>
    <apply>
     <times></times>
     <ci>normal-Γ</ci>
     <apply>
      <divide></divide>
      <apply>
       <times></times>
       <cn type="integer">3</cn>
       <ci>N</ci>
      </apply>
      <cn type="integer">2</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   {2\pi^{3N/2}(2mE)^{{3N-1}\over 2}}V^{N}\over{\Gamma(3N/2)}
  </annotation>
 </semantics>
</math>

.</p>

<p>Since the <em>N</em> gas molecules are indistinguishable, the phase space volume is divided by 

<math display="inline" id="Adiabatic_invariant:13">
 <semantics>
  <mrow>
   <mrow>
    <mi>N</mi>
    <mo lspace="0pt" rspace="3.5pt">!</mo>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mi mathvariant="normal">Γ</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>N</mi>
      <mo>+</mo>
      <mn>1</mn>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <factorial></factorial>
     <ci>N</ci>
    </apply>
    <apply>
     <times></times>
     <ci>normal-Γ</ci>
     <apply>
      <plus></plus>
      <ci>N</ci>
      <cn type="integer">1</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   N!=\Gamma(N+1)
  </annotation>
 </semantics>
</math>

, the number of permutations of <em>N</em> molecules.</p>

<p>Using <a href="Stirling's_approximation" title="wikilink">Stirling's approximation</a> for the gamma function, and ignoring factors that disappear in the logarithm after taking <em>N</em> large,</p>

<p>

<math display="block" id="Adiabatic_invariant:14">
 <semantics>
  <mrow>
   <mi>S</mi>
   <mo>=</mo>
   <mrow>
    <mi>N</mi>
    <mrow>
     <mo maxsize="120%" minsize="120%">(</mo>
     <mrow>
      <mrow>
       <mrow>
        <mrow>
         <mrow>
          <mn>3</mn>
          <mo>/</mo>
          <mn>2</mn>
         </mrow>
         <mi>l</mi>
         <mi>o</mi>
         <mi>g</mi>
         <mrow>
          <mo stretchy="false">(</mo>
          <mi>E</mi>
          <mo stretchy="false">)</mo>
         </mrow>
        </mrow>
        <mo>-</mo>
        <mrow>
         <mrow>
          <mn>3</mn>
          <mo>/</mo>
          <mn>2</mn>
         </mrow>
         <mi>l</mi>
         <mi>o</mi>
         <mi>g</mi>
         <mrow>
          <mo stretchy="false">(</mo>
          <mrow>
           <mrow>
            <mn>3</mn>
            <mi>N</mi>
           </mrow>
           <mo>/</mo>
           <mn>2</mn>
          </mrow>
          <mo stretchy="false">)</mo>
         </mrow>
        </mrow>
       </mrow>
       <mo>+</mo>
       <mrow>
        <mi>l</mi>
        <mi>o</mi>
        <mi>g</mi>
        <mrow>
         <mo stretchy="false">(</mo>
         <mi>V</mi>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
      </mrow>
      <mo>-</mo>
      <mrow>
       <mi>l</mi>
       <mi>o</mi>
       <mi>g</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>N</mi>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
     </mrow>
     <mo maxsize="120%" minsize="120%">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>S</ci>
    <apply>
     <times></times>
     <ci>N</ci>
     <apply>
      <minus></minus>
      <apply>
       <plus></plus>
       <apply>
        <minus></minus>
        <apply>
         <times></times>
         <apply>
          <divide></divide>
          <cn type="integer">3</cn>
          <cn type="integer">2</cn>
         </apply>
         <ci>l</ci>
         <ci>o</ci>
         <ci>g</ci>
         <ci>E</ci>
        </apply>
        <apply>
         <times></times>
         <apply>
          <divide></divide>
          <cn type="integer">3</cn>
          <cn type="integer">2</cn>
         </apply>
         <ci>l</ci>
         <ci>o</ci>
         <ci>g</ci>
         <apply>
          <divide></divide>
          <apply>
           <times></times>
           <cn type="integer">3</cn>
           <ci>N</ci>
          </apply>
          <cn type="integer">2</cn>
         </apply>
        </apply>
       </apply>
       <apply>
        <times></times>
        <ci>l</ci>
        <ci>o</ci>
        <ci>g</ci>
        <ci>V</ci>
       </apply>
      </apply>
      <apply>
       <times></times>
       <ci>l</ci>
       <ci>o</ci>
       <ci>g</ci>
       <ci>N</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   S=N\big(3/2log(E)-3/2log(3N/2)+log(V)-log(N)\big)
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Adiabatic_invariant:15">
 <semantics>
  <mrow>
   <mi></mi>
   <mo>=</mo>
   <mrow>
    <mi>N</mi>
    <mrow>
     <mo maxsize="120%" minsize="120%">(</mo>
     <mrow>
      <mrow>
       <mrow>
        <mn>3</mn>
        <mo>/</mo>
        <mn>2</mn>
       </mrow>
       <mi>l</mi>
       <mi>o</mi>
       <mi>g</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mrow>
          <mstyle displaystyle="false" scriptlevel="+1">
           <mfrac>
            <mn>2</mn>
            <mn>3</mn>
           </mfrac>
          </mstyle>
          <mi>E</mi>
         </mrow>
         <mo>/</mo>
         <mi>N</mi>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
      <mo>+</mo>
      <mrow>
       <mi>l</mi>
       <mi>o</mi>
       <mi>g</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mi>V</mi>
         <mo>/</mo>
         <mi>N</mi>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
     </mrow>
     <mo maxsize="120%" minsize="120%">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <csymbol cd="latexml">absent</csymbol>
    <apply>
     <times></times>
     <ci>N</ci>
     <apply>
      <plus></plus>
      <apply>
       <times></times>
       <apply>
        <divide></divide>
        <cn type="integer">3</cn>
        <cn type="integer">2</cn>
       </apply>
       <ci>l</ci>
       <ci>o</ci>
       <ci>g</ci>
       <apply>
        <divide></divide>
        <apply>
         <times></times>
         <apply>
          <divide></divide>
          <cn type="integer">2</cn>
          <cn type="integer">3</cn>
         </apply>
         <ci>E</ci>
        </apply>
        <ci>N</ci>
       </apply>
      </apply>
      <apply>
       <times></times>
       <ci>l</ci>
       <ci>o</ci>
       <ci>g</ci>
       <apply>
        <divide></divide>
        <ci>V</ci>
        <ci>N</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   =N\big(3/2log(\scriptstyle{\frac{2}{3}}\displaystyle E/N)+log(V/N)\big)
  </annotation>
 </semantics>
</math>

</p>

<p>Since the specific heat of a monatomic gas is 3/2, this is the same as the thermodynamic formula for the entropy.</p>
<h3 id="wiens-law-adiabatic-expansion-of-a-box-of-light">Wien's law – adiabatic expansion of a box of light</h3>

<p>For a box of radiation, ignoring quantum mechanics, the energy of a classical field in thermal equilibrium is <a href="ultraviolet_catastrophe" title="wikilink">infinite</a>, since <a class="uri" href="equipartition" title="wikilink">equipartition</a> demands that each field mode has an equal energy on average and there are infinitely many modes. This is physically ridiculous, since it means that all energy leaks into high frequency electromagnetic waves over time.</p>

<p>Still, without quantum mechanics, there are some things that can be said about the equilibrium distribution from thermodynamics alone, because there is still a notion of adiabatic invariance that relates boxes of different size.</p>

<p>When a box is slowly expanded, the frequency of the light recoiling from the wall can be computed from the <a href="Doppler_shift" title="wikilink">Doppler shift</a>. If the wall is not moving, the light recoils at the same frequency. If the wall is moving slowly, the recoil frequency is only equal in the frame where the wall is stationary. In the frame where the wall is moving away from the light, the light coming in is bluer than the light coming out by twice the Doppler shift factor <em>v</em>/<em>c</em>.</p>

<p>

<math display="block" id="Adiabatic_invariant:16">
 <semantics>
  <mrow>
   <mrow>
    <mi mathvariant="normal">Δ</mi>
    <mi>f</mi>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mfrac>
     <mrow>
      <mn>2</mn>
      <mi>v</mi>
     </mrow>
     <mi>c</mi>
    </mfrac>
    <mi>f</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>normal-Δ</ci>
     <ci>f</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <divide></divide>
      <apply>
       <times></times>
       <cn type="integer">2</cn>
       <ci>v</ci>
      </apply>
      <ci>c</ci>
     </apply>
     <ci>f</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Delta f={2v\over c}f
  </annotation>
 </semantics>
</math>

</p>

<p>On the other hand, the energy in the light is also decreased when the wall is moving away, because the light is doing work on the wall by radiation pressure. Because the light is reflected, the pressure is equal to twice the momentum carried by light, which is <em>E</em>/<em>c</em>. The rate at which the pressure does work on the wall is found by multiplying by the velocity:</p>

<p>

<math display="block" id="Adiabatic_invariant:17">
 <semantics>
  <mrow>
   <mrow>
    <mpadded lspace="1.7pt" width="+1.7pt">
     <mi mathvariant="normal">Δ</mi>
    </mpadded>
    <mi>E</mi>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mi>v</mi>
    <mfrac>
     <mrow>
      <mn>2</mn>
      <mi>E</mi>
     </mrow>
     <mi>c</mi>
    </mfrac>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>normal-Δ</ci>
     <ci>E</ci>
    </apply>
    <apply>
     <times></times>
     <ci>v</ci>
     <apply>
      <divide></divide>
      <apply>
       <times></times>
       <cn type="integer">2</cn>
       <ci>E</ci>
      </apply>
      <ci>c</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \,\Delta E=v{2E\over c}
  </annotation>
 </semantics>
</math>

</p>

<p>This means that the change in frequency of the light is equal to the work done on the wall by the radiation pressure. The light that is reflected is changed both in frequency and in energy by the same amount:</p>

<p>

<math display="block" id="Adiabatic_invariant:18">
 <semantics>
  <mrow>
   <mfrac>
    <mrow>
     <mi mathvariant="normal">Δ</mi>
     <mi>f</mi>
    </mrow>
    <mi>f</mi>
   </mfrac>
   <mo>=</mo>
   <mfrac>
    <mrow>
     <mi mathvariant="normal">Δ</mi>
     <mi>E</mi>
    </mrow>
    <mi>E</mi>
   </mfrac>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <divide></divide>
     <apply>
      <times></times>
      <ci>normal-Δ</ci>
      <ci>f</ci>
     </apply>
     <ci>f</ci>
    </apply>
    <apply>
     <divide></divide>
     <apply>
      <times></times>
      <ci>normal-Δ</ci>
      <ci>E</ci>
     </apply>
     <ci>E</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   {\Delta f\over f}={\Delta E\over E}
  </annotation>
 </semantics>
</math>

</p>

<p>Since moving the wall slowly should keep a thermal distribution fixed, the probability that the light has energy <em>E</em> at frequency <em>f</em> must only be a function of <em>E</em>/<em>f</em>.</p>

<p>This function cannot be determined from thermodynamic reasoning alone, and Wien guessed at the form that was valid at high frequency. He supposed that the average energy in high frequency modes was suppressed by a Boltzmann-like factor. This is not the expected classical energy in the mode, which is 

<math display="inline" id="Adiabatic_invariant:19">
 <semantics>
  <mrow>
   <mrow>
    <mn>1</mn>
    <mo>/</mo>
    <mn>2</mn>
   </mrow>
   <mi>β</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <divide></divide>
     <cn type="integer">1</cn>
     <cn type="integer">2</cn>
    </apply>
    <ci>β</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   1/2\beta
  </annotation>
 </semantics>
</math>

 by equipartition, but a new and unjustified assumption that fit the high-frequency data.</p>

<p>

<math display="block" id="Adiabatic_invariant:20">
 <semantics>
  <mrow>
   <mrow>
    <mo lspace="4.2pt" stretchy="false">⟨</mo>
    <msub>
     <mi>E</mi>
     <mi>f</mi>
    </msub>
    <mo stretchy="false">⟩</mo>
   </mrow>
   <mo>=</mo>
   <msup>
    <mi>e</mi>
    <mrow>
     <mo>-</mo>
     <mrow>
      <mi>β</mi>
      <mi>h</mi>
      <mi>f</mi>
     </mrow>
    </mrow>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="latexml">delimited-⟨⟩</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>E</ci>
      <ci>f</ci>
     </apply>
    </apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>e</ci>
     <apply>
      <minus></minus>
      <apply>
       <times></times>
       <ci>β</ci>
       <ci>h</ci>
       <ci>f</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \,\langle E_{f}\rangle=e^{-\beta hf}
  </annotation>
 </semantics>
</math>

</p>

<p>When the expectation value is added over all modes in a cavity, this is <a href="Wien_approximation" title="wikilink">Wien's distribution</a>, and it describes the thermodynamic distribution of energy in a classical gas of photons. Wien's Law implicitly assumes that light is statistically composed of packets that change energy and frequency in the same way. The entropy of a Wien gas scales as the volume to the power <em>N</em>, where <em>N</em> is the number of packets. This led Einstein to suggest that light is composed of localizable particles with energy proportional to the frequency. Then the entropy of the Wien gas can be given a statistical interpretation as the number of possible positions that the photons can be in.</p>
<h2 id="classical-mechanics-action-variables">Classical mechanics – action variables</h2>

<p>Suppose that a Hamiltonian is slowly time varying, for example, a one-dimensional harmonic oscillator with a changing frequency.</p>

<p>

<math display="block" id="Adiabatic_invariant:21">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>H</mi>
     <mi>t</mi>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>p</mi>
     <mo>,</mo>
     <mi>x</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mfrac>
     <msup>
      <mi>p</mi>
      <mn>2</mn>
     </msup>
     <mrow>
      <mn>2</mn>
      <mi>m</mi>
     </mrow>
    </mfrac>
    <mo>+</mo>
    <mpadded width="+1.7pt">
     <mfrac>
      <mrow>
       <mi>m</mi>
       <mi>ω</mi>
       <msup>
        <mrow>
         <mo stretchy="false">(</mo>
         <mi>t</mi>
         <mo stretchy="false">)</mo>
        </mrow>
        <mn>2</mn>
       </msup>
       <msup>
        <mi>x</mi>
        <mn>2</mn>
       </msup>
      </mrow>
      <mn>2</mn>
     </mfrac>
    </mpadded>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>H</ci>
      <ci>t</ci>
     </apply>
     <interval closure="open">
      <ci>p</ci>
      <ci>x</ci>
     </interval>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <divide></divide>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>p</ci>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <times></times>
       <cn type="integer">2</cn>
       <ci>m</ci>
      </apply>
     </apply>
     <apply>
      <divide></divide>
      <apply>
       <times></times>
       <ci>m</ci>
       <ci>ω</ci>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>t</ci>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>x</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
      <cn type="integer">2</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   H_{t}(p,x)={p^{2}\over 2m}+{m\omega(t)^{2}x^{2}\over 2}\,
  </annotation>
 </semantics>
</math>

</p>

<p>The <a href="action-angle_variables" title="wikilink">action</a> <em>J</em> of a classical orbit is the area enclosed by the orbit in phase space.</p>

<p>

<math display="block" id="Adiabatic_invariant:22">
 <semantics>
  <mrow>
   <mi>J</mi>
   <mo>=</mo>
   <mrow>
    <msubsup>
     <mo largeop="true" symmetric="true">∫</mo>
     <mn>0</mn>
     <mi>T</mi>
    </msubsup>
    <mrow>
     <mi>p</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>t</mi>
      <mo stretchy="false">)</mo>
     </mrow>
     <mfrac>
      <mrow>
       <mi>d</mi>
       <mi>x</mi>
      </mrow>
      <mrow>
       <mi>d</mi>
       <mi>t</mi>
      </mrow>
     </mfrac>
     <mi>d</mi>
     <mpadded width="+1.7pt">
      <mi>t</mi>
     </mpadded>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>J</ci>
    <apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <int></int>
       <cn type="integer">0</cn>
      </apply>
      <ci>T</ci>
     </apply>
     <apply>
      <times></times>
      <ci>p</ci>
      <ci>t</ci>
      <apply>
       <divide></divide>
       <apply>
        <times></times>
        <ci>d</ci>
        <ci>x</ci>
       </apply>
       <apply>
        <times></times>
        <ci>d</ci>
        <ci>t</ci>
       </apply>
      </apply>
      <ci>d</ci>
      <ci>t</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   J=\int_{0}^{T}p(t){dx\over dt}dt\,
  </annotation>
 </semantics>
</math>

</p>

<p>Since <em>J</em> is an integral over a full period, it is only a function of the energy. When the Hamiltonian is constant in time and <em>J</em> is constant in time, the canonically conjugate variable 

<math display="inline" id="Adiabatic_invariant:23">
 <semantics>
  <mi>θ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>θ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \theta
  </annotation>
 </semantics>
</math>

 increases in time at a steady rate.</p>

<p>

<math display="block" id="Adiabatic_invariant:24">
 <semantics>
  <mrow>
   <mfrac>
    <mrow>
     <mi>d</mi>
     <mi>θ</mi>
    </mrow>
    <mrow>
     <mi>d</mi>
     <mi>t</mi>
    </mrow>
   </mfrac>
   <mo>=</mo>
   <mfrac>
    <mrow>
     <mo>∂</mo>
     <mi>H</mi>
    </mrow>
    <mrow>
     <mo>∂</mo>
     <mi>J</mi>
    </mrow>
   </mfrac>
   <mo>=</mo>
   <mrow>
    <msup>
     <mi>H</mi>
     <mo>′</mo>
    </msup>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>J</mi>
     <mo rspace="4.2pt" stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <divide></divide>
      <apply>
       <times></times>
       <ci>d</ci>
       <ci>θ</ci>
      </apply>
      <apply>
       <times></times>
       <ci>d</ci>
       <ci>t</ci>
      </apply>
     </apply>
     <apply>
      <divide></divide>
      <apply>
       <partialdiff></partialdiff>
       <ci>H</ci>
      </apply>
      <apply>
       <partialdiff></partialdiff>
       <ci>J</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>H</ci>
       <ci>normal-′</ci>
      </apply>
      <ci>J</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   {d\theta\over dt}={\partial H\over\partial J}=H^{\prime}(J)\,
  </annotation>
 </semantics>
</math>

</p>

<p>So the constant 

<math display="inline" id="Adiabatic_invariant:25">
 <semantics>
  <msup>
   <mi>H</mi>
   <mo>′</mo>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>H</ci>
    <ci>normal-′</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   H^{\prime}
  </annotation>
 </semantics>
</math>

 can be used to change time derivatives along the orbit to partial derivatives with respect to 

<math display="inline" id="Adiabatic_invariant:26">
 <semantics>
  <mi>θ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>θ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \theta
  </annotation>
 </semantics>
</math>

 at constant <em>J</em>. Differentiating the integral for <em>J</em> with respect to <em>J</em> gives an identity that fixes 

<math display="inline" id="Adiabatic_invariant:27">
 <semantics>
  <mrow>
   <msup>
    <mi>H</mi>
    <mo>′</mo>
   </msup>
   <mo>:</mo>
   <mi></mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-:</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>H</ci>
     <ci>normal-′</ci>
    </apply>
    <csymbol cd="latexml">absent</csymbol>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   H^{\prime}:
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Adiabatic_invariant:28">
 <semantics>
  <mrow>
   <mfrac>
    <mrow>
     <mi>d</mi>
     <mi>J</mi>
    </mrow>
    <mrow>
     <mi>d</mi>
     <mi>J</mi>
    </mrow>
   </mfrac>
   <mo>=</mo>
   <mn>1</mn>
   <mo>=</mo>
   <mrow>
    <msubsup>
     <mo largeop="true" symmetric="true">∫</mo>
     <mn>0</mn>
     <mi>T</mi>
    </msubsup>
    <mrow>
     <mrow>
      <mo maxsize="210%" minsize="210%">(</mo>
      <mrow>
       <mrow>
        <mfrac>
         <mrow>
          <mo>∂</mo>
          <mi>p</mi>
         </mrow>
         <mrow>
          <mo>∂</mo>
          <mi>J</mi>
         </mrow>
        </mfrac>
        <mfrac>
         <mrow>
          <mi>d</mi>
          <mi>x</mi>
         </mrow>
         <mrow>
          <mi>d</mi>
          <mi>t</mi>
         </mrow>
        </mfrac>
       </mrow>
       <mo>+</mo>
       <mrow>
        <mi>p</mi>
        <mfrac>
         <mo>∂</mo>
         <mrow>
          <mo>∂</mo>
          <mi>J</mi>
         </mrow>
        </mfrac>
        <mfrac>
         <mrow>
          <mi>d</mi>
          <mi>x</mi>
         </mrow>
         <mrow>
          <mi>d</mi>
          <mi>t</mi>
         </mrow>
        </mfrac>
       </mrow>
      </mrow>
      <mo maxsize="210%" minsize="210%">)</mo>
     </mrow>
     <mi>d</mi>
     <mi>t</mi>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <msup>
     <mi>H</mi>
     <mo>′</mo>
    </msup>
    <mrow>
     <msubsup>
      <mo largeop="true" symmetric="true">∫</mo>
      <mn>0</mn>
      <mi>T</mi>
     </msubsup>
     <mrow>
      <mrow>
       <mo maxsize="210%" minsize="210%">(</mo>
       <mrow>
        <mrow>
         <mfrac>
          <mrow>
           <mo>∂</mo>
           <mi>p</mi>
          </mrow>
          <mrow>
           <mo>∂</mo>
           <mi>J</mi>
          </mrow>
         </mfrac>
         <mfrac>
          <mrow>
           <mo>∂</mo>
           <mi>x</mi>
          </mrow>
          <mrow>
           <mo>∂</mo>
           <mi>θ</mi>
          </mrow>
         </mfrac>
        </mrow>
        <mo>-</mo>
        <mrow>
         <mfrac>
          <mrow>
           <mo>∂</mo>
           <mi>p</mi>
          </mrow>
          <mrow>
           <mo>∂</mo>
           <mi>θ</mi>
          </mrow>
         </mfrac>
         <mfrac>
          <mrow>
           <mo>∂</mo>
           <mi>x</mi>
          </mrow>
          <mrow>
           <mo>∂</mo>
           <mi>J</mi>
          </mrow>
         </mfrac>
        </mrow>
       </mrow>
       <mo maxsize="210%" minsize="210%">)</mo>
      </mrow>
      <mi>d</mi>
      <mpadded width="+1.7pt">
       <mi>t</mi>
      </mpadded>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <divide></divide>
      <apply>
       <times></times>
       <ci>d</ci>
       <ci>J</ci>
      </apply>
      <apply>
       <times></times>
       <ci>d</ci>
       <ci>J</ci>
      </apply>
     </apply>
     <cn type="integer">1</cn>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <int></int>
        <cn type="integer">0</cn>
       </apply>
       <ci>T</ci>
      </apply>
      <apply>
       <times></times>
       <apply>
        <plus></plus>
        <apply>
         <times></times>
         <apply>
          <divide></divide>
          <apply>
           <partialdiff></partialdiff>
           <ci>p</ci>
          </apply>
          <apply>
           <partialdiff></partialdiff>
           <ci>J</ci>
          </apply>
         </apply>
         <apply>
          <divide></divide>
          <apply>
           <times></times>
           <ci>d</ci>
           <ci>x</ci>
          </apply>
          <apply>
           <times></times>
           <ci>d</ci>
           <ci>t</ci>
          </apply>
         </apply>
        </apply>
        <apply>
         <times></times>
         <ci>p</ci>
         <apply>
          <divide></divide>
          <partialdiff></partialdiff>
          <apply>
           <partialdiff></partialdiff>
           <ci>J</ci>
          </apply>
         </apply>
         <apply>
          <divide></divide>
          <apply>
           <times></times>
           <ci>d</ci>
           <ci>x</ci>
          </apply>
          <apply>
           <times></times>
           <ci>d</ci>
           <ci>t</ci>
          </apply>
         </apply>
        </apply>
       </apply>
       <ci>d</ci>
       <ci>t</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>H</ci>
       <ci>normal-′</ci>
      </apply>
      <apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <int></int>
         <cn type="integer">0</cn>
        </apply>
        <ci>T</ci>
       </apply>
       <apply>
        <times></times>
        <apply>
         <minus></minus>
         <apply>
          <times></times>
          <apply>
           <divide></divide>
           <apply>
            <partialdiff></partialdiff>
            <ci>p</ci>
           </apply>
           <apply>
            <partialdiff></partialdiff>
            <ci>J</ci>
           </apply>
          </apply>
          <apply>
           <divide></divide>
           <apply>
            <partialdiff></partialdiff>
            <ci>x</ci>
           </apply>
           <apply>
            <partialdiff></partialdiff>
            <ci>θ</ci>
           </apply>
          </apply>
         </apply>
         <apply>
          <times></times>
          <apply>
           <divide></divide>
           <apply>
            <partialdiff></partialdiff>
            <ci>p</ci>
           </apply>
           <apply>
            <partialdiff></partialdiff>
            <ci>θ</ci>
           </apply>
          </apply>
          <apply>
           <divide></divide>
           <apply>
            <partialdiff></partialdiff>
            <ci>x</ci>
           </apply>
           <apply>
            <partialdiff></partialdiff>
            <ci>J</ci>
           </apply>
          </apply>
         </apply>
        </apply>
        <ci>d</ci>
        <ci>t</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   {dJ\over dJ}=1=\int_{0}^{T}\bigg({\partial p\over\partial J}{dx\over dt}+p{%
\partial\over\partial J}{dx\over dt}\bigg)dt=H^{\prime}\int_{0}^{T}\bigg({%
\partial p\over\partial J}{\partial x\over\partial\theta}-{\partial p\over%
\partial\theta}{\partial x\over\partial J}\bigg)dt\,
  </annotation>
 </semantics>
</math>

</p>

<p>The integrand is the <a href="Poisson_bracket" title="wikilink">Poisson bracket</a> of <em>x</em> and <em>p</em>. The Poisson bracket of two canonically conjugate quantities like <em>x</em> and <em>p</em> is equal to 1 in any canonical coordinate system. So</p>

<p>

<math display="inline" id="Adiabatic_invariant:29">
 <semantics>
  <mrow>
   <mn>1</mn>
   <mo>=</mo>
   <mrow>
    <msup>
     <mi>H</mi>
     <mo>′</mo>
    </msup>
    <mrow>
     <msubsup>
      <mo largeop="true" symmetric="true">∫</mo>
      <mn>0</mn>
      <mi>T</mi>
     </msubsup>
     <mrow>
      <mrow>
       <mo stretchy="false">{</mo>
       <mi>x</mi>
       <mo>,</mo>
       <mi>p</mi>
       <mo stretchy="false">}</mo>
      </mrow>
      <mi>d</mi>
      <mi>t</mi>
     </mrow>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <msup>
     <mi>H</mi>
     <mo>′</mo>
    </msup>
    <mpadded width="+1.7pt">
     <mi>T</mi>
    </mpadded>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <cn type="integer">1</cn>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>H</ci>
       <ci>normal-′</ci>
      </apply>
      <apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <int></int>
         <cn type="integer">0</cn>
        </apply>
        <ci>T</ci>
       </apply>
       <apply>
        <times></times>
        <set>
         <ci>x</ci>
         <ci>p</ci>
        </set>
        <ci>d</ci>
        <ci>t</ci>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>H</ci>
       <ci>normal-′</ci>
      </apply>
      <ci>T</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   1=H^{\prime}\int_{0}^{T}\{x,p\}dt=H^{\prime}T\,
  </annotation>
 </semantics>
</math>

</p>

<p>and 

<math display="inline" id="Adiabatic_invariant:30">
 <semantics>
  <msup>
   <mi>H</mi>
   <mo>′</mo>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>H</ci>
    <ci>normal-′</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   H^{\prime}
  </annotation>
 </semantics>
</math>

 is the inverse period. The variable 

<math display="inline" id="Adiabatic_invariant:31">
 <semantics>
  <mi>θ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>θ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \theta
  </annotation>
 </semantics>
</math>

 increases by an equal amount in each period for all values of <em>J</em> – it is an angle-variable.</p>
<dl>
<dt>Adiabatic invariance of <em>J</em></dt>
</dl>

<p>The Hamiltonian is a function of <em>J</em> only, and in the simple case of the harmonic oscillator.</p>

<p>

<math display="block" id="Adiabatic_invariant:32">
 <semantics>
  <mrow>
   <mpadded lspace="1.7pt" width="+1.7pt">
    <mi>H</mi>
   </mpadded>
   <mo>=</mo>
   <mrow>
    <mi>ω</mi>
    <mpadded width="+1.7pt">
     <mi>J</mi>
    </mpadded>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>H</ci>
    <apply>
     <times></times>
     <ci>ω</ci>
     <ci>J</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \,H=\omega J\,
  </annotation>
 </semantics>
</math>

</p>

<p>When <em>H</em> has no time dependence, <em>J</em> is constant. When <em>H</em> is slowly time varying, the rate of change of <em>J</em> can be computed by re-expressing the integral for <em>J</em></p>

<p>

<math display="block" id="Adiabatic_invariant:33">
 <semantics>
  <mrow>
   <mi>J</mi>
   <mo>=</mo>
   <mrow>
    <msubsup>
     <mo largeop="true" symmetric="true">∫</mo>
     <mn>0</mn>
     <mrow>
      <mn>2</mn>
      <mi>π</mi>
     </mrow>
    </msubsup>
    <mrow>
     <mi>p</mi>
     <mfrac>
      <mrow>
       <mo>∂</mo>
       <mi>x</mi>
      </mrow>
      <mrow>
       <mo>∂</mo>
       <mi>θ</mi>
      </mrow>
     </mfrac>
     <mi>d</mi>
     <mpadded width="+1.7pt">
      <mi>θ</mi>
     </mpadded>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>J</ci>
    <apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <int></int>
       <cn type="integer">0</cn>
      </apply>
      <apply>
       <times></times>
       <cn type="integer">2</cn>
       <ci>π</ci>
      </apply>
     </apply>
     <apply>
      <times></times>
      <ci>p</ci>
      <apply>
       <divide></divide>
       <apply>
        <partialdiff></partialdiff>
        <ci>x</ci>
       </apply>
       <apply>
        <partialdiff></partialdiff>
        <ci>θ</ci>
       </apply>
      </apply>
      <ci>d</ci>
      <ci>θ</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   J=\int_{0}^{2\pi}p{\partial x\over\partial\theta}d\theta\,
  </annotation>
 </semantics>
</math>

</p>

<p>The time derivative of this quantity is</p>

<p>

<math display="block" id="Adiabatic_invariant:34">
 <semantics>
  <mrow>
   <mfrac>
    <mrow>
     <mi>d</mi>
     <mi>J</mi>
    </mrow>
    <mrow>
     <mi>d</mi>
     <mi>t</mi>
    </mrow>
   </mfrac>
   <mo>=</mo>
   <mrow>
    <msubsup>
     <mo largeop="true" symmetric="true">∫</mo>
     <mn>0</mn>
     <mrow>
      <mn>2</mn>
      <mi>π</mi>
     </mrow>
    </msubsup>
    <mrow>
     <mrow>
      <mo maxsize="210%" minsize="210%">(</mo>
      <mrow>
       <mrow>
        <mfrac>
         <mrow>
          <mi>d</mi>
          <mi>p</mi>
         </mrow>
         <mrow>
          <mi>d</mi>
          <mi>t</mi>
         </mrow>
        </mfrac>
        <mfrac>
         <mrow>
          <mo>∂</mo>
          <mi>x</mi>
         </mrow>
         <mrow>
          <mo>∂</mo>
          <mi>θ</mi>
         </mrow>
        </mfrac>
       </mrow>
       <mo>+</mo>
       <mrow>
        <mi>p</mi>
        <mfrac>
         <mi>d</mi>
         <mrow>
          <mi>d</mi>
          <mi>t</mi>
         </mrow>
        </mfrac>
        <mfrac>
         <mrow>
          <mo>∂</mo>
          <mi>x</mi>
         </mrow>
         <mrow>
          <mo>∂</mo>
          <mi>θ</mi>
         </mrow>
        </mfrac>
       </mrow>
      </mrow>
      <mo maxsize="210%" minsize="210%">)</mo>
     </mrow>
     <mi>d</mi>
     <mpadded width="+1.7pt">
      <mi>θ</mi>
     </mpadded>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <divide></divide>
     <apply>
      <times></times>
      <ci>d</ci>
      <ci>J</ci>
     </apply>
     <apply>
      <times></times>
      <ci>d</ci>
      <ci>t</ci>
     </apply>
    </apply>
    <apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <int></int>
       <cn type="integer">0</cn>
      </apply>
      <apply>
       <times></times>
       <cn type="integer">2</cn>
       <ci>π</ci>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <plus></plus>
       <apply>
        <times></times>
        <apply>
         <divide></divide>
         <apply>
          <times></times>
          <ci>d</ci>
          <ci>p</ci>
         </apply>
         <apply>
          <times></times>
          <ci>d</ci>
          <ci>t</ci>
         </apply>
        </apply>
        <apply>
         <divide></divide>
         <apply>
          <partialdiff></partialdiff>
          <ci>x</ci>
         </apply>
         <apply>
          <partialdiff></partialdiff>
          <ci>θ</ci>
         </apply>
        </apply>
       </apply>
       <apply>
        <times></times>
        <ci>p</ci>
        <apply>
         <divide></divide>
         <ci>d</ci>
         <apply>
          <times></times>
          <ci>d</ci>
          <ci>t</ci>
         </apply>
        </apply>
        <apply>
         <divide></divide>
         <apply>
          <partialdiff></partialdiff>
          <ci>x</ci>
         </apply>
         <apply>
          <partialdiff></partialdiff>
          <ci>θ</ci>
         </apply>
        </apply>
       </apply>
      </apply>
      <ci>d</ci>
      <ci>θ</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   {dJ\over dt}=\int_{0}^{2\pi}\bigg({dp\over dt}{\partial x\over\partial\theta}+%
p{d\over dt}{\partial x\over\partial\theta}\bigg)d\theta\,
  </annotation>
 </semantics>
</math>

</p>

<p>Replacing time derivatives with theta derivatives,</p>

<p>

<math display="block" id="Adiabatic_invariant:35">
 <semantics>
  <mrow>
   <mfrac>
    <mrow>
     <mi>d</mi>
     <mi>J</mi>
    </mrow>
    <mrow>
     <mi>d</mi>
     <mi>t</mi>
    </mrow>
   </mfrac>
   <mo>=</mo>
   <mrow>
    <msubsup>
     <mo largeop="true" symmetric="true">∫</mo>
     <mn>0</mn>
     <mrow>
      <mn>2</mn>
      <mi>π</mi>
     </mrow>
    </msubsup>
    <mrow>
     <mrow>
      <mo maxsize="210%" minsize="210%">(</mo>
      <mrow>
       <mrow>
        <mfrac>
         <mrow>
          <mo>∂</mo>
          <mi>p</mi>
         </mrow>
         <mrow>
          <mo>∂</mo>
          <mi>θ</mi>
         </mrow>
        </mfrac>
        <mfrac>
         <mrow>
          <mo>∂</mo>
          <mi>x</mi>
         </mrow>
         <mrow>
          <mo>∂</mo>
          <mi>θ</mi>
         </mrow>
        </mfrac>
       </mrow>
       <mo>+</mo>
       <mrow>
        <mi>p</mi>
        <mfrac>
         <mo>∂</mo>
         <mrow>
          <mo>∂</mo>
          <mi>θ</mi>
         </mrow>
        </mfrac>
        <mfrac>
         <mrow>
          <mo>∂</mo>
          <mi>x</mi>
         </mrow>
         <mrow>
          <mo>∂</mo>
          <mi>θ</mi>
         </mrow>
        </mfrac>
       </mrow>
      </mrow>
      <mo maxsize="210%" minsize="210%">)</mo>
     </mrow>
     <mi>d</mi>
     <mpadded width="+1.7pt">
      <mi>θ</mi>
     </mpadded>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <divide></divide>
     <apply>
      <times></times>
      <ci>d</ci>
      <ci>J</ci>
     </apply>
     <apply>
      <times></times>
      <ci>d</ci>
      <ci>t</ci>
     </apply>
    </apply>
    <apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <int></int>
       <cn type="integer">0</cn>
      </apply>
      <apply>
       <times></times>
       <cn type="integer">2</cn>
       <ci>π</ci>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <plus></plus>
       <apply>
        <times></times>
        <apply>
         <divide></divide>
         <apply>
          <partialdiff></partialdiff>
          <ci>p</ci>
         </apply>
         <apply>
          <partialdiff></partialdiff>
          <ci>θ</ci>
         </apply>
        </apply>
        <apply>
         <divide></divide>
         <apply>
          <partialdiff></partialdiff>
          <ci>x</ci>
         </apply>
         <apply>
          <partialdiff></partialdiff>
          <ci>θ</ci>
         </apply>
        </apply>
       </apply>
       <apply>
        <times></times>
        <ci>p</ci>
        <apply>
         <divide></divide>
         <partialdiff></partialdiff>
         <apply>
          <partialdiff></partialdiff>
          <ci>θ</ci>
         </apply>
        </apply>
        <apply>
         <divide></divide>
         <apply>
          <partialdiff></partialdiff>
          <ci>x</ci>
         </apply>
         <apply>
          <partialdiff></partialdiff>
          <ci>θ</ci>
         </apply>
        </apply>
       </apply>
      </apply>
      <ci>d</ci>
      <ci>θ</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   {dJ\over dt}=\int_{0}^{2\pi}\bigg({\partial p\over\partial\theta}{\partial x%
\over\partial\theta}+p{\partial\over\partial\theta}{\partial x\over\partial%
\theta}\bigg)d\theta\,
  </annotation>
 </semantics>
</math>

</p>

<p>So as long as the coordinates <em>J</em>, 

<math display="inline" id="Adiabatic_invariant:36">
 <semantics>
  <mi>θ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>θ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \theta
  </annotation>
 </semantics>
</math>


 do not change appreciably over one period, this expression can be integrated by parts to give zero. This means that for slow variations, there is no lowest order change in the area enclosed by the orbit. This is the adiabatic invariance theorem – the action variables are adiabatic invariants.</p>

<p>For a harmonic oscillator, the area in phase space of an orbit at energy <em>E</em> is the area of the ellipse of constant energy,</p>

<p>

<math display="block" id="Adiabatic_invariant:37">
 <semantics>
  <mrow>
   <mi>E</mi>
   <mo>=</mo>
   <mrow>
    <mfrac>
     <msup>
      <mi>p</mi>
      <mn>2</mn>
     </msup>
     <mrow>
      <mn>2</mn>
      <mi>m</mi>
     </mrow>
    </mfrac>
    <mo>+</mo>
    <mpadded width="+1.7pt">
     <mfrac>
      <mrow>
       <mi>m</mi>
       <msup>
        <mi>ω</mi>
        <mn>2</mn>
       </msup>
       <msup>
        <mi>x</mi>
        <mn>2</mn>
       </msup>
      </mrow>
      <mn>2</mn>
     </mfrac>
    </mpadded>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>E</ci>
    <apply>
     <plus></plus>
     <apply>
      <divide></divide>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>p</ci>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <times></times>
       <cn type="integer">2</cn>
       <ci>m</ci>
      </apply>
     </apply>
     <apply>
      <divide></divide>
      <apply>
       <times></times>
       <ci>m</ci>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>ω</ci>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>x</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
      <cn type="integer">2</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   E={p^{2}\over 2m}+{m\omega^{2}x^{2}\over 2}\,
  </annotation>
 </semantics>
</math>

</p>

<p>The <em>x</em>-radius of this ellipse is 

<math display="inline" id="Adiabatic_invariant:38">
 <semantics>
  <msqrt>
   <mrow>
    <mrow>
     <mrow>
      <mn>2</mn>
      <mi>E</mi>
     </mrow>
     <mo>/</mo>
     <msup>
      <mi>ω</mi>
      <mn>2</mn>
     </msup>
    </mrow>
    <mi>m</mi>
   </mrow>
  </msqrt>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <root></root>
    <apply>
     <times></times>
     <apply>
      <divide></divide>
      <apply>
       <times></times>
       <cn type="integer">2</cn>
       <ci>E</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>ω</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
     <ci>m</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \scriptstyle\sqrt{2E/\omega^{2}m}
  </annotation>
 </semantics>
</math>

, while the <em>p</em>-radius of the ellipse is 

<math display="inline" id="Adiabatic_invariant:39">
 <semantics>
  <msqrt>
   <mrow>
    <mn>2</mn>
    <mi>m</mi>
    <mi>E</mi>
   </mrow>
  </msqrt>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <root></root>
    <apply>
     <times></times>
     <cn type="integer">2</cn>
     <ci>m</ci>
     <ci>E</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \scriptstyle\sqrt{2mE}
  </annotation>
 </semantics>
</math>

. Multiplying, the area is 

<math display="inline" id="Adiabatic_invariant:40">
 <semantics>
  <mrow>
   <mrow>
    <mn>2</mn>
    <mi>π</mi>
    <mi>E</mi>
   </mrow>
   <mo>/</mo>
   <mi>ω</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <divide></divide>
    <apply>
     <times></times>
     <cn type="integer">2</cn>
     <ci>π</ci>
     <ci>E</ci>
    </apply>
    <ci>ω</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   2\pi E/\omega
  </annotation>
 </semantics>
</math>

. So if a pendulum is slowly drawn in, so that the frequency changes, the energy changes by a proportional amount.</p>
<h3 id="old-quantum-theory">Old quantum theory</h3>

<p>After Planck identified that Wien's law can be extended to all frequencies, even very low ones, by interpolating with the classical equipartition law for radiation, physicists wanted to understand the quantum behavior of other systems.</p>

<p>The Planck radiation law quantized the motion of the field oscillators in units of energy proportional to the frequency:</p>

<p>

<math display="block" id="Adiabatic_invariant:41">
 <semantics>
  <mrow>
   <mi>E</mi>
   <mo>=</mo>
   <mrow>
    <mi>h</mi>
    <mi>f</mi>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mi mathvariant="normal">ℏ</mi>
    <mpadded width="+1.7pt">
     <mi>ω</mi>
    </mpadded>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <ci>E</ci>
     <apply>
      <times></times>
      <ci>h</ci>
      <ci>f</ci>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <csymbol cd="latexml">Planck-constant-over-2-pi</csymbol>
      <ci>ω</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   E=hf=\hbar\omega\,
  </annotation>
 </semantics>
</math>

</p>

<p>This is the only sensible quantization. The quantum can only depend on the energy/frequency by adiabatic invariance, and since the energy must be additive when putting boxes end to end, the levels must be equally spaced.</p>

<p>Einstein, followed by Debye, extended the domain of quantum mechanics by considering the sound modes in a solid as <a href="Einstein_solid" title="wikilink">quantized oscillators</a>. This model explained why the specific heat of solids approached zero at low temperatures, instead of staying fixed at 

<math display="inline" id="Adiabatic_invariant:42">
 <semantics>
  <mrow>
   <mn>3</mn>
   <msub>
    <mi>k</mi>
    <mi>B</mi>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <cn type="integer">3</cn>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>k</ci>
     <ci>B</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   3k_{B}
  </annotation>
 </semantics>
</math>

 as predicted by classical <a href="equipartition_theorem" title="wikilink">equipartition</a>.</p>

<p>At the <a href="Solvay_conference" title="wikilink">Solvay conference</a>, the question of quantizing other motions was raised, and <a href="Hendrik_Lorentz" title="wikilink">Lorentz</a> pointed out a problem. If you consider a quantum pendulum whose string is shortened very slowly, the quantum number of the pendulum cannot change because at no point is there a high enough frequency to cause a transition between the states. But the frequency of the pendulum changes when the string is shorter, so the quantum states change energy.</p>

<p>Einstein responded that for slow pulling, the frequency and energy of the pendulum both change but the ratio stays fixed. This is analogous to Wien's observation that under slow motion of the wall the energy to frequency ratio of reflected waves is constant. The conclusion was that the quantities to quantize must be adiabatic invariants.</p>

<p>This line of argument was extended by Sommerfeld into a general theory: the quantum number of an arbitrary mechanical system is given by the adiabatic action variable. Since the action variable in the harmonic oscillator is an integer, the general condition is:</p>

<p>

<math display="block" id="Adiabatic_invariant:43">
 <semantics>
  <mrow>
   <mrow>
    <mo largeop="true" symmetric="true">∫</mo>
    <mrow>
     <mi>p</mi>
     <mi>d</mi>
     <mi>q</mi>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mi>n</mi>
    <mpadded width="+1.7pt">
     <mi>h</mi>
    </mpadded>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <int></int>
     <apply>
      <times></times>
      <ci>p</ci>
      <ci>d</ci>
      <ci>q</ci>
     </apply>
    </apply>
    <apply>
     <times></times>
     <ci>n</ci>
     <ci>h</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \int pdq=nh\,
  </annotation>
 </semantics>
</math>

</p>

<p>This condition was the foundation of the <a href="old_quantum_theory" title="wikilink">old quantum theory</a>, which was able to predict the qualitative behavior of atomic systems. The theory is inexact for small quantum numbers, since it mixes classical and quantum concepts. But it was a useful half-way step to the <a href="matrix_mechanics" title="wikilink">new quantum theory</a>.</p>
<h2 id="plasma-physics">Plasma physics</h2>

<p>In <a href="plasma_physics" title="wikilink">plasma physics</a> there are three adiabatic invariants of charged particle motion.</p>
<h3 id="the-first-adiabatic-invariant-μ">The first adiabatic invariant, μ</h3>

<p>The <strong>magnetic moment</strong> of a gyrating particle,</p>

<p>

<math display="block" id="Adiabatic_invariant:44">
 <semantics>
  <mrow>
   <mi>μ</mi>
   <mo>=</mo>
   <mfrac>
    <mrow>
     <mi>m</mi>
     <msubsup>
      <mi>v</mi>
      <mo>⟂</mo>
      <mn>2</mn>
     </msubsup>
    </mrow>
    <mrow>
     <mn>2</mn>
     <mi>B</mi>
    </mrow>
   </mfrac>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>μ</ci>
    <apply>
     <divide></divide>
     <apply>
      <times></times>
      <ci>m</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>v</ci>
        <csymbol cd="latexml">perpendicular-to</csymbol>
       </apply>
       <cn type="integer">2</cn>
      </apply>
     </apply>
     <apply>
      <times></times>
      <cn type="integer">2</cn>
      <ci>B</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mu=\frac{mv_{\perp}^{2}}{2B}
  </annotation>
 </semantics>
</math>

</p>

<p>is a constant of the motion to all orders in an expansion in 

<math display="inline" id="Adiabatic_invariant:45">
 <semantics>
  <mrow>
   <mi>ω</mi>
   <mo>/</mo>
   <msub>
    <mi>ω</mi>
    <mi>c</mi>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <divide></divide>
    <ci>ω</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>ω</ci>
     <ci>c</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \omega/\omega_{c}
  </annotation>
 </semantics>
</math>

, where 

<math display="inline" id="Adiabatic_invariant:46">
 <semantics>
  <mi>ω</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>ω</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \omega
  </annotation>
 </semantics>
</math>

 is the rate of any changes experienced by the particle, e.g., due to collisions or due to temporal or spatial variations in the magnetic field. Consequently the magnetic moment remains nearly constant even for changes at rates approaching the gyrofrequency. When μ is constant, the perpendicular particle energy is proportional to <em>B</em>, so the particles can be heated by increasing <em>B</em>, but this is a 'one shot' deal because the field cannot be increased indefinitely. It finds applications in <a href="magnetic_mirror" title="wikilink">magnetic mirrors</a> and <a href="magnetic_bottle" title="wikilink">magnetic bottles</a>.</p>

<p>There are some important situations in which the magnetic moment is <em>not</em> invariant:</p>
<ul>
<li><strong><a href="Magnetic_pumping" title="wikilink">Magnetic pumping</a>:</strong> If the collision frequency is larger than the pump frequency, μ is no longer conserved. In particular, collisions allow net heating by transferring some of the perpendicular energy to parallel energy.</li>
<li><strong><a href="Cyclotron_heating" title="wikilink">Cyclotron heating</a>:</strong> If <em>B</em> is oscillated at the cyclotron frequency, the condition for adiabatic invariance is violated and heating is possible. In particular, the induced electric field rotates in phase with some of the particles and continuously accelerates them.</li>
<li><strong><a href="Magnetic_cusps" title="wikilink">Magnetic cusps</a>:</strong> The magnetic field at the center of a cusp vanishes, so the cyclotron frequency is automatically smaller than the rate of <em>any</em> changes. Thus the magnetic moment is not conserved and particles are scattered relatively easily into the <a href="Magnetic_mirror" title="wikilink">loss cone</a>.</li>
</ul>
<h3 id="the-second-adiabatic-invariant-j">The second adiabatic invariant, <em>J</em></h3>

<p>The <strong>longitudinal invariant</strong> of a particle trapped in a <a href="magnetic_mirror" title="wikilink">magnetic mirror</a>,</p>

<p>

<math display="block" id="Adiabatic_invariant:47">
 <semantics>
  <mrow>
   <mi>J</mi>
   <mo>=</mo>
   <mrow>
    <msubsup>
     <mo largeop="true" symmetric="true">∫</mo>
     <mi>a</mi>
     <mi>b</mi>
    </msubsup>
    <mrow>
     <msub>
      <mi>p</mi>
      <mo>∥</mo>
     </msub>
     <mi>d</mi>
     <mi>s</mi>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>J</ci>
    <apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <int></int>
       <ci>a</ci>
      </apply>
      <ci>b</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>p</ci>
       <csymbol cd="latexml">parallel-to</csymbol>
      </apply>
      <ci>d</ci>
      <ci>s</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   J=\int_{a}^{b}p_{\parallel}ds
  </annotation>
 </semantics>
</math>

</p>

<p>where the integral is between the two turning points, is also an adiabatic invariant. This guarantees, for example, that a particle in the <a class="uri" href="magnetosphere" title="wikilink">magnetosphere</a> moving around the Earth always returns to the same line of force. The adiabatic condition is violated in <strong><a href="transit-time_magnetic_pumping" title="wikilink">transit-time magnetic pumping</a></strong>, where the length of a magnetic mirror is oscillated at the bounce frequency, resulting in net heating.</p>
<h3 id="the-third-adiabatic-invariant-φ">The third adiabatic invariant, Φ</h3>

<p>The total magnetic flux Φ enclosed by a drift surface is the third adiabatic invariant, associated with the periodic motion of mirror-trapped particles drifting around the axis of the system. Because this drift motion is relatively slow, Φ is often not conserved in practical applications.</p>
<h2 id="references">References</h2>
<ul>
<li>

<p>§10</p></li>
<li>

<p>pp. 85–89</p></li>
</ul>
<h2 id="external-links">External links</h2>
<ul>
<li><a href="http://farside.ph.utexas.edu/teaching/plasma/lectures/node24.html">lecture notes on the second adiabatic invariant</a></li>
<li><a href="http://farside.ph.utexas.edu/teaching/plasma/lectures/node25.html">lecture notes on the third adiabatic invariant</a></li>
</ul>

<p>"</p>

<p><a href="Category:Classical_mechanics" title="wikilink">Category:Classical mechanics</a> <a href="Category:Quantum_mechanics" title="wikilink">Category:Quantum mechanics</a> <a class="uri" href="Category:Thermodynamics" title="wikilink">Category:Thermodynamics</a> <a href="Category:Plasma_physics" title="wikilink">Category:Plasma physics</a> <a href="Category:Physical_systems" title="wikilink">Category:Physical systems</a></p>
</body>
</html>

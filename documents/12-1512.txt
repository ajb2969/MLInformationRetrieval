   Matrix differential equation      Matrix differential equation   A differential equation is a mathematical equation for an unknown function of one or several variables that relates the values of the function itself and of its derivatives of various orders. A matrix differential equation contains more than one function stacked into vector form with a matrix relating the functions to their derivatives.  For example, a simple matrix ordinary differential equation is        𝐱  ′    (  t  )    =   𝐀𝐱   (  t  )           superscript  𝐱  normal-′   t     𝐀𝐱  t     \mathbf{x^{\prime}}(t)=\mathbf{Ax}(t)     where x ( t ) is an n ×1 vector of functions of an underlying variable   t   t   t   , x '( t ) is the vector of first derivatives of these functions, and A is an  matrix, of which all elements are constants.  Note that by using the Cayley-Hamilton theorem and Vandermonde -type matrices, a solution may be given in a simple form. 1 Below the solution is displayed in terms of Putzer's algorithm. 2  In the case where A has n distinct eigenvalues, this differential equation has the following general solution:       𝐱   (  t  )    =     c  1    e    λ  1   t     𝐮  1    +    c  2    e    λ  2   t     𝐮  2    +  ⋯  +    c  n    e    λ  n   t     𝐮  n           𝐱  t        subscript  c  1    superscript  e     subscript  λ  1   t     subscript  𝐮  1       subscript  c  2    superscript  e     subscript  λ  2   t     subscript  𝐮  2    normal-⋯     subscript  c  n    superscript  e     subscript  λ  n   t     subscript  𝐮  n       \mathbf{x}(t)=c_{1}e^{\lambda_{1}t}\mathbf{u}_{1}+c_{2}e^{\lambda_{2}t}\mathbf%
 {u}_{2}+\cdots+c_{n}e^{\lambda_{n}t}\mathbf{u}_{n}     where λ 1 , λ 2 , ..., λ n are the eigenvalues of A ; u 1 , u 2 , ..., u n are the respective eigenvectors of A and c 1 , c 2 , ...., c n are constants.  Stability and steady state of the matrix system  The matrix equation      𝐱  ′    (  t  )    =    𝐀𝐱   (  t  )    +  𝐛          superscript  𝐱  normal-′   t       𝐀𝐱  t   𝐛     \mathbf{x}^{\prime}(t)=\mathbf{Ax}(t)+\mathbf{b}   with n ×1 parameter vector b is stable if and only if all eigenvalues of the matrix A have a negative real part. The steady state x* to which it converges if stable is found by setting      𝐱  ′    (  t  )    =  𝟎         superscript  𝐱  normal-′   t   0    \mathbf{x}^{\prime}(t)=\mathbf{0}   , yielding     𝐱  *   =   -    𝐀   -  1    𝐛         superscript  𝐱         superscript  𝐀    1    𝐛      \mathbf{x}^{*}=-\mathbf{A}^{-1}\mathbf{b}   , assuming A is invertible. Thus the original equation can be written in homogeneous form in terms of deviations from the steady state      𝐱  ′    (  t  )    =   𝐀   [    𝐱   (  t  )    -   𝐱  *    ]           superscript  𝐱  normal-′   t     𝐀   delimited-[]      𝐱  t    superscript  𝐱         \mathbf{x}^{\prime}(t)=\mathbf{A}[\mathbf{x}(t)-\mathbf{x}^{*}]   .  A different way of expressing this (closer to regular usage) is that x* is a particular solution to the non-homogeneous equation, and all solutions are in the form     𝐱  h   +   𝐱  *        subscript  𝐱  h    superscript  𝐱      \mathbf{x}_{h}+\mathbf{x}^{*}   , with    𝐱  h     subscript  𝐱  h    \mathbf{x}_{h}   a solution to the homogeneous equation ( b = 0 ).  Stability of the two-state-variable case  In the n = 2 case (with two state variables), the stability conditions that the two eigenvalues of the transition matrix A each have a negative real part are equivalent to the conditions that the trace of A be negative and its determinant be positive.  Solution in matrix form  Matrix exponentials can be used to express the solution of      𝐱  ′    (  t  )    =   𝐀   [    𝐱   (  t  )    -   𝐱  *    ]           superscript  𝐱  normal-′   t     𝐀   delimited-[]      𝐱  t    superscript  𝐱         \mathbf{x}^{\prime}(t)=\mathbf{A}[\mathbf{x}(t)-\mathbf{x}^{*}]          𝐱   (  t  )    =    𝐱  *   +    e   𝐀  t     [    𝐱   (  0  )    -   𝐱  *    ]           𝐱  t      superscript  𝐱       superscript  e    𝐀  t     delimited-[]      𝐱  0    superscript  𝐱          \mathbf{x}(t)=\mathbf{x}^{*}+e^{\mathbf{A}t}[\mathbf{x}(0)-\mathbf{x}^{*}]   .  Putzer Algorithm for computing  Given a matrix   𝐀   𝐀   \mathbf{A}   with eigenvalues     λ  1   ,   λ  2   ,  …  ,   λ  n       subscript  λ  1    subscript  λ  2   normal-…   subscript  λ  n     \lambda_{1},\lambda_{2},\dots,\lambda_{n}   then       e   𝐀  t    =    ∑   j  =  0    n  -  1      r   j  +  1     (  t  )    𝐏  j          superscript  e    𝐀  t      superscript   subscript     j  0      n  1       subscript  r    j  1    t   subscript  𝐏  j       e^{\mathbf{A}t}=\sum_{j=0}^{n-1}r_{j+1}{\left(t\right)}\mathbf{P}_{j}     Where       𝐏  0   =  𝐈       subscript  𝐏  0   𝐈    \mathbf{P}_{0}=\mathbf{I}           𝐏  j   =    ∏   k  =  1   j    (   𝐀  -    λ  k   𝐈    )    =    𝐏   j  -  1     (   𝐀  -    λ  j   𝐈    )     ,   j  =   1  ,  2  ,  …  ,   n  -  1        formulae-sequence       subscript  𝐏  j     superscript   subscript  product    k  1    j     𝐀     subscript  λ  k   𝐈             subscript  𝐏    j  1      𝐀     subscript  λ  j   𝐈         j   1  2  normal-…    n  1       \mathbf{P}_{j}=\prod_{k=1}^{j}\left(\mathbf{A}-\lambda_{k}\mathbf{I}\right)=%
 \mathbf{P}_{j-1}\left(\mathbf{A}-\lambda_{j}\mathbf{I}\right),j=1,2,\dots,n-1           r  ˙   1   =    λ  1    r  1         subscript   normal-˙  r   1      subscript  λ  1    subscript  r  1      \dot{r}_{1}=\lambda_{1}r_{1}           r  1    (  0  )    =  1         subscript  r  1   0   1    r_{1}{\left(0\right)}=1            r  ˙   j   =     λ  j    r  j    +   r   j  -  1      ,   j  =   2  ,  3  ,  …  ,  n       formulae-sequence     subscript   normal-˙  r   j        subscript  λ  j    subscript  r  j     subscript  r    j  1        j   2  3  normal-…  n      \dot{r}_{j}=\lambda_{j}r_{j}+r_{j-1},j=2,3,\dots,n            r  j    (  0  )    =  0   ,   j  =   2  ,  3  ,  …  ,  n       formulae-sequence       subscript  r  j   0   0     j   2  3  normal-…  n      r_{j}{\left(0\right)}=0,j=2,3,\dots,n     The equations for     r  i    (  t  )        subscript  r  i   t    r_{i}{\left(t\right)}   are simple first order nonhomogeneous ODEs.  Notice the algorithm does not require that the matrix   𝐀   𝐀   \mathbf{A}   is diagonalizable and avoids the complexity of using Jordan canonical form when it is not needed.  Deconstructed example of a matrix ordinary differential equation  A first-order homogeneous matrix ordinary differential equation in two functions x(t) and y(t) , when taken out of matrix form, has the following form:         d  x    d  t    =     a  1   x   +    b  1   y     ,     d  y    d  t    =     a  2   x   +    b  2   y        formulae-sequence        d  x     d  t         subscript  a  1   x      subscript  b  1   y           d  y     d  t         subscript  a  2   x      subscript  b  2   y       \frac{dx}{dt}=a_{1}x+b_{1}y,\quad\frac{dy}{dt}=a_{2}x+b_{2}y     where      a  1   ,   a  2   ,   b  1       subscript  a  1    subscript  a  2    subscript  b  1     a_{1},a_{2},b_{1}\,\!    and     b  2     subscript  b  2    b_{2}\,\!    may be any arbitrary scalars.  Higher order matrix ODE's may possess a much more complicated form.  Solving deconstructed matrix ordinary differential equations  The process of solving the above equations and finding the required functions, of this particular order and form, consists of 3 main steps. Brief descriptions of each of these steps are listed below:   Finding the eigenvalues  Finding the eigenvectors  Finding the needed functions   The final, third, step in solving these sorts of ordinary differential equations is usually done by means of plugging in the values, calculated in the two previous steps into a specialized general form equation, mentioned later in this article.  Solved example of a matrix ODE  To solve the matrix ODE's according to the three steps above, using simple matrices in the process, let us find, say, function   x   x   x\,\!   and function   y   y   y\,\!   , both in terms of the single underlying variable t , in the following linear differential equation of the first order:          d  x    d  t    =    3  x   -   4  y     ,     d  y    d  t    =    4  x   -   7  y      .     formulae-sequence        d  x     d  t        3  x     4  y           d  y     d  t        4  x     7  y       \frac{dx}{dt}=3x-4y,\quad\frac{dy}{dt}=4x-7y.     To solve this particular ordinary differential equation system, at some point of the solving process we need a set of two initial values (corresponding to the presence of two state variables), a starting point. In this case, we use      x   (  0  )    =   y   (  0  )    =  1.          x  0     y  0        1.     x(0)=y(0)=1.\,\!     First step  The first step, that has already been mentioned above, is finding the eigenvalues . Both eigenvalues and eigenvectors are useful in numerous branches of mathematics, including higher engineering mathematics/calculations(i.e. Applied Mathematics ), mechanics , physical mathematics, mathematical economics , and linear algebra .  Therefore, the process consists of the following:        (      x  ′        y  ′      )   =    (     3     -  4       4     -  7      )    (     x      y     )     .         superscript  x  normal-′      superscript  y  normal-′         3    4     4    7       x    y       \begin{pmatrix}x^{\prime}\\
 y^{\prime}\end{pmatrix}=\begin{pmatrix}3&-4\\
 4&-7\end{pmatrix}\begin{pmatrix}x\\
 y\end{pmatrix}.     The derivative notation ''x' '' etc. seen in one of the vectors above is known as Lagrange's notation, first introduced by Joseph Louis Lagrange . It is equivalent to the derivative notation dx/dt used in the previous equation, known as Leibniz's notation , honouring the name of Gottfried Leibniz .  Once the coefficients of the two variables have been written in the matrix form shown above, we may start the process of evaluating the eigenvalues . To do that we are going to have to find the determinant of the matrix that is formed when an identity matrix ,    I  n     subscript  I  n    I_{n}\,\!   , multiplied by some constant lambda, symbol λ , is subtracted from our coefficient matrix in the following way:      det   (    [     3     -  4       4     -  7      ]   -   λ   [     1    0      0    1     ]     )           3    4     4    7       λ    1  0    0  1        \det\left(\begin{bmatrix}3&-4\\
 4&-7\end{bmatrix}-\lambda\begin{bmatrix}1&0\\
 0&1\end{bmatrix}\right)   .  Applying further simplification and basic rules of matrix addition we come up with the following:      det   [      3  -  λ      -  4       4      -  7   -  λ      ]           3  λ     4     4      7   λ       \det\begin{bmatrix}3-\lambda&-4\\
 4&-7-\lambda\end{bmatrix}   .  Applying the rules of finding the determinant of a single 2×2 matrix, we obtain the following elementary quadratic equation :       det   [      3  -  λ      -  4       4      -  7   -  λ      ]    =  0            3  λ     4     4      7   λ      0    \det\begin{bmatrix}3-\lambda&-4\\
 4&-7-\lambda\end{bmatrix}=0            -  21   -   3  λ    +   7  λ   +   λ  2   +  16   =  0            21     3  λ      7  λ    superscript  λ  2   16   0    -21-3\lambda+7\lambda+\lambda^{2}+16=0\,\!     which may be reduced further to get a simpler version of the above:         λ  2   +   4  λ    -  5   =  0           superscript  λ  2     4  λ    5   0    \lambda^{2}+4\lambda-5=0\,\!   .  Now finding the two roots,    λ  1     subscript  λ  1    \lambda_{1}\,\!   and    λ  2     subscript  λ  2    \lambda_{2}\,\!   of the given quadratic equation by applying the factorization method we get the following:         λ  2   +   5  λ    -  λ  -  5   =  0           superscript  λ  2     5  λ    λ  5   0    \lambda^{2}+5\lambda-\lambda-5=0\,\!           λ   (   λ  +  5   )    -   1   (   λ  +  5   )     =  0          λ    λ  5      1    λ  5     0    \lambda(\lambda+5)-1(\lambda+5)=0\,\!           (   λ  -  1   )    (   λ  +  5   )    =  0          λ  1     λ  5    0    (\lambda-1)(\lambda+5)=0\,\!         λ  =   1  ,   -  5        λ   1    5      \lambda=1,-5\,\!   .  The values,     λ  1   =  1       subscript  λ  1   1    \lambda_{1}=1\,\!   and     λ  2   =   -  5        subscript  λ  2     5     \lambda_{2}=-5\,\!   , that we have calculated above are the required eigenvalues . Once we find these two values, we proceed to the second step of the solution. We'll use the calculated eigenvalues later in the final solution. In some cases, say other matrix ODE's, the eigenvalues may be complex , in which case the following step of the solving process, as well as the final form and the solution, dramatically change.  Second step  As it was already mentioned above, in a simple description, this step involves finding the eigenvectors by means of using the information originally given to us.  For each of the eigenvalues calculated we are going to have an individual eigenvector . For our first eigenvalue , which is     λ  1   =  1       subscript  λ  1   1    \lambda_{1}=1\,\!   , we have the following:         (     3     -  4       4     -  7      )    (     α      β     )    =   1   (     α      β     )     .          3    4     4    7       α    β       1    α    β       \begin{pmatrix}3&-4\\
 4&-7\end{pmatrix}\begin{pmatrix}\alpha\\
 \beta\end{pmatrix}=1\begin{pmatrix}\alpha\\
 \beta\end{pmatrix}.     Simplifying the above expression by applying basic matrix multiplication rules we have:        3  α   -   4  β    =  α          3  α     4  β    α    3\alpha-4\beta=\alpha          α  =   2  β    .      α    2  β     \alpha=2\beta.   .  All of these calculations have been done only to obtain the last expression, which in our case is    α  =   2  β       α    2  β     \alpha=2\beta\,\!   . Now taking some arbitrary value, presumably a small insignificant value, which is much easier to work with, for either   α   α   \alpha\,\!   or   β   β   \beta\,\!   (in most cases it does not really matter), we substitute it into    α  =   2  β       α    2  β     \alpha=2\beta\,\!   . Doing so produces a very simple vector, which is the required eigenvector for this particular eigenvalue. In our case, we pick    α  =  2      α  2    \alpha=2\,\!   , which, in turn determines that    β  =  1      β  1    \beta=1\,\!   and, using the standard vector notation , our vector looks like this:         𝐯  ^   1   =   (     2      1     )    .       subscript   normal-^  𝐯   1     2    1      \mathbf{\hat{v}}_{1}=\begin{pmatrix}2\\
 1\end{pmatrix}.     Performing the same operation using the second eigenvalue we calculated, which is      λ   =   -   5     ,      λ    5     \,\!\,\lambda=-5\,,   , we obtain our second eigenvector. The process of working out this vector is not shown, but the final result is as follows:         𝐯  ^   2   =   (     1      2     )    .       subscript   normal-^  𝐯   2     1    2      \mathbf{\hat{v}}_{2}=\begin{pmatrix}1\\
 2\end{pmatrix}.     Once we've found both needed vectors , we start the third and last step. Don't forget that we'll substitute the eigenvalues and eigenvectors determined above into a specialized equation (shown shortly).  Third (final) step  This final step actually finds the required functions that are 'hidden' behind the derivatives given to us originally. There are two functions because our differential equations deal with two variables.  The equation, which involves all the pieces of information that we have previously found has the following form:        (     x      y     )   =    A   e    λ  1   t      𝐯  ^   1    +   B   e    λ  2   t      𝐯  ^   2      .        x    y        A   superscript  e     subscript  λ  1   t     subscript   normal-^  𝐯   1      B   superscript  e     subscript  λ  2   t     subscript   normal-^  𝐯   2       \begin{pmatrix}x\\
 y\end{pmatrix}=Ae^{\lambda_{1}t}\mathbf{\hat{v}}_{1}+Be^{\lambda_{2}t}\mathbf{%
 \hat{v}}_{2}.     Substituting the values of eigenvalues and eigenvectors we get the following expression:        (     x      y     )   =    A   e  t    (     2      1     )    +   B   e   -   5  t      (     1      2     )      .        x    y        A   superscript  e  t     2    1       B   superscript  e      5  t       1    2        \begin{pmatrix}x\\
 y\end{pmatrix}=Ae^{t}\begin{pmatrix}2\\
 1\end{pmatrix}+Be^{-5t}\begin{pmatrix}1\\
 2\end{pmatrix}.     Applying further simplification rules we have:         (     2    1      1    2     )    (      A   e  t         B   e   -   5  t         )    =   (     x      y     )    .          2  1    1  2        A   superscript  e  t        B   superscript  e      5  t           x    y      \begin{pmatrix}2&1\\
 1&2\end{pmatrix}\begin{pmatrix}Ae^{t}\\
 Be^{-5t}\end{pmatrix}=\begin{pmatrix}x\\
 y\end{pmatrix}.     Simplifying further and writing the equations for functions   x   x   x\,\!   and   y   y   y\,\!   separately:      x  =    2  A   e  t    +   B   e   -   5  t           x      2  A   superscript  e  t      B   superscript  e      5  t         x=2Ae^{t}+Be^{-5t}\,\!          y  =    A   e  t    +   2  B   e   -   5  t        .      y      A   superscript  e  t      2  B   superscript  e      5  t         y=Ae^{t}+2Be^{-5t}.\,\!     The above equations are in fact the functions that we needed to find, but they are in their general form and if we want to actually find their exact forms and solutions, now is the time to look back at the information given to us, the so-called initial value problem . At some point during solving these equations we have come across     x   (  0  )    =   y   (  0  )    =  1          x  0     y  0        1     x(0)=y(0)=1\,\!   , which plays the role of starting point for our ordinary differential equation. Now is the time to apply this condition, which lets us find the constants, A and B. As we see from the     x   (  0  )    =   y   (  0  )    =  1          x  0     y  0        1     x(0)=y(0)=1\,\!   condition, when    t  =  0      t  0    t=0\,\!   , the overall equation is equal to 1. Thus we may construct the following system of linear equations :      1  =    2  A   +  B       1      2  A   B     1=2A+B\,\!          1  =   A  +   2  B     .      1    A    2  B      1=A+2B.\,\!     Solving these equations we find that both constants A and B are equal to 1/3. Therefore if we substitute these values into the general form of these two functions we have their exact forms:      x  =     2  3    e  t    +    1  3    e   -   5  t           x        2  3    superscript  e  t        1  3    superscript  e      5  t         x=\frac{2}{3}e^{t}+\frac{1}{3}e^{-5t}\,\!          y  =     1  3    e  t    +    2  3    e   -   5  t        .      y        1  3    superscript  e  t        2  3    superscript  e      5  t         y=\frac{1}{3}e^{t}+\frac{2}{3}e^{-5t}.\,\!     which is our final form of the two functions we were required to find.  See also   Nonhomogeneous equations  Matrix difference equation  Newton's law of cooling  Fibonacci Sequence  Difference equations  Wave equation   References  "  Category:Ordinary differential equations     H. Moya-Cessa, F. Soto-Eguibar, DIFFERENTIAL EQUATIONS: AN OPERATIONAL APPROACH, RINTON PRESS, New Jersey, 2011. ISBN 978-1-58949-060-4 ↩  E. J. Putzer (1966). "Avoiding the Jordan Canonical Form in the Discussion of Linear Systems with Constant Coefficients", The American Mathematical Monthly , 73 , No. 1 (1966) 2-7. 1 , Paper on JSTOR ↩     
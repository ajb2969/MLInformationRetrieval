<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="1473">Behrens–Fisher problem</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Behrens–Fisher problem</h1>
<hr/>

<p>In <a class="uri" href="statistics" title="wikilink">statistics</a>, the <strong>Behrens–Fisher problem</strong>, named after <a href="Walter_Ulrich_Behrens" title="wikilink">Walter Ulrich Behrens</a> and <a href="Ronald_Fisher" title="wikilink">Ronald Fisher</a>, is the problem of <a href="interval_estimation" title="wikilink">interval estimation</a> and <a href="hypothesis_testing" title="wikilink">hypothesis testing</a> concerning the difference between the means of two <a href="normal_distribution" title="wikilink">normally distributed</a> populations when the <a href="variance" title="wikilink">variances</a> of the two populations are not assumed to be equal, based on two <a href="statistical_independence" title="wikilink">independent</a> samples.</p>
<h2 id="specification">Specification</h2>

<p>One difficulty with discussing the Behrens–Fisher problem and proposed solutions, is that there are many different interpretations of what is meant by "the Behrens–Fisher problem". These differences involve not only what is counted as being a relevant solution, but even the basic statement of the context being considered.</p>
<h3 id="context">Context</h3>

<p>Let <em>X</em><sub>1</sub>, ..., <em>X</em><sub><em>n</em></sub> and <em>Y</em><sub>1</sub>, ..., <em>Y</em><sub><em>m</em></sub> be <a class="uri" href="i.i.d." title="wikilink">i.i.d.</a> samples from two populations which both come from the same <a href="location-scale_family" title="wikilink">location-scale family</a> of distributions. The scale parameters are assumed to be unknown and not necessarily equal, and the problem is to assess whether the location parameters can reasonably be treated as equal. Lehmann<a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a> states that "the Behrens–Fisher problem" is used both for this general form of model when the family of distributions is arbitrary and for when the restriction to a <a href="normal_distribution" title="wikilink">normal distribution</a> is made. While Lehmann discusses a number of approaches to the more general problem, mainly based on nonparametrics,<a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a> most other sources appear to use "the Behrens–Fisher problem" to refer only to the case where the distribution is assumed to be normal: most of this article makes this assumption.</p>
<h3 id="requirements-of-solutions">Requirements of solutions</h3>

<p>Solutions to the Behrens–Fisher problem have been presented that make use of either a <a href="frequentist_inference" title="wikilink">classical</a> or a <a href="Bayesian_inference" title="wikilink">Bayesian inference</a> point of view and either solution would be notionally invalid judged from the other point of view. If consideration is restricted to classical statistical inference only, it is possible to seek solutions to the inference problem that are simple to apply in a practical sense, giving preference to this simplicity over any inaccuracy in the corresponding probability statements. Where exactness of the significance levels of statistical tests is required, there may be an additional requirement that the procedure should make maximum use of the statistical information in the dataset. It is well known that an exact test can be gained by randomly discarding data from the larger dataset until the sample sizes are equal, assembling data in pairs and taking differences, and then using an ordinary <a class="uri" href="t-test" title="wikilink">t-test</a> to test for the mean-difference being zero: clearly this would not be "optimal" in any sense.</p>

<p>The task of specifying interval estimates for this problem is one where a frequentist approach fails to provide an exact solution, although some approximations are available. Standard Bayesian approaches also fail to provide an answer that can be expressed as straightforward simple formulae, but modern computational methods of Bayesian analysis do allow essentially exact solutions to be found. Thus study of the problem can be used to elucidate the differences between the frequentist and Bayesian approaches to interval estimation.</p>
<h2 id="outline-of-different-approaches">Outline of different approaches</h2>
<h3 id="behrens-and-fisher-approach">Behrens and Fisher approach</h3>

<p><a href="Ronald_Fisher" title="wikilink">Ronald Fisher</a> in 1935 introduced <a href="fiducial_inference" title="wikilink">fiducial inference</a> in order to apply it to this problem. He referred to an earlier paper by <a href="Walter_Ulrich_Behrens" title="wikilink">Walter Ulrich Behrens</a> from 1929. Behrens and Fisher proposed to find the <a href="probability_distribution" title="wikilink">probability distribution</a> of</p>

<p>

<math display="block" id="Behrens–Fisher_problem:0">
 <semantics>
  <mrow>
   <mi>T</mi>
   <mo>≡</mo>
   <mfrac>
    <mrow>
     <msub>
      <mover accent="true">
       <mi>x</mi>
       <mo stretchy="false">¯</mo>
      </mover>
      <mn>1</mn>
     </msub>
     <mo>-</mo>
     <msub>
      <mover accent="true">
       <mi>x</mi>
       <mo stretchy="false">¯</mo>
      </mover>
      <mn>2</mn>
     </msub>
    </mrow>
    <msqrt>
     <mrow>
      <mrow>
       <msubsup>
        <mi>s</mi>
        <mn>1</mn>
        <mn>2</mn>
       </msubsup>
       <mo>/</mo>
       <msub>
        <mi>n</mi>
        <mn>1</mn>
       </msub>
      </mrow>
      <mo>+</mo>
      <mrow>
       <msubsup>
        <mi>s</mi>
        <mn>2</mn>
        <mn>2</mn>
       </msubsup>
       <mo>/</mo>
       <msub>
        <mi>n</mi>
        <mn>2</mn>
       </msub>
      </mrow>
     </mrow>
    </msqrt>
   </mfrac>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <equivalent></equivalent>
    <ci>T</ci>
    <apply>
     <divide></divide>
     <apply>
      <minus></minus>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <apply>
        <ci>normal-¯</ci>
        <ci>x</ci>
       </apply>
       <cn type="integer">1</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <apply>
        <ci>normal-¯</ci>
        <ci>x</ci>
       </apply>
       <cn type="integer">2</cn>
      </apply>
     </apply>
     <apply>
      <root></root>
      <apply>
       <plus></plus>
       <apply>
        <divide></divide>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>s</ci>
          <cn type="integer">1</cn>
         </apply>
         <cn type="integer">2</cn>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>n</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <apply>
        <divide></divide>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>s</ci>
          <cn type="integer">2</cn>
         </apply>
         <cn type="integer">2</cn>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>n</ci>
         <cn type="integer">2</cn>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   T\equiv{\bar{x}_{1}-\bar{x}_{2}\over\sqrt{s_{1}^{2}/n_{1}+s_{2}^{2}/n_{2}}}
  </annotation>
 </semantics>
</math>

</p>

<p>where 

<math display="inline" id="Behrens–Fisher_problem:1">
 <semantics>
  <msub>
   <mover accent="true">
    <mi>x</mi>
    <mo stretchy="false">¯</mo>
   </mover>
   <mn>1</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <apply>
     <ci>normal-¯</ci>
     <ci>x</ci>
    </apply>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \bar{x}_{1}
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Behrens–Fisher_problem:2">
 <semantics>
  <msub>
   <mover accent="true">
    <mi>x</mi>
    <mo stretchy="false">¯</mo>
   </mover>
   <mn>2</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <apply>
     <ci>normal-¯</ci>
     <ci>x</ci>
    </apply>
    <cn type="integer">2</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \bar{x}_{2}
  </annotation>
 </semantics>
</math>

 are the two <a href="sample_mean" title="wikilink">sample means</a>, and <em>s</em><sub>1</sub> and <em>s</em><sub>2</sub> are their <a href="standard_deviation" title="wikilink">standard deviations</a>. See <a href="Behrens–Fisher_distribution" title="wikilink">Behrens–Fisher distribution</a>. Fisher approximated the distribution of this by ignoring the random variation of the relative sizes of the standard deviations,</p>

<p>

<math display="block" id="Behrens–Fisher_problem:3">
 <semantics>
  <mrow>
   <mfrac>
    <mrow>
     <msub>
      <mi>s</mi>
      <mn>1</mn>
     </msub>
     <mo>/</mo>
     <msqrt>
      <msub>
       <mi>n</mi>
       <mn>1</mn>
      </msub>
     </msqrt>
    </mrow>
    <msqrt>
     <mrow>
      <mrow>
       <msubsup>
        <mi>s</mi>
        <mn>1</mn>
        <mn>2</mn>
       </msubsup>
       <mo>/</mo>
       <msub>
        <mi>n</mi>
        <mn>1</mn>
       </msub>
      </mrow>
      <mo>+</mo>
      <mrow>
       <msubsup>
        <mi>s</mi>
        <mn>2</mn>
        <mn>2</mn>
       </msubsup>
       <mo>/</mo>
       <msub>
        <mi>n</mi>
        <mn>2</mn>
       </msub>
      </mrow>
     </mrow>
    </msqrt>
   </mfrac>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <divide></divide>
    <apply>
     <divide></divide>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>s</ci>
      <cn type="integer">1</cn>
     </apply>
     <apply>
      <root></root>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>n</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
    </apply>
    <apply>
     <root></root>
     <apply>
      <plus></plus>
      <apply>
       <divide></divide>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>s</ci>
         <cn type="integer">1</cn>
        </apply>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>n</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <apply>
       <divide></divide>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>s</ci>
         <cn type="integer">2</cn>
        </apply>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>n</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   {s_{1}/\sqrt{n_{1}}\over\sqrt{s_{1}^{2}/n_{1}+s_{2}^{2}/n_{2}}}.
  </annotation>
 </semantics>
</math>

</p>

<p>Fisher's solution provoked controversy because it did not have the property that the hypothesis of equal means would be <a href="significance_level" title="wikilink">rejected with probability α</a> if the means were in fact equal. Many other methods of treating the problem have been proposed since.</p>
<h3 id="welchs-approximate-t-solution">Welch's approximate t solution</h3>

<p>A widely used method is that of <a href="B._L._Welch" title="wikilink">B. L. Welch</a>,<a class="footnoteRef" href="#fn3" id="fnref3"><sup>3</sup></a> who, like Fisher, was at <a href="University_College_London" title="wikilink">University College London</a>. The variance of the mean difference</p>

<p>

<math display="block" id="Behrens–Fisher_problem:4">
 <semantics>
  <mrow>
   <mover accent="true">
    <mi>d</mi>
    <mo stretchy="false">¯</mo>
   </mover>
   <mo>=</mo>
   <mrow>
    <msub>
     <mover accent="true">
      <mi>x</mi>
      <mo stretchy="false">¯</mo>
     </mover>
     <mn>1</mn>
    </msub>
    <mo>-</mo>
    <mpadded width="+1.7pt">
     <msub>
      <mover accent="true">
       <mi>x</mi>
       <mo stretchy="false">¯</mo>
      </mover>
      <mn>2</mn>
     </msub>
    </mpadded>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <ci>normal-¯</ci>
     <ci>d</ci>
    </apply>
    <apply>
     <minus></minus>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <ci>normal-¯</ci>
       <ci>x</ci>
      </apply>
      <cn type="integer">1</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <ci>normal-¯</ci>
       <ci>x</ci>
      </apply>
      <cn type="integer">2</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \bar{d}=\bar{x}_{1}-\bar{x}_{2}\,
  </annotation>
 </semantics>
</math>

</p>

<p>results in</p>

<p>

<math display="block" id="Behrens–Fisher_problem:5">
 <semantics>
  <mrow>
   <mrow>
    <msubsup>
     <mi>s</mi>
     <mover accent="true">
      <mi>d</mi>
      <mo stretchy="false">¯</mo>
     </mover>
     <mn>2</mn>
    </msubsup>
    <mo>=</mo>
    <mrow>
     <mfrac>
      <msubsup>
       <mi>s</mi>
       <mn>1</mn>
       <mn>2</mn>
      </msubsup>
      <msub>
       <mi>n</mi>
       <mn>1</mn>
      </msub>
     </mfrac>
     <mo>+</mo>
     <mfrac>
      <msubsup>
       <mi>s</mi>
       <mn>2</mn>
       <mn>2</mn>
      </msubsup>
      <msub>
       <mi>n</mi>
       <mn>2</mn>
      </msub>
     </mfrac>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>s</ci>
      <apply>
       <ci>normal-¯</ci>
       <ci>d</ci>
      </apply>
     </apply>
     <cn type="integer">2</cn>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <divide></divide>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>s</ci>
        <cn type="integer">1</cn>
       </apply>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>n</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <apply>
      <divide></divide>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>s</ci>
        <cn type="integer">2</cn>
       </apply>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>n</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   s_{\bar{d}}^{2}=\frac{s_{1}^{2}}{n_{1}}+\frac{s_{2}^{2}}{n_{2}}.
  </annotation>
 </semantics>
</math>

</p>

<p>Welch (1938) approximated the distribution of 

<math display="inline" id="Behrens–Fisher_problem:6">
 <semantics>
  <msubsup>
   <mi>s</mi>
   <mover accent="true">
    <mi>d</mi>
    <mo stretchy="false">¯</mo>
   </mover>
   <mn>2</mn>
  </msubsup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>s</ci>
     <apply>
      <ci>normal-¯</ci>
      <ci>d</ci>
     </apply>
    </apply>
    <cn type="integer">2</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   s_{\bar{d}}^{2}
  </annotation>
 </semantics>
</math>

 by the Type III <a href="Pearson_distribution" title="wikilink">Pearson distribution</a> (a scaled <a href="chi-squared_distribution" title="wikilink">chi-squared distribution</a>) whose first two <a href="Moment_(mathematics)" title="wikilink">moments</a> agree with that of 

<math display="inline" id="Behrens–Fisher_problem:7">
 <semantics>
  <msubsup>
   <mi>s</mi>
   <mover accent="true">
    <mi>d</mi>
    <mo stretchy="false">¯</mo>
   </mover>
   <mn>2</mn>
  </msubsup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>s</ci>
     <apply>
      <ci>normal-¯</ci>
      <ci>d</ci>
     </apply>
    </apply>
    <cn type="integer">2</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   s_{\bar{d}}^{2}
  </annotation>
 </semantics>
</math>

. This applies to the following number of degrees of freedom (d.f.), which is generally non-integer:</p>

<p>

<math display="block" id="Behrens–Fisher_problem:8">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>ν</mi>
     <mo>≈</mo>
     <mfrac>
      <msup>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <msub>
          <mi>γ</mi>
          <mn>1</mn>
         </msub>
         <mo>+</mo>
         <msub>
          <mi>γ</mi>
          <mn>2</mn>
         </msub>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
       <mn>2</mn>
      </msup>
      <mrow>
       <mrow>
        <msubsup>
         <mi>γ</mi>
         <mn>1</mn>
         <mn>2</mn>
        </msubsup>
        <mo>/</mo>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <msub>
           <mi>n</mi>
           <mn>1</mn>
          </msub>
          <mo>-</mo>
          <mn>1</mn>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
       <mo>+</mo>
       <mrow>
        <msubsup>
         <mi>γ</mi>
         <mn>2</mn>
         <mn>2</mn>
        </msubsup>
        <mo>/</mo>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <msub>
           <mi>n</mi>
           <mn>2</mn>
          </msub>
          <mo>-</mo>
          <mn>1</mn>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
      </mrow>
     </mfrac>
    </mrow>
    <mrow>
     <mrow>
      <mtext>where</mtext>
      <msub>
       <mi>γ</mi>
       <mi>i</mi>
      </msub>
     </mrow>
     <mo>=</mo>
     <mrow>
      <msubsup>
       <mi>σ</mi>
       <mi>i</mi>
       <mn>2</mn>
      </msubsup>
      <mo>/</mo>
      <msub>
       <mi>n</mi>
       <mi>i</mi>
      </msub>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <approx></approx>
     <ci>ν</ci>
     <apply>
      <divide></divide>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <plus></plus>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>γ</ci>
         <cn type="integer">1</cn>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>γ</ci>
         <cn type="integer">2</cn>
        </apply>
       </apply>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <plus></plus>
       <apply>
        <divide></divide>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>γ</ci>
          <cn type="integer">1</cn>
         </apply>
         <cn type="integer">2</cn>
        </apply>
        <apply>
         <minus></minus>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>n</ci>
          <cn type="integer">1</cn>
         </apply>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <apply>
        <divide></divide>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>γ</ci>
          <cn type="integer">2</cn>
         </apply>
         <cn type="integer">2</cn>
        </apply>
        <apply>
         <minus></minus>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>n</ci>
          <cn type="integer">2</cn>
         </apply>
         <cn type="integer">1</cn>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <apply>
      <times></times>
      <mtext>where</mtext>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>γ</ci>
       <ci>i</ci>
      </apply>
     </apply>
     <apply>
      <divide></divide>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>σ</ci>
        <ci>i</ci>
       </apply>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>n</ci>
       <ci>i</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \nu\approx{(\gamma_{1}+\gamma_{2})^{2}\over\gamma_{1}^{2}/(n_{1}-1)+\gamma_{2}%
^{2}/(n_{2}-1)}\quad\text{ where }\gamma_{i}=\sigma_{i}^{2}/n_{i}.\,
  </annotation>
 </semantics>
</math>

</p>

<p>Under the null hypothesis of equal expectations, <mtpl> <em>μ</em><sub>2</sub>}}</mtpl>, the distribution of the Behrens-Fisher statistic <em>T</em>, which also depends on the variance ratio <em>σ</em><sub>1</sub><sup>2</sup>/<em>σ</em><sub>2</sub><sup>2</sup>, could now be approximated by <a href="Student's_t_distribution" title="wikilink">Student's t distribution</a> with these <em>ν</em> degrees of freedom. But this <em>ν</em> contains the population variances <em>σ<sub>i</sub></em><sup>2</sup>, and these are unknown. The following estimate only replaces the population variances by the sample variances:</p>

<p>

<math display="block" id="Behrens–Fisher_problem:9">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mover accent="true">
      <mi>ν</mi>
      <mo stretchy="false">^</mo>
     </mover>
     <mo>≈</mo>
     <mfrac>
      <msup>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <msub>
          <mi>g</mi>
          <mn>1</mn>
         </msub>
         <mo>+</mo>
         <msub>
          <mi>g</mi>
          <mn>2</mn>
         </msub>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
       <mn>2</mn>
      </msup>
      <mrow>
       <mrow>
        <msubsup>
         <mi>g</mi>
         <mn>1</mn>
         <mn>2</mn>
        </msubsup>
        <mo>/</mo>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <msub>
           <mi>n</mi>
           <mn>1</mn>
          </msub>
          <mo>-</mo>
          <mn>1</mn>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
       <mo>+</mo>
       <mrow>
        <msubsup>
         <mi>g</mi>
         <mn>2</mn>
         <mn>2</mn>
        </msubsup>
        <mo>/</mo>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <msub>
           <mi>n</mi>
           <mn>2</mn>
          </msub>
          <mo>-</mo>
          <mn>1</mn>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
      </mrow>
     </mfrac>
    </mrow>
    <mrow>
     <mrow>
      <mtext>where</mtext>
      <msub>
       <mi>g</mi>
       <mi>i</mi>
      </msub>
     </mrow>
     <mo>=</mo>
     <mrow>
      <msubsup>
       <mi>s</mi>
       <mi>i</mi>
       <mn>2</mn>
      </msubsup>
      <mo>/</mo>
      <msub>
       <mi>n</mi>
       <mi>i</mi>
      </msub>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <approx></approx>
     <apply>
      <ci>normal-^</ci>
      <ci>ν</ci>
     </apply>
     <apply>
      <divide></divide>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <plus></plus>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>g</ci>
         <cn type="integer">1</cn>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>g</ci>
         <cn type="integer">2</cn>
        </apply>
       </apply>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <plus></plus>
       <apply>
        <divide></divide>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>g</ci>
          <cn type="integer">1</cn>
         </apply>
         <cn type="integer">2</cn>
        </apply>
        <apply>
         <minus></minus>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>n</ci>
          <cn type="integer">1</cn>
         </apply>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <apply>
        <divide></divide>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>g</ci>
          <cn type="integer">2</cn>
         </apply>
         <cn type="integer">2</cn>
        </apply>
        <apply>
         <minus></minus>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>n</ci>
          <cn type="integer">2</cn>
         </apply>
         <cn type="integer">1</cn>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <apply>
      <times></times>
      <mtext>where</mtext>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>g</ci>
       <ci>i</ci>
      </apply>
     </apply>
     <apply>
      <divide></divide>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>s</ci>
        <ci>i</ci>
       </apply>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>n</ci>
       <ci>i</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \hat{\nu}\approx{(g_{1}+g_{2})^{2}\over g_{1}^{2}/(n_{1}-1)+g_{2}^{2}/(n_{2}-1%
)}\quad\text{ where }g_{i}=s_{i}^{2}/n_{i}.
  </annotation>
 </semantics>
</math>

</p>

<p>This 

<math display="inline" id="Behrens–Fisher_problem:10">
 <semantics>
  <mover accent="true">
   <mi>ν</mi>
   <mo stretchy="false">^</mo>
  </mover>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-^</ci>
    <ci>ν</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \hat{\nu}
  </annotation>
 </semantics>
</math>

 is a random variable. A t distribution with a random number of degrees of freedom does not exist. Nevertheless, the Behrens-Fisher <em>T</em> can be compared with a corresponding quantile of <a href="Student's_t_distribution" title="wikilink">Student's t distribution</a> with these estimated number of degrees of freedom, 

<math display="inline" id="Behrens–Fisher_problem:11">
 <semantics>
  <mover accent="true">
   <mi>ν</mi>
   <mo stretchy="false">^</mo>
  </mover>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-^</ci>
    <ci>ν</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \hat{\nu}
  </annotation>
 </semantics>
</math>

, which is generally non-integer. In this way, the boundary between acceptance and rejection region of the test statistic <em>T</em> is calculated based on the empirical variances <em>s<sub>i</sub></em><sup>2</sup>, in a way that is a smooth function of these.</p>

<p>This method also does not give exactly the nominal rate, but is generally not too far off. However, if the population variances are equal, or if the samples are rather small and the population variances can be assumed to be approximately equal, it is more accurate to use <a href="Student's_t-test" title="wikilink">Student's t-test</a>,.</p>
<h3 id="other-approaches">Other approaches</h3>

<p>A number of different approaches to the general problem have been proposed, some of which claim to "solve" some version of the problem. Among these are,<a class="footnoteRef" href="#fn4" id="fnref4"><sup>4</sup></a></p>

<p>:*that of Chapman in 1950,<a class="footnoteRef" href="#fn5" id="fnref5"><sup>5</sup></a></p>

<p>:*that of Prokof’yev and Shishkin in 1974,<a class="footnoteRef" href="#fn6" id="fnref6"><sup>6</sup></a></p>

<p>:*that of Dudewicz and Ahmed in 1998.<a class="footnoteRef" href="#fn7" id="fnref7"><sup>7</sup></a> In Dudewicz’s comparison of selected methods,<a class="footnoteRef" href="#fn8" id="fnref8"><sup>8</sup></a> it was found that the Dudewicz–Ahmed procedure is recommended for practical use.</p>
<h2 id="variants">Variants</h2>

<p>A minor variant of the Behrens–Fisher problem has been studied.<a class="footnoteRef" href="#fn9" id="fnref9"><sup>9</sup></a> In this instance the problem is, assuming that the two population-means are in fact the same, to make inferences about the common mean: for example, one could require a <a href="confidence_interval" title="wikilink">confidence interval</a> for the common mean.</p>
<h2 id="generalisations">Generalisations</h2>

<p>The immediate generalisation of the problem involves <a href="multivariate_normal_distribution" title="wikilink">multivariate normal distributions</a> with unknown covariance matrices, and is known as the <a href="Multivariate_Behrens–Fisher_problem" title="wikilink">Multivariate Behrens–Fisher problem</a>.<a class="footnoteRef" href="#fn10" id="fnref10"><sup>10</sup></a></p>
<h2 id="notes">Notes</h2>
<references>
</references>
<h2 id="references">References</h2>
<ul>
<li></li>
</ul>
<ul>
<li>Bellon, A., Didier, G. (2008) "On the Behrens–Fisher Problem: A Globally Convergent Algorithm and a Finite-Sample Study of the <a href="Wald_test" title="wikilink">Wald</a>, <a href="LR_test" title="wikilink">LR</a> and <a href="LM_test" title="wikilink">LM Tests</a>" <em><a href="Annals_of_Statistics" title="wikilink">Annals of Statistics</a></em>,36 (5), 2377–2408.  <a href="http://arxiv.org/pdf/0811.0672.pdf">arXiv electronic reprint</a></li>
</ul>
<ul>
<li>Chang CH, Pal N (2008) "A revisit to the Behrens-Fisher problem: Comparison of five test methods" <em>Communications in Statistics-Simulation and Computation</em>, 37 (6), 1064-1085. </li>
</ul>
<ul>
<li>Dudewicz, E. J., S. U. Ahmed (1998) New exact and asymptotically optimal solution to the Behrens–Fisher problem, with tables. <em>American Journal of Mathematical and Management Sciences</em>, 18, 359–426.</li>
</ul>
<ul>
<li>Dudewicz, E. J., S. U. Ahmed (1999) New exact and asymptotically optimal heteroscedastic statistical procedures and tables, II. <em>American Journal of Mathematical and Management Sciences</em>, 19, 157–180.</li>
</ul>
<ul>
<li>Dudewicz, E. J., Y. Ma, S. E. Mai, and H. Su (2007) "Exact solutions to the Behrens–Fisher problem: Asymptotically optimal and finite sample efficient choice among." <em>Journal of Statistical Planning and Inference</em>, 137 (5), 1584–1605. </li>
</ul>
<ul>
<li>Fisher, R. A. (1935) "The fiducial argument in statistical inference", <em>Annals of Eugenics</em>, 8, 391–398.</li>
</ul>
<ul>
<li>Fisher, R. A. (1941) "The Asymptotic Approach to Behrens’ Integral with further Tables for the d Test of Significance", <em>Annals of Eugenics</em>, 11, 141–172.</li>
</ul>
<ul>
<li>Fraser, D. A. S., Rousseau, J. (2008) Studentization and deriving accurate p-values. <em><a class="uri" href="Biometrika" title="wikilink">Biometrika</a></em>, 95 (1), 1–16. </li>
</ul>
<ul>
<li>Lehmann, E. L. (1975) <em>Nonparametrics: Statistical Methods Based on Ranks</em>, Holden-Day , McGraw-Hill ISBN 0-07-037073-7</li>
</ul>
<ul>
<li><a href="Harold_Ruben" title="wikilink">Ruben, H.</a> (2002)[<a class="uri" href="http://sankhya.isical.ac.in/search/servlet/SSearch?s_order=2&amp;choice1">http://sankhya.isical.ac.in/search/servlet/SSearch?s_order=2&amp;choice1;</a>;=author&amp;text1;=Ruben&amp;opt1;=And&amp;choice2;=title&amp;text2;=&amp;opt2;=And&amp;choice3;=title&amp;text3;=&amp;opt3;=And&amp;choice4;=keyword&amp;text4;=&amp;rel;_yr=equalto&amp;yearsrch;=2002&amp;rel;_vol=equalto&amp;volumesrch;=64&amp;series;=on∂=on&amp;amssrch;=#=20&amp;cntr;=0 "A simple conservative and robust solution of the Behrens–Fisher problem"], <em><a href="Sankhya_(journal)" title="wikilink">Sankhyā:The Indian Journal of Statistics</a></em>, Series A, 64 (1),139–155.</li>
</ul>
<ul>
<li>Pardo JA, Pardo MD (2007) "A simulation study of a new family of test statistics for the Behrens-Fisher problem" <em>Kybernetes</em>, 36 (5-6), 806-816. </li>
</ul>
<ul>
<li>Sawilowsky, Shlomo S. (2002). <a href="http://education.wayne.edu/jmasm/sawilowsky_behrens_fisher.pdf">Fermat, Schubert, Einstein, and Behrens–Fisher: The Probable Difference Between Two Means When σ<sub>1</sub> ≠ σ<sub>2</sub></a> <em>Journal of Modern Applied Statistical Methods</em>, 1(2).</li>
</ul>
<ul>
<li>Welch, B. L. (1938) "The significance of the difference between two means when the population variances are unequal", <em><a class="uri" href="Biometrika" title="wikilink">Biometrika</a></em> 29, 350–62.</li>
</ul>
<ul>
<li></li>
</ul>
<ul>
<li>Voinov, V., Nikulin, M. (1995) "On the problem of means of weighted normal populations", "Questiio", 19 (2), 7–20.</li>
</ul>
<ul>
<li>Zheng SR, Shi NZ, Ma WQ (2010) "Statistical inference on difference or ratio of means from heteroscedastic normal populations" <em>Journal of Statistical Planning and Inference</em>, 140 (5), 1236-1242. </li>
</ul>
<h2 id="external-links">External links</h2>
<ul>
<li>Dong, B.L. (2004) <a href="http://web.uvic.ca/econ/research/papers/pdfs/ewp0404.pdf">The Behrens–Fisher Problem: An Empirical Likelihood Approach</a> Econometrics Working Paper EWP0404, University of Victoria</li>
</ul>

<p>"</p>

<p><a href="Category:Mathematical_problems" title="wikilink">Category:Mathematical problems</a> <a href="Category:Statistical_theory" title="wikilink">Category:Statistical theory</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1">Lehmann (1975) p.95<a href="#fnref1">↩</a></li>
<li id="fn2">Lehmann (1975) Section 7<a href="#fnref2">↩</a></li>
<li id="fn3">Welch (1938, 1947)<a href="#fnref3">↩</a></li>
<li id="fn4"></li>
<li id="fn5"><a href="#fnref5">↩</a></li>
<li id="fn6"><a href="#fnref6">↩</a></li>
<li id="fn7">Dudewicz &amp; Ahmed (1998, 1999)<a href="#fnref7">↩</a></li>
<li id="fn8">Dudewicz, Ma, Mai, and Su (2007)<a href="#fnref8">↩</a></li>
<li id="fn9">Young, G.A., Smith, R.L. (2005) <em>Essentials of Statistical Inference</em>, CUP. ISBN 0-521-83971-8 (page 204)<a href="#fnref9">↩</a></li>
<li id="fn10">Belloni &amp; Didier (2008)<a href="#fnref10">↩</a></li>
</ol>
</section>
</body>
</html>

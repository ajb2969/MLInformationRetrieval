<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="1220">Phasor approach to fluorescence lifetime and spectral imaging</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Phasor approach to fluorescence lifetime and spectral imaging</h1>
<hr/>

<p> <a class="uri" href="Phasor" title="wikilink">Phasor</a> approach refers to a method which is used for vectorial representation of sinusoidal waves like alternative currents and voltages or electromagnetic waves. The amplitude and the phase of the waveform is transformed into a vector where the phase is translated to the angle between the phasor vector and X axis and the amplitude is translated to vector length or magnitude. In this concept the representation and the analysis becomes very simple and the addition of two wave forms is realized by their vectorial summation.</p>

<p>In <a class="uri" href="Fluorescence" title="wikilink">Fluorescence</a> lifetime and spectral imaging, phasor can be used to visualize the spectra and decay curves.<a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a><a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a> In this method the <a href="Fourier_transformation" title="wikilink">Fourier transformation</a> of the <a class="uri" href="spectrum" title="wikilink">spectrum</a> or decay curve is calculated and the resulted complex number is plotted on a 2D plot where the X axis represents the Real component and the Y axis represents the Imaginary component. This facilitate the analysis since each spectrum and decay is transformed into a unique position on the phasor plot which depends on its spectral width or emission maximum or to its average lifetime. The most important feature of this analysis is that it is fast and it provides a graphical representation of the measured curve.</p>
<h2 id="temporal-phasor">Temporal phasor</h2>

<p>If we have decay curve which is represented by an <a href="exponential_function" title="wikilink">exponential function</a> with lifetime of τ:</p>

<p>

<math display="inline" id="Phasor_approach_to_fluorescence_lifetime_and_spectral_imaging:0">
 <semantics>
  <mrow>
   <mrow>
    <mi>d</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>t</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <msup>
    <mi>e</mi>
    <mrow>
     <mo>-</mo>
     <mrow>
      <mi>t</mi>
      <mo>/</mo>
      <mi>τ</mi>
     </mrow>
    </mrow>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>d</ci>
     <ci>t</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>e</ci>
     <apply>
      <minus></minus>
      <apply>
       <divide></divide>
       <ci>t</ci>
       <ci>τ</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   d(t)={{e}^{-t/\tau}}
  </annotation>
 </semantics>
</math>

  Then the Fourier transformation at <a class="uri" href="frequency" title="wikilink">frequency</a> ω is represented by the Lorentz function:</p>

<p>

<math display="inline" id="Phasor_approach_to_fluorescence_lifetime_and_spectral_imaging:1">
 <semantics>
  <mrow>
   <mrow>
    <mi>D</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>ω</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mfrac>
    <mn>1</mn>
    <mrow>
     <mn>1</mn>
     <mo>-</mo>
     <mrow>
      <mi>j</mi>
      <mi>ω</mi>
      <mi>τ</mi>
     </mrow>
    </mrow>
   </mfrac>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>D</ci>
     <ci>ω</ci>
    </apply>
    <apply>
     <divide></divide>
     <cn type="integer">1</cn>
     <apply>
      <minus></minus>
      <cn type="integer">1</cn>
      <apply>
       <times></times>
       <ci>j</ci>
       <ci>ω</ci>
       <ci>τ</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   D(\omega)=\frac{1}{1-j\omega\tau}
  </annotation>
 </semantics>
</math>

</p>

<p>This is a complex function and drawing the Imaginary versus real part of this function for all possible lifetimes will be a semicircle where the zero lifetime is located at (1,0) and the infinite lifetime located at (0,0). By changing the lifetime from zero to infinity the phasor point moves along a semicircle from (1,0) to (0,0). This suggest that by taking the Fourier transformation of a measured decay curve and mapping the result on the phasor plot the lifetime can be estimated from the position of the phasor on the semicircle.</p>

<p>Explicitly, the lifetime can be measured from the magnitude of the phasor as follow:</p>

<p>

<math display="inline" id="Phasor_approach_to_fluorescence_lifetime_and_spectral_imaging:2">
 <semantics>
  <mrow>
   <mi>τ</mi>
   <mo>=</mo>
   <mrow>
    <mfrac>
     <mn>1</mn>
     <mi>ω</mi>
    </mfrac>
    <mfrac>
     <mrow>
      <mrow>
       <mo>Im</mo>
       <mi>D</mi>
      </mrow>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>ω</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mrow>
      <mrow>
       <mo>Re</mo>
       <mi>D</mi>
      </mrow>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>ω</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mfrac>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>τ</ci>
    <apply>
     <times></times>
     <apply>
      <divide></divide>
      <cn type="integer">1</cn>
      <ci>ω</ci>
     </apply>
     <apply>
      <divide></divide>
      <apply>
       <times></times>
       <apply>
        <ci>Im</ci>
        <ci>D</ci>
       </apply>
       <ci>ω</ci>
      </apply>
      <apply>
       <times></times>
       <apply>
        <ci>Re</ci>
        <ci>D</ci>
       </apply>
       <ci>ω</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \tau=\frac{1}{\omega}\frac{\operatorname{Im}D(\omega)}{\operatorname{Re}D(%
\omega)}
  </annotation>
 </semantics>
</math>

</p>

<p>This is a very fast approach compared to methods where they use fitting to estimate the lifetime.</p>
<figure><b>(Figure)</b>
<figcaption> The intensity,phasor and lifetime image of cells transfected with Alexa 488 and Alexa 555.</figcaption>
</figure>
<h2 id="multi-exponential-cases">Multi-exponential cases</h2>

<p>The semicircle is to express the single exponential lifetimes; when the measured decay curve shows the superposition of different lifetimes then the phasor falls inside the semicircle depending on its fractions from principal lifetimes.For a bi-exponential case with lifetimes of τ1 and τ2 and fraction of alpha The total phasor falls on a line connecting the phasors of τ1 and τ2 on the semicircle and the distance from the phasor of τ1 determines the alpha. Having an image with two components with lifetimes of τ1 and τ2 the phasor of image pixels are distributed on a line connecting the phasor of τ1 and τ2. Fitting a line through all these phasor points with slope (v) and interception (u) , will give two intersections with semicircle which determines the lifetimes of τ1 and τ2 by:</p>

<p>

<math display="inline" id="Phasor_approach_to_fluorescence_lifetime_and_spectral_imaging:3">
 <semantics>
  <mrow>
   <msub>
    <mi>τ</mi>
    <mrow>
     <mn>1</mn>
     <mo>,</mo>
     <mn>2</mn>
    </mrow>
   </msub>
   <mo>=</mo>
   <mfrac>
    <mrow>
     <mn>1</mn>
     <mo>±</mo>
     <msqrt>
      <mrow>
       <mn>1</mn>
       <mo>-</mo>
       <mrow>
        <mn>4</mn>
        <mi>u</mi>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <mi>u</mi>
          <mo>+</mo>
          <mi>v</mi>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
      </mrow>
     </msqrt>
    </mrow>
    <mrow>
     <mn>2</mn>
     <mi>ω</mi>
     <mi>u</mi>
    </mrow>
   </mfrac>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>τ</ci>
     <list>
      <cn type="integer">1</cn>
      <cn type="integer">2</cn>
     </list>
    </apply>
    <apply>
     <divide></divide>
     <apply>
      <csymbol cd="latexml">plus-or-minus</csymbol>
      <cn type="integer">1</cn>
      <apply>
       <root></root>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
        <apply>
         <times></times>
         <cn type="integer">4</cn>
         <ci>u</ci>
         <apply>
          <plus></plus>
          <ci>u</ci>
          <ci>v</ci>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <cn type="integer">2</cn>
      <ci>ω</ci>
      <ci>u</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   {{\tau}_{1,2}}=\frac{1\pm\sqrt{1-4u(u+v)}}{2\omega u}
  </annotation>
 </semantics>
</math>

</p>

<p>This is a blind solution for unmixing of two components based on their lifetimes.Provided that the lifetimes of each individual component show a single exponential behavior.</p>
<h2 id="compatibility-to-different-gate-configurations">Compatibility to different gate configurations</h2>

<p> For a system with discrete number of gates and limited time window the phasor approach needs to be adopted. The equation for reference semicircle is changed to:<a class="footnoteRef" href="#fn3" id="fnref3"><sup>3</sup></a> 

<math display="inline" id="Phasor_approach_to_fluorescence_lifetime_and_spectral_imaging:4">
 <semantics>
  <mrow>
   <mrow>
    <msup>
     <mi>D</mi>
     <mo>′</mo>
    </msup>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>ω</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mfrac>
    <mrow>
     <mi>sinh</mi>
     <mrow>
      <mo>(</mo>
      <mfrac>
       <mi>T</mi>
       <mrow>
        <mn>2</mn>
        <mi>K</mi>
        <mi>τ</mi>
       </mrow>
      </mfrac>
      <mo>)</mo>
     </mrow>
    </mrow>
    <mrow>
     <mi>sinh</mi>
     <mrow>
      <mo>(</mo>
      <mfrac>
       <mrow>
        <mn>1</mn>
        <mo>-</mo>
        <mrow>
         <mi>j</mi>
         <mi>ω</mi>
         <mi>τ</mi>
        </mrow>
       </mrow>
       <mfrac>
        <mrow>
         <mn>2</mn>
         <mi>K</mi>
         <mi>τ</mi>
        </mrow>
        <mi>T</mi>
       </mfrac>
      </mfrac>
      <mo>)</mo>
     </mrow>
    </mrow>
   </mfrac>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>D</ci>
      <ci>normal-′</ci>
     </apply>
     <ci>ω</ci>
    </apply>
    <apply>
     <divide></divide>
     <apply>
      <sinh></sinh>
      <apply>
       <divide></divide>
       <ci>T</ci>
       <apply>
        <times></times>
        <cn type="integer">2</cn>
        <ci>K</ci>
        <ci>τ</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <sinh></sinh>
      <apply>
       <divide></divide>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
        <apply>
         <times></times>
         <ci>j</ci>
         <ci>ω</ci>
         <ci>τ</ci>
        </apply>
       </apply>
       <apply>
        <divide></divide>
        <apply>
         <times></times>
         <cn type="integer">2</cn>
         <ci>K</ci>
         <ci>τ</ci>
        </apply>
        <ci>T</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   {D}^{\prime}(\omega)=\frac{\sinh\left(\frac{T}{2K\tau}\right)}{\sinh\left(%
\frac{1-j\omega\tau}{\frac{2K\tau}{T}}\right)}
  </annotation>
 </semantics>
</math>

</p>

<p>Where K is the number of gates and T is the total measurement window. The average lifetimes are calculated by : And for a binary case after fitting a line through the data set of phasors and finding the <a class="uri" href="slope" title="wikilink">slope</a> (v) and interception (u) the lifetimnes are calculated by :</p>

<p>

<math display="inline" id="Phasor_approach_to_fluorescence_lifetime_and_spectral_imaging:5">
 <semantics>
  <mrow>
   <msub>
    <mi>τ</mi>
    <mrow>
     <mn>1</mn>
     <mo>,</mo>
     <mn>2</mn>
    </mrow>
   </msub>
   <mo>=</mo>
   <mfrac>
    <mfrac>
     <mi>T</mi>
     <mrow>
      <mn>2</mn>
      <mi>K</mi>
     </mrow>
    </mfrac>
    <mrow>
     <mi>A</mi>
     <mi>r</mi>
     <mi>c</mi>
     <mi>c</mi>
     <mi>o</mi>
     <mi>t</mi>
     <mi>h</mi>
     <mrow>
      <mo>(</mo>
      <mrow>
       <mo>±</mo>
       <mfrac>
        <mrow>
         <msqrt>
          <mrow>
           <mn>1</mn>
           <mo>-</mo>
           <mrow>
            <mn>2</mn>
            <msup>
             <mi>u</mi>
             <mn>2</mn>
            </msup>
           </mrow>
           <mo>-</mo>
           <mrow>
            <mrow>
             <mo>(</mo>
             <mrow>
              <mrow>
               <mn>4</mn>
               <mi>u</mi>
               <mi>v</mi>
              </mrow>
              <mo>+</mo>
              <mrow>
               <mn>2</mn>
               <msup>
                <mi>u</mi>
                <mn>2</mn>
               </msup>
              </mrow>
             </mrow>
             <mo>)</mo>
            </mrow>
            <mrow>
             <mi>cos</mi>
             <mrow>
              <mo>(</mo>
              <mrow>
               <mi>n</mi>
               <mi>ω</mi>
               <mfrac>
                <mi>T</mi>
                <mrow>
                 <mn>2</mn>
                 <mi>K</mi>
                </mrow>
               </mfrac>
              </mrow>
              <mo>)</mo>
             </mrow>
            </mrow>
           </mrow>
          </mrow>
         </msqrt>
         <mo>±</mo>
         <mn>1</mn>
        </mrow>
        <mrow>
         <mn>2</mn>
         <mi>u</mi>
         <mrow>
          <mi>sin</mi>
          <mrow>
           <mo>(</mo>
           <mrow>
            <mi>n</mi>
            <mi>ω</mi>
            <mfrac>
             <mi>T</mi>
             <mrow>
              <mn>2</mn>
              <mi>K</mi>
             </mrow>
            </mfrac>
           </mrow>
           <mo>)</mo>
          </mrow>
         </mrow>
        </mrow>
       </mfrac>
      </mrow>
      <mo>)</mo>
     </mrow>
    </mrow>
   </mfrac>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>τ</ci>
     <list>
      <cn type="integer">1</cn>
      <cn type="integer">2</cn>
     </list>
    </apply>
    <apply>
     <divide></divide>
     <apply>
      <divide></divide>
      <ci>T</ci>
      <apply>
       <times></times>
       <cn type="integer">2</cn>
       <ci>K</ci>
      </apply>
     </apply>
     <apply>
      <times></times>
      <ci>A</ci>
      <ci>r</ci>
      <ci>c</ci>
      <ci>c</ci>
      <ci>o</ci>
      <ci>t</ci>
      <ci>h</ci>
      <apply>
       <csymbol cd="latexml">plus-or-minus</csymbol>
       <apply>
        <divide></divide>
        <apply>
         <csymbol cd="latexml">plus-or-minus</csymbol>
         <apply>
          <root></root>
          <apply>
           <minus></minus>
           <cn type="integer">1</cn>
           <apply>
            <times></times>
            <cn type="integer">2</cn>
            <apply>
             <csymbol cd="ambiguous">superscript</csymbol>
             <ci>u</ci>
             <cn type="integer">2</cn>
            </apply>
           </apply>
           <apply>
            <times></times>
            <apply>
             <plus></plus>
             <apply>
              <times></times>
              <cn type="integer">4</cn>
              <ci>u</ci>
              <ci>v</ci>
             </apply>
             <apply>
              <times></times>
              <cn type="integer">2</cn>
              <apply>
               <csymbol cd="ambiguous">superscript</csymbol>
               <ci>u</ci>
               <cn type="integer">2</cn>
              </apply>
             </apply>
            </apply>
            <apply>
             <cos></cos>
             <apply>
              <times></times>
              <ci>n</ci>
              <ci>ω</ci>
              <apply>
               <divide></divide>
               <ci>T</ci>
               <apply>
                <times></times>
                <cn type="integer">2</cn>
                <ci>K</ci>
               </apply>
              </apply>
             </apply>
            </apply>
           </apply>
          </apply>
         </apply>
         <cn type="integer">1</cn>
        </apply>
        <apply>
         <times></times>
         <cn type="integer">2</cn>
         <ci>u</ci>
         <apply>
          <sin></sin>
          <apply>
           <times></times>
           <ci>n</ci>
           <ci>ω</ci>
           <apply>
            <divide></divide>
            <ci>T</ci>
            <apply>
             <times></times>
             <cn type="integer">2</cn>
             <ci>K</ci>
            </apply>
           </apply>
          </apply>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   {{\tau}_{1,2}}=\frac{\frac{T}{2K}}{Arccoth\left(\pm\frac{\sqrt{1-2{{u}^{2}}-%
\left(4uv+2{{u}^{2}}\right)\cos\left(n\omega\frac{T}{2K}\right)}\pm 1}{2u\sin%
\left(n\omega\frac{T}{2K}\right)}\right)}
  </annotation>
 </semantics>
</math>

</p>
<h2 id="effect-of-instrument-response">Effect of instrument response</h2>

<p>In a non-ideal and real situations, the measured decay curve is the <a class="uri" href="convolution" title="wikilink">convolution</a> of the instrument response (the laser pulse distorted by system) with an <a href="exponential_function" title="wikilink">exponential function</a> which makes the analysis more complicated. Large number of techniques have been developed to overcome to this problem but in phasor approach this is simply solved by the fact that the Fourier transformation of a convolution is the product of Fourier transforms. This allows to take into account the effect of instrument response by taking the Fourier transformation of instrument response function and dividing the total phasor to instrument response transformation.</p>
<h2 id="spectral-phasor">Spectral phasor</h2>

<p>Similar to temporal phasor the Fourier transformation of spectra can be used to make phasor. Considering a Gaussian spectrum with zero spectral width and changing the emission maximum from channel zero to K the phasor rotates on a circle from small angles to larger angles. This corresponds to shift theorem of Fourier transformation. Changing the spectral width from zero to infinity moves the phasor toward center. This means that the phasor for background signal which can be considered as a spectrum with infinite spectral width is located at center of phasor with coordinate of (0,0).</p>

<p> </p>
<h2 id="linear-property-of-the-phasor-approach">Linear property of the phasor approach</h2>

<p>One of the interesting property of the phasor approach is the linearity where the superposition of different spectra or decay curves can be analyzed by vectorial superposition of individual phasors. This is demonstrated in the figure where adding two spectra with different emission maximum resulted in a phasor which falls on a line connecting the phasors of individual phasors. For a ternary system adding 3 spectra falls inside a triangle made by phasors of individual spectra or decays.</p>

<p> </p>
<h2 id="unmixing-of-three-components">Unmixing of Three components</h2>

<p>For a system which has three different components and they show different spectra, the phasor of the pixeles with different fractional intensities fall inside a triangle where the verti are made up by phasor of pure components. The fractional intensities then can be estimated by measuring the area of the triangle that each phasor makes with the phasor of pure vertix.</p>
<figure><b>(Figure)</b>
<figcaption> The intensity image, Phasor image and the unmixed results for a cell transfected with DAPI,BODIPY and texas red shown by blue, green and red respectively.</figcaption>
</figure>
<h2 id="reciprocal-property">Reciprocal property</h2>

<p>This another interesting feature, there is a one to one correlation between the pixels in the image and their phasors on the phasor plot depending on their spectrum or decay curve. The phasors for pixels with similar temporal-spectral properties fall on a similar regions and this provide a mean for sorting the image pixels according to their temporal-spectral properties. By making region of interest on phasor plot a reciprocal transformation can be performed and the phasors can be projected back to the image which allows a basic segmentation.</p>
<h2 id="references">References</h2>
<references>
</references>
<h2 id="external-links">External links</h2>
<ul>
<li>Lifetime and spectral analysis tools in ImageJ: <a class="uri" href="http://spechron.com">http://spechron.com</a></li>
<li><a href="http://www.lfd.uci.edu/globals/">Globals Software for Spectroscopy and Images</a></li>
</ul>

<p>"</p>

<p><a href="Category:Cell_imaging" title="wikilink">Category:Cell imaging</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1">Digman, Michelle A., et al. "The phasor approach to fluorescence lifetime imaging analysis." Biophysical journal 94.2 (2008): L14-L16.<a href="#fnref1">↩</a></li>
<li id="fn2">Fereidouni, Farzad, Arjen N. Bader, and Hans C. Gerritsen. "Spectral phasor analysis allows rapid and reliable unmixing of fluorescence microscopy spectral images." Optics Express 20.12 (2012): 12729-12741.<a href="#fnref2">↩</a></li>
<li id="fn3">Fereidouni, F., et al. "A modified phasor approach for analyzing time‐gated fluorescence lifetime images." Journal of microscopy 244.3 (2011): 248-258.<a href="#fnref3">↩</a></li>
</ol>
</section>
</body>
</html>

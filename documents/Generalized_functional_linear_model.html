<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="1654">Generalized functional linear model</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Generalized functional linear model</h1>
<hr>The '''generalized functional linear model''' ('''GFLM''') is an extension of the [[generalized linear model]] (GLM) that allows one to regress univariate 
<p>responses of various types (continuous or discrete) on functional predictors, which are mostly random trajectories generated by a <a href="Square-integrable_function" title="wikilink">square-integrable</a> <a href="stochastic_process" title="wikilink">stochastic processes</a>. Similarly to GLM, a link function relates the expected value of the response variable to a linear predictor, which in case of GFLM is obtained by forming the scalar product of the random predictor function 

<math display="inline" id="Generalized_functional_linear_model:0">
 <semantics>
  <mi>X</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>X</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   X
  </annotation>
 </semantics>
</math>

 with a smooth parameter function 

<math display="inline" id="Generalized_functional_linear_model:1">
 <semantics>
  <mi>β</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>β</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \beta
  </annotation>
 </semantics>
</math>

. Functional Linear Regression, Functional Poisson Regression and Functional Binomial Regression, with the important Functional Logistic Regression included, are special cases of GFLM. Applications of GFLM include classification and discrimination of stochastic processes and <a href="Functional_data_analysis" title="wikilink">functional data</a>.<a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a></p>
<h2 id="overview">Overview</h2>

<p>A key aspect of GFLM is estimation and inference for the smooth parameter function 

<math display="inline" id="Generalized_functional_linear_model:2">
 <semantics>
  <mi>β</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>β</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \beta
  </annotation>
 </semantics>
</math>

 which is usually obtained by <a href="Dimensionality_reduction" title="wikilink">dimension reduction</a> of the infinite dimensional functional predictor. A common method is to expand the predictor function 

<math display="inline" id="Generalized_functional_linear_model:3">
 <semantics>
  <mi>X</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>X</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   X
  </annotation>
 </semantics>
</math>

 in an <a href="Orthonormality" title="wikilink">orthonormal</a> <a href="Basis_function" title="wikilink">basis</a> of <a href="Lp_space" title="wikilink">L<sup>2</sup> space</a>, the <a href="Hilbert_space" title="wikilink">Hilbert space</a> of square integrable functions with the simultaneous expansion of the parameter function in the same basis. This representation is then combined with a truncation step to reduce the contribution of the parameter function 

<math display="inline" id="Generalized_functional_linear_model:4">
 <semantics>
  <mi>β</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>β</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \beta
  </annotation>
 </semantics>
</math>

 in the linear predictor to a finite number of regression coefficients. <a href="Functional_principal_component_analysis" title="wikilink">Functional principal component analysis</a> (FPCA) that employs the <a href="Karhunen–Loève_theorem" title="wikilink">Karhunen–Loève expansion</a> is a common and parsimonious approach to accomplish this. Other orthogonal expansions, like <a href="Fourier_series" title="wikilink">Fourier expansions</a> and <a class="uri" href="B-spline" title="wikilink">B-spline</a> expansions may also be employed for the dimension reduction step. The <a href="Akaike_information_criterion" title="wikilink">Akaike information criterion</a> (AIC) can be used for selecting the number of included components. Minimization of <a class="uri" href="cross-validation" title="wikilink">cross-validation</a> prediction errors is another criteria often used in classification applications. Once the dimension of the predictor process has been reduced, the simplified linear predictor allows to use GLM and <a class="uri" href="quasi-likelihood" title="wikilink">quasi-likelihood</a> estimation techniques to obtain estimates of the finite dimensional regression coefficients which in turn provide an estimate of the parameter function 

<math display="inline" id="Generalized_functional_linear_model:5">
 <semantics>
  <mi>β</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>β</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \beta
  </annotation>
 </semantics>
</math>

 in the GFLM.</p>
<h2 id="model-components">Model components</h2>
<h3 id="linear-predictor">Linear predictor</h3>

<p>The predictor functions 

<math display="inline" id="Generalized_functional_linear_model:6">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>X</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>t</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>,</mo>
    <mi>t</mi>
   </mrow>
   <mo>∈</mo>
   <mi>T</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <in></in>
    <list>
     <apply>
      <times></times>
      <ci>X</ci>
      <ci>t</ci>
     </apply>
     <ci>t</ci>
    </list>
    <ci>T</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \textstyle X(t),t\in T
  </annotation>
 </semantics>
</math>

, typically are square integrable stochastic processes on a real interval 

<math display="inline" id="Generalized_functional_linear_model:7">
 <semantics>
  <mi>T</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>T</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   T
  </annotation>
 </semantics>
</math>

 and the unknown smooth parameter function 

<math display="inline" id="Generalized_functional_linear_model:8">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>β</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>t</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>,</mo>
    <mi>t</mi>
   </mrow>
   <mo>∈</mo>
   <mi>T</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <in></in>
    <list>
     <apply>
      <times></times>
      <ci>β</ci>
      <ci>t</ci>
     </apply>
     <ci>t</ci>
    </list>
    <ci>T</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \beta(t),t\in T
  </annotation>
 </semantics>
</math>

, is assumed to be square integrable on 

<math display="inline" id="Generalized_functional_linear_model:9">
 <semantics>
  <mi>T</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>T</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   T
  </annotation>
 </semantics>
</math>

. Given a real measure 

<math display="inline" id="Generalized_functional_linear_model:10">
 <semantics>
  <mrow>
   <mi>d</mi>
   <mi>w</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>d</ci>
    <ci>w</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   dw
  </annotation>
 </semantics>
</math>

 on 

<math display="inline" id="Generalized_functional_linear_model:11">
 <semantics>
  <mi>T</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>T</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   T
  </annotation>
 </semantics>
</math>

, the linear predictor is given by 

<math display="inline" id="Generalized_functional_linear_model:12">
 <semantics>
  <mrow>
   <mi>η</mi>
   <mo>=</mo>
   <mrow>
    <mi>α</mi>
    <mo>+</mo>
    <mrow>
     <mo largeop="true" symmetric="true">∫</mo>
     <mrow>
      <msup>
       <mi>X</mi>
       <mi>c</mi>
      </msup>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>t</mi>
       <mo stretchy="false">)</mo>
      </mrow>
      <mi>β</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>t</mi>
       <mo rspace="4.2pt" stretchy="false">)</mo>
      </mrow>
      <mi>d</mi>
      <mi>w</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>t</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>η</ci>
    <apply>
     <plus></plus>
     <ci>α</ci>
     <apply>
      <int></int>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>X</ci>
        <ci>c</ci>
       </apply>
       <ci>t</ci>
       <ci>β</ci>
       <ci>t</ci>
       <ci>d</ci>
       <ci>w</ci>
       <ci>t</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \eta=\alpha+\int X^{c}(t)\beta(t)\,dw(t)
  </annotation>
 </semantics>
</math>

 where 

<math display="inline" id="Generalized_functional_linear_model:13">
 <semantics>
  <mrow>
   <mrow>
    <msup>
     <mi>X</mi>
     <mi>c</mi>
    </msup>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>t</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mi>X</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>t</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>-</mo>
    <mrow>
     <mtext>E</mtext>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mi>X</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>t</mi>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>X</ci>
      <ci>c</ci>
     </apply>
     <ci>t</ci>
    </apply>
    <apply>
     <minus></minus>
     <apply>
      <times></times>
      <ci>X</ci>
      <ci>t</ci>
     </apply>
     <apply>
      <times></times>
      <mtext>E</mtext>
      <apply>
       <times></times>
       <ci>X</ci>
       <ci>t</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   X^{c}(t)=X(t)-\text{E}(X(t))
  </annotation>
 </semantics>
</math>

 is the centered predictor process and 

<math display="inline" id="Generalized_functional_linear_model:14">
 <semantics>
  <mi>α</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>α</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \alpha
  </annotation>
 </semantics>
</math>

 is a scalar that serves as an intercept.</p>
<h3 id="response-variable-and-variance-function">Response variable and variance function</h3>

<p>The outcome 

<math display="inline" id="Generalized_functional_linear_model:15">
 <semantics>
  <mi>Y</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>Y</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Y
  </annotation>
 </semantics>
</math>

 is typically a real valued random variable which may be either continuous or discrete. Often the conditional distribution of 

<math display="inline" id="Generalized_functional_linear_model:16">
 <semantics>
  <mi>Y</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>Y</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Y
  </annotation>
 </semantics>
</math>

 given the predictor process is specified within the <a href="exponential_family" title="wikilink">exponential family</a>. However it is also sufficient to consider the functional quasi-likelihood set up, where instead of the distribution of the response one specifies the conditional <a href="variance_function" title="wikilink">variance function</a>, 

<math display="inline" id="Generalized_functional_linear_model:17">
 <semantics>
  <mrow>
   <mi>Var</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi mathvariant="normal">Y</mi>
    <mo>∣</mo>
    <mi mathvariant="normal">X</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>=</mo>
   <msup>
    <mi>σ</mi>
    <mn>2</mn>
   </msup>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>μ</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">Var</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">Y</csymbol>
     <ci>normal-∣</ci>
     <csymbol cd="unknown">X</csymbol>
     <ci>normal-)</ci>
    </cerror>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>σ</ci>
     <cn type="integer">2</cn>
    </apply>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">μ</csymbol>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \rm{Var}(Y\mid X)=\sigma^{2}(\mu)
  </annotation>
 </semantics>
</math>

, as a function of the conditional mean, 

<math display="inline" id="Generalized_functional_linear_model:18">
 <semantics>
  <mrow>
   <mi mathvariant="normal">E</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi mathvariant="normal">Y</mi>
    <mo>∣</mo>
    <mi mathvariant="normal">X</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>=</mo>
   <mi>μ</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">E</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">Y</csymbol>
     <ci>normal-∣</ci>
     <csymbol cd="unknown">X</csymbol>
     <ci>normal-)</ci>
    </cerror>
    <eq></eq>
    <csymbol cd="unknown">μ</csymbol>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \rm{E}(Y\mid X)=\mu
  </annotation>
 </semantics>
</math>

.</p>
<h3 id="link-function">Link function</h3>

<p>The link function 

<math display="inline" id="Generalized_functional_linear_model:19">
 <semantics>
  <mi>g</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>g</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   g
  </annotation>
 </semantics>
</math>

 is a smooth invertible function, that relates the conditional mean of the response 

<math display="inline" id="Generalized_functional_linear_model:20">
 <semantics>
  <mrow>
   <mi mathvariant="normal">E</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi mathvariant="normal">Y</mi>
    <mo>∣</mo>
    <mi mathvariant="normal">X</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>=</mo>
   <mi>μ</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">E</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">Y</csymbol>
     <ci>normal-∣</ci>
     <csymbol cd="unknown">X</csymbol>
     <ci>normal-)</ci>
    </cerror>
    <eq></eq>
    <csymbol cd="unknown">μ</csymbol>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \rm{E}(Y\mid X)=\mu
  </annotation>
 </semantics>
</math>

 with the linear predictor 

<math display="inline" id="Generalized_functional_linear_model:21">
 <semantics>
  <mrow>
   <mi>η</mi>
   <mo>=</mo>
   <mrow>
    <mi>α</mi>
    <mo>+</mo>
    <mrow>
     <mo largeop="true" symmetric="true">∫</mo>
     <mrow>
      <msup>
       <mi>X</mi>
       <mi>c</mi>
      </msup>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>t</mi>
       <mo stretchy="false">)</mo>
      </mrow>
      <mi>β</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>t</mi>
       <mo rspace="4.2pt" stretchy="false">)</mo>
      </mrow>
      <mi>d</mi>
      <mi>w</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>t</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>η</ci>
    <apply>
     <plus></plus>
     <ci>α</ci>
     <apply>
      <int></int>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>X</ci>
        <ci>c</ci>
       </apply>
       <ci>t</ci>
       <ci>β</ci>
       <ci>t</ci>
       <ci>d</ci>
       <ci>w</ci>
       <ci>t</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \eta=\alpha+\int X^{c}(t)\beta(t)\,dw(t)
  </annotation>
 </semantics>
</math>

. The relationship is given by 

<math display="inline" id="Generalized_functional_linear_model:22">
 <semantics>
  <mrow>
   <mi>μ</mi>
   <mo>=</mo>
   <mrow>
    <mi>g</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>η</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>μ</ci>
    <apply>
     <times></times>
     <ci>g</ci>
     <ci>η</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mu=g(\eta)
  </annotation>
 </semantics>
</math>

.</p>
<h2 id="formulation">Formulation</h2>

<p>In order to implement the necessary dimension reduction, the centered predictor process 

<math display="inline" id="Generalized_functional_linear_model:23">
 <semantics>
  <mrow>
   <msup>
    <mi>X</mi>
    <mi>c</mi>
   </msup>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>t</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>X</ci>
     <ci>c</ci>
    </apply>
    <ci>t</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   X^{c}(t)
  </annotation>
 </semantics>
</math>

 and the parameter function 

<math display="inline" id="Generalized_functional_linear_model:24">
 <semantics>
  <mrow>
   <mi>β</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>t</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>β</ci>
    <ci>t</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \beta(t)
  </annotation>
 </semantics>
</math>

 are expanded as,</p>

<p>

<math display="block" id="Generalized_functional_linear_model:25">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <msup>
      <mi>X</mi>
      <mi>c</mi>
     </msup>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>t</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <munderover>
      <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
      <mrow>
       <mi>j</mi>
       <mo>=</mo>
       <mn>1</mn>
      </mrow>
      <mi mathvariant="normal">∞</mi>
     </munderover>
     <mrow>
      <msub>
       <mi>ξ</mi>
       <mi>j</mi>
      </msub>
      <msub>
       <mi>ρ</mi>
       <mi>j</mi>
      </msub>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>t</mi>
       <mo stretchy="false">)</mo>
      </mrow>
      <mtext>and</mtext>
      <mi>β</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>t</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <munderover>
      <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
      <mrow>
       <mi>j</mi>
       <mo>=</mo>
       <mn>1</mn>
      </mrow>
      <mi mathvariant="normal">∞</mi>
     </munderover>
     <mrow>
      <msub>
       <mi>β</mi>
       <mi>j</mi>
      </msub>
      <msub>
       <mi>ρ</mi>
       <mi>j</mi>
      </msub>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>t</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>X</ci>
       <ci>c</ci>
      </apply>
      <ci>t</ci>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <apply>
         <eq></eq>
         <ci>j</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <infinity></infinity>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>ξ</ci>
        <ci>j</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>ρ</ci>
        <ci>j</ci>
       </apply>
       <ci>t</ci>
       <mtext>and</mtext>
       <ci>β</ci>
       <ci>t</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <apply>
         <eq></eq>
         <ci>j</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <infinity></infinity>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>β</ci>
        <ci>j</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>ρ</ci>
        <ci>j</ci>
       </apply>
       <ci>t</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   X^{c}(t)=\sum_{j=1}^{\infty}\xi_{j}\rho_{j}(t)\text{ and }\beta(t)=\sum_{j=1}^%
{\infty}\beta_{j}\rho_{j}(t),
  </annotation>
 </semantics>
</math>

</p>

<p>where 

<math display="inline" id="Generalized_functional_linear_model:26">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <msub>
      <mi>ρ</mi>
      <mi>j</mi>
     </msub>
     <mo>,</mo>
     <mi>j</mi>
    </mrow>
    <mo>=</mo>
    <mn>1</mn>
   </mrow>
   <mo>,</mo>
   <mrow>
    <mn>2</mn>
    <mo>,</mo>
    <mi mathvariant="normal">…</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <eq></eq>
     <list>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>ρ</ci>
       <ci>j</ci>
      </apply>
      <ci>j</ci>
     </list>
     <cn type="integer">1</cn>
    </apply>
    <list>
     <cn type="integer">2</cn>
     <ci>normal-…</ci>
    </list>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \rho_{j},j=1,2,\ldots
  </annotation>
 </semantics>
</math>

 is an orthonormal basis of the function space 

<math display="inline" id="Generalized_functional_linear_model:27">
 <semantics>
  <mrow>
   <mrow>
    <msup>
     <mi>L</mi>
     <mn>2</mn>
    </msup>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>d</mi>
      <mi>w</mi>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>L</ci>
     <cn type="integer">2</cn>
    </apply>
    <apply>
     <times></times>
     <ci>d</ci>
     <ci>w</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   L^{2}(dw),
  </annotation>
 </semantics>
</math>

 such that 

<math display="inline" id="Generalized_functional_linear_model:28">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mo largeop="true" symmetric="true">∫</mo>
     <mi>T</mi>
    </msub>
    <mrow>
     <msub>
      <mi>ρ</mi>
      <mi>j</mi>
     </msub>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>t</mi>
      <mo stretchy="false">)</mo>
     </mrow>
     <msub>
      <mi>ρ</mi>
      <mi>k</mi>
     </msub>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>t</mi>
      <mo rspace="4.2pt" stretchy="false">)</mo>
     </mrow>
     <mi>d</mi>
     <mi>w</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>t</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>=</mo>
   <msub>
    <mi>δ</mi>
    <mrow>
     <mi>j</mi>
     <mi>k</mi>
    </mrow>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <int></int>
      <ci>T</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>ρ</ci>
       <ci>j</ci>
      </apply>
      <ci>t</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>ρ</ci>
       <ci>k</ci>
      </apply>
      <ci>t</ci>
      <ci>d</ci>
      <ci>w</ci>
      <ci>t</ci>
     </apply>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>δ</ci>
     <apply>
      <times></times>
      <ci>j</ci>
      <ci>k</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \int_{T}\rho_{j}(t)\rho_{k}(t)\,dw(t)=\delta_{jk}
  </annotation>
 </semantics>
</math>

 where 

<math display="inline" id="Generalized_functional_linear_model:29">
 <semantics>
  <mrow>
   <msub>
    <mi>δ</mi>
    <mrow>
     <mi>j</mi>
     <mi>k</mi>
    </mrow>
   </msub>
   <mo>=</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>δ</ci>
     <apply>
      <times></times>
      <ci>j</ci>
      <ci>k</ci>
     </apply>
    </apply>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \delta_{jk}=1
  </annotation>
 </semantics>
</math>

 if 

<math display="inline" id="Generalized_functional_linear_model:30">
 <semantics>
  <mrow>
   <mi>j</mi>
   <mo>=</mo>
   <mi>k</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>j</ci>
    <ci>k</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   j=k
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Generalized_functional_linear_model:31">
 <semantics>
  <mn>0</mn>
  <annotation-xml encoding="MathML-Content">
   <cn type="integer">0</cn>
  </annotation-xml>
 </semantics>
</math>

 otherwise.</p>

<p>The random variables 

<math display="inline" id="Generalized_functional_linear_model:32">
 <semantics>
  <msub>
   <mi>ξ</mi>
   <mi>j</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>ξ</ci>
    <ci>j</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \xi_{j}
  </annotation>
 </semantics>
</math>

 are given by 

<math display="inline" id="Generalized_functional_linear_model:33">
 <semantics>
  <mrow>
   <msub>
    <mi>ξ</mi>
    <mi>j</mi>
   </msub>
   <mo>=</mo>
   <mrow>
    <mo largeop="true" symmetric="true">∫</mo>
    <mrow>
     <msup>
      <mi>X</mi>
      <mi>c</mi>
     </msup>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>t</mi>
      <mo stretchy="false">)</mo>
     </mrow>
     <msub>
      <mi>ρ</mi>
      <mi>j</mi>
     </msub>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>t</mi>
      <mo rspace="4.2pt" stretchy="false">)</mo>
     </mrow>
     <mi>d</mi>
     <mi>w</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>t</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>ξ</ci>
     <ci>j</ci>
    </apply>
    <apply>
     <int></int>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>X</ci>
       <ci>c</ci>
      </apply>
      <ci>t</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>ρ</ci>
       <ci>j</ci>
      </apply>
      <ci>t</ci>
      <ci>d</ci>
      <ci>w</ci>
      <ci>t</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \xi_{j}=\int X^{c}(t)\rho_{j}(t)\,dw(t)
  </annotation>
 </semantics>
</math>

 and the coefficients 

<math display="inline" id="Generalized_functional_linear_model:34">
 <semantics>
  <msub>
   <mi>β</mi>
   <mi>j</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>β</ci>
    <ci>j</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \beta_{j}
  </annotation>
 </semantics>
</math>

 as 

<math display="inline" id="Generalized_functional_linear_model:35">
 <semantics>
  <mrow>
   <msub>
    <mi>β</mi>
    <mi>j</mi>
   </msub>
   <mo>=</mo>
   <mrow>
    <mo largeop="true" symmetric="true">∫</mo>
    <mrow>
     <mi>β</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>t</mi>
      <mo stretchy="false">)</mo>
     </mrow>
     <msub>
      <mi>ρ</mi>
      <mi>j</mi>
     </msub>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>t</mi>
      <mo rspace="4.2pt" stretchy="false">)</mo>
     </mrow>
     <mi>d</mi>
     <mi>w</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>t</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>β</ci>
     <ci>j</ci>
    </apply>
    <apply>
     <int></int>
     <apply>
      <times></times>
      <ci>β</ci>
      <ci>t</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>ρ</ci>
       <ci>j</ci>
      </apply>
      <ci>t</ci>
      <ci>d</ci>
      <ci>w</ci>
      <ci>t</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \beta_{j}=\int\beta(t)\rho_{j}(t)\,dw(t)
  </annotation>
 </semantics>
</math>

 for 

<math display="inline" id="Generalized_functional_linear_model:36">
 <semantics>
  <mrow>
   <mi>j</mi>
   <mo>=</mo>
   <mrow>
    <mn>1</mn>
    <mo>,</mo>
    <mn>2</mn>
    <mo>,</mo>
    <mi mathvariant="normal">…</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>j</ci>
    <list>
     <cn type="integer">1</cn>
     <cn type="integer">2</cn>
     <ci>normal-…</ci>
    </list>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   j=1,2,\ldots
  </annotation>
 </semantics>
</math>

.</p>

<p>Note that 

<math display="inline" id="Generalized_functional_linear_model:37">
 <semantics>
  <mrow>
   <mrow>
    <mtext>E</mtext>
    <mrow>
     <mo stretchy="false">(</mo>
     <msub>
      <mi>ξ</mi>
      <mi>j</mi>
     </msub>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <mtext>E</mtext>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>ξ</ci>
      <ci>j</ci>
     </apply>
    </apply>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \text{E}(\xi_{j})=0
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Generalized_functional_linear_model:38">
 <semantics>
  <mrow>
   <mrow>
    <msubsup>
     <mo largeop="true" symmetric="true">∑</mo>
     <mrow>
      <mi>j</mi>
      <mo>=</mo>
      <mn>1</mn>
     </mrow>
     <mi mathvariant="normal">∞</mi>
    </msubsup>
    <msubsup>
     <mi>β</mi>
     <mi>j</mi>
     <mn>2</mn>
    </msubsup>
   </mrow>
   <mo><</mo>
   <mi mathvariant="normal">∞</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <lt></lt>
    <apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <apply>
        <eq></eq>
        <ci>j</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <infinity></infinity>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>β</ci>
       <ci>j</ci>
      </apply>
      <cn type="integer">2</cn>
     </apply>
    </apply>
    <infinity></infinity>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \sum_{j=1}^{\infty}\beta_{j}^{2}<\infty
  </annotation>
 </semantics>
</math>

 and denoting 

<math display="inline" id="Generalized_functional_linear_model:39">
 <semantics>
  <mrow>
   <msubsup>
    <mi>σ</mi>
    <mi>j</mi>
    <mn>2</mn>
   </msubsup>
   <mo>=</mo>
   <mrow>
    <mtext>Var</mtext>
    <mrow>
     <mo stretchy="false">(</mo>
     <msub>
      <mi>ξ</mi>
      <mi>j</mi>
     </msub>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mtext>E</mtext>
    <mrow>
     <mo stretchy="false">(</mo>
     <msubsup>
      <mi>ξ</mi>
      <mi>j</mi>
      <mn>2</mn>
     </msubsup>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>σ</ci>
       <ci>j</ci>
      </apply>
      <cn type="integer">2</cn>
     </apply>
     <apply>
      <times></times>
      <mtext>Var</mtext>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>ξ</ci>
       <ci>j</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <mtext>E</mtext>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>ξ</ci>
        <ci>j</ci>
       </apply>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \sigma_{j}^{2}=\text{Var}(\xi_{j})=\text{E}(\xi_{j}^{2})
  </annotation>
 </semantics>
</math>

, we also have 

<math display="inline" id="Generalized_functional_linear_model:40">
 <semantics>
  <mrow>
   <mrow>
    <msubsup>
     <mo largeop="true" symmetric="true">∑</mo>
     <mrow>
      <mi>j</mi>
      <mo>=</mo>
      <mn>1</mn>
     </mrow>
     <mi mathvariant="normal">∞</mi>
    </msubsup>
    <msubsup>
     <mi>σ</mi>
     <mi>j</mi>
     <mn>2</mn>
    </msubsup>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mo largeop="true" symmetric="true">∫</mo>
    <mrow>
     <mtext>E</mtext>
     <mpadded width="+1.7pt">
      <msup>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <msup>
          <mi>X</mi>
          <mi>c</mi>
         </msup>
         <mrow>
          <mo stretchy="false">(</mo>
          <mi>t</mi>
          <mo stretchy="false">)</mo>
         </mrow>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
       <mn>2</mn>
      </msup>
     </mpadded>
     <mi>d</mi>
     <mi>w</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>t</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo><</mo>
   <mi mathvariant="normal">∞</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <apply>
         <eq></eq>
         <ci>j</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <infinity></infinity>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>σ</ci>
        <ci>j</ci>
       </apply>
       <cn type="integer">2</cn>
      </apply>
     </apply>
     <apply>
      <int></int>
      <apply>
       <times></times>
       <mtext>E</mtext>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <times></times>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>X</ci>
          <ci>c</ci>
         </apply>
         <ci>t</ci>
        </apply>
        <cn type="integer">2</cn>
       </apply>
       <ci>d</ci>
       <ci>w</ci>
       <ci>t</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <lt></lt>
     <share href="#.cmml">
     </share>
     <infinity></infinity>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \sum_{j=1}^{\infty}\sigma_{j}^{2}=\int\text{E}(X^{c}(t))^{2}\,dw(t)<\infty
  </annotation>
 </semantics>
</math>

.</p>

<p>From the orthonormality of the basis functions 

<math display="inline" id="Generalized_functional_linear_model:41">
 <semantics>
  <msub>
   <mi>ρ</mi>
   <mi>j</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>ρ</ci>
    <ci>j</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \rho_{j}
  </annotation>
 </semantics>
</math>

, it follows immediately that 

<math display="inline" id="Generalized_functional_linear_model:42">
 <semantics>
  <mrow>
   <mrow>
    <mo largeop="true" symmetric="true">∫</mo>
    <mrow>
     <msup>
      <mi>X</mi>
      <mi>c</mi>
     </msup>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>t</mi>
      <mo stretchy="false">)</mo>
     </mrow>
     <mi>β</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>t</mi>
      <mo rspace="4.2pt" stretchy="false">)</mo>
     </mrow>
     <mi>d</mi>
     <mi>w</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>t</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <msubsup>
     <mo largeop="true" symmetric="true">∑</mo>
     <mrow>
      <mi>j</mi>
      <mo>=</mo>
      <mn>1</mn>
     </mrow>
     <mi mathvariant="normal">∞</mi>
    </msubsup>
    <mrow>
     <msub>
      <mi>β</mi>
      <mi>j</mi>
     </msub>
     <msub>
      <mi>ξ</mi>
      <mi>j</mi>
     </msub>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <int></int>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>X</ci>
       <ci>c</ci>
      </apply>
      <ci>t</ci>
      <ci>β</ci>
      <ci>t</ci>
      <ci>d</ci>
      <ci>w</ci>
      <ci>t</ci>
     </apply>
    </apply>
    <apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <apply>
        <eq></eq>
        <ci>j</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <infinity></infinity>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>β</ci>
       <ci>j</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>ξ</ci>
       <ci>j</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \int X^{c}(t)\beta(t)\,dw(t)=\sum_{j=1}^{\infty}\beta_{j}\xi_{j}
  </annotation>
 </semantics>
</math>

.</p>

<p>The key step is then approximating 

<math display="inline" id="Generalized_functional_linear_model:43">
 <semantics>
  <mrow>
   <mi>η</mi>
   <mo>=</mo>
   <mrow>
    <mi>α</mi>
    <mo>+</mo>
    <mrow>
     <mo largeop="true" symmetric="true">∫</mo>
     <mrow>
      <msup>
       <mi>X</mi>
       <mi>c</mi>
      </msup>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>t</mi>
       <mo stretchy="false">)</mo>
      </mrow>
      <mi>β</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>t</mi>
       <mo rspace="4.2pt" stretchy="false">)</mo>
      </mrow>
      <mi>d</mi>
      <mi>w</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>t</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mi>α</mi>
    <mo>+</mo>
    <mrow>
     <msubsup>
      <mo largeop="true" symmetric="true">∑</mo>
      <mrow>
       <mi>j</mi>
       <mo>=</mo>
       <mn>1</mn>
      </mrow>
      <mi mathvariant="normal">∞</mi>
     </msubsup>
     <mrow>
      <msub>
       <mi>β</mi>
       <mi>j</mi>
      </msub>
      <msub>
       <mi>ξ</mi>
       <mi>j</mi>
      </msub>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <ci>η</ci>
     <apply>
      <plus></plus>
      <ci>α</ci>
      <apply>
       <int></int>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>X</ci>
         <ci>c</ci>
        </apply>
        <ci>t</ci>
        <ci>β</ci>
        <ci>t</ci>
        <ci>d</ci>
        <ci>w</ci>
        <ci>t</ci>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <plus></plus>
      <ci>α</ci>
      <apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <sum></sum>
         <apply>
          <eq></eq>
          <ci>j</ci>
          <cn type="integer">1</cn>
         </apply>
        </apply>
        <infinity></infinity>
       </apply>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>β</ci>
         <ci>j</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>ξ</ci>
         <ci>j</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \eta=\alpha+\int X^{c}(t)\beta(t)\,dw(t)=\alpha+\sum_{j=1}^{\infty}\beta_{j}%
\xi_{j}
  </annotation>
 </semantics>
</math>

 by 

<math display="inline" id="Generalized_functional_linear_model:44">
 <semantics>
  <mrow>
   <mi>η</mi>
   <mo>≈</mo>
   <mrow>
    <mi>α</mi>
    <mo>+</mo>
    <mrow>
     <msubsup>
      <mo largeop="true" symmetric="true">∑</mo>
      <mrow>
       <mi>j</mi>
       <mo>=</mo>
       <mn>1</mn>
      </mrow>
      <mi>p</mi>
     </msubsup>
     <mrow>
      <msub>
       <mi>β</mi>
       <mi>j</mi>
      </msub>
      <msub>
       <mi>ξ</mi>
       <mi>j</mi>
      </msub>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <approx></approx>
    <ci>η</ci>
    <apply>
     <plus></plus>
     <ci>α</ci>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <apply>
         <eq></eq>
         <ci>j</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <ci>p</ci>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>β</ci>
        <ci>j</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>ξ</ci>
        <ci>j</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \eta\approx\alpha+\sum_{j=1}^{p}\beta_{j}\xi_{j}
  </annotation>
 </semantics>
</math>

 for a suitably chosen truncation point 

<math display="inline" id="Generalized_functional_linear_model:45">
 <semantics>
  <mi>p</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>p</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p
  </annotation>
 </semantics>
</math>

.</p>

<p>FPCA gives the most parsimonious approximation of the linear predictor for a given number of basis functions as the eigenfunction basis explains more of the variation than any other set of basis functions.</p>

<p>For a differentiable link function with bounded first derivative, the approximation error of the 

<math display="inline" id="Generalized_functional_linear_model:46">
 <semantics>
  <mi>p</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>p</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p
  </annotation>
 </semantics>
</math>

-truncated model i.e. the linear predictor trunctated to the summation of the first 

<math display="inline" id="Generalized_functional_linear_model:47">
 <semantics>
  <mi>p</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>p</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p
  </annotation>
 </semantics>
</math>

 components, is a constant multiple of 

<math display="inline" id="Generalized_functional_linear_model:48">
 <semantics>
  <mrow>
   <mrow>
    <mtext>Var</mtext>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <msubsup>
       <mo largeop="true" symmetric="true">∑</mo>
       <mrow>
        <mi>j</mi>
        <mo>=</mo>
        <mrow>
         <mi>p</mi>
         <mo>+</mo>
         <mn>1</mn>
        </mrow>
       </mrow>
       <mi mathvariant="normal">∞</mi>
      </msubsup>
      <mrow>
       <msub>
        <mi>β</mi>
        <mi>j</mi>
       </msub>
       <msub>
        <mi>ξ</mi>
        <mi>j</mi>
       </msub>
      </mrow>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mtext>E</mtext>
    <mrow>
     <mo>(</mo>
     <msup>
      <mrow>
       <mo>(</mo>
       <mrow>
        <msubsup>
         <mo largeop="true" symmetric="true">∑</mo>
         <mrow>
          <mi>j</mi>
          <mo>=</mo>
          <mrow>
           <mi>p</mi>
           <mo>+</mo>
           <mn>1</mn>
          </mrow>
         </mrow>
         <mi mathvariant="normal">∞</mi>
        </msubsup>
        <mrow>
         <msub>
          <mi>β</mi>
          <mi>j</mi>
         </msub>
         <msub>
          <mi>ξ</mi>
          <mi>j</mi>
         </msub>
        </mrow>
       </mrow>
       <mo>)</mo>
      </mrow>
      <mn>2</mn>
     </msup>
     <mo>)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <msubsup>
     <mo largeop="true" symmetric="true">∑</mo>
     <mrow>
      <mi>j</mi>
      <mo>=</mo>
      <mrow>
       <mi>p</mi>
       <mo>+</mo>
       <mn>1</mn>
      </mrow>
     </mrow>
     <mi mathvariant="normal">∞</mi>
    </msubsup>
    <mrow>
     <msub>
      <mi>β</mi>
      <mi>j</mi>
     </msub>
     <msubsup>
      <mi>σ</mi>
      <mi>j</mi>
      <mn>2</mn>
     </msubsup>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <times></times>
      <mtext>Var</mtext>
      <apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <sum></sum>
         <apply>
          <eq></eq>
          <ci>j</ci>
          <apply>
           <plus></plus>
           <ci>p</ci>
           <cn type="integer">1</cn>
          </apply>
         </apply>
        </apply>
        <infinity></infinity>
       </apply>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>β</ci>
         <ci>j</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>ξ</ci>
         <ci>j</ci>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <mtext>E</mtext>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <sum></sum>
          <apply>
           <eq></eq>
           <ci>j</ci>
           <apply>
            <plus></plus>
            <ci>p</ci>
            <cn type="integer">1</cn>
           </apply>
          </apply>
         </apply>
         <infinity></infinity>
        </apply>
        <apply>
         <times></times>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>β</ci>
          <ci>j</ci>
         </apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>ξ</ci>
          <ci>j</ci>
         </apply>
        </apply>
       </apply>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <apply>
         <eq></eq>
         <ci>j</ci>
         <apply>
          <plus></plus>
          <ci>p</ci>
          <cn type="integer">1</cn>
         </apply>
        </apply>
       </apply>
       <infinity></infinity>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>β</ci>
        <ci>j</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>σ</ci>
         <ci>j</ci>
        </apply>
        <cn type="integer">2</cn>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \text{Var}(\sum_{j=p+1}^{\infty}\beta_{j}\xi_{j})=\text{E}\left(\left(\sum_{j=%
p+1}^{\infty}\beta_{j}\xi_{j}\right)^{2}\right)=\sum_{j=p+1}^{\infty}\beta_{j}%
\sigma_{j}^{2}
  </annotation>
 </semantics>
</math>

.</p>

<p>A heuristic motivation for the truncation strategy derives from the fact that 

<math display="inline" id="Generalized_functional_linear_model:49">
 <semantics>
  <mrow>
   <mrow>
    <mtext>E</mtext>
    <mrow>
     <mo>(</mo>
     <msup>
      <mrow>
       <mo>(</mo>
       <mrow>
        <msubsup>
         <mo largeop="true" symmetric="true">∑</mo>
         <mrow>
          <mi>j</mi>
          <mo>=</mo>
          <mrow>
           <mi>p</mi>
           <mo>+</mo>
           <mn>1</mn>
          </mrow>
         </mrow>
         <mi mathvariant="normal">∞</mi>
        </msubsup>
        <mrow>
         <msub>
          <mi>β</mi>
          <mi>j</mi>
         </msub>
         <msub>
          <mi>ξ</mi>
          <mi>j</mi>
         </msub>
        </mrow>
       </mrow>
       <mo>)</mo>
      </mrow>
      <mn>2</mn>
     </msup>
     <mo>)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <msubsup>
     <mo largeop="true" symmetric="true">∑</mo>
     <mrow>
      <mi>j</mi>
      <mo>=</mo>
      <mrow>
       <mi>p</mi>
       <mo>+</mo>
       <mn>1</mn>
      </mrow>
     </mrow>
     <mi mathvariant="normal">∞</mi>
    </msubsup>
    <mrow>
     <msub>
      <mi>β</mi>
      <mi>j</mi>
     </msub>
     <msubsup>
      <mi>σ</mi>
      <mi>j</mi>
      <mn>2</mn>
     </msubsup>
    </mrow>
   </mrow>
   <mo>≤</mo>
   <mrow>
    <msubsup>
     <mo largeop="true" symmetric="true">∑</mo>
     <mrow>
      <mi>j</mi>
      <mo>=</mo>
      <mrow>
       <mi>p</mi>
       <mo>+</mo>
       <mn>1</mn>
      </mrow>
     </mrow>
     <mi mathvariant="normal">∞</mi>
    </msubsup>
    <mrow>
     <mpadded width="+5pt">
      <msubsup>
       <mi>β</mi>
       <mi>j</mi>
       <mn>2</mn>
      </msubsup>
     </mpadded>
     <mrow>
      <msubsup>
       <mo largeop="true" symmetric="true">∑</mo>
       <mrow>
        <mi>j</mi>
        <mo>=</mo>
        <mrow>
         <mi>p</mi>
         <mo>+</mo>
         <mn>1</mn>
        </mrow>
       </mrow>
       <mi mathvariant="normal">∞</mi>
      </msubsup>
      <msubsup>
       <mi>σ</mi>
       <mi>j</mi>
       <mn>2</mn>
      </msubsup>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <times></times>
      <mtext>E</mtext>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <sum></sum>
          <apply>
           <eq></eq>
           <ci>j</ci>
           <apply>
            <plus></plus>
            <ci>p</ci>
            <cn type="integer">1</cn>
           </apply>
          </apply>
         </apply>
         <infinity></infinity>
        </apply>
        <apply>
         <times></times>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>β</ci>
          <ci>j</ci>
         </apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>ξ</ci>
          <ci>j</ci>
         </apply>
        </apply>
       </apply>
       <cn type="integer">2</cn>
      </apply>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <apply>
         <eq></eq>
         <ci>j</ci>
         <apply>
          <plus></plus>
          <ci>p</ci>
          <cn type="integer">1</cn>
         </apply>
        </apply>
       </apply>
       <infinity></infinity>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>β</ci>
        <ci>j</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>σ</ci>
         <ci>j</ci>
        </apply>
        <cn type="integer">2</cn>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <leq></leq>
     <share href="#.cmml">
     </share>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <apply>
         <eq></eq>
         <ci>j</ci>
         <apply>
          <plus></plus>
          <ci>p</ci>
          <cn type="integer">1</cn>
         </apply>
        </apply>
       </apply>
       <infinity></infinity>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>β</ci>
         <ci>j</ci>
        </apply>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <sum></sum>
          <apply>
           <eq></eq>
           <ci>j</ci>
           <apply>
            <plus></plus>
            <ci>p</ci>
            <cn type="integer">1</cn>
           </apply>
          </apply>
         </apply>
         <infinity></infinity>
        </apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>σ</ci>
          <ci>j</ci>
         </apply>
         <cn type="integer">2</cn>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \text{E}\left(\left(\sum_{j=p+1}^{\infty}\beta_{j}\xi_{j}\right)^{2}\right)=%
\sum_{j=p+1}^{\infty}\beta_{j}\sigma_{j}^{2}\leq\sum_{j=p+1}^{\infty}\beta_{j}%
^{2}\ \sum_{j=p+1}^{\infty}\sigma_{j}^{2}
  </annotation>
 </semantics>
</math>

 which is a consequence of the <a href="Cauchy–Schwarz_inequality" title="wikilink">Cauchy–Schwarz inequality</a> and by noting that the right hand side of the last inequality converges to 0 as 

<math display="inline" id="Generalized_functional_linear_model:50">
 <semantics>
  <mrow>
   <mi>p</mi>
   <mo>→</mo>
   <mi mathvariant="normal">∞</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-→</ci>
    <ci>p</ci>
    <infinity></infinity>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p\rightarrow\infty
  </annotation>
 </semantics>
</math>

 since both 

<math display="inline" id="Generalized_functional_linear_model:51">
 <semantics>
  <mrow>
   <msubsup>
    <mo largeop="true" symmetric="true">∑</mo>
    <mrow>
     <mi>j</mi>
     <mo>=</mo>
     <mn>1</mn>
    </mrow>
    <mi mathvariant="normal">∞</mi>
   </msubsup>
   <msubsup>
    <mi>β</mi>
    <mi>j</mi>
    <mn>2</mn>
   </msubsup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <sum></sum>
      <apply>
       <eq></eq>
       <ci>j</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <infinity></infinity>
    </apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>β</ci>
      <ci>j</ci>
     </apply>
     <cn type="integer">2</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \sum_{j=1}^{\infty}\beta_{j}^{2}
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Generalized_functional_linear_model:52">
 <semantics>
  <mrow>
   <msubsup>
    <mo largeop="true" symmetric="true">∑</mo>
    <mrow>
     <mi>j</mi>
     <mo>=</mo>
     <mn>1</mn>
    </mrow>
    <mi mathvariant="normal">∞</mi>
   </msubsup>
   <msubsup>
    <mi>σ</mi>
    <mi>j</mi>
    <mn>2</mn>
   </msubsup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <sum></sum>
      <apply>
       <eq></eq>
       <ci>j</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <infinity></infinity>
    </apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>σ</ci>
      <ci>j</ci>
     </apply>
     <cn type="integer">2</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \sum_{j=1}^{\infty}\sigma_{j}^{2}
  </annotation>
 </semantics>
</math>

 are finite.</p>

<p>For the special case of the eigenfunction basis, the sequence 

<math display="inline" id="Generalized_functional_linear_model:53">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <msubsup>
      <mi>σ</mi>
      <mi>j</mi>
      <mn>2</mn>
     </msubsup>
     <mo>,</mo>
     <mi>j</mi>
    </mrow>
    <mo>=</mo>
    <mn>1</mn>
   </mrow>
   <mo>,</mo>
   <mrow>
    <mn>2</mn>
    <mo>,</mo>
    <mi mathvariant="normal">…</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <eq></eq>
     <list>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>σ</ci>
        <ci>j</ci>
       </apply>
       <cn type="integer">2</cn>
      </apply>
      <ci>j</ci>
     </list>
     <cn type="integer">1</cn>
    </apply>
    <list>
     <cn type="integer">2</cn>
     <ci>normal-…</ci>
    </list>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \sigma_{j}^{2},j=1,2,\ldots
  </annotation>
 </semantics>
</math>

 corresponds to the sequence of the eigenvalues of the covariance kernel 

<math display="inline" id="Generalized_functional_linear_model:54">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>G</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>s</mi>
      <mo>,</mo>
      <mi>t</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mtext>Cov</mtext>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mi>X</mi>
        <mrow>
         <mo stretchy="false">(</mo>
         <mi>s</mi>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
       <mo>,</mo>
       <mrow>
        <mi>X</mi>
        <mrow>
         <mo stretchy="false">(</mo>
         <mi>t</mi>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo rspace="7.5pt">,</mo>
     <mi>s</mi>
    </mrow>
   </mrow>
   <mo>,</mo>
   <mrow>
    <mi>t</mi>
    <mo>∈</mo>
    <mi>T</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <eq></eq>
     <apply>
      <times></times>
      <ci>G</ci>
      <interval closure="open">
       <ci>s</ci>
       <ci>t</ci>
      </interval>
     </apply>
     <list>
      <apply>
       <times></times>
       <mtext>Cov</mtext>
       <interval closure="open">
        <apply>
         <times></times>
         <ci>X</ci>
         <ci>s</ci>
        </apply>
        <apply>
         <times></times>
         <ci>X</ci>
         <ci>t</ci>
        </apply>
       </interval>
      </apply>
      <ci>s</ci>
     </list>
    </apply>
    <apply>
     <in></in>
     <ci>t</ci>
     <ci>T</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   G(s,t)=\text{Cov}(X(s),X(t)),\ s,t\in T
  </annotation>
 </semantics>
</math>

.</p>

<p>For data with 

<math display="inline" id="Generalized_functional_linear_model:55">
 <semantics>
  <mi>n</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>n</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n
  </annotation>
 </semantics>
</math>

 <em>i.i.d</em> observations, setting 

<math display="inline" id="Generalized_functional_linear_model:56">
 <semantics>
  <mrow>
   <msubsup>
    <mi>ξ</mi>
    <mi>j</mi>
    <mn>0</mn>
   </msubsup>
   <mo>=</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>ξ</ci>
      <ci>j</ci>
     </apply>
     <cn type="integer">0</cn>
    </apply>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \xi_{j}^{0}=1
  </annotation>
 </semantics>
</math>

, 

<math display="inline" id="Generalized_functional_linear_model:57">
 <semantics>
  <mrow>
   <msub>
    <mi>β</mi>
    <mn>0</mn>
   </msub>
   <mo>=</mo>
   <mi>α</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>β</ci>
     <cn type="integer">0</cn>
    </apply>
    <ci>α</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \beta_{0}=\alpha
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Generalized_functional_linear_model:58">
 <semantics>
  <mrow>
   <msubsup>
    <mi>ξ</mi>
    <mi>j</mi>
    <mi>i</mi>
   </msubsup>
   <mo>=</mo>
   <mrow>
    <mo largeop="true" symmetric="true">∫</mo>
    <mrow>
     <msub>
      <mi>X</mi>
      <mi>i</mi>
     </msub>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>t</mi>
      <mo stretchy="false">)</mo>
     </mrow>
     <msub>
      <mi>ρ</mi>
      <mi>j</mi>
     </msub>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>t</mi>
      <mo rspace="4.2pt" stretchy="false">)</mo>
     </mrow>
     <mi>d</mi>
     <mi>w</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>t</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>ξ</ci>
      <ci>j</ci>
     </apply>
     <ci>i</ci>
    </apply>
    <apply>
     <int></int>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>X</ci>
       <ci>i</ci>
      </apply>
      <ci>t</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>ρ</ci>
       <ci>j</ci>
      </apply>
      <ci>t</ci>
      <ci>d</ci>
      <ci>w</ci>
      <ci>t</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \xi_{j}^{i}=\int X_{i}(t)\rho_{j}(t)\,dw(t)
  </annotation>
 </semantics>
</math>

, the approximated linear predictors can be represented as 

<math display="inline" id="Generalized_functional_linear_model:59">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>η</mi>
     <mi>i</mi>
    </msub>
    <mo>=</mo>
    <mrow>
     <msubsup>
      <mo largeop="true" symmetric="true">∑</mo>
      <mrow>
       <mi>j</mi>
       <mo>=</mo>
       <mn>0</mn>
      </mrow>
      <mi>p</mi>
     </msubsup>
     <mrow>
      <msub>
       <mi>β</mi>
       <mi>j</mi>
      </msub>
      <msubsup>
       <mi>ξ</mi>
       <mi>j</mi>
       <mi>i</mi>
      </msubsup>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
   <mrow>
    <mi>i</mi>
    <mo>=</mo>
    <mrow>
     <mn>1</mn>
     <mo>,</mo>
     <mn>2</mn>
     <mo>,</mo>
     <mi mathvariant="normal">…</mi>
     <mo>,</mo>
     <mi>n</mi>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>η</ci>
      <ci>i</ci>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <apply>
         <eq></eq>
         <ci>j</ci>
         <cn type="integer">0</cn>
        </apply>
       </apply>
       <ci>p</ci>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>β</ci>
        <ci>j</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>ξ</ci>
         <ci>j</ci>
        </apply>
        <ci>i</ci>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <ci>i</ci>
     <list>
      <cn type="integer">1</cn>
      <cn type="integer">2</cn>
      <ci>normal-…</ci>
      <ci>n</ci>
     </list>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \eta_{i}=\sum_{j=0}^{p}\beta_{j}\xi_{j}^{i},i=1,2,\ldots,n
  </annotation>
 </semantics>
</math>

 which are related to the means through 

<math display="inline" id="Generalized_functional_linear_model:60">
 <semantics>
  <mrow>
   <msub>
    <mi>μ</mi>
    <mi>i</mi>
   </msub>
   <mo>=</mo>
   <mrow>
    <mi>g</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <msub>
      <mi>η</mi>
      <mi>i</mi>
     </msub>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>μ</ci>
     <ci>i</ci>
    </apply>
    <apply>
     <times></times>
     <ci>g</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>η</ci>
      <ci>i</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mu_{i}=g(\eta_{i})
  </annotation>
 </semantics>
</math>

.</p>
<h2 id="estimation">Estimation</h2>

<p>The main aim is to estimate the parameter function 

<math display="inline" id="Generalized_functional_linear_model:61">
 <semantics>
  <mi>β</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>β</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \beta
  </annotation>
 </semantics>
</math>

.</p>

<p>Once 

<math display="inline" id="Generalized_functional_linear_model:62">
 <semantics>
  <mi>p</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>p</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p
  </annotation>
 </semantics>
</math>

 has been fixed, standard GLM and quasi-likelihood methods can be used for the 

<math display="inline" id="Generalized_functional_linear_model:63">
 <semantics>
  <mi>p</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>p</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p
  </annotation>
 </semantics>
</math>

-truncated model to estimate 

<math display="inline" id="Generalized_functional_linear_model:64">
 <semantics>
  <mrow>
   <msup>
    <mi>𝜷</mi>
    <mi>T</mi>
   </msup>
   <mo>=</mo>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>β</mi>
     <mn>0</mn>
    </msub>
    <mo>,</mo>
    <msub>
     <mi>β</mi>
     <mn>1</mn>
    </msub>
    <mo>,</mo>
    <mi mathvariant="normal">…</mi>
    <mo>,</mo>
    <msub>
     <mi>β</mi>
     <mi>p</mi>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>𝜷</ci>
     <ci>T</ci>
    </apply>
    <vector>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>β</ci>
      <cn type="integer">0</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>β</ci>
      <cn type="integer">1</cn>
     </apply>
     <ci>normal-…</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>β</ci>
      <ci>p</ci>
     </apply>
    </vector>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \boldsymbol{\beta}^{T}=(\beta_{0},\beta_{1},\ldots,\beta_{p})
  </annotation>
 </semantics>
</math>

 by solving the <a href="Estimating_equations" title="wikilink">estimating equation</a> or the <a href="Score_(statistics)" title="wikilink">score equation</a> 

<math display="inline" id="Generalized_functional_linear_model:65">
 <semantics>
  <mrow>
   <mrow>
    <mi>U</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>β</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mn>0.</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>U</ci>
     <ci>β</ci>
    </apply>
    <cn type="float">0.</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   U(\beta)=0.
  </annotation>
 </semantics>
</math>

</p>

<p>The vector valued score function turns out to be 

<math display="inline" id="Generalized_functional_linear_model:66">
 <semantics>
  <mrow>
   <mrow>
    <mi>U</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>β</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <msubsup>
     <mo largeop="true" symmetric="true">∑</mo>
     <mrow>
      <mi>i</mi>
      <mo>=</mo>
      <mn>1</mn>
     </mrow>
     <mi>n</mi>
    </msubsup>
    <mrow>
     <mrow>
      <mrow>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <msub>
          <mi>Y</mi>
          <mi>i</mi>
         </msub>
         <mo>-</mo>
         <msub>
          <mi>μ</mi>
          <mi>i</mi>
         </msub>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
       <msup>
        <mi>g</mi>
        <mo>′</mo>
       </msup>
       <mrow>
        <mo stretchy="false">(</mo>
        <msub>
         <mi>η</mi>
         <mi>i</mi>
        </msub>
        <mo stretchy="false">)</mo>
       </mrow>
       <msub>
        <mi>ξ</mi>
        <mi>i</mi>
       </msub>
      </mrow>
      <mo>/</mo>
      <msup>
       <mi>σ</mi>
       <mn>2</mn>
      </msup>
     </mrow>
     <mrow>
      <mo stretchy="false">(</mo>
      <msub>
       <mi>μ</mi>
       <mi>i</mi>
      </msub>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>U</ci>
     <ci>β</ci>
    </apply>
    <apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <apply>
        <eq></eq>
        <ci>i</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <ci>n</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <apply>
        <times></times>
        <apply>
         <minus></minus>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>Y</ci>
          <ci>i</ci>
         </apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>μ</ci>
          <ci>i</ci>
         </apply>
        </apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>g</ci>
         <ci>normal-′</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>η</ci>
         <ci>i</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>ξ</ci>
         <ci>i</ci>
        </apply>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>σ</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>μ</ci>
       <ci>i</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   U(\beta)=\sum_{i=1}^{n}(Y_{i}-\mu_{i})g^{\prime}(\eta_{i})\xi_{i}/\sigma^{2}(%
\mu_{i})
  </annotation>
 </semantics>
</math>

 which depends on 

<math display="inline" id="Generalized_functional_linear_model:67">
 <semantics>
  <mi>𝜷</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>𝜷</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \boldsymbol{\beta}
  </annotation>
 </semantics>
</math>

 through 

<math display="inline" id="Generalized_functional_linear_model:68">
 <semantics>
  <mi>μ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>μ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mu
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Generalized_functional_linear_model:69">
 <semantics>
  <mi>η</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>η</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \eta
  </annotation>
 </semantics>
</math>

.</p>

<p>Just as in GLM, the equation 

<math display="inline" id="Generalized_functional_linear_model:70">
 <semantics>
  <mrow>
   <mrow>
    <mi>U</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>β</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>U</ci>
     <ci>β</ci>
    </apply>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   U(\beta)=0
  </annotation>
 </semantics>
</math>

 is solved using iterative methods like <a href="Newton's_method" title="wikilink">Newton–Raphson</a> (NR) or <a href="Scoring_algorithm" title="wikilink">Fisher scoring</a> (FS) or <a href="iteratively_reweighted_least_squares" title="wikilink">iteratively reweighted least squares</a> (IWLS) to get the estimate of the regression coefficients 

<math display="inline" id="Generalized_functional_linear_model:71">
 <semantics>
  <mrow>
   <mover accent="true">
    <mi></mi>
    <mo mathvariant="bold" stretchy="false">^</mo>
   </mover>
   <mi>β</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <ci>bold-^</ci>
     <csymbol cd="latexml">absent</csymbol>
    </apply>
    <ci>β</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \boldsymbol{\hat{}}{\beta}
  </annotation>
 </semantics>
</math>

, leading to the estimate of the parameter function 

<math display="inline" id="Generalized_functional_linear_model:72">
 <semantics>
  <mrow>
   <mrow>
    <mover accent="true">
     <mi>β</mi>
     <mo stretchy="false">^</mo>
    </mover>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>t</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <msub>
     <mover accent="true">
      <mi>β</mi>
      <mo stretchy="false">^</mo>
     </mover>
     <mi>o</mi>
    </msub>
    <mo>+</mo>
    <mrow>
     <msubsup>
      <mo largeop="true" symmetric="true">∑</mo>
      <mrow>
       <mi>j</mi>
       <mo>=</mo>
       <mn>1</mn>
      </mrow>
      <mi>p</mi>
     </msubsup>
     <mrow>
      <msub>
       <mover accent="true">
        <mi>β</mi>
        <mo stretchy="false">^</mo>
       </mover>
       <mi>j</mi>
      </msub>
      <msub>
       <mi>ρ</mi>
       <mi>j</mi>
      </msub>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>t</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <ci>normal-^</ci>
      <ci>β</ci>
     </apply>
     <ci>t</ci>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <ci>normal-^</ci>
       <ci>β</ci>
      </apply>
      <ci>o</ci>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <apply>
         <eq></eq>
         <ci>j</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <ci>p</ci>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <apply>
         <ci>normal-^</ci>
         <ci>β</ci>
        </apply>
        <ci>j</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>ρ</ci>
        <ci>j</ci>
       </apply>
       <ci>t</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \hat{\beta}(t)=\hat{\beta}_{o}+\sum_{j=1}^{p}\hat{\beta}_{j}\rho_{j}(t)
  </annotation>
 </semantics>
</math>

 . When using the <a href="Generalized_linear_model" title="wikilink">canonical link</a> function, these methods are equivalent.</p>

<p>Results are available in the literature of 

<math display="inline" id="Generalized_functional_linear_model:73">
 <semantics>
  <mi>p</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>p</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p
  </annotation>
 </semantics>
</math>

-truncated models as 

<math display="inline" id="Generalized_functional_linear_model:74">
 <semantics>
  <mrow>
   <mi>p</mi>
   <mo>→</mo>
   <mi mathvariant="normal">∞</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-→</ci>
    <ci>p</ci>
    <infinity></infinity>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p\rightarrow\infty
  </annotation>
 </semantics>
</math>

 which provide asymptotic inference for the deviation of the estimated parametric function from the true parametric function and also asymptotic tests for regression effects and asymptotic <a href="Confidence_intervals" title="wikilink">confidence regions</a>.</p>
<h2 id="exponential-family-response">Exponential family response</h2>

<p>If the response variable 

<math display="inline" id="Generalized_functional_linear_model:75">
 <semantics>
  <msub>
   <mi>Y</mi>
   <mi>i</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>Y</ci>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Y_{i}
  </annotation>
 </semantics>
</math>

, given 

<math display="inline" id="Generalized_functional_linear_model:76">
 <semantics>
  <mrow>
   <msub>
    <mi>X</mi>
    <mi>i</mi>
   </msub>
   <mo>∈</mo>
   <mrow>
    <msup>
     <mi>L</mi>
     <mn>2</mn>
    </msup>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>T</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <in></in>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>X</ci>
     <ci>i</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>L</ci>
      <cn type="integer">2</cn>
     </apply>
     <ci>T</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   X_{i}\in L^{2}(T)
  </annotation>
 </semantics>
</math>

 follows the one parameter exponential family, then its probability density function or probability mass function (as the case may be) is</p>

<p>

<math display="block" id="Generalized_functional_linear_model:77">
 <semantics>
  <mrow>
   <mi>f</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>y</mi>
     <mi>i</mi>
    </msub>
    <mo>∣</mo>
    <msub>
     <mi>X</mi>
     <mi>i</mi>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>=</mo>
   <mi>exp</mi>
   <mrow>
    <mo>(</mo>
    <mfrac>
     <mrow>
      <mrow>
       <msub>
        <mi>y</mi>
        <mi>i</mi>
       </msub>
       <msub>
        <mi>θ</mi>
        <mi>i</mi>
       </msub>
      </mrow>
      <mo>-</mo>
      <mrow>
       <mi>b</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <msub>
         <mi>θ</mi>
         <mi>i</mi>
        </msub>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
     </mrow>
     <mi>ϕ</mi>
    </mfrac>
    <mo>+</mo>
    <mi>c</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <msub>
      <mi>y</mi>
      <mi>i</mi>
     </msub>
     <mo>,</mo>
     <mi>ϕ</mi>
     <mo stretchy="false">)</mo>
    </mrow>
    <mo>)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">f</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <ci>i</ci>
     </apply>
     <ci>normal-∣</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>X</ci>
      <ci>i</ci>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <eq></eq>
    <exp></exp>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <divide></divide>
      <apply>
       <minus></minus>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>y</ci>
         <ci>i</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>θ</ci>
         <ci>i</ci>
        </apply>
       </apply>
       <apply>
        <times></times>
        <ci>b</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>θ</ci>
         <ci>i</ci>
        </apply>
       </apply>
      </apply>
      <ci>ϕ</ci>
     </apply>
     <plus></plus>
     <csymbol cd="unknown">c</csymbol>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <ci>normal-(</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>y</ci>
       <ci>i</ci>
      </apply>
      <ci>normal-,</ci>
      <csymbol cd="unknown">ϕ</csymbol>
      <ci>normal-)</ci>
     </cerror>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f(y_{i}\mid X_{i})=\exp\left(\frac{y_{i}\theta_{i}-b(\theta_{i})}{\phi}+c(y_{i%
},\phi)\right)
  </annotation>
 </semantics>
</math>

</p>

<p>for some functions 

<math display="inline" id="Generalized_functional_linear_model:78">
 <semantics>
  <mi>b</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>b</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   b
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Generalized_functional_linear_model:79">
 <semantics>
  <mi>c</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>c</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   c
  </annotation>
 </semantics>
</math>

 , where 

<math display="inline" id="Generalized_functional_linear_model:80">
 <semantics>
  <msub>
   <mi>θ</mi>
   <mi>i</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>θ</ci>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \theta_{i}
  </annotation>
 </semantics>
</math>

 is the canonical parameter, and 

<math display="inline" id="Generalized_functional_linear_model:81">
 <semantics>
  <mi>ϕ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>ϕ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \phi
  </annotation>
 </semantics>
</math>

 is a dispersion parameter which is typically assumed to be positive.</p>

<p>In the canonical set up, 

<math display="inline" id="Generalized_functional_linear_model:82">
 <semantics>
  <mrow>
   <msub>
    <mi>η</mi>
    <mi>i</mi>
   </msub>
   <mo>=</mo>
   <mrow>
    <mi>α</mi>
    <mo>+</mo>
    <mrow>
     <mo largeop="true" symmetric="true">∫</mo>
     <mrow>
      <msubsup>
       <mi>X</mi>
       <mi>i</mi>
       <mi>c</mi>
      </msubsup>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>t</mi>
       <mo stretchy="false">)</mo>
      </mrow>
      <mi>β</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>t</mi>
       <mo rspace="4.2pt" stretchy="false">)</mo>
      </mrow>
      <mi>d</mi>
      <mi>w</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>t</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>=</mo>
   <msub>
    <mi>θ</mi>
    <mi>i</mi>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>η</ci>
      <ci>i</ci>
     </apply>
     <apply>
      <plus></plus>
      <ci>α</ci>
      <apply>
       <int></int>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>X</ci>
          <ci>i</ci>
         </apply>
         <ci>c</ci>
        </apply>
        <ci>t</ci>
        <ci>β</ci>
        <ci>t</ci>
        <ci>d</ci>
        <ci>w</ci>
        <ci>t</ci>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>θ</ci>
      <ci>i</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \eta_{i}=\alpha+\int X_{i}^{c}(t)\beta(t)\,dw(t)=\theta_{i}
  </annotation>
 </semantics>
</math>

 and from the properties of exponential family,</p>

<p>

<math display="block" id="Generalized_functional_linear_model:83">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <msub>
      <mi>μ</mi>
      <mi>i</mi>
     </msub>
     <mo>=</mo>
     <mrow>
      <msup>
       <mi>b</mi>
       <mo>′</mo>
      </msup>
      <mrow>
       <mo stretchy="false">(</mo>
       <msub>
        <mi>θ</mi>
        <mi>i</mi>
       </msub>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mrow>
    <mo>,</mo>
    <mrow>
     <mrow>
      <mtext>and so</mtext>
      <msub>
       <mi>μ</mi>
       <mi>i</mi>
      </msub>
     </mrow>
     <mo>=</mo>
     <mrow>
      <msup>
       <mi>b</mi>
       <mo>′</mo>
      </msup>
      <mrow>
       <mo stretchy="false">(</mo>
       <msub>
        <mi>η</mi>
        <mi>i</mi>
       </msub>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>μ</ci>
      <ci>i</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>b</ci>
       <ci>normal-′</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>θ</ci>
       <ci>i</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <apply>
      <times></times>
      <mtext>and so</mtext>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>μ</ci>
       <ci>i</ci>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>b</ci>
       <ci>normal-′</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>η</ci>
       <ci>i</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mu_{i}=b^{\prime}(\theta_{i}),\text{ and so }\mu_{i}=b^{\prime}(\eta_{i}).
  </annotation>
 </semantics>
</math>

</p>

<p>Hence 

<math display="inline" id="Generalized_functional_linear_model:84">
 <semantics>
  <msup>
   <mi>b</mi>
   <mo>′</mo>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>b</ci>
    <ci>normal-′</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   b^{\prime}
  </annotation>
 </semantics>
</math>

 serves as a link function and is called the canonical link function.</p>

<p>Note that 

<math display="inline" id="Generalized_functional_linear_model:85">
 <semantics>
  <mrow>
   <mtext>Var</mtext>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>y</mi>
     <mi>i</mi>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>=</mo>
   <mi>ϕ</mi>
   <msup>
    <mi>b</mi>
    <mi>′′</mi>
   </msup>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>θ</mi>
     <mi>i</mi>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>=</mo>
   <mi>ϕ</mi>
   <msup>
    <mi>b</mi>
    <mi>′′</mi>
   </msup>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>η</mi>
     <mi>i</mi>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>=</mo>
   <mi>ϕ</mi>
   <msup>
    <mi>g</mi>
    <mo>′</mo>
   </msup>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>η</mi>
     <mi>i</mi>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>=</mo>
   <mi>ϕ</mi>
   <msup>
    <mi>g</mi>
    <mo>′</mo>
   </msup>
   <mrow>
    <mo stretchy="false">(</mo>
    <msup>
     <mi>g</mi>
     <mrow>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </msup>
    <mrow>
     <mo stretchy="false">(</mo>
     <msub>
      <mi>μ</mi>
      <mi>i</mi>
     </msub>
     <mo stretchy="false">)</mo>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo stretchy="false">)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <mtext>Var</mtext>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <ci>i</ci>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <eq></eq>
    <csymbol cd="unknown">ϕ</csymbol>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>b</ci>
     <ci>′′</ci>
    </apply>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>θ</ci>
      <ci>i</ci>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <eq></eq>
    <csymbol cd="unknown">ϕ</csymbol>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>b</ci>
     <ci>′′</ci>
    </apply>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>η</ci>
      <ci>i</ci>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <eq></eq>
    <csymbol cd="unknown">ϕ</csymbol>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>g</ci>
     <ci>normal-′</ci>
    </apply>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>η</ci>
      <ci>i</ci>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <eq></eq>
    <csymbol cd="unknown">ϕ</csymbol>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>g</ci>
     <ci>normal-′</ci>
    </apply>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>g</ci>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <ci>normal-(</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>μ</ci>
       <ci>i</ci>
      </apply>
      <ci>normal-)</ci>
     </cerror>
     <ci>normal-)</ci>
    </cerror>
    <ci>normal-)</ci>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \text{Var}(y_{i})=\phi b^{\prime\prime}(\theta_{i})=\phi b^{\prime\prime}(\eta%
_{i})=\phi g^{\prime}(\eta_{i})=\phi g^{\prime}(g^{-1}(\mu_{i})))
  </annotation>
 </semantics>
</math>

 is the corresponding variance function and 

<math display="inline" id="Generalized_functional_linear_model:86">
 <semantics>
  <mi>ϕ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>ϕ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \phi
  </annotation>
 </semantics>
</math>

 the dispersion parameter.</p>
<h2 id="special-cases">Special cases</h2>
<h3 id="functional-linear-regression-flr">Functional linear regression (FLR)</h3>

<p>Functional linear regression, one of the most useful tools of functional data analysis, is an example of GFLM where the response variable is continuous and is often assumed to have a <a href="Normal_distribution" title="wikilink">Normal distribution</a>. The variance function is a constant function and the link function is identity. Under these assumption we find that the GFLM reduces to the FLR,</p>

<p>

<math display="block" id="Generalized_functional_linear_model:87">
 <semantics>
  <mrow>
   <mi>μ</mi>
   <mo>=</mo>
   <mrow>
    <mo>E</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>Y</mi>
     <mo>∣</mo>
     <mi>X</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mi>η</mi>
   <mo>=</mo>
   <mrow>
    <mi>α</mi>
    <mo>+</mo>
    <mrow>
     <mo largeop="true" symmetric="true">∫</mo>
     <mrow>
      <msup>
       <mi>X</mi>
       <mi>c</mi>
      </msup>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>t</mi>
       <mo stretchy="false">)</mo>
      </mrow>
      <mi>β</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>t</mi>
       <mo rspace="4.2pt" stretchy="false">)</mo>
      </mrow>
      <mi>d</mi>
      <mi>w</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>t</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <ci>μ</ci>
     <apply>
      <ci>normal-E</ci>
      <ci>Y</ci>
      <ci>X</ci>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <ci>η</ci>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <plus></plus>
      <ci>α</ci>
      <apply>
       <int></int>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>X</ci>
         <ci>c</ci>
        </apply>
        <ci>t</ci>
        <ci>β</ci>
        <ci>t</ci>
        <ci>d</ci>
        <ci>w</ci>
        <ci>t</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mu=\operatorname{E}(Y\mid X)=\eta=\alpha+\int X^{c}(t)\beta(t)\,dw(t)
  </annotation>
 </semantics>
</math>

</p>

<p>Without the normality assumption, the constant variance function motivates the use of quasi-normal techniques.</p>
<h3 id="functional-binary-regression">Functional binary regression</h3>

<p>When the response variable has binary outcomes ,i.e., 0 or 1, the distribution is usually chosen as <a href="Bernoulli_distribution" title="wikilink">Bernoulli</a>, and then 

<math display="inline" id="Generalized_functional_linear_model:88">
 <semantics>
  <mrow>
   <msub>
    <mi>μ</mi>
    <mi>i</mi>
   </msub>
   <mo>=</mo>
   <mi>P</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>Y</mi>
     <mi>i</mi>
    </msub>
    <mo>=</mo>
    <mn>1</mn>
    <mo>∣</mo>
    <msub>
     <mi>X</mi>
     <mi>i</mi>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>μ</ci>
     <ci>i</ci>
    </apply>
    <eq></eq>
    <csymbol cd="unknown">P</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>Y</ci>
      <ci>i</ci>
     </apply>
     <eq></eq>
     <cn type="integer">1</cn>
     <ci>normal-∣</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>X</ci>
      <ci>i</ci>
     </apply>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mu_{i}=P(Y_{i}=1\mid X_{i})
  </annotation>
 </semantics>
</math>

. Popular link functions are the expit function, which is the inverse of the <a class="uri" href="logit" title="wikilink">logit</a> function (functional logistic regression) and the <a class="uri" href="probit" title="wikilink">probit</a> function (functional probit regression). Any cumulative distribution function <em>F</em> has range <em>[0,1]</em> which is the range of binomial mean and so can be chosen as a link function. Another link function in this context is the <a href="Generalized_linear_model" title="wikilink">complementary log–log function</a>, which is an asymmetric link. The variance function for binary data is given by 

<math display="inline" id="Generalized_functional_linear_model:89">
 <semantics>
  <mrow>
   <mrow>
    <mo>Var</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <msub>
      <mi>Y</mi>
      <mi>i</mi>
     </msub>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mi>ϕ</mi>
    <msub>
     <mi>μ</mi>
     <mi>i</mi>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mn>1</mn>
      <mo>-</mo>
      <msub>
       <mi>μ</mi>
       <mi>i</mi>
      </msub>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <ci>Var</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>Y</ci>
      <ci>i</ci>
     </apply>
    </apply>
    <apply>
     <times></times>
     <ci>ϕ</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>μ</ci>
      <ci>i</ci>
     </apply>
     <apply>
      <minus></minus>
      <cn type="integer">1</cn>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>μ</ci>
       <ci>i</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \operatorname{Var}(Y_{i})=\phi\mu_{i}(1-\mu_{i})
  </annotation>
 </semantics>
</math>

 where the dispersion parameter 

<math display="inline" id="Generalized_functional_linear_model:90">
 <semantics>
  <mi>ϕ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>ϕ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \phi
  </annotation>
 </semantics>
</math>

 is taken as 1 or alternatively the quasi-likelihood approach is used.</p>
<h3 id="functional-poisson-regression">Functional Poisson regression</h3>

<p>Another special case of GFLM occurs when the outcomes are counts, so that the distribution of the responses is assumed to be <a href="Poisson_distribution" title="wikilink">Poisson</a>. The mean 

<math display="inline" id="Generalized_functional_linear_model:91">
 <semantics>
  <msub>
   <mi>μ</mi>
   <mi>i</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>μ</ci>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mu_{i}
  </annotation>
 </semantics>
</math>

 is typically linked to the linear predictor 

<math display="inline" id="Generalized_functional_linear_model:92">
 <semantics>
  <msub>
   <mi>η</mi>
   <mi>i</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>η</ci>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \eta_{i}
  </annotation>
 </semantics>
</math>

 via a log-link, which is also the canonical link . The variance function is 

<math display="inline" id="Generalized_functional_linear_model:93">
 <semantics>
  <mrow>
   <mrow>
    <mo>Var</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <msub>
      <mi>Y</mi>
      <mi>i</mi>
     </msub>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mi>ϕ</mi>
    <msub>
     <mi>μ</mi>
     <mi>i</mi>
    </msub>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <ci>Var</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>Y</ci>
      <ci>i</ci>
     </apply>
    </apply>
    <apply>
     <times></times>
     <ci>ϕ</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>μ</ci>
      <ci>i</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \operatorname{Var}(Y_{i})=\phi\mu_{i}
  </annotation>
 </semantics>
</math>

, where the dispersion parameter 

<math display="inline" id="Generalized_functional_linear_model:94">
 <semantics>
  <mi>ϕ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>ϕ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \phi
  </annotation>
 </semantics>
</math>

 is 1, except when the data might be over-dispersed which is when the quasi-Poisson approach is used.</p>
<h2 id="extensions">Extensions</h2>

<p>Extensions of GFLM have been proposed for the cases where there are multiple predictor functions.<a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a> Another generalization is called the Semi Parametric Quasi-likelihood Regression (SPQR)<a class="footnoteRef" href="#fn3" id="fnref3"><sup>3</sup></a> which considers the situation where the link and the variance functions are unknown and are estimated non-parametrically from the data. This situation can also be handled by single or multiple index models, using for example Sliced Inverse Regression (SIR).</p>

<p>Another extension in this domain is Functional Generalized Additive Model (FGAM))<a class="footnoteRef" href="#fn4" id="fnref4"><sup>4</sup></a> which is a generalization of <a href="generalized_additive_model" title="wikilink">generalized additive model</a>(GAM) where</p>

<p>

<math display="block" id="Generalized_functional_linear_model:95">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <msup>
      <mi>g</mi>
      <mrow>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
     </msup>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mo>E</mo>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>Y</mi>
        <mo>∣</mo>
        <mi>X</mi>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mi>α</mi>
     <mo>+</mo>
     <mrow>
      <munderover>
       <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
       <mrow>
        <mi>j</mi>
        <mo>=</mo>
        <mn>1</mn>
       </mrow>
       <mi>p</mi>
      </munderover>
      <mrow>
       <msub>
        <mi>f</mi>
        <mi>j</mi>
       </msub>
       <mrow>
        <mo stretchy="false">(</mo>
        <msub>
         <mi>ξ</mi>
         <mi>j</mi>
        </msub>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>g</ci>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <apply>
      <ci>normal-E</ci>
      <ci>Y</ci>
      <ci>X</ci>
     </apply>
    </apply>
    <apply>
     <plus></plus>
     <ci>α</ci>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <apply>
         <eq></eq>
         <ci>j</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <ci>p</ci>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>f</ci>
        <ci>j</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>ξ</ci>
        <ci>j</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   g^{-1}(\operatorname{E}(Y\mid X))=\alpha+\sum_{j=1}^{p}f_{j}(\xi_{j}),
  </annotation>
 </semantics>
</math>

</p>

<p>where 

<math display="inline" id="Generalized_functional_linear_model:96">
 <semantics>
  <msub>
   <mi>ξ</mi>
   <mi>j</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>ξ</ci>
    <ci>j</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \xi_{j}
  </annotation>
 </semantics>
</math>

 are the expansion coefficients of the random predictor function 

<math display="inline" id="Generalized_functional_linear_model:97">
 <semantics>
  <mi>X</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>X</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   X
  </annotation>
 </semantics>
</math>

 and each 

<math display="inline" id="Generalized_functional_linear_model:98">
 <semantics>
  <msub>
   <mi>f</mi>
   <mi>j</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>f</ci>
    <ci>j</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f_{j}
  </annotation>
 </semantics>
</math>

 is an unknown smooth function that has to be estimated and where 

<math display="inline" id="Generalized_functional_linear_model:99">
 <semantics>
  <mrow>
   <mrow>
    <mtext>E</mtext>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <msub>
       <mi>f</mi>
       <mi>j</mi>
      </msub>
      <mrow>
       <mo stretchy="false">(</mo>
       <msub>
        <mi>ξ</mi>
        <mi>j</mi>
       </msub>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mn>0.</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <mtext>E</mtext>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>f</ci>
       <ci>j</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>ξ</ci>
       <ci>j</ci>
      </apply>
     </apply>
    </apply>
    <cn type="float">0.</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \text{E}(f_{j}(\xi_{j}))=0.
  </annotation>
 </semantics>
</math>

.</p>

<p>In general, estimation in FGAM requires combining IWLS with <a href="Backfitting_algorithm" title="wikilink">backfitting</a>. However if the expansion coefficients are obtained as functional principal components, then in some cases (eg. Gaussian predictor function 

<math display="inline" id="Generalized_functional_linear_model:100">
 <semantics>
  <mi>X</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>X</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   X
  </annotation>
 </semantics>
</math>

), they will be independent in which case backfitting is not needed, and one can use popular <a class="uri" href="smoothing" title="wikilink">smoothing</a> methods for estimating the unknown parameter functions 

<math display="inline" id="Generalized_functional_linear_model:101">
 <semantics>
  <msub>
   <mi>f</mi>
   <mi>j</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>f</ci>
    <ci>j</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f_{j}
  </annotation>
 </semantics>
</math>

.</p>
<h2 id="application">Application</h2>

<p> A popular data set that has been used for a number of analysis in the domain of functional data analysis consists of the number of eggs laid daily until death of 1000 Mediterranean fruit flies (or medflies for short)<a href="http://anson.ucdavis.edu/~mueller/data/medfly1000.html">1</a><a href="http://anson.ucdavis.edu/~mueller/data/medfly1000.txt">2</a>. The plot here shows the egg laying trajectories in the first 25 days of life of about 600 female medflies (those that have at least 20 remaining eggs in their lifetime). The red colored curves belong to those flies that will lay less than the median number of remaining eggs, while the blue colored curves belong to the flies that will lay more than the median number of remaining eggs after age 25. An related problem of classifying medflies as long-lived or short-lived based on the initial egg laying trajectories as predictors and the subsequent longevity of the flies as response has been studied with the GFLM<a class="footnoteRef" href="#fn5" id="fnref5"><sup>5</sup></a></p>
<h2 id="see-also">See also</h2>
<ul>
<li><a href="Generalized_linear_model" title="wikilink">Generalized linear model</a></li>
<li><a href="Functional_principal_component_analysis" title="wikilink">Functional principal component analysis</a></li>
<li><a href="Functional_data_analysis" title="wikilink">Functional data analysis</a></li>
<li><a class="uri" href="Quasi-likelihood" title="wikilink">Quasi-likelihood</a></li>
<li><a href="Karhunen–Loève_theorem" title="wikilink">Karhunen–Loève theorem</a></li>
<li><a href="Stochastic_processes" title="wikilink">Stochastic processes</a></li>
<li><a href="Lp_space" title="wikilink">Lp space</a></li>
</ul>
<h2 id="references">References</h2>

<p>"</p>

<p><a href="Category:Generalized_linear_models" title="wikilink">Category:Generalized linear models</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1"><a href="#fnref1">↩</a></li>
<li id="fn2"><a href="#fnref2">↩</a></li>
<li id="fn3"></li>
<li id="fn4"><a href="#fnref4">↩</a></li>
<li id="fn5"></li>
</ol>
</section>
</hr></body>
</html>

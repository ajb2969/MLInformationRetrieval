<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="416">Association scheme</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Association scheme</h1>
<hr/>

<p>The theory of <strong>association schemes</strong> arose in statistics, in the theory of <a href="design_of_experiments" title="wikilink">experimental design</a> for the <a href="analysis_of_variance" title="wikilink">analysis of variance</a>.<a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a><a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a><a class="footnoteRef" href="#fn3" id="fnref3"><sup>3</sup></a> In <a class="uri" href="mathematics" title="wikilink">mathematics</a>, association schemes belong to both <a class="uri" href="algebra" title="wikilink">algebra</a> and <a class="uri" href="combinatorics" title="wikilink">combinatorics</a>. Indeed, in <a href="algebraic_combinatorics" title="wikilink">algebraic combinatorics</a>, association schemes provide a unified approach to many topics, for example <a href="combinatorial_design" title="wikilink">combinatorial designs</a> and <a href="coding_theory" title="wikilink">coding theory</a>.<a class="footnoteRef" href="#fn4" id="fnref4"><sup>4</sup></a><a class="footnoteRef" href="#fn5" id="fnref5"><sup>5</sup></a> In algebra, association schemes generalize <a href="group_(mathematics)" title="wikilink">groups</a>, and the theory of association schemes generalizes the <a href="group_character" title="wikilink">character theory</a> of <a href="group_representation" title="wikilink">linear representations</a> of groups.<a class="footnoteRef" href="#fn6" id="fnref6"><sup>6</sup></a><a class="footnoteRef" href="#fn7" id="fnref7"><sup>7</sup></a><a class="footnoteRef" href="#fn8" id="fnref8"><sup>8</sup></a></p>
<h2 id="definition">Definition</h2>

<p>An n-class association scheme consists of a <a href="Set_(mathematics)" title="wikilink">set</a> <em>X</em> together with a <a href="partition_of_a_set" title="wikilink">partition</a> <em>S</em> of <em>X</em> × <em>X</em> into n + 1 <a href="binary_relation" title="wikilink">binary relations</a>, R<sub>0</sub>, R<sub>1</sub>, ..., R<sub>n</sub> which satisfy:</p>
<ul>
<li>

<math display="inline" id="Association_scheme:0">
 <semantics>
  <mrow>
   <msub>
    <mi>R</mi>
    <mn>0</mn>
   </msub>
   <mo>=</mo>
   <mrow>
    <mo stretchy="false">{</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>x</mi>
     <mo>,</mo>
     <mi>x</mi>
     <mo stretchy="false">)</mo>
    </mrow>
    <mo>:</mo>
    <mrow>
     <mi>x</mi>
     <mo>∈</mo>
     <mi>X</mi>
    </mrow>
    <mo stretchy="false">}</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>R</ci>
     <cn type="integer">0</cn>
    </apply>
    <apply>
     <csymbol cd="latexml">conditional-set</csymbol>
     <interval closure="open">
      <ci>x</ci>
      <ci>x</ci>
     </interval>
     <apply>
      <in></in>
      <ci>x</ci>
      <ci>X</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   R_{0}=\{(x,x):x\in X\}
  </annotation>
 </semantics>
</math>

 and is called the <a href="Identity_relation" title="wikilink">Identity relation</a>.</li>
<li>Defining 

<math display="inline" id="Association_scheme:1">
 <semantics>
  <mrow>
   <msup>
    <mi>R</mi>
    <mo>*</mo>
   </msup>
   <mo>:=</mo>
   <mrow>
    <mo stretchy="false">{</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>x</mi>
     <mo>,</mo>
     <mi>y</mi>
     <mo stretchy="false">)</mo>
    </mrow>
    <mo stretchy="false">|</mo>
    <mrow>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>y</mi>
      <mo>,</mo>
      <mi>x</mi>
      <mo stretchy="false">)</mo>
     </mrow>
     <mo>∈</mo>
     <mi>R</mi>
    </mrow>
    <mo stretchy="false">}</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">assign</csymbol>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>R</ci>
     <times></times>
    </apply>
    <apply>
     <csymbol cd="latexml">conditional-set</csymbol>
     <interval closure="open">
      <ci>x</ci>
      <ci>y</ci>
     </interval>
     <apply>
      <in></in>
      <interval closure="open">
       <ci>y</ci>
       <ci>x</ci>
      </interval>
      <ci>R</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   R^{*}:=\{(x,y)|(y,x)\in R\}
  </annotation>
 </semantics>
</math>

, if <em>R</em> in <em>S</em>, then <em>R*</em> in <em>S</em></li>
<li>If 

<math display="inline" id="Association_scheme:2">
 <semantics>
  <mrow>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>x</mi>
    <mo>,</mo>
    <mi>y</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>∈</mo>
   <msub>
    <mi>R</mi>
    <mi>k</mi>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <in></in>
    <interval closure="open">
     <ci>x</ci>
     <ci>y</ci>
    </interval>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>R</ci>
     <ci>k</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (x,y)\in R_{k}
  </annotation>
 </semantics>
</math>

, the number of 

<math display="inline" id="Association_scheme:3">
 <semantics>
  <mrow>
   <mi>z</mi>
   <mo>∈</mo>
   <mi>X</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <in></in>
    <ci>z</ci>
    <ci>X</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   z\in X
  </annotation>
 </semantics>
</math>


 such that 

<math display="inline" id="Association_scheme:4">
 <semantics>
  <mrow>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>x</mi>
    <mo>,</mo>
    <mi>z</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>∈</mo>
   <msub>
    <mi>R</mi>
    <mi>i</mi>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <in></in>
    <interval closure="open">
     <ci>x</ci>
     <ci>z</ci>
    </interval>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>R</ci>
     <ci>i</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (x,z)\in R_{i}
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Association_scheme:5">
 <semantics>
  <mrow>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>z</mi>
    <mo>,</mo>
    <mi>y</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>∈</mo>
   <msub>
    <mi>R</mi>
    <mi>j</mi>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <in></in>
    <interval closure="open">
     <ci>z</ci>
     <ci>y</ci>
    </interval>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>R</ci>
     <ci>j</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (z,y)\in R_{j}
  </annotation>
 </semantics>
</math>

 is a constant 

<math display="inline" id="Association_scheme:6">
 <semantics>
  <msubsup>
   <mi>p</mi>
   <mrow>
    <mi>i</mi>
    <mi>j</mi>
   </mrow>
   <mi>k</mi>
  </msubsup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>p</ci>
     <ci>k</ci>
    </apply>
    <apply>
     <times></times>
     <ci>i</ci>
     <ci>j</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p^{k}_{ij}
  </annotation>
 </semantics>
</math>

 depending on 

<math display="inline" id="Association_scheme:7">
 <semantics>
  <mi>i</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>i</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   i
  </annotation>
 </semantics>
</math>

, 

<math display="inline" id="Association_scheme:8">
 <semantics>
  <mi>j</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>j</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   j
  </annotation>
 </semantics>
</math>


, 

<math display="inline" id="Association_scheme:9">
 <semantics>
  <mi>k</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>k</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   k
  </annotation>
 </semantics>
</math>

 but not on the particular choice of 

<math display="inline" id="Association_scheme:10">
 <semantics>
  <mi>x</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>x</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Association_scheme:11">
 <semantics>
  <mi>y</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>y</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   y
  </annotation>
 </semantics>
</math>

.</li>
</ul>

<p>An association scheme is <em>commutative</em> if 

<math display="inline" id="Association_scheme:12">
 <semantics>
  <mrow>
   <msubsup>
    <mi>p</mi>
    <mrow>
     <mi>i</mi>
     <mi>j</mi>
    </mrow>
    <mi>k</mi>
   </msubsup>
   <mo>=</mo>
   <msubsup>
    <mi>p</mi>
    <mrow>
     <mi>j</mi>
     <mi>i</mi>
    </mrow>
    <mi>k</mi>
   </msubsup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>p</ci>
      <apply>
       <times></times>
       <ci>i</ci>
       <ci>j</ci>
      </apply>
     </apply>
     <ci>k</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>p</ci>
      <apply>
       <times></times>
       <ci>j</ci>
       <ci>i</ci>
      </apply>
     </apply>
     <ci>k</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p_{ij}^{k}=p_{ji}^{k}
  </annotation>
 </semantics>
</math>

 for all 

<math display="inline" id="Association_scheme:13">
 <semantics>
  <mi>i</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>i</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   i
  </annotation>
 </semantics>
</math>


, 

<math display="inline" id="Association_scheme:14">
 <semantics>
  <mi>j</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>j</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   j
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Association_scheme:15">
 <semantics>
  <mi>k</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>k</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   k
  </annotation>
 </semantics>
</math>

. Most authors assume this property.</p>

<p>A <em>symmetric</em> association scheme is one in which each relation 

<math display="inline" id="Association_scheme:16">
 <semantics>
  <msub>
   <mi>R</mi>
   <mi>i</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>R</ci>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   R_{i}
  </annotation>
 </semantics>
</math>

 is a <a href="symmetric_relation" title="wikilink">symmetric relation</a>. That is:</p>
<ul>
<li>if (<em>x</em>,<em>y</em>) ∈ <em>R</em><sub><em>i</em></sub>, then (<em>y</em>,<em>x</em>) ∈ <em>R</em><sub><em>i</em></sub> . (Or equivalently, <em>R</em>* = <em>R</em>.)</li>
</ul>

<p>Every symmetric association scheme is commutative.</p>

<p>Note, however, that while the notion of an association scheme generalizes the notion of a group, the notion of a commutative association scheme only generalizes the notion of a commutative group.</p>

<p>Two points <em>x</em> and <em>y</em> are called <em>i</em> th associates if 

<math display="inline" id="Association_scheme:17">
 <semantics>
  <mrow>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>x</mi>
    <mo>,</mo>
    <mi>y</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>∈</mo>
   <msub>
    <mi>R</mi>
    <mi>i</mi>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <in></in>
    <interval closure="open">
     <ci>x</ci>
     <ci>y</ci>
    </interval>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>R</ci>
     <ci>i</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (x,y)\in R_{i}
  </annotation>
 </semantics>
</math>

. The definition states that if <em>x</em> and <em>y</em> are <em>i</em> th associates so are <em>y</em> and <em>x</em>. Every pair of points are <em>i</em> th associates for exactly one 

<math display="inline" id="Association_scheme:18">
 <semantics>
  <mi>i</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>i</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   i
  </annotation>
 </semantics>
</math>


. Each point is its own zeroth associate while distinct points are never zeroth associates. If <em>x</em> and <em>y</em> are <em>k</em> th associates then the number of points 

<math display="inline" id="Association_scheme:19">
 <semantics>
  <mi>z</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>z</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   z
  </annotation>
 </semantics>
</math>

 which are both <em>i</em> th associates of 

<math display="inline" id="Association_scheme:20">
 <semantics>
  <mi>x</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>x</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x
  </annotation>
 </semantics>
</math>

 and <em>j</em> th associates of 

<math display="inline" id="Association_scheme:21">
 <semantics>
  <mi>y</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>y</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   y
  </annotation>
 </semantics>
</math>

 is a constant 

<math display="inline" id="Association_scheme:22">
 <semantics>
  <msubsup>
   <mi>p</mi>
   <mrow>
    <mi>i</mi>
    <mi>j</mi>
   </mrow>
   <mi>k</mi>
  </msubsup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>p</ci>
     <ci>k</ci>
    </apply>
    <apply>
     <times></times>
     <ci>i</ci>
     <ci>j</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p^{k}_{ij}
  </annotation>
 </semantics>
</math>

.</p>
<h3 id="graph-interpretation-and-adjacency-matrices">Graph interpretation and adjacency matrices</h3>

<p>An association scheme can be visualized as a <a href="complete_graph" title="wikilink">complete graph</a> with labeled edges. The graph has 

<math display="inline" id="Association_scheme:23">
 <semantics>
  <mi>v</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>v</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   v
  </annotation>
 </semantics>
</math>


 vertices, one for each point of 

<math display="inline" id="Association_scheme:24">
 <semantics>
  <mi>X</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>X</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   X
  </annotation>
 </semantics>
</math>

, and the edge joining vertices 

<math display="inline" id="Association_scheme:25">
 <semantics>
  <mi>x</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>x</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Association_scheme:26">
 <semantics>
  <mi>y</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>y</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   y
  </annotation>
 </semantics>
</math>

 is labeled 

<math display="inline" id="Association_scheme:27">
 <semantics>
  <mi>i</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>i</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   i
  </annotation>
 </semantics>
</math>

 if 

<math display="inline" id="Association_scheme:28">
 <semantics>
  <mi>x</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>x</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x
  </annotation>
 </semantics>
</math>


 and 

<math display="inline" id="Association_scheme:29">
 <semantics>
  <mi>y</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>y</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   y
  </annotation>
 </semantics>
</math>

 are 

<math display="inline" id="Association_scheme:30">
 <semantics>
  <mi>i</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>i</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   i
  </annotation>
 </semantics>
</math>

 th associates. Each edge has a unique label, and the number of triangles with a fixed base labeled 

<math display="inline" id="Association_scheme:31">
 <semantics>
  <mi>k</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>k</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   k
  </annotation>
 </semantics>
</math>

 having the other edges labeled 

<math display="inline" id="Association_scheme:32">
 <semantics>
  <mi>i</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>i</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   i
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Association_scheme:33">
 <semantics>
  <mi>j</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>j</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   j
  </annotation>
 </semantics>
</math>


 is a constant 

<math display="inline" id="Association_scheme:34">
 <semantics>
  <msubsup>
   <mi>p</mi>
   <mrow>
    <mi>i</mi>
    <mi>j</mi>
   </mrow>
   <mi>k</mi>
  </msubsup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>p</ci>
     <ci>k</ci>
    </apply>
    <apply>
     <times></times>
     <ci>i</ci>
     <ci>j</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p^{k}_{ij}
  </annotation>
 </semantics>
</math>

, depending on 

<math display="inline" id="Association_scheme:35">
 <semantics>
  <mrow>
   <mi>i</mi>
   <mo>,</mo>
   <mi>j</mi>
   <mo>,</mo>
   <mi>k</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <list>
    <ci>i</ci>
    <ci>j</ci>
    <ci>k</ci>
   </list>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   i,j,k
  </annotation>
 </semantics>
</math>

 but not on the choice of the base. In particular, each vertex is incident with exactly 

<math display="inline" id="Association_scheme:36">
 <semantics>
  <mrow>
   <msubsup>
    <mi>p</mi>
    <mrow>
     <mi>i</mi>
     <mi>i</mi>
    </mrow>
    <mn>0</mn>
   </msubsup>
   <mo>=</mo>
   <msub>
    <mi>v</mi>
    <mi>i</mi>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>p</ci>
      <cn type="integer">0</cn>
     </apply>
     <apply>
      <times></times>
      <ci>i</ci>
      <ci>i</ci>
     </apply>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>v</ci>
     <ci>i</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p^{0}_{ii}=v_{i}
  </annotation>
 </semantics>
</math>

 edges labeled 

<math display="inline" id="Association_scheme:37">
 <semantics>
  <mi>i</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>i</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   i
  </annotation>
 </semantics>
</math>

; 

<math display="inline" id="Association_scheme:38">
 <semantics>
  <msub>
   <mi>v</mi>
   <mi>i</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>v</ci>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   v_{i}
  </annotation>
 </semantics>
</math>


 is the <a href="Adjacency_relation" title="wikilink">valency</a> of the <a href="Relation_(mathematics)" title="wikilink">relation</a> 

<math display="inline" id="Association_scheme:39">
 <semantics>
  <msub>
   <mi>R</mi>
   <mi>i</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>R</ci>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   R_{i}
  </annotation>
 </semantics>
</math>

. There are also loops labeled 

<math display="inline" id="Association_scheme:40">
 <semantics>
  <mn>0</mn>
  <annotation-xml encoding="MathML-Content">
   <cn type="integer">0</cn>
  </annotation-xml>
 </semantics>
</math>

 at each vertex 

<math display="inline" id="Association_scheme:41">
 <semantics>
  <mi>x</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>x</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x
  </annotation>
 </semantics>
</math>

, corresponding to 

<math display="inline" id="Association_scheme:42">
 <semantics>
  <msub>
   <mi>R</mi>
   <mn>0</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>R</ci>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   R_{0}
  </annotation>
 </semantics>
</math>

.</p>

<p>The <a href="Relation_(mathematics)" title="wikilink">relations</a> are described by their <a href="Adjacency_matrix" title="wikilink">adjacency matrices</a>. 

<math display="inline" id="Association_scheme:43">
 <semantics>
  <msub>
   <mi>A</mi>
   <mi>i</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>A</ci>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A_{i}
  </annotation>
 </semantics>
</math>


 is the <a href="adjacency_matrix" title="wikilink">adjacency matrix</a> of 

<math display="inline" id="Association_scheme:44">
 <semantics>
  <msub>
   <mi>R</mi>
   <mi>i</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>R</ci>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   R_{i}
  </annotation>
 </semantics>
</math>

 for 

<math display="inline" id="Association_scheme:45">
 <semantics>
  <mrow>
   <mi>i</mi>
   <mo>=</mo>
   <mrow>
    <mn>0</mn>
    <mo>,</mo>
    <mi mathvariant="normal">…</mi>
    <mo>,</mo>
    <mi>n</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>i</ci>
    <list>
     <cn type="integer">0</cn>
     <ci>normal-…</ci>
     <ci>n</ci>
    </list>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   i=0,\ldots,n
  </annotation>
 </semantics>
</math>

 and is a <em>v</em> × <em>v</em> <a href="Matrix_(mathematics)" title="wikilink">matrix</a> with rows and columns labeled by the points of 

<math display="inline" id="Association_scheme:46">
 <semantics>
  <mi>X</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>X</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   X
  </annotation>
 </semantics>
</math>

.</p>

<p>

<math display="block" id="Association_scheme:47">
 <semantics>
  <mrow>
   <msub>
    <mrow>
     <mo>(</mo>
     <msub>
      <mi>A</mi>
      <mi>i</mi>
     </msub>
     <mo>)</mo>
    </mrow>
    <mrow>
     <mi>x</mi>
     <mo>,</mo>
     <mi>y</mi>
    </mrow>
   </msub>
   <mo>=</mo>
   <mrow>
    <mo>{</mo>
    <mtable displaystyle="true">
     <mtr>
      <mtd columnalign="center">
       <mrow>
        <mn>1</mn>
        <mo>,</mo>
       </mrow>
      </mtd>
      <mtd columnalign="center">
       <mrow>
        <mrow>
         <mrow>
          <mtext>if</mtext>
          <mrow>
           <mo>(</mo>
           <mi>x</mi>
           <mo>,</mo>
           <mi>y</mi>
           <mo>)</mo>
          </mrow>
         </mrow>
         <mo>∈</mo>
         <msub>
          <mi>R</mi>
          <mi>i</mi>
         </msub>
        </mrow>
        <mo>,</mo>
       </mrow>
      </mtd>
     </mtr>
     <mtr>
      <mtd columnalign="center">
       <mrow>
        <mn>0</mn>
        <mo>,</mo>
       </mrow>
      </mtd>
      <mtd columnalign="center">
       <mtext>otherwise.</mtext>
      </mtd>
     </mtr>
    </mtable>
    <mrow>
     <mo stretchy="false">(</mo>
     <mn>1</mn>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <ci>normal-(</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>A</ci>
       <ci>i</ci>
      </apply>
      <ci>normal-)</ci>
     </cerror>
     <list>
      <ci>x</ci>
      <ci>y</ci>
     </list>
    </apply>
    <eq></eq>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-{</ci>
     <matrix>
      <matrixrow>
       <cn type="integer">1</cn>
       <apply>
        <in></in>
        <apply>
         <times></times>
         <mtext>if</mtext>
         <interval closure="open">
          <ci>x</ci>
          <ci>y</ci>
         </interval>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>R</ci>
         <ci>i</ci>
        </apply>
       </apply>
      </matrixrow>
      <matrixrow>
       <cn type="integer">0</cn>
       <mtext>otherwise.</mtext>
      </matrixrow>
     </matrix>
     <ci>italic-</ci>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <ci>normal-(</ci>
      <cn type="integer">1</cn>
      <ci>normal-)</ci>
     </cerror>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \left(A_{i}\right)_{x,y}=\left\{\begin{matrix}1,&\mbox{if }\left(x,y\right)\in
R%
_{i},\\
0,&\mbox{otherwise.}\end{matrix}\right.\qquad(1)
  </annotation>
 </semantics>
</math>

</p>

<p>The definition of an association scheme is equivalent to saying that the 

<math display="inline" id="Association_scheme:48">
 <semantics>
  <msub>
   <mi>A</mi>
   <mi>i</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>A</ci>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A_{i}
  </annotation>
 </semantics>
</math>

 are <em>v</em> × <em>v</em> (0,1)-<a href="Matrix_(mathematics)" title="wikilink">matrices</a> which satisfy</p>
<dl>
<dd>I. 

<math display="inline" id="Association_scheme:49">
 <semantics>
  <mpadded width="+1.7pt">
   <msub>
    <mi>A</mi>
    <mi>i</mi>
   </msub>
  </mpadded>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>A</ci>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A_{i}\,
  </annotation>
 </semantics>
</math>

 is symmetric,
</dd>
<dd>II. 

<math display="inline" id="Association_scheme:50">
 <semantics>
  <mrow>
   <mrow>
    <msubsup>
     <mo largeop="true" symmetric="true">∑</mo>
     <mrow>
      <mi>i</mi>
      <mo>=</mo>
      <mn>0</mn>
     </mrow>
     <mi>n</mi>
    </msubsup>
    <msub>
     <mi>A</mi>
     <mi>i</mi>
    </msub>
   </mrow>
   <mo>=</mo>
   <mi>J</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <apply>
        <eq></eq>
        <ci>i</ci>
        <cn type="integer">0</cn>
       </apply>
      </apply>
      <ci>n</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>A</ci>
      <ci>i</ci>
     </apply>
    </apply>
    <ci>J</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \sum_{i=0}^{n}A_{i}=J
  </annotation>
 </semantics>
</math>

 (the all-ones matrix),
</dd>
<dd>III. 

<math display="inline" id="Association_scheme:51">
 <semantics>
  <mrow>
   <msub>
    <mi>A</mi>
    <mn>0</mn>
   </msub>
   <mo>=</mo>
   <mpadded width="+1.7pt">
    <mi>I</mi>
   </mpadded>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>A</ci>
     <cn type="integer">0</cn>
    </apply>
    <ci>I</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A_{0}=I\,
  </annotation>
 </semantics>
</math>

,
</dd>
<dd>IV. 

<math display="inline" id="Association_scheme:52">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <msub>
      <mi>A</mi>
      <mi>i</mi>
     </msub>
     <msub>
      <mi>A</mi>
      <mi>j</mi>
     </msub>
    </mrow>
    <mo>=</mo>
    <mrow>
     <msubsup>
      <mo largeop="true" symmetric="true">∑</mo>
      <mrow>
       <mi>k</mi>
       <mo>=</mo>
       <mn>0</mn>
      </mrow>
      <mi>n</mi>
     </msubsup>
     <mrow>
      <msubsup>
       <mi>p</mi>
       <mrow>
        <mi>i</mi>
        <mi>j</mi>
       </mrow>
       <mi>k</mi>
      </msubsup>
      <msub>
       <mi>A</mi>
       <mi>k</mi>
      </msub>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <msub>
      <mi>A</mi>
      <mi>j</mi>
     </msub>
     <msub>
      <mi>A</mi>
      <mi>i</mi>
     </msub>
    </mrow>
   </mrow>
   <mo>,</mo>
   <mrow>
    <mrow>
     <mi>i</mi>
     <mo>,</mo>
     <mi>j</mi>
    </mrow>
    <mo>=</mo>
    <mn>0</mn>
   </mrow>
   <mo>,</mo>
   <mrow>
    <mi mathvariant="normal">…</mi>
    <mo>,</mo>
    <mi>n</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <and></and>
     <apply>
      <eq></eq>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>A</ci>
        <ci>i</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>A</ci>
        <ci>j</ci>
       </apply>
      </apply>
      <apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <sum></sum>
         <apply>
          <eq></eq>
          <ci>k</ci>
          <cn type="integer">0</cn>
         </apply>
        </apply>
        <ci>n</ci>
       </apply>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>p</ci>
          <ci>k</ci>
         </apply>
         <apply>
          <times></times>
          <ci>i</ci>
          <ci>j</ci>
         </apply>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>A</ci>
         <ci>k</ci>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <eq></eq>
      <share href="#.cmml">
      </share>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>A</ci>
        <ci>j</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>A</ci>
        <ci>i</ci>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <list>
      <ci>i</ci>
      <ci>j</ci>
     </list>
     <cn type="integer">0</cn>
    </apply>
    <list>
     <ci>normal-…</ci>
     <ci>n</ci>
    </list>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A_{i}A_{j}=\sum_{k=0}^{n}p^{k}_{ij}A_{k}=A_{j}A_{i},i,j=0,\ldots,n
  </annotation>
 </semantics>
</math>

.
</dd>
</dl>

<p>The (<em>x</em>, <em>y</em>)-th entry of the left side of (IV) is the number of paths of length two between <em>x</em> and <em>y</em> with labels i and j in the graph. Note that the rows and columns of 

<math display="inline" id="Association_scheme:53">
 <semantics>
  <msub>
   <mi>A</mi>
   <mi>i</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>A</ci>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A_{i}
  </annotation>
 </semantics>
</math>

 contain 

<math display="inline" id="Association_scheme:54">
 <semantics>
  <msub>
   <mi>v</mi>
   <mi>i</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>v</ci>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   v_{i}
  </annotation>
 </semantics>
</math>

 

<math display="inline" id="Association_scheme:55">
 <semantics>
  <mn>1</mn>
  <annotation-xml encoding="MathML-Content">
   <cn type="integer">1</cn>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   1
  </annotation>
 </semantics>
</math>

's:</p>

<p>

<math display="inline" id="Association_scheme:56">
 <semantics>
  <mrow>
   <msub>
    <mi>A</mi>
    <mi>i</mi>
   </msub>
   <mi>J</mi>
   <mo>=</mo>
   <mi>J</mi>
   <msub>
    <mi>A</mi>
    <mi>i</mi>
   </msub>
   <mo>=</mo>
   <msub>
    <mi>v</mi>
    <mi>i</mi>
   </msub>
   <mi>J</mi>
   <mo>.</mo>
   <mrow>
    <mo stretchy="false">(</mo>
    <mn>2</mn>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>A</ci>
     <ci>i</ci>
    </apply>
    <csymbol cd="unknown">J</csymbol>
    <eq></eq>
    <csymbol cd="unknown">J</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>A</ci>
     <ci>i</ci>
    </apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>v</ci>
     <ci>i</ci>
    </apply>
    <csymbol cd="unknown">J</csymbol>
    <ci>normal-.</ci>
    <ci>italic-</ci>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <cn type="integer">2</cn>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A_{i}J=JA_{i}=v_{i}J.\qquad(2)
  </annotation>
 </semantics>
</math>

</p>
<h3 id="terminology">Terminology</h3>
<ul>
<li>The numbers 

<math display="inline" id="Association_scheme:57">
 <semantics>
  <msubsup>
   <mi>p</mi>
   <mrow>
    <mi>i</mi>
    <mi>j</mi>
   </mrow>
   <mi>k</mi>
  </msubsup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>p</ci>
     <apply>
      <times></times>
      <ci>i</ci>
      <ci>j</ci>
     </apply>
    </apply>
    <ci>k</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p_{ij}^{k}
  </annotation>
 </semantics>
</math>

 are called the <em>parameters</em> of the scheme. They are also referred to as the <em>structural constants</em>.</li>
</ul>
<h2 id="history">History</h2>

<p>The term <em>association scheme</em> is due to  but the concept is already inherent in .<a class="footnoteRef" href="#fn9" id="fnref9"><sup>9</sup></a> These authors were studying what statisticians have called <em>partially balanced incomplete block designs</em> (PBIBDs). The subject became an object of algebraic interest with the publication of  and the introduction of the Bose–Mesner algebra. The most important contribution to the theory was the thesis of P. Delsarte  who recognized and fully used the connections with coding theory and design theory.<a class="footnoteRef" href="#fn10" id="fnref10"><sup>10</sup></a> Generalizations have been studied by D. G. Higman (coherent configurations) and B. Weisfeiler (distance regular graphs).</p>
<h2 id="basic-facts">Basic facts</h2>
<ul>
<li>

<math display="inline" id="Association_scheme:58">
 <semantics>
  <mrow>
   <msubsup>
    <mi>p</mi>
    <mn>00</mn>
    <mn>0</mn>
   </msubsup>
   <mo>=</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>p</ci>
      <cn type="integer">00</cn>
     </apply>
     <cn type="integer">0</cn>
    </apply>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p_{00}^{0}=1
  </annotation>
 </semantics>
</math>

, i.e. if 

<math display="inline" id="Association_scheme:59">
 <semantics>
  <mrow>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>x</mi>
    <mo>,</mo>
    <mi>y</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>∈</mo>
   <msub>
    <mi>R</mi>
    <mn>0</mn>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <in></in>
    <interval closure="open">
     <ci>x</ci>
     <ci>y</ci>
    </interval>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>R</ci>
     <cn type="integer">0</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (x,y)\in R_{0}
  </annotation>
 </semantics>
</math>

 then 

<math display="inline" id="Association_scheme:60">
 <semantics>
  <mrow>
   <mi>x</mi>
   <mo>=</mo>
   <mi>y</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>x</ci>
    <ci>y</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x=y
  </annotation>
 </semantics>
</math>

 and the only 

<math display="inline" id="Association_scheme:61">
 <semantics>
  <mi>z</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>z</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   z
  </annotation>
 </semantics>
</math>

 such that 

<math display="inline" id="Association_scheme:62">
 <semantics>
  <mrow>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>x</mi>
    <mo>,</mo>
    <mi>z</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>∈</mo>
   <msub>
    <mi>R</mi>
    <mn>0</mn>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <in></in>
    <interval closure="open">
     <ci>x</ci>
     <ci>z</ci>
    </interval>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>R</ci>
     <cn type="integer">0</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (x,z)\in R_{0}
  </annotation>
 </semantics>
</math>

 is 

<math display="inline" id="Association_scheme:63">
 <semantics>
  <mrow>
   <mi>z</mi>
   <mo>=</mo>
   <mi>x</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>z</ci>
    <ci>x</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   z=x
  </annotation>
 </semantics>
</math>

</li>
<li>

<math display="inline" id="Association_scheme:64">
 <semantics>
  <mrow>
   <mrow>
    <msubsup>
     <mo largeop="true" symmetric="true">∑</mo>
     <mrow>
      <mi>i</mi>
      <mo>=</mo>
      <mn>0</mn>
     </mrow>
     <mi>k</mi>
    </msubsup>
    <msubsup>
     <mi>p</mi>
     <mrow>
      <mi>i</mi>
      <mi>i</mi>
     </mrow>
     <mn>0</mn>
    </msubsup>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mo stretchy="false">|</mo>
    <mi>X</mi>
    <mo stretchy="false">|</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <apply>
        <eq></eq>
        <ci>i</ci>
        <cn type="integer">0</cn>
       </apply>
      </apply>
      <ci>k</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>p</ci>
       <apply>
        <times></times>
        <ci>i</ci>
        <ci>i</ci>
       </apply>
      </apply>
      <cn type="integer">0</cn>
     </apply>
    </apply>
    <apply>
     <abs></abs>
     <ci>X</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \sum_{i=0}^{k}p_{ii}^{0}=|X|
  </annotation>
 </semantics>
</math>

, this is because the 

<math display="inline" id="Association_scheme:65">
 <semantics>
  <msub>
   <mi>R</mi>
   <mi>i</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>R</ci>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   R_{i}
  </annotation>
 </semantics>
</math>

 partition 

<math display="inline" id="Association_scheme:66">
 <semantics>
  <mi>X</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>X</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   X
  </annotation>
 </semantics>
</math>

.</li>
</ul>
<h2 id="the-bosemesner-algebra">The Bose–Mesner algebra</h2>

<p>The <a href="Adjacency_matrix" title="wikilink">adjacency matrices</a> 

<math display="inline" id="Association_scheme:67">
 <semantics>
  <msub>
   <mi>A</mi>
   <mi>i</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>A</ci>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A_{i}
  </annotation>
 </semantics>
</math>

 of the <a href="Graph_(mathematics)" title="wikilink">graphs</a> 

<math display="inline" id="Association_scheme:68">
 <semantics>
  <mrow>
   <mo>(</mo>
   <mi>X</mi>
   <mo>,</mo>
   <msub>
    <mi>R</mi>
    <mi>i</mi>
   </msub>
   <mo>)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <interval closure="open">
    <ci>X</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>R</ci>
     <ci>i</ci>
    </apply>
   </interval>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \left(X,R_{i}\right)
  </annotation>
 </semantics>
</math>

 generate a <a href="Commutativity" title="wikilink">commutative</a> and <a class="uri" href="associative" title="wikilink">associative</a> <a class="uri" href="algebra" title="wikilink">algebra</a> 

<math display="inline" id="Association_scheme:69">
 <semantics>
  <mi class="ltx_font_mathcaligraphic">𝒜</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>𝒜</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathcal{A}
  </annotation>
 </semantics>
</math>

 (over the real or <a href="complex_number" title="wikilink">complex numbers</a>) both for the <a href="matrix_product" title="wikilink">matrix product</a> and the <a href="pointwise_product" title="wikilink">pointwise product</a>. This <a href="Associative_algebra" title="wikilink">associative</a>, <a href="commutative_algebra" title="wikilink">commutative algebra</a> is called the <a href="Bose–Mesner_algebra" title="wikilink">Bose–Mesner algebra</a> of the association scheme.</p>

<p>Since the <a href="Matrix_(mathematics)" title="wikilink">matrices</a> in 

<math display="inline" id="Association_scheme:70">
 <semantics>
  <mi class="ltx_font_mathcaligraphic">𝒜</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>𝒜</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathcal{A}
  </annotation>
 </semantics>
</math>

 are <a href="Symmetric_matrix" title="wikilink">symmetric</a> and <a href="Commutativity" title="wikilink">commute</a> with each other, they can be <a href="Diagonal_matrix" title="wikilink">diagonalized</a> simultaneously. Therefore 

<math display="inline" id="Association_scheme:71">
 <semantics>
  <mi class="ltx_font_mathcaligraphic">𝒜</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>𝒜</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathcal{A}
  </annotation>
 </semantics>
</math>

 is <a href="Semisimple_operator" title="wikilink">semi-simple</a> and has a unique basis of primitive <a href="idempotent" title="wikilink">idempotents</a> 

<math display="inline" id="Association_scheme:72">
 <semantics>
  <mrow>
   <msub>
    <mi>J</mi>
    <mn>0</mn>
   </msub>
   <mo>,</mo>
   <mi mathvariant="normal">…</mi>
   <mo>,</mo>
   <msub>
    <mi>J</mi>
    <mi>n</mi>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <list>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>J</ci>
     <cn type="integer">0</cn>
    </apply>
    <ci>normal-…</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>J</ci>
     <ci>n</ci>
    </apply>
   </list>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   J_{0},\ldots,J_{n}
  </annotation>
 </semantics>
</math>

.</p>

<p>There is another <a class="uri" href="algebra" title="wikilink">algebra</a> of 

<math display="inline" id="Association_scheme:73">
 <semantics>
  <mrow>
   <mrow>
    <mo>(</mo>
    <mrow>
     <mi>n</mi>
     <mo>+</mo>
     <mn>1</mn>
    </mrow>
    <mo>)</mo>
   </mrow>
   <mo>×</mo>
   <mrow>
    <mo>(</mo>
    <mrow>
     <mi>n</mi>
     <mo>+</mo>
     <mn>1</mn>
    </mrow>
    <mo>)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <plus></plus>
     <ci>n</ci>
     <cn type="integer">1</cn>
    </apply>
    <apply>
     <plus></plus>
     <ci>n</ci>
     <cn type="integer">1</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \left(n+1\right)\times\left(n+1\right)
  </annotation>
 </semantics>
</math>

 <a href="Matrix_(mathematics)" title="wikilink">matrices</a> which is <a class="uri" href="isomorphic" title="wikilink">isomorphic</a> to 

<math display="inline" id="Association_scheme:74">
 <semantics>
  <mi class="ltx_font_mathcaligraphic">𝒜</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>𝒜</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathcal{A}
  </annotation>
 </semantics>
</math>

, and is often easier to work with.</p>
<h2 id="examples">Examples</h2>
<ul>
<li>The <a href="Johnson_scheme" title="wikilink">Johnson scheme</a>, denoted <em>J</em>(<em>v,k</em>), is defined as follows. Let <em>S</em> be a set with <em>v</em> elements. The points of the scheme <em>J</em>(<em>v</em>,<em>k</em>) are the 

<math display="inline" id="Association_scheme:75">
 <semantics>
  <mrow>
   <mo>(</mo>
   <mstyle scriptlevel="+1">
    <mtable columnspacing="0.4em" rowspacing="0.2ex">
     <mtr>
      <mtd>
       <mi>v</mi>
      </mtd>
     </mtr>
     <mtr>
      <mtd>
       <mi>k</mi>
      </mtd>
     </mtr>
    </mtable>
   </mstyle>
   <mo>)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">binomial</csymbol>
    <ci>v</ci>
    <ci>k</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   {v\choose k}
  </annotation>
 </semantics>
</math>

 subsets of S with <em>k</em> elements. Two <em>k</em>-element subsets <em>A</em>, <em>B</em> of <em>S</em> are <em>i</em> th associates when their intersection has size <em>k</em> − <em>i</em>.</li>
</ul>
<ul>
<li>The <a href="Hamming_scheme" title="wikilink">Hamming scheme</a>, denoted <em>H</em>(<em>n</em>,<em>q</em>), is defined as follows. The points of <em>H</em>(<em>n</em>,<em>q</em>) are the <em>q<sup>n</sup></em> ordered <em>n</em>-<a href="tuple" title="wikilink">tuples</a> over a set of size <em>q</em>. Two <em>n</em>-tuples <em>x</em>, <em>y</em> are said to be <em>i</em> th associates if they disagree in exactly <em>i</em> coordinates. E.g., if <em>x</em> = (1,0,1,1), <em>y</em> = (1,1,1,1), <em>z</em> = (0,0,1,1), then <em>x</em> and <em>y</em> are 1st associates, <em>x</em> and <em>z</em> are 1st associates and <em>y</em> and <em>z</em> are 2nd associates in <em>H(4,2)</em>.</li>
</ul>
<ul>
<li>A <a href="distance-regular_graph" title="wikilink">distance-regular graph</a>, <em>G</em>, forms an association scheme by defining two vertices to be <em>i</em> th associates if their distance is <em>i</em>.</li>
</ul>
<ul>
<li>A <a href="finite_group" title="wikilink">finite group</a> <em>G</em> yields an association scheme on 

<math display="inline" id="Association_scheme:76">
 <semantics>
  <mrow>
   <mi>X</mi>
   <mo>=</mo>
   <mi>G</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>X</ci>
    <ci>G</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   X=G
  </annotation>
 </semantics>
</math>

, with a class <em>R</em><sub><em>g</em></sub> for each group element, as follows: for each 

<math display="inline" id="Association_scheme:77">
 <semantics>
  <mrow>
   <mi>g</mi>
   <mo>∈</mo>
   <mi>G</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <in></in>
    <ci>g</ci>
    <ci>G</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   g\in G
  </annotation>
 </semantics>
</math>

 let 

<math display="inline" id="Association_scheme:78">
 <semantics>
  <mrow>
   <msub>
    <mi>R</mi>
    <mi>g</mi>
   </msub>
   <mo>=</mo>
   <mrow>
    <mo stretchy="false">{</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>x</mi>
     <mo>,</mo>
     <mi>y</mi>
     <mo stretchy="false">)</mo>
    </mrow>
    <mo stretchy="false">|</mo>
    <mrow>
     <mi>x</mi>
     <mo>=</mo>
     <mrow>
      <mi>g</mi>
      <mo>*</mo>
      <mi>y</mi>
     </mrow>
    </mrow>
    <mo stretchy="false">}</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>R</ci>
     <ci>g</ci>
    </apply>
    <apply>
     <csymbol cd="latexml">conditional-set</csymbol>
     <interval closure="open">
      <ci>x</ci>
      <ci>y</ci>
     </interval>
     <apply>
      <eq></eq>
      <ci>x</ci>
      <apply>
       <times></times>
       <ci>g</ci>
       <ci>y</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   R_{g}=\{(x,y)|x=g*y\}
  </annotation>
 </semantics>
</math>

 where 

<math display="inline" id="Association_scheme:79">
 <semantics>
  <mo>*</mo>
  <annotation-xml encoding="MathML-Content">
   <times></times>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   *
  </annotation>
 </semantics>
</math>

 is the group <a href="operation_(mathematics)" title="wikilink">operation</a>. The class of the group identity is <em>R</em><sub>0</sub>. This association scheme is commutative if and only if <em>G</em> is <a href="Abelian_group" title="wikilink">abelian</a>.</li>
</ul>
<ul>
<li>A specific 3-class association scheme:<a class="footnoteRef" href="#fn11" id="fnref11"><sup>11</sup></a></li>
</ul>
<dl>
<dd>Let <em>A</em>(3) be the following association scheme with three associate classes on the set <em>X</em> = {1,2,3,4,5,6}. The (<em>i</em>,<em>j</em>) entry is <em>s</em> if elements <em>i</em> and <em>j</em> are in relation R<sub>s</sub>.
</dd>
</dl>
<center>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">
<p> </p></th>
<th style="text-align: left;">
<p>1</p></th>
<th style="text-align: left;">
<p>2</p></th>
<th style="text-align: left;">
<p>3</p></th>
<th style="text-align: left;">
<p>4</p></th>
<th style="text-align: left;">
<p>5</p></th>
<th style="text-align: left;">
<p>6</p></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">
<p><strong>1</strong></p></td>
<td style="text-align: left;">
<p><span style="color:white; background:blue">  0 </span></p></td>
<td style="text-align: left;">
<p><span style="color:white; background:red">  1  </span></p></td>
<td style="text-align: left;">
<p><span style="color:white; background:red">  1  </span></p></td>
<td style="text-align: left;">
<p><span style="color:white; background:lime">  2  </span></p></td>
<td style="text-align: left;">
<p><span style="color:white; background:fuchsia">  3 </span></p></td>
<td style="text-align: left;">
<p><span style="color:white; background:fuchsia">  3 </span></p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p><strong>2</strong></p></td>
<td style="text-align: left;">
<p><span style="color:white; background:red">  1  </span></p></td>
<td style="text-align: left;">
<p><span style="color:white; background:blue">  0  </span></p></td>
<td style="text-align: left;">
<p><span style="color:white; background:red">  1  </span></p></td>
<td style="text-align: left;">
<p><span style="color:white; background:fuchsia">  3 </span></p></td>
<td style="text-align: left;">
<p><span style="color:white; background:lime">  2 </span></p></td>
<td style="text-align: left;">
<p><span style="color:white; background:fuchsia">  3 </span></p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p><strong>3</strong></p></td>
<td style="text-align: left;">
<p><span style="color:white; background:red">  1  </span></p></td>
<td style="text-align: left;">
<p><span style="color:white; background:red">  1  </span></p></td>
<td style="text-align: left;">
<p><span style="color:white; background:blue">  0 </span></p></td>
<td style="text-align: left;">
<p><span style="color:white; background:fuchsia">  3 </span></p></td>
<td style="text-align: left;">
<p><span style="color:white; background:fuchsia">  3 </span></p></td>
<td style="text-align: left;">
<p><span style="color:white; background:lime">  2 </span></p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p><strong>4</strong></p></td>
<td style="text-align: left;">
<p><span style="color:white; background:lime">  2 </span></p></td>
<td style="text-align: left;">
<p><span style="color:white; background:fuchsia">  3 </span></p></td>
<td style="text-align: left;">
<p><span style="color:white; background:fuchsia">  3 </span></p></td>
<td style="text-align: left;">
<p><span style="color:white; background:blue">  0 </span></p></td>
<td style="text-align: left;">
<p><span style="color:white; background:red">  1  </span></p></td>
<td style="text-align: left;">
<p><span style="color:white; background:red">  1  </span></p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p><strong>5</strong></p></td>
<td style="text-align: left;">
<p><span style="color:white; background:fuchsia">  3 </span></p></td>
<td style="text-align: left;">
<p><span style="color:white; background:lime">  2 </span></p></td>
<td style="text-align: left;">
<p><span style="color:white; background:fuchsia">  3 </span></p></td>
<td style="text-align: left;">
<p><span style="color:white; background:red">  1  </span></p></td>
<td style="text-align: left;">
<p><span style="color:white; background:blue"> 0 </span></p></td>
<td style="text-align: left;">
<p><span style="color:white; background:red">  1  </span></p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p><strong>6</strong></p></td>
<td style="text-align: left;">
<p><span style="color:white; background:fuchsia">  3  </span></p></td>
<td style="text-align: left;">
<p><span style="color:white; background:fuchsia">  3 </span></p></td>
<td style="text-align: left;">
<p><span style="color:white; background:lime">  2 </span></p></td>
<td style="text-align: left;">
<p><span style="color:white; background:red">  1  </span></p></td>
<td style="text-align: left;">
<p><span style="color:white; background:red">  1  </span></p></td>
<td style="text-align: left;">
<p><span style="color:white; background:blue"> 0 </span></p></td>
</tr>
</tbody>
</table>
</center>
<h2 id="coding-theory">Coding theory</h2>

<p>The <a href="Hamming_scheme" title="wikilink">Hamming scheme</a> and the <a href="Johnson_scheme" title="wikilink">Johnson scheme</a> are of major significance in classical <a href="coding_theory" title="wikilink">coding theory</a>.</p>

<p>In <a href="coding_theory" title="wikilink">coding theory</a>, association scheme theory is mainly concerned with the <a href="Hamming_distance" title="wikilink">distance</a> of a <a class="uri" href="code" title="wikilink">code</a>. The <a href="linear_programming" title="wikilink">linear programming</a> method produces upper bounds for the size of a <a class="uri" href="code" title="wikilink">code</a> with given minimum <a href="Hamming_distance" title="wikilink">distance</a>, and lower bounds for the size of a <a href="T-design" title="wikilink">design</a> with a given strength. The most specific results are obtained in the case where the underlying association scheme satisfies certain <a class="uri" href="polynomial" title="wikilink">polynomial</a> properties; this leads one into the realm of <a href="orthogonal_polynomials" title="wikilink">orthogonal polynomials</a>. In particular, some universal bounds are derived for <a href="code" title="wikilink">codes</a> and <a href="T-design" title="wikilink">designs</a> in polynomial-type association schemes.</p>

<p>In classical <a href="coding_theory" title="wikilink">coding theory</a>, dealing with <a href="code" title="wikilink">codes</a> in a <a href="Hamming_scheme" title="wikilink">Hamming scheme</a>, the MacWilliams transform involves a family of orthogonal polynomials known as the <a href="Krawtchouk_polynomials" title="wikilink">Krawtchouk polynomials</a>. These polynomials give the <a class="uri" href="eigenvalues" title="wikilink">eigenvalues</a> of the distance relation <a href="Matrix_(mathematics)" title="wikilink">matrices</a> of the <a href="Hamming_scheme" title="wikilink">Hamming scheme</a>.</p>
<h2 id="see-also">See also</h2>
<ul>
<li><a href="Block_design" title="wikilink">Block design</a></li>
<li><a href="Bose–Mesner_algebra" title="wikilink">Bose–Mesner algebra</a></li>
<li><a href="Combinatorial_design" title="wikilink">Combinatorial design</a></li>
</ul>
<h2 id="notes">Notes</h2>
<h2 id="references">References</h2>
<ul>
<li>

<p>. (Chapters from preliminary draft are <a href="http://www.maths.qmw.ac.uk/~rab">available on-line</a>.)</p></li>
</ul>
<ul>
<li></li>
</ul>
<ul>
<li></li>
</ul>
<ul>
<li></li>
</ul>
<ul>
<li></li>
</ul>
<ul>
<li>P. Camion (1998), Codes and Association Schemes: Basic Properties of Association Schemes Relevant to Coding, in <em>Handbook of Coding Theory</em>, V. S. Pless and W. C. Huffman, Eds., Elsevier, The Netherlands.</li>
</ul>
<ul>
<li></li>
</ul>
<ul>
<li></li>
</ul>
<ul>
<li></li>
</ul>
<ul>
<li></li>
</ul>
<ul>
<li>F. J. MacWilliams and N. J. A. Sloane, <em>The Theory of Error-Correcting Codes</em>, Elsevier, New York, 1978.</li>
</ul>
<ul>
<li></li>
</ul>
<ul>
<li>van Lint, J.H., and Wilson, R.M. (1992), <em>A Course in Combinatorics</em>. Cambridge, Eng.: Cambridge University Press. ISBN 0-521-00601-5</li>
</ul>
<ul>
<li></li>
</ul>
<ul>
<li></li>
</ul>
<ul>
<li></li>
</ul>

<p>"</p>

<p><a href="Category:Articles_with_inconsistent_citation_formats" title="wikilink">Category:Articles with inconsistent citation formats</a> <a href="Category:Design_of_experiments" title="wikilink">Category:Design of experiments</a> <a href="Category:Analysis_of_variance" title="wikilink">Category:Analysis of variance</a> <a href="Category:Algebraic_combinatorics" title="wikilink">Category:Algebraic combinatorics</a> <a href="Category:Representation_theory" title="wikilink">Category:Representation theory</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1"><a href="#fnref1">↩</a></li>
<li id="fn2"><a href="#fnref2">↩</a></li>
<li id="fn3"><a href="#fnref3">↩</a></li>
<li id="fn4"><a href="#fnref4">↩</a></li>
<li id="fn5"><a href="#fnref5">↩</a></li>
<li id="fn6"><a href="#fnref6">↩</a></li>
<li id="fn7"><a href="#fnref7">↩</a></li>
<li id="fn8"><a href="#fnref8">↩</a></li>
<li id="fn9"><a href="#fnref9">↩</a></li>
<li id="fn10"><a href="#fnref10">↩</a></li>
<li id="fn11"><a href="#fnref11">↩</a></li>
</ol>
</section>
</body>
</html>
